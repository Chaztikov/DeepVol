WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-18 20:46:39.227634: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-18 20:46:39.257062: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-18 20:46:39.257720: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 20:46:39.259908: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 20:46:39.262111: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 20:46:39.262902: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 20:46:39.265373: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 20:46:39.267370: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 20:46:39.272488: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 20:46:39.274713: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 20:46:39.275286: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-18 20:46:39.282259: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2400125000 Hz
2019-12-18 20:46:39.282458: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559ebfc5c4a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-18 20:46:39.282477: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-18 20:46:39.283662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-18 20:46:39.283700: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 20:46:39.283714: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 20:46:39.283728: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 20:46:39.283740: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 20:46:39.283760: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 20:46:39.283774: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 20:46:39.283787: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 20:46:39.285885: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 20:46:39.285918: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 20:46:39.379951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-18 20:46:39.379987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-18 20:46:39.380000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-18 20:46:39.383271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2019-12-18 20:46:39.385602: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559ec0295770 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-18 20:46:39.385620: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
INFO   Y0_true: 4.0000e-02
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-18 20:46:57.113787: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 2.9020e+02,   Y0: 2.6469e+00,  elapsed time  17
INFO   step:     1,    loss: 1.8061e+02,   Y0: 2.6519e+00,  elapsed time  25
INFO   step:     2,    loss: 1.8105e+02,   Y0: 2.6534e+00,  elapsed time  26
INFO   step:     3,    loss: 1.8157e+02,   Y0: 2.6554e+00,  elapsed time  28
INFO   step:     4,    loss: 1.8265e+02,   Y0: 2.6585e+00,  elapsed time  29
INFO   step:     5,    loss: 1.8205e+02,   Y0: 2.6622e+00,  elapsed time  30
INFO   step:     6,    loss: 1.8145e+02,   Y0: 2.6662e+00,  elapsed time  31
INFO   step:     7,    loss: 1.8148e+02,   Y0: 2.6700e+00,  elapsed time  32
INFO   step:     8,    loss: 1.8175e+02,   Y0: 2.6729e+00,  elapsed time  34
INFO   step:     9,    loss: 1.8167e+02,   Y0: 2.6761e+00,  elapsed time  35
INFO   step:    10,    loss: 1.8156e+02,   Y0: 2.6793e+00,  elapsed time  36
INFO   step:    11,    loss: 1.8147e+02,   Y0: 2.6815e+00,  elapsed time  37
INFO   step:    12,    loss: 1.8139e+02,   Y0: 2.6830e+00,  elapsed time  38
INFO   step:    13,    loss: 1.8130e+02,   Y0: 2.6834e+00,  elapsed time  40
INFO   step:    14,    loss: 1.8120e+02,   Y0: 2.6846e+00,  elapsed time  41
INFO   step:    15,    loss: 1.8111e+02,   Y0: 2.6862e+00,  elapsed time  42
INFO   step:    16,    loss: 1.8101e+02,   Y0: 2.6885e+00,  elapsed time  43
INFO   step:    17,    loss: 1.8092e+02,   Y0: 2.6904e+00,  elapsed time  44
INFO   step:    18,    loss: 1.8084e+02,   Y0: 2.6924e+00,  elapsed time  45
INFO   step:    19,    loss: 1.8076e+02,   Y0: 2.6939e+00,  elapsed time  47
INFO   step:    20,    loss: 1.8068e+02,   Y0: 2.6954e+00,  elapsed time  48
INFO   step:    21,    loss: 1.8061e+02,   Y0: 2.6964e+00,  elapsed time  49
INFO   step:    22,    loss: 1.8054e+02,   Y0: 2.6977e+00,  elapsed time  50
INFO   step:    23,    loss: 1.8049e+02,   Y0: 2.6988e+00,  elapsed time  51
INFO   step:    24,    loss: 1.8044e+02,   Y0: 2.7004e+00,  elapsed time  53
INFO   step:    25,    loss: 1.8040e+02,   Y0: 2.7016e+00,  elapsed time  54
INFO   step:    26,    loss: 1.8036e+02,   Y0: 2.7023e+00,  elapsed time  55
INFO   step:    27,    loss: 1.8032e+02,   Y0: 2.7035e+00,  elapsed time  56
INFO   step:    28,    loss: 1.8028e+02,   Y0: 2.7048e+00,  elapsed time  57
INFO   step:    29,    loss: 1.8024e+02,   Y0: 2.7064e+00,  elapsed time  58
INFO   step:    30,    loss: 1.8020e+02,   Y0: 2.7075e+00,  elapsed time  60
INFO   step:    31,    loss: 1.8016e+02,   Y0: 2.7086e+00,  elapsed time  61
INFO   step:    32,    loss: 1.8012e+02,   Y0: 2.7103e+00,  elapsed time  62
INFO   step:    33,    loss: 1.8009e+02,   Y0: 2.7111e+00,  elapsed time  63
INFO   step:    34,    loss: 1.8006e+02,   Y0: 2.7120e+00,  elapsed time  64
INFO   step:    35,    loss: 1.8004e+02,   Y0: 2.7129e+00,  elapsed time  66
INFO   step:    36,    loss: 1.8003e+02,   Y0: 2.7140e+00,  elapsed time  67
INFO   step:    37,    loss: 1.8003e+02,   Y0: 2.7154e+00,  elapsed time  68
INFO   step:    38,    loss: 1.8003e+02,   Y0: 2.7169e+00,  elapsed time  69
INFO   step:    39,    loss: 1.8001e+02,   Y0: 2.7184e+00,  elapsed time  70
INFO   step:    40,    loss: 1.8000e+02,   Y0: 2.7202e+00,  elapsed time  72
INFO   step:    41,    loss: 1.7998e+02,   Y0: 2.7216e+00,  elapsed time  73
INFO   step:    42,    loss: 1.7996e+02,   Y0: 2.7227e+00,  elapsed time  74
INFO   step:    43,    loss: 1.7994e+02,   Y0: 2.7238e+00,  elapsed time  75
INFO   step:    44,    loss: 1.7992e+02,   Y0: 2.7255e+00,  elapsed time  76
INFO   step:    45,    loss: 1.7990e+02,   Y0: 2.7268e+00,  elapsed time  77
INFO   step:    46,    loss: 1.7987e+02,   Y0: 2.7280e+00,  elapsed time  79
INFO   step:    47,    loss: 1.7985e+02,   Y0: 2.7292e+00,  elapsed time  80
INFO   step:    48,    loss: 1.7982e+02,   Y0: 2.7304e+00,  elapsed time  81
INFO   step:    49,    loss: 1.7979e+02,   Y0: 2.7319e+00,  elapsed time  82
INFO   step:    50,    loss: 1.7977e+02,   Y0: 2.7341e+00,  elapsed time  83
INFO   step:    51,    loss: 1.7974e+02,   Y0: 2.7362e+00,  elapsed time  85
INFO   step:    52,    loss: 1.7972e+02,   Y0: 2.7387e+00,  elapsed time  86
INFO   step:    53,    loss: 1.7970e+02,   Y0: 2.7415e+00,  elapsed time  87
INFO   step:    54,    loss: 1.7968e+02,   Y0: 2.7442e+00,  elapsed time  88
INFO   step:    55,    loss: 1.7966e+02,   Y0: 2.7470e+00,  elapsed time  89
INFO   step:    56,    loss: 1.7964e+02,   Y0: 2.7494e+00,  elapsed time  91
INFO   step:    57,    loss: 1.7962e+02,   Y0: 2.7521e+00,  elapsed time  92
INFO   step:    58,    loss: 1.7960e+02,   Y0: 2.7547e+00,  elapsed time  93
INFO   step:    59,    loss: 1.7957e+02,   Y0: 2.7563e+00,  elapsed time  94
INFO   step:    60,    loss: 1.7954e+02,   Y0: 2.7586e+00,  elapsed time  95
INFO   step:    61,    loss: 1.7950e+02,   Y0: 2.7609e+00,  elapsed time  96
INFO   step:    62,    loss: 1.7948e+02,   Y0: 2.7625e+00,  elapsed time  98
INFO   step:    63,    loss: 1.7946e+02,   Y0: 2.7641e+00,  elapsed time  99
INFO   step:    64,    loss: 1.7944e+02,   Y0: 2.7662e+00,  elapsed time 100
INFO   step:    65,    loss: 1.7942e+02,   Y0: 2.7681e+00,  elapsed time 101
INFO   step:    66,    loss: 1.7940e+02,   Y0: 2.7700e+00,  elapsed time 102
INFO   step:    67,    loss: 1.7939e+02,   Y0: 2.7713e+00,  elapsed time 104
INFO   step:    68,    loss: 1.7938e+02,   Y0: 2.7724e+00,  elapsed time 105
INFO   step:    69,    loss: 1.7937e+02,   Y0: 2.7734e+00,  elapsed time 106
INFO   step:    70,    loss: 1.7936e+02,   Y0: 2.7749e+00,  elapsed time 107
INFO   step:    71,    loss: 1.7934e+02,   Y0: 2.7764e+00,  elapsed time 108
INFO   step:    72,    loss: 1.7933e+02,   Y0: 2.7778e+00,  elapsed time 109
INFO   step:    73,    loss: 1.7932e+02,   Y0: 2.7785e+00,  elapsed time 111
INFO   step:    74,    loss: 1.7930e+02,   Y0: 2.7799e+00,  elapsed time 112
INFO   step:    75,    loss: 1.7928e+02,   Y0: 2.7811e+00,  elapsed time 113
INFO   step:    76,    loss: 1.7927e+02,   Y0: 2.7821e+00,  elapsed time 114
INFO   step:    77,    loss: 1.7925e+02,   Y0: 2.7822e+00,  elapsed time 115
INFO   step:    78,    loss: 1.7923e+02,   Y0: 2.7820e+00,  elapsed time 117
INFO   step:    79,    loss: 1.7922e+02,   Y0: 2.7818e+00,  elapsed time 118
INFO   step:    80,    loss: 1.7920e+02,   Y0: 2.7816e+00,  elapsed time 119
INFO   step:    81,    loss: 1.7918e+02,   Y0: 2.7812e+00,  elapsed time 120
INFO   step:    82,    loss: 1.7917e+02,   Y0: 2.7805e+00,  elapsed time 121
INFO   step:    83,    loss: 1.7915e+02,   Y0: 2.7792e+00,  elapsed time 123
INFO   step:    84,    loss: 1.7913e+02,   Y0: 2.7772e+00,  elapsed time 124
INFO   step:    85,    loss: 1.7911e+02,   Y0: 2.7760e+00,  elapsed time 125
INFO   step:    86,    loss: 1.7909e+02,   Y0: 2.7751e+00,  elapsed time 126
INFO   step:    87,    loss: 1.7908e+02,   Y0: 2.7754e+00,  elapsed time 127
INFO   step:    88,    loss: 1.7906e+02,   Y0: 2.7765e+00,  elapsed time 128
INFO   step:    89,    loss: 1.7904e+02,   Y0: 2.7776e+00,  elapsed time 130
INFO   step:    90,    loss: 1.7902e+02,   Y0: 2.7784e+00,  elapsed time 131
INFO   step:    91,    loss: 1.7901e+02,   Y0: 2.7787e+00,  elapsed time 132
INFO   step:    92,    loss: 1.7899e+02,   Y0: 2.7792e+00,  elapsed time 133
INFO   step:    93,    loss: 1.7897e+02,   Y0: 2.7799e+00,  elapsed time 134
INFO   step:    94,    loss: 1.7896e+02,   Y0: 2.7807e+00,  elapsed time 136
INFO   step:    95,    loss: 1.7894e+02,   Y0: 2.7812e+00,  elapsed time 137
INFO   step:    96,    loss: 1.7892e+02,   Y0: 2.7822e+00,  elapsed time 138
INFO   step:    97,    loss: 1.7891e+02,   Y0: 2.7830e+00,  elapsed time 139
INFO   step:    98,    loss: 1.7890e+02,   Y0: 2.7831e+00,  elapsed time 140
INFO   step:    99,    loss: 1.7888e+02,   Y0: 2.7835e+00,  elapsed time 142
INFO   step:   100,    loss: 1.7887e+02,   Y0: 2.7838e+00,  elapsed time 143
INFO   step:   101,    loss: 1.7886e+02,   Y0: 2.7835e+00,  elapsed time 144
INFO   step:   102,    loss: 1.7885e+02,   Y0: 2.7836e+00,  elapsed time 145
INFO   step:   103,    loss: 1.7884e+02,   Y0: 2.7825e+00,  elapsed time 146
INFO   step:   104,    loss: 1.7883e+02,   Y0: 2.7816e+00,  elapsed time 147
INFO   step:   105,    loss: 1.7882e+02,   Y0: 2.7803e+00,  elapsed time 149
INFO   step:   106,    loss: 1.7881e+02,   Y0: 2.7794e+00,  elapsed time 150
INFO   step:   107,    loss: 1.7880e+02,   Y0: 2.7790e+00,  elapsed time 151
INFO   step:   108,    loss: 1.7880e+02,   Y0: 2.7794e+00,  elapsed time 152
INFO   step:   109,    loss: 1.7878e+02,   Y0: 2.7799e+00,  elapsed time 153
INFO   step:   110,    loss: 1.7876e+02,   Y0: 2.7802e+00,  elapsed time 155
INFO   step:   111,    loss: 1.7874e+02,   Y0: 2.7806e+00,  elapsed time 156
INFO   step:   112,    loss: 1.7873e+02,   Y0: 2.7811e+00,  elapsed time 157
INFO   step:   113,    loss: 1.7871e+02,   Y0: 2.7810e+00,  elapsed time 158
INFO   step:   114,    loss: 1.7869e+02,   Y0: 2.7808e+00,  elapsed time 159
INFO   step:   115,    loss: 1.7867e+02,   Y0: 2.7812e+00,  elapsed time 160
INFO   step:   116,    loss: 1.7865e+02,   Y0: 2.7812e+00,  elapsed time 162
INFO   step:   117,    loss: 1.7863e+02,   Y0: 2.7823e+00,  elapsed time 163
INFO   step:   118,    loss: 1.7862e+02,   Y0: 2.7830e+00,  elapsed time 164
INFO   step:   119,    loss: 1.7860e+02,   Y0: 2.7839e+00,  elapsed time 165
INFO   step:   120,    loss: 1.7858e+02,   Y0: 2.7850e+00,  elapsed time 166
INFO   step:   121,    loss: 1.7857e+02,   Y0: 2.7854e+00,  elapsed time 168
INFO   step:   122,    loss: 1.7855e+02,   Y0: 2.7864e+00,  elapsed time 169
INFO   step:   123,    loss: 1.7853e+02,   Y0: 2.7873e+00,  elapsed time 170
INFO   step:   124,    loss: 1.7852e+02,   Y0: 2.7886e+00,  elapsed time 171
INFO   step:   125,    loss: 1.7850e+02,   Y0: 2.7897e+00,  elapsed time 172
INFO   step:   126,    loss: 1.7848e+02,   Y0: 2.7906e+00,  elapsed time 174
INFO   step:   127,    loss: 1.7846e+02,   Y0: 2.7914e+00,  elapsed time 175
INFO   step:   128,    loss: 1.7845e+02,   Y0: 2.7915e+00,  elapsed time 176
INFO   step:   129,    loss: 1.7843e+02,   Y0: 2.7919e+00,  elapsed time 177
INFO   step:   130,    loss: 1.7842e+02,   Y0: 2.7923e+00,  elapsed time 178
INFO   step:   131,    loss: 1.7841e+02,   Y0: 2.7927e+00,  elapsed time 179
INFO   step:   132,    loss: 1.7840e+02,   Y0: 2.7939e+00,  elapsed time 181
INFO   step:   133,    loss: 1.7839e+02,   Y0: 2.7947e+00,  elapsed time 182
INFO   step:   134,    loss: 1.7838e+02,   Y0: 2.7954e+00,  elapsed time 183
INFO   step:   135,    loss: 1.7837e+02,   Y0: 2.7961e+00,  elapsed time 184
INFO   step:   136,    loss: 1.7836e+02,   Y0: 2.7973e+00,  elapsed time 185
INFO   step:   137,    loss: 1.7834e+02,   Y0: 2.7978e+00,  elapsed time 187
INFO   step:   138,    loss: 1.7832e+02,   Y0: 2.7988e+00,  elapsed time 188
INFO   step:   139,    loss: 1.7831e+02,   Y0: 2.7987e+00,  elapsed time 189
INFO   step:   140,    loss: 1.7829e+02,   Y0: 2.7976e+00,  elapsed time 190
INFO   step:   141,    loss: 1.7827e+02,   Y0: 2.7963e+00,  elapsed time 191
INFO   step:   142,    loss: 1.7825e+02,   Y0: 2.7954e+00,  elapsed time 193
INFO   step:   143,    loss: 1.7823e+02,   Y0: 2.7945e+00,  elapsed time 194
INFO   step:   144,    loss: 1.7822e+02,   Y0: 2.7942e+00,  elapsed time 195
INFO   step:   145,    loss: 1.7820e+02,   Y0: 2.7940e+00,  elapsed time 196
INFO   step:   146,    loss: 1.7819e+02,   Y0: 2.7933e+00,  elapsed time 197
INFO   step:   147,    loss: 1.7817e+02,   Y0: 2.7922e+00,  elapsed time 198
INFO   step:   148,    loss: 1.7815e+02,   Y0: 2.7912e+00,  elapsed time 200
INFO   step:   149,    loss: 1.7813e+02,   Y0: 2.7906e+00,  elapsed time 201
Delta:  155 ,  155.05
Other:  -50 ,  -50
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_10:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_11:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_12:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_13:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_14:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_15:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_16:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_17:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_18:0' shape=(?, 2) dtype=float64>, <tf.Tensor 'MatMul_19:0' shape=(?, 2) dtype=float64>]
num_iterations:  150
total time intervals:  20
# of dimensions:  2
Loss out:  203.61986404986018
Output_Z_Vals:  [[[ 1.54275948e+02 -4.92515743e+01]
  [ 1.54275948e+02 -4.92515743e+01]
  [ 1.54275948e+02 -4.92515743e+01]
  ...
  [ 1.54275948e+02 -4.92515743e+01]
  [ 1.54275948e+02 -4.92515743e+01]
  [ 1.54275948e+02 -4.92515743e+01]]

 [[ 9.34309198e-03  2.06165283e-02]
  [ 3.79674873e-03  1.54647792e-01]
  [ 1.42512971e-02  2.66520014e-02]
  ...
  [ 8.46505366e-03  1.95368309e-02]
  [ 3.52086147e-02  9.82587313e-02]
  [ 1.05151473e-02  2.20577697e-02]]

 [[ 5.46242919e-02 -3.85783687e-02]
  [ 4.75543831e-02 -4.92024166e-02]
  [ 8.29746374e-02 -1.07485487e-02]
  ...
  [ 7.16177292e-02 -1.30420994e-02]
  [ 8.19154906e-02 -8.28546319e-03]
  [ 8.04460045e-02 -1.03063648e-02]]

 ...

 [[-2.05569919e-01 -1.79548486e-01]
  [-1.79206100e-01 -4.45795073e-01]
  [-1.95071398e-01 -3.25830663e-01]
  ...
  [-1.46137783e-01 -5.88574253e-01]
  [-1.97627530e-01 -2.90212803e-01]
  [-1.34170794e-01 -6.22758753e-01]]

 [[ 4.32884466e-01 -4.62563336e-01]
  [ 1.30988948e-01 -2.00319342e-01]
  [ 2.73300240e-01 -3.14662163e-01]
  ...
  [-1.82140428e-01 -8.08106603e-02]
  [ 2.66752665e-01 -3.29688096e-01]
  [-4.16829224e-01  5.58385812e-02]]

 [[-3.22851956e-01 -2.07831377e-01]
  [ 1.48307884e-01  3.18367337e-02]
  [-1.12965330e-01 -1.53970466e-01]
  ...
  [ 1.58498803e-01  7.23972181e-02]
  [-1.62408832e-01 -1.66658495e-01]
  [ 2.53274499e-02 -8.17819760e-02]]]
Z_Vals dimensionality:  (20, 200, 2)
X_test:  [[[1.00000000e+02 1.01581539e+02 9.95702878e+01 ... 9.16049458e+01
   9.14784609e+01 9.28232556e+01]
  [4.00000000e-02 4.21536433e-02 4.06586719e-02 ... 4.38796077e-02
   4.53275316e-02 4.39828481e-02]]

 [[1.00000000e+02 9.93628522e+01 9.87168942e+01 ... 1.01848062e+02
   1.03443434e+02 1.05030885e+02]
  [4.00000000e-02 4.14633865e-02 4.34162476e-02 ... 4.47252355e-02
   4.42773291e-02 4.16252231e-02]]

 [[1.00000000e+02 1.00953998e+02 1.00828669e+02 ... 9.56539260e+01
   9.61854897e+01 9.37364905e+01]
  [4.00000000e-02 3.89534589e-02 3.84246242e-02 ... 4.52736329e-02
   4.41040662e-02 4.56093045e-02]]

 ...

 [[1.00000000e+02 1.01693703e+02 1.00198761e+02 ... 1.04330388e+02
   1.04051256e+02 1.04270099e+02]
  [4.00000000e-02 3.84185689e-02 3.95236233e-02 ... 2.89596849e-02
   2.91428205e-02 2.99862401e-02]]

 [[1.00000000e+02 9.87664660e+01 1.00538851e+02 ... 9.52080647e+01
   9.50759707e+01 9.36806300e+01]
  [4.00000000e-02 4.11151495e-02 4.02739368e-02 ... 4.23487286e-02
   4.32979392e-02 4.45097834e-02]]

 [[1.00000000e+02 1.01431628e+02 1.00913207e+02 ... 1.08042344e+02
   1.08298396e+02 1.06535346e+02]
  [4.00000000e-02 3.88948084e-02 3.89763794e-02 ... 3.33446335e-02
   3.26630792e-02 3.40251683e-02]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 9.34309198e-03  2.06165283e-02]
 [ 5.46242919e-02 -3.85783687e-02]
 [ 5.28022063e-01 -2.25168066e-01]
 [-2.48259561e-02  7.86748206e-03]
 [ 5.02140143e-01 -2.62283628e-02]
 [-6.89129639e-01 -5.86432253e-01]
 [-6.78048293e-02 -8.10123277e-02]
 [-1.80549226e+00  4.88453119e-01]
 [-4.96491516e-02  9.91500973e-02]
 [ 2.78611665e-02 -2.25671125e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 1.10111010e-01 -1.34030896e-01]
 [ 8.89133384e-02  4.79906592e-04]
 [-1.14731692e-01 -1.87815099e-01]
 [ 1.67125895e-01  2.58225846e-01]
 [-1.64904738e-03 -9.59964584e-02]
 [-2.05569919e-01 -1.79548486e-01]
 [ 4.32884466e-01 -4.62563336e-01]
 [-3.22851956e-01 -2.07831377e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.12450706]
curr_Stock_Price:  101.5815388706631
curr_Factors:  [1.01581539e+02 4.21536433e-02]
mat_Sqrt:  [[ 2.08560638e+01  0.00000000e+00]
 [-8.21254097e-03  1.88172953e-02]]
grads:  [8.79402885e-04 1.09561592e+00]
Stock Position:  0.000879402884519315
Bond Position:  [13.03517596]


portfolio before change:  [13.12599756]
curr_Stock_Price:  99.57028776124037
curr_Factors:  [9.95702878e+01 4.06586719e-02]
mat_Sqrt:  [[ 2.00773485e+01  0.00000000e+00]
 [-8.06559825e-03  1.84806072e-02]]
grads:  [ 1.88208675e-03 -2.08750547e+00]
Stock Position:  0.0018820867450236416
Bond Position:  [12.93859764]


portfolio before change:  [13.12497644]
curr_Stock_Price:  97.3088739981802
curr_Factors:  [9.73088740e+01 4.15525295e-02]
mat_Sqrt:  [[ 1.98358667e+01  0.00000000e+00]
 [-8.15377503e-03  1.86826456e-02]]
grads:  [  0.02166533 -12.05225804]
Stock Position:  0.021665333299337626
Bond Position:  [11.01674725]


portfolio before change:  [13.07306395]
curr_Stock_Price:  94.78562569671406
curr_Factors:  [9.47856257e+01 4.29533297e-02]
mat_Sqrt:  [[ 1.96444964e+01  0.00000000e+00]
 [-8.29007404e-03  1.89949459e-02]]
grads:  [-0.00108897  0.41418818]
Stock Position:  -0.0010889719458899584
Bond Position:  [13.17628284]


portfolio before change:  [13.07919877]
curr_Stock_Price:  92.177355314615
curr_Factors:  [9.21773553e+01 4.33549863e-02]
mat_Sqrt:  [[ 1.91930401e+01  0.00000000e+00]
 [-8.32874409e-03  1.90835501e-02]]
grads:  [ 0.0255662  -1.37439641]
Stock Position:  0.025566202376388767
Bond Position:  [10.72257385]


portfolio before change:  [13.09133324]
curr_Stock_Price:  92.5471204439179
curr_Factors:  [9.25471204e+01 4.15831545e-02]
mat_Sqrt:  [[ 1.88721607e+01  0.00000000e+00]
 [-8.15677922e-03  1.86895291e-02]]
grads:  [ -0.05007745 -31.37758315]
Stock Position:  -0.050077448507699546
Bond Position:  [17.72585689]


portfolio before change:  [13.15195859]
curr_Stock_Price:  91.42499187936458
curr_Factors:  [9.14249919e+01 4.08392451e-02]
mat_Sqrt:  [[ 1.84758226e+01  0.00000000e+00]
 [-8.08348887e-03  1.85215998e-02]]
grads:  [-0.00558359 -4.37393792]
Stock Position:  -0.005583594841832911
Bond Position:  [13.6624387]


portfolio before change:  [13.16017215]
curr_Stock_Price:  90.56577471651114
curr_Factors:  [9.05657747e+01 4.15859525e-02]
mat_Sqrt:  [[ 1.84687471e+01  0.00000000e+00]
 [-8.15705364e-03  1.86901579e-02]]
grads:  [-0.08621667 26.13424254]
Stock Position:  -0.08621666831708352
Bond Position:  [20.96845151]


portfolio before change:  [13.21157484]
curr_Stock_Price:  90.03038022101228
curr_Factors:  [9.00303802e+01 4.20066099e-02]
mat_Sqrt:  [[ 1.84521893e+01  0.00000000e+00]
 [-8.19820564e-03  1.87844490e-02]]
grads:  [-3.45568830e-04  5.27830747e+00]
Stock Position:  -0.0003455688299321099
Bond Position:  [13.24268654]


portfolio before change:  [13.21440477]
curr_Stock_Price:  91.42274967129133
curr_Factors:  [9.14227497e+01 4.25600612e-02]
mat_Sqrt:  [[ 1.88605955e+01  0.00000000e+00]
 [-8.25203599e-03  1.89077898e-02]]
grads:  [ 9.55010731e-04 -1.19353519e+00]
Stock Position:  0.0009550107310525023
Bond Position:  [13.12709506]


portfolio before change:  [13.21849659]
curr_Stock_Price:  92.27052956761844
curr_Factors:  [9.22705296e+01 4.14680282e-02]
mat_Sqrt:  [[ 1.87896939e+01  0.00000000e+00]
 [-8.14548004e-03  1.86636394e-02]]
grads:  [1.43644916e-02 1.87299374e+01]
Stock Position:  0.01436449162583937
Bond Position:  [11.89307734]


portfolio before change:  [13.23328388]
curr_Stock_Price:  93.09294969486231
curr_Factors:  [9.30929497e+01 4.41885663e-02]
mat_Sqrt:  [[ 1.95691403e+01  0.00000000e+00]
 [-8.40843066e-03  1.92661350e-02]]
grads:  [ 2.63757787e-03 -6.95681287e+00]
Stock Position:  0.0026375778686454705
Bond Position:  [12.98774398]


portfolio before change:  [13.23748867]
curr_Stock_Price:  93.45595302921431
curr_Factors:  [9.34559530e+01 4.31113855e-02]
mat_Sqrt:  [[ 1.94045225e+01  0.00000000e+00]
 [-8.30531257e-03  1.90298618e-02]]
grads:  [0.00459289 0.02521861]
Stock Position:  0.004592887386123727
Bond Position:  [12.808256]


portfolio before change:  [13.23162675]
curr_Stock_Price:  91.48238313072102
curr_Factors:  [9.14823831e+01 4.43152335e-02]
mat_Sqrt:  [[ 1.92581245e+01  0.00000000e+00]
 [-8.42047348e-03  1.92937286e-02]]
grads:  [-0.01021392 -9.73451547]
Stock Position:  -0.01021391885952127
Bond Position:  [14.16602039]


portfolio before change:  [13.23734279]
curr_Stock_Price:  91.2695278539633
curr_Factors:  [9.12695279e+01 4.50300149e-02]
mat_Sqrt:  [[ 1.93676465e+01  0.00000000e+00]
 [-8.48811074e-03  1.94487050e-02]]
grads:  [ 0.01444806 13.27727714]
Stock Position:  0.014448058699131329
Bond Position:  [11.91867529]


portfolio before change:  [13.23122941]
curr_Stock_Price:  90.64014131675528
curr_Factors:  [9.06401413e+01 4.78052048e-02]
mat_Sqrt:  [[ 1.98179243e+01  0.00000000e+00]
 [-8.74576055e-03  2.00390549e-02]]
grads:  [-2.19727031e-03 -4.79046836e+00]
Stock Position:  -0.002197270306564706
Bond Position:  [13.43039031]


portfolio before change:  [13.23673963]
curr_Stock_Price:  89.66065499283464
curr_Factors:  [8.96606550e+01 4.72998386e-02]
mat_Sqrt:  [[ 1.94998709e+01  0.00000000e+00]
 [-8.69941042e-03  1.99328534e-02]]
grads:  [-0.01456068 -9.007666  ]
Stock Position:  -0.0145606759770023
Bond Position:  [14.54225937]


portfolio before change:  [13.21206546]
curr_Stock_Price:  91.6049458041305
curr_Factors:  [9.16049458e+01 4.38796077e-02]
mat_Sqrt:  [[ 1.91889093e+01  0.00000000e+00]
 [-8.37898397e-03  1.91986641e-02]]
grads:  [ 1.20384787e-02 -2.40935167e+01]
Stock Position:  0.012038478698246211
Bond Position:  [12.10928127]


portfolio before change:  [13.21357047]
curr_Stock_Price:  91.47846094774454
curr_Factors:  [9.14784609e+01 4.53275316e-02]
mat_Sqrt:  [[ 1.94760053e+01  0.00000000e+00]
 [-8.51610537e-03  1.95128487e-02]]
grads:  [ -0.02123418 -10.6510013 ]
Stock Position:  -0.021234180166073608
Bond Position:  [15.15604059]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.18880434]
Stock Price:  92.82325561906738
PL:  [13.18880434]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.79674873e-03  1.54647792e-01]
 [ 4.75543831e-02 -4.92024166e-02]
 [ 6.39224314e-01 -2.59107404e-01]
 [-2.73077930e-02 -9.95027100e-02]
 [ 5.58516920e-02 -1.90544208e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-2.60151394e-01 -1.63111810e-01]
 [-1.39863745e+00  7.47881715e-01]
 [ 3.86247237e-02 -7.51162188e-02]
 [ 1.40420744e-01  4.67544444e-01]
 [-4.81921366e-01 -9.98644059e-02]
 [-2.35664468e-02 -1.10553874e-02]
 [ 1.20117209e-02 -5.60420767e-02]
 [ 8.90279466e-02  1.47595996e-01]
 [-1.16740988e-01 -6.21609387e-02]
 [-1.41791440e-01 -1.32115214e-01]
 [-1.79206100e-01 -4.45795073e-01]
 [ 1.30988948e-01 -2.00319342e-01]
 [ 1.48307884e-01  3.18367337e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.60544208]
curr_Stock_Price:  99.36285224945755
curr_Factors:  [9.93628522e+01 4.14633865e-02]
mat_Sqrt:  [[ 2.02328208e+01  0.00000000e+00]
 [-8.14502415e-03  1.86625949e-02]]
grads:  [3.52351159e-03 8.28651070e+00]
Stock Position:  0.00352351158737586
Bond Position:  [-1.95554824]


portfolio before change:  [-1.60820707]
curr_Stock_Price:  98.71689415588436
curr_Factors:  [9.87168942e+01 4.34162476e-02]
mat_Sqrt:  [[ 2.05692107e+01  0.00000000e+00]
 [-8.33462634e-03  1.90970280e-02]]
grads:  [ 1.26794793e-03 -2.57644365e+00]
Stock Position:  0.0012679479253750769
Bond Position:  [-1.73337495]


portfolio before change:  [-1.60845876]
curr_Stock_Price:  98.86020555352925
curr_Factors:  [9.88602056e+01 4.31739996e-02]
mat_Sqrt:  [[ 2.05415235e+01  0.00000000e+00]
 [-8.31134161e-03  1.90436760e-02]]
grads:  [  0.02561351 -13.60595529]
Stock Position:  0.025613512636228936
Bond Position:  [-4.14061588]


portfolio before change:  [-1.59341542]
curr_Stock_Price:  99.48794551329046
curr_Factors:  [9.94879455e+01 4.38969232e-02]
mat_Sqrt:  [[ 2.08443090e+01  0.00000000e+00]
 [-8.38063704e-03  1.92024518e-02]]
grads:  [-3.39346034e-03 -5.18177111e+00]
Stock Position:  -0.003393460335616664
Bond Position:  [-1.25580702]


portfolio before change:  [-1.60087746]
curr_Stock_Price:  101.59436515818736
curr_Factors:  [1.01594365e+02 4.27788394e-02]
mat_Sqrt:  [[ 2.10128093e+01  0.00000000e+00]
 [-8.27321842e-03  1.89563248e-02]]
grads:  [ 0.00226222 -1.00517484]
Stock Position:  0.0022622230200889746
Bond Position:  [-1.83070657]


portfolio before change:  [-1.5997212]
curr_Stock_Price:  102.30781752411094
curr_Factors:  [1.02307818e+02 4.24400812e-02]
mat_Sqrt:  [[ 2.10764238e+01  0.00000000e+00]
 [-8.24039623e-03  1.88811197e-02]]
grads:  [-2.75009727e-05 -1.02489558e+00]
Stock Position:  -2.7500972703850738e-05
Bond Position:  [-1.59690764]


portfolio before change:  [-1.60014266]
curr_Stock_Price:  103.11438122748682
curr_Factors:  [1.03114381e+02 4.49023899e-02]
mat_Sqrt:  [[ 2.18501271e+01  0.00000000e+00]
 [-8.47607361e-03  1.94211245e-02]]
grads:  [-0.01516418 -8.39868003]
Stock Position:  -0.015164178338453519
Bond Position:  [-0.03649779]


portfolio before change:  [-1.60063037]
curr_Stock_Price:  103.14594143725654
curr_Factors:  [1.03145941e+02 4.43304942e-02]
mat_Sqrt:  [[ 2.17171800e+01  0.00000000e+00]
 [-8.42192322e-03  1.92970503e-02]]
grads:  [-0.04937267 38.75627117]
Stock Position:  -0.049372667554804635
Bond Position:  [3.4919599]


portfolio before change:  [-1.63826269]
curr_Stock_Price:  103.92583474429028
curr_Factors:  [1.03925835e+02 4.26958319e-02]
mat_Sqrt:  [[ 2.14741638e+01  0.00000000e+00]
 [-8.26518790e-03  1.89379246e-02]]
grads:  [ 2.72016093e-04 -3.96644408e+00]
Stock Position:  0.00027201609299042046
Bond Position:  [-1.66653218]


portfolio before change:  [-1.63853463]
curr_Stock_Price:  104.45792873311116
curr_Factors:  [1.04457929e+02 4.15099806e-02]
mat_Sqrt:  [[ 2.12822566e+01  0.00000000e+00]
 [-8.14959932e-03  1.86730779e-02]]
grads:  [1.61859653e-02 2.50384241e+01]
Stock Position:  0.01618596534113846
Bond Position:  [-3.32928705]


portfolio before change:  [-1.61542958]
curr_Stock_Price:  105.93683177643426
curr_Factors:  [1.05936832e+02 4.10821789e-02]
mat_Sqrt:  [[ 2.14720601e+01  0.00000000e+00]
 [-8.10749568e-03  1.85766063e-02]]
grads:  [-0.02447393 -5.37581538]
Stock Position:  -0.02447393319204563
Bond Position:  [0.97726136]


portfolio before change:  [-1.57774754]
curr_Stock_Price:  104.40713484572602
curr_Factors:  [1.04407135e+02 4.24050789e-02]
mat_Sqrt:  [[ 2.15000325e+01  0.00000000e+00]
 [-8.23699740e-03  1.88733320e-02]]
grads:  [-0.00132053 -0.58576765]
Stock Position:  -0.00132052886554735
Bond Position:  [-1.4398749]


portfolio before change:  [-1.57802399]
curr_Stock_Price:  104.3438549141949
curr_Factors:  [1.04343855e+02 4.36607087e-02]
mat_Sqrt:  [[ 2.18027999e+01  0.00000000e+00]
 [-8.35805803e-03  1.91507168e-02]]
grads:  [-5.70892119e-04 -2.92636967e+00]
Stock Position:  -0.0005708921190173159
Bond Position:  [-1.5184549]


portfolio before change:  [-1.5767021]
curr_Stock_Price:  101.36333788782004
curr_Factors:  [1.01363338e+02 4.50784401e-02]
mat_Sqrt:  [[ 2.15211435e+01  0.00000000e+00]
 [-8.49267356e-03  1.94591597e-02]]
grads:  [7.12992414e-03 7.58491108e+00]
Stock Position:  0.007129924136605581
Bond Position:  [-2.29941501]


portfolio before change:  [-1.56906261]
curr_Stock_Price:  102.51544210563596
curr_Factors:  [1.02515442e+02 4.72612045e-02]
mat_Sqrt:  [[ 2.22864904e+01  0.00000000e+00]
 [-8.69585690e-03  1.99247112e-02]]
grads:  [-0.00645549 -3.1197912 ]
Stock Position:  -0.006455491357983767
Bond Position:  [-0.90727506]


portfolio before change:  [-1.55045077]
curr_Stock_Price:  99.597200501797
curr_Factors:  [9.95972005e+01 4.91829588e-02]
mat_Sqrt:  [[ 2.20879015e+01  0.00000000e+00]
 [-8.87089252e-03  2.03257682e-02]]
grads:  [-0.00902989 -6.49988787]
Stock Position:  -0.009029886610561335
Bond Position:  [-0.65109934]


portfolio before change:  [-1.5563155]
curr_Stock_Price:  100.22865148014975
curr_Factors:  [1.00228651e+02 4.87566008e-02]
mat_Sqrt:  [[ 2.21313852e+01  0.00000000e+00]
 [-8.83235876e-03  2.02374763e-02]]
grads:  [-1.68885507e-02 -2.20281950e+01]
Stock Position:  -0.01688855071008418
Bond Position:  [0.13640117]


portfolio before change:  [-1.58363089]
curr_Stock_Price:  101.84806235694101
curr_Factors:  [1.01848062e+02 4.47252355e-02]
mat_Sqrt:  [[ 2.15391762e+01  0.00000000e+00]
 [-8.45933666e-03  1.93827753e-02]]
grads:  [ 2.02247380e-03 -1.03349154e+01]
Stock Position:  0.002022473798000676
Bond Position:  [-1.78961593]


portfolio before change:  [-1.58085176]
curr_Stock_Price:  103.44343434898545
curr_Factors:  [1.03443434e+02 4.42773291e-02]
mat_Sqrt:  [[ 2.17667525e+01  0.00000000e+00]
 [-8.41687155e-03  1.92854755e-02]]
grads:  [0.00745185 1.65081404]
Stock Position:  0.00745184996894529
Bond Position:  [-2.35169671]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.56961031]
Stock Price:  105.0308854262702
PL:  [-6.60049573]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.42512971e-02  2.66520014e-02]
 [ 8.29746374e-02 -1.07485487e-02]
 [ 7.37696075e-01 -2.89161351e-01]
 [ 2.77502554e-01 -9.42458914e-02]
 [ 8.39129403e-02 -1.10041371e-02]
 [ 3.86802893e-02 -3.56738767e-02]
 [-4.49844661e-02 -1.01971764e-01]
 [-1.25757090e+00  7.20143001e-01]
 [ 8.21745661e-02 -6.25178056e-02]
 [ 1.55268441e-02 -8.67360949e-02]
 [-6.72539508e-03  1.01285987e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.63840921e-01 -2.90831611e-02]
 [-5.64904583e-02 -6.03685419e-02]
 [ 4.46419488e-02  2.74076148e-02]
 [-1.38533512e-01 -1.37593955e-01]
 [-1.95071398e-01 -3.25830663e-01]
 [ 2.73300240e-01 -3.14662163e-01]
 [-1.12965330e-01 -1.53970466e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.95823587]
curr_Stock_Price:  100.9539976574334
curr_Factors:  [1.00953998e+02 3.89534589e-02]
mat_Sqrt:  [[ 1.99249176e+01  0.00000000e+00]
 [-7.89465226e-03  1.80889208e-02]]
grads:  [1.29903594e-03 1.47338814e+00]
Stock Position:  0.0012990359399331207
Bond Position:  [8.82709299]


portfolio before change:  [8.96028011]
curr_Stock_Price:  100.82866943044553
curr_Factors:  [1.00828669e+02 3.84246242e-02]
mat_Sqrt:  [[ 1.97646374e+01  0.00000000e+00]
 [-7.84087998e-03  1.79657130e-02]]
grads:  [ 0.00396079 -0.59828122]
Stock Position:  0.003960790409605378
Bond Position:  [8.56091888]


portfolio before change:  [8.96368442]
curr_Stock_Price:  101.14774950825755
curr_Factors:  [1.0114775e+02 3.7628063e-02]
mat_Sqrt:  [[ 1.96205942e+01  0.00000000e+00]
 [-7.75918171e-03  1.77785188e-02]]
grads:  [  0.03116601 -16.26464806]
Stock Position:  0.03116601412250701
Bond Position:  [5.81131223]


portfolio before change:  [8.99714494]
curr_Stock_Price:  102.17475000864826
curr_Factors:  [1.0217475e+02 3.9606773e-02]
mat_Sqrt:  [[ 2.03342572e+01  0.00000000e+00]
 [-7.96058018e-03  1.82399806e-02]]
grads:  [ 0.01162424 -5.16699515]
Stock Position:  0.01162423942179692
Bond Position:  [7.80944118]


portfolio before change:  [8.97492246]
curr_Stock_Price:  100.09503723933825
curr_Factors:  [1.00095037e+02 4.11198484e-02]
mat_Sqrt:  [[ 2.02973013e+01  0.00000000e+00]
 [-8.11121184e-03  1.85851211e-02]]
grads:  [ 0.00389758 -0.59209392]
Stock Position:  0.003897579290262259
Bond Position:  [8.58479412]


portfolio before change:  [8.97799623]
curr_Stock_Price:  100.332955129676
curr_Factors:  [1.00332955e+02 4.14273680e-02]
mat_Sqrt:  [[ 2.04214829e+01  0.00000000e+00]
 [-8.14148566e-03  1.86544872e-02]]
grads:  [ 1.13169711e-03 -1.91234829e+00]
Stock Position:  0.0011316971068396043
Bond Position:  [8.86444972]


portfolio before change:  [8.9783707]
curr_Stock_Price:  98.70538325411988
curr_Factors:  [9.87053833e+01 4.27535984e-02]
mat_Sqrt:  [[ 2.04092561e+01  0.00000000e+00]
 [-8.27077732e-03  1.89507316e-02]]
grads:  [-4.38470624e-03 -5.38088802e+00]
Stock Position:  -0.004384706240605288
Bond Position:  [9.41116481]


portfolio before change:  [8.98158874]
curr_Stock_Price:  98.50811771988131
curr_Factors:  [9.85081177e+01 4.17768198e-02]
mat_Sqrt:  [[ 2.01344472e+01  0.00000000e+00]
 [-8.17575145e-03  1.87329999e-02]]
grads:  [-0.0468488  38.44248139]
Stock Position:  -0.04684880216978617
Bond Position:  [13.59657606]


portfolio before change:  [8.94888279]
curr_Stock_Price:  99.27879954549476
curr_Factors:  [9.92787995e+01 4.11128613e-02]
mat_Sqrt:  [[ 2.01300739e+01  0.00000000e+00]
 [-8.11052267e-03  1.85835420e-02]]
grads:  [ 2.72674404e-03 -3.36414907e+00]
Stock Position:  0.0027267440353557684
Bond Position:  [8.67817491]


portfolio before change:  [8.94612967]
curr_Stock_Price:  97.47337476555653
curr_Factors:  [9.74733748e+01 4.15570399e-02]
mat_Sqrt:  [[ 1.98704776e+01  0.00000000e+00]
 [-8.15421755e-03  1.86836596e-02]]
grads:  [-1.12367159e-03 -4.64235042e+00]
Stock Position:  -0.001123671591075761
Bond Position:  [9.05565773]


portfolio before change:  [8.94669796]
curr_Stock_Price:  98.98263288057743
curr_Factors:  [9.89826329e+01 4.03073272e-02]
mat_Sqrt:  [[ 1.98724312e+01  0.00000000e+00]
 [-8.03067391e-03  1.84005855e-02]]
grads:  [1.88600144e-03 5.50449806e+00]
Stock Position:  0.0018860014437129743
Bond Position:  [8.76001657]


portfolio before change:  [8.94778746]
curr_Stock_Price:  98.3989745430309
curr_Factors:  [9.83989745e+01 4.05668115e-02]
mat_Sqrt:  [[ 1.98187386e+01  0.00000000e+00]
 [-8.05648176e-03  1.84597187e-02]]
grads:  [ 0.00242278 -0.46541245]
Stock Position:  0.002422781756335213
Bond Position:  [8.70938822]


portfolio before change:  [8.94875422]
curr_Stock_Price:  97.89919483225886
curr_Factors:  [9.78991948e+01 4.09299252e-02]
mat_Sqrt:  [[ 1.98061286e+01  0.00000000e+00]
 [-8.09245824e-03  1.85421512e-02]]
grads:  [ 0.00763137 -1.56848905]
Stock Position:  0.0076313747033369085
Bond Position:  [8.20164878]


portfolio before change:  [8.95029718]
curr_Stock_Price:  97.8326663810822
curr_Factors:  [9.78326664e+01 4.11574624e-02]
mat_Sqrt:  [[ 1.98476085e+01  0.00000000e+00]
 [-8.11492082e-03  1.85936195e-02]]
grads:  [-0.00417367 -3.24673429]
Stock Position:  -0.004173674116826233
Bond Position:  [9.35861885]


portfolio before change:  [8.95520578]
curr_Stock_Price:  97.21722478203826
curr_Factors:  [9.72172248e+01 4.11636769e-02]
mat_Sqrt:  [[ 1.97242410e+01  0.00000000e+00]
 [-8.11553344e-03  1.85950231e-02]]
grads:  [0.00286975 1.47392206]
Stock Position:  0.0028697485821726817
Bond Position:  [8.67621679]


portfolio before change:  [8.95375228]
curr_Stock_Price:  95.95480484703168
curr_Factors:  [9.59548048e+01 4.11345307e-02]
mat_Sqrt:  [[ 1.94612172e+01  0.00000000e+00]
 [-8.11265981e-03  1.85884388e-02]]
grads:  [-0.01020411 -7.40212536]
Stock Position:  -0.010204111808413912
Bond Position:  [9.93288584]


portfolio before change:  [8.95636123]
curr_Stock_Price:  95.942514518151
curr_Factors:  [9.59425145e+01 4.30680340e-02]
mat_Sqrt:  [[ 1.99107959e+01  0.00000000e+00]
 [-8.30113573e-03  1.90202914e-02]]
grads:  [-1.69393308e-02 -1.71306872e+01]
Stock Position:  -0.016939330786133293
Bond Position:  [10.58156322]


portfolio before change:  [8.96389544]
curr_Stock_Price:  95.65392600304396
curr_Factors:  [9.56539260e+01 4.52736329e-02]
mat_Sqrt:  [[ 2.03528613e+01  0.00000000e+00]
 [-8.51104063e-03  1.95012440e-02]]
grads:  [ 6.68065345e-03 -1.61354918e+01]
Stock Position:  0.006680653452555087
Bond Position:  [8.32486471]


portfolio before change:  [8.96952811]
curr_Stock_Price:  96.18548974472303
curr_Factors:  [9.61854897e+01 4.41040662e-02]
mat_Sqrt:  [[ 2.01998840e+01  0.00000000e+00]
 [-8.40038725e-03  1.92477052e-02]]
grads:  [-0.00891904 -7.99941937]
Stock Position:  -0.008919038866214753
Bond Position:  [9.82741023]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.99382799]
Stock Price:  93.73649051745565
PL:  [8.99382799]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [-6.79787058e-03  7.68469365e-04]
 [-5.42534656e-01  3.67003895e-01]
 [ 1.06575845e+00 -3.89287203e-01]
 [ 4.44999898e-01 -5.24303216e-02]
 [ 2.53421471e-01 -3.11647160e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-3.68830388e-01 -1.31822967e-01]
 [-1.46830432e+00  7.54612540e-01]
 [ 3.77116165e-02 -7.64870146e-02]
 [ 1.25955982e-01  3.50649899e-01]
 [-4.65224443e-01 -9.40056554e-02]
 [-4.03761902e-02 -1.48498628e-02]
 [-4.37746501e-02 -9.55882175e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15048578e-01 -6.12004053e-02]
 [-1.31601753e-02 -5.85794466e-02]
 [-1.42087937e-01 -5.99799539e-01]
 [-3.75191741e-01  5.34720663e-02]
 [ 5.29466591e-02 -7.98039036e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [26.82327989]
curr_Stock_Price:  103.64490539861832
curr_Factors:  [1.03644905e+02 3.75097000e-02]
mat_Sqrt:  [[ 2.00733453e+01  0.00000000e+00]
 [-7.74696844e-03  1.77505346e-02]]
grads:  [-0.00032194  0.04329274]
Stock Position:  -0.00032194350079138025
Bond Position:  [26.85664769]


portfolio before change:  [26.82963361]
curr_Stock_Price:  104.7670841400712
curr_Factors:  [1.04767084e+02 3.60464268e-02]
mat_Sqrt:  [[ 1.98909702e+01  0.00000000e+00]
 [-7.59435862e-03  1.74008616e-02]]
grads:  [-1.92228444e-02  2.10911335e+01]
Stock Position:  -0.019222844375845462
Bond Position:  [28.84355497]


portfolio before change:  [26.8138411]
curr_Stock_Price:  105.96380082972117
curr_Factors:  [1.05963801e+02 3.61756640e-02]
mat_Sqrt:  [[ 2.01542102e+01  0.00000000e+00]
 [-7.60796047e-03  1.74320274e-02]]
grads:  [  0.04445025 -22.33172278]
Stock Position:  0.044450245430221136
Bond Position:  [22.10372415]


portfolio before change:  [26.75529133]
curr_Stock_Price:  104.5222701438333
curr_Factors:  [1.04522270e+02 3.68522262e-02]
mat_Sqrt:  [[ 2.00650709e+01  0.00000000e+00]
 [-7.67877346e-03  1.75942803e-02]]
grads:  [ 0.02103743 -2.97996398]
Stock Position:  0.02103742533638097
Bond Position:  [24.55641188]


portfolio before change:  [26.75693945]
curr_Stock_Price:  104.30875746125041
curr_Factors:  [1.04308757e+02 3.70273963e-02]
mat_Sqrt:  [[ 2.00716169e+01  0.00000000e+00]
 [-7.69700163e-03  1.76360463e-02]]
grads:  [ 0.01194822 -1.76710332]
Stock Position:  0.011948218996081134
Bond Position:  [25.51063557]


portfolio before change:  [26.76081519]
curr_Stock_Price:  104.09929406412886
curr_Factors:  [1.04099294e+02 3.90096384e-02]
mat_Sqrt:  [[ 2.05605035e+01  0.00000000e+00]
 [-7.90034312e-03  1.81019602e-02]]
grads:  [-2.81910487e-05 -1.06900998e+00]
Stock Position:  -2.8191048712925764e-05
Bond Position:  [26.76374986]


portfolio before change:  [26.76750575]
curr_Stock_Price:  104.14241752807443
curr_Factors:  [1.04142418e+02 4.04808136e-02]
mat_Sqrt:  [[ 2.09532923e+01  0.00000000e+00]
 [-8.04793773e-03  1.84401419e-02]]
grads:  [-0.02034824 -7.14869588]
Stock Position:  -0.020348241308201565
Bond Position:  [28.88662079]


portfolio before change:  [26.75869542]
curr_Stock_Price:  104.93034254909018
curr_Factors:  [1.04930343e+02 4.10793684e-02]
mat_Sqrt:  [[ 2.12673300e+01  0.00000000e+00]
 [-8.10721835e-03  1.85759709e-02]]
grads:  [-0.05355465 40.62304706]
Stock Position:  -0.05355464982090403
Bond Position:  [32.37820317]


portfolio before change:  [26.81359853]
curr_Stock_Price:  104.0563278515503
curr_Factors:  [1.04056328e+02 4.00838126e-02]
mat_Sqrt:  [[ 2.08330572e+01  0.00000000e+00]
 [-8.00837687e-03  1.83494966e-02]]
grads:  [ 2.07840191e-04 -4.16834403e+00]
Stock Position:  0.00020784019123015038
Bond Position:  [26.79197144]


portfolio before change:  [26.82016863]
curr_Stock_Price:  103.43694802547994
curr_Factors:  [1.03436948e+02 3.99493013e-02]
mat_Sqrt:  [[ 2.06742752e+01  0.00000000e+00]
 [-7.99492853e-03  1.83186826e-02]]
grads:  [1.34946518e-02 1.91416548e+01]
Stock Position:  0.013494651809363534
Bond Position:  [25.42432303]


portfolio before change:  [26.85735754]
curr_Stock_Price:  105.72170802778834
curr_Factors:  [1.05721708e+02 3.73818831e-02]
mat_Sqrt:  [[ 2.04406526e+01  0.00000000e+00]
 [-7.73375801e-03  1.77202657e-02]]
grads:  [-0.02476691 -5.30498   ]
Stock Position:  -0.024766913435991446
Bond Position:  [29.47575793]


portfolio before change:  [26.87359509]
curr_Stock_Price:  105.36366255036384
curr_Factors:  [1.05363663e+02 3.81453994e-02]
mat_Sqrt:  [[ 2.05784160e+01  0.00000000e+00]
 [-7.81233890e-03  1.79003172e-02]]
grads:  [-0.00227701 -0.82958657]
Stock Position:  -0.002277007215074267
Bond Position:  [27.11350891]


portfolio before change:  [26.87617337]
curr_Stock_Price:  107.20860081041121
curr_Factors:  [1.07208601e+02 3.75570597e-02]
mat_Sqrt:  [[ 2.07766450e+01  0.00000000e+00]
 [-7.75185755e-03  1.77617370e-02]]
grads:  [-4.11484954e-03 -5.38169310e+00]
Stock Position:  -0.0041148495441224444
Bond Position:  [27.31732063]


portfolio before change:  [26.87750322]
curr_Stock_Price:  108.54530389132255
curr_Factors:  [1.08545304e+02 3.63287901e-02]
mat_Sqrt:  [[ 2.06888574e+01  0.00000000e+00]
 [-7.62404513e-03  1.74688820e-02]]
grads:  [7.35841226e-03 8.50530044e+00]
Stock Position:  0.007358412257436769
Bond Position:  [26.07878213]


portfolio before change:  [26.86866117]
curr_Stock_Price:  106.45754786461055
curr_Factors:  [1.06457548e+02 3.51513718e-02]
mat_Sqrt:  [[ 1.99594053e+01  0.00000000e+00]
 [-7.49947964e-03  1.71834666e-02]]
grads:  [-0.00710235 -3.56158666]
Stock Position:  -0.007102347101439151
Bond Position:  [27.62475962]


portfolio before change:  [26.87265571]
curr_Stock_Price:  106.8676247545416
curr_Factors:  [1.06867625e+02 3.26596718e-02]
mat_Sqrt:  [[ 1.93131034e+01  0.00000000e+00]
 [-7.22879484e-03  1.65632498e-02]]
grads:  [-2.00518482e-03 -3.53671214e+00]
Stock Position:  -0.002005184824691973
Bond Position:  [27.08694505]


portfolio before change:  [26.88269012]
curr_Stock_Price:  105.24092669097689
curr_Factors:  [1.05240927e+02 3.29743247e-02]
mat_Sqrt:  [[ 1.91105250e+01  0.00000000e+00]
 [-7.26353355e-03  1.66428461e-02]]
grads:  [-2.11329577e-02 -3.60394811e+01]
Stock Position:  -0.021132957671228202
Bond Position:  [29.10674217]


portfolio before change:  [26.86876776]
curr_Stock_Price:  106.2440969935715
curr_Factors:  [1.06244097e+02 3.35609433e-02]
mat_Sqrt:  [[ 1.94635426e+01  0.00000000e+00]
 [-7.32785844e-03  1.67902330e-02]]
grads:  [-0.01807762  3.18471258]
Stock Position:  -0.018077624689165545
Bond Position:  [28.78940867]


portfolio before change:  [26.85026189]
curr_Stock_Price:  107.6659722150266
curr_Factors:  [1.07665972e+02 3.38115554e-02]
mat_Sqrt:  [[ 1.97975314e+01  0.00000000e+00]
 [-7.35516748e-03  1.68528059e-02]]
grads:  [ 9.15133293e-04 -4.73534818e+00]
Stock Position:  0.0009151332928348069
Bond Position:  [26.75173317]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [26.85698983]
Stock Price:  107.7087762273209
PL:  [19.1482136]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.84809314e-02  1.01179746e-01]
 [ 6.05673693e-02 -2.96476254e-02]
 [ 6.68875217e-01 -2.68156970e-01]
 [ 1.17048106e-01 -1.13149036e-01]
 [ 5.89467899e-02 -1.93477789e-02]
 [ 2.59029230e-02 -1.83488361e-02]
 [-5.71269954e-02 -1.19410938e-01]
 [-1.26129982e+00  7.35852507e-01]
 [ 5.44498831e-02 -7.61860098e-02]
 [ 1.22571030e-01  3.32766070e-01]
 [-3.62663465e-01 -5.67420323e-02]
 [-4.08755712e-02 -9.23349605e-02]
 [-4.01691029e-02 -9.30326792e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.13909818e-01 -6.05540981e-02]
 [ 1.89982695e-02 -3.65673607e-02]
 [-1.27355047e-01 -6.54623291e-01]
 [-4.07944490e-01  6.27671996e-02]
 [ 7.69780384e-02 -7.58214470e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.35312498]
curr_Stock_Price:  100.26035657255944
curr_Factors:  [1.00260357e+02 3.96584575e-02]
mat_Sqrt:  [[ 1.99662799e+01  0.00000000e+00]
 [-7.96577253e-03  1.82518778e-02]]
grads:  [3.63810350e-03 5.54352526e+00]
Stock Position:  0.0036381034965852284
Bond Position:  [3.98836743]


portfolio before change:  [4.3524424]
curr_Stock_Price:  99.79863340138054
curr_Factors:  [9.97986334e+01 3.95620158e-02]
mat_Sqrt:  [[ 1.98501503e+01  0.00000000e+00]
 [-7.95608103e-03  1.82296718e-02]]
grads:  [ 0.00239938 -1.62633896]
Stock Position:  0.002399381561872722
Bond Position:  [4.1129874]


portfolio before change:  [4.35393563]
curr_Stock_Price:  99.9923708255665
curr_Factors:  [9.99923708e+01 3.75971601e-02]
mat_Sqrt:  [[ 1.93885078e+01  0.00000000e+00]
 [-7.75599485e-03  1.77712168e-02]]
grads:  [  0.02846232 -15.08939841]
Stock Position:  0.028462320310981813
Bond Position:  [1.50792074]


portfolio before change:  [4.36963527]
curr_Stock_Price:  100.53071808610953
curr_Factors:  [1.00530718e+02 3.70472540e-02]
mat_Sqrt:  [[ 1.93498141e+01  0.00000000e+00]
 [-7.69906530e-03  1.76407747e-02]]
grads:  [ 3.49697512e-03 -6.41406277e+00]
Stock Position:  0.0034969751182524567
Bond Position:  [4.01808185]


portfolio before change:  [4.37446787]
curr_Stock_Price:  101.62536479010807
curr_Factors:  [1.01625365e+02 3.63968050e-02]
mat_Sqrt:  [[ 1.93880329e+01  0.00000000e+00]
 [-7.63117867e-03  1.74852270e-02]]
grads:  [ 0.00260484 -1.10652146]
Stock Position:  0.0026048401672913797
Bond Position:  [4.10975004]


portfolio before change:  [4.37417993]
curr_Stock_Price:  101.1203402721921
curr_Factors:  [1.01120340e+02 3.69463191e-02]
mat_Sqrt:  [[ 1.94367707e+01  0.00000000e+00]
 [-7.68857012e-03  1.76167273e-02]]
grads:  [ 9.2066911e-04 -1.0415576e+00]
Stock Position:  0.0009206691097352417
Bond Position:  [4.28108155]


portfolio before change:  [4.37357476]
curr_Stock_Price:  99.30038763004605
curr_Factors:  [9.93003876e+01 3.89930316e-02]
mat_Sqrt:  [[ 1.96085033e+01  0.00000000e+00]
 [-7.89866132e-03  1.80981067e-02]]
grads:  [-5.57116472e-03 -6.59797958e+00]
Stock Position:  -0.005571164716416204
Bond Position:  [4.92679357]


portfolio before change:  [4.37436052]
curr_Stock_Price:  99.38045893512088
curr_Factors:  [9.93804589e+01 3.91392020e-02]
mat_Sqrt:  [[ 1.96610624e+01  0.00000000e+00]
 [-7.91345204e-03  1.81319965e-02]]
grads:  [-0.04781773 40.58309336]
Stock Position:  -0.04781773447595224
Bond Position:  [9.12650891]


portfolio before change:  [4.2211692]
curr_Stock_Price:  102.63183062287104
curr_Factors:  [1.02631831e+02 3.77982861e-02]
mat_Sqrt:  [[ 1.99534561e+01  0.00000000e+00]
 [-7.77671253e-03  1.78186869e-02]]
grads:  [ 1.06245165e-03 -4.27562425e+00]
Stock Position:  0.0010624516535477709
Bond Position:  [4.11212784]


portfolio before change:  [4.22285421]
curr_Stock_Price:  103.25007226289715
curr_Factors:  [1.03250072e+02 3.86750958e-02]
mat_Sqrt:  [[ 2.03051435e+01  0.00000000e+00]
 [-7.86639392e-03  1.80241728e-02]]
grads:  [1.31888774e-02 1.84622104e+01]
Stock Position:  0.013188877447255807
Bond Position:  [2.86110166]


portfolio before change:  [4.23880058]
curr_Stock_Price:  104.40490877593365
curr_Factors:  [1.04404909e+02 3.83564803e-02]
mat_Sqrt:  [[ 2.04475035e+01  0.00000000e+00]
 [-7.83392420e-03  1.79497753e-02]]
grads:  [-0.01894743 -3.16115557]
Stock Position:  -0.01894743372394334
Bond Position:  [6.21700567]


portfolio before change:  [4.17515242]
curr_Stock_Price:  107.84614550129226
curr_Factors:  [1.07846146e+02 3.82624799e-02]
mat_Sqrt:  [[ 2.10955661e+01  0.00000000e+00]
 [-7.82431900e-03  1.79277670e-02]]
grads:  [-3.84791056e-03 -5.15038824e+00]
Stock Position:  -0.003847910562374598
Bond Position:  [4.59013474]


portfolio before change:  [4.17946786]
curr_Stock_Price:  107.02290119125003
curr_Factors:  [1.07022901e+02 3.76883632e-02]
mat_Sqrt:  [[ 2.07768813e+01  0.00000000e+00]
 [-7.76539639e-03  1.77927584e-02]]
grads:  [-3.88758504e-03 -5.22868221e+00]
Stock Position:  -0.003887585043831775
Bond Position:  [4.59552849]


portfolio before change:  [4.1730308]
curr_Stock_Price:  108.9742648162214
curr_Factors:  [1.08974265e+02 4.00243072e-02]
mat_Sqrt:  [[ 2.18014741e+01  0.00000000e+00]
 [-8.00243035e-03  1.83358714e-02]]
grads:  [6.98288295e-03 8.10313762e+00]
Stock Position:  0.0069828829491418686
Bond Position:  [3.41207626]


portfolio before change:  [4.17470477]
curr_Stock_Price:  109.09181620338389
curr_Factors:  [1.09091816e+02 3.95157609e-02]
mat_Sqrt:  [[ 2.16858948e+01  0.00000000e+00]
 [-7.95142864e-03  1.82190118e-02]]
grads:  [-0.00647139 -3.32367632]
Stock Position:  -0.0064713858690762256
Bond Position:  [4.88068001]


portfolio before change:  [4.18465622]
curr_Stock_Price:  107.7426270629562
curr_Factors:  [1.07742627e+02 3.99956243e-02]
mat_Sqrt:  [[ 2.15473468e+01  0.00000000e+00]
 [-7.99956242e-03  1.83293002e-02]]
grads:  [ 1.4103662e-04 -1.9950222e+00]
Stock Position:  0.00014103661994293418
Bond Position:  [4.16946056]


portfolio before change:  [4.18571759]
curr_Stock_Price:  107.87645277492912
curr_Factors:  [1.07876453e+02 3.98491007e-02]
mat_Sqrt:  [[ 2.15345559e+01  0.00000000e+00]
 [-7.98489581e-03  1.82956947e-02]]
grads:  [-1.91810816e-02 -3.57801822e+01]
Stock Position:  -0.019181081622836084
Bond Position:  [6.25490463]


portfolio before change:  [4.19969649]
curr_Stock_Price:  107.2292012949817
curr_Factors:  [1.07229201e+02 4.15254639e-02]
mat_Sqrt:  [[ 2.18509497e+01  0.00000000e+00]
 [-8.15111908e-03  1.86765601e-02]]
grads:  [-0.01741575  3.36074734]
Stock Position:  -0.01741574818604392
Bond Position:  [6.06717326]


portfolio before change:  [4.20388944]
curr_Stock_Price:  107.07554918423178
curr_Factors:  [1.07075549e+02 4.25041546e-02]
mat_Sqrt:  [[ 2.20752689e+01  0.00000000e+00]
 [-8.24661429e-03  1.88953671e-02]]
grads:  [ 1.98805488e-03 -4.01270039e+00]
Stock Position:  0.0019880548805916785
Bond Position:  [3.99101737]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.20656761]
Stock Price:  107.92073961293589
PL:  [-3.71417201]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.87902911e-03  1.55309235e-01]
 [ 4.79375750e-02 -4.86265889e-02]
 [ 6.27700004e-01 -2.55590142e-01]
 [-1.23263087e-01 -1.37314771e-01]
 [ 1.68689351e-01 -2.75132894e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-6.84865584e-02 -1.35728928e-01]
 [-1.32005760e+00  7.40587499e-01]
 [ 6.32732908e-02 -7.80765778e-02]
 [ 1.08816624e-01  2.63875119e-01]
 [-7.89320606e-02 -9.50638324e-02]
 [ 3.98604205e-02 -8.77499115e-03]
 [ 8.53954374e-02 -2.22282794e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15440985e-01 -6.14231173e-02]
 [-3.59062206e-02 -7.38284549e-02]
 [-1.36350710e-01 -6.12898171e-01]
 [-2.30602669e-01 -4.57590117e-02]
 [ 1.57788334e-01  4.40827691e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.24159498]
curr_Stock_Price:  99.41765642306417
curr_Factors:  [9.94176564e+01 3.82156145e-02]
mat_Sqrt:  [[ 1.94349731e+01  0.00000000e+00]
 [-7.81952576e-03  1.79167844e-02]]
grads:  [3.68724649e-03 8.66836549e+00]
Stock Position:  0.0036872464855615805
Bond Position:  [-1.60817239]


portfolio before change:  [-1.24431475]
curr_Stock_Price:  98.78909029359555
curr_Factors:  [9.87890903e+01 4.01254098e-02]
mat_Sqrt:  [[ 1.97887666e+01  0.00000000e+00]
 [-8.01253117e-03  1.83590153e-02]]
grads:  [ 1.35001803e-03 -2.64864908e+00]
Stock Position:  0.0013500180271947056
Bond Position:  [-1.37768181]


portfolio before change:  [-1.24415191]
curr_Stock_Price:  99.16487134426208
curr_Factors:  [9.91648713e+01 3.91133808e-02]
mat_Sqrt:  [[ 1.96119389e+01  0.00000000e+00]
 [-7.91084125e-03  1.81260144e-02]]
grads:  [  0.02631822 -14.10073591]
Stock Position:  0.02631821994228312
Bond Position:  [-3.8539948]


portfolio before change:  [-1.26522665]
curr_Stock_Price:  98.40071921584344
curr_Factors:  [9.84007192e+01 4.14819184e-02]
mat_Sqrt:  [[ 2.00413831e+01  0.00000000e+00]
 [-8.14684414e-03  1.86667650e-02]]
grads:  [-0.00914069 -7.35610972]
Stock Position:  -0.00914069483097439
Bond Position:  [-0.3657757]


portfolio before change:  [-1.30637064]
curr_Stock_Price:  102.89190187274414
curr_Factors:  [1.02891902e+02 4.04648512e-02]
mat_Sqrt:  [[ 2.06976085e+01  0.00000000e+00]
 [-8.04635084e-03  1.84365059e-02]]
grads:  [ 0.00757003 -1.49232667]
Stock Position:  0.007570032395164409
Bond Position:  [-2.08526567]


portfolio before change:  [-1.30042535]
curr_Stock_Price:  103.74614782491649
curr_Factors:  [1.03746148e+02 4.00797970e-02]
mat_Sqrt:  [[ 2.07699158e+01  0.00000000e+00]
 [-8.00797573e-03  1.83485775e-02]]
grads:  [-2.79068130e-05 -1.05464176e+00]
Stock Position:  -2.7906812971793905e-05
Bond Position:  [-1.29753012]


portfolio before change:  [-1.30064081]
curr_Stock_Price:  99.84158257435995
curr_Factors:  [9.98415826e+01 4.34458309e-02]
mat_Sqrt:  [[ 2.08106435e+01  0.00000000e+00]
 [-8.33746541e-03  1.91035332e-02]]
grads:  [-6.13741324e-03 -7.10491232e+00]
Stock Position:  -0.006137413240295473
Bond Position:  [-0.68787176]


portfolio before change:  [-1.30837499]
curr_Stock_Price:  101.07372964737353
curr_Factors:  [1.01073730e+02 4.52113171e-02]
mat_Sqrt:  [[ 2.14912596e+01  0.00000000e+00]
 [-8.50518120e-03  1.94878183e-02]]
grads:  [-0.04638345 38.00258636]
Stock Position:  -0.04638344771668898
Bond Position:  [3.37977306]


portfolio before change:  [-1.34991623]
curr_Stock_Price:  101.9875531338327
curr_Factors:  [1.01987553e+02 4.26408755e-02]
mat_Sqrt:  [[ 2.10600903e+01  0.00000000e+00]
 [-8.25986687e-03  1.89257326e-02]]
grads:  [ 1.38640805e-03 -4.12541905e+00]
Stock Position:  0.0013864080473319777
Bond Position:  [-1.49131259]


portfolio before change:  [-1.34958561]
curr_Stock_Price:  102.4949715201746
curr_Factors:  [1.02494972e+02 4.45050368e-02]
mat_Sqrt:  [[ 2.16225615e+01  0.00000000e+00]
 [-8.43848677e-03  1.93350022e-02]]
grads:  [1.03586787e-02 1.36475350e+01]
Stock Position:  0.010358678713936888
Bond Position:  [-2.41129809]


portfolio before change:  [-1.37224521]
curr_Stock_Price:  100.36567518939712
curr_Factors:  [1.00365675e+02 4.77908250e-02]
mat_Sqrt:  [[ 2.19410534e+01  0.00000000e+00]
 [-8.74444509e-03  2.00360408e-02]]
grads:  [-0.0054884  -4.74464159]
Stock Position:  -0.005488401867994462
Bond Position:  [-0.82139805]


portfolio before change:  [-1.3677119]
curr_Stock_Price:  99.50227637499377
curr_Factors:  [9.95022764e+01 4.68792022e-02]
mat_Sqrt:  [[ 2.15438404e+01  0.00000000e+00]
 [-8.66064222e-03  1.98440243e-02]]
grads:  [ 0.00167244 -0.44219817]
Stock Position:  0.0016724362861763994
Bond Position:  [-1.53412312]


portfolio before change:  [-1.36403109]
curr_Stock_Price:  101.93250105542627
curr_Factors:  [1.01932501e+02 4.82765377e-02]
mat_Sqrt:  [[ 2.23965301e+01  0.00000000e+00]
 [-8.78876898e-03  2.01375996e-02]]
grads:  [ 0.00337973 -1.10381971]
Stock Position:  0.0033797298348015622
Bond Position:  [-1.7085354]


portfolio before change:  [-1.36025075]
curr_Stock_Price:  103.17743140064208
curr_Factors:  [1.03177431e+02 4.80947743e-02]
mat_Sqrt:  [[ 2.26273481e+01  0.00000000e+00]
 [-8.77220832e-03  2.00996543e-02]]
grads:  [6.72801520e-03 7.39207187e+00]
Stock Position:  0.006728015203586142
Bond Position:  [-2.05443007]


portfolio before change:  [-1.34492815]
curr_Stock_Price:  105.53121116196888
curr_Factors:  [1.05531211e+02 4.64087426e-02]
mat_Sqrt:  [[ 2.27342600e+01  0.00000000e+00]
 [-8.61707538e-03  1.97442001e-02]]
grads:  [-0.006257   -3.11094483]
Stock Position:  -0.00625699850670447
Bond Position:  [-0.68461952]


portfolio before change:  [-1.3495502]
curr_Stock_Price:  106.24255403463407
curr_Factors:  [1.06242554e+02 4.80884073e-02]
mat_Sqrt:  [[ 2.32980031e+01  0.00000000e+00]
 [-8.77162766e-03  2.00983239e-02]]
grads:  [-2.92418194e-03 -3.67336378e+00]
Stock Position:  -0.0029241819359038107
Bond Position:  [-1.03887764]


portfolio before change:  [-1.34933736]
curr_Stock_Price:  106.08093776359757
curr_Factors:  [1.06080938e+02 4.76557243e-02]
mat_Sqrt:  [[ 2.31576714e+01  0.00000000e+00]
 [-8.73207643e-03  2.00077006e-02]]
grads:  [-1.74387741e-02 -3.06331138e+01]
Stock Position:  -0.017438774121560835
Bond Position:  [0.50058416]


portfolio before change:  [-1.32702804]
curr_Stock_Price:  104.80882119017613
curr_Factors:  [1.04808821e+02 4.85163363e-02]
mat_Sqrt:  [[ 2.30856356e+01  0.00000000e+00]
 [-8.81056968e-03  2.01875512e-02]]
grads:  [-0.01085409 -2.26669452]
Stock Position:  -0.01085408881724846
Bond Position:  [-0.18942379]


portfolio before change:  [-1.31717359]
curr_Stock_Price:  103.89655550531752
curr_Factors:  [1.03896556e+02 4.92864823e-02]
mat_Sqrt:  [[ 2.30656162e+01  0.00000000e+00]
 [-8.88022362e-03  2.03471485e-02]]
grads:  [0.00767496 2.16653302]
Stock Position:  0.007674957827067212
Bond Position:  [-2.11457527]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.32246387]
Stock Price:  103.27615158423299
PL:  [-4.59861546]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 7.08153970e-03  1.78355651e-02]
 [-6.56904566e-02  7.36739248e-02]
 [ 7.03303394e-01 -2.78664577e-01]
 [ 7.97899842e-02 -1.09451791e-01]
 [ 7.86085336e-02 -2.10450823e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-3.77416165e-01 -1.31431926e-01]
 [-1.40527766e+00  7.49500376e-01]
 [ 6.18552715e-02 -7.81068476e-02]
 [ 1.04208651e-01  2.43652930e-01]
 [-4.02856023e-01 -7.13599217e-02]
 [-4.06120041e-02 -4.95377738e-02]
 [-5.86695118e-02 -1.06145313e-01]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.13076650e-01 -6.00812304e-02]
 [ 1.21697999e-01  4.28974786e-02]
 [-1.25527429e-01 -6.75282276e-01]
 [-3.96509393e-01  1.24238690e-01]
 [-1.17223239e-01 -8.90669939e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.04369836]
curr_Stock_Price:  101.87061550082652
curr_Factors:  [1.01870616e+02 4.03145935e-02]
mat_Sqrt:  [[ 2.04540858e+01  0.00000000e+00]
 [-8.03139774e-03  1.84022440e-02]]
grads:  [7.26779904e-04 9.69205989e-01]
Stock Position:  0.0007267799036141201
Bond Position:  [14.96966084]


portfolio before change:  [15.04761778]
curr_Stock_Price:  102.11352461821045
curr_Factors:  [1.02113525e+02 3.96163335e-02]
mat_Sqrt:  [[ 2.03245251e+01  0.00000000e+00]
 [-7.96154090e-03  1.82421819e-02]]
grads:  [-1.65005183e-03  4.03865750e+00]
Stock Position:  -0.001650051826346154
Bond Position:  [15.21611039]


portfolio before change:  [15.05432027]
curr_Stock_Price:  100.3572259599762
curr_Factors:  [1.00357226e+02 3.90645966e-02]
mat_Sqrt:  [[ 1.98353707e+01  0.00000000e+00]
 [-7.90590631e-03  1.81147071e-02]]
grads:  [  0.0293256  -15.38333333]
Stock Position:  0.029325602827420114
Bond Position:  [12.11128412]


portfolio before change:  [15.05458674]
curr_Stock_Price:  100.26305124531383
curr_Factors:  [1.00263051e+02 3.69970276e-02]
mat_Sqrt:  [[ 1.92852083e+01  0.00000000e+00]
 [-7.69384456e-03  1.76288125e-02]]
grads:  [ 1.66040761e-03 -6.20868764e+00]
Stock Position:  0.0016604076121420662
Bond Position:  [14.8881092]


portfolio before change:  [15.06089734]
curr_Stock_Price:  101.82177190038568
curr_Factors:  [1.01821772e+02 3.64577198e-02]
mat_Sqrt:  [[ 1.94417521e+01  0.00000000e+00]
 [-7.63756190e-03  1.74998528e-02]]
grads:  [ 0.00357086 -1.20258625]
Stock Position:  0.003570856484914706
Bond Position:  [14.69730641]


portfolio before change:  [15.0752734]
curr_Stock_Price:  104.81860744694534
curr_Factors:  [1.04818607e+02 3.32693935e-02]
mat_Sqrt:  [[ 1.91188087e+01  0.00000000e+00]
 [-7.29595982e-03  1.67171441e-02]]
grads:  [-3.03168553e-05 -1.15756472e+00]
Stock Position:  -3.0316855290796668e-05
Bond Position:  [15.07845117]


portfolio before change:  [15.07906164]
curr_Stock_Price:  104.21978218573621
curr_Factors:  [1.04219782e+02 3.32513852e-02]
mat_Sqrt:  [[ 1.90044380e+01  0.00000000e+00]
 [-7.29398494e-03  1.67126190e-02]]
grads:  [-0.0228777  -7.86423277]
Stock Position:  -0.022877696231389005
Bond Position:  [17.46337015]


portfolio before change:  [15.10857291]
curr_Stock_Price:  103.120681810823
curr_Factors:  [1.03120682e+02 3.48764593e-02]
mat_Sqrt:  [[ 1.92580349e+01  0.00000000e+00]
 [-7.47009604e-03  1.71161403e-02]]
grads:  [-0.0559854  43.78909986]
Stock Position:  -0.055985404769688496
Bond Position:  [20.88182602]


portfolio before change:  [15.17197573]
curr_Stock_Price:  102.08145173406336
curr_Factors:  [1.02081452e+02 3.59850115e-02]
mat_Sqrt:  [[ 1.93645612e+01  0.00000000e+00]
 [-7.58788629e-03  1.73860316e-02]]
grads:  [ 1.43388989e-03 -4.49250578e+00]
Stock Position:  0.0014338898888883206
Bond Position:  [15.02560217]


portfolio before change:  [15.17598601]
curr_Stock_Price:  102.2581765072632
curr_Factors:  [1.02258177e+02 3.59321295e-02]
mat_Sqrt:  [[ 1.93838269e+01  0.00000000e+00]
 [-7.58230883e-03  1.73732521e-02]]
grads:  [1.08620196e-02 1.40246011e+01]
Stock Position:  0.010862019613544733
Bond Position:  [14.06525569]


portfolio before change:  [15.20842527]
curr_Stock_Price:  104.92089553687008
curr_Factors:  [1.04920896e+02 3.77020475e-02]
mat_Sqrt:  [[ 2.03725061e+01  0.00000000e+00]
 [-7.76680604e-03  1.77959883e-02]]
grads:  [-0.02130322 -4.0098881 ]
Stock Position:  -0.021303223271180997
Bond Position:  [17.44357853]


portfolio before change:  [15.17965796]
curr_Stock_Price:  106.47600053281806
curr_Factors:  [1.06476001e+02 3.66849321e-02]
mat_Sqrt:  [[ 2.03936795e+01  0.00000000e+00]
 [-7.66132439e-03  1.75542995e-02]]
grads:  [-0.00305154 -2.82197383]
Stock Position:  -0.003051536682852043
Bond Position:  [15.50457338]


portfolio before change:  [15.17895772]
curr_Stock_Price:  107.97585745005016
curr_Factors:  [1.07975857e+02 3.70692896e-02]
mat_Sqrt:  [[ 2.07890093e+01  0.00000000e+00]
 [-7.70135465e-03  1.76460203e-02]]
grads:  [-5.05051120e-03 -6.01525505e+00]
Stock Position:  -0.005050511196031693
Bond Position:  [15.72429099]


portfolio before change:  [15.16384903]
curr_Stock_Price:  111.74582237877961
curr_Factors:  [1.11745822e+02 3.67351281e-02]
mat_Sqrt:  [[ 2.14176627e+01  0.00000000e+00]
 [-7.66656410e-03  1.75663051e-02]]
grads:  [7.10801844e-03 8.45812982e+00]
Stock Position:  0.007108018442400071
Bond Position:  [14.36955767]


portfolio before change:  [15.16235518]
curr_Stock_Price:  111.03019547847138
curr_Factors:  [1.11030195e+02 3.51381349e-02]
mat_Sqrt:  [[ 2.08127974e+01  0.00000000e+00]
 [-7.49806748e-03  1.71802309e-02]]
grads:  [-0.00669291 -3.49711426]
Stock Position:  -0.006692913275903329
Bond Position:  [15.90547065]


portfolio before change:  [15.16798438]
curr_Stock_Price:  110.78331710722192
curr_Factors:  [1.10783317e+02 3.65424520e-02]
mat_Sqrt:  [[ 2.11774277e+01  0.00000000e+00]
 [-7.64643205e-03  1.75201768e-02]]
grads:  [0.00663064 2.44846151]
Stock Position:  0.00663064445996067
Bond Position:  [14.43341959]


portfolio before change:  [15.15817953]
curr_Stock_Price:  108.76033735274059
curr_Factors:  [1.08760337e+02 3.70137414e-02]
mat_Sqrt:  [[ 2.09243531e+01  0.00000000e+00]
 [-7.69558225e-03  1.76327941e-02]]
grads:  [-2.00840033e-02 -3.82969524e+01]
Stock Position:  -0.02008400331703589
Bond Position:  [17.3425225]


portfolio before change:  [15.11172103]
curr_Stock_Price:  111.28944801198936
curr_Factors:  [1.11289448e+02 3.62780972e-02]
mat_Sqrt:  [[ 2.11970897e+01  0.00000000e+00]
 [-7.61872401e-03  1.74566897e-02]]
grads:  [-0.01614784  7.11696727]
Stock Position:  -0.01614783858850252
Bond Position:  [16.90880508]


portfolio before change:  [15.11237774]
curr_Stock_Price:  111.51059369701909
curr_Factors:  [1.11510594e+02 3.66845077e-02]
mat_Sqrt:  [[ 2.13578472e+01  0.00000000e+00]
 [-7.66128007e-03  1.75541979e-02]]
grads:  [-0.00730857 -5.07382874]
Stock Position:  -0.007308567196343014
Bond Position:  [15.92736041]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.14081769]
Stock Price:  108.16416278725384
PL:  [6.9766549]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.00938862e-02  1.25338564e-01]
 [ 4.98367153e-02 -4.57727250e-02]
 [ 4.39601586e-01 -1.98181809e-01]
 [-9.12651690e-02 -9.43352191e-02]
 [ 2.75210212e-01 -8.79818489e-03]
 [ 1.59050406e-02 -9.61544557e-02]
 [-6.66950268e-02 -1.33155689e-01]
 [-1.30330989e+00  7.39435263e-01]
 [ 8.85260739e-02 -7.15762081e-02]
 [ 3.30761851e-02 -5.63974937e-02]
 [-6.23167948e-02 -5.01564659e-02]
 [ 1.60486904e-02 -9.14221455e-03]
 [ 2.24593484e-02 -4.86357497e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15753437e-01 -6.16004503e-02]
 [-6.76879342e-02 -9.32378305e-02]
 [-1.46147799e-01 -5.84974329e-01]
 [-2.56424938e-01 -2.87359383e-02]
 [ 7.40581437e-02 -7.69297053e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.6863526]
curr_Stock_Price:  99.04941679401519
curr_Factors:  [9.90494168e+01 4.26052431e-02]
mat_Sqrt:  [[ 2.04448273e+01  0.00000000e+00]
 [-8.25641502e-03  1.89178234e-02]]
grads:  [3.65843736e-03 6.62542201e+00]
Stock Position:  0.003658437360212454
Bond Position:  [-4.04871868]


portfolio before change:  [-3.68760639]
curr_Stock_Price:  98.98340714784047
curr_Factors:  [9.89834071e+01 4.36137503e-02]
mat_Sqrt:  [[ 2.06716011e+01  0.00000000e+00]
 [-8.35356215e-03  1.91404154e-02]]
grads:  [ 1.44448706e-03 -2.39141753e+00]
Stock Position:  0.001444487064435886
Bond Position:  [-3.83058664]


portfolio before change:  [-3.69366833]
curr_Stock_Price:  95.4498537291406
curr_Factors:  [9.54498537e+01 4.54945442e-02]
mat_Sqrt:  [[ 2.03589289e+01  0.00000000e+00]
 [-8.53178004e-03  1.95487639e-02]]
grads:  [  0.01734413 -10.13781792]
Stock Position:  0.017344132146388355
Bond Position:  [-5.34916321]


portfolio before change:  [-3.68140653]
curr_Stock_Price:  96.23393811479026
curr_Factors:  [9.62339381e+01 4.70780222e-02]
mat_Sqrt:  [[ 2.08803302e+01  0.00000000e+00]
 [-8.67898816e-03  1.98860601e-02]]
grads:  [-0.00634264 -4.74378628]
Stock Position:  -0.006342640773407471
Bond Position:  [-3.07102923]


portfolio before change:  [-3.69251857]
curr_Stock_Price:  97.86483441268588
curr_Factors:  [9.78648344e+01 4.36685537e-02]
mat_Sqrt:  [[ 2.04508362e+01  0.00000000e+00]
 [-8.35880888e-03  1.91524372e-02]]
grads:  [ 0.0132694  -0.45937678]
Stock Position:  0.01326940212736873
Bond Position:  [-4.99112641]


portfolio before change:  [-3.68654525]
curr_Stock_Price:  98.40903799606666
curr_Factors:  [9.8409038e+01 4.2705293e-02]
mat_Sqrt:  [[ 2.03364826e+01  0.00000000e+00]
 [-8.26610360e-03  1.89400227e-02]]
grads:  [-1.28145092e-03 -5.07678671e+00]
Stock Position:  -0.0012814509201487195
Bond Position:  [-3.5604389]


portfolio before change:  [-3.68916009]
curr_Stock_Price:  99.75486981212478
curr_Factors:  [9.97548698e+01 4.34456495e-02]
mat_Sqrt:  [[ 2.07925260e+01  0.00000000e+00]
 [-8.33744801e-03  1.91034933e-02]]
grads:  [-6.00258640e-03 -6.97022721e+00]
Stock Position:  -0.006002586398157874
Bond Position:  [-3.09037286]


portfolio before change:  [-3.69471546]
curr_Stock_Price:  100.55163902111042
curr_Factors:  [1.00551639e+02 4.16334685e-02]
mat_Sqrt:  [[ 2.05168390e+01  0.00000000e+00]
 [-8.16171242e-03  1.87008325e-02]]
grads:  [-0.04779459 39.54023246]
Stock Position:  -0.04779458863047634
Bond Position:  [1.11110877]


portfolio before change:  [-3.65797518]
curr_Stock_Price:  99.78873953747018
curr_Factors:  [9.97887395e+01 4.37462634e-02]
mat_Sqrt:  [[ 2.08714210e+01  0.00000000e+00]
 [-8.36624297e-03  1.91694708e-02]]
grads:  [ 2.74478943e-03 -3.73386457e+00]
Stock Position:  0.0027447894251832806
Bond Position:  [-3.93187425]


portfolio before change:  [-3.6589615]
curr_Stock_Price:  99.78756176722585
curr_Factors:  [9.97875618e+01 4.49138140e-02]
mat_Sqrt:  [[ 2.11478577e+01  0.00000000e+00]
 [-8.47715179e-03  1.94235949e-02]]
grads:  [ 4.00149323e-04 -2.90355591e+00]
Stock Position:  0.00040014932269630396
Bond Position:  [-3.69889143]


portfolio before change:  [-3.65978185]
curr_Stock_Price:  100.04868726657666
curr_Factors:  [1.00048687e+02 4.51539783e-02]
mat_Sqrt:  [[ 2.12598113e+01  0.00000000e+00]
 [-8.49978619e-03  1.94754568e-02]]
grads:  [-0.00396085 -2.57536788]
Stock Position:  -0.003960847536601134
Bond Position:  [-3.26350425]


portfolio before change:  [-3.66624129]
curr_Stock_Price:  101.47349939097023
curr_Factors:  [1.01473499e+02 4.55222666e-02]
mat_Sqrt:  [[ 2.16503328e+01  0.00000000e+00]
 [-8.53437909e-03  1.95547191e-02]]
grads:  [ 0.00055698 -0.4675196 ]
Stock Position:  0.0005569753095562727
Bond Position:  [-3.72275953]


portfolio before change:  [-3.66587208]
curr_Stock_Price:  103.80757283035399
curr_Factors:  [1.03807573e+02 4.49121230e-02]
mat_Sqrt:  [[ 2.19993996e+01  0.00000000e+00]
 [-8.47699220e-03  1.94232292e-02]]
grads:  [ 5.60454864e-05 -2.50399916e+00]
Stock Position:  5.6045486367840895e-05
Bond Position:  [-3.67169002]


portfolio before change:  [-3.66689264]
curr_Stock_Price:  101.97815997497436
curr_Factors:  [1.01978160e+02 4.67164459e-02]
mat_Sqrt:  [[ 2.20415468e+01  0.00000000e+00]
 [-8.64559503e-03  1.98095468e-02]]
grads:  [6.90682659e-03 7.50032753e+00]
Stock Position:  0.006906826591842161
Bond Position:  [-4.37123811]


portfolio before change:  [-3.64841766]
curr_Stock_Price:  104.81128850855957
curr_Factors:  [1.04811289e+02 4.32445345e-02]
mat_Sqrt:  [[ 2.17958431e+01  0.00000000e+00]
 [-8.31812810e-03  1.90592258e-02]]
grads:  [-0.00654428 -3.23205417]
Stock Position:  -0.006544278947423758
Bond Position:  [-2.96250335]


portfolio before change:  [-3.65218568]
curr_Stock_Price:  105.27387570878585
curr_Factors:  [1.05273876e+02 4.20483797e-02]
mat_Sqrt:  [[ 2.15871468e+01  0.00000000e+00]
 [-8.20228063e-03  1.87937859e-02]]
grads:  [-0.00502059 -4.96109889]
Stock Position:  -0.005020592143382961
Bond Position:  [-3.12364849]


portfolio before change:  [-3.65001908]
curr_Stock_Price:  104.6867723663336
curr_Factors:  [1.04686772e+02 4.18581237e-02]
mat_Sqrt:  [[ 2.14181368e+01  0.00000000e+00]
 [-8.18370319e-03  1.87512197e-02]]
grads:  [-1.87435317e-02 -3.11966016e+01]
Stock Position:  -0.018743531707547282
Bond Position:  [-1.68781925]


portfolio before change:  [-3.6587665]
curr_Stock_Price:  105.13094743771003
curr_Factors:  [1.05130947e+02 3.94591354e-02]
mat_Sqrt:  [[ 2.08835517e+01  0.00000000e+00]
 [-7.94572946e-03  1.82059534e-02]]
grads:  [-0.01287934 -1.57838141]
Stock Position:  -0.012879338427573368
Bond Position:  [-2.30474945]


portfolio before change:  [-3.68545468]
curr_Stock_Price:  107.15837416450987
curr_Factors:  [1.07158374e+02 3.93237837e-02]
mat_Sqrt:  [[ 2.12497471e+01  0.00000000e+00]
 [-7.93209013e-03  1.81747017e-02]]
grads:  [ 1.90511763e-03 -4.23279053e+00]
Stock Position:  0.0019051176284867145
Bond Position:  [-3.88960398]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.68819552]
Stock Price:  106.23018100302183
PL:  [-9.91837652]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 6.70442074e-02  4.12214835e-02]
 [ 4.10083836e-02 -5.90391789e-02]
 [ 6.85949311e-01 -2.73368047e-01]
 [-3.08624527e-02 -9.87685893e-02]
 [ 1.47211277e-01 -5.21203787e-03]
 [ 4.24522020e-02 -5.24788894e-02]
 [-7.09124461e-02 -1.39212057e-01]
 [-1.25520755e+00  7.22715457e-01]
 [ 7.24396836e-02 -4.86133339e-02]
 [ 1.27164301e-02 -1.01339447e-01]
 [ 2.36809994e-02  1.86212763e-01]
 [ 1.79446002e-02 -9.11297592e-03]
 [ 7.15394131e-02 -2.64574444e-02]
 [ 6.30554409e-02  9.92704593e-02]
 [-1.17079800e-01 -6.23532324e-02]
 [-1.41311089e-01 -1.29958201e-01]
 [-1.70794453e-01 -4.88450999e-01]
 [-7.73601409e-02 -1.48816520e-01]
 [ 8.86240613e-02 -8.96509110e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.52424933]
curr_Stock_Price:  98.17008834107178
curr_Factors:  [9.81700883e+01 3.94973473e-02]
mat_Sqrt:  [[ 1.95102640e+01  0.00000000e+00]
 [-7.94957582e-03  1.82147665e-02]]
grads:  [0.00435846 2.26308053]
Stock Position:  0.00435846165888458
Bond Position:  [-9.9521199]


portfolio before change:  [-9.52763241]
curr_Stock_Price:  97.96480098871193
curr_Factors:  [9.79648010e+01 4.13606224e-02]
mat_Sqrt:  [[ 1.99234064e+01  0.00000000e+00]
 [-8.13492446e-03  1.86394535e-02]]
grads:  [ 7.65008412e-04 -3.16743078e+00]
Stock Position:  0.0007650084120668422
Bond Position:  [-9.60257631]


portfolio before change:  [-9.52851989]
curr_Stock_Price:  99.94315980997122
curr_Factors:  [9.99431598e+01 4.02497653e-02]
mat_Sqrt:  [[ 2.00509407e+01  0.00000000e+00]
 [-8.02493767e-03  1.83874422e-02]]
grads:  [  0.02826011 -14.86710573]
Stock Position:  0.028260106250303604
Bond Position:  [-12.35292421]


portfolio before change:  [-9.54510403]
curr_Stock_Price:  99.46561328572066
curr_Factors:  [9.94656133e+01 3.99330869e-02]
mat_Sqrt:  [[ 1.98764768e+01  0.00000000e+00]
 [-7.99330589e-03  1.83149646e-02]]
grads:  [-3.72141400e-03 -5.39278078e+00]
Stock Position:  -0.003721413998951924
Bond Position:  [-9.1749513]


portfolio before change:  [-9.54770723]
curr_Stock_Price:  99.54869528465879
curr_Factors:  [9.95486953e+01 4.00799383e-02]
mat_Sqrt:  [[ 1.99296235e+01  0.00000000e+00]
 [-8.00798984e-03  1.83486098e-02]]
grads:  [ 0.00727242 -0.28405628]
Stock Position:  0.007272418208364135
Bond Position:  [-10.27166698]


portfolio before change:  [-9.54907958]
curr_Stock_Price:  99.71313770675596
curr_Factors:  [9.97131377e+01 3.90919365e-02]
mat_Sqrt:  [[ 1.97149634e+01  0.00000000e+00]
 [-7.90867235e-03  1.81210449e-02]]
grads:  [ 9.91558370e-04 -2.89601896e+00]
Stock Position:  0.0009915583698276286
Bond Position:  [-9.64795097]


portfolio before change:  [-9.55124227]
curr_Stock_Price:  99.96485981567973
curr_Factors:  [9.99648598e+01 4.04210354e-02]
mat_Sqrt:  [[ 2.00979184e+01  0.00000000e+00]
 [-8.04199333e-03  1.84265216e-02]]
grads:  [-6.55140330e-03 -7.55498297e+00]
Stock Position:  -0.006551403295160122
Bond Position:  [-8.89633216]


portfolio before change:  [-9.54463765]
curr_Stock_Price:  98.61721203140489
curr_Factors:  [9.86172120e+01 4.24611169e-02]
mat_Sqrt:  [[ 2.03211568e+01  0.00000000e+00]
 [-8.24243817e-03  1.88857984e-02]]
grads:  [-0.04624681 38.26766766]
Stock Position:  -0.04624680961041278
Bond Position:  [-4.98390622]


portfolio before change:  [-9.54024662]
curr_Stock_Price:  98.49531911444588
curr_Factors:  [9.84953191e+01 4.18852353e-02]
mat_Sqrt:  [[ 2.01579364e+01  0.00000000e+00]
 [-8.18635307e-03  1.87572913e-02]]
grads:  [ 2.54108775e-03 -2.59170331e+00]
Stock Position:  0.002541087746064844
Bond Position:  [-9.79053187]


portfolio before change:  [-9.5418882]
curr_Stock_Price:  98.81264629071241
curr_Factors:  [9.88126463e+01 4.35989796e-02]
mat_Sqrt:  [[ 2.06324448e+01  0.00000000e+00]
 [-8.35214747e-03  1.91371740e-02]]
grads:  [-1.52729018e-03 -5.29542380e+00]
Stock Position:  -0.0015272901785400139
Bond Position:  [-9.39097262]


portfolio before change:  [-9.54359061]
curr_Stock_Price:  98.3899192851521
curr_Factors:  [9.83899193e+01 4.46431225e-02]
mat_Sqrt:  [[ 2.07887265e+01  0.00000000e+00]
 [-8.45156766e-03  1.93649743e-02]]
grads:  [5.04845316e-03 9.61595717e+00]
Stock Position:  0.0050484531602
Bond Position:  [-10.04030751]


portfolio before change:  [-9.53176059]
curr_Stock_Price:  101.23047448768207
curr_Factors:  [1.01230474e+02 4.45294966e-02]
mat_Sqrt:  [[ 2.13616682e+01  0.00000000e+00]
 [-8.44080533e-03  1.93403147e-02]]
grads:  [ 0.00065385 -0.47119067]
Stock Position:  0.0006538520926738672
Bond Position:  [-9.59795035]


portfolio before change:  [-9.53351499]
curr_Stock_Price:  102.21753236179835
curr_Factors:  [1.02217532e+02 4.34143320e-02]
mat_Sqrt:  [[ 2.12981536e+01  0.00000000e+00]
 [-8.33444247e-03  1.90966067e-02]]
grads:  [ 0.00281679 -1.38545265]
Stock Position:  0.002816790550375393
Bond Position:  [-9.82144037]


portfolio before change:  [-9.54062829]
curr_Stock_Price:  100.5640075811098
curr_Factors:  [1.00564008e+02 4.45035290e-02]
mat_Sqrt:  [[ 2.12148418e+01  0.00000000e+00]
 [-8.43834382e-03  1.93346747e-02]]
grads:  [5.01444330e-03 5.13432272e+00]
Stock Position:  0.005014443299676844
Bond Position:  [-10.04490081]


portfolio before change:  [-9.53615899]
curr_Stock_Price:  101.95615330609637
curr_Factors:  [1.01956153e+02 4.45562734e-02]
mat_Sqrt:  [[ 2.15212688e+01  0.00000000e+00]
 [-8.44334279e-03  1.93461287e-02]]
grads:  [-0.00670467 -3.22303409]
Stock Position:  -0.0067046688856730475
Bond Position:  [-8.85257675]


portfolio before change:  [-9.5323124]
curr_Stock_Price:  101.05230287365386
curr_Factors:  [1.01052303e+02 4.39907967e-02]
mat_Sqrt:  [[ 2.11946929e+01  0.00000000e+00]
 [-8.38959324e-03  1.92229730e-02]]
grads:  [-0.00934335 -6.76056721]
Stock Position:  -0.009343353031325994
Bond Position:  [-8.58814506]


portfolio before change:  [-9.5370023]
curr_Stock_Price:  101.3244322534401
curr_Factors:  [1.01324432e+02 4.44934135e-02]
mat_Sqrt:  [[ 2.13728305e+01  0.00000000e+00]
 [-8.43738476e-03  1.93324772e-02]]
grads:  [-1.79654233e-02 -2.52658257e+01]
Stock Position:  -0.017965423259292065
Bond Position:  [-7.71666599]


portfolio before change:  [-9.57055631]
curr_Stock_Price:  103.08473575919882
curr_Factors:  [1.03084736e+02 4.14238895e-02]
mat_Sqrt:  [[ 2.09806916e+01  0.00000000e+00]
 [-8.14114385e-03  1.86537040e-02]]
grads:  [-6.78285529e-03 -7.97785361e+00]
Stock Position:  -0.006782855289333989
Bond Position:  [-8.87134746]


portfolio before change:  [-9.55705283]
curr_Stock_Price:  100.76689348167854
curr_Factors:  [1.00766893e+02 4.14566520e-02]
mat_Sqrt:  [[ 2.05170531e+01  0.00000000e+00]
 [-8.14436266e-03  1.86610792e-02]]
grads:  [ 2.41249051e-03 -4.80416540e+00]
Stock Position:  0.0024124905145329785
Bond Position:  [-9.80015201]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.55751762]
Stock Price:  101.5899239205686
PL:  [-11.14744155]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.17775609e-02  1.04405872e-01]
 [ 4.48120383e-02 -5.33233754e-02]
 [ 6.64313735e-01 -2.66764789e-01]
 [ 2.12154155e-01 -1.14625337e-01]
 [ 7.17395381e-02 -2.05305518e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-1.79530526e-01 -1.88081950e-01]
 [-1.40772500e+00  7.49101678e-01]
 [ 5.61420086e-02 -7.66256062e-02]
 [ 9.09139423e-02  1.88010626e-01]
 [-1.81283057e-01 -3.53633943e-02]
 [ 2.42181590e-02 -9.01622538e-03]
 [ 1.10394223e-01 -1.60503053e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15138629e-01 -6.12515143e-02]
 [-1.01988348e-02 -5.65326569e-02]
 [-1.31379330e-01 -6.32043797e-01]
 [-4.02658233e-01  6.72686002e-02]
 [ 1.14727393e-01 -5.74919879e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.13573878]
curr_Stock_Price:  98.8311041779235
curr_Factors:  [9.88311042e+01 3.99360234e-02]
mat_Sqrt:  [[ 1.97504073e+01  0.00000000e+00]
 [-7.99359978e-03  1.83156380e-02]]
grads:  [3.91607210e-03 5.70036772e+00]
Stock Position:  0.003916072102934153
Bond Position:  [-5.52276851]


portfolio before change:  [-5.13871915]
curr_Stock_Price:  98.42265612237011
curr_Factors:  [9.84226561e+01 4.00315333e-02]
mat_Sqrt:  [[ 1.96922887e+01  0.00000000e+00]
 [-8.00315271e-03  1.83375266e-02]]
grads:  [ 1.09381950e-03 -2.90788265e+00]
Stock Position:  0.0010938195007870583
Bond Position:  [-5.24637577]


portfolio before change:  [-5.13848829]
curr_Stock_Price:  99.83296402258816
curr_Factors:  [9.98329640e+01 3.83316145e-02]
mat_Sqrt:  [[ 1.95457582e+01  0.00000000e+00]
 [-7.83138450e-03  1.79439561e-02]]
grads:  [  0.02803105 -14.86655376]
Stock Position:  0.028031045451851345
Bond Position:  [-7.93691064]


portfolio before change:  [-5.09859171]
curr_Stock_Price:  101.32705922508723
curr_Factors:  [1.01327059e+02 3.91236478e-02]
mat_Sqrt:  [[ 2.00421870e+01  0.00000000e+00]
 [-7.91187945e-03  1.81283932e-02]]
grads:  [ 0.00808931 -6.32297279]
Stock Position:  0.008089314625189914
Bond Position:  [-5.91825818]


portfolio before change:  [-5.09672001]
curr_Stock_Price:  101.74136561737114
curr_Factors:  [1.01741366e+02 3.90709530e-02]
mat_Sqrt:  [[ 2.01105786e+01  0.00000000e+00]
 [-7.90654949e-03  1.81161808e-02]]
grads:  [ 0.0031217  -1.13327152]
Stock Position:  0.0031217038595242937
Bond Position:  [-5.41432642]


portfolio before change:  [-5.0952792]
curr_Stock_Price:  102.63657072403717
curr_Factors:  [1.02636571e+02 4.09075427e-02]
mat_Sqrt:  [[ 2.07588757e+01  0.00000000e+00]
 [-8.09024526e-03  1.85370806e-02]]
grads:  [-2.79216545e-05 -1.04391714e+00]
Stock Position:  -2.7921654530296173e-05
Bond Position:  [-5.09241341]


portfolio before change:  [-5.09654441]
curr_Stock_Price:  102.34850117100771
curr_Factors:  [1.02348501e+02 4.23654849e-02]
mat_Sqrt:  [[ 2.10662667e+01  0.00000000e+00]
 [-8.23315102e-03  1.88645189e-02]]
grads:  [-0.01241873 -9.97014293]
Stock Position:  -0.012418727200103657
Bond Position:  [-3.8255063]


portfolio before change:  [-5.10944572]
curr_Stock_Price:  103.31033933135612
curr_Factors:  [1.03310339e+02 4.07061180e-02]
mat_Sqrt:  [[ 2.08436433e+01  0.00000000e+00]
 [-8.07030290e-03  1.84913870e-02]]
grads:  [-0.05185227 40.51084323]
Stock Position:  -0.05185227026245716
Bond Position:  [0.24742992]


portfolio before change:  [-5.06766925]
curr_Stock_Price:  102.50584988589299
curr_Factors:  [1.02505850e+02 4.15158471e-02]
mat_Sqrt:  [[ 2.08860158e+01  0.00000000e+00]
 [-8.15017517e-03  1.86743973e-02]]
grads:  [ 1.08684454e-03 -4.10324387e+00]
Stock Position:  0.0010868445430106267
Bond Position:  [-5.17907717]


portfolio before change:  [-5.06998804]
curr_Stock_Price:  101.56380221471699
curr_Factors:  [1.01563802e+02 3.97536710e-02]
mat_Sqrt:  [[ 2.02501186e+01  0.00000000e+00]
 [-7.97532906e-03  1.82737745e-02]]
grads:  [8.54160464e-03 1.02885491e+01]
Stock Position:  0.008541604638237825
Bond Position:  [-5.93750588]


portfolio before change:  [-5.06720234]
curr_Stock_Price:  102.06373902430872
curr_Factors:  [1.02063739e+02 3.97315941e-02]
mat_Sqrt:  [[ 2.03441463e+01  0.00000000e+00]
 [-7.97311423e-03  1.82686997e-02]]
grads:  [-0.00966946 -1.9357368 ]
Stock Position:  -0.009669459969160795
Bond Position:  [-4.0803011]


portfolio before change:  [-5.0514989]
curr_Stock_Price:  100.3342067717583
curr_Factors:  [1.00334207e+02 3.84737795e-02]
mat_Sqrt:  [[ 1.96802879e+01  0.00000000e+00]
 [-7.84589365e-03  1.79772008e-02]]
grads:  [ 0.00103063 -0.50153667]
Stock Position:  0.0010306330750898133
Bond Position:  [-5.15490665]


portfolio before change:  [-5.05171337]
curr_Stock_Price:  101.37668427996753
curr_Factors:  [1.01376684e+02 3.63447324e-02]
mat_Sqrt:  [[ 1.93267496e+01  0.00000000e+00]
 [-7.62571779e-03  1.74727145e-02]]
grads:  [ 0.00534954 -0.91859255]
Stock Position:  0.00534954390988316
Bond Position:  [-5.5940324]


portfolio before change:  [-5.03384721]
curr_Stock_Price:  104.97789776627306
curr_Factors:  [1.04977898e+02 3.52060792e-02]
mat_Sqrt:  [[ 1.96973001e+01  0.00000000e+00]
 [-7.50531323e-03  1.71968330e-02]]
grads:  [7.72883293e-03 8.63985186e+00]
Stock Position:  0.007728832929134001
Bond Position:  [-5.84520384]


portfolio before change:  [-5.02547688]
curr_Stock_Price:  106.24999275533735
curr_Factors:  [1.06249993e+02 3.42851353e-02]
mat_Sqrt:  [[ 1.96735097e+01  0.00000000e+00]
 [-7.40649826e-03  1.69704195e-02]]
grads:  [-0.00721127 -3.60931057]
Stock Position:  -0.007211269587721652
Bond Position:  [-4.25927954]


portfolio before change:  [-5.03157405]
curr_Stock_Price:  106.94781905306489
curr_Factors:  [1.06947819e+02 3.46084388e-02]
mat_Sqrt:  [[ 1.98958701e+01  0.00000000e+00]
 [-7.44133739e-03  1.70502459e-02]]
grads:  [-1.75271093e-03 -3.31565053e+00]
Stock Position:  -0.0017527109331223769
Bond Position:  [-4.84412543]


portfolio before change:  [-5.03244258]
curr_Stock_Price:  106.75232206975092
curr_Factors:  [1.06752322e+02 3.33367985e-02]
mat_Sqrt:  [[ 1.94912313e+01  0.00000000e+00]
 [-7.30334701e-03  1.67340702e-02]]
grads:  [-2.08927723e-02 -3.77698783e+01]
Stock Position:  -0.020892772332139833
Bond Position:  [-2.80209062]


portfolio before change:  [-5.03329015]
curr_Stock_Price:  106.75935630395897
curr_Factors:  [1.06759356e+02 3.26496060e-02]
mat_Sqrt:  [[ 1.92905637e+01  0.00000000e+00]
 [-7.22768079e-03  1.65606971e-02]]
grads:  [-0.01935142  4.06194254]
Stock Position:  -0.019351420464203455
Bond Position:  [-2.96734496]


portfolio before change:  [-5.02268114]
curr_Stock_Price:  106.17278748046041
curr_Factors:  [1.06172787e+02 3.27149058e-02]
mat_Sqrt:  [[ 1.92037506e+01  0.00000000e+00]
 [-7.23490492e-03  1.65772497e-02]]
grads:  [ 0.00466762 -3.46812583]
Stock Position:  0.004667621163777659
Bond Position:  [-5.51825549]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.02082916]
Stock Price:  106.86515791011139
PL:  [-11.88598707]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 8.60106315e-03  1.97040777e-02]
 [ 6.18145846e-02 -4.76772862e-03]
 [ 8.46604111e-01 -3.22400486e-01]
 [ 3.64988212e-01 -6.69627560e-02]
 [ 1.63861634e-01 -2.71663995e-02]
 [ 3.72329635e-02 -4.36320306e-02]
 [-4.60366489e-02 -1.03482178e-01]
 [-1.32261879e+00  7.41428480e-01]
 [ 4.41363012e-02 -7.35104503e-02]
 [ 1.32135825e-01  3.93998894e-01]
 [-3.68660108e-01 -5.90651298e-02]
 [ 9.66046161e-03 -9.24073352e-03]
 [ 5.02346170e-02 -3.29778715e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.17171545e-01 -6.24053028e-02]
 [-1.40798065e-01 -1.27654466e-01]
 [-1.65697524e-01 -5.15338758e-01]
 [ 2.26817008e-01 -2.23679221e-01]
 [ 8.86406218e-02 -8.93527796e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.75380243]
curr_Stock_Price:  101.67632597523108
curr_Factors:  [1.01676326e+02 3.88826555e-02]
mat_Sqrt:  [[ 2.00492349e+01  0.00000000e+00]
 [-7.88747417e-03  1.80724737e-02]]
grads:  [8.57919406e-04 1.09028116e+00]
Stock Position:  0.0008579194063732927
Bond Position:  [13.66657234]


portfolio before change:  [13.75698831]
curr_Stock_Price:  101.40685169517907
curr_Factors:  [1.01406852e+02 3.84487566e-02]
mat_Sqrt:  [[ 1.98842150e+01  0.00000000e+00]
 [-7.84334180e-03  1.79713537e-02]]
grads:  [ 0.00300408 -0.26529602]
Stock Position:  0.003004080241538939
Bond Position:  [13.452354]


portfolio before change:  [13.76423429]
curr_Stock_Price:  102.6992493240758
curr_Factors:  [1.02699249e+02 4.06684070e-02]
mat_Sqrt:  [[ 2.07107511e+01  0.00000000e+00]
 [-8.06656378e-03  1.84828196e-02]]
grads:  [  0.0340836  -17.44325237]
Stock Position:  0.03408360222093588
Bond Position:  [10.26387393]


portfolio before change:  [13.78760679]
curr_Stock_Price:  103.30969560426105
curr_Factors:  [1.03309696e+02 4.04243098e-02]
mat_Sqrt:  [[ 2.07712383e+01  0.00000000e+00]
 [-8.04231905e-03  1.84272679e-02]]
grads:  [ 0.01616482 -3.63389496]
Stock Position:  0.016164817143216482
Bond Position:  [12.11762445]


portfolio before change:  [13.78297928]
curr_Stock_Price:  102.83599430607947
curr_Factors:  [1.02835994e+02 3.76923435e-02]
mat_Sqrt:  [[ 1.99651106e+01  0.00000000e+00]
 [-7.76580643e-03  1.77936979e-02]]
grads:  [ 0.00761354 -1.52674276]
Stock Position:  0.007613543820836033
Bond Position:  [13.00003293]


portfolio before change:  [13.7656829]
curr_Stock_Price:  100.13727890905932
curr_Factors:  [1.00137279e+02 3.98787313e-02]
mat_Sqrt:  [[ 1.99970739e+01  0.00000000e+00]
 [-7.98786392e-03  1.83024955e-02]]
grads:  [ 9.09652295e-04 -2.38393887e+00]
Stock Position:  0.000909652295128148
Bond Position:  [13.6745928]


portfolio before change:  [13.76784948]
curr_Stock_Price:  98.76037892461066
curr_Factors:  [9.87603789e+01 4.06537357e-02]
mat_Sqrt:  [[ 1.99128296e+01  0.00000000e+00]
 [-8.06510862e-03  1.84794854e-02]]
grads:  [-4.57996054e-03 -5.59984088e+00]
Stock Position:  -0.004579960543556009
Bond Position:  [14.22016812]


portfolio before change:  [13.76105289]
curr_Stock_Price:  101.02067586905007
curr_Factors:  [1.01020676e+02 3.95373438e-02]
mat_Sqrt:  [[ 2.00869507e+01  0.00000000e+00]
 [-7.95359982e-03  1.82239866e-02]]
grads:  [-0.04973542 40.68420903]
Stock Position:  -0.049735416928526226
Bond Position:  [18.78535833]


portfolio before change:  [13.64748908]
curr_Stock_Price:  103.39847321203136
curr_Factors:  [1.03398473e+02 3.80153333e-02]
mat_Sqrt:  [[ 2.01601392e+01  0.00000000e+00]
 [-7.79900848e-03  1.78697734e-02]]
grads:  [ 5.97898175e-04 -4.11367558e+00]
Stock Position:  0.0005978981750113645
Bond Position:  [13.58566732]


portfolio before change:  [13.65115102]
curr_Stock_Price:  103.84185866955228
curr_Factors:  [1.03841859e+02 3.55664547e-02]
mat_Sqrt:  [[ 1.95836095e+01  0.00000000e+00]
 [-7.54362827e-03  1.72846238e-02]]
grads:  [1.55278341e-02 2.27947625e+01]
Stock Position:  0.015527834127379032
Bond Position:  [12.03871186]


portfolio before change:  [13.66409146]
curr_Stock_Price:  104.48138054487441
curr_Factors:  [1.04481381e+02 3.56187865e-02]
mat_Sqrt:  [[ 1.97187083e+01  0.00000000e+00]
 [-7.54917601e-03  1.72973352e-02]]
grads:  [-0.02000325 -3.41469533]
Stock Position:  -0.020003249643383136
Bond Position:  [15.7540586]


portfolio before change:  [13.71648086]
curr_Stock_Price:  102.0592546868963
curr_Factors:  [1.02059255e+02 3.43413035e-02]
mat_Sqrt:  [[ 1.89130156e+01  0.00000000e+00]
 [-7.41256269e-03  1.69843148e-02]]
grads:  [ 2.97545087e-04 -5.44074555e-01]
Stock Position:  0.00029754508703103063
Bond Position:  [13.68611363]


portfolio before change:  [13.72007779]
curr_Stock_Price:  102.64732630703196
curr_Factors:  [1.02647326e+02 3.14619752e-02]
mat_Sqrt:  [[ 1.82070940e+01  0.00000000e+00]
 [-7.09500953e-03  1.62567091e-02]]
grads:  [ 1.96856752e-03 -2.02856995e+00]
Stock Position:  0.0019685675226895592
Bond Position:  [13.5180096]


portfolio before change:  [13.72254118]
curr_Stock_Price:  102.18174127371832
curr_Factors:  [1.02181741e+02 3.09841646e-02]
mat_Sqrt:  [[ 1.79863564e+01  0.00000000e+00]
 [-7.04092773e-03  1.61327921e-02]]
grads:  [8.46403454e-03 9.20969464e+00]
Stock Position:  0.008464034540392943
Bond Position:  [12.85767139]


portfolio before change:  [13.7226686]
curr_Stock_Price:  101.81697404682575
curr_Factors:  [1.01816974e+02 3.12188524e-02]
mat_Sqrt:  [[ 1.79898960e+01  0.00000000e+00]
 [-7.06754298e-03  1.61937753e-02]]
grads:  [-0.00802714 -3.8536599 ]
Stock Position:  -0.008027142117908023
Bond Position:  [14.53996792]


portfolio before change:  [13.7281588]
curr_Stock_Price:  101.58591391194541
curr_Factors:  [1.01585914e+02 3.30802201e-02]
mat_Sqrt:  [[ 1.84764141e+01  0.00000000e+00]
 [-7.27518743e-03  1.66695485e-02]]
grads:  [-0.01063578 -7.65794383]
Stock Position:  -0.010635778186992429
Bond Position:  [14.80860405]


portfolio before change:  [13.72767918]
curr_Stock_Price:  101.97913707128015
curr_Factors:  [1.01979137e+02 3.54925614e-02]
mat_Sqrt:  [[ 1.92123285e+01  0.00000000e+00]
 [-7.53578783e-03  1.72666591e-02]]
grads:  [-2.03312054e-02 -2.98458871e+01]
Stock Position:  -0.02033120537547196
Bond Position:  [15.80103796]


portfolio before change:  [13.75070885]
curr_Stock_Price:  101.04073141396862
curr_Factors:  [1.01040731e+02 3.63954031e-02]
mat_Sqrt:  [[ 1.92761256e+01  0.00000000e+00]
 [-7.63103171e-03  1.74848902e-02]]
grads:  [ 6.70235272e-03 -1.27927152e+01]
Stock Position:  0.006702352721665365
Bond Position:  [13.07349823]


portfolio before change:  [13.75213392]
curr_Stock_Price:  100.76564712248486
curr_Factors:  [1.00765647e+02 3.64997486e-02]
mat_Sqrt:  [[ 1.92511836e+01  0.00000000e+00]
 [-7.64196295e-03  1.75099368e-02]]
grads:  [ 2.57874388e-03 -5.10297555e+00]
Stock Position:  0.002578743877820116
Bond Position:  [13.49228513]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.75794441]
Stock Price:  101.71068079958594
PL:  [12.04726361]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.92588644e-03  1.39551527e-02]
 [-5.71156201e-01  3.84618358e-01]
 [ 1.11810334e+00 -4.05263057e-01]
 [ 5.61204040e-01 -7.36460976e-02]
 [ 3.58722039e-01 -3.51386095e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-6.49834087e-01 -4.83908653e-02]
 [-1.51666106e+00  7.06699819e-01]
 [ 6.44647478e-03 -7.12920163e-02]
 [ 1.61085819e-01  6.50639595e-01]
 [-4.50723238e-01 -8.85578014e-02]
 [-4.05762639e-02 -4.34566445e-02]
 [-2.11292964e-02 -7.95389871e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.16201584e-01 -6.18547982e-02]
 [-9.29466771e-02 -1.03941470e-01]
 [-1.60171867e-01 -5.42558354e-01]
 [-1.24725578e-01 -1.19655754e-01]
 [ 1.62675628e-01  4.36284698e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.72199881]
curr_Stock_Price:  102.2740323300087
curr_Factors:  [1.02274032e+02 4.01330689e-02]
mat_Sqrt:  [[ 2.04888020e+01  0.00000000e+00]
 [-8.01329584e-03  1.83607674e-02]]
grads:  [4.88872625e-04 7.60052802e-01]
Stock Position:  0.000488872625334449
Bond Position:  [17.67199983]


portfolio before change:  [17.72771244]
curr_Stock_Price:  104.92314833689683
curr_Factors:  [1.04923148e+02 3.82043256e-02]
mat_Sqrt:  [[ 2.05082018e+01  0.00000000e+00]
 [-7.81837074e-03  1.79141379e-02]]
grads:  [-1.96650584e-02  2.14701015e+01]
Stock Position:  -0.019665058448229186
Bond Position:  [19.79103228]


portfolio before change:  [17.70144118]
curr_Stock_Price:  106.51071746881468
curr_Factors:  [1.06510717e+02 3.74145099e-02]
mat_Sqrt:  [[ 2.06021877e+01  0.00000000e+00]
 [-7.73713227e-03  1.77279972e-02]]
grads:  [  0.04568602 -22.86005878]
Stock Position:  0.04568602410706581
Bond Position:  [12.83538997]


portfolio before change:  [17.72722223]
curr_Stock_Price:  107.0047812276664
curr_Factors:  [1.07004781e+02 3.66959852e-02]
mat_Sqrt:  [[ 2.04980458e+01  0.00000000e+00]
 [-7.66247847e-03  1.75569438e-02]]
grads:  [ 0.02581037 -4.19469917]
Stock Position:  0.025810374926181462
Bond Position:  [14.96538871]


portfolio before change:  [17.70918851]
curr_Stock_Price:  106.16110753499402
curr_Factors:  [1.06161108e+02 3.75370023e-02]
mat_Sqrt:  [[ 2.05681502e+01  0.00000000e+00]
 [-7.74978734e-03  1.77569935e-02]]
grads:  [ 0.01669505 -1.9788603 ]
Stock Position:  0.01669504987670733
Bond Position:  [15.93682353]


portfolio before change:  [17.71116265]
curr_Stock_Price:  106.04067832765307
curr_Factors:  [1.06040678e+02 3.60232374e-02]
mat_Sqrt:  [[ 2.01262965e+01  0.00000000e+00]
 [-7.59191543e-03  1.73952636e-02]]
grads:  [-2.87992456e-05 -1.11243937e+00]
Stock Position:  -2.879924557415905e-05
Bond Position:  [17.71421654]


portfolio before change:  [17.71556974]
curr_Stock_Price:  106.8052235798095
curr_Factors:  [1.06805224e+02 3.74159483e-02]
mat_Sqrt:  [[ 2.06595507e+01  0.00000000e+00]
 [-7.73728100e-03  1.77283379e-02]]
grads:  [-0.03247668 -2.7295771 ]
Stock Position:  -0.032476678844189685
Bond Position:  [21.18424868]


portfolio before change:  [17.72944338]
curr_Stock_Price:  106.54112877519736
curr_Factors:  [1.06541129e+02 3.83316162e-02]
mat_Sqrt:  [[ 2.08591141e+01  0.00000000e+00]
 [-7.83138467e-03  1.79439565e-02]]
grads:  [-0.05792346 39.38372332]
Stock Position:  -0.05792345589985779
Bond Position:  [23.90067376]


portfolio before change:  [17.77810798]
curr_Stock_Price:  105.80414433085564
curr_Factors:  [1.05804144e+02 3.93377399e-02]
mat_Sqrt:  [[ 2.09849231e+01  0.00000000e+00]
 [-7.93349758e-03  1.81779266e-02]]
grads:  [-1.17550643e-03 -3.92190033e+00]
Stock Position:  -0.001175506430159925
Bond Position:  [17.90248143]


portfolio before change:  [17.78234655]
curr_Stock_Price:  106.00627856518621
curr_Factors:  [1.06006279e+02 4.07184498e-02]
mat_Sqrt:  [[ 2.13908088e+01  0.00000000e+00]
 [-8.07152524e-03  1.84941877e-02]]
grads:  [2.08055816e-02 3.51807609e+01]
Stock Position:  0.02080558159303044
Bond Position:  [15.57682427]


portfolio before change:  [17.77646036]
curr_Stock_Price:  105.53616999810603
curr_Factors:  [1.05536170e+02 4.08464227e-02]
mat_Sqrt:  [[ 2.13293855e+01  0.00000000e+00]
 [-8.08419918e-03  1.85232273e-02]]
grads:  [-0.02294361 -4.78090561]
Stock Position:  -0.022943606710301975
Bond Position:  [20.19784074]


portfolio before change:  [17.76442646]
curr_Stock_Price:  106.28077797453305
curr_Factors:  [1.06280778e+02 3.80356450e-02]
mat_Sqrt:  [[ 2.07276524e+01  0.00000000e+00]
 [-7.80109172e-03  1.78745466e-02]]
grads:  [-0.0028726  -2.43120261]
Stock Position:  -0.0028726021280505425
Bond Position:  [18.06972885]


portfolio before change:  [17.76963508]
curr_Stock_Price:  106.04036110576506
curr_Factors:  [1.06040361e+02 3.74601693e-02]
mat_Sqrt:  [[ 2.05237193e+01  0.00000000e+00]
 [-7.74185191e-03  1.77388112e-02]]
grads:  [-2.72089846e-03 -4.48389614e+00]
Stock Position:  -0.002720898462227295
Bond Position:  [18.05816014]


portfolio before change:  [17.77677099]
curr_Stock_Price:  105.07714849688371
curr_Factors:  [1.05077148e+02 3.78856572e-02]
mat_Sqrt:  [[ 2.04524666e+01  0.00000000e+00]
 [-7.78569532e-03  1.78392691e-02]]
grads:  [7.44346122e-03 8.32870948e+00]
Stock Position:  0.007443461218099507
Bond Position:  [16.99463331]


portfolio before change:  [17.77135799]
curr_Stock_Price:  103.77907163057439
curr_Factors:  [1.03779072e+02 3.84558621e-02]
mat_Sqrt:  [[ 2.03512485e+01  0.00000000e+00]
 [-7.84406651e-03  1.79730143e-02]]
grads:  [-0.00703629 -3.44153726]
Stock Position:  -0.007036287309891327
Bond Position:  [18.50157736]


portfolio before change:  [17.77236284]
curr_Stock_Price:  104.29370761716568
curr_Factors:  [1.04293708e+02 3.71009939e-02]
mat_Sqrt:  [[ 2.00886558e+01  0.00000000e+00]
 [-7.70464731e-03  1.76535648e-02]]
grads:  [-0.006885   -5.88784595]
Stock Position:  -0.006885002892678488
Bond Position:  [18.49042532]


portfolio before change:  [17.78791673]
curr_Stock_Price:  102.70609701764758
curr_Factors:  [1.02706097e+02 3.76322984e-02]
mat_Sqrt:  [[ 1.99240030e+01  0.00000000e+00]
 [-7.75961839e-03  1.77795193e-02]]
grads:  [-1.99238951e-02 -3.05159180e+01]
Stock Position:  -0.019923895134844057
Bond Position:  [19.83422223]


portfolio before change:  [17.77397831]
curr_Stock_Price:  103.65458579851939
curr_Factors:  [1.03654586e+02 3.73788237e-02]
mat_Sqrt:  [[ 2.00401670e+01  0.00000000e+00]
 [-7.73344153e-03  1.77195406e-02]]
grads:  [-0.00882965 -6.75275714]
Stock Position:  -0.008829648491953926
Bond Position:  [18.68921187]


portfolio before change:  [17.7705787]
curr_Stock_Price:  104.56883459485266
curr_Factors:  [1.04568835e+02 3.55129370e-02]
mat_Sqrt:  [[ 1.97058677e+01  0.00000000e+00]
 [-7.53795060e-03  1.72716146e-02]]
grads:  [0.00922145 2.5260215 ]
Stock Position:  0.009221448934156155
Bond Position:  [16.80630254]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.77333682]
Stock Price:  104.412244603429
PL:  [13.36109221]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 4.64873184e-02  7.80515930e-02]
 [ 5.59989937e-02 -3.65125856e-02]
 [ 7.87944986e-01 -3.04497504e-01]
 [ 3.57923114e-01 -6.91660659e-02]
 [ 3.26973061e-02 -1.16806898e-02]
 [ 3.92375405e-02 -3.26098183e-02]
 [-4.30993213e-02 -9.92617724e-02]
 [-1.26270485e+00  7.20829510e-01]
 [ 7.04000938e-02 -4.57259349e-02]
 [ 1.89984403e-02 -7.00061097e-02]
 [ 1.03956250e-01  3.03008122e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.40112332e-01 -3.30134603e-02]
 [-9.95216078e-02 -1.54789805e-01]
 [ 1.13383424e-01  1.57022553e-01]
 [-1.08679867e-01 -1.26686113e-01]
 [-1.91437550e-01 -3.76439256e-01]
 [ 2.83425103e-01 -2.50880815e-01]
 [ 4.43589345e-02 -1.13597041e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.96970974]
curr_Stock_Price:  98.55486379113144
curr_Factors:  [9.85548638e+01 4.17233781e-02]
mat_Sqrt:  [[ 2.01311133e+01  0.00000000e+00]
 [-8.17052048e-03  1.87210143e-02]]
grads:  [4.00135974e-03 4.16919681e+00]
Stock Position:  0.00400135973907979
Bond Position:  [-7.36406321]


portfolio before change:  [-6.96707444]
curr_Stock_Price:  99.6736211677633
curr_Factors:  [9.96736212e+01 4.30048244e-02]
mat_Sqrt:  [[ 2.06699214e+01  0.00000000e+00]
 [-8.29504184e-03  1.90063286e-02]]
grads:  [ 0.00193826 -1.92107516]
Stock Position:  0.001938255788273574
Bond Position:  [-7.16026741]


portfolio before change:  [-6.96537853]
curr_Stock_Price:  101.47224873905289
curr_Factors:  [1.01472249e+02 4.19325778e-02]
mat_Sqrt:  [[ 2.07789245e+01  0.00000000e+00]
 [-8.19097824e-03  1.87678889e-02]]
grads:  [  0.0315248  -16.22438761]
Stock Position:  0.03152479712573516
Bond Position:  [-10.16427059]


portfolio before change:  [-6.91290981]
curr_Stock_Price:  103.2172275233356
curr_Factors:  [1.03217228e+02 3.88691121e-02]
mat_Sqrt:  [[ 2.03495355e+01  0.00000000e+00]
 [-7.88610039e-03  1.80693260e-02]]
grads:  [ 0.01610536 -3.8278166 ]
Stock Position:  0.01610535870002006
Bond Position:  [-8.57526029]


portfolio before change:  [-6.9600383]
curr_Stock_Price:  100.42409476054516
curr_Factors:  [1.00424095e+02 3.73146710e-02]
mat_Sqrt:  [[ 1.93989281e+01  0.00000000e+00]
 [-7.72680229e-03  1.77043282e-02]]
grads:  [ 0.00142273 -0.65976465]
Stock Position:  0.0014227299001935221
Bond Position:  [-7.10291466]


portfolio before change:  [-6.9618326]
curr_Stock_Price:  100.41119753061128
curr_Factors:  [1.00411198e+02 3.64539500e-02]
mat_Sqrt:  [[ 1.91714271e+01  0.00000000e+00]
 [-7.63716701e-03  1.74989480e-02]]
grads:  [ 1.30430817e-03 -1.86353022e+00]
Stock Position:  0.0013043081691484998
Bond Position:  [-7.09279975]


portfolio before change:  [-6.96593602]
curr_Stock_Price:  98.62481422389982
curr_Factors:  [9.86248142e+01 3.72435677e-02]
mat_Sqrt:  [[ 1.90332011e+01  0.00000000e+00]
 [-7.71943704e-03  1.76874523e-02]]
grads:  [-4.54052421e-03 -5.61198813e+00]
Stock Position:  -0.004540524210202103
Bond Position:  [-6.51812766]


portfolio before change:  [-6.96694606]
curr_Stock_Price:  98.48833333459238
curr_Factors:  [9.84883333e+01 3.55984710e-02]
mat_Sqrt:  [[ 1.85823425e+01  0.00000000e+00]
 [-7.54702283e-03  1.72924017e-02]]
grads:  [-0.05102204 41.68475395]
Stock Position:  -0.05102204182317495
Bond Position:  [-1.9418702]


portfolio before change:  [-6.95953319]
curr_Stock_Price:  98.33352971565652
curr_Factors:  [9.83335297e+01 3.60774759e-02]
mat_Sqrt:  [[ 1.86775411e+01  0.00000000e+00]
 [-7.59762867e-03  1.74083542e-02]]
grads:  [ 0.00270077 -2.62666616]
Stock Position:  0.0027007655542668706
Bond Position:  [-7.225109]


portfolio before change:  [-6.96826555]
curr_Stock_Price:  95.76912396294433
curr_Factors:  [9.57691240e+01 3.56625953e-02]
mat_Sqrt:  [[ 1.80855611e+01  0.00000000e+00]
 [-7.55381708e-03  1.73079693e-02]]
grads:  [-6.38892583e-04 -4.04473272e+00]
Stock Position:  -0.0006388925834877784
Bond Position:  [-6.90707937]


portfolio before change:  [-6.9707299]
curr_Stock_Price:  96.92325651990629
curr_Factors:  [9.69232565e+01 3.55103848e-02]
mat_Sqrt:  [[ 1.82644116e+01  0.00000000e+00]
 [-7.53767973e-03  1.72709940e-02]]
grads:  [1.29322445e-02 1.75443361e+01]
Stock Position:  0.012932244464411172
Bond Position:  [-8.22416515]


portfolio before change:  [-6.97201887]
curr_Stock_Price:  96.98259144893036
curr_Factors:  [9.69825914e+01 3.47393484e-02]
mat_Sqrt:  [[ 1.80760951e+01  0.00000000e+00]
 [-7.45539787e-03  1.70824625e-02]]
grads:  [ 0.00265635 -0.50293585]
Stock Position:  0.002656352376803278
Bond Position:  [-7.22963881]


portfolio before change:  [-6.97582582]
curr_Stock_Price:  96.22993532453926
curr_Factors:  [9.62299353e+01 3.72420537e-02]
mat_Sqrt:  [[ 1.85706457e+01  0.00000000e+00]
 [-7.71928014e-03  1.76870928e-02]]
grads:  [ 0.00676897 -1.86652836]
Stock Position:  0.006768966380129365
Bond Position:  [-7.62720302]


portfolio before change:  [-6.99892739]
curr_Stock_Price:  93.09880294170216
curr_Factors:  [9.30988029e+01 3.78297769e-02]
mat_Sqrt:  [[ 1.81076039e+01  0.00000000e+00]
 [-7.77995135e-03  1.78261080e-02]]
grads:  [-0.00922692 -8.68332028]
Stock Position:  -0.009226920231276215
Bond Position:  [-6.13991216]


portfolio before change:  [-7.00762163]
curr_Stock_Price:  93.87469161922569
curr_Factors:  [9.38746916e+01 3.69005138e-02]
mat_Sqrt:  [[ 1.80328649e+01  0.00000000e+00]
 [-7.68380258e-03  1.76058035e-02]]
grads:  [0.0100879  8.91879508]
Stock Position:  0.010087897017756302
Bond Position:  [-7.95461985]


portfolio before change:  [-7.00060571]
curr_Stock_Price:  94.76732747087189
curr_Factors:  [9.47673275e+01 3.61539044e-02]
mat_Sqrt:  [[ 1.80192303e+01  0.00000000e+00]
 [-7.60567203e-03  1.74267839e-02]]
grads:  [-0.00909973 -7.26962093]
Stock Position:  -0.00909973495628029
Bond Position:  [-6.13824815]


portfolio before change:  [-7.03186282]
curr_Stock_Price:  98.03361550615674
curr_Factors:  [9.80336155e+01 3.33997497e-02]
mat_Sqrt:  [[ 1.79162299e+01  0.00000000e+00]
 [-7.31023936e-03  1.67498626e-02]]
grads:  [-1.98551321e-02 -2.24741698e+01]
Stock Position:  -0.01985513210979257
Bond Position:  [-5.08539243]


portfolio before change:  [-7.05428437]
curr_Stock_Price:  99.09883351454984
curr_Factors:  [9.90988335e+01 3.30746879e-02]
mat_Sqrt:  [[ 1.80225575e+01  0.00000000e+00]
 [-7.27457907e-03  1.66681546e-02]]
grads:  [ 9.65078003e-03 -1.50515052e+01]
Stock Position:  0.009650780030817508
Bond Position:  [-8.01066541]


portfolio before change:  [-7.05040991]
curr_Stock_Price:  99.70783922969251
curr_Factors:  [9.97078392e+01 3.36108238e-02]
mat_Sqrt:  [[ 1.82796924e+01  0.00000000e+00]
 [-7.33330199e-03  1.68027057e-02]]
grads:  [-2.85501456e-04 -6.76063980e+00]
Stock Position:  -0.00028550145583197396
Bond Position:  [-7.02194317]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.05206312]
Stock Price:  99.348846176635
PL:  [-7.05206312]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.08074517e-01 -3.09101056e-02]
 [ 2.16264169e-02 -6.73882075e-02]
 [ 4.32989135e-01 -1.96163665e-01]
 [ 6.01505279e-02  1.22510914e-01]
 [ 4.21637369e-01 -2.01719737e-02]
 [-6.05348461e-01 -5.33125980e-01]
 [-8.90855167e-02 -8.36524830e-02]
 [-1.89623653e+00  4.69676589e-01]
 [-8.24850413e-02  1.12724659e-01]
 [ 3.79553117e-02  7.12959895e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 2.17843278e-01 -3.72359278e-01]
 [-1.33219920e-02  1.65530585e-01]
 [-1.45200650e-01 -2.53939312e-01]
 [ 2.57934165e-01  4.29406955e-01]
 [ 4.93756770e-02 -9.26696738e-02]
 [-2.08911822e-01 -1.31732828e-01]
 [ 5.76856853e-01 -5.67381325e-01]
 [-4.29210100e-01 -2.35124481e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.63832774]
curr_Stock_Price:  97.39978443643871
curr_Factors:  [9.73997844e+01 4.03151173e-02]
mat_Sqrt:  [[ 1.95565373e+01  0.00000000e+00]
 [-8.03144991e-03  1.84023636e-02]]
grads:  [ 0.00483645 -1.67968128]
Stock Position:  0.004836451367041489
Bond Position:  [-15.10939706]


portfolio before change:  [-14.6482664]
curr_Stock_Price:  96.12594925956432
curr_Factors:  [9.61259493e+01 4.18706961e-02]
mat_Sqrt:  [[ 1.96696092e+01  0.00000000e+00]
 [-8.18493211e-03  1.87540355e-02]]
grads:  [-3.95747975e-04 -3.59326437e+00]
Stock Position:  -0.00039574797540530395
Bond Position:  [-14.61022475]


portfolio before change:  [-14.65182679]
curr_Stock_Price:  95.89189030463247
curr_Factors:  [9.58918903e+01 4.09297529e-02]
mat_Sqrt:  [[ 1.93999871e+01  0.00000000e+00]
 [-8.09244121e-03  1.85421122e-02]]
grads:  [  0.01790601 -10.57935916]
Stock Position:  0.017906006369523025
Bond Position:  [-16.36886758]


portfolio before change:  [-14.69404472]
curr_Stock_Price:  93.76270494505167
curr_Factors:  [9.37627049e+01 3.83815368e-02]
mat_Sqrt:  [[ 1.83692451e+01  0.00000000e+00]
 [-7.83648256e-03  1.79556373e-02]]
grads:  [6.18526639e-03 6.82297776e+00]
Stock Position:  0.006185266392566188
Bond Position:  [-15.27399203]


portfolio before change:  [-14.69560756]
curr_Stock_Price:  94.12746479493086
curr_Factors:  [9.41274648e+01 3.86259190e-02]
mat_Sqrt:  [[ 1.84993204e+01  0.00000000e+00]
 [-7.86139113e-03  1.80127099e-02]]
grads:  [ 0.02231615 -1.11987445]
Stock Position:  0.02231614937439205
Bond Position:  [-16.79617012]


portfolio before change:  [-14.72103549]
curr_Stock_Price:  93.17620902954617
curr_Factors:  [9.31762090e+01 3.77762009e-02]
mat_Sqrt:  [[ 1.81098218e+01  0.00000000e+00]
 [-7.77444027e-03  1.78134805e-02]]
grads:  [ -0.04627454 -29.92823214]
Stock Position:  -0.046274542272809735
Bond Position:  [-10.40934907]


portfolio before change:  [-14.66970769]
curr_Stock_Price:  92.01076338201884
curr_Factors:  [9.20107634e+01 3.98115635e-02]
mat_Sqrt:  [[ 1.83587560e+01  0.00000000e+00]
 [-7.98113410e-03  1.82870756e-02]]
grads:  [-0.00684112 -4.57440462]
Stock Position:  -0.006841120020094116
Bond Position:  [-14.04025102]


portfolio before change:  [-14.65926989]
curr_Stock_Price:  89.97187146809556
curr_Factors:  [8.99718715e+01 4.37903360e-02]
mat_Sqrt:  [[ 1.88276403e+01  0.00000000e+00]
 [-8.37045623e-03  1.91791246e-02]]
grads:  [-0.08982819 24.48894813]
Stock Position:  -0.08982819059768767
Bond Position:  [-6.57725947]


portfolio before change:  [-14.58166113]
curr_Stock_Price:  89.08959524117202
curr_Factors:  [8.90895952e+01 4.43250831e-02]
mat_Sqrt:  [[ 1.87564984e+01  0.00000000e+00]
 [-8.42140921e-03  1.92958726e-02]]
grads:  [-1.77474314e-03  5.84190522e+00]
Stock Position:  -0.0017747431363115127
Bond Position:  [-14.42354998]


portfolio before change:  [-14.58229297]
curr_Stock_Price:  87.41358068974115
curr_Factors:  [8.74135807e+01 4.49007101e-02]
mat_Sqrt:  [[ 1.85227521e+01  0.00000000e+00]
 [-8.47591506e-03  1.94207612e-02]]
grads:  [0.003729  3.6711223]
Stock Position:  0.003729004849862718
Bond Position:  [-14.90825864]


portfolio before change:  [-14.58736302]
curr_Stock_Price:  87.05355994842542
curr_Factors:  [8.70535599e+01 4.54492049e-02]
mat_Sqrt:  [[ 1.85587910e+01  0.00000000e+00]
 [-8.52752765e-03  1.95390205e-02]]
grads:  [1.45432103e-02 1.78908046e+01]
Stock Position:  0.014543210337285579
Bond Position:  [-15.85340126]


portfolio before change:  [-14.5845783]
curr_Stock_Price:  87.51759602720571
curr_Factors:  [8.75175960e+01 4.43410944e-02]
mat_Sqrt:  [[ 1.84288648e+01  0.00000000e+00]
 [-8.42293007e-03  1.92993573e-02]]
grads:  [ 3.00248368e-03 -1.92938693e+01]
Stock Position:  0.0030024836805922707
Bond Position:  [-14.84734845]


portfolio before change:  [-14.58924783]
curr_Stock_Price:  87.19878294913019
curr_Factors:  [8.71987829e+01 4.43920472e-02]
mat_Sqrt:  [[ 1.83722781e+01  0.00000000e+00]
 [-8.42776812e-03  1.93104427e-02]]
grads:  [3.20708613e-03 8.57207617e+00]
Stock Position:  0.003207086133093405
Bond Position:  [-14.86890184]


portfolio before change:  [-14.58965065]
curr_Stock_Price:  88.23239132828121
curr_Factors:  [8.82323913e+01 4.26116374e-02]
mat_Sqrt:  [[ 1.82134476e+01  0.00000000e+00]
 [-8.25703457e-03  1.89192430e-02]]
grads:  [ -0.01405713 -13.42227658]
Stock Position:  -0.014057132774252582
Bond Position:  [-13.34935621]


portfolio before change:  [-14.5736484]
curr_Stock_Price:  86.85657709355704
curr_Factors:  [8.68565771e+01 4.30640581e-02]
mat_Sqrt:  [[ 1.80243739e+01  0.00000000e+00]
 [-8.30075255e-03  1.90194135e-02]]
grads:  [ 0.02470781 22.57729745]
Stock Position:  0.02470780558249036
Bond Position:  [-16.71968382]


portfolio before change:  [-14.57104302]
curr_Stock_Price:  87.1312199591362
curr_Factors:  [8.71312200e+01 4.19283237e-02]
mat_Sqrt:  [[ 1.78413431e+01  0.00000000e+00]
 [-8.19056274e-03  1.87669369e-02]]
grads:  [ 5.00596595e-04 -4.93792218e+00]
Stock Position:  0.0005005965951764154
Bond Position:  [-14.61466061]


portfolio before change:  [-14.57442907]
curr_Stock_Price:  87.66672840191275
curr_Factors:  [8.76667284e+01 4.18093298e-02]
mat_Sqrt:  [[ 1.79255051e+01  0.00000000e+00]
 [-8.17893194e-03  1.87402874e-02]]
grads:  [-0.01486177 -7.02939211]
Stock Position:  -0.01486177040789119
Bond Position:  [-13.27154628]


portfolio before change:  [-14.59504715]
curr_Stock_Price:  88.83077408862782
curr_Factors:  [8.88307741e+01 3.94359099e-02]
mat_Sqrt:  [[ 1.76404386e+01  0.00000000e+00]
 [-7.94339070e-03  1.82005946e-02]]
grads:  [ 1.86634442e-02 -3.11737796e+01]
Stock Position:  0.018663444198462546
Bond Position:  [-16.25293535]


portfolio before change:  [-14.59425862]
curr_Stock_Price:  89.0907622636423
curr_Factors:  [8.90907623e+01 4.19554174e-02]
mat_Sqrt:  [[ 1.82484801e+01  0.00000000e+00]
 [-8.19320864e-03  1.87729994e-02]]
grads:  [ -0.02914362 -12.52460922]
Stock Position:  -0.02914362368794346
Bond Position:  [-11.99783097]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.539439]
Stock Price:  87.10681373894516
PL:  [-14.539439]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.29313995e-02  7.99031721e-02]
 [-3.48041050e-02  5.46799667e-02]
 [ 9.17800879e-01 -3.44130003e-01]
 [ 4.01230973e-01 -5.56601472e-02]
 [ 2.76642376e-01 -3.20463545e-02]
 [ 7.90689870e-03 -1.93488991e-02]
 [-8.92261858e-02 -1.67111184e-01]
 [-1.32216819e+00  7.41073477e-01]
 [ 8.28417360e-02 -7.49807146e-02]
 [ 6.38325518e-02  6.79766397e-02]
 [-5.62986690e-02 -3.39140168e-02]
 [ 2.43062831e-02 -9.01486634e-03]
 [ 4.52577942e-02 -3.44440623e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.16281655e-01 -6.19002428e-02]
 [-1.41514024e-01 -1.30869478e-01]
 [-1.86953355e-01 -4.07979373e-01]
 [ 2.80074645e-01 -2.44952875e-01]
 [ 3.75373746e-02 -1.15348195e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.21563793]
curr_Stock_Price:  100.39027188478038
curr_Factors:  [1.00390272e+02 4.08201873e-02]
mat_Sqrt:  [[ 2.02828569e+01  0.00000000e+00]
 [-8.08160255e-03  1.85172777e-02]]
grads:  [2.84989452e-03 4.31506042e+00]
Stock Position:  0.0028498945186783914
Bond Position:  [4.92953625]


portfolio before change:  [5.22128514]
curr_Stock_Price:  101.93933644033059
curr_Factors:  [1.01939336e+02 4.15551772e-02]
mat_Sqrt:  [[ 2.07804224e+01  0.00000000e+00]
 [-8.15403480e-03  1.86832408e-02]]
grads:  [-5.26447964e-04  2.92668532e+00]
Stock Position:  -0.0005264479641036158
Bond Position:  [5.2749509]


portfolio before change:  [5.22175828]
curr_Stock_Price:  103.54589471387212
curr_Factors:  [1.03545895e+02 4.15841706e-02]
mat_Sqrt:  [[ 2.11152830e+01  0.00000000e+00]
 [-8.15687887e-03  1.86897574e-02]]
grads:  [  0.0363533 -18.4127592]
Stock Position:  0.036353300646387775
Bond Position:  [1.45752323]


portfolio before change:  [5.23064472]
curr_Stock_Price:  103.78031687363479
curr_Factors:  [1.03780317e+02 4.15805270e-02]
mat_Sqrt:  [[ 2.11621597e+01  0.00000000e+00]
 [-8.15652151e-03  1.86889386e-02]]
grads:  [ 0.01781193 -2.97824014]
Stock Position:  0.017811929374236302
Bond Position:  [3.38211705]


portfolio before change:  [5.24811694]
curr_Stock_Price:  104.71376918399733
curr_Factors:  [1.04713769e+02 4.18411541e-02]
mat_Sqrt:  [[ 2.14193171e+01  0.00000000e+00]
 [-8.18204415e-03  1.87474183e-02]]
grads:  [ 0.01226259 -1.70937427]
Stock Position:  0.0122625851824802
Bond Position:  [3.96405543]


portfolio before change:  [5.209599]
curr_Stock_Price:  101.49184851260536
curr_Factors:  [1.01491849e+02 4.34844278e-02]
mat_Sqrt:  [[ 2.11640141e+01  0.00000000e+00]
 [-8.34116806e-03  1.91120170e-02]]
grads:  [-2.54041208e-05 -1.01239440e+00]
Stock Position:  -2.5404120777878844e-05
Bond Position:  [5.21217732]


portfolio before change:  [5.21090965]
curr_Stock_Price:  101.19897926192893
curr_Factors:  [1.01198979e+02 4.29603178e-02]
mat_Sqrt:  [[ 2.09753818e+01  0.00000000e+00]
 [-8.29074837e-03  1.89964910e-02]]
grads:  [-7.73094321e-03 -8.79695012e+00]
Stock Position:  -0.007730943213408811
Bond Position:  [5.99327321]


portfolio before change:  [5.21339446]
curr_Stock_Price:  101.07140095980797
curr_Factors:  [1.01071401e+02 4.24731849e-02]
mat_Sqrt:  [[ 2.08298288e+01  0.00000000e+00]
 [-8.24360939e-03  1.88884820e-02]]
grads:  [-0.04794745 39.23414685]
Stock Position:  -0.047947451860308826
Bond Position:  [10.05951059]


portfolio before change:  [5.24842988]
curr_Stock_Price:  100.39315365933784
curr_Factors:  [1.00393154e+02 4.39298099e-02]
mat_Sqrt:  [[ 2.10418422e+01  0.00000000e+00]
 [-8.38377575e-03  1.92096435e-02]]
grads:  [ 2.38180046e-03 -3.90328507e+00]
Stock Position:  0.0023818004552500203
Bond Position:  [5.00931342]


portfolio before change:  [5.25039074]
curr_Stock_Price:  100.69056487052833
curr_Factors:  [1.00690565e+02 4.31967043e-02]
mat_Sqrt:  [[ 2.09273426e+01  0.00000000e+00]
 [-8.31352674e-03  1.90486828e-02]]
grads:  [0.00446784 3.56857429]
Stock Position:  0.004467838630273998
Bond Position:  [4.80052154]


portfolio before change:  [5.24821072]
curr_Stock_Price:  99.93397944094201
curr_Factors:  [9.99339794e+01 4.41214532e-02]
mat_Sqrt:  [[ 2.09912396e+01  0.00000000e+00]
 [-8.40204292e-03  1.92514988e-02]]
grads:  [-0.00338713 -1.76162994]
Stock Position:  -0.0033871253284850945
Bond Position:  [5.58669963]


portfolio before change:  [5.24828159]
curr_Stock_Price:  100.32545478592773
curr_Factors:  [1.00325455e+02 4.28723072e-02]
mat_Sqrt:  [[ 2.07730164e+01  0.00000000e+00]
 [-8.28225159e-03  1.89770224e-02]]
grads:  [ 0.00098069 -0.47504114]
Stock Position:  0.0009806891993175036
Bond Position:  [5.1498935]


portfolio before change:  [5.2519714]
curr_Stock_Price:  102.77493325501477
curr_Factors:  [1.02774933e+02 4.30559208e-02]
mat_Sqrt:  [[ 2.13257171e+01  0.00000000e+00]
 [-8.29996827e-03  1.90176164e-02]]
grads:  [ 1.41731098e-03 -1.81116611e+00]
Stock Position:  0.0014173109777701617
Bond Position:  [5.10630736]


portfolio before change:  [5.25509813]
curr_Stock_Price:  104.08021283509103
curr_Factors:  [1.04080213e+02 4.23382359e-02]
mat_Sqrt:  [[ 2.14158123e+01  0.00000000e+00]
 [-8.23050287e-03  1.88584512e-02]]
grads:  [7.10863263e-03 7.87859448e+00]
Stock Position:  0.007108632630404327
Bond Position:  [4.51523013]


portfolio before change:  [5.25271769]
curr_Stock_Price:  103.58653389652564
curr_Factors:  [1.03586534e+02 4.31678883e-02]
mat_Sqrt:  [[ 2.15220534e+01  0.00000000e+00]
 [-8.31075336e-03  1.90423282e-02]]
grads:  [-0.00665815 -3.25066569]
Stock Position:  -0.006658153562566962
Bond Position:  [5.94241274]


portfolio before change:  [5.27887941]
curr_Stock_Price:  99.88041173750587
curr_Factors:  [9.98804117e+01 4.35671948e-02]
mat_Sqrt:  [[ 2.08477948e+01  0.00000000e+00]
 [-8.34910245e-03  1.91301970e-02]]
grads:  [-0.00952763 -6.84098958]
Stock Position:  -0.009527633449584837
Bond Position:  [6.23050336]


portfolio before change:  [5.28685972]
curr_Stock_Price:  99.20632121053389
curr_Factors:  [9.92063212e+01 4.36137340e-02]
mat_Sqrt:  [[ 2.07181504e+01  0.00000000e+00]
 [-8.35356058e-03  1.91404118e-02]]
grads:  [-1.76178927e-02 -2.13150781e+01]
Stock Position:  -0.017617892749559702
Bond Position:  [7.03466605]


portfolio before change:  [5.28393623]
curr_Stock_Price:  99.47209484213808
curr_Factors:  [9.94720948e+01 4.08767413e-02]
mat_Sqrt:  [[ 2.01112654e+01  0.00000000e+00]
 [-8.08719891e-03  1.85301006e-02]]
grads:  [ 8.61051964e-03 -1.32191876e+01]
Stock Position:  0.00861051964425332
Bond Position:  [4.42742981]


portfolio before change:  [5.28578629]
curr_Stock_Price:  99.55839212530081
curr_Factors:  [9.95583921e+01 3.94028940e-02]
mat_Sqrt:  [[ 1.97625023e+01  0.00000000e+00]
 [-7.94006489e-03  1.81929742e-02]]
grads:  [-6.47929325e-04 -6.34026046e+00]
Stock Position:  -0.0006479293253790359
Bond Position:  [5.3502931]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.28688424]
Stock Price:  99.92848992992997
PL:  [5.28688424]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 4.00468863e-03  1.54164273e-01]
 [ 3.70860364e-02  1.04465798e-02]
 [ 7.16409275e-01 -2.82664540e-01]
 [ 1.53817888e-01 -1.16860976e-01]
 [ 3.25311635e-05 -1.20999203e-02]
 [ 3.16816889e-02 -1.80277024e-02]
 [-2.76768619e-01 -1.60289111e-01]
 [-1.33448111e+00  7.42534846e-01]
 [ 7.10014168e-02 -7.71860050e-02]
 [ 1.43951705e-01  4.98677250e-01]
 [-3.99794868e-01 -7.03457153e-02]
 [-1.22018747e-02 -1.02014168e-02]
 [ 2.03821890e-03 -6.31203734e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.14550569e-01 -6.09177586e-02]
 [ 8.39568185e-03 -4.38818446e-02]
 [-1.28319615e-01 -6.43720033e-01]
 [-3.22096656e-01  1.65694970e-02]
 [ 1.59077453e-01  6.19670033e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.68185015]
curr_Stock_Price:  99.35134334677691
curr_Factors:  [9.93513433e+01 4.14640967e-02]
mat_Sqrt:  [[ 2.02306505e+01  0.00000000e+00]
 [-8.14509390e-03  1.86627547e-02]]
grads:  [3.52373708e-03 8.26053151e+00]
Stock Position:  0.003523737084469712
Bond Position:  [-2.03193816]


portfolio before change:  [-1.67463389]
curr_Stock_Price:  101.54342203570994
curr_Factors:  [1.01543422e+02 3.90321554e-02]
mat_Sqrt:  [[ 2.00614843e+01  0.00000000e+00]
 [-7.90262290e-03  1.81071838e-02]]
grads:  [0.00207588 0.57693012]
Stock Position:  0.002075883168196669
Bond Position:  [-1.88542617]


portfolio before change:  [-1.67754515]
curr_Stock_Price:  100.36809246142889
curr_Factors:  [1.00368092e+02 4.06939130e-02]
mat_Sqrt:  [[ 2.02469867e+01  0.00000000e+00]
 [-8.06909294e-03  1.84886146e-02]]
grads:  [  0.0292905  -15.28857335]
Stock Position:  0.029290499668160056
Bond Position:  [-4.61737673]


portfolio before change:  [-1.66621446]
curr_Stock_Price:  100.79434592816678
curr_Factors:  [1.00794346e+02 3.77524076e-02]
mat_Sqrt:  [[ 1.95843200e+01  0.00000000e+00]
 [-7.77199152e-03  1.78078697e-02]]
grads:  [ 5.24989259e-03 -6.56232206e+00]
Stock Position:  0.005249892587331396
Bond Position:  [-2.19537395]


portfolio before change:  [-1.66761949]
curr_Stock_Price:  100.63127284315654
curr_Factors:  [1.00631273e+02 3.86132914e-02]
mat_Sqrt:  [[ 1.97743118e+01  0.00000000e+00]
 [-7.86010600e-03  1.80097654e-02]]
grads:  [-2.65410350e-04 -6.71853303e-01]
Stock Position:  -0.00026541035009874085
Bond Position:  [-1.64091091]


portfolio before change:  [-1.66812751]
curr_Stock_Price:  100.99955677731343
curr_Factors:  [1.00999557e+02 3.77002618e-02]
mat_Sqrt:  [[ 1.96106348e+01  0.00000000e+00]
 [-7.76662210e-03  1.77955668e-02]]
grads:  [ 0.00121433 -1.01304457]
Stock Position:  0.00121432859356454
Bond Position:  [-1.79077416]


portfolio before change:  [-1.6658207]
curr_Stock_Price:  103.2679394170121
curr_Factors:  [1.03267939e+02 3.77409715e-02]
mat_Sqrt:  [[ 2.00618994e+01  0.00000000e+00]
 [-7.77081427e-03  1.78051723e-02]]
grads:  [-0.01728274 -9.00239035]
Stock Position:  -0.017282736525849267
Bond Position:  [0.11893189]


portfolio before change:  [-1.63234036]
curr_Stock_Price:  101.33244716299316
curr_Factors:  [1.01332447e+02 3.93553466e-02]
mat_Sqrt:  [[ 2.01025153e+01  0.00000000e+00]
 [-7.93527281e-03  1.81819941e-02]]
grads:  [-0.05026298 40.83902127]
Stock Position:  -0.050262980404921255
Bond Position:  [3.46093045]


portfolio before change:  [-1.63986677]
curr_Stock_Price:  101.49940409061558
curr_Factors:  [1.01499404e+02 3.67401422e-02]
mat_Sqrt:  [[ 1.94551198e+01  0.00000000e+00]
 [-7.66708729e-03  1.75675039e-02]]
grads:  [ 1.91798780e-03 -4.39368082e+00]
Stock Position:  0.0019179878040674358
Bond Position:  [-1.83454139]


portfolio before change:  [-1.63413388]
curr_Stock_Price:  104.7275695439875
curr_Factors:  [1.04727570e+02 3.45858115e-02]
mat_Sqrt:  [[ 1.94764594e+01  0.00000000e+00]
 [-7.43890438e-03  1.70446712e-02]]
grads:  [1.85656075e-02 2.92570766e+01]
Stock Position:  0.018565607477853577
Bond Position:  [-3.57846483]


portfolio before change:  [-1.63217564]
curr_Stock_Price:  104.88123953193276
curr_Factors:  [1.04881240e+02 3.59107826e-02]
mat_Sqrt:  [[ 1.98751423e+01  0.00000000e+00]
 [-7.58005621e-03  1.73680907e-02]]
grads:  [-0.02166003 -4.0502849 ]
Stock Position:  -0.02166003389502005
Bond Position:  [0.63955557]


portfolio before change:  [-1.60898138]
curr_Stock_Price:  103.81779013270338
curr_Factors:  [1.03817790e+02 3.62932173e-02]
mat_Sqrt:  [[ 1.97780975e+01  0.00000000e+00]
 [-7.62031152e-03  1.74603272e-02]]
grads:  [-0.00084205 -0.58426264]
Stock Position:  -0.0008420495399264369
Bond Position:  [-1.52156165]


portfolio before change:  [-1.6102261]
curr_Stock_Price:  104.84420278853094
curr_Factors:  [1.04844203e+02 3.68892599e-02]
mat_Sqrt:  [[ 2.01369825e+01  0.00000000e+00]
 [-7.68263079e-03  1.76031186e-02]]
grads:  [-1.26681197e-03 -3.58574949e+00]
Stock Position:  -0.00126681197137749
Bond Position:  [-1.47740821]


portfolio before change:  [-1.61394936]
curr_Stock_Price:  107.4916830963765
curr_Factors:  [1.07491683e+02 3.52394998e-02]
mat_Sqrt:  [[ 2.01785396e+01  0.00000000e+00]
 [-7.50887473e-03  1.72049934e-02]]
grads:  [7.54450743e-03 8.63575393e+00]
Stock Position:  0.007544507433179137
Bond Position:  [-2.42492116]


portfolio before change:  [-1.61363967]
curr_Stock_Price:  107.61309630097753
curr_Factors:  [1.07613096e+02 3.46468095e-02]
mat_Sqrt:  [[ 2.00307288e+01  0.00000000e+00]
 [-7.44546138e-03  1.70596952e-02]]
grads:  [-0.00704604 -3.57085856]
Stock Position:  -0.007046037115057843
Bond Position:  [-0.8553938]


portfolio before change:  [-1.61274128]
curr_Stock_Price:  107.45524069711905
curr_Factors:  [1.07455241e+02 3.39003801e-02]
mat_Sqrt:  [[ 1.97847189e+01  0.00000000e+00]
 [-7.36482234e-03  1.68749279e-02]]
grads:  [-5.43648120e-04 -2.60041671e+00]
Stock Position:  -0.0005436481204355031
Bond Position:  [-1.55432344]


portfolio before change:  [-1.61304153]
curr_Stock_Price:  107.29265873068509
curr_Factors:  [1.07292659e+02 3.34259804e-02]
mat_Sqrt:  [[ 1.96160737e+01  0.00000000e+00]
 [-7.31310937e-03  1.67564386e-02]]
grads:  [-2.08636079e-02 -3.84162797e+01]
Stock Position:  -0.02086360792016547
Bond Position:  [0.62547044]


portfolio before change:  [-1.5808044]
curr_Stock_Price:  105.75501751324556
curr_Factors:  [1.05755018e+02 3.45354905e-02]
mat_Sqrt:  [[ 1.96532236e+01  0.00000000e+00]
 [-7.43349075e-03  1.70322670e-02]]
grads:  [-0.01602104  0.9728298 ]
Stock Position:  -0.016021042687971197
Bond Position:  [0.11350125]


portfolio before change:  [-1.55250352]
curr_Stock_Price:  103.99030733116403
curr_Factors:  [1.03990307e+02 3.67193042e-02]
mat_Sqrt:  [[ 1.99269157e+01  0.00000000e+00]
 [-7.66491270e-03  1.75625213e-02]]
grads:  [0.00934023 3.52836601]
Stock Position:  0.009340234742473797
Bond Position:  [-2.5237974]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.56341733]
Stock Price:  102.88939483155168
PL:  [-4.45281216]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.98894450e-02  8.98724674e-02]
 [ 6.60098227e-02 -2.14691768e-02]
 [ 7.30694077e-01 -2.87024315e-01]
 [ 1.69248602e-01 -1.19024193e-01]
 [ 1.10591134e-01 -2.33420752e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-3.21032064e-01 -1.44887129e-01]
 [-1.37570992e+00  7.45304540e-01]
 [ 8.80990234e-02 -7.41323864e-02]
 [ 8.47799777e-02  1.63014565e-01]
 [-5.17745990e-02 -1.93609445e-02]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.47718646e-01 -1.98478427e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.16664154e-01 -6.21173313e-02]
 [-1.40535563e-01 -1.26475697e-01]
 [-1.72259193e-01 -4.81264740e-01]
 [ 2.31761037e-01 -2.23441964e-01]
 [ 1.10024046e-01 -4.54272433e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.14865683]
curr_Stock_Price:  98.67853421996604
curr_Factors:  [9.86785342e+01 4.17904292e-02]
mat_Sqrt:  [[ 2.01725642e+01  0.00000000e+00]
 [-8.17708302e-03  1.87360509e-02]]
grads:  [3.92181206e-03 4.79676682e+00]
Stock Position:  0.003921812062975147
Bond Position:  [-6.53565549]


portfolio before change:  [-6.14517517]
curr_Stock_Price:  99.98297607221242
curr_Factors:  [9.99829761e+01 4.33069497e-02]
mat_Sqrt:  [[ 2.08067792e+01  0.00000000e+00]
 [-8.32412876e-03  1.90729751e-02]]
grads:  [ 0.00272219 -1.12563335]
Stock Position:  0.002722185172960003
Bond Position:  [-6.41734734]


portfolio before change:  [-6.14618199]
curr_Stock_Price:  100.2025474315702
curr_Factors:  [1.00202547e+02 4.39533488e-02]
mat_Sqrt:  [[ 2.10075182e+01  0.00000000e+00]
 [-8.38602159e-03  1.92147894e-02]]
grads:  [  0.02881951 -14.93767688]
Stock Position:  0.028819510795522998
Bond Position:  [-9.03397039]


portfolio before change:  [-6.12834366]
curr_Stock_Price:  100.89989131482078
curr_Factors:  [1.00899891e+02 4.43336501e-02]
mat_Sqrt:  [[ 2.12450346e+01  0.00000000e+00]
 [-8.42222299e-03  1.92977372e-02]]
grads:  [ 5.52139303e-03 -6.16777977e+00]
Stock Position:  0.005521393027583845
Bond Position:  [-6.68545161]


portfolio before change:  [-6.12284405]
curr_Stock_Price:  102.1986903716601
curr_Factors:  [1.02198690e+02 4.32366564e-02]
mat_Sqrt:  [[ 2.12506090e+01  0.00000000e+00]
 [-8.31737039e-03  1.90574897e-02]]
grads:  [ 0.00472475 -1.22482423]
Stock Position:  0.004724750078723564
Bond Position:  [-6.60570732]


portfolio before change:  [-6.12193285]
curr_Stock_Price:  102.74111716147651
curr_Factors:  [1.02741117e+02 4.36412812e-02]
mat_Sqrt:  [[ 2.14631287e+01  0.00000000e+00]
 [-8.35619830e-03  1.91464556e-02]]
grads:  [-2.70054830e-05 -1.01069235e+00]
Stock Position:  -2.7005482965989538e-05
Bond Position:  [-6.11915828]


portfolio before change:  [-6.1234885]
curr_Stock_Price:  103.69156504087752
curr_Factors:  [1.03691565e+02 4.47302220e-02]
mat_Sqrt:  [[ 2.19302689e+01  0.00000000e+00]
 [-8.45980822e-03  1.93838558e-02]]
grads:  [-0.01752217 -7.47462895]
Stock Position:  -0.017522174215258923
Bond Position:  [-4.30658683]


portfolio before change:  [-6.10598306]
curr_Stock_Price:  102.63106793748553
curr_Factors:  [1.02631068e+02 4.87885661e-02]
mat_Sqrt:  [[ 2.26692877e+01  0.00000000e+00]
 [-8.83525357e-03  2.02441091e-02]]
grads:  [-0.04633725 36.81587244]
Stock Position:  -0.04633724535710217
Bond Position:  [-1.35034209]


portfolio before change:  [-5.98484785]
curr_Stock_Price:  100.00957333200729
curr_Factors:  [1.00009573e+02 4.94690047e-02]
mat_Sqrt:  [[ 2.22437580e+01  0.00000000e+00]
 [-8.89665148e-03  2.03847894e-02]]
grads:  [ 2.50609621e-03 -3.63665206e+00]
Stock Position:  0.0025060962076754244
Bond Position:  [-6.23548147]


portfolio before change:  [-5.98332177]
curr_Stock_Price:  101.24062905255069
curr_Factors:  [1.01240629e+02 4.86658339e-02]
mat_Sqrt:  [[ 2.23340210e+01  0.00000000e+00]
 [-8.82413362e-03  2.02186301e-02]]
grads:  [6.98151787e-03 8.06259195e+00]
Stock Position:  0.006981517866552762
Bond Position:  [-6.69013504]


portfolio before change:  [-5.99479412]
curr_Stock_Price:  99.83698006956594
curr_Factors:  [9.98369801e+01 5.11646184e-02]
mat_Sqrt:  [[ 2.25827229e+01  0.00000000e+00]
 [-9.04783894e-03  2.07312034e-02]]
grads:  [-0.00266684 -0.93390355]
Stock Position:  -0.0026668355380732194
Bond Position:  [-5.72854531]


portfolio before change:  [-5.99374794]
curr_Stock_Price:  98.90760240437083
curr_Factors:  [9.89076024e+01 5.28078963e-02]
mat_Sqrt:  [[ 2.27289361e+01  0.00000000e+00]
 [-9.19198749e-03  2.10614892e-02]]
grads:  [ 0.00211257 -0.40791906]
Stock Position:  0.002112570428748413
Bond Position:  [-6.20269721]


portfolio before change:  [-5.99229333]
curr_Stock_Price:  100.33026376703098
curr_Factors:  [1.00330264e+02 4.90272726e-02]
mat_Sqrt:  [[ 2.22152304e+01  0.00000000e+00]
 [-8.85684120e-03  2.02935726e-02]]
grads:  [ 0.0062595  -0.97803591]
Stock Position:  0.006259504638734871
Bond Position:  [-6.62031108]


portfolio before change:  [-5.97427958]
curr_Stock_Price:  103.47253048022732
curr_Factors:  [1.03472530e+02 4.60697588e-02]
mat_Sqrt:  [[ 2.22092064e+01  0.00000000e+00]
 [-8.58554682e-03  1.96719591e-02]]
grads:  [6.85468626e-03 7.55278561e+00]
Stock Position:  0.006854686262499742
Bond Position:  [-6.68355132]


portfolio before change:  [-5.98126917]
curr_Stock_Price:  102.69663931642074
curr_Factors:  [1.02696639e+02 4.51814182e-02]
mat_Sqrt:  [[ 2.18291166e+01  0.00000000e+00]
 [-8.50236844e-03  1.94813735e-02]]
grads:  [-0.00658636 -3.18854989]
Stock Position:  -0.006586358140418233
Bond Position:  [-5.30487232]


portfolio before change:  [-5.97712192]
curr_Stock_Price:  101.86558366421562
curr_Factors:  [1.01865584e+02 4.43932622e-02]
mat_Sqrt:  [[ 2.14627817e+01  0.00000000e+00]
 [-8.42788345e-03  1.93107069e-02]]
grads:  [-0.0091197 -6.5495115]
Stock Position:  -0.009119697766588419
Bond Position:  [-5.04813859]


portfolio before change:  [-5.97168923]
curr_Stock_Price:  101.13147065582892
curr_Factors:  [1.01131471e+02 4.37467691e-02]
mat_Sqrt:  [[ 2.11523836e+01  0.00000000e+00]
 [-8.36629132e-03  1.91695816e-02]]
grads:  [-1.80736295e-02 -2.51056465e+01]
Stock Position:  -0.018073629543205166
Bond Position:  [-4.14387649]


portfolio before change:  [-5.97025767]
curr_Stock_Price:  100.99493690595186
curr_Factors:  [1.00994937e+02 4.20585658e-02]
mat_Sqrt:  [[ 2.07122287e+01  0.00000000e+00]
 [-8.20327406e-03  1.87960622e-02]]
grads:  [ 6.48133870e-03 -1.18877008e+01]
Stock Position:  0.006481338703362984
Bond Position:  [-6.62484006]


portfolio before change:  [-5.96905865]
curr_Stock_Price:  101.43549879509234
curr_Factors:  [1.01435499e+02 4.11369851e-02]
mat_Sqrt:  [[ 2.05734061e+01  0.00000000e+00]
 [-8.11290183e-03  1.85889934e-02]]
grads:  [ 0.0043842  -2.44377102]
Stock Position:  0.004384202162746153
Bond Position:  [-6.41377239]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.97536412]
Stock Price:  100.36305156959263
PL:  [-6.33841569]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.01234707e-02  2.15761368e-02]
 [ 5.43754840e-02 -3.89522556e-02]
 [ 6.40237088e-01 -2.59416507e-01]
 [-1.27176376e-01 -1.46777260e-01]
 [ 5.65522591e-02 -1.91205918e-02]
 [ 4.19276740e-02 -5.07533318e-02]
 [-7.00675972e-02 -1.37998910e-01]
 [-1.28557054e+00  6.76872281e-01]
 [ 3.74102286e-02  1.42099731e-03]
 [ 2.09288239e-02 -6.07033888e-02]
 [ 1.12966830e-01  3.17131070e-01]
 [ 7.19225275e-02 -4.94873672e-02]
 [ 1.04447484e-01 -1.92687920e-02]
 [-8.06437446e-02 -1.13824135e-01]
 [ 1.12335276e-01  1.54993532e-01]
 [-8.68428359e-02 -1.19212292e-01]
 [-1.94850826e-01 -3.28885744e-01]
 [ 2.76284694e-01 -3.48844965e-01]
 [-6.03391092e-02 -1.40464938e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.4617466]
curr_Stock_Price:  101.48171111488394
curr_Factors:  [1.01481711e+02 3.93579672e-02]
mat_Sqrt:  [[ 2.01327968e+01  0.00000000e+00]
 [-7.93553701e-03  1.81825995e-02]]
grads:  [9.70559082e-04 1.18663653e+00]
Stock Position:  0.0009705590823064344
Bond Position:  [12.3632526]


portfolio before change:  [12.46295741]
curr_Stock_Price:  99.54429002431496
curr_Factors:  [9.95442900e+01 4.02670687e-02]
mat_Sqrt:  [[ 1.99752103e+01  0.00000000e+00]
 [-8.02666244e-03  1.83913941e-02]]
grads:  [ 1.87108548e-03 -2.11796101e+00]
Stock Position:  0.0018710854769313345
Bond Position:  [12.27670154]


portfolio before change:  [12.46554029]
curr_Stock_Price:  99.28418287859917
curr_Factors:  [9.92841829e+01 3.97610827e-02]
mat_Sqrt:  [[ 1.97974460e+01  0.00000000e+00]
 [-7.97607248e-03  1.82754780e-02]]
grads:  [  0.02662053 -14.19478646]
Stock Position:  0.026620526861998596
Bond Position:  [9.82254303]


portfolio before change:  [12.43884027]
curr_Stock_Price:  98.18893913221389
curr_Factors:  [9.81889391e+01 4.19720709e-02]
mat_Sqrt:  [[ 2.01160528e+01  0.00000000e+00]
 [-8.19483456e-03  1.87767248e-02]]
grads:  [-0.0095066  -7.81697878]
Stock Position:  -0.009506597820598558
Bond Position:  [13.37228302]


portfolio before change:  [12.40974393]
curr_Stock_Price:  101.60128812410524
curr_Factors:  [1.01601288e+02 4.15587867e-02]
mat_Sqrt:  [[ 2.07124105e+01  0.00000000e+00]
 [-8.15438892e-03  1.86840522e-02]]
grads:  [ 0.00232746 -1.02336429]
Stock Position:  0.0023274620191073023
Bond Position:  [12.17327079]


portfolio before change:  [12.40860664]
curr_Stock_Price:  99.80491513176872
curr_Factors:  [9.98049151e+01 4.19988259e-02]
mat_Sqrt:  [[ 2.04536351e+01  0.00000000e+00]
 [-8.19744603e-03  1.87827085e-02]]
grads:  [ 9.66923677e-04 -2.70213063e+00]
Stock Position:  0.000966923676664418
Bond Position:  [12.3121029]


portfolio before change:  [12.41179864]
curr_Stock_Price:  99.92238983368335
curr_Factors:  [9.99223898e+01 4.12354709e-02]
mat_Sqrt:  [[ 2.02907590e+01  0.00000000e+00]
 [-8.12260755e-03  1.86112320e-02]]
grads:  [-6.42140884e-03 -7.41481863e+00]
Stock Position:  -0.006421408842473221
Bond Position:  [13.05344115]


portfolio before change:  [12.43528742]
curr_Stock_Price:  96.77276644938908
curr_Factors:  [9.67727664e+01 4.32360202e-02]
mat_Sqrt:  [[ 2.01222255e+01  0.00000000e+00]
 [-8.31730920e-03  1.90573495e-02]]
grads:  [-0.04920724 35.51765062]
Stock Position:  -0.04920724361620547
Bond Position:  [17.19720852]


portfolio before change:  [12.49355751]
curr_Stock_Price:  95.67597168176535
curr_Factors:  [9.56759717e+01 4.49564384e-02]
mat_Sqrt:  [[ 2.02861125e+01  0.00000000e+00]
 [-8.48117335e-03  1.94328094e-02]]
grads:  [0.0018747  0.07312362]
Stock Position:  0.001874701356792915
Bond Position:  [12.31419364]


portfolio before change:  [12.49495518]
curr_Stock_Price:  94.77915512262759
curr_Factors:  [9.47791551e+01 4.58056027e-02]
mat_Sqrt:  [[ 2.02848656e+01  0.00000000e+00]
 [-8.56089740e-03  1.96154802e-02]]
grads:  [-2.74308297e-04 -3.09466749e+00]
Stock Position:  -0.00027430829674751417
Bond Position:  [12.52095389]


portfolio before change:  [12.49764979]
curr_Stock_Price:  96.3686832825913
curr_Factors:  [9.63686833e+01 4.15759995e-02]
mat_Sqrt:  [[ 1.96497611e+01  0.00000000e+00]
 [-8.15607744e-03  1.86879211e-02]]
grads:  [1.27927345e-02 1.69698421e+01]
Stock Position:  0.012792734468741898
Bond Position:  [11.26483081]


portfolio before change:  [12.48384961]
curr_Stock_Price:  95.06976337054897
curr_Factors:  [9.50697634e+01 3.91988015e-02]
mat_Sqrt:  [[ 1.88225651e+01  0.00000000e+00]
 [-7.91947488e-03  1.81457966e-02]]
grads:  [ 2.67362443e-03 -2.72720831e+00]
Stock Position:  0.002673624426089157
Bond Position:  [12.22966877]


portfolio before change:  [12.48470271]
curr_Stock_Price:  94.24515299746443
curr_Factors:  [9.42451530e+01 3.93084016e-02]
mat_Sqrt:  [[ 1.86853706e+01  0.00000000e+00]
 [-7.93053861e-03  1.81711467e-02]]
grads:  [ 0.00513974 -1.06040594]
Stock Position:  0.005139737143770437
Bond Position:  [12.0003074]


portfolio before change:  [12.49216711]
curr_Stock_Price:  95.1136696509411
curr_Factors:  [9.51136697e+01 4.04162980e-02]
mat_Sqrt:  [[ 1.91214668e+01  0.00000000e+00]
 [-8.04152205e-03  1.84254417e-02]]
grads:  [-0.00681541 -6.17755257]
Stock Position:  -0.006815411767234271
Bond Position:  [13.14040593]


portfolio before change:  [12.50352725]
curr_Stock_Price:  93.92890961818088
curr_Factors:  [9.39289096e+01 4.15977316e-02]
mat_Sqrt:  [[ 1.91572914e+01  0.00000000e+00]
 [-8.15820878e-03  1.86928046e-02]]
grads:  [0.00939486 8.29161459]
Stock Position:  0.009394856255203135
Bond Position:  [11.62107865]


portfolio before change:  [12.50797381]
curr_Stock_Price:  94.09292725373098
curr_Factors:  [9.40929273e+01 3.98881786e-02]
mat_Sqrt:  [[ 1.87922630e+01  0.00000000e+00]
 [-7.98881004e-03  1.83046634e-02]]
grads:  [-0.00738981 -6.51267331]
Stock Position:  -0.007389814919606481
Bond Position:  [13.20330312]


portfolio before change:  [12.49710028]
curr_Stock_Price:  96.011075720319
curr_Factors:  [9.60110757e+01 3.67286776e-02]
mat_Sqrt:  [[ 1.84002609e+01  0.00000000e+00]
 [-7.66589096e-03  1.75647628e-02]]
grads:  [-1.83904095e-02 -1.87241780e+01]
Stock Position:  -0.01839040946543674
Bond Position:  [14.26278328]


portfolio before change:  [12.52525761]
curr_Stock_Price:  94.67390097930738
curr_Factors:  [9.4673901e+01 3.9738594e-02]
mat_Sqrt:  [[ 1.88728080e+01  0.00000000e+00]
 [-7.97381656e-03  1.82703090e-02]]
grads:  [ 6.57222122e-03 -1.90935449e+01]
Stock Position:  0.006572221219679384
Bond Position:  [11.90303979]


portfolio before change:  [12.54590077]
curr_Stock_Price:  97.36203753037296
curr_Factors:  [9.73620375e+01 3.78190058e-02]
mat_Sqrt:  [[ 1.89341018e+01  0.00000000e+00]
 [-7.77884370e-03  1.78235700e-02]]
grads:  [-6.42454739e-03 -7.88085317e+00]
Stock Position:  -0.00642454738647641
Bond Position:  [13.1714078]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.56147691]
Stock Price:  95.45017202185095
PL:  [12.56147691]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.83670058e-03  1.54968961e-01]
 [ 6.49950524e-02 -2.29940860e-02]
 [ 6.57900973e-01 -2.64807590e-01]
 [ 1.28124113e-02 -1.03443657e-01]
 [ 1.93468174e-01 -5.60834713e-03]
 [-9.49411056e-03 -1.34033011e-01]
 [-3.91293162e-02 -9.35621679e-02]
 [-1.26454851e+00  7.07000440e-01]
 [ 7.10044526e-02 -4.65496390e-02]
 [ 1.53412191e-02 -8.76306413e-02]
 [ 1.13780391e-01  3.23165513e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.42919557e-01 -3.24471908e-02]
 [-6.30631013e-02 -7.54269327e-02]
 [ 9.87571332e-03  1.97708808e-03]
 [-1.43635990e-01 -1.40398167e-01]
 [-1.95279526e-01 -3.22925045e-01]
 [ 2.88771566e-01 -2.77867872e-01]
 [-1.10065771e-02 -1.27805541e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.43212287]
curr_Stock_Price:  99.38895831553124
curr_Factors:  [9.93889583e+01 4.17621764e-02]
mat_Sqrt:  [[ 2.03109249e+01  0.00000000e+00]
 [-8.17431846e-03  1.87297165e-02]]
grads:  [3.51883039e-03 8.27396188e+00]
Stock Position:  0.0035188303944040235
Bond Position:  [-1.78185575]


portfolio before change:  [-1.43060446]
curr_Stock_Price:  99.94707794456983
curr_Factors:  [9.99470779e+01 4.25811846e-02]
mat_Sqrt:  [[ 2.06242883e+01  0.00000000e+00]
 [-8.25408355e-03  1.89124813e-02]]
grads:  [ 0.0026648 -1.2158154]
Stock Position:  0.0026648003406115014
Bond Position:  [-1.69694346]


portfolio before change:  [-1.43318544]
curr_Stock_Price:  99.13774992901708
curr_Factors:  [9.91377499e+01 4.33041958e-02]
mat_Sqrt:  [[ 2.06302289e+01  0.00000000e+00]
 [-8.32386409e-03  1.90723686e-02]]
grads:  [  0.0262881 -13.8843578]
Stock Position:  0.026288097350087476
Bond Position:  [-4.03932826]


portfolio before change:  [-1.41740354]
curr_Stock_Price:  99.77651265900145
curr_Factors:  [9.97765127e+01 4.35325293e-02]
mat_Sqrt:  [[ 2.08178210e+01  0.00000000e+00]
 [-8.34578018e-03  1.91225847e-02]]
grads:  [-1.55319338e-03 -5.40950184e+00]
Stock Position:  -0.0015531933846063713
Bond Position:  [-1.26243133]


portfolio before change:  [-1.41677304]
curr_Stock_Price:  99.1673459591606
curr_Factors:  [9.91673460e+01 4.29026282e-02]
mat_Sqrt:  [[ 2.05404824e+01  0.00000000e+00]
 [-8.28517985e-03  1.89837319e-02]]
grads:  [ 0.00929971 -0.29542912]
Stock Position:  0.009299708073853573
Bond Position:  [-2.33900041]


portfolio before change:  [-1.43157961]
curr_Stock_Price:  97.63807759855071
curr_Factors:  [9.76380776e+01 4.34276910e-02]
mat_Sqrt:  [[ 2.03471033e+01  0.00000000e+00]
 [-8.33572466e-03  1.90995446e-02]]
grads:  [-3.34155244e-03 -7.01760247e+00]
Stock Position:  -0.003341552435320625
Bond Position:  [-1.10531686]


portfolio before change:  [-1.43446984]
curr_Stock_Price:  98.42030930658352
curr_Factors:  [9.84203093e+01 4.36181238e-02]
mat_Sqrt:  [[ 2.05550348e+01  0.00000000e+00]
 [-8.35398097e-03  1.91413751e-02]]
grads:  [-3.89019989e-03 -4.88795437e+00]
Stock Position:  -0.003890199886920495
Bond Position:  [-1.05159517]


portfolio before change:  [-1.43307431]
curr_Stock_Price:  97.9939917421942
curr_Factors:  [9.79939917e+01 4.39046390e-02]
mat_Sqrt:  [[ 2.05331062e+01  0.00000000e+00]
 [-8.38137354e-03  1.92041393e-02]]
grads:  [-0.04655838 36.81500265]
Stock Position:  -0.04655838265122482
Bond Position:  [3.12936745]


portfolio before change:  [-1.45019636]
curr_Stock_Price:  98.37855156581658
curr_Factors:  [9.83785516e+01 4.51797985e-02]
mat_Sqrt:  [[ 2.09108925e+01  0.00000000e+00]
 [-8.50221605e-03  1.94810243e-02]]
grads:  [ 0.00242402 -2.38948621]
Stock Position:  0.0024240249247315746
Bond Position:  [-1.68866842]


portfolio before change:  [-1.45261964]
curr_Stock_Price:  97.55303746643574
curr_Factors:  [9.75530375e+01 4.60712642e-02]
mat_Sqrt:  [[ 2.09389963e+01  0.00000000e+00]
 [-8.58568708e-03  1.96722805e-02]]
grads:  [-1.09384079e-03 -4.45452378e+00]
Stock Position:  -0.001093840785072283
Bond Position:  [-1.34591215]


portfolio before change:  [-1.45142335]
curr_Stock_Price:  96.15172190752897
curr_Factors:  [9.61517219e+01 4.45103766e-02]
mat_Sqrt:  [[ 2.02855927e+01  0.00000000e+00]
 [-8.43899298e-03  1.93361621e-02]]
grads:  [1.25616928e-02 1.67130122e+01]
Stock Position:  0.012561692826594039
Bond Position:  [-2.65925174]


portfolio before change:  [-1.44987112]
curr_Stock_Price:  96.3282210987805
curr_Factors:  [9.63282211e+01 4.57584729e-02]
mat_Sqrt:  [[ 2.06057915e+01  0.00000000e+00]
 [-8.55649208e-03  1.96053863e-02]]
grads:  [ 0.00233024 -0.43821543]
Stock Position:  0.0023302418768273224
Bond Position:  [-1.67433917]


portfolio before change:  [-1.45025728]
curr_Stock_Price:  96.34215716286847
curr_Factors:  [9.63421572e+01 4.44086691e-02]
mat_Sqrt:  [[ 2.03025339e+01  0.00000000e+00]
 [-8.42934580e-03  1.93140576e-02]]
grads:  [ 0.00634199 -1.67997795]
Stock Position:  0.006341988767041621
Bond Position:  [-2.06125816]


portfolio before change:  [-1.44664335]
curr_Stock_Price:  96.99326339281147
curr_Factors:  [9.69932634e+01 4.54244242e-02]
mat_Sqrt:  [[ 2.06721804e+01  0.00000000e+00]
 [-8.52520256e-03  1.95336930e-02]]
grads:  [-0.00464306 -3.86137596]
Stock Position:  -0.004643057071131682
Bond Position:  [-0.99629809]


portfolio before change:  [-1.45216541]
curr_Stock_Price:  98.12892754574648
curr_Factors:  [9.81289275e+01 4.47537038e-02]
mat_Sqrt:  [[ 2.07592445e+01  0.00000000e+00]
 [-8.46202848e-03  1.93889430e-02]]
grads:  [0.00051729 0.10196987]
Stock Position:  0.0005172917205154631
Bond Position:  [-1.50292669]


portfolio before change:  [-1.45302495]
curr_Stock_Price:  97.19373913972484
curr_Factors:  [9.71937391e+01 4.08187319e-02]
mat_Sqrt:  [[ 1.96366792e+01  0.00000000e+00]
 [-8.08145847e-03  1.85169476e-02]]
grads:  [-0.0104351  -7.58214424]
Stock Position:  -0.010435103185619948
Bond Position:  [-0.43879826]


portfolio before change:  [-1.43857387]
curr_Stock_Price:  95.79837247834195
curr_Factors:  [9.57983725e+01 4.12194673e-02]
mat_Sqrt:  [[ 1.94495393e+01  0.00000000e+00]
 [-8.12103120e-03  1.86076201e-02]]
grads:  [-1.72865570e-02 -1.73544517e+01]
Stock Position:  -0.017286556996783407
Bond Position:  [0.21745016]


portfolio before change:  [-1.45923817]
curr_Stock_Price:  96.9969150044782
curr_Factors:  [9.69969150e+01 4.11858193e-02]
mat_Sqrt:  [[ 1.96848349e+01  0.00000000e+00]
 [-8.11771586e-03  1.86000237e-02]]
grads:  [ 8.50909266e-03 -1.49391139e+01]
Stock Position:  0.00850909266427072
Bond Position:  [-2.28459391]


portfolio before change:  [-1.44727507]
curr_Stock_Price:  98.46996512514116
curr_Factors:  [9.84699651e+01 4.00850008e-02]
mat_Sqrt:  [[ 1.97149070e+01  0.00000000e+00]
 [-8.00849556e-03  1.83497686e-02]]
grads:  [-3.38756294e-03 -6.96496747e+00]
Stock Position:  -0.003387562937831931
Bond Position:  [-1.11370187]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.45112283]
Stock Price:  99.5236119592441
PL:  [-1.45112283]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.01615803e-01 -1.85708754e-01]
 [-5.84237029e-03  1.85467025e-01]
 [ 3.82016645e-01 -1.80606672e-01]
 [-9.20478092e-02 -9.61909700e-02]
 [ 3.35963576e-01 -1.32440463e-02]
 [-3.34378027e-01 -3.54144015e-01]
 [-4.86937276e-02 -5.85665544e-02]
 [-1.32522698e+00  6.30851196e-01]
 [ 5.31674927e-02 -2.11347989e-02]
 [ 1.89101928e-02 -7.04313835e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 8.16008885e-02 -7.08179097e-02]
 [ 1.12334294e-01 -2.88120645e-02]
 [-1.11206013e-01 -1.80134081e-01]
 [ 1.69968349e-01  2.63736880e-01]
 [-1.76355709e-02 -9.57724349e-02]
 [-2.01517369e-01 -2.35969129e-01]
 [ 4.85198140e-01 -5.01052363e-01]
 [-4.17545872e-01 -2.32129856e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-26.33488155]
curr_Stock_Price:  95.63800052174666
curr_Factors:  [9.56380005e+01 3.97226682e-02]
mat_Sqrt:  [[ 1.90611761e+01  0.00000000e+00]
 [-7.97221858e-03  1.82666476e-02]]
grads:  [ 6.32520561e-03 -1.01665483e+01]
Stock Position:  0.006325205606928902
Bond Position:  [-26.93981157]


portfolio before change:  [-26.34576238]
curr_Stock_Price:  94.98267968151004
curr_Factors:  [9.49826797e+01 3.80901341e-02]
mat_Sqrt:  [[ 1.85374789e+01  0.00000000e+00]
 [-7.80667756e-03  1.78873454e-02]]
grads:  [4.05136406e-03 1.03686165e+01]
Stock Position:  0.004051364063574188
Bond Position:  [-26.7305718]


portfolio before change:  [-26.34989374]
curr_Stock_Price:  95.61262207750488
curr_Factors:  [9.56126221e+01 3.65750247e-02]
mat_Sqrt:  [[ 1.82855296e+01  0.00000000e+00]
 [-7.64983918e-03  1.75279835e-02]]
grads:  [  0.01658106 -10.3039047 ]
Stock Position:  0.016581058277123757
Bond Position:  [-27.93525219]


portfolio before change:  [-26.34638528]
curr_Stock_Price:  96.24546098242438
curr_Factors:  [9.62454610e+01 3.54022144e-02]
mat_Sqrt:  [[ 1.81090418e+01  0.00000000e+00]
 [-7.52619047e-03  1.72446688e-02]]
grads:  [-0.00740122 -5.57801204]
Stock Position:  -0.007401219339481498
Bond Position:  [-25.63405152]


portfolio before change:  [-26.35239206]
curr_Stock_Price:  96.19107344238996
curr_Factors:  [9.61910734e+01 3.67663129e-02]
mat_Sqrt:  [[ 1.84441995e+01  0.00000000e+00]
 [-7.66981751e-03  1.75737596e-02]]
grads:  [ 0.01790175 -0.75362623]
Stock Position:  0.017901747436708974
Bond Position:  [-28.07438037]


portfolio before change:  [-26.37731651]
curr_Stock_Price:  95.19089318355029
curr_Factors:  [9.51908932e+01 3.77098421e-02]
mat_Sqrt:  [[ 1.84851406e+01  0.00000000e+00]
 [-7.76760886e-03  1.77978278e-02]]
grads:  [ -0.02645039 -19.89815944]
Stock Position:  -0.02645038827164343
Bond Position:  [-23.85948043]


portfolio before change:  [-26.39337037]
curr_Stock_Price:  95.57229570189844
curr_Factors:  [9.55722957e+01 3.51878144e-02]
mat_Sqrt:  [[ 1.79278481e+01  0.00000000e+00]
 [-7.50336612e-03  1.71923716e-02]]
grads:  [-0.00414184 -3.40654307]
Stock Position:  -0.004141839384221567
Bond Position:  [-25.99752527]


portfolio before change:  [-26.39702749]
curr_Stock_Price:  94.88586833706167
curr_Factors:  [9.48858683e+01 3.53404282e-02]
mat_Sqrt:  [[ 1.78376419e+01  0.00000000e+00]
 [-7.51962001e-03  1.72296139e-02]]
grads:  [-0.05885873 36.61435469]
Stock Position:  -0.05885872978966995
Bond Position:  [-20.81216581]


portfolio before change:  [-26.52364531]
curr_Stock_Price:  96.9486740638365
curr_Factors:  [9.69486741e+01 3.22491600e-02]
mat_Sqrt:  [[ 1.74100924e+01  0.00000000e+00]
 [-7.18322044e-03  1.64588257e-02]]
grads:  [ 0.00252403 -1.28410126]
Stock Position:  0.0025240250974660934
Bond Position:  [-26.7683462]


portfolio before change:  [-26.53318463]
curr_Stock_Price:  95.82095163815808
curr_Factors:  [9.58209516e+01 3.22527844e-02]
mat_Sqrt:  [[ 1.72085424e+01  0.00000000e+00]
 [-7.18362409e-03  1.64597506e-02]]
grads:  [-6.87366934e-04 -4.27900673e+00]
Stock Position:  -0.0006873669338871755
Bond Position:  [-26.46732048]


portfolio before change:  [-26.53851585]
curr_Stock_Price:  93.94940043060267
curr_Factors:  [9.39494004e+01 3.33717538e-02]
mat_Sqrt:  [[ 1.71626177e+01  0.00000000e+00]
 [-7.30717498e-03  1.67428412e-02]]
grads:  [1.57262957e-02 2.08787023e+01]
Stock Position:  0.015726295709572298
Bond Position:  [-28.0159919]


portfolio before change:  [-26.53576855]
curr_Stock_Price:  94.56951889523721
curr_Factors:  [9.45695189e+01 3.28156850e-02]
mat_Sqrt:  [[ 1.71313630e+01  0.00000000e+00]
 [-7.24604003e-03  1.66027635e-02]]
grads:  [ 2.95910015e-03 -4.26542906e+00]
Stock Position:  0.0029591001538655987
Bond Position:  [-26.81560923]


portfolio before change:  [-26.54212742]
curr_Stock_Price:  94.68640470578784
curr_Factors:  [9.46864047e+01 3.17452032e-02]
mat_Sqrt:  [[ 1.68704506e+01  0.00000000e+00]
 [-7.12687345e-03  1.63297185e-02]]
grads:  [ 0.00591328 -1.76439444]
Stock Position:  0.005913278809882092
Bond Position:  [-27.10203453]


portfolio before change:  [-26.56569093]
curr_Stock_Price:  91.84751375163816
curr_Factors:  [9.18475138e+01 3.10804446e-02]
mat_Sqrt:  [[ 1.61923923e+01  0.00000000e+00]
 [-7.05185872e-03  1.61578382e-02]]
grads:  [ -0.01172297 -11.14840234]
Stock Position:  -0.011722972608545374
Bond Position:  [-25.48896504]


portfolio before change:  [-26.56355839]
curr_Stock_Price:  91.12196637867464
curr_Factors:  [9.11219664e+01 3.15387532e-02]
mat_Sqrt:  [[ 1.61824899e+01  0.00000000e+00]
 [-7.10366139e-03  1.62765330e-02]]
grads:  [ 0.01761611 16.20350477]
Stock Position:  0.01761611240770102
Bond Position:  [-28.1687732]


portfolio before change:  [-26.55676153]
curr_Stock_Price:  91.90760720525446
curr_Factors:  [9.19076072e+01 3.00832080e-02]
mat_Sqrt:  [[ 1.59409255e+01  0.00000000e+00]
 [-6.93780460e-03  1.58965074e-02]]
grads:  [-3.72839633e-03 -6.02474699e+00]
Stock Position:  -0.0037283963341291308
Bond Position:  [-26.21409354]


portfolio before change:  [-26.5633844]
curr_Stock_Price:  91.92598751909155
curr_Factors:  [9.19259875e+01 2.99426349e-02]
mat_Sqrt:  [[ 1.59068180e+01  0.00000000e+00]
 [-6.92157611e-03  1.58593232e-02]]
grads:  [ -0.01914291 -14.87889019]
Stock Position:  -0.01914290714510074
Bond Position:  [-24.80365376]


portfolio before change:  [-26.54549784]
curr_Stock_Price:  90.66764922677389
curr_Factors:  [9.06676492e+01 2.99331360e-02]
mat_Sqrt:  [[ 1.56865871e+01  0.00000000e+00]
 [-6.92047814e-03  1.58568075e-02]]
grads:  [ 1.69903727e-02 -3.15985651e+01]
Stock Position:  0.01699037265872474
Bond Position:  [-28.08597498]


portfolio before change:  [-26.5750015]
curr_Stock_Price:  89.34447122932627
curr_Factors:  [8.93444712e+01 2.90726453e-02]
mat_Sqrt:  [[ 1.52338599e+01  0.00000000e+00]
 [-6.82028097e-03  1.56272269e-02]]
grads:  [ -0.03405937 -14.85419374]
Stock Position:  -0.03405936836208624
Bond Position:  [-23.53198524]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-26.59978935]
Stock Price:  89.89950580951067
PL:  [-26.59978935]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.84055693e-02  9.25310071e-02]
 [ 2.18753857e-02 -8.52752766e-02]
 [ 4.90560121e-01 -2.13734543e-01]
 [-9.74379428e-02 -1.03561133e-01]
 [ 3.62751807e-01 -1.52200191e-02]
 [-1.98353663e-01 -2.61847006e-01]
 [-3.12663108e-02 -5.18303942e-02]
 [-1.29978556e+00  6.57007109e-01]
 [ 2.48996032e-02  1.92774722e-02]
 [ 2.47560792e-02 -4.22594450e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 8.76044642e-02 -8.42003294e-02]
 [ 9.26636716e-02 -4.23288955e-03]
 [-8.62557368e-02 -1.26006602e-01]
 [ 8.32760333e-02  1.00227433e-01]
 [-1.43634509e-01 -1.40391519e-01]
 [-1.94520540e-01 -3.33503800e-01]
 [ 2.79760387e-01 -3.03932154e-01]
 [-1.48221715e-01 -1.63017404e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.95875797]
curr_Stock_Price:  98.70713758126624
curr_Factors:  [9.87071376e+01 3.88697115e-02]
mat_Sqrt:  [[ 1.94605099e+01  0.00000000e+00]
 [-7.88616119e-03  1.80694653e-02]]
grads:  [4.04868176e-03 5.12084921e+00]
Stock Position:  0.004048681757980897
Bond Position:  [-6.35839175]


portfolio before change:  [-5.97032372]
curr_Stock_Price:  96.24313553142082
curr_Factors:  [9.62431355e+01 4.11126557e-02]
mat_Sqrt:  [[ 1.95145045e+01  0.00000000e+00]
 [-8.11050239e-03  1.85834956e-02]]
grads:  [-7.86174004e-04 -4.58876406e+00]
Stock Position:  -0.0007861740040546868
Bond Position:  [-5.89465987]


portfolio before change:  [-5.97211297]
curr_Stock_Price:  96.64431619739665
curr_Factors:  [9.66443162e+01 4.21934016e-02]
mat_Sqrt:  [[ 1.98517404e+01  0.00000000e+00]
 [-8.21641300e-03  1.88261673e-02]]
grads:  [  0.02001229 -11.35305661]
Stock Position:  0.020012286636985916
Bond Position:  [-7.90618673]


portfolio before change:  [-5.97576204]
curr_Stock_Price:  96.5607535949063
curr_Factors:  [9.65607536e+01 4.27666192e-02]
mat_Sqrt:  [[ 1.99688524e+01  0.00000000e+00]
 [-8.27203667e-03  1.89536171e-02]]
grads:  [-0.00714291 -5.46392453]
Stock Position:  -0.007142910580218881
Bond Position:  [-5.28603721]


portfolio before change:  [-5.96915865]
curr_Stock_Price:  95.45125305194858
curr_Factors:  [9.54512531e+01 4.05065447e-02]
mat_Sqrt:  [[ 1.92107462e+01  0.00000000e+00]
 [-8.05049511e-03  1.84460016e-02]]
grads:  [ 0.01853698 -0.8251121 ]
Stock Position:  0.01853698151676792
Bond Position:  [-7.73853677]


portfolio before change:  [-5.95731333]
curr_Stock_Price:  96.19464270985635
curr_Factors:  [9.61946427e+01 4.24516567e-02]
mat_Sqrt:  [[ 1.98197516e+01  0.00000000e+00]
 [-8.24151992e-03  1.88836944e-02]]
grads:  [ -0.01577381 -13.86630178]
Stock Position:  -0.015773813479731606
Bond Position:  [-4.43995698]


portfolio before change:  [-5.95763369]
curr_Stock_Price:  96.14457468854799
curr_Factors:  [9.61445747e+01 4.10736377e-02]
mat_Sqrt:  [[ 1.94852672e+01  0.00000000e+00]
 [-8.10665285e-03  1.85746751e-02]]
grads:  [-2.76552273e-03 -2.79037958e+00]
Stock Position:  -0.0027655227259949645
Bond Position:  [-5.69174369]


portfolio before change:  [-5.95855892]
curr_Stock_Price:  95.96454158266971
curr_Factors:  [9.59645416e+01 4.24045052e-02]
mat_Sqrt:  [[ 1.97613583e+01  0.00000000e+00]
 [-8.23694169e-03  1.88732044e-02]]
grads:  [-0.05126389 34.81163537]
Stock Position:  -0.05126389273514318
Bond Position:  [-1.03904296]


portfolio before change:  [-5.89246835]
curr_Stock_Price:  94.67025114066386
curr_Factors:  [9.46702511e+01 4.30240354e-02]
mat_Sqrt:  [[ 1.96367269e+01  0.00000000e+00]
 [-8.29689440e-03  1.90105733e-02]]
grads:  [0.00169646 1.0140395 ]
Stock Position:  0.0016964630606741932
Bond Position:  [-6.05307293]


portfolio before change:  [-5.89703796]
curr_Stock_Price:  92.86876554013996
curr_Factors:  [9.28687655e+01 4.24398649e-02]
mat_Sqrt:  [[ 1.91318369e+01  0.00000000e+00]
 [-8.24037523e-03  1.88810716e-02]]
grads:  [ 3.29949779e-04 -2.23819102e+00]
Stock Position:  0.00032994977870796303
Bond Position:  [-5.92767999]


portfolio before change:  [-5.89846212]
curr_Stock_Price:  93.04439139407266
curr_Factors:  [9.30443914e+01 4.32492613e-02]
mat_Sqrt:  [[ 1.93499366e+01  0.00000000e+00]
 [-8.31858270e-03  1.90602674e-02]]
grads:  [1.39485936e-02 1.83401833e+01]
Stock Position:  0.013948593552406446
Bond Position:  [-7.19630052]


portfolio before change:  [-5.88333289]
curr_Stock_Price:  94.25802842917665
curr_Factors:  [9.42580284e+01 4.08908596e-02]
mat_Sqrt:  [[ 1.90603763e+01  0.00000000e+00]
 [-8.08859539e-03  1.85333003e-02]]
grads:  [ 2.66817542e-03 -4.54319134e+00]
Stock Position:  0.002668175424064123
Bond Position:  [-6.13482984]


portfolio before change:  [-5.88648616]
curr_Stock_Price:  93.65110551419698
curr_Factors:  [9.36511055e+01 4.15518568e-02]
mat_Sqrt:  [[ 1.90900966e+01  0.00000000e+00]
 [-8.15370903e-03  1.86824944e-02]]
grads:  [ 0.00475725 -0.22656983]
Stock Position:  0.004757246070445743
Bond Position:  [-6.33200752]


portfolio before change:  [-5.88395361]
curr_Stock_Price:  94.51626025851725
curr_Factors:  [9.45162603e+01 4.15730318e-02]
mat_Sqrt:  [[ 1.92713606e+01  0.00000000e+00]
 [-8.15578635e-03  1.86872541e-02]]
grads:  [-0.0073295  -6.74291692]
Stock Position:  -0.00732950461289662
Bond Position:  [-5.19119624]


portfolio before change:  [-5.89129124]
curr_Stock_Price:  95.34028179119377
curr_Factors:  [9.53402818e+01 4.10858989e-02]
mat_Sqrt:  [[ 1.93251480e+01  0.00000000e+00]
 [-8.10786275e-03  1.85774474e-02]]
grads:  [0.00657272 5.39511327]
Stock Position:  0.00657272437850269
Bond Position:  [-6.51793664]


portfolio before change:  [-5.88449546]
curr_Stock_Price:  96.62216566496112
curr_Factors:  [9.66221657e+01 4.11019813e-02]
mat_Sqrt:  [[ 1.95888142e+01  0.00000000e+00]
 [-8.10944943e-03  1.85810829e-02]]
grads:  [-0.01046038 -7.55561554]
Stock Position:  -0.010460377505677576
Bond Position:  [-4.87379113]


portfolio before change:  [-5.8819693]
curr_Stock_Price:  96.26417081269487
curr_Factors:  [9.62641708e+01 4.20621655e-02]
mat_Sqrt:  [[ 1.97428792e+01  0.00000000e+00]
 [-8.20362510e-03  1.87968665e-02]]
grads:  [-1.72251234e-02 -1.77425211e+01]
Stock Position:  -0.017225123441648053
Bond Position:  [-4.22380707]


portfolio before change:  [-5.87880901]
curr_Stock_Price:  96.01939022577685
curr_Factors:  [9.60193902e+01 4.09709443e-02]
mat_Sqrt:  [[ 1.94355543e+01  0.00000000e+00]
 [-8.09651226e-03  1.85514402e-02]]
grads:  [ 7.56929897e-03 -1.63832107e+01]
Stock Position:  0.0075692989676993915
Bond Position:  [-6.60560848]


portfolio before change:  [-5.88521111]
curr_Stock_Price:  95.39178950733776
curr_Factors:  [9.53917895e+01 3.93948194e-02]
mat_Sqrt:  [[ 1.89334847e+01  0.00000000e+00]
 [-7.93925129e-03  1.81911100e-02]]
grads:  [-0.01158626 -8.96137753]
Stock Position:  -0.011586263529488793
Bond Position:  [-4.7799767]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.88679453]
Stock Price:  95.42530078176709
PL:  [-5.88679453]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.28957132e-02  2.49850804e-02]
 [ 7.10702911e-02 -1.38647422e-02]
 [ 8.33022174e-01 -3.18255229e-01]
 [ 2.89618984e-01 -9.04672811e-02]
 [ 1.94591161e-01 -2.89463122e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-7.53847622e-01 -1.71880175e-02]
 [-1.55828285e+00  6.52959102e-01]
 [-7.88199675e-02 -2.40556031e-02]
 [ 1.99751043e-01  9.93194164e-01]
 [-4.88503686e-01 -1.02350378e-01]
 [-1.77758015e-02 -1.06203110e-02]
 [-1.30956773e-02 -7.38458678e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.13922600e-01 -6.05613523e-02]
 [ 1.52422201e-01  7.68651860e-02]
 [-4.11544025e-02 -7.06183044e-01]
 [-3.98925523e-01  1.15778391e-01]
 [-7.24093991e-02 -8.60403711e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.10888138]
curr_Stock_Price:  101.12731270288214
curr_Factors:  [1.01127313e+02 3.96671438e-02]
mat_Sqrt:  [[ 2.01411346e+01  0.00000000e+00]
 [-7.96664485e-03  1.82538765e-02]]
grads:  [1.18166611e-03 1.36875476e+00]
Stock Position:  0.001181666111103865
Bond Position:  [9.98938266]


portfolio before change:  [10.11025652]
curr_Stock_Price:  100.17736857528642
curr_Factors:  [1.00177369e+02 4.00396337e-02]
mat_Sqrt:  [[ 2.00453973e+01  0.00000000e+00]
 [-8.00396239e-03  1.83393818e-02]]
grads:  [ 0.0032436  -0.75600925]
Stock Position:  0.0032435985482670215
Bond Position:  [9.78532135]


portfolio before change:  [10.12149447]
curr_Stock_Price:  102.88772567295612
curr_Factors:  [1.02887726e+02 3.72517837e-02]
mat_Sqrt:  [[ 1.98580730e+01  0.00000000e+00]
 [-7.72028846e-03  1.76894031e-02]]
grads:  [  0.03495426 -17.99129267]
Stock Position:  0.03495425785171704
Bond Position:  [6.52513037]


portfolio before change:  [10.1036678]
curr_Stock_Price:  102.3310508859406
curr_Factors:  [1.02331051e+02 3.80994526e-02]
mat_Sqrt:  [[ 1.99740808e+01  0.00000000e+00]
 [-7.80763243e-03  1.78895333e-02]]
grads:  [ 0.01252302 -5.05699503]
Stock Position:  0.012523020615384486
Bond Position:  [8.82217394]


portfolio before change:  [10.11766609]
curr_Stock_Price:  103.27271489384039
curr_Factors:  [1.03272715e+02 3.83069805e-02]
mat_Sqrt:  [[ 2.02127104e+01  0.00000000e+00]
 [-7.82886765e-03  1.79381893e-02]]
grads:  [ 0.00900216 -1.61366968]
Stock Position:  0.009002155095076542
Bond Position:  [9.1879891]


portfolio before change:  [10.14046782]
curr_Stock_Price:  105.55044110337587
curr_Factors:  [1.05550441e+02 3.81492726e-02]
mat_Sqrt:  [[ 2.06159420e+01  0.00000000e+00]
 [-7.81273551e-03  1.79012259e-02]]
grads:  [-2.81152400e-05 -1.08099726e+00]
Stock Position:  -2.8115239998302442e-05
Bond Position:  [10.1434354]


portfolio before change:  [10.14294099]
curr_Stock_Price:  107.79145453036385
curr_Factors:  [1.07791455e+02 3.73410423e-02]
mat_Sqrt:  [[ 2.08294379e+01  0.00000000e+00]
 [-7.72953218e-03  1.77105831e-02]]
grads:  [-0.03655159 -0.97049416]
Stock Position:  -0.03655159066436555
Bond Position:  [14.08289012]


portfolio before change:  [10.13588411]
curr_Stock_Price:  108.08085506893548
curr_Factors:  [1.08080855e+02 3.89976362e-02]
mat_Sqrt:  [[ 2.13436118e+01  0.00000000e+00]
 [-7.89912767e-03  1.80991752e-02]]
grads:  [-0.05965758 36.07673246]
Stock Position:  -0.05965757539141306
Bond Position:  [16.58372587]


portfolio before change:  [10.00170727]
curr_Stock_Price:  110.3994757876588
curr_Factors:  [1.10399476e+02 3.68318665e-02]
mat_Sqrt:  [[ 2.11874590e+01  0.00000000e+00]
 [-7.67665203e-03  1.75894195e-02]]
grads:  [-0.00421564 -1.36761779]
Stock Position:  -0.004215639701735663
Bond Position:  [10.46711168]


portfolio before change:  [10.01062828]
curr_Stock_Price:  108.90411369794693
curr_Factors:  [1.08904114e+02 3.81583303e-02]
mat_Sqrt:  [[ 2.12735009e+01  0.00000000e+00]
 [-7.81366294e-03  1.79033509e-02]]
grads:  [2.97655057e-02 5.54753224e+01]
Stock Position:  0.02976550571061629
Bond Position:  [6.76904226]


portfolio before change:  [9.92650351]
curr_Stock_Price:  106.02100310918037
curr_Factors:  [1.06021003e+02 3.92661316e-02]
mat_Sqrt:  [[ 2.10087865e+01  0.00000000e+00]
 [-7.92627343e-03  1.81613740e-02]]
grads:  [-0.02537857 -5.63560762]
Stock Position:  -0.025378574493108867
Bond Position:  [12.61716543]


portfolio before change:  [9.97823323]
curr_Stock_Price:  104.10698529904232
curr_Factors:  [1.04106985e+02 3.89400770e-02]
mat_Sqrt:  [[ 2.05436815e+01  0.00000000e+00]
 [-7.89329609e-03  1.80858134e-02]]
grads:  [-0.00109089 -0.58721777]
Stock Position:  -0.001090889442998737
Bond Position:  [10.09180245]


portfolio before change:  [9.97910025]
curr_Stock_Price:  105.62524028209626
curr_Factors:  [1.05625240e+02 3.70995135e-02]
mat_Sqrt:  [[ 2.03447247e+01  0.00000000e+00]
 [-7.70449360e-03  1.76532126e-02]]
grads:  [-2.22783335e-03 -4.18314046e+00]
Stock Position:  -0.0022278333531060403
Bond Position:  [10.21441569]


portfolio before change:  [9.97901999]
curr_Stock_Price:  106.80763987895871
curr_Factors:  [1.06807640e+02 3.57343719e-02]
mat_Sqrt:  [[ 2.01904219e+01  0.00000000e+00]
 [-7.56141488e-03  1.73253780e-02]]
grads:  [7.54006738e-03 8.57574878e+00]
Stock Position:  0.00754006737607242
Bond Position:  [9.17368319]


portfolio before change:  [9.99835869]
curr_Stock_Price:  109.06822959022894
curr_Factors:  [1.09068230e+02 3.53614266e-02]
mat_Sqrt:  [[ 2.05098816e+01  0.00000000e+00]
 [-7.52185367e-03  1.72347319e-02]]
grads:  [-0.00684323 -3.51391322]
Stock Position:  -0.0068432253079754035
Bond Position:  [10.74473716]


portfolio before change:  [9.98145429]
curr_Stock_Price:  111.931049002105
curr_Factors:  [1.11931049e+02 3.68834234e-02]
mat_Sqrt:  [[ 2.14964223e+01  0.00000000e+00]
 [-7.68202300e-03  1.76017259e-02]]
grads:  [0.00865116 4.36691187]
Stock Position:  0.00865115672534969
Bond Position:  [9.01312125]


portfolio before change:  [9.97892297]
curr_Stock_Price:  111.37795711616882
curr_Factors:  [1.11377957e+02 3.67503270e-02]
mat_Sqrt:  [[ 2.13515718e+01  0.00000000e+00]
 [-7.66814992e-03  1.75699387e-02]]
grads:  [-1.63621654e-02 -4.01926868e+01]
Stock Position:  -0.016362165424363282
Bond Position:  [11.80130753]


portfolio before change:  [9.99012348]
curr_Stock_Price:  110.87375663209646
curr_Factors:  [1.10873757e+02 3.73379626e-02]
mat_Sqrt:  [[ 2.14241732e+01  0.00000000e+00]
 [-7.72921342e-03  1.77098528e-02]]
grads:  [-0.0162618   6.53751288]
Stock Position:  -0.016261803318993996
Bond Position:  [11.7931307]


portfolio before change:  [9.99935019]
curr_Stock_Price:  110.48769510498947
curr_Factors:  [1.10487695e+02 3.79256693e-02]
mat_Sqrt:  [[ 2.15169416e+01  0.00000000e+00]
 [-7.78980557e-03  1.78486868e-02]]
grads:  [-0.00511041 -4.82054349]
Stock Position:  -0.005110414748721283
Bond Position:  [10.56398813]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.00793152]
Stock Price:  109.32536124297732
PL:  [0.68257028]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 5.57031188e-03  1.59772535e-02]
 [-3.88609020e-01  2.72312773e-01]
 [ 9.17640166e-01 -3.44080953e-01]
 [ 2.37701691e-01 -1.06658124e-01]
 [ 2.30923059e-02 -1.17971244e-02]
 [ 2.59369170e-02 -7.84106519e-02]
 [-6.52121280e-02 -1.31023123e-01]
 [-1.27412966e+00  7.37119704e-01]
 [ 8.92169871e-02 -7.39817862e-02]
 [ 4.79517074e-02 -5.52138041e-03]
 [-2.24596716e-02  5.60310691e-02]
 [ 4.35353634e-02 -8.71831636e-03]
 [ 1.65518606e-01 -2.88046133e-02]
 [ 2.43552193e-02  4.40850233e-02]
 [-1.00273501e-01 -4.41073768e-02]
 [-1.40363542e-01 -1.25703237e-01]
 [-1.69277066e-01 -4.98319436e-01]
 [-5.61704061e-02 -1.58169376e-01]
 [ 1.59084650e-01  6.83174241e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.32597091]
curr_Stock_Price:  102.06375676233866
curr_Factors:  [1.02063757e+02 3.78883295e-02]
mat_Sqrt:  [[ 1.98666334e+01  0.00000000e+00]
 [-7.78596990e-03  1.78398982e-02]]
grads:  [6.31378084e-04 8.95591067e-01]
Stock Position:  0.0006313780842090649
Bond Position:  [16.26153009]


portfolio before change:  [16.33120382]
curr_Stock_Price:  103.91212766121009
curr_Factors:  [1.03912128e+02 3.60057853e-02]
mat_Sqrt:  [[ 1.97175241e+01  0.00000000e+00]
 [-7.59007619e-03  1.73910493e-02]]
grads:  [-1.36813314e-02  1.56582141e+01]
Stock Position:  -0.013681331431433765
Bond Position:  [17.75286008]


portfolio before change:  [16.33670532]
curr_Stock_Price:  103.83445052821199
curr_Factors:  [1.03834451e+02 3.86146945e-02]
mat_Sqrt:  [[ 2.04041154e+01  0.00000000e+00]
 [-7.86024880e-03  1.80100926e-02]]
grads:  [  0.03761354 -19.10489643]
Stock Position:  0.03761353590637472
Bond Position:  [12.43112448]


portfolio before change:  [16.25795754]
curr_Stock_Price:  101.65821410281309
curr_Factors:  [1.01658214e+02 3.88649065e-02]
mat_Sqrt:  [[ 2.00410877e+01  0.00000000e+00]
 [-7.88567374e-03  1.80683484e-02]]
grads:  [ 0.00953802 -5.9030367 ]
Stock Position:  0.009538018690422215
Bond Position:  [15.28833959]


portfolio before change:  [16.2505758]
curr_Stock_Price:  100.48351462450407
curr_Factors:  [1.00483515e+02 3.97735107e-02]
mat_Sqrt:  [[ 2.00397261e+01  0.00000000e+00]
 [-7.97731892e-03  1.82783339e-02]]
grads:  [ 0.0008954  -0.64541574]
Stock Position:  0.0008954023929141767
Bond Position:  [16.16060262]


portfolio before change:  [16.25319309]
curr_Stock_Price:  98.89387569673397
curr_Factors:  [9.88938757e+01 3.99855781e-02]
mat_Sqrt:  [[ 1.97752092e+01  0.00000000e+00]
 [-7.99855768e-03  1.83269980e-02]]
grads:  [-4.18923359e-04 -4.27842311e+00]
Stock Position:  -0.00041892335942796875
Bond Position:  [16.29462204]


portfolio before change:  [16.25693151]
curr_Stock_Price:  99.69532200791787
curr_Factors:  [9.96953220e+01 3.71346204e-02]
mat_Sqrt:  [[ 1.92116327e+01  0.00000000e+00]
 [-7.70813808e-03  1.76615631e-02]]
grads:  [-6.37089564e-03 -7.41854628e+00]
Stock Position:  -0.00637089564113261
Bond Position:  [16.89208]


portfolio before change:  [16.26110266]
curr_Stock_Price:  99.70354609760298
curr_Factors:  [9.97035461e+01 3.82817140e-02]
mat_Sqrt:  [[ 1.95077101e+01  0.00000000e+00]
 [-7.82628535e-03  1.79322725e-02]]
grads:  [-0.04882296 41.10576077]
Stock Position:  -0.04882296492146262
Bond Position:  [21.12892539]


portfolio before change:  [16.25390362]
curr_Stock_Price:  99.95920303081331
curr_Factors:  [9.99592030e+01 3.55636258e-02]
mat_Sqrt:  [[ 1.88506270e+01  0.00000000e+00]
 [-7.54332826e-03  1.72839364e-02]]
grads:  [ 3.01998912e-03 -4.28037830e+00]
Stock Position:  0.003019989118205638
Bond Position:  [15.95202792]


portfolio before change:  [16.25910741]
curr_Stock_Price:  100.36161681842228
curr_Factors:  [1.00361617e+02 3.43651121e-02]
mat_Sqrt:  [[ 1.86048654e+01  0.00000000e+00]
 [-7.41513178e-03  1.69902013e-02]]
grads:  [ 0.00244785 -0.3249744 ]
Stock Position:  0.002447853212882575
Bond Position:  [16.01343691]


portfolio before change:  [16.26050122]
curr_Stock_Price:  99.29535482941725
curr_Factors:  [9.92953548e+01 3.36977536e-02]
mat_Sqrt:  [[ 1.82275966e+01  0.00000000e+00]
 [-7.34277916e-03  1.68244207e-02]]
grads:  [1.09410570e-04 3.33034166e+00]
Stock Position:  0.0001094105695983636
Bond Position:  [16.24963726]


portfolio before change:  [16.26456908]
curr_Stock_Price:  99.3405611273746
curr_Factors:  [9.93405611e+01 3.51204512e-02]
mat_Sqrt:  [[ 1.86168694e+01  0.00000000e+00]
 [-7.49618049e-03  1.71759072e-02]]
grads:  [ 0.00213411 -0.50758986]
Stock Position:  0.0021341062955590644
Bond Position:  [16.05256577]


portfolio before change:  [16.26611976]
curr_Stock_Price:  98.18646539476066
curr_Factors:  [9.81864654e+01 3.48383442e-02]
mat_Sqrt:  [[ 1.83265358e+01  0.00000000e+00]
 [-7.46601304e-03  1.71067849e-02]]
grads:  [ 0.00834567 -1.68381221]
Stock Position:  0.00834567119374554
Bond Position:  [15.44668781]


portfolio before change:  [16.28332717]
curr_Stock_Price:  99.78552797667237
curr_Factors:  [9.97855280e+01 3.28272351e-02]
mat_Sqrt:  [[ 1.80794291e+01  0.00000000e+00]
 [-7.24731510e-03  1.66056850e-02]]
grads:  [2.41133172e-03 2.65481510e+00]
Stock Position:  0.002411331718948946
Bond Position:  [16.04271116]


portfolio before change:  [16.28729228]
curr_Stock_Price:  99.76642483450121
curr_Factors:  [9.97664248e+01 3.21913627e-02]
mat_Sqrt:  [[ 1.79000436e+01  0.00000000e+00]
 [-7.17678063e-03  1.64440702e-02]]
grads:  [-0.00667728 -2.68226638]
Stock Position:  -0.006677276343107354
Bond Position:  [16.95346027]


portfolio before change:  [16.27634693]
curr_Stock_Price:  102.04044326024238
curr_Factors:  [1.02040443e+02 3.03822954e-02]
mat_Sqrt:  [[ 1.77861777e+01  0.00000000e+00]
 [-6.97220716e-03  1.59753335e-02]]
grads:  [-0.01097622 -7.86858297]
Stock Position:  -0.010976216206764085
Bond Position:  [17.3963649]


portfolio before change:  [16.28659845]
curr_Stock_Price:  101.5027451781738
curr_Factors:  [1.01502745e+02 3.03232310e-02]
mat_Sqrt:  [[ 1.76752484e+01  0.00000000e+00]
 [-6.96542673e-03  1.59597976e-02]]
grads:  [-2.18815312e-02 -3.12234182e+01]
Stock Position:  -0.021881531156575675
Bond Position:  [18.50763394]


portfolio before change:  [16.26052198]
curr_Stock_Price:  102.90593599014281
curr_Factors:  [1.02905936e+02 3.16974104e-02]
mat_Sqrt:  [[ 1.83211326e+01  0.00000000e+00]
 [-7.12150662e-03  1.63174216e-02]]
grads:  [-6.83370312e-03 -9.69328243e+00]
Stock Position:  -0.006833703117811242
Bond Position:  [16.96375059]


portfolio before change:  [16.25726706]
curr_Stock_Price:  104.00290893303595
curr_Factors:  [1.04002909e+02 3.13964837e-02]
mat_Sqrt:  [[ 1.84283305e+01  0.00000000e+00]
 [-7.08762118e-03  1.62397803e-02]]
grads:  [0.01025057 4.20679486]
Stock Position:  0.010250566026907744
Bond Position:  [15.19117837]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.24990665]
Stock Price:  102.91431735844664
PL:  [13.33558929]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [-3.29600922e-04  1.37567757e-01]
 [ 6.16451056e-02 -2.80280964e-02]
 [ 5.50430469e-01 -2.32007194e-01]
 [-1.04029368e-01 -9.55915985e-02]
 [ 1.34277751e-01 -6.63456297e-03]
 [-1.02647456e-02 -1.34678863e-01]
 [-6.86947711e-02 -1.36027393e-01]
 [-1.25833133e+00  7.35062649e-01]
 [ 7.80196620e-02 -5.65745390e-02]
 [ 1.74627331e-02 -9.32318572e-02]
 [ 1.07525741e-01  3.04155951e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.52665826e-01 -3.06183296e-02]
 [-6.67197523e-02 -8.36159307e-02]
 [ 6.74189930e-02  7.02827230e-02]
 [-1.43381206e-01 -1.39254064e-01]
 [-1.94680863e-01 -3.31279044e-01]
 [ 2.89765980e-01 -2.68092601e-01]
 [ 2.82284759e-02 -1.17737776e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.28891552]
curr_Stock_Price:  99.56115299316778
curr_Factors:  [9.95611530e+01 4.01450602e-02]
mat_Sqrt:  [[ 1.99483038e+01  0.00000000e+00]
 [-8.01449289e-03  1.83635102e-02]]
grads:  [2.99323145e-03 7.49136497e+00]
Stock Position:  0.00299323144908779
Bond Position:  [-0.58692509]


portfolio before change:  [-0.28827208]
curr_Stock_Price:  99.82514389143941
curr_Factors:  [9.98251439e+01 4.17205208e-02]
mat_Sqrt:  [[ 2.03898864e+01  0.00000000e+00]
 [-8.17024071e-03  1.87203733e-02]]
grads:  [ 0.00242339 -1.49719752]
Stock Position:  0.0024233897435521137
Bond Position:  [-0.53018731]


portfolio before change:  [-0.29409631]
curr_Stock_Price:  97.47650772560752
curr_Factors:  [9.74765077e+01 4.30917467e-02]
mat_Sqrt:  [[ 2.02347112e+01  0.00000000e+00]
 [-8.30342066e-03  1.90255269e-02]]
grads:  [  0.0221982 -12.1945214]
Stock Position:  0.022198203058651826
Bond Position:  [-2.45789962]


portfolio before change:  [-0.26318883]
curr_Stock_Price:  98.89653379317076
curr_Factors:  [9.88965338e+01 4.10536719e-02]
mat_Sqrt:  [[ 2.00381247e+01  0.00000000e+00]
 [-8.10468229e-03  1.85701600e-02]]
grads:  [-0.00727358 -5.14759153]
Stock Position:  -0.007273582948932041
Bond Position:  [0.45614331]


portfolio before change:  [-0.268676]
curr_Stock_Price:  99.66661125445638
curr_Factors:  [9.96666113e+01 4.11804668e-02]
mat_Sqrt:  [[ 2.02253164e+01  0.00000000e+00]
 [-8.11718836e-03  1.85988151e-02]]
grads:  [ 0.00649593 -0.35671966]
Stock Position:  0.006495927565705482
Bond Position:  [-0.91610309]


portfolio before change:  [-0.28216718]
curr_Stock_Price:  97.62500615552325
curr_Factors:  [9.76250062e+01 4.16948089e-02]
mat_Sqrt:  [[ 1.99343495e+01  0.00000000e+00]
 [-8.16772271e-03  1.87146038e-02]]
grads:  [-3.46354017e-03 -7.19645816e+00]
Stock Position:  -0.003463540171762967
Bond Position:  [0.05596095]


portfolio before change:  [-0.28987494]
curr_Stock_Price:  99.85444502481703
curr_Factors:  [9.98544450e+01 4.20085367e-02]
mat_Sqrt:  [[ 2.04661512e+01  0.00000000e+00]
 [-8.19839366e-03  1.87848798e-02]]
grads:  [-6.2572582e-03 -7.2413236e+00]
Stock Position:  -0.006257258196536068
Bond Position:  [0.33494011]


portfolio before change:  [-0.28697886]
curr_Stock_Price:  99.4049932931629
curr_Factors:  [9.94049933e+01 4.39854964e-02]
mat_Sqrt:  [[ 2.08479304e+01  0.00000000e+00]
 [-8.38908781e-03  1.92218149e-02]]
grads:  [-0.04496963 38.24106365]
Stock Position:  -0.04496962873635974
Bond Position:  [4.18322679]


portfolio before change:  [-0.2651844]
curr_Stock_Price:  98.94360361236546
curr_Factors:  [9.89436036e+01 4.34707464e-02]
mat_Sqrt:  [[ 2.06293846e+01  0.00000000e+00]
 [-8.33985577e-03  1.91090102e-02]]
grads:  [ 2.58507513e-03 -2.96062112e+00]
Stock Position:  0.002585075127034773
Bond Position:  [-0.52096104]


portfolio before change:  [-0.26496828]
curr_Stock_Price:  99.07759359551277
curr_Factors:  [9.90775936e+01 4.35213091e-02]
mat_Sqrt:  [[ 2.06693312e+01  0.00000000e+00]
 [-8.34470458e-03  1.91201202e-02]]
grads:  [-1.1237415e-03 -4.8761125e+00]
Stock Position:  -0.0011237414983082423
Bond Position:  [-0.15363067]


portfolio before change:  [-0.26248615]
curr_Stock_Price:  96.83460733769819
curr_Factors:  [9.68346073e+01 4.55979705e-02]
mat_Sqrt:  [[ 2.06777534e+01  0.00000000e+00]
 [-8.54147252e-03  1.95709722e-02]]
grads:  [1.16197478e-02 1.55411774e+01]
Stock Position:  0.0116197478135812
Bond Position:  [-1.38767987]


portfolio before change:  [-0.24414718]
curr_Stock_Price:  98.44272644286232
curr_Factors:  [9.84427264e+01 4.66504026e-02]
mat_Sqrt:  [[ 2.12623534e+01  0.00000000e+00]
 [-8.63948171e-03  1.97955394e-02]]
grads:  [ 0.00225829 -0.434006  ]
Stock Position:  0.0022582861583818692
Bond Position:  [-0.46645903]


portfolio before change:  [-0.24785022]
curr_Stock_Price:  96.85461581249724
curr_Factors:  [9.68546158e+01 4.75796000e-02]
mat_Sqrt:  [[ 2.11266538e+01  0.00000000e+00]
 [-8.72509942e-03  1.99917143e-02]]
grads:  [ 0.0065937  -1.53155098]
Stock Position:  0.006593703494232182
Bond Position:  [-0.88648084]


portfolio before change:  [-0.24973401]
curr_Stock_Price:  96.60253463132972
curr_Factors:  [9.66025346e+01 4.56806241e-02]
mat_Sqrt:  [[ 2.06468849e+01  0.00000000e+00]
 [-8.54921040e-03  1.95887019e-02]]
grads:  [-0.00499895 -4.26857946]
Stock Position:  -0.004998949576466569
Bond Position:  [0.23317719]


portfolio before change:  [-0.24723425]
curr_Stock_Price:  96.11413943743439
curr_Factors:  [9.61141394e+01 4.60773652e-02]
mat_Sqrt:  [[ 2.06315141e+01  0.00000000e+00]
 [-8.58625555e-03  1.96735830e-02]]
grads:  [0.00475452 3.57244143]
Stock Position:  0.004754517175766755
Bond Position:  [-0.70421058]


portfolio before change:  [-0.23882159]
curr_Stock_Price:  97.92057661114096
curr_Factors:  [9.79205766e+01 4.63747516e-02]
mat_Sqrt:  [[ 2.10869982e+01  0.00000000e+00]
 [-8.61391912e-03  1.97369682e-02]]
grads:  [-0.00968164 -7.05549415]
Stock Position:  -0.009681637029787695
Bond Position:  [0.70920989]


portfolio before change:  [-0.22198514]
curr_Stock_Price:  96.19988432631986
curr_Factors:  [9.61998843e+01 4.52455210e-02]
mat_Sqrt:  [[ 2.04626722e+01  0.00000000e+00]
 [-8.50839783e-03  1.94951885e-02]]
grads:  [-1.65795986e-02 -1.69928618e+01]
Stock Position:  -0.016579598605521387
Bond Position:  [1.37297032]


portfolio before change:  [-0.24090931]
curr_Stock_Price:  97.36200236592323
curr_Factors:  [9.73620024e+01 4.67483701e-02]
mat_Sqrt:  [[ 2.10510001e+01  0.00000000e+00]
 [-8.64854855e-03  1.98163142e-02]]
grads:  [ 8.20677288e-03 -1.35288832e+01]
Stock Position:  0.008206772879336618
Bond Position:  [-1.03993715]


portfolio before change:  [-0.22482223]
curr_Stock_Price:  99.35390597215209
curr_Factors:  [9.93539060e+01 4.64184233e-02]
mat_Sqrt:  [[ 2.14057347e+01  0.00000000e+00]
 [-8.61797408e-03  1.97462593e-02]]
grads:  [-1.08178964e-03 -5.96253568e+00]
Stock Position:  -0.0010817896436543864
Bond Position:  [-0.1173422]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.22482596]
Stock Price:  99.33024185127006
PL:  [-0.22482596]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.90610718e-02  5.00476459e-02]
 [ 4.44871530e-02  5.89326871e-03]
 [ 6.01795612e-01 -2.47684026e-01]
 [ 1.44375617e-01 -1.15964929e-01]
 [ 1.50141115e-01 -2.61811294e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-2.93278298e-01 -1.56256713e-01]
 [-1.35846474e+00  7.45363654e-01]
 [ 7.94300519e-02 -7.56129691e-02]
 [ 4.97214075e-02  2.49402947e-03]
 [-1.46688464e-01 -6.80086541e-02]
 [ 2.57453155e-02 -8.99267365e-03]
 [ 9.88457147e-02 -1.88478792e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.17138994e-01 -6.23868284e-02]
 [-1.37562410e-01 -1.22847823e-01]
 [-1.61064792e-01 -5.39698600e-01]
 [-1.25974588e-02 -1.70172689e-01]
 [ 9.61254379e-02 -7.33599648e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.36420056]
curr_Stock_Price:  100.5632731968438
curr_Factors:  [1.00563273e+02 4.01589893e-02]
mat_Sqrt:  [[ 2.01525862e+01  0.00000000e+00]
 [-8.01588317e-03  1.83666957e-02]]
grads:  [2.02969757e-03 2.72491290e+00]
Stock Position:  0.0020296975676465834
Bond Position:  [6.16008753]


portfolio before change:  [6.36764701]
curr_Stock_Price:  101.50244790651081
curr_Factors:  [1.01502448e+02 3.89309949e-02]
mat_Sqrt:  [[ 2.00273859e+01  0.00000000e+00]
 [-7.89237555e-03  1.80837042e-02]]
grads:  [0.00234974 0.32588836]
Stock Position:  0.0023497418213441045
Bond Position:  [6.12914247]


portfolio before change:  [6.36277161]
curr_Stock_Price:  98.77539147895678
curr_Factors:  [9.87753915e+01 3.89706670e-02]
mat_Sqrt:  [[ 1.94992398e+01  0.00000000e+00]
 [-7.89639584e-03  1.80929158e-02]]
grads:  [  0.0253188  -13.68955832]
Stock Position:  0.025318804597629908
Bond Position:  [3.86189678]


portfolio before change:  [6.41312852]
curr_Stock_Price:  100.72616748167421
curr_Factors:  [1.00726167e+02 3.81646724e-02]
mat_Sqrt:  [[ 1.96776431e+01  0.00000000e+00]
 [-7.81431225e-03  1.79048387e-02]]
grads:  [ 4.76502051e-03 -6.47673687e+00]
Stock Position:  0.004765020514301862
Bond Position:  [5.93316627]


portfolio before change:  [6.42389087]
curr_Stock_Price:  102.67345580648126
curr_Factors:  [1.02673456e+02 3.62731611e-02]
mat_Sqrt:  [[ 1.95546876e+01  0.00000000e+00]
 [-7.61820568e-03  1.74555021e-02]]
grads:  [ 0.00709368 -1.49987833]
Stock Position:  0.007093681890600794
Bond Position:  [5.69555803]


portfolio before change:  [6.42738692]
curr_Stock_Price:  102.96554430231967
curr_Factors:  [1.02965544e+02 3.42549344e-02]
mat_Sqrt:  [[ 1.90569542e+01  0.00000000e+00]
 [-7.40323544e-03  1.69629434e-02]]
grads:  [-3.04152569e-05 -1.14079117e+00]
Stock Position:  -3.0415256896101176e-05
Bond Position:  [6.43051864]


portfolio before change:  [6.42898084]
curr_Stock_Price:  103.42277670857065
curr_Factors:  [1.03422777e+02 3.46861148e-02]
mat_Sqrt:  [[ 1.92616737e+01  0.00000000e+00]
 [-7.44968346e-03  1.70693692e-02]]
grads:  [-0.01876651 -9.15421718]
Stock Position:  -0.018766506126423995
Bond Position:  [8.36986502]


portfolio before change:  [6.46069297]
curr_Stock_Price:  101.84446464027083
curr_Factors:  [1.01844465e+02 3.34480103e-02]
mat_Sqrt:  [[ 1.86261276e+01  0.00000000e+00]
 [-7.31551888e-03  1.67619595e-02]]
grads:  [-0.05546839 44.46757275]
Stock Position:  -0.05546839349652531
Bond Position:  [12.10984181]


portfolio before change:  [6.5265939]
curr_Stock_Price:  100.71097077133601
curr_Factors:  [1.00710971e+02 3.33853968e-02]
mat_Sqrt:  [[ 1.84015774e+01  0.00000000e+00]
 [-7.30866848e-03  1.67462633e-02]]
grads:  [ 2.52314492e-03 -4.51521441e+00]
Stock Position:  0.0025231449222756935
Bond Position:  [6.27248552]


portfolio before change:  [6.52737452]
curr_Stock_Price:  100.39878226746889
curr_Factors:  [1.00398782e+02 3.34726197e-02]
mat_Sqrt:  [[ 1.83684833e+01  0.00000000e+00]
 [-7.31820958e-03  1.67681247e-02]]
grads:  [0.00276615 0.14873634]
Stock Position:  0.0027661451685387674
Bond Position:  [6.24965691]


portfolio before change:  [6.53211769]
curr_Stock_Price:  101.54859915626139
curr_Factors:  [1.01548599e+02 3.29052261e-02]
mat_Sqrt:  [[ 1.84207105e+01  0.00000000e+00]
 [-7.25591908e-03  1.66253992e-02]]
grads:  [-0.00957454 -4.09064788]
Stock Position:  -0.009574542458051444
Bond Position:  [7.50439906]


portfolio before change:  [6.54774088]
curr_Stock_Price:  100.11282732994479
curr_Factors:  [1.00112827e+02 3.32573737e-02]
mat_Sqrt:  [[ 1.82571802e+01  0.00000000e+00]
 [-7.29464173e-03  1.67141239e-02]]
grads:  [ 0.00119518 -0.53802842]
Stock Position:  0.001195178594362077
Bond Position:  [6.42808817]


portfolio before change:  [6.55114112]
curr_Stock_Price:  101.61303753401153
curr_Factors:  [1.01613038e+02 3.09700953e-02]
mat_Sqrt:  [[ 1.78821900e+01  0.00000000e+00]
 [-7.03932898e-03  1.61291290e-02]]
grads:  [ 0.0050676  -1.16856151]
Stock Position:  0.005067602220367985
Bond Position:  [6.03620667]


portfolio before change:  [6.55423957]
curr_Stock_Price:  101.92663921726589
curr_Factors:  [1.01926639e+02 2.91778207e-02]
mat_Sqrt:  [[ 1.74106157e+01  0.00000000e+00]
 [-6.83260661e-03  1.56554685e-02]]
grads:  [8.74392636e-03 9.49049141e+00]
Stock Position:  0.008743926355000957
Bond Position:  [5.66300054]


portfolio before change:  [6.55518798]
curr_Stock_Price:  101.87317099524395
curr_Factors:  [1.01873171e+02 2.84856109e-02]
mat_Sqrt:  [[ 1.71938286e+01  0.00000000e+00]
 [-6.75107232e-03  1.54686500e-02]]
grads:  [-0.00839643 -4.03311398]
Stock Position:  -0.00839643347645126
Bond Position:  [7.41055928]


portfolio before change:  [6.55125796]
curr_Stock_Price:  102.56190285862158
curr_Factors:  [1.02561903e+02 2.71224252e-02]
mat_Sqrt:  [[ 1.68908043e+01  0.00000000e+00]
 [-6.58755496e-03  1.50939846e-02]]
grads:  [-0.01131844 -8.13885968]
Stock Position:  -0.01131844238297302
Bond Position:  [7.71209894]


portfolio before change:  [6.55303889]
curr_Stock_Price:  102.57492000713633
curr_Factors:  [1.02574920e+02 2.77993631e-02]
mat_Sqrt:  [[ 1.71024611e+01  0.00000000e+00]
 [-6.66925640e-03  1.52811862e-02]]
grads:  [-2.31901462e-02 -3.53178474e+01]
Stock Position:  -0.02319014617392052
Bond Position:  [8.93176628]


portfolio before change:  [6.55316992]
curr_Stock_Price:  102.66557003961704
curr_Factors:  [1.02665570e+02 2.54684351e-02]
mat_Sqrt:  [[ 1.63842269e+01  0.00000000e+00]
 [-6.38353320e-03  1.46265120e-02]]
grads:  [-5.30186196e-03 -1.16345366e+01]
Stock Position:  -0.005301861958362912
Bond Position:  [7.0974886]


portfolio before change:  [6.56379641]
curr_Stock_Price:  100.99598693441087
curr_Factors:  [1.00995987e+02 2.65231734e-02]
mat_Sqrt:  [[ 1.64481425e+01  0.00000000e+00]
 [-6.51437468e-03  1.49263075e-02]]
grads:  [ 3.89761485e-03 -4.91480995e+00]
Stock Position:  0.003897614846140995
Bond Position:  [6.17015296]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.56774676]
Stock Price:  101.61370071399045
PL:  [4.95404604]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.07696795e-02  1.09934285e-01]
 [-3.89349890e-01  2.72783961e-01]
 [ 8.67124616e-01 -3.28663420e-01]
 [ 2.98506837e-01 -8.76955298e-02]
 [ 9.11006881e-02 -2.19427105e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-8.41081085e-02 -1.58167091e-01]
 [-1.31589965e+00  7.40256994e-01]
 [ 4.95578234e-02 -7.49178083e-02]
 [ 8.33415724e-02  1.56607538e-01]
 [-2.66073684e-01 -2.37380192e-02]
 [ 1.63345806e-02 -9.13780556e-03]
 [ 5.46156957e-02 -3.16006328e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15990510e-01 -6.17350020e-02]
 [-9.86544395e-02 -1.06360190e-01]
 [-1.56743044e-01 -5.52968406e-01]
 [ 2.77119514e-01 -2.39724383e-01]
 [ 6.91466388e-02 -1.07237143e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.99839715]
curr_Stock_Price:  100.2069259805341
curr_Factors:  [1.00206926e+02 4.08252607e-02]
mat_Sqrt:  [[ 2.02470718e+01  0.00000000e+00]
 [-8.08210475e-03  1.85184284e-02]]
grads:  [3.88939872e-03 5.93648031e+00]
Stock Position:  0.003889398722698192
Bond Position:  [3.60865246]


portfolio before change:  [4.01370226]
curr_Stock_Price:  103.91002623891266
curr_Factors:  [1.03910026e+02 4.05999398e-02]
mat_Sqrt:  [[ 2.09372746e+01  0.00000000e+00]
 [-8.05977070e-03  1.84672547e-02]]
grads:  [-1.29098564e-02  1.47712243e+01]
Stock Position:  -0.012909856419459876
Bond Position:  [5.35516578]


portfolio before change:  [4.02974455]
curr_Stock_Price:  102.7711032775624
curr_Factors:  [1.02771103e+02 4.27402452e-02]
mat_Sqrt:  [[ 2.12466040e+01  0.00000000e+00]
 [-8.26948561e-03  1.89477719e-02]]
grads:  [  0.03406117 -17.3457556 ]
Stock Position:  0.034061167616312865
Bond Position:  [0.52924077]


portfolio before change:  [4.01889232]
curr_Stock_Price:  102.44860820291728
curr_Factors:  [1.02448608e+02 4.23142709e-02]
mat_Sqrt:  [[ 2.10741222e+01  0.00000000e+00]
 [-8.22817315e-03  1.88531132e-02]]
grads:  [ 0.01234848 -4.65151453]
Stock Position:  0.012348479679520628
Bond Position:  [2.75380776]


portfolio before change:  [4.01362534]
curr_Stock_Price:  101.96632095229992
curr_Factors:  [1.01966321e+02 4.38387453e-02]
mat_Sqrt:  [[ 2.13494066e+01  0.00000000e+00]
 [-8.37508164e-03  1.91897228e-02]]
grads:  [ 0.00381857 -1.14346157]
Stock Position:  0.003818565348349644
Bond Position:  [3.62426028]


portfolio before change:  [4.01821134]
curr_Stock_Price:  102.92998757380063
curr_Factors:  [1.02929988e+02 4.27814091e-02]
mat_Sqrt:  [[ 2.12896961e+01  0.00000000e+00]
 [-8.27346690e-03  1.89568942e-02]]
grads:  [-2.72254781e-05 -1.02079887e+00]
Stock Position:  -2.7225478145278157e-05
Bond Position:  [4.02101366]


portfolio before change:  [4.01928027]
curr_Stock_Price:  100.5959001867059
curr_Factors:  [1.00595900e+02 4.43705026e-02]
mat_Sqrt:  [[ 2.11898292e+01  0.00000000e+00]
 [-8.42572277e-03  1.93057562e-02]]
grads:  [-7.22695237e-03 -8.19274258e+00]
Stock Position:  -0.007226952371692274
Bond Position:  [4.74628205]


portfolio before change:  [4.01788629]
curr_Stock_Price:  100.95299431356335
curr_Factors:  [1.00952994e+02 4.47389234e-02]
mat_Sqrt:  [[ 2.13531509e+01  0.00000000e+00]
 [-8.46063103e-03  1.93857411e-02]]
grads:  [-0.04649548 38.18564333]
Stock Position:  -0.046495480437127555
Bond Position:  [8.71174426]


portfolio before change:  [3.92511185]
curr_Stock_Price:  102.99518523039198
curr_Factors:  [1.02995185e+02 4.33267918e-02]
mat_Sqrt:  [[ 2.14385392e+01  0.00000000e+00]
 [-8.32603549e-03  1.90773439e-02]]
grads:  [ 7.86481351e-04 -3.92705654e+00]
Stock Position:  0.0007864813505856692
Bond Position:  [3.84410805]


portfolio before change:  [3.92463524]
curr_Stock_Price:  101.16710354895194
curr_Factors:  [1.01167104e+02 4.49903996e-02]
mat_Sqrt:  [[ 2.14584941e+01  0.00000000e+00]
 [-8.48437619e-03  1.94401481e-02]]
grads:  [7.06902847e-03 8.05588199e+00]
Stock Position:  0.007069028466451153
Bond Position:  [3.20948211]


portfolio before change:  [3.93955044]
curr_Stock_Price:  103.1635207046306
curr_Factors:  [1.03163521e+02 4.32503599e-02]
mat_Sqrt:  [[ 2.14546295e+01  0.00000000e+00]
 [-8.31868835e-03  1.90605095e-02]]
grads:  [-0.01288458 -1.24540318]
Stock Position:  -0.012884576040070176
Bond Position:  [5.26876867]


portfolio before change:  [3.96300428]
curr_Stock_Price:  101.44545986300754
curr_Factors:  [1.01445460e+02 4.22686256e-02]
mat_Sqrt:  [[ 2.08565119e+01  0.00000000e+00]
 [-8.22373400e-03  1.88429418e-02]]
grads:  [ 0.00059197 -0.4849458 ]
Stock Position:  0.0005919741216053194
Bond Position:  [3.9029512]


portfolio before change:  [3.96464958]
curr_Stock_Price:  102.57631739488022
curr_Factors:  [1.02576317e+02 4.31062053e-02]
mat_Sqrt:  [[ 2.12969298e+01  0.00000000e+00]
 [-8.30481357e-03  1.90287184e-02]]
grads:  [ 0.0019169  -1.66068109]
Stock Position:  0.001916898316332974
Bond Position:  [3.76802121]


portfolio before change:  [3.96688364]
curr_Stock_Price:  103.25029016483477
curr_Factors:  [1.03250290e+02 4.32331504e-02]
mat_Sqrt:  [[ 2.14684022e+01  0.00000000e+00]
 [-8.31703317e-03  1.90567170e-02]]
grads:  [7.09121901e-03 7.79662569e+00]
Stock Position:  0.0070912190106400385
Bond Position:  [3.23471322]


portfolio before change:  [3.97486657]
curr_Stock_Price:  104.26198501384019
curr_Factors:  [1.04261985e+02 4.29451105e-02]
mat_Sqrt:  [[ 2.16064219e+01  0.00000000e+00]
 [-8.28928084e-03  1.89931284e-02]]
grads:  [-0.00661534 -3.25038617]
Stock Position:  -0.0066153421631948185
Bond Position:  [4.66459528]


portfolio before change:  [3.97726903]
curr_Stock_Price:  104.07512118093229
curr_Factors:  [1.04075121e+02 4.33798696e-02]
mat_Sqrt:  [[ 2.16765942e+01  0.00000000e+00]
 [-8.33113386e-03  1.90890258e-02]]
grads:  [-0.00669265 -5.5717977 ]
Stock Position:  -0.0066926488079619316
Bond Position:  [4.67380727]


portfolio before change:  [3.98434723]
curr_Stock_Price:  103.19212310517084
curr_Factors:  [1.03192123e+02 4.18567789e-02]
mat_Sqrt:  [[ 2.11120035e+01  0.00000000e+00]
 [-8.18357172e-03  1.87509184e-02]]
grads:  [-1.88555407e-02 -2.94902038e+01]
Stock Position:  -0.01885554070015209
Bond Position:  [5.93009051]


portfolio before change:  [4.04731882]
curr_Stock_Price:  99.9310717738059
curr_Factors:  [9.99310718e+01 4.23681961e-02]
mat_Sqrt:  [[ 2.05693483e+01  0.00000000e+00]
 [-8.23341446e-03  1.88651225e-02]]
grads:  [ 8.38603214e-03 -1.27072794e+01]
Stock Position:  0.008386032142586586
Bond Position:  [3.20929364]


portfolio before change:  [4.05096437]
curr_Stock_Price:  100.27010229834038
curr_Factors:  [1.00270102e+02 4.38116927e-02]
mat_Sqrt:  [[ 2.09877786e+01  0.00000000e+00]
 [-8.37249713e-03  1.91838009e-02]]
grads:  [ 1.06464401e-03 -5.58998413e+00]
Stock Position:  0.0010646440062652826
Bond Position:  [3.9442124]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.05196551]
Stock Price:  100.28415976017438
PL:  [3.76780575]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.09047197e-01 -3.25200908e-02]
 [ 5.08990503e-02 -4.41763397e-02]
 [ 6.45471022e-01 -2.61013923e-01]
 [-1.28480881e-01 -1.48573627e-01]
 [ 3.97884701e-01 -1.81745039e-02]
 [-6.29493434e-01 -5.48008313e-01]
 [-1.17895894e-01 -8.53150324e-02]
 [-1.33334552e+00  6.16162017e-01]
 [ 2.19219727e-03  5.17161410e-02]
 [ 2.60953279e-02 -3.58054652e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 1.17228969e-01 -1.49786139e-01]
 [ 9.23497038e-02 -4.03500401e-03]
 [-1.08106041e-01 -1.73442897e-01]
 [ 1.59284562e-01  2.43388400e-01]
 [-1.79858883e-02 -9.57344976e-02]
 [-2.01245679e-01 -2.39810965e-01]
 [ 3.63583394e-01 -4.12077445e-01]
 [-2.18861908e-01 -1.81145559e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.75989038]
curr_Stock_Price:  97.38147416204575
curr_Factors:  [9.73814742e+01 4.02745898e-02]
mat_Sqrt:  [[ 1.95430304e+01  0.00000000e+00]
 [-8.02741202e-03  1.83931116e-02]]
grads:  [ 0.00485361 -1.76805814]
Stock Position:  0.004853610919567806
Bond Position:  [-15.23254217]


portfolio before change:  [-14.75526205]
curr_Stock_Price:  99.11975646161854
curr_Factors:  [9.91197565e+01 4.22164669e-02]
mat_Sqrt:  [[ 2.03657857e+01  0.00000000e+00]
 [-8.21865847e-03  1.88313123e-02]]
grads:  [ 1.55255071e-03 -2.34589810e+00]
Stock Position:  0.0015525507116352884
Bond Position:  [-14.9091505]


portfolio before change:  [-14.75909164]
curr_Stock_Price:  99.05415940195081
curr_Factors:  [9.90541594e+01 4.23718102e-02]
mat_Sqrt:  [[ 2.03897183e+01  0.00000000e+00]
 [-8.23376562e-03  1.88659271e-02]]
grads:  [  0.02606977 -13.83520254]
Stock Position:  0.0260697670379495
Bond Position:  [-17.3414105]


portfolio before change:  [-14.78400873]
curr_Stock_Price:  98.26469329925743
curr_Factors:  [9.82646933e+01 4.35489900e-02]
mat_Sqrt:  [[ 2.05062641e+01  0.00000000e+00]
 [-8.34735791e-03  1.91261997e-02]]
grads:  [-0.00942754 -7.76806834]
Stock Position:  -0.009427544992113823
Bond Position:  [-13.85761392]


portfolio before change:  [-14.75342847]
curr_Stock_Price:  94.65345588465165
curr_Factors:  [9.46534559e+01 4.52565535e-02]
mat_Sqrt:  [[ 2.01361860e+01  0.00000000e+00]
 [-8.50943509e-03  1.94975652e-02]]
grads:  [ 0.01936577 -0.93214223]
Stock Position:  0.01936576755616667
Bond Position:  [-16.58646529]


portfolio before change:  [-14.78980792]
curr_Stock_Price:  92.98905940782646
curr_Factors:  [9.29890594e+01 4.53735520e-02]
mat_Sqrt:  [[ 1.98076632e+01  0.00000000e+00]
 [-8.52042740e-03  1.95227518e-02]]
grads:  [ -0.04385494 -28.07023927]
Stock Position:  -0.04385493934557872
Bond Position:  [-10.71177836]


portfolio before change:  [-14.80315976]
curr_Stock_Price:  93.23244281208348
curr_Factors:  [9.32324428e+01 4.61528580e-02]
mat_Sqrt:  [[ 2.00293273e+01  0.00000000e+00]
 [-8.59328649e-03  1.96896929e-02]]
grads:  [-0.00774516 -4.33297933]
Stock Position:  -0.0077451641029630605
Bond Position:  [-14.08105919]


portfolio before change:  [-14.81675977]
curr_Stock_Price:  94.53381050518001
curr_Factors:  [9.45338105e+01 4.50519990e-02]
mat_Sqrt:  [[ 2.00652325e+01  0.00000000e+00]
 [-8.49018247e-03  1.94534519e-02]]
grads:  [-0.05304849 31.67365976]
Stock Position:  -0.05304849415772092
Bond Position:  [-9.80188348]


portfolio before change:  [-14.72947469]
curr_Stock_Price:  92.84222874778199
curr_Factors:  [9.28422287e+01 4.60662249e-02]
mat_Sqrt:  [[ 1.99267682e+01  0.00000000e+00]
 [-8.58521752e-03  1.96712046e-02]]
grads:  [1.24269883e-03 2.62902766e+00]
Stock Position:  0.0012426988328429278
Bond Position:  [-14.84484961]


portfolio before change:  [-14.73399265]
curr_Stock_Price:  92.1934110335853
curr_Factors:  [9.21934110e+01 4.43391271e-02]
mat_Sqrt:  [[ 1.94130357e+01  0.00000000e+00]
 [-8.42274322e-03  1.92989292e-02]]
grads:  [ 5.39253210e-04 -1.85530839e+00]
Stock Position:  0.0005392532102117062
Bond Position:  [-14.78370824]


portfolio before change:  [-14.73715758]
curr_Stock_Price:  93.17895421421757
curr_Factors:  [9.31789542e+01 4.41114462e-02]
mat_Sqrt:  [[ 1.95701196e+01  0.00000000e+00]
 [-8.40109005e-03  1.92493155e-02]]
grads:  [1.37916582e-02 1.81600638e+01]
Stock Position:  0.013791658219672478
Bond Position:  [-16.02224987]


portfolio before change:  [-14.74743114]
curr_Stock_Price:  92.72451330258981
curr_Factors:  [9.27245133e+01 4.48919726e-02]
mat_Sqrt:  [[ 1.96462157e+01  0.00000000e+00]
 [-8.47509033e-03  1.94188715e-02]]
grads:  [ 2.63953828e-03 -7.71343172e+00]
Stock Position:  0.002639538276964503
Bond Position:  [-14.99218104]


portfolio before change:  [-14.74882057]
curr_Stock_Price:  93.61826035053019
curr_Factors:  [9.36182604e+01 4.39742622e-02]
mat_Sqrt:  [[ 1.96317876e+01  0.00000000e+00]
 [-8.38801642e-03  1.92193601e-02]]
grads:  [ 0.00461439 -0.20994476]
Stock Position:  0.004614387917171989
Bond Position:  [-15.18081154]


portfolio before change:  [-14.75919911]
curr_Stock_Price:  92.19166431289689
curr_Factors:  [9.21916643e+01 4.78191301e-02]
mat_Sqrt:  [[ 2.01600911e+01  0.00000000e+00]
 [-8.74703425e-03  2.00419733e-02]]
grads:  [-0.00911716 -8.65398306]
Stock Position:  -0.009117157577217708
Bond Position:  [-13.91867318]


portfolio before change:  [-14.75777759]
curr_Stock_Price:  91.65403700406817
curr_Factors:  [9.16540370e+01 5.01123914e-02]
mat_Sqrt:  [[ 2.05174868e+01  0.00000000e+00]
 [-8.95431886e-03  2.05169220e-02]]
grads:  [ 0.01294057 11.8628126 ]
Stock Position:  0.012940569725120924
Bond Position:  [-15.94383304]


portfolio before change:  [-14.75790389]
curr_Stock_Price:  91.9523351313453
curr_Factors:  [9.19523351e+01 4.88198816e-02]
mat_Sqrt:  [[ 2.03170722e+01  0.00000000e+00]
 [-8.83808862e-03  2.02506051e-02]]
grads:  [-2.94175499e-03 -4.72748825e+00]
Stock Position:  -0.0029417549909812614
Bond Position:  [-14.48740265]


portfolio before change:  [-14.762501]
curr_Stock_Price:  92.28370183470408
curr_Factors:  [9.22837018e+01 4.90663831e-02]
mat_Sqrt:  [[ 2.04417009e+01  0.00000000e+00]
 [-8.86037318e-03  2.03016654e-02]]
grads:  [ -0.01496489 -11.81237896]
Stock Position:  -0.014964887986023658
Bond Position:  [-13.38148574]


portfolio before change:  [-14.77558903]
curr_Stock_Price:  92.93470847750987
curr_Factors:  [9.29347085e+01 4.69922722e-02]
mat_Sqrt:  [[ 2.01461083e+01  0.00000000e+00]
 [-8.67108042e-03  1.98679412e-02]]
grads:  [ 9.12027523e-03 -2.07408227e+01]
Stock Position:  0.00912027522701708
Bond Position:  [-15.62317915]


portfolio before change:  [-14.77150635]
curr_Stock_Price:  93.8106646062448
curr_Factors:  [9.38106646e+01 4.48314397e-02]
mat_Sqrt:  [[ 1.98629411e+01  0.00000000e+00]
 [-8.46937445e-03  1.94057747e-02]]
grads:  [-0.0149988  -9.33462135]
Stock Position:  -0.01499880152128715
Bond Position:  [-13.36445881]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.77875579]
Stock Price:  94.07121237425544
PL:  [-14.77875579]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 8.63512996e-02  6.63053324e-03]
 [ 4.74140401e-02 -4.94133120e-02]
 [ 5.84073110e-01 -2.42275053e-01]
 [-1.13856485e-01 -1.27528891e-01]
 [ 3.72641921e-01 -1.60517237e-02]
 [-9.32483448e-03 -1.34164620e-01]
 [-1.88415149e-02 -6.44206420e-02]
 [-1.28355700e+00  6.84084790e-01]
 [ 7.15373304e-02 -4.73308587e-02]
 [ 1.52993809e-02 -8.78322642e-02]
 [ 5.75127736e-02  2.74648365e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.31602107e-01 -3.45783857e-02]
 [-6.17655644e-02 -7.24541836e-02]
 [ 3.10405370e-02  1.28518025e-02]
 [-1.41913097e-01 -1.32661517e-01]
 [-1.92688973e-01 -3.59013422e-01]
 [ 2.84466233e-01 -2.52722881e-01]
 [ 8.38077684e-02 -9.93533121e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.93205701]
curr_Stock_Price:  97.80741426588021
curr_Factors:  [9.78074143e+01 4.22095831e-02]
mat_Sqrt:  [[ 2.00945048e+01  0.00000000e+00]
 [-8.21798838e-03  1.88297769e-02]]
grads:  [0.00444127 0.35213021]
Stock Position:  0.004441269004502784
Bond Position:  [-12.36644605]


portfolio before change:  [-11.93116769]
curr_Stock_Price:  98.70385094331967
curr_Factors:  [9.87038509e+01 4.29990532e-02]
mat_Sqrt:  [[ 2.04674408e+01  0.00000000e+00]
 [-8.29448522e-03  1.90050532e-02]]
grads:  [ 1.26289862e-03 -2.60000914e+00]
Stock Position:  0.0012628986174732968
Bond Position:  [-12.05582065]


portfolio before change:  [-11.93492241]
curr_Stock_Price:  98.11759323999348
curr_Factors:  [9.81175932e+01 4.21458825e-02]
mat_Sqrt:  [[ 2.01430144e+01  0.00000000e+00]
 [-8.21178495e-03  1.88155631e-02]]
grads:  [  0.02374697 -12.8763116 ]
Stock Position:  0.02374697246925722
Bond Position:  [-14.26491819]


portfolio before change:  [-11.95422476]
curr_Stock_Price:  97.45495403458396
curr_Factors:  [9.74549540e+01 4.05725708e-02]
mat_Sqrt:  [[ 1.96299948e+01  0.00000000e+00]
 [-8.05705364e-03  1.84610291e-02]]
grads:  [-0.00863549 -6.90800552]
Stock Position:  -0.008635491635863876
Bond Position:  [-11.11265332]


portfolio before change:  [-11.93776548]
curr_Stock_Price:  95.22719574505385
curr_Factors:  [9.52271957e+01 4.14560061e-02]
mat_Sqrt:  [[ 1.93889694e+01  0.00000000e+00]
 [-8.14429922e-03  1.86609338e-02]]
grads:  [ 0.01885796 -0.86017794]
Stock Position:  0.018857958184309707
Bond Position:  [-13.73355596]


portfolio before change:  [-11.89558084]
curr_Stock_Price:  97.64625182890707
curr_Factors:  [9.76462518e+01 3.97084117e-02]
mat_Sqrt:  [[ 1.94579389e+01  0.00000000e+00]
 [-7.97078784e-03  1.82633693e-02]]
grads:  [-3.48850284e-03 -7.34610453e+00]
Stock Position:  -0.003488502839943968
Bond Position:  [-11.55494161]


portfolio before change:  [-11.89776819]
curr_Stock_Price:  97.44509097168681
curr_Factors:  [9.74450910e+01 4.01366137e-02]
mat_Sqrt:  [[ 1.95222707e+01  0.00000000e+00]
 [-8.01364972e-03  1.83615782e-02]]
grads:  [-2.40530361e-03 -3.50844798e+00]
Stock Position:  -0.002405303610262856
Bond Position:  [-11.66338316]


portfolio before change:  [-11.89970886]
curr_Stock_Price:  97.03951220165857
curr_Factors:  [9.70395122e+01 4.00647704e-02]
mat_Sqrt:  [[ 1.94236093e+01  0.00000000e+00]
 [-8.00647442e-03  1.83451375e-02]]
grads:  [-0.05071137 37.28970629]
Stock Position:  -0.05071137404773155
Bond Position:  [-6.97870186]


portfolio before change:  [-11.97162648]
curr_Stock_Price:  98.42327934590334
curr_Factors:  [9.84232793e+01 4.04818689e-02]
mat_Sqrt:  [[ 1.98028687e+01  0.00000000e+00]
 [-8.04804263e-03  1.84403823e-02]]
grads:  [ 0.00256935 -2.56669618]
Stock Position:  0.002569347446270872
Bond Position:  [-12.22451009]


portfolio before change:  [-11.97684557]
curr_Stock_Price:  97.58159707049616
curr_Factors:  [9.75815971e+01 4.19159450e-02]
mat_Sqrt:  [[ 1.99782550e+01  0.00000000e+00]
 [-8.18935358e-03  1.87641663e-02]]
grads:  [-1.15294163e-03 -4.68085087e+00]
Stock Position:  -0.0011529416309719147
Bond Position:  [-11.86433968]


portfolio before change:  [-11.97997656]
curr_Stock_Price:  97.72430791142705
curr_Factors:  [9.77243079e+01 3.90006929e-02]
mat_Sqrt:  [[ 1.92991759e+01  0.00000000e+00]
 [-7.89943723e-03  1.80998845e-02]]
grads:  [9.19102183e-03 1.51740396e+01]
Stock Position:  0.00919102183066978
Bond Position:  [-12.87816281]


portfolio before change:  [-11.98989844]
curr_Stock_Price:  96.9951252018926
curr_Factors:  [9.69951252e+01 3.80364531e-02]
mat_Sqrt:  [[ 1.89168977e+01  0.00000000e+00]
 [-7.80117459e-03  1.78747365e-02]]
grads:  [ 0.00253829 -0.48064389]
Stock Position:  0.0025382850376053
Bond Position:  [-12.23609971]


portfolio before change:  [-11.99610998]
curr_Stock_Price:  95.75328979882386
curr_Factors:  [9.57532898e+01 4.04210092e-02]
mat_Sqrt:  [[ 1.92511767e+01  0.00000000e+00]
 [-8.04199072e-03  1.84265156e-02]]
grads:  [ 0.00605214 -1.87655585]
Stock Position:  0.006052142348651182
Bond Position:  [-12.57562252]


portfolio before change:  [-11.99079498]
curr_Stock_Price:  97.151025606754
curr_Factors:  [9.71510256e+01 3.94446640e-02]
mat_Sqrt:  [[ 1.92948551e+01  0.00000000e+00]
 [-7.94427230e-03  1.82026146e-02]]
grads:  [-0.00484    -3.98042728]
Stock Position:  -0.004840003322715548
Bond Position:  [-11.52058369]


portfolio before change:  [-11.99614401]
curr_Stock_Price:  97.66105054303436
curr_Factors:  [9.76610505e+01 3.76770896e-02]
mat_Sqrt:  [[ 1.89565834e+01  0.00000000e+00]
 [-7.76423489e-03  1.77900970e-02]]
grads:  [0.00193334 0.72241329]
Stock Position:  0.0019333401318680549
Bond Position:  [-12.18495604]


portfolio before change:  [-11.99573303]
curr_Stock_Price:  99.44945786936172
curr_Factors:  [9.94494579e+01 3.62894212e-02]
mat_Sqrt:  [[ 1.89449054e+01  0.00000000e+00]
 [-7.61991299e-03  1.74594140e-02]]
grads:  [-0.01054697 -7.59828002]
Stock Position:  -0.010546968981192086
Bond Position:  [-10.94684268]


portfolio before change:  [-11.97604195]
curr_Stock_Price:  97.32295809632875
curr_Factors:  [9.73229581e+01 3.76631451e-02]
mat_Sqrt:  [[ 1.88874615e+01  0.00000000e+00]
 [-7.76279796e-03  1.77868046e-02]]
grads:  [-1.84977359e-02 -2.01842562e+01]
Stock Position:  -0.01849773594081999
Bond Position:  [-10.17578757]


portfolio before change:  [-12.00661214]
curr_Stock_Price:  98.83805833386856
curr_Factors:  [9.88380583e+01 3.66645880e-02]
mat_Sqrt:  [[ 1.89255108e+01  0.00000000e+00]
 [-7.65919975e-03  1.75494313e-02]]
grads:  [ 9.20286526e-03 -1.44006308e+01]
Stock Position:  0.009202865256638403
Bond Position:  [-12.91620548]


portfolio before change:  [-11.99349102]
curr_Stock_Price:  100.61474194151869
curr_Factors:  [1.00614742e+02 3.68218385e-02]
mat_Sqrt:  [[ 1.93069802e+01  0.00000000e+00]
 [-7.67560692e-03  1.75870249e-02]]
grads:  [ 2.09491218e-03 -5.64923930e+00]
Stock Position:  0.002094912181901506
Bond Position:  [-12.20427007]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.99515027]
Stock Price:  101.2793054036286
PL:  [-13.27445567]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.41693431e-02  8.46877733e-02]
 [ 4.02202563e-02 -6.02235086e-02]
 [ 5.45258683e-01 -2.30428746e-01]
 [-1.15569262e-01 -1.29857876e-01]
 [ 2.54215672e-01 -7.61677950e-03]
 [-7.07232833e-03 -1.32450348e-01]
 [-3.88348600e-02 -5.47558398e-02]
 [-1.31735158e+00  6.31841031e-01]
 [ 2.16364390e-02  2.39250362e-02]
 [ 2.00104957e-02 -6.51289086e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 1.19175609e-01 -1.54000455e-01]
 [ 8.05837320e-02  1.16979295e-02]
 [-9.58174763e-02 -1.46743434e-01]
 [ 1.42129041e-01  2.11237262e-01]
 [-6.77895097e-02 -1.12651075e-01]
 [-1.98255249e-01 -2.81435466e-01]
 [ 3.08651120e-01 -3.72625313e-01]
 [-2.30214672e-01 -1.84057529e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.02161939]
curr_Stock_Price:  100.36104799864307
curr_Factors:  [1.00361048e+02 3.91243045e-02]
mat_Sqrt:  [[ 1.98512794e+01  0.00000000e+00]
 [-7.91194585e-03  1.81285454e-02]]
grads:  [3.07940442e-03 4.67151509e+00]
Stock Position:  0.0030794044170153363
Bond Position:  [4.71256713]


portfolio before change:  [5.01512461]
curr_Stock_Price:  97.86931080838865
curr_Factors:  [9.78693108e+01 4.17112584e-02]
mat_Sqrt:  [[ 1.99881765e+01  0.00000000e+00]
 [-8.16933372e-03  1.87182951e-02]]
grads:  [ 6.97240306e-04 -3.21736079e+00]
Stock Position:  0.0006972403061374833
Bond Position:  [4.94688618]


portfolio before change:  [5.01606806]
curr_Stock_Price:  97.44846754767494
curr_Factors:  [9.74484675e+01 4.26474385e-02]
mat_Sqrt:  [[ 2.01243328e+01  0.00000000e+00]
 [-8.26050251e-03  1.89271890e-02]]
grads:  [  0.0220972  -12.17448328]
Stock Position:  0.022097196379435736
Bond Position:  [2.86273013]


portfolio before change:  [5.01915353]
curr_Stock_Price:  97.55570739312317
curr_Factors:  [9.75557074e+01 4.31230917e-02]
mat_Sqrt:  [[ 2.02585159e+01  0.00000000e+00]
 [-8.30644007e-03  1.90324452e-02]]
grads:  [-0.0085023  -6.82297384]
Stock Position:  -0.008502295303949003
Bond Position:  [5.84860096]


portfolio before change:  [5.01406357]
curr_Stock_Price:  98.32635674696824
curr_Factors:  [9.83263567e+01 4.19572491e-02]
mat_Sqrt:  [[ 2.01406485e+01  0.00000000e+00]
 [-8.19338749e-03  1.87734092e-02]]
grads:  [ 0.01245697 -0.4057217 ]
Stock Position:  0.012456969146997662
Bond Position:  [3.78921518]


portfolio before change:  [5.0070568]
curr_Stock_Price:  97.68782303299002
curr_Factors:  [9.76878230e+01 4.21723627e-02]
mat_Sqrt:  [[ 2.00610841e+01  0.00000000e+00]
 [-8.21436426e-03  1.88214730e-02]]
grads:  [-3.23404254e-03 -7.03719352e+00]
Stock Position:  -0.0032340425416085244
Bond Position:  [5.32298338]


portfolio before change:  [5.01420642]
curr_Stock_Price:  95.88861735998957
curr_Factors:  [9.58886174e+01 4.22987090e-02]
mat_Sqrt:  [[ 1.97210763e+01  0.00000000e+00]
 [-8.22665998e-03  1.88496460e-02]]
grads:  [-0.00318098 -2.90487364]
Stock Position:  -0.0031809758672957838
Bond Position:  [5.3192258]


portfolio before change:  [5.01850113]
curr_Stock_Price:  94.95659711029018
curr_Factors:  [9.49565971e+01 4.22552857e-02]
mat_Sqrt:  [[ 1.95193640e+01  0.00000000e+00]
 [-8.22243620e-03  1.88399681e-02]]
grads:  [-0.05336206 33.53726642]
Stock Position:  -0.05336206367260142
Bond Position:  [10.08558111]


portfolio before change:  [5.05025228]
curr_Stock_Price:  94.40884019505079
curr_Factors:  [9.44088402e+01 4.02120292e-02]
mat_Sqrt:  [[ 1.89317455e+01  0.00000000e+00]
 [-8.02117490e-03  1.83788206e-02]]
grads:  [0.00169441 1.30177212]
Stock Position:  0.0016944122192657815
Bond Position:  [4.89028478]


portfolio before change:  [5.05290456]
curr_Stock_Price:  95.25253313532286
curr_Factors:  [9.52525331e+01 3.98922706e-02]
mat_Sqrt:  [[ 1.90248356e+01  0.00000000e+00]
 [-7.98921979e-03  1.83056022e-02]]
grads:  [-4.42268753e-04 -3.55786757e+00]
Stock Position:  -0.0004422687529537287
Bond Position:  [5.09503178]


portfolio before change:  [5.05434586]
curr_Stock_Price:  94.87407265035628
curr_Factors:  [9.48740727e+01 3.75554833e-02]
mat_Sqrt:  [[ 1.83858715e+01  0.00000000e+00]
 [-7.75169486e-03  1.77613642e-02]]
grads:  [1.46799895e-02 1.96814160e+01]
Stock Position:  0.014679989499352439
Bond Position:  [3.66159547]


portfolio before change:  [5.02223758]
curr_Stock_Price:  92.62449371295683
curr_Factors:  [9.26244937e+01 3.75491569e-02]
mat_Sqrt:  [[ 1.79484084e+01  0.00000000e+00]
 [-7.75104193e-03  1.77598682e-02]]
grads:  [ 2.89520383e-03 -8.67126113e+00]
Stock Position:  0.002895203829308746
Bond Position:  [4.75407079]


portfolio before change:  [5.02476105]
curr_Stock_Price:  93.08553230569629
curr_Factors:  [9.30855323e+01 3.78258136e-02]
mat_Sqrt:  [[ 1.81040744e+01  0.00000000e+00]
 [-7.77954380e-03  1.78251742e-02]]
grads:  [0.00473314 0.65625892]
Stock Position:  0.00473314045776293
Bond Position:  [4.58417415]


portfolio before change:  [5.02782679]
curr_Stock_Price:  93.49108933603515
curr_Factors:  [9.34910893e+01 3.45773552e-02]
mat_Sqrt:  [[ 1.73846562e+01  0.00000000e+00]
 [-7.43799491e-03  1.70425874e-02]]
grads:  [-0.00919555 -8.61039645]
Stock Position:  -0.009195554956706965
Bond Position:  [5.88752924]


portfolio before change:  [5.03863222]
curr_Stock_Price:  92.47610299537021
curr_Factors:  [9.24761030e+01 3.39187645e-02]
mat_Sqrt:  [[ 1.70313680e+01  0.00000000e+00]
 [-7.36681907e-03  1.68795030e-02]]
grads:  [ 0.01375817 12.51442425]
Stock Position:  0.0137581749490675
Bond Position:  [3.76632982]


portfolio before change:  [5.05371783]
curr_Stock_Price:  93.50413950873181
curr_Factors:  [9.35041395e+01 3.40876311e-02]
mat_Sqrt:  [[ 1.72635159e+01  0.00000000e+00]
 [-7.38513438e-03  1.69214686e-02]]
grads:  [-0.00677466 -6.65728711]
Stock Position:  -0.006774661106843307
Bond Position:  [5.68717669]


portfolio before change:  [5.0522956]
curr_Stock_Price:  93.92396875990005
curr_Factors:  [9.39239688e+01 3.31683223e-02]
mat_Sqrt:  [[ 1.71055951e+01  0.00000000e+00]
 [-7.28486895e-03  1.66917317e-02]]
grads:  [ -0.01877069 -16.86077099]
Stock Position:  -0.01877068610588316
Bond Position:  [6.81531293]


portfolio before change:  [5.05091624]
curr_Stock_Price:  94.0882357691268
curr_Factors:  [9.40882358e+01 3.21143721e-02]
mat_Sqrt:  [[ 1.68610665e+01  0.00000000e+00]
 [-7.16819331e-03  1.64243942e-02]]
grads:  [ 8.66043084e-03 -2.26873094e+01]
Stock Position:  0.00866043083963554
Bond Position:  [4.23607158]


portfolio before change:  [5.04729809]
curr_Stock_Price:  93.54815962917064
curr_Factors:  [9.35481596e+01 3.20459320e-02]
mat_Sqrt:  [[ 1.67464093e+01  0.00000000e+00]
 [-7.16055104e-03  1.64068836e-02]]
grads:  [ -0.01854391 -11.2183114 ]
Stock Position:  -0.01854391335758711
Bond Position:  [6.78204706]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.05612578]
Stock Price:  93.16356127467945
PL:  [5.05612578]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 4.45405166e-02  8.15395200e-02]
 [ 4.97812536e-02 -4.58560680e-02]
 [ 5.45999127e-01 -2.30654732e-01]
 [ 4.29631211e-02 -1.05796306e-01]
 [ 4.86850810e-02 -1.14716832e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-1.55411110e-01 -1.91065726e-01]
 [-1.32715655e+00  7.41882914e-01]
 [ 5.56088351e-02 -7.64871935e-02]
 [ 1.24858494e-01  3.44932077e-01]
 [-1.98172757e-01 -2.63044209e-02]
 [ 1.45496565e-03 -9.36727829e-03]
 [ 5.65304123e-02 -3.10252970e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15225062e-01 -6.13005692e-02]
 [-6.84133656e-02 -9.35452391e-02]
 [-1.48544111e-01 -5.78079348e-01]
 [-1.66763367e-01 -9.04000944e-02]
 [ 1.29689805e-01  4.17808724e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.72323589]
curr_Stock_Price:  98.5919887149852
curr_Factors:  [9.85919887e+01 3.93855806e-02]
mat_Sqrt:  [[ 1.95663696e+01  0.00000000e+00]
 [-7.93832029e-03  1.81889768e-02]]
grads:  [4.09515317e-03 4.48290857e+00]
Stock Position:  0.004095153173827074
Bond Position:  [-7.12698519]


portfolio before change:  [-6.72324499]
curr_Stock_Price:  99.02490673736177
curr_Factors:  [9.90249067e+01 3.77993995e-02]
mat_Sqrt:  [[ 1.92524894e+01  0.00000000e+00]
 [-7.77682706e-03  1.78189493e-02]]
grads:  [ 1.54619095e-03 -2.57344399e+00]
Stock Position:  0.0015461909494414179
Bond Position:  [-6.87635641]


portfolio before change:  [-6.72661047]
curr_Stock_Price:  97.96024191439881
curr_Factors:  [9.79602419e+01 3.84645047e-02]
mat_Sqrt:  [[ 1.92123249e+01  0.00000000e+00]
 [-7.84494790e-03  1.79750338e-02]]
grads:  [  0.02317956 -12.83194986]
Stock Position:  0.02317955541283733
Bond Position:  [-8.99728533]


portfolio before change:  [-6.68161436]
curr_Stock_Price:  99.99849130565678
curr_Factors:  [9.99984913e+01 3.69366547e-02]
mat_Sqrt:  [[ 1.92186212e+01  0.00000000e+00]
 [-7.68756447e-03  1.76144230e-02]]
grads:  [-1.67034480e-04 -6.00623172e+00]
Stock Position:  -0.00016703447996553513
Bond Position:  [-6.66491117]


portfolio before change:  [-6.68333481]
curr_Stock_Price:  100.3218546831528
curr_Factors:  [1.00321855e+02 3.78374044e-02]
mat_Sqrt:  [[ 1.95144458e+01  0.00000000e+00]
 [-7.78073564e-03  1.78279050e-02]]
grads:  [ 0.00223826 -0.64346782]
Stock Position:  0.0022382612602005235
Bond Position:  [-6.90788133]


portfolio before change:  [-6.68083146]
curr_Stock_Price:  102.2119535836275
curr_Factors:  [1.02211954e+02 3.75431946e-02]
mat_Sqrt:  [[ 1.98046559e+01  0.00000000e+00]
 [-7.75042653e-03  1.77584581e-02]]
grads:  [-2.92669642e-05 -1.08968785e+00]
Stock Position:  -2.926696424926752e-05
Bond Position:  [-6.67784003]


portfolio before change:  [-6.68249814]
curr_Stock_Price:  102.10981212844824
curr_Factors:  [1.02109812e+02 3.84121116e-02]
mat_Sqrt:  [[ 2.00125103e+01  0.00000000e+00]
 [-7.83960322e-03  1.79627876e-02]]
grads:  [ -0.01193249 -10.63675254]
Stock Position:  -0.01193248752013066
Bond Position:  [-5.46407408]


portfolio before change:  [-6.67221689]
curr_Stock_Price:  101.13370057722386
curr_Factors:  [1.01133701e+02 3.91756602e-02]
mat_Sqrt:  [[ 2.00172338e+01  0.00000000e+00]
 [-7.91713687e-03  1.81404395e-02]]
grads:  [-0.05012542 40.89663394]
Stock Position:  -0.05012542273551565
Bond Position:  [-1.6028474]


portfolio before change:  [-6.74338536]
curr_Stock_Price:  102.5455132642357
curr_Factors:  [1.02545513e+02 4.09468954e-02]
mat_Sqrt:  [[ 2.07504325e+01  0.00000000e+00]
 [-8.09413569e-03  1.85459947e-02]]
grads:  [ 1.07116260e-03 -4.12418932e+00]
Stock Position:  0.0010711625960024658
Bond Position:  [-6.85322828]


portfolio before change:  [-6.74420939]
curr_Stock_Price:  103.37591416434395
curr_Factors:  [1.03375914e+02 4.05483227e-02]
mat_Sqrt:  [[ 2.08164089e+01  0.00000000e+00]
 [-8.05464564e-03  1.84555117e-02]]
grads:  [1.32299089e-02 1.86899222e+01]
Stock Position:  0.013229908945285862
Bond Position:  [-8.11186332]


portfolio before change:  [-6.76048582]
curr_Stock_Price:  102.29894432089382
curr_Factors:  [1.02298944e+02 3.98025593e-02]
mat_Sqrt:  [[ 2.04092315e+01  0.00000000e+00]
 [-7.98023150e-03  1.82850075e-02]]
grads:  [-0.01027246 -1.43857862]
Stock Position:  -0.010272456759763633
Bond Position:  [-5.70962434]


portfolio before change:  [-6.76811247]
curr_Stock_Price:  102.90240913871004
curr_Factors:  [1.02902409e+02 4.13819841e-02]
mat_Sqrt:  [[ 2.09329867e+01  0.00000000e+00]
 [-8.13702492e-03  1.86442663e-02]]
grads:  [-1.25794269e-04 -5.02421395e-01]
Stock Position:  -0.00012579426921082045
Bond Position:  [-6.75516794]


portfolio before change:  [-6.76975495]
curr_Stock_Price:  102.53259589271124
curr_Factors:  [1.02532596e+02 4.14864107e-02]
mat_Sqrt:  [[ 2.08840577e+01  0.00000000e+00]
 [-8.14728526e-03  1.86677757e-02]]
grads:  [ 0.0020585  -1.66197074]
Stock Position:  0.0020585014299188474
Bond Position:  [-6.98081845]


portfolio before change:  [-6.76638029]
curr_Stock_Price:  105.01988608672184
curr_Factors:  [1.05019886e+02 3.99918791e-02]
mat_Sqrt:  [[ 2.10018450e+01  0.00000000e+00]
 [-7.99918787e-03  1.83284420e-02]]
grads:  [7.24875086e-03 8.10642223e+00]
Stock Position:  0.007248750856990779
Bond Position:  [-7.52764328]


portfolio before change:  [-6.7608482]
curr_Stock_Price:  106.04271530308964
curr_Factors:  [1.06042715e+02 3.89896218e-02]
mat_Sqrt:  [[ 2.09389718e+01  0.00000000e+00]
 [-7.89831596e-03  1.80973154e-02]]
grads:  [-0.0067806  -3.38727419]
Stock Position:  -0.006780601502269811
Bond Position:  [-6.0418148]


portfolio before change:  [-6.75694843]
curr_Stock_Price:  105.24478994601517
curr_Factors:  [1.0524479e+02 3.9523792e-02]
mat_Sqrt:  [[ 2.09232868e+01  0.00000000e+00]
 [-7.95223662e-03  1.82208631e-02]]
grads:  [-0.00522097 -5.13396311]
Stock Position:  -0.005220970108862859
Bond Position:  [-6.20746852]


portfolio before change:  [-6.75380918]
curr_Stock_Price:  104.3462383275108
curr_Factors:  [1.04346238e+02 4.06654248e-02]
mat_Sqrt:  [[ 2.10421181e+01  0.00000000e+00]
 [-8.06626802e-03  1.84821419e-02]]
grads:  [-1.90493476e-02 -3.12777248e+01]
Stock Position:  -0.019049347597639966
Bond Position:  [-4.76608141]


portfolio before change:  [-6.75062073]
curr_Stock_Price:  104.11630315146769
curr_Factors:  [1.04116303e+02 4.08050302e-02]
mat_Sqrt:  [[ 2.10317587e+01  0.00000000e+00]
 [-8.08010200e-03  1.85138395e-02]]
grads:  [-0.00980504 -4.88283882]
Stock Position:  -0.009805038426989392
Bond Position:  [-5.72975638]


portfolio before change:  [-6.73619787]
curr_Stock_Price:  102.49922852119454
curr_Factors:  [1.02499229e+02 3.81441456e-02]
mat_Sqrt:  [[ 2.00186388e+01  0.00000000e+00]
 [-7.81221051e-03  1.79000230e-02]]
grads:  [0.00738934 2.33412395]
Stock Position:  0.007389337246451623
Bond Position:  [-7.49359924]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.7417055]
Stock Price:  102.00743883842551
PL:  [-8.74914434]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.17391313e-02  7.07060715e-02]
 [ 6.61000729e-02 -2.13335565e-02]
 [ 7.17274988e-01 -2.82928759e-01]
 [-4.43264901e-02 -9.74422279e-02]
 [ 3.01141999e-01 -1.06958432e-02]
 [-5.17576853e-01 -4.76749807e-01]
 [-5.10366172e-02 -7.89514050e-02]
 [-1.87666076e+00  4.73988445e-01]
 [-7.78757344e-02  1.10818276e-01]
 [ 3.28556469e-02  2.39519882e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 1.40980444e-01 -2.02337459e-01]
 [ 7.16118122e-02  2.25974654e-02]
 [-9.66521217e-02 -1.48574787e-01]
 [ 1.05073721e-01  1.41288612e-01]
 [-7.66961489e-02 -1.15748813e-01]
 [-1.96496986e-01 -3.05961087e-01]
 [ 3.71649708e-01 -4.18108596e-01]
 [-1.63879786e-01 -1.67035661e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.56908963]
curr_Stock_Price:  100.44351025961696
curr_Factors:  [1.00443510e+02 3.81852287e-02]
mat_Sqrt:  [[ 1.96277076e+01  0.00000000e+00]
 [-7.81641643e-03  1.79096600e-02]]
grads:  [2.67977249e-03 3.94792930e+00]
Stock Position:  0.002679772486596856
Bond Position:  [5.29992388]


portfolio before change:  [5.56920825]
curr_Stock_Price:  99.99327562282384
curr_Factors:  [9.99932756e+01 4.01883333e-02]
mat_Sqrt:  [[ 2.00456800e+01  0.00000000e+00]
 [-8.01881122e-03  1.83734047e-02]]
grads:  [ 0.002833   -1.16111069]
Stock Position:  0.002832996712244216
Bond Position:  [5.28592763]


portfolio before change:  [5.57226831]
curr_Stock_Price:  100.60690608120034
curr_Factors:  [1.00606906e+02 3.88102724e-02]
mat_Sqrt:  [[ 1.98198854e+01  0.00000000e+00]
 [-7.88012918e-03  1.80556442e-02]]
grads:  [  0.02995955 -15.66982356]
Stock Position:  0.02995954528422685
Bond Position:  [2.55813115]


portfolio before change:  [5.53581496]
curr_Stock_Price:  99.36880434305837
curr_Factors:  [9.93688043e+01 4.00158311e-02]
mat_Sqrt:  [[ 1.98776933e+01  0.00000000e+00]
 [-8.00158295e-03  1.83339298e-02]]
grads:  [-4.36940865e-03 -5.31485770e+00]
Stock Position:  -0.00436940864899442
Bond Position:  [5.96999787]


portfolio before change:  [5.54699527]
curr_Stock_Price:  97.15165638788808
curr_Factors:  [9.71516564e+01 3.98067829e-02]
mat_Sqrt:  [[ 1.93833461e+01  0.00000000e+00]
 [-7.98065490e-03  1.82859776e-02]]
grads:  [ 0.01529529 -0.58492051]
Stock Position:  0.015295292626401986
Bond Position:  [4.06103226]


portfolio before change:  [5.49718641]
curr_Stock_Price:  93.82878791935518
curr_Factors:  [9.38287879e+01 4.09775618e-02]
mat_Sqrt:  [[ 1.89936820e+01  0.00000000e+00]
 [-8.09716610e-03  1.85529383e-02]]
grads:  [ -0.03820468 -25.69672793]
Stock Position:  -0.03820467914918376
Bond Position:  [9.08188515]


portfolio before change:  [5.60918324]
curr_Stock_Price:  90.95672951029098
curr_Factors:  [9.09567295e+01 4.27684804e-02]
mat_Sqrt:  [[ 1.88103444e+01  0.00000000e+00]
 [-8.27221667e-03  1.89540295e-02]]
grads:  [-0.00454504 -4.16541532]
Stock Position:  -0.004545043604523273
Bond Position:  [6.02258554]


portfolio before change:  [5.61457637]
curr_Stock_Price:  90.10144665437973
curr_Factors:  [9.01014467e+01 4.22326465e-02]
mat_Sqrt:  [[ 1.85163727e+01  0.00000000e+00]
 [-8.22023324e-03  1.88349205e-02]]
grads:  [-0.09017939 25.16540724]
Stock Position:  -0.09017939302153538
Bond Position:  [13.73987014]


portfolio before change:  [5.6973618]
curr_Stock_Price:  89.22153351010161
curr_Factors:  [8.92215335e+01 4.49588405e-02]
mat_Sqrt:  [[ 1.89180877e+01  0.00000000e+00]
 [-8.48139994e-03  1.94333286e-02]]
grads:  [-1.55991841e-03  5.70248560e+00]
Stock Position:  -0.001559918413824443
Bond Position:  [5.83654011]


portfolio before change:  [5.69848757]
curr_Stock_Price:  89.43535918418104
curr_Factors:  [8.94353592e+01 4.61752323e-02]
mat_Sqrt:  [[ 1.92182483e+01  0.00000000e+00]
 [-8.59536920e-03  1.96944650e-02]]
grads:  [0.00225354 1.21617867]
Stock Position:  0.0022535431388595825
Bond Position:  [5.49694113]


portfolio before change:  [5.70563895]
curr_Stock_Price:  91.99886849471069
curr_Factors:  [9.19988685e+01 4.44435698e-02]
mat_Sqrt:  [[ 1.93948736e+01  0.00000000e+00]
 [-8.43265745e-03  1.93216455e-02]]
grads:  [1.39162753e-02 1.80920821e+01]
Stock Position:  0.013916275341150426
Bond Position:  [4.42535737]


portfolio before change:  [5.69973719]
curr_Stock_Price:  91.49526852105275
curr_Factors:  [9.14952685e+01 4.55343182e-02]
mat_Sqrt:  [[ 1.95239665e+01  0.00000000e+00]
 [-8.53550872e-03  1.95573074e-02]]
grads:  [ 2.69787069e-03 -1.03458751e+01]
Stock Position:  0.0026978706890676786
Bond Position:  [5.45289479]


portfolio before change:  [5.70404648]
curr_Stock_Price:  92.58720116280276
curr_Factors:  [9.25872012e+01 4.59255741e-02]
mat_Sqrt:  [[ 1.98416714e+01  0.00000000e+00]
 [-8.57210117e-03  1.96411512e-02]]
grads:  [0.00410621 1.15051634]
Stock Position:  0.0041062142911684
Bond Position:  [5.32386359]


portfolio before change:  [5.70875401]
curr_Stock_Price:  93.40946597639945
curr_Factors:  [9.34094660e+01 4.36233693e-02]
mat_Sqrt:  [[ 1.95096955e+01  0.00000000e+00]
 [-8.35448328e-03  1.91425260e-02]]
grads:  [-0.0082777  -7.76150371]
Stock Position:  -0.008277703478676833
Bond Position:  [6.48196987]


portfolio before change:  [5.7031455]
curr_Stock_Price:  94.28279992329286
curr_Factors:  [9.42827999e+01 4.31867337e-02]
mat_Sqrt:  [[ 1.95933028e+01  0.00000000e+00]
 [-8.31256723e-03  1.90464843e-02]]
grads:  [0.0085099  7.41809404]
Stock Position:  0.008509904005472815
Bond Position:  [4.90080793]


portfolio before change:  [5.70008907]
curr_Stock_Price:  93.77964637595905
curr_Factors:  [9.37796464e+01 4.37155517e-02]
mat_Sqrt:  [[ 1.96076963e+01  0.00000000e+00]
 [-8.36330573e-03  1.91627408e-02]]
grads:  [-0.00648792 -6.04030573]
Stock Position:  -0.006487915262310535
Bond Position:  [6.30852347]


portfolio before change:  [5.69330325]
curr_Stock_Price:  95.06868039409443
curr_Factors:  [9.50686804e+01 4.15903148e-02]
mat_Sqrt:  [[ 1.93880249e+01  0.00000000e+00]
 [-8.15748146e-03  1.86911381e-02]]
grads:  [ -0.01702233 -16.36931283]
Stock Position:  -0.017022329661084554
Bond Position:  [7.31159367]


portfolio before change:  [5.73362808]
curr_Stock_Price:  92.80713912672259
curr_Factors:  [9.28071391e+01 4.18857138e-02]
mat_Sqrt:  [[ 1.89939087e+01  0.00000000e+00]
 [-8.18639983e-03  1.87573984e-02]]
grads:  [ 9.95962232e-03 -2.22903297e+01]
Stock Position:  0.009959622324113213
Bond Position:  [4.80930403]


portfolio before change:  [5.75708091]
curr_Stock_Price:  95.041194765399
curr_Factors:  [9.50411948e+01 4.03992518e-02]
mat_Sqrt:  [[ 1.91028668e+01  0.00000000e+00]
 [-8.03982605e-03  1.84215557e-02]]
grads:  [-0.012395   -9.06740254]
Stock Position:  -0.01239500474669855
Bond Position:  [6.93511697]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.77042133]
Stock Price:  94.10481539487712
PL:  [5.77042133]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 6.08336010e-02  5.23485229e-02]
 [ 4.62129402e-02 -5.12182211e-02]
 [ 6.38897400e-01 -2.59007629e-01]
 [-1.23712968e-01 -1.38434782e-01]
 [ 6.32962589e-02 -1.12989272e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-1.35266487e-01 -1.87458557e-01]
 [-1.36810274e+00  7.46432538e-01]
 [ 8.64231371e-02 -6.86224788e-02]
 [ 2.65923733e-02 -7.27449857e-02]
 [-5.72966330e-02 -4.01793087e-02]
 [ 2.89203037e-02 -8.94370913e-03]
 [ 1.30261485e-01 -1.34454556e-02]
 [ 4.97412273e-02  7.56562025e-02]
 [-1.16978052e-01 -6.22954851e-02]
 [-1.16814889e-01 -1.14055858e-01]
 [-1.54752637e-01 -5.62888641e-01]
 [-1.16284573e-01 -1.26473944e-01]
 [ 1.32034280e-01  1.72174585e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.75163525]
curr_Stock_Price:  98.28646270906549
curr_Factors:  [9.82864627e+01 3.96985244e-02]
mat_Sqrt:  [[ 1.95830750e+01  0.00000000e+00]
 [-7.96979542e-03  1.82610954e-02]]
grads:  [0.0042731  2.86666937]
Stock Position:  0.004273096508721642
Bond Position:  [-9.17162279]


portfolio before change:  [-8.75265014]
curr_Stock_Price:  98.58561553798283
curr_Factors:  [9.85856155e+01 4.02286859e-02]
mat_Sqrt:  [[ 1.97734056e+01  0.00000000e+00]
 [-8.02283600e-03  1.83826266e-02]]
grads:  [ 1.20664474e-03 -2.78622975e+00]
Stock Position:  0.0012066447374325803
Bond Position:  [-8.87160795]


portfolio before change:  [-8.75412035]
curr_Stock_Price:  99.2054895649246
curr_Factors:  [9.92054896e+01 4.02433790e-02]
mat_Sqrt:  [[ 1.99013677e+01  0.00000000e+00]
 [-8.02430099e-03  1.83859833e-02]]
grads:  [  0.02642317 -14.08723289]
Stock Position:  0.02642316906819511
Bond Position:  [-11.37544377]


portfolio before change:  [-8.77847886]
curr_Stock_Price:  98.39126857188415
curr_Factors:  [9.83912686e+01 3.71596229e-02]
mat_Sqrt:  [[ 1.89667190e+01  0.00000000e+00]
 [-7.71073256e-03  1.76675078e-02]]
grads:  [-0.0097081 -7.835558 ]
Stock Position:  -0.00970810295080408
Bond Position:  [-7.8232863]


portfolio before change:  [-8.79830904]
curr_Stock_Price:  100.2324224403244
curr_Factors:  [1.00232422e+02 3.27714165e-02]
mat_Sqrt:  [[ 1.81449524e+01  0.00000000e+00]
 [-7.24115090e-03  1.65915611e-02]]
grads:  [ 0.0032166  -0.68100447]
Stock Position:  0.003216597179458692
Bond Position:  [-9.12071637]


portfolio before change:  [-8.79573271]
curr_Stock_Price:  101.74233843409087
curr_Factors:  [1.01742338e+02 3.38422656e-02]
mat_Sqrt:  [[ 1.87167927e+01  0.00000000e+00]
 [-7.35850698e-03  1.68604576e-02]]
grads:  [-3.09680278e-05 -1.14772544e+00]
Stock Position:  -3.096802783859165e-05
Bond Position:  [-8.79258195]


portfolio before change:  [-8.79793599]
curr_Stock_Price:  101.89905225539258
curr_Factors:  [1.01899052e+02 3.23726602e-02]
mat_Sqrt:  [[ 1.83340892e+01  0.00000000e+00]
 [-7.19696160e-03  1.64903107e-02]]
grads:  [ -0.01184025 -11.36780018]
Stock Position:  -0.011840245065136357
Bond Position:  [-7.59142624]


portfolio before change:  [-8.80178468]
curr_Stock_Price:  102.06379529945373
curr_Factors:  [1.02063795e+02 3.17094676e-02]
mat_Sqrt:  [[ 1.81746556e+01  0.00000000e+00]
 [-7.12286095e-03  1.63205247e-02]]
grads:  [-0.0573509  45.73581732]
Stock Position:  -0.057350901279672135
Bond Position:  [-2.94833403]


portfolio before change:  [-8.66260102]
curr_Stock_Price:  99.62406323109987
curr_Factors:  [9.96240632e+01 3.23507749e-02]
mat_Sqrt:  [[ 1.79187040e+01  0.00000000e+00]
 [-7.19452847e-03  1.64847356e-02]]
grads:  [ 3.15166946e-03 -4.16278916e+00]
Stock Position:  0.003151669457242036
Bond Position:  [-8.97658314]


portfolio before change:  [-8.66525341]
curr_Stock_Price:  99.49462000825912
curr_Factors:  [9.949462e+01 3.218945e-02]
mat_Sqrt:  [[ 1.78507462e+01  0.00000000e+00]
 [-7.17656742e-03  1.64435817e-02]]
grads:  [-2.88847380e-04 -4.42391365e+00]
Stock Position:  -0.0002888473800080867
Bond Position:  [-8.63651465]


portfolio before change:  [-8.66754995]
curr_Stock_Price:  99.96941819796947
curr_Factors:  [9.99694182e+01 3.23720020e-02]
mat_Sqrt:  [[ 1.79867188e+01  0.00000000e+00]
 [-7.19688844e-03  1.64901430e-02]]
grads:  [-0.00416042 -2.4365652 ]
Stock Position:  -0.004160420914946349
Bond Position:  [-8.25163509]


portfolio before change:  [-8.66961408]
curr_Stock_Price:  99.96964879064501
curr_Factors:  [9.99696488e+01 3.21086614e-02]
mat_Sqrt:  [[ 1.79134513e+01  0.00000000e+00]
 [-7.16755595e-03  1.64229338e-02]]
grads:  [ 0.00139655 -0.54458657]
Stock Position:  0.0013965454601582794
Bond Position:  [-8.80922624]


portfolio before change:  [-8.67051415]
curr_Stock_Price:  100.902317237599
curr_Factors:  [1.00902317e+02 3.21360469e-02]
mat_Sqrt:  [[ 1.80882839e+01  0.00000000e+00]
 [-7.17061190e-03  1.64299359e-02]]
grads:  [ 0.00687702 -0.81835107]
Stock Position:  0.0068770153819876665
Bond Position:  [-9.36442093]


portfolio before change:  [-8.67743192]
curr_Stock_Price:  100.23685736493846
curr_Factors:  [1.00236857e+02 3.22633385e-02]
mat_Sqrt:  [[ 1.80045427e+01  0.00000000e+00]
 [-7.18479934e-03  1.64624434e-02]]
grads:  [0.00459663 4.59568489]
Stock Position:  0.00459663445035218
Bond Position:  [-9.13818411]


portfolio before change:  [-8.67098096]
curr_Stock_Price:  102.13733448266889
curr_Factors:  [1.02137334e+02 2.99669613e-02]
mat_Sqrt:  [[ 1.76809613e+01  0.00000000e+00]
 [-6.92438719e-03  1.58657642e-02]]
grads:  [-0.00815374 -3.92640936]
Stock Position:  -0.008153743929334989
Bond Position:  [-7.83817928]


portfolio before change:  [-8.68296252]
curr_Stock_Price:  103.36643497469599
curr_Factors:  [1.03366435e+02 2.97150943e-02]
mat_Sqrt:  [[ 1.78183750e+01  0.00000000e+00]
 [-6.89522667e-03  1.57989491e-02]]
grads:  [-0.0093495  -7.21920538]
Stock Position:  -0.009349502796674338
Bond Position:  [-7.71653774]


portfolio before change:  [-8.68562257]
curr_Stock_Price:  103.44458602875703
curr_Factors:  [1.03444586e+02 2.83024160e-02]
mat_Sqrt:  [[ 1.74028157e+01  0.00000000e+00]
 [-6.72932877e-03  1.54188292e-02]]
grads:  [-2.30087698e-02 -3.65065747e+01]
Stock Position:  -0.02300876977428136
Bond Position:  [-6.3054899]


portfolio before change:  [-8.69078031]
curr_Stock_Price:  103.60022986431827
curr_Factors:  [1.0360023e+02 2.5574089e-02]
mat_Sqrt:  [[ 1.65676459e+01  0.00000000e+00]
 [-6.39676030e-03  1.46568191e-02]]
grads:  [-0.01035043 -8.62901716]
Stock Position:  -0.01035043407339724
Bond Position:  [-7.61847296]


portfolio before change:  [-8.67849652]
curr_Stock_Price:  102.229403640282
curr_Factors:  [1.02229404e+02 2.69043913e-02]
mat_Sqrt:  [[ 1.67682374e+01  0.00000000e+00]
 [-6.56102325e-03  1.50331928e-02]]
grads:  [0.0083222  1.14529619]
Stock Position:  0.008322198182507798
Bond Position:  [-9.52926988]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.68358062]
Stock Price:  101.90479162345585
PL:  [-10.58837224]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 8.24841090e-03  1.92704317e-02]
 [-7.45579025e-01  4.91921577e-01]
 [ 1.03737787e+00 -3.80625344e-01]
 [ 4.50567499e-01 -5.34468170e-02]
 [ 2.66742172e-01 -3.16733373e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-4.06927270e-01 -1.20255730e-01]
 [-1.42151093e+00  7.50186065e-01]
 [ 3.30867233e-02 -8.13260505e-02]
 [ 1.44184314e-01  5.00934304e-01]
 [-5.32941172e-01 -1.18384766e-01]
 [-4.06153492e-02 -4.92258472e-02]
 [-3.75573223e-02 -9.11757949e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.14916672e-01 -6.11255414e-02]
 [ 5.67401059e-02 -1.08483749e-02]
 [-1.27260722e-01 -6.55689520e-01]
 [-4.15439159e-01  5.90912834e-02]
 [ 4.95499147e-02 -7.83024732e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.0532632]
curr_Stock_Price:  101.7214320095863
curr_Factors:  [1.01721432e+02 3.98816441e-02]
mat_Sqrt:  [[ 2.03141658e+01  0.00000000e+00]
 [-7.98815564e-03  1.83031639e-02]]
grads:  [8.20054193e-04 1.05284703e+00]
Stock Position:  0.0008200541933299723
Bond Position:  [13.96984611]


portfolio before change:  [14.06017524]
curr_Stock_Price:  105.890844912519
curr_Factors:  [1.05890845e+02 3.90694929e-02]
mat_Sqrt:  [[ 2.09303890e+01  0.00000000e+00]
 [-7.90640175e-03  1.81158422e-02]]
grads:  [-2.53644042e-02  2.71542206e+01]
Stock Position:  -0.025364404211170512
Bond Position:  [16.74603343]


portfolio before change:  [14.0840437]
curr_Stock_Price:  105.11489805383091
curr_Factors:  [1.05114898e+02 4.11482276e-02]
mat_Sqrt:  [[ 2.13225843e+01  0.00000000e+00]
 [-8.11401036e-03  1.85915333e-02]]
grads:  [  0.04086087 -20.47304746]
Stock Position:  0.040860870398074116
Bond Position:  [9.78895747]


portfolio before change:  [14.06726066]
curr_Stock_Price:  104.64426241294868
curr_Factors:  [1.04644262e+02 4.24304332e-02]
mat_Sqrt:  [[ 2.15553041e+01  0.00000000e+00]
 [-8.23945952e-03  1.88789735e-02]]
grads:  [ 0.01982071 -2.83102347]
Stock Position:  0.019820708366599916
Bond Position:  [11.99313726]


portfolio before change:  [14.06817732]
curr_Stock_Price:  104.53922073738873
curr_Factors:  [1.04539221e+02 4.23261796e-02]
mat_Sqrt:  [[ 2.15071960e+01  0.00000000e+00]
 [-8.22933092e-03  1.88557659e-02]]
grads:  [ 0.01175973 -1.67976933]
Stock Position:  0.011759728880266338
Bond Position:  [12.83882443]


portfolio before change:  [14.06574729]
curr_Stock_Price:  104.0596059350777
curr_Factors:  [1.04059606e+02 4.33859850e-02]
mat_Sqrt:  [[ 2.16748903e+01  0.00000000e+00]
 [-8.33172107e-03  1.90903712e-02]]
grads:  [-2.67416420e-05 -1.01366159e+00]
Stock Position:  -2.67416420111237e-05
Bond Position:  [14.06853001]


portfolio before change:  [14.06925298]
curr_Stock_Price:  104.50389943788363
curr_Factors:  [1.04503899e+02 4.09117051e-02]
mat_Sqrt:  [[ 2.11376297e+01  0.00000000e+00]
 [-8.09065684e-03  1.85380237e-02]]
grads:  [-0.02173428 -6.48697682]
Stock Position:  -0.021734280518552675
Bond Position:  [16.34057005]


portfolio before change:  [14.09052983]
curr_Stock_Price:  103.71292787489172
curr_Factors:  [1.03712928e+02 4.23792572e-02]
mat_Sqrt:  [[ 2.13505745e+01  0.00000000e+00]
 [-8.23448915e-03  1.88675849e-02]]
grads:  [-0.05124466 39.7605771 ]
Stock Position:  -0.0512446582754166
Bond Position:  [19.40526338]


portfolio before change:  [14.03932177]
curr_Stock_Price:  104.80689523806849
curr_Factors:  [1.04806895e+02 4.06735948e-02]
mat_Sqrt:  [[ 2.11371357e+01  0.00000000e+00]
 [-8.06707826e-03  1.84839984e-02]]
grads:  [-1.13869497e-04 -4.39980835e+00]
Stock Position:  -0.00011386949736615132
Bond Position:  [14.05125608]


portfolio before change:  [14.04284282]
curr_Stock_Price:  104.73844139311342
curr_Factors:  [1.04738441e+02 4.33386660e-02]
mat_Sqrt:  [[ 2.18043867e+01  0.00000000e+00]
 [-8.32717633e-03  1.90799579e-02]]
grads:  [1.66393108e-02 2.62544763e+01]
Stock Position:  0.016639310789623038
Bond Position:  [12.30006734]


portfolio before change:  [14.07675924]
curr_Stock_Price:  106.59194478225947
curr_Factors:  [1.06591945e+02 4.09082250e-02]
mat_Sqrt:  [[ 2.15590542e+01  0.00000000e+00]
 [-8.09031272e-03  1.85372352e-02]]
grads:  [-0.02711661 -6.38632271]
Stock Position:  -0.02711661259860052
Bond Position:  [16.96717171]


portfolio before change:  [14.08446113]
curr_Stock_Price:  106.46436348747429
curr_Factors:  [1.06464363e+02 4.15219442e-02]
mat_Sqrt:  [[ 2.16941732e+01  0.00000000e+00]
 [-8.15077363e-03  1.86757686e-02]]
grads:  [-0.00286249 -2.63581373]
Stock Position:  -0.0028624861513753728
Bond Position:  [14.3892139]


portfolio before change:  [14.08682168]
curr_Stock_Price:  106.89657859319995
curr_Factors:  [1.06896579e+02 4.17239156e-02]
mat_Sqrt:  [[ 2.18351578e+01  0.00000000e+00]
 [-8.17057311e-03  1.87211349e-02]]
grads:  [-3.54243841e-03 -4.87020662e+00]
Stock Position:  -0.00354243840718122
Bond Position:  [14.46549622]


portfolio before change:  [14.09481468]
curr_Stock_Price:  105.66122274323406
curr_Factors:  [1.05661223e+02 4.44599149e-02]
mat_Sqrt:  [[ 2.22792181e+01  0.00000000e+00]
 [-8.43420796e-03  1.93251982e-02]]
grads:  [6.83314562e-03 7.68830870e+00]
Stock Position:  0.006833145616602586
Bond Position:  [13.37281616]


portfolio before change:  [14.10561275]
curr_Stock_Price:  106.75214776421653
curr_Factors:  [1.06752148e+02 4.28893765e-02]
mat_Sqrt:  [[ 2.21081034e+01  0.00000000e+00]
 [-8.28390019e-03  1.89807998e-02]]
grads:  [-0.00640462 -3.22038807]
Stock Position:  -0.006404621973446164
Bond Position:  [14.7893199]


portfolio before change:  [14.09637568]
curr_Stock_Price:  108.7717609333619
curr_Factors:  [1.08771761e+02 4.12135640e-02]
mat_Sqrt:  [[ 2.20818902e+01  0.00000000e+00]
 [-8.12044964e-03  1.86062876e-02]]
grads:  [ 0.00235512 -0.58304887]
Stock Position:  0.0023551193549316255
Bond Position:  [13.8402052]


portfolio before change:  [14.09786935]
curr_Stock_Price:  107.93663791120522
curr_Factors:  [1.07936638e+02 4.06862360e-02]
mat_Sqrt:  [[ 2.17717151e+01  0.00000000e+00]
 [-8.06833178e-03  1.84868706e-02]]
grads:  [-1.89891833e-02 -3.54678483e+01]
Stock Position:  -0.01898918330998184
Bond Position:  [16.14749795]


portfolio before change:  [14.09813153]
curr_Stock_Price:  108.13544561502592
curr_Factors:  [1.08135446e+02 3.96870479e-02]
mat_Sqrt:  [[ 2.15423199e+01  0.00000000e+00]
 [-7.96864333e-03  1.82584556e-02]]
grads:  [-0.01808763  3.23637906]
Stock Position:  -0.018087634474933487
Bond Position:  [16.05404595]


portfolio before change:  [14.10979072]
curr_Stock_Price:  107.71277146643901
curr_Factors:  [1.07712771e+02 3.96059658e-02]
mat_Sqrt:  [[ 2.14361854e+01  0.00000000e+00]
 [-7.96049906e-03  1.82397948e-02]]
grads:  [ 7.17287774e-04 -4.29294705e+00]
Stock Position:  0.0007172877735715036
Bond Position:  [14.03252967]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.11373762]
Stock Price:  108.32386091185585
PL:  [5.78987671]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.39191663e-02  1.00568931e-01]
 [ 4.08406468e-02 -5.92912394e-02]
 [ 5.50977386e-01 -2.32174115e-01]
 [-1.00498801e-01 -1.08233060e-01]
 [ 3.69864432e-01 -1.58181520e-02]
 [-3.54570511e-01 -3.67605563e-01]
 [-1.16864138e-01 -8.49162314e-02]
 [-1.83005348e+00  4.82825884e-01]
 [-1.79647738e-02  8.04912015e-02]
 [ 3.01542319e-02 -1.19005717e-03]
 [ 1.17340070e-01  3.49568798e-01]
 [ 2.05327876e-01 -3.44718624e-01]
 [ 1.15244920e-02  1.03794351e-01]
 [-1.37205137e-01 -2.36596048e-01]
 [ 2.18694997e-01  3.55400653e-01]
 [ 4.79693449e-03 -9.61000325e-02]
 [-2.03164053e-01 -2.13069443e-01]
 [ 5.36627152e-01 -5.37920175e-01]
 [-3.35077054e-01 -2.10968699e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.4051776]
curr_Stock_Price:  98.79052017482117
curr_Factors:  [9.87905202e+01 4.15568163e-02]
mat_Sqrt:  [[ 2.01389306e+01  0.00000000e+00]
 [-8.15419561e-03  1.86836093e-02]]
grads:  [3.86371291e-03 5.38273572e+00]
Stock Position:  0.0038637129096088896
Bond Position:  [-5.7868758]


portfolio before change:  [-5.40984063]
curr_Stock_Price:  97.95812666900481
curr_Factors:  [9.79581267e+01 3.97824722e-02]
mat_Sqrt:  [[ 1.95382812e+01  0.00000000e+00]
 [-7.97821756e-03  1.82803929e-02]]
grads:  [ 7.65872304e-04 -3.24343353e+00]
Stock Position:  0.0007658723038256447
Bond Position:  [-5.48486404]


portfolio before change:  [-5.41125849]
curr_Stock_Price:  97.89744486421304
curr_Factors:  [9.78974449e+01 3.96431102e-02]
mat_Sqrt:  [[ 1.94919468e+01  0.00000000e+00]
 [-7.96423105e-03  1.82483458e-02]]
grads:  [  0.02306841 -12.72302255]
Stock Position:  0.023068413842692242
Bond Position:  [-7.66959726]


portfolio before change:  [-5.4403708]
curr_Stock_Price:  96.71857450388246
curr_Factors:  [9.67185745e+01 3.90530682e-02]
mat_Sqrt:  [[ 1.91133788e+01  0.00000000e+00]
 [-7.90473966e-03  1.81120339e-02]]
grads:  [-0.00772943 -5.97575407]
Stock Position:  -0.007729433018806095
Bond Position:  [-4.69279105]


portfolio before change:  [-5.43050074]
curr_Stock_Price:  95.28982794415838
curr_Factors:  [9.52898279e+01 4.14032810e-02]
mat_Sqrt:  [[ 1.93893800e+01  0.00000000e+00]
 [-8.13911848e-03  1.86490633e-02]]
grads:  [ 0.01871957 -0.84820089]
Stock Position:  0.018719568368679468
Bond Position:  [-7.21428519]


portfolio before change:  [-5.43700535]
curr_Stock_Price:  95.03871022819662
curr_Factors:  [9.50387102e+01 4.05791004e-02]
mat_Sqrt:  [[ 1.91448400e+01  0.00000000e+00]
 [-8.05770195e-03  1.84625146e-02]]
grads:  [ -0.02690055 -19.91091527]
Stock Position:  -0.026900550294624567
Bond Position:  [-2.88041175]


portfolio before change:  [-5.39030774]
curr_Stock_Price:  93.27600260911017
curr_Factors:  [9.32760026e+01 4.15704286e-02]
mat_Sqrt:  [[ 1.90178833e+01  0.00000000e+00]
 [-8.15553100e-03  1.86866691e-02]]
grads:  [-0.00809368 -4.54421444]
Stock Position:  -0.008093677827264362
Bond Position:  [-4.63536182]


portfolio before change:  [-5.36820539]
curr_Stock_Price:  90.401989641084
curr_Factors:  [9.04019896e+01 4.44401007e-02]
mat_Sqrt:  [[ 1.90574815e+01  0.00000000e+00]
 [-8.43232833e-03  1.93208914e-02]]
grads:  [-0.08497088 24.98983473]
Stock Position:  -0.08497088101626432
Bond Position:  [2.31333132]


portfolio before change:  [-5.43725073]
curr_Stock_Price:  91.2213732076623
curr_Factors:  [9.12213732e+01 4.40922353e-02]
mat_Sqrt:  [[ 1.91548019e+01  0.00000000e+00]
 [-8.39926047e-03  1.92451234e-02]]
grads:  [8.96092094e-04 4.18242064e+00]
Stock Position:  0.000896092093857485
Bond Position:  [-5.51899348]


portfolio before change:  [-5.43926867]
curr_Stock_Price:  90.50937253473374
curr_Factors:  [9.05093725e+01 4.48360911e-02]
mat_Sqrt:  [[ 1.91649383e+01  0.00000000e+00]
 [-8.46981379e-03  1.94067814e-02]]
grads:  [ 0.00154631 -0.06132172]
Stock Position:  0.0015463054429829001
Bond Position:  [-5.5792238]


portfolio before change:  [-5.44252017]
curr_Stock_Price:  89.30875510447503
curr_Factors:  [8.93087551e+01 4.65581886e-02]
mat_Sqrt:  [[ 1.92704596e+01  0.00000000e+00]
 [-8.63093864e-03  1.97759648e-02]]
grads:  [1.40061216e-02 1.76764472e+01]
Stock Position:  0.014006121611332177
Bond Position:  [-6.69338945]


portfolio before change:  [-5.46021429]
curr_Stock_Price:  88.1649291522668
curr_Factors:  [8.81649292e+01 4.80140585e-02]
mat_Sqrt:  [[ 1.93187967e+01  0.00000000e+00]
 [-8.76484419e-03  2.00827810e-02]]
grads:  [ 2.84077395e-03 -1.71648849e+01]
Stock Position:  0.0028407739500756397
Bond Position:  [-5.71067092]


portfolio before change:  [-5.45783533]
curr_Stock_Price:  89.50498934914901
curr_Factors:  [8.95049893e+01 4.62184364e-02]
mat_Sqrt:  [[ 1.92422064e+01  0.00000000e+00]
 [-8.59938941e-03  1.97036764e-02]]
grads:  [2.95309484e-03 5.26776569e+00]
Stock Position:  0.0029530948404381664
Bond Position:  [-5.72215205]


portfolio before change:  [-5.46049607]
curr_Stock_Price:  89.08846909262824
curr_Factors:  [8.90884691e+01 4.70263296e-02]
mat_Sqrt:  [[ 1.93193290e+01  0.00000000e+00]
 [-8.67422201e-03  1.98751395e-02]]
grads:  [ -0.01244682 -11.90412014]
Stock Position:  -0.012446815231019925
Bond Position:  [-4.35162836]


portfolio before change:  [-5.45756735]
curr_Stock_Price:  88.76575472094464
curr_Factors:  [8.87657547e+01 4.71855796e-02]
mat_Sqrt:  [[ 1.92819120e+01  0.00000000e+00]
 [-8.68889678e-03  1.99087636e-02]]
grads:  [ 0.01938628 17.85146781]
Stock Position:  0.019386280686003603
Bond Position:  [-7.17840518]


portfolio before change:  [-5.43306413]
curr_Stock_Price:  90.12228338909266
curr_Factors:  [9.01222834e+01 4.72815861e-02]
mat_Sqrt:  [[ 1.95964862e+01  0.00000000e+00]
 [-8.69773176e-03  1.99290071e-02]]
grads:  [-1.89547033e-03 -4.82211844e+00]
Stock Position:  -0.0018954703346192986
Bond Position:  [-5.26224001]


portfolio before change:  [-5.43622423]
curr_Stock_Price:  91.09532843327129
curr_Factors:  [9.10953284e+01 4.58479009e-02]
mat_Sqrt:  [[ 1.95054437e+01  0.00000000e+00]
 [-8.56484918e-03  1.96245348e-02]]
grads:  [ -0.01518321 -10.85729905]
Stock Position:  -0.01518320659031802
Bond Position:  [-4.05310504]


portfolio before change:  [-5.41416459]
curr_Stock_Price:  89.57568624441939
curr_Factors:  [8.95756862e+01 4.59547653e-02]
mat_Sqrt:  [[ 1.92023959e+01  0.00000000e+00]
 [-8.57482504e-03  1.96473924e-02]]
grads:  [ 1.57198894e-02 -2.73787057e+01]
Stock Position:  0.015719889403597552
Bond Position:  [-6.82228447]


portfolio before change:  [-5.39025718]
curr_Stock_Price:  91.20503606376946
curr_Factors:  [9.12050361e+01 4.66049958e-02]
mat_Sqrt:  [[ 1.96895167e+01  0.00000000e+00]
 [-8.63527609e-03  1.97859032e-02]]
grads:  [ -0.02169435 -10.66257612]
Stock Position:  -0.021694353855257968
Bond Position:  [-3.41162285]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.41821774]
Stock Price:  92.45455702199695
PL:  [-5.41821774]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.80298147e-03  1.54697896e-01]
 [ 4.88632296e-02 -4.72355952e-02]
 [ 4.92469200e-01 -2.14317200e-01]
 [-4.04373740e-02 -2.00988371e-02]
 [ 4.44776332e-01 -2.21178343e-02]
 [-7.57013463e-01 -6.29925269e-01]
 [-6.98309518e-02 -8.12598893e-02]
 [-1.83005998e+00  4.83528217e-01]
 [-1.96384115e-02  8.28664352e-02]
 [ 3.05469878e-02  2.30225889e-03]
 [ 1.17340070e-01  3.49568798e-01]
 [ 1.81527583e-01 -2.91944425e-01]
 [ 6.34898846e-02  3.38519641e-02]
 [-1.09649516e-01 -1.76767800e-01]
 [ 1.70601465e-01  2.64877144e-01]
 [-3.45901918e-02 -1.01270270e-01]
 [-2.01923982e-01 -2.30320147e-01]
 [ 3.79422731e-01 -4.24017117e-01]
 [-2.45128969e-01 -1.87885024e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.57237727]
curr_Stock_Price:  99.36783261022083
curr_Factors:  [9.93678326e+01 3.81353771e-02]
mat_Sqrt:  [[ 1.94048299e+01  0.00000000e+00]
 [-7.81131253e-03  1.78979655e-02]]
grads:  [3.67530553e-03 8.64332298e+00]
Stock Position:  0.0036753055278264998
Bond Position:  [-1.93758441]


portfolio before change:  [-1.57455712]
curr_Stock_Price:  98.9065387602973
curr_Factors:  [9.89065388e+01 3.90723571e-02]
mat_Sqrt:  [[ 1.95505874e+01  0.00000000e+00]
 [-7.90669155e-03  1.81165063e-02]]
grads:  [ 1.44486328e-03 -2.60732365e+00]
Stock Position:  0.0014448632773620298
Bond Position:  [-1.71746355]


portfolio before change:  [-1.57758788]
curr_Stock_Price:  97.10613456080762
curr_Factors:  [9.71061346e+01 3.85816523e-02]
mat_Sqrt:  [[ 1.90737936e+01  0.00000000e+00]
 [-7.85688511e-03  1.80023854e-02]]
grads:  [  0.02091527 -11.90493349]
Stock Position:  0.02091526804021917
Bond Position:  [-3.60858871]


portfolio before change:  [-1.6222566]
curr_Stock_Price:  95.01357406168921
curr_Factors:  [9.50135741e+01 3.95555210e-02]
mat_Sqrt:  [[ 1.88968410e+01  0.00000000e+00]
 [-7.95542793e-03  1.82281753e-02]]
grads:  [-0.0026041  -1.10262474]
Stock Position:  -0.002604097988675149
Bond Position:  [-1.37483194]


portfolio before change:  [-1.61893079]
curr_Stock_Price:  93.60442495824155
curr_Factors:  [9.36044250e+01 3.99899658e-02]
mat_Sqrt:  [[ 1.87185367e+01  0.00000000e+00]
 [-7.99899651e-03  1.83280035e-02]]
grads:  [ 0.02324558 -1.20677816]
Stock Position:  0.023245583976630065
Bond Position:  [-3.79482031]


portfolio before change:  [-1.65622057]
curr_Stock_Price:  92.04107622993881
curr_Factors:  [9.20410762e+01 4.05848402e-02]
mat_Sqrt:  [[ 1.85423002e+01  0.00000000e+00]
 [-8.05827179e-03  1.84638202e-02]]
grads:  [ -0.05565304 -34.11673539]
Stock Position:  -0.055653040769349925
Bond Position:  [3.4661452]


portfolio before change:  [-1.62424395]
curr_Stock_Price:  91.48207763019697
curr_Factors:  [9.14820776e+01 4.05217589e-02]
mat_Sqrt:  [[ 1.84153579e+01  0.00000000e+00]
 [-8.05200684e-03  1.84494654e-02]]
grads:  [-0.00571782 -4.40445766]
Stock Position:  -0.005717818558377366
Bond Position:  [-1.10116603]


portfolio before change:  [-1.6183657]
curr_Stock_Price:  90.4058672951753
curr_Factors:  [9.04058673e+01 4.15260248e-02]
mat_Sqrt:  [[ 1.84228492e+01  0.00000000e+00]
 [-8.15117413e-03  1.86766862e-02]]
grads:  [-0.08788168 25.88940091]
Stock Position:  -0.08788168148592336
Bond Position:  [6.32665393]


portfolio before change:  [-1.67673714]
curr_Stock_Price:  91.08807208200851
curr_Factors:  [9.10880721e+01 4.06939781e-02]
mat_Sqrt:  [[ 1.83749677e+01  0.00000000e+00]
 [-8.06909939e-03  1.84886294e-02]]
grads:  [8.99455505e-04 4.48202155e+00]
Stock Position:  0.0008994555053291192
Bond Position:  [-1.75866681]


portfolio before change:  [-1.67783076]
curr_Stock_Price:  90.36108806514041
curr_Factors:  [9.03610881e+01 3.97999060e-02]
mat_Sqrt:  [[ 1.80269592e+01  0.00000000e+00]
 [-7.97996551e-03  1.82843980e-02]]
grads:  [0.00175026 0.12591385]
Stock Position:  0.0017502550320545038
Bond Position:  [-1.8359857]


portfolio before change:  [-1.68071364]
curr_Stock_Price:  88.97624567639264
curr_Factors:  [8.89762457e+01 3.91923687e-02]
mat_Sqrt:  [[ 1.76146830e+01  0.00000000e+00]
 [-7.91882503e-03  1.81443076e-02]]
grads:  [1.53226942e-02 1.92660313e+01]
Stock Position:  0.015322694165630195
Bond Position:  [-3.04406944]


portfolio before change:  [-1.67501844]
curr_Stock_Price:  89.39760199951577
curr_Factors:  [8.93976020e+01 3.82088022e-02]
mat_Sqrt:  [[ 1.74746136e+01  0.00000000e+00]
 [-7.81882878e-03  1.79151874e-02]]
grads:  [ 3.09664014e-03 -1.62959180e+01]
Stock Position:  0.003096640143388834
Bond Position:  [-1.95185064]


portfolio before change:  [-1.66666569]
curr_Stock_Price:  92.2525555497182
curr_Factors:  [9.22525555e+01 3.70871281e-02]
mat_Sqrt:  [[ 1.77660143e+01  0.00000000e+00]
 [-7.70320745e-03  1.76502656e-02]]
grads:  [0.00440527 1.91792944]
Stock Position:  0.004405270170458198
Bond Position:  [-2.07306313]


portfolio before change:  [-1.66821795]
curr_Stock_Price:  92.01785448746172
curr_Factors:  [9.20178545e+01 3.64673410e-02]
mat_Sqrt:  [[ 1.75721197e+01  0.00000000e+00]
 [-7.63856960e-03  1.75021617e-02]]
grads:  [ -0.01063032 -10.09976957]
Stock Position:  -0.010630323058610818
Bond Position:  [-0.69003843]


portfolio before change:  [-1.65857474]
curr_Stock_Price:  91.09448331241813
curr_Factors:  [9.10944833e+01 3.62027571e-02]
mat_Sqrt:  [[ 1.73325675e+01  0.00000000e+00]
 [-7.61080886e-03  1.74385538e-02]]
grads:  [ 0.01651246 15.18916917]
Stock Position:  0.016512460035993843
Bond Position:  [-3.16276876]


portfolio before change:  [-1.63650918]
curr_Stock_Price:  92.47867196139396
curr_Factors:  [9.24786720e+01 3.56586757e-02]
mat_Sqrt:  [[ 1.74632145e+01  0.00000000e+00]
 [-7.55340195e-03  1.73070181e-02]]
grads:  [-4.51166428e-03 -5.85139911e+00]
Stock Position:  -0.004511664282245767
Bond Position:  [-1.21927645]


portfolio before change:  [-1.63348288]
curr_Stock_Price:  91.74032877666201
curr_Factors:  [9.17403288e+01 3.57875159e-02]
mat_Sqrt:  [[ 1.73550580e+01  0.00000000e+00]
 [-7.56703544e-03  1.73382564e-02]]
grads:  [ -0.01742685 -13.28392786]
Stock Position:  -0.017426846697121152
Bond Position:  [-0.03473823]


portfolio before change:  [-1.65023643]
curr_Stock_Price:  92.70119493494605
curr_Factors:  [9.27011949e+01 3.40029293e-02]
mat_Sqrt:  [[ 1.70939921e+01  0.00000000e+00]
 [-7.37595328e-03  1.69004321e-02]]
grads:  [ 1.13704563e-02 -2.50891287e+01]
Stock Position:  0.011370456282696735
Bond Position:  [-2.70429131]


portfolio before change:  [-1.64507206]
curr_Stock_Price:  93.21485326187286
curr_Factors:  [9.32148533e+01 3.40350711e-02]
mat_Sqrt:  [[ 1.71968321e+01  0.00000000e+00]
 [-7.37943858e-03  1.69084179e-02]]
grads:  [ -0.01902261 -11.11192218]
Stock Position:  -0.019022614972447005
Bond Position:  [0.12811821]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.6430522]
Stock Price:  93.11035528022475
PL:  [-1.6430522]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.79812098e-02  4.17176413e-02]
 [ 6.96360537e-02 -1.60199902e-02]
 [ 5.49657234e-01 -2.31771200e-01]
 [-9.85350777e-02 -1.05094394e-01]
 [ 3.41652523e-01 -1.36603568e-02]
 [-2.57311562e-01 -3.01656660e-01]
 [-1.08269757e-01 -8.61472299e-02]
 [-1.45961735e+00  5.56908118e-01]
 [-8.28442918e-03  6.66792306e-02]
 [ 2.72893653e-02 -2.77453684e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 1.18847082e-01 -1.53413262e-01]
 [ 6.07440783e-02  3.62152445e-02]
 [-1.31532142e-01 -2.24291456e-01]
 [ 2.43022421e-01  4.01219537e-01]
 [ 5.73599842e-02 -9.08652121e-02]
 [-2.10308014e-01 -1.11633558e-01]
 [ 6.13392460e-01 -5.93653753e-01]
 [-3.10568086e-01 -2.04679237e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.68476924]
curr_Stock_Price:  100.61155859448287
curr_Factors:  [1.00611559e+02 4.06876596e-02]
mat_Sqrt:  [[ 2.02945409e+01  0.00000000e+00]
 [-8.06847292e-03  1.84871940e-02]]
grads:  [1.78315348e-03 2.25656968e+00]
Stock Position:  0.0017831534760074296
Bond Position:  [6.50536339]


portfolio before change:  [6.68552474]
curr_Stock_Price:  100.12307032495224
curr_Factors:  [1.00123070e+02 4.06089276e-02]
mat_Sqrt:  [[ 2.01764576e+01  0.00000000e+00]
 [-8.06066276e-03  1.84692986e-02]]
grads:  [ 0.00310482 -0.86738487]
Stock Position:  0.0031048243459719537
Bond Position:  [6.37466019]


portfolio before change:  [6.67894632]
curr_Stock_Price:  97.49094725800046
curr_Factors:  [9.74909473e+01 4.28694945e-02]
mat_Sqrt:  [[ 2.01854517e+01  0.00000000e+00]
 [-8.28197991e-03  1.89763999e-02]]
grads:  [  0.02221917 -12.21365491]
Stock Position:  0.022219170339272627
Bond Position:  [4.51277836]


portfolio before change:  [6.6608004]
curr_Stock_Price:  96.62348648257259
curr_Factors:  [9.66234865e+01 4.37286180e-02]
mat_Sqrt:  [[ 2.02053129e+01  0.00000000e+00]
 [-8.36455551e-03  1.91656044e-02]]
grads:  [-0.00714674 -5.48348967]
Stock Position:  -0.007146735716524104
Bond Position:  [7.35134292]


portfolio before change:  [6.66693154]
curr_Stock_Price:  96.02278204594312
curr_Factors:  [9.60227820e+01 4.46209271e-02]
mat_Sqrt:  [[ 2.02835319e+01  0.00000000e+00]
 [-8.44946646e-03  1.93601598e-02]]
grads:  [ 0.01654991 -0.70559112]
Stock Position:  0.016549911339484018
Bond Position:  [5.07776301]


portfolio before change:  [6.66380234]
curr_Stock_Price:  95.75699245900053
curr_Factors:  [9.57569925e+01 4.33063083e-02]
mat_Sqrt:  [[ 1.99271908e+01  0.00000000e+00]
 [-8.32406711e-03  1.90728338e-02]]
grads:  [ -0.01951933 -15.81603779]
Stock Position:  -0.01951932542717742
Bond Position:  [8.53291424]


portfolio before change:  [6.7295255]
curr_Stock_Price:  92.49921278688328
curr_Factors:  [9.24992128e+01 4.55031488e-02]
mat_Sqrt:  [[ 1.97314391e+01  0.00000000e+00]
 [-8.53258684e-03  1.95506125e-02]]
grads:  [-0.00739264 -4.40636987]
Stock Position:  -0.007392643256607507
Bond Position:  [7.41333918]


portfolio before change:  [6.72906587]
curr_Stock_Price:  92.8121182347932
curr_Factors:  [9.28121182e+01 4.60736180e-02]
mat_Sqrt:  [[ 1.9921904e+01  0.0000000e+00]
 [-8.5859064e-03  1.9672783e-02]]
grads:  [-0.06106659 28.30855795]
Stock Position:  -0.061066589023481894
Bond Position:  [12.39678535]


portfolio before change:  [6.78181205]
curr_Stock_Price:  91.9991270562537
curr_Factors:  [9.19991271e+01 4.67062788e-02]
mat_Sqrt:  [[ 1.98825160e+01  0.00000000e+00]
 [-8.64465420e-03  1.98073911e-02]]
grads:  [1.04698887e-03 3.36638128e+00]
Stock Position:  0.0010469888667041338
Bond Position:  [6.68548999]


portfolio before change:  [6.78311094]
curr_Stock_Price:  91.64316177386394
curr_Factors:  [9.16431618e+01 4.68797824e-02]
mat_Sqrt:  [[ 1.98423387e+01  0.00000000e+00]
 [-8.66069581e-03  1.98441470e-02]]
grads:  [ 7.65045595e-04 -1.39816382e+00]
Stock Position:  0.0007650455954278586
Bond Position:  [6.71299974]


portfolio before change:  [6.78351491]
curr_Stock_Price:  89.97725290476492
curr_Factors:  [8.99772529e+01 4.60803883e-02]
mat_Sqrt:  [[ 1.93148257e+01  0.00000000e+00]
 [-8.58653721e-03  1.96742284e-02]]
grads:  [1.39739496e-02 1.77678530e+01]
Stock Position:  0.013973949575670165
Bond Position:  [5.52617731]


portfolio before change:  [6.82211131]
curr_Stock_Price:  92.64040011629812
curr_Factors:  [9.26404001e+01 4.86817647e-02]
mat_Sqrt:  [[ 2.04401265e+01  0.00000000e+00]
 [-8.82557780e-03  2.02219392e-02]]
grads:  [ 2.53873405e-03 -7.58647629e+00]
Stock Position:  0.0025387340491886145
Bond Position:  [6.58692197]


portfolio before change:  [6.82217919]
curr_Stock_Price:  92.01841494149184
curr_Factors:  [9.20184149e+01 5.08991119e-02]
mat_Sqrt:  [[ 2.07601196e+01  0.00000000e+00]
 [-9.02433261e-03  2.06773436e-02]]
grads:  [0.00368734 1.75144569]
Stock Position:  0.0036873442154467338
Bond Position:  [6.48287562]


portfolio before change:  [6.81523726]
curr_Stock_Price:  89.69618702873925
curr_Factors:  [8.96961870e+01 5.05412908e-02]
mat_Sqrt:  [[ 2.01649499e+01  0.00000000e+00]
 [-8.99255611e-03  2.06045345e-02]]
grads:  [ -0.01137721 -10.88553859]
Stock Position:  -0.01137721443847247
Bond Position:  [7.83573001]


portfolio before change:  [6.84120426]
curr_Stock_Price:  87.58601932083741
curr_Factors:  [8.75860193e+01 5.02036853e-02]
mat_Sqrt:  [[ 1.96246802e+01  0.00000000e+00]
 [-8.96247156e-03  2.05356022e-02]]
grads:  [ 0.02130628 19.53775366]
Stock Position:  0.021306282633343564
Bond Position:  [4.97507178]


portfolio before change:  [6.82508821]
curr_Stock_Price:  86.77123742499725
curr_Factors:  [8.67712374e+01 5.03434809e-02]
mat_Sqrt:  [[ 1.94691688e+01  0.00000000e+00]
 [-8.97494119e-03  2.05641737e-02]]
grads:  [ 9.09291744e-04 -4.41861722e+00]
Stock Position:  0.0009092917442785884
Bond Position:  [6.74618784]


portfolio before change:  [6.82694251]
curr_Stock_Price:  86.95548520748663
curr_Factors:  [8.69554852e+01 5.05862068e-02]
mat_Sqrt:  [[ 1.95574865e+01  0.00000000e+00]
 [-8.99655105e-03  2.06136881e-02]]
grads:  [-0.01324449 -5.41550633]
Stock Position:  -0.013244487861158229
Bond Position:  [7.97862338]


portfolio before change:  [6.81418541]
curr_Stock_Price:  88.069307213863
curr_Factors:  [8.80693072e+01 4.83291075e-02]
mat_Sqrt:  [[ 1.93610527e+01  0.00000000e+00]
 [-8.79355286e-03  2.01485608e-02]]
grads:  [ 1.82996621e-02 -2.94638291e+01]
Stock Position:  0.018299662050618296
Bond Position:  [5.20254685]


portfolio before change:  [6.88292812]
curr_Stock_Price:  91.75472583944745
curr_Factors:  [9.17547258e+01 4.65250339e-02]
mat_Sqrt:  [[ 1.97911847e+01  0.00000000e+00]
 [-8.62786498e-03  1.97689222e-02]]
grads:  [ -0.02020584 -10.35358604]
Stock Position:  -0.020205835876599448
Bond Position:  [8.73690906]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.82383716]
Stock Price:  94.78728876285146
PL:  [6.82383716]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.46684830e-02  2.71650024e-02]
 [ 7.82560190e-02 -9.90145412e-03]
 [ 7.95781363e-01 -3.06889195e-01]
 [ 3.12554037e-01 -8.33147927e-02]
 [ 2.23953674e-01 -3.00582007e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-3.87257558e-01 -1.26323347e-01]
 [-1.51566022e+00  7.06982090e-01]
 [ 3.31398393e-02 -8.13460566e-02]
 [ 1.13773957e-01  2.86370807e-01]
 [-3.56863936e-01 -5.47961425e-02]
 [ 3.96781608e-03 -9.32852523e-03]
 [ 7.40142992e-02 -2.57373935e-02]
 [-4.70166614e-02 -4.42155741e-02]
 [ 7.77487956e-02  8.98575241e-02]
 [-1.43629113e-01 -1.40367288e-01]
 [-1.97408663e-01 -2.93235810e-01]
 [ 2.86182654e-01 -3.56233995e-01]
 [-1.74043559e-01 -1.69643264e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.60440366]
curr_Stock_Price:  100.9007019683713
curr_Factors:  [1.00900702e+02 4.06090038e-02]
mat_Sqrt:  [[ 2.03331824e+01  0.00000000e+00]
 [-8.06067032e-03  1.84693160e-02]]
grads:  [1.30448159e-03 1.47081800e+00]
Stock Position:  0.0013044815874228713
Bond Position:  [8.47278055]


portfolio before change:  [8.60663049]
curr_Stock_Price:  100.98378099997484
curr_Factors:  [1.00983781e+02 4.06684498e-02]
mat_Sqrt:  [[ 2.03648135e+01  0.00000000e+00]
 [-8.06656802e-03  1.84828293e-02]]
grads:  [ 0.00363051 -0.53571095]
Stock Position:  0.0036305105518059048
Bond Position:  [8.24000781]


portfolio before change:  [8.61161493]
curr_Stock_Price:  101.78922630948321
curr_Factors:  [1.01789226e+02 4.07405094e-02]
mat_Sqrt:  [[ 2.05454208e+01  0.00000000e+00]
 [-8.07371135e-03  1.84991967e-02]]
grads:  [  0.0322137  -16.58932548]
Stock Position:  0.03221369588172591
Bond Position:  [5.33260775]


portfolio before change:  [8.64003877]
curr_Stock_Price:  102.63018933726988
curr_Factors:  [1.02630189e+02 4.12508513e-02]
mat_Sqrt:  [[ 2.08445051e+01  0.00000000e+00]
 [-8.12412223e-03  1.86147025e-02]]
grads:  [ 0.01325013 -4.47575203]
Stock Position:  0.013250133767159208
Bond Position:  [7.28017504]


portfolio before change:  [8.65718376]
curr_Stock_Price:  103.78675983109306
curr_Factors:  [1.03786760e+02 4.18009884e-02]
mat_Sqrt:  [[ 2.12195041e+01  0.00000000e+00]
 [-8.17811601e-03  1.87384178e-02]]
grads:  [ 0.00993592 -1.60409491]
Stock Position:  0.009935915529707793
Bond Position:  [7.62596728]


portfolio before change:  [8.65036562]
curr_Stock_Price:  102.90864534457171
curr_Factors:  [1.02908645e+02 4.24110703e-02]
mat_Sqrt:  [[ 2.11929531e+01  0.00000000e+00]
 [-8.23757929e-03  1.88746653e-02]]
grads:  [-2.73497588e-05 -1.02524605e+00]
Stock Position:  -2.734975881478841e-05
Bond Position:  [8.65318014]


portfolio before change:  [8.65249066]
curr_Stock_Price:  104.3170870417986
curr_Factors:  [1.04317087e+02 4.03739164e-02]
mat_Sqrt:  [[ 2.09607053e+01  0.00000000e+00]
 [-8.03730466e-03  1.84157785e-02]]
grads:  [-0.02110566 -6.85951707]
Stock Position:  -0.021105663249823794
Bond Position:  [10.85417197]


portfolio before change:  [8.60852835]
curr_Stock_Price:  106.52863536067116
curr_Factors:  [1.06528635e+02 3.91505638e-02]
mat_Sqrt:  [[ 2.10782899e+01  0.00000000e+00]
 [-7.91460056e-03  1.81346281e-02]]
grads:  [-0.05726783 38.98519931]
Stock Position:  -0.05726783088682382
Bond Position:  [14.70919223]


portfolio before change:  [8.71091068]
curr_Stock_Price:  104.80507491952937
curr_Factors:  [1.04805075e+02 3.78570569e-02]
mat_Sqrt:  [[ 2.03918082e+01  0.00000000e+00]
 [-7.78275601e-03  1.78325343e-02]]
grads:  [-1.15854874e-04 -4.56166552e+00]
Stock Position:  -0.00011585487430795711
Bond Position:  [8.72305286]


portfolio before change:  [8.71332819]
curr_Stock_Price:  102.76395017353342
curr_Factors:  [1.02763950e+02 3.64011586e-02]
mat_Sqrt:  [[ 1.96064241e+01  0.00000000e+00]
 [-7.63163507e-03  1.74862727e-02]]
grads:  [1.21774589e-02 1.63768924e+01]
Stock Position:  0.012177458885044413
Bond Position:  [7.46192441]


portfolio before change:  [8.73426278]
curr_Stock_Price:  104.32986628323845
curr_Factors:  [1.04329866e+02 3.54163822e-02]
mat_Sqrt:  [[ 1.96340887e+01  0.00000000e+00]
 [-7.52769630e-03  1.72481191e-02]]
grads:  [-0.01939377 -3.17693439]
Stock Position:  -0.019393766552792097
Bond Position:  [10.75761185]


portfolio before change:  [8.77016088]
curr_Stock_Price:  102.61754495854072
curr_Factors:  [1.02617545e+02 3.66536277e-02]
mat_Sqrt:  [[ 1.96462697e+01  0.00000000e+00]
 [-7.65805486e-03  1.75468080e-02]]
grads:  [-5.26746845e-06 -5.31636592e-01]
Stock Position:  -5.267468451222059e-06
Bond Position:  [8.77070141]


portfolio before change:  [8.77235629]
curr_Stock_Price:  102.14975038792532
curr_Factors:  [1.02149750e+02 3.53617865e-02]
mat_Sqrt:  [[ 1.92089846e+01  0.00000000e+00]
 [-7.52189194e-03  1.72348196e-02]]
grads:  [ 0.00326834 -1.49333699]
Stock Position:  0.0032683445283252397
Bond Position:  [8.43849571]


portfolio before change:  [8.76243871]
curr_Stock_Price:  98.46976300443242
curr_Factors:  [9.84697630e+01 3.78964273e-02]
mat_Sqrt:  [[ 1.91691134e+01  0.00000000e+00]
 [-7.78680189e-03  1.78418046e-02]]
grads:  [-0.00345942 -2.47820079]
Stock Position:  -0.0034594150751634
Bond Position:  [9.1030865]


portfolio before change:  [8.77462228]
curr_Stock_Price:  95.60583709463248
curr_Factors:  [9.56058371e+01 3.68636793e-02]
mat_Sqrt:  [[ 1.83562409e+01  0.00000000e+00]
 [-7.67996659e-03  1.75970141e-02]]
grads:  [0.00637199 5.10640745]
Stock Position:  0.006371992777568203
Bond Position:  [8.16542257]


portfolio before change:  [8.7857237]
curr_Stock_Price:  97.02765524939912
curr_Factors:  [9.70276552e+01 3.49490329e-02]
mat_Sqrt:  [[ 1.81389907e+01  0.00000000e+00]
 [-7.47786418e-03  1.71339393e-02]]
grads:  [-0.01129558 -8.19235353]
Stock Position:  -0.01129557997419041
Bond Position:  [9.88170734]


portfolio before change:  [8.81735989]
curr_Stock_Price:  94.44563238389365
curr_Factors:  [9.44456324e+01 3.43156062e-02]
mat_Sqrt:  [[ 1.74955547e+01  0.00000000e+00]
 [-7.40978879e-03  1.69779590e-02]]
grads:  [ -0.01859828 -17.27155838]
Stock Position:  -0.01859828213739242
Bond Position:  [10.5738864]


portfolio before change:  [8.81870763]
curr_Stock_Price:  94.51531958420196
curr_Factors:  [9.45153196e+01 3.38289512e-02]
mat_Sqrt:  [[ 1.73838703e+01  0.00000000e+00]
 [-7.35705933e-03  1.68571406e-02]]
grads:  [ 7.51900409e-03 -2.11325279e+01]
Stock Position:  0.007519004088677852
Bond Position:  [8.10804655]


portfolio before change:  [8.82294833]
curr_Stock_Price:  94.80969842292673
curr_Factors:  [9.48096984e+01 3.46714434e-02]
mat_Sqrt:  [[ 1.76538213e+01  0.00000000e+00]
 [-7.44810778e-03  1.70657588e-02]]
grads:  [-0.01405259 -9.94056377]
Stock Position:  -0.014052592065961399
Bond Position:  [10.15527034]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.81769938]
Stock Price:  95.36390820531514
PL:  [8.81769938]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.25592549e-02  1.16779472e-01]
 [ 8.26932275e-02 -8.86671579e-03]
 [ 7.80441747e-01 -3.02207488e-01]
 [ 2.62284514e-01 -9.89917645e-02]
 [ 8.20197533e-02 -1.10289618e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-1.69162074e-01 -1.92586141e-01]
 [-1.27710531e+00  7.37315737e-01]
 [ 6.35498726e-02 -7.80447008e-02]
 [ 9.10899383e-02  1.88713807e-01]
 [-4.39121584e-02 -5.60041868e-04]
 [ 1.66459725e-02 -9.13300329e-03]
 [ 1.39549191e-01 -1.66829825e-02]
 [-1.22996440e-03  1.24312826e-02]
 [-1.23449923e-02 -9.54164906e-03]
 [-1.43529744e-01 -1.39921073e-01]
 [-1.92326685e-01 -3.64092863e-01]
 [ 2.82655356e-01 -3.53147574e-01]
 [-2.15775665e-01 -1.80354297e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.72083978]
curr_Stock_Price:  100.16511912713074
curr_Factors:  [1.00165119e+02 4.04448837e-02]
mat_Sqrt:  [[ 2.01441203e+01  0.00000000e+00]
 [-8.04436535e-03  1.84319566e-02]]
grads:  [4.14642058e-03 6.33570680e+00]
Stock Position:  0.004146420582194659
Bond Position:  [3.30551307]


portfolio before change:  [3.72337327]
curr_Stock_Price:  100.57680102913052
curr_Factors:  [1.00576801e+02 4.07147709e-02]
mat_Sqrt:  [[ 2.02942878e+01  0.00000000e+00]
 [-8.07116060e-03  1.84933522e-02]]
grads:  [ 0.00388402 -0.47945422]
Stock Position:  0.0038840227407714338
Bond Position:  [3.33273068]


portfolio before change:  [3.72868651]
curr_Stock_Price:  101.73023414157632
curr_Factors:  [1.01730234e+02 3.91461653e-02]
mat_Sqrt:  [[ 2.01277235e+01  0.00000000e+00]
 [-7.91415596e-03  1.81336094e-02]]
grads:  [  0.03222161 -16.66560042]
Stock Position:  0.032221606568324644
Bond Position:  [0.45077493]


portfolio before change:  [3.7367532]
curr_Stock_Price:  101.97708653350213
curr_Factors:  [1.01977087e+02 3.90233909e-02]
mat_Sqrt:  [[ 2.01448994e+01  0.00000000e+00]
 [-7.90173560e-03  1.81051508e-02]]
grads:  [ 0.01087526 -5.46760233]
Stock Position:  0.010875257413238021
Bond Position:  [2.62772614]


portfolio before change:  [3.71707429]
curr_Stock_Price:  100.10716047149208
curr_Factors:  [1.00107160e+02 4.10350971e-02]
mat_Sqrt:  [[ 2.02788291e+01  0.00000000e+00]
 [-8.10284859e-03  1.85659585e-02]]
grads:  [ 0.00380724 -0.59404215]
Stock Position:  0.003807237555366971
Bond Position:  [3.33594255]


portfolio before change:  [3.72407852]
curr_Stock_Price:  101.727794265332
curr_Factors:  [1.01727794e+02 3.93949894e-02]
mat_Sqrt:  [[ 2.01911066e+01  0.00000000e+00]
 [-7.93926842e-03  1.81911493e-02]]
grads:  [-2.87068048e-05 -1.06376875e+00]
Stock Position:  -2.870680482105072e-05
Bond Position:  [3.7269988]


portfolio before change:  [3.72499546]
curr_Stock_Price:  102.24761021870545
curr_Factors:  [1.02247610e+02 3.77644998e-02]
mat_Sqrt:  [[ 1.98698704e+01  0.00000000e+00]
 [-7.77323611e-03  1.78107214e-02]]
grads:  [ -0.01274359 -10.8129332 ]
Stock Position:  -0.012743593787734696
Bond Position:  [5.02799747]


portfolio before change:  [3.75746887]
curr_Stock_Price:  99.79804599263352
curr_Factors:  [9.97980460e+01 3.89987388e-02]
mat_Sqrt:  [[ 1.97082163e+01  0.00000000e+00]
 [-7.89923933e-03  1.80994311e-02]]
grads:  [-0.0484729  40.73695653]
Stock Position:  -0.04847289720881022
Bond Position:  [8.59496929]


portfolio before change:  [3.65432491]
curr_Stock_Price:  101.9702488534001
curr_Factors:  [1.01970249e+02 3.89873935e-02]
mat_Sqrt:  [[ 2.01342557e+01  0.00000000e+00]
 [-7.89809025e-03  1.80967982e-02]]
grads:  [ 1.46458717e-03 -4.31262481e+00]
Stock Position:  0.0014645871741258264
Bond Position:  [3.50498059]


portfolio before change:  [3.65461966]
curr_Stock_Price:  101.57313269444391
curr_Factors:  [1.01573133e+02 3.93499203e-02]
mat_Sqrt:  [[ 2.01488737e+01  0.00000000e+00]
 [-7.93472573e-03  1.81807406e-02]]
grads:  [8.60849088e-03 1.03798745e+01]
Stock Position:  0.008608490884092686
Bond Position:  [2.78022827]


portfolio before change:  [3.63917479]
curr_Stock_Price:  99.69823815707784
curr_Factors:  [9.96982382e+01 4.17418525e-02]
mat_Sqrt:  [[ 2.03691705e+01  0.00000000e+00]
 [-8.17232916e-03  1.87251585e-02]]
grads:  [-0.00216781 -0.02990852]
Stock Position:  -0.0021678143830035196
Bond Position:  [3.85530206]


portfolio before change:  [3.6364243]
curr_Stock_Price:  101.41168587534486
curr_Factors:  [1.01411686e+02 4.07405638e-02]
mat_Sqrt:  [[ 2.04692307e+01  0.00000000e+00]
 [-8.07371675e-03  1.84992091e-02]]
grads:  [ 0.00061849 -0.49369696]
Stock Position:  0.0006184894424701583
Bond Position:  [3.57370224]


portfolio before change:  [3.6368214]
curr_Stock_Price:  100.60902379568155
curr_Factors:  [1.00609024e+02 4.29723024e-02]
mat_Sqrt:  [[ 2.08560110e+01  0.00000000e+00]
 [-8.29190471e-03  1.89991405e-02]]
grads:  [ 0.00634197 -0.87809143]
Stock Position:  0.006341967360781882
Bond Position:  [2.99876225]


portfolio before change:  [3.62963485]
curr_Stock_Price:  99.3576256021663
curr_Factors:  [9.93576256e+01 4.56969800e-02]
mat_Sqrt:  [[ 2.12395325e+01  0.00000000e+00]
 [-8.55074078e-03  1.95922084e-02]]
grads:  [1.97532225e-04 6.34501345e-01]
Stock Position:  0.00019753222530939133
Bond Position:  [3.61000852]


portfolio before change:  [3.63039156]
curr_Stock_Price:  98.61895315975309
curr_Factors:  [9.86189532e+01 4.56042794e-02]
mat_Sqrt:  [[ 2.10602337e+01  0.00000000e+00]
 [-8.54206339e-03  1.95723260e-02]]
grads:  [-0.00078391 -0.48750716]
Stock Position:  -0.0007839091210992477
Bond Position:  [3.70769985]


portfolio before change:  [3.63198751]
curr_Stock_Price:  97.76565593778352
curr_Factors:  [9.77656559e+01 4.72424478e-02]
mat_Sqrt:  [[ 2.12496859e+01  0.00000000e+00]
 [-8.69413115e-03  1.99207570e-02]]
grads:  [-0.0096282  -7.02388333]
Stock Position:  -0.00962820384552523
Bond Position:  [4.57329517]


portfolio before change:  [3.63425459]
curr_Stock_Price:  97.64895529310074
curr_Factors:  [9.76489553e+01 4.82815737e-02]
mat_Sqrt:  [[ 2.14564718e+01  0.00000000e+00]
 [-8.78922737e-03  2.01386499e-02]]
grads:  [-1.63694125e-02 -1.80793085e+01]
Stock Position:  -0.016369412531938406
Bond Position:  [5.23271062]


portfolio before change:  [3.68723735]
curr_Stock_Price:  94.49218849359401
curr_Factors:  [9.44921885e+01 4.98221452e-02]
mat_Sqrt:  [[ 2.10914831e+01  0.00000000e+00]
 [-8.92834992e-03  2.04574197e-02]]
grads:  [ 6.09388720e-03 -1.72625668e+01]
Stock Position:  0.006093887198641753
Bond Position:  [3.11141261]


portfolio before change:  [3.68430958]
curr_Stock_Price:  93.88408331986149
curr_Factors:  [9.38840833e+01 5.16524877e-02]
mat_Sqrt:  [[ 2.13372080e+01  0.00000000e+00]
 [-9.09087346e-03  2.08298079e-02]]
grads:  [-0.01380165 -8.65847147]
Stock Position:  -0.013801652649067435
Bond Position:  [4.98006508]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.66552226]
Stock Price:  95.33553879217531
PL:  [3.66552226]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.03297092e-02  2.18297420e-02]
 [-1.32288429e-01  1.14642821e-01]
 [ 9.57748465e-01 -3.56322154e-01]
 [ 4.84547407e-01 -5.96506417e-02]
 [ 2.57508290e-01 -3.13237470e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-2.91613498e-01 -1.54712471e-01]
 [-1.38151718e+00  7.46559218e-01]
 [ 7.34967507e-02 -7.67438110e-02]
 [ 1.39081490e-02 -1.01491020e-01]
 [-5.71206254e-02 -3.57073163e-02]
 [ 9.16809626e-03 -9.24832675e-03]
 [ 1.34528409e-01 -1.48094581e-02]
 [ 4.21817185e-02  6.61397950e-02]
 [-1.18511252e-01 -6.31656580e-02]
 [-1.16876299e-01 -1.14081881e-01]
 [-1.52821864e-01 -5.65712274e-01]
 [-2.74671540e-01 -1.62152382e-02]
 [ 1.32169836e-01  1.59226183e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.28691072]
curr_Stock_Price:  101.4553766029403
curr_Factors:  [1.01455377e+02 4.07279450e-02]
mat_Sqrt:  [[ 2.04748777e+01  0.00000000e+00]
 [-8.07246629e-03  1.84963439e-02]]
grads:  [9.69822138e-04 1.18021930e+00]
Stock Position:  0.0009698221384219327
Bond Position:  [12.18851705]


portfolio before change:  [12.29095545]
curr_Stock_Price:  102.48362500496381
curr_Factors:  [1.02483625e+02 3.94919566e-02]
mat_Sqrt:  [[ 2.03661437e+01  0.00000000e+00]
 [-7.94903331e-03  1.82135234e-02]]
grads:  [-4.03877148e-03  6.29437908e+00]
Stock Position:  -0.004038771479439431
Bond Position:  [12.70486339]


portfolio before change:  [12.28708683]
curr_Stock_Price:  104.22802494156889
curr_Factors:  [1.04228025e+02 3.98244013e-02]
mat_Sqrt:  [[ 2.07997989e+01  0.00000000e+00]
 [-7.98242082e-03  1.82900238e-02]]
grads:  [  0.03856945 -19.48177639]
Stock Position:  0.03856944630784546
Bond Position:  [8.26706962]


portfolio before change:  [12.33317445]
curr_Stock_Price:  105.36935825311181
curr_Factors:  [1.05369358e+02 4.08659348e-02]
mat_Sqrt:  [[ 2.13007578e+01  0.00000000e+00]
 [-8.08612984e-03  1.85276510e-02]]
grads:  [ 0.0215257  -3.21954691]
Stock Position:  0.02152570052105692
Bond Position:  [10.0650252]


portfolio before change:  [12.31434091]
curr_Stock_Price:  104.37751578532799
curr_Factors:  [1.04377516e+02 4.12935601e-02]
mat_Sqrt:  [[ 2.12103639e+01  0.00000000e+00]
 [-8.12832678e-03  1.86243364e-02]]
grads:  [ 0.01149615 -1.68187185]
Stock Position:  0.011496148163623153
Bond Position:  [11.11440153]


portfolio before change:  [12.29044676]
curr_Stock_Price:  102.05733842813129
curr_Factors:  [1.02057338e+02 4.29445025e-02]
mat_Sqrt:  [[ 2.11493988e+01  0.00000000e+00]
 [-8.28922215e-03  1.89929940e-02]]
grads:  [-2.74060820e-05 -1.01885865e+00]
Stock Position:  -2.740608199186223e-05
Bond Position:  [12.29324375]


portfolio before change:  [12.29348336]
curr_Stock_Price:  103.41077420555571
curr_Factors:  [1.03410774e+02 4.14445790e-02]
mat_Sqrt:  [[ 2.10523051e+01  0.00000000e+00]
 [-8.14317668e-03  1.86583618e-02]]
grads:  [-0.0170592  -8.29185719]
Stock Position:  -0.017059203419541705
Bond Position:  [14.0575888]


portfolio before change:  [12.31012738]
curr_Stock_Price:  102.64114999969573
curr_Factors:  [1.02641150e+02 4.20265381e-02]
mat_Sqrt:  [[ 2.10418208e+01  0.00000000e+00]
 [-8.20015005e-03  1.87889042e-02]]
grads:  [-0.05017113 39.73404791]
Stock Position:  -0.05017113468799336
Bond Position:  [17.45975034]


portfolio before change:  [12.38300031]
curr_Stock_Price:  101.2756746059751
curr_Factors:  [1.01275675e+02 4.20599359e-02]
mat_Sqrt:  [[ 2.07701411e+01  0.00000000e+00]
 [-8.20340767e-03  1.87963683e-02]]
grads:  [ 1.92598622e-03 -4.08290632e+00]
Stock Position:  0.0019259862219382269
Bond Position:  [12.18794475]


portfolio before change:  [12.38150246]
curr_Stock_Price:  98.91573377191685
curr_Factors:  [9.89157338e+01 4.46671198e-02]
mat_Sqrt:  [[ 2.09054419e+01  0.00000000e+00]
 [-8.45383887e-03  1.93701783e-02]]
grads:  [-1.45350496e-03 -5.23955011e+00]
Stock Position:  -0.0014535049579674285
Bond Position:  [12.52527697]


portfolio before change:  [12.38313422]
curr_Stock_Price:  99.94769240371748
curr_Factors:  [9.99476924e+01 4.56811842e-02]
mat_Sqrt:  [[ 2.13619773e+01  0.00000000e+00]
 [-8.54926281e-03  1.95888220e-02]]
grads:  [-0.00340346 -1.82284143]
Stock Position:  -0.0034034572276933914
Bond Position:  [12.72330191]


portfolio before change:  [12.37895706]
curr_Stock_Price:  102.10972399173453
curr_Factors:  [1.02109724e+02 4.44262237e-02]
mat_Sqrt:  [[ 2.15222069e+01  0.00000000e+00]
 [-8.43101168e-03  1.93178746e-02]]
grads:  [ 2.38441884e-04 -4.78744528e-01]
Stock Position:  0.00023844188375903954
Bond Position:  [12.35460982]


portfolio before change:  [12.38172935]
curr_Stock_Price:  100.78134193118655
curr_Factors:  [1.00781342e+02 4.37105533e-02]
mat_Sqrt:  [[ 2.10704247e+01  0.00000000e+00]
 [-8.36282758e-03  1.91616452e-02]]
grads:  [ 0.00607795 -0.77286986]
Stock Position:  0.006077952107096609
Bond Position:  [11.76918518]


portfolio before change:  [12.38067064]
curr_Stock_Price:  100.12299906613303
curr_Factors:  [1.00122999e+02 4.27386038e-02]
mat_Sqrt:  [[ 2.06987450e+01  0.00000000e+00]
 [-8.26932682e-03  1.89474080e-02]]
grads:  [3.43245407e-03 3.49070410e+00]
Stock Position:  0.003432454068609002
Bond Position:  [12.03700305]


portfolio before change:  [12.38490244]
curr_Stock_Price:  100.47906240907557
curr_Factors:  [1.00479062e+02 3.97801571e-02]
mat_Sqrt:  [[ 2.00405124e+01  0.00000000e+00]
 [-7.97798542e-03  1.82798610e-02]]
grads:  [-0.00728919 -3.45547802]
Stock Position:  -0.00728918513483809
Bond Position:  [13.11731293]


portfolio before change:  [12.36712791]
curr_Stock_Price:  103.36748810878821
curr_Factors:  [1.03367488e+02 3.84557477e-02]
mat_Sqrt:  [[ 2.02705061e+01  0.00000000e+00]
 [-7.84405484e-03  1.79729875e-02]]
grads:  [-0.00822208 -6.34740779]
Stock Position:  -0.008222079538504226
Bond Position:  [13.21702362]


portfolio before change:  [12.36737994]
curr_Stock_Price:  103.73876166378447
curr_Factors:  [1.03738762e+02 3.87394362e-02]
mat_Sqrt:  [[ 2.04182119e+01  0.00000000e+00]
 [-7.87293452e-03  1.80391592e-02]]
grads:  [-1.95765889e-02 -3.13602351e+01]
Stock Position:  -0.01957658893634361
Bond Position:  [14.39823103]


portfolio before change:  [12.3401609]
curr_Stock_Price:  105.3130422544969
curr_Factors:  [1.05313042e+02 3.75934619e-02]
mat_Sqrt:  [[ 2.04191810e+01  0.00000000e+00]
 [-7.75561339e-03  1.77703427e-02]]
grads:  [-0.01379822 -0.91248877]
Stock Position:  -0.013798224824413025
Bond Position:  [13.79329393]


portfolio before change:  [12.38625172]
curr_Stock_Price:  102.22264021665823
curr_Factors:  [1.02222640e+02 3.87947615e-02]
mat_Sqrt:  [[ 2.01341656e+01  0.00000000e+00]
 [-7.87855433e-03  1.80520358e-02]]
grads:  [0.0069096  0.88204004]
Stock Position:  0.006909600262654574
Bond Position:  [11.67993413]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.38256396]
Stock Price:  101.26627499146835
PL:  [11.11628897]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.47559347e-02  2.72725391e-02]
 [-1.10677903e-01  1.01335918e-01]
 [ 8.39454945e-01 -3.20218534e-01]
 [ 4.03642349e-01 -5.49081395e-02]
 [ 3.16992313e-01 -3.35589572e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-4.29679598e-01 -1.15889781e-01]
 [-1.44980194e+00  7.53611791e-01]
 [ 6.17031989e-02 -7.80675709e-02]
 [ 4.09783881e-02 -3.72729408e-02]
 [-8.59127815e-02 -1.16286025e-01]
 [ 2.31942495e-02 -9.03201607e-03]
 [ 8.81123492e-02 -2.14404441e-02]
 [ 6.19142532e-02  9.71686140e-02]
 [-1.17446438e-01 -6.25613193e-02]
 [-1.41579423e-01 -1.31163152e-01]
 [-1.92263169e-01 -3.64962024e-01]
 [ 2.87058089e-01 -2.57308633e-01]
 [-1.34086823e-01 -1.59390550e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.52982154]
curr_Stock_Price:  100.88946809743311
curr_Factors:  [1.00889468e+02 3.82353041e-02]
mat_Sqrt:  [[ 1.97277750e+01  0.00000000e+00]
 [-7.82153991e-03  1.79213993e-02]]
grads:  [1.35132556e-03 1.52178625e+00]
Stock Position:  0.0013513255576303271
Bond Position:  [8.39348702]


portfolio before change:  [8.53391909]
curr_Stock_Price:  102.36869443054128
curr_Factors:  [1.02368694e+02 3.57160308e-02]
mat_Sqrt:  [[ 1.93463374e+01  0.00000000e+00]
 [-7.55947414e-03  1.73209312e-02]]
grads:  [-3.43482494e-03  5.85048905e+00]
Stock Position:  -0.0034348249426550364
Bond Position:  [8.88553763]


portfolio before change:  [8.5336858]
curr_Stock_Price:  103.08341815709846
curr_Factors:  [1.03083418e+02 3.60911887e-02]
mat_Sqrt:  [[ 1.95834590e+01  0.00000000e+00]
 [-7.59907243e-03  1.74116623e-02]]
grads:  [  0.03572914 -18.39103747]
Stock Position:  0.035729138449367495
Bond Position:  [4.85060408]


portfolio before change:  [8.56078048]
curr_Stock_Price:  103.80780939201378
curr_Factors:  [1.03807809e+02 3.46610513e-02]
mat_Sqrt:  [[ 1.93263968e+01  0.00000000e+00]
 [-7.44699147e-03  1.70632011e-02]]
grads:  [ 0.01964559 -3.21792724]
Stock Position:  0.019645590253208296
Bond Position:  [6.52141479]


portfolio before change:  [8.59428367]
curr_Stock_Price:  105.43019065306565
curr_Factors:  [1.05430191e+02 3.30607286e-02]
mat_Sqrt:  [[ 1.91699598e+01  0.00000000e+00]
 [-7.27304377e-03  1.66646368e-02]]
grads:  [ 0.01577186 -2.0137827 ]
Stock Position:  0.01577186321448448
Bond Position:  [6.93145313]


portfolio before change:  [8.62083331]
curr_Stock_Price:  107.00366115438322
curr_Factors:  [1.07003661e+02 3.32390446e-02]
mat_Sqrt:  [[ 1.95084562e+01  0.00000000e+00]
 [-7.29263131e-03  1.67095175e-02]]
grads:  [-2.97113288e-05 -1.15809305e+00]
Stock Position:  -2.971132876238692e-05
Bond Position:  [8.62401253]


portfolio before change:  [8.62305758]
curr_Stock_Price:  104.71507906227572
curr_Factors:  [1.04715079e+02 3.27631605e-02]
mat_Sqrt:  [[ 1.89540543e+01  0.00000000e+00]
 [-7.24023873e-03  1.65894710e-02]]
grads:  [-0.02533801 -6.985743  ]
Stock Position:  -0.025338011512658985
Bond Position:  [11.27632946]


portfolio before change:  [8.63641623]
curr_Stock_Price:  104.29913446078726
curr_Factors:  [1.04299134e+02 3.45792663e-02]
mat_Sqrt:  [[ 1.93949467e+01  0.00000000e+00]
 [-7.43820046e-03  1.70430583e-02]]
grads:  [-0.05779334 44.2181079 ]
Stock Position:  -0.0577933417903905
Bond Position:  [14.66421175]


portfolio before change:  [8.76759995]
curr_Stock_Price:  102.09270010350771
curr_Factors:  [1.0209270e+02 3.7036048e-02]
mat_Sqrt:  [[ 1.96474869e+01  0.00000000e+00]
 [-7.69790080e-03  1.76381066e-02]]
grads:  [ 1.40637415e-03 -4.42607434e+00]
Stock Position:  0.001406374147342023
Bond Position:  [8.62401942]


portfolio before change:  [8.76701832]
curr_Stock_Price:  100.1459173633543
curr_Factors:  [1.00145917e+02 3.94981683e-02]
mat_Sqrt:  [[ 1.99031459e+01  0.00000000e+00]
 [-7.94965844e-03  1.82149558e-02]]
grads:  [ 1.24156971e-03 -2.04628226e+00]
Stock Position:  0.0012415697098618252
Bond Position:  [8.64268018]


portfolio before change:  [8.7696309]
curr_Stock_Price:  100.50967767599104
curr_Factors:  [1.00509678e+02 4.10396152e-02]
mat_Sqrt:  [[ 2.03614884e+01  0.00000000e+00]
 [-8.10329466e-03  1.85669806e-02]]
grads:  [-0.00671189 -6.26305522]
Stock Position:  -0.00671189458131513
Bond Position:  [9.44424126]


portfolio before change:  [8.77217875]
curr_Stock_Price:  100.4818915808083
curr_Factors:  [1.00481892e+02 4.11031742e-02]
mat_Sqrt:  [[ 2.03716161e+01  0.00000000e+00]
 [-8.10956711e-03  1.85813526e-02]]
grads:  [ 0.00094506 -0.48607958]
Stock Position:  0.0009450577922299415
Bond Position:  [8.67721755]


portfolio before change:  [8.77564772]
curr_Stock_Price:  101.85683427608774
curr_Factors:  [1.01856834e+02 3.87722591e-02]
mat_Sqrt:  [[ 2.00562959e+01  0.00000000e+00]
 [-7.87626908e-03  1.80467996e-02]]
grads:  [ 0.0039267  -1.18804689]
Stock Position:  0.003926695779202463
Bond Position:  [8.37568692]


portfolio before change:  [8.77253744]
curr_Stock_Price:  100.5314289976895
curr_Factors:  [1.00531429e+02 4.16256123e-02]
mat_Sqrt:  [[ 2.05107798e+01  0.00000000e+00]
 [-8.16094232e-03  1.86990680e-02]]
grads:  [5.08620900e-03 5.19644156e+00]
Stock Position:  0.0050862090019822385
Bond Position:  [8.26121359]


portfolio before change:  [8.77879468]
curr_Stock_Price:  101.35555448440853
curr_Factors:  [1.01355554e+02 3.98829955e-02]
mat_Sqrt:  [[ 2.02414415e+01  0.00000000e+00]
 [-7.98829098e-03  1.83034740e-02]]
grads:  [-0.00715119 -3.41800246]
Stock Position:  -0.007151192068076767
Bond Position:  [9.50360772]


portfolio before change:  [8.79223335]
curr_Stock_Price:  99.80861444802798
curr_Factors:  [9.98086144e+01 4.16088758e-02]
mat_Sqrt:  [[ 2.03592145e+01  0.00000000e+00]
 [-8.15930152e-03  1.86953084e-02]]
grads:  [-0.00976579 -7.01583248]
Stock Position:  -0.009765785190137372
Bond Position:  [9.76694283]


portfolio before change:  [8.81593222]
curr_Stock_Price:  97.63195051767865
curr_Factors:  [9.76319505e+01 4.28342950e-02]
mat_Sqrt:  [[ 2.02063456e+01  0.00000000e+00]
 [-8.27857910e-03  1.89686077e-02]]
grads:  [-1.73977849e-02 -1.92403170e+01]
Stock Position:  -0.01739778488615859
Bond Position:  [10.51451189]


portfolio before change:  [8.80811159]
curr_Stock_Price:  98.2325781273449
curr_Factors:  [9.82325781e+01 4.37858399e-02]
mat_Sqrt:  [[ 2.05552321e+01  0.00000000e+00]
 [-8.37002652e-03  1.91781400e-02]]
grads:  [ 8.50194221e-03 -1.34167668e+01]
Stock Position:  0.00850194221282614
Bond Position:  [7.97294388]


portfolio before change:  [8.78866904]
curr_Stock_Price:  95.71126784857877
curr_Factors:  [9.57112678e+01 4.33487490e-02]
mat_Sqrt:  [[ 1.99274328e+01  0.00000000e+00]
 [-8.32814495e-03  1.90821773e-02]]
grads:  [-0.01021961 -8.35284924]
Stock Position:  -0.010219608506781159
Bond Position:  [9.76680072]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.78365241]
Stock Price:  96.44110355987726
PL:  [8.78365241]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.26528971e-02  2.46864968e-02]
 [-1.97190065e-01  1.54563668e-01]
 [ 8.71112074e-01 -3.29880407e-01]
 [ 1.24239424e-01 -1.14022969e-01]
 [-1.95390457e-02 -1.20704701e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-3.59171970e-01 -1.34178599e-01]
 [-1.49066422e+00  7.34088867e-01]
 [-3.56440887e-03 -6.11925165e-02]
 [ 1.98645612e-01  9.83462662e-01]
 [-8.09201130e-01 -2.18547908e-01]
 [-4.13845347e-02 -1.74520278e-01]
 [-7.11727493e-02 -1.14994431e-01]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.13790417e-01 -6.04863317e-02]
 [ 8.81882822e-02  1.06042973e-02]
 [-7.55297061e-02 -7.01344083e-01]
 [-3.89424885e-01  1.46566861e-01]
 [-1.06606533e-01 -8.65372729e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.31494409]
curr_Stock_Price:  101.15835073168515
curr_Factors:  [1.01158351e+02 3.95025161e-02]
mat_Sqrt:  [[ 2.01054649e+01  0.00000000e+00]
 [-7.95009596e-03  1.82159583e-02]]
grads:  [1.16520398e-03 1.35521263e+00]
Stock Position:  0.0011652039754712555
Bond Position:  [10.19707398]


portfolio before change:  [10.31946027]
curr_Stock_Price:  102.84611943130204
curr_Factors:  [1.02846119e+02 3.80250487e-02]
mat_Sqrt:  [[ 2.00550061e+01  0.00000000e+00]
 [-7.80000500e-03  1.78720567e-02]]
grads:  [-6.46885618e-03  8.64834254e+00]
Stock Position:  -0.006468856177413167
Bond Position:  [10.98475703]


portfolio before change:  [10.31878085]
curr_Stock_Price:  103.37572786683967
curr_Factors:  [1.03375728e+02 3.72333513e-02]
mat_Sqrt:  [[ 1.99473241e+01  0.00000000e+00]
 [-7.71837820e-03  1.76850262e-02]]
grads:  [  0.03645303 -18.65309126]
Stock Position:  0.03645303285593878
Bond Position:  [6.55042204]


portfolio before change:  [10.2185436]
curr_Stock_Price:  100.58103419938278
curr_Factors:  [1.00581034e+02 3.87211467e-02]
mat_Sqrt:  [[ 1.97920237e+01  0.00000000e+00]
 [-7.87107583e-03  1.80349004e-02]]
grads:  [ 3.76291591e-03 -6.32235092e+00]
Stock Position:  0.0037629159062524285
Bond Position:  [9.84006562]


portfolio before change:  [10.22222375]
curr_Stock_Price:  100.90520467585486
curr_Factors:  [1.00905205e+02 4.02901503e-02]
mat_Sqrt:  [[ 2.02541029e+01  0.00000000e+00]
 [-8.02896260e-03  1.83966644e-02]]
grads:  [-0.00122479 -0.65612275]
Stock Position:  -0.0012247903998790144
Bond Position:  [10.34581147]


portfolio before change:  [10.2231297]
curr_Stock_Price:  102.27754171739664
curr_Factors:  [1.02277542e+02 4.30300326e-02]
mat_Sqrt:  [[ 2.12161276e+01  0.00000000e+00]
 [-8.29747264e-03  1.90118982e-02]]
grads:  [-2.73198846e-05 -1.01784556e+00]
Stock Position:  -2.7319884566200324e-05
Bond Position:  [10.22592391]


portfolio before change:  [10.22563802]
curr_Stock_Price:  104.05184157481212
curr_Factors:  [1.04051842e+02 4.22791404e-02]
mat_Sqrt:  [[ 2.13950273e+01  0.00000000e+00]
 [-8.22475682e-03  1.88452853e-02]]
grads:  [-0.01952474 -7.12000886]
Stock Position:  -0.01952473837783483
Bond Position:  [12.25722301]


portfolio before change:  [10.19594772]
curr_Stock_Price:  105.72945622191244
curr_Factors:  [1.05729456e+02 4.30224233e-02]
mat_Sqrt:  [[ 2.19302424e+01  0.00000000e+00]
 [-8.29673895e-03  1.90102171e-02]]
grads:  [-0.05336382 38.6154909 ]
Stock Position:  -0.05336382282005274
Bond Position:  [15.83807569]


portfolio before change:  [10.05733561]
curr_Stock_Price:  108.4011563036174
curr_Factors:  [1.08401156e+02 4.23863038e-02]
mat_Sqrt:  [[ 2.23175588e+01  0.00000000e+00]
 [-8.23517371e-03  1.88691534e-02]]
grads:  [-1.35637651e-03 -3.24299215e+00]
Stock Position:  -0.0013563765105088742
Bond Position:  [10.20436839]


portfolio before change:  [10.05932001]
curr_Stock_Price:  108.8191901851412
curr_Factors:  [1.08819190e+02 4.10043979e-02]
mat_Sqrt:  [[ 2.20353884e+01  0.00000000e+00]
 [-8.09981708e-03  1.85590124e-02]]
grads:  [2.84934350e-02 5.29911096e+01]
Stock Position:  0.02849343500027948
Bond Position:  [6.95868749]


portfolio before change:  [10.09868453]
curr_Stock_Price:  110.13965691022591
curr_Factors:  [1.10139657e+02 4.21978709e-02]
mat_Sqrt:  [[ 2.26250209e+01  0.00000000e+00]
 [-8.21684814e-03  1.88271643e-02]]
grads:  [ -0.03998154 -11.60811605]
Stock Position:  -0.0399815435303015
Bond Position:  [14.50223802]


portfolio before change:  [10.08884664]
curr_Stock_Price:  110.4764098109273
curr_Factors:  [1.10476410e+02 4.38919956e-02]
mat_Sqrt:  [[ 2.31452681e+01  0.00000000e+00]
 [-8.38016664e-03  1.92013740e-02]]
grads:  [-5.07885360e-03 -9.08894738e+00]
Stock Position:  -0.005078853602889947
Bond Position:  [10.64994015]


portfolio before change:  [10.10084458]
curr_Stock_Price:  108.63837383063775
curr_Factors:  [1.08638374e+02 4.55349252e-02]
mat_Sqrt:  [[ 2.31822492e+01  0.00000000e+00]
 [-8.53556562e-03  1.95574378e-02]]
grads:  [-5.23505863e-03 -5.87983113e+00]
Stock Position:  -0.005235058626450307
Bond Position:  [10.66957283]


portfolio before change:  [10.09801246]
curr_Stock_Price:  109.68895379181734
curr_Factors:  [1.09688954e+02 4.44265736e-02]
mat_Sqrt:  [[ 2.31198123e+01  0.00000000e+00]
 [-8.43104488e-03  1.93179507e-02]]
grads:  [6.58470492e-03 7.69119312e+00]
Stock Position:  0.006584704915848843
Bond Position:  [9.37574306]


portfolio before change:  [10.09820379]
curr_Stock_Price:  109.36199953141934
curr_Factors:  [1.09362000e+02 4.41087822e-02]
mat_Sqrt:  [[ 2.29683065e+01  0.00000000e+00]
 [-8.40083636e-03  1.92487343e-02]]
grads:  [-0.00610358 -3.14235372]
Stock Position:  -0.006103576520883713
Bond Position:  [10.76570312]


portfolio before change:  [10.09926682]
curr_Stock_Price:  109.62884823700236
curr_Factors:  [1.09628848e+02 4.36743236e-02]
mat_Sqrt:  [[ 2.29106782e+01  0.00000000e+00]
 [-8.35936109e-03  1.91537025e-02]]
grads:  [0.00405123 0.55364216]
Stock Position:  0.004051227821714406
Bond Position:  [9.65513538]


portfolio before change:  [10.10620477]
curr_Stock_Price:  110.74551442095036
curr_Factors:  [1.10745514e+02 4.34099383e-02]
mat_Sqrt:  [[ 2.30738853e+01  0.00000000e+00]
 [-8.33402072e-03  1.90956404e-02]]
grads:  [-1.65391027e-02 -3.67279687e+01]
Stock Position:  -0.01653910269089371
Bond Position:  [11.93783621]


portfolio before change:  [10.08374267]
curr_Stock_Price:  112.28410660455475
curr_Factors:  [1.12284107e+02 4.38430867e-02]
mat_Sqrt:  [[ 2.35108781e+01  0.00000000e+00]
 [-8.37549633e-03  1.91906729e-02]]
grads:  [-0.01384286  7.63740083]
Stock Position:  -0.013842862955425295
Bond Position:  [11.63807617]


portfolio before change:  [10.10116031]
curr_Stock_Price:  111.2360754175218
curr_Factors:  [1.11236075e+02 4.31455116e-02]
mat_Sqrt:  [[ 2.31053988e+01  0.00000000e+00]
 [-8.30859908e-03  1.90373921e-02]]
grads:  [-0.00624852 -4.54564745]
Stock Position:  -0.006248517761393751
Bond Position:  [10.7962209]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.10518064]
Stock Price:  111.02467387817995
PL:  [-0.91949323]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 6.65241694e-03  1.49420553e-01]
 [ 4.39890999e-02 -5.45600160e-02]
 [ 5.42974020e-01 -2.29731459e-01]
 [-1.08725006e-01 -1.05760390e-01]
 [ 2.39359104e-01 -7.12524772e-03]
 [ 7.63788338e-03 -1.13482807e-01]
 [-8.81607056e-02 -1.65135565e-01]
 [-1.36028153e+00  7.44592449e-01]
 [ 8.40360634e-02 -7.47536124e-02]
 [ 3.55280457e-02 -5.08653816e-02]
 [-1.85278374e-01 -3.16936770e-02]
 [-4.04280099e-02 -1.87869831e-02]
 [-2.09572726e-02 -7.94152586e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15481333e-01 -6.14460168e-02]
 [-7.82110082e-02 -9.76970860e-02]
 [-1.48913280e-01 -5.77914110e-01]
 [-3.44027210e-01  3.20970282e-02]
 [ 1.26112842e-01 -3.62427366e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.00863803]
curr_Stock_Price:  99.30212118684906
curr_Factors:  [9.93021212e+01 3.99246567e-02]
mat_Sqrt:  [[ 1.98417110e+01  0.00000000e+00]
 [-7.99246212e-03  1.83130313e-02]]
grads:  [3.62191005e-03 8.15924740e+00]
Stock Position:  0.003621910053378777
Bond Position:  [-2.36830138]


portfolio before change:  [-2.01280767]
curr_Stock_Price:  98.31438722220057
curr_Factors:  [9.83143872e+01 4.14343313e-02]
mat_Sqrt:  [[ 2.00123110e+01  0.00000000e+00]
 [-8.14216986e-03  1.86560549e-02]]
grads:  [ 1.00823722e-03 -2.92452056e+00]
Stock Position:  0.0010082372167628775
Bond Position:  [-2.11193189]


portfolio before change:  [-2.01430306]
curr_Stock_Price:  97.35494157886792
curr_Factors:  [9.73549416e+01 4.31297532e-02]
mat_Sqrt:  [[ 2.02183862e+01  0.00000000e+00]
 [-8.30708163e-03  1.90339152e-02]]
grads:  [  0.02189646 -12.06958507]
Stock Position:  0.021896455434279895
Bond Position:  [-4.1460312]


portfolio before change:  [-1.98424043]
curr_Stock_Price:  98.77522967484244
curr_Factors:  [9.87752297e+01 4.16790858e-02]
mat_Sqrt:  [[ 2.01654139e+01  0.00000000e+00]
 [-8.16618254e-03  1.87110748e-02]]
grads:  [-0.00768061 -5.65228836]
Stock Position:  -0.007680607240684102
Bond Position:  [-1.22558668]


portfolio before change:  [-1.98266219]
curr_Stock_Price:  98.5298493656304
curr_Factors:  [9.85298494e+01 4.38802648e-02]
mat_Sqrt:  [[ 2.06396552e+01  0.00000000e+00]
 [-8.37904671e-03  1.91988079e-02]]
grads:  [ 0.01144638 -0.3711297 ]
Stock Position:  0.011446382601825187
Bond Position:  [-3.11047254]


portfolio before change:  [-1.98846544]
curr_Stock_Price:  98.09079911772486
curr_Factors:  [9.80907991e+01 4.36823652e-02]
mat_Sqrt:  [[ 2.05012974e+01  0.00000000e+00]
 [-8.36013064e-03  1.91554657e-02]]
grads:  [-2.04328894e-03 -5.92430426e+00]
Stock Position:  -0.002043288939395778
Bond Position:  [-1.7880376]


portfolio before change:  [-1.99495714]
curr_Stock_Price:  101.04908556420109
curr_Factors:  [1.01049086e+02 4.28578911e-02]
mat_Sqrt:  [[ 2.09193307e+01  0.00000000e+00]
 [-8.28085899e-03  1.89738316e-02]]
grads:  [-7.65950771e-03 -8.70333251e+00]
Stock Position:  -0.007659507706066084
Bond Position:  [-1.22097089]


portfolio before change:  [-2.00316073]
curr_Stock_Price:  102.08026166338392
curr_Factors:  [1.02080262e+02 4.22230152e-02]
mat_Sqrt:  [[ 2.09756968e+01  0.00000000e+00]
 [-8.21929585e-03  1.88327727e-02]]
grads:  [-0.04935782 39.53705918]
Stock Position:  -0.049357823831073795
Bond Position:  [3.03529885]


portfolio before change:  [-1.91352927]
curr_Stock_Price:  100.27968525132411
curr_Factors:  [1.00279685e+02 4.26391818e-02]
mat_Sqrt:  [[ 2.07070100e+01  0.00000000e+00]
 [-8.25970283e-03  1.89253567e-02]]
grads:  [ 2.48277816e-03 -3.94991828e+00]
Stock Position:  0.002482778159696357
Bond Position:  [-2.16250148]


portfolio before change:  [-1.91501387]
curr_Stock_Price:  99.89950445550357
curr_Factors:  [9.98995045e+01 4.22188525e-02]
mat_Sqrt:  [[ 2.05265777e+01  0.00000000e+00]
 [-8.21889068e-03  1.88318443e-02]]
grads:  [ 6.49332460e-04 -2.70103027e+00]
Stock Position:  0.0006493324599799799
Bond Position:  [-1.97988186]


portfolio before change:  [-1.91406514]
curr_Stock_Price:  102.12295665767229
curr_Factors:  [1.02122957e+02 4.13581077e-02]
mat_Sqrt:  [[ 2.07684320e+01  0.00000000e+00]
 [-8.13467715e-03  1.86388869e-02]]
grads:  [-0.00958718 -1.7004061 ]
Stock Position:  -0.009587176753530534
Bond Position:  [-0.93499431]


portfolio before change:  [-1.94657774]
curr_Stock_Price:  105.48983094663767
curr_Factors:  [1.05489831e+02 4.05093758e-02]
mat_Sqrt:  [[ 2.12318761e+01  0.00000000e+00]
 [-8.05077644e-03  1.84466462e-02]]
grads:  [-0.0022903 -1.0184498]
Stock Position:  -0.002290297907768013
Bond Position:  [-1.7049746]


portfolio before change:  [-1.94825055]
curr_Stock_Price:  106.03408771103804
curr_Factors:  [1.06034088e+02 3.87102304e-02]
mat_Sqrt:  [[ 2.08621173e+01  0.00000000e+00]
 [-7.86996624e-03  1.80323580e-02]]
grads:  [-2.66592946e-03 -4.40404181e+00]
Stock Position:  -0.002665929457335684
Bond Position:  [-1.66557115]


portfolio before change:  [-1.95188195]
curr_Stock_Price:  107.24003206840977
curr_Factors:  [1.07240032e+02 3.75802592e-02]
mat_Sqrt:  [[ 2.07891542e+01  0.00000000e+00]
 [-7.75425140e-03  1.77672220e-02]]
grads:  [7.32291176e-03 8.36248286e+00]
Stock Position:  0.007322911755256596
Bond Position:  [-2.73719125]


portfolio before change:  [-1.96568857]
curr_Stock_Price:  105.44808997541105
curr_Factors:  [1.0544809e+02 3.9242380e-02]
mat_Sqrt:  [[ 2.08889393e+01  0.00000000e+00]
 [-7.92387582e-03  1.81558804e-02]]
grads:  [-0.00681215 -3.38435898]
Stock Position:  -0.006812149297408612
Bond Position:  [-1.24736044]


portfolio before change:  [-1.96202247]
curr_Stock_Price:  104.86413697561117
curr_Factors:  [1.04864137e+02 3.64471454e-02]
mat_Sqrt:  [[ 2.00197545e+01  0.00000000e+00]
 [-7.63645420e-03  1.74973147e-02]]
grads:  [-0.00603651 -5.5835474 ]
Stock Position:  -0.006036513199586337
Bond Position:  [-1.32900873]


portfolio before change:  [-1.95887254]
curr_Stock_Price:  104.28727588688118
curr_Factors:  [1.04287276e+02 3.73702755e-02]
mat_Sqrt:  [[ 2.01601831e+01  0.00000000e+00]
 [-7.73255720e-03  1.77175143e-02]]
grads:  [-1.98974222e-02 -3.26182386e+01]
Stock Position:  -0.019897422216877104
Bond Position:  [0.11617542]


portfolio before change:  [-1.99190303]
curr_Stock_Price:  105.94877466295677
curr_Factors:  [1.05948775e+02 3.76565196e-02]
mat_Sqrt:  [[ 2.05596647e+01  0.00000000e+00]
 [-7.76211513e-03  1.77852401e-02]]
grads:  [-0.01605177  1.8047003 ]
Stock Position:  -0.016051765621145127
Bond Position:  [-0.29123814]


portfolio before change:  [-1.9894403]
curr_Stock_Price:  105.7908136810399
curr_Factors:  [1.05790814e+02 3.75175799e-02]
mat_Sqrt:  [[ 2.04911044e+01  0.00000000e+00]
 [-7.74778212e-03  1.77523990e-02]]
grads:  [ 0.00538259 -2.04156839]
Stock Position:  0.005382590074781561
Bond Position:  [-2.55886888]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.99287492]
Stock Price:  105.2715794791947
PL:  [-7.2644544]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.25739461e-02  1.16835667e-01]
 [ 7.95621341e-02 -6.52664900e-03]
 [ 6.99685746e-01 -2.77560457e-01]
 [ 3.46201548e-02 -1.05291190e-01]
 [ 1.90990892e-03 -1.20756078e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-6.32320783e-02 -1.28180482e-01]
 [-1.37210969e+00  7.45913667e-01]
 [ 6.66849950e-02 -4.03993068e-02]
 [ 2.70604060e-02 -7.09460029e-02]
 [-9.31549983e-03  9.40578827e-02]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.65690244e-01 -2.88276832e-02]
 [-7.13112081e-02 -9.35702786e-02]
 [ 1.46059676e-01  2.18566071e-01]
 [-3.98682268e-02 -1.03100869e-01]
 [-2.02461782e-01 -2.22833727e-01]
 [ 4.35719390e-01 -4.64790295e-01]
 [-3.23535603e-01 -2.08006237e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.71862994]
curr_Stock_Price:  100.16478627256798
curr_Factors:  [1.00164786e+02 4.08969027e-02]
mat_Sqrt:  [[ 2.02563073e+01  0.00000000e+00]
 [-8.08919306e-03  1.85346698e-02]]
grads:  [4.12539216e-03 6.30362819e+00]
Stock Position:  0.004125392161073375
Bond Position:  [3.30541092]


portfolio before change:  [3.72052931]
curr_Stock_Price:  100.4248602813727
curr_Factors:  [1.00424860e+02 4.09922586e-02]
mat_Sqrt:  [[ 2.03325646e+01  0.00000000e+00]
 [-8.09861801e-03  1.85562650e-02]]
grads:  [ 0.00377295 -0.35172213]
Stock Position:  0.003772946137153948
Bond Position:  [3.34163172]


portfolio before change:  [3.72044966]
curr_Stock_Price:  100.18230156505045
curr_Factors:  [1.00182302e+02 4.00527111e-02]
mat_Sqrt:  [[ 2.00496578e+01  0.00000000e+00]
 [-8.00526937e-03  1.83423764e-02]]
grads:  [  0.02885578 -15.13219721]
Stock Position:  0.02885577591211964
Bond Position:  [0.82961161]


portfolio before change:  [3.7135453]
curr_Stock_Price:  99.93584196359046
curr_Factors:  [9.99358420e+01 4.02761687e-02]
mat_Sqrt:  [[ 2.00560476e+01  0.00000000e+00]
 [-8.02756936e-03  1.83934721e-02]]
grads:  [-5.65050900e-04 -5.72437814e+00]
Stock Position:  -0.0005650509002625533
Bond Position:  [3.77001414]


portfolio before change:  [3.71410173]
curr_Stock_Price:  100.61931771527718
curr_Factors:  [1.00619318e+02 3.86047682e-02]
mat_Sqrt:  [[ 1.97697803e+01  0.00000000e+00]
 [-7.85923846e-03  1.80077776e-02]]
grads:  [-1.69972470e-04 -6.70577349e-01]
Stock Position:  -0.00016997246953991978
Bond Position:  [3.73120424]


portfolio before change:  [3.7148501]
curr_Stock_Price:  101.70507215373463
curr_Factors:  [1.01705072e+02 3.78067468e-02]
mat_Sqrt:  [[ 1.97754906e+01  0.00000000e+00]
 [-7.77758284e-03  1.78206810e-02]]
grads:  [-2.93101278e-05 -1.08588309e+00]
Stock Position:  -2.931012779444724e-05
Bond Position:  [3.71783108]


portfolio before change:  [3.71584157]
curr_Stock_Price:  99.59309100453841
curr_Factors:  [9.95930910e+01 4.04345618e-02]
mat_Sqrt:  [[ 2.00265243e+01  0.00000000e+00]
 [-8.04333879e-03  1.84296044e-02]]
grads:  [-5.95083926e-03 -6.95514017e+00]
Stock Position:  -0.005950839258898458
Bond Position:  [4.30850405]


portfolio before change:  [3.70052751]
curr_Stock_Price:  102.34754660079973
curr_Factors:  [1.02347547e+02 4.00010731e-02]
mat_Sqrt:  [[ 2.04697839e+01  0.00000000e+00]
 [-8.00010731e-03  1.83305486e-02]]
grads:  [-0.05112737 40.69238088]
Stock Position:  -0.051127373243614285
Bond Position:  [8.93328873]


portfolio before change:  [3.92336926]
curr_Stock_Price:  98.03267319505898
curr_Factors:  [9.80326732e+01 4.10734380e-02]
mat_Sqrt:  [[ 1.98678729e+01  0.00000000e+00]
 [-8.10663314e-03  1.85746300e-02]]
grads:  [ 0.00246898 -2.17497236]
Stock Position:  0.002468975524981918
Bond Position:  [3.68132898]


portfolio before change:  [3.92794868]
curr_Stock_Price:  99.51465474795278
curr_Factors:  [9.95146547e+01 4.02591638e-02]
mat_Sqrt:  [[ 1.99673033e+01  0.00000000e+00]
 [-8.02587454e-03  1.83895888e-02]]
grads:  [-1.95467965e-04 -3.85794395e+00]
Stock Position:  -0.0001954679650173197
Bond Position:  [3.94740061]


portfolio before change:  [3.92902978]
curr_Stock_Price:  99.03309342663256
curr_Factors:  [9.90330934e+01 3.99586965e-02]
mat_Sqrt:  [[ 1.97963900e+01  0.00000000e+00]
 [-7.99586858e-03  1.83208365e-02]]
grads:  [1.60305619e-03 5.13392948e+00]
Stock Position:  0.0016030561925640008
Bond Position:  [3.77027417]


portfolio before change:  [3.92914686]
curr_Stock_Price:  98.51807350156636
curr_Factors:  [9.85180735e+01 4.25248662e-02]
mat_Sqrt:  [[ 2.03159619e+01  0.00000000e+00]
 [-8.24862327e-03  1.88999703e-02]]
grads:  [ 0.00236349 -0.45457124]
Stock Position:  0.00236348535399773
Bond Position:  [3.69630084]


portfolio before change:  [3.92902061]
curr_Stock_Price:  98.07362500176238
curr_Factors:  [9.80736250e+01 4.17674497e-02]
mat_Sqrt:  [[ 2.00433914e+01  0.00000000e+00]
 [-8.17483453e-03  1.87308990e-02]]
grads:  [ 0.00763887 -1.53904429]
Stock Position:  0.007638867530364124
Bond Position:  [3.17984918]


portfolio before change:  [3.91480848]
curr_Stock_Price:  96.109042562607
curr_Factors:  [9.61090426e+01 4.08296181e-02]
mat_Sqrt:  [[ 1.94201200e+01  0.00000000e+00]
 [-8.08253604e-03  1.85194166e-02]]
grads:  [-0.00577487 -5.05255001]
Stock Position:  -0.005774867793467637
Bond Position:  [4.4698255]


portfolio before change:  [3.93798012]
curr_Stock_Price:  92.29007284309324
curr_Factors:  [9.22900728e+01 4.09332169e-02]
mat_Sqrt:  [[ 1.86720898e+01  0.00000000e+00]
 [-8.09278364e-03  1.85428968e-02]]
grads:  [ 0.01293105 11.78705106]
Stock Position:  0.0129310501610359
Bond Position:  [2.74457256]


portfolio before change:  [3.94321573]
curr_Stock_Price:  92.64189060463866
curr_Factors:  [9.26418906e+01 4.02113698e-02]
mat_Sqrt:  [[ 1.85772679e+01  0.00000000e+00]
 [-8.02110913e-03  1.83786699e-02]]
grads:  [-4.56822476e-03 -5.60981125e+00]
Stock Position:  -0.004568224759124395
Bond Position:  [4.3664247]


portfolio before change:  [3.94978401]
curr_Stock_Price:  91.44305795035558
curr_Factors:  [9.1443058e+01 3.8421444e-02]
mat_Sqrt:  [[ 1.79241092e+01  0.00000000e+00]
 [-7.84055549e-03  1.79649695e-02]]
grads:  [ -0.0167213  -12.40379101]
Stock Position:  -0.016721299187185384
Bond Position:  [5.47883074]


portfolio before change:  [3.94888131]
curr_Stock_Price:  91.57896669461003
curr_Factors:  [9.15789667e+01 3.87971619e-02]
mat_Sqrt:  [[ 1.80383047e+01  0.00000000e+00]
 [-7.87879807e-03  1.80525943e-02]]
grads:  [ 1.29096542e-02 -2.57464544e+01]
Stock Position:  0.01290965416853303
Bond Position:  [2.76662852]


portfolio before change:  [3.94803458]
curr_Stock_Price:  91.45979383167693
curr_Factors:  [9.14597938e+01 3.99069568e-02]
mat_Sqrt:  [[ 1.82706721e+01  0.00000000e+00]
 [-7.99069026e-03  1.83089715e-02]]
grads:  [ -0.02267661 -11.36089144]
Stock Position:  -0.022676613364639393
Bond Position:  [6.02203296]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.91075432]
Stock Price:  93.17018821147725
PL:  [3.91075432]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.25658643e-02  1.38825910e-01]
 [ 4.84158072e-02 -4.79079430e-02]
 [ 6.03563958e-01 -2.48223732e-01]
 [ 1.29574698e-02 -1.02948058e-01]
 [ 1.42998288e-01 -5.68041855e-03]
 [ 7.86592350e-03 -1.93511761e-02]
 [-2.52670641e-01 -1.68400617e-01]
 [-1.40927333e+00  7.49926645e-01]
 [ 4.00102794e-02 -7.30361631e-02]
 [ 1.38264610e-01  4.48289375e-01]
 [-4.23294474e-01 -7.89856394e-02]
 [-4.09001630e-02 -9.72615342e-02]
 [-8.09771610e-02 -1.21963140e-01]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.13816235e-01 -6.05009845e-02]
 [ 1.30861246e-01  5.28631190e-02]
 [-1.30566402e-01 -6.34189420e-01]
 [-4.04886434e-01  6.53712226e-02]
 [ 6.68735989e-02 -7.87739903e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.74785873]
curr_Stock_Price:  99.19077667049339
curr_Factors:  [9.91907767e+01 4.17345554e-02]
mat_Sqrt:  [[ 2.02637205e+01  0.00000000e+00]
 [-8.17161481e-03  1.87235217e-02]]
grads:  [3.61011979e-03 7.41451911e+00]
Stock Position:  0.0036101197937727517
Bond Position:  [-3.10594931]


portfolio before change:  [-2.74986455]
curr_Stock_Price:  98.85027827666376
curr_Factors:  [9.88502783e+01 3.95197032e-02]
mat_Sqrt:  [[ 1.96510035e+01  0.00000000e+00]
 [-7.95182527e-03  1.82199206e-02]]
grads:  [ 1.39977923e-03 -2.62942655e+00]
Stock Position:  0.001399779234989653
Bond Position:  [-2.88823312]


portfolio before change:  [-2.75074039]
curr_Stock_Price:  98.7404834561688
curr_Factors:  [9.87404835e+01 3.94947151e-02]
mat_Sqrt:  [[ 1.96229701e+01  0.00000000e+00]
 [-7.94931093e-03  1.82141595e-02]]
grads:  [  0.02523727 -13.62806402]
Stock Position:  0.025237272315250664
Bond Position:  [-5.24268086]


portfolio before change:  [-2.72577021]
curr_Stock_Price:  99.78184044305665
curr_Factors:  [9.97818404e+01 3.82385601e-02]
mat_Sqrt:  [[ 1.95120219e+01  0.00000000e+00]
 [-7.82187293e-03  1.79221624e-02]]
grads:  [-1.63861778e-03 -5.74417615e+00]
Stock Position:  -0.0016386177831288074
Bond Position:  [-2.56226591]


portfolio before change:  [-2.72609322]
curr_Stock_Price:  99.58799519587815
curr_Factors:  [9.95879952e+01 3.91511734e-02]
mat_Sqrt:  [[ 1.97051335e+01  0.00000000e+00]
 [-7.91466218e-03  1.81347693e-02]]
grads:  [ 0.00713109 -0.31323357]
Stock Position:  0.0071310935486003
Bond Position:  [-3.43626453]


portfolio before change:  [-2.71022281]
curr_Stock_Price:  101.93400019400067
curr_Factors:  [1.01934000e+02 3.67889089e-02]
mat_Sqrt:  [[ 1.95513847e+01  0.00000000e+00]
 [-7.67217402e-03  1.75791591e-02]]
grads:  [-2.96460924e-05 -1.10080215e+00]
Stock Position:  -2.9646092358023915e-05
Bond Position:  [-2.70720087]


portfolio before change:  [-2.71093242]
curr_Stock_Price:  103.03781500333659
curr_Factors:  [1.03037815e+02 3.48407373e-02]
mat_Sqrt:  [[ 1.92327023e+01  0.00000000e+00]
 [-7.46626946e-03  1.71073725e-02]]
grads:  [-0.01695896 -9.84374526]
Stock Position:  -0.01695896346387571
Bond Position:  [-0.96351788]


portfolio before change:  [-2.7141779]
curr_Stock_Price:  103.21498188614545
curr_Factors:  [1.03214982e+02 3.43135138e-02]
mat_Sqrt:  [[ 1.91194475e+01  0.00000000e+00]
 [-7.40956288e-03  1.69774414e-02]]
grads:  [-0.05659047 44.17194722]
Stock Position:  -0.056590469665520886
Bond Position:  [3.1268064]


portfolio before change:  [-2.74246204]
curr_Stock_Price:  103.72860083764458
curr_Factors:  [1.03728601e+02 3.36170828e-02]
mat_Sqrt:  [[ 1.90185995e+01  0.00000000e+00]
 [-7.33398477e-03  1.68042702e-02]]
grads:  [ 4.27722590e-04 -4.34628593e+00]
Stock Position:  0.0004277225900207626
Bond Position:  [-2.7868291]


portfolio before change:  [-2.74291381]
curr_Stock_Price:  104.30144202623406
curr_Factors:  [1.04301442e+02 3.48259219e-02]
mat_Sqrt:  [[ 1.94644270e+01  0.00000000e+00]
 [-7.46468184e-03  1.71037348e-02]]
grads:  [1.71550970e-02 2.62100284e+01]
Stock Position:  0.017155097005495577
Bond Position:  [-4.53221517]


portfolio before change:  [-2.72893086]
curr_Stock_Price:  105.18258843040879
curr_Factors:  [1.05182588e+02 3.37970618e-02]
mat_Sqrt:  [[ 1.93367431e+01  0.00000000e+00]
 [-7.35359088e-03  1.68491934e-02]]
grads:  [-0.02367341 -4.68779943]
Stock Position:  -0.02367340928254501
Bond Position:  [-0.23890039]


portfolio before change:  [-2.79582258]
curr_Stock_Price:  108.00567095222178
curr_Factors:  [1.08005671e+02 3.31513937e-02]
mat_Sqrt:  [[ 1.96651587e+01  0.00000000e+00]
 [-7.28300967e-03  1.66874716e-02]]
grads:  [-4.23838821e-03 -5.82841648e+00]
Stock Position:  -0.004238388211920735
Bond Position:  [-2.33805261]


portfolio before change:  [-2.80111013]
curr_Stock_Price:  109.11528290590023
curr_Factors:  [1.09115283e+02 3.16862585e-02]
mat_Sqrt:  [[ 1.94232126e+01  0.00000000e+00]
 [-7.12025375e-03  1.63145509e-02]]
grads:  [-6.9095799e-03 -7.4757277e+00]
Stock Position:  -0.006909579900348161
Bond Position:  [-2.04716936]


portfolio before change:  [-2.81038159]
curr_Stock_Price:  110.38303129459354
curr_Factors:  [1.10383031e+02 3.22434850e-02]
mat_Sqrt:  [[ 1.98208970e+01  0.00000000e+00]
 [-7.18258840e-03  1.64573775e-02]]
grads:  [7.68063836e-03 9.02805379e+00]
Stock Position:  0.007680638359924814
Bond Position:  [-3.65819374]


portfolio before change:  [-2.81949202]
curr_Stock_Price:  109.31596292084306
curr_Factors:  [1.09315963e+02 3.46145118e-02]
mat_Sqrt:  [[ 2.03382083e+01  0.00000000e+00]
 [-7.44199025e-03  1.70517418e-02]]
grads:  [-0.00689446 -3.54808237]
Stock Position:  -0.006894463234396268
Bond Position:  [-2.06581714]


portfolio before change:  [-2.83247929]
curr_Stock_Price:  111.12476890691497
curr_Factors:  [1.11124769e+02 3.37071521e-02]
mat_Sqrt:  [[ 2.04019604e+01  0.00000000e+00]
 [-7.34380306e-03  1.68267667e-02]]
grads:  [0.00754499 3.14160884]
Stock Position:  0.007544990745331504
Bond Position:  [-3.67091464]


portfolio before change:  [-2.865505]
curr_Stock_Price:  106.86924727827086
curr_Factors:  [1.06869247e+02 3.44124081e-02]
mat_Sqrt:  [[ 1.98248670e+01  0.00000000e+00]
 [-7.42023267e-03  1.70018890e-02]]
grads:  [-2.05473941e-02 -3.73011153e+01]
Stock Position:  -0.020547394130129765
Bond Position:  [-0.66962046]


portfolio before change:  [-2.8674178]
curr_Stock_Price:  106.95419104073184
curr_Factors:  [1.06954191e+02 3.44783854e-02]
mat_Sqrt:  [[ 1.98596352e+01  0.00000000e+00]
 [-7.42734250e-03  1.70181796e-02]]
grads:  [-0.01895081  3.84125824]
Stock Position:  -0.018950805970844874
Bond Position:  [-0.84054968]


portfolio before change:  [-2.87506248]
curr_Stock_Price:  107.34649676926598
curr_Factors:  [1.07346497e+02 3.45011510e-02]
mat_Sqrt:  [[ 1.99390594e+01  0.00000000e+00]
 [-7.42979418e-03  1.70237971e-02]]
grads:  [ 1.62965616e-03 -4.62728672e+00]
Stock Position:  0.0016296561598934944
Bond Position:  [-3.05000036]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.87502723]
Stock Price:  107.83607642382705
PL:  [-10.71110365]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.04904812e-03  1.28769308e-02]
 [-5.71305880e-01  3.84712709e-01]
 [ 1.19668679e+00 -4.29247015e-01]
 [ 5.66990788e-01 -7.47026035e-02]
 [ 3.46815439e-01 -3.46914760e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-2.78334107e-01 -1.58716849e-01]
 [-1.45592536e+00  7.53469021e-01]
 [ 4.57802190e-02 -7.39374961e-02]
 [ 1.26401523e-01  3.53067350e-01]
 [-4.67371952e-02 -8.08220159e-03]
 [-7.80882917e-04 -9.40175945e-03]
 [-3.54617883e-03 -6.70760756e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15976047e-01 -6.17267938e-02]
 [-7.31205137e-02 -9.55399392e-02]
 [-1.31856128e-01 -6.30178415e-01]
 [-4.02262361e-01  6.76056967e-02]
 [ 9.05771133e-02 -7.75051360e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.46606341]
curr_Stock_Price:  102.38610645635613
curr_Factors:  [1.02386106e+02 3.91872947e-02]
mat_Sqrt:  [[ 2.02681295e+01  0.00000000e+00]
 [-7.91831242e-03  1.81431330e-02]]
grads:  [4.27715912e-04 7.09741301e-01]
Stock Position:  0.00042771591201542017
Bond Position:  [18.42227124]


portfolio before change:  [18.47175465]
curr_Stock_Price:  104.9230640086887
curr_Factors:  [1.04923064e+02 3.88810660e-02]
mat_Sqrt:  [[ 2.06890261e+01  0.00000000e+00]
 [-7.88731295e-03  1.80721043e-02]]
grads:  [-1.94984282e-02  2.12876543e+01]
Stock Position:  -0.01949842819190046
Bond Position:  [20.51758948]


portfolio before change:  [18.42751607]
curr_Stock_Price:  107.45499198886563
curr_Factors:  [1.07454992e+02 3.80153733e-02]
mat_Sqrt:  [[ 2.09510709e+01  0.00000000e+00]
 [-7.79901259e-03  1.78697828e-02]]
grads:  [  0.04817644 -24.02083005]
Stock Position:  0.048176441082488454
Bond Position:  [13.25071698]


portfolio before change:  [18.41514027]
curr_Stock_Price:  107.1293371342852
curr_Factors:  [1.07129337e+02 3.83943789e-02]
mat_Sqrt:  [[ 2.09914404e+01  0.00000000e+00]
 [-7.83779345e-03  1.79586409e-02]]
grads:  [ 0.02545742 -4.1597025 ]
Stock Position:  0.025457419207503208
Bond Position:  [15.68790383]


portfolio before change:  [18.38904543]
curr_Stock_Price:  105.95021869243945
curr_Factors:  [1.05950219e+02 3.94295852e-02]
mat_Sqrt:  [[ 2.10384123e+01  0.00000000e+00]
 [-7.94275370e-03  1.81991350e-02]]
grads:  [ 0.0157652  -1.90621565]
Stock Position:  0.01576520289139783
Bond Position:  [16.71871873]


portfolio before change:  [18.36639046]
curr_Stock_Price:  104.24804137686449
curr_Factors:  [1.04248041e+02 3.95495298e-02]
mat_Sqrt:  [[ 2.07318743e+01  0.00000000e+00]
 [-7.95482543e-03  1.82267948e-02]]
grads:  [-2.79580201e-05 -1.06168837e+00]
Stock Position:  -2.7958020060064777e-05
Bond Position:  [18.36930503]


portfolio before change:  [18.37101029]
curr_Stock_Price:  103.2848239199302
curr_Factors:  [1.03284824e+02 4.13856482e-02]
mat_Sqrt:  [[ 2.10117098e+01  0.00000000e+00]
 [-8.13738516e-03  1.86450917e-02]]
grads:  [-0.01654334 -8.51252712]
Stock Position:  -0.01654333804332657
Bond Position:  [20.07968605]


portfolio before change:  [18.35422732]
curr_Stock_Price:  104.60278743332687
curr_Factors:  [1.04602787e+02 4.11660561e-02]
mat_Sqrt:  [[ 2.12232988e+01  0.00000000e+00]
 [-8.11576798e-03  1.85955605e-02]]
grads:  [-0.053106   40.51875819]
Stock Position:  -0.05310600083888944
Bond Position:  [23.90926304]


portfolio before change:  [18.43066097]
curr_Stock_Price:  103.27609017239999
curr_Factors:  [1.03276090e+02 4.14655719e-02]
mat_Sqrt:  [[ 2.10302104e+01  0.00000000e+00]
 [-8.14523880e-03  1.86630867e-02]]
grads:  [ 6.42468619e-04 -3.96169708e+00]
Stock Position:  0.0006424686192313524
Bond Position:  [18.36430932]


portfolio before change:  [18.43537155]
curr_Stock_Price:  103.46119539418538
curr_Factors:  [1.03461195e+02 4.09148398e-02]
mat_Sqrt:  [[ 2.09275274e+01  0.00000000e+00]
 [-8.09096679e-03  1.85387339e-02]]
grads:  [1.34030524e-02 1.90448470e+01]
Stock Position:  0.01340305243770832
Bond Position:  [17.04867572]


portfolio before change:  [18.38991453]
curr_Stock_Price:  99.75161383748734
curr_Factors:  [9.97516138e+01 4.25682649e-02]
mat_Sqrt:  [[ 2.05808309e+01  0.00000000e+00]
 [-8.25283126e-03  1.89096120e-02]]
grads:  [-0.0024423  -0.42741234]
Stock Position:  -0.0024422996968958685
Bond Position:  [18.63353787]


portfolio before change:  [18.38625153]
curr_Stock_Price:  103.15904617812983
curr_Factors:  [1.03159046e+02 3.98978749e-02]
mat_Sqrt:  [[ 2.06054546e+01  0.00000000e+00]
 [-7.98978096e-03  1.83068880e-02]]
grads:  [-2.37031759e-04 -5.13564044e-01]
Stock Position:  -0.00023703175880857773
Bond Position:  [18.4107035]


portfolio before change:  [18.39038635]
curr_Stock_Price:  105.13527387569751
curr_Factors:  [1.05135274e+02 3.83463787e-02]
mat_Sqrt:  [[ 2.05878326e+01  0.00000000e+00]
 [-7.83289257e-03  1.79474116e-02]]
grads:  [-1.59417355e-03 -3.73736767e+00]
Stock Position:  -0.0015941735502397407
Bond Position:  [18.55799022]


portfolio before change:  [18.39478233]
curr_Stock_Price:  105.28839015146183
curr_Factors:  [1.05288390e+02 3.57376925e-02]
mat_Sqrt:  [[ 1.99041547e+01  0.00000000e+00]
 [-7.56176620e-03  1.73261830e-02]]
grads:  [7.64851076e-03 8.57535035e+00]
Stock Position:  0.007648510761448925
Bond Position:  [17.58948295]


portfolio before change:  [18.39166808]
curr_Stock_Price:  104.30621494703192
curr_Factors:  [1.04306215e+02 3.56044243e-02]
mat_Sqrt:  [[ 1.96816802e+01  0.00000000e+00]
 [-7.54765387e-03  1.72938476e-02]]
grads:  [-0.00726136 -3.56929211]
Stock Position:  -0.007261363232122615
Bond Position:  [19.14907339]


portfolio before change:  [18.39097523]
curr_Stock_Price:  105.06099243059539
curr_Factors:  [1.05060992e+02 3.57077521e-02]
mat_Sqrt:  [[ 1.98528451e+01  0.00000000e+00]
 [-7.55859798e-03  1.73189237e-02]]
grads:  [-0.00578343 -5.51650558]
Stock Position:  -0.005783431084365138
Bond Position:  [18.99858824]


portfolio before change:  [18.38631496]
curr_Stock_Price:  106.68814191535003
curr_Factors:  [1.06688142e+02 3.48112344e-02]
mat_Sqrt:  [[ 1.99056271e+01  0.00000000e+00]
 [-7.46310760e-03  1.71001277e-02]]
grads:  [-2.04408801e-02 -3.68522636e+01]
Stock Position:  -0.020440880079964748
Bond Position:  [20.56711448]


portfolio before change:  [18.39063899]
curr_Stock_Price:  106.72817921464232
curr_Factors:  [1.06728179e+02 3.43738329e-02]
mat_Sqrt:  [[ 1.97875981e+01  0.00000000e+00]
 [-7.41607259e-03  1.69923570e-02]]
grads:  [-0.0188379   3.97859442]
Stock Position:  -0.018837901097556578
Bond Position:  [20.40117387]


portfolio before change:  [18.3941732]
curr_Stock_Price:  106.81134757374019
curr_Factors:  [1.06811348e+02 3.40280563e-02]
mat_Sqrt:  [[ 1.97031637e+01  0.00000000e+00]
 [-7.37867807e-03  1.69066754e-02]]
grads:  [ 2.88030388e-03 -4.58429196e+00]
Stock Position:  0.0028803038786224325
Bond Position:  [18.08652406]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.40571704]
Stock Price:  109.24915893086606
PL:  [9.1565581]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.69653728e-02  9.53826823e-02]
 [-6.20576875e-03  3.70847009e-02]
 [ 8.33462440e-01 -3.18389600e-01]
 [ 1.18313480e-01 -1.13863733e-01]
 [ 2.81670440e-01 -9.27093692e-03]
 [-1.26064653e-01 -2.12749674e-01]
 [-9.67218751e-02 -7.71307109e-02]
 [-1.36418810e+00  5.87125580e-01]
 [ 3.64943512e-02  2.73419430e-03]
 [ 1.81848772e-02 -7.39267554e-02]
 [-2.56317689e-02  5.07178411e-02]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.34854518e-01 -3.39331436e-02]
 [-6.71097219e-02 -8.44645860e-02]
 [ 6.95923867e-02  7.43526698e-02]
 [-1.39620659e-01 -1.38221332e-01]
 [-2.00936398e-01 -2.44119344e-01]
 [ 3.64246126e-01 -4.12485498e-01]
 [-2.05589740e-01 -1.77740179e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.5881818]
curr_Stock_Price:  100.29576181428139
curr_Factors:  [1.00295762e+02 3.99711470e-02]
mat_Sqrt:  [[ 2.00519165e+01  0.00000000e+00]
 [-7.99711418e-03  1.83236905e-02]]
grads:  [3.42080959e-03 5.20542967e+00]
Stock Position:  0.0034208095910552476
Bond Position:  [4.2450891]


portfolio before change:  [4.59432535]
curr_Stock_Price:  101.7814181055826
curr_Factors:  [1.01781418e+02 4.08627493e-02]
mat_Sqrt:  [[ 2.05746421e+01  0.00000000e+00]
 [-8.08581467e-03  1.85269289e-02]]
grads:  [4.85030145e-04 2.00166477e+00]
Stock Position:  0.00048503014459218746
Bond Position:  [4.5449583]


portfolio before change:  [4.59573992]
curr_Stock_Price:  102.35496946165658
curr_Factors:  [1.02354969e+02 4.17130794e-02]
mat_Sqrt:  [[ 2.09047539e+01  0.00000000e+00]
 [-8.16951205e-03  1.87187037e-02]]
grads:  [  0.03322239 -17.00916929]
Stock Position:  0.03322238713374917
Bond Position:  [1.1952635]


portfolio before change:  [4.53557033]
curr_Stock_Price:  100.53485801229337
curr_Factors:  [1.00534858e+02 4.31646142e-02]
mat_Sqrt:  [[ 2.08872181e+01  0.00000000e+00]
 [-8.31043818e-03  1.90416060e-02]]
grads:  [ 3.28522795e-03 -5.97973369e+00]
Stock Position:  0.003285227952708386
Bond Position:  [4.2052904]


portfolio before change:  [4.52725879]
curr_Stock_Price:  97.68482869500467
curr_Factors:  [9.76848287e+01 4.44243006e-02]
mat_Sqrt:  [[ 2.05891027e+01  0.00000000e+00]
 [-8.43082920e-03  1.93174565e-02]]
grads:  [ 0.01348404 -0.47992534]
Stock Position:  0.013484039373216496
Bond Position:  [3.21007271]


portfolio before change:  [4.51515215]
curr_Stock_Price:  96.72745561945233
curr_Factors:  [9.67274556e+01 4.56701201e-02]
mat_Sqrt:  [[ 2.06712072e+01  0.00000000e+00]
 [-8.54822743e-03  1.95864496e-02]]
grads:  [-1.05903937e-02 -1.08620847e+01]
Stock Position:  -0.010590393694311199
Bond Position:  [5.53953398]


portfolio before change:  [4.5460811]
curr_Stock_Price:  93.93776746629716
curr_Factors:  [9.39377675e+01 4.82019076e-02]
mat_Sqrt:  [[ 2.06239738e+01  0.00000000e+00]
 [-8.78197314e-03  2.01220283e-02]]
grads:  [-0.00632199 -3.83314792]
Stock Position:  -0.006321986183994135
Bond Position:  [5.13995437]


portfolio before change:  [4.5485976]
curr_Stock_Price:  93.74299525581054
curr_Factors:  [9.37429953e+01 4.89681885e-02]
mat_Sqrt:  [[ 2.07441596e+01  0.00000000e+00]
 [-8.85150279e-03  2.02813408e-02]]
grads:  [-0.05341   28.9490516]
Stock Position:  -0.05340999636243996
Bond Position:  [9.55541063]


portfolio before change:  [4.45170804]
curr_Stock_Price:  95.60179908838145
curr_Factors:  [9.56017991e+01 4.61954519e-02]
mat_Sqrt:  [[ 2.05478163e+01  0.00000000e+00]
 [-8.59725090e-03  1.96987765e-02]]
grads:  [0.00183414 0.13880021]
Stock Position:  0.0018341438736605659
Bond Position:  [4.27636059]


portfolio before change:  [4.45379026]
curr_Stock_Price:  96.15409651963304
curr_Factors:  [9.61540965e+01 4.58471800e-02]
mat_Sqrt:  [[ 2.05884715e+01  0.00000000e+00]
 [-8.56478184e-03  1.96243806e-02]]
grads:  [-6.83848920e-04 -3.76708733e+00]
Stock Position:  -0.0006838489197272984
Bond Position:  [4.51954513]


portfolio before change:  [4.452741]
curr_Stock_Price:  99.34088757043422
curr_Factors:  [9.93408876e+01 4.50818424e-02]
mat_Sqrt:  [[ 2.10925392e+01  0.00000000e+00]
 [-8.49299405e-03  1.94598940e-02]]
grads:  [-1.65778446e-04  2.60627530e+00]
Stock Position:  -0.00016577844579888123
Bond Position:  [4.46920958]


portfolio before change:  [4.4541279]
curr_Stock_Price:  97.71547332583191
curr_Factors:  [9.77154733e+01 4.56315306e-02]
mat_Sqrt:  [[ 2.08735280e+01  0.00000000e+00]
 [-8.54461521e-03  1.95781730e-02]]
grads:  [ 0.00230035 -0.43882455]
Stock Position:  0.002300352787932483
Bond Position:  [4.22934784]


portfolio before change:  [4.45099315]
curr_Stock_Price:  95.89304589341924
curr_Factors:  [9.58930459e+01 4.69467398e-02]
mat_Sqrt:  [[ 2.07773346e+01  0.00000000e+00]
 [-8.66687855e-03  1.98583135e-02]]
grads:  [ 0.00577768 -1.70876261]
Stock Position:  0.005777684329207125
Bond Position:  [3.8969534]


portfolio before change:  [4.45583138]
curr_Stock_Price:  96.56180389553828
curr_Factors:  [9.65618039e+01 4.67217889e-02]
mat_Sqrt:  [[ 2.08720498e+01  0.00000000e+00]
 [-8.64608942e-03  1.98106796e-02]]
grads:  [-0.00498145 -4.26358851]
Stock Position:  -0.004981450819447974
Bond Position:  [4.93684926]


portfolio before change:  [4.45981358]
curr_Stock_Price:  96.01019171753774
curr_Factors:  [9.60101917e+01 4.84108335e-02]
mat_Sqrt:  [[ 2.11246060e+01  0.00000000e+00]
 [-8.80098481e-03  2.01655895e-02]]
grads:  [0.00483051 3.68710618]
Stock Position:  0.004830506770475018
Bond Position:  [3.99603569]


portfolio before change:  [4.46114906]
curr_Stock_Price:  96.07982274430165
curr_Factors:  [9.60798227e+01 4.84698289e-02]
mat_Sqrt:  [[ 2.11528036e+01  0.00000000e+00]
 [-8.80634580e-03  2.01778731e-02]]
grads:  [-0.00945243 -6.85014377]
Stock Position:  -0.009452429914907775
Bond Position:  [5.36933685]


portfolio before change:  [4.49665843]
curr_Stock_Price:  92.46521110131938
curr_Factors:  [9.24652111e+01 4.85917130e-02]
mat_Sqrt:  [[ 2.03825948e+01  0.00000000e+00]
 [-8.81741123e-03  2.02032272e-02]]
grads:  [ -0.01508536 -12.08318558]
Stock Position:  -0.015085361669964437
Bond Position:  [5.89152958]


portfolio before change:  [4.49143895]
curr_Stock_Price:  92.90885627302654
curr_Factors:  [9.29088563e+01 4.92528947e-02]
mat_Sqrt:  [[ 2.06192561e+01  0.00000000e+00]
 [-8.87719728e-03  2.03402142e-02]]
grads:  [ 8.93449768e-03 -2.02793094e+01]
Stock Position:  0.008934497682056494
Bond Position:  [3.66134499]


portfolio before change:  [4.50309738]
curr_Stock_Price:  94.11127177613311
curr_Factors:  [9.41112718e+01 4.95657853e-02]
mat_Sqrt:  [[ 2.09523451e+01  0.00000000e+00]
 [-8.90534988e-03  2.04047199e-02]]
grads:  [-0.01351457 -8.71073848]
Stock Position:  -0.01351456904695754
Bond Position:  [5.77497066]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.48262267]
Stock Price:  95.73312349835464
PL:  [4.48262267]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [-2.95097405e-03  1.22926668e-01]
 [ 2.79200000e-04  3.30886695e-02]
 [ 8.36825965e-01 -3.19416160e-01]
 [ 2.35995169e-01 -1.07190317e-01]
 [ 1.62984139e-01 -2.71035283e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-7.85232398e-01 -7.45464394e-03]
 [-1.55574170e+00  6.57230804e-01]
 [ 9.83940249e-05 -6.89010154e-02]
 [ 1.91640345e-01  9.21229545e-01]
 [-7.73500472e-01 -2.06065011e-01]
 [-4.13466589e-02 -1.70492635e-01]
 [-9.84484884e-02 -1.35161036e-01]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.13508182e-01 -6.03261479e-02]
 [ 9.67022330e-02  1.62537481e-02]
 [-4.27038166e-02 -7.06921087e-01]
 [-3.94727503e-01  1.30561013e-01]
 [-2.07789118e-01 -9.54435586e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.46349735]
curr_Stock_Price:  99.67448457099127
curr_Factors:  [9.96744846e+01 3.98321628e-02]
mat_Sqrt:  [[ 1.98930302e+01  0.00000000e+00]
 [-7.98319864e-03  1.82918060e-02]]
grads:  [2.54856206e-03 6.72031333e+00]
Stock Position:  0.002548562063856196
Bond Position:  [0.20947074]


portfolio before change:  [0.46883441]
curr_Stock_Price:  101.74807618516029
curr_Factors:  [1.01748076e+02 3.88821114e-02]
mat_Sqrt:  [[ 2.00632427e+01  0.00000000e+00]
 [-7.88741898e-03  1.80723473e-02]]
grads:  [7.33693927e-04 1.83090049e+00]
Stock Position:  0.000733693926607907
Bond Position:  [0.39418246]


portfolio before change:  [0.46958044]
curr_Stock_Price:  102.63056199495655
curr_Factors:  [1.02630562e+02 3.99736148e-02]
mat_Sqrt:  [[ 2.05193415e+01  0.00000000e+00]
 [-7.99736105e-03  1.83242562e-02]]
grads:  [  0.03398848 -17.43133018]
Stock Position:  0.03398848472725977
Bond Position:  [-3.01867685]


portfolio before change:  [0.43505252]
curr_Stock_Price:  101.63689732394711
curr_Factors:  [1.01636897e+02 4.03542159e-02]
mat_Sqrt:  [[ 2.04171846e+01  0.00000000e+00]
 [-8.03534351e-03  1.84112849e-02]]
grads:  [ 0.00926736 -5.82199001]
Stock Position:  0.009267363892490181
Bond Position:  [-0.50685359]


portfolio before change:  [0.44593395]
curr_Stock_Price:  102.82473948633155
curr_Factors:  [1.02824739e+02 3.91242222e-02]
mat_Sqrt:  [[ 2.03385729e+01  0.00000000e+00]
 [-7.91193753e-03  1.81285263e-02]]
grads:  [ 0.00743195 -1.49507621]
Stock Position:  0.007431946677272565
Bond Position:  [-0.31825403]


portfolio before change:  [0.45703152]
curr_Stock_Price:  104.3286708338465
curr_Factors:  [1.04328671e+02 3.82687765e-02]
mat_Sqrt:  [[ 2.04091991e+01  0.00000000e+00]
 [-7.82496278e-03  1.79292421e-02]]
grads:  [-2.84000441e-05 -1.07930809e+00]
Stock Position:  -2.840004414998857e-05
Bond Position:  [0.45999446]


portfolio before change:  [0.45703972]
curr_Stock_Price:  108.08962648747666
curr_Factors:  [1.08089626e+02 3.83709053e-02]
mat_Sqrt:  [[ 2.11731288e+01  0.00000000e+00]
 [-7.83539715e-03  1.79531503e-02]]
grads:  [-0.03723993 -0.41522762]
Stock Position:  -0.03723993179468393
Bond Position:  [4.48229004]


portfolio before change:  [0.46288388]
curr_Stock_Price:  107.96278819482534
curr_Factors:  [1.07962788e+02 3.81379916e-02]
mat_Sqrt:  [[ 2.10839997e+01  0.00000000e+00]
 [-7.81158028e-03  1.78985790e-02]]
grads:  [-0.0601832  36.71971979]
Stock Position:  -0.06018320409279216
Bond Position:  [6.9604304]


portfolio before change:  [0.54831525]
curr_Stock_Price:  106.57218361865706
curr_Factors:  [1.06572184e+02 3.70045138e-02]
mat_Sqrt:  [[ 2.05008192e+01  0.00000000e+00]
 [-7.69462293e-03  1.76305960e-02]]
grads:  [-1.46201350e-03 -3.90803665e+00]
Stock Position:  -0.0014620134984107884
Bond Position:  [0.70412522]


portfolio before change:  [0.54596543]
curr_Stock_Price:  108.29984969026285
curr_Factors:  [1.08299850e+02 3.38753004e-02]
mat_Sqrt:  [[ 1.99328515e+01  0.00000000e+00]
 [-7.36209757e-03  1.68686847e-02]]
grads:  [2.97848946e-02 5.46118184e+01]
Stock Position:  0.029784894563323845
Bond Position:  [-2.67973418]


portfolio before change:  [0.58638903]
curr_Stock_Price:  109.67952961100907
curr_Factors:  [1.09679530e+02 3.34681272e-02]
mat_Sqrt:  [[ 2.00650980e+01  0.00000000e+00]
 [-7.31771847e-03  1.67669994e-02]]
grads:  [ -0.04303167 -12.28991579]
Stock Position:  -0.04303166704025717
Bond Position:  [5.30608203]


portfolio before change:  [0.558797]
curr_Stock_Price:  110.3515630190761
curr_Factors:  [1.10351563e+02 3.17085897e-02]
mat_Sqrt:  [[ 1.96501990e+01  0.00000000e+00]
 [-7.12276236e-03  1.63202988e-02]]
grads:  [-5.89081797e-03 -1.04466614e+01]
Stock Position:  -0.005890817973803832
Bond Position:  [1.20885797]


portfolio before change:  [0.56035057]
curr_Stock_Price:  110.13914442095205
curr_Factors:  [1.10139144e+02 3.13055977e-02]
mat_Sqrt:  [[ 1.94873461e+01  0.00000000e+00]
 [-7.07735518e-03  1.62162579e-02]]
grads:  [-8.07896569e-03 -8.33490911e+00]
Stock Position:  -0.008078965690382184
Bond Position:  [1.45016094]


portfolio before change:  [0.56262621]
curr_Stock_Price:  109.90234965724909
curr_Factors:  [1.09902350e+02 3.44037461e-02]
mat_Sqrt:  [[ 2.03849591e+01  0.00000000e+00]
 [-7.41929874e-03  1.69997490e-02]]
grads:  [7.46811122e-03 8.74001664e+00]
Stock Position:  0.007468111221139621
Bond Position:  [-0.25813676]


portfolio before change:  [0.56351826]
curr_Stock_Price:  110.03043887655434
curr_Factors:  [1.10030439e+02 3.45159631e-02]
mat_Sqrt:  [[ 2.04419745e+01  0.00000000e+00]
 [-7.43138889e-03  1.70274511e-02]]
grads:  [-0.00684066 -3.54287601]
Stock Position:  -0.006840663599251727
Bond Position:  [1.31619947]


portfolio before change:  [0.56498632]
curr_Stock_Price:  109.86393852752119
curr_Factors:  [1.09863939e+02 3.41461356e-02]
mat_Sqrt:  [[ 2.03013979e+01  0.00000000e+00]
 [-7.39146920e-03  1.69359835e-02]]
grads:  [0.00511275 0.95971681]
Stock Position:  0.005112748912964978
Bond Position:  [0.00327959]


portfolio before change:  [0.57263569]
curr_Stock_Price:  111.35991497959226
curr_Factors:  [1.11359915e+02 3.49503825e-02]
mat_Sqrt:  [[ 2.08187599e+01  0.00000000e+00]
 [-7.47800856e-03  1.71342701e-02]]
grads:  [-1.68708162e-02 -4.12577298e+01]
Stock Position:  -0.016870816229562467
Bond Position:  [2.45136835]


portfolio before change:  [0.56913887]
curr_Stock_Price:  111.60351549262444
curr_Factors:  [1.11603515e+02 3.51396399e-02]
mat_Sqrt:  [[ 2.09207152e+01  0.00000000e+00]
 [-7.49822805e-03  1.71805988e-02]]
grads:  [-0.01614409  7.59932842]
Stock Position:  -0.01614409458149113
Bond Position:  [2.37087658]


portfolio before change:  [0.53778402]
curr_Stock_Price:  113.58242160344292
curr_Factors:  [1.13582422e+02 3.32918063e-02]
mat_Sqrt:  [[ 2.07242968e+01  0.00000000e+00]
 [-7.29841695e-03  1.67227741e-02]]
grads:  [-0.01203631 -5.70739987]
Stock Position:  -0.012036311993582703
Bond Position:  [1.90489748]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.51753428]
Stock Price:  115.30437937697533
PL:  [-14.7868451]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.62540385e-01 -1.21018619e-01]
 [ 4.19103948e-03  3.94982166e-01]
 [ 4.17087239e-01 -1.91310347e-01]
 [ 1.66985583e-02  6.42995706e-02]
 [ 3.60775545e-01 -1.50597576e-02]
 [-2.30783549e-01 -2.83362040e-01]
 [-4.26520862e-02 -9.86242161e-02]
 [-1.26096217e+00  7.05257233e-01]
 [ 6.01791702e-02 -3.10832460e-02]
 [ 1.75170801e-02 -7.71449393e-02]
 [ 1.15927718e-01  3.39092926e-01]
 [ 6.94348130e-02 -4.40678485e-02]
 [ 1.18717033e-01 -3.67192109e-02]
 [-6.43213442e-02 -7.82458621e-02]
 [ 5.21811591e-02  4.16375677e-02]
 [-1.43633820e-01 -1.40388423e-01]
 [-1.95275473e-01 -3.22979280e-01]
 [ 2.63338699e-01 -3.39425108e-01]
 [-2.54338951e-01 -1.90249119e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.45370393]
curr_Stock_Price:  96.37322393418745
curr_Factors:  [9.63732239e+01 4.26390629e-02]
mat_Sqrt:  [[ 1.99003270e+01  0.00000000e+00]
 [-8.25969132e-03  1.89253303e-02]]
grads:  [ 5.51365462e-03 -6.39453139e+00]
Stock Position:  0.00551365461665049
Bond Position:  [-21.98507261]


portfolio before change:  [-21.47060601]
curr_Stock_Price:  94.3047016644359
curr_Factors:  [9.43047017e+01 4.35895409e-02]
mat_Sqrt:  [[ 1.96890378e+01  0.00000000e+00]
 [-8.35124335e-03  1.91351024e-02]]
grads:  [8.96820815e-03 2.06417587e+01]
Stock Position:  0.008968208149429033
Bond Position:  [-22.3163502]


portfolio before change:  [-21.47051773]
curr_Stock_Price:  94.93671863849517
curr_Factors:  [9.49367186e+01 4.68309516e-02]
mat_Sqrt:  [[ 2.05447428e+01  0.00000000e+00]
 [-8.65618406e-03  1.98338093e-02]]
grads:  [ 0.01623737 -9.64566835]
Stock Position:  0.016237368474534112
Bond Position:  [-23.01204021]


portfolio before change:  [-21.48658801]
curr_Stock_Price:  94.30136018907601
curr_Factors:  [9.43013602e+01 5.08940624e-02]
mat_Sqrt:  [[ 2.12741156e+01  0.00000000e+00]
 [-9.02388496e-03  2.06763179e-02]]
grads:  [2.10402126e-03 3.10981727e+00]
Stock Position:  0.0021040212591167387
Bond Position:  [-21.68500008]


portfolio before change:  [-21.48951951]
curr_Stock_Price:  95.4850103439833
curr_Factors:  [9.54850103e+01 5.04861937e-02]
mat_Sqrt:  [[ 2.14546539e+01  0.00000000e+00]
 [-8.98765319e-03  2.05933005e-02]]
grads:  [ 0.01650938 -0.73129402]
Stock Position:  0.016509375033130654
Bond Position:  [-23.06591736]


portfolio before change:  [-21.48762913]
curr_Stock_Price:  95.94884255565722
curr_Factors:  [9.59488426e+01 4.86206877e-02]
mat_Sqrt:  [[ 2.11568150e+01  0.00000000e+00]
 [-8.82003970e-03  2.02092498e-02]]
grads:  [ -0.0167536  -14.02140323]
Stock Position:  -0.016753603128106122
Bond Position:  [-19.8801403]


portfolio before change:  [-21.53669308]
curr_Stock_Price:  98.58071141563049
curr_Factors:  [9.85807114e+01 4.88343140e-02]
mat_Sqrt:  [[ 2.17848460e+01  0.00000000e+00]
 [-8.83939491e-03  2.02535981e-02]]
grads:  [-3.93370800e-03 -4.86946642e+00]
Stock Position:  -0.003933708001228801
Bond Position:  [-21.14890534]


portfolio before change:  [-21.53955528]
curr_Stock_Price:  97.96407030132096
curr_Factors:  [9.79640703e+01 4.91654280e-02]
mat_Sqrt:  [[ 2.17218461e+01  0.00000000e+00]
 [-8.86931140e-03  2.03221454e-02]]
grads:  [-0.04388037 34.70387688]
Stock Position:  -0.04388037145068895
Bond Position:  [-17.24085548]


portfolio before change:  [-21.52380536]
curr_Stock_Price:  97.50690291235266
curr_Factors:  [9.75069029e+01 4.70779563e-02]
mat_Sqrt:  [[ 2.11565166e+01  0.00000000e+00]
 [-8.67898209e-03  1.98860462e-02]]
grads:  [ 0.00220326 -1.56306818]
Stock Position:  0.0022032610716246357
Bond Position:  [-21.73863852]


portfolio before change:  [-21.53149329]
curr_Stock_Price:  96.48450916126308
curr_Factors:  [9.64845092e+01 4.77439897e-02]
mat_Sqrt:  [[ 2.10822494e+01  0.00000000e+00]
 [-8.74015924e-03  2.00262207e-02]]
grads:  [-7.66129430e-04 -3.85219661e+00]
Stock Position:  -0.0007661294296600244
Bond Position:  [-21.45757367]


portfolio before change:  [-21.53617878]
curr_Stock_Price:  95.5974796123409
curr_Factors:  [9.55974796e+01 4.49230805e-02]
mat_Sqrt:  [[ 2.02619485e+01  0.00000000e+00]
 [-8.47802623e-03  1.94255985e-02]]
grads:  [1.30254009e-02 1.74559834e+01]
Stock Position:  0.013025400946422868
Bond Position:  [-22.78137428]


portfolio before change:  [-21.54708018]
curr_Stock_Price:  95.19784913368281
curr_Factors:  [9.51978491e+01 4.58849139e-02]
mat_Sqrt:  [[ 2.03921068e+01  0.00000000e+00]
 [-8.56830568e-03  1.96324547e-02]]
grads:  [ 0.00246184 -2.24464282]
Stock Position:  0.0024618362250509447
Bond Position:  [-21.7814417]


portfolio before change:  [-21.55309271]
curr_Stock_Price:  94.96773964534454
curr_Factors:  [9.49677396e+01 4.41907116e-02]
mat_Sqrt:  [[ 1.99637259e+01  0.00000000e+00]
 [-8.40863476e-03  1.92666026e-02]]
grads:  [ 0.0051439  -1.90584773]
Stock Position:  0.005143902318469304
Bond Position:  [-22.04159749]


portfolio before change:  [-21.54890953]
curr_Stock_Price:  96.8523541064332
curr_Factors:  [9.68523541e+01 4.06275124e-02]
mat_Sqrt:  [[ 1.95218197e+01  0.00000000e+00]
 [-8.06250705e-03  1.84735244e-02]]
grads:  [-0.00504413 -4.23556763]
Stock Position:  -0.005044132137810294
Bond Position:  [-21.06037346]


portfolio before change:  [-21.5541621]
curr_Stock_Price:  96.84974087105634
curr_Factors:  [9.68497409e+01 3.94254110e-02]
mat_Sqrt:  [[ 1.92303229e+01  0.00000000e+00]
 [-7.94233326e-03  1.81981717e-02]]
grads:  [0.00365846 2.28800829]
Stock Position:  0.0036584556405513556
Bond Position:  [-21.90848258]


portfolio before change:  [-21.5600706]
curr_Stock_Price:  96.73201551469333
curr_Factors:  [9.67320155e+01 4.01483091e-02]
mat_Sqrt:  [[ 1.93822355e+01  0.00000000e+00]
 [-8.01481719e-03  1.83642532e-02]]
grads:  [-0.01057176 -7.64465734]
Stock Position:  -0.010571760439674931
Bond Position:  [-20.5374429]


portfolio before change:  [-21.55527896]
curr_Stock_Price:  95.79303853617255
curr_Factors:  [9.57930385e+01 4.04531239e-02]
mat_Sqrt:  [[ 1.92668174e+01  0.00000000e+00]
 [-8.04518479e-03  1.84338341e-02]]
grads:  [-1.74515168e-02 -1.75210039e+01]
Stock Position:  -0.0174515167619137
Bond Position:  [-19.88354514]


portfolio before change:  [-21.54508965]
curr_Stock_Price:  94.92429900206429
curr_Factors:  [9.49242990e+01 3.99734748e-02]
mat_Sqrt:  [[ 1.89785640e+01  0.00000000e+00]
 [-7.99734704e-03  1.83242241e-02]]
grads:  [ 6.07008184e-03 -1.85233005e+01]
Stock Position:  0.006070081843100905
Bond Position:  [-22.12128791]


portfolio before change:  [-21.5622285]
curr_Stock_Price:  93.0119955214449
curr_Factors:  [9.30119955e+01 4.00905385e-02]
mat_Sqrt:  [[ 1.86234401e+01  0.00000000e+00]
 [-8.00904873e-03  1.83510360e-02]]
grads:  [ -0.01811537 -10.3672141 ]
Stock Position:  -0.018115368158120426
Bond Position:  [-19.87728196]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.59519461]
Stock Price:  94.55743279907226
PL:  [-21.59519461]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 5.58762904e-02  6.12301340e-02]
 [ 4.34512260e-02 -5.53682865e-02]
 [ 5.89981502e-01 -2.44078316e-01]
 [-2.77639163e-02 -9.93155222e-02]
 [ 2.31915821e-01 -6.87976125e-03]
 [ 3.33674286e-02 -6.67982814e-02]
 [-6.75659869e-02 -1.34405584e-01]
 [-1.29087571e+00  7.38294930e-01]
 [ 8.50212203e-02 -7.45673574e-02]
 [ 8.75916065e-02  1.74254216e-01]
 [-1.40685148e-01 -7.49731574e-02]
 [ 3.90046982e-02 -8.78818806e-03]
 [ 9.52138886e-02 -1.95855856e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.16948833e-01 -6.22789020e-02]
 [-1.41363753e-01 -1.30194689e-01]
 [-1.76149270e-01 -4.62235597e-01]
 [ 4.05813272e-02 -1.79668137e-01]
 [ 1.02092966e-01 -6.18385999e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.13709593]
curr_Stock_Price:  98.37902719567188
curr_Factors:  [9.83790272e+01 4.10697567e-02]
mat_Sqrt:  [[ 1.99371735e+01  0.00000000e+00]
 [-8.10626984e-03  1.85737976e-02]]
grads:  [0.00414298 3.2965867 ]
Stock Position:  0.004142980028704722
Bond Position:  [-8.54467827]


portfolio before change:  [-8.13980128]
curr_Stock_Price:  98.24170704021999
curr_Factors:  [9.82417070e+01 4.25831492e-02]
mat_Sqrt:  [[ 2.02728491e+01  0.00000000e+00]
 [-8.25427397e-03  1.89129176e-02]]
grads:  [ 9.51347517e-04 -2.92753808e+00]
Stock Position:  0.0009513475173633681
Bond Position:  [-8.23326328]


portfolio before change:  [-8.14183418]
curr_Stock_Price:  98.26868977500872
curr_Factors:  [9.82686898e+01 4.16577163e-02]
mat_Sqrt:  [[ 2.00568578e+01  0.00000000e+00]
 [-8.16408881e-03  1.87062775e-02]]
grads:  [  0.02410432 -13.04793625]
Stock Position:  0.02410432367585854
Bond Position:  [-10.51053449]


portfolio before change:  [-8.11512305]
curr_Stock_Price:  99.48586131769453
curr_Factors:  [9.94858613e+01 4.24230064e-02]
mat_Sqrt:  [[ 2.04909496e+01  0.00000000e+00]
 [-8.23873839e-03  1.88773212e-02]]
grads:  [-3.47025223e-03 -5.26110254e+00]
Stock Position:  -0.0034702522345814706
Bond Position:  [-7.76988202]


portfolio before change:  [-8.11411902]
curr_Stock_Price:  98.63671713928191
curr_Factors:  [9.86367171e+01 4.10319393e-02]
mat_Sqrt:  [[ 1.99801908e+01  0.00000000e+00]
 [-8.10253681e-03  1.85652441e-02]]
grads:  [ 0.01145701 -0.37057209]
Stock Position:  0.011457010074863513
Bond Position:  [-9.24420088]


portfolio before change:  [-8.10931334]
curr_Stock_Price:  99.25790996250296
curr_Factors:  [9.92579100e+01 4.17409495e-02]
mat_Sqrt:  [[ 2.02789885e+01  0.00000000e+00]
 [-8.17224077e-03  1.87249560e-02]]
grads:  [ 2.07814533e-04 -3.56733984e+00]
Stock Position:  0.00020781453313002967
Bond Position:  [-8.12994058]


portfolio before change:  [-8.11123299]
curr_Stock_Price:  99.80212485421136
curr_Factors:  [9.98021249e+01 4.08137044e-02]
mat_Sqrt:  [[ 2.01624264e+01  0.00000000e+00]
 [-8.08096077e-03  1.85158072e-02]]
grads:  [-6.26042671e-03 -7.25896432e+00]
Stock Position:  -0.006260426712143868
Bond Position:  [-7.4864291]


portfolio before change:  [-8.11572695]
curr_Stock_Price:  100.22096606466913
curr_Factors:  [1.00220966e+02 4.16429891e-02]
mat_Sqrt:  [[ 2.04517056e+01  0.00000000e+00]
 [-8.16264557e-03  1.87029706e-02]]
grads:  [-0.04736316 39.47474156]
Stock Position:  -0.047363159075971856
Bond Position:  [-3.36894539]


portfolio before change:  [-8.1149369]
curr_Stock_Price:  100.18650052843316
curr_Factors:  [1.00186501e+02 4.25014754e-02]
mat_Sqrt:  [[ 2.06543347e+01  0.00000000e+00]
 [-8.24635439e-03  1.88947716e-02]]
grads:  [ 2.54074306e-03 -3.94645456e+00]
Stock Position:  0.0025407430570594442
Bond Position:  [-8.36948505]


portfolio before change:  [-8.1139726]
curr_Stock_Price:  101.38966375474054
curr_Factors:  [1.01389664e+02 4.22787284e-02]
mat_Sqrt:  [[ 2.08475316e+01  0.00000000e+00]
 [-8.22471674e-03  1.88451935e-02]]
grads:  [7.84948474e-03 9.24661324e+00]
Stock Position:  0.00784948473950007
Bond Position:  [-8.90982922]


portfolio before change:  [-8.11568246]
curr_Stock_Price:  101.45563963044462
curr_Factors:  [1.01455640e+02 4.25607546e-02]
mat_Sqrt:  [[ 2.09305602e+01  0.00000000e+00]
 [-8.25210321e-03  1.89079438e-02]]
grads:  [-0.00828483 -3.96516714]
Stock Position:  -0.008284829170342357
Bond Position:  [-7.27513982]


portfolio before change:  [-8.10161556]
curr_Stock_Price:  99.53816991854173
curr_Factors:  [9.95381699e+01 4.33716451e-02]
mat_Sqrt:  [[ 2.07296801e+01  0.00000000e+00]
 [-8.33034406e-03  1.90872161e-02]]
grads:  [ 0.00169656 -0.46042273]
Stock Position:  0.0016965634970849
Bond Position:  [-8.27048839]


portfolio before change:  [-8.10000013]
curr_Stock_Price:  101.7092158597193
curr_Factors:  [1.01709216e+02 4.07428504e-02]
mat_Sqrt:  [[ 2.05298611e+01  0.00000000e+00]
 [-8.07394331e-03  1.84997282e-02]]
grads:  [ 0.00422146 -1.05869586]
Stock Position:  0.004221462478233392
Bond Position:  [-8.52936177]


portfolio before change:  [-8.09897001]
curr_Stock_Price:  102.45841741577797
curr_Factors:  [1.02458417e+02 4.07778854e-02]
mat_Sqrt:  [[ 2.06899763e+01  0.00000000e+00]
 [-8.07741398e-03  1.85076805e-02]]
grads:  [7.3580143e-03 8.0279152e+00]
Stock Position:  0.007358014304642185
Bond Position:  [-8.85286051]


portfolio before change:  [-8.10327899]
curr_Stock_Price:  102.17362723382901
curr_Factors:  [1.02173627e+02 4.30112063e-02]
mat_Sqrt:  [[ 2.11899349e+01  0.00000000e+00]
 [-8.29565730e-03  1.90077388e-02]]
grads:  [-0.00680179 -3.27650242]
Stock Position:  -0.006801794115618925
Bond Position:  [-7.40831501]


portfolio before change:  [-8.09390866]
curr_Stock_Price:  100.52367405461742
curr_Factors:  [1.00523674e+02 4.40291015e-02]
mat_Sqrt:  [[ 2.10929957e+01  0.00000000e+00]
 [-8.39324504e-03  1.92313404e-02]]
grads:  [-0.00939579 -6.76992277]
Stock Position:  -0.009395790750257642
Bond Position:  [-7.14940925]


portfolio before change:  [-8.0965872]
curr_Stock_Price:  100.6185000135331
curr_Factors:  [1.00618500e+02 4.14172004e-02]
mat_Sqrt:  [[ 2.04770885e+01  0.00000000e+00]
 [-8.14048651e-03  1.86521978e-02]]
grads:  [-1.84540601e-02 -2.47818301e+01]
Stock Position:  -0.018454060134899555
Bond Position:  [-6.23976735]


portfolio before change:  [-8.13025342]
curr_Stock_Price:  102.35828447893867
curr_Factors:  [1.02358284e+02 3.96609616e-02]
mat_Sqrt:  [[ 2.03847138e+01  0.00000000e+00]
 [-7.96602402e-03  1.82524540e-02]]
grads:  [-1.85591404e-03 -9.84350581e+00]
Stock Position:  -0.0018559140364563318
Bond Position:  [-7.94028525]


portfolio before change:  [-8.13006652]
curr_Stock_Price:  101.18785004956258
curr_Factors:  [1.01187850e+02 4.16603342e-02]
mat_Sqrt:  [[ 2.06533138e+01  0.00000000e+00]
 [-8.16434533e-03  1.87068652e-02]]
grads:  [ 0.00363643 -3.30566341]
Stock Position:  0.0036364328155270775
Bond Position:  [-8.49802934]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.13566676]
Stock Price:  100.23211367503116
PL:  [-8.36778044]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.52606554e-02  2.78931791e-02]
 [ 4.53669217e-02 -5.24895445e-02]
 [ 6.89308748e-01 -2.74393359e-01]
 [ 2.16805363e-01 -1.13174819e-01]
 [ 7.23079066e-02 -1.11405190e-02]
 [ 5.72752778e-04 -1.26895904e-01]
 [-4.15786159e-02 -5.58163744e-02]
 [-1.36264335e+00  5.88419776e-01]
 [-4.37831783e-02  9.67159061e-02]
 [ 2.49298880e-02 -4.14218423e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 1.03577108e-01 -1.19717044e-01]
 [ 8.87319865e-02 -4.61061323e-04]
 [-1.19860563e-01 -1.98973332e-01]
 [ 1.25106561e-01  1.78925278e-01]
 [-7.70751869e-02 -1.15925424e-01]
 [-1.97323489e-01 -2.94482069e-01]
 [ 2.71762540e-01 -3.45000671e-01]
 [-1.67752219e-01 -1.68031007e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.10200169]
curr_Stock_Price:  100.82502808025482
curr_Factors:  [1.00825028e+02 4.19215717e-02]
mat_Sqrt:  [[ 2.06436805e+01  0.00000000e+00]
 [-8.18990322e-03  1.87654257e-02]]
grads:  [1.32894116e-03 1.48641334e+00]
Stock Position:  0.0013289411577392994
Bond Position:  [7.96801116]


portfolio before change:  [8.10083216]
curr_Stock_Price:  98.44585412208208
curr_Factors:  [9.84458541e+01 4.51166493e-02]
mat_Sqrt:  [[ 2.09105690e+01  0.00000000e+00]
 [-8.49627205e-03  1.94674049e-02]]
grads:  [ 1.07403134e-03 -2.69627846e+00]
Stock Position:  0.0010740313390407332
Bond Position:  [7.99509823]


portfolio before change:  [8.10397816]
curr_Stock_Price:  99.51377350125641
curr_Factors:  [9.95137735e+01 4.42817883e-02]
mat_Sqrt:  [[ 2.09409206e+01  0.00000000e+00]
 [-8.41729537e-03  1.92864466e-02]]
grads:  [  0.02719812 -14.22726359]
Stock Position:  0.027198119824047313
Bond Position:  [5.39739063]


portfolio before change:  [8.15635481]
curr_Stock_Price:  101.3899008217885
curr_Factors:  [1.01389901e+02 4.37494099e-02]
mat_Sqrt:  [[ 2.12070763e+01  0.00000000e+00]
 [-8.36654384e-03  1.91701602e-02]]
grads:  [ 0.00789415 -5.90369707]
Stock Position:  0.007894149153365462
Bond Position:  [7.35596781]


portfolio before change:  [8.14853149]
curr_Stock_Price:  100.16588717987855
curr_Factors:  [1.00165887e+02 4.53958593e-02]
mat_Sqrt:  [[ 2.13416485e+01  0.00000000e+00]
 [-8.52252162e-03  1.95275502e-02]]
grads:  [ 0.00316029 -0.57050264]
Stock Position:  0.003160289397806255
Bond Position:  [7.8319783]


portfolio before change:  [8.1431204]
curr_Stock_Price:  97.83403349046607
curr_Factors:  [9.78340335e+01 4.65794268e-02]
mat_Sqrt:  [[ 2.11148028e+01  0.00000000e+00]
 [-8.63290698e-03  1.97804748e-02]]
grads:  [-2.59576946e-03 -6.41521021e+00]
Stock Position:  -0.0025957694604649456
Bond Position:  [8.39707499]


portfolio before change:  [8.15054346]
curr_Stock_Price:  95.78318473270124
curr_Factors:  [9.57831847e+01 4.91834863e-02]
mat_Sqrt:  [[ 2.12421723e+01  0.00000000e+00]
 [-8.87094009e-03  2.03258772e-02]]
grads:  [-0.00310415 -2.74607456]
Stock Position:  -0.0031041495108184913
Bond Position:  [8.44786878]


portfolio before change:  [8.15887594]
curr_Stock_Price:  93.77933378901562
curr_Factors:  [9.37793338e+01 4.89692839e-02]
mat_Sqrt:  [[ 2.07524330e+01  0.00000000e+00]
 [-8.85160179e-03  2.02815676e-02]]
grads:  [-0.05328705 29.01253924]
Stock Position:  -0.053287048539546154
Bond Position:  [13.15609985]


portfolio before change:  [8.3530499]
curr_Stock_Price:  90.19714016751574
curr_Factors:  [9.01971402e+01 5.17392615e-02]
mat_Sqrt:  [[ 2.05164814e+01  0.00000000e+00]
 [-9.09850639e-03  2.08472971e-02]]
grads:  [-7.66650114e-05  4.63925398e+00]
Stock Position:  -7.666501143854355e-05
Bond Position:  [8.35996487]


portfolio before change:  [8.35494374]
curr_Stock_Price:  92.75920359068154
curr_Factors:  [9.27592036e+01 5.25111104e-02]
mat_Sqrt:  [[ 2.12560524e+01  0.00000000e+00]
 [-9.16612113e-03  2.10022220e-02]]
grads:  [ 3.22351197e-04 -1.97226000e+00]
Stock Position:  0.0003223511967825712
Bond Position:  [8.32504269]


portfolio before change:  [8.35685051]
curr_Stock_Price:  92.21710400341746
curr_Factors:  [9.22171040e+01 5.35761447e-02]
mat_Sqrt:  [[ 2.13450516e+01  0.00000000e+00]
 [-9.25860851e-03  2.12141372e-02]]
grads:  [1.26448231e-02 1.64781059e+01]
Stock Position:  0.01264482308428816
Bond Position:  [7.19078154]


portfolio before change:  [8.37398513]
curr_Stock_Price:  93.42998803801942
curr_Factors:  [9.3429988e+01 5.5395800e-02]
mat_Sqrt:  [[ 2.19899738e+01  0.00000000e+00]
 [-9.41452495e-03  2.15713866e-02]]
grads:  [ 2.33416862e-03 -5.54980752e+00]
Stock Position:  0.002334168616334319
Bond Position:  [8.15590379]


portfolio before change:  [8.37583393]
curr_Stock_Price:  93.34840122132843
curr_Factors:  [9.33484012e+01 5.68087317e-02]
mat_Sqrt:  [[ 2.22492016e+01  0.00000000e+00]
 [-9.53383295e-03  2.18447556e-02]]
grads:  [ 0.00397905 -0.02110627]
Stock Position:  0.003979053473439105
Bond Position:  [8.00439565]


portfolio before change:  [8.36827395]
curr_Stock_Price:  90.94548523959624
curr_Factors:  [9.09454852e+01 5.65249501e-02]
mat_Sqrt:  [[ 2.16222676e+01  0.00000000e+00]
 [-9.50999055e-03  2.17901258e-02]]
grads:  [-0.00955957 -9.13135306]
Stock Position:  -0.009559572920324829
Bond Position:  [9.23767394]


portfolio before change:  [8.34791195]
curr_Stock_Price:  93.31710851624827
curr_Factors:  [9.33171085e+01 5.39080414e-02]
mat_Sqrt:  [[ 2.16664645e+01  0.00000000e+00]
 [-9.28724212e-03  2.12797450e-02]]
grads:  [0.00937836 8.40824351]
Stock Position:  0.009378362300150196
Bond Position:  [7.47275029]


portfolio before change:  [8.35423192]
curr_Stock_Price:  93.79177010275741
curr_Factors:  [9.37917701e+01 5.42335643e-02]
mat_Sqrt:  [[ 2.18423220e+01  0.00000000e+00]
 [-9.31524035e-03  2.13438970e-02]]
grads:  [-0.00584504 -5.43131483]
Stock Position:  -0.005845037431912645
Bond Position:  [8.90244832]


portfolio before change:  [8.3511312]
curr_Stock_Price:  94.70307452376184
curr_Factors:  [9.47030745e+01 5.46312997e-02]
mat_Sqrt:  [[ 2.21352711e+01  0.00000000e+00]
 [-9.34933578e-03  2.14220194e-02]]
grads:  [ -0.01472067 -13.74669972]
Stock Position:  -0.014720669098793429
Bond Position:  [9.74522382]


portfolio before change:  [8.35414243]
curr_Stock_Price:  94.66403922389632
curr_Factors:  [9.46640392e+01 5.67913044e-02]
mat_Sqrt:  [[ 2.25593173e+01  0.00000000e+00]
 [-9.53237048e-03  2.18414046e-02]]
grads:  [ 5.37214410e-03 -1.57957181e+01]
Stock Position:  0.005372144096569689
Bond Position:  [7.84559357]


portfolio before change:  [8.35771358]
curr_Stock_Price:  94.96364075687602
curr_Factors:  [9.49636408e+01 5.55331588e-02]
mat_Sqrt:  [[ 2.23786325e+01  0.00000000e+00]
 [-9.42618979e-03  2.15981141e-02]]
grads:  [-0.01077309 -7.77989255]
Stock Position:  -0.010773087342438594
Bond Position:  [9.38076518]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.36687993]
Stock Price:  94.33050160988596
PL:  [8.36687993]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 4.83195852e-02  7.47688694e-02]
 [ 5.39936295e-02 -3.95260736e-02]
 [ 6.51798214e-01 -2.62945005e-01]
 [-1.23452523e-01 -1.37717653e-01]
 [ 2.71567635e-01 -8.53162531e-03]
 [ 9.58716793e-03 -1.09312757e-01]
 [-3.58637604e-02 -8.88712955e-02]
 [-1.27346470e+00  6.93863041e-01]
 [ 8.20081390e-02 -6.22694191e-02]
 [ 4.19309976e-02 -3.24933010e-02]
 [ 2.89527294e-03  1.29366853e-01]
 [ 3.42753582e-02 -8.86112373e-03]
 [ 1.58717182e-01 -2.43767586e-02]
 [ 5.83514934e-02  9.09677382e-02]
 [-1.17303858e-01 -6.24803977e-02]
 [-1.41426552e-01 -1.30476687e-01]
 [-1.80515562e-01 -4.40305716e-01]
 [-1.33975782e-01 -1.12925155e-01]
 [ 1.30415279e-01  3.26822428e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.19906983]
curr_Stock_Price:  98.52031661397241
curr_Factors:  [9.85203166e+01 4.24602507e-02]
mat_Sqrt:  [[ 2.03009834e+01  0.00000000e+00]
 [-8.24235410e-03  1.88856058e-02]]
grads:  [0.00398756 3.95904004]
Stock Position:  0.0039875602846180915
Bond Position:  [-7.59192554]


portfolio before change:  [-7.19710286]
curr_Stock_Price:  99.48962916472742
curr_Factors:  [9.94896292e+01 4.14535340e-02]
mat_Sqrt:  [[ 2.02562287e+01  0.00000000e+00]
 [-8.14405638e-03  1.86603774e-02]]
grads:  [ 1.8139130e-03 -2.1181819e+00]
Stock Position:  0.001813913001380872
Bond Position:  [-7.37756839]


portfolio before change:  [-7.19941355]
curr_Stock_Price:  99.23268782579848
curr_Factors:  [9.92326878e+01 4.17091922e-02]
mat_Sqrt:  [[ 2.02661216e+01  0.00000000e+00]
 [-8.16913138e-03  1.87178314e-02]]
grads:  [  0.02649938 -14.04783487]
Stock Position:  0.02649937743797148
Bond Position:  [-9.829018]


portfolio before change:  [-7.22405035]
curr_Stock_Price:  98.3957158418272
curr_Factors:  [9.83957158e+01 4.17283597e-02]
mat_Sqrt:  [[ 2.00998051e+01  0.00000000e+00]
 [-8.17100823e-03  1.87221319e-02]]
grads:  [-0.0091323  -7.35587453]
Stock Position:  -0.009132299226427547
Bond Position:  [-6.32547123]


portfolio before change:  [-7.22175561]
curr_Stock_Price:  97.97125525619188
curr_Factors:  [9.79712553e+01 3.96206386e-02]
mat_Sqrt:  [[ 1.95011134e+01  0.00000000e+00]
 [-7.96197348e-03  1.82431731e-02]]
grads:  [ 0.01373481 -0.46766126]
Stock Position:  0.013734812107581899
Bond Position:  [-8.5673724]


portfolio before change:  [-7.22115108]
curr_Stock_Price:  98.17123212435382
curr_Factors:  [9.81712321e+01 4.12358116e-02]
mat_Sqrt:  [[ 1.99352421e+01  0.00000000e+00]
 [-8.12264111e-03  1.86113089e-02]]
grads:  [-1.91223313e-03 -5.87345886e+00]
Stock Position:  -0.0019122331286132567
Bond Position:  [-7.0334248]


portfolio before change:  [-7.22308763]
curr_Stock_Price:  98.2643024370501
curr_Factors:  [9.82643024e+01 4.25592424e-02]
mat_Sqrt:  [[ 2.02718190e+01  0.00000000e+00]
 [-8.25195660e-03  1.89076079e-02]]
grads:  [-3.68247041e-03 -4.70029292e+00]
Stock Position:  -0.0036824704123402936
Bond Position:  [-6.86123224]


portfolio before change:  [-7.22185459]
curr_Stock_Price:  97.4636004308955
curr_Factors:  [9.74636004e+01 4.38894700e-02]
mat_Sqrt:  [[ 2.04184429e+01  0.00000000e+00]
 [-8.37992554e-03  1.92008215e-02]]
grads:  [-0.04753732 36.13715378]
Stock Position:  -0.04753731955710463
Bond Position:  [-2.58869627]


portfolio before change:  [-7.30810834]
curr_Stock_Price:  99.26442755805424
curr_Factors:  [9.92644276e+01 4.35986078e-02]
mat_Sqrt:  [[ 2.07266901e+01  0.00000000e+00]
 [-8.35211185e-03  1.91370924e-02]]
grads:  [ 2.64545551e-03 -3.25385998e+00]
Stock Position:  0.0026454555141480294
Bond Position:  [-7.57070797]


portfolio before change:  [-7.30756735]
curr_Stock_Price:  100.18445873200095
curr_Factors:  [1.00184459e+02 4.32001527e-02]
mat_Sqrt:  [[ 2.08229855e+01  0.00000000e+00]
 [-8.31385857e-03  1.90494431e-02]]
grads:  [ 1.33265033e-03 -1.70573496e+00]
Stock Position:  0.0013326503256645592
Bond Position:  [-7.4410782]


portfolio before change:  [-7.3112868]
curr_Stock_Price:  98.78953611960915
curr_Factors:  [9.87895361e+01 4.57167375e-02]
mat_Sqrt:  [[ 2.11226577e+01  0.00000000e+00]
 [-8.55258908e-03  1.95964434e-02]]
grads:  [2.81004395e-03 6.60154757e+00]
Stock Position:  0.0028100439547418367
Bond Position:  [-7.58888974]


portfolio before change:  [-7.31050694]
curr_Stock_Price:  99.74230148923927
curr_Factors:  [9.97423015e+01 4.43915979e-02]
mat_Sqrt:  [[ 2.10150184e+01  0.00000000e+00]
 [-8.42772548e-03  1.93103450e-02]]
grads:  [ 0.00144697 -0.45887962]
Stock Position:  0.0014469674092505791
Bond Position:  [-7.4548308]


portfolio before change:  [-7.31210524]
curr_Stock_Price:  99.92589263803039
curr_Factors:  [9.99258926e+01 4.36217348e-02]
mat_Sqrt:  [[ 2.08703390e+01  0.00000000e+00]
 [-8.35432677e-03  1.91421674e-02]]
grads:  [ 0.00709516 -1.27345865]
Stock Position:  0.0070951550984073505
Bond Position:  [-8.02109494]


portfolio before change:  [-7.31038666]
curr_Stock_Price:  100.4507721469541
curr_Factors:  [1.00450772e+02 4.11251355e-02]
mat_Sqrt:  [[ 2.03707468e+01  0.00000000e+00]
 [-8.11173328e-03  1.85863159e-02]]
grads:  [4.81342536e-03 4.89433940e+00]
Stock Position:  0.004813425360566401
Bond Position:  [-7.79389895]


portfolio before change:  [-7.30686083]
curr_Stock_Price:  101.58812200058539
curr_Factors:  [1.01588122e+02 4.27906970e-02]
mat_Sqrt:  [[ 2.10144299e+01  0.00000000e+00]
 [-8.27436495e-03  1.89589518e-02]]
grads:  [-0.00687968 -3.29556181]
Stock Position:  -0.006879679351855685
Bond Position:  [-6.60796712]


portfolio before change:  [-7.29742262]
curr_Stock_Price:  99.97606854198598
curr_Factors:  [9.99760685e+01 4.59433965e-02]
mat_Sqrt:  [[ 2.14292812e+01  0.00000000e+00]
 [-8.57376431e-03  1.96449620e-02]]
grads:  [-0.00925702 -6.64173783]
Stock Position:  -0.009257018240232298
Bond Position:  [-6.37194233]


portfolio before change:  [-7.29968]
curr_Stock_Price:  100.04781918659461
curr_Factors:  [1.00047819e+02 4.23241703e-02]
mat_Sqrt:  [[ 2.05826767e+01  0.00000000e+00]
 [-8.22913559e-03  1.88553184e-02]]
grads:  [-1.81065240e-02 -2.33518049e+01]
Stock Position:  -0.01810652402235587
Bond Position:  [-5.48816176]


portfolio before change:  [-7.36798218]
curr_Stock_Price:  103.74427538014731
curr_Factors:  [1.03744275e+02 4.15844422e-02]
mat_Sqrt:  [[ 2.11558063e+01  0.00000000e+00]
 [-8.15690551e-03  1.86898185e-02]]
grads:  [-0.00866241 -6.04206802]
Stock Position:  -0.00866241432876949
Bond Position:  [-6.46930628]


portfolio before change:  [-7.35787797]
curr_Stock_Price:  102.39110236133601
curr_Factors:  [1.02391102e+02 4.23922541e-02]
mat_Sqrt:  [[ 2.10816925e+01  0.00000000e+00]
 [-8.23575173e-03  1.88704778e-02]]
grads:  [0.00686278 1.7319245 ]
Stock Position:  0.006862778211052303
Bond Position:  [-8.06056539]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.37322958]
Stock Price:  100.44783354172442
PL:  [-7.82106312]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 4.21808069e-02  8.57672202e-02]
 [ 2.70520395e-02 -8.00115669e-02]
 [ 3.08079436e-01 -1.58040762e-01]
 [ 1.11355738e-01  1.91756154e-01]
 [ 3.96205588e-01 -1.80332996e-02]
 [-1.92877914e-01 -2.58306912e-01]
 [-4.39506278e-02 -5.67332202e-02]
 [-1.29342257e+00  6.69222431e-01]
 [ 1.74864309e-02  2.98537758e-02]
 [ 2.15459502e-02 -5.77293926e-02]
 [ 1.15599372e-01  3.36657484e-01]
 [ 7.50866236e-02 -5.64926809e-02]
 [ 8.83959850e-02  1.43741625e-03]
 [-1.02468320e-01 -1.61187820e-01]
 [ 1.60001958e-01  2.44867925e-01]
 [-2.09493391e-02 -9.66016303e-02]
 [-2.00660459e-01 -2.47930781e-01]
 [ 4.27608393e-01 -4.58830474e-01]
 [-2.58364039e-01 -1.91282053e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.42992464]
curr_Stock_Price:  98.63616848351415
curr_Factors:  [9.86361685e+01 3.95976508e-02]
mat_Sqrt:  [[ 1.96277675e+01  0.00000000e+00]
 [-7.95966339e-03  1.82378800e-02]]
grads:  [4.05612562e-03 4.70269682e+00]
Stock Position:  0.004056125623136381
Bond Position:  [-6.83000533]


portfolio before change:  [-6.43990433]
curr_Stock_Price:  96.59678983797384
curr_Factors:  [9.65967898e+01 4.02477411e-02]
mat_Sqrt:  [[ 1.93790931e+01  0.00000000e+00]
 [-8.02473587e-03  1.83869798e-02]]
grads:  [-4.05997903e-04 -4.35153396e+00]
Stock Position:  -0.00040599790251228134
Bond Position:  [-6.40068624]


portfolio before change:  [-6.44047209]
curr_Stock_Price:  94.05340202641923
curr_Factors:  [9.4053402e+01 3.9910705e-02]
mat_Sqrt:  [[ 1.87896724e+01  0.00000000e+00]
 [-7.99106551e-03  1.83098313e-02]]
grads:  [ 0.01272533 -8.63147013]
Stock Position:  0.012725330527672664
Bond Position:  [-7.63733272]


portfolio before change:  [-6.45384576]
curr_Stock_Price:  93.15251458117541
curr_Factors:  [9.31525146e+01 3.96735185e-02]
mat_Sqrt:  [[ 1.85543157e+01  0.00000000e+00]
 [-7.96728496e-03  1.82553432e-02]]
grads:  [ 0.01051211 10.50411112]
Stock Position:  0.010512108751754064
Bond Position:  [-7.43307512]


portfolio before change:  [-6.43944542]
curr_Stock_Price:  94.69919166909672
curr_Factors:  [9.46991917e+01 3.94360669e-02]
mat_Sqrt:  [[ 1.88058544e+01  0.00000000e+00]
 [-7.94340652e-03  1.82006308e-02]]
grads:  [ 0.0206497 -0.9908063]
Stock Position:  0.020649697831195128
Bond Position:  [-8.39495511]


portfolio before change:  [-6.4097814]
curr_Stock_Price:  96.23737496820138
curr_Factors:  [9.62373750e+01 4.00283383e-02]
mat_Sqrt:  [[ 1.92542918e+01  0.00000000e+00]
 [-8.00283333e-03  1.83367948e-02]]
grads:  [ -0.01587242 -14.08680825]
Stock Position:  -0.01587242448279454
Bond Position:  [-4.88226093]


portfolio before change:  [-6.40275496]
curr_Stock_Price:  95.71778430054148
curr_Factors:  [9.57177843e+01 4.20188630e-02]
mat_Sqrt:  [[ 1.96207130e+01  0.00000000e+00]
 [-8.19940125e-03  1.87871884e-02]]
grads:  [-0.00350196 -3.01978235]
Stock Position:  -0.003501964227065086
Bond Position:  [-6.0675547]


portfolio before change:  [-6.40680596]
curr_Stock_Price:  96.44135713094023
curr_Factors:  [9.64413571e+01 4.02918314e-02]
mat_Sqrt:  [[ 1.93585051e+01  0.00000000e+00]
 [-8.02913010e-03  1.83970482e-02]]
grads:  [-0.05172662 36.37661993]
Stock Position:  -0.05172661599591077
Bond Position:  [-1.41822091]


portfolio before change:  [-6.28474285]
curr_Stock_Price:  94.07472820292374
curr_Factors:  [9.40747282e+01 4.08246870e-02]
mat_Sqrt:  [[ 1.90079116e+01  0.00000000e+00]
 [-8.08204796e-03  1.85182983e-02]]
grads:  [1.60542028e-03 1.61212307e+00]
Stock Position:  0.0016054202802004466
Bond Position:  [-6.43577233]


portfolio before change:  [-6.28570093]
curr_Stock_Price:  94.48027358026818
curr_Factors:  [9.44802736e+01 4.11563825e-02]
mat_Sqrt:  [[ 1.91672470e+01  0.00000000e+00]
 [-8.11481435e-03  1.85933755e-02]]
grads:  [-1.90388443e-04 -3.10483659e+00]
Stock Position:  -0.00019038844279172307
Bond Position:  [-6.26771297]


portfolio before change:  [-6.28749927]
curr_Stock_Price:  95.69471613360398
curr_Factors:  [9.56947161e+01 3.98860590e-02]
mat_Sqrt:  [[ 1.91116649e+01  0.00000000e+00]
 [-7.98859777e-03  1.83041770e-02]]
grads:  [1.37365711e-02 1.83923858e+01]
Stock Position:  0.013736571129128858
Bond Position:  [-7.60201654]


portfolio before change:  [-6.30023466]
curr_Stock_Price:  94.9059712298923
curr_Factors:  [9.49059712e+01 3.96507560e-02]
mat_Sqrt:  [[ 1.88981492e+01  0.00000000e+00]
 [-7.96499903e-03  1.82501055e-02]]
grads:  [ 2.66857859e-03 -3.09547147e+00]
Stock Position:  0.0026685785860075567
Bond Position:  [-6.5534987]


portfolio before change:  [-6.30574571]
curr_Stock_Price:  93.4548341770602
curr_Factors:  [9.34548342e+01 3.97442390e-02]
mat_Sqrt:  [[ 1.86311158e+01  0.00000000e+00]
 [-7.97438289e-03  1.82716066e-02]]
grads:  [0.00477821 0.0786694 ]
Stock Position:  0.004778206842874112
Bond Position:  [-6.75229224]


portfolio before change:  [-6.3106317]
curr_Stock_Price:  92.785606562468
curr_Factors:  [9.27856066e+01 3.90361899e-02]
mat_Sqrt:  [[ 1.83321888e+01  0.00000000e+00]
 [-7.90303130e-03  1.81081196e-02]]
grads:  [-0.00942694 -8.9014113 ]
Stock Position:  -0.009426940420327847
Bond Position:  [-5.43594732]


portfolio before change:  [-6.30092098]
curr_Stock_Price:  91.61132542781733
curr_Factors:  [9.16113254e+01 3.89173347e-02]
mat_Sqrt:  [[ 1.80726031e+01  0.00000000e+00]
 [-7.89099078e-03  1.80805313e-02]]
grads:  [ 0.01476661 13.54318196]
Stock Position:  0.014766609981342936
Bond Position:  [-7.65370969]


portfolio before change:  [-6.29624768]
curr_Stock_Price:  92.0573970422941
curr_Factors:  [9.20573970e+01 3.79918416e-02]
mat_Sqrt:  [[ 1.79433639e+01  0.00000000e+00]
 [-7.79659840e-03  1.78642512e-02]]
grads:  [-3.51716365e-03 -5.40753874e+00]
Stock Position:  -0.0035171636453429954
Bond Position:  [-5.97246675]


portfolio before change:  [-6.29934862]
curr_Stock_Price:  92.5144799697071
curr_Factors:  [9.25144800e+01 3.70634975e-02]
mat_Sqrt:  [[ 1.78107789e+01  0.00000000e+00]
 [-7.70075295e-03  1.76446417e-02]]
grads:  [ -0.01734154 -14.05133556]
Stock Position:  -0.017341539388639506
Bond Position:  [-4.69500512]


portfolio before change:  [-6.28684297]
curr_Stock_Price:  91.72564836382593
curr_Factors:  [9.17256484e+01 4.07226943e-02]
mat_Sqrt:  [[ 1.85101118e+01  0.00000000e+00]
 [-8.07194591e-03  1.84951516e-02]]
grads:  [ 1.22829272e-02 -2.48081489e+01]
Stock Position:  0.012282927233049275
Bond Position:  [-7.41350243]


portfolio before change:  [-6.27400387]
curr_Stock_Price:  92.92183770418724
curr_Factors:  [9.29218377e+01 4.02944310e-02]
mat_Sqrt:  [[ 1.86526398e+01  0.00000000e+00]
 [-8.02938912e-03  1.83976417e-02]]
grads:  [ -0.01832697 -10.39709632]
Stock Position:  -0.01832697004418087
Bond Position:  [-4.57102813]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.23090907]
Stock Price:  90.508034615382
PL:  [-6.23090907]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.71858705e-02  3.55824311e-02]
 [ 6.39157889e-02 -5.89524208e-03]
 [ 7.19917572e-01 -2.83735286e-01]
 [-1.27161791e-01 -1.46634303e-01]
 [ 2.48566394e-01 -7.42984128e-03]
 [-9.42935583e-03 -1.33922304e-01]
 [-3.10297634e-02 -8.19286971e-02]
 [-1.25768022e+00  7.18692090e-01]
 [ 7.64564189e-02 -5.43558594e-02]
 [ 1.36052194e-02 -9.59966054e-02]
 [ 1.15124675e-01  3.33136499e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 9.76554557e-02 -1.09199763e-02]
 [-9.50907496e-02 -1.45187380e-01]
 [ 1.18588609e-01  1.66760702e-01]
 [-3.42227450e-02 -1.01181111e-01]
 [-2.03369869e-01 -2.10198327e-01]
 [ 4.25025914e-01 -4.56828062e-01]
 [-2.41831175e-01 -1.87040018e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.92028387]
curr_Stock_Price:  100.64703279380076
curr_Factors:  [1.00647033e+02 3.71665142e-02]
mat_Sqrt:  [[ 1.94033578e+01  0.00000000e+00]
 [-7.71144752e-03  1.76691460e-02]]
grads:  [1.68606470e-03 2.01381726e+00]
Stock Position:  0.0016860646992782537
Bond Position:  [6.75058646]


portfolio before change:  [6.92321306]
curr_Stock_Price:  101.38326676671494
curr_Factors:  [1.01383267e+02 3.89734373e-02]
mat_Sqrt:  [[ 2.00147715e+01  0.00000000e+00]
 [-7.89667649e-03  1.80935589e-02]]
grads:  [ 0.00306488 -0.32581993]
Stock Position:  0.003064881076456834
Bond Position:  [6.61248541]


portfolio before change:  [6.92164603]
curr_Stock_Price:  100.33253648328679
curr_Factors:  [1.00332536e+02 4.14517553e-02]
mat_Sqrt:  [[ 2.04274076e+01  0.00000000e+00]
 [-8.14388166e-03  1.86599771e-02]]
grads:  [  0.02918067 -15.20555381]
Stock Position:  0.02918066516940043
Bond Position:  [3.99387588]


portfolio before change:  [6.86022466]
curr_Stock_Price:  98.19345016668836
curr_Factors:  [9.81934502e+01 4.39478318e-02]
mat_Sqrt:  [[ 2.05850178e+01  0.00000000e+00]
 [-8.38549526e-03  1.92135834e-02]]
grads:  [-0.00928628 -7.63180401]
Stock Position:  -0.00928628042242381
Bond Position:  [7.77207658]


portfolio before change:  [6.86021698]
curr_Stock_Price:  98.40353931675602
curr_Factors:  [9.84035393e+01 4.28407980e-02]
mat_Sqrt:  [[ 2.03675830e+01  0.00000000e+00]
 [-8.27920750e-03  1.89700475e-02]]
grads:  [ 0.01204481 -0.39166171]
Stock Position:  0.01204481379607419
Bond Position:  [5.67496467]


portfolio before change:  [6.8524161]
curr_Stock_Price:  97.63808156286923
curr_Factors:  [9.76380816e+01 4.44194194e-02]
mat_Sqrt:  [[ 2.05781191e+01  0.00000000e+00]
 [-8.43036601e-03  1.93163952e-02]]
grads:  [-3.29854447e-03 -6.93308987e+00]
Stock Position:  -0.003298544470452714
Bond Position:  [7.17447965]


portfolio before change:  [6.85292593]
curr_Stock_Price:  98.02734776097651
curr_Factors:  [9.80273478e+01 4.40979874e-02]
mat_Sqrt:  [[ 2.05852733e+01  0.00000000e+00]
 [-8.39980832e-03  1.92463787e-02]]
grads:  [-3.24437657e-03 -4.25683700e+00]
Stock Position:  -0.0032443765655770468
Bond Position:  [7.17096356]


portfolio before change:  [6.85332505]
curr_Stock_Price:  98.4569661042937
curr_Factors:  [9.84569661e+01 4.27410946e-02]
mat_Sqrt:  [[ 2.03549139e+01  0.00000000e+00]
 [-8.26956778e-03  1.89479602e-02]]
grads:  [-0.04637786 37.92978684]
Stock Position:  -0.04637785686080191
Bond Position:  [11.41954813]


portfolio before change:  [6.83938603]
curr_Stock_Price:  98.81908431282861
curr_Factors:  [9.88190843e+01 4.03240215e-02]
mat_Sqrt:  [[ 1.98437042e+01  0.00000000e+00]
 [-8.03233680e-03  1.84043957e-02]]
grads:  [ 2.65744624e-03 -2.95341723e+00]
Stock Position:  0.002657446236121119
Bond Position:  [6.57677963]


portfolio before change:  [6.83990634]
curr_Stock_Price:  98.39608919119857
curr_Factors:  [9.83960892e+01 4.04695019e-02]
mat_Sqrt:  [[ 1.97943738e+01  0.00000000e+00]
 [-8.04681322e-03  1.84375653e-02]]
grads:  [-1.42925128e-03 -5.20657710e+00]
Stock Position:  -0.001429251275949214
Bond Position:  [6.98053908]


portfolio before change:  [6.84534466]
curr_Stock_Price:  95.81224443340658
curr_Factors:  [9.58122444e+01 4.17843079e-02]
mat_Sqrt:  [[ 1.95851824e+01  0.00000000e+00]
 [-8.17648413e-03  1.87346787e-02]]
grads:  [1.33017583e-02 1.77818101e+01]
Stock Position:  0.013301758305905867
Bond Position:  [5.57087334]


portfolio before change:  [6.85128938]
curr_Stock_Price:  96.15444152880785
curr_Factors:  [9.61544415e+01 4.13807260e-02]
mat_Sqrt:  [[ 1.95599798e+01  0.00000000e+00]
 [-8.13690123e-03  1.86439829e-02]]
grads:  [ 0.00245483 -0.46081263]
Stock Position:  0.0024548327079613893
Bond Position:  [6.61524631]


portfolio before change:  [6.84735041]
curr_Stock_Price:  93.87608650791151
curr_Factors:  [9.38760865e+01 4.43036629e-02]
mat_Sqrt:  [[ 1.97594473e+01  0.00000000e+00]
 [-8.41937412e-03  1.92912096e-02]]
grads:  [ 0.00470102 -0.5660597 ]
Stock Position:  0.004701021527666828
Bond Position:  [6.40603691]


portfolio before change:  [6.84754339]
curr_Stock_Price:  93.57642108200491
curr_Factors:  [9.35764211e+01 4.42145222e-02]
mat_Sqrt:  [[ 1.96765476e+01  0.00000000e+00]
 [-8.41089981e-03  1.92717925e-02]]
grads:  [-0.00805302 -7.53367287]
Stock Position:  -0.008053024387773939
Bond Position:  [7.60111659]


portfolio before change:  [6.84904216]
curr_Stock_Price:  93.62630910947966
curr_Factors:  [9.36263091e+01 4.32978825e-02]
mat_Sqrt:  [[ 1.94818965e+01  0.00000000e+00]
 [-8.32325730e-03  1.90709783e-02]]
grads:  [0.00982291 8.74421327]
Stock Position:  0.009822911519220292
Bond Position:  [5.92935921]


portfolio before change:  [6.83914328]
curr_Stock_Price:  92.46765012222095
curr_Factors:  [9.24676501e+01 4.39832448e-02]
mat_Sqrt:  [[ 1.93924845e+01  0.00000000e+00]
 [-8.38887309e-03  1.92213230e-02]]
grads:  [-4.04186488e-03 -5.26400348e+00]
Stock Position:  -0.004041864876783037
Bond Position:  [7.21288502]


portfolio before change:  [6.84703826]
curr_Stock_Price:  90.9605389076748
curr_Factors:  [9.09605389e+01 4.47838573e-02]
mat_Sqrt:  [[ 1.92492482e+01  0.00000000e+00]
 [-8.46487871e-03  1.93954737e-02]]
grads:  [ -0.01533088 -10.83749383]
Stock Position:  -0.015330881312899973
Bond Position:  [8.24154349]


portfolio before change:  [6.83693559]
curr_Stock_Price:  91.75392531968959
curr_Factors:  [9.17539253e+01 4.45485168e-02]
mat_Sqrt:  [[ 1.93660602e+01  0.00000000e+00]
 [-8.44260783e-03  1.93444447e-02]]
grads:  [ 1.16518176e-02 -2.36154653e+01]
Stock Position:  0.011651817632927235
Bond Position:  [5.76783559]


portfolio before change:  [6.8563476]
curr_Stock_Price:  93.29616285497852
curr_Factors:  [9.32961629e+01 4.59724132e-02]
mat_Sqrt:  [[ 2.00037967e+01  0.00000000e+00]
 [-8.57647136e-03  1.96511646e-02]]
grads:  [-0.01617004 -9.51801188]
Stock Position:  -0.01617003689994095
Bond Position:  [8.36495]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.86075985]
Stock Price:  93.15264148097238
PL:  [6.86075985]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.88631833e-03  1.55442363e-01]
 [-1.82158735e-02  4.44652883e-02]
 [ 7.30798898e-01 -2.87056306e-01]
 [ 2.11496541e-01 -1.14830420e-01]
 [ 1.85442896e-01 -2.86013760e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-8.62794207e-02 -1.61646544e-01]
 [-1.32768725e+00  7.41857815e-01]
 [ 5.10875688e-02 -7.53135733e-02]
 [ 1.30704288e-01  3.81337578e-01]
 [-3.65606269e-01 -5.78881100e-02]
 [-4.04535392e-02 -2.34984786e-02]
 [-7.18540883e-03 -6.96573157e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15523384e-01 -6.14698830e-02]
 [-9.34143840e-02 -1.04139665e-01]
 [-1.45186577e-01 -5.88846588e-01]
 [-1.35881978e-01 -1.11655020e-01]
 [ 1.56452428e-01  5.29629221e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.12511701]
curr_Stock_Price:  99.43520082263196
curr_Factors:  [9.94352008e+01 4.07337906e-02]
mat_Sqrt:  [[ 2.00686227e+01  0.00000000e+00]
 [-8.07304558e-03  1.84976712e-02]]
grads:  [3.57408321e-03 8.40334773e+00]
Stock Position:  0.0035740832139333264
Bond Position:  [-1.4805067]


portfolio before change:  [-1.11685207]
curr_Stock_Price:  101.85123885237323
curr_Factors:  [1.01851239e+02 3.85658255e-02]
mat_Sqrt:  [[ 2.00017333e+01  0.00000000e+00]
 [-7.85527344e-03  1.79986926e-02]]
grads:  [5.95133053e-05 2.47047324e+00]
Stock Position:  5.9513305254568134e-05
Bond Position:  [-1.12291357]


portfolio before change:  [-1.11719345]
curr_Stock_Price:  100.83261086065245
curr_Factors:  [1.00832611e+02 3.89301511e-02]
mat_Sqrt:  [[ 1.98950052e+01  0.00000000e+00]
 [-7.89229002e-03  1.80835082e-02]]
grads:  [  0.03043564 -15.87392796]
Stock Position:  0.030435641938863695
Bond Position:  [-4.18609869]


portfolio before change:  [-1.10345063]
curr_Stock_Price:  101.31853717345427
curr_Factors:  [1.01318537e+02 3.91342248e-02]
mat_Sqrt:  [[ 2.00432101e+01  0.00000000e+00]
 [-7.91294886e-03  1.81308436e-02]]
grads:  [ 0.00805163 -6.33342951]
Stock Position:  0.008051626268764309
Bond Position:  [-1.91922962]


portfolio before change:  [-1.08949353]
curr_Stock_Price:  103.11158717963211
curr_Factors:  [1.03111587e+02 3.85336523e-02]
mat_Sqrt:  [[ 2.02407947e+01  0.00000000e+00]
 [-7.85199616e-03  1.79911834e-02]]
grads:  [ 0.00854513 -1.58974401]
Stock Position:  0.00854513051729055
Bond Position:  [-1.9705955]


portfolio before change:  [-1.10368901]
curr_Stock_Price:  101.5080100238599
curr_Factors:  [1.01508010e+02 4.02100981e-02]
mat_Sqrt:  [[ 2.03548488e+01  0.00000000e+00]
 [-8.02098230e-03  1.83783793e-02]]
grads:  [-2.84758763e-05 -1.05293159e+00]
Stock Position:  -2.8475876332166393e-05
Bond Position:  [-1.10079848]


portfolio before change:  [-1.10394371]
curr_Stock_Price:  100.78692959426961
curr_Factors:  [1.00786930e+02 4.13618693e-02]
mat_Sqrt:  [[ 2.04976604e+01  0.00000000e+00]
 [-8.13504708e-03  1.86397345e-02]]
grads:  [-7.65100763e-03 -8.67214841e+00]
Stock Position:  -0.007651007627943163
Bond Position:  [-0.33282215]


portfolio before change:  [-1.10690089]
curr_Stock_Price:  101.16256132858811
curr_Factors:  [1.01162561e+02 3.98656064e-02]
mat_Sqrt:  [[ 2.01984947e+01  0.00000000e+00]
 [-7.98654934e-03  1.82994834e-02]]
grads:  [-0.04970241 40.53982277]
Stock Position:  -0.049702414772886325
Bond Position:  [3.92112269]


portfolio before change:  [-1.19137183]
curr_Stock_Price:  102.88182067093739
curr_Factors:  [1.02881821e+02 3.67752276e-02]
mat_Sqrt:  [[ 1.97295112e+01  0.00000000e+00]
 [-7.67074730e-03  1.75758901e-02]]
grads:  [ 9.23389866e-04 -4.28505031e+00]
Stock Position:  0.0009233898662645968
Bond Position:  [-1.28637186]


portfolio before change:  [-1.1909067]
curr_Stock_Price:  103.73385440554999
curr_Factors:  [1.03733854e+02 3.66168619e-02]
mat_Sqrt:  [[ 1.98500258e+01  0.00000000e+00]
 [-7.65421316e-03  1.75380056e-02]]
grads:  [1.49689302e-02 2.17434973e+01]
Stock Position:  0.014968930204033523
Bond Position:  [-2.74369153]


portfolio before change:  [-1.18098632]
curr_Stock_Price:  104.44241492231662
curr_Factors:  [1.04442415e+02 3.69008633e-02]
mat_Sqrt:  [[ 2.00629674e+01  0.00000000e+00]
 [-7.68383897e-03  1.76058869e-02]]
grads:  [-0.0194822  -3.28799739]
Stock Position:  -0.019482198380413752
Bond Position:  [0.85378153]


portfolio before change:  [-1.20413876]
curr_Stock_Price:  105.64176162259051
curr_Factors:  [1.05641762e+02 3.74730227e-02]
mat_Sqrt:  [[ 2.04500794e+01  0.00000000e+00]
 [-7.74317999e-03  1.77418542e-02]]
grads:  [-0.00247965 -1.32446577]
Stock Position:  -0.0024796537529216374
Bond Position:  [-0.94218376]


portfolio before change:  [-1.20357668]
curr_Stock_Price:  105.32008382536188
curr_Factors:  [1.05320084e+02 3.69517913e-02]
mat_Sqrt:  [[ 2.02455204e+01  0.00000000e+00]
 [-7.68913949e-03  1.76180319e-02]]
grads:  [-1.85652693e-03 -3.95375126e+00]
Stock Position:  -0.0018565269278010656
Bond Position:  [-1.00804711]


portfolio before change:  [-1.20412724]
curr_Stock_Price:  105.48087814816446
curr_Factors:  [1.05480878e+02 3.84036575e-02]
mat_Sqrt:  [[ 2.06709307e+01  0.00000000e+00]
 [-7.83874046e-03  1.79608108e-02]]
grads:  [7.36479378e-03 8.27234869e+00]
Stock Position:  0.007364793782310153
Bond Position:  [-1.98097216]


portfolio before change:  [-1.2055792]
curr_Stock_Price:  105.35098280934687
curr_Factors:  [1.05350983e+02 3.89654301e-02]
mat_Sqrt:  [[ 2.07959291e+01  0.00000000e+00]
 [-7.89586526e-03  1.80917001e-02]]
grads:  [-0.00684514 -3.39768417]
Stock Position:  -0.006845139703091168
Bond Position:  [-0.48443701]


portfolio before change:  [-1.1983388]
curr_Stock_Price:  104.2755451472496
curr_Factors:  [1.04275545e+02 3.69761289e-02]
mat_Sqrt:  [[ 2.00513303e+01  0.00000000e+00]
 [-7.69167123e-03  1.76238328e-02]]
grads:  [-0.00692546 -5.9090248 ]
Stock Position:  -0.006925458725952512
Bond Position:  [-0.47618282]


portfolio before change:  [-1.20219626]
curr_Stock_Price:  104.81535009771345
curr_Factors:  [1.04815350e+02 3.84983646e-02]
mat_Sqrt:  [[ 2.05658200e+01  0.00000000e+00]
 [-7.84840005e-03  1.79829437e-02]]
grads:  [-1.95557628e-02 -3.27447274e+01]
Stock Position:  -0.01955576279014023
Bond Position:  [0.84754786]


portfolio before change:  [-1.18149296]
curr_Stock_Price:  103.76750632261839
curr_Factors:  [1.03767506e+02 4.10747822e-02]
mat_Sqrt:  [[ 2.10304718e+01  0.00000000e+00]
 [-8.10676579e-03  1.85749339e-02]]
grads:  [-0.00877832 -6.01105878]
Stock Position:  -0.00877832062446421
Bond Position:  [-0.27058852]


portfolio before change:  [-1.18230561]
curr_Stock_Price:  103.85237296918886
curr_Factors:  [1.03852373e+02 3.92729052e-02]
mat_Sqrt:  [[ 2.05808325e+01  0.00000000e+00]
 [-7.92695707e-03  1.81629404e-02]]
grads:  [0.00872498 2.91598832]
Stock Position:  0.008724979518744942
Bond Position:  [-2.08841543]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.15197609]
Stock Price:  107.38839077394202
PL:  [-8.54036687]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 4.11003540e-03  1.53975532e-01]
 [ 4.72237506e-02 -4.96992625e-02]
 [ 6.58761858e-01 -2.65070335e-01]
 [ 1.47560827e-01 -1.16242466e-01]
 [-1.04332825e-02 -1.29163082e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-4.62945590e-01 -1.03725001e-01]
 [-1.46375629e+00  7.54385625e-01]
 [ 8.77954720e-03 -7.21707667e-02]
 [ 1.80534881e-01  8.22849086e-01]
 [-4.94171644e-01 -1.04466960e-01]
 [-4.07824363e-02 -7.74887245e-02]
 [-3.67541026e-02 -9.06141723e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15773941e-01 -6.16120876e-02]
 [-6.00390224e-02 -8.99965293e-02]
 [-1.35191636e-01 -6.19618396e-01]
 [-4.03362519e-01  6.66688801e-02]
 [-9.80108750e-02 -8.85081949e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.69407021]
curr_Stock_Price:  99.34950270941098
curr_Factors:  [9.93495027e+01 4.09648878e-02]
mat_Sqrt:  [[ 2.01081253e+01  0.00000000e+00]
 [-8.09591381e-03  1.85500689e-02]]
grads:  [3.54635083e-03 8.30053691e+00]
Stock Position:  0.0035463508328023733
Bond Position:  [-2.0463984]


portfolio before change:  [-1.69683946]
curr_Stock_Price:  98.7129075638311
curr_Factors:  [9.87129076e+01 3.91951456e-02]
mat_Sqrt:  [[ 1.95429484e+01  0.00000000e+00]
 [-7.91910557e-03  1.81449504e-02]]
grads:  [ 1.30651802e-03 -2.73901342e+00]
Stock Position:  0.001306518019435409
Bond Position:  [-1.82580966]


portfolio before change:  [-1.69586883]
curr_Stock_Price:  99.80523701020317
curr_Factors:  [9.9805237e+01 3.7834799e-02]
mat_Sqrt:  [[ 1.94132857e+01  0.00000000e+00]
 [-7.78046775e-03  1.78272912e-02]]
grads:  [  0.02797443 -14.86879483]
Stock Position:  0.027974433991709003
Bond Position:  [-4.48786384]


portfolio before change:  [-1.67057923]
curr_Stock_Price:  100.74937429279763
curr_Factors:  [1.00749374e+02 3.77688694e-02]
mat_Sqrt:  [[ 1.95798495e+01  0.00000000e+00]
 [-7.77368580e-03  1.78117518e-02]]
grads:  [ 4.94531153e-03 -6.52616694e+00]
Stock Position:  0.004945311529974592
Bond Position:  [-2.16881627]


portfolio before change:  [-1.66993458]
curr_Stock_Price:  100.98938403475246
curr_Factors:  [1.00989384e+02 3.83343328e-02]
mat_Sqrt:  [[ 1.97728685e+01  0.00000000e+00]
 [-7.83166218e-03  1.79445924e-02]]
grads:  [-0.00081275 -0.71978833]
Stock Position:  -0.0008127511484019541
Bond Position:  [-1.58785534]


portfolio before change:  [-1.67128219]
curr_Stock_Price:  102.15899423280388
curr_Factors:  [1.02158994e+02 3.89292533e-02]
mat_Sqrt:  [[ 2.01564779e+01  0.00000000e+00]
 [-7.89219902e-03  1.80832997e-02]]
grads:  [-2.87561230e-05 -1.07011311e+00]
Stock Position:  -2.8756123020989602e-05
Bond Position:  [-1.66834449]


portfolio before change:  [-1.67178202]
curr_Stock_Price:  105.03454410002018
curr_Factors:  [1.05034544e+02 3.99650198e-02]
mat_Sqrt:  [[ 2.09977215e+01  0.00000000e+00]
 [-7.99650121e-03  1.83222860e-02]]
grads:  [-0.02420334 -5.66113862]
Stock Position:  -0.02420333523330269
Bond Position:  [0.87040426]


portfolio before change:  [-1.66519477]
curr_Stock_Price:  104.77137302310041
curr_Factors:  [1.04771373e+02 3.93030634e-02]
mat_Sqrt:  [[ 2.07709249e+01  0.00000000e+00]
 [-7.93000009e-03  1.81699128e-02]]
grads:  [-0.05462036 41.51839539]
Stock Position:  -0.054620360859797296
Bond Position:  [4.05745543]


portfolio before change:  [-1.71582355]
curr_Stock_Price:  105.71686787279646
curr_Factors:  [1.05716868e+02 3.84546816e-02]
mat_Sqrt:  [[ 2.07309354e+01  0.00000000e+00]
 [-7.84394611e-03  1.79727384e-02]]
grads:  [-1.09586747e-03 -4.01556875e+00]
Stock Position:  -0.0010958674706361075
Bond Position:  [-1.59997187]


portfolio before change:  [-1.71814178]
curr_Stock_Price:  107.46724979322352
curr_Factors:  [1.07467250e+02 3.49859212e-02]
mat_Sqrt:  [[ 2.01012374e+01  0.00000000e+00]
 [-7.48180953e-03  1.71429793e-02]]
grads:  [2.68468878e-02 4.79991881e+01]
Stock Position:  0.02684688781175445
Bond Position:  [-4.60330298]


portfolio before change:  [-1.75617181]
curr_Stock_Price:  106.09356875270814
curr_Factors:  [1.06093569e+02 3.81492021e-02]
mat_Sqrt:  [[ 2.07220056e+01  0.00000000e+00]
 [-7.81272829e-03  1.79012094e-02]]
grads:  [-0.0260479  -5.83574873]
Stock Position:  -0.026047901556135993
Bond Position:  [1.00734302]


portfolio before change:  [-1.78920424]
curr_Stock_Price:  107.37137987447822
curr_Factors:  [1.07371380e+02 3.61462135e-02]
mat_Sqrt:  [[ 2.04136159e+01  0.00000000e+00]
 [-7.60486302e-03  1.74249302e-02]]
grads:  [-3.65448672e-03 -4.44700343e+00]
Stock Position:  -0.0036544867193734265
Bond Position:  [-1.39681696]


portfolio before change:  [-1.78762684]
curr_Stock_Price:  106.84417880755205
curr_Factors:  [1.06844179e+02 3.64486312e-02]
mat_Sqrt:  [[ 2.03981827e+01  0.00000000e+00]
 [-7.63660985e-03  1.74976713e-02]]
grads:  [-3.74059644e-03 -5.17864181e+00]
Stock Position:  -0.0037405964426246215
Bond Position:  [-1.38796589]


portfolio before change:  [-1.78026587]
curr_Stock_Price:  104.78354338971403
curr_Factors:  [1.04783543e+02 3.75200311e-02]
mat_Sqrt:  [[ 2.02966646e+01  0.00000000e+00]
 [-7.74803522e-03  1.77529789e-02]]
grads:  [7.50059897e-03 8.36919200e+00]
Stock Position:  0.0075005989729951435
Bond Position:  [-2.56620521]


portfolio before change:  [-1.78100274]
curr_Stock_Price:  104.7708457742945
curr_Factors:  [1.04770846e+02 3.83680774e-02]
mat_Sqrt:  [[ 2.05222734e+01  0.00000000e+00]
 [-7.83510841e-03  1.79524887e-02]]
grads:  [-0.00695165 -3.43195245]
Stock Position:  -0.00695164993693376
Bond Position:  [-1.0526725]


portfolio before change:  [-1.78681022]
curr_Stock_Price:  105.56839460606841
curr_Factors:  [1.05568395e+02 3.76932329e-02]
mat_Sqrt:  [[ 2.04958348e+01  0.00000000e+00]
 [-7.76589806e-03  1.77939078e-02]]
grads:  [-4.84570299e-03 -5.05771582e+00]
Stock Position:  -0.004845702992333399
Bond Position:  [-1.27525714]


portfolio before change:  [-1.79029198]
curr_Stock_Price:  106.22111765591904
curr_Factors:  [1.06221118e+02 3.64902939e-02]
mat_Sqrt:  [[ 2.02908176e+01  0.00000000e+00]
 [-7.64097312e-03  1.75076688e-02]]
grads:  [-1.99900902e-02 -3.53912563e+01]
Stock Position:  -0.019990090179190807
Bond Position:  [0.33307774]


portfolio before change:  [-1.80227022]
curr_Stock_Price:  106.8244927920365
curr_Factors:  [1.06824493e+02 3.53455090e-02]
mat_Sqrt:  [[ 2.00834334e+01  0.00000000e+00]
 [-7.52016053e-03  1.72308524e-02]]
grads:  [-0.01863555  3.86915739]
Stock Position:  -0.018635550398180524
Bond Position:  [0.188463]


portfolio before change:  [-1.88162334]
curr_Stock_Price:  111.08517934347056
curr_Factors:  [1.11085179e+02 3.47032785e-02]
mat_Sqrt:  [[ 2.06938536e+01  0.00000000e+00]
 [-7.45152639e-03  1.70735919e-02]]
grads:  [-0.00660288 -5.18392355]
Stock Position:  -0.006602879314867457
Bond Position:  [-1.14814131]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.88242125]
Stock Price:  111.16254498560713
PL:  [-13.04496623]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.04599159e-02  1.08749429e-01]
 [ 8.34038012e-02 -9.39777305e-03]
 [ 6.72049344e-01 -2.69125725e-01]
 [ 1.55201975e-01 -1.16970933e-01]
 [ 1.04266592e-01 -1.00125430e-02]
 [ 4.07713538e-02 -5.04418248e-02]
 [-7.12753543e-02 -1.39732502e-01]
 [-1.31147410e+00  7.40499505e-01]
 [ 4.34711192e-02 -7.33376455e-02]
 [ 1.30077883e-01  3.75759836e-01]
 [-4.91270284e-01 -1.03718528e-01]
 [-4.05104096e-02 -3.33830635e-02]
 [-3.84590338e-03 -6.72950494e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15858895e-01 -6.16603036e-02]
 [-4.40027888e-02 -7.95657577e-02]
 [-1.43703581e-01 -5.94862994e-01]
 [-3.66921371e-01  4.76490990e-02]
 [ 5.53995057e-02 -8.02535048e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.04619851]
curr_Stock_Price:  100.21412602191421
curr_Factors:  [1.00214126e+02 3.92884111e-02]
mat_Sqrt:  [[ 1.98637470e+01  0.00000000e+00]
 [-7.92852179e-03  1.81665256e-02]]
grads:  [3.92282773e-03 5.98625357e+00]
Stock Position:  0.003922827730733799
Bond Position:  [3.65307576]


portfolio before change:  [4.04866832]
curr_Stock_Price:  100.6108878059399
curr_Factors:  [1.00610888e+02 3.96882680e-02]
mat_Sqrt:  [[ 2.00436151e+01  0.00000000e+00]
 [-7.96876583e-03  1.82587363e-02]]
grads:  [ 0.00395649 -0.51470008]
Stock Position:  0.003956485708857947
Bond Position:  [3.65060278]


portfolio before change:  [4.04756948]
curr_Stock_Price:  100.10245497878948
curr_Factors:  [1.00102455e+02 3.70931100e-02]
mat_Sqrt:  [[ 1.92793040e+01  0.00000000e+00]
 [-7.70382866e-03  1.76516890e-02]]
grads:  [  0.02876625 -15.24645746]
Stock Position:  0.02876624836034094
Bond Position:  [1.1679974]


portfolio before change:  [4.06805728]
curr_Stock_Price:  100.80451954957913
curr_Factors:  [1.00804520e+02 3.74699328e-02]
mat_Sqrt:  [[ 1.95128839e+01  0.00000000e+00]
 [-7.74286075e-03  1.77411227e-02]]
grads:  [ 5.33758488e-03 -6.59320915e+00]
Stock Position:  0.005337584882116158
Bond Position:  [3.5300046]


portfolio before change:  [4.06435899]
curr_Stock_Price:  99.94628493426967
curr_Factors:  [9.99462849e+01 3.79709429e-02]
mat_Sqrt:  [[ 1.94756673e+01  0.00000000e+00]
 [-7.79445371e-03  1.78593371e-02]]
grads:  [ 0.00512931 -0.56063352]
Stock Position:  0.005129311288075171
Bond Position:  [3.55170338]


portfolio before change:  [4.06475992]
curr_Stock_Price:  99.85131989964948
curr_Factors:  [9.98513199e+01 3.84963254e-02]
mat_Sqrt:  [[ 1.95913087e+01  0.00000000e+00]
 [-7.84819219e-03  1.79824674e-02]]
grads:  [ 9.57400901e-04 -2.80505582e+00]
Stock Position:  0.000957400901445011
Bond Position:  [3.96916218]


portfolio before change:  [4.06588148]
curr_Stock_Price:  99.98620572831138
curr_Factors:  [9.99862057e+01 3.84696796e-02]
mat_Sqrt:  [[ 1.96109834e+01  0.00000000e+00]
 [-7.84547560e-03  1.79762429e-02]]
grads:  [-6.74416041e-03 -7.77317614e+00]
Stock Position:  -0.006744160406852583
Bond Position:  [4.74020449]


portfolio before change:  [4.0622144]
curr_Stock_Price:  100.70568388332782
curr_Factors:  [1.00705684e+02 3.86746298e-02]
mat_Sqrt:  [[ 1.98046452e+01  0.00000000e+00]
 [-7.86634652e-03  1.80240642e-02]]
grads:  [-0.04990211 41.0839363 ]
Stock Position:  -0.04990211203401865
Bond Position:  [9.08764072]


portfolio before change:  [3.92763943]
curr_Stock_Price:  103.44799600945754
curr_Factors:  [1.03447996e+02 3.65688210e-02]
mat_Sqrt:  [[ 1.97823354e+01  0.00000000e+00]
 [-7.64919039e-03  1.75264970e-02]]
grads:  [ 5.79504207e-04 -4.18438696e+00]
Stock Position:  0.0005795042072153883
Bond Position:  [3.86769088]


portfolio before change:  [3.92874547]
curr_Stock_Price:  103.68784700111853
curr_Factors:  [1.03687847e+02 3.54026434e-02]
mat_Sqrt:  [[ 1.95094804e+01  0.00000000e+00]
 [-7.52623607e-03  1.72447732e-02]]
grads:  [1.50733343e-02 2.17897812e+01]
Stock Position:  0.015073334337285228
Bond Position:  [2.36582388]


portfolio before change:  [3.96502114]
curr_Stock_Price:  106.0552156828256
curr_Factors:  [1.06055216e+02 3.24983842e-02]
mat_Sqrt:  [[ 1.91189006e+01  0.00000000e+00]
 [-7.21092329e-03  1.65223009e-02]]
grads:  [-0.02806316 -6.27748694]
Stock Position:  -0.02806315968311438
Bond Position:  [6.94126559]


portfolio before change:  [3.96944359]
curr_Stock_Price:  105.95947012697458
curr_Factors:  [1.05959470e+02 3.41509084e-02]
mat_Sqrt:  [[ 1.95812723e+01  0.00000000e+00]
 [-7.39198575e-03  1.69371671e-02]]
grads:  [-0.00281289 -1.97099451]
Stock Position:  -0.002812890397726897
Bond Position:  [4.26749597]


portfolio before change:  [3.97281194]
curr_Stock_Price:  105.14132814886153
curr_Factors:  [1.05141328e+02 3.38235012e-02]
mat_Sqrt:  [[ 1.93367169e+01  0.00000000e+00]
 [-7.35646667e-03  1.68557827e-02]]
grads:  [-1.71776165e-03 -3.99240134e+00]
Stock Position:  -0.001717761652397144
Bond Position:  [4.15341968]


portfolio before change:  [3.97344374]
curr_Stock_Price:  105.37808103018992
curr_Factors:  [1.05378081e+02 3.48120559e-02]
mat_Sqrt:  [[ 1.96614309e+01  0.00000000e+00]
 [-7.46319565e-03  1.71003295e-02]]
grads:  [7.74293298e-03 8.68860973e+00]
Stock Position:  0.007742932977054257
Bond Position:  [3.15750832]


portfolio before change:  [3.96804243]
curr_Stock_Price:  104.57854113807751
curr_Factors:  [1.04578541e+02 3.51469994e-02]
mat_Sqrt:  [[ 1.96058965e+01  0.00000000e+00]
 [-7.49901320e-03  1.71823978e-02]]
grads:  [-0.00728198 -3.58857386]
Stock Position:  -0.007281975485118416
Bond Position:  [4.72958081]


portfolio before change:  [3.95868451]
curr_Stock_Price:  106.02601536304896
curr_Factors:  [1.06026015e+02 3.36742541e-02]
mat_Sqrt:  [[ 1.94563528e+01  0.00000000e+00]
 [-7.34021842e-03  1.68185533e-02]]
grads:  [-4.04639725e-03 -4.73083245e+00]
Stock Position:  -0.00404639724859719
Bond Position:  [4.38770788]


portfolio before change:  [3.96387894]
curr_Stock_Price:  105.01341725157614
curr_Factors:  [1.05013417e+02 3.31684978e-02]
mat_Sqrt:  [[ 1.91252752e+01  0.00000000e+00]
 [-7.28488822e-03  1.66917759e-02]]
grads:  [-2.10884849e-02 -3.56380891e+01]
Stock Position:  -0.02108848486210719
Bond Position:  [6.1784528]


portfolio before change:  [3.94103146]
curr_Stock_Price:  106.17008110434391
curr_Factors:  [1.06170081e+02 3.27881944e-02]
mat_Sqrt:  [[ 1.92247588e+01  0.00000000e+00]
 [-7.24300429e-03  1.65958077e-02]]
grads:  [-0.01800416  2.87115276]
Stock Position:  -0.018004158232264863
Bond Position:  [5.8525344]


portfolio before change:  [3.91637384]
curr_Stock_Price:  107.62090945768732
curr_Factors:  [1.07620909e+02 3.17863104e-02]
mat_Sqrt:  [[ 1.91874260e+01  0.00000000e+00]
 [-7.13148628e-03  1.63402879e-02]]
grads:  [ 1.06184147e-03 -4.91138868e+00]
Stock Position:  0.0010618414735243233
Bond Position:  [3.80209749]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.9145804]
Stock Price:  105.03664261758773
PL:  [-1.12206222]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.28046293e-02  7.89252726e-02]
 [ 6.93973280e-02 -1.63787265e-02]
 [ 6.32485575e-01 -2.57050716e-01]
 [-8.38054853e-02 -9.33557403e-02]
 [ 1.96867964e-01 -5.72152541e-03]
 [ 3.68326701e-02 -6.13345259e-02]
 [-2.75308446e-02 -5.10735249e-02]
 [-1.26987492e+00  7.05023819e-01]
 [ 8.53033758e-02 -7.45090851e-02]
 [ 1.35291037e-02 -9.63634153e-02]
 [-1.48739743e-02  7.85518160e-02]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.64971411e-01 -2.87056646e-02]
 [ 2.29655843e-02  4.23657805e-02]
 [ 3.41739792e-02  1.45177173e-02]
 [-1.43635597e-01 -1.40396403e-01]
 [-1.93433187e-01 -3.48644536e-01]
 [ 2.76794825e-01 -3.11322761e-01]
 [-1.84035282e-01 -1.72207809e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.2530723]
curr_Stock_Price:  100.39591040545179
curr_Factors:  [1.00395910e+02 3.95659525e-02]
mat_Sqrt:  [[ 1.99699434e+01  0.00000000e+00]
 [-7.95647685e-03  1.82305787e-02]]
grads:  [2.86683046e-03 4.32927960e+00]
Stock Position:  0.0028668304648127464
Bond Position:  [4.96525424]


portfolio before change:  [5.25352137]
curr_Stock_Price:  100.1195092347505
curr_Factors:  [1.00119509e+02 3.82506654e-02]
mat_Sqrt:  [[ 1.95811507e+01  0.00000000e+00]
 [-7.82311093e-03  1.79249990e-02]]
grads:  [ 0.00317903 -0.91373654]
Stock Position:  0.0031790300149141665
Bond Position:  [4.93523845]


portfolio before change:  [5.25246263]
curr_Stock_Price:  99.39831201186301
curr_Factors:  [9.93983120e+01 3.77891718e-02]
mat_Sqrt:  [[ 1.93224724e+01  0.00000000e+00]
 [-7.77577488e-03  1.78165385e-02]]
grads:  [  0.02692717 -14.42764635]
Stock Position:  0.02692716713679322
Bond Position:  [2.57594767]


portfolio before change:  [5.24471321]
curr_Stock_Price:  99.08660145035924
curr_Factors:  [9.90866015e+01 3.82097328e-02]
mat_Sqrt:  [[ 1.93687652e+01  0.00000000e+00]
 [-7.81892400e-03  1.79154055e-02]]
grads:  [-0.00643042 -5.21091974]
Stock Position:  -0.0064304187528313435
Bond Position:  [5.88188155]


portfolio before change:  [5.24593574]
curr_Stock_Price:  99.12518805004932
curr_Factors:  [9.91251881e+01 3.90435266e-02]
mat_Sqrt:  [[ 1.95865770e+01  0.00000000e+00]
 [-7.90377394e-03  1.81098212e-02]]
grads:  [ 0.00992368 -0.31593495]
Stock Position:  0.009923678129394823
Bond Position:  [4.26224928]


portfolio before change:  [5.2500432]
curr_Stock_Price:  99.43170371747175
curr_Factors:  [9.94317037e+01 4.06575628e-02]
mat_Sqrt:  [[ 2.00491309e+01  0.00000000e+00]
 [-8.06548824e-03  1.84803552e-02]]
grads:  [ 5.01971306e-04 -3.31890406e+00]
Stock Position:  0.0005019713058422657
Bond Position:  [5.20013133]


portfolio before change:  [5.24976063]
curr_Stock_Price:  96.27861805882188
curr_Factors:  [9.62786181e+01 4.02213027e-02]
mat_Sqrt:  [[ 1.93089169e+01  0.00000000e+00]
 [-8.02209974e-03  1.83809396e-02]]
grads:  [-2.58021506e-03 -2.77861338e+00]
Stock Position:  -0.002580215063128301
Bond Position:  [5.49818017]


portfolio before change:  [5.24700244]
curr_Stock_Price:  97.88038862122117
curr_Factors:  [9.78803886e+01 3.95052365e-02]
mat_Sqrt:  [[ 1.94546319e+01  0.00000000e+00]
 [-7.95036970e-03  1.82165855e-02]]
grads:  [-0.04945749 38.70230343]
Stock Position:  -0.049457491871515595
Bond Position:  [10.08792096]


portfolio before change:  [5.13688355]
curr_Stock_Price:  100.15792388406808
curr_Factors:  [1.00157924e+02 3.82066533e-02]
mat_Sqrt:  [[ 1.95773909e+01  0.00000000e+00]
 [-7.81860891e-03  1.79146836e-02]]
grads:  [ 2.69621960e-03 -4.15910695e+00]
Stock Position:  0.0026962196002337556
Bond Position:  [4.86683579]


portfolio before change:  [5.1334566]
curr_Stock_Price:  98.43558156924216
curr_Factors:  [9.84355816e+01 3.89905605e-02]
mat_Sqrt:  [[ 1.94371171e+01  0.00000000e+00]
 [-7.89841103e-03  1.80975332e-02]]
grads:  [-1.46767335e-03 -5.32467128e+00]
Stock Position:  -0.0014676733484845308
Bond Position:  [5.27792788]


portfolio before change:  [5.1337404]
curr_Stock_Price:  99.14135745606426
curr_Factors:  [9.91413575e+01 3.92297181e-02]
mat_Sqrt:  [[ 1.96364264e+01  0.00000000e+00]
 [-7.92259736e-03  1.81529511e-02]]
grads:  [9.88410436e-04 4.32722017e+00]
Stock Position:  0.0009884104360063954
Bond Position:  [5.03574805]


portfolio before change:  [5.13368237]
curr_Stock_Price:  97.80879465221113
curr_Factors:  [9.78087947e+01 4.11403706e-02]
mat_Sqrt:  [[ 1.98386450e+01  0.00000000e+00]
 [-8.11323566e-03  1.85897583e-02]]
grads:  [ 0.00242035 -0.46215678]
Stock Position:  0.002420350695572522
Bond Position:  [4.89695079]


portfolio before change:  [5.13677326]
curr_Stock_Price:  98.57996254970035
curr_Factors:  [9.85799625e+01 4.18618160e-02]
mat_Sqrt:  [[ 2.01696184e+01  0.00000000e+00]
 [-8.18406412e-03  1.87520467e-02]]
grads:  [ 0.00755806 -1.53080168]
Stock Position:  0.007558062262236249
Bond Position:  [4.39169977]


portfolio before change:  [5.14691249]
curr_Stock_Price:  99.7761910233572
curr_Factors:  [9.97761910e+01 4.01576837e-02]
mat_Sqrt:  [[ 1.99945322e+01  0.00000000e+00]
 [-8.01575286e-03  1.83663971e-02]]
grads:  [2.07334317e-03 2.30670067e+00]
Stock Position:  0.0020733431707269092
Bond Position:  [4.94004221]


portfolio before change:  [5.14361999]
curr_Stock_Price:  97.59243887174306
curr_Factors:  [9.75924389e+01 4.02539794e-02]
mat_Sqrt:  [[ 1.95803559e+01  0.00000000e+00]
 [-8.02535775e-03  1.83884047e-02]]
grads:  [0.00206891 0.7895039 ]
Stock Position:  0.0020689118586764755
Bond Position:  [4.94170984]


portfolio before change:  [5.1449501]
curr_Stock_Price:  97.63813049294706
curr_Factors:  [9.76381305e+01 3.91728765e-02]
mat_Sqrt:  [[ 1.93246745e+01  0.00000000e+00]
 [-7.91685559e-03  1.81397950e-02]]
grads:  [-0.01060352 -7.73969072]
Stock Position:  -0.010603521967017006
Bond Position:  [6.18025817]


portfolio before change:  [5.15453343]
curr_Stock_Price:  96.88007405127898
curr_Factors:  [9.68800741e+01 3.82017844e-02]
mat_Sqrt:  [[ 1.89354786e+01  0.00000000e+00]
 [-7.81811071e-03  1.79135421e-02]]
grads:  [-1.82511435e-02 -1.94626242e+01]
Stock Position:  -0.01825114351485526
Bond Position:  [6.92270557]


portfolio before change:  [5.17585254]
curr_Stock_Price:  95.80681457704158
curr_Factors:  [9.58068146e+01 3.86193540e-02]
mat_Sqrt:  [[ 1.88277708e+01  0.00000000e+00]
 [-7.86072302e-03  1.80111791e-02]]
grads:  [ 7.48481770e-03 -1.72849739e+01]
Stock Position:  0.007484817698555448
Bond Position:  [4.45875599]


portfolio before change:  [5.16784766]
curr_Stock_Price:  94.58838788409683
curr_Factors:  [9.45883879e+01 3.92334418e-02]
mat_Sqrt:  [[ 1.87355319e+01  0.00000000e+00]
 [-7.92297336e-03  1.81538126e-02]]
grads:  [-0.0138343  -9.48604094]
Stock Position:  -0.013834297979846236
Bond Position:  [6.47641161]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.15826169]
Stock Price:  95.39835130008628
PL:  [5.15826169]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 7.46643138e-03  1.83088549e-02]
 [-1.43179970e-01  1.21344064e-01]
 [ 8.21880265e-01 -3.14854677e-01]
 [-4.78233448e-02 -9.72097160e-02]
 [ 3.23664614e-01 -1.23440223e-02]
 [-1.98066273e-01 -2.61682229e-01]
 [-7.27750178e-02 -6.78746136e-02]
 [-1.31477136e+00  6.32262357e-01]
 [ 4.30179662e-02 -6.58907430e-03]
 [ 1.55843881e-02 -8.64587847e-02]
 [ 5.94211179e-02  2.80404123e-01]
 [ 3.75588821e-02 -8.81048537e-03]
 [ 1.62888673e-01 -2.74818597e-02]
 [ 1.47330978e-02  3.21806281e-02]
 [-6.35282879e-02 -3.01262766e-02]
 [-1.41296423e-01 -1.29892344e-01]
 [-1.59364531e-01 -5.45896077e-01]
 [-5.44445921e-02 -1.56340860e-01]
 [ 1.31680078e-01  2.06008151e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.71684573]
curr_Stock_Price:  101.8213835891174
curr_Factors:  [1.01821384e+02 3.91236164e-02]
mat_Sqrt:  [[ 2.01399547e+01  0.00000000e+00]
 [-7.91187628e-03  1.81283860e-02]]
grads:  [7.67482895e-04 1.00995505e+00]
Stock Position:  0.0007674828948490989
Bond Position:  [14.63869956]


portfolio before change:  [14.72106022]
curr_Stock_Price:  102.54369921803294
curr_Factors:  [1.02543699e+02 3.98060910e-02]
mat_Sqrt:  [[ 2.04589691e+01  0.00000000e+00]
 [-7.98058555e-03  1.82858187e-02]]
grads:  [-4.40985461e-03  6.63596561e+00]
Stock Position:  -0.00440985460586686
Bond Position:  [15.17326303]


portfolio before change:  [14.72672586]
curr_Stock_Price:  102.11923080606266
curr_Factors:  [1.02119231e+02 4.18467577e-02]
mat_Sqrt:  [[ 2.08900001e+01  0.00000000e+00]
 [-8.18259203e-03  1.87486737e-02]]
grads:  [  0.03276527 -16.79343735]
Stock Position:  0.03276526639337286
Bond Position:  [11.38076206]


portfolio before change:  [14.6385983]
curr_Stock_Price:  99.3427203961514
curr_Factors:  [9.93427204e+01 4.11996440e-02]
mat_Sqrt:  [[ 2.01642828e+01  0.00000000e+00]
 [-8.11907817e-03  1.86031452e-02]]
grads:  [-4.47569318e-03 -5.22544522e+00]
Stock Position:  -0.004475693175268952
Bond Position:  [15.08322584]


portfolio before change:  [14.65499029]
curr_Stock_Price:  96.5228873618461
curr_Factors:  [9.65228874e+01 4.33284689e-02]
mat_Sqrt:  [[ 2.00917135e+01  0.00000000e+00]
 [-8.32619663e-03  1.90777132e-02]]
grads:  [ 0.01584122 -0.64703889]
Stock Position:  0.01584121938046222
Bond Position:  [13.12595005]


portfolio before change:  [14.65311233]
curr_Stock_Price:  96.19716423361734
curr_Factors:  [9.61971642e+01 4.20111255e-02]
mat_Sqrt:  [[ 1.97171631e+01  0.00000000e+00]
 [-8.19864628e-03  1.87854586e-02]]
grads:  [ -0.01583766 -13.9300421 ]
Stock Position:  -0.01583766183744593
Bond Position:  [16.17665049]


portfolio before change:  [14.68009099]
curr_Stock_Price:  94.74909794402922
curr_Factors:  [9.47490979e+01 4.35705115e-02]
mat_Sqrt:  [[ 1.97775009e+01  0.00000000e+00]
 [-8.34942025e-03  1.91309251e-02]]
grads:  [-0.0051775  -3.54790022]
Stock Position:  -0.005177495790415453
Bond Position:  [15.17065404]


portfolio before change:  [14.68267956]
curr_Stock_Price:  94.98175152305292
curr_Factors:  [9.49817515e+01 4.44012728e-02]
mat_Sqrt:  [[ 2.00141838e+01  0.00000000e+00]
 [-8.42864381e-03  1.93124491e-02]]
grads:  [-0.05190466 32.73859018]
Stock Position:  -0.05190466175968604
Bond Position:  [19.61267525]


portfolio before change:  [14.62812225]
curr_Stock_Price:  96.12733436255412
curr_Factors:  [9.61273344e+01 4.44049857e-02]
mat_Sqrt:  [[ 2.02564234e+01  0.00000000e+00]
 [-8.42899621e-03  1.93132566e-02]]
grads:  [ 0.00198171 -0.34116848]
Stock Position:  0.0019817051397965726
Bond Position:  [14.43762622]


portfolio before change:  [14.63433425]
curr_Stock_Price:  97.44041589448202
curr_Factors:  [9.74404159e+01 4.41884859e-02]
mat_Sqrt:  [[ 2.04830059e+01  0.00000000e+00]
 [-8.40842300e-03  1.92661174e-02]]
grads:  [-1.08135101e-03 -4.48760810e+00]
Stock Position:  -0.0010813510104130935
Bond Position:  [14.73970154]


portfolio before change:  [14.63776184]
curr_Stock_Price:  97.67882183824788
curr_Factors:  [9.76788218e+01 4.25105957e-02]
mat_Sqrt:  [[ 2.01395150e+01  0.00000000e+00]
 [-8.24723912e-03  1.88967988e-02]]
grads:  [9.02700536e-03 1.48387103e+01]
Stock Position:  0.009027005359893616
Bond Position:  [13.75601459]


portfolio before change:  [14.65854356]
curr_Stock_Price:  99.59997795985107
curr_Factors:  [9.95999780e+01 4.15662369e-02]
mat_Sqrt:  [[ 2.03062438e+01  0.00000000e+00]
 [-8.15511981e-03  1.86857269e-02]]
grads:  [ 0.00166026 -0.47150884]
Stock Position:  0.0016602613149757546
Bond Position:  [14.49318157]


portfolio before change:  [14.6621049]
curr_Stock_Price:  99.56239352849991
curr_Factors:  [9.95623935e+01 4.04961397e-02]
mat_Sqrt:  [[ 2.00355903e+01  0.00000000e+00]
 [-8.04946107e-03  1.84436323e-02]]
grads:  [ 0.00753133 -1.49004596]
Stock Position:  0.0075313282254583025
Bond Position:  [13.91226784]


portfolio before change:  [14.66608064]
curr_Stock_Price:  99.62841526171498
curr_Factors:  [9.96284153e+01 3.94349856e-02]
mat_Sqrt:  [[ 1.97844538e+01  0.00000000e+00]
 [-7.94329762e-03  1.82003813e-02]]
grads:  [1.45457012e-03 1.76812933e+00]
Stock Position:  0.00145457011556755
Bond Position:  [14.52116412]


portfolio before change:  [14.66923125]
curr_Stock_Price:  99.29832685400018
curr_Factors:  [9.92983269e+01 3.99910003e-02]
mat_Sqrt:  [[ 1.98574311e+01  0.00000000e+00]
 [-7.99909998e-03  1.83282406e-02]]
grads:  [-0.00386135 -1.64370805]
Stock Position:  -0.0038613490552179826
Bond Position:  [15.05265675]


portfolio before change:  [14.66616842]
curr_Stock_Price:  101.0662214817887
curr_Factors:  [1.01066221e+02 4.02763009e-02]
mat_Sqrt:  [[ 2.02829359e+01  0.00000000e+00]
 [-8.02758254e-03  1.83935023e-02]]
grads:  [-0.00976121 -7.06186031]
Stock Position:  -0.00976121460522802
Bond Position:  [15.6526975]


portfolio before change:  [14.65300037]
curr_Stock_Price:  102.81617981634903
curr_Factors:  [1.02816180e+02 3.89197765e-02]
mat_Sqrt:  [[ 2.02836745e+01  0.00000000e+00]
 [-7.89123833e-03  1.80810985e-02]]
grads:  [-1.96026174e-02 -3.01915327e+01]
Stock Position:  -0.01960261741915236
Bond Position:  [16.6684666]


portfolio before change:  [14.65571723]
curr_Stock_Price:  102.89018881321526
curr_Factors:  [1.02890189e+02 4.11932623e-02]
mat_Sqrt:  [[ 2.08827196e+01  0.00000000e+00]
 [-8.11844934e-03  1.86017043e-02]]
grads:  [-5.87458623e-03 -8.40465246e+00]
Stock Position:  -0.005874586232328539
Bond Position:  [15.26015452]


portfolio before change:  [14.66317005]
curr_Stock_Price:  102.27102945471496
curr_Factors:  [1.02271029e+02 4.24568137e-02]
mat_Sqrt:  [[ 2.10729980e+01  0.00000000e+00]
 [-8.24202050e-03  1.88848414e-02]]
grads:  [0.00667542 1.09086513]
Stock Position:  0.006675415161895646
Bond Position:  [13.98046847]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.68916947]
Stock Price:  105.64218536272173
PL:  [9.04698411]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 4.38382226e-02  8.27977631e-02]
 [ 8.03209622e-02 -7.09376989e-03]
 [ 8.56180082e-01 -3.25323108e-01]
 [ 5.63721282e-01 -7.41056789e-02]
 [ 4.49706516e-01 -3.88233485e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-7.99467481e-01 -4.67581745e-03]
 [-1.58854196e+00  6.19283052e-01]
 [-3.10484197e-02 -4.45150831e-02]
 [ 1.85880739e-01  8.70262104e-01]
 [-5.44730535e-01 -1.22801534e-01]
 [-4.09585287e-02 -1.06279666e-01]
 [-1.94634580e-02 -7.83573494e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.14601959e-01 -6.09469250e-02]
 [ 1.08410412e-01  2.83824909e-02]
 [-7.91748897e-03 -7.07321341e-01]
 [-4.02849901e-01  1.02017196e-01]
 [-1.10473248e-02 -8.23744781e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.64111323]
curr_Stock_Price:  98.60435837420145
curr_Factors:  [9.86043584e+01 4.23452694e-02]
mat_Sqrt:  [[ 2.02907716e+01  0.00000000e+00]
 [-8.23118649e-03  1.88600176e-02]]
grads:  [3.94140404e-03 4.39012121e+00]
Stock Position:  0.003941404038858954
Bond Position:  [-7.02975285]


portfolio before change:  [-6.63555182]
curr_Stock_Price:  100.46132675571117
curr_Factors:  [1.00461327e+02 4.00544189e-02]
mat_Sqrt:  [[ 2.01059282e+01  0.00000000e+00]
 [-8.00544004e-03  1.83427675e-02]]
grads:  [ 0.00384091 -0.38673389]
Stock Position:  0.0038409063456434087
Bond Position:  [-7.02141437]


portfolio before change:  [-6.62759126]
curr_Stock_Price:  102.99097419565375
curr_Factors:  [1.02990974e+02 3.92172547e-02]
mat_Sqrt:  [[ 2.03956599e+01  0.00000000e+00]
 [-7.92133874e-03  1.81500672e-02]]
grads:  [  0.03501713 -17.92407181]
Stock Position:  0.03501712827372463
Bond Position:  [-10.23403941]


portfolio before change:  [-6.48769818]
curr_Stock_Price:  107.05903799160922
curr_Factors:  [1.07059038e+02 3.75717864e-02]
mat_Sqrt:  [[ 2.07517277e+01  0.00000000e+00]
 [-7.75337722e-03  1.77652190e-02]]
grads:  [ 0.02560649 -4.17139124]
Stock Position:  0.02560649026700335
Bond Position:  [-9.22910439]


portfolio before change:  [-6.47269478]
curr_Stock_Price:  107.73507609169921
curr_Factors:  [1.07735076e+02 3.75560311e-02]
mat_Sqrt:  [[ 2.08783882e+01  0.00000000e+00]
 [-7.75175140e-03  1.77614938e-02]]
grads:  [ 0.02072778 -2.18581551]
Stock Position:  0.020727779093468516
Bond Position:  [-8.70580364]


portfolio before change:  [-6.47979837]
curr_Stock_Price:  107.49738219265973
curr_Factors:  [1.07497382e+02 3.51459402e-02]
mat_Sqrt:  [[ 2.01528035e+01  0.00000000e+00]
 [-7.49890020e-03  1.71821389e-02]]
grads:  [-2.87613659e-05 -1.12623790e+00]
Stock Position:  -2.8761365923092037e-05
Bond Position:  [-6.4767066]


portfolio before change:  [-6.48143858]
curr_Stock_Price:  108.22183931068601
curr_Factors:  [1.08221839e+02 3.34289772e-02]
mat_Sqrt:  [[ 1.97868406e+01  0.00000000e+00]
 [-7.31343719e-03  1.67571898e-02]]
grads:  [-0.04050713 -0.27903351]
Stock Position:  -0.04050713252893495
Bond Position:  [-2.0976822]


portfolio before change:  [-6.51628875]
curr_Stock_Price:  109.06923780461096
curr_Factors:  [1.09069238e+02 3.50229170e-02]
mat_Sqrt:  [[ 2.04116652e+01  0.00000000e+00]
 [-7.48576430e-03  1.71520408e-02]]
grads:  [-0.06458389 36.10550255]
Stock Position:  -0.06458388730656837
Bond Position:  [0.52782661]


portfolio before change:  [-6.54123483]
curr_Stock_Price:  109.45753970580178
curr_Factors:  [1.09457540e+02 3.62688067e-02]
mat_Sqrt:  [[ 2.08454999e+01  0.00000000e+00]
 [-7.61774840e-03  1.74544543e-02]]
grads:  [-2.42145282e-03 -2.55035661e+00]
Stock Position:  -0.002421452824218861
Bond Position:  [-6.27618856]


portfolio before change:  [-6.53895068]
curr_Stock_Price:  107.86618681636683
curr_Factors:  [1.07866187e+02 3.69277530e-02]
mat_Sqrt:  [[ 2.07282084e+01  0.00000000e+00]
 [-7.68663807e-03  1.76123004e-02]]
grads:  [2.72910349e-02 4.94121770e+01]
Stock Position:  0.027291034892054897
Bond Position:  [-9.48273055]


portfolio before change:  [-6.57197923]
curr_Stock_Price:  106.74283001711056
curr_Factors:  [1.06742830e+02 3.83199283e-02]
mat_Sqrt:  [[ 2.08954177e+01  0.00000000e+00]
 [-7.83019062e-03  1.79412206e-02]]
grads:  [-0.02863429 -6.8446588 ]
Stock Position:  -0.028634293286187443
Bond Position:  [-3.51547373]


portfolio before change:  [-6.61726051]
curr_Stock_Price:  108.2934987010695
curr_Factors:  [1.08293499e+02 3.60869429e-02]
mat_Sqrt:  [[ 2.05720434e+01  0.00000000e+00]
 [-7.59862545e-03  1.74106381e-02]]
grads:  [-4.24570259e-03 -6.10429472e+00]
Stock Position:  -0.004245702591501275
Bond Position:  [-6.15747852]


portfolio before change:  [-6.60887529]
curr_Stock_Price:  105.9558926803996
curr_Factors:  [1.05955893e+02 3.81597773e-02]
mat_Sqrt:  [[ 2.06979832e+01  0.00000000e+00]
 [-7.81381109e-03  1.79036904e-02]]
grads:  [-2.59259119e-03 -4.37660324e+00]
Stock Position:  -0.002592591188461231
Bond Position:  [-6.33417498]


portfolio before change:  [-6.61402749]
curr_Stock_Price:  107.33229590866357
curr_Factors:  [1.07332296e+02 3.85272451e-02]
mat_Sqrt:  [[ 2.10675676e+01  0.00000000e+00]
 [-7.85134333e-03  1.79896876e-02]]
grads:  [7.22613756e-03 8.25907003e+00]
Stock Position:  0.007226137556243547
Bond Position:  [-7.38962542]


portfolio before change:  [-6.61475836]
curr_Stock_Price:  107.48684049641079
curr_Factors:  [1.07486840e+02 3.95140312e-02]
mat_Sqrt:  [[ 2.13663809e+01  0.00000000e+00]
 [-7.95125462e-03  1.82186131e-02]]
grads:  [-0.00660858 -3.3453109 ]
Stock Position:  -0.00660857718887957
Bond Position:  [-5.90442328]


portfolio before change:  [-6.63474534]
curr_Stock_Price:  110.28785022020044
curr_Factors:  [1.10287850e+02 3.95170096e-02]
mat_Sqrt:  [[ 2.19239957e+01  0.00000000e+00]
 [-7.95155427e-03  1.82192997e-02]]
grads:  [0.00550983 1.55782557]
Stock Position:  0.005509832630365918
Bond Position:  [-7.24241294]


portfolio before change:  [-6.6273941]
curr_Stock_Price:  111.9507087674679
curr_Factors:  [1.11950709e+02 3.80875158e-02]
mat_Sqrt:  [[ 2.18483262e+01  0.00000000e+00]
 [-7.80640925e-03  1.78867306e-02]]
grads:  [-1.44916287e-02 -3.95444732e+01]
Stock Position:  -0.014491628676664297
Bond Position:  [-5.005046]


portfolio before change:  [-6.60322849]
curr_Stock_Price:  110.19679806644584
curr_Factors:  [1.10196798e+02 3.91439530e-02]
mat_Sqrt:  [[ 2.18022501e+01  0.00000000e+00]
 [-7.91393232e-03  1.81330970e-02]]
grads:  [-0.01643527  5.62602164]
Stock Position:  -0.016435273687200182
Bond Position:  [-4.79211396]


portfolio before change:  [-6.58632766]
curr_Stock_Price:  109.095568522423
curr_Factors:  [1.09095569e+02 3.79977242e-02]
mat_Sqrt:  [[ 2.12660046e+01  0.00000000e+00]
 [-7.79720198e-03  1.78656342e-02]]
grads:  [-2.21002936e-03 -4.61077829e+00]
Stock Position:  -0.002210029356724336
Bond Position:  [-6.34522326]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.59333863]
Stock Price:  111.55004433897288
PL:  [-18.14338297]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.19030072e-02  1.04181120e-01]
 [ 8.20181278e-02 -1.05477268e-02]
 [ 4.56735149e-01 -2.03411036e-01]
 [-8.72306870e-02 -8.87842696e-02]
 [ 2.81103407e-01 -9.22944214e-03]
 [ 3.88324315e-02 -4.96238644e-02]
 [-8.85036912e-02 -1.65767575e-01]
 [-1.32565255e+00  7.41852385e-01]
 [ 8.54055366e-02 -7.44903826e-02]
 [ 8.15797399e-02  1.48511276e-01]
 [-5.73062483e-02 -3.84760956e-02]
 [ 3.09136369e-02 -8.91296804e-03]
 [ 1.26864839e-01 -1.20734586e-02]
 [ 1.82327691e-02  3.65103875e-02]
 [-1.17435314e-01 -6.25550058e-02]
 [-1.26477470e-01 -1.18150471e-01]
 [-1.67446005e-01 -5.06084446e-01]
 [ 1.01471777e-02 -1.72195388e-01]
 [ 1.05674131e-01 -5.43838654e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.15376455]
curr_Stock_Price:  98.82838906124906
curr_Factors:  [9.88283891e+01 4.12871765e-02]
mat_Sqrt:  [[ 2.00811837e+01  0.00000000e+00]
 [-8.12769847e-03  1.86228967e-02]]
grads:  [3.85292904e-03 5.59424892e+00]
Stock Position:  0.0038529290353860124
Bond Position:  [-5.53454332]


portfolio before change:  [-5.14733377]
curr_Stock_Price:  100.85660756971306
curr_Factors:  [1.00856608e+02 4.04898898e-02]
mat_Sqrt:  [[ 2.02944672e+01  0.00000000e+00]
 [-8.04883990e-03  1.84422091e-02]]
grads:  [ 0.00381457 -0.57193402]
Stock Position:  0.0038145727944131217
Bond Position:  [-5.53205864]


portfolio before change:  [-5.16702322]
curr_Stock_Price:  96.05757568794904
curr_Factors:  [9.60575757e+01 4.26608309e-02]
mat_Sqrt:  [[ 1.98402105e+01  0.00000000e+00]
 [-8.26179940e-03  1.89301606e-02]]
grads:  [  0.01854614 -10.7453413 ]
Stock Position:  0.018546138637714274
Bond Position:  [-6.94852033]


portfolio before change:  [-5.16983867]
curr_Stock_Price:  95.99944475500799
curr_Factors:  [9.59994448e+01 4.21243306e-02]
mat_Sqrt:  [[ 1.97031302e+01  0.00000000e+00]
 [-8.20968507e-03  1.88107516e-02]]
grads:  [-0.00639387 -4.71986826]
Stock Position:  -0.006393873345180242
Bond Position:  [-4.55603038]


portfolio before change:  [-5.18190094]
curr_Stock_Price:  97.70781821432605
curr_Factors:  [9.77078182e+01 3.90708562e-02]
mat_Sqrt:  [[ 1.93132686e+01  0.00000000e+00]
 [-7.90653969e-03  1.81161583e-02]]
grads:  [ 0.01434637 -0.50945912]
Stock Position:  0.014346372665571653
Bond Position:  [-6.58365371]


portfolio before change:  [-5.1515559]
curr_Stock_Price:  99.93773080785749
curr_Factors:  [9.99377308e+01 3.84783255e-02]
mat_Sqrt:  [[ 1.96036783e+01  0.00000000e+00]
 [-7.84635716e-03  1.79782628e-02]]
grads:  [ 8.76100968e-04 -2.76021465e+00]
Stock Position:  0.0008761009681313191
Bond Position:  [-5.23911145]


portfolio before change:  [-5.15183808]
curr_Stock_Price:  101.11083983267378
curr_Factors:  [1.01110840e+02 3.58064064e-02]
mat_Sqrt:  [[ 1.91327804e+01  0.00000000e+00]
 [-7.56903231e-03  1.73428318e-02]]
grads:  [-8.40706836e-03 -9.55827616e+00]
Stock Position:  -0.008407068359376726
Bond Position:  [-4.30179234]


portfolio before change:  [-5.15258909]
curr_Stock_Price:  101.07223229767655
curr_Factors:  [1.01072232e+02 3.81717123e-02]
mat_Sqrt:  [[ 1.97470706e+01  0.00000000e+00]
 [-7.81503293e-03  1.79064900e-02]]
grads:  [-0.05073571 41.42924637]
Stock Position:  -0.05073570881051475
Bond Position:  [-0.02461774]


portfolio before change:  [-5.10572879]
curr_Stock_Price:  100.14849515296622
curr_Factors:  [1.00148495e+02 3.87210108e-02]
mat_Sqrt:  [[ 1.97068754e+01  0.00000000e+00]
 [-7.87106202e-03  1.80348688e-02]]
grads:  [ 2.68410224e-03 -4.13035346e+00]
Stock Position:  0.002684102237569568
Bond Position:  [-5.37453759]


portfolio before change:  [-5.1045775]
curr_Stock_Price:  101.07807488754749
curr_Factors:  [1.01078075e+02 3.78609678e-02]
mat_Sqrt:  [[ 1.96676657e+01  0.00000000e+00]
 [-7.78315801e-03  1.78334554e-02]]
grads:  [7.44345449e-03 8.32767812e+00]
Stock Position:  0.007443454492327053
Bond Position:  [-5.85694755]


portfolio before change:  [-5.11435195]
curr_Stock_Price:  99.96165380569278
curr_Factors:  [9.99616538e+01 3.81445295e-02]
mat_Sqrt:  [[ 1.95231353e+01  0.00000000e+00]
 [-7.81224982e-03  1.79001131e-02]]
grads:  [-0.00379542 -2.14948897]
Stock Position:  -0.003795424866784362
Bond Position:  [-4.734955]


portfolio before change:  [-5.115249]
curr_Stock_Price:  99.88607839056719
curr_Factors:  [9.98860784e+01 4.04230665e-02]
mat_Sqrt:  [[ 2.00825839e+01  0.00000000e+00]
 [-8.04219537e-03  1.84269845e-02]]
grads:  [ 0.00134563 -0.48369108]
Stock Position:  0.0013456285698143725
Bond Position:  [-5.24965856]


portfolio before change:  [-5.11501208]
curr_Stock_Price:  101.03758235487084
curr_Factors:  [1.01037582e+02 4.29544128e-02]
mat_Sqrt:  [[ 2.09404900e+01  0.00000000e+00]
 [-8.29017855e-03  1.89951854e-02]]
grads:  [ 0.00580672 -0.63560625]
Stock Position:  0.005806719443335866
Bond Position:  [-5.70170897]


portfolio before change:  [-5.12423145]
curr_Stock_Price:  99.69538392966419
curr_Factors:  [9.96953839e+01 4.17230633e-02]
mat_Sqrt:  [[ 2.03640026e+01  0.00000000e+00]
 [-8.17048966e-03  1.87209437e-02]]
grads:  [1.67782382e-03 1.95024290e+00]
Stock Position:  0.0016778238197373628
Bond Position:  [-5.29150274]


portfolio before change:  [-5.12273699]
curr_Stock_Price:  101.37464351989871
curr_Factors:  [1.01374644e+02 3.90758029e-02]
mat_Sqrt:  [[ 2.00393345e+01  0.00000000e+00]
 [-7.90704020e-03  1.81173051e-02]]
grads:  [-0.00722262 -3.45277653]
Stock Position:  -0.007222622914039193
Bond Position:  [-4.39054617]


portfolio before change:  [-5.13554618]
curr_Stock_Price:  102.99613408136396
curr_Factors:  [1.02996134e+02 3.96838282e-02]
mat_Sqrt:  [[ 2.05176541e+01  0.00000000e+00]
 [-7.96832010e-03  1.82577150e-02]]
grads:  [-0.00867753 -6.47126276]
Stock Position:  -0.00867753018872114
Bond Position:  [-4.24179412]


portfolio before change:  [-5.12583518]
curr_Stock_Price:  101.75481538063914
curr_Factors:  [1.01754815e+02 3.87687475e-02]
mat_Sqrt:  [[ 2.00353003e+01  0.00000000e+00]
 [-7.87591239e-03  1.80459824e-02]]
grads:  [-1.93817592e-02 -2.80441616e+01]
Stock Position:  -0.019381759198773933
Bond Position:  [-3.15364785]


portfolio before change:  [-5.14162166]
curr_Stock_Price:  102.52863406717054
curr_Factors:  [1.02528634e+02 4.01587913e-02]
mat_Sqrt:  [[ 2.05463881e+01  0.00000000e+00]
 [-8.01586341e-03  1.83666504e-02]]
grads:  [-3.16381888e-03 -9.37543777e+00]
Stock Position:  -0.0031638188826655623
Bond Position:  [-4.81723963]


portfolio before change:  [-5.13893697]
curr_Stock_Price:  101.29937539388308
curr_Factors:  [1.01299375e+02 4.05896941e-02]
mat_Sqrt:  [[ 2.04086678e+01  0.00000000e+00]
 [-8.05875366e-03  1.84649243e-02]]
grads:  [ 0.00401491 -2.94525254]
Stock Position:  0.00401491497925898
Bond Position:  [-5.54564535]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.1425979]
Stock Price:  100.73290154425256
PL:  [-5.87549944]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.02891388e-01 -2.23411604e-02]
 [ 4.38918423e-02 -5.47061664e-02]
 [ 5.43317243e-01 -2.29836212e-01]
 [-8.78909689e-02 -8.97831831e-02]
 [ 2.88701622e-01 -9.78547078e-03]
 [-1.06658505e-01 -1.99946500e-01]
 [-1.79131776e-02 -6.30881635e-02]
 [-1.26059153e+00  7.17556346e-01]
 [ 8.82601395e-02 -7.41054417e-02]
 [ 5.62901788e-02  3.31173435e-02]
 [-3.67154506e-02  1.87607087e-02]
 [ 3.93525185e-02 -8.78282400e-03]
 [ 1.35498717e-01 -1.52124643e-02]
 [ 1.56277071e-02  3.32874301e-02]
 [-7.98222065e-02 -3.62344030e-02]
 [-1.41069321e-01 -1.28872542e-01]
 [-1.78400220e-01 -4.51218072e-01]
 [ 2.85758004e-01 -2.55008402e-01]
 [-5.13232746e-02 -1.38151383e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.98859746]
curr_Stock_Price:  97.49764953103833
curr_Factors:  [9.74976495e+01 3.94593478e-02]
mat_Sqrt:  [[ 1.93673008e+01  0.00000000e+00]
 [-7.94575085e-03  1.82060024e-02]]
grads:  [ 0.00480918 -1.22713158]
Stock Position:  0.004809183651462558
Bond Position:  [-14.45748157]


portfolio before change:  [-13.98829895]
curr_Stock_Price:  98.31137114688678
curr_Factors:  [9.83113711e+01 4.04158894e-02]
mat_Sqrt:  [[ 1.97642265e+01  0.00000000e+00]
 [-8.04148139e-03  1.84253486e-02]]
grads:  [ 1.01274461e-03 -2.96907090e+00]
Stock Position:  0.0010127446092271502
Bond Position:  [-14.08786326]


portfolio before change:  [-13.99248936]
curr_Stock_Price:  97.65177104204844
curr_Factors:  [9.76517710e+01 4.06923303e-02]
mat_Sqrt:  [[ 1.96986473e+01  0.00000000e+00]
 [-8.06893602e-03  1.84882550e-02]]
grads:  [  0.02248929 -12.43147128]
Stock Position:  0.02248928517043578
Bond Position:  [-16.18860789]


portfolio before change:  [-14.03292228]
curr_Stock_Price:  96.0338778427729
curr_Factors:  [9.60338778e+01 4.14677136e-02]
mat_Sqrt:  [[ 1.95559767e+01  0.00000000e+00]
 [-8.14544914e-03  1.86635686e-02]]
grads:  [-0.00649804 -4.81061178]
Stock Position:  -0.006498042231295796
Bond Position:  [-13.40889009]


portfolio before change:  [-14.0457641]
curr_Stock_Price:  97.49419091429097
curr_Factors:  [9.74941909e+01 4.13665048e-02]
mat_Sqrt:  [[ 1.98291069e+01  0.00000000e+00]
 [-8.13550291e-03  1.86407790e-02]]
grads:  [ 0.01434411 -0.52494967]
Stock Position:  0.014344110129847062
Bond Position:  [-15.44423151]


portfolio before change:  [-14.05850034]
curr_Stock_Price:  96.87549124313638
curr_Factors:  [9.68754912e+01 4.09129144e-02]
mat_Sqrt:  [[ 1.95949485e+01  0.00000000e+00]
 [-8.09077642e-03  1.85382977e-02]]
grads:  [-9.89654612e-03 -1.07855912e+01]
Stock Position:  -0.009896546118104671
Bond Position:  [-13.09976757]


portfolio before change:  [-14.06692546]
curr_Stock_Price:  97.39585197246691
curr_Factors:  [9.73958520e+01 4.23591434e-02]
mat_Sqrt:  [[ 2.00453686e+01  0.00000000e+00]
 [-8.23253482e-03  1.88631070e-02]]
grads:  [-2.26721246e-03 -3.34452662e+00]
Stock Position:  -0.002267212463691636
Bond Position:  [-13.84610837]


portfolio before change:  [-14.07264807]
curr_Stock_Price:  98.39295661721242
curr_Factors:  [9.83929566e+01 4.03778767e-02]
mat_Sqrt:  [[ 1.97713238e+01  0.00000000e+00]
 [-8.03769885e-03  1.84166817e-02]]
grads:  [-0.04791911 38.96230378]
Stock Position:  -0.0479191109868124
Bond Position:  [-9.35774506]


portfolio before change:  [-14.15210596]
curr_Stock_Price:  100.00229698142498
curr_Factors:  [1.00002297e+02 3.88320969e-02]
mat_Sqrt:  [[ 1.97063139e+01  0.00000000e+00]
 [-7.88234451e-03  1.80607202e-02]]
grads:  [ 2.83756127e-03 -4.10312773e+00]
Stock Position:  0.0028375612737706235
Bond Position:  [-14.4358686]


portfolio before change:  [-14.15420607]
curr_Stock_Price:  100.53419767707538
curr_Factors:  [1.00534198e+02 3.95119213e-02]
mat_Sqrt:  [[ 1.99837915e+01  0.00000000e+00]
 [-7.95104233e-03  1.82181267e-02]]
grads:  [0.00354006 1.81782376]
Stock Position:  0.0035400575683464195
Bond Position:  [-14.51010292]


portfolio before change:  [-14.16127733]
curr_Stock_Price:  99.56153766847142
curr_Factors:  [9.95615377e+01 4.01647078e-02]
mat_Sqrt:  [[ 1.99532618e+01  0.00000000e+00]
 [-8.01645386e-03  1.83680033e-02]]
grads:  [-0.00142972  1.02137986]
Stock Position:  -0.0014297214332838943
Bond Position:  [-14.01893206]


portfolio before change:  [-14.16472619]
curr_Stock_Price:  99.52215320368339
curr_Factors:  [9.95221532e+01 3.97392391e-02]
mat_Sqrt:  [[ 1.98394458e+01  0.00000000e+00]
 [-7.97388127e-03  1.82704572e-02]]
grads:  [ 0.00179034 -0.48071178]
Stock Position:  0.0017903413301983064
Bond Position:  [-14.34290481]


portfolio before change:  [-14.16612666]
curr_Stock_Price:  100.74298564322368
curr_Factors:  [1.00742986e+02 4.09309056e-02]
mat_Sqrt:  [[ 2.03817042e+01  0.00000000e+00]
 [-8.09255515e-03  1.85423733e-02]]
grads:  [ 0.00632231 -0.82041625]
Stock Position:  0.006322310074061508
Bond Position:  [-14.80305505]


portfolio before change:  [-14.17675122]
curr_Stock_Price:  99.64792185139164
curr_Factors:  [9.96479219e+01 4.11599469e-02]
mat_Sqrt:  [[ 2.02164850e+01  0.00000000e+00]
 [-8.11516574e-03  1.85941806e-02]]
grads:  [1.49163084e-03 1.79020688e+00]
Stock Position:  0.0014916308441430212
Bond Position:  [-14.32538913]


portfolio before change:  [-14.18054512]
curr_Stock_Price:  99.5057223471737
curr_Factors:  [9.95057223e+01 4.02254962e-02]
mat_Sqrt:  [[ 1.99571610e+01  0.00000000e+00]
 [-8.02251793e-03  1.83818978e-02]]
grads:  [-0.00479207 -1.97120033]
Stock Position:  -0.00479207419859913
Bond Position:  [-13.70370631]


portfolio before change:  [-14.19259329]
curr_Stock_Price:  101.30490413747647
curr_Factors:  [1.01304904e+02 4.17313074e-02]
mat_Sqrt:  [[ 2.06948110e+01  0.00000000e+00]
 [-8.17129683e-03  1.87227931e-02]]
grads:  [-0.00953446 -6.88318999]
Stock Position:  -0.00953446299116528
Bond Position:  [-13.22670543]


portfolio before change:  [-14.18652637]
curr_Stock_Price:  100.32173311641067
curr_Factors:  [1.00321733e+02 4.01094013e-02]
mat_Sqrt:  [[ 2.00917662e+01  0.00000000e+00]
 [-8.01093266e-03  1.83553527e-02]]
grads:  [-1.86806838e-02 -2.45823701e+01]
Stock Position:  -0.01868068380363422
Bond Position:  [-12.31244779]


portfolio before change:  [-14.15659839]
curr_Stock_Price:  98.55485582799547
curr_Factors:  [9.85548558e+01 3.94425547e-02]
mat_Sqrt:  [[ 1.95731419e+01  0.00000000e+00]
 [-7.94405989e-03  1.82021279e-02]]
grads:  [ 8.91339849e-03 -1.40098127e+01]
Stock Position:  0.008913398487123301
Bond Position:  [-15.03505709]


portfolio before change:  [-14.16918336]
curr_Stock_Price:  97.56469116008071
curr_Factors:  [9.75646912e+01 3.85141762e-02]
mat_Sqrt:  [[ 1.91470989e+01  0.00000000e+00]
 [-7.85001159e-03  1.79866362e-02]]
grads:  [-5.82947222e-03 -7.68077931e+00]
Stock Position:  -0.005829472218250855
Bond Position:  [-13.6004327]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.16444111]
Stock Price:  96.16786080116148
PL:  [-14.16444111]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.47510861e-02  2.72665770e-02]
 [ 2.82295268e-02 -7.82421407e-02]
 [ 3.43650713e-01 -1.68897248e-01]
 [-8.23069999e-02 -8.13254117e-02]
 [ 3.38160399e-01 -1.34048072e-02]
 [ 6.18513071e-03 -1.16608617e-01]
 [-3.52506923e-02 -8.79922173e-02]
 [-1.38451660e+00  7.46693634e-01]
 [ 4.75717692e-02 -7.44020897e-02]
 [ 8.31791737e-02  1.55503417e-01]
 [-6.00168878e-02 -4.54055497e-02]
 [ 4.36594987e-02 -8.71640195e-03]
 [ 1.30357214e-01 -1.32732776e-02]
 [ 6.26141127e-02  9.83833974e-02]
 [-3.41384654e-03 -4.94957807e-03]
 [-1.42365745e-01 -1.34694134e-01]
 [-1.90896233e-01 -3.84007078e-01]
 [ 2.88198359e-01 -2.59326104e-01]
 [-8.02377370e-02 -1.45571674e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.53446788]
curr_Stock_Price:  100.89016794880861
curr_Factors:  [1.00890168e+02 4.17534717e-02]
mat_Sqrt:  [[ 2.06155602e+01  0.00000000e+00]
 [-8.17346651e-03  1.87277645e-02]]
grads:  [1.29277088e-03 1.45594404e+00]
Stock Position:  0.0012927708818024086
Bond Position:  [8.40404001]


portfolio before change:  [8.53116277]
curr_Stock_Price:  96.70815752690308
curr_Factors:  [9.67081575e+01 4.38569291e-02]
mat_Sqrt:  [[ 2.02526668e+01  0.00000000e+00]
 [-8.37681840e-03  1.91937022e-02]]
grads:  [-2.92215487e-04 -4.07644861e+00]
Stock Position:  -0.00029221548699485896
Bond Position:  [8.55942239]


portfolio before change:  [8.5341978]
curr_Stock_Price:  93.64566430911806
curr_Factors:  [9.36456643e+01 4.79895996e-02]
mat_Sqrt:  [[ 2.05145142e+01  0.00000000e+00]
 [-8.76261144e-03  2.00776651e-02]]
grads:  [ 0.01315839 -8.41219568]
Stock Position:  0.013158386696003874
Bond Position:  [7.30197194]


portfolio before change:  [8.5636226]
curr_Stock_Price:  95.74311561482091
curr_Factors:  [9.57431156e+01 4.71831205e-02]
mat_Sqrt:  [[ 2.07970093e+01  0.00000000e+00]
 [-8.68867037e-03  1.99082448e-02]]
grads:  [-0.00566429 -4.08501163]
Stock Position:  -0.005664291330842816
Bond Position:  [9.1059395]


portfolio before change:  [8.56378406]
curr_Stock_Price:  96.11656195725986
curr_Factors:  [9.61165620e+01 4.68034223e-02]
mat_Sqrt:  [[ 2.07939518e+01  0.00000000e+00]
 [-8.65363945e-03  1.98279789e-02]]
grads:  [ 0.01598109 -0.67605515]
Stock Position:  0.015981092232174223
Bond Position:  [7.02773642]


portfolio before change:  [8.59611265]
curr_Stock_Price:  98.02953726688735
curr_Factors:  [9.80295373e+01 4.60100665e-02]
mat_Sqrt:  [[ 2.10272938e+01  0.00000000e+00]
 [-8.57998289e-03  1.96592105e-02]]
grads:  [-2.12614341e-03 -5.93150050e+00]
Stock Position:  -0.0021261434079613965
Bond Position:  [8.8045375]


portfolio before change:  [8.59789278]
curr_Stock_Price:  98.22767805177398
curr_Factors:  [9.82276781e+01 4.61469759e-02]
mat_Sqrt:  [[ 2.11011197e+01  0.00000000e+00]
 [-8.59273888e-03  1.96884382e-02]]
grads:  [-3.49050881e-03 -4.46923298e+00]
Stock Position:  -0.003490508811912105
Bond Position:  [8.94075736]


portfolio before change:  [8.58434641]
curr_Stock_Price:  102.74903546847835
curr_Factors:  [1.02749035e+02 4.33405670e-02]
mat_Sqrt:  [[ 2.13907025e+01  0.00000000e+00]
 [-8.32735895e-03  1.90803764e-02]]
grads:  [-0.04949032 39.13411453]
Stock Position:  -0.04949032301705338
Bond Position:  [13.66942937]


portfolio before change:  [8.56826808]
curr_Stock_Price:  103.14297337751145
curr_Factors:  [1.03142973e+02 4.03921440e-02]
mat_Sqrt:  [[ 2.07294653e+01  0.00000000e+00]
 [-8.03911876e-03  1.84199351e-02]]
grads:  [ 7.28433411e-04 -4.03921562e+00]
Stock Position:  0.0007284334113980173
Bond Position:  [8.49313529]


portfolio before change:  [8.56894744]
curr_Stock_Price:  101.16037855659665
curr_Factors:  [1.01160379e+02 4.05511894e-02]
mat_Sqrt:  [[ 2.03709951e+01  0.00000000e+00]
 [-8.05493036e-03  1.84561640e-02]]
grads:  [7.41477911e-03 8.42555457e+00]
Stock Position:  0.007414779114157136
Bond Position:  [7.81886558]


portfolio before change:  [8.56238405]
curr_Stock_Price:  100.01154389559312
curr_Factors:  [1.00011544e+02 3.98989846e-02]
mat_Sqrt:  [[ 1.99770361e+01  0.00000000e+00]
 [-7.98989208e-03  1.83071426e-02]]
grads:  [-0.00399626 -2.48020953]
Stock Position:  -0.003996263211615717
Bond Position:  [8.9620565]


portfolio before change:  [8.56731754]
curr_Stock_Price:  99.33773932575161
curr_Factors:  [9.93377393e+01 4.40817276e-02]
mat_Sqrt:  [[ 2.08566030e+01  0.00000000e+00]
 [-8.39825959e-03  1.92428301e-02]]
grads:  [ 0.00191092 -0.45296881]
Stock Position:  0.0019109223538328372
Bond Position:  [8.37749084]


portfolio before change:  [8.57244205]
curr_Stock_Price:  100.92329611870764
curr_Factors:  [1.00923296e+02 4.42173162e-02]
mat_Sqrt:  [[ 2.12220638e+01  0.00000000e+00]
 [-8.41116555e-03  1.92724014e-02]]
grads:  [ 0.00586956 -0.68871944]
Stock Position:  0.005869564918303006
Bond Position:  [7.98006622]


portfolio before change:  [8.5722291]
curr_Stock_Price:  100.54708054001213
curr_Factors:  [1.00547081e+02 4.16463523e-02]
mat_Sqrt:  [[ 2.05190830e+01  0.00000000e+00]
 [-8.16297517e-03  1.87037258e-02]]
grads:  [5.14409671e-03 5.26009622e+00]
Stock Position:  0.005144096707652573
Bond Position:  [8.05500519]


portfolio before change:  [8.56330919]
curr_Stock_Price:  98.42155517705405
curr_Factors:  [9.84215552e+01 4.28224019e-02]
mat_Sqrt:  [[ 2.03669377e+01  0.00000000e+00]
 [-8.27742974e-03  1.89659742e-02]]
grads:  [-0.00027368 -0.26097147]
Stock Position:  -0.0002736798033296141
Bond Position:  [8.59024518]


portfolio before change:  [8.56530381]
curr_Stock_Price:  98.98138606068984
curr_Factors:  [9.89813861e+01 4.15601563e-02]
mat_Sqrt:  [[ 2.01786504e+01  0.00000000e+00]
 [-8.15452329e-03  1.86843601e-02]]
grads:  [-0.00996851 -7.20892409]
Stock Position:  -0.009968510284972242
Bond Position:  [9.55200077]


portfolio before change:  [8.5730347]
curr_Stock_Price:  98.44543931157004
curr_Factors:  [9.84454393e+01 4.18470832e-02]
mat_Sqrt:  [[ 2.01385500e+01  0.00000000e+00]
 [-8.18262385e-03  1.87487466e-02]]
grads:  [-1.78012152e-02 -2.04817466e+01]
Stock Position:  -0.017801215186524038
Bond Position:  [10.32548315]


portfolio before change:  [8.58184138]
curr_Stock_Price:  98.09574443598959
curr_Factors:  [9.80957444e+01 4.15376607e-02]
mat_Sqrt:  [[ 1.99926878e+01  0.00000000e+00]
 [-8.15231605e-03  1.86793027e-02]]
grads:  [ 8.75415904e-03 -1.38830720e+01]
Stock Position:  0.008754159036968709
Bond Position:  [7.72309564]


portfolio before change:  [8.57346145]
curr_Stock_Price:  96.91791030305359
curr_Factors:  [9.69179103e+01 4.13991745e-02]
mat_Sqrt:  [[ 1.97196809e+01  0.00000000e+00]
 [-8.13871483e-03  1.86481384e-02]]
grads:  [-7.29070746e-03 -7.80623089e+00]
Stock Position:  -0.007290707455270126
Bond Position:  [9.28006158]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.57796195]
Stock Price:  96.61887348098617
PL:  [8.57796195]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.19214525e-02  1.04148073e-01]
 [ 8.38393329e-02 -9.72327381e-03]
 [ 6.13789077e-01 -2.51344476e-01]
 [-1.01674370e-01 -9.19921990e-02]
 [-1.05175944e-02 -1.21963599e-02]
 [ 1.80946172e-02 -1.87827540e-02]
 [-6.54331416e-02 -1.31341425e-01]
 [-1.25028751e+00  7.34768070e-01]
 [ 8.24660933e-02 -6.29428197e-02]
 [ 2.79469182e-02 -6.88423827e-02]
 [-3.13035054e-02  3.36959182e-02]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 5.39535386e-02 -3.18118398e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.16805629e-01 -6.21976259e-02]
 [-1.08545380e-01 -1.10551573e-01]
 [-1.70097079e-01 -4.92316598e-01]
 [ 2.53424078e-01 -2.28033407e-01]
 [ 4.85413326e-02 -1.12524751e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.15720662]
curr_Stock_Price:  98.82787060097485
curr_Factors:  [9.88278706e+01 4.19291675e-02]
mat_Sqrt:  [[ 2.02366005e+01  0.00000000e+00]
 [-8.19064515e-03  1.87671257e-02]]
grads:  [3.82353736e-03 5.54949514e+00]
Stock Position:  0.0038235373616992787
Bond Position:  [-5.53507868]


portfolio before change:  [-5.15168867]
curr_Stock_Price:  100.63297864888192
curr_Factors:  [1.00632979e+02 4.19828412e-02]
mat_Sqrt:  [[ 2.06194103e+01  0.00000000e+00]
 [-8.19588592e-03  1.87791338e-02]]
grads:  [ 0.00386023 -0.51777009]
Stock Position:  0.003860233977374847
Bond Position:  [-5.54015551]


portfolio before change:  [-5.16180528]
curr_Stock_Price:  98.37109470238387
curr_Factors:  [9.83710947e+01 4.39261074e-02]
mat_Sqrt:  [[ 2.06171611e+01  0.00000000e+00]
 [-8.38342244e-03  1.92088340e-02]]
grads:  [  0.02445018 -13.08483777]
Stock Position:  0.02445018267296756
Bond Position:  [-7.56699652]


portfolio before change:  [-5.14952261]
curr_Stock_Price:  98.95083113782937
curr_Factors:  [9.89508311e+01 4.37491117e-02]
mat_Sqrt:  [[ 2.06968411e+01  0.00000000e+00]
 [-8.36651533e-03  1.91700949e-02]]
grads:  [-0.0068524  -4.79873467]
Stock Position:  -0.0068524010966649375
Bond Position:  [-4.47147182]


portfolio before change:  [-5.16264469]
curr_Stock_Price:  100.70263765765323
curr_Factors:  [1.00702638e+02 4.10646197e-02]
mat_Sqrt:  [[ 2.04067925e+01  0.00000000e+00]
 [-8.10576286e-03  1.85726359e-02]]
grads:  [-0.00077624 -0.65668438]
Stock Position:  -0.000776237726083208
Bond Position:  [-5.08447551]


portfolio before change:  [-5.16436545]
curr_Stock_Price:  101.2816797458876
curr_Factors:  [1.01281680e+02 3.95039019e-02]
mat_Sqrt:  [[ 2.01303299e+01  0.00000000e+00]
 [-7.95023541e-03  1.82162778e-02]]
grads:  [ 4.91653703e-04 -1.03109726e+00]
Stock Position:  0.0004916537028607168
Bond Position:  [-5.21416096]


portfolio before change:  [-5.16644578]
curr_Stock_Price:  99.70205149816678
curr_Factors:  [9.97020515e+01 3.91826959e-02]
mat_Sqrt:  [[ 1.97356417e+01  0.00000000e+00]
 [-7.91784778e-03  1.81420684e-02]]
grads:  [-6.21997709e-03 -7.23960589e+00]
Stock Position:  -0.006219977086416536
Bond Position:  [-4.5463013]


portfolio before change:  [-5.16385325]
curr_Stock_Price:  99.10249259186907
curr_Factors:  [9.91024926e+01 3.98448476e-02]
mat_Sqrt:  [[ 1.97820212e+01  0.00000000e+00]
 [-7.98446969e-03  1.82947184e-02]]
grads:  [-0.04699259 40.16285218]
Stock Position:  -0.046992590896772476
Bond Position:  [-0.50677036]


portfolio before change:  [-5.17340475]
curr_Stock_Price:  99.30305166340213
curr_Factors:  [9.93030517e+01 3.90930111e-02]
mat_Sqrt:  [[ 1.96341523e+01  0.00000000e+00]
 [-7.90878105e-03  1.81212939e-02]]
grads:  [ 2.80101701e-03 -3.47341752e+00]
Stock Position:  0.0028010170086502947
Bond Position:  [-5.45155429]


portfolio before change:  [-5.17406226]
curr_Stock_Price:  99.5549439271682
curr_Factors:  [9.95549439e+01 4.04793154e-02]
mat_Sqrt:  [[ 2.00299291e+01  0.00000000e+00]
 [-8.04778880e-03  1.84398007e-02]]
grads:  [-1.04761272e-04 -3.73335829e+00]
Stock Position:  -0.00010476127165275526
Bond Position:  [-5.16363276]


portfolio before change:  [-5.17534305]
curr_Stock_Price:  99.45687266194228
curr_Factors:  [9.94568727e+01 4.03334963e-02]
mat_Sqrt:  [[ 1.99741237e+01  0.00000000e+00]
 [-8.03328041e-03  1.84065578e-02]]
grads:  [-8.30945144e-04  1.83064746e+00]
Stock Position:  -0.0008309451441467827
Bond Position:  [-5.09269985]


portfolio before change:  [-5.17608444]
curr_Stock_Price:  98.81669561818916
curr_Factors:  [9.88166956e+01 4.28030663e-02]
mat_Sqrt:  [[ 2.04440892e+01  0.00000000e+00]
 [-8.27556077e-03  1.89616918e-02]]
grads:  [ 0.00234867 -0.45309158]
Stock Position:  0.002348672896117765
Bond Position:  [-5.40817253]


portfolio before change:  [-5.16858474]
curr_Stock_Price:  102.58559314764571
curr_Factors:  [1.02585593e+02 4.05761157e-02]
mat_Sqrt:  [[ 2.06643433e+01  0.00000000e+00]
 [-8.05740561e-03  1.84618356e-02]]
grads:  [ 0.00193908 -1.7231136 ]
Stock Position:  0.0019390750900547832
Bond Position:  [-5.36750591]


portfolio before change:  [-5.17005079]
curr_Stock_Price:  102.52164040968256
curr_Factors:  [1.02521640e+02 4.36917074e-02]
mat_Sqrt:  [[ 2.14296489e+01  0.00000000e+00]
 [-8.36102457e-03  1.91575140e-02]]
grads:  [7.10404276e-03 7.75560386e+00]
Stock Position:  0.007104042759176712
Bond Position:  [-5.89836891]


portfolio before change:  [-5.17231973]
curr_Stock_Price:  102.40985005590173
curr_Factors:  [1.02409850e+02 4.30443752e-02]
mat_Sqrt:  [[ 2.12471133e+01  0.00000000e+00]
 [-8.29885536e-03  1.90150664e-02]]
grads:  [-0.00677508 -3.27096548]
Stock Position:  -0.006775080278925237
Bond Position:  [-4.47848478]


portfolio before change:  [-5.18212052]
curr_Stock_Price:  103.69116701006934
curr_Factors:  [1.03691167e+02 4.10981033e-02]
mat_Sqrt:  [[ 2.10209651e+01  0.00000000e+00]
 [-8.10906686e-03  1.85802063e-02]]
grads:  [-0.00745894 -5.94996474]
Stock Position:  -0.007458936384268676
Bond Position:  [-4.4086947]


portfolio before change:  [-5.16622526]
curr_Stock_Price:  101.41234752395594
curr_Factors:  [1.01412348e+02 4.21105387e-02]
mat_Sqrt:  [[ 2.08106783e+01  0.00000000e+00]
 [-8.20834100e-03  1.88076720e-02]]
grads:  [-1.84982754e-02 -2.61763709e+01]
Stock Position:  -0.018498275418277085
Bond Position:  [-3.29027173]


portfolio before change:  [-5.15570043]
curr_Stock_Price:  100.79891201544466
curr_Factors:  [1.00798912e+02 4.27681608e-02]
mat_Sqrt:  [[ 2.08456831e+01  0.00000000e+00]
 [-8.27218577e-03  1.89539587e-02]]
grads:  [ 7.38292622e-03 -1.20309119e+01]
Stock Position:  0.007382926215347867
Bond Position:  [-5.89989136]


portfolio before change:  [-5.164496]
curr_Stock_Price:  99.80737944994092
curr_Factors:  [9.98073794e+01 4.29277883e-02]
mat_Sqrt:  [[ 2.06791131e+01  0.00000000e+00]
 [-8.28760890e-03  1.89892975e-02]]
grads:  [-2.74912577e-05 -5.92569317e+00]
Stock Position:  -2.7491257650662885e-05
Bond Position:  [-5.16175217]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.16570674]
Stock Price:  96.90242929861344
PL:  [-5.16570674]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.58286981e-02  2.85916842e-02]
 [ 5.83517592e-02 -2.63819957e-03]
 [ 8.10990577e-01 -3.11531104e-01]
 [ 2.13811028e-01 -1.14108627e-01]
 [ 1.88481699e-01 -5.44401343e-03]
 [ 3.43023428e-02 -6.53299942e-02]
 [-8.98187228e-02 -1.68208474e-01]
 [-1.28455200e+00  7.37980079e-01]
 [ 6.39801900e-02 -3.65448663e-02]
 [ 1.64106489e-02 -8.24769472e-02]
 [ 9.58347595e-02  3.00396523e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.65124190e-01 -2.87316664e-02]
 [-6.08930148e-02 -7.04551107e-02]
 [-1.18295383e-01 -6.30431410e-02]
 [-1.43048387e-01 -1.37759539e-01]
 [-1.90626937e-01 -3.87760873e-01]
 [ 2.85004077e-01 -2.53674484e-01]
 [ 1.86163743e-02 -1.20204404e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.61944909]
curr_Stock_Price:  100.75234398669188
curr_Factors:  [1.00752344e+02 3.90586189e-02]
mat_Sqrt:  [[ 1.99119412e+01  0.00000000e+00]
 [-7.90530140e-03  1.81133210e-02]]
grads:  [1.42161590e-03 1.57848934e+00]
Stock Position:  0.0014216158957197586
Bond Position:  [7.47621795]


portfolio before change:  [7.62227659]
curr_Stock_Price:  101.42637268786012
curr_Factors:  [1.01426373e+02 3.82373885e-02]
mat_Sqrt:  [[ 1.98333011e+01  0.00000000e+00]
 [-7.82175310e-03  1.79218878e-02]]
grads:  [ 0.00288406 -0.14720545]
Stock Position:  0.0028840561729028672
Bond Position:  [7.32975723]


portfolio before change:  [7.62690477]
curr_Stock_Price:  102.39567146845619
curr_Factors:  [1.02395671e+02 3.84881657e-02]
mat_Sqrt:  [[ 2.00883934e+01  0.00000000e+00]
 [-7.84736039e-03  1.79805615e-02]]
grads:  [  0.03360285 -17.32599418]
Stock Position:  0.03360284932442908
Bond Position:  [4.18611845]


portfolio before change:  [7.59275614]
curr_Stock_Price:  101.34828150005882
curr_Factors:  [1.01348282e+02 3.86405112e-02]
mat_Sqrt:  [[ 1.99222241e+01  0.00000000e+00]
 [-7.86287593e-03  1.80161121e-02]]
grads:  [ 0.00823251 -6.3336988 ]
Stock Position:  0.008232511543757627
Bond Position:  [6.75840524]


portfolio before change:  [7.57708729]
curr_Stock_Price:  99.23973152951059
curr_Factors:  [9.92397315e+01 4.03805838e-02]
mat_Sqrt:  [[ 1.99421453e+01  0.00000000e+00]
 [-8.03796828e-03  1.84172990e-02]]
grads:  [ 0.00933228 -0.29559239]
Stock Position:  0.009332282659095652
Bond Position:  [6.65095406]


portfolio before change:  [7.57935294]
curr_Stock_Price:  99.3043138825162
curr_Factors:  [9.93043139e+01 4.16779348e-02]
mat_Sqrt:  [[ 2.02731489e+01  0.00000000e+00]
 [-8.16606978e-03  1.87108165e-02]]
grads:  [ 2.85599231e-04 -3.49156299e+00]
Stock Position:  0.00028559923095341653
Bond Position:  [7.5509917]


portfolio before change:  [7.5818072]
curr_Stock_Price:  101.28709829963523
curr_Factors:  [1.01287098e+02 4.05198784e-02]
mat_Sqrt:  [[ 2.03886371e+01  0.00000000e+00]
 [-8.05182001e-03  1.84490373e-02]]
grads:  [-8.00597502e-03 -9.11746619e+00]
Stock Position:  -0.008005975022450536
Bond Position:  [8.39270918]


portfolio before change:  [7.59421173]
curr_Stock_Price:  99.99979880863506
curr_Factors:  [9.99997988e+01 3.91670147e-02]
mat_Sqrt:  [[ 1.97906183e+01  0.00000000e+00]
 [-7.91626323e-03  1.81384377e-02]]
grads:  [-0.04863269 40.68597803]
Stock Position:  -0.0486326942482116
Bond Position:  [12.45747137]


portfolio before change:  [7.70354033]
curr_Stock_Price:  97.81579808030588
curr_Factors:  [9.78157981e+01 3.92335569e-02]
mat_Sqrt:  [[ 1.93748275e+01  0.00000000e+00]
 [-7.92298498e-03  1.81538392e-02]]
grads:  [ 0.00247903 -2.01306544]
Stock Position:  0.0024790260869016006
Bond Position:  [7.46105241]


portfolio before change:  [7.70350353]
curr_Stock_Price:  97.04844217176763
curr_Factors:  [9.70484422e+01 4.23266972e-02]
mat_Sqrt:  [[ 1.99662157e+01  0.00000000e+00]
 [-8.22938124e-03  1.88558812e-02]]
grads:  [-9.80919077e-04 -4.37407015e+00]
Stock Position:  -0.0009809190774560613
Bond Position:  [7.7987002]


portfolio before change:  [7.7054515]
curr_Stock_Price:  97.05042436447226
curr_Factors:  [9.70504244e+01 4.22440919e-02]
mat_Sqrt:  [[ 1.99471305e+01  0.00000000e+00]
 [-8.22134704e-03  1.88374726e-02]]
grads:  [1.13770024e-02 1.59467531e+01]
Stock Position:  0.011377002374186347
Bond Position:  [6.60130859]


portfolio before change:  [7.69960378]
curr_Stock_Price:  96.39135280408112
curr_Factors:  [9.63913528e+01 4.23404762e-02]
mat_Sqrt:  [[ 1.98342574e+01  0.00000000e+00]
 [-8.23072062e-03  1.88589501e-02]]
grads:  [ 0.00242089 -0.45555998]
Stock Position:  0.0024208861150739527
Bond Position:  [7.46625129]


portfolio before change:  [7.7065082]
curr_Stock_Price:  98.47225616404418
curr_Factors:  [9.84722562e+01 4.17635127e-02]
mat_Sqrt:  [[ 2.01239115e+01  0.00000000e+00]
 [-8.17444924e-03  1.87300162e-02]]
grads:  [ 0.00758226 -1.53399047]
Stock Position:  0.0075822566829063295
Bond Position:  [6.95986628]


portfolio before change:  [7.69912868]
curr_Stock_Price:  97.26948660919244
curr_Factors:  [9.72694866e+01 4.34196173e-02]
mat_Sqrt:  [[ 2.02684071e+01  0.00000000e+00]
 [-8.33494977e-03  1.90977691e-02]]
grads:  [-0.00452143 -3.68918015]
Stock Position:  -0.0045214281237074974
Bond Position:  [8.13892567]


portfolio before change:  [7.68639215]
curr_Stock_Price:  100.53648946168292
curr_Factors:  [1.00536489e+02 4.35487103e-02]
mat_Sqrt:  [[ 2.09802841e+01  0.00000000e+00]
 [-8.34733110e-03  1.91261383e-02]]
grads:  [-0.00694984 -3.2961772 ]
Stock Position:  -0.0069498422645057675
Bond Position:  [8.38510489]


portfolio before change:  [7.70426588]
curr_Stock_Price:  98.26633851913661
curr_Factors:  [9.82663385e+01 4.35443633e-02]
mat_Sqrt:  [[ 2.05055181e+01  0.00000000e+00]
 [-8.34691448e-03  1.91251837e-02]]
grads:  [-0.00990814 -7.20304397]
Stock Position:  -0.009908141722820996
Bond Position:  [8.67790268]


portfolio before change:  [7.70301179]
curr_Stock_Price:  98.61189623279068
curr_Factors:  [9.86118962e+01 4.22630485e-02]
mat_Sqrt:  [[ 2.02726126e+01  0.00000000e+00]
 [-8.22319145e-03  1.88416986e-02]]
grads:  [-1.77510252e-02 -2.05799318e+01]
Stock Position:  -0.017751025217451533
Bond Position:  [9.45347404]


portfolio before change:  [7.70632123]
curr_Stock_Price:  98.55861610852733
curr_Factors:  [9.85586161e+01 4.45309557e-02]
mat_Sqrt:  [[ 2.07981930e+01  0.00000000e+00]
 [-8.44094361e-03  1.93406315e-02]]
grads:  [ 8.38012493e-03 -1.31161427e+01]
Stock Position:  0.0083801249309541
Bond Position:  [6.88038771]


portfolio before change:  [7.71289873]
curr_Stock_Price:  99.13822418889032
curr_Factors:  [9.91382242e+01 4.62862894e-02]
mat_Sqrt:  [[ 2.13288440e+01  0.00000000e+00]
 [-8.60569945e-03  1.97181346e-02]]
grads:  [-1.58682433e-03 -6.09613469e+00]
Stock Position:  -0.001586824333627846
Bond Position:  [7.87021367]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.71719814]
Stock Price:  97.6688668962842
PL:  [7.71719814]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.14157878e-02  1.12405671e-01]
 [ 5.50480536e-02 -3.79415761e-02]
 [ 6.12263893e-01 -2.50878984e-01]
 [-5.00224011e-02 -9.66498836e-02]
 [ 4.65067132e-02 -1.15051975e-02]
 [ 2.93413297e-02 -1.81577593e-02]
 [-5.78247394e-02 -1.20412077e-01]
 [-1.29414029e+00  7.39487214e-01]
 [ 7.89214036e-02 -5.79046353e-02]
 [ 1.70732543e-02 -9.48875255e-02]
 [-1.30261956e-01 -8.42612086e-02]
 [ 2.50925310e-02 -9.00274086e-03]
 [ 1.06461765e-01 -1.70106608e-02]
 [ 8.68764264e-02  1.39760971e-01]
 [-1.17829376e-01 -6.27786572e-02]
 [-1.40318507e-01 -1.25501010e-01]
 [-1.58884189e-01 -5.48468981e-01]
 [ 1.62416540e-01 -2.09341918e-01]
 [ 1.24648446e-01 -1.49364340e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.89796772]
curr_Stock_Price:  100.19179887963638
curr_Factors:  [1.00191799e+02 3.92300013e-02]
mat_Sqrt:  [[ 1.98445537e+01  0.00000000e+00]
 [-7.92262595e-03  1.81530166e-02]]
grads:  [4.05520054e-03 6.19212080e+00]
Stock Position:  0.0040552005410776715
Bond Position:  [3.49166988]


portfolio before change:  [3.8965303]
curr_Stock_Price:  99.62204919072876
curr_Factors:  [9.96220492e+01 4.04195134e-02]
mat_Sqrt:  [[ 2.00286193e+01  0.00000000e+00]
 [-8.04184191e-03  1.84261746e-02]]
grads:  [ 1.92169973e-03 -2.05911302e+00]
Stock Position:  0.0019216997300477792
Bond Position:  [3.70508663]


portfolio before change:  [3.89599851]
curr_Stock_Price:  98.86325450213955
curr_Factors:  [9.88632545e+01 3.96098438e-02]
mat_Sqrt:  [[ 1.96759843e+01  0.00000000e+00]
 [-7.96088877e-03  1.82406877e-02]]
grads:  [  0.02555254 -13.75381172]
Stock Position:  0.02555253751918249
Bond Position:  [1.36979149]


portfolio before change:  [3.90826224]
curr_Stock_Price:  99.32979280689611
curr_Factors:  [9.93297928e+01 3.76504534e-02]
mat_Sqrt:  [[ 1.92736796e+01  0.00000000e+00]
 [-7.76148989e-03  1.77838075e-02]]
grads:  [-4.78392661e-03 -5.43471266e+00]
Stock Position:  -0.0047839266060663325
Bond Position:  [4.38344868]


portfolio before change:  [3.90454036]
curr_Stock_Price:  100.33689004220504
curr_Factors:  [1.00336890e+02 3.62365976e-02]
mat_Sqrt:  [[ 1.91000429e+01  0.00000000e+00]
 [-7.61436512e-03  1.74467023e-02]]
grads:  [ 0.00217201 -0.65944826]
Stock Position:  0.0021720073414836136
Bond Position:  [3.6866079]


portfolio before change:  [3.90700925]
curr_Stock_Price:  101.04919347002625
curr_Factors:  [1.01049193e+02 3.60130364e-02]
mat_Sqrt:  [[ 1.91762075e+01  0.00000000e+00]
 [-7.59084042e-03  1.73928004e-02]]
grads:  [ 0.00111683 -1.04398135]
Stock Position:  0.0011168336463339126
Bond Position:  [3.79415412]


portfolio before change:  [3.90604799]
curr_Stock_Price:  99.33907499423054
curr_Factors:  [9.93390750e+01 3.64559208e-02]
mat_Sqrt:  [[ 1.89672404e+01  0.00000000e+00]
 [-7.63737345e-03  1.74994210e-02]]
grads:  [-5.81934304e-03 -6.88091776e+00]
Stock Position:  -0.005819343035577894
Bond Position:  [4.48413615]


portfolio before change:  [3.90257067]
curr_Stock_Price:  100.12928485838384
curr_Factors:  [1.00129285e+02 3.32845763e-02]
mat_Sqrt:  [[ 1.82676478e+01  0.00000000e+00]
 [-7.29762442e-03  1.67209581e-02]]
grads:  [-0.05317606 44.22516988]
Stock Position:  -0.05317606422784461
Bond Position:  [9.22705195]


portfolio before change:  [3.96386326]
curr_Stock_Price:  99.0200348813031
curr_Factors:  [9.90200349e+01 3.36431643e-02]
mat_Sqrt:  [[ 1.81623271e+01  0.00000000e+00]
 [-7.33682921e-03  1.68107876e-02]]
grads:  [ 2.95390280e-03 -3.44449271e+00]
Stock Position:  0.002953902801765645
Bond Position:  [3.67136771]


portfolio before change:  [3.96490284]
curr_Stock_Price:  99.06120623277543
curr_Factors:  [9.90612062e+01 3.49732782e-02]
mat_Sqrt:  [[ 1.85255787e+01  0.00000000e+00]
 [-7.48045754e-03  1.71398815e-02]]
grads:  [-1.31380819e-03 -5.53606661e+00]
Stock Position:  -0.0013138081892733583
Bond Position:  [4.09505026]


portfolio before change:  [3.96298284]
curr_Stock_Price:  101.30193349598561
curr_Factors:  [1.01301933e+02 3.59341132e-02]
mat_Sqrt:  [[ 1.92030937e+01  0.00000000e+00]
 [-7.58251813e-03  1.73737316e-02]]
grads:  [-0.00869842 -4.84992   ]
Stock Position:  -0.008698419378448475
Bond Position:  [4.84414954]


portfolio before change:  [3.97370236]
curr_Stock_Price:  100.20882363376877
curr_Factors:  [1.00208824e+02 3.70846919e-02]
mat_Sqrt:  [[ 1.92976001e+01  0.00000000e+00]
 [-7.70295444e-03  1.76496859e-02]]
grads:  [ 0.00109669 -0.51007938]
Stock Position:  0.0010966862587433316
Bond Position:  [3.86380472]


portfolio before change:  [3.97603617]
curr_Stock_Price:  101.45597698812477
curr_Factors:  [1.01455977e+02 3.38905217e-02]
mat_Sqrt:  [[ 1.86774148e+01  0.00000000e+00]
 [-7.36375140e-03  1.68724741e-02]]
grads:  [ 0.00530254 -1.00819007]
Stock Position:  0.005302538133481763
Bond Position:  [3.43806198]


portfolio before change:  [3.97487723]
curr_Stock_Price:  101.07529914091104
curr_Factors:  [1.01075299e+02 3.62968419e-02]
mat_Sqrt:  [[ 1.92565932e+01  0.00000000e+00]
 [-7.62069203e-03  1.74611990e-02]]
grads:  [7.67909014e-03 8.00408784e+00]
Stock Position:  0.007679090144382738
Bond Position:  [3.1987109]


portfolio before change:  [3.97299498]
curr_Stock_Price:  100.72603582709662
curr_Factors:  [1.00726036e+02 3.74319392e-02]
mat_Sqrt:  [[ 1.94878041e+01  0.00000000e+00]
 [-7.73893421e-03  1.77321259e-02]]
grads:  [-0.00745226 -3.5403909 ]
Stock Position:  -0.007452262321408315
Bond Position:  [4.72363183]


portfolio before change:  [3.96400904]
curr_Stock_Price:  102.09031914026444
curr_Factors:  [1.02090319e+02 3.71535175e-02]
mat_Sqrt:  [[ 1.96781619e+01  0.00000000e+00]
 [-7.71009909e-03  1.76660563e-02]]
grads:  [-0.00991412 -7.10407619]
Stock Position:  -0.00991411898156011
Bond Position:  [4.97614461]


portfolio before change:  [3.95746579]
curr_Stock_Price:  102.87580991672341
curr_Factors:  [1.02875810e+02 3.50282682e-02]
mat_Sqrt:  [[ 1.92540724e+01  0.00000000e+00]
 [-7.48633616e-03  1.71533511e-02]]
grads:  [-2.06842308e-02 -3.19744509e+01]
Stock Position:  -0.02068423078367082
Bond Position:  [6.08537278]


portfolio before change:  [3.98490251]
curr_Stock_Price:  101.62291385177929
curr_Factors:  [1.01622914e+02 3.72298708e-02]
mat_Sqrt:  [[ 1.96081855e+01  0.00000000e+00]
 [-7.71801744e-03  1.76841996e-02]]
grads:  [ 3.62360081e-03 -1.18377944e+01]
Stock Position:  0.0036236008144428355
Bond Position:  [3.61666164]


portfolio before change:  [3.98677683]
curr_Stock_Price:  101.89061444638433
curr_Factors:  [1.01890614e+02 3.58648074e-02]
mat_Sqrt:  [[ 1.92960508e+01  0.00000000e+00]
 [-7.57520243e-03  1.73569693e-02]]
grads:  [ 0.00612196 -0.8605439 ]
Stock Position:  0.006121960041081701
Bond Position:  [3.36300656]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.97942873]
Stock Price:  100.55297819700485
PL:  [3.42645053]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [-7.43080395e-04  1.35814728e-01]
 [ 4.37774491e-02 -5.48780666e-02]
 [ 6.18710398e-01 -2.52846481e-01]
 [-1.21175965e-01 -1.32871916e-01]
 [ 2.64902429e-01 -8.04387319e-03]
 [-9.80471781e-02 -1.94155686e-01]
 [-2.29578455e-02 -7.03325050e-02]
 [-1.26937120e+00  7.06735829e-01]
 [ 8.93585645e-02 -7.39654796e-02]
 [ 3.40594649e-02 -5.47723015e-02]
 [-1.27573939e-02  8.37634637e-02]
 [ 2.63693839e-02 -8.98304929e-03]
 [ 1.62148641e-01 -2.66436655e-02]
 [-7.97180313e-03  4.09034523e-03]
 [ 1.01747404e-02  1.96067691e-03]
 [-1.41884616e-01 -1.32533621e-01]
 [-1.64329018e-01 -5.23229023e-01]
 [-4.53788129e-02 -1.61848256e-01]
 [ 1.19539317e-01 -2.50800076e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.20689919]
curr_Stock_Price:  99.57350663582399
curr_Factors:  [9.95735066e+01 4.01091892e-02]
mat_Sqrt:  [[ 1.99418637e+01  0.00000000e+00]
 [-8.01091148e-03  1.83553041e-02]]
grads:  [2.93509811e-03 7.39920882e+00]
Stock Position:  0.0029350981137347297
Bond Position:  [-0.4991572]


portfolio before change:  [-0.21077763]
curr_Stock_Price:  98.29462772703336
curr_Factors:  [9.82946277e+01 4.08159468e-02]
mat_Sqrt:  [[ 1.98584213e+01  0.00000000e+00]
 [-8.08118277e-03  1.85163159e-02]]
grads:  [ 9.98402489e-04 -2.96376812e+00]
Stock Position:  0.0009984024890498297
Bond Position:  [-0.30891523]


portfolio before change:  [-0.21017049]
curr_Stock_Price:  98.98010084483583
curr_Factors:  [9.89801008e+01 3.94787514e-02]
mat_Sqrt:  [[ 1.96666141e+01  0.00000000e+00]
 [-7.94770421e-03  1.82104781e-02]]
grads:  [  0.02584884 -13.88467015]
Stock Position:  0.025848839242475774
Bond Position:  [-2.76869121]


portfolio before change:  [-0.22441575]
curr_Stock_Price:  98.45578339294926
curr_Factors:  [9.84557834e+01 3.88894514e-02]
mat_Sqrt:  [[ 1.94158827e+01  0.00000000e+00]
 [-7.88816343e-03  1.80740530e-02]]
grads:  [-0.00922781 -7.35152853]
Stock Position:  -0.00922780722412581
Bond Position:  [0.68411524]


portfolio before change:  [-0.22147842]
curr_Stock_Price:  98.15600720708277
curr_Factors:  [9.81560072e+01 3.95506892e-02]
mat_Sqrt:  [[ 1.95206337e+01  0.00000000e+00]
 [-7.95494203e-03  1.82270620e-02]]
grads:  [ 0.01339054 -0.44131485]
Stock Position:  0.013390538405481765
Bond Position:  [-1.53584021]


portfolio before change:  [-0.23814905]
curr_Stock_Price:  96.93972877825762
curr_Factors:  [9.69397288e+01 4.04342109e-02]
mat_Sqrt:  [[ 1.94928924e+01  0.00000000e+00]
 [-8.04330389e-03  1.84295244e-02]]
grads:  [-9.37693917e-03 -1.05350351e+01]
Stock Position:  -0.00937693917144934
Bond Position:  [0.67084889]


portfolio before change:  [-0.24461303]
curr_Stock_Price:  97.64696475044619
curr_Factors:  [9.76469648e+01 3.87757588e-02]
mat_Sqrt:  [[ 1.92282120e+01  0.00000000e+00]
 [-7.87662454e-03  1.80476141e-02]]
grads:  [-2.79035135e-03 -3.89705280e+00]
Stock Position:  -0.0027903513494988864
Bond Position:  [0.02785631]


portfolio before change:  [-0.24543468]
curr_Stock_Price:  97.94392384785995
curr_Factors:  [9.79439238e+01 3.87809282e-02]
mat_Sqrt:  [[ 1.92879734e+01  0.00000000e+00]
 [-7.87714955e-03  1.80488170e-02]]
grads:  [-0.04981998 39.15690582]
Stock Position:  -0.049819977161084016
Bond Position:  [4.63412936]


portfolio before change:  [-0.34435983]
curr_Stock_Price:  99.9528332790802
curr_Factors:  [9.99528333e+01 3.83575289e-02]
mat_Sqrt:  [[ 1.95758406e+01  0.00000000e+00]
 [-7.83403129e-03  1.79500207e-02]]
grads:  [ 2.91570533e-03 -4.12063478e+00]
Stock Position:  0.0029157053304518774
Bond Position:  [-0.63579284]


portfolio before change:  [-0.34486668]
curr_Stock_Price:  99.83351990168049
curr_Factors:  [9.98335199e+01 3.69772561e-02]
mat_Sqrt:  [[ 1.91974579e+01  0.00000000e+00]
 [-7.69178847e-03  1.76241014e-02]]
grads:  [ 5.28969656e-04 -3.10780675e+00]
Stock Position:  0.0005289696557349192
Bond Position:  [-0.39767558]


portfolio before change:  [-0.34535237]
curr_Stock_Price:  99.10331657667054
curr_Factors:  [9.91033166e+01 3.71950961e-02]
mat_Sqrt:  [[ 1.91130956e+01  0.00000000e+00]
 [-7.71441209e-03  1.76759387e-02]]
grads:  [1.24521842e-03 4.73884105e+00]
Stock Position:  0.0012452184222161665
Bond Position:  [-0.46875764]


portfolio before change:  [-0.34425286]
curr_Stock_Price:  100.08042037822507
curr_Factors:  [1.00080420e+02 3.50216462e-02]
mat_Sqrt:  [[ 1.87291212e+01  0.00000000e+00]
 [-7.48562850e-03  1.71517296e-02]]
grads:  [ 0.00119861 -0.52374014]
Stock Position:  0.0011986072176360736
Bond Position:  [-0.46420998]


portfolio before change:  [-0.34485222]
curr_Stock_Price:  99.67721190430701
curr_Factors:  [9.96772119e+01 3.33814927e-02]
mat_Sqrt:  [[ 1.82116275e+01  0.00000000e+00]
 [-7.30824112e-03  1.67452841e-02]]
grads:  [ 0.00826507 -1.59111457]
Stock Position:  0.00826507090723217
Bond Position:  [-1.16869144]


portfolio before change:  [-0.34910284]
curr_Stock_Price:  99.19827926732177
curr_Factors:  [9.91982793e+01 3.17954996e-02]
mat_Sqrt:  [[ 1.76883354e+01  0.00000000e+00]
 [-7.13251704e-03  1.63426496e-02]]
grads:  [-0.00034976  0.25028654]
Stock Position:  -0.00034975762070995996
Bond Position:  [-0.31440749]


portfolio before change:  [-0.34880443]
curr_Stock_Price:  98.12031822454443
curr_Factors:  [9.81203182e+01 3.36309590e-02]
mat_Sqrt:  [[ 1.79940355e+01  0.00000000e+00]
 [-7.33549824e-03  1.68077380e-02]]
grads:  [0.00061301 0.11665323]
Stock Position:  0.0006130059022002543
Bond Position:  [-0.40895276]


portfolio before change:  [-0.34807926]
curr_Stock_Price:  99.47009373358958
curr_Factors:  [9.94700937e+01 3.02075929e-02]
mat_Sqrt:  [[ 1.72882322e+01  0.00000000e+00]
 [-6.95213267e-03  1.59293371e-02]]
grads:  [-0.01155277 -8.32009645]
Stock Position:  -0.011552773446574266
Bond Position:  [0.8010762]


portfolio before change:  [-0.37882716]
curr_Stock_Price:  102.14894757562598
curr_Factors:  [1.02148948e+02 2.89389935e-02]
mat_Sqrt:  [[ 1.73770323e+01  0.00000000e+00]
 [-6.80458593e-03  1.55912650e-02]]
grads:  [-2.25979257e-02 -3.35591129e+01]
Stock Position:  -0.022597925721377508
Bond Position:  [1.92952717]


portfolio before change:  [-0.39414893]
curr_Stock_Price:  102.84831346879815
curr_Factors:  [1.02848313e+02 2.71690436e-02]
mat_Sqrt:  [[ 1.69525233e+01  0.00000000e+00]
 [-6.59321392e-03  1.51069509e-02]]
grads:  [-6.84353478e-03 -1.07134958e+01]
Stock Position:  -0.006843534775870564
Bond Position:  [0.30969708]


portfolio before change:  [-0.38640608]
curr_Stock_Price:  101.72821781915886
curr_Factors:  [1.01728218e+02 2.81545110e-02]
mat_Sqrt:  [[ 1.70692889e+01  0.00000000e+00]
 [-6.71172240e-03  1.53784880e-02]]
grads:  [ 0.00636192 -1.63085003]
Stock Position:  0.006361923122928421
Bond Position:  [-1.03359319]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.39403934]
Stock Price:  100.56900420144902
PL:  [-0.96304354]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.04640163e-02  2.19948955e-02]
 [-2.71584133e-01  2.00326901e-01]
 [ 8.73125064e-01 -3.30494779e-01]
 [ 3.05054203e-01 -8.56536787e-02]
 [ 8.21584110e-02 -2.13001763e-02]
 [ 3.67770981e-02 -1.77445438e-02]
 [-8.92072314e-02 -1.67075053e-01]
 [-1.40381903e+00  7.48773405e-01]
 [ 5.36558494e-02 -7.59800674e-02]
 [ 1.16795680e-01  3.02396092e-01]
 [-1.65989518e-01 -5.01643797e-02]
 [ 3.76851657e-03 -9.33159882e-03]
 [ 4.79742737e-02 -3.36546593e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15723166e-01 -6.15832704e-02]
 [-9.11816948e-02 -1.03193541e-01]
 [-1.47713916e-01 -5.83192620e-01]
 [-2.12725385e-01 -5.95590371e-02]
 [ 1.51804150e-01  2.21466483e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.17264518]
curr_Stock_Price:  101.43816544914468
curr_Factors:  [1.01438165e+02 3.89149208e-02]
mat_Sqrt:  [[ 2.00105701e+01  0.00000000e+00]
 [-7.89074605e-03  1.80799705e-02]]
grads:  [1.00263889e-03 1.21653381e+00]
Stock Position:  0.0010026388861161088
Bond Position:  [12.07093933]


portfolio before change:  [12.17749011]
curr_Stock_Price:  103.26017560154251
curr_Factors:  [1.03260176e+02 3.74197466e-02]
mat_Sqrt:  [[ 1.99748387e+01  0.00000000e+00]
 [-7.73767371e-03  1.77292377e-02]]
grads:  [-9.21931378e-03  1.12992393e+01]
Stock Position:  -0.009219313782728337
Bond Position:  [13.12947807]


portfolio before change:  [12.17952803]
curr_Stock_Price:  103.39520311845833
curr_Factors:  [1.03395203e+02 3.72969037e-02]
mat_Sqrt:  [[ 1.99681017e+01  0.00000000e+00]
 [-7.72496251e-03  1.77001127e-02]]
grads:  [  0.03650248 -18.67190249]
Stock Position:  0.03650248418870469
Bond Position:  [8.40534626]


portfolio before change:  [12.15011749]
curr_Stock_Price:  102.53191558168557
curr_Factors:  [1.02531916e+02 3.93877747e-02]
mat_Sqrt:  [[ 2.03488464e+01  0.00000000e+00]
 [-7.93854139e-03  1.81894834e-02]]
grads:  [ 0.01315415 -4.70896708]
Stock Position:  0.013154154677515125
Bond Position:  [10.80139681]


portfolio before change:  [12.14401587]
curr_Stock_Price:  101.86274967411333
curr_Factors:  [1.01862750e+02 3.87296708e-02]
mat_Sqrt:  [[ 2.00464418e+01  0.00000000e+00]
 [-7.87194216e-03  1.80368854e-02]]
grads:  [ 0.00363467 -1.18092319]
Stock Position:  0.003634672552188245
Bond Position:  [11.77377813]


portfolio before change:  [12.14343236]
curr_Stock_Price:  100.89228688252796
curr_Factors:  [1.00892287e+02 3.98413004e-02]
mat_Sqrt:  [[ 2.01383887e+01  0.00000000e+00]
 [-7.98411427e-03  1.82939040e-02]]
grads:  [ 0.00144166 -0.96997031]
Stock Position:  0.0014416617294613955
Bond Position:  [11.99797981]


portfolio before change:  [12.14687539]
curr_Stock_Price:  101.19967622523488
curr_Factors:  [1.01199676e+02 4.11937324e-02]
mat_Sqrt:  [[ 2.05397283e+01  0.00000000e+00]
 [-8.11849566e-03  1.86018105e-02]]
grads:  [-7.89322819e-03 -8.98165549e+00]
Stock Position:  -0.007893228190224455
Bond Position:  [12.94566752]


portfolio before change:  [12.13431942]
curr_Stock_Price:  103.20047854541444
curr_Factors:  [1.03200479e+02 4.04289005e-02]
mat_Sqrt:  [[ 2.07504575e+01  0.00000000e+00]
 [-8.04277569e-03  1.84283142e-02]]
grads:  [-0.0519038  40.63168218]
Stock Position:  -0.05190379640808771
Bond Position:  [17.49081604]


portfolio before change:  [12.1651449]
curr_Stock_Price:  102.69083889185139
curr_Factors:  [1.02690839e+02 3.80949343e-02]
mat_Sqrt:  [[ 2.00431195e+01  0.00000000e+00]
 [-7.80716945e-03  1.78884725e-02]]
grads:  [ 1.02256684e-03 -4.24743182e+00]
Stock Position:  0.0010225668395760046
Bond Position:  [12.06013665]


portfolio before change:  [12.16840532]
curr_Stock_Price:  102.9304394070564
curr_Factors:  [1.02930439e+02 3.82988316e-02]
mat_Sqrt:  [[ 2.01435768e+01  0.00000000e+00]
 [-7.82803491e-03  1.79362813e-02]]
grads:  [1.23499494e-02 1.68594642e+01]
Stock Position:  0.01234994941016659
Bond Position:  [10.8972196]


portfolio before change:  [12.15760126]
curr_Stock_Price:  101.83499351338266
curr_Factors:  [1.01834994e+02 3.97937212e-02]
mat_Sqrt:  [[ 2.03144148e+01  0.00000000e+00]
 [-7.97934546e-03  1.82829773e-02]]
grads:  [-0.00924876 -2.7437752 ]
Stock Position:  -0.009248755140316506
Bond Position:  [13.09944818]


portfolio before change:  [12.1534232]
curr_Stock_Price:  102.64086834074901
curr_Factors:  [1.02640868e+02 3.57195924e-02]
mat_Sqrt:  [[ 1.93987419e+01  0.00000000e+00]
 [-7.55985105e-03  1.73217948e-02]]
grads:  [-1.56776685e-05 -5.38720087e-01]
Stock Position:  -1.5677668546509066e-05
Bond Position:  [12.15503237]


portfolio before change:  [12.15646141]
curr_Stock_Price:  102.70008682980755
curr_Factors:  [1.02700087e+02 3.39805658e-02]
mat_Sqrt:  [[ 1.89315474e+01  0.00000000e+00]
 [-7.37352733e-03  1.68948736e-02]]
grads:  [ 1.75823853e-03 -1.99200421e+00]
Stock Position:  0.0017582385339754503
Bond Position:  [11.97589016]


portfolio before change:  [12.16194341]
curr_Stock_Price:  104.11494294275488
curr_Factors:  [1.04114943e+02 3.35098537e-02]
mat_Sqrt:  [[ 1.90589658e+01  0.00000000e+00]
 [-7.32227874e-03  1.67774483e-02]]
grads:  [7.98769163e-03 8.85582163e+00]
Stock Position:  0.007987691629745997
Bond Position:  [11.33030535]


portfolio before change:  [12.17100256]
curr_Stock_Price:  104.89441962762936
curr_Factors:  [1.04894420e+02 3.43625486e-02]
mat_Sqrt:  [[ 1.94444234e+01  0.00000000e+00]
 [-7.41485521e-03  1.69895676e-02]]
grads:  [-0.00733374 -3.62476972]
Stock Position:  -0.007333738137389084
Bond Position:  [12.94027076]


portfolio before change:  [12.17814965]
curr_Stock_Price:  104.36104625623112
curr_Factors:  [1.04361046e+02 3.45130887e-02]
mat_Sqrt:  [[ 1.93878807e+01  0.00000000e+00]
 [-7.43107946e-03  1.70267421e-02]]
grads:  [-0.00702599 -6.06067449]
Stock Position:  -0.007025989623591501
Bond Position:  [12.91138928]


portfolio before change:  [12.18079177]
curr_Stock_Price:  104.4444698812822
curr_Factors:  [1.04444470e+02 3.16279548e-02]
mat_Sqrt:  [[ 1.85746656e+01  0.00000000e+00]
 [-7.11370000e-03  1.62995344e-02]]
grads:  [-2.16553046e-02 -3.57797105e+01]
Stock Position:  -0.021655304638315477
Bond Position:  [14.44256858]


portfolio before change:  [12.17956919]
curr_Stock_Price:  104.66767939071022
curr_Factors:  [1.04667679e+02 3.10568509e-02]
mat_Sqrt:  [[ 1.84455370e+01  0.00000000e+00]
 [-7.04918162e-03  1.61517042e-02]]
grads:  [-0.01294183 -3.68747696]
Stock Position:  -0.012941834078485061
Bond Position:  [13.53416093]


portfolio before change:  [12.17951831]
curr_Stock_Price:  104.93308585972015
curr_Factors:  [1.04933086e+02 3.27126979e-02]
mat_Sqrt:  [[ 1.89788820e+01  0.00000000e+00]
 [-7.23466078e-03  1.65766903e-02]]
grads:  [0.00850786 1.33601146]
Stock Position:  0.008507863613727046
Bond Position:  [11.28676192]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.19338627]
Stock Price:  106.23140430251448
PL:  [5.96198196]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 8.58421314e-02  7.54276853e-03]
 [ 3.06190274e-02 -7.46514056e-02]
 [ 6.28841581e-01 -2.55938556e-01]
 [ 2.06859030e-01 -1.16276666e-01]
 [ 5.44079239e-02 -1.89209894e-02]
 [ 3.84167489e-02 -3.71229598e-02]
 [-8.97390742e-02 -1.68062388e-01]
 [-1.26011854e+00  7.35189557e-01]
 [ 7.84125825e-02 -7.58177441e-02]
 [ 1.49141258e-02 -8.96888487e-02]
 [ 1.89112543e-02  1.72927899e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.50178874e-01 -3.11000884e-02]
 [-6.36355638e-02 -7.67134486e-02]
 [-1.63613164e-02 -1.14866571e-02]
 [-1.41221294e-01 -1.29554974e-01]
 [-1.78458066e-01 -4.50811305e-01]
 [ 2.44160000e-01 -2.26662294e-01]
 [ 1.32433462e-01  1.34044456e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.86814901]
curr_Stock_Price:  97.81704035595881
curr_Factors:  [9.78170404e+01 4.19089517e-02]
mat_Sqrt:  [[ 2.00247875e+01  0.00000000e+00]
 [-8.18867039e-03  1.87626009e-02]]
grads:  [0.00445119 0.40201082]
Stock Position:  0.004451186575830015
Bond Position:  [-12.30355091]


portfolio before change:  [-11.87523677]
curr_Stock_Price:  96.91582402741565
curr_Factors:  [9.69158240e+01 4.24476191e-02]
mat_Sqrt:  [[ 1.99673927e+01  0.00000000e+00]
 [-8.24112799e-03  1.88827964e-02]]
grads:  [-9.82360129e-05 -3.95340838e+00]
Stock Position:  -9.823601291013008e-05
Bond Position:  [-11.86571614]


portfolio before change:  [-11.87841889]
curr_Stock_Price:  99.10774653170199
curr_Factors:  [9.91077465e+01 3.97409687e-02]
mat_Sqrt:  [[ 1.97572650e+01  0.00000000e+00]
 [-7.97405480e-03  1.82708549e-02]]
grads:  [  0.02617472 -14.00802305]
Stock Position:  0.0261747178212177
Bond Position:  [-14.47253619]


portfolio before change:  [-11.82573948]
curr_Stock_Price:  101.25860053374858
curr_Factors:  [1.01258601e+02 3.95038632e-02]
mat_Sqrt:  [[ 2.01257329e+01  0.00000000e+00]
 [-7.95023151e-03  1.82162688e-02]]
grads:  [ 0.00775682 -6.38312198]
Stock Position:  0.007756822253986788
Bond Position:  [-12.61118445]


portfolio before change:  [-11.82638959]
curr_Stock_Price:  101.58129566275953
curr_Factors:  [1.01581296e+02 4.24239462e-02]
mat_Sqrt:  [[ 2.09227748e+01  0.00000000e+00]
 [-8.23882964e-03  1.88775302e-02]]
grads:  [ 0.00220574 -1.00230216]
Stock Position:  0.0022057364603172663
Bond Position:  [-12.05045115]


portfolio before change:  [-11.83223777]
curr_Stock_Price:  100.2959208689696
curr_Factors:  [1.00295921e+02 4.38391761e-02]
mat_Sqrt:  [[ 2.09997663e+01  0.00000000e+00]
 [-8.37512279e-03  1.91898171e-02]]
grads:  [ 1.05786705e-03 -1.93451348e+00]
Stock Position:  0.0010578670530430694
Bond Position:  [-11.93833752]


portfolio before change:  [-11.83419182]
curr_Stock_Price:  101.27043687494711
curr_Factors:  [1.01270437e+02 4.33750459e-02]
mat_Sqrt:  [[ 2.10912664e+01  0.00000000e+00]
 [-8.33067064e-03  1.90879644e-02]]
grads:  [-7.73246663e-03 -8.80462601e+00]
Stock Position:  -0.007732466634760631
Bond Position:  [-11.05112155]


portfolio before change:  [-11.82295517]
curr_Stock_Price:  99.45991796274933
curr_Factors:  [9.94599180e+01 4.43303423e-02]
mat_Sqrt:  [[ 2.09410589e+01  0.00000000e+00]
 [-8.42190879e-03  1.92970173e-02]]
grads:  [-0.04485234 38.09861115]
Stock Position:  -0.04485234085917012
Bond Position:  [-7.36194503]


portfolio before change:  [-11.88543844]
curr_Stock_Price:  100.8119667944153
curr_Factors:  [1.00811967e+02 4.42451668e-02]
mat_Sqrt:  [[ 2.12053286e+01  0.00000000e+00]
 [-8.41381405e-03  1.92784699e-02]]
grads:  [ 2.13734043e-03 -3.93276772e+00]
Stock Position:  0.0021373404339872673
Bond Position:  [-12.10090793]


portfolio before change:  [-11.89498366]
curr_Stock_Price:  97.76162571184086
curr_Factors:  [9.77616257e+01 4.41178185e-02]
mat_Sqrt:  [[ 2.05340885e+01  0.00000000e+00]
 [-8.40169683e-03  1.92507058e-02]]
grads:  [-1.17995483e-03 -4.65899014e+00]
Stock Position:  -0.001179954827207398
Bond Position:  [-11.77962936]


portfolio before change:  [-11.8987798]
curr_Stock_Price:  98.48272474590927
curr_Factors:  [9.84827247e+01 4.40874764e-02]
mat_Sqrt:  [[ 2.06784354e+01  0.00000000e+00]
 [-8.39880719e-03  1.92440848e-02]]
grads:  [4.56432873e-03 8.98602872e+00]
Stock Position:  0.004564328732557679
Bond Position:  [-12.34828733]


portfolio before change:  [-11.90192595]
curr_Stock_Price:  98.46986754240727
curr_Factors:  [9.84698675e+01 4.30679682e-02]
mat_Sqrt:  [[ 2.04352778e+01  0.00000000e+00]
 [-8.30112939e-03  1.90202769e-02]]
grads:  [ 0.00234969 -0.45169599]
Stock Position:  0.0023496856178692764
Bond Position:  [-12.13329918]


portfolio before change:  [-11.90902954]
curr_Stock_Price:  96.73776830128654
curr_Factors:  [9.67377683e+01 4.36998846e-02]
mat_Sqrt:  [[ 2.02225636e+01  0.00000000e+00]
 [-8.36180694e-03  1.91593066e-02]]
grads:  [ 0.00675511 -1.62323664]
Stock Position:  0.00675511204600275
Bond Position:  [-12.562504]


portfolio before change:  [-11.91089459]
curr_Stock_Price:  96.92665750153368
curr_Factors:  [9.69266575e+01 4.27787316e-02]
mat_Sqrt:  [[ 2.00473600e+01  0.00000000e+00]
 [-8.27320800e-03  1.89563009e-02]]
grads:  [-0.00484433 -4.04685749]
Stock Position:  -0.004844331515542438
Bond Position:  [-11.44134973]


portfolio before change:  [-11.92225933]
curr_Stock_Price:  98.68211954054188
curr_Factors:  [9.86821195e+01 4.15768972e-02]
mat_Sqrt:  [[ 2.01216925e+01  0.00000000e+00]
 [-8.15616549e-03  1.86881229e-02]]
grads:  [-0.00106226 -0.61465013]
Stock Position:  -0.0010622617688717645
Bond Position:  [-11.81743308]


portfolio before change:  [-11.92695724]
curr_Stock_Price:  100.32313177194985
curr_Factors:  [1.00323132e+02 3.96537665e-02]
mat_Sqrt:  [[ 1.99775995e+01  0.00000000e+00]
 [-7.96530140e-03  1.82507983e-02]]
grads:  [-0.00989927 -7.09859217]
Stock Position:  -0.00989927340470438
Bond Position:  [-10.93383113]


portfolio before change:  [-11.92961259]
curr_Stock_Price:  100.31520772731497
curr_Factors:  [1.00315208e+02 4.08380362e-02]
mat_Sqrt:  [[ 2.02721216e+01  0.00000000e+00]
 [-8.08336922e-03  1.85213257e-02]]
grads:  [-1.85085832e-02 -2.43401209e+01]
Stock Position:  -0.018508583247015986
Bond Position:  [-10.07292022]


portfolio before change:  [-11.94264439]
curr_Stock_Price:  100.88322815026638
curr_Factors:  [1.00883228e+02 3.99288803e-02]
mat_Sqrt:  [[ 2.01587007e+01  0.00000000e+00]
 [-7.99288486e-03  1.83140000e-02]]
grads:  [ 7.20465404e-03 -1.23764494e+01]
Stock Position:  0.007204654043060175
Bond Position:  [-12.66947315]


portfolio before change:  [-11.93634401]
curr_Stock_Price:  102.1973985193868
curr_Factors:  [1.02197399e+02 3.83907344e-02]
mat_Sqrt:  [[ 2.00241021e+01  0.00000000e+00]
 [-7.83742145e-03  1.79577885e-02]]
grads:  [0.00690586 0.74644189]
Stock Position:  0.006905859798514669
Bond Position:  [-12.64210492]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.95104306]
Stock Price:  100.52662489392756
PL:  [-12.47766796]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.01036200e-02  2.15517269e-02]
 [-7.33019296e-02  7.83492688e-02]
 [ 8.12641662e-01 -3.12035021e-01]
 [ 4.11838282e-01 -5.23521690e-02]
 [ 2.10247584e-01 -2.95313310e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-6.48498089e-02 -1.30501138e-01]
 [-1.30806989e+00  7.40858780e-01]
 [ 8.03348193e-02 -7.54400096e-02]
 [ 1.84087028e-02 -9.19908002e-02]
 [ 6.33957960e-03  1.34784097e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.63882336e-01 -2.85281806e-02]
 [-5.89162310e-02 -6.59261590e-02]
 [ 4.50323119e-02  2.82298917e-02]
 [-1.43624486e-01 -1.40346512e-01]
 [-1.92558440e-01 -3.60821588e-01]
 [ 2.88292786e-01 -2.85803423e-01]
 [-5.04765348e-02 -1.37933778e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.47857254]
curr_Stock_Price:  101.48424550836468
curr_Factors:  [1.01484246e+02 3.92111588e-02]
mat_Sqrt:  [[ 2.00957151e+01  0.00000000e+00]
 [-7.92072308e-03  1.81486565e-02]]
grads:  [9.70832072e-04 1.18751087e+00]
Stock Position:  0.0009708320723017257
Bond Position:  [12.38004838]


portfolio before change:  [12.48232266]
curr_Stock_Price:  102.15863870035548
curr_Factors:  [1.02158639e+02 3.75215726e-02]
mat_Sqrt:  [[ 1.97886247e+01  0.00000000e+00]
 [-7.74819438e-03  1.77533436e-02]]
grads:  [-1.97626191e-03  4.41321199e+00]
Stock Position:  -0.0019762619076318616
Bond Position:  [12.68421488]


portfolio before change:  [12.48416259]
curr_Stock_Price:  102.83239223347667
curr_Factors:  [1.02832392e+02 3.50995026e-02]
mat_Sqrt:  [[ 1.9265506e+01  0.0000000e+00]
 [-7.4939445e-03  1.7170784e-02]]
grads:  [  0.03511241 -18.17243881]
Stock Position:  0.03511241353662364
Bond Position:  [8.87346911]


portfolio before change:  [12.52437558]
curr_Stock_Price:  103.91446930574538
curr_Factors:  [1.03914469e+02 3.53505359e-02]
mat_Sqrt:  [[ 1.95377265e+01  0.00000000e+00]
 [-7.52069528e-03  1.72320777e-02]]
grads:  [ 0.01990968 -3.03806482]
Stock Position:  0.01990968208264141
Bond Position:  [10.45547153]


portfolio before change:  [12.51977183]
curr_Stock_Price:  103.55193508205653
curr_Factors:  [1.03551935e+02 3.32233331e-02]
mat_Sqrt:  [[ 1.88746896e+01  0.00000000e+00]
 [-7.29090755e-03  1.67055679e-02]]
grads:  [ 0.01045628 -1.76775379]
Stock Position:  0.010456280785159488
Bond Position:  [11.43700372]


portfolio before change:  [12.51800855]
curr_Stock_Price:  103.10981903894724
curr_Factors:  [1.03109819e+02 3.20855455e-02]
mat_Sqrt:  [[ 1.84694830e+01  0.00000000e+00]
 [-7.16497542e-03  1.64170211e-02]]
grads:  [-3.13826953e-05 -1.17872640e+00]
Stock Position:  -3.138269529106156e-05
Bond Position:  [12.52124441]


portfolio before change:  [12.52124673]
curr_Stock_Price:  99.68511020205459
curr_Factors:  [9.96851102e+01 3.33537540e-02]
mat_Sqrt:  [[ 1.82055018e+01  0.00000000e+00]
 [-7.30520406e-03  1.67383253e-02]]
grads:  [-6.69056951e-03 -7.79654692e+00]
Stock Position:  -0.00669056950631475
Bond Position:  [13.18819689]


portfolio before change:  [12.51921979]
curr_Stock_Price:  100.48091725822343
curr_Factors:  [1.00480917e+02 3.23934035e-02]
mat_Sqrt:  [[ 1.80847238e+01  0.00000000e+00]
 [-7.19926701e-03  1.64955930e-02]]
grads:  [-0.05445107 44.91252777]
Stock Position:  -0.05445107237962881
Bond Position:  [17.99051349]


portfolio before change:  [12.51589098]
curr_Stock_Price:  100.62466086501718
curr_Factors:  [1.00624661e+02 3.16154853e-02]
mat_Sqrt:  [[ 1.78918132e+01  0.00000000e+00]
 [-7.11229756e-03  1.62963210e-02]]
grads:  [ 2.64982086e-03 -4.62926631e+00]
Stock Position:  0.00264982085579816
Bond Position:  [12.24925366]


portfolio before change:  [12.51497292]
curr_Stock_Price:  99.12238680850676
curr_Factors:  [9.91223868e+01 3.21601296e-02]
mat_Sqrt:  [[ 1.77758610e+01  0.00000000e+00]
 [-7.17329823e-03  1.64360911e-02]]
grads:  [-1.22297164e-03 -5.59687823e+00]
Stock Position:  -0.0012229716350447336
Bond Position:  [12.63619679]


portfolio before change:  [12.51859792]
curr_Stock_Price:  98.74171361373178
curr_Factors:  [9.87417136e+01 3.21812063e-02]
mat_Sqrt:  [[ 1.77133955e+01  0.00000000e+00]
 [-7.17564841e-03  1.64414760e-02]]
grads:  [3.67880805e-03 8.19781002e+00]
Stock Position:  0.0036788080538901003
Bond Position:  [12.15534611]


portfolio before change:  [12.51933173]
curr_Stock_Price:  98.1150417073781
curr_Factors:  [9.81150417e+01 3.31582721e-02]
mat_Sqrt:  [[ 1.78661731e+01  0.00000000e+00]
 [-7.28376520e-03  1.66892027e-02]]
grads:  [ 0.00268756 -0.5147869 ]
Stock Position:  0.0026875636930517627
Bond Position:  [12.25564131]


portfolio before change:  [12.52568088]
curr_Stock_Price:  99.3372839386335
curr_Factors:  [9.93372839e+01 3.35441978e-02]
mat_Sqrt:  [[ 1.81936982e+01  0.00000000e+00]
 [-7.32603006e-03  1.67860437e-02]]
grads:  [ 0.0083233  -1.69951784]
Stock Position:  0.008323300486924437
Bond Position:  [11.69886681]


portfolio before change:  [12.51337791]
curr_Stock_Price:  97.50771541488535
curr_Factors:  [9.75077154e+01 3.29390936e-02]
mat_Sqrt:  [[ 1.76968025e+01  0.00000000e+00]
 [-7.25965218e-03  1.66339528e-02]]
grads:  [-0.00495506 -3.96334893]
Stock Position:  -0.00495506269229614
Bond Position:  [12.99653475]


portfolio before change:  [12.51818727]
curr_Stock_Price:  97.1929216401977
curr_Factors:  [9.71929216e+01 3.35591958e-02]
mat_Sqrt:  [[ 1.78049357e+01  0.00000000e+00]
 [-7.32766766e-03  1.67897959e-02]]
grads:  [0.00322118 1.68137194]
Stock Position:  0.0032211768511693213
Bond Position:  [12.20511169]


portfolio before change:  [12.52269759]
curr_Stock_Price:  97.64575446219688
curr_Factors:  [9.76457545e+01 3.40410426e-02]
mat_Sqrt:  [[ 1.80158514e+01  0.00000000e+00]
 [-7.38008592e-03  1.69099012e-02]]
grads:  [-0.01137203 -8.2996648 ]
Stock Position:  -0.01137202569965196
Bond Position:  [13.63312762]


portfolio before change:  [12.52930843]
curr_Stock_Price:  97.36417454294316
curr_Factors:  [9.73641745e+01 3.39748471e-02]
mat_Sqrt:  [[ 1.79464247e+01  0.00000000e+00]
 [-7.37290685e-03  1.68934519e-02]]
grads:  [-1.95043802e-02 -2.13586655e+01]
Stock Position:  -0.01950438022023973
Bond Position:  [14.42833631]


portfolio before change:  [12.54551349]
curr_Stock_Price:  96.71829267054662
curr_Factors:  [9.67182927e+01 3.50404983e-02]
mat_Sqrt:  [[ 1.81048011e+01  0.00000000e+00]
 [-7.48764297e-03  1.71563453e-02]]
grads:  [ 9.03395430e-03 -1.66587591e+01]
Stock Position:  0.009033954296486542
Bond Position:  [11.67176486]


portfolio before change:  [12.55623319]
curr_Stock_Price:  97.5818565513538
curr_Factors:  [9.75818566e+01 3.55425999e-02]
mat_Sqrt:  [[ 1.83968587e+01  0.00000000e+00]
 [-7.54109805e-03  1.72788263e-02]]
grads:  [-6.01601461e-03 -7.98282102e+00]
Stock Position:  -0.006016014611317026
Bond Position:  [13.14328707]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.5482124]
Stock Price:  99.46134448432537
PL:  [12.5482124]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.40575488e-02  1.22510498e-01]
 [ 4.09243167e-02 -5.91655075e-02]
 [ 5.11817474e-01 -2.20222365e-01]
 [-8.80125233e-02 -8.97276025e-02]
 [ 3.86113295e-01 -1.71845928e-02]
 [-2.60108670e-01 -3.03672781e-01]
 [-1.59715595e-02 -6.02986103e-02]
 [-1.27723424e+00  7.37033021e-01]
 [ 8.92690195e-02 -7.26504006e-02]
 [ 3.08531037e-02 -6.19937279e-02]
 [-1.05590983e-01 -1.08561345e-01]
 [ 4.26398177e-02 -8.73212742e-03]
 [ 1.57646032e-01 -2.39906814e-02]
 [ 5.23309108e-02  8.05184264e-02]
 [-5.42162410e-02 -2.64990316e-02]
 [-1.42283688e-01 -1.34325656e-01]
 [-1.75251799e-01 -4.65483785e-01]
 [ 1.15581510e-01 -1.95385432e-01]
 [ 1.31921875e-01  1.82911512e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.48845999]
curr_Stock_Price:  100.13011711027684
curr_Factors:  [1.00130117e+02 4.01314447e-02]
mat_Sqrt:  [[ 2.00589004e+01  0.00000000e+00]
 [-8.01313369e-03  1.83603958e-02]]
grads:  [4.36342531e-03 6.67254120e+00]
Stock Position:  0.004363425308099911
Bond Position:  [3.0515497]


portfolio before change:  [3.47969228]
curr_Stock_Price:  97.94589456458772
curr_Factors:  [9.79458946e+01 4.24540511e-02]
mat_Sqrt:  [[ 2.01811452e+01  0.00000000e+00]
 [-8.24175235e-03  1.88842270e-02]]
grads:  [ 7.48340697e-04 -3.13306483e+00]
Stock Position:  0.0007483406972566421
Bond Position:  [3.40639538]


portfolio before change:  [3.47959741]
curr_Stock_Price:  96.68099312904586
curr_Factors:  [9.66809931e+01 4.46767690e-02]
mat_Sqrt:  [[ 2.04353454e+01  0.00000000e+00]
 [-8.45475194e-03  1.93722704e-02]]
grads:  [  0.02034243 -11.36791718]
Stock Position:  0.020342428592249998
Bond Position:  [1.51287121]


portfolio before change:  [3.46715315]
curr_Stock_Price:  96.05065927928325
curr_Factors:  [9.60506593e+01 4.52318753e-02]
mat_Sqrt:  [[ 2.04278494e+01  0.00000000e+00]
 [-8.50711470e-03  1.94922485e-02]]
grads:  [-0.00622546 -4.60324535]
Stock Position:  -0.006225464908200382
Bond Position:  [4.06511316]


portfolio before change:  [3.47521118]
curr_Stock_Price:  94.91955944156646
curr_Factors:  [9.49195594e+01 4.45484499e-02]
mat_Sqrt:  [[ 2.00342003e+01  0.00000000e+00]
 [-8.44260149e-03  1.93444302e-02]]
grads:  [ 0.01889835 -0.88834836]
Stock Position:  0.018898349681311395
Bond Position:  [1.68138815]


portfolio before change:  [3.49109723]
curr_Stock_Price:  95.73791935213964
curr_Factors:  [9.57379194e+01 4.14470757e-02]
mat_Sqrt:  [[ 1.94908569e+01  0.00000000e+00]
 [-8.14342195e-03  1.86589238e-02]]
grads:  [ -0.02014495 -16.2749355 ]
Stock Position:  -0.02014495000720587
Bond Position:  [5.41973283]


portfolio before change:  [3.46087719]
curr_Stock_Price:  97.30531683346194
curr_Factors:  [9.73053168e+01 4.05823204e-02]
mat_Sqrt:  [[ 1.96022087e+01  0.00000000e+00]
 [-8.05802164e-03  1.84632471e-02]]
grads:  [-2.15730947e-03 -3.26587247e+00]
Stock Position:  -0.0021573094735690542
Bond Position:  [3.67079487]


portfolio before change:  [3.45628299]
curr_Stock_Price:  99.86035666979502
curr_Factors:  [9.98603567e+01 4.17550274e-02]
mat_Sqrt:  [[ 2.04055121e+01  0.00000000e+00]
 [-8.17361877e-03  1.87281134e-02]]
grads:  [-0.04682885 39.35436564]
Stock Position:  -0.04682884941530052
Bond Position:  [8.1326286]


portfolio before change:  [3.4588142]
curr_Stock_Price:  99.84972652944177
curr_Factors:  [9.98497265e+01 4.06690335e-02]
mat_Sqrt:  [[ 2.01362598e+01  0.00000000e+00]
 [-8.06662591e-03  1.84829619e-02]]
grads:  [ 2.85861356e-03 -3.93066874e+00]
Stock Position:  0.002858613558557065
Bond Position:  [3.17338242]


portfolio before change:  [3.45914278]
curr_Stock_Price:  99.68710612049244
curr_Factors:  [9.96871061e+01 4.06524094e-02]
mat_Sqrt:  [[ 2.00993556e+01  0.00000000e+00]
 [-8.06497707e-03  1.84791839e-02]]
grads:  [ 1.88902704e-04 -3.35478710e+00]
Stock Position:  0.00018890270407780267
Bond Position:  [3.44031161]


portfolio before change:  [3.46023808]
curr_Stock_Price:  100.93176700364747
curr_Factors:  [1.00931767e+02 3.95691261e-02]
mat_Sqrt:  [[ 2.00773369e+01  0.00000000e+00]
 [-7.95679594e-03  1.82313099e-02]]
grads:  [-0.00761909 -5.95466515]
Stock Position:  -0.007619090102842508
Bond Position:  [4.22924631]


portfolio before change:  [3.47311259]
curr_Stock_Price:  99.38078604764605
curr_Factors:  [9.93807860e+01 4.08797998e-02]
mat_Sqrt:  [[ 2.00935563e+01  0.00000000e+00]
 [-8.08750145e-03  1.85307938e-02]]
grads:  [ 0.0019324  -0.47122252]
Stock Position:  0.0019324008329556725
Bond Position:  [3.28106908]


portfolio before change:  [3.4750509]
curr_Stock_Price:  99.95930922564992
curr_Factors:  [9.99593092e+01 4.13668203e-02]
mat_Sqrt:  [[ 2.03305588e+01  0.00000000e+00]
 [-8.13553394e-03  1.86408501e-02]]
grads:  [ 0.00723913 -1.28699503]
Stock Position:  0.007239134021765253
Bond Position:  [2.75143206]


portfolio before change:  [3.4783223]
curr_Stock_Price:  100.31618329195031
curr_Factors:  [1.00316183e+02 4.09686649e-02]
mat_Sqrt:  [[ 2.03047154e+01  0.00000000e+00]
 [-8.09628704e-03  1.85509241e-02]]
grads:  [4.30796647e-03 4.34039975e+00]
Stock Position:  0.004307966474064236
Bond Position:  [3.04616355]


portfolio before change:  [3.47418732]
curr_Stock_Price:  99.17954141473328
curr_Factors:  [9.91795414e+01 4.53627398e-02]
mat_Sqrt:  [[ 2.11237848e+01  0.00000000e+00]
 [-8.51941217e-03  1.95204256e-02]]
grads:  [-0.00311409 -1.35750276]
Stock Position:  -0.0031140899785426436
Bond Position:  [3.78304134]


portfolio before change:  [3.4754566]
curr_Stock_Price:  99.07569028414382
curr_Factors:  [9.90756903e+01 4.67689973e-02]
mat_Sqrt:  [[ 2.14262484e+01  0.00000000e+00]
 [-8.65045639e-03  1.98206856e-02]]
grads:  [-0.00937673 -6.77704386]
Stock Position:  -0.009376732971009214
Bond Position:  [4.40446289]


portfolio before change:  [3.46088628]
curr_Stock_Price:  100.74701561656441
curr_Factors:  [1.00747016e+02 4.89951981e-02]
mat_Sqrt:  [[ 2.23002098e+01  0.00000000e+00]
 [-8.85394358e-03  2.02869333e-02]]
grads:  [-1.69687003e-02 -2.29450049e+01]
Stock Position:  -0.01696870034132602
Bond Position:  [5.1704322]


portfolio before change:  [3.44208511]
curr_Stock_Price:  101.93119240438531
curr_Factors:  [1.01931192e+02 4.98435805e-02]
mat_Sqrt:  [[ 2.27568277e+01  0.00000000e+00]
 [-8.93027036e-03  2.04618200e-02]]
grads:  [ 1.33183398e-03 -9.54878074e+00]
Stock Position:  0.0013318339753197411
Bond Position:  [3.30632969]


portfolio before change:  [3.44333919]
curr_Stock_Price:  102.25209589657838
curr_Factors:  [1.02252096e+02 5.02960897e-02]
mat_Sqrt:  [[ 2.29318625e+01  0.00000000e+00]
 [-8.97071588e-03  2.05544923e-02]]
grads:  [0.00610089 0.88988582]
Stock Position:  0.006100890759295904
Bond Position:  [2.81951032]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.44112557]
Stock Price:  101.77370968626698
PL:  [1.66741589]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.61174741e-01 -1.18746298e-01]
 [ 4.48238973e-03  4.92607136e-01]
 [ 5.00055096e-01 -2.16632444e-01]
 [-1.12136048e-01 -1.24672285e-01]
 [ 1.86808486e-01 -5.38827249e-03]
 [ 3.96585560e-02 -3.02948548e-02]
 [-1.00486799e-01 -1.76678534e-01]
 [-1.30723470e+00  7.39613676e-01]
 [ 7.85882307e-02 -5.73902800e-02]
 [ 1.67948613e-02 -8.06253875e-02]
 [ 5.60908344e-02  2.71839874e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 9.18859741e-02 -3.43357441e-03]
 [-1.14657674e-01 -1.87657183e-01]
 [ 1.65578039e-01  2.55301655e-01]
 [-1.50369508e-02 -9.57877665e-02]
 [-2.04252505e-01 -1.97896249e-01]
 [ 5.58587198e-01 -5.53847806e-01]
 [-4.09144718e-01 -2.29975891e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.28531291]
curr_Stock_Price:  96.39858769596361
curr_Factors:  [9.63985877e+01 4.39457530e-02]
mat_Sqrt:  [[ 2.02082696e+01  0.00000000e+00]
 [-8.38529695e-03  1.92131290e-02]]
grads:  [ 5.41113166e-03 -6.18047680e+00]
Stock Position:  0.005411131662823325
Bond Position:  [-21.80693836]


portfolio before change:  [-21.30399986]
curr_Stock_Price:  93.95278995193546
curr_Factors:  [9.39527900e+01 4.49981344e-02]
mat_Sqrt:  [[ 1.99299833e+01  0.00000000e+00]
 [-8.48510548e-03  1.94418191e-02]]
grads:  [1.10122405e-02 2.53375023e+01]
Stock Position:  0.011012240497177654
Bond Position:  [-22.33863057]


portfolio before change:  [-21.28286821]
curr_Stock_Price:  96.37890858986994
curr_Factors:  [9.63789086e+01 4.56593348e-02]
mat_Sqrt:  [[ 2.05942886e+01  0.00000000e+00]
 [-8.54721801e-03  1.95841367e-02]]
grads:  [  0.01969036 -11.06162844]
Stock Position:  0.019690359522346504
Bond Position:  [-23.18060357]


portfolio before change:  [-21.26902503]
curr_Stock_Price:  97.37630320375477
curr_Factors:  [9.73763032e+01 4.64013455e-02]
mat_Sqrt:  [[ 2.09758018e+01  0.00000000e+00]
 [-8.61638862e-03  1.97426265e-02]]
grads:  [-0.00793998 -6.31487833]
Stock Position:  -0.00793998227008098
Bond Position:  [-20.49585891]


portfolio before change:  [-21.28910794]
curr_Stock_Price:  99.26022587753305
curr_Factors:  [9.92602259e+01 4.24765977e-02]
mat_Sqrt:  [[ 2.04573851e+01  0.00000000e+00]
 [-8.24394058e-03  1.88892409e-02]]
grads:  [ 0.00901664 -0.28525617]
Stock Position:  0.009016638754654138
Bond Position:  [-22.18410154]


portfolio before change:  [-21.2837863]
curr_Stock_Price:  100.46559388079395
curr_Factors:  [1.00465594e+02 4.17477134e-02]
mat_Sqrt:  [[ 2.05273885e+01  0.00000000e+00]
 [-8.17290287e-03  1.87264730e-02]]
grads:  [ 1.28787923e-03 -1.61775550e+00]
Stock Position:  0.0012878792341345525
Bond Position:  [-21.41317385]


portfolio before change:  [-21.28774613]
curr_Stock_Price:  101.54808977075191
curr_Factors:  [1.01548090e+02 4.15270666e-02]
mat_Sqrt:  [[ 2.06936636e+01  0.00000000e+00]
 [-8.15127637e-03  1.86769205e-02]]
grads:  [-8.58212620e-03 -9.45972511e+00]
Stock Position:  -0.008582126197518
Bond Position:  [-20.41624761]


portfolio before change:  [-21.28550638]
curr_Stock_Price:  100.69230520781765
curr_Factors:  [1.00692305e+02 4.33292782e-02]
mat_Sqrt:  [[ 2.09597940e+01  0.00000000e+00]
 [-8.32627439e-03  1.90778913e-02]]
grads:  [-0.04696806 38.76810404]
Stock Position:  -0.04696805842673124
Bond Position:  [-16.55618431]


portfolio before change:  [-21.20967774]
curr_Stock_Price:  98.98969690458948
curr_Factors:  [9.89896969e+01 4.25812066e-02]
mat_Sqrt:  [[ 2.04267360e+01  0.00000000e+00]
 [-8.25408569e-03  1.89124862e-02]]
grads:  [ 2.62112650e-03 -3.03451801e+00]
Stock Position:  0.0026211265023749217
Bond Position:  [-21.46914226]


portfolio before change:  [-21.22062932]
curr_Stock_Price:  96.85945907817151
curr_Factors:  [9.68594591e+01 4.18999961e-02]
mat_Sqrt:  [[ 1.98266359e+01  0.00000000e+00]
 [-8.18779542e-03  1.87605961e-02]]
grads:  [-9.27688527e-04 -4.29759198e+00]
Stock Position:  -0.0009276885268779692
Bond Position:  [-21.13077391]


portfolio before change:  [-21.22673969]
curr_Stock_Price:  97.7509347890734
curr_Factors:  [9.77509348e+01 4.14581192e-02]
mat_Sqrt:  [[ 1.99033288e+01  0.00000000e+00]
 [-8.14450678e-03  1.86614094e-02]]
grads:  [8.77900796e-03 1.45669530e+01]
Stock Position:  0.008779007962075711
Bond Position:  [-22.08489592]


portfolio before change:  [-21.24428718]
curr_Stock_Price:  96.38112352459733
curr_Factors:  [9.63811235e+01 4.38466908e-02]
mat_Sqrt:  [[ 2.01818231e+01  0.00000000e+00]
 [-8.37584057e-03  1.91914617e-02]]
grads:  [ 0.00237919 -0.44766694]
Stock Position:  0.0023791942880923974
Bond Position:  [-21.4735966]


portfolio before change:  [-21.25628332]
curr_Stock_Price:  93.59569864400027
curr_Factors:  [9.35956986e+01 4.39492712e-02]
mat_Sqrt:  [[ 1.96214785e+01  0.00000000e+00]
 [-8.38563259e-03  1.92138980e-02]]
grads:  [ 0.00460656 -0.17870265]
Stock Position:  0.004606555989859212
Bond Position:  [-21.68743715]


portfolio before change:  [-21.27139995]
curr_Stock_Price:  91.49128565427156
curr_Factors:  [9.14912857e+01 4.55563026e-02]
mat_Sqrt:  [[ 1.95278291e+01  0.00000000e+00]
 [-8.53756898e-03  1.95620281e-02]]
grads:  [-0.01006553 -9.59293086]
Stock Position:  -0.010065531701950842
Bond Position:  [-20.35049152]


portfolio before change:  [-21.27501718]
curr_Stock_Price:  91.34514019724199
curr_Factors:  [9.13451402e+01 4.56221532e-02]
mat_Sqrt:  [[ 1.95107218e+01  0.00000000e+00]
 [-8.54373719e-03  1.95761612e-02]]
grads:  [ 0.01419736 13.04145652]
Stock Position:  0.014197363835924846
Bond Position:  [-22.57187737]


portfolio before change:  [-21.27544671]
curr_Stock_Price:  91.71240208265023
curr_Factors:  [9.17124021e+01 4.51723811e-02]
mat_Sqrt:  [[ 1.94923661e+01  0.00000000e+00]
 [-8.50151809e-03  1.94794251e-02]]
grads:  [-2.91612414e-03 -4.91738160e+00]
Stock Position:  -0.0029161241398183058
Bond Position:  [-21.00800196]


portfolio before change:  [-21.27692837]
curr_Stock_Price:  90.41925089580612
curr_Factors:  [9.04192509e+01 4.38428822e-02]
mat_Sqrt:  [[ 1.89326084e+01  0.00000000e+00]
 [-8.37547679e-03  1.91906282e-02]]
grads:  [ -0.01535032 -10.3121298 ]
Stock Position:  -0.015350315275339926
Bond Position:  [-19.88896436]


portfolio before change:  [-21.26229445]
curr_Stock_Price:  89.14196205806684
curr_Factors:  [8.91419621e+01 4.71219268e-02]
mat_Sqrt:  [[ 1.93505676e+01  0.00000000e+00]
 [-8.68303420e-03  1.98953307e-02]]
grads:  [ 1.63751371e-02 -2.78380799e+01]
Stock Position:  0.016375137145193893
Bond Position:  [-22.7220063]


portfolio before change:  [-21.26139138]
curr_Stock_Price:  89.54405210814075
curr_Factors:  [8.95440521e+01 4.71941544e-02]
mat_Sqrt:  [[ 1.94527429e+01  0.00000000e+00]
 [-8.68968624e-03  1.99105725e-02]]
grads:  [ -0.02619242 -11.5504409 ]
Stock Position:  -0.026192420643281682
Bond Position:  [-18.9160159]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.26549511]
Stock Price:  89.52015702982672
PL:  [-21.26549511]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.08976710e-03  1.47823761e-01]
 [ 4.70306635e-02 -4.99894172e-02]
 [ 6.26016123e-01 -2.55076216e-01]
 [-1.23288873e-01 -1.40981468e-01]
 [ 1.91893807e-01 -5.55594567e-03]
 [ 1.81917803e-02 -9.16777369e-02]
 [-4.20172367e-02 -9.77110524e-02]
 [-1.26938277e+00  6.94507603e-01]
 [ 7.17516401e-02 -4.76073209e-02]
 [ 1.57899599e-02 -8.54681124e-02]
 [ 6.85875048e-02  2.91634721e-01]
 [ 5.98309387e-02 -2.28616919e-02]
 [ 1.55104380e-01 -3.02829103e-02]
 [-5.90082652e-02 -6.61370160e-02]
 [-1.22363450e-02 -9.42431367e-03]
 [-1.43646011e-01 -1.40443170e-01]
 [-1.86918431e-01 -4.07276206e-01]
 [ 2.79622981e-01 -2.44153749e-01]
 [ 8.66074219e-02 -9.39593276e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.76900936]
curr_Stock_Price:  99.48883924813791
curr_Factors:  [9.94888392e+01 3.95335067e-02]
mat_Sqrt:  [[ 1.97814004e+01  0.00000000e+00]
 [-7.95321386e-03  1.82231023e-02]]
grads:  [3.36706927e-03 8.11188778e+00]
Stock Position:  0.0033670692730902374
Bond Position:  [-1.10399518]


portfolio before change:  [-0.77200106]
curr_Stock_Price:  98.68230321690201
curr_Factors:  [9.86823032e+01 4.01540979e-02]
mat_Sqrt:  [[ 1.97744409e+01  0.00000000e+00]
 [-8.01539498e-03  1.83655771e-02]]
grads:  [ 1.27505466e-03 -2.72190833e+00]
Stock Position:  0.0012750546626236975
Bond Position:  [-0.89782639]


portfolio before change:  [-0.77202515]
curr_Stock_Price:  98.83946398323785
curr_Factors:  [9.88394640e+01 4.16138428e-02]
mat_Sqrt:  [[ 2.01627280e+01  0.00000000e+00]
 [-8.15978850e-03  1.86964242e-02]]
grads:  [  0.02552689 -13.64304813]
Stock Position:  0.025526889736585824
Bond Position:  [-3.29508925]


portfolio before change:  [-0.79472508]
curr_Stock_Price:  97.98248317906773
curr_Factors:  [9.79824832e+01 4.44516738e-02]
mat_Sqrt:  [[ 2.06582011e+01  0.00000000e+00]
 [-8.43342624e-03  1.93234071e-02]]
grads:  [-0.00894648 -7.29589082]
Stock Position:  -0.008946482254207659
Bond Position:  [0.08187346]


portfolio before change:  [-0.80548013]
curr_Stock_Price:  99.18692452883863
curr_Factors:  [9.91869245e+01 4.46461272e-02]
mat_Sqrt:  [[ 2.09578303e+01  0.00000000e+00]
 [-8.45185207e-03  1.93656259e-02]]
grads:  [ 0.00904049 -0.28689729]
Stock Position:  0.009040487025649906
Bond Position:  [-1.70217823]


portfolio before change:  [-0.81202316]
curr_Stock_Price:  98.51025318667558
curr_Factors:  [9.85102532e+01 4.43960335e-02]
mat_Sqrt:  [[ 2.07564712e+01  0.00000000e+00]
 [-8.42814651e-03  1.93113097e-02]]
grads:  [-1.05122225e-03 -4.74735989e+00]
Stock Position:  -0.0010512222528091819
Bond Position:  [-0.70846699]


portfolio before change:  [-0.81224847]
curr_Stock_Price:  98.55607005680638
curr_Factors:  [9.85560701e+01 4.56927731e-02]
mat_Sqrt:  [[ 2.10672154e+01  0.00000000e+00]
 [-8.55034718e-03  1.95913066e-02]]
grads:  [-4.01865337e-03 -4.98746992e+00]
Stock Position:  -0.004018653368889877
Bond Position:  [-0.41618578]


portfolio before change:  [-0.80819108]
curr_Stock_Price:  97.52053708340183
curr_Factors:  [9.75205371e+01 4.79116838e-02]
mat_Sqrt:  [[ 2.13460146e+01  0.00000000e+00]
 [-8.75549508e-03  2.00613595e-02]]
grads:  [-0.04526722 34.61916941]
Stock Position:  -0.045267223215663205
Bond Position:  [3.60629284]


portfolio before change:  [-0.84881194]
curr_Stock_Price:  98.43781324800572
curr_Factors:  [9.84378132e+01 4.73291170e-02]
mat_Sqrt:  [[ 2.14153984e+01  0.00000000e+00]
 [-8.70210246e-03  1.99390216e-02]]
grads:  [ 2.38025466e-03 -2.38764579e+00]
Stock Position:  0.0023802546579597796
Bond Position:  [-1.083119]


portfolio before change:  [-0.85171555]
curr_Stock_Price:  97.33171262105803
curr_Factors:  [9.73317126e+01 4.91794083e-02]
mat_Sqrt:  [[ 2.15846999e+01  0.00000000e+00]
 [-8.87057232e-03  2.03250346e-02]]
grads:  [-9.96603267e-04 -4.20506603e+00]
Stock Position:  -0.0009966032670021031
Bond Position:  [-0.75471445]


portfolio before change:  [-0.85208829]
curr_Stock_Price:  97.51637203467574
curr_Factors:  [9.75163720e+01 4.91804029e-02]
mat_Sqrt:  [[ 2.16258694e+01  0.00000000e+00]
 [-8.87066202e-03  2.03252401e-02]]
grads:  [9.05708474e-03 1.43484023e+01]
Stock Position:  0.009057084736520943
Bond Position:  [-1.73530233]


portfolio before change:  [-0.86902251]
curr_Stock_Price:  95.69455582124034
curr_Factors:  [9.56945558e+01 4.90462518e-02]
mat_Sqrt:  [[ 2.11928880e+01  0.00000000e+00]
 [-8.85855535e-03  2.02975002e-02]]
grads:  [ 0.00235236 -1.12633042]
Stock Position:  0.002352358882397999
Bond Position:  [-1.09413045]


portfolio before change:  [-0.86603566]
curr_Stock_Price:  97.08057548198593
curr_Factors:  [9.70805755e+01 4.89188263e-02]
mat_Sqrt:  [[ 2.14718941e+01  0.00000000e+00]
 [-8.84704030e-03  2.02711159e-02]]
grads:  [ 0.00660807 -1.49389459]
Stock Position:  0.006608072570731093
Bond Position:  [-1.50755115]


portfolio before change:  [-0.86348187]
curr_Stock_Price:  97.52408202094915
curr_Factors:  [9.75240820e+01 5.11744289e-02]
mat_Sqrt:  [[ 2.20616695e+01  0.00000000e+00]
 [-9.04870633e-03  2.07331909e-02]]
grads:  [-0.00398305 -3.18991015]
Stock Position:  -0.003983054209241022
Bond Position:  [-0.47503817]


portfolio before change:  [-0.86795489]
curr_Stock_Price:  98.61727440525303
curr_Factors:  [9.86172744e+01 4.95550496e-02]
mat_Sqrt:  [[ 2.19531555e+01  0.00000000e+00]
 [-8.90438540e-03  2.04025101e-02]]
grads:  [-0.00074474 -0.46191932]
Stock Position:  -0.0007447427187447325
Bond Position:  [-0.79451039]


portfolio before change:  [-0.86724115]
curr_Stock_Price:  97.39215968938697
curr_Factors:  [9.73921597e+01 4.94991252e-02]
mat_Sqrt:  [[ 2.16681962e+01  0.00000000e+00]
 [-8.89935955e-03  2.03909944e-02]]
grads:  [-0.00945812 -6.88750964]
Stock Position:  -0.009458121691470964
Bond Position:  [0.05390575]


portfolio before change:  [-0.8845034]
curr_Stock_Price:  99.21870933265447
curr_Factors:  [9.92187093e+01 4.90230378e-02]
mat_Sqrt:  [[ 2.19681600e+01  0.00000000e+00]
 [-8.85645868e-03  2.02926962e-02]]
grads:  [-1.65998582e-02 -2.00700884e+01]
Stock Position:  -0.016599858165217952
Bond Position:  [0.7625131]


portfolio before change:  [-0.88783524]
curr_Stock_Price:  99.43090950742864
curr_Factors:  [9.94309095e+01 4.57294915e-02]
mat_Sqrt:  [[ 2.12627581e+01  0.00000000e+00]
 [-8.55378200e-03  1.95991767e-02]]
grads:  [ 8.13937441e-03 -1.24573472e+01]
Stock Position:  0.008139374405296392
Bond Position:  [-1.69714064]


portfolio before change:  [-0.87789067]
curr_Stock_Price:  100.70482925486073
curr_Factors:  [1.00704829e+02 4.41345215e-02]
mat_Sqrt:  [[ 2.11562899e+01  0.00000000e+00]
 [-8.40328712e-03  1.92543497e-02]]
grads:  [ 2.15539727e-03 -4.87990139e+00]
Stock Position:  0.0021553972690935806
Bond Position:  [-1.09494958]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.87415589]
Stock Price:  102.56460076436859
PL:  [-3.43875666]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [-1.34628863e-03  1.33258787e-01]
 [ 4.13937946e-02 -5.84600167e-02]
 [ 4.79557590e-01 -2.10376529e-01]
 [-1.06312188e-01 -1.00602129e-01]
 [ 5.31951591e-02 -1.14062901e-02]
 [-2.93357761e-02 -1.47751324e-01]
 [-1.94231889e-02 -5.07105486e-02]
 [-1.30415092e+00  6.53991174e-01]
 [ 6.08045960e-02 -3.20040706e-02]
 [ 1.44455624e-02 -9.19469046e-02]
 [ 1.00305820e-01  3.01834267e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.65021756e-01 -2.87137823e-02]
 [ 3.53436073e-04  1.43902503e-02]
 [-1.16248728e-01 -6.01263878e-02]
 [-1.41756617e-01 -1.31958844e-01]
 [-1.80368234e-01 -4.40957946e-01]
 [ 1.73935431e-01 -2.09915799e-01]
 [ 1.04441829e-01 -5.72039031e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.0870394]
curr_Stock_Price:  99.59156041922405
curr_Factors:  [9.95915604e+01 4.09325770e-02]
mat_Sqrt:  [[ 2.01491663e+01  0.00000000e+00]
 [-8.09272039e-03  1.85427519e-02]]
grads:  [2.81960124e-03 7.18657016e+00]
Stock Position:  0.0028196012392614402
Bond Position:  [-0.36784789]


portfolio before change:  [-0.09161426]
curr_Stock_Price:  98.00166154753043
curr_Factors:  [9.80016615e+01 4.23802436e-02]
mat_Sqrt:  [[ 2.01750752e+01  0.00000000e+00]
 [-8.23458497e-03  1.88678045e-02]]
grads:  [ 7.87097513e-04 -3.09840060e+00]
Stock Position:  0.0007870975134830318
Bond Position:  [-0.16875112]


portfolio before change:  [-0.0927863]
curr_Stock_Price:  96.56620322838957
curr_Factors:  [9.65662032e+01 4.14025598e-02]
mat_Sqrt:  [[ 1.96489231e+01  0.00000000e+00]
 [-8.13904759e-03  1.86489008e-02]]
grads:  [  0.01973349 -11.28090771]
Stock Position:  0.01973348579619431
Bond Position:  [-1.9983741]


portfolio before change:  [-0.04844448]
curr_Stock_Price:  98.83855736730796
curr_Factors:  [9.88385574e+01 3.93465318e-02]
mat_Sqrt:  [[ 1.96055769e+01  0.00000000e+00]
 [-7.93438409e-03  1.81799578e-02]]
grads:  [-0.00766203 -5.53368327]
Stock Position:  -0.007662031940660527
Bond Position:  [0.7088597]


portfolio before change:  [-0.05940052]
curr_Stock_Price:  100.2916018809463
curr_Factors:  [1.00291602e+02 3.99386170e-02]
mat_Sqrt:  [[ 2.00429240e+01  0.00000000e+00]
 [-7.99385934e-03  1.83162328e-02]]
grads:  [ 0.00240569 -0.62274215]
Stock Position:  0.0024056892136856915
Bond Position:  [-0.30067095]


portfolio before change:  [-0.06631252]
curr_Stock_Price:  97.44966180477373
curr_Factors:  [9.74496618e+01 3.95712960e-02]
mat_Sqrt:  [[ 1.93852084e+01  0.00000000e+00]
 [-7.95701411e-03  1.82318097e-02]]
grads:  [-4.83975921e-03 -8.10404048e+00]
Stock Position:  -0.004839759206174184
Bond Position:  [0.40532038]


portfolio before change:  [-0.06199585]
curr_Stock_Price:  96.57868368447181
curr_Factors:  [9.65786837e+01 4.05803588e-02]
mat_Sqrt:  [[ 1.94553578e+01  0.00000000e+00]
 [-8.05782688e-03  1.84628008e-02]]
grads:  [-2.13591994e-03 -2.74663358e+00]
Stock Position:  -0.002135919937913191
Bond Position:  [0.14428848]


portfolio before change:  [-0.06034594]
curr_Stock_Price:  95.82311404500987
curr_Factors:  [9.58231140e+01 3.98427156e-02]
mat_Sqrt:  [[ 1.91269070e+01  0.00000000e+00]
 [-7.98425607e-03  1.82942289e-02]]
grads:  [-0.0532614  35.74849631]
Stock Position:  -0.05326139604639294
Bond Position:  [5.04332689]


portfolio before change:  [-0.15158105]
curr_Stock_Price:  97.5597583186833
curr_Factors:  [9.75597583e+01 4.06549316e-02]
mat_Sqrt:  [[ 1.96710405e+01  0.00000000e+00]
 [-8.06522725e-03  1.84797572e-02]]
grads:  [ 0.00238101 -1.73184476]
Stock Position:  0.002381006453988541
Bond Position:  [-0.38387147]


portfolio before change:  [-0.15064329]
curr_Stock_Price:  97.99392009100599
curr_Factors:  [9.79939201e+01 4.02905400e-02]
mat_Sqrt:  [[ 1.96698331e+01  0.00000000e+00]
 [-8.02900143e-03  1.83967534e-02]]
grads:  [-1.30572316e-03 -4.99799626e+00]
Stock Position:  -0.0013057231603580766
Bond Position:  [-0.02269036]


portfolio before change:  [-0.14932134]
curr_Stock_Price:  96.97714888900978
curr_Factors:  [9.69771489e+01 3.98381690e-02]
mat_Sqrt:  [[ 1.93561552e+01  0.00000000e+00]
 [-7.98380050e-03  1.82931851e-02]]
grads:  [1.19877678e-02 1.64998203e+01]
Stock Position:  0.011987767784939889
Bond Position:  [-1.31186088]


portfolio before change:  [-0.14374501]
curr_Stock_Price:  97.46967933192747
curr_Factors:  [9.74696793e+01 4.04852259e-02]
mat_Sqrt:  [[ 1.96118165e+01  0.00000000e+00]
 [-8.04837632e-03  1.84411469e-02]]
grads:  [ 0.00244834 -0.46588116]
Stock Position:  0.002448344259738265
Bond Position:  [-0.38238434]


portfolio before change:  [-0.14120769]
curr_Stock_Price:  98.54506911354098
curr_Factors:  [9.85450691e+01 4.23459262e-02]
mat_Sqrt:  [[ 2.02787283e+01  0.00000000e+00]
 [-8.23125032e-03  1.88601638e-02]]
grads:  [ 0.0075197  -1.52245667]
Stock Position:  0.007519703960328176
Bond Position:  [-0.88223744]


portfolio before change:  [-0.13513593]
curr_Stock_Price:  99.3818500201227
curr_Factors:  [9.93818500e+01 4.36897347e-02]
mat_Sqrt:  [[ 2.07728833e+01  0.00000000e+00]
 [-8.36083581e-03  1.91570815e-02]]
grads:  [3.19351729e-04 7.51171326e-01]
Stock Position:  0.00031935172944719584
Bond Position:  [-0.1668737]


portfolio before change:  [-0.13488873]
curr_Stock_Price:  100.28658572177497
curr_Factors:  [1.00286586e+02 4.24678301e-02]
mat_Sqrt:  [[ 2.06667831e+01  0.00000000e+00]
 [-8.24308972e-03  1.88872913e-02]]
grads:  [-0.00689464 -3.18343096]
Stock Position:  -0.006894640268108896
Bond Position:  [0.55655121]


portfolio before change:  [-0.13016968]
curr_Stock_Price:  99.62231761324097
curr_Factors:  [9.96223176e+01 4.16733744e-02]
mat_Sqrt:  [[ 2.03369572e+01  0.00000000e+00]
 [-8.16562301e-03  1.87097928e-02]]
grads:  [-0.00980226 -7.05292924]
Stock Position:  -0.009802261782306095
Bond Position:  [0.84635435]


portfolio before change:  [-0.13432535]
curr_Stock_Price:  100.06785639722442
curr_Factors:  [1.00067856e+02 4.28344424e-02]
mat_Sqrt:  [[ 2.07105273e+01  0.00000000e+00]
 [-8.27859335e-03  1.89686403e-02]]
grads:  [-1.80013794e-02 -2.32466818e+01]
Stock Position:  -0.018001379422207114
Bond Position:  [1.6670341]


portfolio before change:  [-0.15999775]
curr_Stock_Price:  101.5171456610824
curr_Factors:  [1.01517146e+02 4.56014197e-02]
mat_Sqrt:  [[ 2.16784676e+01  0.00000000e+00]
 [-8.54179557e-03  1.95717124e-02]]
grads:  [ 3.79734708e-03 -1.07254692e+01]
Stock Position:  0.0037973470815128576
Bond Position:  [-0.54549359]


portfolio before change:  [-0.16110035]
curr_Stock_Price:  101.26270182286358
curr_Factors:  [1.01262702e+02 4.57440029e-02]
mat_Sqrt:  [[ 2.16579124e+01  0.00000000e+00]
 [-8.55513908e-03  1.96022862e-02]]
grads:  [ 0.00366961 -2.91822609]
Stock Position:  0.003669605714729573
Bond Position:  [-0.53269454]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.16121059]
Stock Price:  101.26895634003453
PL:  [-1.43016693]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.48010448e-02  8.71040537e-02]
 [-3.29899283e-01  2.36217372e-01]
 [ 8.73520896e-01 -3.30615589e-01]
 [ 4.63313352e-01 -5.57738697e-02]
 [ 3.48177705e-01 -3.47447577e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-7.50460686e-01 -1.76126356e-02]
 [-1.41836115e+00  7.49826629e-01]
 [ 3.25879159e-02 -8.11381750e-02]
 [ 1.55108732e-01  5.97724548e-01]
 [-4.49338950e-01 -8.79951734e-02]
 [-4.03621602e-02 -1.41920543e-02]
 [-3.36793495e-02 -8.84269542e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15164486e-01 -6.12661894e-02]
 [ 3.04016850e-02 -2.88117651e-02]
 [-1.35909441e-01 -6.15883174e-01]
 [-2.51243817e-01 -3.19627946e-02]
 [ 1.33030383e-01 -2.48778661e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.92411333]
curr_Stock_Price:  100.34636122891555
curr_Factors:  [1.00346361e+02 4.20951998e-02]
mat_Sqrt:  [[ 2.05881781e+01  0.00000000e+00]
 [-8.20684590e-03  1.88042463e-02]]
grads:  [3.05108933e-03 4.63214810e+00]
Stock Position:  0.0030510893294175053
Bond Position:  [4.61794762]


portfolio before change:  [4.93512627]
curr_Stock_Price:  103.57743642290207
curr_Factors:  [1.03577436e+02 4.23434156e-02]
mat_Sqrt:  [[ 2.13136633e+01  0.00000000e+00]
 [-8.23100632e-03  1.88596047e-02]]
grads:  [-1.06413227e-02  1.25250436e+01]
Stock Position:  -0.010641322733341101
Bond Position:  [6.03732719]


portfolio before change:  [4.94468941]
curr_Stock_Price:  102.82061128004082
curr_Factors:  [1.02820611e+02 4.31558815e-02]
mat_Sqrt:  [[ 2.13599473e+01  0.00000000e+00]
 [-8.30959749e-03  1.90396797e-02]]
grads:  [  0.03413999 -17.36455618]
Stock Position:  0.034139991648969116
Bond Position:  [1.4343946]


portfolio before change:  [5.01661828]
curr_Stock_Price:  104.91698639285242
curr_Factors:  [1.04916986e+02 4.32003808e-02]
mat_Sqrt:  [[ 2.18066822e+01  0.00000000e+00]
 [-8.31388052e-03  1.90494934e-02]]
grads:  [ 0.02013014 -2.92784005]
Stock Position:  0.020130143382477716
Bond Position:  [2.9046243]


portfolio before change:  [5.03860144]
curr_Stock_Price:  105.9729606716308
curr_Factors:  [1.05972961e+02 4.10919716e-02]
mat_Sqrt:  [[ 2.14819429e+01  0.00000000e+00]
 [-8.10846191e-03  1.85788202e-02]]
grads:  [ 0.01550204 -1.87012723]
Stock Position:  0.015502035881174898
Bond Position:  [3.3958048]


portfolio before change:  [5.06100623]
curr_Stock_Price:  107.36347063114776
curr_Factors:  [1.07363471e+02 4.11515547e-02]
mat_Sqrt:  [[ 2.17795883e+01  0.00000000e+00]
 [-8.11433839e-03  1.85922849e-02]]
grads:  [-2.66130906e-05 -1.04081753e+00]
Stock Position:  -2.661309062681613e-05
Bond Position:  [5.06386351]


portfolio before change:  [5.06226179]
curr_Stock_Price:  107.76043512804472
curr_Factors:  [1.07760435e+02 3.92989924e-02]
mat_Sqrt:  [[ 2.13624001e+01  0.00000000e+00]
 [-7.92958939e-03  1.81689718e-02]]
grads:  [-0.03548981 -0.96937987]
Stock Position:  -0.035489807696329916
Bond Position:  [8.88665891]


portfolio before change:  [5.2106011]
curr_Stock_Price:  103.64327093981244
curr_Factors:  [1.03643271e+02 4.30420917e-02]
mat_Sqrt:  [[ 2.15024425e+01  0.00000000e+00]
 [-8.29863523e-03  1.90145621e-02]]
grads:  [-0.05074354 39.43433597]
Stock Position:  -0.05074353681330463
Bond Position:  [10.46982723]


portfolio before change:  [5.15323015]
curr_Stock_Price:  104.825465537202
curr_Factors:  [1.04825466e+02 4.23603365e-02]
mat_Sqrt:  [[ 2.15747862e+01  0.00000000e+00]
 [-8.23265075e-03  1.88633726e-02]]
grads:  [-1.30879017e-04 -4.30136098e+00]
Stock Position:  -0.00013087901676216485
Bond Position:  [5.1669496]


portfolio before change:  [5.1544263]
curr_Stock_Price:  105.5570125484316
curr_Factors:  [1.05557013e+02 4.28546865e-02]
mat_Sqrt:  [[ 2.18517514e+01  0.00000000e+00]
 [-8.28054941e-03  1.89731222e-02]]
grads:  [1.90363282e-02 3.15037526e+01]
Stock Position:  0.019036328166863563
Bond Position:  [3.14500837]


portfolio before change:  [5.15448165]
curr_Stock_Price:  105.51861195146537
curr_Factors:  [1.05518612e+02 4.19679112e-02]
mat_Sqrt:  [[ 2.16166179e+01  0.00000000e+00]
 [-8.19442847e-03  1.87757944e-02]]
grads:  [-0.02256334 -4.68662853]
Stock Position:  -0.022563344237396532
Bond Position:  [7.53533441]


portfolio before change:  [5.16037022]
curr_Stock_Price:  105.34113370712481
curr_Factors:  [1.05341134e+02 4.10845228e-02]
mat_Sqrt:  [[ 2.13519288e+01  0.00000000e+00]
 [-8.10772696e-03  1.85771363e-02]]
grads:  [-0.00218042 -0.76395275]
Stock Position:  -0.002180415691622578
Bond Position:  [5.39005768]


portfolio before change:  [5.15876122]
curr_Stock_Price:  106.69715324467867
curr_Factors:  [1.06697153e+02 4.20119261e-02]
mat_Sqrt:  [[ 2.18695139e+01  0.00000000e+00]
 [-8.19872440e-03  1.87856376e-02]]
grads:  [-3.30469332e-03 -4.70715747e+00]
Stock Position:  -0.003304693318919731
Bond Position:  [5.51136258]


portfolio before change:  [5.16228947]
curr_Stock_Price:  106.04648970312381
curr_Factors:  [1.06046490e+02 4.19574206e-02]
mat_Sqrt:  [[ 2.17220439e+01  0.00000000e+00]
 [-8.19340423e-03  1.87734475e-02]]
grads:  [7.00841699e-03 7.91426769e+00]
Stock Position:  0.0070084169882069156
Bond Position:  [4.41907145]


portfolio before change:  [5.1643139]
curr_Stock_Price:  106.17769216239833
curr_Factors:  [1.06177692e+02 4.27576892e-02]
mat_Sqrt:  [[ 2.19553515e+01  0.00000000e+00]
 [-8.27117300e-03  1.89516382e-02]]
grads:  [-0.00646326 -3.23276483]
Stock Position:  -0.006463264473598935
Bond Position:  [5.8505684]


portfolio before change:  [5.15365052]
curr_Stock_Price:  108.05386508513406
curr_Factors:  [1.08053865e+02 3.93851835e-02]
mat_Sqrt:  [[ 2.14440466e+01  0.00000000e+00]
 [-7.93828027e-03  1.81888851e-02]]
grads:  [ 8.31335622e-04 -1.58403140e+00]
Stock Position:  0.0008313356223414945
Bond Position:  [5.06382149]


portfolio before change:  [5.15331827]
curr_Stock_Price:  106.13121395088203
curr_Factors:  [1.06131214e+02 4.19253289e-02]
mat_Sqrt:  [[ 2.17310830e+01  0.00000000e+00]
 [-8.19027022e-03  1.87662666e-02]]
grads:  [-1.86232271e-02 -3.28186307e+01]
Stock Position:  -0.018623227124695982
Bond Position:  [7.12982397]


portfolio before change:  [5.17507567]
curr_Stock_Price:  105.05864371863332
curr_Factors:  [1.05058644e+02 4.34996524e-02]
mat_Sqrt:  [[ 2.19116299e+01  0.00000000e+00]
 [-8.34262811e-03  1.91153624e-02]]
grads:  [-0.01210287 -1.67209985]
Stock Position:  -0.01210286619891968
Bond Position:  [6.44658637]


portfolio before change:  [5.1706425]
curr_Stock_Price:  105.55811361139773
curr_Factors:  [1.05558114e+02 4.27513891e-02]
mat_Sqrt:  [[ 2.18256273e+01  0.00000000e+00]
 [-8.27056361e-03  1.89502419e-02]]
grads:  [ 0.00559768 -1.3127994 ]
Stock Position:  0.005597676083749297
Bond Position:  [4.57976237]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.17031464]
Stock Price:  105.29498007842209
PL:  [-0.12466543]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.44359978e-02  1.35475343e-01]
 [ 4.68431537e-02 -5.02711907e-02]
 [ 5.57542704e-01 -2.34177875e-01]
 [-8.10041884e-02 -7.95580479e-02]
 [ 3.59946327e-01 -1.49990764e-02]
 [-2.69877701e-01 -3.10220803e-01]
 [-2.75357528e-02 -5.10737447e-02]
 [-1.28664555e+00  6.79224610e-01]
 [ 3.13998801e-02  9.98673952e-03]
 [ 1.92497427e-02 -6.87950571e-02]
 [ 1.15431586e-01  3.35412961e-01]
 [ 5.18103643e-02 -8.66152272e-03]
 [ 1.19127059e-01 -3.67108060e-02]
 [-6.60442943e-02 -8.21068439e-02]
 [ 5.17392900e-02  4.07724782e-02]
 [-1.43637424e-01 -1.40404609e-01]
 [-1.95821536e-01 -3.15377398e-01]
 [ 2.76064085e-01 -3.09547240e-01]
 [-1.50385358e-01 -1.63573173e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.97996871]
curr_Stock_Price:  99.15581529274789
curr_Factors:  [9.91558153e+01 4.13721077e-02]
mat_Sqrt:  [[ 2.01684263e+01  0.00000000e+00]
 [-8.13605385e-03  1.86420413e-02]]
grads:  [3.64739835e-03 7.26719466e+00]
Stock Position:  0.0036473983488101605
Bond Position:  [-3.34162947]


portfolio before change:  [-2.98258523]
curr_Stock_Price:  98.66751983654567
curr_Factors:  [9.86675198e+01 3.92765925e-02]
mat_Sqrt:  [[ 1.95542477e+01  0.00000000e+00]
 [-7.92732919e-03  1.81637930e-02]]
grads:  [ 1.27353441e-03 -2.76765930e+00]
Stock Position:  0.0012735344111448389
Bond Position:  [-3.10824171]


portfolio before change:  [-2.98446464]
curr_Stock_Price:  97.80201045383807
curr_Factors:  [9.78020105e+01 4.13029790e-02]
mat_Sqrt:  [[ 1.98764340e+01  0.00000000e+00]
 [-8.12925374e-03  1.86264603e-02]]
grads:  [  0.02290849 -12.57232298]
Stock Position:  0.02290849057781983
Bond Position:  [-5.22496108]


portfolio before change:  [-3.03396132]
curr_Stock_Price:  95.69841176961634
curr_Factors:  [9.56984118e+01 4.16002665e-02]
mat_Sqrt:  [[ 1.95187853e+01  0.00000000e+00]
 [-8.15845735e-03  1.86933742e-02]]
grads:  [-0.00592896 -4.25594904]
Stock Position:  -0.005928963586897254
Bond Position:  [-2.46656892]


portfolio before change:  [-3.03352578]
curr_Stock_Price:  95.52093415407583
curr_Factors:  [9.55209342e+01 4.09629012e-02]
mat_Sqrt:  [[ 1.93327625e+01  0.00000000e+00]
 [-8.09571751e-03  1.85496191e-02]]
grads:  [ 0.01827986 -0.80859215]
Stock Position:  0.018279860115116037
Bond Position:  [-4.77963509]


portfolio before change:  [-3.03209166]
curr_Stock_Price:  95.66476319073315
curr_Factors:  [9.56647632e+01 4.23077364e-02]
mat_Sqrt:  [[ 1.96771364e+01  0.00000000e+00]
 [-8.22753780e-03  1.88516574e-02]]
grads:  [ -0.02059594 -16.45589017]
Stock Position:  -0.020595941999503414
Bond Position:  [-1.06178575]


portfolio before change:  [-3.04491961]
curr_Stock_Price:  96.27471168831477
curr_Factors:  [9.62747117e+01 4.21185812e-02]
mat_Sqrt:  [[ 1.97582781e+01  0.00000000e+00]
 [-8.20912480e-03  1.88094679e-02]]
grads:  [-2.52178668e-03 -2.71532108e+00]
Stock Position:  -0.002521786677462528
Bond Position:  [-2.80213532]


portfolio before change:  [-3.04705856]
curr_Stock_Price:  96.84507514833095
curr_Factors:  [9.68450751e+01 4.02908684e-02]
mat_Sqrt:  [[ 1.94393104e+01  0.00000000e+00]
 [-8.02903415e-03  1.83968284e-02]]
grads:  [-0.05093841 36.92074501]
Stock Position:  -0.05093841352467978
Bond Position:  [1.88607592]


portfolio before change:  [-2.96248288]
curr_Stock_Price:  95.1939812165518
curr_Factors:  [9.51939812e+01 4.10505713e-02]
mat_Sqrt:  [[ 1.92871960e+01  0.00000000e+00]
 [-8.10437623e-03  1.85694588e-02]]
grads:  [0.001854   0.53780456]
Stock Position:  0.0018539994428386636
Bond Position:  [-3.13897247]


portfolio before change:  [-2.96246383]
curr_Stock_Price:  95.6275807400783
curr_Factors:  [9.56275807e+01 4.26618624e-02]
mat_Sqrt:  [[ 1.97516360e+01  0.00000000e+00]
 [-8.26189929e-03  1.89303894e-02]]
grads:  [-5.45518445e-04 -3.63410681e+00]
Stock Position:  -0.00054551844510677
Bond Position:  [-2.91029722]


portfolio before change:  [-2.96324738]
curr_Stock_Price:  95.7300244374787
curr_Factors:  [9.57300244e+01 4.30396315e-02]
mat_Sqrt:  [[ 1.98601462e+01  0.00000000e+00]
 [-8.29839806e-03  1.90140186e-02]]
grads:  [1.31830753e-02 1.76402983e+01]
Stock Position:  0.01318307532792267
Bond Position:  [-4.2252635]


portfolio before change:  [-2.95928953]
curr_Stock_Price:  96.11038280017304
curr_Factors:  [9.61103828e+01 4.10148442e-02]
mat_Sqrt:  [[ 1.94643919e+01  0.00000000e+00]
 [-8.10084876e-03  1.85613763e-02]]
grads:  [ 0.00246759 -0.46664227]
Stock Position:  0.0024675913916405094
Bond Position:  [-3.19645069]


portfolio before change:  [-2.96278069]
curr_Stock_Price:  95.01946256333417
curr_Factors:  [9.50194626e+01 4.16112093e-02]
mat_Sqrt:  [[ 1.93828546e+01  0.00000000e+00]
 [-8.15953031e-03  1.86958326e-02]]
grads:  [ 0.0053194  -1.96358229]
Stock Position:  0.005319399634639942
Bond Position:  [-3.46822718]


portfolio before change:  [-2.95486256]
curr_Stock_Price:  96.67102014356892
curr_Factors:  [9.66710201e+01 4.18379710e-02]
mat_Sqrt:  [[ 1.97734117e+01  0.00000000e+00]
 [-8.18173292e-03  1.87467052e-02]]
grads:  [-0.00515231 -4.3798013 ]
Stock Position:  -0.0051523055478943725
Bond Position:  [-2.45678393]


portfolio before change:  [-2.95651851]
curr_Stock_Price:  96.8731970287574
curr_Factors:  [9.6873197e+01 4.2259400e-02]
mat_Sqrt:  [[ 1.99143115e+01  0.00000000e+00]
 [-8.22283650e-03  1.88408853e-02]]
grads:  [0.00349165 2.16404258]
Stock Position:  0.0034916526411574787
Bond Position:  [-3.29476606]


portfolio before change:  [-2.9562909]
curr_Stock_Price:  97.1743176965237
curr_Factors:  [9.71743177e+01 4.21993367e-02]
mat_Sqrt:  [[ 1.99620120e+01  0.00000000e+00]
 [-8.21699085e-03  1.88274913e-02]]
grads:  [-0.01026525 -7.45742527]
Stock Position:  -0.010265248780282699
Bond Position:  [-1.95877235]


portfolio before change:  [-2.93948792]
curr_Stock_Price:  95.48972772882159
curr_Factors:  [9.54897277e+01 4.29824469e-02]
mat_Sqrt:  [[ 1.97971294e+01  0.00000000e+00]
 [-8.29288339e-03  1.90013829e-02]]
grads:  [ -0.01684403 -16.59760234]
Stock Position:  -0.01684403379406973
Bond Position:  [-1.33105571]


portfolio before change:  [-2.94538069]
curr_Stock_Price:  95.81981328859685
curr_Factors:  [9.58198133e+01 4.43531333e-02]
mat_Sqrt:  [[ 2.01798286e+01  0.00000000e+00]
 [-8.42407344e-03  1.93019771e-02]]
grads:  [ 6.98551986e-03 -1.60370742e+01]
Stock Position:  0.00698551985582212
Bond Position:  [-3.6147319]


portfolio before change:  [-2.94959172]
curr_Stock_Price:  95.34637289599316
curr_Factors:  [9.53463729e+01 4.44596755e-02]
mat_Sqrt:  [[ 2.01042243e+01  0.00000000e+00]
 [-8.43418525e-03  1.93251462e-02]]
grads:  [-0.01103124 -8.46426577]
Stock Position:  -0.01103124099730332
Bond Position:  [-1.8978029]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.96213194]
Stock Price:  96.44014913817554
PL:  [-2.96213194]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.43757882e-02  1.35583216e-01]
 [ 4.78313222e-02 -4.87862565e-02]
 [ 6.26783671e-01 -2.55310474e-01]
 [-1.08734437e-01 -1.19963736e-01]
 [ 3.99668127e-01 -1.83244803e-02]
 [-6.13418604e-01 -5.37744446e-01]
 [-5.74327584e-02 -7.97800938e-02]
 [-1.70640404e+00  5.07186971e-01]
 [-1.10647704e-02  7.06534540e-02]
 [ 3.02856976e-02  1.22338528e-04]
 [ 1.17340070e-01  3.49568798e-01]
 [ 2.57170312e-01 -4.59411606e-01]
 [-4.13573637e-02  2.35190272e-01]
 [-1.71246233e-01 -3.10473696e-01]
 [ 2.91221728e-01  4.92130095e-01]
 [ 1.15723198e-01 -7.74004686e-02]
 [-2.16036537e-01 -2.87480143e-02]
 [ 8.47001250e-01 -7.63512919e-01]
 [-6.27145596e-01 -2.85918812e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.97084719]
curr_Stock_Price:  99.15718921494178
curr_Factors:  [9.91571892e+01 4.04604918e-02]
mat_Sqrt:  [[ 1.99452639e+01  0.00000000e+00]
 [-8.04591741e-03  1.84355128e-02]]
grads:  [3.68754985e-03 7.35445861e+00]
Stock Position:  0.0036875498494312827
Bond Position:  [-3.33649426]


portfolio before change:  [-2.97308558]
curr_Stock_Price:  98.7764031162731
curr_Factors:  [9.87764031e+01 4.01500974e-02]
mat_Sqrt:  [[ 1.97923111e+01  0.00000000e+00]
 [-8.01499569e-03  1.83646622e-02]]
grads:  [ 1.34088708e-03 -2.65652893e+00]
Stock Position:  0.0013408870802602754
Bond Position:  [-3.10553358]


portfolio before change:  [-2.97367738]
curr_Stock_Price:  98.91413753565115
curr_Factors:  [9.89141375e+01 4.10900695e-02]
mat_Sqrt:  [[ 2.00505738e+01  0.00000000e+00]
 [-8.10827424e-03  1.85783902e-02]]
grads:  [  0.02570286 -13.74233565]
Stock Position:  0.025702857665734522
Bond Position:  [-5.51605337]


portfolio before change:  [-3.01963322]
curr_Stock_Price:  97.17983000960325
curr_Factors:  [9.71798300e+01 4.26846592e-02]
mat_Sqrt:  [[ 2.00776114e+01  0.00000000e+00]
 [-8.26410641e-03  1.89354466e-02]]
grads:  [-0.00802341 -6.33540569]
Stock Position:  -0.008023409783219037
Bond Position:  [-2.23991962]


portfolio before change:  [-2.99960653]
curr_Stock_Price:  94.61399561618948
curr_Factors:  [9.46139956e+01 4.47345615e-02]
mat_Sqrt:  [[ 2.00113771e+01  0.00000000e+00]
 [-8.46021858e-03  1.93847960e-02]]
grads:  [ 0.0195724  -0.94530168]
Stock Position:  0.019572399584445822
Bond Position:  [-4.85142946]


portfolio before change:  [-3.03026965]
curr_Stock_Price:  93.10931983608693
curr_Factors:  [9.31093198e+01 4.51327682e-02]
mat_Sqrt:  [[ 1.97805854e+01  0.00000000e+00]
 [-8.49778967e-03  1.94708822e-02]]
grads:  [ -0.04287586 -27.61787783]
Stock Position:  -0.04287585547453569
Bond Position:  [0.96187209]


portfolio before change:  [-2.94476296]
curr_Stock_Price:  91.1206436177713
curr_Factors:  [9.11206436e+01 4.44886518e-02]
mat_Sqrt:  [[ 1.92194697e+01  0.00000000e+00]
 [-8.43693326e-03  1.93314427e-02]]
grads:  [-0.00479991 -4.12696017]
Stock Position:  -0.004799905887494313
Bond Position:  [-2.50739245]


portfolio before change:  [-2.94579206]
curr_Stock_Price:  91.20443136590417
curr_Factors:  [9.12044314e+01 4.65058227e-02]
mat_Sqrt:  [[ 1.96684260e+01  0.00000000e+00]
 [-8.62608349e-03  1.97648403e-02]]
grads:  [-0.07550424 25.6610711 ]
Stock Position:  -0.07550423699640745
Bond Position:  [3.94052894]


portfolio before change:  [-2.98789347]
curr_Stock_Price:  91.7750835592221
curr_Factors:  [9.17750836e+01 4.76268222e-02]
mat_Sqrt:  [[ 2.00285999e+01  0.00000000e+00]
 [-8.72942813e-03  2.00016326e-02]]
grads:  [9.87134651e-04 3.53238435e+00]
Stock Position:  0.0009871346505311073
Bond Position:  [-3.07848783]


portfolio before change:  [-2.98996844]
curr_Stock_Price:  90.45281965755346
curr_Factors:  [9.04528197e+01 4.77514067e-02]
mat_Sqrt:  [[ 1.97658363e+01  0.00000000e+00]
 [-8.74083810e-03  2.00277761e-02]]
grads:  [0.00153493 0.00610844]
Stock Position:  0.0015349257182440254
Bond Position:  [-3.1288068]


portfolio before change:  [-2.99293134]
curr_Stock_Price:  89.03216052668795
curr_Factors:  [8.90321605e+01 4.69339902e-02]
mat_Sqrt:  [[ 1.92881534e+01  0.00000000e+00]
 [-8.66570161e-03  1.98556168e-02]]
grads:  [1.39932732e-02 1.76055371e+01]
Stock Position:  0.013993273238911768
Bond Position:  [-4.23878269]


portfolio before change:  [-3.0436704]
curr_Stock_Price:  85.48193807612394
curr_Factors:  [8.54819381e+01 4.85398582e-02]
mat_Sqrt:  [[ 1.88331780e+01  0.00000000e+00]
 [-8.81270521e-03  2.01924444e-02]]
grads:  [ 3.00887346e-03 -2.27516589e+01]
Stock Position:  0.0030088734618061294
Bond Position:  [-3.30087474]


portfolio before change:  [-3.04728837]
curr_Stock_Price:  84.55380110408724
curr_Factors:  [8.45538011e+01 4.64423375e-02]
mat_Sqrt:  [[ 1.82217537e+01  0.00000000e+00]
 [-8.62019373e-03  1.97513451e-02]]
grads:  [3.36345707e-03 1.19075572e+01]
Stock Position:  0.0033634570661795152
Bond Position:  [-3.33168145]


portfolio before change:  [-3.0450806]
curr_Stock_Price:  85.4578695531032
curr_Factors:  [8.54578696e+01 4.56347580e-02]
mat_Sqrt:  [[ 1.82557608e+01  0.00000000e+00]
 [-8.54491737e-03  1.95788653e-02]]
grads:  [ -0.01680281 -15.85759393]
Stock Position:  -0.01680280901733301
Bond Position:  [-1.60914834]


portfolio before change:  [-3.04183168]
curr_Stock_Price:  85.24056904141682
curr_Factors:  [8.5240569e+01 4.4688021e-02]
mat_Sqrt:  [[ 1.80194654e+01  0.00000000e+00]
 [-8.45581655e-03  1.93747097e-02]]
grads:  [ 0.02808102 25.40064352]
Stock Position:  0.028081016815511388
Bond Position:  [-5.43547353]


portfolio before change:  [-3.07419923]
curr_Stock_Price:  84.13631733776117
curr_Factors:  [8.41363173e+01 4.51444936e-02]
mat_Sqrt:  [[ 1.78766399e+01  0.00000000e+00]
 [-8.49889345e-03  1.94734113e-02]]
grads:  [ 0.0045838  -3.97467436]
Stock Position:  0.004583795670581293
Bond Position:  [-3.45986291]


portfolio before change:  [-3.07732612]
curr_Stock_Price:  83.64287851710642
curr_Factors:  [8.36428785e+01 4.59214236e-02]
mat_Sqrt:  [[ 1.79240704e+01  0.00000000e+00]
 [-8.57171382e-03  1.96402637e-02]]
grads:  [-0.01275286 -1.46372853]
Stock Position:  -0.012752862133933335
Bond Position:  [-2.01064003]


portfolio before change:  [-3.07638495]
curr_Stock_Price:  83.52965744854943
curr_Factors:  [8.35296574e+01 4.77959905e-02]
mat_Sqrt:  [[ 1.82614994e+01  0.00000000e+00]
 [-8.74491766e-03  2.00371236e-02]]
grads:  [ 2.81344309e-02 -3.81049164e+01]
Stock Position:  0.02813443089573491
Bond Position:  [-5.42644433]


portfolio before change:  [-3.04612217]
curr_Stock_Price:  84.65353173160032
curr_Factors:  [8.46535317e+01 4.59975499e-02]
mat_Sqrt:  [[ 1.81556763e+01  0.00000000e+00]
 [-8.57881576e-03  1.96565363e-02]]
grads:  [ -0.04141574 -14.54573722]
Stock Position:  -0.041415741435911604
Bond Position:  [0.45986661]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.00316323]
Stock Price:  83.6190466828454
PL:  [-3.00316323]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.15281799e-01 -4.28527738e-02]
 [ 3.01776629e-02 -7.45941366e-02]
 [ 5.20827306e-01 -2.22972200e-01]
 [-1.06367110e-01 -1.00923898e-01]
 [ 2.27805060e-01 -6.74552656e-03]
 [ 1.70639810e-02 -9.32814750e-02]
 [-6.01266414e-02 -6.29856797e-02]
 [-1.32386565e+00  6.37321126e-01]
 [ 1.68249965e-02  3.07529983e-02]
 [ 2.33460401e-02 -4.90545709e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 1.47726124e-01 -2.17130690e-01]
 [-5.20452044e-03  1.45361046e-01]
 [-1.48445624e-01 -2.60966455e-01]
 [ 2.04256171e-01  3.28328727e-01]
 [ 1.73765112e-02 -9.63210301e-02]
 [-2.06344082e-01 -1.68727530e-01]
 [ 5.41687346e-01 -5.41933659e-01]
 [-3.14006013e-01 -2.05560335e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.53655266]
curr_Stock_Price:  97.26449003800415
curr_Factors:  [9.72644900e+01 3.86354207e-02]
mat_Sqrt:  [[ 1.91182060e+01  0.00000000e+00]
 [-7.86235799e-03  1.80149253e-02]]
grads:  [ 0.00505169 -2.37873724]
Stock Position:  0.005051693417121138
Bond Position:  [-16.02790304]


portfolio before change:  [-15.54243745]
curr_Stock_Price:  96.89286760419388
curr_Factors:  [9.68928676e+01 3.62860168e-02]
mat_Sqrt:  [[ 1.84570147e+01  0.00000000e+00]
 [-7.61955556e-03  1.74585951e-02]]
grads:  [-1.28833800e-04 -4.27263112e+00]
Stock Position:  -0.00012883379956523926
Bond Position:  [-15.52995438]


portfolio before change:  [-15.54644496]
curr_Stock_Price:  97.85947262900636
curr_Factors:  [9.78594726e+01 3.60033720e-02]
mat_Sqrt:  [[ 1.85683990e+01  0.00000000e+00]
 [-7.58982182e-03  1.73904665e-02]]
grads:  [  0.02280833 -12.82151918]
Stock Position:  0.022808334758126173
Bond Position:  [-17.77845657]


portfolio before change:  [-15.52852228]
curr_Stock_Price:  98.8401600611482
curr_Factors:  [9.88401601e+01 3.32556645e-02]
mat_Sqrt:  [[ 1.80246257e+01  0.00000000e+00]
 [-7.29445428e-03  1.67136944e-02]]
grads:  [-0.00834491 -6.03839556]
Stock Position:  -0.00834491174086399
Bond Position:  [-14.70370987]


portfolio before change:  [-15.53106446]
curr_Stock_Price:  98.70424417221531
curr_Factors:  [9.87042442e+01 3.28632825e-02]
mat_Sqrt:  [[ 1.78933352e+01  0.00000000e+00]
 [-7.25129313e-03  1.66147998e-02]]
grads:  [ 0.01256675 -0.40599505]
Stock Position:  0.012566750033725453
Bond Position:  [-16.77145603]


portfolio before change:  [-15.53799251]
curr_Stock_Price:  98.48663332365366
curr_Factors:  [9.84866333e+01 3.00288631e-02]
mat_Sqrt:  [[ 1.70665893e+01  0.00000000e+00]
 [-6.93153525e-03  1.58821425e-02]]
grads:  [-1.38559568e-03 -5.87335589e+00]
Stock Position:  -0.0013855956825367735
Bond Position:  [-15.40152986]


portfolio before change:  [-15.53728719]
curr_Stock_Price:  95.1983837210166
curr_Factors:  [9.51983837e+01 3.05519997e-02]
mat_Sqrt:  [[ 1.66398496e+01  0.00000000e+00]
 [-6.99165213e-03  1.60198876e-02]]
grads:  [-0.00526542 -3.93171796]
Stock Position:  -0.005265422947071377
Bond Position:  [-15.03602744]


portfolio before change:  [-15.54041722]
curr_Stock_Price:  95.07883967961281
curr_Factors:  [9.50788397e+01 3.05534648e-02]
mat_Sqrt:  [[ 1.66193528e+01  0.00000000e+00]
 [-6.99181977e-03  1.60202717e-02]]
grads:  [-0.06292158 39.78216718]
Stock Position:  -0.06292157826512076
Bond Position:  [-9.55790657]


portfolio before change:  [-15.47653943]
curr_Stock_Price:  94.02566255130361
curr_Factors:  [9.40256626e+01 3.03365514e-02]
mat_Sqrt:  [[ 1.63768174e+01  0.00000000e+00]
 [-6.96695645e-03  1.59633026e-02]]
grads:  [1.84692206e-03 1.92648094e+00]
Stock Position:  0.0018469220567449889
Bond Position:  [-15.6501975]


portfolio before change:  [-15.48123805]
curr_Stock_Price:  93.60031390360253
curr_Factors:  [9.36003139e+01 3.12512333e-02]
mat_Sqrt:  [[ 1.65466807e+01  0.00000000e+00]
 [-7.07120735e-03  1.62021715e-02]]
grads:  [ 1.17054908e-04 -3.02765411e+00]
Stock Position:  0.00011705490799226816
Bond Position:  [-15.49219443]


portfolio before change:  [-15.48520187]
curr_Stock_Price:  92.8290224511422
curr_Factors:  [9.28290225e+01 3.32999547e-02]
mat_Sqrt:  [[ 1.69396955e+01  0.00000000e+00]
 [-7.29931007e-03  1.67248205e-02]]
grads:  [1.59332499e-02 2.09011988e+01]
Stock Position:  0.0159332499091484
Bond Position:  [-16.96426988]


portfolio before change:  [-15.5162406]
curr_Stock_Price:  91.14718489790106
curr_Factors:  [9.11471849e+01 3.51949394e-02]
mat_Sqrt:  [[ 1.70994984e+01  0.00000000e+00]
 [-7.50412574e-03  1.71941121e-02]]
grads:  [ 3.09731434e-03 -1.26282002e+01]
Stock Position:  0.003097314343754695
Bond Position:  [-15.79855209]


portfolio before change:  [-15.52980665]
curr_Stock_Price:  88.04258691830418
curr_Factors:  [8.80425869e+01 3.63075424e-02]
mat_Sqrt:  [[ 1.67761083e+01  0.00000000e+00]
 [-7.62181526e-03  1.74637727e-02]]
grads:  [3.47137967e-03 8.32357641e+00]
Stock Position:  0.0034713796658736797
Bond Position:  [-15.8354359]


portfolio before change:  [-15.53432814]
curr_Stock_Price:  87.8806527606007
curr_Factors:  [8.78806528e+01 3.55397619e-02]
mat_Sqrt:  [[ 1.65672540e+01  0.00000000e+00]
 [-7.54079698e-03  1.72781365e-02]]
grads:  [ -0.01583489 -15.10385424]
Stock Position:  -0.015834894664463296
Bond Position:  [-14.14274726]


portfolio before change:  [-15.56284757]
curr_Stock_Price:  89.45839017404278
curr_Factors:  [8.94583902e+01 3.46235257e-02]
mat_Sqrt:  [[ 1.66458786e+01  0.00000000e+00]
 [-7.44295917e-03  1.70539619e-02]]
grads:  [ 0.02087908 19.25234319]
Stock Position:  0.020879076592611637
Bond Position:  [-17.43065615]


portfolio before change:  [-15.57464733]
curr_Stock_Price:  89.10197853804465
curr_Factors:  [8.91019785e+01 3.53335973e-02]
mat_Sqrt:  [[ 1.67487066e+01  0.00000000e+00]
 [-7.51889325e-03  1.72279487e-02]]
grads:  [-1.47243804e-03 -5.59097497e+00]
Stock Position:  -0.0014724380416294173
Bond Position:  [-15.44345019]


portfolio before change:  [-15.57847511]
curr_Stock_Price:  89.0791830571344
curr_Factors:  [8.90791831e+01 3.59578441e-02]
mat_Sqrt:  [[ 1.68916879e+01  0.00000000e+00]
 [-7.58502146e-03  1.73794675e-02]]
grads:  [-0.01657518 -9.7084407 ]
Stock Position:  -0.016575182750164275
Bond Position:  [-14.10197137]


portfolio before change:  [-15.58957413]
curr_Stock_Price:  89.53607623195622
curr_Factors:  [8.95360762e+01 3.57039081e-02]
mat_Sqrt:  [[ 1.69182694e+01  0.00000000e+00]
 [-7.55819112e-03  1.73179915e-02]]
grads:  [ 1.80377850e-02 -3.12931012e+01]
Stock Position:  0.01803778499890343
Bond Position:  [-17.20460662]


portfolio before change:  [-15.5553659]
curr_Stock_Price:  91.67103482311856
curr_Factors:  [9.16710348e+01 3.58266267e-02]
mat_Sqrt:  [[ 1.73514228e+01  0.00000000e+00]
 [-7.57116918e-03  1.73477279e-02]]
grads:  [ -0.02326725 -11.84940968]
Stock Position:  -0.023267250291429467
Bond Position:  [-13.42243298]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.6110029]
Stock Price:  93.9180116911777
PL:  [-15.6110029]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.14834234e-02  2.32484298e-02]
 [ 5.46198983e-02 -3.85849709e-02]
 [ 6.04271630e-01 -2.48439716e-01]
 [ 1.30836953e-01 -1.14381356e-01]
 [ 1.90340119e-01 -5.50601890e-03]
 [ 3.65309206e-02 -1.77582242e-02]
 [-2.10391094e-01 -1.81024998e-01]
 [-1.44050445e+00  7.52813717e-01]
 [ 5.81930706e-02 -7.71564753e-02]
 [ 1.37947366e-01  4.45428704e-01]
 [-3.58718207e-01 -5.56279070e-02]
 [-4.07606797e-03 -9.59055833e-03]
 [-1.61403820e-02 -7.60091019e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.14960799e-01 -6.11505860e-02]
 [-8.26274694e-02 -9.95686046e-02]
 [-1.30277310e-01 -6.35355099e-01]
 [-4.02199769e-01  6.76589961e-02]
 [ 1.63801212e-01  4.99260256e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.30736412]
curr_Stock_Price:  101.30783319254087
curr_Factors:  [1.01307833e+02 3.84516988e-02]
mat_Sqrt:  [[ 1.98655591e+01  0.00000000e+00]
 [-7.84364188e-03  1.79720413e-02]]
grads:  [1.08881255e-03 1.29358871e+00]
Stock Position:  0.0010888125472585828
Bond Position:  [11.19705888]


portfolio before change:  [11.30831563]
curr_Stock_Price:  99.61047757699431
curr_Factors:  [9.96104776e+01 3.57294632e-02]
mat_Sqrt:  [[ 1.88286104e+01  0.00000000e+00]
 [-7.56089552e-03  1.73241880e-02]]
grads:  [ 2.00652283e-03 -2.22723113e+00]
Stock Position:  0.0020065228262976017
Bond Position:  [11.10844494]


portfolio before change:  [11.30974025]
curr_Stock_Price:  98.93625710953462
curr_Factors:  [9.89362571e+01 3.79502870e-02]
mat_Sqrt:  [[ 1.92736074e+01  0.00000000e+00]
 [-7.79233336e-03  1.78544787e-02]]
grads:  [  0.02572656 -13.91470005]
Stock Position:  0.02572656162497211
Bond Position:  [8.76445054]


portfolio before change:  [11.35552953]
curr_Stock_Price:  100.63092162699111
curr_Factors:  [1.00630922e+02 3.56541175e-02]
mat_Sqrt:  [[ 1.90014304e+01  0.00000000e+00]
 [-7.55291917e-03  1.73059119e-02]]
grads:  [ 4.25846030e-03 -6.60938044e+00]
Stock Position:  0.004258460297680835
Bond Position:  [10.92699675]


portfolio before change:  [11.35224291]
curr_Stock_Price:  99.21756833066934
curr_Factors:  [9.92175683e+01 3.75876082e-02]
mat_Sqrt:  [[ 1.92358298e+01  0.00000000e+00]
 [-7.75500955e-03  1.77689591e-02]]
grads:  [ 0.00977016 -0.30986727]
Stock Position:  0.009770157981356473
Bond Position:  [10.3828716]


portfolio before change:  [11.37127946]
curr_Stock_Price:  100.90029501529935
curr_Factors:  [1.00900295e+02 3.43166067e-02]
mat_Sqrt:  [[ 1.86915193e+01  0.00000000e+00]
 [-7.40989681e-03  1.69782065e-02]]
grads:  [ 0.00153977 -1.04594229]
Stock Position:  0.0015397676129598758
Bond Position:  [11.21591646]


portfolio before change:  [11.37675798]
curr_Stock_Price:  102.63703985123347
curr_Factors:  [1.02637040e+02 3.50662307e-02]
mat_Sqrt:  [[ 1.92197910e+01  0.00000000e+00]
 [-7.49039179e-03  1.71626437e-02]]
grads:  [ -0.01505723 -10.54761736]
Stock Position:  -0.0150572334814926
Bond Position:  [12.92218785]


portfolio before change:  [11.3588497]
curr_Stock_Price:  104.04096453585308
curr_Factors:  [1.04040965e+02 3.40754873e-02]
mat_Sqrt:  [[ 1.92054907e+01  0.00000000e+00]
 [-7.38381877e-03  1.69184542e-02]]
grads:  [-0.05789749 44.49660156]
Stock Position:  -0.0578974851358712
Bond Position:  [17.3825599]


portfolio before change:  [11.46087976]
curr_Stock_Price:  102.35377776594667
curr_Factors:  [1.02353778e+02 3.41325459e-02]
mat_Sqrt:  [[ 1.89098558e+01  0.00000000e+00]
 [-7.38999820e-03  1.69326131e-02]]
grads:  [ 1.29663728e-03 -4.55667858e+00]
Stock Position:  0.0012966372803075404
Bond Position:  [11.32816403]


portfolio before change:  [11.46620891]
curr_Stock_Price:  104.27933863335421
curr_Factors:  [1.04279339e+02 3.26111394e-02]
mat_Sqrt:  [[ 1.88313413e+01  0.00000000e+00]
 [-7.22342184e-03  1.65509387e-02]]
grads:  [1.76486839e-02 2.69125947e+01]
Stock Position:  0.01764868388220897
Bond Position:  [9.62581582]


portfolio before change:  [11.46991752]
curr_Stock_Price:  104.35310391849019
curr_Factors:  [1.04353104e+02 3.24632065e-02]
mat_Sqrt:  [[ 1.88018714e+01  0.00000000e+00]
 [-7.20701952e-03  1.65133562e-02]]
grads:  [-0.02037011 -3.36866148]
Stock Position:  -0.020370111417436682
Bond Position:  [13.59560188]


portfolio before change:  [11.49281958]
curr_Stock_Price:  103.39568507500047
curr_Factors:  [1.03395685e+02 3.36917376e-02]
mat_Sqrt:  [[ 1.89785977e+01  0.00000000e+00]
 [-7.34212368e-03  1.68229188e-02]]
grads:  [-4.35318295e-04 -5.70088845e-01]
Stock Position:  -0.0004353182946557296
Bond Position:  [11.53782961]


portfolio before change:  [11.49466882]
curr_Stock_Price:  105.77457492457077
curr_Factors:  [1.05774575e+02 3.33919220e-02]
mat_Sqrt:  [[ 1.93286712e+01  0.00000000e+00]
 [-7.30938269e-03  1.67478997e-02]]
grads:  [-2.55131215e-03 -4.53842590e+00]
Stock Position:  -0.002551312154648998
Bond Position:  [11.76453278]


portfolio before change:  [11.49456902]
curr_Stock_Price:  106.96662820449222
curr_Factors:  [1.06966628e+02 3.22598016e-02]
mat_Sqrt:  [[ 1.92122908e+01  0.00000000e+00]
 [-7.18440552e-03  1.64615411e-02]]
grads:  [7.92394530e-03 9.02577037e+00]
Stock Position:  0.007923945301113546
Bond Position:  [10.64697131]


portfolio before change:  [11.49484562]
curr_Stock_Price:  106.66558167714543
curr_Factors:  [1.06665582e+02 3.20716221e-02]
mat_Sqrt:  [[ 1.91022608e+01  0.00000000e+00]
 [-7.16342065e-03  1.64134587e-02]]
grads:  [-0.00741531 -3.72563682]
Stock Position:  -0.007415305674565741
Bond Position:  [12.28580351]


portfolio before change:  [11.51255634]
curr_Stock_Price:  104.69143736096076
curr_Factors:  [1.04691437e+02 3.22238498e-02]
mat_Sqrt:  [[ 1.87931627e+01  0.00000000e+00]
 [-7.18040108e-03  1.64523657e-02]]
grads:  [-0.00670897 -6.05193236]
Stock Position:  -0.0067089703171532246
Bond Position:  [12.21492808]


portfolio before change:  [11.5007402]
curr_Stock_Price:  106.90790974756159
curr_Factors:  [1.06907910e+02 3.33981977e-02]
mat_Sqrt:  [[ 1.95376063e+01  0.00000000e+00]
 [-7.31006952e-03  1.67494735e-02]]
grads:  [-2.08607443e-02 -3.79328401e+01]
Stock Position:  -0.020860744254876544
Bond Position:  [13.73091877]


portfolio before change:  [11.50811918]
curr_Stock_Price:  106.71875959478085
curr_Factors:  [1.06718760e+02 3.19703276e-02]
mat_Sqrt:  [[ 1.90815791e+01  0.00000000e+00]
 [-7.15209929e-03  1.63875182e-02]]
grads:  [-0.0195304   4.12869084]
Stock Position:  -0.01953040466961905
Bond Position:  [13.59237974]


portfolio before change:  [11.5547705]
curr_Stock_Price:  104.50412028107267
curr_Factors:  [1.04504120e+02 3.28246393e-02]
mat_Sqrt:  [[ 1.89336086e+01  0.00000000e+00]
 [-7.24702855e-03  1.66050285e-02]]
grads:  [0.00980218 3.00668113]
Stock Position:  0.009802184038004862
Bond Position:  [10.53040188]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.55084025]
Stock Price:  103.83455777393443
PL:  [7.71628248]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.11330056e-02  6.60304461e-02]
 [ 7.08889921e-02 -1.41371827e-02]
 [ 6.31483969e-01 -2.56745022e-01]
 [-1.24882240e-01 -1.43820458e-01]
 [ 1.39243487e-01 -6.12687487e-03]
 [-5.00085638e-03 -1.31373823e-01]
 [-4.27049693e-02 -5.62517400e-02]
 [-1.31614370e+00  6.43764973e-01]
 [-1.69277375e-03  5.72328692e-02]
 [ 2.83077720e-02 -1.85421509e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 1.62543255e-01 -2.49969126e-01]
 [ 1.00960066e-02  1.07343719e-01]
 [-1.26601575e-01 -2.13570857e-01]
 [ 1.66944151e-01  2.57941836e-01]
 [-1.31830936e-02 -9.58258938e-02]
 [-2.03118457e-01 -2.13686237e-01]
 [ 5.20870666e-01 -5.26715399e-01]
 [-3.46059391e-01 -2.13786190e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.74904561]
curr_Stock_Price:  100.47061598211337
curr_Factors:  [1.00470616e+02 3.86211461e-02]
mat_Sqrt:  [[ 1.97447502e+01  0.00000000e+00]
 [-7.86090541e-03  1.80115970e-02]]
grads:  [2.52983980e-03 3.66599619e+00]
Stock Position:  0.0025298397985273327
Bond Position:  [5.49487104]


portfolio before change:  [5.74968006]
curr_Stock_Price:  100.17833060764556
curr_Factors:  [1.00178331e+02 3.66064523e-02]
mat_Sqrt:  [[ 1.91669324e+01  0.00000000e+00]
 [-7.65312510e-03  1.75355125e-02]]
grads:  [ 0.0033766  -0.80620299]
Stock Position:  0.003376597691114858
Bond Position:  [5.41141814]


portfolio before change:  [5.7491507]
curr_Stock_Price:  99.62084982576046
curr_Factors:  [9.96208498e+01 3.57965579e-02]
mat_Sqrt:  [[ 1.88482432e+01  0.00000000e+00]
 [-7.56799133e-03  1.73404466e-02]]
grads:  [  0.0275586  -14.80613672]
Stock Position:  0.02755860317043683
Bond Position:  [3.00373923]


portfolio before change:  [5.70652567]
curr_Stock_Price:  98.04689301674729
curr_Factors:  [9.80468930e+01 3.59163626e-02]
mat_Sqrt:  [[ 1.85814675e+01  0.00000000e+00]
 [-7.58064511e-03  1.73694400e-02]]
grads:  [-0.01009881 -8.28008606]
Stock Position:  -0.01009880593522323
Bond Position:  [6.69668222]


portfolio before change:  [5.69226013]
curr_Stock_Price:  99.62528945569986
curr_Factors:  [9.96252895e+01 3.61757368e-02]
mat_Sqrt:  [[ 1.89486507e+01  0.00000000e+00]
 [-7.60796812e-03  1.74320449e-02]]
grads:  [ 0.00720735 -0.35147195]
Stock Position:  0.0072073469301386405
Bond Position:  [4.97422611]


portfolio before change:  [5.67988527]
curr_Stock_Price:  97.73574815023667
curr_Factors:  [9.77357482e+01 3.69427490e-02]
mat_Sqrt:  [[ 1.87852962e+01  0.00000000e+00]
 [-7.68819864e-03  1.76158761e-02]]
grads:  [-3.31839823e-03 -7.45769455e+00]
Stock Position:  -0.0033183982308944682
Bond Position:  [6.0042114]


portfolio before change:  [5.68790172]
curr_Stock_Price:  95.77238843643752
curr_Factors:  [9.57723884e+01 3.54606382e-02]
mat_Sqrt:  [[ 1.80348939e+01  0.00000000e+00]
 [-7.53239810e-03  1.72588922e-02]]
grads:  [-0.00372917 -3.2592903 ]
Stock Position:  -0.0037291731041646493
Bond Position:  [6.04505353]


portfolio before change:  [5.69092344]
curr_Stock_Price:  95.3673988863785
curr_Factors:  [9.53673989e+01 3.42558805e-02]
mat_Sqrt:  [[ 1.76509265e+01  0.00000000e+00]
 [-7.40333768e-03  1.69631777e-02]]
grads:  [-0.05864744 37.95072987]
Stock Position:  -0.05864743916975023
Bond Position:  [11.28397717]


portfolio before change:  [5.86000371]
curr_Stock_Price:  92.53251093134705
curr_Factors:  [9.25325109e+01 3.89099307e-02]
mat_Sqrt:  [[ 1.82525933e+01  0.00000000e+00]
 [-7.89024012e-03  1.80788113e-02]]
grads:  [1.27574739e-03 3.16574294e+00]
Stock Position:  0.0012757473884253269
Bond Position:  [5.7419556]


portfolio before change:  [5.85980518]
curr_Stock_Price:  91.25153813072899
curr_Factors:  [9.12515381e+01 3.85600227e-02]
mat_Sqrt:  [[ 1.79187964e+01  0.00000000e+00]
 [-7.85468245e-03  1.79973384e-02]]
grads:  [ 0.00112816 -1.03027184]
Stock Position:  0.0011281624886087574
Bond Position:  [5.75685862]


portfolio before change:  [5.86163192]
curr_Stock_Price:  91.59487674497593
curr_Factors:  [9.15948767e+01 3.89930718e-02]
mat_Sqrt:  [[ 1.80869321e+01  0.00000000e+00]
 [-7.89866539e-03  1.80981160e-02]]
grads:  [1.49226193e-02 1.93152037e+01]
Stock Position:  0.014922619276904484
Bond Position:  [4.49479644]


portfolio before change:  [5.84462515]
curr_Stock_Price:  90.37990219037884
curr_Factors:  [9.03799022e+01 3.99661745e-02]
mat_Sqrt:  [[ 1.80683360e+01  0.00000000e+00]
 [-7.99661673e-03  1.83225507e-02]]
grads:  [ 2.95809112e-03 -1.36427035e+01]
Stock Position:  0.0029580911234538525
Bond Position:  [5.57727317]


portfolio before change:  [5.84317924]
curr_Stock_Price:  89.4196862876396
curr_Factors:  [8.94196863e+01 4.15701996e-02]
mat_Sqrt:  [[ 1.82315754e+01  0.00000000e+00]
 [-8.15550853e-03  1.86866176e-02]]
grads:  [3.12340788e-03 5.74441672e+00]
Stock Position:  0.003123407884323768
Bond Position:  [5.56388509]


portfolio before change:  [5.84705331]
curr_Stock_Price:  90.2146265336416
curr_Factors:  [9.02146265e+01 4.16283284e-02]
mat_Sqrt:  [[ 1.84065096e+01  0.00000000e+00]
 [-8.16120857e-03  1.86996780e-02]]
grads:  [ -0.01194205 -11.42109807]
Stock Position:  -0.011942054359901502
Bond Position:  [6.92440128]


portfolio before change:  [5.83612465]
curr_Stock_Price:  91.27474391089292
curr_Factors:  [9.12747439e+01 3.98834388e-02]
mat_Sqrt:  [[ 1.82283316e+01  0.00000000e+00]
 [-7.98833538e-03  1.83035758e-02]]
grads:  [ 0.01533433 14.09242865]
Stock Position:  0.015334326979646467
Bond Position:  [4.43648788]


portfolio before change:  [5.84159564]
curr_Stock_Price:  91.5591860218532
curr_Factors:  [9.1559186e+01 4.0192805e-02]
mat_Sqrt:  [[ 1.83559168e+01  0.00000000e+00]
 [-8.01925732e-03  1.83744268e-02]]
grads:  [-2.99657832e-03 -5.21517730e+00]
Stock Position:  -0.002996578318718006
Bond Position:  [6.11595991]


portfolio before change:  [5.84462562]
curr_Stock_Price:  91.05834694052531
curr_Factors:  [9.10583469e+01 3.94958214e-02]
mat_Sqrt:  [[ 1.80965312e+01  0.00000000e+00]
 [-7.94942225e-03  1.82144146e-02]]
grads:  [ -0.01637766 -11.7317104 ]
Stock Position:  -0.0163776567569253
Bond Position:  [7.33594797]


portfolio before change:  [5.86500264]
curr_Stock_Price:  89.92614593711583
curr_Factors:  [8.99261459e+01 3.82717986e-02]
mat_Sqrt:  [[ 1.75924132e+01  0.00000000e+00]
 [-7.82527173e-03  1.79299500e-02]]
grads:  [ 1.65408359e-02 -2.93762893e+01]
Stock Position:  0.016540835915683477
Bond Position:  [4.37754901]


portfolio before change:  [5.8831019]
curr_Stock_Price:  90.95419185404832
curr_Factors:  [9.09541919e+01 3.92713270e-02]
mat_Sqrt:  [[ 1.80243872e+01  0.00000000e+00]
 [-7.92679779e-03  1.81625755e-02]]
grads:  [ -0.02437605 -11.77069795]
Stock Position:  -0.024376048370188086
Bond Position:  [8.10020568]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.88059139]
Stock Price:  91.14026843943694
PL:  [5.88059139]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [-3.06524990e-03  1.22884010e-01]
 [ 6.67390047e-02 -2.03734252e-02]
 [ 6.54225740e-01 -2.63685895e-01]
 [-1.00530259e-01 -9.17919348e-02]
 [ 2.93189971e-01 -1.01139230e-02]
 [-2.16396972e-01 -2.74325503e-01]
 [-3.38826222e-02 -5.28416682e-02]
 [-1.38853439e+00  5.73950318e-01]
 [-1.14297732e-02  7.11519466e-02]
 [ 2.39648089e-02 -4.60726596e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 1.32890813e-01 -1.84390431e-01]
 [ 4.78113722e-02  5.37187562e-02]
 [-8.60408899e-02 -1.25535282e-01]
 [ 9.00236762e-02  1.12970998e-01]
 [-1.43634781e-01 -1.40392740e-01]
 [-1.90834888e-01 -3.84855662e-01]
 [ 2.76307292e-01 -3.10321552e-01]
 [-3.37924371e-02 -1.33653140e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.4567349]
curr_Stock_Price:  99.67346598218992
curr_Factors:  [9.96734660e+01 3.89414307e-02]
mat_Sqrt:  [[ 1.96691464e+01  0.00000000e+00]
 [-7.89343329e-03  1.80861278e-02]]
grads:  [2.57081461e-03 6.79437917e+00]
Stock Position:  0.0025708146104686767
Bond Position:  [0.2004929]


portfolio before change:  [0.45767259]
curr_Stock_Price:  100.01870871207659
curr_Factors:  [1.00018709e+02 3.93775293e-02]
mat_Sqrt:  [[ 1.98474847e+01  0.00000000e+00]
 [-7.93750886e-03  1.81871176e-02]]
grads:  [ 0.00291459 -1.12021188]
Stock Position:  0.0029145916431639156
Bond Position:  [0.16615889]


portfolio before change:  [0.45668378]
curr_Stock_Price:  99.66519289309859
curr_Factors:  [9.96651929e+01 3.84106467e-02]
mat_Sqrt:  [[ 1.95330167e+01  0.00000000e+00]
 [-7.83945373e-03  1.79624451e-02]]
grads:  [  0.02760166 -14.67984422]
Stock Position:  0.02760166485317923
Bond Position:  [-2.29424147]


portfolio before change:  [0.43680141]
curr_Stock_Price:  98.96564320882477
curr_Factors:  [9.89656432e+01 3.91821768e-02]
mat_Sqrt:  [[ 1.95897427e+01  0.00000000e+00]
 [-7.91779533e-03  1.81419482e-02]]
grads:  [-0.00717679 -5.05965146]
Stock Position:  -0.00717679378112218
Bond Position:  [1.14705742]


portfolio before change:  [0.44850702]
curr_Stock_Price:  97.37456957874873
curr_Factors:  [9.73745696e+01 3.78908357e-02]
mat_Sqrt:  [[ 1.89545135e+01  0.00000000e+00]
 [-7.78622740e-03  1.78404882e-02]]
grads:  [ 0.0152352  -0.56690842]
Stock Position:  0.015235204655491094
Bond Position:  [-1.03501448]


portfolio before change:  [0.42829089]
curr_Stock_Price:  96.06462084564019
curr_Factors:  [9.60646208e+01 3.83120750e-02]
mat_Sqrt:  [[ 1.88031803e+01  0.00000000e+00]
 [-7.82938823e-03  1.79393821e-02]]
grads:  [ -0.01787583 -15.29180335]
Stock Position:  -0.01787582906586505
Bond Position:  [2.14552564]


portfolio before change:  [0.4288847]
curr_Stock_Price:  96.06141208277066
curr_Factors:  [9.60614121e+01 3.87883410e-02]
mat_Sqrt:  [[ 1.89190606e+01  0.00000000e+00]
 [-7.87790236e-03  1.80505419e-02]]
grads:  [-0.00300991 -2.92742835]
Stock Position:  -0.003009907208125663
Bond Position:  [0.71802064]


portfolio before change:  [0.43732235]
curr_Stock_Price:  93.3177670009158
curr_Factors:  [9.33177670e+01 4.00533187e-02]
mat_Sqrt:  [[ 1.86759882e+01  0.00000000e+00]
 [-8.00533009e-03  1.83425156e-02]]
grads:  [-0.0609361  31.29070906]
Stock Position:  -0.06093610257051605
Bond Position:  [6.12374337]


portfolio before change:  [0.53452117]
curr_Stock_Price:  91.74779954694542
curr_Factors:  [9.17477995e+01 4.23647770e-02]
mat_Sqrt:  [[ 1.88841795e+01  0.00000000e+00]
 [-8.23308224e-03  1.88643613e-02]]
grads:  [1.03914931e-03 3.77176547e+00]
Stock Position:  0.0010391493119755678
Bond Position:  [0.43918151]


portfolio before change:  [0.53621083]
curr_Stock_Price:  93.26812553551241
curr_Factors:  [9.32681255e+01 4.11656100e-02]
mat_Sqrt:  [[ 1.89234591e+01  0.00000000e+00]
 [-8.11572400e-03  1.85954598e-02]]
grads:  [ 2.0382382e-04 -2.4776295e+00]
Stock Position:  0.00020382381956346405
Bond Position:  [0.51720056]


portfolio before change:  [0.53641697]
curr_Stock_Price:  93.645071029739
curr_Factors:  [9.3645071e+01 4.0030335e-02]
mat_Sqrt:  [[ 1.87361147e+01  0.00000000e+00]
 [-8.00303292e-03  1.83372521e-02]]
grads:  [1.44055695e-02 1.90633142e+01]
Stock Position:  0.014405569451832386
Bond Position:  [-0.8125936]


portfolio before change:  [0.51128138]
curr_Stock_Price:  91.91432222290437
curr_Factors:  [9.19143222e+01 4.14618210e-02]
mat_Sqrt:  [[ 1.87157560e+01  0.00000000e+00]
 [-8.14487038e-03  1.86622425e-02]]
grads:  [ 2.80064729e-03 -9.88040054e+00]
Stock Position:  0.0028006472911957536
Bond Position:  [0.25386178]


portfolio before change:  [0.51004593]
curr_Stock_Price:  91.45052790897394
curr_Factors:  [9.14505279e+01 4.16881138e-02]
mat_Sqrt:  [[ 1.86720645e+01  0.00000000e+00]
 [-8.16706692e-03  1.87131012e-02]]
grads:  [0.00381619 2.87064959]
Stock Position:  0.003816190725873753
Bond Position:  [0.16105327]


portfolio before change:  [0.52186592]
curr_Stock_Price:  94.53730435586337
curr_Factors:  [9.45373044e+01 3.92854376e-02]
mat_Sqrt:  [[ 1.87378178e+01  0.00000000e+00]
 [-7.92822175e-03  1.81658382e-02]]
grads:  [-0.00751576 -6.91051416]
Stock Position:  -0.0075157619698028345
Bond Position:  [1.2323858]


portfolio before change:  [0.51861456]
curr_Stock_Price:  95.0109083143512
curr_Factors:  [9.50109083e+01 3.88564734e-02]
mat_Sqrt:  [[ 1.87285934e+01  0.00000000e+00]
 [-7.88481816e-03  1.80663880e-02]]
grads:  [0.00743933 6.2531037 ]
Stock Position:  0.007439334013770638
Bond Position:  [-0.18820332]


portfolio before change:  [0.53668374]
curr_Stock_Price:  97.44610348267588
curr_Factors:  [9.74461035e+01 3.89742379e-02]
mat_Sqrt:  [[ 1.92377065e+01  0.00000000e+00]
 [-7.89675760e-03  1.80937447e-02]]
grads:  [-0.01065133 -7.75918653]
Stock Position:  -0.01065133188227235
Bond Position:  [1.57461453]


portfolio before change:  [0.52627071]
curr_Stock_Price:  98.46069268669858
curr_Factors:  [9.84606927e+01 3.97079764e-02]
mat_Sqrt:  [[ 1.96201248e+01  0.00000000e+00]
 [-7.97074415e-03  1.82632692e-02]]
grads:  [-1.82873286e-02 -2.10726600e+01]
Stock Position:  -0.018287328636745516
Bond Position:  [2.32685376]


portfolio before change:  [0.5752872]
curr_Stock_Price:  95.81215361181505
curr_Factors:  [9.58121536e+01 4.21229102e-02]
mat_Sqrt:  [[ 1.96643586e+01  0.00000000e+00]
 [-8.20954666e-03  1.88104345e-02]]
grads:  [ 7.16381684e-03 -1.64973091e+01]
Stock Position:  0.007163816844209361
Bond Position:  [-0.11109352]


portfolio before change:  [0.5906517]
curr_Stock_Price:  97.96076648847169
curr_Factors:  [9.79607665e+01 4.31602313e-02]
mat_Sqrt:  [[ 2.03513890e+01  0.00000000e+00]
 [-8.31001625e-03  1.90406392e-02]]
grads:  [-4.52664186e-03 -7.01936203e+00]
Stock Position:  -0.004526641863258559
Bond Position:  [1.034085]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.60059561]
Stock Price:  95.82113134146695
PL:  [0.60059561]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.48330550e-02  2.73673717e-02]
 [ 5.33624370e-02  4.41469049e-04]
 [ 7.63607301e-01 -2.97069552e-01]
 [ 2.35931114e-01 -1.07210293e-01]
 [ 1.21673065e-01 -8.03728186e-03]
 [ 2.77382307e-02 -7.56731813e-02]
 [-2.83056422e-02 -7.80161686e-02]
 [-1.27613320e+00  6.86725014e-01]
 [ 6.04996853e-02 -3.15456847e-02]
 [ 1.93392454e-02 -6.83637343e-02]
 [ 1.14747494e-01  3.30338827e-01]
 [ 4.55983437e-02 -8.68650117e-03]
 [ 1.39901504e-01 -3.29996863e-02]
 [-1.04529031e-01 -1.65673223e-01]
 [ 1.67115788e-01  2.58208479e-01]
 [-3.62876786e-02 -1.01884441e-01]
 [-2.00339112e-01 -2.52428290e-01]
 [ 4.30254406e-01 -4.60647904e-01]
 [-3.74265986e-01 -2.21025171e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.46497928]
curr_Stock_Price:  100.87970128468248
curr_Factors:  [1.00879701e+02 4.22942969e-02]
mat_Sqrt:  [[ 2.07464929e+01  0.00000000e+00]
 [-8.22623091e-03  1.88486629e-02]]
grads:  [1.29068346e-03 1.45195295e+00]
Stock Position:  0.001290683460404238
Bond Position:  [8.33477552]


portfolio before change:  [8.46779919]
curr_Stock_Price:  101.44990763110823
curr_Factors:  [1.01449908e+02 4.13258599e-02]
mat_Sqrt:  [[ 2.06235111e+01  0.00000000e+00]
 [-8.13150514e-03  1.86316189e-02]]
grads:  [0.0025968  0.02369462]
Stock Position:  0.0025967988470437567
Bond Position:  [8.20435418]


portfolio before change:  [8.46956584]
curr_Stock_Price:  101.34027458862717
curr_Factors:  [1.01340275e+02 3.96714728e-02]
mat_Sqrt:  [[ 2.01846507e+01  0.00000000e+00]
 [-7.96707954e-03  1.82548725e-02]]
grads:  [  0.0314078  -16.27343887]
Stock Position:  0.03140780227249957
Bond Position:  [5.28669053]


portfolio before change:  [8.48017537]
curr_Stock_Price:  101.63598745024538
curr_Factors:  [1.01635987e+02 4.02091060e-02]
mat_Sqrt:  [[ 2.03802600e+01  0.00000000e+00]
 [-8.02088334e-03  1.83781525e-02]]
grads:  [ 0.00928058 -5.83357293]
Stock Position:  0.009280583603731633
Bond Position:  [7.53693409]


portfolio before change:  [8.46485862]
curr_Stock_Price:  99.7825242475978
curr_Factors:  [9.97825242e+01 4.15644902e-02]
mat_Sqrt:  [[ 2.03430335e+01  0.00000000e+00]
 [-8.15494845e-03  1.86853343e-02]]
grads:  [ 0.00580864 -0.43013851]
Stock Position:  0.0058086375145763
Bond Position:  [7.8852581]


portfolio before change:  [8.46214337]
curr_Stock_Price:  98.9756558761758
curr_Factors:  [9.89756559e+01 4.34680396e-02]
mat_Sqrt:  [[ 2.06354249e+01  0.00000000e+00]
 [-8.33959612e-03  1.91084152e-02]]
grads:  [-2.56270626e-04 -3.96020185e+00]
Stock Position:  -0.0002562706256773494
Bond Position:  [8.48750792]


portfolio before change:  [8.46454259]
curr_Stock_Price:  97.8944628214065
curr_Factors:  [9.78944628e+01 4.46311414e-02]
mat_Sqrt:  [[ 2.06812662e+01  0.00000000e+00]
 [-8.45043349e-03  1.93623756e-02]]
grads:  [-3.01503250e-03 -4.02926636e+00]
Stock Position:  -0.003015032495916103
Bond Position:  [8.75969758]


portfolio before change:  [8.46884508]
curr_Stock_Price:  97.19387728246379
curr_Factors:  [9.71938773e+01 4.62823170e-02]
mat_Sqrt:  [[ 2.09096351e+01  0.00000000e+00]
 [-8.60533016e-03  1.97172884e-02]]
grads:  [-0.04669722 34.82857272]
Stock Position:  -0.046697220069882285
Bond Position:  [13.00752895]


portfolio before change:  [8.4562555]
curr_Stock_Price:  97.5331236346537
curr_Factors:  [9.75331236e+01 4.59774139e-02]
mat_Sqrt:  [[ 2.09133884e+01  0.00000000e+00]
 [-8.57693781e-03  1.96522334e-02]]
grads:  [ 0.00223455 -1.60519591]
Stock Position:  0.0022345503725446775
Bond Position:  [8.23831283]


portfolio before change:  [8.45394372]
curr_Stock_Price:  95.57674984698816
curr_Factors:  [9.55767498e+01 4.53427728e-02]
mat_Sqrt:  [[ 2.03519626e+01  0.00000000e+00]
 [-8.51753700e-03  1.95161290e-02]]
grads:  [-5.15779956e-04 -3.50293515e+00]
Stock Position:  -0.0005157799556937817
Bond Position:  [8.5032403]


portfolio before change:  [8.45590342]
curr_Stock_Price:  95.89933181884153
curr_Factors:  [9.58993318e+01 4.58007223e-02]
mat_Sqrt:  [[ 2.05235151e+01  0.00000000e+00]
 [-8.56044132e-03  1.96144352e-02]]
grads:  [1.26157326e-02 1.68416182e+01]
Stock Position:  0.012615732591897844
Bond Position:  [7.24606309]


portfolio before change:  [8.50001104]
curr_Stock_Price:  99.25196115697116
curr_Factors:  [9.92519612e+01 4.30345499e-02]
mat_Sqrt:  [[ 2.05895915e+01  0.00000000e+00]
 [-8.29790817e-03  1.90128961e-02]]
grads:  [ 0.0020305  -0.45687417]
Stock Position:  0.002030503801550003
Bond Position:  [8.29847955]


portfolio before change:  [8.49582978]
curr_Stock_Price:  96.17088383431891
curr_Factors:  [9.61708838e+01 4.59442810e-02]
mat_Sqrt:  [[ 2.06138607e+01  0.00000000e+00]
 [-8.57384683e-03  1.96451511e-02]]
grads:  [ 0.0060881  -1.67978786]
Stock Position:  0.006088100710822404
Bond Position:  [7.91033175]


portfolio before change:  [8.47588928]
curr_Stock_Price:  92.5706933137531
curr_Factors:  [9.25706933e+01 4.49305889e-02]
mat_Sqrt:  [[ 1.96220588e+01  0.00000000e+00]
 [-8.47873471e-03  1.94272218e-02]]
grads:  [-0.00901204 -8.52789064]
Stock Position:  -0.009012038743607275
Bond Position:  [9.31013996]


portfolio before change:  [8.48993977]
curr_Stock_Price:  91.26991505379772
curr_Factors:  [9.12699151e+01 4.48821964e-02]
mat_Sqrt:  [[ 1.93359136e+01  0.00000000e+00]
 [-8.47416747e-03  1.94167569e-02]]
grads:  [ 0.01447086 13.29822893]
Stock Position:  0.014470855255205561
Bond Position:  [7.16918604]


portfolio before change:  [8.50998694]
curr_Stock_Price:  92.53139182671602
curr_Factors:  [9.25313918e+01 4.28620798e-02]
mat_Sqrt:  [[ 1.91569213e+01  0.00000000e+00]
 [-8.28126365e-03  1.89747588e-02]]
grads:  [-4.21537955e-03 -5.36947227e+00]
Stock Position:  -0.0042153795455285165
Bond Position:  [8.90004188]


portfolio before change:  [8.51118059]
curr_Stock_Price:  92.77612440813137
curr_Factors:  [9.27761244e+01 4.37703433e-02]
mat_Sqrt:  [[ 1.94100298e+01  0.00000000e+00]
 [-8.36854523e-03  1.91747460e-02]]
grads:  [ -0.01599729 -13.16462235]
Stock Position:  -0.01599728863408572
Bond Position:  [9.99534703]


portfolio before change:  [8.5316065]
curr_Stock_Price:  91.65551206152774
curr_Factors:  [9.16555121e+01 4.39802775e-02]
mat_Sqrt:  [[ 1.92215130e+01  0.00000000e+00]
 [-8.38859011e-03  1.92206746e-02]]
grads:  [ 1.19247209e-02 -2.39662714e+01]
Stock Position:  0.011924720891864133
Bond Position:  [7.4386401]


portfolio before change:  [8.51760355]
curr_Stock_Price:  90.32526377014902
curr_Factors:  [9.03252638e+01 4.53688434e-02]
mat_Sqrt:  [[ 1.92392480e+01  0.00000000e+00]
 [-8.51998530e-03  1.95217388e-02]]
grads:  [ -0.02446714 -11.32200226]
Stock Position:  -0.02446713506455656
Bond Position:  [10.72760398]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.48077795]
Stock Price:  91.93999465606498
PL:  [8.48077795]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.29684006e-02  2.50744619e-02]
 [-4.06722605e-02  5.82803991e-02]
 [ 7.88792175e-01 -3.04756069e-01]
 [ 3.19689937e-01 -8.10894025e-02]
 [ 2.02897595e-01 -2.92593400e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-2.59829077e-01 -1.66139653e-01]
 [-1.39625357e+00  7.48515137e-01]
 [ 6.16885165e-02 -7.80638023e-02]
 [ 7.03755808e-02  9.73637764e-02]
 [-4.86459919e-02 -1.42242378e-02]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.55853018e-01 -3.01812300e-02]
 [-5.37686381e-02 -5.41326591e-02]
 [ 1.65562930e-02  5.40216622e-03]
 [-1.42756185e-01 -1.36447403e-01]
 [-1.81708603e-01 -4.34658020e-01]
 [ 2.68014020e-01 -2.31491061e-01]
 [ 1.32702408e-01  1.08354597e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.04703035]
curr_Stock_Price:  101.11799644191754
curr_Factors:  [1.01117996e+02 3.86183750e-02]
mat_Sqrt:  [[ 1.98712622e+01  0.00000000e+00]
 [-7.86062339e-03  1.80109508e-02]]
grads:  [1.20333538e-03 1.39217869e+00]
Stock Position:  0.0012033353832686814
Bond Position:  [9.92535149]


portfolio before change:  [10.05054418]
curr_Stock_Price:  101.97576194263964
curr_Factors:  [1.01975762e+02 3.87250876e-02]
mat_Sqrt:  [[ 2.00674950e+01  0.00000000e+00]
 [-7.87147637e-03  1.80358181e-02]]
grads:  [-7.59268111e-04  3.23136986e+00]
Stock Position:  -0.0007592681109935606
Bond Position:  [10.12797112]


portfolio before change:  [10.05308744]
curr_Stock_Price:  101.9613379265414
curr_Factors:  [1.01961338e+02 3.86220720e-02]
mat_Sqrt:  [[ 2.00379510e+01  0.00000000e+00]
 [-7.86099963e-03  1.80118129e-02]]
grads:  [  0.03272718 -16.91978874]
Stock Position:  0.032727184656679904
Bond Position:  [6.7161799]


portfolio before change:  [10.07960412]
curr_Stock_Price:  102.72026144825057
curr_Factors:  [1.02720261e+02 3.67358487e-02]
mat_Sqrt:  [[ 1.96879798e+01  0.00000000e+00]
 [-7.66663928e-03  1.75664774e-02]]
grads:  [ 0.01444026 -4.61614475]
Stock Position:  0.014440263721787992
Bond Position:  [8.59629646]


portfolio before change:  [10.09184523]
curr_Stock_Price:  103.41912457129465
curr_Factors:  [1.03419125e+02 3.79533707e-02]
mat_Sqrt:  [[ 2.01477259e+01  0.00000000e+00]
 [-7.79264995e-03  1.78552041e-02]]
grads:  [ 0.00943669 -1.63870095]
Stock Position:  0.009436686465097393
Bond Position:  [9.11591138]


portfolio before change:  [10.08300614]
curr_Stock_Price:  102.24091891946166
curr_Factors:  [1.02240919e+02 3.75447431e-02]
mat_Sqrt:  [[ 1.98106768e+01  0.00000000e+00]
 [-7.75058636e-03  1.77588243e-02]]
grads:  [-2.92580694e-05 -1.08966538e+00]
Stock Position:  -2.925806941347607e-05
Bond Position:  [10.08599751]


portfolio before change:  [10.08550265]
curr_Stock_Price:  103.10589966276403
curr_Factors:  [1.03105900e+02 3.52109184e-02]
mat_Sqrt:  [[ 1.93473814e+01  0.00000000e+00]
 [-7.50582903e-03  1.71980148e-02]]
grads:  [-0.01717743 -9.66039712]
Stock Position:  -0.017177433978639158
Bond Position:  [11.85659743]


portfolio before change:  [10.09179424]
curr_Stock_Price:  102.91221094320407
curr_Factors:  [1.02912211e+02 3.63586347e-02]
mat_Sqrt:  [[ 1.96232389e+01  0.00000000e+00]
 [-7.62717612e-03  1.74760560e-02]]
grads:  [-0.05450552 42.83089614]
Stock Position:  -0.05450551697659713
Bond Position:  [15.7010775]


portfolio before change:  [10.14032908]
curr_Stock_Price:  102.09377859703233
curr_Factors:  [1.02093779e+02 3.72791019e-02]
mat_Sqrt:  [[ 1.97120594e+01  0.00000000e+00]
 [-7.72311874e-03  1.76958881e-02]]
grads:  [ 1.40110577e-03 -4.41140913e+00]
Stock Position:  0.0014011057659390847
Bond Position:  [9.9972849]


portfolio before change:  [10.1410562]
curr_Stock_Price:  100.8286958039588
curr_Factors:  [1.00828696e+02 3.72378177e-02]
mat_Sqrt:  [[ 1.94570171e+01  0.00000000e+00]
 [-7.71884112e-03  1.76860869e-02]]
grads:  [0.00580092 5.50510564]
Stock Position:  0.005800920873305055
Bond Position:  [9.55615691]


portfolio before change:  [10.13743492]
curr_Stock_Price:  99.79254811137373
curr_Factors:  [9.97925481e+01 3.95906031e-02]
mat_Sqrt:  [[ 1.98561100e+01  0.00000000e+00]
 [-7.95895501e-03  1.82362569e-02]]
grads:  [-0.00276257 -0.77999766]
Stock Position:  -0.0027625732407140628
Bond Position:  [10.41311915]


portfolio before change:  [10.1454195]
curr_Stock_Price:  97.84473576204962
curr_Factors:  [9.78447358e+01 4.13123514e-02]
mat_Sqrt:  [[ 1.98873731e+01  0.00000000e+00]
 [-8.13017603e-03  1.86285735e-02]]
grads:  [ 0.00241442 -0.46119381]
Stock Position:  0.0024144203440862855
Bond Position:  [9.90918118]


portfolio before change:  [10.14623415]
curr_Stock_Price:  97.15597472148632
curr_Factors:  [9.71559747e+01 4.08389227e-02]
mat_Sqrt:  [[ 1.96339035e+01  0.00000000e+00]
 [-8.08345696e-03  1.85215267e-02]]
grads:  [ 0.00726706 -1.62952172]
Stock Position:  0.0072670648342647425
Bond Position:  [9.44019538]


portfolio before change:  [10.15605769]
curr_Stock_Price:  98.18296385520424
curr_Factors:  [9.81829639e+01 4.11287236e-02]
mat_Sqrt:  [[ 1.99117190e+01  0.00000000e+00]
 [-8.11208714e-03  1.85871267e-02]]
grads:  [-0.00388686 -2.91237371]
Stock Position:  -0.0038868601740166585
Bond Position:  [10.53768114]


portfolio before change:  [10.15947684]
curr_Stock_Price:  97.98115643950494
curr_Factors:  [9.79811564e+01 4.20354393e-02]
mat_Sqrt:  [[ 2.00886317e+01  0.00000000e+00]
 [-8.20101840e-03  1.87908938e-02]]
grads:  [0.00094153 0.28748852]
Stock Position:  0.0009415271246591097
Bond Position:  [10.06722492]


portfolio before change:  [10.16254962]
curr_Stock_Price:  98.57133006516557
curr_Factors:  [9.85713301e+01 4.19892964e-02]
mat_Sqrt:  [[ 2.01985370e+01  0.00000000e+00]
 [-8.19651598e-03  1.87805775e-02]]
grads:  [-0.01001591 -7.26534653]
Stock Position:  -0.010015909231484425
Bond Position:  [11.14983112]


portfolio before change:  [10.15214157]
curr_Stock_Price:  99.88882010553293
curr_Factors:  [9.98888201e+01 4.04486945e-02]
mat_Sqrt:  [[ 2.00895005e+01  0.00000000e+00]
 [-8.04474432e-03  1.84328249e-02]]
grads:  [-1.84877128e-02 -2.35806515e+01]
Stock Position:  -0.01848771279658016
Bond Position:  [11.99885739]


portfolio before change:  [10.14075137]
curr_Stock_Price:  100.66719076575842
curr_Factors:  [1.00667191e+02 4.16821653e-02]
mat_Sqrt:  [[ 2.05524256e+01  0.00000000e+00]
 [-8.16648422e-03  1.87117660e-02]]
grads:  [ 8.12473627e-03 -1.23714170e+01]
Stock Position:  0.008124736272478653
Bond Position:  [9.32285699]


portfolio before change:  [10.15531619]
curr_Stock_Price:  102.17294020718381
curr_Factors:  [1.02172940e+02 4.04946469e-02]
mat_Sqrt:  [[ 2.05605487e+01  0.00000000e+00]
 [-8.04931271e-03  1.84432924e-02]]
grads:  [0.00668423 0.58750138]
Stock Position:  0.0066842277555832635
Bond Position:  [9.47236898]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.1507386]
Stock Price:  101.13378183198971
PL:  [9.01695677]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.04855793e-02  1.06720611e-01]
 [ 5.07346667e-02 -4.44233612e-02]
 [ 5.65549262e-01 -2.36621506e-01]
 [-2.85002575e-02 -9.88380987e-02]
 [ 2.31557362e-01 -6.86906006e-03]
 [ 3.00225195e-02 -7.18710972e-02]
 [-8.65373895e-02 -1.62120931e-01]
 [-1.25752539e+00  7.35869266e-01]
 [ 6.60345614e-02 -3.94923486e-02]
 [ 1.73485192e-02 -7.79572522e-02]
 [ 4.74024668e-02  2.48464571e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.64868643e-01 -2.86962466e-02]
 [-5.65673373e-02 -6.05446772e-02]
 [ 4.55452415e-02  2.91960476e-02]
 [-1.43625807e-01 -1.40352445e-01]
 [-1.95408998e-01 -3.21100136e-01]
 [ 2.77916036e-01 -3.11252957e-01]
 [-1.58358041e-01 -1.65618089e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.97532952]
curr_Stock_Price:  98.85526569190175
curr_Factors:  [9.88552657e+01 4.01550121e-02]
mat_Sqrt:  [[ 1.98093255e+01  0.00000000e+00]
 [-8.01548622e-03  1.83657862e-02]]
grads:  [3.89020172e-03 5.81083813e+00]
Stock Position:  0.003890201721607576
Bond Position:  [-5.35989645]


portfolio before change:  [-4.97559894]
curr_Stock_Price:  99.13050113578088
curr_Factors:  [9.91305011e+01 3.85767057e-02]
mat_Sqrt:  [[ 1.94701757e+01  0.00000000e+00]
 [-7.85638143e-03  1.80012313e-02]]
grads:  [ 1.60998662e-03 -2.46779570e+00]
Stock Position:  0.0016099866207756057
Bond Position:  [-5.13519772]


portfolio before change:  [-4.97822146]
curr_Stock_Price:  98.29909141592083
curr_Factors:  [9.82990914e+01 3.81966351e-02]
mat_Sqrt:  [[ 1.92115346e+01  0.00000000e+00]
 [-7.81758378e-03  1.79123347e-02]]
grads:  [  0.02406258 -13.20997567]
Stock Position:  0.024062584292148446
Bond Position:  [-7.34355163]


portfolio before change:  [-4.95154635]
curr_Stock_Price:  99.483969287842
curr_Factors:  [9.94839693e+01 3.82244812e-02]
mat_Sqrt:  [[ 1.94501925e+01  0.00000000e+00]
 [-7.82043285e-03  1.79188628e-02]]
grads:  [-3.68308643e-03 -5.51586895e+00]
Stock Position:  -0.0036830864306486226
Bond Position:  [-4.5851383]


portfolio before change:  [-4.9496174]
curr_Stock_Price:  98.648969591554
curr_Factors:  [9.86489696e+01 3.53850734e-02]
mat_Sqrt:  [[ 1.85567794e+01  0.00000000e+00]
 [-7.52436824e-03  1.72404935e-02]]
grads:  [ 0.01231676 -0.39842595]
Stock Position:  0.012316763271979912
Bond Position:  [-6.16465341]


portfolio before change:  [-4.94551826]
curr_Stock_Price:  99.10692269834257
curr_Factors:  [9.91069227e+01 3.48619515e-02]
mat_Sqrt:  [[ 1.85046058e+01  0.00000000e+00]
 [-7.46854218e-03  1.71125799e-02]]
grads:  [-7.26629299e-05 -4.19989840e+00]
Stock Position:  -7.266292990030425e-05
Bond Position:  [-4.93831686]


portfolio before change:  [-4.94687868]
curr_Stock_Price:  100.8366711722226
curr_Factors:  [1.00836671e+02 3.43296874e-02]
mat_Sqrt:  [[ 1.86832930e+01  0.00000000e+00]
 [-7.41130892e-03  1.69814421e-02]]
grads:  [-8.4188994e-03 -9.5469472e+00]
Stock Position:  -0.008418899404870967
Bond Position:  [-4.09794489]


portfolio before change:  [-4.93418774]
curr_Stock_Price:  99.20753187317707
curr_Factors:  [9.92075319e+01 3.57458712e-02]
mat_Sqrt:  [[ 1.87567499e+01  0.00000000e+00]
 [-7.56263142e-03  1.73281655e-02]]
grads:  [-0.04992153 42.46665738]
Stock Position:  -0.04992153289656761
Bond Position:  [0.01840433]


portfolio before change:  [-4.87301996]
curr_Stock_Price:  97.98234571324977
curr_Factors:  [9.79823457e+01 3.60148806e-02]
mat_Sqrt:  [[ 1.85946848e+01  0.00000000e+00]
 [-7.59103477e-03  1.73932457e-02]]
grads:  [ 0.00262434 -2.27055658]
Stock Position:  0.0026243352800843405
Bond Position:  [-5.13015849]


portfolio before change:  [-4.87794947]
curr_Stock_Price:  96.59273399045058
curr_Factors:  [9.65927340e+01 3.70932049e-02]
mat_Sqrt:  [[ 1.86033706e+01  0.00000000e+00]
 [-7.70383852e-03  1.76517116e-02]]
grads:  [-8.96333003e-04 -4.41641321e+00]
Stock Position:  -0.0008963330026675573
Bond Position:  [-4.79137022]


portfolio before change:  [-4.88035877]
curr_Stock_Price:  97.94413584556978
curr_Factors:  [9.79441358e+01 3.51754606e-02]
mat_Sqrt:  [[ 1.83695423e+01  0.00000000e+00]
 [-7.50204885e-03  1.71893534e-02]]
grads:  [8.48367876e-03 1.44545618e+01]
Stock Position:  0.0084836787606078
Bond Position:  [-5.71128535]


portfolio before change:  [-4.87587459]
curr_Stock_Price:  98.64102417922886
curr_Factors:  [9.86410242e+01 3.43384275e-02]
mat_Sqrt:  [[ 1.82788039e+01  0.00000000e+00]
 [-7.41225229e-03  1.69836036e-02]]
grads:  [ 0.00262689 -0.50586336]
Stock Position:  0.0026268938848979803
Bond Position:  [-5.1349941]


portfolio before change:  [-4.87715677]
curr_Stock_Price:  98.64168431157384
curr_Factors:  [9.86416843e+01 3.26755183e-02]
mat_Sqrt:  [[ 1.78308367e+01  0.00000000e+00]
 [-7.23054834e-03  1.65672675e-02]]
grads:  [ 0.00854388 -1.73210498]
Stock Position:  0.00854388256022761
Bond Position:  [-5.71993973]


portfolio before change:  [-4.88568996]
curr_Stock_Price:  97.81032594376396
curr_Factors:  [9.78103259e+01 3.31137479e-02]
mat_Sqrt:  [[ 1.77987243e+01  0.00000000e+00]
 [-7.27887331e-03  1.66779940e-02]]
grads:  [-0.00466276 -3.6302134 ]
Stock Position:  -0.004662761191201578
Bond Position:  [-4.42962377]


portfolio before change:  [-4.88380269]
curr_Stock_Price:  97.16804196274644
curr_Factors:  [9.71680420e+01 3.36147906e-02]
mat_Sqrt:  [[ 1.78151161e+01  0.00000000e+00]
 [-7.33373472e-03  1.68036972e-02]]
grads:  [0.0032718 1.7374776]
Stock Position:  0.0032717968865805854
Bond Position:  [-5.20171678]


portfolio before change:  [-4.88612146]
curr_Stock_Price:  96.85684330209175
curr_Factors:  [9.68568433e+01 3.23901511e-02]
mat_Sqrt:  [[ 1.74315818e+01  0.00000000e+00]
 [-7.19890560e-03  1.64947649e-02]]
grads:  [-0.01175342 -8.50890845]
Stock Position:  -0.01175341622253695
Bond Position:  [-3.74772266]


portfolio before change:  [-4.87285523]
curr_Stock_Price:  95.64840523289979
curr_Factors:  [9.56484052e+01 3.41265801e-02]
mat_Sqrt:  [[ 1.76694942e+01  0.00000000e+00]
 [-7.38935235e-03  1.69311332e-02]]
grads:  [ -0.01899028 -18.96507051]
Stock Position:  -0.018990276855934074
Bond Position:  [-3.05646553]


portfolio before change:  [-4.87721345]
curr_Stock_Price:  95.8376604319648
curr_Factors:  [9.58376604e+01 3.47262204e-02]
mat_Sqrt:  [[ 1.78593218e+01  0.00000000e+00]
 [-7.45398904e-03  1.70792345e-02]]
grads:  [ 7.95517942e-03 -1.82240578e+01]
Stock Position:  0.007955179419289913
Bond Position:  [-5.63961923]


portfolio before change:  [-4.88400148]
curr_Stock_Price:  95.16162972752795
curr_Factors:  [9.51616297e+01 3.48395300e-02]
mat_Sqrt:  [[ 1.77622515e+01  0.00000000e+00]
 [-7.46614010e-03  1.71070761e-02]]
grads:  [-0.01298482 -9.68126218]
Stock Position:  -0.012984823527882732
Bond Position:  [-3.64834451]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.87750236]
Stock Price:  94.5908623199249
PL:  [-4.87750236]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [-6.22371016e-04  1.36322494e-01]
 [ 3.10559423e-02 -7.39948478e-02]
 [ 5.92171247e-01 -2.44746634e-01]
 [-5.72085397e-02 -9.62872830e-02]
 [-8.71169197e-03 -1.21745272e-02]
 [ 3.81482652e-02 -1.76683462e-02]
 [-7.31116533e-02 -1.42373611e-01]
 [-1.42808638e+00  7.50319109e-01]
 [ 3.97611479e-02 -7.34101701e-02]
 [ 1.44013653e-01  4.99533284e-01]
 [-4.54554063e-01 -8.94918493e-02]
 [-4.10150583e-02 -1.13325342e-01]
 [-7.13797487e-02 -1.15138819e-01]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.14260073e-01 -6.07528863e-02]
 [ 9.55937430e-02  1.57253266e-02]
 [-1.28944374e-01 -6.36657908e-01]
 [-4.11939194e-01  6.90862212e-02]
 [-1.07880335e-03 -7.86100339e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.23140947]
curr_Stock_Price:  99.5698147951598
curr_Factors:  [9.95698148e+01 3.77508519e-02]
mat_Sqrt:  [[ 1.93459953e+01  0.00000000e+00]
 [-7.77183138e-03  1.78075028e-02]]
grads:  [3.04319536e-03 7.65534032e+00]
Stock Position:  0.003043195361875604
Bond Position:  [-0.53441987]


portfolio before change:  [-0.23952108]
curr_Stock_Price:  96.94823230622337
curr_Factors:  [9.69482323e+01 3.95399784e-02]
mat_Sqrt:  [[ 1.92778283e+01  0.00000000e+00]
 [-7.95386481e-03  1.82245938e-02]]
grads:  [-6.42218034e-05 -4.06016445e+00]
Stock Position:  -6.422180339354355e-05
Bond Position:  [-0.23329489]


portfolio before change:  [-0.23966755]
curr_Stock_Price:  98.3205892384017
curr_Factors:  [9.83205892e+01 4.15110781e-02]
mat_Sqrt:  [[ 2.00321000e+01  0.00000000e+00]
 [-8.14970705e-03  1.86733247e-02]]
grads:  [  0.02422887 -13.10675191]
Stock Position:  0.02422886563826886
Bond Position:  [-2.62186389]


portfolio before change:  [-0.21719344]
curr_Stock_Price:  99.2752213115919
curr_Factors:  [9.92752213e+01 4.12792862e-02]
mat_Sqrt:  [[ 2.01700490e+01  0.00000000e+00]
 [-8.12692180e-03  1.86211172e-02]]
grads:  [-4.91975776e-03 -5.17086500e+00]
Stock Position:  -0.0049197577636755545
Bond Position:  [0.2712166]


portfolio before change:  [-0.2240708]
curr_Stock_Price:  100.68691160943203
curr_Factors:  [1.00686912e+02 4.40281970e-02]
mat_Sqrt:  [[ 2.11270310e+01  0.00000000e+00]
 [-8.39315883e-03  1.92311428e-02]]
grads:  [-0.00066385 -0.63306312]
Stock Position:  -0.0006638458212550381
Bond Position:  [-0.15723022]


portfolio before change:  [-0.22422511]
curr_Stock_Price:  100.86013131635661
curr_Factors:  [1.00860131e+02 4.67286876e-02]
mat_Sqrt:  [[ 2.18027523e+01  0.00000000e+00]
 [-8.64672771e-03  1.98121421e-02]]
grads:  [ 0.00139602 -0.89179384]
Stock Position:  0.0013960240556430586
Bond Position:  [-0.36502828]


portfolio before change:  [-0.22543551]
curr_Stock_Price:  100.05847098168796
curr_Factors:  [1.00058471e+02 4.70454530e-02]
mat_Sqrt:  [[ 2.17026461e+01  0.00000000e+00]
 [-8.67598552e-03  1.98791802e-02]]
grads:  [-6.23189406e-03 -7.16194582e+00]
Stock Position:  -0.006231894059259534
Bond Position:  [0.39811828]


portfolio before change:  [-0.24978543]
curr_Stock_Price:  103.98175051923658
curr_Factors:  [1.03981751e+02 4.67724965e-02]
mat_Sqrt:  [[ 2.24880812e+01  0.00000000e+00]
 [-8.65077999e-03  1.98214271e-02]]
grads:  [-0.04894238 37.85393991]
Stock Position:  -0.04894238278071777
Bond Position:  [4.8393292]


portfolio before change:  [-0.23788309]
curr_Stock_Price:  103.76328213485606
curr_Factors:  [1.03763282e+02 4.83803628e-02]
mat_Sqrt:  [[ 2.28232907e+01  0.00000000e+00]
 [-8.79821462e-03  2.01592422e-02]]
grads:  [ 3.38352742e-04 -3.64151436e+00]
Stock Position:  0.0003383527422316246
Bond Position:  [-0.27299168]


portfolio before change:  [-0.23762698]
curr_Stock_Price:  104.72194167436832
curr_Factors:  [1.04721942e+02 4.83067798e-02]
mat_Sqrt:  [[ 2.30166297e+01  0.00000000e+00]
 [-8.79152135e-03  2.01439060e-02]]
grads:  [1.57289689e-02 2.47982334e+01]
Stock Position:  0.01572896890618779
Bond Position:  [-1.88479514]


portfolio before change:  [-0.22449168]
curr_Stock_Price:  105.5870048483875
curr_Factors:  [1.05587005e+02 4.93132340e-02]
mat_Sqrt:  [[ 2.34472661e+01  0.00000000e+00]
 [-8.88263330e-03  2.03526697e-02]]
grads:  [-0.02105199 -4.39705702]
Stock Position:  -0.02105198556722239
Bond Position:  [1.99832442]


portfolio before change:  [-0.28563102]
curr_Stock_Price:  108.5149462417806
curr_Factors:  [1.08514946e+02 4.84435023e-02]
mat_Sqrt:  [[ 2.38840145e+01  0.00000000e+00]
 [-8.80395387e-03  2.01723925e-02]]
grads:  [-3.78806888e-03 -5.61784338e+00]
Stock Position:  -0.0037880688837731145
Bond Position:  [0.12543107]


portfolio before change:  [-0.28612027]
curr_Stock_Price:  108.65237999483949
curr_Factors:  [1.08652380e+02 4.71358819e-02]
mat_Sqrt:  [[ 2.35893005e+01  0.00000000e+00]
 [-8.68431984e-03  1.98982765e-02]]
grads:  [-5.15617023e-03 -5.78637143e+00]
Stock Position:  -0.0051561702336994
Bond Position:  [0.2741099]


portfolio before change:  [-0.28613582]
curr_Stock_Price:  108.66868893288004
curr_Factors:  [1.08668689e+02 4.83342952e-02]
mat_Sqrt:  [[ 2.38908787e+01  0.00000000e+00]
 [-8.79402481e-03  2.01496422e-02]]
grads:  [6.37218681e-03 7.37373340e+00]
Stock Position:  0.0063721868070398145
Bond Position:  [-0.97859301]


portfolio before change:  [-0.28895575]
curr_Stock_Price:  108.26455049021392
curr_Factors:  [1.08264550e+02 4.98634669e-02]
mat_Sqrt:  [[ 2.41756140e+01  0.00000000e+00]
 [-8.93205167e-03  2.04659014e-02]]
grads:  [-0.00582301 -2.96849306]
Stock Position:  -0.0058230085156296815
Bond Position:  [0.34146965]


portfolio before change:  [-0.29798216]
curr_Stock_Price:  109.82934108634005
curr_Factors:  [1.09829341e+02 4.87147561e-02]
mat_Sqrt:  [[ 2.42408947e+01  0.00000000e+00]
 [-8.82856782e-03  2.02287902e-02]]
grads:  [0.00422661 0.77737356]
Stock Position:  0.004226611252099998
Bond Position:  [-0.76218809]


portfolio before change:  [-0.30917767]
curr_Stock_Price:  107.225614904716
curr_Factors:  [1.07225615e+02 5.02679963e-02]
mat_Sqrt:  [[ 2.40405463e+01  0.00000000e+00]
 [-8.96821019e-03  2.05487510e-02]]
grads:  [-1.69216065e-02 -3.09828032e+01]
Stock Position:  -0.016921606501345055
Bond Position:  [1.505252]


portfolio before change:  [-0.33092675]
curr_Stock_Price:  108.5331411039754
curr_Factors:  [1.08533141e+02 4.78842694e-02]
mat_Sqrt:  [[ 2.37497370e+01  0.00000000e+00]
 [-8.75298983e-03  2.00556192e-02]]
grads:  [-0.01607544  3.44473139]
Stock Position:  -0.01607544096645041
Bond Position:  [1.41379135]


portfolio before change:  [-0.33507443]
curr_Stock_Price:  108.81314404576436
curr_Factors:  [1.08813144e+02 4.87903613e-02]
mat_Sqrt:  [[ 2.40352352e+01  0.00000000e+00]
 [-8.83541613e-03  2.02444816e-02]]
grads:  [-1.47229826e-03 -3.88303516e+00]
Stock Position:  -0.001472298255908356
Bond Position:  [-0.17486903]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.33829673]
Stock Price:  110.97206852357913
PL:  [-11.31036526]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 5.53247273e-04  9.80791916e-03]
 [-2.72843564e-02  5.00439990e-02]
 [ 8.84452761e-01 -3.33952034e-01]
 [ 3.34195605e-01 -7.65656883e-02]
 [ 2.61290111e-01 -3.14646261e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-2.51808694e-01 -1.67154026e-01]
 [-1.29473518e+00  7.38827054e-01]
 [ 8.20396540e-02 -6.23310344e-02]
 [ 1.89260035e-02 -9.00500656e-02]
 [-2.87087178e-02  4.03418999e-02]
 [ 2.41266486e-02 -9.01763665e-03]
 [ 1.55319432e-01 -2.31661031e-02]
 [ 7.26864244e-02  1.15602203e-01]
 [-1.16247393e-01 -6.18807972e-02]
 [-1.40261220e-01 -1.25243763e-01]
 [-1.79432781e-01 -4.47037133e-01]
 [ 2.85873350e-01 -2.55212482e-01]
 [ 1.10852440e-02 -1.22135638e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.58419646]
curr_Stock_Price:  102.70514852580152
curr_Factors:  [1.02705149e+02 3.81809176e-02]
mat_Sqrt:  [[ 2.00685223e+01  0.00000000e+00]
 [-7.81597519e-03  1.79086490e-02]]
grads:  [2.40863480e-04 5.47663823e-01]
Stock Position:  0.00024086348013404945
Bond Position:  [20.55945854]


portfolio before change:  [20.58914342]
curr_Stock_Price:  101.90160368643383
curr_Factors:  [1.01901604e+02 3.85716720e-02]
mat_Sqrt:  [[ 2.00131408e+01  0.00000000e+00]
 [-7.85586884e-03  1.80000568e-02]]
grads:  [-2.71989522e-04  2.78021339e+00]
Stock Position:  -0.0002719895215363036
Bond Position:  [20.61685959]


portfolio before change:  [20.59390099]
curr_Stock_Price:  103.36226977091316
curr_Factors:  [1.03362270e+02 3.91108924e-02]
mat_Sqrt:  [[ 2.04414124e+01  0.00000000e+00]
 [-7.91058960e-03  1.81254378e-02]]
grads:  [  0.03613763 -18.42449476]
Stock Position:  0.03613762735140919
Bond Position:  [16.85863381]


portfolio before change:  [20.5817386]
curr_Stock_Price:  102.90906957090895
curr_Factors:  [1.02909070e+02 3.80199261e-02]
mat_Sqrt:  [[ 2.00659297e+01  0.00000000e+00]
 [-7.79947959e-03  1.78708528e-02]]
grads:  [ 0.01498957 -4.28438918]
Stock Position:  0.014989567109410655
Bond Position:  [19.03917619]


portfolio before change:  [20.60952558]
curr_Stock_Price:  104.44524399080993
curr_Factors:  [1.04445244e+02 3.96829207e-02]
mat_Sqrt:  [[ 2.08060905e+01  0.00000000e+00]
 [-7.96822898e-03  1.82575062e-02]]
grads:  [ 0.01189833 -1.72338028]
Stock Position:  0.011898334392374763
Bond Position:  [19.36680114]


portfolio before change:  [20.60500395]
curr_Stock_Price:  103.65824900393592
curr_Factors:  [1.03658249e+02 4.12880229e-02]
mat_Sqrt:  [[ 2.10627907e+01  0.00000000e+00]
 [-8.12778178e-03  1.86230876e-02]]
grads:  [-2.75187730e-05 -1.03909601e+00]
Stock Position:  -2.7518773044181287e-05
Bond Position:  [20.6078565]


portfolio before change:  [20.61017378]
curr_Stock_Price:  103.03242822576462
curr_Factors:  [1.03032428e+02 3.98181087e-02]
mat_Sqrt:  [[ 2.05595805e+01  0.00000000e+00]
 [-7.98179015e-03  1.82885788e-02]]
grads:  [-0.01579608 -9.13980405]
Stock Position:  -0.015796075779924916
Bond Position:  [22.23768183]


portfolio before change:  [20.65908533]
curr_Stock_Price:  100.28798539260525
curr_Factors:  [1.00287985e+02 3.99726393e-02]
mat_Sqrt:  [[ 2.00507360e+01  0.00000000e+00]
 [-7.99726346e-03  1.83240326e-02]]
grads:  [-0.04849122 40.32011243]
Stock Position:  -0.048491218276369506
Bond Position:  [25.52217192]


portfolio before change:  [20.71490352]
curr_Stock_Price:  99.26848420345017
curr_Factors:  [9.92684842e+01 3.97512269e-02]
mat_Sqrt:  [[ 1.97918622e+01  0.00000000e+00]
 [-7.97508389e-03  1.82732128e-02]]
grads:  [ 2.77064178e-03 -3.41106050e+00]
Stock Position:  0.002770641778828972
Bond Position:  [20.43986611]


portfolio before change:  [20.71967093]
curr_Stock_Price:  99.1446160218516
curr_Factors:  [9.91446160e+01 4.05291104e-02]
mat_Sqrt:  [[ 1.99596385e+01  0.00000000e+00]
 [-8.05273722e-03  1.84511389e-02]]
grads:  [-1.02081344e-03 -4.88046109e+00]
Stock Position:  -0.0010208134392335538
Bond Position:  [20.82087909]


portfolio before change:  [20.72460686]
curr_Stock_Price:  99.40905653060777
curr_Factors:  [9.94090565e+01 3.86963778e-02]
mat_Sqrt:  [[ 1.95551481e+01  0.00000000e+00]
 [-7.86855797e-03  1.80291312e-02]]
grads:  [-5.67731280e-04  2.23759533e+00]
Stock Position:  -0.0005677312802883868
Bond Position:  [20.78104449]


portfolio before change:  [20.72927093]
curr_Stock_Price:  100.34583735423936
curr_Factors:  [1.00345837e+02 3.68763154e-02]
mat_Sqrt:  [[ 1.92696187e+01  0.00000000e+00]
 [-7.68128275e-03  1.76000298e-02]]
grads:  [ 0.00104782 -0.51236485]
Stock Position:  0.00104781675236503
Bond Position:  [20.62412688]


portfolio before change:  [20.73409706]
curr_Stock_Price:  100.03037303907257
curr_Factors:  [1.00030373e+02 3.57607722e-02]
mat_Sqrt:  [[ 1.89162625e+01  0.00000000e+00]
 [-7.56420753e-03  1.73317768e-02]]
grads:  [ 0.00767641 -1.33662598]
Stock Position:  0.007676406215920607
Bond Position:  [19.96622328]


portfolio before change:  [20.74466656]
curr_Stock_Price:  100.75692747969799
curr_Factors:  [1.00756927e+02 3.57351298e-02]
mat_Sqrt:  [[ 1.90468253e+01  0.00000000e+00]
 [-7.56149507e-03  1.73255618e-02]]
grads:  [6.46508593e-03 6.67234946e+00]
Stock Position:  0.006465085928616079
Bond Position:  [20.09326437]


portfolio before change:  [20.76859674]
curr_Stock_Price:  103.68128613606555
curr_Factors:  [1.03681286e+02 3.26630120e-02]
mat_Sqrt:  [[ 1.87382268e+01  0.00000000e+00]
 [-7.22916449e-03  1.65640967e-02]]
grads:  [-0.00764503 -3.73583891]
Stock Position:  -0.007645034335282783
Bond Position:  [21.56124373]


portfolio before change:  [20.78570276]
curr_Stock_Price:  102.14891402806325
curr_Factors:  [1.02148914e+02 3.34110915e-02]
mat_Sqrt:  [[ 1.86714947e+01  0.00000000e+00]
 [-7.31148045e-03  1.67527063e-02]]
grads:  [-0.01043955 -7.47603169]
Stock Position:  -0.01043955414299986
Bond Position:  [21.85209188]


portfolio before change:  [20.81174375]
curr_Stock_Price:  100.17782521893618
curr_Factors:  [1.00177825e+02 3.41270069e-02]
mat_Sqrt:  [[ 1.85063469e+01  0.00000000e+00]
 [-7.38939856e-03  1.69312391e-02]]
grads:  [-2.02382341e-02 -2.64030960e+01]
Stock Position:  -0.020238234076014053
Bond Position:  [22.83916603]


portfolio before change:  [20.84830914]
curr_Stock_Price:  98.6532417114184
curr_Factors:  [9.86532417e+01 3.45532940e-02]
mat_Sqrt:  [[ 1.83381740e+01  0.00000000e+00]
 [-7.43540654e-03  1.70366566e-02]]
grads:  [ 9.51509630e-03 -1.49801976e+01]
Stock Position:  0.009515096304231715
Bond Position:  [19.90961404]


portfolio before change:  [20.85621778]
curr_Stock_Price:  98.96123784791746
curr_Factors:  [9.89612378e+01 3.31738195e-02]
mat_Sqrt:  [[ 1.80244847e+01  0.00000000e+00]
 [-7.28547262e-03  1.66931149e-02]]
grads:  [-2.34232041e-03 -7.31652772e+00]
Stock Position:  -0.0023423204099994673
Bond Position:  [21.0880167]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.8601189]
Stock Price:  99.54678659983327
PL:  [20.8601189]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.06201776e-01 -2.78185594e-02]
 [ 2.05262598e-02 -7.99059117e-02]
 [ 4.34135296e-01 -1.96513477e-01]
 [-7.80973609e-02 -9.38536736e-02]
 [ 2.69845073e-01 -8.40557023e-03]
 [-2.16611740e-01 -2.74355740e-01]
 [-1.92085481e-02 -5.07009393e-02]
 [-1.30275741e+00  6.53519965e-01]
 [ 2.39003424e-02  2.07069449e-02]
 [ 2.36202856e-02 -4.77329531e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 1.13959358e-01 -1.42563870e-01]
 [ 9.07086936e-02 -2.12526648e-03]
 [-9.35627205e-02 -1.41878574e-01]
 [ 8.38298451e-02  1.01192507e-01]
 [-1.43281517e-01 -1.38806406e-01]
 [-1.93156857e-01 -3.52521307e-01]
 [ 2.89958475e-01 -2.62440265e-01]
 [-6.01563824e-02 -1.40418835e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.40269911]
curr_Stock_Price:  97.43527580754996
curr_Factors:  [9.74352758e+01 3.95289106e-02]
mat_Sqrt:  [[ 1.93719635e+01  0.00000000e+00]
 [-7.95275153e-03  1.82220429e-02]]
grads:  [ 0.00485551 -1.52664328]
Stock Position:  0.004855509942093344
Bond Position:  [-14.87579706]


portfolio before change:  [-14.41137138]
curr_Stock_Price:  96.41522689038909
curr_Factors:  [9.64152269e+01 3.84923541e-02]
mat_Sqrt:  [[ 1.89161550e+01  0.00000000e+00]
 [-7.84778737e-03  1.79815398e-02]]
grads:  [-7.58480737e-04 -4.44377470e+00]
Stock Position:  -0.0007584807366429451
Bond Position:  [-14.33824229]


portfolio before change:  [-14.41481966]
curr_Stock_Price:  96.23495623937437
curr_Factors:  [9.62349562e+01 3.82110293e-02]
mat_Sqrt:  [[ 1.88116644e+01  0.00000000e+00]
 [-7.81905665e-03  1.79157095e-02]]
grads:  [  0.01851882 -10.96878007]
Stock Position:  0.01851881769667797
Bond Position:  [-16.19697727]


portfolio before change:  [-14.36529023]
curr_Stock_Price:  99.12818495721123
curr_Factors:  [9.91281850e+01 3.75063126e-02]
mat_Sqrt:  [[ 1.91977061e+01  0.00000000e+00]
 [-7.74661862e-03  1.77497331e-02]]
grads:  [-0.0062017  -5.28761041]
Stock Position:  -0.006201702518275848
Bond Position:  [-13.75052672]


portfolio before change:  [-14.36185]
curr_Stock_Price:  98.01908817610125
curr_Factors:  [9.80190882e+01 3.95397134e-02]
mat_Sqrt:  [[ 1.94906991e+01  0.00000000e+00]
 [-7.95383816e-03  1.82245327e-02]]
grads:  [ 0.01365659 -0.46122281]
Stock Position:  0.013656594902888314
Bond Position:  [-15.70045698]


portfolio before change:  [-14.39250954]
curr_Stock_Price:  96.06150453852163
curr_Factors:  [9.60615045e+01 4.00260772e-02]
mat_Sqrt:  [[ 1.92185624e+01  0.00000000e+00]
 [-8.00260729e-03  1.83362768e-02]]
grads:  [ -0.01750133 -14.96245624]
Stock Position:  -0.017501329936354653
Bond Position:  [-12.71130545]


portfolio before change:  [-14.40491931]
curr_Stock_Price:  96.58898149835329
curr_Factors:  [9.65889815e+01 3.93906948e-02]
mat_Sqrt:  [[ 1.91701013e+01  0.00000000e+00]
 [-7.93883566e-03  1.81901577e-02]]
grads:  [-2.15628763e-03 -2.78727322e+00]
Stock Position:  -0.00215628762559116
Bond Position:  [-14.19664568]


portfolio before change:  [-14.4068078]
curr_Stock_Price:  95.81862315366234
curr_Factors:  [9.58186232e+01 4.17327163e-02]
mat_Sqrt:  [[ 1.95743907e+01  0.00000000e+00]
 [-8.17143477e-03  1.87231092e-02]]
grads:  [-0.05198312 34.90445731]
Stock Position:  -0.051983120603383476
Bond Position:  [-9.42585675]


portfolio before change:  [-14.34527746]
curr_Stock_Price:  94.58962612113201
curr_Factors:  [9.45896261e+01 4.36161137e-02]
mat_Sqrt:  [[ 1.97545432e+01  0.00000000e+00]
 [-8.35378848e-03  1.91409340e-02]]
grads:  [0.00166734 1.08181476]
Stock Position:  0.0016673427322386359
Bond Position:  [-14.50299078]


portfolio before change:  [-14.35082689]
curr_Stock_Price:  93.43615354989785
curr_Factors:  [9.34361535e+01 4.32359764e-02]
mat_Sqrt:  [[ 1.94284247e+01  0.00000000e+00]
 [-8.31730499e-03  1.90573398e-02]]
grads:  [ 1.43496811e-04 -2.50470178e+00]
Stock Position:  0.000143496810951613
Bond Position:  [-14.36423468]


portfolio before change:  [-14.35451545]
curr_Stock_Price:  92.7598546875042
curr_Factors:  [9.27598547e+01 4.32906277e-02]
mat_Sqrt:  [[ 1.92999863e+01  0.00000000e+00]
 [-8.32255996e-03  1.90693805e-02]]
grads:  [1.39846939e-02 1.83314187e+01]
Stock Position:  0.01398469391083516
Bond Position:  [-15.65173362]


portfolio before change:  [-14.35655797]
curr_Stock_Price:  92.89363679516588
curr_Factors:  [9.28936368e+01 4.57532283e-02]
mat_Sqrt:  [[ 1.98699529e+01  0.00000000e+00]
 [-8.55600171e-03  1.96042627e-02]]
grads:  [ 2.60390070e-03 -7.27208524e+00]
Stock Position:  0.0026039007015039
Bond Position:  [-14.59844377]


portfolio before change:  [-14.35857685]
curr_Stock_Price:  93.52007514501966
curr_Factors:  [9.35200751e+01 4.64328645e-02]
mat_Sqrt:  [[ 2.01519736e+01  0.00000000e+00]
 [-8.61931454e-03  1.97493307e-02]]
grads:  [ 0.0044552  -0.10761208]
Stock Position:  0.004455203897315988
Bond Position:  [-14.77522785]


portfolio before change:  [-14.36128182]
curr_Stock_Price:  93.74213045835018
curr_Factors:  [9.37421305e+01 4.76414128e-02]
mat_Sqrt:  [[ 2.04610132e+01  0.00000000e+00]
 [-8.73076517e-03  2.00046961e-02]]
grads:  [-0.00759902 -7.09226341]
Stock Position:  -0.007599017965943683
Bond Position:  [-13.64893368]


portfolio before change:  [-14.37667135]
curr_Stock_Price:  95.31823841288538
curr_Factors:  [9.53182384e+01 4.80103710e-02]
mat_Sqrt:  [[ 2.08854356e+01  0.00000000e+00]
 [-8.76450761e-03  2.00820098e-02]]
grads:  [0.00612838 5.03896314]
Stock Position:  0.006128379510429468
Bond Position:  [-14.96081769]


portfolio before change:  [-14.36380953]
curr_Stock_Price:  98.02735512027982
curr_Factors:  [9.80273551e+01 4.76218519e-02]
mat_Sqrt:  [[ 2.13919525e+01  0.00000000e+00]
 [-8.72897262e-03  2.00005889e-02]]
grads:  [-0.00952983 -6.94011596]
Stock Position:  -0.009529826649919484
Bond Position:  [-13.42962583]


portfolio before change:  [-14.3586862]
curr_Stock_Price:  97.13739637044412
curr_Factors:  [9.71373964e+01 4.71555914e-02]
mat_Sqrt:  [[ 2.10937142e+01  0.00000000e+00]
 [-8.68613528e-03  1.99024362e-02]]
grads:  [-1.64508614e-02 -1.77124701e+01]
Stock Position:  -0.01645086144640859
Bond Position:  [-12.76069235]


portfolio before change:  [-14.37125908]
curr_Stock_Price:  97.70771986396787
curr_Factors:  [9.77077199e+01 4.54118701e-02]
mat_Sqrt:  [[ 2.08215747e+01  0.00000000e+00]
 [-8.52402441e-03  1.95309935e-02]]
grads:  [ 8.42492251e-03 -1.34371180e+01]
Stock Position:  0.008424922505570052
Bond Position:  [-15.19443905]


portfolio before change:  [-14.37789758]
curr_Stock_Price:  97.3706951571204
curr_Factors:  [9.73706952e+01 4.52338705e-02]
mat_Sqrt:  [[ 2.07090485e+01  0.00000000e+00]
 [-8.50730232e-03  1.94926784e-02]]
grads:  [-5.86411231e-03 -7.20367065e+00]
Stock Position:  -0.005864112312040642
Bond Position:  [-13.80690488]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.3760012]
Stock Price:  96.45861568419296
PL:  [-14.3760012]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.14284520e-01 -4.11670996e-02]
 [ 2.83579113e-02 -7.80492156e-02]
 [ 4.37802017e-01 -1.97632574e-01]
 [-8.05102494e-02 -7.86956099e-02]
 [ 3.09958398e-01 -1.13410172e-02]
 [-2.38431637e-01 -2.88852859e-01]
 [-1.92483419e-02 -6.50068249e-02]
 [-1.25721784e+00  7.16721409e-01]
 [ 7.58444564e-02 -5.34660965e-02]
 [ 1.53224052e-02 -8.77213077e-02]
 [ 3.36212142e-02  2.13573816e-01]
 [ 2.35674485e-02 -9.02626061e-03]
 [ 6.47644200e-02 -2.85211744e-02]
 [ 4.44994285e-02  6.90072434e-02]
 [-1.16568353e-01 -6.20629590e-02]
 [-1.22231360e-01 -1.16351141e-01]
 [-1.41849710e-01 -5.98781121e-01]
 [-9.92348670e-02 -1.37138208e-01]
 [ 1.59900598e-01  6.63065052e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.41862729]
curr_Stock_Price:  97.28225245097856
curr_Factors:  [9.72822525e+01 4.23507191e-02]
mat_Sqrt:  [[ 2.00199972e+01  0.00000000e+00]
 [-8.23171613e-03  1.88612311e-02]]
grads:  [ 0.00481108 -2.18263057]
Stock Position:  0.004811075856075341
Bond Position:  [-15.88665958]


portfolio before change:  [-15.4253057]
curr_Stock_Price:  96.71974719797971
curr_Factors:  [9.67197472e+01 4.39870137e-02]
mat_Sqrt:  [[ 2.02851112e+01  0.00000000e+00]
 [-8.38923250e-03  1.92221465e-02]]
grads:  [-2.81268317e-04 -4.06037982e+00]
Stock Position:  -0.00028126831735348197
Bond Position:  [-15.3981015]


portfolio before change:  [-15.42890337]
curr_Stock_Price:  95.822594293127
curr_Factors:  [9.58225943e+01 4.21410048e-02]
mat_Sqrt:  [[ 1.96707250e+01  0.00000000e+00]
 [-8.21130974e-03  1.88144742e-02]]
grads:  [  0.01787164 -10.50428366]
Stock Position:  0.017871638674170378
Bond Position:  [-17.14141015]


portfolio before change:  [-15.43558137]
curr_Stock_Price:  95.68874487477925
curr_Factors:  [9.56887449e+01 4.27276985e-02]
mat_Sqrt:  [[ 1.97795136e+01  0.00000000e+00]
 [-8.26827174e-03  1.89449906e-02]]
grads:  [-0.00580681 -4.15390072]
Stock Position:  -0.0058068075637797935
Bond Position:  [-14.87993524]


portfolio before change:  [-15.44634952]
curr_Stock_Price:  96.90244173238575
curr_Factors:  [9.69024417e+01 4.34540537e-02]
mat_Sqrt:  [[ 2.01999302e+01  0.00000000e+00]
 [-8.33825437e-03  1.91053409e-02]]
grads:  [ 0.0150995  -0.59360454]
Stock Position:  0.015099496334841726
Bond Position:  [-16.90952758]


portfolio before change:  [-15.46576812]
curr_Stock_Price:  95.89640182582458
curr_Factors:  [9.58964018e+01 4.38623671e-02]
mat_Sqrt:  [[ 2.00839136e+01  0.00000000e+00]
 [-8.37733773e-03  1.91948921e-02]]
grads:  [ -0.01814872 -15.04842314]
Stock Position:  -0.018148721733688693
Bond Position:  [-13.72537101]


portfolio before change:  [-15.49750825]
curr_Stock_Price:  97.45620053305029
curr_Factors:  [9.74562005e+01 4.45660309e-02]
mat_Sqrt:  [[ 2.05736551e+01  0.00000000e+00]
 [-8.44426725e-03  1.93482469e-02]]
grads:  [-2.31459340e-03 -3.35983023e+00]
Stock Position:  -0.002314593401859504
Bond Position:  [-15.27193677]


portfolio before change:  [-15.50349426]
curr_Stock_Price:  98.39267175645811
curr_Factors:  [9.83926718e+01 4.47248632e-02]
mat_Sqrt:  [[ 2.08083318e+01  0.00000000e+00]
 [-8.45930145e-03  1.93826946e-02]]
grads:  [-0.04538639 36.97738749]
Stock Position:  -0.04538638587058584
Bond Position:  [-11.03780649]


portfolio before change:  [-15.52330682]
curr_Stock_Price:  98.76839591359014
curr_Factors:  [9.87683959e+01 4.40058364e-02]
mat_Sqrt:  [[ 2.07192075e+01  0.00000000e+00]
 [-8.39102725e-03  1.92262588e-02]]
grads:  [ 2.53436039e-03 -2.78088926e+00]
Stock Position:  0.0025343603906560386
Bond Position:  [-15.77362153]


portfolio before change:  [-15.53031411]
curr_Stock_Price:  97.55965087703488
curr_Factors:  [9.75596509e+01 4.72413672e-02]
mat_Sqrt:  [[ 2.12046675e+01  0.00000000e+00]
 [-8.69403172e-03  1.99205292e-02]]
grads:  [-1.08288952e-03 -4.40356311e+00]
Stock Position:  -0.001082889521669777
Bond Position:  [-15.42466779]


portfolio before change:  [-15.53486203]
curr_Stock_Price:  98.19800422587144
curr_Factors:  [9.81980042e+01 4.47171550e-02]
mat_Sqrt:  [[ 2.07653733e+01  0.00000000e+00]
 [-8.45857245e-03  1.93810243e-02]]
grads:  [6.10788292e-03 1.10197383e+01]
Stock Position:  0.006107882921233773
Bond Position:  [-16.13464394]


portfolio before change:  [-15.52526679]
curr_Stock_Price:  100.4294496000406
curr_Factors:  [1.00429450e+02 4.17649802e-02]
mat_Sqrt:  [[ 2.05242465e+01  0.00000000e+00]
 [-8.17459285e-03  1.87303453e-02]]
grads:  [ 0.00095634 -0.48190573]
Stock Position:  0.0009563354913135303
Bond Position:  [-15.62131103]


portfolio before change:  [-15.52732742]
curr_Stock_Price:  102.35888044890415
curr_Factors:  [1.02358880e+02 4.20839822e-02]
mat_Sqrt:  [[ 2.09982906e+01  0.00000000e+00]
 [-8.20575235e-03  1.88017406e-02]]
grads:  [ 0.00249148 -1.5169433 ]
Stock Position:  0.002491477045101389
Bond Position:  [-15.78235222]


portfolio before change:  [-15.53674446]
curr_Stock_Price:  100.1630114461533
curr_Factors:  [1.00163011e+02 4.21822539e-02]
mat_Sqrt:  [[ 2.05717986e+01  0.00000000e+00]
 [-8.21532752e-03  1.88236801e-02]]
grads:  [3.62713344e-03 3.66598045e+00]
Stock Position:  0.0036271334387789934
Bond Position:  [-15.90004907]


portfolio before change:  [-15.53071487]
curr_Stock_Price:  102.92141464123428
curr_Factors:  [1.02921415e+02 4.33790252e-02]
mat_Sqrt:  [[ 2.14360934e+01  0.00000000e+00]
 [-8.33105278e-03  1.90888400e-02]]
grads:  [-0.00670154 -3.25126928]
Stock Position:  -0.006701540524805586
Bond Position:  [-14.84098284]


portfolio before change:  [-15.53603053]
curr_Stock_Price:  103.16090444218223
curr_Factors:  [1.03160904e+02 4.05145907e-02]
mat_Sqrt:  [[ 2.07644709e+01  0.00000000e+00]
 [-8.05129463e-03  1.84478335e-02]]
grads:  [-0.00833208 -6.30703548]
Stock Position:  -0.008332076559571534
Bond Position:  [-14.67648598]


portfolio before change:  [-15.55741597]
curr_Stock_Price:  105.28712881773546
curr_Factors:  [1.05287129e+02 3.90031889e-02]
mat_Sqrt:  [[ 2.07933920e+01  0.00000000e+00]
 [-7.89969001e-03  1.81004637e-02]]
grads:  [-1.93897762e-02 -3.30809824e+01]
Stock Position:  -0.019389776160159737
Bond Position:  [-13.51592211]


portfolio before change:  [-15.5235092]
curr_Stock_Price:  103.36414758247788
curr_Factors:  [1.03364148e+02 3.83340918e-02]
mat_Sqrt:  [[ 2.02377635e+01  0.00000000e+00]
 [-7.83163756e-03  1.79445360e-02]]
grads:  [-0.00786089 -7.64233795]
Stock Position:  -0.007860892727108272
Bond Position:  [-14.71097473]


portfolio before change:  [-15.53325062]
curr_Stock_Price:  104.13546076922253
curr_Factors:  [1.04135461e+02 3.80142526e-02]
mat_Sqrt:  [[ 2.03035449e+01  0.00000000e+00]
 [-7.79889762e-03  1.78695193e-02]]
grads:  [0.0093008  3.71059254]
Stock Position:  0.009300796002490222
Bond Position:  [-16.50179329]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.56448827]
Stock Price:  101.22047518984509
PL:  [-16.78496346]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.15267705e-02  6.90679297e-02]
 [ 5.46044696e-02 -3.86081559e-02]
 [ 6.26751447e-01 -2.55300639e-01]
 [-1.26269910e-01 -1.45613469e-01]
 [ 1.42235266e-01 -5.77174251e-03]
 [ 2.36010699e-02 -8.20179574e-02]
 [-3.57054437e-02 -8.86428045e-02]
 [-1.29925816e+00  7.39439858e-01]
 [ 8.32000763e-02 -7.49064977e-02]
 [ 2.96261417e-02 -6.51233067e-02]
 [-3.54150996e-02  2.19234081e-02]
 [ 2.49814151e-02 -9.00445448e-03]
 [ 1.64610563e-01 -2.86467155e-02]
 [ 3.78405898e-02  6.07689927e-02]
 [-1.17646771e-01 -6.26750190e-02]
 [-1.41606748e-01 -1.31285856e-01]
 [-1.65472788e-01 -5.15906146e-01]
 [ 2.59352184e-01 -2.30452132e-01]
 [ 1.05145457e-01 -5.53307810e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.63204774]
curr_Stock_Price:  100.45299327376294
curr_Factors:  [1.00452993e+02 3.77361179e-02]
mat_Sqrt:  [[ 1.95137840e+01  0.00000000e+00]
 [-7.77031458e-03  1.78040274e-02]]
grads:  [2.64789681e-03 3.87934304e+00]
Stock Position:  0.0026478968083714373
Bond Position:  [5.36605858]


portfolio before change:  [5.63109306]
curr_Stock_Price:  99.58575163070283
curr_Factors:  [9.95857516e+01 3.85040982e-02]
mat_Sqrt:  [[ 1.95411754e+01  0.00000000e+00]
 [-7.84898446e-03  1.79842827e-02]]
grads:  [ 1.93204800e-03 -2.14677207e+00]
Stock Position:  0.001932047999805538
Bond Position:  [5.43868861]


portfolio before change:  [5.63150437]
curr_Stock_Price:  99.09480685747208
curr_Factors:  [9.90948069e+01 3.95748491e-02]
mat_Sqrt:  [[ 1.97133544e+01  0.00000000e+00]
 [-7.95737134e-03  1.82326282e-02]]
grads:  [  0.02614112 -14.0024047 ]
Stock Position:  0.026141117494968173
Bond Position:  [3.04105538]


portfolio before change:  [5.60711201]
curr_Stock_Price:  98.13261679044695
curr_Factors:  [9.81326168e+01 3.95061573e-02]
mat_Sqrt:  [[ 1.95049919e+01  0.00000000e+00]
 [-7.95046236e-03  1.82167978e-02]]
grads:  [-0.00973191 -7.99336256]
Stock Position:  -0.009731910645866426
Bond Position:  [6.56212986]


portfolio before change:  [5.59451481]
curr_Stock_Price:  99.59563171066316
curr_Factors:  [9.95956317e+01 3.84818767e-02]
mat_Sqrt:  [[ 1.95374740e+01  0.00000000e+00]
 [-7.84671923e-03  1.79790924e-02]]
grads:  [ 0.00715119 -0.32102524]
Stock Position:  0.0071511942041583365
Bond Position:  [4.88228711]


portfolio before change:  [5.5899245]
curr_Stock_Price:  98.78303467516655
curr_Factors:  [9.87830347e+01 3.77344168e-02]
mat_Sqrt:  [[ 1.91889488e+01  0.00000000e+00]
 [-7.77013944e-03  1.78036261e-02]]
grads:  [-6.35496060e-04 -4.60681195e+00]
Stock Position:  -0.000635496059806122
Bond Position:  [5.65270073]


portfolio before change:  [5.59166913]
curr_Stock_Price:  98.26173876732602
curr_Factors:  [9.82617388e+01 3.99272980e-02]
mat_Sqrt:  [[ 1.96344801e+01  0.00000000e+00]
 [-7.99272649e-03  1.83136371e-02]]
grads:  [-3.78886199e-03 -4.84026216e+00]
Stock Position:  -0.0037888619929458507
Bond Position:  [5.9639693]


portfolio before change:  [5.58517738]
curr_Stock_Price:  100.36868552401843
curr_Factors:  [1.00368686e+02 3.81161974e-02]
mat_Sqrt:  [[ 1.95953498e+01  0.00000000e+00]
 [-7.80934798e-03  1.78934641e-02]]
grads:  [-0.0498353  41.32457825]
Stock Position:  -0.049835300475305336
Bond Position:  [10.58708098]


portfolio before change:  [5.58841778]
curr_Stock_Price:  100.35678041889538
curr_Factors:  [1.00356780e+02 3.82936464e-02]
mat_Sqrt:  [[ 1.96385800e+01  0.00000000e+00]
 [-7.82750498e-03  1.79350670e-02]]
grads:  [ 2.57188659e-03 -4.17653848e+00]
Stock Position:  0.0025718865908113363
Bond Position:  [5.33031152]


portfolio before change:  [5.58788579]
curr_Stock_Price:  99.63173613513854
curr_Factors:  [9.96317361e+01 3.78278091e-02]
mat_Sqrt:  [[ 1.93777475e+01  0.00000000e+00]
 [-7.77974901e-03  1.78256444e-02]]
grads:  [ 6.21331514e-05 -3.65334937e+00]
Stock Position:  6.213315144501967e-05
Bond Position:  [5.58169535]


portfolio before change:  [5.58927558]
curr_Stock_Price:  99.53834665996068
curr_Factors:  [9.95383467e+01 3.87840515e-02]
mat_Sqrt:  [[ 1.96027504e+01  0.00000000e+00]
 [-7.87746675e-03  1.80495438e-02]]
grads:  [-0.00131854  1.21462394]
Stock Position:  -0.001318536397285869
Bond Position:  [5.72052052]


portfolio before change:  [5.58979843]
curr_Stock_Price:  100.22657894146613
curr_Factors:  [1.00226579e+02 3.93892358e-02]
mat_Sqrt:  [[ 1.98916901e+01  0.00000000e+00]
 [-7.93868863e-03  1.81898208e-02]]
grads:  [ 0.00105831 -0.49502711]
Stock Position:  0.001058308715820077
Bond Position:  [5.48372777]


portfolio before change:  [5.58969267]
curr_Stock_Price:  98.83107845775076
curr_Factors:  [9.88310785e+01 3.92693787e-02]
mat_Sqrt:  [[ 1.95848635e+01  0.00000000e+00]
 [-7.92660115e-03  1.81621249e-02]]
grads:  [ 0.00776662 -1.57727775]
Stock Position:  0.0077666158512160275
Bond Position:  [4.82210965]


portfolio before change:  [5.60026132]
curr_Stock_Price:  100.03661952065707
curr_Factors:  [1.00036620e+02 3.83203596e-02]
mat_Sqrt:  [[ 1.95827552e+01  0.00000000e+00]
 [-7.83023469e-03  1.79413216e-02]]
grads:  [3.28668524e-03 3.38709679e+00]
Stock Position:  0.0032866852406779564
Bond Position:  [5.27147244]


portfolio before change:  [5.60483338]
curr_Stock_Price:  101.02668312358908
curr_Factors:  [1.01026683e+02 3.80974822e-02]
mat_Sqrt:  [[ 1.97189703e+01  0.00000000e+00]
 [-7.80743054e-03  1.78890707e-02]]
grads:  [-0.00735335 -3.50353688]
Stock Position:  -0.007353345017362222
Bond Position:  [6.34771744]


portfolio before change:  [5.61561581]
curr_Stock_Price:  99.77619107663509
curr_Factors:  [9.97761911e+01 3.92091423e-02]
mat_Sqrt:  [[ 1.97569814e+01  0.00000000e+00]
 [-7.92051941e-03  1.81481899e-02]]
grads:  [-0.01006756 -7.23410197]
Stock Position:  -0.010067559841459111
Bond Position:  [6.62011858]


portfolio before change:  [5.59474671]
curr_Stock_Price:  102.01350921823024
curr_Factors:  [1.02013509e+02 3.89067551e-02]
mat_Sqrt:  [[ 2.01219559e+01  0.00000000e+00]
 [-7.88991814e-03  1.80780735e-02]]
grads:  [-1.94132564e-02 -2.85376727e+01]
Stock Position:  -0.019413256379701645
Bond Position:  [7.57516112]


portfolio before change:  [5.62124284]
curr_Stock_Price:  100.74622553307559
curr_Factors:  [1.00746226e+02 3.79870500e-02]
mat_Sqrt:  [[ 1.96357082e+01  0.00000000e+00]
 [-7.79610672e-03  1.78631246e-02]]
grads:  [ 8.08601483e-03 -1.29009979e+01]
Stock Position:  0.008086014834133019
Bond Position:  [4.80660736]


portfolio before change:  [5.62677599]
curr_Stock_Price:  101.28188481466385
curr_Factors:  [1.01281885e+02 3.78629214e-02]
mat_Sqrt:  [[ 1.97078312e+01  0.00000000e+00]
 [-7.78335880e-03  1.78339154e-02]]
grads:  [ 0.0041099  -3.10255934]
Stock Position:  0.004109895393936797
Bond Position:  [5.21051804]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.62705184]
Stock Price:  101.03201489018774
PL:  [4.59503695]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [-9.64109899e-04  1.34879463e-01]
 [ 4.18088260e-02 -5.78363434e-02]
 [ 4.89351088e-01 -2.13365541e-01]
 [-8.58699449e-02 -8.66693978e-02]
 [ 5.18825751e-01 -2.72622296e-02]
 [-4.93687604e-01 -4.60801850e-01]
 [-9.82384438e-02 -7.77169051e-02]
 [-1.33666889e+00  6.11894556e-01]
 [ 3.65057263e-02  2.71103688e-03]
 [ 1.85852864e-02 -7.19971416e-02]
 [ 7.30831842e-02  2.93080381e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.64966715e-01 -2.87025856e-02]
 [ 4.66645059e-02  7.16858560e-02]
 [-1.17737410e-01 -6.27264616e-02]
 [-1.41250745e-01 -1.29687223e-01]
 [-1.92027086e-01 -3.68248204e-01]
 [ 2.72896528e-01 -3.18351759e-01]
 [-1.25002476e-01 -1.57058938e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.16279704]
curr_Stock_Price:  99.58014948709271
curr_Factors:  [9.95801495e+01 4.11746480e-02]
mat_Sqrt:  [[ 2.02063430e+01  0.00000000e+00]
 [-8.11661487e-03  1.85975010e-02]]
grads:  [2.86554147e-03 7.25255847e+00]
Stock Position:  0.0028655414726032604
Bond Position:  [-0.44814809]


portfolio before change:  [-0.16727609]
curr_Stock_Price:  98.05617864600883
curr_Factors:  [9.80561786e+01 4.16831876e-02]
mat_Sqrt:  [[ 2.00196014e+01  0.00000000e+00]
 [-8.16658436e-03  1.87119955e-02]]
grads:  [ 8.27537772e-04 -3.09086988e+00]
Stock Position:  0.0008275377718387385
Bond Position:  [-0.24842128]


portfolio before change:  [-0.16848814]
curr_Stock_Price:  96.66659263462887
curr_Factors:  [9.66665926e+01 4.18484070e-02]
mat_Sqrt:  [[ 1.97749720e+01  0.00000000e+00]
 [-8.18275328e-03  1.87490432e-02]]
grads:  [  0.02003698 -11.38007627]
Stock Position:  0.020036980694019546
Bond Position:  [-2.10539479]


portfolio before change:  [-0.18375488]
curr_Stock_Price:  95.93093658562998
curr_Factors:  [9.59309366e+01 4.43902415e-02]
mat_Sqrt:  [[ 2.02116811e+01  0.00000000e+00]
 [-8.42759671e-03  1.93100499e-02]]
grads:  [-0.00612    -4.48830522]
Stock Position:  -0.006120004084506851
Bond Position:  [0.40334284]


portfolio before change:  [-0.15792371]
curr_Stock_Price:  91.72663857097028
curr_Factors:  [9.17266386e+01 4.87799568e-02]
mat_Sqrt:  [[ 2.02589151e+01  0.00000000e+00]
 [-8.83447400e-03  2.02423229e-02]]
grads:  [ 0.02502244 -1.34679353]
Stock Position:  0.025022442544619515
Bond Position:  [-2.45314825]


portfolio before change:  [-0.10167595]
curr_Stock_Price:  93.99904352205442
curr_Factors:  [9.39990435e+01 5.00243027e-02]
mat_Sqrt:  [[ 2.10239326e+01  0.00000000e+00]
 [-8.94644535e-03  2.04988815e-02]]
grads:  [ -0.03304796 -22.47936551]
Stock Position:  -0.033047956838522324
Bond Position:  [3.00480038]


portfolio before change:  [-0.0972819]
curr_Stock_Price:  93.88881715921306
curr_Factors:  [9.38888172e+01 4.72564110e-02]
mat_Sqrt:  [[ 2.04100578e+01  0.00000000e+00]
 [-8.69541589e-03  1.99237008e-02]]
grads:  [-0.00647509 -3.90072637]
Stock Position:  -0.006475086107452893
Bond Position:  [0.51065627]


portfolio before change:  [-0.10062827]
curr_Stock_Price:  94.42534325844976
curr_Factors:  [9.44253433e+01 4.68768697e-02]
mat_Sqrt:  [[ 2.04440942e+01  0.00000000e+00]
 [-8.66042675e-03  1.98435306e-02]]
grads:  [-0.05231908 30.83597213]
Stock Position:  -0.0523190804166272
Bond Position:  [4.83961885]


portfolio before change:  [-0.16105031]
curr_Stock_Price:  95.60334735344821
curr_Factors:  [9.56033474e+01 4.45941961e-02]
mat_Sqrt:  [[ 2.01888819e+01  0.00000000e+00]
 [-8.44693517e-03  1.93543599e-02]]
grads:  [0.00186682 0.1400737 ]
Stock Position:  0.0018668156029501908
Bond Position:  [-0.33952413]


portfolio before change:  [-0.16047553]
curr_Stock_Price:  95.95671469624675
curr_Factors:  [9.59567147e+01 4.43813910e-02]
mat_Sqrt:  [[ 2.02150968e+01  0.00000000e+00]
 [-8.42675653e-03  1.93081248e-02]]
grads:  [-6.35012656e-04 -3.72885209e+00]
Stock Position:  -0.0006350126561917686
Bond Position:  [-0.0995418]


portfolio before change:  [-0.16145046]
curr_Stock_Price:  97.45281659798854
curr_Factors:  [9.74528166e+01 4.27290875e-02]
mat_Sqrt:  [[ 2.01444867e+01  0.00000000e+00]
 [-8.26840614e-03  1.89452985e-02]]
grads:  [9.97761582e-03 1.54698212e+01]
Stock Position:  0.009977615818787903
Bond Position:  [-1.13379723]


portfolio before change:  [-0.16361716]
curr_Stock_Price:  97.26407297008095
curr_Factors:  [9.72640730e+01 4.32547632e-02]
mat_Sqrt:  [[ 2.02287674e+01  0.00000000e+00]
 [-8.31911180e-03  1.90614798e-02]]
grads:  [ 0.00237367 -0.45071962]
Stock Position:  0.0023736729608506437
Bond Position:  [-0.39449026]


portfolio before change:  [-0.16057725]
curr_Stock_Price:  98.58630240327113
curr_Factors:  [9.85863024e+01 4.44779242e-02]
mat_Sqrt:  [[ 2.07916441e+01  0.00000000e+00]
 [-8.43591600e-03  1.93291118e-02]]
grads:  [ 0.00733179 -1.48494074]
Stock Position:  0.007331785721561104
Bond Position:  [-0.8833909]


portfolio before change:  [-0.1489403]
curr_Stock_Price:  100.20361989149426
curr_Factors:  [1.0020362e+02 4.3205359e-02]
mat_Sqrt:  [[ 2.08282231e+01  0.00000000e+00]
 [-8.31435953e-03  1.90505910e-02]]
grads:  [3.74255539e-03 3.76292033e+00]
Stock Position:  0.0037425553903411538
Bond Position:  [-0.5239579]


portfolio before change:  [-0.14656125]
curr_Stock_Price:  100.87430016019294
curr_Factors:  [1.00874300e+02 4.12185737e-02]
mat_Sqrt:  [[ 2.04798615e+01  0.00000000e+00]
 [-8.12094317e-03  1.86074184e-02]]
grads:  [-0.00708567 -3.3710459 ]
Stock Position:  -0.007085667180088312
Bond Position:  [0.56820047]


portfolio before change:  [-0.14131847]
curr_Stock_Price:  100.15443621880867
curr_Factors:  [1.00154436e+02 4.16587825e-02]
mat_Sqrt:  [[ 2.04420044e+01  0.00000000e+00]
 [-8.16419329e-03  1.87065169e-02]]
grads:  [-0.00967864 -6.93272959]
Stock Position:  -0.009678644284481558
Bond Position:  [0.8280407]


portfolio before change:  [-0.11795351]
curr_Stock_Price:  97.76175402082727
curr_Factors:  [9.77617540e+01 4.16098461e-02]
mat_Sqrt:  [[ 1.99419232e+01  0.00000000e+00]
 [-8.15939665e-03  1.86955264e-02]]
grads:  [-1.76885537e-02 -1.96971295e+01]
Stock Position:  -0.01768855365044381
Bond Position:  [1.61131052]


portfolio before change:  [-0.07889147]
curr_Stock_Price:  95.57620721402706
curr_Factors:  [9.55762072e+01 4.02431278e-02]
mat_Sqrt:  [[ 1.91732465e+01  0.00000000e+00]
 [-8.02427595e-03  1.83859260e-02]]
grads:  [ 6.98663261e-03 -1.73149701e+01]
Stock Position:  0.006986632609731228
Bond Position:  [-0.74664732]


portfolio before change:  [-0.07672713]
curr_Stock_Price:  95.91271064792787
curr_Factors:  [9.59127106e+01 3.95752498e-02]
mat_Sqrt:  [[ 1.90804230e+01  0.00000000e+00]
 [-7.95741162e-03  1.82327205e-02]]
grads:  [-0.01014383 -8.61412524]
Stock Position:  -0.010143832572153722
Bond Position:  [0.89619535]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.05066133]
Stock Price:  93.36518067681725
PL:  [-0.05066133]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 7.61718889e-04  1.42192657e-01]
 [ 5.11037977e-02  1.82332232e-03]
 [ 8.33359537e-01 -3.18358193e-01]
 [ 4.98739234e-02 -1.06849011e-01]
 [ 2.26990620e-01 -6.71704244e-03]
 [ 1.27588421e-02 -1.02718238e-01]
 [-2.47693066e-02 -5.09498920e-02]
 [-1.32656552e+00  6.22806860e-01]
 [ 5.84642029e-02 -2.86517350e-02]
 [ 1.41745231e-02 -9.32530716e-02]
 [ 6.93625733e-02  2.91318827e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.23320173e-01 -3.61041627e-02]
 [-8.11786010e-02 -1.14993148e-01]
 [ 4.54871770e-02  2.89680844e-02]
 [-1.38015456e-01 -1.37326696e-01]
 [-1.94998450e-01 -3.26850244e-01]
 [ 2.86619361e-01 -2.86769819e-01]
 [-6.45226978e-02 -1.41538973e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.50566434]
curr_Stock_Price:  99.52850537839862
curr_Factors:  [9.95285054e+01 3.90758893e-02]
mat_Sqrt:  [[ 1.96744191e+01  0.00000000e+00]
 [-7.90704894e-03  1.81173251e-02]]
grads:  [3.19296248e-03 7.84843543e+00]
Stock Position:  0.0031929624816031533
Bond Position:  [-0.82345512]


portfolio before change:  [-0.49968542]
curr_Stock_Price:  101.46551760266449
curr_Factors:  [1.01465518e+02 3.90616463e-02]
mat_Sqrt:  [[ 2.00536646e+01  0.00000000e+00]
 [-7.90560777e-03  1.81140230e-02]]
grads:  [0.00258803 0.10065805]
Stock Position:  0.0025880337507857027
Bond Position:  [-0.76228161]


portfolio before change:  [-0.49700315]
curr_Stock_Price:  102.57557631802062
curr_Factors:  [1.02575576e+02 3.99873864e-02]
mat_Sqrt:  [[ 2.05118804e+01  0.00000000e+00]
 [-7.99873854e-03  1.83274124e-02]]
grads:  [  0.03385436 -17.37060235]
Stock Position:  0.03385436232138672
Bond Position:  [-3.96963387]


portfolio before change:  [-0.58366483]
curr_Stock_Price:  100.04505595653373
curr_Factors:  [1.00045056e+02 4.07549354e-02]
mat_Sqrt:  [[ 2.01969475e+01  0.00000000e+00]
 [-8.07514065e-03  1.85024716e-02]]
grads:  [ 1.60479301e-04 -5.77485066e+00]
Stock Position:  0.0001604793010009344
Bond Position:  [-0.59971999]


portfolio before change:  [-0.58402973]
curr_Stock_Price:  98.7056499858506
curr_Factors:  [9.87056500e+01 4.05283765e-02]
mat_Sqrt:  [[ 1.98710866e+01  0.00000000e+00]
 [-8.05266430e-03  1.84509719e-02]]
grads:  [ 0.01127563 -0.36404816]
Stock Position:  0.011275632128104571
Bond Position:  [-1.69699833]


portfolio before change:  [-0.5891617]
curr_Stock_Price:  98.28814210556163
curr_Factors:  [9.82881421e+01 4.26012652e-02]
mat_Sqrt:  [[ 2.02867452e+01  0.00000000e+00]
 [-8.25602958e-03  1.89169402e-02]]
grads:  [-1.58088801e-03 -5.42996049e+00]
Stock Position:  -0.0015808880118116126
Bond Position:  [-0.43377915]


portfolio before change:  [-0.58624924]
curr_Stock_Price:  96.37724537345484
curr_Factors:  [9.63772454e+01 4.21661735e-02]
mat_Sqrt:  [[ 1.97904926e+01  0.00000000e+00]
 [-8.21376147e-03  1.88200918e-02]]
grads:  [-2.37516384e-03 -2.70720741e+00]
Stock Position:  -0.0023751638404584494
Bond Position:  [-0.35733749]


portfolio before change:  [-0.58238573]
curr_Stock_Price:  94.71300037826677
curr_Factors:  [9.47130004e+01 4.38684822e-02]
mat_Sqrt:  [[ 1.98374525e+01  0.00000000e+00]
 [-8.37792167e-03  1.91962301e-02]]
grads:  [-0.05316965 32.44422767]
Stock Position:  -0.05316964590913511
Bond Position:  [4.45347096]


portfolio before change:  [-0.72257201]
curr_Stock_Price:  97.37052773437513
curr_Factors:  [9.73705277e+01 4.30450849e-02]
mat_Sqrt:  [[ 2.02017647e+01  0.00000000e+00]
 [-8.29892378e-03  1.90152232e-02]]
grads:  [ 0.00227503 -1.50677879]
Stock Position:  0.0022750270234822598
Bond Position:  [-0.94409259]


portfolio before change:  [-0.72109662]
curr_Stock_Price:  98.12280280847597
curr_Factors:  [9.81228028e+01 4.07534091e-02]
mat_Sqrt:  [[ 1.98085149e+01  0.00000000e+00]
 [-8.07498945e-03  1.85021252e-02]]
grads:  [-1.33904304e-03 -5.04012758e+00]
Stock Position:  -0.001339043035432177
Bond Position:  [-0.58970596]


portfolio before change:  [-0.72043428]
curr_Stock_Price:  97.51805224396183
curr_Factors:  [9.75180522e+01 4.14972537e-02]
mat_Sqrt:  [[ 1.98652803e+01  0.00000000e+00]
 [-8.14834989e-03  1.86702151e-02]]
grads:  [9.89185807e-03 1.56033996e+01]
Stock Position:  0.009891858073104864
Bond Position:  [-1.68506901]


portfolio before change:  [-0.73218288]
curr_Stock_Price:  96.37294007436086
curr_Factors:  [9.63729401e+01 4.31588339e-02]
mat_Sqrt:  [[ 2.00211933e+01  0.00000000e+00]
 [-8.30988172e-03  1.90403310e-02]]
grads:  [ 0.00239828 -0.45122025]
Stock Position:  0.002398282535430018
Bond Position:  [-0.96331242]


portfolio before change:  [-0.7350162]
curr_Stock_Price:  95.29197655096618
curr_Factors:  [9.52919766e+01 4.30499564e-02]
mat_Sqrt:  [[ 1.97716400e+01  0.00000000e+00]
 [-8.29939337e-03  1.90162992e-02]]
grads:  [ 0.00544027 -1.89859039]
Stock Position:  0.005440268198254884
Bond Position:  [-1.25343011]


portfolio before change:  [-0.73659336]
curr_Stock_Price:  95.05967783573554
curr_Factors:  [9.50596778e+01 4.41427590e-02]
mat_Sqrt:  [[ 1.99722078e+01  0.00000000e+00]
 [-8.40407130e-03  1.92561464e-02]]
grads:  [-0.00657743 -5.97176327]
Stock Position:  -0.006577426339339975
Bond Position:  [-0.11134533]


portfolio before change:  [-0.75055548]
curr_Stock_Price:  97.17817750390275
curr_Factors:  [9.71781775e+01 4.40336114e-02]
mat_Sqrt:  [[ 2.03920507e+01  0.00000000e+00]
 [-8.39367490e-03  1.92323253e-02]]
grads:  [0.00285061 1.50621851]
Stock Position:  0.002850614991584078
Bond Position:  [-1.02757305]


portfolio before change:  [-0.75447014]
curr_Stock_Price:  95.89503782763424
curr_Factors:  [9.58950378e+01 4.50624148e-02]
mat_Sqrt:  [[ 2.03565120e+01  0.00000000e+00]
 [-8.49116386e-03  1.94557006e-02]]
grads:  [-0.00972415 -7.05842979]
Stock Position:  -0.009724148233625652
Bond Position:  [0.17802742]


portfolio before change:  [-0.75541819]
curr_Stock_Price:  95.99710970955265
curr_Factors:  [9.59971097e+01 4.41174765e-02]
mat_Sqrt:  [[ 2.01633872e+01  0.00000000e+00]
 [-8.40166426e-03  1.92506312e-02]]
grads:  [-1.67455789e-02 -1.69786767e+01]
Stock Position:  -0.016745578928232707
Bond Position:  [0.85210899]


portfolio before change:  [-0.76525169]
curr_Stock_Price:  96.59706232785851
curr_Factors:  [9.65970623e+01 4.23049046e-02]
mat_Sqrt:  [[ 1.98682346e+01  0.00000000e+00]
 [-8.22726244e-03  1.88510265e-02]]
grads:  [ 8.12667833e-03 -1.52124246e+01]
Stock Position:  0.008126678328333518
Bond Position:  [-1.55026494]


portfolio before change:  [-0.76016412]
curr_Stock_Price:  97.27079141997054
curr_Factors:  [9.72707914e+01 4.20350807e-02]
mat_Sqrt:  [[ 1.99429037e+01  0.00000000e+00]
 [-8.20098343e-03  1.87908137e-02]]
grads:  [-6.33284760e-03 -7.53234932e+00]
Stock Position:  -0.0063328475950462145
Bond Position:  [-0.14416303]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.76019701]
Stock Price:  97.27029224514325
PL:  [-0.76019701]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.57693076e-01 -1.13004232e-01]
 [ 1.47869816e-02  3.22695391e-02]
 [ 2.49916606e-01 -1.44373546e-01]
 [ 1.05735206e-01  1.84205641e-01]
 [ 3.97451623e-01 -1.81380844e-02]
 [-5.61923909e-01 -5.05185539e-01]
 [-6.77164653e-02 -6.59193485e-02]
 [-1.31184824e+00  6.42928782e-01]
 [ 4.49245786e-02 -9.33781872e-03]
 [ 1.99610604e-02 -6.53671425e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 7.89240500e-02 -6.49818307e-02]
 [ 1.42618241e-01 -3.25317765e-02]
 [-7.82193036e-02 -1.08566173e-01]
 [ 1.31538234e-01  1.91157023e-01]
 [-8.66296227e-02 -1.19147969e-01]
 [-1.97929460e-01 -2.85998221e-01]
 [ 2.86735159e-01 -2.89175589e-01]
 [-6.60105896e-02 -1.41920393e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.84619151]
curr_Stock_Price:  96.46472999952003
curr_Factors:  [9.64647300e+01 4.19050807e-02]
mat_Sqrt:  [[ 1.97470349e+01  0.00000000e+00]
 [-8.18829220e-03  1.87617344e-02]]
grads:  [ 5.48811435e-03 -6.02312291e+00]
Stock Position:  0.005488114350508792
Bond Position:  [-21.37560098]


portfolio before change:  [-20.85568857]
curr_Stock_Price:  95.70809603560241
curr_Factors:  [9.57080960e+01 4.14300703e-02]
mat_Sqrt:  [[ 1.94807876e+01  0.00000000e+00]
 [-8.14175119e-03  1.86550956e-02]]
grads:  [1.48200184e-03 1.72979758e+00]
Stock Position:  0.0014820018380467708
Bond Position:  [-20.99752815]


portfolio before change:  [-20.8640719]
curr_Stock_Price:  93.59386597782965
curr_Factors:  [9.35938660e+01 4.14784002e-02]
mat_Sqrt:  [[ 1.90615576e+01  0.00000000e+00]
 [-8.14649865e-03  1.86659734e-02]]
grads:  [ 0.00980543 -7.7345844 ]
Stock Position:  0.009805432949795426
Bond Position:  [-21.78180028]


portfolio before change:  [-20.87317024]
curr_Stock_Price:  93.22139803458788
curr_Factors:  [9.32213980e+01 4.07753451e-02]
mat_Sqrt:  [[ 1.88241092e+01  0.00000000e+00]
 [-8.07716238e-03  1.85071040e-02]]
grads:  [9.88780590e-03 9.95323964e+00]
Stock Position:  0.009887805903515625
Bond Position:  [-21.79492533]


portfolio before change:  [-20.86431714]
curr_Stock_Price:  94.66787811462949
curr_Factors:  [9.46678781e+01 4.18242707e-02]
mat_Sqrt:  [[ 1.93605117e+01  0.00000000e+00]
 [-8.18039321e-03  1.87436355e-02]]
grads:  [ 0.0201201  -0.96769297]
Stock Position:  0.020120104294369966
Bond Position:  [-22.76904472]


portfolio before change:  [-20.8935386]
curr_Stock_Price:  93.49847640057362
curr_Factors:  [9.34984764e+01 4.00183923e-02]
mat_Sqrt:  [[ 1.87039939e+01  0.00000000e+00]
 [-8.00183902e-03  1.83345165e-02]]
grads:  [ -0.0418309  -27.55379663]
Stock Position:  -0.041830902893866415
Bond Position:  [-16.98241291]


portfolio before change:  [-20.95739148]
curr_Stock_Price:  94.92342161785342
curr_Factors:  [9.49234216e+01 4.10956585e-02]
mat_Sqrt:  [[ 1.92429369e+01  0.00000000e+00]
 [-8.10882566e-03  1.85796537e-02]]
grads:  [-0.0050141  -3.54793203]
Stock Position:  -0.005014100916516118
Bond Position:  [-20.48143586]


portfolio before change:  [-20.96477618]
curr_Stock_Price:  95.37488958270782
curr_Factors:  [9.53748896e+01 3.96209404e-02]
mat_Sqrt:  [[ 1.89843809e+01  0.00000000e+00]
 [-7.96200381e-03  1.82432426e-02]]
grads:  [-0.05432103 35.24202343]
Stock Position:  -0.05432102953781169
Bond Position:  [-15.78391399]


portfolio before change:  [-21.01805851]
curr_Stock_Price:  96.28311719079241
curr_Factors:  [9.62831172e+01 3.83474846e-02]
mat_Sqrt:  [[ 1.88546547e+01  0.00000000e+00]
 [-7.83300551e-03  1.79476703e-02]]
grads:  [ 0.00216653 -0.52028027]
Stock Position:  0.002166532406398898
Bond Position:  [-21.22665901]


portfolio before change:  [-21.02554213]
curr_Stock_Price:  95.27861400706759
curr_Factors:  [9.52786140e+01 3.93058177e-02]
mat_Sqrt:  [[ 1.88896473e+01  0.00000000e+00]
 [-7.93027794e-03  1.81705495e-02]]
grads:  [-4.53555290e-04 -3.59742244e+00]
Stock Position:  -0.00045355529017193153
Bond Position:  [-20.98232801]


portfolio before change:  [-21.03046698]
curr_Stock_Price:  94.57001084873974
curr_Factors:  [9.45700108e+01 3.88974758e-02]
mat_Sqrt:  [[ 1.86515165e+01  0.00000000e+00]
 [-7.88897720e-03  1.80759176e-02]]
grads:  [1.44709092e-02 1.93389241e+01]
Stock Position:  0.014470909181763596
Bond Position:  [-22.39898102]


portfolio before change:  [-21.0340796]
curr_Stock_Price:  94.70737786921846
curr_Factors:  [9.47073779e+01 3.96471061e-02]
mat_Sqrt:  [[ 1.88577363e+01  0.00000000e+00]
 [-7.96463243e-03  1.82492655e-02]]
grads:  [ 2.68132151e-03 -3.56079156e+00]
Stock Position:  0.002681321507909479
Bond Position:  [-21.28802053]


portfolio before change:  [-21.03499381]
curr_Stock_Price:  96.35151545649427
curr_Factors:  [9.63515155e+01 3.97325446e-02]
mat_Sqrt:  [[ 1.92057707e+01  0.00000000e+00]
 [-7.97320960e-03  1.82689183e-02]]
grads:  [ 0.00668654 -1.78071717]
Stock Position:  0.006686542918009101
Bond Position:  [-21.67925235]


portfolio before change:  [-21.04695312]
curr_Stock_Price:  95.37360703752326
curr_Factors:  [9.53736070e+01 4.21884573e-02]
mat_Sqrt:  [[ 1.95895757e+01  0.00000000e+00]
 [-8.21593158e-03  1.88250642e-02]]
grads:  [-0.00641165 -5.76710775]
Stock Position:  -0.0064116481112661385
Bond Position:  [-20.43545112]


portfolio before change:  [-21.03683054]
curr_Stock_Price:  92.99791759699339
curr_Factors:  [9.29979176e+01 4.43180204e-02]
mat_Sqrt:  [[ 1.95777780e+01  0.00000000e+00]
 [-8.42073824e-03  1.92943352e-02]]
grads:  [0.0109801  9.90741691]
Stock Position:  0.010980101918817826
Bond Position:  [-22.05795715]


portfolio before change:  [-21.03039386]
curr_Stock_Price:  94.08641959284473
curr_Factors:  [9.40864196e+01 4.18770410e-02]
mat_Sqrt:  [[ 1.92537326e+01  0.00000000e+00]
 [-8.18555224e-03  1.87554564e-02]]
grads:  [-0.00720017 -6.35270965]
Stock Position:  -0.00720016541535549
Bond Position:  [-20.35295607]


portfolio before change:  [-21.03629982]
curr_Stock_Price:  94.1999021497081
curr_Factors:  [9.41999021e+01 4.10196983e-02]
mat_Sqrt:  [[ 1.90786079e+01  0.00000000e+00]
 [-8.10132812e-03  1.85624747e-02]]
grads:  [ -0.01691682 -15.40733259]
Stock Position:  -0.016916816888585352
Bond Position:  [-19.44273733]


portfolio before change:  [-21.08052311]
curr_Stock_Price:  96.52669874139283
curr_Factors:  [9.65266987e+01 3.91472843e-02]
mat_Sqrt:  [[ 1.90984566e+01  0.00000000e+00]
 [-7.91426906e-03  1.81338685e-02]]
grads:  [ 8.40531715e-03 -1.59467125e+01]
Stock Position:  0.008405317147519738
Bond Position:  [-21.89186062]


portfolio before change:  [-21.08004238]
curr_Stock_Price:  97.23510427455867
curr_Factors:  [9.72351043e+01 3.82722836e-02]
mat_Sqrt:  [[ 1.90223984e+01  0.00000000e+00]
 [-7.82532132e-03  1.79300636e-02]]
grads:  [-6.72626683e-03 -7.91521971e+00]
Stock Position:  -0.006726266829053269
Bond Position:  [-20.42601313]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.08143265]
Stock Price:  96.68251259961194
PL:  [-21.08143265]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 9.71582365e-03  2.10748653e-02]
 [ 1.78732590e-02  2.22671035e-02]
 [ 8.09851846e-01 -3.11183559e-01]
 [ 2.82444787e-01 -9.27046145e-02]
 [ 1.27202026e-01 -7.42853822e-03]
 [ 2.27811562e-02 -1.85223169e-02]
 [-7.49071889e-02 -1.44949341e-01]
 [-1.25180054e+00  7.34979716e-01]
 [ 6.94773130e-02 -7.73616381e-02]
 [ 9.16222218e-02  1.90770567e-01]
 [-2.75449595e-01 -2.52669092e-02]
 [ 2.26930399e-02 -9.03974570e-03]
 [ 7.94940785e-02 -2.40670114e-02]
 [ 9.03726499e-02  1.45522409e-01]
 [ 4.24619580e-03 -1.05482263e-03]
 [-1.41174569e-01 -1.29345157e-01]
 [-1.89655042e-01 -3.95761124e-01]
 [ 2.78832713e-01 -2.42755533e-01]
 [ 3.01505985e-02 -1.17243358e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.80766932]
curr_Stock_Price:  101.53381544338738
curr_Factors:  [1.01533815e+02 3.89373605e-02]
mat_Sqrt:  [[ 2.00352128e+01  0.00000000e+00]
 [-7.89302076e-03  1.80851826e-02]]
grads:  [9.44020366e-04 1.16531118e+00]
Stock Position:  0.000944020365982758
Bond Position:  [12.71181933]


portfolio before change:  [12.81095698]
curr_Stock_Price:  101.64960704936361
curr_Factors:  [1.01649607e+02 3.94284756e-02]
mat_Sqrt:  [[ 2.01841608e+01  0.00000000e+00]
 [-7.94264194e-03  1.81988789e-02]]
grads:  [0.00136698 1.22354259]
Stock Position:  0.0013669837457895313
Bond Position:  [12.67200362]


portfolio before change:  [12.81503355]
curr_Stock_Price:  102.31397376677349
curr_Factors:  [1.02313974e+02 3.89106797e-02]
mat_Sqrt:  [[ 2.01822398e+01  0.00000000e+00]
 [-7.89031606e-03  1.80789853e-02]]
grads:  [  0.03339769 -17.21244603]
Stock Position:  0.03339769096162629
Bond Position:  [9.39798308]


portfolio before change:  [12.81486087]
curr_Stock_Price:  102.2384452618386
curr_Factors:  [1.02238445e+02 3.88836614e-02]
mat_Sqrt:  [[ 2.01603382e+01  0.00000000e+00]
 [-7.88757620e-03  1.80727075e-02]]
grads:  [ 0.01200303 -5.1295366 ]
Stock Position:  0.01200303160663526
Bond Position:  [11.58768958]


portfolio before change:  [12.78767696]
curr_Stock_Price:  99.7323129686643
curr_Factors:  [9.97323130e+01 4.06884794e-02]
mat_Sqrt:  [[ 2.01173893e+01  0.00000000e+00]
 [-8.06855421e-03  1.84873802e-02]]
grads:  [ 0.00616183 -0.40181671]
Stock Position:  0.006161830658151086
Bond Position:  [12.17314334]


portfolio before change:  [12.79966707]
curr_Stock_Price:  101.18422592343498
curr_Factors:  [1.01184226e+02 3.91545673e-02]
mat_Sqrt:  [[ 2.00218419e+01  0.00000000e+00]
 [-7.91500523e-03  1.81355553e-02]]
grads:  [ 7.34066050e-04 -1.02132615e+00]
Stock Position:  0.0007340660502582389
Bond Position:  [12.72539117]


portfolio before change:  [12.80209738]
curr_Stock_Price:  100.16055950675478
curr_Factors:  [1.0016056e+02 3.9209368e-02]
mat_Sqrt:  [[ 1.98331485e+01  0.00000000e+00]
 [-7.92054220e-03  1.81482421e-02]]
grads:  [-6.96653221e-03 -7.98696316e+00]
Stock Position:  -0.006966532213056158
Bond Position:  [13.49986914]


portfolio before change:  [12.81266502]
curr_Stock_Price:  99.12815927223579
curr_Factors:  [9.91281593e+01 3.91615997e-02]
mat_Sqrt:  [[ 1.96167589e+01  0.00000000e+00]
 [-7.91571598e-03  1.81371838e-02]]
grads:  [-0.0474609  40.52336475]
Stock Position:  -0.04746090333002345
Bond Position:  [17.517377]


portfolio before change:  [12.69993174]
curr_Stock_Price:  101.59573069579709
curr_Factors:  [1.01595731e+02 3.67389772e-02]
mat_Sqrt:  [[ 1.94732746e+01  0.00000000e+00]
 [-7.66696573e-03  1.75672254e-02]]
grads:  [ 1.83399694e-03 -4.40374825e+00]
Stock Position:  0.0018339969410764594
Bond Position:  [12.51360548]


portfolio before change:  [12.70307137]
curr_Stock_Price:  101.60164141809369
curr_Factors:  [1.01601641e+02 3.73895549e-02]
mat_Sqrt:  [[ 1.96460783e+01  0.00000000e+00]
 [-7.73455156e-03  1.77220840e-02]]
grads:  [8.90158942e-03 1.07645674e+01]
Stock Position:  0.00890158942413161
Bond Position:  [11.79865528]


portfolio before change:  [12.72100053]
curr_Stock_Price:  103.28438822112784
curr_Factors:  [1.03284388e+02 3.52399455e-02]
mat_Sqrt:  [[ 1.93888609e+01  0.00000000e+00]
 [-7.50892222e-03  1.72051022e-02]]
grads:  [-0.01477534 -1.46857071]
Stock Position:  -0.014775338250802406
Bond Position:  [14.2470623]


portfolio before change:  [12.76496686]
curr_Stock_Price:  100.54982305138633
curr_Factors:  [1.00549823e+02 3.72953456e-02]
mat_Sqrt:  [[ 1.94181848e+01  0.00000000e+00]
 [-7.72480116e-03  1.76997430e-02]]
grads:  [ 0.00096547 -0.51072751]
Stock Position:  0.0009654749760296706
Bond Position:  [12.66788853]


portfolio before change:  [12.76956909]
curr_Stock_Price:  102.03599136185224
curr_Factors:  [1.02035991e+02 3.67374846e-02]
mat_Sqrt:  [[ 1.95572639e+01  0.00000000e+00]
 [-7.66680998e-03  1.75668685e-02]]
grads:  [ 0.00352761 -1.37002285]
Stock Position:  0.0035276086634977656
Bond Position:  [12.40962604]


portfolio before change:  [12.76954802]
curr_Stock_Price:  101.15044273890511
curr_Factors:  [1.01150443e+02 3.50306872e-02]
mat_Sqrt:  [[ 1.89318091e+01  0.00000000e+00]
 [-7.48659466e-03  1.71539434e-02]]
grads:  [8.12832177e-03 8.48332107e+00]
Stock Position:  0.008128321768622349
Bond Position:  [11.94736467]


portfolio before change:  [12.74897362]
curr_Stock_Price:  98.25173699283985
curr_Factors:  [9.82517370e+01 3.75999492e-02]
mat_Sqrt:  [[ 1.90517058e+01  0.00000000e+00]
 [-7.75628253e-03  1.77718759e-02]]
grads:  [ 0.00019871 -0.05935348]
Stock Position:  0.00019871362194689155
Bond Position:  [12.72944966]


portfolio before change:  [12.75254845]
curr_Stock_Price:  100.22481533284063
curr_Factors:  [1.00224815e+02 3.52981504e-02]
mat_Sqrt:  [[ 1.88300399e+01  0.00000000e+00]
 [-7.51512080e-03  1.72193050e-02]]
grads:  [-0.01049522 -7.51163634]
Stock Position:  -0.010495220670312971
Bond Position:  [13.80443001]


portfolio before change:  [12.7705216]
curr_Stock_Price:  98.84117543594023
curr_Factors:  [9.88411754e+01 3.58452358e-02]
mat_Sqrt:  [[ 1.87134397e+01  0.00000000e+00]
 [-7.57313523e-03  1.73522327e-02]]
grads:  [-1.93646579e-02 -2.28075044e+01]
Stock Position:  -0.019364657851308628
Bond Position:  [14.68454714]


portfolio before change:  [12.75613642]
curr_Stock_Price:  99.77363600187952
curr_Factors:  [9.97736360e+01 3.69903047e-02]
mat_Sqrt:  [[ 1.91893275e+01  0.00000000e+00]
 [-7.69314549e-03  1.76272108e-02]]
grads:  [ 9.00946178e-03 -1.37716361e+01]
Stock Position:  0.009009461777313679
Bond Position:  [11.85722966]


portfolio before change:  [12.75564721]
curr_Stock_Price:  99.39027444823645
curr_Factors:  [9.93902744e+01 3.54483766e-02]
mat_Sqrt:  [[ 1.87129417e+01  0.00000000e+00]
 [-7.53109571e-03  1.72559081e-02]]
grads:  [-1.12321185e-03 -6.79438933e+00]
Stock Position:  -0.0011232118456018915
Bond Position:  [12.86728355]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.75934581]
Stock Price:  98.96170505257697
PL:  [12.75934581]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 6.12581709e-02  5.15878554e-02]
 [ 2.41396822e-02 -6.47868480e-02]
 [ 5.04559834e-01 -2.18007307e-01]
 [ 5.84452959e-02  1.20430501e-01]
 [ 5.16871043e-01 -2.71411128e-02]
 [-8.68414804e-01 -7.00872041e-01]
 [-7.97214083e-02 -8.25578767e-02]
 [-1.47694552e+00  5.53517598e-01]
 [-2.39575620e-02  8.85246207e-02]
 [ 2.92941520e-02 -9.27114793e-03]
 [ 1.17340070e-01  3.49568798e-01]
 [ 1.95028821e-01 -3.21899019e-01]
 [ 7.14106310e-03  1.14685888e-01]
 [-1.49728452e-01 -2.63777409e-01]
 [ 2.32324192e-01  3.81115252e-01]
 [ 2.05903328e-02 -9.63557344e-02]
 [-2.10549418e-01 -1.08104888e-01]
 [ 5.68713736e-01 -5.61251614e-01]
 [-4.43176205e-01 -2.38708894e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.80924279]
curr_Stock_Price:  98.27778562056018
curr_Factors:  [9.82777856e+01 4.23672805e-02]
mat_Sqrt:  [[ 2.02288250e+01  0.00000000e+00]
 [-8.23332550e-03  1.88649187e-02]]
grads:  [0.00414127 2.73459198]
Stock Position:  0.004141266584953901
Bond Position:  [-9.2162373]


portfolio before change:  [-8.82018024]
curr_Stock_Price:  96.19313393864351
curr_Factors:  [9.61931339e+01 4.38903756e-02]
mat_Sqrt:  [[ 2.01524904e+01  0.00000000e+00]
 [-8.38001199e-03  1.92010196e-02]]
grads:  [-2.05216143e-04 -3.37413581e+00]
Stock Position:  -0.00020521614327131791
Bond Position:  [-8.80043985]


portfolio before change:  [-8.82249681]
curr_Stock_Price:  96.75930374986307
curr_Factors:  [9.67593037e+01 4.30692418e-02]
mat_Sqrt:  [[ 2.00805844e+01  0.00000000e+00]
 [-8.30125213e-03  1.90205581e-02]]
grads:  [  0.02038853 -11.46166719]
Stock Position:  0.020388532381638576
Bond Position:  [-10.79527701]


portfolio before change:  [-8.88570322]
curr_Stock_Price:  93.79159371529147
curr_Factors:  [9.37915937e+01 4.39291994e-02]
mat_Sqrt:  [[ 1.96580556e+01  0.00000000e+00]
 [-8.38371750e-03  1.92095100e-02]]
grads:  [5.64681866e-03 6.26931663e+00]
Stock Position:  0.00564681866408167
Bond Position:  [-9.41532734]


portfolio before change:  [-8.89939507]
curr_Stock_Price:  91.78378610648433
curr_Factors:  [9.17837861e+01 4.49483164e-02]
mat_Sqrt:  [[ 1.94590970e+01  0.00000000e+00]
 [-8.48040719e-03  1.94310539e-02]]
grads:  [ 0.02595319 -1.39679056]
Stock Position:  0.02595319251009288
Bond Position:  [-11.28147734]


portfolio before change:  [-8.91722643]
curr_Stock_Price:  91.20541266187942
curr_Factors:  [9.12054127e+01 4.47395378e-02]
mat_Sqrt:  [[ 1.92915161e+01  0.00000000e+00]
 [-8.46068912e-03  1.93858742e-02]]
grads:  [ -0.06087134 -36.15374962]
Stock Position:  -0.06087134031952209
Bond Position:  [-3.36543072]


portfolio before change:  [-8.94998903]
curr_Stock_Price:  91.72981603390794
curr_Factors:  [9.1729816e+01 4.4138028e-02]
mat_Sqrt:  [[ 1.92715651e+01  0.00000000e+00]
 [-8.40362094e-03  1.92551145e-02]]
grads:  [-0.00600639 -4.2875817 ]
Stock Position:  -0.006006394358800425
Bond Position:  [-8.39902358]


portfolio before change:  [-8.95791512]
curr_Stock_Price:  92.6997950373356
curr_Factors:  [9.26997950e+01 4.56870971e-02]
mat_Sqrt:  [[ 1.98141550e+01  0.00000000e+00]
 [-8.54981610e-03  1.95900897e-02]]
grads:  [-0.06234788 28.25498023]
Stock Position:  -0.06234788360578766
Bond Position:  [-3.17827909]


portfolio before change:  [-8.83813201]
curr_Stock_Price:  90.76584349012995
curr_Factors:  [9.07658435e+01 4.50807417e-02]
mat_Sqrt:  [[ 1.92716089e+01  0.00000000e+00]
 [-8.49289037e-03  1.94596565e-02]]
grads:  [7.61625559e-04 4.54913584e+00]
Stock Position:  0.0007616255593379393
Bond Position:  [-8.90726159]


portfolio before change:  [-8.84029119]
curr_Stock_Price:  90.85500027516845
curr_Factors:  [9.08550003e+01 4.19609442e-02]
mat_Sqrt:  [[ 1.86110750e+01  0.00000000e+00]
 [-8.19374827e-03  1.87742358e-02]]
grads:  [ 0.00135661 -0.49382292]
Stock Position:  0.0013566057483463316
Bond Position:  [-8.96354561]


portfolio before change:  [-8.84464725]
curr_Stock_Price:  89.29604363580977
curr_Factors:  [8.92960436e+01 4.39001710e-02]
mat_Sqrt:  [[ 1.87096354e+01  0.00000000e+00]
 [-8.38094706e-03  1.92031621e-02]]
grads:  [1.44259573e-02 1.82037102e+01]
Stock Position:  0.014425957318253578
Bond Position:  [-10.13282817]


portfolio before change:  [-8.85580516]
curr_Stock_Price:  88.69820572837638
curr_Factors:  [8.86982057e+01 4.51486611e-02]
mat_Sqrt:  [[ 1.88467848e+01  0.00000000e+00]
 [-8.49928573e-03  1.94743101e-02]]
grads:  [ 2.89389262e-03 -1.65294184e+01]
Stock Position:  0.0028938926166827642
Bond Position:  [-9.11248824]


portfolio before change:  [-8.85694959]
curr_Stock_Price:  89.09005825700716
curr_Factors:  [8.90900583e+01 4.66714881e-02]
mat_Sqrt:  [[ 1.92466464e+01  0.00000000e+00]
 [-8.64143397e-03  1.98000126e-02]]
grads:  [2.97163915e-03 5.79221285e+00]
Stock Position:  0.002971639154459982
Bond Position:  [-9.12169309]


portfolio before change:  [-8.86320118]
curr_Stock_Price:  87.75379705839119
curr_Factors:  [8.77537971e+01 4.77207427e-02]
mat_Sqrt:  [[ 1.91698853e+01  0.00000000e+00]
 [-8.73803115e-03  2.00213446e-02]]
grads:  [ -0.01381596 -13.17480993]
Stock Position:  -0.013815959117204873
Bond Position:  [-7.65079831]


portfolio before change:  [-8.86992544]
curr_Stock_Price:  88.10204071643192
curr_Factors:  [8.81020407e+01 4.49179786e-02]
mat_Sqrt:  [[ 1.86722249e+01  0.00000000e+00]
 [-8.47754480e-03  1.94244954e-02]]
grads:  [ 0.02135024 19.6203425 ]
Stock Position:  0.021350242192240465
Bond Position:  [-10.75092535]


portfolio before change:  [-8.85659146]
curr_Stock_Price:  88.85247924966474
curr_Factors:  [8.88524792e+01 4.48789898e-02]
mat_Sqrt:  [[ 1.88230973e+01  0.00000000e+00]
 [-8.47386474e-03  1.94160633e-02]]
grads:  [-1.14023516e-03 -4.96268131e+00]
Stock Position:  -0.0011402351586684114
Bond Position:  [-8.75527874]


portfolio before change:  [-8.85641993]
curr_Stock_Price:  86.78217933516088
curr_Factors:  [8.67821793e+01 4.69129936e-02]
mat_Sqrt:  [[ 1.87965059e+01  0.00000000e+00]
 [-8.66376302e-03  1.98511749e-02]]
grads:  [-0.0137116  -5.44576773]
Stock Position:  -0.013711604733357032
Bond Position:  [-7.66649699]


portfolio before change:  [-8.88809303]
curr_Stock_Price:  88.95232936639812
curr_Factors:  [8.89523294e+01 4.58515292e-02]
mat_Sqrt:  [[ 1.90473358e+01  0.00000000e+00]
 [-8.56518807e-03  1.96253113e-02]]
grads:  [ 1.69978339e-02 -2.85983547e+01]
Stock Position:  0.01699783391879344
Bond Position:  [-10.40008995]


portfolio before change:  [-8.89362063]
curr_Stock_Price:  88.78011593656339
curr_Factors:  [8.87801159e+01 4.62085109e-02]
mat_Sqrt:  [[ 1.90843202e+01  0.00000000e+00]
 [-8.59846599e-03  1.97015606e-02]]
grads:  [ -0.028681   -12.11624287]
Stock Position:  -0.028680995814110436
Bond Position:  [-6.3473185]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.93091151]
Stock Price:  90.02497693576544
PL:  [-8.93091151]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.68276414e-02  1.22939930e-01]
 [ 8.30612134e-02 -9.14173526e-03]
 [ 6.37260867e-01 -2.58508153e-01]
 [-1.01806589e-01 -1.10306324e-01]
 [ 4.01778701e-01 -1.85019681e-02]
 [-3.67746626e-01 -3.76976971e-01]
 [-6.69005781e-02 -6.56039864e-02]
 [-1.31763892e+00  6.41804849e-01]
 [ 3.71985717e-02  1.68547102e-03]
 [ 2.33628149e-02 -4.89737315e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 1.59317595e-01 -2.42847104e-01]
 [ 3.68890684e-03  1.23263485e-01]
 [-1.32797470e-01 -2.27020600e-01]
 [ 1.76422461e-01  2.75787015e-01]
 [-1.74652553e-03 -9.60085302e-02]
 [-2.05112191e-01 -1.85906965e-01]
 [ 5.38372417e-01 -5.39338339e-01]
 [-4.95888534e-01 -2.52235477e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.87592949]
curr_Stock_Price:  100.03785520123658
curr_Factors:  [1.00037855e+02 3.94685026e-02]
mat_Sqrt:  [[ 1.98742019e+01  0.00000000e+00]
 [-7.94667252e-03  1.82081142e-02]]
grads:  [4.04962303e-03 6.75193097e+00]
Stock Position:  0.004049623031926188
Bond Position:  [2.47081389]


portfolio before change:  [2.87879866]
curr_Stock_Price:  100.59380591478744
curr_Factors:  [1.00593806e+02 3.86025365e-02]
mat_Sqrt:  [[ 1.97641964e+01  0.00000000e+00]
 [-7.85901128e-03  1.80072571e-02]]
grads:  [ 0.00400074 -0.5076695 ]
Stock Position:  0.004000741111254632
Bond Position:  [2.47634889]


portfolio before change:  [2.87578361]
curr_Stock_Price:  99.68541982807338
curr_Factors:  [9.96854198e+01 3.60147796e-02]
mat_Sqrt:  [[ 1.89178607e+01  0.00000000e+00]
 [-7.59102413e-03  1.73932213e-02]]
grads:  [  0.02772188 -14.86258056]
Stock Position:  0.027721879770862032
Bond Position:  [0.11231638]


portfolio before change:  [2.79534124]
curr_Stock_Price:  96.78264223640522
curr_Factors:  [9.67826422e+01 3.62151781e-02]
mat_Sqrt:  [[ 1.84180135e+01  0.00000000e+00]
 [-7.61211435e-03  1.74415451e-02]]
grads:  [-0.00814139 -6.32434357]
Stock Position:  -0.008141389184095559
Bond Position:  [3.5832864]


portfolio before change:  [2.81417401]
curr_Stock_Price:  94.57947520820574
curr_Factors:  [9.45794752e+01 3.51614464e-02]
mat_Sqrt:  [[ 1.77349622e+01  0.00000000e+00]
 [-7.50055426e-03  1.71859288e-02]]
grads:  [ 0.0221993  -1.07657655]
Stock Position:  0.02219930196903928
Bond Position:  [0.71457568]


portfolio before change:  [2.82251583]
curr_Stock_Price:  94.94719625295308
curr_Factors:  [9.49471963e+01 3.36956800e-02]
mat_Sqrt:  [[ 1.74288711e+01  0.00000000e+00]
 [-7.34255323e-03  1.68239030e-02]]
grads:  [ -0.03053972 -22.40722446]
Stock Position:  -0.030539721261662267
Bond Position:  [5.72217674]


portfolio before change:  [2.82343595]
curr_Stock_Price:  94.96391547965038
curr_Factors:  [9.49639155e+01 3.43910139e-02]
mat_Sqrt:  [[ 1.76108818e+01  0.00000000e+00]
 [-7.41792574e-03  1.69966031e-02]]
grads:  [-0.00542463 -3.85982929]
Stock Position:  -0.005424629277935488
Bond Position:  [3.33857999]


portfolio before change:  [2.82251882]
curr_Stock_Price:  95.28686475939304
curr_Factors:  [9.52868648e+01 3.40716586e-02]
mat_Sqrt:  [[ 1.75885353e+01  0.00000000e+00]
 [-7.38340394e-03  1.69175037e-02]]
grads:  [-0.05898913 37.9373257 ]
Stock Position:  -0.05898912546358788
Bond Position:  [8.44340764]


portfolio before change:  [2.80247732]
curr_Stock_Price:  95.66240211999327
curr_Factors:  [9.56624021e+01 3.62100290e-02]
mat_Sqrt:  [[ 1.82035344e+01  0.00000000e+00]
 [-7.61157319e-03  1.74403052e-02]]
grads:  [0.00208389 0.09664229]
Stock Position:  0.0020838904536449347
Bond Position:  [2.60312735]


portfolio before change:  [2.79878499]
curr_Stock_Price:  93.57822814010903
curr_Factors:  [9.35782281e+01 3.73843006e-02]
mat_Sqrt:  [[ 1.80933693e+01  0.00000000e+00]
 [-7.73400808e-03  1.77208387e-02]]
grads:  [ 1.09925693e-04 -2.76362379e+00]
Stock Position:  0.00010992569317375834
Bond Position:  [2.78849834]


portfolio before change:  [2.79948419]
curr_Stock_Price:  93.59636569241204
curr_Factors:  [9.35963657e+01 4.01298855e-02]
mat_Sqrt:  [[ 1.87496405e+01  0.00000000e+00]
 [-8.01297802e-03  1.83600392e-02]]
grads:  [1.43951774e-02 1.90396543e+01]
Stock Position:  0.014395177374390809
Bond Position:  [1.45214791]


portfolio before change:  [2.75594719]
curr_Stock_Price:  90.5467274514444
curr_Factors:  [9.05467275e+01 4.10681093e-02]
mat_Sqrt:  [[ 1.83495371e+01  0.00000000e+00]
 [-8.10610726e-03  1.85734251e-02]]
grads:  [ 2.90636378e-03 -1.30749769e+01]
Stock Position:  0.002906363781174236
Bond Position:  [2.49278546]


portfolio before change:  [2.75153967]
curr_Stock_Price:  88.8157664562506
curr_Factors:  [8.88157665e+01 4.19854892e-02]
mat_Sqrt:  [[ 1.81986711e+01  0.00000000e+00]
 [-8.19614438e-03  1.87797260e-02]]
grads:  [3.1587747e-03 6.5636466e+00]
Stock Position:  0.0031587747034894026
Bond Position:  [2.47099067]


portfolio before change:  [2.75449245]
curr_Stock_Price:  89.55496498128053
curr_Factors:  [8.95549650e+01 4.27895198e-02]
mat_Sqrt:  [[ 1.85250067e+01  0.00000000e+00]
 [-8.27425112e-03  1.89586910e-02]]
grads:  [ -0.01251699 -11.97448705]
Stock Position:  -0.012516993151809966
Bond Position:  [3.87545134]


portfolio before change:  [2.73968328]
curr_Stock_Price:  90.81550391878392
curr_Factors:  [9.08155039e+01 4.16314450e-02]
mat_Sqrt:  [[ 1.85298003e+01  0.00000000e+00]
 [-8.16151407e-03  1.87003780e-02]]
grads:  [ 0.01601667 14.74767059]
Stock Position:  0.016016674578974474
Bond Position:  [1.28512091]


portfolio before change:  [2.73720918]
curr_Stock_Price:  90.6409720309463
curr_Factors:  [9.06409720e+01 3.99159886e-02]
mat_Sqrt:  [[ 1.81091472e+01  0.00000000e+00]
 [-7.99159444e-03  1.83110432e-02]]
grads:  [-2.41027823e-03 -5.24320374e+00]
Stock Position:  -0.0024102782342375327
Bond Position:  [2.95567914]


portfolio before change:  [2.73981251]
curr_Stock_Price:  89.86748572352028
curr_Factors:  [8.98674857e+01 4.05066564e-02]
mat_Sqrt:  [[ 1.80869688e+01  0.00000000e+00]
 [-8.05050621e-03  1.84460270e-02]]
grads:  [ -0.01582624 -10.07842853]
Stock Position:  -0.015826236294722525
Bond Position:  [4.16207657]


portfolio before change:  [2.74559315]
curr_Stock_Price:  89.56798356424896
curr_Factors:  [8.95679836e+01 4.13802163e-02]
mat_Sqrt:  [[ 1.82200337e+01  0.00000000e+00]
 [-8.13685112e-03  1.86438681e-02]]
grads:  [ 1.66292705e-02 -2.89284571e+01]
Stock Position:  0.016629270503438355
Bond Position:  [1.25614292]


portfolio before change:  [2.71310819]
curr_Stock_Price:  87.59561579240858
curr_Factors:  [8.75956158e+01 4.27010517e-02]
mat_Sqrt:  [[ 1.81009620e+01  0.00000000e+00]
 [-8.26569311e-03  1.89390822e-02]]
grads:  [ -0.0334774  -13.31825243]
Stock Position:  -0.03347739878071607
Bond Position:  [5.64558155]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.65433504]
Stock Price:  89.39338748587254
PL:  [2.65433504]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.42252030e-02  1.35853007e-01]
 [ 8.47778476e-02 -1.04246860e-02]
 [ 8.30657007e-01 -3.17533371e-01]
 [ 4.58647427e-01 -5.49219963e-02]
 [ 2.87850672e-01 -3.24616805e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-6.29246521e-01 -5.49873553e-02]
 [-1.50320974e+00  7.26088932e-01]
 [ 9.83940249e-05 -6.89010154e-02]
 [ 1.44136701e-01  5.00416596e-01]
 [-4.01724905e-01 -7.08942841e-02]
 [-4.05011186e-02 -3.09536651e-02]
 [-8.36510183e-02 -1.23846884e-01]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.13206857e-01 -6.01551298e-02]
 [ 1.09533249e-01  2.95564588e-02]
 [-1.23259788e-01 -7.00915172e-01]
 [-4.00864607e-01  1.09039590e-01]
 [-6.57841154e-02 -8.55881306e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.94837181]
curr_Stock_Price:  99.16057455007493
curr_Factors:  [9.91605746e+01 3.83696560e-02]
mat_Sqrt:  [[ 1.94237459e+01  0.00000000e+00]
 [-7.83526959e-03  1.79528580e-02]]
grads:  [3.78486810e-03 7.56720779e+00]
Stock Position:  0.00378486810185512
Bond Position:  [-3.32368151]


portfolio before change:  [-2.94346201]
curr_Stock_Price:  100.67735738322219
curr_Factors:  [1.00677357e+02 3.90589481e-02]
mat_Sqrt:  [[ 1.98972052e+01  0.00000000e+00]
 [-7.90533471e-03  1.81133974e-02]]
grads:  [ 0.00403213 -0.57552351]
Stock Position:  0.004032131188032822
Bond Position:  [-3.34940632]


portfolio before change:  [-2.93620237]
curr_Stock_Price:  102.68550133710771
curr_Factors:  [1.02685501e+02 3.87009789e-02]
mat_Sqrt:  [[ 2.02008714e+01  0.00000000e+00]
 [-7.86902575e-03  1.80302031e-02]]
grads:  [  0.03425962 -17.61119215]
Stock Position:  0.034259615333519455
Bond Position:  [-6.45416814]


portfolio before change:  [-2.86488974]
curr_Stock_Price:  104.81414097054329
curr_Factors:  [1.04814141e+02 3.74085107e-02]
mat_Sqrt:  [[ 2.02723963e+01  0.00000000e+00]
 [-7.73651195e-03  1.77265758e-02]]
grads:  [ 0.02144184 -3.0982857 ]
Stock Position:  0.021441841198007097
Bond Position:  [-5.1122979]


portfolio before change:  [-2.86398533]
curr_Stock_Price:  104.91593436808218
curr_Factors:  [1.04915934e+02 3.51200251e-02]
mat_Sqrt:  [[ 1.96616002e+01  0.00000000e+00]
 [-7.49613501e-03  1.71758031e-02]]
grads:  [ 0.01391968 -1.88996581]
Stock Position:  0.01391968252359549
Bond Position:  [-4.32438183]


portfolio before change:  [-2.85594045]
curr_Stock_Price:  105.57156119101367
curr_Factors:  [1.05571561e+02 3.63641874e-02]
mat_Sqrt:  [[ 2.01318593e+01  0.00000000e+00]
 [-7.62775851e-03  1.74773904e-02]]
grads:  [-2.87912878e-05 -1.10721199e+00]
Stock Position:  -2.8791287816136673e-05
Bond Position:  [-2.85290091]


portfolio before change:  [-2.85668364]
curr_Stock_Price:  106.60923904927984
curr_Factors:  [1.06609239e+02 3.60405440e-02]
mat_Sqrt:  [[ 2.02390681e+01  0.00000000e+00]
 [-7.59373889e-03  1.73994416e-02]]
grads:  [-0.03227644 -3.16029425]
Stock Position:  -0.03227643517138217
Bond Position:  [0.58428256]


portfolio before change:  [-2.83669365]
curr_Stock_Price:  105.99442846835036
curr_Factors:  [1.05994428e+02 3.64454255e-02]
mat_Sqrt:  [[ 2.02350625e+01  0.00000000e+00]
 [-7.63627401e-03  1.74969018e-02]]
grads:  [-0.05862688 41.49814288]
Stock Position:  -0.05862687845704926
Bond Position:  [3.37742882]


portfolio before change:  [-2.88854709]
curr_Stock_Price:  106.89329777162382
curr_Factors:  [1.06893298e+02 3.56039987e-02]
mat_Sqrt:  [[ 2.01697198e+01  0.00000000e+00]
 [-7.54760876e-03  1.72937442e-02]]
grads:  [-1.48601343e-03 -3.98415835e+00]
Stock Position:  -0.0014860134281333675
Bond Position:  [-2.72970222]


portfolio before change:  [-2.88602692]
curr_Stock_Price:  104.73807844068028
curr_Factors:  [1.04738078e+02 3.90582002e-02]
mat_Sqrt:  [[ 2.06995410e+01  0.00000000e+00]
 [-7.90525903e-03  1.81132240e-02]]
grads:  [1.75142245e-02 2.76271412e+01]
Stock Position:  0.017514224507912103
Bond Position:  [-4.72043314]


portfolio before change:  [-2.88425618]
curr_Stock_Price:  104.90656994235343
curr_Factors:  [1.04906570e+02 3.87281553e-02]
mat_Sqrt:  [[ 2.06450573e+01  0.00000000e+00]
 [-7.87178814e-03  1.80365325e-02]]
grads:  [-0.02095735 -3.93059387]
Stock Position:  -0.020957350715478596
Bond Position:  [-0.6856924]


portfolio before change:  [-2.90482637]
curr_Stock_Price:  105.87991579937872
curr_Factors:  [1.05879916e+02 3.92821920e-02]
mat_Sqrt:  [[ 2.09851194e+01  0.00000000e+00]
 [-7.92789424e-03  1.81650877e-02]]
grads:  [-0.00257375 -1.70401957]
Stock Position:  -0.0025737478347795553
Bond Position:  [-2.63231817]


portfolio before change:  [-2.91420824]
curr_Stock_Price:  109.26940989219979
curr_Factors:  [1.09269410e+02 3.94815819e-02]
mat_Sqrt:  [[ 2.17118020e+01  0.00000000e+00]
 [-7.94798912e-03  1.82111309e-02]]
grads:  [-6.34227548e-03 -6.80061467e+00]
Stock Position:  -0.006342275483453685
Bond Position:  [-2.22119154]


portfolio before change:  [-2.92093283]
curr_Stock_Price:  110.24212491349034
curr_Factors:  [1.10242125e+02 3.66655921e-02]
mat_Sqrt:  [[ 2.11094504e+01  0.00000000e+00]
 [-7.65930463e-03  1.75496716e-02]]
grads:  [7.21180034e-03 8.46614641e+00]
Stock Position:  0.007211800335250337
Bond Position:  [-3.71597702]


portfolio before change:  [-2.91838324]
curr_Stock_Price:  110.72448684715337
curr_Factors:  [1.10724487e+02 3.77307237e-02]
mat_Sqrt:  [[ 2.15075650e+01  0.00000000e+00]
 [-7.76975920e-03  1.78027548e-02]]
grads:  [-0.00648426 -3.37897872]
Stock Position:  -0.006484262984470323
Bond Position:  [-2.20041655]


portfolio before change:  [-2.91637188]
curr_Stock_Price:  110.32944752272347
curr_Factors:  [1.10329448e+02 3.83293416e-02]
mat_Sqrt:  [[ 2.16001677e+01  0.00000000e+00]
 [-7.83115231e-03  1.79434241e-02]]
grads:  [0.00566814 1.64720282]
Stock Position:  0.005668138651605685
Bond Position:  [-3.54173448]


portfolio before change:  [-2.91953453]
curr_Stock_Price:  109.92770911498688
curr_Factors:  [1.09927709e+02 3.82676302e-02]
mat_Sqrt:  [[ 2.15041837e+01  0.00000000e+00]
 [-7.82484558e-03  1.79289736e-02]]
grads:  [-1.99572443e-02 -3.90939933e+01]
Stock Position:  -0.019957244334610956
Bond Position:  [-0.72568038]


portfolio before change:  [-2.93203062]
curr_Stock_Price:  110.54476032414354
curr_Factors:  [1.10544760e+02 3.79686607e-02]
mat_Sqrt:  [[ 2.15402531e+01  0.00000000e+00]
 [-7.79421947e-03  1.78588004e-02]]
grads:  [-0.01640073  6.10565034]
Stock Position:  -0.016400727807653823
Bond Position:  [-1.11901609]


portfolio before change:  [-2.92889289]
curr_Stock_Price:  110.33638469939199
curr_Factors:  [1.10336385e+02 3.81254391e-02]
mat_Sqrt:  [[ 2.15439919e+01  0.00000000e+00]
 [-7.81029466e-03  1.78956332e-02]]
grads:  [-0.00478731 -4.78262655]
Stock Position:  -0.004787313257474828
Bond Position:  [-2.40067806]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.9477089]
Stock Price:  114.14139209657735
PL:  [-17.089101]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.24700551e-02  2.44616613e-02]
 [-7.09972682e-02  7.69355895e-02]
 [ 8.86917375e-01 -3.34704244e-01]
 [ 1.73039332e-01 -1.18927661e-01]
 [ 1.53643370e-01 -5.18135732e-03]
 [ 4.11394927e-02 -2.21518908e-02]
 [-8.11691249e-02 -1.53943561e-01]
 [-1.44728038e+00  7.53193298e-01]
 [ 3.70466392e-02 -7.74853070e-02]
 [ 1.41648750e-01  4.78305470e-01]
 [-4.40272893e-01 -8.50347789e-02]
 [-4.07562502e-02 -7.30178632e-02]
 [-3.98661897e-02 -9.28196474e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.13205793e-01 -6.01545261e-02]
 [ 5.64213211e-02 -1.11341932e-02]
 [-1.24518367e-01 -6.86688479e-01]
 [-4.14700307e-01  5.70144249e-02]
 [ 2.80094317e-02 -7.97675557e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.47016891]
curr_Stock_Price:  101.18173134395825
curr_Factors:  [1.01181731e+02 3.97641909e-02]
mat_Sqrt:  [[ 2.01766092e+01  0.00000000e+00]
 [-7.97638423e-03  1.82761922e-02]]
grads:  [1.14716993e-03 1.33844408e+00]
Stock Position:  0.0011471699304433868
Bond Position:  [10.35409627]


portfolio before change:  [10.47386186]
curr_Stock_Price:  102.14418956510498
curr_Factors:  [1.02144190e+02 3.87390137e-02]
mat_Sqrt:  [[ 2.01042533e+01  0.00000000e+00]
 [-7.87289158e-03  1.80390608e-02]]
grads:  [-1.86128893e-03  4.26494430e+00]
Stock Position:  -0.0018612889347471959
Bond Position:  [10.66398171]


portfolio before change:  [10.47403968]
curr_Stock_Price:  103.48117164299035
curr_Factors:  [1.03481172e+02 3.82173913e-02]
mat_Sqrt:  [[ 2.02298125e+01  0.00000000e+00]
 [-7.81970755e-03  1.79172009e-02]]
grads:  [  0.03662122 -18.6806101 ]
Stock Position:  0.03662122268213615
Bond Position:  [6.68443265]


portfolio before change:  [10.38232413]
curr_Stock_Price:  100.93109663410758
curr_Factors:  [1.00931097e+02 3.94317512e-02]
mat_Sqrt:  [[ 2.00423215e+01  0.00000000e+00]
 [-7.94297185e-03  1.81996349e-02]]
grads:  [ 6.04396281e-03 -6.53461794e+00]
Stock Position:  0.006043962807591558
Bond Position:  [9.77230034]


portfolio before change:  [10.37620824]
curr_Stock_Price:  99.51492730131099
curr_Factors:  [9.95149273e+01 4.10049785e-02]
mat_Sqrt:  [[ 2.01514604e+01  0.00000000e+00]
 [-8.09987442e-03  1.85591438e-02]]
grads:  [ 0.00751221 -0.27918084]
Stock Position:  0.007512211918624557
Bond Position:  [9.62863102]


portfolio before change:  [10.38727759]
curr_Stock_Price:  100.66796862120616
curr_Factors:  [1.00667969e+02 3.91987844e-02]
mat_Sqrt:  [[ 1.99309319e+01  0.00000000e+00]
 [-7.91947315e-03  1.81457926e-02]]
grads:  [ 0.00157903 -1.22077284]
Stock Position:  0.0015790337931608093
Bond Position:  [10.22831946]


portfolio before change:  [10.38951249]
curr_Stock_Price:  100.463730271761
curr_Factors:  [1.00463730e+02 3.91667216e-02]
mat_Sqrt:  [[ 1.98823589e+01  0.00000000e+00]
 [-7.91623361e-03  1.81383699e-02]]
grads:  [-7.46167008e-03 -8.48717728e+00]
Stock Position:  -0.007461670079715219
Bond Position:  [11.1391397]


portfolio before change:  [10.36390016]
curr_Stock_Price:  104.26950835073917
curr_Factors:  [1.04269508e+02 3.63334627e-02]
mat_Sqrt:  [[ 1.98751640e+01  0.00000000e+00]
 [-7.62453542e-03  1.74700053e-02]]
grads:  [-0.05627928 43.11351273]
Stock Position:  -0.056279277623883
Bond Position:  [16.23211277]


portfolio before change:  [10.37459962]
curr_Stock_Price:  104.15150881781713
curr_Factors:  [1.04151509e+02 3.56921038e-02]
mat_Sqrt:  [[ 1.96766717e+01  0.00000000e+00]
 [-7.55694158e-03  1.73151284e-02]]
grads:  [ 1.64117127e-04 -4.47500620e+00]
Stock Position:  0.00016411712716385467
Bond Position:  [10.35750658]


portfolio before change:  [10.37725537]
curr_Stock_Price:  104.55392534273068
curr_Factors:  [1.04553925e+02 3.61347913e-02]
mat_Sqrt:  [[ 1.98748161e+01  0.00000000e+00]
 [-7.60366136e-03  1.74221769e-02]]
grads:  [1.76302699e-02 2.74538293e+01]
Stock Position:  0.017630269875587346
Bond Position:  [8.53394145]


portfolio before change:  [10.39432343]
curr_Stock_Price:  105.40100876965985
curr_Factors:  [1.05401009e+02 3.58581180e-02]
mat_Sqrt:  [[ 1.99589878e+01  0.00000000e+00]
 [-7.57449594e-03  1.73553505e-02]]
grads:  [-0.0239183  -4.89962901]
Stock Position:  -0.023918302745934483
Bond Position:  [12.91533667]


portfolio before change:  [10.35385836]
curr_Stock_Price:  107.227823491056
curr_Factors:  [1.07227823e+02 3.72223036e-02]
mat_Sqrt:  [[ 2.06875525e+01  0.00000000e+00]
 [-7.71723303e-03  1.76824023e-02]]
grads:  [-3.51050991e-03 -4.12940855e+00]
Stock Position:  -0.0035105099143815915
Bond Position:  [10.7302827]


portfolio before change:  [10.35732382]
curr_Stock_Price:  107.00490666241502
curr_Factors:  [1.07004907e+02 3.65484903e-02]
mat_Sqrt:  [[ 2.04568337e+01  0.00000000e+00]
 [-7.64706378e-03  1.75216243e-02]]
grads:  [-3.92905404e-03 -5.29743395e+00]
Stock Position:  -0.003929054040980741
Bond Position:  [10.77775188]


portfolio before change:  [10.34512996]
curr_Stock_Price:  110.79427492301072
curr_Factors:  [1.10794275e+02 3.54253256e-02]
mat_Sqrt:  [[ 2.08532738e+01  0.00000000e+00]
 [-7.52864669e-03  1.72502967e-02]]
grads:  [7.30039530e-03 8.61307445e+00]
Stock Position:  0.007300395296492944
Bond Position:  [9.53628796]


portfolio before change:  [10.34703959]
curr_Stock_Price:  110.7292461067169
curr_Factors:  [1.10729246e+02 3.61567361e-02]
mat_Sqrt:  [[ 2.10550828e+01  0.00000000e+00]
 [-7.60596988e-03  1.74274663e-02]]
grads:  [-0.00662355 -3.45170806]
Stock Position:  -0.006623549389560049
Bond Position:  [11.08046022]


portfolio before change:  [10.36282438]
curr_Stock_Price:  108.76438942229616
curr_Factors:  [1.08764389e+02 3.67899172e-02]
mat_Sqrt:  [[ 2.08617690e+01  0.00000000e+00]
 [-7.67227916e-03  1.75794000e-02]]
grads:  [ 0.0024716  -0.63336594]
Stock Position:  0.002471600605041064
Bond Position:  [10.09400225]


portfolio before change:  [10.36665936]
curr_Stock_Price:  109.29488085608523
curr_Factors:  [1.09294881e+02 3.85899981e-02]
mat_Sqrt:  [[ 2.14702549e+01  0.00000000e+00]
 [-7.85773485e-03  1.80043324e-02]]
grads:  [-1.97582093e-02 -3.81401801e+01]
Stock Position:  -0.019758209315168716
Bond Position:  [12.52613049]


portfolio before change:  [10.39918698]
curr_Stock_Price:  107.80710947869105
curr_Factors:  [1.07807109e+02 3.94275972e-02]
mat_Sqrt:  [[ 2.14065933e+01  0.00000000e+00]
 [-7.94255347e-03  1.81986762e-02]]
grads:  [-0.01821015  3.13288858]
Stock Position:  -0.018210145219752637
Bond Position:  [12.3623701]


portfolio before change:  [10.39503912]
curr_Stock_Price:  108.20462658473274
curr_Factors:  [1.08204627e+02 3.89743800e-02]
mat_Sqrt:  [[ 2.13616816e+01  0.00000000e+00]
 [-7.89677200e-03  1.80937777e-02]]
grads:  [-3.18513486e-04 -4.40856282e+00]
Stock Position:  -0.00031851348638958115
Bond Position:  [10.42950375]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.39739111]
Stock Price:  109.00745073405494
PL:  [1.38994037]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.08385270e-01 -3.14086614e-02]
 [ 5.39851231e-02 -3.95388562e-02]
 [ 6.47259865e-01 -2.61559884e-01]
 [-8.91741479e-02 -9.27798796e-02]
 [ 2.84519083e-01 -9.47939739e-03]
 [-1.35115541e-02 -1.37234660e-01]
 [-5.42583049e-02 -1.15289658e-01]
 [-1.26071246e+00  7.35829045e-01]
 [ 8.32215661e-02 -7.49053671e-02]
 [ 1.28390093e-01  3.63551696e-01]
 [-3.17142899e-01 -4.00268045e-02]
 [ 7.92608379e-03 -9.26748101e-03]
 [ 1.39342988e-02 -5.46856535e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.16620635e-01 -6.20926317e-02]
 [-1.34413374e-01 -1.21513388e-01]
 [-1.68270140e-01 -5.01176424e-01]
 [ 1.55549407e-01 -2.05967258e-01]
 [ 5.99853268e-02 -1.09588145e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.68019761]
curr_Stock_Price:  97.39347782135923
curr_Factors:  [9.73934778e+01 4.19623083e-02]
mat_Sqrt:  [[ 1.99507653e+01  0.00000000e+00]
 [-8.19388146e-03  1.87745410e-02]]
grads:  [ 0.00474555 -1.67293898]
Stock Position:  0.004745552604892311
Bond Position:  [-15.14238348]


portfolio before change:  [-14.67388992]
curr_Stock_Price:  99.5204703478628
curr_Factors:  [9.95204703e+01 3.75978664e-02]
mat_Sqrt:  [[ 1.92971877e+01  0.00000000e+00]
 [-7.75606771e-03  1.77713837e-02]]
grads:  [ 1.90333183e-03 -2.22486087e+00]
Stock Position:  0.001903331833143974
Bond Position:  [-14.8633104]


portfolio before change:  [-14.67736856]
curr_Stock_Price:  99.64533074011464
curr_Factors:  [9.96453307e+01 3.76624625e-02]
mat_Sqrt:  [[ 1.93379890e+01  0.00000000e+00]
 [-7.76272761e-03  1.77866434e-02]]
grads:  [  0.0275678  -14.70541001]
Stock Position:  0.027567797891558322
Bond Position:  [-17.4243709]


portfolio before change:  [-14.69818141]
curr_Stock_Price:  99.04839460633458
curr_Factors:  [9.90483946e+01 3.77549701e-02]
mat_Sqrt:  [[ 1.92457352e+01  0.00000000e+00]
 [-7.77225528e-03  1.78084741e-02]]
grads:  [-0.00673742 -5.20987251]
Stock Position:  -0.006737420297334239
Bond Position:  [-14.03085075]


portfolio before change:  [-14.69201371]
curr_Stock_Price:  97.61225874274339
curr_Factors:  [9.76122587e+01 3.97544052e-02]
mat_Sqrt:  [[ 1.94624268e+01  0.00000000e+00]
 [-7.97540270e-03  1.82739433e-02]]
grads:  [ 0.01440632 -0.51873847]
Stock Position:  0.01440631930109823
Bond Position:  [-16.09824708]


portfolio before change:  [-14.69665684]
curr_Stock_Price:  97.56935691516719
curr_Factors:  [9.75693569e+01 3.68348403e-02]
mat_Sqrt:  [[ 1.87259060e+01  0.00000000e+00]
 [-7.67696193e-03  1.75901296e-02]]
grads:  [-3.92000633e-03 -7.80179924e+00]
Stock Position:  -0.003920006325449
Bond Position:  [-14.31418434]


portfolio before change:  [-14.70649325]
curr_Stock_Price:  99.16563438430185
curr_Factors:  [9.91656344e+01 3.68787732e-02]
mat_Sqrt:  [[ 1.90436165e+01  0.00000000e+00]
 [-7.68153872e-03  1.76006163e-02]]
grads:  [-5.49133285e-03 -6.55031938e+00]
Stock Position:  -0.005491332848275562
Bond Position:  [-14.16194174]


portfolio before change:  [-14.7110947]
curr_Stock_Price:  99.35876031879528
curr_Factors:  [9.93587603e+01 3.88551152e-02]
mat_Sqrt:  [[ 1.95853016e+01  0.00000000e+00]
 [-7.88468036e-03  1.80660723e-02]]
grads:  [-0.04797324 40.72988489]
Stock Position:  -0.04797323788689454
Bond Position:  [-9.94453325]


portfolio before change:  [-14.76141578]
curr_Stock_Price:  100.35587116331263
curr_Factors:  [1.00355871e+02 4.08228670e-02]
mat_Sqrt:  [[ 2.02765721e+01  0.00000000e+00]
 [-8.08186781e-03  1.85178855e-02]]
grads:  [ 2.49204764e-03 -4.04502810e+00]
Stock Position:  0.002492047641607746
Bond Position:  [-15.01150739]


portfolio before change:  [-14.75715662]
curr_Stock_Price:  103.57110078212204
curr_Factors:  [1.03571101e+02 4.13879327e-02]
mat_Sqrt:  [[ 2.10705300e+01  0.00000000e+00]
 [-8.13760975e-03  1.86456063e-02]]
grads:  [1.36236279e-02 1.94979820e+01]
Stock Position:  0.013623627949633862
Bond Position:  [-16.16817076]


portfolio before change:  [-14.75779331]
curr_Stock_Price:  103.82109689522309
curr_Factors:  [1.03821097e+02 4.20612942e-02]
mat_Sqrt:  [[ 2.12925134e+01  0.00000000e+00]
 [-8.20354013e-03  1.87966718e-02]]
grads:  [-0.01571501 -2.12946233]
Stock Position:  -0.01571500852188425
Bond Position:  [-13.12624389]


portfolio before change:  [-14.73596017]
curr_Stock_Price:  102.22293590823665
curr_Factors:  [1.02222936e+02 4.08707741e-02]
mat_Sqrt:  [[ 2.06659218e+01  0.00000000e+00]
 [-8.08660859e-03  1.85287480e-02]]
grads:  [ 1.87817583e-04 -5.00167686e-01]
Stock Position:  0.00018781758310296582
Bond Position:  [-14.75515943]


portfolio before change:  [-14.73927136]
curr_Stock_Price:  104.23584586801513
curr_Factors:  [1.04235846e+02 3.94081574e-02]
mat_Sqrt:  [[ 2.06923664e+01  0.00000000e+00]
 [-7.94059518e-03  1.81941892e-02]]
grads:  [-4.80006823e-04 -3.00566586e+00]
Stock Position:  -0.0004800068226042343
Bond Position:  [-14.68923744]


portfolio before change:  [-14.74210646]
curr_Stock_Price:  102.49072136598886
curr_Factors:  [1.02490721e+02 4.12022153e-02]
mat_Sqrt:  [[ 2.08039036e+01  0.00000000e+00]
 [-8.11933153e-03  1.86037257e-02]]
grads:  [7.31772000e-03 7.98646959e+00]
Stock Position:  0.0073177199993518785
Bond Position:  [-15.49210486]


portfolio before change:  [-14.74370089]
curr_Stock_Price:  102.80216802510135
curr_Factors:  [1.02802168e+02 4.20144674e-02]
mat_Sqrt:  [[ 2.10718034e+01  0.00000000e+00]
 [-8.19897236e-03  1.87862057e-02]]
grads:  [-0.00682049 -3.30522473]
Stock Position:  -0.006820492700558557
Bond Position:  [-14.04253945]


portfolio before change:  [-14.74644745]
curr_Stock_Price:  102.69007782639396
curr_Factors:  [1.02690078e+02 4.29623489e-02]
mat_Sqrt:  [[ 2.12849430e+01  0.00000000e+00]
 [-8.29094435e-03  1.89969400e-02]]
grads:  [-0.00880651 -6.39647164]
Stock Position:  -0.008806514741884795
Bond Position:  [-13.84210577]


portfolio before change:  [-14.74078369]
curr_Stock_Price:  101.65394554035834
curr_Factors:  [1.01653946e+02 4.36795497e-02]
mat_Sqrt:  [[ 2.12453219e+01  0.00000000e+00]
 [-8.35986122e-03  1.91548484e-02]]
grads:  [-1.82158437e-02 -2.61644683e+01]
Stock Position:  -0.018215843740192063
Bond Position:  [-12.88907131]


portfolio before change:  [-14.74454427]
curr_Stock_Price:  101.68347494793812
curr_Factors:  [1.01683475e+02 4.52202867e-02]
mat_Sqrt:  [[ 2.16230541e+01  0.00000000e+00]
 [-8.50602484e-03  1.94897514e-02]]
grads:  [ 3.03647788e-03 -1.05679777e+01]
Stock Position:  0.0030364778825028613
Bond Position:  [-15.05330389]


portfolio before change:  [-14.75322299]
curr_Stock_Price:  100.06484674191127
curr_Factors:  [1.00064847e+02 4.41918203e-02]
mat_Sqrt:  [[ 2.10354826e+01  0.00000000e+00]
 [-8.40874025e-03  1.92668443e-02]]
grads:  [ 5.77934883e-04 -5.68791355e+00]
Stock Position:  0.0005779348829176238
Bond Position:  [-14.81105396]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.75685759]
Stock Price:  100.1835991176259
PL:  [-14.94045671]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.70791235e-02  9.58177826e-02]
 [ 7.99831745e-02 -6.84131953e-03]
 [ 6.79696247e-01 -2.71459588e-01]
 [-8.40115445e-02 -9.34519332e-02]
 [ 2.97371394e-01 -1.04199147e-02]
 [-2.34961429e-01 -2.86809915e-01]
 [-2.85625099e-02 -5.11197121e-02]
 [-1.25252422e+00  7.31570106e-01]
 [ 8.29452298e-02 -6.36315618e-02]
 [ 4.27763003e-02 -2.90578790e-02]
 [-3.92073063e-02  1.09901715e-02]
 [ 4.91888423e-02 -8.63112867e-03]
 [ 1.30202949e-01 -1.33510949e-02]
 [-1.40740877e-02 -3.45934198e-03]
 [-1.12249034e-01 -5.53955624e-02]
 [-1.40314110e-01 -1.25481262e-01]
 [-1.48051858e-01 -5.80553164e-01]
 [ 1.86911927e-01 -2.14399687e-01]
 [ 4.00266858e-02 -1.14709435e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.57042629]
curr_Stock_Price:  100.29308740557524
curr_Factors:  [1.00293087e+02 3.91976150e-02]
mat_Sqrt:  [[ 1.98564141e+01  0.00000000e+00]
 [-7.91935502e-03  1.81455219e-02]]
grads:  [3.46978219e-03 5.28051951e+00]
Stock Position:  0.003469782194392333
Bond Position:  [4.22243112]


portfolio before change:  [4.57200807]
curr_Stock_Price:  100.44469396410297
curr_Factors:  [1.00444694e+02 3.94958044e-02]
mat_Sqrt:  [[ 1.99619278e+01  0.00000000e+00]
 [-7.94942055e-03  1.82144107e-02]]
grads:  [ 0.00385721 -0.37559928]
Stock Position:  0.0038572115130619156
Bond Position:  [4.18457164]


portfolio before change:  [4.57198014]
curr_Stock_Price:  100.16620174352862
curr_Factors:  [1.00166202e+02 3.75636617e-02]
mat_Sqrt:  [[ 1.94135593e+01  0.00000000e+00]
 [-7.75253886e-03  1.77632981e-02]]
grads:  [  0.02890874 -15.28204881]
Stock Position:  0.028908741632028334
Bond Position:  [1.6763013]


portfolio before change:  [4.54111826]
curr_Stock_Price:  99.08414092041887
curr_Factors:  [9.90841409e+01 3.94202846e-02]
mat_Sqrt:  [[ 1.96727026e+01  0.00000000e+00]
 [-7.94181688e-03  1.81969885e-02]]
grads:  [-0.00634368 -5.13557137]
Stock Position:  -0.006343679089597531
Bond Position:  [5.16967625]


portfolio before change:  [4.55400915]
curr_Stock_Price:  97.25581452501179
curr_Factors:  [9.72558145e+01 4.00310158e-02]
mat_Sqrt:  [[ 1.94587026e+01  0.00000000e+00]
 [-8.00310098e-03  1.83374080e-02]]
grads:  [ 0.01504847 -0.56823269]
Stock Position:  0.015048473498830268
Bond Position:  [3.0904576]


portfolio before change:  [4.53477233]
curr_Stock_Price:  95.92614257195179
curr_Factors:  [9.59261426e+01 3.93371060e-02]
mat_Sqrt:  [[ 1.90255922e+01  0.00000000e+00]
 [-7.93343366e-03  1.81777801e-02]]
grads:  [ -0.01892901 -15.77804951]
Stock Position:  -0.018929005421196087
Bond Position:  [6.3505588]


portfolio before change:  [4.53036782]
curr_Stock_Price:  96.24271199542459
curr_Factors:  [9.62427120e+01 3.90161262e-02]
mat_Sqrt:  [[ 1.90103418e+01  0.00000000e+00]
 [-7.90100005e-03  1.81034654e-02]]
grads:  [-2.67606873e-03 -2.82375286e+00]
Stock Position:  -0.0026760687346475314
Bond Position:  [4.78791994]


portfolio before change:  [4.52432948]
curr_Stock_Price:  98.94648308101347
curr_Factors:  [9.89464831e+01 3.88010554e-02]
mat_Sqrt:  [[ 1.94904619e+01  0.00000000e+00]
 [-7.87919340e-03  1.80535001e-02]]
grads:  [-0.04788193 40.52234208]
Stock Position:  -0.047881925777512754
Bond Position:  [9.26207763]


portfolio before change:  [4.50770646]
curr_Stock_Price:  99.34201491210426
curr_Factors:  [9.93420149e+01 3.80395590e-02]
mat_Sqrt:  [[ 1.93754011e+01  0.00000000e+00]
 [-7.80149308e-03  1.78754663e-02]]
grads:  [ 2.84763858e-03 -3.55971479e+00]
Stock Position:  0.002847638575066297
Bond Position:  [4.22481631]


portfolio before change:  [4.5112633]
curr_Stock_Price:  100.22011161770153
curr_Factors:  [1.00220112e+02 3.78822564e-02]
mat_Sqrt:  [[ 1.95062058e+01  0.00000000e+00]
 [-7.78534586e-03  1.78384684e-02]]
grads:  [ 1.54281169e-03 -1.62894473e+00]
Stock Position:  0.001542811685000175
Bond Position:  [4.35664254]


portfolio before change:  [4.51141723]
curr_Stock_Price:  99.6138374723505
curr_Factors:  [9.96138375e+01 3.71039563e-02]
mat_Sqrt:  [[ 1.91880031e+01  0.00000000e+00]
 [-7.70495491e-03  1.76542695e-02]]
grads:  [-0.00179335  0.62252202]
Stock Position:  -0.0017933498330003988
Bond Position:  [4.69005969]


portfolio before change:  [4.51353046]
curr_Stock_Price:  99.0893595224288
curr_Factors:  [9.90893595e+01 3.60918127e-02]
mat_Sqrt:  [[ 1.88248432e+01  0.00000000e+00]
 [-7.59913813e-03  1.74118128e-02]]
grads:  [ 0.00241287 -0.49570534]
Stock Position:  0.002412870498689111
Bond Position:  [4.27444067]


portfolio before change:  [4.51899897]
curr_Stock_Price:  100.91281570741151
curr_Factors:  [1.00912816e+02 3.63874099e-02]
mat_Sqrt:  [[ 1.92496083e+01  0.00000000e+00]
 [-7.63019370e-03  1.74829701e-02]]
grads:  [ 0.00646123 -0.76366286]
Stock Position:  0.006461225177588855
Bond Position:  [3.86697854]


portfolio before change:  [4.5082328]
curr_Stock_Price:  99.09690060750806
curr_Factors:  [9.90969006e+01 3.83114974e-02]
mat_Sqrt:  [[ 1.93965565e+01  0.00000000e+00]
 [-7.82932921e-03  1.79392469e-02]]
grads:  [-0.00080343 -0.19283652]
Stock Position:  -0.00080343479382509
Bond Position:  [4.5878507]


portfolio before change:  [4.50855039]
curr_Stock_Price:  100.12935536302638
curr_Factors:  [1.00129355e+02 3.74060901e-02]
mat_Sqrt:  [[ 1.93656723e+01  0.00000000e+00]
 [-7.73626164e-03  1.77260023e-02]]
grads:  [-0.00704471 -3.12510184]
Stock Position:  -0.007044714871876968
Bond Position:  [5.21393315]


portfolio before change:  [4.49600468]
curr_Stock_Price:  102.09527669404793
curr_Factors:  [1.02095277e+02 3.80365253e-02]
mat_Sqrt:  [[ 1.99115958e+01  0.00000000e+00]
 [-7.80118199e-03  1.78747535e-02]]
grads:  [-0.00979724 -7.02002757]
Stock Position:  -0.00979723693362544
Bond Position:  [5.4962563]


portfolio before change:  [4.47471545]
curr_Stock_Price:  104.40852756152835
curr_Factors:  [1.04408528e+02 3.72424375e-02]
mat_Sqrt:  [[ 2.01490707e+01  0.00000000e+00]
 [-7.71931992e-03  1.76871839e-02]]
grads:  [-1.99228063e-02 -3.28233803e+01]
Stock Position:  -0.019922806286949993
Bond Position:  [6.55482632]


portfolio before change:  [4.53626978]
curr_Stock_Price:  101.40114939295225
curr_Factors:  [1.01401149e+02 3.86057826e-02]
mat_Sqrt:  [[ 1.99236571e+01  0.00000000e+00]
 [-7.85934171e-03  1.80080141e-02]]
grads:  [ 4.68489457e-03 -1.19057929e+01]
Stock Position:  0.004684894567207791
Bond Position:  [4.06121608]


portfolio before change:  [4.52891485]
curr_Stock_Price:  99.61447953275143
curr_Factors:  [9.96144795e+01 3.98125432e-02]
mat_Sqrt:  [[ 1.98761575e+01  0.00000000e+00]
 [-7.98123230e-03  1.82873006e-02]]
grads:  [-5.04957564e-04 -6.27262808e+00]
Stock Position:  -0.0005049575644420544
Bond Position:  [4.57921593]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.52924166]
Stock Price:  101.23468071296595
PL:  [3.29456095]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [-1.33373754e-02 -7.27296416e-03]
 [ 8.19301955e-02 -1.05648801e-02]
 [ 7.35946791e-01 -2.88627462e-01]
 [-1.01878154e-01 -9.14344043e-02]
 [ 1.21984527e-02 -1.50114142e-02]
 [ 4.08215375e-02 -5.50639142e-02]
 [-4.92126822e-02 -1.08043749e-01]
 [-1.26433597e+00  7.13016707e-01]
 [ 6.58927108e-02 -3.92681435e-02]
 [ 1.76401548e-02 -7.65518295e-02]
 [ 1.14527129e-01  3.28704308e-01]
 [ 1.02588942e-01 -1.17359496e-01]
 [ 2.36612998e-02  8.46937913e-02]
 [-1.11577813e-01 -1.80967173e-01]
 [ 1.50644810e-01  2.27176704e-01]
 [-1.67941505e-02 -9.57620336e-02]
 [-2.01089795e-01 -2.41970937e-01]
 [ 5.07919860e-01 -5.17031026e-01]
 [-4.42388578e-01 -2.38506809e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [32.37338773]
curr_Stock_Price:  104.48088588255378
curr_Factors:  [1.04480886e+02 3.59941346e-02]
mat_Sqrt:  [[ 1.98222393e+01  0.00000000e+00]
 [-7.58884809e-03  1.73882354e-02]]
grads:  [-0.00083298 -0.41826925]
Stock Position:  -0.0008329814280555691
Bond Position:  [32.46041837]


portfolio before change:  [32.38451709]
curr_Stock_Price:  100.86346387271954
curr_Factors:  [1.00863464e+02 3.87093034e-02]
mat_Sqrt:  [[ 1.98445638e+01  0.00000000e+00]
 [-7.86987201e-03  1.80321421e-02]]
grads:  [ 0.00389625 -0.58589157]
Stock Position:  0.0038962460784197073
Bond Position:  [31.99152822]


portfolio before change:  [32.39305599]
curr_Stock_Price:  101.00206234341982
curr_Factors:  [1.01002062e+02 3.84183219e-02]
mat_Sqrt:  [[ 1.97970025e+01  0.00000000e+00]
 [-7.84023692e-03  1.79642396e-02]]
grads:  [  0.03081171 -16.06677874]
Stock Position:  0.030811706990511403
Bond Position:  [29.28101004]


portfolio before change:  [32.3372001]
curr_Stock_Price:  98.95163844445874
curr_Factors:  [9.89516384e+01 3.89127859e-02]
mat_Sqrt:  [[ 1.95195208e+01  0.00000000e+00]
 [-7.89052960e-03  1.80794746e-02]]
grads:  [-0.00726367 -5.05735959]
Stock Position:  -0.007263672156961036
Bond Position:  [33.05595236]


portfolio before change:  [32.3291651]
curr_Stock_Price:  101.19568432513014
curr_Factors:  [1.01195684e+02 4.04721012e-02]
mat_Sqrt:  [[ 2.03582230e+01  0.00000000e+00]
 [-8.04707164e-03  1.84381574e-02]]
grads:  [ 2.77378554e-04 -8.14149365e-01]
Stock Position:  0.00027737855403653225
Bond Position:  [32.30109559]


portfolio before change:  [32.33680715]
curr_Stock_Price:  99.63019528236494
curr_Factors:  [9.96301953e+01 4.01494014e-02]
mat_Sqrt:  [[ 1.99632166e+01  0.00000000e+00]
 [-8.01492622e-03  1.83645030e-02]]
grads:  [ 8.41030555e-04 -2.99838847e+00]
Stock Position:  0.000841030555245423
Bond Position:  [32.25301512]


portfolio before change:  [32.34427024]
curr_Stock_Price:  98.9153874832094
curr_Factors:  [9.89153875e+01 3.99913763e-02]
mat_Sqrt:  [[ 1.97809448e+01  0.00000000e+00]
 [-7.99913758e-03  1.83283267e-02]]
grads:  [-4.87170057e-03 -5.89490524e+00]
Stock Position:  -0.004871700570890348
Bond Position:  [32.82615639]


portfolio before change:  [32.35594322]
curr_Stock_Price:  98.20405176602917
curr_Factors:  [9.82040518e+01 3.96405554e-02]
mat_Sqrt:  [[ 1.95523639e+01  0.00000000e+00]
 [-7.96397442e-03  1.82477578e-02]]
grads:  [-0.04874858 39.07420923]
Stock Position:  -0.048748579765224634
Bond Position:  [37.14325127]


portfolio before change:  [32.37669099]
curr_Stock_Price:  97.96895158094269
curr_Factors:  [9.79689516e+01 4.10280382e-02]
mat_Sqrt:  [[ 1.98439825e+01  0.00000000e+00]
 [-8.10215164e-03  1.85643616e-02]]
grads:  [ 0.0024569  -2.11524341]
Stock Position:  0.002456900367532024
Bond Position:  [32.13599104]


portfolio before change:  [32.38095814]
curr_Stock_Price:  96.4353722812465
curr_Factors:  [9.64353723e+01 4.21228822e-02]
mat_Sqrt:  [[ 1.97922606e+01  0.00000000e+00]
 [-8.20954393e-03  1.88104282e-02]]
grads:  [-7.96766117e-04 -4.06964842e+00]
Stock Position:  -0.0007967661166721887
Bond Position:  [32.45779458]


portfolio before change:  [32.38944782]
curr_Stock_Price:  95.96570373556219
curr_Factors:  [9.59657037e+01 4.19769886e-02]
mat_Sqrt:  [[ 1.96617284e+01  0.00000000e+00]
 [-8.19531463e-03  1.87778248e-02]]
grads:  [1.31211990e-02 1.75049193e+01]
Stock Position:  0.013121198973232894
Bond Position:  [31.13026273]


portfolio before change:  [32.3646484]
curr_Stock_Price:  93.48247356679249
curr_Factors:  [9.34824736e+01 4.17160203e-02]
mat_Sqrt:  [[ 1.90933279e+01  0.00000000e+00]
 [-8.16980003e-03  1.87193635e-02]]
grads:  [ 2.69041934e-03 -6.26941699e+00]
Stock Position:  0.0026904193386707888
Bond Position:  [32.11314135]


portfolio before change:  [32.36397158]
curr_Stock_Price:  90.24650418008872
curr_Factors:  [9.02465042e+01 4.44208241e-02]
mat_Sqrt:  [[ 1.90205773e+01  0.00000000e+00]
 [-8.43049931e-03  1.93167006e-02]]
grads:  [3.18732181e-03 4.38448537e+00]
Stock Position:  0.003187321805705329
Bond Position:  [32.07632693]


portfolio before change:  [32.37699913]
curr_Stock_Price:  91.81756084047831
curr_Factors:  [9.18175608e+01 4.29776392e-02]
mat_Sqrt:  [[ 1.90347435e+01  0.00000000e+00]
 [-8.29241960e-03  1.90003203e-02]]
grads:  [-0.01001108 -9.52442751]
Stock Position:  -0.01001108117631188
Bond Position:  [33.29619218]


portfolio before change:  [32.38280432]
curr_Stock_Price:  92.06927169524349
curr_Factors:  [9.20692717e+01 4.37106501e-02]
mat_Sqrt:  [[ 1.92490075e+01  0.00000000e+00]
 [-8.36283685e-03  1.91616664e-02]]
grads:  [ 0.01297692 11.85579054]
Stock Position:  0.012976921127652422
Bond Position:  [31.18802864]


portfolio before change:  [32.38778652]
curr_Stock_Price:  91.8522879735334
curr_Factors:  [9.18522880e+01 4.38664453e-02]
mat_Sqrt:  [[ 1.92378352e+01  0.00000000e+00]
 [-8.37772717e-03  1.91957845e-02]]
grads:  [-3.04546368e-03 -4.98870124e+00]
Stock Position:  -0.0030454636779321726
Bond Position:  [32.66751933]


portfolio before change:  [32.39448393]
curr_Stock_Price:  92.33513461766705
curr_Factors:  [9.23351346e+01 4.48797407e-02]
mat_Sqrt:  [[ 1.95610497e+01  0.00000000e+00]
 [-8.47393563e-03  1.94162257e-02]]
grads:  [ -0.01567884 -12.46230553]
Stock Position:  -0.015678840071745737
Bond Position:  [33.84219174]


portfolio before change:  [32.43750743]
curr_Stock_Price:  90.13076915804004
curr_Factors:  [9.01307692e+01 4.65045457e-02]
mat_Sqrt:  [[ 1.94366216e+01  0.00000000e+00]
 [-8.62596506e-03  1.97645689e-02]]
grads:  [ 1.45225351e-02 -2.61594892e+01]
Stock Position:  0.014522535119175691
Bond Position:  [31.12858017]


portfolio before change:  [32.42593514]
curr_Stock_Price:  88.79798483824436
curr_Factors:  [8.87979848e+01 4.65375695e-02]
mat_Sqrt:  [[ 1.91560058e+01  0.00000000e+00]
 [-8.62902725e-03  1.97715853e-02]]
grads:  [ -0.02852795 -12.06311004]
Stock Position:  -0.02852794519774002
Bond Position:  [34.95915918]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [32.41417928]
Stock Price:  89.51646425182184
PL:  [32.41417928]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.51884724e-02  2.78044178e-02]
 [-1.07794339e-01  9.95715794e-02]
 [ 8.97047360e-01 -3.37795952e-01]
 [ 4.48001176e-01 -5.29782749e-02]
 [ 3.03085154e-01 -3.30410794e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-8.29878559e-01  5.60906030e-03]
 [-1.48929964e+00  7.40882115e-01]
 [ 3.41876313e-02 -8.15148009e-02]
 [ 1.52189387e-01  5.71720659e-01]
 [-6.49262136e-01 -1.60821981e-01]
 [-4.06678261e-02 -5.84202439e-02]
 [-4.76146550e-02 -9.83068108e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.14931712e-01 -6.11340779e-02]
 [ 2.70812129e-02 -3.10401939e-02]
 [-1.27597167e-01 -6.51886422e-01]
 [-4.16297574e-01  5.64586454e-02]
 [-1.22607940e-01 -8.91262236e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.16280828]
curr_Stock_Price:  100.83418702364055
curr_Factors:  [1.00834187e+02 3.88883863e-02]
mat_Sqrt:  [[ 1.98846413e+01  0.00000000e+00]
 [-7.88805540e-03  1.80738055e-02]]
grads:  [1.37409142e-03 1.53838204e+00]
Stock Position:  0.0013740914245608698
Bond Position:  [8.02425289]


portfolio before change:  [8.16689585]
curr_Stock_Price:  102.34882668513512
curr_Factors:  [1.02348827e+02 3.85614672e-02]
mat_Sqrt:  [[ 2.00983148e+01  0.00000000e+00]
 [-7.85482957e-03  1.79976755e-02]]
grads:  [-3.20115093e-03  5.53246886e+00]
Stock Position:  -0.003201150932795569
Bond Position:  [8.49452989]


portfolio before change:  [8.16483238]
curr_Stock_Price:  103.65690799848116
curr_Factors:  [1.03656908e+02 3.77429387e-02]
mat_Sqrt:  [[ 2.01379893e+01  0.00000000e+00]
 [-7.77101678e-03  1.78056363e-02]]
grads:  [  0.03722423 -18.97129349]
Stock Position:  0.03722422873350238
Bond Position:  [4.30628393]


portfolio before change:  [8.20054005]
curr_Stock_Price:  104.58724192571366
curr_Factors:  [1.04587242e+02 3.84131224e-02]
mat_Sqrt:  [[ 2.04983316e+01  0.00000000e+00]
 [-7.83970636e-03  1.79630239e-02]]
grads:  [ 0.02072752 -2.94929602]
Stock Position:  0.02072751913515576
Bond Position:  [6.03270599]


portfolio before change:  [8.21435569]
curr_Stock_Price:  105.18100682306546
curr_Factors:  [1.05181007e+02 3.91490735e-02]
mat_Sqrt:  [[ 2.08112453e+01  0.00000000e+00]
 [-7.91444993e-03  1.81342829e-02]]
grads:  [ 0.01387062 -1.82202293]
Stock Position:  0.013870618515130969
Bond Position:  [6.75543007]


portfolio before change:  [8.21830739]
curr_Stock_Price:  105.3441308111815
curr_Factors:  [1.05344131e+02 3.89522959e-02]
mat_Sqrt:  [[ 2.07910716e+01  0.00000000e+00]
 [-7.89453441e-03  1.80886507e-02]]
grads:  [-2.78784166e-05 -1.06979655e+00]
Stock Position:  -2.7878416610880955e-05
Bond Position:  [8.22124421]


portfolio before change:  [8.22027463]
curr_Stock_Price:  108.51234036871713
curr_Factors:  [1.08512340e+02 3.72488698e-02]
mat_Sqrt:  [[ 2.09428451e+01  0.00000000e+00]
 [-7.71998651e-03  1.76887113e-02]]
grads:  [-0.03950899  0.3170983 ]
Stock Position:  -0.039508985582782756
Bond Position:  [12.50748712]


portfolio before change:  [8.34017339]
curr_Stock_Price:  105.55677216025613
curr_Factors:  [1.05556772e+02 3.88411149e-02]
mat_Sqrt:  [[ 2.08032863e+01  0.00000000e+00]
 [-7.88325973e-03  1.80628172e-02]]
grads:  [-0.05604654 41.01697461]
Stock Position:  -0.05604653798638671
Bond Position:  [14.25626503]


portfolio before change:  [8.39679969]
curr_Stock_Price:  104.61002713137879
curr_Factors:  [1.04610027e+02 3.82525302e-02]
mat_Sqrt:  [[ 2.04598949e+01  0.00000000e+00]
 [-7.82330163e-03  1.79254359e-02]]
grads:  [-6.78568702e-05 -4.54743757e+00]
Stock Position:  -6.785687021599911e-05
Bond Position:  [8.4038982]


portfolio before change:  [8.39885119]
curr_Stock_Price:  105.34289589485996
curr_Factors:  [1.05342896e+02 3.67953600e-02]
mat_Sqrt:  [[ 2.02069972e+01  0.00000000e+00]
 [-7.67284667e-03  1.75807003e-02]]
grads:  [1.98796850e-02 3.25197886e+01]
Stock Position:  0.01987968498288862
Bond Position:  [6.30466761]


portfolio before change:  [8.45493541]
curr_Stock_Price:  108.08478327520622
curr_Factors:  [1.08084783e+02 3.65681564e-02]
mat_Sqrt:  [[ 2.06688393e+01  0.00000000e+00]
 [-7.64912088e-03  1.75263377e-02]]
grads:  [-0.03480847 -9.17601745]
Stock Position:  -0.03480846660918241
Bond Position:  [12.21720098]


portfolio before change:  [8.50410306]
curr_Stock_Price:  106.76002053625326
curr_Factors:  [1.06760021e+02 3.80427918e-02]
mat_Sqrt:  [[ 2.08230738e+01  0.00000000e+00]
 [-7.80182459e-03  1.78762259e-02]]
grads:  [-3.17746128e-03 -3.26804127e+00]
Stock Position:  -0.003177461282680772
Bond Position:  [8.84332889]


portfolio before change:  [8.50424614]
curr_Stock_Price:  107.41086103736968
curr_Factors:  [1.07410861e+02 3.95740281e-02]
mat_Sqrt:  [[ 2.13674810e+01  0.00000000e+00]
 [-7.95728880e-03  1.82324391e-02]]
grads:  [-4.23630958e-03 -5.39186283e+00]
Stock Position:  -0.004236309583434555
Bond Position:  [8.9592718]


portfolio before change:  [8.51464865]
curr_Stock_Price:  105.48408779162399
curr_Factors:  [1.05484088e+02 4.13372275e-02]
mat_Sqrt:  [[ 2.14465591e+01  0.00000000e+00]
 [-8.13262344e-03  1.86341813e-02]]
grads:  [7.09844133e-03 7.97341656e+00]
Stock Position:  0.007098441333324419
Bond Position:  [7.76587604]


portfolio before change:  [8.52534683]
curr_Stock_Price:  106.71766354436214
curr_Factors:  [1.06717664e+02 4.26194484e-02]
mat_Sqrt:  [[ 2.20313049e+01  0.00000000e+00]
 [-8.25779132e-03  1.89209769e-02]]
grads:  [-0.0064278  -3.23102122]
Stock Position:  -0.006427799543040336
Bond Position:  [9.21130658]


portfolio before change:  [8.51964734]
curr_Stock_Price:  107.96266289796573
curr_Factors:  [1.07962663e+02 4.14846016e-02]
mat_Sqrt:  [[ 2.19895858e+01  0.00000000e+00]
 [-8.14710762e-03  1.86673687e-02]]
grads:  [ 6.15480517e-04 -1.66280500e+00]
Stock Position:  0.0006154805171445664
Bond Position:  [8.45319842]


portfolio before change:  [8.52164025]
curr_Stock_Price:  107.76663356439465
curr_Factors:  [1.07766634e+02 4.07159790e-02]
mat_Sqrt:  [[ 2.17453678e+01  0.00000000e+00]
 [-8.07128034e-03  1.84936266e-02]]
grads:  [-1.89513340e-02 -3.52492476e+01]
Stock Position:  -0.018951333962620994
Bond Position:  [10.56396171]


portfolio before change:  [8.51945129]
curr_Stock_Price:  108.02151167090318
curr_Factors:  [1.08021512e+02 3.84568876e-02]
mat_Sqrt:  [[ 2.11834805e+01  0.00000000e+00]
 [-7.84417110e-03  1.79732539e-02]]
grads:  [-0.01848879  3.14125899]
Stock Position:  -0.01848879373287803
Bond Position:  [10.51663874]


portfolio before change:  [8.45539937]
curr_Stock_Price:  111.62809651900216
curr_Factors:  [1.11628097e+02 3.75711106e-02]
mat_Sqrt:  [[ 2.16371739e+01  0.00000000e+00]
 [-7.75330748e-03  1.77650592e-02]]
grads:  [-0.00746427 -5.01693929]
Stock Position:  -0.007464274849034607
Bond Position:  [9.28862217]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.45792453]
Stock Price:  111.60093835050276
PL:  [-3.14301382]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.47145567e-02  2.72216579e-02]
 [ 6.67022575e-02 -2.04286455e-02]
 [ 7.05553755e-01 -2.79351395e-01]
 [ 2.73619118e-01 -9.54569732e-02]
 [ 1.20598407e-01 -8.21468036e-03]
 [ 2.65422471e-02 -7.72954989e-02]
 [-7.81612006e-02 -1.49620123e-01]
 [-1.31118681e+00  7.41434133e-01]
 [ 7.81363043e-02 -7.58531408e-02]
 [ 2.92187728e-02 -6.68433109e-02]
 [-1.17327563e-02  8.45046050e-02]
 [ 4.90432593e-02 -8.63337384e-03]
 [ 1.63992299e-01 -2.85513928e-02]
 [-8.12948443e-03  3.89526346e-03]
 [-6.96122908e-02 -3.27402859e-02]
 [-1.43622366e-01 -1.40336989e-01]
 [-1.91788833e-01 -3.71527500e-01]
 [ 2.81955228e-01 -3.06314262e-01]
 [-1.12093474e-01 -1.53745167e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.56495931]
curr_Stock_Price:  100.89476069569952
curr_Factors:  [1.00894761e+02 3.83587530e-02]
mat_Sqrt:  [[ 1.97606331e+01  0.00000000e+00]
 [-7.83415629e-03  1.79503071e-02]]
grads:  [1.34586084e-03 1.51650096e+00]
Stock Position:  0.0013458608363747372
Bond Position:  [8.429169]


portfolio before change:  [8.56589757]
curr_Stock_Price:  100.0259496298878
curr_Factors:  [1.00025950e+02 3.55258079e-02]
mat_Sqrt:  [[ 1.88531822e+01  0.00000000e+00]
 [-7.53931646e-03  1.72747442e-02]]
grads:  [ 0.00306508 -1.18257297]
Stock Position:  0.0030650775576853855
Bond Position:  [8.25931027]


portfolio before change:  [8.5703261]
curr_Stock_Price:  100.79703946687249
curr_Factors:  [1.00797039e+02 3.58759443e-02]
mat_Sqrt:  [[ 1.90919130e+01  0.00000000e+00]
 [-7.57637848e-03  1.73596639e-02]]
grads:  [  0.03056974 -16.09198175]
Stock Position:  0.03056973965206655
Bond Position:  [5.48898685]


portfolio before change:  [8.61220635]
curr_Stock_Price:  102.12213514622482
curr_Factors:  [1.02122135e+02 3.54762412e-02]
mat_Sqrt:  [[ 1.92348448e+01  0.00000000e+00]
 [-7.53405507e-03  1.72626888e-02]]
grads:  [ 0.01205927 -5.52967004]
Stock Position:  0.012059274855426601
Bond Position:  [7.38068745]


portfolio before change:  [8.58602431]
curr_Stock_Price:  99.79799505703143
curr_Factors:  [9.97979951e+01 3.53525301e-02]
mat_Sqrt:  [[ 1.87642870e+01  0.00000000e+00]
 [-7.52090740e-03  1.72325637e-02]]
grads:  [ 0.00623595 -0.4766952 ]
Stock Position:  0.006235953788511786
Bond Position:  [7.96368862]


portfolio before change:  [8.58265029]
curr_Stock_Price:  98.93763083176164
curr_Factors:  [9.89376308e+01 3.34666153e-02]
mat_Sqrt:  [[ 1.80995344e+01  0.00000000e+00]
 [-7.31755318e-03  1.67666207e-02]]
grads:  [-3.97373440e-04 -4.61008216e+00]
Stock Position:  -0.0003973734402633477
Bond Position:  [8.62196547]


portfolio before change:  [8.58425183]
curr_Stock_Price:  100.33234734805816
curr_Factors:  [1.00332347e+02 3.18343971e-02]
mat_Sqrt:  [[ 1.79014944e+01  0.00000000e+00]
 [-7.13687854e-03  1.63526431e-02]]
grads:  [-8.01389941e-03 -9.14959876e+00]
Stock Position:  -0.008013899413083399
Bond Position:  [9.38830517]


portfolio before change:  [8.58520809]
curr_Stock_Price:  100.50593341938871
curr_Factors:  [1.00505933e+02 2.96817762e-02]
mat_Sqrt:  [[ 1.73155641e+01  0.00000000e+00]
 [-6.89135995e-03  1.57900893e-02]]
grads:  [-0.0570353  46.95566435]
Stock Position:  -0.057035301682889526
Bond Position:  [14.31759433]


portfolio before change:  [8.57021065]
curr_Stock_Price:  100.83164905187928
curr_Factors:  [1.00831649e+02 2.97443032e-02]
mat_Sqrt:  [[ 1.73899675e+01  0.00000000e+00]
 [-6.89861473e-03  1.58067121e-02]]
grads:  [ 2.58949763e-03 -4.79879309e+00]
Stock Position:  0.002589497630302455
Bond Position:  [8.30910733]


portfolio before change:  [8.56913658]
curr_Stock_Price:  99.61457501556606
curr_Factors:  [9.9614575e+01 2.9022485e-02]
mat_Sqrt:  [[ 1.69703260e+01  0.00000000e+00]
 [-6.81439476e-03  1.56137399e-02]]
grads:  [ 2.70826824e-06 -4.28105703e+00]
Stock Position:  2.7082682402022354e-06
Bond Position:  [8.56886679]


portfolio before change:  [8.57127765]
curr_Stock_Price:  99.09309065128922
curr_Factors:  [9.90930907e+01 3.02635250e-02]
mat_Sqrt:  [[ 1.72386452e+01  0.00000000e+00]
 [-6.95856595e-03  1.59440776e-02]]
grads:  [1.45881980e-03 5.30006233e+00]
Stock Position:  0.0014588198039039559
Bond Position:  [8.42671869]


portfolio before change:  [8.5733856]
curr_Stock_Price:  99.09378075817239
curr_Factors:  [9.90937808e+01 2.87090070e-02]
mat_Sqrt:  [[ 1.67901851e+01  0.00000000e+00]
 [-6.77749298e-03  1.55291873e-02]]
grads:  [ 0.00269654 -0.55594499]
Stock Position:  0.002696536447842152
Bond Position:  [8.30617561]


portfolio before change:  [8.57589386]
curr_Stock_Price:  99.25378569840957
curr_Factors:  [9.92537857e+01 2.83184370e-02]
mat_Sqrt:  [[ 1.67025092e+01  0.00000000e+00]
 [-6.73123311e-03  1.54231926e-02]]
grads:  [ 0.00907238 -1.85119862]
Stock Position:  0.009072376316646437
Bond Position:  [7.67542617]


portfolio before change:  [8.57717981]
curr_Stock_Price:  99.18399756295318
curr_Factors:  [9.91839976e+01 2.67661215e-02]
mat_Sqrt:  [[ 1.62268541e+01  0.00000000e+00]
 [-6.54414199e-03  1.49945130e-02]]
grads:  [-0.00039622  0.25977926]
Stock Position:  -0.00039622295570192326
Bond Position:  [8.61647879]


portfolio before change:  [8.57925797]
curr_Stock_Price:  99.37639676151987
curr_Factors:  [9.93763968e+01 2.66277206e-02]
mat_Sqrt:  [[ 1.62162429e+01  0.00000000e+00]
 [-6.52720101e-03  1.49556963e-02]]
grads:  [-0.00517391 -2.18915155]
Stock Position:  -0.005173906396838587
Bond Position:  [9.09342214]


portfolio before change:  [8.59161285]
curr_Stock_Price:  97.42791835723992
curr_Factors:  [9.74279184e+01 2.75633925e-02]
mat_Sqrt:  [[ 1.61752037e+01  0.00000000e+00]
 [-6.64089061e-03  1.52161919e-02]]
grads:  [-0.01266571 -9.22287188]
Stock Position:  -0.012665710587705005
Bond Position:  [9.82560667]


portfolio before change:  [8.5898127]
curr_Stock_Price:  97.76401145993715
curr_Factors:  [9.77640115e+01 2.76858910e-02]
mat_Sqrt:  [[ 1.62670299e+01  0.00000000e+00]
 [-6.65563113e-03  1.52499667e-02]]
grads:  [-2.17579195e-02 -2.43625122e+01]
Stock Position:  -0.021757919496658177
Bond Position:  [10.7169542]


portfolio before change:  [8.63013401]
curr_Stock_Price:  96.03398722550855
curr_Factors:  [9.60339872e+01 2.89286807e-02]
mat_Sqrt:  [[ 1.63338768e+01  0.00000000e+00]
 [-6.80337336e-03  1.55884867e-02]]
grads:  [ 9.07737496e-03 -1.96500320e+01]
Stock Position:  0.009077374955302385
Bond Position:  [7.7583975]


portfolio before change:  [8.63354445]
curr_Stock_Price:  96.19599471067836
curr_Factors:  [9.61959947e+01 2.93836656e-02]
mat_Sqrt:  [[ 1.64895945e+01  0.00000000e+00]
 [-6.85666573e-03  1.57105949e-02]]
grads:  [-0.01086706 -9.78608185]
Stock Position:  -0.010867057178983864
Bond Position:  [9.67891183]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.62948704]
Stock Price:  96.79205658856642
PL:  [8.62948704]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.12139916e-02  1.23002996e-01]
 [ 4.24850761e-02 -5.68201331e-02]
 [ 6.66795547e-01 -2.67522247e-01]
 [-1.20373380e-01 -1.30972213e-01]
 [ 2.65886580e-01 -8.11589224e-03]
 [ 3.00114002e-02 -7.20598942e-02]
 [-4.03751138e-02 -5.53511889e-02]
 [-1.29925689e+00  6.58405950e-01]
 [ 4.28080448e-02 -6.28672850e-03]
 [ 1.54650480e-02 -8.70338968e-02]
 [ 1.14542923e-01  3.28821460e-01]
 [ 1.03996131e-01 -1.20555680e-01]
 [ 1.36125207e-01 -3.36845908e-02]
 [-6.83901655e-02 -8.72467481e-02]
 [ 2.82317633e-02  1.15378410e-02]
 [-1.41513213e-01 -1.30865837e-01]
 [-1.84956406e-01 -4.17466233e-01]
 [ 2.85932213e-01 -2.55316628e-01]
 [-2.16106154e-02 -1.30527571e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.60693214]
curr_Stock_Price:  99.84671350704801
curr_Factors:  [9.98467135e+01 4.11252834e-02]
mat_Sqrt:  [[ 2.02482841e+01  0.00000000e+00]
 [-8.11174786e-03  1.85863493e-02]]
grads:  [3.20505677e-03 6.61792125e+00]
Stock Position:  0.0032050567711350737
Bond Position:  [1.28691776]


portfolio before change:  [1.60177868]
curr_Stock_Price:  98.138403255894
curr_Factors:  [9.81384033e+01 4.13472612e-02]
mat_Sqrt:  [[ 1.99554884e+01  0.00000000e+00]
 [-8.13361039e-03  1.86364426e-02]]
grads:  [ 8.86309401e-04 -3.04887227e+00]
Stock Position:  0.0008863094013859369
Bond Position:  [1.51479769]


portfolio before change:  [1.60333072]
curr_Stock_Price:  99.46219550898864
curr_Factors:  [9.94621955e+01 4.17582081e-02]
mat_Sqrt:  [[ 2.03249258e+01  0.00000000e+00]
 [-8.17393008e-03  1.87288267e-02]]
grads:  [  0.0270623  -14.28398329]
Stock Position:  0.027062301345382272
Bond Position:  [-1.08834519]


portfolio before change:  [1.5763187]
curr_Stock_Price:  98.47410894282288
curr_Factors:  [9.84741089e+01 4.36423215e-02]
mat_Sqrt:  [[ 2.05719747e+01  0.00000000e+00]
 [-8.35629789e-03  1.91466838e-02]]
grads:  [-0.00862991 -6.84046459]
Stock Position:  -0.00862991240278066
Bond Position:  [2.42614164]


portfolio before change:  [1.5799454]
curr_Stock_Price:  98.12415369988135
curr_Factors:  [9.81241537e+01 4.29244813e-02]
mat_Sqrt:  [[ 2.03295821e+01  0.00000000e+00]
 [-8.28728967e-03  1.89885661e-02]]
grads:  [ 0.01290457 -0.42740943]
Stock Position:  0.012904569934032373
Bond Position:  [0.31369539]


portfolio before change:  [1.59251462]
curr_Stock_Price:  99.09208948387466
curr_Factors:  [9.90920895e+01 4.16108545e-02]
mat_Sqrt:  [[ 2.02135365e+01  0.00000000e+00]
 [-8.15949552e-03  1.86957529e-02]]
grads:  [-7.11461819e-05 -3.85434566e+00]
Stock Position:  -7.114618187585341e-05
Bond Position:  [1.59956465]


portfolio before change:  [1.59314624]
curr_Stock_Price:  95.83576638001281
curr_Factors:  [9.58357664e+01 4.29361245e-02]
mat_Sqrt:  [[ 1.98581616e+01  0.00000000e+00]
 [-8.28841355e-03  1.89911412e-02]]
grads:  [-0.00324966 -2.91457939]
Stock Position:  -0.0032496640114288195
Bond Position:  [1.90458028]


portfolio before change:  [1.59303204]
curr_Stock_Price:  96.01744786246834
curr_Factors:  [9.60174479e+01 4.19418964e-02]
mat_Sqrt:  [[ 1.96641052e+01  0.00000000e+00]
 [-8.19188832e-03  1.87699742e-02]]
grads:  [-0.0514595  35.07761626]
Stock Position:  -0.05145949766835288
Bond Position:  [6.53404168]


portfolio before change:  [1.58989229]
curr_Stock_Price:  96.11020948549098
curr_Factors:  [9.61102095e+01 4.50034253e-02]
mat_Sqrt:  [[ 2.03888302e+01  0.00000000e+00]
 [-8.48560431e-03  1.94429620e-02]]
grads:  [ 0.00196501 -0.32334212]
Stock Position:  0.0019650117829150982
Bond Position:  [1.40103459]


portfolio before change:  [1.5929645]
curr_Stock_Price:  97.49539891774472
curr_Factors:  [9.74953989e+01 4.52531167e-02]
mat_Sqrt:  [[ 2.07399817e+01  0.00000000e+00]
 [-8.50911198e-03  1.94968249e-02]]
grads:  [-1.08580899e-03 -4.46400362e+00]
Stock Position:  -0.0010858089944304327
Bond Position:  [1.69882589]


portfolio before change:  [1.59506809]
curr_Stock_Price:  95.94924900010167
curr_Factors:  [9.59492490e+01 4.69101576e-02]
mat_Sqrt:  [[ 2.07814107e+01  0.00000000e+00]
 [-8.66350115e-03  1.98505749e-02]]
grads:  [1.24174618e-02 1.65648331e+01]
Stock Position:  0.012417461807604474
Bond Position:  [0.40362195]


portfolio before change:  [1.56362551]
curr_Stock_Price:  93.4089960977912
curr_Factors:  [9.34089961e+01 4.83506733e-02]
mat_Sqrt:  [[ 2.05395048e+01  0.00000000e+00]
 [-8.79551461e-03  2.01530557e-02]]
grads:  [ 2.5015851e-03 -5.9820050e+00]
Stock Position:  0.0025015850962385633
Bond Position:  [1.32995496]


portfolio before change:  [1.57031665]
curr_Stock_Price:  95.95082822122832
curr_Factors:  [9.59508282e+01 4.89156784e-02]
mat_Sqrt:  [[ 2.12213383e+01  0.00000000e+00]
 [-8.84675565e-03  2.02704637e-02]]
grads:  [ 0.00572179 -1.66175729]
Stock Position:  0.005721790258917755
Bond Position:  [1.02130614]


portfolio before change:  [1.57329345]
curr_Stock_Price:  96.42645535613516
curr_Factors:  [9.64264554e+01 4.81616222e-02]
mat_Sqrt:  [[ 2.11615150e+01  0.00000000e+00]
 [-8.77830255e-03  2.01136179e-02]]
grads:  [-0.0050312 -4.3376954]
Stock Position:  -0.005031197828162059
Bond Position:  [2.05843402]


portfolio before change:  [1.56727659]
curr_Stock_Price:  97.72466116944544
curr_Factors:  [9.77246612e+01 4.69919233e-02]
mat_Sqrt:  [[ 2.11843812e+01  0.00000000e+00]
 [-8.67104822e-03  1.98678674e-02]]
grads:  [0.00157037 0.58072871]
Stock Position:  0.0015703687345028543
Bond Position:  [1.41381284]


portfolio before change:  [1.57102079]
curr_Stock_Price:  99.88383757158822
curr_Factors:  [9.98838376e+01 4.52453153e-02]
mat_Sqrt:  [[ 2.12462374e+01  0.00000000e+00]
 [-8.50837849e-03  1.94951442e-02]]
grads:  [-0.00934884 -6.71274013]
Stock Position:  -0.009348843425071777
Bond Position:  [2.50481915]


portfolio before change:  [1.57549579]
curr_Stock_Price:  99.47215977351438
curr_Factors:  [9.94721598e+01 4.65459838e-02]
mat_Sqrt:  [[ 2.14606393e+01  0.00000000e+00]
 [-8.62980730e-03  1.97733726e-02]]
grads:  [-1.71082326e-02 -2.11125457e+01]
Stock Position:  -0.017108232552490638
Bond Position:  [3.27728863]


portfolio before change:  [1.59536026]
curr_Stock_Price:  98.35895045320986
curr_Factors:  [9.83589505e+01 4.63684510e-02]
mat_Sqrt:  [[ 2.11799622e+01  0.00000000e+00]
 [-8.61333394e-03  1.97356274e-02]]
grads:  [ 8.23905633e-03 -1.29368387e+01]
Stock Position:  0.008239056329364785
Bond Position:  [0.78497532]


portfolio before change:  [1.59455146]
curr_Stock_Price:  98.23696312271387
curr_Factors:  [9.82369631e+01 4.79694879e-02]
mat_Sqrt:  [[ 2.15157986e+01  0.00000000e+00]
 [-8.76077512e-03  2.00734576e-02]]
grads:  [-3.65208465e-03 -6.50249568e+00]
Stock Position:  -0.003652084654873294
Bond Position:  [1.95332117]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.59400158]
Stock Price:  98.52125957344141
PL:  [1.59400158]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.31250980e-02  2.52671481e-02]
 [ 6.74661457e-02 -7.15317513e-03]
 [ 7.44481074e-01 -2.91232157e-01]
 [ 2.65419225e-01 -9.80141786e-02]
 [ 1.01062865e-01 -2.26574381e-02]
 [ 3.81023781e-02 -3.88515347e-02]
 [-7.51119847e-02 -1.45243596e-01]
 [-1.31624721e+00  7.40850855e-01]
 [ 6.18307681e-02 -7.81012029e-02]
 [ 9.47706542e-02  2.04323650e-01]
 [-1.18546870e-01 -9.59060883e-02]
 [ 2.29158187e-02 -9.03631002e-03]
 [ 1.04415438e-01 -1.74597317e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.16516192e-01 -6.20333551e-02]
 [-1.14501338e-01 -1.13075468e-01]
 [-1.61061771e-01 -5.38147331e-01]
 [ 2.49693901e-01 -2.28424249e-01]
 [ 1.30139934e-01  3.53123580e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.91426396]
curr_Stock_Price:  101.09799861210772
curr_Factors:  [1.01097999e+02 4.01348261e-02]
mat_Sqrt:  [[ 2.02536477e+01  0.00000000e+00]
 [-8.01347126e-03  1.83611693e-02]]
grads:  [1.19250547e-03 1.37611868e+00]
Stock Position:  0.0011925054656564446
Bond Position:  [9.79370404]


portfolio before change:  [9.91695361]
curr_Stock_Price:  101.30002598262736
curr_Factors:  [1.01300026e+02 3.89660679e-02]
mat_Sqrt:  [[ 1.99964476e+01  0.00000000e+00]
 [-7.89592988e-03  1.80918482e-02]]
grads:  [ 0.00321778 -0.39538112]
Stock Position:  0.0032177837554996634
Bond Position:  [9.59099203]


portfolio before change:  [9.91793504]
curr_Stock_Price:  100.85978151204834
curr_Factors:  [1.00859782e+02 4.05302407e-02]
mat_Sqrt:  [[ 2.03052160e+01  0.00000000e+00]
 [-8.05284950e-03  1.84513962e-02]]
grads:  [  0.03040484 -15.78374634]
Stock Position:  0.030404844711014324
Bond Position:  [6.85130905]


portfolio before change:  [9.95486554]
curr_Stock_Price:  102.01806585453662
curr_Factors:  [1.02018066e+02 3.96258394e-02]
mat_Sqrt:  [[ 2.03079611e+01  0.00000000e+00]
 [-7.96249603e-03  1.82443704e-02]]
grads:  [ 0.0109633  -5.37229712]
Stock Position:  0.010963302999388842
Bond Position:  [8.83641057]


portfolio before change:  [9.95784509]
curr_Stock_Price:  102.08831561151749
curr_Factors:  [1.02088316e+02 3.78218473e-02]
mat_Sqrt:  [[ 1.98539721e+01  0.00000000e+00]
 [-7.77913592e-03  1.78242396e-02]]
grads:  [ 0.00459225 -1.27115875]
Stock Position:  0.004592247232700263
Bond Position:  [9.48903031]


portfolio before change:  [9.95180661]
curr_Stock_Price:  100.25674246622323
curr_Factors:  [1.00256742e+02 3.71250896e-02]
mat_Sqrt:  [[ 1.93173409e+01  0.00000000e+00]
 [-7.70714885e-03  1.76592965e-02]]
grads:  [ 1.09467335e-03 -2.20006129e+00]
Stock Position:  0.0010946733464605976
Bond Position:  [9.84205822]


portfolio before change:  [9.95417249]
curr_Stock_Price:  100.17000991062977
curr_Factors:  [1.0017001e+02 3.9447860e-02]
mat_Sqrt:  [[ 1.98952518e+01  0.00000000e+00]
 [-7.94459414e-03  1.82033520e-02]]
grads:  [-6.96153473e-03 -7.97894781e+00]
Stock Position:  -0.006961534732770042
Bond Position:  [10.65150949]


portfolio before change:  [9.95210269]
curr_Stock_Price:  100.84988974157329
curr_Factors:  [1.00849890e+02 3.94794378e-02]
mat_Sqrt:  [[ 2.00383015e+01  0.00000000e+00]
 [-7.94777330e-03  1.82106364e-02]]
grads:  [-0.04955078 40.6823155 ]
Stock Position:  -0.04955077591016505
Bond Position:  [14.94929298]


portfolio before change:  [9.89473666]
curr_Stock_Price:  102.08304541730651
curr_Factors:  [1.02083045e+02 4.02707340e-02]
mat_Sqrt:  [[ 2.04855859e+01  0.00000000e+00]
 [-8.02702775e-03  1.83922311e-02]]
grads:  [ 1.35434782e-03 -4.24642352e+00]
Stock Position:  0.001354347820261681
Bond Position:  [9.75648071]


portfolio before change:  [9.8967447]
curr_Stock_Price:  101.76452575050554
curr_Factors:  [1.01764526e+02 4.04580795e-02]
mat_Sqrt:  [[ 2.04691140e+01  0.00000000e+00]
 [-8.04567754e-03  1.84349632e-02]]
grads:  [8.98645665e-03 1.10834856e+01]
Stock Position:  0.00898645665409237
Bond Position:  [8.9822422]


portfolio before change:  [9.89325127]
curr_Stock_Price:  101.1258682840186
curr_Factors:  [1.01125868e+02 3.85435190e-02]
mat_Sqrt:  [[ 1.98535395e+01  0.00000000e+00]
 [-7.85300137e-03  1.79934866e-02]]
grads:  [-0.00807935 -5.33004472]
Stock Position:  -0.008079351208810615
Bond Position:  [10.71028268]


portfolio before change:  [9.90083455]
curr_Stock_Price:  100.5187185928942
curr_Factors:  [1.00518719e+02 3.79245904e-02]
mat_Sqrt:  [[ 1.95752534e+01  0.00000000e+00]
 [-7.78969477e-03  1.78484330e-02]]
grads:  [ 0.00096919 -0.5062803 ]
Stock Position:  0.0009691853945455852
Bond Position:  [9.80341328]


portfolio before change:  [9.90424163]
curr_Stock_Price:  101.5050296850405
curr_Factors:  [1.01505030e+02 3.67011034e-02]
mat_Sqrt:  [[ 1.94458586e+01  0.00000000e+00]
 [-7.66301282e-03  1.75581681e-02]]
grads:  [ 0.00497769 -0.99439369]
Stock Position:  0.004977686426944898
Bond Position:  [9.39898142]


portfolio before change:  [9.91599181]
curr_Stock_Price:  103.39348574748705
curr_Factors:  [1.03393486e+02 3.70377525e-02]
mat_Sqrt:  [[ 1.98982778e+01  0.00000000e+00]
 [-7.69807794e-03  1.76385124e-02]]
grads:  [7.65076975e-03 8.42350453e+00]
Stock Position:  0.007650769749522483
Bond Position:  [9.12495206]


portfolio before change:  [9.9156371]
curr_Stock_Price:  103.04891512669987
curr_Factors:  [1.03048915e+02 3.88844908e-02]
mat_Sqrt:  [[ 2.03203710e+01  0.00000000e+00]
 [-7.88766032e-03  1.80729002e-02]]
grads:  [-0.0070663  -3.43239625]
Stock Position:  -0.007066296590023539
Bond Position:  [10.6438113]


portfolio before change:  [9.91539813]
curr_Stock_Price:  103.45935003527246
curr_Factors:  [1.03459350e+02 3.81601252e-02]
mat_Sqrt:  [[ 2.02103875e+01  0.00000000e+00]
 [-7.81384670e-03  1.79037720e-02]]
grads:  [-0.00810729 -6.31573437]
Stock Position:  -0.008107292243522708
Bond Position:  [10.75417332]


portfolio before change:  [9.92514106]
curr_Stock_Price:  102.58926386362405
curr_Factors:  [1.02589264e+02 3.74561498e-02]
mat_Sqrt:  [[ 1.98547069e+01  0.00000000e+00]
 [-7.74143654e-03  1.77378595e-02]]
grads:  [-1.99412927e-02 -3.03389105e+01]
Stock Position:  -0.019941292664929805
Bond Position:  [11.97090359]


portfolio before change:  [9.96314362]
curr_Stock_Price:  100.83363733510747
curr_Factors:  [1.00833637e+02 3.75886105e-02]
mat_Sqrt:  [[ 1.95494062e+01  0.00000000e+00]
 [-7.75511294e-03  1.77691960e-02]]
grads:  [ 7.67293819e-03 -1.28550695e+01]
Stock Position:  0.007672938186895416
Bond Position:  [9.18945335]


portfolio before change:  [9.97756885]
curr_Stock_Price:  102.41420256601364
curr_Factors:  [1.02414203e+02 3.64621829e-02]
mat_Sqrt:  [[ 1.95560672e+01  0.00000000e+00]
 [-7.63802937e-03  1.75009239e-02]]
grads:  [0.00744278 2.01774251]
Stock Position:  0.0074427802565707165
Bond Position:  [9.21532244]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.97923277]
Stock Price:  102.32818603461602
PL:  [7.65104673]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 9.55185608e-02 -9.79370477e-03]
 [ 4.23867563e-02 -5.69678796e-02]
 [ 5.67805298e-01 -2.37310057e-01]
 [-9.33529233e-02 -9.23756306e-02]
 [ 1.92968976e-01 -5.59311807e-03]
 [ 7.43299822e-03 -1.13698374e-01]
 [-1.93545664e-02 -6.51570859e-02]
 [-1.25969148e+00  7.23912291e-01]
 [ 7.31663648e-02 -4.96745929e-02]
 [ 2.21178270e-02 -8.29633245e-02]
 [-1.11150197e-01 -1.02836667e-01]
 [ 1.67809733e-02 -9.13092132e-03]
 [ 3.30760851e-02 -4.11230756e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15767392e-01 -6.16083706e-02]
 [-9.03079426e-02 -1.02823280e-01]
 [-1.70828251e-01 -4.89844022e-01]
 [ 2.76354943e-01 -2.38371633e-01]
 [-2.26836886e-02 -1.30801775e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.07078009]
curr_Stock_Price:  97.63589502758774
curr_Factors:  [9.76358950e+01 4.09573292e-02]
mat_Sqrt:  [[ 1.97594716e+01  0.00000000e+00]
 [-8.09516688e-03  1.85483575e-02]]
grads:  [ 0.00461775 -0.52800927]
Stock Position:  0.004617746848796114
Bond Position:  [-13.52163793]


portfolio before change:  [-13.07189379]
curr_Stock_Price:  98.12685611458741
curr_Factors:  [9.81268561e+01 4.13467598e-02]
mat_Sqrt:  [[ 1.99530194e+01  0.00000000e+00]
 [-8.13356107e-03  1.86363296e-02]]
grads:  [ 8.78259824e-04 -3.05681863e+00]
Stock Position:  0.000878259824008086
Bond Position:  [-13.15807466]


portfolio before change:  [-13.07508058]
curr_Stock_Price:  98.24428247049286
curr_Factors:  [9.82442825e+01 3.89511317e-02]
mat_Sqrt:  [[ 1.93895319e+01  0.00000000e+00]
 [-7.89441643e-03  1.80883804e-02]]
grads:  [  0.02394254 -13.11947509]
Stock Position:  0.023942542790990368
Bond Position:  [-15.42729852]


portfolio before change:  [-13.06040627]
curr_Stock_Price:  99.01828617815156
curr_Factors:  [9.90182862e+01 3.78575533e-02]
mat_Sqrt:  [[ 1.92660053e+01  0.00000000e+00]
 [-7.78280703e-03  1.78326512e-02]]
grads:  [-0.00693807 -5.18014006]
Stock Position:  -0.006938073117629987
Bond Position:  [-12.37341017]


portfolio before change:  [-13.06463823]
curr_Stock_Price:  99.1823403550349
curr_Factors:  [9.91823404e+01 3.66426406e-02]
mat_Sqrt:  [[ 1.89857489e+01  0.00000000e+00]
 [-7.65690701e-03  1.75441780e-02]]
grads:  [ 0.01003531 -0.31880195]
Stock Position:  0.01003531334224505
Bond Position:  [-14.0599641]


portfolio before change:  [-13.07902868]
curr_Stock_Price:  98.09866536948874
curr_Factors:  [9.80986654e+01 3.76903529e-02]
mat_Sqrt:  [[ 1.90448783e+01  0.00000000e+00]
 [-7.76560138e-03  1.77932281e-02]]
grads:  [-2.21524337e-03 -6.38998012e+00]
Stock Position:  -0.00221524336513388
Bond Position:  [-12.86171626]


portfolio before change:  [-13.08085654]
curr_Stock_Price:  97.47211090379284
curr_Factors:  [9.74721109e+01 3.90075805e-02]
mat_Sqrt:  [[ 1.92510702e+01  0.00000000e+00]
 [-7.90013473e-03  1.81014827e-02]]
grads:  [-2.48253471e-03 -3.59954413e+00]
Stock Position:  -0.0024825347099341807
Bond Position:  [-12.83887864]


portfolio before change:  [-13.08691784]
curr_Stock_Price:  98.62060665411651
curr_Factors:  [9.86206067e+01 3.66184352e-02]
mat_Sqrt:  [[ 1.88719840e+01  0.00000000e+00]
 [-7.65437759e-03  1.75383824e-02]]
grads:  [-0.050008   41.27588717]
Stock Position:  -0.050008004025555115
Bond Position:  [-8.15509815]


portfolio before change:  [-13.08572303]
curr_Stock_Price:  98.55594004397582
curr_Factors:  [9.85559400e+01 3.64245607e-02]
mat_Sqrt:  [[ 1.88096176e+01  0.00000000e+00]
 [-7.63408784e-03  1.74918927e-02]]
grads:  [ 2.73724837e-03 -2.83986381e+00]
Stock Position:  0.002737248371248658
Bond Position:  [-13.35549511]


portfolio before change:  [-13.08705151]
curr_Stock_Price:  99.2905489848423
curr_Factors:  [9.92905490e+01 3.56927751e-02]
mat_Sqrt:  [[ 1.87584984e+01  0.00000000e+00]
 [-7.55701264e-03  1.73152912e-02]]
grads:  [-7.51144147e-04 -4.79133290e+00]
Stock Position:  -0.0007511441468578129
Bond Position:  [-13.01246999]


portfolio before change:  [-13.09160099]
curr_Stock_Price:  101.01586146841825
curr_Factors:  [1.01015861e+02 3.66726440e-02]
mat_Sqrt:  [[ 1.93446414e+01  0.00000000e+00]
 [-7.66004115e-03  1.75513592e-02]]
grads:  [-0.00806589 -5.85918536]
Stock Position:  -0.008065892482466998
Bond Position:  [-12.27681791]


portfolio before change:  [-13.09768694]
curr_Stock_Price:  101.38982586976448
curr_Factors:  [1.01389826e+02 3.76040479e-02]
mat_Sqrt:  [[ 1.96612749e+01  0.00000000e+00]
 [-7.75670527e-03  1.77728445e-02]]
grads:  [ 0.00065082 -0.51375689]
Stock Position:  0.0006508180454612365
Bond Position:  [-13.16367327]


portfolio before change:  [-13.09977207]
curr_Stock_Price:  103.24317868414144
curr_Factors:  [1.03243179e+02 3.68395022e-02]
mat_Sqrt:  [[ 1.98161027e+01  0.00000000e+00]
 [-7.67744772e-03  1.75912427e-02]]
grads:  [ 7.63444949e-04 -2.33770157e+00]
Stock Position:  0.0007634449487153024
Bond Position:  [-13.17859255]


portfolio before change:  [-13.10355731]
curr_Stock_Price:  102.60112201273819
curr_Factors:  [1.02601122e+02 3.57261752e-02]
mat_Sqrt:  [[ 1.93930167e+01  0.00000000e+00]
 [-7.56054762e-03  1.73233909e-02]]
grads:  [7.85010109e-03 8.57673248e+00]
Stock Position:  0.007850101088834441
Bond Position:  [-13.90898649]


portfolio before change:  [-13.08981827]
curr_Stock_Price:  104.79430648546351
curr_Factors:  [1.04794306e+02 3.26881260e-02]
mat_Sqrt:  [[ 1.89466617e+01  0.00000000e+00]
 [-7.23194315e-03  1.65704634e-02]]
grads:  [-0.00752932 -3.71796304]
Stock Position:  -0.007529320551870419
Bond Position:  [-12.30078834]


portfolio before change:  [-13.08988053]
curr_Stock_Price:  104.39409487393128
curr_Factors:  [1.04394095e+02 3.25001576e-02]
mat_Sqrt:  [[ 1.88199587e+01  0.00000000e+00]
 [-7.21112004e-03  1.65227517e-02]]
grads:  [-0.007183   -6.22313293]
Stock Position:  -0.007182996680154585
Bond Position:  [-12.34001809]


portfolio before change:  [-13.07078485]
curr_Stock_Price:  101.30609847674778
curr_Factors:  [1.01306098e+02 3.48656395e-02]
mat_Sqrt:  [[ 1.89162222e+01  0.00000000e+00]
 [-7.46893722e-03  1.71134851e-02]]
grads:  [-2.03324799e-02 -2.86232769e+01]
Stock Position:  -0.020332479949604493
Bond Position:  [-11.01098063]


portfolio before change:  [-13.05178803]
curr_Stock_Price:  100.23638611536691
curr_Factors:  [1.00236386e+02 3.50043212e-02]
mat_Sqrt:  [[ 1.87536683e+01  0.00000000e+00]
 [-7.48377672e-03  1.71474866e-02]]
grads:  [ 9.18865742e-03 -1.39012578e+01]
Stock Position:  0.009188657416178645
Bond Position:  [-13.97282585]


portfolio before change:  [-13.07393688]
curr_Stock_Price:  98.20614374071269
curr_Factors:  [9.82061437e+01 3.69908633e-02]
mat_Sqrt:  [[ 1.88879964e+01  0.00000000e+00]
 [-7.69320358e-03  1.76273439e-02]]
grads:  [-4.22333113e-03 -7.42039048e+00]
Stock Position:  -0.004223331128481186
Bond Position:  [-12.65917982]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.07866261]
Stock Price:  98.57564922184147
PL:  [-13.07866261]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [-3.11477385e-03  1.25759872e-01]
 [ 5.53452098e-02 -3.74950355e-02]
 [ 6.12083753e-01 -2.50824005e-01]
 [-1.11300782e-01 -1.23781139e-01]
 [ 1.18647870e-01 -8.38026922e-03]
 [ 1.23723251e-02 -1.91007494e-02]
 [-1.21125586e-01 -1.82662530e-01]
 [-1.32549953e+00  7.41827515e-01]
 [ 7.42686922e-02 -7.65919817e-02]
 [ 1.36235976e-02 -9.59080393e-02]
 [-7.14459758e-03  1.00067563e-01]
 [ 1.67521742e-02 -9.13136546e-03]
 [ 1.53657992e-01 -2.23998134e-02]
 [ 4.74833186e-02  7.26988831e-02]
 [-1.10075280e-01 -5.28664055e-02]
 [-1.42682263e-01 -1.36115458e-01]
 [-1.90774911e-01 -3.85701211e-01]
 [ 2.88742784e-01 -2.60289351e-01]
 [-5.32228564e-02 -1.38639140e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.26359963]
curr_Stock_Price:  99.64437513883956
curr_Factors:  [9.96443751e+01 4.01462094e-02]
mat_Sqrt:  [[ 1.99652642e+01  0.00000000e+00]
 [-8.01460760e-03  1.83637730e-02]]
grads:  [2.59307032e-03 6.84825888e+00]
Stock Position:  0.0025930703152982704
Bond Position:  [0.00521476]


portfolio before change:  [0.26363434]
curr_Stock_Price:  99.65725902483264
curr_Factors:  [9.96572590e+01 4.03834406e-02]
mat_Sqrt:  [[ 2.00267556e+01  0.00000000e+00]
 [-8.03825261e-03  1.84179505e-02]]
grads:  [ 1.94644782e-03 -2.03578761e+00]
Stock Position:  0.0019464478230017956
Bond Position:  [0.06965669]


portfolio before change:  [0.26190717]
curr_Stock_Price:  98.7609658274895
curr_Factors:  [9.87609658e+01 4.04416701e-02]
mat_Sqrt:  [[ 1.98609432e+01  0.00000000e+00]
 [-8.04404576e-03  1.84312243e-02]]
grads:  [  0.02530671 -13.6086459 ]
Stock Position:  0.025306712655509767
Bond Position:  [-2.23740821]


portfolio before change:  [0.22479312]
curr_Stock_Price:  97.31650197102616
curr_Factors:  [9.73165020e+01 4.11889439e-02]
mat_Sqrt:  [[ 1.97504419e+01  0.00000000e+00]
 [-8.11802379e-03  1.86007293e-02]]
grads:  [-0.00837061 -6.65463905]
Stock Position:  -0.008370612709783815
Bond Position:  [1.03939187]


portfolio before change:  [0.20417289]
curr_Stock_Price:  99.81095567111966
curr_Factors:  [9.98109557e+01 4.09731446e-02]
mat_Sqrt:  [[ 2.02035581e+01  0.00000000e+00]
 [-8.09672967e-03  1.85519383e-02]]
grads:  [ 0.00569159 -0.45171933]
Stock Position:  0.005691592545075895
Bond Position:  [-0.3639104]


portfolio before change:  [0.21313127]
curr_Stock_Price:  101.40090845164136
curr_Factors:  [1.01400908e+02 3.94756995e-02]
mat_Sqrt:  [[ 2.01468319e+01  0.00000000e+00]
 [-7.94739700e-03  1.82097742e-02]]
grads:  [ 2.00332969e-04 -1.04892841e+00]
Stock Position:  0.00020033296928949964
Bond Position:  [0.19281732]


portfolio before change:  [0.21325092]
curr_Stock_Price:  101.75752790019612
curr_Factors:  [1.01757528e+02 3.78713581e-02]
mat_Sqrt:  [[ 1.98025896e+01  0.00000000e+00]
 [-7.78422591e-03  1.78359022e-02]]
grads:  [-1.01424134e-02 -1.02412835e+01]
Stock Position:  -0.010142413405988548
Bond Position:  [1.24531784]


portfolio before change:  [0.22053214]
curr_Stock_Price:  101.07032913727883
curr_Factors:  [1.01070329e+02 3.82732374e-02]
mat_Sqrt:  [[ 1.97729414e+01  0.00000000e+00]
 [-7.82541883e-03  1.79302871e-02]]
grads:  [-0.05066214 41.37287442]
Stock Position:  -0.05066213641799259
Bond Position:  [5.34097095]


portfolio before change:  [0.21527774]
curr_Stock_Price:  101.20040293987124
curr_Factors:  [1.01200403e+02 3.68698881e-02]
mat_Sqrt:  [[ 1.94320291e+01  0.00000000e+00]
 [-7.68061332e-03  1.75984960e-02]]
grads:  [ 2.10174710e-03 -4.35218907e+00]
Stock Position:  0.002101747104796774
Bond Position:  [0.00258008]


portfolio before change:  [0.20936568]
curr_Stock_Price:  98.38716964766161
curr_Factors:  [9.83871696e+01 4.05261671e-02]
mat_Sqrt:  [[ 1.98064313e+01  0.00000000e+00]
 [-8.05244481e-03  1.84504689e-02]]
grads:  [-1.42550175e-03 -5.19813560e+00]
Stock Position:  -0.0014255017451677168
Bond Position:  [0.34961676]


portfolio before change:  [0.2085923]
curr_Stock_Price:  98.99102305365173
curr_Factors:  [9.89910231e+01 4.00887984e-02]
mat_Sqrt:  [[ 1.98201680e+01  0.00000000e+00]
 [-8.00887492e-03  1.83506378e-02]]
grads:  [1.84299484e-03 5.45308367e+00]
Stock Position:  0.0018429948412962518
Bond Position:  [0.02615235]


portfolio before change:  [0.21303186]
curr_Stock_Price:  101.39636140775727
curr_Factors:  [1.01396361e+02 4.04604353e-02]
mat_Sqrt:  [[ 2.03956545e+01  0.00000000e+00]
 [-8.04591178e-03  1.84354999e-02]]
grads:  [ 0.00062596 -0.49531423]
Stock Position:  0.0006259627314417363
Bond Position:  [0.14956152]


portfolio before change:  [0.21225801]
curr_Stock_Price:  100.1003681730452
curr_Factors:  [1.00100368e+02 4.07321107e-02]
mat_Sqrt:  [[ 2.02024543e+01  0.00000000e+00]
 [-8.07287911e-03  1.84972898e-02]]
grads:  [ 0.007122   -1.21097813]
Stock Position:  0.007122001591793583
Bond Position:  [-0.50065697]


portfolio before change:  [0.21295672]
curr_Stock_Price:  100.2160501306322
curr_Factors:  [1.00216050e+02 4.21944244e-02]
mat_Sqrt:  [[ 2.05856609e+01  0.00000000e+00]
 [-8.21651259e-03  1.88263954e-02]]
grads:  [3.84790717e-03 3.86154022e+00]
Stock Position:  0.003847907172886502
Bond Position:  [-0.17266534]


portfolio before change:  [0.21227988]
curr_Stock_Price:  100.05137098369934
curr_Factors:  [1.00051371e+02 4.00054214e-02]
mat_Sqrt:  [[ 2.00116302e+01  0.00000000e+00]
 [-8.00054212e-03  1.83315449e-02]]
grads:  [-0.00665353 -2.88390344]
Stock Position:  -0.006653534462024902
Bond Position:  [0.87797512]


portfolio before change:  [0.22184089]
curr_Stock_Price:  98.64738211691481
curr_Factors:  [9.86473821e+01 4.08751475e-02]
mat_Sqrt:  [[ 1.99441362e+01  0.00000000e+00]
 [-8.08704123e-03  1.85297393e-02]]
grads:  [-0.0101327  -7.34578374]
Stock Position:  -0.010132698520297054
Bond Position:  [1.22140507]


portfolio before change:  [0.22332775]
curr_Stock_Price:  98.5307823964963
curr_Factors:  [9.85307824e+01 4.30546859e-02]
mat_Sqrt:  [[ 2.04447660e+01  0.00000000e+00]
 [-8.29984924e-03  1.90173437e-02]]
grads:  [-1.75648242e-02 -2.02815502e+01]
Stock Position:  -0.017564824167475037
Bond Position:  [1.95400362]


portfolio before change:  [0.23339803]
curr_Stock_Price:  97.98527600541178
curr_Factors:  [9.79852760e+01 4.23392066e-02]
mat_Sqrt:  [[ 2.01619335e+01  0.00000000e+00]
 [-8.23059722e-03  1.88586674e-02]]
grads:  [ 8.68682550e-03 -1.38021073e+01]
Stock Position:  0.00868682550043981
Bond Position:  [-0.61778296]


portfolio before change:  [0.22923446]
curr_Stock_Price:  97.52375973826078
curr_Factors:  [9.75237597e+01 4.12407107e-02]
mat_Sqrt:  [[ 1.98049389e+01  0.00000000e+00]
 [-8.12312361e-03  1.86124144e-02]]
grads:  [-5.74250385e-03 -7.44874562e+00]
Stock Position:  -0.005742503850799674
Bond Position:  [0.78926502]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.2226011]
Stock Price:  98.71325788615233
PL:  [0.2226011]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 8.71034857e-02  5.28290237e-03]
 [ 3.83171540e-02 -6.30833263e-02]
 [ 4.95777861e-01 -2.15327016e-01]
 [-9.51105230e-02 -1.00381585e-01]
 [ 3.12414330e-01 -1.15207395e-02]
 [-2.06058495e-01 -2.67233961e-01]
 [-5.61612799e-02 -6.14529620e-02]
 [-1.29457573e+00  6.68700420e-01]
 [ 5.85999021e-02 -2.88604420e-02]
 [ 1.72493539e-02 -7.84351401e-02]
 [ 1.12900559e-01  3.16639516e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.58665566e-01 -2.97949039e-02]
 [-7.81943362e-02 -1.08507403e-01]
 [ 8.98245534e-02  1.12598381e-01]
 [-1.42222364e-01 -1.39605286e-01]
 [-1.99336950e-01 -2.66379879e-01]
 [ 3.97922941e-01 -4.37244999e-01]
 [-3.19311746e-01 -2.06922487e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.02223996]
curr_Stock_Price:  97.7938305327521
curr_Factors:  [9.77938305e+01 4.02863163e-02]
mat_Sqrt:  [[ 1.96286412e+01  0.00000000e+00]
 [-8.02858058e-03  1.83957891e-02]]
grads:  [0.00455503 0.28717998]
Stock Position:  0.004555034266462862
Bond Position:  [-12.46769421]


portfolio before change:  [-12.02596159]
curr_Stock_Price:  97.66116019858221
curr_Factors:  [9.76611602e+01 3.98417218e-02]
mat_Sqrt:  [[ 1.94935497e+01  0.00000000e+00]
 [-7.98415649e-03  1.82940007e-02]]
grads:  [ 5.53277031e-04 -3.44830675e+00]
Stock Position:  0.0005532770308493831
Bond Position:  [-12.07999527]


portfolio before change:  [-12.02933751]
curr_Stock_Price:  97.01854192721493
curr_Factors:  [9.70185419e+01 3.97484895e-02]
mat_Sqrt:  [[ 1.93426092e+01  0.00000000e+00]
 [-7.97480929e-03  1.82725836e-02]]
grads:  [  0.02077287 -11.78415821]
Stock Position:  0.020772866874300303
Bond Position:  [-14.04469077]


portfolio before change:  [-12.0451893]
curr_Stock_Price:  96.42448901588874
curr_Factors:  [9.64244890e+01 3.95407538e-02]
mat_Sqrt:  [[ 1.91738718e+01  0.00000000e+00]
 [-7.95394280e-03  1.82247725e-02]]
grads:  [-0.00724531 -5.50797465]
Stock Position:  -0.007245309663781629
Bond Position:  [-11.34656402]


portfolio before change:  [-12.05103872]
curr_Stock_Price:  96.84026369122505
curr_Factors:  [9.68402637e+01 3.91430089e-02]
mat_Sqrt:  [[ 1.91594513e+01  0.00000000e+00]
 [-7.91383688e-03  1.81328783e-02]]
grads:  [ 0.01604358 -0.63535084]
Stock Position:  0.016043584078559686
Bond Position:  [-13.60470363]


portfolio before change:  [-12.06567674]
curr_Stock_Price:  96.13989536838562
curr_Factors:  [9.61398954e+01 3.98134545e-02]
mat_Sqrt:  [[ 1.91830905e+01  0.00000000e+00]
 [-7.98132365e-03  1.82875099e-02]]
grads:  [ -0.01682153 -14.61292228]
Stock Position:  -0.016821531295859005
Bond Position:  [-10.44845648]


portfolio before change:  [-12.05442839]
curr_Stock_Price:  95.31590479001272
curr_Factors:  [9.53159048e+01 3.83574252e-02]
mat_Sqrt:  [[ 1.86676693e+01  0.00000000e+00]
 [-7.83402069e-03  1.79499964e-02]]
grads:  [-0.0044452  -3.42356402]
Stock Position:  -0.0044452014921130215
Bond Position:  [-11.63072999]


portfolio before change:  [-12.0622155]
curr_Stock_Price:  96.41350576681559
curr_Factors:  [9.64135058e+01 3.94097134e-02]
mat_Sqrt:  [[ 1.91398933e+01  0.00000000e+00]
 [-7.94075194e-03  1.81945484e-02]]
grads:  [-0.05238958 36.75279018]
Stock Position:  -0.05238957838440274
Bond Position:  [-7.01115258]


portfolio before change:  [-12.11475006]
curr_Stock_Price:  97.38281216586577
curr_Factors:  [9.73828122e+01 3.95868535e-02]
mat_Sqrt:  [[ 1.93757179e+01  0.00000000e+00]
 [-7.95857812e-03  1.82353933e-02]]
grads:  [ 0.00237432 -1.58266079]
Stock Position:  0.0023743209257537086
Bond Position:  [-12.34596811]


portfolio before change:  [-12.11960879]
curr_Stock_Price:  96.63655579166596
curr_Factors:  [9.66365558e+01 3.97255810e-02]
mat_Sqrt:  [[ 1.92608998e+01  0.00000000e+00]
 [-7.97251087e-03  1.82673173e-02]]
grads:  [-8.81711025e-04 -4.29374160e+00]
Stock Position:  -0.0008817110245466149
Bond Position:  [-12.03440327]


portfolio before change:  [-12.12240018]
curr_Stock_Price:  96.38978112714949
curr_Factors:  [9.63897811e+01 3.99729669e-02]
mat_Sqrt:  [[ 1.92714408e+01  0.00000000e+00]
 [-7.99729623e-03  1.83241077e-02]]
grads:  [1.30292994e-02 1.72799419e+01]
Stock Position:  0.013029299442397687
Bond Position:  [-13.3782915]


portfolio before change:  [-12.11522728]
curr_Stock_Price:  97.19703060768036
curr_Factors:  [9.71970306e+01 3.93409023e-02]
mat_Sqrt:  [[ 1.92785850e+01  0.00000000e+00]
 [-7.93381646e-03  1.81786572e-02]]
grads:  [ 0.00249066 -0.47260822]
Stock Position:  0.0024906640286243282
Bond Position:  [-12.35731242]


portfolio before change:  [-12.11776393]
curr_Stock_Price:  97.4190844325988
curr_Factors:  [9.74190844e+01 3.88695141e-02]
mat_Sqrt:  [[ 1.92065163e+01  0.00000000e+00]
 [-7.88614117e-03  1.80694194e-02]]
grads:  [ 0.00758399 -1.64891318]
Stock Position:  0.007583988787376251
Bond Position:  [-12.85658917]


portfolio before change:  [-12.13648404]
curr_Stock_Price:  95.37457164127495
curr_Factors:  [9.53745716e+01 4.01040734e-02]
mat_Sqrt:  [[ 1.90997131e+01  0.00000000e+00]
 [-8.01040058e-03  1.83541335e-02]]
grads:  [-0.00657344 -5.91187826]
Stock Position:  -0.006573441635277106
Bond Position:  [-11.50954486]


portfolio before change:  [-12.13703376]
curr_Stock_Price:  95.02041545642379
curr_Factors:  [9.50204155e+01 3.86193582e-02]
mat_Sqrt:  [[ 1.86732302e+01  0.00000000e+00]
 [-7.86072345e-03  1.80111801e-02]]
grads:  [0.00744202 6.25158266]
Stock Position:  0.007442018029964264
Bond Position:  [-12.84417741]


portfolio before change:  [-12.13012922]
curr_Stock_Price:  96.37972266900469
curr_Factors:  [9.63797227e+01 3.85233712e-02]
mat_Sqrt:  [[ 1.89168062e+01  0.00000000e+00]
 [-7.85094860e-03  1.79887831e-02]]
grads:  [-0.01073919 -7.76068537]
Stock Position:  -0.010739186300467338
Bond Position:  [-11.09508942]


portfolio before change:  [-12.10019088]
curr_Stock_Price:  93.33363924711965
curr_Factors:  [9.33336392e+01 3.92135867e-02]
mat_Sqrt:  [[ 1.84823199e+01  0.00000000e+00]
 [-7.92096830e-03  1.81492184e-02]]
grads:  [ -0.01707549 -14.67720941]
Stock Position:  -0.017075489509204764
Bond Position:  [-10.5064733]


portfolio before change:  [-12.0852082]
curr_Stock_Price:  92.30235841562539
curr_Factors:  [9.23023584e+01 4.08180694e-02]
mat_Sqrt:  [[ 1.86482906e+01  0.00000000e+00]
 [-8.08139289e-03  1.85167973e-02]]
grads:  [ 1.11052312e-02 -2.36134247e+01]
Stock Position:  0.011105231193004307
Bond Position:  [-13.11024723]


portfolio before change:  [-12.09678004]
curr_Stock_Price:  91.55551510211258
curr_Factors:  [9.15555151e+01 4.15003067e-02]
mat_Sqrt:  [[ 1.86513454e+01  0.00000000e+00]
 [-8.14864963e-03  1.86709019e-02]]
grads:  [ -0.02196196 -11.08261875]
Stock Position:  -0.02196196118701679
Bond Position:  [-10.08604137]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.0743359]
Stock Price:  90.4187329746123
PL:  [-12.0743359]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.16042938e-02  1.22632489e-01]
 [ 7.27483552e-02 -1.13430925e-02]
 [ 7.71752127e-01 -2.99555383e-01]
 [-9.61560038e-02 -9.25777293e-02]
 [ 2.79498792e-01 -9.11201822e-03]
 [ 1.41561750e-02 -9.98019785e-02]
 [-3.86078373e-02 -9.28135229e-02]
 [-1.29017411e+00  6.67132828e-01]
 [ 6.19270171e-02 -3.35946943e-02]
 [ 1.55106665e-02 -8.68140565e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 7.89848994e-02 -6.51666304e-02]
 [ 1.19650758e-01 -3.67000709e-02]
 [-8.32214602e-02 -1.19427955e-01]
 [ 8.30340112e-02  9.97098317e-02]
 [-8.88688605e-02 -1.19940916e-01]
 [-2.01186384e-01 -2.40639551e-01]
 [ 3.99901954e-01 -4.38337723e-01]
 [-3.14744624e-01 -2.05751351e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.87266838]
curr_Stock_Price:  99.02135312986346
curr_Factors:  [9.90213531e+01 4.16700983e-02]
mat_Sqrt:  [[ 2.02134814e+01  0.00000000e+00]
 [-8.16530203e-03  1.87090573e-02]]
grads:  [3.71660370e-03 6.55471233e+00]
Stock Position:  0.003716603701517943
Bond Position:  [-4.24069151]


portfolio before change:  [-3.86921924]
curr_Stock_Price:  100.234677149901
curr_Factors:  [1.00234677e+02 4.21597623e-02]
mat_Sqrt:  [[ 2.05810284e+01  0.00000000e+00]
 [-8.21313701e-03  1.88186610e-02]]
grads:  [ 0.00329419 -0.60275768]
Stock Position:  0.00329419027929059
Bond Position:  [-4.19941134]


portfolio before change:  [-3.86719566]
curr_Stock_Price:  101.16770509239323
curr_Factors:  [1.01167705e+02 4.19443154e-02]
mat_Sqrt:  [[ 2.07194610e+01  0.00000000e+00]
 [-8.19212455e-03  1.87705154e-02]]
grads:  [  0.03093784 -15.95882567]
Stock Position:  0.03093784334743013
Bond Position:  [-6.99710627]


portfolio before change:  [-3.93619141]
curr_Stock_Price:  98.99411272918712
curr_Factors:  [9.89941127e+01 4.28392507e-02]
mat_Sqrt:  [[ 2.04894500e+01  0.00000000e+00]
 [-8.27905798e-03  1.89697049e-02]]
grads:  [-0.0066649  -4.88029359]
Stock Position:  -0.006664904988577118
Bond Position:  [-3.27640506]


portfolio before change:  [-3.92870149]
curr_Stock_Price:  97.74741392414846
curr_Factors:  [9.77474139e+01 4.26443046e-02]
mat_Sqrt:  [[ 2.01853273e+01  0.00000000e+00]
 [-8.26019899e-03  1.89264936e-02]]
grads:  [ 0.01364962 -0.48144249]
Stock Position:  0.013649616742150398
Bond Position:  [-5.26291622]


portfolio before change:  [-3.92192266]
curr_Stock_Price:  98.34045004861002
curr_Factors:  [9.83404500e+01 4.28960003e-02]
mat_Sqrt:  [[ 2.03676344e+01  0.00000000e+00]
 [-8.28453984e-03  1.89822655e-02]]
grads:  [-1.44351469e-03 -5.25764317e+00]
Stock Position:  -0.0014435146853969364
Bond Position:  [-3.77996678]


portfolio before change:  [-3.92294411]
curr_Stock_Price:  98.39333092577397
curr_Factors:  [9.83933309e+01 4.45151690e-02]
mat_Sqrt:  [[ 2.07596332e+01  0.00000000e+00]
 [-8.43944728e-03  1.93372030e-02]]
grads:  [-3.81100083e-03 -4.79973877e+00]
Stock Position:  -0.0038110008349312367
Bond Position:  [-3.54796704]


portfolio before change:  [-3.91622159]
curr_Stock_Price:  96.39657900443468
curr_Factors:  [9.63965790e+01 4.54388113e-02]
mat_Sqrt:  [[ 2.05482624e+01  0.00000000e+00]
 [-8.52655253e-03  1.95367862e-02]]
grads:  [-0.04861791 34.14752158]
Stock Position:  -0.04861790509221165
Bond Position:  [0.77037814]


portfolio before change:  [-3.97691632]
curr_Stock_Price:  97.64894385052142
curr_Factors:  [9.76489439e+01 4.34715226e-02]
mat_Sqrt:  [[ 2.03596344e+01  0.00000000e+00]
 [-8.33993022e-03  1.91091808e-02]]
grads:  [ 0.00232151 -1.75803948]
Stock Position:  0.0023215097796479133
Bond Position:  [-4.2036093]


portfolio before change:  [-3.978369]
curr_Stock_Price:  97.4759339938387
curr_Factors:  [9.74759340e+01 4.40887512e-02]
mat_Sqrt:  [[ 2.04673353e+01  0.00000000e+00]
 [-8.39892862e-03  1.92443631e-02]]
grads:  [-1.09335649e-03 -4.51114210e+00]
Stock Position:  -0.0010933564939457996
Bond Position:  [-3.87179306]


portfolio before change:  [-3.97677057]
curr_Stock_Price:  95.12857057354893
curr_Factors:  [9.51285706e+01 4.44344959e-02]
mat_Sqrt:  [[ 2.00526189e+01  0.00000000e+00]
 [-8.43179657e-03  1.93196730e-02]]
grads:  [1.34598081e-02 1.80939293e+01]
Stock Position:  0.013459808055833017
Bond Position:  [-5.25718287]


portfolio before change:  [-3.98380189]
curr_Stock_Price:  94.70383490259682
curr_Factors:  [9.47038349e+01 4.36500196e-02]
mat_Sqrt:  [[ 1.97860812e+01  0.00000000e+00]
 [-8.35703484e-03  1.91483724e-02]]
grads:  [ 2.55451545e-03 -3.40324646e+00]
Stock Position:  0.002554515453851953
Bond Position:  [-4.2257243]


portfolio before change:  [-3.98393357]
curr_Stock_Price:  95.06589041774302
curr_Factors:  [9.50658904e+01 4.36612905e-02]
mat_Sqrt:  [[ 1.98642881e+01  0.00000000e+00]
 [-8.35811371e-03  1.91508444e-02]]
grads:  [ 0.00521708 -1.91636829]
Stock Position:  0.005217077680571085
Bond Position:  [-4.47989971]


portfolio before change:  [-3.98622028]
curr_Stock_Price:  94.84227931102158
curr_Factors:  [9.48422793e+01 4.46479479e-02]
mat_Sqrt:  [[ 2.00402315e+01  0.00000000e+00]
 [-8.45202441e-03  1.93660208e-02]]
grads:  [-0.00675362 -6.16688149]
Stock Position:  -0.00675361924575594
Bond Position:  [-3.34569164]


portfolio before change:  [-3.99052514]
curr_Stock_Price:  95.35583068346828
curr_Factors:  [9.53558307e+01 4.64859309e-02]
mat_Sqrt:  [[ 2.05592856e+01  0.00000000e+00]
 [-8.62423849e-03  1.97606128e-02]]
grads:  [0.00615542 5.04588762]
Stock Position:  0.006155415699758258
Bond Position:  [-4.57747992]


portfolio before change:  [-3.99905627]
curr_Stock_Price:  94.15581136291767
curr_Factors:  [9.41558114e+01 4.74888660e-02]
mat_Sqrt:  [[ 2.05183782e+01  0.00000000e+00]
 [-8.71677610e-03  1.99726432e-02]]
grads:  [-0.00688238 -6.00526004]
Stock Position:  -0.006882384495441974
Bond Position:  [-3.35103978]


portfolio before change:  [-3.98731108]
curr_Stock_Price:  92.3275119348902
curr_Factors:  [9.23275119e+01 4.98635539e-02]
mat_Sqrt:  [[ 2.06168707e+01  0.00000000e+00]
 [-8.93205946e-03  2.04659193e-02]]
grads:  [ -0.0148524  -11.75806213]
Stock Position:  -0.01485240410857502
Bond Position:  [-2.61602556]


portfolio before change:  [-3.98611672]
curr_Stock_Price:  92.20305735370312
curr_Factors:  [9.22030574e+01 5.14225649e-02]
mat_Sqrt:  [[ 2.09084669e+01  0.00000000e+00]
 [-9.07061761e-03  2.07833959e-02]]
grads:  [ 9.97661323e-03 -2.10907652e+01]
Stock Position:  0.009976613226294548
Bond Position:  [-4.90599096]


portfolio before change:  [-3.99273133]
curr_Stock_Price:  91.66299805422783
curr_Factors:  [9.16629981e+01 4.97004743e-02]
mat_Sqrt:  [[ 2.04349851e+01  0.00000000e+00]
 [-8.91744128e-03  2.04324248e-02]]
grads:  [ -0.01979653 -10.069845  ]
Stock Position:  -0.01979653393686594
Bond Position:  [-2.17812168]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.02674355]
Stock Price:  93.35357783623826
PL:  [-4.02674355]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.87010775e-03  1.51131641e-01]
 [ 5.26485729e-02 -4.15473083e-02]
 [ 5.84904117e-01 -2.42528679e-01]
 [-1.18983163e-01 -1.27982972e-01]
 [ 1.79378106e-01 -5.14302690e-03]
 [ 2.02617154e-03 -1.25142667e-01]
 [-5.33566277e-02 -1.13995995e-01]
 [-1.24856781e+00  7.33426324e-01]
 [ 7.44531432e-02 -5.14857703e-02]
 [ 8.10548469e-02  1.46602899e-01]
 [ 7.62414584e-04  1.23126939e-01]
 [ 3.30713986e-02 -8.87969114e-03]
 [ 1.47710575e-01 -1.99266585e-02]
 [ 6.83824901e-02  1.08557552e-01]
 [-4.28156146e-02 -2.22069715e-02]
 [-1.43030476e-01 -1.37679111e-01]
 [-1.93031111e-01 -3.54268405e-01]
 [ 2.67552973e-01 -3.25585547e-01]
 [-8.10318347e-02 -1.45775891e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.92386984]
curr_Stock_Price:  99.46551351516715
curr_Factors:  [9.94655135e+01 3.92883403e-02]
mat_Sqrt:  [[ 1.97153445e+01  0.00000000e+00]
 [-7.92851464e-03  1.81665092e-02]]
grads:  [3.49115703e-03 8.31924500e+00]
Stock Position:  0.0034911570281944988
Bond Position:  [-1.27111956]


portfolio before change:  [-0.92461485]
curr_Stock_Price:  99.34314862264877
curr_Factors:  [9.93431486e+01 4.00554077e-02]
mat_Sqrt:  [[ 1.98823859e+01  0.00000000e+00]
 [-8.00553886e-03  1.83429939e-02]]
grads:  [ 1.73600096e-03 -2.26502329e+00]
Stock Position:  0.0017360009574054981
Bond Position:  [-1.09707465]


portfolio before change:  [-0.92666734]
curr_Stock_Price:  98.31884595418745
curr_Factors:  [9.83188460e+01 4.05718195e-02]
mat_Sqrt:  [[ 1.98038220e+01  0.00000000e+00]
 [-8.05697904e-03  1.84608582e-02]]
grads:  [  0.02419007 -13.13745424]
Stock Position:  0.0241900741491206
Bond Position:  [-3.30500752]


portfolio before change:  [-0.92286141]
curr_Stock_Price:  98.51034157581405
curr_Factors:  [9.85103416e+01 4.28140650e-02]
mat_Sqrt:  [[ 2.03833263e+01  0.00000000e+00]
 [-8.27662395e-03  1.89641279e-02]]
grads:  [-0.00857758 -6.74868744]
Stock Position:  -0.008577575022781496
Bond Position:  [-0.07788156]


portfolio before change:  [-0.93021811]
curr_Stock_Price:  99.36573806243344
curr_Factors:  [9.93657381e+01 4.05406626e-02]
mat_Sqrt:  [[ 2.00070052e+01  0.00000000e+00]
 [-8.05388479e-03  1.84537683e-02]]
grads:  [ 0.00885357 -0.27869792]
Stock Position:  0.008853574234645733
Bond Position:  [-1.80996004]


portfolio before change:  [-0.94378463]
curr_Stock_Price:  97.88453139651978
curr_Factors:  [9.78845314e+01 4.10429593e-02]
mat_Sqrt:  [[ 1.98304879e+01  0.00000000e+00]
 [-8.10362480e-03  1.85677370e-02]]
grads:  [-2.65200565e-03 -6.73979101e+00]
Stock Position:  -0.002652005652112737
Bond Position:  [-0.6841943]


portfolio before change:  [-0.94721958]
curr_Stock_Price:  99.11525357077228
curr_Factors:  [9.91152536e+01 4.03567039e-02]
mat_Sqrt:  [[ 1.99112415e+01  0.00000000e+00]
 [-8.03559122e-03  1.84118525e-02]]
grads:  [-5.17840932e-03 -6.19144625e+00]
Stock Position:  -0.005178409324072745
Bond Position:  [-0.43396022]


portfolio before change:  [-0.94696064]
curr_Stock_Price:  99.04429741274411
curr_Factors:  [9.90442974e+01 4.17787685e-02]
mat_Sqrt:  [[ 2.02445111e+01  0.00000000e+00]
 [-8.17594212e-03  1.87334368e-02]]
grads:  [-0.04586302 39.15065512]
Stock Position:  -0.045863015080366006
Bond Position:  [3.59550946]


portfolio before change:  [-0.92830146]
curr_Stock_Price:  98.65705300439377
curr_Factors:  [9.86570530e+01 4.25167777e-02]
mat_Sqrt:  [[ 2.03426867e+01  0.00000000e+00]
 [-8.24783877e-03  1.88981727e-02]]
grads:  [ 2.55536113e-03 -2.72437822e+00]
Stock Position:  0.002555361134633952
Bond Position:  [-1.18040585]


portfolio before change:  [-0.92248063]
curr_Stock_Price:  101.05044043622615
curr_Factors:  [1.01050440e+02 4.11865205e-02]
mat_Sqrt:  [[ 2.05076437e+01  0.00000000e+00]
 [-8.11778496e-03  1.86001820e-02]]
grads:  [7.07236775e-03 7.88179916e+00]
Stock Position:  0.0070723677526748465
Bond Position:  [-1.6371465]


portfolio before change:  [-0.93857668]
curr_Stock_Price:  98.8324115051991
curr_Factors:  [9.88324115e+01 4.44690559e-02]
mat_Sqrt:  [[ 2.08414700e+01  0.00000000e+00]
 [-8.43507495e-03  1.93271847e-02]]
grads:  [2.61495069e-03 6.37066083e+00]
Stock Position:  0.002614950686893075
Bond Position:  [-1.19701856]


portfolio before change:  [-0.93636102]
curr_Stock_Price:  99.79417110530503
curr_Factors:  [9.97941711e+01 4.43087262e-02]
mat_Sqrt:  [[ 2.10063118e+01  0.00000000e+00]
 [-8.41985522e-03  1.92923119e-02]]
grads:  [ 0.00138987 -0.46027097]
Stock Position:  0.0013898671944157445
Bond Position:  [-1.07506166]


portfolio before change:  [-0.93589669]
curr_Stock_Price:  100.32165101094576
curr_Factors:  [1.00321651e+02 4.48770630e-02]
mat_Sqrt:  [[ 2.12523463e+01  0.00000000e+00]
 [-8.47368284e-03  1.94156465e-02]]
grads:  [ 0.00654111 -1.0263196 ]
Stock Position:  0.006541106862549912
Bond Position:  [-1.59211133]


portfolio before change:  [-0.93391472]
curr_Stock_Price:  100.68551124248938
curr_Factors:  [1.00685511e+02 4.56166808e-02]
mat_Sqrt:  [[ 2.15044738e+01  0.00000000e+00]
 [-8.54322476e-03  1.95749871e-02]]
grads:  [5.38310731e-03 5.54572792e+00]
Stock Position:  0.005383107310808751
Bond Position:  [-1.47591563]


portfolio before change:  [-0.94317188]
curr_Stock_Price:  99.0343951082937
curr_Factors:  [9.90343951e+01 4.59367972e-02]
mat_Sqrt:  [[ 2.12259144e+01  0.00000000e+00]
 [-8.57314851e-03  1.96435510e-02]]
grads:  [-0.00247375 -1.1304968 ]
Stock Position:  -0.0024737465004546068
Bond Position:  [-0.69818589]


portfolio before change:  [-0.94149899]
curr_Stock_Price:  98.28756821450877
curr_Factors:  [9.82875682e+01 4.51024508e-02]
mat_Sqrt:  [[ 2.08736627e+01  0.00000000e+00]
 [-8.49493504e-03  1.94643414e-02]]
grads:  [-0.00973085 -7.07340195]
Stock Position:  -0.009730854128231808
Bond Position:  [0.014923]


portfolio before change:  [-0.93086633]
curr_Stock_Price:  97.19527686604643
curr_Factors:  [9.71952769e+01 4.53938722e-02]
mat_Sqrt:  [[ 2.07082680e+01  0.00000000e+00]
 [-8.52233510e-03  1.95271228e-02]]
grads:  [-1.67878124e-02 -1.81423760e+01]
Stock Position:  -0.01678781243065786
Bond Position:  [0.70082975]


portfolio before change:  [-0.89893653]
curr_Stock_Price:  95.30375205435986
curr_Factors:  [9.53037521e+01 4.66836743e-02]
mat_Sqrt:  [[ 2.05917148e+01  0.00000000e+00]
 [-8.64256206e-03  1.98025974e-02]]
grads:  [ 6.09253731e-03 -1.64415577e+01]
Stock Position:  0.00609253730635931
Bond Position:  [-1.4795782]


portfolio before change:  [-0.88956526]
curr_Stock_Price:  96.90262802485967
curr_Factors:  [9.69026280e+01 4.55130487e-02]
mat_Sqrt:  [[ 2.06730007e+01  0.00000000e+00]
 [-8.53351498e-03  1.95527392e-02]]
grads:  [-6.99722559e-03 -7.45552273e+00]
Stock Position:  -0.006997225593630219
Bond Position:  [-0.21151571]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.89903008]
Stock Price:  98.24772233258861
PL:  [-0.89903008]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.20386192e-03  1.06079605e-02]
 [-3.32641613e-01  2.37895932e-01]
 [ 8.27542401e-01 -3.16582782e-01]
 [ 2.68788611e-01 -9.69634076e-02]
 [ 2.26776107e-01 -3.01582256e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-6.58232311e-02 -1.31900836e-01]
 [-1.26196929e+00  7.19634911e-01]
 [ 6.86214830e-02 -4.31717061e-02]
 [ 1.61502283e-02 -8.37319415e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 1.02878128e-01 -1.17985080e-01]
 [ 7.22926873e-02  2.21724793e-02]
 [-6.80156110e-02 -8.64120814e-02]
 [ 5.32660905e-02  4.36620729e-02]
 [-9.51998717e-02 -1.22084286e-01]
 [-1.98037698e-01 -2.84487632e-01]
 [ 3.27645472e-01 -3.86169735e-01]
 [-2.18100958e-01 -1.80950052e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.03214163]
curr_Stock_Price:  102.62199571653706
curr_Factors:  [1.02621996e+02 3.91583971e-02]
mat_Sqrt:  [[ 2.03073339e+01  0.00000000e+00]
 [-7.91539230e-03  1.81364422e-02]]
grads:  [2.87263483e-04 5.84897546e-01]
Stock Position:  0.00028726348265221697
Bond Position:  [20.00266208]


portfolio before change:  [20.03742274]
curr_Stock_Price:  103.59607426815923
curr_Factors:  [1.03596074e+02 3.98271171e-02]
mat_Sqrt:  [[ 2.06743914e+01  0.00000000e+00]
 [-7.98269299e-03  1.82906474e-02]]
grads:  [-1.10675720e-02  1.30064249e+01]
Stock Position:  -0.011067572031013669
Bond Position:  [21.18397976]


portfolio before change:  [20.05254846]
curr_Stock_Price:  102.70797832021775
curr_Factors:  [1.02707978e+02 3.81031092e-02]
mat_Sqrt:  [[ 2.00486156e+01  0.00000000e+00]
 [-7.80800709e-03  1.78903918e-02]]
grads:  [  0.03438513 -17.69568748]
Stock Position:  0.034385134704106715
Bond Position:  [16.52092079]


portfolio before change:  [20.03441683]
curr_Stock_Price:  102.06053625149944
curr_Factors:  [1.02060536e+02 3.73853642e-02]
mat_Sqrt:  [[ 1.97337060e+01  0.00000000e+00]
 [-7.73411810e-03  1.77210908e-02]]
grads:  [ 0.01147632 -5.47163877]
Stock Position:  0.011476319250033085
Bond Position:  [18.86313753]


portfolio before change:  [20.0595623]
curr_Stock_Price:  103.84064545291419
curr_Factors:  [1.03840645e+02 3.60736629e-02]
mat_Sqrt:  [[ 1.97225243e+01  0.00000000e+00]
 [-7.59722717e-03  1.74074343e-02]]
grads:  [ 0.01083097 -1.73249113]
Stock Position:  0.01083096538806791
Bond Position:  [18.93486787]


portfolio before change:  [20.04667919]
curr_Stock_Price:  102.21406669778975
curr_Factors:  [1.02214067e+02 3.71130874e-02]
mat_Sqrt:  [[ 1.96912919e+01  0.00000000e+00]
 [-7.70590292e-03  1.76564417e-02]]
grads:  [-2.94354560e-05 -1.09598392e+00]
Stock Position:  -2.9435456046092764e-05
Bond Position:  [20.04968791]


portfolio before change:  [20.05176551]
curr_Stock_Price:  99.72506953373716
curr_Factors:  [9.97250695e+01 3.70473296e-02]
mat_Sqrt:  [[ 1.91947651e+01  0.00000000e+00]
 [-7.69907315e-03  1.76407927e-02]]
grads:  [-6.42828784e-03 -7.47703562e+00]
Stock Position:  -0.006428287838462738
Bond Position:  [20.69282696]


portfolio before change:  [20.06511517]
curr_Stock_Price:  98.45322076753654
curr_Factors:  [9.84532208e+01 3.73033669e-02]
mat_Sqrt:  [[ 1.90153334e+01  0.00000000e+00]
 [-7.72563182e-03  1.77016463e-02]]
grads:  [-0.04984897 40.65355834]
Stock Position:  -0.04984897432285589
Bond Position:  [24.97290725]


portfolio before change:  [20.08452438]
curr_Stock_Price:  98.18911906461031
curr_Factors:  [9.81891191e+01 3.94177359e-02]
mat_Sqrt:  [[ 1.94943699e+01  0.00000000e+00]
 [-7.94156014e-03  1.81964002e-02]]
grads:  [ 0.00255355 -2.37254103]
Stock Position:  0.0025535478272422237
Bond Position:  [19.83379377]


portfolio before change:  [20.08689525]
curr_Stock_Price:  97.175552253729
curr_Factors:  [9.71755523e+01 4.11730634e-02]
mat_Sqrt:  [[ 1.97180338e+01  0.00000000e+00]
 [-8.11645867e-03  1.85971431e-02]]
grads:  [-1.03425053e-03 -4.50240884e+00]
Stock Position:  -0.001034250530977696
Bond Position:  [20.18739912]


portfolio before change:  [20.09470944]
curr_Stock_Price:  94.50046573196904
curr_Factors:  [9.45004657e+01 4.22851011e-02]
mat_Sqrt:  [[ 1.94324534e+01  0.00000000e+00]
 [-8.22533657e-03  1.88466137e-02]]
grads:  [1.38893631e-02 1.85480958e+01]
Stock Position:  0.013889363073880421
Bond Position:  [18.78215817]


portfolio before change:  [20.08505998]
curr_Stock_Price:  93.4676187796384
curr_Factors:  [9.34676188e+01 4.05869280e-02]
mat_Sqrt:  [[ 1.88301712e+01  0.00000000e+00]
 [-8.05847906e-03  1.84642951e-02]]
grads:  [ 2.72887680e-03 -6.38990433e+00]
Stock Position:  0.002728876798285121
Bond Position:  [19.82999837]


portfolio before change:  [20.08781088]
curr_Stock_Price:  92.6587781413139
curr_Factors:  [9.26587781e+01 4.06239295e-02]
mat_Sqrt:  [[ 1.86757277e+01  0.00000000e+00]
 [-8.06215153e-03  1.84727098e-02]]
grads:  [0.0043891  1.20028299]
Stock Position:  0.004389095395003213
Bond Position:  [19.68112266]


portfolio before change:  [20.10940838]
curr_Stock_Price:  96.45833235827695
curr_Factors:  [9.64583324e+01 3.82665862e-02]
mat_Sqrt:  [[ 1.88690315e+01  0.00000000e+00]
 [-7.82473884e-03  1.79287290e-02]]
grads:  [-0.0056033  -4.81975501]
Stock Position:  -0.00560330482738027
Bond Position:  [20.64989382]


portfolio before change:  [20.11266659]
curr_Stock_Price:  96.79829347808624
curr_Factors:  [9.67982935e+01 4.12198657e-02]
mat_Sqrt:  [[ 1.96526440e+01  0.00000000e+00]
 [-8.12107044e-03  1.86077100e-02]]
grads:  [0.00368    2.34645063]
Stock Position:  0.003680002617442056
Bond Position:  [19.75644862]


portfolio before change:  [20.10860074]
curr_Stock_Price:  94.35112513614716
curr_Factors:  [9.43511251e+01 4.11137631e-02]
mat_Sqrt:  [[ 1.91311333e+01  0.00000000e+00]
 [-8.11061163e-03  1.85837459e-02]]
grads:  [-0.00776127 -6.56941214]
Stock Position:  -0.007761266401432027
Bond Position:  [20.84088495]


portfolio before change:  [20.11555368]
curr_Stock_Price:  94.12666789173818
curr_Factors:  [9.41266679e+01 4.02286256e-02]
mat_Sqrt:  [[ 1.88790563e+01  0.00000000e+00]
 [-8.02282999e-03  1.83826129e-02]]
grads:  [ -0.01706644 -15.47590836]
Stock Position:  -0.01706643984775156
Bond Position:  [21.7219608]


portfolio before change:  [20.12873958]
curr_Stock_Price:  93.67228329587599
curr_Factors:  [9.36722833e+01 4.02384704e-02]
mat_Sqrt:  [[ 1.87902188e+01  0.00000000e+00]
 [-8.02381160e-03  1.83848620e-02]]
grads:  [ 8.46755344e-03 -2.10047665e+01]
Stock Position:  0.008467553439857065
Bond Position:  [19.33556451]


portfolio before change:  [20.13487893]
curr_Stock_Price:  93.82638365011933
curr_Factors:  [9.38263837e+01 4.26371745e-02]
mat_Sqrt:  [[ 1.93739951e+01  0.00000000e+00]
 [-8.25950842e-03  1.89249113e-02]]
grads:  [-0.01533365 -9.56147428]
Stock Position:  -0.015333648723295396
Bond Position:  [21.57357973]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.13295675]
Stock Price:  94.30352058267805
PL:  [20.13295675]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 4.85359896e-02  7.43811551e-02]
 [ 2.84793082e-02 -7.78667909e-02]
 [ 4.91310239e-01 -2.13963481e-01]
 [-1.14899522e-01 -1.19129679e-01]
 [ 1.08672791e-01 -9.49949059e-03]
 [ 2.77300449e-02 -7.56260967e-02]
 [-1.28167749e-01 -1.84386291e-01]
 [-1.28590571e+00  7.38251224e-01]
 [ 8.31272694e-02 -6.38946056e-02]
 [ 2.44759506e-02 -7.74223598e-02]
 [ 1.45276282e-02  1.59252998e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.60948765e-01 -2.94815240e-02]
 [-6.27098751e-02 -7.46176663e-02]
 [ 8.22398831e-02  9.83182408e-02]
 [-1.43630574e-01 -1.40373850e-01]
 [-1.89512865e-01 -3.96601744e-01]
 [ 2.85881136e-01 -2.55226258e-01]
 [ 4.72994913e-02 -1.12842351e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.22691971]
curr_Stock_Price:  98.51612174926281
curr_Factors:  [9.85161217e+01 4.29733036e-02]
mat_Sqrt:  [[ 2.04223953e+01  0.00000000e+00]
 [-8.29200131e-03  1.89993618e-02]]
grads:  [0.00396616 3.91492913]
Stock Position:  0.003966164892296264
Bond Position:  [-7.61765089]


portfolio before change:  [-7.23592123]
curr_Stock_Price:  96.72676896514699
curr_Factors:  [9.67267690e+01 4.22345863e-02]
mat_Sqrt:  [[ 1.98783715e+01  0.00000000e+00]
 [-8.22042202e-03  1.88353531e-02]]
grads:  [-2.76911290e-04 -4.13407652e+00]
Stock Position:  -0.0002769112898643185
Bond Position:  [-7.20913649]


portfolio before change:  [-7.23771817]
curr_Stock_Price:  96.70667990071819
curr_Factors:  [9.67066799e+01 4.17702913e-02]
mat_Sqrt:  [[ 1.97647000e+01  0.00000000e+00]
 [-8.17511261e-03  1.87315362e-02]]
grads:  [  0.02013331 -11.42263397]
Stock Position:  0.020133314479129197
Bond Position:  [-9.18474417]


portfolio before change:  [-7.20157996]
curr_Stock_Price:  98.61568926903007
curr_Factors:  [9.86156893e+01 4.25657743e-02]
mat_Sqrt:  [[ 2.03458709e+01  0.00000000e+00]
 [-8.25258983e-03  1.89090588e-02]]
grads:  [-0.00820274 -6.30013795]
Stock Position:  -0.008202744330415717
Bond Position:  [-6.39266067]


portfolio before change:  [-7.21374248]
curr_Stock_Price:  99.90357030341917
curr_Factors:  [9.99035703e+01 4.02896957e-02]
mat_Sqrt:  [[ 2.00529376e+01  0.00000000e+00]
 [-8.02891730e-03  1.83965606e-02]]
grads:  [ 0.00521255 -0.51637318]
Stock Position:  0.005212546659730994
Bond Position:  [-7.73449451]


portfolio before change:  [-7.22048922]
curr_Stock_Price:  98.98024583522559
curr_Factors:  [9.89802458e+01 4.11077793e-02]
mat_Sqrt:  [[ 2.00682978e+01  0.00000000e+00]
 [-8.11002138e-03  1.85823934e-02]]
grads:  [-2.62896717e-04 -4.06977158e+00]
Stock Position:  -0.00026289671689852246
Bond Position:  [-7.19446764]


portfolio before change:  [-7.22303723]
curr_Stock_Price:  101.82989256066789
curr_Factors:  [1.01829893e+02 3.79920440e-02]
mat_Sqrt:  [[ 1.98482223e+01  0.00000000e+00]
 [-7.79661916e-03  1.78642987e-02]]
grads:  [ -0.0105118  -10.32149615]
Stock Position:  -0.010511799024635822
Bond Position:  [-6.15262186]


portfolio before change:  [-7.20540752]
curr_Stock_Price:  100.00641279837046
curr_Factors:  [1.00006413e+02 3.77903379e-02]
mat_Sqrt:  [[ 1.94409837e+01  0.00000000e+00]
 [-7.77589485e-03  1.78168134e-02]]
grads:  [-0.04957087 41.43564898]
Stock Position:  -0.04957086910169594
Bond Position:  [-2.24800272]


portfolio before change:  [-7.17377484]
curr_Stock_Price:  99.35694360701135
curr_Factors:  [9.93569436e+01 3.73224598e-02]
mat_Sqrt:  [[ 1.91947895e+01  0.00000000e+00]
 [-7.72760867e-03  1.77061758e-02]]
grads:  [ 2.87793609e-03 -3.60860562e+00]
Stock Position:  0.0028779360900736644
Bond Position:  [-7.45971777]


portfolio before change:  [-7.17552237]
curr_Stock_Price:  99.39781639419166
curr_Factors:  [9.93978164e+01 3.56467572e-02]
mat_Sqrt:  [[ 1.87666545e+01  0.00000000e+00]
 [-7.55213953e-03  1.73041255e-02]]
grads:  [-4.96302496e-04 -4.47421395e+00]
Stock Position:  -0.0004963024955593956
Bond Position:  [-7.12619099]


portfolio before change:  [-7.17689566]
curr_Stock_Price:  98.57475310460583
curr_Factors:  [9.85747531e+01 3.86859826e-02]
mat_Sqrt:  [[ 1.93884242e+01  0.00000000e+00]
 [-7.86750101e-03  1.80267095e-02]]
grads:  [4.33409821e-03 8.83427996e+00]
Stock Position:  0.004334098206278264
Bond Position:  [-7.60412832]


portfolio before change:  [-7.18373654]
curr_Stock_Price:  97.43504251328415
curr_Factors:  [9.74350425e+01 3.88209678e-02]
mat_Sqrt:  [[ 1.91976628e+01  0.00000000e+00]
 [-7.88121491e-03  1.80581320e-02]]
grads:  [ 0.00250116 -0.47576255]
Stock Position:  0.002501162715105867
Bond Position:  [-7.42743744]


portfolio before change:  [-7.18509658]
curr_Stock_Price:  97.63377352638038
curr_Factors:  [9.76337735e+01 3.57227822e-02]
mat_Sqrt:  [[ 1.84532435e+01  0.00000000e+00]
 [-7.56018859e-03  1.73225682e-02]]
grads:  [ 0.00802471 -1.70191415]
Stock Position:  0.008024712478974858
Bond Position:  [-7.96857954]


portfolio before change:  [-7.19197955]
curr_Stock_Price:  97.02433389519206
curr_Factors:  [9.70243339e+01 3.61199993e-02]
mat_Sqrt:  [[ 1.84397291e+01  0.00000000e+00]
 [-7.60210490e-03  1.74186106e-02]]
grads:  [-0.00516687 -4.2837898 ]
Stock Position:  -0.00516687061913796
Bond Position:  [-6.69066737]


portfolio before change:  [-7.18519727]
curr_Stock_Price:  95.38791711025328
curr_Factors:  [9.53879171e+01 3.72371827e-02]
mat_Sqrt:  [[ 1.84069475e+01  0.00000000e+00]
 [-7.71877531e-03  1.76859361e-02]]
grads:  [0.00679904 5.55912   ]
Stock Position:  0.0067990350572084465
Bond Position:  [-7.83374306]


portfolio before change:  [-7.17453351]
curr_Stock_Price:  97.24442205877901
curr_Factors:  [9.72444221e+01 3.56723393e-02]
mat_Sqrt:  [[ 1.83666730e+01  0.00000000e+00]
 [-7.55484897e-03  1.73103336e-02]]
grads:  [-0.01115579 -8.10925155]
Stock Position:  -0.011155789858893001
Bond Position:  [-6.08969517]


portfolio before change:  [-7.1940639]
curr_Stock_Price:  98.85863151070289
curr_Factors:  [9.88586315e+01 3.50356357e-02]
mat_Sqrt:  [[ 1.85041694e+01  0.00000000e+00]
 [-7.48712342e-03  1.71551549e-02]]
grads:  [-1.95958029e-02 -2.31185172e+01]
Stock Position:  -0.019595802911306297
Bond Position:  [-5.25684964]


portfolio before change:  [-7.19214707]
curr_Stock_Price:  98.69373874661605
curr_Factors:  [9.86937387e+01 3.28169162e-02]
mat_Sqrt:  [[ 1.78788049e+01  0.00000000e+00]
 [-7.24617596e-03  1.66030749e-02]]
grads:  [ 9.75967163e-03 -1.53722283e+01]
Stock Position:  0.009759671630100242
Bond Position:  [-8.15536556]


portfolio before change:  [-7.18365018]
curr_Stock_Price:  99.77328200909169
curr_Factors:  [9.97732820e+01 3.27744509e-02]
mat_Sqrt:  [[ 1.80626710e+01  0.00000000e+00]
 [-7.24148614e-03  1.65923292e-02]]
grads:  [-1.07899231e-04 -6.80087466e+00]
Stock Position:  -0.00010789923101268773
Bond Position:  [-7.17288472]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.18546285]
Stock Price:  99.95139935568437
PL:  [-7.18546285]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.73915910e-02  1.22889362e-01]
 [ 6.66747598e-02 -6.87515581e-03]
 [ 7.87764441e-01 -3.04442401e-01]
 [ 8.78375150e-02 -1.10475060e-01]
 [ 4.77157381e-02 -1.83044890e-02]
 [ 3.89059762e-02 -4.95232658e-02]
 [-8.73010724e-02 -1.63539491e-01]
 [-1.34586649e+00  7.43643149e-01]
 [ 8.01914092e-02 -7.54754458e-02]
 [ 2.27551977e-02 -8.13696477e-02]
 [ 2.01208973e-02  1.74163464e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.63903887e-01 -2.90748260e-02]
 [ 4.75467636e-03  1.98354220e-02]
 [-3.71198261e-03 -5.17756490e-03]
 [-1.42690842e-01 -1.36153982e-01]
 [-1.81113325e-01 -4.38207632e-01]
 [ 2.76459154e-01 -2.38556013e-01]
 [-1.10482446e-02 -1.27816213e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.11420936]
curr_Stock_Price:  99.92312172639419
curr_Factors:  [9.99231217e+01 3.86129187e-02]
mat_Sqrt:  [[ 1.96350634e+01  0.00000000e+00]
 [-7.86006806e-03  1.80096784e-02]]
grads:  [3.61724860e-03 6.82351785e+00]
Stock Position:  0.0036172486002882935
Bond Position:  [1.75276259]


portfolio before change:  [2.11970091]
curr_Stock_Price:  101.32012163634538
curr_Factors:  [1.01320122e+02 3.77406009e-02]
mat_Sqrt:  [[ 1.96833995e+01  0.00000000e+00]
 [-7.77077612e-03  1.78050849e-02]]
grads:  [ 0.00323492 -0.3861344 ]
Stock Position:  0.0032349186269633287
Bond Position:  [1.79193856]


portfolio before change:  [2.1221597]
curr_Stock_Price:  101.94169851361877
curr_Factors:  [1.01941699e+02 3.86249893e-02]
mat_Sqrt:  [[ 2.00348480e+01  0.00000000e+00]
 [-7.86129651e-03  1.80124932e-02]]
grads:  [  0.03268779 -16.90173584]
Stock Position:  0.03268778907035194
Bond Position:  [-1.21008904]


portfolio before change:  [2.06881398]
curr_Stock_Price:  100.31897755050001
curr_Factors:  [1.00318978e+02 3.93403136e-02]
mat_Sqrt:  [[ 1.98976600e+01  0.00000000e+00]
 [-7.93375710e-03  1.81785212e-02]]
grads:  [ 1.99130178e-03 -6.07723031e+00]
Stock Position:  0.001991301780466595
Bond Position:  [1.86904862]


portfolio before change:  [2.07167593]
curr_Stock_Price:  101.52152452977796
curr_Factors:  [1.01521525e+02 3.88412288e-02]
mat_Sqrt:  [[ 2.00080430e+01  0.00000000e+00]
 [-7.88327128e-03  1.80628437e-02]]
grads:  [ 0.00198555 -1.01337803]
Stock Position:  0.001985551723592893
Bond Position:  [1.87009969]


portfolio before change:  [2.0689999]
curr_Stock_Price:  99.93828191232589
curr_Factors:  [9.99382819e+01 4.10859053e-02]
mat_Sqrt:  [[ 2.02571484e+01  0.00000000e+00]
 [-8.10786337e-03  1.85774488e-02]]
grads:  [ 8.53636985e-04 -2.66577324e+00]
Stock Position:  0.000853636985040171
Bond Position:  [1.98368889]


portfolio before change:  [2.07034711]
curr_Stock_Price:  100.93545012219546
curr_Factors:  [1.00935450e+02 3.89454459e-02]
mat_Sqrt:  [[ 1.99192079e+01  0.00000000e+00]
 [-7.89384022e-03  1.80870602e-02]]
grads:  [-7.96595722e-03 -9.04179505e+00]
Stock Position:  -0.007965957215371623
Bond Position:  [2.87439459]


portfolio before change:  [2.06559356]
curr_Stock_Price:  101.62240331670834
curr_Factors:  [1.01622403e+02 3.87462505e-02]
mat_Sqrt:  [[ 2.00034222e+01  0.00000000e+00]
 [-7.87362691e-03  1.80407457e-02]]
grads:  [-0.05105696 41.22020027]
Stock Position:  -0.05105696417275215
Bond Position:  [7.25412496]


portfolio before change:  [2.11749362]
curr_Stock_Price:  100.64141453816178
curr_Factors:  [1.00641415e+02 3.88228390e-02]
mat_Sqrt:  [[ 1.98298933e+01  0.00000000e+00]
 [-7.88140485e-03  1.80585672e-02]]
grads:  [ 2.38282795e-03 -4.17948141e+00]
Stock Position:  0.0023828279536888346
Bond Position:  [1.87768245]


portfolio before change:  [2.1148129]
curr_Stock_Price:  99.31936960021544
curr_Factors:  [9.93193696e+01 3.67897995e-02]
mat_Sqrt:  [[ 1.90501178e+01  0.00000000e+00]
 [-7.67226689e-03  1.75793719e-02]]
grads:  [-6.69677118e-04 -4.62870051e+00]
Stock Position:  -0.0006696771180028887
Bond Position:  [2.18132481]


portfolio before change:  [2.11592777]
curr_Stock_Price:  98.4689950264707
curr_Factors:  [9.84689950e+01 3.71078406e-02]
mat_Sqrt:  [[ 1.89684719e+01  0.00000000e+00]
 [-7.70535820e-03  1.76551936e-02]]
grads:  [5.06799204e-03 9.86471564e+00]
Stock Position:  0.005067992037389167
Bond Position:  [1.61688769]


portfolio before change:  [2.11088758]
curr_Stock_Price:  97.39471033204971
curr_Factors:  [9.73947103e+01 3.74785305e-02]
mat_Sqrt:  [[ 1.88550048e+01  0.00000000e+00]
 [-7.74374901e-03  1.77431580e-02]]
grads:  [ 0.00254662 -0.48420821]
Stock Position:  0.002546617133603588
Bond Position:  [1.86286054]


portfolio before change:  [2.11265681]
curr_Stock_Price:  97.90654727479729
curr_Factors:  [9.79065473e+01 3.88268410e-02]
mat_Sqrt:  [[ 1.92920227e+01  0.00000000e+00]
 [-7.88181107e-03  1.80594979e-02]]
grads:  [ 0.00783819 -1.60994653]
Stock Position:  0.007838192768520921
Bond Position:  [1.34524641]


portfolio before change:  [2.12508594]
curr_Stock_Price:  99.44934906314909
curr_Factors:  [9.94493491e+01 3.85827266e-02]
mat_Sqrt:  [[ 1.95343247e+01  0.00000000e+00]
 [-7.85699450e-03  1.80026360e-02]]
grads:  [6.86564007e-04 1.10180654e+00]
Stock Position:  0.0006865640069438516
Bond Position:  [2.05680759]


portfolio before change:  [2.12489848]
curr_Stock_Price:  98.42726661788979
curr_Factors:  [9.84272666e+01 3.80735405e-02]
mat_Sqrt:  [[ 1.92055636e+01  0.00000000e+00]
 [-7.80497692e-03  1.78834488e-02]]
grads:  [-0.00031093 -0.28951714]
Stock Position:  -0.0003109337123195014
Bond Position:  [2.15550283]


portfolio before change:  [2.12537409]
curr_Stock_Price:  98.63094193176076
curr_Factors:  [9.86309419e+01 3.60382922e-02]
mat_Sqrt:  [[ 1.87238556e+01  0.00000000e+00]
 [-7.59350167e-03  1.73988981e-02]]
grads:  [-0.01079443 -7.82543705]
Stock Position:  -0.01079442803461747
Bond Position:  [3.1900387]


portfolio before change:  [2.11180759]
curr_Stock_Price:  99.9616388160104
curr_Factors:  [9.99616388e+01 3.68737409e-02]
mat_Sqrt:  [[ 1.91951702e+01  0.00000000e+00]
 [-7.68101461e-03  1.75994154e-02]]
grads:  [-1.93987764e-02 -2.48989879e+01]
Stock Position:  -0.01939877640018832
Bond Position:  [4.05094107]


portfolio before change:  [2.10950159]
curr_Stock_Price:  100.13272514671868
curr_Factors:  [1.00132725e+02 3.85853847e-02]
mat_Sqrt:  [[ 1.96692343e+01  0.00000000e+00]
 [-7.85726514e-03  1.80032561e-02]]
grads:  [ 8.76214967e-03 -1.32507148e+01]
Stock Position:  0.008762149666114584
Bond Position:  [1.23212366]


portfolio before change:  [2.09523104]
curr_Stock_Price:  98.46890821560409
curr_Factors:  [9.84689082e+01 3.98860870e-02]
mat_Sqrt:  [[ 1.96657194e+01  0.00000000e+00]
 [-7.98860058e-03  1.83041834e-02]]
grads:  [-3.39839147e-03 -6.98289618e+00]
Stock Position:  -0.0033983914667052133
Bond Position:  [2.42986694]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.09395851]
Stock Price:  99.0221341826958
PL:  [2.09395851]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.23390866e-02  1.21316020e-01]
 [ 5.28020665e-02 -4.13166514e-02]
 [ 6.21627682e-01 -2.53736847e-01]
 [ 1.83019287e-01 -1.19859478e-01]
 [ 2.21709981e-01 -6.54282184e-03]
 [ 3.96396097e-02 -3.03990314e-02]
 [-8.57171513e-02 -1.60601579e-01]
 [-1.38342544e+00  7.47536868e-01]
 [ 5.98889045e-02 -7.75967968e-02]
 [ 8.45805955e-02  1.61267683e-01]
 [-1.78312120e-01 -3.83702159e-02]
 [ 3.81491010e-02 -8.80138304e-03]
 [ 1.42150064e-01 -1.77213773e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.16293052e-01 -6.19067111e-02]
 [-1.40972560e-01 -1.28438033e-01]
 [-1.68694481e-01 -4.99168940e-01]
 [ 3.40237044e-02 -1.77268175e-01]
 [ 1.43957037e-01  3.56146504e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.96118394]
curr_Stock_Price:  99.0080205454117
curr_Factors:  [9.90080205e+01 4.00253815e-02]
mat_Sqrt:  [[ 1.98078855e+01  0.00000000e+00]
 [-8.00253775e-03  1.83361175e-02]]
grads:  [3.80079633e-03 6.61623271e+00]
Stock Position:  0.003800796327040497
Bond Position:  [-4.33749326]


portfolio before change:  [-3.96092562]
curr_Stock_Price:  99.36132439640194
curr_Factors:  [9.93613244e+01 4.00381769e-02]
mat_Sqrt:  [[ 1.98817459e+01  0.00000000e+00]
 [-8.00381678e-03  1.83390481e-02]]
grads:  [ 1.74884046e-03 -2.25293326e+00]
Stock Position:  0.0017488404550981013
Bond Position:  [-4.13469272]


portfolio before change:  [-3.96280244]
curr_Stock_Price:  98.87927925496338
curr_Factors:  [9.88792793e+01 4.07048565e-02]
mat_Sqrt:  [[ 1.99493342e+01  0.00000000e+00]
 [-8.07017784e-03  1.84911004e-02]]
grads:  [  0.02560927 -13.72210639]
Stock Position:  0.02560926782096447
Bond Position:  [-6.49502838]


portfolio before change:  [-3.91003215]
curr_Stock_Price:  101.00328565582038
curr_Factors:  [1.01003286e+02 3.88376481e-02]
mat_Sqrt:  [[ 1.99049899e+01  0.00000000e+00]
 [-7.88290790e-03  1.80620111e-02]]
grads:  [ 6.56661082e-03 -6.63599846e+00]
Stock Position:  0.0065666108225217925
Bond Position:  [-4.57328142]


portfolio before change:  [-3.92576793]
curr_Stock_Price:  98.78108615941896
curr_Factors:  [9.87810862e+01 3.88032050e-02]
mat_Sqrt:  [[ 1.94584210e+01  0.00000000e+00]
 [-7.87941165e-03  1.80540002e-02]]
grads:  [ 0.01124729 -0.36240289]
Stock Position:  0.011247287706496183
Bond Position:  [-5.03678723]


portfolio before change:  [-3.90808]
curr_Stock_Price:  100.46569580380995
curr_Factors:  [1.00465696e+02 3.66172180e-02]
mat_Sqrt:  [[ 1.92247397e+01  0.00000000e+00]
 [-7.65425037e-03  1.75380909e-02]]
grads:  [ 1.37179411e-03 -1.73331474e+00]
Stock Position:  0.0013717941100740833
Bond Position:  [-4.04589825]


portfolio before change:  [-3.90874819]
curr_Stock_Price:  100.71603013611393
curr_Factors:  [1.00716030e+02 3.70045827e-02]
mat_Sqrt:  [[ 1.93743149e+01  0.00000000e+00]
 [-7.69463010e-03  1.76306124e-02]]
grads:  [-8.04206121e-03 -9.10924559e+00]
Stock Position:  -0.00804206121269618
Bond Position:  [-3.09878371]


portfolio before change:  [-3.92412262]
curr_Stock_Price:  102.5314401591671
curr_Factors:  [1.02531440e+02 3.45137154e-02]
mat_Sqrt:  [[ 1.90481549e+01  0.00000000e+00]
 [-7.43114693e-03  1.70268967e-02]]
grads:  [-0.05550005 43.90329506]
Stock Position:  -0.05550005273878718
Bond Position:  [1.76637771]


portfolio before change:  [-3.90681767]
curr_Stock_Price:  102.22759714801718
curr_Factors:  [1.02227597e+02 3.64241446e-02]
mat_Sqrt:  [[ 1.95102500e+01  0.00000000e+00]
 [-7.63404423e-03  1.74917928e-02]]
grads:  [ 1.33380587e-03 -4.43618318e+00]
Stock Position:  0.0013338058693698992
Bond Position:  [-4.04316944]


portfolio before change:  [-3.90915386]
curr_Stock_Price:  101.23399245729445
curr_Factors:  [1.01233992e+02 3.90798098e-02]
mat_Sqrt:  [[ 2.00125572e+01  0.00000000e+00]
 [-7.90744559e-03  1.81182340e-02]]
grads:  [7.74331743e-03 8.90085003e+00]
Stock Position:  0.007743317432372399
Bond Position:  [-4.6930408]


portfolio before change:  [-3.90424916]
curr_Stock_Price:  102.01894170281
curr_Factors:  [1.02018942e+02 4.08412107e-02]
mat_Sqrt:  [[ 2.06172206e+01  0.00000000e+00]
 [-8.08368339e-03  1.85220455e-02]]
grads:  [-0.00946094 -2.07159711]
Stock Position:  -0.009460938461928263
Bond Position:  [-2.93905423]


portfolio before change:  [-3.88186083]
curr_Stock_Price:  99.5748730391997
curr_Factors:  [9.95748730e+01 4.27522319e-02]
mat_Sqrt:  [[ 2.05887110e+01  0.00000000e+00]
 [-8.27064514e-03  1.89504287e-02]]
grads:  [ 0.00166634 -0.46444242]
Stock Position:  0.001666343392214239
Bond Position:  [-4.04778676]


portfolio before change:  [-3.88130311]
curr_Stock_Price:  100.51693404737408
curr_Factors:  [1.00516934e+02 4.33416592e-02]
mat_Sqrt:  [[ 2.09262785e+01  0.00000000e+00]
 [-8.32746389e-03  1.90806168e-02]]
grads:  [ 0.0064233  -0.92876333]
Stock Position:  0.006423302685236334
Bond Position:  [-4.5269538]


portfolio before change:  [-3.86612515]
curr_Stock_Price:  103.05610064361858
curr_Factors:  [1.03056101e+02 4.38440453e-02]
mat_Sqrt:  [[ 2.15788857e+01  0.00000000e+00]
 [-8.37558789e-03  1.91908827e-02]]
grads:  [7.05491209e-03 7.74211856e+00]
Stock Position:  0.00705491209457167
Bond Position:  [-4.59317688]


portfolio before change:  [-3.86370628]
curr_Stock_Price:  103.56174976593218
curr_Factors:  [1.03561750e+02 4.20397531e-02]
mat_Sqrt:  [[ 2.12338849e+01  0.00000000e+00]
 [-8.20143920e-03  1.87918580e-02]]
grads:  [-0.00674918 -3.2943369 ]
Stock Position:  -0.006749182120647372
Bond Position:  [-3.16474917]


portfolio before change:  [-3.84995373]
curr_Stock_Price:  101.40684650390293
curr_Factors:  [1.01406847e+02 4.29786772e-02]
mat_Sqrt:  [[ 2.10229569e+01  0.00000000e+00]
 [-8.29251973e-03  1.90005497e-02]]
grads:  [-0.00937202 -6.75970091]
Stock Position:  -0.0093720171612453
Bond Position:  [-2.89956703]


portfolio before change:  [-3.85246441]
curr_Stock_Price:  101.5973812739852
curr_Factors:  [1.01597381e+02 4.30045377e-02]
mat_Sqrt:  [[ 2.10687930e+01  0.00000000e+00]
 [-8.29501418e-03  1.90062652e-02]]
grads:  [-1.83470248e-02 -2.62633892e+01]
Stock Position:  -0.01834702480692193
Bond Position:  [-1.98845474]


portfolio before change:  [-3.86755616]
curr_Stock_Price:  102.39285492885978
curr_Factors:  [1.02392855e+02 4.31080849e-02]
mat_Sqrt:  [[ 2.12593028e+01  0.00000000e+00]
 [-8.30499464e-03  1.90291333e-02]]
grads:  [-2.03875313e-03 -9.31562004e+00]
Stock Position:  -0.0020387531298154547
Bond Position:  [-3.65880241]


portfolio before change:  [-3.87026493]
curr_Stock_Price:  103.27278326493446
curr_Factors:  [1.03272783e+02 4.32342117e-02]
mat_Sqrt:  [[ 2.14733426e+01  0.00000000e+00]
 [-8.31713525e-03  1.90569509e-02]]
grads:  [0.00742784 1.86885355]
Stock Position:  0.00742783960983919
Bond Position:  [-4.6373586]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.86570867]
Stock Price:  104.04228666049642
PL:  [-7.90799533]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.98126937e-03  1.51602513e-01]
 [ 4.12412277e-02 -5.86892810e-02]
 [ 5.25085048e-01 -2.24271678e-01]
 [-4.33559410e-02 -9.72214501e-02]
 [ 1.57778293e-02 -1.53485234e-02]
 [ 3.92347662e-02 -3.26250727e-02]
 [-5.08037807e-02 -1.10326614e-01]
 [-1.25873240e+00  7.27530321e-01]
 [ 8.46005692e-02 -6.60164513e-02]
 [ 1.49930619e-02 -8.93084475e-02]
 [ 8.53665928e-02  2.97030312e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.10672849e-01 -2.71592964e-02]
 [-1.01198148e-01 -1.58428724e-01]
 [ 1.52695111e-01  2.31105377e-01]
 [-7.88584830e-02 -1.16479114e-01]
 [-1.97740678e-01 -2.88624167e-01]
 [ 2.68330210e-01 -3.43051627e-01]
 [-1.61076425e-01 -1.66316307e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.94597884]
curr_Stock_Price:  99.46218336448588
curr_Factors:  [9.94621834e+01 3.90498308e-02]
mat_Sqrt:  [[ 1.96547519e+01  0.00000000e+00]
 [-7.90441202e-03  1.81112832e-02]]
grads:  [3.51803121e-03 8.37061140e+00]
Stock Position:  0.00351803120720094
Bond Position:  [-1.2958899]


portfolio before change:  [-0.9513935]
curr_Stock_Price:  98.01516766409371
curr_Factors:  [9.80151677e+01 3.85742057e-02]
mat_Sqrt:  [[ 1.92504898e+01  0.00000000e+00]
 [-7.85612685e-03  1.80006480e-02]]
grads:  [ 8.11778075e-04 -3.26039824e+00]
Stock Position:  0.0008117780747503275
Bond Position:  [-1.03096006]


portfolio before change:  [-0.95189812]
curr_Stock_Price:  97.71108820726238
curr_Factors:  [9.77110882e+01 3.78031992e-02]
mat_Sqrt:  [[ 1.89980107e+01  0.00000000e+00]
 [-7.77721793e-03  1.78198449e-02]]
grads:  [  0.02248682 -12.5855011 ]
Stock Position:  0.0224868208665653
Bond Position:  [-3.14910985]


portfolio before change:  [-0.91519202]
curr_Stock_Price:  99.3784414965954
curr_Factors:  [9.93784415e+01 3.67254943e-02]
mat_Sqrt:  [[ 1.90447820e+01  0.00000000e+00]
 [-7.66555875e-03  1.75640016e-02]]
grads:  [-4.50448108e-03 -5.53526766e+00]
Stock Position:  -0.004504481084536779
Bond Position:  [-0.46754371]


portfolio before change:  [-0.92365219]
curr_Stock_Price:  101.2306578955407
curr_Factors:  [1.01230658e+02 3.51910953e-02]
mat_Sqrt:  [[ 1.89901525e+01  0.00000000e+00]
 [-7.50371591e-03  1.71931731e-02]]
grads:  [ 4.78099614e-04 -8.92710339e-01]
Stock Position:  0.00047809961378095066
Bond Position:  [-0.97205053]


portfolio before change:  [-0.92428633]
curr_Stock_Price:  100.41263001709919
curr_Factors:  [1.00412630e+02 3.29828771e-02]
mat_Sqrt:  [[ 1.82361271e+01  0.00000000e+00]
 [-7.26447544e-03  1.66450043e-02]]
grads:  [ 1.37068672e-03 -1.96005192e+00]
Stock Position:  0.001370686715078911
Bond Position:  [-1.06192059]


portfolio before change:  [-0.92648268]
curr_Stock_Price:  99.0039717854357
curr_Factors:  [9.90039718e+01 3.40181668e-02]
mat_Sqrt:  [[ 1.82603068e+01  0.00000000e+00]
 [-7.37760577e-03  1.69042184e-02]]
grads:  [-5.41909090e-03 -6.52657291e+00]
Stock Position:  -0.0054190909006786815
Bond Position:  [-0.38997115]


portfolio before change:  [-0.92522547]
curr_Stock_Price:  98.75398259889572
curr_Factors:  [9.87539826e+01 3.49713845e-02]
mat_Sqrt:  [[ 1.84676244e+01  0.00000000e+00]
 [-7.48025502e-03  1.71394174e-02]]
grads:  [-0.05096552 42.44778584]
Stock Position:  -0.050965523065265896
Bond Position:  [4.10782291]


portfolio before change:  [-0.9610535]
curr_Stock_Price:  99.47712082475022
curr_Factors:  [9.94771208e+01 3.31502609e-02]
mat_Sqrt:  [[ 1.81120114e+01  0.00000000e+00]
 [-7.28288524e-03  1.66871865e-02]]
grads:  [ 3.08020057e-03 -3.95611636e+00]
Stock Position:  0.0030802005685377195
Bond Position:  [-1.26746298]


portfolio before change:  [-0.96670405]
curr_Stock_Price:  97.74552956712066
curr_Factors:  [9.77455296e+01 3.35250900e-02]
mat_Sqrt:  [[ 1.78970677e+01  0.00000000e+00]
 [-7.32394320e-03  1.67812621e-02]]
grads:  [-1.34012681e-03 -5.32191484e+00]
Stock Position:  -0.0013401268063537957
Bond Position:  [-0.83571265]


portfolio before change:  [-0.96625368]
curr_Stock_Price:  97.25353715087066
curr_Factors:  [9.72535372e+01 3.53102057e-02]
mat_Sqrt:  [[ 1.82749219e+01  0.00000000e+00]
 [-7.51640400e-03  1.72222451e-02]]
grads:  [1.17648245e-02 1.72468984e+01]
Stock Position:  0.011764824511252374
Bond Position:  [-2.11042447]


portfolio before change:  [-0.97953544]
curr_Stock_Price:  96.16945046282666
curr_Factors:  [9.61694505e+01 3.43425861e-02]
mat_Sqrt:  [[ 1.78218848e+01  0.00000000e+00]
 [-7.41270111e-03  1.69846320e-02]]
grads:  [ 0.00269424 -0.50583274]
Stock Position:  0.002694242434871422
Bond Position:  [-1.23863925]


portfolio before change:  [-0.98417214]
curr_Stock_Price:  94.56343047755976
curr_Factors:  [9.45634305e+01 3.75062925e-02]
mat_Sqrt:  [[ 1.83136659e+01  0.00000000e+00]
 [-7.74661655e-03  1.77497284e-02]]
grads:  [ 0.00539595 -1.53012462]
Stock Position:  0.005395946443871033
Bond Position:  [-1.49443135]


portfolio before change:  [-0.99341287]
curr_Stock_Price:  92.92014576201099
curr_Factors:  [9.29201458e+01 3.79474163e-02]
mat_Sqrt:  [[ 1.81009341e+01  0.00000000e+00]
 [-7.79203863e-03  1.78538034e-02]]
grads:  [-0.00941068 -8.87366801]
Stock Position:  -0.009410680738305742
Bond Position:  [-0.11897105]


portfolio before change:  [-0.98446067]
curr_Stock_Price:  91.9657040567777
curr_Factors:  [9.19657041e+01 3.80678137e-02]
mat_Sqrt:  [[ 1.79434053e+01  0.00000000e+00]
 [-7.80438992e-03  1.78821038e-02]]
grads:  [ 0.01413097 12.92383605]
Stock Position:  0.01413097244410913
Bond Position:  [-2.2840255]


portfolio before change:  [-0.95845655]
curr_Stock_Price:  93.8463394148619
curr_Factors:  [9.38463394e+01 4.11410168e-02]
mat_Sqrt:  [[ 1.90350862e+01  0.00000000e+00]
 [-8.11329939e-03  1.85899043e-02]]
grads:  [-0.00681343 -6.26571886]
Stock Position:  -0.006813425196095498
Bond Position:  [-0.31904153]


portfolio before change:  [-0.96160934]
curr_Stock_Price:  94.2973648748033
curr_Factors:  [9.42973649e+01 3.94163371e-02]
mat_Sqrt:  [[ 1.87213727e+01  0.00000000e+00]
 [-7.94141923e-03  1.81960774e-02]]
grads:  [ -0.01729075 -15.8618894 ]
Stock Position:  -0.017290750891628643
Bond Position:  [0.6688629]


portfolio before change:  [-0.97059641]
curr_Stock_Price:  94.82679859098418
curr_Factors:  [9.48267986e+01 4.00495912e-02]
mat_Sqrt:  [[ 1.89771125e+01  0.00000000e+00]
 [-8.00495759e-03  1.83416620e-02]]
grads:  [ 6.25017138e-03 -1.87034101e+01]
Stock Position:  0.006250171376237191
Bond Position:  [-1.56328016]


portfolio before change:  [-0.96925283]
curr_Stock_Price:  95.10430423652795
curr_Factors:  [9.51043042e+01 4.07729303e-02]
mat_Sqrt:  [[ 1.9203754e+01  0.0000000e+00]
 [-8.0769232e-03  1.8506556e-02]]
grads:  [-0.01216756 -8.98688587]
Stock Position:  -0.012167559073912655
Bond Position:  [0.18793441]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.96903698]
Stock Price:  95.0904263443466
PL:  [-0.96903698]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 5.95692244e-03  1.23006742e-01]
 [ 3.76833980e-02 -6.40356800e-02]
 [ 4.85622549e-01 -2.12227577e-01]
 [-1.04971197e-01 -1.14356313e-01]
 [ 3.59876637e-01 -1.49939765e-02]
 [-1.32755892e-01 -2.17314614e-01]
 [-3.06715240e-02 -8.14144343e-02]
 [-1.26277319e+00  7.08721795e-01]
 [ 6.49052807e-02 -3.78465359e-02]
 [ 1.47156931e-02 -9.06451166e-02]
 [ 1.16612790e-01  3.44174327e-01]
 [ 8.54271065e-02 -7.94453864e-02]
 [ 8.38665715e-02  6.89524808e-03]
 [-1.10540488e-01 -1.78717831e-01]
 [ 1.37944950e-01  2.03240734e-01]
 [-1.14070818e-01 -1.28566130e-01]
 [-1.94147596e-01 -3.38700283e-01]
 [ 2.77947479e-01 -3.07410281e-01]
 [-1.52523509e-01 -1.64121509e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.1806887]
curr_Stock_Price:  99.78251093485262
curr_Factors:  [9.97825109e+01 4.13169516e-02]
mat_Sqrt:  [[ 2.02823636e+01  0.00000000e+00]
 [-8.13062867e-03  1.86296107e-02]]
grads:  [2.94055798e-03 6.60275433e+00]
Stock Position:  0.0029405579753551637
Bond Position:  [0.88727244]


portfolio before change:  [1.17438239]
curr_Stock_Price:  97.56247027177896
curr_Factors:  [9.75624703e+01 4.27760389e-02]
mat_Sqrt:  [[ 2.01782301e+01  0.00000000e+00]
 [-8.27294761e-03  1.89557043e-02]]
grads:  [ 4.82497027e-04 -3.37817466e+00]
Stock Position:  0.00048249702739231674
Bond Position:  [1.12730879]


portfolio before change:  [1.17405548]
curr_Stock_Price:  96.30077180013662
curr_Factors:  [9.63007718e+01 4.44184898e-02]
mat_Sqrt:  [[ 2.02960565e+01  0.00000000e+00]
 [-8.43027780e-03  1.93161931e-02]]
grads:  [  0.01936331 -10.98702921]
Stock Position:  0.019363310394058492
Bond Position:  [-0.69064625]


portfolio before change:  [1.18703177]
curr_Stock_Price:  96.97983786333906
curr_Factors:  [9.69798379e+01 4.50345911e-02]
mat_Sqrt:  [[ 2.05804358e+01  0.00000000e+00]
 [-8.48854203e-03  1.94496932e-02]]
grads:  [-0.00752561 -5.87959468]
Stock Position:  -0.007525612440819415
Bond Position:  [1.91686444]


portfolio before change:  [1.19851444]
curr_Stock_Price:  95.51771189800003
curr_Factors:  [9.55177119e+01 4.47521705e-02]
mat_Sqrt:  [[ 2.02064938e+01  0.00000000e+00]
 [-8.46188353e-03  1.93886109e-02]]
grads:  [ 0.0174861  -0.77333939]
Stock Position:  0.017486097894908813
Bond Position:  [-0.47171762]


portfolio before change:  [1.21869253]
curr_Stock_Price:  96.67840742187305
curr_Factors:  [9.66784074e+01 4.50684846e-02]
mat_Sqrt:  [[ 2.05241871e+01  0.00000000e+00]
 [-8.49173571e-03  1.94570108e-02]]
grads:  [-1.10893437e-02 -1.11689620e+01]
Stock Position:  -0.011089343676799472
Bond Position:  [2.29079262]


portfolio before change:  [1.20451363]
curr_Stock_Price:  98.00866333889626
curr_Factors:  [9.80086633e+01 4.47922376e-02]
mat_Sqrt:  [[ 2.07427267e+01  0.00000000e+00]
 [-8.46567068e-03  1.93972884e-02]]
grads:  [-3.19165832e-03 -4.19720699e+00]
Stock Position:  -0.0031916583151366316
Bond Position:  [1.5173238]


portfolio before change:  [1.2047016]
curr_Stock_Price:  98.06863659825372
curr_Factors:  [9.80686366e+01 4.45764717e-02]
mat_Sqrt:  [[ 2.07053694e+01  0.00000000e+00]
 [-8.44525635e-03  1.93505132e-02]]
grads:  [-0.046049   36.62547789]
Stock Position:  -0.04604900431573038
Bond Position:  [5.72066467]


portfolio before change:  [1.21442928]
curr_Stock_Price:  97.88845156433534
curr_Factors:  [9.78884516e+01 4.37111148e-02]
mat_Sqrt:  [[ 2.04657375e+01  0.00000000e+00]
 [-8.36288130e-03  1.91617683e-02]]
grads:  [ 0.00236433 -1.97510664]
Stock Position:  0.002364327120230782
Bond Position:  [0.98298896]


portfolio before change:  [1.21459675]
curr_Stock_Price:  97.85532768412257
curr_Factors:  [9.78553277e+01 4.47763688e-02]
mat_Sqrt:  [[ 2.07066056e+01  0.00000000e+00]
 [-8.46417096e-03  1.93938521e-02]]
grads:  [-1.19986248e-03 -4.67390987e+00]
Stock Position:  -0.001199862477495844
Bond Position:  [1.33200968]


portfolio before change:  [1.2178528]
curr_Stock_Price:  95.41921091331318
curr_Factors:  [9.54192109e+01 4.56306889e-02]
mat_Sqrt:  [[ 2.03828230e+01  0.00000000e+00]
 [-8.54453640e-03  1.95779924e-02]]
grads:  [1.30905705e-02 1.75796537e+01]
Stock Position:  0.013090570466913205
Bond Position:  [-0.03123911]


portfolio before change:  [1.20411317]
curr_Stock_Price:  94.37022532935202
curr_Factors:  [9.43702253e+01 4.58223888e-02]
mat_Sqrt:  [[ 2.02010459e+01  0.00000000e+00]
 [-8.56246589e-03  1.96190740e-02]]
grads:  [ 2.51245889e-03 -4.04939531e+00]
Stock Position:  0.002512458887315002
Bond Position:  [0.96701185]


portfolio before change:  [1.20141355]
curr_Stock_Price:  93.19950074137587
curr_Factors:  [9.31995007e+01 4.43545830e-02]
mat_Sqrt:  [[ 1.96283067e+01  0.00000000e+00]
 [-8.42421111e-03  1.93022925e-02]]
grads:  [0.00442605 0.35722431]
Stock Position:  0.004426051906423715
Bond Position:  [0.78890772]


portfolio before change:  [1.19598707]
curr_Stock_Price:  91.92890329036332
curr_Factors:  [9.19289033e+01 4.38896639e-02]
mat_Sqrt:  [[ 1.92589766e+01  0.00000000e+00]
 [-8.37994404e-03  1.92008639e-02]]
grads:  [-0.00978969 -9.30780156]
Stock Position:  -0.009789686543807172
Bond Position:  [2.09594222]


portfolio before change:  [1.1890977]
curr_Stock_Price:  92.68617214669051
curr_Factors:  [9.26861721e+01 4.36061545e-02]
mat_Sqrt:  [[ 1.93548068e+01  0.00000000e+00]
 [-8.35283468e-03  1.91387486e-02]]
grads:  [ 0.01171009 10.61933244]
Stock Position:  0.011710087342303076
Bond Position:  [0.10373453]


portfolio before change:  [1.21544741]
curr_Stock_Price:  94.93412933335787
curr_Factors:  [9.49341293e+01 4.31188725e-02]
mat_Sqrt:  [[ 1.97131520e+01  0.00000000e+00]
 [-8.30603371e-03  1.90315141e-02]]
grads:  [-0.0086329  -6.75543362]
Stock Position:  -0.008632900416646942
Bond Position:  [2.0350043]


portfolio before change:  [1.20254664]
curr_Stock_Price:  96.48744088666372
curr_Factors:  [9.64874409e+01 4.19233362e-02]
mat_Sqrt:  [[ 1.97559858e+01  0.00000000e+00]
 [-8.19007558e-03  1.87658206e-02]]
grads:  [-1.73096155e-02 -1.80487861e+01]
Stock Position:  -0.017309615504366528
Bond Position:  [2.87270714]


portfolio before change:  [1.21328889]
curr_Stock_Price:  95.90834164491753
curr_Factors:  [9.59083416e+01 4.13587245e-02]
mat_Sqrt:  [[ 1.95047303e+01  0.00000000e+00]
 [-8.13473781e-03  1.86390259e-02]]
grads:  [ 7.37168015e-03 -1.64928298e+01]
Stock Position:  0.007371680154095032
Bond Position:  [0.50628327]


portfolio before change:  [1.20890424]
curr_Stock_Price:  95.29637267229022
curr_Factors:  [9.52963727e+01 4.11397777e-02]
mat_Sqrt:  [[ 1.93289090e+01  0.00000000e+00]
 [-8.11317720e-03  1.85896243e-02]]
grads:  [-0.01159672 -8.82866198]
Stock Position:  -0.011596723257212694
Bond Position:  [2.3140299]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.18855312]
Stock Price:  97.10116709475119
PL:  [1.18855312]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.55853723e-02  2.82924738e-02]
 [ 4.07200118e-02 -5.94725192e-02]
 [ 5.27129037e-01 -2.24895511e-01]
 [-9.39276132e-02 -9.85649490e-02]
 [ 3.61046147e-01 -1.50795599e-02]
 [-1.42722950e-01 -2.24487758e-01]
 [-2.29199909e-02 -5.08670990e-02]
 [-1.28499707e+00  6.85666415e-01]
 [ 3.29670538e-02  7.73312133e-03]
 [ 2.58869687e-02 -3.68095701e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 8.40434933e-02 -7.62653911e-02]
 [ 7.24571331e-02  2.22663348e-02]
 [-1.17695942e-01 -1.94232087e-01]
 [ 1.80031492e-01  2.82632091e-01]
 [ 2.91773107e-02 -9.65016541e-02]
 [-2.07774940e-01 -1.48160711e-01]
 [ 6.12733145e-01 -5.93491488e-01]
 [-5.13752551e-01 -2.56819035e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.82577997]
curr_Stock_Price:  100.78342240895908
curr_Factors:  [1.00783422e+02 3.78046803e-02]
mat_Sqrt:  [[ 1.95957498e+01  0.00000000e+00]
 [-7.77737028e-03  1.78201940e-02]]
grads:  [1.42547340e-03 1.58766362e+00]
Stock Position:  0.0014254734003778479
Bond Position:  [7.68211589]


portfolio before change:  [7.82369138]
curr_Stock_Price:  97.97076642955933
curr_Factors:  [9.79707664e+01 3.65356344e-02]
mat_Sqrt:  [[ 1.87264231e+01  0.00000000e+00]
 [-7.64571874e-03  1.75185424e-02]]
grads:  [ 7.88408787e-04 -3.39483261e+00]
Stock Position:  0.0007884087866216797
Bond Position:  [7.74645036]


portfolio before change:  [7.82556583]
curr_Stock_Price:  97.89161362647859
curr_Factors:  [9.78916136e+01 3.65616931e-02]
mat_Sqrt:  [[ 1.87179653e+01  0.00000000e+00]
 [-7.64844487e-03  1.75247888e-02]]
grads:  [  0.02291791 -12.83299409]
Stock Position:  0.02291790708714661
Bond Position:  [5.58209492]


portfolio before change:  [7.79195139]
curr_Stock_Price:  96.363981329397
curr_Factors:  [9.63639813e+01 4.11560944e-02]
mat_Sqrt:  [[ 1.95493270e+01  0.00000000e+00]
 [-8.11478595e-03  1.85933104e-02]]
grads:  [-0.00700509 -5.30109737]
Stock Position:  -0.007005094518106962
Bond Position:  [8.46699019]


portfolio before change:  [7.8001979]
curr_Stock_Price:  95.48897591322479
curr_Factors:  [9.54889759e+01 4.20572493e-02]
mat_Sqrt:  [[ 1.95827495e+01  0.00000000e+00]
 [-8.20314567e-03  1.87957680e-02]]
grads:  [ 0.01810087 -0.80228485]
Stock Position:  0.018100874317839858
Bond Position:  [6.07176395]


portfolio before change:  [7.82201293]
curr_Stock_Price:  96.61029767832412
curr_Factors:  [9.66102977e+01 3.86071756e-02]
mat_Sqrt:  [[ 1.8982676e+01  0.0000000e+00]
 [-7.8594835e-03  1.8008339e-02]]
grads:  [ -0.01267985 -12.46576695]
Stock Position:  -0.012679847647318866
Bond Position:  [9.04701679]


portfolio before change:  [7.8262645]
curr_Stock_Price:  96.45339299196367
curr_Factors:  [9.64533930e+01 3.83233183e-02]
mat_Sqrt:  [[ 1.88820465e+01  0.00000000e+00]
 [-7.83053697e-03  1.79420142e-02]]
grads:  [-2.38958277e-03 -2.83508297e+00]
Stock Position:  -0.0023895827667496767
Bond Position:  [8.05674786]


portfolio before change:  [7.82677672]
curr_Stock_Price:  97.08204591610301
curr_Factors:  [9.70820459e+01 3.72930886e-02]
mat_Sqrt:  [[ 1.87479202e+01  0.00000000e+00]
 [-7.72456742e-03  1.76992074e-02]]
grads:  [-0.05257904 38.7399502 ]
Stock Position:  -0.05257904338008469
Bond Position:  [12.93125782]


portfolio before change:  [7.92257764]
curr_Stock_Price:  95.32150213767454
curr_Factors:  [9.53215021e+01 3.74056558e-02]
mat_Sqrt:  [[ 1.84356950e+01  0.00000000e+00]
 [-7.73621673e-03  1.77258994e-02]]
grads:  [0.00197129 0.43626115]
Stock Position:  0.0019712880196822036
Bond Position:  [7.73467151]


portfolio before change:  [7.91856913]
curr_Stock_Price:  92.30701218069056
curr_Factors:  [9.23070122e+01 4.02193280e-02]
mat_Sqrt:  [[ 1.85119470e+01  0.00000000e+00]
 [-8.02190282e-03  1.83804884e-02]]
grads:  [ 5.30573864e-04 -2.00264374e+00]
Stock Position:  0.0005305738639566417
Bond Position:  [7.86959344]


portfolio before change:  [7.92119753]
curr_Stock_Price:  93.55237159362397
curr_Factors:  [9.35523716e+01 3.85149476e-02]
mat_Sqrt:  [[ 1.83598639e+01  0.00000000e+00]
 [-7.85009020e-03  1.79868163e-02]]
grads:  [1.47007844e-02 1.94347233e+01]
Stock Position:  0.014700784422687971
Bond Position:  [6.54590428]


portfolio before change:  [7.93592369]
curr_Stock_Price:  94.4427649591807
curr_Factors:  [9.44427650e+01 3.63190689e-02]
mat_Sqrt:  [[ 1.79984890e+01  0.00000000e+00]
 [-7.62302500e-03  1.74665445e-02]]
grads:  [ 2.82015607e-03 -4.36636971e+00]
Stock Position:  0.00282015606705476
Bond Position:  [7.66958035]


portfolio before change:  [7.93290547]
curr_Stock_Price:  92.69255972554875
curr_Factors:  [9.26925597e+01 3.70534701e-02]
mat_Sqrt:  [[ 1.78426484e+01  0.00000000e+00]
 [-7.69971117e-03  1.76422546e-02]]
grads:  [0.00460554 1.26210256]
Stock Position:  0.004605535916676034
Bond Position:  [7.50600656]


portfolio before change:  [7.92772508]
curr_Stock_Price:  91.16024610702368
curr_Factors:  [9.11602461e+01 3.68389995e-02]
mat_Sqrt:  [[ 1.74968312e+01  0.00000000e+00]
 [-7.67739534e-03  1.75911227e-02]]
grads:  [ -0.01157157 -11.0414833 ]
Stock Position:  -0.011571568115842909
Bond Position:  [8.98259208]


portfolio before change:  [7.93601952]
curr_Stock_Price:  90.63754128667242
curr_Factors:  [9.06375413e+01 3.78829087e-02]
mat_Sqrt:  [[ 1.76412671e+01  0.00000000e+00]
 [-7.78541289e-03  1.78386219e-02]]
grads:  [ 0.0171973  15.84382987]
Stock Position:  0.017197304973525302
Bond Position:  [6.37729808]


portfolio before change:  [7.89498191]
curr_Stock_Price:  88.15854000488702
curr_Factors:  [8.81585400e+01 3.95813961e-02]
mat_Sqrt:  [[ 1.75392066e+01  0.00000000e+00]
 [-7.95802951e-03  1.82341363e-02]]
grads:  [-7.37745117e-04 -5.29236222e+00]
Stock Position:  -0.0007377451167020261
Bond Position:  [7.96002044]


portfolio before change:  [7.89686496]
curr_Stock_Price:  88.30384312046031
curr_Factors:  [8.83038431e+01 4.06410095e-02]
mat_Sqrt:  [[ 1.78017152e+01  0.00000000e+00]
 [-8.06384617e-03  1.84765927e-02]]
grads:  [-0.01530401 -8.01883296]
Stock Position:  -0.015304007100984618
Bond Position:  [9.24826761]


portfolio before change:  [7.9017177]
curr_Stock_Price:  88.13784854542843
curr_Factors:  [8.81378485e+01 3.86133836e-02]
mat_Sqrt:  [[ 1.73193415e+01  0.00000000e+00]
 [-7.86011538e-03  1.80097869e-02]]
grads:  [ 2.04229603e-02 -3.29538319e+01]
Stock Position:  0.020422960321245902
Bond Position:  [6.10168192]


portfolio before change:  [7.88390587]
curr_Stock_Price:  87.19100053037863
curr_Factors:  [8.71910005e+01 3.63201068e-02]
mat_Sqrt:  [[ 1.66167169e+01  0.00000000e+00]
 [-7.62313393e-03  1.74667941e-02]]
grads:  [ -0.03766313 -14.70327259]
Stock Position:  -0.0376631299689681
Bond Position:  [11.16779186]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.98767156]
Stock Price:  84.51003922992687
PL:  [7.98767156]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.18083275e-02  1.13907149e-01]
 [-2.40756646e-01  1.81368913e-01]
 [ 9.08788698e-01 -3.41379452e-01]
 [ 3.53262881e-01 -7.06193986e-02]
 [ 2.27477697e-01 -3.01867329e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-3.96937823e-01 -1.24511909e-01]
 [-1.49567937e+00  7.35535584e-01]
 [ 2.40314086e-02 -7.79153715e-02]
 [ 1.27106595e-01  3.56427764e-01]
 [-3.55730144e-01 -5.44177402e-02]
 [-1.38083719e-02 -1.03222987e-02]
 [ 1.02293683e-02 -5.73143173e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.16798071e-01 -6.21933362e-02]
 [-1.00834408e-01 -1.07283973e-01]
 [-1.40567924e-01 -6.02555685e-01]
 [-2.43529282e-01 -3.76781268e-02]
 [ 1.42835889e-01  3.65917120e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.83721524]
curr_Stock_Price:  100.18264808679147
curr_Factors:  [1.00182648e+02 4.00020438e-02]
mat_Sqrt:  [[ 2.00370415e+01  0.00000000e+00]
 [-8.00020438e-03  1.83307711e-02]]
grads:  [4.06853892e-03 6.21398570e+00]
Stock Position:  0.004068538917338932
Bond Position:  [3.42961824]


portfolio before change:  [3.84988683]
curr_Stock_Price:  103.08641195872566
curr_Factors:  [1.03086412e+02 3.92864951e-02]
mat_Sqrt:  [[ 2.04325733e+01  0.00000000e+00]
 [-7.92832846e-03  1.81660827e-02]]
grads:  [-7.90897751e-03  9.98393083e+00]
Stock Position:  -0.007908977506377582
Bond Position:  [4.66519494]


portfolio before change:  [3.84462385]
curr_Stock_Price:  103.89933991240262
curr_Factors:  [1.03899340e+02 3.67971475e-02]
mat_Sqrt:  [[ 1.99305767e+01  0.00000000e+00]
 [-7.67303304e-03  1.75811274e-02]]
grads:  [  0.03812225 -19.41738122]
Stock Position:  0.03812225313008685
Bond Position:  [-0.11625309]


portfolio before change:  [3.8162282]
curr_Stock_Price:  103.15524492560942
curr_Factors:  [1.03155245e+02 3.60310484e-02]
mat_Sqrt:  [[ 1.95807699e+01  0.00000000e+00]
 [-7.59273847e-03  1.73971494e-02]]
grads:  [ 0.01646728 -4.05925115]
Stock Position:  0.016467281441108265
Bond Position:  [2.11754175]


portfolio before change:  [3.82822575]
curr_Stock_Price:  103.85166191038603
curr_Factors:  [1.03851662e+02 3.78731613e-02]
mat_Sqrt:  [[ 2.02106011e+01  0.00000000e+00]
 [-7.78441122e-03  1.78363268e-02]]
grads:  [ 0.0106035 -1.6924299]
Stock Position:  0.010603500892933156
Bond Position:  [2.72703456]


portfolio before change:  [3.83758189]
curr_Stock_Price:  104.66972172785742
curr_Factors:  [1.04669722e+02 3.65567472e-02]
mat_Sqrt:  [[ 2.00126612e+01  0.00000000e+00]
 [-7.64792753e-03  1.75236034e-02]]
grads:  [-2.89627727e-05 -1.10429206e+00]
Stock Position:  -2.896277271552444e-05
Bond Position:  [3.84061341]


portfolio before change:  [3.83854978]
curr_Stock_Price:  104.4068507306432
curr_Factors:  [1.04406851e+02 3.67545549e-02]
mat_Sqrt:  [[ 2.00163359e+01  0.00000000e+00]
 [-7.66859100e-03  1.75709494e-02]]
grads:  [-0.02254555 -7.08623685]
Stock Position:  -0.02254554867384875
Bond Position:  [6.19245951]


portfolio before change:  [3.81043454]
curr_Stock_Price:  105.72256681313411
curr_Factors:  [1.05722567e+02 3.65533623e-02]
mat_Sqrt:  [[ 2.02130274e+01  0.00000000e+00]
 [-7.64757345e-03  1.75227921e-02]]
grads:  [-0.05811427 41.97593512]
Stock Position:  -0.058114269670484435
Bond Position:  [9.9544243]


portfolio before change:  [3.84642244]
curr_Stock_Price:  105.1461339573181
curr_Factors:  [1.05146134e+02 3.58111080e-02]
mat_Sqrt:  [[ 1.98976684e+01  0.00000000e+00]
 [-7.56952923e-03  1.73439703e-02]]
grads:  [-5.01247038e-04 -4.49236074e+00]
Stock Position:  -0.0005012470382504344
Bond Position:  [3.89912662]


portfolio before change:  [3.84822139]
curr_Stock_Price:  103.50213043789427
curr_Factors:  [1.03502130e+02 3.65987442e-02]
mat_Sqrt:  [[ 1.98007838e+01  0.00000000e+00]
 [-7.65231930e-03  1.75336662e-02]]
grads:  [1.42754160e-02 2.03281938e+01]
Stock Position:  0.014275415973910466
Bond Position:  [2.37068542]


portfolio before change:  [3.86042088]
curr_Stock_Price:  104.31518842639258
curr_Factors:  [1.04315188e+02 3.48041991e-02]
mat_Sqrt:  [[ 1.94609201e+01  0.00000000e+00]
 [-7.46235342e-03  1.70983997e-02]]
grads:  [-0.01949959 -3.18262183]
Stock Position:  -0.01949959154208906
Bond Position:  [5.89452444]


portfolio before change:  [3.86996038]
curr_Stock_Price:  103.90155501787538
curr_Factors:  [1.03901555e+02 3.60338976e-02]
mat_Sqrt:  [[ 1.97232131e+01  0.00000000e+00]
 [-7.59303867e-03  1.73978372e-02]]
grads:  [-0.00092852 -0.5933093 ]
Stock Position:  -0.0009285197225200155
Bond Position:  [3.96643502]


portfolio before change:  [3.87046811]
curr_Stock_Price:  104.42280985718759
curr_Factors:  [1.04422810e+02 3.74197935e-02]
mat_Sqrt:  [[ 2.01997534e+01  0.00000000e+00]
 [-7.73767856e-03  1.77292489e-02]]
grads:  [-7.31922326e-04 -3.23275497e+00]
Stock Position:  -0.0007319223259731074
Bond Position:  [3.9468975]


portfolio before change:  [3.8717382]
curr_Stock_Price:  104.0358287848217
curr_Factors:  [1.04035829e+02 3.82877583e-02]
mat_Sqrt:  [[ 2.03569590e+01  0.00000000e+00]
 [-7.82690317e-03  1.79336881e-02]]
grads:  [7.47838329e-03 8.28485967e+00]
Stock Position:  0.0074783832949676604
Bond Position:  [3.0937184]


portfolio before change:  [3.86045651]
curr_Stock_Price:  102.42382015413045
curr_Factors:  [1.02423820e+02 4.14008296e-02]
mat_Sqrt:  [[ 2.08403732e+01  0.00000000e+00]
 [-8.13887753e-03  1.86485112e-02]]
grads:  [-0.00690686 -3.33502957]
Stock Position:  -0.006906856542535667
Bond Position:  [4.56788314]


portfolio before change:  [3.85078937]
curr_Stock_Price:  103.98882310324011
curr_Factors:  [1.03988823e+02 3.86118990e-02]
mat_Sqrt:  [[ 2.04337109e+01  0.00000000e+00]
 [-7.85996427e-03  1.80094406e-02]]
grads:  [-0.00722615 -5.95709634]
Stock Position:  -0.007226145710303396
Bond Position:  [4.60222776]


portfolio before change:  [3.8412466]
curr_Stock_Price:  105.46865388380277
curr_Factors:  [1.05468654e+02 3.93413212e-02]
mat_Sqrt:  [[ 2.09193349e+01  0.00000000e+00]
 [-7.93385870e-03  1.81787540e-02]]
grads:  [-1.92905169e-02 -3.31461487e+01]
Stock Position:  -0.019290516915370728
Bond Position:  [5.87579145]


portfolio before change:  [3.85198791]
curr_Stock_Price:  104.98799365062746
curr_Factors:  [1.04987994e+02 3.87894718e-02]
mat_Sqrt:  [[ 2.06774305e+01  0.00000000e+00]
 [-7.87801719e-03  1.80508050e-02]]
grads:  [-0.01257281 -2.08733775]
Stock Position:  -0.012572808094510573
Bond Position:  [5.17198181]


portfolio before change:  [3.87549956]
curr_Stock_Price:  103.22080747341448
curr_Factors:  [1.03220807e+02 3.91324018e-02]
mat_Sqrt:  [[ 2.04190487e+01  0.00000000e+00]
 [-7.91276456e-03  1.81304213e-02]]
grads:  [0.00777734 2.01824941]
Stock Position:  0.007777336923874881
Bond Position:  [3.07271657]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.8550533]
Stock Price:  100.49306936072186
PL:  [3.36198394]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 4.08502095e-02  8.81511437e-02]
 [ 4.42273211e-02 -5.42020379e-02]
 [ 5.10971544e-01 -2.19964185e-01]
 [-7.58834997e-02 -9.42255392e-02]
 [ 3.79132532e-02 -1.16062836e-02]
 [ 1.66967988e-02 -1.88604327e-02]
 [-1.77117967e-01 -1.90758270e-01]
 [-1.39039201e+00  7.48178080e-01]
 [ 6.53376129e-02 -7.78386813e-02]
 [ 1.00457255e-01  2.27776613e-01]
 [-8.40087012e-02 -1.12842430e-01]
 [ 1.51956023e-02 -9.15537083e-03]
 [ 8.30802770e-02 -2.29855470e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.16669041e-01 -6.21201048e-02]
 [-1.14641981e-01 -1.13135067e-01]
 [-1.68403492e-01 -5.01733385e-01]
 [-6.01029448e-03 -1.68780601e-01]
 [ 9.65792566e-02 -7.31105045e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.26206518]
curr_Stock_Price:  98.66145217881032
curr_Factors:  [9.86614522e+01 3.83359059e-02]
mat_Sqrt:  [[ 1.93174754e+01  0.00000000e+00]
 [-7.83182287e-03  1.79449606e-02]]
grads:  [4.10625721e-03 4.91230635e+00]
Stock Position:  0.004106257205973032
Bond Position:  [-6.66719448]


portfolio before change:  [-6.26493087]
curr_Stock_Price:  98.36953679116286
curr_Factors:  [9.83695368e+01 3.81452389e-02]
mat_Sqrt:  [[ 1.92123635e+01  0.00000000e+00]
 [-7.81232246e-03  1.79002795e-02]]
grads:  [ 1.07074865e-03 -3.02799953e+00]
Stock Position:  0.0010707486534414419
Bond Position:  [-6.37025991]


portfolio before change:  [-6.26770398]
curr_Stock_Price:  97.26717802571683
curr_Factors:  [9.72671780e+01 3.96633006e-02]
mat_Sqrt:  [[ 1.93713881e+01  0.00000000e+00]
 [-7.96625890e-03  1.82529922e-02]]
grads:  [  0.02142187 -12.05085621]
Stock Position:  0.021421867259285847
Bond Position:  [-8.35134856]


portfolio before change:  [-6.22961252]
curr_Stock_Price:  99.1428108054338
curr_Factors:  [9.91428108e+01 3.90890202e-02]
mat_Sqrt:  [[ 1.96014690e+01  0.00000000e+00]
 [-7.90837735e-03  1.81203689e-02]]
grads:  [-0.00596929 -5.19997907]
Stock Position:  -0.005969292222555032
Bond Position:  [-5.63780011]


portfolio before change:  [-6.23846325]
curr_Stock_Price:  100.38937509920156
curr_Factors:  [1.00389375e+02 3.93737663e-02]
mat_Sqrt:  [[ 1.99200870e+01  0.00000000e+00]
 [-7.93712958e-03  1.81862486e-02]]
grads:  [ 0.00164898 -0.63819009]
Stock Position:  0.0016489815451652817
Bond Position:  [-6.40400348]


portfolio before change:  [-6.23854366]
curr_Stock_Price:  101.31164026986615
curr_Factors:  [1.01311640e+02 3.78933628e-02]
mat_Sqrt:  [[ 1.97215444e+01  0.00000000e+00]
 [-7.78648704e-03  1.78410831e-02]]
grads:  [ 4.29247880e-04 -1.05713496e+00]
Stock Position:  0.0004292478802412095
Bond Position:  [-6.28203146]


portfolio before change:  [-6.23968066]
curr_Stock_Price:  102.32201173724219
curr_Factors:  [1.02322012e+02 3.59111143e-02]
mat_Sqrt:  [[ 1.93902546e+01  0.00000000e+00]
 [-7.58009122e-03  1.73681709e-02]]
grads:  [ -0.01342797 -10.98321007]
Stock Position:  -0.013427967166217936
Bond Position:  [-4.86570405]


portfolio before change:  [-6.24619101]
curr_Stock_Price:  102.7162463906774
curr_Factors:  [1.02716246e+02 3.44867536e-02]
mat_Sqrt:  [[ 1.90750330e+01  0.00000000e+00]
 [-7.42824379e-03  1.70202447e-02]]
grads:  [-0.0557724 43.9581271]
Stock Position:  -0.055772397958508725
Bond Position:  [-0.51745964]


portfolio before change:  [-6.19842514]
curr_Stock_Price:  101.85748385388503
curr_Factors:  [1.01857484e+02 3.43459348e-02]
mat_Sqrt:  [[ 1.88768973e+01  0.00000000e+00]
 [-7.41306250e-03  1.69854600e-02]]
grads:  [ 1.66160925e-03 -4.58266548e+00]
Stock Position:  0.0016616092518580538
Bond Position:  [-6.36767248]


portfolio before change:  [-6.19967582]
curr_Stock_Price:  102.06297040763039
curr_Factors:  [1.02062970e+02 3.51544105e-02]
mat_Sqrt:  [[ 1.91363063e+01  0.00000000e+00]
 [-7.49980379e-03  1.71842093e-02]]
grads:  [1.04443938e-02 1.32549953e+01]
Stock Position:  0.01044439379396177
Bond Position:  [-7.26566168]


portfolio before change:  [-6.21801333]
curr_Stock_Price:  100.48117749621859
curr_Factors:  [1.00481177e+02 3.50548439e-02]
mat_Sqrt:  [[ 1.88130294e+01  0.00000000e+00]
 [-7.48917554e-03  1.71598569e-02]]
grads:  [-0.00708324 -6.57595405]
Stock Position:  -0.007083238557893017
Bond Position:  [-5.50628118]


portfolio before change:  [-6.22694286]
curr_Stock_Price:  101.54746663846126
curr_Factors:  [1.01547467e+02 3.52788676e-02]
mat_Sqrt:  [[ 1.90733251e+01  0.00000000e+00]
 [-7.51306782e-03  1.72146010e-02]]
grads:  [ 0.0005872  -0.53183753]
Stock Position:  0.0005872007532543352
Bond Position:  [-6.2865716]


portfolio before change:  [-6.22827483]
curr_Stock_Price:  101.9559549678268
curr_Factors:  [1.01955955e+02 3.46831986e-02]
mat_Sqrt:  [[ 1.89876915e+01  0.00000000e+00]
 [-7.44937029e-03  1.70686516e-02]]
grads:  [ 0.00384715 -1.34665277]
Stock Position:  0.003847153389097118
Bond Position:  [-6.62051503]


portfolio before change:  [-6.22632653]
curr_Stock_Price:  102.89265754119447
curr_Factors:  [1.02892658e+02 3.52030998e-02]
mat_Sqrt:  [[ 1.93052237e+01  0.00000000e+00]
 [-7.50499564e-03  1.71961053e-02]]
grads:  [7.88580047e-03 8.64021746e+00]
Stock Position:  0.007885800465184585
Bond Position:  [-7.03771749]


portfolio before change:  [-6.22961443]
curr_Stock_Price:  102.69885987323525
curr_Factors:  [1.0269886e+02 3.5878315e-02]
mat_Sqrt:  [[ 1.94527785e+01  0.00000000e+00]
 [-7.57662880e-03  1.73602375e-02]]
grads:  [-0.00739126 -3.5782981 ]
Stock Position:  -0.0073912565956376665
Bond Position:  [-5.4705408]


portfolio before change:  [-6.23655363]
curr_Stock_Price:  103.45264220788826
curr_Factors:  [1.03452642e+02 3.49480974e-02]
mat_Sqrt:  [[ 1.93398613e+01  0.00000000e+00]
 [-7.47776409e-03  1.71337100e-02]]
grads:  [-0.00848083 -6.60306886]
Stock Position:  -0.008480834950349092
Bond Position:  [-5.35918885]


portfolio before change:  [-6.22239869]
curr_Stock_Price:  101.62559244345121
curr_Factors:  [1.01625592e+02 3.61442659e-02]
mat_Sqrt:  [[ 1.93206972e+01  0.00000000e+00]
 [-7.60465814e-03  1.74244608e-02]]
grads:  [-2.00498920e-02 -2.87947725e+01]
Stock Position:  -0.020049892026372917
Bond Position:  [-4.18481653]


portfolio before change:  [-6.24339413]
curr_Stock_Price:  102.6205657916212
curr_Factors:  [1.02620566e+02 3.80867919e-02]
mat_Sqrt:  [[ 2.00272630e+01  0.00000000e+00]
 [-7.80633506e-03  1.78865607e-02]]
grads:  [-3.97818652e-03 -9.43616853e+00]
Stock Position:  -0.00397818651610836
Bond Position:  [-5.83515038]


portfolio before change:  [-6.23846493]
curr_Stock_Price:  101.01476624132958
curr_Factors:  [1.01014766e+02 3.94451393e-02]
mat_Sqrt:  [[ 2.00623411e+01  0.00000000e+00]
 [-7.94432016e-03  1.82027242e-02]]
grads:  [ 3.22351296e-03 -4.01645949e+00]
Stock Position:  0.0032235129565351714
Bond Position:  [-6.56408734]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.24149431]
Stock Price:  100.58413346022785
PL:  [-6.82562777]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.80077428e-03  1.54680153e-01]
 [ 3.60745119e-02 -6.64533750e-02]
 [ 6.49863104e-01 -2.62354403e-01]
 [-1.17412165e-01 -1.32749242e-01]
 [ 2.79542748e-01 -9.11523493e-03]
 [-6.41323841e-02 -1.71239123e-01]
 [-1.47848943e-02 -5.85939359e-02]
 [-1.28444055e+00  6.85022592e-01]
 [ 2.46654245e-02  1.95939688e-02]
 [ 2.03412633e-02 -6.35349052e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 1.22944399e-01 -1.62403994e-01]
 [ 7.20530392e-02  2.25001174e-02]
 [-9.96945423e-02 -1.55172876e-01]
 [ 1.36971361e-01  2.01425042e-01]
 [-1.30732916e-01 -1.34278406e-01]
 [-1.95973067e-01 -3.13264722e-01]
 [ 3.44268154e-01 -3.98236453e-01]
 [-2.18892400e-01 -1.81152994e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.58381631]
curr_Stock_Price:  99.36610961405907
curr_Factors:  [9.93661096e+01 3.91626419e-02]
mat_Sqrt:  [[ 1.96641092e+01  0.00000000e+00]
 [-7.91582132e-03  1.81374252e-02]]
grads:  [3.62633907e-03 8.52823107e+00]
Stock Position:  0.0036263390707976365
Bond Position:  [-1.94415151]


portfolio before change:  [-1.59145638]
curr_Stock_Price:  97.39332894508541
curr_Factors:  [9.73933289e+01 4.08401459e-02]
mat_Sqrt:  [[ 1.96821643e+01  0.00000000e+00]
 [-8.08357801e-03  1.85218041e-02]]
grads:  [ 3.59304052e-04 -3.58784570e+00]
Stock Position:  0.0003593040515995376
Bond Position:  [-1.6264502]


portfolio before change:  [-1.59114368]
curr_Stock_Price:  99.39542847009449
curr_Factors:  [9.93954285e+01 4.00941538e-02]
mat_Sqrt:  [[ 1.99024681e+01  0.00000000e+00]
 [-8.00940985e-03  1.83518634e-02]]
grads:  [  0.02689929 -14.29579092]
Stock Position:  0.02689928975866312
Bond Position:  [-4.26481011]


portfolio before change:  [-1.63923321]
curr_Stock_Price:  97.64730803599953
curr_Factors:  [9.76473080e+01 3.96143494e-02]
mat_Sqrt:  [[ 1.94350892e+01  0.00000000e+00]
 [-7.96134153e-03  1.82417251e-02]]
grads:  [-0.00902227 -7.27723072]
Stock Position:  -0.009022273158223439
Bond Position:  [-0.75823253]


portfolio before change:  [-1.64037742]
curr_Stock_Price:  97.7531160508981
curr_Factors:  [9.77531161e+01 3.75557212e-02]
mat_Sqrt:  [[ 1.89438682e+01  0.00000000e+00]
 [-7.75171942e-03  1.77614205e-02]]
grads:  [ 0.01454637 -0.51320416]
Stock Position:  0.014546370932185844
Bond Position:  [-3.06233051]


portfolio before change:  [-1.64931604]
curr_Stock_Price:  97.1912620492538
curr_Factors:  [9.71912620e+01 4.01893849e-02]
mat_Sqrt:  [[ 1.94842145e+01  0.00000000e+00]
 [-8.01891612e-03  1.83736451e-02]]
grads:  [-7.12716772e-03 -9.31982318e+00]
Stock Position:  -0.00712716772478754
Bond Position:  [-0.95661761]


portfolio before change:  [-1.64996624]
curr_Stock_Price:  97.24893105636201
curr_Factors:  [9.72489311e+01 4.00399443e-02]
mat_Sqrt:  [[ 1.94594951e+01  0.00000000e+00]
 [-8.00399343e-03  1.83394529e-02]]
grads:  [-2.07391734e-03 -3.19496641e+00]
Stock Position:  -0.002073917341846623
Bond Position:  [-1.44827999]


portfolio before change:  [-1.64994582]
curr_Stock_Price:  97.06448013813761
curr_Factors:  [9.70644801e+01 3.83885861e-02]
mat_Sqrt:  [[ 1.90178488e+01  0.00000000e+00]
 [-7.83720216e-03  1.79572861e-02]]
grads:  [-0.05181828 38.14733411]
Stock Position:  -0.05181827815294149
Bond Position:  [3.37976841]


portfolio before change:  [-1.52414466]
curr_Stock_Price:  94.6530508639327
curr_Factors:  [9.46530509e+01 3.88776067e-02]
mat_Sqrt:  [[ 1.86631256e+01  0.00000000e+00]
 [-7.88696208e-03  1.80713004e-02]]
grads:  [0.00177982 1.08425893]
Stock Position:  0.0017798162169739718
Bond Position:  [-1.69260969]


portfolio before change:  [-1.52379477]
curr_Stock_Price:  95.08741790330062
curr_Factors:  [9.50874179e+01 3.96064613e-02]
mat_Sqrt:  [[ 1.89237009e+01  0.00000000e+00]
 [-7.96054885e-03  1.82399088e-02]]
grads:  [-3.90391009e-04 -3.48329072e+00]
Stock Position:  -0.0003903910086852972
Bond Position:  [-1.4866735]


portfolio before change:  [-1.52322208]
curr_Stock_Price:  92.668287751725
curr_Factors:  [9.26682878e+01 4.25168850e-02]
mat_Sqrt:  [[ 1.91078515e+01  0.00000000e+00]
 [-8.24784918e-03  1.88981966e-02]]
grads:  [1.41253139e-02 1.84974686e+01]
Stock Position:  0.014125313918724632
Bond Position:  [-2.83219073]


portfolio before change:  [-1.52731118]
curr_Stock_Price:  92.42893262820412
curr_Factors:  [9.24289326e+01 4.28277929e-02]
mat_Sqrt:  [[ 1.91280538e+01  0.00000000e+00]
 [-8.27795075e-03  1.89671680e-02]]
grads:  [ 2.72194367e-03 -8.56237446e+00]
Stock Position:  0.0027219436706724075
Bond Position:  [-1.77889753]


portfolio before change:  [-1.52715823]
curr_Stock_Price:  92.64853123941613
curr_Factors:  [9.26485312e+01 4.04148902e-02]
mat_Sqrt:  [[ 1.86255558e+01  0.00000000e+00]
 [-8.04138199e-03  1.84251208e-02]]
grads:  [0.00439573 1.22116526]
Stock Position:  0.004395728996894775
Bond Position:  [-1.93441606]


portfolio before change:  [-1.52573106]
curr_Stock_Price:  93.08323305129015
curr_Factors:  [9.30832331e+01 4.13520881e-02]
mat_Sqrt:  [[ 1.89286735e+01  0.00000000e+00]
 [-8.13408513e-03  1.86375304e-02]]
grads:  [-0.00884465 -8.32582818]
Stock Position:  -0.008844652376560526
Bond Position:  [-0.70244222]


portfolio before change:  [-1.52280259]
curr_Stock_Price:  92.7322751599591
curr_Factors:  [9.27322752e+01 4.19039518e-02]
mat_Sqrt:  [[ 1.89827184e+01  0.00000000e+00]
 [-8.18818190e-03  1.87614817e-02]]
grads:  [ 0.01184659 10.73609457]
Stock Position:  0.011846588643080054
Bond Position:  [-2.62136371]


portfolio before change:  [-1.49127651]
curr_Stock_Price:  95.44879590783738
curr_Factors:  [9.54487959e+01 4.24361917e-02]
mat_Sqrt:  [[ 1.96624964e+01  0.00000000e+00]
 [-8.24001862e-03  1.88802545e-02]]
grads:  [-0.00962934 -7.1121078 ]
Stock Position:  -0.009629337660182813
Bond Position:  [-0.57216782]


portfolio before change:  [-1.49089703]
curr_Stock_Price:  95.39453031239644
curr_Factors:  [9.53945303e+01 4.25972703e-02]
mat_Sqrt:  [[ 1.96885784e+01  0.00000000e+00]
 [-8.25564246e-03  1.89160532e-02]]
grads:  [ -0.01689777 -16.56078665]
Stock Position:  -0.016897766536185146
Bond Position:  [0.12105747]


portfolio before change:  [-1.45624748]
curr_Stock_Price:  93.34578168630554
curr_Factors:  [9.33457817e+01 4.08069768e-02]
mat_Sqrt:  [[ 1.88565357e+01  0.00000000e+00]
 [-8.08029473e-03  1.85142811e-02]]
grads:  [ 9.04002304e-03 -2.15096903e+01]
Stock Position:  0.009040023041893773
Bond Position:  [-2.3000955]


portfolio before change:  [-1.45264662]
curr_Stock_Price:  93.80772262019157
curr_Factors:  [9.38077226e+01 4.11589291e-02]
mat_Sqrt:  [[ 1.90313951e+01  0.00000000e+00]
 [-8.11506541e-03  1.85939507e-02]]
grads:  [-0.01565592 -9.74257683]
Stock Position:  -0.015655922570321917
Bond Position:  [0.01599982]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.44996994]
Stock Price:  93.63700862620234
PL:  [-1.44996994]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [-7.13115496e-03  3.58639533e-04]
 [-6.56935546e-01  4.37382952e-01]
 [ 9.49217300e-01 -3.53718411e-01]
 [ 4.56728415e-01 -5.45716359e-02]
 [ 3.40831636e-01 -3.44610298e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-6.98741692e-01 -3.46422043e-02]
 [-1.50842200e+00  7.21148468e-01]
 [ 2.24741921e-02 -7.73288468e-02]
 [ 1.43609859e-01  4.95628341e-01]
 [-3.40795213e-01 -4.90515198e-02]
 [-2.74031223e-02 -1.13451725e-02]
 [ 2.20800544e-02 -4.89172430e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15007371e-01 -6.11770181e-02]
 [-1.24854384e-02 -5.81023390e-02]
 [-1.34521943e-01 -6.21827843e-01]
 [-4.07914870e-01  6.27924216e-02]
 [ 1.55341434e-01  5.18902099e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [27.10623346]
curr_Stock_Price:  103.6875250497086
curr_Factors:  [1.03687525e+02 3.80522642e-02]
mat_Sqrt:  [[ 2.02263147e+01  0.00000000e+00]
 [-7.80279583e-03  1.78784513e-02]]
grads:  [-0.00034483  0.02005988]
Stock Position:  -0.0003448295911367749
Bond Position:  [27.14198798]


portfolio before change:  [27.11242878]
curr_Stock_Price:  105.40147844047578
curr_Factors:  [1.05401478e+02 3.68363226e-02]
mat_Sqrt:  [[ 2.02294855e+01  0.00000000e+00]
 [-7.67711640e-03  1.75904835e-02]]
grads:  [-2.30379550e-02  2.48647487e+01]
Stock Position:  -0.023037955007750344
Bond Position:  [29.5406633]


portfolio before change:  [27.14117168]
curr_Stock_Price:  104.47445109366224
curr_Factors:  [1.04474451e+02 3.61936566e-02]
mat_Sqrt:  [[ 1.98758783e+01  0.00000000e+00]
 [-7.60985221e-03  1.74363619e-02]]
grads:  [  0.03999028 -20.28625085]
Stock Position:  0.03999027949298931
Bond Position:  [22.96320918]


portfolio before change:  [27.15882645]
curr_Stock_Price:  104.77235456349399
curr_Factors:  [1.04772355e+02 3.59643674e-02]
mat_Sqrt:  [[ 1.98693160e+01  0.00000000e+00]
 [-7.58570945e-03  1.73810439e-02]]
grads:  [ 0.02178794 -3.13972143]
Stock Position:  0.021787936788166023
Bond Position:  [24.87605301]


portfolio before change:  [27.18848182]
curr_Stock_Price:  105.84797658267208
curr_Factors:  [1.05847977e+02 3.53084620e-02]
mat_Sqrt:  [[ 1.98894128e+01  0.00000000e+00]
 [-7.51621842e-03  1.72218199e-02]]
grads:  [ 0.01638015 -2.00100977]
Stock Position:  0.0163801522826037
Bond Position:  [25.45467585]


portfolio before change:  [27.18177378]
curr_Stock_Price:  105.04990698746631
curr_Factors:  [1.05049907e+02 3.59475662e-02]
mat_Sqrt:  [[ 1.99172979e+01  0.00000000e+00]
 [-7.58393737e-03  1.73769835e-02]]
grads:  [-2.91014454e-05 -1.11360963e+00]
Stock Position:  -2.9101445410798893e-05
Bond Position:  [27.18483089]


portfolio before change:  [27.18850631]
curr_Stock_Price:  107.26724502705846
curr_Factors:  [1.07267245e+02 3.43287081e-02]
mat_Sqrt:  [[ 1.98744838e+01  0.00000000e+00]
 [-7.41120321e-03  1.69811999e-02]]
grads:  [-0.03591846 -2.04003278]
Stock Position:  -0.03591845694299873
Bond Position:  [31.04138024]


portfolio before change:  [27.2366206]
curr_Stock_Price:  106.14378432802056
curr_Factors:  [1.06143784e+02 3.50494760e-02]
mat_Sqrt:  [[ 1.98717142e+01  0.00000000e+00]
 [-7.48860211e-03  1.71585430e-02]]
grads:  [-0.06006965 42.02853745]
Stock Position:  -0.0600696546181843
Bond Position:  [33.61264107]


portfolio before change:  [27.30144784]
curr_Stock_Price:  105.20449096967491
curr_Factors:  [1.05204491e+02 3.46544069e-02]
mat_Sqrt:  [[ 1.95845463e+01  0.00000000e+00]
 [-7.44627767e-03  1.70615655e-02]]
grads:  [-5.75703073e-04 -4.53234181e+00]
Stock Position:  -0.000575703072590217
Bond Position:  [27.36201439]


portfolio before change:  [27.30857812]
curr_Stock_Price:  104.70262869780719
curr_Factors:  [1.04702629e+02 3.37004917e-02]
mat_Sqrt:  [[ 1.92209878e+01  0.00000000e+00]
 [-7.34307747e-03  1.68251042e-02]]
grads:  [1.87253540e-02 2.94576685e+01]
Stock Position:  0.018725353974646756
Bond Position:  [25.34798434]


portfolio before change:  [27.30406627]
curr_Stock_Price:  104.12321944165711
curr_Factors:  [1.04123219e+02 3.38296812e-02]
mat_Sqrt:  [[ 1.91512242e+01  0.00000000e+00]
 [-7.35713871e-03  1.68573225e-02]]
grads:  [-0.01891279 -2.90980491]
Stock Position:  -0.018912788421434262
Bond Position:  [29.27332669]


portfolio before change:  [27.30217529]
curr_Stock_Price:  104.61020363464256
curr_Factors:  [1.04610204e+02 3.43321656e-02]
mat_Sqrt:  [[ 1.93831629e+01  0.00000000e+00]
 [-7.41157641e-03  1.69820550e-02]]
grads:  [-0.00166921 -0.66806829]
Stock Position:  -0.0016692095892122756
Bond Position:  [27.47679164]


portfolio before change:  [27.31038283]
curr_Stock_Price:  103.80893549623175
curr_Factors:  [1.03808935e+02 3.61595255e-02]
mat_Sqrt:  [[ 1.97399523e+01  0.00000000e+00]
 [-7.60626326e-03  1.74281386e-02]]
grads:  [ 3.70223407e-05 -2.80679676e+00]
Stock Position:  3.702234067019826e-05
Bond Position:  [27.30653958]


portfolio before change:  [27.31726938]
curr_Stock_Price:  105.40431424559033
curr_Factors:  [1.05404314e+02 3.45410004e-02]
mat_Sqrt:  [[ 1.95896124e+01  0.00000000e+00]
 [-7.43408372e-03  1.70336257e-02]]
grads:  [7.77131975e-03 8.72263441e+00]
Stock Position:  0.007771319750157711
Bond Position:  [26.49813875]


portfolio before change:  [27.33283077]
curr_Stock_Price:  106.55418722551651
curr_Factors:  [1.06554187e+02 3.44056907e-02]
mat_Sqrt:  [[ 1.97644922e+01  0.00000000e+00]
 [-7.41950841e-03  1.70002295e-02]]
grads:  [-0.00716979 -3.59859955]
Stock Position:  -0.0071697875721002625
Bond Position:  [28.09680166]


portfolio before change:  [27.33747905]
curr_Stock_Price:  106.88568984836101
curr_Factors:  [1.06885690e+02 3.37954341e-02]
mat_Sqrt:  [[ 1.96493677e+01  0.00000000e+00]
 [-7.35341381e-03  1.68487877e-02]]
grads:  [-1.92593363e-03 -3.44845814e+00]
Stock Position:  -0.0019259336326908553
Bond Position:  [27.54333379]


portfolio before change:  [27.34546632]
curr_Stock_Price:  106.3142385537646
curr_Factors:  [1.06314239e+02 3.58436273e-02]
mat_Sqrt:  [[ 2.01278510e+01  0.00000000e+00]
 [-7.57296532e-03  1.73518434e-02]]
grads:  [-2.01665773e-02 -3.58364139e+01]
Stock Position:  -0.02016657725235402
Bond Position:  [29.48946063]


portfolio before change:  [27.33462166]
curr_Stock_Price:  107.21761189127787
curr_Factors:  [1.07217612e+02 3.61374368e-02]
mat_Sqrt:  [[ 2.03819064e+01  0.00000000e+00]
 [-7.60393970e-03  1.74228146e-02]]
grads:  [-0.01866901  3.60403431]
Stock Position:  -0.018669009824774565
Bond Position:  [29.33626831]


portfolio before change:  [27.40577341]
curr_Stock_Price:  103.79928566364907
curr_Factors:  [1.03799286e+02 3.80527111e-02]
mat_Sqrt:  [[ 2.02482347e+01  0.00000000e+00]
 [-7.80284165e-03  1.78785562e-02]]
grads:  [0.00879031 2.90237138]
Stock Position:  0.00879030595903888
Bond Position:  [26.49334593]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [27.42243979]
Stock Price:  104.94170504227463
PL:  [22.48073475]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [-4.08865139e-03  4.09991518e-03]
 [-5.99063356e-01  4.01794264e-01]
 [ 1.05961791e+00 -3.87413086e-01]
 [ 4.30998386e-01 -4.98740189e-02]
 [ 4.25478322e-02 -1.78208447e-02]
 [ 4.09196303e-02 -2.33608093e-02]
 [-5.06903918e-02 -1.10168178e-01]
 [-1.25606757e+00  7.17275501e-01]
 [ 8.92634405e-02 -7.26215564e-02]
 [ 9.57280398e-02  2.08760162e-01]
 [-2.32723586e-01 -2.50107569e-02]
 [-2.39874214e-02 -1.10872391e-02]
 [ 2.04882349e-02 -5.00366626e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.17650746e-01 -6.26772748e-02]
 [-1.41792855e-01 -1.32121572e-01]
 [-1.63160009e-01 -5.26715453e-01]
 [-1.90587781e-01 -7.36860622e-02]
 [ 1.51102332e-01  1.31913306e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [24.52399509]
curr_Stock_Price:  103.29857749362515
curr_Factors:  [1.03298577e+02 3.84156713e-02]
mat_Sqrt:  [[ 2.02464346e+01  0.00000000e+00]
 [-7.83996646e-03  1.79636199e-02]]
grads:  [-1.13565759e-04  2.28234354e-01]
Stock Position:  -0.00011356575905780149
Bond Position:  [24.53572627]


portfolio before change:  [24.52992806]
curr_Stock_Price:  105.0748749975183
curr_Factors:  [1.05074875e+02 4.06351487e-02]
mat_Sqrt:  [[ 2.11811633e+01  0.00000000e+00]
 [-8.06326472e-03  1.84752605e-02]]
grads:  [-2.00039042e-02  2.17476914e+01]
Stock Position:  -0.020003904242504023
Bond Position:  [26.6318358]


portfolio before change:  [24.52777709]
curr_Stock_Price:  105.51527721981503
curr_Factors:  [1.05515277e+02 3.99578474e-02]
mat_Sqrt:  [[ 2.10919332e+01  0.00000000e+00]
 [-7.99578363e-03  1.83206419e-02]]
grads:  [  0.04222169 -21.14626163]
Stock Position:  0.0422216859301541
Bond Position:  [20.07274419]


portfolio before change:  [24.4783261]
curr_Stock_Price:  104.225186563363
curr_Factors:  [1.04225187e+02 4.05998612e-02]
mat_Sqrt:  [[ 2.10007573e+01  0.00000000e+00]
 [-8.05976289e-03  1.84672368e-02]]
grads:  [ 0.01948652 -2.70067577]
Stock Position:  0.01948651536095812
Bond Position:  [22.4473404]


portfolio before change:  [24.43029414]
curr_Stock_Price:  101.47228316116593
curr_Factors:  [1.01472283e+02 4.34631547e-02]
mat_Sqrt:  [[ 2.11547577e+01  0.00000000e+00]
 [-8.33912750e-03  1.91073415e-02]]
grads:  [ 0.00164361 -0.93267003]
Stock Position:  0.0016436103164983351
Bond Position:  [24.26351325]


portfolio before change:  [24.43498622]
curr_Stock_Price:  100.63597974726419
curr_Factors:  [1.00635980e+02 4.33070242e-02]
mat_Sqrt:  [[ 2.09426893e+01  0.00000000e+00]
 [-8.32413591e-03  1.90729915e-02]]
grads:  [ 0.00146706 -1.22481098]
Stock Position:  0.0014670578720490412
Bond Position:  [24.28734741]


portfolio before change:  [24.43862627]
curr_Stock_Price:  98.97786424402743
curr_Factors:  [9.89778642e+01 4.46609651e-02]
mat_Sqrt:  [[ 2.09171317e+01  0.00000000e+00]
 [-8.45325643e-03  1.93688437e-02]]
grads:  [-4.72204929e-03 -5.68790683e+00]
Stock Position:  -0.004722049288646725
Bond Position:  [24.90600462]


portfolio before change:  [24.44748021]
curr_Stock_Price:  98.42160914606427
curr_Factors:  [9.84216091e+01 4.55798072e-02]
mat_Sqrt:  [[ 2.10124505e+01  0.00000000e+00]
 [-8.53977116e-03  1.95670739e-02]]
grads:  [-0.04487924 36.65726952]
Stock Position:  -0.04487924329900221
Bond Position:  [28.86456755]


portfolio before change:  [24.39071037]
curr_Stock_Price:  99.84736591752711
curr_Factors:  [9.98473659e+01 4.55040883e-02]
mat_Sqrt:  [[ 2.12991279e+01  0.00000000e+00]
 [-8.53267492e-03  1.95508143e-02]]
grads:  [ 2.70287099e-03 -3.71450289e+00]
Stock Position:  0.0027028709889953817
Bond Position:  [24.12083582]


portfolio before change:  [24.40205351]
curr_Stock_Price:  101.81275114968155
curr_Factors:  [1.01812751e+02 4.47230495e-02]
mat_Sqrt:  [[ 2.15311823e+01  0.00000000e+00]
 [-8.45912993e-03  1.93823016e-02]]
grads:  [8.67757478e-03 1.07706591e+01]
Stock Position:  0.008677574778622708
Bond Position:  [23.51856575]


portfolio before change:  [24.4159703]
curr_Stock_Price:  102.73886329588443
curr_Factors:  [1.02738863e+02 4.11904237e-02]
mat_Sqrt:  [[ 2.08512880e+01  0.00000000e+00]
 [-8.11816961e-03  1.86010634e-02]]
grads:  [-0.01168461 -1.34458748]
Stock Position:  -0.01168461037366822
Bond Position:  [25.61643388]


portfolio before change:  [24.40261996]
curr_Stock_Price:  104.42956937231074
curr_Factors:  [1.04429569e+02 4.11414887e-02]
mat_Sqrt:  [[ 2.11818305e+01  0.00000000e+00]
 [-8.11334592e-03  1.85900109e-02]]
grads:  [-0.0013609  -0.59640842]
Stock Position:  -0.001360896985246796
Bond Position:  [24.54473785]


portfolio before change:  [24.40947271]
curr_Stock_Price:  103.90359725748141
curr_Factors:  [1.03903597e+02 4.21976381e-02]
mat_Sqrt:  [[ 2.13439431e+01  0.00000000e+00]
 [-8.21682548e-03  1.88271124e-02]]
grads:  [-6.32289443e-05 -2.65769182e+00]
Stock Position:  -6.32289443498361e-05
Bond Position:  [24.41604242]


portfolio before change:  [24.41565702]
curr_Stock_Price:  102.64566206492393
curr_Factors:  [1.02645662e+02 4.22095243e-02]
mat_Sqrt:  [[ 2.10885067e+01  0.00000000e+00]
 [-8.21798265e-03  1.88297638e-02]]
grads:  [7.21896261e-03 7.89059763e+00]
Stock Position:  0.007218962613262319
Bond Position:  [23.67466182]


portfolio before change:  [24.4098242]
curr_Stock_Price:  101.01769534402257
curr_Factors:  [1.01017695e+02 4.07593300e-02]
mat_Sqrt:  [[ 2.03944019e+01  0.00000000e+00]
 [-8.07557601e-03  1.85034692e-02]]
grads:  [-0.00711006 -3.3873256 ]
Stock Position:  -0.007110056543691433
Bond Position:  [25.12806572]


portfolio before change:  [24.42627319]
curr_Stock_Price:  99.58786269470116
curr_Factors:  [9.95878627e+01 4.40638833e-02]
mat_Sqrt:  [[ 2.09048856e+01  0.00000000e+00]
 [-8.39655961e-03  1.92389350e-02]]
grads:  [-0.00954109 -6.86740572]
Stock Position:  -0.009541091994005471
Bond Position:  [25.37645015]


portfolio before change:  [24.40652212]
curr_Stock_Price:  102.32297654768402
curr_Factors:  [1.02322977e+02 4.33999138e-02]
mat_Sqrt:  [[ 2.13165835e+01  0.00000000e+00]
 [-8.33305839e-03  1.90934354e-02]]
grads:  [-1.84381085e-02 -2.75862065e+01]
Stock Position:  -0.01843810850547259
Bond Position:  [26.29316427]


portfolio before change:  [24.37530614]
curr_Stock_Price:  104.37254093816843
curr_Factors:  [1.04372541e+02 4.43220712e-02]
mat_Sqrt:  [[ 2.19733503e+01  0.00000000e+00]
 [-8.42112308e-03  1.92952170e-02]]
grads:  [-0.01013714 -3.8188771 ]
Stock Position:  -0.010137143958318478
Bond Position:  [25.43334562]


portfolio before change:  [24.37577543]
curr_Stock_Price:  104.95355753038424
curr_Factors:  [1.04953558e+02 4.38713825e-02]
mat_Sqrt:  [[ 2.19830438e+01  0.00000000e+00]
 [-8.37819861e-03  1.91968647e-02]]
grads:  [0.00713548 0.68716068]
Stock Position:  0.00713547691088118
Bond Position:  [23.62688174]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [24.38800812]
Stock Price:  105.8400064883466
PL:  [18.54800163]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.36318689e-02  1.01083659e-01]
 [ 3.74886940e-02 -6.43282644e-02]
 [ 6.40038872e-01 -2.59356011e-01]
 [ 1.14006018e-01 -1.12861611e-01]
 [ 5.15186651e-02 -1.86595311e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-3.32498420e-01 -1.43820180e-01]
 [-1.43501673e+00  7.51965289e-01]
 [ 3.92034973e-02 -7.42473391e-02]
 [ 1.13437319e-01  2.84995855e-01]
 [-2.92648208e-01 -3.13387890e-02]
 [-3.90936112e-02 -1.22240994e-02]
 [ 4.93380802e-03 -6.10633766e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.17194730e-01 -6.24184616e-02]
 [-8.33194918e-02 -9.98618559e-02]
 [-1.48744165e-01 -5.76434551e-01]
 [-3.42050736e-01  3.12094687e-02]
 [ 1.32925844e-01  4.51892689e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.36778029]
curr_Stock_Price:  98.7961531129113
curr_Factors:  [9.87961531e+01 4.06382744e-02]
mat_Sqrt:  [[ 1.99162543e+01  0.00000000e+00]
 [-8.06357483e-03  1.84759710e-02]]
grads:  [3.90376589e-03 5.47108775e+00]
Stock Position:  0.0039037658911020632
Bond Position:  [-5.75345735]


portfolio before change:  [-5.37404796]
curr_Stock_Price:  97.55911187612625
curr_Factors:  [9.75591119e+01 4.04126962e-02]
mat_Sqrt:  [[ 1.96122198e+01  0.00000000e+00]
 [-8.04116372e-03  1.84246207e-02]]
grads:  [ 4.79983287e-04 -3.49142951e+00]
Stock Position:  0.00047998328658160596
Bond Position:  [-5.4208747]


portfolio before change:  [-5.37447217]
curr_Stock_Price:  99.49913040567097
curr_Factors:  [9.94991304e+01 3.79373965e-02]
mat_Sqrt:  [[ 1.93799676e+01  0.00000000e+00]
 [-7.79100985e-03  1.78514462e-02]]
grads:  [  0.02718511 -14.52857141]
Stock Position:  0.02718511399851402
Bond Position:  [-8.07936737]


portfolio before change:  [-5.34904586]
curr_Stock_Price:  100.5087419179498
curr_Factors:  [1.00508742e+02 3.71931640e-02]
mat_Sqrt:  [[ 1.93836429e+01  0.00000000e+00]
 [-7.71421172e-03  1.76754796e-02]]
grads:  [ 3.34040267e-03 -6.38520784e+00]
Stock Position:  0.0033404026671539867
Bond Position:  [-5.68478553]


portfolio before change:  [-5.34696426]
curr_Stock_Price:  101.55740965948061
curr_Factors:  [1.01557410e+02 3.62792506e-02]
mat_Sqrt:  [[ 1.93437544e+01  0.00000000e+00]
 [-7.61884512e-03  1.74569672e-02]]
grads:  [ 0.00224232 -1.06888733]
Stock Position:  0.002242324693489614
Bond Position:  [-5.57468895]


portfolio before change:  [-5.34390405]
curr_Stock_Price:  103.5437675331447
curr_Factors:  [1.03543768e+02 3.66439104e-02]
mat_Sqrt:  [[ 1.98209684e+01  0.00000000e+00]
 [-7.65703968e-03  1.75444820e-02]]
grads:  [-2.92428778e-05 -1.10297791e+00]
Stock Position:  -2.924287776711265e-05
Bond Position:  [-5.34087613]


portfolio before change:  [-5.34524681]
curr_Stock_Price:  103.79589423798024
curr_Factors:  [1.03795894e+02 3.68763417e-02]
mat_Sqrt:  [[ 1.99321474e+01  0.00000000e+00]
 [-7.68128549e-03  1.76000361e-02]]
grads:  [-0.01983061 -8.1715844 ]
Stock Position:  -0.019830612565824163
Bond Position:  [-3.28691064]


portfolio before change:  [-5.34940277]
curr_Stock_Price:  103.9640246784166
curr_Factors:  [1.03964025e+02 3.73097139e-02]
mat_Sqrt:  [[ 2.00814026e+01  0.00000000e+00]
 [-7.72628903e-03  1.77031522e-02]]
grads:  [-0.05511727 42.47635005]
Stock Position:  -0.05511727438417667
Bond Position:  [0.38081091]


portfolio before change:  [-5.34265395]
curr_Stock_Price:  103.84330739309732
curr_Factors:  [1.03843307e+02 4.12342146e-02]
mat_Sqrt:  [[ 2.10866396e+01  0.00000000e+00]
 [-8.12248381e-03  1.86109485e-02]]
grads:  [ 3.22445969e-04 -3.98944413e+00]
Stock Position:  0.00032244596858536624
Bond Position:  [-5.3761378]


portfolio before change:  [-5.34435289]
curr_Stock_Price:  102.74314121104565
curr_Factors:  [1.02743141e+02 4.13446400e-02]
mat_Sqrt:  [[ 2.08911548e+01  0.00000000e+00]
 [-8.13335257e-03  1.86358519e-02]]
grads:  [1.13837512e-02 1.52928805e+01]
Stock Position:  0.01138375115495739
Bond Position:  [-6.51395524]


portfolio before change:  [-5.33729919]
curr_Stock_Price:  103.50584206110288
curr_Factors:  [1.03505842e+02 3.83624846e-02]
mat_Sqrt:  [[ 2.02730096e+01  0.00000000e+00]
 [-7.83453735e-03  1.79511802e-02]]
grads:  [-0.01511002 -1.74577875]
Stock Position:  -0.01511001978024749
Bond Position:  [-3.77332387]


portfolio before change:  [-5.36410942]
curr_Stock_Price:  105.21773796705334
curr_Factors:  [1.05217738e+02 3.74393465e-02]
mat_Sqrt:  [[ 2.03588429e+01  0.00000000e+00]
 [-7.73969989e-03  1.77338803e-02]]
grads:  [-0.00218228 -0.68930765]
Stock Position:  -0.0021822775395542024
Bond Position:  [-5.13449511]


portfolio before change:  [-5.3642672]
curr_Stock_Price:  104.70176246250823
curr_Factors:  [1.04701762e+02 4.02135878e-02]
mat_Sqrt:  [[ 2.09961856e+01  0.00000000e+00]
 [-8.02133034e-03  1.83791767e-02]]
grads:  [-1.03430379e-03 -3.32242175e+00]
Stock Position:  -0.0010343037920184394
Bond Position:  [-5.25597377]


portfolio before change:  [-5.36361424]
curr_Stock_Price:  102.79989090569218
curr_Factors:  [1.02799891e+02 4.04727447e-02]
mat_Sqrt:  [[ 2.06811166e+01  0.00000000e+00]
 [-8.04713561e-03  1.84383040e-02]]
grads:  [7.36116646e-03 8.05812124e+00]
Stock Position:  0.0073611664622697335
Bond Position:  [-6.12034135]


portfolio before change:  [-5.37273461]
curr_Stock_Price:  101.76879216783216
curr_Factors:  [1.01768792e+02 4.20955582e-02]
mat_Sqrt:  [[ 2.08801088e+01  0.00000000e+00]
 [-8.20688084e-03  1.88043263e-02]]
grads:  [-0.00691742 -3.31936707]
Stock Position:  -0.006917415126427145
Bond Position:  [-4.66875763]


portfolio before change:  [-5.393963]
curr_Stock_Price:  104.66887095862589
curr_Factors:  [1.04668871e+02 4.30098574e-02]
mat_Sqrt:  [[ 2.17070867e+01  0.00000000e+00]
 [-8.29552722e-03  1.90074407e-02]]
grads:  [-0.00584615 -5.25382967]
Stock Position:  -0.005846145110510448
Bond Position:  [-4.78205359]


portfolio before change:  [-5.3931516]
curr_Stock_Price:  104.32555775617872
curr_Factors:  [1.04325558e+02 4.42745467e-02]
mat_Sqrt:  [[ 2.19516807e+01  0.00000000e+00]
 [-8.41660708e-03  1.92848695e-02]]
grads:  [-1.82364546e-02 -2.98905083e+01]
Stock Position:  -0.018236454575397364
Bond Position:  [-3.4906233]


portfolio before change:  [-5.42303748]
curr_Stock_Price:  105.91649860425831
curr_Factors:  [1.05916499e+02 4.36993518e-02]
mat_Sqrt:  [[ 2.21411979e+01  0.00000000e+00]
 [-8.36175597e-03  1.91591898e-02]]
grads:  [-0.01483343  1.62895555]
Stock Position:  -0.014833425398340871
Bond Position:  [-3.851933]


portfolio before change:  [-5.37849971]
curr_Stock_Price:  102.84904275457303
curr_Factors:  [1.02849043e+02 4.48674780e-02]
mat_Sqrt:  [[ 2.17854273e+01  0.00000000e+00]
 [-8.47277787e-03  1.94135730e-02]]
grads:  [0.00700689 2.3277152 ]
Stock Position:  0.007006888373982352
Bond Position:  [-6.09915147]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.36720486]
Stock Price:  104.67864700440569
PL:  [-10.04585186]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.68960131e-01 -1.31649044e-01]
 [ 3.46571167e-02 -6.85833141e-02]
 [ 3.90944287e-01 -1.83331421e-01]
 [-1.08980526e-01 -1.20452352e-01]
 [ 3.15481357e-01 -1.17451810e-02]
 [-1.95294322e-01 -2.59788726e-01]
 [-2.58071336e-02 -5.09963551e-02]
 [-1.30935545e+00  6.42239704e-01]
 [ 5.44211281e-02 -2.28866775e-02]
 [ 1.47510015e-02 -9.04749616e-02]
 [ 9.91995496e-02  3.01478527e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.38739031e-01 -3.32275755e-02]
 [-8.27124192e-02 -1.18320235e-01]
 [ 5.32288701e-02  4.35998328e-02]
 [-1.42037127e-01 -1.39502724e-01]
 [-1.96472535e-01 -3.06297979e-01]
 [ 2.67214346e-01 -3.42244748e-01]
 [-1.82758697e-01 -1.71880326e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-22.2551763]
curr_Stock_Price:  96.25250280965508
curr_Factors:  [9.62525028e+01 4.19070446e-02]
mat_Sqrt:  [[ 1.97040521e+01  0.00000000e+00]
 [-8.18848407e-03  1.87621740e-02]]
grads:  [ 5.65892626e-03 -7.01672651e+00]
Stock Position:  0.005658926258171214
Bond Position:  [-22.79986212]


portfolio before change:  [-22.25514211]
curr_Stock_Price:  97.2659234860349
curr_Factors:  [9.72659235e+01 3.96646937e-02]
mat_Sqrt:  [[ 1.93714784e+01  0.00000000e+00]
 [-7.96639880e-03  1.82533128e-02]]
grads:  [ 2.43910370e-04 -3.75730778e+00]
Stock Position:  0.00024391037030760428
Bond Position:  [-22.27886628]


portfolio before change:  [-22.26122708]
curr_Stock_Price:  95.15631148942742
curr_Factors:  [9.51563115e+01 4.15630711e-02]
mat_Sqrt:  [[ 1.93995392e+01  0.00000000e+00]
 [-8.15480925e-03  1.86850153e-02]]
grads:  [ 0.0160278  -9.81168162]
Stock Position:  0.01602779795553832
Bond Position:  [-23.78637321]


portfolio before change:  [-22.23461747]
curr_Stock_Price:  97.18759123707292
curr_Factors:  [9.71875912e+01 4.05529013e-02]
mat_Sqrt:  [[ 1.95713951e+01  0.00000000e+00]
 [-8.05510038e-03  1.84565536e-02]]
grads:  [-0.00825441 -6.52626458]
Stock Position:  -0.008254406086583692
Bond Position:  [-21.43239163]


portfolio before change:  [-22.23637672]
curr_Stock_Price:  96.75151844581636
curr_Factors:  [9.67515184e+01 4.19185957e-02]
mat_Sqrt:  [[ 1.98089362e+01  0.00000000e+00]
 [-8.18961251e-03  1.87647596e-02]]
grads:  [ 0.01566744 -0.62591694]
Stock Position:  0.01566744107682291
Bond Position:  [-23.75222543]


portfolio before change:  [-22.25068298]
curr_Stock_Price:  96.21745133040194
curr_Factors:  [9.62174513e+01 4.22962117e-02]
mat_Sqrt:  [[ 1.97881222e+01  0.00000000e+00]
 [-8.22641713e-03  1.88490896e-02]]
grads:  [ -0.01559903 -13.78256094]
Stock Position:  -0.015599025194921831
Bond Position:  [-20.74978454]


portfolio before change:  [-22.25772748]
curr_Stock_Price:  96.33645915481546
curr_Factors:  [9.63364592e+01 4.33306650e-02]
mat_Sqrt:  [[ 2.00534157e+01  0.00000000e+00]
 [-8.32640763e-03  1.90781966e-02]]
grads:  [-2.39678708e-03 -2.67301759e+00]
Stock Position:  -0.0023967870791253903
Bond Position:  [-22.0268295]


portfolio before change:  [-22.26092371]
curr_Stock_Price:  95.37218156910312
curr_Factors:  [9.53721816e+01 4.28868419e-02]
mat_Sqrt:  [[ 1.97507572e+01  0.00000000e+00]
 [-8.28365542e-03  1.89802390e-02]]
grads:  [-0.05210226 33.83728226]
Stock Position:  -0.0521022589054156
Bond Position:  [-17.29181762]


portfolio before change:  [-22.3524582]
curr_Stock_Price:  97.04602441600788
curr_Factors:  [9.70460244e+01 4.11138723e-02]
mat_Sqrt:  [[ 1.96775915e+01  0.00000000e+00]
 [-8.11062240e-03  1.85837705e-02]]
grads:  [ 0.00225803 -1.23154112]
Stock Position:  0.0022580285399462206
Bond Position:  [-22.57159089]


portfolio before change:  [-22.3562852]
curr_Stock_Price:  97.85053114445917
curr_Factors:  [9.78505311e+01 3.88658564e-02]
mat_Sqrt:  [[ 1.92906698e+01  0.00000000e+00]
 [-7.88577011e-03  1.80685692e-02]]
grads:  [-1.28225247e-03 -5.00731190e+00]
Stock Position:  -0.0012822524655132788
Bond Position:  [-22.23081612]


portfolio before change:  [-22.3607428]
curr_Stock_Price:  96.99204220761536
curr_Factors:  [9.69920422e+01 4.17228151e-02]
mat_Sqrt:  [[ 1.98117530e+01  0.00000000e+00]
 [-8.17046536e-03  1.87208880e-02]]
grads:  [1.16484173e-02 1.61038583e+01]
Stock Position:  0.011648417255100968
Bond Position:  [-23.49054658]


portfolio before change:  [-22.36354439]
curr_Stock_Price:  97.2557508380364
curr_Factors:  [9.72557508e+01 4.27236085e-02]
mat_Sqrt:  [[ 2.01024622e+01  0.00000000e+00]
 [-8.26787601e-03  1.89440838e-02]]
grads:  [ 0.00238859 -0.45351271]
Stock Position:  0.002388586918235095
Bond Position:  [-22.5958482]


portfolio before change:  [-22.37191053]
curr_Stock_Price:  96.11847552814966
curr_Factors:  [9.61184755e+01 4.40603193e-02]
mat_Sqrt:  [[ 2.01757968e+01  0.00000000e+00]
 [-8.39622004e-03  1.92381569e-02]]
grads:  [ 0.00615774 -1.72717041]
Stock Position:  0.006157740851666462
Bond Position:  [-22.9637832]


portfolio before change:  [-22.38518316]
curr_Stock_Price:  94.89546853998878
curr_Factors:  [9.48954685e+01 4.33158597e-02]
mat_Sqrt:  [[ 1.97500838e+01  0.00000000e+00]
 [-8.32498501e-03  1.90749370e-02]]
grads:  [-0.00680258 -6.20291616]
Stock Position:  -0.0068025839525855504
Bond Position:  [-21.73964877]


portfolio before change:  [-22.40357185]
curr_Stock_Price:  96.79961324034508
curr_Factors:  [9.67996132e+01 4.05241332e-02]
mat_Sqrt:  [[ 1.94863496e+01  0.00000000e+00]
 [-8.05224274e-03  1.84500059e-02]]
grads:  [0.0037081  2.36313381]
Stock Position:  0.0037081032975416076
Bond Position:  [-22.76251482]


portfolio before change:  [-22.41089928]
curr_Stock_Price:  96.35839472746153
curr_Factors:  [9.63583947e+01 3.82886522e-02]
mat_Sqrt:  [[ 1.88549157e+01  0.00000000e+00]
 [-7.82699454e-03  1.79338975e-02]]
grads:  [-0.01076224 -7.77871758]
Stock Position:  -0.010762238858758006
Bond Position:  [-21.37386722]


portfolio before change:  [-22.40237857]
curr_Stock_Price:  95.07010893516006
curr_Factors:  [9.50701089e+01 4.02792897e-02]
mat_Sqrt:  [[ 1.90802866e+01  0.00000000e+00]
 [-8.02788039e-03  1.83941848e-02]]
grads:  [ -0.0173033  -16.65189204]
Stock Position:  -0.017303300497378188
Bond Position:  [-20.75735191]


portfolio before change:  [-22.40374731]
curr_Stock_Price:  94.84926945041109
curr_Factors:  [9.48492695e+01 3.99149828e-02]
mat_Sqrt:  [[ 1.89496836e+01  0.00000000e+00]
 [-7.99149376e-03  1.83108125e-02]]
grads:  [ 6.21891606e-03 -1.86908553e+01]
Stock Position:  0.006218916063514589
Bond Position:  [-22.99360695]


portfolio before change:  [-22.41093673]
curr_Stock_Price:  94.6176686407168
curr_Factors:  [9.46176686e+01 4.02854172e-02]
mat_Sqrt:  [[ 1.89909275e+01  0.00000000e+00]
 [-8.02849098e-03  1.83955838e-02]]
grads:  [-0.0135735 -9.3435646]
Stock Position:  -0.013573503518041265
Bond Position:  [-21.12664348]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-22.40510848]
Stock Price:  93.79911947952075
PL:  [-22.40510848]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.98307901e-02  8.99775547e-02]
 [ 6.47544696e-02 -2.33556129e-02]
 [ 7.48282059e-01 -2.92392232e-01]
 [-1.20425354e-01 -1.37128407e-01]
 [ 2.85248986e-01 -9.53281083e-03]
 [ 2.47787264e-02 -8.02321572e-02]
 [-4.21223274e-02 -9.78594232e-02]
 [-1.26324998e+00  7.18414879e-01]
 [ 7.25083323e-02 -4.87344169e-02]
 [ 1.37587275e-02 -9.52568338e-02]
 [-8.97199587e-02 -1.21160515e-01]
 [ 2.14025034e-02 -9.05964829e-03]
 [ 1.44840846e-01 -1.89770744e-02]
 [ 1.50003878e-02  3.25113168e-02]
 [-1.14158934e-01 -5.76140660e-02]
 [-1.40170493e-01 -1.24836351e-01]
 [-1.78908959e-01 -4.49700020e-01]
 [ 2.80725863e-01 -2.46105069e-01]
 [ 1.19234565e-01 -2.58770809e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.13880321]
curr_Stock_Price:  98.68001841272402
curr_Factors:  [9.86800184e+01 4.03604710e-02]
mat_Sqrt:  [[ 1.98247325e+01  0.00000000e+00]
 [-8.03596626e-03  1.84127118e-02]]
grads:  [3.98997639e-03 4.88670846e+00]
Stock Position:  0.003989976388074307
Bond Position:  [-6.53253415]


portfolio before change:  [-6.13538494]
curr_Stock_Price:  99.94609417544814
curr_Factors:  [9.99460942e+01 3.90377927e-02]
mat_Sqrt:  [[ 1.97473332e+01  0.00000000e+00]
 [-7.90319355e-03  1.81084913e-02]]
grads:  [ 0.00276297 -1.28976028]
Stock Position:  0.002762967737967456
Bond Position:  [-6.41153277]


portfolio before change:  [-6.13347254]
curr_Stock_Price:  101.21845179033436
curr_Factors:  [1.01218452e+02 3.85185318e-02]
mat_Sqrt:  [[ 1.98652737e+01  0.00000000e+00]
 [-7.85045546e-03  1.79876532e-02]]
grads:  [  0.03124405 -16.25516286]
Stock Position:  0.031244051170524072
Bond Position:  [-9.29594702]


portfolio before change:  [-6.24221991]
curr_Stock_Price:  97.8122644274976
curr_Factors:  [9.78122644e+01 3.95277600e-02]
mat_Sqrt:  [[ 1.94466329e+01  0.00000000e+00]
 [-7.95263579e-03  1.82217777e-02]]
grads:  [-0.00927014 -7.525523  ]
Stock Position:  -0.009270144529388005
Bond Position:  [-5.33548608]


portfolio before change:  [-6.24150559]
curr_Stock_Price:  97.59130214551125
curr_Factors:  [9.75913021e+01 4.02948419e-02]
mat_Sqrt:  [[ 1.95900634e+01  0.00000000e+00]
 [-8.02943005e-03  1.83977355e-02]]
grads:  [ 0.01434853 -0.51815131]
Stock Position:  0.01434852562917189
Bond Position:  [-7.64179689]


portfolio before change:  [-6.22555417]
curr_Stock_Price:  98.83617607928227
curr_Factors:  [9.88361761e+01 4.01645258e-02]
mat_Sqrt:  [[ 1.98078463e+01  0.00000000e+00]
 [-8.01643570e-03  1.83679617e-02]]
grads:  [-5.16838508e-04 -4.36804903e+00]
Stock Position:  -0.0005168385080211488
Bond Position:  [-6.17447183]


portfolio before change:  [-6.22696204]
curr_Stock_Price:  98.57314305866137
curr_Factors:  [9.85731431e+01 3.95058954e-02]
mat_Sqrt:  [[ 1.95924866e+01  0.00000000e+00]
 [-7.95043600e-03  1.82167374e-02]]
grads:  [-4.32980676e-03 -5.37195114e+00]
Stock Position:  -0.004329806762485691
Bond Position:  [-5.80015938]


portfolio before change:  [-6.22766313]
curr_Stock_Price:  98.40012514740746
curr_Factors:  [9.84001251e+01 3.68024659e-02]
mat_Sqrt:  [[ 1.88770493e+01  0.00000000e+00]
 [-7.67358753e-03  1.75823978e-02]]
grads:  [-0.05031019 40.85989209]
Stock Position:  -0.05031019427362791
Bond Position:  [-1.27713371]


portfolio before change:  [-6.23315574]
curr_Stock_Price:  98.502953075398
curr_Factors:  [9.85029531e+01 3.65459518e-02]
mat_Sqrt:  [[ 1.88308051e+01  0.00000000e+00]
 [-7.64679821e-03  1.75210158e-02]]
grads:  [ 2.72101424e-03 -2.78148353e+00]
Stock Position:  0.002721014241953364
Bond Position:  [-6.50118368]


portfolio before change:  [-6.23525246]
curr_Stock_Price:  98.32977686592358
curr_Factors:  [9.83297769e+01 3.69474952e-02]
mat_Sqrt:  [[ 1.89006854e+01  0.00000000e+00]
 [-7.68869250e-03  1.76170077e-02]]
grads:  [-1.47162722e-03 -5.40709498e+00]
Stock Position:  -0.0014716272150075923
Bond Position:  [-6.09054768]


portfolio before change:  [-6.24013723]
curr_Stock_Price:  100.61428957066528
curr_Factors:  [1.00614290e+02 3.73837722e-02]
mat_Sqrt:  [[ 1.94536557e+01  0.00000000e+00]
 [-7.73395342e-03  1.77207135e-02]]
grads:  [-0.00733018 -6.83722557]
Stock Position:  -0.007330177152975048
Bond Position:  [-5.50261667]


portfolio before change:  [-6.24236978]
curr_Stock_Price:  100.73116477504388
curr_Factors:  [1.00731165e+02 3.50013314e-02]
mat_Sqrt:  [[ 1.88454338e+01  0.00000000e+00]
 [-7.48345711e-03  1.71467543e-02]]
grads:  [ 0.00092588 -0.52835937]
Stock Position:  0.0009258767384178938
Bond Position:  [-6.33563442]


portfolio before change:  [-6.24425866]
curr_Stock_Price:  100.40198404813113
curr_Factors:  [1.00401984e+02 3.45492067e-02]
mat_Sqrt:  [[ 1.86621354e+01  0.00000000e+00]
 [-7.43496676e-03  1.70356490e-02]]
grads:  [ 0.00731741 -1.11396251]
Stock Position:  0.007317414052602103
Bond Position:  [-6.97894155]


portfolio before change:  [-6.25169838]
curr_Stock_Price:  99.62373594621126
curr_Factors:  [9.96237359e+01 3.49331275e-02]
mat_Sqrt:  [[ 1.86200807e+01  0.00000000e+00]
 [-7.47616238e-03  1.71300400e-02]]
grads:  [1.56763498e-03 1.89791248e+00]
Stock Position:  0.0015676349780627086
Bond Position:  [-6.40787203]


portfolio before change:  [-6.25240227]
curr_Stock_Price:  100.19675109324294
curr_Factors:  [1.00196751e+02 3.36923718e-02]
mat_Sqrt:  [[ 1.83915966e+01  0.00000000e+00]
 [-7.34219279e-03  1.68230771e-02]]
grads:  [-0.00757432 -3.42470439]
Stock Position:  -0.007574316548617632
Bond Position:  [-5.49348036]


portfolio before change:  [-6.26928289]
curr_Stock_Price:  102.24407488919321
curr_Factors:  [1.02244075e+02 3.35001263e-02]
mat_Sqrt:  [[ 1.87137736e+01  0.00000000e+00]
 [-7.32121589e-03  1.67750130e-02]]
grads:  [-0.01040162 -7.44180352]
Stock Position:  -0.010401618966606636
Bond Position:  [-5.20577898]


portfolio before change:  [-6.24980134]
curr_Stock_Price:  100.2460049497544
curr_Factors:  [1.00246005e+02 3.38211191e-02]
mat_Sqrt:  [[ 1.84357606e+01  0.00000000e+00]
 [-7.35620762e-03  1.68551891e-02]]
grads:  [-2.03503476e-02 -2.66802120e+01]
Stock Position:  -0.0203503476152729
Bond Position:  [-4.20976029]


portfolio before change:  [-6.23630707]
curr_Stock_Price:  99.53118499639002
curr_Factors:  [9.9531185e+01 3.3892071e-02]
mat_Sqrt:  [[ 1.83234914e+01  0.00000000e+00]
 [-7.36391971e-03  1.68728597e-02]]
grads:  [ 9.45872164e-03 -1.45858540e+01]
Stock Position:  0.009458721642805364
Bond Position:  [-7.17774485]


portfolio before change:  [-6.2174001]
curr_Stock_Price:  101.71981443308695
curr_Factors:  [1.01719814e+02 3.13011360e-02]
mat_Sqrt:  [[ 1.79963988e+01  0.00000000e+00]
 [-7.07685083e-03  1.62151023e-02]]
grads:  [ 0.00599792 -1.59586294]
Stock Position:  0.005997915558485009
Bond Position:  [-6.82750696]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.22133458]
Stock Price:  101.34845290044865
PL:  [-7.56978748]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 8.03550163e-02  1.73735873e-02]
 [ 2.40069435e-02  1.37447198e-02]
 [ 5.18665300e-01 -2.22312347e-01]
 [-1.16858823e-01 -1.31599602e-01]
 [ 2.03708122e-01 -5.94667578e-03]
 [ 1.77005243e-02 -9.26863194e-02]
 [-8.61362097e-02 -1.61382144e-01]
 [-1.27862014e+00  6.86744407e-01]
 [ 6.23818801e-02 -3.42460516e-02]
 [ 1.69549077e-02 -7.98541070e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 1.26808185e-01 -1.70958138e-01]
 [ 6.47900367e-02  3.17597238e-02]
 [-9.97945518e-02 -1.55388486e-01]
 [ 1.29712399e-01  1.87754624e-01]
 [-1.17851950e-01 -1.29852502e-01]
 [-1.95734240e-01 -3.16593488e-01]
 [ 3.03931228e-01 -3.68859920e-01]
 [-1.15307008e-01 -1.54571308e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.18619843]
curr_Stock_Price:  97.91975860903777
curr_Factors:  [9.79197586e+01 4.24560084e-02]
mat_Sqrt:  [[ 2.01762251e+01  0.00000000e+00]
 [-8.24194233e-03  1.88846623e-02]]
grads:  [0.00435847 0.91998401]
Stock Position:  0.004358469985554479
Bond Position:  [-11.61297876]


portfolio before change:  [-11.19811844]
curr_Stock_Price:  95.8510492340769
curr_Factors:  [9.58510492e+01 4.36041966e-02]
mat_Sqrt:  [[ 2.00152499e+01  0.00000000e+00]
 [-8.35264716e-03  1.91383189e-02]]
grads:  [0.00149914 0.71817801]
Stock Position:  0.0014991384691915514
Bond Position:  [-11.34181244]


portfolio before change:  [-11.19950636]
curr_Stock_Price:  96.81686358831193
curr_Factors:  [9.68168636e+01 4.44392473e-02]
mat_Sqrt:  [[ 2.04095936e+01  0.00000000e+00]
 [-8.43224736e-03  1.93207059e-02]]
grads:  [  0.02065892 -11.50642985]
Stock Position:  0.020658923749982086
Bond Position:  [-13.19963856]


portfolio before change:  [-11.18596521]
curr_Stock_Price:  97.63207905002281
curr_Factors:  [9.76320791e+01 4.52345405e-02]
mat_Sqrt:  [[ 2.07647941e+01  0.00000000e+00]
 [-8.50736533e-03  1.94928228e-02]]
grads:  [-0.00839371 -6.75118239]
Stock Position:  -0.00839370700132581
Bond Position:  [-10.36647014]


portfolio before change:  [-11.20024189]
curr_Stock_Price:  99.0241623489031
curr_Factors:  [9.90241623e+01 4.38455577e-02]
mat_Sqrt:  [[ 2.07349970e+01  0.00000000e+00]
 [-8.37573235e-03  1.91912137e-02]]
grads:  [ 0.0096992 -0.3098645]
Stock Position:  0.009699195055773702
Bond Position:  [-12.16069656]


portfolio before change:  [-11.20849763]
curr_Stock_Price:  98.48646958379021
curr_Factors:  [9.84864696e+01 4.50824680e-02]
mat_Sqrt:  [[ 2.09112701e+01  0.00000000e+00]
 [-8.49305297e-03  1.94600291e-02]]
grads:  [-1.08798279e-03 -4.76290755e+00]
Stock Position:  -0.001087982785119133
Bond Position:  [-11.10134605]


portfolio before change:  [-11.21375001]
curr_Stock_Price:  100.76288268187997
curr_Factors:  [1.00762883e+02 4.33942129e-02]
mat_Sqrt:  [[ 2.09901959e+01  0.00000000e+00]
 [-8.33251106e-03  1.90921813e-02]]
grads:  [-7.45915630e-03 -8.45278709e+00]
Stock Position:  -0.007459156295894027
Bond Position:  [-10.46214392]


portfolio before change:  [-11.18959176]
curr_Stock_Price:  97.17345322218816
curr_Factors:  [9.71734532e+01 4.35236102e-02]
mat_Sqrt:  [[ 2.02726299e+01  0.00000000e+00]
 [-8.34492518e-03  1.91206257e-02]]
grads:  [-0.04828679 35.91641923]
Stock Position:  -0.04828679442049657
Bond Position:  [-6.4973972]


portfolio before change:  [-11.21595131]
curr_Stock_Price:  97.68570494318412
curr_Factors:  [9.76857049e+01 4.30486839e-02]
mat_Sqrt:  [[ 2.02680027e+01  0.00000000e+00]
 [-8.29927070e-03  1.90160181e-02]]
grads:  [ 0.00234042 -1.8009055 ]
Stock Position:  0.0023404219206374067
Bond Position:  [-11.44457707]


portfolio before change:  [-11.22093858]
curr_Stock_Price:  96.77741804695918
curr_Factors:  [9.67774180e+01 4.27246122e-02]
mat_Sqrt:  [[ 2.00038273e+01  0.00000000e+00]
 [-8.26797312e-03  1.89443063e-02]]
grads:  [-8.94642886e-04 -4.21520353e+00]
Stock Position:  -0.0008946428864015416
Bond Position:  [-11.13435735]


portfolio before change:  [-11.22088503]
curr_Stock_Price:  93.6057706891532
curr_Factors:  [9.36057707e+01 4.28734050e-02]
mat_Sqrt:  [[ 1.93819117e+01  0.00000000e+00]
 [-8.28235763e-03  1.89772654e-02]]
grads:  [1.39255820e-02 1.84203989e+01]
Stock Position:  0.01392558199420678
Bond Position:  [-12.52439986]


portfolio before change:  [-11.24318993]
curr_Stock_Price:  92.22892268108018
curr_Factors:  [9.22289227e+01 4.33569674e-02]
mat_Sqrt:  [[ 1.92042161e+01  0.00000000e+00]
 [-8.32893437e-03  1.90839861e-02]]
grads:  [ 2.71794154e-03 -8.95819860e+00]
Stock Position:  0.002717941544869443
Bond Position:  [-11.49386275]


portfolio before change:  [-11.24592023]
curr_Stock_Price:  92.28172981644374
curr_Factors:  [9.22817298e+01 4.18889718e-02]
mat_Sqrt:  [[ 1.88871129e+01  0.00000000e+00]
 [-8.18671820e-03  1.87581279e-02]]
grads:  [0.00416427 1.69311798]
Stock Position:  0.00416427417227157
Bond Position:  [-11.63020665]


portfolio before change:  [-11.2455371]
curr_Stock_Price:  93.07203494705371
curr_Factors:  [9.30720349e+01 4.06950340e-02]
mat_Sqrt:  [[ 1.87754311e+01  0.00000000e+00]
 [-8.06920408e-03  1.84888692e-02]]
grads:  [-0.00892718 -8.40443424]
Stock Position:  -0.008927179671537508
Bond Position:  [-10.41466632]


portfolio before change:  [-11.24824979]
curr_Stock_Price:  93.08421176880526
curr_Factors:  [9.30842118e+01 4.08895976e-02]
mat_Sqrt:  [[ 1.88227227e+01  0.00000000e+00]
 [-8.08847057e-03  1.85330143e-02]]
grads:  [ 0.01124467 10.13081955]
Stock Position:  0.011244666269684718
Bond Position:  [-12.29495069]


portfolio before change:  [-11.2292099]
curr_Stock_Price:  95.05083432965239
curr_Factors:  [9.50508343e+01 4.07258574e-02]
mat_Sqrt:  [[ 1.91818748e+01  0.00000000e+00]
 [-8.07225940e-03  1.84958699e-02]]
grads:  [-0.00909839 -7.02062154]
Stock Position:  -0.009098392652607252
Bond Position:  [-10.36440009]


portfolio before change:  [-11.23626148]
curr_Stock_Price:  95.5410479769866
curr_Factors:  [9.55410480e+01 4.28571648e-02]
mat_Sqrt:  [[ 1.97788811e+01  0.00000000e+00]
 [-8.28078883e-03  1.89736708e-02]]
grads:  [ -0.01688199 -16.68593761]
Stock Position:  -0.016881994715168398
Bond Position:  [-9.62333801]


portfolio before change:  [-11.21470024]
curr_Stock_Price:  94.12134777447929
curr_Factors:  [9.41213478e+01 4.23444069e-02]
mat_Sqrt:  [[ 1.93680619e+01  0.00000000e+00]
 [-8.23110266e-03  1.88598255e-02]]
grads:  [ 7.38058157e-03 -1.95579710e+01]
Stock Position:  0.007380581568742538
Bond Position:  [-11.90937053]


portfolio before change:  [-11.20283426]
curr_Stock_Price:  96.1325301779229
curr_Factors:  [9.61325302e+01 4.33958257e-02]
mat_Sqrt:  [[ 2.00260064e+01  0.00000000e+00]
 [-8.33266591e-03  1.90925361e-02]]
grads:  [-0.00912651 -8.09590236]
Stock Position:  -0.009126505509259
Bond Position:  [-10.3254802]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.21105318]
Stock Price:  96.75020655413967
PL:  [-11.21105318]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.16915940e-02  1.13460640e-01]
 [ 7.30578058e-02 -1.08780768e-02]
 [ 6.14537302e-01 -2.51572837e-01]
 [ 2.26762444e-02 -1.04184040e-01]
 [ 1.34020233e-01 -2.50238919e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-6.93754886e-02 -1.37004677e-01]
 [-1.26696304e+00  7.36079815e-01]
 [ 7.77609337e-02 -5.62013119e-02]
 [ 1.31079876e-02 -9.83928178e-02]
 [ 1.12426400e-01  3.13122527e-01]
 [ 5.96170886e-02 -2.24110692e-02]
 [ 9.85176898e-02 -1.26434692e-02]
 [-8.60786956e-02 -1.25642237e-01]
 [ 8.70030926e-02  1.07143908e-01]
 [-1.42655834e-01 -1.39896876e-01]
 [-1.95630885e-01 -3.18060855e-01]
 [ 2.66610805e-01 -3.24668441e-01]
 [-5.67806569e-02 -1.39553241e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.85494289]
curr_Stock_Price:  100.18531829883999
curr_Factors:  [1.00185318e+02 3.75276596e-02]
mat_Sqrt:  [[ 1.94079571e+01  0.00000000e+00]
 [-7.74882284e-03  1.77547836e-02]]
grads:  [4.18435988e-03 6.39042650e+00]
Stock Position:  0.0041843598764312725
Bond Position:  [3.43573146]


portfolio before change:  [3.85609797]
curr_Stock_Price:  100.25606753721048
curr_Factors:  [1.00256068e+02 3.77035113e-02]
mat_Sqrt:  [[ 1.94671137e+01  0.00000000e+00]
 [-7.76695681e-03  1.77963337e-02]]
grads:  [ 0.00350901 -0.61125381]
Stock Position:  0.003509006270511255
Bond Position:  [3.5042988]


portfolio before change:  [3.85266747]
curr_Stock_Price:  99.02874606323682
curr_Factors:  [9.90287461e+01 3.85241825e-02]
mat_Sqrt:  [[ 1.94369446e+01  0.00000000e+00]
 [-7.85103127e-03  1.79889725e-02]]
grads:  [  0.02596817 -13.98483634]
Stock Position:  0.025968171733956876
Bond Position:  [1.28107199]


portfolio before change:  [3.87429813]
curr_Stock_Price:  99.84937930314997
curr_Factors:  [9.98493793e+01 4.10706446e-02]
mat_Sqrt:  [[ 2.02353690e+01  0.00000000e+00]
 [-8.10635747e-03  1.85739983e-02]]
grads:  [-1.12641378e-03 -5.60913371e+00]
Stock Position:  -0.0011264137782472045
Bond Position:  [3.98676984]


portfolio before change:  [3.87233173]
curr_Stock_Price:  102.48003905451151
curr_Factors:  [1.02480039e+02 3.89320156e-02]
mat_Sqrt:  [[ 2.02205389e+01  0.00000000e+00]
 [-7.89247901e-03  1.80839413e-02]]
grads:  [ 0.00608782 -1.38376317]
Stock Position:  0.00608781553350153
Bond Position:  [3.24845216]


portfolio before change:  [3.87121721]
curr_Stock_Price:  102.16354835464205
curr_Factors:  [1.02163548e+02 4.02439838e-02]
mat_Sqrt:  [[ 2.04949306e+01  0.00000000e+00]
 [-8.02436129e-03  1.83861215e-02]]
grads:  [-2.82812452e-05 -1.05248821e+00]
Stock Position:  -2.828124520686792e-05
Bond Position:  [3.87410652]


portfolio before change:  [3.87225017]
curr_Stock_Price:  99.88950758227313
curr_Factors:  [9.98895076e+01 4.09170253e-02]
mat_Sqrt:  [[ 2.02056068e+01  0.00000000e+00]
 [-8.09118288e-03  1.85392290e-02]]
grads:  [-6.39274202e-03 -7.38998787e+00]
Stock Position:  -0.0063927420209216185
Bond Position:  [4.51081802]


portfolio before change:  [3.87529619]
curr_Stock_Price:  99.58945251076581
curr_Factors:  [9.95894525e+01 4.18680692e-02]
mat_Sqrt:  [[ 2.03776835e+01  0.00000000e+00]
 [-8.18467536e-03  1.87534472e-02]]
grads:  [-0.04640917 39.25037395]
Stock Position:  -0.04640917466909085
Bond Position:  [8.49716049]


portfolio before change:  [3.90837608]
curr_Stock_Price:  98.92244356360355
curr_Factors:  [9.89224436e+01 4.43439297e-02]
mat_Sqrt:  [[ 2.08310866e+01  0.00000000e+00]
 [-8.42319937e-03  1.92999743e-02]]
grads:  [ 2.55544376e-03 -2.91198894e+00]
Stock Position:  0.0025554437606852146
Bond Position:  [3.65558534]


portfolio before change:  [3.90852384]
curr_Stock_Price:  98.62259359974982
curr_Factors:  [9.86225936e+01 4.61653250e-02]
mat_Sqrt:  [[ 2.11901665e+01  0.00000000e+00]
 [-8.59444705e-03  1.96923521e-02]]
grads:  [-1.40792469e-03 -4.99649902e+00]
Stock Position:  -0.001407924694283828
Bond Position:  [4.04737703]


portfolio before change:  [3.91253645]
curr_Stock_Price:  96.49134639092196
curr_Factors:  [9.64913464e+01 4.81739324e-02]
mat_Sqrt:  [[ 2.11784619e+01  0.00000000e+00]
 [-8.77942435e-03  2.01161883e-02]]
grads:  [1.17612070e-02 1.55656987e+01]
Stock Position:  0.011761207016131326
Bond Position:  [2.77768175]


portfolio before change:  [3.90398782]
curr_Stock_Price:  95.70544668131106
curr_Factors:  [9.57054467e+01 5.08375272e-02]
mat_Sqrt:  [[ 2.15788782e+01  0.00000000e+00]
 [-9.01887152e-03  2.06648307e-02]]
grads:  [ 0.00230949 -1.08450292]
Stock Position:  0.0023094850270727395
Bond Position:  [3.68295753]


portfolio before change:  [3.90066335]
curr_Stock_Price:  93.86723338375505
curr_Factors:  [9.38672334e+01 5.14034585e-02]
mat_Sqrt:  [[ 2.12818897e+01  0.00000000e+00]
 [-9.06893233e-03  2.07795344e-02]]
grads:  [ 0.0043699  -0.60845777]
Stock Position:  0.004369895192203266
Bond Position:  [3.49047338]


portfolio before change:  [3.90448691]
curr_Stock_Price:  94.5424972391872
curr_Factors:  [9.45424972e+01 5.06118914e-02]
mat_Sqrt:  [[ 2.12693077e+01  0.00000000e+00]
 [-8.99883472e-03  2.06189206e-02]]
grads:  [-0.0066252  -6.09354093]
Stock Position:  -0.0066252021695084795
Bond Position:  [4.53085007]


portfolio before change:  [3.90148954]
curr_Stock_Price:  95.16590840031033
curr_Factors:  [9.51659084e+01 5.06169747e-02]
mat_Sqrt:  [[ 2.14106321e+01  0.00000000e+00]
 [-8.99928661e-03  2.06199560e-02]]
grads:  [0.00624757 5.19612687]
Stock Position:  0.0062475748864901145
Bond Position:  [3.3069334]


portfolio before change:  [3.91020963]
curr_Stock_Price:  96.42931840277363
curr_Factors:  [9.64293184e+01 5.11512179e-02]
mat_Sqrt:  [[ 2.18090670e+01  0.00000000e+00]
 [-9.04665401e-03  2.07284884e-02]]
grads:  [-0.00934069 -6.74901485]
Stock Position:  -0.009340694695040175
Bond Position:  [4.81092645]


portfolio before change:  [3.91824801]
curr_Stock_Price:  95.69752050751023
curr_Factors:  [9.56975205e+01 5.21419773e-02]
mat_Sqrt:  [[ 2.18521631e+01  0.00000000e+00]
 [-9.13384714e-03  2.09282730e-02]]
grads:  [ -0.01530485 -15.19766375]
Stock Position:  -0.01530484744739865
Bond Position:  [5.38288396]


portfolio before change:  [3.9257457]
curr_Stock_Price:  95.29556923907516
curr_Factors:  [9.52955692e+01 5.16678988e-02]
mat_Sqrt:  [[ 2.16612297e+01  0.00000000e+00]
 [-9.09222954e-03  2.08329151e-02]]
grads:  [ 5.76670311e-03 -1.55843980e+01]
Stock Position:  0.005766703110186094
Bond Position:  [3.37620445]


portfolio before change:  [3.93901579]
curr_Stock_Price:  97.45034159169096
curr_Factors:  [9.74503416e+01 5.16232576e-02]
mat_Sqrt:  [[ 2.21414505e+01  0.00000000e+00]
 [-9.08830084e-03  2.08239133e-02]]
grads:  [-5.31522017e-03 -6.70158577e+00]
Stock Position:  -0.005315220174664686
Bond Position:  [4.45698581]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.93183434]
Stock Price:  99.01111269459341
PL:  [3.93183434]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.82519161e-03  1.46702514e-01]
 [ 5.50223855e-02 -3.79801479e-02]
 [ 5.50008694e-01 -2.31878467e-01]
 [-7.01321281e-02 -6.18616528e-02]
 [ 3.50891712e-01 -1.43364701e-02]
 [ 1.32059329e-02 -1.01756896e-01]
 [-5.98110619e-02 -1.23267554e-01]
 [-1.28680641e+00  6.72446078e-01]
 [ 2.76402639e-02  1.53817845e-02]
 [ 2.24248764e-02 -5.34937555e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 5.96073337e-02 -2.23673390e-02]
 [ 1.15828648e-01 -3.47245438e-02]
 [-9.35014893e-02 -1.41745941e-01]
 [ 1.05291964e-01  1.41651138e-01]
 [-1.09252786e-01 -1.26923718e-01]
 [-1.96345680e-01 -3.08078849e-01]
 [ 2.68144996e-01 -3.42630536e-01]
 [-6.49472033e-03 -1.26648425e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.71646203]
curr_Stock_Price:  99.49675414745278
curr_Factors:  [9.94967541e+01 3.97908753e-02]
mat_Sqrt:  [[ 1.98472646e+01  0.00000000e+00]
 [-7.97906013e-03  1.82823235e-02]]
grads:  [3.31790900e-03 8.02428171e+00]
Stock Position:  0.00331790900140559
Bond Position:  [-1.04658321]


portfolio before change:  [-0.71632444]
curr_Stock_Price:  99.61709142712327
curr_Factors:  [9.96170914e+01 4.06546877e-02]
mat_Sqrt:  [[ 2.00858018e+01  0.00000000e+00]
 [-8.06520306e-03  1.84797018e-02]]
grads:  [ 1.91411279e-03 -2.05523598e+00]
Stock Position:  0.0019141127879993046
Bond Position:  [-0.90700279]


portfolio before change:  [-0.7202519]
curr_Stock_Price:  97.68372764219669
curr_Factors:  [9.76837276e+01 4.13033459e-02]
mat_Sqrt:  [[ 1.98524834e+01  0.00000000e+00]
 [-8.12928985e-03  1.86265430e-02]]
grads:  [  0.02260718 -12.44881923]
Stock Position:  0.022607178444561546
Bond Position:  [-2.92860536]


portfolio before change:  [-0.77143723]
curr_Stock_Price:  95.45199874602241
curr_Factors:  [9.54519987e+01 4.30406666e-02]
mat_Sqrt:  [[ 1.98027052e+01  0.00000000e+00]
 [-8.29849785e-03  1.90142473e-02]]
grads:  [-0.00490492 -3.25343685]
Stock Position:  -0.0049049241553553264
Bond Position:  [-0.30325242]


portfolio before change:  [-0.77307726]
curr_Stock_Price:  95.77090365889117
curr_Factors:  [9.57709037e+01 4.16136392e-02]
mat_Sqrt:  [[ 1.95367102e+01  0.00000000e+00]
 [-8.15976855e-03  1.86963785e-02]]
grads:  [ 0.01764037 -0.76680465]
Stock Position:  0.017640368321430427
Bond Position:  [-2.46251127]


portfolio before change:  [-0.72895619]
curr_Stock_Price:  98.30694885481294
curr_Factors:  [9.83069489e+01 4.19028429e-02]
mat_Sqrt:  [[ 2.01236132e+01  0.00000000e+00]
 [-8.18807356e-03  1.87612334e-02]]
grads:  [-1.55063691e-03 -5.42378498e+00]
Stock Position:  -0.0015506369114737211
Bond Position:  [-0.57651781]


portfolio before change:  [-0.73083217]
curr_Stock_Price:  99.4237976998101
curr_Factors:  [9.94237977e+01 4.23497106e-02]
mat_Sqrt:  [[ 2.04604684e+01  0.00000000e+00]
 [-8.23161813e-03  1.88610066e-02]]
grads:  [-5.55263109e-03 -6.53557661e+00]
Stock Position:  -0.005552631086288194
Bond Position:  [-0.1787685]


portfolio before change:  [-0.7152477]
curr_Stock_Price:  96.60906714652606
curr_Factors:  [9.66090671e+01 4.51819519e-02]
mat_Sqrt:  [[ 2.05352684e+01  0.00000000e+00]
 [-8.50241866e-03  1.94814885e-02]]
grads:  [-0.04837175 34.51718161]
Stock Position:  -0.04837175051023146
Bond Position:  [3.95790199]


portfolio before change:  [-0.63106025]
curr_Stock_Price:  94.88909938296801
curr_Factors:  [9.48890994e+01 4.71691219e-02]
mat_Sqrt:  [[ 2.06084449e+01  0.00000000e+00]
 [-8.68738137e-03  1.99052914e-02]]
grads:  [0.00166696 0.77274852]
Stock Position:  0.0016669586324165593
Bond Position:  [-0.78923646]


portfolio before change:  [-0.63269833]
curr_Stock_Price:  94.0248051557092
curr_Factors:  [9.40248052e+01 4.78925829e-02]
mat_Sqrt:  [[ 2.05767401e+01  0.00000000e+00]
 [-8.75374963e-03  2.00573602e-02]]
grads:  [-4.47939050e-05 -2.66703869e+00]
Stock Position:  -4.479390504623825e-05
Bond Position:  [-0.62848659]


portfolio before change:  [-0.63288454]
curr_Stock_Price:  94.67379231244672
curr_Factors:  [9.46737923e+01 4.71334741e-02]
mat_Sqrt:  [[ 2.05539123e+01  0.00000000e+00]
 [-8.68409803e-03  1.98977683e-02]]
grads:  [1.31315341e-02 1.75682415e+01]
Stock Position:  0.013131534117532482
Bond Position:  [-1.87609668]


portfolio before change:  [-0.61979751]
curr_Stock_Price:  95.70612536003478
curr_Factors:  [9.57061254e+01 4.90708509e-02]
mat_Sqrt:  [[ 2.12007648e+01  0.00000000e+00]
 [-8.86077657e-03  2.03025897e-02]]
grads:  [ 0.00235111 -1.10169882]
Stock Position:  0.0023511145493026737
Bond Position:  [-0.84481357]


portfolio before change:  [-0.62227895]
curr_Stock_Price:  94.74053353630038
curr_Factors:  [9.47405335e+01 4.80220242e-02]
mat_Sqrt:  [[ 2.07613723e+01  0.00000000e+00]
 [-8.76557121e-03  2.00844468e-02]]
grads:  [ 0.00484908 -1.72892707]
Stock Position:  0.004849082873083326
Bond Position:  [-1.08168365]


portfolio before change:  [-0.62735863]
curr_Stock_Price:  93.74875474257558
curr_Factors:  [9.37487547e+01 4.77590682e-02]
mat_Sqrt:  [[ 2.04877106e+01  0.00000000e+00]
 [-8.74153928e-03  2.00293827e-02]]
grads:  [-0.0075833  -7.07690011]
Stock Position:  -0.007583301668399272
Bond Position:  [0.08356646]


portfolio before change:  [-0.63133001]
curr_Stock_Price:  94.27521081350295
curr_Factors:  [9.42752108e+01 4.74789008e-02]
mat_Sqrt:  [[ 2.05422420e+01  0.00000000e+00]
 [-8.71586148e-03  1.99705475e-02]]
grads:  [0.00813512 7.09300221]
Stock Position:  0.008135119270591533
Bond Position:  [-1.39827009]


portfolio before change:  [-0.62752924]
curr_Stock_Price:  94.78539108588883
curr_Factors:  [9.47853911e+01 4.54281995e-02]
mat_Sqrt:  [[ 2.02024560e+01  0.00000000e+00]
 [-8.52555683e-03  1.95345048e-02]]
grads:  [-0.00814984 -6.4974116 ]
Stock Position:  -0.008149842670764068
Bond Position:  [0.14495678]


portfolio before change:  [-0.63080912]
curr_Stock_Price:  95.1922854226593
curr_Factors:  [9.51922854e+01 4.47886518e-02]
mat_Sqrt:  [[ 2.01458571e+01  0.00000000e+00]
 [-8.46533182e-03  1.93965119e-02]]
grads:  [ -0.01642036 -15.88320881]
Stock Position:  -0.016420364348210977
Bond Position:  [0.93228289]


portfolio before change:  [-0.62380722]
curr_Stock_Price:  94.78006537141296
curr_Factors:  [9.47800654e+01 4.88262597e-02]
mat_Sqrt:  [[ 2.09432334e+01  0.00000000e+00]
 [-8.83866594e-03  2.02519279e-02]]
grads:  [ 5.66334569e-03 -1.69184158e+01]
Stock Position:  0.0056633456907380945
Bond Position:  [-1.16057949]


portfolio before change:  [-0.60260384]
curr_Stock_Price:  98.57527068171315
curr_Factors:  [9.85752707e+01 4.67599306e-02]
mat_Sqrt:  [[ 2.13159605e+01  0.00000000e+00]
 [-8.64961785e-03  1.98187643e-02]]
grads:  [-2.89776407e-03 -6.39032904e+00]
Stock Position:  -0.0028977640657208677
Bond Position:  [-0.31695596]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.5973026]
Stock Price:  96.71849642916762
PL:  [-0.5973026]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.79445709e-03  1.54629370e-01]
 [ 4.50743379e-02 -5.29292142e-02]
 [ 5.77331328e-01 -2.40217436e-01]
 [-1.05763320e-01 -9.93970487e-02]
 [ 2.57516905e-01 -7.72596301e-03]
 [ 4.96879942e-03 -1.19090844e-01]
 [-1.47731887e-02 -5.85803238e-02]
 [-1.25644844e+00  7.12471048e-01]
 [ 6.03459931e-02 -3.13161377e-02]
 [ 1.85839584e-02 -7.20035414e-02]
 [ 1.13493580e-01  3.21038140e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.52893974e-01 -3.05869890e-02]
 [ 5.02352467e-02  7.71713077e-02]
 [-6.21151203e-02 -2.94069684e-02]
 [-1.41925703e-01 -1.32718125e-01]
 [-1.76958568e-01 -4.57145632e-01]
 [ 2.78124108e-01 -2.41501803e-01]
 [ 1.57982878e-03 -1.24576417e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.60976061]
curr_Stock_Price:  99.36220177408998
curr_Factors:  [9.93622018e+01 3.82972447e-02]
mat_Sqrt:  [[ 1.94448667e+01  0.00000000e+00]
 [-7.82787273e-03  1.79359097e-02]]
grads:  [3.66576165e-03 8.62121702e+00]
Stock Position:  0.0036657616469500504
Bond Position:  [-1.97399876]


portfolio before change:  [-1.61354867]
curr_Stock_Price:  98.46348128544967
curr_Factors:  [9.84634813e+01 3.88195848e-02]
mat_Sqrt:  [[ 1.93999509e+01  0.00000000e+00]
 [-7.88107453e-03  1.80578103e-02]]
grads:  [ 1.13269024e-03 -2.93109814e+00]
Stock Position:  0.0011326902387344153
Bond Position:  [-1.72507729]


portfolio before change:  [-1.61414304]
curr_Stock_Price:  98.31953253540279
curr_Factors:  [9.83195325e+01 3.95721205e-02]
mat_Sqrt:  [[ 1.95584515e+01  0.00000000e+00]
 [-7.95709701e-03  1.82319997e-02]]
grads:  [  0.02415794 -13.17559458]
Stock Position:  0.024157937295963484
Bond Position:  [-3.98934014]


portfolio before change:  [-1.60226532]
curr_Stock_Price:  98.8524912624339
curr_Factors:  [9.88524913e+01 3.97683289e-02]
mat_Sqrt:  [[ 1.97131619e+01  0.00000000e+00]
 [-7.97679925e-03  1.82771432e-02]]
grads:  [-0.00756569 -5.43832522]
Stock Position:  -0.007565693873641215
Bond Position:  [-0.85437763]


portfolio before change:  [-1.59815443]
curr_Stock_Price:  98.28089681069144
curr_Factors:  [9.82808968e+01 4.17179466e-02]
mat_Sqrt:  [[ 2.00738453e+01  0.00000000e+00]
 [-8.16998865e-03  1.87197957e-02]]
grads:  [ 0.0126605 -0.4127162]
Stock Position:  0.012660504972714207
Bond Position:  [-2.84244021]


portfolio before change:  [-1.60257172]
curr_Stock_Price:  97.98812858012747
curr_Factors:  [9.79881286e+01 4.41745540e-02]
mat_Sqrt:  [[ 2.05948935e+01  0.00000000e+00]
 [-8.40709739e-03  1.92630801e-02]]
grads:  [-2.28244473e-03 -6.18233657e+00]
Stock Position:  -0.002282444734565126
Bond Position:  [-1.37891924]


portfolio before change:  [-1.60119401]
curr_Stock_Price:  97.2334609372009
curr_Factors:  [9.72334609e+01 4.77325057e-02]
mat_Sqrt:  [[ 2.12433430e+01  0.00000000e+00]
 [-8.73910803e-03  2.00238120e-02]]
grads:  [-1.89893550e-03 -2.92553304e+00]
Stock Position:  -0.0018989354950533636
Bond Position:  [-1.41655394]


portfolio before change:  [-1.60348246]
curr_Stock_Price:  98.25206897872202
curr_Factors:  [9.8252069e+01 4.8752022e-02]
mat_Sqrt:  [[ 2.16939193e+01  0.00000000e+00]
 [-8.83194402e-03  2.02365260e-02]]
grads:  [-0.04358367 35.2071817 ]
Stock Position:  -0.04358366810670486
Bond Position:  [2.6787031]


portfolio before change:  [-1.57089931]
curr_Stock_Price:  97.51983610575884
curr_Factors:  [9.75198361e+01 4.83115881e-02]
mat_Sqrt:  [[ 2.14347597e+01  0.00000000e+00]
 [-8.79195888e-03  2.01449085e-02]]
grads:  [ 0.0021777  -1.55454355]
Stock Position:  0.002177701580288482
Bond Position:  [-1.78326841]


portfolio before change:  [-1.57477221]
curr_Stock_Price:  95.94614495842664
curr_Factors:  [9.59461450e+01 4.94185309e-02]
mat_Sqrt:  [[ 2.13290958e+01  0.00000000e+00]
 [-8.89211164e-03  2.03743873e-02]]
grads:  [-6.02039747e-04 -3.53402241e+00]
Stock Position:  -0.0006020397466271056
Bond Position:  [-1.51700882]


portfolio before change:  [-1.57531623]
curr_Stock_Price:  96.21974796213608
curr_Factors:  [9.6219748e+01 4.6845940e-02]
mat_Sqrt:  [[ 2.08257281e+01  0.00000000e+00]
 [-8.65756917e-03  1.98369830e-02]]
grads:  [1.21775387e-02 1.61838188e+01]
Stock Position:  0.012177538734203752
Bond Position:  [-2.74703594]


portfolio before change:  [-1.57016123]
curr_Stock_Price:  96.69947094533002
curr_Factors:  [9.66994709e+01 4.76274581e-02]
mat_Sqrt:  [[ 2.11034179e+01  0.00000000e+00]
 [-8.72948641e-03  2.00017661e-02]]
grads:  [ 0.00227529 -0.42953121]
Stock Position:  0.0022752939094492406
Bond Position:  [-1.79018095]


portfolio before change:  [-1.5702073]
curr_Stock_Price:  96.87594685219584
curr_Factors:  [9.68759469e+01 4.74366184e-02]
mat_Sqrt:  [[ 2.10995319e+01  0.00000000e+00]
 [-8.71197965e-03  1.99616531e-02]]
grads:  [ 0.00661364 -1.53228737]
Stock Position:  0.0066136404364403175
Bond Position:  [-2.21090998]


portfolio before change:  [-1.54820556]
curr_Stock_Price:  100.28625225379513
curr_Factors:  [1.00286252e+02 4.77318501e-02]
mat_Sqrt:  [[ 2.19101593e+01  0.00000000e+00]
 [-8.73904801e-03  2.00236745e-02]]
grads:  [3.82998432e-03 3.85400330e+00]
Stock Position:  0.0038299843175979382
Bond Position:  [-1.93230033]


portfolio before change:  [-1.5525427]
curr_Stock_Price:  99.27998102776358
curr_Factors:  [9.92799810e+01 4.76205597e-02]
mat_Sqrt:  [[ 2.16650120e+01  0.00000000e+00]
 [-8.72885420e-03  2.00003175e-02]]
grads:  [-0.00345947 -1.47032508]
Stock Position:  -0.0034594660555013054
Bond Position:  [-1.20908697]


portfolio before change:  [-1.55344822]
curr_Stock_Price:  99.45434729783987
curr_Factors:  [9.94543473e+01 4.81277934e-02]
mat_Sqrt:  [[ 2.18183421e+01  0.00000000e+00]
 [-8.77521905e-03  2.01065528e-02]]
grads:  [-0.00915966 -6.60073989]
Stock Position:  -0.009159662126711106
Bond Position:  [-0.64248]


portfolio before change:  [-1.56338685]
curr_Stock_Price:  100.52185304714715
curr_Factors:  [1.00521853e+02 4.79060432e-02]
mat_Sqrt:  [[ 2.20016695e+01  0.00000000e+00]
 [-8.75497968e-03  2.00601785e-02]]
grads:  [-1.71111233e-02 -2.27887120e+01]
Stock Position:  -0.017111123250864328
Bond Position:  [0.15665496]


portfolio before change:  [-1.54813784]
curr_Stock_Price:  99.6329663428473
curr_Factors:  [9.96329663e+01 4.77629338e-02]
mat_Sqrt:  [[ 2.17745184e+01  0.00000000e+00]
 [-8.74189305e-03  2.00301933e-02]]
grads:  [ 7.93239495e-03 -1.20568883e+01]
Stock Position:  0.007932394948227249
Bond Position:  [-2.33846587]


portfolio before change:  [-1.5556727]
curr_Stock_Price:  98.75678980096832
curr_Factors:  [9.87567898e+01 4.74203472e-02]
mat_Sqrt:  [[ 2.15054893e+01  0.00000000e+00]
 [-8.71048538e-03  1.99582293e-02]]
grads:  [-2.45471173e-03 -6.24185717e+00]
Stock Position:  -0.0024547117255523756
Bond Position:  [-1.31325325]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.55771565]
Stock Price:  99.45527830213227
PL:  [-1.55771565]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.92847295e-02  1.08872076e-01]
 [ 6.28899582e-02 -2.61574396e-02]
 [ 6.39051417e-01 -2.59054636e-01]
 [-1.17512371e-01 -1.24934067e-01]
 [ 2.23650495e-02 -1.59580249e-02]
 [ 3.97246640e-02 -2.99313587e-02]
 [-8.38759571e-02 -1.57828991e-01]
 [-1.29814082e+00  7.40141082e-01]
 [ 6.83626390e-02 -4.28359429e-02]
 [ 1.33073819e-02 -9.74319158e-02]
 [ 5.97099367e-02  2.78359933e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.48924191e-01 -3.13905363e-02]
 [-7.93871236e-02 -1.11082504e-01]
 [ 9.78907375e-02  1.27874153e-01]
 [-6.65869520e-02 -1.12231543e-01]
 [-1.96261111e-01 -3.09215307e-01]
 [ 3.41115568e-01 -3.96343896e-01]
 [-2.56030540e-01 -1.90681848e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.82642561]
curr_Stock_Price:  98.87769422179862
curr_Factors:  [9.88776942e+01 4.04653130e-02]
mat_Sqrt:  [[ 1.98902290e+01  0.00000000e+00]
 [-8.04639676e-03  1.84366111e-02]]
grads:  [3.86121241e-03 5.90521083e+00]
Stock Position:  0.0038612124054155494
Bond Position:  [-5.20821339]


portfolio before change:  [-4.82387879]
curr_Stock_Price:  99.87454187394715
curr_Factors:  [9.98745419e+01 4.02098587e-02]
mat_Sqrt:  [[ 2.00272387e+01  0.00000000e+00]
 [-8.02095841e-03  1.83783245e-02]]
grads:  [ 0.0025702  -1.42327662]
Stock Position:  0.002570195343954964
Bond Position:  [-5.08057587]


portfolio before change:  [-4.82675864]
curr_Stock_Price:  99.24830755070523
curr_Factors:  [9.92483076e+01 3.99054948e-02]
mat_Sqrt:  [[ 1.98261989e+01  0.00000000e+00]
 [-7.99054389e-03  1.83086361e-02]]
grads:  [  0.02653008 -14.14931369]
Stock Position:  0.026530083065164127
Bond Position:  [-7.45982448]


portfolio before change:  [-4.84714027]
curr_Stock_Price:  98.55036621155399
curr_Factors:  [9.85503662e+01 3.85228285e-02]
mat_Sqrt:  [[ 1.93427102e+01  0.00000000e+00]
 [-7.85089330e-03  1.79886564e-02]]
grads:  [-0.00889421 -6.94515831]
Stock Position:  -0.008894206969712461
Bond Position:  [-3.97061291]


portfolio before change:  [-4.87250508]
curr_Stock_Price:  101.29058054690357
curr_Factors:  [1.01290581e+02 3.61088306e-02]
mat_Sqrt:  [[ 1.92475640e+01  0.00000000e+00]
 [-7.60092948e-03  1.74159173e-02]]
grads:  [ 8.00121845e-04 -9.16289656e-01]
Stock Position:  0.0008001218454398875
Bond Position:  [-4.95354989]


portfolio before change:  [-4.87439436]
curr_Stock_Price:  100.47728708691376
curr_Factors:  [1.00477287e+02 3.65315547e-02]
mat_Sqrt:  [[ 1.92044546e+01  0.00000000e+00]
 [-7.64529186e-03  1.75175643e-02]]
grads:  [ 1.38830019e-03 -1.70864843e+00]
Stock Position:  0.0013883001946790518
Bond Position:  [-5.01388699]


portfolio before change:  [-4.87546884]
curr_Stock_Price:  100.60632784290367
curr_Factors:  [1.00606328e+02 3.31884042e-02]
mat_Sqrt:  [[ 1.83281438e+01  0.00000000e+00]
 [-7.28707395e-03  1.66967840e-02]]
grads:  [-8.33462339e-03 -9.45265811e+00]
Stock Position:  -0.008334623393215484
Bond Position:  [-4.03695298]


portfolio before change:  [-4.87291078]
curr_Stock_Price:  100.1783035312475
curr_Factors:  [1.00178304e+02 3.05958688e-02]
mat_Sqrt:  [[ 1.75228631e+01  0.00000000e+00]
 [-6.99666993e-03  1.60313848e-02]]
grads:  [-0.05564826 46.16825632]
Stock Position:  -0.05564825588973136
Bond Position:  [0.70183709]


portfolio before change:  [-4.76105436]
curr_Stock_Price:  98.17139545008276
curr_Factors:  [9.81713955e+01 3.15763127e-02]
mat_Sqrt:  [[ 1.74447870e+01  0.00000000e+00]
 [-7.10789001e-03  1.62862220e-02]]
grads:  [ 0.00284713 -2.6301952 ]
Stock Position:  0.0028471256637275645
Bond Position:  [-5.04056066]


portfolio before change:  [-4.76121861]
curr_Stock_Price:  98.5563638201985
curr_Factors:  [9.85563638e+01 3.18811585e-02]
mat_Sqrt:  [[ 1.75975302e+01  0.00000000e+00]
 [-7.14211829e-03  1.63646488e-02]]
grads:  [-1.66019845e-03 -5.95380425e+00]
Stock Position:  -0.0016601984490628257
Bond Position:  [-4.59759549]


portfolio before change:  [-4.76092358]
curr_Stock_Price:  97.6862472646249
curr_Factors:  [9.76862473e+01 3.30510842e-02]
mat_Sqrt:  [[ 1.77593179e+01  0.00000000e+00]
 [-7.27198286e-03  1.66622060e-02]]
grads:  [1.02028790e-02 1.67060672e+01]
Stock Position:  0.010202878988806514
Bond Position:  [-5.75760454]


portfolio before change:  [-4.75198706]
curr_Stock_Price:  98.70322500017208
curr_Factors:  [9.87032250e+01 3.36678796e-02]
mat_Sqrt:  [[ 1.81108663e+01  0.00000000e+00]
 [-7.33952364e-03  1.68169613e-02]]
grads:  [ 0.00265125 -0.51087605]
Stock Position:  0.002651252424523343
Bond Position:  [-5.01367423]


portfolio before change:  [-4.75849549]
curr_Stock_Price:  96.72119830430394
curr_Factors:  [9.67211983e+01 3.43659797e-02]
mat_Sqrt:  [[ 1.79302371e+01  0.00000000e+00]
 [-7.41522538e-03  1.69904158e-02]]
grads:  [ 0.00754169 -1.84754374]
Stock Position:  0.007541687066616447
Bond Position:  [-5.4879365]


portfolio before change:  [-4.77102073]
curr_Stock_Price:  95.24234051589802
curr_Factors:  [9.52423405e+01 3.38954898e-02]
mat_Sqrt:  [[ 1.75348081e+01  0.00000000e+00]
 [-7.36429112e-03  1.68737108e-02]]
grads:  [-0.00729221 -6.58316987]
Stock Position:  -0.00729221001350628
Bond Position:  [-4.07649358]


portfolio before change:  [-4.76753155]
curr_Stock_Price:  94.62408678146669
curr_Factors:  [9.46240868e+01 3.22607692e-02]
mat_Sqrt:  [[ 1.69957001e+01  0.00000000e+00]
 [-7.18451325e-03  1.64617879e-02]]
grads:  [0.00904344 7.7679383 ]
Stock Position:  0.00904343992540261
Bond Position:  [-5.62325879]


portfolio before change:  [-4.77940222]
curr_Stock_Price:  93.46692966613186
curr_Factors:  [9.34669297e+01 3.24983412e-02]
mat_Sqrt:  [[ 1.68495604e+01  0.00000000e+00]
 [-7.21091852e-03  1.65222900e-02]]
grads:  [-0.00685886 -6.79273531]
Stock Position:  -0.006858862214465085
Bond Position:  [-4.13832543]


portfolio before change:  [-4.79162052]
curr_Stock_Price:  95.09746127479511
curr_Factors:  [9.50974613e+01 3.04216185e-02]
mat_Sqrt:  [[ 1.65867035e+01  0.00000000e+00]
 [-6.97671768e-03  1.59856684e-02]]
grads:  [ -0.01996863 -19.34328292]
Stock Position:  -0.019968629406698416
Bond Position:  [-2.89265456]


portfolio before change:  [-4.75999112]
curr_Stock_Price:  93.47728710160324
curr_Factors:  [9.34772871e+01 2.85663571e-02]
mat_Sqrt:  [[ 1.57991430e+01  0.00000000e+00]
 [-6.76063395e-03  1.54905584e-02]]
grads:  [ 1.06421538e-02 -2.55861594e+01]
Stock Position:  0.010642153833897229
Bond Position:  [-5.75479079]


portfolio before change:  [-4.76686947]
curr_Stock_Price:  92.96616116305285
curr_Factors:  [9.29661612e+01 2.72552067e-02]
mat_Sqrt:  [[ 1.53479239e+01  0.00000000e+00]
 [-6.60366041e-03  1.51308868e-02]]
grads:  [ -0.02210403 -12.60215943]
Stock Position:  -0.02210402674331195
Bond Position:  [-2.71194296]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.73322169]
Stock Price:  91.41323815514492
PL:  [-4.73322169]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [-1.13296505e-04  8.98829021e-03]
 [-6.29712239e-01  4.20648514e-01]
 [ 9.72891257e-01 -3.60943791e-01]
 [ 3.22079927e-01 -8.03440641e-02]
 [ 7.48442846e-02 -2.07757593e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-2.07026718e-01 -1.77689244e-01]
 [-1.36662548e+00  7.44170307e-01]
 [ 3.20743985e-02 -8.09447589e-02]
 [ 1.68475086e-01  7.16346209e-01]
 [-5.46086709e-01 -1.22522347e-01]
 [-4.07694876e-02 -7.23774437e-02]
 [-8.66145126e-02 -1.26045384e-01]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.14243057e-01 -6.07432291e-02]
 [ 4.33365679e-02 -1.98095085e-02]
 [-1.27127751e-01 -6.57192602e-01]
 [-4.13110560e-01  5.83681407e-02]
 [ 6.52277870e-02 -7.29230191e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.15023833]
curr_Stock_Price:  102.79040812361424
curr_Factors:  [1.02790408e+02 4.02988719e-02]
mat_Sqrt:  [[ 2.06347416e+01  0.00000000e+00]
 [-8.02983157e-03  1.83986555e-02]]
grads:  [1.84616557e-04 4.88529730e-01]
Stock Position:  0.00018461655670027358
Bond Position:  [21.13126152]


portfolio before change:  [21.155975]
curr_Stock_Price:  105.2451741006551
curr_Factors:  [1.05245174e+02 4.05955364e-02]
mat_Sqrt:  [[ 2.12051492e+01  0.00000000e+00]
 [-8.05933361e-03  1.84662532e-02]]
grads:  [-2.10385776e-02  2.27793105e+01]
Stock Position:  -0.021038577562983347
Bond Position:  [23.37018376]


portfolio before change:  [21.18200844]
curr_Stock_Price:  104.28550084793983
curr_Factors:  [1.04285501e+02 4.12121747e-02]
mat_Sqrt:  [[ 2.11707721e+01  0.00000000e+00]
 [-8.12031277e-03  1.86059740e-02]]
grads:  [  0.03851359 -19.39934943]
Stock Position:  0.03851359166605044
Bond Position:  [17.16559924]


portfolio before change:  [21.12737602]
curr_Stock_Price:  102.7555382513353
curr_Factors:  [1.02755538e+02 4.45821684e-02]
mat_Sqrt:  [[ 2.16963077e+01  0.00000000e+00]
 [-8.44579596e-03  1.93517496e-02]]
grads:  [ 0.01322874 -4.15177261]
Stock Position:  0.013228744073997155
Bond Position:  [19.7680493]


portfolio before change:  [21.11929696]
curr_Stock_Price:  101.77118980544005
curr_Factors:  [1.01771190e+02 4.66765645e-02]
mat_Sqrt:  [[ 2.19874211e+01  0.00000000e+00]
 [-8.64190391e-03  1.98010894e-02]]
grads:  [ 0.00299157 -1.04922304]
Stock Position:  0.0029915741217239446
Bond Position:  [20.8148409]


portfolio before change:  [21.12619099]
curr_Stock_Price:  102.33600093502764
curr_Factors:  [1.02336001e+02 4.93919584e-02]
mat_Sqrt:  [[ 2.27434616e+01  0.00000000e+00]
 [-8.88972066e-03  2.03689089e-02]]
grads:  [-2.54852216e-05 -9.50034987e-01]
Stock Position:  -2.5485221559648487e-05
Bond Position:  [21.12879905]


portfolio before change:  [21.13146679]
curr_Stock_Price:  102.61318210395186
curr_Factors:  [1.02613182e+02 4.94352699e-02]
mat_Sqrt:  [[ 2.28150597e+01  0.00000000e+00]
 [-8.89361747e-03  2.03778376e-02]]
grads:  [-0.01247319 -8.71973008]
Stock Position:  -0.012473193791593363
Bond Position:  [22.41138089]


portfolio before change:  [21.13910983]
curr_Stock_Price:  102.44967143874443
curr_Factors:  [1.02449671e+02 5.16133270e-02]
mat_Sqrt:  [[ 2.32750969e+01  0.00000000e+00]
 [-9.08742665e-03  2.08219103e-02]]
grads:  [-0.04476213 35.73977111]
Stock Position:  -0.0447621306405724
Bond Position:  [25.72497541]


portfolio before change:  [21.03836474]
curr_Stock_Price:  104.84404236133948
curr_Factors:  [1.04844042e+02 5.31760739e-02]
mat_Sqrt:  [[ 2.41769711e+01  0.00000000e+00]
 [-9.22397519e-03  2.11347823e-02]]
grads:  [-1.34540861e-04 -3.82993106e+00]
Stock Position:  -0.00013454086075437695
Bond Position:  [21.05247054]


portfolio before change:  [21.04339872]
curr_Stock_Price:  106.55201008390353
curr_Factors:  [1.06552010e+02 5.10140653e-02]
mat_Sqrt:  [[ 2.40661497e+01  0.00000000e+00]
 [-9.03451739e-03  2.07006799e-02]]
grads:  [1.99913243e-02 3.46049604e+01]
Stock Position:  0.01999132428588361
Bond Position:  [18.91328293]


portfolio before change:  [21.05234609]
curr_Stock_Price:  106.7630246077377
curr_Factors:  [1.06763025e+02 5.26445353e-02]
mat_Sqrt:  [[ 2.44961322e+01  0.00000000e+00]
 [-9.17775880e-03  2.10288872e-02]]
grads:  [-0.02447569 -5.82638281]
Stock Position:  -0.024475694373135647
Bond Position:  [23.66544525]


portfolio before change:  [21.04752056]
curr_Stock_Price:  107.20193470286088
curr_Factors:  [1.07201935e+02 5.30176475e-02]
mat_Sqrt:  [[ 2.46838472e+01  0.00000000e+00]
 [-9.21022454e-03  2.11032756e-02]]
grads:  [-2.93137423e-03 -3.42967818e+00]
Stock Position:  -0.0029313742292841937
Bond Position:  [21.36176955]


portfolio before change:  [21.04621663]
curr_Stock_Price:  109.46880400028714
curr_Factors:  [1.09468804e+02 5.32524806e-02]
mat_Sqrt:  [[ 2.52615675e+01  0.00000000e+00]
 [-9.23059960e-03  2.11499607e-02]]
grads:  [-5.60635155e-03 -5.95960368e+00]
Stock Position:  -0.005606351553900456
Bond Position:  [21.65993723]


portfolio before change:  [21.04692693]
curr_Stock_Price:  110.30809524437345
curr_Factors:  [1.10308095e+02 5.32574661e-02]
mat_Sqrt:  [[ 2.54564380e+01  0.00000000e+00]
 [-9.23103168e-03  2.11509507e-02]]
grads:  [5.98030021e-03 7.02465301e+00]
Stock Position:  0.0059803002123644455
Bond Position:  [20.38725141]


portfolio before change:  [21.04000143]
curr_Stock_Price:  108.29766981419635
curr_Factors:  [1.08297670e+02 5.42136439e-02]
mat_Sqrt:  [[ 2.52158383e+01  0.00000000e+00]
 [-9.31352942e-03  2.13399768e-02]]
grads:  [-0.00558195 -2.84645245]
Stock Position:  -0.005581951072883201
Bond Position:  [21.64451373]


portfolio before change:  [21.04482556]
curr_Stock_Price:  108.40295169862091
curr_Factors:  [1.08402952e+02 5.18903884e-02]
mat_Sqrt:  [[ 2.46936091e+01  0.00000000e+00]
 [-9.11178476e-03  2.08777217e-02]]
grads:  [ 0.00140486 -0.94883478]
Stock Position:  0.001404857000464655
Bond Position:  [20.89253491]


portfolio before change:  [21.04974224]
curr_Stock_Price:  108.18434988936544
curr_Factors:  [1.08184350e+02 5.28621142e-02]
mat_Sqrt:  [[ 2.48734888e+01  0.00000000e+00]
 [-9.19670499e-03  2.10722984e-02]]
grads:  [-1.66422218e-02 -3.11875140e+01]
Stock Position:  -0.01664222179115585
Bond Position:  [22.85017019]


portfolio before change:  [21.06361689]
curr_Stock_Price:  107.69394705762413
curr_Factors:  [1.07693947e+02 5.35269876e-02]
mat_Sqrt:  [[ 2.49159641e+01  0.00000000e+00]
 [-9.25436006e-03  2.12044027e-02]]
grads:  [-0.01555776  2.75264253]
Stock Position:  -0.0155577610498986
Bond Position:  [22.73909359]


portfolio before change:  [21.07577049]
curr_Stock_Price:  107.27819841846524
curr_Factors:  [1.07278198e+02 5.47393171e-02]
mat_Sqrt:  [[ 2.50992740e+01  0.00000000e+00]
 [-9.35857401e-03  2.14431869e-02]]
grads:  [ 1.33077842e-03 -3.40075472e+00]
Stock Position:  0.0013307784249257618
Bond Position:  [20.93300698]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.07799163]
Stock Price:  105.01428581511695
PL:  [16.06370582]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.85047258e-02  1.01270760e-01]
 [ 8.21404314e-02 -1.05711691e-02]
 [ 6.94904015e-01 -2.76101055e-01]
 [-1.25090034e-01 -1.41388907e-01]
 [ 3.39578393e-01 -1.35085744e-02]
 [ 4.06046279e-02 -5.52841238e-02]
 [-4.47985626e-02 -1.01701649e-01]
 [-1.26839573e+00  7.11809499e-01]
 [ 6.12693602e-02 -3.26879137e-02]
 [ 1.34004937e-02 -9.69832000e-02]
 [ 4.59370111e-02  2.44620071e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.51813194e-01 -3.08565684e-02]
 [-5.44310943e-02 -5.56503930e-02]
 [ 4.85371866e-02  3.48777461e-02]
 [-1.43625736e-01 -1.40352125e-01]
 [-1.91884983e-01 -3.70194329e-01]
 [ 2.79380361e-01 -3.09939163e-01]
 [-9.36973745e-02 -1.49024688e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.34951764]
curr_Stock_Price:  100.25981321943651
curr_Factors:  [1.00259813e+02 4.02037441e-02]
mat_Sqrt:  [[ 2.01029662e+01  0.00000000e+00]
 [-8.02034854e-03  1.83769271e-02]]
grads:  [3.61652646e-03 5.51075592e+00]
Stock Position:  0.0036165264562427065
Bond Position:  [3.98692537]


portfolio before change:  [4.35265893]
curr_Stock_Price:  100.85276609654854
curr_Factors:  [1.00852766e+02 4.03495119e-02]
mat_Sqrt:  [[ 2.02584847e+01  0.00000000e+00]
 [-8.03487518e-03  1.84102118e-02]]
grads:  [ 0.00382688 -0.57420138]
Stock Position:  0.003826880253570872
Bond Position:  [3.96670747]


portfolio before change:  [4.35100903]
curr_Stock_Price:  100.16246530707849
curr_Factors:  [1.00162465e+02 3.95909874e-02]
mat_Sqrt:  [[ 1.99298106e+01  0.00000000e+00]
 [-7.95899364e-03  1.82363454e-02]]
grads:  [  0.02882133 -15.14015276]
Stock Position:  0.028821329346786006
Bond Position:  [1.46419363]


portfolio before change:  [4.29928955]
curr_Stock_Price:  98.35527686212109
curr_Factors:  [9.83552769e+01 3.81855962e-02]
mat_Sqrt:  [[ 1.92197375e+01  0.00000000e+00]
 [-7.81645405e-03  1.79097462e-02]]
grads:  [-0.00971903 -7.89452324]
Stock Position:  -0.009719030320646058
Bond Position:  [5.25520747]


portfolio before change:  [4.32263819]
curr_Stock_Price:  96.08810904363858
curr_Factors:  [9.60881090e+01 3.88380659e-02]
mat_Sqrt:  [[ 1.89364447e+01  0.00000000e+00]
 [-7.88295030e-03  1.80621082e-02]]
grads:  [ 0.01762119 -0.74789577]
Stock Position:  0.017621194129354704
Bond Position:  [2.62945097]


portfolio before change:  [4.38569862]
curr_Stock_Price:  99.62946887891154
curr_Factors:  [9.96294689e+01 3.54200629e-02]
mat_Sqrt:  [[ 1.87504838e+01  0.00000000e+00]
 [-7.52808744e-03  1.72490153e-02]]
grads:  [ 8.7873243e-04 -3.2050597e+00]
Stock Position:  0.0008787324296503478
Bond Position:  [4.29815098]


portfolio before change:  [4.38596603]
curr_Stock_Price:  98.71079984947745
curr_Factors:  [9.87107998e+01 3.53133924e-02]
mat_Sqrt:  [[ 1.85495933e+01  0.00000000e+00]
 [-7.51674317e-03  1.72230223e-02]]
grads:  [-4.8079114e-03 -5.9049827e+00]
Stock Position:  -0.004807911402877487
Bond Position:  [4.86055881]


portfolio before change:  [4.38998421]
curr_Stock_Price:  98.12782683149837
curr_Factors:  [9.81278268e+01 3.60635232e-02]
mat_Sqrt:  [[ 1.86348653e+01  0.00000000e+00]
 [-7.59615937e-03  1.74049876e-02]]
grads:  [-0.05139488 40.89686896]
Stock Position:  -0.051394876082944664
Bond Position:  [9.43325171]


portfolio before change:  [4.41952201]
curr_Stock_Price:  97.59899604053055
curr_Factors:  [9.75989960e+01 3.59830291e-02]
mat_Sqrt:  [[ 1.85137421e+01  0.00000000e+00]
 [-7.58767728e-03  1.73855527e-02]]
grads:  [ 0.00253883 -1.88017684]
Stock Position:  0.0025388268215728845
Bond Position:  [4.17173506]


portfolio before change:  [4.42286439]
curr_Stock_Price:  98.5046573036271
curr_Factors:  [9.85046573e+01 3.53467996e-02]
mat_Sqrt:  [[ 1.85196090e+01  0.00000000e+00]
 [-7.52029783e-03  1.72311670e-02]]
grads:  [-1.56193605e-03 -5.62835935e+00]
Stock Position:  -0.0015619360462778625
Bond Position:  [4.57672236]


portfolio before change:  [4.42483859]
curr_Stock_Price:  97.97334042105473
curr_Factors:  [9.79733404e+01 3.52848926e-02]
mat_Sqrt:  [[ 1.84035801e+01  0.00000000e+00]
 [-7.51370934e-03  1.72160709e-02]]
grads:  [8.29718795e-03 1.42088211e+01]
Stock Position:  0.008297187953049543
Bond Position:  [3.61193537]


portfolio before change:  [4.43021564]
curr_Stock_Price:  98.51255293502106
curr_Factors:  [9.85125529e+01 3.38985480e-02]
mat_Sqrt:  [[ 1.81376962e+01  0.00000000e+00]
 [-7.36462334e-03  1.68744720e-02]]
grads:  [ 0.00264733 -0.50913492]
Stock Position:  0.0026473306133730596
Bond Position:  [4.16942034]


portfolio before change:  [4.42693771]
curr_Stock_Price:  96.88056536122703
curr_Factors:  [9.68805654e+01 3.37325302e-02]
mat_Sqrt:  [[ 1.77934894e+01  0.00000000e+00]
 [-7.34656711e-03  1.68330999e-02]]
grads:  [ 0.00777511 -1.83308889]
Stock Position:  0.00777510697177399
Bond Position:  [3.67368095]


portfolio before change:  [4.43719145]
curr_Stock_Price:  98.08121768248219
curr_Factors:  [9.80812177e+01 3.04785721e-02]
mat_Sqrt:  [[ 1.71231301e+01  0.00000000e+00]
 [-6.98324533e-03  1.60006252e-02]]
grads:  [-0.00459723 -3.47801367]
Stock Position:  -0.0045972270490455235
Bond Position:  [4.88809307]


portfolio before change:  [4.44329194]
curr_Stock_Price:  97.02007482616827
curr_Factors:  [9.70200748e+01 2.98900810e-02]
mat_Sqrt:  [[ 1.67735563e+01  0.00000000e+00]
 [-6.91549923e-03  1.58453993e-02]]
grads:  [0.00380117 2.20112762]
Stock Position:  0.0038011666533331865
Bond Position:  [4.07450247]


portfolio before change:  [4.44565699]
curr_Stock_Price:  97.37425602377911
curr_Factors:  [9.73742560e+01 3.08304721e-02]
mat_Sqrt:  [[ 1.70975641e+01  0.00000000e+00]
 [-7.02344327e-03  1.60927302e-02]]
grads:  [-0.01198302 -8.72146136]
Stock Position:  -0.01198301842216914
Bond Position:  [5.6124945]


portfolio before change:  [4.44280711]
curr_Stock_Price:  97.72918992154435
curr_Factors:  [9.77291899e+01 2.99629320e-02]
mat_Sqrt:  [[ 1.69167314e+01  0.00000000e+00]
 [-6.92392167e-03  1.58646976e-02]]
grads:  [-2.08935773e-02 -2.33344712e+01]
Stock Position:  -0.02089357725885769
Bond Position:  [6.48471949]


portfolio before change:  [4.48264325]
curr_Stock_Price:  95.90017054906787
curr_Factors:  [9.59001705e+01 3.17878120e-02]
mat_Sqrt:  [[ 1.70981726e+01  0.00000000e+00]
 [-7.13165474e-03  1.63406738e-02]]
grads:  [ 8.42849253e-03 -1.89673428e+01]
Stock Position:  0.008428492534012488
Bond Position:  [3.67434938]


portfolio before change:  [4.48954774]
curr_Stock_Price:  96.61035553107233
curr_Factors:  [9.66103555e+01 3.22041733e-02]
mat_Sqrt:  [[ 1.73372319e+01  0.00000000e+00]
 [-7.17820850e-03  1.64473419e-02]]
grads:  [-0.00915585 -9.06071565]
Stock Position:  -0.009155849195553465
Bond Position:  [5.37409759]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.48405559]
Stock Price:  97.35696579738482
PL:  [4.48405559]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 8.31137341e-03  1.93478549e-02]
 [-1.89256970e-01  1.49680650e-01]
 [ 7.74099153e-01 -3.00271705e-01]
 [ 1.05588341e-01 -1.12050763e-01]
 [-1.58645833e-02 -1.24125971e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-9.03833818e-02 -1.69254120e-01]
 [-1.33888374e+00  7.43003416e-01]
 [ 6.96037219e-02 -7.73470735e-02]
 [ 8.44198351e-02  1.60372331e-01]
 [-7.76891128e-02 -9.50015436e-02]
 [ 1.28102037e-02 -9.19215834e-03]
 [ 1.44836351e-02 -5.43022572e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.16210964e-01 -6.18601218e-02]
 [-1.02166515e-01 -1.07848466e-01]
 [-1.49773407e-01 -5.75555906e-01]
 [-5.51388279e-02 -1.56843560e-01]
 [ 1.29988884e-01  3.67551986e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.99967634]
curr_Stock_Price:  101.7133605328947
curr_Factors:  [1.01713361e+02 3.89009038e-02]
mat_Sqrt:  [[ 2.00612435e+01  0.00000000e+00]
 [-7.88932481e-03  1.80767141e-02]]
grads:  [8.35215901e-04 1.07031924e+00]
Stock Position:  0.0008352159012175575
Bond Position:  [13.91472372]


portfolio before change:  [14.00406569]
curr_Stock_Price:  102.80317687551161
curr_Factors:  [1.02803177e+02 3.71948244e-02]
mat_Sqrt:  [[ 1.98265793e+01  0.00000000e+00]
 [-7.71438390e-03  1.76758741e-02]]
grads:  [-6.25074941e-03  8.46807626e+00]
Stock Position:  -0.006250749407520266
Bond Position:  [14.64666258]


portfolio before change:  [14.01454621]
curr_Stock_Price:  101.7123636164658
curr_Factors:  [1.01712364e+02 3.84413193e-02]
mat_Sqrt:  [[ 1.99421918e+01  0.00000000e+00]
 [-7.84258318e-03  1.79696155e-02]]
grads:  [  0.0322457  -16.70996824]
Stock Position:  0.03224569516706755
Bond Position:  [10.73476034]


portfolio before change:  [13.97646198]
curr_Stock_Price:  100.4480627215437
curr_Factors:  [1.00448063e+02 3.74357898e-02]
mat_Sqrt:  [[ 1.94350233e+01  0.00000000e+00]
 [-7.73933225e-03  1.77330379e-02]]
grads:  [ 2.91666123e-03 -6.31875729e+00]
Stock Position:  0.002916661232010236
Bond Position:  [13.68348901]


portfolio before change:  [13.98131664]
curr_Stock_Price:  100.93950181858891
curr_Factors:  [1.00939502e+02 3.87148953e-02]
mat_Sqrt:  [[ 1.98609584e+01  0.00000000e+00]
 [-7.87044042e-03  1.80334445e-02]]
grads:  [-0.00107154 -0.68830983]
Stock Position:  -0.001071543696603625
Bond Position:  [14.08947772]


portfolio before change:  [13.98248014]
curr_Stock_Price:  103.14128122508374
curr_Factors:  [1.03141281e+02 3.72808969e-02]
mat_Sqrt:  [[ 1.99147885e+01  0.00000000e+00]
 [-7.72330467e-03  1.76963141e-02]]
grads:  [-2.91051124e-05 -1.09351450e+00]
Stock Position:  -2.9105112381912543e-05
Bond Position:  [13.98548208]


portfolio before change:  [13.98602847]
curr_Stock_Price:  101.37113450760975
curr_Factors:  [1.01371135e+02 3.81611844e-02]
mat_Sqrt:  [[ 1.98027374e+01  0.00000000e+00]
 [-7.81395514e-03  1.79040205e-02]]
grads:  [-8.29440558e-03 -9.45341414e+00]
Stock Position:  -0.008294405575184141
Bond Position:  [14.82684178]


portfolio before change:  [13.98919286]
curr_Stock_Price:  101.43657429657164
curr_Factors:  [1.01436574e+02 3.87454881e-02]
mat_Sqrt:  [[ 1.99666471e+01  0.00000000e+00]
 [-7.87354945e-03  1.80405682e-02]]
grads:  [-0.05081526 41.18514504]
Stock Position:  -0.050815264840815
Bond Position:  [19.14371925]


portfolio before change:  [13.98630246]
curr_Stock_Price:  101.58764963333634
curr_Factors:  [1.01587650e+02 3.86408525e-02]
mat_Sqrt:  [[ 1.99693653e+01  0.00000000e+00]
 [-7.86291066e-03  1.80161916e-02]]
grads:  [ 1.79508417e-03 -4.29319775e+00]
Stock Position:  0.0017950841654907133
Bond Position:  [13.80394408]


portfolio before change:  [13.98910561]
curr_Stock_Price:  101.22651719411756
curr_Factors:  [1.01226517e+02 3.67741575e-02]
mat_Sqrt:  [[ 1.94117934e+01  0.00000000e+00]
 [-7.67063569e-03  1.75756343e-02]]
grads:  [7.95454883e-03 9.12469658e+00]
Stock Position:  0.007954548825557522
Bond Position:  [13.18389434]


portfolio before change:  [13.98548631]
curr_Stock_Price:  100.35711647843439
curr_Factors:  [1.00357116e+02 3.65898196e-02]
mat_Sqrt:  [[ 1.91967765e+01  0.00000000e+00]
 [-7.65138624e-03  1.75315283e-02]]
grads:  [-0.00620683 -5.41889685]
Stock Position:  -0.006206832985317101
Bond Position:  [14.60838617]


portfolio before change:  [13.98038146]
curr_Stock_Price:  101.76804482676414
curr_Factors:  [1.01768045e+02 3.49167315e-02]
mat_Sqrt:  [[ 1.90163964e+01  0.00000000e+00]
 [-7.47440769e-03  1.71260195e-02]]
grads:  [ 4.62675298e-04 -5.36736416e-01]
Stock Position:  0.00046267529788075306
Bond Position:  [13.9332959]


portfolio before change:  [13.98498996]
curr_Stock_Price:  104.1989930247973
curr_Factors:  [1.04198993e+02 3.53118685e-02]
mat_Sqrt:  [[ 1.95805042e+01  0.00000000e+00]
 [-7.51658098e-03  1.72226506e-02]]
grads:  [-4.70662697e-04 -3.15295586e+00]
Stock Position:  -0.0004706626969262301
Bond Position:  [14.03403254]


portfolio before change:  [13.98909704]
curr_Stock_Price:  102.92815710986748
curr_Factors:  [1.02928157e+02 3.49968878e-02]
mat_Sqrt:  [[ 1.92552388e+01  0.00000000e+00]
 [-7.48298206e-03  1.71456659e-02]]
grads:  [7.90627128e-03 8.66563542e+00]
Stock Position:  0.00790627128214027
Bond Position:  [13.17531911]


portfolio before change:  [13.99898368]
curr_Stock_Price:  103.76197545649123
curr_Factors:  [1.03761975e+02 3.52608937e-02]
mat_Sqrt:  [[ 1.94843037e+01  0.00000000e+00]
 [-7.51115371e-03  1.72102152e-02]]
grads:  [-0.00734996 -3.59438398]
Stock Position:  -0.007349964220373842
Bond Position:  [14.76163049]


portfolio before change:  [14.00139119]
curr_Stock_Price:  103.93658322180154
curr_Factors:  [1.03936583e+02 3.69567900e-02]
mat_Sqrt:  [[ 1.99809235e+01  0.00000000e+00]
 [-7.68965955e-03  1.76192235e-02]]
grads:  [-0.0074689  -6.12106806]
Stock Position:  -0.007468896229544597
Bond Position:  [14.77768274]


portfolio before change:  [14.00338602]
curr_Stock_Price:  104.16419986968185
curr_Factors:  [1.04164200e+02 3.65374919e-02]
mat_Sqrt:  [[ 1.99107605e+01  0.00000000e+00]
 [-7.64591309e-03  1.75189877e-02]]
grads:  [-2.01381860e-02 -3.28532627e+01]
Stock Position:  -0.020138186002422283
Bond Position:  [16.10106406]


portfolio before change:  [14.03295317]
curr_Stock_Price:  102.89589403658908
curr_Factors:  [1.02895894e+02 3.83580475e-02]
mat_Sqrt:  [[ 2.01523776e+01  0.00000000e+00]
 [-7.83408425e-03  1.79501420e-02]]
grads:  [-6.13282323e-03 -8.73773364e+00]
Stock Position:  -0.006132823233943439
Bond Position:  [14.6639955]


portfolio before change:  [14.03947428]
curr_Stock_Price:  102.43042316177952
curr_Factors:  [1.02430423e+02 4.01150206e-02]
mat_Sqrt:  [[ 2.05155175e+01  0.00000000e+00]
 [-8.01149381e-03  1.83566384e-02]]
grads:  [0.00711803 2.00228374]
Stock Position:  0.007118034799630206
Bond Position:  [13.31037096]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.05096877]
Stock Price:  103.5777175279136
PL:  [10.47325124]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.35198288e-02  8.22033588e-02]
 [ 7.79441543e-02 -7.13565297e-03]
 [ 4.97438811e-01 -2.15833944e-01]
 [-1.00747690e-01 -1.08784843e-01]
 [ 3.16501749e-01 -1.18198521e-02]
 [ 2.22185349e-02 -8.41903143e-02]
 [-4.75097371e-02 -1.05596922e-01]
 [-1.25459676e+00  7.27552046e-01]
 [ 6.63286051e-02 -3.98968178e-02]
 [ 1.58280340e-02 -8.52846293e-02]
 [ 1.14942589e-01  3.31785909e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.31207779e-01 -3.46212750e-02]
 [-7.69979177e-02 -1.05923555e-01]
 [ 1.01581356e-01  1.34663434e-01]
 [-4.42309094e-02 -1.04629505e-01]
 [-2.01475975e-01 -2.36600847e-01]
 [ 4.05470462e-01 -4.42458360e-01]
 [-2.91291860e-01 -1.99733020e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.12225736]
curr_Stock_Price:  100.37620651108408
curr_Factors:  [1.00376207e+02 3.86026506e-02]
mat_Sqrt:  [[ 1.97214726e+01  0.00000000e+00]
 [-7.85902290e-03  1.80072837e-02]]
grads:  [3.01175865e-03 4.56500605e+00]
Stock Position:  0.0030117586525589646
Bond Position:  [4.81994845]


portfolio before change:  [5.12348342]
curr_Stock_Price:  100.3831557681947
curr_Factors:  [1.00383156e+02 3.52007262e-02]
mat_Sqrt:  [[ 1.88337437e+01  0.00000000e+00]
 [-7.50474263e-03  1.71955256e-02]]
grads:  [ 0.00397318 -0.4149715 ]
Stock Position:  0.00397318245170472
Bond Position:  [4.72464283]


portfolio before change:  [5.11277062]
curr_Stock_Price:  97.38955778412026
curr_Factors:  [9.73895578e+01 3.68635805e-02]
mat_Sqrt:  [[ 1.86986887e+01  0.00000000e+00]
 [-7.67995630e-03  1.75969905e-02]]
grads:  [  0.02156521 -12.26538957]
Stock Position:  0.021565210358532212
Bond Position:  [3.01254432]


portfolio before change:  [5.09916906]
curr_Stock_Price:  96.72391204178474
curr_Factors:  [9.67239120e+01 3.59624892e-02]
mat_Sqrt:  [[ 1.83425084e+01  0.00000000e+00]
 [-7.58551137e-03  1.73805900e-02]]
grads:  [-0.00808097 -6.25898445]
Stock Position:  -0.0080809715312844
Bond Position:  [5.88079224]


portfolio before change:  [5.10059692]
curr_Stock_Price:  96.72917409629062
curr_Factors:  [9.67291741e+01 3.75614891e-02]
mat_Sqrt:  [[ 1.87468749e+01  0.00000000e+00]
 [-7.75231466e-03  1.77627844e-02]]
grads:  [ 0.01660774 -0.66542789]
Stock Position:  0.016607735709173316
Bond Position:  [3.49414436]


portfolio before change:  [5.1344394]
curr_Stock_Price:  98.714323408101
curr_Factors:  [9.87143234e+01 3.78701049e-02]
mat_Sqrt:  [[ 1.92100470e+01  0.00000000e+00]
 [-7.78409711e-03  1.78356071e-02]]
grads:  [-7.56121555e-04 -4.72035035e+00]
Stock Position:  -0.000756121554769429
Bond Position:  [5.20907943]


portfolio before change:  [5.13564921]
curr_Stock_Price:  98.83681563033822
curr_Factors:  [9.88368156e+01 3.80023537e-02]
mat_Sqrt:  [[ 1.92674390e+01  0.00000000e+00]
 [-7.79767695e-03  1.78667224e-02]]
grads:  [-4.85772979e-03 -5.91025705e+00]
Stock Position:  -0.004857729787867242
Bond Position:  [5.61577176]


portfolio before change:  [5.13728165]
curr_Stock_Price:  98.78981495823723
curr_Factors:  [9.87898150e+01 3.95185864e-02]
mat_Sqrt:  [[ 1.96387062e+01  0.00000000e+00]
 [-7.95171291e-03  1.82196632e-02]]
grads:  [-0.04771531 39.9322446 ]
Stock Position:  -0.04771531310185215
Bond Position:  [9.8510686]


portfolio before change:  [5.17721198]
curr_Stock_Price:  98.00458989734645
curr_Factors:  [9.80045899e+01 3.95853143e-02]
mat_Sqrt:  [[ 1.94990505e+01  0.00000000e+00]
 [-7.95842339e-03  1.82350388e-02]]
grads:  [ 0.00250865 -2.18792064]
Stock Position:  0.002508645550742689
Bond Position:  [4.9313532]


portfolio before change:  [5.17674252]
curr_Stock_Price:  97.32595435095877
curr_Factors:  [9.73259544e+01 4.30917884e-02]
mat_Sqrt:  [[ 2.02034683e+01  0.00000000e+00]
 [-8.30342469e-03  1.90255361e-02]]
grads:  [-1.05888897e-03 -4.48264002e+00]
Stock Position:  -0.0010588889703472373
Bond Position:  [5.2797999]


portfolio before change:  [5.17961885]
curr_Stock_Price:  95.85628406343267
curr_Factors:  [9.58562841e+01 4.29275526e-02]
mat_Sqrt:  [[ 1.98604303e+01  0.00000000e+00]
 [-8.28758615e-03  1.89892454e-02]]
grads:  [1.30785601e-02 1.74723061e+01]
Stock Position:  0.013078560088103978
Bond Position:  [3.92595668]


portfolio before change:  [5.19194502]
curr_Stock_Price:  96.72370037257731
curr_Factors:  [9.67237004e+01 4.53994715e-02]
mat_Sqrt:  [[ 2.06090656e+01  0.00000000e+00]
 [-8.52286070e-03  1.95283271e-02]]
grads:  [ 0.00232987 -0.43994464]
Stock Position:  0.0023298716786542125
Bond Position:  [4.96659121]


portfolio before change:  [5.19081238]
curr_Stock_Price:  95.70456905107802
curr_Factors:  [9.57045691e+01 4.54300823e-02]
mat_Sqrt:  [[ 2.03987913e+01  0.00000000e+00]
 [-8.52573350e-03  1.95349096e-02]]
grads:  [ 0.00569141 -1.77227721]
Stock Position:  0.005691406614255959
Bond Position:  [4.64611876]


portfolio before change:  [5.19084886]
curr_Stock_Price:  95.50686921703799
curr_Factors:  [9.55068692e+01 4.59188389e-02]
mat_Sqrt:  [[ 2.04658628e+01  0.00000000e+00]
 [-8.57147258e-03  1.96397110e-02]]
grads:  [-0.00602109 -5.39333572]
Stock Position:  -0.006021087326694331
Bond Position:  [5.76590406]


portfolio before change:  [5.19862335]
curr_Stock_Price:  94.45509469154905
curr_Factors:  [9.44550947e+01 4.69351922e-02]
mat_Sqrt:  [[ 2.04632537e+01  0.00000000e+00]
 [-8.66581257e-03  1.98558710e-02]]
grads:  [0.00783616 6.78204616]
Stock Position:  0.007836158388512482
Bond Position:  [4.45845826]


portfolio before change:  [5.18658782]
curr_Stock_Price:  92.77694098989448
curr_Factors:  [9.27769410e+01 4.74758319e-02]
mat_Sqrt:  [[ 2.02151208e+01  0.00000000e+00]
 [-8.71557979e-03  1.99699020e-02]]
grads:  [-4.44691722e-03 -5.23935993e+00]
Stock Position:  -0.0044469172238682814
Bond Position:  [5.5991592]


portfolio before change:  [5.19081343]
curr_Stock_Price:  92.14152526759125
curr_Factors:  [9.21415253e+01 4.87278043e-02]
mat_Sqrt:  [[ 2.03396660e+01  0.00000000e+00]
 [-8.82975010e-03  2.02314991e-02]]
grads:  [ -0.0149824  -11.69467698]
Stock Position:  -0.014982401864488543
Bond Position:  [6.57131479]


portfolio before change:  [5.19296699]
curr_Stock_Price:  92.10744977019901
curr_Factors:  [9.21074498e+01 4.92122271e-02]
mat_Sqrt:  [[ 2.04329592e+01  0.00000000e+00]
 [-8.87353162e-03  2.03318152e-02]]
grads:  [ 1.03932965e-02 -2.17618721e+01]
Stock Position:  0.010393296453624025
Bond Position:  [4.23566696]


portfolio before change:  [5.19487899]
curr_Stock_Price:  92.18951719562234
curr_Factors:  [9.21895172e+01 5.04664433e-02]
mat_Sqrt:  [[ 2.07101331e+01  0.00000000e+00]
 [-8.98589502e-03  2.05892721e-02]]
grads:  [-0.01827427 -9.70082962]
Stock Position:  -0.018274266739265445
Bond Position:  [6.87957482]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.22412173]
Stock Price:  90.68343060262275
PL:  [5.22412173]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.34727314e-02  1.22969721e-01]
 [ 3.89934670e-02 -6.20670215e-02]
 [ 6.07433057e-01 -2.49404595e-01]
 [-1.30105223e-02 -1.00390860e-01]
 [ 2.55764762e-01 -7.66896598e-03]
 [ 2.50625533e-02 -7.96954554e-02]
 [-8.56254499e-02 -1.60431492e-01]
 [-1.25547178e+00  7.28041507e-01]
 [ 8.36869265e-02 -7.48092002e-02]
 [ 2.11289803e-02 -8.53529945e-02]
 [ 1.07579271e-01  3.04173164e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.51847396e-01 -3.08409680e-02]
 [-8.91334432e-02 -1.32241138e-01]
 [ 8.36171695e-02  1.00953010e-01]
 [-1.06246106e-01 -1.25841434e-01]
 [-1.98196693e-01 -2.82255747e-01]
 [ 3.66357840e-01 -4.14497518e-01]
 [-3.35485539e-01 -2.11072450e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.60230854]
curr_Stock_Price:  99.99664126832528
curr_Factors:  [9.99966413e+01 4.01645308e-02]
mat_Sqrt:  [[ 2.00404174e+01  0.00000000e+00]
 [-8.01643620e-03  1.83679628e-02]]
grads:  [3.84927699e-03 6.69479363e+00]
Stock Position:  0.0038492769893511453
Bond Position:  [2.21739377]


portfolio before change:  [2.59421171]
curr_Stock_Price:  97.7491413452703
curr_Factors:  [9.77491413e+01 3.88096141e-02]
mat_Sqrt:  [[ 1.92567332e+01  0.00000000e+00]
 [-7.88006235e-03  1.80554911e-02]]
grads:  [ 6.18235603e-04 -3.43757039e+00]
Stock Position:  0.000618235603116198
Bond Position:  [2.53377971]


portfolio before change:  [2.59578521]
curr_Stock_Price:  99.26956582924915
curr_Factors:  [9.92695658e+01 3.55776770e-02]
mat_Sqrt:  [[ 1.87242709e+01  0.00000000e+00]
 [-7.54481830e-03  1.72873505e-02]]
grads:  [  0.02662768 -14.4269994 ]
Stock Position:  0.026627683902494217
Bond Position:  [-0.04753341]


portfolio before change:  [2.60444202]
curr_Stock_Price:  99.59511778091976
curr_Factors:  [9.95951178e+01 3.84079700e-02]
mat_Sqrt:  [[ 1.95186028e+01  0.00000000e+00]
 [-7.83918056e-03  1.79618192e-02]]
grads:  [-2.91130909e-03 -5.58912543e+00]
Stock Position:  -0.002911309088607922
Bond Position:  [2.8943942]


portfolio before change:  [2.60890399]
curr_Stock_Price:  98.31106233837608
curr_Factors:  [9.83110623e+01 3.71636403e-02]
mat_Sqrt:  [[ 1.89522821e+01  0.00000000e+00]
 [-7.71114936e-03  1.76684628e-02]]
grads:  [ 0.01331859 -0.43404828]
Stock Position:  0.013318593987503667
Bond Position:  [1.29953887]


portfolio before change:  [2.61651129]
curr_Stock_Price:  98.8578446998803
curr_Factors:  [9.88578447e+01 3.65632314e-02]
mat_Sqrt:  [[ 1.89031170e+01  0.00000000e+00]
 [-7.64860577e-03  1.75251574e-02]]
grads:  [-5.14168903e-04 -4.54748870e+00]
Stock Position:  -0.0005141689029038214
Bond Position:  [2.66734092]


portfolio before change:  [2.61622933]
curr_Stock_Price:  100.70331252848143
curr_Factors:  [1.00703313e+02 3.68996934e-02]
mat_Sqrt:  [[ 1.93443943e+01  0.00000000e+00]
 [-7.68371716e-03  1.76056078e-02]]
grads:  [-8.04592230e-03 -9.11252222e+00]
Stock Position:  -0.008045922302883009
Bond Position:  [3.42648036]


portfolio before change:  [2.63240531]
curr_Stock_Price:  98.79933565995772
curr_Factors:  [9.87993357e+01 3.81870594e-02]
mat_Sqrt:  [[ 1.93068816e+01  0.00000000e+00]
 [-7.81660380e-03  1.79100893e-02]]
grads:  [-0.04856965 40.64979771]
Stock Position:  -0.04856964678675386
Bond Position:  [7.43105414]


portfolio before change:  [2.56095317]
curr_Stock_Price:  100.30871733118741
curr_Factors:  [1.00308717e+02 3.36893019e-02]
mat_Sqrt:  [[ 1.84113097e+01  0.00000000e+00]
 [-7.34185829e-03  1.68223107e-02]]
grads:  [ 2.77207411e-03 -4.44702286e+00]
Stock Position:  0.00277207410513815
Bond Position:  [2.28288997]


portfolio before change:  [2.55857716]
curr_Stock_Price:  99.24568661638698
curr_Factors:  [9.92456866e+01 3.49478667e-02]
mat_Sqrt:  [[ 1.85533346e+01  0.00000000e+00]
 [-7.47773941e-03  1.71336534e-02]]
grads:  [-8.68960802e-04 -4.98159921e+00]
Stock Position:  -0.0008689608024960057
Bond Position:  [2.64481777]


portfolio before change:  [2.56131245]
curr_Stock_Price:  96.85892448649686
curr_Factors:  [9.68589245e+01 3.55343327e-02]
mat_Sqrt:  [[ 1.82584423e+01  0.00000000e+00]
 [-7.54022097e-03  1.72768167e-02]]
grads:  [1.31627506e-02 1.76058570e+01]
Stock Position:  0.01316275062696675
Bond Position:  [1.28638258]


portfolio before change:  [2.55818072]
curr_Stock_Price:  96.59656516823821
curr_Factors:  [9.65965652e+01 3.64904953e-02]
mat_Sqrt:  [[ 1.84523449e+01  0.00000000e+00]
 [-7.64099421e-03  1.75077172e-02]]
grads:  [ 0.00260219 -0.49071976]
Stock Position:  0.0026021884270792483
Bond Position:  [2.30681825]


portfolio before change:  [2.55947971]
curr_Stock_Price:  96.87410907512248
curr_Factors:  [9.68741091e+01 3.52479068e-02]
mat_Sqrt:  [[ 1.81875578e+01  0.00000000e+00]
 [-7.50977036e-03  1.72070456e-02]]
grads:  [ 0.0076089  -1.79234535]
Stock Position:  0.007608899216698818
Bond Position:  [1.82237438]


portfolio before change:  [2.53962898]
curr_Stock_Price:  94.20534190901131
curr_Factors:  [9.42053419e+01 3.65421618e-02]
mat_Sqrt:  [[ 1.80082971e+01  0.00000000e+00]
 [-7.64640169e-03  1.75201073e-02]]
grads:  [-0.00815447 -7.54796395]
Stock Position:  -0.008154474921586828
Bond Position:  [3.30782408]


portfolio before change:  [2.53137791]
curr_Stock_Price:  95.31861175237214
curr_Factors:  [9.53186118e+01 3.38255456e-02]
mat_Sqrt:  [[ 1.75307346e+01  0.00000000e+00]
 [-7.35668900e-03  1.68562921e-02]]
grads:  [0.00728302 5.98904016]
Stock Position:  0.007283019141037249
Bond Position:  [1.83717064]


portfolio before change:  [2.52727408]
curr_Stock_Price:  94.69206044379858
curr_Factors:  [9.46920604e+01 3.39260562e-02]
mat_Sqrt:  [[ 1.74413563e+01  0.00000000e+00]
 [-7.36761087e-03  1.68813173e-02]]
grads:  [-0.00924055 -7.45447953]
Stock Position:  -0.009240554869109928
Bond Position:  [3.40228126]


portfolio before change:  [2.53475784]
curr_Stock_Price:  93.9742370701495
curr_Factors:  [9.39742371e+01 3.46458590e-02]
mat_Sqrt:  [[ 1.74917989e+01  0.00000000e+00]
 [-7.44535926e-03  1.70594612e-02]]
grads:  [ -0.01837336 -16.54540807]
Stock Position:  -0.018373364700924603
Bond Position:  [4.26138077]


portfolio before change:  [2.5546132]
curr_Stock_Price:  92.95156773191941
curr_Factors:  [9.29515677e+01 3.46453468e-02]
mat_Sqrt:  [[ 1.73013175e+01  0.00000000e+00]
 [-7.44530422e-03  1.70593351e-02]]
grads:  [ 1.07192006e-02 -2.42974018e+01]
Stock Position:  0.01071920057995585
Bond Position:  [1.5582467]


portfolio before change:  [2.53611661]
curr_Stock_Price:  91.18966454977317
curr_Factors:  [9.11896645e+01 3.65063989e-02]
mat_Sqrt:  [[ 1.74232880e+01  0.00000000e+00]
 [-7.64265911e-03  1.75115319e-02]]
grads:  [ -0.02454216 -12.05334011]
Stock Position:  -0.024542159225410667
Bond Position:  [4.77410788]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.57995235]
Stock Price:  89.45216227773213
PL:  [2.57995235]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.86461587e-02  4.68470254e-02]
 [ 8.36629395e-02 -1.08187339e-02]
 [ 7.25025518e-01 -2.85294250e-01]
 [ 1.39771742e-01 -1.15802524e-01]
 [ 3.45328663e-02 -1.70817819e-02]
 [ 3.85191084e-02 -3.65601336e-02]
 [-7.25633259e-02 -1.41582371e-01]
 [-1.33593198e+00  7.43045554e-01]
 [ 7.35206996e-02 -7.67314314e-02]
 [ 9.36471424e-02  1.98999663e-01]
 [-3.42360618e-01 -4.97481156e-02]
 [-1.19218353e-03 -9.40810251e-03]
 [ 2.59535508e-02 -4.61785030e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.16023159e-01 -6.17535322e-02]
 [-9.90797713e-02 -1.06540428e-01]
 [-1.38932200e-01 -6.10002374e-01]
 [-2.73350390e-01 -1.77273166e-02]
 [ 6.33017957e-02 -8.04468156e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.48745477]
curr_Stock_Price:  100.58183826189114
curr_Factors:  [1.00581838e+02 4.09102748e-02]
mat_Sqrt:  [[ 2.03439728e+01  0.00000000e+00]
 [-8.09051542e-03  1.85376997e-02]]
grads:  [1.92154586e-03 2.52712183e+00]
Stock Position:  0.0019215458593654599
Bond Position:  [6.29418215]


portfolio before change:  [6.48944698]
curr_Stock_Price:  100.79961658845498
curr_Factors:  [1.00799617e+02 4.10506445e-02]
mat_Sqrt:  [[ 2.04229686e+01  0.00000000e+00]
 [-8.10438345e-03  1.85694753e-02]]
grads:  [ 0.00386532 -0.58260849]
Stock Position:  0.003865317447654211
Bond Position:  [6.09982446]


portfolio before change:  [6.4897396]
curr_Stock_Price:  100.48074764121777
curr_Factors:  [1.00480748e+02 4.08826588e-02]
mat_Sqrt:  [[ 2.03166652e+01  0.00000000e+00]
 [-8.08778425e-03  1.85314418e-02]]
grads:  [  0.02955765 -15.39514589]
Stock Position:  0.02955765099521042
Bond Position:  [3.51976473]


portfolio before change:  [6.49682293]
curr_Stock_Price:  100.6906182938767
curr_Factors:  [1.00690618e+02 4.12151303e-02]
mat_Sqrt:  [[ 2.04417158e+01  0.00000000e+00]
 [-8.12060395e-03  1.86066411e-02]]
grads:  [ 4.36516083e-03 -6.22371996e+00]
Stock Position:  0.004365160830885209
Bond Position:  [6.05729219]


portfolio before change:  [6.5014358]
curr_Stock_Price:  101.4004103258315
curr_Factors:  [1.0140041e+02 3.9860553e-02]
mat_Sqrt:  [[ 2.02447012e+01  0.00000000e+00]
 [-7.98604313e-03  1.82983236e-02]]
grads:  [ 0.00133752 -0.93351622]
Stock Position:  0.0013375235883888116
Bond Position:  [6.36581036]


portfolio before change:  [6.50157252]
curr_Stock_Price:  100.3126306755738
curr_Factors:  [1.00312631e+02 3.84403107e-02]
mat_Sqrt:  [[ 1.96674957e+01  0.00000000e+00]
 [-7.84248029e-03  1.79693798e-02]]
grads:  [ 1.14722069e-03 -2.03457960e+00]
Stock Position:  0.0011472206870639422
Bond Position:  [6.3864918]


portfolio before change:  [6.50286686]
curr_Stock_Price:  100.04896345295808
curr_Factors:  [1.00048963e+02 3.82540540e-02]
mat_Sqrt:  [[ 1.95682202e+01  0.00000000e+00]
 [-7.82345744e-03  1.79257930e-02]]
grads:  [-6.86597643e-03 -7.89824871e+00]
Stock Position:  -0.006865976425238423
Bond Position:  [7.18980068]


portfolio before change:  [6.4961056]
curr_Stock_Price:  101.29553524044624
curr_Factors:  [1.01295535e+02 3.58200961e-02]
mat_Sqrt:  [[ 1.91713933e+01  0.00000000e+00]
 [-7.57047910e-03  1.73461468e-02]]
grads:  [-0.05276822 42.83634655]
Stock Position:  -0.05276822098900647
Bond Position:  [11.84129079]


portfolio before change:  [6.50039258]
curr_Stock_Price:  101.27040111879954
curr_Factors:  [1.01270401e+02 3.52761187e-02]
mat_Sqrt:  [[ 1.90205437e+01  0.00000000e+00]
 [-7.51277511e-03  1.72139303e-02]]
grads:  [ 2.10469048e-03 -4.45751958e+00]
Stock Position:  0.0021046904836610294
Bond Position:  [6.28724973]


portfolio before change:  [6.50288648]
curr_Stock_Price:  101.70841925906821
curr_Factors:  [1.01708419e+02 3.42096269e-02]
mat_Sqrt:  [[ 1.88118312e+01  0.00000000e+00]
 [-7.39833786e-03  1.69517216e-02]]
grads:  [9.59490406e-03 1.17392008e+01]
Stock Position:  0.009594904061585995
Bond Position:  [5.52700395]


portfolio before change:  [6.5276266]
curr_Stock_Price:  104.14285718408398
curr_Factors:  [1.04142857e+02 3.14404458e-02]
mat_Sqrt:  [[ 1.84660427e+01  0.00000000e+00]
 [-7.09258156e-03  1.62511459e-02]]
grads:  [-0.01971578 -3.06120663]
Stock Position:  -0.019715782171112115
Bond Position:  [8.58088449]


portfolio before change:  [6.54815439]
curr_Stock_Price:  103.21049224762875
curr_Factors:  [1.03210492e+02 3.20311608e-02]
mat_Sqrt:  [[ 1.84718413e+01  0.00000000e+00]
 [-7.15890056e-03  1.64031019e-02]]
grads:  [-2.86826636e-04 -5.73556306e-01]
Stock Position:  -0.0002868266358141032
Bond Position:  [6.57775791]


portfolio before change:  [6.54968738]
curr_Stock_Price:  103.59979410351063
curr_Factors:  [1.03599794e+02 3.16642463e-02]
mat_Sqrt:  [[ 1.84350139e+01  0.00000000e+00]
 [-7.11778014e-03  1.63088831e-02]]
grads:  [ 3.14596986e-04 -2.83149389e+00]
Stock Position:  0.0003145969861738403
Bond Position:  [6.51709519]


portfolio before change:  [6.55150536]
curr_Stock_Price:  104.19900554570194
curr_Factors:  [1.04199006e+02 3.10330739e-02]
mat_Sqrt:  [[ 1.83559122e+01  0.00000000e+00]
 [-7.04648269e-03  1.61455201e-02]]
grads:  [8.29362987e-03 9.20243436e+00]
Stock Position:  0.008293629865856097
Bond Position:  [5.68731738]


portfolio before change:  [6.55295348]
curr_Stock_Price:  104.20215305525271
curr_Factors:  [1.04202153e+02 3.20460975e-02]
mat_Sqrt:  [[ 1.86536691e+01  0.00000000e+00]
 [-7.16056953e-03  1.64069259e-02]]
grads:  [-0.00766469 -3.76386975]
Stock Position:  -0.00766469103413799
Bond Position:  [7.35163078]


portfolio before change:  [6.55592665]
curr_Stock_Price:  104.05406623977548
curr_Factors:  [1.04054066e+02 3.17068684e-02]
mat_Sqrt:  [[ 1.85283067e+01  0.00000000e+00]
 [-7.12256902e-03  1.63198558e-02]]
grads:  [-0.00785705 -6.5282702 ]
Stock Position:  -0.00785704968068966
Bond Position:  [7.37348462]


portfolio before change:  [6.54498544]
curr_Stock_Price:  105.68124400261311
curr_Factors:  [1.05681244e+02 3.06505249e-02]
mat_Sqrt:  [[ 1.85019232e+01  0.00000000e+00]
 [-7.00291652e-03  1.60456975e-02]]
grads:  [-2.18982133e-02 -3.80165694e+01]
Stock Position:  -0.021898213306136886
Bond Position:  [8.85921586]


portfolio before change:  [6.55515361]
curr_Stock_Price:  105.31805955355655
curr_Factors:  [1.05318060e+02 3.02805159e-02]
mat_Sqrt:  [[ 1.83267090e+01  0.00000000e+00]
 [-6.96051905e-03  1.59485527e-02]]
grads:  [-0.01533757 -1.11153137]
Stock Position:  -0.015337572358747194
Bond Position:  [8.17047697]


portfolio before change:  [6.52444486]
curr_Stock_Price:  107.45344469455407
curr_Factors:  [1.07453445e+02 2.95318002e-02]
mat_Sqrt:  [[ 1.84656799e+01  0.00000000e+00]
 [-6.87392758e-03  1.57501467e-02]]
grads:  [ 1.52672022e-03 -5.10768675e+00]
Stock Position:  0.0015267202191834106
Bond Position:  [6.36039351]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.52649729]
Stock Price:  107.7561382040099
PL:  [-1.22964092]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.05279774e-02  2.20735465e-02]
 [-2.36642781e-02  4.78169070e-02]
 [ 7.91438156e-01 -3.05563632e-01]
 [ 3.76343338e-01 -6.34215649e-02]
 [ 3.24556306e-01 -3.38530892e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-3.06204707e-01 -1.49993182e-01]
 [-1.41199343e+00  7.49245022e-01]
 [ 3.66289707e-02 -7.81123289e-02]
 [ 1.60942634e-01  6.49374322e-01]
 [-5.37230679e-01 -1.20072605e-01]
 [-4.09362649e-02 -1.02348266e-01]
 [-2.10115850e-02 -7.94536440e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15611873e-01 -6.15201051e-02]
 [-1.09481327e-01 -1.10948190e-01]
 [-1.45840353e-01 -5.86522783e-01]
 [-2.70787024e-01 -1.87738341e-02]
 [ 1.34357463e-01 -2.07453593e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.11827325]
curr_Stock_Price:  101.4299757209111
curr_Factors:  [1.01429976e+02 3.83475598e-02]
mat_Sqrt:  [[ 1.98625585e+01  0.00000000e+00]
 [-7.83301320e-03  1.79476879e-02]]
grads:  [1.01505870e-03 1.22988245e+00]
Stock Position:  0.0010150587042807697
Bond Position:  [12.01531587]


portfolio before change:  [12.12173582]
curr_Stock_Price:  101.8815417814269
curr_Factors:  [1.01881542e+02 3.85372634e-02]
mat_Sqrt:  [[ 2.00002739e+01  0.00000000e+00]
 [-7.85236407e-03  1.79920264e-02]]
grads:  [-1.39761536e-04  2.65767213e+00]
Stock Position:  -0.00013976153574041632
Bond Position:  [12.13597494]


portfolio before change:  [12.12478523]
curr_Stock_Price:  101.77393691898442
curr_Factors:  [1.01773937e+02 4.02792045e-02]
mat_Sqrt:  [[ 2.04257032e+01  0.00000000e+00]
 [-8.02787190e-03  1.83941653e-02]]
grads:  [  0.03221819 -16.61198684]
Stock Position:  0.03221819324461671
Bond Position:  [8.84581286]


portfolio before change:  [12.18123453]
curr_Stock_Price:  103.45738240353425
curr_Factors:  [1.03457382e+02 4.12218805e-02]
mat_Sqrt:  [[ 2.10051306e+01  0.00000000e+00]
 [-8.12126892e-03  1.86081648e-02]]
grads:  [ 0.01659899 -3.40826544]
Stock Position:  0.016598987369519886
Bond Position:  [10.46394675]


portfolio before change:  [12.21871209]
curr_Stock_Price:  105.55758536579656
curr_Factors:  [1.05557585e+02 4.07737339e-02]
mat_Sqrt:  [[ 2.13147228e+01  0.00000000e+00]
 [-8.07700280e-03  1.85067384e-02]]
grads:  [ 0.01453369 -1.82923044]
Stock Position:  0.014533691541438713
Bond Position:  [10.6845707]


portfolio before change:  [12.21452979]
curr_Stock_Price:  105.08600655494112
curr_Factors:  [1.05086007e+02 4.09664370e-02]
mat_Sqrt:  [[ 2.12695835e+01  0.00000000e+00]
 [-8.09606689e-03  1.85504197e-02]]
grads:  [-2.72512227e-05 -1.04316649e+00]
Stock Position:  -2.72512227443334e-05
Bond Position:  [12.21739351]


portfolio before change:  [12.21762638]
curr_Stock_Price:  103.54975769567554
curr_Factors:  [1.03549758e+02 4.25651963e-02]
mat_Sqrt:  [[ 2.13636969e+01  0.00000000e+00]
 [-8.25253380e-03  1.89089304e-02]]
grads:  [-0.01739713 -7.93239907]
Stock Position:  -0.017397134038441727
Bond Position:  [14.01909539]


portfolio before change:  [12.22245906]
curr_Stock_Price:  103.47345400522907
curr_Factors:  [1.03473454e+02 4.30247501e-02]
mat_Sqrt:  [[ 2.14628863e+01  0.00000000e+00]
 [-8.29696331e-03  1.90107312e-02]]
grads:  [-0.0505522  39.41168882]
Stock Position:  -0.05055219896847938
Bond Position:  [17.45326969]


portfolio before change:  [12.18955407]
curr_Stock_Price:  104.21068898069622
curr_Factors:  [1.04210689e+02 4.30423722e-02]
mat_Sqrt:  [[ 2.16202328e+01  0.00000000e+00]
 [-8.29866228e-03  1.90146240e-02]]
grads:  [ 1.17387983e-04 -4.10801333e+00]
Stock Position:  0.00011738798325512045
Bond Position:  [12.17732099]


portfolio before change:  [12.19280829]
curr_Stock_Price:  105.9954379029425
curr_Factors:  [1.05995438e+02 4.08741497e-02]
mat_Sqrt:  [[ 2.14294754e+01  0.00000000e+00]
 [-8.08694253e-03  1.85295131e-02]]
grads:  [2.07355904e-02 3.50454066e+01]
Stock Position:  0.020735590382138375
Bond Position:  [9.99493031]


portfolio before change:  [12.20880858]
curr_Stock_Price:  106.64655239624096
curr_Factors:  [1.06646552e+02 3.84654126e-02]
mat_Sqrt:  [[ 2.09161630e+01  0.00000000e+00]
 [-7.84504048e-03  1.79752459e-02]]
grads:  [-0.02819038 -6.67988663]
Stock Position:  -0.028190383680573253
Bond Position:  [15.21521581]


portfolio before change:  [12.16975015]
curr_Stock_Price:  108.16702497188197
curr_Factors:  [1.08167025e+02 3.77353609e-02]
mat_Sqrt:  [[ 2.10120845e+01  0.00000000e+00]
 [-7.77023664e-03  1.78038488e-02]]
grads:  [-4.07407033e-03 -5.74865957e+00]
Stock Position:  -0.0040740703314854545
Bond Position:  [12.61043022]


portfolio before change:  [12.18158085]
curr_Stock_Price:  106.03704325389621
curr_Factors:  [1.06037043e+02 3.87843479e-02]
mat_Sqrt:  [[ 2.08826619e+01  0.00000000e+00]
 [-7.87749685e-03  1.80496128e-02]]
grads:  [-2.66670976e-03 -4.40195836e+00]
Stock Position:  -0.0026667097581105884
Bond Position:  [12.46435087]


portfolio before change:  [12.18297069]
curr_Stock_Price:  106.68452324616123
curr_Factors:  [1.06684523e+02 3.91940157e-02]
mat_Sqrt:  [[ 2.11208456e+01  0.00000000e+00]
 [-7.91899142e-03  1.81446888e-02]]
grads:  [7.20790941e-03 8.18851681e+00]
Stock Position:  0.00720790940565636
Bond Position:  [11.41399831]


portfolio before change:  [12.17471419]
curr_Stock_Price:  105.14311142168219
curr_Factors:  [1.05143111e+02 4.08038853e-02]
mat_Sqrt:  [[ 2.12388786e+01  0.00000000e+00]
 [-8.07998864e-03  1.85135798e-02]]
grads:  [-0.00670758 -3.32297189]
Stock Position:  -0.006707578586012397
Bond Position:  [12.87996987]


portfolio before change:  [12.18791756]
curr_Stock_Price:  103.65479730064436
curr_Factors:  [1.03654797e+02 4.07869826e-02]
mat_Sqrt:  [[ 2.09339024e+01  0.00000000e+00]
 [-8.07831493e-03  1.85097448e-02]]
grads:  [-0.00754294 -5.99404209]
Stock Position:  -0.0075429360396393474
Bond Position:  [12.96977907]


portfolio before change:  [12.18308303]
curr_Stock_Price:  104.72565186318799
curr_Factors:  [1.04725652e+02 3.97084969e-02]
mat_Sqrt:  [[ 2.08686712e+01  0.00000000e+00]
 [-7.97079639e-03  1.82633889e-02]]
grads:  [-1.92546941e-02 -3.21146741e+01]
Stock Position:  -0.019254694145396222
Bond Position:  [14.19954342]


portfolio before change:  [12.17609102]
curr_Stock_Price:  105.27317238194559
curr_Factors:  [1.05273172e+02 3.94099875e-02]
mat_Sqrt:  [[ 2.08987764e+01  0.00000000e+00]
 [-7.94077956e-03  1.81946117e-02]]
grads:  [-0.01334914 -1.03183483]
Stock Position:  -0.013349135458613952
Bond Position:  [13.58139685]


portfolio before change:  [12.17626852]
curr_Stock_Price:  105.51425668506378
curr_Factors:  [1.05514257e+02 4.08305429e-02]
mat_Sqrt:  [[ 2.13208110e+01  0.00000000e+00]
 [-8.08262758e-03  1.85196263e-02]]
grads:  [ 0.00587705 -1.12018239]
Stock Position:  0.005877048751636872
Bond Position:  [11.55615609]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.16820494]
Stock Price:  103.65056938172937
PL:  [8.51763556]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.17987326e-02  2.36361562e-02]
 [ 5.01947475e-02 -4.52347051e-02]
 [ 5.97446045e-01 -2.46356522e-01]
 [ 1.33122189e-02  5.93414243e-02]
 [ 3.19309552e-01 -1.20253239e-02]
 [-3.58942361e-01 -3.70541512e-01]
 [-1.22606320e-01 -8.71357375e-02]
 [-1.37538303e+00  5.84614488e-01]
 [ 1.26940176e-02  3.66910226e-02]
 [ 2.66793412e-02 -3.29910443e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 1.14785357e-01 -1.44296907e-01]
 [ 9.68050075e-02 -9.21978641e-03]
 [-8.90420208e-02 -1.32042327e-01]
 [ 1.32209973e-01  1.92500819e-01]
 [-3.12180341e-02 -1.00124231e-01]
 [-2.04989996e-01 -1.87608620e-01]
 [ 6.15815455e-01 -5.95663540e-01]
 [-4.69923466e-01 -2.45572078e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.03979516]
curr_Stock_Price:  101.26753083522392
curr_Factors:  [1.01267531e+02 3.87595280e-02]
mat_Sqrt:  [[ 1.99369840e+01  0.00000000e+00]
 [-7.87497586e-03  1.80438365e-02]]
grads:  [1.10921476e-03 1.30992964e+00]
Stock Position:  0.0011092147578820432
Bond Position:  [10.92746772]


portfolio before change:  [11.04006597]
curr_Stock_Price:  99.04848465678229
curr_Factors:  [9.90484847e+01 4.08269853e-02]
mat_Sqrt:  [[ 2.00134284e+01  0.00000000e+00]
 [-8.08227545e-03  1.85188195e-02]]
grads:  [ 1.52161354e-03 -2.44263437e+00]
Stock Position:  0.00152161354063732
Bond Position:  [10.88935246]


portfolio before change:  [11.04214318]
curr_Stock_Price:  98.62428225331219
curr_Factors:  [9.86242823e+01 3.96635409e-02]
mat_Sqrt:  [[ 1.96417237e+01  0.00000000e+00]
 [-7.96628304e-03  1.82530475e-02]]
grads:  [  0.02494319 -13.49673373]
Stock Position:  0.0249431899100392
Bond Position:  [8.58213898]


portfolio before change:  [10.93710921]
curr_Stock_Price:  94.32732720855795
curr_Factors:  [9.43273272e+01 4.14215814e-02]
mat_Sqrt:  [[ 1.91977736e+01  0.00000000e+00]
 [-8.14091704e-03  1.86531843e-02]]
grads:  [2.04247328e-03 3.18130264e+00]
Stock Position:  0.002042473280581944
Bond Position:  [10.74444817]


portfolio before change:  [10.9445335]
curr_Stock_Price:  96.6469860502724
curr_Factors:  [9.66469861e+01 4.07963202e-02]
mat_Sqrt:  [[ 1.95208539e+01  0.00000000e+00]
 [-8.07923959e-03  1.85118635e-02]]
grads:  [ 0.0160885  -0.64960094]
Stock Position:  0.016088500622997038
Bond Position:  [9.38962841]


portfolio before change:  [10.92048093]
curr_Stock_Price:  95.0060451291956
curr_Factors:  [9.50060451e+01 4.08812560e-02]
mat_Sqrt:  [[ 1.92093803e+01  0.00000000e+00]
 [-8.08764549e-03  1.85311238e-02]]
grads:  [ -0.02710446 -19.99563089]
Stock Position:  -0.027104462856438864
Bond Position:  [13.49556875]


portfolio before change:  [10.97599811]
curr_Stock_Price:  93.08227081656398
curr_Factors:  [9.30822708e+01 4.22653094e-02]
mat_Sqrt:  [[ 1.91363452e+01  0.00000000e+00]
 [-8.22341140e-03  1.88422026e-02]]
grads:  [-0.00839426 -4.62449849]
Stock Position:  -0.008394260888242076
Bond Position:  [11.75735497]


portfolio before change:  [10.97442476]
curr_Stock_Price:  93.61990709444234
curr_Factors:  [9.36199071e+01 4.04988397e-02]
mat_Sqrt:  [[ 1.88403730e+01  0.00000000e+00]
 [-8.04972940e-03  1.84442472e-02]]
grads:  [-0.05945935 31.69630528]
Stock Position:  -0.0594593510005352
Bond Position:  [16.54100367]


portfolio before change:  [10.97440813]
curr_Stock_Price:  93.6897429659923
curr_Factors:  [9.36897430e+01 3.93926046e-02]
mat_Sqrt:  [[ 1.85951376e+01  0.00000000e+00]
 [-7.93902811e-03  1.81905986e-02]]
grads:  [1.54380642e-03 2.01703217e+00]
Stock Position:  0.0015438064160301936
Bond Position:  [10.8297693]


portfolio before change:  [10.97437228]
curr_Stock_Price:  91.91255998759631
curr_Factors:  [9.19125600e+01 3.90456372e-02]
mat_Sqrt:  [[ 1.81618933e+01  0.00000000e+00]
 [-7.90398757e-03  1.81103107e-02]]
grads:  [ 6.76188808e-04 -1.82167192e+00]
Stock Position:  0.0006761888083555213
Bond Position:  [10.91222204]


portfolio before change:  [10.97779089]
curr_Stock_Price:  92.93330351236412
curr_Factors:  [9.29333035e+01 3.95674651e-02]
mat_Sqrt:  [[ 1.84858953e+01  0.00000000e+00]
 [-7.95662895e-03  1.82309272e-02]]
grads:  [1.46005588e-02 1.91744936e+01]
Stock Position:  0.01460055876690066
Bond Position:  [9.62091273]


portfolio before change:  [10.97900394]
curr_Stock_Price:  92.8516295424718
curr_Factors:  [9.28516295e+01 3.82362541e-02]
mat_Sqrt:  [[ 1.81562937e+01  0.00000000e+00]
 [-7.82163708e-03  1.79216220e-02]]
grads:  [ 2.8535022e-03 -8.0515540e+00]
Stock Position:  0.0028535021957637094
Bond Position:  [10.71405161]


portfolio before change:  [10.98463105]
curr_Stock_Price:  93.88484005634167
curr_Factors:  [9.38848401e+01 3.72979376e-02]
mat_Sqrt:  [[ 1.81316731e+01  0.00000000e+00]
 [-7.72506959e-03  1.77003581e-02]]
grads:  [ 0.00511708 -0.52088135]
Stock Position:  0.005117076750808265
Bond Position:  [10.50421512]


portfolio before change:  [10.9889466]
curr_Stock_Price:  94.21494356489494
curr_Factors:  [9.42149436e+01 3.63631137e-02]
mat_Sqrt:  [[ 1.79659557e+01  0.00000000e+00]
 [-7.62764589e-03  1.74771323e-02]]
grads:  [-0.00816377 -7.55514831]
Stock Position:  -0.008163774830697693
Bond Position:  [11.75809619]


portfolio before change:  [11.00212757]
curr_Stock_Price:  92.96048979215303
curr_Factors:  [9.29604898e+01 3.74897209e-02]
mat_Sqrt:  [[ 1.79992540e+01  0.00000000e+00]
 [-7.74490500e-03  1.77458067e-02]]
grads:  [ 0.01201295 10.84767923]
Stock Position:  0.012012954420053503
Bond Position:  [9.88539744]


portfolio before change:  [10.99756097]
curr_Stock_Price:  92.37460065260252
curr_Factors:  [9.23746007e+01 3.80629473e-02]
mat_Sqrt:  [[ 1.80220330e+01  0.00000000e+00]
 [-7.80389106e-03  1.78809607e-02]]
grads:  [-4.15690233e-03 -5.59948833e+00]
Stock Position:  -0.004156902332119203
Bond Position:  [11.38155316]


portfolio before change:  [11.01053837]
curr_Stock_Price:  89.93729195269529
curr_Factors:  [8.99372920e+01 4.01312119e-02]
mat_Sqrt:  [[ 1.80169363e+01  0.00000000e+00]
 [-8.01311044e-03  1.83603426e-02]]
grads:  [ -0.01592219 -10.21814377]
Stock Position:  -0.015922191504886538
Bond Position:  [12.44253715]


portfolio before change:  [11.04344759]
curr_Stock_Price:  88.0658036358614
curr_Factors:  [8.80658036e+01 4.07244212e-02]
mat_Sqrt:  [[ 1.77719369e+01  0.00000000e+00]
 [-8.07211706e-03  1.84955437e-02]]
grads:  [ 2.00229482e-02 -3.22057869e+01]
Stock Position:  0.02002294823993666
Bond Position:  [9.28011056]


portfolio before change:  [11.04798187]
curr_Stock_Price:  88.17637493493314
curr_Factors:  [8.81763749e+01 4.00332404e-02]
mat_Sqrt:  [[ 1.76426010e+01  0.00000000e+00]
 [-8.00332335e-03  1.83379175e-02]]
grads:  [ -0.03271059 -13.39149212]
Stock Position:  -0.03271059111415976
Bond Position:  [13.93228321]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.03865852]
Stock Price:  88.56789486099271
PL:  [11.03865852]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.16583026e-02  2.34634736e-02]
 [-1.08334608e-02  3.99317500e-02]
 [ 8.35562870e-01 -3.19030659e-01]
 [ 3.14250620e-01 -8.27856990e-02]
 [ 1.22154380e-01 -2.41723636e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-6.56825306e-01 -4.49226328e-02]
 [-1.59895523e+00  5.95218175e-01]
 [-2.02934903e-03 -6.44231045e-02]
 [ 1.81292137e-01  8.29731184e-01]
 [-7.32299656e-01 -1.90642008e-01]
 [-4.13455948e-02 -1.68329468e-01]
 [-1.22204219e-01 -1.53537127e-01]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.11643407e-01 -5.92677883e-02]
 [ 2.53721025e-01  1.75526830e-01]
 [ 2.10633544e-02 -7.69357605e-01]
 [-3.76087441e-01  1.92375772e-01]
 [-2.49781996e-01 -9.54485145e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.1590992]
curr_Stock_Price:  101.28550090923017
curr_Factors:  [1.01285501e+02 3.95245370e-02]
mat_Sqrt:  [[ 2.01363465e+01  0.00000000e+00]
 [-7.95231157e-03  1.82210348e-02]]
grads:  [1.08751615e-03 1.28771356e+00]
Stock Position:  0.0010875161475382429
Bond Position:  [11.04894958]


portfolio before change:  [11.16242896]
curr_Stock_Price:  101.80703683506921
curr_Factors:  [1.01807037e+02 4.09268457e-02]
mat_Sqrt:  [[ 2.05959550e+01  0.00000000e+00]
 [-8.09215380e-03  1.85414537e-02]]
grads:  [3.20168870e-04 2.15364721e+00]
Stock Position:  0.0003201688704449468
Bond Position:  [11.12983352]


portfolio before change:  [11.16546305]
curr_Stock_Price:  102.59186537484429
curr_Factors:  [1.02591865e+02 4.01370557e-02]
mat_Sqrt:  [[ 2.05534950e+01  0.00000000e+00]
 [-8.01369385e-03  1.83616793e-02]]
grads:  [  0.03387874 -17.37480831]
Stock Position:  0.03387873815313559
Bond Position:  [7.6897801]


portfolio before change:  [11.16941779]
curr_Stock_Price:  102.65184557919973
curr_Factors:  [1.02651846e+02 4.06193807e-02]
mat_Sqrt:  [[ 2.06887099e+01  0.00000000e+00]
 [-8.06170014e-03  1.84716756e-02]]
grads:  [ 0.01344308 -4.48176446]
Stock Position:  0.013443079812911771
Bond Position:  [9.78946083]


portfolio before change:  [11.16762067]
curr_Stock_Price:  102.3360857248344
curr_Factors:  [1.02336086e+02 4.37016914e-02]
mat_Sqrt:  [[ 2.13933071e+01  0.00000000e+00]
 [-8.36197980e-03  1.91597027e-02]]
grads:  [ 0.0052168  -1.26162519]
Stock Position:  0.0052168042555543375
Bond Position:  [10.63375334]


portfolio before change:  [11.17669649]
curr_Stock_Price:  103.56615873778172
curr_Factors:  [1.03566159e+02 4.23568749e-02]
mat_Sqrt:  [[ 2.13147294e+01  0.00000000e+00]
 [-8.23231437e-03  1.88626019e-02]]
grads:  [-2.71935029e-05 -1.02590174e+00]
Stock Position:  -2.719350291948e-05
Bond Position:  [11.17951282]


portfolio before change:  [11.17940177]
curr_Stock_Price:  106.87405017347035
curr_Factors:  [1.06874050e+02 4.19438849e-02]
mat_Sqrt:  [[ 2.18880259e+01  0.00000000e+00]
 [-8.19208251e-03  1.87704191e-02]]
grads:  [-0.03090416 -2.39326744]
Stock Position:  -0.030904164334453234
Bond Position:  [14.48225498]


portfolio before change:  [11.09530618]
curr_Stock_Price:  109.71239266439935
curr_Factors:  [1.09712393e+02 4.39688987e-02]
mat_Sqrt:  [[ 2.30053307e+01  0.00000000e+00]
 [-8.38750487e-03  1.92181880e-02]]
grads:  [-0.05821176 30.97160751]
Stock Position:  -0.05821175715144438
Bond Position:  [17.48185734]


portfolio before change:  [11.1971867]
curr_Stock_Price:  108.03730989465406
curr_Factors:  [1.08037310e+02 4.37325423e-02]
mat_Sqrt:  [[ 2.25931156e+01  0.00000000e+00]
 [-8.36493082e-03  1.91664643e-02]]
grads:  [-1.33429570e-03 -3.36124093e+00]
Stock Position:  -0.0013342956973573048
Bond Position:  [11.34134042]


portfolio before change:  [11.20071502]
curr_Stock_Price:  107.51821348126194
curr_Factors:  [1.07518213e+02 4.26734500e-02]
mat_Sqrt:  [[ 2.22106320e+01  0.00000000e+00]
 [-8.26302124e-03  1.89329601e-02]]
grads:  [2.44665038e-02 4.38246939e+01]
Stock Position:  0.02446650382949863
Bond Position:  [8.57012024]


portfolio before change:  [11.24283525]
curr_Stock_Price:  109.15217923480562
curr_Factors:  [1.09152179e+02 4.22819076e-02]
mat_Sqrt:  [[ 2.24444877e+01  0.00000000e+00]
 [-8.22502597e-03  1.88459020e-02]]
grads:  [ -0.03633421 -10.11583353]
Stock Position:  -0.036334206411915954
Bond Position:  [15.20879306]


portfolio before change:  [11.20571514]
curr_Stock_Price:  110.27846711476194
curr_Factors:  [1.10278467e+02 4.29145904e-02]
mat_Sqrt:  [[ 2.28451075e+01  0.00000000e+00]
 [-8.28633481e-03  1.89863783e-02]]
grads:  [-5.02560985e-03 -8.86580186e+00]
Stock Position:  -0.005025609848469863
Bond Position:  [11.7599317]


portfolio before change:  [11.20190814]
curr_Stock_Price:  111.62106058932109
curr_Factors:  [1.11621061e+02 4.14333298e-02]
mat_Sqrt:  [[ 2.27206663e+01  0.00000000e+00]
 [-8.14207146e-03  1.86558294e-02]]
grads:  [-0.00832781 -8.22998128]
Stock Position:  -0.008327806605176527
Bond Position:  [12.13146675]


portfolio before change:  [11.17572246]
curr_Stock_Price:  115.12965866874315
curr_Factors:  [1.15129659e+02 4.11257037e-02]
mat_Sqrt:  [[ 2.33476884e+01  0.00000000e+00]
 [-8.11178932e-03  1.85864443e-02]]
grads:  [6.52043745e-03 7.99389529e+00]
Stock Position:  0.006520437454759985
Bond Position:  [10.42502673]


portfolio before change:  [11.1732194]
curr_Stock_Price:  114.34602332696454
curr_Factors:  [1.14346023e+02 4.03989864e-02]
mat_Sqrt:  [[ 2.29829779e+01  0.00000000e+00]
 [-8.03979964e-03  1.84214952e-02]]
grads:  [-0.00598312 -3.21731692]
Stock Position:  -0.005983123274597583
Bond Position:  [11.85736575]


portfolio before change:  [11.17340722]
curr_Stock_Price:  114.81014389449646
curr_Factors:  [1.14810144e+02 4.16915935e-02]
mat_Sqrt:  [[ 2.34425315e+01  0.00000000e+00]
 [-8.16740777e-03  1.87138822e-02]]
grads:  [0.01409094 9.37949852]
Stock Position:  0.014090936123352358
Bond Position:  [9.55562482]


portfolio before change:  [11.17187749]
curr_Stock_Price:  114.53202639863986
curr_Factors:  [1.14532026e+02 4.16934484e-02]
mat_Sqrt:  [[ 2.33862643e+01  0.00000000e+00]
 [-8.16758945e-03  1.87142984e-02]]
grads:  [-1.34571229e-02 -4.11106837e+01]
Stock Position:  -0.013457122897228061
Bond Position:  [12.71314905]


portfolio before change:  [11.17551426]
curr_Stock_Price:  114.497986366394
curr_Factors:  [1.14497986e+02 4.18387859e-02]
mat_Sqrt:  [[ 2.34200267e+01  0.00000000e+00]
 [-8.18181260e-03  1.87468878e-02]]
grads:  [-0.01247342 10.2617445 ]
Stock Position:  -0.012473417492913896
Bond Position:  [12.60369544]


portfolio before change:  [11.17875696]
curr_Stock_Price:  114.49065985665622
curr_Factors:  [1.14490660e+02 4.17606147e-02]
mat_Sqrt:  [[ 2.33966404e+01  0.00000000e+00]
 [-8.17416562e-03  1.87293663e-02]]
grads:  [-0.01245645 -5.09619561]
Stock Position:  -0.012456452629820907
Bond Position:  [12.60490444]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.16837639]
Stock Price:  115.57702011990088
PL:  [-4.40864373]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.08461769e-02  1.10226890e-01]
 [ 5.35666995e-02 -4.01676271e-02]
 [ 7.07471256e-01 -2.79936624e-01]
 [ 3.37211369e-01 -7.56251970e-02]
 [ 1.39835930e-01 -2.54410253e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-8.84703806e-02 -1.65706195e-01]
 [-1.39470591e+00  7.48639750e-01]
 [ 8.15456739e-02 -7.52164564e-02]
 [ 8.80797496e-02  1.75590722e-01]
 [-1.65994618e-01 -4.95874521e-02]
 [ 3.48242209e-02 -8.85265919e-03]
 [ 7.31942335e-02 -2.59827962e-02]
 [ 2.94676700e-02  5.04100977e-02]
 [-8.66815498e-02 -3.88525316e-02]
 [-1.41397708e-01 -1.30347163e-01]
 [-1.72116888e-01 -4.82578257e-01]
 [ 2.18547772e-01 -2.21001661e-01]
 [ 8.46597178e-02 -9.77318519e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.98595266]
curr_Stock_Price:  100.2050515393085
curr_Factors:  [1.00205052e+02 3.69676051e-02]
mat_Sqrt:  [[ 1.92663868e+01  0.00000000e+00]
 [-7.69078463e-03  1.76218014e-02]]
grads:  [4.09797316e-03 6.25514317e+00]
Stock Position:  0.004097973163410132
Bond Position:  [3.57531505]


portfolio before change:  [3.98385332]
curr_Stock_Price:  99.47462299559385
curr_Factors:  [9.94746230e+01 3.71968165e-02]
mat_Sqrt:  [[ 1.91851495e+01  0.00000000e+00]
 [-7.71459048e-03  1.76763474e-02]]
grads:  [ 1.87833354e-03 -2.27239407e+00]
Stock Position:  0.0018783335406808853
Bond Position:  [3.7970068]


portfolio before change:  [3.98745646]
curr_Stock_Price:  100.88745621744724
curr_Factors:  [1.00887456e+02 3.54943307e-02]
mat_Sqrt:  [[ 1.90071353e+01  0.00000000e+00]
 [-7.53597565e-03  1.72670894e-02]]
grads:  [  0.03079354 -16.21214883]
Stock Position:  0.030793535501596938
Bond Position:  [0.880775]


portfolio before change:  [4.05108751]
curr_Stock_Price:  102.94668150753107
curr_Factors:  [1.02946682e+02 3.52798588e-02]
mat_Sqrt:  [[ 1.93364066e+01  0.00000000e+00]
 [-7.51317337e-03  1.72148428e-02]]
grads:  [ 0.01573228 -4.3930228 ]
Stock Position:  0.01573228331376145
Bond Position:  [2.43150115]


portfolio before change:  [4.0454849]
curr_Stock_Price:  102.55191593629749
curr_Factors:  [1.02551916e+02 3.42520673e-02]
mat_Sqrt:  [[ 1.89796051e+01  0.00000000e+00]
 [-7.40292562e-03  1.69622335e-02]]
grads:  [ 0.00678268 -1.49986293]
Stock Position:  0.0067826782924612725
Bond Position:  [3.34990825]


portfolio before change:  [4.04977255]
curr_Stock_Price:  103.06057386368646
curr_Factors:  [1.03060574e+02 3.46928807e-02]
mat_Sqrt:  [[ 1.91960883e+01  0.00000000e+00]
 [-7.45041000e-03  1.70710339e-02]]
grads:  [-3.01948058e-05 -1.13356790e+00]
Stock Position:  -3.0194805785202325e-05
Bond Position:  [4.05288444]


portfolio before change:  [4.05084495]
curr_Stock_Price:  101.10484307498417
curr_Factors:  [1.01104843e+02 3.64908310e-02]
mat_Sqrt:  [[ 1.93136269e+01  0.00000000e+00]
 [-7.64102936e-03  1.75077977e-02]]
grads:  [-8.32523556e-03 -9.46470809e+00]
Stock Position:  -0.008325235556659821
Bond Position:  [4.89256658]


portfolio before change:  [4.03780775]
curr_Stock_Price:  102.817766764513
curr_Factors:  [1.02817767e+02 3.38653930e-02]
mat_Sqrt:  [[ 1.89210933e+01  0.00000000e+00]
 [-7.36102091e-03  1.68662178e-02]]
grads:  [-0.0564435  44.38693731]
Stock Position:  -0.05644350067720586
Bond Position:  [9.84120244]


portfolio before change:  [4.1704034]
curr_Stock_Price:  100.51218602024919
curr_Factors:  [1.00512186e+02 3.60856828e-02]
mat_Sqrt:  [[ 1.90935280e+01  0.00000000e+00]
 [-7.59849278e-03  1.74103342e-02]]
grads:  [ 2.5515725e-03 -4.3202190e+00]
Stock Position:  0.002551572504690467
Bond Position:  [3.91393927]


portfolio before change:  [4.17369348]
curr_Stock_Price:  101.41808386206579
curr_Factors:  [1.01418084e+02 3.46711589e-02]
mat_Sqrt:  [[ 1.88842430e+01  0.00000000e+00]
 [-7.44807722e-03  1.70656888e-02]]
grads:  [8.72228892e-03 1.02891084e+01]
Stock Position:  0.008722288920558648
Bond Position:  [3.28909565]


portfolio before change:  [4.17816661]
curr_Stock_Price:  101.83663926358152
curr_Factors:  [1.01836639e+02 3.50221282e-02]
mat_Sqrt:  [[ 1.90579124e+01  0.00000000e+00]
 [-7.48568001e-03  1.71518476e-02]]
grads:  [-0.00984559 -2.89108516]
Stock Position:  -0.009845588152817955
Bond Position:  [5.18080822]


portfolio before change:  [4.20033794]
curr_Stock_Price:  99.71630259060852
curr_Factors:  [9.97163026e+01 3.60923998e-02]
mat_Sqrt:  [[ 1.89441030e+01  0.00000000e+00]
 [-7.59919993e-03  1.74119545e-02]]
grads:  [ 0.00163431 -0.50842421]
Stock Position:  0.0016343135184426958
Bond Position:  [4.03737024]


portfolio before change:  [4.20535582]
curr_Stock_Price:  102.16895901769715
curr_Factors:  [1.02168959e+02 3.63108698e-02]
mat_Sqrt:  [[ 1.94687153e+01  0.00000000e+00]
 [-7.62216450e-03  1.74645729e-02]]
grads:  [ 0.00317712 -1.487743  ]
Stock Position:  0.003177118290339629
Bond Position:  [3.88075295]


portfolio before change:  [4.19906571]
curr_Stock_Price:  99.88373732217934
curr_Factors:  [9.98837373e+01 3.63507202e-02]
mat_Sqrt:  [[ 1.90436983e+01  0.00000000e+00]
 [-7.62634593e-03  1.74741538e-02]]
grads:  [2.70264942e-03 2.88483771e+00]
Stock Position:  0.00270264942225001
Bond Position:  [3.92911498]


portfolio before change:  [4.19926267]
curr_Stock_Price:  99.59311922425591
curr_Factors:  [9.95931192e+01 3.84372455e-02]
mat_Sqrt:  [[ 1.95256483e+01  0.00000000e+00]
 [-7.84216761e-03  1.79686633e-02]]
grads:  [-0.0053078  -2.16223827]
Stock Position:  -0.00530779735958214
Bond Position:  [4.72788276]


portfolio before change:  [4.19522063]
curr_Stock_Price:  100.57736051554944
curr_Factors:  [1.00577361e+02 3.72894834e-02]
mat_Sqrt:  [[ 1.94219762e+01  0.00000000e+00]
 [-7.72419403e-03  1.76983519e-02]]
grads:  [-0.01020936 -7.36493226]
Stock Position:  -0.01020935624356798
Bond Position:  [5.22205074]


portfolio before change:  [4.19073375]
curr_Stock_Price:  101.14473815713245
curr_Factors:  [1.01144738e+02 4.00256130e-02]
mat_Sqrt:  [[ 2.02354231e+01  0.00000000e+00]
 [-8.00256089e-03  1.83361705e-02]]
grads:  [-1.89139265e-02 -2.63183775e+01]
Stock Position:  -0.01891392650882425
Bond Position:  [6.10377789]


portfolio before change:  [4.19282618]
curr_Stock_Price:  101.1147975708484
curr_Factors:  [1.01114798e+02 4.00837538e-02]
mat_Sqrt:  [[ 2.02441203e+01  0.00000000e+00]
 [-8.00837100e-03  1.83494832e-02]]
grads:  [ 6.03112102e-03 -1.20440265e+01]
Stock Position:  0.006031121024078535
Bond Position:  [3.5829906]


portfolio before change:  [4.19087228]
curr_Stock_Price:  100.64228937144911
curr_Factors:  [1.00642289e+02 3.94219704e-02]
mat_Sqrt:  [[ 1.99824931e+01  0.00000000e+00]
 [-7.94198669e-03  1.81973776e-02]]
grads:  [ 2.10214214e-03 -5.37065583e+00]
Stock Position:  0.0021021421389404603
Bond Position:  [3.97930789]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.19547353]
Stock Price:  102.35782148538887
PL:  [1.83765204]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.60426119e-03  1.23299896e-02]
 [-1.73846624e-01  1.40198186e-01]
 [ 8.53927285e-01 -3.24635546e-01]
 [ 4.06397975e-01 -5.40487744e-02]
 [ 3.22292997e-01 -3.37616561e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-2.04737277e-01 -1.82868280e-01]
 [-1.35644511e+00  7.45181499e-01]
 [ 7.35003394e-02 -7.67306935e-02]
 [ 3.39886779e-02 -5.53532333e-02]
 [-1.84453400e-02  6.68755410e-02]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.54371776e-01 -3.03856858e-02]
 [-3.44502372e-02 -2.86685162e-02]
 [-2.50835114e-02 -1.55581376e-02]
 [-1.43178243e-01 -1.38342658e-01]
 [-1.88866993e-01 -3.99986403e-01]
 [ 2.74533367e-01 -2.35148731e-01]
 [ 1.13387114e-01 -3.80831272e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.84344581]
curr_Stock_Price:  102.44294937400214
curr_Factors:  [1.02442949e+02 3.83535689e-02]
mat_Sqrt:  [[ 2.00624961e+01  0.00000000e+00]
 [-7.83362689e-03  1.79490941e-02]]
grads:  [3.98031721e-04 6.86942169e-01]
Stock Position:  0.0003980317206636585
Bond Position:  [18.80267027]


portfolio before change:  [18.84825677]
curr_Stock_Price:  102.71855493990937
curr_Factors:  [1.02718555e+02 3.64720937e-02]
mat_Sqrt:  [[ 1.96168490e+01  0.00000000e+00]
 [-7.63906734e-03  1.75033022e-02]]
grads:  [-5.74297737e-03  8.00981347e+00]
Stock Position:  -0.00574297737456823
Bond Position:  [19.4381671]


portfolio before change:  [18.84942305]
curr_Stock_Price:  103.3617519496669
curr_Factors:  [1.03361752e+02 3.51347500e-02]
mat_Sqrt:  [[ 1.93744015e+01  0.00000000e+00]
 [-7.49770632e-03  1.71794034e-02]]
grads:  [  0.03676215 -18.89678814]
Stock Position:  0.03676215322033685
Bond Position:  [15.04962249]


portfolio before change:  [18.87091866]
curr_Stock_Price:  103.84411569797716
curr_Factors:  [1.03844116e+02 3.57083947e-02]
mat_Sqrt:  [[ 1.96230746e+01  0.00000000e+00]
 [-7.55866599e-03  1.73190795e-02]]
grads:  [ 0.01950811 -3.12076484]
Stock Position:  0.019508112926050862
Bond Position:  [16.84511592]


portfolio before change:  [18.90785697]
curr_Stock_Price:  105.52170006825155
curr_Factors:  [1.05521700e+02 3.54382153e-02]
mat_Sqrt:  [[ 1.98645029e+01  0.00000000e+00]
 [-7.53001623e-03  1.72534347e-02]]
grads:  [ 0.0154828  -1.95680783]
Stock Position:  0.015482803902259926
Bond Position:  [17.27408518]


portfolio before change:  [18.87806162]
curr_Stock_Price:  103.31832619612337
curr_Factors:  [1.03318326e+02 3.42523408e-02]
mat_Sqrt:  [[ 1.91215234e+01  0.00000000e+00]
 [-7.40295518e-03  1.69623012e-02]]
grads:  [-3.03125511e-05 -1.14083436e+00]
Stock Position:  -3.0312551109167237e-05
Bond Position:  [18.88119346]


portfolio before change:  [18.88280479]
curr_Stock_Price:  102.58315927272628
curr_Factors:  [1.02583159e+02 3.45835848e-02]
mat_Sqrt:  [[ 1.90770437e+01  0.00000000e+00]
 [-7.43866491e-03  1.70441225e-02]]
grads:  [ -0.0149157  -10.72911086]
Stock Position:  -0.014915704049873982
Bond Position:  [20.41290484]


portfolio before change:  [18.89973707]
curr_Stock_Price:  101.79014193853585
curr_Factors:  [1.01790142e+02 3.34208751e-02]
mat_Sqrt:  [[ 1.86086398e+01  0.00000000e+00]
 [-7.31255086e-03  1.67551589e-02]]
grads:  [-0.05541626 44.47474965]
Stock Position:  -0.05541626090607274
Bond Position:  [24.54056613]


portfolio before change:  [18.93466574]
curr_Stock_Price:  101.27056949441479
curr_Factors:  [1.01270569e+02 3.13176399e-02]
mat_Sqrt:  [[ 1.79216407e+01  0.00000000e+00]
 [-7.07871626e-03  1.62193765e-02]]
grads:  [ 2.23262591e-03 -4.73080413e+00]
Stock Position:  0.002232625906006663
Bond Position:  [18.70856644]


portfolio before change:  [18.93612955]
curr_Stock_Price:  99.83104425357608
curr_Factors:  [9.98310443e+01 3.21883711e-02]
mat_Sqrt:  [[ 1.79108053e+01  0.00000000e+00]
 [-7.17644715e-03  1.64433061e-02]]
grads:  [ 5.48861210e-04 -3.36630801e+00]
Stock Position:  0.0005488612101968314
Bond Position:  [18.88133616]


portfolio before change:  [18.94051443]
curr_Stock_Price:  99.21879365241396
curr_Factors:  [9.92187937e+01 3.30427452e-02]
mat_Sqrt:  [[ 1.80356585e+01  0.00000000e+00]
 [-7.27106542e-03  1.66601038e-02]]
grads:  [5.9557232e-04 4.0141131e+00]
Stock Position:  0.0005955723202265235
Bond Position:  [18.88142246]


portfolio before change:  [18.94451531]
curr_Stock_Price:  98.00976561558454
curr_Factors:  [9.80097656e+01 3.46886083e-02]
mat_Sqrt:  [[ 1.82541993e+01  0.00000000e+00]
 [-7.44995123e-03  1.70699827e-02]]
grads:  [ 0.00263043 -0.50330355]
Stock Position:  0.0026304346397640057
Bond Position:  [18.68670703]


portfolio before change:  [18.94658944]
curr_Stock_Price:  97.02204500941728
curr_Factors:  [9.70220450e+01 3.53441475e-02]
mat_Sqrt:  [[ 1.82401825e+01  0.00000000e+00]
 [-7.52001570e-03  1.72305206e-02]]
grads:  [ 0.00773624 -1.76348043]
Stock Position:  0.0077362370396085
Bond Position:  [18.1960039]


portfolio before change:  [18.96411464]
curr_Stock_Price:  98.69929808437362
curr_Factors:  [9.86992981e+01 3.37334380e-02]
mat_Sqrt:  [[ 1.81277694e+01  0.00000000e+00]
 [-7.34666597e-03  1.68333265e-02]]
grads:  [-0.00259062 -1.70308087]
Stock Position:  -0.00259062229573542
Bond Position:  [19.21980724]


portfolio before change:  [18.96864787]
curr_Stock_Price:  98.8044135476916
curr_Factors:  [9.88044135e+01 3.46520015e-02]
mat_Sqrt:  [[ 1.83924891e+01  0.00000000e+00]
 [-7.44601924e-03  1.70609734e-02]]
grads:  [-0.00173297 -0.91191383]
Stock Position:  -0.0017329704074787984
Bond Position:  [19.139873]


portfolio before change:  [18.97463006]
curr_Stock_Price:  98.11391379751221
curr_Factors:  [9.81139138e+01 3.32222235e-02]
mat_Sqrt:  [[ 1.78831882e+01  0.00000000e+00]
 [-7.29078580e-03  1.67052889e-02]]
grads:  [-0.01138253 -8.28136879]
Stock Position:  -0.011382530152484699
Bond Position:  [20.09141464]


portfolio before change:  [18.97023016]
curr_Stock_Price:  98.94179451945313
curr_Factors:  [9.89417945e+01 3.40337575e-02]
mat_Sqrt:  [[ 1.82530201e+01  0.00000000e+00]
 [-7.37929617e-03  1.69080916e-02]]
grads:  [-1.99109719e-02 -2.36565079e+01]
Stock Position:  -0.019910971908441818
Bond Position:  [20.94025745]


portfolio before change:  [18.9428126]
curr_Stock_Price:  100.58175873940846
curr_Factors:  [1.00581759e+02 3.33293802e-02]
mat_Sqrt:  [[ 1.83625438e+01  0.00000000e+00]
 [-7.30253438e-03  1.67322083e-02]]
grads:  [ 9.36177737e-03 -1.40536579e+01]
Stock Position:  0.009361777372561216
Bond Position:  [18.00118856]


portfolio before change:  [18.95626499]
curr_Stock_Price:  101.53793722325798
curr_Factors:  [1.01537937e+02 3.36822353e-02]
mat_Sqrt:  [[ 1.86349739e+01  0.00000000e+00]
 [-7.34108823e-03  1.68205463e-02]]
grads:  [ 0.00519272 -2.26408386]
Stock Position:  0.005192723939773455
Bond Position:  [18.42900651]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.9568049]
Stock Price:  100.75454968230751
PL:  [18.20225522]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.31280668e-02  2.52707986e-02]
 [ 6.41784835e-02 -5.98642769e-03]
 [ 7.13220767e-01 -2.81691396e-01]
 [-3.25721521e-02 -9.85322988e-02]
 [ 9.17529531e-02 -2.19889859e-02]
 [ 3.81722195e-02 -1.76670150e-02]
 [-7.57968408e-02 -1.46227286e-01]
 [-1.29677365e+00  7.39128004e-01]
 [ 8.38641732e-02 -6.49396290e-02]
 [ 3.01221547e-02 -6.37871792e-02]
 [ 1.36108426e-02  1.56899971e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.64165214e-01 -2.85721808e-02]
 [-5.31284027e-02 -5.26658344e-02]
 [ 5.17758908e-02  4.08382864e-02]
 [-1.43637670e-01 -1.40405712e-01]
 [-1.95418943e-01 -3.20988000e-01]
 [ 2.90624519e-01 -2.67620818e-01]
 [-8.77137846e-02 -1.47490533e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.91192298]
curr_Stock_Price:  101.09764600446395
curr_Factors:  [1.01097646e+02 4.13183258e-02]
mat_Sqrt:  [[ 2.05500272e+01  0.00000000e+00]
 [-8.13076388e-03  1.86299205e-02]]
grads:  [1.17552873e-03 1.35646304e+00]
Stock Position:  0.001175528734482681
Bond Position:  [9.79307979]


portfolio before change:  [9.91469863]
curr_Stock_Price:  101.37588279995883
curr_Factors:  [1.01375883e+02 3.99482738e-02]
mat_Sqrt:  [[ 2.02620628e+01  0.00000000e+00]
 [-7.99482571e-03  1.83184470e-02]]
grads:  [ 0.00303848 -0.32679777]
Stock Position:  0.003038476031680754
Bond Position:  [9.60667044]


portfolio before change:  [9.91455702]
curr_Stock_Price:  100.53875865362687
curr_Factors:  [1.00538759e+02 3.88480777e-02]
mat_Sqrt:  [[ 1.98161046e+01  0.00000000e+00]
 [-7.88396628e-03  1.80644361e-02]]
grads:  [  0.02978792 -15.5936999 ]
Stock Position:  0.02978792125767657
Bond Position:  [6.91971639]


portfolio before change:  [9.8839712]
curr_Stock_Price:  99.45389052745621
curr_Factors:  [9.94538905e+01 3.92390923e-02]
mat_Sqrt:  [[ 1.97006817e+01  0.00000000e+00]
 [-7.92354389e-03  1.81551198e-02]]
grads:  [-3.83617045e-03 -5.42724586e+00]
Stock Position:  -0.003836170448516368
Bond Position:  [10.26549327]


portfolio before change:  [9.87685702]
curr_Stock_Price:  101.9774668682673
curr_Factors:  [1.01977467e+02 3.78506868e-02]
mat_Sqrt:  [[ 1.98399742e+01  0.00000000e+00]
 [-7.78210119e-03  1.78310339e-02]]
grads:  [ 0.00414094 -1.23318626]
Stock Position:  0.0041409415298376715
Bond Position:  [9.4545743]


portfolio before change:  [9.87460975]
curr_Stock_Price:  100.863900525465
curr_Factors:  [1.00863901e+02 3.85393519e-02]
mat_Sqrt:  [[ 1.98010382e+01  0.00000000e+00]
 [-7.85257684e-03  1.79925139e-02]]
grads:  [ 0.00153839 -0.98190921]
Stock Position:  0.0015383891290483916
Bond Position:  [9.71944182]


portfolio before change:  [9.87602338]
curr_Stock_Price:  100.2031237937091
curr_Factors:  [1.00203124e+02 3.94655611e-02]
mat_Sqrt:  [[ 1.99062934e+01  0.00000000e+00]
 [-7.94637639e-03  1.82074356e-02]]
grads:  [-7.01364425e-03 -8.03118509e+00]
Stock Position:  -0.0070136442455343085
Bond Position:  [10.57881244]


portfolio before change:  [9.87785286]
curr_Stock_Price:  100.31940558672775
curr_Factors:  [1.00319406e+02 3.89042072e-02]
mat_Sqrt:  [[ 1.97871495e+01  0.00000000e+00]
 [-7.88965979e-03  1.80774816e-02]]
grads:  [-0.04923356 40.88666887]
Stock Position:  -0.04923355626176091
Bond Position:  [14.81693396]


portfolio before change:  [9.92605691]
curr_Stock_Price:  99.41556351012225
curr_Factors:  [9.94155635e+01 3.90025081e-02]
mat_Sqrt:  [[ 1.96336320e+01  0.00000000e+00]
 [-7.89962107e-03  1.81003058e-02]]
grads:  [ 2.82791261e-03 -3.58776420e+00]
Stock Position:  0.002827912609527077
Bond Position:  [9.64491839]


portfolio before change:  [9.9291427]
curr_Stock_Price:  99.65399266952825
curr_Factors:  [9.96539927e+01 3.97895571e-02]
mat_Sqrt:  [[ 1.98783007e+01  0.00000000e+00]
 [-7.97892796e-03  1.82820207e-02]]
grads:  [ 1.14856265e-04 -3.48906613e+00]
Stock Position:  0.00011485626463087009
Bond Position:  [9.91769681]


portfolio before change:  [9.93150042]
curr_Stock_Price:  98.5916698457626
curr_Factors:  [9.85916698e+01 3.92481180e-02]
mat_Sqrt:  [[ 1.95321316e+01  0.00000000e+00]
 [-7.92445511e-03  1.81572077e-02]]
grads:  [4.20269563e-03 8.64119494e+00]
Stock Position:  0.00420269563412475
Bond Position:  [9.51714964]


portfolio before change:  [9.93306075]
curr_Stock_Price:  98.39673417278073
curr_Factors:  [9.83967342e+01 3.82292705e-02]
mat_Sqrt:  [[ 1.92388314e+01  0.00000000e+00]
 [-7.82092276e-03  1.79199853e-02]]
grads:  [ 0.00249581 -0.47943024]
Stock Position:  0.0024958105393840997
Bond Position:  [9.68748114]


portfolio before change:  [9.93734638]
curr_Stock_Price:  99.14336643905122
curr_Factors:  [9.91433664e+01 3.81114804e-02]
mat_Sqrt:  [[ 1.93549285e+01  0.00000000e+00]
 [-7.80886475e-03  1.78923569e-02]]
grads:  [ 0.00783755 -1.59689307]
Stock Position:  0.007837553740567603
Bond Position:  [9.16030491]


portfolio before change:  [9.93275632]
curr_Stock_Price:  98.26548789819186
curr_Factors:  [9.82654879e+01 4.12033596e-02]
mat_Sqrt:  [[ 1.99465288e+01  0.00000000e+00]
 [-8.11944427e-03  1.86039840e-02]]
grads:  [-0.00381588 -2.83089012]
Stock Position:  -0.0038158848555474483
Bond Position:  [10.3077261]


portfolio before change:  [9.94065243]
curr_Stock_Price:  96.87161507029786
curr_Factors:  [9.68716151e+01 4.25387874e-02]
mat_Sqrt:  [[ 1.99797060e+01  0.00000000e+00]
 [-8.24997333e-03  1.89030636e-02]]
grads:  [0.00348349 2.1604057 ]
Stock Position:  0.0034834937078929962
Bond Position:  [9.60320077]


portfolio before change:  [9.94271255]
curr_Stock_Price:  96.77373147683383
curr_Factors:  [9.67737315e+01 4.35827043e-02]
mat_Sqrt:  [[ 2.02029400e+01  0.00000000e+00]
 [-8.35058842e-03  1.91336018e-02]]
grads:  [-0.01014287 -7.33817469]
Stock Position:  -0.010142867619395897
Bond Position:  [10.9242757]


portfolio before change:  [9.95598787]
curr_Stock_Price:  95.7341921214753
curr_Factors:  [9.57341921e+01 4.31720226e-02]
mat_Sqrt:  [[ 1.98915339e+01  0.00000000e+00]
 [-8.31115131e-03  1.90432400e-02]]
grads:  [ -0.01686695 -16.85574512]
Stock Position:  -0.01686695418534957
Bond Position:  [11.57073211]


portfolio before change:  [9.93038856]
curr_Stock_Price:  97.42343371381399
curr_Factors:  [9.74234337e+01 4.29956276e-02]
mat_Sqrt:  [[ 2.02011261e+01  0.00000000e+00]
 [-8.29415482e-03  1.90042962e-02]]
grads:  [ 8.60472915e-03 -1.40821221e+01]
Stock Position:  0.0086047291517397
Bond Position:  [9.0920863]


portfolio before change:  [9.92688735]
curr_Stock_Price:  96.7523482471108
curr_Factors:  [9.67523482e+01 4.48578068e-02]
mat_Sqrt:  [[ 2.04918200e+01  0.00000000e+00]
 [-8.47186466e-03  1.94114806e-02]]
grads:  [-7.42168976e-03 -7.59810840e+00]
Stock Position:  -0.007421689756207248
Bond Position:  [10.64495327]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.92602882]
Stock Price:  97.2266483304796
PL:  [9.92602882]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.92056620e-02  5.11630076e-02]
 [ 8.04320619e-02 -1.03277374e-02]
 [ 7.92728942e-01 -3.05957585e-01]
 [ 3.03219095e-01 -8.62259727e-02]
 [-1.87228512e-02 -1.21465619e-02]
 [ 3.88855775e-02 -3.45450950e-02]
 [-3.37960639e-01 -1.41353790e-01]
 [-1.51105736e+00  7.11860993e-01]
 [ 5.24641008e-03 -7.08400127e-02]
 [ 1.73264113e-01  7.58524680e-01]
 [-3.48493438e-01 -5.14196874e-02]
 [-5.57578309e-03 -9.70208585e-03]
 [ 9.22029459e-02 -2.02869556e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15938998e-01 -6.17057665e-02]
 [ 6.32820314e-02 -6.40857832e-03]
 [-1.24712896e-01 -6.84489567e-01]
 [-4.02551196e-01  1.03184326e-01]
 [-4.99318873e-02 -8.45822169e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.32117138]
curr_Stock_Price:  100.55679196214331
curr_Factors:  [1.00556792e+02 3.93859700e-02]
mat_Sqrt:  [[ 1.99563992e+01  0.00000000e+00]
 [-7.93835953e-03  1.81890667e-02]]
grads:  [2.08128875e-03 2.81284402e+00]
Stock Position:  0.0020812887493136148
Bond Position:  [6.11188366]


portfolio before change:  [6.32344828]
curr_Stock_Price:  100.91654009695183
curr_Factors:  [1.00916540e+02 3.76620585e-02]
mat_Sqrt:  [[ 1.95845853e+01  0.00000000e+00]
 [-7.76268598e-03  1.77865480e-02]]
grads:  [ 0.00387676 -0.58064878]
Stock Position:  0.003876756476130309
Bond Position:  [5.93221943]


portfolio before change:  [6.33002178]
curr_Stock_Price:  102.22956000958956
curr_Factors:  [1.02229560e+02 3.72608456e-02]
mat_Sqrt:  [[ 1.97334421e+01  0.00000000e+00]
 [-7.72122742e-03  1.76915546e-02]]
grads:  [  0.03340513 -17.29399099]
Stock Position:  0.03340512531741937
Bond Position:  [2.91503052]


portfolio before change:  [6.33999679]
curr_Stock_Price:  102.50634879109181
curr_Factors:  [1.02506349e+02 3.61468851e-02]
mat_Sqrt:  [[ 1.94888496e+01  0.00000000e+00]
 [-7.60493368e-03  1.74250921e-02]]
grads:  [ 0.01362764 -4.94837973]
Stock Position:  0.013627638390360814
Bond Position:  [4.94307734]


portfolio before change:  [6.31951726]
curr_Stock_Price:  100.91286231320386
curr_Factors:  [1.00912862e+02 3.98459981e-02]
mat_Sqrt:  [[ 2.01436831e+01  0.00000000e+00]
 [-7.98458496e-03  1.82949825e-02]]
grads:  [-0.00119263 -0.66392859]
Stock Position:  -0.001192634207084893
Bond Position:  [6.43986939]


portfolio before change:  [6.32178555]
curr_Stock_Price:  100.36104423818796
curr_Factors:  [1.00361044e+02 4.10053011e-02]
mat_Sqrt:  [[ 2.03228763e+01  0.00000000e+00]
 [-8.09990629e-03  1.85592168e-02]]
grads:  [ 1.17153013e-03 -1.86134444e+00]
Stock Position:  0.0011715301310239875
Bond Position:  [6.20420956]


portfolio before change:  [6.32742329]
curr_Stock_Price:  103.84921786146647
curr_Factors:  [1.03849218e+02 3.96094499e-02]
mat_Sqrt:  [[ 2.06681990e+01  0.00000000e+00]
 [-7.96084919e-03  1.82405970e-02]]
grads:  [-0.01933659 -7.74940588]
Stock Position:  -0.019336589960119933
Bond Position:  [8.33551304]


portfolio before change:  [6.28048938]
curr_Stock_Price:  106.38420736960681
curr_Factors:  [1.06384207e+02 3.99566650e-02]
mat_Sqrt:  [[ 2.12653130e+01  0.00000000e+00]
 [-7.99566533e-03  1.83203708e-02]]
grads:  [-0.05644759 38.85625468]
Stock Position:  -0.05644759418394359
Bond Position:  [12.28562194]


portfolio before change:  [6.31377487]
curr_Stock_Price:  105.84895512444733
curr_Factors:  [1.05848955e+02 4.11624747e-02]
mat_Sqrt:  [[ 2.14752048e+01  0.00000000e+00]
 [-8.11541493e-03  1.85947516e-02]]
grads:  [-1.19536491e-03 -3.80967782e+00]
Stock Position:  -0.0011953649065598534
Bond Position:  [6.440303]


portfolio before change:  [6.31410571]
curr_Stock_Price:  106.91928754950416
curr_Factors:  [1.06919288e+02 3.95316123e-02]
mat_Sqrt:  [[ 2.12582896e+01  0.00000000e+00]
 [-7.95302331e-03  1.82226657e-02]]
grads:  [2.37230479e-02 4.16253414e+01]
Stock Position:  0.023723047895746696
Bond Position:  [3.77765433]


portfolio before change:  [6.25110041]
curr_Stock_Price:  104.2236041215834
curr_Factors:  [1.04223604e+02 4.17216279e-02]
mat_Sqrt:  [[ 2.12885808e+01  0.00000000e+00]
 [-8.17034911e-03  1.87206216e-02]]
grads:  [-0.01742412 -2.74668697]
Stock Position:  -0.017424122031501132
Bond Position:  [8.06710521]


portfolio before change:  [6.26624427]
curr_Stock_Price:  103.47023317987987
curr_Factors:  [1.03470233e+02 4.24573032e-02]
mat_Sqrt:  [[ 2.13202175e+01  0.00000000e+00]
 [-8.24206801e-03  1.88849503e-02]]
grads:  [-4.60132290e-04 -5.13746963e-01]
Stock Position:  -0.0004601322902118005
Bond Position:  [6.31385427]


portfolio before change:  [6.2686029]
curr_Stock_Price:  101.77514643358919
curr_Factors:  [1.01775146e+02 4.16018775e-02]
mat_Sqrt:  [[ 2.07586067e+01  0.00000000e+00]
 [-8.15861532e-03  1.86937361e-02]]
grads:  [ 0.00401515 -1.08522745]
Stock Position:  0.004015153510535817
Bond Position:  [5.85996006]


portfolio before change:  [6.27756967]
curr_Stock_Price:  103.64346836120708
curr_Factors:  [1.03643468e+02 4.22846123e-02]
mat_Sqrt:  [[ 2.13124371e+01  0.00000000e+00]
 [-8.22528903e-03  1.88465048e-02]]
grads:  [7.14311278e-03 7.88358855e+00]
Stock Position:  0.007143112784076217
Bond Position:  [5.53723268]


portfolio before change:  [6.28423543]
curr_Stock_Price:  104.38282163822788
curr_Factors:  [1.04382822e+02 4.19918641e-02]
mat_Sqrt:  [[ 2.13900406e+01  0.00000000e+00]
 [-8.19676659e-03  1.87811517e-02]]
grads:  [-0.00667926 -3.28551558]
Stock Position:  -0.00667925811950687
Bond Position:  [6.98143524]


portfolio before change:  [6.25547235]
curr_Stock_Price:  108.95049423364459
curr_Factors:  [1.08950494e+02 4.02557068e-02]
mat_Sqrt:  [[ 2.18596363e+01  0.00000000e+00]
 [-8.02552994e-03  1.83887992e-02]]
grads:  [ 0.00276698 -0.34850445]
Stock Position:  0.002766976429916057
Bond Position:  [5.9540089]


portfolio before change:  [6.25766117]
curr_Stock_Price:  109.20352727864173
curr_Factors:  [1.09203527e+02 3.90758180e-02]
mat_Sqrt:  [[ 2.15869212e+01  0.00000000e+00]
 [-7.90704172e-03  1.81173086e-02]]
grads:  [-1.96159810e-02 -3.77809741e+01]
Stock Position:  -0.019615980977929208
Bond Position:  [8.39979548]


portfolio before change:  [6.23905428]
curr_Stock_Price:  110.25915146997397
curr_Factors:  [1.10259151e+02 3.84911529e-02]
mat_Sqrt:  [[ 2.16319219e+01  0.00000000e+00]
 [-7.84766492e-03  1.79812593e-02]]
grads:  [-0.01652733  5.73843713]
Stock Position:  -0.016527327846913766
Bond Position:  [8.06134342]


portfolio before change:  [6.24575458]
curr_Stock_Price:  109.97569854741995
curr_Factors:  [1.09975699e+02 3.83443351e-02]
mat_Sqrt:  [[ 2.15351219e+01  0.00000000e+00]
 [-7.83268384e-03  1.79469333e-02]]
grads:  [-4.03278855e-03 -4.71290641e+00]
Stock Position:  -0.004032788549590751
Bond Position:  [6.68926332]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.24776332]
Stock Price:  109.89232938417257
PL:  [-3.64456606]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.41254474e-02  2.64972477e-02]
 [ 5.40674506e-02 -2.52338007e-06]
 [ 7.49449612e-01 -2.92748573e-01]
 [-1.05218762e-01 -9.82771120e-02]
 [ 1.18578341e-01 -8.41706583e-03]
 [ 3.68774190e-02 -4.55870004e-02]
 [-6.25411559e-02 -1.27186342e-01]
 [-1.28705398e+00  7.38438927e-01]
 [ 7.55226561e-02 -7.63524359e-02]
 [ 1.08717202e-01  2.62349503e-01]
 [-5.13376420e-02 -2.40341994e-02]
 [ 2.69704487e-02 -8.97377970e-03]
 [ 1.57793869e-01 -2.99154242e-02]
 [-5.75850207e-02 -6.28762618e-02]
 [ 2.27322471e-02  8.45321706e-03]
 [-1.42258631e-01 -1.34213138e-01]
 [-1.68600346e-01 -5.02163457e-01]
 [ 2.02308664e-01 -2.20428978e-01]
 [ 5.58261570e-02 -1.10653837e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.06509395]
curr_Stock_Price:  100.97009306960847
curr_Factors:  [1.00970093e+02 3.92477115e-02]
mat_Sqrt:  [[ 2.00032207e+01  0.00000000e+00]
 [-7.92441408e-03  1.81571137e-02]]
grads:  [1.28428290e-03 1.45933149e+00]
Stock Position:  0.0012842829047499088
Bond Position:  [8.93541979]


portfolio before change:  [9.0679446]
curr_Stock_Price:  101.45013742342756
curr_Factors:  [1.01450137e+02 3.82620224e-02]
mat_Sqrt:  [[ 1.98443373e+01  0.00000000e+00]
 [-7.82427222e-03  1.79276599e-02]]
grads:  [ 0.00272452 -0.00014075]
Stock Position:  0.002724522794485252
Bond Position:  [8.79154138]


portfolio before change:  [9.06908946]
curr_Stock_Price:  101.06353722539139
curr_Factors:  [1.01063537e+02 3.97549747e-02]
mat_Sqrt:  [[ 2.01507045e+01  0.00000000e+00]
 [-7.97545983e-03  1.82740742e-02]]
grads:  [  0.03085171 -16.01988535]
Stock Position:  0.030851708363503032
Bond Position:  [5.95110668]


portfolio before change:  [9.00282416]
curr_Stock_Price:  98.8674431289244
curr_Factors:  [9.88674431e+01 3.79114608e-02]
mat_Sqrt:  [[ 1.92503470e+01  0.00000000e+00]
 [-7.78834624e-03  1.78453431e-02]]
grads:  [-0.00769391 -5.50715733]
Stock Position:  -0.007693908596773682
Bond Position:  [9.76350123]


portfolio before change:  [8.99797951]
curr_Stock_Price:  99.81440432660055
curr_Factors:  [9.98144043e+01 3.78359875e-02]
mat_Sqrt:  [[ 1.94153738e+01  0.00000000e+00]
 [-7.78058995e-03  1.78275712e-02]]
grads:  [ 0.00591824 -0.47213755]
Stock Position:  0.0059182394956733934
Bond Position:  [8.40725396]


portfolio before change:  [9.00171451]
curr_Stock_Price:  100.09031810554346
curr_Factors:  [1.00090318e+02 3.73718982e-02]
mat_Sqrt:  [[ 1.93492728e+01  0.00000000e+00]
 [-7.73272508e-03  1.77178990e-02]]
grads:  [ 8.77636127e-04 -2.57293488e+00]
Stock Position:  0.0008776361273634864
Bond Position:  [8.91387163]


portfolio before change:  [9.00348465]
curr_Stock_Price:  99.56777059920007
curr_Factors:  [9.95677706e+01 3.62426524e-02]
mat_Sqrt:  [[ 1.89552174e+01  0.00000000e+00]
 [-7.61500124e-03  1.74481598e-02]]
grads:  [-6.22782760e-03 -7.28938427e+00]
Stock Position:  -0.006227827595370944
Bond Position:  [9.62357556]


portfolio before change:  [9.00307146]
curr_Stock_Price:  100.02047821367367
curr_Factors:  [1.00020478e+02 3.70183887e-02]
mat_Sqrt:  [[ 1.92441034e+01  0.00000000e+00]
 [-7.69606536e-03  1.76339010e-02]]
grads:  [-0.05013342 41.87609568]
Stock Position:  -0.05013342486211021
Bond Position:  [14.01744059]


portfolio before change:  [8.9534164]
curr_Stock_Price:  101.08084587749158
curr_Factors:  [1.01080846e+02 3.45617957e-02]
mat_Sqrt:  [[ 1.87917409e+01  0.00000000e+00]
 [-7.43632121e-03  1.70387524e-02]]
grads:  [ 2.24565256e-03 -4.48110484e+00]
Stock Position:  0.002245652558207262
Bond Position:  [8.72642394]


portfolio before change:  [8.95877256]
curr_Stock_Price:  102.49437167905124
curr_Factors:  [1.02494372e+02 3.28071429e-02]
mat_Sqrt:  [[ 1.85645413e+01  0.00000000e+00]
 [-7.24509686e-03  1.66006024e-02]]
grads:  [1.20237774e-02 1.58036134e+01]
Stock Position:  0.012023777437401469
Bond Position:  [7.72640305]


portfolio before change:  [8.92897582]
curr_Stock_Price:  99.85555134072516
curr_Factors:  [9.98555513e+01 3.15574097e-02]
mat_Sqrt:  [[ 1.77387449e+01  0.00000000e+00]
 [-7.10576214e-03  1.62813464e-02]]
grads:  [-0.00348542 -1.47618009]
Stock Position:  -0.0034854228368699763
Bond Position:  [9.27701464]


portfolio before change:  [8.93060444]
curr_Stock_Price:  100.05378250644874
curr_Factors:  [1.00053783e+02 3.24317559e-02]
mat_Sqrt:  [[ 1.80185045e+01  0.00000000e+00]
 [-7.20352756e-03  1.65053552e-02]]
grads:  [ 0.00127946 -0.54368898]
Stock Position:  0.0012794607997550994
Bond Position:  [8.80258955]


portfolio before change:  [8.92933472]
curr_Stock_Price:  97.34119995031185
curr_Factors:  [9.73412000e+01 3.43234749e-02]
mat_Sqrt:  [[ 1.80340106e+01  0.00000000e+00]
 [-7.41063828e-03  1.69799054e-02]]
grads:  [ 0.00802582 -1.76181336]
Stock Position:  0.008025819150559915
Bond Position:  [8.14809185]


portfolio before change:  [8.93409331]
curr_Stock_Price:  97.68026899972922
curr_Factors:  [9.76802690e+01 3.37182333e-02]
mat_Sqrt:  [[ 1.79365640e+01  0.00000000e+00]
 [-7.34501009e-03  1.68295324e-02]]
grads:  [-0.0047404  -3.73606708]
Stock Position:  -0.004740399047388939
Bond Position:  [9.39713676]


portfolio before change:  [8.93567056]
curr_Stock_Price:  97.84319197754098
curr_Factors:  [9.78431920e+01 3.20482277e-02]
mat_Sqrt:  [[ 1.75159066e+01  0.00000000e+00]
 [-7.16080752e-03  1.64074713e-02]]
grads:  [0.00150843 0.51520536]
Stock Position:  0.001508430824667753
Bond Position:  [8.78808088]


portfolio before change:  [8.93972831]
curr_Stock_Price:  99.07656241582039
curr_Factors:  [9.90765624e+01 3.01460499e-02]
mat_Sqrt:  [[ 1.72022849e+01  0.00000000e+00]
 [-6.94504714e-03  1.59131021e-02]]
grads:  [-0.01167485 -8.43412787]
Stock Position:  -0.011674847130862457
Bond Position:  [10.09643203]


portfolio before change:  [8.91294108]
curr_Stock_Price:  101.5872293465105
curr_Factors:  [1.01587229e+02 2.74381289e-02]
mat_Sqrt:  [[ 1.68273746e+01  0.00000000e+00]
 [-6.62578344e-03  1.51815771e-02]]
grads:  [-2.30435499e-02 -3.30771602e+01]
Stock Position:  -0.02304354993735233
Bond Position:  [11.25387148]


portfolio before change:  [8.92320091]
curr_Stock_Price:  101.26410188960253
curr_Factors:  [1.01264102e+02 2.72699189e-02]
mat_Sqrt:  [[ 1.67223550e+01  0.00000000e+00]
 [-6.60544247e-03  1.51349701e-02]]
grads:  [ 6.34513329e-03 -1.45642163e+01]
Stock Position:  0.006345133289953693
Bond Position:  [8.28066668]


portfolio before change:  [8.91701018]
curr_Stock_Price:  99.96213580327094
curr_Factors:  [9.99621358e+01 2.88705940e-02]
mat_Sqrt:  [[ 1.69849153e+01  0.00000000e+00]
 [-6.79653959e-03  1.55728286e-02]]
grads:  [ 4.43503151e-04 -7.10557083e+00]
Stock Position:  0.00044350315128697707
Bond Position:  [8.87267666]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.91892502]
Stock Price:  99.27756346679814
PL:  [8.91892502]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.09887263e-01 -3.38845607e-02]
 [ 3.75522796e-02 -6.42327134e-02]
 [ 7.45240207e-01 -2.91463847e-01]
 [-2.92985871e-02 -9.91029770e-02]
 [-6.19452960e-03 -1.33050557e-02]
 [ 3.76478145e-02 -4.13509627e-02]
 [-9.00527279e-02 -1.68641717e-01]
 [-1.28853556e+00  7.38459183e-01]
 [ 7.88350410e-02 -5.77662834e-02]
 [ 3.20627976e-02 -5.94974953e-02]
 [-6.91397806e-02 -7.20170156e-02]
 [ 2.83607232e-02 -8.95233895e-03]
 [ 1.02743422e-01 -1.78861364e-02]
 [ 3.50959824e-02  5.73733911e-02]
 [-1.00721652e-01 -4.42025892e-02]
 [-1.42357498e-01 -1.34657101e-01]
 [-1.81094517e-01 -4.38858468e-01]
 [ 2.78794793e-01 -2.42688442e-01]
 [ 1.92861277e-02 -1.20031343e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.86987147]
curr_Stock_Price:  97.36490834941701
curr_Factors:  [9.73649083e+01 4.29721265e-02]
mat_Sqrt:  [[ 2.01834723e+01  0.00000000e+00]
 [-8.29188775e-03  1.89991016e-02]]
grads:  [ 0.00471172 -1.78348226]
Stock Position:  0.004711717927690385
Bond Position:  [-15.32862746]


portfolio before change:  [-14.87287539]
curr_Stock_Price:  97.54079328728096
curr_Factors:  [9.75407933e+01 4.35355699e-02]
mat_Sqrt:  [[ 2.03520612e+01  0.00000000e+00]
 [-8.34607164e-03  1.91232525e-02]]
grads:  [ 4.67708166e-04 -3.35888015e+00]
Stock Position:  0.0004677081661591025
Bond Position:  [-14.91849601]


portfolio before change:  [-14.875011]
curr_Stock_Price:  100.94993513057666
curr_Factors:  [1.00949935e+02 3.99989083e-02]
mat_Sqrt:  [[ 2.01897115e+01  0.00000000e+00]
 [-7.99989083e-03  1.83300526e-02]]
grads:  [  0.03061138 -15.90087345]
Stock Position:  0.03061138118376895
Bond Position:  [-17.96522794]


portfolio before change:  [-14.92464218]
curr_Stock_Price:  99.47534240093688
curr_Factors:  [9.94753424e+01 4.17954419e-02]
mat_Sqrt:  [[ 2.03366729e+01  0.00000000e+00]
 [-8.17757342e-03  1.87371746e-02]]
grads:  [-3.56747992e-03 -5.28910997e+00]
Stock Position:  -0.003567479919067239
Bond Position:  [-14.5697659]


portfolio before change:  [-14.93381893]
curr_Stock_Price:  101.02653424957256
curr_Factors:  [1.01026534e+02 4.22999370e-02]
mat_Sqrt:  [[ 2.07780753e+01  0.00000000e+00]
 [-8.22677939e-03  1.88499196e-02]]
grads:  [-5.77595943e-04 -7.05841509e-01]
Stock Position:  -0.0005775959434664716
Bond Position:  [-14.87546641]


portfolio before change:  [-14.9370569]
curr_Stock_Price:  100.19314710159921
curr_Factors:  [1.00193147e+02 4.07428629e-02]
mat_Sqrt:  [[ 2.02238479e+01  0.00000000e+00]
 [-8.07394455e-03  1.84997310e-02]]
grads:  [ 9.69191175e-04 -2.23521967e+00]
Stock Position:  0.0009691911752422192
Bond Position:  [-15.03416321]


portfolio before change:  [-14.9397216]
curr_Stock_Price:  101.32223784700288
curr_Factors:  [1.01322238e+02 3.93779580e-02]
mat_Sqrt:  [[ 2.01062634e+01  0.00000000e+00]
 [-7.93755206e-03  1.81872166e-02]]
grads:  [-8.13945404e-03 -9.27254132e+00]
Stock Position:  -0.008139454044719248
Bond Position:  [-14.1150139]


portfolio before change:  [-14.93316402]
curr_Stock_Price:  100.08299277668125
curr_Factors:  [1.00082993e+02 3.80992481e-02]
mat_Sqrt:  [[ 1.95352281e+01  0.00000000e+00]
 [-7.80761148e-03  1.78894853e-02]]
grads:  [-0.0494617  41.27895077]
Stock Position:  -0.04946169814618749
Bond Position:  [-9.98288924]


portfolio before change:  [-14.88267263]
curr_Stock_Price:  99.0117107951989
curr_Factors:  [9.90117108e+01 3.71236506e-02]
mat_Sqrt:  [[ 1.90770801e+01  0.00000000e+00]
 [-7.70699947e-03  1.76589542e-02]]
grads:  [ 2.81090019e-03 -3.27121768e+00]
Stock Position:  0.0028109001899626787
Bond Position:  [-15.16098466]


portfolio before change:  [-14.88440846]
curr_Stock_Price:  99.74275482741963
curr_Factors:  [9.97427548e+01 3.66285213e-02]
mat_Sqrt:  [[ 1.90893461e+01  0.00000000e+00]
 [-7.65543167e-03  1.75407976e-02]]
grads:  [ 3.19338430e-04 -3.39194926e+00]
Stock Position:  0.0003193384300236841
Bond Position:  [-14.91626015]


portfolio before change:  [-14.8879937]
curr_Stock_Price:  100.19457399819453
curr_Factors:  [1.00194574e+02 3.48244940e-02]
mat_Sqrt:  [[ 1.86976321e+01  0.00000000e+00]
 [-7.46452881e-03  1.71033842e-02]]
grads:  [-0.00537879 -4.21068807]
Stock Position:  -0.0053787871310133906
Bond Position:  [-14.34906842]


portfolio before change:  [-14.89050396]
curr_Stock_Price:  99.99425700611161
curr_Factors:  [9.9994257e+01 3.3842342e-02]
mat_Sqrt:  [[ 1.83952317e+01  0.00000000e+00]
 [-7.35851529e-03  1.68604767e-02]]
grads:  [ 0.00132934 -0.53096595]
Stock Position:  0.0013293446112652562
Bond Position:  [-15.02343078]


portfolio before change:  [-14.89221082]
curr_Stock_Price:  101.53596380973624
curr_Factors:  [1.01535964e+02 3.41991899e-02]
mat_Sqrt:  [[ 1.87770691e+01  0.00000000e+00]
 [-7.39720919e-03  1.69491355e-02]]
grads:  [ 0.00505602 -1.05528311]
Stock Position:  0.005056021891560017
Bond Position:  [-15.40557888]


portfolio before change:  [-14.90392958]
curr_Stock_Price:  99.98002113820719
curr_Factors:  [9.99800211e+01 3.45785373e-02]
mat_Sqrt:  [[ 1.85915900e+01  0.00000000e+00]
 [-7.43812205e-03  1.70428787e-02]]
grads:  [3.23456913e-03 3.36641434e+00]
Stock Position:  0.003234569131057063
Bond Position:  [-15.22732187]


portfolio before change:  [-14.90840977]
curr_Stock_Price:  99.77199144086526
curr_Factors:  [9.97719914e+01 3.51353363e-02]
mat_Sqrt:  [[ 1.87016833e+01  0.00000000e+00]
 [-7.49776887e-03  1.71795467e-02]]
grads:  [-0.00641724 -2.57297762]
Stock Position:  -0.0064172428762649825
Bond Position:  [-14.26814867]


portfolio before change:  [-14.90690266]
curr_Stock_Price:  98.98121615534852
curr_Factors:  [9.89812162e+01 3.57910386e-02]
mat_Sqrt:  [[ 1.87257808e+01  0.00000000e+00]
 [-7.56740787e-03  1.73391097e-02]]
grads:  [-0.01074063 -7.76609085]
Stock Position:  -0.010740629556798569
Bond Position:  [-13.84378208]


portfolio before change:  [-14.92086758]
curr_Stock_Price:  99.95914262944275
curr_Factors:  [9.99591426e+01 3.34396998e-02]
mat_Sqrt:  [[ 1.82790536e+01  0.00000000e+00]
 [-7.31461001e-03  1.67598770e-02]]
grads:  [-2.03855223e-02 -2.61850649e+01]
Stock Position:  -0.020385522254336545
Bond Position:  [-12.88314826]


portfolio before change:  [-14.92139028]
curr_Stock_Price:  99.82676949663389
curr_Factors:  [9.98267695e+01 3.50469659e-02]
mat_Sqrt:  [[ 1.86884047e+01  0.00000000e+00]
 [-7.48833395e-03  1.71579286e-02]]
grads:  [ 9.25048854e-03 -1.41443905e+01]
Stock Position:  0.009250488543155208
Bond Position:  [-15.84483667]


portfolio before change:  [-14.93164608]
curr_Stock_Price:  99.14636271504028
curr_Factors:  [9.91463627e+01 3.50898995e-02]
mat_Sqrt:  [[ 1.85723923e+01  0.00000000e+00]
 [-7.49291927e-03  1.71684349e-02]]
grads:  [-1.78220688e-03 -6.99139695e+00]
Stock Position:  -0.0017822068754689664
Bond Position:  [-14.75494675]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.93486332]
Stock Price:  98.88154592590313
PL:  [-14.93486332]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.58206909e-02  2.85818380e-02]
 [ 5.50677214e-02 -6.07965710e-04]
 [ 7.57348263e-01 -2.95159271e-01]
 [-1.26369072e-02 -1.00802768e-01]
 [-1.96233976e-02 -1.20619538e-02]
 [ 2.65873399e-02 -7.74215792e-02]
 [-5.20976802e-02 -5.98822726e-02]
 [-1.27793473e+00  6.91232799e-01]
 [ 8.54550917e-02 -7.44832967e-02]
 [ 3.01969822e-02 -6.35709891e-02]
 [-2.90859223e-02  3.94915505e-02]
 [ 2.03399352e-02 -9.07603517e-03]
 [ 1.18410263e-01 -1.41802094e-02]
 [ 2.14762760e-02  4.05232227e-02]
 [-4.51764640e-02 -2.34386251e-02]
 [-1.42929681e-01 -1.37226488e-01]
 [-1.91363242e-01 -3.77475626e-01]
 [ 2.79490583e-01 -2.43919497e-01]
 [ 8.55491150e-03 -1.22785194e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.62677768]
curr_Stock_Price:  100.7534478495421
curr_Factors:  [1.00753448e+02 4.25860184e-02]
mat_Sqrt:  [[ 2.07918645e+01  0.00000000e+00]
 [-8.25455205e-03  1.89135548e-02]]
grads:  [1.36086053e-03 1.51118276e+00]
Stock Position:  0.0013608605278070717
Bond Position:  [7.48966629]


portfolio before change:  [7.62958543]
curr_Stock_Price:  101.44059201106214
curr_Factors:  [1.01440592e+02 4.12100359e-02]
mat_Sqrt:  [[ 2.05926990e+01  0.00000000e+00]
 [-8.12010206e-03  1.86054912e-02]]
grads:  [ 0.00266125 -0.03267668]
Stock Position:  0.002661253069243947
Bond Position:  [7.35962635]


portfolio before change:  [7.63011117]
curr_Stock_Price:  100.94668772942963
curr_Factors:  [1.00946688e+02 4.16058270e-02]
mat_Sqrt:  [[ 2.05906072e+01  0.00000000e+00]
 [-8.15900259e-03  1.86946235e-02]]
grads:  [  0.03052509 -15.78845763]
Stock Position:  0.03052509285754014
Bond Position:  [4.54870415]


portfolio before change:  [7.58997747]
curr_Stock_Price:  99.59465201844009
curr_Factors:  [9.95946520e+01 4.22995526e-02]
mat_Sqrt:  [[ 2.04834877e+01  0.00000000e+00]
 [-8.22674201e-03  1.88498340e-02]]
grads:  [-2.76470701e-03 -5.34767405e+00]
Stock Position:  -0.002764707010060804
Bond Position:  [7.8653275]


portfolio before change:  [7.58832368]
curr_Stock_Price:  100.90414727580708
curr_Factors:  [1.00904147e+02 4.09732676e-02]
mat_Sqrt:  [[ 2.04248707e+01  0.00000000e+00]
 [-8.09674182e-03  1.85519661e-02]]
grads:  [-0.0012185  -0.65017118]
Stock Position:  -0.0012184980823501718
Bond Position:  [7.71127519]


portfolio before change:  [7.5926652]
curr_Stock_Price:  98.92345675909182
curr_Factors:  [9.89234568e+01 4.12186196e-02]
mat_Sqrt:  [[ 2.00838054e+01  0.00000000e+00]
 [-8.12094769e-03  1.86074287e-02]]
grads:  [-3.58607711e-04 -4.16078870e+00]
Stock Position:  -0.00035860771082684887
Bond Position:  [7.62813992]


portfolio before change:  [7.59582016]
curr_Stock_Price:  95.44421448181241
curr_Factors:  [9.54442145e+01 4.23433383e-02]
mat_Sqrt:  [[ 1.96400304e+01  0.00000000e+00]
 [-8.23099880e-03  1.88595875e-02]]
grads:  [-0.00398332 -3.17516343]
Stock Position:  -0.003983315967924175
Bond Position:  [7.97600462]


portfolio before change:  [7.59028426]
curr_Stock_Price:  97.33463600518382
curr_Factors:  [9.73346360e+01 4.09237768e-02]
mat_Sqrt:  [[ 1.96904328e+01  0.00000000e+00]
 [-8.09185040e-03  1.85407585e-02]]
grads:  [-0.04958022 37.28179724]
Stock Position:  -0.04958022066064431
Bond Position:  [12.416157]


portfolio before change:  [7.45406597]
curr_Stock_Price:  100.14468250272323
curr_Factors:  [1.00144683e+02 4.06856496e-02]
mat_Sqrt:  [[ 2.01998675e+01  0.00000000e+00]
 [-8.06827363e-03  1.84867373e-02]]
grads:  [ 2.62120115e-03 -4.02901255e+00]
Stock Position:  0.002621201147637777
Bond Position:  [7.19156661]


portfolio before change:  [7.45458662]
curr_Stock_Price:  99.6573239911241
curr_Factors:  [9.96573240e+01 4.02544731e-02]
mat_Sqrt:  [[ 1.99947646e+01  0.00000000e+00]
 [-8.02540696e-03  1.83885174e-02]]
grads:  [ 1.22648507e-04 -3.45710247e+00]
Stock Position:  0.00012264850701632557
Bond Position:  [7.4423638]


portfolio before change:  [7.45641778]
curr_Stock_Price:  99.41547542331804
curr_Factors:  [9.94154754e+01 3.93207590e-02]
mat_Sqrt:  [[ 1.97135546e+01  0.00000000e+00]
 [-7.93178507e-03  1.81740027e-02]]
grads:  [-6.01129368e-04  2.17296933e+00]
Stock Position:  -0.0006011293676631068
Bond Position:  [7.51617934]


portfolio before change:  [7.45741484]
curr_Stock_Price:  100.88307559808372
curr_Factors:  [1.00883076e+02 3.61528591e-02]
mat_Sqrt:  [[ 1.91818123e+01  0.00000000e+00]
 [-7.60556208e-03  1.74265320e-02]]
grads:  [ 0.00085387 -0.52081706]
Stock Position:  0.0008538728443425135
Bond Position:  [7.37127352]


portfolio before change:  [7.45952986]
curr_Stock_Price:  101.2015933837226
curr_Factors:  [1.01201593e+02 3.42866058e-02]
mat_Sqrt:  [[ 1.87391375e+01  0.00000000e+00]
 [-7.40665709e-03  1.69707834e-02]]
grads:  [ 0.00598862 -0.83556599]
Stock Position:  0.005988616709738212
Bond Position:  [6.85347231]


portfolio before change:  [7.45245338]
curr_Stock_Price:  99.7337970332479
curr_Factors:  [9.97337970e+01 3.25491997e-02]
mat_Sqrt:  [[ 1.79933700e+01  0.00000000e+00]
 [-7.21655871e-03  1.65352133e-02]]
grads:  [2.17647168e-03 2.45072271e+00]
Stock Position:  0.0021764716845353196
Bond Position:  [7.23538559]


portfolio before change:  [7.45280705]
curr_Stock_Price:  99.06510047752104
curr_Factors:  [9.90651005e+01 3.19812174e-02]
mat_Sqrt:  [[ 1.77161023e+01  0.00000000e+00]
 [-7.15331726e-03  1.63903089e-02]]
grads:  [-0.00312743 -1.43002949]
Stock Position:  -0.003127432752200257
Bond Position:  [7.76262649]


portfolio before change:  [7.4569013]
curr_Stock_Price:  98.37656358833793
curr_Factors:  [9.83765636e+01 3.39920847e-02]
mat_Sqrt:  [[ 1.81376304e+01  0.00000000e+00]
 [-7.37477698e-03  1.68977369e-02]]
grads:  [-0.01118229 -8.12099806]
Stock Position:  -0.011182289300299507
Bond Position:  [8.5569765]


portfolio before change:  [7.46234034]
curr_Stock_Price:  98.0814962233075
curr_Factors:  [9.80814962e+01 3.37066415e-02]
mat_Sqrt:  [[ 1.80071434e+01  0.00000000e+00]
 [-7.34374743e-03  1.68266392e-02]]
grads:  [-1.97758802e-02 -2.24332156e+01]
Stock Position:  -0.019775880224733783
Bond Position:  [9.40198826]


portfolio before change:  [7.43110743]
curr_Stock_Price:  99.77971134262116
curr_Factors:  [9.97797113e+01 3.21615518e-02]
mat_Sqrt:  [[ 1.78941363e+01  0.00000000e+00]
 [-7.17345683e-03  1.64364544e-02]]
grads:  [ 9.66994906e-03 -1.48401529e+01]
Stock Position:  0.009669949059790068
Bond Position:  [6.46624271]


portfolio before change:  [7.42427346]
curr_Stock_Price:  98.90579370506967
curr_Factors:  [9.89057937e+01 3.53068602e-02]
mat_Sqrt:  [[ 1.85845171e+01  0.00000000e+00]
 [-7.51604791e-03  1.72214292e-02]]
grads:  [-2.42314290e-03 -7.12979118e+00]
Stock Position:  -0.0024231428986538728
Bond Position:  [7.66393633]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.42745818]
Stock Price:  98.38230145573901
PL:  [7.42745818]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.79481603e-02  9.91418779e-02]
 [-1.33618265e-02  4.14879807e-02]
 [ 7.14784507e-01 -2.82168655e-01]
 [ 2.62758891e-01 -9.88438261e-02]
 [ 1.36401361e-01 -6.38748445e-03]
 [ 3.84782619e-02 -3.67847289e-02]
 [-2.48422897e-02 -7.30418298e-02]
 [-1.26977771e+00  7.36013708e-01]
 [ 7.85209476e-02 -7.57958946e-02]
 [ 9.47890064e-02  2.04355422e-01]
 [-1.76824766e-01 -3.97577496e-02]
 [ 2.13676770e-02 -9.06018539e-03]
 [ 1.63330983e-01 -2.79951166e-02]
 [-1.38356667e-02 -3.16436983e-03]
 [-2.25817279e-02 -1.43413449e-02]
 [-1.41194765e-01 -1.29435848e-01]
 [-1.90363277e-01 -3.91422972e-01]
 [ 2.90446918e-01 -2.63304463e-01]
 [-1.52183840e-02 -1.28885962e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.43610068]
curr_Stock_Price:  100.27285471996579
curr_Factors:  [1.00272855e+02 4.20541715e-02]
mat_Sqrt:  [[ 2.05630684e+01  0.00000000e+00]
 [-8.20284551e-03  1.87950802e-02]]
grads:  [3.46335584e-03 5.27488453e+00]
Stock Position:  0.003463355843746227
Bond Position:  [4.08882011]


portfolio before change:  [4.44248389]
curr_Stock_Price:  101.82073981284037
curr_Factors:  [1.01820740e+02 4.11791005e-02]
mat_Sqrt:  [[ 2.06621103e+01  0.00000000e+00]
 [-8.11705370e-03  1.85985065e-02]]
grads:  [2.29648022e-04 2.23071571e+00]
Stock Position:  0.0002296480215172625
Bond Position:  [4.41910096]


portfolio before change:  [4.44322972]
curr_Stock_Price:  100.25709340213962
curr_Factors:  [1.00257093e+02 4.14089740e-02]
mat_Sqrt:  [[ 2.04015115e+01  0.00000000e+00]
 [-8.13967802e-03  1.86503453e-02]]
grads:  [  0.02899962 -15.12940645]
Stock Position:  0.028999616516192678
Bond Position:  [1.53581246]


portfolio before change:  [4.4936959]
curr_Stock_Price:  101.98408784859474
curr_Factors:  [1.01984088e+02 4.05796739e-02]
mat_Sqrt:  [[ 2.05440797e+01  0.00000000e+00]
 [-8.05775888e-03  1.84626450e-02]]
grads:  [ 0.01069018 -5.35371969]
Stock Position:  0.010690179917123226
Bond Position:  [3.40346765]


portfolio before change:  [4.46955275]
curr_Stock_Price:  99.64604309122169
curr_Factors:  [9.96460431e+01 4.22772616e-02]
mat_Sqrt:  [[ 2.04886565e+01  0.00000000e+00]
 [-8.22457407e-03  1.88448666e-02]]
grads:  [ 0.00652135 -0.3389509 ]
Stock Position:  0.006521346796595672
Bond Position:  [3.81972635]


portfolio before change:  [4.47479786]
curr_Stock_Price:  100.30389150752701
curr_Factors:  [1.00303892e+02 4.45685270e-02]
mat_Sqrt:  [[ 2.11754146e+01  0.00000000e+00]
 [-8.44450372e-03  1.93487888e-02]]
grads:  [ 1.05896817e-03 -1.90113859e+00]
Stock Position:  0.0010589681672619842
Bond Position:  [4.36857923]


portfolio before change:  [4.47316015]
curr_Stock_Price:  97.72592195685607
curr_Factors:  [9.77259220e+01 4.51002415e-02]
mat_Sqrt:  [[ 2.07538756e+01  0.00000000e+00]
 [-8.49472697e-03  1.94638647e-02]]
grads:  [-2.73300075e-03 -3.75268894e+00]
Stock Position:  -0.0027330007531740125
Bond Position:  [4.74024517]


portfolio before change:  [4.46887061]
curr_Stock_Price:  99.72912463263228
curr_Factors:  [9.97291246e+01 4.49002309e-02]
mat_Sqrt:  [[ 2.11322770e+01  0.00000000e+00]
 [-8.47586983e-03  1.94206575e-02]]
grads:  [-0.04488655 37.89849581]
Stock Position:  -0.04488654933265309
Bond Position:  [8.94536688]


portfolio before change:  [4.42298569]
curr_Stock_Price:  100.8011949377096
curr_Factors:  [1.00801195e+02 4.30540294e-02]
mat_Sqrt:  [[ 2.09157086e+01  0.00000000e+00]
 [-8.29978597e-03  1.90171987e-02]]
grads:  [ 2.17257317e-03 -3.98564982e+00]
Stock Position:  0.00217257316592429
Bond Position:  [4.20398772]


portfolio before change:  [4.42613222]
curr_Stock_Price:  101.76567071438357
curr_Factors:  [1.01765671e+02 3.99768025e-02]
mat_Sqrt:  [[ 2.03472315e+01  0.00000000e+00]
 [-7.99767991e-03  1.83249868e-02]]
grads:  [9.04187012e-03 1.11517364e+01]
Stock Position:  0.00904187012211141
Bond Position:  [3.50598024]


portfolio before change:  [4.429099]
curr_Stock_Price:  101.99683779022284
curr_Factors:  [1.01996838e+02 4.04141487e-02]
mat_Sqrt:  [[ 2.05047003e+01  0.00000000e+00]
 [-8.04130822e-03  1.84249518e-02]]
grads:  [-0.00946985 -2.15782109]
Stock Position:  -0.009469851673716825
Bond Position:  [5.39499393]


portfolio before change:  [4.44234028]
curr_Stock_Price:  100.74102474931833
curr_Factors:  [1.00741025e+02 4.07413839e-02]
mat_Sqrt:  [[ 2.03340671e+01  0.00000000e+00]
 [-8.07379800e-03  1.84993953e-02]]
grads:  [ 0.00085637 -0.48975576]
Stock Position:  0.0008563701398449291
Bond Position:  [4.35606868]


portfolio before change:  [4.44236228]
curr_Stock_Price:  99.49488554288388
curr_Factors:  [9.94948855e+01 4.12901654e-02]
mat_Sqrt:  [[ 2.02173425e+01  0.00000000e+00]
 [-8.12799266e-03  1.86235708e-02]]
grads:  [ 0.00747442 -1.50320886]
Stock Position:  0.007474420183191337
Bond Position:  [3.6986957]


portfolio before change:  [4.44041148]
curr_Stock_Price:  99.11016080923558
curr_Factors:  [9.91101608e+01 4.22015503e-02]
mat_Sqrt:  [[ 2.03602161e+01  0.00000000e+00]
 [-8.21720637e-03  1.88279851e-02]]
grads:  [-0.00074737 -0.16806736]
Stock Position:  -0.0007473747256784143
Bond Position:  [4.5144839]


portfolio before change:  [4.44179472]
curr_Stock_Price:  98.76965801199216
curr_Factors:  [9.87696580e+01 3.96899461e-02]
mat_Sqrt:  [[ 1.96772229e+01  0.00000000e+00]
 [-7.96893429e-03  1.82591223e-02]]
grads:  [-0.00146569 -0.78543452]
Stock Position:  -0.0014656948387054148
Bond Position:  [4.5865609]


portfolio before change:  [4.44071895]
curr_Stock_Price:  100.28604276810954
curr_Factors:  [1.00286043e+02 3.85012604e-02]
mat_Sqrt:  [[ 1.96778646e+01  0.00000000e+00]
 [-7.84869522e-03  1.79836200e-02]]
grads:  [-0.01004607 -7.19743009]
Stock Position:  -0.010046069744248995
Bond Position:  [5.44819953]


portfolio before change:  [4.45772075]
curr_Stock_Price:  98.72925633343452
curr_Factors:  [9.87292563e+01 3.81747515e-02]
mat_Sqrt:  [[ 1.92900776e+01  0.00000000e+00]
 [-7.81534403e-03  1.79072028e-02]]
grads:  [-1.87243553e-02 -2.18584095e+01]
Stock Position:  -0.01872435531599807
Bond Position:  [6.30636243]


portfolio before change:  [4.47687798]
curr_Stock_Price:  97.79034866380515
curr_Factors:  [9.77903487e+01 3.85817448e-02]
mat_Sqrt:  [[ 1.92082114e+01  0.00000000e+00]
 [-7.85689453e-03  1.80024070e-02]]
grads:  [ 9.13835368e-03 -1.46260699e+01]
Stock Position:  0.009138353680688447
Bond Position:  [3.58323519]


portfolio before change:  [4.4830997]
curr_Stock_Price:  98.373144464487
curr_Factors:  [9.83731445e+01 3.62640017e-02]
mat_Sqrt:  [[ 1.87333056e+01  0.00000000e+00]
 [-7.61724377e-03  1.74532981e-02]]
grads:  [-3.81506774e-03 -7.38461933e+00]
Stock Position:  -0.003815067739140549
Bond Position:  [4.85839991]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.48229446]
Stock Price:  98.90262038735844
PL:  [4.48229446]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.73427585e-02  1.22884689e-01]
 [ 4.07213472e-02  8.21352381e-03]
 [ 7.59780010e-01 -2.95901449e-01]
 [ 3.05056903e-01 -8.56528368e-02]
 [ 2.22290757e-01 -2.99902447e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-3.01927232e-01 -1.52915883e-01]
 [-1.41804699e+00  7.50415205e-01]
 [ 3.53605116e-02 -8.00165942e-02]
 [ 9.78558572e-02  2.16825620e-01]
 [-9.50759507e-02 -1.18014561e-01]
 [ 1.70713278e-02 -9.12644348e-03]
 [ 1.44528975e-01 -1.89178895e-02]
 [-2.07657643e-02 -1.17382192e-02]
 [-1.15793838e-01 -5.95170791e-02]
 [-1.40599396e-01 -1.26762341e-01]
 [-1.56569341e-01 -5.56863093e-01]
 [ 8.22510238e-02 -1.92358150e-01]
 [ 1.10470616e-01 -4.39288990e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.11052578]
curr_Stock_Price:  99.92256688971106
curr_Factors:  [9.99225669e+01 3.85161100e-02]
mat_Sqrt:  [[ 1.96103250e+01  0.00000000e+00]
 [-7.85020866e-03  1.79870877e-02]]
grads:  [3.61921760e-03 6.83182795e+00]
Stock Position:  0.003619217604937241
Bond Position:  [1.74888427]


portfolio before change:  [2.1167514]
curr_Stock_Price:  101.52190247587082
curr_Factors:  [1.01521902e+02 4.00124227e-02]
mat_Sqrt:  [[ 2.03075332e+01  0.00000000e+00]
 [-8.00124217e-03  1.83331489e-02]]
grads:  [0.00218175 0.4480149 ]
Stock Position:  0.0021817530698219766
Bond Position:  [1.89525568]


portfolio before change:  [2.11651156]
curr_Stock_Price:  101.19477432841717
curr_Factors:  [1.01194774e+02 4.01885406e-02]
mat_Sqrt:  [[ 2.02865971e+01  0.00000000e+00]
 [-8.01883190e-03  1.83734521e-02]]
grads:  [  0.03108644 -16.1048369 ]
Stock Position:  0.031086437347788456
Bond Position:  [-1.02927345]


portfolio before change:  [2.15780638]
curr_Stock_Price:  102.5314399240721
curr_Factors:  [1.02531440e+02 3.84524265e-02]
mat_Sqrt:  [[ 2.01056877e+01  0.00000000e+00]
 [-7.84371611e-03  1.79722114e-02]]
grads:  [ 0.01331339 -4.7658485 ]
Stock Position:  0.013313393936540697
Bond Position:  [0.79276493]


portfolio before change:  [2.1743729]
curr_Stock_Price:  103.76090142514785
curr_Factors:  [1.03760901e+02 3.71929681e-02]
mat_Sqrt:  [[ 2.00107863e+01  0.00000000e+00]
 [-7.71419140e-03  1.76754330e-02]]
grads:  [ 0.01045446 -1.69671909]
Stock Position:  0.010454458775921844
Bond Position:  [1.08960884]


portfolio before change:  [2.19686886]
curr_Stock_Price:  105.88664746789594
curr_Factors:  [1.05886647e+02 3.64249961e-02]
mat_Sqrt:  [[ 2.02088200e+01  0.00000000e+00]
 [-7.63413346e-03  1.74919972e-02]]
grads:  [-2.86816429e-05 -1.10628740e+00]
Stock Position:  -2.868164286084744e-05
Bond Position:  [2.19990587]


portfolio before change:  [2.19748719]
curr_Stock_Price:  103.5061650659114
curr_Factors:  [1.03506165e+02 3.71473263e-02]
mat_Sqrt:  [[ 1.99494073e+01  0.00000000e+00]
 [-7.70945666e-03  1.76645844e-02]]
grads:  [-0.01848001 -8.65663632]
Stock Position:  -0.01848000734584446
Bond Position:  [4.11028188]


portfolio before change:  [2.19841642]
curr_Stock_Price:  103.51149318734922
curr_Factors:  [1.03511493e+02 3.72646457e-02]
mat_Sqrt:  [[ 1.99819134e+01  0.00000000e+00]
 [-7.72162115e-03  1.76924567e-02]]
grads:  [-0.0545763  42.41441524]
Stock Position:  -0.05457630242623132
Bond Position:  [7.84769098]


portfolio before change:  [2.15231304]
curr_Stock_Price:  104.39219675523572
curr_Factors:  [1.04392197e+02 3.55387660e-02]
mat_Sqrt:  [[ 1.96797333e+01  0.00000000e+00]
 [-7.54069132e-03  1.72778944e-02]]
grads:  [ 2.22770737e-05 -4.63115426e+00]
Stock Position:  2.2277073657106805e-05
Bond Position:  [2.14998749]


portfolio before change:  [2.1527957]
curr_Stock_Price:  101.92736335926777
curr_Factors:  [1.01927363e+02 3.52324142e-02]
mat_Sqrt:  [[ 1.91320713e+01  0.00000000e+00]
 [-7.50811979e-03  1.72032636e-02]]
grads:  [1.00609240e-02 1.26037492e+01]
Stock Position:  0.010060924019864269
Bond Position:  [1.12731224]


portfolio before change:  [2.14149859]
curr_Stock_Price:  100.77647790166883
curr_Factors:  [1.00776478e+02 3.35792001e-02]
mat_Sqrt:  [[ 1.84669150e+01  0.00000000e+00]
 [-7.32985131e-03  1.67947992e-02]]
grads:  [-0.00793753 -7.02685155]
Stock Position:  -0.007937531963091417
Bond Position:  [2.94141511]


portfolio before change:  [2.13773004]
curr_Stock_Price:  101.34390889963458
curr_Factors:  [1.01343909e+02 3.21417130e-02]
mat_Sqrt:  [[ 1.81690475e+01  0.00000000e+00]
 [-7.17124403e-03  1.64313843e-02]]
grads:  [ 0.00072036 -0.55542755]
Stock Position:  0.0007203581407088531
Bond Position:  [2.06472613]


portfolio before change:  [2.13757061]
curr_Stock_Price:  100.40594040026586
curr_Factors:  [1.00405940e+02 3.12009144e-02]
mat_Sqrt:  [[ 1.77354850e+01  0.00000000e+00]
 [-7.06551223e-03  1.61891223e-02]]
grads:  [ 0.00768361 -1.1685556 ]
Stock Position:  0.0076836089595800515
Bond Position:  [1.36609062]


portfolio before change:  [2.1267535]
curr_Stock_Price:  98.9536704843364
curr_Factors:  [9.89536705e+01 3.11679546e-02]
mat_Sqrt:  [[ 1.74697246e+01  0.00000000e+00]
 [-7.06177934e-03  1.61805692e-02]]
grads:  [-0.00148192 -0.72545156]
Stock Position:  -0.0014819205037524383
Bond Position:  [2.27339497]


portfolio before change:  [2.12539249]
curr_Stock_Price:  100.25565161798662
curr_Factors:  [1.00255652e+02 3.20527726e-02]
mat_Sqrt:  [[ 1.79490582e+01  0.00000000e+00]
 [-7.16131526e-03  1.64086346e-02]]
grads:  [-0.00789842 -3.62718047]
Stock Position:  -0.00789842113924702
Bond Position:  [2.91725384]


portfolio before change:  [2.11397842]
curr_Stock_Price:  101.79310661886085
curr_Factors:  [1.01793107e+02 3.02579812e-02]
mat_Sqrt:  [[ 1.77067291e+01  0.00000000e+00]
 [-6.95792857e-03  1.59426172e-02]]
grads:  [-0.01106489 -7.95116255]
Stock Position:  -0.011064890395376928
Bond Position:  [3.24030799]


portfolio before change:  [2.09930774]
curr_Stock_Price:  103.19220400576538
curr_Factors:  [1.03192204e+02 3.01672608e-02]
mat_Sqrt:  [[ 1.79231701e+01  0.00000000e+00]
 [-6.94749000e-03  1.59186994e-02]]
grads:  [-2.22954040e-02 -3.49816953e+01]
Stock Position:  -0.022295404040234505
Bond Position:  [4.40001963]


portfolio before change:  [2.12405246]
curr_Stock_Price:  102.13169061655348
curr_Factors:  [1.02131691e+02 2.85831601e-02]
mat_Sqrt:  [[ 1.72669504e+01  0.00000000e+00]
 [-6.76262198e-03  1.54951136e-02]]
grads:  [-9.85093058e-05 -1.24141168e+01]
Stock Position:  -9.850930581587709e-05
Bond Position:  [2.13411338]


portfolio before change:  [2.12465364]
curr_Stock_Price:  101.44560495707901
curr_Factors:  [1.01445605e+02 3.03215585e-02]
mat_Sqrt:  [[ 1.76648111e+01  0.00000000e+00]
 [-6.96523464e-03  1.59593575e-02]]
grads:  [ 0.00516838 -2.75254809]
Stock Position:  0.005168380960896807
Bond Position:  [1.60034411]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.12037553]
Stock Price:  100.54043835433869
PL:  [1.57993718]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.12192876e-02  2.29236300e-02]
 [ 5.08885838e-02 -4.41920679e-02]
 [ 6.44834596e-01 -2.60819683e-01]
 [ 3.17420143e-02 -1.04968091e-01]
 [ 2.29019280e-01 -6.78430680e-03]
 [-1.03468470e-01 -1.97863011e-01]
 [-3.95108239e-02 -5.50171178e-02]
 [-1.27552019e+00  6.99406611e-01]
 [ 6.36813385e-02 -3.61297970e-02]
 [ 1.74611266e-02 -7.74145854e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 6.96799202e-02 -4.44769202e-02]
 [ 1.39567456e-01 -3.31376098e-02]
 [-5.62801672e-02 -5.98867502e-02]
 [ 6.14982485e-02  5.92574612e-02]
 [-1.37773223e-01 -1.37148038e-01]
 [-1.90915021e-01 -3.83722447e-01]
 [ 2.89162016e-01 -2.61031095e-01]
 [-1.03691573e-01 -1.51589143e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.53154941]
curr_Stock_Price:  101.34160091991724
curr_Factors:  [1.01341601e+02 3.84702039e-02]
mat_Sqrt:  [[ 1.98769619e+01  0.00000000e+00]
 [-7.84552907e-03  1.79763654e-02]]
grads:  [1.06776780e-03 1.27520939e+00]
Stock Position:  0.0010677678030685607
Bond Position:  [11.42334012]


portfolio before change:  [11.53205107]
curr_Stock_Price:  99.13650376339719
curr_Factors:  [9.91365038e+01 4.00395818e-02]
mat_Sqrt:  [[ 1.98371083e+01  0.00000000e+00]
 [-8.00395720e-03  1.83393699e-02]]
grads:  [ 1.59305397e-03 -2.40968301e+00]
Stock Position:  0.0015930539705518948
Bond Position:  [11.37412127]


portfolio before change:  [11.53507337]
curr_Stock_Price:  99.24849822299679
curr_Factors:  [9.92484982e+01 4.06629641e-02]
mat_Sqrt:  [[ 2.00135191e+01  0.00000000e+00]
 [-8.06602396e-03  1.84815827e-02]]
grads:  [  0.02653224 -14.1124106 ]
Stock Position:  0.026532243053014153
Bond Position:  [8.9017881]


portfolio before change:  [11.55499562]
curr_Stock_Price:  99.91548010792779
curr_Factors:  [9.99154801e+01 3.98830985e-02]
mat_Sqrt:  [[ 1.99538740e+01  0.00000000e+00]
 [-7.98830130e-03  1.83034977e-02]]
grads:  [-7.05117034e-04 -5.73486516e+00]
Stock Position:  -0.0007051170340644247
Bond Position:  [11.62544773]


portfolio before change:  [11.55877436]
curr_Stock_Price:  98.67878748206117
curr_Factors:  [9.86787875e+01 3.95490668e-02]
mat_Sqrt:  [[ 1.96241983e+01  0.00000000e+00]
 [-7.95477887e-03  1.82266882e-02]]
grads:  [ 0.01151937 -0.3722183 ]
Stock Position:  0.011519368189879446
Bond Position:  [10.42205708]


portfolio before change:  [11.54089091]
curr_Stock_Price:  96.90010593646072
curr_Factors:  [9.69001059e+01 3.98159452e-02]
mat_Sqrt:  [[ 1.93353824e+01  0.00000000e+00]
 [-7.98157330e-03  1.82880819e-02]]
grads:  [-9.81738885e-03 -1.08192326e+01]
Stock Position:  -0.009817388845643246
Bond Position:  [12.49219693]


portfolio before change:  [11.55414482]
curr_Stock_Price:  95.86821547827317
curr_Factors:  [9.58682155e+01 4.11558149e-02]
mat_Sqrt:  [[ 1.94486852e+01  0.00000000e+00]
 [-8.11475840e-03  1.85932473e-02]]
grads:  [-0.00326615 -2.95898381]
Stock Position:  -0.003266146894835272
Bond Position:  [11.8672645]


portfolio before change:  [11.55133144]
curr_Stock_Price:  97.63805934099011
curr_Factors:  [9.76380593e+01 3.74762000e-02]
mat_Sqrt:  [[ 1.89015280e+01  0.00000000e+00]
 [-7.74350825e-03  1.77426064e-02]]
grads:  [-0.05133311 39.41960931]
Stock Position:  -0.05133310530743398
Bond Position:  [16.56339622]


portfolio before change:  [11.5475282]
curr_Stock_Price:  97.79282511280768
curr_Factors:  [9.77928251e+01 3.65280762e-02]
mat_Sqrt:  [[ 1.86904773e+01  0.00000000e+00]
 [-7.64492786e-03  1.75167303e-02]]
grads:  [ 0.0025635  -2.06258796]
Stock Position:  0.0025634980612784927
Bond Position:  [11.29683648]


portfolio before change:  [11.54713495]
curr_Stock_Price:  96.53758381437696
curr_Factors:  [9.65375838e+01 3.65197246e-02]
mat_Sqrt:  [[ 1.84484622e+01  0.00000000e+00]
 [-7.64405386e-03  1.75147277e-02]]
grads:  [-8.84917571e-04 -4.41997082e+00]
Stock Position:  -0.0008849175710674754
Bond Position:  [11.63256276]


portfolio before change:  [11.55208025]
curr_Stock_Price:  94.23590624657787
curr_Factors:  [9.42359062e+01 3.61095941e-02]
mat_Sqrt:  [[ 1.79072013e+01  0.00000000e+00]
 [-7.60100984e-03  1.74161015e-02]]
grads:  [1.50723945e-02 2.00715871e+01]
Stock Position:  0.015072394453096109
Bond Position:  [10.1317195]


portfolio before change:  [11.56893684]
curr_Stock_Price:  95.1862094756841
curr_Factors:  [9.51862095e+01 3.52645440e-02]
mat_Sqrt:  [[ 1.78748814e+01  0.00000000e+00]
 [-7.51154247e-03  1.72111060e-02]]
grads:  [ 0.00281225 -2.58419884]
Stock Position:  0.0028122480778912857
Bond Position:  [11.30124961]


portfolio before change:  [11.57467247]
curr_Stock_Price:  96.22095529435165
curr_Factors:  [9.62209553e+01 3.35142517e-02]
mat_Sqrt:  [[ 1.76150722e+01  0.00000000e+00]
 [-7.32275922e-03  1.67785492e-02]]
grads:  [ 0.00710216 -1.97499851]
Stock Position:  0.007102157543543906
Bond Position:  [10.89129609]


portfolio before change:  [11.58895058]
curr_Stock_Price:  97.84791723247044
curr_Factors:  [9.78479172e+01 3.35195817e-02]
mat_Sqrt:  [[ 1.79143428e+01  0.00000000e+00]
 [-7.32334150e-03  1.67798834e-02]]
grads:  [-0.00460061 -3.56896105]
Stock Position:  -0.0046006090509442725
Bond Position:  [12.03911059]


portfolio before change:  [11.59865201]
curr_Stock_Price:  96.39348297394972
curr_Factors:  [9.63934830e+01 3.42650046e-02]
mat_Sqrt:  [[ 1.78432134e+01  0.00000000e+00]
 [-7.40432356e-03  1.69654366e-02]]
grads:  [0.004896   3.49283444]
Stock Position:  0.004895997307887266
Bond Position:  [11.12670978]


portfolio before change:  [11.59885843]
curr_Stock_Price:  95.8674179612013
curr_Factors:  [9.58674180e+01 3.43271367e-02]
mat_Sqrt:  [[ 1.77619163e+01  0.00000000e+00]
 [-7.41103358e-03  1.69808112e-02]]
grads:  [-0.01112659 -8.07664821]
Stock Position:  -0.011126588489418035
Bond Position:  [12.66553574]


portfolio before change:  [11.57434833]
curr_Stock_Price:  98.35487197681486
curr_Factors:  [9.83548720e+01 3.40364857e-02]
mat_Sqrt:  [[ 1.81454705e+01  0.00000000e+00]
 [-7.37959193e-03  1.69087693e-02]]
grads:  [-1.97506715e-02 -2.26936946e+01]
Stock Position:  -0.01975067147973281
Bond Position:  [13.51692309]


portfolio before change:  [11.58166321]
curr_Stock_Price:  98.15562676539622
curr_Factors:  [9.81556268e+01 3.23466387e-02]
mat_Sqrt:  [[ 1.76534576e+01  0.00000000e+00]
 [-7.19406853e-03  1.64836818e-02]]
grads:  [ 9.92659398e-03 -1.58357276e+01]
Stock Position:  0.009926593982115768
Bond Position:  [10.60731215]


portfolio before change:  [11.566737]
curr_Stock_Price:  96.3847904883462
curr_Factors:  [9.63847905e+01 2.99369233e-02]
mat_Sqrt:  [[ 1.66767758e+01  0.00000000e+00]
 [-6.92091592e-03  1.58578105e-02]]
grads:  [-0.01018485 -9.55927318]
Stock Position:  -0.010184852355746283
Bond Position:  [12.54840186]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.56233894]
Stock Price:  97.1246688717395
PL:  [11.56233894]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.46176502e-02  2.71024948e-02]
 [ 8.23604053e-02 -8.61797643e-03]
 [ 7.63462332e-01 -2.97025308e-01]
 [ 1.17790521e-01 -1.13665833e-01]
 [-1.85154386e-02 -1.21662821e-02]
 [ 3.86690404e-03 -1.21306435e-01]
 [-5.86095413e-02 -1.21541326e-01]
 [-1.38162114e+00  7.46933688e-01]
 [ 3.72677243e-02 -7.71534046e-02]
 [ 1.22817773e-01  3.34135473e-01]
 [-3.15846036e-01 -3.97186512e-02]
 [ 5.51181255e-03 -9.30471379e-03]
 [ 9.51532639e-02 -1.95919024e-02]
 [ 2.35565048e-02  4.30968615e-02]
 [ 4.29052565e-02  2.41351722e-02]
 [-1.37397431e-01 -1.36972107e-01]
 [-1.96404832e-01 -3.07240290e-01]
 [ 2.81508855e-01 -3.02174919e-01]
 [-1.43072577e-01 -1.61695856e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.64774783]
curr_Stock_Price:  100.90723064908667
curr_Factors:  [1.00907231e+02 4.19359462e-02]
mat_Sqrt:  [[ 2.06640532e+01  0.00000000e+00]
 [-8.19130722e-03  1.87686427e-02]]
grads:  [1.27981420e-03 1.44403062e+00]
Stock Position:  0.0012798141972437955
Bond Position:  [8.51860532]


portfolio before change:  [8.64943431]
curr_Stock_Price:  100.56074341745018
curr_Factors:  [1.00560743e+02 4.09713667e-02]
mat_Sqrt:  [[ 2.03548872e+01  0.00000000e+00]
 [-8.09655400e-03  1.85515358e-02]]
grads:  [ 0.00386144 -0.46454248]
Stock Position:  0.003861441780613746
Bond Position:  [8.26112485]


portfolio before change:  [8.65436744]
curr_Stock_Price:  101.30336546256996
curr_Factors:  [1.01303365e+02 3.99106976e-02]
mat_Sqrt:  [[ 2.02380439e+01  0.00000000e+00]
 [-7.99106477e-03  1.83098296e-02]]
grads:  [  0.03131873 -16.22217759]
Stock Position:  0.03131873139804632
Bond Position:  [5.48167454]


portfolio before change:  [8.63159011]
curr_Stock_Price:  100.53232794756
curr_Factors:  [1.00532328e+02 4.16482555e-02]
mat_Sqrt:  [[ 2.05165412e+01  0.00000000e+00]
 [-8.16316169e-03  1.87041532e-02]]
grads:  [ 3.32330308e-03 -6.07703711e+00]
Stock Position:  0.003323303079158838
Bond Position:  [8.29749072]


portfolio before change:  [8.63493636]
curr_Stock_Price:  100.91496466619549
curr_Factors:  [1.00914965e+02 3.93585095e-02]
mat_Sqrt:  [[ 2.00204988e+01  0.00000000e+00]
 [-7.93559167e-03  1.81827248e-02]]
grads:  [-0.00119004 -0.66911215]
Stock Position:  -0.0011900422469165641
Bond Position:  [8.75502943]


portfolio before change:  [8.64065021]
curr_Stock_Price:  97.95304115143418
curr_Factors:  [9.79530412e+01 4.15830292e-02]
mat_Sqrt:  [[ 1.99745032e+01  0.00000000e+00]
 [-8.15676693e-03  1.86895009e-02]]
grads:  [-2.45691040e-03 -6.49061927e+00]
Stock Position:  -0.0024569104016802477
Bond Position:  [8.88131205]


portfolio before change:  [8.63939513]
curr_Stock_Price:  99.36769748046851
curr_Factors:  [9.93676975e+01 4.12888146e-02]
mat_Sqrt:  [[ 2.01911676e+01  0.00000000e+00]
 [-8.12785970e-03  1.86232662e-02]]
grads:  [-5.52986965e-03 -6.52631634e+00]
Stock Position:  -0.005529869649479389
Bond Position:  [9.18888554]


portfolio before change:  [8.62397901]
curr_Stock_Price:  102.57096000409634
curr_Factors:  [1.02570960e+02 3.86112948e-02]
mat_Sqrt:  [[ 2.01549444e+01  0.00000000e+00]
 [-7.85990278e-03  1.80092997e-02]]
grads:  [-0.05237586 41.47488793]
Stock Position:  -0.052375860636834796
Bond Position:  [13.99622132]


portfolio before change:  [8.54635604]
curr_Stock_Price:  104.11981221345654
curr_Factors:  [1.04119812e+02 3.80210659e-02]
mat_Sqrt:  [[ 2.03023130e+01  0.00000000e+00]
 [-7.79959649e-03  1.78711207e-02]]
grads:  [ 1.77084153e-04 -4.31721133e+00]
Stock Position:  0.0001770841528000388
Bond Position:  [8.52791807]


portfolio before change:  [8.54833661]
curr_Stock_Price:  103.26333198531408
curr_Factors:  [1.03263332e+02 3.95942517e-02]
mat_Sqrt:  [[ 2.05476521e+01  0.00000000e+00]
 [-7.95932175e-03  1.82370972e-02]]
grads:  [1.30743137e-02 1.83217465e+01]
Stock Position:  0.013074313668723378
Bond Position:  [7.19823942]


portfolio before change:  [8.55720341]
curr_Stock_Price:  103.80385855697634
curr_Factors:  [1.03803859e+02 3.90454122e-02]
mat_Sqrt:  [[ 2.05115511e+01  0.00000000e+00]
 [-7.90396480e-03  1.81102585e-02]]
grads:  [-0.01624356 -2.19315761]
Stock Position:  -0.01624356319593702
Bond Position:  [10.24334795]


portfolio before change:  [8.58183936]
curr_Stock_Price:  102.4448715261062
curr_Factors:  [1.02444872e+02 3.99041369e-02]
mat_Sqrt:  [[ 2.04644079e+01  0.00000000e+00]
 [-7.99040794e-03  1.83083246e-02]]
grads:  [ 7.08988275e-05 -5.08223117e-01]
Stock Position:  7.089882753321253e-05
Bond Position:  [8.57457614]


portfolio before change:  [8.5839313]
curr_Stock_Price:  101.71174354591514
curr_Factors:  [1.01711744e+02 4.13898241e-02]
mat_Sqrt:  [[ 2.06927347e+01  0.00000000e+00]
 [-8.13779568e-03  1.86460323e-02]]
grads:  [ 0.00418517 -1.05072769]
Stock Position:  0.004185172139425681
Bond Position:  [8.15825014]


portfolio before change:  [8.57792965]
curr_Stock_Price:  99.7903270549522
curr_Factors:  [9.97903271e+01 4.18945449e-02]
mat_Sqrt:  [[ 2.04252408e+01  0.00000000e+00]
 [-8.18726278e-03  1.87593757e-02]]
grads:  [2.07417468e-03 2.29735052e+00]
Stock Position:  0.0020741746797948548
Bond Position:  [8.37094708]


portfolio before change:  [8.57486047]
curr_Stock_Price:  97.30153737626324
curr_Factors:  [9.73015374e+01 4.10811767e-02]
mat_Sqrt:  [[ 1.97215543e+01  0.00000000e+00]
 [-8.10739679e-03  1.85763797e-02]]
grads:  [0.00270966 1.29923982]
Stock Position:  0.0027096601221832163
Bond Position:  [8.31120637]


portfolio before change:  [8.57293478]
curr_Stock_Price:  95.8239547167564
curr_Factors:  [9.58239547e+01 4.13757323e-02]
mat_Sqrt:  [[ 1.94915752e+01  0.00000000e+00]
 [-8.13641025e-03  1.86428579e-02]]
grads:  [-0.01011601 -7.34716253]
Stock Position:  -0.010116009506358917
Bond Position:  [9.54229082]


portfolio before change:  [8.58257322]
curr_Stock_Price:  95.10701489008252
curr_Factors:  [9.51070149e+01 3.98967262e-02]
mat_Sqrt:  [[ 1.89968319e+01  0.00000000e+00]
 [-7.98966594e-03  1.83066245e-02]]
grads:  [ -0.0173974  -16.78301156]
Stock Position:  -0.017397400176741663
Bond Position:  [10.23718802]


portfolio before change:  [8.56790173]
curr_Stock_Price:  96.09745668081925
curr_Factors:  [9.60974567e+01 3.77932459e-02]
mat_Sqrt:  [[ 1.86818117e+01  0.00000000e+00]
 [-7.77619402e-03  1.78174989e-02]]
grads:  [ 8.00933606e-03 -1.69594465e+01]
Stock Position:  0.008009336064914392
Bond Position:  [7.7982249]


portfolio before change:  [8.56511612]
curr_Stock_Price:  95.50622070959307
curr_Factors:  [9.55062207e+01 3.76634068e-02]
mat_Sqrt:  [[ 1.85349518e+01  0.00000000e+00]
 [-7.76282493e-03  1.77868664e-02]]
grads:  [-0.01152646 -9.09074441]
Stock Position:  -0.011526462907758692
Bond Position:  [9.66596503]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.56967975]
Stock Price:  95.31996779457201
PL:  [8.56967975]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 5.25505081e-03  1.55895864e-02]
 [-3.78099031e-01  2.65863419e-01]
 [ 1.00844838e+00 -3.71795957e-01]
 [ 5.73836054e-01 -7.59523664e-02]
 [ 3.38916118e-01 -3.43963095e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-1.89376286e-01 -1.84884211e-01]
 [-1.24897593e+00  7.31917950e-01]
 [ 3.52385927e-02  4.51642986e-03]
 [ 2.24594792e-02 -5.33270007e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 1.21045149e-01 -1.58237107e-01]
 [ 1.10318673e-01 -2.73173555e-02]
 [-5.89289168e-02 -6.59552232e-02]
 [ 7.24762607e-03  5.99846743e-04]
 [-1.42779756e-01 -1.36553251e-01]
 [-1.91731449e-01 -3.72375781e-01]
 [ 2.84344570e-01 -2.52507622e-01]
 [ 8.59153303e-02 -9.53236978e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.59392069]
curr_Stock_Price:  102.10411647963393
curr_Factors:  [1.02104116e+02 4.03735145e-02]
mat_Sqrt:  [[ 2.05159452e+01  0.00000000e+00]
 [-8.03726466e-03  1.84156868e-02]]
grads:  [5.87782040e-04 8.46538416e-01]
Stock Position:  0.0005877820397105649
Bond Position:  [16.53390572]


portfolio before change:  [16.59907926]
curr_Stock_Price:  103.84725311881145
curr_Factors:  [1.03847253e+02 4.08053210e-02]
mat_Sqrt:  [[ 2.09774847e+01  0.00000000e+00]
 [-8.08013079e-03  1.85139055e-02]]
grads:  [-1.24927619e-02  1.43602018e+01]
Stock Position:  -0.012492761933516255
Bond Position:  [17.89641827]


portfolio before change:  [16.59086992]
curr_Stock_Price:  104.86256143937263
curr_Factors:  [1.04862561e+02 3.99533784e-02]
mat_Sqrt:  [[ 2.09602866e+01  0.00000000e+00]
 [-7.99533648e-03  1.83196173e-02]]
grads:  [  0.04037079 -20.29496308]
Stock Position:  0.04037078984115021
Bond Position:  [12.35748549]


portfolio before change:  [16.69139081]
curr_Stock_Price:  107.27596797843543
curr_Factors:  [1.07275968e+02 3.91049097e-02]
mat_Sqrt:  [[ 2.12137812e+01  0.00000000e+00]
 [-7.90998455e-03  1.81240515e-02]]
grads:  [ 0.02548757 -4.1906947 ]
Stock Position:  0.025487569509254585
Bond Position:  [13.95718712]


portfolio before change:  [16.65749977]
curr_Stock_Price:  105.80934038289436
curr_Factors:  [1.05809340e+02 4.19945275e-02]
mat_Sqrt:  [[ 2.16830493e+01  0.00000000e+00]
 [-8.19702654e-03  1.87817473e-02]]
grads:  [ 0.01493814 -1.83136899]
Stock Position:  0.014938135930565744
Bond Position:  [15.07690546]


portfolio before change:  [16.63038099]
curr_Stock_Price:  103.74158055395192
curr_Factors:  [1.03741581e+02 4.28668373e-02]
mat_Sqrt:  [[ 2.14789765e+01  0.00000000e+00]
 [-8.28172324e-03  1.89758118e-02]]
grads:  [-2.69855576e-05 -1.01978120e+00]
Stock Position:  -2.6985557620094444e-05
Bond Position:  [16.63318051]


portfolio before change:  [16.63457486]
curr_Stock_Price:  102.44230812604651
curr_Factors:  [1.02442308e+02 4.31655837e-02]
mat_Sqrt:  [[ 2.12837507e+01  0.00000000e+00]
 [-8.31053150e-03  1.90418198e-02]]
grads:  [-0.01268885 -9.70937717]
Stock Position:  -0.012688852377649173
Bond Position:  [17.93445019]


portfolio before change:  [16.68288235]
curr_Stock_Price:  98.98862210002703
curr_Factors:  [9.89886221e+01 4.24562970e-02]
mat_Sqrt:  [[ 2.03965322e+01  0.00000000e+00]
 [-8.24197034e-03  1.88847265e-02]]
grads:  [-0.04557347 38.75713797]
Stock Position:  -0.04557347008813341
Bond Position:  [21.19413736]


portfolio before change:  [16.84708923]
curr_Stock_Price:  95.50177572952957
curr_Factors:  [9.55017757e+01 4.36590299e-02]
mat_Sqrt:  [[ 1.99548509e+01  0.00000000e+00]
 [-8.35789733e-03  1.91503486e-02]]
grads:  [0.0018647  0.23584061]
Stock Position:  0.0018646956777609125
Bond Position:  [16.66900749]


portfolio before change:  [16.84849153]
curr_Stock_Price:  94.01870452447393
curr_Factors:  [9.40187045e+01 4.28535713e-02]
mat_Sqrt:  [[ 1.94629099e+01  0.00000000e+00]
 [-8.28044166e-03  1.89728753e-02]]
grads:  [-4.18401929e-05 -2.81069683e+00]
Stock Position:  -4.184019291386921e-05
Bond Position:  [16.85242529]


portfolio before change:  [16.85270356]
curr_Stock_Price:  94.05712707471233
curr_Factors:  [9.40571271e+01 4.52411518e-02]
mat_Sqrt:  [[ 2.00059204e+01  0.00000000e+00]
 [-8.50798701e-03  1.94942472e-02]]
grads:  [1.34912264e-02 1.79318952e+01]
Stock Position:  0.013491226399551576
Bond Position:  [15.58375756]


portfolio before change:  [16.83595602]
curr_Stock_Price:  92.52695026610864
curr_Factors:  [9.25269503e+01 4.55917793e-02]
mat_Sqrt:  [[ 1.97565687e+01  0.00000000e+00]
 [-8.54089263e-03  1.95696435e-02]]
grads:  [ 2.63126731e-03 -8.08584516e+00]
Stock Position:  0.0026312673101159087
Bond Position:  [16.59249288]


portfolio before change:  [16.84528148]
curr_Stock_Price:  94.4943735514099
curr_Factors:  [9.44943736e+01 4.46824467e-02]
mat_Sqrt:  [[ 1.99744313e+01  0.00000000e+00]
 [-8.45528916e-03  1.93735013e-02]]
grads:  [ 0.00492612 -1.41003709]
Stock Position:  0.004926117811592792
Bond Position:  [16.37979106]


portfolio before change:  [16.86430524]
curr_Stock_Price:  97.52481311959302
curr_Factors:  [9.75248131e+01 4.50455582e-02]
mat_Sqrt:  [[ 2.06986067e+01  0.00000000e+00]
 [-8.48957556e-03  1.94520613e-02]]
grads:  [-0.00423768 -3.3906547 ]
Stock Position:  -0.004237683106211669
Bond Position:  [17.27758449]


portfolio before change:  [16.86582027]
curr_Stock_Price:  98.18670874274102
curr_Factors:  [9.81867087e+01 4.38886766e-02]
mat_Sqrt:  [[ 2.05697468e+01  0.00000000e+00]
 [-8.37984979e-03  1.92006480e-02]]
grads:  [0.00036507 0.03124096]
Stock Position:  0.00036507112779530365
Bond Position:  [16.82997514]


portfolio before change:  [16.87016132]
curr_Stock_Price:  98.55110579878531
curr_Factors:  [9.85511058e+01 4.49708787e-02]
mat_Sqrt:  [[ 2.08990810e+01  0.00000000e+00]
 [-8.48253534e-03  1.94359301e-02]]
grads:  [-0.00968351 -7.02581509]
Stock Position:  -0.009683511038516928
Bond Position:  [17.82448205]


portfolio before change:  [16.88027015]
curr_Stock_Price:  97.96741772315941
curr_Factors:  [9.79674177e+01 4.43259181e-02]
mat_Sqrt:  [[ 2.06257871e+01  0.00000000e+00]
 [-8.42148852e-03  1.92960543e-02]]
grads:  [-1.71750810e-02 -1.92980272e+01]
Stock Position:  -0.017175080975125278
Bond Position:  [18.56286848]


portfolio before change:  [16.87300704]
curr_Stock_Price:  98.66053868910215
curr_Factors:  [9.86605387e+01 4.48849506e-02]
mat_Sqrt:  [[ 2.09022895e+01  0.00000000e+00]
 [-8.47442747e-03  1.94173527e-02]]
grads:  [ 8.33120262e-03 -1.30042250e+01]
Stock Position:  0.008331202615185274
Bond Position:  [16.0510461]


portfolio before change:  [16.89386789]
curr_Stock_Price:  100.68276592310764
curr_Factors:  [1.00682766e+02 4.29079629e-02]
mat_Sqrt:  [[ 2.08556671e+01  0.00000000e+00]
 [-8.28569494e-03  1.89849121e-02]]
grads:  [ 2.12472982e-03 -5.02102391e+00]
Stock Position:  0.0021247298242672045
Bond Position:  [16.67994421]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.89683115]
Stock Price:  100.11457710458653
PL:  [16.78225404]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 6.57117153e-02  4.36088014e-02]
 [ 4.85771247e-02 -4.76655289e-02]
 [ 6.26814277e-01 -2.55319815e-01]
 [-6.28939413e-02 -9.52395184e-02]
 [ 7.47242948e-02 -1.11377586e-02]
 [ 2.16253131e-02 -8.50686615e-02]
 [-8.18113004e-02 -1.54864289e-01]
 [-1.32229506e+00  7.42076354e-01]
 [ 8.98046530e-02 -7.34530279e-02]
 [ 9.15965513e-02  1.90168921e-01]
 [-1.94760140e-01 -2.67494650e-02]
 [ 2.26137968e-02 -9.04096778e-03]
 [ 1.49587767e-01 -2.09494343e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15897575e-01 -6.16822567e-02]
 [-1.41030021e-01 -1.28696065e-01]
 [-1.66882070e-01 -5.09884620e-01]
 [ 2.59224414e-01 -2.31432708e-01]
 [-3.98477964e-02 -1.35206164e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.35956413]
curr_Stock_Price:  98.19489391667045
curr_Factors:  [9.81948939e+01 4.01453037e-02]
mat_Sqrt:  [[ 1.96746167e+01  0.00000000e+00]
 [-8.01451720e-03  1.83635659e-02]]
grads:  [0.00430728 2.37474583]
Stock Position:  0.00430728374829482
Bond Position:  [-9.7825174]


portfolio before change:  [-9.359095]
curr_Stock_Price:  98.87166754455424
curr_Factors:  [9.88716675e+01 3.92246509e-02]
mat_Sqrt:  [[ 1.95817455e+01  0.00000000e+00]
 [-7.92208567e-03  1.81517786e-02]]
grads:  [ 1.41837113e-03 -2.62594261e+00]
Stock Position:  0.0014183711256439975
Bond Position:  [-9.49933172]


portfolio before change:  [-9.36079358]
curr_Stock_Price:  99.34866205046927
curr_Factors:  [9.93486621e+01 3.74600300e-02]
mat_Sqrt:  [[ 1.92285299e+01  0.00000000e+00]
 [-7.74183750e-03  1.77387782e-02]]
grads:  [  0.02680307 -14.39331461]
Stock Position:  0.026803066878870064
Bond Position:  [-12.02364241]


portfolio before change:  [-9.36675414]
curr_Stock_Price:  99.23844043044197
curr_Factors:  [9.92384404e+01 3.62516202e-02]
mat_Sqrt:  [[ 1.88948584e+01  0.00000000e+00]
 [-7.61594330e-03  1.74503183e-02]]
grads:  [-0.00552848 -5.45775249]
Stock Position:  -0.005528481486615781
Bond Position:  [-8.81811626]


portfolio before change:  [-9.37403585]
curr_Stock_Price:  100.156759073115
curr_Factors:  [1.00156759e+02 3.67198270e-02]
mat_Sqrt:  [[ 1.91924570e+01  0.00000000e+00]
 [-7.66496727e-03  1.75626463e-02]]
grads:  [ 0.00364015 -0.63417314]
Stock Position:  0.0036401477137860817
Bond Position:  [-9.73862125]


portfolio before change:  [-9.3818125]
curr_Stock_Price:  98.68932282447696
curr_Factors:  [9.86893228e+01 3.58103975e-02]
mat_Sqrt:  [[ 1.86756076e+01  0.00000000e+00]
 [-7.56945414e-03  1.73437983e-02]]
grads:  [-8.30050349e-04 -4.90484611e+00]
Stock Position:  -0.0008300503485902377
Bond Position:  [-9.29989539]


portfolio before change:  [-9.38564279]
curr_Stock_Price:  100.50249977992375
curr_Factors:  [1.00502500e+02 3.51989538e-02]
mat_Sqrt:  [[ 1.88556601e+01  0.00000000e+00]
 [-7.50455369e-03  1.71950927e-02]]
grads:  [-7.92332997e-03 -9.00630730e+00]
Stock Position:  -0.00792332996728361
Bond Position:  [-8.58932832]


portfolio before change:  [-9.39075462]
curr_Stock_Price:  100.87661390182659
curr_Factors:  [1.00876614e+02 3.31967721e-02]
mat_Sqrt:  [[ 1.83797002e+01  0.00000000e+00]
 [-7.28799254e-03  1.66988887e-02]]
grads:  [-0.05432223 44.43866686]
Stock Position:  -0.054322234284251474
Bond Position:  [-3.91091157]


portfolio before change:  [-9.33847833]
curr_Stock_Price:  99.89627598894884
curr_Factors:  [9.9896276e+01 3.1924587e-02]
mat_Sqrt:  [[ 1.78489200e+01  0.00000000e+00]
 [-7.14698112e-03  1.63757910e-02]]
grads:  [ 3.23532872e-03 -4.48546442e+00]
Stock Position:  0.00323532871837096
Bond Position:  [-9.66167562]


portfolio before change:  [-9.33537435]
curr_Stock_Price:  101.60234649051215
curr_Factors:  [1.01602346e+02 3.21736024e-02]
mat_Sqrt:  [[ 1.82244144e+01  0.00000000e+00]
 [-7.17480061e-03  1.64395335e-02]]
grads:  [9.58017463e-03 1.15677809e+01]
Stock Position:  0.009580174630758158
Bond Position:  [-10.30874257]


portfolio before change:  [-9.33169798]
curr_Stock_Price:  102.25513970492742
curr_Factors:  [1.0225514e+02 3.0156072e-02]
mat_Sqrt:  [[ 1.77571201e+01  0.00000000e+00]
 [-6.94620149e-03  1.59157471e-02]]
grads:  [-0.01162545 -1.68069177]
Stock Position:  -0.011625452898815763
Bond Position:  [-8.14293567]


portfolio before change:  [-9.31396904]
curr_Stock_Price:  100.55499641585953
curr_Factors:  [1.00554996e+02 3.01897112e-02]
mat_Sqrt:  [[ 1.74716183e+01  0.00000000e+00]
 [-6.95007467e-03  1.59246216e-02]]
grads:  [ 0.00106848 -0.56773517]
Stock Position:  0.0010684754295255789
Bond Position:  [-9.42140958]


portfolio before change:  [-9.3166767]
curr_Stock_Price:  100.22553939605682
curr_Factors:  [1.00225539e+02 3.13210735e-02]
mat_Sqrt:  [[ 1.77376762e+01  0.00000000e+00]
 [-7.07910429e-03  1.62202656e-02]]
grads:  [ 0.00791787 -1.29155926]
Stock Position:  0.00791787398024363
Bond Position:  [-10.11024989]


portfolio before change:  [-9.29452984]
curr_Stock_Price:  103.34187361822642
curr_Factors:  [1.03341874e+02 3.07074390e-02]
mat_Sqrt:  [[ 1.81091527e+01  0.00000000e+00]
 [-7.00941527e-03  1.60605880e-02]]
grads:  [8.40664080e-03 9.25109897e+00]
Stock Position:  0.00840664079907311
Bond Position:  [-10.16328785]


portfolio before change:  [-9.28738567]
curr_Stock_Price:  104.49397545644868
curr_Factors:  [1.04493975e+02 3.16266078e-02]
mat_Sqrt:  [[ 1.85830741e+01  0.00000000e+00]
 [-7.11354852e-03  1.62991873e-02]]
grads:  [-0.00768538 -3.78437622]
Stock Position:  -0.00768537639210527
Bond Position:  [-8.48431014]


portfolio before change:  [-9.26528585]
curr_Stock_Price:  101.34238400119564
curr_Factors:  [1.01342384e+02 3.22419656e-02]
mat_Sqrt:  [[ 1.81970870e+01  0.00000000e+00]
 [-7.18241916e-03  1.64569897e-02]]
grads:  [-0.01083677 -7.82014618]
Stock Position:  -0.010836766839166267
Bond Position:  [-8.16706206]


portfolio before change:  [-9.27250265]
curr_Stock_Price:  101.81990462570957
curr_Factors:  [1.01819905e+02 3.26850446e-02]
mat_Sqrt:  [[ 1.84080263e+01  0.00000000e+00]
 [-7.23160226e-03  1.65696824e-02]]
grads:  [-2.11545744e-02 -3.07721420e+01]
Stock Position:  -0.021154574361012406
Bond Position:  [-7.1185459]


portfolio before change:  [-9.25161127]
curr_Stock_Price:  100.74821039434832
curr_Factors:  [1.00748210e+02 3.36694367e-02]
mat_Sqrt:  [[ 1.84865243e+01  0.00000000e+00]
 [-7.33969337e-03  1.68173502e-02]]
grads:  [ 8.55860718e-03 -1.37615442e+01]
Stock Position:  0.00855860717692625
Bond Position:  [-10.11387563]


portfolio before change:  [-9.27920335]
curr_Stock_Price:  97.81977863003327
curr_Factors:  [9.78197786e+01 3.47590934e-02]
mat_Sqrt:  [[ 1.82373149e+01  0.00000000e+00]
 [-7.45751631e-03  1.70873165e-02]]
grads:  [-5.42056794e-03 -7.91266226e+00]
Stock Position:  -0.0054205679408760666
Bond Position:  [-8.7489646]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.27205896]
Stock Price:  96.09820552964507
PL:  [-9.27205896]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.28811485e-02  1.22967002e-01]
 [ 5.41253382e-02 -3.93281532e-02]
 [ 7.55397712e-01 -2.94563955e-01]
 [ 2.89050731e-01 -9.06444955e-02]
 [ 5.27109063e-04 -1.39340532e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-8.07165002e-02 -1.53291520e-01]
 [-1.29844019e+00  7.39928103e-01]
 [ 8.50899585e-02 -7.45433945e-02]
 [ 3.24251984e-02 -5.89455205e-02]
 [-1.55577254e-01 -5.92716187e-02]
 [ 2.32158771e-02 -9.03168253e-03]
 [ 2.70240640e-02 -4.54209403e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15942896e-01 -6.17079789e-02]
 [-7.13285672e-02 -9.47805843e-02]
 [-1.48268887e-01 -5.81851112e-01]
 [ 1.34030538e-02 -1.75385961e-01]
 [ 1.45576412e-01  3.87131705e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.74414372]
curr_Stock_Price:  99.86738088936676
curr_Factors:  [9.98673809e+01 4.03357204e-02]
mat_Sqrt:  [[ 2.00571198e+01  0.00000000e+00]
 [-8.03350190e-03  1.84070653e-02]]
grads:  [3.31794139e-03 6.68042408e+00]
Stock Position:  0.0033179413887935707
Bond Position:  [1.4127896]


portfolio before change:  [1.74336565]
curr_Stock_Price:  99.52641316958437
curr_Factors:  [9.95264132e+01 3.88730476e-02]
mat_Sqrt:  [[ 1.96228755e+01  0.00000000e+00]
 [-7.88649962e-03  1.80702407e-02]]
grads:  [ 1.88357333e-03 -2.17640450e+00]
Stock Position:  0.0018835733309014863
Bond Position:  [1.55590035]


portfolio before change:  [1.74735788]
curr_Stock_Price:  101.43937450008407
curr_Factors:  [1.01439375e+02 3.79041023e-02]
mat_Sqrt:  [[ 1.97492074e+01  0.00000000e+00]
 [-7.78759036e-03  1.78436112e-02]]
grads:  [  0.03173998 -16.50809093]
Stock Position:  0.03173998074247935
Bond Position:  [-1.47232592]


portfolio before change:  [1.77503403]
curr_Stock_Price:  102.32293766163454
curr_Factors:  [1.02322938e+02 3.67363305e-02]
mat_Sqrt:  [[ 1.96119550e+01  0.00000000e+00]
 [-7.66668956e-03  1.75665926e-02]]
grads:  [ 0.01272133 -5.16004996]
Stock Position:  0.012721334036499275
Bond Position:  [0.47334976]


portfolio before change:  [1.75947486]
curr_Stock_Price:  101.0905577954678
curr_Factors:  [1.01090558e+02 3.63417475e-02]
mat_Sqrt:  [[ 1.92714102e+01  0.00000000e+00]
 [-7.62540464e-03  1.74719970e-02]]
grads:  [-2.88209855e-04 -7.97507764e-01]
Stock Position:  -0.00028820985486166935
Bond Position:  [1.78861016]


portfolio before change:  [1.75963735]
curr_Stock_Price:  102.0784691689718
curr_Factors:  [1.02078469e+02 3.58330263e-02]
mat_Sqrt:  [[ 1.93230596e+01  0.00000000e+00]
 [-7.57184536e-03  1.73492772e-02]]
grads:  [-2.99963965e-05 -1.11538803e+00]
Stock Position:  -2.9996396517790426e-05
Bond Position:  [1.76269933]


portfolio before change:  [1.7601269]
curr_Stock_Price:  100.450760241458
curr_Factors:  [1.00450760e+02 3.45534414e-02]
mat_Sqrt:  [[ 1.86723458e+01  0.00000000e+00]
 [-7.43542240e-03  1.70366930e-02]]
grads:  [-7.90572357e-03 -8.99772746e+00]
Stock Position:  -0.007905723574717938
Bond Position:  [2.55426285]


portfolio before change:  [1.76247658]
curr_Stock_Price:  100.23433067871825
curr_Factors:  [1.00234331e+02 3.28456901e-02]
mat_Sqrt:  [[ 1.81658486e+01  0.00000000e+00]
 [-7.24935198e-03  1.66103521e-02]]
grads:  [-0.05370017 44.5462022 ]
Stock Position:  -0.053700166590884855
Bond Position:  [7.14507684]


portfolio before change:  [1.76740635]
curr_Stock_Price:  100.1757968870627
curr_Factors:  [1.00175797e+02 3.30210651e-02]
mat_Sqrt:  [[ 1.82036445e+01  0.00000000e+00]
 [-7.26867967e-03  1.66546374e-02]]
grads:  [ 2.88714461e-03 -4.47583413e+00]
Stock Position:  0.002887144609114486
Bond Position:  [1.47818433]


portfolio before change:  [1.76657483]
curr_Stock_Price:  99.75977770665979
curr_Factors:  [9.97597777e+01 3.31602334e-02]
mat_Sqrt:  [[ 1.81662071e+01  0.00000000e+00]
 [-7.28398060e-03  1.66896962e-02]]
grads:  [ 3.68776162e-04 -3.53185101e+00]
Stock Position:  0.000368776161553208
Bond Position:  [1.7297858]


portfolio before change:  [1.76771617]
curr_Stock_Price:  101.68191792548161
curr_Factors:  [1.01681918e+02 3.17469149e-02]
mat_Sqrt:  [[ 1.81173424e+01  0.00000000e+00]
 [-7.12706558e-03  1.63301588e-02]]
grads:  [-0.01001502 -3.62958007]
Stock Position:  -0.010015017901288751
Bond Position:  [2.7860624]


portfolio before change:  [1.78054873]
curr_Stock_Price:  100.47014246531965
curr_Factors:  [1.00470142e+02 3.09658877e-02]
mat_Sqrt:  [[ 1.76798585e+01  0.00000000e+00]
 [-7.03885078e-03  1.61280332e-02]]
grads:  [ 0.00109017 -0.559999  ]
Stock Position:  0.0010901743159483766
Bond Position:  [1.67101876]


portfolio before change:  [1.78431642]
curr_Stock_Price:  103.54294245967448
curr_Factors:  [1.03542942e+02 3.08780041e-02]
mat_Sqrt:  [[ 1.81947090e+01  0.00000000e+00]
 [-7.02885528e-03  1.61051307e-02]]
grads:  [ 3.95760136e-04 -2.82027766e+00]
Stock Position:  0.0003957601362232277
Bond Position:  [1.74333825]


portfolio before change:  [1.78468275]
curr_Stock_Price:  103.3671741093071
curr_Factors:  [1.03367174e+02 3.18091374e-02]
mat_Sqrt:  [[ 1.84356557e+01  0.00000000e+00]
 [-7.13404652e-03  1.63461541e-02]]
grads:  [8.25775573e-03 9.08948297e+00]
Stock Position:  0.008257755731391604
Bond Position:  [0.93110187]


portfolio before change:  [1.79335489]
curr_Stock_Price:  104.3891632568676
curr_Factors:  [1.04389163e+02 3.14334991e-02]
mat_Sqrt:  [[ 1.85076714e+01  0.00000000e+00]
 [-7.09179798e-03  1.62493505e-02]]
grads:  [-0.00771974 -3.79756586]
Stock Position:  -0.0077197429630349096
Bond Position:  [2.5992124]


portfolio before change:  [1.78829296]
curr_Stock_Price:  105.12906047806746
curr_Factors:  [1.05129060e+02 3.23178145e-02]
mat_Sqrt:  [[ 1.88992154e+01  0.00000000e+00]
 [-7.19086247e-03  1.64763358e-02]]
grads:  [-0.0059629  -5.75252808]
Stock Position:  -0.005962903917318584
Bond Position:  [2.41516744]


portfolio before change:  [1.79346027]
curr_Stock_Price:  104.36375404828419
curr_Factors:  [1.04363754e+02 3.04660798e-02]
mat_Sqrt:  [[ 1.82162082e+01  0.00000000e+00]
 [-6.98181407e-03  1.59973457e-02]]
grads:  [-2.20797614e-02 -3.63717283e+01]
Stock Position:  -0.02207976144587785
Bond Position:  [4.09778707]


portfolio before change:  [1.83526355]
curr_Stock_Price:  102.51687244684612
curr_Factors:  [1.02516872e+02 2.99942548e-02]
mat_Sqrt:  [[ 1.77547429e+01  0.00000000e+00]
 [-6.92753981e-03  1.58729878e-02]]
grads:  [-3.55632607e-03 -1.10493351e+01]
Stock Position:  -0.0035563260689318982
Bond Position:  [2.19984698]


portfolio before change:  [1.83293807]
curr_Stock_Price:  103.32543434486986
curr_Factors:  [1.03325434e+02 3.04779212e-02]
mat_Sqrt:  [[ 1.80384788e+01  0.00000000e+00]
 [-6.98317077e-03  1.60004543e-02]]
grads:  [0.00900698 2.41950445]
Stock Position:  0.00900698038734563
Bond Position:  [0.90228791]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.83519392]
Stock Price:  103.55084254922456
PL:  [-1.71564863]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.73523833e-02  1.23007804e-01]
 [ 7.49171300e-02 -9.32480291e-03]
 [ 8.62564940e-01 -3.27271790e-01]
 [ 2.68257735e-01 -9.71289657e-02]
 [ 5.17692530e-02 -1.86776117e-02]
 [ 3.98533251e-02 -2.92239125e-02]
 [-5.60464696e-02 -1.17860287e-01]
 [-1.26115802e+00  7.35510382e-01]
 [ 8.80400347e-02 -7.08767983e-02]
 [ 6.79710512e-02  8.70003996e-02]
 [-3.11773836e-01 -3.80797686e-02]
 [-4.03520954e-02 -1.37962722e-02]
 [ 2.17756732e-02 -4.91218554e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.16536454e-01 -6.20448547e-02]
 [-1.20235172e-01 -1.15505236e-01]
 [-1.47971864e-01 -5.79586068e-01]
 [-2.27681219e-01 -4.83355674e-02]
 [ 1.32481065e-01  1.29497374e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.91447865]
curr_Stock_Price:  100.04366163788178
curr_Factors:  [1.00043662e+02 4.08783762e-02]
mat_Sqrt:  [[ 2.02272293e+01  0.00000000e+00]
 [-8.08736063e-03  1.85304711e-02]]
grads:  [4.00635149e-03 6.63813688e+00]
Stock Position:  0.004006351494212253
Bond Position:  [2.51366858]


portfolio before change:  [2.9193243]
curr_Stock_Price:  101.09627704355209
curr_Factors:  [1.01096277e+02 4.09973929e-02]
mat_Sqrt:  [[ 2.04697851e+01  0.00000000e+00]
 [-8.09912518e-03  1.85574271e-02]]
grads:  [ 0.00346107 -0.50248361]
Stock Position:  0.003461074560055876
Bond Position:  [2.56942254]


portfolio before change:  [2.92680406]
curr_Stock_Price:  103.07177095717384
curr_Factors:  [1.03071771e+02 3.92244353e-02]
mat_Sqrt:  [[ 2.04135289e+01  0.00000000e+00]
 [-7.92206390e-03  1.81517287e-02]]
grads:  [  0.03525759 -18.02978631]
Stock Position:  0.035257589449164635
Bond Position:  [-0.70725812]


portfolio before change:  [2.89082287]
curr_Stock_Price:  102.05626307824873
curr_Factors:  [1.02056263e+02 4.21679743e-02]
mat_Sqrt:  [[ 2.09570926e+01  0.00000000e+00]
 [-8.21393687e-03  1.88204937e-02]]
grads:  [ 0.0107776  -5.16080859]
Stock Position:  0.010777600849393502
Bond Position:  [1.7909012]


portfolio before change:  [2.88589634]
curr_Stock_Price:  101.55760733054444
curr_Factors:  [1.01557607e+02 4.13013938e-02]
mat_Sqrt:  [[ 2.06392929e+01  0.00000000e+00]
 [-8.12909774e-03  1.86261029e-02]]
grads:  [ 0.00211333 -1.00276541]
Stock Position:  0.002113331848040677
Bond Position:  [2.67127141]


portfolio before change:  [2.88431374]
curr_Stock_Price:  100.49270254652363
curr_Factors:  [1.00492703e+02 4.04668816e-02]
mat_Sqrt:  [[ 2.02154957e+01  0.00000000e+00]
 [-8.04655271e-03  1.84369684e-02]]
grads:  [ 1.34050455e-03 -1.58507146e+00]
Stock Position:  0.0013405045531350156
Bond Position:  [2.74960282]


portfolio before change:  [2.88332442]
curr_Stock_Price:  99.24182178053977
curr_Factors:  [9.92418218e+01 4.22275752e-02]
mat_Sqrt:  [[ 2.03935485e+01  0.00000000e+00]
 [-8.21973967e-03  1.88337896e-02]]
grads:  [-5.27053524e-03 -6.25791674e+00]
Stock Position:  -0.005270535243575486
Bond Position:  [3.40638194]


portfolio before change:  [2.88311853]
curr_Stock_Price:  99.44248270544168
curr_Factors:  [9.94424827e+01 4.22193045e-02]
mat_Sqrt:  [[ 2.04327817e+01  0.00000000e+00]
 [-8.21893468e-03  1.88319451e-02]]
grads:  [-0.04601209 39.05652744]
Stock Position:  -0.04601208906008374
Bond Position:  [7.4586749]


portfolio before change:  [2.87087318]
curr_Stock_Price:  99.74914672058762
curr_Factors:  [9.97491467e+01 4.49874820e-02]
mat_Sqrt:  [[ 2.11570461e+01  0.00000000e+00]
 [-8.48410108e-03  1.94395177e-02]]
grads:  [ 2.6991889e-03 -3.6460163e+00]
Stock Position:  0.0026991888983475664
Bond Position:  [2.60163139]


portfolio before change:  [2.87429713]
curr_Stock_Price:  100.77666464439076
curr_Factors:  [1.00776665e+02 4.41078199e-02]
mat_Sqrt:  [[ 2.11649758e+01  0.00000000e+00]
 [-8.40074472e-03  1.92485243e-02]]
grads:  [0.00500549 4.51984777]
Stock Position:  0.005005493006719986
Bond Position:  [2.36986024]


portfolio before change:  [2.88978344]
curr_Stock_Price:  103.75214912406837
curr_Factors:  [1.03752149e+02 4.20433465e-02]
mat_Sqrt:  [[ 2.12738327e+01  0.00000000e+00]
 [-8.20178970e-03  1.87926611e-02]]
grads:  [-0.01543649 -2.02631061]
Stock Position:  -0.015436485489112
Bond Position:  [4.49135198]


portfolio before change:  [2.86658184]
curr_Stock_Price:  105.32793359782175
curr_Factors:  [1.05327934e+02 4.17655799e-02]
mat_Sqrt:  [[ 2.15254789e+01  0.00000000e+00]
 [-8.17465155e-03  1.87304797e-02]]
grads:  [-0.00215434 -0.73656801]
Stock Position:  -0.0021543438102258755
Bond Position:  [3.09349442]


portfolio before change:  [2.87055957]
curr_Stock_Price:  103.84058717384937
curr_Factors:  [1.03840587e+02 4.38304543e-02]
mat_Sqrt:  [[ 2.17397788e+01  0.00000000e+00]
 [-8.37428963e-03  1.91879081e-02]]
grads:  [ 1.55078826e-05 -2.56004225e+00]
Stock Position:  1.5507882633456793e-05
Bond Position:  [2.86894922]


portfolio before change:  [2.87128936]
curr_Stock_Price:  104.64460091523007
curr_Factors:  [1.04644601e+02 4.35362649e-02]
mat_Sqrt:  [[ 2.18344577e+01  0.00000000e+00]
 [-8.34613826e-03  1.91234052e-02]]
grads:  [6.97233446e-03 7.76943688e+00]
Stock Position:  0.006972334463385119
Bond Position:  [2.14167221]


portfolio before change:  [2.86032265]
curr_Stock_Price:  102.9949096759916
curr_Factors:  [1.02994910e+02 4.37043854e-02]
mat_Sqrt:  [[ 2.15316975e+01  0.00000000e+00]
 [-8.36223753e-03  1.91602932e-02]]
grads:  [-0.00666994 -3.23819964]
Stock Position:  -0.006669936205804602
Bond Position:  [3.54729213]


portfolio before change:  [2.85958093]
curr_Stock_Price:  103.2390881518788
curr_Factors:  [1.03239088e+02 4.27432304e-02]
mat_Sqrt:  [[ 2.13440992e+01  0.00000000e+00]
 [-8.26977440e-03  1.89484336e-02]]
grads:  [-0.00799499 -6.09576702]
Stock Position:  -0.007994986743220333
Bond Position:  [3.68497607]


portfolio before change:  [2.85099238]
curr_Stock_Price:  104.4285721888477
curr_Factors:  [1.04428572e+02 4.14352519e-02]
mat_Sqrt:  [[ 2.12571155e+01  0.00000000e+00]
 [-8.14226032e-03  1.86562621e-02]]
grads:  [-1.88606946e-02 -3.10665697e+01]
Stock Position:  -0.018860694554104922
Bond Position:  [4.82058778]


portfolio before change:  [2.84521459]
curr_Stock_Price:  104.79881775163372
curr_Factors:  [1.04798818e+02 4.18774175e-02]
mat_Sqrt:  [[ 2.14460014e+01  0.00000000e+00]
 [-8.18558904e-03  1.87555407e-02]]
grads:  [-0.01160014 -2.57713537]
Stock Position:  -0.011600138675171241
Bond Position:  [4.06089541]


portfolio before change:  [2.87642814]
curr_Stock_Price:  102.19555529424638
curr_Factors:  [1.02195555e+02 4.36014937e-02]
mat_Sqrt:  [[ 2.13394239e+01  0.00000000e+00]
 [-8.35238827e-03  1.91377257e-02]]
grads:  [0.00647313 0.6766602 ]
Stock Position:  0.00647312665138807
Bond Position:  [2.21490337]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.87927678]
Stock Price:  102.55007425940244
PL:  [0.32920253]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.53838363e-02  8.93332511e-02]
 [ 7.75305512e-03  2.84849266e-02]
 [ 8.80448845e-01 -3.32730024e-01]
 [ 4.68758906e-01 -5.67680825e-02]
 [ 3.39038754e-01 -3.43933479e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-7.08935193e-01 -3.14476083e-02]
 [-1.54454437e+00  6.73534400e-01]
 [ 9.83940249e-05 -6.89010154e-02]
 [ 1.86894768e-01  8.79219088e-01]
 [-6.70106958e-01 -1.68361126e-01]
 [-4.09484387e-02 -1.04170786e-01]
 [-6.74242749e-02 -1.12347499e-01]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.13420353e-01 -6.02763003e-02]
 [ 1.07706984e-01  2.74941266e-02]
 [-1.26659874e-01 -6.62481379e-01]
 [-4.15148162e-01  6.03848036e-02]
 [-3.72051884e-02 -8.37665801e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.83347524]
curr_Stock_Price:  100.33270893997026
curr_Factors:  [1.00332709e+02 4.03220989e-02]
mat_Sqrt:  [[ 2.01471724e+01  0.00000000e+00]
 [-8.03214530e-03  1.84039569e-02]]
grads:  [3.19509170e-03 4.85402414e+00]
Stock Position:  0.003195091703663531
Bond Position:  [4.51290304]


portfolio before change:  [4.83900095]
curr_Stock_Price:  101.7089892951685
curr_Factors:  [1.01708989e+02 3.70876992e-02]
mat_Sqrt:  [[ 1.95872869e+01  0.00000000e+00]
 [-7.70326675e-03  1.76504015e-02]]
grads:  [1.03051007e-03 1.61384015e+00]
Stock Position:  0.0010305100652589563
Bond Position:  [4.73418881]


portfolio before change:  [4.84211156]
curr_Stock_Price:  103.57885030303396
curr_Factors:  [1.03578850e+02 3.63756041e-02]
mat_Sqrt:  [[ 1.97549618e+01  0.00000000e+00]
 [-7.62895579e-03  1.74801337e-02]]
grads:  [  0.03721767 -19.03475283]
Stock Position:  0.03721766545006222
Bond Position:  [0.98714856]


portfolio before change:  [4.8963162]
curr_Stock_Price:  105.02864094239793
curr_Factors:  [1.05028641e+02 3.46196476e-02]
mat_Sqrt:  [[ 1.95420026e+01  0.00000000e+00]
 [-7.44254231e-03  1.70530068e-02]]
grads:  [ 0.02271944 -3.32891925]
Stock Position:  0.022719436304213893
Bond Position:  [2.51012468]


portfolio before change:  [4.91484242]
curr_Stock_Price:  105.8164516451951
curr_Factors:  [1.05816452e+02 3.52810932e-02]
mat_Sqrt:  [[ 1.98757814e+01  0.00000000e+00]
 [-7.51330481e-03  1.72151440e-02]]
grads:  [ 0.01630267 -1.99785421]
Stock Position:  0.016302668070665348
Bond Position:  [3.18975194]


portfolio before change:  [4.90660857]
curr_Stock_Price:  105.26246915088845
curr_Factors:  [1.05262469e+02 3.38977086e-02]
mat_Sqrt:  [[ 1.93802210e+01  0.00000000e+00]
 [-7.36453215e-03  1.68742630e-02]]
grads:  [-2.99079230e-05 -1.14678645e+00]
Stock Position:  -2.9907923023744717e-05
Bond Position:  [4.90975675]


portfolio before change:  [4.9077733]
curr_Stock_Price:  107.36415027607056
curr_Factors:  [1.07364150e+02 3.47732415e-02]
mat_Sqrt:  [[ 2.00208208e+01  0.00000000e+00]
 [-7.45903387e-03  1.70907937e-02]]
grads:  [-0.03609543 -1.84003206]
Stock Position:  -0.03609542586283078
Bond Position:  [8.78312803]


portfolio before change:  [4.90493129]
curr_Stock_Price:  107.50372667887022
curr_Factors:  [1.07503727e+02 3.64327288e-02]
mat_Sqrt:  [[ 2.05196227e+01  0.00000000e+00]
 [-7.63494375e-03  1.74938538e-02]]
grads:  [-0.06094605 38.50120198]
Stock Position:  -0.0609460457121849
Bond Position:  [11.45685833]


portfolio before change:  [4.94771466]
curr_Stock_Price:  106.84874077301913
curr_Factors:  [1.06848741e+02 3.70794020e-02]
mat_Sqrt:  [[ 2.05748070e+01  0.00000000e+00]
 [-7.70240503e-03  1.76484270e-02]]
grads:  [-1.45675604e-03 -3.90408818e+00]
Stock Position:  -0.0014567560444624307
Bond Position:  [5.10336721]


portfolio before change:  [4.94739648]
curr_Stock_Price:  107.94308114502623
curr_Factors:  [1.07943081e+02 3.56631018e-02]
mat_Sqrt:  [[ 2.03847020e+01  0.00000000e+00]
 [-7.55387072e-03  1.73080922e-02]]
grads:  [2.79924346e-02 5.07981515e+01]
Stock Position:  0.02799243456300501
Bond Position:  [1.92580684]


portfolio before change:  [4.95933968]
curr_Stock_Price:  108.35253788810209
curr_Factors:  [1.08352538e+02 3.70096201e-02]
mat_Sqrt:  [[ 2.08447361e+01  0.00000000e+00]
 [-7.69515381e-03  1.76318124e-02]]
grads:  [-0.03567259 -9.54871354]
Stock Position:  -0.035672592490572336
Bond Position:  [8.82455561]


portfolio before change:  [4.96609303]
curr_Stock_Price:  108.22507493279113
curr_Factors:  [1.08225075e+02 3.86769926e-02]
mat_Sqrt:  [[ 2.12840487e+01  0.00000000e+00]
 [-7.86658682e-03  1.80246148e-02]]
grads:  [-4.05995580e-03 -5.77936267e+00]
Stock Position:  -0.00405995579722154
Bond Position:  [5.40548205]


portfolio before change:  [4.96660818]
curr_Stock_Price:  108.43108514482495
curr_Factors:  [1.08431085e+02 3.88295734e-02]
mat_Sqrt:  [[ 2.13665849e+01  0.00000000e+00]
 [-7.88208839e-03  1.80601333e-02]]
grads:  [-5.45041445e-03 -6.22074582e+00]
Stock Position:  -0.00545041445126378
Bond Position:  [5.55760253]


portfolio before change:  [4.96174698]
curr_Stock_Price:  109.57792865161625
curr_Factors:  [1.09577929e+02 3.78217823e-02]
mat_Sqrt:  [[ 2.13105217e+01  0.00000000e+00]
 [-7.77912924e-03  1.78242243e-02]]
grads:  [7.14375480e-03 8.33573944e+00]
Stock Position:  0.0071437548004805815
Bond Position:  [4.17894913]


portfolio before change:  [4.96743761]
curr_Stock_Price:  110.22825363723635
curr_Factors:  [1.10228254e+02 3.85306190e-02]
mat_Sqrt:  [[ 2.16369439e+01  0.00000000e+00]
 [-7.85168710e-03  1.79904752e-02]]
grads:  [-0.0064578  -3.35045625]
Stock Position:  -0.006457801402045156
Bond Position:  [5.67926978]


portfolio before change:  [4.96864612]
curr_Stock_Price:  110.26100264843288
curr_Factors:  [1.10261003e+02 3.75386545e-02]
mat_Sqrt:  [[ 2.13629532e+01  0.00000000e+00]
 [-7.74995788e-03  1.77573843e-02]]
grads:  [0.00560346 1.54832075]
Stock Position:  0.005603457695792676
Bond Position:  [4.35080325]


portfolio before change:  [4.95805421]
curr_Stock_Price:  108.17662082518784
curr_Factors:  [1.08176621e+02 3.63376735e-02]
mat_Sqrt:  [[ 2.06211067e+01  0.00000000e+00]
 [-7.62497722e-03  1.74710176e-02]]
grads:  [-2.01633432e-02 -3.79188776e+01]
Stock Position:  -0.02016334316354242
Bond Position:  [7.13925654]


portfolio before change:  [4.95915922]
curr_Stock_Price:  108.21034646317638
curr_Factors:  [1.08210346e+02 3.83772581e-02]
mat_Sqrt:  [[ 2.11985306e+01  0.00000000e+00]
 [-7.83604574e-03  1.79546364e-02]]
grads:  [-0.01834061  3.36318722]
Stock Position:  -0.018340614279476346
Bond Position:  [6.94380345]


portfolio before change:  [4.93383128]
curr_Stock_Price:  109.68598460611118
curr_Factors:  [1.09685985e+02 3.85474782e-02]
mat_Sqrt:  [[ 2.15352106e+01  0.00000000e+00]
 [-7.85340468e-03  1.79944107e-02]]
grads:  [-3.42527048e-03 -4.65514439e+00]
Stock Position:  -0.003425270478246226
Bond Position:  [5.30953545]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.92804782]
Stock Price:  111.76202751775453
PL:  [-6.83397969]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [-7.30963096e-04  1.22900774e-01]
 [ 4.66873711e-02 -5.05052874e-02]
 [ 4.70928269e-01 -2.07742829e-01]
 [-1.10481150e-01 -1.22447672e-01]
 [ 2.74262155e-01 -8.72880715e-03]
 [-2.86536710e-01 -3.21329115e-01]
 [-9.46439521e-02 -7.63275384e-02]
 [-1.29982718e+00  6.55823299e-01]
 [ 2.74022185e-02  1.57074019e-02]
 [ 2.01212963e-02 -6.45949488e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 8.60200507e-02 -8.07131637e-02]
 [ 5.66504618e-02  4.22424529e-02]
 [-1.32299866e-01 -2.25943445e-01]
 [ 1.89043108e-01  2.99553205e-01]
 [ 9.96482363e-03 -9.61895037e-02]
 [-2.02012180e-01 -2.29110338e-01]
 [ 4.98087930e-01 -5.09991206e-01]
 [-4.22750129e-01 -2.33466607e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.64491979]
curr_Stock_Price:  99.7018111772673
curr_Factors:  [9.97018112e+01 3.92421701e-02]
mat_Sqrt:  [[ 1.97505664e+01  0.00000000e+00]
 [-7.92385463e-03  1.81558318e-02]]
grads:  [2.67877543e-03 6.76921747e+00]
Stock Position:  0.0026787754291833577
Bond Position:  [0.37784102]


portfolio before change:  [0.64215478]
curr_Stock_Price:  98.63435360589965
curr_Factors:  [9.86343536e+01 4.10764962e-02]
mat_Sqrt:  [[ 1.99905572e+01  0.00000000e+00]
 [-8.10693493e-03  1.85753215e-02]]
grads:  [ 1.23283490e-03 -2.71894553e+00]
Stock Position:  0.0012328349019004874
Bond Position:  [0.5205549]


portfolio before change:  [0.63932257]
curr_Stock_Price:  96.23146821291276
curr_Factors:  [9.62314682e+01 4.30694167e-02]
mat_Sqrt:  [[ 1.99710826e+01  0.00000000e+00]
 [-8.30126898e-03  1.90205967e-02]]
grads:  [  0.01904062 -10.92199323]
Stock Position:  0.01904062359384621
Bond Position:  [-1.19298459]


portfolio before change:  [0.65894777]
curr_Stock_Price:  97.27783515254109
curr_Factors:  [9.72778352e+01 4.35205528e-02]
mat_Sqrt:  [[ 2.02936936e+01  0.00000000e+00]
 [-8.34463208e-03  1.91199541e-02]]
grads:  [-0.00807747 -6.40418235]
Stock Position:  -0.008077469737044596
Bond Position:  [1.44470654]


portfolio before change:  [0.65434058]
curr_Stock_Price:  97.89292950129409
curr_Factors:  [9.78929295e+01 4.23231926e-02]
mat_Sqrt:  [[ 2.01391221e+01  0.00000000e+00]
 [-8.22904054e-03  1.88551006e-02]]
grads:  [ 0.01342921 -0.46294143]
Stock Position:  0.013429214491285356
Bond Position:  [-0.66028456]


portfolio before change:  [0.62256732]
curr_Stock_Price:  95.5392424361872
curr_Factors:  [9.55392424e+01 4.46392011e-02]
mat_Sqrt:  [[ 2.01855227e+01  0.00000000e+00]
 [-8.45119647e-03  1.93641238e-02]]
grads:  [ -0.02114269 -16.59404366]
Stock Position:  -0.02114268918361781
Bond Position:  [2.64252383]


portfolio before change:  [0.65542578]
curr_Stock_Price:  94.01636389239751
curr_Factors:  [9.40163639e+01 4.36249960e-02]
mat_Sqrt:  [[ 1.96368196e+01  0.00000000e+00]
 [-8.35463905e-03  1.91428829e-02]]
grads:  [-0.00651613 -3.9872541 ]
Stock Position:  -0.006516127528008566
Bond Position:  [1.2680484]


portfolio before change:  [0.64331758]
curr_Stock_Price:  95.9232101332116
curr_Factors:  [9.59232101e+01 4.32437619e-02]
mat_Sqrt:  [[ 1.99473606e+01  0.00000000e+00]
 [-8.31805380e-03  1.90590556e-02]]
grads:  [-0.05081386 34.41006277]
Stock Position:  -0.05081386216646929
Bond Position:  [5.51754636]


portfolio before change:  [0.69815087]
curr_Stock_Price:  94.87125843726287
curr_Factors:  [9.48712584e+01 4.38562750e-02]
mat_Sqrt:  [[ 1.98678344e+01  0.00000000e+00]
 [-8.37675594e-03  1.91935591e-02]]
grads:  [0.00172427 0.81836838]
Stock Position:  0.0017242689871459949
Bond Position:  [0.5345673]


portfolio before change:  [0.6988374]
curr_Stock_Price:  95.19189761404805
curr_Factors:  [9.51918976e+01 4.21839856e-02]
mat_Sqrt:  [[ 1.95512167e+01  0.00000000e+00]
 [-8.21549614e-03  1.88240665e-02]]
grads:  [-4.12774849e-04 -3.43150875e+00]
Stock Position:  -0.00041277484945817744
Bond Position:  [0.73813022]


portfolio before change:  [0.69992771]
curr_Stock_Price:  92.9975909387034
curr_Factors:  [9.29975909e+01 4.44015970e-02]
mat_Sqrt:  [[ 1.95961608e+01  0.00000000e+00]
 [-8.42867458e-03  1.93125196e-02]]
grads:  [1.37733306e-02 1.81006313e+01]
Stock Position:  0.013773330619935346
Bond Position:  [-0.58095886]


portfolio before change:  [0.7182703]
curr_Stock_Price:  94.33988426549215
curr_Factors:  [9.43398843e+01 4.23178077e-02]
mat_Sqrt:  [[ 1.94069336e+01  0.00000000e+00]
 [-8.22851702e-03  1.88539010e-02]]
grads:  [ 2.61730880e-03 -4.28097949e+00]
Stock Position:  0.0026173088002895803
Bond Position:  [0.47135369]


portfolio before change:  [0.71194862]
curr_Stock_Price:  91.87952154170566
curr_Factors:  [9.18795215e+01 4.23105296e-02]
mat_Sqrt:  [[ 1.88991797e+01  0.00000000e+00]
 [-8.22780939e-03  1.88522797e-02]]
grads:  [0.00397301 2.24070795]
Stock Position:  0.003973007329390853
Bond Position:  [0.34691061]


portfolio before change:  [0.70301481]
curr_Stock_Price:  89.60906169167635
curr_Factors:  [8.96090617e+01 4.40692249e-02]
mat_Sqrt:  [[ 1.88113358e+01  0.00000000e+00]
 [-8.39706852e-03  1.92401011e-02]]
grads:  [ -0.01227503 -11.74336064]
Stock Position:  -0.01227502780230821
Bond Position:  [1.80296853]


portfolio before change:  [0.69616622]
curr_Stock_Price:  90.20371542881152
curr_Factors:  [9.02037154e+01 4.35359336e-02]
mat_Sqrt:  [[ 1.88212454e+01  0.00000000e+00]
 [-8.34610651e-03  1.91233324e-02]]
grads:  [ 0.01699031 15.66427854]
Stock Position:  0.016990312684769398
Bond Position:  [-0.83642311]


portfolio before change:  [0.68746341]
curr_Stock_Price:  89.7038025870869
curr_Factors:  [8.97038026e+01 4.31363946e-02]
mat_Sqrt:  [[ 1.86308545e+01  0.00000000e+00]
 [-8.30772119e-03  1.90353806e-02]]
grads:  [-1.71842453e-03 -5.05319572e+00]
Stock Position:  -0.001718424533118456
Bond Position:  [0.84161262]


portfolio before change:  [0.6841509]
curr_Stock_Price:  91.75389750433749
curr_Factors:  [9.17538975e+01 4.23616750e-02]
mat_Sqrt:  [[ 1.88847432e+01  0.00000000e+00]
 [-8.23278082e-03  1.88636706e-02]]
grads:  [ -0.01599196 -12.14558621]
Stock Position:  -0.01599196381312048
Bond Position:  [2.15147591]


portfolio before change:  [0.7072839]
curr_Stock_Price:  90.3409967090642
curr_Factors:  [9.03409967e+01 4.31849883e-02]
mat_Sqrt:  [[ 1.87737608e+01  0.00000000e+00]
 [-8.31239925e-03  1.90460994e-02]]
grads:  [ 1.46752439e-02 -2.67766746e+01]
Stock Position:  0.014675243941688308
Bond Position:  [-0.61849227]


portfolio before change:  [0.69089741]
curr_Stock_Price:  89.23492670806505
curr_Factors:  [8.92349267e+01 4.07625355e-02]
mat_Sqrt:  [[ 1.80162943e+01  0.00000000e+00]
 [-8.07589356e-03  1.85041968e-02]]
grads:  [ -0.02912049 -12.61695438]
Stock Position:  -0.02912048958796752
Bond Position:  [3.28946216]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.69663128]
Stock Price:  89.06626860136024
PL:  [0.69663128]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 7.45947343e-02  2.76938171e-02]
 [ 4.68149654e-02 -5.03135496e-02]
 [ 6.54694636e-01 -2.63829004e-01]
 [-1.28208993e-01 -1.48393151e-01]
 [ 3.43942027e-01 -1.38279001e-02]
 [-2.79564061e-01 -3.16961672e-01]
 [-9.91286324e-02 -7.80609867e-02]
 [-1.33395677e+00  6.20005529e-01]
 [ 1.73544949e-02  3.00326740e-02]
 [ 2.48554047e-02 -4.17807853e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 9.19825778e-02 -9.38643755e-02]
 [ 1.10972359e-01 -2.78681983e-02]
 [-8.41543572e-02 -1.21444995e-01]
 [ 6.97757883e-02  7.48033572e-02]
 [-1.43394127e-01 -1.39312084e-01]
 [-1.71534842e-01 -4.85781751e-01]
 [ 2.50829305e-01 -2.27967915e-01]
 [ 9.88857166e-02 -6.86317703e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.46321231]
curr_Stock_Price:  98.02865780555288
curr_Factors:  [9.80286578e+01 3.90621484e-02]
mat_Sqrt:  [[ 1.93745275e+01  0.00000000e+00]
 [-7.90565857e-03  1.81141394e-02]]
grads:  [0.00447398 1.52885083]
Stock Position:  0.004473983022614255
Bond Position:  [-10.90179086]


portfolio before change:  [-10.46313468]
curr_Stock_Price:  98.6552616477193
curr_Factors:  [9.86552616e+01 4.03599421e-02]
mat_Sqrt:  [[ 1.98196290e+01  0.00000000e+00]
 [-8.03591360e-03  1.84125912e-02]]
grads:  [ 1.25412701e-03 -2.73256214e+00]
Stock Position:  0.0012541270127522802
Bond Position:  [-10.58686091]


portfolio before change:  [-10.46498368]
curr_Stock_Price:  99.29160324420788
curr_Factors:  [9.92916032e+01 4.15966314e-02]
mat_Sqrt:  [[ 2.02507729e+01  0.00000000e+00]
 [-8.15810090e-03  1.86925574e-02]]
grads:  [  0.02664344 -14.11412028]
Stock Position:  0.02664343826373681
Bond Position:  [-13.11045338]


portfolio before change:  [-10.49626809]
curr_Stock_Price:  98.24044810262612
curr_Factors:  [9.82404481e+01 4.00742122e-02]
mat_Sqrt:  [[ 1.96663078e+01  0.00000000e+00]
 [-8.00741778e-03  1.83472991e-02]]
grads:  [-0.00981237 -8.08801071]
Stock Position:  -0.009812369257083007
Bond Position:  [-9.53229653]


portfolio before change:  [-10.47634206]
curr_Stock_Price:  95.96684809924007
curr_Factors:  [9.59668481e+01 3.91088495e-02]
mat_Sqrt:  [[ 1.89783631e+01  0.00000000e+00]
 [-7.91038300e-03  1.81249644e-02]]
grads:  [ 0.01780486 -0.76292012]
Stock Position:  0.017804856783056114
Bond Position:  [-12.18501804]


portfolio before change:  [-10.48600017]
curr_Stock_Price:  95.59551820060568
curr_Factors:  [9.55955182e+01 3.94606057e-02]
mat_Sqrt:  [[ 1.89897569e+01  0.00000000e+00]
 [-7.94587749e-03  1.82062925e-02]]
grads:  [ -0.02200647 -17.40945727]
Stock Position:  -0.02200646789069684
Bond Position:  [-8.38228046]


portfolio before change:  [-10.45019416]
curr_Stock_Price:  93.87321387334642
curr_Factors:  [9.38732139e+01 4.00128964e-02]
mat_Sqrt:  [[ 1.87776691e+01  0.00000000e+00]
 [-8.00128954e-03  1.83332575e-02]]
grads:  [-0.00709339 -4.25788961]
Stock Position:  -0.007093385195761089
Bond Position:  [-9.7843153]


portfolio before change:  [-10.45785538]
curr_Stock_Price:  94.60838247730346
curr_Factors:  [9.46083825e+01 3.96854560e-02]
mat_Sqrt:  [[ 1.88471334e+01  0.00000000e+00]
 [-7.96848352e-03  1.82580894e-02]]
grads:  [-0.05642047 33.95785363]
Stock Position:  -0.05642047228527431
Bond Position:  [-5.12000576]


portfolio before change:  [-10.42847675]
curr_Stock_Price:  94.06498407079089
curr_Factors:  [9.40649841e+01 3.86239616e-02]
mat_Sqrt:  [[ 1.84865723e+01  0.00000000e+00]
 [-7.86119193e-03  1.80122535e-02]]
grads:  [1.64778131e-03 1.66734684e+00]
Stock Position:  0.001647781311711428
Bond Position:  [-10.58347527]


portfolio before change:  [-10.43316417]
curr_Stock_Price:  92.82621307283553
curr_Factors:  [9.28262131e+01 3.92024194e-02]
mat_Sqrt:  [[ 1.83792197e+01  0.00000000e+00]
 [-7.91984034e-03  1.81466339e-02]]
grads:  [ 3.60231562e-04 -2.30239864e+00]
Stock Position:  0.00036023156183263806
Bond Position:  [-10.4666031]


portfolio before change:  [-10.43564609]
curr_Stock_Price:  93.20115041212767
curr_Factors:  [9.32011504e+01 4.02682099e-02]
mat_Sqrt:  [[ 1.87026193e+01  0.00000000e+00]
 [-8.02677618e-03  1.83916547e-02]]
grads:  [1.44313690e-02 1.90069248e+01]
Stock Position:  0.014431369002185574
Bond Position:  [-11.78066628]


portfolio before change:  [-10.42660681]
curr_Stock_Price:  94.0316200603567
curr_Factors:  [9.40316201e+01 3.91949230e-02]
mat_Sqrt:  [[ 1.86161053e+01  0.00000000e+00]
 [-7.91908308e-03  1.81448988e-02]]
grads:  [ 2.74046612e-03 -5.17304486e+00]
Stock Position:  0.002740466124052267
Bond Position:  [-10.68429728]


portfolio before change:  [-10.42785459]
curr_Stock_Price:  94.55110326247298
curr_Factors:  [9.45511033e+01 4.12570234e-02]
mat_Sqrt:  [[ 1.92050546e+01  0.00000000e+00]
 [-8.12473000e-03  1.86160951e-02]]
grads:  [ 0.00514498 -1.49699484]
Stock Position:  0.005144983051927897
Bond Position:  [-10.91431841]


portfolio before change:  [-10.42961176]
curr_Stock_Price:  94.73997567331259
curr_Factors:  [9.47399757e+01 4.11629248e-02]
mat_Sqrt:  [[ 1.92214604e+01  0.00000000e+00]
 [-8.11545931e-03  1.85948533e-02]]
grads:  [-0.00713563 -6.53110799]
Stock Position:  -0.007135633568637174
Bond Position:  [-9.75358201]


portfolio before change:  [-10.44100444]
curr_Stock_Price:  95.99480130678486
curr_Factors:  [9.59948013e+01 3.91801559e-02]
mat_Sqrt:  [[ 1.90011897e+01  0.00000000e+00]
 [-7.91759113e-03  1.81414803e-02]]
grads:  [0.00539033 4.12333259]
Stock Position:  0.005390328265502317
Bond Position:  [-10.95844793]


portfolio before change:  [-10.43347923]
curr_Stock_Price:  97.89916862651437
curr_Factors:  [9.78991686e+01 4.12765581e-02]
mat_Sqrt:  [[ 1.98898149e+01  0.00000000e+00]
 [-8.12665324e-03  1.86205018e-02]]
grads:  [-0.0102663  -7.48165036]
Stock Position:  -0.010266304952505965
Bond Position:  [-9.42841651]


portfolio before change:  [-10.46991203]
curr_Stock_Price:  101.21831770790939
curr_Factors:  [1.01218318e+02 3.81775594e-02]
mat_Sqrt:  [[ 1.97771267e+01  0.00000000e+00]
 [-7.81563146e-03  1.79078614e-02]]
grads:  [-1.93934835e-02 -2.71267317e+01]
Stock Position:  -0.019393483462031968
Bond Position:  [-8.50693626]


portfolio before change:  [-10.46436837]
curr_Stock_Price:  100.82279006649331
curr_Factors:  [1.00822790e+02 4.06093367e-02]
mat_Sqrt:  [[ 2.03175651e+01  0.00000000e+00]
 [-8.06070337e-03  1.84693917e-02]]
grads:  [ 7.44852790e-03 -1.23430116e+01]
Stock Position:  0.007448527901879701
Bond Position:  [-11.21534973]


portfolio before change:  [-10.46519155]
curr_Stock_Price:  101.08874987208765
curr_Factors:  [1.01088750e+02 4.48128679e-02]
mat_Sqrt:  [[ 2.13995280e+01  0.00000000e+00]
 [-8.46762001e-03  1.94017548e-02]]
grads:  [ 3.22120919e-03 -3.53740014e+00]
Stock Position:  0.0032212091913282914
Bond Position:  [-10.79081956]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.4640522]
Stock Price:  102.2800377999261
PL:  [-12.74409]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.26850369e-02  2.47260181e-02]
 [ 4.95681212e-02 -4.61763450e-02]
 [ 7.20828243e-01 -2.84013226e-01]
 [ 1.19258368e-02 -1.03218376e-01]
 [ 2.36207673e-01 -7.02187471e-03]
 [ 2.80665111e-02 -7.50723388e-02]
 [-5.12774418e-02 -5.95652287e-02]
 [-1.27001386e+00  7.01355190e-01]
 [ 7.67522112e-02 -5.47733969e-02]
 [ 1.50000375e-02 -8.92748313e-02]
 [-5.01088766e-03  1.06150969e-01]
 [ 4.74375863e-02 -8.65813646e-03]
 [ 1.65365283e-01 -2.87742408e-02]
 [-6.13550557e-02 -7.15136791e-02]
 [ 1.70770993e-02  5.63135080e-03]
 [-1.43635010e-01 -1.40393767e-01]
 [-1.92415398e-01 -3.62831191e-01]
 [ 2.90595080e-01 -2.63566605e-01]
 [ 9.17438314e-03 -1.22626587e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.28776337]
curr_Stock_Price:  101.15425665747921
curr_Factors:  [1.01154257e+02 4.01487577e-02]
mat_Sqrt:  [[ 2.02684351e+01  0.00000000e+00]
 [-8.01486197e-03  1.83643558e-02]]
grads:  [1.15827176e-03 1.34641358e+00]
Stock Position:  0.001158271755027336
Bond Position:  [10.17059925]


portfolio before change:  [10.28778504]
curr_Stock_Price:  98.97747784148368
curr_Factors:  [9.89774778e+01 4.05105058e-02]
mat_Sqrt:  [[ 1.99214165e+01  0.00000000e+00]
 [-8.05088873e-03  1.84469035e-02]]
grads:  [ 1.47655725e-03 -2.50320304e+00]
Stock Position:  0.00147655725231065
Bond Position:  [10.14163912]


portfolio before change:  [10.29278359]
curr_Stock_Price:  100.6454328763322
curr_Factors:  [1.00645433e+02 3.89544396e-02]
mat_Sqrt:  [[ 1.98642674e+01  0.00000000e+00]
 [-7.89475163e-03  1.80891485e-02]]
grads:  [  0.03004766 -15.70075154]
Stock Position:  0.030047657832731358
Bond Position:  [7.26862406]


portfolio before change:  [10.26833525]
curr_Stock_Price:  99.77129721436653
curr_Factors:  [9.97712972e+01 4.21060063e-02]
mat_Sqrt:  [[ 2.04728189e+01  0.00000000e+00]
 [-8.20789924e-03  1.88066598e-02]]
grads:  [-1.61786981e-03 -5.48839490e+00]
Stock Position:  -0.0016178698090690345
Bond Position:  [10.42975222]


portfolio before change:  [10.27287252]
curr_Stock_Price:  98.5786720617504
curr_Factors:  [9.85786721e+01 3.99018181e-02]
mat_Sqrt:  [[ 1.96915229e+01  0.00000000e+00]
 [-7.99017578e-03  1.83077927e-02]]
grads:  [ 0.01183977 -0.38354568]
Stock Position:  0.011839768614741722
Bond Position:  [9.10572386]


portfolio before change:  [10.28012651]
curr_Stock_Price:  98.99905799711631
curr_Factors:  [9.89990580e+01 4.00872132e-02]
mat_Sqrt:  [[ 1.98213849e+01  0.00000000e+00]
 [-8.00871657e-03  1.83502750e-02]]
grads:  [-2.37003806e-04 -4.09107433e+00]
Stock Position:  -0.0002370038056159728
Bond Position:  [10.30358966]


portfolio before change:  [10.28353866]
curr_Stock_Price:  95.47198556884669
curr_Factors:  [9.54719856e+01 4.21943626e-02]
mat_Sqrt:  [[ 1.96111549e+01  0.00000000e+00]
 [-8.21650656e-03  1.88263816e-02]]
grads:  [-0.0039403  -3.16392336]
Stock Position:  -0.003940300267226295
Bond Position:  [10.65972695]


portfolio before change:  [10.27721912]
curr_Stock_Price:  97.75221790163869
curr_Factors:  [9.77522179e+01 4.20951000e-02]
mat_Sqrt:  [[ 2.00559110e+01  0.00000000e+00]
 [-8.20683618e-03  1.88042240e-02]]
grads:  [-0.04806151 37.29774704]
Stock Position:  -0.04806150992871768
Bond Position:  [14.97533832]


portfolio before change:  [10.22856584]
curr_Stock_Price:  98.84243719863828
curr_Factors:  [9.88424372e+01 4.14462362e-02]
mat_Sqrt:  [[ 2.01226880e+01  0.00000000e+00]
 [-8.14333949e-03  1.86587348e-02]]
grads:  [ 2.62624660e-03 -2.93553649e+00]
Stock Position:  0.0026262465994255834
Bond Position:  [9.96898123]


portfolio before change:  [10.2281226]
curr_Stock_Price:  97.72456901726736
curr_Factors:  [9.77245690e+01 4.21196969e-02]
mat_Sqrt:  [[ 2.00560952e+01  0.00000000e+00]
 [-8.20923352e-03  1.88097170e-02]]
grads:  [-1.19478358e-03 -4.74620811e+00]
Stock Position:  -0.0011947835796228311
Bond Position:  [10.34488231]


portfolio before change:  [10.22924638]
curr_Stock_Price:  98.94886135344083
curr_Factors:  [9.89488614e+01 4.08063344e-02]
mat_Sqrt:  [[ 1.99882417e+01  0.00000000e+00]
 [-8.08023112e-03  1.85141354e-02]]
grads:  [2.06707493e-03 5.73350939e+00]
Stock Position:  0.002067074930335648
Bond Position:  [10.02471167]


portfolio before change:  [10.23220859]
curr_Stock_Price:  99.16932828950168
curr_Factors:  [9.91693283e+01 4.18082557e-02]
mat_Sqrt:  [[ 2.02772192e+01  0.00000000e+00]
 [-8.17882688e-03  1.87400466e-02]]
grads:  [ 0.0021531  -0.46201254]
Stock Position:  0.002153099265767344
Bond Position:  [10.01868719]


portfolio before change:  [10.23284235]
curr_Stock_Price:  98.30024010831082
curr_Factors:  [9.83002401e+01 3.98407168e-02]
mat_Sqrt:  [[ 1.96208650e+01  0.00000000e+00]
 [-7.98405579e-03  1.82937700e-02]]
grads:  [ 0.00778799 -1.57289836]
Stock Position:  0.0077879937955491535
Bond Position:  [9.46728069]


portfolio before change:  [10.22668228]
curr_Stock_Price:  97.20532667959431
curr_Factors:  [9.72053267e+01 4.03896320e-02]
mat_Sqrt:  [[ 1.95355216e+01  0.00000000e+00]
 [-8.03886878e-03  1.84193623e-02]]
grads:  [-0.00473835 -3.88252741]
Stock Position:  -0.00473835230409444
Bond Position:  [10.68727537]


portfolio before change:  [10.22573497]
curr_Stock_Price:  97.96919180267354
curr_Factors:  [9.79691918e+01 3.93715205e-02]
mat_Sqrt:  [[ 1.94392999e+01  0.00000000e+00]
 [-7.93690322e-03  1.81857299e-02]]
grads:  [0.00100491 0.30965767]
Stock Position:  0.0010049138828566668
Bond Position:  [10.12728437]


portfolio before change:  [10.22750781]
curr_Stock_Price:  97.21360055758959
curr_Factors:  [9.72136006e+01 3.98566338e-02]
mat_Sqrt:  [[ 1.94078460e+01  0.00000000e+00]
 [-7.98565051e-03  1.82974240e-02]]
grads:  [-0.01055799 -7.67287064]
Stock Position:  -0.010557991502698226
Bond Position:  [11.25388818]


portfolio before change:  [10.22722324]
curr_Stock_Price:  97.50706451617368
curr_Factors:  [9.75070645e+01 3.95645133e-02]
mat_Sqrt:  [[ 1.93949648e+01  0.00000000e+00]
 [-7.95633215e-03  1.82302472e-02]]
grads:  [-1.80855142e-02 -1.99027028e+01]
Stock Position:  -0.01808551421005076
Bond Position:  [11.99068864]


portfolio before change:  [10.22585564]
curr_Stock_Price:  97.74845377404007
curr_Factors:  [9.77484538e+01 3.92913540e-02]
mat_Sqrt:  [[ 1.93757443e+01  0.00000000e+00]
 [-7.92881873e-03  1.81672060e-02]]
grads:  [ 9.06108074e-03 -1.45078228e+01]
Stock Position:  0.009061080736614439
Bond Position:  [9.34014901]


portfolio before change:  [10.23882251]
curr_Stock_Price:  98.92177276340487
curr_Factors:  [9.89217728e+01 3.86966824e-02]
mat_Sqrt:  [[ 1.94593692e+01  0.00000000e+00]
 [-7.86858894e-03  1.80292022e-02]]
grads:  [-2.27881215e-03 -6.80155369e+00]
Stock Position:  -0.0022788121534502315
Bond Position:  [10.46424664]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.24416816]
Stock Price:  97.72410229935484
PL:  [10.24416816]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 6.90255427e-03  1.48972402e-01]
 [ 5.18087336e-02 -4.28093463e-02]
 [ 5.12063022e-01 -2.20297308e-01]
 [-9.87901084e-02 -1.05521345e-01]
 [ 2.85989254e-01 -9.58698278e-03]
 [ 8.41312108e-03 -1.11676733e-01]
 [-1.61257483e-02 -6.05198619e-02]
 [-1.26369635e+00  7.14016738e-01]
 [ 6.46400917e-02 -3.74839416e-02]
 [ 1.44535965e-02 -9.19081876e-02]
 [ 5.43296324e-03  1.34278426e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.64752551e-01 -2.86721971e-02]
 [ 1.52096931e-02  3.27702672e-02]
 [-9.02901092e-02 -4.01643804e-02]
 [-1.42619634e-01 -1.35834224e-01]
 [-1.91734463e-01 -3.72310937e-01]
 [ 2.86611153e-01 -2.56517871e-01]
 [-6.18234733e-02 -1.40845701e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.03825434]
curr_Stock_Price:  99.29766025516538
curr_Factors:  [9.92976603e+01 3.90757590e-02]
mat_Sqrt:  [[ 1.96287537e+01  0.00000000e+00]
 [-7.90703575e-03  1.81172949e-02]]
grads:  [3.66398407e-03 8.22266255e+00]
Stock Position:  0.0036639840705842298
Bond Position:  [-2.40207938]


portfolio before change:  [-2.03904887]
curr_Stock_Price:  99.24472889138424
curr_Factors:  [9.92447289e+01 4.00250946e-02]
mat_Sqrt:  [[ 1.98551711e+01  0.00000000e+00]
 [-8.00250906e-03  1.83360518e-02]]
grads:  [ 1.66834136e-03 -2.33470906e+00]
Stock Position:  0.001668341364972618
Bond Position:  [-2.20462296]


portfolio before change:  [-2.04361685]
curr_Stock_Price:  96.8370972049718
curr_Factors:  [9.68370972e+01 4.34034538e-02]
mat_Sqrt:  [[ 2.01745524e+01  0.00000000e+00]
 [-8.33339823e-03  1.90942141e-02]]
grads:  [  0.02061594 -11.53738544]
Stock Position:  0.020615941679008477
Bond Position:  [-4.0400048]


portfolio before change:  [-2.04879355]
curr_Stock_Price:  96.63499277103656
curr_Factors:  [9.66349928e+01 4.28078097e-02]
mat_Sqrt:  [[ 1.99938266e+01  0.00000000e+00]
 [-8.27601930e-03  1.89627424e-02]]
grads:  [-0.00724441 -5.5646669 ]
Stock Position:  -0.007244406074692231
Bond Position:  [-1.34873042]


portfolio before change:  [-2.0559075]
curr_Stock_Price:  97.57043588279632
curr_Factors:  [9.75704359e+01 4.05576893e-02]
mat_Sqrt:  [[ 1.96496513e+01  0.00000000e+00]
 [-8.05557589e-03  1.84576431e-02]]
grads:  [ 0.01434148 -0.51940449]
Stock Position:  0.01434148359903651
Bond Position:  [-3.45521231]


portfolio before change:  [-2.04869474]
curr_Stock_Price:  98.13360465841545
curr_Factors:  [9.81336047e+01 3.85674623e-02]
mat_Sqrt:  [[ 1.92720664e+01  0.00000000e+00]
 [-7.85544014e-03  1.79990745e-02]]
grads:  [-2.09248973e-03 -6.20458197e+00]
Stock Position:  -0.0020924897339474145
Bond Position:  [-1.84335118]


portfolio before change:  [-2.04744016]
curr_Stock_Price:  97.31378102609399
curr_Factors:  [9.73137810e+01 4.00655448e-02]
mat_Sqrt:  [[ 1.94786957e+01  0.00000000e+00]
 [-8.00655180e-03  1.83453148e-02]]
grads:  [-2.18386190e-03 -3.29892741e+00]
Stock Position:  -0.0021838619005510058
Bond Position:  [-1.8349203]


portfolio before change:  [-2.04993062]
curr_Stock_Price:  98.2440940773067
curr_Factors:  [9.82440941e+01 3.95985781e-02]
mat_Sqrt:  [[ 1.95499769e+01  0.00000000e+00]
 [-7.95975659e-03  1.82380935e-02]]
grads:  [-0.04869949 39.14974643]
Stock Position:  -0.04869948989251247
Bond Position:  [2.73450664]


portfolio before change:  [-2.03096007]
curr_Stock_Price:  97.86859022100232
curr_Factors:  [9.78685902e+01 3.99852126e-02]
mat_Sqrt:  [[ 1.95700996e+01  0.00000000e+00]
 [-7.99852112e-03  1.83269142e-02]]
grads:  [ 0.00246707 -2.04529476]
Stock Position:  0.002467067578914015
Bond Position:  [-2.27240849]


portfolio before change:  [-2.03122178]
curr_Stock_Price:  97.99280877695996
curr_Factors:  [9.79928088e+01 3.89553731e-02]
mat_Sqrt:  [[ 1.93409539e+01  0.00000000e+00]
 [-7.89484623e-03  1.80893652e-02]]
grads:  [-1.32663700e-03 -5.08078567e+00]
Stock Position:  -0.0013266369993472278
Bond Position:  [-1.9012209]


portfolio before change:  [-2.03270176]
curr_Stock_Price:  98.75007177189723
curr_Factors:  [9.87500718e+01 3.88153259e-02]
mat_Sqrt:  [[ 1.94553496e+01  0.00000000e+00]
 [-7.88064220e-03  1.80568197e-02]]
grads:  [3.29147891e-03 7.43643830e+00]
Stock Position:  0.003291478906019776
Bond Position:  [-2.35773554]


portfolio before change:  [-2.03538858]
curr_Stock_Price:  98.11287731619088
curr_Factors:  [9.81128773e+01 3.82047716e-02]
mat_Sqrt:  [[ 1.91771832e+01  0.00000000e+00]
 [-7.81841638e-03  1.79142424e-02]]
grads:  [ 0.00250383 -0.47958393]
Stock Position:  0.0025038337418630536
Bond Position:  [-2.28104691]


portfolio before change:  [-2.03441567]
curr_Stock_Price:  98.72923009908568
curr_Factors:  [9.87292301e+01 3.76692808e-02]
mat_Sqrt:  [[ 1.91619373e+01  0.00000000e+00]
 [-7.76343025e-03  1.77882534e-02]]
grads:  [ 0.00794486 -1.61186129]
Stock Position:  0.007944863627430177
Bond Position:  [-2.81880594]


portfolio before change:  [-2.02790812]
curr_Stock_Price:  99.63702868415771
curr_Factors:  [9.96370287e+01 3.95047022e-02]
mat_Sqrt:  [[ 1.98036464e+01  0.00000000e+00]
 [-7.95031594e-03  1.82164623e-02]]
grads:  [1.49022102e-03 1.79893695e+00]
Stock Position:  0.0014902210228735634
Bond Position:  [-2.17638932]


portfolio before change:  [-2.02844939]
curr_Stock_Price:  99.6389730647664
curr_Factors:  [9.96389731e+01 4.01397083e-02]
mat_Sqrt:  [[ 1.99625652e+01  0.00000000e+00]
 [-8.01395865e-03  1.83622861e-02]]
grads:  [-0.00540107 -2.18733007]
Stock Position:  -0.005401073485609871
Bond Position:  [-1.49029197]


portfolio before change:  [-2.02380356]
curr_Stock_Price:  98.70981562906705
curr_Factors:  [9.87098156e+01 3.86266986e-02]
mat_Sqrt:  [[ 1.94001075e+01  0.00000000e+00]
 [-7.86147046e-03  1.80128917e-02]]
grads:  [-0.01040729 -7.54094489]
Stock Position:  -0.010407290267173458
Bond Position:  [-0.99650186]


portfolio before change:  [-2.01548203]
curr_Stock_Price:  97.88628810437805
curr_Factors:  [9.78862881e+01 3.65088957e-02]
mat_Sqrt:  [[ 1.87034278e+01  0.00000000e+00]
 [-7.64292046e-03  1.75121308e-02]]
grads:  [-1.89390030e-02 -2.12601734e+01]
Stock Position:  -0.01893900304542318
Bond Position:  [-0.16161332]


portfolio before change:  [-2.02704428]
curr_Stock_Price:  98.49465418587809
curr_Factors:  [9.84946542e+01 3.60084653e-02]
mat_Sqrt:  [[ 1.86902438e+01  0.00000000e+00]
 [-7.59035865e-03  1.73916965e-02]]
grads:  [ 9.34485273e-03 -1.47494450e+01]
Stock Position:  0.00934485273256413
Bond Position:  [-2.94746232]


portfolio before change:  [-2.03868478]
curr_Stock_Price:  97.32785804125089
curr_Factors:  [9.73278580e+01 3.63795801e-02]
mat_Sqrt:  [[ 1.85637626e+01  0.00000000e+00]
 [-7.62937273e-03  1.74810890e-02]]
grads:  [-6.64162643e-03 -8.05703241e+00]
Stock Position:  -0.00664162642778775
Bond Position:  [-1.39226951]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.03336908]
Stock Price:  96.47508344398479
PL:  [-2.03336908]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.17472447e-02  2.35728430e-02]
 [-1.40273303e-01  1.19551619e-01]
 [ 8.25038947e-01 -3.15818718e-01]
 [ 2.11710023e-01 -1.14763843e-01]
 [ 1.74221889e-01 -2.79103803e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-3.59628488e-01 -1.34541747e-01]
 [-1.50481356e+00  7.18958268e-01]
 [ 9.83940249e-05 -6.89010154e-02]
 [ 1.87192521e-01  8.81928393e-01]
 [-6.36292335e-01 -1.55996748e-01]
 [-4.08290594e-02 -8.44941751e-02]
 [-6.62135933e-02 -1.11489282e-01]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.13495055e-01 -6.03186978e-02]
 [ 1.51861222e-01  7.62088619e-02]
 [-8.72231172e-02 -7.03322421e-01]
 [-3.86201092e-01  1.59439361e-01]
 [-1.01238727e-01 -8.79099320e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.0833483]
curr_Stock_Price:  101.27409099065801
curr_Factors:  [1.01274091e+02 3.77878039e-02]
mat_Sqrt:  [[ 1.96867570e+01  0.00000000e+00]
 [-7.77563413e-03  1.78162160e-02]]
grads:  [1.11929440e-03 1.32311165e+00]
Stock Position:  0.0011192943995874702
Bond Position:  [10.96999277]


portfolio before change:  [11.08749609]
curr_Stock_Price:  102.52930264942195
curr_Factors:  [1.02529303e+02 3.85135024e-02]
mat_Sqrt:  [[ 2.01212293e+01  0.00000000e+00]
 [-7.84994292e-03  1.79864788e-02]]
grads:  [-4.37829605e-03  6.64674950e+00]
Stock Position:  -0.004378296047128796
Bond Position:  [11.53639973]


portfolio before change:  [11.09026762]
curr_Stock_Price:  102.55509447496097
curr_Factors:  [1.02555094e+02 3.90738418e-02]
mat_Sqrt:  [[ 2.02721726e+01  0.00000000e+00]
 [-7.90684178e-03  1.81168505e-02]]
grads:  [  0.0338989  -17.43231908]
Stock Position:  0.03389890025778803
Bond Position:  [7.61376271]


portfolio before change:  [11.05034431]
curr_Stock_Price:  101.32121988425129
curr_Factors:  [1.01321220e+02 3.89772795e-02]
mat_Sqrt:  [[ 2.00035083e+01  0.00000000e+00]
 [-7.89706573e-03  1.80944507e-02]]
grads:  [ 0.00807973 -6.34248838]
Stock Position:  0.008079731428155759
Bond Position:  [10.23169607]


portfolio before change:  [11.06613262]
curr_Stock_Price:  102.95865803125912
curr_Factors:  [1.02958658e+02 3.88840594e-02]
mat_Sqrt:  [[ 2.03024604e+01  0.00000000e+00]
 [-7.88761656e-03  1.80728000e-02]]
grads:  [ 0.00798134 -1.54433073]
Stock Position:  0.007981338056296037
Bond Position:  [10.24438476]


portfolio before change:  [11.07513145]
curr_Stock_Price:  103.76521700690594
curr_Factors:  [1.03765217e+02 4.07941582e-02]
mat_Sqrt:  [[ 2.09580459e+01  0.00000000e+00]
 [-8.07902551e-03  1.85113730e-02]]
grads:  [-2.76563073e-05 -1.04536688e+00]
Stock Position:  -2.7656307286878184e-05
Bond Position:  [11.07800121]


portfolio before change:  [11.07789328]
curr_Stock_Price:  104.05524450989887
curr_Factors:  [1.04055245e+02 4.06252604e-02]
mat_Sqrt:  [[ 2.09730723e+01  0.00000000e+00]
 [-8.06228359e-03  1.84730124e-02]]
grads:  [-0.01994688 -7.28315145]
Stock Position:  -0.01994687834363672
Bond Position:  [13.15347058]


portfolio before change:  [11.03886653]
curr_Stock_Price:  106.17665546685632
curr_Factors:  [1.06176655e+02 4.06541327e-02]
mat_Sqrt:  [[ 2.14082610e+01  0.00000000e+00]
 [-8.06514801e-03  1.84795756e-02]]
grads:  [-0.05563434 38.90556164]
Stock Position:  -0.055634339017187666
Bond Position:  [16.94593458]


portfolio before change:  [11.02602697]
curr_Stock_Price:  106.48359841746509
curr_Factors:  [1.06483598e+02 4.10309046e-02]
mat_Sqrt:  [[ 2.15694100e+01  0.00000000e+00]
 [-8.10243466e-03  1.85650101e-02]]
grads:  [-1.38958249e-03 -3.71133736e+00]
Stock Position:  -0.0013895824905049848
Bond Position:  [11.17399472]


portfolio before change:  [11.02676506]
curr_Stock_Price:  107.96301090358394
curr_Factors:  [1.07963011e+02 3.88317059e-02]
mat_Sqrt:  [[ 2.12749341e+01  0.00000000e+00]
 [-7.88230483e-03  1.80606293e-02]]
grads:  [2.68906886e-02 4.88315429e+01]
Stock Position:  0.026890688620487463
Bond Position:  [8.12356535]


portfolio before change:  [11.02760381]
curr_Stock_Price:  107.91866855014334
curr_Factors:  [1.07918669e+02 3.87883009e-02]
mat_Sqrt:  [[ 2.12543074e+01  0.00000000e+00]
 [-7.87789829e-03  1.80505326e-02]]
grads:  [-0.03314034 -8.64222412]
Stock Position:  -0.03314033648636021
Bond Position:  [14.60406479]


portfolio before change:  [11.0419961]
curr_Stock_Price:  107.59456738757532
curr_Factors:  [1.07594567e+02 3.96083993e-02]
mat_Sqrt:  [[ 2.14133191e+01  0.00000000e+00]
 [-7.96074362e-03  1.82403551e-02]]
grads:  [-3.62883214e-03 -4.63226591e+00]
Stock Position:  -0.003628832135799773
Bond Position:  [11.43243872]


portfolio before change:  [11.04204468]
curr_Stock_Price:  108.36888977472579
curr_Factors:  [1.08368890e+02 3.89503217e-02]
mat_Sqrt:  [[ 2.13875062e+01  0.00000000e+00]
 [-7.89433434e-03  1.80881923e-02]]
grads:  [-5.37096302e-03 -6.16364971e+00]
Stock Position:  -0.0053709630216110995
Bond Position:  [11.62408998]


portfolio before change:  [11.04441052]
curr_Stock_Price:  108.46953143777317
curr_Factors:  [1.08469531e+02 3.75449664e-02]
mat_Sqrt:  [[ 2.10176243e+01  0.00000000e+00]
 [-7.75060942e-03  1.77588772e-02]]
grads:  [7.24330874e-03 8.36641236e+00]
Stock Position:  0.0072433087423451285
Bond Position:  [10.25873222]


portfolio before change:  [11.05848814]
curr_Stock_Price:  110.05894523279125
curr_Factors:  [1.10058945e+02 3.58425788e-02]
mat_Sqrt:  [[ 2.08365096e+01  0.00000000e+00]
 [-7.57285456e-03  1.73515896e-02]]
grads:  [-0.00671035 -3.47626351]
Stock Position:  -0.006710350991023303
Bond Position:  [11.79702229]


portfolio before change:  [11.04901716]
curr_Stock_Price:  111.90990694927531
curr_Factors:  [1.11909907e+02 3.62340310e-02]
mat_Sqrt:  [[ 2.13023179e+01  0.00000000e+00]
 [-7.61409546e-03  1.74460844e-02]]
grads:  [0.0086902  4.36825022]
Stock Position:  0.00869020439800297
Bond Position:  [10.0764972]


portfolio before change:  [11.03989291]
curr_Stock_Price:  110.57004297712825
curr_Factors:  [1.10570043e+02 3.77146006e-02]
mat_Sqrt:  [[ 2.14729758e+01  0.00000000e+00]
 [-7.76809892e-03  1.77989507e-02]]
grads:  [-1.83569427e-02 -3.95148250e+01]
Stock Position:  -0.018356942736971273
Bond Position:  [13.06962086]


portfolio before change:  [10.99888383]
curr_Stock_Price:  112.98204009381953
curr_Factors:  [1.12982040e+02 3.56086741e-02]
mat_Sqrt:  [[ 2.13200056e+01  0.00000000e+00]
 [-7.54810430e-03  1.72948797e-02]]
grads:  [-0.01485066  9.21887658]
Stock Position:  -0.014850655136348378
Bond Position:  [12.67674115]


portfolio before change:  [11.02934412]
curr_Stock_Price:  111.14436291884607
curr_Factors:  [1.11144363e+02 3.73908939e-02]
mat_Sqrt:  [[ 2.14916800e+01  0.00000000e+00]
 [-7.73469006e-03  1.77224013e-02]]
grads:  [-0.00649581 -4.9603849 ]
Stock Position:  -0.006495805202442391
Bond Position:  [11.75131625]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.02298512]
Stock Price:  112.5756256530358
PL:  [-1.55264054]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 7.24961786e-03  1.80422458e-02]
 [ 4.06234609e-02  8.26128902e-03]
 [ 7.57780271e-01 -2.95291121e-01]
 [ 1.49774267e-01 -1.16522037e-01]
 [-1.99309381e-02 -1.22591062e-02]
 [ 4.17516693e-02 -1.87858238e-02]
 [-2.59435519e-01 -1.64451258e-01]
 [-1.41686509e+00  7.50051029e-01]
 [ 5.05102346e-02 -7.51643516e-02]
 [ 1.23083039e-01  3.35447339e-01]
 [-2.38441149e-01 -2.49738278e-02]
 [-7.74095841e-03 -9.86577817e-03]
 [ 4.09445800e-02 -3.57769972e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15598720e-01 -6.15126402e-02]
 [-7.41740991e-02 -9.59864063e-02]
 [-1.48844717e-01 -5.77875999e-01]
 [-1.95708418e-01 -7.06267015e-02]
 [ 1.47730578e-01  9.73952356e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.90050248]
curr_Stock_Price:  101.84904673818733
curr_Factors:  [1.01849047e+02 3.67295870e-02]
mat_Sqrt:  [[ 1.95193338e+01  0.00000000e+00]
 [-7.66598586e-03  1.75649802e-02]]
grads:  [7.74816377e-04 1.02717143e+00]
Stock Position:  0.0007748163767478644
Bond Position:  [14.82158817]


portfolio before change:  [14.90395917]
curr_Stock_Price:  101.52746479449894
curr_Factors:  [1.01527465e+02 3.63036954e-02]
mat_Sqrt:  [[ 1.93445646e+01  0.00000000e+00]
 [-7.62141146e-03  1.74628475e-02]]
grads:  [0.00228638 0.473078  ]
Stock Position:  0.0022863777969949375
Bond Position:  [14.67182903]


portfolio before change:  [14.90745216]
curr_Stock_Price:  101.45073850814222
curr_Factors:  [1.01450739e+02 3.81363379e-02]
mat_Sqrt:  [[ 1.98118352e+01  0.00000000e+00]
 [-7.81141093e-03  1.78981909e-02]]
grads:  [  0.03174389 -16.4983781 ]
Stock Position:  0.031743887117827434
Bond Position:  [11.68701137]


portfolio before change:  [14.88859905]
curr_Stock_Price:  100.76477234979653
curr_Factors:  [1.00764772e+02 3.83939175e-02]
mat_Sqrt:  [[ 1.97442182e+01  0.00000000e+00]
 [-7.83774636e-03  1.79585330e-02]]
grads:  [ 5.01006827e-03 -6.48839397e+00]
Stock Position:  0.005010068268856189
Bond Position:  [14.38376066]


portfolio before change:  [14.89223674]
curr_Stock_Price:  100.77301507402899
curr_Factors:  [1.00773015e+02 4.14199014e-02]
mat_Sqrt:  [[ 2.05092030e+01  0.00000000e+00]
 [-8.14075195e-03  1.86528060e-02]]
grads:  [-0.00123268 -0.65722584]
Stock Position:  -0.0012326783590089583
Bond Position:  [15.01645745]


portfolio before change:  [14.89601893]
curr_Stock_Price:  100.75061490028544
curr_Factors:  [1.00750615e+02 4.00822406e-02]
mat_Sqrt:  [[ 2.01708268e+01  0.00000000e+00]
 [-8.00821983e-03  1.83491368e-02]]
grads:  [ 0.00166344 -1.02379878]
Stock Position:  0.0016634352147711594
Bond Position:  [14.72842681]


portfolio before change:  [14.90361872]
curr_Stock_Price:  103.10551171463743
curr_Factors:  [1.03105512e+02 4.11841640e-02]
mat_Sqrt:  [[ 2.09241107e+01  0.00000000e+00]
 [-8.11755273e-03  1.85996499e-02]]
grads:  [-0.01582901 -8.84163188]
Stock Position:  -0.01582900878169476
Bond Position:  [16.53567677]


portfolio before change:  [14.90101499]
curr_Stock_Price:  103.5311961045389
curr_Factors:  [1.03531196e+02 3.96592505e-02]
mat_Sqrt:  [[ 2.06178551e+01  0.00000000e+00]
 [-7.96585217e-03  1.82520603e-02]]
grads:  [-0.05284332 41.09404735]
Stock Position:  -0.05284332345770707
Bond Position:  [20.37194747]


portfolio before change:  [14.9381653]
curr_Stock_Price:  102.92455960098256
curr_Factors:  [1.02924560e+02 4.01034694e-02]
mat_Sqrt:  [[ 2.06115186e+01  0.00000000e+00]
 [-8.01034025e-03  1.83539953e-02]]
grads:  [ 8.59025601e-04 -4.09525830e+00]
Stock Position:  0.0008590256008459267
Bond Position:  [14.84975047]


portfolio before change:  [14.94218222]
curr_Stock_Price:  103.27847057478147
curr_Factors:  [1.03278471e+02 3.85682675e-02]
mat_Sqrt:  [[ 2.02826578e+01  0.00000000e+00]
 [-7.85552214e-03  1.79992624e-02]]
grads:  [1.32864373e-02 1.86367270e+01]
Stock Position:  0.013286437274476462
Bond Position:  [13.5699793]


portfolio before change:  [14.9393703]
curr_Stock_Price:  102.81146492120608
curr_Factors:  [1.02811465e+02 3.61104108e-02]
mat_Sqrt:  [[ 1.95369948e+01  0.00000000e+00]
 [-7.60109580e-03  1.74162984e-02]]
grads:  [-0.01276249 -1.43393431]
Stock Position:  -0.012762485881847379
Bond Position:  [16.25150017]


portfolio before change:  [14.93355808]
curr_Stock_Price:  103.5852639358014
curr_Factors:  [1.03585264e+02 3.68359045e-02]
mat_Sqrt:  [[ 1.98807904e+01  0.00000000e+00]
 [-7.67707283e-03  1.75903837e-02]]
grads:  [-0.00060595 -0.56086202]
Stock Position:  -0.0006059485952998664
Bond Position:  [14.99632543]


portfolio before change:  [14.93774965]
curr_Stock_Price:  102.8558083240287
curr_Factors:  [1.02855808e+02 3.73906066e-02]
mat_Sqrt:  [[ 1.98888685e+01  0.00000000e+00]
 [-7.73466034e-03  1.77223332e-02]]
grads:  [ 1.27358770e-03 -2.01875209e+00]
Stock Position:  0.0012735876994068931
Bond Position:  [14.80675375]


portfolio before change:  [14.94215815]
curr_Stock_Price:  103.4104242908888
curr_Factors:  [1.03410424e+02 3.82001905e-02]
mat_Sqrt:  [[ 2.02114320e+01  0.00000000e+00]
 [-7.81794761e-03  1.79131683e-02]]
grads:  [7.53222938e-03 8.29435009e+00]
Stock Position:  0.007532229381517702
Bond Position:  [14.16324711]


portfolio before change:  [14.95904111]
curr_Stock_Price:  105.18170702189954
curr_Factors:  [1.05181707e+02 3.52462264e-02]
mat_Sqrt:  [[ 1.97467909e+01  0.00000000e+00]
 [-7.50959135e-03  1.72066354e-02]]
grads:  [-0.00721358 -3.57493716]
Stock Position:  -0.007213579023943452
Bond Position:  [15.71777767]


portfolio before change:  [14.9641338]
curr_Stock_Price:  105.0205175535146
curr_Factors:  [1.05020518e+02 3.65447702e-02]
mat_Sqrt:  [[ 2.00764431e+01  0.00000000e+00]
 [-7.64667460e-03  1.75207326e-02]]
grads:  [-0.0057812  -5.47844708]
Stock Position:  -0.005781203409621312
Bond Position:  [15.57127878]


portfolio before change:  [14.97219994]
curr_Stock_Price:  104.29872525305397
curr_Factors:  [1.04298725e+02 3.82209146e-02]
mat_Sqrt:  [[ 2.03905781e+01  0.00000000e+00]
 [-7.82006799e-03  1.79180268e-02]]
grads:  [-1.96684212e-02 -3.22510959e+01]
Stock Position:  -0.019668421248882552
Bond Position:  [17.0235912]


portfolio before change:  [14.97349526]
curr_Stock_Price:  104.44927666602943
curr_Factors:  [1.04449277e+02 3.87995081e-02]
mat_Sqrt:  [[ 2.05739910e+01  0.00000000e+00]
 [-7.87903629e-03  1.80531401e-02]]
grads:  [-0.01101062 -3.91215606]
Stock Position:  -0.011010621969411166
Bond Position:  [16.12354676]


portfolio before change:  [14.9707161]
curr_Stock_Price:  105.06781975490297
curr_Factors:  [1.05067820e+02 3.81924942e-02]
mat_Sqrt:  [[ 2.05332990e+01  0.00000000e+00]
 [-7.81716002e-03  1.79113637e-02]]
grads:  [0.0074017  0.54376226]
Stock Position:  0.0074016968550829785
Bond Position:  [14.19303595]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.98722568]
Stock Price:  106.81888759958152
PL:  [8.16833808]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 9.65077234e-03  2.09948737e-02]
 [-2.87345049e-01  2.10030049e-01]
 [ 8.35987446e-01 -3.19160241e-01]
 [ 4.60041220e-01 -5.51764657e-02]
 [ 3.47115971e-01 -3.47063266e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-1.15486336e+00  3.55245055e-02]
 [-1.67686772e+00  5.07234455e-01]
 [-2.75724548e-01  6.02742024e-02]
 [ 2.53821529e-01  1.47230055e+00]
 [-1.08739676e+00 -3.19717860e-01]
 [-4.21300926e-02 -2.97735606e-01]
 [-1.59210148e-01 -1.82130678e-01]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.12887812e-01 -5.99740551e-02]
 [ 1.60213884e-01  8.54267306e-02]
 [-4.87856734e-03 -7.08297640e-01]
 [-3.85236548e-01  1.62988750e-01]
 [-1.69214694e-01 -9.24791714e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.86310874]
curr_Stock_Price:  101.54216596136403
curr_Factors:  [1.01542166e+02 4.04460997e-02]
mat_Sqrt:  [[ 2.04213640e+01  0.00000000e+00]
 [-8.04448628e-03  1.84322336e-02]]
grads:  [9.21274720e-04 1.13903036e+00]
Stock Position:  0.0009212747202902014
Bond Position:  [12.76956051]


portfolio before change:  [12.86796218]
curr_Stock_Price:  103.34472045865716
curr_Factors:  [1.0334472e+02 3.9638499e-02]
mat_Sqrt:  [[ 2.05753341e+01  0.00000000e+00]
 [-7.96376785e-03  1.82472845e-02]]
grads:  [-9.51043709e-03  1.15102085e+01]
Stock Position:  -0.009510437087602535
Bond Position:  [13.85081564]


portfolio before change:  [12.87676779]
curr_Stock_Price:  102.78297176407861
curr_Factors:  [1.02782972e+02 3.85701414e-02]
mat_Sqrt:  [[ 2.01858381e+01  0.00000000e+00]
 [-7.85571297e-03  1.79996997e-02]]
grads:  [  0.03451402 -17.73142035]
Stock Position:  0.03451402383240319
Bond Position:  [9.32931385]


portfolio before change:  [12.95031188]
curr_Stock_Price:  104.84623381235654
curr_Factors:  [1.04846234e+02 4.16500236e-02]
mat_Sqrt:  [[ 2.13973732e+01  0.00000000e+00]
 [-8.16333496e-03  1.87045502e-02]]
grads:  [ 0.02037447 -2.94989535]
Stock Position:  0.02037447461909755
Bond Position:  [10.81412495]


portfolio before change:  [12.97556991]
curr_Stock_Price:  105.95321498016435
curr_Factors:  [1.05953215e+02 4.25351611e-02]
mat_Sqrt:  [[ 2.18518485e+01  0.00000000e+00]
 [-8.24962168e-03  1.89022579e-02]]
grads:  [ 0.0151918  -1.83609423]
Stock Position:  0.015191798922491727
Bond Position:  [11.36594998]


portfolio before change:  [13.03208321]
curr_Stock_Price:  109.48613775139985
curr_Factors:  [1.09486138e+02 4.01756597e-02]
mat_Sqrt:  [[ 2.19452556e+01  0.00000000e+00]
 [-8.01754672e-03  1.83705074e-02]]
grads:  [-2.64121852e-05 -1.05338278e+00]
Stock Position:  -2.6412185245900068e-05
Bond Position:  [13.03497498]


portfolio before change:  [13.03529751]
curr_Stock_Price:  111.18419892299842
curr_Factors:  [1.11184199e+02 3.80361811e-02]
mat_Sqrt:  [[ 2.16841061e+01  0.00000000e+00]
 [-7.80114669e-03  1.78746726e-02]]
grads:  [-0.05254352  1.98742133]
Stock Position:  -0.05254351662543648
Bond Position:  [18.87730631]


portfolio before change:  [12.98199694]
curr_Stock_Price:  112.28843583698836
curr_Factors:  [1.12288436e+02 3.67455796e-02]
mat_Sqrt:  [[ 2.15247236e+01  0.00000000e+00]
 [-7.66765462e-03  1.75688038e-02]]
grads:  [-0.06761957 28.87131418]
Stock Position:  -0.06761956532552167
Bond Position:  [20.57489216]


portfolio before change:  [12.85200721]
curr_Stock_Price:  114.28688251153827
curr_Factors:  [1.14286883e+02 3.70038679e-02]
mat_Sqrt:  [[ 2.19846698e+01  0.00000000e+00]
 [-7.69455578e-03  1.76304422e-02]]
grads:  [-0.01134512  3.41875728]
Stock Position:  -0.011345120555958708
Bond Position:  [14.14860567]


portfolio before change:  [12.870664]
curr_Stock_Price:  112.95422115574594
curr_Factors:  [1.12954221e+02 3.76556797e-02]
mat_Sqrt:  [[ 2.19188473e+01  0.00000000e+00]
 [-7.76202857e-03  1.77850417e-02]]
grads:  [4.08956801e-02 8.27830807e+01]
Stock Position:  0.040895680083357006
Bond Position:  [8.25132431]


portfolio before change:  [12.90368129]
curr_Stock_Price:  113.71112749723056
curr_Factors:  [1.13711127e+02 3.78316867e-02]
mat_Sqrt:  [[ 2.21172343e+01  0.00000000e+00]
 [-7.78014774e-03  1.78265580e-02]]
grads:  [ -0.05547407 -17.93491825]
Stock Position:  -0.055474073397786
Bond Position:  [19.21170072]


portfolio before change:  [12.86886749]
curr_Stock_Price:  114.42528680029106
curr_Factors:  [1.14425287e+02 3.62203247e-02]
mat_Sqrt:  [[ 2.17770064e+01  0.00000000e+00]
 [-7.61265522e-03  1.74427844e-02]]
grads:  [-7.90157107e-03 -1.70692705e+01]
Stock Position:  -0.00790157107402631
Bond Position:  [13.77300703]


portfolio before change:  [12.8766768]
curr_Stock_Price:  113.8727854814771
curr_Factors:  [1.13872785e+02 3.46407074e-02]
mat_Sqrt:  [[ 2.11940191e+01  0.00000000e+00]
 [-7.44480570e-03  1.70581928e-02]]
grads:  [ -0.01126254 -10.67702071]
Stock Position:  -0.011262540228172174
Bond Position:  [14.15917363]


portfolio before change:  [12.89945085]
curr_Stock_Price:  112.16501731532037
curr_Factors:  [1.12165017e+02 3.48567050e-02]
mat_Sqrt:  [[ 2.09411532e+01  0.00000000e+00]
 [-7.46798018e-03  1.71112922e-02]]
grads:  [7.26975925e-03 8.68304319e+00]
Stock Position:  0.007269759246522198
Bond Position:  [12.08403817]


portfolio before change:  [12.89739824]
curr_Stock_Price:  111.46705877490112
curr_Factors:  [1.11467059e+02 3.58412607e-02]
mat_Sqrt:  [[ 2.11027076e+01  0.00000000e+00]
 [-7.57271531e-03  1.73512706e-02]]
grads:  [-0.0065898  -3.45646475]
Stock Position:  -0.006589800641471797
Bond Position:  [13.63194394]


portfolio before change:  [12.89583278]
curr_Stock_Price:  112.22184321736265
curr_Factors:  [1.12221843e+02 3.60316948e-02]
mat_Sqrt:  [[ 2.13019687e+01  0.00000000e+00]
 [-7.59280658e-03  1.73973054e-02]]
grads:  [0.00927131 4.91034264]
Stock Position:  0.00927131048217856
Bond Position:  [11.85538922]


portfolio before change:  [12.89685724]
curr_Stock_Price:  112.01262237771698
curr_Factors:  [1.12012622e+02 3.62940070e-02]
mat_Sqrt:  [[ 2.13395091e+01  0.00000000e+00]
 [-7.62039442e-03  1.74605171e-02]]
grads:  [-1.47147247e-02 -4.05656737e+01]
Stock Position:  -0.014714724669918968
Bond Position:  [14.54509214]


portfolio before change:  [12.88355851]
curr_Stock_Price:  113.1635416962298
curr_Factors:  [1.13163542e+02 3.44452378e-02]
mat_Sqrt:  [[ 2.10025064e+01  0.00000000e+00]
 [-7.42377132e-03  1.70099970e-02]]
grads:  [-0.01495547  9.58193878]
Stock Position:  -0.014955473425026605
Bond Position:  [14.57597285]


portfolio before change:  [12.89420179]
curr_Stock_Price:  112.6955635086668
curr_Factors:  [1.12695564e+02 3.55820599e-02]
mat_Sqrt:  [[ 2.12579980e+01  0.00000000e+00]
 [-7.54528302e-03  1.72884153e-02]]
grads:  [-0.00985869 -5.34919886]
Stock Position:  -0.009858685329555411
Bond Position:  [14.00523189]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.89040752]
Stock Price:  113.4356238594688
PL:  [-0.54521634]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 7.47781904e-02  2.73651337e-02]
 [ 4.63363517e-02 -5.10327689e-02]
 [ 6.08949479e-01 -2.49867413e-01]
 [ 3.58170052e-02 -1.05374300e-01]
 [ 1.15728258e-01 -8.72499898e-03]
 [ 2.18774569e-02 -8.47626058e-02]
 [-6.19840053e-02 -1.26386741e-01]
 [-1.29057694e+00  7.38570772e-01]
 [ 5.99752458e-02 -7.76197212e-02]
 [ 1.33070151e-01  4.02328151e-01]
 [-3.37829115e-01 -4.78619544e-02]
 [ 5.23395748e-03 -9.30899886e-03]
 [ 3.36626376e-03 -6.21808653e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15562817e-01 -6.14922634e-02]
 [ 3.36248970e-02 -2.67160832e-02]
 [-1.23887113e-01 -6.93824031e-01]
 [-4.16518762e-01  5.54659582e-02]
 [-3.00265509e-02 -8.42974924e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.48666453]
curr_Stock_Price:  98.02512533346392
curr_Factors:  [9.80251253e+01 3.94089322e-02]
mat_Sqrt:  [[ 1.94596372e+01  0.00000000e+00]
 [-7.94067324e-03  1.81943681e-02]]
grads:  [0.00445647 1.50404419]
Stock Position:  0.004456471248556834
Bond Position:  [-10.92351069]


portfolio before change:  [-10.48680435]
curr_Stock_Price:  98.60661682847027
curr_Factors:  [9.86066168e+01 3.94413329e-02]
mat_Sqrt:  [[ 1.95831184e+01  0.00000000e+00]
 [-7.94393685e-03  1.82018460e-02]]
grads:  [ 1.22880457e-03 -2.80371392e+00]
Stock Position:  0.00122880456981257
Bond Position:  [-10.60797261]


portfolio before change:  [-10.48947234]
curr_Stock_Price:  98.5938730232931
curr_Factors:  [9.85938730e+01 4.14277313e-02]
mat_Sqrt:  [[ 2.00676031e+01  0.00000000e+00]
 [-8.14152136e-03  1.86545689e-02]]
grads:  [  0.02491072 -13.39443509]
Stock Position:  0.024910717941589666
Bond Position:  [-12.9455165]


portfolio before change:  [-10.45905806]
curr_Stock_Price:  99.94473991775362
curr_Factors:  [9.99447399e+01 3.99076348e-02]
mat_Sqrt:  [[ 1.99658561e+01  0.00000000e+00]
 [-7.99075814e-03  1.83091270e-02]]
grads:  [-5.09475266e-04 -5.75528807e+00]
Stock Position:  -0.0005094752655260477
Bond Position:  [-10.40813868]


portfolio before change:  [-10.46160691]
curr_Stock_Price:  99.83972050642258
curr_Factors:  [9.98397205e+01 3.89210050e-02]
mat_Sqrt:  [[ 1.96967866e+01  0.00000000e+00]
 [-7.89136287e-03  1.80813839e-02]]
grads:  [ 0.00568216 -0.48254044]
Stock Position:  0.005682163201473071
Bond Position:  [-11.0289125]


portfolio before change:  [-10.47087272]
curr_Stock_Price:  98.69434122998712
curr_Factors:  [9.86943412e+01 3.93356714e-02]
mat_Sqrt:  [[ 1.95742683e+01  0.00000000e+00]
 [-7.93328899e-03  1.81774487e-02]]
grads:  [-7.72237147e-04 -4.66306396e+00]
Stock Position:  -0.0007722371471500308
Bond Position:  [-10.39465728]


portfolio before change:  [-10.47412302]
curr_Stock_Price:  99.53775806079963
curr_Factors:  [9.95377581e+01 3.78146192e-02]
mat_Sqrt:  [[ 1.93560939e+01  0.00000000e+00]
 [-7.77839255e-03  1.78225363e-02]]
grads:  [-6.05203208e-03 -7.09140038e+00]
Stock Position:  -0.0060520320817324235
Bond Position:  [-9.87171732]


portfolio before change:  [-10.48031109]
curr_Stock_Price:  100.15239910686391
curr_Factors:  [1.00152399e+02 3.88054002e-02]
mat_Sqrt:  [[ 1.97291076e+01  0.00000000e+00]
 [-7.87963453e-03  1.80545108e-02]]
grads:  [-0.04907664 40.90782511]
Stock Position:  -0.04907663594898003
Bond Position:  [-5.56516826]


portfolio before change:  [-10.58322307]
curr_Stock_Price:  102.2210109862451
curr_Factors:  [1.02221011e+02 3.95858846e-02]
mat_Sqrt:  [[ 2.03380986e+01  0.00000000e+00]
 [-7.95848072e-03  1.82351702e-02]]
grads:  [ 1.28326756e-03 -4.25659429e+00]
Stock Position:  0.0012832675607816597
Bond Position:  [-10.71439997]


portfolio before change:  [-10.58373437]
curr_Stock_Price:  103.91015837125155
curr_Factors:  [1.03910158e+02 3.78098088e-02]
mat_Sqrt:  [[ 2.02050648e+01  0.00000000e+00]
 [-7.77789779e-03  1.78214027e-02]]
grads:  [1.52763950e-02 2.25755603e+01]
Stock Position:  0.015276395042926955
Bond Position:  [-12.171107]


portfolio before change:  [-10.58409832]
curr_Stock_Price:  104.0855404670629
curr_Factors:  [1.04085540e+02 3.59360487e-02]
mat_Sqrt:  [[ 1.97312938e+01  0.00000000e+00]
 [-7.58272233e-03  1.73741995e-02]]
grads:  [-0.01818015 -2.75477177]
Stock Position:  -0.018180145113002803
Bond Position:  [-8.69180809]


portfolio before change:  [-10.55694809]
curr_Stock_Price:  102.47260179228722
curr_Factors:  [1.02472602e+02 3.67982451e-02]
mat_Sqrt:  [[ 1.96571846e+01  0.00000000e+00]
 [-7.67314748e-03  1.75813896e-02]]
grads:  [ 5.95801136e-05 -5.29480268e-01]
Stock Position:  5.958011360537463e-05
Bond Position:  [-10.56305342]


portfolio before change:  [-10.55945211]
curr_Stock_Price:  104.77324334608626
curr_Factors:  [1.04773243e+02 3.57065699e-02]
mat_Sqrt:  [[ 1.97981429e+01  0.00000000e+00]
 [-7.55847285e-03  1.73186370e-02]]
grads:  [-1.20070306e-03 -3.59040179e+00]
Stock Position:  -0.001200703059063251
Bond Position:  [-10.43365056]


portfolio before change:  [-10.5631845]
curr_Stock_Price:  105.70907462514981
curr_Factors:  [1.05709075e+02 3.48698536e-02]
mat_Sqrt:  [[ 1.97395539e+01  0.00000000e+00]
 [-7.46938858e-03  1.71145193e-02]]
grads:  [7.71228888e-03 8.68140594e+00]
Stock Position:  0.00771228887838577
Bond Position:  [-11.37844342]


portfolio before change:  [-10.56945871]
curr_Stock_Price:  105.26442898978242
curr_Factors:  [1.05264429e+02 3.56112914e-02]
mat_Sqrt:  [[ 1.98644022e+01  0.00000000e+00]
 [-7.54838169e-03  1.72955152e-02]]
grads:  [-0.00716861 -3.55538777]
Stock Position:  -0.007168614454253273
Bond Position:  [-9.8148586]


portfolio before change:  [-10.59255308]
curr_Stock_Price:  108.14369550645088
curr_Factors:  [1.08143696e+02 3.30053299e-02]
mat_Sqrt:  [[ 1.96468643e+01  0.00000000e+00]
 [-7.26694763e-03  1.66506688e-02]]
grads:  [ 1.11799227e-03 -1.60450512e+00]
Stock Position:  0.0011179922671073943
Bond Position:  [-10.71345689]


portfolio before change:  [-10.59370396]
curr_Stock_Price:  109.51026823606577
curr_Factors:  [1.09510268e+02 3.15409742e-02]
mat_Sqrt:  [[ 1.94487814e+01  0.00000000e+00]
 [-7.10391151e-03  1.62771061e-02]]
grads:  [-2.19395107e-02 -4.26257608e+01]
Stock Position:  -0.02193951065450787
Bond Position:  [-8.19110226]


portfolio before change:  [-10.5616234]
curr_Stock_Price:  107.95469135442978
curr_Factors:  [1.07954691e+02 3.41110292e-02]
mat_Sqrt:  [[ 1.99383370e+01  0.00000000e+00]
 [-7.38766856e-03  1.69272752e-02]]
grads:  [-0.01967624  3.27672101]
Stock Position:  -0.019676236470439923
Bond Position:  [-8.43748136]


portfolio before change:  [-10.59492917]
curr_Stock_Price:  109.54016428968214
curr_Factors:  [1.09540164e+02 3.52906452e-02]
mat_Sqrt:  [[ 2.05780012e+01  0.00000000e+00]
 [-7.51432182e-03  1.72174743e-02]]
grads:  [-3.24701084e-03 -4.89604289e+00]
Stock Position:  -0.003247010836552367
Bond Position:  [-10.23925107]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.60284764]
Stock Price:  111.19039985521319
PL:  [-21.79324749]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 4.63081588e-02  7.83725789e-02]
 [ 4.05546260e-02 -5.97210467e-02]
 [ 4.47922627e-01 -2.00721422e-01]
 [-8.23101516e-02 -8.16082388e-02]
 [ 3.92451009e-01 -1.77175600e-02]
 [-2.20672736e-01 -2.76958416e-01]
 [-5.27740872e-02 -6.01437219e-02]
 [-1.34977766e+00  6.02848561e-01]
 [ 4.38097064e-02 -7.71796279e-03]
 [ 1.94314376e-02 -6.79194504e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 6.72389534e-02 -3.92043299e-02]
 [ 1.23882122e-01 -3.59877992e-02]
 [-9.38653235e-02 -1.42531025e-01]
 [ 1.35943052e-01  1.99445114e-01]
 [-6.13065303e-02 -1.10478781e-01]
 [-2.00232462e-01 -2.53923851e-01]
 [ 3.67309760e-01 -4.14790318e-01]
 [-2.98430761e-01 -2.01564545e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.94640446]
curr_Stock_Price:  98.55837413022635
curr_Factors:  [9.85583741e+01 4.11594209e-02]
mat_Sqrt:  [[ 1.99953108e+01  0.00000000e+00]
 [-8.11511389e-03  1.85940618e-02]]
grads:  [4.02658190e-03 4.21492515e+00]
Stock Position:  0.004026581899189569
Bond Position:  [-7.34325783]


portfolio before change:  [-6.95085386]
curr_Stock_Price:  97.90934814492465
curr_Factors:  [9.79093481e+01 4.16200393e-02]
mat_Sqrt:  [[ 1.99744763e+01  0.00000000e+00]
 [-8.16039600e-03  1.86978162e-02]]
grads:  [ 7.25437009e-04 -3.19401186e+00]
Stock Position:  0.0007254370093095556
Bond Position:  [-7.02188093]


portfolio before change:  [-6.95406111]
curr_Stock_Price:  95.908411213799
curr_Factors:  [9.59084112e+01 4.27516606e-02]
mat_Sqrt:  [[ 1.98304784e+01  0.00000000e+00]
 [-8.27058988e-03  1.89503021e-02]]
grads:  [  0.01817004 -10.5919906 ]
Stock Position:  0.01817004156791151
Bond Position:  [-8.69672092]


portfolio before change:  [-6.95945631]
curr_Stock_Price:  95.73115501446992
curr_Factors:  [9.57311550e+01 4.26689954e-02]
mat_Sqrt:  [[ 1.97746820e+01  0.00000000e+00]
 [-8.26258995e-03  1.89319719e-02]]
grads:  [-0.00596353 -4.31060426]
Stock Position:  -0.005963529887719796
Bond Position:  [-6.38856071]


portfolio before change:  [-6.9553706]
curr_Stock_Price:  94.77818703590131
curr_Factors:  [9.4778187e+01 4.3534362e-02]
mat_Sqrt:  [[ 1.97753641e+01  0.00000000e+00]
 [-8.34595586e-03  1.91229872e-02]]
grads:  [ 0.01945443 -0.92650587]
Stock Position:  0.019454429717437865
Bond Position:  [-8.79922618]


portfolio before change:  [-6.93322689]
curr_Stock_Price:  96.02951089036172
curr_Factors:  [9.60295109e+01 4.21627535e-02]
mat_Sqrt:  [[ 1.97182877e+01  0.00000000e+00]
 [-8.21342837e-03  1.88193286e-02]]
grads:  [ -0.01732135 -14.71670015]
Stock Position:  -0.017321346720902228
Bond Position:  [-5.26986643]


portfolio before change:  [-6.92399076]
curr_Stock_Price:  95.42021910267042
curr_Factors:  [9.54202191e+01 4.30235313e-02]
mat_Sqrt:  [[ 1.97921711e+01  0.00000000e+00]
 [-8.29684579e-03  1.90104619e-02]]
grads:  [-0.00399264 -3.16371702]
Stock Position:  -0.003992637244459278
Bond Position:  [-6.54301244]


portfolio before change:  [-6.92058124]
curr_Stock_Price:  94.15652284434482
curr_Factors:  [9.41565228e+01 4.44817389e-02]
mat_Sqrt:  [[ 1.98582645e+01  0.00000000e+00]
 [-8.43627775e-03  1.93299407e-02]]
grads:  [-0.05472145 31.18729492]
Stock Position:  -0.054721447830788535
Bond Position:  [-1.76819999]


portfolio before change:  [-7.03234604]
curr_Stock_Price:  96.19087503450473
curr_Factors:  [9.61908750e+01 4.47973239e-02]
mat_Sqrt:  [[ 2.03591626e+01  0.00000000e+00]
 [-8.46615133e-03  1.93983897e-02]]
grads:  [ 0.00198639 -0.39786616]
Stock Position:  0.001986393646696029
Bond Position:  [-7.22341899]


portfolio before change:  [-7.03546902]
curr_Stock_Price:  95.52791608327246
curr_Factors:  [9.55279161e+01 4.65240552e-02]
mat_Sqrt:  [[ 2.06048323e+01  0.00000000e+00]
 [-8.62777424e-03  1.97687143e-02]]
grads:  [-4.95565341e-04 -3.43570399e+00]
Stock Position:  -0.0004955653408217158
Bond Position:  [-6.9881287]


portfolio before change:  [-7.03656438]
curr_Stock_Price:  94.2124644452355
curr_Factors:  [9.42124644e+01 4.85268066e-02]
mat_Sqrt:  [[ 2.07538761e+01  0.00000000e+00]
 [-8.81152033e-03  2.01897295e-02]]
grads:  [1.30050116e-02 1.73141893e+01]
Stock Position:  0.013005011649808522
Bond Position:  [-8.26179858]


portfolio before change:  [-7.02433667]
curr_Stock_Price:  95.31153445486729
curr_Factors:  [9.53115345e+01 4.54211577e-02]
mat_Sqrt:  [[ 2.03130230e+01  0.00000000e+00]
 [-8.52489603e-03  1.95329907e-02]]
grads:  [ 0.00246781 -2.00708281]
Stock Position:  0.002467814906891216
Bond Position:  [-7.25954789]


portfolio before change:  [-7.02615128]
curr_Stock_Price:  95.31173654407503
curr_Factors:  [9.53117365e+01 4.49782338e-02]
mat_Sqrt:  [[ 2.02137822e+01  0.00000000e+00]
 [-8.48322899e-03  1.94375195e-02]]
grads:  [ 0.00535158 -1.85146048]
Stock Position:  0.005351584265526332
Bond Position:  [-7.53622007]


portfolio before change:  [-7.03661664]
curr_Stock_Price:  93.7082742629156
curr_Factors:  [9.37082743e+01 4.56857257e-02]
mat_Sqrt:  [[ 2.00294122e+01  0.00000000e+00]
 [-8.54968778e-03  1.95897957e-02]]
grads:  [-0.00779209 -7.27577906]
Stock Position:  -0.007792089020900772
Bond Position:  [-6.30643342]


portfolio before change:  [-7.03099771]
curr_Stock_Price:  92.78480717867902
curr_Factors:  [9.27848072e+01 4.55724975e-02]
mat_Sqrt:  [[ 1.98074371e+01  0.00000000e+00]
 [-8.53908637e-03  1.95655048e-02]]
grads:  [ 0.01125779 10.19371164]
Stock Position:  0.01125779349412478
Bond Position:  [-8.0755499]


portfolio before change:  [-7.02716807]
curr_Stock_Price:  93.30433818308651
curr_Factors:  [9.33043382e+01 4.57002544e-02]
mat_Sqrt:  [[ 1.99462448e+01  0.00000000e+00]
 [-8.55104713e-03  1.95929104e-02]]
grads:  [-5.49092947e-03 -5.63871213e+00]
Stock Position:  -0.005490929465038785
Bond Position:  [-6.51484053]


portfolio before change:  [-7.02642877]
curr_Stock_Price:  92.87304129821435
curr_Factors:  [9.28730413e+01 4.69898009e-02]
mat_Sqrt:  [[ 2.01322108e+01  0.00000000e+00]
 [-8.67085240e-03  1.98674187e-02]]
grads:  [ -0.01545056 -12.78091808]
Stock Position:  -0.015450559230599945
Bond Position:  [-5.59148834]


portfolio before change:  [-7.02767]
curr_Stock_Price:  92.86289195006438
curr_Factors:  [9.28628920e+01 4.68797002e-02]
mat_Sqrt:  [[ 2.01064138e+01  0.00000000e+00]
 [-8.66068821e-03  1.98441297e-02]]
grads:  [ 9.26472644e-03 -2.09024193e+01]
Stock Position:  0.009264726439589928
Bond Position:  [-7.88801929]


portfolio before change:  [-7.03738849]
curr_Stock_Price:  92.02679239049667
curr_Factors:  [9.20267924e+01 4.62403387e-02]
mat_Sqrt:  [[ 1.97890428e+01  0.00000000e+00]
 [-8.60142674e-03  1.97083446e-02]]
grads:  [ -0.01952599 -10.22737066]
Stock Position:  -0.01952599446311418
Bond Position:  [-5.24047385]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.03834415]
Stock Price:  92.0086309291051
PL:  [-7.03834415]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.19967245e-02  1.14627774e-01]
 [ 8.46950531e-02 -1.09959029e-02]
 [ 8.40864411e-01 -3.20648709e-01]
 [ 2.72262542e-01 -9.58800330e-02]
 [ 8.60338344e-02 -2.15785382e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-3.54820629e-01 -1.36432142e-01]
 [-1.40507732e+00  7.49166594e-01]
 [ 5.46016196e-02 -7.62255944e-02]
 [ 1.20652408e-01  3.22598916e-01]
 [-3.42726239e-01 -4.95430567e-02]
 [-4.04138458e-02 -1.71197210e-02]
 [ 3.23722337e-02 -4.16205707e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.14903628e-01 -6.11181385e-02]
 [-8.25695334e-02 -9.95440537e-02]
 [-1.54521662e-01 -5.59953371e-01]
 [-1.40580125e-01 -1.08540037e-01]
 [ 1.55917871e-01  5.05402220e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.80799455]
curr_Stock_Price:  100.17824674451174
curr_Factors:  [1.00178247e+02 3.99559513e-02]
mat_Sqrt:  [[ 2.00246145e+01  0.00000000e+00]
 [-7.99559391e-03  1.83202072e-02]]
grads:  [4.09617807e-03 6.25690383e+00]
Stock Position:  0.004096178068976071
Bond Position:  [3.39764662]


portfolio before change:  [3.81124634]
curr_Stock_Price:  100.76471133066688
curr_Factors:  [1.00764711e+02 4.10089810e-02]
mat_Sqrt:  [[ 2.04055335e+01  0.00000000e+00]
 [-8.10026972e-03  1.85600496e-02]]
grads:  [ 0.00391541 -0.59245008]
Stock Position:  0.003915410868006133
Bond Position:  [3.41671109]


portfolio before change:  [3.81947989]
curr_Stock_Price:  102.64938500565162
curr_Factors:  [1.02649385e+02 4.03416047e-02]
mat_Sqrt:  [[ 2.06173544e+01  0.00000000e+00]
 [-8.03408785e-03  1.84084079e-02]]
grads:  [  0.03399669 -17.41860084]
Stock Position:  0.0339966917082037
Bond Position:  [0.3297404]


portfolio before change:  [3.80114639]
curr_Stock_Price:  102.10768674683015
curr_Factors:  [1.02107687e+02 4.12338518e-02]
mat_Sqrt:  [[ 2.07341096e+01  0.00000000e+00]
 [-8.12244809e-03  1.86108666e-02]]
grads:  [ 0.01111295 -5.15183065]
Stock Position:  0.011112947172476694
Bond Position:  [2.66642906]


portfolio before change:  [3.79959672]
curr_Stock_Price:  101.90824774267763
curr_Factors:  [1.01908248e+02 3.98596757e-02]
mat_Sqrt:  [[ 2.03458676e+01  0.00000000e+00]
 [-7.98595524e-03  1.82981222e-02]]
grads:  [ 0.00376569 -1.1792761 ]
Stock Position:  0.0037656879343384445
Bond Position:  [3.41584207]


portfolio before change:  [3.80281682]
curr_Stock_Price:  102.5365595147966
curr_Factors:  [1.02536560e+02 3.80250678e-02]
mat_Sqrt:  [[ 1.99946469e+01  0.00000000e+00]
 [-7.80000696e-03  1.78720612e-02]]
grads:  [-2.89888668e-05 -1.08276130e+00]
Stock Position:  -2.8988866796303656e-05
Bond Position:  [3.80578924]


portfolio before change:  [3.8037257]
curr_Stock_Price:  104.00882816239121
curr_Factors:  [1.04008828e+02 3.91471257e-02]
mat_Sqrt:  [[ 2.05788046e+01  0.00000000e+00]
 [-7.91425304e-03  1.81338318e-02]]
grads:  [-0.0201355  -7.52362454]
Stock Position:  -0.020135498899062746
Bond Position:  [5.89799535]


portfolio before change:  [3.82192132]
curr_Stock_Price:  103.17840785545023
curr_Factors:  [1.03178408e+02 3.78282942e-02]
mat_Sqrt:  [[ 2.00676816e+01  0.00000000e+00]
 [-7.77979888e-03  1.78257586e-02]]
grads:  [-0.0537239  42.02719272]
Stock Position:  -0.05372390481664031
Bond Position:  [9.36506828]


portfolio before change:  [3.85423689]
curr_Stock_Price:  102.62048087667003
curr_Factors:  [1.02620481e+02 3.91248566e-02]
mat_Sqrt:  [[ 2.02983354e+01  0.00000000e+00]
 [-7.91200168e-03  1.81286733e-02]]
grads:  [ 1.05102425e-03 -4.20469789e+00]
Stock Position:  0.0010510242512995363
Bond Position:  [3.74638028]


portfolio before change:  [3.85572417]
curr_Stock_Price:  103.14431707684392
curr_Factors:  [1.03144317e+02 3.75705312e-02]
mat_Sqrt:  [[ 1.99925860e+01  0.00000000e+00]
 [-7.75324770e-03  1.77649222e-02]]
grads:  [1.30771536e-02 1.81593205e+01]
Stock Position:  0.013077153601787413
Bond Position:  [2.50689009]


portfolio before change:  [3.86948635]
curr_Stock_Price:  104.14876942620975
curr_Factors:  [1.04148769e+02 3.77130118e-02]
mat_Sqrt:  [[ 2.02255226e+01  0.00000000e+00]
 [-7.76793530e-03  1.77985758e-02]]
grads:  [-0.0180143  -2.78354051]
Stock Position:  -0.01801429855347337
Bond Position:  [5.74565337]


portfolio before change:  [3.84770421]
curr_Stock_Price:  105.43767518288337
curr_Factors:  [1.05437675e+02 3.68606275e-02]
mat_Sqrt:  [[ 2.02431076e+01  0.00000000e+00]
 [-7.67964869e-03  1.75962857e-02]]
grads:  [-0.00236552 -0.97291674]
Stock Position:  -0.0023655214158603117
Bond Position:  [4.09711928]


portfolio before change:  [3.8538293]
curr_Stock_Price:  103.28141173986387
curr_Factors:  [1.03281412e+02 3.77669697e-02]
mat_Sqrt:  [[ 2.00714263e+01  0.00000000e+00]
 [-7.77349031e-03  1.78113039e-02]]
grads:  [ 7.07848422e-04 -2.33675036e+00]
Stock Position:  0.000707848421618405
Bond Position:  [3.78072172]


portfolio before change:  [3.85614966]
curr_Stock_Price:  105.22400225360668
curr_Factors:  [1.05224002e+02 3.80748012e-02]
mat_Sqrt:  [[ 2.05321127e+01  0.00000000e+00]
 [-7.80510614e-03  1.78837449e-02]]
grads:  [7.41458730e-03 8.30799649e+00]
Stock Position:  0.007414587300072652
Bond Position:  [3.07595711]


portfolio before change:  [3.86851012]
curr_Stock_Price:  106.7873231609406
curr_Factors:  [1.06787323e+02 3.95056928e-02]
mat_Sqrt:  [[ 2.12250901e+01  0.00000000e+00]
 [-7.95041562e-03  1.82166907e-02]]
grads:  [-0.0066703  -3.35506265]
Stock Position:  -0.006670302469265455
Bond Position:  [4.58081387]


portfolio before change:  [3.88359951]
curr_Stock_Price:  104.69685690931719
curr_Factors:  [1.04696857e+02 4.03133596e-02]
mat_Sqrt:  [[ 2.10212308e+01  0.00000000e+00]
 [-8.03127483e-03  1.84019624e-02]]
grads:  [-0.00599461 -5.40942598]
Stock Position:  -0.005994611894864196
Bond Position:  [4.51121654]


portfolio before change:  [3.89188118]
curr_Stock_Price:  103.50349832266667
curr_Factors:  [1.03503498e+02 4.09043521e-02]
mat_Sqrt:  [[ 2.09334008e+01  0.00000000e+00]
 [-8.08992975e-03  1.85363577e-02]]
grads:  [-1.90559266e-02 -3.02083818e+01]
Stock Position:  -0.01905592661155828
Bond Position:  [5.86423625]


portfolio before change:  [3.88721344]
curr_Stock_Price:  103.82539207222075
curr_Factors:  [1.03825392e+02 3.96362905e-02]
mat_Sqrt:  [[ 2.06704571e+01  0.00000000e+00]
 [-7.96354599e-03  1.82467762e-02]]
grads:  [-0.00909273 -5.94845006]
Stock Position:  -0.009092729750481525
Bond Position:  [4.83126967]


portfolio before change:  [3.88844183]
curr_Stock_Price:  103.82314579876126
curr_Factors:  [1.03823146e+02 4.02879830e-02]
mat_Sqrt:  [[ 2.08392433e+01  0.00000000e+00]
 [-8.02874665e-03  1.83961696e-02]]
grads:  [0.0085404  2.74732311]
Stock Position:  0.008540398010731273
Bond Position:  [3.00175084]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.87479113]
Stock Price:  102.1368969840092
PL:  [1.73789414]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.31040829e-03  1.07389774e-02]
 [-3.20992313e-01  2.30732861e-01]
 [ 1.07575622e+00 -3.92338557e-01]
 [ 4.56887689e-01 -5.46007150e-02]
 [ 2.41132071e-01 -3.07038393e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-3.25908908e-01 -1.46151400e-01]
 [-1.43002788e+00  7.51684793e-01]
 [ 6.69456930e-02 -7.76533706e-02]
 [ 8.85568954e-02  1.77651697e-01]
 [-1.58489546e-01 -5.68655606e-02]
 [-4.67736010e-03 -9.63572505e-03]
 [ 3.70057470e-02 -3.83430033e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.16864314e-01 -6.22309325e-02]
 [-1.41091768e-01 -1.28973338e-01]
 [-1.67676347e-01 -5.06441625e-01]
 [ 2.75708212e-01 -2.37227377e-01]
 [ 8.95683080e-02 -8.70282536e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.94185288]
curr_Stock_Price:  102.60839604633401
curr_Factors:  [1.02608396e+02 4.00946863e-02]
mat_Sqrt:  [[ 2.05459539e+01  0.00000000e+00]
 [-8.00946304e-03  1.83519853e-02]]
grads:  [2.91896025e-04 5.85167066e-01]
Stock Position:  0.0002918960252346826
Bond Position:  [19.9119019]


portfolio before change:  [19.9471005]
curr_Stock_Price:  103.530047776907
curr_Factors:  [1.03530048e+02 4.08011658e-02]
mat_Sqrt:  [[ 2.09123433e+01  0.00000000e+00]
 [-8.07971938e-03  1.85129628e-02]]
grads:  [-1.05340771e-02  1.24633136e+01]
Stock Position:  -0.010534077072061703
Bond Position:  [21.03769401]


portfolio before change:  [19.92938639]
curr_Stock_Price:  105.71098873873332
curr_Factors:  [1.05710989e+02 4.00629498e-02]
mat_Sqrt:  [[ 2.11588274e+01  0.00000000e+00]
 [-8.00629251e-03  1.83447207e-02]]
grads:  [  0.04274933 -21.38700084]
Stock Position:  0.04274932707146737
Bond Position:  [15.41031275]


portfolio before change:  [19.89338613]
curr_Stock_Price:  104.77873287684376
curr_Factors:  [1.04778733e+02 4.14144892e-02]
mat_Sqrt:  [[ 2.13230486e+01  0.00000000e+00]
 [-8.14022006e-03  1.86515873e-02]]
grads:  [ 0.02030938 -2.92740313]
Stock Position:  0.020309384075715316
Bond Position:  [17.76539461]


portfolio before change:  [19.88385402]
curr_Stock_Price:  104.09067580678854
curr_Factors:  [1.04090676e+02 3.95401279e-02]
mat_Sqrt:  [[ 2.06981182e+01  0.00000000e+00]
 [-7.95387985e-03  1.82246282e-02]]
grads:  [ 0.01100254 -1.68474434]
Stock Position:  0.011002537278887177
Bond Position:  [18.73859248]


portfolio before change:  [19.87969409]
curr_Stock_Price:  103.28675522528825
curr_Factors:  [1.03286755e+02 3.87069254e-02]
mat_Sqrt:  [[ 2.03207144e+01  0.00000000e+00]
 [-7.86963027e-03  1.80315882e-02]]
grads:  [-2.85237096e-05 -1.07318201e+00]
Stock Position:  -2.8523709641509494e-05
Bond Position:  [19.88264021]


portfolio before change:  [19.88465265]
curr_Stock_Price:  103.73275803727864
curr_Factors:  [1.03732758e+02 3.57091386e-02]
mat_Sqrt:  [[ 1.96022359e+01  0.00000000e+00]
 [-7.55874472e-03  1.73192599e-02]]
grads:  [-0.01988011 -8.43866314]
Stock Position:  -0.019880110117128442
Bond Position:  [21.9468713]


portfolio before change:  [19.88888357]
curr_Stock_Price:  103.79596133107324
curr_Factors:  [1.03795961e+02 3.56568392e-02]
mat_Sqrt:  [[ 1.95998107e+01  0.00000000e+00]
 [-7.55320745e-03  1.73065724e-02]]
grads:  [-0.05622328 43.43348721]
Stock Position:  -0.0562232847986119
Bond Position:  [25.72463346]


portfolio before change:  [20.01001614]
curr_Stock_Price:  101.75587043506698
curr_Factors:  [1.01755870e+02 3.39187671e-02]
mat_Sqrt:  [[ 1.87404279e+01  0.00000000e+00]
 [-7.36681936e-03  1.68795037e-02]]
grads:  [ 1.76383292e-03 -4.60045343e+00]
Stock Position:  0.001763832918729956
Bond Position:  [19.83053579]


portfolio before change:  [20.01442208]
curr_Stock_Price:  101.44274004678195
curr_Factors:  [1.01442740e+02 3.52101927e-02]
mat_Sqrt:  [[ 1.90351004e+01  0.00000000e+00]
 [-7.50575169e-03  1.71978376e-02]]
grads:  [8.72548339e-03 1.03298857e+01]
Stock Position:  0.008725483387978612
Bond Position:  [19.12928514]


portfolio before change:  [20.02166215]
curr_Stock_Price:  101.72434540666377
curr_Factors:  [1.01724345e+02 3.51756583e-02]
mat_Sqrt:  [[ 1.90785788e+01  0.00000000e+00]
 [-7.50206993e-03  1.71894017e-02]]
grads:  [-0.00960804 -3.30817568]
Stock Position:  -0.00960803804371302
Bond Position:  [20.99903353]


portfolio before change:  [20.0105551]
curr_Stock_Price:  103.42682181242945
curr_Factors:  [1.03426822e+02 3.41264628e-02]
mat_Sqrt:  [[ 1.91063979e+01  0.00000000e+00]
 [-7.38933965e-03  1.69311041e-02]]
grads:  [-4.64908945e-04 -5.69113802e-01]
Stock Position:  -0.000464908944893165
Bond Position:  [20.05863916]


portfolio before change:  [20.01575333]
curr_Stock_Price:  103.03333160442168
curr_Factors:  [1.03033332e+02 3.33979804e-02]
mat_Sqrt:  [[ 1.88294591e+01  0.00000000e+00]
 [-7.31004573e-03  1.67494190e-02]]
grads:  [ 1.07658368e-03 -2.28921394e+00]
Stock Position:  0.0010765836799907906
Bond Position:  [19.90482932]


portfolio before change:  [20.01981231]
curr_Stock_Price:  102.18078200372945
curr_Factors:  [1.02180782e+02 3.13477378e-02]
mat_Sqrt:  [[ 1.80914062e+01  0.00000000e+00]
 [-7.08211695e-03  1.62271685e-02]]
grads:  [8.41488716e-03 9.15613154e+00]
Stock Position:  0.00841488715573177
Bond Position:  [19.15997256]


portfolio before change:  [20.02581756]
curr_Stock_Price:  102.32512749679113
curr_Factors:  [1.02325127e+02 2.98008476e-02]
mat_Sqrt:  [[ 1.76643070e+01  0.00000000e+00]
 [-6.90516881e-03  1.58217294e-02]]
grads:  [-0.0081534 -3.9332573]
Stock Position:  -0.0081533976668826
Bond Position:  [20.86011501]


portfolio before change:  [20.03958267]
curr_Stock_Price:  101.27655425403974
curr_Factors:  [1.01276554e+02 2.94658102e-02]
mat_Sqrt:  [[ 1.73847364e+01  0.00000000e+00]
 [-6.86624324e-03  1.57325397e-02]]
grads:  [-0.01135366 -8.19787147]
Stock Position:  -0.011353657769736288
Bond Position:  [21.18944201]


portfolio before change:  [20.03994557]
curr_Stock_Price:  101.71122679447375
curr_Factors:  [1.01711227e+02 2.94820333e-02]
mat_Sqrt:  [[ 1.74641563e+01  0.00000000e+00]
 [-6.86813317e-03  1.57368701e-02]]
grads:  [-2.22573359e-02 -3.21818521e+01]
Stock Position:  -0.022257335914079007
Bond Position:  [22.30376651]


portfolio before change:  [20.07231835]
curr_Stock_Price:  100.50730295719417
curr_Factors:  [1.00507303e+02 2.82495523e-02]
mat_Sqrt:  [[ 1.68928686e+01  0.00000000e+00]
 [-6.72304126e-03  1.54044227e-02]]
grads:  [ 1.01920935e-02 -1.53999524e+01]
Stock Position:  0.010192093529763285
Bond Position:  [19.04793852]


portfolio before change:  [20.07998165]
curr_Stock_Price:  100.79190806955785
curr_Factors:  [1.00791908e+02 2.88335355e-02]
mat_Sqrt:  [[ 1.71149098e+01  0.00000000e+00]
 [-6.79217614e-03  1.55628307e-02]]
grads:  [ 3.01410085e-03 -5.59205812e+00]
Stock Position:  0.003014100846101762
Bond Position:  [19.77618467]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.08947397]
Stock Price:  102.30070253716848
PL:  [17.78877144]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.99952628e-02  1.22937005e-01]
 [ 8.05680215e-02 -7.27841316e-03]
 [ 6.73551707e-01 -2.69584252e-01]
 [ 1.99436973e-01 -1.18591297e-01]
 [ 9.87969684e-02 -2.24944925e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-2.28080326e-01 -1.75942301e-01]
 [-1.39921704e+00  7.49097902e-01]
 [ 3.81712231e-03 -7.03016723e-02]
 [ 1.79946447e-01  8.17632814e-01]
 [-6.79178587e-01 -1.71874293e-01]
 [-4.13459807e-02 -1.70292617e-01]
 [-1.13681295e-01 -1.46934614e-01]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.12045137e-01 -5.94957919e-02]
 [ 1.54775343e-01  7.90138886e-02]
 [-6.98273875e-02 -7.07260137e-01]
 [-3.99603432e-01  1.15075457e-01]
 [-1.54338333e-01 -9.32576605e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.32241633]
curr_Stock_Price:  99.9544827310017
curr_Factors:  [9.99544827e+01 3.95544127e-02]
mat_Sqrt:  [[ 1.98792386e+01  0.00000000e+00]
 [-7.95531648e-03  1.82279200e-02]]
grads:  [3.70483861e-03 6.74443411e+00]
Stock Position:  0.0037048386052149795
Bond Position:  [1.9521011]


portfolio before change:  [2.32482628]
curr_Stock_Price:  100.47322692885506
curr_Factors:  [1.00473227e+02 3.98159819e-02]
mat_Sqrt:  [[ 2.00483699e+01  0.00000000e+00]
 [-7.98157698e-03  1.82880903e-02]]
grads:  [ 0.00386024 -0.39798651]
Stock Position:  0.003860237120777299
Bond Position:  [1.9369758]


portfolio before change:  [2.32267667]
curr_Stock_Price:  99.7909081817871
curr_Factors:  [9.97909082e+01 3.98958584e-02]
mat_Sqrt:  [[ 1.99321837e+01  0.00000000e+00]
 [-7.98957906e-03  1.83064254e-02]]
grads:  [  0.02788934 -14.72620929]
Stock Position:  0.027889342197833303
Bond Position:  [-0.46042612]


portfolio before change:  [2.36077308]
curr_Stock_Price:  101.16102053972557
curr_Factors:  [1.01161021e+02 3.70641443e-02]
mat_Sqrt:  [[ 1.94755706e+01  0.00000000e+00]
 [-7.70082014e-03  1.76447956e-02]]
grads:  [ 0.00758281 -6.72103546]
Stock Position:  0.007582806706095308
Bond Position:  [1.59368862]


portfolio before change:  [2.36801016]
curr_Stock_Price:  102.06287768466693
curr_Factors:  [1.02062878e+02 3.50994199e-02]
mat_Sqrt:  [[ 1.91213160e+01  0.00000000e+00]
 [-7.49393567e-03  1.71707637e-02]]
grads:  [ 0.00465342 -1.31004613]
Stock Position:  0.004653422757845676
Bond Position:  [1.89306844]


portfolio before change:  [2.37010232]
curr_Stock_Price:  102.41075810500993
curr_Factors:  [1.02410758e+02 3.43256796e-02]
mat_Sqrt:  [[ 1.89738365e+01  0.00000000e+00]
 [-7.41087628e-03  1.69804508e-02]]
grads:  [-3.05484954e-05 -1.13961498e+00]
Stock Position:  -3.054849544421769e-05
Bond Position:  [2.37323082]


portfolio before change:  [2.37068368]
curr_Stock_Price:  102.8043504642719
curr_Factors:  [1.02804350e+02 3.43132898e-02]
mat_Sqrt:  [[ 1.90433203e+01  0.00000000e+00]
 [-7.40953870e-03  1.69773860e-02]]
grads:  [ -0.01600917 -10.36333281]
Stock Position:  -0.01600917468802534
Bond Position:  [4.01649649]


portfolio before change:  [2.36969478]
curr_Stock_Price:  102.92885112537691
curr_Factors:  [1.02928851e+02 3.34460661e-02]
mat_Sqrt:  [[ 1.88239017e+01  0.00000000e+00]
 [-7.31530626e-03  1.67614723e-02]]
grads:  [-0.05696396 44.6916528 ]
Stock Position:  -0.05696395600758909
Bond Position:  [8.23292932]


portfolio before change:  [2.2023408]
curr_Stock_Price:  105.9028803163771
curr_Factors:  [1.05902880e+02 3.40212975e-02]
mat_Sqrt:  [[ 1.95336413e+01  0.00000000e+00]
 [-7.37794524e-03  1.69049963e-02]]
grads:  [-1.37532181e-03 -4.15863282e+00]
Stock Position:  -0.0013753218095035242
Bond Position:  [2.34799134]


portfolio before change:  [2.20083687]
curr_Stock_Price:  107.42324998247238
curr_Factors:  [1.07423250e+02 3.48892704e-02]
mat_Sqrt:  [[ 2.00652341e+01  0.00000000e+00]
 [-7.47146790e-03  1.71192836e-02]]
grads:  [2.67522751e-02 4.77609246e+01]
Stock Position:  0.026752275061619018
Bond Position:  [-0.67297946]


portfolio before change:  [2.22862413]
curr_Stock_Price:  108.46822744517003
curr_Factors:  [1.08468227e+02 3.28899737e-02]
mat_Sqrt:  [[ 1.96713564e+01  0.00000000e+00]
 [-7.25423724e-03  1.66215456e-02]]
grads:  [ -0.03833954 -10.3404519 ]
Stock Position:  -0.03833953612512583
Bond Position:  [6.38724566]


portfolio before change:  [2.15826709]
curr_Stock_Price:  110.34498592146113
curr_Factors:  [1.10344986e+02 3.22108901e-02]
mat_Sqrt:  [[ 1.98040478e+01  0.00000000e+00]
 [-7.17895704e-03  1.64490570e-02]]
grads:  [-5.84061262e-03 -1.03527282e+01]
Stock Position:  -0.005840612618062585
Bond Position:  [2.80274941]


portfolio before change:  [2.15471973]
curr_Stock_Price:  111.07232991430098
curr_Factors:  [1.1107233e+02 3.1016502e-02]
mat_Sqrt:  [[ 1.95615061e+01  0.00000000e+00]
 [-7.04460099e-03  1.61412086e-02]]
grads:  [-9.08973046e-03 -9.10307381e+00]
Stock Position:  -0.00908973046414655
Bond Position:  [3.16433727]


portfolio before change:  [2.15316862]
curr_Stock_Price:  111.3300162566163
curr_Factors:  [1.11330016e+02 2.98976693e-02]
mat_Sqrt:  [[ 1.92500091e+01  0.00000000e+00]
 [-6.91637700e-03  1.58474106e-02]]
grads:  [7.90841921e-03 9.37554364e+00]
Stock Position:  0.007908419212138081
Bond Position:  [1.27272418]


portfolio before change:  [2.17011915]
curr_Stock_Price:  113.43313094030266
curr_Factors:  [1.13433131e+02 2.75861932e-02]
mat_Sqrt:  [[ 1.88402129e+01  0.00000000e+00]
 [-6.64363674e-03  1.52224841e-02]]
grads:  [-0.00732535 -3.90841543]
Stock Position:  -0.007325354035284776
Bond Position:  [3.00105699]


portfolio before change:  [2.18124596]
curr_Stock_Price:  112.01661923661618
curr_Factors:  [1.12016619e+02 2.88465644e-02]
mat_Sqrt:  [[ 1.90252122e+01  0.00000000e+00]
 [-6.79371055e-03  1.55663464e-02]]
grads:  [0.00994784 5.07594309]
Stock Position:  0.00994784339596115
Bond Position:  [1.06692217]


portfolio before change:  [2.17046831]
curr_Stock_Price:  110.90638777028744
curr_Factors:  [1.10906388e+02 3.10741288e-02]
mat_Sqrt:  [[ 1.95504177e+01  0.00000000e+00]
 [-7.05114219e-03  1.61561964e-02]]
grads:  [-1.93602522e-02 -4.37764013e+01]
Stock Position:  -0.01936025215706042
Bond Position:  [4.31764395]


portfolio before change:  [2.17151174]
curr_Stock_Price:  110.90825347299683
curr_Factors:  [1.10908253e+02 3.04416587e-02]
mat_Sqrt:  [[ 1.93507598e+01  0.00000000e+00]
 [-6.97901526e-03  1.59909328e-02]]
grads:  [-0.01805512  7.1962942 ]
Stock Position:  -0.018055124888818483
Bond Position:  [4.17397411]


portfolio before change:  [2.14584438]
curr_Stock_Price:  112.38766600206274
curr_Factors:  [1.12387666e+02 2.99274361e-02]
mat_Sqrt:  [[ 1.94425582e+01  0.00000000e+00]
 [-6.91981920e-03  1.58552976e-02]]
grads:  [-0.01003157 -5.88179816]
Stock Position:  -0.010031566349388786
Bond Position:  [3.27326871]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.1379691]
Stock Price:  113.2543008250706
PL:  [-11.11633173]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.65403066e-02  1.22928667e-01]
 [ 2.61813749e-02  1.71584822e-02]
 [ 8.22940059e-01 -3.15178130e-01]
 [ 6.34870683e-03 -1.02685121e-01]
 [ 2.79717759e-01 -9.12804204e-03]
 [-6.06319731e-03 -1.31802982e-01]
 [-4.62662966e-02 -1.03811560e-01]
 [-1.27715554e+00  6.93363527e-01]
 [ 4.24915582e-02 -5.85772570e-03]
 [ 1.77103965e-02 -7.62133274e-02]
 [ 1.15760412e-01  3.37851963e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.50441675e-01 -3.10555230e-02]
 [-7.27647005e-02 -9.67329637e-02]
 [ 5.72525371e-02  5.11345173e-02]
 [-1.43269120e-01 -1.38750739e-01]
 [-1.88585579e-01 -3.99698669e-01]
 [ 2.76192459e-01 -2.38084150e-01]
 [ 5.43388364e-02 -1.11037498e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.04292081]
curr_Stock_Price:  99.91238394542455
curr_Factors:  [9.99123839e+01 3.94542415e-02]
mat_Sqrt:  [[ 1.98456885e+01  0.00000000e+00]
 [-7.94523671e-03  1.82048243e-02]]
grads:  [3.53682743e-03 6.75253247e+00]
Stock Position:  0.003536827431233322
Bond Position:  [1.68954795]


portfolio before change:  [2.04932099]
curr_Stock_Price:  101.60252604792227
curr_Factors:  [1.01602526e+02 4.01171255e-02]
mat_Sqrt:  [[ 2.03502341e+01  0.00000000e+00]
 [-8.01170398e-03  1.83571200e-02]]
grads:  [0.00165452 0.93470448]
Stock Position:  0.001654523991773092
Bond Position:  [1.88121717]


portfolio before change:  [2.0506034]
curr_Stock_Price:  102.09333005600188
curr_Factors:  [1.02093330e+02 4.21666046e-02]
mat_Sqrt:  [[ 2.09643637e+01  0.00000000e+00]
 [-8.21380346e-03  1.88201881e-02]]
grads:  [  0.03269286 -16.74681086]
Stock Position:  0.032692861824002266
Bond Position:  [-1.28711973]


portfolio before change:  [1.97305224]
curr_Stock_Price:  99.73106084445497
curr_Factors:  [9.97310608e+01 4.23079929e-02]
mat_Sqrt:  [[ 2.05135890e+01  0.00000000e+00]
 [-8.22756274e-03  1.88517145e-02]]
grads:  [-1.87518400e-03 -5.44699107e+00]
Stock Position:  -0.0018751840030403642
Bond Position:  [2.16006633]


portfolio before change:  [1.97732532]
curr_Stock_Price:  97.74032314247903
curr_Factors:  [9.77403231e+01 4.33975734e-02]
mat_Sqrt:  [[ 2.03613465e+01  0.00000000e+00]
 [-8.33283369e-03  1.90929206e-02]]
grads:  [ 0.01354203 -0.47808516]
Stock Position:  0.013542029549994623
Bond Position:  [0.65372298]


portfolio before change:  [1.9770617]
curr_Stock_Price:  97.70878631287135
curr_Factors:  [9.77087863e+01 4.14676836e-02]
mat_Sqrt:  [[ 1.98970416e+01  0.00000000e+00]
 [-8.14544620e-03  1.86635619e-02]]
grads:  [-3.19578840e-03 -7.06204863e+00]
Stock Position:  -0.0031957883967608917
Bond Position:  [2.28931831]


portfolio before change:  [1.97423093]
curr_Stock_Price:  98.77367732715167
curr_Factors:  [9.87736773e+01 3.95269302e-02]
mat_Sqrt:  [[ 1.96375709e+01  0.00000000e+00]
 [-7.95255231e-03  1.82215865e-02]]
grads:  [-4.66317225e-03 -5.69717460e+00]
Stock Position:  -0.004663172248952152
Bond Position:  [2.43482961]


portfolio before change:  [1.98117545]
curr_Stock_Price:  97.4150020889117
curr_Factors:  [9.74150021e+01 4.01903401e-02]
mat_Sqrt:  [[ 1.95293004e+01  0.00000000e+00]
 [-8.01901142e-03  1.83738634e-02]]
grads:  [-0.04990178 37.73640369]
Stock Position:  -0.04990178197116051
Bond Position:  [6.84235765]


portfolio before change:  [2.04916352]
curr_Stock_Price:  96.08684784675239
curr_Factors:  [9.60868478e+01 3.96927713e-02]
mat_Sqrt:  [[ 1.91434257e+01  0.00000000e+00]
 [-7.96921791e-03  1.82597721e-02]]
grads:  [ 0.0020861 -0.3207995]
Stock Position:  0.0020860966971406954
Bond Position:  [1.84871707]


portfolio before change:  [2.0502848]
curr_Stock_Price:  96.40277048243527
curr_Factors:  [9.64027705e+01 4.09583772e-02]
mat_Sqrt:  [[ 1.95101625e+01  0.00000000e+00]
 [-8.09527044e-03  1.85485948e-02]]
grads:  [-7.97114148e-04 -4.10884643e+00]
Stock Position:  -0.0007971141476586023
Bond Position:  [2.12712882]


portfolio before change:  [2.05142082]
curr_Stock_Price:  95.64482926544125
curr_Factors:  [9.56448293e+01 4.32313781e-02]
mat_Sqrt:  [[ 1.98866228e+01  0.00000000e+00]
 [-8.31686269e-03  1.90563264e-02]]
grads:  [1.32355855e-02 1.77291234e+01]
Stock Position:  0.013235585516721304
Bond Position:  [0.7855055]


portfolio before change:  [2.08575693]
curr_Stock_Price:  98.22421744164053
curr_Factors:  [9.82242174e+01 4.36113905e-02]
mat_Sqrt:  [[ 2.05124976e+01  0.00000000e+00]
 [-8.35333615e-03  1.91398976e-02]]
grads:  [ 0.00234084 -0.44887298]
Stock Position:  0.002340840160479574
Bond Position:  [1.85582974]


portfolio before change:  [2.08278378]
curr_Stock_Price:  96.75586868826454
curr_Factors:  [9.67558687e+01 4.29845241e-02]
mat_Sqrt:  [[ 2.00601131e+01  0.00000000e+00]
 [-8.29308378e-03  1.90018421e-02]]
grads:  [ 0.00682389 -1.63434276]
Stock Position:  0.006823886444055043
Bond Position:  [1.42253272]


portfolio before change:  [2.07768859]
curr_Stock_Price:  95.95707628625995
curr_Factors:  [9.59570763e+01 4.45200166e-02]
mat_Sqrt:  [[ 2.02467195e+01  0.00000000e+00]
 [-8.43990679e-03  1.93382559e-02]]
grads:  [-0.00567906 -5.00215554]
Stock Position:  -0.005679064556064799
Bond Position:  [2.62263502]


portfolio before change:  [2.07465235]
curr_Stock_Price:  96.60717963347611
curr_Factors:  [9.66071796e+01 4.48553210e-02]
mat_Sqrt:  [[ 2.04605069e+01  0.00000000e+00]
 [-8.47162993e-03  1.94109427e-02]]
grads:  [0.00388893 2.63431396]
Stock Position:  0.00388892956754195
Bond Position:  [1.69895383]


portfolio before change:  [2.08063665]
curr_Stock_Price:  98.03675281451483
curr_Factors:  [9.80367528e+01 4.52458931e-02]
mat_Sqrt:  [[ 2.08534781e+01  0.00000000e+00]
 [-8.50843281e-03  1.94952687e-02]]
grads:  [-0.00977414 -7.11714933]
Stock Position:  -0.009774144421418537
Bond Position:  [3.03886203]


portfolio before change:  [2.07204288]
curr_Stock_Price:  98.99372425692408
curr_Factors:  [9.89937243e+01 4.44631891e-02]
mat_Sqrt:  [[ 2.08741100e+01  0.00000000e+00]
 [-8.43451852e-03  1.93259098e-02]]
grads:  [-1.73913225e-02 -2.06820105e+01]
Stock Position:  -0.01739132254995275
Bond Position:  [3.79367467]


portfolio before change:  [2.05599906]
curr_Stock_Price:  99.9707836617548
curr_Factors:  [9.99707837e+01 4.71675426e-02]
mat_Sqrt:  [[ 2.17117446e+01  0.00000000e+00]
 [-8.68723593e-03  1.99049581e-02]]
grads:  [ 7.93506094e-03 -1.19610475e+01]
Stock Position:  0.007935060942144316
Bond Position:  [1.2627248]


portfolio before change:  [2.05607268]
curr_Stock_Price:  99.94027227562309
curr_Factors:  [9.99402723e+01 4.75698039e-02]
mat_Sqrt:  [[ 2.17974760e+01  0.00000000e+00]
 [-8.72420118e-03  1.99896561e-02]]
grads:  [ 2.69668811e-04 -5.55474776e+00]
Stock Position:  0.0002696688112598677
Bond Position:  [2.0291219]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.05691564]
Stock Price:  101.18482921234092
PL:  [0.87208642]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.29115110e-03  1.31746376e-02]
 [ 8.33342515e-02 -1.07939725e-02]
 [ 8.12943799e-01 -3.12127234e-01]
 [ 3.47717215e-01 -7.23488611e-02]
 [ 3.01257127e-01 -3.29705759e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-5.64707011e-01 -7.43304345e-02]
 [-1.52324341e+00  7.01239434e-01]
 [ 9.83940249e-05 -6.89010154e-02]
 [ 1.94337945e-01  9.45215423e-01]
 [-5.66903385e-01 -1.30848004e-01]
 [-4.06569866e-02 -5.66106185e-02]
 [ 3.17252484e-02 -4.20754074e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-7.20230729e-02 -3.32774234e-02]
 [-1.41434657e-01 -1.30513082e-01]
 [-1.82218899e-01 -4.32251118e-01]
 [ 2.77578465e-01 -2.40536402e-01]
 [ 5.62121138e-02 -1.10555932e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.26060491]
curr_Stock_Price:  102.35515943665814
curr_Factors:  [1.02355159e+02 3.93454888e-02]
mat_Sqrt:  [[ 2.03028596e+01  0.00000000e+00]
 [-7.93427893e-03  1.81797169e-02]]
grads:  [4.45308421e-04 7.24688822e-01]
Stock Position:  0.0004453084207669041
Bond Position:  [18.21502529]


portfolio before change:  [18.26447319]
curr_Stock_Price:  100.81454433568273
curr_Factors:  [1.00814544e+02 3.93122766e-02]
mat_Sqrt:  [[ 1.99888261e+01  0.00000000e+00]
 [-7.93092949e-03  1.81720423e-02]]
grads:  [ 0.00393337 -0.59398786]
Stock Position:  0.003933366345387429
Bond Position:  [17.86793265]


portfolio before change:  [18.27616247]
curr_Stock_Price:  102.65056570704316
curr_Factors:  [1.02650566e+02 3.66826101e-02]
mat_Sqrt:  [[ 1.96603598e+01  0.00000000e+00]
 [-7.66108192e-03  1.75537439e-02]]
grads:  [  0.03442055 -17.78123437]
Stock Position:  0.034420545294278154
Bond Position:  [14.74287403]


portfolio before change:  [18.29475714]
curr_Stock_Price:  103.08369346118587
curr_Factors:  [1.03083693e+02 3.66973890e-02]
mat_Sqrt:  [[ 1.97472923e+01  0.00000000e+00]
 [-7.66262504e-03  1.75572796e-02]]
grads:  [ 0.01600936 -4.12073297]
Stock Position:  0.016009363668974774
Bond Position:  [16.64445281]


portfolio before change:  [18.33199646]
curr_Stock_Price:  105.14983958620843
curr_Factors:  [1.05149840e+02 3.77988722e-02]
mat_Sqrt:  [[ 2.04431604e+01  0.00000000e+00]
 [-7.77677282e-03  1.78188250e-02]]
grads:  [ 0.01403245 -1.85032267]
Stock Position:  0.01403244814335692
Bond Position:  [16.85648679]


portfolio before change:  [18.35180499]
curr_Stock_Price:  106.26111229653785
curr_Factors:  [1.06261112e+02 3.70330750e-02]
mat_Sqrt:  [[ 2.04488668e+01  0.00000000e+00]
 [-7.69759183e-03  1.76373986e-02]]
grads:  [-2.83449525e-05 -1.09716725e+00]
Stock Position:  -2.8344952497462286e-05
Bond Position:  [18.35481695]


portfolio before change:  [18.35640174]
curr_Stock_Price:  105.997324527129
curr_Factors:  [1.05997325e+02 3.61466088e-02]
mat_Sqrt:  [[ 2.01524885e+01  0.00000000e+00]
 [-7.60490461e-03  1.74250255e-02]]
grads:  [-0.02963145 -4.26572888]
Stock Position:  -0.02963145076837608
Bond Position:  [21.49725625]


portfolio before change:  [18.34063452]
curr_Stock_Price:  106.71083008397622
curr_Factors:  [1.06710830e+02 3.59249514e-02]
mat_Sqrt:  [[ 2.02258412e+01  0.00000000e+00]
 [-7.58155144e-03  1.73715167e-02]]
grads:  [-0.06018031 40.36719692]
Stock Position:  -0.060180311956697284
Bond Position:  [24.76252557]


portfolio before change:  [18.325223]
curr_Stock_Price:  107.06980019764725
curr_Factors:  [1.07069800e+02 3.64441073e-02]
mat_Sqrt:  [[ 2.04399887e+01  0.00000000e+00]
 [-7.63613591e-03  1.74965854e-02]]
grads:  [-1.46636453e-03 -3.93796925e+00]
Stock Position:  -0.001466364532180116
Bond Position:  [18.48222635]


portfolio before change:  [18.3277482]
curr_Stock_Price:  108.4991346196899
curr_Factors:  [1.08499135e+02 3.75608001e-02]
mat_Sqrt:  [[ 2.10277929e+01  0.00000000e+00]
 [-7.75224355e-03  1.77626214e-02]]
grads:  [2.88600795e-02 5.32137346e+01]
Stock Position:  0.02886007950117726
Bond Position:  [15.19645455]


portfolio before change:  [18.28907763]
curr_Stock_Price:  107.02754599384461
curr_Factors:  [1.07027546e+02 3.82879353e-02]
mat_Sqrt:  [[ 2.09424044e+01  0.00000000e+00]
 [-7.82692127e-03  1.79337296e-02]]
grads:  [-0.02979649 -7.29619591]
Stock Position:  -0.029796489638534186
Bond Position:  [21.47812279]


portfolio before change:  [18.30414825]
curr_Stock_Price:  106.70199005009545
curr_Factors:  [1.06701990e+02 3.82569438e-02]
mat_Sqrt:  [[ 2.08702502e+01  0.00000000e+00]
 [-7.82375294e-03  1.79264700e-02]]
grads:  [-3.13191674e-03 -3.15793452e+00]
Stock Position:  -0.003131916741854596
Bond Position:  [18.63833]


portfolio before change:  [18.31940024]
curr_Stock_Price:  103.32009392502538
curr_Factors:  [1.03320094e+02 4.03209030e-02]
mat_Sqrt:  [[ 2.07467425e+01  0.00000000e+00]
 [-8.03202619e-03  1.84036840e-02]]
grads:  [ 6.44054611e-04 -2.28624917e+00]
Stock Position:  0.0006440546106299119
Bond Position:  [18.25285645]


portfolio before change:  [18.32319274]
curr_Stock_Price:  102.12254773212402
curr_Factors:  [1.02122548e+02 4.14401922e-02]
mat_Sqrt:  [[ 2.07889484e+01  0.00000000e+00]
 [-8.14274570e-03  1.86573743e-02]]
grads:  [7.32298425e-03 7.96350480e+00]
Stock Position:  0.00732298425160277
Bond Position:  [17.57535093]


portfolio before change:  [18.30769673]
curr_Stock_Price:  99.40638887871505
curr_Factors:  [9.94063889e+01 4.14574263e-02]
mat_Sqrt:  [[ 2.02402311e+01  0.00000000e+00]
 [-8.14443872e-03  1.86612535e-02]]
grads:  [-0.00427597 -1.78323624]
Stock Position:  -0.004275965572140539
Bond Position:  [18.73275503]


portfolio before change:  [18.31001909]
curr_Stock_Price:  99.95864303740471
curr_Factors:  [9.99586430e+01 4.01385811e-02]
mat_Sqrt:  [[ 2.00263296e+01  0.00000000e+00]
 [-8.01384612e-03  1.83620282e-02]]
grads:  [-0.00990672 -7.10777047]
Stock Position:  -0.009906719797443148
Bond Position:  [19.30028136]


portfolio before change:  [18.31621099]
curr_Stock_Price:  99.82073366425779
curr_Factors:  [9.98207337e+01 3.95924042e-02]
mat_Sqrt:  [[ 1.98621700e+01  0.00000000e+00]
 [-7.95913606e-03  1.82366717e-02]]
grads:  [-1.86721165e-02 -2.37023029e+01]
Stock Position:  -0.018672116547861422
Bond Position:  [20.18007537]


portfolio before change:  [18.31956485]
curr_Stock_Price:  99.91133876492121
curr_Factors:  [9.99113388e+01 3.99952562e-02]
mat_Sqrt:  [[ 1.99810828e+01  0.00000000e+00]
 [-7.99952561e-03  1.83292158e-02]]
grads:  [ 8.63815912e-03 -1.31231147e+01]
Stock Position:  0.008638159121160905
Bond Position:  [17.45651481]


portfolio before change:  [18.32450005]
curr_Stock_Price:  99.97738521010015
curr_Factors:  [9.99773852e+01 3.95924477e-02]
mat_Sqrt:  [[ 1.98933512e+01  0.00000000e+00]
 [-7.95914043e-03  1.82366817e-02]]
grads:  [ 4.00211563e-04 -6.06228336e+00]
Stock Position:  0.00040021156325194084
Bond Position:  [18.28448794]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.32903712]
Stock Price:  99.89087659716427
PL:  [18.32903712]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 7.75684498e-02  2.23660524e-02]
 [ 2.76394319e-02 -7.91288844e-02]
 [ 3.63308495e-01 -1.74896875e-01]
 [-1.85247741e-02  1.64134042e-02]
 [ 4.17725945e-01 -1.98430443e-02]
 [-6.29515283e-01 -5.48035480e-01]
 [-7.29368786e-02 -6.79371771e-02]
 [-1.26278935e+00  7.07369629e-01]
 [ 8.81524458e-02 -7.10320132e-02]
 [ 1.30218750e-02 -9.88078033e-02]
 [-5.86042366e-02 -3.87854393e-02]
 [ 2.07957585e-02 -9.06900549e-03]
 [ 1.63997349e-01 -2.90604090e-02]
 [-6.15732898e-02 -7.20136690e-02]
 [ 6.30158362e-02  6.19475999e-02]
 [-1.43645080e-01 -1.40438990e-01]
 [-1.93447712e-01 -3.48469177e-01]
 [ 2.81777109e-01 -2.47965032e-01]
 [ 8.59912483e-02 -9.53565250e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.83489941]
curr_Stock_Price:  97.97267273868454
curr_Factors:  [9.79726727e+01 3.99457853e-02]
mat_Sqrt:  [[ 1.95812512e+01  0.00000000e+00]
 [-7.99457669e-03  1.83178764e-02]]
grads:  [0.00445987 1.22099592]
Stock Position:  0.004459867996162461
Bond Position:  [-11.27184459]


portfolio before change:  [-10.84363804]
curr_Stock_Price:  96.64520779111149
curr_Factors:  [9.66452078e+01 3.86479898e-02]
mat_Sqrt:  [[ 1.89995703e+01  0.00000000e+00]
 [-7.86363680e-03  1.80178554e-02]]
grads:  [-3.62915813e-04 -4.39169271e+00]
Stock Position:  -0.00036291581345081143
Bond Position:  [-10.80856396]


portfolio before change:  [-10.84566929]
curr_Stock_Price:  94.79567526339872
curr_Factors:  [9.47956753e+01 4.09518768e-02]
mat_Sqrt:  [[ 1.91833932e+01  0.00000000e+00]
 [-8.09462802e-03  1.85471228e-02]]
grads:  [ 0.01495967 -9.4298656 ]
Stock Position:  0.01495967046386555
Bond Position:  [-12.26378136]


portfolio before change:  [-10.84999518]
curr_Stock_Price:  94.71147844402829
curr_Factors:  [9.47114784e+01 4.37264462e-02]
mat_Sqrt:  [[ 1.98049936e+01  0.00000000e+00]
 [-8.36434778e-03  1.91651284e-02]]
grads:  [-5.73662254e-04  8.56420255e-01]
Stock Position:  -0.0005736622539832409
Bond Position:  [-10.79566278]


portfolio before change:  [-10.85240535]
curr_Stock_Price:  94.20756450992253
curr_Factors:  [9.42075645e+01 4.45099693e-02]
mat_Sqrt:  [[ 1.98753335e+01  0.00000000e+00]
 [-8.43895437e-03  1.93360736e-02]]
grads:  [ 0.02058158 -1.02621891]
Stock Position:  0.020581578216829842
Bond Position:  [-12.79134571]


portfolio before change:  [-10.8806824]
curr_Stock_Price:  92.98905706921195
curr_Factors:  [9.29890571e+01 4.51949157e-02]
mat_Sqrt:  [[ 1.97686328e+01  0.00000000e+00]
 [-8.50363835e-03  1.94842832e-02]]
grads:  [ -0.04394323 -28.12705371]
Stock Position:  -0.043943229892893225
Bond Position:  [-6.79444288]


portfolio before change:  [-10.95930003]
curr_Stock_Price:  94.73947019663804
curr_Factors:  [9.47394702e+01 4.57128215e-02]
mat_Sqrt:  [[ 2.02558264e+01  0.00000000e+00]
 [-8.55222278e-03  1.95956041e-02]]
grads:  [-0.00506457 -3.46696007]
Stock Position:  -0.005064572120412085
Bond Position:  [-10.47948515]


portfolio before change:  [-10.97854328]
curr_Stock_Price:  98.021693404021
curr_Factors:  [9.80216934e+01 4.55697119e-02]
mat_Sqrt:  [[ 2.09247531e+01  0.00000000e+00]
 [-8.53882539e-03  1.95649069e-02]]
grads:  [-0.04559518 36.15502157]
Stock Position:  -0.04559518235993498
Bond Position:  [-6.50922629]


portfolio before change:  [-11.05932453]
curr_Stock_Price:  99.7577044540029
curr_Factors:  [9.97577045e+01 4.62160578e-02]
mat_Sqrt:  [[ 2.14458318e+01  0.00000000e+00]
 [-8.59916813e-03  1.97031694e-02]]
grads:  [ 2.66492501e-03 -3.60510594e+00]
Stock Position:  0.002664925014014174
Bond Position:  [-11.32517133]


portfolio before change:  [-11.0650713]
curr_Stock_Price:  98.66381751202972
curr_Factors:  [9.86638175e+01 4.61776223e-02]
mat_Sqrt:  [[ 2.12018471e+01  0.00000000e+00]
 [-8.59559164e-03  1.96949747e-02]]
grads:  [-1.41975298e-03 -5.01690431e+00]
Stock Position:  -0.0014197529846594822
Bond Position:  [-10.92499306]


portfolio before change:  [-11.06965978]
curr_Stock_Price:  99.97171436269021
curr_Factors:  [9.99717144e+01 4.90262298e-02]
mat_Sqrt:  [[ 2.21356046e+01  0.00000000e+00]
 [-8.85674702e-03  2.02933568e-02]]
grads:  [-0.00341222 -1.91123823]
Stock Position:  -0.0034122216895192434
Bond Position:  [-10.72853413]


portfolio before change:  [-11.07526688]
curr_Stock_Price:  100.82881636645564
curr_Factors:  [1.00828816e+02 4.84022179e-02]
mat_Sqrt:  [[ 2.21828478e+01  0.00000000e+00]
 [-8.80020163e-03  2.01637950e-02]]
grads:  [ 0.00075904 -0.4497668 ]
Stock Position:  0.0007590423073697808
Bond Position:  [-11.15180021]


portfolio before change:  [-11.08027225]
curr_Stock_Price:  97.90793027404071
curr_Factors:  [9.79079303e+01 4.91265615e-02]
mat_Sqrt:  [[ 2.17008155e+01  0.00000000e+00]
 [-8.86580500e-03  2.03141113e-02]]
grads:  [ 0.00697275 -1.43055281]
Stock Position:  0.006972749338403308
Bond Position:  [-11.76295971]


portfolio before change:  [-11.08820862]
curr_Stock_Price:  97.19153290342682
curr_Factors:  [9.71915329e+01 4.96301161e-02]
mat_Sqrt:  [[ 2.16521525e+01  0.00000000e+00]
 [-8.91112708e-03  2.04179572e-02]]
grads:  [-0.00429531 -3.52697718]
Stock Position:  -0.0042953065084897985
Bond Position:  [-10.67074119]


portfolio before change:  [-11.08717723]
curr_Stock_Price:  96.33026502156014
curr_Factors:  [9.63302650e+01 4.92325486e-02]
mat_Sqrt:  [[ 2.13741530e+01  0.00000000e+00]
 [-8.87536353e-03  2.03360126e-02]]
grads:  [0.00421313 3.04620188]
Stock Position:  0.004213125321365444
Bond Position:  [-11.49302871]


portfolio before change:  [-11.08552144]
curr_Stock_Price:  97.40533441199646
curr_Factors:  [9.74053344e+01 4.86014570e-02]
mat_Sqrt:  [[ 2.14737250e+01  0.00000000e+00]
 [-8.81829526e-03  2.02052528e-02]]
grads:  [-0.00954365 -6.95061781]
Stock Position:  -0.009543648378733014
Bond Position:  [-10.15591918]


portfolio before change:  [-11.08385995]
curr_Stock_Price:  96.96516886457547
curr_Factors:  [9.69651689e+01 4.74509474e-02]
mat_Sqrt:  [[ 2.11221539e+01  0.00000000e+00]
 [-8.71329535e-03  1.99646677e-02]]
grads:  [-1.63587545e-02 -1.74542938e+01]
Stock Position:  -0.01635875446955231
Bond Position:  [-9.49763056]


portfolio before change:  [-11.12026137]
curr_Stock_Price:  99.04519933899485
curr_Factors:  [9.90451993e+01 4.67666714e-02]
mat_Sqrt:  [[ 2.14191218e+01  0.00000000e+00]
 [-8.65024128e-03  1.98201927e-02]]
grads:  [ 8.10286706e-03 -1.25107276e+01]
Stock Position:  0.008102867063781397
Bond Position:  [-11.92281145]


portfolio before change:  [-11.10994396]
curr_Stock_Price:  100.68640575110251
curr_Factors:  [1.00686406e+02 4.64699804e-02]
mat_Sqrt:  [[ 2.17048647e+01  0.00000000e+00]
 [-8.62275876e-03  1.97572224e-02]]
grads:  [ 2.04443794e-03 -4.82641352e+00]
Stock Position:  0.0020444379438759406
Bond Position:  [-11.31579107]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.11454235]
Stock Price:  99.8210884624471
PL:  [-11.11454235]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 4.33360546e-03  1.53574980e-01]
 [ 7.15799064e-02 -1.30989364e-02]
 [ 7.01052876e-01 -2.77977711e-01]
 [ 3.70110827e-03 -1.02315675e-01]
 [ 1.85908435e-01 -2.86189119e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-4.24284365e-01 -1.16787640e-01]
 [-1.36151240e+00  7.45480796e-01]
 [ 8.40022314e-02 -7.47506566e-02]
 [ 2.82990204e-02 -6.82684238e-02]
 [-4.42583282e-02 -3.23341954e-03]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.64861479e-01 -2.89435270e-02]
 [ 2.94709487e-02  5.04141540e-02]
 [-6.80821468e-02 -3.18983604e-02]
 [-1.42131159e-01 -1.33640724e-01]
 [-1.91489012e-01 -3.75737608e-01]
 [ 2.97884132e-01 -3.64575552e-01]
 [-1.45245162e-01 -1.62253409e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.7193147]
curr_Stock_Price:  99.3457002785181
curr_Factors:  [9.93457003e+01 3.95194326e-02]
mat_Sqrt:  [[ 1.97494236e+01  0.00000000e+00]
 [-7.95179805e-03  1.82198582e-02]]
grads:  [3.61323059e-03 8.42898873e+00]
Stock Position:  0.0036132305863400523
Bond Position:  [-2.07827362]


portfolio before change:  [-1.71675954]
curr_Stock_Price:  100.19668299663546
curr_Factors:  [1.00196683e+02 3.98279064e-02]
mat_Sqrt:  [[ 1.99961821e+01  0.00000000e+00]
 [-7.98277209e-03  1.82908287e-02]]
grads:  [ 0.00329378 -0.71614778]
Stock Position:  0.0032937818575191125
Bond Position:  [-2.04678556]


portfolio before change:  [-1.71708266]
curr_Stock_Price:  100.25395431985471
curr_Factors:  [1.00253954e+02 3.96328989e-02]
mat_Sqrt:  [[ 1.99585704e+01  0.00000000e+00]
 [-7.96320528e-03  1.82459955e-02]]
grads:  [  0.02904684 -15.23499833]
Stock Position:  0.029046842743290797
Bond Position:  [-4.62914351]


portfolio before change:  [-1.73395494]
curr_Stock_Price:  99.71293694528923
curr_Factors:  [9.97129369e+01 4.11966292e-02]
mat_Sqrt:  [[ 2.02386877e+01  0.00000000e+00]
 [-8.11878111e-03  1.86024645e-02]]
grads:  [-2.02350636e-03 -5.50011400e+00]
Stock Position:  -0.00202350636275532
Bond Position:  [-1.53218517]


portfolio before change:  [-1.74123184]
curr_Stock_Price:  103.11979798093216
curr_Factors:  [1.03119798e+02 3.85067984e-02]
mat_Sqrt:  [[ 2.02353518e+01  0.00000000e+00]
 [-7.84925967e-03  1.79849133e-02]]
grads:  [ 0.00857006 -1.59127327]
Stock Position:  0.00857005696620012
Bond Position:  [-2.62497438]


portfolio before change:  [-1.74200082]
curr_Stock_Price:  103.10665224962787
curr_Factors:  [1.03106652e+02 3.83204268e-02]
mat_Sqrt:  [[ 2.01837498e+01  0.00000000e+00]
 [-7.83024156e-03  1.79413373e-02]]
grads:  [-2.87172682e-05 -1.07858047e+00]
Stock Position:  -2.8717268172484635e-05
Bond Position:  [-1.73903988]


portfolio before change:  [-1.74248039]
curr_Stock_Price:  104.66525666744707
curr_Factors:  [1.04665257e+02 3.51498329e-02]
mat_Sqrt:  [[ 1.96229445e+01  0.00000000e+00]
 [-7.49931548e-03  1.71830904e-02]]
grads:  [-0.02421934 -6.79666095]
Stock Position:  -0.024219335177443745
Bond Position:  [0.79244254]


portfolio before change:  [-1.6767136]
curr_Stock_Price:  101.95797094206114
curr_Factors:  [1.01957971e+02 3.49650659e-02]
mat_Sqrt:  [[ 1.90650681e+01  0.00000000e+00]
 [-7.47957923e-03  1.71378690e-02]]
grads:  [-0.0543485  43.49903688]
Stock Position:  -0.05434850309709352
Bond Position:  [3.8645495]


portfolio before change:  [-1.58451422]
curr_Stock_Price:  100.27930236927145
curr_Factors:  [1.00279302e+02 3.45678284e-02]
mat_Sqrt:  [[ 1.86443545e+01  0.00000000e+00]
 [-7.43697018e-03  1.70402394e-02]]
grads:  [ 2.75570657e-03 -4.38671400e+00]
Stock Position:  0.0027557065668515277
Bond Position:  [-1.86085455]


portfolio before change:  [-1.58693022]
curr_Stock_Price:  99.5714154268808
curr_Factors:  [9.95714154e+01 3.75448226e-02]
mat_Sqrt:  [[ 1.92934418e+01  0.00000000e+00]
 [-7.75059457e-03  1.77588431e-02]]
grads:  [-7.75269894e-05 -3.84419319e+00]
Stock Position:  -7.752698939592504e-05
Bond Position:  [-1.57921074]


portfolio before change:  [-1.58733603]
curr_Stock_Price:  99.71282958655588
curr_Factors:  [9.97128296e+01 3.59972325e-02]
mat_Sqrt:  [[ 1.89184520e+01  0.00000000e+00]
 [-7.58917466e-03  1.73889837e-02]]
grads:  [-0.00241402 -0.18594644]
Stock Position:  -0.0024140192991300275
Bond Position:  [-1.34662734]


portfolio before change:  [-1.58511357]
curr_Stock_Price:  98.65270293307513
curr_Factors:  [9.86527029e+01 3.62661993e-02]
mat_Sqrt:  [[ 1.87871114e+01  0.00000000e+00]
 [-7.61747457e-03  1.74538269e-02]]
grads:  [ 0.00255582 -0.49223491]
Stock Position:  0.0025558201717176834
Bond Position:  [-1.83725213]


portfolio before change:  [-1.58724823]
curr_Stock_Price:  97.99721893692536
curr_Factors:  [9.79972189e+01 3.66207587e-02]
mat_Sqrt:  [[ 1.87532879e+01  0.00000000e+00]
 [-7.65462043e-03  1.75389388e-02]]
grads:  [ 0.00811748 -1.65024392]
Stock Position:  0.008117482602697963
Bond Position:  [-2.38273895]


portfolio before change:  [-1.57253912]
curr_Stock_Price:  99.88263986519426
curr_Factors:  [9.98826399e+01 3.57988782e-02]
mat_Sqrt:  [[ 1.88983863e+01  0.00000000e+00]
 [-7.56823660e-03  1.73410085e-02]]
grads:  [2.72369760e-03 2.90722157e+00]
Stock Position:  0.0027236976016800987
Bond Position:  [-1.84458923]


portfolio before change:  [-1.57443361]
curr_Stock_Price:  99.35641305563574
curr_Factors:  [9.93564131e+01 3.74344249e-02]
mat_Sqrt:  [[ 1.92234568e+01  0.00000000e+00]
 [-7.73919116e-03  1.77327147e-02]]
grads:  [-0.00426582 -1.79884248]
Stock Position:  -0.0042658161474543686
Bond Position:  [-1.15059742]


portfolio before change:  [-1.5741511]
curr_Stock_Price:  99.22274578982858
curr_Factors:  [9.92227458e+01 3.80330000e-02]
mat_Sqrt:  [[ 1.93504707e+01  0.00000000e+00]
 [-7.80082047e-03  1.78739252e-02]]
grads:  [-0.01035927 -7.47685376]
Stock Position:  -0.010359270129818413
Bond Position:  [-0.54627587]


portfolio before change:  [-1.56220403]
curr_Stock_Price:  98.05628810767253
curr_Factors:  [9.80562881e+01 3.86899145e-02]
mat_Sqrt:  [[ 1.92874287e+01  0.00000000e+00]
 [-7.86790081e-03  1.80276255e-02]]
grads:  [-1.84303649e-02 -2.08423238e+01]
Stock Position:  -0.018430364854395406
Bond Position:  [0.24500913]


portfolio before change:  [-1.49215063]
curr_Stock_Price:  94.25863456325733
curr_Factors:  [9.42586346e+01 3.89100611e-02]
mat_Sqrt:  [[ 1.85931127e+01  0.00000000e+00]
 [-7.89025334e-03  1.80788416e-02]]
grads:  [ 7.46353332e-03 -2.01658691e+01]
Stock Position:  0.0074635333221452875
Bond Position:  [-2.19565309]


portfolio before change:  [-1.48375077]
curr_Stock_Price:  95.45764306593328
curr_Factors:  [9.54576431e+01 3.79133788e-02]
mat_Sqrt:  [[ 1.85868996e+01  0.00000000e+00]
 [-7.78854326e-03  1.78457945e-02]]
grads:  [-0.01162423 -9.09196889]
Stock Position:  -0.011624227837949357
Bond Position:  [-0.37412938]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.51006152]
Stock Price:  97.71303590204556
PL:  [-1.51006152]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.65491868e-02  3.06710831e-02]
 [ 7.69463316e-02 -9.67877788e-03]
 [ 7.38901499e-01 -2.89529250e-01]
 [ 1.70191231e-02 -1.03900177e-01]
 [ 2.96311074e-01 -1.03423217e-02]
 [-2.81563208e-01 -3.18067275e-01]
 [-2.35757375e-02 -5.08964565e-02]
 [-1.28669544e+00  6.73984266e-01]
 [ 6.76714509e-02 -4.17918944e-02]
 [ 3.97518393e-02 -4.08699649e-02]
 [-6.01952275e-02 -4.50486743e-02]
 [ 2.42432501e-03 -9.35232888e-03]
 [ 1.65441970e-02 -5.28360057e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15964787e-01 -6.17204031e-02]
 [-1.40206549e-01 -1.24998261e-01]
 [-1.56000895e-01 -5.57140430e-01]
 [-2.01569432e-01 -6.69257090e-02]
 [ 1.17611292e-01 -5.16394838e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.10954396]
curr_Stock_Price:  100.67553994173026
curr_Factors:  [1.00675540e+02 3.91583229e-02]
mat_Sqrt:  [[ 1.99221410e+01  0.00000000e+00]
 [-7.91538481e-03  1.81364250e-02]]
grads:  [1.50260682e-03 1.69113169e+00]
Stock Position:  0.0015026068190039732
Bond Position:  [6.95826821]


portfolio before change:  [7.11181385]
curr_Stock_Price:  101.02833123805944
curr_Factors:  [1.01028331e+02 4.06029170e-02]
mat_Sqrt:  [[ 2.03573759e+01  0.00000000e+00]
 [-8.06006620e-03  1.84679317e-02]]
grads:  [ 0.00357228 -0.52408564]
Stock Position:  0.0035722760561334795
Bond Position:  [6.75091277]


portfolio before change:  [7.11186158]
curr_Stock_Price:  100.56917904950876
curr_Factors:  [1.00569179e+02 4.19643555e-02]
mat_Sqrt:  [[ 2.06018008e+01  0.00000000e+00]
 [-8.19408133e-03  1.87749990e-02]]
grads:  [  0.02973238 -15.42099953]
Stock Position:  0.029732380216210875
Bond Position:  [4.12170051]


portfolio before change:  [7.09021307]
curr_Stock_Price:  99.8064058321511
curr_Factors:  [9.98064058e+01 4.39438188e-02]
mat_Sqrt:  [[ 2.09221983e+01  0.00000000e+00]
 [-8.38511241e-03  1.92127062e-02]]
grads:  [-1.35390322e-03 -5.40788871e+00]
Stock Position:  -0.0013539032202395432
Bond Position:  [7.22534128]


portfolio before change:  [7.09544296]
curr_Stock_Price:  97.27791161334729
curr_Factors:  [9.72779116e+01 4.53833797e-02]
mat_Sqrt:  [[ 2.07234785e+01  0.00000000e+00]
 [-8.52135010e-03  1.95248659e-02]]
grads:  [ 0.01408052 -0.52970001]
Stock Position:  0.014080518111863154
Bond Position:  [5.72571957]


portfolio before change:  [7.07293104]
curr_Stock_Price:  95.57743922971015
curr_Factors:  [9.55774392e+01 4.31305490e-02]
mat_Sqrt:  [[ 1.98494228e+01  0.00000000e+00]
 [-8.30715826e-03  1.90340908e-02]]
grads:  [ -0.02117841 -16.71040022]
Stock Position:  -0.021178406565443397
Bond Position:  [9.09710891]


portfolio before change:  [7.05740519]
curr_Stock_Price:  96.41793741277218
curr_Factors:  [9.64179374e+01 4.39929529e-02]
mat_Sqrt:  [[ 2.02231775e+01  0.00000000e+00]
 [-8.38979884e-03  1.92234441e-02]]
grads:  [-2.26417298e-03 -2.64762423e+00]
Stock Position:  -0.002264172984765184
Bond Position:  [7.27571208]


portfolio before change:  [7.05866891]
curr_Stock_Price:  96.66325387893845
curr_Factors:  [9.66632539e+01 4.41542363e-02]
mat_Sqrt:  [[ 2.03117620e+01  0.00000000e+00]
 [-8.40516377e-03  1.92586496e-02]]
grads:  [-0.04886551 34.9964447 ]
Stock Position:  -0.048865509035422014
Bond Position:  [11.78216801]


portfolio before change:  [6.99089123]
curr_Stock_Price:  98.1105648266449
curr_Factors:  [9.81105648e+01 4.47889926e-02]
mat_Sqrt:  [[ 2.07635412e+01  0.00000000e+00]
 [-8.46536403e-03  1.93965857e-02]]
grads:  [ 0.00238071 -2.15460056]
Stock Position:  0.0023807101344834906
Bond Position:  [6.75731841]


portfolio before change:  [6.99729683]
curr_Stock_Price:  100.09151153348844
curr_Factors:  [1.00091512e+02 4.29523909e-02]
mat_Sqrt:  [[ 2.07439243e+01  0.00000000e+00]
 [-8.28998344e-03  1.89947383e-02]]
grads:  [ 1.05644062e-03 -2.15164664e+00]
Stock Position:  0.0010564406183095577
Bond Position:  [6.89155609]


portfolio before change:  [6.99893498]
curr_Stock_Price:  100.01109054553888
curr_Factors:  [1.00011091e+02 4.27269754e-02]
mat_Sqrt:  [[ 2.06727969e+01  0.00000000e+00]
 [-8.26820178e-03  1.89448303e-02]]
grads:  [-0.00386286 -2.37788746]
Stock Position:  -0.003862858091949242
Bond Position:  [7.38526363]


portfolio before change:  [6.99003804]
curr_Stock_Price:  102.7923166411516
curr_Factors:  [1.02792317e+02 3.99219749e-02]
mat_Sqrt:  [[ 2.05384026e+01  0.00000000e+00]
 [-7.99219368e-03  1.83124163e-02]]
grads:  [-8.06959518e-05 -5.10709714e-01]
Stock Position:  -8.06959517525873e-05
Bond Position:  [6.99833296]


portfolio before change:  [6.99168222]
curr_Stock_Price:  104.10114625968927
curr_Factors:  [1.04101146e+02 3.93686713e-02]
mat_Sqrt:  [[ 2.06552707e+01  0.00000000e+00]
 [-7.93661603e-03  1.81850719e-02]]
grads:  [-3.15431664e-04 -2.90546037e+00]
Stock Position:  -0.0003154316636640366
Bond Position:  [7.02451902]


portfolio before change:  [6.99354775]
curr_Stock_Price:  103.75501814146915
curr_Factors:  [1.03755018e+02 3.90555484e-02]
mat_Sqrt:  [[ 2.05045613e+01  0.00000000e+00]
 [-7.90499067e-03  1.81126091e-02]]
grads:  [7.42455007e-03 8.20301973e+00]
Stock Position:  0.00742455007094243
Bond Position:  [6.22321343]


portfolio before change:  [6.99937436]
curr_Stock_Price:  104.33021928288959
curr_Factors:  [1.04330219e+02 3.70502570e-02]
mat_Sqrt:  [[ 2.00819431e+01  0.00000000e+00]
 [-7.69937732e-03  1.76414897e-02]]
grads:  [-0.00711593 -3.49859361]
Stock Position:  -0.007115933889020388
Bond Position:  [7.7417813]


portfolio before change:  [7.01641587]
curr_Stock_Price:  102.20740227721168
curr_Factors:  [1.02207402e+02 3.63825326e-02]
mat_Sqrt:  [[ 1.94952502e+01  0.00000000e+00]
 [-7.62968231e-03  1.74817984e-02]]
grads:  [-0.00999014 -7.15019466]
Stock Position:  -0.009990139151818454
Bond Position:  [8.03748205]


portfolio before change:  [7.00768184]
curr_Stock_Price:  103.28282824614955
curr_Factors:  [1.03282828e+02 3.51616755e-02]
mat_Sqrt:  [[ 1.93670245e+01  0.00000000e+00]
 [-7.50057870e-03  1.71859848e-02]]
grads:  [-2.06101310e-02 -3.24183011e+01]
Stock Position:  -0.020610131020907883
Bond Position:  [9.13635446]


portfolio before change:  [6.98428228]
curr_Stock_Price:  104.52900837125836
curr_Factors:  [1.04529008e+02 3.48258667e-02]
mat_Sqrt:  [[ 1.95068793e+01  0.00000000e+00]
 [-7.46467593e-03  1.71037213e-02]]
grads:  [-0.01183061 -3.91293263]
Stock Position:  -0.011830606128406024
Bond Position:  [8.22092381]


portfolio before change:  [6.96803327]
curr_Stock_Price:  106.07622372250238
curr_Factors:  [1.06076224e+02 3.32270352e-02]
mat_Sqrt:  [[ 1.93358757e+01  0.00000000e+00]
 [-7.29131376e-03  1.67064986e-02]]
grads:  [ 0.00491697 -3.09098184]
Stock Position:  0.004916972717614441
Bond Position:  [6.44645937]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.98352121]
Stock Price:  108.89831029767757
PL:  [-1.91478909]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 7.43974330e-03  1.82760374e-02]
 [ 7.55332335e-02 -7.95197423e-03]
 [ 6.18629128e-01 -2.52821678e-01]
 [-1.03455137e-01 -9.44804476e-02]
 [ 2.70622269e-01 -8.46244450e-03]
 [ 2.17184925e-02 -8.49619342e-02]
 [-5.60915005e-02 -1.17922814e-01]
 [-1.29364949e+00  7.39122449e-01]
 [ 8.46234109e-02 -6.60302829e-02]
 [ 2.07633386e-02 -8.59262300e-02]
 [-4.14214251e-02  5.45112719e-03]
 [ 1.29671769e-02 -9.18973751e-03]
 [ 1.55281763e-01 -2.30778381e-02]
 [ 8.86433519e-02  1.42804300e-01]
 [-8.71201307e-02 -3.89928084e-02]
 [-1.41902209e-01 -1.32612625e-01]
 [-1.81855561e-01 -4.33586251e-01]
 [ 2.90961158e-01 -2.64214304e-01]
 [-1.40972471e-01 -1.61157885e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.73978754]
curr_Stock_Price:  101.82483918156848
curr_Factors:  [1.01824839e+02 4.10482189e-02]
mat_Sqrt:  [[ 2.06300790e+01  0.00000000e+00]
 [-8.10414401e-03  1.85689267e-02]]
grads:  [7.47261313e-04 9.84226912e-01]
Stock Position:  0.0007472613129405278
Bond Position:  [14.66369778]


portfolio before change:  [14.74233338]
curr_Stock_Price:  100.32530378694375
curr_Factors:  [1.00325304e+02 4.18436969e-02]
mat_Sqrt:  [[ 2.05222752e+01  0.00000000e+00]
 [-8.18229278e-03  1.87479880e-02]]
grads:  [ 0.00351144 -0.42415081]
Stock Position:  0.0035114385052815757
Bond Position:  [14.39004725]


portfolio before change:  [14.74185724]
curr_Stock_Price:  99.16506528727982
curr_Factors:  [9.91650653e+01 3.79211723e-02]
mat_Sqrt:  [[ 1.93107695e+01  0.00000000e+00]
 [-7.78934373e-03  1.78476286e-02]]
grads:  [  0.02632151 -14.16556132]
Stock Position:  0.02632151467189201
Bond Position:  [12.13168252]


portfolio before change:  [14.73826475]
curr_Stock_Price:  98.91334031685832
curr_Factors:  [9.89133403e+01 3.69967598e-02]
mat_Sqrt:  [[ 1.90255278e+01  0.00000000e+00]
 [-7.69381672e-03  1.76287488e-02]]
grads:  [-0.00760503 -5.35945284]
Stock Position:  -0.007605033975552388
Bond Position:  [15.49050407]


portfolio before change:  [14.74908117]
curr_Stock_Price:  98.0003519398407
curr_Factors:  [9.80003519e+01 3.74839294e-02]
mat_Sqrt:  [[ 1.89736197e+01  0.00000000e+00]
 [-7.74430676e-03  1.77444360e-02]]
grads:  [ 0.01406843 -0.47690693]
Stock Position:  0.014068425515900025
Bond Position:  [13.37037052]


portfolio before change:  [14.76213553]
curr_Stock_Price:  98.6906459760047
curr_Factors:  [9.86906460e+01 3.73642501e-02]
mat_Sqrt:  [[ 1.90767385e+01  0.00000000e+00]
 [-7.73193379e-03  1.77160859e-02]]
grads:  [-8.05270541e-04 -4.79575085e+00]
Stock Position:  -0.0008052705405190592
Bond Position:  [14.8416082]


portfolio before change:  [14.76539273]
curr_Stock_Price:  99.25402513213086
curr_Factors:  [9.92540251e+01 3.70537377e-02]
mat_Sqrt:  [[ 1.91057521e+01  0.00000000e+00]
 [-7.69973897e-03  1.76423183e-02]]
grads:  [-5.62957349e-03 -6.68408832e+00]
Stock Position:  -0.005629573492621034
Bond Position:  [15.32415055]


portfolio before change:  [14.76401053]
curr_Stock_Price:  100.18015487694778
curr_Factors:  [1.00180155e+02 3.62772966e-02]
mat_Sqrt:  [[ 1.90809132e+01  0.00000000e+00]
 [-7.61863995e-03  1.74564971e-02]]
grads:  [-0.05089222 42.34082265]
Stock Position:  -0.05089221838475661
Bond Position:  [19.86240085]


portfolio before change:  [14.80474974]
curr_Stock_Price:  99.47723821775642
curr_Factors:  [9.94772382e+01 3.75008822e-02]
mat_Sqrt:  [[ 1.92639109e+01  0.00000000e+00]
 [-7.74605781e-03  1.77484481e-02]]
grads:  [ 2.89689010e-03 -3.72034121e+00]
Stock Position:  0.0028968900968890485
Bond Position:  [14.51657511]


portfolio before change:  [14.80765888]
curr_Stock_Price:  99.22854080804004
curr_Factors:  [9.92285408e+01 3.82585620e-02]
mat_Sqrt:  [[ 1.94089002e+01  0.00000000e+00]
 [-7.82391840e-03  1.79268492e-02]]
grads:  [-8.62384913e-04 -4.79315853e+00]
Stock Position:  -0.0008623849134374017
Bond Position:  [14.89323208]


portfolio before change:  [14.81101572]
curr_Stock_Price:  99.65403231261263
curr_Factors:  [9.96540323e+01 3.89412267e-02]
mat_Sqrt:  [[ 1.96652599e+01  0.00000000e+00]
 [-7.89341262e-03  1.80860804e-02]]
grads:  [-0.00198535  0.30139904]
Stock Position:  -0.0019853466663214167
Bond Position:  [15.00886352]


portfolio before change:  [14.81059627]
curr_Stock_Price:  101.75549570785068
curr_Factors:  [1.01755496e+02 3.89841429e-02]
mat_Sqrt:  [[ 2.00910146e+01  0.00000000e+00]
 [-7.89776099e-03  1.80960438e-02]]
grads:  [ 4.45793644e-04 -5.07831304e-01]
Stock Position:  0.00044579364367446127
Bond Position:  [14.76523432]


portfolio before change:  [14.81352313]
curr_Stock_Price:  100.03964945656003
curr_Factors:  [1.00039649e+02 3.94588021e-02]
mat_Sqrt:  [[ 1.98721158e+01  0.00000000e+00]
 [-7.94569590e-03  1.82058764e-02]]
grads:  [ 0.00730721 -1.2676038 ]
Stock Position:  0.007307212272611084
Bond Position:  [14.08251217]


portfolio before change:  [14.82495898]
curr_Stock_Price:  101.12279644152288
curr_Factors:  [1.01122796e+02 3.94763052e-02]
mat_Sqrt:  [[ 2.00917294e+01  0.00000000e+00]
 [-7.94745798e-03  1.82099139e-02]]
grads:  [7.51395039e-03 7.84211833e+00]
Stock Position:  0.007513950388230945
Bond Position:  [14.06512731]


portfolio before change:  [14.81702339]
curr_Stock_Price:  99.5986560152984
curr_Factors:  [9.95986560e+01 3.94175799e-02]
mat_Sqrt:  [[ 1.97741788e+01  0.00000000e+00]
 [-7.94154443e-03  1.81963642e-02]]
grads:  [-0.00526636 -2.14289008]
Stock Position:  -0.0052663621857752686
Bond Position:  [15.34154598]


portfolio before change:  [14.82154055]
curr_Stock_Price:  99.4692879760192
curr_Factors:  [9.94692880e+01 4.17532374e-02]
mat_Sqrt:  [[ 2.03251653e+01  0.00000000e+00]
 [-8.17344357e-03  1.87277119e-02]]
grads:  [-0.00982915 -7.08109062]
Stock Position:  -0.009829150254450473
Bond Position:  [15.79923913]


portfolio before change:  [14.8215268]
curr_Stock_Price:  99.87258361117497
curr_Factors:  [9.98725836e+01 4.25363128e-02]
mat_Sqrt:  [[ 2.05980546e+01  0.00000000e+00]
 [-8.24973336e-03  1.89025138e-02]]
grads:  [-1.80156875e-02 -2.29380206e+01]
Stock Position:  -0.018015687497385052
Bond Position:  [16.62080006]


portfolio before change:  [14.867322]
curr_Stock_Price:  97.56129382564104
curr_Factors:  [9.75612938e+01 4.45192559e-02]
mat_Sqrt:  [[ 2.05850298e+01  0.00000000e+00]
 [-8.43983468e-03  1.93380906e-02]]
grads:  [ 8.53283109e-03 -1.36628951e+01]
Stock Position:  0.008532831092278407
Bond Position:  [14.03484796]


portfolio before change:  [14.85374464]
curr_Stock_Price:  95.55885043388989
curr_Factors:  [9.55588504e+01 4.66478548e-02]
mat_Sqrt:  [[ 2.06389099e+01  0.00000000e+00]
 [-8.63924578e-03  1.97949989e-02]]
grads:  [-0.01023831 -8.1413435 ]
Stock Position:  -0.010238309068540587
Bond Position:  [15.83210568]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.82372182]
Stock Price:  98.87788824580812
PL:  [14.82372182]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.90533942e-03  1.55520741e-01]
 [ 6.27707953e-02 -2.63365072e-02]
 [ 6.74694531e-01 -2.69933046e-01]
 [-1.16538152e-01 -1.22586653e-01]
 [ 7.21169147e-02 -1.11417883e-02]
 [ 3.10419555e-02 -7.05384954e-02]
 [-8.52792955e-02 -1.59849388e-01]
 [-1.38227420e+00  7.46390285e-01]
 [ 4.31584144e-02 -7.32578371e-02]
 [ 1.35268666e-01  4.21956180e-01]
 [-4.44353485e-01 -8.60900814e-02]
 [-4.07421544e-02 -6.92415712e-02]
 [-3.45393150e-02 -8.90269452e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.13277374e-01 -6.01951520e-02]
 [ 1.63850133e-01  8.99775442e-02]
 [ 4.43808379e-02 -7.15365313e-01]
 [-3.96525219e-01  1.22132596e-01]
 [-1.54011395e-01 -8.86577980e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.1347011]
curr_Stock_Price:  99.43375722669946
curr_Factors:  [9.94337572e+01 4.24700295e-02]
mat_Sqrt:  [[ 2.04915652e+01  0.00000000e+00]
 [-8.24330317e-03  1.88877804e-02]]
grads:  [3.50291229e-03 8.23393422e+00]
Stock Position:  0.0035029122920383973
Bond Position:  [-1.48300883]


portfolio before change:  [-1.13355348]
curr_Stock_Price:  99.867230837843
curr_Factors:  [9.98672308e+01 4.15111367e-02]
mat_Sqrt:  [[ 2.03472312e+01  0.00000000e+00]
 [-8.14971280e-03  1.86733379e-02]]
grads:  [ 0.00252008 -1.41038026]
Stock Position:  0.0025200775814033186
Bond Position:  [-1.38522665]


portfolio before change:  [-1.13476032]
curr_Stock_Price:  99.52577995793168
curr_Factors:  [9.95257800e+01 4.22632039e-02]
mat_Sqrt:  [[ 2.04605262e+01  0.00000000e+00]
 [-8.22320657e-03  1.88417333e-02]]
grads:  [  0.02721758 -14.32633835]
Stock Position:  0.0272175840656203
Bond Position:  [-3.8436116]


portfolio before change:  [-1.16168111]
curr_Stock_Price:  98.57199323514578
curr_Factors:  [9.85719932e+01 4.55383934e-02]
mat_Sqrt:  [[ 2.10349939e+01  0.00000000e+00]
 [-8.53589066e-03  1.95581825e-02]]
grads:  [-0.00808364 -6.26779368]
Stock Position:  -0.008083641657271018
Bond Position:  [-0.36486044]


portfolio before change:  [-1.1746645]
curr_Stock_Price:  100.16683925223533
curr_Factors:  [1.00166839e+02 4.57624121e-02]
mat_Sqrt:  [[ 2.14278414e+01  0.00000000e+00]
 [-8.55686037e-03  1.96062302e-02]]
grads:  [ 0.00313864 -0.56827795]
Stock Position:  0.0031386381036535944
Bond Position:  [-1.48905196]


portfolio before change:  [-1.17827492]
curr_Stock_Price:  99.13514741002375
curr_Factors:  [9.91351474e+01 4.53655093e-02]
mat_Sqrt:  [[ 2.11149740e+01  0.00000000e+00]
 [-8.51967222e-03  1.95210214e-02]]
grads:  [ 1.21445667e-05 -3.61346335e+00]
Stock Position:  1.2144566718434024e-05
Bond Position:  [-1.17947887]


portfolio before change:  [-1.1785514]
curr_Stock_Price:  100.65221406456645
curr_Factors:  [1.00652214e+02 4.45633008e-02]
mat_Sqrt:  [[ 2.12477040e+01  0.00000000e+00]
 [-8.44400861e-03  1.93476543e-02]]
grads:  [-7.29694312e-03 -8.26195183e+00]
Stock Position:  -0.007296943119449666
Bond Position:  [-0.44409792]


portfolio before change:  [-1.1936702]
curr_Stock_Price:  102.70893284851573
curr_Factors:  [1.02708933e+02 4.42565869e-02]
mat_Sqrt:  [[ 2.16071345e+01  0.00000000e+00]
 [-8.41489983e-03  1.92809577e-02]]
grads:  [-0.04889694 38.71126613]
Stock Position:  -0.048896940620594284
Bond Position:  [3.82848239]


portfolio before change:  [-1.22996691]
curr_Stock_Price:  103.47082012471922
curr_Factors:  [1.03470820e+02 4.44832936e-02]
mat_Sqrt:  [[ 2.18230958e+01  0.00000000e+00]
 [-8.43642518e-03  1.93302785e-02]]
grads:  [ 5.12579571e-04 -3.78979729e+00]
Stock Position:  0.0005125795706757953
Bond Position:  [-1.28300394]


portfolio before change:  [-1.22998063]
curr_Stock_Price:  104.0699056862076
curr_Factors:  [1.04069906e+02 4.43784894e-02]
mat_Sqrt:  [[ 2.19235772e+01  0.00000000e+00]
 [-8.42648106e-03  1.93074936e-02]]
grads:  [1.45699508e-02 2.18545290e+01]
Stock Position:  0.014569950767236436
Bond Position:  [-2.74627403]


portfolio before change:  [-1.21048739]
curr_Stock_Price:  105.45494045361319
curr_Factors:  [1.05454940e+02 4.37559359e-02]
mat_Sqrt:  [[ 2.20589796e+01  0.00000000e+00]
 [-8.36716783e-03  1.91715900e-02]]
grads:  [-0.02184717 -4.49050296]
Stock Position:  -0.021847169951328037
Bond Position:  [1.09340462]


portfolio before change:  [-1.24624248]
curr_Stock_Price:  107.10405456410982
curr_Factors:  [1.07104055e+02 4.55172167e-02]
mat_Sqrt:  [[ 2.28503976e+01  0.00000000e+00]
 [-8.53390571e-03  1.95536345e-02]]
grads:  [-3.10548879e-03 -3.54111004e+00]
Stock Position:  -0.0031054887896202884
Bond Position:  [-0.91363204]


portfolio before change:  [-1.24538735]
curr_Stock_Price:  106.7551344423196
curr_Factors:  [1.06755134e+02 4.85637014e-02]
mat_Sqrt:  [[ 2.35258142e+01  0.00000000e+00]
 [-8.81486938e-03  2.01974031e-02]]
grads:  [-3.11971602e-03 -4.40784119e+00]
Stock Position:  -0.003119716021464906
Bond Position:  [-0.91234165]


portfolio before change:  [-1.25073103]
curr_Stock_Price:  108.39488640723528
curr_Factors:  [1.08394886e+02 4.79569834e-02]
mat_Sqrt:  [[ 2.37374861e+01  0.00000000e+00]
 [-8.75963318e-03  2.00708411e-02]]
grads:  [6.41336413e-03 7.40268378e+00]
Stock Position:  0.006413364129250655
Bond Position:  [-1.9459069]


portfolio before change:  [-1.23741027]
curr_Stock_Price:  110.54778083682655
curr_Factors:  [1.10547781e+02 4.67828935e-02]
mat_Sqrt:  [[ 2.39107703e+01  0.00000000e+00]
 [-8.65174142e-03  1.98236300e-02]]
grads:  [-0.00583623 -3.03653529]
Stock Position:  -0.0058362273482159156
Bond Position:  [-0.59222829]


portfolio before change:  [-1.24813728]
curr_Stock_Price:  112.36041350806276
curr_Factors:  [1.12360414e+02 4.55208329e-02]
mat_Sqrt:  [[ 2.39727816e+01  0.00000000e+00]
 [-8.53424471e-03  1.95544112e-02]]
grads:  [0.00847292 4.60139369]
Stock Position:  0.008472923849374609
Bond Position:  [-2.20015851]


portfolio before change:  [-1.24236607]
curr_Stock_Price:  113.10647411129764
curr_Factors:  [1.13106474e+02 4.44279189e-02]
mat_Sqrt:  [[ 2.38405049e+01  0.00000000e+00]
 [-8.43117253e-03  1.93182432e-02]]
grads:  [-1.12342495e-02 -3.70305574e+01]
Stock Position:  -0.011234249497135277
Bond Position:  [0.02830028]


portfolio before change:  [-1.21983166]
curr_Stock_Price:  111.10123682466774
curr_Factors:  [1.11101237e+02 4.51141476e-02]
mat_Sqrt:  [[ 2.35980041e+01  0.00000000e+00]
 [-8.49603650e-03  1.94668652e-02]]
grads:  [-0.01454454  6.27387077]
Stock Position:  -0.014544542961242845
Bond Position:  [0.39608505]


portfolio before change:  [-1.23715237]
curr_Stock_Price:  112.29891934920286
curr_Factors:  [1.12298919e+02 4.55105633e-02]
mat_Sqrt:  [[ 2.39569586e+01  0.00000000e+00]
 [-8.53328198e-03  1.95522053e-02]]
grads:  [-0.00804379 -4.53441424]
Stock Position:  -0.008043793593713948
Bond Position:  [-0.33384304]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.25644342]
Stock Price:  114.6867949129711
PL:  [-15.94323833]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 9.72511674e-03  1.43915446e-01]
 [ 8.48106784e-02 -1.04492226e-02]
 [ 8.10045853e-01 -3.11242771e-01]
 [ 4.01953376e-01 -5.54348599e-02]
 [ 2.13113891e-01 -2.96433881e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-4.71726728e-01 -1.02340602e-01]
 [-1.48384566e+00  7.52923479e-01]
 [ 4.51098280e-02 -7.37627492e-02]
 [ 1.40576921e-01  4.68819827e-01]
 [-3.54002722e-01 -5.37560973e-02]
 [ 1.84261061e-02 -9.10555016e-03]
 [ 9.11604482e-02 -2.05832697e-02]
 [ 3.41343535e-02  5.61836732e-02]
 [-8.28440268e-02 -3.74010449e-02]
 [-1.41367322e-01 -1.30210714e-01]
 [-1.87458188e-01 -4.06638420e-01]
 [ 1.26207493e-01 -2.01281360e-01]
 [ 7.36642546e-02 -1.06077181e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.39702212]
curr_Stock_Price:  99.24362114865684
curr_Factors:  [9.92436211e+01 4.32597123e-02]
mat_Sqrt:  [[ 2.06416503e+01  0.00000000e+00]
 [-8.31958771e-03  1.90625702e-02]]
grads:  [3.51401007e-03 7.54963495e+00]
Stock Position:  0.0035140100691212267
Bond Position:  [-2.74576521]


portfolio before change:  [-2.39266066]
curr_Stock_Price:  100.68015367708158
curr_Factors:  [1.00680154e+02 4.19922017e-02]
mat_Sqrt:  [[ 2.06313759e+01  0.00000000e+00]
 [-8.19679955e-03  1.87812272e-02]]
grads:  [ 0.00388972 -0.55636527]
Stock Position:  0.00388971942534767
Bond Position:  [-2.78427821]


portfolio before change:  [-2.38726691]
curr_Stock_Price:  102.24579606144647
curr_Factors:  [1.02245796e+02 3.94129904e-02]
mat_Sqrt:  [[ 2.02985565e+01  0.00000000e+00]
 [-7.94108208e-03  1.81953049e-02]]
grads:  [  0.0332146  -17.10566394]
Stock Position:  0.03321459692296711
Bond Position:  [-5.78331981]


portfolio before change:  [-2.337471]
curr_Stock_Price:  103.7885489210808
curr_Factors:  [1.03788549e+02 3.94999103e-02]
mat_Sqrt:  [[ 2.06275427e+01  0.00000000e+00]
 [-7.94983374e-03  1.82153574e-02]]
grads:  [ 0.01831336 -3.04330344]
Stock Position:  0.018313360203649705
Bond Position:  [-4.23818809]


portfolio before change:  [-2.34198695]
curr_Stock_Price:  103.59981951454199
curr_Factors:  [1.03599820e+02 3.66755564e-02]
mat_Sqrt:  [[ 1.98402598e+01  0.00000000e+00]
 [-7.66034531e-03  1.75520561e-02]]
grads:  [ 0.01008941 -1.68888408]
Stock Position:  0.01008940700978581
Bond Position:  [-3.3872477]


portfolio before change:  [-2.32480173]
curr_Stock_Price:  105.38705424691169
curr_Factors:  [1.05387054e+02 3.55474344e-02]
mat_Sqrt:  [[ 1.98697039e+01  0.00000000e+00]
 [-7.54161091e-03  1.72800014e-02]]
grads:  [-2.91711521e-05 -1.11985964e+00]
Stock Position:  -2.917115213612921e-05
Bond Position:  [-2.32172747]


portfolio before change:  [-2.32537432]
curr_Stock_Price:  105.11549130860726
curr_Factors:  [1.05115491e+02 3.58261626e-02]
mat_Sqrt:  [[ 1.98960503e+01  0.00000000e+00]
 [-7.57112014e-03  1.73476156e-02]]
grads:  [-0.02595449 -5.89940455]
Stock Position:  -0.025954489473755206
Bond Position:  [0.4028446]


portfolio before change:  [-2.32833865]
curr_Stock_Price:  105.23358472502356
curr_Factors:  [1.05233585e+02 3.46208068e-02]
mat_Sqrt:  [[ 1.95804630e+01  0.00000000e+00]
 [-7.44266692e-03  1.70532923e-02]]
grads:  [-0.05899978 44.15120944]
Stock Position:  -0.05899977523855192
Bond Position:  [3.8804192]


portfolio before change:  [-2.21483251]
curr_Stock_Price:  103.32618913957916
curr_Factors:  [1.03326189e+02 3.64634313e-02]
mat_Sqrt:  [[ 1.97305494e+01  0.00000000e+00]
 [-7.63816013e-03  1.75012235e-02]]
grads:  [ 6.54676395e-04 -4.21471958e+00]
Stock Position:  0.0006546763954440797
Bond Position:  [-2.28247773]


portfolio before change:  [-2.21465224]
curr_Stock_Price:  104.47325350151135
curr_Factors:  [1.04473254e+02 3.66624166e-02]
mat_Sqrt:  [[ 2.00039455e+01  0.00000000e+00]
 [-7.65897294e-03  1.75489116e-02]]
grads:  [1.72559292e-02 2.67150372e+01]
Stock Position:  0.01725592921937243
Bond Position:  [-4.01743531]


portfolio before change:  [-2.21876489]
curr_Stock_Price:  104.29313235184799
curr_Factors:  [1.04293132e+02 3.54524204e-02]
mat_Sqrt:  [[ 1.96371590e+01  0.00000000e+00]
 [-7.53152526e-03  1.72568923e-02]]
grads:  [-0.01922192 -3.11505087]
Stock Position:  -0.019221915250953597
Bond Position:  [-0.21405114]


portfolio before change:  [-2.15853296]
curr_Stock_Price:  101.1568450193266
curr_Factors:  [1.01156845e+02 3.84109118e-02]
mat_Sqrt:  [[ 1.98254285e+01  0.00000000e+00]
 [-7.83948077e-03  1.79625070e-02]]
grads:  [ 0.00072897 -0.50691978]
Stock Position:  0.0007289687661707969
Bond Position:  [-2.23227314]


portfolio before change:  [-2.15862973]
curr_Stock_Price:  101.78975118131233
curr_Factors:  [1.01789751e+02 3.75852180e-02]
mat_Sqrt:  [[ 1.97338848e+01  0.00000000e+00]
 [-7.75476298e-03  1.77683942e-02]]
grads:  [ 0.00416427 -1.15842037]
Stock Position:  0.004164267372578737
Bond Position:  [-2.58250947]


portfolio before change:  [-2.16685166]
curr_Stock_Price:  99.97040882601543
curr_Factors:  [9.99704088e+01 3.81465738e-02]
mat_Sqrt:  [[ 1.95253684e+01  0.00000000e+00]
 [-7.81245916e-03  1.79005927e-02]]
grads:  [3.00403647e-03 3.13864876e+00]
Stock Position:  0.003004036468170134
Bond Position:  [-2.46716642]


portfolio before change:  [-2.16874873]
curr_Stock_Price:  99.54424929014426
curr_Factors:  [9.95442493e+01 3.89029759e-02]
mat_Sqrt:  [[ 1.96339458e+01  0.00000000e+00]
 [-7.88953494e-03  1.80771955e-02]]
grads:  [-0.0050508  -2.06896279]
Stock Position:  -0.00505080242061264
Bond Position:  [-1.66597039]


portfolio before change:  [-2.17159472]
curr_Stock_Price:  100.02525221256586
curr_Factors:  [1.00025252e+02 3.73846348e-02]
mat_Sqrt:  [[ 1.93399892e+01  0.00000000e+00]
 [-7.73404265e-03  1.77209179e-02]]
grads:  [-0.01024799 -7.34785381]
Stock Position:  -0.010247985928740374
Bond Position:  [-1.14653735]


portfolio before change:  [-2.1627038]
curr_Stock_Price:  99.12970103465412
curr_Factors:  [9.91297010e+01 3.63537108e-02]
mat_Sqrt:  [[ 1.89007123e+01  0.00000000e+00]
 [-7.62665965e-03  1.74748726e-02]]
grads:  [-1.93077244e-02 -2.32698933e+01]
Stock Position:  -0.0193077244491389
Bond Position:  [-0.24873485]


portfolio before change:  [-2.21587957]
curr_Stock_Price:  101.88059881115345
curr_Factors:  [1.01880599e+02 3.57708294e-02]
mat_Sqrt:  [[ 1.92688588e+01  0.00000000e+00]
 [-7.56527112e-03  1.73342138e-02]]
grads:  [ 1.99083433e-03 -1.16117963e+01]
Stock Position:  0.0019908343331612815
Bond Position:  [-2.41870696]


portfolio before change:  [-2.2194964]
curr_Stock_Price:  100.36762304530386
curr_Factors:  [1.00367623e+02 3.76152550e-02]
mat_Sqrt:  [[ 1.94659518e+01  0.00000000e+00]
 [-7.75786105e-03  1.77754927e-02]]
grads:  [ 1.40596142e-03 -5.96760846e+00]
Stock Position:  0.001405961424945479
Bond Position:  [-2.36060941]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.21974429]
Stock Price:  100.61111200986487
PL:  [-2.8308563]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.05345709e-02  1.24549025e-01]
 [ 4.44516341e-02 -5.38649597e-02]
 [ 5.92056737e-01 -2.44711685e-01]
 [-1.13731753e-01 -1.16635224e-01]
 [ 3.45686747e-01 -1.39555767e-02]
 [-3.59709614e-01 -3.71019840e-01]
 [-2.38953987e-02 -5.09107676e-02]
 [-1.27743158e+00  6.94543269e-01]
 [ 5.60523709e-02 -2.52156366e-02]
 [ 1.81289170e-02 -7.41964333e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 1.03982224e-01 -1.20496880e-01]
 [ 9.09939252e-02 -2.37615996e-03]
 [-7.95488777e-02 -1.11454551e-01]
 [ 6.96565102e-02  7.45359391e-02]
 [-1.43638219e-01 -1.40408180e-01]
 [-1.99645809e-01 -2.62097075e-01]
 [ 3.79561483e-01 -4.23690263e-01]
 [-2.62150546e-01 -1.92254092e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.73579955]
curr_Stock_Price:  99.0419688866076
curr_Factors:  [9.90419689e+01 3.95807274e-02]
mat_Sqrt:  [[ 1.97043063e+01  0.00000000e+00]
 [-7.95796229e-03  1.82339823e-02]]
grads:  [3.80080478e-03 6.83059919e+00]
Stock Position:  0.0038008047760238867
Bond Position:  [-4.11223874]


portfolio before change:  [-3.73936104]
curr_Stock_Price:  98.37545085278408
curr_Factors:  [9.83754509e+01 4.06203500e-02]
mat_Sqrt:  [[ 1.98270712e+01  0.00000000e+00]
 [-8.06179633e-03  1.84718960e-02]]
grads:  [ 1.05628502e-03 -2.91604932e+00]
Stock Position:  0.0010562850240287505
Bond Position:  [-3.84327356]


portfolio before change:  [-3.7401808]
curr_Stock_Price:  98.50910566074073
curr_Factors:  [9.85091057e+01 3.99194298e-02]
mat_Sqrt:  [[ 1.96819689e+01  0.00000000e+00]
 [-7.99193892e-03  1.83118325e-02]]
grads:  [  0.02465484 -13.36358254]
Stock Position:  0.02465484039298918
Bond Position:  [-6.16890708]


portfolio before change:  [-3.738339]
curr_Stock_Price:  98.64636980745861
curr_Factors:  [9.86463698e+01 4.13746170e-02]
mat_Sqrt:  [[ 2.00654129e+01  0.00000000e+00]
 [-8.13630058e-03  1.86426066e-02]]
grads:  [-0.00820494 -6.25637958]
Stock Position:  -0.00820494144676377
Bond Position:  [-2.92895131]


portfolio before change:  [-3.71665292]
curr_Stock_Price:  95.9140642421227
curr_Factors:  [9.59140642e+01 4.23790307e-02]
mat_Sqrt:  [[ 1.97450303e+01  0.00000000e+00]
 [-8.23446714e-03  1.88675345e-02]]
grads:  [ 0.01719906 -0.73966086]
Stock Position:  0.017199063758820368
Bond Position:  [-5.36628503]


portfolio before change:  [-3.73371876]
curr_Stock_Price:  94.99982279579488
curr_Factors:  [9.49998228e+01 4.14846948e-02]
mat_Sqrt:  [[ 1.93493662e+01  0.00000000e+00]
 [-8.14711677e-03  1.86673896e-02]]
grads:  [ -0.02695881 -19.87529308]
Stock Position:  -0.02695881306182259
Bond Position:  [-1.17263629]


portfolio before change:  [-3.7721907]
curr_Stock_Price:  96.41601088817171
curr_Factors:  [9.64160109e+01 3.89332685e-02]
mat_Sqrt:  [[ 1.90243397e+01  0.00000000e+00]
 [-7.89260601e-03  1.80842322e-02]]
grads:  [-2.42398318e-03 -2.81520205e+00]
Stock Position:  -0.002423983177303048
Bond Position:  [-3.53847991]


portfolio before change:  [-3.77559028]
curr_Stock_Price:  97.45349815967194
curr_Factors:  [9.74534982e+01 3.90036030e-02]
mat_Sqrt:  [[ 1.92464128e+01  0.00000000e+00]
 [-7.89973195e-03  1.81005598e-02]]
grads:  [-0.05062284 38.37136953]
Stock Position:  -0.050622838582041474
Bond Position:  [1.15778242]


portfolio before change:  [-3.76131487]
curr_Stock_Price:  97.17722103362553
curr_Factors:  [9.71772210e+01 4.12086924e-02]
mat_Sqrt:  [[ 1.97269022e+01  0.00000000e+00]
 [-8.11996969e-03  1.86051879e-02]]
grads:  [ 0.00228355 -1.35530137]
Stock Position:  0.0022835498616049455
Bond Position:  [-3.9832239]


portfolio before change:  [-3.76456174]
curr_Stock_Price:  96.1915013387077
curr_Factors:  [9.61915013e+01 4.16497331e-02]
mat_Sqrt:  [[ 1.96310177e+01  0.00000000e+00]
 [-8.16330649e-03  1.87044850e-02]]
grads:  [-7.26048008e-04 -3.96677233e+00]
Stock Position:  -0.00072604800783167
Bond Position:  [-3.69472209]


portfolio before change:  [-3.7637658]
curr_Stock_Price:  93.82287849578681
curr_Factors:  [9.38228785e+01 4.41725158e-02]
mat_Sqrt:  [[ 1.97189970e+01  0.00000000e+00]
 [-8.40690343e-03  1.92626357e-02]]
grads:  [1.36875319e-02 1.81475061e+01]
Stock Position:  0.013687531942361277
Bond Position:  [-5.04796945]


portfolio before change:  [-3.77068012]
curr_Stock_Price:  93.40993583982439
curr_Factors:  [9.34099358e+01 4.61146105e-02]
mat_Sqrt:  [[ 2.00591417e+01  0.00000000e+00]
 [-8.58972507e-03  1.96815327e-02]]
grads:  [ 2.56207746e-03 -6.12233213e+00]
Stock Position:  0.002562077455640323
Bond Position:  [-4.01000361]


portfolio before change:  [-3.7713394]
curr_Stock_Price:  93.54394429836202
curr_Factors:  [9.35439443e+01 4.50610014e-02]
mat_Sqrt:  [[ 1.98571126e+01  0.00000000e+00]
 [-8.49103069e-03  1.94553954e-02]]
grads:  [ 0.00453021 -0.12213373]
Stock Position:  0.0045302097024141055
Bond Position:  [-4.19511309]


portfolio before change:  [-3.76473714]
curr_Stock_Price:  95.23286654738533
curr_Factors:  [9.52328665e+01 4.34396110e-02]
mat_Sqrt:  [[ 1.98485973e+01  0.00000000e+00]
 [-8.33686857e-03  1.91021656e-02]]
grads:  [-0.00645847 -5.83465522]
Stock Position:  -0.006458473087392416
Bond Position:  [-3.14967824]


portfolio before change:  [-3.7705]
curr_Stock_Price:  96.00322498973986
curr_Factors:  [9.60032250e+01 4.29248363e-02]
mat_Sqrt:  [[ 1.98902456e+01  0.00000000e+00]
 [-8.28732394e-03  1.89886446e-02]]
grads:  [0.00513753 3.92529012]
Stock Position:  0.005137526350762955
Bond Position:  [-4.2637191]


portfolio before change:  [-3.76855395]
curr_Stock_Price:  96.58952174670408
curr_Factors:  [9.65895217e+01 4.46219578e-02]
mat_Sqrt:  [[ 2.04034837e+01  0.00000000e+00]
 [-8.44956404e-03  1.93603834e-02]]
grads:  [-0.01004325 -7.25234501]
Stock Position:  -0.01004325415480266
Bond Position:  [-2.79848083]


portfolio before change:  [-3.73542004]
curr_Stock_Price:  93.22073184046769
curr_Factors:  [9.32207318e+01 4.64244373e-02]
mat_Sqrt:  [[ 2.00856473e+01  0.00000000e+00]
 [-8.61853234e-03  1.97475384e-02]]
grads:  [ -0.01563476 -13.27239219]
Stock Position:  -0.015634763739220126
Bond Position:  [-2.27793592]


portfolio before change:  [-3.72664939]
curr_Stock_Price:  92.62333195412538
curr_Factors:  [9.26233320e+01 4.71090912e-02]
mat_Sqrt:  [[ 2.01035504e+01  0.00000000e+00]
 [-8.68185153e-03  1.98926209e-02]]
grads:  [ 9.68226450e-03 -2.12988658e+01]
Stock Position:  0.009682264500305054
Bond Position:  [-4.62345299]


portfolio before change:  [-3.72571783]
curr_Stock_Price:  92.83893940404532
curr_Factors:  [9.28389394e+01 4.36017214e-02]
mat_Sqrt:  [[ 1.93857224e+01  0.00000000e+00]
 [-8.35241009e-03  1.91377757e-02]]
grads:  [ -0.01785113 -10.04579083]
Stock Position:  -0.01785113315087161
Bond Position:  [-2.06843756]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.71582951]
Stock Price:  92.25603548619686
PL:  [-3.71582951]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.56404764e-03  1.22805402e-02]
 [-1.24871020e-01  1.10079783e-01]
 [ 8.75768766e-01 -3.31301647e-01]
 [ 4.44722972e-01 -5.23797623e-02]
 [ 3.03016753e-01 -3.30443543e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-4.14054877e-01 -1.15741609e-01]
 [-1.26635807e+00  7.35214423e-01]
 [ 8.25718630e-02 -6.30593084e-02]
 [ 1.54739992e-02 -8.69907602e-02]
 [-1.93830521e-02  6.78109288e-02]
 [ 5.26086850e-02 -9.92552321e-03]
 [ 1.23843829e-01 -3.59770905e-02]
 [-9.87893359e-02 -1.53223931e-01]
 [ 1.48433802e-01  2.22926135e-01]
 [-2.02396865e-02 -9.64196929e-02]
 [-2.00628297e-01 -2.48423113e-01]
 [ 2.75735656e-01 -3.07205614e-01]
 [-2.75423694e-01 -1.95661185e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.87760738]
curr_Stock_Price:  102.44809493220602
curr_Factors:  [1.02448095e+02 3.85571740e-02]
mat_Sqrt:  [[ 2.01166882e+01  0.00000000e+00]
 [-7.85439230e-03  1.79966736e-02]]
grads:  [3.93887639e-04 6.82378339e-01]
Stock Position:  0.00039388763870743345
Bond Position:  [18.83725434]


portfolio before change:  [18.88231505]
curr_Stock_Price:  102.44244092178278
curr_Factors:  [1.02442441e+02 3.94790708e-02]
mat_Sqrt:  [[ 2.03546378e+01  0.00000000e+00]
 [-7.94773636e-03  1.82105517e-02]]
grads:  [-3.77448445e-03  6.04483515e+00]
Stock Position:  -0.0037744844488226586
Bond Position:  [19.26898245]


portfolio before change:  [18.88469873]
curr_Stock_Price:  103.08734162354835
curr_Factors:  [1.03087342e+02 4.07875046e-02]
mat_Sqrt:  [[ 2.08194335e+01  0.00000000e+00]
 [-8.07836662e-03  1.85098633e-02]]
grads:  [  0.03511992 -17.89865445]
Stock Position:  0.035119921635801084
Bond Position:  [15.26427937]


portfolio before change:  [18.93882655]
curr_Stock_Price:  104.51989802543343
curr_Factors:  [1.04519898e+02 4.33437666e-02]
mat_Sqrt:  [[ 2.17601709e+01  0.00000000e+00]
 [-8.32766633e-03  1.90810807e-02]]
grads:  [ 0.01938691 -2.74511508]
Stock Position:  0.019386914376849935
Bond Position:  [16.91250823]


portfolio before change:  [18.95577463]
curr_Stock_Price:  105.17598110440137
curr_Factors:  [1.05175981e+02 4.43292893e-02]
mat_Sqrt:  [[ 2.21443000e+01  0.00000000e+00]
 [-8.42180877e-03  1.92967881e-02]]
grads:  [ 0.01303247 -1.71242769]
Stock Position:  0.013032474021888075
Bond Position:  [17.58507139]


portfolio before change:  [18.9269548]
curr_Stock_Price:  102.62722117843548
curr_Factors:  [1.02627221e+02 4.63282381e-02]
mat_Sqrt:  [[ 2.20894784e+01  0.00000000e+00]
 [-8.60959819e-03  1.97270677e-02]]
grads:  [-2.62397393e-05 -9.80945390e-01]
Stock Position:  -2.623973934702363e-05
Bond Position:  [18.92964771]


portfolio before change:  [18.93163667]
curr_Stock_Price:  104.57587938817099
curr_Factors:  [1.04575879e+02 4.87624382e-02]
mat_Sqrt:  [[ 2.30926744e+01  0.00000000e+00]
 [-8.83288747e-03  2.02386877e-02]]
grads:  [-0.02011758 -5.71882973]
Stock Position:  -0.020117577065942156
Bond Position:  [21.03544998]


portfolio before change:  [19.03427743]
curr_Stock_Price:  99.73527446343891
curr_Factors:  [9.97352745e+01 4.94478976e-02]
mat_Sqrt:  [[ 2.21780165e+01  0.00000000e+00]
 [-8.89475329e-03  2.03804401e-02]]
grads:  [-0.04263159 36.07451154]
Stock Position:  -0.04263159352961284
Bond Position:  [23.28615112]


portfolio before change:  [19.05829815]
curr_Stock_Price:  99.30839731938315
curr_Factors:  [9.93083973e+01 4.70939327e-02]
mat_Sqrt:  [[ 2.15510509e+01  0.00000000e+00]
 [-8.68045462e-03  1.98894202e-02]]
grads:  [ 2.55442413e-03 -3.17049506e+00]
Stock Position:  0.002554424133124303
Bond Position:  [18.80462239]


portfolio before change:  [19.05835649]
curr_Stock_Price:  97.49060736176934
curr_Factors:  [9.74906074e+01 4.54988790e-02]
mat_Sqrt:  [[ 2.07952011e+01  0.00000000e+00]
 [-8.53218650e-03  1.95496952e-02]]
grads:  [-1.08158998e-03 -4.44972462e+00]
Stock Position:  -0.0010815899779580331
Bond Position:  [19.16380135]


portfolio before change:  [19.06127675]
curr_Stock_Price:  99.22073530592009
curr_Factors:  [9.92207353e+01 4.47716504e-02]
mat_Sqrt:  [[ 2.09944254e+01  0.00000000e+00]
 [-8.46372498e-03  1.93928302e-02]]
grads:  [4.86417863e-04 3.49670100e+00]
Stock Position:  0.0004864178627551503
Bond Position:  [19.01301401]


portfolio before change:  [19.06449733]
curr_Stock_Price:  96.06856595345887
curr_Factors:  [9.60685660e+01 4.61866476e-02]
mat_Sqrt:  [[ 2.06461714e+01  0.00000000e+00]
 [-8.59643159e-03  1.96968992e-02]]
grads:  [ 0.00233829 -0.50391298]
Stock Position:  0.002338294624241215
Bond Position:  [18.83986071]


portfolio before change:  [19.06739586]
curr_Stock_Price:  95.29363174565725
curr_Factors:  [9.52936317e+01 4.79057802e-02]
mat_Sqrt:  [[ 2.08572880e+01  0.00000000e+00]
 [-8.75495564e-03  2.00601235e-02]]
grads:  [ 0.00518486 -1.79346306]
Stock Position:  0.005184861021034433
Bond Position:  [18.57331162]


portfolio before change:  [19.06110963]
curr_Stock_Price:  93.18554607710954
curr_Factors:  [9.31855461e+01 4.84740665e-02]
mat_Sqrt:  [[ 2.05165003e+01  0.00000000e+00]
 [-8.80673074e-03  2.01787551e-02]]
grads:  [-0.00807456 -7.59332922]
Stock Position:  -0.008074561404811012
Bond Position:  [19.81354205]


portfolio before change:  [19.0741683]
curr_Stock_Price:  92.18181865352574
curr_Factors:  [9.21818187e+01 5.10228736e-02]
mat_Sqrt:  [[ 2.08222535e+01  0.00000000e+00]
 [-9.03529732e-03  2.07024670e-02]]
grads:  [ 0.01180116 10.76809518]
Stock Position:  0.01180115993683104
Bond Position:  [17.98631591]


portfolio before change:  [19.07694489]
curr_Stock_Price:  92.03602366548888
curr_Factors:  [9.20360237e+01 5.18697838e-02]
mat_Sqrt:  [[ 2.09611481e+01  0.00000000e+00]
 [-9.10997553e-03  2.08735762e-02]]
grads:  [-2.97315253e-03 -4.61922250e+00]
Stock Position:  -0.0029731525264439676
Bond Position:  [19.35058202]


portfolio before change:  [19.07984736]
curr_Stock_Price:  92.68711062515435
curr_Factors:  [9.26871106e+01 5.21679126e-02]
mat_Sqrt:  [[ 2.11700105e+01  0.00000000e+00]
 [-9.13611844e-03  2.09334772e-02]]
grads:  [ -0.01459844 -11.86726462]
Stock Position:  -0.01459843544684123
Bond Position:  [20.43293416]


portfolio before change:  [19.03872875]
curr_Stock_Price:  95.8537153260542
curr_Factors:  [9.58537153e+01 4.96397110e-02]
mat_Sqrt:  [[ 2.13561800e+01  0.00000000e+00]
 [-8.91198842e-03  2.04199308e-02]]
grads:  [ 6.63321500e-03 -1.50444004e+01]
Stock Position:  0.006633214997952955
Bond Position:  [18.40291045]


portfolio before change:  [19.02139435]
curr_Stock_Price:  92.54676579109244
curr_Factors:  [9.25467658e+01 5.26195250e-02]
mat_Sqrt:  [[ 2.12292528e+01  0.00000000e+00]
 [-9.17557846e-03  2.10238914e-02]]
grads:  [-0.01699623 -9.30661128]
Stock Position:  -0.01699622874712412
Bond Position:  [20.59434035]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.02533536]
Stock Price:  92.61785332924059
PL:  [19.02533536]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.56040813e-02  1.33382583e-01]
 [-1.02659353e-02  3.95825251e-02]
 [ 7.96691241e-01 -3.07166893e-01]
 [ 7.40732462e-02 -1.09271210e-01]
 [ 1.93155696e-01 -5.59881469e-03]
 [ 2.62393421e-02 -7.78544933e-02]
 [-6.87592794e-02 -1.36118076e-01]
 [-1.25607717e+00  7.35288397e-01]
 [ 7.17294847e-02 -4.76035656e-02]
 [ 1.33148590e-02 -9.73958827e-02]
 [-2.43354507e-02  5.31247582e-02]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.59149025e-01 -2.97284111e-02]
 [-5.98244551e-02 -6.80069648e-02]
 [ 4.68631189e-02  3.16011892e-02]
 [-1.43634160e-01 -1.40389953e-01]
 [-1.90372892e-01 -3.91287693e-01]
 [ 2.88558960e-01 -2.59964112e-01]
 [ 3.22830904e-03 -1.24152563e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.12466409]
curr_Stock_Price:  99.13402066815851
curr_Factors:  [9.91340207e+01 4.09887577e-02]
mat_Sqrt:  [[ 2.00703570e+01  0.00000000e+00]
 [-8.09827218e-03  1.85554726e-02]]
grads:  [3.67791229e-03 7.18831502e+00]
Stock Position:  0.003677912294230094
Bond Position:  [-3.48927033]


portfolio before change:  [-3.11571685]
curr_Stock_Price:  101.80392397587391
curr_Factors:  [1.01803924e+02 4.08975980e-02]
mat_Sqrt:  [[ 2.05879649e+01  0.00000000e+00]
 [-8.08926182e-03  1.85348273e-02]]
grads:  [3.40455938e-04 2.13557561e+00]
Stock Position:  0.00034045593825274257
Bond Position:  [-3.1503766]


portfolio before change:  [-3.11647578]
curr_Stock_Price:  101.88841746401705
curr_Factors:  [1.01888417e+02 4.01656796e-02]
mat_Sqrt:  [[ 2.04198420e+01  0.00000000e+00]
 [-8.01655084e-03  1.83682255e-02]]
grads:  [  0.03245043 -16.72273095]
Stock Position:  0.032450428323754325
Bond Position:  [-6.42279856]


portfolio before change:  [-3.17226369]
curr_Stock_Price:  100.21873184676062
curr_Factors:  [1.00218732e+02 4.10036919e-02]
mat_Sqrt:  [[ 2.02936602e+01  0.00000000e+00]
 [-8.09974734e-03  1.85588527e-02]]
grads:  [ 1.30007995e-03 -5.88782139e+00]
Stock Position:  0.0013000799451192721
Bond Position:  [-3.30255605]


portfolio before change:  [-3.17444411]
curr_Stock_Price:  99.17673392943139
curr_Factors:  [9.91767339e+01 3.89825120e-02]
mat_Sqrt:  [[ 1.95814439e+01  0.00000000e+00]
 [-7.89759579e-03  1.80956652e-02]]
grads:  [ 0.00973943 -0.30940088]
Stock Position:  0.009739433632996666
Bond Position:  [-4.14036933]


portfolio before change:  [-3.1780221]
curr_Stock_Price:  98.91565458317116
curr_Factors:  [9.89156546e+01 3.67671128e-02]
mat_Sqrt:  [[ 1.89668318e+01  0.00000000e+00]
 [-7.66990094e-03  1.75739508e-02]]
grads:  [-4.08035699e-04 -4.43010761e+00]
Stock Position:  -0.0004080356986751058
Bond Position:  [-3.13766098]


portfolio before change:  [-3.1791947]
curr_Stock_Price:  99.86675357191099
curr_Factors:  [9.98667536e+01 3.72670025e-02]
mat_Sqrt:  [[ 1.92789405e+01  0.00000000e+00]
 [-7.72186532e-03  1.76930162e-02]]
grads:  [-6.64798347e-03 -7.69332229e+00]
Stock Position:  -0.006647983472385751
Bond Position:  [-2.51528217]


portfolio before change:  [-3.17578053]
curr_Stock_Price:  99.25858937851312
curr_Factors:  [9.92585894e+01 3.99399881e-02]
mat_Sqrt:  [[ 1.98368205e+01  0.00000000e+00]
 [-7.99399655e-03  1.83165472e-02]]
grads:  [-0.04714319 40.14339554]
Stock Position:  -0.047143190412268214
Bond Position:  [1.50358605]


portfolio before change:  [-3.13674692]
curr_Stock_Price:  98.43858402663608
curr_Factors:  [9.84385840e+01 4.08718742e-02]
mat_Sqrt:  [[ 1.99011253e+01  0.00000000e+00]
 [-8.08671742e-03  1.85289974e-02]]
grads:  [ 2.56033690e-03 -2.56913878e+00]
Stock Position:  0.0025603368950849986
Bond Position:  [-3.38878286]


portfolio before change:  [-3.13735138]
curr_Stock_Price:  98.53342909742634
curr_Factors:  [9.85334291e+01 4.13215763e-02]
mat_Sqrt:  [[ 2.00295890e+01  0.00000000e+00]
 [-8.13108370e-03  1.86306533e-02]]
grads:  [-1.45745323e-03 -5.22772236e+00]
Stock Position:  -0.0014574532256462984
Bond Position:  [-2.99374352]


portfolio before change:  [-3.13924805]
curr_Stock_Price:  99.32119716409409
curr_Factors:  [9.93211972e+01 4.12158698e-02]
mat_Sqrt:  [[ 2.01638835e+01  0.00000000e+00]
 [-8.12067680e-03  1.86068081e-02]]
grads:  [-5.70279736e-05  2.85512475e+00]
Stock Position:  -5.702797355160821e-05
Bond Position:  [-3.13358396]


portfolio before change:  [-3.13994306]
curr_Stock_Price:  97.76968023731071
curr_Factors:  [9.77696802e+01 3.98816180e-02]
mat_Sqrt:  [[ 1.95249792e+01  0.00000000e+00]
 [-7.98815303e-03  1.83031580e-02]]
grads:  [ 0.00245923 -0.46939347]
Stock Position:  0.002459233263501661
Bond Position:  [-3.38038151]


portfolio before change:  [-3.14154022]
curr_Stock_Price:  97.4639114574822
curr_Factors:  [9.74639115e+01 3.90940801e-02]
mat_Sqrt:  [[ 1.92707819e+01  0.00000000e+00]
 [-7.90888919e-03  1.81215417e-02]]
grads:  [ 0.00758529 -1.64050121]
Stock Position:  0.00758529072295106
Bond Position:  [-3.88083232]


portfolio before change:  [-3.14299554]
curr_Stock_Price:  97.39997288709
curr_Factors:  [9.73999729e+01 3.88599543e-02]
mat_Sqrt:  [[ 1.92003869e+01  0.00000000e+00]
 [-7.88517133e-03  1.80671973e-02]]
grads:  [-0.00466163 -3.7641126 ]
Stock Position:  -0.004661631482938437
Bond Position:  [-2.68895276]


portfolio before change:  [-3.14231091]
curr_Stock_Price:  97.10888379641908
curr_Factors:  [9.71088838e+01 4.05455311e-02]
mat_Sqrt:  [[ 1.95537681e+01  0.00000000e+00]
 [-8.05436837e-03  1.84548764e-02]]
grads:  [0.00310196 1.71234901]
Stock Position:  0.003101960113366084
Bond Position:  [-3.4435388]


portfolio before change:  [-3.14260762]
curr_Stock_Price:  97.29079767299979
curr_Factors:  [9.72907977e+01 3.88494019e-02]
mat_Sqrt:  [[ 1.91762610e+01  0.00000000e+00]
 [-7.88410065e-03  1.80647440e-02]]
grads:  [-0.01068537 -7.77148862]
Stock Position:  -0.010685365530078195
Bond Position:  [-2.10301988]


portfolio before change:  [-3.15839378]
curr_Stock_Price:  98.71895087323988
curr_Factors:  [9.87189509e+01 3.77299466e-02]
mat_Sqrt:  [[ 1.91753644e+01  0.00000000e+00]
 [-7.76967918e-03  1.78025715e-02]]
grads:  [-1.88337928e-02 -2.19792794e+01]
Stock Position:  -0.01883379283747154
Bond Position:  [-1.29914151]


portfolio before change:  [-3.14659762]
curr_Stock_Price:  98.07537441472039
curr_Factors:  [9.80753744e+01 3.98753430e-02]
mat_Sqrt:  [[ 1.95844866e+01  0.00000000e+00]
 [-7.98752458e-03  1.83017180e-02]]
grads:  [ 8.94081746e-03 -1.42043557e+01]
Stock Position:  0.008940817461610262
Bond Position:  [-4.02347164]


portfolio before change:  [-3.14122321]
curr_Stock_Price:  98.7890003727853
curr_Factors:  [9.87890004e+01 3.96704652e-02]
mat_Sqrt:  [[ 1.96762457e+01  0.00000000e+00]
 [-7.96697837e-03  1.82546407e-02]]
grads:  [-2.58973751e-03 -6.80115071e+00]
Stock Position:  -0.002589737506111631
Bond Position:  [-2.88538563]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.14060908]
Stock Price:  98.27328654068289
PL:  [-3.14060908]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.35062206e-02  2.57358031e-02]
 [ 8.36697864e-02 -1.08568109e-02]
 [ 7.84475394e-01 -3.03438572e-01]
 [ 9.72255976e-02 -1.11661944e-01]
 [ 2.74285250e-01 -8.73049721e-03]
 [-1.85901951e-01 -2.53401754e-01]
 [-5.29583835e-02 -6.02149573e-02]
 [-1.25598067e+00  7.18446253e-01]
 [ 8.21559484e-02 -6.24804117e-02]
 [ 1.55904633e-02 -8.64295075e-02]
 [ 2.89600895e-02  2.01354709e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.46351289e-01 -3.18013309e-02]
 [-5.76615825e-02 -6.30516704e-02]
 [ 1.68966801e-02  5.65965131e-03]
 [-1.42387763e-01 -1.34793003e-01]
 [-1.83428632e-01 -4.25002698e-01]
 [ 2.89681099e-01 -2.65938169e-01]
 [-1.05309632e-02 -1.27684275e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.59073074]
curr_Stock_Price:  101.04926668430474
curr_Factors:  [1.01049267e+02 3.97412063e-02]
mat_Sqrt:  [[ 2.01443700e+01  0.00000000e+00]
 [-7.97407864e-03  1.82709095e-02]]
grads:  [1.22804763e-03 1.40856716e+00]
Stock Position:  0.001228047633748503
Bond Position:  [9.46663743]


portfolio before change:  [9.59279629]
curr_Stock_Price:  100.80382789775472
curr_Factors:  [1.00803828e+02 3.90087283e-02]
mat_Sqrt:  [[ 1.99093885e+01  0.00000000e+00]
 [-7.90025096e-03  1.81017490e-02]]
grads:  [ 0.00396454 -0.59976585]
Stock Position:  0.003964535919073755
Bond Position:  [9.19315589]


portfolio before change:  [9.59856324]
curr_Stock_Price:  101.67867971362165
curr_Factors:  [1.01678680e+02 4.00345637e-02]
mat_Sqrt:  [[ 2.03445200e+01  0.00000000e+00]
 [-8.00345562e-03  1.83382206e-02]]
grads:  [  0.0320501  -16.54678381]
Stock Position:  0.03205010211729447
Bond Position:  [6.33975118]


portfolio before change:  [9.55866266]
curr_Stock_Price:  100.38427751381553
curr_Factors:  [1.00384278e+02 4.20029188e-02]
mat_Sqrt:  [[ 2.05733698e+01  0.00000000e+00]
 [-8.19784545e-03  1.87836237e-02]]
grads:  [ 2.35704362e-03 -5.94464337e+00]
Stock Position:  0.0023570436174778736
Bond Position:  [9.32205254]


portfolio before change:  [9.55511991]
curr_Stock_Price:  97.89236357930982
curr_Factors:  [9.78923636e+01 4.22688412e-02]
mat_Sqrt:  [[ 2.01260703e+01  0.00000000e+00]
 [-8.22375497e-03  1.88429898e-02]]
grads:  [ 0.01343903 -0.46332866]
Stock Position:  0.013439034256189822
Bond Position:  [8.23954108]


portfolio before change:  [9.5355998]
curr_Stock_Price:  96.28657457406966
curr_Factors:  [9.62865746e+01 4.28314020e-02]
mat_Sqrt:  [[ 1.99272276e+01  0.00000000e+00]
 [-8.27829953e-03  1.89679671e-02]]
grads:  [ -0.01487892 -13.35945768]
Stock Position:  -0.01487891585302457
Bond Position:  [10.96823964]


portfolio before change:  [9.55133946]
curr_Stock_Price:  95.4130394152662
curr_Factors:  [9.54130394e+01 4.35358228e-02]
mat_Sqrt:  [[ 1.99081594e+01  0.00000000e+00]
 [-8.34609588e-03  1.91233081e-02]]
grads:  [-0.00398019 -3.14877306]
Stock Position:  -0.003980194447390118
Bond Position:  [9.93110191]


portfolio before change:  [9.54168362]
curr_Stock_Price:  98.46287265911407
curr_Factors:  [9.84628727e+01 4.48002783e-02]
mat_Sqrt:  [[ 2.08407267e+01  0.00000000e+00]
 [-8.46643049e-03  1.93990293e-02]]
grads:  [-0.04522035 37.03516514]
Stock Position:  -0.045220353166658324
Bond Position:  [13.99420949]


portfolio before change:  [9.50839859]
curr_Stock_Price:  99.27631201482144
curr_Factors:  [9.92763120e+01 4.36159588e-02]
mat_Sqrt:  [[ 2.07332960e+01  0.00000000e+00]
 [-8.35377365e-03  1.91409000e-02]]
grads:  [ 2.64730032e-03 -3.26423583e+00]
Stock Position:  0.002647300321684585
Bond Position:  [9.24558438]


portfolio before change:  [9.50582822]
curr_Stock_Price:  97.4321486191869
curr_Factors:  [9.74321486e+01 4.68017057e-02]
mat_Sqrt:  [[ 2.10781806e+01  0.00000000e+00]
 [-8.65348075e-03  1.98276153e-02]]
grads:  [-1.04992299e-03 -4.35904703e+00]
Stock Position:  -0.0010499229858110385
Bond Position:  [9.60812447]


portfolio before change:  [9.50733493]
curr_Stock_Price:  98.28518828161054
curr_Factors:  [9.82851883e+01 4.67213313e-02]
mat_Sqrt:  [[ 2.12444591e+01  0.00000000e+00]
 [-8.64604708e-03  1.98105826e-02]]
grads:  [5.49971588e-03 1.01639974e+01]
Stock Position:  0.0054997158785506685
Bond Position:  [8.96679432]


portfolio before change:  [9.50731574]
curr_Stock_Price:  97.87404532846855
curr_Factors:  [9.78740453e+01 4.62801314e-02]
mat_Sqrt:  [[ 2.10554647e+01  0.00000000e+00]
 [-8.60512697e-03  1.97168229e-02]]
grads:  [ 0.00228048 -0.4357387 ]
Stock Position:  0.0022804758290034576
Bond Position:  [9.28411634]


portfolio before change:  [9.50655158]
curr_Stock_Price:  96.52105017061781
curr_Factors:  [9.65210502e+01 4.55568961e-02]
mat_Sqrt:  [[ 2.06015123e+01  0.00000000e+00]
 [-8.53762460e-03  1.95621555e-02]]
grads:  [ 0.00643021 -1.62565577]
Stock Position:  0.0064302100059921855
Bond Position:  [8.88590096]


portfolio before change:  [9.5162765]
curr_Stock_Price:  97.68791081958241
curr_Factors:  [9.76879108e+01 4.50270911e-02]
mat_Sqrt:  [[ 2.07289721e+01  0.00000000e+00]
 [-8.48783516e-03  1.94480736e-02]]
grads:  [-0.0041092  -3.24205224]
Stock Position:  -0.004109204594393887
Bond Position:  [9.91769611]


portfolio before change:  [9.51757815]
curr_Stock_Price:  97.9746025423962
curr_Factors:  [9.79746025e+01 4.72750642e-02]
mat_Sqrt:  [[ 2.13024509e+01  0.00000000e+00]
 [-8.69713187e-03  1.99276326e-02]]
grads:  [0.00090913 0.28401022]
Stock Position:  0.0009091326843693376
Bond Position:  [9.42850624]


portfolio before change:  [9.52083783]
curr_Stock_Price:  98.96704076471907
curr_Factors:  [9.89670408e+01 4.73099599e-02]
mat_Sqrt:  [[ 2.15261754e+01  0.00000000e+00]
 [-8.70034113e-03  1.99349859e-02]]
grads:  [-0.00934752 -6.76163021]
Stock Position:  -0.009347515217131017
Bond Position:  [10.44593375]


portfolio before change:  [9.51685011]
curr_Stock_Price:  99.6730606164218
curr_Factors:  [9.96730606e+01 4.70722845e-02]
mat_Sqrt:  [[ 2.16252149e+01  0.00000000e+00]
 [-8.67845926e-03  1.98848482e-02]]
grads:  [-1.70594844e-02 -2.13731929e+01]
Stock Position:  -0.01705948441900956
Bond Position:  [11.21722114]


portfolio before change:  [9.55798792]
curr_Stock_Price:  97.42603204824326
curr_Factors:  [9.74260320e+01 4.94827416e-02]
mat_Sqrt:  [[ 2.16721447e+01  0.00000000e+00]
 [-8.89788663e-03  2.03876195e-02]]
grads:  [ 8.01102841e-03 -1.30441011e+01]
Stock Position:  0.008011028406003224
Bond Position:  [8.77750521]


portfolio before change:  [9.5686674]
curr_Stock_Price:  98.48517541219726
curr_Factors:  [9.84851754e+01 4.74724938e-02]
mat_Sqrt:  [[ 2.14581307e+01  0.00000000e+00]
 [-8.71527338e-03  1.99692000e-02]]
grads:  [-3.08773166e-03 -6.39406061e+00]
Stock Position:  -0.0030877316567196685
Bond Position:  [9.87276319]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.5809647]
Stock Price:  95.30199527006661
PL:  [9.5809647]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.54713613e-02  2.81522779e-02]
 [ 6.88032416e-02 -1.72714683e-02]
 [ 7.71111255e-01 -2.99359787e-01]
 [ 2.57622250e-01 -1.00445731e-01]
 [-1.36187149e-02 -1.26181538e-02]
 [ 4.17410978e-02 -1.88439512e-02]
 [-1.32415857e-01 -1.83571266e-01]
 [-1.33276761e+00  7.41828157e-01]
 [ 5.35308804e-02 -7.59485013e-02]
 [ 1.23305368e-01  3.37020994e-01]
 [-1.75274536e-01 -4.17515096e-02]
 [ 1.06106893e-02 -9.22607915e-03]
 [ 1.38703076e-01 -1.63028216e-02]
 [ 8.27516312e-02  1.33217391e-01]
 [-1.17308451e-01 -6.24830045e-02]
 [-1.41146608e-01 -1.29219597e-01]
 [-1.91044344e-01 -3.81953086e-01]
 [ 2.75419096e-01 -2.36715845e-01]
 [ 1.22150302e-02 -1.21846991e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.9230477]
curr_Stock_Price:  100.79807328070774
curr_Factors:  [1.00798073e+02 4.11299971e-02]
mat_Sqrt:  [[ 2.04423853e+01  0.00000000e+00]
 [-8.11221273e-03  1.85874144e-02]]
grads:  [1.35786613e-03 1.51458816e+00]
Stock Position:  0.0013578661297380939
Bond Position:  [7.78617741]


portfolio before change:  [7.92403554]
curr_Stock_Price:  100.09185966440478
curr_Factors:  [1.00091860e+02 4.07968595e-02]
mat_Sqrt:  [[ 2.02167865e+01  0.00000000e+00]
 [-8.07929299e-03  1.85119858e-02]]
grads:  [ 0.00303042 -0.93298841]
Stock Position:  0.0030304200336219007
Bond Position:  [7.62071516]


portfolio before change:  [7.92974333]
curr_Stock_Price:  101.34659262544807
curr_Factors:  [1.01346593e+02 4.06090834e-02]
mat_Sqrt:  [[ 2.04230568e+01  0.00000000e+00]
 [-8.06067822e-03  1.84693341e-02]]
grads:  [  0.03135965 -16.20847759]
Stock Position:  0.03135965095215513
Bond Position:  [4.75154956]


portfolio before change:  [7.94882686]
curr_Stock_Price:  101.91724632311224
curr_Factors:  [1.01917246e+02 4.01576221e-02]
mat_Sqrt:  [[ 2.04235708e+01  0.00000000e+00]
 [-8.01574672e-03  1.83663830e-02]]
grads:  [ 0.01046752 -5.46899902]
Stock Position:  0.010467520136346633
Bond Position:  [6.88200603]


portfolio before change:  [7.94051727]
curr_Stock_Price:  100.95901509192797
curr_Factors:  [1.00959015e+02 4.12243877e-02]
mat_Sqrt:  [[ 2.04985061e+01  0.00000000e+00]
 [-8.12151589e-03  1.86087307e-02]]
grads:  [-0.00093303 -0.67807708]
Stock Position:  -0.0009330303663532642
Bond Position:  [8.0347151]


portfolio before change:  [7.94272391]
curr_Stock_Price:  100.74712360407773
curr_Factors:  [1.00747124e+02 4.40273052e-02]
mat_Sqrt:  [[ 2.11394512e+01  0.00000000e+00]
 [-8.39307383e-03  1.92309481e-02]]
grads:  [ 0.00158552 -0.97987635]
Stock Position:  0.001585515299681065
Bond Position:  [7.7829878]


portfolio before change:  [7.9464642]
curr_Stock_Price:  101.8788078773307
curr_Factors:  [1.01878808e+02 4.60435623e-02]
mat_Sqrt:  [[ 2.18609139e+01  0.00000000e+00]
 [-8.58310548e-03  1.96663653e-02]]
grads:  [-0.00972205 -9.3342752 ]
Stock Position:  -0.009722051271550042
Bond Position:  [8.93693519]


portfolio before change:  [7.95338541]
curr_Stock_Price:  101.39673891063538
curr_Factors:  [1.01396739e+02 4.44994486e-02]
mat_Sqrt:  [[ 2.13895330e+01  0.00000000e+00]
 [-8.43795696e-03  1.93337882e-02]]
grads:  [-0.04717294 38.36951907]
Stock Position:  -0.04717294472736321
Bond Position:  [12.73656817]


portfolio before change:  [7.89509812]
curr_Stock_Price:  102.69985521562583
curr_Factors:  [1.02699855e+02 4.32351499e-02]
mat_Sqrt:  [[ 2.13544463e+01  0.00000000e+00]
 [-8.31722549e-03  1.90571577e-02]]
grads:  [ 9.54566398e-04 -3.98530057e+00]
Stock Position:  0.0009545663977257314
Bond Position:  [7.79706429]


portfolio before change:  [7.89760957]
curr_Stock_Price:  103.28854627462717
curr_Factors:  [1.03288546e+02 4.36643739e-02]
mat_Sqrt:  [[ 2.15831974e+01  0.00000000e+00]
 [-8.35840883e-03  1.91515206e-02]]
grads:  [1.25279579e-02 1.75976102e+01]
Stock Position:  0.012527957866718188
Bond Position:  [6.60361502]


portfolio before change:  [7.88277077]
curr_Stock_Price:  101.97229701650402
curr_Factors:  [1.01972297e+02 4.45368867e-02]
mat_Sqrt:  [[ 2.15199932e+01  0.00000000e+00]
 [-8.44150572e-03  1.93419195e-02]]
grads:  [-0.00899147 -2.15860219]
Stock Position:  -0.00899147072373462
Bond Position:  [8.79965169]


portfolio before change:  [7.88493473]
curr_Stock_Price:  101.97632556088243
curr_Factors:  [1.01976326e+02 4.46418894e-02]
mat_Sqrt:  [[ 2.15461978e+01  0.00000000e+00]
 [-8.45145094e-03  1.93647068e-02]]
grads:  [ 3.05580515e-04 -4.76437843e-01]
Stock Position:  0.00030558051527993446
Bond Position:  [7.85377275]


portfolio before change:  [7.88649142]
curr_Stock_Price:  100.64442177119452
curr_Factors:  [1.00644422e+02 4.57740361e-02]
mat_Sqrt:  [[ 2.15327408e+01  0.00000000e+00]
 [-8.55794705e-03  1.96087201e-02]]
grads:  [ 0.00611106 -0.83140672]
Stock Position:  0.006111063256044131
Bond Position:  [7.27144699]


portfolio before change:  [7.89051301]
curr_Stock_Price:  101.00499872253151
curr_Factors:  [1.01004999e+02 4.51528157e-02]
mat_Sqrt:  [[ 2.14627460e+01  0.00000000e+00]
 [-8.49967676e-03  1.94752061e-02]]
grads:  [6.56451263e-03 6.84035850e+00]
Stock Position:  0.006564512632359248
Bond Position:  [7.22746442]


portfolio before change:  [7.89609111]
curr_Stock_Price:  101.5794511493845
curr_Factors:  [1.01579451e+02 4.39880658e-02]
mat_Sqrt:  [[ 2.13045956e+01  0.00000000e+00]
 [-8.38933283e-03  1.92223764e-02]]
grads:  [-0.00678625 -3.25053486]
Stock Position:  -0.006786248042351913
Bond Position:  [8.58543446]


portfolio before change:  [7.90064382]
curr_Stock_Price:  101.22489749968167
curr_Factors:  [1.01224897e+02 4.43460518e-02]
mat_Sqrt:  [[ 2.13164473e+01  0.00000000e+00]
 [-8.42340091e-03  1.93004361e-02]]
grads:  [-0.00926715 -6.69516462]
Stock Position:  -0.009267147593818107
Bond Position:  [8.83870989]


portfolio before change:  [7.9291198]
curr_Stock_Price:  98.3905817992251
curr_Factors:  [9.83905818e+01 4.52346593e-02]
mat_Sqrt:  [[ 2.09261431e+01  0.00000000e+00]
 [-8.50737649e-03  1.94928484e-02]]
grads:  [-1.70954741e-02 -1.95945240e+01]
Stock Position:  -0.017095474131493944
Bond Position:  [9.61115344]


portfolio before change:  [7.90233239]
curr_Stock_Price:  100.09808061357823
curr_Factors:  [1.00098081e+02 4.72595281e-02]
mat_Sqrt:  [[ 2.17605787e+01  0.00000000e+00]
 [-8.69570268e-03  1.99243579e-02]]
grads:  [ 7.90915690e-03 -1.18807264e+01]
Stock Position:  0.007909156903185237
Bond Position:  [7.11064096]


portfolio before change:  [7.89537767]
curr_Stock_Price:  98.9939686156024
curr_Factors:  [9.89939686e+01 4.51922142e-02]
mat_Sqrt:  [[ 2.10445937e+01  0.00000000e+00]
 [-8.50338419e-03  1.94837009e-02]]
grads:  [-1.94650260e-03 -6.25379089e+00]
Stock Position:  -0.0019465026001974045
Bond Position:  [8.08806969]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.89749015]
Stock Price:  98.94762365498929
PL:  [7.89749015]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 5.74891591e-04  1.22992400e-01]
 [ 8.22528024e-02 -8.53755787e-03]
 [ 7.93222891e-01 -3.06108340e-01]
 [ 3.22797789e-01 -8.01201930e-02]
 [ 1.17272155e-01 -2.38214788e-02]
 [ 2.95336323e-02 -1.81470728e-02]
 [-1.57692412e-01 -1.91311485e-01]
 [-1.34501470e+00  7.43281295e-01]
 [ 6.69453349e-02 -7.76534180e-02]
 [ 9.05377812e-02  1.86366345e-01]
 [-2.20598615e-01 -2.55759577e-02]
 [ 5.35431769e-03 -9.30714267e-03]
 [ 9.22121969e-02 -2.03422217e-02]
 [ 8.80913113e-02  1.41881940e-01]
 [-1.06295433e-01 -4.84544671e-02]
 [-1.43216509e-01 -1.38514492e-01]
 [-1.87826248e-01 -4.04593151e-01]
 [ 2.78679353e-01 -2.42484195e-01]
 [ 5.92356483e-02 -1.09779803e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.74537793]
curr_Stock_Price:  99.7169426042697
curr_Factors:  [9.97169426e+01 4.11325639e-02]
mat_Sqrt:  [[ 2.02237573e+01  0.00000000e+00]
 [-8.11246585e-03  1.85879944e-02]]
grads:  [2.68264571e-03 6.61676551e+00]
Stock Position:  0.002682645713415641
Bond Position:  [0.47787271]


portfolio before change:  [0.7477477]
curr_Stock_Price:  100.55577408129734
curr_Factors:  [1.00555774e+02 4.15964974e-02]
mat_Sqrt:  [[ 2.05085707e+01  0.00000000e+00]
 [-8.15808776e-03  1.86925273e-02]]
grads:  [ 0.00382897 -0.45673641]
Stock Position:  0.00382897022182869
Bond Position:  [0.36272264]


portfolio before change:  [0.75223098]
curr_Stock_Price:  101.70297152039787
curr_Factors:  [1.01702972e+02 4.10091449e-02]
mat_Sqrt:  [[ 2.05955787e+01  0.00000000e+00]
 [-8.10028591e-03  1.85600867e-02]]
grads:  [  0.03202757 -16.49282925]
Stock Position:  0.03202756615221834
Bond Position:  [-2.50506767]


portfolio before change:  [0.78551949]
curr_Stock_Price:  102.76189837192119
curr_Factors:  [1.02761898e+02 3.91807472e-02]
mat_Sqrt:  [[ 2.03408209e+01  0.00000000e+00]
 [-7.91765089e-03  1.81416173e-02]]
grads:  [ 0.01415039 -4.41637544]
Stock Position:  0.014150386112688297
Bond Position:  [-0.66860105]


portfolio before change:  [0.77853358]
curr_Stock_Price:  102.28002230206832
curr_Factors:  [1.02280022e+02 4.00559247e-02]
mat_Sqrt:  [[ 2.04702994e+01  0.00000000e+00]
 [-8.00559052e-03  1.83431123e-02]]
grads:  [ 0.00522101 -1.29866069]
Stock Position:  0.005221008601911024
Bond Position:  [0.24452871]


portfolio before change:  [0.77213429]
curr_Stock_Price:  101.04263014342648
curr_Factors:  [1.01042630e+02 4.09191203e-02]
mat_Sqrt:  [[ 2.04393832e+01  0.00000000e+00]
 [-8.09139002e-03  1.85397036e-02]]
grads:  [ 0.00105745 -0.97882216]
Stock Position:  0.0010574487600590785
Bond Position:  [0.66528688]


portfolio before change:  [0.77345485]
curr_Stock_Price:  102.13414156497706
curr_Factors:  [1.02134142e+02 3.97960839e-02]
mat_Sqrt:  [[ 2.03746948e+01  0.00000000e+00]
 [-7.97958234e-03  1.82835200e-02]]
grads:  [ -0.0118376  -10.46360243]
Stock Position:  -0.011837604994737303
Bond Position:  [1.98247847]


portfolio before change:  [0.77960498]
curr_Stock_Price:  101.6564732043304
curr_Factors:  [1.01656473e+02 4.14021881e-02]
mat_Sqrt:  [[ 2.06845790e+01  0.00000000e+00]
 [-8.13901105e-03  1.86488171e-02]]
grads:  [-0.04934208 39.85675288]
Stock Position:  -0.049342079966446045
Bond Position:  [5.79554681]


portfolio before change:  [0.77616019]
curr_Stock_Price:  101.7556554678996
curr_Factors:  [1.01755655e+02 3.88435812e-02]
mat_Sqrt:  [[ 2.00547932e+01  0.00000000e+00]
 [-7.88351000e-03  1.80633907e-02]]
grads:  [ 1.64821470e-03 -4.29893919e+00]
Stock Position:  0.0016482146953310352
Bond Position:  [0.60844502]


portfolio before change:  [0.7759642]
curr_Stock_Price:  101.54444505970388
curr_Factors:  [1.01544445e+02 3.91226439e-02]
mat_Sqrt:  [[ 2.00849275e+01  0.00000000e+00]
 [-7.91177795e-03  1.81281607e-02]]
grads:  [8.55739819e-03 1.02804884e+01]
Stock Position:  0.008557398187513887
Bond Position:  [-0.09299205]


portfolio before change:  [0.7848399]
curr_Stock_Price:  102.58435802425083
curr_Factors:  [1.02584358e+02 3.73699960e-02]
mat_Sqrt:  [[ 1.98309112e+01  0.00000000e+00]
 [-7.73252828e-03  1.77174481e-02]]
grads:  [-0.01168685 -1.44354636]
Stock Position:  -0.011686849652215007
Bond Position:  [1.98372786]


portfolio before change:  [0.7868113]
curr_Stock_Price:  102.45811293017559
curr_Factors:  [1.02458113e+02 3.80856809e-02]
mat_Sqrt:  [[ 1.99952673e+01  0.00000000e+00]
 [-7.80622120e-03  1.78862998e-02]]
grads:  [ 6.46326748e-05 -5.20350368e-01]
Stock Position:  6.463267481309193e-05
Bond Position:  [0.78018915]


portfolio before change:  [0.78696164]
curr_Stock_Price:  101.7661141665463
curr_Factors:  [1.01766114e+02 3.69667510e-02]
mat_Sqrt:  [[ 1.95663056e+01  0.00000000e+00]
 [-7.69069578e-03  1.76215978e-02]]
grads:  [ 0.00425906 -1.15439144]
Stock Position:  0.00425906275730399
Bond Position:  [0.35353338]


portfolio before change:  [0.78425568]
curr_Stock_Price:  101.11001635924332
curr_Factors:  [1.01110016e+02 3.93091032e-02]
mat_Sqrt:  [[ 2.00466011e+01  0.00000000e+00]
 [-7.93060938e-03  1.81713089e-02]]
grads:  [7.48324694e-03 7.80801981e+00]
Stock Position:  0.0074832469429789595
Bond Position:  [0.02762445]


portfolio before change:  [0.77529337]
curr_Stock_Price:  99.91144362794059
curr_Factors:  [9.99114436e+01 3.90190087e-02]
mat_Sqrt:  [[ 1.97357370e+01  0.00000000e+00]
 [-7.90129191e-03  1.81041341e-02]]
grads:  [-0.00645746 -2.67643107]
Stock Position:  -0.006457458153511486
Bond Position:  [1.42046733]


portfolio before change:  [0.78745102]
curr_Stock_Price:  98.08371341507251
curr_Factors:  [9.80837134e+01 3.97790515e-02]
mat_Sqrt:  [[ 1.95624890e+01  0.00000000e+00]
 [-7.97787455e-03  1.82796070e-02]]
grads:  [-0.01041121 -7.57754212]
Stock Position:  -0.010411210435574064
Bond Position:  [1.8086212]


portfolio before change:  [0.77749584]
curr_Stock_Price:  99.08334633672419
curr_Factors:  [9.90833463e+01 3.76426792e-02]
mat_Sqrt:  [[ 1.92238748e+01  0.00000000e+00]
 [-7.76068855e-03  1.77819714e-02]]
grads:  [-1.89558650e-02 -2.27529975e+01]
Stock Position:  -0.01895586503501099
Bond Position:  [2.65570638]


portfolio before change:  [0.7641343]
curr_Stock_Price:  99.82325203322846
curr_Factors:  [9.98232520e+01 3.59961201e-02]
mat_Sqrt:  [[ 1.89391097e+01  0.00000000e+00]
 [-7.58905739e-03  1.73887150e-02]]
grads:  [ 9.12664728e-03 -1.39449175e+01]
Stock Position:  0.009126647281451843
Bond Position:  [-0.14691731]


portfolio before change:  [0.76611084]
curr_Stock_Price:  100.04384503353472
curr_Factors:  [1.00043845e+02 3.73831328e-02]
mat_Sqrt:  [[ 1.93431955e+01  0.00000000e+00]
 [-7.73388729e-03  1.77205620e-02]]
grads:  [ 5.85415908e-04 -6.19505200e+00]
Stock Position:  0.0005854159081240216
Bond Position:  [0.70754358]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.76757399]
Stock Price:  102.24098023036035
PL:  [-1.47340624]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.29498485e-02  1.22917557e-01]
 [ 4.09927995e-02 -5.90625974e-02]
 [ 5.53577019e-01 -2.32967533e-01]
 [-1.05878345e-01 -1.15757167e-01]
 [ 3.15602857e-01 -1.17540723e-02]
 [-1.42602923e-01 -2.23929378e-01]
 [-4.41721761e-02 -5.68188545e-02]
 [-1.31895288e+00  6.27975795e-01]
 [ 5.17523432e-03  4.74459195e-02]
 [ 2.30049967e-02 -5.06980947e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 7.99666419e-02 -6.73614258e-02]
 [ 9.64487539e-02 -9.43581164e-03]
 [-9.48306847e-02 -1.44627827e-01]
 [ 1.65270831e-01  2.54699261e-01]
 [ 5.01698990e-03 -9.61024391e-02]
 [-2.02712320e-01 -2.19358024e-01]
 [ 4.37630971e-01 -4.66032421e-01]
 [-1.55978673e-01 -1.65008008e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.75260682]
curr_Stock_Price:  99.86865563746335
curr_Factors:  [9.98686556e+01 3.92989303e-02]
mat_Sqrt:  [[ 1.97979201e+01  0.00000000e+00]
 [-7.92958312e-03  1.81689574e-02]]
grads:  [3.36376083e-03 6.76525096e+00]
Stock Position:  0.0033637608299557946
Bond Position:  [1.41667255]


portfolio before change:  [1.74654648]
curr_Stock_Price:  97.96169469453983
curr_Factors:  [9.79616947e+01 4.15150604e-02]
mat_Sqrt:  [[ 1.99599352e+01  0.00000000e+00]
 [-8.15009795e-03  1.86742204e-02]]
grads:  [ 7.62315538e-04 -3.16278785e+00]
Stock Position:  0.000762315538059491
Bond Position:  [1.67186875]


portfolio before change:  [1.74669227]
curr_Stock_Price:  97.60459294252588
curr_Factors:  [9.76045929e+01 4.24335287e-02]
mat_Sqrt:  [[ 2.01059607e+01  0.00000000e+00]
 [-8.23976007e-03  1.88796621e-02]]
grads:  [  0.022476   -12.33960289]
Stock Position:  0.0224760039544624
Bond Position:  [-0.44706895]


portfolio before change:  [1.73357386]
curr_Stock_Price:  97.0259034842153
curr_Factors:  [9.70259035e+01 4.36706572e-02]
mat_Sqrt:  [[ 2.02760129e+01  0.00000000e+00]
 [-8.35901020e-03  1.91528985e-02]]
grads:  [-0.00771349 -6.04384589]
Stock Position:  -0.00771349450444356
Bond Position:  [2.48198264]


portfolio before change:  [1.73636508]
curr_Stock_Price:  96.74449477710924
curr_Factors:  [9.67444948e+01 4.46081858e-02]
mat_Sqrt:  [[ 2.04330662e+01  0.00000000e+00]
 [-8.44826002e-03  1.93573955e-02]]
grads:  [ 0.01519463 -0.60721352]
Stock Position:  0.015194633883146638
Bond Position:  [0.2663679]


portfolio before change:  [1.73430996]
curr_Stock_Price:  96.60485888485127
curr_Factors:  [9.66048589e+01 4.57204964e-02]
mat_Sqrt:  [[ 2.06563907e+01  0.00000000e+00]
 [-8.55294067e-03  1.95972490e-02]]
grads:  [ -0.01163484 -11.42657203]
Stock Position:  -0.011634835880215468
Bond Position:  [2.85829164]


portfolio before change:  [1.74551772]
curr_Stock_Price:  95.70299054353971
curr_Factors:  [9.57029905e+01 4.57742599e-02]
mat_Sqrt:  [[ 2.04755782e+01  0.00000000e+00]
 [-8.55796797e-03  1.96087680e-02]]
grads:  [-0.0033684 -2.8976249]
Stock Position:  -0.0033684009571910752
Bond Position:  [2.06788376]


portfolio before change:  [1.74884939]
curr_Stock_Price:  94.86738982670654
curr_Factors:  [9.48673898e+01 4.53633017e-02]
mat_Sqrt:  [[ 2.02054850e+01  0.00000000e+00]
 [-8.51946493e-03  1.95205465e-02]]
grads:  [-0.05171278 32.16999055]
Stock Position:  -0.051712778577930635
Bond Position:  [6.65470572]


portfolio before change:  [1.84277976]
curr_Stock_Price:  93.08317938189019
curr_Factors:  [9.30831794e+01 4.36277786e-02]
mat_Sqrt:  [[ 1.94425292e+01  0.00000000e+00]
 [-8.35490549e-03  1.91434934e-02]]
grads:  [1.33122245e-03 2.47843580e+00]
Stock Position:  0.0013312224450097903
Bond Position:  [1.71886534]


portfolio before change:  [1.84408728]
curr_Stock_Price:  93.742538408203
curr_Factors:  [9.37425384e+01 4.41083981e-02]
mat_Sqrt:  [[ 1.96878074e+01  0.00000000e+00]
 [-8.40079978e-03  1.92486504e-02]]
grads:  [ 4.46232635e-05 -2.63385191e+00]
Stock Position:  4.4623263491311346e-05
Bond Position:  [1.83990418]


portfolio before change:  [1.84457402]
curr_Stock_Price:  94.34109854604212
curr_Factors:  [9.43410985e+01 4.50398592e-02]
mat_Sqrt:  [[ 2.00216304e+01  0.00000000e+00]
 [-8.48903850e-03  1.94508308e-02]]
grads:  [1.34806404e-02 1.79719212e+01]
Stock Position:  0.013480640441752957
Bond Position:  [0.57279559]


portfolio before change:  [1.84891982]
curr_Stock_Price:  94.65284765074716
curr_Factors:  [9.46528477e+01 4.54824012e-02]
mat_Sqrt:  [[ 2.01862374e+01  0.00000000e+00]
 [-8.53064135e-03  1.95461549e-02]]
grads:  [ 2.50505849e-03 -3.44627505e+00]
Stock Position:  0.0025050584926663393
Bond Position:  [1.6118089]


portfolio before change:  [1.84721291]
curr_Stock_Price:  93.81059013460246
curr_Factors:  [9.38105901e+01 4.51809223e-02]
mat_Sqrt:  [[ 1.99401956e+01  0.00000000e+00]
 [-8.50232179e-03  1.94812666e-02]]
grads:  [ 0.00463038 -0.48435309]
Stock Position:  0.004630377247972822
Bond Position:  [1.41283449]


portfolio before change:  [1.84661863]
curr_Stock_Price:  93.60595520580219
curr_Factors:  [9.36059552e+01 4.64321910e-02]
mat_Sqrt:  [[ 2.01703330e+01  0.00000000e+00]
 [-8.61925204e-03  1.97491874e-02]]
grads:  [-0.00783088 -7.32322927]
Stock Position:  -0.007830879314582598
Bond Position:  [2.57963557]


portfolio before change:  [1.86483963]
curr_Stock_Price:  91.3615062230496
curr_Factors:  [9.13615062e+01 4.76753835e-02]
mat_Sqrt:  [[ 1.99485047e+01  0.00000000e+00]
 [-8.73387735e-03  2.00118270e-02]]
grads:  [ 0.01385721 12.72743666]
Stock Position:  0.013857214110271191
Bond Position:  [0.59882368]


portfolio before change:  [1.84758023]
curr_Stock_Price:  90.10518419488471
curr_Factors:  [9.01051842e+01 4.79175914e-02]
mat_Sqrt:  [[ 1.97241033e+01  0.00000000e+00]
 [-8.75603484e-03  2.00625962e-02]]
grads:  [-1.87210301e-03 -4.79012975e+00]
Stock Position:  -0.0018721030064154157
Bond Position:  [2.01626642]


portfolio before change:  [1.8457616]
curr_Stock_Price:  91.34590488166364
curr_Factors:  [9.13459049e+01 4.37221767e-02]
mat_Sqrt:  [[ 1.91002904e+01  0.00000000e+00]
 [-8.36393942e-03  1.91641928e-02]]
grads:  [ -0.01562531 -11.44624385]
Stock Position:  -0.015625312733518887
Bond Position:  [3.27306993]


portfolio before change:  [1.84392458]
curr_Stock_Price:  91.51584637980156
curr_Factors:  [9.15158464e+01 4.33216214e-02]
mat_Sqrt:  [[ 1.90479680e+01  0.00000000e+00]
 [-8.32553868e-03  1.90762056e-02]]
grads:  [ 1.22972565e-02 -2.44300376e+01]
Stock Position:  0.012297256465804427
Bond Position:  [0.71853075]


portfolio before change:  [1.88962987]
curr_Stock_Price:  95.21794331802765
curr_Factors:  [9.52179433e+01 3.96278112e-02]
mat_Sqrt:  [[ 1.89547840e+01  0.00000000e+00]
 [-7.96269414e-03  1.82448243e-02]]
grads:  [-0.01202831 -9.04409956]
Stock Position:  -0.012028312828858521
Bond Position:  [3.03494108]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.89927834]
Stock Price:  94.4788839341809
PL:  [1.89927834]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.62184176e-02  2.90709107e-02]
 [-2.96355359e-02  5.14923328e-02]
 [ 7.96471164e-01 -3.07099725e-01]
 [ 1.30840506e-01 -1.14469975e-01]
 [ 4.74131790e-02 -1.14945615e-02]
 [ 2.63937280e-02 -1.83215614e-02]
 [-3.35528894e-01 -1.44067751e-01]
 [-1.50947399e+00  7.22739590e-01]
 [ 1.81943581e-02 -7.57168498e-02]
 [ 1.34687288e-01  4.16539387e-01]
 [-1.87374934e-01 -2.87645540e-02]
 [-8.26516770e-03 -9.90602665e-03]
 [ 2.42909399e-02 -4.73555028e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15763435e-01 -6.16061249e-02]
 [-8.37580590e-02 -1.00047703e-01]
 [-1.60070028e-01 -5.44124698e-01]
 [ 7.14648729e-02 -1.88654740e-01]
 [ 1.26357558e-01 -1.13312159e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.28875293]
curr_Stock_Price:  100.70253314639162
curr_Factors:  [1.00702533e+02 3.95503476e-02]
mat_Sqrt:  [[ 2.00269838e+01  0.00000000e+00]
 [-7.95490768e-03  1.82269833e-02]]
grads:  [1.44335280e-03 1.59493813e+00]
Stock Position:  0.0014433527983219161
Bond Position:  [7.14340364]


portfolio before change:  [7.2922874]
curr_Stock_Price:  101.91387775503487
curr_Factors:  [1.01913878e+02 3.91525537e-02]
mat_Sqrt:  [[ 2.01657033e+01  0.00000000e+00]
 [-7.91480170e-03  1.81350889e-02]]
grads:  [-3.55179252e-04  2.83937581e+00]
Stock Position:  -0.00035517925160001703
Bond Position:  [7.32848509]


portfolio before change:  [7.29401202]
curr_Stock_Price:  102.21719688239364
curr_Factors:  [1.02217197e+02 3.78369573e-02]
mat_Sqrt:  [[ 1.98830072e+01  0.00000000e+00]
 [-7.78068967e-03  1.78277997e-02]]
grads:  [  0.03331699 -17.22589049]
Stock Position:  0.03331698516172249
Bond Position:  [3.88844319]


portfolio before change:  [7.24211048]
curr_Stock_Price:  100.63020540734513
curr_Factors:  [1.00630205e+02 3.65704083e-02]
mat_Sqrt:  [[ 1.92439076e+01  0.00000000e+00]
 [-7.64935639e-03  1.75268773e-02]]
grads:  [ 4.20297760e-03 -6.53111065e+00]
Stock Position:  0.004202977601882005
Bond Position:  [6.81916398]


portfolio before change:  [7.24255944]
curr_Stock_Price:  100.33135965345042
curr_Factors:  [1.00331360e+02 3.58975067e-02]
mat_Sqrt:  [[ 1.90094189e+01  0.00000000e+00]
 [-7.57865494e-03  1.73648800e-02]]
grads:  [ 0.00223029 -0.66194304]
Stock Position:  0.0022302912763010655
Bond Position:  [7.01879128]


portfolio before change:  [7.24605349]
curr_Stock_Price:  101.11113967978378
curr_Factors:  [1.0111114e+02 3.4980694e-02]
mat_Sqrt:  [[ 1.89109443e+01  0.00000000e+00]
 [-7.48125059e-03  1.71416986e-02]]
grads:  [ 9.72851630e-04 -1.06882999e+00]
Stock Position:  0.0009728516302597763
Bond Position:  [7.14768736]


portfolio before change:  [7.25047838]
curr_Stock_Price:  103.82248749088974
curr_Factors:  [1.03822487e+02 3.30496634e-02]
mat_Sqrt:  [[ 1.88744780e+01  0.00000000e+00]
 [-7.27182655e-03  1.66618478e-02]]
grads:  [-0.02110814 -8.64656507]
Stock Position:  -0.02110814479572194
Bond Position:  [9.44197848]


portfolio before change:  [7.20453156]
curr_Stock_Price:  106.11106398857586
curr_Factors:  [1.06111064e+02 3.26279904e-02]
mat_Sqrt:  [[ 1.91670745e+01  0.00000000e+00]
 [-7.22528785e-03  1.65552143e-02]]
grads:  [-0.06229665 43.65631147]
Stock Position:  -0.062296652095624905
Bond Position:  [13.8148956]


portfolio before change:  [7.25446903]
curr_Stock_Price:  105.36490338756153
curr_Factors:  [1.05364903e+02 3.10601341e-02]
mat_Sqrt:  [[ 1.85693900e+01  0.00000000e+00]
 [-7.04955422e-03  1.61525579e-02]]
grads:  [-7.99766949e-04 -4.68760739e+00]
Stock Position:  -0.0007997669486907468
Bond Position:  [7.33873639]


portfolio before change:  [7.25736737]
curr_Stock_Price:  104.03522878935121
curr_Factors:  [1.04035229e+02 3.25295687e-02]
mat_Sqrt:  [[ 1.87637475e+01  0.00000000e+00]
 [-7.21438216e-03  1.65302262e-02]]
grads:  [1.68665658e-02 2.51986502e+01]
Stock Position:  0.016866565766964832
Bond Position:  [5.50265034]


portfolio before change:  [7.2270603]
curr_Stock_Price:  102.15678463950387
curr_Factors:  [1.02156785e+02 3.38410532e-02]
mat_Sqrt:  [[ 1.87926987e+01  0.00000000e+00]
 [-7.35837517e-03  1.68601556e-02]]
grads:  [-0.01063864 -1.70606694]
Stock Position:  -0.010638643136053179
Bond Position:  [8.31386988]


portfolio before change:  [7.21362751]
curr_Stock_Price:  103.61482027242168
curr_Factors:  [1.03614820e+02 3.12628656e-02]
mat_Sqrt:  [[ 1.83204556e+01  0.00000000e+00]
 [-7.07252324e-03  1.62051865e-02]]
grads:  [-0.00068713 -0.61128742]
Stock Position:  -0.0006871287724972703
Bond Position:  [7.28482423]


portfolio before change:  [7.21539902]
curr_Stock_Price:  103.6874707608168
curr_Factors:  [1.03687471e+02 3.25874687e-02]
mat_Sqrt:  [[ 1.87176617e+01  0.00000000e+00]
 [-7.22079982e-03  1.65449309e-02]]
grads:  [ 1.93576747e-04 -2.86223637e+00]
Stock Position:  0.00019357674653551441
Bond Position:  [7.19532754]


portfolio before change:  [7.21701765]
curr_Stock_Price:  102.755408604564
curr_Factors:  [1.02755409e+02 3.23382235e-02]
mat_Sqrt:  [[ 1.84783322e+01  0.00000000e+00]
 [-7.19313267e-03  1.64815375e-02]]
grads:  [8.23868412e-03 9.01481974e+00]
Stock Position:  0.008238684118758874
Bond Position:  [6.3704483]


portfolio before change:  [7.23553173]
curr_Stock_Price:  104.80928800871534
curr_Factors:  [1.04809288e+02 2.87023884e-02]
mat_Sqrt:  [[ 1.77565582e+01  0.00000000e+00]
 [-6.77671169e-03  1.55273972e-02]]
grads:  [-0.00803368 -3.96757578]
Stock Position:  -0.008033682573898627
Bond Position:  [8.07753628]


portfolio before change:  [7.23886134]
curr_Stock_Price:  104.64622728823429
curr_Factors:  [1.04646227e+02 2.85956510e-02]
mat_Sqrt:  [[ 1.76959373e+01  0.00000000e+00]
 [-6.76409947e-03  1.54984989e-02]]
grads:  [-0.00720066 -6.45531568]
Stock Position:  -0.007200661627178376
Bond Position:  [7.99238342]


portfolio before change:  [7.2548017]
curr_Stock_Price:  102.71001417105276
curr_Factors:  [1.02710014e+02 3.11077767e-02]
mat_Sqrt:  [[ 1.81153728e+01  0.00000000e+00]
 [-7.05495873e-03  1.61649412e-02]]
grads:  [-2.19452020e-02 -3.36607904e+01]
Stock Position:  -0.021945202007331154
Bond Position:  [9.50879371]


portfolio before change:  [7.26860829]
curr_Stock_Price:  102.18921276610651
curr_Factors:  [1.02189213e+02 3.32208185e-02]
mat_Sqrt:  [[ 1.86255977e+01  0.00000000e+00]
 [-7.29063163e-03  1.67049356e-02]]
grads:  [-5.83648685e-04 -1.12933533e+01]
Stock Position:  -0.0005836486853792128
Bond Position:  [7.32825089]


portfolio before change:  [7.27058398]
curr_Stock_Price:  101.94352288663922
curr_Factors:  [1.01943523e+02 3.44627809e-02]
mat_Sqrt:  [[ 1.89249524e+01  0.00000000e+00]
 [-7.42566155e-03  1.70143281e-02]]
grads:  [ 0.00641546 -0.66598081]
Stock Position:  0.006415456560009974
Bond Position:  [6.61656974]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.27752005]
Stock Price:  102.76680325686227
PL:  [4.51071679]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.01044356e-02  1.25319663e-01]
 [ 5.03413982e-02 -4.50143312e-02]
 [ 6.17469985e-01 -2.52467903e-01]
 [-1.00946454e-01 -1.09027749e-01]
 [ 3.68269462e-01 -1.56840238e-02]
 [-4.81411409e-01 -4.53454199e-01]
 [-9.42247290e-02 -7.61654976e-02]
 [-1.90812786e+00  4.67160422e-01]
 [-9.43457392e-02  1.17626769e-01]
 [ 3.19378024e-02  1.53239127e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 1.79942316e-01 -2.88476441e-01]
 [ 1.99799792e-04  1.31932894e-01]
 [-1.26845751e-01 -2.14106335e-01]
 [ 1.76320496e-01  2.75580563e-01]
 [ 6.70005072e-04 -9.60422600e-02]
 [-2.05650356e-01 -1.78412588e-01]
 [ 4.89273174e-01 -5.03646292e-01]
 [-3.34185131e-01 -2.10739062e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.68072807]
curr_Stock_Price:  99.05026398288247
curr_Factors:  [9.90502640e+01 3.87201161e-02]
mat_Sqrt:  [[ 1.94905441e+01  0.00000000e+00]
 [-7.87097108e-03  1.80346604e-02]]
grads:  [3.83767740e-03 6.94882301e+00]
Stock Position:  0.003837677401846139
Bond Position:  [-4.06085103]


portfolio before change:  [-3.68156075]
curr_Stock_Price:  99.09786074197427
curr_Factors:  [9.90978607e+01 3.69342641e-02]
mat_Sqrt:  [[ 1.90449135e+01  0.00000000e+00]
 [-7.68731569e-03  1.76138530e-02]]
grads:  [ 1.61174444e-03 -2.55562091e+00]
Stock Position:  0.0016117444409927447
Bond Position:  [-3.84128118]


portfolio before change:  [-3.68199798]
curr_Stock_Price:  99.42248328457976
curr_Factors:  [9.94224833e+01 3.56161678e-02]
mat_Sqrt:  [[ 1.87632559e+01  0.00000000e+00]
 [-7.54889850e-03  1.72966994e-02]]
grads:  [  0.02703603 -14.59630518]
Stock Position:  0.02703603055784981
Bond Position:  [-6.36998728]


portfolio before change:  [-3.75620096]
curr_Stock_Price:  96.73679751813626
curr_Factors:  [9.67367975e+01 3.67024326e-02]
mat_Sqrt:  [[ 1.85327186e+01  0.00000000e+00]
 [-7.66315159e-03  1.75584861e-02]]
grads:  [-0.00801448 -6.20940488]
Stock Position:  -0.008014477946203217
Bond Position:  [-2.98090603]


portfolio before change:  [-3.74567253]
curr_Stock_Price:  95.3301243112949
curr_Factors:  [9.53301243e+01 3.81890039e-02]
mat_Sqrt:  [[ 1.86294196e+01  0.00000000e+00]
 [-7.81680281e-03  1.79105453e-02]]
grads:  [ 0.01940073 -0.87568656]
Stock Position:  0.01940073287562757
Bond Position:  [-5.59514681]


portfolio before change:  [-3.77093975]
curr_Stock_Price:  94.09984850334666
curr_Factors:  [9.40998485e+01 3.93933008e-02]
mat_Sqrt:  [[ 1.86766986e+01  0.00000000e+00]
 [-7.93909826e-03  1.81907594e-02]]
grads:  [ -0.03637233 -24.92772237]
Stock Position:  -0.03637233010160529
Bond Position:  [-0.34830899]


portfolio before change:  [-3.76876926]
curr_Stock_Price:  94.03778007769034
curr_Factors:  [9.40377801e+01 3.98695168e-02]
mat_Sqrt:  [[ 1.87768551e+01  0.00000000e+00]
 [-7.98694102e-03  1.83003809e-02]]
grads:  [-0.00678847 -4.16196242]
Stock Position:  -0.006788467871994497
Bond Position:  [-3.13039681]


portfolio before change:  [-3.74142024]
curr_Stock_Price:  89.89373505938323
curr_Factors:  [8.98937351e+01 4.43096693e-02]
mat_Sqrt:  [[ 1.89225072e+01  0.00000000e+00]
 [-8.41994483e-03  1.92925173e-02]]
grads:  [-0.0900643  24.21459136]
Stock Position:  -0.0900642983003318
Bond Position:  [4.35479593]


portfolio before change:  [-3.63728615]
curr_Stock_Price:  88.74960520474673
curr_Factors:  [8.87496052e+01 4.64652589e-02]
mat_Sqrt:  [[ 1.91306890e+01  0.00000000e+00]
 [-8.62232070e-03  1.97562186e-02]]
grads:  [-2.24817876e-03  5.95391107e+00]
Stock Position:  -0.0022481787560153198
Bond Position:  [-3.43776118]


portfolio before change:  [-3.64051708]
curr_Stock_Price:  89.804404619481
curr_Factors:  [8.98044046e+01 4.29708600e-02]
mat_Sqrt:  [[ 1.86159267e+01  0.00000000e+00]
 [-8.29176555e-03  1.89988216e-02]]
grads:  [0.00207487 0.80657174]
Stock Position:  0.0020748742097495346
Bond Position:  [-3.82684992]


portfolio before change:  [-3.64557988]
curr_Stock_Price:  87.82550565891474
curr_Factors:  [8.78255057e+01 4.29209288e-02]
mat_Sqrt:  [[ 1.81951322e+01  0.00000000e+00]
 [-8.28694673e-03  1.89877803e-02]]
grads:  [1.48338797e-02 1.84101981e+01]
Stock Position:  0.01483387966455413
Bond Position:  [-4.94837286]


portfolio before change:  [-3.6222844]
curr_Stock_Price:  89.47933664372444
curr_Factors:  [8.94793366e+01 4.13162420e-02]
mat_Sqrt:  [[ 1.81879253e+01  0.00000000e+00]
 [-8.13055885e-03  1.86294507e-02]]
grads:  [ 2.97125011e-03 -1.54849676e+01]
Stock Position:  0.0029712501134690644
Bond Position:  [-3.88814988]


portfolio before change:  [-3.62619489]
curr_Stock_Price:  88.49041519870069
curr_Factors:  [8.84904152e+01 4.18729953e-02]
mat_Sqrt:  [[ 1.81076982e+01  0.00000000e+00]
 [-8.18515684e-03  1.87545504e-02]]
grads:  [3.19091000e-03 7.03471376e+00]
Stock Position:  0.003190910001811523
Bond Position:  [-3.90855984]


portfolio before change:  [-3.62174688]
curr_Stock_Price:  90.19064136164656
curr_Factors:  [9.01906414e+01 4.41443933e-02]
mat_Sqrt:  [[ 1.89495653e+01  0.00000000e+00]
 [-8.40422687e-03  1.92565029e-02]]
grads:  [ -0.01162504 -11.11865097]
Stock Position:  -0.011625037982256123
Bond Position:  [-2.57327725]


portfolio before change:  [-3.62972215]
curr_Stock_Price:  90.82133786567164
curr_Factors:  [9.08213379e+01 4.28854374e-02]
mat_Sqrt:  [[ 1.88080087e+01  0.00000000e+00]
 [-8.28351978e-03  1.89799282e-02]]
grads:  [ 0.01576954 14.5195788 ]
Stock Position:  0.015769543657616812
Bond Position:  [-5.0619332]


portfolio before change:  [-3.6368523]
curr_Stock_Price:  90.4494499002754
curr_Factors:  [9.04494499e+01 4.26722681e-02]
mat_Sqrt:  [[ 1.86843844e+01  0.00000000e+00]
 [-8.26290681e-03  1.89326980e-02]]
grads:  [-2.20752650e-03 -5.07282481e+00]
Stock Position:  -0.0022075264979014826
Bond Position:  [-3.43718274]


portfolio before change:  [-3.63574833]
curr_Stock_Price:  89.56005179706861
curr_Factors:  [8.95600518e+01 4.21606341e-02]
mat_Sqrt:  [[ 1.83894146e+01  0.00000000e+00]
 [-8.21322194e-03  1.88188556e-02]]
grads:  [-0.01541735 -9.4805227 ]
Stock Position:  -0.015417347405431993
Bond Position:  [-2.2549699]


portfolio before change:  [-3.65116757]
curr_Stock_Price:  90.52360456149361
curr_Factors:  [9.05236046e+01 4.12324473e-02]
mat_Sqrt:  [[ 1.83815189e+01  0.00000000e+00]
 [-8.12230975e-03  1.86105496e-02]]
grads:  [ 1.46595019e-02 -2.70624083e+01]
Stock Position:  0.014659501903644775
Bond Position:  [-4.97819852]


portfolio before change:  [-3.64219342]
curr_Stock_Price:  91.22068551320265
curr_Factors:  [9.12206855e+01 3.95195814e-02]
mat_Sqrt:  [[ 1.81342459e+01  0.00000000e+00]
 [-7.95181301e-03  1.82198925e-02]]
grads:  [ -0.02350024 -11.56642727]
Stock Position:  -0.02350024375142994
Bond Position:  [-1.49848507]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.62059567]
Stock Price:  90.285698895451
PL:  [-3.62059567]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.82029454e-02  1.00116440e-01]
 [ 4.92821066e-02 -4.66061431e-02]
 [ 6.20292844e-01 -2.53329450e-01]
 [-1.11259670e-01 -1.11242373e-01]
 [ 1.92195303e-01 -5.56652259e-03]
 [ 1.47583866e-02 -9.84738809e-02]
 [-1.56026698e-02 -5.05395056e-02]
 [-1.27843004e+00  6.91023447e-01]
 [ 4.42247987e-02 -8.33075147e-03]
 [ 2.03171810e-02 -6.36509603e-02]
 [ 1.14296455e-01  3.26993326e-01]
 [ 1.73469984e-02 -9.12219210e-03]
 [ 1.27315848e-01 -1.22998124e-02]
 [ 5.40844867e-02  8.32915048e-02]
 [-6.43553557e-02 -3.06060277e-02]
 [-1.41190336e-01 -1.29415958e-01]
 [-1.84209550e-01 -4.23272231e-01]
 [ 1.73189102e-01 -2.12420757e-01]
 [ 1.07907286e-01 -4.94683126e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.39622483]
curr_Stock_Price:  100.26684845108808
curr_Factors:  [1.00266848e+02 3.96190114e-02]
mat_Sqrt:  [[ 1.99576399e+01  0.00000000e+00]
 [-7.96180998e-03  1.82427985e-02]]
grads:  [3.60249721e-03 5.48799791e+00]
Stock Position:  0.003602497213306521
Bond Position:  [4.03501378]


portfolio before change:  [4.39241558]
curr_Stock_Price:  98.92940697707792
curr_Factors:  [9.89294070e+01 4.22624673e-02]
mat_Sqrt:  [[ 2.03377465e+01  0.00000000e+00]
 [-8.22313491e-03  1.88415691e-02]]
grads:  [ 1.42304449e-03 -2.47358078e+00]
Stock Position:  0.0014230444911143114
Bond Position:  [4.25163463]


portfolio before change:  [4.39295448]
curr_Stock_Price:  98.56108844907853
curr_Factors:  [9.85610884e+01 4.31907776e-02]
mat_Sqrt:  [[ 2.04833508e+01  0.00000000e+00]
 [-8.31295640e-03  1.90473760e-02]]
grads:  [  0.02488513 -13.29996584]
Stock Position:  0.02488512810290887
Bond Position:  [1.94024917]


portfolio before change:  [4.39713648]
curr_Stock_Price:  98.70964582829465
curr_Factors:  [9.87096458e+01 4.22284430e-02]
mat_Sqrt:  [[ 2.02843982e+01  0.00000000e+00]
 [-8.21982414e-03  1.88339832e-02]]
grads:  [-0.00787846 -5.9064709 ]
Stock Position:  -0.007878460116190472
Bond Position:  [5.17481648]


portfolio before change:  [4.3946726]
curr_Stock_Price:  99.18660958637061
curr_Factors:  [9.91866096e+01 4.16492760e-02]
mat_Sqrt:  [[ 2.02421563e+01  0.00000000e+00]
 [-8.16326170e-03  1.87043823e-02]]
grads:  [ 0.00937479 -0.29760526]
Stock Position:  0.009374785512634192
Bond Position:  [3.46481941]


portfolio before change:  [4.38786665]
curr_Stock_Price:  98.36821542716488
curr_Factors:  [9.83682154e+01 4.10234501e-02]
mat_Sqrt:  [[ 1.99237408e+01  0.00000000e+00]
 [-8.10169860e-03  1.85633235e-02]]
grads:  [-1.41635744e-03 -5.30475487e+00]
Stock Position:  -0.001416357435622631
Bond Position:  [4.5271912]


portfolio before change:  [4.39132906]
curr_Stock_Price:  96.72281309178024
curr_Factors:  [9.67228131e+01 3.93580920e-02]
mat_Sqrt:  [[ 1.91887170e+01  0.00000000e+00]
 [-7.93554959e-03  1.81826283e-02]]
grads:  [-1.96260742e-03 -2.77954896e+00]
Stock Position:  -0.0019626074232890634
Bond Position:  [4.58115797]


portfolio before change:  [4.3912962]
curr_Stock_Price:  97.32318770494317
curr_Factors:  [9.73231877e+01 4.05337696e-02]
mat_Sqrt:  [[ 1.95940775e+01  0.00000000e+00]
 [-8.05320007e-03  1.84521995e-02]]
grads:  [-0.04985398 37.44938097]
Stock Position:  -0.04985397664331572
Bond Position:  [9.24324412]


portfolio before change:  [4.44830122]
curr_Stock_Price:  96.22610524526158
curr_Factors:  [9.62261052e+01 4.01542402e-02]
mat_Sqrt:  [[ 1.92822902e+01  0.00000000e+00]
 [-8.01540918e-03  1.83656096e-02]]
grads:  [ 0.00210499 -0.45360604]
Stock Position:  0.0021049865113161458
Bond Position:  [4.24574657]


portfolio before change:  [4.4469915]
curr_Stock_Price:  95.09959704567295
curr_Factors:  [9.50995970e+01 3.95566375e-02]
mat_Sqrt:  [[ 1.89142167e+01  0.00000000e+00]
 [-7.95554021e-03  1.82284326e-02]]
grads:  [-3.94537913e-04 -3.49185043e+00]
Stock Position:  -0.0003945379126891181
Bond Position:  [4.4845119]


portfolio before change:  [4.44774429]
curr_Stock_Price:  96.03356286071998
curr_Factors:  [9.60335629e+01 3.86186982e-02]
mat_Sqrt:  [[ 1.88721707e+01  0.00000000e+00]
 [-7.86065628e-03  1.80110262e-02]]
grads:  [1.36183615e-02 1.81551746e+01]
Stock Position:  0.013618361472123072
Bond Position:  [3.13992451]


portfolio before change:  [4.5203433]
curr_Stock_Price:  101.30687935154987
curr_Factors:  [1.01306879e+02 3.46256652e-02]
mat_Sqrt:  [[ 1.88511566e+01  0.00000000e+00]
 [-7.44318913e-03  1.70544888e-02]]
grads:  [ 0.00070901 -0.53488511]
Stock Position:  0.0007090147141797163
Bond Position:  [4.44851523]


portfolio before change:  [4.52124484]
curr_Stock_Price:  101.00966889871286
curr_Factors:  [1.01009669e+02 3.60393024e-02]
mat_Sqrt:  [[ 1.91756960e+01  0.00000000e+00]
 [-7.59360809e-03  1.73991419e-02]]
grads:  [ 0.0063595  -0.70692063]
Stock Position:  0.0063594964308569275
Bond Position:  [3.87887421]


portfolio before change:  [4.51795347]
curr_Stock_Price:  100.33961502491917
curr_Factors:  [1.00339615e+02 3.46592377e-02]
mat_Sqrt:  [[ 1.86802177e+01  0.00000000e+00]
 [-7.44679665e-03  1.70627547e-02]]
grads:  [4.84126475e-03 4.88148054e+00]
Stock Position:  0.004841264751310558
Bond Position:  [4.03218283]


portfolio before change:  [4.51397301]
curr_Stock_Price:  99.30917504021706
curr_Factors:  [9.93091750e+01 3.31539071e-02]
mat_Sqrt:  [[ 1.80824275e+01  0.00000000e+00]
 [-7.28328575e-03  1.66881041e-02]]
grads:  [-0.0042977  -1.83400268]
Stock Position:  -0.00429770401662217
Bond Position:  [4.94077445]


portfolio before change:  [4.51135534]
curr_Stock_Price:  100.20570409355437
curr_Factors:  [1.00205704e+02 3.36507434e-02]
mat_Sqrt:  [[ 1.83818736e+01  0.00000000e+00]
 [-7.33765558e-03  1.68126811e-02]]
grads:  [-0.01075364 -7.69752053]
Stock Position:  -0.010753642132708989
Bond Position:  [5.58893162]


portfolio before change:  [4.51978808]
curr_Stock_Price:  99.55147652163404
curr_Factors:  [9.95514765e+01 3.37221199e-02]
mat_Sqrt:  [[ 1.82812185e+01  0.00000000e+00]
 [-7.34543340e-03  1.68305023e-02]]
grads:  [-2.01814062e-02 -2.51491146e+01]
Stock Position:  -0.02018140617523122
Bond Position:  [6.52887686]


portfolio before change:  [4.48157004]
curr_Stock_Price:  101.52608922739594
curr_Factors:  [1.01526089e+02 3.41769895e-02]
mat_Sqrt:  [[ 1.87691481e+01  0.00000000e+00]
 [-7.39480786e-03  1.69436334e-02]]
grads:  [ 4.28794547e-03 -1.25369071e+01]
Stock Position:  0.004287945466923226
Bond Position:  [4.04623171]


portfolio before change:  [4.48190015]
curr_Stock_Price:  101.36713694081077
curr_Factors:  [1.01367137e+02 3.49091254e-02]
mat_Sqrt:  [[ 1.89394195e+01  0.00000000e+00]
 [-7.47359355e-03  1.71241541e-02]]
grads:  [ 0.00455756 -2.88880329]
Stock Position:  0.004557560159732972
Bond Position:  [4.01991332]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.49495177]
Stock Price:  104.01033166522186
PL:  [0.4846201]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 5.82727507e-03  1.62932334e-02]
 [-2.84104069e-01  2.08035868e-01]
 [ 8.11572163e-01 -3.11708606e-01]
 [ 3.84693991e-01 -6.08173436e-02]
 [ 3.70243184e-02 -1.73126407e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-3.45427591e-01 -1.40748630e-01]
 [-1.39461140e+00  7.48845971e-01]
 [ 5.30828543e-02 -7.58303195e-02]
 [ 1.34196368e-01  4.12127052e-01]
 [-3.36717121e-01 -4.78613056e-02]
 [-1.05130067e-03 -9.40592982e-03]
 [ 6.51548406e-02 -2.84505414e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.17164660e-01 -6.24013952e-02]
 [-1.04867886e-01 -1.08993199e-01]
 [-1.39645062e-01 -6.09668489e-01]
 [-4.01462670e-01  6.82866568e-02]
 [ 6.10390319e-02 -8.32388354e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.10777078]
curr_Stock_Price:  102.03089054512657
curr_Factors:  [1.02030891e+02 3.71909892e-02]
mat_Sqrt:  [[ 1.96766220e+01  0.00000000e+00]
 [-7.71398617e-03  1.76749628e-02]]
grads:  [6.57543004e-04 9.21825615e-01]
Stock Position:  0.0006575430041989782
Bond Position:  [16.04068108]


portfolio before change:  [16.11263362]
curr_Stock_Price:  103.32688558995834
curr_Factors:  [1.03326886e+02 3.95144841e-02]
mat_Sqrt:  [[ 2.05395771e+01  0.00000000e+00]
 [-7.95130018e-03  1.82187175e-02]]
grads:  [-9.41157512e-03  1.14187987e+01]
Stock Position:  -0.009411575122375717
Bond Position:  [17.08510237]


portfolio before change:  [16.12674604]
curr_Stock_Price:  102.28129982336183
curr_Factors:  [1.02281300e+02 3.93643294e-02]
mat_Sqrt:  [[ 2.02930660e+01  0.00000000e+00]
 [-7.93617837e-03  1.81840691e-02]]
grads:  [  0.03328878 -17.1418512 ]
Stock Position:  0.0332887782805914
Bond Position:  [12.72192653]


portfolio before change:  [16.17264663]
curr_Stock_Price:  103.56460645582509
curr_Factors:  [1.03564606e+02 3.92697160e-02]
mat_Sqrt:  [[ 2.05229714e+01  0.00000000e+00]
 [-7.92663520e-03  1.81622029e-02]]
grads:  [ 0.01745123 -3.34856647]
Stock Position:  0.017451231584484955
Bond Position:  [14.3653167]


portfolio before change:  [16.13886839]
curr_Stock_Price:  101.42320914057466
curr_Factors:  [1.01423209e+02 3.98853127e-02]
mat_Sqrt:  [[ 2.02555411e+01  0.00000000e+00]
 [-7.98852304e-03  1.83040058e-02]]
grads:  [ 0.00145483 -0.9458389 ]
Stock Position:  0.0014548346274511383
Bond Position:  [15.99131439]


portfolio before change:  [16.14476349]
curr_Stock_Price:  102.72698060233178
curr_Factors:  [1.02726981e+02 3.65052846e-02]
mat_Sqrt:  [[ 1.96273828e+01  0.00000000e+00]
 [-7.64254247e-03  1.75112647e-02]]
grads:  [-2.95313014e-05 -1.10507016e+00]
Stock Position:  -2.953130138768451e-05
Bond Position:  [16.14779715]


portfolio before change:  [16.1487658]
curr_Stock_Price:  103.91699166732278
curr_Factors:  [1.03916992e+02 3.41985607e-02]
mat_Sqrt:  [[ 1.92172164e+01  0.00000000e+00]
 [-7.39714114e-03  1.69489796e-02]]
grads:  [-0.0211714 -8.3042539]
Stock Position:  -0.02117139764294676
Bond Position:  [18.34883375]


portfolio before change:  [16.17758842]
curr_Stock_Price:  102.77229445807531
curr_Factors:  [1.02772294e+02 3.18544753e-02]
mat_Sqrt:  [[ 1.83426163e+01  0.00000000e+00]
 [-7.13912884e-03  1.63577991e-02]]
grads:  [-0.05821352 45.77913965]
Stock Position:  -0.05821351810763427
Bond Position:  [22.16032525]


portfolio before change:  [16.18537105]
curr_Stock_Price:  102.73378366977362
curr_Factors:  [1.02733784e+02 3.14804650e-02]
mat_Sqrt:  [[ 1.82277831e+01  0.00000000e+00]
 [-7.09709406e-03  1.62614854e-02]]
grads:  [ 1.09655626e-03 -4.66318530e+00]
Stock Position:  0.001096556256809894
Bond Position:  [16.07271767]


portfolio before change:  [16.1907788]
curr_Stock_Price:  104.00054299282947
curr_Factors:  [1.04000543e+02 2.97462558e-02]
mat_Sqrt:  [[ 1.79370806e+01  0.00000000e+00]
 [-6.89884115e-03  1.58072309e-02]]
grads:  [1.75091680e-02 2.60720587e+01]
Stock Position:  0.017509168047611327
Bond Position:  [14.36981582]


portfolio before change:  [16.1955845]
curr_Stock_Price:  104.06980940958654
curr_Factors:  [1.04069809e+02 2.84545061e-02]
mat_Sqrt:  [[ 1.75549778e+01  0.00000000e+00]
 [-6.74738540e-03  1.54602022e-02]]
grads:  [-0.0203706  -3.09577488]
Stock Position:  -0.02037060433152881
Bond Position:  [18.31554941]


portfolio before change:  [16.21797585]
curr_Stock_Price:  103.19541754172941
curr_Factors:  [1.03195418e+02 3.01594293e-02]
mat_Sqrt:  [[ 1.79214016e+01  0.00000000e+00]
 [-6.94658815e-03  1.59166330e-02]]
grads:  [-2.87722194e-04 -5.90949720e-01]
Stock Position:  -0.0002877221940658336
Bond Position:  [16.24766746]


portfolio before change:  [16.22228794]
curr_Stock_Price:  102.32767943885572
curr_Factors:  [1.02327679e+02 2.99695633e-02]
mat_Sqrt:  [[ 1.77146809e+01  0.00000000e+00]
 [-6.92468781e-03  1.58664530e-02]]
grads:  [ 0.00297708 -1.79312549]
Stock Position:  0.002977079115184283
Bond Position:  [15.91765035]


portfolio before change:  [16.22671481]
curr_Stock_Price:  102.47781310579914
curr_Factors:  [1.02477813e+02 3.07515086e-02]
mat_Sqrt:  [[ 1.79706200e+01  0.00000000e+00]
 [-7.01444322e-03  1.60721085e-02]]
grads:  [8.47144625e-03 9.24446779e+00]
Stock Position:  0.008471446252826179
Bond Position:  [15.35857953]


portfolio before change:  [16.22506791]
curr_Stock_Price:  101.83010469043094
curr_Factors:  [1.01830105e+02 2.92781342e-02]
mat_Sqrt:  [[ 1.74240010e+01  0.00000000e+00]
 [-6.84434180e-03  1.56823572e-02]]
grads:  [-0.00828735 -3.97908264]
Stock Position:  -0.008287353816551166
Bond Position:  [17.06897002]


portfolio before change:  [16.21277636]
curr_Stock_Price:  103.82824822721848
curr_Factors:  [1.03828248e+02 2.74919272e-02]
mat_Sqrt:  [[ 1.72154397e+01  0.00000000e+00]
 [-6.63227589e-03  1.51964531e-02]]
grads:  [-0.00885463 -7.17227879]
Stock Position:  -0.008854634005072243
Bond Position:  [17.1321375]


portfolio before change:  [16.20165954]
curr_Stock_Price:  105.56749556480955
curr_Factors:  [1.05567496e+02 2.43390117e-02]
mat_Sqrt:  [[ 1.64695483e+01  0.00000000e+00]
 [-6.24038611e-03  1.42985208e-02]]
grads:  [-2.46349321e-02 -4.26385705e+01]
Stock Position:  -0.024634932096595955
Bond Position:  [18.80230762]


portfolio before change:  [16.17998843]
curr_Stock_Price:  106.63801902674885
curr_Factors:  [1.06638019e+02 2.16573919e-02]
mat_Sqrt:  [[ 1.56933314e+01  0.00000000e+00]
 [-5.88658024e-03  1.34878498e-02]]
grads:  [-0.02368267  5.06282751]
Stock Position:  -0.023682666236091023
Bond Position:  [18.70546104]


portfolio before change:  [16.16302092]
curr_Stock_Price:  107.55195561429193
curr_Factors:  [1.07551956e+02 2.04903151e-02]
mat_Sqrt:  [[ 1.53954586e+01  0.00000000e+00]
 [-5.72577542e-03  1.31193996e-02]]
grads:  [ 1.60505942e-03 -6.34471376e+00]
Stock Position:  0.0016050594225585724
Bond Position:  [15.99039364]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.16570439]
Stock Price:  106.73290204042598
PL:  [9.43280235]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.84409568e-02  4.52641077e-02]
 [ 2.25768831e-02  1.93692477e-02]
 [ 7.72707628e-01 -2.99847006e-01]
 [ 3.55350936e-01 -6.99682211e-02]
 [ 1.89838457e-01 -2.87639940e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-3.09664197e-01 -1.51020077e-01]
 [-1.45263433e+00  7.53939948e-01]
 [ 3.80131851e-02 -7.60342868e-02]
 [ 1.53114521e-01  5.79858439e-01]
 [-5.24128750e-01 -1.15687750e-01]
 [-2.45901170e-02 -1.11338640e-02]
 [ 1.95921154e-03 -6.31825352e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.16482026e-01 -6.20139637e-02]
 [-8.28563849e-02 -9.96656098e-02]
 [-1.27655721e-01 -6.51224548e-01]
 [-4.07119210e-01  8.98271644e-02]
 [-5.75095247e-02 -8.72174112e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.54817075]
curr_Stock_Price:  100.59098355829445
curr_Factors:  [1.00590984e+02 3.96834132e-02]
mat_Sqrt:  [[ 2.00384241e+01  0.00000000e+00]
 [-7.96827843e-03  1.82576195e-02]]
grads:  [1.90612958e-03 2.47919000e+00]
Stock Position:  0.0019061295796912172
Bond Position:  [6.35643131]


portfolio before change:  [6.55173144]
curr_Stock_Price:  101.62521713069599
curr_Factors:  [1.01625217e+02 3.81445960e-02]
mat_Sqrt:  [[ 1.98480569e+01  0.00000000e+00]
 [-7.81225663e-03  1.79001287e-02]]
grads:  [0.00156339 1.0820731 ]
Stock Position:  0.0015633931321565578
Bond Position:  [6.39285128]


portfolio before change:  [6.554156]
curr_Stock_Price:  102.15364339406831
curr_Factors:  [1.02153643e+02 3.51723466e-02]
mat_Sqrt:  [[ 1.91581925e+01  0.00000000e+00]
 [-7.50171678e-03  1.71885925e-02]]
grads:  [  0.03350231 -17.44453515]
Stock Position:  0.0335023079605171
Bond Position:  [3.13177317]


portfolio before change:  [6.58939649]
curr_Stock_Price:  103.18215330322144
curr_Factors:  [1.03182153e+02 3.57211923e-02]
mat_Sqrt:  [[ 1.95014795e+01  0.00000000e+00]
 [-7.56002035e-03  1.73221828e-02]]
grads:  [ 0.01665588 -4.03922658]
Stock Position:  0.016655879963129613
Bond Position:  [4.87080693]


portfolio before change:  [6.59076237]
curr_Stock_Price:  103.19104047097244
curr_Factors:  [1.03191040e+02 3.56672915e-02]
mat_Sqrt:  [[ 1.94884391e+01  0.00000000e+00]
 [-7.55431442e-03  1.73091088e-02]]
grads:  [ 0.00909692 -1.66178364]
Stock Position:  0.009096922541666172
Bond Position:  [5.65204147]


portfolio before change:  [6.59977708]
curr_Stock_Price:  104.02665567298244
curr_Factors:  [1.04026656e+02 3.59605918e-02]
mat_Sqrt:  [[ 1.97268641e+01  0.00000000e+00]
 [-7.58531126e-03  1.73801315e-02]]
grads:  [-2.93823770e-05 -1.11340792e+00]
Stock Position:  -2.9382376981496815e-05
Bond Position:  [6.60283363]


portfolio before change:  [6.60144116]
curr_Stock_Price:  103.57873806526098
curr_Factors:  [1.03578738e+02 3.57358746e-02]
mat_Sqrt:  [[ 1.95804570e+01  0.00000000e+00]
 [-7.56157387e-03  1.73257423e-02]]
grads:  [-0.0191811  -8.71651407]
Stock Position:  -0.019181102981560474
Bond Position:  [8.5881956]


portfolio before change:  [6.58858795]
curr_Stock_Price:  104.36078516731011
curr_Factors:  [1.04360785e+02 3.39370040e-02]
mat_Sqrt:  [[ 1.92253426e+01  0.00000000e+00]
 [-7.36879952e-03  1.68840408e-02]]
grads:  [-0.05844307 44.65399944]
Stock Position:  -0.05844306585129986
Bond Position:  [12.68775219]


portfolio before change:  [6.61205165]
curr_Stock_Price:  104.01358633502026
curr_Factors:  [1.04013586e+02 3.49737215e-02]
mat_Sqrt:  [[ 1.94518537e+01  0.00000000e+00]
 [-7.48050496e-03  1.71399901e-02]]
grads:  [ 2.48259211e-04 -4.43607530e+00]
Stock Position:  0.0002482592106340167
Bond Position:  [6.58622932]


portfolio before change:  [6.61404612]
curr_Stock_Price:  105.41418570324123
curr_Factors:  [1.05414186e+02 3.41229522e-02]
mat_Sqrt:  [[ 1.94725289e+01  0.00000000e+00]
 [-7.38895957e-03  1.69302333e-02]]
grads:  [2.08594114e-02 3.42498789e+01]
Stock Position:  0.020859411394479076
Bond Position:  [4.41516826]


portfolio before change:  [6.63731934]
curr_Stock_Price:  106.47698087054059
curr_Factors:  [1.06476981e+02 3.16157512e-02]
mat_Sqrt:  [[ 1.89324789e+01  0.00000000e+00]
 [-7.11232746e-03  1.62963895e-02]]
grads:  [-0.03035097 -7.09898043]
Stock Position:  -0.030350966053605266
Bond Position:  [9.86899857]


portfolio before change:  [6.70086703]
curr_Stock_Price:  104.46451977790787
curr_Factors:  [1.04464520e+02 3.23425452e-02]
mat_Sqrt:  [[ 1.87869340e+01  0.00000000e+00]
 [-7.19361330e-03  1.64826387e-02]]
grads:  [-0.00156754 -0.67549039]
Stock Position:  -0.001567543364244731
Bond Position:  [6.8646197]


portfolio before change:  [6.70199572]
curr_Stock_Price:  104.83942354048419
curr_Factors:  [1.04839424e+02 3.26313395e-02]
mat_Sqrt:  [[ 1.89383472e+01  0.00000000e+00]
 [-7.22565867e-03  1.65560639e-02]]
grads:  [-1.35259467e-03 -3.81627756e+00]
Stock Position:  -0.0013525946695624564
Bond Position:  [6.84380097]


portfolio before change:  [6.70510084]
curr_Stock_Price:  103.80884543561392
curr_Factors:  [1.03808845e+02 3.12130402e-02]
mat_Sqrt:  [[ 1.83401294e+01  0.00000000e+00]
 [-7.06688505e-03  1.61922678e-02]]
grads:  [8.30076703e-03 9.17586659e+00]
Stock Position:  0.008300767029147137
Bond Position:  [5.8434078]


portfolio before change:  [6.70101138]
curr_Stock_Price:  103.14017262130284
curr_Factors:  [1.03140173e+02 3.06264720e-02]
mat_Sqrt:  [[ 1.80499640e+01  0.00000000e+00]
 [-7.00016822e-03  1.60394004e-02]]
grads:  [-0.00795277 -3.86635175]
Stock Position:  -0.00795276592262668
Bond Position:  [7.52126103]


portfolio before change:  [6.69063233]
curr_Stock_Price:  104.68172466229983
curr_Factors:  [1.04681725e+02 3.00658003e-02]
mat_Sqrt:  [[ 1.81512799e+01  0.00000000e+00]
 [-6.93579703e-03  1.58919075e-02]]
grads:  [-0.00696116 -6.27146931]
Stock Position:  -0.006961163286460626
Bond Position:  [7.41933891]


portfolio before change:  [6.67245381]
curr_Stock_Price:  107.55963282397147
curr_Factors:  [1.07559633e+02 2.87433509e-02]
mat_Sqrt:  [[ 1.82355140e+01  0.00000000e+00]
 [-6.78154565e-03  1.55384731e-02]]
grads:  [-2.25863343e-02 -4.19104594e+01]
Stock Position:  -0.0225863342614512
Bond Position:  [9.10183163]


portfolio before change:  [6.62611865]
curr_Stock_Price:  109.71185875492685
curr_Factors:  [1.09711859e+02 2.91365104e-02]
mat_Sqrt:  [[ 1.87271781e+01  0.00000000e+00]
 [-6.82776805e-03  1.56443820e-02]]
grads:  [-0.01964607  5.74181611]
Stock Position:  -0.019646068351613647
Bond Position:  [8.78152533]


portfolio before change:  [6.61899211]
curr_Stock_Price:  110.18636585170097
curr_Factors:  [1.10186366e+02 3.09103837e-02]
mat_Sqrt:  [[ 1.93722497e+01  0.00000000e+00]
 [-7.03253965e-03  1.61135726e-02]]
grads:  [-4.93356864e-03 -5.41266751e+00]
Stock Position:  -0.004933568644796313
Bond Position:  [7.16260411]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.61337036]
Stock Price:  111.68885231861357
PL:  [-5.07548195]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.08683855e-02  1.23950956e-01]
 [ 5.48745259e-02 -3.82023386e-02]
 [ 6.26786325e-01 -2.55311284e-01]
 [ 9.50407834e-02 -1.11106633e-01]
 [ 8.47803971e-02 -2.14883001e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-2.27745253e-01 -1.74978233e-01]
 [-1.41504541e+00  7.50330952e-01]
 [ 3.00124958e-02 -8.01681445e-02]
 [ 1.53841907e-01  5.86290535e-01]
 [-4.08393357e-01 -7.36084339e-02]
 [-4.10182641e-02 -1.17012725e-01]
 [-8.78454609e-02 -1.26962860e-01]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.13190316e-01 -6.01457422e-02]
 [ 8.15880064e-02  5.93350216e-03]
 [-1.24306689e-01 -6.89081240e-01]
 [-4.12866220e-01  6.89477959e-02]
 [ 2.24067560e-02 -8.04102582e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.77757391]
curr_Stock_Price:  99.03567665755429
curr_Factors:  [9.90356767e+01 3.97082576e-02]
mat_Sqrt:  [[ 1.97347709e+01  0.00000000e+00]
 [-7.97077237e-03  1.82633339e-02]]
grads:  [3.79862620e-03 6.78687456e+00]
Stock Position:  0.003798626202063231
Bond Position:  [-4.15377343]


portfolio before change:  [-3.77642337]
curr_Stock_Price:  99.61196844643953
curr_Factors:  [9.96119684e+01 3.91714712e-02]
mat_Sqrt:  [[ 1.97149856e+01  0.00000000e+00]
 [-7.91671358e-03  1.81394696e-02]]
grads:  [ 1.93769649e-03 -2.10603394e+00]
Stock Position:  0.001937696492631911
Bond Position:  [-3.96944113]


portfolio before change:  [-3.77816731]
curr_Stock_Price:  99.22415561107198
curr_Factors:  [9.92241556e+01 3.84976453e-02]
mat_Sqrt:  [[ 1.94685898e+01  0.00000000e+00]
 [-7.84832673e-03  1.79827757e-02]]
grads:  [  0.02647132 -14.19754599]
Stock Position:  0.026471323846384284
Bond Position:  [-6.40476207]


portfolio before change:  [-3.74939894]
curr_Stock_Price:  100.37142611903595
curr_Factors:  [1.00371426e+02 3.84860173e-02]
mat_Sqrt:  [[ 1.96907192e+01  0.00000000e+00]
 [-7.84714137e-03  1.79800597e-02]]
grads:  [ 2.36405144e-03 -6.17943630e+00]
Stock Position:  0.0023640514369863163
Bond Position:  [-3.98668215]


portfolio before change:  [-3.74679443]
curr_Stock_Price:  101.89478689814702
curr_Factors:  [1.01894787e+02 3.72719002e-02]
mat_Sqrt:  [[ 1.96717381e+01  0.00000000e+00]
 [-7.72237271e-03  1.76941788e-02]]
grads:  [ 0.00383302 -1.21442766]
Stock Position:  0.003833018408471031
Bond Position:  [-4.13735902]


portfolio before change:  [-3.74315521]
curr_Stock_Price:  103.11410852711086
curr_Factors:  [1.03114109e+02 3.71331331e-02]
mat_Sqrt:  [[ 1.98700467e+01  0.00000000e+00]
 [-7.70798372e-03  1.76612094e-02]]
grads:  [-2.91706489e-05 -1.09568805e+00]
Stock Position:  -2.9170648881355525e-05
Bond Position:  [-3.74014731]


portfolio before change:  [-3.7440813]
curr_Stock_Price:  102.803143880704
curr_Factors:  [1.02803144e+02 3.78335325e-02]
mat_Sqrt:  [[ 1.99960789e+01  0.00000000e+00]
 [-7.78033752e-03  1.78269928e-02]]
grads:  [-0.01520858 -9.8153533 ]
Stock Position:  -0.015208582402377773
Bond Position:  [-2.18059121]


portfolio before change:  [-3.75360472]
curr_Stock_Price:  103.39348211606296
curr_Factors:  [1.03393482e+02 3.54793190e-02]
mat_Sqrt:  [[ 1.94751495e+01  0.00000000e+00]
 [-7.53438188e-03  1.72634376e-02]]
grads:  [-0.0558442  43.46358864]
Stock Position:  -0.05584419958683314
Bond Position:  [2.02032153]


portfolio before change:  [-3.83847212]
curr_Stock_Price:  104.92224502710926
curr_Factors:  [1.04922245e+02 3.59995262e-02]
mat_Sqrt:  [[ 1.99074653e+01  0.00000000e+00]
 [-7.58941644e-03  1.73895377e-02]]
grads:  [-2.49943969e-04 -4.61013663e+00]
Stock Position:  -0.000249943969427082
Bond Position:  [-3.81224744]


portfolio before change:  [-3.83956198]
curr_Stock_Price:  105.46910827150299
curr_Factors:  [1.05469108e+02 3.35305103e-02]
mat_Sqrt:  [[ 1.93128050e+01  0.00000000e+00]
 [-7.32453524e-03  1.67826186e-02]]
grads:  [2.12149439e-02 3.49343895e+01]
Stock Position:  0.021214943881067722
Bond Position:  [-6.0770832]


portfolio before change:  [-3.85122157]
curr_Stock_Price:  104.9911374702379
curr_Factors:  [1.04991137e+02 3.32544456e-02]
mat_Sqrt:  [[ 1.91459754e+01  0.00000000e+00]
 [-7.29432059e-03  1.67133881e-02]]
grads:  [-0.02300842 -4.40415991]
Stock Position:  -0.0230084235690735
Bond Position:  [-1.43554101]


portfolio before change:  [-3.93551462]
curr_Stock_Price:  108.63911083868146
curr_Factors:  [1.08639111e+02 3.06230004e-02]
mat_Sqrt:  [[ 1.90112237e+01  0.00000000e+00]
 [-6.99977147e-03  1.60384913e-02]]
grads:  [-4.84381256e-03 -7.29574392e+00]
Stock Position:  -0.004843812563024278
Bond Position:  [-3.40928713]


portfolio before change:  [-3.94046095]
curr_Stock_Price:  109.4842926121911
curr_Factors:  [1.09484293e+02 2.94017655e-02]
mat_Sqrt:  [[ 1.87732093e+01  0.00000000e+00]
 [-6.85877721e-03  1.57154329e-02]]
grads:  [-7.63090601e-03 -8.07886493e+00]
Stock Position:  -0.007630906014198834
Bond Position:  [-3.1049966]


portfolio before change:  [-3.93964768]
curr_Stock_Price:  109.27598014998993
curr_Factors:  [1.0927598e+02 2.9548863e-02]
mat_Sqrt:  [[ 1.87843035e+01  0.00000000e+00]
 [-6.87591308e-03  1.57546961e-02]]
grads:  [8.10448689e-03 9.43071758e+00]
Stock Position:  0.008104486889332475
Bond Position:  [-4.82527343]


portfolio before change:  [-3.92872101]
curr_Stock_Price:  110.77306966812846
curr_Factors:  [1.10773070e+02 3.07097307e-02]
mat_Sqrt:  [[ 1.94120855e+01  0.00000000e+00]
 [-7.00967683e-03  1.60611873e-02]]
grads:  [-0.00718316 -3.74478804]
Stock Position:  -0.007183157637460652
Bond Position:  [-3.13302058]


portfolio before change:  [-3.9200164]
curr_Stock_Price:  109.45220733606658
curr_Factors:  [1.09452207e+02 3.23243085e-02]
mat_Sqrt:  [[ 1.96783711e+01  0.00000000e+00]
 [-7.19158491e-03  1.64779911e-02]]
grads:  [0.00427767 0.3600865 ]
Stock Position:  0.004277671092558326
Bond Position:  [-4.38821694]


portfolio before change:  [-3.92164415]
curr_Stock_Price:  109.32817743862358
curr_Factors:  [1.09328177e+02 3.35980153e-02]
mat_Sqrt:  [[ 2.00395941e+01  0.00000000e+00]
 [-7.33190456e-03  1.67995038e-02]]
grads:  [-2.12103297e-02 -4.10179519e+01]
Stock Position:  -0.021210329742403083
Bond Position:  [-1.60275745]


portfolio before change:  [-3.90776107]
curr_Stock_Price:  108.6547407641914
curr_Factors:  [1.08654741e+02 3.49111040e-02]
mat_Sqrt:  [[ 2.03016096e+01  0.00000000e+00]
 [-7.47380535e-03  1.71246394e-02]]
grads:  [-0.01885441  4.02623345]
Stock Position:  -0.01885441316904166
Bond Position:  [-1.8591397]


portfolio before change:  [-3.90223894]
curr_Stock_Price:  108.33720365812496
curr_Factors:  [1.08337204e+02 3.79199970e-02]
mat_Sqrt:  [[ 2.10965660e+01  0.00000000e+00]
 [-7.78922301e-03  1.78473520e-02]]
grads:  [-6.01384974e-04 -4.50544473e+00]
Stock Position:  -0.0006013849736201659
Bond Position:  [-3.83708657]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.90152723]
Stock Price:  105.55844777169744
PL:  [-9.459975]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.05894596e-02  1.22965451e-01]
 [ 4.51077766e-02 -5.28789654e-02]
 [ 6.18960961e-01 -2.52922954e-01]
 [-9.25349671e-02 -9.27018583e-02]
 [ 2.20907827e-02 -1.59292822e-02]
 [ 3.89776904e-02 -3.40386100e-02]
 [-5.62947895e-02 -1.18216179e-01]
 [-1.26489608e+00  7.36021682e-01]
 [ 8.46875342e-02 -7.46292654e-02]
 [ 1.33279094e-02 -9.73329914e-02]
 [ 7.01157087e-02  2.92126140e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.55023463e-01 -3.02946143e-02]
 [-7.51026345e-02 -1.01810926e-01]
 [ 5.06200696e-02  3.86282690e-02]
 [-1.43497236e-01 -1.39775094e-01]
 [-1.91421701e-01 -3.76695082e-01]
 [ 2.59934868e-01 -2.28349132e-01]
 [ 1.89605525e-02 -1.20116192e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.17928626]
curr_Stock_Price:  100.08354806902382
curr_Factors:  [1.00083548e+02 3.99218522e-02]
mat_Sqrt:  [[ 1.99971468e+01  0.00000000e+00]
 [-7.99218139e-03  1.83123881e-02]]
grads:  [4.21340019e-03 6.71487793e+00]
Stock Position:  0.004213400192491031
Bond Position:  [2.75759422]


portfolio before change:  [3.17306405]
curr_Stock_Price:  98.44313936667055
curr_Factors:  [9.84431394e+01 4.17585741e-02]
mat_Sqrt:  [[ 2.01167716e+01  0.00000000e+00]
 [-8.17396591e-03  1.87289087e-02]]
grads:  [ 1.09508148e-03 -2.82338743e+00]
Stock Position:  0.0010950814802151755
Bond Position:  [3.06526079]


portfolio before change:  [3.17415045]
curr_Stock_Price:  98.73534344070691
curr_Factors:  [9.87353434e+01 4.15586170e-02]
mat_Sqrt:  [[ 2.01281187e+01  0.00000000e+00]
 [-8.15437228e-03  1.86840141e-02]]
grads:  [  0.02526696 -13.5368638 ]
Stock Position:  0.02526695822701857
Bond Position:  [0.67940865]


portfolio before change:  [3.18156587]
curr_Stock_Price:  99.02210315167905
curr_Factors:  [9.90221032e+01 4.04025761e-02]
mat_Sqrt:  [[ 1.99038310e+01  0.00000000e+00]
 [-8.04015682e-03  1.84223136e-02]]
grads:  [-0.0066818  -5.03204213]
Stock Position:  -0.006681797852096673
Bond Position:  [3.84321154]


portfolio before change:  [3.16739512]
curr_Stock_Price:  101.2867133482233
curr_Factors:  [1.01286713e+02 3.93578986e-02]
mat_Sqrt:  [[ 2.00940940e+01  0.00000000e+00]
 [-7.93553008e-03  1.81825836e-02]]
grads:  [ 7.53389229e-04 -8.76073637e-01]
Stock Position:  0.0007533892288782737
Bond Position:  [3.0910868]


portfolio before change:  [3.16748067]
curr_Stock_Price:  100.37440949471956
curr_Factors:  [1.00374409e+02 3.93545598e-02]
mat_Sqrt:  [[ 1.99122590e+01  0.00000000e+00]
 [-7.93519349e-03  1.81818124e-02]]
grads:  [ 1.21141569e-03 -1.87212414e+00]
Stock Position:  0.001211415694124703
Bond Position:  [3.04588554]


portfolio before change:  [3.16688915]
curr_Stock_Price:  99.25746538864148
curr_Factors:  [9.92574654e+01 4.03567610e-02]
mat_Sqrt:  [[ 1.99398245e+01  0.00000000e+00]
 [-8.03559691e-03  1.84118655e-02]]
grads:  [-5.41070759e-03 -6.42065190e+00]
Stock Position:  -0.00541070758957303
Bond Position:  [3.70394228]


portfolio before change:  [3.16645855]
curr_Stock_Price:  99.50821041587342
curr_Factors:  [9.95082104e+01 4.06397261e-02]
mat_Sqrt:  [[ 2.00601558e+01  0.00000000e+00]
 [-8.06371885e-03  1.84763010e-02]]
grads:  [-0.047042   39.83598672]
Stock Position:  -0.047042001776049266
Bond Position:  [7.84752396]


portfolio before change:  [3.13504902]
curr_Stock_Price:  100.21761170413397
curr_Factors:  [1.00217612e+02 4.15298531e-02]
mat_Sqrt:  [[ 2.04232214e+01  0.00000000e+00]
 [-8.15154985e-03  1.86775471e-02]]
grads:  [ 2.55183310e-03 -3.99566736e+00]
Stock Position:  0.002551833104878053
Bond Position:  [2.8793104]


portfolio before change:  [3.13145159]
curr_Stock_Price:  98.52575298715206
curr_Factors:  [9.85257530e+01 4.20165823e-02]
mat_Sqrt:  [[ 2.01957564e+01  0.00000000e+00]
 [-8.19917872e-03  1.87866786e-02]]
grads:  [-1.44345624e-03 -5.18095794e+00]
Stock Position:  -0.0014434562383790655
Bond Position:  [3.27366921]


portfolio before change:  [3.13374543]
curr_Stock_Price:  97.5036840254014
curr_Factors:  [9.75036840e+01 4.34361377e-02]
mat_Sqrt:  [[ 2.03210725e+01  0.00000000e+00]
 [-8.33653527e-03  1.91014019e-02]]
grads:  [9.72438874e-03 1.52934398e+01]
Stock Position:  0.009724388740401262
Bond Position:  [2.1855817]


portfolio before change:  [3.13563052]
curr_Stock_Price:  97.64134079855468
curr_Factors:  [9.76413408e+01 4.47396916e-02]
mat_Sqrt:  [[ 2.06528612e+01  0.00000000e+00]
 [-8.46070366e-03  1.93859075e-02]]
grads:  [ 0.00232493 -0.44317672]
Stock Position:  0.0023249310454117626
Bond Position:  [2.90862113]


portfolio before change:  [3.13504281]
curr_Stock_Price:  97.0757521493621
curr_Factors:  [9.70757521e+01 4.51078621e-02]
mat_Sqrt:  [[ 2.06175419e+01  0.00000000e+00]
 [-8.49544462e-03  1.94655090e-02]]
grads:  [ 0.00687773 -1.55632274]
Stock Position:  0.006877726238303772
Bond Position:  [2.46738236]


portfolio before change:  [3.12626118]
curr_Stock_Price:  95.70923254911611
curr_Factors:  [9.57092325e+01 4.62724676e-02]
mat_Sqrt:  [[ 2.05880476e+01  0.00000000e+00]
 [-8.60441446e-03  1.97151903e-02]]
grads:  [-0.00580611 -5.16408537]
Stock Position:  -0.005806114673187036
Bond Position:  [3.68195996]


portfolio before change:  [3.12009556]
curr_Stock_Price:  96.92970923666051
curr_Factors:  [9.69297092e+01 4.53063881e-02]
mat_Sqrt:  [[ 2.06317768e+01  0.00000000e+00]
 [-8.51411891e-03  1.95082972e-02]]
grads:  [0.00327063 1.98009435]
Stock Position:  0.0032706261343384787
Bond Position:  [2.80307472]


portfolio before change:  [3.12363594]
curr_Stock_Price:  97.79789932721445
curr_Factors:  [9.77978993e+01 4.59685916e-02]
mat_Sqrt:  [[ 2.09681505e+01  0.00000000e+00]
 [-8.57611489e-03  1.96503478e-02]]
grads:  [-0.00975289 -7.11311045]
Stock Position:  -0.00975289109023163
Bond Position:  [4.0774482]


portfolio before change:  [3.12107948]
curr_Stock_Price:  98.16455526546763
curr_Factors:  [9.81645553e+01 4.53638362e-02]
mat_Sqrt:  [[ 2.09078603e+01  0.00000000e+00]
 [-8.51951513e-03  1.95206615e-02]]
grads:  [-1.70187149e-02 -1.92972499e+01]
Stock Position:  -0.01701871485664405
Bond Position:  [4.79171405]


portfolio before change:  [3.07846174]
curr_Stock_Price:  100.73912185272005
curr_Factors:  [1.00739122e+02 4.75370050e-02]
mat_Sqrt:  [[ 2.19641332e+01  0.00000000e+00]
 [-8.72119304e-03  1.99827636e-02]]
grads:  [ 7.29713004e-03 -1.14273049e+01]
Stock Position:  0.007297130040983191
Bond Position:  [2.34335527]


portfolio before change:  [3.06742668]
curr_Stock_Price:  99.1465812025591
curr_Factors:  [9.91465812e+01 4.73224029e-02]
mat_Sqrt:  [[ 2.15680627e+01  0.00000000e+00]
 [-8.70148520e-03  1.99376073e-02]]
grads:  [-1.55148155e-03 -6.02460416e+00]
Stock Position:  -0.0015514815529016684
Bond Position:  [3.22125077]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.07092614]
Stock Price:  97.41014402499596
PL:  [3.07092614]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 4.25288437e-03  1.22945492e-01]
 [ 4.52938632e-02 -5.25993305e-02]
 [ 7.05351879e-01 -2.79289782e-01]
 [-9.37181690e-02 -9.25345166e-02]
 [ 2.00045055e-01 -5.82621054e-03]
 [ 3.85078958e-02 -3.66217863e-02]
 [-8.83581575e-02 -1.65501029e-01]
 [-1.30835229e+00  7.39967001e-01]
 [ 6.70151160e-02 -7.76453783e-02]
 [ 1.21613557e-01  3.27839509e-01]
 [-2.34561745e-01 -2.49540609e-02]
 [-3.85866881e-02 -1.21858192e-02]
 [ 3.14285130e-02 -4.22883279e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.16104014e-01 -6.17994218e-02]
 [-3.01982754e-02 -7.01121640e-02]
 [-1.36509615e-01 -6.15127866e-01]
 [-2.40912514e-01 -3.92972083e-02]
 [ 1.61352002e-01  6.00002476e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.04618346]
curr_Stock_Price:  99.762251191731
curr_Factors:  [9.97622512e+01 4.00711644e-02]
mat_Sqrt:  [[ 1.99701912e+01  0.00000000e+00]
 [-8.00711328e-03  1.83466013e-02]]
grads:  [2.89985688e-03 6.70126798e+00]
Stock Position:  0.0028998568791608276
Bond Position:  [0.75688721]


portfolio before change:  [1.04261329]
curr_Stock_Price:  98.46583809730794
curr_Factors:  [9.84658381e+01 4.16573401e-02]
mat_Sqrt:  [[ 2.00970054e+01  0.00000000e+00]
 [-8.16405195e-03  1.87061930e-02]]
grads:  [ 1.11149064e-03 -2.81186720e+00]
Stock Position:  0.0011114906351099528
Bond Position:  [0.93316943]


portfolio before change:  [1.04468022]
curr_Stock_Price:  100.11552462487936
curr_Factors:  [1.00115525e+02 4.13548875e-02]
mat_Sqrt:  [[ 2.03593941e+01  0.00000000e+00]
 [-8.13436045e-03  1.86381612e-02]]
grads:  [  0.02865802 -14.98483559]
Stock Position:  0.028658015154100727
Bond Position:  [-1.824432]


portfolio before change:  [1.01265719]
curr_Stock_Price:  99.01402245538452
curr_Factors:  [9.90140225e+01 3.98826791e-02]
mat_Sqrt:  [[ 1.97737421e+01  0.00000000e+00]
 [-7.98825930e-03  1.83034014e-02]]
grads:  [-0.0067819  -5.05559127]
Stock Position:  -0.006781900062874083
Bond Position:  [1.6841604]


portfolio before change:  [1.01263796]
curr_Stock_Price:  99.07894944142357
curr_Factors:  [9.90789494e+01 4.07424937e-02]
mat_Sqrt:  [[ 1.99988580e+01  0.00000000e+00]
 [-8.07390797e-03  1.84996472e-02]]
grads:  [ 0.00987568 -0.31493631]
Stock Position:  0.009875678295201246
Bond Position:  [0.03416613]


portfolio before change:  [1.02479142]
curr_Stock_Price:  100.30873096613247
curr_Factors:  [1.00308731e+02 4.30019844e-02]
mat_Sqrt:  [[ 2.08009411e+01  0.00000000e+00]
 [-8.29476793e-03  1.90057010e-02]]
grads:  [ 1.08287590e-03 -1.92688428e+00]
Stock Position:  0.0010828759025884355
Bond Position:  [0.91616952]


portfolio before change:  [1.0258547]
curr_Stock_Price:  101.07909234776561
curr_Factors:  [1.01079092e+02 4.17074211e-02]
mat_Sqrt:  [[ 2.06427713e+01  0.00000000e+00]
 [-8.16895793e-03  1.87174340e-02]]
grads:  [-7.77941709e-03 -8.84207891e+00]
Stock Position:  -0.007779417094088832
Bond Position:  [1.81219112]


portfolio before change:  [1.02947567]
curr_Stock_Price:  100.67188196491203
curr_Factors:  [1.00671882e+02 4.09810666e-02]
mat_Sqrt:  [[ 2.03797952e+01  0.00000000e+00]
 [-8.09751236e-03  1.85537317e-02]]
grads:  [-0.04835202 39.88238131]
Stock Position:  -0.048352017546268784
Bond Position:  [5.89716427]


portfolio before change:  [0.97876381]
curr_Stock_Price:  101.75118190382791
curr_Factors:  [1.01751182e+02 4.01547003e-02]
mat_Sqrt:  [[ 2.03895508e+01  0.00000000e+00]
 [-8.01545510e-03  1.83657149e-02]]
grads:  [ 1.62474863e-03 -4.22773515e+00]
Stock Position:  0.0016247486324643895
Bond Position:  [0.81344372]


portfolio before change:  [0.98131545]
curr_Stock_Price:  103.19648454547566
curr_Factors:  [1.03196485e+02 3.99738969e-02]
mat_Sqrt:  [[ 2.06325615e+01  0.00000000e+00]
 [-7.99738927e-03  1.83243208e-02]]
grads:  [1.28289670e-02 1.78909501e+01]
Stock Position:  0.012828966978456766
Bond Position:  [-0.34258884]


portfolio before change:  [0.97565907]
curr_Stock_Price:  102.76225416741987
curr_Factors:  [1.02762254e+02 4.09007193e-02]
mat_Sqrt:  [[ 2.07825625e+01  0.00000000e+00]
 [-8.08957050e-03  1.85355346e-02]]
grads:  [-0.01181051 -1.34628224]
Stock Position:  -0.011810506527046898
Bond Position:  [2.18933334]


portfolio before change:  [0.94752259]
curr_Stock_Price:  105.19092906335197
curr_Factors:  [1.05190929e+02 3.84524593e-02]
mat_Sqrt:  [[ 2.06272034e+01  0.00000000e+00]
 [-7.84371946e-03  1.79722191e-02]]
grads:  [-0.0021285  -0.67803643]
Stock Position:  -0.0021285006364230763
Bond Position:  [1.17142155]


portfolio before change:  [0.95177297]
curr_Stock_Price:  103.33164328089751
curr_Factors:  [1.03331643e+02 3.85146477e-02]
mat_Sqrt:  [[ 2.02789890e+01  0.00000000e+00]
 [-7.85005963e-03  1.79867462e-02]]
grads:  [ 6.39695281e-04 -2.35108270e+00]
Stock Position:  0.0006396952812332571
Bond Position:  [0.88567221]


portfolio before change:  [0.95190074]
curr_Stock_Price:  103.18521213408879
curr_Factors:  [1.03185212e+02 3.91104175e-02]
mat_Sqrt:  [[ 2.04062728e+01  0.00000000e+00]
 [-7.91054157e-03  1.81253278e-02]]
grads:  [7.46031103e-03 8.19726359e+00]
Stock Position:  0.0074603110323802815
Bond Position:  [0.18210697]


portfolio before change:  [0.95808003]
curr_Stock_Price:  104.00739653667898
curr_Factors:  [1.04007397e+02 3.70330062e-02]
mat_Sqrt:  [[ 2.00151436e+01  0.00000000e+00]
 [-7.69758468e-03  1.76373822e-02]]
grads:  [-0.00714836 -3.50388856]
Stock Position:  -0.007148362070329849
Bond Position:  [1.70156256]


portfolio before change:  [0.9413913]
curr_Stock_Price:  106.40153584929575
curr_Factors:  [1.06401536e+02 3.71169446e-02]
mat_Sqrt:  [[ 2.04990628e+01  0.00000000e+00]
 [-7.70630335e-03  1.76573592e-02]]
grads:  [-2.96587863e-03 -3.97070497e+00]
Stock Position:  -0.002965878630849274
Bond Position:  [1.25696534]


portfolio before change:  [0.94278116]
curr_Stock_Price:  106.03888337921859
curr_Factors:  [1.06038883e+02 3.82564157e-02]
mat_Sqrt:  [[ 2.07404075e+01  0.00000000e+00]
 [-7.82369894e-03  1.79263463e-02]]
grads:  [-1.95258182e-02 -3.43141796e+01]
Stock Position:  -0.019525818161928183
Bond Position:  [3.01327712]


portfolio before change:  [0.96477556]
curr_Stock_Price:  104.95104243302393
curr_Factors:  [1.04951042e+02 4.09558466e-02]
mat_Sqrt:  [[ 2.12395206e+01  0.00000000e+00]
 [-8.09502036e-03  1.85480218e-02]]
grads:  [-0.01215014 -2.11867383]
Stock Position:  -0.012150143397166727
Bond Position:  [2.23994577]


portfolio before change:  [0.97421695]
curr_Stock_Price:  104.2200770669421
curr_Factors:  [1.04220077e+02 4.08403562e-02]
mat_Sqrt:  [[ 2.10618323e+01  0.00000000e+00]
 [-8.08359882e-03  1.85218517e-02]]
grads:  [0.00890418 3.23943029]
Stock Position:  0.00890417577672338
Bond Position:  [0.04622306]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.96356757]
Stock Price:  103.02278079152765
PL:  [-2.05921322]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.58421982e-02  2.86082849e-02]
 [-6.57892178e-02  7.37350046e-02]
 [ 6.74852784e-01 -2.69981345e-01]
 [ 3.98406012e-01 -5.65411351e-02]
 [ 3.08927445e-01 -3.32656609e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-9.03361725e-01  2.92057052e-02]
 [-1.61745404e+00  5.72472175e-01]
 [-1.61093039e-01  1.11801038e-02]
 [ 2.31260734e-01  1.27252465e+00]
 [-1.09032953e+00 -3.20532812e-01]
 [-4.18834561e-02 -2.56269704e-01]
 [-1.57507784e-01 -1.80828470e-01]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.13888862e-01 -6.05422041e-02]
 [ 1.78266187e-01  1.05648636e-01]
 [ 1.77344172e-02 -7.78133969e-01]
 [-3.64037357e-01  2.34303750e-01]
 [-2.30637422e-01 -9.50214831e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.60812822]
curr_Stock_Price:  100.7506387901648
curr_Factors:  [1.00750639e+02 3.99674898e-02]
mat_Sqrt:  [[ 2.01419375e+01  0.00000000e+00]
 [-7.99674832e-03  1.83228522e-02]]
grads:  [1.40641273e-03 1.56134452e+00]
Stock Position:  0.0014064127285369906
Bond Position:  [7.46643124]


portfolio before change:  [7.61191243]
curr_Stock_Price:  102.11394240878846
curr_Factors:  [1.02113942e+02 3.97129935e-02]
mat_Sqrt:  [[ 2.03493882e+01  0.00000000e+00]
 [-7.97124768e-03  1.82644229e-02]]
grads:  [-1.65157907e-03  4.03708372e+00]
Stock Position:  -0.001651579066215884
Bond Position:  [7.78056168]


portfolio before change:  [7.61823098]
curr_Stock_Price:  99.46607402400849
curr_Factors:  [9.94660740e+01 4.27833135e-02]
mat_Sqrt:  [[ 2.05736897e+01  0.00000000e+00]
 [-8.27365104e-03  1.89573161e-02]]
grads:  [  0.02707454 -14.24153842]
Stock Position:  0.027074543911233928
Bond Position:  [4.92523239]


portfolio before change:  [7.73528508]
curr_Stock_Price:  103.74399086979506
curr_Factors:  [1.03743991e+02 4.21439714e-02]
mat_Sqrt:  [[ 2.12976007e+01  0.00000000e+00]
 [-8.21159876e-03  1.88151364e-02]]
grads:  [ 0.01754796 -3.0050877 ]
Stock Position:  0.017547959665747542
Bond Position:  [5.91478972]


portfolio before change:  [7.76373713]
curr_Stock_Price:  105.28110170425484
curr_Factors:  [1.05281102e+02 4.28058447e-02]
mat_Sqrt:  [[ 2.17822108e+01  0.00000000e+00]
 [-8.27582936e-03  1.89623072e-02]]
grads:  [ 0.01351603 -1.7543045 ]
Stock Position:  0.013516034839719707
Bond Position:  [6.34075409]


portfolio before change:  [7.79289822]
curr_Stock_Price:  107.32132336193739
curr_Factors:  [1.07321323e+02 4.19518762e-02]
mat_Sqrt:  [[ 2.19817221e+01  0.00000000e+00]
 [-8.19286286e-03  1.87722071e-02]]
grads:  [-2.63683689e-05 -1.03084182e+00]
Stock Position:  -2.636836885028104e-05
Bond Position:  [7.79572811]


portfolio before change:  [7.79479754]
curr_Stock_Price:  109.2119635128653
curr_Factors:  [1.09211964e+02 4.23293850e-02]
mat_Sqrt:  [[ 2.24693855e+01  0.00000000e+00]
 [-8.22964252e-03  1.88564799e-02]]
grads:  [-0.03963683  1.54884185]
Stock Position:  -0.039636834365895296
Bond Position:  [12.12361405]


portfolio before change:  [7.75196526]
curr_Stock_Price:  110.36905795611004
curr_Factors:  [1.10369058e+02 4.33232327e-02]
mat_Sqrt:  [[ 2.29724737e+01  0.00000000e+00]
 [-8.32569350e-03  1.90765603e-02]]
grads:  [-0.05953241 30.00919266]
Stock Position:  -0.05953240878647218
Bond Position:  [14.32250114]


portfolio before change:  [7.6578192]
curr_Stock_Price:  112.01063677917601
curr_Factors:  [1.12010637e+02 4.26139142e-02]
mat_Sqrt:  [[ 2.31225102e+01  0.00000000e+00]
 [-8.25725516e-03  1.89197484e-02]]
grads:  [-0.00675591  0.59092244]
Stock Position:  -0.00675591187335347
Bond Position:  [8.41455319]


portfolio before change:  [7.66499454]
curr_Stock_Price:  111.25996890402723
curr_Factors:  [1.11259969e+02 4.36831892e-02]
mat_Sqrt:  [[ 2.32539162e+01  0.00000000e+00]
 [-8.36020949e-03  1.91556464e-02]]
grads:  [3.38281094e-02 6.64307860e+01]
Stock Position:  0.03382810940991478
Bond Position:  [3.90128014]


portfolio before change:  [7.75019238]
curr_Stock_Price:  113.74968509328656
curr_Factors:  [1.13749685e+02 4.24585856e-02]
mat_Sqrt:  [[ 2.34386700e+01  0.00000000e+00]
 [-8.24219249e-03  1.88852355e-02]]
grads:  [ -0.05248683 -16.97266697]
Stock Position:  -0.05248683112998173
Bond Position:  [13.72055289]


portfolio before change:  [7.78798395]
curr_Stock_Price:  113.09502553993924
curr_Factors:  [1.13095026e+02 4.27312994e-02]
mat_Sqrt:  [[ 2.33784951e+01  0.00000000e+00]
 [-8.26862014e-03  1.89457888e-02]]
grads:  [-6.57564671e-03 -1.35264732e+01]
Stock Position:  -0.006575646706778984
Bond Position:  [8.53165688]


portfolio before change:  [7.78553113]
curr_Stock_Price:  113.79244668260633
curr_Factors:  [1.13792447e+02 4.41968611e-02]
mat_Sqrt:  [[ 2.39226424e+01  0.00000000e+00]
 [-8.40921981e-03  1.92679431e-02]]
grads:  [-0.00988301 -9.38493893]
Stock Position:  -0.00988301352543515
Bond Position:  [8.91014342]


portfolio before change:  [7.78529998]
curr_Stock_Price:  114.04125393192625
curr_Factors:  [1.14041254e+02 4.52670916e-02]
mat_Sqrt:  [[ 2.42634906e+01  0.00000000e+00]
 [-8.51042576e-03  1.94998351e-02]]
grads:  [6.27432978e-03 7.61945363e+00]
Stock Position:  0.006274329780481513
Bond Position:  [7.06976755]


portfolio before change:  [7.75627847]
curr_Stock_Price:  109.1340875806839
curr_Factors:  [1.09134088e+02 4.38569749e-02]
mat_Sqrt:  [[ 2.28549228e+01  0.00000000e+00]
 [-8.37682277e-03  1.91937122e-02]]
grads:  [-0.00613923 -3.15427279]
Stock Position:  -0.006139230796568361
Bond Position:  [8.42627782]


portfolio before change:  [7.73528045]
curr_Stock_Price:  112.89756388258688
curr_Factors:  [1.12897564e+02 4.09297911e-02]
mat_Sqrt:  [[ 2.28404331e+01  0.00000000e+00]
 [-8.09244498e-03  1.85421208e-02]]
grads:  [0.00982359 5.69776441]
Stock Position:  0.009823589213119594
Bond Position:  [6.62622116]


portfolio before change:  [7.75508197]
curr_Stock_Price:  114.74462407336961
curr_Factors:  [1.14744624e+02 3.87048185e-02]
mat_Sqrt:  [[ 2.25743298e+01  0.00000000e+00]
 [-7.86941609e-03  1.80310975e-02]]
grads:  [-1.42582789e-02 -4.31551086e+01]
Stock Position:  -0.014258278858118329
Bond Position:  [9.39114282]


portfolio before change:  [7.73173013]
curr_Stock_Price:  116.5470801910236
curr_Factors:  [1.16547080e+02 3.77002064e-02]
mat_Sqrt:  [[ 2.26294116e+01  0.00000000e+00]
 [-7.76661640e-03  1.77955538e-02]]
grads:  [-1.15680788e-02  1.31664208e+01]
Stock Position:  -0.011568078814261445
Bond Position:  [9.07995594]


portfolio before change:  [7.76266644]
curr_Stock_Price:  114.06905124139648
curr_Factors:  [1.14069051e+02 3.93447975e-02]
mat_Sqrt:  [[ 2.26261930e+01  0.00000000e+00]
 [-7.93420922e-03  1.81795572e-02]]
grads:  [-0.01202625 -5.22683156]
Stock Position:  -0.012026247526242909
Bond Position:  [9.13448908]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.7558717]
Stock Price:  114.82395339318867
PL:  [-7.06808169]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.01274597e-02  1.43194601e-01]
 [ 5.51551958e-02 -3.77805721e-02]
 [ 6.54476857e-01 -2.63762537e-01]
 [-1.07234277e-01 -1.17880942e-01]
 [ 3.83022746e-01 -1.69246945e-02]
 [-6.66498057e-01 -5.71970663e-01]
 [-4.45124699e-02 -7.81538280e-02]
 [-1.86462973e+00  4.75871178e-01]
 [ 4.16897092e-03  4.88841443e-02]
 [ 2.57516196e-02 -3.74618317e-02]
 [ 1.17340070e-01  3.49568798e-01]
 [ 1.10088479e-01 -1.34032948e-01]
 [ 1.02537446e-01 -1.74552988e-02]
 [-9.12456823e-02 -1.36851792e-01]
 [ 6.05163537e-02  5.72585918e-02]
 [-1.34108359e-01 -1.35448185e-01]
 [-1.96249404e-01 -3.09423508e-01]
 [ 2.89096458e-01 -3.57877509e-01]
 [-2.09976109e-01 -1.78865546e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.44269541]
curr_Stock_Price:  99.23674164688111
curr_Factors:  [9.92367416e+01 4.07942861e-02]
mat_Sqrt:  [[ 2.00434356e+01  0.00000000e+00]
 [-8.07903817e-03  1.85114020e-02]]
grads:  [3.62326642e-03 7.73548115e+00]
Stock Position:  0.003623266422753372
Bond Position:  [-2.80225657]


portfolio before change:  [-2.44192457]
curr_Stock_Price:  99.6428663060431
curr_Factors:  [9.96428663e+01 3.94230011e-02]
mat_Sqrt:  [[ 1.97843166e+01  0.00000000e+00]
 [-7.94209052e-03  1.81976155e-02]]
grads:  [ 1.95439666e-03 -2.07612762e+00]
Stock Position:  0.001954396664513795
Bond Position:  [-2.63666625]


portfolio before change:  [-2.44300254]
curr_Stock_Price:  99.42861796030898
curr_Factors:  [9.94286180e+01 4.04221527e-02]
mat_Sqrt:  [[ 1.99903833e+01  0.00000000e+00]
 [-8.04210447e-03  1.84267762e-02]]
grads:  [  0.02698105 -14.3140902 ]
Stock Position:  0.02698104582250312
Bond Position:  [-5.12569064]


portfolio before change:  [-2.50728925]
curr_Stock_Price:  97.0934552774751
curr_Factors:  [9.70934553e+01 4.11470382e-02]
mat_Sqrt:  [[ 1.96951479e+01  0.00000000e+00]
 [-8.11389309e-03  1.85912646e-02]]
grads:  [-0.00805689 -6.3406629 ]
Stock Position:  -0.008056894969216572
Bond Position:  [-1.72501748]


portfolio before change:  [-2.49079464]
curr_Stock_Price:  94.99265506158402
curr_Factors:  [9.49926551e+01 4.19866989e-02]
mat_Sqrt:  [[ 1.94646183e+01  0.00000000e+00]
 [-8.19626246e-03  1.87799966e-02]]
grads:  [ 0.01929841 -0.9012086 ]
Stock Position:  0.019298410966660948
Bond Position:  [-4.32400193]


portfolio before change:  [-2.53580586]
curr_Stock_Price:  92.7162972579046
curr_Factors:  [9.27162973e+01 4.13958356e-02]
mat_Sqrt:  [[ 1.88640268e+01  0.00000000e+00]
 [-8.13838663e-03  1.86473864e-02]]
grads:  [ -0.04856474 -30.67296676]
Stock Position:  -0.048564737900869896
Bond Position:  [1.96693682]


portfolio before change:  [-2.44094122]
curr_Stock_Price:  90.77305917447546
curr_Factors:  [9.07730592e+01 4.37662834e-02]
mat_Sqrt:  [[ 1.89900805e+01  0.00000000e+00]
 [-8.36815712e-03  1.91738567e-02]]
grads:  [-0.00414014 -4.07606197]
Stock Position:  -0.004140140254004253
Bond Position:  [-2.06512802]


portfolio before change:  [-2.438989]
curr_Stock_Price:  90.17680750143028
curr_Factors:  [9.01768075e+01 4.44529583e-02]
mat_Sqrt:  [[ 1.90127610e+01  0.00000000e+00]
 [-8.43354808e-03  1.93236862e-02]]
grads:  [-0.08714897 24.6263147 ]
Stock Position:  -0.08714896910240302
Bond Position:  [5.41982681]


portfolio before change:  [-2.68385565]
curr_Stock_Price:  93.00210521809453
curr_Factors:  [9.30021052e+01 4.39309836e-02]
mat_Sqrt:  [[ 1.94929803e+01  0.00000000e+00]
 [-8.38388775e-03  1.92099001e-02]]
grads:  [1.30835615e-03 2.54473704e+00]
Stock Position:  0.0013083561501122498
Bond Position:  [-2.80553553]


portfolio before change:  [-2.68539347]
curr_Stock_Price:  92.3628717001839
curr_Factors:  [9.23628717e+01 4.55841079e-02]
mat_Sqrt:  [[ 1.97198750e+01  0.00000000e+00]
 [-8.54017404e-03  1.95679970e-02]]
grads:  [ 4.76774617e-04 -1.91444386e+00]
Stock Position:  0.0004767746174446174
Bond Position:  [-2.72942974]


portfolio before change:  [-2.68665514]
curr_Stock_Price:  91.14798583584044
curr_Factors:  [9.11479858e+01 4.73679377e-02]
mat_Sqrt:  [[ 1.98376085e+01  0.00000000e+00]
 [-8.70567059e-03  1.99471972e-02]]
grads:  [1.36056925e-02 1.75247076e+01]
Stock Position:  0.013605692505295084
Bond Position:  [-3.92678661]


portfolio before change:  [-2.66116406]
curr_Stock_Price:  93.09370840147365
curr_Factors:  [9.30937084e+01 4.83276682e-02]
mat_Sqrt:  [[ 2.04653064e+01  0.00000000e+00]
 [-8.79342193e-03  2.01482608e-02]]
grads:  [ 2.52093488e-03 -6.65233341e+00]
Stock Position:  0.0025209348766780846
Bond Position:  [-2.89584723]


portfolio before change:  [-2.65936011]
curr_Stock_Price:  94.09651213953393
curr_Factors:  [9.40965121e+01 4.69403712e-02]
mat_Sqrt:  [[ 2.03866931e+01  0.00000000e+00]
 [-8.66629067e-03  1.98569665e-02]]
grads:  [ 0.00465595 -0.87905163]
Stock Position:  0.004655945357848865
Bond Position:  [-3.09746833]


portfolio before change:  [-2.66063093]
curr_Stock_Price:  93.9899048050705
curr_Factors:  [9.39899048e+01 4.85395738e-02]
mat_Sqrt:  [[ 2.07075724e+01  0.00000000e+00]
 [-8.81267939e-03  2.01923852e-02]]
grads:  [-0.0072907  -6.77739605]
Stock Position:  -0.00729070012433258
Bond Position:  [-1.97537872]


portfolio before change:  [-2.67906305]
curr_Stock_Price:  96.45032834869143
curr_Factors:  [9.64503283e+01 4.72891178e-02]
mat_Sqrt:  [[ 2.09741474e+01  0.00000000e+00]
 [-8.69842449e-03  1.99305943e-02]]
grads:  [0.00407674 2.87289936]
Stock Position:  0.0040767355178270015
Bond Position:  [-3.07226552]


portfolio before change:  [-2.68348868]
curr_Stock_Price:  95.55317018740448
curr_Factors:  [9.55531702e+01 4.51362823e-02]
mat_Sqrt:  [[ 2.03005588e+01  0.00000000e+00]
 [-8.49812048e-03  1.94716402e-02]]
grads:  [-0.0095181  -6.95617747]
Stock Position:  -0.00951810217685921
Bond Position:  [-1.77400385]


portfolio before change:  [-2.68115068]
curr_Stock_Price:  95.26093092192723
curr_Factors:  [9.52609309e+01 4.58377031e-02]
mat_Sqrt:  [[ 2.03951191e+01  0.00000000e+00]
 [-8.56389660e-03  1.96223522e-02]]
grads:  [ -0.01624373 -15.7689305 ]
Stock Position:  -0.0162437342516892
Bond Position:  [-1.13375743]


portfolio before change:  [-2.66704658]
curr_Stock_Price:  94.37520038885299
curr_Factors:  [9.43752004e+01 4.83811494e-02]
mat_Sqrt:  [[ 2.07585004e+01  0.00000000e+00]
 [-8.79828614e-03  2.01594061e-02]]
grads:  [ 6.40248119e-03 -1.77523835e+01]
Stock Position:  0.0064024811885489445
Bond Position:  [-3.27128203]


portfolio before change:  [-2.67019371]
curr_Stock_Price:  94.01140224826126
curr_Factors:  [9.40114022e+01 4.71542015e-02]
mat_Sqrt:  [[ 2.04145931e+01  0.00000000e+00]
 [-8.68600728e-03  1.99021429e-02]]
grads:  [-0.01410949 -8.98725061]
Stock Position:  -0.0141094868808093
Bond Position:  [-1.34374107]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.6544665]
Stock Price:  92.87293497276133
PL:  [-2.6544665]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.53885205e-02  2.80504110e-02]
 [-1.20921957e-01  1.07647546e-01]
 [ 7.21849338e-01 -2.84324868e-01]
 [ 3.44964077e-01 -7.32074502e-02]
 [ 2.28490884e-01 -3.02249373e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-3.92042424e-01 -1.25978701e-01]
 [-1.43066533e+00  7.51467472e-01]
 [ 3.14542263e-02 -8.07111714e-02]
 [ 1.26847797e-01  3.55376399e-01]
 [-2.37862180e-01 -2.48513198e-02]
 [-2.04830616e-02 -1.08235772e-02]
 [ 5.41826867e-03 -6.07197090e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.16136318e-01 -6.18177562e-02]
 [-1.02775843e-01 -1.08106675e-01]
 [-1.48883958e-01 -5.77119504e-01]
 [-5.31727546e-02 -1.56516438e-01]
 [ 1.63642829e-01  3.91630690e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.9931851]
curr_Stock_Price:  100.8086376702223
curr_Factors:  [1.00808638e+02 3.99849510e-02]
mat_Sqrt:  [[ 2.01579345e+01  0.00000000e+00]
 [-7.99849496e-03  1.83268543e-02]]
grads:  [1.37071204e-03 1.53056332e+00]
Stock Position:  0.00137071203707333
Bond Position:  [7.85500549]


portfolio before change:  [7.99736009]
curr_Stock_Price:  102.42166505821652
curr_Factors:  [1.02421665e+02 3.86218196e-02]
mat_Sqrt:  [[ 2.01283510e+01  0.00000000e+00]
 [-7.86097394e-03  1.80117541e-02]]
grads:  [-3.67346118e-03  5.97651651e+00]
Stock Position:  -0.00367346117850553
Bond Position:  [8.3736021]


portfolio before change:  [8.00697798]
curr_Stock_Price:  100.373398470627
curr_Factors:  [1.00373398e+02 4.13635660e-02]
mat_Sqrt:  [[ 2.04139767e+01  0.00000000e+00]
 [-8.13521392e-03  1.86401168e-02]]
grads:  [  0.02928189 -15.25338445]
Stock Position:  0.02928188861095704
Bond Position:  [5.06785531]


portfolio before change:  [8.08660012]
curr_Stock_Price:  103.04928498801654
curr_Factors:  [1.03049285e+02 3.90670527e-02]
mat_Sqrt:  [[ 2.03680901e+01  0.00000000e+00]
 [-7.90615484e-03  1.81152765e-02]]
grads:  [ 0.01536785 -4.04119971]
Stock Position:  0.01536784869225898
Bond Position:  [6.5029543]


portfolio before change:  [8.10083109]
curr_Stock_Price:  103.86950577818392
curr_Factors:  [1.03869506e+02 3.78498530e-02]
mat_Sqrt:  [[ 2.02078525e+01  0.00000000e+00]
 [-7.78201547e-03  1.78308375e-02]]
grads:  [ 0.01065426 -1.69509353]
Stock Position:  0.010654256296837158
Bond Position:  [6.99417875]


portfolio before change:  [8.11914712]
curr_Stock_Price:  105.42449634793594
curr_Factors:  [1.05424496e+02 3.77926431e-02]
mat_Sqrt:  [[ 2.04948700e+01  0.00000000e+00]
 [-7.77613201e-03  1.78173568e-02]]
grads:  [-2.82813288e-05 -1.08608568e+00]
Stock Position:  -2.828132875767626e-05
Bond Position:  [8.12212866]


portfolio before change:  [8.121208]
curr_Stock_Price:  104.36043702938477
curr_Factors:  [1.04360437e+02 3.67639327e-02]
mat_Sqrt:  [[ 2.00099900e+01  0.00000000e+00]
 [-7.66956924e-03  1.75731908e-02]]
grads:  [-0.02234004 -7.16880063]
Stock Position:  -0.022340043050864518
Bond Position:  [10.45262465]


portfolio before change:  [8.13482153]
curr_Stock_Price:  103.86804545322161
curr_Factors:  [1.03868045e+02 3.82371868e-02]
mat_Sqrt:  [[ 2.03107016e+01  0.00000000e+00]
 [-7.82173248e-03  1.79218406e-02]]
grads:  [-0.05429148 41.93026207]
Stock Position:  -0.054291479301324407
Bond Position:  [13.77397137]


portfolio before change:  [8.08397437]
curr_Stock_Price:  104.8680380969415
curr_Factors:  [1.04868038e+02 4.00533453e-02]
mat_Sqrt:  [[ 2.09875885e+01  0.00000000e+00]
 [-8.00533276e-03  1.83425217e-02]]
grads:  [-1.79678422e-04 -4.40022222e+00]
Stock Position:  -0.00017967842169811662
Bond Position:  [8.1028169]


portfolio before change:  [8.08624864]
curr_Stock_Price:  103.48610190575505
curr_Factors:  [1.03486102e+02 4.04702440e-02]
mat_Sqrt:  [[ 2.08185242e+01  0.00000000e+00]
 [-8.04688700e-03  1.84377344e-02]]
grads:  [1.35430720e-02 1.92744071e+01]
Stock Position:  0.013543072048366434
Bond Position:  [6.6847289]


portfolio before change:  [8.07868571]
curr_Stock_Price:  102.8042537988566
curr_Factors:  [1.02804254e+02 4.04088143e-02]
mat_Sqrt:  [[ 2.06656533e+01  0.00000000e+00]
 [-8.04077750e-03  1.84237358e-02]]
grads:  [-0.01203486 -1.34887517]
Stock Position:  -0.012034857138255676
Bond Position:  [9.31592022]


portfolio before change:  [8.06365271]
curr_Stock_Price:  104.24691935767602
curr_Factors:  [1.04246919e+02 4.15295984e-02]
mat_Sqrt:  [[ 2.12442838e+01  0.00000000e+00]
 [-8.15152485e-03  1.86774898e-02]]
grads:  [-0.00118652 -0.57949849]
Stock Position:  -0.0011865242508201583
Bond Position:  [8.1873442]


portfolio before change:  [8.06518922]
curr_Stock_Price:  104.67722979542302
curr_Factors:  [1.04677230e+02 4.04326859e-02]
mat_Sqrt:  [[ 2.10483723e+01  0.00000000e+00]
 [-8.04315220e-03  1.84291769e-02]]
grads:  [-1.00159692e-03 -3.29475968e+00]
Stock Position:  -0.0010015969216912144
Bond Position:  [8.17003362]


portfolio before change:  [8.06950365]
curr_Stock_Price:  102.40918952213889
curr_Factors:  [1.02409190e+02 4.09093616e-02]
mat_Sqrt:  [[ 2.07133470e+01  0.00000000e+00]
 [-8.09042511e-03  1.85374927e-02]]
grads:  [7.34971234e-03 8.01500459e+00]
Stock Position:  0.007349712339131588
Bond Position:  [7.31682557]


portfolio before change:  [8.08248504]
curr_Stock_Price:  103.92652225973056
curr_Factors:  [1.03926522e+02 4.11279656e-02]
mat_Sqrt:  [[ 2.10763309e+01  0.00000000e+00]
 [-8.11201239e-03  1.85869554e-02]]
grads:  [-0.00679036 -3.32586778]
Stock Position:  -0.006790356424225783
Bond Position:  [8.78818317]


portfolio before change:  [8.08476556]
curr_Stock_Price:  103.9142699358387
curr_Factors:  [1.03914270e+02 4.02297681e-02]
mat_Sqrt:  [[ 2.08424590e+01  0.00000000e+00]
 [-8.02294391e-03  1.83828739e-02]]
grads:  [-0.00719481 -5.88083646]
Stock Position:  -0.0071948067325447755
Bond Position:  [8.83240865]


portfolio before change:  [8.08421442]
curr_Stock_Price:  104.29781301735709
curr_Factors:  [1.04297813e+02 4.04338132e-02]
mat_Sqrt:  [[ 2.09723720e+01  0.00000000e+00]
 [-8.04326434e-03  1.84294338e-02]]
grads:  [-1.91089286e-02 -3.13150968e+01]
Stock Position:  -0.019108928581054396
Bond Position:  [10.07723388]


portfolio before change:  [8.11377533]
curr_Stock_Price:  102.88270045713675
curr_Factors:  [1.0288270e+02 4.1750542e-02]
mat_Sqrt:  [[ 2.10219701e+01  0.00000000e+00]
 [-8.17317975e-03  1.87271074e-02]]
grads:  [-5.77881749e-03 -8.35774767e+00]
Stock Position:  -0.005778817494646618
Bond Position:  [8.70831568]


portfolio before change:  [8.10629377]
curr_Stock_Price:  104.55413367856981
curr_Factors:  [1.04554134e+02 4.21225244e-02]
mat_Sqrt:  [[ 2.14584527e+01  0.00000000e+00]
 [-8.20950906e-03  1.88103483e-02]]
grads:  [0.00842255 2.08199595]
Stock Position:  0.008422554789857872
Bond Position:  [7.22568085]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.11687932]
Stock Price:  105.59644198524819
PL:  [2.52043733]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 7.72040018e-02  2.30190043e-02]
 [ 7.42329687e-02 -9.11214351e-03]
 [ 7.70137066e-01 -2.99062461e-01]
 [ 3.00384719e-01 -8.71098965e-02]
 [ 1.60440978e-01 -2.69205104e-02]
 [ 3.79234812e-02 -3.98352033e-02]
 [-7.17529575e-02 -1.40417838e-01]
 [-1.27353454e+00  7.37227731e-01]
 [ 7.28806205e-02 -7.68520379e-02]
 [ 7.25974176e-02  1.07568795e-01]
 [-1.56608231e-01 -5.90571276e-02]
 [ 1.15117683e-02 -9.21218275e-03]
 [ 1.54697642e-01 -2.27988837e-02]
 [ 5.57743769e-02  8.65479281e-02]
 [-1.17551058e-01 -6.26206965e-02]
 [-1.41221161e-01 -1.29554377e-01]
 [-1.63458140e-01 -5.25647780e-01]
 [-1.38012990e-01 -1.10165499e-01]
 [ 1.23599937e-01 -1.74084317e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.79270786]
curr_Stock_Price:  97.97902780546184
curr_Factors:  [9.79790278e+01 4.17197695e-02]
mat_Sqrt:  [[ 2.00126258e+01  0.00000000e+00]
 [-8.17016715e-03  1.87202047e-02]]
grads:  [0.00435976 1.22963422]
Stock Position:  0.004359763660113379
Bond Position:  [-11.21987327]


portfolio before change:  [-10.78540834]
curr_Stock_Price:  100.29677876122443
curr_Factors:  [1.00296779e+02 3.89295811e-02]
mat_Sqrt:  [[ 1.97891368e+01  0.00000000e+00]
 [-7.89223224e-03  1.80833758e-02]]
grads:  [ 0.00355024 -0.50389615]
Stock Position:  0.0035502358742586014
Bond Position:  [-11.14148556]


portfolio before change:  [-10.7834997]
curr_Stock_Price:  101.61904330423425
curr_Factors:  [1.01619043e+02 3.85757334e-02]
mat_Sqrt:  [[ 1.99586976e+01  0.00000000e+00]
 [-7.85628242e-03  1.80010044e-02]]
grads:  [  0.03204696 -16.61365409]
Stock Position:  0.03204695619931102
Bond Position:  [-14.04008073]


portfolio before change:  [-10.75975677]
curr_Stock_Price:  102.46946407491919
curr_Factors:  [1.02469464e+02 3.59105880e-02]
mat_Sqrt:  [[ 1.94180548e+01  0.00000000e+00]
 [-7.58003567e-03  1.73680436e-02]]
grads:  [ 0.01351149 -5.01552728]
Stock Position:  0.013511489472303559
Bond Position:  [-12.14427185]


portfolio before change:  [-10.75836772]
curr_Stock_Price:  102.79699997663356
curr_Factors:  [1.02797000e+02 3.46320736e-02]
mat_Sqrt:  [[ 1.91302078e+01  0.00000000e+00]
 [-7.44387787e-03  1.70560669e-02]]
grads:  [ 0.00777262 -1.57835394]
Stock Position:  0.0077726235754949574
Bond Position:  [-11.5573701]


portfolio before change:  [-10.78118986]
curr_Stock_Price:  100.2325581568215
curr_Factors:  [1.00232558e+02 3.69293047e-02]
mat_Sqrt:  [[ 1.92616896e+01  0.00000000e+00]
 [-7.68679956e-03  1.76126704e-02]]
grads:  [ 1.06626021e-03 -2.26173558e+00]
Stock Position:  0.0010662602072253917
Bond Position:  [-10.88806385]


portfolio before change:  [-10.78414696]
curr_Stock_Price:  100.01240509817929
curr_Factors:  [1.00012405e+02 3.68785872e-02]
mat_Sqrt:  [[ 1.92061806e+01  0.00000000e+00]
 [-7.68151935e-03  1.76005719e-02]]
grads:  [-6.92674557e-03 -7.97802702e+00]
Stock Position:  -0.006926745565649146
Bond Position:  [-10.09138647]


portfolio before change:  [-10.78419594]
curr_Stock_Price:  99.6552131497032
curr_Factors:  [9.96552131e+01 3.67604739e-02]
mat_Sqrt:  [[ 1.91069151e+01  0.00000000e+00]
 [-7.66920845e-03  1.75723641e-02]]
grads:  [-0.04981348 41.95381597]
Stock Position:  -0.049813482567044244
Bond Position:  [-5.82002272]


portfolio before change:  [-10.86911741]
curr_Stock_Price:  101.33078917429235
curr_Factors:  [1.01330789e+02 3.50135369e-02]
mat_Sqrt:  [[ 1.89609205e+01  0.00000000e+00]
 [-7.48476179e-03  1.71497437e-02]]
grads:  [ 2.07477487e-03 -4.48123535e+00]
Stock Position:  0.002074774873425804
Bond Position:  [-11.07935598]


portfolio before change:  [-10.87283337]
curr_Stock_Price:  100.87494425736281
curr_Factors:  [1.00874944e+02 3.76382396e-02]
mat_Sqrt:  [[ 1.95703214e+01  0.00000000e+00]
 [-7.76023088e-03  1.77809227e-02]]
grads:  [0.00610845 6.04967451]
Stock Position:  0.006108447886897903
Bond Position:  [-11.48902271]


portfolio before change:  [-10.87069556]
curr_Stock_Price:  101.69518902941498
curr_Factors:  [1.01695189e+02 3.82768832e-02]
mat_Sqrt:  [[ 1.98961337e+01  0.00000000e+00]
 [-7.82579153e-03  1.79311410e-02]]
grads:  [-0.00916675 -3.29355101]
Stock Position:  -0.00916674954377032
Bond Position:  [-9.93848123]


portfolio before change:  [-10.87497598]
curr_Stock_Price:  101.89105848186466
curr_Factors:  [1.01891058e+02 4.07804719e-02]
mat_Sqrt:  [[ 2.05760590e+01  0.00000000e+00]
 [-8.07767015e-03  1.85082674e-02]]
grads:  [ 3.64075655e-04 -4.97733393e-01]
Stock Position:  0.00036407565468482843
Bond Position:  [-10.91207203]


portfolio before change:  [-10.87836905]
curr_Stock_Price:  100.06529345003962
curr_Factors:  [1.00065293e+02 4.16894015e-02]
mat_Sqrt:  [[ 2.04313142e+01  0.00000000e+00]
 [-8.16719305e-03  1.87133902e-02]]
grads:  [ 0.00708459 -1.21831926]
Stock Position:  0.0070845855594695185
Bond Position:  [-11.58729019]


portfolio before change:  [-10.87892152]
curr_Stock_Price:  100.39625345772633
curr_Factors:  [1.00396253e+02 4.23043287e-02]
mat_Sqrt:  [[ 2.06495176e+01  0.00000000e+00]
 [-8.22720645e-03  1.88508982e-02]]
grads:  [4.53022639e-03 4.59118326e+00]
Stock Position:  0.004530226385031626
Bond Position:  [-11.33373928]


portfolio before change:  [-10.87819735]
curr_Stock_Price:  101.18163690276533
curr_Factors:  [1.01181637e+02 4.13288804e-02]
mat_Sqrt:  [[ 2.05697267e+01  0.00000000e+00]
 [-8.13180230e-03  1.86322998e-02]]
grads:  [-0.00704341 -3.36086781]
Stock Position:  -0.007043407639212561
Bond Position:  [-10.16553383]


portfolio before change:  [-10.88048226]
curr_Stock_Price:  101.1451787343876
curr_Factors:  [1.01145179e+02 4.03933022e-02]
mat_Sqrt:  [[ 2.03282440e+01  0.00000000e+00]
 [-8.03923402e-03  1.84201992e-02]]
grads:  [-0.0097285  -7.03327772]
Stock Position:  -0.009728500200625425
Bond Position:  [-9.89649137]


portfolio before change:  [-10.89399859]
curr_Stock_Price:  102.28018394773173
curr_Factors:  [1.02280184e+02 4.08126491e-02]
mat_Sqrt:  [[ 2.06627867e+01  0.00000000e+00]
 [-8.08085630e-03  1.85155678e-02]]
grads:  [-1.90133908e-02 -2.83895036e+01]
Stock Position:  -0.019013390805201476
Bond Position:  [-8.94930548]


portfolio before change:  [-10.92495526]
curr_Stock_Price:  103.79064911723623
curr_Factors:  [1.03790649e+02 4.13246755e-02]
mat_Sqrt:  [[ 2.10990526e+01  0.00000000e+00]
 [-8.13138861e-03  1.86313519e-02]]
grads:  [-0.00881998 -5.91290959]
Stock Position:  -0.008819976887363775
Bond Position:  [-10.00952413]


portfolio before change:  [-10.91042875]
curr_Stock_Price:  101.8598954989465
curr_Factors:  [1.01859895e+02 4.16131138e-02]
mat_Sqrt:  [[ 2.07786981e+01  0.00000000e+00]
 [-8.15971703e-03  1.86962605e-02]]
grads:  [ 0.00558275 -0.93111838]
Stock Position:  0.005582749888448313
Bond Position:  [-11.47908707]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.90463777]
Stock Price:  103.41130077148975
PL:  [-14.31593855]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 5.60200679e-02  6.09725394e-02]
 [ 7.75615938e-02 -9.78014162e-03]
 [ 7.78296109e-01 -3.01552631e-01]
 [ 1.76939334e-01 -1.19251341e-01]
 [-9.43262656e-03 -1.30088243e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-2.56386334e-01 -1.66579114e-01]
 [-1.37805766e+00  7.46664403e-01]
 [ 4.70857255e-02 -7.42752562e-02]
 [ 1.63478976e-01  6.71736319e-01]
 [-5.80917408e-01 -1.36024583e-01]
 [-1.68991988e-02 -1.05545525e-02]
 [-4.45872564e-03 -6.77212249e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.14903385e-01 -6.11180007e-02]
 [-3.85071162e-02 -7.57534006e-02]
 [-1.32762730e-01 -6.26223863e-01]
 [-3.99270859e-01  7.01530477e-02]
 [ 1.35022484e-01 -1.68553720e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.15550845]
curr_Stock_Price:  98.37625382426026
curr_Factors:  [9.83762538e+01 4.13598121e-02]
mat_Sqrt:  [[ 2.00068888e+01  0.00000000e+00]
 [-8.13484477e-03  1.86392710e-02]]
grads:  [0.00413011 3.27118692]
Stock Position:  0.0041301107044851605
Bond Position:  [-8.56181327]


portfolio before change:  [-8.14678385]
curr_Stock_Price:  101.00701187426344
curr_Factors:  [1.01007012e+02 4.08132173e-02]
mat_Sqrt:  [[ 2.04057207e+01  0.00000000e+00]
 [-8.08091255e-03  1.85156967e-02]]
grads:  [ 0.0035918  -0.52820813]
Stock Position:  0.003591796193061449
Bond Position:  [-8.50958045]


portfolio before change:  [-8.14596519]
curr_Stock_Price:  101.82730366979258
curr_Factors:  [1.01827304e+02 3.81863973e-02]
mat_Sqrt:  [[ 1.98984197e+01  0.00000000e+00]
 [-7.81653604e-03  1.79099340e-02]]
grads:  [  0.03249945 -16.8371715 ]
Stock Position:  0.032499452710493204
Bond Position:  [-11.45529683]


portfolio before change:  [-8.17702774]
curr_Stock_Price:  100.95964689273762
curr_Factors:  [1.00959647e+02 3.87795990e-02]
mat_Sqrt:  [[ 1.98815152e+01  0.00000000e+00]
 [-7.87701456e-03  1.80485077e-02]]
grads:  [ 6.28190457e-03 -6.60726877e+00]
Stock Position:  0.006281904570916253
Bond Position:  [-8.81124661]


portfolio before change:  [-8.17898703]
curr_Stock_Price:  100.99845725896097
curr_Factors:  [1.00998457e+02 3.85445266e-02]
mat_Sqrt:  [[ 1.98287847e+01  0.00000000e+00]
 [-7.85310401e-03  1.79937218e-02]]
grads:  [-0.00076203 -0.72296462]
Stock Position:  -0.0007620307108837092
Bond Position:  [-8.1020231]


portfolio before change:  [-8.18180086]
curr_Stock_Price:  102.03262777661034
curr_Factors:  [1.02032628e+02 3.71822703e-02]
mat_Sqrt:  [[ 1.96746504e+01  0.00000000e+00]
 [-7.71308191e-03  1.76728908e-02]]
grads:  [-2.94603536e-05 -1.09496382e+00]
Stock Position:  -2.9460353576110535e-05
Bond Position:  [-8.17879494]


portfolio before change:  [-8.1838765]
curr_Stock_Price:  103.07435462447565
curr_Factors:  [1.03074355e+02 3.71751851e-02]
mat_Sqrt:  [[ 1.98736297e+01  0.00000000e+00]
 [-7.71234700e-03  1.76712070e-02]]
grads:  [-0.016559   -9.42658386]
Stock Position:  -0.01655899924068257
Bond Position:  [-6.47706834]


portfolio before change:  [-8.1754006]
curr_Stock_Price:  102.46469401632692
curr_Factors:  [1.02464694e+02 3.80757250e-02]
mat_Sqrt:  [[ 1.99939379e+01  0.00000000e+00]
 [-7.80520083e-03  1.78839618e-02]]
grads:  [-0.05262528 41.75050315]
Stock Position:  -0.05262528099113837
Bond Position:  [-2.78316729]


portfolio before change:  [-8.21370495]
curr_Stock_Price:  103.17934045841353
curr_Factors:  [1.03179340e+02 3.59269002e-02]
mat_Sqrt:  [[ 1.95570174e+01  0.00000000e+00]
 [-7.58175707e-03  1.73719878e-02]]
grads:  [ 7.50080946e-04 -4.27557611e+00]
Stock Position:  0.0007500809463509172
Bond Position:  [-8.29109781]


portfolio before change:  [-8.21352037]
curr_Stock_Price:  106.18916381856253
curr_Factors:  [1.06189164e+02 3.58484391e-02]
mat_Sqrt:  [[ 2.01055207e+01  0.00000000e+00]
 [-7.57347361e-03  1.73530080e-02]]
grads:  [2.27126045e-02 3.87100794e+01]
Stock Position:  0.022712604498829916
Bond Position:  [-10.62535285]


portfolio before change:  [-8.1930555]
curr_Stock_Price:  107.2071687959915
curr_Factors:  [1.07207169e+02 3.65789101e-02]
mat_Sqrt:  [[ 2.05040290e+01  0.00000000e+00]
 [-7.65024549e-03  1.75289145e-02]]
grads:  [-0.0312272  -7.76001175]
Stock Position:  -0.03122719943924519
Bond Position:  [-4.84527586]


portfolio before change:  [-8.09604706]
curr_Stock_Price:  104.06183683972533
curr_Factors:  [1.04061837e+02 3.77022569e-02]
mat_Sqrt:  [[ 2.02057587e+01  0.00000000e+00]
 [-7.76682761e-03  1.77960377e-02]]
grads:  [-0.00106433 -0.59308441]
Stock Position:  -0.00106432940613125
Bond Position:  [-7.98529099]


portfolio before change:  [-8.09923866]
curr_Stock_Price:  105.18463576352883
curr_Factors:  [1.05184636e+02 3.94490827e-02]
mat_Sqrt:  [[ 2.08915548e+01  0.00000000e+00]
 [-7.94471726e-03  1.82036341e-02]]
grads:  [-1.62815509e-03 -3.72020359e+00]
Stock Position:  -0.0016281550913464966
Bond Position:  [-7.92798176]


portfolio before change:  [-8.10037983]
curr_Stock_Price:  104.66805550817628
curr_Factors:  [1.04668056e+02 3.91314459e-02]
mat_Sqrt:  [[ 2.07050891e+01  0.00000000e+00]
 [-7.91266790e-03  1.81301998e-02]]
grads:  [7.35264365e-03 8.19506078e+00]
Stock Position:  0.0073526436492170385
Bond Position:  [-8.86996674]


portfolio before change:  [-8.0869932]
curr_Stock_Price:  106.79033928772667
curr_Factors:  [1.06790339e+02 3.78217788e-02]
mat_Sqrt:  [[ 2.07683953e+01  0.00000000e+00]
 [-7.77912888e-03  1.78242235e-02]]
grads:  [-0.00681697 -3.42892922]
Stock Position:  -0.006816967107696606
Bond Position:  [-7.35900697]


portfolio before change:  [-8.08463552]
curr_Stock_Price:  106.17457241418079
curr_Factors:  [1.06174572e+02 3.81860938e-02]
mat_Sqrt:  [[ 2.07478519e+01  0.00000000e+00]
 [-7.81650498e-03  1.79098629e-02]]
grads:  [-3.44944678e-03 -4.22970300e+00]
Stock Position:  -0.0034494467790253595
Bond Position:  [-7.71839198]


portfolio before change:  [-8.08792613]
curr_Stock_Price:  106.5690612936325
curr_Factors:  [1.06569061e+02 3.90287685e-02]
mat_Sqrt:  [[ 2.10534641e+01  0.00000000e+00]
 [-7.90228003e-03  1.81063982e-02]]
grads:  [-1.92875257e-02 -3.45857777e+01]
Stock Position:  -0.019287525713403492
Bond Position:  [-6.03247262]


portfolio before change:  [-8.08765523]
curr_Stock_Price:  106.47681490346784
curr_Factors:  [1.06476815e+02 3.80060660e-02]
mat_Sqrt:  [[ 2.07578089e+01  0.00000000e+00]
 [-7.79805781e-03  1.78675951e-02]]
grads:  [-0.01775975  3.92627253]
Stock Position:  -0.017759752951417324
Bond Position:  [-6.1966533]


portfolio before change:  [-8.07173247]
curr_Stock_Price:  105.49301062110237
curr_Factors:  [1.05493011e+02 3.71425047e-02]
mat_Sqrt:  [[ 2.03310253e+01  0.00000000e+00]
 [-7.70895632e-03  1.76634379e-02]]
grads:  [ 0.00627938 -0.95425206]
Stock Position:  0.006279378206495478
Bond Position:  [-8.73416298]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.07226352]
Stock Price:  105.75621478667624
PL:  [-13.82847831]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 2.70964058e-03  1.50452132e-01]
 [ 7.66929092e-02 -7.46595909e-03]
 [ 6.69225988e-01 -2.68264027e-01]
 [-6.01899435e-02 -9.60443730e-02]
 [ 2.50622269e-01 -7.49833341e-03]
 [ 9.43680420e-03 -1.09626449e-01]
 [-2.76084867e-02 -7.70136013e-02]
 [-1.25077513e+00  7.34659482e-01]
 [ 8.36037250e-02 -7.48342925e-02]
 [ 6.78183305e-02  8.62185367e-02]
 [-1.17625422e-01 -9.73607788e-02]
 [ 1.45487594e-02 -9.16534642e-03]
 [ 1.49134769e-01 -2.05448782e-02]
 [ 3.67866042e-03  1.85041856e-02]
 [-1.36858970e-02 -1.02181322e-02]
 [-1.41423495e-01 -1.30462960e-01]
 [-1.72531910e-01 -4.79419335e-01]
 [-3.02816429e-02 -1.61391009e-01]
 [ 5.83185246e-02 -1.10016136e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.89192358]
curr_Stock_Price:  99.47032539355988
curr_Factors:  [9.94703254e+01 3.97615317e-02]
mat_Sqrt:  [[ 1.98346751e+01  0.00000000e+00]
 [-7.97611752e-03  1.82755811e-02]]
grads:  [3.44711138e-03 8.23241303e+00]
Stock Position:  0.003447111382177481
Bond Position:  [-1.23480887]


portfolio before change:  [-0.88919424]
curr_Stock_Price:  100.3516665772731
curr_Factors:  [1.00351667e+02 3.99914166e-02]
mat_Sqrt:  [[ 2.00681798e+01  0.00000000e+00]
 [-7.99914161e-03  1.83283360e-02]]
grads:  [ 0.00365925 -0.40734517]
Stock Position:  0.0036592505265315065
Bond Position:  [-1.25640613]


portfolio before change:  [-0.89241478]
curr_Stock_Price:  99.55740642420746
curr_Factors:  [9.95574064e+01 4.12809356e-02]
mat_Sqrt:  [[ 2.02277855e+01  0.00000000e+00]
 [-8.12708417e-03  1.86214892e-02]]
grads:  [  0.02729641 -14.40615323]
Stock Position:  0.027296412030529793
Bond Position:  [-3.60997477]


portfolio before change:  [-0.90161683]
curr_Stock_Price:  99.25335763531504
curr_Factors:  [9.92533576e+01 4.18248754e-02]
mat_Sqrt:  [[ 2.02984341e+01  0.00000000e+00]
 [-8.18045235e-03  1.87437711e-02]]
grads:  [-5.03029662e-03 -5.12406883e+00]
Stock Position:  -0.005030296623827011
Bond Position:  [-0.402343]


portfolio before change:  [-0.89731602]
curr_Stock_Price:  98.3783788771116
curr_Factors:  [9.83783789e+01 4.02491905e-02]
mat_Sqrt:  [[ 1.97368680e+01  0.00000000e+00]
 [-8.02488036e-03  1.83873108e-02]]
grads:  [ 0.01253237 -0.40779935]
Stock Position:  0.012532369757499204
Bond Position:  [-2.13023024]


portfolio before change:  [-0.90051512]
curr_Stock_Price:  98.16561217731262
curr_Factors:  [9.81656122e+01 4.12007305e-02]
mat_Sqrt:  [[ 1.99256197e+01  0.00000000e+00]
 [-8.11918523e-03  1.86033905e-02]]
grads:  [-1.92757370e-03 -5.89282094e+00]
Stock Position:  -0.0019275737033186359
Bond Position:  [-0.71129367]


portfolio before change:  [-0.9001162]
curr_Stock_Price:  97.86639292398812
curr_Factors:  [9.78663929e+01 4.17026822e-02]
mat_Sqrt:  [[ 1.99855257e+01  0.00000000e+00]
 [-8.16849384e-03  1.87163707e-02]]
grads:  [-3.06321579e-03 -4.11477218e+00]
Stock Position:  -0.0030632157910488156
Bond Position:  [-0.60033032]


portfolio before change:  [-0.90418634]
curr_Stock_Price:  99.1461086030138
curr_Factors:  [9.91461086e+01 4.12791741e-02]
mat_Sqrt:  [[ 2.01437894e+01  0.00000000e+00]
 [-8.12691076e-03  1.86210919e-02]]
grads:  [-0.0461752  39.45308294]
Stock Position:  -0.04617519724950816
Bond Position:  [3.67390478]


portfolio before change:  [-0.95748046]
curr_Stock_Price:  100.3201741146271
curr_Factors:  [1.00320174e+02 4.17856943e-02]
mat_Sqrt:  [[ 2.05069980e+01  0.00000000e+00]
 [-8.17661977e-03  1.87349895e-02]]
grads:  [ 2.48419404e-03 -3.99435999e+00]
Stock Position:  0.002484194036602998
Bond Position:  [-1.20669524]


portfolio before change:  [-0.95665548]
curr_Stock_Price:  100.77371955381005
curr_Factors:  [1.0077372e+02 4.3217658e-02]
mat_Sqrt:  [[ 2.09497046e+01  0.00000000e+00]
 [-8.31554285e-03  1.90533023e-02]]
grads:  [0.00503335 4.52512302]
Stock Position:  0.005033349491895472
Bond Position:  [-1.46388483]


portfolio before change:  [-0.95532615]
curr_Stock_Price:  101.11054159418643
curr_Factors:  [1.01110542e+02 4.32431413e-02]
mat_Sqrt:  [[ 2.10259222e+01  0.00000000e+00]
 [-8.31799411e-03  1.90589188e-02]]
grads:  [-0.00761523 -5.10841038]
Stock Position:  -0.00761522596960701
Bond Position:  [-0.18534653]


portfolio before change:  [-0.95917966]
curr_Stock_Price:  101.6104831277722
curr_Factors:  [1.01610483e+02 4.17673743e-02]
mat_Sqrt:  [[ 2.07662034e+01  0.00000000e+00]
 [-8.17482714e-03  1.87308821e-02]]
grads:  [ 0.00050797 -0.48931739]
Stock Position:  0.0005079731769952328
Bond Position:  [-1.01079506]


portfolio before change:  [-0.96011543]
curr_Stock_Price:  100.26584286290489
curr_Factors:  [1.00265843e+02 4.25701902e-02]
mat_Sqrt:  [[ 2.06873949e+01  0.00000000e+00]
 [-8.25301790e-03  1.89100396e-02]]
grads:  [ 0.00677554 -1.08645347]
Stock Position:  0.006775538920747675
Bond Position:  [-1.63947055]


portfolio before change:  [-0.96611232]
curr_Stock_Price:  99.44126280550051
curr_Factors:  [9.94412628e+01 4.38498299e-02]
mat_Sqrt:  [[ 2.08233494e+01  0.00000000e+00]
 [-8.37614039e-03  1.91921487e-02]]
grads:  [5.64488875e-04 9.64153930e-01]
Stock Position:  0.0005644888745396526
Bond Position:  [-1.02224581]


portfolio before change:  [-0.96681755]
curr_Stock_Price:  98.64473666343768
curr_Factors:  [9.86447367e+01 4.49256029e-02]
mat_Sqrt:  [[ 2.09084036e+01  0.00000000e+00]
 [-8.47826425e-03  1.94261438e-02]]
grads:  [-0.00086785 -0.525999  ]
Stock Position:  -0.0008678546575678234
Bond Position:  [-0.88120825]


portfolio before change:  [-0.96874103]
curr_Stock_Price:  100.60722551602632
curr_Factors:  [1.00607226e+02 4.65880531e-02]
mat_Sqrt:  [[ 2.17153310e+01  0.00000000e+00]
 [-8.63370633e-03  1.97823064e-02]]
grads:  [-0.00913466 -6.59493171]
Stock Position:  -0.00913466154042322
Bond Position:  [-0.04972808]


portfolio before change:  [-0.97325536]
curr_Stock_Price:  101.10006195538944
curr_Factors:  [1.01100062e+02 4.67360290e-02]
mat_Sqrt:  [[ 2.18563344e+01  0.00000000e+00]
 [-8.64740692e-03  1.98136984e-02]]
grads:  [-1.74671404e-02 -2.41963578e+01]
Stock Position:  -0.017467140429756
Bond Position:  [0.79267362]


portfolio before change:  [-1.0019215]
curr_Stock_Price:  102.75255521709795
curr_Factors:  [1.02752555e+02 4.45309915e-02]
mat_Sqrt:  [[ 2.16832218e+01  0.00000000e+00]
 [-8.44094701e-03  1.93406393e-02]]
grads:  [-4.64499486e-03 -8.34465741e+00]
Stock Position:  -0.004644994858843095
Bond Position:  [-0.52463641]


portfolio before change:  [-0.98940156]
curr_Stock_Price:  100.02895471348161
curr_Factors:  [1.00028955e+02 4.66225453e-02]
mat_Sqrt:  [[ 2.15985064e+01  0.00000000e+00]
 [-8.63690179e-03  1.97896281e-02]]
grads:  [ 4.77049032e-04 -5.55928262e+00]
Stock Position:  0.0004770490322557276
Bond Position:  [-1.03712028]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.98790462]
Stock Price:  103.71046176467743
PL:  [-4.69836638]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [-2.78031510e-03  1.27180720e-01]
 [ 7.74235681e-02 -9.72120985e-03]
 [ 7.56694391e-01 -2.94959707e-01]
 [-9.27024840e-02 -9.64562583e-02]
 [ 3.65144958e-01 -1.54212700e-02]
 [-1.14027817e-01 -2.04664411e-01]
 [-4.32463013e-02 -9.94754805e-02]
 [-1.26745244e+00  7.05033775e-01]
 [ 6.81187273e-02 -4.24416710e-02]
 [ 1.62083265e-02 -8.34519598e-02]
 [ 3.98294021e-02  2.29165365e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.57803540e-01 -2.41481513e-02]
 [ 9.02766059e-02  1.46846240e-01]
 [-1.16233584e-01 -6.18729597e-02]
 [-1.02321586e-01 -1.07914179e-01]
 [-1.55648308e-01 -5.57948455e-01]
 [-7.31928180e-02 -1.51374228e-01]
 [ 1.27581030e-01 -8.79996063e-03]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.19765997]
curr_Stock_Price:  99.6344430308582
curr_Factors:  [9.96344430e+01 4.18569633e-02]
mat_Sqrt:  [[ 2.03841852e+01  0.00000000e+00]
 [-8.18358975e-03  1.87509598e-02]]
grads:  [2.58660825e-03 6.78262454e+00]
Stock Position:  0.0025866082511424287
Bond Position:  [-0.0600553]


portfolio before change:  [0.20119635]
curr_Stock_Price:  101.00743713980013
curr_Factors:  [1.01007437e+02 4.27684249e-02]
mat_Sqrt:  [[ 2.08888716e+01  0.00000000e+00]
 [-8.27221130e-03  1.89540172e-02]]
grads:  [ 0.00350334 -0.51288388]
Stock Position:  0.0035033431119257416
Bond Position:  [-0.15266736]


portfolio before change:  [0.19926358]
curr_Stock_Price:  100.46663867769415
curr_Factors:  [1.00466639e+02 4.51573148e-02]
mat_Sqrt:  [[ 2.13494124e+01  0.00000000e+00]
 [-8.50010021e-03  1.94761763e-02]]
grads:  [  0.02941362 -15.14464143]
Stock Position:  0.029413616113460078
Bond Position:  [-2.75582357]


portfolio before change:  [0.0763487]
curr_Stock_Price:  96.31122201497918
curr_Factors:  [9.63112220e+01 4.65152629e-02]
mat_Sqrt:  [[ 2.07718240e+01  0.00000000e+00]
 [-8.62695894e-03  1.97668462e-02]]
grads:  [-0.00648953 -4.87969893]
Stock Position:  -0.006489533453199947
Bond Position:  [0.7013636]


portfolio before change:  [0.08251055]
curr_Stock_Price:  95.38873852105446
curr_Factors:  [9.53887385e+01 4.68385914e-02]
mat_Sqrt:  [[ 2.06442456e+01  0.00000000e+00]
 [-8.65689010e-03  1.98354271e-02]]
grads:  [ 0.01736148 -0.77746095]
Stock Position:  0.01736147544434883
Bond Position:  [-1.57357869]


portfolio before change:  [0.1069202]
curr_Stock_Price:  96.8173667466234
curr_Factors:  [9.68173667e+01 4.48655741e-02]
mat_Sqrt:  [[ 2.05073659e+01  0.00000000e+00]
 [-8.47259810e-03  1.94131611e-02]]
grads:  [-9.91598286e-03 -1.05425598e+01]
Stock Position:  -0.00991598286283932
Bond Position:  [1.06695955]


portfolio before change:  [0.08931365]
curr_Stock_Price:  98.61984325178435
curr_Factors:  [9.86198433e+01 4.34813420e-02]
mat_Sqrt:  [[ 2.05643875e+01  0.00000000e+00]
 [-8.34087209e-03  1.91113389e-02]]
grads:  [-4.21412797e-03 -5.20505032e+00]
Stock Position:  -0.004214127966042856
Bond Position:  [0.50491029]


portfolio before change:  [0.09246801]
curr_Stock_Price:  97.90128181460997
curr_Factors:  [9.79012818e+01 4.21708629e-02]
mat_Sqrt:  [[ 2.01045623e+01  0.00000000e+00]
 [-8.21421820e-03  1.88211383e-02]]
grads:  [-0.04773794 37.45967766]
Stock Position:  -0.04773794431209055
Bond Position:  [4.76607394]


portfolio before change:  [0.08190272]
curr_Stock_Price:  98.14756286140118
curr_Factors:  [9.81475629e+01 4.22232823e-02]
mat_Sqrt:  [[ 2.01676602e+01  0.00000000e+00]
 [-8.21932185e-03  1.88328323e-02]]
grads:  [ 0.00245917 -2.25360001]
Stock Position:  0.0024591679463366427
Bond Position:  [-0.15945862]


portfolio before change:  [0.07940595]
curr_Stock_Price:  97.14848366932979
curr_Factors:  [9.71484837e+01 4.08017018e-02]
mat_Sqrt:  [[ 1.96234411e+01  0.00000000e+00]
 [-8.07977245e-03  1.85130844e-02]]
grads:  [-1.03004843e-03 -4.50772858e+00]
Stock Position:  -0.001030048430846986
Bond Position:  [0.17947359]


portfolio before change:  [0.07848614]
curr_Stock_Price:  98.0850231411914
curr_Factors:  [9.80850231e+01 3.97677716e-02]
mat_Sqrt:  [[ 1.95599764e+01  0.00000000e+00]
 [-7.97674335e-03  1.82770151e-02]]
grads:  [7.14956726e-03 1.25384459e+01]
Stock Position:  0.007149567264145126
Bond Position:  [-0.62277933]


portfolio before change:  [0.07409654]
curr_Stock_Price:  97.49283501022391
curr_Factors:  [9.74928350e+01 3.86492069e-02]
mat_Sqrt:  [[ 1.91665079e+01  0.00000000e+00]
 [-7.86376061e-03  1.80181391e-02]]
grads:  [ 0.00250523 -0.47681854]
Stock Position:  0.0025052283151258555
Bond Position:  [-0.17014527]


portfolio before change:  [0.0801934]
curr_Stock_Price:  99.94347282381563
curr_Factors:  [9.99434728e+01 3.66055609e-02]
mat_Sqrt:  [[ 1.91217647e+01  0.00000000e+00]
 [-7.65303191e-03  1.75352990e-02]]
grads:  [ 0.0077014 -1.3771166]
Stock Position:  0.007701403337104227
Bond Position:  [-0.68951159]


portfolio before change:  [0.08992669]
curr_Stock_Price:  101.22969045905387
curr_Factors:  [1.01229690e+02 3.46246655e-02]
mat_Sqrt:  [[ 1.88365213e+01  0.00000000e+00]
 [-7.44308167e-03  1.70542426e-02]]
grads:  [8.19501418e-03 8.61054015e+00]
Stock Position:  0.008195014176320447
Bond Position:  [-0.73965206]


portfolio before change:  [0.11007185]
curr_Stock_Price:  103.71047953187994
curr_Factors:  [1.03710480e+02 3.46043858e-02]
mat_Sqrt:  [[ 1.92924869e+01  0.00000000e+00]
 [-7.44090164e-03  1.70492475e-02]]
grads:  [-0.0074245  -3.62907276]
Stock Position:  -0.007424504575683645
Bond Position:  [0.88007078]


portfolio before change:  [0.10866416]
curr_Stock_Price:  103.929718496469
curr_Factors:  [1.03929718e+02 3.47684754e-02]
mat_Sqrt:  [[ 1.93790541e+01  0.00000000e+00]
 [-7.45852268e-03  1.70896224e-02]]
grads:  [-0.00771035 -6.31460291]
Stock Position:  -0.007710345122634801
Bond Position:  [0.90999815]


portfolio before change:  [0.11348156]
curr_Stock_Price:  103.3344298526325
curr_Factors:  [1.03334430e+02 3.60533978e-02]
mat_Sqrt:  [[ 1.96208649e+01  0.00000000e+00]
 [-7.59509292e-03  1.74025441e-02]]
grads:  [-2.03434955e-02 -3.20613154e+01]
Stock Position:  -0.02034349554650145
Bond Position:  [2.21566508]


portfolio before change:  [0.11984767]
curr_Stock_Price:  103.0487306038369
curr_Factors:  [1.03048731e+02 3.67918266e-02]
mat_Sqrt:  [[ 1.97659786e+01  0.00000000e+00]
 [-7.67247826e-03  1.75798562e-02]]
grads:  [-7.04533533e-03 -8.61066363e+00]
Stock Position:  -0.007045335325520364
Bond Position:  [0.84586053]


portfolio before change:  [0.12757655]
curr_Stock_Price:  101.98172863290404
curr_Factors:  [1.01981729e+02 3.43897181e-02]
mat_Sqrt:  [[ 1.89119660e+01  0.00000000e+00]
 [-7.41778599e-03  1.69962829e-02]]
grads:  [ 0.00654297 -0.51775795]
Stock Position:  0.006542969280117134
Bond Position:  [-0.53968677]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.1313064]
Stock Price:  102.57240723367228
PL:  [-2.44110083]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [-1.97471824e-03  6.69935556e-03]
 [-2.35897260e-01  1.78378201e-01]
 [ 9.29073057e-01 -3.47570314e-01]
 [ 4.07131082e-01 -5.38201487e-02]
 [ 1.78606363e-01 -2.82251892e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-3.10979110e-01 -1.49514126e-01]
 [-1.32819530e+00  7.41812142e-01]
 [ 3.04600797e-02 -8.03367267e-02]
 [ 1.65867861e-01  6.92925810e-01]
 [-5.21313622e-01 -1.14349448e-01]
 [-4.09118007e-02 -9.83066502e-02]
 [-2.14724215e-02 -7.97775561e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.14291772e-01 -6.07708775e-02]
 [ 1.05274547e-01  2.46971760e-02]
 [-8.17909182e-02 -7.03992119e-01]
 [-3.99515362e-01  1.14257154e-01]
 [-4.83986343e-02 -8.48274088e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.72968989]
curr_Stock_Price:  103.02831173130275
curr_Factors:  [1.03028312e+02 3.75782803e-02]
mat_Sqrt:  [[ 1.99721599e+01  0.00000000e+00]
 [-7.75404723e-03  1.77667542e-02]]
grads:  [4.75221626e-05 3.77072564e-01]
Stock Position:  4.752216256703707e-05
Bond Position:  [22.72479376]


portfolio before change:  [22.73537331]
curr_Stock_Price:  103.05996187494517
curr_Factors:  [1.03059962e+02 3.88856858e-02]
mat_Sqrt:  [[ 2.03228616e+01  0.00000000e+00]
 [-7.88778152e-03  1.80731779e-02]]
grads:  [-7.77679021e-03  9.86977509e+00]
Stock Position:  -0.007776790210326359
Bond Position:  [23.53684901]


portfolio before change:  [22.73334156]
curr_Stock_Price:  104.077951746118
curr_Factors:  [1.04077952e+02 3.76177464e-02]
mat_Sqrt:  [[ 2.01862257e+01  0.00000000e+00]
 [-7.75811796e-03  1.77760814e-02]]
grads:  [  0.03851046 -19.5526959 ]
Stock Position:  0.038510464964399464
Bond Position:  [18.72525125]


portfolio before change:  [22.72943328]
curr_Stock_Price:  103.85489085235821
curr_Factors:  [1.03854891e+02 3.80315119e-02]
mat_Sqrt:  [[ 2.02534377e+01  0.00000000e+00]
 [-7.80066786e-03  1.78735755e-02]]
grads:  [ 0.01894207 -3.01115738]
Stock Position:  0.01894207043515816
Bond Position:  [20.76220662]


portfolio before change:  [22.71863644]
curr_Stock_Price:  103.01084181725085
curr_Factors:  [1.03010842e+02 3.89060632e-02]
mat_Sqrt:  [[ 2.03184971e+01  0.00000000e+00]
 [-7.88984798e-03  1.80779128e-02]]
grads:  [ 0.00818406 -1.56130796]
Stock Position:  0.008184064017146588
Bond Position:  [21.87558912]


portfolio before change:  [22.72134956]
curr_Stock_Price:  102.6740334510745
curr_Factors:  [1.02674033e+02 3.97103643e-02]
mat_Sqrt:  [[ 2.04603265e+01  0.00000000e+00]
 [-7.97098381e-03  1.82638183e-02]]
grads:  [-2.83290767e-05 -1.05953617e+00]
Stock Position:  -2.8329076657080605e-05
Bond Position:  [22.72425822]


portfolio before change:  [22.7270053]
curr_Stock_Price:  103.59326307284617
curr_Factors:  [1.03593263e+02 3.94100189e-02]
mat_Sqrt:  [[ 2.05652898e+01  0.00000000e+00]
 [-7.94078272e-03  1.81946190e-02]]
grads:  [-0.01829454 -8.21749148]
Stock Position:  -0.01829453546089451
Bond Position:  [24.62219592]


portfolio before change:  [22.77704556]
curr_Stock_Price:  101.19451722368932
curr_Factors:  [1.01194517e+02 4.07286667e-02]
mat_Sqrt:  [[ 2.04224142e+01  0.00000000e+00]
 [-8.07253781e-03  1.84965078e-02]]
grads:  [-0.04918331 40.10552426]
Stock Position:  -0.04918331053242524
Bond Position:  [27.75412692]


portfolio before change:  [22.60147144]
curr_Stock_Price:  104.90540028607609
curr_Factors:  [1.04905400e+02 3.75306794e-02]
mat_Sqrt:  [[ 2.03231517e+01  0.00000000e+00]
 [-7.74913460e-03  1.77554979e-02]]
grads:  [-2.26428576e-04 -4.52461131e+00]
Stock Position:  -0.00022642857645180177
Bond Position:  [22.62522502]


portfolio before change:  [22.60679742]
curr_Stock_Price:  106.36736155488951
curr_Factors:  [1.06367362e+02 3.68148100e-02]
mat_Sqrt:  [[ 2.04089033e+01  0.00000000e+00]
 [-7.67487433e-03  1.75853463e-02]]
grads:  [2.29451563e-02 3.94035920e+01]
Stock Position:  0.02294515633948406
Bond Position:  [20.16618168]


portfolio before change:  [22.6135516]
curr_Stock_Price:  106.4419740733397
curr_Factors:  [1.06441974e+02 3.75020733e-02]
mat_Sqrt:  [[ 2.06129694e+01  0.00000000e+00]
 [-7.74618082e-03  1.77487300e-02]]
grads:  [-0.02771167 -6.44268339]
Stock Position:  -0.027711670297129117
Bond Position:  [25.56323649]


portfolio before change:  [22.57572852]
curr_Stock_Price:  108.03749970804189
curr_Factors:  [1.08037500e+02 3.79787865e-02]
mat_Sqrt:  [[ 2.10545065e+01  0.00000000e+00]
 [-7.79525872e-03  1.78611816e-02]]
grads:  [-3.98092162e-03 -5.50392760e+00]
Stock Position:  -0.0039809216241557645
Bond Position:  [23.00581734]


portfolio before change:  [22.58933433]
curr_Stock_Price:  106.06468245429285
curr_Factors:  [1.06064682e+02 4.06450881e-02]
mat_Sqrt:  [[ 2.13833050e+01  0.00000000e+00]
 [-8.06425080e-03  1.84775199e-02]]
grads:  [-2.63243691e-03 -4.31754676e+00]
Stock Position:  -0.0026324369131198815
Bond Position:  [22.86854291]


portfolio before change:  [22.59111529]
curr_Stock_Price:  107.56021392143874
curr_Factors:  [1.07560214e+02 3.87394098e-02]
mat_Sqrt:  [[ 2.11703558e+01  0.00000000e+00]
 [-7.87293183e-03  1.80391530e-02]]
grads:  [7.19105258e-03 8.23642269e+00]
Stock Position:  0.0071910525835363085
Bond Position:  [21.81764413]


portfolio before change:  [22.60123614]
curr_Stock_Price:  108.20904320694194
curr_Factors:  [1.08209043e+02 3.75073772e-02]
mat_Sqrt:  [[ 2.09566522e+01  0.00000000e+00]
 [-7.74672857e-03  1.77499850e-02]]
grads:  [-0.00671932 -3.4237143 ]
Stock Position:  -0.006719315498651345
Bond Position:  [23.32832685]


portfolio before change:  [22.59389548]
curr_Stock_Price:  110.16958154079778
curr_Factors:  [1.10169582e+02 3.55936356e-02]
mat_Sqrt:  [[ 2.07848969e+01  0.00000000e+00]
 [-7.54651025e-03  1.72912272e-02]]
grads:  [0.00558354 1.42830672]
Stock Position:  0.005583538819423201
Bond Position:  [21.97875934]


portfolio before change:  [22.60217908]
curr_Stock_Price:  110.66894597152822
curr_Factors:  [1.10668946e+02 3.68708353e-02]
mat_Sqrt:  [[ 2.12504075e+01  0.00000000e+00]
 [-7.68071197e-03  1.75987220e-02]]
grads:  [-1.83073322e-02 -4.00024569e+01]
Stock Position:  -0.018307332160623944
Bond Position:  [24.62823223]


portfolio before change:  [22.60554415]
curr_Stock_Price:  110.82149424757472
curr_Factors:  [1.10821494e+02 3.52539402e-02]
mat_Sqrt:  [[ 2.08078799e+01  0.00000000e+00]
 [-7.51041306e-03  1.72085182e-02]]
grads:  [-0.0168037   6.63956959]
Stock Position:  -0.016803703843366546
Bond Position:  [24.46775572]


portfolio before change:  [22.62635839]
curr_Stock_Price:  109.94689365302737
curr_Factors:  [1.09946894e+02 3.72003373e-02]
mat_Sqrt:  [[ 2.12058850e+01  0.00000000e+00]
 [-7.71495558e-03  1.76771840e-02]]
grads:  [-4.02814363e-03 -4.79869468e+00]
Stock Position:  -0.004028143629264599
Bond Position:  [23.06924027]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.63148581]
Stock Price:  110.10592655466442
PL:  [12.52555926]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.74648311e-02  3.77343197e-02]
 [ 9.16050927e-04  3.27042335e-02]
 [ 7.09356115e-01 -2.80511890e-01]
 [-1.04026865e-01 -9.56528656e-02]
 [ 2.51419653e-01 -7.52510156e-03]
 [ 1.07279043e-02 -1.06818612e-01]
 [-5.08542433e-02 -1.10401576e-01]
 [-1.24918274e+00  7.34522890e-01]
 [ 8.32232243e-02 -6.40130046e-02]
 [ 3.49132612e-02 -5.23468194e-02]
 [-6.27844623e-02 -5.26175340e-02]
 [ 2.58183771e-02 -8.99154690e-03]
 [ 1.65249562e-01 -2.87538267e-02]
 [ 4.42561489e-04  1.45005154e-02]
 [-1.17720532e-01 -6.27168821e-02]
 [-1.39977326e-01 -1.23968937e-01]
 [-1.69766220e-01 -4.93721115e-01]
 [ 2.78399928e-01 -2.41989811e-01]
 [ 9.74222698e-02 -7.15643601e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.83796659]
curr_Stock_Price:  100.63463381979678
curr_Factors:  [1.00634634e+02 4.03095062e-02]
mat_Sqrt:  [[ 2.02046443e+01  0.00000000e+00]
 [-8.03089098e-03  1.84010829e-02]]
grads:  [1.67948704e-03 2.05065756e+00]
Stock Position:  0.0016794870419458653
Bond Position:  [6.66895202]


portfolio before change:  [6.84149314]
curr_Stock_Price:  101.74158124183647
curr_Factors:  [1.01741581e+02 4.10676421e-02]
mat_Sqrt:  [[ 2.06180870e+01  0.00000000e+00]
 [-8.10606115e-03  1.85733194e-02]]
grads:  [7.36700190e-04 1.76081791e+00]
Stock Position:  0.0007367001897926456
Bond Position:  [6.76654009]


portfolio before change:  [6.84221378]
curr_Stock_Price:  100.42326354234996
curr_Factors:  [1.00423264e+02 3.93067473e-02]
mat_Sqrt:  [[ 1.99098452e+01  0.00000000e+00]
 [-7.93037172e-03  1.81707644e-02]]
grads:  [  0.02947942 -15.43753936]
Stock Position:  0.02947941998807476
Bond Position:  [3.88179421]


portfolio before change:  [6.79820843]
curr_Stock_Price:  98.89759185840416
curr_Factors:  [9.88975919e+01 3.90483809e-02]
mat_Sqrt:  [[ 1.95428200e+01  0.00000000e+00]
 [-7.90426527e-03  1.81109470e-02]]
grads:  [-0.00745917 -5.28149444]
Stock Position:  -0.007459169056087525
Bond Position:  [7.53590229]


portfolio before change:  [6.80402873]
curr_Stock_Price:  98.36990720269364
curr_Factors:  [9.83699072e+01 3.82461431e-02]
mat_Sqrt:  [[ 1.92378301e+01  0.00000000e+00]
 [-7.82264846e-03  1.79239394e-02]]
grads:  [ 0.01289831 -0.41983525]
Stock Position:  0.012898306514982055
Bond Position:  [5.53522352]


portfolio before change:  [6.80350811]
curr_Stock_Price:  98.22224411576627
curr_Factors:  [9.82222441e+01 3.82946672e-02]
mat_Sqrt:  [[ 1.92211338e+01  0.00000000e+00]
 [-7.82760932e-03  1.79353061e-02]]
grads:  [-1.86729670e-03 -5.95577299e+00]
Stock Position:  -0.0018672967027021272
Bond Position:  [6.98691818]


portfolio before change:  [6.80381234]
curr_Stock_Price:  98.99486676525311
curr_Factors:  [9.89948668e+01 3.99784806e-02]
mat_Sqrt:  [[ 1.97936469e+01  0.00000000e+00]
 [-7.99784777e-03  1.83253714e-02]]
grads:  [-5.00349642e-03 -6.02452050e+00]
Stock Position:  -0.005003496419910914
Bond Position:  [7.2991328]


portfolio before change:  [6.80510195]
curr_Stock_Price:  99.10187216948582
curr_Factors:  [9.91018722e+01 4.11919894e-02]
mat_Sqrt:  [[ 2.01135274e+01  0.00000000e+00]
 [-8.11832390e-03  1.86014169e-02]]
grads:  [-0.04616846 39.48746992]
Stock Position:  -0.04616846403984934
Bond Position:  [11.38048317]


portfolio before change:  [6.79589349]
curr_Stock_Price:  99.36295798979363
curr_Factors:  [9.93629580e+01 4.16351319e-02]
mat_Sqrt:  [[ 2.02747022e+01  0.00000000e+00]
 [-8.16187546e-03  1.87012061e-02]]
grads:  [ 2.72682963e-03 -3.42293456e+00]
Stock Position:  0.0027268296251867306
Bond Position:  [6.52494764]


portfolio before change:  [6.79891193]
curr_Stock_Price:  99.87160502454134
curr_Factors:  [9.9871605e+01 4.1805004e-02]
mat_Sqrt:  [[ 2.04200200e+01  0.00000000e+00]
 [-8.17850881e-03  1.87393178e-02]]
grads:  [ 5.90951240e-04 -2.79342182e+00]
Stock Position:  0.000590951240059505
Bond Position:  [6.73989268]


portfolio before change:  [6.80071028]
curr_Stock_Price:  100.06311149483845
curr_Factors:  [1.00063111e+02 4.12331303e-02]
mat_Sqrt:  [[ 2.03187579e+01  0.00000000e+00]
 [-8.12237702e-03  1.86107038e-02]]
grads:  [-0.00422017 -2.82727267]
Stock Position:  -0.004220171186912818
Bond Position:  [7.22299374]


portfolio before change:  [6.80232506]
curr_Stock_Price:  100.10841786254609
curr_Factors:  [1.00108418e+02 4.02296829e-02]
mat_Sqrt:  [[ 2.00790843e+01  0.00000000e+00]
 [-8.02293541e-03  1.83828544e-02]]
grads:  [ 0.0010904  -0.48912681]
Stock Position:  0.0010903955590618184
Bond Position:  [6.69316728]


portfolio before change:  [6.80211693]
curr_Stock_Price:  98.38277748479203
curr_Factors:  [9.83827775e+01 4.07394402e-02]
mat_Sqrt:  [[ 1.98575931e+01  0.00000000e+00]
 [-8.07360541e-03  1.84989540e-02]]
grads:  [ 0.00768977 -1.55434879]
Stock Position:  0.007689771962627985
Bond Position:  [6.0455758]


portfolio before change:  [6.81125922]
curr_Stock_Price:  99.37509632943737
curr_Factors:  [9.93750963e+01 3.97088126e-02]
mat_Sqrt:  [[ 1.98025452e+01  0.00000000e+00]
 [-7.97082807e-03  1.82634615e-02]]
grads:  [3.41931059e-04 7.93963149e-01]
Stock Position:  0.0003419310589713568
Bond Position:  [6.77727978]


portfolio before change:  [6.81347612]
curr_Stock_Price:  100.90282094409677
curr_Factors:  [1.00902821e+02 4.04791504e-02]
mat_Sqrt:  [[ 2.03010734e+01  0.00000000e+00]
 [-8.04777240e-03  1.84397631e-02]]
grads:  [-0.00714703 -3.40117613]
Stock Position:  -0.007147032072337056
Bond Position:  [7.53463182]


portfolio before change:  [6.80430423]
curr_Stock_Price:  102.44972703062626
curr_Factors:  [1.02449727e+02 4.14512214e-02]
mat_Sqrt:  [[ 2.08583270e+01  0.00000000e+00]
 [-8.14382921e-03  1.86598569e-02]]
grads:  [-0.00930476 -6.6436167 ]
Stock Position:  -0.00930476380568351
Bond Position:  [7.75757474]


portfolio before change:  [6.81547275]
curr_Stock_Price:  101.45788203184286
curr_Factors:  [1.01457882e+02 4.36277360e-02]
mat_Sqrt:  [[ 2.11917650e+01  0.00000000e+00]
 [-8.35490141e-03  1.91434841e-02]]
grads:  [-1.81789379e-02 -2.57905569e+01]
Stock Position:  -0.018178937858951028
Bond Position:  [8.65986928]


portfolio before change:  [6.84964673]
curr_Stock_Price:  99.69712202186462
curr_Factors:  [9.96971220e+01 4.31792451e-02]
mat_Sqrt:  [[ 2.07166794e+01  0.00000000e+00]
 [-8.31184650e-03  1.90448329e-02]]
grads:  [ 8.34047356e-03 -1.27063237e+01]
Stock Position:  0.008340473560422048
Bond Position:  [6.01812552]


portfolio before change:  [6.86237183]
curr_Stock_Price:  101.04241440801447
curr_Factors:  [1.01042414e+02 4.31131208e-02]
mat_Sqrt:  [[ 2.09801431e+01  0.00000000e+00]
 [-8.30547971e-03  1.90302447e-02]]
grads:  [ 3.15484133e-03 -3.76055910e+00]
Stock Position:  0.0031548413269480995
Bond Position:  [6.54359904]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.86566296]
Stock Price:  101.56701276863043
PL:  [5.29865019]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 8.46505366e-03  1.95368309e-02]
 [ 7.16177292e-02 -1.30420994e-02]
 [ 6.09113691e-01 -2.49917531e-01]
 [-8.66458909e-02 -9.33807652e-02]
 [ 1.91594472e-01 -5.54700408e-03]
 [ 7.86592350e-03 -1.93511761e-02]
 [-3.84322628e-01 -1.28551910e-01]
 [-1.45042281e+00  7.53674921e-01]
 [ 3.77404809e-02 -7.64436820e-02]
 [ 1.35369512e-01  4.22591508e-01]
 [-1.99313840e-01 -2.64756860e-02]
 [-2.04585841e-02 -1.08227041e-02]
 [ 1.48602713e-02 -5.40380523e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.16795747e-01 -6.21920173e-02]
 [-9.43453522e-02 -1.04534172e-01]
 [-1.46137783e-01 -5.88574253e-01]
 [-1.82140428e-01 -8.08106603e-02]
 [ 1.58498803e-01  7.23972181e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.86916901]
curr_Stock_Price:  101.69370297172671
curr_Factors:  [1.01693703e+02 3.84185689e-02]
mat_Sqrt:  [[ 1.99326322e+01  0.00000000e+00]
 [-7.84026213e-03  1.79642973e-02]]
grads:  [8.52452678e-04 1.08753660e+00]
Stock Position:  0.0008524526775102199
Bond Position:  [13.78247994]


portfolio before change:  [13.87134069]
curr_Stock_Price:  100.1987607572802
curr_Factors:  [1.00198761e+02 3.95236233e-02]
mat_Sqrt:  [[ 1.99200638e+01  0.00000000e+00]
 [-7.95221964e-03  1.82208242e-02]]
grads:  [ 0.00330951 -0.71577988]
Stock Position:  0.0033095120041360367
Bond Position:  [13.53973169]


portfolio before change:  [13.86964026]
curr_Stock_Price:  98.66204213717702
curr_Factors:  [9.86620421e+01 4.08791662e-02]
mat_Sqrt:  [[ 1.99480806e+01  0.00000000e+00]
 [-8.08743878e-03  1.85306502e-02]]
grads:  [  0.02506711 -13.48671139]
Stock Position:  0.025067110326736728
Bond Position:  [11.39646796]


portfolio before change:  [13.88255604]
curr_Stock_Price:  99.0636167450293
curr_Factors:  [9.90636167e+01 4.13916546e-02]
mat_Sqrt:  [[ 2.01544325e+01  0.00000000e+00]
 [-8.13797563e-03  1.86464447e-02]]
grads:  [-0.00632122 -5.00796623]
Stock Position:  -0.006321219823464457
Bond Position:  [14.50875894]


portfolio before change:  [13.88533978]
curr_Stock_Price:  99.19712148288576
curr_Factors:  [9.91971215e+01 3.99574659e-02]
mat_Sqrt:  [[ 1.98288733e+01  0.00000000e+00]
 [-7.99574546e-03  1.83205544e-02]]
grads:  [ 0.00954031 -0.3027749 ]
Stock Position:  0.009540308094281944
Bond Position:  [12.93896867]


portfolio before change:  [13.92807457]
curr_Stock_Price:  103.33741203603496
curr_Factors:  [1.03337412e+02 3.74001413e-02]
mat_Sqrt:  [[ 1.99845421e+01  0.00000000e+00]
 [-7.73564646e-03  1.77245927e-02]]
grads:  [-2.90035245e-05 -1.09176986e+00]
Stock Position:  -2.900352447652962e-05
Bond Position:  [13.93107172]


portfolio before change:  [13.93153024]
curr_Stock_Price:  104.28676344273224
curr_Factors:  [1.04286763e+02 3.59185469e-02]
mat_Sqrt:  [[ 1.97646245e+01  0.00000000e+00]
 [-7.58087561e-03  1.73699682e-02]]
grads:  [-0.02228361 -7.40081435]
Stock Position:  -0.022283614839601305
Bond Position:  [16.25541631]


portfolio before change:  [13.93497857]
curr_Stock_Price:  104.31440850233537
curr_Factors:  [1.04314409e+02 3.45208660e-02]
mat_Sqrt:  [[ 1.93813998e+01  0.00000000e+00]
 [-7.43191668e-03  1.70286604e-02]]
grads:  [-0.05786435 44.25920211]
Stock Position:  -0.05786435025832121
Bond Position:  [19.97106404]


portfolio before change:  [13.95512342]
curr_Stock_Price:  104.05256397757586
curr_Factors:  [1.04052564e+02 3.41063836e-02]
mat_Sqrt:  [[ 1.92163377e+01  0.00000000e+00]
 [-7.38716547e-03  1.69261225e-02]]
grads:  [ 2.27812551e-04 -4.51631389e+00]
Stock Position:  0.00022781255058472888
Bond Position:  [13.93141894]


portfolio before change:  [13.95861435]
curr_Stock_Price:  104.08609338551092
curr_Factors:  [1.04086093e+02 3.28397818e-02]
mat_Sqrt:  [[ 1.88622215e+01  0.00000000e+00]
 [-7.24869995e-03  1.66088581e-02]]
grads:  [1.69547138e-02 2.54437425e+01]
Stock Position:  0.016954713806460533
Bond Position:  [12.19386443]


portfolio before change:  [13.93160489]
curr_Stock_Price:  102.31323480297044
curr_Factors:  [1.02313235e+02 3.34345147e-02]
mat_Sqrt:  [[ 1.87080847e+01  0.00000000e+00]
 [-7.31404290e-03  1.67585776e-02]]
grads:  [-0.01127153 -1.57982895]
Stock Position:  -0.011271532033030811
Bond Position:  [15.08483179]


portfolio before change:  [13.91356517]
curr_Stock_Price:  104.24832198006166
curr_Factors:  [1.04248322e+02 3.49206277e-02]
mat_Sqrt:  [[ 1.94809483e+01  0.00000000e+00]
 [-7.47482470e-03  1.71269750e-02]]
grads:  [-0.00129265 -0.63190985]
Stock Position:  -0.001292647517136494
Bond Position:  [14.0483215]


portfolio before change:  [13.91717163]
curr_Stock_Price:  104.17565057621809
curr_Factors:  [1.04175651e+02 3.34288810e-02]
mat_Sqrt:  [[ 1.90470245e+01  0.00000000e+00]
 [-7.31342667e-03  1.67571657e-02]]
grads:  [-4.58017377e-04 -3.22477282e+00]
Stock Position:  -0.0004580173773529385
Bond Position:  [13.96488589]


portfolio before change:  [13.92148055]
curr_Stock_Price:  102.39129572386352
curr_Factors:  [1.02391296e+02 3.54136584e-02]
mat_Sqrt:  [[ 1.92685235e+01  0.00000000e+00]
 [-7.52740682e-03  1.72474558e-02]]
grads:  [7.90082033e-03 8.61449314e+00]
Stock Position:  0.007900820328238732
Bond Position:  [13.11250532]


portfolio before change:  [13.92511004]
curr_Stock_Price:  102.43571528753955
curr_Factors:  [1.02435715e+02 3.25722619e-02]
mat_Sqrt:  [[ 1.84873798e+01  0.00000000e+00]
 [-7.21911483e-03  1.65410701e-02]]
grads:  [-0.00778577 -3.75985453]
Stock Position:  -0.007785774420205505
Bond Position:  [14.72265141]


portfolio before change:  [13.9147678]
curr_Stock_Price:  104.23686639473975
curr_Factors:  [1.04236866e+02 3.02921044e-02]
mat_Sqrt:  [[ 1.81420379e+01  0.00000000e+00]
 [-6.96185084e-03  1.59516042e-02]]
grads:  [-0.00771511 -6.55320748]
Stock Position:  -0.007715109298179351
Bond Position:  [14.71896662]


portfolio before change:  [13.91516562]
curr_Stock_Price:  104.66231505398152
curr_Factors:  [1.04662315e+02 2.94758822e-02]
mat_Sqrt:  [[ 1.79689931e+01  0.00000000e+00]
 [-6.86741665e-03  1.57352283e-02]]
grads:  [-2.24282264e-02 -3.74048753e+01]
Stock Position:  -0.022428226407960238
Bond Position:  [16.26255572]


portfolio before change:  [13.92667631]
curr_Stock_Price:  104.33038804241981
curr_Factors:  [1.04330388e+02 2.89596849e-02]
mat_Sqrt:  [[ 1.77544711e+01  0.00000000e+00]
 [-6.80701813e-03  1.55968379e-02]]
grads:  [-0.01224532 -5.18122075]
Stock Position:  -0.012245315016745752
Bond Position:  [15.20423477]


portfolio before change:  [13.9338959]
curr_Stock_Price:  104.0512557463544
curr_Factors:  [1.04051256e+02 2.91428205e-02]
mat_Sqrt:  [[ 1.77628691e+01  0.00000000e+00]
 [-6.82850736e-03  1.56460759e-02]]
grads:  [0.01070185 4.62718054]
Stock Position:  0.010701848760306727
Bond Position:  [12.8203551]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.93944342]
Stock Price:  104.27009872905815
PL:  [9.66934469]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 3.52086147e-02  9.82587313e-02]
 [ 8.19154906e-02 -8.28546319e-03]
 [ 7.15254479e-01 -2.82312092e-01]
 [-1.05191797e-01 -9.81424805e-02]
 [ 3.16057217e-01 -1.17873218e-02]
 [-1.76600436e-01 -2.47049604e-01]
 [-5.28787416e-02 -6.01841736e-02]
 [-1.26551022e+00  7.09290620e-01]
 [ 4.49664480e-02 -9.36930342e-03]
 [ 1.97442857e-02 -6.64118026e-02]
 [ 1.08287016e-01  3.04400751e-01]
 [ 5.17660652e-02 -8.59138286e-03]
 [ 1.65575043e-01 -2.88072485e-02]
 [-3.86153711e-03  9.17552642e-03]
 [-9.44160050e-03 -8.07987589e-03]
 [-1.40203740e-01 -1.38521657e-01]
 [-1.97627530e-01 -2.90212803e-01]
 [ 2.66752665e-01 -3.29688096e-01]
 [-1.62408832e-01 -1.66658495e-01]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.56487393]
curr_Stock_Price:  98.76646604460356
curr_Factors:  [9.87664660e+01 4.11151495e-02]
mat_Sqrt:  [[ 2.00267489e+01  0.00000000e+00]
 [-8.11074838e-03  1.85840592e-02]]
grads:  [3.89939682e-03 5.28725884e+00]
Stock Position:  0.003899396817300609
Bond Position:  [-5.95000357]


portfolio before change:  [-5.55945038]
curr_Stock_Price:  100.53885136433509
curr_Factors:  [1.00538851e+02 4.02739368e-02]
mat_Sqrt:  [[ 2.01765060e+01  0.00000000e+00]
 [-8.02734694e-03  1.83929625e-02]]
grads:  [ 0.00388072 -0.4504692 ]
Stock Position:  0.003880722357787853
Bond Position:  [-5.94961375]


portfolio before change:  [-5.56161635]
curr_Stock_Price:  100.36404393763203
curr_Factors:  [1.00364044e+02 4.05762007e-02]
mat_Sqrt:  [[ 2.02168664e+01  0.00000000e+00]
 [-8.05741405e-03  1.84618549e-02]]
grads:  [  0.02928463 -15.2916429 ]
Stock Position:  0.029284626406427795
Bond Position:  [-8.50073988]


portfolio before change:  [-5.60758205]
curr_Stock_Price:  98.86700404497287
curr_Factors:  [9.88670040e+01 4.01999525e-02]
mat_Sqrt:  [[ 1.98227610e+01  0.00000000e+00]
 [-8.01997032e-03  1.83760605e-02]]
grads:  [-0.00746741 -5.34077912]
Stock Position:  -0.007467410193220506
Bond Position:  [-4.86930158]


portfolio before change:  [-5.59287598]
curr_Stock_Price:  96.73459726798237
curr_Factors:  [9.67345973e+01 4.26298336e-02]
mat_Sqrt:  [[ 1.99727859e+01  0.00000000e+00]
 [-8.25879735e-03  1.89232820e-02]]
grads:  [ 0.01556682 -0.6229005 ]
Stock Position:  0.015566822277558876
Bond Position:  [-7.09872626]


portfolio before change:  [-5.60056511]
curr_Stock_Price:  96.35467162492937
curr_Factors:  [9.63546716e+01 4.37633070e-02]
mat_Sqrt:  [[ 2.01570903e+01  0.00000000e+00]
 [-8.36787256e-03  1.91732047e-02]]
grads:  [ -0.01411026 -12.88514923]
Stock Position:  -0.014110256903550384
Bond Position:  [-4.24097594]


portfolio before change:  [-5.58837253]
curr_Stock_Price:  95.41542873729928
curr_Factors:  [9.54154287e+01 4.36778265e-02]
mat_Sqrt:  [[ 1.99411002e+01  0.00000000e+00]
 [-8.35969631e-03  1.91544706e-02]]
grads:  [-0.00396895 -3.14204318]
Stock Position:  -0.00396895194423036
Bond Position:  [-5.20967328]


portfolio before change:  [-5.60019157]
curr_Stock_Price:  98.06511020793384
curr_Factors:  [9.80651102e+01 4.11309813e-02]
mat_Sqrt:  [[ 1.98883638e+01  0.00000000e+00]
 [-8.11230979e-03  1.85876368e-02]]
grads:  [-0.04806581 38.15926827]
Stock Position:  -0.048065814998806196
Bond Position:  [-0.88661213]


portfolio before change:  [-5.51479763]
curr_Stock_Price:  96.28389380120058
curr_Factors:  [9.62838938e+01 4.49023784e-02]
mat_Sqrt:  [[ 2.04027317e+01  0.00000000e+00]
 [-8.47607253e-03  1.94211220e-02]]
grads:  [ 0.00200352 -0.48242853]
Stock Position:  0.0020035233212733553
Bond Position:  [-5.70770466]


portfolio before change:  [-5.51804319]
curr_Stock_Price:  95.37626785806337
curr_Factors:  [9.53762679e+01 4.42264328e-02]
mat_Sqrt:  [[ 2.00577069e+01  0.00000000e+00]
 [-8.41203260e-03  1.92743881e-02]]
grads:  [-4.6068084e-04 -3.4455985e+00]
Stock Position:  -0.0004606808399039505
Bond Position:  [-5.47410517]


portfolio before change:  [-5.52007942]
curr_Stock_Price:  96.82528341516604
curr_Factors:  [9.68252834e+01 4.39327004e-02]
mat_Sqrt:  [[ 2.02947042e+01  0.00000000e+00]
 [-8.38405157e-03  1.92102755e-02]]
grads:  [1.18818383e-02 1.58457255e+01]
Stock Position:  0.011881838345846397
Bond Position:  [-6.67054178]


portfolio before change:  [-5.51407906]
curr_Stock_Price:  97.47065528168561
curr_Factors:  [9.74706553e+01 4.31140884e-02]
mat_Sqrt:  [[ 2.02387409e+01  0.00000000e+00]
 [-8.30557291e-03  1.90304583e-02]]
grads:  [ 0.0023725  -0.45145433]
Stock Position:  0.0023725032411809678
Bond Position:  [-5.7453285]


portfolio before change:  [-5.51388973]
curr_Stock_Price:  98.15594067407862
curr_Factors:  [9.81559407e+01 4.27910942e-02]
mat_Sqrt:  [[ 2.03045461e+01  0.00000000e+00]
 [-8.27440335e-03  1.89590398e-02]]
grads:  [ 0.00753538 -1.51944659]
Stock Position:  0.007535382872015806
Bond Position:  [-6.25353232]


portfolio before change:  [-5.50682235]
curr_Stock_Price:  99.30133196885411
curr_Factors:  [9.93013320e+01 4.29024721e-02]
mat_Sqrt:  [[ 2.05681974e+01  0.00000000e+00]
 [-8.28516478e-03  1.89836974e-02]]
grads:  [6.95203955e-06 4.83337163e-01]
Stock Position:  6.952039547732937e-06
Bond Position:  [-5.50751269]


portfolio before change:  [-5.50820459]
curr_Stock_Price:  98.55441688221714
curr_Factors:  [9.85544169e+01 4.26875911e-02]
mat_Sqrt:  [[ 2.03623040e+01  0.00000000e+00]
 [-8.26439022e-03  1.89360969e-02]]
grads:  [-0.00063686 -0.42669173]
Stock Position:  -0.0006368605170451071
Bond Position:  [-5.44543917]


portfolio before change:  [-5.50803299]
curr_Stock_Price:  96.14709458150863
curr_Factors:  [9.61470946e+01 4.39368684e-02]
mat_Sqrt:  [[ 2.01535109e+01  0.00000000e+00]
 [-8.38444926e-03  1.92111867e-02]]
grads:  [-0.00995656 -7.21046854]
Stock Position:  -0.009956555383059427
Bond Position:  [-4.55073912]


portfolio before change:  [-5.49184538]
curr_Stock_Price:  94.40699081050374
curr_Factors:  [9.44069908e+01 4.35025775e-02]
mat_Sqrt:  [[ 1.96907224e+01  0.00000000e+00]
 [-8.34290860e-03  1.91160051e-02]]
grads:  [ -0.01646901 -15.18166593]
Stock Position:  -0.016469013911550787
Bond Position:  [-3.93705533]


portfolio before change:  [-5.50602266]
curr_Stock_Price:  95.20806466631261
curr_Factors:  [9.52080647e+01 4.23487286e-02]
mat_Sqrt:  [[ 1.95926836e+01  0.00000000e+00]
 [-8.23152269e-03  1.88607879e-02]]
grads:  [ 6.27096248e-03 -1.74800808e+01]
Stock Position:  0.006270962476007918
Bond Position:  [-6.10306886]


portfolio before change:  [-5.50837697]
curr_Stock_Price:  95.07597069376743
curr_Factors:  [9.50759707e+01 4.32979392e-02]
mat_Sqrt:  [[ 1.97835571e+01  0.00000000e+00]
 [-8.32326274e-03  1.90709908e-02]]
grads:  [-0.01188586 -8.73884829]
Stock Position:  -0.011885858596554803
Bond Position:  [-4.37831743]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.49288687]
Stock Price:  93.68062997997836
PL:  [-5.49288687]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 1.54275948e+02 -4.92515743e+01]
 [ 1.05151473e-02  2.20577697e-02]
 [ 8.04460045e-02 -1.03063648e-02]
 [ 7.72062277e-01 -2.99650042e-01]
 [ 2.54821127e-01 -1.01319284e-01]
 [ 1.69201907e-01 -2.75497917e-02]
 [ 7.86592350e-03 -1.93511761e-02]
 [-1.67962273e-01 -1.92889273e-01]
 [-1.30331473e+00  7.39729807e-01]
 [ 4.54974163e-02 -7.38633975e-02]
 [ 1.36618768e-01  4.33731074e-01]
 [-4.18238595e-01 -7.69931703e-02]
 [-2.96251027e-02 -1.15119448e-02]
 [-6.00989998e-03 -6.88239684e-02]
 [ 8.73923474e-02  1.48578089e-01]
 [-1.15933035e-01 -6.17023819e-02]
 [-5.04212852e-02 -8.39146650e-02]
 [-1.34170794e-01 -6.22758753e-01]
 [-4.16829224e-01  5.58385812e-02]
 [ 2.53274499e-02 -8.17819760e-02]]
curr_Factors:  [1.e+02 4.e-02]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [154.27594847 -49.25157427]
mat_Sqrt:  [[ 2.00000000e+01  0.00000000e+00]
 [-8.00000000e-03  1.83303028e-02]]
grads:  [    6.63903996 -2686.89365693]
init_Out:  [2.78990648]
Stock Position:  6.639039960651402
Bond position:  [-661.11408959]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.1292453]
curr_Stock_Price:  101.43162837641799
curr_Factors:  [1.01431628e+02 3.88948084e-02]
mat_Sqrt:  [[ 2.00041092e+01  0.00000000e+00]
 [-7.88870670e-03  1.80752978e-02]]
grads:  [1.00689049e-03 1.22032676e+00]
Stock Position:  0.001006890486083216
Bond Position:  [12.02711475]


portfolio before change:  [12.13173046]
curr_Stock_Price:  100.91320721556325
curr_Factors:  [1.00913207e+02 3.89763794e-02]
mat_Sqrt:  [[ 1.99227257e+01  0.00000000e+00]
 [-7.89697455e-03  1.80942418e-02]]
grads:  [ 0.00381213 -0.56959363]
Stock Position:  0.003812125873127903
Bond Position:  [11.74703661]


portfolio before change:  [12.1371552]
curr_Stock_Price:  101.56576038292263
curr_Factors:  [1.01565760e+02 3.92003582e-02]
mat_Sqrt:  [[ 2.01090865e+01  0.00000000e+00]
 [-7.91963214e-03  1.81461569e-02]]
grads:  [  0.03189027 -16.51314075]
Stock Position:  0.03189027391241291
Bond Position:  [8.89819528]


portfolio before change:  [12.14941083]
curr_Stock_Price:  101.88030146251398
curr_Factors:  [1.01880301e+02 3.90213406e-02]
mat_Sqrt:  [[ 2.01252514e+01  0.00000000e+00]
 [-7.90152802e-03  1.81046751e-02]]
grads:  [ 0.01046455 -5.59630503]
Stock Position:  0.010464553281622166
Bond Position:  [11.08327898]


portfolio before change:  [12.16285079]
curr_Stock_Price:  102.89981947276202
curr_Factors:  [1.02899819e+02 3.72488724e-02]
mat_Sqrt:  [[ 1.98596311e+01  0.00000000e+00]
 [-7.71998678e-03  1.76887119e-02]]
grads:  [ 0.00791446 -1.55747868]
Stock Position:  0.00791445676611395
Bond Position:  [11.34845462]


portfolio before change:  [12.16215972]
curr_Stock_Price:  102.45398502148407
curr_Factors:  [1.02453985e+02 3.78189615e-02]
mat_Sqrt:  [[ 1.99243267e+01  0.00000000e+00]
 [-7.77883914e-03  1.78235596e-02]]
grads:  [-2.90911791e-05 -1.08570771e+00]
Stock Position:  -2.9091179090093073e-05
Bond Position:  [12.16514023]


portfolio before change:  [12.16520772]
curr_Stock_Price:  102.23633912518022
curr_Factors:  [1.02236339e+02 3.79531507e-02]
mat_Sqrt:  [[ 1.99172423e+01  0.00000000e+00]
 [-7.79262735e-03  1.78551524e-02]]
grads:  [ -0.01265969 -10.80300349]
Stock Position:  -0.012659687016702698
Bond Position:  [13.45948777]


portfolio before change:  [12.19064347]
curr_Stock_Price:  100.49297413012287
curr_Factors:  [1.00492974e+02 3.88812056e-02]
mat_Sqrt:  [[ 1.98155240e+01  0.00000000e+00]
 [-7.88732711e-03  1.80721368e-02]]
grads:  [-0.0494799  40.93206114]
Stock Position:  -0.04947990171501277
Bond Position:  [17.16302595]


portfolio before change:  [12.05617469]
curr_Stock_Price:  103.2973465086777
curr_Factors:  [1.03297347e+02 3.70557070e-02]
mat_Sqrt:  [[ 1.98845935e+01  0.00000000e+00]
 [-7.69994358e-03  1.76427872e-02]]
grads:  [ 6.66887498e-04 -4.18660594e+00]
Stock Position:  0.000666887498002013
Bond Position:  [11.98728698]


portfolio before change:  [12.05975873]
curr_Stock_Price:  104.17732128674571
curr_Factors:  [1.04177321e+02 3.59640624e-02]
mat_Sqrt:  [[ 1.97563885e+01  0.00000000e+00]
 [-7.58567729e-03  1.73809702e-02]]
grads:  [1.64966653e-02 2.49543650e+01]
Stock Position:  0.016496665267742464
Bond Position:  [10.34118033]


portfolio before change:  [12.0778663]
curr_Stock_Price:  105.11823561018163
curr_Factors:  [1.05118236e+02 3.67334841e-02]
mat_Sqrt:  [[ 2.01469414e+01  0.00000000e+00]
 [-7.66639254e-03  1.75659121e-02]]
grads:  [-0.02242728 -4.3831012 ]
Stock Position:  -0.022427283627939294
Bond Position:  [14.43538278]


portfolio before change:  [12.09029719]
curr_Stock_Price:  104.72489344193436
curr_Factors:  [1.04724893e+02 3.68547081e-02]
mat_Sqrt:  [[ 2.01046453e+01  0.00000000e+00]
 [-7.67903203e-03  1.75948728e-02]]
grads:  [-0.00172345 -0.65427838]
Stock Position:  -0.0017234488270432868
Bond Position:  [12.27078519]


portfolio before change:  [12.09244341]
curr_Stock_Price:  105.25978539378212
curr_Factors:  [1.05259785e+02 3.71123293e-02]
mat_Sqrt:  [[ 2.02778351e+01  0.00000000e+00]
 [-7.70582421e-03  1.76562614e-02]]
grads:  [-1.77766227e-03 -3.89799216e+00]
Stock Position:  -0.0017776622709149536
Bond Position:  [12.27955976]


portfolio before change:  [12.09989234]
curr_Stock_Price:  102.79663454319848
curr_Factors:  [1.02796635e+02 3.84792865e-02]
mat_Sqrt:  [[ 2.01647296e+01  0.00000000e+00]
 [-7.84645515e-03  1.79784873e-02]]
grads:  [7.54967436e-03 8.26421526e+00]
Stock Position:  0.0075496743589160776
Bond Position:  [11.32381122]


portfolio before change:  [12.11485251]
curr_Stock_Price:  104.40317608526736
curr_Factors:  [1.04403176e+02 3.75121456e-02]
mat_Sqrt:  [[ 2.02208619e+01  0.00000000e+00]
 [-7.74722098e-03  1.77511133e-02]]
grads:  [-0.00706509 -3.47597251]
Stock Position:  -0.0070650876585838275
Bond Position:  [12.8524701]


portfolio before change:  [12.10784044]
curr_Stock_Price:  105.85051712088352
curr_Factors:  [1.05850517e+02 3.50723251e-02]
mat_Sqrt:  [[ 1.98232685e+01  0.00000000e+00]
 [-7.49104266e-03  1.71641350e-02]]
grads:  [-4.39103408e-03 -4.88895391e+00]
Stock Position:  -0.0043910340769052645
Bond Position:  [12.57263366]


portfolio before change:  [12.10872613]
curr_Stock_Price:  106.36471536621022
curr_Factors:  [1.06364715e+02 3.62940329e-02]
mat_Sqrt:  [[ 2.02635343e+01  0.00000000e+00]
 [-7.62039714e-03  1.74605234e-02]]
grads:  [-2.00342640e-02 -3.56666716e+01]
Stock Position:  -0.020034264008811666
Bond Position:  [14.23966491]


portfolio before change:  [12.07867644]
curr_Stock_Price:  108.04234367455737
curr_Factors:  [1.08042344e+02 3.33446335e-02]
mat_Sqrt:  [[ 1.97290862e+01  0.00000000e+00]
 [-7.30420520e-03  1.67360366e-02]]
grads:  [-0.01989242  3.336428  ]
Stock Position:  -0.01989242000505493
Bond Position:  [14.22790012]


portfolio before change:  [12.07714035]
curr_Stock_Price:  108.29839640687827
curr_Factors:  [1.08298396e+02 3.26630792e-02]
mat_Sqrt:  [[ 1.95726932e+01  0.00000000e+00]
 [-7.22917193e-03  1.65641138e-02]]
grads:  [-5.29570994e-04 -4.93729861e+00]
Stock Position:  -0.0005295709941857909
Bond Position:  [12.13449204]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.08110801]
Stock Price:  106.53534639558688
PL:  [5.54576162]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  -0.1718829619427394
FINAL STD P&L:  9.941235359839427
