WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-19 00:01:15.803785: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-19 00:01:15.835641: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:04:00.0
2019-12-19 00:01:15.836412: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-19 00:01:15.844700: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-19 00:01:15.852648: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-19 00:01:15.863276: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-19 00:01:15.876867: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-19 00:01:15.884927: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-19 00:01:15.895961: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-19 00:01:15.898304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-19 00:01:15.898746: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-19 00:01:15.906071: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399935000 Hz
2019-12-19 00:01:15.906311: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5613d993a890 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-19 00:01:15.906330: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-19 00:01:15.907598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:04:00.0
2019-12-19 00:01:15.907634: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-19 00:01:15.907648: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-19 00:01:15.907660: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-19 00:01:15.907672: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-19 00:01:15.907689: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-19 00:01:15.907702: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-19 00:01:15.907714: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-19 00:01:15.909882: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-19 00:01:15.909912: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-19 00:01:16.014729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-19 00:01:16.014763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-19 00:01:16.014775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-19 00:01:16.018167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:04:00.0, compute capability: 6.0)
2019-12-19 00:01:16.020617: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5613d9f73ba0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-19 00:01:16.020636: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
INFO   Y0_true: -1.0000e+00
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-19 00:01:57.123788: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 1.2187e+02,   Y0: 2.6164e+00,  elapsed time  41
INFO   step:     1,    loss: 7.6252e+01,   Y0: 2.6114e+00,  elapsed time  61
INFO   step:     2,    loss: 7.6233e+01,   Y0: 2.6064e+00,  elapsed time  64
INFO   step:     3,    loss: 7.6224e+01,   Y0: 2.6039e+00,  elapsed time  66
INFO   step:     4,    loss: 7.6210e+01,   Y0: 2.6015e+00,  elapsed time  69
INFO   step:     5,    loss: 7.6197e+01,   Y0: 2.5988e+00,  elapsed time  71
INFO   step:     6,    loss: 7.6187e+01,   Y0: 2.5961e+00,  elapsed time  74
INFO   step:     7,    loss: 7.6177e+01,   Y0: 2.5927e+00,  elapsed time  76
INFO   step:     8,    loss: 7.6170e+01,   Y0: 2.5890e+00,  elapsed time  79
INFO   step:     9,    loss: 7.6164e+01,   Y0: 2.5861e+00,  elapsed time  81
INFO   step:    10,    loss: 7.6160e+01,   Y0: 2.5826e+00,  elapsed time  84
INFO   step:    11,    loss: 7.6153e+01,   Y0: 2.5796e+00,  elapsed time  86
INFO   step:    12,    loss: 7.6148e+01,   Y0: 2.5763e+00,  elapsed time  89
INFO   step:    13,    loss: 7.6140e+01,   Y0: 2.5727e+00,  elapsed time  91
INFO   step:    14,    loss: 7.6133e+01,   Y0: 2.5690e+00,  elapsed time  94
INFO   step:    15,    loss: 7.6128e+01,   Y0: 2.5658e+00,  elapsed time  96
INFO   step:    16,    loss: 7.6124e+01,   Y0: 2.5628e+00,  elapsed time  99
INFO   step:    17,    loss: 7.6120e+01,   Y0: 2.5598e+00,  elapsed time 101
INFO   step:    18,    loss: 7.6117e+01,   Y0: 2.5567e+00,  elapsed time 104
INFO   step:    19,    loss: 7.6116e+01,   Y0: 2.5532e+00,  elapsed time 106
INFO   step:    20,    loss: 7.6112e+01,   Y0: 2.5495e+00,  elapsed time 109
INFO   step:    21,    loss: 7.6108e+01,   Y0: 2.5458e+00,  elapsed time 111
INFO   step:    22,    loss: 7.6106e+01,   Y0: 2.5424e+00,  elapsed time 114
INFO   step:    23,    loss: 7.6104e+01,   Y0: 2.5387e+00,  elapsed time 116
INFO   step:    24,    loss: 7.6101e+01,   Y0: 2.5358e+00,  elapsed time 119
INFO   step:    25,    loss: 7.6098e+01,   Y0: 2.5322e+00,  elapsed time 122
INFO   step:    26,    loss: 7.6095e+01,   Y0: 2.5284e+00,  elapsed time 124
INFO   step:    27,    loss: 7.6089e+01,   Y0: 2.5250e+00,  elapsed time 127
INFO   step:    28,    loss: 7.6084e+01,   Y0: 2.5213e+00,  elapsed time 129
INFO   step:    29,    loss: 7.6078e+01,   Y0: 2.5176e+00,  elapsed time 132
INFO   step:    30,    loss: 7.6070e+01,   Y0: 2.5142e+00,  elapsed time 134
INFO   step:    31,    loss: 7.6062e+01,   Y0: 2.5113e+00,  elapsed time 137
INFO   step:    32,    loss: 7.6054e+01,   Y0: 2.5084e+00,  elapsed time 139
INFO   step:    33,    loss: 7.6049e+01,   Y0: 2.5055e+00,  elapsed time 142
INFO   step:    34,    loss: 7.6045e+01,   Y0: 2.5027e+00,  elapsed time 144
INFO   step:    35,    loss: 7.6042e+01,   Y0: 2.4998e+00,  elapsed time 147
INFO   step:    36,    loss: 7.6038e+01,   Y0: 2.4971e+00,  elapsed time 149
INFO   step:    37,    loss: 7.6033e+01,   Y0: 2.4948e+00,  elapsed time 152
INFO   step:    38,    loss: 7.6029e+01,   Y0: 2.4933e+00,  elapsed time 154
INFO   step:    39,    loss: 7.6025e+01,   Y0: 2.4923e+00,  elapsed time 157
INFO   step:    40,    loss: 7.6020e+01,   Y0: 2.4910e+00,  elapsed time 159
INFO   step:    41,    loss: 7.6013e+01,   Y0: 2.4900e+00,  elapsed time 162
INFO   step:    42,    loss: 7.6007e+01,   Y0: 2.4886e+00,  elapsed time 164
INFO   step:    43,    loss: 7.6000e+01,   Y0: 2.4876e+00,  elapsed time 167
INFO   step:    44,    loss: 7.5992e+01,   Y0: 2.4870e+00,  elapsed time 169
INFO   step:    45,    loss: 7.5984e+01,   Y0: 2.4863e+00,  elapsed time 172
INFO   step:    46,    loss: 7.5978e+01,   Y0: 2.4864e+00,  elapsed time 174
INFO   step:    47,    loss: 7.5971e+01,   Y0: 2.4867e+00,  elapsed time 177
INFO   step:    48,    loss: 7.5966e+01,   Y0: 2.4868e+00,  elapsed time 179
INFO   step:    49,    loss: 7.5960e+01,   Y0: 2.4875e+00,  elapsed time 182
INFO   step:    50,    loss: 7.5951e+01,   Y0: 2.4880e+00,  elapsed time 184
INFO   step:    51,    loss: 7.5944e+01,   Y0: 2.4884e+00,  elapsed time 187
INFO   step:    52,    loss: 7.5937e+01,   Y0: 2.4892e+00,  elapsed time 189
INFO   step:    53,    loss: 7.5928e+01,   Y0: 2.4906e+00,  elapsed time 192
INFO   step:    54,    loss: 7.5919e+01,   Y0: 2.4919e+00,  elapsed time 194
INFO   step:    55,    loss: 7.5911e+01,   Y0: 2.4932e+00,  elapsed time 197
INFO   step:    56,    loss: 7.5902e+01,   Y0: 2.4952e+00,  elapsed time 199
INFO   step:    57,    loss: 7.5893e+01,   Y0: 2.4967e+00,  elapsed time 202
INFO   step:    58,    loss: 7.5884e+01,   Y0: 2.4974e+00,  elapsed time 204
INFO   step:    59,    loss: 7.5876e+01,   Y0: 2.4986e+00,  elapsed time 207
INFO   step:    60,    loss: 7.5868e+01,   Y0: 2.4999e+00,  elapsed time 209
INFO   step:    61,    loss: 7.5861e+01,   Y0: 2.5013e+00,  elapsed time 212
INFO   step:    62,    loss: 7.5854e+01,   Y0: 2.5025e+00,  elapsed time 214
INFO   step:    63,    loss: 7.5847e+01,   Y0: 2.5033e+00,  elapsed time 217
INFO   step:    64,    loss: 7.5840e+01,   Y0: 2.5038e+00,  elapsed time 219
INFO   step:    65,    loss: 7.5833e+01,   Y0: 2.5034e+00,  elapsed time 222
INFO   step:    66,    loss: 7.5827e+01,   Y0: 2.5035e+00,  elapsed time 224
INFO   step:    67,    loss: 7.5820e+01,   Y0: 2.5037e+00,  elapsed time 227
INFO   step:    68,    loss: 7.5811e+01,   Y0: 2.5040e+00,  elapsed time 229
INFO   step:    69,    loss: 7.5804e+01,   Y0: 2.5041e+00,  elapsed time 232
INFO   step:    70,    loss: 7.5799e+01,   Y0: 2.5038e+00,  elapsed time 234
INFO   step:    71,    loss: 7.5794e+01,   Y0: 2.5034e+00,  elapsed time 237
INFO   step:    72,    loss: 7.5790e+01,   Y0: 2.5031e+00,  elapsed time 239
INFO   step:    73,    loss: 7.5783e+01,   Y0: 2.5025e+00,  elapsed time 242
INFO   step:    74,    loss: 7.5773e+01,   Y0: 2.5023e+00,  elapsed time 244
INFO   step:    75,    loss: 7.5763e+01,   Y0: 2.5024e+00,  elapsed time 247
INFO   step:    76,    loss: 7.5755e+01,   Y0: 2.5018e+00,  elapsed time 250
INFO   step:    77,    loss: 7.5745e+01,   Y0: 2.5017e+00,  elapsed time 252
INFO   step:    78,    loss: 7.5734e+01,   Y0: 2.5019e+00,  elapsed time 255
INFO   step:    79,    loss: 7.5727e+01,   Y0: 2.5027e+00,  elapsed time 257
INFO   step:    80,    loss: 7.5722e+01,   Y0: 2.5038e+00,  elapsed time 260
INFO   step:    81,    loss: 7.5717e+01,   Y0: 2.5047e+00,  elapsed time 262
INFO   step:    82,    loss: 7.5712e+01,   Y0: 2.5055e+00,  elapsed time 265
INFO   step:    83,    loss: 7.5705e+01,   Y0: 2.5065e+00,  elapsed time 267
INFO   step:    84,    loss: 7.5698e+01,   Y0: 2.5077e+00,  elapsed time 270
INFO   step:    85,    loss: 7.5691e+01,   Y0: 2.5090e+00,  elapsed time 272
INFO   step:    86,    loss: 7.5685e+01,   Y0: 2.5096e+00,  elapsed time 275
INFO   step:    87,    loss: 7.5680e+01,   Y0: 2.5103e+00,  elapsed time 277
INFO   step:    88,    loss: 7.5675e+01,   Y0: 2.5104e+00,  elapsed time 280
INFO   step:    89,    loss: 7.5672e+01,   Y0: 2.5101e+00,  elapsed time 282
INFO   step:    90,    loss: 7.5666e+01,   Y0: 2.5102e+00,  elapsed time 285
INFO   step:    91,    loss: 7.5660e+01,   Y0: 2.5110e+00,  elapsed time 287
INFO   step:    92,    loss: 7.5654e+01,   Y0: 2.5115e+00,  elapsed time 290
INFO   step:    93,    loss: 7.5645e+01,   Y0: 2.5127e+00,  elapsed time 292
INFO   step:    94,    loss: 7.5636e+01,   Y0: 2.5140e+00,  elapsed time 295
INFO   step:    95,    loss: 7.5627e+01,   Y0: 2.5156e+00,  elapsed time 297
INFO   step:    96,    loss: 7.5618e+01,   Y0: 2.5171e+00,  elapsed time 300
INFO   step:    97,    loss: 7.5610e+01,   Y0: 2.5186e+00,  elapsed time 302
INFO   step:    98,    loss: 7.5602e+01,   Y0: 2.5195e+00,  elapsed time 305
INFO   step:    99,    loss: 7.5596e+01,   Y0: 2.5196e+00,  elapsed time 307
INFO   step:   100,    loss: 7.5588e+01,   Y0: 2.5196e+00,  elapsed time 310
INFO   step:   101,    loss: 7.5582e+01,   Y0: 2.5206e+00,  elapsed time 312
INFO   step:   102,    loss: 7.5576e+01,   Y0: 2.5217e+00,  elapsed time 315
INFO   step:   103,    loss: 7.5569e+01,   Y0: 2.5222e+00,  elapsed time 317
INFO   step:   104,    loss: 7.5562e+01,   Y0: 2.5225e+00,  elapsed time 320
INFO   step:   105,    loss: 7.5554e+01,   Y0: 2.5224e+00,  elapsed time 322
INFO   step:   106,    loss: 7.5546e+01,   Y0: 2.5229e+00,  elapsed time 325
INFO   step:   107,    loss: 7.5537e+01,   Y0: 2.5235e+00,  elapsed time 327
INFO   step:   108,    loss: 7.5529e+01,   Y0: 2.5244e+00,  elapsed time 330
INFO   step:   109,    loss: 7.5522e+01,   Y0: 2.5254e+00,  elapsed time 332
INFO   step:   110,    loss: 7.5514e+01,   Y0: 2.5258e+00,  elapsed time 335
INFO   step:   111,    loss: 7.5506e+01,   Y0: 2.5254e+00,  elapsed time 337
INFO   step:   112,    loss: 7.5499e+01,   Y0: 2.5252e+00,  elapsed time 340
INFO   step:   113,    loss: 7.5493e+01,   Y0: 2.5242e+00,  elapsed time 342
INFO   step:   114,    loss: 7.5486e+01,   Y0: 2.5240e+00,  elapsed time 345
INFO   step:   115,    loss: 7.5479e+01,   Y0: 2.5230e+00,  elapsed time 347
INFO   step:   116,    loss: 7.5471e+01,   Y0: 2.5220e+00,  elapsed time 350
INFO   step:   117,    loss: 7.5462e+01,   Y0: 2.5207e+00,  elapsed time 352
INFO   step:   118,    loss: 7.5452e+01,   Y0: 2.5193e+00,  elapsed time 355
INFO   step:   119,    loss: 7.5444e+01,   Y0: 2.5184e+00,  elapsed time 357
INFO   step:   120,    loss: 7.5436e+01,   Y0: 2.5172e+00,  elapsed time 360
INFO   step:   121,    loss: 7.5429e+01,   Y0: 2.5159e+00,  elapsed time 362
INFO   step:   122,    loss: 7.5422e+01,   Y0: 2.5151e+00,  elapsed time 364
INFO   step:   123,    loss: 7.5415e+01,   Y0: 2.5142e+00,  elapsed time 367
INFO   step:   124,    loss: 7.5409e+01,   Y0: 2.5131e+00,  elapsed time 369
INFO   step:   125,    loss: 7.5402e+01,   Y0: 2.5122e+00,  elapsed time 372
INFO   step:   126,    loss: 7.5397e+01,   Y0: 2.5120e+00,  elapsed time 375
INFO   step:   127,    loss: 7.5392e+01,   Y0: 2.5109e+00,  elapsed time 377
INFO   step:   128,    loss: 7.5387e+01,   Y0: 2.5098e+00,  elapsed time 380
INFO   step:   129,    loss: 7.5384e+01,   Y0: 2.5083e+00,  elapsed time 382
INFO   step:   130,    loss: 7.5380e+01,   Y0: 2.5070e+00,  elapsed time 385
INFO   step:   131,    loss: 7.5375e+01,   Y0: 2.5062e+00,  elapsed time 387
INFO   step:   132,    loss: 7.5369e+01,   Y0: 2.5060e+00,  elapsed time 390
INFO   step:   133,    loss: 7.5362e+01,   Y0: 2.5063e+00,  elapsed time 392
INFO   step:   134,    loss: 7.5356e+01,   Y0: 2.5058e+00,  elapsed time 395
INFO   step:   135,    loss: 7.5347e+01,   Y0: 2.5063e+00,  elapsed time 397
INFO   step:   136,    loss: 7.5339e+01,   Y0: 2.5059e+00,  elapsed time 400
INFO   step:   137,    loss: 7.5330e+01,   Y0: 2.5045e+00,  elapsed time 402
INFO   step:   138,    loss: 7.5322e+01,   Y0: 2.5031e+00,  elapsed time 405
INFO   step:   139,    loss: 7.5315e+01,   Y0: 2.5012e+00,  elapsed time 407
INFO   step:   140,    loss: 7.5304e+01,   Y0: 2.4998e+00,  elapsed time 410
INFO   step:   141,    loss: 7.5295e+01,   Y0: 2.4986e+00,  elapsed time 412
INFO   step:   142,    loss: 7.5287e+01,   Y0: 2.4974e+00,  elapsed time 415
INFO   step:   143,    loss: 7.5279e+01,   Y0: 2.4964e+00,  elapsed time 417
INFO   step:   144,    loss: 7.5272e+01,   Y0: 2.4966e+00,  elapsed time 420
INFO   step:   145,    loss: 7.5261e+01,   Y0: 2.4971e+00,  elapsed time 422
INFO   step:   146,    loss: 7.5251e+01,   Y0: 2.4979e+00,  elapsed time 425
INFO   step:   147,    loss: 7.5243e+01,   Y0: 2.4983e+00,  elapsed time 427
INFO   step:   148,    loss: 7.5235e+01,   Y0: 2.4988e+00,  elapsed time 430
INFO   step:   149,    loss: 7.5228e+01,   Y0: 2.4988e+00,  elapsed time 432
Delta:  120 ,  120.05
Other1:  -50.05 ,  -50
Other2:  -50.05 ,  -50
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_10:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_11:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_12:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_13:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_14:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_15:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_16:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_17:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_18:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_19:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_20:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_21:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_22:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_23:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_24:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_25:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_26:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_27:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_28:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_29:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_30:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_31:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_32:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_33:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_34:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_35:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_36:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_37:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_38:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_39:0' shape=(?, 3) dtype=float64>]
num_iterations:  150
total time intervals:  40
# of dimensions:  3
Loss out:  77.22274087566751
Output_Z_Vals:  [[[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
  [ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
  [ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
  ...
  [ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
  [ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
  [ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]]

 [[ 6.38596939e-02 -4.91987624e-02  2.69196868e-02]
  [-2.65655175e-02 -7.80317406e-02  1.95321551e-01]
  [ 1.56586714e-01  1.01402439e-02 -9.12774564e-02]
  ...
  [ 7.86535074e-02 -2.90632351e-02  4.73709987e-02]
  [ 6.32583985e-02 -5.63214848e-02 -7.51405529e-02]
  [-2.68750355e-02 -7.72180339e-02  1.97478851e-01]]

 [[ 1.76970564e+00  3.93757144e-01  6.11936629e-01]
  [ 4.59165549e-01  2.03690642e-01  1.23708586e-01]
  [ 1.81388033e+00  4.24922297e-01  6.43747149e-01]
  ...
  [ 1.63923360e+00  3.54467630e-01  5.46116619e-01]
  [ 1.24284533e+00  2.40604998e-01  3.57364171e-01]
  [ 1.87640272e-01  2.15277480e-01  4.91560602e-02]]

 ...

 [[ 2.12328129e+00  1.42134214e+00  1.71778079e-01]
  [ 1.77109911e+00  1.14831709e+00  1.47799394e-01]
  [ 1.51945661e+00  9.89822378e-01  1.37799875e-01]
  ...
  [ 1.95524178e+00  1.26367930e+00  1.54996109e-01]
  [ 1.09012435e+00  7.36027106e-01  1.23979160e-01]
  [ 1.48513187e+00  9.69200922e-01  1.36630433e-01]]

 [[-3.84411285e-02 -1.12802134e-01 -4.57579027e-02]
  [ 7.53069652e-03 -4.64332531e-02  3.65704994e-02]
  [ 7.88231578e-02 -1.37722419e-01  6.44934212e-02]
  ...
  [ 4.18010592e-02 -1.56044783e-01 -1.60902634e-02]
  [ 3.00576634e-02 -1.34052067e-01 -8.10544459e-03]
  [ 1.10542063e-01 -1.52041899e-01  5.76291154e-02]]

 [[ 4.06646723e-02 -2.44653940e-02 -2.01610614e-02]
  [ 3.20064728e-02 -1.45713259e-02 -5.36287692e-02]
  [ 2.97386355e-02 -1.53755174e-02 -1.70272857e-02]
  ...
  [ 3.25134480e-02 -1.43406369e-02 -6.14200851e-02]
  [ 3.29716381e-02 -1.45491985e-02 -7.16641667e-02]
  [ 3.05672599e-02 -1.51645814e-02 -3.10373517e-02]]]
Z_Vals dimensionality:  (40, 200, 3)
X_test:  [[[100.         100.52907671 101.8169024  ... 103.33946463 103.56489056
   103.65553878]
  [ -1.          -1.01192909  -1.04415042 ...  -2.50308846  -2.19627042
    -2.46600751]
  [ -1.          -0.96927249  -0.96968051 ...  -1.0496444   -1.05594398
    -1.06333848]]

 [[100.          99.02011918  98.77798964 ...  96.5745629   96.99305248
    98.21958331]
  [ -1.          -0.88090239  -0.94838372 ...  -0.6291991   -0.44370094
    -0.45068676]
  [ -1.          -0.98603335  -0.98158163 ...  -0.99939581  -0.99638182
    -1.00013054]]

 [[100.         101.25305422 102.03047936 ...  94.09454339  93.58560582
    92.72034416]
  [ -1.          -1.15528626  -1.02633775 ...  -0.41063275  -0.51368581
    -0.37315459]
  [ -1.          -1.00234828  -1.00975988 ...  -1.03477615  -1.00643306
    -1.02786983]]

 ...

 [[100.         100.77240353 101.60585979 ...  97.84344272  98.02820542
    98.15043339]
  [ -1.          -0.99835875  -0.98349773 ...  -1.43532581  -1.14157735
    -1.08195708]
  [ -1.          -0.98980584  -1.02882729 ...  -1.0161627   -1.00576898
    -0.99731927]]

 [[100.         100.23443383 100.61960541 ...  97.73928735  97.72227487
    98.63786982]
  [ -1.          -1.14140818  -1.03014519 ...  -1.18302474  -0.94995087
    -1.02547544]
  [ -1.          -1.04253882  -1.05811804 ...  -1.20836918  -1.1995482
    -1.18961763]]

 [[100.          99.42015478  98.35758207 ...  94.40798324  94.76385806
    95.08462731]
  [ -1.          -0.8659283   -0.8049367  ...  -1.0443932   -1.23034352
    -1.21442297]
  [ -1.          -0.9845707   -0.97144013 ...  -1.05684148  -1.09019171
    -1.09276276]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 6.38596939e-02 -4.91987624e-02  2.69196868e-02]
 [ 1.76970564e+00  3.93757144e-01  6.11936629e-01]
 [ 1.29690584e-01  2.39773832e-01  4.29973334e-02]
 [ 6.53690160e-02  5.47032762e-01  4.25702802e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 7.54829891e-02 -6.85687777e-02  6.38419303e-02]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [ 1.67837205e-01  6.04701169e-03 -1.52119771e-01]
 [-7.48150365e-03  8.86294501e-02 -5.01596393e-02]
 [-4.80934961e-01  8.31155648e-02 -1.74289724e-01]
 [ 4.45730234e-01  8.83197301e-01 -1.51237783e-01]
 [-1.68699212e-04  1.96993566e-02 -5.78926345e-02]
 [-8.17229344e-02 -3.46487629e-02 -3.26526881e-01]
 [ 1.76165356e+00 -3.46282904e+00  3.00859916e+00]
 [ 4.68555752e-02 -1.00071668e-01  5.53653853e-02]
 [ 1.08617370e-01 -9.57106067e-02  3.26749592e-02]
 [-1.81440040e-01 -2.62269315e-01 -1.21119129e-02]
 [-2.51689537e-01 -1.64548740e+00 -1.97188809e-01]
 [-5.22876467e-02  2.71196715e-01  4.53900505e-01]
 [ 3.97661975e-01 -1.65539063e-01  6.34464681e-01]
 [ 1.30803023e-01 -5.20729993e-01 -1.71403808e-01]
 [ 1.30514544e-01 -5.66971210e-02 -4.53056496e-02]
 [ 1.06669005e-01  2.40928841e-01  1.50265207e-01]
 [ 6.55424731e-01 -5.22892075e-01 -2.94843580e-01]
 [-4.69695980e-02 -1.13714296e-01  5.47782447e-02]
 [ 5.80935925e-02 -1.94826713e-02 -4.97463094e-02]
 [ 8.43635816e-01 -9.02663201e-02  4.57035957e-01]
 [ 6.66746771e-02 -1.83673350e-01 -5.39592439e-02]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 3.52812109e-01 -1.76530252e-01  2.20874225e-03]
 [-2.32944924e-02 -6.43324883e-02 -3.33085488e-02]
 [ 1.41709422e-02  2.37574692e-02 -6.39510844e-02]
 [-3.90012970e-02  7.42860153e-02 -1.50305804e-01]
 [ 4.37378048e-01  8.05206914e-02  1.07402320e-01]
 [-4.75566036e-02 -7.03729949e-02  6.10004491e-02]
 [-5.27591825e-02 -6.38584954e-03 -3.09789105e-02]
 [ 2.12328129e+00  1.42134214e+00  1.71778079e-01]
 [-3.84411285e-02 -1.12802134e-01 -4.57579027e-02]
 [ 4.06646723e-02 -2.44653940e-02 -2.01610614e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.28488204]
curr_Stock_Price:  100.52907671294177
curr_Factors:  [100.52907671  -1.01192909  -0.96927249]
mat_Sqrt:  [[13.86330518  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00427834 -0.01587883  0.07679437]
Stock Position:  0.004278344586704829
Bond Position:  [5.85478401]


portfolio before change:  [6.2911237]
curr_Stock_Price:  101.81690240393723
curr_Factors:  [101.8169024   -1.04415042  -0.96968051]
mat_Sqrt:  [[13.59014901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.14532527 0.12708457 1.74568487]
Stock Position:  0.14532526636814874
Bond Position:  [-8.50544476]


portfolio before change:  [6.3313215]
curr_Stock_Price:  102.10082445299358
curr_Factors:  [102.10082445  -1.2300065   -0.96753834]
mat_Sqrt:  [[11.34090336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01652523 0.07738667 0.12265942]
Stock Position:  0.016525227372170357
Bond Position:  [4.64408216]


portfolio before change:  [6.33510276]
curr_Stock_Price:  102.29451091084867
curr_Factors:  [102.29451091  -1.13638268  -0.98473373]
mat_Sqrt:  [[12.26487655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.021519   0.17655406 1.2144116 ]
Stock Position:  0.02151899617265221
Bond Position:  [4.13382757]


portfolio before change:  [6.33908057]
curr_Stock_Price:  102.4553476671281
curr_Factors:  [102.45534767  -1.21154324  -0.96871312]
mat_Sqrt:  [[11.57874057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00506497 -0.01106097 -0.05874131]
Stock Position:  -0.005064972356806716
Bond Position:  [6.85801407]


portfolio before change:  [6.34236227]
curr_Stock_Price:  101.97668708745704
curr_Factors:  [101.97668709  -1.36753787  -0.95362889]
mat_Sqrt:  [[10.00992869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00744442 -0.02213048  0.18212326]
Stock Position:  0.0074444212072636295
Bond Position:  [5.58320486]


portfolio before change:  [6.33406388]
curr_Stock_Price:  100.76822028092808
curr_Factors:  [100.76822028  -1.34383942  -0.96368653]
mat_Sqrt:  [[10.02715666  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00661108 -0.00251018 -0.21167328]
Stock Position:  -0.006611078813181245
Bond Position:  [7.00025053]


portfolio before change:  [6.32351781]
curr_Stock_Price:  102.49579911666547
curr_Factors:  [102.49579912  -1.51071662  -1.00071267]
mat_Sqrt:  [[ 8.3177561   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01659344  0.00195166 -0.43395536]
Stock Position:  0.016593444898362612
Bond Position:  [4.62275941]


portfolio before change:  [6.32769887]
curr_Stock_Price:  102.71294391930059
curr_Factors:  [102.71294392  -1.52547994  -0.98245864]
mat_Sqrt:  [[ 8.36452517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.43675613e-05  2.86050320e-02 -1.43091489e-01]
Stock Position:  4.436756134065724e-05
Bond Position:  [6.32314175]


portfolio before change:  [6.32853652]
curr_Stock_Price:  103.77693961363187
curr_Factors:  [103.77693961  -1.52186345  -1.02446079]
mat_Sqrt:  [[ 8.13291613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06142272  0.02682543 -0.49720007]
Stock Position:  -0.06142271723394155
Bond Position:  [12.70279814]


portfolio before change:  [6.31861469]
curr_Stock_Price:  103.96432591211976
curr_Factors:  [103.96432591  -1.52296894  -1.05223762]
mat_Sqrt:  [[ 7.91564566  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07518538  0.2850507  -0.4314393 ]
Stock Position:  0.07518538226725976
Bond Position:  [-1.49798289]


portfolio before change:  [6.29979505]
curr_Stock_Price:  103.71650668460292
curr_Factors:  [103.71650668  -1.7528605   -1.05456766]
mat_Sqrt:  [[ 6.26033139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00127228  0.00635794 -0.16515157]
Stock Position:  -0.001272276005823063
Bond Position:  [6.43175107]


portfolio before change:  [6.30141775]
curr_Stock_Price:  103.07302521197266
curr_Factors:  [103.07302521  -1.79145627  -1.04558701]
mat_Sqrt:  [[ 6.03994215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0257366  -0.01118284 -0.9314903 ]
Stock Position:  -0.025736604754459897
Bond Position:  [8.95416746]


portfolio before change:  [6.29085822]
curr_Stock_Price:  103.52680984154007
curr_Factors:  [103.52680984  -2.01270307  -1.07176587]
mat_Sqrt:  [[ 4.73679938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.35233375 -1.11762327  8.58269598]
Stock Position:  0.35233374682826524
Bond Position:  [-30.18513059]


portfolio before change:  [6.32092692]
curr_Stock_Price:  103.6228610490448
curr_Factors:  [103.62286105  -2.13535483  -1.10607054]
mat_Sqrt:  [[ 4.05249442  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0093103  -0.03229799  0.15794203]
Stock Position:  0.009310301120992941
Bond Position:  [5.35616688]


portfolio before change:  [6.32370756]
curr_Stock_Price:  103.84960746343464
curr_Factors:  [103.84960746  -2.36008752  -1.06310765]
mat_Sqrt:  [[ 3.38633633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02827548 -0.03089047  0.09321256]
Stock Position:  0.02827547612511727
Bond Position:  [3.38731047]


portfolio before change:  [6.3284314]
curr_Stock_Price:  104.00169676581284
curr_Factors:  [104.00169677  -2.38643126  -1.0436005 ]
mat_Sqrt:  [[ 3.3681898   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07049718 -0.08464706 -0.03455192]
Stock Position:  -0.07049717727323983
Bond Position:  [13.66025746]


portfolio before change:  [6.34654553]
curr_Stock_Price:  103.76897126412955
curr_Factors:  [103.76897126  -2.30957766  -1.03009514]
mat_Sqrt:  [[ 3.67846002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.17067584 -0.53107877 -0.56252479]
Stock Position:  -0.1706758371163621
Bond Position:  [24.05740157]


portfolio before change:  [6.38708518]
curr_Stock_Price:  103.54906736980742
curr_Factors:  [103.54906737  -2.13588936  -1.03727775]
mat_Sqrt:  [[ 4.33568006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02207778 0.08752836 1.2948518 ]
Stock Position:  0.02207778303588459
Bond Position:  [4.10095133]


portfolio before change:  [6.39012485]
curr_Stock_Price:  103.66352729610587
curr_Factors:  [103.6635273   -2.26041611  -1.03692776]
mat_Sqrt:  [[ 3.83360829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12869886 -0.0534275   1.80995113]
Stock Position:  0.12869885973251077
Bond Position:  [-6.95125291]


portfolio before change:  [6.41997235]
curr_Stock_Price:  103.90219652704201
curr_Factors:  [103.90219653  -2.40697853  -1.06648123]
mat_Sqrt:  [[ 3.22196131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325212 -0.16806488 -0.48896735]
Stock Position:  -0.003252117878396057
Bond Position:  [6.75787454]


portfolio before change:  [6.42086069]
curr_Stock_Price:  103.88880370575465
curr_Factors:  [103.88880371  -2.6704788   -1.02392837]
mat_Sqrt:  [[ 2.582903    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.042469   -0.01829892 -0.12924441]
Stock Position:  0.04246900329973594
Bond Position:  [2.00880674]


portfolio before change:  [6.42401924]
curr_Stock_Price:  103.95726379261335
curr_Factors:  [103.95726379  -2.45901491  -1.04477856]
mat_Sqrt:  [[ 3.12735132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05964189 0.07775945 0.42866481]
Stock Position:  0.05964189380571255
Bond Position:  [0.22381115]


portfolio before change:  [6.42669019]
curr_Stock_Price:  104.00157780952183
curr_Factors:  [104.00157781  -2.42120417  -1.07845575]
mat_Sqrt:  [[ 3.14164378  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.15549349 -0.16876269 -0.84110666]
Stock Position:  0.15549348501763666
Bond Position:  [-9.7448776]


portfolio before change:  [6.43298782]
curr_Stock_Price:  104.0499130973829
curr_Factors:  [104.0499131   -2.2780273   -1.04557846]
mat_Sqrt:  [[ 3.74815963  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01574102 -0.03670113  0.15626708]
Stock Position:  -0.015741023583223664
Bond Position:  [8.07083996]


portfolio before change:  [6.43223576]
curr_Stock_Price:  104.16178496500518
curr_Factors:  [104.16178497  -2.32422451  -1.05498202]
mat_Sqrt:  [[ 3.54925876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01238633 -0.00628801 -0.14191237]
Stock Position:  0.012386328800040028
Bond Position:  [5.14205365]


portfolio before change:  [6.43120687]
curr_Stock_Price:  104.02682209975133
curr_Factors:  [104.0268221   -2.18814483  -1.06576354]
mat_Sqrt:  [[ 4.01782376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.22860693 -0.02913333  1.30379637]
Stock Position:  0.22860692963998197
Bond Position:  [-17.35004554]


portfolio before change:  [6.38572069]
curr_Stock_Price:  103.83733842686755
curr_Factors:  [103.83733843  -2.16260267  -1.07478005]
mat_Sqrt:  [[ 4.07733223  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00445589 -0.05928032 -0.1539307 ]
Stock Position:  0.004455885866898183
Bond Position:  [5.92303336]


portfolio before change:  [6.38806754]
curr_Stock_Price:  104.19785440588585
curr_Factors:  [104.19785441  -1.92132966  -1.09529482]
mat_Sqrt:  [[ 5.10217569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0067382  -0.02600141 -0.03673698]
Stock Position:  -0.006738195982123763
Bond Position:  [7.0901731]


portfolio before change:  [6.38738057]
curr_Stock_Price:  104.43134352837775
curr_Factors:  [104.43134353  -1.74615914  -1.10661597]
mat_Sqrt:  [[ 6.0240196   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05266067 -0.05697489  0.00630093]
Stock Position:  0.05266066525524619
Bond Position:  [0.88795654]


portfolio before change:  [6.37155476]
curr_Stock_Price:  104.12871141081796
curr_Factors:  [104.12871141  -1.75836168  -1.1137437 ]
mat_Sqrt:  [[ 5.89156914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00733682 -0.02076322 -0.09502002]
Stock Position:  -0.007336820569582937
Bond Position:  [7.13552843]


portfolio before change:  [6.37323765]
curr_Stock_Price:  104.02091351452545
curr_Factors:  [104.02091351  -1.68326262  -1.09072442]
mat_Sqrt:  [[ 6.49222253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091902  0.00766769 -0.18243464]
Stock Position:  0.0009190157565541155
Bond Position:  [6.27764079]


portfolio before change:  [6.37388457]
curr_Stock_Price:  103.870935212153
curr_Factors:  [103.87093521  -1.75366052  -1.09363091]
mat_Sqrt:  [[ 6.02463979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0090493   0.02397571 -0.42878062]
Stock Position:  -0.009049299744605976
Bond Position:  [7.3138438]


portfolio before change:  [6.3782698]
curr_Stock_Price:  103.48737610306824
curr_Factors:  [103.4873761   -1.7662248   -1.05731964]
mat_Sqrt:  [[ 6.14663756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07739804 0.02598794 0.30638892]
Stock Position:  0.07739803541684477
Bond Position:  [-1.6314498]


portfolio before change:  [6.38782552]
curr_Stock_Price:  103.61347311109715
curr_Factors:  [103.61347311  -1.92672479  -1.062528  ]
mat_Sqrt:  [[ 5.21435074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00948723 -0.02271279  0.1740173 ]
Stock Position:  -0.009487234167507677
Bond Position:  [7.3708308]


portfolio before change:  [6.39031533]
curr_Stock_Price:  103.44815602340411
curr_Factors:  [103.44815602  -2.28556998  -1.07648533]
mat_Sqrt:  [[ 3.58592074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01683981 -0.00206102 -0.08837421]
Stock Position:  -0.016839812300661262
Bond Position:  [8.13236286]


portfolio before change:  [6.39164528]
curr_Stock_Price:  103.4295492792181
curr_Factors:  [103.42954928  -2.41452886  -1.06008857]
mat_Sqrt:  [[ 3.20359386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.76429026 0.4587362  0.49003504]
Stock Position:  0.7642902631546409
Bond Position:  [-72.65855216]


portfolio before change:  [6.31371156]
curr_Stock_Price:  103.3394646250578
curr_Factors:  [103.33946463  -2.50308846  -1.0496444 ]
mat_Sqrt:  [[ 2.96028774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02391898 -0.03640673 -0.13053456]
Stock Position:  -0.02391897905623334
Bond Position:  [8.78548605]


portfolio before change:  [6.30941786]
curr_Stock_Price:  103.56489056122435
curr_Factors:  [103.56489056  -2.19627042  -1.05594398]
mat_Sqrt:  [[ 4.0067642   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00787552 -0.00789617 -0.0575139 ]
Stock Position:  0.007875515908049002
Bond Position:  [5.49379092]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.31081853]
Stock Price:  103.65553877595072
PL:  [2.65527975]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-2.65655175e-02 -7.80317406e-02  1.95321551e-01]
 [ 4.59165549e-01  2.03690642e-01  1.23708586e-01]
 [-3.40936696e-01 -2.27354794e-01  3.97412602e-02]
 [ 2.20555033e-01  1.74871483e+00  1.42654985e+00]
 [-4.76245143e-02 -3.33301680e-02 -1.91495547e-02]
 [ 1.95812821e-02  2.81410131e-03  3.90557528e-02]
 [-1.87439002e-01  3.63964074e-01  2.07026127e-01]
 [-3.86004411e-03 -1.64721233e-01  1.24825497e-01]
 [ 5.10583482e-02  2.52798696e-02 -4.05352183e-02]
 [-1.22636184e-01 -6.35581158e-02 -3.11418293e-02]
 [ 7.15935055e-01  1.38899582e+00 -2.47016408e-01]
 [-2.01383446e-04  2.56620733e-02 -2.81280105e-02]
 [-4.27501354e-01 -1.14751201e-02 -8.99951800e-01]
 [ 2.02909684e+00 -3.36693925e+00  2.85096762e+00]
 [ 1.96406959e-02 -4.18540893e-02 -6.92386218e-03]
 [ 3.46210347e-02  1.51655994e-01 -8.63202483e-02]
 [ 2.25653957e-02  1.03480774e-01 -1.29766843e-01]
 [-2.84370896e-01 -1.81784866e+00 -1.92221171e-01]
 [ 2.15451945e-02 -1.46459983e-01  3.40041686e-01]
 [ 1.39229586e-01  4.24969194e-01  4.60733005e-01]
 [ 2.67235554e-02 -6.78020791e-03  1.76973102e-02]
 [ 1.17468168e-01 -5.17662414e-02  4.24032392e-02]
 [-5.59606264e-02 -8.54937415e-02 -8.20796486e-02]
 [-1.58242810e-01 -5.64620120e-03 -1.13053415e-01]
 [ 7.58005365e-02  5.91117480e-03 -2.74443856e-02]
 [-1.46972803e-02 -5.30006764e-02  2.07436998e-01]
 [ 2.57313651e-01 -9.98392097e-02  1.41495392e-01]
 [ 4.45859010e-02 -1.84355653e-01 -9.03195659e-02]
 [ 8.33055920e-02 -4.30749123e-03  5.60482809e-02]
 [-9.15249301e-02  1.01620932e-01 -2.35152240e-03]
 [ 5.33369238e-02 -1.32941263e-02 -8.04300234e-02]
 [-6.38414650e-02  1.14433644e-02 -3.88150820e-02]
 [-9.13925830e-02 -2.40478455e-02  3.86524578e-02]
 [-6.23176584e-02 -1.73360250e-02 -5.76330966e-03]
 [-9.25679396e-02  1.47673942e-02  5.18049682e-02]
 [-1.10876024e-01 -6.28266988e-02 -7.38264123e-02]
 [ 1.77109911e+00  1.14831709e+00  1.47799394e-01]
 [ 7.53069652e-03 -4.64332531e-02  3.65704994e-02]
 [ 3.20064728e-02 -1.45713259e-02 -5.36287692e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.77286271]
curr_Stock_Price:  99.02011917682432
curr_Factors:  [99.02011918 -0.88090239 -0.98603335]
mat_Sqrt:  [[15.30817983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.71400862e-04 -2.51846360e-02  5.57198019e-01]
Stock Position:  -0.00017140086153852254
Bond Position:  [-4.75589058]


portfolio before change:  [-4.77341573]
curr_Stock_Price:  98.77798963506663
curr_Factors:  [98.77798964 -0.94838372 -0.98158163]
mat_Sqrt:  [[14.33794413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03668557 0.06574087 0.35290616]
Stock Position:  0.036685568867604226
Bond Position:  [-8.39714248]


portfolio before change:  [-4.76233]
curr_Stock_Price:  99.1087858597506
curr_Factors:  [99.10878586 -1.26511142 -0.97870014]
mat_Sqrt:  [[10.51083397  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03608021 -0.07337844  0.11337075]
Stock Position:  -0.036080214890140835
Bond Position:  [-1.1864637]


portfolio before change:  [-4.75682691]
curr_Stock_Price:  98.95215153386715
curr_Factors:  [98.95215153 -1.46809303 -0.97692001]
mat_Sqrt:  [[ 8.58162574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10122828 0.56439528 4.06954966]
Stock Position:  0.10122828116042315
Bond Position:  [-14.77358313]


portfolio before change:  [-4.79251351]
curr_Stock_Price:  98.61785975939625
curr_Factors:  [98.61785976 -1.64333364 -0.98416247]
mat_Sqrt:  [[ 7.12604421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00818643 -0.01075727 -0.05462835]
Stock Position:  -0.008186434316780712
Bond Position:  [-3.98518488]


portfolio before change:  [-4.79318749]
curr_Stock_Price:  98.6393344635997
curr_Factors:  [98.63933446 -1.73028725 -0.98809623]
mat_Sqrt:  [[ 6.5083543   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00432182 0.00090825 0.11141519]
Stock Position:  0.004321819152179433
Bond Position:  [-5.21948885]


portfolio before change:  [-4.79431475]
curr_Stock_Price:  98.52947663245847
curr_Factors:  [98.52947663 -1.64243342 -0.98792941]
mat_Sqrt:  [[ 7.09927689  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00998498  0.1174689   0.59058791]
Stock Position:  -0.009984976822766263
Bond Position:  [-3.81050021]


portfolio before change:  [-4.79632157]
curr_Stock_Price:  98.6827547579169
curr_Factors:  [98.68275476 -1.702695   -0.98200933]
mat_Sqrt:  [[ 6.73424615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178249 -0.05316355  0.3560924 ]
Stock Position:  -0.0017824901078031842
Bond Position:  [-4.62042054]


portfolio before change:  [-4.79703319]
curr_Stock_Price:  98.75794595233887
curr_Factors:  [98.75794595 -1.49287619 -0.96738505]
mat_Sqrt:  [[ 8.43517641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00568386  0.00815904 -0.11563569]
Stock Position:  0.0056838601666112055
Bond Position:  [-5.35835954]


portfolio before change:  [-4.79983457]
curr_Stock_Price:  98.38292925492408
curr_Factors:  [98.38292925 -1.4970187  -0.96932156]
mat_Sqrt:  [[ 8.35221723  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01699749 -0.02051329 -0.08883897]
Stock Position:  -0.01699749009587869
Bond Position:  [-3.1275717]


portfolio before change:  [-4.81996757]
curr_Stock_Price:  99.54439676033557
curr_Factors:  [99.54439676 -1.62002004 -0.95571855]
mat_Sqrt:  [[ 7.57508942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12528441  0.44829647 -0.70466905]
Stock Position:  0.12528441212984265
Bond Position:  [-17.2913288]


portfolio before change:  [-4.86960955]
curr_Stock_Price:  99.1654156080733
curr_Factors:  [99.16541561 -1.35698333 -0.95297818]
mat_Sqrt:  [[ 9.84366217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.15933515e-05  8.28239855e-03 -8.02413847e-02]
Stock Position:  -7.159335150380823e-05
Bond Position:  [-4.86250997]


portfolio before change:  [-4.87015232]
curr_Stock_Price:  98.25640041339948
curr_Factors:  [98.25640041 -1.19724979 -0.94866817]
mat_Sqrt:  [[11.49212971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05338833 -0.00370358 -2.56731199]
Stock Position:  -0.053388328364056443
Bond Position:  [0.37559264]


portfolio before change:  [-4.85479906]
curr_Stock_Price:  97.96970264432582
curr_Factors:  [97.96970264 -1.29512332 -0.94223085]
mat_Sqrt:  [[10.4573398   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.18396405 -1.08667497  8.13301706]
Stock Position:  0.18396404916294137
Bond Position:  [-22.87770225]


portfolio before change:  [-4.99703703]
curr_Stock_Price:  97.2120650371392
curr_Factors:  [97.21206504 -1.16092931 -0.94118295]
mat_Sqrt:  [[11.87912396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00081521 -0.01350835 -0.01975185]
Stock Position:  0.0008152064273200357
Bond Position:  [-5.07628493]


portfolio before change:  [-4.99696289]
curr_Stock_Price:  98.08143706968612
curr_Factors:  [98.08143707 -1.32527295 -0.95486223]
mat_Sqrt:  [[10.03082591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00478103  0.04894676 -0.24624764]
Stock Position:  0.0047810258415020785
Bond Position:  [-5.46589277]


portfolio before change:  [-5.00095116]
curr_Stock_Price:  97.3901637565654
curr_Factors:  [97.39016376 -1.42241231 -0.9323123 ]
mat_Sqrt:  [[ 9.24423962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186059  0.03339828 -0.37018868]
Stock Position:  0.0018605937410565954
Bond Position:  [-5.18215469]


portfolio before change:  [-5.00170199]
curr_Stock_Price:  97.33479543107059
curr_Factors:  [97.33479543 -1.46616918 -0.91124939]
mat_Sqrt:  [[ 9.03167609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07691537 -0.58670813 -0.5483535 ]
Stock Position:  -0.0769153670257357
Bond Position:  [2.48483952]


portfolio before change:  [-4.99065022]
curr_Stock_Price:  97.19514653263106
curr_Factors:  [97.19514653 -1.3313198  -0.92486986]
mat_Sqrt:  [[10.18108022  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00599739 -0.04726976  0.97004428]
Stock Position:  0.005997388567228911
Bond Position:  [-5.57356728]


portfolio before change:  [-4.98994128]
curr_Stock_Price:  97.42952933790394
curr_Factors:  [97.42952934 -1.50767214 -0.93937036]
mat_Sqrt:  [[ 8.4324456   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03795136 0.13715822 1.31434302]
Stock Position:  0.03795136142074865
Bond Position:  [-8.68752456]


portfolio before change:  [-5.00079846]
curr_Stock_Price:  97.17206348015029
curr_Factors:  [97.17206348 -1.50618184 -0.95149617]
mat_Sqrt:  [[ 8.32118978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00347931 -0.0021883   0.0504855 ]
Stock Position:  0.0034793100850681914
Bond Position:  [-5.3388902]


portfolio before change:  [-5.00125066]
curr_Stock_Price:  97.23391701136194
curr_Factors:  [97.23391701 -1.33134839 -0.91194399]
mat_Sqrt:  [[10.31735276  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01120025 -0.01670748  0.12096464]
Stock Position:  0.011200252237824556
Bond Position:  [-6.09029506]


portfolio before change:  [-4.99981928]
curr_Stock_Price:  97.42969078233388
curr_Factors:  [97.42969078 -1.50710749 -0.90374927]
mat_Sqrt:  [[ 8.7431824   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01031277 -0.02759299 -0.23415039]
Stock Position:  -0.010312766826657457
Bond Position:  [-3.99504959]


portfolio before change:  [-5.0003083]
curr_Stock_Price:  97.42868348359455
curr_Factors:  [97.42868348 -1.59911296 -0.91611639]
mat_Sqrt:  [[ 7.87656038  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02316649 -0.0018223  -0.32250993]
Stock Position:  -0.02316649136372418
Bond Position:  [-2.74322755]


portfolio before change:  [-4.99326065]
curr_Stock_Price:  97.10966354714976
curr_Factors:  [97.10966355 -1.64926934 -0.92746019]
mat_Sqrt:  [[ 7.38249276  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00967222  0.00190782 -0.07829119]
Stock Position:  0.00967221920201944
Bond Position:  [-5.93252661]


portfolio before change:  [-4.99105602]
curr_Stock_Price:  97.41427236463718
curr_Factors:  [97.41427236 -1.55747477 -0.94495553]
mat_Sqrt:  [[ 7.97684078  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210947 -0.01710589  0.59176002]
Stock Position:  0.0021094694383122954
Bond Position:  [-5.19654845]


portfolio before change:  [-4.99121773]
curr_Stock_Price:  97.64556514704127
curr_Factors:  [97.64556515 -1.56980594 -0.97253104]
mat_Sqrt:  [[ 7.68297821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03459813 -0.03222297  0.40364697]
Stock Position:  0.03459813063917939
Bond Position:  [-8.36957175]


portfolio before change:  [-4.99276737]
curr_Stock_Price:  97.63101584138687
curr_Factors:  [97.63101584 -1.47817487 -0.97415783]
mat_Sqrt:  [[ 8.40530054  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136604 -0.05950053 -0.25765658]
Stock Position:  -0.0013660360034978504
Bond Position:  [-4.85939989]


portfolio before change:  [-4.993027]
curr_Stock_Price:  97.37638942533879
curr_Factors:  [97.37638943 -1.39379232 -0.96932488]
mat_Sqrt:  [[ 9.16568456  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01024115 -0.00139024  0.15989014]
Stock Position:  0.01024114847707393
Bond Position:  [-5.99027306]


portfolio before change:  [-4.99264684]
curr_Stock_Price:  97.48663056898852
curr_Factors:  [97.48663057 -1.14362552 -0.9854504 ]
mat_Sqrt:  [[11.59575792  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00614549  0.03279801 -0.00670824]
Stock Position:  -0.006145492796502592
Bond Position:  [-4.39354345]


portfolio before change:  [-4.99588151]
curr_Stock_Price:  97.92360805160685
curr_Factors:  [97.92360805 -0.92380001 -0.95506515]
mat_Sqrt:  [[14.95914041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0022866  -0.00429066 -0.22944447]
Stock Position:  0.0022865994271325176
Bond Position:  [-5.21979357]


portfolio before change:  [-4.99656221]
curr_Stock_Price:  97.91127997810933
curr_Factors:  [97.91127998 -1.18376302 -0.93180731]
mat_Sqrt:  [[11.80462538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00588148  0.00369333 -0.11072862]
Stock Position:  -0.005881482148113516
Bond Position:  [-4.42069877]


portfolio before change:  [-4.99702945]
curr_Stock_Price:  97.89676267364342
curr_Factors:  [97.89676267 -0.88786316 -0.94774302]
mat_Sqrt:  [[15.61617597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00566153 -0.00776141  0.1102647 ]
Stock Position:  -0.005661528738276137
Bond Position:  [-4.44278411]


portfolio before change:  [-4.99746871]
curr_Stock_Price:  97.87625154348662
curr_Factors:  [97.87625154 -0.99233918 -0.95044186]
mat_Sqrt:  [[14.02614246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00477913 -0.00559518 -0.01644112]
Stock Position:  -0.004779132293573473
Bond Position:  [-4.52970515]


portfolio before change:  [-4.99572108]
curr_Stock_Price:  97.39208968600673
curr_Factors:  [97.39208969 -1.00744535 -0.97090374]
mat_Sqrt:  [[13.46906942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00586372  0.00476616  0.14778515]
Stock Position:  -0.005863724549092523
Bond Position:  [-4.4246407]


portfolio before change:  [-4.99029775]
curr_Stock_Price:  96.37286674464214
curr_Factors:  [96.37286674 -0.86271508 -0.97511463]
mat_Sqrt:  [[15.33894454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00904692 -0.02027723 -0.2106062 ]
Stock Position:  -0.009046921240714838
Bond Position:  [-4.11842002]


portfolio before change:  [-4.98973628]
curr_Stock_Price:  96.253896967239
curr_Factors:  [96.25389697 -0.82426747 -1.00300508]
mat_Sqrt:  [[15.48260141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.13148099 0.37061775 0.42163053]
Stock Position:  0.1314809908543069
Bond Position:  [-17.64529403]


portfolio before change:  [-4.9497806]
curr_Stock_Price:  96.57456290404275
curr_Factors:  [96.5745629  -0.6291991  -0.99939581]
mat_Sqrt:  [[18.94841848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00029118 -0.01498627  0.10432546]
Stock Position:  0.00029118368680401555
Bond Position:  [-4.97790154]


portfolio before change:  [-4.95028102]
curr_Stock_Price:  96.99305248386091
curr_Factors:  [96.99305248 -0.44370094 -0.99638182]
mat_Sqrt:  [[22.97844459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078705 -0.00470288 -0.15298795]
Stock Position:  0.0007870500803951965
Bond Position:  [-5.02661941]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.94994405]
Stock Price:  98.21958331005222
PL:  [-4.94994405]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.56586714e-01  1.01402439e-02 -9.12774564e-02]
 [ 1.81388033e+00  4.24922297e-01  6.43747149e-01]
 [-1.64663228e-01 -6.50987068e-02  3.45996145e-02]
 [ 1.21915388e-01  8.29481772e-01  7.59209899e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-9.57130418e-05  1.58900403e-01 -6.36225542e-02]
 [-5.59237754e-02  1.00386775e-02 -6.19366580e-02]
 [-5.44014695e-02  1.04261136e-01  8.67050095e-03]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 7.87258082e-01  1.59737484e+00 -2.53435431e-01]
 [-4.61693686e-04  1.97074187e-02  1.03916814e-02]
 [-3.87896160e-01 -7.29156978e-03 -8.26901144e-01]
 [ 1.94344496e+00 -3.41532471e+00  2.88298814e+00]
 [ 2.99981645e-02 -8.41876801e-02  1.93874597e-02]
 [ 8.63637242e-02  5.18174442e-02 -4.29358998e-02]
 [-3.95165543e-02  3.13006441e-02 -7.88001192e-02]
 [-2.76532207e-01 -1.78656786e+00 -1.97046789e-01]
 [ 9.25318095e-03 -4.11228180e-02  1.85001024e-01]
 [ 1.27791450e-01  1.36614478e-01  3.14377547e-01]
 [ 3.01262582e-02 -4.51461734e-02  4.56366542e-02]
 [ 1.08725263e-01 -5.08454314e-02  2.40075388e-02]
 [ 1.14134963e-01  3.10328780e-02  3.52750414e-02]
 [-5.99778274e-02 -5.40178578e-02  7.96645898e-02]
 [ 6.52584975e-02 -5.00238166e-03 -1.66415672e-02]
 [ 5.25853934e-02 -4.11879939e-02  2.95996435e-01]
 [-2.03033561e-01 -1.37081322e-01 -7.43150399e-02]
 [-1.45721249e-01  1.07817829e-01  2.09717602e-01]
 [ 2.38501625e-02 -4.26044326e-02  5.28520147e-02]
 [-7.13989657e-02  9.51856485e-02  4.71568500e-03]
 [ 5.86816066e-02 -1.54687844e-02 -8.16039449e-02]
 [-2.70686046e-02  2.31599016e-03 -4.60193356e-02]
 [-4.99707253e-02 -8.27713516e-03  4.57298621e-02]
 [-3.72141787e-02 -2.54258571e-02 -6.81255028e-03]
 [-1.00712746e-01  9.02114258e-02  2.82052365e-02]
 [-9.92412502e-02 -5.62067326e-02 -6.27097002e-02]
 [ 1.51945661e+00  9.89822378e-01  1.37799875e-01]
 [ 7.88231578e-02 -1.37722419e-01  6.44934212e-02]
 [ 2.97386355e-02 -1.53755174e-02 -1.70272857e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.5902391]
curr_Stock_Price:  101.25305422253616
curr_Factors:  [101.25305422  -1.15528626  -1.00234828]
mat_Sqrt:  [[11.70467498  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01196314  0.00327275 -0.26038918]
Stock Position:  0.011963138698940844
Bond Position:  [10.37893477]


portfolio before change:  [11.60083699]
curr_Stock_Price:  102.03047935769487
curr_Factors:  [102.03047936  -1.02633775  -1.00975988]
mat_Sqrt:  [[13.31876517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.15256832 0.13714308 1.83643143]
Stock Position:  0.15256831545272379
Bond Position:  [-3.96578137]


portfolio before change:  [11.41173633]
curr_Stock_Price:  100.79427965986655
curr_Factors:  [100.79427966  -0.88259182  -1.02597875]
mat_Sqrt:  [[14.94700635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01143298 -0.02101052  0.09870307]
Stock Position:  -0.011432980328582955
Bond Position:  [12.56411535]


portfolio before change:  [11.41104405]
curr_Stock_Price:  100.99220701266896
curr_Factors:  [100.99220701  -0.72964891  -1.02087073]
mat_Sqrt:  [[17.54069685  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02543831 0.26771409 2.16581452]
Stock Position:  0.025438311869244206
Bond Position:  [8.84197279]


portfolio before change:  [11.3800919]
curr_Stock_Price:  99.73200315898953
curr_Factors:  [99.73200316 -0.61119339 -1.04020496]
mat_Sqrt:  [[19.1267576   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306618 -0.01106097 -0.05874131]
Stock Position:  -0.003066175782153109
Bond Position:  [11.68588776]


portfolio before change:  [11.38154039]
curr_Stock_Price:  99.73602733902986
curr_Factors:  [99.73602734 -0.59020228 -1.03428238]
mat_Sqrt:  [[19.64931184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098491  0.05128488 -0.18149744]
Stock Position:  0.0009849096309307336
Bond Position:  [11.28330942]


portfolio before change:  [11.3817923]
curr_Stock_Price:  98.55967921293423
curr_Factors:  [98.55967921 -0.6527941  -1.02887073]
mat_Sqrt:  [[18.33840364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362722  0.00323997 -0.17668805]
Stock Position:  -0.0036272190125945128
Bond Position:  [11.73928984]


portfolio before change:  [11.38318118]
curr_Stock_Price:  98.58135324549247
curr_Factors:  [98.58135325 -0.74910243 -1.0261066 ]
mat_Sqrt:  [[16.70441581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187671  0.03365014  0.02473453]
Stock Position:  -0.0018767130786272188
Bond Position:  [11.5681901]


portfolio before change:  [11.38494365]
curr_Stock_Price:  98.41278755469168
curr_Factors:  [98.41278755 -0.89958063 -1.0184349 ]
mat_Sqrt:  [[14.45666019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00359635  0.0064198  -0.11330016]
Stock Position:  0.003596349549245349
Bond Position:  [11.03101686]


portfolio before change:  [11.38354716]
curr_Stock_Price:  97.64104763287963
curr_Factors:  [97.64104763 -0.89839204 -1.03672629]
mat_Sqrt:  [[14.10006828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [6.19904266e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  6.199042655770064e-05
Bond Position:  [11.37749435]


portfolio before change:  [11.3849987]
curr_Stock_Price:  98.11315156860998
curr_Factors:  [98.11315157 -0.90040838 -1.00888834]
mat_Sqrt:  [[14.53885469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07301734  0.51555051 -0.72298074]
Stock Position:  0.07301734474645573
Bond Position:  [4.22103689]


portfolio before change:  [11.44764598]
curr_Stock_Price:  98.96390306718881
curr_Factors:  [98.96390307 -1.10320272 -0.98050525]
mat_Sqrt:  [[12.31782246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0004613  0.00636054 0.02964457]
Stock Position:  0.0004613038877546478
Bond Position:  [11.40199355]


portfolio before change:  [11.44906193]
curr_Stock_Price:  98.94355271619784
curr_Factors:  [98.94355272 -1.38758481 -0.97262517]
mat_Sqrt:  [[ 9.34031081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.97597923e-02 -2.35334403e-03 -2.35891880e+00]
Stock Position:  -0.0597597923367303
Bond Position:  [17.3619081]


portfolio before change:  [11.43894824]
curr_Stock_Price:  99.14911012489424
curr_Factors:  [99.14911012 -1.36574447 -0.99470679]
mat_Sqrt:  [[ 9.35745747  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.196077   -1.10229131  8.22436269]
Stock Position:  0.19607700252705176
Bond Position:  [-8.00191208]


portfolio before change:  [11.48578902]
curr_Stock_Price:  99.39310142668243
curr_Factors:  [99.39310143 -1.3759821  -1.02783418]
mat_Sqrt:  [[ 8.98239392  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186708 -0.02717146  0.05530703]
Stock Position:  0.0018670829900958022
Bond Position:  [11.30021385]


portfolio before change:  [11.48737155]
curr_Stock_Price:  99.4841039821218
curr_Factors:  [99.48410398 -1.5302465  -1.01899936]
mat_Sqrt:  [[ 7.77374484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01134288  0.01672401 -0.12248417]
Stock Position:  0.01134288090179141
Bond Position:  [10.3589352]


portfolio before change:  [11.48483097]
curr_Stock_Price:  99.14596027429789
curr_Factors:  [99.14596027 -1.29481603 -1.02765323]
mat_Sqrt:  [[ 9.71939966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00506331  0.01010224 -0.22479481]
Stock Position:  -0.005063311093763648
Bond Position:  [11.98683781]


portfolio before change:  [11.48357435]
curr_Stock_Price:  99.69008392923078
curr_Factors:  [99.69008393 -1.26744686 -1.02974545]
mat_Sqrt:  [[10.02291431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0679878  -0.5766123  -0.56211964]
Stock Position:  -0.06798779586512094
Bond Position:  [18.26128343]


portfolio before change:  [11.51168265]
curr_Stock_Price:  99.31022902032429
curr_Factors:  [99.31022902 -0.93315744 -1.0383716 ]
mat_Sqrt:  [[13.828332    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00279298 -0.01327233  0.52775643]
Stock Position:  0.0027929758132364843
Bond Position:  [11.23431158]


portfolio before change:  [11.51245772]
curr_Stock_Price:  99.08491133682948
curr_Factors:  [99.08491134 -0.78592613 -1.04518793]
mat_Sqrt:  [[15.87686653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01384718 0.04409213 0.89683164]
Stock Position:  0.01384717893024031
Bond Position:  [10.14041123]


portfolio before change:  [11.50795905]
curr_Stock_Price:  98.66848678226515
curr_Factors:  [98.66848678 -0.83737144 -1.04621847]
mat_Sqrt:  [[15.00188264  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00201484 -0.01457086  0.13018867]
Stock Position:  0.0020148389278819043
Bond Position:  [11.30915794]


portfolio before change:  [11.50952047]
curr_Stock_Price:  98.74178932026709
curr_Factors:  [98.74178932 -1.02007364 -1.02871336]
mat_Sqrt:  [[12.72694318  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00811247 -0.01641029  0.06848683]
Stock Position:  0.008112474459050476
Bond Position:  [10.70848023]


portfolio before change:  [11.51408908]
curr_Stock_Price:  99.1399369152604
curr_Factors:  [99.13993692 -0.81508029 -1.04613694]
mat_Sqrt:  [[15.41460012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00828241 0.01001582 0.10062987]
Stock Position:  0.008282408165495594
Bond Position:  [10.69297166]


portfolio before change:  [11.50934611]
curr_Stock_Price:  98.40588989341457
curr_Factors:  [98.40588989 -0.94077221 -1.06968908]
mat_Sqrt:  [[13.17919391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00415372 -0.01743419  0.2272609 ]
Stock Position:  -0.004153722188669704
Bond Position:  [11.91809684]


portfolio before change:  [11.51277452]
curr_Stock_Price:  97.939186861052
curr_Factors:  [97.93918686 -0.83424074 -1.04352185]
mat_Sqrt:  [[14.97802543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00406198 -0.00161451 -0.04747376]
Stock Position:  0.004061980345333672
Bond Position:  [11.11494746]


portfolio before change:  [11.51602019]
curr_Stock_Price:  98.39616017163448
curr_Factors:  [98.39616017 -0.69287958 -1.08360447]
mat_Sqrt:  [[16.65179013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00628148 -0.01329337  0.84439544]
Stock Position:  0.006281483720161527
Bond Position:  [10.89794631]


portfolio before change:  [11.5078935]
curr_Stock_Price:  96.88552691315766
curr_Factors:  [96.88552691 -0.55224699 -1.06921294]
mat_Sqrt:  [[19.14554815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01285859 -0.04424281 -0.21200012]
Stock Position:  -0.012858585228343723
Bond Position:  [12.7537043]


portfolio before change:  [11.50099529]
curr_Stock_Price:  97.54598238918672
curr_Factors:  [97.54598239 -0.54653635 -1.03638076]
mat_Sqrt:  [[20.03351807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403846  0.03479805  0.59826594]
Stock Position:  -0.004038461963311978
Bond Position:  [11.89493103]


portfolio before change:  [11.49754306]
curr_Stock_Price:  98.76901938339348
curr_Factors:  [98.76901938 -0.75717074 -1.06141685]
mat_Sqrt:  [[16.02574349  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00161877 -0.01375052  0.15077209]
Stock Position:  0.001618766793519369
Bond Position:  [11.33765905]


portfolio before change:  [11.49799373]
curr_Stock_Price:  98.17187958821683
curr_Factors:  [98.17187959 -0.86433958 -1.05620197]
mat_Sqrt:  [[14.38488876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00354585  0.03072104  0.01345254]
Stock Position:  -0.0035458523311016578
Bond Position:  [11.84609671]


portfolio before change:  [11.50292805]
curr_Stock_Price:  97.19793243521674
curr_Factors:  [97.19793244 -0.42506918 -1.04642717]
mat_Sqrt:  [[22.31486594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00174174 -0.00499253 -0.23279334]
Stock Position:  0.0017417410808377666
Bond Position:  [11.33363442]


portfolio before change:  [11.50396492]
curr_Stock_Price:  96.97980526690674
curr_Factors:  [96.97980527 -0.32313349 -1.00471018]
mat_Sqrt:  [[25.7043204   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140013  0.00074748 -0.13128036]
Stock Position:  -0.0014001347644310453
Bond Position:  [11.63974972]


portfolio before change:  [11.50458894]
curr_Stock_Price:  97.57335225787727
curr_Factors:  [97.57335226 -0.31610461 -0.993809  ]
mat_Sqrt:  [[26.32952203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00160754 -0.00267143  0.13045457]
Stock Position:  -0.001607538464335171
Bond Position:  [11.66144186]


portfolio before change:  [11.50725434]
curr_Stock_Price:  96.82212367077602
curr_Factors:  [96.82212367 -0.1343553  -0.99971515]
mat_Sqrt:  [[31.14971442  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140595 -0.00820616 -0.01943431]
Stock Position:  -0.0014059459882379008
Bond Position:  [11.64338101]


portfolio before change:  [11.51109586]
curr_Stock_Price:  95.12503743596524
curr_Factors:  [95.12503744 -0.11537927 -0.9928031 ]
mat_Sqrt:  [[31.40634177  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243712  0.02911561  0.08046169]
Stock Position:  -0.002437120709964994
Bond Position:  [11.74292706]


portfolio before change:  [11.51640605]
curr_Stock_Price:  93.54849183690943
curr_Factors:  [93.54849184 -0.26918351 -0.9989166 ]
mat_Sqrt:  [[26.32133467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00469258 -0.01814064 -0.17889332]
Stock Position:  -0.004692579879011355
Bond Position:  [11.95538982]


portfolio before change:  [11.51827275]
curr_Stock_Price:  93.4691803915723
curr_Factors:  [93.46918039 -0.31676384 -1.02519588]
mat_Sqrt:  [[24.42658394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07162817 0.3194638  0.39310469]
Stock Position:  0.07162817111053996
Bond Position:  [4.8232463]


portfolio before change:  [11.5636693]
curr_Stock_Price:  94.09454338510102
curr_Factors:  [94.09454339 -0.41063275 -1.03477615]
mat_Sqrt:  [[22.17335094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00288073 -0.04444972  0.18398178]
Stock Position:  0.0028807261165272485
Bond Position:  [11.29260869]


portfolio before change:  [11.56361485]
curr_Stock_Price:  93.58560581914828
curr_Factors:  [93.58560582 -0.51368581 -1.00643306]
mat_Sqrt:  [[20.46585136  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011299  -0.00496243 -0.04857411]
Stock Position:  0.0011299036903395252
Bond Position:  [11.45787213]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.56406951]
Stock Price:  92.72034416042494
PL:  [11.56406951]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-2.73432611e-02 -7.59870930e-02  2.00742322e-01]
 [ 9.14779658e-01  2.27848662e-01  2.58529389e-01]
 [-4.04915937e-01 -2.86246365e-01  4.16074435e-02]
 [ 3.02143385e-01  1.79650513e+00  1.84965629e+00]
 [-1.43180609e-01  4.09881952e-01  4.02708795e-01]
 [-7.95135781e-02  6.05608451e-01 -3.16252751e-01]
 [-1.85702603e-01  1.12809686e-01  4.77564681e-01]
 [-1.47623515e-02  2.16811893e-02  4.21432393e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-3.91591187e-02 -1.17224815e-02  2.65578271e-02]
 [ 9.76134194e-01  1.88672884e+00 -3.36561586e-01]
 [-8.13111706e-04 -2.85507703e-02  9.86270382e-02]
 [-2.36139091e-01  8.53849158e-03 -5.15098834e-01]
 [ 1.73012533e+00 -2.76375139e+00  2.33337820e+00]
 [ 5.92982719e-03 -9.19399145e-02  3.55983821e-02]
 [ 6.81744053e-02  1.50089623e-01 -1.04113691e-01]
 [-1.13611038e-01 -1.25192368e-01 -4.90575066e-02]
 [-2.77424216e-01 -1.80953459e+00 -2.03508085e-01]
 [ 8.69716684e-03  2.62341392e-02  1.53237004e-02]
 [ 1.57800173e-01 -2.41202786e-01  1.14041693e-01]
 [ 4.39216990e-02 -1.46953002e-02  7.74750081e-02]
 [ 1.09948483e-01 -5.05482821e-02  8.21156225e-03]
 [ 4.34494673e-01 -1.60903401e-02  1.01389753e-01]
 [-1.00359484e-01 -2.46192664e-02  6.77687348e-02]
 [ 3.77016186e-02 -1.16163426e-01  2.04704130e-02]
 [ 5.72393246e-02 -5.50260464e-03  1.89843907e-01]
 [ 1.00220419e-01 -7.34103429e-02  3.83450547e-02]
 [-6.89256708e-02  5.26641475e-02  1.16595866e-01]
 [-1.01426597e-02 -7.55570357e-02 -4.21031593e-03]
 [ 1.07628921e-01 -8.92825040e-03  5.90853596e-02]
 [-2.52447129e-02 -6.78260449e-02 -3.05183550e-02]
 [ 4.63307927e-02  1.16562434e-02 -5.36993313e-02]
 [-3.62594771e-02 -9.80857712e-03 -4.95019331e-02]
 [ 4.64080660e-01  7.71345618e-02  1.16411405e-01]
 [ 4.61469457e-02  5.78277711e-02 -4.56591487e-02]
 [-2.27503684e-02  1.40808762e-02  1.33121059e-03]
 [ 2.09177710e+00  1.46068451e+00  1.82065861e-01]
 [-8.91061120e-02 -2.57236192e-02 -2.19407205e-02]
 [ 3.71724791e-02 -1.28735429e-02 -1.55611728e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.7163592]
curr_Stock_Price:  99.16429133532142
curr_Factors:  [99.16429134 -0.87018149 -0.98094898]
mat_Sqrt:  [[15.57469557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.20561364e-04 -2.45247288e-02  5.72661970e-01]
Stock Position:  -0.00012056136379520227
Bond Position:  [-3.70440382]


portfolio before change:  [-3.71692912]
curr_Stock_Price:  100.05042514624645
curr_Factors:  [100.05042515  -0.76520978  -0.95524478]
mat_Sqrt:  [[17.90750242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05662773 0.07353784 0.73751239]
Stock Position:  0.05662772721447232
Bond Position:  [-9.3825573]


portfolio before change:  [-3.78827282]
curr_Stock_Price:  98.81126517153591
curr_Factors:  [98.81126517 -0.68029779 -0.95276089]
mat_Sqrt:  [[19.3009233   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02356637 -0.09238562  0.11869446]
Stock Position:  -0.023566367304600374
Bond Position:  [-1.45965025]


portfolio before change:  [-3.75385032]
curr_Stock_Price:  97.34286020864822
curr_Factors:  [97.34286021 -0.6719073  -0.95356173]
mat_Sqrt:  [[19.15895759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05461743 0.57981954 5.27655456]
Stock Position:  0.05461742711840488
Bond Position:  [-9.07046689]


portfolio before change:  [-3.90035665]
curr_Stock_Price:  94.68121068379115
curr_Factors:  [94.68121068 -0.66216679 -0.98141911]
mat_Sqrt:  [[18.3005236   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00123979 0.13228883 1.1488161 ]
Stock Position:  0.0012397887163623786
Bond Position:  [-4.01774135]


portfolio before change:  [-3.89983926]
curr_Stock_Price:  95.50364321958675
curr_Factors:  [95.50364322 -0.53627942 -0.99293844]
mat_Sqrt:  [[20.69612622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098806  0.19545929 -0.90218107]
Stock Position:  -0.0009880638052342816
Bond Position:  [-3.80547556]


portfolio before change:  [-3.89995557]
curr_Stock_Price:  95.13990049957172
curr_Factors:  [95.1399005  -0.33527756 -0.9929123 ]
mat_Sqrt:  [[25.20792893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258621  0.03640917  1.36235911]
Stock Position:  -0.002586207712633561
Bond Position:  [-3.65390402]


portfolio before change:  [-3.90540163]
curr_Stock_Price:  97.06909433849081
curr_Factors:  [97.06909434 -0.11995835 -0.99511176]
mat_Sqrt:  [[31.82820741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.44876620e-05  6.99757375e-03  1.20222931e-01]
Stock Position:  -5.448766200922977e-05
Bond Position:  [-3.90011256]


portfolio before change:  [-3.90596108]
curr_Stock_Price:  98.38871446320047
curr_Factors:  [98.38871446 -0.44438779 -0.97461002]
mat_Sqrt:  [[23.8057775   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00218397  0.0064198  -0.11330016]
Stock Position:  0.002183974177494758
Bond Position:  [-4.12083949]


portfolio before change:  [-3.90338037]
curr_Stock_Price:  99.80624343578774
curr_Factors:  [99.80624344 -0.28367319 -0.96092664]
mat_Sqrt:  [[28.74980287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125673 -0.00378341  0.07576209]
Stock Position:  -0.001256734405992678
Bond Position:  [-3.77795043]


portfolio before change:  [-3.90362061]
curr_Stock_Price:  99.62161120120953
curr_Factors:  [99.6216112  -0.49656981 -0.97849093]
mat_Sqrt:  [[22.78992125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05671633  0.60893911 -0.96011652]
Stock Position:  0.05671633283092492
Bond Position:  [-9.55379307]


portfolio before change:  [-3.91237203]
curr_Stock_Price:  99.48836691974982
curr_Factors:  [99.48836692 -0.4049171  -1.02787672]
mat_Sqrt:  [[23.74203023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056824 -0.00921472  0.28135549]
Stock Position:  0.000568238960980487
Bond Position:  [-3.9689052]


portfolio before change:  [-3.91249494]
curr_Stock_Price:  100.14519340753442
curr_Factors:  [100.14519341  -0.3269883   -1.03289534]
mat_Sqrt:  [[25.7063343   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01320843  0.00275579 -1.4694336 ]
Stock Position:  -0.01320842887266748
Bond Position:  [-2.58973428]


portfolio before change:  [-3.89680147]
curr_Stock_Price:  98.93254229593644
curr_Factors:  [ 9.89325423e+01 -6.42005697e-02 -1.04107933e+00]
mat_Sqrt:  [[32.75836418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05013302 -0.89199693  6.65647852]
Stock Position:  0.050133021393245505
Bond Position:  [-8.85658872]


portfolio before change:  [-3.90709741]
curr_Stock_Price:  98.7492538812344
curr_Factors:  [98.74925388 -0.20135231 -1.03392472]
mat_Sqrt:  [[28.71176078  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00019403 -0.02967348  0.10155228]
Stock Position:  -0.0001940264129847609
Bond Position:  [-3.88793745]


portfolio before change:  [-3.90742346]
curr_Stock_Price:  97.924769351911
curr_Factors:  [97.92476935 -0.2478432  -1.03736061]
mat_Sqrt:  [[27.08542379  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0028635   0.04844122 -0.29700738]
Stock Position:  0.0028635033985187114
Bond Position:  [-4.18783137]


portfolio before change:  [-3.8979472]
curr_Stock_Price:  101.41691624901841
curr_Factors:  [101.41691625  -0.13067227  -1.06358297]
mat_Sqrt:  [[30.72217346  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00485576 -0.04040566 -0.13994741]
Stock Position:  -0.004855764675962317
Bond Position:  [-3.40549052]


portfolio before change:  [-3.89637288]
curr_Stock_Price:  101.00502886571195
curr_Factors:  [101.00502887  -0.10687017  -1.0703326 ]
mat_Sqrt:  [[31.12363618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02211614 -0.58402478 -0.58055192]
Stock Position:  -0.02211614435274066
Bond Position:  [-1.66253108]


portfolio before change:  [-3.8860497]
curr_Stock_Price:  100.52886020647112
curr_Factors:  [100.52886021   0.28156875  -1.05894915]
mat_Sqrt:  [[46.20391091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00037183 0.00846703 0.04371425]
Stock Position:  0.00037183270829076203
Bond Position:  [-3.92342962]


portfolio before change:  [-3.88621682]
curr_Stock_Price:  101.39842696486502
curr_Factors:  [101.39842696   0.10793165  -1.05791444]
mat_Sqrt:  [[39.21560648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00336202 -0.07784786  0.32532921]
Stock Position:  0.0033620166988826273
Bond Position:  [-4.22712003]


portfolio before change:  [-3.88910911]
curr_Stock_Price:  100.69531764582385
curr_Factors:  [ 1.00695318e+02 -2.39903739e-02 -1.06570808e+00]
mat_Sqrt:  [[33.86563718  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00167534 -0.00474289  0.22101463]
Stock Position:  0.0016753428529199881
Bond Position:  [-4.05780829]


portfolio before change:  [-3.89089359]
curr_Stock_Price:  99.93295650003711
curr_Factors:  [ 9.99329565e+01  8.44221390e-02 -1.07152278e+00]
mat_Sqrt:  [[37.24057483  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00272033 -0.01631439  0.0234253 ]
Stock Position:  0.0027203268574584553
Bond Position:  [-4.16274389]


portfolio before change:  [-3.89639911]
curr_Stock_Price:  98.100401709229
curr_Factors:  [98.10040171  0.20689463 -1.03568055]
mat_Sqrt:  [[42.82857602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01055151 -0.00519313  0.28923674]
Stock Position:  0.010551514540091511
Bond Position:  [-4.93150692]


portfolio before change:  [-3.9029271]
curr_Stock_Price:  97.54014873922314
curr_Factors:  [ 9.75401487e+01  6.60910731e-02 -1.01456244e+00]
mat_Sqrt:  [[37.78048544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242325 -0.00794583  0.19332534]
Stock Position:  -0.002423251977834287
Bond Position:  [-3.66656274]


portfolio before change:  [-3.90569604]
curr_Stock_Price:  98.49365645493046
curr_Factors:  [ 9.84936565e+01  6.11318177e-02 -1.00503716e+00]
mat_Sqrt:  [[38.32440113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047407 -0.03749158  0.05839639]
Stock Position:  0.00047406779214653185
Bond Position:  [-3.95238871]


portfolio before change:  [-3.90530398]
curr_Stock_Price:  100.36288926232498
curr_Factors:  [ 1.00362889e+02  5.34812023e-02 -1.03771032e+00]
mat_Sqrt:  [[37.50834325  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00252925 -0.00177596  0.54157182]
Stock Position:  0.0025292462202264414
Bond Position:  [-4.15914644]


portfolio before change:  [-3.90262994]
curr_Stock_Price:  101.62570339115862
curr_Factors:  [101.62570339  -0.18018201  -1.05680559]
mat_Sqrt:  [[29.4975996   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00315493 -0.02369309  0.10938777]
Stock Position:  0.003154926104497936
Bond Position:  [-4.22325152]


portfolio before change:  [-3.89884416]
curr_Stock_Price:  102.99299986632407
curr_Factors:  [102.99299987  -0.38139177  -1.0651446 ]
mat_Sqrt:  [[24.24292097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141797  0.01699728  0.33261555]
Stock Position:  -0.0014179650755763568
Bond Position:  [-3.75280368]


portfolio before change:  [-3.89949202]
curr_Stock_Price:  103.11905034959571
curr_Factors:  [103.11905035  -0.4063073   -1.06085748]
mat_Sqrt:  [[23.77701533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111137 -0.02438593 -0.01201086]
Stock Position:  -0.0011113717114685647
Bond Position:  [-3.78488843]


portfolio before change:  [-3.90034249]
curr_Stock_Price:  103.4585629295816
curr_Factors:  [103.45856293  -0.59456037  -1.051317  ]
mat_Sqrt:  [[19.95129001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00590775 -0.00288158  0.16855408]
Stock Position:  0.005907748223537746
Bond Position:  [-4.51154963]


portfolio before change:  [-3.89499598]
curr_Stock_Price:  104.45902699747883
curr_Factors:  [104.459027    -0.81562306  -1.06422783]
mat_Sqrt:  [[15.94179093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284279 -0.02189076 -0.08706037]
Stock Position:  -0.002842790978543769
Bond Position:  [-3.5980408]


portfolio before change:  [-3.89665549]
curr_Stock_Price:  104.88457020882065
curr_Factors:  [104.88457021  -0.79116365  -1.09596019]
mat_Sqrt:  [[15.89074049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00237552  0.00376204 -0.15318925]
Stock Position:  0.0023755207234607105
Bond Position:  [-4.14581096]


portfolio before change:  [-3.89798252]
curr_Stock_Price:  104.54411008799975
curr_Factors:  [104.54411009  -1.1350612   -1.07847428]
mat_Sqrt:  [[11.42808145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423222 -0.0031657  -0.14121524]
Stock Position:  -0.0042322225754507
Bond Position:  [-3.45552858]


portfolio before change:  [-3.8986356]
curr_Stock_Price:  104.59635498876581
curr_Factors:  [104.59635499  -1.08704587  -1.08182998]
mat_Sqrt:  [[11.95599538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04212013 0.02489507 0.33208934]
Stock Position:  0.04212012880384894
Bond Position:  [-8.30424754]


portfolio before change:  [-3.89042281]
curr_Stock_Price:  104.81598587873259
curr_Factors:  [104.81598588  -1.01706309  -1.08187136]
mat_Sqrt:  [[12.84907523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00378477  0.01866383 -0.13025284]
Stock Position:  0.0037847747418979683
Bond Position:  [-4.28712771]


portfolio before change:  [-3.89190993]
curr_Stock_Price:  104.56466599679584
curr_Factors:  [104.564666    -0.96383468  -1.06846322]
mat_Sqrt:  [[13.70153399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143082  0.00454458  0.00379757]
Stock Position:  -0.001430817117019698
Bond Position:  [-3.74229701]


portfolio before change:  [-3.89238263]
curr_Stock_Price:  104.56808375868528
curr_Factors:  [104.56808376  -0.86519722  -1.0580327 ]
mat_Sqrt:  [[15.28097297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.15883165 0.4714339  0.51938322]
Stock Position:  0.15883164769811944
Bond Position:  [-20.50110367]


portfolio before change:  [-3.88536111]
curr_Stock_Price:  104.62842640185526
curr_Factors:  [104.6284264   -0.96163194  -1.07488093]
mat_Sqrt:  [[13.65222351  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00723952 -0.00830226 -0.06259077]
Stock Position:  -0.007239520691100668
Bond Position:  [-3.12790145]


portfolio before change:  [-3.88748951]
curr_Stock_Price:  104.86841376044548
curr_Factors:  [104.86841376  -0.76616761  -1.06157735]
mat_Sqrt:  [[16.86029418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.64918065e-04 -4.15491811e-03 -4.43916947e-01]
Stock Position:  0.0001649180651826524
Bond Position:  [-3.90478421]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.88823848]
Stock Price:  103.28678093952986
PL:  [-7.17501942]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 5.23412545e-02 -4.64369593e-02  6.20947494e-02]
 [ 1.12826013e+00  2.35042708e-01  3.19916954e-01]
 [-5.77159018e-02  3.98508649e-02  3.47374536e-02]
 [ 1.35377414e-01  1.01372363e+00  8.61783183e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.11834985e-02 -4.66380963e-02  3.84835867e-02]
 [-5.69075861e-02  1.27915240e-02 -6.00417292e-02]
 [-6.34330807e-02  1.25943358e-01  6.51462416e-04]
 [ 4.53674718e-02  3.14383175e-02 -4.14708440e-02]
 [-1.33919866e-01 -7.05647924e-02 -3.89411518e-02]
 [ 8.33168119e-01  1.60930662e+00 -2.88354630e-01]
 [ 2.16593931e-04 -1.67473745e-02 -5.73868452e-02]
 [-5.25706086e-02  1.04678227e-03 -9.52528533e-02]
 [ 1.34171944e+00 -2.58417462e+00  2.21026897e+00]
 [ 4.08653880e-02 -1.02673275e-01  5.85293100e-02]
 [ 1.65879336e-01 -1.18552821e-01  3.42981536e-02]
 [-2.87805217e-01 -5.00392431e-01  1.68573917e-02]
 [-2.49146676e-01 -1.65009291e+00 -2.04083447e-01]
 [ 1.30094623e-03  3.72499194e-02  5.83893053e-02]
 [ 4.38676652e-01 -6.43202762e-01  2.77979961e-01]
 [ 7.40051803e-02  2.60683689e-01 -3.04571757e-01]
 [-3.14214354e-01 -4.80756744e-02 -2.05631596e-01]
 [ 3.92364465e-01  3.73831149e-01  3.48496165e-01]
 [ 3.76580469e-02  7.60938020e-02  1.76986592e-01]
 [-9.24188242e-02 -2.72406255e-01  1.02441030e-01]
 [ 1.07264643e-01 -2.60059930e-02 -1.02150641e-01]
 [ 5.33375597e-01 -3.77753555e-02  3.16732627e-01]
 [-2.99085293e-02  2.26176804e-03  6.87260336e-02]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 4.17349856e-01 -1.93489127e-01 -4.74134411e-02]
 [-2.19053370e-02 -8.15422744e-02 -2.29138448e-02]
 [ 1.11677229e-02  9.50087988e-03 -4.09607261e-02]
 [-4.02559728e-02  1.12768286e-01 -1.96434356e-01]
 [ 4.97276078e-01  9.04474017e-02  1.35613634e-01]
 [-9.86037745e-02  4.10568511e-02  1.44877708e-02]
 [ 8.64874761e-03  2.76202009e-02  5.34378282e-02]
 [ 2.69481839e+00  1.82495644e+00  2.02997414e-01]
 [-9.54542712e-02 -2.99237885e-02 -1.94611883e-02]
 [ 3.68520715e-02 -1.57904029e-02 -9.87729501e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.37008914]
curr_Stock_Price:  100.54070420976696
curr_Factors:  [100.54070421  -0.99673862  -1.01179814]
mat_Sqrt:  [[13.4910419   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00411661 -0.01498746  0.17713904]
Stock Position:  0.004116612191158328
Bond Position:  [5.95620205]


portfolio before change:  [6.37062934]
curr_Stock_Price:  100.49105937963846
curr_Factors:  [100.49105938  -0.87410277  -1.01007626]
mat_Sqrt:  [[15.2699942   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08130591 0.07585971 0.91263402]
Stock Position:  0.0813059114933272
Bond Position:  [-1.79988783]


portfolio before change:  [6.42161302]
curr_Stock_Price:  101.12088659238547
curr_Factors:  [101.12088659  -0.84242808  -1.02807772]
mat_Sqrt:  [[15.57724032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272774  0.01286181  0.09909629]
Stock Position:  -0.0027277376586279977
Bond Position:  [6.69744427]


portfolio before change:  [6.42365524]
curr_Stock_Price:  100.67913332245521
curr_Factors:  [100.67913332  -0.91114419  -1.02381647]
mat_Sqrt:  [[14.54108231  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0356379  0.32717789 2.45842755]
Stock Position:  0.03563790010375616
Bond Position:  [2.83566234]


portfolio before change:  [6.40076672]
curr_Stock_Price:  100.02693453292812
curr_Factors:  [100.02693453  -0.86884982  -1.00001967]
mat_Sqrt:  [[15.43395588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0037998  -0.01106097 -0.05874131]
Stock Position:  -0.0037998035884662814
Bond Position:  [6.78084943]


portfolio before change:  [6.39684048]
curr_Stock_Price:  101.28329049891995
curr_Factors:  [101.2832905   -0.97336342  -0.99711665]
mat_Sqrt:  [[14.11787011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00421586 -0.01505238  0.10978296]
Stock Position:  0.004215860166360161
Bond Position:  [5.96984429]


portfolio before change:  [6.39156009]
curr_Stock_Price:  99.85376845536652
curr_Factors:  [99.85376846 -0.8034834  -1.00933701]
mat_Sqrt:  [[16.29545751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00408411  0.00412845 -0.17128234]
Stock Position:  -0.004084113246466464
Bond Position:  [6.79937419]


portfolio before change:  [6.39440202]
curr_Stock_Price:  99.36603609971468
curr_Factors:  [99.3660361  -0.82733542 -1.02460465]
mat_Sqrt:  [[15.59375159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241071  0.04064804  0.00185844]
Stock Position:  -0.002410710536870476
Bond Position:  [6.63394477]


portfolio before change:  [6.39521614]
curr_Stock_Price:  99.37233049260888
curr_Factors:  [99.37233049 -0.66390993 -1.01321787]
mat_Sqrt:  [[18.57368716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00233231  0.01014667 -0.11830477]
Stock Position:  0.002332309709537618
Bond Position:  [6.16344909]


portfolio before change:  [6.39981946]
curr_Stock_Price:  101.01569588054879
curr_Factors:  [101.01569588  -0.92711484  -1.04857565]
mat_Sqrt:  [[14.00739523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01115644 -0.02277469 -0.11108827]
Stock Position:  -0.011156440623931986
Bond Position:  [7.52679507]


portfolio before change:  [6.39714428]
curr_Stock_Price:  101.33982084820765
curr_Factors:  [101.33982085  -0.74280458  -1.03182956]
mat_Sqrt:  [[17.18170745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06418491  0.51940148 -0.8225955 ]
Stock Position:  0.06418490815987786
Bond Position:  [-0.10734281]


portfolio before change:  [6.43710096]
curr_Stock_Price:  101.962554457264
curr_Factors:  [101.96255446  -0.32917903  -1.01436386]
mat_Sqrt:  [[26.60403097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056067 -0.00540519 -0.1637087 ]
Stock Position:  -0.0005606665515467058
Bond Position:  [6.49426796]


portfolio before change:  [6.43721903]
curr_Stock_Price:  103.19994999391318
curr_Factors:  [103.19994999  -0.25794954  -1.01432183]
mat_Sqrt:  [[28.91605562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248306  0.00033785 -0.27172988]
Stock Position:  -0.0024830614279335653
Bond Position:  [6.69347085]


portfolio before change:  [6.43016415]
curr_Stock_Price:  106.37812925741073
curr_Factors:  [106.37812926  -0.44726442  -1.04415011]
mat_Sqrt:  [[23.94083251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05285515 -0.83403877  6.30528216]
Stock Position:  0.052855148841287204
Bond Position:  [0.8075323]


portfolio before change:  [6.46510813]
curr_Stock_Price:  107.0373464630096
curr_Factors:  [107.03734646  -0.63695581  -1.01790529]
mat_Sqrt:  [[20.45682786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155716 -0.03313766  0.16696783]
Stock Position:  0.0015571592546824219
Bond Position:  [6.29843393]


portfolio before change:  [6.46413627]
curr_Stock_Price:  105.90758893393365
curr_Factors:  [105.90758893  -0.49634479  -1.03640527]
mat_Sqrt:  [[22.86979059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00650119 -0.03826276  0.09784309]
Stock Position:  0.0065011930724141135
Bond Position:  [5.77561058]


portfolio before change:  [6.46855222]
curr_Stock_Price:  106.47578519947554
curr_Factors:  [106.4757852   -0.61565927  -1.02606394]
mat_Sqrt:  [[20.61861645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01874551 -0.16150096  0.04808945]
Stock Position:  -0.018745505762835044
Bond Position:  [8.46449466]


portfolio before change:  [6.46372347]
curr_Stock_Price:  106.78982701583028
curr_Factors:  [106.78982702  -0.47636199  -1.04152629]
mat_Sqrt:  [[23.40557837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02681535 -0.5325652  -0.58219327]
Stock Position:  -0.02681535272448422
Bond Position:  [9.32733035]


portfolio before change:  [6.43515651]
curr_Stock_Price:  107.89863016889198
curr_Factors:  [107.89863017  -0.34592032  -1.0264371 ]
mat_Sqrt:  [[27.35323378  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00076127 0.01202236 0.16656844]
Stock Position:  0.0007612709118764453
Bond Position:  [6.35301643]


portfolio before change:  [6.43580638]
curr_Stock_Price:  107.70906828981042
curr_Factors:  [107.70906829  -0.43402133  -1.05443021]
mat_Sqrt:  [[24.31229624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01497702 -0.2075928   0.79299945]
Stock Position:  0.014977024635423398
Bond Position:  [4.82264501]


portfolio before change:  [6.43866298]
curr_Stock_Price:  107.8595470591673
curr_Factors:  [107.85954706  -0.55314566  -1.0437111 ]
mat_Sqrt:  [[21.84502336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00297764  0.0841353  -0.86885845]
Stock Position:  0.0029776377386934844
Bond Position:  [6.11749632]


portfolio before change:  [6.43449625]
curr_Stock_Price:  106.20338315508488
curr_Factors:  [106.20338316  -0.26012474  -1.03403057]
mat_Sqrt:  [[29.11346127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01257158 -0.01551636 -0.58660971]
Stock Position:  -0.012571577480770998
Bond Position:  [7.76964031]


portfolio before change:  [6.43452416]
curr_Stock_Price:  106.27842250337564
curr_Factors:  [106.2784225   -0.77263884  -1.02997544]
mat_Sqrt:  [[17.52183825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03080778 0.12065348 0.99416255]
Stock Position:  0.03080777843958264
Bond Position:  [3.16032206]


portfolio before change:  [6.44261765]
curr_Stock_Price:  106.52830850039169
curr_Factors:  [106.5283085   -1.02952183  -1.02089371]
mat_Sqrt:  [[13.70821391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00651565 0.02455917 0.50489348]
Stock Position:  0.006515645766410667
Bond Position:  [5.74851693]


portfolio before change:  [6.43437334]
curr_Stock_Price:  105.1527086164012
curr_Factors:  [105.15270862  -1.10536339  -1.00686991]
mat_Sqrt:  [[12.72006101  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0099931  -0.08791874  0.29223575]
Stock Position:  -0.009993099100953822
Bond Position:  [7.48517478]


portfolio before change:  [6.44393806]
curr_Stock_Price:  104.28921136469044
curr_Factors:  [104.28921136  -0.98592031  -1.01104853]
mat_Sqrt:  [[14.1568567   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00572901 -0.0083934  -0.29140734]
Stock Position:  0.005729010410984592
Bond Position:  [5.84646408]


portfolio before change:  [6.44873367]
curr_Stock_Price:  104.99871525637501
curr_Factors:  [104.99871526  -1.00913704  -0.99639952]
mat_Sqrt:  [[14.13157358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04177295 -0.01219194  0.90355002]
Stock Position:  0.041772949660184897
Bond Position:  [2.06262762]


portfolio before change:  [6.42447746]
curr_Stock_Price:  104.41187483867903
curr_Factors:  [104.41187484  -0.97098835  -0.97415542]
mat_Sqrt:  [[14.92741781  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103288  0.00072998  0.19605624]
Stock Position:  -0.0010328782357117686
Bond Position:  [6.53232221]


portfolio before change:  [6.42359318]
curr_Stock_Price:  106.05860428139735
curr_Factors:  [106.05860428  -1.22395759  -0.99042785]
mat_Sqrt:  [[11.58378607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296789 -0.02600141 -0.03673698]
Stock Position:  -0.002967894910461994
Bond Position:  [6.73836397]


portfolio before change:  [6.42483958]
curr_Stock_Price:  105.92246471764605
curr_Factors:  [105.92246472  -1.52736872  -0.97819314]
mat_Sqrt:  [[ 8.64642117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0425813  -0.06244835 -0.13525735]
Stock Position:  0.0425812967216632
Bond Position:  [1.91452368]


portfolio before change:  [6.41500152]
curr_Stock_Price:  105.6858025385772
curr_Factors:  [105.68580254  -1.57692965  -0.97385574]
mat_Sqrt:  [[ 8.24564491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524245 -0.02631766 -0.06536682]
Stock Position:  -0.005242446587371738
Bond Position:  [6.9690537]


portfolio before change:  [6.41662153]
curr_Stock_Price:  105.54296438106695
curr_Factors:  [105.54296438  -1.67405395  -0.98166334]
mat_Sqrt:  [[ 7.41422776  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00064012  0.0030664  -0.11684955]
Stock Position:  0.0006401217875544147
Bond Position:  [6.34906118]


portfolio before change:  [6.41728485]
curr_Stock_Price:  105.33931177566568
curr_Factors:  [105.33931178  -1.70835961  -0.97427793]
mat_Sqrt:  [[ 7.20337119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00795936  0.03639581 -0.56037254]
Stock Position:  -0.007959361862546142
Bond Position:  [7.25571855]


portfolio before change:  [6.4197229]
curr_Stock_Price:  105.14695566286794
curr_Factors:  [105.14695566  -1.61491501  -0.93244439]
mat_Sqrt:  [[ 8.23175753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06601514 0.02919177 0.38686795]
Stock Position:  0.06601513607042941
Bond Position:  [-0.52156768]


portfolio before change:  [6.41499687]
curr_Stock_Price:  105.076353114166
curr_Factors:  [105.07635311  -1.90458648  -0.93804558]
mat_Sqrt:  [[ 6.12301854  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01425208  0.01325104  0.04132958]
Stock Position:  -0.014252084240432327
Bond Position:  [7.9125539]


portfolio before change:  [6.42109384]
curr_Stock_Price:  104.71796031561261
curr_Factors:  [104.71796032  -1.86925333  -0.92034186]
mat_Sqrt:  [[ 6.43450844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00391555 0.00891438 0.15244325]
Stock Position:  0.003915551395409234
Bond Position:  [6.01106529]


portfolio before change:  [6.42248831]
curr_Stock_Price:  104.88218630105779
curr_Factors:  [104.8821863   -1.76346594  -0.91053551]
mat_Sqrt:  [[ 7.23431904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.42972569 0.58900216 0.57909512]
Stock Position:  0.42972568936747235
Bond Position:  [-38.6480815]


portfolio before change:  [6.38258217]
curr_Stock_Price:  104.80056485923556
curr_Factors:  [104.80056486  -1.73739526  -0.90261558]
mat_Sqrt:  [[ 7.47862027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01411155 -0.00965786 -0.05551735]
Stock Position:  -0.014111551807753166
Bond Position:  [7.86148077]


portfolio before change:  [6.38807125]
curr_Stock_Price:  104.48122792451032
curr_Factors:  [104.48122792  -1.81403338  -0.90875207]
mat_Sqrt:  [[ 6.86353057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0019621  -0.00509633 -0.28177173]
Stock Position:  0.0019620987924315442
Bond Position:  [6.18306876]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.3879445]
Stock Price:  104.02269804285747
PL:  [2.36524646]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-3.17402258e-02 -6.44277004e-02  2.31388593e-01]
 [ 5.81594394e-01  2.01285976e-01  1.45589390e-01]
 [-5.22683355e-01 -4.00473288e-01  4.44323967e-02]
 [ 8.59317930e-02  4.88085828e-01  5.13704908e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 1.16502940e-02  9.42349986e-02 -2.74970379e-02]
 [-5.40855797e-02  4.89513661e-03 -6.54772273e-02]
 [ 1.09534746e-01  1.14707530e-01 -8.86381258e-02]
 [ 1.83054820e-03  7.85523050e-02 -4.86286633e-02]
 [-3.77406567e-01 -4.17047906e-02 -1.56266642e-01]
 [ 6.51643729e-01  1.26359238e+00 -2.25501089e-01]
 [-2.49501093e-04  2.14667712e-02 -5.77449693e-02]
 [-2.02461513e-01 -8.68095011e-03 -4.29097975e-01]
 [ 1.65707913e+00 -3.18275238e+00  2.66859711e+00]
 [ 3.66018144e-05 -9.29333679e-02  3.62094573e-02]
 [ 1.22758745e-01 -1.92222029e-02 -2.11190013e-02]
 [-1.36458945e-01 -1.70153743e-01 -3.50966768e-02]
 [-2.67080922e-01 -1.74115542e+00 -2.00084943e-01]
 [ 1.30094623e-03  3.72499194e-02  5.83893053e-02]
 [ 3.16984208e-01 -4.79161920e-01  2.33886508e-01]
 [ 6.52529175e-02  2.48847330e-01 -2.18138072e-01]
 [-1.32405082e-02 -5.30220805e-02 -9.58235414e-02]
 [ 4.58759414e-01  2.01904004e-01  2.72950183e-01]
 [-1.91209987e-01  6.33675126e-02  6.86819439e-02]
 [-2.01469307e-02 -2.02980370e-01  6.46057255e-02]
 [ 5.25853934e-02 -4.11879939e-02  2.95996435e-01]
 [-2.03065860e-01 -1.37114872e-01 -7.43203811e-02]
 [-1.71080218e-01  1.24728870e-01  2.48719980e-01]
 [ 3.19613766e-02 -2.40269862e-02  8.66588991e-02]
 [-7.83526251e-02  9.74090832e-02  2.27391612e-03]
 [ 5.58535316e-02 -1.43180901e-02 -8.09827783e-02]
 [ 1.06810281e-01 -2.22210201e-03 -8.11023542e-02]
 [ 9.97084440e-02  8.40063257e-02  1.19351383e-01]
 [-3.79248559e-03 -3.28155839e-02  2.13060321e-02]
 [-9.71853212e-02  1.16224537e-01  2.72582685e-02]
 [-6.90305393e-02 -3.96074788e-02 -3.37707866e-02]
 [ 1.99365545e+00  1.31337730e+00  1.61495129e-01]
 [ 2.23850863e-01 -3.83689495e-01  1.02789806e-01]
 [ 2.42268008e-02 -1.55367346e-02  2.96362706e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.83317376]
curr_Stock_Price:  99.92158948031529
curr_Factors:  [99.92158948 -0.58713376 -0.99415749]
mat_Sqrt:  [[20.55480076  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.13867495e-04 -2.07939509e-02  6.60087250e-01]
Stock Position:  0.0001138674952800009
Bond Position:  [1.82179594]


portfolio before change:  [1.83336589]
curr_Stock_Price:  99.60886618327301
curr_Factors:  [99.60886618 -0.43909372 -0.9826366 ]
mat_Sqrt:  [[24.03523455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02714349 0.06496477 0.415326  ]
Stock Position:  0.027143485119175213
Bond Position:  [-0.87036589]


portfolio before change:  [1.78611335]
curr_Stock_Price:  97.87203182256137
curr_Factors:  [97.87203182 -0.40528956 -0.96229877]
mat_Sqrt:  [[24.93001495  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02388125 -0.1292522   0.12675326]
Stock Position:  -0.023881249140345534
Bond Position:  [4.12341973]


portfolio before change:  [1.69254241]
curr_Stock_Price:  101.8117922726068
curr_Factors:  [101.81179227  -0.49178089  -1.00415599]
mat_Sqrt:  [[22.80977239  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01273233 0.15752902 1.46545711]
Stock Position:  0.012732326557670677
Bond Position:  [0.39624142]


portfolio before change:  [1.6704497]
curr_Stock_Price:  100.0727351094723
curr_Factors:  [100.07273511  -0.58860659  -1.00847573]
mat_Sqrt:  [[20.26337268  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00289419 -0.01106097 -0.05874131]
Stock Position:  -0.002894187550592207
Bond Position:  [1.96007896]


portfolio before change:  [1.67112309]
curr_Stock_Price:  99.92472621657208
curr_Factors:  [99.92472622 -0.68724527 -1.01145778]
mat_Sqrt:  [[18.27829183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138269  0.03041422 -0.0784414 ]
Stock Position:  0.0013826851759451387
Bond Position:  [1.53295865]


portfolio before change:  [1.67153023]
curr_Stock_Price:  100.08059130692618
curr_Factors:  [100.08059131  -0.83318173  -1.02274087]
mat_Sqrt:  [[15.64346373  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0042479  0.0015799 -0.1867883]
Stock Position:  -0.00424789856999233
Bond Position:  [2.09666244]


portfolio before change:  [1.66325377]
curr_Stock_Price:  102.09065873079675
curr_Factors:  [102.09065873  -0.9857881   -1.0216338 ]
mat_Sqrt:  [[13.71430332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00837492  0.0370217  -0.2528599 ]
Stock Position:  0.008374916176373095
Bond Position:  [0.80825306]


portfolio before change:  [1.66719184]
curr_Stock_Price:  102.54881654712527
curr_Factors:  [102.54881655  -1.26273873  -1.01925638]
mat_Sqrt:  [[10.46821823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00075836  0.02535265 -0.13872404]
Stock Position:  0.0007583607642098644
Bond Position:  [1.58942284]


portfolio before change:  [1.66724423]
curr_Stock_Price:  102.35589970944346
curr_Factors:  [102.35589971  -1.23806474  -0.99332883]
mat_Sqrt:  [[10.99084202  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03801504 -0.01346016 -0.44578523]
Stock Position:  -0.03801504160299993
Bond Position:  [5.55830802]


portfolio before change:  [1.67201612]
curr_Stock_Price:  102.24865125278275
curr_Factors:  [102.24865125  -1.25204444  -1.00063347]
mat_Sqrt:  [[10.74810755  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08034375  0.40782269 -0.64329184]
Stock Position:  0.08034374632138241
Bond Position:  [-6.54302358]


portfolio before change:  [1.67962839]
curr_Stock_Price:  102.35357785186869
curr_Factors:  [102.35357785  -1.27714517  -1.01163307]
mat_Sqrt:  [[10.37765596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073762  0.00692837 -0.16473032]
Stock Position:  -0.0007376191018569756
Bond Position:  [1.75512634]


portfolio before change:  [1.68015576]
curr_Stock_Price:  101.93606070776963
curr_Factors:  [101.93606071  -1.1580824   -0.97634583]
mat_Sqrt:  [[12.06028142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02419701 -0.00280176 -1.22409708]
Stock Position:  -0.024197010960144844
Bond Position:  [4.14670374]


portfolio before change:  [1.69099868]
curr_Stock_Price:  101.5093738558183
curr_Factors:  [101.50937386  -0.90931221  -0.94515724]
mat_Sqrt:  [[15.88986828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09768033 -1.02722891  7.61276477]
Stock Position:  0.09768033310658972
Bond Position:  [-8.22447078]


portfolio before change:  [1.65266518]
curr_Stock_Price:  101.12746106424545
curr_Factors:  [101.12746106  -1.0412524   -0.91907448]
mat_Sqrt:  [[14.23999908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00081054 -0.02999412  0.1032955 ]
Stock Position:  -0.0008105420443255307
Bond Position:  [1.73463324]


portfolio before change:  [1.65337559]
curr_Stock_Price:  100.51853443530538
curr_Factors:  [100.51853444  -0.826592    -0.8880879 ]
mat_Sqrt:  [[18.09548081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00632888 -0.00620394 -0.06024663]
Stock Position:  0.006328880255022163
Bond Position:  [1.01720582]


portfolio before change:  [1.66496263]
curr_Stock_Price:  102.3292626774243
curr_Factors:  [102.32926268  -0.77082284  -0.90265554]
mat_Sqrt:  [[19.19629514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00929114 -0.05491688 -0.10012105]
Stock Position:  -0.009291142415002533
Bond Position:  [2.61571838]


portfolio before change:  [1.66973665]
curr_Stock_Price:  101.8506306898319
curr_Factors:  [101.85063069  -0.68781136  -0.89970625]
mat_Sqrt:  [[20.82157532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03185806 -0.5619555  -0.57078665]
Stock Position:  -0.03185805793291093
Bond Position:  [4.91449994]


portfolio before change:  [1.6220279]
curr_Stock_Price:  103.3674557942258
curr_Factors:  [103.36745579  -0.60715198  -0.89525469]
mat_Sqrt:  [[23.00895532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00090501 0.01202236 0.16656844]
Stock Position:  0.0009050050699155385
Bond Position:  [1.52847983]


portfolio before change:  [1.62362109]
curr_Stock_Price:  104.91674925996067
curr_Factors:  [104.91674926  -0.57158775  -0.90872784]
mat_Sqrt:  [[23.87547029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01117957 -0.15464884  0.66721311]
Stock Position:  0.011179573463485921
Bond Position:  [0.45069658]


portfolio before change:  [1.64135631]
curr_Stock_Price:  106.49810454199537
curr_Factors:  [106.49810454  -0.4884599   -0.9385999 ]
mat_Sqrt:  [[25.56099075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00279807  0.08031513 -0.6222872 ]
Stock Position:  0.002798069100579828
Bond Position:  [1.34336725]


portfolio before change:  [1.63431621]
curr_Stock_Price:  103.92203206900398
curr_Factors:  [103.92203207  -0.16932533  -0.95592224]
mat_Sqrt:  [[33.73019236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129331 -0.0171128  -0.27335789]
Stock Position:  -0.0012933069890971355
Bond Position:  [1.7687193]


portfolio before change:  [1.63573482]
curr_Stock_Price:  102.99610757769312
curr_Factors:  [102.99610758  -0.22246813  -0.96452932]
mat_Sqrt:  [[31.42782795  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01768142 0.06516424 0.7786509 ]
Stock Position:  0.017681419785956585
Bond Position:  [-0.18538259]


portfolio before change:  [1.65827187]
curr_Stock_Price:  104.2720361478518
curr_Factors:  [104.27203615  -0.42960939  -0.94988583]
mat_Sqrt:  [[26.24585314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00625834  0.02045178  0.19593047]
Stock Position:  -0.0062583412264991325
Bond Position:  [2.31084186]


portfolio before change:  [1.67649493]
curr_Stock_Price:  101.40639065483971
curr_Factors:  [101.40639065  -0.2976119   -0.93267852]
mat_Sqrt:  [[29.63172862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00163313 -0.06551163  0.18430215]
Stock Position:  -0.0016331324215797943
Bond Position:  [1.842105]


portfolio before change:  [1.6823871]
curr_Stock_Price:  97.93950437898368
curr_Factors:  [97.93950438 -0.42523385 -0.92848202]
mat_Sqrt:  [[25.29569215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00413501 -0.01329337  0.84439544]
Stock Position:  0.004135010340560257
Bond Position:  [1.27740623]


portfolio before change:  [1.68328422]
curr_Stock_Price:  98.11784339439383
curr_Factors:  [98.11784339 -0.30624051 -0.90611164]
mat_Sqrt:  [[29.18973454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00843533 -0.04425363 -0.21201536]
Stock Position:  -0.008435325103088987
Bond Position:  [2.51094012]


portfolio before change:  [1.69472045]
curr_Stock_Price:  96.79929938288114
curr_Factors:  [ 9.67992994e+01 -8.20594411e-02 -8.66943125e-01]
mat_Sqrt:  [[37.47361895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253112  0.04025607  0.70952887]
Stock Position:  -0.002531121711276529
Bond Position:  [1.93973126]


portfolio before change:  [1.6907831]
curr_Stock_Price:  98.45067658048201
curr_Factors:  [98.45067658 -0.18699054 -0.88403562]
mat_Sqrt:  [[33.7347855   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00132641 -0.00775468  0.24721372]
Stock Position:  0.0013264071977842206
Bond Position:  [1.56019741]


portfolio before change:  [1.69060739]
curr_Stock_Price:  98.17117077955105
curr_Factors:  [ 9.81711708e+01  3.86508727e-02 -8.88530377e-01]
mat_Sqrt:  [[41.96488056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138223  0.03143865  0.00648685]
Stock Position:  -0.0013822252639459798
Bond Position:  [1.82630207]


portfolio before change:  [1.69171368]
curr_Stock_Price:  97.53597664859974
curr_Factors:  [97.53597665  0.30351055 -0.90962291]
mat_Sqrt:  [[53.20268889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068418 -0.00462114 -0.23102133]
Stock Position:  0.0006841820223906867
Bond Position:  [1.62498132]


portfolio before change:  [1.68950666]
curr_Stock_Price:  94.0133048534591
curr_Factors:  [94.01330485  0.26443084 -0.92348746]
mat_Sqrt:  [[48.63676355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00184638 -0.00071718 -0.23136244]
Stock Position:  0.0018463758928941492
Bond Position:  [1.51592276]


portfolio before change:  [1.68943079]
curr_Stock_Price:  93.86957650130492
curr_Factors:  [93.8695765   0.25970998 -0.94443332]
mat_Sqrt:  [[47.33182934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00298359 0.02711293 0.34047627]
Stock Position:  0.002983587670022665
Bond Position:  [1.40936268]


portfolio before change:  [1.68496397]
curr_Stock_Price:  92.31339460189459
curr_Factors:  [92.3133946   0.12859981 -0.95305898]
mat_Sqrt:  [[40.47684484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00015174 -0.01059118  0.06078018]
Stock Position:  -0.00015173769210522484
Bond Position:  [1.69897139]


portfolio before change:  [1.6850374]
curr_Stock_Price:  93.2291163474095
curr_Factors:  [ 9.32291163e+01 -3.16515514e-02 -9.46465333e-01]
mat_Sqrt:  [[35.05587425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193682  0.03751131  0.07776025]
Stock Position:  -0.001936822792103651
Bond Position:  [1.86560568]


portfolio before change:  [1.69637138]
curr_Stock_Price:  87.4976840234587
curr_Factors:  [87.49768402  0.10090599 -0.90673946]
mat_Sqrt:  [[39.08656714  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0021493  -0.01278326 -0.09633865]
Stock Position:  -0.002149301439029568
Bond Position:  [1.88443028]


portfolio before change:  [1.6945906]
curr_Stock_Price:  88.4358294782651
curr_Factors:  [88.43582948  0.22899141 -0.87655784]
mat_Sqrt:  [[46.28003991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0495832  0.4238907  0.46070065]
Stock Position:  0.04958320101489772
Bond Position:  [-2.69034091]


portfolio before change:  [1.72463341]
curr_Stock_Price:  89.04851940945
curr_Factors:  [89.04851941  0.14053953 -0.87342513]
mat_Sqrt:  [[42.7896301   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00389142 -0.12383525  0.29323071]
Stock Position:  0.0038914207486812186
Bond Position:  [1.37810815]


portfolio before change:  [1.70919744]
curr_Stock_Price:  85.0375821409057
curr_Factors:  [ 8.50375821e+01  7.72927319e-02 -8.42681333e-01]
mat_Sqrt:  [[39.55549809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068524 -0.00501446  0.08454403]
Stock Position:  0.0006852361311551191
Bond Position:  [1.65092662]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.71133413]
Stock Price:  87.85458153703738
PL:  [1.71133413]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-1.81304678e-02 -5.77461741e-02  2.08003086e-01]
 [ 1.07735844e+00  2.33577510e-01  3.09998854e-01]
 [-1.60031744e-01 -6.08355213e-02  3.44645207e-02]
 [ 1.14740398e-01  9.55730029e-01  7.47191084e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 2.00081885e-02  2.83738690e-02  3.06584745e-03]
 [-5.15219246e-02 -2.27834597e-03 -7.04151121e-02]
 [ 1.54304855e-02  2.12389276e-01 -3.71340008e-02]
 [-7.53148417e-04  8.13482823e-02 -4.90534438e-02]
 [-1.97240025e-01 -1.09883863e-01 -8.27082802e-02]
 [ 8.22395104e-01  1.58352622e+00 -2.85950435e-01]
 [-5.00976448e-05 -8.76824434e-03 -2.60194887e-02]
 [-2.55940995e-01 -4.17422847e-04 -5.17747050e-01]
 [ 1.69548568e+00 -3.22821321e+00  2.70898188e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.30503028e-01 -4.33470833e-02 -5.14649735e-03]
 [-1.33305845e-01 -1.64398328e-01 -3.75852470e-02]
 [-2.70219121e-01 -1.76010019e+00 -2.00472689e-01]
 [ 1.30094623e-03  3.72499194e-02  5.83893053e-02]
 [ 1.63215767e-01 -1.82808238e-01  2.09499288e-01]
 [ 4.86137803e-02  6.39693197e-03  5.87133797e-02]
 [ 1.17655912e-01 -5.11521871e-02 -2.15050338e-03]
 [ 3.86023945e-01  1.02529015e-01  1.87816625e-01]
 [-1.35565366e-01  1.01126468e-03  5.73975889e-02]
 [-6.73054771e-03 -1.74892654e-01  5.25255588e-02]
 [ 5.25304918e-02 -5.10565272e-03  1.89694252e-01]
 [ 1.87950678e-01 -5.50536127e-02  9.47881137e-02]
 [-6.24607728e-02  5.78546799e-02  1.09591312e-01]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 2.29557365e-02  4.36305731e-02  8.55178745e-02]
 [-2.51465736e-02 -7.47758351e-02 -2.63620354e-02]
 [ 6.14826055e-02  1.06164982e-02 -5.48510328e-02]
 [-5.51569060e-02 -5.61228363e-02  1.42259833e-02]
 [ 4.19634308e-01  5.90800749e-02  1.00293430e-01]
 [ 4.03210253e-02  8.77930002e-02 -6.03403208e-02]
 [ 1.86122526e-02  3.15708149e-02  6.95274674e-02]
 [ 2.64374590e+00  1.88555017e+00  2.19054183e-01]
 [-1.23254439e-01  3.39428607e-02  1.03506879e-03]
 [ 3.82551224e-02 -1.22428382e-02 -1.85776741e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.19586003]
curr_Stock_Price:  100.24400542691534
curr_Factors:  [100.24400543  -0.85130502  -0.99540883]
mat_Sqrt:  [[15.81396521  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079301 -0.0186375   0.59337491]
Stock Position:  0.0007930076782519416
Bond Position:  [4.11636576]


portfolio before change:  [4.19634243]
curr_Stock_Price:  100.20343387736614
curr_Factors:  [100.20343388  -0.99535727  -0.97852417]
mat_Sqrt:  [[13.91992161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08536797 0.07538682 0.88434044]
Stock Position:  0.08536797378989856
Bond Position:  [-4.35782169]


portfolio before change:  [4.24363757]
curr_Stock_Price:  100.76383020248127
curr_Factors:  [100.7638302   -1.05877149  -0.98716599]
mat_Sqrt:  [[13.02462741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01270015 -0.01963458  0.09831768]
Stock Position:  -0.012700148510968744
Bond Position:  [5.52335317]


portfolio before change:  [4.23948378]
curr_Stock_Price:  101.14526228869373
curr_Factors:  [101.14526229  -0.99919887  -0.99996514]
mat_Sqrt:  [[13.69997097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03374808 0.30846054 2.13152818]
Stock Position:  0.03374807988622901
Bond Position:  [0.82602539]


portfolio before change:  [4.27255578]
curr_Stock_Price:  102.12216929651417
curr_Factors:  [102.1221693   -1.02910757  -1.02122206]
mat_Sqrt:  [[13.14235477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00446237 -0.01106097 -0.05874131]
Stock Position:  -0.00446236629351938
Bond Position:  [4.72826231]


portfolio before change:  [4.28177428]
curr_Stock_Price:  100.1887927066348
curr_Factors:  [100.18879271  -0.72481303  -1.01179869]
mat_Sqrt:  [[17.64486153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00149765 0.00915763 0.00874601]
Stock Position:  0.0014976481249677656
Bond Position:  [4.13172673]


portfolio before change:  [4.28251727]
curr_Stock_Price:  100.34002462419414
curr_Factors:  [100.34002462  -0.70099026  -1.01664212]
mat_Sqrt:  [[18.01009232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00368462 -0.00073533 -0.20087472]
Stock Position:  -0.0036846237888077137
Bond Position:  [4.65223252]


portfolio before change:  [4.2813763]
curr_Stock_Price:  100.80751990927797
curr_Factors:  [100.80751991  -0.87196683  -1.01485465]
mat_Sqrt:  [[15.27765756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00335158  0.06854834 -0.10593297]
Stock Position:  0.0033515817841041334
Bond Position:  [3.94351165]


portfolio before change:  [4.28432177]
curr_Stock_Price:  101.53926374124336
curr_Factors:  [101.53926374  -1.28203023  -1.03287691]
mat_Sqrt:  [[10.02957692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00058218  0.02625505 -0.13993582]
Stock Position:  0.0005821788838476739
Bond Position:  [4.22520775]


portfolio before change:  [4.28477092]
curr_Stock_Price:  101.40352107703308
curr_Factors:  [101.40352108  -1.15389545  -1.00637645]
mat_Sqrt:  [[11.69119408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02023341 -0.03546486 -0.2359437 ]
Stock Position:  -0.02023341075071873
Bond Position:  [6.33651002]


portfolio before change:  [4.29203539]
curr_Stock_Price:  101.08363648338388
curr_Factors:  [101.08363648  -0.93308678  -1.00081285]
mat_Sqrt:  [[14.61500324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07439353  0.51108089 -0.815737  ]
Stock Position:  0.0743935279344576
Bond Position:  [-3.22793294]


portfolio before change:  [4.25358824]
curr_Stock_Price:  100.57225282682326
curr_Factors:  [100.57225283  -0.63878443  -1.00391159]
mat_Sqrt:  [[19.45648413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036754 -0.00282994 -0.07422636]
Stock Position:  -0.0003675439959282118
Bond Position:  [4.29055297]


portfolio before change:  [4.25402724]
curr_Stock_Price:  100.83714220475478
curr_Factors:  [100.8371422   -0.88198327  -1.03267387]
mat_Sqrt:  [[14.86262429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.43369454e-02 -1.34722645e-04 -1.47698822e+00]
Stock Position:  -0.02433694535259682
Bond Position:  [6.70809525]


portfolio before change:  [4.24788731]
curr_Stock_Price:  101.12388678903673
curr_Factors:  [101.12388679  -0.95974399  -1.00329319]
mat_Sqrt:  [[14.20095469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11192896 -1.04190133  7.72797126]
Stock Position:  0.1119289555647696
Bond Position:  [-7.07080372]


portfolio before change:  [4.21983809]
curr_Stock_Price:  100.88118538518182
curr_Factors:  [100.88118539  -0.67211984  -1.00485365]
mat_Sqrt:  [[18.85861713  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00114904 -0.03053791  0.10625201]
Stock Position:  -0.0011490435768329677
Bond Position:  [4.33575497]


portfolio before change:  [4.21951669]
curr_Stock_Price:  101.63259634427874
curr_Factors:  [101.63259634  -0.84675332  -0.97823774]
mat_Sqrt:  [[16.38511417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0073606  -0.01399021 -0.01468152]
Stock Position:  0.007360602774146607
Bond Position:  [3.47143952]


portfolio before change:  [4.22400069]
curr_Stock_Price:  102.18282810031174
curr_Factors:  [102.1828281   -0.67757344  -0.96299744]
mat_Sqrt:  [[19.810117    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00881043 -0.05305933 -0.10722025]
Stock Position:  -0.00881042598942633
Bond Position:  [5.12427493]


portfolio before change:  [4.23107477]
curr_Stock_Price:  101.45261272005611
curr_Factors:  [101.45261272  -0.70788539  -0.97332961]
mat_Sqrt:  [[18.88516746  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03549978 -0.56806989 -0.57189278]
Stock Position:  -0.035499784937396084
Bond Position:  [7.8326207]


portfolio before change:  [4.22983258]
curr_Stock_Price:  101.51518557576986
curr_Factors:  [101.51518558  -0.67103274  -0.9709672 ]
mat_Sqrt:  [[19.65257667  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00105957 0.01202236 0.16656844]
Stock Position:  0.0010595669756225394
Bond Position:  [4.12227045]


portfolio before change:  [4.23002708]
curr_Stock_Price:  101.21240106120273
curr_Factors:  [101.21240106  -0.5073475   -0.99499787]
mat_Sqrt:  [[22.53063451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00748599 -0.05900111  0.59764316]
Stock Position:  0.007485987779743534
Bond Position:  [3.47235228]


portfolio before change:  [4.23403632]
curr_Stock_Price:  101.68998187498953
curr_Factors:  [101.68998187  -0.35047672  -0.98814678]
mat_Sqrt:  [[26.66375873  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00232167 0.0020646  0.16749293]
Stock Position:  0.00232166693570353
Bond Position:  [3.99794605]


portfolio before change:  [4.23188511]
curr_Stock_Price:  100.5481386018199
curr_Factors:  [100.5481386   -0.24610721  -0.98654305]
mat_Sqrt:  [[29.31168787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00364276 -0.0165093  -0.00613479]
Stock Position:  0.0036427634782766737
Bond Position:  [3.86561202]


portfolio before change:  [4.23432737]
curr_Stock_Price:  101.08592546494472
curr_Factors:  [101.08592546  -0.27905954  -0.96520105]
mat_Sqrt:  [[29.12830296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01528721 0.0330911  0.53578855]
Stock Position:  0.01528721055119177
Bond Position:  [2.68900555]


portfolio before change:  [4.22897802]
curr_Stock_Price:  100.71401367381624
curr_Factors:  [100.71401367  -0.41286056  -0.97670164]
mat_Sqrt:  [[25.09635836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00492672  0.00032638  0.16373934]
Stock Position:  -0.00492671910539897
Bond Position:  [4.72516768]


portfolio before change:  [4.22905002]
curr_Stock_Price:  100.81929404040491
curr_Factors:  [100.81929404  -0.3316791   -0.95348043]
mat_Sqrt:  [[27.88726728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113703 -0.05644636  0.1498408 ]
Stock Position:  -0.0011370288154594719
Bond Position:  [4.34368446]


portfolio before change:  [4.23014192]
curr_Stock_Price:  100.33653755593092
curr_Factors:  [100.33653756  -0.35898441  -0.94570429]
mat_Sqrt:  [[27.21698465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00331446 -0.00164784  0.5411449 ]
Stock Position:  0.003314455403856855
Bond Position:  [3.89758094]


portfolio before change:  [4.23700294]
curr_Stock_Price:  102.25956445156915
curr_Factors:  [102.25956445  -0.36570136  -0.95759203]
mat_Sqrt:  [[27.22732167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00720091 -0.01776848  0.2704041 ]
Stock Position:  0.007200908406291108
Bond Position:  [3.50064118]


portfolio before change:  [4.25189411]
curr_Stock_Price:  104.26675090922554
curr_Factors:  [104.26675091  -0.31890013  -0.91865649]
mat_Sqrt:  [[30.24696681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.000935    0.01867252  0.31263351]
Stock Position:  -0.0009350029359942372
Bond Position:  [4.34938383]


portfolio before change:  [4.25429952]
curr_Stock_Price:  102.2756349175036
curr_Factors:  [102.27563492  -0.31403785  -0.93275489]
mat_Sqrt:  [[29.39659147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075175 -0.02321455 -0.0028026 ]
Stock Position:  -0.0007517549251487074
Bond Position:  [4.33118573]


portfolio before change:  [4.2544235]
curr_Stock_Price:  102.83093674913566
curr_Factors:  [102.83093675  -0.34109003  -0.94818357]
mat_Sqrt:  [[28.32692172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00174103 0.01408171 0.24395869]
Stock Position:  0.001741031145100786
Bond Position:  [4.07539164]


portfolio before change:  [4.25877844]
curr_Stock_Price:  105.03967531120722
curr_Factors:  [105.03967531  -0.26900524  -0.95173967]
mat_Sqrt:  [[30.98778917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00147772 -0.0241338  -0.07520355]
Stock Position:  -0.001477719325897158
Bond Position:  [4.4139976]


portfolio before change:  [4.25892051]
curr_Stock_Price:  105.31693215313338
curr_Factors:  [105.31693215  -0.41226957  -0.95204121]
mat_Sqrt:  [[26.91445295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194889  0.00342646 -0.15647473]
Stock Position:  0.0019488885398301447
Bond Position:  [4.05366955]


portfolio before change:  [4.26246015]
curr_Stock_Price:  106.87315230451998
curr_Factors:  [106.8731523   -0.21291823  -0.9612708 ]
mat_Sqrt:  [[33.03123431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192875 -0.01811357  0.04058277]
Stock Position:  -0.0019287521849985568
Bond Position:  [4.46859198]


portfolio before change:  [4.26587232]
curr_Stock_Price:  105.39366657606108
curr_Factors:  [105.39366658  -0.12365226  -0.95790574]
mat_Sqrt:  [[35.73549842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01265314 0.01906801 0.28610924]
Stock Position:  0.012653140671942556
Bond Position:  [2.93231144]


portfolio before change:  [4.23110498]
curr_Stock_Price:  102.61697203898771
curr_Factors:  [102.61697204  -0.26485956  -0.95532904]
mat_Sqrt:  [[30.28991269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00151617  0.02833507 -0.17213414]
Stock Position:  0.0015161740628121328
Bond Position:  [4.07551979]


portfolio before change:  [4.23717407]
curr_Stock_Price:  106.28384304967113
curr_Factors:  [106.28384305  -0.38127971  -0.96885801]
mat_Sqrt:  [[27.54925681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00142468 0.01018944 0.19834251]
Stock Position:  0.001424679198585587
Bond Position:  [4.08575369]


portfolio before change:  [4.23905554]
curr_Stock_Price:  107.24596997955018
curr_Factors:  [107.24596998  -0.47425009  -0.93899842]
mat_Sqrt:  [[26.09846436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11775967 0.6085587  0.62490061]
Stock Position:  0.1177596666316779
Bond Position:  [-8.39019413]


portfolio before change:  [4.19175081]
curr_Stock_Price:  106.85317089484595
curr_Factors:  [106.85317089  -0.69041356  -0.93006276]
mat_Sqrt:  [[21.13603365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00549368  0.01095501  0.00295276]
Stock Position:  -0.005493679691411715
Bond Position:  [4.77876791]


portfolio before change:  [4.19108904]
curr_Stock_Price:  107.0823706415991
curr_Factors:  [107.08237064  -0.86589028  -0.91799698]
mat_Sqrt:  [[17.98811195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.20382555e-04 -3.95135904e-03 -5.29969331e-01]
Stock Position:  -0.00012038255513529406
Bond Position:  [4.20397989]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.19157258]
Stock Price:  107.43122058033165
PL:  [-3.239648]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.19638028e-01 -1.08356893e-02 -1.66291681e-01]
 [ 1.31100208e+00  2.46806792e-01  3.92028825e-01]
 [-1.25280768e-01 -2.88479655e-02  3.34508842e-02]
 [ 1.03809316e-01  9.20027289e-01  6.81374773e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 5.89270360e-02 -6.21293748e-02  4.56990852e-02]
 [-5.38301475e-02  4.18039985e-03 -6.59692182e-02]
 [ 3.55001790e-02  1.72957549e-01 -3.34437117e-02]
 [-8.11835964e-03  8.93186312e-02 -5.02643436e-02]
 [-1.87301940e-01 -1.03712743e-01 -7.58390390e-02]
 [ 7.63442837e-01  1.46416660e+00 -2.67322908e-01]
 [-1.69395422e-04  3.29757520e-02 -5.84640026e-02]
 [-2.69010319e-01 -1.79785795e-02 -5.99433651e-01]
 [ 1.85367796e+00 -3.58727630e+00  3.02612396e+00]
 [ 3.11507026e-02 -9.56106786e-02  3.02064818e-02]
 [ 1.12132968e-01 -3.13941073e-02 -1.03747314e-02]
 [-9.92126206e-02 -8.56446966e-02 -4.38350033e-02]
 [-2.62232970e-01 -1.70223998e+00 -1.96000368e-01]
 [-3.81751389e-02  1.70730213e-01  4.37240417e-01]
 [ 2.90039683e-01  3.56984205e-02  5.81520265e-01]
 [ 7.89484427e-02 -3.44945165e-01 -6.08929563e-02]
 [ 1.33723343e-01 -5.28163254e-02 -1.15517637e-02]
 [ 1.22739188e-02  1.55519625e-01  7.57893289e-02]
 [ 3.13969106e-01 -3.46704777e-01 -2.39615488e-01]
 [ 5.98675734e-04 -6.47036649e-02  2.37435481e-02]
 [ 2.59763793e-02 -1.96612118e-02  1.56857625e-01]
 [ 4.03823391e-01 -1.11217556e-01  1.75355161e-01]
 [ 6.96120151e-02 -1.93426638e-01 -9.93712733e-02]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 6.85640453e-02 -1.46050216e-03  7.09886794e-02]
 [-1.82259430e-02 -2.88715706e-02 -5.72982376e-02]
 [-5.09073690e-02  2.45517502e-02 -4.63850979e-02]
 [-4.25353421e-02 -5.96092484e-02  1.28167954e-02]
 [ 2.87419187e-01  4.88798720e-02  7.37674418e-02]
 [-9.14261847e-02 -3.68528251e-02  6.29236786e-02]
 [-1.07767104e-01 -5.67330789e-02 -8.04952559e-02]
 [ 1.99784080e+00  1.29980393e+00  1.58500981e-01]
 [-5.09344961e-03 -1.67473740e-01 -6.40205398e-02]
 [ 3.42613415e-02 -1.35259631e-02 -9.16171236e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.38628489]
curr_Stock_Price:  100.40645270841246
curr_Factors:  [100.40645271  -1.25773357  -1.00536744]
mat_Sqrt:  [[10.44502165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00799252 -0.0034972  -0.47438388]
Stock Position:  0.007992521008342714
Bond Position:  [4.58378421]


portfolio before change:  [5.38555418]
curr_Stock_Price:  100.24333503989025
curr_Factors:  [100.24333504  -1.45784137  -0.9658746 ]
mat_Sqrt:  [[ 8.88073749  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.16230677 0.07965655 1.11834912]
Stock Position:  0.16230677370184937
Bond Position:  [-10.88461812]


portfolio before change:  [5.47345926]
curr_Stock_Price:  100.7933166809938
curr_Factors:  [100.79331668  -1.69262263  -0.96926631]
mat_Sqrt:  [[ 7.03700823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01766961 -0.00931064  0.09542606]
Stock Position:  -0.017669611509888803
Bond Position:  [7.25443801]


portfolio before change:  [5.46384025]
curr_Stock_Price:  101.38902142100497
curr_Factors:  [101.38902142  -1.73751615  -1.01300464]
mat_Sqrt:  [[ 6.47820862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06648352 0.29693753 1.94377257]
Stock Position:  0.06648352482266559
Bond Position:  [-1.27685927]


portfolio before change:  [5.40167944]
curr_Stock_Price:  100.45644162075816
curr_Factors:  [100.45644162  -1.49706826  -1.00070512]
mat_Sqrt:  [[ 8.26434792  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00709626 -0.01106097 -0.05874131]
Stock Position:  -0.007096264765796484
Bond Position:  [6.11454495]


portfolio before change:  [5.39883298]
curr_Stock_Price:  100.96527726621909
curr_Factors:  [100.96527727  -1.57098476  -1.02877091]
mat_Sqrt:  [[ 7.50088482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00740889 -0.02005217  0.13036677]
Stock Position:  0.007408888228539081
Bond Position:  [4.65079252]


portfolio before change:  [5.39538044]
curr_Stock_Price:  100.42080622655831
curr_Factors:  [100.42080623  -1.37872325  -1.02614201]
mat_Sqrt:  [[ 9.06575529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00732898  0.00134922 -0.18819182]
Stock Position:  -0.007328979778649745
Bond Position:  [6.1313625]


portfolio before change:  [5.3954268]
curr_Stock_Price:  100.51906051912513
curr_Factors:  [100.51906052  -1.38269811  -1.02721682]
mat_Sqrt:  [[ 9.02891711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00708594  0.05582181 -0.0954056 ]
Stock Position:  0.0070859352299838
Bond Position:  [4.68315525]


portfolio before change:  [5.39546294]
curr_Stock_Price:  100.4415411161723
curr_Factors:  [100.44154112  -1.40789634  -1.04880161]
mat_Sqrt:  [[ 8.6096006   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.70085196e-05  2.88274642e-02 -1.43390181e-01]
Stock Position:  -1.7008519636809033e-05
Bond Position:  [5.3971713]


portfolio before change:  [5.3961322]
curr_Stock_Price:  100.76033072938793
curr_Factors:  [100.76033073  -1.49468237  -1.05953812]
mat_Sqrt:  [[ 7.83439962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02858583 -0.03347314 -0.21634767]
Stock Position:  -0.028585827304389605
Bond Position:  [8.27644962]


portfolio before change:  [5.3999822]
curr_Stock_Price:  100.66184221827318
curr_Factors:  [100.66184222  -1.58794895  -1.0564998 ]
mat_Sqrt:  [[ 7.1514709   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.14091472  0.47255774 -0.76259785]
Stock Position:  0.14091472191003004
Bond Position:  [-8.7847533]


portfolio before change:  [5.46347694]
curr_Stock_Price:  101.1202251280645
curr_Factors:  [101.12022513  -1.61985418  -1.04107944]
mat_Sqrt:  [[ 7.06657934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076022  0.01064288 -0.16678153]
Stock Position:  -0.0007602211107414422
Bond Position:  [5.54035067]


portfolio before change:  [5.46399263]
curr_Stock_Price:  101.35291436451818
curr_Factors:  [101.35291436  -1.762033    -1.0220812 ]
mat_Sqrt:  [[ 6.26196746  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06308545 -0.00580256 -1.71001736]
Stock Position:  -0.06308545438640646
Bond Position:  [11.85788728]


portfolio before change:  [5.48429957]
curr_Stock_Price:  101.05451570862404
curr_Factors:  [101.05451571  -1.75966671  -1.0210754 ]
mat_Sqrt:  [[ 6.26462057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.2776119  -1.15778845  8.63268935]
Stock Position:  0.2776119001322014
Bond Position:  [-22.56963655]


portfolio before change:  [5.42327888]
curr_Stock_Price:  100.84487301121104
curr_Factors:  [100.84487301  -1.7342495   -1.02648299]
mat_Sqrt:  [[ 6.37797685  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00279087 -0.03085821  0.08617068]
Stock Position:  0.002790873545090447
Bond Position:  [5.14183359]


portfolio before change:  [5.42518669]
curr_Stock_Price:  101.29814809542866
curr_Factors:  [101.2981481   -1.83547808  -1.03595339]
mat_Sqrt:  [[ 5.73528052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01806484 -0.0101324  -0.02959622]
Stock Position:  0.018064842574547033
Bond Position:  [3.59525159]


portfolio before change:  [5.43049073]
curr_Stock_Price:  101.56688058992631
curr_Factors:  [101.56688059  -1.91368595  -1.01050329]
mat_Sqrt:  [[ 5.45497626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02303265 -0.02764171 -0.12504906]
Stock Position:  -0.02303264905019352
Bond Position:  [7.76984505]


portfolio before change:  [5.42758753]
curr_Stock_Price:  101.73509799088365
curr_Factors:  [101.73509799  -2.13521511  -1.03568583]
mat_Sqrt:  [[ 4.26939199  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.1521785  -0.54939559 -0.55913449]
Stock Position:  -0.15217849744514306
Bond Position:  [20.90948188]


portfolio before change:  [5.50093231]
curr_Stock_Price:  101.27030870210632
curr_Factors:  [101.2703087   -1.80950278  -1.04012571]
mat_Sqrt:  [[ 5.86008891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01466298 0.05510294 1.24732521]
Stock Position:  0.014662976590221989
Bond Position:  [4.01600815]


portfolio before change:  [5.50786474]
curr_Stock_Price:  101.70885517656416
curr_Factors:  [101.70885518  -1.81680982  -1.05901396]
mat_Sqrt:  [[ 5.73329603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07256366 0.01152162 1.65891545]
Stock Position:  0.07256365587353383
Bond Position:  [-1.87250162]


portfolio before change:  [5.50956811]
curr_Stock_Price:  101.7355551326243
curr_Factors:  [101.73555513  -1.87155404  -1.03888599]
mat_Sqrt:  [[ 5.53968048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070273 -0.11133057 -0.17371065]
Stock Position:  -0.0007027331018693348
Bond Position:  [5.58106105]


portfolio before change:  [5.51034774]
curr_Stock_Price:  101.61893283426511
curr_Factors:  [101.61893283  -2.13745104  -1.08014181]
mat_Sqrt:  [[ 4.06997563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02962776 -0.0170464  -0.03295397]
Stock Position:  0.02962776009551319
Bond Position:  [2.49960638]


portfolio before change:  [5.51140788]
curr_Stock_Price:  101.64416832616588
curr_Factors:  [101.64416833  -2.13903476  -1.08518946]
mat_Sqrt:  [[ 4.04407945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01471031 0.05019374 0.21620586]
Stock Position:  0.014710309755511648
Bond Position:  [4.01619068]


portfolio before change:  [5.50905208]
curr_Stock_Price:  101.44989222475006
curr_Factors:  [101.44989222  -1.97775378  -1.08559678]
mat_Sqrt:  [[ 4.74084052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04098155 -0.11189849 -0.68355629]
Stock Position:  0.04098154793239542
Bond Position:  [1.35147846]


portfolio before change:  [5.5090176]
curr_Stock_Price:  101.44492842609053
curr_Factors:  [101.44492843  -1.67840023  -1.07233784]
mat_Sqrt:  [[ 6.48037259  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00119781 -0.02088302  0.06773373]
Stock Position:  -0.0011978127791556514
Bond Position:  [5.63052963]


portfolio before change:  [5.5099314]
curr_Stock_Price:  101.26966131197207
curr_Factors:  [101.26966131  -1.53255374  -1.08722932]
mat_Sqrt:  [[ 7.37432092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0073202  -0.00634563  0.44747114]
Stock Position:  0.007320196716757693
Bond Position:  [4.76861755]


portfolio before change:  [5.50814381]
curr_Stock_Price:  100.94402762126984
curr_Factors:  [100.94402762  -1.29796506  -1.08161199]
mat_Sqrt:  [[ 9.34638029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04460715 -0.03589531  0.50023947]
Stock Position:  0.04460715394330365
Bond Position:  [1.00531803]


portfolio before change:  [5.51480804]
curr_Stock_Price:  101.0906086846798
curr_Factors:  [101.09060868  -1.32936867  -1.08695691]
mat_Sqrt:  [[ 9.02223105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00109118 -0.06242818 -0.28347858]
Stock Position:  0.0010911815117188187
Bond Position:  [5.40449984]


portfolio before change:  [5.51532478]
curr_Stock_Price:  100.94501756508907
curr_Factors:  [100.94501757  -1.31996258  -1.06699674]
mat_Sqrt:  [[ 9.27772787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238194 -0.02321455 -0.0028026 ]
Stock Position:  -0.0023819444503501066
Bond Position:  [5.75577021]


portfolio before change:  [5.51560232]
curr_Stock_Price:  101.13057130755561
curr_Factors:  [101.13057131  -1.19945183  -1.0763895 ]
mat_Sqrt:  [[10.38716731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00796718 -0.00047138  0.20251094]
Stock Position:  0.007967179366135582
Bond Position:  [4.70987692]


portfolio before change:  [5.52034319]
curr_Stock_Price:  101.65172117445907
curr_Factors:  [101.65172117  -1.40889073  -1.06777101]
mat_Sqrt:  [[ 8.54110793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00419328 -0.00931826 -0.16345592]
Stock Position:  -0.004193282851263993
Bond Position:  [5.94659761]


portfolio before change:  [5.5209797]
curr_Stock_Price:  101.67720355414434
curr_Factors:  [101.67720355  -1.29078063  -1.06590749]
mat_Sqrt:  [[ 9.63223225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00574779  0.00792404 -0.13232377]
Stock Position:  -0.005747793548173615
Bond Position:  [6.10539928]


portfolio before change:  [5.52120883]
curr_Stock_Price:  101.77012468045695
curr_Factors:  [101.77012468  -1.30879102  -1.06142949]
mat_Sqrt:  [[ 9.51144753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00547622 -0.0192388   0.03656275]
Stock Position:  -0.005476223404733983
Bond Position:  [6.07852477]


portfolio before change:  [5.5232307]
curr_Stock_Price:  101.53967400121051
curr_Factors:  [101.539674    -1.60701476  -1.06502334]
mat_Sqrt:  [[ 7.01753136  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04452484 0.01577591 0.21043798]
Stock Position:  0.044524840575546426
Bond Position:  [1.0021929]


portfolio before change:  [5.51973885]
curr_Stock_Price:  101.45843550016706
curr_Factors:  [101.4584355   -1.60289442  -1.04100064]
mat_Sqrt:  [[ 7.21205654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01193897 -0.0118942   0.17950374]
Stock Position:  -0.01193896547409272
Bond Position:  [6.73104761]


portfolio before change:  [5.52513477]
curr_Stock_Price:  101.0769541509191
curr_Factors:  [101.07695415  -1.55185382  -1.02616569]
mat_Sqrt:  [[ 7.67418914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01769291 -0.01831052 -0.22963056]
Stock Position:  -0.017692907712822125
Bond Position:  [7.31347999]


portfolio before change:  [5.51998166]
curr_Stock_Price:  101.41987972598292
curr_Factors:  [101.41987973  -1.36672423  -1.04253296]
mat_Sqrt:  [[ 9.11582526  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.25181659 0.41950991 0.45215918]
Stock Position:  0.25181659164075376
Bond Position:  [-20.01922677]


portfolio before change:  [5.41022312]
curr_Stock_Price:  100.99395073850597
curr_Factors:  [100.99395074  -1.27683404  -1.01180104]
mat_Sqrt:  [[10.24126907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00511138 -0.05405192 -0.18263278]
Stock Position:  -0.005111380358059826
Bond Position:  [5.92644162]


portfolio before change:  [5.41136647]
curr_Stock_Price:  100.91520430348481
curr_Factors:  [100.9152043   -1.35723064  -1.00785292]
mat_Sqrt:  [[ 9.48012068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013501  -0.00436549 -0.26135815]
Stock Position:  0.0013500987253148812
Bond Position:  [5.27512098]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.41137401]
Stock Price:  100.43235151977495
PL:  [4.97902249]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.30011837e-01 -1.04051358e-02 -5.44716033e-02]
 [ 1.05837304e+00  2.27409027e-01  3.05282011e-01]
 [-2.27888693e-01 -1.23296442e-01  3.64438112e-02]
 [ 1.65041286e-01  1.20824726e+00  1.04788392e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 4.35148232e-02 -3.53141297e-02  3.22449228e-02]
 [-7.23004257e-02  5.58629446e-02 -3.03934084e-02]
 [-3.96155905e-02  7.34577993e-02  2.11562444e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 7.88488385e-01  1.59528076e+00 -2.54979347e-01]
 [-8.39953951e-04  1.68151926e-02  6.22723992e-02]
 [-2.95087429e-01  2.37355370e-03 -6.37518039e-01]
 [ 1.85093435e+00 -3.13465343e+00  2.64618471e+00]
 [ 2.93281866e-02 -8.88086211e-02  2.56917507e-02]
 [ 8.08620311e-02  8.84877491e-02 -6.64898383e-02]
 [-4.23559281e-02  2.66461563e-02 -7.62515737e-02]
 [-2.82143464e-01 -1.81812481e+00 -1.96903039e-01]
 [ 1.49717803e-02  9.16805594e-03 -1.08117404e-03]
 [ 8.61523643e-02  1.97819885e-01  2.72130732e-01]
 [ 2.52639573e-02  9.67697152e-03  5.71265682e-03]
 [ 1.17077218e-01 -5.18339769e-02  4.67366190e-02]
 [-2.47193429e-02 -1.01958664e-01 -1.00446428e-01]
 [-1.53178387e-01  1.38338695e-02  5.22090461e-02]
 [ 8.29719211e-02 -4.53858611e-03 -2.36011659e-02]
 [ 1.88242908e-02 -4.71153622e-02  2.51559077e-01]
 [-2.03914040e-01 -1.37995908e-01 -7.44606411e-02]
 [-1.37846619e-01  1.06863908e-01  1.91602717e-01]
 [-1.02205678e-03 -6.67155336e-02  1.11000593e-02]
 [-3.90288448e-02  8.47171954e-02  1.65082089e-02]
 [ 2.24514923e-02 -1.62662030e-02 -7.45161918e-02]
 [-2.25994231e-02  2.82313417e-03 -4.73937456e-02]
 [-4.74945685e-02  1.98227998e-02  7.68532918e-02]
 [ 6.51767909e-03 -4.74128307e-02 -1.27941967e-02]
 [-8.97568430e-02  2.93300818e-02  5.22240019e-02]
 [-1.10257872e-01 -6.23004858e-02 -7.32574898e-02]
 [ 2.05496161e+00  1.32018074e+00  1.57729123e-01]
 [ 5.64710223e-02 -8.51528672e-02  5.30804970e-02]
 [ 2.92713854e-02 -1.52785279e-02 -7.46906345e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.89318444]
curr_Stock_Price:  101.02147142949845
curr_Factors:  [101.02147143  -1.10264023  -0.98174027]
mat_Sqrt:  [[12.56547009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00929284 -0.00335824 -0.15539232]
Stock Position:  0.009292842029128836
Bond Position:  [8.95440787]


portfolio before change:  [9.88457672]
curr_Stock_Price:  99.97474211029031
curr_Factors:  [99.97474211 -1.15482975 -0.98845184]
mat_Sqrt:  [[11.7239761   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09954883 0.07339595 0.8708846 ]
Stock Position:  0.09954883310039188
Bond Position:  [-0.06779219]


portfolio before change:  [9.9120948]
curr_Stock_Price:  100.25125517267648
curr_Factors:  [100.25125517  -0.87129096  -1.02763925]
mat_Sqrt:  [[15.01049123  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01636305 -0.03979376  0.10396405]
Stock Position:  -0.016363049593411377
Bond Position:  [11.55251106]


portfolio before change:  [9.91672788]
curr_Stock_Price:  100.05636910548554
curr_Factors:  [100.05636911  -0.961135    -1.02015093]
mat_Sqrt:  [[13.79695322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04534132 0.38996013 2.98932116]
Stock Position:  0.045341324665301296
Bond Position:  [5.38003957]


portfolio before change:  [9.94990339]
curr_Stock_Price:  100.7732197439359
curr_Factors:  [100.77321974  -0.98998753  -1.01419822]
mat_Sqrt:  [[13.58120566  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00431817 -0.01106097 -0.05874131]
Stock Position:  -0.004318173393894209
Bond Position:  [10.38505963]


portfolio before change:  [9.95093785]
curr_Stock_Price:  100.83430050401631
curr_Factors:  [100.8343005   -0.881044    -1.01272649]
mat_Sqrt:  [[15.17589167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00282608 -0.01139759  0.09198579]
Stock Position:  0.0028260826359298033
Bond Position:  [9.66597178]


portfolio before change:  [9.94617453]
curr_Stock_Price:  98.72125715799308
curr_Factors:  [98.72125716 -0.78353001 -1.01885619]
mat_Sqrt:  [[16.27962122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00412181  0.01802969 -0.08670393]
Stock Position:  -0.004121808336503913
Bond Position:  [10.35308463]


portfolio before change:  [9.95185472]
curr_Stock_Price:  97.65716771435639
curr_Factors:  [97.65716771 -0.6666193  -1.00308882]
mat_Sqrt:  [[18.3890418   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110406  0.0237084   0.06035288]
Stock Position:  -0.0011040585982465844
Bond Position:  [10.05967396]


portfolio before change:  [9.95421704]
curr_Stock_Price:  96.65651720393096
curr_Factors:  [96.6565172  -0.87431609 -0.99392579]
mat_Sqrt:  [[14.92327024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0034839   0.0064198  -0.11330016]
Stock Position:  0.003483901484819929
Bond Position:  [9.61747525]


portfolio before change:  [9.95607531]
curr_Stock_Price:  96.84481693077498
curr_Factors:  [96.84481693 -0.76505099 -0.973241  ]
mat_Sqrt:  [[17.02729907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [5.13334055e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  5.1333405451536384e-05
Bond Position:  [9.95110394]


portfolio before change:  [9.95738812]
curr_Stock_Price:  98.18587700149912
curr_Factors:  [98.185877   -0.91731723 -0.99807634]
mat_Sqrt:  [[14.4611944   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07344319  0.51487465 -0.7273851 ]
Stock Position:  0.07344319125619661
Bond Position:  [2.74630398]


portfolio before change:  [10.02743926]
curr_Stock_Price:  99.13501651036283
curr_Factors:  [99.13501651 -0.70401133 -1.00362584]
mat_Sqrt:  [[17.97254943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00085151 0.00542708 0.17764582]
Stock Position:  0.0008515059694336202
Bond Position:  [9.94302521]


portfolio before change:  [10.02909791]
curr_Stock_Price:  99.62319624849239
curr_Factors:  [99.62319625 -0.71095626 -1.00155477]
mat_Sqrt:  [[17.97324026  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.36315627e-02  7.66061162e-04 -1.81866151e+00]
Stock Position:  -0.023631562712561147
Bond Position:  [12.38334972]


portfolio before change:  [10.04375138]
curr_Stock_Price:  99.06862213472355
curr_Factors:  [99.06862213 -0.79697886 -1.00327719]
mat_Sqrt:  [[16.37174061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.1069664  -1.01170504  7.54882843]
Stock Position:  0.106966396181159
Bond Position:  [-0.55326211]


portfolio before change:  [9.9686917]
curr_Stock_Price:  98.36755600986854
curr_Factors:  [98.36755601 -0.77458147 -0.97395865]
mat_Sqrt:  [[17.11869113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00096062 -0.02866286  0.07329141]
Stock Position:  0.0009606172153634038
Bond Position:  [9.87419813]


portfolio before change:  [9.97051517]
curr_Stock_Price:  98.98083309379876
curr_Factors:  [98.98083309 -0.83660904 -0.94886042]
mat_Sqrt:  [[16.60089761  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00514143  0.0285593  -0.189677  ]
Stock Position:  0.005141428963536363
Bond Position:  [9.46161225]


portfolio before change:  [9.97443187]
curr_Stock_Price:  99.51257572173984
curr_Factors:  [99.51257572 -0.73230338 -0.94720826]
mat_Sqrt:  [[18.555614    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282834  0.00860001 -0.21752452]
Stock Position:  -0.002828340334956612
Bond Position:  [10.2558873]


portfolio before change:  [9.97789201]
curr_Stock_Price:  98.74248427215893
curr_Factors:  [98.74248427 -0.70746207 -0.9258696 ]
mat_Sqrt:  [[19.28222382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03596366 -0.58679726 -0.56170956]
Stock Position:  -0.03596365788150949
Bond Position:  [13.52903294]


portfolio before change:  [9.97963015]
curr_Stock_Price:  98.74118018841581
curr_Factors:  [98.74118019 -0.6558504  -0.90077982]
mat_Sqrt:  [[20.81912139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079843  0.00295898 -0.00308429]
Stock Position:  0.0007984250541239203
Bond Position:  [9.90079272]


portfolio before change:  [9.98037449]
curr_Stock_Price:  98.12329562074655
curr_Factors:  [98.12329562 -0.7048411  -0.90469505]
mat_Sqrt:  [[19.62273139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00927907 0.06384609 0.77631323]
Stock Position:  0.00927906664337367
Bond Position:  [9.06988189]


portfolio before change:  [9.97298278]
curr_Stock_Price:  97.20450534043307
curr_Factors:  [97.20450534 -0.57166593 -0.89012994]
mat_Sqrt:  [[22.53390789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00126056 0.00312323 0.01629662]
Stock Position:  0.0012605604024383662
Bond Position:  [9.85045063]


portfolio before change:  [9.97405399]
curr_Stock_Price:  97.07744317997437
curr_Factors:  [97.07744318 -0.76898047 -0.87333894]
mat_Sqrt:  [[18.78746001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00617629 -0.01672934  0.13332657]
Stock Position:  0.006176285894480869
Bond Position:  [9.37447595]


portfolio before change:  [9.96553084]
curr_Stock_Price:  95.5077241001229
curr_Factors:  [95.5077241  -0.75525727 -0.85591126]
mat_Sqrt:  [[19.06851595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00346304 -0.03290702 -0.2865457 ]
Stock Position:  -0.0034630439791229614
Bond Position:  [10.29627829]


portfolio before change:  [9.96509386]
curr_Stock_Price:  96.00558005041871
curr_Factors:  [96.00558005 -0.67219583 -0.85514249]
mat_Sqrt:  [[20.84403885  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00670203  0.00446486  0.14893788]
Stock Position:  -0.006702032871991212
Bond Position:  [10.60852641]


portfolio before change:  [9.95937245]
curr_Stock_Price:  97.05713596595207
curr_Factors:  [97.05713597 -0.59296523 -0.872984  ]
mat_Sqrt:  [[22.40648909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00344668 -0.00146482 -0.06732756]
Stock Position:  0.00344667644951546
Bond Position:  [9.6248479]


portfolio before change:  [9.95907029]
curr_Stock_Price:  96.6203844643841
curr_Factors:  [96.62038446 -0.77751071 -0.86842714]
mat_Sqrt:  [[18.63146633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00325021 -0.01520642  0.71762803]
Stock Position:  0.0032502106020002412
Bond Position:  [9.64503369]


portfolio before change:  [9.9585645]
curr_Stock_Price:  96.09380616490522
curr_Factors:  [96.09380616 -0.59770673 -0.88053966]
mat_Sqrt:  [[21.91296513  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01128471 -0.04453799 -0.21241548]
Stock Position:  -0.011284714322219747
Bond Position:  [11.04295565]


portfolio before change:  [9.94031994]
curr_Stock_Price:  97.83288541396114
curr_Factors:  [97.83288541 -0.66984433 -0.87861973]
mat_Sqrt:  [[20.79674973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00369877  0.03449018  0.54658922]
Stock Position:  -0.003698769077524892
Bond Position:  [10.3021812]


portfolio before change:  [9.93312458]
curr_Stock_Price:  100.12641080251484
curr_Factors:  [100.1264108   -0.84333061  -0.89583417]
mat_Sqrt:  [[17.58891221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070354 -0.02153235  0.03166538]
Stock Position:  -0.0007035408322592187
Bond Position:  [10.00356759]


portfolio before change:  [9.93519857]
curr_Stock_Price:  98.9559518004909
curr_Factors:  [98.9559518  -0.74955472 -0.89790521]
mat_Sqrt:  [[19.05281552  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096397  0.02734236  0.04709332]
Stock Position:  -0.0009639675405131648
Bond Position:  [10.03058889]


portfolio before change:  [9.93626753]
curr_Stock_Price:  99.1477980392229
curr_Factors:  [99.14779804 -0.69070149 -0.86702974]
mat_Sqrt:  [[20.88185107  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.87752205e-04 -5.24989443e-03 -2.12573954e-01]
Stock Position:  0.00018775220470153642
Bond Position:  [9.91765232]


portfolio before change:  [9.93706132]
curr_Stock_Price:  96.77234522785287
curr_Factors:  [96.77234523 -0.88695115 -0.88410574]
mat_Sqrt:  [[16.46611075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192501  0.00091116 -0.13520116]
Stock Position:  -0.0019250059460804753
Bond Position:  [10.12334866]


portfolio before change:  [9.93982195]
curr_Stock_Price:  95.99565884588299
curr_Factors:  [95.99565885 -1.0863377  -0.8922634 ]
mat_Sqrt:  [[13.2726015   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209158  0.00639778  0.21924105]
Stock Position:  -0.002091575187067631
Bond Position:  [10.14060408]


portfolio before change:  [9.94247512]
curr_Stock_Price:  95.33323012971294
curr_Factors:  [95.33323013 -0.83383883 -0.89984244]
mat_Sqrt:  [[16.83899235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034278 -0.01530243 -0.03649828]
Stock Position:  -0.00034277757211708743
Bond Position:  [9.97515321]


portfolio before change:  [9.94343132]
curr_Stock_Price:  96.18151825611649
curr_Factors:  [96.18151826 -0.98610055 -0.93319017]
mat_Sqrt:  [[14.11088523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00518108  0.00946624  0.14898054]
Stock Position:  -0.005181084262942522
Bond Position:  [10.44175587]


portfolio before change:  [9.94414983]
curr_Stock_Price:  96.29477415645961
curr_Factors:  [96.29477416 -0.96136636 -0.93800177]
mat_Sqrt:  [[14.41177993  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00957054 -0.0201074  -0.20898323]
Stock Position:  -0.009570540833667684
Bond Position:  [10.8657429]


portfolio before change:  [9.95076083]
curr_Stock_Price:  95.74593370807791
curr_Factors:  [95.74593371 -0.88412816 -0.91500149]
mat_Sqrt:  [[15.84047709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.14877321 0.4260865  0.44995728]
Stock Position:  0.14877321471065164
Bond Position:  [-4.29366952]


portfolio before change:  [9.89118966]
curr_Stock_Price:  95.34912553574748
curr_Factors:  [95.34912554 -0.8302519  -0.8814726 ]
mat_Sqrt:  [[17.21568121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00289993 -0.02748297  0.15142388]
Stock Position:  0.0028999303904492283
Bond Position:  [9.61468384]


portfolio before change:  [9.88721629]
curr_Stock_Price:  93.56450285611845
curr_Factors:  [93.56450286 -0.5379209  -0.86340737]
mat_Sqrt:  [[23.04209593  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00106883 -0.00493112 -0.02130716]
Stock Position:  0.0010688286691309281
Bond Position:  [9.78721187]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.88970415]
Stock Price:  94.74746518466013
PL:  [9.88970415]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 9.78286445e-02 -1.84133205e-02  2.43715891e-02]
 [ 1.22347397e+00  2.56932208e-01  3.58152390e-01]
 [-2.50212670e-01 -1.43845201e-01  3.70949697e-02]
 [ 1.99001823e-01  1.57223206e+00  1.28799525e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-3.17671117e-02  3.07110754e-01 -1.37944356e-01]
 [-1.71623790e-01  2.80782343e-01  2.19853060e-01]
 [-3.51029219e-02  6.40565828e-02  2.49669088e-02]
 [ 5.46561556e-02  1.59112356e-02 -3.82840400e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 5.31899328e-01  1.21245134e+00 -1.39467339e-01]
 [-6.34376820e-04  4.12419127e-02  2.78899320e-02]
 [-4.27850581e-01 -6.76155039e-02 -1.15258979e+00]
 [ 2.15439057e+00 -3.27630829e+00  2.78794530e+00]
 [ 7.46162335e-03 -1.49696401e-02 -2.37694255e-02]
 [ 1.89283810e-02  2.95823371e-01 -1.62079856e-01]
 [ 3.57365864e-02 -8.41319189e-02  3.04029265e-02]
 [-3.00377955e-01 -1.91606649e+00 -1.94771856e-01]
 [ 4.17549132e-02 -1.10260991e-01  5.09420605e-02]
 [-2.07127841e-01  3.34835549e-01  1.28104829e-01]
 [ 1.90572447e-02  7.96585523e-02 -4.52502066e-02]
 [ 9.35904610e-02 -4.80953753e-02  4.37777534e-02]
 [-1.30507388e-02 -1.07348185e-01 -1.06444511e-01]
 [-1.12470588e-01 -1.58021594e-02  6.42009779e-02]
 [ 7.21591964e-02  1.76239154e-02 -2.43801188e-02]
 [ 2.08198092e-02 -4.67650131e-02  2.54185637e-01]
 [ 1.78459964e-01 -1.05533027e-01  7.62834326e-02]
 [ 9.38829364e-03 -1.05608912e-01 -2.02224774e-02]
 [ 8.31835964e-03 -5.76609445e-02  2.67794261e-02]
 [-1.74434242e-02  6.80772721e-02  4.30857030e-02]
 [-1.67770160e-02 -2.59218012e-02 -5.98689338e-02]
 [-2.77921286e-02  2.24426690e-02 -5.20333853e-02]
 [-4.98029155e-02 -5.76017511e-02  1.36282144e-02]
 [ 3.23361414e-01  4.16426596e-02  6.93601241e-02]
 [-5.70903338e-02 -1.45219930e-02  3.09890560e-02]
 [-9.66859042e-02 -3.04979052e-02 -1.06952714e-01]
 [ 2.44855767e+00  1.65112846e+00  1.89561224e-01]
 [-9.04127819e-02 -3.29656536e-02 -2.18078591e-02]
 [ 3.63073742e-02 -1.31033727e-02 -1.35693504e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.94982151]
curr_Stock_Price:  101.16566181391732
curr_Factors:  [101.16566181  -0.93172135  -0.99271421]
mat_Sqrt:  [[14.7659495   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00670765 -0.00594287  0.06952536]
Stock Position:  0.006707653378737763
Bond Position:  [10.27123732]


portfolio before change:  [10.94883645]
curr_Stock_Price:  100.82738545445939
curr_Factors:  [100.82738545  -0.77984049  -0.9979464 ]
mat_Sqrt:  [[17.04101551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07916357 0.08292451 1.02170908]
Stock Position:  0.07916356768474432
Bond Position:  [2.9669809]


portfolio before change:  [10.88181495]
curr_Stock_Price:  99.97607970604817
curr_Factors:  [99.97607971 -1.07917722 -0.97171801]
mat_Sqrt:  [[12.85889417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02115291 -0.04642584  0.10582162]
Stock Position:  -0.021152905241672182
Bond Position:  [12.99659949]


portfolio before change:  [10.89451633]
curr_Stock_Price:  99.45243022498758
curr_Factors:  [99.45243022 -1.25205523 -0.94375994]
mat_Sqrt:  [[11.06585538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07074404 0.50743572 3.67429193]
Stock Position:  0.07074403645365307
Bond Position:  [3.85884998]


portfolio before change:  [10.86407196]
curr_Stock_Price:  99.01526602300115
curr_Factors:  [99.01526602 -1.4719844  -0.94594188]
mat_Sqrt:  [[ 8.82287489  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00664704 -0.01106097 -0.05874131]
Stock Position:  -0.006647039844886949
Bond Position:  [11.52223038]


portfolio before change:  [10.87210729]
curr_Stock_Price:  98.02310064911934
curr_Factors:  [98.02310065 -0.93335013 -0.98925117]
mat_Sqrt:  [[14.33353454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.92822964e-04  9.91195696e-02 -3.93516852e-01]
Stock Position:  0.00019282296374470342
Bond Position:  [10.85320619]


portfolio before change:  [10.87336974]
curr_Stock_Price:  97.53412116417594
curr_Factors:  [97.53412116 -1.02751566 -0.96662553]
mat_Sqrt:  [[13.27737005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00522935  0.09062211  0.62717958]
Stock Position:  -0.00522935006486685
Bond Position:  [11.3834098]


portfolio before change:  [10.87943408]
curr_Stock_Price:  96.64656748514261
curr_Factors:  [96.64656749 -0.95154048 -0.97860632]
mat_Sqrt:  [[14.02601591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120712  0.02067417  0.07122364]
Stock Position:  -0.0012071195359326494
Bond Position:  [10.99609804]


portfolio before change:  [10.88116089]
curr_Stock_Price:  96.35478921452517
curr_Factors:  [96.35478921 -1.12633471 -0.952873  ]
mat_Sqrt:  [[12.04716526  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00415777  0.00513533 -0.10921371]
Stock Position:  0.0041577686479522405
Bond Position:  [10.48053997]


portfolio before change:  [10.87925774]
curr_Stock_Price:  95.58194644552151
curr_Factors:  [95.58194645 -1.41638263 -0.97286287]
mat_Sqrt:  [[ 8.764754    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [9.97254739e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  9.972547394178213e-05
Bond Position:  [10.86972579]


portfolio before change:  [10.88065426]
curr_Stock_Price:  95.96016413202021
curr_Factors:  [95.96016413 -1.39678695 -1.00581648]
mat_Sqrt:  [[ 8.68267552  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08648501  0.39131699 -0.3978615 ]
Stock Position:  0.08648500903207039
Bond Position:  [2.5815386]


portfolio before change:  [10.8783174]
curr_Stock_Price:  95.92941225608482
curr_Factors:  [95.92941226 -1.59163337 -1.00402711]
mat_Sqrt:  [[ 7.1560071   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00188333 0.01331077 0.07956221]
Stock Position:  0.0018833270718130127
Bond Position:  [10.69765094]


portfolio before change:  [10.87940625]
curr_Stock_Price:  95.79749669496516
curr_Factors:  [95.79749669 -1.25014175 -1.03713403]
mat_Sqrt:  [[ 9.72753743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06958842 -0.02182281 -3.28801785]
Stock Position:  -0.06958841824216895
Bond Position:  [17.54580251]


portfolio before change:  [10.84831712]
curr_Stock_Price:  96.27577289835901
curr_Factors:  [96.2757729  -1.13317833 -1.03379918]
mat_Sqrt:  [[11.02581341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.18635395 -1.05742395  7.95323193]
Stock Position:  0.18635395071364844
Bond Position:  [-7.09305351]


portfolio before change:  [10.73644727]
curr_Stock_Price:  95.6802225304832
curr_Factors:  [95.68022253 -0.87129642 -1.02146497]
mat_Sqrt:  [[14.41472471  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.09374819e-05 -4.83143056e-03 -6.78075547e-02]
Stock Position:  -3.0937481901951285e-05
Bond Position:  [10.73940738]


portfolio before change:  [10.73778701]
curr_Stock_Price:  95.76990755207348
curr_Factors:  [95.76990755 -0.97323715 -1.00640541]
mat_Sqrt:  [[13.22760525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349486  0.09547658 -0.46236872]
Stock Position:  0.003494862503718567
Bond Position:  [10.40308435]


portfolio before change:  [10.74130891]
curr_Stock_Price:  96.40553467356293
curr_Factors:  [96.40553467 -0.80882137 -1.00277299]
mat_Sqrt:  [[15.75203015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00157245 -0.02715346  0.08673109]
Stock Position:  0.0015724450436957996
Bond Position:  [10.5897165]


portfolio before change:  [10.74100657]
curr_Stock_Price:  95.37139058501184
curr_Factors:  [95.37139059 -0.48838384 -0.98559352]
mat_Sqrt:  [[21.8412697   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03348024 -0.6184078  -0.55562989]
Stock Position:  -0.03348024352860316
Bond Position:  [13.93406395]


portfolio before change:  [10.78968802]
curr_Stock_Price:  93.96938223413208
curr_Factors:  [93.96938223 -0.65659545 -0.97486864]
mat_Sqrt:  [[18.38444488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00161259 -0.03558658  0.14532352]
Stock Position:  0.0016125853879732702
Bond Position:  [10.63815436]


portfolio before change:  [10.79262507]
curr_Stock_Price:  94.96604463577842
curr_Factors:  [94.96604464 -0.52983156 -0.98040987]
mat_Sqrt:  [[20.9738824   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00537004  0.10806771  0.36544742]
Stock Position:  -0.005370037345433
Bond Position:  [11.30259628]


portfolio before change:  [10.79252332]
curr_Stock_Price:  95.24810294503528
curr_Factors:  [95.24810295 -0.44309081 -0.97128014]
mat_Sqrt:  [[23.15276372  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112647  0.02570969 -0.12908624]
Stock Position:  0.0011264667652189039
Bond Position:  [10.6852295]


portfolio before change:  [10.79382006]
curr_Stock_Price:  95.21347987258825
curr_Factors:  [95.21347987 -0.63492124 -0.95607046]
mat_Sqrt:  [[19.3972214   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00477951 -0.01552272  0.12488574]
Stock Position:  0.00477950569265033
Bond Position:  [10.33874669]


portfolio before change:  [10.79395172]
curr_Stock_Price:  94.97061890598407
curr_Factors:  [94.97061891 -0.55704147 -0.96279037]
mat_Sqrt:  [[20.77469648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272885 -0.03464648 -0.30365656]
Stock Position:  -0.002728848059305497
Bond Position:  [11.05311211]


portfolio before change:  [10.78973767]
curr_Stock_Price:  97.02121912717757
curr_Factors:  [97.02121913 -0.96899355 -0.94402201]
mat_Sqrt:  [[14.32368054  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00716235 -0.00510013  0.18314752]
Stock Position:  -0.007162350517250429
Bond Position:  [11.48463765]


portfolio before change:  [10.78458726]
curr_Stock_Price:  97.94076076501084
curr_Factors:  [97.94076077 -1.11062235 -0.94142638]
mat_Sqrt:  [[12.58258962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00562524  0.00568809 -0.06954969]
Stock Position:  0.005625240457776845
Bond Position:  [10.23364693]


portfolio before change:  [10.78876354]
curr_Stock_Price:  98.45575944587718
curr_Factors:  [98.45575945 -1.19172575 -0.93988635]
mat_Sqrt:  [[11.6813693   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00540685 -0.01509334  0.72512087]
Stock Position:  0.005406846167974984
Bond Position:  [10.25642839]


portfolio before change:  [10.79488335]
curr_Stock_Price:  99.35049024967998
curr_Factors:  [99.35049025 -1.06662282 -0.91623404]
mat_Sqrt:  [[13.67811416  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01261061 -0.03406064  0.2176154 ]
Stock Position:  0.012610613807125701
Bond Position:  [9.54201268]


portfolio before change:  [10.80482055]
curr_Stock_Price:  100.04390407283957
curr_Factors:  [100.04390407  -1.14987708  -0.93088515]
mat_Sqrt:  [[12.48898317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013049  -0.03408513 -0.0576891 ]
Stock Position:  -0.0013049045673949823
Bond Position:  [10.93536829]


portfolio before change:  [10.80685299]
curr_Stock_Price:  99.53394949323454
curr_Factors:  [99.53394949 -0.92564705 -0.94452163]
mat_Sqrt:  [[15.33794938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00013135 -0.01860999  0.07639425]
Stock Position:  0.00013135367917117998
Bond Position:  [10.79377884]


portfolio before change:  [10.80826013]
curr_Stock_Price:  99.97419417144086
curr_Factors:  [99.97419417 -0.86133955 -0.95662122]
mat_Sqrt:  [[16.23145975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0003233  0.02197185 0.12291152]
Stock Position:  0.0003232995145479796
Bond Position:  [10.77593852]


portfolio before change:  [10.81011964]
curr_Stock_Price:  101.5592129567019
curr_Factors:  [101.55921296  -0.89771428  -0.95358243]
mat_Sqrt:  [[15.94818919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215002 -0.00836623 -0.1707894 ]
Stock Position:  -0.0021500231799004162
Bond Position:  [11.0284743]


portfolio before change:  [10.81099824]
curr_Stock_Price:  101.7917899050213
curr_Factors:  [101.79178991  -0.86136436  -0.99350864]
mat_Sqrt:  [[15.92764788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00212412  0.00724334 -0.14843676]
Stock Position:  -0.0021241245716357654
Bond Position:  [11.02721668]


portfolio before change:  [10.811027]
curr_Stock_Price:  102.427217260956
curr_Factors:  [102.42721726  -1.14413393  -0.99222053]
mat_Sqrt:  [[12.09507105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00485975 -0.01859089  0.0388775 ]
Stock Position:  -0.004859746242463566
Bond Position:  [11.30879729]


portfolio before change:  [10.81208255]
curr_Stock_Price:  102.50091356643055
curr_Factors:  [102.50091357  -1.18062019  -0.95482512]
mat_Sqrt:  [[12.11478254  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02856178 0.01344011 0.19786513]
Stock Position:  0.028561780688794537
Bond Position:  [7.88447393]


portfolio before change:  [10.81925094]
curr_Stock_Price:  102.71738364152277
curr_Factors:  [102.71738364  -1.33244659  -0.95364244]
mat_Sqrt:  [[10.44258689  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00514518 -0.00468695  0.08840315]
Stock Position:  -0.005145181860488451
Bond Position:  [11.34775056]


portfolio before change:  [10.81859022]
curr_Stock_Price:  103.12150332557945
curr_Factors:  [103.12150333  -1.22513183  -0.96889179]
mat_Sqrt:  [[11.49467997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01085223 -0.00984316 -0.30510632]
Stock Position:  -0.010852228562727962
Bond Position:  [11.93768835]


portfolio before change:  [10.81173946]
curr_Stock_Price:  103.89029173071907
curr_Factors:  [103.89029173  -1.32058434  -0.95518628]
mat_Sqrt:  [[10.67137402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.2646601  0.53289942 0.54076541]
Stock Position:  0.2646600964239039
Bond Position:  [-16.68387517]


portfolio before change:  [10.98389476]
curr_Stock_Price:  104.54864904871198
curr_Factors:  [104.54864905  -1.34661804  -0.95531479]
mat_Sqrt:  [[10.46168649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00971099 -0.01063962 -0.06221175]
Stock Position:  -0.009710994345029636
Bond Position:  [11.9991661]


portfolio before change:  [10.98280005]
curr_Stock_Price:  104.81584034214673
curr_Factors:  [104.81584034  -1.50831344  -0.95767149]
mat_Sqrt:  [[ 8.90150154  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00066667 -0.0042291  -0.3870958 ]
Stock Position:  0.0006666671876432772
Bond Position:  [10.91292277]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.98437996]
Stock Price:  105.13939173474466
PL:  [5.84498822]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.47695145e-02 -9.33046029e-02  7.62293691e-04]
 [ 1.18082485e+00  2.40895563e-01  3.47189287e-01]
 [-2.28544430e-01 -1.23900034e-01  3.64629381e-02]
 [ 1.65575245e-01  1.23314000e+00  1.05551252e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 1.12551378e-02  8.48093633e-02 -1.84710382e-02]
 [-5.16073222e-02 -2.03939099e-03 -7.02506269e-02]
 [-3.32943685e-02  2.19291403e-01 -3.38357723e-02]
 [ 1.37606104e-02  6.56420496e-02 -4.66672654e-02]
 [-1.40104656e-01 -7.44052788e-02 -4.32161019e-02]
 [ 6.68774701e-01  1.29601488e+00 -2.31484034e-01]
 [-2.34073609e-04  1.55067161e-02 -5.75303691e-02]
 [-1.49931638e-01 -7.35662595e-03 -3.23634785e-01]
 [ 1.69707594e+00 -3.25037990e+00  2.72718877e+00]
 [-3.32870489e-03 -9.35006762e-02  3.65584097e-02]
 [ 1.23679784e-01 -4.41360080e-02 -3.31651324e-03]
 [-1.38364376e-01 -1.72736985e-01 -3.24740863e-02]
 [-2.61100930e-01 -1.70851014e+00 -2.00594089e-01]
 [-1.65912374e-02  6.93205412e-02  2.40148415e-01]
 [ 2.94466245e-01 -2.61969492e-01  3.90806002e-01]
 [ 8.13258142e-02 -6.51591959e-02 -8.94695994e-02]
 [ 4.16747340e-02 -5.43971226e-02 -7.64830045e-02]
 [ 2.71761522e-01  2.92515631e-01  2.61518051e-01]
 [-1.48938949e-01  4.47455518e-02  9.65298356e-02]
 [-8.70114322e-02 -2.51031254e-01  9.67270513e-02]
 [ 1.36666292e-01 -3.80333100e-02 -1.41349716e-01]
 [ 5.06134640e-01 -3.53510403e-02  3.02517427e-01]
 [-6.04075815e-02  5.95031446e-02  1.07366731e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 1.64453579e-01 -2.27892246e-02  1.40270357e-02]
 [-3.00822279e-02 -8.12764189e-02 -2.13633412e-02]
 [ 1.06753767e-01  2.50990088e-02 -9.05309619e-02]
 [-8.57091134e-02 -4.76835029e-02  1.76371135e-02]
 [ 5.58129237e-01  9.92745214e-02  1.64902740e-01]
 [ 2.25807926e-01  3.22018203e-01 -2.03224391e-01]
 [ 1.86122526e-02  3.15708149e-02  6.95274674e-02]
 [ 2.20759879e+00  1.59821732e+00  1.99260528e-01]
 [-1.02553945e-01 -3.01941783e-03 -3.65124931e-03]
 [ 4.10374385e-02 -1.12318916e-02 -2.54670282e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.57270919]
curr_Stock_Price:  99.88604606839158
curr_Factors:  [99.88604607 -1.04615127 -0.97999686]
mat_Sqrt:  [[13.1692145   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003129  -0.03011393  0.00217461]
Stock Position:  -0.00031289681536753825
Bond Position:  [1.60396322]


portfolio before change:  [1.57280255]
curr_Stock_Price:  100.22848669646629
curr_Factors:  [100.2284867   -1.19006063  -0.96504053]
mat_Sqrt:  [[11.61562633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11199286 0.07774871 0.9904344 ]
Stock Position:  0.11199285572924565
Bond Position:  [-9.6520719]


portfolio before change:  [1.56322489]
curr_Stock_Price:  100.15374021874105
curr_Factors:  [100.15374022  -1.09566241  -0.99175583]
mat_Sqrt:  [[12.41975273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01983876 -0.03998856  0.10401861]
Stock Position:  -0.019838756728234385
Bond Position:  [3.55015058]


portfolio before change:  [1.5649693]
curr_Stock_Price:  100.0881814296772
curr_Factors:  [100.08818143  -0.99296831  -0.99498551]
mat_Sqrt:  [[13.70962013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04615332 0.39799422 3.01108341]
Stock Position:  0.046153319869309956
Bond Position:  [-3.05443256]


portfolio before change:  [1.57264861]
curr_Stock_Price:  100.26284155887247
curr_Factors:  [100.26284156  -0.92530163  -0.99359115]
mat_Sqrt:  [[14.71551489  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00398532 -0.01106097 -0.05874131]
Stock Position:  -0.003985317630686952
Bond Position:  [1.97222788]


portfolio before change:  [1.57513482]
curr_Stock_Price:  99.70086324546617
curr_Factors:  [99.70086325 -0.86926302 -1.00004742]
mat_Sqrt:  [[15.37686187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00161258  0.0273721  -0.05269273]
Stock Position:  0.0016125781680647018
Bond Position:  [1.41435938]


portfolio before change:  [1.57623768]
curr_Stock_Price:  100.2751314144019
curr_Factors:  [100.27513141  -0.95123807  -0.9783866 ]
mat_Sqrt:  [[14.56021849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00455786 -0.00065821 -0.20040548]
Stock Position:  -0.004557861569919936
Bond Position:  [2.03327785]


portfolio before change:  [1.57723437]
curr_Stock_Price:  100.11222124745422
curr_Factors:  [100.11222125  -0.78776292  -0.99039246]
mat_Sqrt:  [[16.91391037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0002697   0.070776   -0.09652404]
Stock Position:  0.0002696953816509326
Bond Position:  [1.55023457]


portfolio before change:  [1.57753146]
curr_Stock_Price:  100.4952266531215
curr_Factors:  [100.49522665  -0.98580051  -0.97249257]
mat_Sqrt:  [[14.17978203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124359  0.02118588 -0.13312872]
Stock Position:  0.0012435890756325532
Bond Position:  [1.4525567]


portfolio before change:  [1.5779189]
curr_Stock_Price:  100.66076498601943
curr_Factors:  [100.66076499  -0.84276311  -0.94980539]
mat_Sqrt:  [[16.76322681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00979012 -0.0240142  -0.12328351]
Stock Position:  -0.00979012108161564
Bond Position:  [2.56339998]


portfolio before change:  [1.56340933]
curr_Stock_Price:  102.17555959073839
curr_Factors:  [102.17555959  -1.06499815  -0.94064748]
mat_Sqrt:  [[13.75011076  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06444102  0.418287   -0.66035952]
Stock Position:  0.0644410191289996
Bond Position:  [-5.02088786]


portfolio before change:  [1.62599656]
curr_Stock_Price:  103.15653230238803
curr_Factors:  [103.1565323   -1.25178959  -0.97630707]
mat_Sqrt:  [[11.11339237  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079293  0.00500477 -0.16411813]
Stock Position:  -0.0007929276283106469
Bond Position:  [1.70779222]


portfolio before change:  [1.62681535]
curr_Stock_Price:  102.39315502608729
curr_Factors:  [102.39315503  -0.92176647  -0.9683263 ]
mat_Sqrt:  [[15.46728416  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01406161 -0.00237434 -0.92323996]
Stock Position:  -0.014061613842999107
Bond Position:  [3.06662835]


portfolio before change:  [1.64434046]
curr_Stock_Price:  101.17410827027265
curr_Factors:  [101.17410827  -1.01105649  -0.97080061]
mat_Sqrt:  [[13.94311409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11405487 -1.0490556   7.77991045]
Stock Position:  0.11405486517134864
Bond Position:  [-9.89505881]


portfolio before change:  [1.65666803]
curr_Stock_Price:  101.29303813081039
curr_Factors:  [101.29303813  -1.02951477  -0.99748405]
mat_Sqrt:  [[13.34335985  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112056 -0.03017721  0.10429097]
Stock Position:  -0.0011205570809301793
Bond Position:  [1.77017267]


portfolio before change:  [1.65635807]
curr_Stock_Price:  101.76713011991579
curr_Factors:  [101.76713012  -1.31720454  -1.02525937]
mat_Sqrt:  [[ 9.77886342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01165714 -0.01424484 -0.00946109]
Stock Position:  0.011657139897601894
Bond Position:  [0.4700444]


portfolio before change:  [1.66524041]
curr_Stock_Price:  102.52405485835392
curr_Factors:  [102.52405486  -1.47177749  -1.03539546]
mat_Sqrt:  [[ 8.35553754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02157287 -0.05575062 -0.09263953]
Stock Position:  -0.02157286831466495
Bond Position:  [3.87697834]


portfolio before change:  [1.65655553]
curr_Stock_Price:  102.94910398758296
curr_Factors:  [102.94910399  -1.35383043  -1.05333558]
mat_Sqrt:  [[ 9.27264543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07018442 -0.55141928 -0.5722391 ]
Stock Position:  -0.07018441547096378
Bond Position:  [8.88197822]


portfolio before change:  [1.6891029]
curr_Stock_Price:  102.50118335595141
curr_Factors:  [102.50118336  -1.29507936  -1.06225915]
mat_Sqrt:  [[ 9.70397724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00479998 0.02237311 0.68507658]
Stock Position:  0.004799975075465827
Bond Position:  [1.19709977]


portfolio before change:  [1.69133509]
curr_Stock_Price:  102.93504968366544
curr_Factors:  [102.93504968  -1.35462702  -1.05500599]
mat_Sqrt:  [[ 9.24853532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03468278 -0.08455029  1.11486075]
Stock Position:  0.03468277697958447
Bond Position:  [-1.87873828]


portfolio before change:  [1.73763903]
curr_Stock_Price:  104.27689137863175
curr_Factors:  [104.27689138  -1.28774798  -1.06375774]
mat_Sqrt:  [[ 9.92983701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0050114  -0.02103004 -0.25523186]
Stock Position:  0.005011395805570148
Bond Position:  [1.21506625]


portfolio before change:  [1.73588045]
curr_Stock_Price:  103.89566570369087
curr_Factors:  [103.8956657   -1.2201841   -1.04904809]
mat_Sqrt:  [[10.74193237  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139257 -0.0175566  -0.21818472]
Stock Position:  0.001392574391297098
Bond Position:  [1.59119801]


portfolio before change:  [1.73717789]
curr_Stock_Price:  104.68451053649106
curr_Factors:  [104.68451054  -1.02792334  -1.06173193]
mat_Sqrt:  [[12.95259171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02971245 0.09440901 0.74603821]
Stock Position:  0.029712445421609526
Bond Position:  [-1.37325492]


portfolio before change:  [1.74611321]
curr_Stock_Price:  104.99101483256524
curr_Factors:  [104.99101483  -0.97494737  -1.0682817 ]
mat_Sqrt:  [[13.60783468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00882589  0.01444156  0.27537275]
Stock Position:  -0.008825888472897706
Bond Position:  [2.6727522]


portfolio before change:  [1.74928019]
curr_Stock_Price:  104.67004275689126
curr_Factors:  [104.67004276  -1.08433992  -1.0919497 ]
mat_Sqrt:  [[11.87604482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0099788  -0.08101999  0.27593535]
Stock Position:  -0.009978797437323326
Bond Position:  [2.79376135]


portfolio before change:  [1.74259031]
curr_Stock_Price:  105.37545105474015
curr_Factors:  [105.37545105  -0.87635058  -1.07902767]
mat_Sqrt:  [[14.9117792   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00670945 -0.0122752  -0.40323139]
Stock Position:  0.006709453254019057
Bond Position:  [1.03557864]


portfolio before change:  [1.74107367]
curr_Stock_Price:  105.13011186789757
curr_Factors:  [105.13011187  -0.86477881  -1.06882691]
mat_Sqrt:  [[15.20452424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03687519 -0.0114095   0.86299801]
Stock Position:  0.03687519197227918
Bond Position:  [-2.13561939]


portfolio before change:  [1.71507297]
curr_Stock_Price:  104.43225146336256
curr_Factors:  [104.43225146  -0.50484282  -1.058942  ]
mat_Sqrt:  [[21.86208221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120507  0.01920456  0.3062874 ]
Stock Position:  -0.0012050732594393438
Bond Position:  [1.84092148]


portfolio before change:  [1.71433992]
curr_Stock_Price:  105.23151978504833
curr_Factors:  [105.23151979  -0.15645239  -1.06049373]
mat_Sqrt:  [[31.16254055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110323 -0.02600141 -0.03673698]
Stock Position:  -0.0011032303242987786
Bond Position:  [1.83043452]


portfolio before change:  [1.71496142]
curr_Stock_Price:  104.87558240819733
curr_Factors:  [104.87558241  -0.33452665  -1.0576235 ]
mat_Sqrt:  [[26.06581191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00624055 -0.00735519  0.04001523]
Stock Position:  0.006240550080505395
Bond Position:  [1.06048009]


portfolio before change:  [1.72132248]
curr_Stock_Price:  105.87364990657962
curr_Factors:  [105.87364991  -0.42826427  -1.04442005]
mat_Sqrt:  [[24.27779339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210206 -0.02623185 -0.06094367]
Stock Position:  -0.002102064236977123
Bond Position:  [1.94387569]


portfolio before change:  [1.72529587]
curr_Stock_Price:  104.0990164161881
curr_Factors:  [104.09901642  -0.3128951   -1.04729191]
mat_Sqrt:  [[26.71313834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349631  0.00810067 -0.25825964]
Stock Position:  0.003496314218621142
Bond Position:  [1.361333]


portfolio before change:  [1.73072967]
curr_Stock_Price:  105.60449337479189
curr_Factors:  [105.60449337  -0.24932066  -1.0212202 ]
mat_Sqrt:  [[29.64104518  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309848 -0.01538978  0.05031378]
Stock Position:  -0.003098484092530112
Bond Position:  [2.05794351]


portfolio before change:  [1.72516536]
curr_Stock_Price:  107.4833350828246
curr_Factors:  [107.48333508  -0.35145317  -1.04028593]
mat_Sqrt:  [[26.72492654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.022902   0.03204071 0.47042162]
Stock Position:  0.022901997279125893
Bond Position:  [-0.73641768]


portfolio before change:  [1.74759535]
curr_Stock_Price:  108.46674480012953
curr_Factors:  [108.4667448   -0.37255059  -1.06719926]
mat_Sqrt:  [[25.7052122   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00972786  0.10393093 -0.57974262]
Stock Position:  0.009727856347180583
Bond Position:  [0.69244644]


portfolio before change:  [1.72627152]
curr_Stock_Price:  106.26580837155414
curr_Factors:  [106.26580837  -0.48549978  -1.06380872]
mat_Sqrt:  [[22.57030462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00173896 0.01018944 0.19834251]
Stock Position:  0.0017389598312076337
Bond Position:  [1.54147955]


portfolio before change:  [1.72681177]
curr_Stock_Price:  106.46567293110613
curr_Factors:  [106.46567293  -0.28059527  -1.04532342]
mat_Sqrt:  [[28.27290495  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09105918 0.51582242 0.56843482]
Stock Position:  0.09105917567162186
Bond Position:  [-7.96786464]


portfolio before change:  [1.87367357]
curr_Stock_Price:  108.08942845929529
curr_Factors:  [108.08942846  -0.29779525  -1.02095486]
mat_Sqrt:  [[28.91061482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359437 -0.00097451 -0.010416  ]
Stock Position:  -0.003594374925026726
Bond Position:  [2.2621875]


portfolio before change:  [1.86704608]
curr_Stock_Price:  110.01195550493108
curr_Factors:  [110.0119555   -0.43540725  -1.01728344]
mat_Sqrt:  [[25.7361948   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.14435619e-04 -3.62507744e-03 -7.26503427e-01]
Stock Position:  -0.0005144356189457235
Bond Position:  [1.92364015]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.86735846]
Stock Price:  109.87217149485534
PL:  [-8.00481304]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-3.14556809e-02 -6.51757544e-02  2.29405352e-01]
 [ 4.91459959e-01  1.91331743e-01  1.22762504e-01]
 [-3.40717426e-01 -2.27152961e-01  3.97348644e-02]
 [ 2.13267897e-01  1.35582222e+00  1.31868022e+00]
 [-4.76363422e-02 -3.32673833e-02 -1.90533590e-02]
 [ 4.65703839e-04  1.26207792e-01 -3.57636862e-02]
 [-1.73995197e-01  3.31999528e-01  1.74845466e-01]
 [-5.27650547e-02  1.00852003e-01  1.00523502e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-6.48430609e-02 -2.76710948e-02  8.80499127e-03]
 [ 8.19863330e-01  1.62502132e+00 -2.73404630e-01]
 [-3.33629339e-04  8.37018774e-03  2.04965156e-04]
 [-3.23399138e-01 -6.12765331e-04 -6.95345094e-01]
 [ 1.87618176e+00 -3.25582145e+00  2.74714190e+00]
 [ 3.11051135e-02 -9.15656345e-02  2.57602351e-02]
 [ 8.66861188e-02  6.23779731e-02 -5.07949957e-02]
 [-2.73469408e-02  5.75565855e-02 -8.78588912e-02]
 [-2.80700078e-01 -1.80408129e+00 -1.94799324e-01]
 [-7.33170556e-03 -1.05951938e-02  3.70873751e-01]
 [ 2.23437435e-01  2.66454139e-01  5.58271973e-01]
 [ 5.43949035e-02 -2.66071994e-01 -5.22268626e-02]
 [ 9.95907379e-02 -4.94318980e-02  1.29589398e-02]
 [-4.74589194e-02  3.67400608e-02 -6.24918737e-03]
 [ 1.47766512e-01 -2.00927656e-01 -2.29397654e-01]
 [ 3.24403329e-02 -5.46825999e-03 -2.93803030e-03]
 [-1.00550397e-02 -3.87814948e-02  2.02704992e-01]
 [ 5.81897248e-01 -1.17259421e-01  2.76793291e-01]
 [ 1.92889908e-01 -3.95264730e-01 -2.86598696e-01]
 [-7.20022831e-03 -7.18806978e-02 -1.02205272e-03]
 [ 1.15632801e-01 -2.86516404e-02  4.89762685e-02]
 [-1.68122507e-02 -1.60020432e-02 -6.67717952e-02]
 [-4.34866718e-02  2.37331523e-02 -4.81546969e-02]
 [-7.23297114e-02 -4.92486768e-02  2.05843261e-02]
 [ 2.36467076e-01  1.60550169e-02  4.59076892e-02]
 [-2.71608873e-03 -3.53480007e-02  2.69116792e-02]
 [-1.15523096e-01 -6.39426483e-02 -8.24404937e-02]
 [ 2.10395124e+00  1.36314613e+00  1.62036931e-01]
 [-6.59394727e-03 -1.59588644e-01 -6.17607390e-02]
 [ 3.41606096e-02 -1.34871929e-02 -8.96244106e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.61830599]
curr_Stock_Price:  99.58705663215783
curr_Factors:  [99.58705663 -0.48953386 -0.97932162]
mat_Sqrt:  [[22.9238242   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.01919902e-05 -2.10353843e-02  6.54429615e-01]
Stock Position:  9.019199018592147e-05
Bond Position:  [-0.62728795]


portfolio before change:  [-0.61842845]
curr_Stock_Price:  99.09875563312255
curr_Factors:  [99.09875563 -0.67522562 -0.9699024 ]
mat_Sqrt:  [[19.12485633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02904985 0.06175205 0.35020725]
Stock Position:  0.02904984850443158
Bond Position:  [-3.49723229]


portfolio before change:  [-0.61163849]
curr_Stock_Price:  99.3475397496149
curr_Factors:  [99.34753975 -0.71987032 -0.97146417]
mat_Sqrt:  [[18.3071138   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02070091 -0.0733133   0.11335251]
Stock Position:  -0.020700913795071926
Bond Position:  [1.44494637]


portfolio before change:  [-0.60664194]
curr_Stock_Price:  99.11489709780263
curr_Factors:  [99.1148971  -0.7617025  -0.99692427]
mat_Sqrt:  [[17.07564157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0444609  0.43758974 3.76182762]
Stock Position:  0.044460901741026584
Bond Position:  [-5.01337964]


portfolio before change:  [-0.63075447]
curr_Stock_Price:  98.58666174836415
curr_Factors:  [98.58666175 -0.94984729 -1.00128164]
mat_Sqrt:  [[14.01050001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416233 -0.010737   -0.05435393]
Stock Position:  -0.0041623260357299225
Bond Position:  [-0.22040465]


portfolio before change:  [-0.6317931]
curr_Stock_Price:  98.82957221844487
curr_Factors:  [98.82957222 -1.2012618  -1.01139954]
mat_Sqrt:  [[10.81285317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175047  0.04073339 -0.10202384]
Stock Position:  0.0017504657934123836
Bond Position:  [-0.80479088]


portfolio before change:  [-0.6333062]
curr_Stock_Price:  98.0226481985049
curr_Factors:  [98.0226482  -1.21110641 -0.98455014]
mat_Sqrt:  [[10.90849677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00646614  0.10715239  0.49878545]
Stock Position:  -0.006466142634279666
Bond Position:  [0.00052223]


portfolio before change:  [-0.62886093]
curr_Stock_Price:  97.33519081479682
curr_Factors:  [97.33519081 -1.2203985  -0.97917246]
mat_Sqrt:  [[10.78967473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279219  0.03254984  0.02867656]
Stock Position:  -0.002792187834815846
Bond Position:  [-0.3570828]


portfolio before change:  [-0.62782558]
curr_Stock_Price:  96.94839966409437
curr_Factors:  [96.94839966 -1.14354962 -0.94317898]
mat_Sqrt:  [[12.03056235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00432159  0.0064198  -0.11330016]
Stock Position:  0.004321593774943149
Bond Position:  [-1.04679718]


portfolio before change:  [-0.62226312]
curr_Stock_Price:  98.26581170529954
curr_Factors:  [98.26581171 -0.94287763 -0.95629145]
mat_Sqrt:  [[14.70969938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00466999 -0.00893081  0.02511819]
Stock Position:  -0.004669985862430417
Bond Position:  [-0.16336317]


portfolio before change:  [-0.62469609]
curr_Stock_Price:  98.78241855356801
curr_Factors:  [98.78241855 -0.95064749 -0.97004074]
mat_Sqrt:  [[14.47222661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07571474  0.52447338 -0.77994731]
Stock Position:  0.07571474390760374
Bond Position:  [-8.10398161]


portfolio before change:  [-0.55645381]
curr_Stock_Price:  99.69710612979013
curr_Factors:  [99.69710613 -0.88798174 -0.98809905]
mat_Sqrt:  [[15.27253112  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [9.27656591e-05 2.70146648e-03 5.84708538e-04]
Stock Position:  9.27656590794633e-05
Bond Position:  [-0.56570228]


portfolio before change:  [-0.55653566]
curr_Stock_Price:  99.57715729893899
curr_Factors:  [99.5771573  -0.96619208 -0.98218903]
mat_Sqrt:  [[14.19020136  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.28015741e-02 -1.97769160e-04 -1.98362601e+00]
Stock Position:  -0.03280157407197977
Bond Position:  [2.70975185]


portfolio before change:  [-0.54622189]
curr_Stock_Price:  99.2730554096594
curr_Factors:  [99.27305541 -1.04062735 -1.00876337]
mat_Sqrt:  [[12.78769619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.13859791 -1.05081185  7.83683118]
Stock Position:  0.1385979112275041
Bond Position:  [-14.30526002]


portfolio before change:  [-0.55507177]
curr_Stock_Price:  99.22210510506525
curr_Factors:  [99.22210511 -1.15569265 -1.00293024]
mat_Sqrt:  [[11.45857014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00154231 -0.02955268  0.07348678]
Stock Position:  0.0015423078419230848
Bond Position:  [-0.7081028]


portfolio before change:  [-0.55497814]
curr_Stock_Price:  99.34020348576604
curr_Factors:  [99.34020349 -1.24448004 -0.99283065]
mat_Sqrt:  [[10.60408881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00839775  0.0201324  -0.14490398]
Stock Position:  0.008397749745747224
Bond Position:  [-1.38921231]


portfolio before change:  [-0.56229235]
curr_Stock_Price:  98.4899109380086
curr_Factors:  [98.48991094 -1.34943623 -0.99739158]
mat_Sqrt:  [[ 9.42274366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355866  0.01857631 -0.25063696]
Stock Position:  -0.0035586634104031066
Bond Position:  [-0.21179991]


portfolio before change:  [-0.56240345]
curr_Stock_Price:  98.51369036957007
curr_Factors:  [98.51369037 -1.38291556 -0.98893866]
mat_Sqrt:  [[ 9.19207141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07492543 -0.58226473 -0.55570825]
Stock Position:  -0.07492542678985911
Bond Position:  [6.81877685]


portfolio before change:  [-0.61081811]
curr_Stock_Price:  99.17123837277819
curr_Factors:  [99.17123837 -1.48049353 -0.98143648]
mat_Sqrt:  [[ 8.45635331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0078296  -0.00341958  1.05799958]
Stock Position:  0.00782959798979923
Bond Position:  [-1.38728904]


portfolio before change:  [-0.60782854]
curr_Stock_Price:  99.57521795381483
curr_Factors:  [99.57521795 -1.70290718 -0.9889722 ]
mat_Sqrt:  [[ 6.74656805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05807159 0.0859977  1.59259454]
Stock Position:  0.058071592016131775
Bond Position:  [-6.39031997]


portfolio before change:  [-0.59972306]
curr_Stock_Price:  99.72855141609858
curr_Factors:  [99.72855142 -1.68377504 -0.97637428]
mat_Sqrt:  [[ 6.97479324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151654 -0.08587437 -0.1489887 ]
Stock Position:  -0.0015165436719787693
Bond Position:  [-0.44848036]


portfolio before change:  [-0.59975883]
curr_Stock_Price:  99.7151686154825
curr_Factors:  [99.71516862 -1.76486078 -0.96982229]
mat_Sqrt:  [[ 6.47296802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01423547 -0.01595408  0.03696825]
Stock Position:  0.01423546759305845
Bond Position:  [-2.01925088]


portfolio before change:  [-0.59870851]
curr_Stock_Price:  99.80668234823204
curr_Factors:  [99.80668235 -1.76173484 -0.97397631]
mat_Sqrt:  [[ 6.47225118  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00637104  0.0118578  -0.01782719]
Stock Position:  -0.006371043826431809
Bond Position:  [0.03716424]


portfolio before change:  [-0.5967585]
curr_Stock_Price:  99.50133829904757
curr_Factors:  [99.5013383  -1.76843495 -1.01135483]
mat_Sqrt:  [[ 6.17421233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00970597 -0.06484912 -0.65440765]
Stock Position:  0.009705971010420972
Bond Position:  [-1.56251561]


portfolio before change:  [-0.59093401]
curr_Stock_Price:  100.12155649688196
curr_Factors:  [100.1215565   -1.74897665  -1.03403007]
mat_Sqrt:  [[ 6.19274405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00496136 -0.00176487 -0.00838138]
Stock Position:  0.00496135572065888
Bond Position:  [-1.08767267]


portfolio before change:  [-0.58848317]
curr_Stock_Price:  100.64294876034225
curr_Factors:  [100.64294876  -1.92764142  -1.0637131 ]
mat_Sqrt:  [[ 5.05422524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00463092 -0.01251667  0.57826092]
Stock Position:  0.004630918291614204
Bond Position:  [-1.05455244]


portfolio before change:  [-0.58756189]
curr_Stock_Price:  100.87035460046448
curr_Factors:  [100.8703546   -1.82883619  -1.06233813]
mat_Sqrt:  [[ 5.59941293  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10973685 -0.03784532  0.78961421]
Stock Position:  0.10973685476238648
Bond Position:  [-11.65675735]


portfolio before change:  [-0.56747863]
curr_Stock_Price:  101.06664645118622
curr_Factors:  [101.06664645  -1.79049063  -1.06367135]
mat_Sqrt:  [[ 5.82185066  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00922475 -0.12757114 -0.81758631]
Stock Position:  0.009224750328677374
Bond Position:  [-1.49979321]


portfolio before change:  [-0.56810293]
curr_Stock_Price:  101.01929426288251
curr_Factors:  [101.01929426  -1.78091425  -1.05570789]
mat_Sqrt:  [[ 5.92208979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372866 -0.0231994  -0.00291563]
Stock Position:  -0.0037286567314087997
Bond Position:  [-0.19143666]


portfolio before change:  [-0.5681216]
curr_Stock_Price:  101.01788478201772
curr_Factors:  [101.01788478  -1.49961359  -1.07227381]
mat_Sqrt:  [[ 7.71688032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01552202 -0.00924728  0.13971566]
Stock Position:  0.015522017133910895
Bond Position:  [-2.13612294]


portfolio before change:  [-0.5714719]
curr_Stock_Price:  100.81924643231338
curr_Factors:  [100.81924643  -1.37421941  -1.07822138]
mat_Sqrt:  [[ 8.67884525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00388397 -0.00516464 -0.19048135]
Stock Position:  -0.0038839717407119978
Bond Position:  [-0.1798928]


portfolio before change:  [-0.5726723]
curr_Stock_Price:  101.12251997664754
curr_Factors:  [101.12251998  -1.21902791  -1.07677483]
mat_Sqrt:  [[10.18107001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00476096  0.00765984 -0.13737195]
Stock Position:  -0.004760963110294872
Bond Position:  [-0.09123171]


portfolio before change:  [-0.57341707]
curr_Stock_Price:  101.27655698507856
curr_Factors:  [101.27655699  -1.20361773  -1.06390681]
mat_Sqrt:  [[10.48903493  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00745357 -0.01589494  0.05872135]
Stock Position:  -0.007453573949229002
Bond Position:  [0.18145524]


portfolio before change:  [-0.57020524]
curr_Stock_Price:  100.84868989035868
curr_Factors:  [100.84868989  -0.96057704  -1.04052628]
mat_Sqrt:  [[13.63333587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0182725  0.00518173 0.13096186]
Stock Position:  0.01827250222720033
Bond Position:  [-2.41296316]


portfolio before change:  [-0.56985115]
curr_Stock_Price:  100.88457628816987
curr_Factors:  [100.88457629  -0.85613354  -1.00128906]
mat_Sqrt:  [[15.7454976   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00028187 -0.01140852  0.07677153]
Stock Position:  -0.00028186760115066374
Bond Position:  [-0.54141506]


portfolio before change:  [-0.56974539]
curr_Stock_Price:  100.26926224630189
curr_Factors:  [100.26926225  -0.87361916  -0.99976526]
mat_Sqrt:  [[15.40165191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00944077 -0.0206374  -0.23517978]
Stock Position:  -0.009440768443007756
Bond Position:  [0.37687349]


portfolio before change:  [-0.57805305]
curr_Stock_Price:  101.15422871502041
curr_Factors:  [101.15422872  -1.19758143  -1.00484115]
mat_Sqrt:  [[11.18108806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.21601457 0.43995352 0.46224626]
Stock Position:  0.21601456990383058
Bond Position:  [-22.42884025]


portfolio before change:  [-0.56659477]
curr_Stock_Price:  101.22025230105535
curr_Factors:  [101.2202523   -1.24862736  -1.00757224]
mat_Sqrt:  [[10.60260003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0048834  -0.05150701 -0.1761862 ]
Stock Position:  -0.004883396584872351
Bond Position:  [-0.07229613]


portfolio before change:  [-0.56531859]
curr_Stock_Price:  100.95707219402476
curr_Factors:  [100.95707219  -1.45152064  -0.97814331]
mat_Sqrt:  [[ 8.89092815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147488 -0.00435297 -0.2556735 ]
Stock Position:  0.0014748788215573209
Bond Position:  [-0.71421804]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.5661478]
Stock Price:  100.45538798063996
PL:  [-1.02153578]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-2.31689455e-02 -8.69611525e-02  1.71647887e-01]
 [ 8.43978742e-01  2.10443831e-01  2.38847480e-01]
 [-3.40690836e-01 -2.27128485e-01  3.97340888e-02]
 [ 1.92960762e-01  1.52922197e+00  1.24926746e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 8.24342073e-03  8.91037767e-02 -1.68877727e-02]
 [-5.47129202e-02  6.65052706e-03 -6.42688999e-02]
 [-5.83279436e-02  1.30869994e-01 -1.56908745e-03]
 [ 3.14531107e-02  4.64959050e-02 -4.37584765e-02]
 [-1.13866707e-01 -5.81126514e-02 -2.50803345e-02]
 [ 8.73223467e-01  1.68048288e+00 -3.03511219e-01]
 [ 5.60843972e-05  1.28053987e-02 -5.82180484e-02]
 [-2.28442059e-01 -4.82156091e-05 -4.47030298e-01]
 [ 1.68857960e+00 -3.07931154e+00  2.58700674e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.38871297e-01 -3.73109060e-03 -3.52716237e-02]
 [-4.85030360e-02  1.06643527e-02 -7.73321976e-02]
 [-2.77811246e-01 -1.80600309e+00 -2.01436231e-01]
 [ 1.30094623e-03  3.72499194e-02  5.83893053e-02]
 [ 1.16665779e-01  6.14074394e-02  2.83529551e-01]
 [ 3.90252467e-02 -4.68144884e-02  1.00325743e-01]
 [ 1.13868940e-01 -5.06082035e-02 -4.50405013e-03]
 [ 1.74769012e-02  6.55827718e-02  3.17290973e-02]
 [-6.86995910e-02 -3.98479377e-02  1.65999818e-02]
 [ 9.84306402e-03 -7.82445196e-02  2.27114475e-02]
 [ 2.75851017e-02 -1.76958519e-02  1.91292961e-01]
 [ 5.14525714e-01 -1.13961398e-01  2.39294495e-01]
 [ 1.38683998e-01 -3.02926548e-01 -2.00585221e-01]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 9.21020939e-02 -1.34103321e-02  5.48000947e-02]
 [-1.93756418e-02 -1.52468655e-02 -6.62248782e-02]
 [-3.37172547e-02  2.26554606e-02 -5.04843906e-02]
 [-1.06925073e-01 -3.46608094e-02  3.49350692e-02]
 [ 2.35422210e-01  1.51363882e-02  4.51420287e-02]
 [-9.29529588e-02 -9.60567498e-04  4.37866820e-02]
 [-1.15375049e-01 -6.46094411e-02 -8.10934670e-02]
 [ 1.46049935e+00  9.67780917e-01  1.38399713e-01]
 [-2.23007226e-02 -9.18888415e-02 -3.56477603e-02]
 [ 3.45310487e-02 -1.37963325e-02 -9.76340904e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.1065926]
curr_Stock_Price:  99.11103946248556
curr_Factors:  [99.11103946 -0.90979438 -0.98791438]
mat_Sqrt:  [[14.85790538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.95906290e-04 -2.80665913e-02  4.89663645e-01]
Stock Position:  -0.00039590629034364075
Bond Position:  [-4.06735391]


portfolio before change:  [-4.10723262]
curr_Stock_Price:  99.4433731446525
curr_Factors:  [99.44337314 -1.14495678 -0.98229581]
mat_Sqrt:  [[11.85009367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07896055 0.06792045 0.68136538]
Stock Position:  0.0789605528426071
Bond Position:  [-11.95933634]


portfolio before change:  [-4.13205796]
curr_Stock_Price:  99.14790499418733
curr_Factors:  [99.14790499 -1.17097598 -1.00437973]
mat_Sqrt:  [[11.26000447  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03365385 -0.0733054   0.1133503 ]
Stock Position:  -0.03365385489088896
Bond Position:  [-0.79534875]


portfolio before change:  [-4.14288458]
curr_Stock_Price:  99.4666559028622
curr_Factors:  [99.4666559  -1.23277514 -1.0022458 ]
mat_Sqrt:  [[10.64192653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07142669 0.49355427 3.56381232]
Stock Position:  0.07142668565477779
Bond Position:  [-11.24745815]


portfolio before change:  [-4.1756843]
curr_Stock_Price:  99.02713252907893
curr_Factors:  [99.02713253 -1.02081285 -1.02637406]
mat_Sqrt:  [[12.78416088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045874  -0.01106097 -0.05874131]
Stock Position:  -0.004587395407808389
Bond Position:  [-3.72140769]


portfolio before change:  [-4.17751424]
curr_Stock_Price:  99.32462992636697
curr_Factors:  [99.32462993 -1.09179266 -1.01443675]
mat_Sqrt:  [[12.08740701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00190152  0.02875812 -0.04817611]
Stock Position:  0.00190152038393868
Bond Position:  [-4.36638205]


portfolio before change:  [-4.1767075]
curr_Stock_Price:  100.03594079147749
curr_Factors:  [100.03594079  -0.82778069  -1.00417411]
mat_Sqrt:  [[16.01578382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00415054  0.00214645 -0.18334128]
Stock Position:  -0.004150544362253651
Bond Position:  [-3.76150389]


portfolio before change:  [-4.17480426]
curr_Stock_Price:  99.46409698792205
curr_Factors:  [99.46409699 -1.02644729 -1.01896167]
mat_Sqrt:  [[12.86342207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248258  0.04223811 -0.00447617]
Stock Position:  -0.002482582503317978
Bond Position:  [-3.92787643]


portfolio before change:  [-4.17480986]
curr_Stock_Price:  99.2685703551561
curr_Factors:  [99.26857036 -1.0938884  -1.02281439]
mat_Sqrt:  [[11.95472057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00267776  0.01500649 -0.12483075]
Stock Position:  0.002677761119027918
Bond Position:  [-4.44062738]


portfolio before change:  [-4.17305221]
curr_Stock_Price:  100.13226442618206
curr_Factors:  [100.13226443  -1.11737102  -1.0424497 ]
mat_Sqrt:  [[11.54983601  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01132903 -0.01875578 -0.07154721]
Stock Position:  -0.01132902705686768
Bond Position:  [-3.03865107]


portfolio before change:  [-4.18122093]
curr_Stock_Price:  100.81977843822179
curr_Factors:  [100.81977844  -0.89432105  -1.05658929]
mat_Sqrt:  [[14.33098835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0805455   0.54237352 -0.86583303]
Stock Position:  0.08054550056662499
Bond Position:  [-12.30180045]


portfolio before change:  [-4.17637341]
curr_Stock_Price:  100.89905454351707
curr_Factors:  [100.89905454  -0.81435429  -1.07683205]
mat_Sqrt:  [[15.22493     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060517  0.00413292 -0.16607989]
Stock Position:  -0.0006051741393327598
Bond Position:  [-4.11531192]


portfolio before change:  [-4.17710303]
curr_Stock_Price:  101.25460824247907
curr_Factors:  [101.25460824  -0.81713489  -1.07407085]
mat_Sqrt:  [[15.27828405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.09252281e-02 -1.55615209e-05 -1.27525301e+00]
Stock Position:  -0.020925228078123557
Bond Position:  [-2.05832726]


portfolio before change:  [-4.1649417]
curr_Stock_Price:  100.66113127086186
curr_Factors:  [100.66113127  -0.64870563  -1.07215012]
mat_Sqrt:  [[18.00958274  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08818018 -0.99384353  7.38001016]
Stock Position:  0.08818018298766844
Bond Position:  [-13.04125867]


portfolio before change:  [-4.07946739]
curr_Stock_Price:  101.64893339446128
curr_Factors:  [101.64893339  -0.81249717  -1.08261945]
mat_Sqrt:  [[15.27791658  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141835 -0.03053791  0.10625201]
Stock Position:  -0.0014183460657624003
Bond Position:  [-3.93529402]


portfolio before change:  [-4.07766176]
curr_Stock_Price:  100.02903809764209
curr_Factors:  [100.0290381   -0.50792569  -1.08189921]
mat_Sqrt:  [[20.40205481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00641651 -0.0012042  -0.10062012]
Stock Position:  0.006416505688777805
Bond Position:  [-4.71949865]


portfolio before change:  [-4.08078015]
curr_Stock_Price:  99.63498890918494
curr_Factors:  [99.63498891 -0.339248   -1.07909733]
mat_Sqrt:  [[24.12305602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257478  0.00344191 -0.22060723]
Stock Position:  -0.0025747796115430308
Bond Position:  [-3.82424201]


portfolio before change:  [-4.08344291]
curr_Stock_Price:  100.48349026600847
curr_Factors:  [100.48349027  -0.5641116   -1.09321006]
mat_Sqrt:  [[19.15706878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03589161 -0.58288499 -0.5746415 ]
Stock Position:  -0.03589161204651405
Bond Position:  [-0.47692846]


portfolio before change:  [-4.15525985]
curr_Stock_Price:  102.48276838423331
curr_Factors:  [102.48276838  -0.42706108  -1.08819525]
mat_Sqrt:  [[22.52077793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00092462 0.01202236 0.16656844]
Stock Position:  0.0009246226436580549
Bond Position:  [-4.25001774]


portfolio before change:  [-4.15845896]
curr_Stock_Price:  99.59745114225153
curr_Factors:  [99.59745114 -0.60436583 -1.10070196]
mat_Sqrt:  [[18.10283915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01033406 0.01981917 0.80883089]
Stock Position:  0.010334055669395222
Bond Position:  [-5.18770457]


portfolio before change:  [-4.14649225]
curr_Stock_Price:  100.81819282384613
curr_Factors:  [100.81819282  -0.90933707  -1.12779254]
mat_Sqrt:  [[13.14694236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00379922 -0.01510931  0.28620142]
Stock Position:  0.0037992245200590123
Bond Position:  [-4.5295232]


portfolio before change:  [-4.14811632]
curr_Stock_Price:  100.53975645807905
curr_Factors:  [100.53975646  -0.86244737  -1.14351667]
mat_Sqrt:  [[13.52566767  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.007587   -0.01633373 -0.0128488 ]
Stock Position:  0.007586996899395176
Bond Position:  [-4.91091114]


portfolio before change:  [-4.15579511]
curr_Stock_Price:  99.60857262101585
curr_Factors:  [99.60857262 -1.12661773 -1.13893586]
mat_Sqrt:  [[10.33663769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00361245 0.02116675 0.09051428]
Stock Position:  0.0036124515970009695
Bond Position:  [-4.51562626]


portfolio before change:  [-4.15837209]
curr_Stock_Price:  99.05147411192631
curr_Factors:  [99.05147411 -1.13597421 -1.14119549]
mat_Sqrt:  [[10.16011696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00722876 -0.01286087  0.04735513]
Stock Position:  -0.007228761283901038
Bond Position:  [-3.44235263]


portfolio before change:  [-4.16914514]
curr_Stock_Price:  100.48224796581778
curr_Factors:  [100.48224797  -1.09173116  -1.17585432]
mat_Sqrt:  [[10.40613566  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00014343 -0.02525331  0.06478944]
Stock Position:  -0.00014343238487019694
Bond Position:  [-4.15473273]


portfolio before change:  [-4.16971678]
curr_Stock_Price:  100.84664383105475
curr_Factors:  [100.84664383  -1.39915125  -1.16309624]
mat_Sqrt:  [[ 7.77842201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00810196 -0.00571131  0.54570557]
Stock Position:  0.008101959906079037
Bond Position:  [-4.98677224]


portfolio before change:  [-4.16418636]
curr_Stock_Price:  101.60618901008458
curr_Factors:  [101.60618901  -1.51242259  -1.17946179]
mat_Sqrt:  [[ 6.884139    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07845705 -0.03678088  0.68264059]
Stock Position:  0.07845704821189367
Bond Position:  [-12.13590803]


portfolio before change:  [-4.18275272]
curr_Stock_Price:  101.38888185621309
curr_Factors:  [101.38888186  -1.58211109  -1.15709287]
mat_Sqrt:  [[ 6.55192882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00548008 -0.09776912 -0.5722138 ]
Stock Position:  0.005480079111745377
Bond Position:  [-4.73837181]


portfolio before change:  [-4.18362208]
curr_Stock_Price:  101.33832972338179
curr_Factors:  [101.33832972  -1.48900945  -1.16581595]
mat_Sqrt:  [[ 7.12521085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310153 -0.02321455 -0.0028026 ]
Stock Position:  -0.003101526800940994
Bond Position:  [-3.86931854]


portfolio before change:  [-4.18294126]
curr_Stock_Price:  100.96286480126608
curr_Factors:  [100.9628648   -1.35851431  -1.14837823]
mat_Sqrt:  [[ 8.23061081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01221668 -0.00432817  0.15632942]
Stock Position:  0.012216680636272834
Bond Position:  [-5.41637234]


portfolio before change:  [-4.1848985]
curr_Stock_Price:  100.85807786479761
curr_Factors:  [100.85807786  -1.29763598  -1.14971921]
mat_Sqrt:  [[ 8.72645459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00412607 -0.0049209  -0.18892114]
Stock Position:  -0.0041260733620174135
Bond Position:  [-3.76875067]


portfolio before change:  [-4.18509438]
curr_Stock_Price:  100.79137041711584
curr_Factors:  [100.79137042  -1.08796069  -1.16003339]
mat_Sqrt:  [[10.64466321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00370118  0.00731202 -0.14401791]
Stock Position:  -0.003701179684420668
Bond Position:  [-3.81204741]


portfolio before change:  [-4.18572042]
curr_Stock_Price:  100.83176276113899
curr_Factors:  [100.83176276  -0.97768343  -1.17368052]
mat_Sqrt:  [[11.72929391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0091113  -0.01118673  0.09966003]
Stock Position:  -0.0091112978039832
Bond Position:  [-3.2670122]


portfolio before change:  [-4.18343487]
curr_Stock_Price:  100.53609091915635
curr_Factors:  [100.53609092  -0.86001203  -1.13569433]
mat_Sqrt:  [[13.66462559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01812904 0.00488525 0.12877764]
Stock Position:  0.01812903604440142
Bond Position:  [-6.00605728]


portfolio before change:  [-4.1983891]
curr_Stock_Price:  99.75262797212501
curr_Factors:  [99.75262797 -1.08411454 -1.15815423]
mat_Sqrt:  [[10.59544962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00794786 -0.00031002  0.12491122]
Stock Position:  -0.007947856659974108
Bond Position:  [-3.40556951]


portfolio before change:  [-4.19731331]
curr_Stock_Price:  99.56370712792852
curr_Factors:  [99.56370713 -0.96576542 -1.13528906]
mat_Sqrt:  [[12.17936626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01191495 -0.02085261 -0.23133709]
Stock Position:  -0.011914949237832258
Bond Position:  [-3.01101679]


portfolio before change:  [-4.20202217]
curr_Stock_Price:  99.92732300702784
curr_Factors:  [99.92732301 -0.94792632 -1.15918892]
mat_Sqrt:  [[12.14998476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.13879009 0.31234995 0.39481586]
Stock Position:  0.1387900940033436
Bond Position:  [-18.07094472]


portfolio before change:  [-4.22660263]
curr_Stock_Price:  99.76649419152211
curr_Factors:  [99.76649419 -0.73441419 -1.15400673]
mat_Sqrt:  [[15.09572328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320184 -0.029657   -0.10169314]
Stock Position:  -0.00320183548322662
Bond Position:  [-3.90716673]


portfolio before change:  [-4.22914066]
curr_Stock_Price:  100.40662838029664
curr_Factors:  [100.40662838  -1.02031348  -1.15739911]
mat_Sqrt:  [[11.37611105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103598 -0.00445275 -0.27852288]
Stock Position:  0.0010359787078763332
Bond Position:  [-4.33315979]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.22804311]
Stock Price:  101.9889215541146
PL:  [-6.21696467]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.83424823e-02 -8.41197908e-02 -4.77577611e-03]
 [ 1.25658803e+00  2.43236744e-01  3.65691594e-01]
 [-1.42179832e-01 -4.44032043e-02  3.39438058e-02]
 [ 1.12548871e-01  9.84917377e-01  7.39859473e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 2.78853042e-02 -8.87594030e-02  5.18673105e-02]
 [-1.09651439e-01  1.60376552e-01  4.15487962e-02]
 [-2.38433905e-02  2.06953645e-01 -2.85321280e-02]
 [ 2.62751296e-02  5.20993174e-02 -4.46097781e-02]
 [-1.18753655e-01 -6.11472337e-02 -2.84582107e-02]
 [ 8.67168541e-01  1.66597472e+00 -3.02164588e-01]
 [-3.82157748e-06  2.96507291e-02 -5.87793981e-02]
 [-2.56637459e-01 -1.49221370e-03 -5.13356494e-01]
 [ 1.68235008e+00 -3.23661097e+00  2.71468924e+00]
 [-9.78133413e-03 -9.45884314e-02  3.72274900e-02]
 [ 1.27802469e-01 -4.91900672e-02 -4.32367406e-04]
 [-1.40374052e-01 -1.78374142e-01 -3.33496149e-02]
 [-2.65033787e-01 -1.72716002e+00 -1.99240601e-01]
 [-3.18954563e-02  1.44709326e-01  3.65270492e-01]
 [ 2.39072835e-01 -4.57311208e-02  4.41141060e-01]
 [ 6.48889505e-02 -1.45566482e-01 -1.32348779e-03]
 [ 1.63070500e-01 -5.60647067e-02 -2.24353382e-02]
 [ 7.83541598e-02  1.58642925e-01  1.20452072e-01]
 [-1.46038255e-01  3.46081981e-02  2.95895883e-02]
 [-2.05214988e-02 -1.40764191e-01  4.98412427e-02]
 [ 4.74346127e-02 -9.61749701e-03  8.88818210e-02]
 [ 4.83690975e-01 -1.01253045e-01  2.31854933e-01]
 [ 5.18739544e-02 -1.65589315e-01 -7.43494641e-02]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 5.77762783e-02  1.61175928e-02  4.03629949e-02]
 [-1.32225772e-02 -1.68281548e-02 -6.75247213e-02]
 [-4.72603774e-02  2.41494404e-02 -4.72547888e-02]
 [-4.09824004e-02 -5.39228218e-02  2.53904608e-02]
 [ 2.60723013e-01  3.73804326e-02  6.36820374e-02]
 [-5.96129933e-02 -3.31769344e-02  4.71752158e-02]
 [-9.78074306e-02 -4.04784809e-02 -9.12178211e-02]
 [ 1.49938426e+00  1.02643990e+00  1.46606766e-01]
 [-6.32918380e-03 -1.60384064e-01 -6.36520181e-02]
 [ 3.52829840e-02 -1.35328411e-02 -1.11500306e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.23125954]
curr_Stock_Price:  99.83945130257881
curr_Factors:  [99.8394513  -1.08761724 -1.02404849]
mat_Sqrt:  [[12.08418632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.62816635e-05 -2.71495458e-02 -1.36239599e-02]
Stock Position:  1.6281663504308694e-05
Bond Position:  [1.22963399]


portfolio before change:  [1.23142443]
curr_Stock_Price:  100.52614657526694
curr_Factors:  [100.52614658  -1.12443764  -1.02381108]
mat_Sqrt:  [[11.73022853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11772021 0.07850432 1.04321633]
Stock Position:  0.11772021358386388
Bond Position:  [-10.60253501]


portfolio before change:  [1.27558917]
curr_Stock_Price:  100.91257243799218
curr_Factors:  [100.91257244  -1.0579042   -1.03041968]
mat_Sqrt:  [[12.50252516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01154286 -0.01433107  0.09683223]
Stock Position:  -0.011542856000689043
Bond Position:  [2.44040846]


portfolio before change:  [1.27339524]
curr_Stock_Price:  101.12906991239814
curr_Factors:  [101.12906991  -1.13153103  -1.03522246]
mat_Sqrt:  [[11.58422344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04010778 0.31788072 2.11061314]
Stock Position:  0.04010777882916937
Bond Position:  [-2.78266713]


portfolio before change:  [1.2384178]
curr_Stock_Price:  100.26565678744404
curr_Factors:  [100.26565679  -1.14785527  -1.04852113]
mat_Sqrt:  [[11.1500818   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00525969 -0.01106097 -0.05874131]
Stock Position:  -0.005259692436827175
Bond Position:  [1.76578432]


portfolio before change:  [1.23947381]
curr_Stock_Price:  100.10684991163211
curr_Factors:  [100.10684991  -1.40210781  -1.01636698]
mat_Sqrt:  [[ 8.91525032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00228314 -0.02864697  0.147963  ]
Stock Position:  0.0022831369470698052
Bond Position:  [1.01091617]


portfolio before change:  [1.23901501]
curr_Stock_Price:  99.85054713224092
curr_Factors:  [99.85054713 -1.62432931 -1.00390193]
mat_Sqrt:  [[ 7.20981507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00949173  0.05176131  0.11852715]
Stock Position:  -0.009491727470493871
Bond Position:  [2.18676919]


portfolio before change:  [1.24120325]
curr_Stock_Price:  99.64880566812084
curr_Factors:  [99.64880567 -1.35776224 -1.04512591]
mat_Sqrt:  [[ 9.01386471  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139527  0.066794   -0.08139422]
Stock Position:  0.0013952671190224225
Bond Position:  [1.10216655]


portfolio before change:  [1.24085524]
curr_Stock_Price:  99.30063558872007
curr_Factors:  [99.30063559 -1.2616756  -1.0354785 ]
mat_Sqrt:  [[ 9.98414039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00278481  0.01681498 -0.12725928]
Stock Position:  0.002784809136345384
Bond Position:  [0.96432192]


portfolio before change:  [1.24329385]
curr_Stock_Price:  100.13303056730244
curr_Factors:  [100.13303057  -1.1520444   -1.0409361 ]
mat_Sqrt:  [[11.17321181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01226543 -0.01973518 -0.08118335]
Stock Position:  -0.012265433804421333
Bond Position:  [2.47146891]


portfolio before change:  [1.24249205]
curr_Stock_Price:  100.2235901073293
curr_Factors:  [100.22359011  -1.08878506  -1.05610457]
mat_Sqrt:  [[11.73427409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09762471  0.53769103 -0.86199146]
Stock Position:  0.09762471118089562
Bond Position:  [-8.54180699]


portfolio before change:  [1.24740318]
curr_Stock_Price:  100.28483403877729
curr_Factors:  [100.28483404  -1.08941594  -1.05807695]
mat_Sqrt:  [[11.71091825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050805  0.00956973 -0.16768126]
Stock Position:  -0.0005080460912139694
Bond Position:  [1.29835249]


portfolio before change:  [1.24723484]
curr_Stock_Price:  100.93563888302754
curr_Factors:  [100.93563888  -0.95521609  -1.06986432]
mat_Sqrt:  [[13.32181164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.71532522e-02 -4.81609901e-04 -1.46446319e+00]
Stock Position:  -0.02715325223933629
Bond Position:  [3.9879657]


portfolio before change:  [1.22717582]
curr_Stock_Price:  101.69273249587995
curr_Factors:  [101.6927325   -1.03384671  -1.04706933]
mat_Sqrt:  [[12.69286212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12414956 -1.0446117   7.74425278]
Stock Position:  0.12414956038379572
Bond Position:  [-11.39793222]


portfolio before change:  [1.23499565]
curr_Stock_Price:  101.76719640156222
curr_Factors:  [101.7671964   -1.06659886  -1.07268661]
mat_Sqrt:  [[11.98196188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179354 -0.03052828  0.10619967]
Stock Position:  -0.0017935366066110586
Bond Position:  [1.41751884]


portfolio before change:  [1.23474121]
curr_Stock_Price:  102.00786121017593
curr_Factors:  [102.00786121  -1.24412292  -1.05961967]
mat_Sqrt:  [[10.18898566  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01154907 -0.01587603 -0.00123342]
Stock Position:  0.011549072302764661
Bond Position:  [0.05664504]


portfolio before change:  [1.2404993]
curr_Stock_Price:  102.50582463910357
curr_Factors:  [102.50582464  -1.29979381  -1.08293248]
mat_Sqrt:  [[ 9.46114432  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01940484 -0.05757001 -0.09513717]
Stock Position:  -0.019404839036454725
Bond Position:  [3.22960833]


portfolio before change:  [1.25027934]
curr_Stock_Price:  102.02262998552234
curr_Factors:  [102.02262999  -1.49576665  -1.0712337 ]
mat_Sqrt:  [[ 7.83181512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08404931 -0.5574385  -0.56837798]
Stock Position:  -0.08404931142363123
Bond Position:  [9.82521114]


portfolio before change:  [1.27076157]
curr_Stock_Price:  101.79355017990638
curr_Factors:  [101.79355018  -1.60039521  -1.09371538]
mat_Sqrt:  [[ 6.88149659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01049245 0.04670473 1.04201504]
Stock Position:  0.010492446962234624
Bond Position:  [0.20269814]


portfolio before change:  [1.26751477]
curr_Stock_Price:  101.48169312878113
curr_Factors:  [101.48169313  -1.32607617  -1.10342694]
mat_Sqrt:  [[ 8.93856716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03577593 -0.01475966  1.25845265]
Stock Position:  0.03577592970949369
Bond Position:  [-2.36308715]


portfolio before change:  [1.29537626]
curr_Stock_Price:  102.26872795411359
curr_Factors:  [102.26872795  -1.43838158  -1.10497612]
mat_Sqrt:  [[ 8.03852999  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00434223 -0.04698138 -0.00377554]
Stock Position:  0.004342231847141485
Bond Position:  [0.85130174]


portfolio before change:  [1.29785646]
curr_Stock_Price:  102.8154004831232
curr_Factors:  [102.81540048  -1.23723009  -1.11556805]
mat_Sqrt:  [[ 9.77802002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0150385  -0.01809481 -0.06400178]
Stock Position:  0.015038499080750594
Bond Position:  [-0.24833284]


portfolio before change:  [1.28353959]
curr_Stock_Price:  101.86545032568196
curr_Factors:  [101.86545033  -1.33450903  -1.12357795]
mat_Sqrt:  [[ 8.71953443  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01551966 0.05120178 0.34361623]
Stock Position:  0.015519657468363398
Bond Position:  [-0.2973773]


portfolio before change:  [1.28291148]
curr_Stock_Price:  101.82737335191048
curr_Factors:  [101.82737335  -1.20536818  -1.12448226]
mat_Sqrt:  [[ 9.90885214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01341567  0.01116975  0.08441086]
Stock Position:  -0.013415674638183927
Bond Position:  [2.64899439]


portfolio before change:  [1.28305379]
curr_Stock_Price:  101.84144916487965
curr_Factors:  [101.84144916  -1.04232326  -1.11897294]
mat_Sqrt:  [[11.72966365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00333181 -0.04543145  0.14218319]
Stock Position:  -0.003331814887126345
Bond Position:  [1.62237064]


portfolio before change:  [1.28243803]
curr_Stock_Price:  102.08712994220099
curr_Factors:  [102.08712994  -1.27888035  -1.11953025]
mat_Sqrt:  [[ 9.27586688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00685805 -0.00310403  0.2535551 ]
Stock Position:  0.00685805174355939
Bond Position:  [0.58231921]


portfolio before change:  [1.2814134]
curr_Stock_Price:  101.92710911643901
curr_Factors:  [101.92710912  -1.37063371  -1.11846293]
mat_Sqrt:  [[ 8.45841078  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06033639 -0.03267928  0.66141759]
Stock Position:  0.06033639026850443
Bond Position:  [-4.86850044]


portfolio before change:  [1.22318003]
curr_Stock_Price:  100.97205096472236
curr_Factors:  [100.97205096  -1.27086814  -1.11432385]
mat_Sqrt:  [[ 9.2966281   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00031158 -0.05344372 -0.21209833]
Stock Position:  0.00031158137572888004
Bond Position:  [1.19171902]


portfolio before change:  [1.22322365]
curr_Stock_Price:  100.63389247734031
curr_Factors:  [100.63389248  -1.42499248  -1.14237805]
mat_Sqrt:  [[ 7.72234881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028617  -0.02321455 -0.0028026 ]
Stock Position:  -0.0028616982949206627
Bond Position:  [1.51120748]


portfolio before change:  [1.22433842]
curr_Stock_Price:  100.31035494888886
curr_Factors:  [100.31035495  -1.31011093  -1.16865629]
mat_Sqrt:  [[ 8.41067476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00824016 0.00520193 0.11514439]
Stock Position:  0.008240162886850536
Bond Position:  [0.39776476]


portfolio before change:  [1.22362241]
curr_Stock_Price:  100.21742685495173
curr_Factors:  [100.21742685  -1.44352871  -1.17408486]
mat_Sqrt:  [[ 7.31354804  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416228 -0.00543126 -0.19262923]
Stock Position:  -0.004162280170714558
Bond Position:  [1.64075541]


portfolio before change:  [1.22260763]
curr_Stock_Price:  100.51050804741924
curr_Factors:  [100.51050805  -1.48393598  -1.17062208]
mat_Sqrt:  [[ 7.06889529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00735288  0.0077942  -0.13480476]
Stock Position:  -0.007352879735349427
Bond Position:  [1.9616493]


portfolio before change:  [1.219365]
curr_Stock_Price:  100.98485967866213
curr_Factors:  [100.98485968  -1.49589241  -1.14023454]
mat_Sqrt:  [[ 7.23437269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00647002 -0.01740352  0.07243192]
Stock Position:  -0.006470021136323833
Bond Position:  [1.87273917]


portfolio before change:  [1.22111808]
curr_Stock_Price:  100.7500876481359
curr_Factors:  [100.75008765  -1.47493896  -1.13791267]
mat_Sqrt:  [[ 7.38751525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03808484 0.01206448 0.18166713]
Stock Position:  0.038084835594276605
Bond Position:  [-2.61593244]


portfolio before change:  [1.24495582]
curr_Stock_Price:  101.38458559125864
curr_Factors:  [101.38458559  -1.37872891  -1.15683357]
mat_Sqrt:  [[ 8.03139785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00706672 -0.01070781  0.13457776]
Stock Position:  -0.007066715805100151
Bond Position:  [1.96141188]


portfolio before change:  [1.24083681]
curr_Stock_Price:  102.00215782458818
curr_Factors:  [102.00215782  -1.17129241  -1.18128211]
mat_Sqrt:  [[ 9.70284798  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01285085 -0.01306437 -0.26021905]
Stock Position:  -0.012850848107070713
Bond Position:  [2.55165104]


portfolio before change:  [1.23725716]
curr_Stock_Price:  102.30553293844224
curr_Factors:  [102.30553294  -1.0813004   -1.19190801]
mat_Sqrt:  [[10.53555097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.16504418 0.33128205 0.4182283 ]
Stock Position:  0.16504418350594097
Bond Position:  [-15.647676]


portfolio before change:  [1.09319665]
curr_Stock_Price:  101.44452454026313
curr_Factors:  [101.44452454  -1.22953676  -1.19538682]
mat_Sqrt:  [[ 8.97630664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00579975 -0.05176373 -0.18158149]
Stock Position:  -0.005799752566521113
Bond Position:  [1.68154979]


portfolio before change:  [1.09347751]
curr_Stock_Price:  101.43234198359032
curr_Factors:  [101.43234198  -1.24513181  -1.22002815]
mat_Sqrt:  [[ 8.62126674  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113217 -0.00436771 -0.31807934]
Stock Position:  0.0011321653755805708
Bond Position:  [0.97863932]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.09321894]
Stock Price:  101.09590281848908
PL:  [-0.00268388]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-2.05380702e-02 -9.38775875e-02  1.53311029e-01]
 [ 8.67761169e-01  2.12073411e-01  2.40103738e-01]
 [-2.88778753e-01 -1.79344484e-01  3.82198874e-02]
 [ 1.71451970e-01  1.20141071e+00  1.07902904e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.85345801e-02 -7.01427791e-02  5.87586800e-02]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [-1.61582874e-02  2.34050489e-01 -3.56885175e-02]
 [ 2.08607473e-02  5.79585541e-02 -4.54999460e-02]
 [-1.50823891e-01 -8.10614580e-02 -5.06252762e-02]
 [ 8.93486408e-01  1.71801756e+00 -3.10793446e-01]
 [-2.96808309e-05  6.80389883e-03 -3.89881118e-02]
 [-2.96127691e-01  1.72591636e-03 -6.36657809e-01]
 [ 1.79687740e+00 -3.19596587e+00  2.69147997e+00]
 [ 2.46933162e-02 -8.88674888e-02  3.36210069e-02]
 [ 1.23747395e-01 -9.63959188e-03 -2.82145368e-02]
 [-4.44177398e-02  2.32662993e-02 -7.44009470e-02]
 [-2.78206660e-01 -1.79714317e+00 -1.97422345e-01]
 [ 1.46013469e-02 -4.27686697e-02  1.37497309e-01]
 [ 2.29082302e-02  1.71935652e-01  1.83139928e-01]
 [ 2.34701119e-02  2.99028373e-02 -9.01647655e-03]
 [ 1.17637061e-01 -5.19938052e-02  5.04204575e-02]
 [ 6.07538243e-02 -7.45376940e-02 -5.97470538e-02]
 [-1.63403013e-01  2.12775860e-02  4.91970184e-02]
 [ 8.99352478e-02 -1.61732741e-02 -2.46906875e-02]
 [ 5.50281740e-02 -7.09708390e-03  2.79841756e-01]
 [ 5.01558407e-02 -1.00812465e-01  2.19555385e-02]
 [-7.34131424e-02  4.90612497e-02  1.21457928e-01]
 [-1.06202609e-02 -7.60200217e-02 -5.01204508e-03]
 [ 2.06488353e-01 -5.50706968e-02  8.80215131e-03]
 [-2.42677357e-02 -5.53149544e-02 -3.79170463e-02]
 [-2.54045004e-02  2.18408324e-02 -5.24983103e-02]
 [-1.02079714e-01 -3.80124850e-02  3.01976096e-02]
 [ 2.51204228e-01  2.42599865e-02  5.29451724e-02]
 [ 9.93579457e-02 -4.02993045e-02 -1.15635389e-02]
 [-9.81398905e-02 -3.36044051e-02 -1.04193944e-01]
 [ 1.67496288e+00  1.16645204e+00  1.59321020e-01]
 [-7.34566852e-02 -4.15746731e-02 -2.86453368e-02]
 [ 3.74862703e-02 -1.28921718e-02 -1.61655560e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.29803115]
curr_Stock_Price:  99.49430024909844
curr_Factors:  [99.49430025 -0.92098082 -0.9965241 ]
mat_Sqrt:  [[14.62299716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057487 -0.03029886  0.43735369]
Stock Position:  -0.0005748663961596244
Bond Position:  [-1.24083522]


portfolio before change:  [-1.29832802]
curr_Stock_Price:  99.74088770406117
curr_Factors:  [99.7408877  -0.95345732 -1.00668835]
mat_Sqrt:  [[14.04729759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06834492 0.0684464  0.68494913]
Stock Position:  0.06834492095949596
Bond Position:  [-8.11511111]


portfolio before change:  [-1.3053096]
curr_Stock_Price:  99.65357877137471
curr_Factors:  [99.65357877 -1.03786278 -1.01519362]
mat_Sqrt:  [[12.78974346  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02483128 -0.05788318  0.1090307 ]
Stock Position:  -0.024831279184902848
Bond Position:  [1.16921624]


portfolio before change:  [-1.31300163]
curr_Stock_Price:  99.96923690046785
curr_Factors:  [99.9692369  -0.88819102 -1.00025538]
mat_Sqrt:  [[15.12601501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04210923 0.38775364 3.0781695 ]
Stock Position:  0.04210922600927811
Bond Position:  [-5.52262882]


portfolio before change:  [-1.25952268]
curr_Stock_Price:  101.25563731971899
curr_Factors:  [101.25563732  -1.03486718  -0.98844763]
mat_Sqrt:  [[13.38766249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0043806  -0.01106097 -0.05874131]
Stock Position:  -0.004380600496564314
Bond Position:  [-0.81596218]


portfolio before change:  [-1.26031178]
curr_Stock_Price:  101.4124891306702
curr_Factors:  [101.41248913  -1.17624839  -0.97633108]
mat_Sqrt:  [[11.78251649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00561941 -0.02263848  0.16762216]
Stock Position:  0.005619411667005552
Bond Position:  [-1.83019031]


portfolio before change:  [-1.26454628]
curr_Stock_Price:  100.69965520540865
curr_Factors:  [100.69965521  -1.04763281  -0.97677161]
mat_Sqrt:  [[13.29965319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00498436 -0.00251018 -0.21167328]
Stock Position:  -0.004984364778503832
Bond Position:  [-0.76262247]


portfolio before change:  [-1.26261252]
curr_Stock_Price:  100.2925636479578
curr_Factors:  [100.29256365  -0.93309483  -0.96636559]
mat_Sqrt:  [[15.00871653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016212   0.07553947 -0.10180941]
Stock Position:  0.0016212032849779452
Bond Position:  [-1.42520715]


portfolio before change:  [-1.26146542]
curr_Stock_Price:  101.11001684666833
curr_Factors:  [101.11001685  -0.83486939  -0.97340163]
mat_Sqrt:  [[16.57570682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141194  0.01870604 -0.12979868]
Stock Position:  0.0014119367729264222
Bond Position:  [-1.40422638]


portfolio before change:  [-1.26160183]
curr_Stock_Price:  101.13773524282047
curr_Factors:  [101.13773524  -0.83868176  -0.98791292]
mat_Sqrt:  [[16.27920644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01091603 -0.02616247 -0.14441982]
Stock Position:  -0.01091603165195013
Bond Position:  [-0.15757911]


portfolio before change:  [-1.24757882]
curr_Stock_Price:  99.85130533409772
curr_Factors:  [99.85130533 -0.92154722 -0.98270977]
mat_Sqrt:  [[14.8711805   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07939752  0.55448778 -0.88660719]
Stock Position:  0.07939751843785636
Bond Position:  [-9.17552467]


portfolio before change:  [-1.2123535]
curr_Stock_Price:  100.30940942449722
curr_Factors:  [100.30940942  -0.89498622  -0.97850085]
mat_Sqrt:  [[15.40623709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042835  0.00219595 -0.11122223]
Stock Position:  -0.0004283496188357327
Bond Position:  [-1.169386]


portfolio before change:  [-1.21224693]
curr_Stock_Price:  99.71934217234455
curr_Factors:  [99.71934217 -0.75771332 -0.98524639]
mat_Sqrt:  [[17.45105224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.43958138e-02  5.57037110e-04 -1.81620752e+00]
Stock Position:  -0.02439581381513628
Bond Position:  [1.22048758]


portfolio before change:  [-1.21645114]
curr_Stock_Price:  99.89792957776432
curr_Factors:  [99.89792958 -0.91567799 -0.99687208]
mat_Sqrt:  [[14.75524923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.1147998  -1.03149355  7.67804319]
Stock Position:  0.11479979880780207
Bond Position:  [-12.68471336]


portfolio before change:  [-1.26677874]
curr_Stock_Price:  99.47334771360471
curr_Factors:  [99.47334771 -0.99905325 -1.00523777]
mat_Sqrt:  [[13.40461059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00100086 -0.02868186  0.09591137]
Stock Position:  0.0010008627403561455
Bond Position:  [-1.36633791]


portfolio before change:  [-1.26611078]
curr_Stock_Price:  100.31138782235136
curr_Factors:  [100.31138782  -1.16467493  -1.04259432]
mat_Sqrt:  [[11.03431511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01051451 -0.00311116 -0.08048822]
Stock Position:  0.010514513302937812
Bond Position:  [-2.32083621]


portfolio before change:  [-1.27408692]
curr_Stock_Price:  99.58039721992928
curr_Factors:  [99.58039722 -1.15852728 -1.06639881]
mat_Sqrt:  [[10.76219191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00509706  0.00750917 -0.21224519]
Stock Position:  -0.00509706168165781
Bond Position:  [-0.76651949]


portfolio before change:  [-1.27385325]
curr_Stock_Price:  99.51575367117516
curr_Factors:  [99.51575367 -1.24899484 -1.07011333]
mat_Sqrt:  [[ 9.78849566  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07001542 -0.58002546 -0.563191  ]
Stock Position:  -0.07001542050684306
Bond Position:  [5.6937841]


portfolio before change:  [-1.21219087]
curr_Stock_Price:  98.6452224306146
curr_Factors:  [98.64522243 -0.79496922 -1.07998085]
mat_Sqrt:  [[15.12849016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0022433  -0.01380353  0.39224155]
Stock Position:  0.002243300488498845
Bond Position:  [-1.43348174]


portfolio before change:  [-1.21509732]
curr_Stock_Price:  97.42948807239306
curr_Factors:  [97.42948807 -0.50074442 -1.0843558 ]
mat_Sqrt:  [[19.96595745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00477752 0.05549199 0.52244724]
Stock Position:  0.004777518417411214
Bond Position:  [-1.68056849]


portfolio before change:  [-1.21877433]
curr_Stock_Price:  96.70381359818434
curr_Factors:  [96.7038136  -0.44920326 -1.08272131]
mat_Sqrt:  [[20.89956335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00132699  0.0096511  -0.0257215 ]
Stock Position:  0.0013269905193551723
Bond Position:  [-1.34709937]


portfolio before change:  [-1.21909217]
curr_Stock_Price:  96.59119510845387
curr_Factors:  [96.59119511 -0.56614028 -1.10098352]
mat_Sqrt:  [[18.23538226  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00643342 -0.01678093  0.14383553]
Stock Position:  0.006433421645844488
Bond Position:  [-1.84050406]


portfolio before change:  [-1.21956082]
curr_Stock_Price:  96.55411162783449
curr_Factors:  [96.55411163 -0.5541057  -1.06036891]
mat_Sqrt:  [[19.21380405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00173537 -0.02405694 -0.17044171]
Stock Position:  0.0017353703013159392
Bond Position:  [-1.38711796]


portfolio before change:  [-1.22075033]
curr_Stock_Price:  95.96858105988981
curr_Factors:  [95.96858106 -0.42467991 -1.058067  ]
mat_Sqrt:  [[21.78613907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00684001  0.00686731  0.1403454 ]
Stock Position:  -0.0068400116473094534
Bond Position:  [-0.56432412]


portfolio before change:  [-1.22107573]
curr_Stock_Price:  96.00583974231303
curr_Factors:  [96.00583974 -0.15077551 -1.06625017]
mat_Sqrt:  [[28.42824931  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00287017 -0.0052199  -0.07043566]
Stock Position:  0.0028701706420509133
Bond Position:  [-1.49662887]


portfolio before change:  [-1.21232155]
curr_Stock_Price:  99.1210794856674
curr_Factors:  [99.12107949 -0.12213801 -1.06831063]
mat_Sqrt:  [[30.14121452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00367278 -0.00229057  0.79831064]
Stock Position:  0.00367277658599728
Bond Position:  [-1.57637113]


portfolio before change:  [-1.20795784]
curr_Stock_Price:  100.36285615091968
curr_Factors:  [100.36285615  -0.38510759  -1.07717452]
mat_Sqrt:  [[23.25476532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146461 -0.03253708  0.06263304]
Stock Position:  0.001464613271179634
Bond Position:  [-1.35495061]


portfolio before change:  [-1.20543705]
curr_Stock_Price:  102.19963383337588
curr_Factors:  [102.19963383  -0.29608824  -1.11005494]
mat_Sqrt:  [[25.04777277  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0015413   0.01583445  0.34648566]
Stock Position:  -0.0015412971593600118
Bond Position:  [-1.04791704]


portfolio before change:  [-1.20707174]
curr_Stock_Price:  103.17523359172966
curr_Factors:  [103.17523359  -0.42235503  -1.13870464]
mat_Sqrt:  [[21.65787593  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125409 -0.02453536 -0.01429797]
Stock Position:  -0.0012540870766474309
Bond Position:  [-1.07768101]


portfolio before change:  [-1.20937801]
curr_Stock_Price:  104.90681831353392
curr_Factors:  [104.90681831  -0.57834468  -1.1439765 ]
mat_Sqrt:  [[18.74170635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01051365 -0.01777399  0.02511009]
Stock Position:  0.010513654534272145
Bond Position:  [-2.31233206]


portfolio before change:  [-1.22712806]
curr_Stock_Price:  103.24602682895481
curr_Factors:  [103.24602683  -0.42415416  -1.1276318 ]
mat_Sqrt:  [[21.87465786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019794  -0.01785282 -0.10816678]
Stock Position:  -0.0019793972738275352
Bond Position:  [-1.02276316]


portfolio before change:  [-1.22405183]
curr_Stock_Price:  101.62730922389946
curr_Factors:  [101.62730922  -0.74124504  -1.11022772]
mat_Sqrt:  [[15.95607328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198435  0.0070491  -0.14976307]
Stock Position:  -0.001984349865619829
Bond Position:  [-1.02238769]


portfolio before change:  [-1.2228834]
curr_Stock_Price:  100.97407798394794
curr_Factors:  [100.97407798  -0.59815858  -1.13734632]
mat_Sqrt:  [[17.80285676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0058235  -0.01226848  0.08614537]
Stock Position:  -0.005823499040393452
Bond Position:  [-0.63486095]


portfolio before change:  [-1.22852336]
curr_Stock_Price:  101.92893400002737
curr_Factors:  [101.928934    -0.45242582  -1.11377737]
mat_Sqrt:  [[21.28649131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01254146 0.00782988 0.15103784]
Stock Position:  0.012541459326189339
Bond Position:  [-2.50686094]


portfolio before change:  [-1.23222897]
curr_Stock_Price:  101.65845228093842
curr_Factors:  [101.65845228  -0.46207733  -1.12054275]
mat_Sqrt:  [[20.88431935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00425063 -0.01300654 -0.03298756]
Stock Position:  0.0042506286940248
Bond Position:  [-1.66434131]


portfolio before change:  [-1.22880477]
curr_Stock_Price:  102.51297508229632
curr_Factors:  [102.51297508  -0.64102299  -1.10944136]
mat_Sqrt:  [[17.8058138   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00709138 -0.01084578 -0.29723632]
Stock Position:  -0.007091383872818563
Bond Position:  [-0.50184591]


portfolio before change:  [-1.23294559]
curr_Stock_Price:  103.08805148457067
curr_Factors:  [103.08805148  -0.50682917  -1.14432369]
mat_Sqrt:  [[19.7752396   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09838491 0.37647078 0.45449852]
Stock Position:  0.09838491003790899
Bond Position:  [-11.37525426]


portfolio before change:  [-1.15581818]
curr_Stock_Price:  103.88644030612575
curr_Factors:  [103.88644031  -0.70923618  -1.14307892]
mat_Sqrt:  [[16.29703644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00538689 -0.01341817 -0.08171717]
Stock Position:  -0.005386886446673254
Bond Position:  [-0.59619372]


portfolio before change:  [-1.16098368]
curr_Stock_Price:  104.83150876241028
curr_Factors:  [104.83150876  -0.81945045  -1.1706229 ]
mat_Sqrt:  [[14.32893663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.29588389e-04 -4.16093056e-03 -4.61158316e-01]
Stock Position:  0.0001295883885622682
Bond Position:  [-1.17456863]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.1611068]
Stock Price:  105.01446145750941
PL:  [-6.17556826]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 4.21511933e-03 -1.06492191e-01  3.31178096e-02]
 [ 6.65393878e-01  2.05211647e-01  1.88657084e-01]
 [-4.33264644e-01 -3.12340764e-01  4.24343349e-02]
 [ 2.91150082e-01  1.82406333e+00  1.79923882e+00]
 [-5.15178508e-02 -1.26635208e-02  1.25149165e-02]
 [-5.19583203e-02  4.43915155e-01 -2.22683198e-01]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [-2.33016789e-02  3.94711210e-02  3.49323152e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 9.15505358e-01  1.87513614e+00 -2.89398071e-01]
 [-1.96534274e-03 -1.64514021e-01  2.89855954e-01]
 [-4.95914013e-01 -1.47258895e-02 -1.04438889e+00]
 [ 1.91850128e+00 -2.86515511e+00  2.43235778e+00]
 [ 2.34476849e-02 -8.29739616e-02  2.41768196e-02]
 [ 8.95441746e-02  1.03846445e-01 -8.25539611e-02]
 [-1.51909704e-02  1.63081007e-01 -7.77767581e-02]
 [-2.91755861e-01 -1.87171506e+00 -1.96487528e-01]
 [ 2.05763013e-02 -1.95825574e-02  1.95135316e-02]
 [-5.34487809e-02  1.68762360e-01  8.10343366e-02]
 [ 2.69394787e-02 -9.21477507e-03  1.94702412e-02]
 [ 1.13780133e-01 -5.08183293e-02  2.15159983e-03]
 [ 4.20087278e-01  1.00239899e-01  1.97417363e-01]
 [-1.32654583e-01 -1.10783850e-03  5.82550634e-02]
 [-1.53563248e-02 -1.86030638e-01  5.86350468e-02]
 [ 7.16602467e-02 -1.25811769e-02  7.32306856e-02]
 [ 1.59999028e-01 -6.85846444e-02  6.62946050e-02]
 [-7.71522123e-02  4.60592280e-02  1.25509116e-01]
 [-9.29093515e-03 -7.47313748e-02 -2.78056142e-03]
 [ 2.29159320e-01 -6.35416293e-02 -5.42212814e-03]
 [-1.79074791e-02 -5.66065429e-02 -3.88514131e-02]
 [ 5.99005603e-02  1.48854696e-02 -6.15772836e-02]
 [-3.46408038e-02 -5.94550450e-02  1.00091006e-02]
 [ 4.11726215e-01  4.81582747e-02  8.37683057e-02]
 [-1.66542545e-02  1.42445579e-02 -2.15169306e-03]
 [-9.85347140e-02 -3.43287680e-02 -1.03528526e-01]
 [ 2.27573349e+00  1.51416071e+00  1.77211751e-01]
 [-6.11894146e-02 -7.75708289e-02 -3.61659401e-02]
 [ 3.55069103e-02 -1.33552038e-02 -1.15951798e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.70950611]
curr_Stock_Price:  99.43814971912124
curr_Factors:  [99.43814972 -1.05390884 -0.99337274]
mat_Sqrt:  [[12.83600694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083845 -0.03437021  0.09447589]
Stock Position:  -0.0008384510507776218
Bond Position:  [-1.62613208]


portfolio before change:  [-1.7093]
curr_Stock_Price:  98.94988314650563
curr_Factors:  [98.94988315 -1.20597121 -0.97371239]
mat_Sqrt:  [[11.18898589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06665412 0.06623177 0.53818615]
Stock Position:  0.0666541188602854
Bond Position:  [-8.30471727]


portfolio before change:  [-1.74849313]
curr_Stock_Price:  98.3774506806895
curr_Factors:  [98.37745068 -1.10362798 -0.98843438]
mat_Sqrt:  [[12.14295618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04021748 -0.10080755  0.12105335]
Stock Position:  -0.040217477182494896
Bond Position:  [2.20799974]


portfolio before change:  [-1.71243211]
curr_Stock_Price:  97.48766318524926
curr_Factors:  [97.48766319 -0.82316233 -0.98822502]
mat_Sqrt:  [[15.93214067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06469649 0.58871391 5.13272755]
Stock Position:  0.06469648729674933
Bond Position:  [-8.01954147]


portfolio before change:  [-1.706287]
curr_Stock_Price:  97.59814227745355
curr_Factors:  [97.59814228 -0.63286705 -0.98842482]
mat_Sqrt:  [[19.2896095   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267233 -0.00408713  0.03570157]
Stock Position:  -0.0026723290836369257
Bond Position:  [-1.44547265]


portfolio before change:  [-1.70893]
curr_Stock_Price:  98.51954661134266
curr_Factors:  [98.51954661 -0.20362306 -1.01234638]
mat_Sqrt:  [[29.2034114   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.32833633e-04  1.43273000e-01 -6.35253182e-01]
Stock Position:  -0.00023283363342634965
Bond Position:  [-1.68599133]


portfolio before change:  [-1.70922424]
curr_Stock_Price:  98.87807797137548
curr_Factors:  [98.87807797 -0.23892813 -1.02513969]
mat_Sqrt:  [[27.93330587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237316 -0.00251018 -0.21167328]
Stock Position:  -0.002373164251699569
Bond Position:  [-1.47457032]


portfolio before change:  [-1.7054908]
curr_Stock_Price:  97.22721503053793
curr_Factors:  [97.22721503 -0.33156582 -1.01015587]
mat_Sqrt:  [[25.41473119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031927  0.01273925  0.09965217]
Stock Position:  -0.00031926920914205834
Bond Position:  [-1.67444914]


portfolio before change:  [-1.70561585]
curr_Stock_Price:  96.9632758774771
curr_Factors:  [96.96327588 -0.47401396 -1.02231635]
mat_Sqrt:  [[21.71497238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239426  0.0064198  -0.11330016]
Stock Position:  0.0023942560198168665
Bond Position:  [-1.93777076]


portfolio before change:  [-1.70634209]
curr_Stock_Price:  96.76112574220758
curr_Factors:  [96.76112574 -0.26412566 -1.02981667]
mat_Sqrt:  [[26.53071166  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.29455635e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  3.2945563548556525e-05
Bond Position:  [-1.70952994]


portfolio before change:  [-1.70653165]
curr_Stock_Price:  97.4938693363302
curr_Factors:  [97.49386934 -0.16061299 -1.04012261]
mat_Sqrt:  [[29.34299659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0422313   0.60519759 -0.82557214]
Stock Position:  0.04223129639232694
Bond Position:  [-5.82382414]


portfolio before change:  [-1.69100467]
curr_Stock_Price:  97.87877349925313
curr_Factors:  [ 9.78787735e+01 -7.85994661e-02 -1.04535117e+00]
mat_Sqrt:  [[31.80994796  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.42534131e-04 -5.30966720e-02  8.26878355e-01]
Stock Position:  0.0007425341308465493
Bond Position:  [-1.763683]


portfolio before change:  [-1.6919634]
curr_Stock_Price:  96.88453488024992
curr_Factors:  [96.88453488 -0.15173617 -1.04499246]
mat_Sqrt:  [[29.27667939  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02432328 -0.00475276 -2.97935079]
Stock Position:  -0.024323281400546348
Bond Position:  [0.6645864]


portfolio before change:  [-1.70002432]
curr_Stock_Price:  97.21935776656011
curr_Factors:  [97.21935777 -0.30704885 -1.04553396]
mat_Sqrt:  [[25.13816073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07280393 -0.92472483  6.93883972]
Stock Position:  0.07280393029914042
Bond Position:  [-8.77797566]


portfolio before change:  [-1.67126642]
curr_Stock_Price:  97.62943464976924
curr_Factors:  [97.62943465 -0.40864546 -1.0643679 ]
mat_Sqrt:  [[22.37995456  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00051143 -0.02677973  0.06896974]
Stock Position:  0.0005114294793982835
Bond Position:  [-1.72119699]


portfolio before change:  [-1.67099119]
curr_Stock_Price:  98.58830975687573
curr_Factors:  [98.58830976 -0.42911272 -1.06090042]
mat_Sqrt:  [[22.21881734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00422572  0.0335163  -0.23550347]
Stock Position:  0.004225719276077307
Bond Position:  [-2.08759771]


portfolio before change:  [-1.67117613]
curr_Stock_Price:  98.60629945624233
curr_Factors:  [98.60629946 -0.52153136 -1.06377199]
mat_Sqrt:  [[20.20301397  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.09968073e-04  5.26341687e-02 -2.21875442e-01]
Stock Position:  0.00010996807251695498
Bond Position:  [-1.68201968]


portfolio before change:  [-1.67154767]
curr_Stock_Price:  97.13978957401444
curr_Factors:  [97.13978957 -0.70089636 -1.03378878]
mat_Sqrt:  [[17.14087461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0416505  -0.60409344 -0.56052423]
Stock Position:  -0.041650497061180604
Bond Position:  [2.37437285]


portfolio before change:  [-1.69985467]
curr_Stock_Price:  97.8265476676929
curr_Factors:  [97.82654767 -0.55385853 -1.0241449 ]
mat_Sqrt:  [[20.19010353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00101843 -0.00632024  0.05566667]
Stock Position:  0.0010184302168507757
Bond Position:  [-1.79948418]


portfolio before change:  [-1.70110179]
curr_Stock_Price:  96.82287155292596
curr_Factors:  [96.82287155 -0.31166675 -1.01954139]
mat_Sqrt:  [[25.57652915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.61523659e-05  5.44678174e-02  2.31168407e-01]
Stock Position:  -9.615236592593835e-05
Bond Position:  [-1.69179205]


portfolio before change:  [-1.70141446]
curr_Stock_Price:  97.8751617728425
curr_Factors:  [97.87516177 -0.37415358 -1.00261419]
mat_Sqrt:  [[24.70300839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117528 -0.00297406  0.05554318]
Stock Position:  0.0011752765704246488
Bond Position:  [-1.81644485]


portfolio before change:  [-1.69879664]
curr_Stock_Price:  100.2957753507679
curr_Factors:  [100.29577535  -0.28913412  -1.01268366]
mat_Sqrt:  [[27.28414583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0038061  -0.01640155  0.00613792]
Stock Position:  0.0038060960143820742
Bond Position:  [-2.08053199]


portfolio before change:  [-1.69619482]
curr_Stock_Price:  101.04770129318885
curr_Factors:  [101.04770129  -0.25099413  -1.01807557]
mat_Sqrt:  [[28.40380173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01692894 0.03235229 0.56317679]
Stock Position:  0.01692894200486065
Bond Position:  [-3.4068255]


portfolio before change:  [-1.70718526]
curr_Stock_Price:  100.42364827922138
curr_Factors:  [ 1.00423648e+02  1.40490075e-02 -1.00711520e+00]
mat_Sqrt:  [[37.20084708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325233 -0.00035755  0.16618548]
Stock Position:  -0.0032523306416758096
Bond Position:  [-1.38057435]


portfolio before change:  [-1.71002495]
curr_Stock_Price:  101.24371023725988
curr_Factors:  [101.24371024  -0.39231313  -0.96010298]
mat_Sqrt:  [[26.18310809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00157968 -0.06004113  0.16726947]
Stock Position:  -0.0015796765127719253
Bond Position:  [-1.55009264]


portfolio before change:  [-1.71113495]
curr_Stock_Price:  101.82371504402576
curr_Factors:  [101.82371504  -0.28657892  -0.96264497]
mat_Sqrt:  [[29.19563303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00287852 -0.00406056  0.20890676]
Stock Position:  0.002878522131314252
Bond Position:  [-2.00423676]


portfolio before change:  [-1.71233248]
curr_Stock_Price:  101.49472937418867
curr_Factors:  [101.49472937  -0.40776229  -0.97499015]
mat_Sqrt:  [[25.46371318  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00626506 -0.0221356   0.18912006]
Stock Position:  0.006265055464093803
Bond Position:  [-2.34820259]


portfolio before change:  [-1.71280119]
curr_Stock_Price:  101.46677063724982
curr_Factors:  [101.46677064  -0.34806637  -0.97975974]
mat_Sqrt:  [[26.89405494  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156655  0.01486555  0.35804257]
Stock Position:  -0.001566553313053574
Bond Position:  [-1.55384809]


portfolio before change:  [-1.71517553]
curr_Stock_Price:  102.85842432069157
curr_Factors:  [102.85842432  -0.56184418  -0.9936134 ]
mat_Sqrt:  [[21.71266952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00115661 -0.02411945 -0.00793217]
Stock Position:  -0.0011566054953515432
Bond Position:  [-1.59620892]


portfolio before change:  [-1.71814878]
curr_Stock_Price:  105.256569071165
curr_Factors:  [105.25656907  -0.60027364  -0.97726663]
mat_Sqrt:  [[21.73362533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00989629 -0.02050797 -0.01546782]
Stock Position:  0.009896285070422043
Bond Position:  [-2.75979779]


portfolio before change:  [-1.74005271]
curr_Stock_Price:  103.078081847067
curr_Factors:  [103.07808185  -0.57836628  -0.94157065]
mat_Sqrt:  [[22.54582364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165852 -0.01826968 -0.11083227]
Stock Position:  -0.0016585223686404907
Bond Position:  [-1.5690954]


portfolio before change:  [-1.74290958]
curr_Stock_Price:  104.68235344597696
curr_Factors:  [104.68235345  -0.65382695  -0.95741999]
mat_Sqrt:  [[20.89863027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00241019  0.00480426 -0.17566285]
Stock Position:  0.0024101882764271925
Bond Position:  [-1.99521376]


portfolio before change:  [-1.74087292]
curr_Stock_Price:  105.63085860491519
curr_Factors:  [105.6308586   -0.65439154  -0.9740213 ]
mat_Sqrt:  [[20.72908354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215803 -0.01918903  0.02855318]
Stock Position:  -0.002158026660494874
Bond Position:  [-1.51291871]


portfolio before change:  [-1.7378343]
curr_Stock_Price:  104.13516567967197
curr_Factors:  [104.13516568  -0.63303204  -0.95247261]
mat_Sqrt:  [[21.33150485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02056374 0.01554302 0.23896766]
Stock Position:  0.02056374448699002
Bond Position:  [-3.87924324]


portfolio before change:  [-1.77422467]
curr_Stock_Price:  102.38911046160008
curr_Factors:  [102.38911046  -0.83242789  -0.96696833]
mat_Sqrt:  [[16.93502805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083766  0.00459741 -0.00613818]
Stock Position:  -0.00083766078161625
Bond Position:  [-1.68845733]


portfolio before change:  [-1.77477469]
curr_Stock_Price:  102.79375389215154
curr_Factors:  [102.79375389  -1.19583897  -0.98343264]
mat_Sqrt:  [[11.62843017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01089354 -0.01107956 -0.29533807]
Stock Position:  -0.010893535448721575
Bond Position:  [-0.65498729]


portfolio before change:  [-1.7756634]
curr_Stock_Price:  102.86781846432864
curr_Factors:  [102.86781846  -1.33626102  -0.98740966]
mat_Sqrt:  [[10.07214971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.26022086 0.48869327 0.5055358 ]
Stock Position:  0.2602208586518673
Bond Position:  [-28.54401544]


portfolio before change:  [-1.64605413]
curr_Stock_Price:  103.37960483176647
curr_Factors:  [103.37960483  -1.47000765  -1.00398659]
mat_Sqrt:  [[ 8.709492    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00969125 -0.02503588 -0.10317136]
Stock Position:  -0.009691246662802666
Bond Position:  [-0.64417688]


portfolio before change:  [-1.6414842]
curr_Stock_Price:  102.89974260779007
curr_Factors:  [102.89974261  -1.19449344  -1.03025035]
mat_Sqrt:  [[11.12295898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00081923 -0.00431037 -0.3307782 ]
Stock Position:  0.000819227082175497
Bond Position:  [-1.72578245]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.64206084]
Stock Price:  102.45919713812147
PL:  [-4.10125798]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.20889013e-01 -6.63640001e-03 -1.80044343e-02]
 [ 1.83654273e+00  4.72321850e-01  6.79563598e-01]
 [ 1.29690584e-01  2.39773832e-01  4.29973334e-02]
 [ 9.00849617e-03 -8.05899080e-02  2.35683368e-02]
 [-5.03886471e-02 -6.34528339e-02 -4.74397047e-02]
 [ 7.29913314e-02  1.57376049e-01 -7.20444822e-02]
 [-3.21888650e-02 -1.19266517e-01  2.13006366e-03]
 [ 1.37450490e-01  1.04815900e-01 -1.21899565e-01]
 [ 3.22277265e-02  4.56576455e-02 -4.36311235e-02]
 [-2.05159927e-01 -7.05792195e-02 -7.56631537e-02]
 [ 6.97648805e-01  1.36584432e+00 -2.37743355e-01]
 [-8.45229252e-04 -1.12259469e-02  8.68268398e-02]
 [-4.02211696e-01  9.92986930e-05 -8.91006594e-01]
 [ 1.88695626e+00 -2.86086101e+00  2.42612445e+00]
 [ 2.23133795e-02 -8.91780491e-02  3.38995532e-02]
 [ 8.63805208e-02  1.07093411e-01 -8.31293489e-02]
 [ 3.19935734e-02 -1.03930926e-01  1.80793345e-02]
 [-2.96662539e-01 -1.89718512e+00 -1.95594418e-01]
 [ 2.98694756e-02 -5.07061608e-02  1.07728919e-02]
 [ 3.06420510e-02  7.60388303e-02  1.04522912e-01]
 [ 2.14113725e-02  5.31154210e-02 -2.59206350e-02]
 [ 4.41300094e-02 -3.93376729e-02 -1.18160876e-02]
 [-2.08543755e-02 -1.03601426e-01 -1.02271696e-01]
 [-1.41627057e-01  5.42428811e-03  5.56119017e-02]
 [ 9.07937340e-02 -5.82695548e-03 -2.66298917e-02]
 [ 5.25853934e-02 -4.11879939e-02  2.95996435e-01]
 [-1.28102520e-02 -1.15082880e-01 -7.26298857e-04]
 [-7.56652668e-02  4.72530657e-02  1.23898048e-01]
 [-8.45909892e-03 -7.39249938e-02 -1.38419269e-03]
 [ 1.42948927e-01 -1.71790390e-02  3.06135810e-02]
 [-2.19000566e-02 -7.72976110e-02 -2.58086927e-02]
 [ 3.62931597e-02  2.65748514e-03 -3.67005458e-02]
 [-3.45910800e-02 -6.17596194e-02  1.20216346e-02]
 [ 4.93138016e-01  7.25783762e-02  1.27554896e-01]
 [ 2.06985655e-02  2.16158346e-01 -1.04856062e-01]
 [ 1.45714603e-02  2.99686066e-02  6.30021642e-02]
 [ 2.86583846e+00  1.93378619e+00  2.10010509e-01]
 [-6.59417815e-02 -5.26176012e-02 -2.82062311e-02]
 [ 3.59113383e-02 -1.30652391e-02 -1.27922750e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.60310341]
curr_Stock_Price:  101.11834810766199
curr_Factors:  [101.11834811  -1.04330485  -0.99097729]
mat_Sqrt:  [[13.22368387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00876149 -0.00214189 -0.05136164]
Stock Position:  0.008761493798054175
Bond Position:  [9.71715563]


portfolio before change:  [10.61434633]
curr_Stock_Price:  102.26292407815538
curr_Factors:  [102.26292408  -0.95005162  -0.99349439]
mat_Sqrt:  [[14.64356769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.14147306 0.15244122 1.93860579]
Stock Position:  0.14147306242049734
Bond Position:  [-3.85310271]


portfolio before change:  [10.63201485]
curr_Stock_Price:  102.39121838064098
curr_Factors:  [102.39121838  -0.89679856  -0.9908988 ]
mat_Sqrt:  [[15.50408591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01208785 0.07738667 0.12265942]
Stock Position:  0.012087846241036716
Bond Position:  [9.39432554]


portfolio before change:  [10.64835364]
curr_Stock_Price:  103.64573682939351
curr_Factors:  [103.64573683  -0.71798525  -0.99078386]
mat_Sqrt:  [[18.76905671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00014018 -0.02601028  0.0672339 ]
Stock Position:  -0.00014017664069786636
Bond Position:  [10.66288235]


portfolio before change:  [10.64958779]
curr_Stock_Price:  104.35051016155244
curr_Factors:  [104.35051016  -0.54968679  -1.00657473]
mat_Sqrt:  [[22.00993631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033178  -0.02047931 -0.13533227]
Stock Position:  -0.0033177965930421805
Bond Position:  [10.99580156]


portfolio before change:  [10.65308995]
curr_Stock_Price:  103.70924083589286
curr_Factors:  [103.70924084  -0.56321851  -1.01731546]
mat_Sqrt:  [[21.35011779  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00423462  0.0507929  -0.20552285]
Stock Position:  0.0042346166662247855
Bond Position:  [10.21392107]


portfolio before change:  [10.65361776]
curr_Stock_Price:  103.53236337618617
curr_Factors:  [103.53236338  -0.74264969  -1.01473739]
mat_Sqrt:  [[17.85881399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314126 -0.0384931   0.00607648]
Stock Position:  -0.003141263663366483
Bond Position:  [10.97884021]


portfolio before change:  [10.65693017]
curr_Stock_Price:  102.91478924662654
curr_Factors:  [102.91478925  -0.70312092  -1.01100625]
mat_Sqrt:  [[18.53710105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00722677  0.03382919 -0.34774553]
Stock Position:  0.00722676654230563
Bond Position:  [9.91318901]


portfolio before change:  [10.6412702]
curr_Stock_Price:  100.57637180608909
curr_Factors:  [100.57637181  -0.55523796  -0.97455446]
mat_Sqrt:  [[21.78289304  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149849  0.01473594 -0.12446745]
Stock Position:  0.001498487300540991
Bond Position:  [10.49055778]


portfolio before change:  [10.64509347]
curr_Stock_Price:  102.2526417623642
curr_Factors:  [102.25264176  -0.58695422  -0.98979784]
mat_Sqrt:  [[21.13001545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01112217 -0.02277935 -0.21584592]
Stock Position:  -0.011122165362472465
Bond Position:  [11.78236426]


portfolio before change:  [10.63911318]
curr_Stock_Price:  102.92276034368642
curr_Factors:  [102.92276034  -0.43017788  -0.98417891]
mat_Sqrt:  [[25.01866162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03708917  0.44082436 -0.67821562]
Stock Position:  0.0370891722750071
Bond Position:  [6.82179319]


portfolio before change:  [10.51148567]
curr_Stock_Price:  99.45866865136475
curr_Factors:  [99.45866865 -0.46163051 -0.98181378]
mat_Sqrt:  [[23.4834959   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00062115 -0.00362316  0.24769281]
Stock Position:  0.0006211485060561844
Bond Position:  [10.44970706]


portfolio before change:  [10.5120447]
curr_Stock_Price:  98.25563567403688
curr_Factors:  [98.25563567 -0.4229951  -0.98076799]
mat_Sqrt:  [[24.13853496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.41964720e-02  3.20485154e-05 -2.54179380e+00]
Stock Position:  -0.0241964720189517
Bond Position:  [12.88948444]


portfolio before change:  [10.53248334]
curr_Stock_Price:  97.47753255286601
curr_Factors:  [97.47753255 -0.31689825 -0.95404167]
mat_Sqrt:  [[27.34905563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06575057 -0.92333892  6.92105775]
Stock Position:  0.06575057111724773
Bond Position:  [4.1232799]


portfolio before change:  [10.53914781]
curr_Stock_Price:  97.57105312067868
curr_Factors:  [97.57105312 -0.1255027  -0.92714509]
mat_Sqrt:  [[34.05350882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00032389 -0.02878209  0.09670599]
Stock Position:  0.0003238933135812175
Bond Position:  [10.5075452]


portfolio before change:  [10.540825]
curr_Stock_Price:  98.69384238639037
curr_Factors:  [98.69384239 -0.18275887 -0.92111899]
mat_Sqrt:  [[32.72517643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00278905  0.03456425 -0.23714489]
Stock Position:  0.0027890503445116184
Bond Position:  [10.2655629]


portfolio before change:  [10.53276682]
curr_Stock_Price:  95.34451149562418
curr_Factors:  [95.3445115  -0.15400499 -0.90956563]
mat_Sqrt:  [[32.91492313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00043959 -0.03354356  0.05157531]
Stock Position:  0.0004395936323685563
Bond Position:  [10.49085398]


portfolio before change:  [10.5344251]
curr_Stock_Price:  96.13351383685588
curr_Factors:  [96.13351384 -0.27193364 -0.91565436]
mat_Sqrt:  [[29.31648521  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02469086 -0.61231386 -0.55797643]
Stock Position:  -0.024690864818364786
Bond Position:  [12.9080447]


portfolio before change:  [10.52746256]
curr_Stock_Price:  96.48085464135885
curr_Factors:  [96.48085464 -0.11790445 -0.86421419]
mat_Sqrt:  [[36.13370034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060105 -0.01636534  0.03073206]
Stock Position:  0.0006010491885634036
Bond Position:  [10.46947282]


portfolio before change:  [10.52957255]
curr_Stock_Price:  97.81388575937719
curr_Factors:  [97.81388576 -0.16866787 -0.85103829]
mat_Sqrt:  [[35.28155781  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00191315 0.02454143 0.29817477]
Stock Position:  0.0019131542486573406
Bond Position:  [10.3424395]


portfolio before change:  [10.52780183]
curr_Stock_Price:  96.21255252933767
curr_Factors:  [ 9.62125525e+01 -7.82770064e-02 -8.76185311e-01]
mat_Sqrt:  [[37.04367106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00072786  0.01714293 -0.07394436]
Stock Position:  0.000727856721383681
Bond Position:  [10.45777288]


portfolio before change:  [10.52779514]
curr_Stock_Price:  94.40725777775855
curr_Factors:  [ 9.44072578e+01  3.61177200e-02 -8.74318517e-01]
mat_Sqrt:  [[40.8300021   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082509 -0.01269618 -0.03370801]
Stock Position:  0.0008250867027459045
Bond Position:  [10.44990097]


portfolio before change:  [10.53005318]
curr_Stock_Price:  95.56073202641971
curr_Factors:  [95.56073203 -0.33711977 -0.86436654]
mat_Sqrt:  [[28.73959161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218785 -0.03343722 -0.29175268]
Stock Position:  -0.002187854701902164
Bond Position:  [10.73912617]


portfolio before change:  [10.52968501]
curr_Stock_Price:  96.34261142738465
curr_Factors:  [96.34261143 -0.36482258 -0.86412511]
mat_Sqrt:  [[28.18987925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00458207  0.00175068  0.15864528]
Stock Position:  -0.004582073446778025
Bond Position:  [10.97113394]


portfolio before change:  [10.53030915]
curr_Stock_Price:  96.50571355492106
curr_Factors:  [96.50571355 -0.47347796 -0.85145164]
mat_Sqrt:  [[25.65331015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.003281   -0.00188064 -0.07596767]
Stock Position:  0.00328099989091956
Bond Position:  [10.21367391]


portfolio before change:  [10.53768041]
curr_Stock_Price:  98.36321774555599
curr_Factors:  [98.36321775 -0.5481187  -0.83970582]
mat_Sqrt:  [[24.55320515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00426005 -0.01329337  0.84439544]
Stock Position:  0.004260052729044606
Bond Position:  [10.11864791]


portfolio before change:  [10.54428322]
curr_Stock_Price:  99.61623254747472
curr_Factors:  [99.61623255 -0.48795487 -0.87699013]
mat_Sqrt:  [[25.44146023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143269 -0.03714284 -0.00207193]
Stock Position:  -0.0014326890585256514
Bond Position:  [10.68700231]


portfolio before change:  [10.54296461]
curr_Stock_Price:  101.46909085171137
curr_Factors:  [101.46909085  -0.59767459  -0.87647452]
mat_Sqrt:  [[23.23373028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175302  0.01525086  0.35344664]
Stock Position:  -0.0017530199235302937
Bond Position:  [10.72084195]


portfolio before change:  [10.54202106]
curr_Stock_Price:  102.7718391575002
curr_Factors:  [102.77183916  -0.49275443  -0.86412751]
mat_Sqrt:  [[26.45987516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090067 -0.02385919 -0.00394872]
Stock Position:  -0.0009006664650152704
Bond Position:  [10.63458421]


portfolio before change:  [10.54199586]
curr_Stock_Price:  104.27583808467313
curr_Factors:  [104.27583808  -0.49358398  -0.87260409]
mat_Sqrt:  [[26.59841433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00547744 -0.00554451  0.08733203]
Stock Position:  0.005477440863675148
Bond Position:  [9.97083113]


portfolio before change:  [10.54796335]
curr_Stock_Price:  105.13774720730036
curr_Factors:  [105.13774721  -0.52737247  -0.85239902]
mat_Sqrt:  [[26.45644721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162329 -0.0249477  -0.07362502]
Stock Position:  -0.0016232921337223276
Bond Position:  [10.71863263]


portfolio before change:  [10.54862839]
curr_Stock_Price:  105.55348876317787
curr_Factors:  [105.55348876  -0.31983788  -0.86509426]
mat_Sqrt:  [[32.27476606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009092   0.0008577  -0.10469644]
Stock Position:  0.000909197884549827
Bond Position:  [10.45265939]


portfolio before change:  [10.55079781]
curr_Stock_Price:  106.50240301056897
curr_Factors:  [106.50240301  -0.45313224  -0.8848882 ]
mat_Sqrt:  [[27.94245203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00160128 -0.01993283  0.03429438]
Stock Position:  -0.0016012840809236165
Bond Position:  [10.72133841]


portfolio before change:  [10.55262303]
curr_Stock_Price:  106.19954228828222
curr_Factors:  [106.19954229  -0.54592899  -0.87114558]
mat_Sqrt:  [[25.74512352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02074141 0.02342457 0.36387862]
Stock Position:  0.02074140560763697
Bond Position:  [8.34989524]


portfolio before change:  [10.53295327]
curr_Stock_Price:  105.20088503083763
curr_Factors:  [105.20088503  -0.66431462  -0.8476914 ]
mat_Sqrt:  [[23.19335223  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.001872    0.06976481 -0.29912516]
Stock Position:  0.001872004036543236
Bond Position:  [10.33601679]


portfolio before change:  [10.53426715]
curr_Stock_Price:  105.21252601875868
curr_Factors:  [105.21252602  -0.9026224   -0.86478965]
mat_Sqrt:  [[17.96760308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0018672  0.00967233 0.17972764]
Stock Position:  0.0018671961567967674
Bond Position:  [10.33781472]


portfolio before change:  [10.53422129]
curr_Stock_Price:  104.49585599961023
curr_Factors:  [104.495856    -0.72849991  -0.83632524]
mat_Sqrt:  [[21.85265144  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.1511688  0.62412681 0.59910153]
Stock Position:  0.1511688014695358
Bond Position:  [-5.26229202]


portfolio before change:  [10.32801691]
curr_Stock_Price:  103.13614055849712
curr_Factors:  [103.13614056  -0.80214928  -0.81340573]
mat_Sqrt:  [[20.50143453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00402118 -0.01698226 -0.08046453]
Stock Position:  -0.004021176032711553
Bond Position:  [10.74274549]


portfolio before change:  [10.32432926]
curr_Stock_Price:  104.38716134397419
curr_Factors:  [104.38716134  -0.87373959  -0.8180969 ]
mat_Sqrt:  [[19.22612839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00037097 -0.00421679 -0.364928  ]
Stock Position:  0.00037096837048566136
Bond Position:  [10.28560493]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.32534965]
Stock Price:  103.67174966593664
PL:  [6.65359998]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 2.73314643e-03 -1.07994972e-01  3.80612227e-02]
 [ 1.09202051e+00  2.18568086e-01  3.14287608e-01]
 [-2.38973746e-01 -1.33500004e-01  3.67671463e-02]
 [ 1.55870911e-01  1.31596640e+00  1.01685703e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 2.93749711e-02 -8.59041376e-02  5.24526292e-02]
 [-4.70986414e-02 -2.35086590e-02 -6.36865809e-02]
 [ 1.29346491e-01  9.85067601e-02 -1.11677396e-01]
 [-8.48229431e-03  8.97124673e-02 -5.03241773e-02]
 [-3.74793357e-01  3.37366592e-02 -1.33562315e-01]
 [ 6.33593331e-01  1.23341077e+00 -2.18194051e-01]
 [-1.88245660e-04  2.94039913e-02 -5.82575143e-02]
 [-1.63864687e-01 -2.79912261e-02 -4.49371320e-01]
 [ 1.77752007e+00 -3.47132596e+00  2.97570067e+00]
 [ 1.20966202e-02 -9.09003443e-02  3.49589404e-02]
 [ 1.21796077e-01 -4.13832085e-02 -4.95428018e-03]
 [-1.15383836e-01 -1.24275328e-01 -4.24658998e-02]
 [-2.63972632e-01 -1.72185228e+00 -1.99506216e-01]
 [-2.21103960e-02  9.81449652e-02  2.77447821e-01]
 [ 3.35525977e-01 -4.84434293e-01  3.17658573e-01]
 [ 9.26833921e-02 -1.51191310e-01 -1.07331405e-01]
 [-3.66008128e-02 -5.33025513e-02 -1.05323395e-01]
 [ 2.43294205e-01  2.89940397e-01  2.43491102e-01]
 [ 8.86935730e-02 -1.11773348e-01  2.81625489e-02]
 [-7.54198003e-02 -2.08352072e-01  8.51124565e-02]
 [ 9.63828506e-02 -2.49701826e-02 -9.09479607e-02]
 [ 6.13681437e-01 -7.06324631e-02  3.36316958e-01]
 [ 1.28161837e-02 -7.93518014e-02  1.44983780e-02]
 [-1.37987733e-02 -7.91012681e-02 -1.03476811e-02]
 [ 2.17130382e-01 -7.18159235e-02  1.84170849e-02]
 [-2.78403821e-02 -7.14377482e-02 -2.77480376e-02]
 [ 6.87051195e-02  1.86009565e-02 -6.82016628e-02]
 [-5.76777152e-02 -5.54265217e-02  1.45074296e-02]
 [ 4.27706252e-01  6.17154837e-02  9.57140638e-02]
 [ 8.34212147e-02  5.29857212e-02 -5.59613162e-02]
 [-7.34250101e-02 -1.15006645e-02 -8.75628566e-02]
 [ 1.97343096e+00  1.35457980e+00  1.71208621e-01]
 [-8.63322129e-02 -2.84718519e-02 -2.32954998e-02]
 [ 3.75465692e-02 -1.27626623e-02 -1.64445791e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.3044803]
curr_Stock_Price:  99.7129815248845
curr_Factors:  [99.71298152 -1.01080033 -1.02374914]
mat_Sqrt:  [[13.0364125   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088537 -0.03485523  0.10857807]
Stock Position:  -0.0008853678398969656
Bond Position:  [0.39276296]


portfolio before change:  [0.30446731]
curr_Stock_Price:  99.78310908759585
curr_Factors:  [99.78310909 -1.4116975  -1.0313334 ]
mat_Sqrt:  [[ 8.67086039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.13848559 0.07054255 0.89657506]
Stock Position:  0.13848559113158196
Bond Position:  [-13.51405554]


portfolio before change:  [0.3231937]
curr_Stock_Price:  99.93053058092126
curr_Factors:  [99.93053058 -1.38151145 -1.05553703]
mat_Sqrt:  [[ 8.7357759   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02961606 -0.04308694  0.10488643]
Stock Position:  -0.029616059351582395
Bond Position:  [3.28274222]


portfolio before change:  [0.31680836]
curr_Stock_Price:  100.15999065855908
curr_Factors:  [100.15999066  -1.41661228  -1.07199942]
mat_Sqrt:  [[ 8.31579831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07600671 0.42472633 2.90081006]
Stock Position:  0.07600671347421771
Bond Position:  [-7.29602335]


portfolio before change:  [0.31782905]
curr_Stock_Price:  100.18541928063054
curr_Factors:  [100.18541928  -1.27561711  -1.0789772 ]
mat_Sqrt:  [[ 9.51080339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00616625 -0.01106097 -0.05874131]
Stock Position:  -0.00616625100021795
Bond Position:  [0.93559749]


portfolio before change:  [0.31794443]
curr_Stock_Price:  100.1856752498916
curr_Factors:  [100.18567525  -1.29922984  -1.10642795]
mat_Sqrt:  [[ 9.03736304  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00249483 -0.02772544  0.14963275]
Stock Position:  0.0024948328845344637
Bond Position:  [0.06799791]


portfolio before change:  [0.31989741]
curr_Stock_Price:  100.96508092064083
curr_Factors:  [100.96508092  -1.24709556  -1.14100872]
mat_Sqrt:  [[ 9.26895315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00700158 -0.00758739 -0.18168009]
Stock Position:  -0.007001577651912866
Bond Position:  [1.02681227]


portfolio before change:  [0.31134166]
curr_Stock_Price:  102.20538921852214
curr_Factors:  [102.20538922  -1.19872578  -1.16231221]
mat_Sqrt:  [[ 9.64024398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01313847  0.03179292 -0.31858453]
Stock Position:  0.013138468893268127
Bond Position:  [-1.03148067]


portfolio before change:  [0.32293018]
curr_Stock_Price:  103.0972329586502
curr_Factors:  [103.09723296  -1.32646899  -1.18757631]
mat_Sqrt:  [[ 8.34470539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.29908807e-05  2.89545743e-02 -1.43560870e-01]
Stock Position:  -5.299088071863298e-05
Bond Position:  [0.32839339]


portfolio before change:  [0.32298663]
curr_Stock_Price:  102.80649274050005
curr_Factors:  [102.80649274  -1.27117865  -1.16541818]
mat_Sqrt:  [[ 8.99124821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04395054  0.01088846 -0.38101611]
Stock Position:  -0.04395053663832552
Bond Position:  [4.84138716]


portfolio before change:  [0.33597002]
curr_Stock_Price:  102.52485399477759
curr_Factors:  [102.52485399  -1.53630107  -1.17454752]
mat_Sqrt:  [[ 6.81589005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12336226  0.39808161 -0.62244689]
Stock Position:  0.12336225646500412
Bond Position:  [-12.31172731]


portfolio before change:  [0.3294752]
curr_Stock_Price:  102.48468163290157
curr_Factors:  [102.48468163  -1.81015194  -1.17231066]
mat_Sqrt:  [[ 5.19268415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00117048  0.0094901  -0.16619247]
Stock Position:  -0.0011704825858991155
Bond Position:  [0.44943174]


portfolio before change:  [0.33003745]
curr_Stock_Price:  102.052325503133
curr_Factors:  [102.0523255   -1.76045097  -1.16310988]
mat_Sqrt:  [[ 5.48449394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04764449 -0.00903413 -1.2819313 ]
Stock Position:  -0.04764448863154372
Bond Position:  [5.19226831]


portfolio before change:  [0.32375741]
curr_Stock_Price:  102.19775928050034
curr_Factors:  [102.19775928  -1.71415297  -1.13509973]
mat_Sqrt:  [[ 5.9159793   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.28335985 -1.12036564  8.48884574]
Stock Position:  0.2833598455451187
Bond Position:  [-28.63498388]


portfolio before change:  [0.14628839]
curr_Stock_Price:  101.58408934424524
curr_Factors:  [101.58408934  -1.56995886  -1.1221166 ]
mat_Sqrt:  [[ 6.88132661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.84735983e-05 -2.93379600e-02  9.97281263e-02]
Stock Position:  9.847359833453278e-05
Bond Position:  [0.13628504]


portfolio before change:  [0.14632343]
curr_Stock_Price:  101.76687347663928
curr_Factors:  [101.76687348  -1.61988713  -1.10472864]
mat_Sqrt:  [[ 6.67299556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01683464 -0.01335637 -0.01413318]
Stock Position:  0.016834639761975075
Bond Position:  [-1.56688523]


portfolio before change:  [0.14664489]
curr_Stock_Price:  101.79760374640185
curr_Factors:  [101.79760375  -1.28279987  -1.08440012]
mat_Sqrt:  [[ 9.54279641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01565786 -0.04010969 -0.12114339]
Stock Position:  -0.01565785750522545
Bond Position:  [1.74057726]


portfolio before change:  [0.13977802]
curr_Stock_Price:  102.25005752567014
curr_Factors:  [102.25005753  -1.47323547  -1.06531292]
mat_Sqrt:  [[ 8.07580832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0812511  -0.55572543 -0.5691357 ]
Stock Position:  -0.081251097998317
Bond Position:  [8.44770746]


portfolio before change:  [0.09132474]
curr_Stock_Price:  102.8593945883497
curr_Factors:  [102.85939459  -1.37942325  -1.0883747 ]
mat_Sqrt:  [[ 8.71952709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00625689 0.03167615 0.79148141]
Stock Position:  0.006256894416372326
Bond Position:  [-0.55225563]


portfolio before change:  [0.09999277]
curr_Stock_Price:  104.25578369673501
curr_Factors:  [104.2557837   -1.30123925  -1.09912917]
mat_Sqrt:  [[ 9.45438749  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03188816 -0.1563505   0.90619149]
Stock Position:  0.03188816052241191
Bond Position:  [-3.2245324]


portfolio before change:  [0.10356059]
curr_Stock_Price:  104.38030999377358
curr_Factors:  [104.38030999  -1.51850463  -1.09044842]
mat_Sqrt:  [[ 7.68359861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00519453 -0.04879679 -0.30618662]
Stock Position:  0.005194527447244672
Bond Position:  [-0.4386458]


portfolio before change:  [0.10488436]
curr_Stock_Price:  104.64570557371803
curr_Factors:  [104.64570557  -1.65204772  -1.10141166]
mat_Sqrt:  [[ 6.66667365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01034702 -0.01720332 -0.30045833]
Stock Position:  -0.010347018920929494
Bond Position:  [1.18765545]


portfolio before change:  [0.10431016]
curr_Stock_Price:  104.71554842045755
curr_Factors:  [104.71554842  -1.45419524  -1.114418  ]
mat_Sqrt:  [[ 8.02558346  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04388222 0.09357786 0.69461234]
Stock Position:  0.04388222434589745
Bond Position:  [-4.49084103]


portfolio before change:  [0.07851786]
curr_Stock_Price:  104.14057961595684
curr_Factors:  [104.14057962  -1.54856914  -1.07577627]
mat_Sqrt:  [[ 7.54885808  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0094884  -0.03607469  0.08033991]
Stock Position:  0.00948840068916626
Bond Position:  [-0.90960969]


portfolio before change:  [0.08053246]
curr_Stock_Price:  104.36488653221298
curr_Factors:  [104.36488653  -1.40206326  -1.08748057]
mat_Sqrt:  [[ 8.65683733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0116181  -0.06724534  0.24280215]
Stock Position:  -0.011618097651317133
Bond Position:  [1.29305391]


portfolio before change:  [0.08019081]
curr_Stock_Price:  104.40820668345859
curr_Factors:  [104.40820668  -1.39834411  -1.09532261]
mat_Sqrt:  [[ 8.62479822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00843164 -0.00805909 -0.25944922]
Stock Position:  0.008431635946668743
Bond Position:  [-0.80014118]


portfolio before change:  [0.07731494]
curr_Stock_Price:  104.07898879838085
curr_Factors:  [104.0789888   -1.41074144  -1.11125979]
mat_Sqrt:  [[ 8.35741271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07991876 -0.02279653  0.95941867]
Stock Position:  0.07991875963432514
Bond Position:  [-8.24054875]


portfolio before change:  [0.06575092]
curr_Stock_Price:  103.94718133432845
curr_Factors:  [103.94718133  -1.25547695  -1.10786711]
mat_Sqrt:  [[ 9.7819498   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.31371969e-05 -2.56106838e-02  4.13598368e-02]
Stock Position:  -4.3137196866462026e-05
Bond Position:  [0.07023491]


portfolio before change:  [0.06575974]
curr_Stock_Price:  103.94611545443838
curr_Factors:  [103.94611545  -1.04121934  -1.09782772]
mat_Sqrt:  [[12.2414237   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261877 -0.02552982 -0.02951905]
Stock Position:  -0.002618769222199014
Bond Position:  [0.33797063]


portfolio before change:  [0.0644349]
curr_Stock_Price:  104.46815274364717
curr_Factors:  [104.46815274  -0.85274468  -1.08296028]
mat_Sqrt:  [[15.0771041   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01367838 -0.02317849  0.05253882]
Stock Position:  0.013678382036551655
Bond Position:  [-1.36452041]


portfolio before change:  [0.07025761]
curr_Stock_Price:  104.90631067999904
curr_Factors:  [104.90631068  -0.79271847  -1.10290823]
mat_Sqrt:  [[15.75946242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305128 -0.02305643 -0.07915743]
Stock Position:  -0.0030512840205795797
Bond Position:  [0.39035656]


portfolio before change:  [0.06957511]
curr_Stock_Price:  105.14597971969145
curr_Factors:  [105.14597972  -0.5680954   -1.11173874]
mat_Sqrt:  [[19.59972486  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00298884  0.00600343 -0.19456036]
Stock Position:  0.0029888387807808082
Bond Position:  [-0.24468927]


portfolio before change:  [0.06890614]
curr_Stock_Price:  104.93239052030734
curr_Factors:  [104.93239052  -0.54351181  -1.14270619]
mat_Sqrt:  [[19.43544086  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339742 -0.01788883  0.04138566]
Stock Position:  -0.0033974166251627418
Bond Position:  [0.42540519]


portfolio before change:  [0.07158002]
curr_Stock_Price:  104.16100983872391
curr_Factors:  [104.16100984  -0.62076366  -1.12972977]
mat_Sqrt:  [[18.09154033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02541748 0.01991859 0.27304558]
Stock Position:  0.025417483263638026
Bond Position:  [-2.5759307]


portfolio before change:  [0.07720722]
curr_Stock_Price:  104.39506966142147
curr_Factors:  [104.39506966  -0.74221854  -1.11767287]
mat_Sqrt:  [[16.25322003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00509523  0.01710107 -0.15964206]
Stock Position:  0.005095225669298439
Bond Position:  [-0.45470922]


portfolio before change:  [0.07426353]
curr_Stock_Price:  103.82849070269975
curr_Factors:  [103.8284907   -0.67154229  -1.09307104]
mat_Sqrt:  [[17.78093975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00526667 -0.00371182 -0.24979246]
Stock Position:  -0.005266665766623402
Bond Position:  [0.62109349]


portfolio before change:  [0.07659876]
curr_Stock_Price:  103.39983487790452
curr_Factors:  [103.39983488  -0.75226572  -1.07008062]
mat_Sqrt:  [[16.71417267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.13670322 0.43718875 0.48841054]
Stock Position:  0.13670321957756154
Bond Position:  [-14.05849157]


portfolio before change:  [0.2157541]
curr_Stock_Price:  104.43062820065865
curr_Factors:  [104.4306282   -0.66583598  -1.07836652]
mat_Sqrt:  [[18.25283672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00530872 -0.00918925 -0.06645558]
Stock Position:  -0.005308718905159692
Bond Position:  [0.77014696]


portfolio before change:  [0.21264987]
curr_Stock_Price:  105.03350568989127
curr_Factors:  [105.03350569  -0.55558934  -1.09613335]
mat_Sqrt:  [[20.1369556   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.82350021e-05 -4.11913154e-03 -4.69118068e-01]
Stock Position:  6.823500210608924e-05
Bond Position:  [0.20548291]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.21270526]
Stock Price:  105.46884595168355
PL:  [-5.25614069]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 9.60397059e-02 -4.94553037e-02 -6.59808378e-02]
 [ 9.27159718e-01  2.15240107e-01  2.70442679e-01]
 [-2.88000886e-01 -1.78628474e-01  3.81971981e-02]
 [ 1.79176472e-01  1.36860242e+00  1.14978878e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-3.52428247e-02  3.23590952e-01 -1.46290588e-01]
 [-1.33785055e-01  2.21571722e-01  9.50765369e-02]
 [-6.34330807e-02  1.25943358e-01  6.51462416e-04]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 6.57862929e-01  1.41477212e+00 -1.92550115e-01]
 [-1.32455241e-03  3.59883102e-02  1.22545372e-01]
 [-4.66267261e-01 -7.42089516e-02 -1.21493889e+00]
 [ 2.18656495e+00 -3.21928400e+00  2.74424965e+00]
 [-5.13006199e-03  4.90315182e-02 -1.68098046e-02]
 [ 5.08721449e-03  4.70593302e-01 -2.47244089e-01]
 [ 2.36172462e-02 -2.27446064e-01 -6.72829407e-02]
 [-3.09698565e-01 -1.95384178e+00 -1.89243747e-01]
 [ 5.04075182e-02 -1.45907738e-01  6.01416320e-02]
 [-3.45031922e-01  5.74434431e-01  3.87705688e-01]
 [ 1.38850229e-02  1.37976100e-01 -8.77189415e-02]
 [ 1.03096137e-01 -4.94682967e-02  5.63796130e-02]
 [ 1.17467519e-02 -1.17182823e-01 -1.17355661e-01]
 [-2.67200784e-01  9.68442785e-02  1.86196888e-02]
 [ 1.33311697e-01 -2.63058865e-02 -4.72206793e-02]
 [-1.95674533e-02 -5.38557228e-02  2.01026733e-01]
 [-1.95057036e-01 -1.28795806e-01 -7.29959950e-02]
 [-1.64529734e-01  1.30900341e-01  2.14415523e-01]
 [ 8.06641601e-02  4.15576555e-02  1.58917739e-01]
 [-1.64183727e-01  1.24853604e-01 -2.78655687e-02]
 [ 9.96262396e-02 -2.91847323e-03 -1.80701199e-02]
 [ 5.94494633e-02 -2.07940549e-03 -6.82400357e-02]
 [ 4.98692521e-02  7.82397458e-02  1.27159421e-01]
 [-4.66007096e-03 -4.42738763e-02 -1.90741556e-03]
 [-8.59910757e-02  5.06400301e-02  5.24425000e-02]
 [-1.00003723e-01 -5.66256729e-02 -6.34400752e-02]
 [ 1.82688902e+00  1.17867238e+00  1.49083657e-01]
 [ 1.58400472e-01 -2.13661585e-01  6.27719859e-02]
 [ 2.94060210e-02 -1.53107584e-02 -1.02561081e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.94182977]
curr_Stock_Price:  100.61872485032066
curr_Factors:  [100.61872485  -1.08065334  -0.97505236]
mat_Sqrt:  [[12.87944562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00562729 -0.01596163 -0.18822496]
Stock Position:  0.005627292069564039
Bond Position:  [6.37561882]


portfolio before change:  [6.93556555]
curr_Stock_Price:  99.3639076504933
curr_Factors:  [99.36390765 -1.38526366 -0.96855738]
mat_Sqrt:  [[ 9.44011259  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10871685 0.06946845 0.77149769]
Stock Position:  0.10871684970246455
Bond Position:  [-3.86696547]


portfolio before change:  [6.96032286]
curr_Stock_Price:  99.59607688071638
curr_Factors:  [99.59607688 -1.19979166 -0.9752414 ]
mat_Sqrt:  [[11.31455238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02798752 -0.05765209  0.10896597]
Stock Position:  -0.027987523447667122
Bond Position:  [9.74777039]


portfolio before change:  [6.95494513]
curr_Stock_Price:  99.83176290770282
curr_Factors:  [99.83176291 -1.08853463 -0.97254822]
mat_Sqrt:  [[12.71018389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05454216 0.44171453 3.28002736]
Stock Position:  0.0545421632110957
Bond Position:  [1.50990483]


portfolio before change:  [6.92180508]
curr_Stock_Price:  99.22069788739583
curr_Factors:  [99.22069789 -1.15714024 -0.96868127]
mat_Sqrt:  [[11.84049134  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.004953   -0.01106097 -0.05874131]
Stock Position:  -0.004953003995190753
Bond Position:  [7.41324559]


portfolio before change:  [6.92935781]
curr_Stock_Price:  97.88291959287302
curr_Factors:  [97.88291959 -0.91439168 -0.93692083]
mat_Sqrt:  [[15.37064551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.17059675e-05  1.04438531e-01 -4.17326329e-01]
Stock Position:  6.170596752113816e-05
Bond Position:  [6.92331785]


portfolio before change:  [6.93023442]
curr_Stock_Price:  98.063432302558
curr_Factors:  [98.0634323  -0.96807419 -0.94835039]
mat_Sqrt:  [[14.42827688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00479264  0.07151197  0.2712269 ]
Stock Position:  -0.004792637397165274
Bond Position:  [7.40021689]


portfolio before change:  [6.92859736]
curr_Stock_Price:  98.59803248712198
curr_Factors:  [98.59803249 -1.10938835 -0.93474071]
mat_Sqrt:  [[12.76774729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029443   0.04064804  0.00185844]
Stock Position:  -0.002944295527404617
Bond Position:  [7.2188991]


portfolio before change:  [6.93279462]
curr_Stock_Price:  97.47897383701506
curr_Factors:  [97.47897384 -0.98786254 -0.9124364 ]
mat_Sqrt:  [[14.57543771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00356704  0.0064198  -0.11330016]
Stock Position:  0.003567042333436454
Bond Position:  [6.58508299]


portfolio before change:  [6.92936915]
curr_Stock_Price:  96.28788767384552
curr_Factors:  [96.28788767 -0.95956983 -0.90416225]
mat_Sqrt:  [[14.93355152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [5.85305676e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  5.853056762557882e-05
Bond Position:  [6.92373336]


portfolio before change:  [6.93024266]
curr_Stock_Price:  96.42437777789732
curr_Factors:  [96.42437778 -1.02470119 -0.88349726]
mat_Sqrt:  [[14.30430586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06343181  0.45661574 -0.54929188]
Stock Position:  0.06343180583324133
Bond Position:  [0.81387025]


portfolio before change:  [6.9037083]
curr_Stock_Price:  96.00446070822089
curr_Factors:  [96.00446071 -0.99432736 -0.87544453]
mat_Sqrt:  [[14.79993474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00209704 0.01161518 0.34958784]
Stock Position:  0.0020970362780747143
Bond Position:  [6.70238346]


portfolio before change:  [6.9030164]
curr_Stock_Price:  95.27497964986563
curr_Factors:  [95.27497965 -1.10189481 -0.86982092]
mat_Sqrt:  [[13.26397221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05499208 -0.02395084 -3.46588247]
Stock Position:  -0.054992083106885616
Bond Position:  [12.142386]


portfolio before change:  [6.89762538]
curr_Stock_Price:  95.40061434371614
curr_Factors:  [95.40061434 -1.06840702 -0.88329935]
mat_Sqrt:  [[13.54989299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.15421516 -1.03901944  7.82858039]
Stock Position:  0.15421516414040326
Bond Position:  [-7.81459602]


portfolio before change:  [6.77389952]
curr_Stock_Price:  94.604655150181
curr_Factors:  [94.60465515 -0.98863034 -0.88385902]
mat_Sqrt:  [[14.54456409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.94988744e-05  1.58248544e-02 -4.79536935e-02]
Stock Position:  9.949887438234438e-05
Bond Position:  [6.76448646]


portfolio before change:  [6.77460345]
curr_Stock_Price:  93.18070689316157
curr_Factors:  [93.18070689 -0.8230111  -0.87052537]
mat_Sqrt:  [[17.13296205  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00295793  0.15188334 -0.70531857]
Stock Position:  0.002957934627645067
Bond Position:  [6.49898101]


portfolio before change:  [6.77734146]
curr_Stock_Price:  93.83169550649512
curr_Factors:  [93.83169551 -0.77360493 -0.88344238]
mat_Sqrt:  [[17.89381974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204227 -0.0734079  -0.1919395 ]
Stock Position:  -0.0020422727162642523
Bond Position:  [6.96897137]


portfolio before change:  [6.78067551]
curr_Stock_Price:  92.62574376104743
curr_Factors:  [92.62574376 -0.80774408 -0.88312959]
mat_Sqrt:  [[17.07633259  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04375378 -0.63059972 -0.53985973]
Stock Position:  -0.04375377814048672
Bond Position:  [10.83340176]


portfolio before change:  [6.79639669]
curr_Stock_Price:  92.29738550696679
curr_Factors:  [92.29738551 -0.92981731 -0.88841477]
mat_Sqrt:  [[14.98101512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00219615 -0.04709152  0.17156734]
Stock Position:  0.0021961519147573358
Bond Position:  [6.59369761]


portfolio before change:  [6.79877434]
curr_Stock_Price:  93.0047093335223
curr_Factors:  [93.00470933 -1.08147637 -0.89143404]
mat_Sqrt:  [[12.93245074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01149325  0.18539792  1.10601641]
Stock Position:  -0.011493250216238291
Bond Position:  [7.86770074]


portfolio before change:  [6.79668245]
curr_Stock_Price:  93.27229397259082
curr_Factors:  [93.27229397 -0.93371648 -0.8996333 ]
mat_Sqrt:  [[14.91210539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00161907  0.04453159 -0.25023772]
Stock Position:  0.00161906865379031
Bond Position:  [6.6456682]


portfolio before change:  [6.79964785]
curr_Stock_Price:  94.59072773608341
curr_Factors:  [94.59072774 -0.8995153  -0.91231145]
mat_Sqrt:  [[15.45191137  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00676336 -0.01596582  0.16083534]
Stock Position:  0.006763364146565725
Bond Position:  [6.15989631]


portfolio before change:  [6.79308554]
curr_Stock_Price:  93.50660182081086
curr_Factors:  [93.50660182 -0.51026345 -0.92256514]
mat_Sqrt:  [[22.31375836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016191  -0.03782059 -0.33478304]
Stock Position:  -0.0016191004319502645
Bond Position:  [6.94448212]


portfolio before change:  [6.79661175]
curr_Stock_Price:  91.86488905013488
curr_Factors:  [91.86488905 -0.4664409  -0.91332905]
mat_Sqrt:  [[23.11655319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01053928  0.03125636  0.05311679]
Stock Position:  -0.01053927887381546
Bond Position:  [7.76480144]


portfolio before change:  [6.79352143]
curr_Stock_Price:  92.25020777751382
curr_Factors:  [92.25020778 -0.71063063 -0.91169869]
mat_Sqrt:  [[18.21372113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00649528 -0.00849019 -0.13470745]
Stock Position:  0.006495276198257227
Bond Position:  [6.19433085]


portfolio before change:  [6.79353047]
curr_Stock_Price:  92.13238389698004
curr_Factors:  [92.1323839  -0.48767464 -0.90966197]
mat_Sqrt:  [[22.78015785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.59773079e-04 -1.73818598e-02  5.73473313e-01]
Stock Position:  0.00045977307859023487
Bond Position:  [6.75117049]


portfolio before change:  [6.79478448]
curr_Stock_Price:  93.02425042848512
curr_Factors:  [93.02425043 -0.49478537 -0.9055477 ]
mat_Sqrt:  [[22.93185849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01030216 -0.04156867 -0.20823726]
Stock Position:  -0.0103021573573006
Bond Position:  [7.75313495]


portfolio before change:  [6.76326813]
curr_Stock_Price:  96.17752699787022
curr_Factors:  [96.177527   -0.82663999 -0.92833629]
mat_Sqrt:  [[16.63018538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00565492  0.0422479   0.61166781]
Stock Position:  -0.005654923654898324
Bond Position:  [7.3071447]


portfolio before change:  [6.76490907]
curr_Stock_Price:  96.04888000017944
curr_Factors:  [96.04888    -0.70820965 -0.90417653]
mat_Sqrt:  [[19.15322388  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00634807 0.01341268 0.45334807]
Stock Position:  0.006348071185196655
Bond Position:  [6.15518394]


portfolio before change:  [6.76151237]
curr_Stock_Price:  95.39259534769259
curr_Factors:  [95.39259535 -0.86319226 -0.94202854]
mat_Sqrt:  [[15.68618143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00920467  0.04029633 -0.07949271]
Stock Position:  -0.009204670234881201
Bond Position:  [7.63956976]


portfolio before change:  [6.77192183]
curr_Stock_Price:  94.3654596646002
curr_Factors:  [94.36545966 -0.77903443 -0.94114475]
mat_Sqrt:  [[16.894632    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00564333 -0.00094193 -0.05154902]
Stock Position:  0.005643328661493222
Bond Position:  [6.23938652]


portfolio before change:  [6.76942053]
curr_Stock_Price:  93.78401824729592
curr_Factors:  [93.78401825 -0.78887636 -0.93112205]
mat_Sqrt:  [[16.79356957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00268529 -0.00067113 -0.19466983]
Stock Position:  0.0026852877965817903
Bond Position:  [6.51758345]


portfolio before change:  [6.76921881]
curr_Stock_Price:  93.4054860549594
curr_Factors:  [93.40548605 -1.02323932 -0.94864825]
mat_Sqrt:  [[13.00147105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00706045 0.02525177 0.36275043]
Stock Position:  0.007060445781319831
Bond Position:  [6.10973444]


portfolio before change:  [6.7744539]
curr_Stock_Price:  94.03877737280894
curr_Factors:  [94.03877737 -1.0168526  -0.97179446]
mat_Sqrt:  [[12.8720741   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109437 -0.01428933 -0.00544133]
Stock Position:  -0.0010943681316015219
Bond Position:  [6.87736694]


portfolio before change:  [6.77479679]
curr_Stock_Price:  94.511042085835
curr_Factors:  [94.51104209 -1.01864197 -0.9690467 ]
mat_Sqrt:  [[12.94912225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00501574  0.016344    0.14960386]
Stock Position:  -0.0050157409183643085
Bond Position:  [7.24883969]


portfolio before change:  [6.77537127]
curr_Stock_Price:  94.57717029597708
curr_Factors:  [94.5771703  -1.23749281 -0.97988685]
mat_Sqrt:  [[10.29889341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01208985 -0.01827586 -0.18097688]
Stock Position:  -0.012089846615966938
Bond Position:  [7.91879475]


portfolio before change:  [6.78520628]
curr_Stock_Price:  93.84555674475818
curr_Factors:  [93.84555674 -1.12742002 -0.95613141]
mat_Sqrt:  [[11.68258161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.17957641 0.38041488 0.42529418]
Stock Position:  0.17957641143185976
Bond Position:  [-10.06724203]


portfolio before change:  [6.70884001]
curr_Stock_Price:  93.42730702668001
curr_Factors:  [93.42730703 -1.25506698 -0.96240213]
mat_Sqrt:  [[10.17277009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01254332 -0.06895898  0.179071  ]
Stock Position:  0.012543315152983115
Bond Position:  [5.53695185]


portfolio before change:  [6.71336789]
curr_Stock_Price:  93.73310445991015
curr_Factors:  [93.73310446 -1.4043339  -0.95578897]
mat_Sqrt:  [[ 8.84921329  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00273326 -0.00494153 -0.02925782]
Stock Position:  0.0027332606279966564
Bond Position:  [6.45717088]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.71451094]
Stock Price:  93.85598380971648
PL:  [6.71451094]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 3.39174543e-02 -4.30901389e-02  1.21000010e-01]
 [ 1.00633830e+00  2.27599875e-01  2.82957220e-01]
 [ 1.29690584e-01  2.39773832e-01  4.29973334e-02]
 [ 6.28705689e-02  5.22417750e-01  4.09793077e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 5.57843021e-02 -5.50470933e-02  4.33767740e-02]
 [-4.46833624e-02 -3.89664079e-02 -5.33554314e-02]
 [ 7.49051596e-02  1.29013222e-01 -4.95605022e-02]
 [ 8.42650929e-03  7.14144091e-02 -4.75442344e-02]
 [-1.85090186e-01 -1.02339340e-01 -7.43102662e-02]
 [ 7.23848985e-01  1.39688199e+00 -2.51567080e-01]
 [-2.45018995e-04  2.34410553e-02 -5.78426468e-02]
 [-2.23782502e-01 -8.16625173e-03 -4.66832122e-01]
 [ 1.74678149e+00 -3.35890827e+00  2.81996180e+00]
 [ 1.12635957e-02 -9.10407719e-02  3.50453177e-02]
 [ 1.15045905e-01  1.88964006e-02 -3.64490732e-02]
 [-4.39556133e-02  2.40238473e-02 -7.48157393e-02]
 [-2.78973337e-01 -1.80507918e+00 -1.98711919e-01]
 [ 1.07319905e-02 -4.84136737e-02  1.89623945e-01]
 [ 1.19683895e-01  1.00006012e-01  2.88695627e-01]
 [ 3.20545898e-02 -4.87510065e-02  6.27334920e-02]
 [ 1.09918200e-01 -5.03485937e-02  2.31123515e-03]
 [ 1.27137614e-01  1.70099385e-02  2.78263717e-02]
 [-4.86654023e-02 -6.22535120e-02  8.29970675e-02]
 [ 4.76734856e-02 -3.88011414e-02 -1.66002548e-03]
 [ 4.46254372e-02 -4.25855073e-02  2.85519306e-01]
 [ 7.89894223e-02 -1.09720499e-01  3.60474309e-02]
 [ 8.15584869e-03 -1.10274750e-01 -2.95928502e-02]
 [ 1.56901569e-02 -5.70661132e-02  1.99977807e-02]
 [ 4.11656436e-02  3.66669503e-02  1.36915773e-02]
 [-6.02454058e-04 -1.62623087e-02 -6.99774874e-02]
 [-4.20295605e-02  2.35724143e-02 -4.85021714e-02]
 [-1.01860416e-01 -3.33099534e-02  4.01014485e-02]
 [ 1.67107284e-01  5.04457671e-03  3.02644399e-02]
 [-1.02130373e-01  1.14082675e-02  4.15921219e-02]
 [-1.16585661e-01 -6.76871354e-02 -7.90813409e-02]
 [ 1.48218693e+00  9.75780949e-01  1.38158008e-01]
 [ 4.63750297e-03 -3.63488831e-02  5.43316859e-02]
 [ 3.22872416e-02 -1.46825928e-02 -5.97791467e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.6762294]
curr_Stock_Price:  100.58248059884495
curr_Factors:  [100.5824806   -0.91983084  -1.01060959]
mat_Sqrt:  [[14.59293728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00341403 -0.01390728  0.34517935]
Stock Position:  0.0034140309860868426
Bond Position:  [6.33283769]


portfolio before change:  [6.67578203]
curr_Stock_Price:  100.21955915863883
curr_Factors:  [100.21955916  -0.83740595  -0.99648803]
mat_Sqrt:  [[16.0140969   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06934861 0.07345754 0.80719819]
Stock Position:  0.06934860809183348
Bond Position:  [-0.2743049]


portfolio before change:  [6.80140437]
curr_Stock_Price:  102.03151531007326
curr_Factors:  [102.03151531  -0.99941006  -1.01294277]
mat_Sqrt:  [[13.63893959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01374088 0.07738667 0.12265942]
Stock Position:  0.013740878115662018
Bond Position:  [5.39940176]


portfolio before change:  [6.80534814]
curr_Stock_Price:  102.2694035980178
curr_Factors:  [102.2694036   -1.0330216   -1.01602686]
mat_Sqrt:  [[13.17817539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01921035 0.1686096  1.16902558]
Stock Position:  0.019210345859452842
Bond Position:  [4.84071752]


portfolio before change:  [6.79524313]
curr_Stock_Price:  101.71188477604434
curr_Factors:  [101.71188478  -1.00968674  -1.02785709]
mat_Sqrt:  [[13.2579892   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00442345 -0.01106097 -0.05874131]
Stock Position:  -0.0044234461225285794
Bond Position:  [7.24516018]


portfolio before change:  [6.79920638]
curr_Stock_Price:  101.02067224558046
curr_Factors:  [101.02067225  -1.03805843  -1.02631241]
mat_Sqrt:  [[12.81933181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00416575 -0.01776637  0.12374186]
Stock Position:  0.004165748181123411
Bond Position:  [6.37837969]


portfolio before change:  [6.80081464]
curr_Stock_Price:  101.21533453513626
curr_Factors:  [101.21533454  -1.1869616   -1.00979215]
mat_Sqrt:  [[11.25144447  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00564625 -0.01257635 -0.15220819]
Stock Position:  -0.005646250938865194
Bond Position:  [7.37230182]


portfolio before change:  [6.80141906]
curr_Stock_Price:  101.27150954319009
curr_Factors:  [101.27150954  -1.13472471  -1.03198942]
mat_Sqrt:  [[11.60099643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00785479  0.04163884 -0.14138232]
Stock Position:  0.007854788908268219
Bond Position:  [6.00595273]


portfolio before change:  [6.79842531]
curr_Stock_Price:  100.79478902752179
curr_Factors:  [100.79478903  -1.04885216  -1.03330967]
mat_Sqrt:  [[12.56512124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00105841  0.0230489  -0.13563047]
Stock Position:  0.0010584050915427054
Bond Position:  [6.69174359]


portfolio before change:  [6.79989983]
curr_Stock_Price:  101.39758993944153
curr_Factors:  [101.39758994  -1.16036842  -1.04196343]
mat_Sqrt:  [[11.20900499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01972955 -0.03302988 -0.21198651]
Stock Position:  -0.019729551012977124
Bond Position:  [8.80042876]


portfolio before change:  [6.79679963]
curr_Stock_Price:  101.61048521242114
curr_Factors:  [101.61048521  -1.34080215  -1.05893347]
mat_Sqrt:  [[ 9.22033261  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10386127  0.45084172 -0.71765086]
Stock Position:  0.10386126543507024
Bond Position:  [-3.75659395]


portfolio before change:  [6.85837078]
curr_Stock_Price:  102.20782780422299
curr_Factors:  [102.2078278   -1.26278831  -1.06821886]
mat_Sqrt:  [[ 9.93437629  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073152  0.00756557 -0.16500897]
Stock Position:  -0.0007315219649400953
Bond Position:  [6.93313805]


portfolio before change:  [6.85970581]
curr_Stock_Price:  101.56761057354251
curr_Factors:  [101.56761057  -1.1814228   -1.06078191]
mat_Sqrt:  [[10.78892314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02972874 -0.00263565 -1.3317421 ]
Stock Position:  -0.02972874443408487
Bond Position:  [9.87918335]


portfolio before change:  [6.8746457]
curr_Stock_Price:  101.10661189662876
curr_Factors:  [101.1066119   -1.21511548  -1.05982648]
mat_Sqrt:  [[10.39405038  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.15747177 -1.08408298  8.04456608]
Stock Position:  0.15747176947103392
Bond Position:  [-9.04679138]


portfolio before change:  [6.79957047]
curr_Stock_Price:  100.63704004650309
curr_Factors:  [100.63704005  -1.14029113  -1.03858224]
mat_Sqrt:  [[11.38898895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.46131121e-05 -2.93832828e-02  9.99745366e-02]
Stock Position:  -1.4613112075991307e-05
Bond Position:  [6.80104109]


portfolio before change:  [6.80043187]
curr_Stock_Price:  99.86965446872463
curr_Factors:  [99.86965447 -1.07633499 -1.02926778]
mat_Sqrt:  [[12.16135266  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00916534  0.00609879 -0.10397906]
Stock Position:  0.009165344021183944
Bond Position:  [5.88509213]


portfolio before change:  [6.79760143]
curr_Stock_Price:  99.48056766474295
curr_Factors:  [99.48056766 -1.15391343 -1.02697228]
mat_Sqrt:  [[11.23547992  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483499  0.00775366 -0.21342848]
Stock Position:  -0.0048349928313429075
Bond Position:  [7.27858927]


portfolio before change:  [6.79757066]
curr_Stock_Price:  99.67511958230929
curr_Factors:  [99.67511958 -0.84491443 -1.03289235]
mat_Sqrt:  [[15.24283126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04513568 -0.5825868  -0.5668698 ]
Stock Position:  -0.045135675329212886
Bond Position:  [11.29647449]


portfolio before change:  [6.82390292]
curr_Stock_Price:  99.12300380943717
curr_Factors:  [99.12300381 -0.93411257 -1.04189913]
mat_Sqrt:  [[13.74052982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00287881 -0.01562545  0.54094433]
Stock Position:  0.00287881304438935
Bond Position:  [6.53854633]


portfolio before change:  [6.82509395]
curr_Stock_Price:  99.25279761694227
curr_Factors:  [99.25279762 -0.66500204 -1.05430546]
mat_Sqrt:  [[17.78512806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01119066 0.0322768  0.82356827]
Stock Position:  0.011190657975889244
Bond Position:  [5.71438983]


portfolio before change:  [6.82252214]
curr_Stock_Price:  98.95914669769336
curr_Factors:  [98.9591467  -0.74698044 -1.05460225]
mat_Sqrt:  [[16.33196815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213745 -0.01573432  0.17896119]
Stock Position:  0.002137449230331246
Bond Position:  [6.61100199]


portfolio before change:  [6.82607217]
curr_Stock_Price:  100.23337823605223
curr_Factors:  [100.23337824  -0.90508253  -1.06465419]
mat_Sqrt:  [[13.98191245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00716015 -0.01624994  0.00659331]
Stock Position:  0.00716015180445614
Bond Position:  [6.10838597]


portfolio before change:  [6.81708131]
curr_Stock_Price:  98.87105296043293
curr_Factors:  [98.87105296 -0.77768582 -1.05209411]
mat_Sqrt:  [[15.86374909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00859127 0.00548993 0.07938089]
Stock Position:  0.008591272253373352
Bond Position:  [5.96765318]


portfolio before change:  [6.81821152]
curr_Stock_Price:  98.91577284110846
curr_Factors:  [98.91577284 -0.70259388 -1.03846006]
mat_Sqrt:  [[17.34344745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00256184 -0.02009223  0.23676753]
Stock Position:  -0.0025618402538208833
Bond Position:  [7.07161793]


portfolio before change:  [6.81976386]
curr_Stock_Price:  98.6548941704219
curr_Factors:  [98.65489417 -0.77726167 -1.06582192]
mat_Sqrt:  [[15.61987676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00252335 -0.01252301 -0.00473559]
Stock Position:  0.0025233479818181468
Bond Position:  [6.57082323]


portfolio before change:  [6.82083113]
curr_Stock_Price:  98.75233387059235
curr_Factors:  [98.75233387 -0.95636175 -1.05503158]
mat_Sqrt:  [[13.213271    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00713026 -0.01374441  0.81450711]
Stock Position:  0.007130262537790035
Bond Position:  [6.11670107]


portfolio before change:  [6.82011586]
curr_Stock_Price:  98.54478021375138
curr_Factors:  [98.54478021 -0.97698754 -1.05151268]
mat_Sqrt:  [[12.96185547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00493378 -0.03541214  0.10283329]
Stock Position:  0.004933782081658329
Bond Position:  [6.33391739]


portfolio before change:  [6.82197042]
curr_Stock_Price:  98.76018828464163
curr_Factors:  [98.76018828 -1.25409499 -1.05479132]
mat_Sqrt:  [[ 9.81398354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207811 -0.03559102 -0.08442016]
Stock Position:  -0.002078106772797287
Bond Position:  [7.02720464]


portfolio before change:  [6.82208387]
curr_Stock_Price:  99.12831585651979
curr_Factors:  [99.12831586 -1.38696662 -1.05777394]
mat_Sqrt:  [[ 8.59924638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094469 -0.01841801  0.0570481 ]
Stock Position:  0.0009446892101594054
Bond Position:  [6.72843842]


portfolio before change:  [6.82327654]
curr_Stock_Price:  99.5004586282992
curr_Factors:  [99.50045863 -1.42616282 -1.0852067 ]
mat_Sqrt:  [[ 8.07516048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00637078 0.01183421 0.03905826]
Stock Position:  0.006370775563307027
Bond Position:  [6.18938145]


portfolio before change:  [6.82611456]
curr_Stock_Price:  99.82448576031501
curr_Factors:  [99.82448576 -1.35622157 -1.10860241]
mat_Sqrt:  [[ 8.48745778  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214506 -0.00524864 -0.19962629]
Stock Position:  -0.0021450567654137396
Bond Position:  [7.04024375]


portfolio before change:  [6.82640212]
curr_Stock_Price:  100.10071515149177
curr_Factors:  [100.10071515  -1.38691185  -1.0915206 ]
mat_Sqrt:  [[ 8.39590753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00561206  0.00760796 -0.13836319]
Stock Position:  -0.005612058692023999
Bond Position:  [7.38817321]


portfolio before change:  [6.82928667]
curr_Stock_Price:  99.7512949486006
curr_Factors:  [99.75129495 -1.32337221 -1.05582866]
mat_Sqrt:  [[ 9.23942057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0108745  -0.01075074  0.11439827]
Stock Position:  -0.010874503097744756
Bond Position:  [7.91403243]


portfolio before change:  [6.83263439]
curr_Stock_Price:  99.5344200179523
curr_Factors:  [99.53442002 -1.09534552 -1.06101009]
mat_Sqrt:  [[11.52072872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01513053 0.00162813 0.08633602]
Stock Position:  0.015130527860802134
Bond Position:  [5.32662607]


portfolio before change:  [6.82441877]
curr_Stock_Price:  98.94742892217457
curr_Factors:  [98.94742892 -0.88232512 -1.07977837]
mat_Sqrt:  [[13.90829174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00656527  0.003682    0.11865075]
Stock Position:  -0.006565271703101377
Bond Position:  [7.47403553]


portfolio before change:  [6.83326799]
curr_Stock_Price:  97.74185672536929
curr_Factors:  [97.74185673 -0.61503882 -1.11386725]
mat_Sqrt:  [[17.34707349  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0084478  -0.02184593 -0.22559705]
Stock Position:  -0.008447802474126402
Bond Position:  [7.65897189]


portfolio before change:  [6.83650983]
curr_Stock_Price:  97.4714424486881
curr_Factors:  [97.47144245 -0.42855394 -1.09915679]
mat_Sqrt:  [[21.15441648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0808138  0.31493195 0.39412634]
Stock Position:  0.08081379951759382
Bond Position:  [-1.04052778]


portfolio before change:  [6.70141385]
curr_Stock_Price:  95.8013575272465
curr_Factors:  [95.80135753 -0.22199661 -1.09449158]
mat_Sqrt:  [[25.68195642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0003235  -0.01173155  0.15499318]
Stock Position:  0.0003235044516384751
Bond Position:  [6.67042168]


portfolio before change:  [6.7025827]
curr_Stock_Price:  96.83688263776091
curr_Factors:  [96.83688264 -0.26870196 -1.10274095]
mat_Sqrt:  [[24.5714459   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00069543 -0.00473879 -0.17053327]
Stock Position:  0.0006954333396388509
Bond Position:  [6.63523911]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.70199221]
Stock Price:  94.79506556641637
PL:  [6.70199221]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-5.75323211e-03 -1.11495253e-01  7.14621119e-02]
 [ 1.19372857e+00  2.38447110e-01  3.41394013e-01]
 [-3.00173762e-01 -1.89833355e-01  3.85522636e-02]
 [ 2.45479867e-01  1.63559479e+00  1.53370051e+00]
 [-4.86004040e-02 -2.81499408e-02 -1.12126526e-02]
 [-3.16624149e-02  3.02892776e-01 -1.34407597e-01]
 [-1.03429091e-01  1.32628319e-01  4.10589132e-02]
 [-4.63078908e-02  8.73998300e-02  1.55050184e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-5.88151147e-02 -2.39280019e-02  1.29715299e-02]
 [ 8.15328217e-01  1.59426085e+00 -2.77408123e-01]
 [-8.10428148e-05  3.39296498e-02 -5.87501097e-02]
 [-3.22088663e-01 -6.32739965e-03 -6.58717134e-01]
 [ 1.78290134e+00 -3.43609021e+00  2.88600581e+00]
 [ 1.03162232e-02 -9.12004756e-02  3.51435518e-02]
 [ 1.16444471e-01 -1.41956584e-02 -2.31512571e-02]
 [-6.96266324e-02 -2.52031683e-02 -5.91366342e-02]
 [-2.68596799e-01 -1.74541662e+00 -1.98505865e-01]
 [-9.32792341e-03  3.83913731e-02  1.86510360e-01]
 [ 2.66612071e-01 -1.55472382e-01  4.06069580e-01]
 [ 5.76380505e-02 -9.87105849e-02  5.83139758e-03]
 [ 1.54089104e-01 -5.50722498e-02 -1.90540450e-02]
 [ 5.90658314e-02  1.55605059e-01  1.07009468e-01]
 [-1.19980217e-01  1.66831540e-02 -3.33460220e-03]
 [-1.55909990e-02 -1.23123525e-01  4.42499508e-02]
 [ 4.49124183e-02 -9.72288543e-03  8.52287776e-02]
 [ 4.91855900e-01 -9.43125479e-02  2.42772308e-01]
 [ 4.48876105e-02 -1.47470983e-01 -3.73718654e-02]
 [-9.24865314e-03 -7.46903867e-02 -2.70958437e-03]
 [ 1.34471158e-01 -5.14360562e-02  8.36834567e-02]
 [-1.70556418e-02 -3.59276056e-02 -5.29531378e-02]
 [-2.24939774e-02  2.23181793e-02 -5.34387728e-02]
 [-8.42248821e-02 -4.80934871e-02  1.74714003e-02]
 [ 2.48398534e-01  2.51236554e-02  5.35256963e-02]
 [ 6.30946867e-03 -2.00638886e-02  1.18459222e-02]
 [-1.03256274e-01 -3.85672920e-02 -1.04735570e-01]
 [ 2.37538976e+00  1.57973498e+00  1.81719031e-01]
 [-7.05385733e-02 -4.11537104e-02 -2.65184947e-02]
 [ 3.61761582e-02 -1.31633882e-02 -1.31749923e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.78349596]
curr_Stock_Price:  99.42805294556881
curr_Factors:  [99.42805295 -1.0038881  -1.01407493]
mat_Sqrt:  [[13.21656886  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010536  -0.03598494  0.20386151]
Stock Position:  -0.0010535989251806931
Bond Position:  [-1.67873867]


portfolio before change:  [-1.78489228]
curr_Stock_Price:  100.55416259313905
curr_Factors:  [100.55416259  -0.96247629  -1.01314573]
mat_Sqrt:  [[13.94435115  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0940946  0.07695847 0.97390209]
Stock Position:  0.09409460004300069
Bond Position:  [-11.24649599]


portfolio before change:  [-1.8742168]
curr_Stock_Price:  99.61979847345931
curr_Factors:  [99.61979847 -0.89018089 -1.00790788]
mat_Sqrt:  [[14.92850029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02217596 -0.06126845  0.10997888]
Stock Position:  -0.022175964024021406
Bond Position:  [0.33494827]


portfolio before change:  [-1.847471]
curr_Stock_Price:  98.41561526132564
curr_Factors:  [98.41561526 -0.92952688 -0.99690389]
mat_Sqrt:  [[14.33592639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06224987 0.52788595 4.37522066]
Stock Position:  0.062249870551448525
Bond Position:  [-7.97383031]


portfolio before change:  [-1.87270095]
curr_Stock_Price:  98.02632679351584
curr_Factors:  [98.02632679 -0.89851204 -0.9851901 ]
mat_Sqrt:  [[14.90257396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380037 -0.00908535 -0.03198658]
Stock Position:  -0.003800367632257859
Bond Position:  [-1.50016487]


portfolio before change:  [-1.87224788]
curr_Stock_Price:  97.85776178539338
curr_Factors:  [97.85776179 -1.0318856  -0.99141491]
mat_Sqrt:  [[12.93859238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.10956346e-04  9.77582231e-02 -3.83427464e-01]
Stock Position:  0.00021095634569775386
Bond Position:  [-1.89289159]


portfolio before change:  [-1.87247125]
curr_Stock_Price:  97.9205765144483
curr_Factors:  [97.92057651 -0.76858209 -1.00695444]
mat_Sqrt:  [[16.5870153   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00409811  0.04280561  0.11712965]
Stock Position:  -0.0040981051645841765
Bond Position:  [-1.47118243]


portfolio before change:  [-1.87175464]
curr_Stock_Price:  97.70083630482357
curr_Factors:  [97.7008363  -0.86448892 -1.0073657 ]
mat_Sqrt:  [[15.03010957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168346  0.02820817  0.0442315 ]
Stock Position:  -0.0016834558935379565
Bond Position:  [-1.70727959]


portfolio before change:  [-1.87370749]
curr_Stock_Price:  98.73408141356714
curr_Factors:  [98.73408141 -0.74036566 -1.01121981]
mat_Sqrt:  [[17.13022964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00303506  0.0064198  -0.11330016]
Stock Position:  0.0030350558294054463
Bond Position:  [-2.17337094]


portfolio before change:  [-1.8726795]
curr_Stock_Price:  99.16230368638486
curr_Factors:  [99.16230369 -0.82607385 -1.0128732 ]
mat_Sqrt:  [[15.76529327  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00387253 -0.00772273  0.03700416]
Stock Position:  -0.00387253152726451
Bond Position:  [-1.48867035]


portfolio before change:  [-1.87363031]
curr_Stock_Price:  99.35977701072719
curr_Factors:  [99.35977701 -1.1212041  -1.01637858]
mat_Sqrt:  [[11.71845199  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09251475  0.51454548 -0.79136816]
Stock Position:  0.09251474983843257
Bond Position:  [-11.06587523]


portfolio before change:  [-1.80617006]
curr_Stock_Price:  100.10391322167071
curr_Factors:  [100.10391322  -1.48407926  -1.00079005]
mat_Sqrt:  [[ 8.34230424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061704  0.01095075 -0.16759771]
Stock Position:  -0.0006170355130563622
Bond Position:  [-1.74440239]


portfolio before change:  [-1.80672299]
curr_Stock_Price:  100.64662010835745
curr_Factors:  [100.64662011  -1.42523889  -0.97276097]
mat_Sqrt:  [[ 9.14873582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05004411 -0.00204216 -1.87913663]
Stock Position:  -0.05004410655234856
Bond Position:  [3.23004719]


portfolio before change:  [-1.8228963]
curr_Stock_Price:  100.9778696289088
curr_Factors:  [100.97786963  -1.40123907  -0.95655786]
mat_Sqrt:  [[ 9.55538099  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.17483508 -1.10899335  8.23297128]
Stock Position:  0.17483508325671884
Bond Position:  [-19.47737054]


portfolio before change:  [-1.8584705]
curr_Stock_Price:  100.78832310142631
curr_Factors:  [100.7883231   -1.17139662  -0.94938136]
mat_Sqrt:  [[12.08837838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.31761390e-05 -2.94348269e-02  1.00254771e-01]
Stock Position:  -9.317613898589182e-05
Bond Position:  [-1.84907944]


portfolio before change:  [-1.85867078]
curr_Stock_Price:  100.45696107644977
curr_Factors:  [100.45696108  -1.32351504  -0.96764168]
mat_Sqrt:  [[10.16116057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01070951 -0.00458163 -0.06604409]
Stock Position:  0.01070951129104102
Bond Position:  [-2.93451574]


portfolio before change:  [-1.85890192]
curr_Stock_Price:  100.46963155343705
curr_Factors:  [100.46963155  -0.94148342  -0.96579975]
mat_Sqrt:  [[14.9180567   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0058213  -0.00813429 -0.16870036]
Stock Position:  -0.0058212959160550085
Bond Position:  [-1.27403847]


portfolio before change:  [-1.86371305]
curr_Stock_Price:  101.26874306650583
curr_Factors:  [101.26874307  -1.14052411  -0.96666969]
mat_Sqrt:  [[12.31211835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05404418 -0.56333079 -0.56628198]
Stock Position:  -0.054044177944970725
Bond Position:  [3.60927292]


portfolio before change:  [-1.87698574]
curr_Stock_Price:  101.52268121641062
curr_Factors:  [101.52268122  -1.2518522   -0.97179616]
mat_Sqrt:  [[10.98613331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00332965 0.01239076 0.53206214]
Stock Position:  0.003329647440871548
Bond Position:  [-2.21502048]


portfolio before change:  [-1.87494986]
curr_Stock_Price:  102.21728209632442
curr_Factors:  [102.2172821   -1.29281137  -0.95625715]
mat_Sqrt:  [[10.78366232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02946726 -0.0501785   1.15840348]
Stock Position:  0.02946726266226694
Bond Position:  [-4.88701336]


portfolio before change:  [-1.88386585]
curr_Stock_Price:  101.93544137566901
curr_Factors:  [101.93544138  -1.2027753   -0.96022568]
mat_Sqrt:  [[11.72049128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00330013 -0.0318587   0.01663535]
Stock Position:  0.0033001317849159694
Bond Position:  [-2.22026624]


portfolio before change:  [-1.88243836]
curr_Stock_Price:  102.45210068296022
curr_Factors:  [102.45210068  -1.40582495  -0.99004226]
mat_Sqrt:  [[ 9.33273553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01488933 -0.01777449 -0.05435589]
Stock Position:  0.014889325555048103
Bond Position:  [-3.40788104]


portfolio before change:  [-1.89208326]
curr_Stock_Price:  101.83293961201468
curr_Factors:  [101.83293961  -1.43012914  -0.98339872]
mat_Sqrt:  [[ 9.11394596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01236257 0.05022132 0.30526823]
Stock Position:  0.012362570260398047
Bond Position:  [-3.15100013]


portfolio before change:  [-1.89959825]
curr_Stock_Price:  101.25691949439262
curr_Factors:  [101.25691949  -1.29098055  -0.9606175 ]
mat_Sqrt:  [[10.65535931  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01100436  0.00538446 -0.00951269]
Stock Position:  -0.011004364284836204
Bond Position:  [-0.78533022]


portfolio before change:  [-1.90808275]
curr_Stock_Price:  102.01901097797969
curr_Factors:  [102.01901098  -1.36561206  -0.95874623]
mat_Sqrt:  [[ 9.98217385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317476 -0.03973795  0.12623279]
Stock Position:  -0.0031747593693725457
Bond Position:  [-1.58419694]


portfolio before change:  [-1.90818965]
curr_Stock_Price:  101.99030311504599
curr_Factors:  [101.99030312  -1.3980422   -0.96351186]
mat_Sqrt:  [[ 9.61499331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00627405 -0.00313805  0.24313398]
Stock Position:  0.006274054700804272
Bond Position:  [-2.54808239]


portfolio before change:  [-1.90828735]
curr_Stock_Price:  102.02550056617123
curr_Factors:  [102.02550057  -1.42862616  -0.98916642]
mat_Sqrt:  [[ 9.092321    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05742869 -0.03043924  0.69256182]
Stock Position:  0.05742869409695421
Bond Position:  [-7.76747861]


portfolio before change:  [-1.8947447]
curr_Stock_Price:  102.27822526632652
curr_Factors:  [102.27822527  -1.14589724  -1.01288292]
mat_Sqrt:  [[11.80964578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060601 -0.04759606 -0.10661153]
Stock Position:  0.0006060064973252971
Bond Position:  [-1.95672596]


portfolio before change:  [-1.89481428]
curr_Stock_Price:  102.56703319445839
curr_Factors:  [102.56703319  -1.23663144  -0.97743202]
mat_Sqrt:  [[11.20604214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223521 -0.02410622 -0.00772969]
Stock Position:  -0.002235209876355803
Bond Position:  [-1.66555544]


portfolio before change:  [-1.89459026]
curr_Stock_Price:  102.37366229986135
curr_Factors:  [102.3736623   -1.26325941  -0.97532922]
mat_Sqrt:  [[10.91393973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01292417 -0.01660092  0.23872561]
Stock Position:  0.01292417170883179
Bond Position:  [-3.21768505]


portfolio before change:  [-1.8998912]
curr_Stock_Price:  101.99462820498599
curr_Factors:  [101.9946282   -1.18295964  -0.99585003]
mat_Sqrt:  [[11.54336111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304923 -0.01159558 -0.15106056]
Stock Position:  -0.0030492286645943645
Bond Position:  [-1.58888626]


portfolio before change:  [-1.90042501]
curr_Stock_Price:  102.1045516915326
curr_Factors:  [102.10455169  -0.8864833   -0.99260663]
mat_Sqrt:  [[15.59432971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018498   0.00720316 -0.15244594]
Stock Position:  -0.0018498032585315511
Bond Position:  [-1.71155167]


portfolio before change:  [-1.90019398]
curr_Stock_Price:  101.86399399644546
curr_Factors:  [101.863994    -1.02582552  -0.99514138]
mat_Sqrt:  [[13.49975625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00670202 -0.01552211  0.04984104]
Stock Position:  -0.006702016524599216
Bond Position:  [-1.21749981]


portfolio before change:  [-1.8996157]
curr_Stock_Price:  101.75499965440304
curr_Factors:  [101.75499965  -0.85236527  -1.00473392]
mat_Sqrt:  [[15.88648541  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0166464  0.00810862 0.15269391]
Stock Position:  0.016646398443897755
Bond Position:  [-3.59346996]


portfolio before change:  [-1.90046115]
curr_Stock_Price:  101.73119583634512
curr_Factors:  [101.73119584  -0.82915021  -0.9874381 ]
mat_Sqrt:  [[16.53940452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028006 -0.00647559  0.03379312]
Stock Position:  0.00028005744099342055
Bond Position:  [-1.92895173]


portfolio before change:  [-1.90050977]
curr_Stock_Price:  102.41863393319771
curr_Factors:  [102.41863393  -0.80906748  -0.9495035 ]
mat_Sqrt:  [[17.64579813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00750931 -0.01244754 -0.29878143]
Stock Position:  -0.0075093145185083365
Bond Position:  [-1.13141603]


portfolio before change:  [-1.9025536]
curr_Stock_Price:  102.67197230288112
curr_Factors:  [102.6719723   -0.6513248   -0.94308389]
mat_Sqrt:  [[20.84534126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.13120174 0.50985727 0.51839381]
Stock Position:  0.13120174046810232
Bond Position:  [-15.37329506]


portfolio before change:  [-1.78703897]
curr_Stock_Price:  103.56705502861848
curr_Factors:  [103.56705503  -0.71221222  -0.94825815]
mat_Sqrt:  [[19.68287384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428556 -0.0132823  -0.07564988]
Stock Position:  -0.004285558351703602
Bond Position:  [-1.34319631]


portfolio before change:  [-1.78827709]
curr_Stock_Price:  103.81678037348624
curr_Factors:  [103.81678037  -0.64667058  -0.97625818]
mat_Sqrt:  [[20.48512186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.21982584e-04 -4.24846527e-03 -3.75845858e-01]
Stock Position:  0.0003219825841963418
Bond Position:  [-1.82170429]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.78887028]
Stock Price:  102.6817592052903
PL:  [-4.47062948]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 8.06444034e-02  1.04370622e-02 -1.27443670e-01]
 [ 1.18545404e+00  2.28412339e-01  3.41641635e-01]
 [-2.37172298e-01 -1.31841808e-01  3.67146007e-02]
 [ 1.76107399e-01  1.45521492e+00  1.14527411e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 3.15419089e-02 -7.63430729e-02  6.67211044e-02]
 [-1.36870770e-01  2.36540229e-01  9.39762555e-02]
 [ 4.60451510e-02  3.92025853e-02 -6.01354227e-03]
 [-8.04073576e-03  8.92346296e-02 -5.02515816e-02]
 [-2.56965624e-01 -1.46970867e-01 -1.23990835e-01]
 [ 6.52453314e-01  1.24420133e+00 -2.31055290e-01]
 [-7.56472476e-05  3.39879030e-02 -5.87675819e-02]
 [-3.99749613e-01 -1.62073397e-02 -8.37492558e-01]
 [ 1.95595450e+00 -3.76116034e+00  3.16597893e+00]
 [ 3.88107776e-02 -9.41852531e-02  1.56164987e-02]
 [ 9.64056129e-02 -1.69939912e-02 -1.09862804e-02]
 [-8.34558237e-02 -5.16018541e-02 -4.96673454e-02]
 [-2.62759917e-01 -1.69930913e+00 -1.93857662e-01]
 [-4.20692277e-02  1.90793379e-01  4.69407283e-01]
 [ 2.63323649e-01  1.55717384e-01  6.03574614e-01]
 [ 6.16821025e-02 -3.24550896e-01 -7.16869243e-02]
 [ 1.20772105e-01 -5.13775109e-02 -6.90728657e-03]
 [ 2.57541094e-03  1.30715226e-01  6.51939204e-02]
 [-2.18080405e-02 -1.17804740e-01 -7.58113629e-02]
 [ 8.99128251e-03 -5.88125796e-02  1.94802765e-02]
 [-1.55682037e-02 -3.74996195e-02  1.52810022e-01]
 [ 4.84562183e-01 -1.00530620e-01  2.33004086e-01]
 [ 8.49908340e-02 -2.13702911e-01 -1.04597920e-01]
 [-8.24350446e-03 -7.36653047e-02 -1.13001518e-03]
 [ 1.61304815e-01 -7.05936766e-02  7.84981852e-02]
 [-1.27473684e-02 -4.21899152e-02 -5.03691715e-02]
 [-2.95823115e-02  2.39854426e-02 -5.20216498e-02]
 [-3.65919087e-02  3.87462730e-04 -6.17238876e-02]
 [ 3.08385351e-01  3.67002084e-02  6.48966143e-02]
 [-9.93884406e-02 -8.90233154e-03  4.85688112e-02]
 [-1.08746174e-01 -5.01430420e-02 -9.40434572e-02]
 [ 2.90259247e+00  1.85956868e+00  1.92486819e-01]
 [-2.18728623e-02 -1.49805842e-01 -5.49271836e-02]
 [ 3.41844593e-02 -1.32890971e-02 -9.04052118e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.97046643]
curr_Stock_Price:  99.80386305854236
curr_Factors:  [99.80386306 -1.36481185 -1.00832916]
mat_Sqrt:  [[ 9.3004788   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00610297  0.00336855 -0.36356132]
Stock Position:  0.006102968538646213
Bond Position:  [0.3613666]


portfolio before change:  [0.9726224]
curr_Stock_Price:  100.1497269991665
curr_Factors:  [100.149727    -1.2996582   -1.03220949]
mat_Sqrt:  [[ 9.7259604   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.13384959 0.07371977 0.97460849]
Stock Position:  0.1338495912602513
Bond Position:  [-12.43237762]


portfolio before change:  [0.94032276]
curr_Stock_Price:  99.92002512713051
curr_Factors:  [99.92002513 -1.44477541 -1.04691031]
mat_Sqrt:  [[ 8.27041258  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03102506 -0.04255176  0.10473654]
Stock Position:  -0.03102506134190526
Bond Position:  [4.04034767]


portfolio before change:  [0.94405574]
curr_Stock_Price:  99.81598328527882
curr_Factors:  [99.81598329 -1.46075155 -1.02715919]
mat_Sqrt:  [[ 8.29304805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08524369 0.4696686  3.26714825]
Stock Position:  0.08524368789034906
Bond Position:  [-7.56462679]


portfolio before change:  [0.94125461]
curr_Stock_Price:  99.79421633745011
curr_Factors:  [99.79421634 -1.66984157 -1.01198158]
mat_Sqrt:  [[ 6.82974319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00858685 -0.01106097 -0.05874131]
Stock Position:  -0.008586853020319703
Bond Position:  [1.79817287]


portfolio before change:  [0.94365246]
curr_Stock_Price:  99.5411471426847
curr_Factors:  [99.54114714 -1.73668936 -1.0036359 ]
mat_Sqrt:  [[ 6.42531618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00460333 -0.02463962  0.19033674]
Stock Position:  0.004603327217798165
Bond Position:  [0.48543199]


portfolio before change:  [0.94359213]
curr_Stock_Price:  99.51485833333976
curr_Factors:  [99.51485833 -1.68596183 -0.96541329]
mat_Sqrt:  [[ 7.02118382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.009885    0.07634303  0.2680881 ]
Stock Position:  -0.00988499619684417
Bond Position:  [1.92729612]


portfolio before change:  [0.93662736]
curr_Stock_Price:  100.2438113610929
curr_Factors:  [100.24381136  -1.7569125   -0.9769171 ]
mat_Sqrt:  [[ 6.51284076  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00811011  0.01265258 -0.01715496]
Stock Position:  0.008110107091966108
Bond Position:  [0.12363931]


portfolio before change:  [0.9342268]
curr_Stock_Price:  99.94591052355847
curr_Factors:  [99.94591052 -1.78052088 -0.95620751]
mat_Sqrt:  [[ 6.47469017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.28738838e-05  2.88003529e-02 -1.43353775e-01]
Stock Position:  -1.2873883849698383e-05
Bond Position:  [0.9355135]


portfolio before change:  [0.93434127]
curr_Stock_Price:  100.13835226269053
curr_Factors:  [100.13835226  -1.98383486  -0.9436868 ]
mat_Sqrt:  [[ 5.36035979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05825643 -0.04743464 -0.35371134]
Stock Position:  -0.05825643474354818
Bond Position:  [6.76804466]


portfolio before change:  [0.9026547]
curr_Stock_Price:  100.69679066546946
curr_Factors:  [100.69679067  -2.08364142  -0.95589811]
mat_Sqrt:  [[ 4.81903836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.17830547  0.40156425 -0.65913643]
Stock Position:  0.17830546653414964
Bond Position:  [-17.05213354]


portfolio before change:  [0.83922684]
curr_Stock_Price:  100.35301989156322
curr_Factors:  [100.35301989  -2.1441472   -0.96884464]
mat_Sqrt:  [[ 4.46246958  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00115043  0.01096955 -0.16764755]
Stock Position:  -0.0011504342880070077
Bond Position:  [0.9546764]


portfolio before change:  [0.83932103]
curr_Stock_Price:  100.37488542478462
curr_Factors:  [100.37488542  -2.1737475   -0.94475808]
mat_Sqrt:  [[ 4.43889934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12931367 -0.0052309  -2.38913316]
Stock Position:  -0.129313672324659
Bond Position:  [13.81916607]


portfolio before change:  [0.84695634]
curr_Stock_Price:  100.32919954592926
curr_Factors:  [100.32919955  -2.07627803  -0.9350684 ]
mat_Sqrt:  [[ 4.93874054  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.37144361 -1.21390928  9.03165665]
Stock Position:  0.3714436084319214
Bond Position:  [-36.41968357]


portfolio before change:  [0.97896582]
curr_Stock_Price:  100.6968521853375
curr_Factors:  [100.69685219  -2.10420747  -0.90955058]
mat_Sqrt:  [[ 4.94489876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00460535 -0.03039816  0.04454952]
Stock Position:  0.004605351671769441
Bond Position:  [0.5152214]


portfolio before change:  [0.97941523]
curr_Stock_Price:  100.78045147285047
curr_Factors:  [100.78045147  -2.00848858  -0.90425358]
mat_Sqrt:  [[ 5.47505459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01656498 -0.00548479 -0.0313408 ]
Stock Position:  0.01656497892113825
Bond Position:  [-0.69001082]


portfolio before change:  [0.98046458]
curr_Stock_Price:  100.84900600093617
curr_Factors:  [100.849006    -2.03159058  -0.92386161]
mat_Sqrt:  [[ 5.24970675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01983488 -0.01665443 -0.14168711]
Stock Position:  -0.01983488171466892
Bond Position:  [2.98079268]


portfolio before change:  [0.97496835]
curr_Stock_Price:  101.14489136066078
curr_Factors:  [101.14489136  -2.12081325  -0.90970767]
mat_Sqrt:  [[ 4.88433495  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.13291492 -0.54844966 -0.55302195]
Stock Position:  -0.1329149162159341
Bond Position:  [14.41863311]


portfolio before change:  [0.97981299]
curr_Stock_Price:  101.12200306459239
curr_Factors:  [101.12200306  -2.04392052  -0.93033408]
mat_Sqrt:  [[ 5.16586799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01794348 0.0615783  1.33908832]
Stock Position:  0.01794348368169794
Bond Position:  [-0.83466802]


portfolio before change:  [0.97665551]
curr_Stock_Price:  100.9518502238309
curr_Factors:  [100.95185022  -1.76419004  -0.89977754]
mat_Sqrt:  [[ 7.03344123  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05947494 0.05025757 1.72183037]
Stock Position:  0.05947493775113306
Bond Position:  [-5.02744949]


portfolio before change:  [0.95058995]
curr_Stock_Price:  100.52415585000688
curr_Factors:  [100.52415585  -1.71213312  -0.9024587 ]
mat_Sqrt:  [[ 7.35813298  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026093  -0.10474835 -0.20450284]
Stock Position:  -0.00260930374550511
Bond Position:  [1.212888]


portfolio before change:  [0.9494768]
curr_Stock_Price:  101.0088702322612
curr_Factors:  [101.00887023  -1.71235321  -0.89308644]
mat_Sqrt:  [[ 7.46159113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01459136 -0.01658202 -0.01970457]
Stock Position:  0.014591361149615211
Bond Position:  [-0.5243801]


portfolio before change:  [0.9499455]
curr_Stock_Price:  101.04548442579548
curr_Factors:  [101.04548443  -1.62641589  -0.90266228]
mat_Sqrt:  [[ 8.05660773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00528327 0.04218816 0.18598011]
Stock Position:  0.00528326555225161
Bond Position:  [0.41609537]


portfolio before change:  [0.9500901]
curr_Stock_Price:  101.06300950322014
curr_Factors:  [101.0630095   -1.52825059  -0.89902887]
mat_Sqrt:  [[ 8.92150554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00687437 -0.03802132 -0.21626872]
Stock Position:  -0.006874373584677538
Bond Position:  [1.64483499]


portfolio before change:  [0.94878607]
curr_Stock_Price:  101.28261505105638
curr_Factors:  [101.28261505  -1.74522627  -0.89529723]
mat_Sqrt:  [[ 7.22387336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00013325 -0.01898168  0.05557181]
Stock Position:  0.00013325396584290309
Bond Position:  [0.93528976]


portfolio before change:  [0.94885504]
curr_Stock_Price:  100.92278625181925
curr_Factors:  [100.92278625  -1.62999988  -0.89085538]
mat_Sqrt:  [[ 8.11326576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098227 -0.01210295  0.43592446]
Stock Position:  0.000982271978569471
Bond Position:  [0.84972142]


portfolio before change:  [0.94948096]
curr_Stock_Price:  101.45186322516605
curr_Factors:  [101.45186323  -1.55208873  -0.88141988]
mat_Sqrt:  [[ 8.90021838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0574821  -0.03244612  0.6646958 ]
Stock Position:  0.05748209693599351
Bond Position:  [-4.88218488]


portfolio before change:  [0.978238]
curr_Stock_Price:  101.96275880107257
curr_Factors:  [101.9627588   -1.31546775  -0.89951262]
mat_Sqrt:  [[11.12981192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00179859 -0.06897232 -0.29838875]
Stock Position:  0.0017985882594287498
Bond Position:  [0.79484898]


portfolio before change:  [0.97893611]
curr_Stock_Price:  102.29565847154787
curr_Factors:  [102.29565847  -1.39690556  -0.88325054]
mat_Sqrt:  [[10.46159709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224737 -0.02377537 -0.00322362]
Stock Position:  -0.002247365769876182
Bond Position:  [1.20883187]


portfolio before change:  [0.97887669]
curr_Stock_Price:  102.38933957317822
curr_Factors:  [102.38933957  -1.45035635  -0.86439512]
mat_Sqrt:  [[10.11511803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01610642 -0.02278401  0.22393347]
Stock Position:  0.016106417697171395
Bond Position:  [-0.67024878]


portfolio before change:  [0.97759895]
curr_Stock_Price:  102.31521057009684
curr_Factors:  [102.31521057  -1.5711396   -0.85587052]
mat_Sqrt:  [[ 9.03447878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00350224 -0.01361674 -0.14368923]
Stock Position:  -0.003502239986570082
Bond Position:  [1.33593137]


portfolio before change:  [0.9761291]
curr_Stock_Price:  102.78258251956808
curr_Factors:  [102.78258252  -1.52618776  -0.83999796]
mat_Sqrt:  [[ 9.6449088   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036605   0.00774127 -0.14840329]
Stock Position:  -0.0036604989309786274
Bond Position:  [1.35236463]


portfolio before change:  [0.97624385]
curr_Stock_Price:  102.7974181051266
curr_Factors:  [102.79741811  -1.61592463  -0.81719588]
mat_Sqrt:  [[ 9.02176256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.44374269e-03  1.25053058e-04 -1.76081071e-01]
Stock Position:  -0.00544374269437564
Bond Position:  [1.53584655]


portfolio before change:  [0.97927984]
curr_Stock_Price:  102.27498403088208
curr_Factors:  [102.27498403  -1.48509559  -0.81641459]
mat_Sqrt:  [[10.23849791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0321457  0.01184494 0.18513198]
Stock Position:  0.032145703279851064
Bond Position:  [-2.30842145]


portfolio before change:  [0.98381425]
curr_Stock_Price:  102.42501899137801
curr_Factors:  [102.42501899  -1.58905446  -0.79266703]
mat_Sqrt:  [[ 9.46318991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00964702 -0.00287322  0.1385533 ]
Stock Position:  -0.009647017045179227
Bond Position:  [1.97191015]


portfolio before change:  [0.98834893]
curr_Stock_Price:  101.9805110769539
curr_Factors:  [101.98051108  -1.64454026  -0.78945132]
mat_Sqrt:  [[ 8.94227604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01545223 -0.0161836  -0.26827981]
Stock Position:  -0.015452231508354945
Bond Position:  [2.5641754]


portfolio before change:  [0.99144805]
curr_Stock_Price:  101.8006939618343
curr_Factors:  [101.80069396  -1.68186342  -0.80006467]
mat_Sqrt:  [[ 8.50869711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.39036136 0.60017321 0.54911132]
Stock Position:  0.39036135654830645
Bond Position:  [-38.74760895]


portfolio before change:  [1.03522948]
curr_Stock_Price:  101.92525852237274
curr_Factors:  [101.92525852  -1.72977197  -0.817924  ]
mat_Sqrt:  [[ 7.97685177  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00798107 -0.04834963 -0.15669197]
Stock Position:  -0.00798107047636139
Bond Position:  [1.84870216]


portfolio before change:  [1.03440496]
curr_Stock_Price:  102.05752415627897
curr_Factors:  [102.05752416  -1.77710653  -0.82892813]
mat_Sqrt:  [[ 7.53457147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00172776 -0.00428904 -0.25790091]
Stock Position:  0.0017277621169329372
Bond Position:  [0.85807384]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.03468352]
Stock Price:  102.15666425676207
PL:  [-1.12198074]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 6.77254786e-02 -2.35690032e-02 -9.59170872e-02]
 [ 1.09577007e+00  2.34571536e-01  3.19217338e-01]
 [-2.39575844e-01 -1.34054223e-01  3.67847087e-02]
 [ 1.41852357e-01  1.17711676e+00  9.25217068e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.08403116e-02 -6.37251885e-02  4.82998126e-02]
 [-4.28817255e-02 -5.04968561e-02 -4.56490839e-02]
 [ 3.90682647e-02  1.80731435e-01 -4.39071865e-02]
 [ 3.28225463e-02  4.50139543e-02 -4.35333303e-02]
 [-3.94283964e-02 -1.18896913e-02  2.63717013e-02]
 [ 9.29140789e-01  1.81620977e+00 -3.15508040e-01]
 [-2.20511903e-04  2.21641397e-03 -1.05981044e-02]
 [-3.91005845e-01 -6.32501192e-03 -8.34287922e-01]
 [ 1.95168052e+00 -3.06861412e+00  2.60108145e+00]
 [ 2.58498999e-02 -7.45055057e-02  1.10468859e-02]
 [ 3.35050294e-02  1.56703468e-01 -8.93599161e-02]
 [ 2.22781210e-02  1.10269548e-01 -1.37825685e-01]
 [-2.84103386e-01 -1.81999904e+00 -1.93548257e-01]
 [ 1.72038004e-02 -1.52607345e-01  4.04332753e-01]
 [ 1.38542408e-01  3.74456650e-01  4.35467371e-01]
 [ 2.78331536e-02 -1.92910883e-02  2.68081403e-02]
 [ 1.14472330e-01 -5.14459970e-02  3.51065097e-02]
 [-5.61188357e-02 -8.62843643e-02 -8.29776705e-02]
 [-2.07000308e-01  5.36781330e-02  3.12412909e-02]
 [ 8.29191122e-02  1.51961663e-02 -2.97451912e-02]
 [-3.44998588e-03 -5.10260118e-02  2.22241018e-01]
 [-6.24348055e-02 -1.36793122e-01 -8.25196299e-03]
 [-7.48794037e-02 -1.45544308e-03  8.18027231e-02]
 [ 9.50962648e-02  1.63484843e-02  8.43174650e-02]
 [-1.31566645e-01  1.14424282e-01 -1.64121208e-02]
 [ 6.34953311e-02 -1.95209289e-02 -7.03908832e-02]
 [ 5.44666506e-03 -1.91669692e-03 -5.35738787e-02]
 [-1.15972179e-02  3.36021919e-02  8.43437188e-02]
 [ 6.85051118e-03 -4.72987362e-02 -1.26916323e-02]
 [-8.55422145e-02  4.20302325e-02  5.45902819e-02]
 [-1.02064883e-01 -5.77581755e-02 -6.54144647e-02]
 [ 1.94245875e+00  1.24955936e+00  1.53304905e-01]
 [ 1.29050911e-01 -1.67199906e-01  5.16116718e-02]
 [ 2.99689252e-02 -1.51665371e-02 -1.97663553e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.96509739]
curr_Stock_Price:  99.93959198897899
curr_Factors:  [99.93959199 -1.2480838  -0.99147956]
mat_Sqrt:  [[10.64406617  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00407133 -0.00760686 -0.27362475]
Stock Position:  0.00407132779714762
Bond Position:  [1.55821055]


portfolio before change:  [1.96592247]
curr_Stock_Price:  100.09440641739637
curr_Factors:  [100.09440642  -1.12282841  -0.96736068]
mat_Sqrt:  [[12.37804964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09765769 0.07570764 0.91063821]
Stock Position:  0.09765769125858784
Bond Position:  [-7.80906616]


portfolio before change:  [1.95426172]
curr_Stock_Price:  99.98499813031489
curr_Factors:  [99.98499813 -1.27302574 -0.96747013]
mat_Sqrt:  [[10.63897651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02438495 -0.04326581  0.10493653]
Stock Position:  -0.024384949091994044
Bond Position:  [4.39239081]


portfolio before change:  [1.93987747]
curr_Stock_Price:  100.59739750839029
curr_Factors:  [100.59739751  -1.13152027  -0.98249149]
mat_Sqrt:  [[12.14739355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0470051  0.3799128  2.63938676]
Stock Position:  0.047005100388696756
Bond Position:  [-2.78871329]


portfolio before change:  [1.96561931]
curr_Stock_Price:  101.15245322263522
curr_Factors:  [101.15245322  -1.18937474  -0.99819844]
mat_Sqrt:  [[11.34816025  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00516789 -0.01106097 -0.05874131]
Stock Position:  -0.005167886216561193
Bond Position:  [2.48836368]


portfolio before change:  [1.96609011]
curr_Stock_Price:  101.1215449107739
curr_Factors:  [101.12154491  -1.08051544  -1.00350684]
mat_Sqrt:  [[12.58242418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0045851  -0.02056722  0.13778592]
Stock Position:  0.004585095774682453
Bond Position:  [1.50243814]


portfolio before change:  [1.96766936]
curr_Stock_Price:  101.42501301615624
curr_Factors:  [101.42501302  -0.93021362  -1.00993182]
mat_Sqrt:  [[14.57305539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428925 -0.01629779 -0.13022413]
Stock Position:  -0.004289246946028362
Bond Position:  [2.40270628]


portfolio before change:  [1.96863096]
curr_Stock_Price:  101.27084876867883
curr_Factors:  [101.27084877  -0.68942974  -1.01492827]
mat_Sqrt:  [[18.42006539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0036372   0.05833082 -0.12525498]
Stock Position:  0.003637196509259247
Bond Position:  [1.60028898]


portfolio before change:  [1.96667536]
curr_Stock_Price:  100.67818216198721
curr_Factors:  [100.67818216  -0.51126344  -1.00344945]
mat_Sqrt:  [[22.13624316  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0014964   0.01452819 -0.12418847]
Stock Position:  0.001496404660337288
Bond Position:  [1.81602006]


portfolio before change:  [1.96475206]
curr_Stock_Price:  99.24118775224476
curr_Factors:  [99.24118775 -0.63815746 -1.01769831]
mat_Sqrt:  [[18.94798055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192486 -0.00383738  0.07523112]
Stock Position:  -0.0019248630944196541
Bond Position:  [2.15577776]


portfolio before change:  [1.96487453]
curr_Stock_Price:  99.31756740119786
curr_Factors:  [99.3175674  -0.60732475 -1.03350521]
mat_Sqrt:  [[19.2496429   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06418146  0.58617918 -0.90005662]
Stock Position:  0.06418146315794107
Bond Position:  [-4.40947227]


portfolio before change:  [2.00974875]
curr_Stock_Price:  100.02533316268483
curr_Factors:  [100.02533316  -0.7869596   -1.02176099]
mat_Sqrt:  [[16.3905164   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00011784  0.00071534 -0.03023344]
Stock Position:  -0.00011783748913030621
Bond Position:  [2.02153548]


portfolio before change:  [2.0101798]
curr_Stock_Price:  98.51185996330115
curr_Factors:  [98.51185996 -0.94197853 -1.01644319]
mat_Sqrt:  [[13.8981429   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.04798861e-02 -2.04138882e-03 -2.37999122e+00]
Stock Position:  -0.040479886114291465
Bond Position:  [5.99792867]


portfolio before change:  [2.04508894]
curr_Stock_Price:  97.66799999188098
curr_Factors:  [97.66799999 -0.69976363 -1.02110881]
mat_Sqrt:  [[17.47378108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10623035 -0.99039095  7.42016138]
Stock Position:  0.10623034617221089
Bond Position:  [-8.33021651]


portfolio before change:  [2.10035175]
curr_Stock_Price:  98.19801946508866
curr_Factors:  [98.19801947 -0.99832907 -1.01659435]
mat_Sqrt:  [[13.09280226  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.000985   -0.02404655  0.03151369]
Stock Position:  0.0009850040562083544
Bond Position:  [2.00362631]


portfolio before change:  [2.10034921]
curr_Stock_Price:  97.94115838757799
curr_Factors:  [97.94115839 -1.38880188 -1.01265863]
mat_Sqrt:  [[ 8.87205425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00532588  0.05057583 -0.25491897]
Stock Position:  0.0053258775307022665
Bond Position:  [1.5787266]


portfolio before change:  [2.09850795]
curr_Stock_Price:  97.55838238928257
curr_Factors:  [97.55838239 -1.53485039 -0.99984657]
mat_Sqrt:  [[ 7.73498877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215298  0.03558934 -0.39317832]
Stock Position:  0.002152976365144598
Bond Position:  [1.88846706]


portfolio before change:  [2.09904369]
curr_Stock_Price:  97.69756903112727
curr_Factors:  [97.69756903 -1.576239   -1.02153151]
mat_Sqrt:  [[ 7.27254403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.095581   -0.58740216 -0.5521393 ]
Stock Position:  -0.09558099653410826
Bond Position:  [11.43707469]


portfolio before change:  [2.11706854]
curr_Stock_Price:  97.5239453223274
curr_Factors:  [97.52394532 -1.27667462 -1.04738958]
mat_Sqrt:  [[ 9.5451554   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00718553 -0.04925381  1.1534488 ]
Stock Position:  0.007185533531199756
Bond Position:  [1.41630696]


portfolio before change:  [2.11855203]
curr_Stock_Price:  97.70576108862937
curr_Factors:  [97.70576109 -1.39806275 -1.04352456]
mat_Sqrt:  [[ 8.50261035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03573814 0.12085536 1.2422672 ]
Stock Position:  0.035738137320093226
Bond Position:  [-1.37326988]


portfolio before change:  [2.11757218]
curr_Stock_Price:  97.68314706021266
curr_Factors:  [97.68314706 -1.25191326 -1.01210924]
mat_Sqrt:  [[10.15236354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00289268 -0.00622617  0.07647616]
Stock Position:  0.0028926826026730336
Bond Position:  [1.83500584]


portfolio before change:  [2.11809953]
curr_Stock_Price:  97.78615309608726
curr_Factors:  [97.7861531  -1.35857809 -0.97049493]
mat_Sqrt:  [[ 9.5230004   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01167038 -0.01660412  0.1001491 ]
Stock Position:  0.011670381386018645
Bond Position:  [0.97689783]


portfolio before change:  [2.11438207]
curr_Stock_Price:  97.45715043541917
curr_Factors:  [97.45715044 -1.4514607  -0.96798206]
mat_Sqrt:  [[ 8.67087789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01045676 -0.02784816 -0.2367122 ]
Stock Position:  -0.010456761706687204
Bond Position:  [3.13346826]


portfolio before change:  [2.11610691]
curr_Stock_Price:  97.32965968744028
curr_Factors:  [97.32965969 -1.24637361 -0.96207953]
mat_Sqrt:  [[10.69365559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01773633  0.01732454  0.08912271]
Stock Position:  -0.017736329876310238
Bond Position:  [3.84237786]


portfolio before change:  [2.12305257]
curr_Stock_Price:  96.96513516781599
curr_Factors:  [96.96513517 -1.08717507 -0.95979463]
mat_Sqrt:  [[12.52068134  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00638538  0.00490454 -0.08485475]
Stock Position:  0.0063853797378777164
Bond Position:  [1.50389336]


portfolio before change:  [2.11689309]
curr_Stock_Price:  95.97107054621925
curr_Factors:  [95.97107055 -1.06218696 -0.93957304]
mat_Sqrt:  [[12.96543275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00242947 -0.01646857  0.63399176]
Stock Position:  0.0024294700768513976
Bond Position:  [1.88373424]


portfolio before change:  [2.11801122]
curr_Stock_Price:  96.33438008846018
curr_Factors:  [96.33438009 -1.13355897 -0.9793089 ]
mat_Sqrt:  [[11.64593731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00790336 -0.04414979 -0.02354055]
Stock Position:  -0.007903357798878314
Bond Position:  [2.87937629]


portfolio before change:  [2.1142562]
curr_Stock_Price:  96.85503958376697
curr_Factors:  [96.85503958 -1.13908659 -0.98601447]
mat_Sqrt:  [[11.56651585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00505585 -0.00046974  0.2333604 ]
Stock Position:  -0.005055851269839889
Bond Position:  [2.60394088]


portfolio before change:  [2.11505768]
curr_Stock_Price:  96.76089902106169
curr_Factors:  [96.76089902 -1.28082685 -0.96704284]
mat_Sqrt:  [[10.22027286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01131522 0.00527645 0.24053426]
Stock Position:  0.011315218024177292
Bond Position:  [1.02018701]


portfolio before change:  [2.11343168]
curr_Stock_Price:  96.60592841722823
curr_Factors:  [96.60592842 -0.99246782 -0.959328  ]
mat_Sqrt:  [[13.71985831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00813128  0.03693028 -0.04681921]
Stock Position:  -0.008131279036824257
Bond Position:  [2.89896144]


portfolio before change:  [2.11649947]
curr_Stock_Price:  96.27321408156037
curr_Factors:  [96.27321408 -0.9429026  -0.96543087]
mat_Sqrt:  [[14.2799529   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316123 -0.00630035 -0.2008056 ]
Stock Position:  0.003161226064342204
Bond Position:  [1.81215807]


portfolio before change:  [2.11367997]
curr_Stock_Price:  95.30965241431815
curr_Factors:  [95.30965241 -0.85940157 -0.95081877]
mat_Sqrt:  [[15.59438252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037708 -0.00061861 -0.15283136]
Stock Position:  -0.0003770781730854288
Bond Position:  [2.14961916]


portfolio before change:  [2.1138022]
curr_Stock_Price:  95.69811923310982
curr_Factors:  [95.69811923 -0.66413894 -0.96396289]
mat_Sqrt:  [[18.78571638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00066425 0.01084506 0.24060915]
Stock Position:  0.0006642488374852861
Bond Position:  [2.05023484]


portfolio before change:  [2.11377187]
curr_Stock_Price:  95.26660481955375
curr_Factors:  [95.26660482 -0.72020217 -0.95509968]
mat_Sqrt:  [[17.83882888  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030243 -0.0152656  -0.03620569]
Stock Position:  -0.0003024285706807056
Bond Position:  [2.14258321]


portfolio before change:  [2.11416512]
curr_Stock_Price:  94.85192757415571
curr_Factors:  [94.85192757 -1.09895248 -0.96541099]
mat_Sqrt:  [[12.03661856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00546828  0.0135652   0.15573088]
Stock Position:  -0.005468282826564866
Bond Position:  [2.63284228]


portfolio before change:  [2.11331641]
curr_Stock_Price:  95.06732091648458
curr_Factors:  [95.06732092 -1.34025834 -0.95476548]
mat_Sqrt:  [[ 9.57888756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01327998 -0.01864137 -0.18660926]
Stock Position:  -0.01327997556187673
Bond Position:  [3.37580811]


portfolio before change:  [2.11002348]
curr_Stock_Price:  95.34706047272331
curr_Factors:  [95.34706047 -1.39857002 -0.94882018]
mat_Sqrt:  [[ 9.11693158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.2444701  0.40329355 0.43733622]
Stock Position:  0.24447010449236428
Bond Position:  [-21.19948236]


portfolio before change:  [1.91836445]
curr_Stock_Price:  94.57392329757927
curr_Factors:  [94.5739233  -1.41824204 -0.98191818]
mat_Sqrt:  [[ 8.57817826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01229358 -0.05396354  0.14723373]
Stock Position:  0.012293584787288163
Bond Position:  [0.75571191]


portfolio before change:  [1.91621695]
curr_Stock_Price:  94.39155393397
curr_Factors:  [94.39155393 -1.16484766 -0.97159577]
mat_Sqrt:  [[11.14519166  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00204916 -0.00489498 -0.05638791]
Stock Position:  0.002049159770777034
Bond Position:  [1.72279357]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.91657947]
Stock Price:  94.46336817920239
PL:  [1.91657947]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-1.48420563e-02 -9.42736129e-02  1.28153772e-01]
 [ 9.80868220e-01  2.26228707e-01  2.77125813e-01]
 [ 1.83666948e-02  1.14647224e-01  3.49030800e-02]
 [ 1.18921886e-01  1.00627092e+00  7.77937309e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 7.47034984e-02 -2.55967305e-02  3.77333870e-02]
 [-3.21888650e-02 -1.19266517e-01  2.13006366e-03]
 [ 1.58440123e-01  5.04548208e-02 -1.43777098e-01]
 [ 9.88999588e-03  6.98306801e-02 -4.73036255e-02]
 [-1.91534184e-01 -1.06340783e-01 -7.87643817e-02]
 [ 8.29601423e-01  1.59673738e+00 -2.88574975e-01]
 [-6.62017473e-06  8.58649555e-03 -5.78620498e-02]
 [-1.42803808e-01 -8.84164445e-03 -3.17348136e-01]
 [ 1.69788727e+00 -3.22196548e+00  2.70409712e+00]
 [ 4.96259829e-03 -9.21029656e-02  3.56986752e-02]
 [ 1.23485895e-01 -4.74535166e-02 -8.87451796e-04]
 [-1.52282789e-01 -2.03841934e-01 -2.86149843e-02]
 [-2.65483064e-01 -1.73304473e+00 -2.00442115e-01]
 [ 1.30094623e-03  3.72499194e-02  5.83893053e-02]
 [ 1.26131028e-01  1.83421967e-02  2.75150446e-01]
 [ 3.34977088e-02 -4.90319721e-02  7.56967257e-02]
 [ 1.09892387e-01 -5.09717162e-02  2.71707852e-02]
 [ 4.87023104e-02 -2.65675906e-02 -2.43227457e-02]
 [-1.29038060e-01 -3.74073454e-03  5.93204393e-02]
 [ 8.84346782e-02  1.48022412e-02 -3.16766553e-02]
 [-6.73867320e-03 -5.16033999e-02  2.17912351e-01]
 [-1.96439426e-01 -1.46491976e-01 -6.93230817e-02]
 [-1.29821200e-01  7.12810120e-02  1.55979221e-01]
 [ 1.07368581e-01  4.35886737e-02  1.29648802e-01]
 [-1.44798387e-01  1.18655136e-01 -2.10584308e-02]
 [ 7.95955103e-02 -1.21227614e-02 -4.70763943e-02]
 [ 4.66933299e-02 -2.04097170e-03 -6.47757068e-02]
 [ 9.21886593e-02  9.63672488e-02  1.38936858e-01]
 [ 1.92223790e-03 -2.31497138e-02  3.89119130e-02]
 [-9.12530268e-02  1.11631049e-01  3.55466194e-02]
 [-8.23475830e-02 -4.69245190e-02 -4.65272152e-02]
 [ 1.71243522e+00  1.10702574e+00  1.44621594e-01]
 [ 1.79705686e-01 -3.09317990e-01  9.13069479e-02]
 [ 2.54486834e-02 -1.44955700e-02  2.07375065e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.08278819]
curr_Stock_Price:  99.81919066491366
curr_Factors:  [99.81919066 -0.92484595 -1.00640926]
mat_Sqrt:  [[14.47040095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054776 -0.03042668  0.36558704]
Stock Position:  -0.0005477593780578724
Bond Position:  [1.13746509]


portfolio before change:  [1.08278087]
curr_Stock_Price:  100.09214788471546
curr_Factors:  [100.09214788  -0.88650227  -0.98598432]
mat_Sqrt:  [[15.38825651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07041831 0.073015   0.79056281]
Stock Position:  0.07041831091202265
Bond Position:  [-5.96553912]


portfolio before change:  [1.16861746]
curr_Stock_Price:  101.32169070466709
curr_Factors:  [101.3216907   -0.87377881  -0.98013108]
mat_Sqrt:  [[15.86936663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.003081   0.03700223 0.09956877]
Stock Position:  0.00308100025754779
Bond Position:  [0.8564453]


portfolio before change:  [1.16798247]
curr_Stock_Price:  101.08084281065759
curr_Factors:  [101.08084281  -1.04175404  -0.9844541 ]
mat_Sqrt:  [[13.32593962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03625424 0.32477254 2.21923861]
Stock Position:  0.03625424389986481
Bond Position:  [-2.49662706]


portfolio before change:  [1.1724596]
curr_Stock_Price:  101.21294420250032
curr_Factors:  [101.2129442   -1.01187822  -1.0045481 ]
mat_Sqrt:  [[13.47451777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435236 -0.01106097 -0.05874131]
Stock Position:  -0.004352363620420284
Bond Position:  [1.61297514]


portfolio before change:  [1.1687247]
curr_Stock_Price:  102.117405161147
curr_Factors:  [102.11740516  -0.93469675  -0.97653564]
mat_Sqrt:  [[15.10296066  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00511031 -0.00826131  0.10764285]
Stock Position:  0.0051103147732672665
Bond Position:  [0.64687261]


portfolio before change:  [1.16998889]
curr_Stock_Price:  102.34896181077474
curr_Factors:  [102.34896181  -1.17557176  -0.97883172]
mat_Sqrt:  [[11.86964959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00472628 -0.0384931   0.00607648]
Stock Position:  -0.004726276290381664
Bond Position:  [1.65371836]


portfolio before change:  [1.16945608]
curr_Stock_Price:  102.5054349374864
curr_Factors:  [102.50543494  -1.33810406  -0.96642918]
mat_Sqrt:  [[10.23059331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0136249   0.01628422 -0.41015604]
Stock Position:  0.013624898232397372
Bond Position:  [-0.22717004]


portfolio before change:  [1.16529313]
curr_Stock_Price:  102.20197913171995
curr_Factors:  [102.20197913  -1.11130784  -0.97937676]
mat_Sqrt:  [[12.63241904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114692  0.02253776 -0.13494408]
Stock Position:  0.0011469150602680402
Bond Position:  [1.04807614]


portfolio before change:  [1.16490249]
curr_Stock_Price:  101.74714868303359
curr_Factors:  [101.74714868  -0.83201036  -0.96007297]
mat_Sqrt:  [[16.9523671   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01352723 -0.03432134 -0.22469286]
Stock Position:  -0.013527232895390371
Bond Position:  [2.54125987]


portfolio before change:  [1.17481718]
curr_Stock_Price:  101.03769016798594
curr_Factors:  [101.03769017  -0.80855469  -0.94815412]
mat_Sqrt:  [[17.44032062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06287894  0.51534477 -0.82322408]
Stock Position:  0.06287894470992102
Bond Position:  [-5.17832615]


portfolio before change:  [1.20858897]
curr_Stock_Price:  101.58507725311551
curr_Factors:  [101.58507725  -0.76033471  -0.94461987]
mat_Sqrt:  [[18.46620072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054505  0.00277128 -0.16506432]
Stock Position:  -0.0005450471761807972
Bond Position:  [1.26395763]


portfolio before change:  [1.20825615]
curr_Stock_Price:  102.48559786922372
curr_Factors:  [102.48559787  -0.96144689  -0.9603205 ]
mat_Sqrt:  [[14.99857047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01396047 -0.00285363 -0.9053059 ]
Stock Position:  -0.013960465020799511
Bond Position:  [2.63900275]


portfolio before change:  [1.22877462]
curr_Stock_Price:  101.03947300514507
curr_Factors:  [101.03947301  -0.96116675  -0.9427859 ]
mat_Sqrt:  [[15.05271869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10577344 -1.03988489  7.71403641]
Stock Position:  0.10577343970089284
Bond Position:  [-9.45851798]


portfolio before change:  [1.24676304]
curr_Stock_Price:  101.22071701926215
curr_Factors:  [101.22071702  -1.21002232  -0.9142017 ]
mat_Sqrt:  [[12.09847526  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054146 -0.0297261   0.10183838]
Stock Position:  -0.0005414632134350169
Bond Position:  [1.30157033]


portfolio before change:  [1.24661757]
curr_Stock_Price:  101.78987265754293
curr_Factors:  [101.78987266  -1.09125233  -0.93616677]
mat_Sqrt:  [[13.40317353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00847697 -0.01531556 -0.00253165]
Stock Position:  0.008476972736274107
Bond Position:  [0.38374759]


portfolio before change:  [1.25543383]
curr_Stock_Price:  102.8242383325913
curr_Factors:  [102.82423833  -0.98783204  -0.93084144]
mat_Sqrt:  [[15.0947594   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01323193 -0.0657897  -0.08163059]
Stock Position:  -0.013231933917932193
Bond Position:  [2.61599735]


portfolio before change:  [1.26407492]
curr_Stock_Price:  102.19590449055869
curr_Factors:  [102.19590449  -0.85720476  -0.95139651]
mat_Sqrt:  [[16.74819234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03941646 -0.55933778 -0.57180556]
Stock Position:  -0.039416457592436165
Bond Position:  [5.29227545]


portfolio before change:  [1.2802742]
curr_Stock_Price:  101.80171124870103
curr_Factors:  [101.80171125  -0.44338682  -0.95338889]
mat_Sqrt:  [[25.18506614  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00082681 0.01202236 0.16656844]
Stock Position:  0.0008268082802052591
Bond Position:  [1.1961037]


portfolio before change:  [1.27894969]
curr_Stock_Price:  100.01892206380575
curr_Factors:  [100.01892206  -0.55305687  -0.94704827]
mat_Sqrt:  [[22.31489194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00833703 0.00591992 0.78492763]
Stock Position:  0.008337031768150002
Bond Position:  [0.44508876]


portfolio before change:  [1.27129759]
curr_Stock_Price:  99.0944035647999
curr_Factors:  [99.09440356 -0.71142355 -0.94343488]
mat_Sqrt:  [[18.9388344   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00205613 -0.015825    0.21594169]
Stock Position:  0.002056125949023844
Bond Position:  [1.06754702]


portfolio before change:  [1.27038149]
curr_Stock_Price:  98.58395268661619
curr_Factors:  [98.58395269 -0.97674704 -0.93961709]
mat_Sqrt:  [[14.50573907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00724086 -0.01645105  0.07751069]
Stock Position:  0.007240861111741043
Bond Position:  [0.55654878]


portfolio before change:  [1.2682244]
curr_Stock_Price:  98.27643815773745
curr_Factors:  [98.27643816 -0.84588001 -0.9524555 ]
mat_Sqrt:  [[16.27204812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235461 -0.00857465 -0.06938602]
Stock Position:  0.002354612260651443
Bond Position:  [1.03682149]


portfolio before change:  [1.26443846]
curr_Stock_Price:  96.61351026562181
curr_Factors:  [96.61351027 -0.91173038 -0.92652382]
mat_Sqrt:  [[15.37071979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00765695 -0.00120732  0.1692247 ]
Stock Position:  -0.007656954349464369
Bond Position:  [2.00420369]


portfolio before change:  [1.2646037]
curr_Stock_Price:  96.62465038207348
curr_Factors:  [96.62465038 -0.95568443 -0.94084426]
mat_Sqrt:  [[14.50227009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00586048  0.0047774  -0.09036468]
Stock Position:  0.0058604757966791085
Bond Position:  [0.69833727]


portfolio before change:  [1.26011317]
curr_Stock_Price:  95.84351438827798
curr_Factors:  [95.84351439 -1.07968839 -0.92786984]
mat_Sqrt:  [[12.8733408   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00211359 -0.01665493  0.62164328]
Stock Position:  0.0021135927075025414
Bond Position:  [1.05753901]


portfolio before change:  [1.25888285]
curr_Stock_Price:  95.19886829396707
curr_Factors:  [95.19886829 -0.86887438 -0.93257115]
mat_Sqrt:  [[15.71353629  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0153048  -0.04728008 -0.19775946]
Stock Position:  -0.015304797456441793
Bond Position:  [2.71588225]


portfolio before change:  [1.25114634]
curr_Stock_Price:  95.72654670543228
curr_Factors:  [95.72654671 -1.05016478 -0.91644685]
mat_Sqrt:  [[13.39503378  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00622857  0.02300585  0.4449653 ]
Stock Position:  -0.006228569531170899
Bond Position:  [1.8473858]


portfolio before change:  [1.25007447]
curr_Stock_Price:  95.93571449483419
curr_Factors:  [95.93571449 -1.05731354 -0.92619933]
mat_Sqrt:  [[13.1993219   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01081347 0.01406818 0.36985194]
Stock Position:  0.010813474634657348
Bond Position:  [0.21267605]


portfolio before change:  [1.25277406]
curr_Stock_Price:  96.18290640966363
curr_Factors:  [96.18290641 -1.19066966 -0.92865322]
mat_Sqrt:  [[11.55281084  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01080919  0.03829578 -0.06007384]
Stock Position:  -0.010809191394810208
Bond Position:  [2.2924335]


portfolio before change:  [1.26128367]
curr_Stock_Price:  95.42216075074893
curr_Factors:  [95.42216075 -0.84673575 -0.94029889]
mat_Sqrt:  [[15.97901353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00422501 -0.0039126  -0.13429585]
Stock Position:  0.00422501258304962
Bond Position:  [0.85812384]


portfolio before change:  [1.25707955]
curr_Stock_Price:  94.40171549689471
curr_Factors:  [94.4017155  -0.61139194 -0.94462872]
mat_Sqrt:  [[19.91630187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165967 -0.00065872 -0.18478706]
Stock Position:  0.0016596671763965103
Bond Position:  [1.10040412]


portfolio before change:  [1.25458366]
curr_Stock_Price:  92.81498062837106
curr_Factors:  [92.81498063 -0.61931719 -0.96068759]
mat_Sqrt:  [[19.11748344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00733464 0.0311024  0.39634818]
Stock Position:  0.007334642619897772
Bond Position:  [0.57381895]


portfolio before change:  [1.24729205]
curr_Stock_Price:  91.81106860810927
curr_Factors:  [91.81106861 -0.73814141 -0.93373438]
mat_Sqrt:  [[17.25077507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00029794 -0.00747154  0.11100486]
Stock Position:  0.0002979392707669714
Bond Position:  [1.21993793]


portfolio before change:  [1.24742799]
curr_Stock_Price:  91.7554806249067
curr_Factors:  [91.75548062 -0.51013471 -0.93793721]
mat_Sqrt:  [[21.5646478   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283847  0.03602877  0.10140461]
Stock Position:  -0.0028384656021410997
Bond Position:  [1.50787277]


portfolio before change:  [1.25165299]
curr_Stock_Price:  90.33340915772428
curr_Factors:  [90.33340916 -0.24913622 -0.9533631 ]
mat_Sqrt:  [[27.1399836   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00373704 -0.01514482 -0.13272919]
Stock Position:  -0.003737044939476401
Bond Position:  [1.589233]


portfolio before change:  [1.24462111]
curr_Stock_Price:  92.26824060912482
curr_Factors:  [ 9.22682406e+01  5.13767691e-02 -9.58908844e-01]
mat_Sqrt:  [[37.23197439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05285582 0.35729102 0.41256515]
Stock Position:  0.05285582344496438
Bond Position:  [-3.63229273]


portfolio before change:  [1.15454487]
curr_Stock_Price:  90.57264379079554
curr_Factors:  [ 9.05726438e+01 -1.10081010e-02 -9.46298055e-01]
mat_Sqrt:  [[34.77316841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00388818 -0.09983195  0.26047331]
Stock Position:  0.0038881808629740817
Bond Position:  [0.80238205]


portfolio before change:  [1.15272207]
curr_Stock_Price:  90.07803925303024
curr_Factors:  [ 9.00780393e+01  5.53467941e-03 -9.47152287e-01]
mat_Sqrt:  [[35.13011676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00076068 -0.00467843  0.05915833]
Stock Position:  0.0007606810298496149
Bond Position:  [1.08420141]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.15368727]
Stock Price:  91.1687326944113
PL:  [1.15368727]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-1.60253272e-02 -1.05741355e-01  1.21857799e-01]
 [ 3.16729248e-01  1.95159687e-01  7.28172378e-02]
 [-5.13276578e-01 -3.90262744e-01  4.43205771e-02]
 [ 2.42472474e-01  1.53748224e+00  1.49973167e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-9.94160739e-03  1.89961816e-01 -7.34735127e-02]
 [-1.41597644e-01  2.49766715e-01  1.03080740e-01]
 [-6.22416515e-02  1.20594542e-01  2.04996112e-03]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-8.22538460e-02 -3.84824366e-02 -3.22940779e-03]
 [ 5.83930058e-01  1.24756307e+00 -1.73602709e-01]
 [-2.05019186e-04  2.86529497e-02 -2.67029360e-02]
 [-4.30803731e-01 -1.46003805e-02 -8.94560219e-01]
 [ 2.02220703e+00 -3.49269225e+00  2.95287791e+00]
 [ 2.85825647e-02 -7.31994504e-02  9.41307706e-03]
 [ 6.85992268e-02  9.50818218e-02 -6.43643692e-02]
 [-1.24067859e-02  8.54055551e-02 -9.81771695e-02]
 [-2.81352821e-01 -1.80875492e+00 -1.95144806e-01]
 [ 3.41536245e-03 -6.16401700e-02  3.14676989e-01]
 [ 1.67828539e-01  2.42985885e-01  4.34950694e-01]
 [ 3.15486737e-02 -6.79708288e-02  1.66915683e-02]
 [ 1.11153399e-01 -5.10946990e-02  2.77559497e-02]
 [-6.13850453e-02 -8.01950569e-02 -7.74557710e-02]
 [-1.54239623e-01  2.59572364e-02 -3.59092618e-02]
 [ 6.27448022e-02  4.26440096e-03 -1.75441576e-02]
 [ 2.18187841e-02 -4.65896251e-02  2.55500517e-01]
 [ 1.82422101e-01 -1.11250666e-01  8.87680329e-02]
 [-2.10003491e-02 -8.31426676e-02  4.55813762e-03]
 [ 9.00354744e-02  1.49621017e-02  8.76271854e-02]
 [-1.02846926e-01  1.05241143e-01 -6.32722721e-03]
 [ 6.40184950e-02 -2.00002510e-02 -7.66398322e-02]
 [-7.94009450e-02  7.92919632e-03 -3.34904546e-02]
 [-1.14340226e-01 -9.60573966e-03  5.70464963e-02]
 [-1.39822355e-02 -3.51963901e-02 -8.98531217e-03]
 [-8.55561576e-02 -1.67994740e-03  6.28922057e-02]
 [-1.12340220e-01 -6.40731235e-02 -7.51740017e-02]
 [ 2.09673563e+00  1.34866337e+00  1.59812517e-01]
 [ 6.80590851e-02 -1.90794855e-01 -1.96150304e-02]
 [ 3.21466935e-02 -1.44341388e-02 -5.52202161e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.6331658]
curr_Stock_Price:  99.03918244027639
curr_Factors:  [99.03918244 -0.97595515 -1.0046824 ]
mat_Sqrt:  [[13.66554908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093195 -0.03412788  0.34762638]
Stock Position:  -0.0009319473232392171
Bond Position:  [-4.5408665]


portfolio before change:  [-4.63344331]
curr_Stock_Price:  98.72786089013336
curr_Factors:  [98.72786089 -0.71389717 -1.01504805]
mat_Sqrt:  [[17.52138192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02119866 0.06298752 0.20772731]
Stock Position:  0.021198659473013314
Bond Position:  [-6.72634162]


portfolio before change:  [-4.65387865]
curr_Stock_Price:  97.80353401451076
curr_Factors:  [97.80353401 -0.75885932 -1.00946903]
mat_Sqrt:  [[16.68703994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03499073 -0.12595676  0.12643427]
Stock Position:  -0.03499073104930916
Bond Position:  [-1.23166149]


portfolio before change:  [-4.67633985]
curr_Stock_Price:  98.4410524152465
curr_Factors:  [98.44105242 -0.80034131 -1.02633296]
mat_Sqrt:  [[15.84388548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05443369 0.49622026 4.27831702]
Stock Position:  0.05443369119235932
Bond Position:  [-10.0348497]


portfolio before change:  [-4.63920862]
curr_Stock_Price:  99.14623445135163
curr_Factors:  [99.14623445 -0.86261621 -1.02108086]
mat_Sqrt:  [[15.07290576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389082 -0.01106097 -0.05874131]
Stock Position:  -0.0038908225046593446
Bond Position:  [-4.25344822]


portfolio before change:  [-4.63833888]
curr_Stock_Price:  98.78603742381085
curr_Factors:  [98.78603742 -0.99601469 -1.01926084]
mat_Sqrt:  [[13.16656609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00105088  0.06130991 -0.20959948]
Stock Position:  0.0010508790185391123
Bond Position:  [-4.74215105]


portfolio before change:  [-4.63936308]
curr_Stock_Price:  98.37552497456156
curr_Factors:  [98.37552497 -1.13274136 -1.02644562]
mat_Sqrt:  [[11.35439699  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0061274   0.08061186  0.29406066]
Stock Position:  -0.006127402370264259
Bond Position:  [-4.03657666]


portfolio before change:  [-4.63914231]
curr_Stock_Price:  98.25714248629711
curr_Factors:  [98.25714249 -1.13597347 -1.0097372 ]
mat_Sqrt:  [[11.49459901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323691  0.03892172  0.00584797]
Stock Position:  -0.0032369069201312727
Bond Position:  [-4.32109308]


portfolio before change:  [-4.63796862]
curr_Stock_Price:  97.72766833589147
curr_Factors:  [97.72766834 -1.26312102 -0.97973317]
mat_Sqrt:  [[10.37428891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00501154  0.0064198  -0.11330016]
Stock Position:  0.005011543806361633
Bond Position:  [-5.12773511]


portfolio before change:  [-4.63775468]
curr_Stock_Price:  97.8982637500554
curr_Factors:  [97.89826375 -1.36548009 -0.97236048]
mat_Sqrt:  [[ 9.45069464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0096044  -0.01242015 -0.0092126 ]
Stock Position:  -0.009604398836702827
Bond Position:  [-3.69750071]


portfolio before change:  [-4.63071619]
curr_Stock_Price:  97.11729753841418
curr_Factors:  [97.11729754 -1.52744397 -0.94965122]
mat_Sqrt:  [[ 8.15657467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09846674  0.40264925 -0.49524021]
Stock Position:  0.09846673783074311
Bond Position:  [-14.19353966]


portfolio before change:  [-4.55614656]
curr_Stock_Price:  97.89262462011972
curr_Factors:  [97.89262462 -1.58130891 -0.96574514]
mat_Sqrt:  [[ 7.66617012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.51788961e-05  9.24769975e-03 -7.61760437e-02]
Stock Position:  2.5178896112958457e-05
Bond Position:  [-4.55861139]


portfolio before change:  [-4.55670505]
curr_Stock_Price:  98.34440463482382
curr_Factors:  [98.34440463 -1.55845706 -1.00953013]
mat_Sqrt:  [[ 7.54200799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08172696 -0.00471225 -2.55193131]
Stock Position:  -0.08172695681684616
Bond Position:  [3.48068386]


portfolio before change:  [-4.5774933]
curr_Stock_Price:  98.60409083555936
curr_Factors:  [98.60409084 -1.51373696 -0.99120285]
mat_Sqrt:  [[ 8.05403288  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.23739882 -1.12726157  8.42373875]
Stock Position:  0.23739881849835498
Bond Position:  [-27.98598796]


portfolio before change:  [-4.51119373]
curr_Stock_Price:  98.89810254766647
curr_Factors:  [98.89810255 -1.3946908  -0.99392814]
mat_Sqrt:  [[ 9.07452567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171494 -0.02362502  0.02685289]
Stock Position:  0.0017149354447001386
Bond Position:  [-4.68079759]


portfolio before change:  [-4.51185451]
curr_Stock_Price:  98.85399598929521
curr_Factors:  [98.85399599 -1.2813415  -0.99985151]
mat_Sqrt:  [[10.09914691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00741344  0.03068753 -0.18361363]
Stock Position:  0.0074134381044674205
Bond Position:  [-5.24470249]


portfolio before change:  [-4.51725047]
curr_Stock_Price:  98.21457089275886
curr_Factors:  [98.21457089 -1.32112635 -1.00270218]
mat_Sqrt:  [[ 9.61501608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156149  0.02756452 -0.28007214]
Stock Position:  -0.001561493051935536
Bond Position:  [-4.3638891]


portfolio before change:  [-4.5182207]
curr_Stock_Price:  98.48655509714642
curr_Factors:  [98.4865551  -1.27723161 -0.98604651]
mat_Sqrt:  [[10.24348535  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06739866 -0.58377314 -0.55669381]
Stock Position:  -0.06739865556338916
Bond Position:  [2.11964071]


portfolio before change:  [-4.56069684]
curr_Stock_Price:  99.12070885465042
curr_Factors:  [99.12070885 -1.31689487 -0.96167951]
mat_Sqrt:  [[10.15294695  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00542368 -0.01989428  0.89768586]
Stock Position:  0.005423675226652645
Bond Position:  [-5.09829537]


portfolio before change:  [-4.56187027]
curr_Stock_Price:  99.02186357066525
curr_Factors:  [99.02186357 -1.24182002 -0.92736821]
mat_Sqrt:  [[11.31526203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02706184 0.07842336 1.24079326]
Stock Position:  0.02706183580200873
Bond Position:  [-7.24158368]


portfolio before change:  [-4.57172302]
curr_Stock_Price:  98.69123202780825
curr_Factors:  [98.69123203 -1.35970883 -0.92125866]
mat_Sqrt:  [[10.08479271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00209041 -0.02193749  0.0476164 ]
Stock Position:  0.002090408708012001
Bond Position:  [-4.77802803]


portfolio before change:  [-4.5727887]
curr_Stock_Price:  98.46716281556333
curr_Factors:  [98.46716282 -1.30448838 -0.93798568]
mat_Sqrt:  [[10.45676423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01017422 -0.01649074  0.07918   ]
Stock Position:  0.010174217795883076
Bond Position:  [-5.57461507]


portfolio before change:  [-4.57734823]
curr_Stock_Price:  98.08751184821945
curr_Factors:  [98.08751185 -1.29552602 -0.95053645]
mat_Sqrt:  [[10.3791355   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00901476 -0.02588284 -0.22095976]
Stock Position:  -0.00901475713366909
Bond Position:  [-3.69311313]


portfolio before change:  [-4.57756839]
curr_Stock_Price:  98.06072175619502
curr_Factors:  [98.06072176 -1.38000246 -0.97029184]
mat_Sqrt:  [[ 9.34921703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01671488  0.00837766 -0.10243913]
Stock Position:  -0.0167148832912327
Bond Position:  [-2.93849487]


portfolio before change:  [-4.58238707]
curr_Stock_Price:  98.3270318552773
curr_Factors:  [98.32703186 -1.11771926 -0.98300936]
mat_Sqrt:  [[12.03200714  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00498953  0.00137633 -0.0500486 ]
Stock Position:  0.00498953188181835
Bond Position:  [-5.07299293]


portfolio before change:  [-4.58222041]
curr_Stock_Price:  98.4875323216748
curr_Factors:  [98.48753232 -1.21538208 -0.98143146]
mat_Sqrt:  [[10.947558    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0058883  -0.01503674  0.72887186]
Stock Position:  0.005888303259532931
Bond Position:  [-5.16214486]


portfolio before change:  [-4.58547012]
curr_Stock_Price:  98.0452310870231
curr_Factors:  [98.04523109 -1.34166803 -0.98313588]
mat_Sqrt:  [[ 9.58908044  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01854535 -0.035906    0.25323049]
Stock Position:  0.01854535000834311
Bond Position:  [-6.40375325]


portfolio before change:  [-4.6008305]
curr_Stock_Price:  97.26013605628616
curr_Factors:  [97.26013606 -1.28647335 -0.97887309]
mat_Sqrt:  [[10.09502534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366927 -0.02683418  0.0130031 ]
Stock Position:  -0.0036692675712641605
Bond Position:  [-4.24395704]


portfolio before change:  [-4.59971735]
curr_Stock_Price:  96.81217747177051
curr_Factors:  [96.81217747 -1.22905383 -0.96391376]
mat_Sqrt:  [[10.80279832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01027293 0.004829   0.24997597]
Stock Position:  0.010272933152526894
Bond Position:  [-5.59426238]


portfolio before change:  [-4.59729439]
curr_Stock_Price:  97.11611105189561
curr_Factors:  [97.11611105 -1.28508133 -0.95828892]
mat_Sqrt:  [[10.30405017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00802172  0.03396643 -0.01804982]
Stock Position:  -0.008021720208019152
Bond Position:  [-3.81825612]


portfolio before change:  [-4.59479638]
curr_Stock_Price:  96.74520305772636
curr_Factors:  [96.74520306 -1.40103005 -0.91254755]
mat_Sqrt:  [[ 9.56875542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00462881 -0.00645505 -0.21863211]
Stock Position:  0.004628806849123979
Bond Position:  [-5.04261124]


portfolio before change:  [-4.59400951]
curr_Stock_Price:  97.05137965644322
curr_Factors:  [97.05137966 -1.77023863 -0.91957548]
mat_Sqrt:  [[ 6.58916353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01284209  0.00255914 -0.09553895]
Stock Position:  -0.01284208755607659
Bond Position:  [-3.3476672]


portfolio before change:  [-4.59398916]
curr_Stock_Price:  97.01720813985128
curr_Factors:  [97.01720814 -1.68426868 -0.89453718]
mat_Sqrt:  [[ 7.36016619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0142193  -0.00310024  0.16273778]
Stock Position:  -0.014219301459487032
Bond Position:  [-3.21447223]


portfolio before change:  [-4.59394622]
curr_Stock_Price:  96.98592846486179
curr_Factors:  [96.98592846 -1.43890235 -0.90647992]
mat_Sqrt:  [[ 9.2922771   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247526 -0.01135959 -0.02563259]
Stock Position:  -0.002475258482913902
Bond Position:  [-4.35388098]


portfolio before change:  [-4.59443673]
curr_Stock_Price:  96.96421036998909
curr_Factors:  [96.96421037 -1.38453324 -0.91882072]
mat_Sqrt:  [[ 9.68896865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00754066 -0.0005422   0.17941396]
Stock Position:  -0.00754066406585387
Bond Position:  [-3.8632622]


portfolio before change:  [-4.59823084]
curr_Stock_Price:  97.40331950507682
curr_Factors:  [97.40331951 -1.52925532 -0.93744863]
mat_Sqrt:  [[ 8.26604653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01702917 -0.02067951 -0.2144505 ]
Stock Position:  -0.01702917104225985
Bond Position:  [-2.93953306]


portfolio before change:  [-4.60193126]
curr_Stock_Price:  97.59903960856919
curr_Factors:  [97.59903961 -1.79950643 -0.95347438]
mat_Sqrt:  [[ 6.22072741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.38655479 0.43527923 0.45590063]
Stock Position:  0.38655479063295234
Bond Position:  [-42.32930758]


portfolio before change:  [-4.59587992]
curr_Stock_Price:  97.62838300827612
curr_Factors:  [97.62838301 -1.68752035 -0.98505116]
mat_Sqrt:  [[ 6.74361912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00372342 -0.06157877 -0.05595622]
Stock Position:  0.003723423099230757
Bond Position:  [-4.9593917]


portfolio before change:  [-4.59641733]
curr_Stock_Price:  97.65055440796196
curr_Factors:  [97.65055441 -1.54995977 -1.00931098]
mat_Sqrt:  [[ 7.55435777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00237327 -0.0046586  -0.15752791]
Stock Position:  0.002373273590449389
Bond Position:  [-4.82816881]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.59879513]
Stock Price:  96.90296226725098
PL:  [-4.59879513]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 9.42702589e-02 -1.89704665e-02  3.33823783e-02]
 [ 1.36181136e+00  2.97335870e-01  4.23764023e-01]
 [-1.82864268e-02  7.90753101e-02  3.50543481e-02]
 [ 9.01794459e-02  6.44110532e-01  5.64879626e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.89880427e-02 -7.05210005e-02  5.93750745e-02]
 [-3.43145308e-02 -1.05326771e-01 -9.00364137e-03]
 [ 1.43800798e-01  6.17619244e-02 -1.26739638e-01]
 [-4.69258699e-03  8.56113915e-02 -4.97011191e-02]
 [-4.60295046e-01  1.63245131e-02 -1.82560207e-01]
 [ 5.01589581e-01  9.73630478e-01 -1.74598098e-01]
 [-2.63040341e-04  1.53870790e-02 -5.74449063e-02]
 [-5.35758632e-02 -4.30107641e-02 -3.13740733e-01]
 [ 1.77820704e+00 -3.48216435e+00  3.01249108e+00]
 [ 4.34322691e-02 -1.01513953e-01  5.71024432e-02]
 [ 1.15937179e-01 -1.01212429e-01  3.40158598e-02]
 [-1.60732243e-01 -2.19584372e-01 -2.23457447e-02]
 [-2.57341470e-01 -1.68520855e+00 -1.99910539e-01]
 [-3.26171702e-02  1.52612263e-01  3.45951819e-01]
 [ 3.45876374e-01 -2.12130118e-01  5.10868404e-01]
 [ 1.03824792e-01 -2.88167485e-01 -1.05649765e-01]
 [ 2.93079433e-02 -5.44254573e-02 -8.13354846e-02]
 [ 1.75663530e-01  2.48948157e-01  1.94801027e-01]
 [ 6.33905578e-02 -1.24399785e-01  8.35580034e-03]
 [-4.70613034e-02 -1.64938758e-01  6.66586935e-02]
 [ 7.54746899e-02 -1.87913300e-02 -4.93308782e-02]
 [ 5.50001016e-01 -6.66681174e-02  3.01608007e-01]
 [ 6.35462171e-02 -1.72014996e-01 -5.67539125e-02]
 [-1.35140896e-02 -7.88252960e-02 -9.86979445e-03]
 [ 1.82348968e-01 -6.49985975e-02  4.81231450e-02]
 [-2.17891989e-02 -6.65629488e-02 -3.21766396e-02]
 [ 4.83086339e-02  1.79852188e-02 -6.37040185e-02]
 [-3.52068821e-02 -4.20928092e-02 -1.08029460e-02]
 [ 4.43138433e-01  6.22178213e-02  1.01955012e-01]
 [ 1.09356658e-02  4.86546281e-02 -3.16785587e-02]
 [-6.42748365e-02 -5.60898428e-03 -6.98742970e-02]
 [ 2.37936167e+00  1.62516798e+00  1.90247450e-01]
 [-1.06155153e-01 -2.09127337e-03 -1.32148935e-02]
 [ 3.75947231e-02 -1.25593462e-02 -1.68345893e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.52452325]
curr_Stock_Price:  101.24408653217556
curr_Factors:  [101.24408653  -0.88931959  -0.99140715]
mat_Sqrt:  [[15.43762268  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00629709 -0.00612269  0.09523063]
Stock Position:  0.006297088623522819
Bond Position:  [10.88698026]


portfolio before change:  [11.52564465]
curr_Stock_Price:  101.20604422299424
curr_Factors:  [101.20604422  -0.73669545  -0.99463818]
mat_Sqrt:  [[17.91834158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08421568 0.09596474 1.20888081]
Stock Position:  0.08421567647344615
Bond Position:  [3.00250917]


portfolio before change:  [11.53184634]
curr_Stock_Price:  101.27522793576604
curr_Factors:  [101.27522794  -0.65400344  -0.96517642]
mat_Sqrt:  [[20.05868     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00024978 0.02552145 0.1000003 ]
Stock Position:  0.00024977676335295794
Bond Position:  [11.50655014]


portfolio before change:  [11.53340336]
curr_Stock_Price:  101.75011451354558
curr_Factors:  [101.75011451  -0.70493369  -0.97403063]
mat_Sqrt:  [[18.98322383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0177506  0.20788578 1.61144434]
Stock Position:  0.01775059554604066
Bond Position:  [9.72727823]


portfolio before change:  [11.52908663]
curr_Stock_Price:  101.43842260395489
curr_Factors:  [101.4384226   -0.97218828  -0.98420856]
mat_Sqrt:  [[14.34003253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00408967 -0.01106097 -0.05874131]
Stock Position:  -0.004089670007941311
Bond Position:  [11.94393631]


portfolio before change:  [11.53048242]
curr_Stock_Price:  101.46221422844064
curr_Factors:  [101.46221423  -1.1252048   -0.96822409]
mat_Sqrt:  [[12.50661317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00533421 -0.02276056  0.16938056]
Stock Position:  0.005334209123587985
Bond Position:  [10.98926175]


portfolio before change:  [11.53437907]
curr_Stock_Price:  101.93518121894628
curr_Factors:  [101.93518122  -1.43056198  -0.97830627]
mat_Sqrt:  [[ 9.16570578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00628998 -0.03399407 -0.02568488]
Stock Position:  -0.006289982453202586
Bond Position:  [12.17554957]


portfolio before change:  [11.53420976]
curr_Stock_Price:  102.20407615303391
curr_Factors:  [102.20407615  -1.38399983  -0.96077828]
mat_Sqrt:  [[ 9.79814857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01332265  0.01993358 -0.36155291]
Stock Position:  0.013322647352287647
Bond Position:  [10.1725809]


portfolio before change:  [11.54032496]
curr_Stock_Price:  102.5676338360043
curr_Factors:  [102.56763384  -1.48400758  -0.95843252]
mat_Sqrt:  [[ 8.91809473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00029575  0.02763096 -0.14178346]
Stock Position:  0.0002957545035358492
Bond Position:  [11.50999012]


portfolio before change:  [11.54190311]
curr_Stock_Price:  103.03864722907632
curr_Factors:  [103.03864723  -1.6376774   -0.96384664]
mat_Sqrt:  [[ 7.64139434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06467769  0.00526871 -0.52079346]
Stock Position:  -0.06467769396730047
Bond Position:  [18.2062052]


portfolio before change:  [11.56253213]
curr_Stock_Price:  102.7548847444053
curr_Factors:  [102.75488474  -1.79176079  -0.94807017]
mat_Sqrt:  [[ 6.63604027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10016386  0.31423789 -0.49807977]
Stock Position:  0.100163856142724
Bond Position:  [1.27020663]


portfolio before change:  [11.58311148]
curr_Stock_Price:  102.95875636914579
curr_Factors:  [102.95875637  -1.97920795  -0.95282936]
mat_Sqrt:  [[ 5.48650355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016127   0.00496616 -0.16387433]
Stock Position:  -0.0016126952844455363
Bond Position:  [11.74915258]


portfolio before change:  [11.58356903]
curr_Stock_Price:  103.58577440862362
curr_Factors:  [103.58577441  -2.07277708  -0.95570556]
mat_Sqrt:  [[ 5.01241265  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02521689 -0.01388166 -0.89501498]
Stock Position:  -0.02521688985124134
Bond Position:  [14.19568009]


portfolio before change:  [11.58196917]
curr_Stock_Price:  103.71959075341557
curr_Factors:  [103.71959075  -2.1253618   -0.95181938]
mat_Sqrt:  [[ 4.78033119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.35192862 -1.12386371  8.59379853]
Stock Position:  0.351928624684473
Bond Position:  [-24.91992376]


portfolio before change:  [11.62581331]
curr_Stock_Price:  103.85302498832172
curr_Factors:  [103.85302499  -2.0600733   -0.9624913 ]
mat_Sqrt:  [[ 5.05517299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00679834 -0.03276349  0.16289738]
Stock Position:  0.006798344521590231
Bond Position:  [10.91978466]


portfolio before change:  [11.62888287]
curr_Stock_Price:  104.10374765153162
curr_Factors:  [104.10374765  -1.85948257  -0.95480911]
mat_Sqrt:  [[ 6.24072458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01637963 -0.03266617  0.09703778]
Stock Position:  0.01637962631117116
Bond Position:  [9.92370238]


portfolio before change:  [11.61608932]
curr_Stock_Price:  103.24694624023563
curr_Factors:  [103.24694624  -1.66980216  -0.96443486]
mat_Sqrt:  [[ 7.41041645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02835414 -0.07087055 -0.06374619]
Stock Position:  -0.02835414486979958
Bond Position:  [14.54356819]


portfolio before change:  [11.61402379]
curr_Stock_Price:  103.38391360201689
curr_Factors:  [103.3839136   -1.48392711  -0.99985863]
mat_Sqrt:  [[ 8.62498853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07445109 -0.54389872 -0.57028912]
Stock Position:  -0.07445108932394019
Bond Position:  [19.31106877]


portfolio before change:  [11.63300783]
curr_Stock_Price:  103.16135119749333
curr_Factors:  [103.1613512   -1.70713666  -1.00878198]
mat_Sqrt:  [[ 6.82352114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01013433 0.0492554  0.98690424]
Stock Position:  0.010134327322838144
Bond Position:  [10.58753693]


portfolio before change:  [11.63565613]
curr_Stock_Price:  103.29207248130182
curr_Factors:  [103.29207248  -1.79596083  -1.00972521]
mat_Sqrt:  [[ 6.24558363  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.065143   -0.0684647   1.45736536]
Stock Position:  0.06514300279193767
Bond Position:  [4.90690037]


portfolio before change:  [11.66403077]
curr_Stock_Price:  103.71823086522916
curr_Factors:  [103.71823087  -1.79898219  -1.00464436]
mat_Sqrt:  [[ 6.2842805   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00372949 -0.09300566 -0.30138937]
Stock Position:  0.0037294933018533895
Bond Position:  [11.27721432]


portfolio before change:  [11.66712404]
curr_Stock_Price:  104.16964192369062
curr_Factors:  [104.16964192  -1.57517348  -1.02598894]
mat_Sqrt:  [[ 7.72806354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.06501549e-04 -1.75657408e-02 -2.32027498e-01]
Stock Position:  0.000206501549318498
Bond Position:  [11.64561285]


portfolio before change:  [11.66852723]
curr_Stock_Price:  103.91487601430376
curr_Factors:  [103.91487601  -1.60800115  -1.05184566]
mat_Sqrt:  [[ 7.26977431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03662334 0.08034767 0.55571311]
Stock Position:  0.03662334499969986
Bond Position:  [7.86281687]


portfolio before change:  [11.65830445]
curr_Stock_Price:  103.60890475900439
curr_Factors:  [103.60890476  -1.55079639  -1.05237391]
mat_Sqrt:  [[ 7.67104597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00517572 -0.04014986  0.02383677]
Stock Position:  0.005175719038688496
Bond Position:  [11.12205387]


portfolio before change:  [11.65895452]
curr_Stock_Price:  103.46587755933187
curr_Factors:  [103.46587756  -1.5119131   -1.03096577]
mat_Sqrt:  [[ 8.13652352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00824955 -0.05323376  0.1901587 ]
Stock Position:  -0.008249547533227547
Bond Position:  [12.5125012]


portfolio before change:  [11.65845669]
curr_Stock_Price:  103.7158302604246
curr_Factors:  [103.71583026  -1.51655362  -1.03773041]
mat_Sqrt:  [[ 8.06368568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00763538 -0.00606488 -0.14072726]
Stock Position:  0.007635379755673969
Bond Position:  [10.86654694]


portfolio before change:  [11.65993845]
curr_Stock_Price:  103.7319863101328
curr_Factors:  [103.73198631  -1.2952003   -1.01735916]
mat_Sqrt:  [[10.27024677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05822235 -0.02151704  0.86040369]
Stock Position:  0.05822235180941822
Bond Position:  [5.62041825]


portfolio before change:  [11.62439814]
curr_Stock_Price:  103.10949497712674
curr_Factors:  [103.10949498  -1.14423503  -0.99896974]
mat_Sqrt:  [[12.09251548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139334 -0.0555176  -0.16190312]
Stock Position:  0.0013933378294353144
Bond Position:  [11.48073178]


portfolio before change:  [11.6269976]
curr_Stock_Price:  103.94510388667648
curr_Factors:  [103.94510389  -1.12805305  -0.98418892]
mat_Sqrt:  [[12.57387112  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00251465 -0.02544075 -0.02815578]
Stock Position:  -0.0025146511267511817
Bond Position:  [11.88838327]


portfolio before change:  [11.62966714]
curr_Stock_Price:  103.47450213281556
curr_Factors:  [103.47450213  -1.08662397  -0.97386362]
mat_Sqrt:  [[13.18180723  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01357206 -0.02097821  0.13728194]
Stock Position:  0.013572060193223295
Bond Position:  [10.22530497]


portfolio before change:  [11.64069565]
curr_Stock_Price:  104.1929094408711
curr_Factors:  [104.19290944  -0.94001991  -0.98539815]
mat_Sqrt:  [[15.19286673  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00276079 -0.0214831  -0.091791  ]
Stock Position:  -0.0027607912131377304
Bond Position:  [11.92835052]


portfolio before change:  [11.6421969]
curr_Stock_Price:  104.18924743179389
curr_Factors:  [104.18924743  -0.85724581  -0.97048354]
mat_Sqrt:  [[16.75136228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00232676  0.0058047  -0.18172983]
Stock Position:  0.0023267554191419284
Bond Position:  [11.399774]


portfolio before change:  [11.64551478]
curr_Stock_Price:  105.00275017138324
curr_Factors:  [105.00275017  -0.88153606  -0.97686512]
mat_Sqrt:  [[16.37220953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280989 -0.0135854  -0.0308178 ]
Stock Position:  -0.002809894584622024
Bond Position:  [11.94056144]


portfolio before change:  [11.6482784]
curr_Stock_Price:  104.55043729597716
curr_Factors:  [104.5504373   -0.81287681  -0.99815074]
mat_Sqrt:  [[17.09253898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02788644 0.02008072 0.29084927]
Stock Position:  0.027886440565084093
Bond Position:  [8.73273884]


portfolio before change:  [11.60644434]
curr_Stock_Price:  103.01113282979293
curr_Factors:  [103.01113283  -0.66291151  -0.99041517]
mat_Sqrt:  [[19.7175754   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073036  0.01570321 -0.09037011]
Stock Position:  0.0007303581280146206
Bond Position:  [11.53120932]


portfolio before change:  [11.60864496]
curr_Stock_Price:  104.05053782205592
curr_Factors:  [104.05053782  -0.73317736  -0.96386132]
mat_Sqrt:  [[19.06469221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0041796  -0.00181029 -0.19933192]
Stock Position:  -0.004179600483026259
Bond Position:  [12.04353464]


portfolio before change:  [11.60975399]
curr_Stock_Price:  104.14540556990256
curr_Factors:  [104.14540557  -0.76628746  -0.96826752]
mat_Sqrt:  [[18.37944792  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.14961993 0.52452071 0.54272302]
Stock Position:  0.14961993421565295
Bond Position:  [-3.97247474]


portfolio before change:  [11.79550014]
curr_Stock_Price:  105.39017779224099
curr_Factors:  [105.39017779  -0.82281562  -0.97824803]
mat_Sqrt:  [[17.40235939  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00627958 -0.00067496 -0.03769841]
Stock Position:  -0.006279580179904619
Bond Position:  [12.45730621]


portfolio before change:  [11.79293004]
curr_Stock_Price:  106.04744432454895
curr_Factors:  [106.04744432  -0.88927062  -0.95308884]
mat_Sqrt:  [[16.80249053  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.97319510e-05 -4.05351157e-03 -4.80243975e-01]
Stock Position:  3.9731951001206234e-05
Bond Position:  [11.78871657]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.79436266]
Stock Price:  105.01382394954699
PL:  [6.78053871]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.68255762e-01  3.25266204e-02 -7.56753963e-02]
 [ 1.99563971e+00  4.91046406e-01  7.46827394e-01]
 [ 1.29690584e-01  2.39773832e-01  4.29973334e-02]
 [ 5.94694576e-02  4.90067290e-01  3.85932783e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 7.32797148e-02 -5.75315691e-02  5.54021071e-02]
 [-4.24212879e-02 -5.34436500e-02 -4.36796013e-02]
 [ 1.00453167e-01  1.12038561e-01 -7.74243906e-02]
 [ 1.02124193e-02  6.94817659e-02 -4.72506165e-02]
 [-3.23780250e-01 -2.99812490e-02 -1.25308112e-01]
 [ 6.19854752e-01  1.21127397e+00 -2.12422090e-01]
 [-8.35346962e-05  1.92769517e-02 -5.81104730e-02]
 [ 6.78572790e-02 -2.62884321e-02 -4.09781416e-03]
 [ 1.54576968e+00 -2.98088329e+00  2.53461337e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.39932533e-01 -8.83360151e-02  2.48416294e-02]
 [-1.44782302e-01 -1.88737059e-01 -3.27666784e-02]
 [-2.64481892e-01 -1.72608880e+00 -1.99988960e-01]
 [ 1.30094623e-03  3.72499194e-02  5.83893053e-02]
 [ 2.02244525e-01 -1.65105263e-01  2.81840430e-01]
 [ 4.86894912e-02 -2.33154122e-02  4.93349059e-02]
 [ 1.39941018e-01 -5.34994419e-02 -1.40113694e-02]
 [ 6.86903217e-02  1.52386653e-01  1.12879725e-01]
 [-6.62604538e-02 -5.69211110e-03  4.20830328e-02]
 [-3.39564645e-02 -1.49683516e-01  5.80552063e-02]
 [ 4.34426345e-02 -1.16255235e-02  4.70020942e-02]
 [ 5.40836971e-01 -8.65990945e-02  2.78813644e-01]
 [ 9.27272936e-02 -2.22768800e-01 -1.04145684e-01]
 [-1.20939019e-02 -7.74485676e-02 -7.48578459e-03]
 [ 2.60821962e-01 -1.27225385e-01  4.08721547e-02]
 [-1.54058599e-02 -5.82606376e-02 -3.88328105e-02]
 [-2.53020414e-02  2.39397376e-02 -5.31739667e-02]
 [-3.61293138e-02 -1.38008282e-02 -4.47164369e-02]
 [ 4.10245278e-01  6.23871256e-02  8.91741890e-02]
 [-1.01647392e-01  1.36947844e-02  2.91328916e-02]
 [-1.00993497e-01 -3.62489306e-02 -1.04616840e-01]
 [ 2.63726908e+00  1.74289313e+00  1.91777468e-01]
 [-5.91201102e-02 -4.51663450e-02 -2.76516559e-02]
 [ 3.54480921e-02 -1.33205212e-02 -1.15195455e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.42768784]
curr_Stock_Price:  101.91318021494318
curr_Factors:  [101.91318021  -1.21159496  -1.00610591]
mat_Sqrt:  [[11.09417731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01437223  0.01049792 -0.21588084]
Stock Position:  0.014372228838968567
Bond Position:  [14.96296829]


portfolio before change:  [16.43315238]
curr_Stock_Price:  102.16324956227356
curr_Factors:  [102.16324956  -1.34041573  -0.9633077 ]
mat_Sqrt:  [[10.20470195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.22032193 0.15848455 2.13049068]
Stock Position:  0.22032193171164255
Bond Position:  [-6.07565211]


portfolio before change:  [16.4696776]
curr_Stock_Price:  102.33247793334627
curr_Factors:  [102.33247793  -1.3733921   -0.98116702]
mat_Sqrt:  [[ 9.71496982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01929095 0.07738667 0.12265942]
Stock Position:  0.019290950988351825
Bond Position:  [14.49558678]


portfolio before change:  [16.47352094]
curr_Stock_Price:  102.4377750872822
curr_Factors:  [102.43777509  -1.46835343  -0.97109146]
mat_Sqrt:  [[ 8.93352144  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02667282 0.15816854 1.10095881]
Stock Position:  0.02667282163608882
Bond Position:  [13.74121644]


portfolio before change:  [16.46584913]
curr_Stock_Price:  102.08574756261459
curr_Factors:  [102.08574756  -1.45623348  -0.9722517 ]
mat_Sqrt:  [[ 9.00093034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00651555 -0.01106097 -0.05874131]
Stock Position:  -0.006515548810103606
Bond Position:  [17.1309938]


portfolio before change:  [16.46851904]
curr_Stock_Price:  102.00464957251393
curr_Factors:  [102.00464957  -1.43769991  -0.97050026]
mat_Sqrt:  [[ 9.17808178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00793685 -0.01856823  0.15804679]
Stock Position:  0.007936848018622638
Bond Position:  [15.65892364]


portfolio before change:  [16.46535622]
curr_Stock_Price:  101.35951808184429
curr_Factors:  [101.35951808  -1.31368753  -0.9812852 ]
mat_Sqrt:  [[10.21340476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00609459 -0.01724886 -0.12460574]
Stock Position:  -0.0060945874561784946
Bond Position:  [17.08310066]


portfolio before change:  [16.46589972]
curr_Stock_Price:  101.62073704201873
curr_Factors:  [101.62073704  -1.26820493  -1.00204898]
mat_Sqrt:  [[10.49599457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01024379  0.03616029 -0.22087024]
Stock Position:  0.010243789153396436
Bond Position:  [15.42491831]


portfolio before change:  [16.46936023]
curr_Stock_Price:  101.77031844850791
curr_Factors:  [101.77031845  -1.06961695  -0.99995189]
mat_Sqrt:  [[12.84750523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114811  0.02242514 -0.13479286]
Stock Position:  0.001148108785589559
Bond Position:  [16.35251684]


portfolio before change:  [16.47235907]
curr_Stock_Price:  102.60181144228595
curr_Factors:  [102.60181144  -0.87047124  -1.01262421]
mat_Sqrt:  [[15.6076337   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02277594 -0.00967641 -0.35746917]
Stock Position:  -0.022775941867357992
Bond Position:  [18.80921196]


portfolio before change:  [16.46757887]
curr_Stock_Price:  102.91492693354749
curr_Factors:  [102.91492693  -0.95847278  -0.98427322]
mat_Sqrt:  [[14.74872581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05585191  0.39093699 -0.6059811 ]
Stock Position:  0.055851912102572204
Bond Position:  [10.71958341]


portfolio before change:  [16.57039527]
curr_Stock_Price:  104.73180963052658
curr_Factors:  [104.73180963  -1.08055643  -0.97021552]
mat_Sqrt:  [[13.47223552  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00059459  0.00622161 -0.165773  ]
Stock Position:  -0.0005945853613421545
Bond Position:  [16.63266727]


portfolio before change:  [16.57263924]
curr_Stock_Price:  104.45472408100339
curr_Factors:  [104.45472408  -0.9480235   -0.96488437]
mat_Sqrt:  [[15.42278314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00399764 -0.00848455 -0.01168992]
Stock Position:  0.003997638549327446
Bond Position:  [16.155067]


portfolio before change:  [16.57586787]
curr_Stock_Price:  104.75718347952964
curr_Factors:  [104.75718348  -1.09337147  -0.94444468]
mat_Sqrt:  [[13.65122131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10656008 -0.96207594  7.23054644]
Stock Position:  0.10656007857265824
Bond Position:  [5.41293417]


portfolio before change:  [16.53869492]
curr_Stock_Price:  104.40198844184773
curr_Factors:  [104.40198844  -0.88309712  -0.94871551]
mat_Sqrt:  [[16.71716585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129623 -0.03053791  0.10625201]
Stock Position:  -0.001296234845113387
Bond Position:  [16.67402441]


portfolio before change:  [16.54154868]
curr_Stock_Price:  103.80843534676227
curr_Factors:  [103.80843535  -0.7512393   -0.94239939]
mat_Sqrt:  [[19.08511182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00665292 -0.02851033  0.07086625]
Stock Position:  0.0066529238501320765
Bond Position:  [15.85091907]


portfolio before change:  [16.53507753]
curr_Stock_Price:  102.53792017485041
curr_Factors:  [102.53792017  -0.7565014   -0.94476461]
mat_Sqrt:  [[18.70828875  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01015574 -0.06091462 -0.09347421]
Stock Position:  -0.01015574247678412
Bond Position:  [17.57642624]


portfolio before change:  [16.54024057]
curr_Stock_Price:  102.24588390233099
curr_Factors:  [102.2458839   -0.86542428  -0.91263348]
mat_Sqrt:  [[17.27607817  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03806656 -0.55709276 -0.57051284]
Stock Position:  -0.038066560098449234
Bond Position:  [20.43238965]


portfolio before change:  [16.56509441]
curr_Stock_Price:  101.66007751220204
curr_Factors:  [101.66007751  -0.66470698  -0.88684333]
mat_Sqrt:  [[21.54372016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00096656 0.01202236 0.16656844]
Stock Position:  0.0009665564290190275
Bond Position:  [16.46683421]


portfolio before change:  [16.56706176]
curr_Stock_Price:  101.56579008278945
curr_Factors:  [101.56579008  -0.78142973  -0.88292976]
mat_Sqrt:  [[19.22761014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01175773 -0.05328749  0.8040123 ]
Stock Position:  0.011757727027157213
Bond Position:  [15.37287892]


portfolio before change:  [16.57008012]
curr_Stock_Price:  101.65905866309976
curr_Factors:  [101.65905866  -0.88516325  -0.88754719]
mat_Sqrt:  [[17.26902116  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00312703 -0.00752502  0.14073875]
Stock Position:  0.0031270271573856485
Bond Position:  [16.25218948]


portfolio before change:  [16.57251418]
curr_Stock_Price:  101.78774684956257
curr_Factors:  [101.78774685  -1.06808969  -0.88412924]
mat_Sqrt:  [[14.44965883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00873103 -0.01726687 -0.03997054]
Stock Position:  0.008731031809432825
Bond Position:  [15.68380212]


portfolio before change:  [16.57474319]
curr_Stock_Price:  101.81848987532547
curr_Factors:  [101.81848988  -1.17780319  -0.90834253]
mat_Sqrt:  [[12.64227047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00971642 0.04918258 0.32201443]
Stock Position:  0.009716418790973385
Bond Position:  [15.58543211]


portfolio before change:  [16.57997829]
curr_Stock_Price:  102.15676207210164
curr_Factors:  [102.15676207  -1.36296047  -0.91962394]
mat_Sqrt:  [[10.42205365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00564497 -0.00183712  0.12005118]
Stock Position:  -0.005644970743244101
Bond Position:  [17.15665022]


portfolio before change:  [16.57753435]
curr_Stock_Price:  102.96963728195988
curr_Factors:  [102.96963728  -1.50388194  -0.92816152]
mat_Sqrt:  [[ 9.04661538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00582096 -0.04831015  0.16561534]
Stock Position:  -0.005820963169523898
Bond Position:  [17.17691681]


portfolio before change:  [16.58240738]
curr_Stock_Price:  102.50136626404718
curr_Factors:  [102.50136626  -1.57993375  -0.91430078]
mat_Sqrt:  [[ 8.46247431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00598688 -0.00375212  0.13408389]
Stock Position:  0.005986883375858068
Bond Position:  [15.96874366]


portfolio before change:  [16.58453139]
curr_Stock_Price:  102.52271026257964
curr_Factors:  [102.52271026  -1.52483803  -0.92735806]
mat_Sqrt:  [[ 8.82764481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06571091 -0.02794974  0.79537772]
Stock Position:  0.06571091316075457
Bond Position:  [9.84767048]


portfolio before change:  [16.60615737]
curr_Stock_Price:  102.83308410578502
curr_Factors:  [102.83308411  -1.37136813  -0.94848092]
mat_Sqrt:  [[10.10730142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00257202 -0.07189832 -0.29709865]
Stock Position:  0.0025720172846595683
Bond Position:  [16.3416689]


portfolio before change:  [16.60969655]
curr_Stock_Price:  103.41486303507098
curr_Factors:  [103.41486304  -1.45094155  -0.93300658]
mat_Sqrt:  [[ 9.5333918   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308715 -0.02499642 -0.02135486]
Stock Position:  -0.00308715455577204
Bond Position:  [16.92895422]


portfolio before change:  [16.61200112]
curr_Stock_Price:  103.3538642028472
curr_Factors:  [103.3538642   -1.65532031  -0.94288895]
mat_Sqrt:  [[ 7.69022021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03162396 -0.04106182  0.11659688]
Stock Position:  0.031623955590416766
Bond Position:  [13.34354311]


portfolio before change:  [16.6087736]
curr_Stock_Price:  103.19905858483091
curr_Factors:  [103.19905858  -1.64410477  -0.93430336]
mat_Sqrt:  [[ 7.83226388  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00449742 -0.01880354 -0.1107792 ]
Stock Position:  -0.004497419590392311
Bond Position:  [17.07290307]


portfolio before change:  [16.61226606]
curr_Stock_Price:  102.89706078214795
curr_Factors:  [102.89706078  -1.39606791  -0.91560084]
mat_Sqrt:  [[10.19666117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306664  0.00772652 -0.15169053]
Stock Position:  -0.0030666365110240987
Bond Position:  [16.92781394]


portfolio before change:  [16.61401617]
curr_Stock_Price:  103.01640953059334
curr_Factors:  [103.01640953  -1.46446745  -0.91451676]
mat_Sqrt:  [[ 9.54391796  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00503715 -0.0044542  -0.12756355]
Stock Position:  -0.005037145192466786
Bond Position:  [17.13292478]


portfolio before change:  [16.61453368]
curr_Stock_Price:  103.33886153018358
curr_Factors:  [103.33886153  -1.58046292  -0.91564873]
mat_Sqrt:  [[ 8.51561776  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05180864 0.02013536 0.25438914]
Stock Position:  0.05180864309590123
Bond Position:  [11.26068748]


portfolio before change:  [16.62037349]
curr_Stock_Price:  103.42440977550073
curr_Factors:  [103.42440978  -1.50785747  -0.91220505]
mat_Sqrt:  [[ 9.19609083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01010269  0.00441997  0.08310803]
Stock Position:  -0.010102687211946798
Bond Position:  [17.66523795]


portfolio before change:  [16.62880713]
curr_Stock_Price:  102.80820221712479
curr_Factors:  [102.80820222  -1.28522423  -0.89275797]
mat_Sqrt:  [[11.64507034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01114185 -0.01169929 -0.29844272]
Stock Position:  -0.011141847878748806
Bond Position:  [17.77428048]


portfolio before change:  [16.62967471]
curr_Stock_Price:  102.92975687261192
curr_Factors:  [102.92975687  -0.95886295  -0.87944256]
mat_Sqrt:  [[16.37476247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.18517411 0.56251634 0.54708774]
Stock Position:  0.18517410963210276
Bond Position:  [-2.43025137]


portfolio before change:  [16.64288666]
curr_Stock_Price:  103.00274625653299
curr_Factors:  [103.00274626  -0.71507561  -0.86136658]
mat_Sqrt:  [[21.29161763  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034748  -0.01457738 -0.07888248]
Stock Position:  -0.003474795749556358
Bond Position:  [17.00080016]


portfolio before change:  [16.64340632]
curr_Stock_Price:  103.46480758201105
curr_Factors:  [103.46480758  -0.80323646  -0.86903697]
mat_Sqrt:  [[19.43271735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047419 -0.00429918 -0.32862057]
Stock Position:  0.0004741940180164681
Bond Position:  [16.59434393]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.64598796]
Stock Price:  104.53444763904825
PL:  [12.11154032]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-2.84678330e-02 -7.30306517e-02  2.08580442e-01]
 [ 4.40952053e-01  2.00423952e-01  1.15446183e-01]
 [-3.16574169e-01 -2.04929591e-01  3.90306401e-02]
 [ 1.54073983e-01  1.27821004e+00  1.00384817e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.16742818e-02 -6.19682028e-02  4.79818306e-02]
 [-5.29273031e-02  1.65410885e-03 -6.77081969e-02]
 [-5.74874542e-02  1.10690150e-01  6.06458122e-03]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-2.08744109e-02 -3.68471693e-04  3.91962847e-02]
 [ 8.19358266e-01  1.67457233e+00 -2.60503428e-01]
 [-1.54922509e-03 -4.45190319e-02  2.01831443e-01]
 [-4.78141844e-01 -1.18868930e-02 -1.01688427e+00]
 [ 1.97557568e+00 -2.88846281e+00  2.45630184e+00]
 [ 2.15977758e-02 -8.55068007e-02  2.79165052e-02]
 [ 8.76373764e-02  1.23563086e-01 -9.58114769e-02]
 [ 6.28011946e-03  2.09701776e-01 -8.47725537e-03]
 [-2.96674999e-01 -1.90347479e+00 -1.97840804e-01]
 [ 2.18678247e-02 -2.90233933e-02  3.15986722e-02]
 [ 6.29598234e-02  1.21193490e-01  2.01677754e-01]
 [ 2.37693092e-02  2.65293448e-02 -6.55978953e-03]
 [ 1.16770851e-01 -5.18942197e-02  4.88218141e-02]
 [ 2.19803980e-01 -9.68412875e-03  2.60082978e-02]
 [-1.37419439e-01  2.36106472e-03  5.68514054e-02]
 [ 6.05250613e-02 -3.38820191e-02 -8.11519062e-03]
 [ 5.25853934e-02 -4.11879939e-02  2.95996435e-01]
 [-5.96153514e-02 -1.16333143e-01 -1.98318277e-02]
 [-1.56732014e-01  1.24735484e-01  2.06053482e-01]
 [ 8.76166569e-02  4.21871265e-02  1.51421463e-01]
 [-1.38614801e-01  1.16677932e-01 -1.88870720e-02]
 [ 6.35062538e-02 -1.97105329e-02 -7.22697379e-02]
 [-7.26150308e-02  4.15800907e-03 -3.41758807e-02]
 [-7.47170960e-02  3.67078660e-03  6.20877063e-02]
 [-1.92260883e-02 -3.27596463e-02 -8.37313802e-03]
 [-8.91182947e-02  1.04252796e-02  5.65461217e-02]
 [-1.12565980e-01 -6.42653063e-02 -7.53817828e-02]
 [ 1.58369127e+00  1.03559195e+00  1.41388074e-01]
 [ 7.45177615e-02 -1.52608090e-01  1.56988572e-02]
 [ 3.22103695e-02 -1.45255858e-02 -5.71235112e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.01664345]
curr_Stock_Price:  99.39623726624858
curr_Factors:  [99.39623727 -0.84858472 -0.99876528]
mat_Sqrt:  [[15.67025386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.09786230e-05 -2.35705415e-02  5.95021943e-01]
Stock Position:  -5.0978623036052294e-05
Bond Position:  [-2.01157636]


portfolio before change:  [-2.01686501]
curr_Stock_Price:  98.80980693284168
curr_Factors:  [98.80980693 -0.87750181 -0.98601235]
mat_Sqrt:  [[15.32802268  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03297417 0.06468655 0.32933583]
Stock Position:  0.032974166654574706
Bond Position:  [-5.27503606]


portfolio before change:  [-1.99550222]
curr_Stock_Price:  99.47766964281873
curr_Factors:  [99.47766964 -0.89601379 -0.99095516]
mat_Sqrt:  [[15.07389209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02324802 -0.06614074  0.11134355]
Stock Position:  -0.023248020406100113
Bond Position:  [0.31715667]


portfolio before change:  [-2.01538139]
curr_Stock_Price:  100.3344658786538
curr_Factors:  [100.33446588  -1.26252243  -0.9913883 ]
mat_Sqrt:  [[10.53389892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05884784 0.41254052 2.8636994 ]
Stock Position:  0.05884783670428941
Bond Position:  [-7.91984765]


portfolio before change:  [-2.05089482]
curr_Stock_Price:  99.74781061315153
curr_Factors:  [99.74781061 -1.02545424 -0.97999348]
mat_Sqrt:  [[13.42605733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00436807 -0.01106097 -0.05874131]
Stock Position:  -0.004368073180388861
Bond Position:  [-1.61518909]


portfolio before change:  [-2.05745466]
curr_Stock_Price:  101.20335431552816
curr_Factors:  [101.20335432  -1.03598481  -0.9827359 ]
mat_Sqrt:  [[13.44236375  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00437567 -0.02000015  0.13687881]
Stock Position:  0.004375668343027494
Bond Position:  [-2.50028697]


portfolio before change:  [-2.06244528]
curr_Stock_Price:  100.13424457002937
curr_Factors:  [100.13424457  -0.99902027  -1.01512665]
mat_Sqrt:  [[13.36133136  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00497035  0.00053386 -0.19315264]
Stock Position:  -0.0049703532930983575
Bond Position:  [-1.56474271]


portfolio before change:  [-2.05552819]
curr_Stock_Price:  98.70322086755571
curr_Factors:  [98.70322087 -0.78353119 -0.99498492]
mat_Sqrt:  [[16.6698461   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00201891  0.03572509  0.01730056]
Stock Position:  -0.002018914527022946
Bond Position:  [-1.85625483]


portfolio before change:  [-2.05457559]
curr_Stock_Price:  98.11644326680087
curr_Factors:  [98.11644327 -0.7154007  -1.01040094]
mat_Sqrt:  [[17.46769767  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00297642  0.0064198  -0.11330016]
Stock Position:  0.0029764199229238716
Bond Position:  [-2.34661132]


portfolio before change:  [-2.05439201]
curr_Stock_Price:  98.27667614711376
curr_Factors:  [98.27667615 -0.74747643 -1.02124278]
mat_Sqrt:  [[16.76121396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00077254 -0.00011892  0.11181609]
Stock Position:  -0.0007725405083040352
Bond Position:  [-1.9784693]


portfolio before change:  [-2.0542706]
curr_Stock_Price:  97.79937537613986
curr_Factors:  [97.79937538 -0.6706153  -1.01994028]
mat_Sqrt:  [[18.03587114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06143334  0.5404659  -0.74314377]
Stock Position:  0.061433343779752216
Bond Position:  [-8.06241325]


portfolio before change:  [-2.13256814]
curr_Stock_Price:  96.54126909536473
curr_Factors:  [96.5412691  -0.56028399 -1.02057521]
mat_Sqrt:  [[19.86801944  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00153825 -0.01436846  0.57576893]
Stock Position:  0.0015382527862897227
Bond Position:  [-2.28107302]


portfolio before change:  [-2.13143488]
curr_Stock_Price:  97.46336493061516
curr_Factors:  [97.46336493 -0.70488625 -1.06652283]
mat_Sqrt:  [[16.5778502   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04150954 -0.00383648 -2.90088777]
Stock Position:  -0.04150953644513074
Bond Position:  [1.91422422]


portfolio before change:  [-2.09938073]
curr_Stock_Price:  96.69691800971218
curr_Factors:  [96.69691801 -0.3530915  -1.08400003]
mat_Sqrt:  [[22.97691477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08214163 -0.93224736  7.00714545]
Stock Position:  0.08214162841933144
Bond Position:  [-10.04222304]


portfolio before change:  [-2.04542377]
curr_Stock_Price:  97.36907797954225
curr_Factors:  [97.36907798 -0.17334491 -1.10333781]
mat_Sqrt:  [[27.16219102  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036235 -0.0275972   0.07963802]
Stock Position:  0.00036234948727043124
Bond Position:  [-2.0807054]


portfolio before change:  [-2.04537143]
curr_Stock_Price:  98.23134515292298
curr_Factors:  [98.23134515 -0.18409505 -1.10133167]
mat_Sqrt:  [[27.16416497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00343475  0.03987981 -0.27332347]
Stock Position:  0.0034347512615775207
Bond Position:  [-2.38277167]


portfolio before change:  [-2.04622393]
curr_Stock_Price:  98.06986778896561
curr_Factors:  [ 9.80698678e+01 -4.55733177e-02 -1.07793345e+00]
mat_Sqrt:  [[31.88620264  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148512  0.06768096 -0.02418325]
Stock Position:  0.0014851220514113235
Bond Position:  [-2.19186965]


portfolio before change:  [-2.04857277]
curr_Stock_Price:  96.6727844994505
curr_Factors:  [96.6727845  -0.42675823 -1.09907759]
mat_Sqrt:  [[21.02045704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03451896 -0.61434385 -0.56438475]
Stock Position:  -0.03451895681221242
Bond Position:  [1.2884709]


portfolio before change:  [-2.07849785]
curr_Stock_Price:  97.54436770604683
curr_Factors:  [97.54436771 -0.55476029 -1.11521939]
mat_Sqrt:  [[18.36281421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012195  -0.00936726  0.09014222]
Stock Position:  0.0012195026909432112
Bond Position:  [-2.19745346]


portfolio before change:  [-2.07803033]
curr_Stock_Price:  98.15299040263082
curr_Factors:  [98.1529904  -0.48112509 -1.11736915]
mat_Sqrt:  [[19.8466086   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00649308 0.03911503 0.5753305 ]
Stock Position:  0.006493081146030462
Bond Position:  [-2.71534566]


portfolio before change:  [-2.08687689]
curr_Stock_Price:  96.84280804576794
curr_Factors:  [96.84280805 -0.3768709  -1.09032001]
mat_Sqrt:  [[22.32926641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124704  0.00856231 -0.01871325]
Stock Position:  0.0012470439936428676
Bond Position:  [-2.20764413]


portfolio before change:  [-2.08729516]
curr_Stock_Price:  96.72869607560986
curr_Factors:  [96.72869608 -0.48749773 -1.1097769 ]
mat_Sqrt:  [[19.58248384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.005931   -0.01674879  0.13927505]
Stock Position:  0.00593099933249781
Bond Position:  [-2.66099299]


portfolio before change:  [-2.08133433]
curr_Stock_Price:  97.78981228315804
curr_Factors:  [97.78981228 -0.46847524 -1.10707622]
mat_Sqrt:  [[20.23206962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01102883 -0.00312554  0.07419443]
Stock Position:  0.011028834009149637
Bond Position:  [-3.15984193]


portfolio before change:  [-2.09475124]
curr_Stock_Price:  96.60909727238109
curr_Factors:  [96.60909727 -0.57970954 -1.09911793]
mat_Sqrt:  [[18.02654584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00695268  0.00076203  0.16218124]
Stock Position:  -0.006952676666382412
Bond Position:  [-1.42305943]


portfolio before change:  [-2.10361509]
curr_Stock_Price:  97.85839435172933
curr_Factors:  [97.85839435 -0.49243662 -1.06893826]
mat_Sqrt:  [[20.53532566  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0025299  -0.01093537 -0.02315038]
Stock Position:  0.002529904694677557
Bond Position:  [-2.35118751]


portfolio before change:  [-2.10189181]
curr_Stock_Price:  98.65573789770995
curr_Factors:  [98.6557379  -0.65379004 -1.05570777]
mat_Sqrt:  [[17.85241125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00585904 -0.01329337  0.84439544]
Stock Position:  0.005859037590381744
Bond Position:  [-2.67991948]


portfolio before change:  [-2.10206742]
curr_Stock_Price:  98.68294324779959
curr_Factors:  [98.68294325 -0.56746151 -1.03927386]
mat_Sqrt:  [[19.78999968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00441687 -0.03754636 -0.05657468]
Stock Position:  -0.004416872716634013
Bond Position:  [-1.66619742]


portfolio before change:  [-2.09325447]
curr_Stock_Price:  96.64049364262263
curr_Factors:  [96.64049364 -0.81305398 -1.04053511]
mat_Sqrt:  [[15.14103716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00589193  0.0402582   0.58781323]
Stock Position:  -0.005891934490452127
Bond Position:  [-1.52385501]


portfolio before change:  [-2.08943981]
curr_Stock_Price:  95.96072512776722
curr_Factors:  [95.96072513 -0.82991048 -1.03515134]
mat_Sqrt:  [[14.86303376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0085539  0.01361584 0.43196329]
Stock Position:  0.008553895986021368
Bond Position:  [-2.91027787]


portfolio before change:  [-2.08657207]
curr_Stock_Price:  96.33851146417265
curr_Factors:  [96.33851146 -0.8477212  -1.04840749]
mat_Sqrt:  [[14.46510891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00820273  0.03765764 -0.05387956]
Stock Position:  -0.008202726003468845
Bond Position:  [-1.29633366]


portfolio before change:  [-2.0869036]
curr_Stock_Price:  96.35917252233084
curr_Factors:  [96.35917252 -1.05726136 -1.08089889]
mat_Sqrt:  [[11.35800001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00393827 -0.00636155 -0.20616545]
Stock Position:  0.003938269022458009
Bond Position:  [-2.46639195]


portfolio before change:  [-2.08550265]
curr_Stock_Price:  96.79318734803128
curr_Factors:  [96.79318735 -1.09754132 -1.08851526]
mat_Sqrt:  [[10.8755813   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00724029  0.00134199 -0.09749428]
Stock Position:  -0.007240293736520177
Bond Position:  [-1.38469155]


portfolio before change:  [-2.08714541]
curr_Stock_Price:  96.99617099388796
curr_Factors:  [96.99617099 -1.12424994 -1.09404762]
mat_Sqrt:  [[10.55261757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00580844  0.00118474  0.17711894]
Stock Position:  -0.005808435626082125
Bond Position:  [-1.5237494]


portfolio before change:  [-2.08667974]
curr_Stock_Price:  96.88320554095856
curr_Factors:  [96.88320554 -1.06857824 -1.09278077]
mat_Sqrt:  [[11.15789335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247558 -0.01057313 -0.02388623]
Stock Position:  -0.002475582252820253
Bond Position:  [-1.8468374]


portfolio before change:  [-2.08733889]
curr_Stock_Price:  97.05620784663363
curr_Factors:  [97.05620785 -1.27465623 -1.0723093 ]
mat_Sqrt:  [[ 9.28429941  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00812639  0.00336474  0.16131035]
Stock Position:  -0.008126387496382252
Bond Position:  [-1.29862254]


portfolio before change:  [-2.08953332]
curr_Stock_Price:  97.30626899826986
curr_Factors:  [97.306269   -1.38353646 -1.06895606]
mat_Sqrt:  [[ 8.37600351  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01684232 -0.02074154 -0.21504324]
Stock Position:  -0.016842318981242266
Bond Position:  [-0.4506701]


portfolio before change:  [-2.08889648]
curr_Stock_Price:  97.2651117245734
curr_Factors:  [97.26511172 -1.30758032 -1.08286927]
mat_Sqrt:  [[ 8.90836546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.20474478 0.33423586 0.40334082]
Stock Position:  0.20474477821571427
Bond Position:  [-22.0034202]


portfolio before change:  [-2.26594613]
curr_Stock_Price:  96.41381259525264
curr_Factors:  [96.4138126  -1.33164764 -1.07830185]
mat_Sqrt:  [[ 8.65987243  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00537783 -0.04925405  0.04478447]
Stock Position:  0.005377825340474536
Bond Position:  [-2.78444277]


portfolio before change:  [-2.26096432]
curr_Stock_Price:  97.40489830704837
curr_Factors:  [97.40489831 -1.31361286 -1.0591576 ]
mat_Sqrt:  [[ 9.08028918  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193662 -0.00468811 -0.16295748]
Stock Position:  0.0019366188104641795
Bond Position:  [-2.44960048]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.26082211]
Stock Price:  97.63644892174447
PL:  [-2.26082211]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-2.22915230e-02 -8.92678510e-02  1.65532366e-01]
 [ 1.63015654e+00  3.56106497e-01  5.45603676e-01]
 [ 1.17164958e-01  2.22639905e-01  4.05571056e-02]
 [ 6.77646454e-02  5.70505050e-01  4.41204650e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-1.56775702e-01  1.35284330e-02 -1.12268080e-01]
 [-3.62423988e-02 -9.33513886e-02 -1.50417174e-02]
 [ 1.67340198e-01  6.86839985e-02 -1.55820648e-01]
 [ 4.98255044e-03  7.51413292e-02 -4.81104489e-02]
 [-4.58245389e-01  6.67596361e-02 -1.67225625e-01]
 [ 4.78806611e-01  9.50208437e-01 -1.61678562e-01]
 [-1.49470595e-04  2.27428293e-02 -5.80773593e-02]
 [ 1.37933712e-03 -2.03789778e-02 -1.01003372e-01]
 [ 1.57601832e+00 -3.02842731e+00  2.54627531e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.43138552e-01 -9.52920091e-02  2.74246517e-02]
 [-1.93876512e-01 -2.94998867e-01 -1.48357356e-02]
 [-2.55264159e-01 -1.67833119e+00 -2.01699523e-01]
 [-1.32373818e-02  5.18046550e-02  2.17482494e-01]
 [ 3.06074834e-01 -3.64654165e-01  3.40718046e-01]
 [ 7.02585178e-02 -2.91491038e-02 -2.95197737e-02]
 [ 1.63830904e-01 -5.61501868e-02 -2.26778263e-02]
 [ 1.17360174e-01  1.80886938e-01  1.48652826e-01]
 [-2.67200784e-01  9.68442785e-02  1.86196888e-02]
 [-6.57797004e-02 -2.23054189e-01  8.43755535e-02]
 [ 1.05850232e-01 -2.39334854e-02 -9.88192723e-02]
 [ 4.30417147e-01 -4.72163187e-02  2.46853709e-01]
 [ 1.88522389e-03 -5.79788515e-02  2.84060379e-02]
 [-1.29582886e-02 -7.82865031e-02 -8.93679442e-03]
 [ 7.23118081e-02  4.38239010e-03  8.10980049e-02]
 [-2.14766325e-02 -5.70398128e-02 -3.77169480e-02]
 [ 6.60439818e-02  2.20984370e-02 -7.74985485e-02]
 [-1.15676853e-01 -3.86352402e-02  2.25887743e-02]
 [ 2.45443867e-01  1.38158658e-02  4.26018920e-02]
 [ 1.39434162e-01  1.00104303e-01 -9.26315449e-02]
 [-8.39494403e-02 -1.69944746e-02 -1.06257654e-01]
 [ 2.00934341e+00  1.49199865e+00  1.95018886e-01]
 [-9.50183276e-02  4.82134612e-02 -8.89071190e-04]
 [ 4.35948749e-02 -1.02520128e-02 -3.18605366e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.28387773]
curr_Stock_Price:  99.49623164856916
curr_Factors:  [99.49623165 -0.90921604 -0.97370812]
mat_Sqrt:  [[15.13781043  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.44191977e-04 -2.88110750e-02  4.72217766e-01]
Stock Position:  -0.00044419197717477385
Bond Position:  [-1.2396823]


portfolio before change:  [-1.28494276]
curr_Stock_Price:  101.5450390226738
curr_Factors:  [101.54503902  -0.99877048  -0.98858811]
mat_Sqrt:  [[13.91745549  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.13035554 0.11493288 1.55645542]
Stock Position:  0.13035553540467734
Bond Position:  [-14.52190069]


portfolio before change:  [-1.27685115]
curr_Stock_Price:  101.62103853730899
curr_Factors:  [101.62103854  -0.9843763   -0.97159901]
mat_Sqrt:  [[14.37190529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01189055 0.07185672 0.11569813]
Stock Position:  0.011890547544527941
Bond Position:  [-2.48518094]


portfolio before change:  [-1.26945233]
curr_Stock_Price:  102.2694099435601
curr_Factors:  [102.26940994  -1.23742814  -0.97530507]
mat_Sqrt:  [[11.1883985   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02451459 0.18412971 1.25863406]
Stock Position:  0.02451459189306434
Bond Position:  [-3.77654518]


portfolio before change:  [-1.26524774]
curr_Stock_Price:  102.46018136150647
curr_Factors:  [102.46018136  -1.13967126  -0.98940825]
mat_Sqrt:  [[12.1873038   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00481206 -0.01106097 -0.05874131]
Stock Position:  -0.004812057029383538
Bond Position:  [-0.77220351]


portfolio before change:  [-1.27026163]
curr_Stock_Price:  103.4820641443258
curr_Factors:  [103.48206414  -1.28077675  -0.99288179]
mat_Sqrt:  [[10.65191589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01661024  0.00436628 -0.32026958]
Stock Position:  -0.016610237101870633
Bond Position:  [0.44859999]


portfolio before change:  [-1.28059808]
curr_Stock_Price:  104.10773379237769
curr_Factors:  [104.10773379  -1.20105829  -1.02744842]
mat_Sqrt:  [[11.21127028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00520619 -0.03012903 -0.04290983]
Stock Position:  -0.005206194073839504
Bond Position:  [-0.73859301]


portfolio before change:  [-1.27593016]
curr_Stock_Price:  103.19339096269607
curr_Factors:  [103.19339096  -0.8958507   -1.02688269]
mat_Sqrt:  [[15.08757299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00991236  0.02216767 -0.44451294]
Stock Position:  0.009912363256701529
Bond Position:  [-2.29882054]


portfolio before change:  [-1.27369809]
curr_Stock_Price:  103.44756201961991
curr_Factors:  [103.44756202  -1.23108281  -1.00238645]
mat_Sqrt:  [[11.0850303   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094724  0.02425176 -0.13724572]
Stock Position:  0.0009472419554616019
Bond Position:  [-1.37168797]


portfolio before change:  [-1.27355787]
curr_Stock_Price:  103.77662385531322
curr_Factors:  [103.77662386  -1.17671158  -1.00157108]
mat_Sqrt:  [[11.75123193  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04074066  0.02154658 -0.47704816]
Stock Position:  -0.040740658110583486
Bond Position:  [2.95437009]


portfolio before change:  [-1.28502816]
curr_Stock_Price:  104.06723323642956
curr_Factors:  [104.06723324  -1.12079038  -1.0004802 ]
mat_Sqrt:  [[12.47549818  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05128169  0.30667845 -0.46122394]
Stock Position:  0.05128168737459281
Bond Position:  [-6.62177148]


portfolio before change:  [-1.31589028]
curr_Stock_Price:  103.48155945104554
curr_Factors:  [103.48155945  -0.98366014  -1.01433834]
mat_Sqrt:  [[14.03276488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052464  0.00734022 -0.16567854]
Stock Position:  -0.0005246365484670481
Bond Position:  [-1.26160007]


portfolio before change:  [-1.31614196]
curr_Stock_Price:  103.66068982401855
curr_Factors:  [103.66068982  -0.90736841  -1.0426655 ]
mat_Sqrt:  [[14.74772832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158653 -0.00657729 -0.28813451]
Stock Position:  -0.001586531216833633
Bond Position:  [-1.15168104]


portfolio before change:  [-1.31563699]
curr_Stock_Price:  103.25165700326369
curr_Factors:  [103.251657    -0.84422875  -1.06455738]
mat_Sqrt:  [[15.30811606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09652393 -0.97742071  7.26381472]
Stock Position:  0.09652392560106318
Bond Position:  [-11.28189225]


portfolio before change:  [-1.25839456]
curr_Stock_Price:  103.85930693137846
curr_Factors:  [103.85930693  -1.17527512  -1.08109564]
mat_Sqrt:  [[10.87717338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199219 -0.03053791  0.10625201]
Stock Position:  -0.0019921878704340745
Bond Position:  [-1.05148731]


portfolio before change:  [-1.25956571]
curr_Stock_Price:  104.38119742798443
curr_Factors:  [104.38119743  -1.07753131  -1.06300011]
mat_Sqrt:  [[12.27442882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01053289 -0.03075536  0.0782349 ]
Stock Position:  0.010532888166192852
Bond Position:  [-2.35900119]


portfolio before change:  [-1.26426302]
curr_Stock_Price:  103.96322811452602
curr_Factors:  [103.96322811  -1.11208959  -1.06474839]
mat_Sqrt:  [[11.78938179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02180956 -0.09521048 -0.04232222]
Stock Position:  -0.021809560463832044
Bond Position:  [1.00312929]


portfolio before change:  [-1.26796965]
curr_Stock_Price:  104.13893181304873
curr_Factors:  [104.13893181  -1.40774147  -1.05676829]
mat_Sqrt:  [[ 8.85707105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07214844 -0.54167906 -0.5753926 ]
Stock Position:  -0.07214843561576618
Bond Position:  [6.24549137]


portfolio before change:  [-1.21320919]
curr_Stock_Price:  103.39075597505862
curr_Factors:  [103.39075598  -1.2787063   -1.01053109]
mat_Sqrt:  [[10.47800365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00398269 0.01671988 0.62041702]
Stock Position:  0.003982688750376345
Bond Position:  [-1.62498239]


portfolio before change:  [-1.21310707]
curr_Stock_Price:  103.46740177021088
curr_Factors:  [103.46740177  -1.25871999  -1.02553271]
mat_Sqrt:  [[10.53816999  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02858076 -0.11769163  0.97197375]
Stock Position:  0.028580758711388498
Bond Position:  [-4.17028392]


portfolio before change:  [-1.2141383]
curr_Stock_Price:  103.44956094517298
curr_Factors:  [103.44956095  -1.14947804  -1.00610919]
mat_Sqrt:  [[11.98309525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00486375 -0.00940783 -0.0842117 ]
Stock Position:  0.00486375032061073
Bond Position:  [-1.71729113]


portfolio before change:  [-1.21728511]
curr_Stock_Price:  102.84670552709454
curr_Factors:  [102.84670553  -1.09947693  -1.01261236]
mat_Sqrt:  [[12.44290147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01187345 -0.01812239 -0.06469353]
Stock Position:  0.011873452818591496
Bond Position:  [-2.43843061]


portfolio before change:  [-1.22233305]
curr_Stock_Price:  102.44723340463003
curr_Factors:  [102.4472334   -1.13262695  -1.02423679]
mat_Sqrt:  [[11.85185195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01557792 0.05838101 0.42406514]
Stock Position:  0.015577919614944662
Bond Position:  [-2.81824781]


portfolio before change:  [-1.22570977]
curr_Stock_Price:  102.25308524937523
curr_Factors:  [102.25308525  -0.70700765  -1.02240038]
mat_Sqrt:  [[18.13861215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01343167  0.03125636  0.05311679]
Stock Position:  -0.013431667138022243
Bond Position:  [0.14771963]


portfolio before change:  [-1.2440737]
curr_Stock_Price:  103.6216712308823
curr_Factors:  [103.62167123  -0.96228678  -1.02769374]
mat_Sqrt:  [[14.16488436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0066423  -0.07199043  0.24069997]
Stock Position:  -0.006642296247346171
Bond Position:  [-0.55578786]


portfolio before change:  [-1.24708616]
curr_Stock_Price:  104.06473902302105
curr_Factors:  [104.06473902  -0.87560521  -1.00018873]
mat_Sqrt:  [[15.94617918  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00506663 -0.0077245  -0.28190388]
Stock Position:  0.00506663253666831
Bond Position:  [-1.77434396]


portfolio before change:  [-1.24727871]
curr_Stock_Price:  104.07051405864343
curr_Factors:  [104.07051406  -0.82162728  -1.02908841]
mat_Sqrt:  [[16.35204557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02881401 -0.015239    0.70420492]
Stock Position:  0.028814007203652806
Bond Position:  [-4.24596725]


portfolio before change:  [-1.25277512]
curr_Stock_Price:  103.89818027719592
curr_Factors:  [103.89818028  -0.94904623  -1.03312659]
mat_Sqrt:  [[14.31400683  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00029002 -0.01871259  0.08103452]
Stock Position:  -0.0002900167260001092
Bond Position:  [-1.22264291]


portfolio before change:  [-1.25290599]
curr_Stock_Price:  103.82245056115492
curr_Factors:  [103.82245056  -0.78027156  -1.07494169]
mat_Sqrt:  [[16.2398644   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189427 -0.02526686 -0.02549419]
Stock Position:  -0.0018942688731552288
Bond Position:  [-1.05623836]


portfolio before change:  [-1.25110032]
curr_Stock_Price:  102.79951901029867
curr_Factors:  [102.79951901  -0.65909163  -1.04093509]
mat_Sqrt:  [[18.77927672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00477976 0.00141441 0.23135003]
Stock Position:  0.0047797591995504506
Bond Position:  [-1.74245727]


portfolio before change:  [-1.24894653]
curr_Stock_Price:  103.29569802369373
curr_Factors:  [103.29569802  -0.71351174  -1.05170017]
mat_Sqrt:  [[17.67911185  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230887 -0.01840952 -0.10759595]
Stock Position:  -0.0023088702441636157
Bond Position:  [-1.01045016]


portfolio before change:  [-1.24859554]
curr_Stock_Price:  103.08897135377244
curr_Factors:  [103.08897135  -0.40359441  -1.03387611]
mat_Sqrt:  [[24.48649866  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00223533  0.00713224 -0.22108179]
Stock Position:  0.0022353331173337685
Bond Position:  [-1.47903373]


portfolio before change:  [-1.25213359]
curr_Stock_Price:  101.58889799684097
curr_Factors:  [ 1.01588898e+02 -3.65091056e-02 -1.02579466e+00]
mat_Sqrt:  [[35.11507383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033875  -0.01246947  0.06443949]
Stock Position:  -0.0033875003375614266
Bond Position:  [-0.90800117]


portfolio before change:  [-1.25503895]
curr_Stock_Price:  102.4130601827246
curr_Factors:  [ 1.02413060e+02  2.95810148e-02 -1.03697745e+00]
mat_Sqrt:  [[37.39802188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00687095 0.00445905 0.12153134]
Stock Position:  0.006870954158614638
Bond Position:  [-1.95871439]


portfolio before change:  [-1.24796778]
curr_Stock_Price:  103.47783506391792
curr_Factors:  [ 1.03477835e+02 -4.84446359e-02 -1.08904871e+00]
mat_Sqrt:  [[33.17723979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00424868  0.03230852 -0.26425201]
Stock Position:  0.004248681728445244
Bond Position:  [-1.68761217]


portfolio before change:  [-1.24842104]
curr_Stock_Price:  103.42080809440668
curr_Factors:  [103.42080809   0.31857135  -1.10569869]
mat_Sqrt:  [[47.07202313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023179  -0.00548494 -0.30312351]
Stock Position:  -0.0023178985833769918
Bond Position:  [-1.00870209]


portfolio before change:  [-1.25598097]
curr_Stock_Price:  106.62795257787594
curr_Factors:  [106.62795258   0.3677744   -1.0914247 ]
mat_Sqrt:  [[51.71228621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04551538 0.48154049 0.5563346 ]
Stock Position:  0.04551538130530535
Bond Position:  [-6.10919289]


portfolio before change:  [-1.23225703]
curr_Stock_Price:  107.16596053610483
curr_Factors:  [107.16596054   0.52485118  -1.06120517]
mat_Sqrt:  [[62.67888834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136183  0.01556083 -0.00253627]
Stock Position:  -0.0013618345693328377
Bond Position:  [-1.08631472]


portfolio before change:  [-1.24002313]
curr_Stock_Price:  112.76891792751991
curr_Factors:  [ 1.12768918e+02  8.11843814e-02 -1.07249172e+00]
mat_Sqrt:  [[41.84755653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.62347205e-04 -3.30882290e-03 -9.08892427e-01]
Stock Position:  -0.0005623472045290037
Bond Position:  [-1.17660784]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.24024664]
Stock Price:  112.90483352396356
PL:  [-14.14508017]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-3.48924723e-02 -5.61406077e-02  2.53359340e-01]
 [ 2.33905052e-01  1.99020578e-01  4.97428457e-02]
 [-5.18385379e-01 -3.95808069e-01  4.43813061e-02]
 [ 2.88700171e-01  1.94054918e+00  1.80880927e+00]
 [-4.86664456e-02 -2.77993778e-02 -1.06755364e-02]
 [ 6.39781853e-03  9.58739800e-02 -1.95710104e-02]
 [-1.10422839e-01  1.62535043e-01  4.30345991e-02]
 [-1.53528562e-02  2.28846597e-01 -3.40959356e-02]
 [-6.17164108e-03  8.72119671e-02 -4.99442874e-02]
 [-1.72147748e-01 -9.43026480e-02 -6.53644055e-02]
 [ 6.96181584e-01  1.34250394e+00 -2.42411736e-01]
 [-2.29650395e-04  3.03805696e-02 -5.81849094e-02]
 [-1.82648516e-01 -2.40056924e-02 -4.65590921e-01]
 [ 1.80334463e+00 -3.49906334e+00  2.97460273e+00]
 [ 1.32568232e-02 -9.16855438e-02  3.64053630e-02]
 [ 1.08307492e-01 -6.04796475e-02  1.13143263e-02]
 [-1.41136801e-01 -1.76690910e-01 -2.89023393e-02]
 [-2.58380049e-01 -1.68823519e+00 -1.98867366e-01]
 [-1.54822021e-02  6.35284802e-02  2.32653368e-01]
 [ 3.54459856e-01 -4.51939300e-01  3.59182476e-01]
 [ 1.04393754e-01 -1.96298532e-01 -1.47119084e-01]
 [ 1.79841013e-02 -5.43672758e-02 -8.56550200e-02]
 [ 2.35956723e-01  3.02093162e-01  2.39076224e-01]
 [ 1.12065543e-01 -7.98479809e-02  5.89652249e-02]
 [-7.93431281e-02 -2.20829702e-01  8.83858172e-02]
 [ 9.53246475e-02 -2.95157947e-02 -9.43547409e-02]
 [ 6.97440398e-01 -5.19815805e-02  4.02689608e-01]
 [-6.11145416e-04 -5.45072923e-02  3.14857085e-02]
 [-1.51960920e-02 -8.04558272e-02 -1.26933016e-02]
 [ 2.15489016e-01 -7.61464999e-02  2.57548678e-02]
 [-2.04123450e-02 -7.22857918e-02 -2.92607616e-02]
 [ 1.47201179e-02 -1.36260117e-02 -1.01576939e-02]
 [-3.80196843e-02  4.41788898e-02 -1.14216506e-01]
 [ 5.36413360e-01  1.00834161e-01  1.56356028e-01]
 [-4.98364534e-03  1.73917228e-01 -7.96543453e-02]
 [-3.97906593e-02  7.83249821e-03 -2.55325159e-02]
 [ 2.83913845e+00  1.95965166e+00  2.17271547e-01]
 [-1.15096406e-01  7.31308891e-03 -8.81565246e-03]
 [ 3.69154076e-02 -1.27134287e-02 -1.52648442e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.54007978]
curr_Stock_Price:  98.91542350820136
curr_Factors:  [98.91542351 -0.79908908 -1.01578002]
mat_Sqrt:  [[16.10928921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.33014868e-04 -1.81193032e-02  7.22763675e-01]
Stock Position:  0.00033301486827571686
Bond Position:  [-5.57302009]


portfolio before change:  [-5.54088382]
curr_Stock_Price:  98.59302995802393
curr_Factors:  [98.59302996 -0.69244218 -1.03335555]
mat_Sqrt:  [[17.55261324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01621888 0.06423362 0.14190249]
Stock Position:  0.016218876881527806
Bond Position:  [-7.13995203]


portfolio before change:  [-5.55698726]
curr_Stock_Price:  97.65517884220637
curr_Factors:  [97.65517884 -0.98487475 -1.01671136]
mat_Sqrt:  [[13.19524565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04472217 -0.12774651  0.12660751]
Stock Position:  -0.044722173625125504
Bond Position:  [-1.18963539]


portfolio before change:  [-5.54927987]
curr_Stock_Price:  97.47951434347642
curr_Factors:  [97.47951434 -1.03996233 -1.00408439]
mat_Sqrt:  [[12.62394656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08349487 0.62630956 5.16002938]
Stock Position:  0.08349486872022273
Bond Position:  [-13.68831913]


portfolio before change:  [-5.51059301]
curr_Stock_Price:  97.96335262293205
curr_Factors:  [97.96335262 -1.19303049 -1.0322327 ]
mat_Sqrt:  [[10.58386071  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00534022 -0.00897221 -0.03045433]
Stock Position:  -0.005340216217609212
Bond Position:  [-4.98744752]


portfolio before change:  [-5.51714193]
curr_Stock_Price:  99.07294301752158
curr_Factors:  [99.07294302 -1.20551683 -1.03875819]
mat_Sqrt:  [[10.50216434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00209224  0.03094319 -0.05583065]
Stock Position:  0.002092244633917421
Bond Position:  [-5.72442676]


portfolio before change:  [-5.51816832]
curr_Stock_Price:  98.92439588316387
curr_Factors:  [98.92439588 -1.07872868 -0.99620625]
mat_Sqrt:  [[12.42140195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00551154  0.05245796  0.12276573]
Stock Position:  -0.00551154467157101
Bond Position:  [-4.9729421]


portfolio before change:  [-5.52467056]
curr_Stock_Price:  99.99135277106045
curr_Factors:  [99.99135277 -1.23752048 -0.98648961]
mat_Sqrt:  [[10.81650943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00225585  0.07385992 -0.09726621]
Stock Position:  0.0022558530824529945
Bond Position:  [-5.75023636]


portfolio before change:  [-5.52435292]
curr_Stock_Price:  100.45080664962273
curr_Factors:  [100.45080665  -1.4298684   -0.9894892 ]
mat_Sqrt:  [[ 8.93798809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00016062  0.02814754 -0.14247715]
Stock Position:  0.00016061692594538827
Bond Position:  [-5.54048702]


portfolio before change:  [-5.5250392]
curr_Stock_Price:  100.49018600290171
curr_Factors:  [100.490186    -1.17747321  -0.95176804]
mat_Sqrt:  [[11.95104616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01713153 -0.03043605 -0.18646645]
Stock Position:  -0.017131525264711865
Bond Position:  [-3.80348904]


portfolio before change:  [-5.54579784]
curr_Stock_Price:  101.67415349304234
curr_Factors:  [101.67415349  -1.32577837  -0.98358382]
mat_Sqrt:  [[10.09874275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09117343  0.43329128 -0.69153321]
Stock Position:  0.09117342511408218
Bond Position:  [-14.81577866]


portfolio before change:  [-5.5419551]
curr_Stock_Price:  101.7366149337073
curr_Factors:  [101.73661493  -1.36314187  -0.98313382]
mat_Sqrt:  [[ 9.73873832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060636  0.00980529 -0.16598535]
Stock Position:  -0.0006063606289537989
Bond Position:  [-5.48026603]


portfolio before change:  [-5.54295862]
curr_Stock_Price:  102.26178041046313
curr_Factors:  [102.26178041  -1.72835237  -0.9713028 ]
mat_Sqrt:  [[ 6.87492568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04110401 -0.0077478  -1.3282013 ]
Stock Position:  -0.04110400894319425
Bond Position:  [-1.33958948]


portfolio before change:  [-5.54422487]
curr_Stock_Price:  102.28851235252456
curr_Factors:  [102.28851235  -1.83166207  -0.96762619]
mat_Sqrt:  [[ 6.22459959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.27251384 -1.12931784  8.48571362]
Stock Position:  0.2725138434689277
Bond Position:  [-33.41926051]


portfolio before change:  [-5.47843158]
curr_Stock_Price:  102.54527346742243
curr_Factors:  [102.54527347  -1.91394773  -0.96505042]
mat_Sqrt:  [[ 5.7621245   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00034237 -0.02959138  0.10385437]
Stock Position:  0.00034237433555534257
Bond Position:  [-5.51354045]


portfolio before change:  [-5.47915672]
curr_Stock_Price:  102.44040805105146
curr_Factors:  [102.44040805  -1.92418104  -0.94325521]
mat_Sqrt:  [[ 5.82317121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01687597 -0.01951972  0.03227662]
Stock Position:  0.016875970082671363
Bond Position:  [-7.20793798]


portfolio before change:  [-5.47536971]
curr_Stock_Price:  102.7182026885046
curr_Factors:  [102.71820269  -1.70990578  -0.94406635]
mat_Sqrt:  [[ 7.22839644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02533112 -0.05702675 -0.08245033]
Stock Position:  -0.02533111581165821
Bond Position:  [-2.87340302]


portfolio before change:  [-5.48216958]
curr_Stock_Price:  102.97246203771962
curr_Factors:  [102.97246204  -1.44941489  -0.94096041]
mat_Sqrt:  [[ 9.43179372  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06823551 -0.54487556 -0.56731324]
Stock Position:  -0.06823550896681065
Bond Position:  [1.54420877]


portfolio before change:  [-5.55149141]
curr_Stock_Price:  103.99121117715382
curr_Factors:  [103.99121118  -1.41286787  -0.9415224 ]
mat_Sqrt:  [[ 9.8741094   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00455491 0.02050373 0.6636953 ]
Stock Position:  0.004554908466387196
Bond Position:  [-6.02516186]


portfolio before change:  [-5.55066858]
curr_Stock_Price:  104.33721729429926
curr_Factors:  [104.33721729  -1.42529196  -0.90828697]
mat_Sqrt:  [[10.11530077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03317014 -0.14586278  1.02464763]
Stock Position:  0.03317014056984503
Bond Position:  [-9.01154874]


portfolio before change:  [-5.54387492]
curr_Stock_Price:  104.57599150723088
curr_Factors:  [104.57599151  -1.55710932  -0.91962133]
mat_Sqrt:  [[ 8.78620914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00390315 -0.06335508 -0.4196898 ]
Stock Position:  0.0039031539338194024
Bond Position:  [-5.95205111]


portfolio before change:  [-5.54553438]
curr_Stock_Price:  104.34146022519738
curr_Factors:  [104.34146023  -1.55735411  -0.91560427]
mat_Sqrt:  [[ 8.79963649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120435 -0.01754696 -0.24434993]
Stock Position:  -0.0012043486308044582
Bond Position:  [-5.41987089]


portfolio before change:  [-5.54698975]
curr_Stock_Price:  104.98731858844786
curr_Factors:  [104.98731859  -1.58382343  -0.89694371]
mat_Sqrt:  [[ 8.78523461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03943235 0.09750015 0.68201792]
Stock Position:  0.039432351814016886
Bond Position:  [-9.68688663]


portfolio before change:  [-5.55176498]
curr_Stock_Price:  104.89692832112642
curr_Factors:  [104.89692832  -1.58095162  -0.88944269]
mat_Sqrt:  [[ 8.86919395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01215475 -0.02577083  0.16821137]
Stock Position:  0.012154753693007062
Bond Position:  [-6.82676131]


portfolio before change:  [-5.55544704]
curr_Stock_Price:  104.66420772183389
curr_Factors:  [104.66420772  -1.46745577  -0.90641007]
mat_Sqrt:  [[ 9.74633543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01091468 -0.07127248  0.25214013]
Stock Position:  -0.010914679019724342
Bond Position:  [-4.41307081]


portfolio before change:  [-5.55581189]
curr_Stock_Price:  104.64709132804646
curr_Factors:  [104.64709133  -1.53728622  -0.90406276]
mat_Sqrt:  [[ 9.10883367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0076892  -0.00952618 -0.26916781]
Stock Position:  0.007689204005028777
Bond Position:  [-6.36046473]


portfolio before change:  [-5.55389557]
curr_Stock_Price:  104.9997196184467
curr_Factors:  [104.99971962  -1.59573372  -0.91621496]
mat_Sqrt:  [[ 8.51653013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09029832 -0.01677698  1.14876137]
Stock Position:  0.09029832128783202
Bond Position:  [-15.03519399]


portfolio before change:  [-5.61375858]
curr_Stock_Price:  104.35758704439425
curr_Factors:  [104.35758704  -1.45839285  -0.91953095]
mat_Sqrt:  [[ 9.6784284   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054868 -0.01759215  0.08981996]
Stock Position:  -0.0005486847984161697
Bond Position:  [-5.55649916]


portfolio before change:  [-5.61447936]
curr_Stock_Price:  104.40528390852742
curr_Factors:  [104.40528391  -1.53998595  -0.88226552]
mat_Sqrt:  [[ 9.2630078   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00369319 -0.02596701 -0.03621046]
Stock Position:  -0.003693193298212476
Bond Position:  [-5.22889046]


portfolio before change:  [-5.61402844]
curr_Stock_Price:  104.10620143029801
curr_Factors:  [104.10620143  -1.04063097  -0.86875196]
mat_Sqrt:  [[15.42560218  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01330275 -0.02457618  0.07347147]
Stock Position:  0.013302745972939678
Bond Position:  [-6.99892679]


portfolio before change:  [-5.60751288]
curr_Stock_Price:  104.66176191187466
curr_Factors:  [104.66176191  -1.11190239  -0.90271056]
mat_Sqrt:  [[13.95895006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294725 -0.02333014 -0.08347281]
Stock Position:  -0.0029472451886195213
Bond Position:  [-5.299049]


portfolio before change:  [-5.61141603]
curr_Stock_Price:  105.76134008713609
curr_Factors:  [105.76134009  -1.07412777  -0.91127915]
mat_Sqrt:  [[14.52364674  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00067926 -0.00439778 -0.02897707]
Stock Position:  0.0006792570405558932
Bond Position:  [-5.68325516]


portfolio before change:  [-5.61184719]
curr_Stock_Price:  106.1725069533103
curr_Factors:  [106.17250695  -1.16288186  -0.89663417]
mat_Sqrt:  [[13.53865821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0038642   0.01425868 -0.3258279 ]
Stock Position:  -0.003864197770672959
Bond Position:  [-5.20157563]


portfolio before change:  [-5.61298466]
curr_Stock_Price:  106.29859464834205
curr_Factors:  [106.29859465  -1.40447052  -0.89937495]
mat_Sqrt:  [[10.61647026  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05547155 0.03254409 0.44604023]
Stock Position:  0.055471552514734894
Bond Position:  [-11.50953273]


portfolio before change:  [-5.66016088]
curr_Stock_Price:  105.47407403002171
curr_Factors:  [105.47407403  -1.01309086  -0.88374235]
mat_Sqrt:  [[15.82564898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090092  0.05613154 -0.22723168]
Stock Position:  0.0009009226060079463
Bond Position:  [-5.75518485]


portfolio before change:  [-5.66182232]
curr_Stock_Price:  104.42847936024022
curr_Factors:  [104.42847936  -0.96927224  -0.88728623]
mat_Sqrt:  [[16.31270018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266073  0.00252793 -0.07283716]
Stock Position:  -0.0026607281326159753
Bond Position:  [-5.38396653]


portfolio before change:  [-5.66695776]
curr_Stock_Price:  106.10561505024513
curr_Factors:  [106.10561505  -1.16383215  -0.87848562]
mat_Sqrt:  [[13.76483573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.2385427  0.63247485 0.61981525]
Stock Position:  0.23854269711142104
Bond Position:  [-30.97767735]


portfolio before change:  [-5.76616538]
curr_Stock_Price:  105.70595843554032
curr_Factors:  [105.70595844  -0.76693701  -0.87967509]
mat_Sqrt:  [[20.36971345  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00566543  0.00236029 -0.0251486 ]
Stock Position:  -0.005665426535394294
Bond Position:  [-5.16729604]


portfolio before change:  [-5.76541528]
curr_Stock_Price:  105.45954185035433
curr_Factors:  [105.45954185  -0.78359395  -0.86265052]
mat_Sqrt:  [[20.32970095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.55489604e-04 -4.10324147e-03 -4.35463515e-01]
Stock Position:  0.00015548960436277397
Bond Position:  [-5.78181314]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.76624199]
Stock Price:  104.79104154648472
PL:  [-10.55728354]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.56090903e-02 -8.33805452e-02  8.36977685e-03]
 [ 9.31077034e-01  2.12565946e-01  2.65816487e-01]
 [-2.87690374e-01 -1.78342654e-01  3.81881409e-02]
 [ 1.77829218e-01  1.35470075e+00  1.14005399e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 2.68969467e-02 -4.10535026e-02  4.40365997e-02]
 [-9.68883685e-02  1.24663611e-01  1.69657035e-02]
 [ 6.83852883e-02  1.38395882e-01 -4.84990905e-02]
 [ 1.29852566e-02  6.64811078e-02 -4.67947398e-02]
 [-1.20236239e-01 -6.20678538e-02 -2.94829780e-02]
 [ 9.38050714e-01  1.80862763e+00 -3.24778599e-01]
 [ 1.96371661e-04 -1.85058533e-02 -5.18695897e-02]
 [-1.33762701e-01  7.37176709e-03 -2.38132810e-01]
 [ 1.46671232e+00 -2.80199465e+00  2.34173037e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.55652576e-01 -8.78881919e-02  2.23378683e-02]
 [-1.92004058e-01 -2.94492412e-01 -1.99536385e-02]
 [-2.60982398e-01 -1.71800189e+00 -2.04266631e-01]
 [-2.43794971e-05  3.35156457e-02  8.07311267e-02]
 [ 3.26739145e-01 -5.05000804e-01  2.71161815e-01]
 [ 6.56072497e-02  5.76985373e-02 -6.42332349e-02]
 [ 7.87855267e-02 -5.47796351e-02 -6.20813290e-02]
 [ 2.65956149e-01  2.52227044e-01  2.42489627e-01]
 [-2.00465125e-01  6.74447443e-02  6.25847177e-02]
 [-1.02823375e-01 -3.13601295e-01  1.13292039e-01]
 [ 1.46488323e-01 -4.30405729e-02 -1.55402111e-01]
 [ 6.30827040e-01 -1.38559305e-03  4.06709426e-01]
 [-5.88331548e-02  6.07672191e-02  1.05660880e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 3.51675120e-01 -1.09565694e-01 -8.19768915e-02]
 [-1.55801815e-02 -1.19319470e-01  3.38429816e-03]
 [-1.93986616e-01 -6.62137708e-02  1.22961720e-01]
 [-3.61217378e-02 -1.40331895e-02 -4.44379062e-02]
 [ 6.65674380e-01  1.39631523e-01  2.26004360e-01]
 [ 1.81998119e-01  3.31691032e-01 -1.94612804e-01]
 [-3.38183083e-02  4.56729907e-02  3.48296566e-02]
 [ 2.52997476e+00  1.83678656e+00  2.18997061e-01]
 [-1.14260063e-01  1.63616465e-02 -4.62238448e-04]
 [ 3.78964045e-02 -1.24712724e-02 -1.75608273e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.76769046]
curr_Stock_Price:  99.02082499050269
curr_Factors:  [99.02082499 -1.18130357 -0.9855675 ]
mat_Sqrt:  [[11.34139276  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.62385168e-05 -2.69109553e-02  2.38766437e-02]
Stock Position:  2.6238516786173793e-05
Bond Position:  [-4.77028862]


portfolio before change:  [-4.76827363]
curr_Stock_Price:  99.5223196393312
curr_Factors:  [99.52231964 -1.27337773 -1.00004554]
mat_Sqrt:  [[10.24673039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10039558 0.06860536 0.75830045]
Stock Position:  0.10039557980389555
Bond Position:  [-14.75987461]


portfolio before change:  [-4.75928501]
curr_Stock_Price:  99.63022990717906
curr_Factors:  [99.63022991 -1.11896543 -0.99933536]
mat_Sqrt:  [[11.97911645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02640423 -0.05755984  0.10894014]
Stock Position:  -0.026404225669911536
Bond Position:  [-2.12862594]


portfolio before change:  [-4.76387671]
curr_Stock_Price:  99.79405236886419
curr_Factors:  [99.79405237 -1.08394111 -1.00793085]
mat_Sqrt:  [[12.32015608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05576787 0.43722779 3.2522567 ]
Stock Position:  0.055767872727510506
Bond Position:  [-10.32917872]


portfolio before change:  [-4.74031139]
curr_Stock_Price:  100.23976684198718
curr_Factors:  [100.23976684  -1.24971684  -0.99952112]
mat_Sqrt:  [[10.57324789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00554664 -0.01106097 -0.05874131]
Stock Position:  -0.005546640119188433
Bond Position:  [-4.18431748]


portfolio before change:  [-4.73972045]
curr_Stock_Price:  100.0389213234354
curr_Factors:  [100.03892132  -1.05013852  -0.97690844]
mat_Sqrt:  [[13.17752021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00208733 -0.01324996  0.12562416]
Stock Position:  0.0020873326980993673
Bond Position:  [-4.94853496]


portfolio before change:  [-4.74176243]
curr_Stock_Price:  99.35700808411913
curr_Factors:  [99.35700808 -1.20506098 -1.01533616]
mat_Sqrt:  [[10.78679133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.006302    0.04023501  0.04839843]
Stock Position:  -0.006302004334201951
Bond Position:  [-4.11561414]


portfolio before change:  [-4.75351627]
curr_Stock_Price:  101.14046595917132
curr_Factors:  [101.14046596  -1.20403124  -0.99886709]
mat_Sqrt:  [[11.17424946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00776208  0.04466708 -0.13835441]
Stock Position:  0.007762077840715193
Bond Position:  [-5.53857644]


portfolio before change:  [-4.75182754]
curr_Stock_Price:  101.44722675064519
curr_Factors:  [101.44722675  -0.95113743  -1.04036102]
mat_Sqrt:  [[13.8466078   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122801  0.02145669 -0.13349237]
Stock Position:  0.001228006158162428
Bond Position:  [-4.87640536]


portfolio before change:  [-4.75252028]
curr_Stock_Price:  101.3795126707968
curr_Factors:  [101.37951267  -0.69471478  -1.05896785]
mat_Sqrt:  [[17.55235968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00791483 -0.02003231 -0.08410673]
Stock Position:  -0.007914831763889157
Bond Position:  [-3.95011849]


portfolio before change:  [-4.74826918]
curr_Stock_Price:  100.78001854610363
curr_Factors:  [100.78001855  -0.51717428  -1.07113662]
mat_Sqrt:  [[20.5863701   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0602797   0.58373206 -0.92650294]
Stock Position:  0.060279695887898624
Bond Position:  [-10.82325805]


portfolio before change:  [-4.710053]
curr_Stock_Price:  101.43644479236681
curr_Factors:  [101.43644479  -0.39302558  -1.0456577 ]
mat_Sqrt:  [[24.06477518  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058878 -0.00597274 -0.1479695 ]
Stock Position:  -0.0005887840371371154
Bond Position:  [-4.65032884]


portfolio before change:  [-4.71107041]
curr_Stock_Price:  102.1770923402703
curr_Factors:  [102.17709234  -0.24704454  -1.06144167]
mat_Sqrt:  [[27.61119477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00655048  0.00237923 -0.67932662]
Stock Position:  -0.006550480812970419
Bond Position:  [-4.04176132]


portfolio before change:  [-4.71811802]
curr_Stock_Price:  103.17585289784765
curr_Factors:  [103.1758529   -0.29130378  -1.04773246]
mat_Sqrt:  [[27.04219987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05076367 -0.90433988  6.68030494]
Stock Position:  0.0507636684151395
Bond Position:  [-9.95570281]


portfolio before change:  [-4.69975864]
curr_Stock_Price:  103.56203301494536
curr_Factors:  [103.56203301  -0.26574176  -1.05972262]
mat_Sqrt:  [[27.51431481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078757 -0.03053791  0.10625201]
Stock Position:  -0.0007875672365727137
Bond Position:  [-4.61819658]


portfolio before change:  [-4.70040185]
curr_Stock_Price:  103.64570413282992
curr_Factors:  [103.64570413  -0.17832886  -1.05530785]
mat_Sqrt:  [[30.18489649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00471336 -0.02836579  0.06372372]
Stock Position:  0.004713356323382321
Bond Position:  [-5.18892098]


portfolio before change:  [-4.70093061]
curr_Stock_Price:  103.67114055647183
curr_Factors:  [103.67114056  -0.32488577  -1.07730199]
mat_Sqrt:  [[25.50911947  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01004308 -0.09504702 -0.05692218]
Stock Position:  -0.010043078484240615
Bond Position:  [-3.65975321]


portfolio before change:  [-4.70267649]
curr_Stock_Price:  103.7994253831152
curr_Factors:  [103.79942538  -0.77342739  -1.092251  ]
mat_Sqrt:  [[16.06723404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04066436 -0.55448273 -0.58271584]
Stock Position:  -0.04066436164694292
Bond Position:  [-0.48173911]


portfolio before change:  [-4.7451379]
curr_Stock_Price:  104.84213668807199
curr_Factors:  [104.84213669  -0.79797053  -1.05589507]
mat_Sqrt:  [[16.42147873  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00141864 0.01081713 0.23030343]
Stock Position:  0.0014186387012414443
Bond Position:  [-4.89387101]


portfolio before change:  [-4.74546156]
curr_Stock_Price:  105.04522476536431
curr_Factors:  [105.04522477  -0.93849513  -1.01985081]
mat_Sqrt:  [[14.82099896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01882511 -0.16298831  0.77354918]
Stock Position:  0.01882511173383098
Bond Position:  [-6.72294965]


portfolio before change:  [-4.76478637]
curr_Stock_Price:  104.06332422189142
curr_Factors:  [104.06332422  -0.93463502  -0.97858491]
mat_Sqrt:  [[15.36019882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00418441  0.01862212 -0.18323954]
Stock Position:  0.004184409388251445
Bond Position:  [-5.20022992]


portfolio before change:  [-4.76808924]
curr_Stock_Price:  103.42935059095186
curr_Factors:  [103.42935059  -0.6944639   -0.98236707]
mat_Sqrt:  [[19.33772427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00284063 -0.01768005 -0.17710075]
Stock Position:  0.0028406332386245285
Bond Position:  [-5.0618941]


portfolio before change:  [-4.76759255]
curr_Stock_Price:  103.82696157480218
curr_Factors:  [103.82696157  -0.6537579   -0.99183787]
mat_Sqrt:  [[20.02797245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01832136 0.08140593 0.69175541]
Stock Position:  0.018321363680875096
Bond Position:  [-6.66984408]


portfolio before change:  [-4.76221718]
curr_Stock_Price:  104.16586398664471
curr_Factors:  [104.16586399  -0.66283297  -0.97924362]
mat_Sqrt:  [[20.16418251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00862534  0.0217677   0.17853678]
Stock Position:  -0.008625342100567878
Bond Position:  [-3.86375097]


portfolio before change:  [-4.77227362]
curr_Stock_Price:  105.27578437950426
curr_Factors:  [105.27578438  -0.72570072  -1.00451333]
mat_Sqrt:  [[18.65976078  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00770167 -0.10121438  0.32319065]
Stock Position:  -0.007701670600204889
Bond Position:  [-3.96147421]


portfolio before change:  [-4.77589792]
curr_Stock_Price:  105.68207019046143
curr_Factors:  [105.68207019  -0.77231231  -0.98354787]
mat_Sqrt:  [[18.25748377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00580482 -0.01389129 -0.44331897]
Stock Position:  0.005804818520371059
Bond Position:  [-5.38936316]


portfolio before change:  [-4.76723226]
curr_Stock_Price:  107.29096976777163
curr_Factors:  [107.29096977  -0.90696155  -1.00398412]
mat_Sqrt:  [[15.87267088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.49554726e-02 -4.47198232e-04  1.16022879e+00]
Stock Position:  0.04495547258242692
Bond Position:  [-9.59054851]


portfolio before change:  [-4.78253985]
curr_Stock_Price:  106.97713269255782
curr_Factors:  [106.97713269  -0.83011626  -1.00810804]
mat_Sqrt:  [[17.02002859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014607   0.01961254  0.30142108]
Stock Position:  -0.0014607003318947082
Bond Position:  [-4.62627832]


portfolio before change:  [-4.78486134]
curr_Stock_Price:  108.17051000094791
curr_Factors:  [108.17051     -0.52263268  -0.97192143]
mat_Sqrt:  [[24.26790449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141666 -0.02600141 -0.03673698]
Stock Position:  -0.0014166637144793469
Bond Position:  [-4.6316201]


portfolio before change:  [-4.78452442]
curr_Stock_Price:  107.52398907726655
curr_Factors:  [107.52398908  -0.39521017  -0.95454027]
mat_Sqrt:  [[27.88150405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0112109  -0.03536218 -0.23385725]
Stock Position:  0.011210896408465402
Bond Position:  [-5.98996473]


portfolio before change:  [-4.76522393]
curr_Stock_Price:  109.31236378610265
curr_Factors:  [109.31236379  -0.34716344  -0.97309608]
mat_Sqrt:  [[29.19361406  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134431 -0.03851019  0.00965446]
Stock Position:  -0.0013443128123905251
Bond Position:  [-4.61827392]


portfolio before change:  [-4.7651629]
curr_Stock_Price:  108.83751048555361
curr_Factors:  [108.83751049  -0.41761619  -1.00389633]
mat_Sqrt:  [[26.26779108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00694398 -0.0213704   0.35077556]
Stock Position:  -0.0069439789963148865
Bond Position:  [-4.00939751]


portfolio before change:  [-4.76202749]
curr_Stock_Price:  108.31380219177946
curr_Factors:  [108.31380219  -0.36961803  -0.98243756]
mat_Sqrt:  [[28.02163807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001715   -0.00452919 -0.12676898]
Stock Position:  -0.001714999678063837
Bond Position:  [-4.57626935]


portfolio before change:  [-4.76518771]
curr_Stock_Price:  109.82292819108446
curr_Factors:  [109.82292819  -0.50908353  -1.00847735]
mat_Sqrt:  [[24.0782379   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.030746   0.04506588 0.64472753]
Stock Position:  0.03074599956883287
Bond Position:  [-8.14180341]


portfolio before change:  [-4.80434034]
curr_Stock_Price:  108.5826093899251
curr_Factors:  [108.58260939  -0.56333538  -1.00499096]
mat_Sqrt:  [[22.62792863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00927964  0.10705282 -0.55517616]
Stock Position:  0.009279642795944279
Bond Position:  [-5.81194817]


portfolio before change:  [-4.80946337]
curr_Stock_Price:  108.10883052494533
curr_Factors:  [108.10883052  -0.95117609  -0.9761919 ]
mat_Sqrt:  [[15.73315741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110504  0.01474089  0.09935932]
Stock Position:  -0.0011050403810684254
Bond Position:  [-4.68999875]


portfolio before change:  [-4.81012574]
curr_Stock_Price:  108.1776746994085
curr_Factors:  [108.1776747   -0.96080314  -0.99555403]
mat_Sqrt:  [[15.29334622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.19286883 0.59282031 0.62473766]
Stock Position:  0.1928688329248847
Bond Position:  [-25.6742276]


portfolio before change:  [-4.92467406]
curr_Stock_Price:  107.60039714558995
curr_Factors:  [107.60039715  -0.82256379  -0.97188537]
mat_Sqrt:  [[17.88522898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00620706  0.0052807  -0.00131864]
Stock Position:  -0.006207055542990873
Bond Position:  [-4.25679242]


portfolio before change:  [-4.91786689]
curr_Stock_Price:  106.41798442729178
curr_Factors:  [106.41798443  -0.98047764  -0.9778161 ]
mat_Sqrt:  [[15.01546765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.29774653e-05 -4.02508586e-03 -5.00961524e-01]
Stock Position:  -3.2977465345623356e-05
Bond Position:  [-4.9143575]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.91848926]
Stock Price:  106.66140368588393
PL:  [-11.57989294]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.41174782e-01 -2.72634842e-02 -1.95083861e-01]
 [ 1.49690986e+00  3.14465883e-01  4.81635943e-01]
 [-1.26078513e-01 -2.91882082e-02  3.36714253e-02]
 [ 1.24362738e-01  1.06637176e+00  8.14838403e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.26739163e-02 -6.52545508e-02  5.07922429e-02]
 [-4.25054328e-02 -5.29051238e-02 -4.40395240e-02]
 [ 3.26452162e-02  1.86406758e-01 -3.84373484e-02]
 [ 6.57652986e-04  7.98215672e-02 -4.88214967e-02]
 [-1.37181964e-01 -7.25904134e-02 -4.11959257e-02]
 [ 8.15773845e-01  1.56833016e+00 -2.84309277e-01]
 [-9.73141943e-05  2.79144206e-02 -5.84452568e-02]
 [-2.88466778e-01 -1.67460617e-03 -5.96630546e-01]
 [ 1.79511855e+00 -3.19499343e+00  2.69053491e+00]
 [ 6.79045240e-03 -9.17948342e-02  3.55091429e-02]
 [ 1.07900773e-01  5.43343248e-02 -5.69176571e-02]
 [-2.41433592e-02  9.69571160e-02 -8.25370135e-02]
 [-2.86712419e-01 -1.85181264e+00 -1.99673174e-01]
 [ 1.15192166e-02 -3.93999233e-02  1.58606184e-01]
 [ 6.49437676e-02  1.24339332e-01  2.06174299e-01]
 [ 2.63786822e-02 -2.89171276e-03  1.48655815e-02]
 [ 1.14526264e-01 -5.15580852e-02  5.09635728e-02]
 [ 1.06607928e-01 -4.61612288e-02 -3.24049732e-02]
 [-9.80046051e-02 -2.63336619e-02  6.84624484e-02]
 [ 5.77896016e-02 -3.37491293e-02 -7.23370694e-03]
 [ 5.25853934e-02 -4.11879939e-02  2.95996435e-01]
 [ 9.78424674e-02 -1.02521521e-01  4.21366159e-02]
 [-6.05273051e-02  3.91764445e-03  7.32720078e-02]
 [ 1.47366865e-02 -5.14390258e-02  3.75536032e-02]
 [-5.86451229e-02  9.11076035e-02  9.19418104e-03]
 [ 3.74891134e-02 -1.23702100e-02 -7.72584389e-02]
 [-3.01467136e-02  1.86773427e-02 -5.02297313e-02]
 [-1.05860768e-01 -3.20271824e-02  4.09186263e-02]
 [ 1.98995044e-01  6.96904286e-03  3.41276270e-02]
 [-9.60805432e-02  3.49436464e-03  4.27621414e-02]
 [-1.13962892e-01 -6.27816008e-02 -8.09368453e-02]
 [ 1.70709981e+00  1.11916460e+00  1.47431580e-01]
 [-1.27893277e-02 -1.27885038e-01 -5.02937257e-02]
 [ 3.45277496e-02 -1.38434238e-02 -9.71963287e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.25178402]
curr_Stock_Price:  100.66102170346363
curr_Factors:  [100.6610217   -1.21118937  -0.9848584 ]
mat_Sqrt:  [[11.19772774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00855426 -0.00879925 -0.55651995]
Stock Position:  0.008554264101747483
Bond Position:  [6.39070306]


portfolio before change:  [7.25656131]
curr_Stock_Price:  101.126099131123
curr_Factors:  [101.12609913  -1.08783773  -0.99206901]
mat_Sqrt:  [[12.63488332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.13133588 0.10149343 1.37397328]
Stock Position:  0.1313358755405913
Bond Position:  [-6.02492346]


portfolio before change:  [7.2390314]
curr_Stock_Price:  100.99835989597021
curr_Factors:  [100.9983599   -1.10744658  -0.99524123]
mat_Sqrt:  [[12.33470051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01014726 -0.00942045  0.0960552 ]
Stock Position:  -0.01014725731172052
Bond Position:  [8.26388774]


portfolio before change:  [7.24098371]
curr_Stock_Price:  100.90776752949913
curr_Factors:  [100.90776753  -1.15644044  -1.01939201]
mat_Sqrt:  [[11.45440602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04438145 0.34417001 2.32450716]
Stock Position:  0.04438145059339849
Bond Position:  [2.76255061]


portfolio before change:  [7.26710868]
curr_Stock_Price:  101.4886324309341
curr_Factors:  [101.48863243  -1.3435062   -1.05496085]
mat_Sqrt:  [[ 9.2209655   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00636007 -0.01106097 -0.05874131]
Stock Position:  -0.00636007161448955
Bond Position:  [7.91258365]


portfolio before change:  [7.27020621]
curr_Stock_Price:  101.15712721916007
curr_Factors:  [101.15712722  -1.36087336  -1.03635094]
mat_Sqrt:  [[ 9.20227482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0064899  -0.02106082  0.14489613]
Stock Position:  0.006489896379542949
Bond Position:  [6.61370694]


portfolio before change:  [7.27200588]
curr_Stock_Price:  101.30703700257816
curr_Factors:  [101.307037    -1.38604345  -1.0453628 ]
mat_Sqrt:  [[ 8.9062175   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00699446 -0.01707506 -0.1256325 ]
Stock Position:  -0.006994459334577242
Bond Position:  [7.98059383]


portfolio before change:  [7.27806767]
curr_Stock_Price:  100.58301285036977
curr_Factors:  [100.58301285  -1.3184328   -1.02582384]
mat_Sqrt:  [[ 9.6477695   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00651439  0.06016252 -0.10965106]
Stock Position:  0.006514391279501089
Bond Position:  [6.62283057]


portfolio before change:  [7.27772122]
curr_Stock_Price:  100.40274109405402
curr_Factors:  [100.40274109  -1.19304175  -1.05710706]
mat_Sqrt:  [[10.58079635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00066021  0.0257623  -0.13927414]
Stock Position:  0.0006602070056418518
Bond Position:  [7.21143462]


portfolio before change:  [7.27883121]
curr_Stock_Price:  100.71857101347472
curr_Factors:  [100.71857101  -1.13037525  -1.06706435]
mat_Sqrt:  [[11.18854631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01433685 -0.02342846 -0.11752051]
Stock Position:  -0.014336849335638845
Bond Position:  [8.72281819]


portfolio before change:  [7.2768245]
curr_Stock_Price:  100.9345969341642
curr_Factors:  [100.93459693  -1.20580923  -1.0600597 ]
mat_Sqrt:  [[10.47094027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10293951  0.50617638 -0.81105523]
Stock Position:  0.10293951474684745
Bond Position:  [-3.11333393]


portfolio before change:  [7.28050778]
curr_Stock_Price:  100.97415871902881
curr_Factors:  [100.97415872  -1.00402441  -1.09907885]
mat_Sqrt:  [[12.32662272  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051347  0.00900934 -0.16672805]
Stock Position:  -0.000513473575076573
Bond Position:  [7.33235535]


portfolio before change:  [7.28182762]
curr_Stock_Price:  100.18884185103613
curr_Factors:  [100.18884185  -0.97414513  -1.12507137]
mat_Sqrt:  [[12.27838405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.34405003e-02 -5.40476818e-04 -1.70202088e+00]
Stock Position:  -0.033440500298369924
Bond Position:  [10.63219262]


portfolio before change:  [7.29049291]
curr_Stock_Price:  99.96946192753943
curr_Factors:  [99.96946193 -0.89149557 -1.09631669]
mat_Sqrt:  [[13.69529715  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12355675 -1.0311797   7.67534719]
Stock Position:  0.12355674827395338
Bond Position:  [-5.06140874]


portfolio before change:  [7.3039332]
curr_Stock_Price:  100.08336112702492
curr_Factors:  [100.08336113  -0.79584621  -1.12291127]
mat_Sqrt:  [[14.69116018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031984 -0.02962666  0.1012977 ]
Stock Position:  -0.00031983969756208723
Bond Position:  [7.33594384]


portfolio before change:  [7.30511008]
curr_Stock_Price:  99.27099737349604
curr_Factors:  [99.27099737 -0.8782861  -1.12396932]
mat_Sqrt:  [[13.4046014   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00801019  0.01753633 -0.16237023]
Stock Position:  0.008010193642997553
Bond Position:  [6.50993017]


portfolio before change:  [7.30374784]
curr_Stock_Price:  98.9993396901141
curr_Factors:  [98.99933969 -0.72493506 -1.14342193]
mat_Sqrt:  [[15.28323069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138713  0.03129277 -0.23545513]
Stock Position:  -0.0013871326363943974
Bond Position:  [7.44107306]


portfolio before change:  [7.30512098]
curr_Stock_Price:  98.68001278077976
curr_Factors:  [98.68001278 -0.66265112 -1.14273821]
mat_Sqrt:  [[16.22402377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04348306 -0.59766996 -0.56961199]
Stock Position:  -0.04348306047374034
Bond Position:  [11.59602995]


portfolio before change:  [7.29135127]
curr_Stock_Price:  99.03001820046309
curr_Factors:  [99.0300182  -0.74192503 -1.1403975 ]
mat_Sqrt:  [[15.07594605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0023781  -0.01271627  0.4524593 ]
Stock Position:  0.002378099029539192
Bond Position:  [7.05584808]


portfolio before change:  [7.29015387]
curr_Stock_Price:  98.15560593843261
curr_Factors:  [98.15560594 -0.5007938  -1.13322083]
mat_Sqrt:  [[19.15453308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0069127  0.04013035 0.58815789]
Stock Position:  0.006912702047416811
Bond Position:  [6.61163341]


portfolio before change:  [7.28666031]
curr_Stock_Price:  97.53065945843669
curr_Factors:  [97.53065946 -0.68781178 -1.13001439]
mat_Sqrt:  [[15.83686759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00181998 -0.0009333   0.04240737]
Stock Position:  0.0018199835121156676
Bond Position:  [7.10915611]


portfolio before change:  [7.28532562]
curr_Stock_Price:  96.30901050868843
curr_Factors:  [96.30901051 -0.40112999 -1.14021744]
mat_Sqrt:  [[20.61903017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00554851 -0.0166403   0.14538489]
Stock Position:  0.005548510719957881
Bond Position:  [6.75095405]


portfolio before change:  [7.28931799]
curr_Stock_Price:  96.87645015555387
curr_Factors:  [96.87645016 -0.58350347 -1.13030911]
mat_Sqrt:  [[17.45496037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00518882 -0.01489847 -0.09244237]
Stock Position:  0.005188821221710989
Bond Position:  [6.78664341]


portfolio before change:  [7.29413805]
curr_Stock_Price:  97.64187851108402
curr_Factors:  [97.64187851 -0.42714805 -1.16047679]
mat_Sqrt:  [[19.95902948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00447943 -0.00849915  0.19530431]
Stock Position:  -0.004479431363360325
Bond Position:  [7.73151814]


portfolio before change:  [7.29387746]
curr_Stock_Price:  97.91581687704536
curr_Factors:  [97.91581688 -0.48902091 -1.13775071]
mat_Sqrt:  [[19.24663948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00256793 -0.01089248 -0.02063575]
Stock Position:  0.002567929596883588
Bond Position:  [7.04243653]


portfolio before change:  [7.29677825]
curr_Stock_Price:  98.70261172263046
curr_Factors:  [98.70261172 -0.75820169 -1.13120489]
mat_Sqrt:  [[14.92003326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00701057 -0.01329337  0.84439544]
Stock Position:  0.007010570740191667
Bond Position:  [6.60481661]


portfolio before change:  [7.3006988]
curr_Stock_Price:  99.14407307655404
curr_Factors:  [99.14407308 -0.83287499 -1.138455  ]
mat_Sqrt:  [[13.80794413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00619328 -0.03308868  0.12020404]
Stock Position:  0.006193278989692136
Bond Position:  [6.6866719]


portfolio before change:  [7.29944725]
curr_Stock_Price:  98.80702447447015
curr_Factors:  [98.80702447 -1.01427792 -1.1264876 ]
mat_Sqrt:  [[11.6162292   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00385418  0.00126441  0.20902464]
Stock Position:  -0.0038541795768875136
Bond Position:  [7.68026727]


portfolio before change:  [7.30014318]
curr_Stock_Price:  98.87556412911024
curr_Factors:  [98.87556413 -1.21259783 -1.13988962]
mat_Sqrt:  [[ 9.40625303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00126536 -0.01660187  0.10712998]
Stock Position:  0.0012653642634346002
Bond Position:  [7.17502958]


portfolio before change:  [7.30024655]
curr_Stock_Price:  98.24841999844756
curr_Factors:  [98.24842    -1.03990358 -1.14314157]
mat_Sqrt:  [[11.07238333  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344742  0.02940485  0.02622844]
Stock Position:  -0.0034474155879206363
Bond Position:  [7.63894968]


portfolio before change:  [7.30068807]
curr_Stock_Price:  98.39734427402578
curr_Factors:  [98.39734427 -1.10927304 -1.12644947]
mat_Sqrt:  [[10.52013772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00182448 -0.00399247 -0.22039682]
Stock Position:  0.0018244763046234974
Bond Position:  [7.12116445]


portfolio before change:  [7.302488]
curr_Stock_Price:  98.89596766959555
curr_Factors:  [98.89596767 -1.08356299 -1.1352105 ]
mat_Sqrt:  [[10.75418491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00340215  0.00602809 -0.14329144]
Stock Position:  -0.003402147002477317
Bond Position:  [7.63894662]


portfolio before change:  [7.30147524]
curr_Stock_Price:  99.47433588961553
curr_Factors:  [99.47433589 -0.88667942 -1.12354635]
mat_Sqrt:  [[13.32542562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00780807 -0.01033673  0.11672945]
Stock Position:  -0.007808066534363471
Bond Position:  [8.07817747]


portfolio before change:  [7.30020671]
curr_Stock_Price:  99.76613157398724
curr_Factors:  [99.76613157 -0.88748247 -1.12659056]
mat_Sqrt:  [[13.31319621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01557732 0.00224925 0.09735662]
Stock Position:  0.015577316189441756
Bond Position:  [5.74611813]


portfolio before change:  [7.2964151]
curr_Stock_Price:  99.47661340157123
curr_Factors:  [99.4766134  -1.00347972 -1.12331094]
mat_Sqrt:  [[11.85953187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00730539  0.0011278   0.12198849]
Stock Position:  -0.007305387295127029
Bond Position:  [8.02313029]


portfolio before change:  [7.29344566]
curr_Stock_Price:  100.02037666359577
curr_Factors:  [100.02037666  -1.1000011   -1.10142493]
mat_Sqrt:  [[11.06678083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0129486  -0.02026267 -0.23089029]
Stock Position:  -0.01294859805594027
Bond Position:  [8.58856931]


portfolio before change:  [7.28968701]
curr_Stock_Price:  100.39356694299916
curr_Factors:  [100.39356694  -1.11326627  -1.10123338]
mat_Sqrt:  [[10.96379501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.17928488 0.36120882 0.42058126]
Stock Position:  0.1792848799765389
Bond Position:  [-10.70936159]


portfolio before change:  [7.26237257]
curr_Stock_Price:  100.24868199693806
curr_Factors:  [100.248682    -0.88176029  -1.12545652]
mat_Sqrt:  [[13.46962449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364969 -0.04127472 -0.143474  ]
Stock Position:  -0.003649687159925564
Bond Position:  [7.6282489]


portfolio before change:  [7.26320165]
curr_Stock_Price:  100.28279903621177
curr_Factors:  [100.28279904  -0.70387726  -1.14343495]
mat_Sqrt:  [[15.81062176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00075025 -0.00446795 -0.27727407]
Stock Position:  0.0007502459568140697
Bond Position:  [7.18796488]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.26334799]
Stock Price:  99.28019163191121
PL:  [7.26334799]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 3.00626054e-02 -5.94819665e-02 -2.92403552e-02]
 [ 8.14237603e-01  2.06137099e-01  2.26343396e-01]
 [-3.41013356e-01 -2.27425358e-01  3.97434963e-02]
 [ 2.56636894e-01  1.77576523e+00  1.61644293e+00]
 [-4.88523798e-02 -2.68124003e-02 -9.16333556e-03]
 [-1.78252240e-02  2.19258854e-01 -8.52685311e-02]
 [-2.10315492e-01  3.65423044e-01  3.20648075e-01]
 [-4.17190030e-02  7.78398264e-02  1.93800451e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 7.05031813e-01  1.51612922e+00 -2.05979228e-01]
 [-1.37082779e-03  2.28430205e-02  1.37925406e-01]
 [-5.20595751e-01 -2.47512012e-02 -1.11966643e+00]
 [ 2.00719977e+00 -3.10604751e+00  2.63640529e+00]
 [ 2.66717368e-02 -6.77070256e-02  3.22910787e-04]
 [ 2.79335468e-02  1.74788574e-01 -9.93635942e-02]
 [-2.54938598e-02  9.28142935e-02 -8.40112517e-02]
 [-2.84649149e-01 -1.82537291e+00 -1.94366758e-01]
 [ 1.69253360e-02 -3.56831594e-02  9.65990126e-02]
 [ 9.83180870e-02  1.64596771e-01  2.73702242e-01]
 [ 3.68421916e-02 -5.33026672e-02  1.05487372e-01]
 [ 1.17585554e-01 -5.10550290e-02 -4.81528983e-03]
 [ 1.14864983e-01  1.01750273e-01  9.53020778e-02]
 [-7.08107880e-02 -4.61312626e-02  7.64733555e-02]
 [ 7.82076329e-02 -7.11709522e-03 -2.12893345e-02]
 [ 4.96680726e-02 -4.17001820e-02  2.92156571e-01]
 [ 9.83097914e-03 -1.11372671e-01  7.77058081e-03]
 [-4.61081415e-02 -6.48933871e-03  7.53271734e-02]
 [ 6.83719248e-04 -6.50619562e-02  1.39634742e-02]
 [-1.00263160e-02  5.57608142e-02  6.65352681e-02]
 [-1.28740114e-02 -1.73196067e-02 -6.76208550e-02]
 [-1.32568356e-02  2.03984145e-02 -5.53635465e-02]
 [-9.13321513e-02 -2.95085166e-02  3.83428647e-02]
 [-3.72685992e-02 -2.58943827e-02 -7.06604176e-03]
 [-9.77900904e-02  5.63778826e-02  3.79603451e-02]
 [-1.07869006e-01 -6.09472469e-02 -7.09742485e-02]
 [ 1.87347769e+00  1.21098638e+00  1.51514138e-01]
 [-5.51022154e-02  4.31371315e-03  1.99384216e-02]
 [ 3.31846932e-02 -1.41637640e-02 -7.27231733e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.6550507]
curr_Stock_Price:  99.58204238972712
curr_Factors:  [99.58204239 -1.18620215 -1.00721786]
mat_Sqrt:  [[11.1068478   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107611 -0.01919772 -0.08341459]
Stock Position:  0.001076114264562514
Bond Position:  [-0.76221236]


portfolio before change:  [-0.65529292]
curr_Stock_Price:  99.44550023940883
curr_Factors:  [99.44550024 -1.08765028 -0.99997627]
mat_Sqrt:  [[12.32935744  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07320068 0.06653046 0.64569471]
Stock Position:  0.07320067723336268
Bond Position:  [-7.93477089]


portfolio before change:  [-0.66979049]
curr_Stock_Price:  99.26099833723781
curr_Factors:  [99.26099834 -0.91132381 -0.97959304]
mat_Sqrt:  [[14.98179616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02531898 -0.07340122  0.11337713]
Stock Position:  -0.025318977191916548
Bond Position:  [1.84339646]


portfolio before change:  [-0.64219433]
curr_Stock_Price:  98.18015993795531
curr_Factors:  [98.18015994 -1.05742156 -0.98823282]
mat_Sqrt:  [[12.69425823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0747636  0.57312576 4.61126175]
Stock Position:  0.07476360323036325
Bond Position:  [-7.98249686]


portfolio before change:  [-0.65884048]
curr_Stock_Price:  97.970856649743
curr_Factors:  [97.97085665 -1.14252473 -0.97359806]
mat_Sqrt:  [[11.80528444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00476023 -0.00865366 -0.02614045]
Stock Position:  -0.004760232282766173
Bond Position:  [-0.19247644]


portfolio before change:  [-0.65888694]
curr_Stock_Price:  97.97556253078885
curr_Factors:  [97.97556253 -1.26809709 -0.97579504]
mat_Sqrt:  [[10.38981455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091681  0.07076549 -0.24324739]
Stock Position:  0.0009168052095116152
Bond Position:  [-0.74871144]


portfolio before change:  [-0.65963092]
curr_Stock_Price:  97.26615651732443
curr_Factors:  [97.26615652 -1.17913186 -0.98704144]
mat_Sqrt:  [[11.14819719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00630342  0.11793978  0.91471971]
Stock Position:  -0.006303423774840358
Bond Position:  [-0.04652112]


portfolio before change:  [-0.65916451]
curr_Stock_Price:  97.1912409941737
curr_Factors:  [97.19124099 -0.93380395 -0.99513319]
mat_Sqrt:  [[14.12213548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154892  0.0251227   0.05528587]
Stock Position:  -0.00154892153895192
Bond Position:  [-0.5086229]


portfolio before change:  [-0.66123206]
curr_Stock_Price:  98.48502092683937
curr_Factors:  [98.48502093 -0.82501073 -0.98220706]
mat_Sqrt:  [[16.16238584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0032168   0.0064198  -0.11330016]
Stock Position:  0.003216802510392984
Bond Position:  [-0.97803892]


portfolio before change:  [-0.66692219]
curr_Stock_Price:  96.75414962786623
curr_Factors:  [96.75414963 -0.73706055 -0.96509191]
mat_Sqrt:  [[17.63738436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.95577592e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  4.955775920375667e-05
Bond Position:  [-0.67171711]


portfolio before change:  [-0.66702888]
curr_Stock_Price:  96.2957541780821
curr_Factors:  [96.29575418 -0.77256155 -0.93263323]
mat_Sqrt:  [[17.50049989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05556784  0.4893286  -0.5876014 ]
Stock Position:  0.055567844705552163
Bond Position:  [-6.01797639]


portfolio before change:  [-0.64781]
curr_Stock_Price:  96.65515579334489
curr_Factors:  [96.65515579 -0.76750723 -0.91954079]
mat_Sqrt:  [[17.8874891   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00175798 0.00737255 0.39346279]
Stock Position:  0.0017579823325368003
Bond Position:  [-0.81772805]


portfolio before change:  [-0.647801]
curr_Stock_Price:  96.71842358302692
curr_Factors:  [96.71842358 -0.71291336 -0.92001944]
mat_Sqrt:  [[18.89450458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03991632 -0.00798842 -3.19409668]
Stock Position:  -0.03991631635554059
Bond Position:  [3.2128422]


portfolio before change:  [-0.66345633]
curr_Stock_Price:  97.12068922653472
curr_Factors:  [97.12068923 -0.81177143 -0.92073006]
mat_Sqrt:  [[17.17496738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11128606 -1.00247252  7.52093045]
Stock Position:  0.111286060119661
Bond Position:  [-11.47163519]


portfolio before change:  [-0.62371915]
curr_Stock_Price:  97.49064775885822
curr_Factors:  [97.49064776 -0.95131951 -0.9104517 ]
mat_Sqrt:  [[15.1497684   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085262 -0.02185235  0.00092117]
Stock Position:  0.000852621082395224
Bond Position:  [-0.70684173]


portfolio before change:  [-0.62355631]
curr_Stock_Price:  97.7852620198102
curr_Factors:  [97.78526202 -0.98632598 -0.89910089]
mat_Sqrt:  [[14.84030809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00291972  0.05641277 -0.28345668]
Stock Position:  0.0029197241794961413
Bond Position:  [-0.90906231]


portfolio before change:  [-0.62206211]
curr_Stock_Price:  98.33594580581833
curr_Factors:  [98.33594581 -0.92708036 -0.8931698 ]
mat_Sqrt:  [[15.92897016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148766  0.02995568 -0.23966072]
Stock Position:  -0.0014876634342221545
Bond Position:  [-0.47577132]


portfolio before change:  [-0.62127621]
curr_Stock_Price:  97.76769338224574
curr_Factors:  [97.76769338 -0.97767549 -0.89243666]
mat_Sqrt:  [[15.06662502  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04625633 -0.58913657 -0.55447426]
Stock Position:  -0.04625633027108842
Bond Position:  [3.9010985]


portfolio before change:  [-0.64512014]
curr_Stock_Price:  98.29370992616069
curr_Factors:  [98.29370993 -0.94618731 -0.93160028]
mat_Sqrt:  [[15.03186741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00195317 -0.01151669  0.27557009]
Stock Position:  0.0019531660055830194
Bond Position:  [-0.83710407]


portfolio before change:  [-0.64474081]
curr_Stock_Price:  98.54150085962073
curr_Factors:  [98.54150086 -0.65742461 -0.91410233]
mat_Sqrt:  [[20.46980454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00917378 0.05312338 0.78079631]
Stock Position:  0.009173780725294168
Bond Position:  [-1.54873893]


portfolio before change:  [-0.63178793]
curr_Stock_Price:  99.97455069915806
curr_Factors:  [99.9745507  -0.68019645 -0.9325081 ]
mat_Sqrt:  [[19.92970058  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00238309 -0.01720336  0.30092611]
Stock Position:  0.0023830940007072967
Bond Position:  [-0.87003668]


portfolio before change:  [-0.63018635]
curr_Stock_Price:  100.69224849718412
curr_Factors:  [100.6922485   -0.75230967  -0.97081208]
mat_Sqrt:  [[17.97437406  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00590736 -0.01647794 -0.01373668]
Stock Position:  0.00590735860823326
Bond Position:  [-1.22501157]


portfolio before change:  [-0.630622]
curr_Stock_Price:  100.64442357897234
curr_Factors:  [100.64442358  -0.82687984  -0.96451401]
mat_Sqrt:  [[16.78020458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00924233 0.03283976 0.2718703 ]
Stock Position:  0.009242326245429389
Bond Position:  [-1.5608106]


portfolio before change:  [-0.65436271]
curr_Stock_Price:  98.096840509312
curr_Factors:  [98.09684051 -0.66054498 -0.96216107]
mat_Sqrt:  [[19.36077493  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00333753 -0.0148888   0.2181572 ]
Stock Position:  -0.0033375334652664076
Bond Position:  [-0.32696122]


portfolio before change:  [-0.65136893]
curr_Stock_Price:  97.18758976777343
curr_Factors:  [97.18758977 -0.54851464 -0.96660347]
mat_Sqrt:  [[21.36010472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00338993 -0.00229703 -0.06073255]
Stock Position:  0.003389926955046412
Bond Position:  [-0.98082776]


portfolio before change:  [-0.64737708]
curr_Stock_Price:  98.40131988448259
curr_Factors:  [98.40131988 -0.71697245 -0.95259017]
mat_Sqrt:  [[18.53186342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00543886 -0.01345868  0.83344138]
Stock Position:  0.005438863147372923
Bond Position:  [-1.1825684]


portfolio before change:  [-0.64139942]
curr_Stock_Price:  99.5275643847404
curr_Factors:  [99.52756438 -0.54640606 -0.96070229]
mat_Sqrt:  [[22.05030176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051322 -0.03594538  0.0221673 ]
Stock Position:  -0.0005132224094261781
Bond Position:  [-0.59031965]


portfolio before change:  [-0.64219463]
curr_Stock_Price:  100.93321612039462
curr_Factors:  [100.93321612  -0.88691298  -0.93211799]
mat_Sqrt:  [[16.36963518  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019583  -0.00209443  0.21488746]
Stock Position:  -0.0019583012713652375
Bond Position:  [-0.44453698]


portfolio before change:  [-0.64029087]
curr_Stock_Price:  99.9326880646144
curr_Factors:  [99.93268806 -0.96097183 -0.92885036]
mat_Sqrt:  [[15.09969657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064549 -0.02099866  0.03983391]
Stock Position:  -0.0006454907668303305
Bond Position:  [-0.57578524]


portfolio before change:  [-0.64073545]
curr_Stock_Price:  100.50993437758433
curr_Factors:  [100.50993438  -0.82810678  -0.91738337]
mat_Sqrt:  [[17.54495467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00085137 0.01799673 0.1898066 ]
Stock Position:  0.0008513710952967138
Bond Position:  [-0.7263067]


portfolio before change:  [-0.64073994]
curr_Stock_Price:  100.61130857739714
curr_Factors:  [100.61130858  -0.74635891  -0.9425318 ]
mat_Sqrt:  [[18.58535581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016256  -0.00558988 -0.19290348]
Stock Position:  -0.0016256030176623343
Bond Position:  [-0.47718589]


portfolio before change:  [-0.64038535]
curr_Stock_Price:  100.35648879008397
curr_Factors:  [100.35648879  -0.54401789  -0.95307866]
mat_Sqrt:  [[22.45766963  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090811  0.00658356 -0.15793679]
Stock Position:  -0.0009081112853175537
Bond Position:  [-0.54925049]


portfolio before change:  [-0.63877613]
curr_Stock_Price:  98.50882718849478
curr_Factors:  [98.50882719 -0.65594808 -0.93442957]
mat_Sqrt:  [[20.08088776  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445841 -0.00952383  0.10938152]
Stock Position:  -0.004458410832943798
Bond Position:  [-0.19958331]


portfolio before change:  [-0.63228456]
curr_Stock_Price:  97.04720337978239
curr_Factors:  [97.04720338 -0.52864883 -0.91012672]
mat_Sqrt:  [[23.02134753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191112 -0.00835738 -0.02015745]
Stock Position:  -0.001911122603688866
Bond Position:  [-0.44681546]


portfolio before change:  [-0.63079663]
curr_Stock_Price:  96.23941472042942
curr_Factors:  [96.23941472 -0.4310469  -0.9213332 ]
mat_Sqrt:  [[24.88982013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00315524  0.01819588  0.1082903 ]
Stock Position:  -0.0031552409749547993
Bond Position:  [-0.32713809]


portfolio before change:  [-0.62830894]
curr_Stock_Price:  95.43802116483405
curr_Factors:  [95.43802116 -0.53295364 -0.9438456 ]
mat_Sqrt:  [[21.79493928  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0061848  -0.01967064 -0.20246978]
Stock Position:  -0.006184801290277506
Bond Position:  [-0.03804374]


portfolio before change:  [-0.63199777]
curr_Stock_Price:  96.03368752832851
curr_Factors:  [96.03368753 -0.42422312 -0.96291223]
mat_Sqrt:  [[23.98823965  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08969382 0.39084417 0.43222766]
Stock Position:  0.08969382388807745
Bond Position:  [-9.24562643]


portfolio before change:  [-0.46657294]
curr_Stock_Price:  97.89090128281698
curr_Factors:  [97.89090128 -0.32408422 -0.98608282]
mat_Sqrt:  [[26.40851684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189908  0.00139224  0.05687877]
Stock Position:  -0.0018990755694502392
Bond Position:  [-0.28067073]


portfolio before change:  [-0.46822518]
curr_Stock_Price:  98.74244640851059
curr_Factors:  [98.74244641 -0.43544114 -0.99840933]
mat_Sqrt:  [[23.53913677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065631 -0.00457134 -0.20745897]
Stock Position:  0.0006563100233143705
Bond Position:  [-0.53303084]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.46903955]
Stock Price:  97.6031390091832
PL:  [-0.46903955]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-3.25495125e-02 -6.23001278e-02  2.37029215e-01]
 [ 1.54311927e+00  3.33621989e-01  5.05818344e-01]
 [-1.22658845e-01 -2.53095376e-02  3.39375916e-02]
 [ 1.28445895e-01  9.36287513e-01  8.12555712e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-1.05138138e-02  1.91168166e-01 -7.35173784e-02]
 [-9.57826863e-02  1.21569750e-01  1.48360366e-02]
 [-6.34330807e-02  1.25943358e-01  6.51462416e-04]
 [ 5.16637650e-02  2.46247107e-02 -4.04356829e-02]
 [-7.62712986e-02 -3.47675344e-02  9.05751117e-04]
 [ 7.79850708e-01  1.60444513e+00 -2.45535054e-01]
 [-6.92330271e-04  2.66188723e-02  3.96767938e-02]
 [-4.49582282e-01 -3.15132350e-02 -1.04698462e+00]
 [ 2.03259123e+00 -3.22240697e+00  2.73345527e+00]
 [ 2.56698354e-02 -8.00216978e-02  1.98287758e-02]
 [ 9.48069856e-02  6.41031852e-02 -5.66312895e-02]
 [-3.74290627e-02  3.47225973e-02 -8.06737955e-02]
 [-2.79073890e-01 -1.79736578e+00 -1.95718757e-01]
 [-1.36731365e-02  2.32590944e-02  4.24300034e-01]
 [ 1.38659430e-01  2.48718763e-01  3.79639795e-01]
 [ 2.86076978e-02 -2.80241856e-02  3.31678657e-02]
 [ 1.15141224e-01 -5.15295673e-02  3.92751152e-02]
 [ 4.33638519e-02 -1.06803071e-03 -1.32106416e-02]
 [-1.10802468e-01 -1.47326559e-02  4.70247079e-02]
 [-2.45617723e-03 -1.17973900e-01  3.75076872e-02]
 [ 4.88546131e-02 -4.10304273e-03  1.99651961e-01]
 [ 8.50107510e-02 -1.04131738e-01  3.72029109e-02]
 [-7.25593132e-02  2.86355963e-02  1.03459258e-01]
 [ 6.93566529e-03 -5.90013269e-02  2.44583549e-02]
 [-2.55843949e-02  8.03410179e-02  2.15079521e-02]
 [ 4.92911574e-03 -1.67358845e-02 -7.10929659e-02]
 [-2.73912216e-02  1.86672118e-02 -5.09775074e-02]
 [-1.07268213e-01 -2.72517731e-02  4.14423516e-02]
 [-3.14141655e-02 -1.64537270e-02 -1.35031887e-03]
 [-8.70729400e-02 -1.95531539e-02  6.45720120e-02]
 [-1.15846332e-01 -6.70577678e-02 -7.84008913e-02]
 [ 2.28149124e+00  1.46311134e+00  1.66780062e-01]
 [ 3.17537941e-02 -1.20454851e-01  1.09608905e-03]
 [ 3.20367214e-02 -1.43084391e-02 -5.21806441e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.07722205]
curr_Stock_Price:  99.81843110003881
curr_Factors:  [99.8184311  -0.78997494 -1.00026183]
mat_Sqrt:  [[16.66175669  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.87069901e-04 -2.01072798e-02  6.76178375e-01]
Stock Position:  0.00018706990078931225
Bond Position:  [1.05854902]


portfolio before change:  [1.07763788]
curr_Stock_Price:  101.33395699114904
curr_Factors:  [101.33395699  -0.99719811  -0.98004308]
mat_Sqrt:  [[14.02975433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.12220238 0.10767603 1.44295894]
Stock Position:  0.1222023760327493
Bond Position:  [-11.30561243]


portfolio before change:  [1.03715563]
curr_Stock_Price:  101.0142499028771
curr_Factors:  [101.0142499   -0.97937031  -0.99405158]
mat_Sqrt:  [[14.03900753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00861155 -0.00816862  0.0968145 ]
Stock Position:  -0.008611552554458625
Bond Position:  [1.90704515]


portfolio before change:  [1.03840994]
curr_Stock_Price:  100.89627833154606
curr_Factors:  [100.89627833  -0.84102354  -0.99089105]
mat_Sqrt:  [[16.1541737   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03004963 0.3021855  2.31799527]
Stock Position:  0.030049634991145133
Bond Position:  [-1.9934864]


portfolio before change:  [1.03699901]
curr_Stock_Price:  100.8576180921573
curr_Factors:  [100.85761809  -0.85188968  -1.00018461]
mat_Sqrt:  [[15.82570497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00370574 -0.01106097 -0.05874131]
Stock Position:  -0.0037057433481967024
Bond Position:  [1.41075146]


portfolio before change:  [1.04509089]
curr_Stock_Price:  98.72160456821214
curr_Factors:  [98.72160457 -1.01007708 -0.9946324 ]
mat_Sqrt:  [[13.2977432   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00101533  0.06169926 -0.20972462]
Stock Position:  0.001015326617118099
Bond Position:  [0.94485621]


portfolio before change:  [1.0451007]
curr_Stock_Price:  98.61494181545041
curr_Factors:  [98.61494182 -0.89650601 -1.00037762]
mat_Sqrt:  [[14.79573787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00459179  0.03923647  0.04232308]
Stock Position:  -0.004591793412414156
Bond Position:  [1.49792014]


portfolio before change:  [1.04385348]
curr_Stock_Price:  98.92734229763174
curr_Factors:  [98.9273423  -1.05481155 -0.99179328]
mat_Sqrt:  [[12.77871415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294177  0.04064804  0.00185844]
Stock Position:  -0.0029417686957200428
Bond Position:  [1.33487483]


portfolio before change:  [1.04407196]
curr_Stock_Price:  98.90979548298503
curr_Factors:  [98.90979548 -1.00727522 -0.98579253]
mat_Sqrt:  [[13.47910261  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00359344  0.00794759 -0.11535175]
Stock Position:  0.003593441286480205
Bond Position:  [0.68864542]


portfolio before change:  [1.04352804]
curr_Stock_Price:  98.73447437335386
curr_Factors:  [98.73447437 -0.89947129 -0.95075715]
mat_Sqrt:  [[15.52118285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00535934 -0.01122117  0.00258386]
Stock Position:  -0.005359340646717593
Bond Position:  [1.57267973]


portfolio before change:  [1.04992715]
curr_Stock_Price:  97.57714795239819
curr_Factors:  [97.57714795 -0.79140765 -0.97376137]
mat_Sqrt:  [[16.70109526  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06330346  0.51783244 -0.70044316]
Stock Position:  0.0633034570148994
Bond Position:  [-5.12704364]


portfolio before change:  [1.0708704]
curr_Stock_Price:  97.91811155288376
curr_Factors:  [97.91811155 -1.09691666 -1.02238436]
mat_Sqrt:  [[11.76148853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00109172 0.0085912  0.11318685]
Stock Position:  0.0010917169073315029
Bond Position:  [0.96397154]


portfolio before change:  [1.07003391]
curr_Stock_Price:  97.04151617161571
curr_Factors:  [97.04151617 -1.01259087 -1.02674246]
mat_Sqrt:  [[12.6265982   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05304119 -0.01017085 -2.9867557 ]
Stock Position:  -0.053041185342019494
Bond Position:  [6.21723096]


portfolio before change:  [1.05023912]
curr_Stock_Price:  97.4293656130363
curr_Factors:  [97.42936561 -0.99571452 -1.05628998]
mat_Sqrt:  [[12.51744357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.15440728 -1.04002738  7.79778704]
Stock Position:  0.15440727732649032
Bond Position:  [-13.99356396]


portfolio before change:  [1.23599362]
curr_Stock_Price:  98.643711273907
curr_Factors:  [98.64371127 -0.98992299 -1.07781484]
mat_Sqrt:  [[12.4756239   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107273 -0.02582689  0.05656598]
Stock Position:  0.0010727324557593407
Bond Position:  [1.13017531]


portfolio before change:  [1.23671916]
curr_Stock_Price:  99.18835183186107
curr_Factors:  [99.18835183 -1.10156128 -1.08761248]
mat_Sqrt:  [[11.11001359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00867075  0.02068921 -0.16155331]
Stock Position:  0.008670752655671925
Bond Position:  [0.37668149]


portfolio before change:  [1.23630046]
curr_Stock_Price:  99.13463251295082
curr_Factors:  [99.13463251 -1.38644    -1.11071883]
mat_Sqrt:  [[ 8.16061897  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00573594  0.01120667 -0.23013988]
Stock Position:  -0.005735938900286362
Bond Position:  [1.80493065]


portfolio before change:  [1.2372766]
curr_Stock_Price:  99.0037889406251
curr_Factors:  [99.00378894 -1.66848122 -1.11015493]
mat_Sqrt:  [[ 6.15042986  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11152238 -0.58009731 -0.55833113]
Stock Position:  -0.1115223788295868
Bond Position:  [12.27841466]


portfolio before change:  [1.24108559]
curr_Stock_Price:  98.98339757280925
curr_Factors:  [98.98339757 -1.45118031 -1.10904446]
mat_Sqrt:  [[ 7.6501661   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01015461 0.00750684 1.21040989]
Stock Position:  0.010154614542175346
Bond Position:  [0.23594734]


portfolio before change:  [1.23631114]
curr_Stock_Price:  98.51031774044579
curr_Factors:  [98.51031774 -1.10238937 -1.08478759]
mat_Sqrt:  [[11.05612235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02414251 0.08027364 1.08300666]
Stock Position:  0.02414251357367431
Bond Position:  [-1.14197554]


portfolio before change:  [1.22489197]
curr_Stock_Price:  98.04324073680012
curr_Factors:  [98.04324074 -1.07309255 -1.07954959]
mat_Sqrt:  [[11.39034963  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00260375 -0.00904477  0.09461869]
Stock Position:  0.002603752127866082
Bond Position:  [0.96961168]


portfolio before change:  [1.22339946]
curr_Stock_Price:  97.42347102428245
curr_Factors:  [97.42347102 -0.98753032 -1.04022096]
mat_Sqrt:  [[12.82396745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00878354 -0.0166311   0.11204097]
Stock Position:  0.008783537141613822
Bond Position:  [0.36767678]


portfolio before change:  [1.23214941]
curr_Stock_Price:  98.41441444773459
curr_Factors:  [98.41441445 -0.94141758 -1.04753928]
mat_Sqrt:  [[13.46684065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00300362 -0.00034471 -0.03768628]
Stock Position:  0.003003616893369716
Bond Position:  [0.93655021]


portfolio before change:  [1.23870362]
curr_Stock_Price:  100.55754161734617
curr_Factors:  [100.55754162  -1.02540491  -1.02093914]
mat_Sqrt:  [[12.99267932  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00802074 -0.00475494  0.1341484 ]
Stock Position:  -0.008020738280592693
Bond Position:  [2.04524934]


portfolio before change:  [1.23429035]
curr_Stock_Price:  101.13965044357286
curr_Factors:  [101.13965044  -1.03295827  -0.99865862]
mat_Sqrt:  [[13.26176861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142374 -0.03807591  0.10699899]
Stock Position:  -0.0014237372666988698
Bond Position:  [1.37828664]


portfolio before change:  [1.23560034]
curr_Stock_Price:  100.34055737530137
curr_Factors:  [100.34055738  -0.79832413  -1.00830243]
mat_Sqrt:  [[16.4766366   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00538768 -0.00132425  0.56955147]
Stock Position:  0.0053876814146730755
Bond Position:  [0.69499739]


portfolio before change:  [1.233093]
curr_Stock_Price:  99.85904662282196
curr_Factors:  [99.85904662 -0.64154962 -1.00999659]
mat_Sqrt:  [[19.14829057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00372613 -0.03360837  0.10612955]
Stock Position:  0.0037261269406710746
Bond Position:  [0.86100551]


portfolio before change:  [1.23348741]
curr_Stock_Price:  99.93601189731213
curr_Factors:  [99.9360119  -0.87243974 -0.99928742]
mat_Sqrt:  [[15.37592445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296539  0.0092421   0.29514047]
Stock Position:  -0.0029653868330288082
Bond Position:  [1.52983634]


portfolio before change:  [1.23490679]
curr_Stock_Price:  99.52185374714576
curr_Factors:  [99.52185375 -1.02517845 -0.97778739]
mat_Sqrt:  [[13.42893098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.59259373e-06 -1.90425964e-02  6.97728785e-02]
Stock Position:  -8.592593733111057e-06
Bond Position:  [1.23576194]


portfolio before change:  [1.23506441]
curr_Stock_Price:  99.15590554165786
curr_Factors:  [99.15590554 -0.819106   -0.94299418]
mat_Sqrt:  [[17.0234744   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00028164  0.02592995  0.0613562 ]
Stock Position:  -0.0002816440937584278
Bond Position:  [1.26299109]


portfolio before change:  [1.23508053]
curr_Stock_Price:  99.65925745138367
curr_Factors:  [99.65925745 -0.81948921 -0.9893253 ]
mat_Sqrt:  [[16.32899621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079606 -0.00540148 -0.20280844]
Stock Position:  -0.0007960607695037541
Bond Position:  [1.31441536]


portfolio before change:  [1.23569395]
curr_Stock_Price:  99.09509686080436
curr_Factors:  [99.09509686 -0.90422067 -0.9713627 ]
mat_Sqrt:  [[15.18786255  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223774  0.00602482 -0.14542464]
Stock Position:  -0.0022377429999532474
Bond Position:  [1.45744331]


portfolio before change:  [1.23794174]
curr_Stock_Price:  98.17202322083794
curr_Factors:  [98.17202322 -1.09136056 -0.95622085]
mat_Sqrt:  [[12.66876943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00823849 -0.00879547  0.11822349]
Stock Position:  -0.008238493355691622
Bond Position:  [2.04673131]


portfolio before change:  [1.23871721]
curr_Stock_Price:  98.10895209659157
curr_Factors:  [98.1089521  -1.31133079 -0.95403687]
mat_Sqrt:  [[10.18291132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344188 -0.00531042 -0.00385208]
Stock Position:  -0.0034418841611838064
Bond Position:  [1.57639686]


portfolio before change:  [1.23893487]
curr_Stock_Price:  98.1029672844035
curr_Factors:  [98.10296728 -1.46566681 -0.93317636]
mat_Sqrt:  [[ 8.91000179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00874113 -0.00631075  0.18420598]
Stock Position:  -0.008741132251529454
Bond Position:  [2.09646588]


portfolio before change:  [1.23794547]
curr_Stock_Price:  98.24613837193564
curr_Factors:  [98.24613837 -1.35238858 -0.91033304]
mat_Sqrt:  [[10.224168    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0142347  -0.0216428  -0.22365592]
Stock Position:  -0.014234699217211991
Bond Position:  [2.6364497]


portfolio before change:  [1.24439708]
curr_Stock_Price:  97.81606020760552
curr_Factors:  [97.81606021 -1.18431279 -0.89419058]
mat_Sqrt:  [[12.23848392  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.21360419 0.47221716 0.4757771 ]
Stock Position:  0.2136041889529413
Bond Position:  [-19.64952313]


portfolio before change:  [1.15558411]
curr_Stock_Price:  97.41177679452792
curr_Factors:  [97.41177679 -1.22173944 -0.91095248]
mat_Sqrt:  [[11.5450318   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00064008 -0.03887664  0.00312684]
Stock Position:  0.000640083887539588
Bond Position:  [1.0932324]


portfolio before change:  [1.15599065]
curr_Stock_Price:  97.83340729354703
curr_Factors:  [97.83340729 -1.16276072 -0.89665953]
mat_Sqrt:  [[12.47648722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147996 -0.00461803 -0.14885685]
Stock Position:  0.0014799593691795087
Bond Position:  [1.01120118]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.1574841]
Stock Price:  98.75711036938866
PL:  [1.1574841]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 2.38254530e-02 -4.54379009e-02  1.39163466e-01]
 [ 8.97302553e-01  2.18098614e-01  2.55539911e-01]
 [-2.58353040e-01 -1.51338244e-01  3.73324127e-02]
 [ 1.81872105e-01  1.35279343e+00  1.16087540e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 2.61726252e-02 -3.01915442e-02  3.90957544e-02]
 [-8.41040357e-02  8.88911748e-02 -7.65834299e-03]
 [-6.34330807e-02  1.25943358e-01  6.51462416e-04]
 [ 5.84998020e-03  7.42026300e-02 -4.79678365e-02]
 [-1.34136934e-01 -7.06995821e-02 -3.90911899e-02]
 [ 8.22391358e-01  1.57533658e+00 -2.88010654e-01]
 [-4.96132722e-05  3.42689785e-02 -5.88518862e-02]
 [-3.23509850e-01 -2.12600691e-03 -6.86858724e-01]
 [ 1.78382515e+00 -3.27613810e+00  2.75570132e+00]
 [ 1.48243785e-02 -9.04405111e-02  3.46760961e-02]
 [ 1.26667908e-01 -6.77243956e-03 -3.08225630e-02]
 [-1.36087479e-01 -1.69783812e-01 -3.57750883e-02]
 [-2.69555944e-01 -1.75564573e+00 -2.00227843e-01]
 [-1.12833379e-02  4.15994416e-02  2.04276735e-01]
 [ 2.12962066e-01  5.28828602e-02  4.57575406e-01]
 [ 4.26446734e-02 -1.31581042e-01  4.71542308e-02]
 [ 1.08895808e-01 -5.01702479e-02  7.27896779e-04]
 [-2.14425703e-02  8.94819166e-02  2.96303576e-02]
 [-5.85131086e-02 -3.84648307e-02 -4.84657202e-02]
 [ 3.78662762e-02 -3.17682168e-02  8.48238096e-04]
 [ 2.61781664e-02 -4.58242572e-02  2.61238465e-01]
 [ 2.72072654e-01 -9.66259351e-02  1.12958319e-01]
 [ 1.09025166e-01 -2.71412650e-01 -1.77004823e-01]
 [ 1.31182833e-02 -5.53924867e-02 -2.41712595e-02]
 [ 1.08656188e-01 -6.58100263e-03 -5.16637268e-03]
 [ 6.62180612e-03 -1.63421725e-02 -7.14041535e-02]
 [-4.76149705e-02  2.41885565e-02 -4.71702297e-02]
 [-9.63678687e-02 -3.50712183e-02  3.89794503e-02]
 [ 1.97024718e-01  6.71698697e-03  3.39864836e-02]
 [-9.96943520e-02  2.92461686e-03  4.59710561e-02]
 [-1.18507740e-01 -6.93233416e-02 -8.08503480e-02]
 [ 1.79294386e+00  1.16852274e+00  1.49924438e-01]
 [-1.37071331e-02 -1.27161649e-01 -4.28054400e-02]
 [ 3.35018630e-02 -1.39336037e-02 -7.85867968e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.04396766]
curr_Stock_Price:  100.49620115126679
curr_Factors:  [100.49620115  -0.90516572  -0.99170197]
mat_Sqrt:  [[15.07823388  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00284895 -0.01466502  0.39699463]
Stock Position:  0.0028489479736293548
Bond Position:  [5.75765922]


portfolio before change:  [6.04232772]
curr_Stock_Price:  99.6679332956985
curr_Factors:  [99.6679333  -1.06284736 -0.97226674]
mat_Sqrt:  [[13.02316758  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07632426 0.07039102 0.72898424]
Stock Position:  0.07632425878661932
Bond Position:  [-1.56475341]


portfolio before change:  [6.06202563]
curr_Stock_Price:  99.92857801852118
curr_Factors:  [99.92857802 -1.03459781 -0.94597045]
mat_Sqrt:  [[13.78922457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02042351 -0.04884421  0.10649898]
Stock Position:  -0.020423511195793085
Bond Position:  [8.10291806]


portfolio before change:  [6.06384942]
curr_Stock_Price:  99.88887563131733
curr_Factors:  [99.88887563 -1.0284187  -0.91653887]
mat_Sqrt:  [[14.28343894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04865583 0.4366122  3.31165438]
Stock Position:  0.0486558320262154
Bond Position:  [1.20367307]


portfolio before change:  [6.02906797]
curr_Stock_Price:  99.17093650550545
curr_Factors:  [99.17093651 -1.02966218 -0.93377245]
mat_Sqrt:  [[13.92116532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421272 -0.01106097 -0.05874131]
Stock Position:  -0.0042127221102412115
Bond Position:  [6.44684756]


portfolio before change:  [6.02639196]
curr_Stock_Price:  99.99745873482038
curr_Factors:  [99.99745873 -1.05640483 -1.0016563 ]
mat_Sqrt:  [[12.76980818  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0021919  -0.00974428  0.11152931]
Stock Position:  0.0021919036736882305
Bond Position:  [5.80720717]


portfolio before change:  [6.0254564]
curr_Stock_Price:  99.23943522353592
curr_Factors:  [99.23943522 -0.96293741 -0.97538717]
mat_Sqrt:  [[14.28501216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0047268   0.0286895  -0.02184712]
Stock Position:  -0.004726804055408678
Bond Position:  [6.49454176]


portfolio before change:  [6.02755892]
curr_Stock_Price:  98.96638579637134
curr_Factors:  [98.9663858  -1.1143638  -1.00568953]
mat_Sqrt:  [[11.8784629   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00316472  0.04064804  0.00185844]
Stock Position:  -0.0031647210236737497
Bond Position:  [6.34075992]


portfolio before change:  [6.02512005]
curr_Stock_Price:  99.98749155676975
curr_Factors:  [99.98749156 -1.15027197 -0.99093094]
mat_Sqrt:  [[11.74987001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00095364  0.0239488  -0.13683889]
Stock Position:  0.0009536390615685037
Bond Position:  [5.92976807]


portfolio before change:  [6.02574857]
curr_Stock_Price:  99.86926828815615
curr_Factors:  [99.86926829 -1.22826723 -0.98576162]
mat_Sqrt:  [[10.91167331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01434683 -0.02281819 -0.11151628]
Stock Position:  -0.014346826262011265
Bond Position:  [7.45855561]


portfolio before change:  [6.02034174]
curr_Stock_Price:  100.31112296150363
curr_Factors:  [100.31112296  -1.29668743  -0.99192085]
mat_Sqrt:  [[10.17229969  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.1066785   0.50843769 -0.82161423]
Stock Position:  0.10667849895423487
Bond Position:  [-4.68069829]


portfolio before change:  [5.98978177]
curr_Stock_Price:  100.0301400088482
curr_Factors:  [100.03014001  -1.3735518   -0.97431534]
mat_Sqrt:  [[ 9.56015935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00053007  0.01106027 -0.16788805]
Stock Position:  -0.00053007257566768
Bond Position:  [6.04280501]


portfolio before change:  [5.99061186]
curr_Stock_Price:  99.8892275140181
curr_Factors:  [99.88922751 -1.09447791 -0.96167845]
mat_Sqrt:  [[12.78030722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.63174579e-02 -6.86165781e-04 -1.95941676e+00]
Stock Position:  -0.0363174578592783
Bond Position:  [9.61833467]


portfolio before change:  [5.97559929]
curr_Stock_Price:  100.33570544026531
curr_Factors:  [100.33570544  -1.077354    -0.97232832]
mat_Sqrt:  [[12.92081139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12983638 -1.05736902  7.86124883]
Stock Position:  0.12983638478034304
Bond Position:  [-7.05162597]


portfolio before change:  [5.94157362]
curr_Stock_Price:  100.08042906595247
curr_Factors:  [100.08042907  -0.99452147  -0.99004172]
mat_Sqrt:  [[13.75511788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0002502  -0.02918955  0.09892125]
Stock Position:  0.0002501988674991034
Bond Position:  [5.91653361]


portfolio before change:  [5.9423277]
curr_Stock_Price:  100.13825121844329
curr_Factors:  [100.13825122  -0.93370935  -1.01720728]
mat_Sqrt:  [[14.23402347  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00835982 -0.0021858  -0.08792819]
Stock Position:  0.008359819049314099
Bond Position:  [5.10519004]


portfolio before change:  [5.96123468]
curr_Stock_Price:  102.32356105354961
curr_Factors:  [102.32356105  -1.0050646   -1.03189398]
mat_Sqrt:  [[13.34552848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01334132 -0.05479749 -0.10205637]
Stock Position:  -0.013341323612580972
Bond Position:  [7.32636642]


portfolio before change:  [5.97292754]
curr_Stock_Price:  101.51576960791807
curr_Factors:  [101.51576961  -0.97987811  -1.03380793]
mat_Sqrt:  [[13.55191842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04935072 -0.56663222 -0.5711943 ]
Stock Position:  -0.049350722515242196
Bond Position:  [10.98280412]


portfolio before change:  [5.96501168]
curr_Stock_Price:  101.70398961017501
curr_Factors:  [101.70398961  -1.23460701  -1.02531751]
mat_Sqrt:  [[10.61366168  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00366565 0.01342616 0.58274467]
Stock Position:  0.003665646007054673
Bond Position:  [5.59220086]


portfolio before change:  [5.96244189]
curr_Stock_Price:  100.81223396012648
curr_Factors:  [100.81223396  -1.2811278   -1.0531007 ]
mat_Sqrt:  [[ 9.76721357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03247179 0.01706787 1.30533527]
Stock Position:  0.032471791541670646
Bond Position:  [2.68888805]


portfolio before change:  [5.94390115]
curr_Stock_Price:  100.2309025614119
curr_Factors:  [100.23090256  -1.25327429  -1.06012192]
mat_Sqrt:  [[ 9.9153131   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00256282 -0.0424676   0.1345179 ]
Stock Position:  0.002562815968008656
Bond Position:  [5.6870278]


portfolio before change:  [5.94481914]
curr_Stock_Price:  100.311697930964
curr_Factors:  [100.31169793  -1.403994    -1.05906302]
mat_Sqrt:  [[ 8.54396589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01156412 -0.01619238  0.00207649]
Stock Position:  0.011564118085393541
Bond Position:  [4.78480282]


portfolio before change:  [5.94264224]
curr_Stock_Price:  100.07172803885602
curr_Factors:  [100.07172804  -1.47936204  -1.03594953]
mat_Sqrt:  [[ 8.08957049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00035492 0.02888016 0.08452716]
Stock Position:  0.00035491634586716085
Bond Position:  [5.90712514]


portfolio before change:  [5.9430939]
curr_Stock_Price:  99.26373009743222
curr_Factors:  [99.2637301  -1.32158816 -1.0277957 ]
mat_Sqrt:  [[ 9.4725334   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00805041 -0.01241447 -0.13825921]
Stock Position:  -0.008050405298947171
Bond Position:  [6.74220716]


portfolio before change:  [5.94259438]
curr_Stock_Price:  99.43047328249003
curr_Factors:  [99.43047328 -1.18476459 -1.04259725]
mat_Sqrt:  [[10.71984612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00294358 -0.01025315  0.00241979]
Stock Position:  0.0029435834797701156
Bond Position:  [5.64991248]


portfolio before change:  [5.94159983]
curr_Stock_Price:  98.85266135112596
curr_Factors:  [98.85266135 -1.28418342 -1.0597904 ]
mat_Sqrt:  [[ 9.48447877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00739623 -0.01478972  0.74524063]
Stock Position:  0.0073962322167586666
Bond Position:  [5.21046259]


portfolio before change:  [5.94441316]
curr_Stock_Price:  99.14497038837722
curr_Factors:  [99.14497039 -1.32746702 -1.06524765]
mat_Sqrt:  [[ 9.05999407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03039809 -0.03118589  0.32223864]
Stock Position:  0.030398086999540493
Bond Position:  [2.93059572]


portfolio before change:  [5.96361153]
curr_Stock_Price:  99.76448391958003
curr_Factors:  [99.76448392 -1.54225169 -1.06274058]
mat_Sqrt:  [[ 7.37296531  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0023725  -0.08759806 -0.50494549]
Stock Position:  0.0023724962407141894
Bond Position:  [5.72692067]


portfolio before change:  [5.96447252]
curr_Stock_Price:  99.82563401903495
curr_Factors:  [99.82563402 -1.84614299 -1.05985099]
mat_Sqrt:  [[ 5.45990305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057191 -0.01787785 -0.06895388]
Stock Position:  -0.0005719146223360953
Bond Position:  [6.02156426]


portfolio before change:  [5.96533078]
curr_Stock_Price:  99.64114442453211
curr_Factors:  [99.64114442 -1.7896342  -1.06977457]
mat_Sqrt:  [[ 5.70969958  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01861013 -0.00212401 -0.01473822]
Stock Position:  0.018610132313004634
Bond Position:  [4.11099589]


portfolio before change:  [5.96729321]
curr_Stock_Price:  99.71897957531563
curr_Factors:  [99.71897958 -1.81109048 -1.05124979]
mat_Sqrt:  [[ 5.69743321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198148 -0.00527441 -0.20369617]
Stock Position:  -0.0019814778457876584
Bond Position:  [6.16488415]


portfolio before change:  [5.96807122]
curr_Stock_Price:  99.71526650284419
curr_Factors:  [99.7152665  -1.57419662 -1.04800489]
mat_Sqrt:  [[ 7.24359252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00722101  0.00780682 -0.13456354]
Stock Position:  -0.007221014263164888
Bond Position:  [6.68811658]


portfolio before change:  [5.96946225]
curr_Stock_Price:  99.63841316094523
curr_Factors:  [99.63841316 -1.39500266 -1.05682786]
mat_Sqrt:  [[ 8.58243138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01113555 -0.01131919  0.11119752]
Stock Position:  -0.011135551207085932
Bond Position:  [7.0789909]


portfolio before change:  [5.96891258]
curr_Stock_Price:  99.76724321805665
curr_Factors:  [99.76724322 -1.01715398 -1.07650906]
mat_Sqrt:  [[12.29480562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01670082 0.0021679  0.09695398]
Stock Position:  0.01670081538823775
Bond Position:  [4.30271827]


portfolio before change:  [5.96084702]
curr_Stock_Price:  99.25209275624522
curr_Factors:  [99.25209276 -0.99670413 -1.05575462]
mat_Sqrt:  [[12.74583116  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00703866  0.00094392  0.13114263]
Stock Position:  -0.007038659419608432
Bond Position:  [6.6594487]


portfolio before change:  [5.96632195]
curr_Stock_Price:  98.59252876721287
curr_Factors:  [98.59252877 -0.93477073 -1.05327494]
mat_Sqrt:  [[13.50351218  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01104615 -0.02237401 -0.23064354]
Stock Position:  -0.011046149593218913
Bond Position:  [7.05538977]


portfolio before change:  [5.96032763]
curr_Stock_Price:  99.2150355838269
curr_Factors:  [99.21503558 -1.14787056 -1.05636454]
mat_Sqrt:  [[10.94687991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.18837064 0.37713909 0.42769269]
Stock Position:  0.18837063911503646
Bond Position:  [-12.72887203]


portfolio before change:  [5.99289644]
curr_Stock_Price:  99.39638030108931
curr_Factors:  [99.3963803  -1.2808872  -1.02571024]
mat_Sqrt:  [[ 9.89983665  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00488912 -0.04104125 -0.12211201]
Stock Position:  -0.004889123089400258
Bond Position:  [6.47885758]


portfolio before change:  [5.99295835]
curr_Stock_Price:  99.54937218537732
curr_Factors:  [99.54937219 -1.26321055 -1.02719372]
mat_Sqrt:  [[10.07693813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00145046 -0.00449705 -0.22418626]
Stock Position:  0.0014504619488364297
Bond Position:  [5.84856578]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.99483524]
Stock Price:  100.33930487363814
PL:  [5.65553036]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-1.62565029e-02 -1.05133606e-01  1.23469064e-01]
 [ 3.29268577e-01  2.03450992e-01  8.33788935e-02]
 [-5.56684119e-01 -4.37379262e-01  4.48365684e-02]
 [ 2.55255840e-01  1.51173545e+00  1.55957757e+00]
 [-5.50185195e-02  5.91876368e-03  4.09858246e-02]
 [-4.11419656e-02  3.62373465e-01 -1.70000532e-01]
 [-1.25698010e-01  1.29760363e-01  1.56431698e-01]
 [-4.39292514e-02  8.24444243e-02  1.75136295e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-2.68897593e-02 -4.10374193e-03  3.50384537e-02]
 [ 9.46001778e-01  1.84890868e+00 -3.21198318e-01]
 [-1.14737124e-03 -4.40489314e-02  1.56870921e-01]
 [-3.84248504e-01  5.70854491e-03 -8.74283173e-01]
 [ 1.58796244e+00 -2.92455633e+00  2.45214113e+00]
 [-6.65111138e-03 -9.40607525e-02  3.69029137e-02]
 [ 1.26247238e-01 -2.49860522e-02 -1.76056253e-02]
 [-1.07046392e-01 -1.07377047e-01 -4.69459600e-02]
 [-2.70644044e-01 -1.76137443e+00 -2.00058861e-01]
 [ 6.21028250e-03  2.99380540e-02  2.98039579e-02]
 [ 1.36103728e-01 -6.96837959e-02  2.31464020e-01]
 [ 2.84221383e-02 -2.59319758e-02  3.16442505e-02]
 [ 1.03429657e-01 -4.99749659e-02  1.50925242e-02]
 [ 1.10474782e-01  8.13196545e-02  7.65474027e-02]
 [-4.14319390e-02 -6.75196068e-02  8.51279417e-02]
 [ 4.11570859e-02 -6.86097561e-02  8.33787841e-03]
 [ 5.25853934e-02 -4.11879939e-02  2.95996435e-01]
 [-6.52850630e-02 -1.18043184e-01 -2.17721945e-02]
 [-1.51999760e-01  1.08470627e-01  2.25333368e-01]
 [ 4.48167913e-02  1.10276539e-02  1.36090726e-01]
 [-1.05281634e-01  1.06019642e-01 -7.18217172e-03]
 [ 7.75154570e-02 -1.30785634e-02 -5.00884961e-02]
 [ 3.03750922e-02 -1.99180541e-03 -6.03439765e-02]
 [ 6.46053687e-03  5.07147740e-02  1.02967075e-01]
 [-2.86781705e-03 -4.69479274e-02 -8.11593862e-03]
 [-8.46882438e-02  5.76316068e-02  5.25905884e-02]
 [-9.18062127e-02 -5.21215565e-02 -5.55876597e-02]
 [ 2.12456445e+00  1.37824964e+00  1.63269480e-01]
 [ 1.56723508e-01 -2.29216377e-01  6.94954290e-02]
 [ 2.78869891e-02 -1.49231491e-02  3.53561351e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.95830648]
curr_Stock_Price:  99.40419802268401
curr_Factors:  [99.40419802 -0.96137469 -1.00991746]
mat_Sqrt:  [[13.84469596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090387 -0.03393173  0.35222287]
Stock Position:  -0.0009038691344034719
Bond Position:  [-1.86845809]


portfolio before change:  [-1.95785337]
curr_Stock_Price:  98.64448872615068
curr_Factors:  [98.64448873 -0.81650306 -0.99200922]
mat_Sqrt:  [[16.16761362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02398731 0.06566353 0.23785677]
Stock Position:  0.023987305189015585
Bond Position:  [-4.32406883]


portfolio before change:  [-1.98693712]
curr_Stock_Price:  97.45455891955517
curr_Factors:  [97.45455892 -0.6048093  -0.97166489]
mat_Sqrt:  [[20.14411152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03161279 -0.14116355  0.12790625]
Stock Position:  -0.03161278967105577
Bond Position:  [1.09387335]


portfolio before change:  [-2.01279461]
curr_Stock_Price:  98.27682842171447
curr_Factors:  [98.27682842 -0.63432878 -0.98309876]
mat_Sqrt:  [[19.49895244  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04524269 0.48791052 4.44904071]
Stock Position:  0.04524268612291131
Bond Position:  [-6.45910231]


portfolio before change:  [-2.06435867]
curr_Stock_Price:  97.15495392984228
curr_Factors:  [97.15495393 -0.75355243 -0.97889431]
mat_Sqrt:  [[17.18196741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264488  0.00191027  0.11692115]
Stock Position:  -0.0026448752579518275
Bond Position:  [-1.80739593]


portfolio before change:  [-2.0667019]
curr_Stock_Price:  97.95548279220344
curr_Factors:  [97.95548279 -0.74759192 -0.95481479]
mat_Sqrt:  [[17.85183684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.04975469e-04  1.16955533e-01 -4.84964198e-01]
Stock Position:  -0.00010497546933793933
Bond Position:  [-2.05641898]


portfolio before change:  [-2.06688638]
curr_Stock_Price:  97.26398953780652
curr_Factors:  [97.26398954 -0.65763694 -0.95034907]
mat_Sqrt:  [[19.4810621   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345357  0.04187998  0.44625609]
Stock Position:  -0.0034535745519525046
Bond Position:  [-1.73097794]


portfolio before change:  [-2.06822351]
curr_Stock_Price:  97.58850523001944
curr_Factors:  [97.58850523 -0.8047765  -0.92309119]
mat_Sqrt:  [[17.33785083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135688  0.02660882  0.04996151]
Stock Position:  -0.0013568809298437235
Bond Position:  [-1.93580752]


portfolio before change:  [-2.06948466]
curr_Stock_Price:  98.33961199948311
curr_Factors:  [98.339612   -0.77400378 -0.94310754]
mat_Sqrt:  [[17.66023666  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00294397  0.0064198  -0.11330016]
Stock Position:  0.0029439697968830702
Bond Position:  [-2.35899351]


portfolio before change:  [-2.07038722]
curr_Stock_Price:  98.13320281715842
curr_Factors:  [98.13320282 -0.62086077 -0.94664874]
mat_Sqrt:  [[20.46704979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00100529 -0.00132448  0.09995496]
Stock Position:  -0.0010052859541177118
Bond Position:  [-1.97173528]


portfolio before change:  [-2.07163629]
curr_Stock_Price:  99.1305270853141
curr_Factors:  [99.13052709 -0.49807208 -0.95103324]
mat_Sqrt:  [[23.27388949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0540453   0.59673271 -0.9162894 ]
Stock Position:  0.0540453004738193
Bond Position:  [-7.42917542]


portfolio before change:  [-2.0895933]
curr_Stock_Price:  98.81545241530199
curr_Factors:  [98.81545242 -0.38438108 -0.93573585]
mat_Sqrt:  [[26.39400929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082906 -0.01421673  0.44750907]
Stock Position:  0.0008290639229595237
Bond Position:  [-2.17151763]


portfolio before change:  [-2.09020534]
curr_Stock_Price:  98.40465201905718
curr_Factors:  [98.40465202 -0.18177503 -0.94370762]
mat_Sqrt:  [[31.93189742  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.75857247e-02  1.84242495e-03 -2.49408654e+00]
Stock Position:  -0.01758572471117058
Bond Position:  [-0.35968822]


portfolio before change:  [-2.13723826]
curr_Stock_Price:  101.07658954388478
curr_Factors:  [101.07658954  -0.35340826  -0.94043649]
mat_Sqrt:  [[27.71666322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05381352 -0.9438965   6.99527609]
Stock Position:  0.053813515861572285
Bond Position:  [-7.57652492]


portfolio before change:  [-2.18136478]
curr_Stock_Price:  100.27420017827161
curr_Factors:  [100.27420018  -0.50525755  -0.92912895]
mat_Sqrt:  [[23.89148074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076673 -0.03035798  0.10527374]
Stock Position:  -0.0007667338225270839
Bond Position:  [-2.10448116]


portfolio before change:  [-2.18200122]
curr_Stock_Price:  100.76115105664172
curr_Factors:  [100.76115106  -0.7208741   -0.8988015 ]
mat_Sqrt:  [[19.94697045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00589329 -0.00806421 -0.05022395]
Stock Position:  0.005893288355203858
Bond Position:  [-2.77581574]


portfolio before change:  [-2.17833477]
curr_Stock_Price:  101.44217150917694
curr_Factors:  [101.44217151  -0.61844573  -0.93303368]
mat_Sqrt:  [[21.49906582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00644435 -0.03465579 -0.13392376]
Stock Position:  -0.006444347184526226
Bond Position:  [-1.52460619]


portfolio before change:  [-2.17749104]
curr_Stock_Price:  101.28167236614676
curr_Factors:  [101.28167237  -0.60469288  -0.92233448]
mat_Sqrt:  [[21.99638474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03050592 -0.56848115 -0.57071225]
Stock Position:  -0.03050591927038488
Bond Position:  [0.91219948]


portfolio before change:  [-2.15377426]
curr_Stock_Price:  100.50796196054117
curr_Factors:  [100.50796196  -0.30365432  -0.92163121]
mat_Sqrt:  [[29.51655883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00062355 0.00966247 0.0850224 ]
Stock Position:  0.0006235506556463471
Bond Position:  [-2.21644607]


portfolio before change:  [-2.15407133]
curr_Stock_Price:  100.47589204094753
curr_Factors:  [100.47589204  -0.46697746  -0.91047617]
mat_Sqrt:  [[25.34202768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00667377 -0.02249035  0.66030242]
Stock Position:  0.006673774495715575
Bond Position:  [-2.82462478]


portfolio before change:  [-2.1694124]
curr_Stock_Price:  98.2300914733736
curr_Factors:  [98.23009147 -0.59182361 -0.89749277]
mat_Sqrt:  [[22.15351603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013356  -0.00836951  0.09027224]
Stock Position:  0.0013355961845931375
Bond Position:  [-2.30060814]


portfolio before change:  [-2.16777713]
curr_Stock_Price:  99.66979356152365
curr_Factors:  [99.66979356 -0.82136316 -0.90723211]
mat_Sqrt:  [[17.69473946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00544282 -0.01612935  0.04305477]
Stock Position:  0.005442821494698049
Bond Position:  [-2.71026203]


portfolio before change:  [-2.16498582]
curr_Stock_Price:  100.2448843740734
curr_Factors:  [100.24488437  -0.79194326  -0.93952819]
mat_Sqrt:  [[17.74572394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00804133 0.02624581 0.21836843]
Stock Position:  0.008041332139457716
Bond Position:  [-2.97108823]


portfolio before change:  [-2.17534348]
curr_Stock_Price:  99.00301929246696
curr_Factors:  [99.00301929 -0.75359813 -0.93320986]
mat_Sqrt:  [[18.32639462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206465 -0.02179186  0.24284632]
Stock Position:  -0.0020646533826243637
Bond Position:  [-1.97093656]


portfolio before change:  [-2.17553963]
curr_Stock_Price:  98.9786879497152
curr_Factors:  [98.97868795 -0.66436367 -0.92742449]
mat_Sqrt:  [[20.1482289   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00143209 -0.0221437   0.02378565]
Stock Position:  0.001432093138037298
Bond Position:  [-2.31728633]


portfolio before change:  [-2.1764356]
curr_Stock_Price:  98.55532416497067
curr_Factors:  [98.55532416 -0.59657207 -0.93065106]
mat_Sqrt:  [[21.4000857   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00488774 -0.01329337  0.84439544]
Stock Position:  0.0048877350350530115
Bond Position:  [-2.65814791]


portfolio before change:  [-2.17435947]
curr_Stock_Price:  99.04807163563562
curr_Factors:  [99.04807164 -0.48055154 -0.94805865]
mat_Sqrt:  [[23.73605276  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00395284 -0.03809827 -0.06211001]
Stock Position:  -0.003952837423550243
Bond Position:  [-1.78283855]


portfolio before change:  [-2.16805617]
curr_Stock_Price:  97.39706279723835
curr_Factors:  [97.3970628  -0.37460014 -0.94293863]
mat_Sqrt:  [[26.08230933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00321529  0.03500874  0.64281338]
Stock Position:  -0.003215294466875873
Bond Position:  [-1.85489593]


portfolio before change:  [-2.16708659]
curr_Stock_Price:  97.02339402909594
curr_Factors:  [97.02339403 -0.64222772 -0.91624935]
mat_Sqrt:  [[20.41918801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00366553 0.00355916 0.38822896]
Stock Position:  0.0036655328733274364
Bond Position:  [-2.52272903]


portfolio before change:  [-2.16598885]
curr_Stock_Price:  97.40890592312188
curr_Factors:  [97.40890592 -0.60845145 -0.89811302]
mat_Sqrt:  [[21.59265419  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00394146  0.03421769 -0.02048874]
Stock Position:  -0.003941457066436229
Bond Position:  [-1.78205583]


portfolio before change:  [-2.15879488]
curr_Stock_Price:  95.52718134167785
curr_Factors:  [95.52718134 -0.75814707 -0.8861704 ]
mat_Sqrt:  [[18.45053487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00350242 -0.00422109 -0.14288854]
Stock Position:  0.003502420685053081
Bond Position:  [-2.49337126]


portfolio before change:  [-2.16156322]
curr_Stock_Price:  94.82576777911362
curr_Factors:  [94.82576778 -0.90951364 -0.89159231]
mat_Sqrt:  [[15.65726825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112733 -0.00064285 -0.17214457]
Stock Position:  0.001127326537759794
Bond Position:  [-2.26846282]


portfolio before change:  [-2.16212333]
curr_Stock_Price:  94.58046783265868
curr_Factors:  [94.58046783 -0.97129905 -0.85427897]
mat_Sqrt:  [[15.23922913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00248246 0.01636812 0.29373641]
Stock Position:  0.002482455817671222
Bond Position:  [-2.39691516]


portfolio before change:  [-2.16291651]
curr_Stock_Price:  94.38165364258305
curr_Factors:  [94.38165364 -0.94343382 -0.86615851]
mat_Sqrt:  [[15.45224624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091299 -0.01515238 -0.02315251]
Stock Position:  -0.0009129858150921254
Bond Position:  [-2.0767474]


portfolio before change:  [-2.16245049]
curr_Stock_Price:  93.58686531372712
curr_Factors:  [93.58686531 -1.02177296 -0.867357  ]
mat_Sqrt:  [[14.15064338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0043948   0.01860052  0.15002631]
Stock Position:  -0.004394798930811729
Bond Position:  [-1.75115503]


portfolio before change:  [-2.15975153]
curr_Stock_Price:  92.92292960496752
curr_Factors:  [92.9229296  -1.09937392 -0.8553574 ]
mat_Sqrt:  [[13.15812068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00864806 -0.01682216 -0.15857612]
Stock Position:  -0.008648063596429612
Bond Position:  [-1.35614812]


portfolio before change:  [-2.15573809]
curr_Stock_Price:  92.4392415316412
curr_Factors:  [92.43924153 -0.95359398 -0.86030444]
mat_Sqrt:  [[15.06920364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.16186826 0.44482816 0.46576238]
Stock Position:  0.16186825652611744
Bond Position:  [-17.11871695]


portfolio before change:  [-2.09878793]
curr_Stock_Price:  92.80429232043817
curr_Factors:  [92.80429232 -0.93295506 -0.85311391]
mat_Sqrt:  [[15.55565009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00797913 -0.07397927  0.19825112]
Stock Position:  0.007979133350883162
Bond Position:  [-2.83928576]


portfolio before change:  [-2.10077764]
curr_Stock_Price:  92.59941059863122
curr_Factors:  [92.5994106  -0.82859701 -0.8749936 ]
mat_Sqrt:  [[16.8557554   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00151655 -0.00481643  0.01008612]
Stock Position:  0.0015165453887989162
Bond Position:  [-2.24120885]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.10041472]
Stock Price:  93.023463641911
PL:  [-2.10041472]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 6.50595434e-02 -7.11057207e-02 -4.51532023e-02]
 [ 5.17374090e-01  1.94607808e-01  1.34368675e-01]
 [-2.25275607e-01 -1.20891150e-01  3.63675911e-02]
 [ 9.86871410e-02  8.69053620e-01  6.49726609e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-1.07030231e-01 -3.60124631e-02 -5.84111495e-02]
 [-3.63293209e-02 -9.24321454e-02 -1.76217336e-02]
 [ 9.30844710e-02  6.60947017e-02 -6.52354137e-02]
 [-1.83701609e-02  1.00412737e-01 -5.19498219e-02]
 [-2.03797645e-01 -1.13955860e-01 -8.72409313e-02]
 [ 7.28382008e-01  1.39668971e+00 -2.55360157e-01]
 [-1.99242422e-04  3.26535092e-02 -5.83673508e-02]
 [-2.79390712e-01 -6.14185854e-03 -5.61961120e-01]
 [ 1.84012705e+00 -3.41297426e+00  2.87212086e+00]
 [ 1.83070985e-02 -8.98534099e-02  3.43149690e-02]
 [ 1.18598791e-01 -2.98707266e-02 -1.26685008e-02]
 [-9.77296744e-02 -8.41535590e-02 -4.65254138e-02]
 [-2.70535411e-01 -1.75426653e+00 -1.97714747e-01]
 [-2.17759721e-02  9.54998914e-02  2.79685243e-01]
 [ 2.90474190e-01 -1.12104502e-01  4.83338337e-01]
 [ 7.82874311e-02 -2.17757131e-01 -4.23301090e-02]
 [ 1.50107277e-01 -5.46270841e-02 -1.77105869e-02]
 [ 1.19984565e-01  1.95330838e-01  1.52709968e-01]
 [ 1.48181815e-02 -1.30242900e-01 -4.52936141e-03]
 [-3.88633028e-02 -1.41845039e-01  5.77338673e-02]
 [ 4.95497034e-02 -1.26038213e-02  3.34127468e-02]
 [ 4.79193506e-01 -7.79159889e-02  2.49421887e-01]
 [ 8.11090414e-02 -2.02086069e-01 -8.62804283e-02]
 [-1.07782037e-02 -7.61731313e-02 -5.27717699e-03]
 [ 1.96360688e-01 -8.74147148e-02  6.12529598e-02]
 [-1.96560544e-02 -5.41646685e-02 -3.99793852e-02]
 [-1.31788154e-02  2.23334568e-02 -5.59819739e-02]
 [-7.75742057e-02 -4.99305811e-02  1.67288574e-02]
 [ 3.30146277e-01  4.10299357e-02  6.91246182e-02]
 [ 4.67566630e-02 -5.05755980e-02  1.48201474e-02]
 [-9.57227926e-02 -2.93544359e-02 -1.07264551e-01]
 [ 2.01283988e+00  1.36762527e+00  1.70478600e-01]
 [-6.12508817e-02 -7.35280464e-02 -3.65439851e-02]
 [ 3.54312888e-02 -1.33632571e-02 -1.14279279e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.4271734]
curr_Stock_Price:  100.41203241899564
curr_Factors:  [100.41203242  -1.06153794  -1.01050196]
mat_Sqrt:  [[12.64475049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00326841 -0.02294927 -0.12880952]
Stock Position:  0.0032684148362689992
Bond Position:  [5.09898522]


portfolio before change:  [5.423169]
curr_Stock_Price:  98.99183130754743
curr_Factors:  [98.99183131 -0.84469524 -0.98080825]
mat_Sqrt:  [[15.95119651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03664466 0.0628094  0.38331643]
Stock Position:  0.036644657503670144
Bond Position:  [1.79564725]


portfolio before change:  [5.47246217]
curr_Stock_Price:  100.33087230218209
curr_Factors:  [100.3308723   -0.74649974  -1.00685669]
mat_Sqrt:  [[17.37647043  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01395732 -0.03901745  0.10374661]
Stock Position:  -0.013957316997624645
Bond Position:  [6.87281196]


portfolio before change:  [5.45733623]
curr_Stock_Price:  101.47615690076759
curr_Factors:  [101.4761569   -1.07207893  -1.00952721]
mat_Sqrt:  [[12.65709244  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03229074 0.28048585 1.85348917]
Stock Position:  0.03229073810276066
Bond Position:  [2.18059622]


portfolio before change:  [5.4753362]
curr_Stock_Price:  102.02514961508574
curr_Factors:  [102.02514962  -1.14788756  -1.01679522]
mat_Sqrt:  [[11.71109371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00500773 -0.01106097 -0.05874131]
Stock Position:  -0.005007730481073156
Bond Position:  [5.98625065]


portfolio before change:  [5.47396197]
curr_Stock_Price:  102.44900479916758
curr_Factors:  [102.4490048   -1.57985821  -1.04394115]
mat_Sqrt:  [[ 7.43029681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01699856 -0.01162297 -0.16663075]
Stock Position:  -0.016998563218936114
Bond Position:  [7.21544786]


portfolio before change:  [5.48685621]
curr_Stock_Price:  101.74351880380912
curr_Factors:  [101.7435188   -1.50174208  -1.02870239]
mat_Sqrt:  [[ 8.10118753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00725745 -0.02983235 -0.0502699 ]
Stock Position:  -0.007257451413815991
Bond Position:  [6.22525485]


portfolio before change:  [5.49138541]
curr_Stock_Price:  101.22667162957956
curr_Factors:  [101.22667163  -1.53502227  -1.00290024]
mat_Sqrt:  [[ 7.99998578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0116575   0.02133197 -0.18609848]
Stock Position:  0.011657504777440954
Bond Position:  [4.311335]


portfolio before change:  [5.4832991]
curr_Stock_Price:  100.48678301010544
curr_Factors:  [100.48678301  -1.77188372  -0.98704466]
mat_Sqrt:  [[ 6.36680535  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00133155  0.03240807 -0.14819838]
Stock Position:  -0.00133154845489946
Bond Position:  [5.61710212]


portfolio before change:  [5.48382975]
curr_Stock_Price:  100.61560729525951
curr_Factors:  [100.6156073   -1.52310113  -1.0019096 ]
mat_Sqrt:  [[ 8.05502939  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03039924 -0.0367791  -0.24887409]
Stock Position:  -0.030399239627315184
Bond Position:  [8.54246771]


portfolio before change:  [5.47138151]
curr_Stock_Price:  101.06022733366734
curr_Factors:  [101.06022733  -1.64084071  -1.02969076]
mat_Sqrt:  [[ 6.99492702  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.13743602  0.45077967 -0.72847145]
Stock Position:  0.1374360196766373
Bond Position:  [-8.41793388]


portfolio before change:  [5.51690071]
curr_Stock_Price:  101.39908683433482
curr_Factors:  [101.39908683  -1.59017729  -1.01272866]
mat_Sqrt:  [[ 7.50941928  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007255   0.01053887 -0.16650581]
Stock Position:  -0.0007254966269531732
Bond Position:  [5.5904654]


portfolio before change:  [5.51778005]
curr_Stock_Price:  101.15030784419447
curr_Factors:  [101.15030784  -1.30540631  -1.0228928 ]
mat_Sqrt:  [[ 9.85824836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0401039  -0.00198228 -1.60311866]
Stock Position:  -0.040103904116219447
Bond Position:  [9.57430229]


portfolio before change:  [5.55362629]
curr_Stock_Price:  100.28631759477776
curr_Factors:  [100.28631759  -1.34644336  -1.02585475]
mat_Sqrt:  [[ 9.35331819  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.18493178 -1.1015327   8.19336138]
Stock Position:  0.18493178346554096
Bond Position:  [-12.99250128]


portfolio before change:  [5.71477011]
curr_Stock_Price:  101.16646905347683
curr_Factors:  [101.16646905  -1.55062775  -1.04954896]
mat_Sqrt:  [[ 7.51266797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00092781 -0.02900006  0.09789106]
Stock Position:  0.0009278144205939371
Bond Position:  [5.6209064]


portfolio before change:  [5.7155096]
curr_Stock_Price:  101.20616804307825
curr_Factors:  [101.20616804  -1.53038916  -1.04222305]
mat_Sqrt:  [[ 7.72566185  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01422733 -0.00964074 -0.03613971]
Stock Position:  0.014227325672029376
Bond Position:  [4.27561648]


portfolio before change:  [5.7191228]
curr_Stock_Price:  101.42256268448847
curr_Factors:  [101.42256268  -1.66327979  -1.06740444]
mat_Sqrt:  [[ 6.61018308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01882012 -0.02716044 -0.13272406]
Stock Position:  -0.018820115343054996
Bond Position:  [7.62790713]


portfolio before change:  [5.73183025]
curr_Stock_Price:  100.79802322935464
curr_Factors:  [100.79802323  -1.45062895  -1.04265665]
mat_Sqrt:  [[ 8.32974745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08031239 -0.56618709 -0.56402514]
Stock Position:  -0.08031238933407495
Bond Position:  [13.82716034]


portfolio before change:  [5.64766561]
curr_Stock_Price:  101.8675113318424
curr_Factors:  [101.86751133  -1.43946709  -1.04560129]
mat_Sqrt:  [[ 8.48758648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00645747 0.03082246 0.79786415]
Stock Position:  0.006457474442734255
Bond Position:  [4.98985876]


portfolio before change:  [5.65107531]
curr_Stock_Price:  102.2989379369124
curr_Factors:  [102.29893794  -1.57242907  -1.0513089 ]
mat_Sqrt:  [[ 7.41986839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04936098 -0.03618157  1.37882974]
Stock Position:  0.04936098052283262
Bond Position:  [0.60149943]


portfolio before change:  [5.66570068]
curr_Stock_Price:  102.59370879983376
curr_Factors:  [102.5937088   -1.60445747  -1.05566348]
mat_Sqrt:  [[ 7.17537959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00351164 -0.07028081 -0.12075602]
Stock Position:  0.0035116393695210084
Bond Position:  [5.30542857]


portfolio before change:  [5.66516979]
curr_Stock_Price:  102.25366634043719
curr_Factors:  [102.25366634  -1.35768185  -1.08020553]
mat_Sqrt:  [[ 8.93136525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0151535  -0.01763082 -0.05052337]
Stock Position:  0.01515349647506279
Bond Position:  [4.11566922]


portfolio before change:  [5.67397526]
curr_Stock_Price:  102.80079941222313
curr_Factors:  [102.80079941  -1.44424456  -1.09691186]
mat_Sqrt:  [[ 8.09815868  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02358908 0.06304276 0.43563903]
Stock Position:  0.02358907797766872
Bond Position:  [3.24899919]


portfolio before change:  [5.67789658]
curr_Stock_Price:  102.94981596369058
curr_Factors:  [102.94981596  -1.50070548  -1.13003705]
mat_Sqrt:  [[ 7.41495654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00171169 -0.04203572 -0.01292101]
Stock Position:  -0.0017116878574488985
Bond Position:  [5.85411453]


portfolio before change:  [5.67841075]
curr_Stock_Price:  103.07696312342114
curr_Factors:  [103.07696312  -1.55767471  -1.09954231]
mat_Sqrt:  [[ 7.23014363  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00774984 -0.04578029  0.16469865]
Stock Position:  -0.007749835514086333
Bond Position:  [6.47724026]


portfolio before change:  [5.681211]
curr_Stock_Price:  102.82011309977597
curr_Factors:  [102.8201131   -1.64325621  -1.06509404]
mat_Sqrt:  [[ 6.85261771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00785062 -0.00406787  0.09531727]
Stock Position:  0.007850621441563444
Bond Position:  [4.87400922]


portfolio before change:  [5.68231446]
curr_Stock_Price:  102.88305948449859
curr_Factors:  [102.88305948  -1.20230169  -1.04895109]
mat_Sqrt:  [[10.83021831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04747845 -0.02514728  0.71153122]
Stock Position:  0.047478452061285446
Bond Position:  [0.79758605]


portfolio before change:  [5.68576978]
curr_Stock_Price:  102.95373607781147
curr_Factors:  [102.95373608  -1.3235524   -1.04043392]
mat_Sqrt:  [[ 9.68224121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00229766 -0.065223   -0.24613405]
Stock Position:  0.0022976577545880824
Bond Position:  [5.44921733]


portfolio before change:  [5.68625754]
curr_Stock_Price:  102.86955002700283
curr_Factors:  [102.86955003  -1.53810968  -1.0178509 ]
mat_Sqrt:  [[ 7.98449147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343218 -0.02458477 -0.01505432]
Stock Position:  -0.003432175781221677
Bond Position:  [6.03932392]


portfolio before change:  [5.68674322]
curr_Stock_Price:  102.94800762211669
curr_Factors:  [102.94800762  -1.39767579  -1.04856635]
mat_Sqrt:  [[ 8.91719947  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02142157 -0.02821298  0.17473764]
Stock Position:  0.021421573251930937
Bond Position:  [3.48143494]


portfolio before change:  [5.68801532]
curr_Stock_Price:  102.9870750080544
curr_Factors:  [102.98707501  -1.16653086  -1.0614115 ]
mat_Sqrt:  [[11.09684836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00350308 -0.01748157 -0.11405006]
Stock Position:  -0.00350307831745136
Bond Position:  [6.04878711]


portfolio before change:  [5.69014615]
curr_Stock_Price:  102.59465056639225
curr_Factors:  [102.59465057  -0.9536123   -1.08972001]
mat_Sqrt:  [[13.29587037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150778  0.00720809 -0.15970099]
Stock Position:  -0.0015077832150149901
Bond Position:  [5.84483665]


portfolio before change:  [5.69043839]
curr_Stock_Price:  102.88541811057543
curr_Factors:  [102.88541811  -0.84078916  -1.08217882]
mat_Sqrt:  [[15.03901679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00560884 -0.01611503  0.04772277]
Stock Position:  -0.005608842673570567
Bond Position:  [6.26750651]


portfolio before change:  [5.69205498]
curr_Stock_Price:  102.73688482768037
curr_Factors:  [102.73688483  -0.75987643  -1.0634831 ]
mat_Sqrt:  [[16.59019191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02125542 0.01324235 0.1971933 ]
Stock Position:  0.02125541902054494
Bond Position:  [3.50833944]


portfolio before change:  [5.67538061]
curr_Stock_Price:  101.93177519766988
curr_Factors:  [101.9317752   -0.87887352  -1.07431654]
mat_Sqrt:  [[14.45605932  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00272952 -0.0163232   0.04227776]
Stock Position:  0.0027295206368893408
Bond Position:  [5.39715572]


portfolio before change:  [5.67904925]
curr_Stock_Price:  103.02865719007934
curr_Factors:  [103.02865719  -0.97029618  -1.04406957]
mat_Sqrt:  [[13.74453688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00899339 -0.0094741  -0.30599591]
Stock Position:  -0.008993393348625672
Bond Position:  [6.60562649]


portfolio before change:  [5.67869613]
curr_Stock_Price:  103.15974012372038
curr_Factors:  [103.15974012  -0.99422583  -1.05967299]
mat_Sqrt:  [[13.22858267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.17589216 0.44139916 0.48632799]
Stock Position:  0.17589216268455243
Bond Position:  [-12.46629366]


portfolio before change:  [5.66542756]
curr_Stock_Price:  103.09316416690638
curr_Factors:  [103.09316417  -0.9327433   -1.04713567]
mat_Sqrt:  [[14.23571751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00588093 -0.02373107 -0.10424982]
Stock Position:  -0.005880928796061333
Bond Position:  [6.27171111]


portfolio before change:  [5.66808919]
curr_Stock_Price:  102.77389140200732
curr_Factors:  [102.7738914   -1.11406284  -1.01881532]
mat_Sqrt:  [[12.17826957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00076993 -0.00431297 -0.32600697]
Stock Position:  0.0007699259028075866
Bond Position:  [5.58896091]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.66892604]
Stock Price:  102.95337872365488
PL:  [2.71554732]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-1.48873208e-02 -1.08733115e-01  1.13926043e-01]
 [ 2.39807518e-01  2.13199113e-01  6.35987719e-02]
 [-3.44819327e-01 -2.30928676e-01  3.98545111e-02]
 [ 2.55486228e-01  1.67259621e+00  1.59105029e+00]
 [-4.87581953e-02 -2.73123511e-02 -9.92933689e-03]
 [-5.56631460e-02  4.43956920e-01 -2.16108905e-01]
 [-1.03632881e-01  1.27686090e-01  4.75813476e-02]
 [-5.89349305e-02  1.13705669e-01  4.84227865e-03]
 [ 4.15235954e-02  3.55980130e-02 -4.21028081e-02]
 [-3.02939423e-02 -6.21759180e-03  3.26854698e-02]
 [ 8.51922328e-01  1.72632938e+00 -2.74364142e-01]
 [-6.92791544e-04  1.28906100e-02  4.53516048e-02]
 [-2.58769872e-01  2.31175408e-03 -5.41076663e-01]
 [ 1.61704724e+00 -3.00909281e+00  2.52357068e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.45187984e-01 -4.22170587e-02 -8.67530450e-03]
 [-1.16538810e-01 -1.31071929e-01 -4.74162399e-02]
 [-2.76047526e-01 -1.79863708e+00 -2.02403605e-01]
 [ 5.98242605e-03  3.02774188e-02  3.11306862e-02]
 [ 6.18565443e-02  1.16714577e-01  1.97344127e-01]
 [ 2.82161361e-02 -2.36092716e-02  2.99527818e-02]
 [ 1.12822821e-01 -5.12941240e-02  3.62346764e-02]
 [ 1.88489159e-01 -1.17608298e-02  1.72019400e-02]
 [-6.69825329e-02 -4.89183029e-02  7.76011044e-02]
 [ 2.88183182e-02 -9.64196631e-02  1.94621844e-02]
 [ 4.80620660e-02 -4.19821453e-02  2.90042698e-01]
 [-2.01626540e-01 -1.35619796e-01 -7.40823667e-02]
 [-1.61027631e-01  1.14954939e-01  2.35715474e-01]
 [ 3.04373642e-02  1.72899040e-02  1.68484185e-01]
 [-1.01791127e-01  1.04903551e-01 -5.95648476e-03]
 [ 5.59575185e-02 -1.43604005e-02 -8.10056183e-02]
 [-3.47074307e-02  3.89181189e-03 -4.44239780e-02]
 [-5.96181611e-02 -1.97857998e-02  3.64936127e-02]
 [ 8.25662101e-03  5.21042023e-03  3.87352911e-03]
 [ 1.12744503e-01 -2.89599319e-02 -1.95327633e-02]
 [-1.17825327e-01 -6.00598681e-02 -9.34820118e-02]
 [ 1.58284797e+00  1.03672146e+00  1.41678352e-01]
 [ 1.08831613e-01 -2.27539437e-01  8.73760426e-02]
 [ 3.03814176e-02 -1.52423499e-02 -2.81291031e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.94080744]
curr_Stock_Price:  99.27012436987017
curr_Factors:  [99.27012437 -0.97910902 -1.00686708]
mat_Sqrt:  [[13.62448529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101489 -0.03509346  0.32499929]
Stock Position:  -0.0010148874318951062
Bond Position:  [-2.84005944]


portfolio before change:  [-2.94023936]
curr_Stock_Price:  98.36055987751249
curr_Factors:  [98.36055988 -0.93584041 -1.00630409]
mat_Sqrt:  [[14.10452148  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02100806 0.06880972 0.18142959]
Stock Position:  0.02100806112681692
Bond Position:  [-5.00660402]


portfolio before change:  [-2.9236734]
curr_Stock_Price:  99.17890422218035
curr_Factors:  [99.17890422 -1.00620515 -1.03541838]
mat_Sqrt:  [[12.87518487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.029811   -0.07453191  0.11369383]
Stock Position:  -0.029811003225647503
Bond Position:  [0.03294924]


portfolio before change:  [-2.89477426]
curr_Stock_Price:  98.20963071912225
curr_Factors:  [98.20963072 -0.89948096 -0.99691102]
mat_Sqrt:  [[14.74217306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06251964 0.53982811 4.53882362]
Stock Position:  0.06251963512599326
Bond Position:  [-9.03480454]


portfolio before change:  [-2.91532071]
curr_Stock_Price:  97.89905583494871
curr_Factors:  [97.89905583 -0.7782853  -1.03552262]
mat_Sqrt:  [[15.96069267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353118 -0.00881502 -0.02832563]
Stock Position:  -0.003531182777380889
Bond Position:  [-2.56962125]


portfolio before change:  [-2.91402134]
curr_Stock_Price:  97.44011740975684
curr_Factors:  [97.44011741 -0.75306005 -1.03764594]
mat_Sqrt:  [[16.25713709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.63067452e-04  1.43286480e-01 -6.16498552e-01]
Stock Position:  -0.0005630674520481447
Bond Position:  [-2.85915598]


portfolio before change:  [-2.91458857]
curr_Stock_Price:  97.81273213880468
curr_Factors:  [97.81273214 -0.7511252  -1.04212409]
mat_Sqrt:  [[16.27785284  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416864  0.04121051  0.13573634]
Stock Position:  -0.004168643506736093
Bond Position:  [-2.50684215]


portfolio before change:  [-2.92013442]
curr_Stock_Price:  99.0679325987949
curr_Factors:  [99.0679326  -0.68593768 -1.03288713]
mat_Sqrt:  [[17.76057283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195582  0.03669835  0.01381367]
Stock Position:  -0.001955817095637421
Bond Position:  [-2.72637567]


portfolio before change:  [-2.92106062]
curr_Stock_Price:  99.36723173250536
curr_Factors:  [99.36723173 -0.73241341 -1.03580005]
mat_Sqrt:  [[16.95578265  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00237063  0.01148921 -0.12010759]
Stock Position:  0.0023706254402657547
Bond Position:  [-3.1566231]


portfolio before change:  [-2.92325673]
curr_Stock_Price:  98.60730224399717
curr_Factors:  [98.60730224 -0.74990623 -1.02331476]
mat_Sqrt:  [[16.74206343  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148675 -0.00200672  0.09324255]
Stock Position:  -0.0014867468032457865
Bond Position:  [-2.77665264]


portfolio before change:  [-2.922789]
curr_Stock_Price:  98.05924056943033
curr_Factors:  [98.05924057 -0.59724396 -1.03319276]
mat_Sqrt:  [[19.2043165   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05979403  0.55717041 -0.78268453]
Stock Position:  0.05979403071735954
Bond Position:  [-8.78614624]


portfolio before change:  [-2.84494986]
curr_Stock_Price:  99.37939698844309
curr_Factors:  [99.37939699 -0.69468337 -1.0306102 ]
mat_Sqrt:  [[17.70153307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00063248 0.00416043 0.12937551]
Stock Position:  0.0006324791600825604
Bond Position:  [-2.90780526]


portfolio before change:  [-2.84473485]
curr_Stock_Price:  100.29406518544073
curr_Factors:  [100.29406519  -0.6666505   -1.03085308]
mat_Sqrt:  [[18.36787004  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.00755339e-02  7.46115422e-04 -1.54354111e+00]
Stock Position:  -0.02007553393287145
Bond Position:  [-0.83127795]


portfolio before change:  [-2.86183063]
curr_Stock_Price:  101.1404616944384
curr_Factors:  [101.14046169  -0.50586533  -1.03131637]
mat_Sqrt:  [[21.7437978   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06981027 -0.97118053  7.19904473]
Stock Position:  0.06981027247682632
Bond Position:  [-9.92247382]


portfolio before change:  [-2.7966007]
curr_Stock_Price:  102.092618432474
curr_Factors:  [102.09261843  -0.2643901   -1.04491563]
mat_Sqrt:  [[27.56576749  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007861  -0.03053791  0.10625201]
Stock Position:  -0.000786097208868047
Bond Position:  [-2.71634598]


portfolio before change:  [-2.79655363]
curr_Stock_Price:  101.60077940491546
curr_Factors:  [101.6007794   -0.33028768  -1.04954714]
mat_Sqrt:  [[25.56479933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00527286 -0.0136255  -0.02474823]
Stock Position:  0.005272860610559636
Bond Position:  [-3.33228038]


portfolio before change:  [-2.79735225]
curr_Stock_Price:  101.52832215480197
curr_Factors:  [101.52832215  -0.21036211  -1.05257896]
mat_Sqrt:  [[28.71434232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00532739 -0.04230328 -0.13526533]
Stock Position:  -0.005327391891703396
Bond Position:  [-2.25647109]


portfolio before change:  [-2.79465768]
curr_Stock_Price:  100.9695795630451
curr_Factors:  [100.96957956  -0.27037721  -1.03536866]
mat_Sqrt:  [[27.35976236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02501879 -0.58050762 -0.57740115]
Stock Position:  -0.02501879357421311
Bond Position:  [-0.26852061]


portfolio before change:  [-2.78603275]
curr_Stock_Price:  100.62349988842014
curr_Factors:  [100.62349989  -0.1587653   -1.01484804]
mat_Sqrt:  [[31.11756625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00059508 0.00977199 0.08880718]
Stock Position:  0.0005950755546964337
Bond Position:  [-2.84591134]


portfolio before change:  [-2.78780902]
curr_Stock_Price:  98.23640141273324
curr_Factors:  [98.23640141 -0.42653124 -0.98265657]
mat_Sqrt:  [[24.0032449   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00524777 0.03766947 0.56296786]
Stock Position:  0.0052477700099840385
Bond Position:  [-3.30333106]


portfolio before change:  [-2.78849622]
curr_Stock_Price:  98.18414028746051
curr_Factors:  [98.18414029 -0.57492221 -1.0160421 ]
mat_Sqrt:  [[20.00296238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147533 -0.00761986  0.08544695]
Stock Position:  0.0014753314610611165
Bond Position:  [-2.93335037]


portfolio before change:  [-2.7895224]
curr_Stock_Price:  97.73712552515889
curr_Factors:  [97.73712553 -0.65416017 -1.05479561]
mat_Sqrt:  [[17.69577141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00620198 -0.01655511  0.10336745]
Stock Position:  0.006201980188776033
Bond Position:  [-3.39568612]


portfolio before change:  [-2.78793673]
curr_Stock_Price:  98.06124189444475
curr_Factors:  [98.06124189 -0.58219021 -1.04338513]
mat_Sqrt:  [[19.29829703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00982469 -0.00379579  0.04907235]
Stock Position:  0.009824691829711485
Bond Position:  [-3.75135821]


portfolio before change:  [-2.78609964]
curr_Stock_Price:  98.29596044769183
curr_Factors:  [98.29596045 -0.43277534 -1.04473873]
mat_Sqrt:  [[22.43155935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272507 -0.01578831  0.22137435]
Stock Position:  -0.002725074954929312
Bond Position:  [-2.51823578]


portfolio before change:  [-2.78899365]
curr_Stock_Price:  99.24243323711393
curr_Factors:  [99.24243324 -0.43855754 -1.04710517]
mat_Sqrt:  [[22.46375138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00058358 -0.03111931  0.05552019]
Stock Position:  0.0005835818947879263
Bond Position:  [-2.84690973]


portfolio before change:  [-2.79069717]
curr_Stock_Price:  96.93318264526793
curr_Factors:  [96.93318265 -0.46687754 -0.99657594]
mat_Sqrt:  [[22.43379262  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00439949 -0.01354968  0.82741109]
Stock Position:  0.004399488574053262
Bond Position:  [-3.2171536]


portfolio before change:  [-2.78899648]
curr_Stock_Price:  97.41115945495653
curr_Factors:  [97.41115945 -0.49980205 -0.99594413]
mat_Sqrt:  [[21.82802289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01119807 -0.0437711  -0.21133637]
Stock Position:  -0.01119807394924072
Bond Position:  [-1.69817912]


portfolio before change:  [-2.78287258]
curr_Stock_Price:  96.84533051595116
curr_Factors:  [96.84533052 -0.4095177  -0.96698485]
mat_Sqrt:  [[24.44957013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365844  0.03710155  0.67243064]
Stock Position:  -0.0036584419243562974
Bond Position:  [-2.42856956]


portfolio before change:  [-2.78313893]
curr_Stock_Price:  96.83515198162226
curr_Factors:  [96.83515198 -0.35316661 -0.98083637]
mat_Sqrt:  [[25.5083816   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00267984 0.00558029 0.48063848]
Stock Position:  0.002679838434677377
Bond Position:  [-3.04264149]


portfolio before change:  [-2.78186937]
curr_Stock_Price:  97.45082945833995
curr_Factors:  [97.45082946 -0.23669032 -0.99243521]
mat_Sqrt:  [[28.50907367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286202  0.03385748 -0.01699219]
Stock Position:  -0.0028620236060579543
Bond Position:  [-2.50296279]


portfolio before change:  [-2.78235713]
curr_Stock_Price:  97.51193069516536
curr_Factors:  [97.5119307  -0.43189868 -0.99970075]
mat_Sqrt:  [[23.29818133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00156626 -0.0046348  -0.23108648]
Stock Position:  0.0015662600838128897
Bond Position:  [-2.93508617]


portfolio before change:  [-2.78320596]
curr_Stock_Price:  97.20424280503453
curr_Factors:  [97.20424281 -0.33400008 -1.03187047]
mat_Sqrt:  [[24.80248394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173293  0.00125608 -0.12672924]
Stock Position:  -0.0017329322578350335
Bond Position:  [-2.61475759]


portfolio before change:  [-2.78481388]
curr_Stock_Price:  97.94348783661904
curr_Factors:  [97.94348784 -0.31101885 -0.97818382]
mat_Sqrt:  [[26.98248593  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208312 -0.00638584  0.10410612]
Stock Position:  -0.0020831176657778454
Bond Position:  [-2.58078607]


portfolio before change:  [-2.78713522]
curr_Stock_Price:  98.90297108726476
curr_Factors:  [ 9.89029711e+01  2.72454882e-02 -9.75175893e-01]
mat_Sqrt:  [[38.3290799   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00026379 0.00168166 0.0110501 ]
Stock Position:  0.0002637912110422685
Bond Position:  [-2.81322495]


portfolio before change:  [-2.78730206]
curr_Stock_Price:  99.60365330949402
curr_Factors:  [99.60365331  0.11207379 -1.02369402]
mat_Sqrt:  [[40.02797623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00256935 -0.00934678 -0.05572154]
Stock Position:  0.002569352303916006
Bond Position:  [-3.04321894]


portfolio before change:  [-2.78583702]
curr_Stock_Price:  100.32191365276682
curr_Factors:  [100.32191365   0.3121145   -1.04045077]
mat_Sqrt:  [[48.42653382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308027 -0.01938424 -0.26667816]
Stock Position:  -0.003080272731735199
Bond Position:  [-2.47681817]


portfolio before change:  [-2.77496364]
curr_Stock_Price:  96.6913891719616
curr_Factors:  [96.69138917  0.36814819 -1.04218332]
mat_Sqrt:  [[49.27856599  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03700164 0.33460041 0.4041689 ]
Stock Position:  0.037001641321403086
Bond Position:  [-6.35270374]


portfolio before change:  [-2.96134431]
curr_Stock_Price:  91.6757594411289
curr_Factors:  [91.67575944  0.47201268 -1.03576804]
mat_Sqrt:  [[52.16973989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00153769 -0.07343804  0.24925953]
Stock Position:  0.0015376898552759905
Bond Position:  [-3.10231319]


portfolio before change:  [-2.95791646]
curr_Stock_Price:  94.15718631311582
curr_Factors:  [94.15718631  0.25703503 -1.01417888]
mat_Sqrt:  [[44.16010283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004875  -0.00491945 -0.0802445 ]
Stock Position:  0.00048750468099056
Bond Position:  [-3.00381853]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.95706892]
Stock Price:  96.6659525341029
PL:  [-2.95706892]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 6.99421145e-03 -5.09428251e-02  1.65472296e-01]
 [ 9.36016504e-01  2.16939066e-01  2.62459497e-01]
 [-3.06975155e-01 -1.96093897e-01  3.87506505e-02]
 [ 2.17584536e-01  1.36790704e+00  1.34282074e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 7.30419706e-03  1.05537544e-01 -2.97193135e-02]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [ 4.73639144e-02  1.66496234e-01 -4.24094426e-02]
 [ 8.95296303e-03  7.08447011e-02 -4.74576812e-02]
 [-2.10132416e-01 -1.17889478e-01 -9.16195480e-02]
 [ 8.33399879e-01  1.60362437e+00 -2.89977679e-01]
 [-3.59809237e-05  2.45725889e-02 -5.84709684e-02]
 [-2.95648147e-01 -4.12614166e-03 -6.01434090e-01]
 [ 1.72856279e+00 -3.32973806e+00  2.79460533e+00]
 [ 2.53880774e-03 -9.25115573e-02  3.59500007e-02]
 [ 1.25053645e-01 -4.89524500e-02 -9.58316872e-05]
 [-1.16222586e-01 -1.25157601e-01 -4.09928337e-02]
 [-2.67136754e-01 -1.74091256e+00 -1.99882363e-01]
 [-2.04322176e-02  8.93804904e-02  2.66106408e-01]
 [ 2.32684912e-01 -1.49337224e-01  3.64134349e-01]
 [ 6.07316780e-02 -8.89966989e-02  1.91932142e-02]
 [ 1.44712141e-01 -5.40264282e-02 -1.58145015e-02]
 [ 6.51301486e-02  1.46784195e-01  1.09692297e-01]
 [-1.30883300e-01  2.73226571e-02  3.48390355e-02]
 [-1.88993109e-02 -1.37598175e-01  4.84209900e-02]
 [ 5.04235606e-02 -7.96017287e-03  1.26760589e-01]
 [ 2.90677791e-01 -9.44727680e-02  1.22107775e-01]
 [-7.17760725e-02  3.83041990e-02  1.15245127e-01]
 [-8.60866989e-03 -7.40699877e-02 -1.63527123e-03]
 [ 1.31734421e-01 -5.29732045e-02  8.86665334e-02]
 [-1.97825647e-02 -3.62370552e-02 -5.16814356e-02]
 [-3.84365287e-02  2.32710762e-02 -4.93883182e-02]
 [-1.05937741e-01 -3.49249894e-02  3.48426505e-02]
 [ 2.41497694e-01  2.04778525e-02  4.95940426e-02]
 [ 8.54383605e-03 -3.67893866e-02  2.34005247e-02]
 [-1.10784197e-01 -5.69051965e-02 -8.58908969e-02]
 [ 1.88527078e+00  1.24287687e+00  1.56752408e-01]
 [-1.61578797e-02 -1.10148172e-01 -4.99472780e-02]
 [ 3.52261068e-02 -1.34226037e-02 -1.09070511e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.49712205]
curr_Stock_Price:  100.42157772418645
curr_Factors:  [100.42157772  -0.8835165   -1.01066832]
mat_Sqrt:  [[15.10751466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00201042 -0.01644173  0.4720464 ]
Stock Position:  0.002010419477201517
Bond Position:  [5.29523255]


portfolio before change:  [5.49662708]
curr_Stock_Price:  99.84611621376919
curr_Factors:  [99.84611621 -1.00992071 -1.00583454]
mat_Sqrt:  [[13.30147469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07772622 0.07001678 0.74872389]
Stock Position:  0.07772621828750573
Bond Position:  [-2.26403395]


portfolio before change:  [5.47699456]
curr_Stock_Price:  99.59717195364995
curr_Factors:  [99.59717195 -0.81431733 -0.98390619]
mat_Sqrt:  [[16.49257457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02056033 -0.06328903  0.11054482]
Stock Position:  -0.020560326051485486
Bond Position:  [7.52474489]


portfolio before change:  [5.48908805]
curr_Stock_Price:  99.05472751111077
curr_Factors:  [99.05472751 -0.73986228 -0.98233776]
mat_Sqrt:  [[17.69836859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04355823 0.4414901  3.8306938 ]
Stock Position:  0.04355822531251098
Bond Position:  [1.17443991]


portfolio before change:  [5.54093125]
curr_Stock_Price:  100.24156178513154
curr_Factors:  [100.24156179  -1.19364792  -0.99181988]
mat_Sqrt:  [[11.26967048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00520388 -0.01106097 -0.05874131]
Stock Position:  -0.005203878943426053
Bond Position:  [6.06257621]


portfolio before change:  [5.54485402]
curr_Stock_Price:  99.63338169561203
curr_Factors:  [99.6333817  -0.83543905 -0.99129564]
mat_Sqrt:  [[16.03481947  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00142069  0.0340621  -0.08478093]
Stock Position:  0.0014206912959148262
Bond Position:  [5.40330574]


portfolio before change:  [5.54690168]
curr_Stock_Price:  100.59925248543205
curr_Factors:  [100.59925249  -1.01003406  -1.00983034]
mat_Sqrt:  [[13.3468503   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00496674 -0.00251018 -0.21167328]
Stock Position:  -0.004966739075852963
Bond Position:  [6.04655192]


portfolio before change:  [5.54673271]
curr_Stock_Price:  100.78545743792971
curr_Factors:  [100.78545744  -1.29936003  -1.01510411]
mat_Sqrt:  [[ 9.95953044  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00729884  0.05373643 -0.12098234]
Stock Position:  0.00729884055278509
Bond Position:  [4.81111573]


portfolio before change:  [5.5449547]
curr_Stock_Price:  100.45945437485942
curr_Factors:  [100.45945437  -1.0729975   -0.99363461]
mat_Sqrt:  [[12.71932005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107921  0.02286503 -0.13538355]
Stock Position:  0.001079210085196146
Bond Position:  [5.43653784]


portfolio before change:  [5.54641156]
curr_Stock_Price:  101.17965891118385
curr_Factors:  [101.17965891  -1.32739797  -0.99806381]
mat_Sqrt:  [[ 9.88912785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02557336 -0.03804867 -0.26136507]
Stock Position:  -0.025573364018437576
Bond Position:  [8.13391581]


portfolio before change:  [5.55294306]
curr_Stock_Price:  100.9640166263575
curr_Factors:  [100.96401663  -1.00970536  -1.03255431]
mat_Sqrt:  [[13.09858895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08409661  0.51756754 -0.8272256 ]
Stock Position:  0.08409660701110225
Bond Position:  [-2.93778817]


portfolio before change:  [5.53829717]
curr_Stock_Price:  100.79422802924661
curr_Factors:  [100.79422803  -0.98960904  -1.04998685]
mat_Sqrt:  [[13.111441    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00053049  0.00793077 -0.1668014 ]
Stock Position:  -0.0005304877370187122
Bond Position:  [5.59176727]


portfolio before change:  [5.53907382]
curr_Stock_Price:  100.64788156588429
curr_Factors:  [100.64788157  -1.20371245  -1.04536877]
mat_Sqrt:  [[10.6179597   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.94857038e-02 -1.33170650e-03 -1.71572405e+00]
Stock Position:  -0.039485703822985094
Bond Position:  [9.51322626]


portfolio before change:  [5.50228571]
curr_Stock_Price:  101.60968111491918
curr_Factors:  [101.60968111  -1.23292391  -1.0598454 ]
mat_Sqrt:  [[10.26119707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.15781095 -1.07466834  7.97223114]
Stock Position:  0.15781095191989536
Bond Position:  [-10.53283479]


portfolio before change:  [5.53436888]
curr_Stock_Price:  101.82132581120169
curr_Factors:  [101.82132581  -1.41415972  -1.07375783]
mat_Sqrt:  [[ 8.45960114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106468 -0.02985798  0.10255535]
Stock Position:  -0.001064680415840478
Bond Position:  [5.64277605]


portfolio before change:  [5.53480508]
curr_Stock_Price:  102.07416150593303
curr_Factors:  [102.07416151  -1.50627712  -1.10510894]
mat_Sqrt:  [[ 7.49558036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01534794 -0.01579934 -0.00027338]
Stock Position:  0.015347938549168964
Bond Position:  [3.96817712]


portfolio before change:  [5.53253857]
curr_Stock_Price:  101.89416593830913
curr_Factors:  [101.89416594  -1.58615055  -1.11812504]
mat_Sqrt:  [[ 6.81863355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02201877 -0.04039444 -0.11694114]
Stock Position:  -0.022018766726554194
Bond Position:  [7.77612244]


portfolio before change:  [5.53469767]
curr_Stock_Price:  101.8402565951953
curr_Factors:  [101.8402566   -1.41500597  -1.11427057]
mat_Sqrt:  [[ 8.1183662   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08170361 -0.56187711 -0.57020875]
Stock Position:  -0.08170361408833246
Bond Position:  [13.85541469]


portfolio before change:  [5.51866394]
curr_Stock_Price:  102.05769809917042
curr_Factors:  [102.0576981   -1.28424469  -1.1390725 ]
mat_Sqrt:  [[ 9.04508151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00576349 0.02884743 0.75912751]
Stock Position:  0.005763490531797105
Bond Position:  [4.93045537]


portfolio before change:  [5.51791974]
curr_Stock_Price:  101.82163406648631
curr_Factors:  [101.82163407  -1.12404898  -1.14888791]
mat_Sqrt:  [[10.48856591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02636492 -0.04819838  1.03877394]
Stock Position:  0.026364919107553206
Bond Position:  [2.83340059]


portfolio before change:  [5.53420962]
curr_Stock_Price:  102.42606174336011
curr_Factors:  [102.42606174  -1.32558051  -1.14361212]
mat_Sqrt:  [[ 8.67069162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00536095 -0.02872356  0.0547529 ]
Stock Position:  0.005360945047328072
Bond Position:  [4.98510913]


portfolio before change:  [5.53257271]
curr_Stock_Price:  102.00447740989465
curr_Factors:  [102.00447741  -1.37575679  -1.14213034]
mat_Sqrt:  [[ 8.22459933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01586167 -0.01743695 -0.04511437]
Stock Position:  0.015861674911012473
Bond Position:  [3.91461085]


portfolio before change:  [5.52497574]
curr_Stock_Price:  101.49467460417392
curr_Factors:  [101.4946746   -1.27181524  -1.12511086]
mat_Sqrt:  [[ 9.23573527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0127205  0.0473744  0.31292159]
Stock Position:  0.012720502475769243
Bond Position:  [4.23391248]


portfolio before change:  [5.53090837]
curr_Stock_Price:  101.91945006115577
curr_Factors:  [101.91945006  -1.22208489  -1.13199862]
mat_Sqrt:  [[ 9.6803619   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01220973  0.00881835  0.09938607]
Stock Position:  -0.012209729251523003
Bond Position:  [6.77531726]


portfolio before change:  [5.53369638]
curr_Stock_Price:  101.76047512280849
curr_Factors:  [101.76047512  -1.03821838  -1.12545787]
mat_Sqrt:  [[11.69247562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031732  -0.04440962  0.13813161]
Stock Position:  -0.0031731969116521657
Bond Position:  [5.8566024]


portfolio before change:  [5.53528191]
curr_Stock_Price:  101.49153155500082
curr_Factors:  [101.49153156  -0.88445954  -1.11964082]
mat_Sqrt:  [[13.67918044  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00545892 -0.00256913  0.36161268]
Stock Position:  0.005458923090692074
Bond Position:  [4.98124744]


portfolio before change:  [5.53483968]
curr_Stock_Price:  101.29645196137331
curr_Factors:  [101.29645196  -0.82432988  -1.14452236]
mat_Sqrt:  [[14.14270785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02095205 -0.03049095  0.34833949]
Stock Position:  0.020952052888931105
Bond Position:  [3.41247106]


portfolio before change:  [5.53177372]
curr_Stock_Price:  101.12975999246052
curr_Factors:  [101.12975999  -0.80332017  -1.1470796 ]
mat_Sqrt:  [[14.38239199  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281128  0.01236263  0.32876227]
Stock Position:  -0.002811281158218955
Bond Position:  [5.81607791]


portfolio before change:  [5.52901717]
curr_Stock_Price:  102.36891257737754
curr_Factors:  [102.36891258  -0.81633386  -1.14090879]
mat_Sqrt:  [[14.45933802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166411 -0.02390599 -0.00466497]
Stock Position:  -0.0016641108411791592
Bond Position:  [5.69937039]


portfolio before change:  [5.5299319]
curr_Stock_Price:  102.24736724278826
curr_Factors:  [102.24736724  -1.27221725  -1.13035485]
mat_Sqrt:  [[ 9.25184465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01502622 -0.01709703  0.25294094]
Stock Position:  0.015026224096305454
Bond Position:  [3.99354005]


portfolio before change:  [5.52632599]
curr_Stock_Price:  101.97416879069749
curr_Factors:  [101.97416879  -1.1752634   -1.1095687 ]
mat_Sqrt:  [[10.38006809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00363474 -0.01169546 -0.14743275]
Stock Position:  -0.003634740269961277
Bond Position:  [5.8969756]


portfolio before change:  [5.52791242]
curr_Stock_Price:  101.74051633449595
curr_Factors:  [101.74051633  -1.04664627  -1.12253845]
mat_Sqrt:  [[11.62596425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00376465  0.00751071 -0.14089112]
Stock Position:  -0.003764650179993245
Bond Position:  [5.91092987]


portfolio before change:  [5.53220625]
curr_Stock_Price:  100.7962273051144
curr_Factors:  [100.79622731  -1.02709533  -1.09395633]
mat_Sqrt:  [[12.08601823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0087667  -0.01127199  0.09939638]
Stock Position:  -0.008766704347446457
Bond Position:  [6.41585698]


portfolio before change:  [5.53344146]
curr_Stock_Price:  100.7468159151349
curr_Factors:  [100.74681592  -1.02894628  -1.09335343]
mat_Sqrt:  [[12.06502637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02120186 0.0066092  0.141478  ]
Stock Position:  0.021201864931041946
Bond Position:  [3.39742108]


portfolio before change:  [5.5385716]
curr_Stock_Price:  100.96875107181879
curr_Factors:  [100.96875107  -0.86189935  -1.08301084]
mat_Sqrt:  [[14.43853797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040245 -0.01187372  0.06675518]
Stock Position:  0.000402453909737713
Bond Position:  [5.49793633]


portfolio before change:  [5.53919368]
curr_Stock_Price:  100.8067381241196
curr_Factors:  [100.80673812  -0.76272885  -1.06215891]
mat_Sqrt:  [[16.253649    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00860929 -0.01836607 -0.24502282]
Stock Position:  -0.008609286880290026
Bond Position:  [6.40706781]


portfolio before change:  [5.53332257]
curr_Stock_Price:  101.58172053141442
curr_Factors:  [101.58172053  -0.9168492   -1.06829082]
mat_Sqrt:  [[13.95340523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.15558703 0.40113678 0.44717099]
Stock Position:  0.15558703212695543
Bond Position:  [-10.27147584]


portfolio before change:  [5.57252121]
curr_Stock_Price:  101.8419135315505
curr_Factors:  [101.84191353  -0.96297828  -1.08745549]
mat_Sqrt:  [[13.10492312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372663 -0.03555017 -0.14248568]
Stock Position:  -0.0037266320590923414
Bond Position:  [5.95204855]


portfolio before change:  [5.5738401]
curr_Stock_Price:  101.68766229944693
curr_Factors:  [101.6876623   -0.83267727  -1.10231238]
mat_Sqrt:  [[14.68631814  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00069604 -0.00433213 -0.31114781]
Stock Position:  0.0006960427032531543
Bond Position:  [5.50306115]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.57481207]
Stock Price:  102.09574488965846
PL:  [3.47906718]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-1.83570700e-02 -8.61334505e-02  1.51554996e-01]
 [ 9.45696965e-01  2.26766668e-01  2.60194826e-01]
 [-3.78173627e-01 -2.61630620e-01  4.08274084e-02]
 [ 2.03298923e-01  1.25749007e+00  1.25001618e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-2.39546308e-02  2.74780669e-01 -1.23344855e-01]
 [-1.17139331e-01  1.70141652e-01  6.84114859e-02]
 [-3.39737156e-02  6.17041137e-02  2.59204524e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 7.77588684e-01  1.61725171e+00 -2.40439929e-01]
 [-1.35755992e-03  2.46420822e-02  1.34722455e-01]
 [-5.20854175e-01 -3.65952541e-02 -1.15099668e+00]
 [ 1.99248593e+00 -2.91497728e+00  2.47938012e+00]
 [ 7.13821038e-03 -9.45718249e-03 -2.09860988e-02]
 [ 1.57537480e-02  3.85726806e-01 -2.10830613e-01]
 [ 2.43653258e-02 -2.03886636e-01 -5.72768713e-02]
 [-3.03325835e-01 -1.92738110e+00 -1.92794869e-01]
 [ 3.26316679e-02 -6.87687589e-02  3.10852165e-02]
 [-7.18713604e-02  4.11365501e-01  2.72175643e-01]
 [ 2.66956582e-02 -6.46566378e-03  1.74682489e-02]
 [ 1.11351307e-01 -5.11242649e-02  3.00077293e-02]
 [-5.96641643e-02 -6.35499692e-02 -6.82478925e-02]
 [-6.02546191e-02 -4.88727669e-02  4.13411843e-02]
 [ 6.66904457e-02 -2.42003731e-03 -1.74081297e-02]
 [ 4.25978592e-02 -4.29414850e-02  2.82850548e-01]
 [ 3.10413106e-02 -1.16415401e-01  1.77744042e-02]
 [-6.83724229e-03 -8.64891913e-02 -7.05754891e-03]
 [ 4.00818318e-02 -3.35329668e-02  4.87882328e-02]
 [-3.19716007e-02  7.94776482e-02 -8.63285131e-04]
 [ 3.83869004e-02 -1.50134883e-02 -7.75831634e-02]
 [-3.91515217e-02  2.04408105e-02 -4.83200370e-02]
 [-1.12099577e-01 -3.00266179e-02  4.21930681e-02]
 [ 6.97187105e-02  3.90102758e-03  1.49970648e-02]
 [-9.40394461e-02 -2.06116780e-03  4.47369185e-02]
 [-1.20050037e-01 -7.00931763e-02 -8.30991872e-02]
 [ 2.51239738e+00  1.60903435e+00  1.76050907e-01]
 [-2.35802133e-02 -9.72726998e-02 -3.04189606e-02]
 [ 3.25352889e-02 -1.39924897e-02 -5.97315125e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.05916166]
curr_Stock_Price:  99.95242814968402
curr_Factors:  [99.95242815 -0.89655583 -0.99474249]
mat_Sqrt:  [[15.08040216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.31751956e-04 -2.77994516e-02  4.32344219e-01]
Stock Position:  -0.00033175195642132097
Bond Position:  [2.09232107]


portfolio before change:  [2.05929348]
curr_Stock_Price:  100.34348298141873
curr_Factors:  [100.34348298  -0.60122634  -0.99701461]
mat_Sqrt:  [[20.29466788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05149616 0.07318863 0.74226342]
Stock Position:  0.05149616487296079
Bond Position:  [-3.10801107]


portfolio before change:  [1.99091106]
curr_Stock_Price:  99.02311490151165
curr_Factors:  [99.0231149  -0.71771676 -0.97769652]
mat_Sqrt:  [[18.1730554   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02328969 -0.08444092  0.11646923]
Stock Position:  -0.023289693688181585
Bond Position:  [4.29712907]


portfolio before change:  [1.98370803]
curr_Stock_Price:  99.3554597035882
curr_Factors:  [99.3554597  -0.68849132 -0.9856551 ]
mat_Sqrt:  [[18.6259823   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03839483 0.40585317 3.56594822]
Stock Position:  0.038394833699937195
Bond Position:  [-1.83102833]


portfolio before change:  [1.96203203]
curr_Stock_Price:  98.79686615227378
curr_Factors:  [98.79686615 -0.55452428 -0.97328941]
mat_Sqrt:  [[21.43986834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273537 -0.01106097 -0.05874131]
Stock Position:  -0.0027353713183305376
Bond Position:  [2.23227814]


portfolio before change:  [1.96235629]
curr_Stock_Price:  98.78033814994555
curr_Factors:  [98.78033815 -0.6646171  -0.97074423]
mat_Sqrt:  [[19.25050417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0003614   0.08868508 -0.35186854]
Stock Position:  0.0003613970429071255
Bond Position:  [1.92665737]


portfolio before change:  [1.96230427]
curr_Stock_Price:  97.9699510682779
curr_Factors:  [97.96995107 -0.84798238 -0.96856507]
mat_Sqrt:  [[15.92855418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429699  0.05491298  0.19515893]
Stock Position:  -0.004296992339295413
Bond Position:  [2.38328039]


portfolio before change:  [1.96729919]
curr_Stock_Price:  96.8768607680078
curr_Factors:  [96.87686077 -0.80115314 -0.94192408]
mat_Sqrt:  [[16.95162106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094902  0.01991492  0.07394384]
Stock Position:  -0.0009490199123883134
Bond Position:  [2.05923726]


portfolio before change:  [1.96779503]
curr_Stock_Price:  96.62563736480344
curr_Factors:  [96.62563736 -0.59454987 -0.92819217]
mat_Sqrt:  [[21.07530679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00246693  0.0064198  -0.11330016]
Stock Position:  0.002466925101410696
Bond Position:  [1.72942682]


portfolio before change:  [1.97008661]
curr_Stock_Price:  97.46692166026764
curr_Factors:  [97.46692166 -0.61048906 -0.92795412]
mat_Sqrt:  [[20.92762118  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.17662973e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  4.176629726247203e-05
Bond Position:  [1.96601578]


portfolio before change:  [1.97031565]
curr_Stock_Price:  97.06654283316901
curr_Factors:  [97.06654283 -0.67275442 -0.90924406]
mat_Sqrt:  [[19.95337445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05305515  0.52196574 -0.68590819]
Stock Position:  0.053055146879569956
Bond Position:  [-3.17956403]


portfolio before change:  [1.94751875]
curr_Stock_Price:  96.64435126260992
curr_Factors:  [96.64435126 -0.77521397 -0.94228021]
mat_Sqrt:  [[17.34915112  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00179678 0.0079532  0.38432566]
Stock Position:  0.001796778976066476
Bond Position:  [1.77387021]


portfolio before change:  [1.94696625]
curr_Stock_Price:  96.21344204968719
curr_Factors:  [96.21344205 -0.67248289 -0.92059774]
mat_Sqrt:  [[19.56003489  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03902193 -0.01181107 -3.28347316]
Stock Position:  -0.03902193262737935
Bond Position:  [5.7014007]


portfolio before change:  [1.96314926]
curr_Stock_Price:  95.81699086103372
curr_Factors:  [95.81699086 -0.41475191 -0.91017835]
mat_Sqrt:  [[25.47021584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0747371  -0.94080487  7.07298135]
Stock Position:  0.07473709863280899
Bond Position:  [-5.19793464]


portfolio before change:  [1.85028206]
curr_Stock_Price:  94.31549534160725
curr_Factors:  [94.31549534 -0.32015707 -0.87542636]
mat_Sqrt:  [[28.5330217   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.23835872e-05 -3.05229252e-03 -5.98674986e-02]
Stock Position:  3.238358719548304e-05
Bond Position:  [1.84722778]


portfolio before change:  [1.85051797]
curr_Stock_Price:  94.46987661741754
curr_Factors:  [94.46987662 -0.39380453 -0.89213012]
mat_Sqrt:  [[26.11073065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197062  0.12449279 -0.60144106]
Stock Position:  0.0019706183109006186
Bond Position:  [1.66435391]


portfolio before change:  [1.8498822]
curr_Stock_Price:  94.04167183547325
curr_Factors:  [94.04167184 -0.62425811 -0.8693629 ]
mat_Sqrt:  [[21.11781472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137062 -0.06580413 -0.16339497]
Stock Position:  -0.001370617759880091
Bond Position:  [1.97877739]


portfolio before change:  [1.84957873]
curr_Stock_Price:  94.44355846547063
curr_Factors:  [94.44355847 -0.50482441 -0.91315797]
mat_Sqrt:  [[22.87443714  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03218024 -0.62205958 -0.5499901 ]
Stock Position:  -0.032180242907612275
Bond Position:  [4.88879538]


portfolio before change:  [1.81174459]
curr_Stock_Price:  95.63824435154731
curr_Factors:  [95.63824435 -0.66012031 -0.93131385]
mat_Sqrt:  [[19.47513691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128058 -0.02219502  0.08867747]
Stock Position:  0.001280583911648139
Bond Position:  [1.68927179]


portfolio before change:  [1.8126741]
curr_Stock_Price:  96.19918847638765
curr_Factors:  [96.19918848 -0.96401551 -0.9271245 ]
mat_Sqrt:  [[14.51642721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00466064 0.13276764 0.77644135]
Stock Position:  0.004660643438222329
Bond Position:  [1.36432398]


portfolio before change:  [1.81839513]
curr_Stock_Price:  97.3901137242782
curr_Factors:  [97.39011372 -1.09114959 -0.92571925]
mat_Sqrt:  [[12.95984675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00223317 -0.00208678  0.04983205]
Stock Position:  0.002233170813984151
Bond Position:  [1.60090637]


portfolio before change:  [1.82071373]
curr_Stock_Price:  98.3387556106929
curr_Factors:  [98.33875561 -1.05976938 -0.92614965]
mat_Sqrt:  [[13.49742831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00793047 -0.01650029  0.0856037 ]
Stock Position:  0.00793046720345149
Bond Position:  [1.04084145]


portfolio before change:  [1.82010968]
curr_Stock_Price:  98.24618082975019
curr_Factors:  [98.24618083 -1.18582791 -0.91687309]
mat_Sqrt:  [[11.99842474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00721489 -0.02051066 -0.19469224]
Stock Position:  -0.007214887958521535
Bond Position:  [2.52894487]


portfolio before change:  [1.81667004]
curr_Stock_Price:  98.76674092911462
curr_Factors:  [98.76674093 -1.14256148 -0.90991794]
mat_Sqrt:  [[12.68324081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00487194 -0.01577362  0.11793489]
Stock Position:  -0.004871940683431101
Bond Position:  [2.29785574]


portfolio before change:  [1.82012827]
curr_Stock_Price:  98.1158748398504
curr_Factors:  [98.11587484 -0.99040417 -0.91134618]
mat_Sqrt:  [[14.64939188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00427615 -0.00078106 -0.04966055]
Stock Position:  0.004276152797742405
Bond Position:  [1.4005698]


portfolio before change:  [1.8210893]
curr_Stock_Price:  98.29967377943431
curr_Factors:  [98.29967378 -0.77640235 -0.90892042]
mat_Sqrt:  [[18.22324431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00502485 -0.0138593   0.80689388]
Stock Position:  0.0050248512327843355
Bond Position:  [1.32714807]


portfolio before change:  [1.82261521]
curr_Stock_Price:  98.5703285335313
curr_Factors:  [98.57032853 -0.8802382  -0.92926677]
mat_Sqrt:  [[16.13942959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00067576 -0.03757291  0.05070543]
Stock Position:  0.0006757550742739684
Bond Position:  [1.75600581]


portfolio before change:  [1.82286473]
curr_Stock_Price:  98.61473957099186
curr_Factors:  [98.61473957 -1.1991247  -0.93059912]
mat_Sqrt:  [[11.72234581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221222 -0.02791427 -0.02013322]
Stock Position:  -0.0022122185354221087
Bond Position:  [2.04102209]


portfolio before change:  [1.82374788]
curr_Stock_Price:  98.33085899964838
curr_Factors:  [98.330859   -1.16878991 -0.89676219]
mat_Sqrt:  [[12.46326859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00346585 -0.01082272  0.13917925]
Stock Position:  0.003465848433131227
Bond Position:  [1.48294803]


portfolio before change:  [1.82313576]
curr_Stock_Price:  98.10075494471154
curr_Factors:  [98.10075494 -1.42340749 -0.89751877]
mat_Sqrt:  [[ 9.63178726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165333  0.0256513  -0.00246271]
Stock Position:  -0.0016533287723396056
Bond Position:  [1.98532856]


portfolio before change:  [1.82238648]
curr_Stock_Price:  98.70406036103819
curr_Factors:  [98.70406036 -1.34343659 -0.86728314]
mat_Sqrt:  [[10.82010913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00180088 -0.00484558 -0.22132317]
Stock Position:  0.0018008772209020417
Bond Position:  [1.64463258]


portfolio before change:  [1.82362357]
curr_Stock_Price:  99.27683598025274
curr_Factors:  [99.27683598 -1.14705001 -0.88576857]
mat_Sqrt:  [[13.00187646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344891  0.00659724 -0.13784362]
Stock Position:  -0.0034489133261426563
Bond Position:  [2.16602077]


portfolio before change:  [1.82268872]
curr_Stock_Price:  99.62640117273105
curr_Factors:  [99.62640117 -1.00296937 -0.87402778]
mat_Sqrt:  [[15.24772092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00718902 -0.00969105  0.12036508]
Stock Position:  -0.007189016056377585
Bond Position:  [2.53890451]


portfolio before change:  [1.82406543]
curr_Stock_Price:  99.47904633662897
curr_Factors:  [99.47904634 -1.04195098 -0.88274997]
mat_Sqrt:  [[14.51592158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00506866 0.00125905 0.04278245]
Stock Position:  0.00506865975282898
Bond Position:  [1.31984]


portfolio before change:  [1.82447352]
curr_Stock_Price:  99.52700635913833
curr_Factors:  [99.52700636 -0.8881361  -0.88528975]
mat_Sqrt:  [[16.8947543   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00505058 -0.00066524  0.12762198]
Stock Position:  -0.005050579218240597
Bond Position:  [2.32714255]


portfolio before change:  [1.82430498]
curr_Stock_Price:  99.6179756103082
curr_Factors:  [99.61797561 -0.99249109 -0.85848548]
mat_Sqrt:  [[15.64835904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00967004 -0.02262248 -0.23705885]
Stock Position:  -0.009670042545924084
Bond Position:  [2.78761504]


portfolio before change:  [1.82334965]
curr_Stock_Price:  99.75280486844247
curr_Factors:  [99.75280487 -1.12800897 -0.86323682]
mat_Sqrt:  [[13.61877541  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.21123605 0.5193136  0.50222423]
Stock Position:  0.21123605443235974
Bond Position:  [-19.24803927]


portfolio before change:  [1.68612582]
curr_Stock_Price:  99.11457255268445
curr_Factors:  [99.11457255 -1.14922031 -0.84554977]
mat_Sqrt:  [[13.48403506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00368177 -0.03139463 -0.08677683]
Stock Position:  -0.0036817736030416407
Bond Position:  [2.05104324]


portfolio before change:  [1.68717611]
curr_Stock_Price:  98.89894532624005
curr_Factors:  [98.89894533 -1.1750445  -0.83574782]
mat_Sqrt:  [[13.24084349  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00132064 -0.00451606 -0.17039738]
Stock Position:  0.0013206439612418433
Bond Position:  [1.55656581]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.68628]
Stock Price:  98.07306559100276
PL:  [1.68628]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-1.99947943e-02 -9.53058318e-02  1.49524467e-01]
 [ 1.32976593e-01  2.10965202e-01  2.87538456e-02]
 [-3.59911335e-01 -2.44820557e-01  4.02947234e-02]
 [ 1.63389387e-01  9.83161797e-01  9.97461612e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 3.95827451e-02 -2.23759272e-02  2.56011696e-02]
 [-4.38827628e-02 -4.40902327e-02 -4.99309354e-02]
 [-6.02474213e-02  1.22200752e-01  1.38784026e-03]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 7.98126957e-01  1.66094882e+00 -2.46397027e-01]
 [-2.07894714e-03 -9.05402028e-02  2.76134615e-01]
 [-5.41561085e-01 -9.11906496e-02 -1.31184272e+00]
 [ 2.03300152e+00 -2.97850381e+00  2.53467380e+00]
 [-1.19910497e-02  6.05423424e-02 -2.87464613e-02]
 [ 9.07117795e-03  4.67918347e-01 -2.50664974e-01]
 [ 2.21102515e-02 -1.85285540e-01 -7.86361422e-02]
 [-3.08091425e-01 -1.95098769e+00 -1.91518851e-01]
 [ 4.83086611e-02 -1.32042921e-01  4.43434941e-02]
 [-3.08496761e-01  3.02695770e-01  1.05530255e-01]
 [ 1.51035420e-02  1.24237121e-01 -7.77137705e-02]
 [ 3.69423004e-02 -3.91669660e-02  7.55042594e-03]
 [-1.54721272e-02 -1.05648320e-01 -1.04540502e-01]
 [-2.67200784e-01  9.68442785e-02  1.86196888e-02]
 [ 1.32824541e-01 -1.62698960e-02 -4.70737302e-02]
 [ 1.74629242e-04 -5.03896454e-02  2.27011843e-01]
 [-1.74400275e-01 -8.38210882e-02 -5.10861204e-02]
 [-2.52725275e-01  1.83627032e-01  3.42757157e-01]
 [ 2.00502927e-01  1.98405248e-01  3.57548616e-01]
 [-1.43124676e-01  9.24941353e-02 -1.80979516e-01]
 [ 1.84567491e-01  3.61127446e-02  1.04932354e-01]
 [ 5.98801879e-02 -2.08070325e-03 -6.83570125e-02]
 [-5.56544714e-02  8.31624496e-04  5.55958804e-02]
 [-1.73320817e-02 -3.32968458e-02 -8.41380336e-03]
 [-9.53005242e-02  3.69274531e-02  4.44869482e-02]
 [-1.08324989e-01 -6.11977863e-02 -7.14110354e-02]
 [ 2.44702730e+00  1.56185493e+00  1.72282136e-01]
 [ 4.45393311e-02 -1.17062586e-01  1.42855006e-02]
 [ 3.13480422e-02 -1.44618352e-02 -4.03684329e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.08336299]
curr_Stock_Price:  99.5235942104009
curr_Factors:  [99.52359421 -0.92145261 -1.01413812]
mat_Sqrt:  [[14.36513389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00062147 -0.03075982  0.42655168]
Stock Position:  -0.0006214673527465383
Bond Position:  [-1.02151232]


portfolio before change:  [-1.08263401]
curr_Stock_Price:  98.1451217928879
curr_Factors:  [98.14512179 -0.84911044 -0.96879358]
mat_Sqrt:  [[15.93540228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0114154  0.06808873 0.08202672]
Stock Position:  0.011415402975876246
Bond Position:  [-2.20300013]


portfolio before change:  [-1.07073474]
curr_Stock_Price:  99.21163396175501
curr_Factors:  [99.21163396 -0.6524824  -0.96310496]
mat_Sqrt:  [[19.72068181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02036745 -0.0790155   0.11494963]
Stock Position:  -0.020367449746670454
Bond Position:  [0.94995323]


portfolio before change:  [-1.09156221]
curr_Stock_Price:  100.24005070926329
curr_Factors:  [100.24005071  -0.59652188  -0.96757013]
mat_Sqrt:  [[20.97803233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02706081 0.31731411 2.84548034]
Stock Position:  0.027060805269532327
Bond Position:  [-3.8041387]


portfolio before change:  [-1.0802304]
curr_Stock_Price:  100.67637762863559
curr_Factors:  [100.67637763  -0.82205626  -0.94895998]
mat_Sqrt:  [[17.13109006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00342337 -0.01106097 -0.05874131]
Stock Position:  -0.0034233665651453127
Bond Position:  [-0.73557826]


portfolio before change:  [-1.08090301]
curr_Stock_Price:  100.84599384487493
curr_Factors:  [100.84599384  -0.71892337  -0.95594703]
mat_Sqrt:  [[18.89172766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213009 -0.0072218   0.07303301]
Stock Position:  0.002130090783178577
Bond Position:  [-1.29571413]


portfolio before change:  [-1.07998403]
curr_Stock_Price:  101.35346097344782
curr_Factors:  [101.35346097  -0.24888792  -0.93624244]
mat_Sqrt:  [[30.98439419  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203569 -0.01423006 -0.14243906]
Stock Position:  -0.002035694259228233
Bond Position:  [-0.87365938]


portfolio before change:  [-1.07717401]
curr_Stock_Price:  99.91943333947219
curr_Factors:  [99.91943334 -0.29243533 -0.94711597]
mat_Sqrt:  [[28.92808415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121059  0.03944012  0.00395912]
Stock Position:  -0.001210588483329524
Bond Position:  [-0.95621269]


portfolio before change:  [-1.0757139]
curr_Stock_Price:  98.61457776358345
curr_Factors:  [98.61457776 -0.18149628 -0.92413004]
mat_Sqrt:  [[32.64177053  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00159278  0.0064198  -0.11330016]
Stock Position:  0.0015927813503462303
Bond Position:  [-1.23278536]


portfolio before change:  [-1.07751814]
curr_Stock_Price:  97.57857168680472
curr_Factors:  [97.57857169 -0.34492759 -0.900173  ]
mat_Sqrt:  [[28.09403646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.11122700e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  3.111226997783206e-05
Bond Position:  [-1.08055403]


portfolio before change:  [-1.07767294]
curr_Stock_Price:  96.94468145868707
curr_Factors:  [96.94468146 -0.55163447 -0.89599898]
mat_Sqrt:  [[22.79422164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04768187  0.53606893 -0.70290213]
Stock Position:  0.047681870881579755
Bond Position:  [-5.70017672]


portfolio before change:  [-1.14111552]
curr_Stock_Price:  95.62908676926608
curr_Factors:  [95.62908677 -0.48013672 -0.90019557]
mat_Sqrt:  [[24.05023433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148877 -0.02922172  0.7877352 ]
Stock Position:  0.0014887735867642224
Bond Position:  [-1.28348558]


portfolio before change:  [-1.14415212]
curr_Stock_Price:  93.69719405508688
curr_Factors:  [93.69719406 -0.35170336 -0.91140884]
mat_Sqrt:  [[26.49500012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03124945 -0.02943166 -3.74232215]
Stock Position:  -0.031249445928398067
Bond Position:  [1.78383328]


portfolio before change:  [-1.13338464]
curr_Stock_Price:  93.35976471146967
curr_Factors:  [93.35976471 -0.40437911 -0.9013909 ]
mat_Sqrt:  [[25.2971174   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07678365 -0.96130797  7.23071885]
Stock Position:  0.07678365362642674
Bond Position:  [-8.30188848]


portfolio before change:  [-1.16435158]
curr_Stock_Price:  92.9699794144056
curr_Factors:  [92.96997941 -0.47352591 -0.88962553]
mat_Sqrt:  [[23.78666664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023125  0.01953996 -0.08200565]
Stock Position:  -0.00023125319295482855
Bond Position:  [-1.14285198]


portfolio before change:  [-1.16454425]
curr_Stock_Price:  93.18534488978301
curr_Factors:  [93.18534489 -0.47726366 -0.89150252]
mat_Sqrt:  [[23.70827847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00225313  0.15102    -0.7150774 ]
Stock Position:  0.002253130150332361
Bond Position:  [-1.37450296]


portfolio before change:  [-1.16360884]
curr_Stock_Price:  93.67676797358033
curr_Factors:  [93.67676797 -0.43201228 -0.87465016]
mat_Sqrt:  [[25.36037152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125245 -0.05980065 -0.22432703]
Stock Position:  -0.0012524475900705385
Bond Position:  [-1.04628359]


portfolio before change:  [-1.16338115]
curr_Stock_Price:  93.39054271197054
curr_Factors:  [93.39054271 -0.4177545  -0.87624696]
mat_Sqrt:  [[25.60502488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0291126  -0.62967857 -0.54634997]
Stock Position:  -0.029112595849907167
Bond Position:  [1.55545998]


portfolio before change:  [-1.15178285]
curr_Stock_Price:  92.99882731475769
curr_Factors:  [92.99882731 -0.39719413 -0.85125731]
mat_Sqrt:  [[26.68590283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113944 -0.04261667  0.12649965]
Stock Position:  0.001139443949156269
Bond Position:  [-1.2577498]


portfolio before change:  [-1.15119918]
curr_Stock_Price:  93.64905443537188
curr_Factors:  [93.64905444 -0.3024857  -0.85520238]
mat_Sqrt:  [[29.42563568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0076521   0.09769464  0.30104844]
Stock Position:  -0.007652102249066813
Bond Position:  [-0.43458704]


portfolio before change:  [-1.15380451]
curr_Stock_Price:  93.98242732069356
curr_Factors:  [93.98242732 -0.36577165 -0.85960207]
mat_Sqrt:  [[27.59774589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00089138  0.04009736 -0.22169576]
Stock Position:  0.0008913800898190766
Bond Position:  [-1.23757858]


portfolio before change:  [-1.15381078]
curr_Stock_Price:  94.14895646914894
curr_Factors:  [94.14895647 -0.33363422 -0.8754756 ]
mat_Sqrt:  [[28.09996554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.001085   -0.01264108  0.02153926]
Stock Position:  0.0010850049309571496
Bond Position:  [-1.25596286]


portfolio before change:  [-1.15299183]
curr_Stock_Price:  95.04844733096536
curr_Factors:  [95.04844733 -0.59147027 -0.85311155]
mat_Sqrt:  [[22.4166709   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260417 -0.03409785 -0.29822495]
Stock Position:  -0.0026041663764091623
Bond Position:  [-0.90546986]


portfolio before change:  [-1.14667406]
curr_Stock_Price:  92.5789577170317
curr_Factors:  [92.57895772 -0.38641058 -0.87687285]
mat_Sqrt:  [[26.17431128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00930805  0.03125636  0.05311679]
Stock Position:  -0.00930805009889161
Bond Position:  [-0.28494448]


portfolio before change:  [-1.14776795]
curr_Stock_Price:  92.69265155512277
curr_Factors:  [92.69265156 -0.4882708  -0.88849777]
mat_Sqrt:  [[23.39496051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0051248  -0.00525109 -0.13428825]
Stock Position:  0.005124803586597782
Bond Position:  [-1.62279958]


portfolio before change:  [-1.14765031]
curr_Stock_Price:  92.75519010008523
curr_Factors:  [92.7551901  -0.28850466 -0.90037028]
mat_Sqrt:  [[28.24986623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128239 -0.01626319  0.6476016 ]
Stock Position:  0.0012823949002998456
Bond Position:  [-1.2665991]


portfolio before change:  [-1.15069672]
curr_Stock_Price:  90.50309529402854
curr_Factors:  [90.50309529 -0.37957985 -0.88618275]
mat_Sqrt:  [[25.52405784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00791168 -0.02705314 -0.14573448]
Stock Position:  -0.007911676689012742
Bond Position:  [-0.43466549]


portfolio before change:  [-1.1613671]
curr_Stock_Price:  91.84491419867008
curr_Factors:  [91.8449142  -0.35956127 -0.89796896]
mat_Sqrt:  [[26.11660231  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00556265  0.05926537  0.97779076]
Stock Position:  -0.0055626513276088325
Bond Position:  [-0.65046586]


portfolio before change:  [-1.15745829]
curr_Stock_Price:  91.1276091122095
curr_Factors:  [91.12760911 -0.160058   -0.87757583]
mat_Sqrt:  [[32.28578367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00972523 0.06403502 1.01998668]
Stock Position:  0.009725225744126275
Bond Position:  [-2.04369486]


portfolio before change:  [-1.15644586]
curr_Stock_Price:  91.25798259304462
curr_Factors:  [91.25798259 -0.129781   -0.87192357]
mat_Sqrt:  [[33.51475872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00480942  0.02985235 -0.51628418]
Stock Position:  -0.0048094237987016016
Bond Position:  [-0.71754755]


portfolio before change:  [-1.14963761]
curr_Stock_Price:  89.82372677348728
curr_Factors:  [ 8.98237268e+01  1.85522444e-02 -8.80109702e-01]
mat_Sqrt:  [[37.9508424   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00562196 0.01165534 0.2993428 ]
Stock Position:  0.005621962191132309
Bond Position:  [-1.65462321]


portfolio before change:  [-1.12176964]
curr_Stock_Price:  94.81750244602479
curr_Factors:  [94.81750245 -0.31907511 -0.89282394]
mat_Sqrt:  [[28.22067798  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00161237 -0.00067154 -0.19500353]
Stock Position:  0.00161236910712851
Bond Position:  [-1.27465045]


portfolio before change:  [-1.11831434]
curr_Stock_Price:  97.05932203251373
curr_Factors:  [97.05932203 -0.56451896 -0.88310678]
mat_Sqrt:  [[22.82135282  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193399  0.00026841  0.15859957]
Stock Position:  -0.0019339894343223761
Bond Position:  [-0.93060263]


portfolio before change:  [-1.11772049]
curr_Stock_Price:  96.69211474107577
curr_Factors:  [96.69211474 -0.73000411 -0.87248347]
mat_Sqrt:  [[19.47329969  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132727 -0.01074651 -0.02400224]
Stock Position:  -0.0013272651643598979
Bond Position:  [-0.98938442]


portfolio before change:  [-1.11791058]
curr_Stock_Price:  96.74214352750158
curr_Factors:  [96.74214353 -0.64957817 -0.88316078]
mat_Sqrt:  [[20.89082726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00376634  0.01191828  0.12690888]
Stock Position:  -0.0037663362089503725
Bond Position:  [-0.75354714]


portfolio before change:  [-1.11523932]
curr_Stock_Price:  96.00788749646402
curr_Factors:  [96.0078875  -1.04552377 -0.86367839]
mat_Sqrt:  [[14.22823245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00951584 -0.0197515  -0.20371581]
Stock Position:  -0.009515844750582154
Bond Position:  [-0.20164317]


portfolio before change:  [-1.12326092]
curr_Stock_Price:  96.84821167917323
curr_Factors:  [96.84821168 -1.10292873 -0.8285919 ]
mat_Sqrt:  [[14.03598376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.19955898 0.50408651 0.49147298]
Stock Position:  0.19955897584676327
Bond Position:  [-20.45019086]


portfolio before change:  [-1.13038295]
curr_Stock_Price:  96.82533323768399
curr_Factors:  [96.82533324 -1.21035897 -0.84432189]
mat_Sqrt:  [[12.40659035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00189899 -0.03778179  0.04075256]
Stock Position:  0.0018989944569175958
Bond Position:  [-1.31425373]


portfolio before change:  [-1.13010668]
curr_Stock_Price:  97.05733382056786
curr_Factors:  [97.05733382 -1.3044092  -0.85608518]
mat_Sqrt:  [[11.18761646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00180162 -0.00466754 -0.1151599 ]
Stock Position:  0.0018016224160663547
Bond Position:  [-1.30496735]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.12972993]
Stock Price:  97.35699651432427
PL:  [-1.12972993]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.19604936e-02 -5.00352687e-02  1.58372203e-01]
 [ 1.09569304e+00  2.30129588e-01  3.09902413e-01]
 [-2.26493517e-01 -1.22012211e-01  3.64031158e-02]
 [ 1.29197140e-01  9.24918351e-01  8.13890960e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.74714326e-02  2.17563689e-02  3.44620331e-03]
 [-3.21888650e-02 -1.19266517e-01  2.13006366e-03]
 [ 1.11455831e-01  1.13867325e-01 -9.09123272e-02]
 [ 2.91139614e-02  4.90272426e-02 -4.41430514e-02]
 [-4.49969657e-01  1.11520692e-01 -1.50288381e-01]
 [ 4.16675926e-01  8.48773952e-01 -1.35909319e-01]
 [ 3.84397429e-05  3.13812692e-02 -5.89712755e-02]
 [ 9.21601235e-02 -2.49187867e-02  4.83429380e-02]
 [ 1.46042103e+00 -2.78765584e+00  2.32949706e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.45709801e-01 -8.65495581e-02  2.32094973e-02]
 [-2.38298282e-01 -3.93022454e-01 -9.55669846e-04]
 [-2.63712262e-01 -1.73204653e+00 -2.03724301e-01]
 [ 1.30094623e-03  3.72499194e-02  5.83893053e-02]
 [ 5.95738406e-02  1.45332437e-02  1.68111369e-01]
 [ 2.21325979e-02  4.49835005e-02 -1.99987060e-02]
 [ 9.12268297e-02 -4.79032793e-02  3.08871074e-02]
 [ 7.70037044e-02 -6.55345335e-02 -4.52591712e-02]
 [-6.88268979e-02 -4.75755712e-02  7.70577810e-02]
 [ 3.16491829e-02 -9.76438436e-02  1.86586465e-02]
 [ 5.36693963e-02 -3.19731308e-03  2.26623478e-01]
 [ 1.14082806e-02 -1.06998669e-01  7.37502699e-03]
 [-8.74845479e-02  5.28725340e-02  1.40778295e-01]
 [ 2.04990351e-02 -4.58530116e-02  4.72266172e-02]
 [-4.03276663e-02  8.46046499e-02  1.79552545e-02]
 [-1.23929780e-02 -1.77358540e-02 -6.77388564e-02]
 [ 9.25632837e-04  2.18055855e-02 -5.96626903e-02]
 [-5.77881462e-02 -5.53960177e-02  1.45197592e-02]
 [ 3.89199773e-01  5.03241909e-02  7.86544350e-02]
 [ 4.70175845e-02  1.07184162e-01 -6.81011662e-02]
 [-3.09372907e-02  9.86590143e-03 -1.31359642e-02]
 [ 2.28781125e+00  1.60769186e+00  1.94444834e-01]
 [-1.19292797e-01  2.04245751e-02 -6.23610237e-03]
 [ 3.81594952e-02 -1.23817833e-02 -1.81935843e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.17402731]
curr_Stock_Price:  100.5139492984344
curr_Factors:  [100.5139493   -0.86876976  -1.0161567 ]
mat_Sqrt:  [[15.26206076  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00223264 -0.01614881  0.45179181]
Stock Position:  0.0022326393759931275
Bond Position:  [5.94961591]


portfolio before change:  [6.17438222]
curr_Stock_Price:  100.33978988639043
curr_Factors:  [100.33978989  -0.93636431  -1.01628324]
mat_Sqrt:  [[14.23800468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08469773 0.07427401 0.88406532]
Stock Position:  0.08469772556764539
Bond Position:  [-2.32416977]


portfolio before change:  [6.16703107]
curr_Stock_Price:  100.25642739487625
curr_Factors:  [100.25642739  -0.89398389  -1.00762414]
mat_Sqrt:  [[14.97112199  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01629593 -0.03937927  0.10384796]
Stock Position:  -0.016295932951099733
Bond Position:  [7.80080309]


portfolio before change:  [6.15877025]
curr_Stock_Price:  100.82319328970797
curr_Factors:  [100.82319329  -0.82092548  -1.02279034]
mat_Sqrt:  [[15.95309084  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0303471  0.29851611 2.32180437]
Stock Position:  0.03034710380284456
Bond Position:  [3.09907834]


portfolio before change:  [6.18843267]
curr_Stock_Price:  101.78786558623284
curr_Factors:  [101.78786559  -0.86591948  -1.05969752]
mat_Sqrt:  [[14.83922326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00395209 -0.01106097 -0.05874131]
Stock Position:  -0.003952093710683292
Bond Position:  [6.59070785]


portfolio before change:  [6.18807569]
curr_Stock_Price:  102.08666189121921
curr_Factors:  [102.08666189  -0.77267173  -1.04450561]
mat_Sqrt:  [[16.58742267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00437777 0.00702184 0.00983106]
Stock Position:  0.004377767877042463
Bond Position:  [5.74116398]


portfolio before change:  [6.19050584]
curr_Stock_Price:  102.47783363381147
curr_Factors:  [102.47783363  -0.54837532  -1.05462734]
mat_Sqrt:  [[20.62788621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00271958 -0.0384931   0.00607648]
Stock Position:  -0.002719582747210081
Bond Position:  [6.46920279]


portfolio before change:  [6.19135918]
curr_Stock_Price:  102.46141871684475
curr_Factors:  [102.46141872  -0.60864421  -1.07728137]
mat_Sqrt:  [[18.98332087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00611808  0.03675052 -0.25934756]
Stock Position:  0.006118081289210088
Bond Position:  [5.56449189]


portfolio before change:  [6.19557648]
curr_Stock_Price:  103.03703982289655
curr_Factors:  [103.03703982  -0.57775386  -1.07372734]
mat_Sqrt:  [[19.75896546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152391  0.01582347 -0.12592784]
Stock Position:  0.001523912920235947
Bond Position:  [6.03855701]


portfolio before change:  [6.19834979]
curr_Stock_Price:  104.36155354462996
curr_Factors:  [104.36155354  -0.79044887  -1.0549346 ]
mat_Sqrt:  [[16.4854451   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02777499  0.03599315 -0.42873092]
Stock Position:  -0.027774990307969757
Bond Position:  [9.09699093]


portfolio before change:  [6.17092976]
curr_Stock_Price:  105.38971707849204
curr_Factors:  [105.38971708  -0.68728103  -1.04338455]
mat_Sqrt:  [[18.67152222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03010943  0.27394061 -0.38771146]
Stock Position:  0.03010942565283899
Bond Position:  [2.99770591]


portfolio before change:  [6.1605412]
curr_Stock_Price:  105.03224464366957
curr_Factors:  [105.03224464  -0.70104036  -1.04434478]
mat_Sqrt:  [[18.33629179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030504  0.01012826 -0.16822863]
Stock Position:  -0.0003050424136947461
Bond Position:  [6.19258049]


portfolio before change:  [6.16126868]
curr_Stock_Price:  105.18514321028944
curr_Factors:  [105.18514321  -0.78606391  -1.04468438]
mat_Sqrt:  [[16.86050281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00574962 -0.0080425   0.13790895]
Stock Position:  0.005749624404705517
Bond Position:  [5.55649362]


portfolio before change:  [6.15544784]
curr_Stock_Price:  104.05194823436605
curr_Factors:  [104.05194823  -0.42401477  -1.04864337]
mat_Sqrt:  [[23.86068529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05728669 -0.89971205  6.64540671]
Stock Position:  0.05728669325688692
Bond Position:  [0.1946558]


portfolio before change:  [6.15943827]
curr_Stock_Price:  104.12118051525516
curr_Factors:  [104.12118052  -0.48865546  -1.05046464]
mat_Sqrt:  [[22.34126275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096993 -0.03053791  0.10625201]
Stock Position:  -0.0009699260569097568
Bond Position:  [6.26042811]


portfolio before change:  [6.16045704]
curr_Stock_Price:  103.8776862283321
curr_Factors:  [103.87768623  -0.70163231  -1.01455748]
mat_Sqrt:  [[18.67198607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00711122 -0.02793375  0.06621024]
Stock Position:  0.007111218113455712
Bond Position:  [5.42176016]


portfolio before change:  [6.16970109]
curr_Stock_Price:  105.08230193109704
curr_Factors:  [105.08230193  -0.58923856  -1.01418998]
mat_Sqrt:  [[21.1431364   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01507434 -0.12684745 -0.00272626]
Stock Position:  -0.015074335420022431
Bond Position:  [7.75374695]


portfolio before change:  [6.19875307]
curr_Stock_Price:  103.21935412321285
curr_Factors:  [103.21935412  -0.3859109   -0.97753585]
mat_Sqrt:  [[26.40120439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02495529 -0.55901561 -0.58116872]
Stock Position:  -0.024955294409628175
Bond Position:  [8.77462244]


portfolio before change:  [6.23237466]
curr_Stock_Price:  101.91603561942246
curr_Factors:  [101.91603562  -0.31457995  -0.98692614]
mat_Sqrt:  [[27.7335593   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00075083 0.01202236 0.16656844]
Stock Position:  0.0007508311859968133
Bond Position:  [6.15585292]


portfolio before change:  [6.23101748]
curr_Stock_Price:  99.0835681424991
curr_Factors:  [99.08356814 -0.14209811 -1.01078548]
mat_Sqrt:  [[31.28316294  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00309611 0.00469058 0.47957494]
Stock Position:  0.0030961068781409176
Bond Position:  [5.92424417]


portfolio before change:  [6.22349589]
curr_Stock_Price:  96.41500194882344
curr_Factors:  [96.41500195 -0.1613092  -0.99074958]
mat_Sqrt:  [[30.46574797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00089388  0.01451836 -0.05705074]
Stock Position:  0.0008938758952159574
Bond Position:  [6.13731285]


portfolio before change:  [6.22439368]
curr_Stock_Price:  96.5610816638286
curr_Factors:  [96.56108166 -0.32065956 -1.00261045]
mat_Sqrt:  [[25.71066195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00341311 -0.01546072  0.08811232]
Stock Position:  0.003413113919646561
Bond Position:  [5.89481971]


portfolio before change:  [6.22723184]
curr_Stock_Price:  97.17672350713055
curr_Factors:  [97.17672351 -0.63279111 -1.00334125]
mat_Sqrt:  [[18.92339246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00287412 -0.02115118 -0.12911182]
Stock Position:  0.002874116482583213
Bond Position:  [5.94793462]


portfolio before change:  [6.23095473]
curr_Stock_Price:  98.21333903102199
curr_Factors:  [98.21333903 -0.42119924 -0.99777515]
mat_Sqrt:  [[23.76390076  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264304 -0.01535495  0.2198244 ]
Stock Position:  -0.0026430369182635187
Bond Position:  [6.49053621]


portfolio before change:  [6.22945185]
curr_Stock_Price:  99.08894159088075
curr_Factors:  [99.08894159 -0.37275537 -1.02043511]
mat_Sqrt:  [[24.60199075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0006311  -0.03151442  0.05322793]
Stock Position:  0.0006311032809446924
Bond Position:  [6.16691649]


portfolio before change:  [6.23072724]
curr_Stock_Price:  99.88830153337526
curr_Factors:  [99.88830153 -0.2462164  -1.02541829]
mat_Sqrt:  [[28.00597539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00354482 -0.00103193  0.6464937 ]
Stock Position:  0.003544817485254503
Bond Position:  [5.87664144]


portfolio before change:  [6.23252547]
curr_Stock_Price:  100.18834591851905
curr_Factors:  [100.18834592  -0.35906639  -0.98481247]
mat_Sqrt:  [[26.13232405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034162 -0.03453367  0.0210389 ]
Stock Position:  -0.0003416194490593718
Bond Position:  [6.26675176]


portfolio before change:  [6.23319132]
curr_Stock_Price:  100.53242104502748
curr_Factors:  [100.53242105  -0.64565675  -0.97582956]
mat_Sqrt:  [[19.8656869   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.002414    0.01706454  0.40160129]
Stock Position:  -0.0024139984820322944
Bond Position:  [6.47587643]


portfolio before change:  [6.23731904]
curr_Stock_Price:  99.1578587840176
curr_Factors:  [99.15785878 -0.53400889 -0.97778215]
mat_Sqrt:  [[21.86576285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00095032 -0.014799    0.13472439]
Stock Position:  0.0009503176883460669
Bond Position:  [6.14308758]


portfolio before change:  [6.23828835]
curr_Stock_Price:  99.36976166545732
curr_Factors:  [99.36976167 -0.32534755 -0.96824032]
mat_Sqrt:  [[27.25562682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071151  0.02730603  0.05122134]
Stock Position:  -0.0007115122892606227
Bond Position:  [6.30899116]


portfolio before change:  [6.23841075]
curr_Stock_Price:  100.30618947832083
curr_Factors:  [100.30618948  -0.36639807  -0.97813205]
mat_Sqrt:  [[26.14602786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011413  -0.00572422 -0.1932401 ]
Stock Position:  -0.0011412987994660476
Bond Position:  [6.35289008]


portfolio before change:  [6.23693732]
curr_Stock_Price:  102.29303829618269
curr_Factors:  [102.2930383   -0.68341568  -0.97732001]
mat_Sqrt:  [[19.43559021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034997  0.00703772 -0.17020105]
Stock Position:  -0.0003499722031980424
Bond Position:  [6.27273704]


portfolio before change:  [6.2374741]
curr_Stock_Price:  102.99982522122194
curr_Factors:  [102.99982522  -0.96887017  -1.0122157 ]
mat_Sqrt:  [[14.20567348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465532 -0.01787899  0.04142083]
Stock Position:  -0.004655321525654663
Bond Position:  [6.71697141]


portfolio before change:  [6.2363342]
curr_Stock_Price:  103.42505424961564
curr_Factors:  [103.42505425  -0.90487613  -1.00036241]
mat_Sqrt:  [[15.38831871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02700278 0.01624206 0.22437921]
Stock Position:  0.027002782625777724
Bond Position:  [3.44356994]


portfolio before change:  [6.2628598]
curr_Stock_Price:  104.39144066119572
curr_Factors:  [104.39144066  -0.70209876  -0.99956098]
mat_Sqrt:  [[19.03897022  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00288857  0.03459354 -0.19427367]
Stock Position:  0.002888568398851517
Bond Position:  [5.96131798]


portfolio before change:  [6.26404028]
curr_Stock_Price:  104.54212853966811
curr_Factors:  [104.54212854  -0.74924001  -1.00152909]
mat_Sqrt:  [[18.15273137  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174105  0.00318421 -0.03747325]
Stock Position:  -0.0017410487043464566
Bond Position:  [6.44605322]


portfolio before change:  [6.2632358]
curr_Stock_Price:  105.46702574612051
curr_Factors:  [105.46702575  -0.87494713  -1.01773887]
mat_Sqrt:  [[15.89035541  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.1671247  0.51888032 0.55469699]
Stock Position:  0.16712469909009184
Bond Position:  [-11.36290915]


portfolio before change:  [6.37889314]
curr_Stock_Price:  106.16756727640369
curr_Factors:  [106.16756728  -0.89995691  -0.99266664]
mat_Sqrt:  [[15.99690269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0072762   0.006592   -0.01778986]
Stock Position:  -0.007276195251832456
Bond Position:  [7.15138908]


portfolio before change:  [6.37728288]
curr_Stock_Price:  106.51173519018187
curr_Factors:  [106.51173519  -0.76507937  -0.99455821]
mat_Sqrt:  [[18.33143935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.21225298e-05 -3.99620338e-03 -5.19012319e-01]
Stock Position:  -8.212252975399323e-05
Bond Position:  [6.3860299]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.37795142]
Stock Price:  108.09194005193403
PL:  [-1.71398864]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 2.89232419e-02 -5.63930877e-02  9.24901753e-02]
 [ 1.54051789e+00  3.31877795e-01  5.03388232e-01]
 [ 1.29690584e-01  2.39773832e-01  4.29973334e-02]
 [ 5.92330241e-02  4.87578039e-01  3.84731380e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-9.39386274e-02  1.77484830e-02 -7.98328188e-02]
 [-4.16656214e-02 -5.86795402e-02 -3.80158419e-02]
 [ 2.71943759e-01 -6.03993254e-02 -2.74313493e-01]
 [ 3.88872948e-03  7.63250202e-02 -4.82902818e-02]
 [-5.12369621e-01  1.13457121e-01 -1.81901812e-01]
 [ 4.67506378e-01  9.32955829e-01 -1.56690334e-01]
 [-4.71359470e-05  2.13405823e-02 -5.83004826e-02]
 [ 1.25287057e-01 -4.00276554e-02  3.80027814e-02]
 [ 1.52931373e+00 -2.97470709e+00  2.56650541e+00]
 [-5.10090132e-03 -9.53881023e-02  3.92799647e-02]
 [ 1.34980519e-01 -8.90005850e-02  2.58601532e-02]
 [-1.57724489e-01 -2.17165535e-01 -2.85596075e-02]
 [-2.63095840e-01 -1.72007140e+00 -2.00666580e-01]
 [-1.26300809e-02  4.86329578e-02  2.13378252e-01]
 [ 2.93708857e-01 -2.83570864e-01  3.68255163e-01]
 [ 9.00485735e-02 -1.53665959e-01 -7.65105692e-02]
 [ 4.65921829e-02 -5.46798385e-02 -7.49858139e-02]
 [ 1.94205104e-01  2.47587873e-01  2.05707749e-01]
 [-1.32728977e-01  3.63746341e-02  9.76513316e-02]
 [-5.57634044e-02 -1.93328803e-01  7.58037236e-02]
 [ 8.24571118e-02 -1.95129502e-02 -5.13237201e-02]
 [ 5.55818183e-01 -5.98091763e-02  3.11048037e-01]
 [ 1.81111579e-02 -8.90055235e-02  7.80936965e-03]
 [-8.48143752e-03 -7.39466488e-02 -1.42169157e-03]
 [ 2.03594981e-01 -9.67254025e-02  6.51447554e-02]
 [-1.71914134e-02 -6.16407601e-02 -3.63856149e-02]
 [ 1.96889046e-02  2.19992118e-02 -6.25658691e-02]
 [-3.49122005e-02 -5.11310138e-02  3.11158043e-05]
 [ 4.75222312e-01  7.91618199e-02  1.21817367e-01]
 [-5.09696385e-02  3.74301897e-02 -1.89324340e-03]
 [-4.32097422e-02  6.92151967e-03 -3.04816666e-02]
 [ 2.22457957e+00  1.51824727e+00  1.82257732e-01]
 [-8.63948655e-02 -3.65553446e-02 -2.37470717e-02]
 [ 3.72854315e-02 -1.53897007e-02 -1.14415846e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.15800159]
curr_Stock_Price:  100.37530080426991
curr_Factors:  [100.3753008   -0.96624739  -1.0020682 ]
mat_Sqrt:  [[14.02162225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00258825 -0.01820079  0.26384873]
Stock Position:  0.0025882546551080853
Bond Position:  [4.89820475]


portfolio before change:  [5.16113782]
curr_Stock_Price:  101.35044098802439
curr_Factors:  [101.35044099  -0.98411708  -0.99444675]
mat_Sqrt:  [[14.01348942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.12209777 0.1071131  1.43602651]
Stock Position:  0.12209777318056188
Bond Position:  [-7.21352534]


portfolio before change:  [5.242051]
curr_Stock_Price:  102.0205181325712
curr_Factors:  [102.02051813  -0.89573677  -1.00646662]
mat_Sqrt:  [[15.22548336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01230903 0.07738667 0.12265942]
Stock Position:  0.012309034938909454
Bond Position:  [3.98627688]


portfolio before change:  [5.24715876]
curr_Stock_Price:  102.39499468790301
curr_Factors:  [102.39499469  -1.11138652  -1.00207534]
mat_Sqrt:  [[12.37125916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01918094 0.15736514 1.09753154]
Stock Position:  0.019180944756496766
Bond Position:  [3.28312602]


portfolio before change:  [5.25820903]
curr_Stock_Price:  102.94970423541768
curr_Factors:  [102.94970424  -1.21914562  -0.98857591]
mat_Sqrt:  [[11.31941087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00518101 -0.01106097 -0.05874131]
Stock Position:  -0.005181011770302654
Bond Position:  [5.79159266]


portfolio before change:  [5.25664545]
curr_Stock_Price:  103.39123415322152
curr_Factors:  [103.39123415  -1.22871084  -0.97578446]
mat_Sqrt:  [[11.40469235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00934804  0.0057283  -0.22774081]
Stock Position:  -0.009348041671449285
Bond Position:  [6.22315102]


portfolio before change:  [5.24606729]
curr_Stock_Price:  104.60604476517679
curr_Factors:  [104.60604477  -1.37353385  -0.99165001]
mat_Sqrt:  [[ 9.82585797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00624917 -0.01893874 -0.10844862]
Stock Position:  -0.006249172720955246
Bond Position:  [5.89976854]


portfolio before change:  [5.24811643]
curr_Stock_Price:  104.39615755158749
curr_Factors:  [104.39615755  -1.34683834  -0.94348272]
mat_Sqrt:  [[10.56843586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01926688 -0.0194938  -0.78254004]
Stock Position:  0.01926688053784407
Bond Position:  [3.23672814]


portfolio before change:  [5.26560551]
curr_Stock_Price:  105.28288441447054
curr_Factors:  [105.28288441  -1.35633126  -0.95517719]
mat_Sqrt:  [[10.4347587   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00092108  0.02463379 -0.13775873]
Stock Position:  0.0009210846920170354
Bond Position:  [5.16863106]


portfolio before change:  [5.26567146]
curr_Stock_Price:  104.65300986828125
curr_Factors:  [104.65300987  -1.03771338  -0.93350217]
mat_Sqrt:  [[14.57685014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.036108    0.03661813 -0.51891524]
Stock Position:  -0.03610799518396999
Bond Position:  [9.04448184]


portfolio before change:  [5.27608556]
curr_Stock_Price:  104.39590708240695
curr_Factors:  [104.39590708  -0.90163144  -0.97066613]
mat_Sqrt:  [[16.05295426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0389935   0.3011102  -0.44699391]
Stock Position:  0.0389935022967276
Bond Position:  [1.20532352]


portfolio before change:  [5.30007836]
curr_Stock_Price:  105.00734557440475
curr_Factors:  [105.00734557  -1.08874966  -0.98611391]
mat_Sqrt:  [[13.18614597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057572  0.00688764 -0.16631505]
Stock Position:  -0.0005757212169794654
Bond Position:  [5.36053332]


portfolio before change:  [5.30074226]
curr_Stock_Price:  105.01813304954621
curr_Factors:  [105.01813305  -1.30863351  -0.9933423 ]
mat_Sqrt:  [[10.50821376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01188344 -0.01291887  0.10841136]
Stock Position:  0.011883440316687735
Bond Position:  [4.05276554]


portfolio before change:  [5.30623473]
curr_Stock_Price:  105.4376956478954
curr_Factors:  [105.43769565  -1.22858974  -0.99663508]
mat_Sqrt:  [[11.39181825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12693232 -0.96008258  7.32152556]
Stock Position:  0.12693231919493758
Bond Position:  [-8.07721651]


portfolio before change:  [5.20543676]
curr_Stock_Price:  104.6515423643684
curr_Factors:  [104.65154236  -0.97819093  -0.99253948]
mat_Sqrt:  [[14.58371919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011351  -0.03078638  0.11205481]
Stock Position:  -0.00113509638461381
Bond Position:  [5.32422635]


portfolio before change:  [5.20703356]
curr_Stock_Price:  103.83114619180569
curr_Factors:  [103.83114619  -1.08716684  -0.99255656]
mat_Sqrt:  [[12.97523559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00940962 -0.02872482  0.07377182]
Stock Position:  0.009409619693020356
Bond Position:  [4.23002196]


portfolio before change:  [5.19865709]
curr_Stock_Price:  102.88474781131546
curr_Factors:  [102.88474781  -0.74945801  -0.97451233]
mat_Sqrt:  [[18.35017424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01132866 -0.07008988 -0.08147261]
Stock Position:  -0.011328662085025316
Bond Position:  [6.36420364]


portfolio before change:  [5.20235481]
curr_Stock_Price:  102.62857130206122
curr_Factors:  [102.6285713   -0.95238342  -0.96095953]
mat_Sqrt:  [[15.14655949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04325503 -0.55515066 -0.5724459 ]
Stock Position:  -0.043255026876868885
Bond Position:  [9.64155642]


portfolio before change:  [5.17358327]
curr_Stock_Price:  103.3215962032601
curr_Factors:  [103.3215962   -1.3401973   -0.95420565]
mat_Sqrt:  [[10.41704559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00392172 0.01569622 0.60870876]
Stock Position:  0.003921719734652051
Bond Position:  [4.76838492]


portfolio before change:  [5.17298]
curr_Stock_Price:  103.01577266352182
curr_Factors:  [103.01577266  -1.27834173  -0.95658437]
mat_Sqrt:  [[11.02269155  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02821407 -0.0915221   1.05052948]
Stock Position:  0.0282140678836877
Bond Position:  [2.26648599]


portfolio before change:  [5.1926253]
curr_Stock_Price:  103.70202505436112
curr_Factors:  [103.70202505  -1.43463671  -0.93554684]
mat_Sqrt:  [[ 9.69236142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00444309 -0.04959548 -0.21826336]
Stock Position:  0.004443085079041049
Bond Position:  [4.73186838]


portfolio before change:  [5.19456359]
curr_Stock_Price:  104.00514130224938
curr_Factors:  [104.0051413   -1.36022757  -0.94926261]
mat_Sqrt:  [[10.32894504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194834 -0.01764784 -0.21391365]
Stock Position:  0.0019483395836524305
Bond Position:  [4.99192626]


portfolio before change:  [5.1948035]
curr_Stock_Price:  103.80798783225607
curr_Factors:  [103.80798783  -1.20723977  -0.95176004]
mat_Sqrt:  [[11.98364873  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02392708 0.07990864 0.58682695]
Stock Position:  0.023927076926808465
Bond Position:  [2.71098179]


portfolio before change:  [5.17957007]
curr_Stock_Price:  103.15716363836593
curr_Factors:  [103.15716364  -1.2529646   -0.9674848 ]
mat_Sqrt:  [[11.19877373  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00940916  0.01173986  0.27857207]
Stock Position:  -0.009409158919784293
Bond Position:  [6.15019222]


portfolio before change:  [5.17591835]
curr_Stock_Price:  103.62697660305278
curr_Factors:  [103.6269766   -1.29306304  -1.00352492]
mat_Sqrt:  [[10.42503083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00765016 -0.0623966   0.21624692]
Stock Position:  -0.007650155864133238
Bond Position:  [5.96868087]


portfolio before change:  [5.17684068]
curr_Stock_Price:  103.60394408482327
curr_Factors:  [103.60394408  -1.22737503  -0.99236282]
mat_Sqrt:  [[11.25528215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0060414  -0.00629778 -0.14641229]
Stock Position:  0.006041397820353392
Bond Position:  [4.55092804]


portfolio before change:  [5.18002069]
curr_Stock_Price:  104.03614591911345
curr_Factors:  [104.03614592  -1.26808765  -0.9903124 ]
mat_Sqrt:  [[10.87360558  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05583264 -0.01930333  0.88733347]
Stock Position:  0.05583263956314265
Bond Position:  [-0.62859195]


portfolio before change:  [5.16265191]
curr_Stock_Price:  103.72646690409425
curr_Factors:  [103.7264669   -1.01827048  -0.95868247]
mat_Sqrt:  [[14.36513882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.000107   -0.02872641  0.02227796]
Stock Position:  0.00010699948027418278
Bond Position:  [5.15155323]


portfolio before change:  [5.16314662]
curr_Stock_Price:  102.3313832775807
curr_Factors:  [102.33138328  -1.31221287  -0.94311279]
mat_Sqrt:  [[10.72836052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00222457 -0.02386618 -0.00405569]
Stock Position:  -0.0022245650240078317
Bond Position:  [5.39078944]


portfolio before change:  [5.16295718]
curr_Stock_Price:  102.71947348608322
curr_Factors:  [102.71947349  -1.56515459  -0.94068977]
mat_Sqrt:  [[ 8.38259353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02351881 -0.03121799  0.18583985]
Stock Position:  0.02351880809691431
Bond Position:  [2.7471176]


portfolio before change:  [5.18357184]
curr_Stock_Price:  103.58139016811658
curr_Factors:  [103.58139017  -1.5485165   -0.94606331]
mat_Sqrt:  [[ 8.54868847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435166 -0.01989447 -0.10379803]
Stock Position:  -0.00435165739843813
Bond Position:  [5.63432257]


portfolio before change:  [5.18292826]
curr_Stock_Price:  103.89113961853649
curr_Factors:  [103.89113962  -1.47389133  -0.98573722]
mat_Sqrt:  [[ 8.87923197  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128483  0.00710022 -0.17848301]
Stock Position:  0.001284826260031808
Bond Position:  [5.04944619]


portfolio before change:  [5.18308643]
curr_Stock_Price:  103.52296464232843
curr_Factors:  [103.52296464  -1.12686524  -0.98872506]
mat_Sqrt:  [[12.48094608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.63297167e-03 -1.65024638e-02  8.87647286e-05]
Stock Position:  -0.003632971667158999
Bond Position:  [5.55918243]


portfolio before change:  [5.17879499]
curr_Stock_Price:  104.89550059719114
curr_Factors:  [104.8955006   -1.14183155  -1.02724921]
mat_Sqrt:  [[11.98773288  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04306461 0.02554937 0.34751104]
Stock Position:  0.04306460793440663
Bond Position:  [0.66151138]


portfolio before change:  [5.15624112]
curr_Stock_Price:  104.36985852087696
curr_Factors:  [104.36985852  -1.39788043  -0.9842526 ]
mat_Sqrt:  [[ 9.63890873  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00453534  0.01208054 -0.0054009 ]
Stock Position:  -0.0045353359978558315
Bond Position:  [5.62959349]


portfolio before change:  [5.15784363]
curr_Stock_Price:  104.17168732246694
curr_Factors:  [104.17168732  -1.38666221  -1.01325451]
mat_Sqrt:  [[ 9.45102929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508082  0.00223391 -0.08695571]
Stock Position:  -0.00508081560413667
Bond Position:  [5.68712077]


portfolio before change:  [5.15840211]
curr_Stock_Price:  104.20169274233783
curr_Factors:  [104.20169274  -1.67117123  -1.03002471]
mat_Sqrt:  [[ 6.99455812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.36767065 0.4900122  0.51993058]
Stock Position:  0.3676706459079963
Bond Position:  [-33.15350156]


portfolio before change:  [5.26840293]
curr_Stock_Price:  104.51214794815459
curr_Factors:  [104.51214795  -1.62957339  -1.0347698 ]
mat_Sqrt:  [[ 7.27875709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01356056 -0.01179819 -0.06774379]
Stock Position:  -0.013560563089756767
Bond Position:  [6.68564651]


portfolio before change:  [5.26824576]
curr_Stock_Price:  104.58537014940414
curr_Factors:  [104.58537015  -1.65293371  -1.03801479]
mat_Sqrt:  [[ 7.09262267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152116 -0.004967   -0.32639656]
Stock Position:  0.0015211559474746603
Bond Position:  [5.1091551]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.26900306]
Stock Price:  104.66335086893501
PL:  [0.60565219]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-2.71373549e-02 -7.65284098e-02  1.99307183e-01]
 [ 1.08182430e-01  2.10533212e-01  1.97885701e-02]
 [-5.89471986e-01 -4.72968702e-01  4.52263222e-02]
 [ 3.26598534e-01  1.71178030e+00  1.95628047e+00]
 [-4.85369742e-02 -2.84866395e-02 -1.17285267e-02]
 [-6.60214340e-02  5.12528566e-01 -2.58159159e-01]
 [-1.27201127e-01  1.05012627e-01  1.91523618e-01]
 [-1.96141919e-02  3.17890005e-02  3.80461657e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 7.24510272e-01  1.65867909e+00 -1.86155677e-01]
 [-2.54579464e-03 -1.62783837e-01  3.53228742e-01]
 [-5.22779319e-01 -8.47978028e-02 -1.27321049e+00]
 [ 2.10092747e+00 -3.08500848e+00  2.62737581e+00]
 [-1.31886534e-02  5.56378022e-02 -3.54847947e-02]
 [ 1.17800819e-02  4.67165123e-01 -2.53615977e-01]
 [ 1.65402928e-02 -2.31742289e-01 -1.40483598e-01]
 [-3.09239699e-01 -1.95997687e+00 -1.92403870e-01]
 [ 4.57727881e-02 -1.24251135e-01  4.85513240e-02]
 [-2.40147359e-01  3.23008688e-01  1.19250451e-01]
 [ 1.70042502e-02  1.02806362e-01 -6.21071947e-02]
 [ 7.07660119e-02 -4.45337300e-02  2.98672435e-02]
 [-2.37635758e-02 -1.03247000e-01 -1.01898011e-01]
 [-1.77788316e-01  3.17503516e-02  4.49593153e-02]
 [ 1.09284930e-01  6.24013369e-03 -3.87153484e-02]
 [ 3.12908794e-02 -4.49266285e-02  2.67967968e-01]
 [-1.83786673e-01 -1.14567650e-01 -7.24669544e-02]
 [-1.73752060e-01  1.24314912e-01  2.50473378e-01]
 [ 3.06099666e-02  1.94011821e-02  1.72805489e-01]
 [-1.16016854e-01  1.09452232e-01 -1.09518311e-02]
 [ 9.17936880e-02 -6.51759641e-03 -2.94123500e-02]
 [ 8.80102442e-02 -2.16545815e-03 -7.59966133e-02]
 [ 3.82700304e-02  5.63752437e-02  1.00267309e-01]
 [-3.11183032e-03 -3.79749658e-02 -9.05841933e-03]
 [-1.00990120e-01  7.09052875e-02  3.15642799e-02]
 [-1.11705808e-01 -6.35330683e-02 -7.45901134e-02]
 [ 1.84932811e+00  1.19531748e+00  1.50465107e-01]
 [-9.03668321e-03 -1.33010749e-02  5.08555079e-02]
 [ 3.11317530e-02 -1.48557855e-02 -3.93138165e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.67528567]
curr_Stock_Price:  99.30635789569351
curr_Factors:  [99.3063579  -0.86458161 -0.99574335]
mat_Sqrt:  [[15.4542591   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.34282902e-04 -2.46994380e-02  5.68567917e-01]
Stock Position:  -0.00013428290197335698
Bond Position:  [-2.66195052]


portfolio before change:  [-2.67548924]
curr_Stock_Price:  98.34429961883895
curr_Factors:  [98.34429962 -0.67589256 -1.0155811 ]
mat_Sqrt:  [[18.11972132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00856507 0.0679493  0.05645128]
Stock Position:  0.008565069216031142
Bond Position:  [-3.51781497]


portfolio before change:  [-2.6854172]
curr_Stock_Price:  97.23652107003741
curr_Factors:  [97.23652107 -0.35621377 -1.0233321 ]
mat_Sqrt:  [[24.47373506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0276535  -0.15264999  0.12901811]
Stock Position:  -0.027653504128395727
Bond Position:  [0.00351334]


portfolio before change:  [-2.67328743]
curr_Stock_Price:  96.7979028923728
curr_Factors:  [96.79790289 -0.31732387 -0.99610856]
mat_Sqrt:  [[26.02852095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04131385 0.55247472 5.58072367]
Stock Position:  0.0413138459531525
Bond Position:  [-6.67238108]


portfolio before change:  [-2.62247442]
curr_Stock_Price:  98.0480190681879
curr_Factors:  [98.04801907 -0.29039259 -0.99155172]
mat_Sqrt:  [[27.20805418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208563 -0.00919402 -0.03345822]
Stock Position:  -0.0020856273007391173
Bond Position:  [-2.41798279]


portfolio before change:  [-2.62171671]
curr_Stock_Price:  97.53978912277572
curr_Factors:  [97.53978912 -0.36977718 -0.96802978]
mat_Sqrt:  [[25.5964438   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.50799024e-04  1.65417883e-01 -7.36456222e-01]
Stock Position:  -0.0005507990239340639
Bond Position:  [-2.56799189]


portfolio before change:  [-2.62168247]
curr_Stock_Price:  96.89480864102354
curr_Factors:  [96.89480864 -0.55968822 -0.98104118]
mat_Sqrt:  [[20.75726985  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00321193  0.03389268  0.54636357]
Stock Position:  -0.003211931016924518
Bond Position:  [-2.31046303]


portfolio before change:  [-2.62145753]
curr_Stock_Price:  96.73485359304584
curr_Factors:  [96.73485359 -0.41191748 -0.97041825]
mat_Sqrt:  [[24.27963756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00022073  0.01025986  0.10853512]
Stock Position:  -0.00022072604352758903
Bond Position:  [-2.60010563]


portfolio before change:  [-2.62160185]
curr_Stock_Price:  95.91613185679853
curr_Factors:  [95.91613186 -0.32537788 -0.94827378]
mat_Sqrt:  [[26.83810005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193722  0.0064198  -0.11330016]
Stock Position:  0.0019372162427831899
Bond Position:  [-2.80741214]


portfolio before change:  [-2.62205754]
curr_Stock_Price:  95.86206486671759
curr_Factors:  [95.86206487 -0.20058179 -0.96015835]
mat_Sqrt:  [[30.02919861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.91073118e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  2.910731180290189e-05
Bond Position:  [-2.62484783]


portfolio before change:  [-2.62241657]
curr_Stock_Price:  94.8005401408541
curr_Factors:  [94.80054014 -0.09785554 -0.94038499]
mat_Sqrt:  [[33.56670233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03053883  0.53533637 -0.53105033]
Stock Position:  0.030538831143944612
Bond Position:  [-5.51751425]


portfolio before change:  [-2.61036132]
curr_Stock_Price:  95.21787706327171
curr_Factors:  [95.21787706 -0.28486751 -0.95616689]
mat_Sqrt:  [[27.52606314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00131979 -0.05253826  1.00766328]
Stock Position:  0.0013197894934396021
Bond Position:  [-2.73602887]


portfolio before change:  [-2.61220618]
curr_Stock_Price:  94.07918106156784
curr_Factors:  [94.07918106 -0.40613797 -0.9693223 ]
mat_Sqrt:  [[23.7759962   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03364661 -0.02736837 -3.63211514]
Stock Position:  -0.033646607060309676
Bond Position:  [0.55323906]


portfolio before change:  [-2.59730154]
curr_Stock_Price:  93.6382603809634
curr_Factors:  [93.63826038 -0.62938825 -0.98239016]
mat_Sqrt:  [[18.68387124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10744634 -0.99568221  7.49517186]
Stock Position:  0.10744634055798628
Bond Position:  [-12.65838995]


portfolio before change:  [-2.62731033]
curr_Stock_Price:  93.37369674866108
curr_Factors:  [93.37369675 -0.64226317 -0.99995146]
mat_Sqrt:  [[18.0725652   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050214  0.01795702 -0.10122824]
Stock Position:  -0.0005021388950132112
Bond Position:  [-2.58042376]


portfolio before change:  [-2.62748426]
curr_Stock_Price:  93.07767336377015
curr_Factors:  [93.07767336 -0.423578   -0.99364713]
mat_Sqrt:  [[22.56069441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024543   0.15077689 -0.72349579]
Stock Position:  0.002454295845275842
Bond Position:  [-2.8559244]


portfolio before change:  [-2.62924673]
curr_Stock_Price:  92.5050191371806
curr_Factors:  [92.50501914 -0.4994032  -0.98456524]
mat_Sqrt:  [[20.97422838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283395 -0.0747945  -0.4007606 ]
Stock Position:  -0.002833953995506877
Bond Position:  [-2.36709176]


portfolio before change:  [-2.63213966]
curr_Stock_Price:  93.42141337578133
curr_Factors:  [93.42141338 -0.43643636 -0.95141465]
mat_Sqrt:  [[23.31902557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03210222 -0.63257981 -0.54887469]
Stock Position:  -0.03210222381544754
Bond Position:  [0.36689546]


portfolio before change:  [-2.63219515]
curr_Stock_Price:  93.42457072520185
curr_Factors:  [93.42457073 -0.37925073 -0.93110987]
mat_Sqrt:  [[25.19873475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120326 -0.04010188  0.13850341]
Stock Position:  0.0012032599687647055
Bond Position:  [-2.7446092]


portfolio before change:  [-2.63120531]
curr_Stock_Price:  94.53234447546892
curr_Factors:  [94.53234448 -0.45418108 -0.94829113]
mat_Sqrt:  [[23.25382965  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00644503  0.10425061  0.34018834]
Stock Position:  -0.0064450282921858166
Bond Position:  [-2.02194167]


portfolio before change:  [-2.63195253]
curr_Stock_Price:  94.6090649754358
curr_Factors:  [94.60906498 -0.37653477 -0.94760029]
mat_Sqrt:  [[25.16912969  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00100567  0.03318061 -0.17717454]
Stock Position:  0.0010056737459548256
Bond Position:  [-2.72709839]


portfolio before change:  [-2.63218589]
curr_Stock_Price:  94.71600485037642
curr_Factors:  [94.71600485 -0.4511139  -0.97669991]
mat_Sqrt:  [[22.71599233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00298346 -0.0143732   0.08520293]
Stock Position:  0.0029834588303986067
Bond Position:  [-2.9147672]


portfolio before change:  [-2.62983191]
curr_Stock_Price:  95.62714614763352
curr_Factors:  [95.62714615 -0.58089826 -0.9894651 ]
mat_Sqrt:  [[19.88753951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330049 -0.03332283 -0.29068666]
Stock Position:  -0.00330049002204839
Bond Position:  [-2.31421547]


portfolio before change:  [-2.62988602]
curr_Stock_Price:  95.55588762408318
curr_Factors:  [95.55588762 -0.52849681 -1.00248022]
mat_Sqrt:  [[20.67105168  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00784334  0.01024738  0.12825641]
Stock Position:  -0.007843336814360882
Bond Position:  [-1.88040901]


portfolio before change:  [-2.62514452]
curr_Stock_Price:  94.92139252021818
curr_Factors:  [94.92139252 -0.43739693 -0.97958536]
mat_Sqrt:  [[23.01317351  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00446075  0.00201399 -0.11044411]
Stock Position:  0.00446074744308706
Bond Position:  [-3.04856488]


portfolio before change:  [-2.62842399]
curr_Stock_Price:  94.27164339541734
curr_Factors:  [94.2716434  -0.16679519 -0.98385133]
mat_Sqrt:  [[29.83057632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00257518 -0.01450001  0.76443803]
Stock Position:  0.002575176603768519
Bond Position:  [-2.87119012]


portfolio before change:  [-2.63091815]
curr_Stock_Price:  93.44247900994984
curr_Factors:  [93.44247901 -0.23586865 -0.97640492]
mat_Sqrt:  [[27.80101355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00798406 -0.03697655 -0.20672805]
Stock Position:  -0.00798405969233977
Bond Position:  [-1.88486782]


portfolio before change:  [-2.65249509]
curr_Stock_Price:  96.11546916560323
curr_Factors:  [96.11546917 -0.42699504 -0.97944448]
mat_Sqrt:  [[23.54964522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00412952  0.04012247  0.71453083]
Stock Position:  -0.004129519556376433
Bond Position:  [-2.25558438]


portfolio before change:  [-2.65549855]
curr_Stock_Price:  96.77450317143197
curr_Factors:  [96.77450317 -0.33284237 -0.9613545 ]
mat_Sqrt:  [[26.52762632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00263288 0.0062617  0.49296596]
Stock Position:  0.0026328774430326592
Bond Position:  [-2.91029395]


portfolio before change:  [-2.65546313]
curr_Stock_Price:  96.92613419614283
curr_Factors:  [96.9261342  -0.21669273 -0.9646465 ]
mat_Sqrt:  [[29.74348021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00322459  0.03532556 -0.03124253]
Stock Position:  -0.0032245905094656006
Bond Position:  [-2.34291604]


portfolio before change:  [-2.64853006]
curr_Stock_Price:  94.68524253176115
curr_Factors:  [94.68524253 -0.13471845 -0.94145394]
mat_Sqrt:  [[32.27799593  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00261663 -0.00210355 -0.08390525]
Stock Position:  0.002616628325375075
Bond Position:  [-2.89628614]


portfolio before change:  [-2.65143958]
curr_Stock_Price:  93.71167606990853
curr_Factors:  [93.71167607 -0.19098351 -0.94746554]
mat_Sqrt:  [[30.01729586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00240047 -0.0006989  -0.21679718]
Stock Position:  0.002400465334467569
Bond Position:  [-2.87639121]


portfolio before change:  [-2.64901223]
curr_Stock_Price:  94.87266758186242
curr_Factors:  [94.87266758 -0.26042799 -0.96142579]
mat_Sqrt:  [[27.95739851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00251256 0.01819503 0.28603472]
Stock Position:  0.0025125570062840773
Bond Position:  [-2.88738521]


portfolio before change:  [-2.64611572]
curr_Stock_Price:  96.16913831825998
curr_Factors:  [96.16913832 -0.40470099 -0.97525544]
mat_Sqrt:  [[24.19514663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052541 -0.01225637 -0.02584115]
Stock Position:  -0.0005254144580143313
Bond Position:  [-2.59558706]


portfolio before change:  [-2.64639965]
curr_Stock_Price:  96.09199804977031
curr_Factors:  [96.09199805 -0.20576261 -0.94422458]
mat_Sqrt:  [[30.42664962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263169  0.02288458  0.0900441 ]
Stock Position:  -0.0026316932152844865
Bond Position:  [-2.393515]


portfolio before change:  [-2.64645632]
curr_Stock_Price:  95.99983776088452
curr_Factors:  [95.99983776 -0.18272307 -0.93555695]
mat_Sqrt:  [[31.37672829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445872 -0.02050521 -0.21278483]
Stock Position:  -0.004458721218020259
Bond Position:  [-2.21841981]


portfolio before change:  [-2.64478058]
curr_Stock_Price:  95.56180567095642
curr_Factors:  [95.56180567 -0.2826654  -0.9585866 ]
mat_Sqrt:  [[27.61947722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07690351 0.38578706 0.42923507]
Stock Position:  0.07690351322649154
Bond Position:  [-9.99381917]


portfolio before change:  [-2.59343155]
curr_Stock_Price:  96.24575805266765
curr_Factors:  [96.24575805 -0.30017449 -1.00360198]
mat_Sqrt:  [[26.13115892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.24629106e-05 -4.29290345e-03  1.45076609e-01]
Stock Position:  -5.24629106037699e-05
Bond Position:  [-2.58838221]


portfolio before change:  [-2.59373028]
curr_Stock_Price:  95.77230152266138
curr_Factors:  [95.77230152 -0.60671357 -0.99359573]
mat_Sqrt:  [[19.33011451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103851 -0.00479468 -0.11215138]
Stock Position:  0.0010385054514682928
Bond Position:  [-2.69319033]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.59409904]
Stock Price:  95.74140080081656
PL:  [-2.59409904]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.76908286e-01  4.49887768e-02 -7.57975911e-02]
 [ 1.98298248e+00  4.71282768e-01  7.29737342e-01]
 [ 1.29690584e-01  2.39773832e-01  4.29973334e-02]
 [ 1.06311876e-01  9.43906785e-01  6.98787082e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-1.31600134e-01 -4.74266781e-02 -6.28428632e-02]
 [-3.40994909e-02 -1.06703023e-01 -8.08382664e-03]
 [ 1.17092090e-01  5.17169522e-02 -9.34855139e-02]
 [-1.33096940e-03  8.19735780e-02 -4.91484422e-02]
 [-2.28540138e-01 -1.04047883e-01 -9.71885416e-02]
 [ 7.34859670e-01  1.42120059e+00 -2.54535898e-01]
 [-2.38916310e-04  2.62197839e-02 -5.79795540e-02]
 [-2.51415916e-01  4.32546746e-04 -5.10689237e-01]
 [ 1.62714064e+00 -3.08374575e+00  2.58529830e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.38244005e-01 -3.47968011e-02 -1.27450700e-02]
 [-1.30161585e-01 -1.57852595e-01 -3.90585340e-02]
 [-2.64894101e-01 -1.73321426e+00 -2.01714927e-01]
 [ 2.92034328e-03  3.48380224e-02  4.89601229e-02]
 [ 1.72458947e-01 -2.17722675e-01  1.98478393e-01]
 [ 3.69711466e-02 -5.10266031e-02  1.06806048e-01]
 [ 1.07490636e-01 -5.07292209e-02  2.43182095e-02]
 [ 1.29795154e-01  4.70026148e-03  1.83296393e-02]
 [-6.61690870e-02 -4.95105066e-02  7.78407339e-02]
 [ 3.97220263e-02 -6.62635812e-02  8.35737496e-03]
 [ 4.40046954e-02 -3.42399114e-02  2.86887207e-01]
 [-1.06450528e-01 -1.18415752e-01 -3.87501117e-02]
 [-7.39545534e-02  4.86265620e-02  1.22044533e-01]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 5.13809856e-02  1.39259013e-02  9.20323610e-02]
 [-1.61583170e-02 -4.36213203e-02 -4.80679700e-02]
 [-2.38696904e-02  2.17470423e-02 -5.28876191e-02]
 [-1.08449963e-01 -3.11969195e-02  4.14475379e-02]
 [ 1.67725342e-01  6.73633311e-03  2.91270228e-02]
 [-1.74952383e-02 -2.49913827e-02  2.73452212e-02]
 [-1.07938445e-01 -4.95533016e-02 -9.37174322e-02]
 [ 2.34912089e+00  1.51271129e+00  1.70833083e-01]
 [-7.10341593e-03 -1.57060743e-01 -6.06193920e-02]
 [ 3.34724281e-02 -1.37766979e-02 -7.68799014e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.41607081]
curr_Stock_Price:  102.32097973523801
curr_Factors:  [102.32097974  -1.34937011  -1.01367896]
mat_Sqrt:  [[ 9.63175703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01771426  0.01452007 -0.21622943]
Stock Position:  0.01771426154864444
Bond Position:  [17.60353021]


portfolio before change:  [19.41467156]
curr_Stock_Price:  102.11776323637469
curr_Factors:  [102.11776324  -1.35875426  -1.01886664]
mat_Sqrt:  [[ 9.47356974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.23519536 0.15210586 2.08173752]
Stock Position:  0.23519536430444793
Bond Position:  [-4.60295297]


portfolio before change:  [19.3988526]
curr_Stock_Price:  102.05295093855864
curr_Factors:  [102.05295094  -1.50120063  -0.99605493]
mat_Sqrt:  [[ 8.40003806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02231073 0.07738667 0.12265942]
Stock Position:  0.022310733025899563
Bond Position:  [17.12197646]


portfolio before change:  [19.38556686]
curr_Stock_Price:  101.36152945303465
curr_Factors:  [101.36152945  -1.31259186  -1.00410891]
mat_Sqrt:  [[ 9.99407941  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0441887  0.30464461 1.99344504]
Stock Position:  0.044188698055749036
Bond Position:  [14.90653284]


portfolio before change:  [19.43546838]
curr_Stock_Price:  102.44864196062444
curr_Factors:  [102.44864196  -1.38501726  -1.01790152]
mat_Sqrt:  [[ 9.26684366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00632858 -0.01106097 -0.05874131]
Stock Position:  -0.006328584261972615
Bond Position:  [20.08382325]


portfolio before change:  [19.43549657]
curr_Stock_Price:  102.8409014487301
curr_Factors:  [102.84090145  -1.55516434  -0.98833597]
mat_Sqrt:  [[ 8.08235134  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01906732 -0.01530689 -0.1792732 ]
Stock Position:  -0.01906732381519092
Bond Position:  [21.39639734]


portfolio before change:  [19.4551135]
curr_Stock_Price:  101.95235430037363
curr_Factors:  [101.9523543   -1.43487489  -0.97248531]
mat_Sqrt:  [[ 9.18108496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00626617 -0.03443825 -0.02306091]
Stock Position:  -0.006266172108353124
Bond Position:  [20.0939645]


portfolio before change:  [19.45957761]
curr_Stock_Price:  101.64080747048983
curr_Factors:  [101.64080747  -1.51541961  -0.99090755]
mat_Sqrt:  [[ 8.29056351  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01309514  0.01669157 -0.26668815]
Stock Position:  0.013095143378683309
Bond Position:  [18.12857666]


portfolio before change:  [19.45812285]
curr_Stock_Price:  101.35665847528455
curr_Factors:  [101.35665848  -1.31857031  -1.00839975]
mat_Sqrt:  [[ 9.89149712  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00054283  0.02645686 -0.14020683]
Stock Position:  0.0005428332363093392
Bond Position:  [19.40310309]


portfolio before change:  [19.46066509]
curr_Stock_Price:  101.57164286319403
curr_Factors:  [101.57164286  -1.16142781  -0.99116262]
mat_Sqrt:  [[11.80087822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02284723 -0.03358131 -0.27725186]
Stock Position:  -0.02284722765294035
Bond Position:  [21.78129554]


portfolio before change:  [19.45854981]
curr_Stock_Price:  101.78340212632087
curr_Factors:  [101.78340213  -1.02724904  -1.00240484]
mat_Sqrt:  [[13.3724039   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07276209  0.45869052 -0.72612007]
Stock Position:  0.07276209357401603
Bond Position:  [12.05257638]


portfolio before change:  [19.47431543]
curr_Stock_Price:  101.97936880691586
curr_Factors:  [101.97936881  -1.1335106   -0.99661126]
mat_Sqrt:  [[12.11747546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055472  0.0084624  -0.16539953]
Stock Position:  -0.0005547238166052631
Bond Position:  [19.53088581]


portfolio before change:  [19.47734723]
curr_Stock_Price:  100.91524718094713
curr_Factors:  [100.91524718  -0.83328537  -0.96883696]
mat_Sqrt:  [[16.64581271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.13610253e-02  1.39603862e-04 -1.45685424e+00]
Stock Position:  -0.0213610253460087
Bond Position:  [21.63300039]


portfolio before change:  [19.472541]
curr_Stock_Price:  101.2668466192668
curr_Factors:  [101.26684662  -0.67620442  -0.93696758]
mat_Sqrt:  [[20.17788256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0755974  -0.99527466  7.37513644]
Stock Position:  0.07559740122223192
Bond Position:  [11.81703057]


portfolio before change:  [19.50623539]
curr_Stock_Price:  101.69301423825257
curr_Factors:  [101.69301424  -0.55482289  -0.94843993]
mat_Sqrt:  [[22.61686331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095811 -0.03053791  0.10625201]
Stock Position:  -0.0009581069037229703
Bond Position:  [19.60366817]


portfolio before change:  [19.50916622]
curr_Stock_Price:  101.19179889467576
curr_Factors:  [101.19179889  -0.35338324  -0.95446152]
mat_Sqrt:  [[27.36248609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00469766 -0.01123062 -0.03635814]
Stock Position:  0.00469765651008429
Bond Position:  [19.0338019]


portfolio before change:  [19.51564439]
curr_Stock_Price:  102.06431828847795
curr_Factors:  [102.06431829  -0.50296968  -0.91983115]
mat_Sqrt:  [[24.60137535  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00692465 -0.05094671 -0.11142313]
Stock Position:  -0.006924649461201927
Bond Position:  [20.22240401]


portfolio before change:  [19.51468328]
curr_Stock_Price:  102.56818006918922
curr_Factors:  [102.56818007  -0.52801695  -0.91740627]
mat_Sqrt:  [[24.16981465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02730099 -0.5593925  -0.57543654]
Stock Position:  -0.027300990010589127
Bond Position:  [22.31489614]


portfolio before change:  [19.55438517]
curr_Stock_Price:  101.21612838650104
curr_Factors:  [101.21612839  -0.38775128  -0.92851768]
mat_Sqrt:  [[27.1394708   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00073788 0.01124392 0.1396696 ]
Stock Position:  0.0007378761438215672
Bond Position:  [19.4797002]


portfolio before change:  [19.55699429]
curr_Stock_Price:  101.45195330030789
curr_Factors:  [101.4519533   -0.49666561  -0.93801996]
mat_Sqrt:  [[24.16486571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0069742  -0.07026969  0.56620361]
Stock Position:  0.006974204863145188
Bond Position:  [18.84944758]


portfolio before change:  [19.54790226]
curr_Stock_Price:  99.81042384176817
curr_Factors:  [99.81042384 -0.60849608 -0.91265539]
mat_Sqrt:  [[21.80460427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00221775 -0.01646877  0.30468793]
Stock Position:  0.0022177461930107333
Bond Position:  [19.32654807]


portfolio before change:  [19.54835041]
curr_Stock_Price:  98.92311846915769
curr_Factors:  [98.92311847 -0.59512959 -0.92736295]
mat_Sqrt:  [[21.58180116  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00473082 -0.01637279  0.06937308]
Stock Position:  0.004730815120196339
Bond Position:  [19.08036342]


portfolio before change:  [19.54981284]
curr_Stock_Price:  98.72806550783915
curr_Factors:  [98.72806551 -0.66012066 -0.9328777 ]
mat_Sqrt:  [[20.07290498  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00670038 0.001517   0.05228936]
Stock Position:  0.006700381072770653
Bond Position:  [18.88829718]


portfolio before change:  [19.54859134]
curr_Stock_Price:  98.19336599213884
curr_Factors:  [98.19336599 -0.6055006  -0.9326975 ]
mat_Sqrt:  [[21.08876755  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286343 -0.01597945  0.22205795]
Stock Position:  -0.0028634297107492522
Bond Position:  [19.82976114]


portfolio before change:  [19.54852359]
curr_Stock_Price:  99.08272498706182
curr_Factors:  [99.08272499 -0.72774308 -0.93794507]
mat_Sqrt:  [[18.73263069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148948 -0.02138648  0.02384126]
Stock Position:  0.0014894849477651764
Bond Position:  [19.40094137]


portfolio before change:  [19.5502915]
curr_Stock_Price:  98.64139094772648
curr_Factors:  [98.64139095 -0.42627807 -0.94125711]
mat_Sqrt:  [[25.12732188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00380367 -0.01105088  0.81840935]
Stock Position:  0.0038036727163899
Bond Position:  [19.17509194]


portfolio before change:  [19.55555652]
curr_Stock_Price:  99.39539331361983
curr_Factors:  [99.39539331 -0.27371542 -0.9446081 ]
mat_Sqrt:  [[29.39375522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00471297 -0.03821852 -0.11054328]
Stock Position:  -0.004712969620662912
Bond Position:  [20.02400399]


portfolio before change:  [19.54592111]
curr_Stock_Price:  101.97095917802561
curr_Factors:  [101.97095918  -0.40005472  -0.94159284]
mat_Sqrt:  [[26.65669934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146742  0.01569416  0.34815908]
Stock Position:  -0.001467415808669577
Bond Position:  [19.69555491]


portfolio before change:  [19.54902231]
curr_Stock_Price:  101.53543337776578
curr_Factors:  [101.53543338  -0.49855769  -0.92338716]
mat_Sqrt:  [[24.49485215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090219 -0.02321455 -0.0028026 ]
Stock Position:  -0.0009021908881392884
Bond Position:  [19.64062665]


portfolio before change:  [19.55066513]
curr_Stock_Price:  102.43591318183155
curr_Factors:  [102.43591318  -0.70632859  -0.91710433]
mat_Sqrt:  [[20.20246126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0036139  0.00449457 0.26254271]
Stock Position:  0.003613897554748943
Bond Position:  [19.18047224]


portfolio before change:  [19.552824]
curr_Stock_Price:  102.36982171376962
curr_Factors:  [102.36982171  -0.79478492  -0.91860479]
mat_Sqrt:  [[18.45254403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188995 -0.01407872 -0.13712454]
Stock Position:  -0.0018899461767959425
Bond Position:  [19.74629745]


portfolio before change:  [19.55694083]
curr_Stock_Price:  101.49762889614436
curr_Factors:  [101.4976289   -0.66306894  -0.93594152]
mat_Sqrt:  [[20.51230556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00147357  0.00701883 -0.15087366]
Stock Position:  -0.0014735658999448285
Bond Position:  [19.70650428]


portfolio before change:  [19.56134653]
curr_Stock_Price:  100.17957930576202
curr_Factors:  [100.17957931  -0.87316884  -0.94258366]
mat_Sqrt:  [[16.30076221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0065247  -0.01006876  0.11823829]
Stock Position:  -0.0065246988388211954
Bond Position:  [20.21498812]


portfolio before change:  [19.56202775]
curr_Stock_Price:  100.46247643180628
curr_Factors:  [100.46247643  -0.82368814  -0.92968588]
mat_Sqrt:  [[17.39895704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01006071 0.00217414 0.08309129]
Stock Position:  0.010060713294193894
Bond Position:  [18.55130357]


portfolio before change:  [19.5629293]
curr_Stock_Price:  100.32158168629597
curr_Factors:  [100.32158169  -0.73937884  -0.93696457]
mat_Sqrt:  [[18.76582562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090669 -0.00806593  0.0780083 ]
Stock Position:  -0.000906688749775871
Bond Position:  [19.65388975]


portfolio before change:  [19.56420881]
curr_Stock_Price:  101.62013923007528
curr_Factors:  [101.62013923  -1.03587672  -0.95112472]
mat_Sqrt:  [[13.93272368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00984613 -0.01599326 -0.26734975]
Stock Position:  -0.009846133752125839
Bond Position:  [20.56477429]


portfolio before change:  [19.57137456]
curr_Stock_Price:  101.15345910966292
curr_Factors:  [101.15345911  -1.23670458  -0.9365331 ]
mat_Sqrt:  [[11.5121278   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.23390749 0.48822547 0.48733923]
Stock Position:  0.23390749241218423
Bond Position:  [-4.08917741]


portfolio before change:  [19.50380283]
curr_Stock_Price:  100.86676222445942
curr_Factors:  [100.86676222  -1.21050104  -0.92722542]
mat_Sqrt:  [[11.89447483  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00433287 -0.05069114 -0.17293025]
Stock Position:  -0.004332867837050188
Bond Position:  [19.94084518]


portfolio before change:  [19.51048976]
curr_Stock_Price:  99.89877411219973
curr_Factors:  [99.89877411 -1.09100758 -0.92643748]
mat_Sqrt:  [[13.28602005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112654 -0.00444641 -0.21931696]
Stock Position:  0.001126539564505268
Bond Position:  [19.39794983]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.51252697]
Stock Price:  99.55463962262796
PL:  [19.51252697]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 3.62235811e-02 -7.14439264e-02 -3.57040356e-02]
 [ 1.36855145e+00  2.74846160e-01  4.19057717e-01]
 [ 1.03922585e-01  2.04525530e-01  3.79772417e-02]
 [ 8.26154806e-02  7.13341565e-01  5.42385102e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 7.16617405e-02  7.99681821e-02 -2.73801921e-02]
 [-3.52552743e-02 -9.96622914e-02 -1.08600117e-02]
 [ 2.94293120e-01 -4.31355416e-02 -3.02645258e-01]
 [ 3.20364040e-02  4.58646874e-02 -4.36625784e-02]
 [-4.91307745e-01  1.47712300e-01 -1.61348657e-01]
 [ 5.60122844e-01  1.10767129e+00 -1.89180686e-01]
 [-1.12021054e-04  2.35424222e-02 -5.82156984e-02]
 [-6.32291258e-02 -1.06860099e-02 -1.76146666e-01]
 [ 1.55430792e+00 -2.97469581e+00  2.49009642e+00]
 [ 1.03177529e-03 -9.27656061e-02  3.61062666e-02]
 [ 1.33162436e-01 -4.14554617e-02 -7.00253168e-03]
 [-8.52673364e-02 -6.02280983e-02 -5.48887648e-02]
 [-2.68522105e-01 -1.74993120e+00 -2.00290321e-01]
 [ 6.97287131e-04  3.43910773e-02  7.15323460e-02]
 [ 1.82368911e-01  5.55556805e-02  3.98210568e-01]
 [ 2.98685768e-02 -5.07533173e-02  4.29278696e-02]
 [ 1.06027661e-01 -5.00718887e-02  8.38883903e-03]
 [ 2.00133126e-02  1.10550713e-01  6.68778613e-02]
 [-1.65301164e-01  3.42706942e-02 -5.00955260e-04]
 [-2.41131006e-02 -1.63795900e-01  5.72028499e-02]
 [ 7.02316990e-02 -1.46600826e-02  2.86125788e-02]
 [ 3.62283044e-01 -6.16100300e-02  1.93537985e-01]
 [-7.12405667e-02  5.08055656e-02  1.19103997e-01]
 [-1.09417730e-02 -7.63316952e-02 -5.55175395e-03]
 [ 1.45139028e-02  4.27628547e-02  9.27979707e-02]
 [-1.88113274e-02 -5.92742495e-02 -3.71043494e-02]
 [ 7.35144663e-02  2.47972153e-02 -8.08039080e-02]
 [-1.18069121e-01 -3.87448071e-02  2.12500833e-02]
 [ 3.61202868e-01  3.34289985e-02  6.41316265e-02]
 [ 1.70200517e-02  1.18145629e-01 -6.54488200e-02]
 [-8.38114646e-02 -1.65231275e-02 -1.05498789e-01]
 [ 2.70218773e+00  1.89523115e+00  2.16087159e-01]
 [-1.12259561e-01  1.05378835e-02 -5.97489212e-04]
 [ 3.88999468e-02 -1.19473592e-02 -2.02330458e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.35992742]
curr_Stock_Price:  99.99347112744661
curr_Factors:  [99.99347113 -1.09957559 -0.98238267]
mat_Sqrt:  [[12.46776652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115114 -0.02305843 -0.10185368]
Stock Position:  0.0011511360070820343
Bond Position:  [2.24482134]


portfolio before change:  [2.36111801]
curr_Stock_Price:  100.78396758733517
curr_Factors:  [100.78396759  -1.12791431  -1.0123792 ]
mat_Sqrt:  [[11.85424204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.12739693 0.08870622 1.19545502]
Stock Position:  0.12739692553103768
Bond Position:  [-10.4784496]


portfolio before change:  [2.44985214]
curr_Stock_Price:  101.4907665752333
curr_Factors:  [101.49076658  -1.1205001   -1.0223852 ]
mat_Sqrt:  [[11.9064769   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0128857  0.06601033 0.1083385 ]
Stock Position:  0.012885697173627583
Bond Position:  [1.14207286]


portfolio before change:  [2.45441588]
curr_Stock_Price:  101.8338575135174
curr_Factors:  [101.83385751  -1.0184815   -1.00786875]
mat_Sqrt:  [[13.42330515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02525009 0.23023    1.54727373]
Stock Position:  0.025250086265896303
Bond Position:  [-0.11689781]


portfolio before change:  [2.46773801]
curr_Stock_Price:  102.36204352378954
curr_Factors:  [102.36204352  -0.96367939  -0.99798676]
mat_Sqrt:  [[14.39455244  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00407418 -0.01106097 -0.05874131]
Stock Position:  -0.004074180228045248
Bond Position:  [2.88477942]


portfolio before change:  [2.46566535]
curr_Stock_Price:  102.95928722149712
curr_Factors:  [102.95928722  -0.79459883  -1.0146424 ]
mat_Sqrt:  [[16.86250321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00488636  0.02580962 -0.07810807]
Stock Position:  0.004886357498798444
Bond Position:  [1.96256946]


portfolio before change:  [2.47131181]
curr_Stock_Price:  104.06463649769205
curr_Factors:  [104.0646365   -0.80165251  -1.01978104]
mat_Sqrt:  [[16.83699684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343384 -0.03216587 -0.03098059]
Stock Position:  -0.003433839508928843
Bond Position:  [2.82865308]


portfolio before change:  [2.46661733]
curr_Stock_Price:  105.5347377342646
curr_Factors:  [105.53473773  -0.72084982  -1.04138118]
mat_Sqrt:  [[18.11624714  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01234863 -0.01392194 -0.86336268]
Stock Position:  0.012348634261461466
Bond Position:  [1.16340745]


portfolio before change:  [2.45284056]
curr_Stock_Price:  104.40730953534302
curr_Factors:  [104.40730954  -0.60285609  -1.02194033]
mat_Sqrt:  [[20.56320395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00157981  0.01480276 -0.12455718]
Stock Position:  0.0015798076840300046
Bond Position:  [2.28789709]


portfolio before change:  [2.45400014]
curr_Stock_Price:  104.96026705951438
curr_Factors:  [104.96026706  -0.7715311   -1.01645153]
mat_Sqrt:  [[17.5595724   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.028138    0.04767394 -0.46028281]
Stock Position:  -0.028138000345080207
Bond Position:  [5.40737217]


portfolio before change:  [2.48634058]
curr_Stock_Price:  103.83493913638465
curr_Factors:  [103.83493914  -0.68493976  -0.9740111 ]
mat_Sqrt:  [[19.76379349  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0378272   0.35749937 -0.53967984]
Stock Position:  0.03782719919397024
Bond Position:  [-1.44144435]


portfolio before change:  [2.48583588]
curr_Stock_Price:  103.82636048654919
curr_Factors:  [103.82636049  -0.68136609  -0.98763533]
mat_Sqrt:  [[19.56453473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036749  0.00759828 -0.16607318]
Stock Position:  -0.00036748504495592166
Bond Position:  [2.52399051]


portfolio before change:  [2.48638919]
curr_Stock_Price:  103.17928981060162
curr_Factors:  [103.17928981  -0.7579222   -0.96459236]
mat_Sqrt:  [[18.42951755  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00550021 -0.00344889 -0.50249741]
Stock Position:  -0.005500208332322536
Bond Position:  [3.05389678]


portfolio before change:  [2.48863029]
curr_Stock_Price:  102.84124051365399
curr_Factors:  [102.84124051  -0.66873064  -0.95516532]
mat_Sqrt:  [[20.27301075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07178951 -0.96007895  7.10355197]
Stock Position:  0.07178950865239346
Bond Position:  [-4.89429184]


portfolio before change:  [2.32839941]
curr_Stock_Price:  100.61780902269227
curr_Factors:  [100.61780902  -0.85275826  -0.92729993]
mat_Sqrt:  [[16.96701357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00062084 -0.02993997  0.10300113]
Stock Position:  -0.0006208378331511668
Bond Position:  [2.39086675]


portfolio before change:  [2.32816442]
curr_Stock_Price:  101.4777247497574
curr_Factors:  [101.47772475  -0.58136538  -0.93439005]
mat_Sqrt:  [[22.28879039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00553063 -0.01337969 -0.01997627]
Stock Position:  0.005530627179031869
Bond Position:  [1.76692896]


portfolio before change:  [2.32480361]
curr_Stock_Price:  100.83011424587428
curr_Factors:  [100.83011425  -0.65297918  -0.9532182 ]
mat_Sqrt:  [[20.23147738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00537605 -0.01943854 -0.15658237]
Stock Position:  -0.0053760516677199294
Bond Position:  [2.86687151]


portfolio before change:  [2.32059012]
curr_Stock_Price:  101.68052812259718
curr_Factors:  [101.68052812  -0.79480724  -0.96554299]
mat_Sqrt:  [[17.48748686  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03811922 -0.56478787 -0.57137254]
Stock Position:  -0.03811922271041823
Bond Position:  [6.19657281]


portfolio before change:  [2.3633068]
curr_Stock_Price:  100.58024175929035
curr_Factors:  [100.58024176  -0.94590003  -0.95293533]
mat_Sqrt:  [[15.06117856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00148188 0.01109967 0.20406187]
Stock Position:  0.0014818770831959284
Bond Position:  [2.21425924]


portfolio before change:  [2.36342972]
curr_Stock_Price:  100.4763984983109
curr_Factors:  [100.4763985   -1.02376368  -0.94419901]
mat_Sqrt:  [[14.04069879  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01958546 0.01793052 1.13598391]
Stock Position:  0.019585461021628486
Bond Position:  [0.39555313]


portfolio before change:  [2.33473007]
curr_Stock_Price:  99.00851919656525
curr_Factors:  [99.0085192  -1.02174148 -0.92602574]
mat_Sqrt:  [[14.11783197  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00200252 -0.01638056  0.12246126]
Stock Position:  0.0020025180962334886
Bond Position:  [2.13646372]


portfolio before change:  [2.3369311]
curr_Stock_Price:  99.97428225848309
curr_Factors:  [99.97428226 -1.10848568 -0.97127016]
mat_Sqrt:  [[12.49285828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00780599 -0.01616063  0.02393102]
Stock Position:  0.00780599135225547
Bond Position:  [1.55653272]


portfolio before change:  [2.34242451]
curr_Stock_Price:  100.65309754373611
curr_Factors:  [100.65309754  -1.16535959  -0.96539684]
mat_Sqrt:  [[11.95229726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0047046  0.03568009 0.19078392]
Stock Position:  0.0047045992500287055
Bond Position:  [1.86889202]


portfolio before change:  [2.34511007]
curr_Stock_Price:  101.17427703296403
curr_Factors:  [101.17427703  -1.20065102  -0.94792683]
mat_Sqrt:  [[11.8019728   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01342216  0.01106082 -0.00142909]
Stock Position:  -0.013422158130922783
Bond Position:  [3.70308722]


portfolio before change:  [2.33274975]
curr_Stock_Price:  102.12965509662489
curr_Factors:  [102.1296551   -1.00185244  -0.93861777]
mat_Sqrt:  [[14.6695355   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00312698 -0.0528649   0.16318381]
Stock Position:  -0.0031269780661493467
Bond Position:  [2.65210695]


portfolio before change:  [2.3319248]
curr_Stock_Price:  102.49949859174221
curr_Factors:  [102.49949859  -0.79875808  -0.95246488]
mat_Sqrt:  [[17.78997238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00410792 -0.00473152  0.08162372]
Stock Position:  0.004107917586333379
Bond Position:  [1.9108653]


portfolio before change:  [2.33386459]
curr_Stock_Price:  102.91355868555608
curr_Factors:  [102.91355869  -0.82502393  -0.98254824]
mat_Sqrt:  [[16.8831694   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0230533  -0.01988455  0.55211   ]
Stock Position:  0.023053297396792547
Bond Position:  [-0.03863228]


portfolio before change:  [2.31837834]
curr_Stock_Price:  102.24200934233264
curr_Factors:  [102.24200934  -0.65148496  -0.9991964 ]
mat_Sqrt:  [[19.62219429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186309  0.01639743  0.33977055]
Stock Position:  -0.001863090431701977
Bond Position:  [2.50886445]


portfolio before change:  [2.31666975]
curr_Stock_Price:  103.32741771160386
curr_Factors:  [103.32741771  -0.64239702  -1.0057278 ]
mat_Sqrt:  [[19.88126719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139107 -0.02463595 -0.01583761]
Stock Position:  -0.0013910663637694885
Bond Position:  [2.46040505]


portfolio before change:  [2.31825894]
curr_Stock_Price:  102.4060990987983
curr_Factors:  [102.4060991   -0.42482007  -0.96850778]
mat_Sqrt:  [[25.42208844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00165939 0.01380165 0.26472678]
Stock Position:  0.001659389256353267
Bond Position:  [2.14832736]


portfolio before change:  [2.32013074]
curr_Stock_Price:  103.37226660560431
curr_Factors:  [103.37226661  -0.69775057  -0.9510694 ]
mat_Sqrt:  [[19.87607492  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193622 -0.01913068 -0.10584838]
Stock Position:  -0.0019362236597606824
Bond Position:  [2.52028257]


portfolio before change:  [2.31962446]
curr_Stock_Price:  103.79646154825053
curr_Factors:  [103.79646155  -0.67359861  -0.95391276]
mat_Sqrt:  [[20.38747018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00304511  0.00800327 -0.23051106]
Stock Position:  0.003045112876823964
Bond Position:  [2.00355252]


portfolio before change:  [2.31339749]
curr_Stock_Price:  101.66930425109581
curr_Factors:  [101.66930425  -0.42905182  -0.93673717]
mat_Sqrt:  [[25.94389806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468859 -0.01250483  0.06062057]
Stock Position:  -0.00468858673422482
Bond Position:  [2.79008284]


portfolio before change:  [2.30553957]
curr_Stock_Price:  103.41966075542821
curr_Factors:  [103.41966076  -0.56618487  -0.90870704]
mat_Sqrt:  [[23.66277589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0161062  0.01078916 0.18294968]
Stock Position:  0.016106197744734093
Bond Position:  [0.63984206]


portfolio before change:  [2.30382103]
curr_Stock_Price:  103.30799398756845
curr_Factors:  [103.30799399  -0.46490122  -0.91007525]
mat_Sqrt:  [[26.12096591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00106339  0.03813134 -0.18670727]
Stock Position:  0.0010633888092271692
Bond Position:  [2.19396446]


portfolio before change:  [2.30474809]
curr_Stock_Price:  103.92187674568098
curr_Factors:  [103.92187675  -0.23952576  -0.89959906]
mat_Sqrt:  [[33.26529319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00326824 -0.00533282 -0.30095868]
Stock Position:  -0.0032682436700165337
Bond Position:  [2.6443901]


portfolio before change:  [2.29725494]
curr_Stock_Price:  106.31573540229698
curr_Factors:  [106.3157354   -0.33022592  -0.90457738]
mat_Sqrt:  [[30.92639424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10131019 0.61168322 0.61643652]
Stock Position:  0.10131018668168773
Bond Position:  [-8.47361206]


portfolio before change:  [2.43206549]
curr_Stock_Price:  107.65686227925175
curr_Factors:  [107.65686228  -0.30083558  -0.90586833]
mat_Sqrt:  [[32.20897239  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00342235  0.00340109 -0.00170447]
Stock Position:  -0.0034223534072653898
Bond Position:  [2.80050532]


portfolio before change:  [2.43258609]
curr_Stock_Price:  107.60703888985009
curr_Factors:  [107.60703889  -0.370111    -0.90142099]
mat_Sqrt:  [[30.17319856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.60385035e-04 -3.85599361e-03 -5.77192480e-01]
Stock Position:  -0.00016038503475615813
Bond Position:  [2.44984465]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.43300014]
Stock Price:  106.93487863631198
PL:  [-4.50187849]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.22470576e-02 -9.68725335e-02  8.01772578e-03]
 [ 9.69752901e-01  2.18434980e-01  2.74905396e-01]
 [-3.16423186e-01 -2.04790614e-01  3.90262361e-02]
 [ 1.29939049e-01  1.10233852e+00  8.50072609e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 2.12675091e-02  2.67967387e-02  1.48750993e-02]
 [-7.73276186e-02  6.99297667e-02 -2.07104760e-02]
 [-5.90218448e-02  1.45026619e-01 -6.80528202e-03]
 [ 4.76600229e-02  2.89574067e-02 -4.10939302e-02]
 [-7.77933592e-02 -3.57126680e-02 -1.46302832e-04]
 [ 7.93413223e-01  1.54534361e+00 -2.71628917e-01]
 [-3.52716786e-04  1.37240738e-02 -1.19550425e-03]
 [-4.33270047e-01 -1.29020700e-02 -9.08620956e-01]
 [ 1.98004536e+00 -3.44532007e+00  2.91060978e+00]
 [ 3.48169642e-02 -9.94392086e-02  2.82678426e-02]
 [ 9.58620443e-02  7.77638330e-03 -1.89705673e-02]
 [-6.23439918e-02 -8.32127034e-03 -6.03974185e-02]
 [-2.69144588e-01 -1.74030270e+00 -1.95531691e-01]
 [-1.74588885e-02  6.10243163e-02  3.10221366e-01]
 [ 2.04608711e-01  1.35037209e-01  4.87567875e-01]
 [ 4.24733626e-02 -1.45005673e-01  2.05701713e-02]
 [ 1.01383592e-01 -4.97853032e-02  1.69597132e-02]
 [-2.05296069e-02  7.94473136e-02  2.45862637e-02]
 [-2.45237707e-02 -7.50940089e-02  5.34800578e-02]
 [ 4.08747462e-02 -4.78942650e-02  3.60638728e-03]
 [ 3.49009155e-02 -4.24500193e-02  2.73195845e-01]
 [ 8.69220392e-02 -1.09704401e-01  3.93324525e-02]
 [-1.00916465e-01  7.02319279e-02  1.36035463e-01]
 [ 1.98015108e-02 -4.65291909e-02  4.60557123e-02]
 [-1.89118712e-02  7.78103536e-02  2.52828143e-02]
 [ 3.90822436e-02 -1.42622952e-02 -7.76779960e-02]
 [-3.72549977e-02  1.17339174e-02 -4.61498598e-02]
 [-9.62669627e-02 -3.60538999e-02  3.69779605e-02]
 [-3.99080584e-03  3.87384322e-03  2.82752269e-03]
 [-1.00734394e-01  1.00763501e-01  2.61726810e-02]
 [-1.15120455e-01 -6.64398515e-02 -7.77328226e-02]
 [ 2.16770770e+00  1.39209873e+00  1.62385946e-01]
 [ 2.75733459e-02 -8.10153080e-02  6.27770172e-02]
 [ 3.25888407e-02 -1.41385134e-02 -6.12900803e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.30336162]
curr_Stock_Price:  99.8492904682513
curr_Factors:  [99.84929047 -1.04581278 -1.00548904]
mat_Sqrt:  [[12.83736595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045884 -0.03126548  0.02287234]
Stock Position:  -0.0004588444439780566
Bond Position:  [1.34917691]


portfolio before change:  [1.30354568]
curr_Stock_Price:  99.81572870368139
curr_Factors:  [99.8157287  -1.10715988 -1.00307242]
mat_Sqrt:  [[12.09864509  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08847731 0.07049959 0.78422858]
Stock Position:  0.08847731091479835
Bond Position:  [-7.52788158]


portfolio before change:  [1.26375988]
curr_Stock_Price:  99.3766924132207
curr_Factors:  [99.37669241 -1.12923671 -1.00075799]
mat_Sqrt:  [[11.80971988  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02965859 -0.06609589  0.11133099]
Stock Position:  -0.029658594932642224
Bond Position:  [4.21113295]


portfolio before change:  [1.22244491]
curr_Stock_Price:  100.78746062334167
curr_Factors:  [100.78746062  -1.15074274  -1.0186548 ]
mat_Sqrt:  [[11.51460708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0458959  0.35577823 2.42502054]
Stock Position:  0.04589590408976906
Bond Position:  [-3.40328672]


portfolio before change:  [1.19988827]
curr_Stock_Price:  100.30525645302986
curr_Factors:  [100.30525645  -1.29454241  -0.96844117]
mat_Sqrt:  [[10.43571987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00561974 -0.01106097 -0.05874131]
Stock Position:  -0.005619736988604877
Bond Position:  [1.76357743]


portfolio before change:  [1.20304633]
curr_Stock_Price:  99.78252709522383
curr_Factors:  [99.7825271  -1.02700191 -1.0028324 ]
mat_Sqrt:  [[13.10716175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00227156 0.00864861 0.04243452]
Stock Position:  0.0022715625219796227
Bond Position:  [0.97638409]


portfolio before change:  [1.201803]
curr_Stock_Price:  99.18144704258314
curr_Factors:  [99.18144704 -0.8947151  -0.973476  ]
mat_Sqrt:  [[15.31388398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00439345  0.02256974 -0.05908122]
Stock Position:  -0.00439344930549128
Bond Position:  [1.63755166]


portfolio before change:  [1.19928113]
curr_Stock_Price:  99.80204848525094
curr_Factors:  [99.80204849 -0.68238342 -0.98808678]
mat_Sqrt:  [[18.77861089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164057  0.04680714 -0.01941358]
Stock Position:  -0.001640565037577758
Bond Position:  [1.36301288]


portfolio before change:  [1.2001533]
curr_Stock_Price:  99.3742752719894
curr_Factors:  [99.37427527 -0.66553959 -0.96386894]
mat_Sqrt:  [[19.48187894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00231921  0.00934596 -0.11722954]
Stock Position:  0.0023192149795846816
Bond Position:  [0.96968299]


portfolio before change:  [1.19894813]
curr_Stock_Price:  98.80236273961171
curr_Factors:  [98.80236274 -0.85902639 -0.94026979]
mat_Sqrt:  [[16.34341955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00520779 -0.01152621 -0.00041736]
Stock Position:  -0.005207786580419738
Bond Position:  [1.71348975]


portfolio before change:  [1.19652388]
curr_Stock_Price:  99.30899858967564
curr_Factors:  [99.30899859 -1.22149762 -0.92452469]
mat_Sqrt:  [[11.61403032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09070143  0.4987575  -0.77488169]
Stock Position:  0.09070142891372515
Bond Position:  [-7.8109442]


portfolio before change:  [1.20608063]
curr_Stock_Price:  99.4251288708984
curr_Factors:  [99.42512887 -1.07020564 -0.91563539]
mat_Sqrt:  [[13.64760238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00016154  0.00442943 -0.00341044]
Stock Position:  0.00016154242405412166
Bond Position:  [1.19001926]


portfolio before change:  [1.2060466]
curr_Stock_Price:  98.29358769613192
curr_Factors:  [98.2935877  -1.36250898 -0.89344075]
mat_Sqrt:  [[10.29861133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06033582 -0.00416413 -2.59204268]
Stock Position:  -0.060335818789806754
Bond Position:  [7.1366707]


portfolio before change:  [1.17578119]
curr_Stock_Price:  98.80998994477353
curr_Factors:  [98.80998994 -1.44289059 -0.90481546]
mat_Sqrt:  [[ 9.44506758  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.19808202 -1.11197227  8.30315955]
Stock Position:  0.19808202201790873
Bond Position:  [-18.39670141]


portfolio before change:  [1.43727376]
curr_Stock_Price:  100.14172264201781
curr_Factors:  [100.14172264  -1.51542254  -0.92727853]
mat_Sqrt:  [[ 8.70489345  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00233078 -0.03209387  0.08064029]
Stock Position:  0.0023307775196895037
Bond Position:  [1.20386569]


portfolio before change:  [1.43756265]
curr_Stock_Price:  100.20110012011472
curr_Factors:  [100.20110012  -1.72113468  -0.9044932 ]
mat_Sqrt:  [[ 7.25398729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01290008  0.00250982 -0.05411775]
Stock Position:  0.012900083400571341
Bond Position:  [0.1449601]


portfolio before change:  [1.43474529]
curr_Stock_Price:  99.98129658915776
curr_Factors:  [99.98129659 -1.60074243 -0.91970968]
mat_Sqrt:  [[ 8.04081966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00949793 -0.00268568 -0.17229702]
Stock Position:  -0.009497929148308727
Bond Position:  [2.38436056]


portfolio before change:  [1.43004068]
curr_Stock_Price:  100.5080087797094
curr_Factors:  [100.50800878  -1.58825337  -0.93456651]
mat_Sqrt:  [[ 8.06406307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08237722 -0.56168028 -0.55779749]
Stock Position:  -0.08237722377517935
Bond Position:  [9.70961141]


portfolio before change:  [1.43215781]
curr_Stock_Price:  100.49704275478325
curr_Factors:  [100.49704275  -1.48903276  -0.94705191]
mat_Sqrt:  [[ 8.79377099  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00663212 0.01969551 0.88497521]
Stock Position:  0.006632117107842827
Bond Position:  [0.76564965]


portfolio before change:  [1.43136141]
curr_Stock_Price:  100.3625286506919
curr_Factors:  [100.36252865  -1.32258384  -0.9624114 ]
mat_Sqrt:  [[10.21435082  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03247367 0.04358307 1.39089544]
Stock Position:  0.03247366847826635
Bond Position:  [-1.82777808]


portfolio before change:  [1.41407895]
curr_Stock_Price:  99.83736569894096
curr_Factors:  [99.8373657  -1.27647792 -0.95165553]
mat_Sqrt:  [[10.75541195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158739 -0.04680038  0.05868097]
Stock Position:  0.0015873936079804573
Bond Position:  [1.25559776]


portfolio before change:  [1.41366278]
curr_Stock_Price:  99.47631363066874
curr_Factors:  [99.47631363 -1.24039682 -0.95410655]
mat_Sqrt:  [[11.08304195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00854306 -0.01606814  0.04838134]
Stock Position:  0.008543060412315185
Bond Position:  [0.56383062]


portfolio before change:  [1.41783331]
curr_Stock_Price:  99.9562404060263
curr_Factors:  [99.95624041 -1.28555695 -0.95453911]
mat_Sqrt:  [[10.64016972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [6.63671853e-05 2.56415102e-02 7.01377668e-02]
Stock Position:  6.636718526128694e-05
Bond Position:  [1.41119949]


portfolio before change:  [1.41797301]
curr_Stock_Price:  99.40319555461556
curr_Factors:  [99.40319555 -1.05093857 -0.95554135]
mat_Sqrt:  [[13.36586858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00216489 -0.02423649  0.15256372]
Stock Position:  -0.0021648948463863127
Bond Position:  [1.63317048]


portfolio before change:  [1.41861221]
curr_Stock_Price:  99.20224475115312
curr_Factors:  [99.20224475 -0.96109521 -0.95190168]
mat_Sqrt:  [[14.64594856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00217361 -0.01545781  0.01028802]
Stock Position:  0.002173605958149343
Bond Position:  [1.20298562]


portfolio before change:  [1.41879829]
curr_Stock_Price:  99.2186666821074
curr_Factors:  [99.21866668 -1.09876144 -0.94838118]
mat_Sqrt:  [[12.80945466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00640166 -0.01370068  0.7793517 ]
Stock Position:  0.006401655032294521
Bond Position:  [0.78363461]


portfolio before change:  [1.41922758]
curr_Stock_Price:  99.27042412610315
curr_Factors:  [99.27042413 -0.83402079 -0.93790301]
mat_Sqrt:  [[16.8765297   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00429931 -0.03540694  0.11220454]
Stock Position:  0.004299309550140918
Bond Position:  [0.9924333]


portfolio before change:  [1.41812229]
curr_Stock_Price:  98.98448212566551
curr_Factors:  [98.98448213 -0.8372772  -0.92082417]
mat_Sqrt:  [[17.06213568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344695  0.02266726  0.38807131]
Stock Position:  -0.0034469489139700832
Bond Position:  [1.75931674]


portfolio before change:  [1.41842289]
curr_Stock_Price:  98.96107862267638
curr_Factors:  [98.96107862 -0.83087084 -0.94539433]
mat_Sqrt:  [[16.75105866  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117634 -0.01501723  0.13138413]
Stock Position:  0.0011763353471435328
Bond Position:  [1.30201147]


portfolio before change:  [1.41940799]
curr_Stock_Price:  99.66015105389901
curr_Factors:  [99.66015105 -0.73835141 -0.92804248]
mat_Sqrt:  [[18.82850637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00011323 0.02511318 0.07212483]
Stock Position:  0.00011322903150903847
Bond Position:  [1.40812357]


portfolio before change:  [1.41945351]
curr_Stock_Price:  98.50754458831892
curr_Factors:  [98.50754459 -0.69690413 -0.90926774]
mat_Sqrt:  [[19.76596004  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00102778 -0.00460314 -0.2215937 ]
Stock Position:  0.0010277775625479849
Bond Position:  [1.31820967]


portfolio before change:  [1.41937263]
curr_Stock_Price:  98.26851673531611
curr_Factors:  [98.26851674 -0.66349101 -0.88038318]
mat_Sqrt:  [[20.98545361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00211004  0.00378711 -0.1316527 ]
Stock Position:  -0.0021100388552858875
Bond Position:  [1.62672302]


portfolio before change:  [1.41496674]
curr_Stock_Price:  100.4529506146051
curr_Factors:  [100.45295061  -0.37032389  -0.88936224]
mat_Sqrt:  [[28.50282885  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337084 -0.01163635  0.10548783]
Stock Position:  -0.0033708352302041942
Bond Position:  [1.75357709]


portfolio before change:  [1.42103942]
curr_Stock_Price:  98.71644766204413
curr_Factors:  [ 9.87164477e+01 -9.16427809e-03 -8.71780169e-01]
mat_Sqrt:  [[40.90724263  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.41181142e-05  1.25027752e-03  8.06613521e-03]
Stock Position:  -6.411811416125669e-05
Bond Position:  [1.42736893]


portfolio before change:  [1.42148515]
curr_Stock_Price:  94.54756249521895
curr_Factors:  [ 9.45475625e+01  9.18778577e-02 -8.45110717e-01]
mat_Sqrt:  [[44.51695622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168079  0.03252128  0.07466337]
Stock Position:  -0.0016807899971204476
Bond Position:  [1.58039975]


portfolio before change:  [1.41786683]
curr_Stock_Price:  96.81785491317414
curr_Factors:  [ 9.68178549e+01  1.71209354e-03 -8.71579639e-01]
mat_Sqrt:  [[40.56736328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035632  -0.02144337 -0.22175011]
Stock Position:  -0.003563198770552236
Bond Position:  [1.76284809]


portfolio before change:  [1.41959147]
curr_Stock_Price:  96.39568623128628
curr_Factors:  [ 9.63956862e+01 -9.03674998e-02 -8.80566580e-01]
mat_Sqrt:  [[36.50785242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06806797 0.44929793 0.4632419 ]
Stock Position:  0.06806797425375859
Bond Position:  [-5.14186762]


portfolio before change:  [1.30642576]
curr_Stock_Price:  94.74258960572399
curr_Factors:  [ 9.47425896e+01 -8.39627588e-02 -8.43592773e-01]
mat_Sqrt:  [[37.47252879  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063648 -0.02614758  0.17908536]
Stock Position:  0.0006364788065619111
Bond Position:  [1.24612411]


portfolio before change:  [1.30889509]
curr_Stock_Price:  98.37751165056929
curr_Factors:  [ 9.83775117e+01 -4.58043676e-02 -8.47100953e-01]
mat_Sqrt:  [[40.28208855  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00042679 -0.00456319 -0.17484354]
Stock Position:  0.000426791264106347
Bond Position:  [1.26690842]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.30862011]
Stock Price:  97.36215006006675
PL:  [1.30862011]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 8.88000535e-02 -3.93694145e-02 -1.15278275e-01]
 [ 1.09868463e+00  2.32047932e-01  3.20980559e-01]
 [-3.41057704e-01 -2.27466179e-01  3.97447899e-02]
 [ 1.82827974e-01  1.37308457e+00  1.16860384e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 1.72400081e-03  1.22795163e-01 -3.49964501e-02]
 [-9.56415574e-02  1.21174851e-01  1.45642068e-02]
 [-5.01745121e-02  9.54551400e-02  1.22399002e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-1.54815204e-02  2.98027919e-03  4.29238705e-02]
 [ 5.94428854e-01  1.27768437e+00 -1.74686724e-01]
 [-7.23243856e-04  3.65154458e-02  4.11740188e-02]
 [-5.01828783e-01 -4.82180924e-02 -1.17358601e+00]
 [ 2.17079334e+00 -3.52279726e+00  2.99029123e+00]
 [ 5.97937097e-03  1.56331835e-02 -7.41890775e-03]
 [ 1.92519079e-02  1.90994431e-01 -1.01004691e-01]
 [ 2.14645014e-02  7.84398557e-02 -1.48121227e-01]
 [-2.84881024e-01 -1.81981822e+00 -1.91883241e-01]
 [ 1.89683413e-02 -1.68226002e-01  4.27961097e-01]
 [ 1.31865513e-01  4.06168684e-01  4.40985105e-01]
 [ 2.74099264e-02 -1.45191405e-02  2.33330526e-02]
 [ 1.15994670e-01 -5.15975824e-02  3.64686463e-02]
 [-5.78258221e-02 -8.57212863e-02 -8.23557412e-02]
 [-2.36750224e-01  7.74708524e-02  5.96770212e-03]
 [ 7.87861462e-02  1.62916004e-02 -2.84286456e-02]
 [-7.90303644e-03 -5.18078248e-02  2.16379782e-01]
 [ 2.74664485e-02 -1.28145903e-01  2.94690227e-02]
 [ 4.13845201e-03 -1.26556823e-01 -3.37050129e-02]
 [ 6.52144874e-02 -7.41030792e-03  7.15798502e-02]
 [-1.19369955e-01  1.10524387e-01 -1.21292683e-02]
 [ 6.63703871e-02 -1.81998166e-02 -6.62275469e-02]
 [ 2.80738590e-02 -1.98487188e-03 -5.97190043e-02]
 [ 2.04447636e-02  5.61975759e-02  1.06028627e-01]
 [-6.90226808e-03 -4.00939316e-02  7.57558741e-03]
 [-8.52702091e-02  6.24048028e-02  5.10218303e-02]
 [-9.35530599e-02 -5.30813604e-02 -5.72609688e-02]
 [ 2.03532707e+00  1.30557222e+00  1.56511792e-01]
 [ 6.97889277e-02 -1.14315220e-01  5.91028640e-02]
 [ 2.94239348e-02 -1.53184461e-02 -1.06530360e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.32809681]
curr_Stock_Price:  100.2620506698461
curr_Factors:  [100.26205067  -1.16941615  -0.9565933 ]
mat_Sqrt:  [[11.96251267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00478434 -0.01270642 -0.32885683]
Stock Position:  0.004784339846172621
Bond Position:  [3.84840908]


portfolio before change:  [4.3272644]
curr_Stock_Price:  99.98751039905075
curr_Factors:  [99.9875104  -1.22320507 -0.9729825 ]
mat_Sqrt:  [[11.12125019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10894199 0.07489315 0.91566819]
Stock Position:  0.1089419870530569
Bond Position:  [-6.56557367]


portfolio before change:  [4.24287892]
curr_Stock_Price:  99.22045325348235
curr_Factors:  [99.22045325 -1.00171926 -0.98695248]
mat_Sqrt:  [[13.58100914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02793431 -0.07341439  0.11338082]
Stock Position:  -0.027934313848944105
Bond Position:  [7.0145342]


portfolio before change:  [4.23107376]
curr_Stock_Price:  99.67444793984312
curr_Factors:  [99.67444794 -1.07026578 -1.01670764]
mat_Sqrt:  [[12.36581654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05674093 0.44316114 3.33370149]
Stock Position:  0.056740931532900975
Bond Position:  [-1.42454727]


portfolio before change:  [4.21421367]
curr_Stock_Price:  99.38044491911323
curr_Factors:  [99.38044492 -1.12725862 -0.99692784]
mat_Sqrt:  [[11.87896165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00493696 -0.01106097 -0.05874131]
Stock Position:  -0.0049369635707275745
Bond Position:  [4.70485131]


portfolio before change:  [4.21659498]
curr_Stock_Price:  99.017232794387
curr_Factors:  [99.01723279 -1.12397027 -1.01769928]
mat_Sqrt:  [[11.63042325  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168918  0.03963197 -0.09983513]
Stock Position:  0.0016891765344678946
Bond Position:  [4.0493374]


portfolio before change:  [4.2172806]
curr_Stock_Price:  99.12344679037595
curr_Factors:  [99.12344679 -1.05931835 -1.02187981]
mat_Sqrt:  [[12.36868469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00549241  0.03910901  0.04154763]
Stock Position:  -0.0054924141117863035
Bond Position:  [4.76170761]


portfolio before change:  [4.22385696]
curr_Stock_Price:  98.03446919503342
curr_Factors:  [98.0344692  -0.85490161 -1.03657366]
mat_Sqrt:  [[14.78841162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190631  0.03080801  0.03491703]
Stock Position:  -0.001906313861999133
Bond Position:  [4.41074143]


portfolio before change:  [4.22532662]
curr_Stock_Price:  97.55276600177073
curr_Factors:  [97.552766   -1.25695712 -1.01651161]
mat_Sqrt:  [[10.04349024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00517661  0.0064198  -0.11330016]
Stock Position:  0.005176607143236648
Bond Position:  [3.72033427]


portfolio before change:  [4.22393567]
curr_Stock_Price:  97.19422666454952
curr_Factors:  [97.19422666 -1.44906394 -0.98121269]
mat_Sqrt:  [[ 8.55430516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071442  0.00096188  0.12244985]
Stock Position:  -0.0007144209858190196
Bond Position:  [4.29337327]


portfolio before change:  [4.22468352]
curr_Stock_Price:  96.89867535736565
curr_Factors:  [96.89867536 -1.42114071 -0.94833232]
mat_Sqrt:  [[ 9.06293319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09043179  0.41237086 -0.4983326 ]
Stock Position:  0.0904317937874224
Bond Position:  [-4.5380375]


portfolio before change:  [4.18063537]
curr_Stock_Price:  96.4178614148672
curr_Factors:  [96.41786141 -1.4364369  -0.93204097]
mat_Sqrt:  [[ 9.02694146  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00167665 0.01178531 0.11745802]
Stock Position:  0.0016766533563897005
Bond Position:  [4.01897604]


portfolio before change:  [4.18115695]
curr_Stock_Price:  96.42930268412239
curr_Factors:  [96.42930268 -1.62472668 -0.95440485]
mat_Sqrt:  [[ 7.31318292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10272251 -0.01556232 -3.34791422]
Stock Position:  -0.10272250931646498
Bond Position:  [14.0866169]


portfolio before change:  [4.11952812]
curr_Stock_Price:  97.04639985372548
curr_Factors:  [97.04639985 -1.61587704 -0.95820714]
mat_Sqrt:  [[ 7.39722573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.27876613 -1.13697793  8.53046855]
Stock Position:  0.27876613199906475
Bond Position:  [-22.93372139]


portfolio before change:  [4.12112533]
curr_Stock_Price:  97.06241363837376
curr_Factors:  [97.06241364 -1.66054706 -0.96599619]
mat_Sqrt:  [[ 7.0203352   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00109056  0.00504559 -0.02116408]
Stock Position:  0.0010905608871075046
Bond Position:  [4.01527285]


portfolio before change:  [4.12207132]
curr_Stock_Price:  97.46958825837228
curr_Factors:  [97.46958826 -1.65300439 -0.9798985 ]
mat_Sqrt:  [[ 7.00509342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00537052  0.06164319 -0.28813827]
Stock Position:  0.005370518896011462
Bond Position:  [3.59860905]


portfolio before change:  [4.12138879]
curr_Stock_Price:  97.25873685238041
curr_Factors:  [97.25873685 -1.79348663 -0.93593172]
mat_Sqrt:  [[ 6.34683631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114086  0.02531635 -0.42254863]
Stock Position:  0.001140859900412571
Bond Position:  [4.0104302]


portfolio before change:  [4.12180951]
curr_Stock_Price:  97.18807689113932
curr_Factors:  [97.18807689 -1.67095188 -0.96171605]
mat_Sqrt:  [[ 6.98650274  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09955165 -0.5873438  -0.54738948]
Stock Position:  -0.09955164847373392
Bond Position:  [13.79704278]


portfolio before change:  [4.12731583]
curr_Stock_Price:  97.15009074699144
curr_Factors:  [97.15009075 -1.44067012 -0.95943829]
mat_Sqrt:  [[ 8.81230197  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00816887 -0.05429471  1.22085389]
Stock Position:  0.008168869583705817
Bond Position:  [3.33370941]


portfolio before change:  [4.12987196]
curr_Stock_Price:  97.4119865831181
curr_Factors:  [97.41198658 -1.44593564 -0.98697254]
mat_Sqrt:  [[ 8.55093887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03564405 0.13109038 1.25800776]
Stock Position:  0.03564404563555578
Bond Position:  [0.65771467]


portfolio before change:  [4.12786671]
curr_Stock_Price:  97.35342224536544
curr_Factors:  [97.35342225 -1.58902229 -0.9716785 ]
mat_Sqrt:  [[ 7.52060883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00388387 -0.00468603  0.0665627 ]
Stock Position:  0.0038838688929773886
Bond Position:  [3.74975879]


portfolio before change:  [4.12925898]
curr_Stock_Price:  97.59120594053157
curr_Factors:  [97.59120594 -1.66120001 -0.98301658]
mat_Sqrt:  [[ 6.93492884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01628084 -0.01665305  0.1040349 ]
Stock Position:  0.016280843212474857
Bond Position:  [2.54039186]


portfolio before change:  [4.13000592]
curr_Stock_Price:  97.61757852947949
curr_Factors:  [97.61757853 -1.34448397 -0.96284796]
mat_Sqrt:  [[ 9.71553014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00948321 -0.02766643 -0.23493801]
Stock Position:  -0.009483208877692485
Bond Position:  [5.05573381]


portfolio before change:  [4.13583112]
curr_Stock_Price:  97.06995841527902
curr_Factors:  [97.06995842 -1.33557582 -0.93800883]
mat_Sqrt:  [[ 9.99262473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02198806  0.02500361  0.01702419]
Stock Position:  -0.021988056799830256
Bond Position:  [6.27021088]


portfolio before change:  [4.13115041]
curr_Stock_Price:  97.31848144820694
curr_Factors:  [97.31848145 -1.26477025 -0.92340267]
mat_Sqrt:  [[10.91148597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00699343  0.00525809 -0.08109901]
Stock Position:  0.006993427148612184
Bond Position:  [3.4505607]


portfolio before change:  [4.12746743]
curr_Stock_Price:  96.73016773855775
curr_Factors:  [96.73016774 -1.26596122 -0.90156853]
mat_Sqrt:  [[11.07173622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00232033 -0.0167209   0.61727129]
Stock Position:  0.002320329265379866
Bond Position:  [3.90302159]


portfolio before change:  [4.12862882]
curr_Stock_Price:  97.02042104616648
curr_Factors:  [97.02042105 -1.20436313 -0.9287503 ]
mat_Sqrt:  [[11.49380342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063722 -0.04135891  0.08406692]
Stock Position:  0.0006372228890589354
Bond Position:  [4.06680519]


portfolio before change:  [4.12918292]
curr_Stock_Price:  97.09216952058668
curr_Factors:  [97.09216952 -1.38393946 -0.91892929]
mat_Sqrt:  [[ 9.70646321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029439  -0.04084604 -0.09615102]
Stock Position:  -0.0029439001138176074
Bond Position:  [4.41501257]


portfolio before change:  [4.12845048]
curr_Stock_Price:  97.52844585624462
curr_Factors:  [97.52844586 -1.17308792 -0.91208344]
mat_Sqrt:  [[12.12140285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00646072 -0.00239167  0.20419739]
Stock Position:  0.006460724168534702
Bond Position:  [3.49834609]


portfolio before change:  [4.12564401]
curr_Stock_Price:  97.02636805783358
curr_Factors:  [97.02636806 -1.0082701  -0.89533613]
mat_Sqrt:  [[14.45986014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00686626  0.03567159 -0.03460143]
Stock Position:  -0.006866258359019732
Bond Position:  [4.79185212]


portfolio before change:  [4.1322158]
curr_Stock_Price:  96.15649534649442
curr_Factors:  [96.15649535 -1.10774529 -0.89844186]
mat_Sqrt:  [[12.93309957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0037993  -0.00587397 -0.18892876]
Stock Position:  0.0037992998785944063
Bond Position:  [3.76688844]


portfolio before change:  [4.12828633]
curr_Stock_Price:  94.99829040303635
curr_Factors:  [94.9982904  -0.90098517 -0.87999816]
mat_Sqrt:  [[16.00459027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00096714 -0.00064061 -0.1703617 ]
Stock Position:  0.0009671355367612393
Bond Position:  [4.0364101]


portfolio before change:  [4.12827123]
curr_Stock_Price:  94.46095667451789
curr_Factors:  [94.46095667 -0.81296413 -0.88605653]
mat_Sqrt:  [[17.27336862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00310067 0.01813769 0.30247016]
Stock Position:  0.003100671896122427
Bond Position:  [3.8353788]


portfolio before change:  [4.12540913]
curr_Stock_Price:  93.38326878765864
curr_Factors:  [93.38326879 -0.76346985 -0.88396867]
mat_Sqrt:  [[17.9802452   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075305 -0.01294026  0.02161104]
Stock Position:  -0.000753051315006307
Bond Position:  [4.19573152]


portfolio before change:  [4.12574829]
curr_Stock_Price:  93.62938965401585
curr_Factors:  [93.62938965 -0.92071033 -0.87580543]
mat_Sqrt:  [[15.53085297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00399959  0.02014106  0.14555108]
Stock Position:  -0.003999593241077319
Bond Position:  [4.50022776]


portfolio before change:  [4.12816517]
curr_Stock_Price:  93.16576155772296
curr_Factors:  [93.16576156 -1.00740836 -0.87907975]
mat_Sqrt:  [[14.12423587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00821826 -0.01713194 -0.16334961]
Stock Position:  -0.008218256521908513
Bond Position:  [4.8938253]


portfolio before change:  [4.1165467]
curr_Stock_Price:  94.65394104332017
curr_Factors:  [94.65394104 -0.81362702 -0.89947282]
mat_Sqrt:  [[17.06667393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.1367445  0.42137162 0.44648458]
Stock Position:  0.13674449583409512
Bond Position:  [-8.82685875]


portfolio before change:  [4.11635133]
curr_Stock_Price:  94.66058157738462
curr_Factors:  [94.66058158 -0.64200476 -0.90096834]
mat_Sqrt:  [[20.23319478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00289222 -0.03689508  0.16860402]
Stock Position:  0.002892215161339971
Bond Position:  [3.84257256]


portfolio before change:  [4.11357541]
curr_Stock_Price:  93.53470753217937
curr_Factors:  [93.53470753 -0.45276366 -0.91036318]
mat_Sqrt:  [[23.93174292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00100797 -0.00494401 -0.03039015]
Stock Position:  0.0010079720584723157
Bond Position:  [4.01929504]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.11095909]
Stock Price:  90.44060626714273
PL:  [4.11095909]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 4.85538487e-02 -3.35868086e-02 -6.80969983e-02]
 [ 1.09351696e+00  2.24519463e-01  3.17310974e-01]
 [-1.40165324e-01 -4.25488919e-02  3.38850455e-02]
 [ 1.54486874e-01  1.33917584e+00  1.01014437e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 5.56160099e-02 -5.93677335e-02  4.11983867e-02]
 [-6.03760077e-02  1.51285295e-02 -4.06708421e-02]
 [ 1.12288533e-01 -1.06827385e-02 -8.32397890e-02]
 [-9.71838149e-03  9.10501134e-02 -5.05274000e-02]
 [-3.60965784e-01 -4.28007579e-02 -1.48103148e-01]
 [ 7.01923351e-01  1.34984343e+00 -2.45305764e-01]
 [-2.27933158e-04  3.11516817e-02 -5.82229677e-02]
 [-2.22640326e-01 -1.42635495e-02 -4.94066088e-01]
 [ 1.77072854e+00 -3.41231983e+00  2.86557482e+00]
 [ 8.58420502e-03 -9.14924515e-02  3.53231467e-02]
 [ 1.24087268e-01 -3.35967423e-02 -1.09947815e-02]
 [-1.18629696e-01 -1.32437105e-01 -4.27010902e-02]
 [-2.66230444e-01 -1.73478968e+00 -1.99534986e-01]
 [-8.81317563e-03  3.95185536e-02  1.76766792e-01]
 [ 2.60266423e-01 -2.83710407e-01  3.13769811e-01]
 [ 5.27226187e-02  4.86779399e-02  3.39707379e-02]
 [ 1.25967794e-01 -5.56476596e-02 -4.11202702e-02]
 [ 1.56372421e-01  2.10973911e-01  1.77929877e-01]
 [-8.62611820e-02 -1.05621395e-02  8.22889621e-02]
 [-3.05576740e-02 -1.41213317e-01  5.43220442e-02]
 [ 5.02318907e-02 -1.25480269e-02  3.63052094e-02]
 [ 5.03736278e-01 -8.32273798e-02  2.59514033e-01]
 [ 1.48815448e-01 -3.15572863e-01 -2.07618134e-01]
 [-7.36930019e-03 -7.21864426e-02 -1.00441072e-03]
 [ 1.85292445e-01 -7.61100688e-02  3.90874899e-02]
 [-1.71899920e-02 -2.02815199e-02 -6.35455467e-02]
 [-6.79880591e-02  1.78762974e-02 -3.19920770e-02]
 [-3.53797664e-02 -2.39616846e-02 -2.01942502e-02]
 [ 2.96705763e-01  5.20632992e-02  7.66291611e-02]
 [-8.08327640e-02 -5.82161856e-02  7.90110747e-02]
 [-1.01117779e-01 -4.89881411e-02 -8.19839324e-02]
 [ 2.05012334e+00  1.33581686e+00  1.61179694e-01]
 [-7.87174101e-03 -1.57982775e-01 -6.07587525e-02]
 [ 3.50614946e-02 -1.42856113e-02 -9.00042907e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.16900521]
curr_Stock_Price:  99.83095597685826
curr_Factors:  [99.83095598 -1.23205448 -1.00927788]
mat_Sqrt:  [[10.61370355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00261904 -0.0108401  -0.19426178]
Stock Position:  0.0026190413497780255
Bond Position:  [0.9075438]


portfolio before change:  [1.16917457]
curr_Stock_Price:  99.85230388066222
curr_Factors:  [99.85230388 -1.34223999 -1.00323086]
mat_Sqrt:  [[ 9.56605878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.12587395 0.07246335 0.90519989]
Stock Position:  0.12587395289704248
Bond Position:  [-11.39962963]


portfolio before change:  [1.28038457]
curr_Stock_Price:  100.74712793623208
curr_Factors:  [100.74712794  -1.49491577  -0.9883078 ]
mat_Sqrt:  [[ 8.40973632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01687732 -0.0137326   0.0966646 ]
Stock Position:  -0.016877321623022527
Bond Position:  [2.98072625]


portfolio before change:  [1.28682318]
curr_Stock_Price:  100.38771047227878
curr_Factors:  [100.38771047  -1.75040651  -0.9847795 ]
mat_Sqrt:  [[ 6.51334914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09734467 0.43221714 2.88166073]
Stock Position:  0.09734467497510255
Bond Position:  [-8.48538586]


portfolio before change:  [1.28355702]
curr_Stock_Price:  100.36505464146148
curr_Factors:  [100.36505464  -1.7933124   -0.98350232]
mat_Sqrt:  [[ 6.24636298  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00938882 -0.01106097 -0.05874131]
Stock Position:  -0.0093888237284722
Bond Position:  [2.22586683]


portfolio before change:  [1.28064653]
curr_Stock_Price:  100.70468634374312
curr_Factors:  [100.70468634  -1.79890562  -0.99199296]
mat_Sqrt:  [[ 6.17984854  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00839943 -0.01916085  0.11752753]
Stock Position:  0.008399430370371904
Bond Position:  [0.43478453]


portfolio before change:  [1.28509646]
curr_Stock_Price:  101.22800549543102
curr_Factors:  [101.2280055   -1.90383817  -0.97511006]
mat_Sqrt:  [[ 5.68838976  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01153047  0.00488271 -0.11602259]
Stock Position:  -0.011530470508963542
Bond Position:  [2.45230299]


portfolio before change:  [1.28354747]
curr_Stock_Price:  101.38893120273222
curr_Factors:  [101.3889312   -1.71901851  -0.99612882]
mat_Sqrt:  [[ 6.7114605   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01387428 -0.00344784 -0.23745995]
Stock Position:  0.013874279312316109
Bond Position:  [-0.12315088]


portfolio before change:  [1.28954718]
curr_Stock_Price:  101.8224748231834
curr_Factors:  [101.82247482  -1.50633396  -1.02557317]
mat_Sqrt:  [[ 8.09562442  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0001787   0.0293863  -0.14414061]
Stock Position:  -0.0001787036030152146
Bond Position:  [1.30774322]


portfolio before change:  [1.28964665]
curr_Stock_Price:  102.18065117824625
curr_Factors:  [102.18065118  -1.34588206  -1.0312651 ]
mat_Sqrt:  [[ 9.4838958   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04216979 -0.01381389 -0.42249706]
Stock Position:  -0.0421697885782525
Bond Position:  [5.59858311]


portfolio before change:  [1.32286171]
curr_Stock_Price:  101.40959691112077
curr_Factors:  [101.40959691  -1.55988308  -1.02460926]
mat_Sqrt:  [[ 7.64976856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12123062  0.43566009 -0.69978907]
Stock Position:  0.12123061629895517
Bond Position:  [-10.97108622]


portfolio before change:  [1.36280789]
curr_Stock_Price:  101.75041553287086
curr_Factors:  [101.75041553  -1.65624386  -1.00867173]
mat_Sqrt:  [[ 7.08236099  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00081242  0.01005416 -0.16609392]
Stock Position:  -0.0008124178177310106
Bond Position:  [1.44547174]


portfolio before change:  [1.36296398]
curr_Stock_Price:  101.78070863523313
curr_Factors:  [101.78070864  -1.4554804   -0.99235028]
mat_Sqrt:  [[ 8.80209622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03708238 -0.00460354 -1.40943303]
Stock Position:  -0.03708238021289201
Bond Position:  [5.13723491]


portfolio before change:  [1.3878894]
curr_Stock_Price:  101.12586317527912
curr_Factors:  [101.12586318  -1.36419972  -0.98158204]
mat_Sqrt:  [[ 9.68505666  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.17130769 -1.10132149  8.17468735]
Stock Position:  0.17130768992934292
Bond Position:  [-15.93574861]


portfolio before change:  [1.33362738]
curr_Stock_Price:  100.82074011217796
curr_Factors:  [100.82074011  -1.14380022  -0.99838248]
mat_Sqrt:  [[11.83618523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024343 -0.02952906  0.10076711]
Stock Position:  -0.000243432005212426
Bond Position:  [1.35817038]


portfolio before change:  [1.33368056]
curr_Stock_Price:  101.29975072030567
curr_Factors:  [101.29975072  -1.20847668  -1.01538685]
mat_Sqrt:  [[10.95965086  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01049167 -0.0108433  -0.03136505]
Stock Position:  0.010491671925011686
Bond Position:  [0.27087681]


portfolio before change:  [1.33895086]
curr_Stock_Price:  101.79885495119325
curr_Factors:  [101.79885495  -0.89530277  -1.03483463]
mat_Sqrt:  [[14.77389035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01044949 -0.04274389 -0.12181432]
Stock Position:  -0.010449490736079729
Bond Position:  [2.40269705]


portfolio before change:  [1.33834698]
curr_Stock_Price:  101.88538881857386
curr_Factors:  [101.88538882  -1.1871273   -1.009838  ]
mat_Sqrt:  [[11.32353431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05838043 -0.55990096 -0.56921778]
Stock Position:  -0.05838043089553364
Bond Position:  [7.28645988]


portfolio before change:  [1.27338203]
curr_Stock_Price:  103.01377741224296
curr_Factors:  [103.01377741  -1.18058113  -1.00075122]
mat_Sqrt:  [[11.62933039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00303851 0.01275456 0.50426645]
Stock Position:  0.0030385142087666623
Bond Position:  [0.9603732]


portfolio before change:  [1.27241099]
curr_Stock_Price:  102.65468953286745
curr_Factors:  [102.65468953  -1.05557455  -1.01657474]
mat_Sqrt:  [[12.92575118  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0206102  -0.09156714  0.89509793]
Stock Position:  0.020610196643210572
Bond Position:  [-0.84332235]


portfolio before change:  [1.27365377]
curr_Stock_Price:  102.72010389290767
curr_Factors:  [102.72010389  -0.86567383  -1.0245934 ]
mat_Sqrt:  [[15.51396548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00448584 0.01571074 0.09690906]
Stock Position:  0.004485842740739002
Bond Position:  [0.81286754]


portfolio before change:  [1.27583243]
curr_Stock_Price:  103.18312602027456
curr_Factors:  [103.18312602  -1.1345289   -1.06699646]
mat_Sqrt:  [[11.41558999  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00930439 -0.0179602  -0.11730469]
Stock Position:  0.009304391861155848
Bond Position:  [0.31577619]


portfolio before change:  [1.27485733]
curr_Stock_Price:  103.07408352638242
curr_Factors:  [103.07408353  -1.21859353  -1.11143213]
mat_Sqrt:  [[10.02841257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02350891 0.06809154 0.50758441]
Stock Position:  0.023508912613041028
Bond Position:  [-1.14830229]


portfolio before change:  [1.27622219]
curr_Stock_Price:  103.138246698393
curr_Factors:  [103.1382467   -1.31116719  -1.06699577]
mat_Sqrt:  [[ 9.56305588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00748924 -0.00340892  0.2347475 ]
Stock Position:  -0.007489238431973381
Bond Position:  [2.04864911]


portfolio before change:  [1.28027923]
curr_Stock_Price:  102.63072551849206
curr_Factors:  [102.63072552  -1.39901621  -1.04700319]
mat_Sqrt:  [[ 8.89169733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00543139 -0.0455764   0.15496567]
Stock Position:  -0.005431390541888076
Bond Position:  [1.83770679]


portfolio before change:  [1.2799267]
curr_Stock_Price:  102.7379292687168
curr_Factors:  [102.73792927  -1.56105197  -1.04095675]
mat_Sqrt:  [[ 7.61540108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00723288 -0.00404986  0.10356866]
Stock Position:  0.0072328830266615305
Bond Position:  [0.53683527]


portfolio before change:  [1.27990464]
curr_Stock_Price:  102.72560192076557
curr_Factors:  [102.72560192  -1.32017373  -1.0354615 ]
mat_Sqrt:  [[ 9.74180238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05540254 -0.02686152  0.7403213 ]
Stock Position:  0.05540254449414551
Bond Position:  [-4.41135509]


portfolio before change:  [1.23117432]
curr_Stock_Price:  101.85598715907658
curr_Factors:  [101.85598716  -1.58352592  -1.01995156]
mat_Sqrt:  [[ 7.53894648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00557366 -0.1018507  -0.59227675]
Stock Position:  0.005573661197490292
Bond Position:  [0.66346355]


portfolio before change:  [1.23062679]
curr_Stock_Price:  101.74287112429828
curr_Factors:  [101.74287112  -1.91206384  -1.03678287]
mat_Sqrt:  [[ 5.331337    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418456 -0.02329807 -0.0028653 ]
Stock Position:  -0.0041845639412063755
Bond Position:  [1.65637634]


portfolio before change:  [1.23228028]
curr_Stock_Price:  101.39721209075363
curr_Factors:  [101.39721209  -1.81786826  -1.05012974]
mat_Sqrt:  [[ 5.76063431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03085342 -0.02456442  0.11150573]
Stock Position:  0.030853415307450147
Bond Position:  [-1.89617002]


portfolio before change:  [1.22784688]
curr_Stock_Price:  101.26120230911796
curr_Factors:  [101.26120231  -1.78627459  -1.062643  ]
mat_Sqrt:  [[ 5.86372896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00584971 -0.00654583 -0.18127776]
Stock Position:  -0.005849711084269785
Bond Position:  [1.82019565]


portfolio before change:  [1.22701224]
curr_Stock_Price:  101.44278012691781
curr_Factors:  [101.44278013  -1.9097142   -1.08243874]
mat_Sqrt:  [[ 5.09032642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01392237  0.00576955 -0.09126449]
Stock Position:  -0.013922374458737499
Bond Position:  [2.63933661]


portfolio before change:  [1.23124724]
curr_Stock_Price:  101.16229172573414
curr_Factors:  [101.16229173  -1.7409088   -1.07950164]
mat_Sqrt:  [[ 6.02739932  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00736521 -0.0077336  -0.05760857]
Stock Position:  -0.0073652095161571215
Bond Position:  [1.97632871]


portfolio before change:  [1.23203918]
curr_Stock_Price:  101.08831093259043
curr_Factors:  [101.08831093  -1.94445218  -1.07029061]
mat_Sqrt:  [[ 4.95923602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06512596 0.01680336 0.21860167]
Stock Position:  0.06512595894936202
Bond Position:  [-5.35143401]


portfolio before change:  [1.24993098]
curr_Stock_Price:  101.3733090263718
curr_Factors:  [101.37330903  -1.97649667  -1.06774656]
mat_Sqrt:  [[ 4.82864846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01586117 -0.01878919  0.2253966 ]
Stock Position:  -0.015861172273523814
Bond Position:  [2.8578305]


portfolio before change:  [1.24432933]
curr_Stock_Price:  101.74900002116628
curr_Factors:  [101.74900002  -1.98974987  -1.05274129]
mat_Sqrt:  [[ 4.85504242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02633393 -0.01581085 -0.23387734]
Stock Position:  -0.02633392871908206
Bond Position:  [3.92378025]


portfolio before change:  [1.24513688]
curr_Stock_Price:  101.73696073794889
curr_Factors:  [101.73696074  -1.72734102  -1.03988122]
mat_Sqrt:  [[ 6.3927749   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.36849358 0.43113304 0.4598008 ]
Stock Position:  0.3684935750315244
Bond Position:  [-36.2442795]


portfolio before change:  [1.29350778]
curr_Stock_Price:  101.88052286955283
curr_Factors:  [101.88052287  -1.8683347   -1.05524816]
mat_Sqrt:  [[ 5.47514039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00959284 -0.05098872 -0.17332781]
Stock Position:  -0.00959284412473775
Bond Position:  [2.27083176]


portfolio before change:  [1.2964455]
curr_Stock_Price:  101.60387483574134
curr_Factors:  [101.60387484  -1.70875056  -1.03474453]
mat_Sqrt:  [[ 6.5377076   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210676 -0.00461066 -0.25675719]
Stock Position:  0.00210676406813221
Bond Position:  [1.0823901]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.29633276]
Stock Price:  101.48613748275744
PL:  [-0.18980472]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-3.23460285e-02 -6.28350765e-02  2.35610959e-01]
 [ 8.74530078e-01  2.24425596e-01  2.40642880e-01]
 [ 4.90557048e-02  1.45615490e-01  3.53694124e-02]
 [ 4.52319041e-02  3.52506003e-01  2.90116640e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 7.67694510e-02 -8.05842120e-04  2.48488327e-02]
 [-3.63837728e-02 -9.20836541e-02 -1.78546469e-02]
 [ 9.65711303e-02  1.08111245e-01 -7.24298274e-02]
 [ 1.45213344e-02  6.48188233e-02 -4.65421963e-02]
 [-4.18213513e-01 -8.61729640e-03 -1.67931936e-01]
 [ 5.73108051e-01  1.11963968e+00 -1.96892150e-01]
 [-1.53914729e-04  1.49858968e-02 -5.77300821e-02]
 [ 6.38172290e-02 -2.95431722e-02 -2.74055076e-02]
 [ 1.52727499e+00 -2.92094738e+00  2.44837853e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.33015749e-01 -7.13684118e-02  1.46036166e-02]
 [-1.60397036e-01 -2.24293216e-01 -2.92627633e-02]
 [-2.68285055e-01 -1.74995180e+00 -2.00785404e-01]
 [ 5.81320454e-03  3.07956721e-02  3.14339275e-02]
 [ 8.78189589e-02  8.93243582e-02  2.21646732e-01]
 [ 2.59840287e-02  1.55806205e-03  1.16251108e-02]
 [ 1.12472594e-01 -5.12105606e-02  4.11610677e-02]
 [ 5.45436661e-03 -9.95905790e-02 -8.47615270e-02]
 [-1.56565197e-01  1.62995298e-02  5.12113406e-02]
 [ 1.06023133e-01  1.00723390e-02 -3.71856341e-02]
 [ 2.97711529e-02 -4.51934438e-02  2.65967659e-01]
 [-1.86839843e-01 -1.18870105e-01 -7.23731018e-02]
 [-2.19430402e-01  1.60256266e-01  3.04775148e-01]
 [ 8.14907281e-02  6.09055020e-02  2.01064553e-01]
 [-1.59284018e-01  1.23286920e-01 -2.61450419e-02]
 [ 6.12411644e-02 -1.65102237e-02 -8.21661335e-02]
 [-2.66613027e-02  9.26779689e-03 -4.82757007e-02]
 [-3.89493352e-02  1.38046508e-02  6.54274853e-02]
 [-3.37142769e-02 -2.73045285e-02 -7.35390227e-03]
 [-9.54431922e-02  2.11255848e-02  4.73320265e-02]
 [-1.20230238e-01 -7.04033639e-02 -8.30255934e-02]
 [ 2.10618447e+00  1.36254231e+00  1.61733694e-01]
 [-4.27436250e-02 -3.14386453e-02  3.25179139e-03]
 [ 3.29194274e-02 -1.41345872e-02 -6.74955820e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.62198437]
curr_Stock_Price:  100.30215503662583
curr_Factors:  [100.30215504  -0.50119061  -0.9847231 ]
mat_Sqrt:  [[22.69792408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.28721057e-04 -2.02799337e-02  6.72132484e-01]
Stock Position:  0.0001287210567744067
Bond Position:  [4.60907337]


portfolio before change:  [4.62254244]
curr_Stock_Price:  100.16154312602805
curr_Factors:  [100.16154313  -0.59316217  -0.97513458]
mat_Sqrt:  [[20.87364936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04644429 0.07243305 0.68648716]
Stock Position:  0.04644428802275086
Bond Position:  [-0.02938912]


portfolio before change:  [4.68086566]
curr_Stock_Price:  101.41738960938633
curr_Factors:  [101.41738961  -0.67819862  -0.95866642]
mat_Sqrt:  [[19.7347203   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00435776 0.0469972  0.10089909]
Stock Position:  0.004357755869035101
Bond Position:  [4.23891344]


portfolio before change:  [4.68732092]
curr_Stock_Price:  102.77711770935142
curr_Factors:  [102.77711771  -0.78134529  -0.94077188]
mat_Sqrt:  [[18.36497949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0096056  0.11377082 0.82762202]
Stock Position:  0.009605602983898436
Bond Position:  [3.70008473]


portfolio before change:  [4.69017113]
curr_Stock_Price:  103.02568772015744
curr_Factors:  [103.02568772  -0.93808722  -0.942626  ]
mat_Sqrt:  [[15.70949228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00373316 -0.01106097 -0.05874131]
Stock Position:  -0.003733156990846908
Bond Position:  [5.07478219]


portfolio before change:  [4.69232318]
curr_Stock_Price:  102.61915014634347
curr_Factors:  [102.61915015  -1.13003905  -0.95600398]
mat_Sqrt:  [[12.74299285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00640958 -0.00026008  0.0708868 ]
Stock Position:  0.006409577941842256
Bond Position:  [4.03457774]


portfolio before change:  [4.68793954]
curr_Stock_Price:  101.85654219574135
curr_Factors:  [101.8565422   -1.20961802  -0.94639966]
mat_Sqrt:  [[11.79349018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00498791 -0.02971987 -0.05093434]
Stock Position:  -0.004987907191768069
Bond Position:  [5.19599052]


portfolio before change:  [4.69056449]
curr_Stock_Price:  101.46050346201358
curr_Factors:  [101.46050346  -1.34227657  -0.94406513]
mat_Sqrt:  [[10.31220247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01007104  0.03489275 -0.20662214]
Stock Position:  0.010071036670937365
Bond Position:  [3.66875204]


portfolio before change:  [4.69824682]
curr_Stock_Price:  102.17777950360903
curr_Factors:  [102.1777795   -1.02045052  -0.96376273]
mat_Sqrt:  [[14.04829421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129923  0.02092019 -0.13277193]
Stock Position:  0.0012992349816993145
Bond Position:  [4.56549388]


portfolio before change:  [4.6996762]
curr_Stock_Price:  102.8386711087715
curr_Factors:  [102.83867111  -1.27660173  -0.97183305]
mat_Sqrt:  [[10.85609515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04184299 -0.00278122 -0.47906307]
Stock Position:  -0.04184298943050281
Bond Position:  [9.00275363]


portfolio before change:  [4.69416941]
curr_Stock_Price:  102.9971733224845
curr_Factors:  [102.99717332  -1.15887174  -0.95756361]
mat_Sqrt:  [[12.40706658  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06137334  0.36136215 -0.5616785 ]
Stock Position:  0.06137333879754907
Bond Position:  [-1.62711101]


portfolio before change:  [4.77128207]
curr_Stock_Price:  104.2569396128238
curr_Factors:  [104.25693961  -1.18086143  -0.94669192]
mat_Sqrt:  [[12.41996273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007149   0.00483668 -0.16468786]
Stock Position:  -0.000714900294289545
Bond Position:  [4.84581538]


portfolio before change:  [4.7717526]
curr_Stock_Price:  104.44610608310646
curr_Factors:  [104.44610608  -1.09691351  -0.96698064]
mat_Sqrt:  [[13.26033246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.003936   -0.00953502 -0.07818029]
Stock Position:  0.003935996971177898
Bond Position:  [4.36065304]


portfolio before change:  [4.77102787]
curr_Stock_Price:  104.12348433400965
curr_Factors:  [104.12348433  -0.79152465  -0.953064  ]
mat_Sqrt:  [[18.19212654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07865008 -0.94273171  6.98454246]
Stock Position:  0.07865008378045467
Bond Position:  [-3.41829289]


portfolio before change:  [4.73807955]
curr_Stock_Price:  103.70999453183462
curr_Factors:  [103.70999453  -0.61227117  -0.92926235]
mat_Sqrt:  [[22.19939354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00097612 -0.03053791  0.10625201]
Stock Position:  -0.000976124543102537
Bond Position:  [4.83931343]


portfolio before change:  [4.73958551]
curr_Stock_Price:  102.78694753121442
curr_Factors:  [102.78694753  -0.81592682  -0.9536731 ]
mat_Sqrt:  [[17.51501395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00693283 -0.02303406  0.04166005]
Stock Position:  0.006932833990657034
Bond Position:  [4.02698067]


portfolio before change:  [4.74061557]
curr_Stock_Price:  102.8629127915615
curr_Factors:  [102.86291279  -0.38469535  -0.95234633]
mat_Sqrt:  [[27.01400626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00785348 -0.07239032 -0.08347852]
Stock Position:  -0.00785347910918172
Bond Position:  [5.54844731]


portfolio before change:  [4.74947501]
curr_Stock_Price:  101.8231392319062
curr_Factors:  [101.82313923  -0.61274452  -0.93542421]
mat_Sqrt:  [[21.65136804  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03078224 -0.56479451 -0.57278487]
Stock Position:  -0.030782240521498205
Bond Position:  [7.88381938]


portfolio before change:  [4.79434278]
curr_Stock_Price:  100.39756962989992
curr_Factors:  [100.39756963  -0.41612748  -0.94147112]
mat_Sqrt:  [[25.8300721   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00071683 0.00993926 0.08967225]
Stock Position:  0.0007168299142075248
Bond Position:  [4.7223748]


portfolio before change:  [4.79384144]
curr_Stock_Price:  98.87464731907818
curr_Factors:  [98.87464732 -0.42143561 -0.92564775]
mat_Sqrt:  [[25.70715863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00588535 0.02882931 0.63229643]
Stock Position:  0.00588535158745194
Bond Position:  [4.21192937]


portfolio before change:  [4.7864154]
curr_Stock_Price:  97.52340169921924
curr_Factors:  [97.5234017  -0.42723739 -0.9161947 ]
mat_Sqrt:  [[25.44858823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00112678 0.00050286 0.03316321]
Stock Position:  0.001126782842732788
Bond Position:  [4.67652771]


portfolio before change:  [4.78682686]
curr_Stock_Price:  97.36973454574091
curr_Factors:  [97.36973455 -0.53899607 -0.91226981]
mat_Sqrt:  [[22.81115215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00484067 -0.01652814  0.11742107]
Stock Position:  0.004840669563647323
Bond Position:  [4.31549215]


portfolio before change:  [4.7832178]
curr_Stock_Price:  96.51271947332737
curr_Factors:  [96.51271947 -0.56073688 -0.90883687]
mat_Sqrt:  [[22.20019462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144937 -0.03214272 -0.24180104]
Stock Position:  -0.001449372404492088
Bond Position:  [4.92310067]


portfolio before change:  [4.78449062]
curr_Stock_Price:  96.05914891822155
curr_Factors:  [96.05914892 -0.31117906 -0.94748498]
mat_Sqrt:  [[27.28399048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00523327  0.00526065  0.1460917 ]
Stock Position:  -0.005233274026320805
Bond Position:  [5.28719447]


portfolio before change:  [4.78841267]
curr_Stock_Price:  95.43599993706488
curr_Factors:  [95.43599994 -0.46674698 -0.90839367]
mat_Sqrt:  [[24.12660595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00416506  0.00325083 -0.10608026]
Stock Position:  0.004165055576517008
Bond Position:  [4.39091643]


portfolio before change:  [4.78784751]
curr_Stock_Price:  95.16852164989429
curr_Factors:  [95.16852165 -0.32243414 -0.90935186]
mat_Sqrt:  [[27.7674155   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00269512 -0.01458612  0.7587317 ]
Stock Position:  0.002695119426238051
Bond Position:  [4.53135697]


portfolio before change:  [4.78598427]
curr_Stock_Price:  94.26700772313123
curr_Factors:  [94.26700772 -0.16061588 -0.90344397]
mat_Sqrt:  [[32.52702907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00694429 -0.03836516 -0.20646031]
Stock Position:  -0.006944292339812145
Bond Position:  [5.44060193]


portfolio before change:  [4.78839349]
curr_Stock_Price:  94.01801211503943
curr_Factors:  [94.01801212 -0.15404354 -0.92111362]
mat_Sqrt:  [[32.08309371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00388074  0.05172249  0.86943866]
Stock Position:  -0.003880743646869858
Bond Position:  [5.15325329]


portfolio before change:  [4.7834536]
curr_Stock_Price:  95.45693506711291
curr_Factors:  [95.45693507 -0.45008596 -0.91620483]
mat_Sqrt:  [[24.34641024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00554353 0.01965717 0.57358121]
Stock Position:  0.0055435335415205435
Bond Position:  [4.25428487]


portfolio before change:  [4.78404806]
curr_Stock_Price:  95.46823566411844
curr_Factors:  [95.46823566 -0.54717307 -0.93381334]
mat_Sqrt:  [[21.71074229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00642332  0.03979068 -0.07458453]
Stock Position:  -0.006423318614964339
Bond Position:  [5.39727095]


portfolio before change:  [4.77355722]
curr_Stock_Price:  97.20651711284867
curr_Factors:  [97.20651711 -0.34339205 -0.93229027]
mat_Sqrt:  [[27.14398383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00151411 -0.00532865 -0.23439711]
Stock Position:  0.001514108525610257
Bond Position:  [4.62637601]


portfolio before change:  [4.77535954]
curr_Stock_Price:  98.0149011008475
curr_Factors:  [98.0149011  -0.39074026 -0.94499935]
mat_Sqrt:  [[25.77435247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134334  0.00299117 -0.13771714]
Stock Position:  -0.0013433415160098707
Bond Position:  [4.90702702]


portfolio before change:  [4.77773962]
curr_Stock_Price:  96.69977798384348
curr_Factors:  [96.69977798 -0.50723999 -0.96062076]
mat_Sqrt:  [[22.28135775  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102221  0.00445543  0.1866464 ]
Stock Position:  -0.001022206251873545
Bond Position:  [4.87658673]


portfolio before change:  [4.77798998]
curr_Stock_Price:  97.05122030108316
curr_Factors:  [97.0512203  -0.70878067 -0.96553365]
mat_Sqrt:  [[18.19095628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224226 -0.0088125  -0.02097864]
Stock Position:  -0.0022422625201426656
Bond Position:  [4.99560429]


portfolio before change:  [4.77744492]
curr_Stock_Price:  97.57281542927228
curr_Factors:  [97.57281543 -0.82980113 -0.96226792]
mat_Sqrt:  [[16.25710226  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00501131  0.00681825  0.1350251 ]
Stock Position:  -0.005011307643376406
Bond Position:  [5.26641231]


portfolio before change:  [4.77002504]
curr_Stock_Price:  99.18481399213587
curr_Factors:  [99.18481399 -0.64336786 -0.97394778]
mat_Sqrt:  [[19.68130649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00770014 -0.02272259 -0.23684891]
Stock Position:  -0.007700138828845953
Bond Position:  [5.53376188]


portfolio before change:  [4.76465554]
curr_Stock_Price:  99.97197621277782
curr_Factors:  [99.97197621 -0.64715575 -0.97277782]
mat_Sqrt:  [[19.78563825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.12217579 0.43975864 0.46138121]
Stock Position:  0.12217579086823524
Bond Position:  [-7.44949971]


portfolio before change:  [4.55604525]
curr_Stock_Price:  98.27213821531923
curr_Factors:  [98.27213822 -0.6168629  -0.9282934 ]
mat_Sqrt:  [[20.95933752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231387 -0.01014678  0.00927646]
Stock Position:  -0.002313872869815623
Bond Position:  [4.78343448]


portfolio before change:  [4.55567013]
curr_Stock_Price:  98.6926827658644
curr_Factors:  [98.69268277 -0.59575241 -0.93975131]
mat_Sqrt:  [[21.25319186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00076491 -0.00456192 -0.19254611]
Stock Position:  0.0007649081112053914
Bond Position:  [4.48017929]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.55833578]
Stock Price:  101.44542947180469
PL:  [3.11290631]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 6.55240150e-02 -6.27832659e-02 -1.48906441e-02]
 [ 8.40888244e-01  2.11872909e-01  2.30502590e-01]
 [-3.92623789e-01 -2.74931696e-01  4.12488991e-02]
 [ 2.23347359e-01  1.51168494e+00  1.39872872e+00]
 [-5.48036180e-02  4.77802157e-03  3.92380329e-02]
 [-6.96421452e-02  5.37507203e-01 -2.73748980e-01]
 [-2.00142365e-01  2.32305478e-01  4.17427109e-01]
 [-2.83461171e-02  4.99801701e-02  3.06726049e-02]
 [ 3.24139800e-02 -4.81440886e-02 -1.52280783e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 5.03720022e-01  1.18935827e+00 -1.22007122e-01]
 [-9.34104983e-04  4.05156297e-02  6.85757499e-02]
 [-4.34721919e-01 -6.30539523e-02 -1.13802086e+00]
 [ 2.21619117e+00 -3.30743214e+00  2.81867013e+00]
 [-2.84954937e-03  2.38461276e-02 -2.72225263e-02]
 [ 2.40220340e-02  2.45385334e-01 -1.38878344e-01]
 [ 3.79336288e-02 -2.76657686e-01  6.76106906e-02]
 [-3.00658077e-01 -1.92141049e+00 -1.96126019e-01]
 [ 3.07871353e-02 -1.85846935e-01  3.53279712e-01]
 [-1.87122967e-01  4.54188852e-01  2.46681161e-01]
 [ 2.17547950e-02  4.92432825e-02 -2.31008178e-02]
 [ 1.21466832e-01 -5.22914956e-02  5.30259836e-02]
 [-4.39820548e-02 -9.64699032e-02 -9.44094272e-02]
 [-2.17502092e-01  6.06627138e-02  3.32602082e-02]
 [ 9.95551718e-02 -5.41405507e-03 -3.49486578e-02]
 [ 4.07002030e-02 -4.32746527e-02  2.80352797e-01]
 [-1.84418831e-01 -1.15479239e-01 -7.24365287e-02]
 [-2.03290776e-01  1.55442057e-01  2.66864124e-01]
 [ 1.52158464e-01  1.09789226e-01  2.20644444e-01]
 [-1.54267650e-01  1.07324960e-01 -1.14315521e-01]
 [ 1.07782397e-01  8.29349619e-04 -6.25927962e-03]
 [ 2.87508859e-03 -1.90894885e-03 -5.28754863e-02]
 [-5.12057528e-03  3.32144070e-02  8.11715672e-02]
 [-4.72578356e-03 -4.09638551e-02  4.92384767e-03]
 [-9.01850617e-02  1.02715719e-01  3.77732487e-02]
 [-9.06427316e-02 -5.14822826e-02 -5.44731582e-02]
 [ 1.17865334e+00  7.82839405e-01  1.25752610e-01]
 [ 1.41680656e-01 -2.12497156e-01  6.86921267e-02]
 [ 2.90146275e-02 -1.58727915e-02 -7.18930175e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.83952751]
curr_Stock_Price:  100.46830292134483
curr_Factors:  [100.46830292  -1.03911112  -0.98532945]
mat_Sqrt:  [[13.2686182   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00374334 -0.02026321 -0.04247886]
Stock Position:  0.0037433358768934953
Bond Position:  [5.46344091]


portfolio before change:  [5.83763818]
curr_Stock_Price:  99.78113446847058
curr_Factors:  [99.78113447 -0.86020542 -1.00456426]
mat_Sqrt:  [[15.45927984  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06023487 0.06838169 0.65755973]
Stock Position:  0.0602348734510343
Bond Position:  [-0.17266582]


portfolio before change:  [5.77960576]
curr_Stock_Price:  98.81805716369072
curr_Factors:  [98.81805716 -0.89257861 -1.00711005]
mat_Sqrt:  [[14.78468273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02978245 -0.08873382  0.11767163]
Stock Position:  -0.029782451056435132
Bond Position:  [8.72264971]


portfolio before change:  [5.77983177]
curr_Stock_Price:  98.84708045774205
curr_Factors:  [98.84708046 -0.92972698 -1.01453196]
mat_Sqrt:  [[14.14434753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05779221 0.48789422 3.99018369]
Stock Position:  0.05779220691457421
Bond Position:  [0.06724085]


portfolio before change:  [5.68088071]
curr_Stock_Price:  97.1347479565595
curr_Factors:  [97.13474796 -0.75884528 -1.00037618]
mat_Sqrt:  [[16.72455015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273962  0.0015421   0.11193519]
Stock Position:  -0.002739617994671206
Bond Position:  [5.94699281]


portfolio before change:  [5.68303277]
curr_Stock_Price:  96.62057197055861
curr_Factors:  [96.62057197 -0.55304688 -1.01150239]
mat_Sqrt:  [[20.21131123  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078188  0.1734797  -0.78092964]
Stock Position:  -0.0007818752164800054
Bond Position:  [5.758578]


portfolio before change:  [5.6842195]
curr_Stock_Price:  96.02347362071828
curr_Factors:  [96.02347362 -0.72386579 -1.0173447 ]
mat_Sqrt:  [[16.83368927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00401078  0.07497627  1.19080335]
Stock Position:  -0.004010781908497747
Bond Position:  [6.06934871]


portfolio before change:  [5.68481036]
curr_Stock_Price:  96.0653228027596
curr_Factors:  [96.0653228  -1.0030764  -1.02104643]
mat_Sqrt:  [[12.69115862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093632  0.01613103  0.0875004 ]
Stock Position:  -0.0009363162755766316
Bond Position:  [5.77475789]


portfolio before change:  [5.68622358]
curr_Stock_Price:  95.32697826217924
curr_Factors:  [95.32697826 -1.34292287 -1.02654083]
mat_Sqrt:  [[ 8.91601555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00218463 -0.01553844 -0.04344147]
Stock Position:  0.0021846294974969815
Bond Position:  [5.47796945]


portfolio before change:  [5.6879287]
curr_Stock_Price:  95.79402770583035
curr_Factors:  [95.79402771 -1.30923178 -1.03560546]
mat_Sqrt:  [[ 9.1830841   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [9.51825375e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  9.518253750210675e-05
Bond Position:  [5.67881078]


portfolio before change:  [5.68863445]
curr_Stock_Price:  95.75056018929537
curr_Factors:  [95.75056019 -1.3718658  -1.05449569]
mat_Sqrt:  [[ 8.46030301  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08529153  0.38386373 -0.34805236]
Stock Position:  0.08529152701673322
Bond Position:  [-2.47807704]


portfolio before change:  [5.69990089]
curr_Stock_Price:  95.88628546820875
curr_Factors:  [95.88628547 -1.30204021 -1.04841099]
mat_Sqrt:  [[ 9.14046966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00233402 0.01307636 0.19562753]
Stock Position:  0.002334024445477434
Bond Position:  [5.47609996]


portfolio before change:  [5.70039828]
curr_Stock_Price:  95.806093502127
curr_Factors:  [95.8060935  -1.02093301 -1.05214182]
mat_Sqrt:  [[12.05225122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05641189 -0.02035058 -3.24645675]
Stock Position:  -0.05641189154769219
Bond Position:  [11.10500123]


portfolio before change:  [5.70623485]
curr_Stock_Price:  95.72723853848206
curr_Factors:  [95.72723854 -1.20265865 -1.04808474]
mat_Sqrt:  [[10.08207905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.20991931 -1.06746913  8.04088132]
Stock Position:  0.20991930634277897
Bond Position:  [-14.38876067]


portfolio before change:  [5.72254266]
curr_Stock_Price:  95.81349322613984
curr_Factors:  [95.81349323 -1.32930787 -1.09459692]
mat_Sqrt:  [[ 8.48668735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041698  0.0076963  -0.07765829]
Stock Position:  -0.0004169770500324267
Bond Position:  [5.76249469]


portfolio before change:  [5.7230206]
curr_Stock_Price:  96.39486991330816
curr_Factors:  [96.39486991 -1.14123013 -1.15610614]
mat_Sqrt:  [[ 9.69021598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00472257  0.07919778 -0.39618126]
Stock Position:  0.004722565763991329
Bond Position:  [5.26778949]


portfolio before change:  [5.72282614]
curr_Stock_Price:  96.2142539700752
curr_Factors:  [96.21425397 -0.96911887 -1.17362874]
mat_Sqrt:  [[11.28901247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041969 -0.08929088  0.19287448]
Stock Position:  -0.00041969220375055413
Bond Position:  [5.76320652]


portfolio before change:  [5.72377498]
curr_Stock_Price:  95.67007769838627
curr_Factors:  [95.6700777  -0.83718134 -1.17937506]
mat_Sqrt:  [[12.73493725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05755022 -0.62013257 -0.55949294]
Stock Position:  -0.05755021732681206
Bond Position:  [11.22960874]


portfolio before change:  [5.72955327]
curr_Stock_Price:  95.59406578656474
curr_Factors:  [95.59406579 -0.99417982 -1.16645736]
mat_Sqrt:  [[11.01737491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00589652 -0.05998184  1.00780868]
Stock Position:  0.005896523283821576
Bond Position:  [5.16588063]


portfolio before change:  [5.72713179]
curr_Stock_Price:  95.07388549416531
curr_Factors:  [95.07388549 -0.95676545 -1.17595289]
mat_Sqrt:  [[11.26765234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391017  0.14658882  0.70371269]
Stock Position:  -0.003910173381269113
Bond Position:  [6.09888716]


portfolio before change:  [5.72512454]
curr_Stock_Price:  95.78220496696109
curr_Factors:  [95.78220497 -1.11616679 -1.18397339]
mat_Sqrt:  [[ 9.60166708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0028215  0.0158932 -0.0659002]
Stock Position:  0.0028214999621042898
Bond Position:  [5.45487506]


portfolio before change:  [5.72658286]
curr_Stock_Price:  96.05738164566367
curr_Factors:  [96.05738165 -1.28288962 -1.19471373]
mat_Sqrt:  [[ 8.06345713  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01508246 -0.01687701  0.15126837]
Stock Position:  0.0150824586656757
Bond Position:  [4.27780137]


portfolio before change:  [5.73408726]
curr_Stock_Price:  96.51948442202077
curr_Factors:  [96.51948442 -1.22741846 -1.19402598]
mat_Sqrt:  [[ 8.5702805   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00967823 -0.03113553 -0.26932382]
Stock Position:  -0.009678228734918427
Bond Position:  [6.66822491]


portfolio before change:  [5.74202002]
curr_Stock_Price:  95.7859639349968
curr_Factors:  [95.78596393 -1.04980952 -1.19621074]
mat_Sqrt:  [[10.13602486  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01956686  0.01957881  0.09488212]
Stock Position:  -0.01956685773431082
Bond Position:  [7.61625035]


portfolio before change:  [5.76137027]
curr_Stock_Price:  94.84569239397882
curr_Factors:  [94.84569239 -0.70761587 -1.16830038]
mat_Sqrt:  [[14.53173715  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00628391 -0.00174738 -0.09969879]
Stock Position:  0.006283912691633892
Bond Position:  [5.16536822]


portfolio before change:  [5.76491579]
curr_Stock_Price:  95.30715785380205
curr_Factors:  [95.30715785 -0.371642   -1.15774113]
mat_Sqrt:  [[20.65013364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00431443 -0.01396683  0.7997685 ]
Stock Position:  0.004314430991971495
Bond Position:  [5.35371964]


portfolio before change:  [5.75578671]
curr_Stock_Price:  93.03609654063656
curr_Factors:  [93.03609654 -0.40056991 -1.13716771]
mat_Sqrt:  [[19.99035553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01114422 -0.03727076 -0.20664125]
Stock Position:  -0.01114422281479715
Bond Position:  [6.7926017]


portfolio before change:  [5.74468975]
curr_Stock_Price:  94.10804990781466
curr_Factors:  [94.10804991 -0.76153699 -1.13326435]
mat_Sqrt:  [[14.14897603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00827536  0.05016871  0.76128906]
Stock Position:  -0.00827536123086519
Bond Position:  [6.52346786]


portfolio before change:  [5.74825292]
curr_Stock_Price:  93.77601842744586
curr_Factors:  [93.77601843 -0.79837774 -1.12129704]
mat_Sqrt:  [[13.75268914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01596836 0.03543432 0.62943718]
Stock Position:  0.015968364623749967
Bond Position:  [4.25080326]


portfolio before change:  [5.73903293]
curr_Stock_Price:  93.16535055249987
curr_Factors:  [93.16535055 -0.75049745 -1.10002208]
mat_Sqrt:  [[14.64144712  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01063383  0.03463898 -0.32611036]
Stock Position:  -0.010633825422114046
Bond Position:  [6.72973701]


portfolio before change:  [5.73216955]
curr_Stock_Price:  93.88989254027324
curr_Factors:  [93.88989254 -0.62090594 -1.11217519]
mat_Sqrt:  [[16.59400711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00642847  0.00026767 -0.01785598]
Stock Position:  0.006428466413237189
Bond Position:  [5.12860153]


portfolio before change:  [5.73972639]
curr_Stock_Price:  94.96568957324652
curr_Factors:  [94.96568957 -0.45831272 -1.10407538]
mat_Sqrt:  [[19.90811763  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004173  -0.00061611 -0.15083904]
Stock Position:  -0.0004173040148191264
Bond Position:  [5.77935595]


portfolio before change:  [5.74000965]
curr_Stock_Price:  96.01817872672362
curr_Factors:  [96.01817873 -0.44508545 -1.09341656]
mat_Sqrt:  [[20.61534127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00088421 0.0107199  0.23155989]
Stock Position:  0.0008842135431533926
Bond Position:  [5.65510907]


portfolio before change:  [5.73845986]
curr_Stock_Price:  93.46594924350678
curr_Factors:  [93.46594924 -0.54876997 -1.07766108]
mat_Sqrt:  [[18.37821774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00065743 -0.01322103  0.01404637]
Stock Position:  -0.0006574315008427738
Bond Position:  [5.79990732]


portfolio before change:  [5.73971665]
curr_Stock_Price:  92.65711649050701
curr_Factors:  [92.65711649 -0.58632347 -1.09564478]
mat_Sqrt:  [[17.2349192   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00356879  0.03315136  0.10775656]
Stock Position:  -0.003568793715179684
Bond Position:  [6.07039078]


portfolio before change:  [5.74210893]
curr_Stock_Price:  92.1994172742569
curr_Factors:  [92.19941727 -0.60921842 -1.11627553]
mat_Sqrt:  [[16.41933929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00683772 -0.01661584 -0.15539676]
Stock Position:  -0.006837717000629324
Bond Position:  [6.37254245]


portfolio before change:  [5.73776829]
curr_Stock_Price:  92.95072872895938
curr_Factors:  [92.95072873 -0.68455007 -1.14650132]
mat_Sqrt:  [[14.89488949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09158302 0.25266033 0.35873719]
Stock Position:  0.09158301648022106
Bond Position:  [-2.77493983]


portfolio before change:  [5.74988144]
curr_Stock_Price:  93.08678059085874
curr_Factors:  [93.08678059 -0.73954379 -1.15900411]
mat_Sqrt:  [[13.9430933   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00805607 -0.06858316  0.19595952]
Stock Position:  0.008056072988449249
Bond Position:  [4.99996754]


portfolio before change:  [5.74089999]
curr_Stock_Price:  91.8943275464472
curr_Factors:  [91.89432755 -0.6281229  -1.148154  ]
mat_Sqrt:  [[15.55469313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00156269 -0.00512292 -0.02050908]
Stock Position:  0.001562685760630098
Bond Position:  [5.59729803]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.74187681]
Stock Price:  92.07165966315871
PL:  [5.74187681]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.61209996e-01 -7.73007027e-03 -2.33819792e-01]
 [ 1.73232044e+00  3.56757035e-01  5.82925963e-01]
 [ 1.20518086e-01  2.27226681e-01  4.12103580e-02]
 [ 8.45582828e-02  7.33351585e-01  5.53102745e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-4.78616965e-02 -3.60614420e-02 -2.61205910e-02]
 [-3.56462977e-02 -9.68034832e-02 -1.47001604e-02]
 [ 1.35321187e-01  2.60151243e-02 -1.13888885e-01]
 [-1.40495774e-03  8.20536453e-02 -4.91606064e-02]
 [-2.26760005e-01 -7.66560312e-02 -8.85164173e-02]
 [ 6.73749892e-01  1.30935697e+00 -2.32232502e-01]
 [-2.37861600e-04  2.66933935e-02 -5.80029290e-02]
 [-1.69015511e-01 -5.10564724e-03 -3.48780682e-01]
 [ 1.59790484e+00 -3.07166630e+00  2.58131136e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.39243357e-01 -8.52108684e-02  2.34386993e-02]
 [-2.06691050e-01 -3.21746712e-01 -8.91943942e-03]
 [-2.55740276e-01 -1.68254141e+00 -2.02240950e-01]
 [-2.04834324e-02  8.96479657e-02  2.66452526e-01]
 [ 3.68602871e-01 -5.62245193e-01  3.10031661e-01]
 [ 8.54637193e-02 -5.14005397e-02 -1.27109792e-01]
 [-7.28413727e-02 -5.25964681e-02 -1.18383023e-01]
 [ 2.42625073e-01  2.75998761e-01  2.40218592e-01]
 [-6.46517512e-02  2.29317808e-02  1.27054019e-01]
 [-6.90018250e-02 -2.14254599e-01  8.37888107e-02]
 [ 1.03105466e-01 -3.18745772e-02 -1.03930858e-01]
 [ 6.39649201e-01 -4.56540495e-02  3.73560613e-01]
 [-2.24841578e-02 -1.28873764e-02  5.92365635e-02]
 [-1.43510200e-02 -7.96366153e-02 -1.12747145e-02]
 [ 3.12523985e-01 -1.41380001e-01  1.84472131e-03]
 [-2.03426506e-02 -7.25770478e-02 -2.92266747e-02]
 [ 1.95922958e-02  1.64940026e-02 -5.47859351e-02]
 [-3.53247773e-02 -3.84768348e-02 -1.51374008e-02]
 [ 3.95983076e-01  5.55004957e-02  8.30017353e-02]
 [-4.02052580e-02  4.67163081e-02 -1.10537002e-02]
 [-3.39819237e-02  1.07167791e-02 -1.54046242e-02]
 [ 2.23117454e+00  1.53087803e+00  1.84172605e-01]
 [-7.16528959e-02 -5.95722816e-02 -3.12831177e-02]
 [ 3.57680746e-02 -1.33216362e-02 -1.21830908e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.19629798]
curr_Stock_Price:  100.78991158934924
curr_Factors:  [100.78991159  -1.28084118  -1.03474158]
mat_Sqrt:  [[ 9.9488355   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01124793 -0.00249487 -0.66702278]
Stock Position:  0.011247933157144768
Bond Position:  [7.0626198]


portfolio before change:  [8.20380741]
curr_Stock_Price:  101.37904552222837
curr_Factors:  [101.37904552  -1.37870776  -1.03389675]
mat_Sqrt:  [[ 9.08170462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.21186908 0.11514284 1.66292552]
Stock Position:  0.2118690828063178
Bond Position:  [-13.27527799]


portfolio before change:  [8.25529502]
curr_Stock_Price:  101.62989444048384
curr_Factors:  [101.62989444  -1.53022504  -1.03951207]
mat_Sqrt:  [[ 7.78034452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02253275 0.0733371  0.11756168]
Stock Position:  0.022532751152058432
Bond Position:  [5.9652939]


portfolio before change:  [8.25823561]
curr_Stock_Price:  101.72730291193234
curr_Factors:  [101.72730291  -1.5301583   -1.05640593]
mat_Sqrt:  [[ 7.65785181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04533317 0.23668821 1.57784818]
Stock Position:  0.04533316680412157
Bond Position:  [3.64661482]


portfolio before change:  [8.2591138]
curr_Stock_Price:  101.73661905851027
curr_Factors:  [101.73661906  -1.6355616   -1.02705002]
mat_Sqrt:  [[ 7.09773478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00826264 -0.01106097 -0.05874131]
Stock Position:  -0.008262636289145588
Bond Position:  [9.09972648]


portfolio before change:  [8.25624711]
curr_Stock_Price:  102.22123718014682
curr_Factors:  [102.22123718  -1.570688    -1.0423658 ]
mat_Sqrt:  [[ 7.49387225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00808054 -0.01163878 -0.07451478]
Stock Position:  -0.00808054218893701
Bond Position:  [9.08225013]


portfolio before change:  [8.2609614]
curr_Stock_Price:  101.77832944833055
curr_Factors:  [101.77832945  -1.52416228  -1.05402064]
mat_Sqrt:  [[ 7.7261779   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00755961 -0.03124319 -0.04193547]
Stock Position:  -0.007559608954743389
Bond Position:  [9.03036577]


portfolio before change:  [8.26072322]
curr_Stock_Price:  101.9591645727373
curr_Factors:  [101.95916457  -1.523763    -1.05825898]
mat_Sqrt:  [[ 7.71024839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01522442  0.00839635 -0.32489329]
Stock Position:  0.015224416291795665
Bond Position:  [6.70845445]


portfolio before change:  [8.25857124]
curr_Stock_Price:  101.76273048811973
curr_Factors:  [101.76273049  -1.27796687  -1.05488376]
mat_Sqrt:  [[ 9.87289677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00053777  0.0264827  -0.14024153]
Stock Position:  0.0005377657473245014
Bond Position:  [8.20384673]


portfolio before change:  [8.25952136]
curr_Stock_Price:  101.62248778939207
curr_Factors:  [101.62248779  -1.24642438  -1.08082451]
mat_Sqrt:  [[ 9.91467483  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02627173 -0.02474063 -0.2525127 ]
Stock Position:  -0.026271733044946063
Bond Position:  [10.92932023]


portfolio before change:  [8.24245085]
curr_Stock_Price:  102.32425950159909
curr_Factors:  [102.3242595   -1.25261319  -1.09880015]
mat_Sqrt:  [[ 9.74479644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09170197  0.42259315 -0.66249469]
Stock Position:  0.0917019672646802
Bond Position:  [-1.14088504]


portfolio before change:  [8.20602799]
curr_Stock_Price:  101.92862734312003
curr_Factors:  [101.92862734  -1.07625242  -1.08418874]
mat_Sqrt:  [[11.74974669  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056417  0.00861526 -0.16546621]
Stock Position:  -0.0005641733350578114
Bond Position:  [8.2635334]


portfolio before change:  [8.20704102]
curr_Stock_Price:  101.9640385451893
curr_Factors:  [101.96403855  -0.85442015  -1.08259783]
mat_Sqrt:  [[14.69639467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01641574 -0.00164784 -0.9949742 ]
Stock Position:  -0.016415744214525584
Bond Position:  [9.88085659]


portfolio before change:  [8.19172531]
curr_Stock_Price:  102.97227096364134
curr_Factors:  [102.97227096  -0.88767577  -1.07310624]
mat_Sqrt:  [[14.49317322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10334601 -0.99137603  7.36376281]
Stock Position:  0.10334600537405206
Bond Position:  [-2.45004755]


portfolio before change:  [8.24298765]
curr_Stock_Price:  103.47126082399456
curr_Factors:  [103.47126082  -0.99798721  -1.09836127]
mat_Sqrt:  [[12.71707295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170396 -0.03053791  0.10625201]
Stock Position:  -0.0017039591553683106
Bond Position:  [8.41929845]


portfolio before change:  [8.24396025]
curr_Stock_Price:  103.5181376372181
curr_Factors:  [103.51813764  -0.95544204  -1.0805442 ]
mat_Sqrt:  [[13.51446511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00937027 -0.02750169  0.06686409]
Stock Position:  0.009370268428053389
Bond Position:  [7.27396751]


portfolio before change:  [8.25309164]
curr_Stock_Price:  104.39560266613532
curr_Factors:  [104.39560267  -1.36307995  -1.06909873]
mat_Sqrt:  [[ 9.17065652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0298984  -0.1038433  -0.02544468]
Stock Position:  -0.02989840424342517
Bond Position:  [11.37435357]


portfolio before change:  [8.25937855]
curr_Stock_Price:  104.23288406306277
curr_Factors:  [104.23288406  -1.32069948  -1.07734245]
mat_Sqrt:  [[ 9.47432716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06760056 -0.54303791 -0.57693714]
Stock Position:  -0.06760056453404063
Bond Position:  [15.30558035]


portfolio before change:  [8.22095418]
curr_Stock_Price:  104.82959041629503
curr_Factors:  [104.82959042  -1.40376863  -1.0257319 ]
mat_Sqrt:  [[ 9.23347582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00565391 0.02893376 0.76011489]
Stock Position:  0.005653913771402363
Bond Position:  [7.62825671]


portfolio before change:  [8.22518143]
curr_Stock_Price:  105.40859933342962
curr_Factors:  [105.40859933  -1.23842184  -0.99993499]
mat_Sqrt:  [[11.24009603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02821328 -0.18146386  0.88443403]
Stock Position:  0.028213282015257392
Bond Position:  [5.25125889]


portfolio before change:  [8.20595228]
curr_Stock_Price:  104.70376802724952
curr_Factors:  [104.70376803  -1.22799635  -0.98601114]
mat_Sqrt:  [[11.44013309  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00428539 -0.01658945 -0.36260886]
Stock Position:  0.0042853916156291244
Bond Position:  [7.75725563]


portfolio before change:  [8.20739757]
curr_Stock_Price:  104.81474456091391
curr_Factors:  [104.81474456  -1.18347106  -0.98016512]
mat_Sqrt:  [[12.0438996   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00894581 -0.01697544 -0.33771381]
Stock Position:  -0.008945808140440194
Bond Position:  [9.14505017]


portfolio before change:  [8.21268463]
curr_Stock_Price:  104.35152717460542
curr_Factors:  [104.35152717  -1.04555514  -0.96237587]
mat_Sqrt:  [[14.01088128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02483766 0.08907822 0.68527678]
Stock Position:  0.024837659516414822
Bond Position:  [5.62083693]


portfolio before change:  [8.21600122]
curr_Stock_Price:  104.45676809727844
curr_Factors:  [104.4567681   -1.27179996  -0.93308196]
mat_Sqrt:  [[11.51777345  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295509  0.0074012   0.36244975]
Stock Position:  -0.0029550874752222738
Bond Position:  [8.5246801]


portfolio before change:  [8.21818317]
curr_Stock_Price:  104.07901185733384
curr_Factors:  [104.07901186  -1.280136    -0.94116538]
mat_Sqrt:  [[11.28922764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00847118 -0.06915037  0.23902615]
Stock Position:  -0.008471176722028354
Bond Position:  [9.09985487]


portfolio before change:  [8.21252154]
curr_Stock_Price:  104.88163788451865
curr_Factors:  [104.88163788  -1.48010992  -0.94831621]
mat_Sqrt:  [[ 9.24799086  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00815142 -0.01028748 -0.29648581]
Stock Position:  0.00815142434830803
Bond Position:  [7.3575868]


portfolio before change:  [8.21450799]
curr_Stock_Price:  105.0124984108933
curr_Factors:  [105.01249841  -1.3954946   -0.9209855 ]
mat_Sqrt:  [[10.35634394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06822705 -0.01473478  1.06566445]
Stock Position:  0.06822705498728728
Bond Position:  [1.04981449]


portfolio before change:  [8.19020741]
curr_Stock_Price:  104.65440271768627
curr_Factors:  [104.65440272  -1.4217578   -0.9404278 ]
mat_Sqrt:  [[ 9.8599186   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132082 -0.00415938  0.16898543]
Stock Position:  -0.0013208191857430676
Bond Position:  [8.32843696]


portfolio before change:  [8.19202388]
curr_Stock_Price:  104.06738279263192
curr_Factors:  [104.06738279  -1.5130366   -0.95837851]
mat_Sqrt:  [[ 8.79007724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374379 -0.02570261 -0.03216362]
Stock Position:  -0.003743791619199871
Bond Position:  [8.58163048]


portfolio before change:  [8.19121782]
curr_Stock_Price:  104.56923637242848
curr_Factors:  [104.56923637  -1.45153316  -0.94834272]
mat_Sqrt:  [[ 9.48748462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02993854 -0.0456302   0.00526248]
Stock Position:  0.029938542868144156
Bond Position:  [5.06056725]


portfolio before change:  [8.19635708]
curr_Stock_Price:  104.71976664902182
curr_Factors:  [104.71976665  -1.53354014  -0.93017799]
mat_Sqrt:  [[ 8.91352476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00461358 -0.02342414 -0.08337557]
Stock Position:  -0.004613578750541233
Bond Position:  [8.67948997]


portfolio before change:  [8.20049833]
curr_Stock_Price:  104.0573218529214
curr_Factors:  [104.05732185  -1.3979196   -0.93647139]
mat_Sqrt:  [[10.07997645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00116826  0.00532342 -0.15628902]
Stock Position:  0.0011682554881313235
Bond Position:  [8.07893279]


portfolio before change:  [8.20101797]
curr_Stock_Price:  103.63764278516483
curr_Factors:  [103.63764279  -1.18632324  -0.95115533]
mat_Sqrt:  [[12.2242543   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378499 -0.01241835 -0.04318279]
Stock Position:  -0.0037849946661905336
Bond Position:  [8.59328589]


portfolio before change:  [8.20324176]
curr_Stock_Price:  103.3339254329883
curr_Factors:  [103.33392543  -1.25164974  -0.9522758 ]
mat_Sqrt:  [[11.40486701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03719945 0.01791271 0.23678085]
Stock Position:  0.037199445230370935
Bond Position:  [4.35927706]


portfolio before change:  [8.22470564]
curr_Stock_Price:  103.89627066832465
curr_Factors:  [103.89627067  -1.17006213  -0.96633549]
mat_Sqrt:  [[12.26801398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268386  0.01507762 -0.03153313]
Stock Position:  -0.002683862175496372
Bond Position:  [8.50354891]


portfolio before change:  [8.22450116]
curr_Stock_Price:  104.36853345160567
curr_Factors:  [104.36853345  -1.24246039  -0.98912141]
mat_Sqrt:  [[11.20484672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311819  0.00345883 -0.0439451 ]
Stock Position:  -0.003118188667069647
Bond Position:  [8.54994194]


portfolio before change:  [8.22585884]
curr_Stock_Price:  104.2758912319795
curr_Factors:  [104.27589123  -1.26153994  -1.02156821]
mat_Sqrt:  [[10.63267738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.24276649 0.49408876 0.52539318]
Stock Position:  0.2427664914001634
Bond Position:  [-17.08883341]


portfolio before change:  [8.08392175]
curr_Stock_Price:  103.7000257084633
curr_Factors:  [103.70002571  -1.3511066   -1.03016039]
mat_Sqrt:  [[ 9.58534502  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00941006 -0.01922687 -0.08924203]
Stock Position:  -0.009410060507957773
Bond Position:  [9.05974527]


portfolio before change:  [8.08727007]
curr_Stock_Price:  103.4645571021669
curr_Factors:  [103.4645571   -1.47249802  -1.04852709]
mat_Sqrt:  [[ 8.31618818  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098365 -0.00429954 -0.34754967]
Stock Position:  0.0009836450205643857
Bond Position:  [7.98549767]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.08839884]
Stock Price:  103.59725255355202
PL:  [4.49114629]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-1.44041112e-02 -1.10003448e-01  1.10558135e-01]
 [ 6.07955063e-01  1.95674741e-01  1.63217482e-01]
 [-4.18050424e-01 -2.98336388e-01  4.19905578e-02]
 [ 1.88812777e-01  1.24394144e+00  1.17465260e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 9.24496957e-03  1.01237053e-01 -2.93861417e-02]
 [-5.44750036e-02  5.98480183e-03 -6.47271535e-02]
 [-5.09170038e-02  1.61121240e-01 -1.34208483e-02]
 [ 1.51296751e-02  6.41605004e-02 -4.64421802e-02]
 [-1.78721954e-01 -9.83849447e-02 -6.99085211e-02]
 [ 6.80800653e-01  1.32032555e+00 -2.35293543e-01]
 [-2.49700283e-04  2.13773263e-02 -5.77405547e-02]
 [-9.83551231e-02 -1.49647253e-02 -2.63023081e-01]
 [ 1.58904145e+00 -3.07660495e+00  2.62461224e+00]
 [ 2.25485014e-02 -9.97702416e-02  5.08587305e-02]
 [ 1.35088294e-01 -1.26336181e-01  4.22340022e-02]
 [-2.46281697e-01 -4.05874961e-01  7.49543082e-03]
 [-2.46727252e-01 -1.62292652e+00 -1.99247192e-01]
 [-2.95997599e-02  1.37200920e-01  3.27703727e-01]
 [ 4.08208495e-01 -6.17698490e-01  3.41645576e-01]
 [ 1.02109210e-01 -7.25647364e-02 -2.37777360e-01]
 [-1.96407689e-01 -5.08093042e-02 -1.63823506e-01]
 [ 2.78814564e-01  3.40330755e-01  2.71975778e-01]
 [ 5.61418854e-01 -3.22555438e-01 -1.03656082e-01]
 [-8.24382765e-02 -2.32500410e-01  9.28706386e-02]
 [ 1.16135137e-01 -4.86647681e-02 -1.32392171e-01]
 [ 9.44406620e-01 -4.83800391e-02  5.53773490e-01]
 [-5.96165999e-02  6.01382073e-02  1.06509723e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 4.54394385e-01 -2.21300928e-01 -5.28311944e-02]
 [-2.00542910e-02 -8.94105997e-02 -1.74185249e-02]
 [ 6.15072250e-03 -1.35187258e-03 -2.34624076e-02]
 [-4.23211540e-02  1.68692924e-01 -2.70606646e-01]
 [ 5.84863603e-01  1.24947149e-01  1.85765731e-01]
 [-2.23770175e-02  1.29492065e-01 -5.36441852e-02]
 [-2.13841291e-03  3.71520929e-02  5.57949676e-02]
 [ 2.40130975e+00  1.68877152e+00  2.00825464e-01]
 [-1.24660839e-01  2.81746925e-02 -3.33979001e-03]
 [ 4.00851260e-02 -1.83095547e-02 -1.18481916e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.98412553]
curr_Stock_Price:  98.44544351685815
curr_Factors:  [98.44544352 -1.01804132 -0.96522815]
mat_Sqrt:  [[13.54792038  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105484 -0.03550346  0.31539159]
Stock Position:  -0.001054839843281759
Bond Position:  [-8.88028135]


portfolio before change:  [-8.98586175]
curr_Stock_Price:  99.03900346140978
curr_Factors:  [99.03900346 -0.99384477 -0.9866594 ]
mat_Sqrt:  [[13.66734724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04984242 0.06315375 0.46561404]
Stock Position:  0.04984241779973577
Bond Position:  [-13.92220513]


portfolio before change:  [-9.00773811]
curr_Stock_Price:  98.63501065664774
curr_Factors:  [98.63501066 -0.81663493 -0.97703168]
mat_Sqrt:  [[16.40784652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0286678  -0.09628766  0.11978737]
Stock Position:  -0.0286677960283079
Bond Position:  [-6.18008974]


portfolio before change:  [-9.03798038]
curr_Stock_Price:  99.66298348516968
curr_Factors:  [99.66298349 -0.79623943 -0.97601679]
mat_Sqrt:  [[16.93763571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04029525 0.40148037 3.3509569 ]
Stock Position:  0.04029524725411315
Bond Position:  [-13.05392494]


portfolio before change:  [-9.07011138]
curr_Stock_Price:  98.9060912969114
curr_Factors:  [98.9060913  -0.86834545 -0.96964876]
mat_Sqrt:  [[15.73954943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372603 -0.01106097 -0.05874131]
Stock Position:  -0.0037260279389641823
Bond Position:  [-8.70158452]


portfolio before change:  [-9.07453388]
curr_Stock_Price:  99.80107330375922
curr_Factors:  [99.8010733  -0.73009287 -0.9772058 ]
mat_Sqrt:  [[18.09942688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00132112  0.03267412 -0.08383048]
Stock Position:  0.0013211178207361274
Bond Position:  [-9.20638285]


portfolio before change:  [-9.07540115]
curr_Stock_Price:  100.01573395714331
curr_Factors:  [100.01573396  -0.7043902   -0.96717009]
mat_Sqrt:  [[18.79831469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353573  0.00193159 -0.18464855]
Stock Position:  -0.003535728446167751
Bond Position:  [-8.72177268]


portfolio before change:  [-9.07559492]
curr_Stock_Price:  99.76217373181562
curr_Factors:  [99.76217373 -0.89811772 -0.96812987]
mat_Sqrt:  [[15.43351579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134563  0.05200166 -0.03828594]
Stock Position:  -0.001345629086282426
Bond Position:  [-8.94135204]


portfolio before change:  [-9.07780181]
curr_Stock_Price:  100.57157114207685
curr_Factors:  [100.57157114  -0.97302916  -0.95728864]
mat_Sqrt:  [[14.59314393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012846   0.02070771 -0.13248661]
Stock Position:  0.0012846040663361084
Bond Position:  [-9.20699646]


portfolio before change:  [-9.07794688]
curr_Stock_Price:  101.35459712817634
curr_Factors:  [101.35459713  -0.96131104  -0.98398443]
mat_Sqrt:  [[14.48813102  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01470685 -0.0317536  -0.19942955]
Stock Position:  -0.01470684617860923
Bond Position:  [-7.58734041]


portfolio before change:  [-9.09103825]
curr_Stock_Price:  102.1802596308201
curr_Factors:  [102.18025963  -1.09442327  -0.99561763]
mat_Sqrt:  [[12.63786679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07139511  0.42613324 -0.67122699]
Stock Position:  0.0713951094535308
Bond Position:  [-16.38620907]


portfolio before change:  [-9.08335966]
curr_Stock_Price:  102.31650129661007
curr_Factors:  [102.3165013   -1.09484996  -1.01093231]
mat_Sqrt:  [[12.45707441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006159   0.0068995  -0.16471773]
Stock Position:  -0.0006159000857337191
Bond Position:  [-9.02034292]


portfolio before change:  [-9.08481993]
curr_Stock_Price:  102.85660672868873
curr_Factors:  [102.85660673  -1.04903691  -0.9929385 ]
mat_Sqrt:  [[13.34791839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01161973 -0.00482984 -0.75033164]
Stock Position:  -0.011619725413191406
Bond Position:  [-7.8896544]


portfolio before change:  [-9.10155309]
curr_Stock_Price:  104.21179285998214
curr_Factors:  [104.21179286  -1.19937833  -1.01056411]
mat_Sqrt:  [[11.43275941  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.13092017 -0.99296998  7.48728818]
Stock Position:  0.1309201714128624
Bond Position:  [-22.74497887]


portfolio before change:  [-9.03266665]
curr_Stock_Price:  104.75968198242148
curr_Factors:  [104.75968198  -1.38198863  -0.99411774]
mat_Sqrt:  [[ 9.73339359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129086 -0.03220071  0.1450858 ]
Stock Position:  0.0012908633500092297
Bond Position:  [-9.16789708]


portfolio before change:  [-9.03251945]
curr_Stock_Price:  105.7615385633924
curr_Factors:  [105.76153856  -1.63422288  -0.99695391]
mat_Sqrt:  [[ 7.61416353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01548706 -0.04077483  0.12048185]
Stock Position:  0.015487060180627479
Bond Position:  [-10.67045476]


portfolio before change:  [-9.036285]
curr_Stock_Price:  105.60452641395777
curr_Factors:  [105.60452641  -1.55153135  -0.98864017]
mat_Sqrt:  [[ 8.32722042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03934093 -0.13099558  0.02138238]
Stock Position:  -0.039340927847628715
Bond Position:  [-4.88170494]


portfolio before change:  [-9.04626235]
curr_Stock_Price:  105.84262702091851
curr_Factors:  [105.84262702  -1.48960475  -0.98660525]
mat_Sqrt:  [[ 8.89725981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06953567 -0.52379728 -0.56839678]
Stock Position:  -0.06953566785801255
Bond Position:  [-1.68642459]


portfolio before change:  [-9.05628315]
curr_Stock_Price:  105.9837055302631
curr_Factors:  [105.98370553  -1.63795519  -0.9912924 ]
mat_Sqrt:  [[ 7.64489246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00854145 0.04428141 0.93484752]
Stock Position:  0.008541454842958667
Bond Position:  [-9.96153818]


portfolio before change:  [-9.0575375]
curr_Stock_Price:  105.98264266606954
curr_Factors:  [105.98264267  -1.44677639  -0.97347239]
mat_Sqrt:  [[ 9.42180371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03734523 -0.19936133  0.97461973]
Stock Position:  0.03734523036887415
Bond Position:  [-13.0154837]


portfolio before change:  [-9.05261768]
curr_Stock_Price:  106.15794888499103
curr_Factors:  [106.15794888  -1.31501929  -0.97905443]
mat_Sqrt:  [[10.70653552  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0036203  -0.02342017 -0.67831262]
Stock Position:  0.0036203022579908806
Bond Position:  [-9.43694155]


portfolio before change:  [-9.05458464]
curr_Stock_Price:  105.94049056669671
curr_Factors:  [105.94049057  -1.58274682  -0.9811542 ]
mat_Sqrt:  [[ 8.15781615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02944654 -0.01639863 -0.46734286]
Stock Position:  -0.02944653611532114
Bond Position:  [-5.93500416]


portfolio before change:  [-9.05225433]
curr_Stock_Price:  105.83615815965982
curr_Factors:  [105.83615816  -1.71897782  -0.95082914]
mat_Sqrt:  [[ 7.33080445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05508278 0.10984128 0.77587119]
Stock Position:  0.055082783101650795
Bond Position:  [-14.88200448]


portfolio before change:  [-9.03157327]
curr_Stock_Price:  106.24538635650046
curr_Factors:  [106.24538636  -2.15284922  -0.98799379]
mat_Sqrt:  [[ 4.59472252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10325298 -0.10410432 -0.29570195]
Stock Position:  0.1032529798591351
Bond Position:  [-20.00172601]


portfolio before change:  [-8.99880249]
curr_Stock_Price:  106.58698572892766
curr_Factors:  [106.58698573  -2.20985716  -1.00488098]
mat_Sqrt:  [[ 4.28115689  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02591358 -0.07503918  0.26493408]
Stock Position:  -0.02591357594780164
Bond Position:  [-6.23675254]


portfolio before change:  [-9.00078638]
curr_Stock_Price:  106.63345742225157
curr_Factors:  [106.63345742  -2.2753969   -1.0000004 ]
mat_Sqrt:  [[ 4.03094169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01964232 -0.01570649 -0.37767801]
Stock Position:  0.019642319337295683
Bond Position:  [-11.09531481]


portfolio before change:  [-9.00110556]
curr_Stock_Price:  106.68782086707134
curr_Factors:  [106.68782087  -2.07977761  -1.01472822]
mat_Sqrt:  [[ 4.83267999  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.21676784 -0.01561459  1.57976163]
Stock Position:  0.21676784460415727
Bond Position:  [-32.12759453]


portfolio before change:  [-9.09945729]
curr_Stock_Price:  106.25262934444999
curr_Factors:  [106.25262934  -1.87981808  -0.99759507]
mat_Sqrt:  [[ 5.97991526  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428095  0.01940952  0.30384259]
Stock Position:  -0.004280952568154842
Bond Position:  [-8.64459482]


portfolio before change:  [-9.0992999]
curr_Stock_Price:  105.9634335088335
curr_Factors:  [105.96343351  -1.91381613  -0.98166681]
mat_Sqrt:  [[ 5.85684539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00586996 -0.02600141 -0.03673698]
Stock Position:  -0.005869961976654188
Bond Position:  [-8.47729857]


portfolio before change:  [-9.10022827]
curr_Stock_Price:  105.94105624632371
curr_Factors:  [105.94105625  -1.76203392  -0.96536091]
mat_Sqrt:  [[ 6.92742406  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05751595 -0.07142457 -0.15071269]
Stock Position:  0.057515953528837836
Bond Position:  [-15.19352914]


portfolio before change:  [-9.07220259]
curr_Stock_Price:  106.46134656987998
curr_Factors:  [106.46134657  -1.57865403  -1.00372706]
mat_Sqrt:  [[ 8.04781704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0052015  -0.02885715 -0.0496902 ]
Stock Position:  -0.005201496816821116
Bond Position:  [-8.51844423]


portfolio before change:  [-9.07375524]
curr_Stock_Price:  106.55512404308247
curr_Factors:  [106.55512404  -1.67559862  -1.00390834]
mat_Sqrt:  [[ 7.30935828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00014851 -0.00043631 -0.06693172]
Stock Position:  0.00014851218577082353
Bond Position:  [-9.08957998]


portfolio before change:  [-9.07490268]
curr_Stock_Price:  106.47994078652425
curr_Factors:  [106.47994079  -1.80466856  -1.00325511]
mat_Sqrt:  [[ 6.42394841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00982639  0.05444541 -0.77196544]
Stock Position:  -0.009826387313901966
Bond Position:  [-8.02858954]


portfolio before change:  [-9.08055482]
curr_Stock_Price:  106.9530048503068
curr_Factors:  [106.95300485  -1.64164701  -0.99762578]
mat_Sqrt:  [[ 7.6378545   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08487823 0.04032652 0.52993792]
Stock Position:  0.08487823439434257
Bond Position:  [-18.15853704]


portfolio before change:  [-9.08595467]
curr_Stock_Price:  106.91612977934496
curr_Factors:  [106.91612978  -1.72844223  -0.98303565]
mat_Sqrt:  [[ 7.10335216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00097062  0.04179338 -0.15303193]
Stock Position:  -0.0009706169193183257
Bond Position:  [-8.98218007]


portfolio before change:  [-9.08694306]
curr_Stock_Price:  106.77760462576262
curr_Factors:  [106.77760463  -1.60313795  -0.98728915]
mat_Sqrt:  [[ 8.00703966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00210244 0.01199079 0.15916751]
Stock Position:  0.0021024407358314237
Bond Position:  [-9.31143665]


portfolio before change:  [-9.08924616]
curr_Stock_Price:  106.23580815302412
curr_Factors:  [106.23580815  -1.62839961  -1.0127377 ]
mat_Sqrt:  [[ 7.57250492  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.36804494 0.54504867 0.57289915]
Stock Position:  0.368044940325253
Bond Position:  [-48.18879783]


portfolio before change:  [-8.93822532]
curr_Stock_Price:  106.66250826981734
curr_Factors:  [106.66250827  -1.56334293  -1.0306037 ]
mat_Sqrt:  [[ 7.97030764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01500462  0.00909334 -0.00952749]
Stock Position:  -0.015004619742730974
Bond Position:  [-7.33779494]


portfolio before change:  [-8.94103687]
curr_Stock_Price:  106.78875409017745
curr_Factors:  [106.78875409  -1.8058073   -1.03224369]
mat_Sqrt:  [[ 6.2513762   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0019456  -0.00590938 -0.33799593]
Stock Position:  0.0019456010229811894
Bond Position:  [-9.14880518]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.94063754]
Stock Price:  107.58182720752396
PL:  [-16.52246474]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 5.01938387e-02 -4.06112104e-02  9.79982166e-02]
 [ 1.09684866e+00  2.30926301e-01  3.04333364e-01]
 [-2.71168862e-01 -1.63134944e-01  3.77062320e-02]
 [ 8.77907100e-02  5.97793321e-01  5.43270217e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 5.21133769e-02 -5.78429673e-02  4.59473325e-02]
 [-4.98844286e-02 -6.86029982e-03 -7.35691116e-02]
 [ 5.24645091e-03  2.23198705e-01 -3.07068321e-02]
 [ 1.21264027e-02  6.74105265e-02 -4.69359423e-02]
 [-8.38705579e-02 -3.94863445e-02 -4.34688501e-03]
 [ 8.81651616e-01  1.69798320e+00 -3.06064471e-01]
 [ 2.33166658e-05  2.67121188e-02 -5.87277318e-02]
 [-3.15515798e-01 -5.69244654e-03 -6.44986169e-01]
 [ 1.80098988e+00 -3.45279085e+00  2.90768028e+00]
 [ 2.09240776e-02 -8.94122513e-02  3.40436115e-02]
 [ 1.21620384e-01 -1.20922066e-02 -2.60521862e-02]
 [-4.85642242e-02  1.64691099e-02 -7.06791741e-02]
 [-2.77598927e-01 -1.79740943e+00 -1.98768710e-01]
 [-1.23787589e-02  2.34410704e-02  3.27909045e-01]
 [ 1.51907598e-01  1.34356752e-01  3.64665051e-01]
 [ 2.95848840e-02 -3.90421012e-02  4.11914703e-02]
 [ 1.10680768e-01 -5.10531413e-02  2.84912707e-02]
 [ 1.12655175e-01  2.04873259e-02  1.90828225e-02]
 [-9.76279121e-02 -2.66079014e-02  6.85734167e-02]
 [ 5.55544254e-02 -5.70451753e-03 -1.29223194e-02]
 [ 4.90112396e-02 -4.18155008e-02  2.91292028e-01]
 [-1.03977346e-01 -1.18168453e-01 -3.77840615e-02]
 [-1.53765933e-01  1.09886016e-01  2.26162015e-01]
 [ 2.94564001e-02  5.60919098e-03  1.44302757e-01]
 [-8.66304299e-02  1.00055914e-01 -6.32824745e-04]
 [ 2.82532027e-02 -1.20214223e-02 -7.54206962e-02]
 [-4.33040106e-03  1.44604251e-02 -5.59635998e-02]
 [-3.46292278e-02  1.76072107e-03  5.22705499e-02]
 [-2.78038938e-02 -2.84997934e-02 -7.22764444e-03]
 [-1.05325971e-01  1.02598695e-01  2.06126391e-02]
 [-1.06032080e-01 -5.99379494e-02 -6.92146530e-02]
 [ 7.99758460e-01  5.53213300e-01  1.12454628e-01]
 [ 5.03282360e-02 -1.06470931e-01  6.34200997e-02]
 [ 3.05266073e-02 -1.54677436e-02 -3.25985051e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.22892872]
curr_Stock_Price:  100.93082603153248
curr_Factors:  [100.93082603  -0.85862271  -1.03716382]
mat_Sqrt:  [[15.15982523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00408368 -0.01310721  0.27956163]
Stock Position:  0.004083682453246912
Bond Position:  [8.81675928]


portfolio before change:  [9.22868558]
curr_Stock_Price:  100.6013923489223
curr_Factors:  [100.60139235  -0.72477848  -1.03628274]
mat_Sqrt:  [[17.28959506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06975919 0.07453114 0.86817838]
Stock Position:  0.06975918648173725
Bond Position:  [2.21081429]


portfolio before change:  [9.18431088]
curr_Stock_Price:  99.96131794988874
curr_Factors:  [99.96131795 -0.67357157 -1.03140372]
mat_Sqrt:  [[18.17065626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01633248 -0.05265158  0.10756538]
Stock Position:  -0.016332480602583885
Bond Position:  [10.81692717]


portfolio before change:  [9.15830204]
curr_Stock_Price:  101.63657117797001
curr_Factors:  [101.63657118  -0.66573213  -1.06381691]
mat_Sqrt:  [[18.0267069   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01779079 0.19293696 1.54979871]
Stock Position:  0.017790788482242213
Bond Position:  [7.3501073]


portfolio before change:  [9.14677175]
curr_Stock_Price:  100.93682052660864
curr_Factors:  [100.93682053  -0.84996323  -1.07737208]
mat_Sqrt:  [[14.68988947  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00399227 -0.01106097 -0.05874131]
Stock Position:  -0.003992269719816535
Bond Position:  [9.54973876]


portfolio before change:  [9.14835474]
curr_Stock_Price:  100.83933075897689
curr_Factors:  [100.83933076  -1.11225412  -1.08217083]
mat_Sqrt:  [[11.23578201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00442205 -0.01866874  0.13107495]
Stock Position:  0.00442205007250799
Bond Position:  [8.70243817]


portfolio before change:  [9.14697527]
curr_Stock_Price:  100.28136520415102
curr_Factors:  [100.2813652   -1.28676074  -1.08874036]
mat_Sqrt:  [[ 9.32294708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0071117  -0.00221415 -0.2098722 ]
Stock Position:  -0.007111701149342254
Bond Position:  [9.86014637]


portfolio before change:  [9.14708598]
curr_Stock_Price:  100.43911656479125
curr_Factors:  [100.43911656  -1.07902144  -1.11501715]
mat_Sqrt:  [[11.19551391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00397826  0.07203707 -0.08759804]
Stock Position:  0.003978262214898068
Bond Position:  [8.74751284]


portfolio before change:  [9.14552845]
curr_Stock_Price:  99.77273554768067
curr_Factors:  [99.77273555 -1.01745389 -1.11423277]
mat_Sqrt:  [[11.83674052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137755  0.02175665 -0.13389518]
Stock Position:  0.0013775548831155588
Bond Position:  [9.00808603]


portfolio before change:  [9.14767436]
curr_Stock_Price:  100.51305396918424
curr_Factors:  [100.51305397  -0.97574008  -1.13297077]
mat_Sqrt:  [[12.2017179   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00760696 -0.01274416 -0.01240045]
Stock Position:  -0.00760695986656369
Bond Position:  [9.91227313]


portfolio before change:  [9.14921902]
curr_Stock_Price:  100.47288726069306
curr_Factors:  [100.47288726  -1.04605543  -1.14333874]
mat_Sqrt:  [[11.25141325  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.1036115   0.54802172 -0.87311674]
Stock Position:  0.10361150288586414
Bond Position:  [-1.26092783]


portfolio before change:  [9.12751114]
curr_Stock_Price:  100.26489630320752
curr_Factors:  [100.2648963   -1.02101978  -1.13931624]
mat_Sqrt:  [[11.55917647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056335  0.0086213  -0.16753387]
Stock Position:  -0.0005633483472866501
Bond Position:  [9.1839952]


portfolio before change:  [9.12860824]
curr_Stock_Price:  100.35537350695365
curr_Factors:  [100.35537351  -1.31727287  -1.12025138]
mat_Sqrt:  [[ 8.76874217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.11287714e-02 -1.83722922e-03 -1.83996601e+00]
Stock Position:  -0.05112877141143481
Bond Position:  [14.25965519]


portfolio before change:  [9.10188889]
curr_Stock_Price:  100.91282705595162
curr_Factors:  [100.91282706  -1.39431053  -1.16219383]
mat_Sqrt:  [[ 7.82835721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.21584601 -1.11438346  8.29480249]
Stock Position:  0.21584600745552082
Bond Position:  [-12.67974193]


portfolio before change:  [9.05615466]
curr_Stock_Price:  100.7082869468803
curr_Factors:  [100.70828695  -1.43609302  -1.16494656]
mat_Sqrt:  [[ 7.47219288  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128771 -0.02885768  0.09711695]
Stock Position:  0.001287707834242692
Bond Position:  [8.92647181]


portfolio before change:  [9.05710035]
curr_Stock_Price:  100.57612359084158
curr_Factors:  [100.57612359  -1.59472575  -1.15201395]
mat_Sqrt:  [[ 6.45061318  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01764703 -0.00390274 -0.07431964]
Stock Position:  0.017647034334345234
Bond Position:  [7.28223004]


portfolio before change:  [9.04295659]
curr_Stock_Price:  99.72305732026688
curr_Factors:  [99.72305732 -1.54481539 -1.15215814]
mat_Sqrt:  [[ 6.72225313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00887051  0.00531538 -0.20162801]
Stock Position:  -0.008870509043358316
Bond Position:  [9.92755088]


portfolio before change:  [9.04234852]
curr_Stock_Price:  99.93151145119259
curr_Factors:  [99.93151145 -1.28350927 -1.15330063]
mat_Sqrt:  [[ 8.7379461   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07840139 -0.5801114  -0.5670318 ]
Stock Position:  -0.07840138575813373
Bond Position:  [16.8771175]


portfolio before change:  [9.05073469]
curr_Stock_Price:  99.85145683473827
curr_Factors:  [99.85145683 -1.16528805 -1.15344604]
mat_Sqrt:  [[ 9.82519065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00603961 0.00756557 0.93543323]
Stock Position:  0.006039606270326907
Bond Position:  [8.4476712]


portfolio before change:  [9.04867829]
curr_Stock_Price:  99.33612219834133
curr_Factors:  [99.3361222  -1.00060851 -1.18619798]
mat_Sqrt:  [[11.15293599  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02275365 0.04336346 1.04028789]
Stock Position:  0.022753649586708197
Bond Position:  [6.78841898]


portfolio before change:  [9.02882071]
curr_Stock_Price:  98.42610606989611
curr_Factors:  [98.42610607 -0.9829746  -1.19945024]
mat_Sqrt:  [[11.0992911   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.002705   -0.01260078  0.1175078 ]
Stock Position:  0.0027050035732949294
Bond Position:  [8.76257774]


portfolio before change:  [9.02913109]
curr_Stock_Price:  98.13590088977922
curr_Factors:  [98.13590089 -1.00095535 -1.21964306]
mat_Sqrt:  [[10.65207656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00995818 -0.01647733  0.08127766]
Stock Position:  0.00995818466044182
Bond Position:  [8.05187567]


portfolio before change:  [9.03384779]
curr_Stock_Price:  98.508473229407
curr_Factors:  [98.50847323 -0.93223157 -1.20667602]
mat_Sqrt:  [[11.60266695  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01040557 0.00661226 0.05443798]
Stock Position:  0.010405572970907445
Bond Position:  [8.00881068]


portfolio before change:  [9.02663152]
curr_Stock_Price:  97.71875910805392
curr_Factors:  [97.71875911 -0.96009829 -1.16588029]
mat_Sqrt:  [[11.65942627  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0076386  -0.00858766  0.19562087]
Stock Position:  -0.0076386037483001795
Bond Position:  [9.7730664]


portfolio before change:  [9.02331445]
curr_Stock_Price:  98.31294922273578
curr_Factors:  [98.31294922 -0.92389237 -1.18633199]
mat_Sqrt:  [[11.91658823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00434287 -0.00184113 -0.03686378]
Stock Position:  0.004342873750470223
Bond Position:  [8.59635372]


portfolio before change:  [9.02236484]
curr_Stock_Price:  97.84684834981803
curr_Factors:  [97.84684835 -0.7899151  -1.17699803]
mat_Sqrt:  [[13.68760064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00730116 -0.01349589  0.83097508]
Stock Position:  0.007301164401105673
Bond Position:  [8.30796892]


portfolio before change:  [9.02191766]
curr_Stock_Price:  97.64335436844561
curr_Factors:  [97.64335437 -0.6845426  -1.19725797]
mat_Sqrt:  [[14.87260634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00913162 -0.0381387  -0.10778741]
Stock Position:  -0.0091316220613299
Bond Position:  [9.91355987]


portfolio before change:  [9.02702785]
curr_Stock_Price:  97.21945201997617
curr_Factors:  [97.21945202 -0.45361108 -1.22106988]
mat_Sqrt:  [[18.21580917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00467563  0.03546556  0.64517728]
Stock Position:  -0.004675631738705975
Bond Position:  [9.48159021]


portfolio before change:  [9.02878136]
curr_Stock_Price:  97.09792127065067
curr_Factors:  [97.09792127 -0.51615479 -1.24129036]
mat_Sqrt:  [[16.74793239  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00358594 0.00181036 0.4116556 ]
Stock Position:  0.0035859380716141316
Bond Position:  [8.68059422]


portfolio before change:  [9.03358618]
curr_Stock_Price:  98.1352187575507
curr_Factors:  [98.13521876 -0.41642884 -1.25377833]
mat_Sqrt:  [[18.46984021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359157  0.03229291 -0.00180527]
Stock Position:  -0.0035915728614165773
Bond Position:  [9.38604597]


portfolio before change:  [9.03343735]
curr_Stock_Price:  98.50334884599975
curr_Factors:  [98.50334885 -0.51842986 -1.22367078]
mat_Sqrt:  [[17.2530667   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060303 -0.0038799  -0.21515425]
Stock Position:  0.0006030322107662147
Bond Position:  [8.97403665]


portfolio before change:  [9.03459875]
curr_Stock_Price:  98.56898490521293
curr_Factors:  [98.56898491 -0.45241981 -1.2182785 ]
mat_Sqrt:  [[18.5423693   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069043  0.00466708 -0.15964857]
Stock Position:  -0.0006904296280898631
Bond Position:  [9.1026537]


portfolio before change:  [9.0364398]
curr_Stock_Price:  97.55056172680676
curr_Factors:  [97.55056173 -0.24711575 -1.24658404]
mat_Sqrt:  [[21.90403881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00107743  0.00056827  0.14911333]
Stock Position:  -0.0010774333005734537
Bond Position:  [9.14154403]


portfolio before change:  [9.03868718]
curr_Stock_Price:  96.52533516033995
curr_Factors:  [ 9.65253352e+01 -6.46832871e-02 -1.25221668e+00]
mat_Sqrt:  [[25.86538387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013569  -0.00919827 -0.02061846]
Stock Position:  -0.0013568995025650475
Bond Position:  [9.16966236]


portfolio before change:  [9.04131206]
curr_Stock_Price:  95.43564475767833
curr_Factors:  [ 9.54356448e+01 -5.70092457e-02 -1.26032547e+00]
mat_Sqrt:  [[25.56226981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313648  0.03311359  0.05880212]
Stock Position:  -0.003136480591378441
Bond Position:  [9.34064411]


portfolio before change:  [9.04530069]
curr_Stock_Price:  94.53623672408574
curr_Factors:  [ 9.45362367e+01  4.93962850e-03 -1.23690877e+00]
mat_Sqrt:  [[27.57788205  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00480078 -0.01934489 -0.19745014]
Stock Position:  -0.004800776386795706
Bond Position:  [9.49914802]


portfolio before change:  [9.04474084]
curr_Stock_Price:  94.90020254564978
curr_Factors:  [94.90020255 -0.19076571 -1.24035236]
mat_Sqrt:  [[22.68508732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0412446  0.17854882 0.32080175]
Stock Position:  0.041244600159555146
Bond Position:  [5.13061993]


portfolio before change:  [9.02969073]
curr_Stock_Price:  94.51975339419354
curr_Factors:  [94.51975339 -0.14101809 -1.23046196]
mat_Sqrt:  [[23.98260559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00173211 -0.03436335  0.18091989]
Stock Position:  0.001732110454148126
Bond Position:  [8.86597208]


portfolio before change:  [9.02947923]
curr_Stock_Price:  93.75778273065218
curr_Factors:  [93.75778273 -0.23227659 -1.19464017]
mat_Sqrt:  [[22.50635953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00092041 -0.00499219 -0.09299446]
Stock Position:  0.0009204120879775144
Bond Position:  [8.94318344]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.02969956]
Stock Price:  92.78252234167039
PL:  [9.02969956]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 3.41342054e-02 -4.35943308e-02  1.28192114e-01]
 [ 1.04578959e+00  2.34362766e-01  2.97911489e-01]
 [-3.59906196e-01 -2.44815828e-01  4.02945735e-02]
 [ 1.86167172e-01  1.14688044e+00  1.14296112e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-4.51131863e-02  3.99345477e-01 -1.95552505e-01]
 [-5.72058934e-02 -3.72119311e-02 -2.93465612e-03]
 [ 8.56983318e-03 -2.25382423e-02  6.00585992e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 8.89649529e-01  1.88652564e+00 -2.65169622e-01]
 [-2.42220134e-03 -2.46141335e-01  3.67878893e-01]
 [-4.88285319e-01 -1.32723749e-02 -1.03296124e+00]
 [ 1.88366856e+00 -2.74435679e+00  2.33087150e+00]
 [ 1.58796507e-02 -5.34598884e-02 -2.42229578e-02]
 [ 1.92972538e-02  3.98725747e-01 -2.22892318e-01]
 [ 2.08075450e-02 -1.27518802e-01 -8.63573634e-02]
 [-3.01729593e-01 -1.92006432e+00 -1.93435501e-01]
 [ 4.50334225e-02 -1.15866182e-01  3.38842049e-02]
 [-2.90346981e-01  1.86037296e-01 -4.05120589e-02]
 [ 1.12188260e-02  1.68037855e-01 -1.09610890e-01]
 [ 4.73549556e-02 -4.04022177e-02 -3.36797141e-03]
 [ 4.49702296e-03 -1.06337069e-01 -9.89668754e-02]
 [-1.82175799e-01  3.49445205e-02  4.36668258e-02]
 [ 1.25896432e-01 -1.80184356e-03 -4.27570267e-02]
 [-1.71487301e-02 -5.34310725e-02  2.04210327e-01]
 [-1.82302695e-01 -1.12367661e-01 -7.25701697e-02]
 [-2.33815813e-01  1.71589410e-01  3.21884345e-01]
 [ 1.21337458e-01  1.26684727e-01  2.97589029e-01]
 [-1.61067443e-01  1.23857171e-01 -2.67712894e-02]
 [ 6.25414600e-02 -1.99592407e-02 -7.17721733e-02]
 [-1.06651759e-02  7.62329757e-03 -5.21273225e-02]
 [ 7.24602609e-03  3.57814445e-02  8.17461831e-02]
 [-5.61669732e-02 -1.87952584e-02 -5.74524702e-03]
 [-1.08664867e-01  7.00604882e-02  2.30152431e-02]
 [-1.21666364e-01 -7.20121806e-02 -8.37574237e-02]
 [ 2.32150955e+00  1.49308479e+00  1.69299972e-01]
 [-6.03248376e-02  1.99425596e-02  1.80883280e-02]
 [ 3.47951887e-02 -1.34572028e-02 -9.97419083e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.91270585]
curr_Stock_Price:  100.75121215271778
curr_Factors:  [100.75121215  -0.83939568  -0.98599136]
mat_Sqrt:  [[16.23658771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316585 -0.01407001  0.36569642]
Stock Position:  0.0031658533458711136
Bond Position:  [7.59374228]


portfolio before change:  [7.91226687]
curr_Stock_Price:  100.31270335183694
curr_Factors:  [100.31270335  -0.83270001  -0.97581123]
mat_Sqrt:  [[16.44104757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07021691 0.07564026 0.84985856]
Stock Position:  0.07021691364110168
Bond Position:  [0.86861844]


portfolio before change:  [7.8274051]
curr_Stock_Price:  99.10259098285414
curr_Factors:  [99.10259098 -0.90033503 -0.9761873 ]
mat_Sqrt:  [[15.17475585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02646856 -0.07901397  0.1149492 ]
Stock Position:  -0.02646855912531569
Bond Position:  [10.45050789]


portfolio before change:  [7.81198463]
curr_Stock_Price:  99.73454297699138
curr_Factors:  [99.73454298 -0.66069815 -0.9773811 ]
mat_Sqrt:  [[19.3837063   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03371796 0.37015407 3.26054995]
Stock Position:  0.03371796461149763
Bond Position:  [4.44913884]


portfolio before change:  [7.80473837]
curr_Stock_Price:  99.50313980687078
curr_Factors:  [99.50313981 -0.55896663 -0.97916263]
mat_Sqrt:  [[21.37153591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00274412 -0.01106097 -0.05874131]
Stock Position:  -0.002744117277819267
Bond Position:  [8.07778665]


portfolio before change:  [7.80851832]
curr_Stock_Price:  98.49364561317896
curr_Factors:  [98.49364561 -0.3539982  -0.96852645]
mat_Sqrt:  [[26.24478721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.33897835e-04  1.28888198e-01 -5.57856866e-01]
Stock Position:  -0.00013389783528199413
Bond Position:  [7.82170641]


portfolio before change:  [7.80963103]
curr_Stock_Price:  97.48596134291346
curr_Factors:  [97.48596134 -0.32725699 -0.95831964]
mat_Sqrt:  [[26.95400112  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242638 -0.0120101  -0.00837176]
Stock Position:  -0.002426384896525217
Bond Position:  [8.04616949]


portfolio before change:  [7.81614274]
curr_Stock_Price:  95.21678960207471
curr_Factors:  [ 9.52167896e+01  3.93111800e-03 -9.50279193e-01]
mat_Sqrt:  [[36.95896387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004391  -0.00727419  0.17133047]
Stock Position:  0.00043909899698507963
Bond Position:  [7.77433315]


portfolio before change:  [7.81807064]
curr_Stock_Price:  97.39407624976755
curr_Factors:  [97.39407625  0.19910985 -0.99381918]
mat_Sqrt:  [[43.99412337  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118178  0.0064198  -0.11330016]
Stock Position:  0.0011817760956248393
Bond Position:  [7.70297265]


portfolio before change:  [7.81554484]
curr_Stock_Price:  94.44196960848517
curr_Factors:  [ 9.44419696e+01  4.45729257e-02 -9.57319458e-01]
mat_Sqrt:  [[37.91091386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.30558738e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  2.3055873835720595e-05
Bond Position:  [7.8133674]


portfolio before change:  [7.81655701]
curr_Stock_Price:  95.9791112647555
curr_Factors:  [95.97911126  0.12753704 -0.949295  ]
mat_Sqrt:  [[42.19799098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02892572  0.60887353 -0.75645512]
Stock Position:  0.02892572400720328
Bond Position:  [5.04029173]


portfolio before change:  [7.89443948]
curr_Stock_Price:  98.6498270806708
curr_Factors:  [98.64982708  0.26079491 -0.95223446]
mat_Sqrt:  [[49.40921403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.53910755e-04 -7.94417743e-02  1.04945608e+00]
Stock Position:  0.00045391075530295703
Bond Position:  [7.84966126]


portfolio before change:  [7.89458094]
curr_Stock_Price:  96.79966023075069
curr_Factors:  [96.79966023  0.19955366 -0.92508729]
mat_Sqrt:  [[46.85744222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01497834 -0.00428364 -2.94675089]
Stock Position:  -0.0149783434141194
Bond Position:  [9.34447949]


portfolio before change:  [7.94601763]
curr_Stock_Price:  93.44357718663969
curr_Factors:  [93.44357719  0.10740376 -0.9043452 ]
mat_Sqrt:  [[42.11552183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04272216 -0.88573734  6.6493276 ]
Stock Position:  0.04272216387263536
Bond Position:  [3.95390582]


portfolio before change:  [7.99038393]
curr_Stock_Price:  94.47049199048585
curr_Factors:  [ 9.44704920e+01  3.09382125e-02 -9.14934460e-01]
mat_Sqrt:  [[39.02846626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.81782327e-07 -1.72541048e-02 -6.91013563e-02]
Stock Position:  5.817823267650838e-07
Bond Position:  [7.99032897]


portfolio before change:  [7.99138265]
curr_Stock_Price:  94.23978204995562
curr_Factors:  [ 9.42397820e+01  4.92003217e-02 -9.00340001e-01]
mat_Sqrt:  [[40.2336105   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137172  0.12868818 -0.63584974]
Stock Position:  0.0013717163703331218
Bond Position:  [7.86211239]


portfolio before change:  [7.99149788]
curr_Stock_Price:  93.60729525916942
curr_Factors:  [ 9.36072953e+01  2.98372178e-02 -8.64895578e-01]
mat_Sqrt:  [[40.61144652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056264 -0.04115652 -0.24635352]
Stock Position:  -0.0005626429593473427
Bond Position:  [8.04416536]


portfolio before change:  [7.99181559]
curr_Stock_Price:  94.82987647397422
curr_Factors:  [94.82987647 -0.26955888 -0.85618028]
mat_Sqrt:  [[30.7640054   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02383129 -0.6196981  -0.55181764]
Stock Position:  -0.0238312901034056
Bond Position:  [10.25173388]


portfolio before change:  [8.01935215]
curr_Stock_Price:  93.72817298058821
curr_Factors:  [93.72817298 -0.16704415 -0.83799098]
mat_Sqrt:  [[34.3074898   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082486 -0.03739565  0.0966622 ]
Stock Position:  0.0008248613258441777
Bond Position:  [7.9420394]


portfolio before change:  [8.02057307]
curr_Stock_Price:  94.00471052436777
curr_Factors:  [94.00471052  0.16396769 -0.85275946]
mat_Sqrt:  [[47.20751644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00552119  0.06004328 -0.11556963]
Stock Position:  -0.005521192098414852
Bond Position:  [8.53959114]


portfolio before change:  [8.02709739]
curr_Stock_Price:  93.01637271283549
curr_Factors:  [93.01637271  0.19162931 -0.85517842]
mat_Sqrt:  [[47.9053129   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00048314  0.05423398 -0.31268936]
Stock Position:  0.0004831443318665745
Bond Position:  [7.98215706]


portfolio before change:  [8.02914095]
curr_Stock_Price:  95.18079380289853
curr_Factors:  [95.1807938  -0.14364604 -0.83299501]
mat_Sqrt:  [[35.84259974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107192 -0.01303976 -0.00960788]
Stock Position:  0.001071920101597523
Bond Position:  [7.92711474]


portfolio before change:  [8.03042001]
curr_Stock_Price:  95.44956994775531
curr_Factors:  [95.44956995 -0.11160424 -0.82845013]
mat_Sqrt:  [[37.28323186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00100341 -0.03432014 -0.28232495]
Stock Position:  -0.0010034127241283922
Bond Position:  [8.12619532]


portfolio before change:  [8.03151836]
curr_Stock_Price:  95.36733521587405
curr_Factors:  [95.36733522 -0.17112483 -0.83789398]
mat_Sqrt:  [[34.76869155  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00477813  0.0112783   0.1245693 ]
Stock Position:  -0.004778129919657462
Bond Position:  [8.48719588]


portfolio before change:  [8.03908885]
curr_Stock_Price:  94.00497732621596
curr_Factors:  [ 9.40049773e+01 -4.71556236e-02 -8.21050320e-01]
mat_Sqrt:  [[39.4542506   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296041 -0.00058154 -0.1219739 ]
Stock Position:  0.0029604133554292844
Bond Position:  [7.76079526]


portfolio before change:  [8.03043219]
curr_Stock_Price:  90.7531270131775
curr_Factors:  [ 9.07531270e+01 -8.68366476e-02 -8.24443814e-01]
mat_Sqrt:  [[36.48358627  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.73564055e-04 -1.72448045e-02  5.82555223e-01]
Stock Position:  0.0003735640545304833
Bond Position:  [7.99653008]


portfolio before change:  [8.0319948]
curr_Stock_Price:  92.26019254906716
curr_Factors:  [ 9.22601925e+01 -3.11687651e-02 -8.40025637e-01]
mat_Sqrt:  [[38.60641147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00569991 -0.03626651 -0.20702249]
Stock Position:  -0.005699907442371861
Bond Position:  [8.55786936]


portfolio before change:  [8.02682766]
curr_Stock_Price:  93.35441057348994
curr_Factors:  [ 9.33544106e+01 -6.56113848e-02 -8.52371665e-01]
mat_Sqrt:  [[37.27862352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357003  0.05538024  0.91824644]
Stock Position:  -0.0035700326841337847
Bond Position:  [8.36010596]


portfolio before change:  [8.02757941]
curr_Stock_Price:  93.43657399115692
curr_Factors:  [ 9.34365740e+01 -5.93916422e-02 -8.43863727e-01]
mat_Sqrt:  [[37.86501065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00549167 0.04088732 0.84893867]
Stock Position:  0.005491665582375375
Bond Position:  [7.514457]


portfolio before change:  [8.03843687]
curr_Stock_Price:  95.24259922521478
curr_Factors:  [ 9.52425992e+01 -8.28153275e-02 -8.75930883e-01]
mat_Sqrt:  [[36.51346519  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00386843  0.03997473 -0.07637104]
Stock Position:  -0.003868432361849549
Bond Position:  [8.40687642]


portfolio before change:  [8.03576018]
curr_Stock_Price:  96.20619650103147
curr_Factors:  [ 9.62061965e+01 -2.16674770e-02 -8.94536939e-01]
mat_Sqrt:  [[38.48580039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113852 -0.00644182 -0.20474603]
Stock Position:  0.001138520261920318
Bond Position:  [7.92622748]


portfolio before change:  [8.03884374]
curr_Stock_Price:  98.0442988400674
curr_Factors:  [ 9.80442988e+01  3.75025522e-02 -8.85240327e-01]
mat_Sqrt:  [[42.00050451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047022  0.00246041 -0.14870474]
Stock Position:  -0.000470221063436955
Bond Position:  [8.08494623]


portfolio before change:  [8.04092603]
curr_Stock_Price:  95.76534159824013
curr_Factors:  [95.7653416  -0.17496048 -0.88113472]
mat_Sqrt:  [[33.30826765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00093779 0.01154841 0.23319911]
Stock Position:  0.0009377927704962258
Bond Position:  [7.95111799]


portfolio before change:  [8.04338602]
curr_Stock_Price:  97.3286225663697
curr_Factors:  [97.32862257 -0.2232036  -0.90755518]
mat_Sqrt:  [[31.41653449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194726 -0.00606614 -0.01638959]
Stock Position:  -0.0019472638818201092
Bond Position:  [8.23291053]


portfolio before change:  [8.0454371]
curr_Stock_Price:  96.8038314567993
curr_Factors:  [ 9.68038315e+01 -1.06182320e-02 -8.62117448e-01]
mat_Sqrt:  [[40.44531824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221697  0.02261193  0.06565608]
Stock Position:  -0.002216965196394992
Bond Position:  [8.26004783]


portfolio before change:  [8.0420288]
curr_Stock_Price:  98.80696169427797
curr_Factors:  [98.80696169 -0.13979415 -0.88019671]
mat_Sqrt:  [[35.62961599  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430717 -0.02324183 -0.23893662]
Stock Position:  -0.004307166867179694
Bond Position:  [8.46760687]


portfolio before change:  [8.04116528]
curr_Stock_Price:  99.2532039189163
curr_Factors:  [99.25320392 -0.14197298 -0.88995199]
mat_Sqrt:  [[35.36594068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07523743 0.48189104 0.4829657 ]
Stock Position:  0.0752374280589134
Bond Position:  [0.57360949]


portfolio before change:  [7.97125177]
curr_Stock_Price:  98.323012358534
curr_Factors:  [98.32301236 -0.1161295  -0.89461494]
mat_Sqrt:  [[35.78445768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146884  0.00643643  0.05160096]
Stock Position:  -0.001468844817564967
Bond Position:  [8.11567301]


portfolio before change:  [7.96744195]
curr_Stock_Price:  101.60745913822585
curr_Factors:  [101.60745914  -0.14733766  -0.908079  ]
mat_Sqrt:  [[35.36420983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00033052 -0.00434329 -0.2845359 ]
Stock Position:  0.00033051825424401383
Bond Position:  [7.93385883]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.96937063]
Stock Price:  104.44206190876903
PL:  [3.52730872]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-3.87354217e-02 -4.60376929e-02  2.80144196e-01]
 [ 3.01025095e-01  2.09886703e-01  7.98426227e-02]
 [-4.64091593e-01 -3.40716334e-01  4.33335130e-02]
 [ 2.81310386e-01  1.82607540e+00  1.74999873e+00]
 [-4.97613220e-02 -2.19875442e-02 -1.77091654e-03]
 [-5.64676809e-02  4.46618934e-01 -2.17023232e-01]
 [-2.60257086e-01  3.88136216e-01  5.46980370e-01]
 [-3.67578758e-02  6.75043386e-02  2.35694045e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 6.52405387e-01  1.39898029e+00 -1.92020381e-01]
 [-1.11434742e-03  3.45439774e-02  9.45404638e-02]
 [-4.60241076e-01 -3.35364025e-02 -1.08230608e+00]
 [ 2.02305378e+00 -3.32516164e+00  2.81638915e+00]
 [ 2.96587288e-02 -8.26177515e-02  1.82076804e-02]
 [ 6.95914106e-02  9.32286335e-02 -6.35769864e-02]
 [-4.72674698e-02  1.85948348e-02 -7.18431060e-02]
 [-2.79583251e-01 -1.80591858e+00 -1.97760464e-01]
 [ 1.19327454e-02  1.87038729e-02  3.59833387e-03]
 [ 1.20071840e-01  6.43433528e-02  2.91427740e-01]
 [ 2.82015815e-02 -1.99175323e-02  3.00790094e-02]
 [ 1.05392409e-01 -5.04823898e-02  2.31014625e-02]
 [ 3.94412373e-01  1.11975618e-02  1.13454866e-01]
 [-6.79700560e-02 -4.81993679e-02  7.73101943e-02]
 [ 5.10824767e-02 -3.89253660e-02 -2.95501612e-03]
 [ 5.25853934e-02 -4.11879939e-02  2.95996435e-01]
 [-2.03538208e-01 -1.37605518e-01 -7.43984914e-02]
 [-1.81690784e-01  1.31108196e-01  2.60220023e-01]
 [ 4.25368517e-02  5.81823817e-02  2.44166430e-01]
 [-1.59787224e-01  1.13587349e-01 -8.80833520e-02]
 [ 1.50658896e-01  2.05314608e-02  5.58296980e-02]
 [ 1.46786462e-01 -3.17082116e-03 -8.97576224e-02]
 [ 2.26567085e-01  1.65002074e-01  1.91858640e-01]
 [-5.06304770e-03 -3.76679260e-02  1.18338405e-02]
 [-9.78834481e-02  1.27645547e-01  2.42926494e-02]
 [-1.00177929e-01 -5.67213901e-02 -6.36069472e-02]
 [ 1.38248805e+00  9.06636091e-01  1.32958089e-01]
 [ 2.92955044e-01 -4.94309863e-01  1.18297950e-01]
 [ 2.73479177e-02 -1.54780892e-02  7.48279049e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.20830636]
curr_Stock_Price:  98.96069783982709
curr_Factors:  [98.96069784 -0.76661456 -0.99119053]
mat_Sqrt:  [[17.06309057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.30464753e-04 -1.48586015e-02  7.99173413e-01]
Stock Position:  0.0005304647528348248
Bond Position:  [-5.26080152]


portfolio before change:  [-5.20921518]
curr_Stock_Price:  98.48718914755605
curr_Factors:  [98.48718915 -0.92888362 -1.00008111]
mat_Sqrt:  [[14.31004507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02516874 0.06774064 0.22776878]
Stock Position:  0.025168742934659306
Bond Position:  [-7.68801393]


portfolio before change:  [-5.2146618]
curr_Stock_Price:  98.30896975514123
curr_Factors:  [98.30896976 -0.64197631 -0.99607082]
mat_Sqrt:  [[19.10725559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02746572 -0.10996572  0.12361845]
Stock Position:  -0.027465723931084627
Bond Position:  [-2.51453478]


portfolio before change:  [-5.1971078]
curr_Stock_Price:  97.658400966476
curr_Factors:  [97.65840097 -0.91801124 -1.00035955]
mat_Sqrt:  [[14.34074649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07051749 0.5893633  4.99225927]
Stock Position:  0.07051749093333624
Bond Position:  [-12.0837332]


portfolio before change:  [-5.18766178]
curr_Stock_Price:  97.81377480750457
curr_Factors:  [97.81377481 -1.05155418 -0.99106849]
mat_Sqrt:  [[12.68528608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430507 -0.00709645 -0.00505193]
Stock Position:  -0.004305066289291688
Bond Position:  [-4.766567]


portfolio before change:  [-5.18215772]
curr_Stock_Price:  96.39685765579048
curr_Factors:  [96.39685766 -1.0000728  -0.97167226]
mat_Sqrt:  [[13.41976398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071549  0.14414564 -0.61910687]
Stock Position:  -0.0007154861001389373
Bond Position:  [-5.11318711]


portfolio before change:  [-5.1825037]
curr_Stock_Price:  95.98706053608012
curr_Factors:  [95.98706054 -1.04641314 -0.96944837]
mat_Sqrt:  [[12.7860136   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00542602  0.12527042  1.56038274]
Stock Position:  -0.005426023628452124
Bond Position:  [-4.66167565]


portfolio before change:  [-5.18615678]
curr_Stock_Price:  96.55291352850782
curr_Factors:  [96.55291353 -1.04865581 -0.98695396]
mat_Sqrt:  [[12.60988978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144074  0.02178693  0.06723695]
Stock Position:  -0.0014407362898987228
Bond Position:  [-5.0470495]


portfolio before change:  [-5.18732435]
curr_Stock_Price:  96.92539454918433
curr_Factors:  [96.92539455 -1.15757175 -0.98890755]
mat_Sqrt:  [[11.3300927   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00458877  0.0064198  -0.11330016]
Stock Position:  0.0045887712233883575
Bond Position:  [-5.63209281]


portfolio before change:  [-5.18900623]
curr_Stock_Price:  96.71230305522434
curr_Factors:  [96.71230306 -1.40633405 -0.99490254]
mat_Sqrt:  [[ 8.76269966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [9.97488538e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  9.974885376756727e-05
Bond Position:  [-5.19865317]


portfolio before change:  [-5.18964831]
curr_Stock_Price:  96.79045531474827
curr_Factors:  [96.79045531 -1.12697984 -0.99901966]
mat_Sqrt:  [[11.5484229   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07782665  0.45151895 -0.5477807 ]
Stock Position:  0.0778266482953203
Bond Position:  [-12.72252503]


portfolio before change:  [-5.21147702]
curr_Stock_Price:  96.53041209094947
curr_Factors:  [96.53041209 -1.01213441 -1.01083442]
mat_Sqrt:  [[12.76732639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00197652 0.01114902 0.26969763]
Stock Position:  0.0019765221820911916
Bond Position:  [-5.40227152]


portfolio before change:  [-5.21155905]
curr_Stock_Price:  96.83058510829882
curr_Factors:  [96.83058511 -0.96353717 -1.02303888]
mat_Sqrt:  [[13.28169624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05180148 -0.01082383 -3.087518  ]
Stock Position:  -0.05180147607162641
Bond Position:  [-0.19559181]


portfolio before change:  [-5.26737919]
curr_Stock_Price:  97.90769130898599
curr_Factors:  [97.90769131 -1.20144116 -0.99405726]
mat_Sqrt:  [[10.89742677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.17611507 -1.07319131  8.03437431]
Stock Position:  0.17611506537095695
Bond Position:  [-22.51039864]


portfolio before change:  [-5.11131437]
curr_Stock_Price:  98.8098219285896
curr_Factors:  [98.80982193 -1.15102897 -0.98323216]
mat_Sqrt:  [[11.69236283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141213 -0.02666476  0.05194144]
Stock Position:  0.001412125023928936
Bond Position:  [-5.25084619]


portfolio before change:  [-5.11185757]
curr_Stock_Price:  98.88998366358001
curr_Factors:  [98.88998366 -1.26367719 -0.99163734]
mat_Sqrt:  [[10.36768158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00729614  0.03008941 -0.18136745]
Stock Position:  0.007296137244907745
Bond Position:  [-5.83337246]


portfolio before change:  [-5.10780329]
curr_Stock_Price:  99.54560358130733
curr_Factors:  [99.54560358 -1.22396981 -0.99101189]
mat_Sqrt:  [[10.86595133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00535036  0.00600146 -0.20494838]
Stock Position:  -0.0053503578133834604
Bond Position:  [-4.57519869]


portfolio before change:  [-5.10735721]
curr_Stock_Price:  99.3553323325417
curr_Factors:  [99.35533233 -0.85594912 -0.98764653]
mat_Sqrt:  [[15.72272295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04379537 -0.58285772 -0.56415556]
Stock Position:  -0.04379537345886956
Bond Position:  [-0.75605332]


portfolio before change:  [-5.09440607]
curr_Stock_Price:  99.05745494375383
curr_Factors:  [99.05745494 -0.65298529 -0.9807444 ]
mat_Sqrt:  [[19.33603283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00085256 0.00603665 0.01026504]
Stock Position:  0.0008525618679539966
Bond Position:  [-5.17885868]


portfolio before change:  [-5.09448936]
curr_Stock_Price:  99.71911603340915
curr_Factors:  [99.71911603 -0.59043006 -0.96782568]
mat_Sqrt:  [[20.99116546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00917973 0.02076673 0.83136223]
Stock Position:  0.009179733772988486
Bond Position:  [-6.0098843]


portfolio before change:  [-5.10915692]
curr_Stock_Price:  98.20313793207274
curr_Factors:  [98.20313793 -0.39148998 -1.00231754]
mat_Sqrt:  [[24.36702159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124249 -0.00642836  0.08580704]
Stock Position:  0.0012424901524946805
Bond Position:  [-5.23117335]


portfolio before change:  [-5.10879381]
curr_Stock_Price:  99.02169090281558
curr_Factors:  [99.0216909  -0.27373218 -0.99876322]
mat_Sqrt:  [[27.73911524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00359793 -0.01629312  0.06590204]
Stock Position:  0.0035979265851336486
Bond Position:  [-5.46506659]


portfolio before change:  [-5.1088896]
curr_Stock_Price:  99.18494825395967
curr_Factors:  [99.18494825 -0.21863484 -1.03869857]
mat_Sqrt:  [[28.20933269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01488362 0.003614   0.32365515]
Stock Position:  0.014883618401628124
Bond Position:  [-6.58512052]


portfolio before change:  [-5.12342826]
curr_Stock_Price:  98.26343360262301
curr_Factors:  [98.2634336  -0.37776626 -1.02422041]
mat_Sqrt:  [[24.18337237  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0025649  -0.01555628  0.22054447]
Stock Position:  -0.002564895931855626
Bond Position:  [-4.87139278]


portfolio before change:  [-5.12458469]
curr_Stock_Price:  98.47687906755087
curr_Factors:  [98.47687907 -0.7126022  -1.03889106]
mat_Sqrt:  [[17.08718094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00248922 -0.01256311 -0.00842984]
Stock Position:  0.0024892157251198248
Bond Position:  [-5.36971489]


portfolio before change:  [-5.12702496]
curr_Stock_Price:  97.76620725481347
curr_Factors:  [97.76620725 -0.58967059 -1.03739821]
mat_Sqrt:  [[19.21152158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00544454 -0.01329337  0.84439544]
Stock Position:  0.0054445426488109825
Bond Position:  [-5.65931725]


portfolio before change:  [-5.13192705]
curr_Stock_Price:  96.99577961972871
curr_Factors:  [96.99577962 -0.54833458 -1.05122944]
mat_Sqrt:  [[19.59164994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01259788 -0.04441199 -0.21223819]
Stock Position:  -0.012597884617616394
Bond Position:  [-3.90998541]


portfolio before change:  [-5.11839045]
curr_Stock_Price:  95.88246737112432
curr_Factors:  [95.88246737 -0.30180292 -1.02077656]
mat_Sqrt:  [[25.54760736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00398516  0.04231499  0.7423353 ]
Stock Position:  -0.0039851577668329275
Bond Position:  [-4.73628369]


portfolio before change:  [-5.11763508]
curr_Stock_Price:  95.54435161558258
curr_Factors:  [ 9.55443516e+01  2.17464390e-02 -1.04255510e+00]
mat_Sqrt:  [[34.42496052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00302843 0.01877828 0.69653886]
Stock Position:  0.0030284288722465915
Bond Position:  [-5.40698435]


portfolio before change:  [-5.12450558]
curr_Stock_Price:  93.49887122244698
curr_Factors:  [ 9.34988712e+01  9.29859703e-02 -1.02708224e+00]
mat_Sqrt:  [[36.73952282  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00420749  0.03666016 -0.25127729]
Stock Position:  -0.004207491827549247
Bond Position:  [-4.73110985]


portfolio before change:  [-5.11692748]
curr_Stock_Price:  91.55720998612169
curr_Factors:  [91.55720999  0.142282   -1.01816992]
mat_Sqrt:  [[38.13284948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00435965 0.0066265  0.15926659]
Stock Position:  0.004359654600981189
Bond Position:  [-5.5160853]


portfolio before change:  [-5.11604428]
curr_Stock_Price:  91.9179621826641
curr_Factors:  [91.91796218  0.19675388 -1.01903961]
mat_Sqrt:  [[40.391151    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316449 -0.00102338 -0.25605351]
Stock Position:  0.003164493194988918
Bond Position:  [-5.40691805]


portfolio before change:  [-5.12253663]
curr_Stock_Price:  90.07993046506698
curr_Factors:  [90.07993047  0.09092099 -0.98503255]
mat_Sqrt:  [[36.84005983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00812732 0.05325419 0.5473193 ]
Stock Position:  0.008127320500827432
Bond Position:  [-5.85464509]


portfolio before change:  [-5.10070271]
curr_Stock_Price:  92.85646582062932
curr_Factors:  [ 9.28564658e+01  5.93368549e-03 -1.01019244e+00]
mat_Sqrt:  [[34.01481502  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030388 -0.01215727  0.03375865]
Stock Position:  -0.00030387959851283126
Bond Position:  [-5.07248553]


portfolio before change:  [-5.10133199]
curr_Stock_Price:  92.84060177573993
curr_Factors:  [ 9.28406018e+01 -8.61546435e-03 -1.05305780e+00]
mat_Sqrt:  [[32.11139016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208241  0.04119742  0.06930017]
Stock Position:  -0.0020824135387965824
Bond Position:  [-4.90799947]


portfolio before change:  [-5.10254079]
curr_Stock_Price:  93.12645150903967
curr_Factors:  [93.12645151  0.37651906 -1.05896917]
mat_Sqrt:  [[47.06398938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00265043 -0.01830675 -0.18145292]
Stock Position:  -0.002650430823060553
Bond Position:  [-4.85571557]


portfolio before change:  [-5.09554597]
curr_Stock_Price:  90.2583079308896
curr_Factors:  [90.25830793  0.326172   -1.06214761]
mat_Sqrt:  [[43.23714853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0368825  0.29261554 0.37929242]
Stock Position:  0.03688250453496819
Bond Position:  [-8.42449843]


portfolio before change:  [-5.21875423]
curr_Stock_Price:  86.94630042547924
curr_Factors:  [86.94630043  0.35025844 -1.07246443]
mat_Sqrt:  [[42.22805038  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00511987 -0.15953782  0.33747112]
Stock Position:  0.005119865402378963
Bond Position:  [-5.66390759]


portfolio before change:  [-5.20133217]
curr_Stock_Price:  90.48742852196965
curr_Factors:  [90.48742852  0.35443159 -1.06269077]
mat_Sqrt:  [[44.56513133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00057704 -0.00499553  0.02134632]
Stock Position:  0.0005770404664708283
Bond Position:  [-5.25354708]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.20371203]
Stock Price:  87.50127903152077
PL:  [-5.20371203]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.57414774e-01 -1.28475066e-02 -1.70434538e-01]
 [ 1.45472988e+00  2.90770214e-01  4.57956233e-01]
 [-2.45360132e-01 -1.39378540e-01  3.69534281e-02]
 [ 1.94907345e-01  1.56166086e+00  1.26312574e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-7.28688088e-03  1.72552369e-01 -6.28419206e-02]
 [-1.08136846e-01  1.56138499e-01  3.86315218e-02]
 [-4.92926175e-02  9.36178940e-02  1.29846047e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-1.67669838e-01 -9.15220600e-02 -6.22692572e-02]
 [ 8.09794918e-01  1.55658324e+00 -2.82329753e-01]
 [-1.81714388e-04  3.28427504e-02 -5.84241108e-02]
 [-2.21088934e-01 -4.22910112e-03 -4.42774975e-01]
 [ 1.73879769e+00 -3.34765485e+00  2.81009690e+00]
 [-2.34063665e-03 -9.33341121e-02  3.64559558e-02]
 [ 1.28012455e-01 -6.11678103e-02  8.16950945e-03]
 [-1.53125710e-01 -2.06680429e-01 -2.95749702e-02]
 [-2.59673680e-01 -1.70328995e+00 -2.01644435e-01]
 [ 1.13966540e-03  3.67954901e-02  6.11081143e-02]
 [ 2.67097653e-01 -4.14670127e-01  2.36933550e-01]
 [ 5.12669909e-02  3.15811343e-02  4.74120519e-02]
 [ 1.51660539e-01 -5.47933966e-02 -1.84556921e-02]
 [ 2.05943683e-01  1.37840445e-01  1.55658406e-01]
 [-2.67200784e-01  9.68442785e-02  1.86196888e-02]
 [-2.78553302e-02 -1.76321192e-01  6.11887025e-02]
 [ 7.63109977e-02 -1.43306097e-02  4.18838498e-02]
 [ 2.46138464e-01 -7.36939721e-02  1.13464630e-01]
 [-7.81924612e-04 -7.15575778e-02  2.24242038e-02]
 [-9.99163729e-03 -7.54106347e-02 -3.95680084e-03]
 [ 3.09841770e-02  2.06718258e-02  1.05946560e-01]
 [-2.02823394e-02 -3.49410320e-02 -5.23686895e-02]
 [ 1.98842581e-03  2.16880400e-02 -5.99160381e-02]
 [-1.01190655e-01 -4.34070888e-02  1.93656157e-02]
 [ 2.40020939e-01  1.91795147e-02  4.85119016e-02]
 [ 3.86343852e-02 -9.79609064e-03 -1.19610218e-03]
 [-1.19531428e-01 -7.01947760e-02 -8.17925114e-02]
 [ 1.71352955e+00  1.12053496e+00  1.47164669e-01]
 [-3.05543571e-02 -7.84702137e-02 -2.04520575e-02]
 [ 3.31409480e-02 -1.42199906e-02 -7.26730580e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.84048915]
curr_Stock_Price:  101.01428054574082
curr_Factors:  [101.01428055  -1.19020967  -1.00978976]
mat_Sqrt:  [[11.19270768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01072149 -0.00414651 -0.4862023 ]
Stock Position:  0.010721488165675181
Bond Position:  [8.75746574]


portfolio before change:  [9.8393472]
curr_Stock_Price:  100.80566229491572
curr_Factors:  [100.80566229  -1.28399571  -1.00137871]
mat_Sqrt:  [[10.25556113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.15675037 0.09384568 1.30642166]
Stock Position:  0.15675037240228604
Bond Position:  [-5.9619779]


portfolio before change:  [9.68915923]
curr_Stock_Price:  99.85228224124513
curr_Factors:  [99.85228224 -1.44993615 -1.00956172]
mat_Sqrt:  [[ 8.53515957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03119655 -0.04498423  0.10541784]
Stock Position:  -0.03119655445535039
Bond Position:  [12.80420639]


portfolio before change:  [9.70395459]
curr_Stock_Price:  99.42932746130754
curr_Factors:  [99.42932746 -1.34789095 -1.00793009]
mat_Sqrt:  [[ 9.4274541   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08183699 0.50402388 3.60334615]
Stock Position:  0.08183699300652918
Bond Position:  [1.56695741]


portfolio before change:  [9.70092829]
curr_Stock_Price:  99.38995436447227
curr_Factors:  [99.38995436 -1.13579997 -1.01687906]
mat_Sqrt:  [[11.54638053  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00507917 -0.01106097 -0.05874131]
Stock Position:  -0.005079167519547535
Bond Position:  [10.20574652]


portfolio before change:  [9.70560445]
curr_Stock_Price:  98.72048205221743
curr_Factors:  [98.72048205 -1.09865897 -1.03196631]
mat_Sqrt:  [[11.72434175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128857  0.05569104 -0.17927051]
Stock Position:  0.0012885730361844815
Bond Position:  [9.5783959]


portfolio before change:  [9.7066999]
curr_Stock_Price:  98.64138116069441
curr_Factors:  [98.64138116 -0.98055786 -1.0073956 ]
mat_Sqrt:  [[13.51144899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00506086  0.05039348  0.11020498]
Stock Position:  -0.005060862232504977
Bond Position:  [10.20591034]


portfolio before change:  [9.7122246]
curr_Stock_Price:  97.80182435291007
curr_Factors:  [97.80182435 -0.91694616 -1.00834296]
mat_Sqrt:  [[14.26279079  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193037  0.03021505  0.03704146]
Stock Position:  -0.0019303707079509004
Bond Position:  [9.90101838]


portfolio before change:  [9.7128343]
curr_Stock_Price:  98.12715382922615
curr_Factors:  [98.12715383 -0.98500366 -1.00098248]
mat_Sqrt:  [[13.46748127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0038605   0.0064198  -0.11330016]
Stock Position:  0.0038604993974353263
Bond Position:  [9.33401448]


portfolio before change:  [9.72321598]
curr_Stock_Price:  100.51411394560724
curr_Factors:  [100.51411395  -1.29931105  -1.01047618]
mat_Sqrt:  [[ 9.97927988  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01994757 -0.02953862 -0.17763686]
Stock Position:  -0.019947567511959197
Bond Position:  [11.72822806]


portfolio before change:  [9.7157412]
curr_Stock_Price:  100.96233439519547
curr_Factors:  [100.9623344   -1.12162388  -1.00939831]
mat_Sqrt:  [[11.98583251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08926379  0.50238508 -0.8054082 ]
Stock Position:  0.08926378889014835
Bond Position:  [0.70346069]


portfolio before change:  [9.73254033]
curr_Stock_Price:  101.14954581369629
curr_Factors:  [101.14954581  -1.24140419  -0.98416206]
mat_Sqrt:  [[10.92478238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049461  0.01059995 -0.16666773]
Stock Position:  -0.0004946082700036798
Bond Position:  [9.78256974]


portfolio before change:  [9.73348294]
curr_Stock_Price:  101.71624637255032
curr_Factors:  [101.71624637  -1.03513162  -0.98452998]
mat_Sqrt:  [[13.49778275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0231396  -0.00136494 -1.26311376]
Stock Position:  -0.023139597399729702
Bond Position:  [12.08715593]


portfolio before change:  [9.73946636]
curr_Stock_Price:  101.52296584521397
curr_Factors:  [101.52296585  -1.28679194  -0.98312528]
mat_Sqrt:  [[10.4894273   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.15530582 -1.08045096  8.01642427]
Stock Position:  0.1553058224700785
Bond Position:  [-6.02764135]


portfolio before change:  [9.78956751]
curr_Stock_Price:  101.85041433025805
curr_Factors:  [101.85041433  -1.28939352  -0.97749966]
mat_Sqrt:  [[10.55513034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132171 -0.03012346  0.10399869]
Stock Position:  -0.0013217119298906748
Bond Position:  [9.92418442]


portfolio before change:  [9.79003408]
curr_Stock_Price:  102.43604753266402
curr_Factors:  [102.43604753  -1.12526434  -0.99742137]
mat_Sqrt:  [[12.26258757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00955705 -0.01974183  0.02330534]
Stock Position:  0.009557054824584413
Bond Position:  [8.81104715]


portfolio before change:  [9.79457674]
curr_Stock_Price:  102.79611781685446
curr_Factors:  [102.79611782  -0.92196625  -0.99542529]
mat_Sqrt:  [[15.10998894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0133257  -0.06670582 -0.08436916]
Stock Position:  -0.013325697450334167
Bond Position:  [11.1644067]


portfolio before change:  [9.78790338]
curr_Stock_Price:  103.40163906084956
curr_Factors:  [103.40163906  -1.05167906  -1.00259411]
mat_Sqrt:  [[13.2546395   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04892753 -0.54973447 -0.57523545]
Stock Position:  -0.048927530849838106
Bond Position:  [14.84709027]


portfolio before change:  [9.81738583]
curr_Stock_Price:  102.83699889627482
curr_Factors:  [102.8369989   -0.67963039  -1.01182365]
mat_Sqrt:  [[18.94786303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00111486 0.01187569 0.17432444]
Stock Position:  0.0011148568543468513
Bond Position:  [9.7027373]


portfolio before change:  [9.81917889]
curr_Stock_Price:  103.35736982519771
curr_Factors:  [103.35736983  -0.85635695  -1.01593031]
mat_Sqrt:  [[15.8934222   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01452282 -0.13383421  0.67590547]
Stock Position:  0.014522821000526522
Bond Position:  [8.31813831]


portfolio before change:  [9.80650891]
curr_Stock_Price:  102.41335144683711
curr_Factors:  [102.41335145  -0.78472337  -1.02647721]
mat_Sqrt:  [[16.74025848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00402571 0.01019277 0.13525339]
Stock Position:  0.00402570889560722
Bond Position:  [9.39422257]


portfolio before change:  [9.80702597]
curr_Stock_Price:  102.25007804059928
curr_Factors:  [102.25007804  -0.75929893  -1.04899157]
mat_Sqrt:  [[16.76227889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00815573 -0.01768449 -0.05264895]
Stock Position:  0.008155730645901763
Bond Position:  [8.97310188]


portfolio before change:  [9.80261403]
curr_Stock_Price:  101.57157974159487
curr_Factors:  [101.57157974  -0.72607287  -1.04099863]
mat_Sqrt:  [[17.35173089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01532146 0.04448781 0.44405011]
Stock Position:  0.015321461996653258
Bond Position:  [8.24638893]


portfolio before change:  [9.81470337]
curr_Stock_Price:  102.2933433716342
curr_Factors:  [102.29334337  -0.6734609   -1.07246875]
mat_Sqrt:  [[17.84841935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01365005  0.03125636  0.05311679]
Stock Position:  -0.013650049114812764
Bond Position:  [11.21101253]


portfolio before change:  [9.82049739]
curr_Stock_Price:  101.97154558878488
curr_Factors:  [101.97154559  -0.74779056  -1.07878707]
mat_Sqrt:  [[16.41369716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00312889 -0.05690742  0.17455434]
Stock Position:  -0.0031288899039572144
Bond Position:  [10.13955513]


portfolio before change:  [9.82042063]
curr_Stock_Price:  102.4011800692975
curr_Factors:  [102.40118007  -0.58326915  -1.09157456]
mat_Sqrt:  [[19.18357652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00427112 -0.00462518  0.11948297]
Stock Position:  0.004271115929748947
Bond Position:  [9.38305332]


portfolio before change:  [9.81959293]
curr_Stock_Price:  101.93276337580427
curr_Factors:  [101.93276338  -0.57750378  -1.08192589]
mat_Sqrt:  [[19.39244857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01311111 -0.02378463  0.32368301]
Stock Position:  0.013111114617030547
Bond Position:  [8.48314078]


portfolio before change:  [9.82096286]
curr_Stock_Price:  101.95636782546468
curr_Factors:  [101.95636783  -1.01630819  -1.06921138]
mat_Sqrt:  [[12.66731911  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085347 -0.02309511  0.06397001]
Stock Position:  -0.0008534744014690668
Bond Position:  [9.90798001]


portfolio before change:  [9.82150457]
curr_Stock_Price:  102.77287571956474
curr_Factors:  [102.77287572  -0.98375639  -1.10167123]
mat_Sqrt:  [[12.76993841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0020511  -0.02433868 -0.01128765]
Stock Position:  -0.0020511020796358326
Bond Position:  [10.03230223]


portfolio before change:  [9.82415326]
curr_Stock_Price:  102.09296139544836
curr_Factors:  [102.0929614   -0.69368626  -1.0976989 ]
mat_Sqrt:  [[17.02186373  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00333865 0.0066718  0.30223605]
Stock Position:  0.003338650080396796
Bond Position:  [9.48330059]


portfolio before change:  [9.82480275]
curr_Stock_Price:  101.93241734611075
curr_Factors:  [101.93241735  -0.64088881  -1.07494405]
mat_Sqrt:  [[18.32886522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207893 -0.01127717 -0.14939329]
Stock Position:  -0.0020789263952340647
Bond Position:  [10.03671274]


portfolio before change:  [9.82477275]
curr_Stock_Price:  102.5503617788372
curr_Factors:  [102.55036178  -0.74624864  -1.12322865]
mat_Sqrt:  [[15.81370117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036771  0.00699978 -0.17092378]
Stock Position:  -0.0003677084552028728
Bond Position:  [9.86248139]


portfolio before change:  [9.82619213]
curr_Stock_Price:  102.04319124254982
curr_Factors:  [102.04319124  -0.84683271  -1.10508622]
mat_Sqrt:  [[14.49026777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00732202 -0.01400958  0.05524471]
Stock Position:  -0.007322024818950394
Bond Position:  [10.57335491]


portfolio before change:  [9.83059778]
curr_Stock_Price:  101.62201066591562
curr_Factors:  [101.62201067  -0.44627344  -1.11431005]
mat_Sqrt:  [[21.34199375  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01189385 0.00619016 0.13839095]
Stock Position:  0.011893846230465615
Bond Position:  [8.62192121]


portfolio before change:  [9.80242023]
curr_Stock_Price:  99.16230523473695
curr_Factors:  [99.16230523 -0.19450101 -1.10921597]
mat_Sqrt:  [[26.92461626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135157 -0.00316167 -0.00341215]
Stock Position:  0.0013515740704840788
Bond Position:  [9.66839503]


portfolio before change:  [9.80241193]
curr_Stock_Price:  98.26192985060115
curr_Factors:  [98.26192985 -0.256765   -1.07992116]
mat_Sqrt:  [[25.81486529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00583213 -0.02265527 -0.23333127]
Stock Position:  -0.0058321320586708575
Bond Position:  [10.37548848]


portfolio before change:  [9.79888948]
curr_Stock_Price:  99.08829362865451
curr_Factors:  [99.08829363 -0.71289655 -1.068496  ]
mat_Sqrt:  [[16.68681283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11819499 0.3616511  0.41981984]
Stock Position:  0.11819498851151106
Bond Position:  [-1.91285024]


portfolio before change:  [9.77497074]
curr_Stock_Price:  98.88794989581444
curr_Factors:  [98.8879499  -0.90290734 -1.06276085]
mat_Sqrt:  [[13.85047043  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036639  -0.02532615 -0.05834403]
Stock Position:  -0.003663903066669596
Bond Position:  [10.1372866]


portfolio before change:  [9.77700742]
curr_Stock_Price:  98.67794289679256
curr_Factors:  [98.6779429  -1.11944632 -1.06944689]
mat_Sqrt:  [[11.0559444   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139328 -0.00458948 -0.20731601]
Stock Position:  0.0013932757109890953
Bond Position:  [9.63952184]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.77742735]
Stock Price:  98.11445808766379
PL:  [9.77742735]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 2.37097883e-02 -7.21115236e-02  6.14226427e-02]
 [ 1.21059672e+00  2.39517349e-01  3.47961833e-01]
 [-1.71670213e-01 -7.15484913e-02  3.48039982e-02]
 [ 1.35617276e-01  1.03609873e+00  8.66854571e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 1.72228698e-02  4.59399552e-02 -1.19298491e-02]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [-5.42762924e-02  1.04000355e-01  8.77620509e-03]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 9.39603446e-01  1.86866674e+00 -3.10934906e-01]
 [-1.29732741e-03 -3.47809444e-02  1.70536102e-01]
 [-4.04002892e-01 -5.91665884e-04 -8.91834049e-01]
 [ 1.93126129e+00 -2.96563116e+00  2.51536607e+00]
 [ 2.24225043e-02 -6.92704350e-02  2.11668656e-03]
 [ 2.07193462e-02  3.33086666e-01 -1.86177224e-01]
 [ 2.77670823e-02 -2.02631260e-01 -2.21979531e-02]
 [-3.02060089e-01 -1.92170579e+00 -1.93348574e-01]
 [ 3.94573599e-02 -9.84130896e-02  4.23048438e-02]
 [-2.60644486e-01  5.15595415e-01  3.18853155e-01]
 [ 1.59966757e-02  1.14166909e-01 -7.03803148e-02]
 [ 1.28538392e-01 -5.33614758e-02  8.27647482e-02]
 [ 1.08889920e-02 -1.18728839e-01 -1.19117005e-01]
 [-2.67200784e-01  9.68442785e-02  1.86196888e-02]
 [ 1.15270973e-01 -3.39900166e-02 -4.08922889e-02]
 [-4.79415130e-02 -5.88372989e-02  1.63679959e-01]
 [-9.17635517e-02 -1.20615115e-01  2.96766415e-02]
 [-8.82185895e-02 -2.86466234e-02  7.89930906e-02]
 [ 1.98442586e-01  1.11740537e-01  1.66586198e-01]
 [-1.56339277e-01  1.13570868e-01 -8.00703833e-02]
 [ 1.05230504e-01 -3.43266481e-04 -9.95464677e-03]
 [ 1.96802607e-02 -1.95958225e-03 -5.74394590e-02]
 [ 4.61996525e-03  5.46988923e-02  1.08610208e-01]
 [-4.32803492e-03 -4.53077315e-02 -4.16464962e-03]
 [-8.42377465e-02  5.13242598e-02  5.43020866e-02]
 [-1.03774517e-01 -5.86975328e-02 -6.70521275e-02]
 [ 1.79730691e+00  1.16070770e+00  1.48038267e-01]
 [ 1.09210655e-01 -1.57155676e-01  4.16766623e-02]
 [ 3.05449146e-02 -1.49339886e-02 -2.88451638e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.53190888]
curr_Stock_Price:  100.28986319168389
curr_Factors:  [100.28986319  -0.98795088  -1.0348484 ]
mat_Sqrt:  [[13.26680888  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00162269 -0.02327389  0.1752217 ]
Stock Position:  0.001622690868634727
Bond Position:  [4.36916944]


portfolio before change:  [4.53285188]
curr_Stock_Price:  100.53440444603123
curr_Factors:  [100.53440445  -1.01388443  -1.00944717]
mat_Sqrt:  [[13.29208033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10009836 0.07730389 0.99263826]
Stock Position:  0.10009835723620324
Bond Position:  [-5.53047685]


portfolio before change:  [4.5544977]
curr_Stock_Price:  100.75755668140228
curr_Factors:  [100.75755668  -0.82597858  -1.02950551]
mat_Sqrt:  [[15.75618694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01137145 -0.02309218  0.09928612]
Stock Position:  -0.011371447412577151
Bond Position:  [5.70025696]


portfolio before change:  [4.55708506]
curr_Stock_Price:  100.5926888507969
curr_Factors:  [100.59268885  -0.95268192  -1.06402477]
mat_Sqrt:  [[13.38818885  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03914316 0.33439943 2.47289481]
Stock Position:  0.039143158063391005
Bond Position:  [0.61956954]


portfolio before change:  [4.53989458]
curr_Stock_Price:  100.1515406738166
curr_Factors:  [100.15154067  -0.8389379   -1.04135507]
mat_Sqrt:  [[15.27765758  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00383868 -0.01106097 -0.05874131]
Stock Position:  -0.0038386775337763118
Bond Position:  [4.92434405]


portfolio before change:  [4.53975868]
curr_Stock_Price:  100.34730507656798
curr_Factors:  [100.34730508  -0.56114818  -1.04823295]
mat_Sqrt:  [[20.07060062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120401  0.01482706 -0.03403254]
Stock Position:  0.0012040074999302318
Bond Position:  [4.41893978]


portfolio before change:  [4.53940536]
curr_Stock_Price:  99.59504249416653
curr_Factors:  [99.59504249 -0.34689941 -1.04620575]
mat_Sqrt:  [[24.72975628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268059 -0.00251018 -0.21167328]
Stock Position:  -0.002680589415691894
Bond Position:  [4.80637877]


portfolio before change:  [4.54140896]
curr_Stock_Price:  99.07173676500209
curr_Factors:  [99.07173677 -0.53708035 -1.03977883]
mat_Sqrt:  [[20.47050407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152687  0.03356597  0.02503607]
Stock Position:  -0.0015268736582727534
Bond Position:  [4.69267898]


portfolio before change:  [4.5421757]
curr_Stock_Price:  98.95377353742455
curr_Factors:  [98.95377354 -0.53863922 -1.03950584]
mat_Sqrt:  [[20.41985567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00254611  0.0064198  -0.11330016]
Stock Position:  0.0025461102261573093
Bond Position:  [4.29022848]


portfolio before change:  [4.54123989]
curr_Stock_Price:  98.37558924335012
curr_Factors:  [98.37558924 -0.52354275 -1.03324116]
mat_Sqrt:  [[20.73885063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.21464652e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  4.214646523799851e-05
Bond Position:  [4.5370937]


portfolio before change:  [4.54181833]
curr_Stock_Price:  98.64298887045547
curr_Factors:  [98.64298887 -0.37230494 -1.04511879]
mat_Sqrt:  [[23.90489929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05260738  0.6031096  -0.88701074]
Stock Position:  0.05260738014674508
Bond Position:  [-0.64753089]


portfolio before change:  [4.48258272]
curr_Stock_Price:  97.5185332602901
curr_Factors:  [97.51853326 -0.51618924 -1.02010897]
mat_Sqrt:  [[20.98366408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125877 -0.0112255   0.48649203]
Stock Position:  0.0012587686254375433
Bond Position:  [4.35982945]


portfolio before change:  [4.48402338]
curr_Stock_Price:  98.23005823822915
curr_Factors:  [98.23005824 -0.44666763 -1.00326282]
mat_Sqrt:  [[23.04345587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.54375269e-02 -1.90959343e-04 -2.54415430e+00]
Stock Position:  -0.025437526884504513
Bond Position:  [6.98275312]


portfolio before change:  [4.50532705]
curr_Stock_Price:  97.42688350178014
curr_Factors:  [97.4268835  -0.51868528 -0.96762173]
mat_Sqrt:  [[22.03859366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08346047 -0.95715334  7.17563927]
Stock Position:  0.08346046659293918
Bond Position:  [-3.6259661]


portfolio before change:  [4.4222881]
curr_Stock_Price:  96.43736498812933
curr_Factors:  [96.43736499 -0.36688131 -0.94719437]
mat_Sqrt:  [[25.91489889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00033629 -0.02235694  0.00603832]
Stock Position:  0.0003362854251428398
Bond Position:  [4.38985762]


portfolio before change:  [4.42243293]
curr_Stock_Price:  95.23617639773641
curr_Factors:  [95.2361764  -0.37798583 -0.94282619]
mat_Sqrt:  [[25.42029436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00199475  0.10750326 -0.5311118 ]
Stock Position:  0.0019947491489507585
Bond Position:  [4.23246065]


portfolio before change:  [4.42187031]
curr_Stock_Price:  94.68888384111911
curr_Factors:  [94.68888384 -0.52039992 -0.93875723]
mat_Sqrt:  [[22.00873592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00082358 -0.06539896 -0.06332458]
Stock Position:  -0.0008235815454253766
Bond Position:  [4.49985432]


portfolio before change:  [4.42236452]
curr_Stock_Price:  94.77182211644457
curr_Factors:  [94.77182212 -0.49296833 -0.9250129 ]
mat_Sqrt:  [[22.95396995  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03196805 -0.62022788 -0.55156966]
Stock Position:  -0.03196805408322647
Bond Position:  [7.45203525]


portfolio before change:  [4.43275004]
curr_Stock_Price:  94.47609074245602
curr_Factors:  [94.47609074 -0.51801591 -0.95037666]
mat_Sqrt:  [[21.75740644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128712 -0.03176269  0.12068394]
Stock Position:  0.0012871162889591483
Bond Position:  [4.31114832]


portfolio before change:  [4.4328762]
curr_Stock_Price:  94.15539838617815
curr_Factors:  [94.15539839 -1.00923806 -0.96606658]
mat_Sqrt:  [[13.06114716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00691466  0.1664077   0.9095993 ]
Stock Position:  -0.006914659465487744
Bond Position:  [5.08392871]


portfolio before change:  [4.43606001]
curr_Stock_Price:  93.78686464229098
curr_Factors:  [93.78686464 -1.27337337 -0.9962911 ]
mat_Sqrt:  [[ 9.69257702  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00257254  0.03684721 -0.20077545]
Stock Position:  0.002572543595821335
Bond Position:  [4.19478921]


portfolio before change:  [4.43656989]
curr_Stock_Price:  93.78122761939042
curr_Factors:  [93.78122762 -1.17050726 -0.99752277]
mat_Sqrt:  [[10.72883176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01254007 -0.01722234  0.23610479]
Stock Position:  0.012540070839480385
Bond Position:  [3.26054665]


portfolio before change:  [4.43414003]
curr_Stock_Price:  93.55495682084906
curr_Factors:  [93.55495682 -1.15450541 -0.97824755]
mat_Sqrt:  [[11.08725312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339679 -0.03831957 -0.33980766]
Stock Position:  -0.0033967915494110515
Bond Position:  [4.75192672]


portfolio before change:  [4.43626101]
curr_Stock_Price:  93.10542888811726
curr_Factors:  [93.10542889 -1.54076005 -0.98469413]
mat_Sqrt:  [[ 7.45047895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03270015  0.03125636  0.05311679]
Stock Position:  -0.032700152880756395
Bond Position:  [7.48082277]


portfolio before change:  [4.44067008]
curr_Stock_Price:  92.99919383982629
curr_Factors:  [92.99919384 -1.35852193 -0.99207709]
mat_Sqrt:  [[ 8.86394394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01128004 -0.01097023 -0.11665432]
Stock Position:  0.0112800449294833
Bond Position:  [3.39163499]


portfolio before change:  [4.44938281]
curr_Stock_Price:  93.73400895481092
curr_Factors:  [93.73400895 -1.35747899 -0.98969873]
mat_Sqrt:  [[ 8.96459883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029606  -0.01898966  0.46693336]
Stock Position:  -0.002960600362622902
Bond Position:  [4.72689175]


portfolio before change:  [4.44932597]
curr_Stock_Price:  93.95279262189686
curr_Factors:  [93.95279262 -1.42563998 -0.95893515]
mat_Sqrt:  [[ 8.65569354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01274609 -0.03892836  0.0846592 ]
Stock Position:  -0.012746094721218924
Bond Position:  [5.64685717]


portfolio before change:  [4.45567634]
curr_Stock_Price:  93.50995419528937
curr_Factors:  [93.5099542  -1.41199388 -0.93371438]
mat_Sqrt:  [[ 8.95632188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00870242 -0.00924566  0.2253453 ]
Stock Position:  -0.00870241835148643
Bond Position:  [5.26943908]


portfolio before change:  [4.4544797]
curr_Stock_Price:  93.7231540597149
curr_Factors:  [93.72315406 -1.37006309 -0.94382079]
mat_Sqrt:  [[ 9.26701562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02754455 0.0360641  0.47522405]
Stock Position:  0.027544551929426262
Bond Position:  [1.87291742]


portfolio before change:  [4.46937059]
curr_Stock_Price:  94.25526502379562
curr_Factors:  [94.25526502 -1.40012437 -0.95918134]
mat_Sqrt:  [[ 8.90578417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01678696  0.03665484 -0.22841852]
Stock Position:  -0.016786957380045802
Bond Position:  [6.05162971]


portfolio before change:  [4.47218351]
curr_Stock_Price:  94.13276414740027
curr_Factors:  [94.13276415 -1.22524076 -0.95242171]
mat_Sqrt:  [[10.66581427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00966907 -0.00011079 -0.02839784]
Stock Position:  0.009669065031319916
Bond Position:  [3.56200769]


portfolio before change:  [4.47178583]
curr_Stock_Price:  94.0455831221175
curr_Factors:  [94.04558312 -1.25272591 -0.97124618]
mat_Sqrt:  [[10.17371575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074265 -0.00063245 -0.16385879]
Stock Position:  0.0007426472671873726
Bond Position:  [4.40194313]


portfolio before change:  [4.47259813]
curr_Stock_Price:  94.39840941869674
curr_Factors:  [94.39840942 -1.24165319 -0.96993795]
mat_Sqrt:  [[10.33910269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00367104 0.01765399 0.30983469]
Stock Position:  0.003671043499053476
Bond Position:  [4.12605746]


portfolio before change:  [4.47241468]
curr_Stock_Price:  94.20793513826871
curr_Factors:  [94.20793514 -1.11441731 -0.97078161]
mat_Sqrt:  [[11.70838786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00123215 -0.01462301 -0.01188059]
Stock Position:  -0.0012321544689634957
Bond Position:  [4.58849341]


portfolio before change:  [4.4730357]
curr_Stock_Price:  94.16944993732895
curr_Factors:  [94.16944994 -1.0757022  -0.95438925]
mat_Sqrt:  [[12.36666278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00506821  0.01656483  0.15490874]
Stock Position:  -0.005068211196929168
Bond Position:  [4.95030636]


portfolio before change:  [4.46878444]
curr_Stock_Price:  95.13035735888131
curr_Factors:  [95.13035736 -1.05909213 -0.98227857]
mat_Sqrt:  [[12.35273418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0104789  -0.01894455 -0.19128106]
Stock Position:  -0.010478899415892369
Bond Position:  [5.46564589]


portfolio before change:  [4.47000728]
curr_Stock_Price:  95.07886476790651
curr_Factors:  [95.07886477 -1.17183266 -0.98068816]
mat_Sqrt:  [[11.04729817  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.18687407 0.3746168  0.42231197]
Stock Position:  0.18687406942235
Bond Position:  [-13.2977671]


portfolio before change:  [4.47990744]
curr_Stock_Price:  95.14073792716239
curr_Factors:  [95.14073793 -1.37537115 -0.96497881]
mat_Sqrt:  [[ 9.16147589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00934769 -0.05072178  0.11889192]
Stock Position:  0.009347686067941369
Bond Position:  [3.59056169]


portfolio before change:  [4.48239638]
curr_Stock_Price:  95.35898302488614
curr_Factors:  [95.35898302 -1.29223331 -0.96146234]
mat_Sqrt:  [[10.01368722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0021579  -0.00481992 -0.08228722]
Stock Position:  0.0021578996877681194
Bond Position:  [4.27662126]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.48458734]
Stock Price:  96.12656098952394
PL:  [4.48458734]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 2.13202256e-02 -5.08155519e-02  1.26857013e-01]
 [ 8.33639317e-01  2.18709075e-01  2.24033058e-01]
 [-3.26000389e-01 -2.13606232e-01  3.93055895e-02]
 [ 2.05333997e-01  1.08804331e+00  1.22840394e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 5.57192131e-02  8.44802843e-03  1.35900620e-03]
 [-3.46626249e-02 -1.03098974e-01 -1.04925843e-02]
 [ 2.03134454e-01  3.96759608e-02 -1.97369668e-01]
 [ 3.25470721e-02  4.53120620e-02 -4.35786205e-02]
 [-4.35710377e-01  2.04322049e-02 -1.68726110e-01]
 [ 5.80084776e-01  1.14101578e+00 -1.97269940e-01]
 [-2.41844368e-04  1.50994322e-02 -5.74912411e-02]
 [-2.03977313e-01 -2.74429406e-03 -4.03343004e-01]
 [ 1.62454323e+00 -3.11519776e+00  2.61071129e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.34313209e-01 -7.31123799e-02  1.56219499e-02]
 [-9.81210387e-02 -8.68861691e-02 -4.87399369e-02]
 [-2.61704062e-01 -1.71063419e+00 -2.00120642e-01]
 [ 1.30094623e-03  3.72499194e-02  5.83893053e-02]
 [ 2.08427680e-01 -2.63186886e-01  2.25192095e-01]
 [ 4.08646439e-02 -3.51084453e-02  1.03931862e-01]
 [ 1.02771777e-01 -5.00359353e-02  1.93647938e-02]
 [-2.40476396e-03  7.99238899e-02  3.59793901e-02]
 [-1.06983180e-02 -8.68529753e-02  7.06553572e-02]
 [ 4.64237382e-02 -4.24588962e-02  4.35536194e-04]
 [ 2.64740834e-02 -1.88334414e-02  1.94868222e-01]
 [ 4.18757583e-01 -9.41621042e-02  1.99109859e-01]
 [ 9.82684866e-02 -2.35312903e-01 -1.28004014e-01]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [-4.33482224e-03  4.99865286e-02  7.57356927e-02]
 [-1.43990722e-02 -1.64123699e-02 -6.72698346e-02]
 [-2.84917414e-02  2.20790196e-02 -5.17305085e-02]
 [-8.94461795e-02 -3.01142104e-02  3.79575543e-02]
 [-7.18975693e-02 -6.64228699e-03 -3.08351305e-03]
 [-2.92739471e-02 -5.50741971e-04  1.97071359e-02]
 [-1.15985906e-01 -6.71765831e-02 -7.85293501e-02]
 [ 2.46140390e+00  1.57742248e+00  1.74123217e-01]
 [-2.64257024e-02 -6.61784458e-02 -2.93012845e-02]
 [ 3.46447340e-02 -1.34026578e-02 -9.76767055e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.06988548]
curr_Stock_Price:  100.3632763385617
curr_Factors:  [100.36327634  -0.94018788  -0.9863254 ]
mat_Sqrt:  [[14.61843037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00252025 -0.01640065  0.36188775]
Stock Position:  0.0025202516891790934
Bond Position:  [4.81694476]


portfolio before change:  [5.06994251]
curr_Stock_Price:  100.1469774705135
curr_Factors:  [100.14697747  -0.52796591  -0.99661147]
mat_Sqrt:  [[21.80330369  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04237953 0.07058805 0.63910396]
Stock Position:  0.04237952603254445
Bond Position:  [0.82576107]


portfolio before change:  [5.04706071]
curr_Stock_Price:  99.60461593825107
curr_Factors:  [99.60461594 -0.41980074 -0.97270333]
mat_Sqrt:  [[24.74700425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01461104 -0.06894112  0.11212791]
Stock Position:  -0.014611035561476023
Bond Position:  [6.5023873]


portfolio before change:  [5.05089584]
curr_Stock_Price:  99.39776648439756
curr_Factors:  [99.39776648 -0.38699729 -0.96244756]
mat_Sqrt:  [[25.78221183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02630406 0.35116447 3.50429452]
Stock Position:  0.026304058668522673
Bond Position:  [2.43633116]


portfolio before change:  [5.07266789]
curr_Stock_Price:  100.21389467082128
curr_Factors:  [100.21389467  -0.43433935  -0.9717074 ]
mat_Sqrt:  [[24.56346311  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238753 -0.01106097 -0.05874131]
Stock Position:  -0.0023875298314186325
Bond Position:  [5.31193155]


portfolio before change:  [5.07025091]
curr_Stock_Price:  101.50435464876541
curr_Factors:  [101.50435465  -0.63428603  -0.96683833]
mat_Sqrt:  [[20.47034687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00281974 0.00272659 0.00387687]
Stock Position:  0.002819740476883922
Bond Position:  [4.78403497]


portfolio before change:  [5.07268775]
curr_Stock_Price:  102.15647054959405
curr_Factors:  [102.15647055  -0.58386589  -0.97406706]
mat_Sqrt:  [[21.51117813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268927 -0.03327505 -0.02993242]
Stock Position:  -0.0026892717969644567
Bond Position:  [5.34741426]


portfolio before change:  [5.06842076]
curr_Stock_Price:  103.99171083078406
curr_Factors:  [103.99171083  -0.72708414  -0.97616617]
mat_Sqrt:  [[18.93592444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00902757  0.01280536 -0.56304073]
Stock Position:  0.009027568819835182
Bond Position:  [4.12962843]


portfolio before change:  [5.06532051]
curr_Stock_Price:  103.59110600447588
curr_Factors:  [103.591106    -0.66209154  -0.94083394]
mat_Sqrt:  [[20.85358755  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00157771  0.01462441 -0.12431767]
Stock Position:  0.001577709796274322
Bond Position:  [4.9018838]


portfolio before change:  [5.065658]
curr_Stock_Price:  103.41662428421587
curr_Factors:  [103.41662428  -1.00325136  -0.94437501]
mat_Sqrt:  [[14.74847011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03159519  0.00659447 -0.48132863]
Stock Position:  -0.0315951918907162
Bond Position:  [8.33312609]


portfolio before change:  [5.06545288]
curr_Stock_Price:  103.45608686083496
curr_Factors:  [103.45608686  -0.79196987  -0.96044869]
mat_Sqrt:  [[17.93454386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04308591  0.36826126 -0.56275623]
Stock Position:  0.04308590694806727
Bond Position:  [0.60795355]


portfolio before change:  [5.04510513]
curr_Stock_Price:  102.98206306424903
curr_Factors:  [102.98206306  -0.77312674  -0.92986387]
mat_Sqrt:  [[18.7569475   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047423  0.00487332 -0.16400651]
Stock Position:  -0.0004742262097047282
Bond Position:  [5.09394192]


portfolio before change:  [5.04619588]
curr_Stock_Price:  102.02478572674264
curr_Factors:  [102.02478573  -0.94250621  -0.90235733]
mat_Sqrt:  [[16.1246997   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.77906901e-02 -8.85717101e-04 -1.15062532e+00]
Stock Position:  -0.017790690132941694
Bond Position:  [6.86128723]


portfolio before change:  [5.05149149]
curr_Stock_Price:  101.77533536562088
curr_Factors:  [101.77533537  -0.8200439   -0.89236281]
mat_Sqrt:  [[18.36342807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08285846 -1.00542575  7.44763262]
Stock Position:  0.08285845936469889
Bond Position:  [-3.381456]


portfolio before change:  [5.03841025]
curr_Stock_Price:  101.62256243540457
curr_Factors:  [101.62256244  -0.68036794  -0.89565156]
mat_Sqrt:  [[21.01520204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103113 -0.03053791  0.10625201]
Stock Position:  -0.0010311284581389945
Bond Position:  [5.14319617]


portfolio before change:  [5.03787181]
curr_Stock_Price:  102.76827975280608
curr_Factors:  [102.76827975  -0.58054766  -0.8898267 ]
mat_Sqrt:  [[23.62020239  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00518954 -0.02359692  0.04456507]
Stock Position:  0.005189541663014758
Bond Position:  [4.50455154]


portfolio before change:  [5.03053266]
curr_Stock_Price:  101.24555355281944
curr_Factors:  [101.24555355  -0.65347673  -0.84528849]
mat_Sqrt:  [[22.61884877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00556198 -0.02804239 -0.13904147]
Stock Position:  -0.005561980757065289
Bond Position:  [5.59365848]


portfolio before change:  [5.02310742]
curr_Stock_Price:  102.70627333215947
curr_Factors:  [102.70627333  -0.78075593  -0.85524543]
mat_Sqrt:  [[20.00279149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03258222 -0.55210481 -0.57088849]
Stock Position:  -0.0325822152772607
Bond Position:  [8.36950532]


portfolio before change:  [4.99369504]
curr_Stock_Price:  103.64109723769327
curr_Factors:  [103.64109724  -0.5904326   -0.85037422]
mat_Sqrt:  [[24.53564903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00084869 0.01202236 0.16656844]
Stock Position:  0.000848692496274596
Bond Position:  [4.90573561]


portfolio before change:  [4.99293387]
curr_Stock_Price:  102.02164174871105
curr_Factors:  [102.02164175  -0.65294961  -0.85166866]
mat_Sqrt:  [[22.65921687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00885609 -0.0849432   0.64241037]
Stock Position:  0.00885608829681215
Bond Position:  [4.0894212]


portfolio before change:  [4.97807556]
curr_Stock_Price:  100.28616630792004
curr_Factors:  [100.28616631  -0.56870263  -0.8453721 ]
mat_Sqrt:  [[24.38463028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00225196 -0.0113312   0.29648867]
Stock Position:  0.0022519580699571964
Bond Position:  [4.75223532]


portfolio before change:  [4.97678776]
curr_Stock_Price:  99.45051085786456
curr_Factors:  [99.45051086 -0.84977819 -0.84553237]
mat_Sqrt:  [[18.25336741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0052873  -0.01614903  0.05524237]
Stock Position:  0.005287301463475235
Bond Position:  [4.45096293]


portfolio before change:  [4.9808096]
curr_Stock_Price:  100.10593653444526
curr_Factors:  [100.10593653  -0.99101475  -0.85454526]
mat_Sqrt:  [[15.81041624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0013443  0.02579532 0.10263919]
Stock Position:  0.0013442969285626459
Bond Position:  [4.8462375]


portfolio before change:  [4.98069447]
curr_Stock_Price:  99.56963203075887
curr_Factors:  [99.56963203 -0.98280729 -0.83137866]
mat_Sqrt:  [[16.22691473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086305 -0.02803168  0.20156007]
Stock Position:  -0.0008630502603745435
Bond Position:  [5.06662806]


portfolio before change:  [4.98172023]
curr_Stock_Price:  99.11497636496664
curr_Factors:  [99.11497636 -1.02989155 -0.83401829]
mat_Sqrt:  [[15.36928001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00246243 -0.01370355  0.00124246]
Stock Position:  0.0024624286748733473
Bond Position:  [4.73765667]


portfolio before change:  [4.9855148]
curr_Stock_Price:  100.41545126180918
curr_Factors:  [100.41545126  -1.07030252  -0.85410919]
mat_Sqrt:  [[14.6567999   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00425789 -0.00607847  0.5559048 ]
Stock Position:  0.00425788936575456
Bond Position:  [4.55795691]


portfolio before change:  [4.99006901]
curr_Stock_Price:  101.3512276448019
curr_Factors:  [101.35122764  -1.35864809  -0.85247342]
mat_Sqrt:  [[11.10583302  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03963502 -0.03039069  0.56800501]
Stock Position:  0.039635023531963604
Bond Position:  [0.97301072]


portfolio before change:  [5.00931388]
curr_Stock_Price:  101.83371098086836
curr_Factors:  [101.83371098  -1.37158487  -0.84250699]
mat_Sqrt:  [[11.12560643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00216678 -0.07594691 -0.36515982]
Stock Position:  0.002166779083658537
Bond Position:  [4.78866273]


portfolio before change:  [5.00934169]
curr_Stock_Price:  101.57027365831102
curr_Factors:  [101.57027366  -1.12276856  -0.83876024]
mat_Sqrt:  [[14.28517254  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154699 -0.02321455 -0.0028026 ]
Stock Position:  -0.0015469909350173002
Bond Position:  [5.16646998]


portfolio before change:  [5.01156687]
curr_Stock_Price:  100.54936757393901
curr_Factors:  [100.54936757  -0.97085715  -0.84284351]
mat_Sqrt:  [[16.39453685  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00130093 0.01613308 0.21605285]
Stock Position:  0.0013009284068714192
Bond Position:  [4.88075934]


portfolio before change:  [5.01296383]
curr_Stock_Price:  101.15418791265067
curr_Factors:  [101.15418791  -0.8267218   -0.8480797 ]
mat_Sqrt:  [[18.95076821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166118 -0.00529707 -0.19190211]
Stock Position:  -0.001661179657009392
Bond Position:  [5.18099911]


portfolio before change:  [5.01517252]
curr_Stock_Price:  100.21447927224244
curr_Factors:  [100.21447927  -0.88722925  -0.84546307]
mat_Sqrt:  [[17.71869625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019496   0.00712597 -0.14757274]
Stock Position:  -0.0019495975187694998
Bond Position:  [5.21055042]


portfolio before change:  [5.01917893]
curr_Stock_Price:  98.49358721647536
curr_Factors:  [98.49358722 -0.56750136 -0.84981317]
mat_Sqrt:  [[23.87130035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367995 -0.00971932  0.10828234]
Stock Position:  -0.003679948823482749
Bond Position:  [5.38163029]


portfolio before change:  [5.02016406]
curr_Stock_Price:  98.40869929196214
curr_Factors:  [98.40869929 -0.6908358  -0.84881152]
mat_Sqrt:  [[21.10440707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00350083 -0.00214379 -0.0087964 ]
Stock Position:  -0.0035008251921908075
Bond Position:  [5.36467571]


portfolio before change:  [5.01906889]
curr_Stock_Price:  98.91309439434447
curr_Factors:  [98.91309439 -0.36714708 -0.88167886]
mat_Sqrt:  [[28.37236709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00089396 -0.00017775  0.05621897]
Stock Position:  -0.0008939565907151215
Bond Position:  [5.1074929]


portfolio before change:  [5.0211604]
curr_Stock_Price:  97.28769943943254
curr_Factors:  [97.28769944 -0.24521702 -0.87495069]
mat_Sqrt:  [[31.73768742  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00459164 -0.02168115 -0.22402238]
Stock Position:  -0.004591639057020825
Bond Position:  [5.4678704]


portfolio before change:  [5.01371826]
curr_Stock_Price:  99.05736343247901
curr_Factors:  [99.05736343 -0.44161441 -0.85249098]
mat_Sqrt:  [[27.15588324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10380574 0.50911092 0.49672507]
Stock Position:  0.1038057443060576
Bond Position:  [-5.26900508]


portfolio before change:  [5.09655699]
curr_Stock_Price:  99.8617254456055
curr_Factors:  [99.86172545 -0.57177503 -0.855701  ]
mat_Sqrt:  [[23.95819524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191648 -0.021359   -0.08358841]
Stock Position:  -0.0019164807824700782
Bond Position:  [5.28794007]


portfolio before change:  [5.09314996]
curr_Stock_Price:  101.98440042026878
curr_Factors:  [101.98440042  -0.56783034  -0.84727121]
mat_Sqrt:  [[24.77210732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00048324 -0.00432569 -0.27864445]
Stock Position:  0.00048323518640472303
Bond Position:  [5.04386751]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.09442739]
Stock Price:  103.32308911054567
PL:  [1.77133828]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-1.09880867e-02 -1.18984000e-01  8.67488896e-02]
 [ 6.24165086e-01  2.00869631e-01  1.64177814e-01]
 [-2.78189844e-01 -1.69597613e-01  3.79110240e-02]
 [ 1.64965793e-01  1.08043239e+00  1.02340078e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 4.53668271e-02 -5.95430381e-02  4.80903721e-02]
 [-4.87359599e-02 -1.30298456e-02 -7.06900708e-02]
 [ 7.88773729e-02  1.25459120e-01 -5.20997333e-02]
 [ 1.95909967e-02  5.93326294e-02 -4.57087032e-02]
 [-1.07009206e-01 -5.38544404e-02 -2.03404038e-02]
 [ 8.44437800e-01  1.63521986e+00 -2.91135642e-01]
 [-1.26387507e-04 -7.28563730e-03 -1.63880796e-02]
 [-1.17120107e-01 -2.26922635e-03 -2.37226070e-01]
 [ 1.49343141e+00 -2.85900330e+00  2.39051573e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.62499828e-01 -8.88100635e-02  2.17376071e-02]
 [-2.01639394e-01 -3.15718824e-01 -1.68986303e-02]
 [-2.64406160e-01 -1.74115318e+00 -2.05586457e-01]
 [ 1.30094623e-03  3.72499194e-02  5.83893053e-02]
 [ 2.05032604e-01 -3.14510207e-01  1.56783951e-01]
 [ 5.41846319e-02  4.76601492e-02  1.12033374e-02]
 [-9.60506517e-02 -5.14814138e-02 -1.25771930e-01]
 [ 5.75738490e-01  1.12995557e-01  2.57910104e-01]
 [-9.16108617e-02 -3.09884252e-02  7.03459532e-02]
 [ 5.13236624e-02 -7.77622469e-02  5.72078524e-03]
 [ 5.25853934e-02 -4.11879939e-02  2.95996435e-01]
 [-1.94071986e-01 -1.27772599e-01 -7.28331015e-02]
 [-1.52921659e-01  1.10426564e-01  2.27125141e-01]
 [ 4.35237156e-02  3.34806955e-02  1.87740693e-01]
 [-1.12293908e-01  1.08261819e-01 -9.64452333e-03]
 [ 1.94648962e-02 -1.38395379e-02 -7.37923836e-02]
 [ 2.86889532e-03  1.39396054e-02 -5.77647609e-02]
 [-3.56546634e-02 -3.65367060e-03  4.74185734e-02]
 [-8.18820691e-02 -9.42496565e-03 -4.10037876e-03]
 [-3.29341442e-02  1.70886631e-02  1.25089812e-02]
 [-1.13986107e-01 -6.15461772e-02 -8.35675946e-02]
 [ 1.66475976e+00  1.11347315e+00  1.49838942e-01]
 [-4.93661746e-02 -6.58597928e-03 -2.26050379e-02]
 [ 3.77423275e-02 -1.27218992e-02 -1.68881118e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.06124281]
curr_Stock_Price:  98.98076636693767
curr_Factors:  [98.98076637 -1.02689038 -0.99755385]
mat_Sqrt:  [[13.07211485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134393 -0.03840192  0.24747044]
Stock Position:  -0.0013439333404872602
Bond Position:  [-4.92821926]


portfolio before change:  [-5.06240621]
curr_Stock_Price:  99.38803023651415
curr_Factors:  [99.38803024 -0.71616708 -0.97567547]
mat_Sqrt:  [[18.30527266  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03816824 0.06483039 0.4683536 ]
Stock Position:  0.03816824238414728
Bond Position:  [-8.85587264]


portfolio before change:  [-5.04751175]
curr_Stock_Price:  99.80726671505317
curr_Factors:  [99.80726672 -0.89215432 -1.02244565]
mat_Sqrt:  [[14.71166949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02073662 -0.05473739  0.1081496 ]
Stock Position:  -0.02073661706891933
Bond Position:  [-2.97784668]


portfolio before change:  [-5.05403896]
curr_Stock_Price:  100.10408255235139
curr_Factors:  [100.10408255  -0.7497943   -1.01104103]
mat_Sqrt:  [[17.20801299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03454257 0.34870805 2.91947758]
Stock Position:  0.0345425669809902
Bond Position:  [-8.51189094]


portfolio before change:  [-5.06030956]
curr_Stock_Price:  99.9533541947766
curr_Factors:  [99.95335419 -0.96915542 -1.00395041]
mat_Sqrt:  [[13.89595494  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00422036 -0.01106097 -0.05874131]
Stock Position:  -0.004220364931693655
Bond Position:  [-4.63846993]


portfolio before change:  [-5.06401247]
curr_Stock_Price:  100.6933530501963
curr_Factors:  [100.69335305  -1.04280548  -1.02086406]
mat_Sqrt:  [[12.78675991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00336513 -0.01921743  0.13718845]
Stock Position:  0.0033651262494775657
Bond Position:  [-5.40285831]


portfolio before change:  [-5.06385317]
curr_Stock_Price:  100.94139498269021
curr_Factors:  [100.94139498  -1.00925838  -1.06420105]
mat_Sqrt:  [[12.69338086  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00518579 -0.00420536 -0.2016591 ]
Stock Position:  -0.005185790689336555
Bond Position:  [-4.54039223]


portfolio before change:  [-5.06748153]
curr_Stock_Price:  101.53161715804887
curr_Factors:  [101.53161716  -0.90033884  -1.10299124]
mat_Sqrt:  [[13.69512832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00685293  0.04049176 -0.14862604]
Stock Position:  0.006852932863512798
Bond Position:  [-5.76327088]


portfolio before change:  [-5.06998692]
curr_Stock_Price:  101.27115357177553
curr_Factors:  [101.27115357  -0.71082012  -1.11281087]
mat_Sqrt:  [[16.3490635   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00136839  0.01914952 -0.13039421]
Stock Position:  0.0013683945268646274
Bond Position:  [-5.20856581]


portfolio before change:  [-5.07008104]
curr_Stock_Price:  101.67819412011366
curr_Factors:  [101.67819412  -0.62769624  -1.11639635]
mat_Sqrt:  [[17.77370779  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00687275 -0.01738145 -0.05802551]
Stock Position:  -0.006872745187824975
Bond Position:  [-4.37127272]


portfolio before change:  [-5.06957486]
curr_Stock_Price:  101.52503443504068
curr_Factors:  [101.52503444  -0.6969397   -1.10997169]
mat_Sqrt:  [[16.66638841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06712899  0.52776494 -0.83052895]
Stock Position:  0.06712899125650296
Bond Position:  [-11.884848]


portfolio before change:  [-5.13902646]
curr_Stock_Price:  100.51256717197501
curr_Factors:  [100.51256717  -0.54719468  -1.10118626]
mat_Sqrt:  [[19.33470818  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025647 -0.00235143 -0.04675063]
Stock Position:  -0.00025646959304385133
Bond Position:  [-5.11324804]


portfolio before change:  [-5.14012218]
curr_Stock_Price:  102.29258348094379
curr_Factors:  [102.29258348  -0.53928157  -1.12565008]
mat_Sqrt:  [[19.35412391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00857734 -0.00073239 -0.67673995]
Stock Position:  -0.008577338890043439
Bond Position:  [-4.26272402]


portfolio before change:  [-5.14665096]
curr_Stock_Price:  102.99162390415924
curr_Factors:  [102.9916239   -0.35832861  -1.13581897]
mat_Sqrt:  [[23.1154235   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06047052 -0.92273935  6.81947597]
Stock Position:  0.06047052468897504
Bond Position:  [-11.37460849]


portfolio before change:  [-5.08494145]
curr_Stock_Price:  104.03562714300111
curr_Factors:  [104.03562714  -0.39264896  -1.16185025]
mat_Sqrt:  [[21.98222568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098577 -0.03053791  0.10625201]
Stock Position:  -0.0009857679197251752
Bond Position:  [-4.98238646]


portfolio before change:  [-5.08583271]
curr_Stock_Price:  104.30792285509254
curr_Factors:  [104.30792286  -0.38518107  -1.1323536 ]
mat_Sqrt:  [[22.86969441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00650681 -0.02866332  0.06201134]
Stock Position:  0.0065068084114019995
Bond Position:  [-5.76454438]


portfolio before change:  [-5.08901968]
curr_Stock_Price:  103.92887954645889
curr_Factors:  [103.92887955  -0.34173136  -1.1134714 ]
mat_Sqrt:  [[24.25212046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01111386 -0.10189781 -0.04820709]
Stock Position:  -0.011113859031471966
Bond Position:  [-3.93396876]


portfolio before change:  [-5.08534525]
curr_Stock_Price:  103.55401402280869
curr_Factors:  [103.55401402  -0.4291193   -1.11272832]
mat_Sqrt:  [[22.1590441   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02986513 -0.56195477 -0.58648094]
Stock Position:  -0.029865129598680224
Bond Position:  [-1.99269121]


portfolio before change:  [-5.09680081]
curr_Stock_Price:  103.92924930331536
curr_Factors:  [103.9292493   -0.30480848  -1.09284754]
mat_Sqrt:  [[25.68878095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0008106  0.01202236 0.16656844]
Stock Position:  0.0008105959276242656
Bond Position:  [-5.18104543]


portfolio before change:  [-5.09867341]
curr_Stock_Price:  102.41809550650737
curr_Factors:  [102.41809551  -0.15849335  -1.08499254]
mat_Sqrt:  [[29.53504474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00585192 -0.10150773  0.44726097]
Stock Position:  0.005851924998946404
Bond Position:  [-5.69801643]


portfolio before change:  [-5.09771867]
curr_Stock_Price:  102.7029656125489
curr_Factors:  [102.70296561  -0.13032061  -1.08058532]
mat_Sqrt:  [[30.59801273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00216354 0.01538225 0.03196   ]
Stock Position:  0.002163542167394724
Bond Position:  [-5.31992087]


portfolio before change:  [-5.09467304]
curr_Stock_Price:  104.41805103582095
curr_Factors:  [ 1.04418051e+02 -5.16420332e-02 -1.05743272e+00]
mat_Sqrt:  [[34.4437587   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00383908 -0.01661555 -0.35879231]
Stock Position:  -0.0038390798236843248
Bond Position:  [-4.69380381]


portfolio before change:  [-5.08373693]
curr_Stock_Price:  101.41658187123386
curr_Factors:  [ 1.01416582e+02  1.56826408e-02 -1.04793245e+00]
mat_Sqrt:  [[36.12505949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01803317 0.03646916 0.73574574]
Stock Position:  0.018033168671674725
Bond Position:  [-6.91259925]


portfolio before change:  [-5.12357419]
curr_Stock_Price:  99.25539006363653
curr_Factors:  [ 9.92553901e+01  8.21228273e-02 -1.07758166e+00]
mat_Sqrt:  [[36.68021063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227853 -0.01000147  0.20067742]
Stock Position:  -0.002278532169494973
Bond Position:  [-4.89741759]


portfolio before change:  [-5.12109193]
curr_Stock_Price:  97.89729102065941
curr_Factors:  [ 9.78972910e+01 -4.75454397e-02 -1.09174406e+00]
mat_Sqrt:  [[31.33166905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00116873 -0.02509766  0.01631981]
Stock Position:  0.0011687299701812661
Bond Position:  [-5.23550743]


portfolio before change:  [-5.12346504]
curr_Stock_Price:  96.42678450278738
curr_Factors:  [96.4267845  -0.23777523 -1.05723475]
mat_Sqrt:  [[26.41082661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00396042 -0.01329337  0.84439544]
Stock Position:  0.003960419344065611
Bond Position:  [-5.50535554]


portfolio before change:  [-5.12346953]
curr_Stock_Price:  96.59942201098724
curr_Factors:  [96.59942201 -0.17174897 -1.04859186]
mat_Sqrt:  [[28.50934481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00824363 -0.04123843 -0.20777257]
Stock Position:  -0.008243628717016331
Bond Position:  [-4.32713976]


portfolio before change:  [-5.13269454]
curr_Stock_Price:  97.65285132840155
curr_Factors:  [97.65285133 -0.19426152 -1.07459763]
mat_Sqrt:  [[27.4553131   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306022  0.03564002  0.64792481]
Stock Position:  -0.003060216627095359
Bond Position:  [-4.83385566]


portfolio before change:  [-5.12909438]
curr_Stock_Price:  96.27895282914675
curr_Factors:  [96.27895283 -0.34664598 -1.06756782]
mat_Sqrt:  [[23.4070191   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00378862 0.01080585 0.53557194]
Stock Position:  0.0037886217822568915
Bond Position:  [-5.49385892]


portfolio before change:  [-5.12686339]
curr_Stock_Price:  97.04909386468363
curr_Factors:  [ 9.70490939e+01 -2.58807047e-02 -1.11080815e+00]
mat_Sqrt:  [[31.14108851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295955  0.03494135 -0.02751314]
Stock Position:  -0.002959554134695284
Bond Position:  [-4.83964134]


portfolio before change:  [-5.13292854]
curr_Stock_Price:  98.89402007211653
curr_Factors:  [98.89402007 -0.29585826 -1.11805453]
mat_Sqrt:  [[24.05002374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.55760331e-05 -4.46669166e-03 -2.10509131e-01]
Stock Position:  6.557603313483722e-05
Bond Position:  [-5.13941362]


portfolio before change:  [-5.13358311]
curr_Stock_Price:  98.7093645616145
curr_Factors:  [98.70936456 -0.19610962 -1.09532452]
mat_Sqrt:  [[27.13286378  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00022397  0.00449899 -0.16478678]
Stock Position:  -0.00022396740474091677
Bond Position:  [-5.11147543]


portfolio before change:  [-5.13397729]
curr_Stock_Price:  97.61634243130497
curr_Factors:  [97.61634243 -0.13192039 -1.11396291]
mat_Sqrt:  [[28.08292147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095151 -0.00117922  0.13527199]
Stock Position:  -0.0009515103356182602
Bond Position:  [-5.04109433]


portfolio before change:  [-5.13490183]
curr_Stock_Price:  97.92571410178292
curr_Factors:  [97.9257141  -0.26555804 -1.09869811]
mat_Sqrt:  [[25.02694428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338207 -0.00304189 -0.01169724]
Stock Position:  -0.003382071639629217
Bond Position:  [-4.80371005]


portfolio before change:  [-5.13706289]
curr_Stock_Price:  98.3871329020554
curr_Factors:  [98.3871329  -0.28761335 -1.0911191 ]
mat_Sqrt:  [[24.7834868   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010851   0.00551534  0.03568464]
Stock Position:  -0.0010850995485638933
Bond Position:  [-5.03030305]


portfolio before change:  [-5.13977654]
curr_Stock_Price:  100.30845396514147
curr_Factors:  [100.30845397  -0.44009572  -1.09786954]
mat_Sqrt:  [[21.54803703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00666452 -0.01986394 -0.23839509]
Stock Position:  -0.006664520365549151
Bond Position:  [-4.4712688]


portfolio before change:  [-5.14816409]
curr_Stock_Price:  101.48312352733134
curr_Factors:  [101.48312353  -0.37507541  -1.11842244]
mat_Sqrt:  [[22.79165976  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08435683 0.35937192 0.42744879]
Stock Position:  0.08435683415736471
Bond Position:  [-13.70895911]


portfolio before change:  [-4.99493593]
curr_Stock_Price:  103.31986732275735
curr_Factors:  [103.31986732  -0.34402473  -1.14934468]
mat_Sqrt:  [[23.2071465   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238395 -0.00212562 -0.06448588]
Stock Position:  -0.0023839538429836975
Bond Position:  [-4.74862613]


portfolio before change:  [-4.99984383]
curr_Stock_Price:  105.12958828042093
curr_Factors:  [105.12958828  -0.52062935  -1.12596319]
mat_Sqrt:  [[20.25904214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.32082219e-05 -4.10597530e-03 -4.81770823e-01]
Stock Position:  3.3208221930654604e-05
Bond Position:  [-5.003335]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.00046219]
Stock Price:  105.34338556365458
PL:  [-10.34384775]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-4.21109187e-03 -5.78312169e-02  1.98357120e-01]
 [ 1.74877402e+00  4.62466412e-01  6.42733316e-01]
 [ 1.29690584e-01  2.39773832e-01  4.29973334e-02]
 [ 3.39632016e-02  2.42735202e-01  2.15981428e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-2.25638485e-01 -3.83348862e-02 -1.19900187e-01]
 [-3.21888650e-02 -1.19266517e-01  2.13006366e-03]
 [ 1.88190451e-01  2.52100010e-02 -1.78247504e-01]
 [ 1.57903654e-02  6.34455267e-02 -4.63335574e-02]
 [-4.75642978e-01  7.18624420e-02 -1.74747932e-01]
 [ 3.57890736e-01  7.23548193e-01 -1.18897738e-01]
 [ 5.74331604e-07  2.10997614e-02 -5.84223379e-02]
 [ 1.56514860e-01 -4.76491702e-02  6.01687636e-02]
 [ 1.54503733e+00 -3.03218821e+00  2.65282491e+00]
 [ 7.41242744e-02 -1.07944459e-01  7.24571643e-02]
 [ 1.36798471e-01 -1.15934423e-01  3.74168178e-02]
 [-2.37759527e-01 -3.86679498e-01  5.32015367e-03]
 [-2.44706479e-01 -1.60761941e+00 -1.97874791e-01]
 [-3.58923927e-02  1.69340373e-01  3.65759055e-01]
 [ 4.22036684e-01 -5.52234470e-01  4.14041723e-01]
 [ 1.04249792e-01 -6.54330809e-02 -2.58248264e-01]
 [-2.19416423e-01 -5.02936944e-02 -1.72015916e-01]
 [ 3.14491780e-01  3.38406788e-01  2.93973039e-01]
 [-7.77309283e-03  4.12065276e-02  1.47024766e-01]
 [-7.12447060e-02 -2.20259499e-01  8.55233503e-02]
 [ 1.02250184e-01 -3.19367865e-02 -1.03189335e-01]
 [ 6.17815819e-01 -5.57144056e-02  3.51745810e-01]
 [ 1.14923534e-02 -7.74374059e-02  1.61365612e-02]
 [-1.38083766e-02 -7.91105775e-02 -1.03638017e-02]
 [ 1.80649819e-01 -7.92290090e-02  6.81560746e-02]
 [-1.41396132e-02 -5.71641784e-02 -3.97297030e-02]
 [-4.51224635e-02  2.47420448e-02 -4.80202758e-02]
 [-3.98149049e-02 -6.03607056e-02  1.25130607e-02]
 [ 3.62029850e-01  5.11587682e-02  7.83157850e-02]
 [-9.42227530e-02 -3.81359267e-02  5.99941184e-02]
 [-1.00487195e-01 -3.92817856e-02 -9.82134326e-02]
 [ 2.49130003e+00  1.64151897e+00  1.84137126e-01]
 [-4.60254921e-02 -1.05250924e-01 -4.29645413e-02]
 [ 3.77727471e-02 -1.90042635e-02 -5.88758747e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.89576169]
curr_Stock_Price:  100.88536152498145
curr_Factors:  [100.88536152  -0.66119449  -1.01425924]
mat_Sqrt:  [[18.88808131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129572 -0.01866494  0.56585765]
Stock Position:  0.0012957185825415306
Bond Position:  [8.76504265]


portfolio before change:  [8.89871703]
curr_Stock_Price:  102.32058076034015
curr_Factors:  [102.32058076  -0.73329664  -1.01007588]
mat_Sqrt:  [[17.89888315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11030699 0.14926039 1.83353925]
Stock Position:  0.1103069924784929
Bond Position:  [-2.38795851]


portfolio before change:  [8.98173943]
curr_Stock_Price:  103.0759355767299
curr_Factors:  [103.07593558  -0.80110735  -1.02885754]
mat_Sqrt:  [[16.53535923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01133395 0.07738667 0.12265942]
Stock Position:  0.011333954344627839
Bond Position:  [7.81348148]


portfolio before change:  [8.98126291]
curr_Stock_Price:  102.94771308588557
curr_Factors:  [102.94771309  -1.14214165  -0.99971697]
mat_Sqrt:  [[12.08980571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01055421 0.07834245 0.6161349 ]
Stock Position:  0.010554209454510525
Bond Position:  [7.89473118]


portfolio before change:  [8.98330547]
curr_Stock_Price:  103.04773520251794
curr_Factors:  [103.0477352   -1.36614378  -1.00300152]
mat_Sqrt:  [[ 9.64121395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00608284 -0.01106097 -0.05874131]
Stock Position:  -0.006082844050783425
Bond Position:  [9.61012877]


portfolio before change:  [8.9835612]
curr_Stock_Price:  103.2031902897147
curr_Factors:  [103.20319029  -1.54478328  -1.00256536]
mat_Sqrt:  [[ 8.07967081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03192433 -0.01237253 -0.34204186]
Stock Position:  -0.03192433091008979
Bond Position:  [12.278254]


portfolio before change:  [8.9868649]
curr_Stock_Price:  103.14778364293437
curr_Factors:  [103.14778364  -1.41039559  -0.99926616]
mat_Sqrt:  [[ 9.26738272  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00605341 -0.0384931   0.00607648]
Stock Position:  -0.0060534074338210835
Bond Position:  [9.61126046]


portfolio before change:  [8.98848338]
curr_Stock_Price:  103.07889637935357
curr_Factors:  [103.07889638  -1.2763695   -0.9682003 ]
mat_Sqrt:  [[10.92359222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01436815  0.00813649 -0.50849051]
Stock Position:  0.014368149077733169
Bond Position:  [7.50743043]


portfolio before change:  [8.98450985]
curr_Stock_Price:  102.73702764419096
curr_Factors:  [102.73702764  -0.97018247  -0.99454848]
mat_Sqrt:  [[14.40307395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133883  0.02047696 -0.13217674]
Stock Position:  0.001338834443467408
Bond Position:  [8.84696198]


portfolio before change:  [8.98698142]
curr_Stock_Price:  103.75704385186687
curr_Factors:  [103.75704385  -1.40218808  -0.99900781]
mat_Sqrt:  [[ 9.40137694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05282677  0.0231935  -0.49850721]
Stock Position:  -0.052826771371094386
Bond Position:  [14.46813105]


portfolio before change:  [8.92912031]
curr_Stock_Price:  104.88657985355397
curr_Factors:  [104.88657985  -1.34752515  -0.99883137]
mat_Sqrt:  [[10.03945733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04794228  0.23352418 -0.33918215]
Stock Position:  0.047942281916788225
Bond Position:  [3.90061833]


portfolio before change:  [8.97143409]
curr_Stock_Price:  105.75900743650303
curr_Factors:  [105.75900744  -1.48718994  -1.00937838]
mat_Sqrt:  [[ 8.71107041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008745   0.00680992 -0.16666267]
Stock Position:  -0.000874503859624444
Bond Position:  [9.06392075]


portfolio before change:  [8.9727169]
curr_Stock_Price:  105.58776573874437
curr_Factors:  [105.58776574  -1.50499868  -1.03663755]
mat_Sqrt:  [[ 8.31371264  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0191335  -0.0153787   0.17164473]
Stock Position:  0.01913349879872003
Bond Position:  [6.95245351]


portfolio before change:  [8.98073266]
curr_Stock_Price:  105.96128078575859
curr_Factors:  [105.96128079  -1.49299615  -1.02363924]
mat_Sqrt:  [[ 8.55433664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.17156212 -0.97863454  7.56777106]
Stock Position:  0.17156211886493675
Bond Position:  [-9.19820919]


portfolio before change:  [8.97821633]
curr_Stock_Price:  105.95331586813285
curr_Factors:  [105.95331587  -1.68008643  -1.00897618]
mat_Sqrt:  [[ 7.19895565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0092903  -0.03483892  0.20670012]
Stock Position:  0.009290300418390334
Bond Position:  [7.9938782]


portfolio before change:  [8.97279286]
curr_Stock_Price:  105.2619742341126
curr_Factors:  [105.26197423  -1.43934209  -1.00338281]
mat_Sqrt:  [[ 9.14975707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01319938 -0.03741767  0.10673977]
Stock Position:  0.013199381219889934
Bond Position:  [7.58339993]


portfolio before change:  [8.97570345]
curr_Stock_Price:  105.41066334416183
curr_Factors:  [105.41066334  -1.68536175  -0.97655253]
mat_Sqrt:  [[ 7.35918743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04288574 -0.12480027  0.01517692]
Stock Position:  -0.04288573703527205
Bond Position:  [13.49631744]


portfolio before change:  [8.95359058]
curr_Stock_Price:  105.96562668402173
curr_Factors:  [105.96562668  -1.69632613  -0.96146253]
mat_Sqrt:  [[ 7.42851594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0825537  -0.51885693 -0.5644817 ]
Stock Position:  -0.08255369505930536
Bond Position:  [17.70144461]


portfolio before change:  [8.97749735]
curr_Stock_Price:  105.70284073046012
curr_Factors:  [105.70284073  -1.83035678  -0.94371354]
mat_Sqrt:  [[ 6.59664671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01111691 0.05465437 1.04340878]
Stock Position:  0.011116908939188803
Bond Position:  [7.8024085]


portfolio before change:  [8.9757653]
curr_Stock_Price:  105.45930094821213
curr_Factors:  [105.45930095  -1.76879632  -0.95572582]
mat_Sqrt:  [[ 6.91576066  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05694648 -0.17823291  1.18114579]
Stock Position:  0.05694647724773101
Bond Position:  [2.97022962]


portfolio before change:  [9.0303595]
curr_Stock_Price:  106.41147380876295
curr_Factors:  [106.41147381  -1.29090411  -0.9517168 ]
mat_Sqrt:  [[11.29875455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00337901 -0.02111844 -0.73671041]
Stock Position:  0.003379010879325599
Bond Position:  [8.67079397]


portfolio before change:  [9.0300541]
curr_Stock_Price:  106.00031356857185
curr_Factors:  [106.00031357  -1.26084381  -0.94748372]
mat_Sqrt:  [[11.64776738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02273356 -0.01623222 -0.49071353]
Stock Position:  -0.022733556892832903
Bond Position:  [11.43981826]


portfolio before change:  [9.03973191]
curr_Stock_Price:  105.63751299467704
curr_Factors:  [105.63751299  -1.17430474  -0.95436282]
mat_Sqrt:  [[12.5704144   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03528728 0.10922032 0.83862326]
Stock Position:  0.03528728312737711
Bond Position:  [5.31207108]


portfolio before change:  [9.0304462]
curr_Stock_Price:  105.355548588945
curr_Factors:  [105.35554859  -1.21316907  -0.92792516]
mat_Sqrt:  [[12.38203424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00247532 0.01329935 0.41942073]
Stock Position:  0.0024753169331684015
Bond Position:  [8.76965783]


portfolio before change:  [9.02856626]
curr_Stock_Price:  104.15319148719075
curr_Factors:  [104.15319149  -1.26397097  -0.89748375]
mat_Sqrt:  [[11.99401876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00823307 -0.07108845  0.24397431]
Stock Position:  -0.008233070931291997
Bond Position:  [9.88606688]


portfolio before change:  [9.0246138]
curr_Stock_Price:  104.78336990844683
curr_Factors:  [104.78336991  -1.41865421  -0.86582907]
mat_Sqrt:  [[10.66974106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00699808 -0.01030755 -0.29437045]
Stock Position:  0.006998077992023174
Bond Position:  [8.2913316]


portfolio before change:  [9.02184853]
curr_Stock_Price:  104.24011358149029
curr_Factors:  [104.24011358  -1.49581396  -0.8426657 ]
mat_Sqrt:  [[10.05648153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06744337 -0.01798175  1.00343289]
Stock Position:  0.06744336714537194
Bond Position:  [1.99154428]


portfolio before change:  [9.01649418]
curr_Stock_Price:  104.1570319811116
curr_Factors:  [104.15703198  -1.41236521  -0.85536252]
mat_Sqrt:  [[10.78516902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.46326537e-05 -2.49928153e-02  4.60331176e-02]
Stock Position:  -9.463265368960926e-05
Bond Position:  [9.02635084]


portfolio before change:  [9.01763571]
curr_Stock_Price:  104.01790408162229
curr_Factors:  [104.01790408  -1.50206965  -0.85415532]
mat_Sqrt:  [[ 9.85853985  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325325 -0.02553283 -0.02956504]
Stock Position:  -0.003253246250375418
Bond Position:  [9.35603157]


portfolio before change:  [9.02312249]
curr_Stock_Price:  102.69086069849024
curr_Factors:  [102.6908607   -1.43943586  -0.88092639]
mat_Sqrt:  [[10.08814398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01768309 -0.02557105  0.19443031]
Stock Position:  0.01768309074970785
Bond Position:  [7.20723068]


portfolio before change:  [9.02985676]
curr_Stock_Price:  103.0207415764492
curr_Factors:  [103.02074158  -1.40747388  -0.88994661]
mat_Sqrt:  [[10.35541797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00327539 -0.01844966 -0.11333778]
Stock Position:  -0.0032753862807811556
Bond Position:  [9.36728949]


portfolio before change:  [9.03385555]
curr_Stock_Price:  102.15739265169033
curr_Factors:  [102.15739265  -1.36040916  -0.91729784]
mat_Sqrt:  [[10.47307516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00476213  0.00798546 -0.13698848]
Stock Position:  -0.004762126863928662
Bond Position:  [9.52034201]


portfolio before change:  [9.03452111]
curr_Stock_Price:  102.26754369385101
curr_Factors:  [102.26754369  -1.26325739  -0.91682512]
mat_Sqrt:  [[11.55952584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428926 -0.01948133  0.03569628]
Stock Position:  -0.004289255910406634
Bond Position:  [9.47317278]


portfolio before change:  [9.03325214]
curr_Stock_Price:  102.83948216694678
curr_Factors:  [102.83948217  -1.44716421  -0.91352419]
mat_Sqrt:  [[ 9.70344473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04003308 0.01651142 0.22341314]
Stock Position:  0.04003307515096814
Bond Position:  [4.91627143]


portfolio before change:  [9.03510473]
curr_Stock_Price:  102.87040692241311
curr_Factors:  [102.87040692  -1.74091918  -0.93087931]
mat_Sqrt:  [[ 7.11120366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01262247 -0.01230832  0.17114652]
Stock Position:  -0.012622471876982375
Bond Position:  [10.33358355]


portfolio before change:  [9.03971052]
curr_Stock_Price:  102.60785798355961
curr_Factors:  [102.60785798  -1.60536084  -0.92246708]
mat_Sqrt:  [[ 8.19141456  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01569366 -0.01267814 -0.28017559]
Stock Position:  -0.015693661674643845
Bond Position:  [10.65000353]


portfolio before change:  [9.03756171]
curr_Stock_Price:  102.82961296262359
curr_Factors:  [102.82961296  -1.54645291  -0.93010655]
mat_Sqrt:  [[ 8.64096196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.33144001 0.52979797 0.52529197]
Stock Position:  0.3314400096515103
Bond Position:  [-25.0442862]


portfolio before change:  [9.12624607]
curr_Stock_Price:  103.10663169191572
curr_Factors:  [103.10663169  -1.96313463  -0.95336728]
mat_Sqrt:  [[ 5.58040748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01366923 -0.03396959 -0.12256588]
Stock Position:  -0.01366922531844443
Bond Position:  [10.53563385]


portfolio before change:  [9.12448628]
curr_Stock_Price:  103.33172337400737
curr_Factors:  [103.33172337  -2.02783733  -0.96943045]
mat_Sqrt:  [[ 5.15865895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00424055 -0.0061336  -0.16795648]
Stock Position:  0.00424054598420652
Bond Position:  [8.68630335]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.12588345]
Stock Price:  103.405136785682
PL:  [5.72074666]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-2.72848145e-02 -7.61407460e-02  2.00334957e-01]
 [ 8.38047593e-01  2.20235554e-01  2.40226126e-01]
 [-3.35687329e-01 -2.22522861e-01  3.95881437e-02]
 [ 2.28097928e-01  1.61085365e+00  1.44211035e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-4.03337357e-03  1.62510842e-01 -5.97831616e-02]
 [-5.75239123e-02  1.45160950e-02 -5.88546164e-02]
 [-2.68952473e-02  2.35426928e-01 -3.84258999e-02]
 [ 5.19093552e-02  2.43589425e-02 -4.03953059e-02]
 [-1.57837345e-01 -8.54165087e-02 -5.54730017e-02]
 [ 8.88591004e-01  1.72484076e+00 -3.05030406e-01]
 [-2.80414022e-04  8.85309443e-04 -2.11418276e-03]
 [-2.80312689e-01  2.00274717e-03 -5.96361862e-01]
 [ 1.65730578e+00 -2.95856547e+00  2.48587139e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.09421433e-01  7.20325877e-02 -7.06417805e-02]
 [-3.33593481e-02  4.13939407e-02 -8.43266619e-02]
 [-2.80757584e-01 -1.81311983e+00 -1.97946021e-01]
 [ 1.96255893e-02 -9.76420430e-03  3.15870730e-03]
 [ 1.06784578e-01  2.23724167e-01  3.14769626e-01]
 [ 3.55041034e-02 -8.84598993e-02  3.94920238e-02]
 [ 1.12300326e-01 -5.12238973e-02  3.19374089e-02]
 [-5.73108059e-02 -8.84756831e-02 -8.54739640e-02]
 [-1.14708179e-01 -1.41731521e-02  6.35418159e-02]
 [ 9.43626182e-02  1.78239719e-02 -3.39404400e-02]
 [ 2.40285709e-02 -4.62016573e-02  2.58409104e-01]
 [ 4.93161975e-02 -1.26200997e-01  3.88622979e-02]
 [-5.64570574e-02 -2.53348943e-02  5.74831116e-02]
 [ 8.93493341e-02  2.61327384e-02  1.13462680e-01]
 [-1.61484559e-01  1.23990544e-01 -2.69177593e-02]
 [ 8.17526981e-02 -1.11315156e-02 -4.39525949e-02]
 [ 2.58042043e-02 -1.97803349e-03 -5.91026083e-02]
 [-1.42750475e-03  4.36813758e-02  9.55054932e-02]
 [ 6.93336595e-03 -4.72703337e-02 -1.26661001e-02]
 [-8.89491384e-02  6.46265798e-02  4.64239557e-02]
 [-1.08094881e-01 -6.10713540e-02 -7.11906152e-02]
 [ 2.11371518e+00  1.35625939e+00  1.59883120e-01]
 [ 5.52348586e-02 -9.28841112e-02  4.24684048e-02]
 [ 3.10877065e-02 -1.46219235e-02 -3.66871880e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.97066226]
curr_Stock_Price:  99.12958873406346
curr_Factors:  [99.12958873 -0.87671364 -0.95794625]
mat_Sqrt:  [[15.82780315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.22175976e-04 -2.45743201e-02  5.71499871e-01]
Stock Position:  -0.0001221759762270962
Bond Position:  [-3.958551]


portfolio before change:  [-3.97121404]
curr_Stock_Price:  99.5956038322114
curr_Factors:  [99.59560383 -0.98045984 -0.93743322]
mat_Sqrt:  [[14.63220562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06369777 0.07108072 0.68529827]
Stock Position:  0.06369777490852427
Bond Position:  [-10.3152324]


portfolio before change:  [-3.99429761]
curr_Stock_Price:  99.25345549507526
curr_Factors:  [99.2534555  -1.04417413 -0.9535345 ]
mat_Sqrt:  [[13.46330855  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02770706 -0.07181894  0.11293395]
Stock Position:  -0.02770706181786349
Bond Position:  [-1.24427599]


portfolio before change:  [-3.984068]
curr_Stock_Price:  98.8786357431883
curr_Factors:  [98.87863574 -1.03658379 -0.93702607]
mat_Sqrt:  [[13.73961593  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06195818 0.51990078 4.11393942]
Stock Position:  0.06195817994181198
Bond Position:  [-10.11040831]


portfolio before change:  [-3.90561026]
curr_Stock_Price:  100.16533635838859
curr_Factors:  [100.16533636  -1.09765652  -0.95329211]
mat_Sqrt:  [[12.88254831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00455236 -0.01106097 -0.05874131]
Stock Position:  -0.004552360257353895
Bond Position:  [-3.44962156]


portfolio before change:  [-3.90233614]
curr_Stock_Price:  99.35139629386981
curr_Factors:  [99.35139629 -0.7651922  -0.9286823 ]
mat_Sqrt:  [[18.2613814   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00092741  0.05245015 -0.17054472]
Stock Position:  0.0009274121204327673
Bond Position:  [-3.99447583]


portfolio before change:  [-3.90251868]
curr_Stock_Price:  99.69299146315998
curr_Factors:  [99.69299146 -0.79438467 -0.91076869]
mat_Sqrt:  [[18.11865414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367436  0.00468505 -0.16789584]
Stock Position:  -0.0036743609429530522
Bond Position:  [-3.53621065]


portfolio before change:  [-3.90450565]
curr_Stock_Price:  100.1134501819659
curr_Factors:  [100.11345018  -0.95335845  -0.8937746 ]
mat_Sqrt:  [[15.78675017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084358  0.07598371 -0.1096184 ]
Stock Position:  0.0008435820544615218
Bond Position:  [-3.98895956]


portfolio before change:  [-3.90579195]
curr_Stock_Price:  99.17975084968482
curr_Factors:  [99.17975085 -0.80947263 -0.88504776]
mat_Sqrt:  [[18.21806114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00266966  0.00786181 -0.11523656]
Stock Position:  0.0026696554482164036
Bond Position:  [-4.17056772]


portfolio before change:  [-3.90279963]
curr_Stock_Price:  100.4959046532706
curr_Factors:  [100.49590465  -0.91525823  -0.90116833]
mat_Sqrt:  [[16.34121453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01141875 -0.02756806 -0.15824903]
Stock Position:  -0.0114187532055662
Bond Position:  [-2.7552617]


portfolio before change:  [-3.89033216]
curr_Stock_Price:  99.37389919749985
curr_Factors:  [99.3738992  -0.82243343 -0.92419405]
mat_Sqrt:  [[17.32693127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06801023  0.55668996 -0.87016684]
Stock Position:  0.06801022990531295
Bond Position:  [-10.64877389]


portfolio before change:  [-3.84707614]
curr_Stock_Price:  100.02949457287248
curr_Factors:  [100.02949457  -0.77338332  -0.92662475]
mat_Sqrt:  [[18.273593    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.90723744e-05  2.85732394e-04 -6.03117493e-03]
Stock Position:  -2.9072374377321115e-05
Bond Position:  [-3.84416805]


portfolio before change:  [-3.84755935]
curr_Stock_Price:  100.1207217451685
curr_Factors:  [100.12072175  -0.74400985  -0.92796233]
mat_Sqrt:  [[18.81029813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.13519069e-02  6.46383869e-04 -1.70125440e+00]
Stock Position:  -0.021351906942015483
Bond Position:  [-1.70979101]


portfolio before change:  [-3.85455324]
curr_Stock_Price:  100.43826508953738
curr_Factors:  [100.43826509  -0.44079014  -0.90613672]
mat_Sqrt:  [[26.11778247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05976072 -0.9548729   7.09149916]
Stock Position:  0.05976072081335674
Bond Position:  [-9.85681636]


portfolio before change:  [-3.90874182]
curr_Stock_Price:  99.55212447191478
curr_Factors:  [99.55212447 -0.10994094 -0.91816109]
mat_Sqrt:  [[35.6083207   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060855 -0.03053791  0.10625201]
Stock Position:  -0.0006085480149856515
Bond Position:  [-3.84815957]


portfolio before change:  [-3.90900202]
curr_Stock_Price:  99.18920244842035
curr_Factors:  [ 9.91892024e+01 -3.47911885e-02 -9.28267573e-01]
mat_Sqrt:  [[37.86284926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00289744  0.02324842 -0.20152134]
Stock Position:  0.002897439898552384
Bond Position:  [-4.19639677]


portfolio before change:  [-3.90952647]
curr_Stock_Price:  99.18924700267213
curr_Factors:  [99.189247  -0.3866521 -0.9184509]
mat_Sqrt:  [[26.89462927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156622  0.01335984 -0.24056049]
Stock Position:  -0.0015662217418061207
Bond Position:  [-3.75417411]


portfolio before change:  [-3.90999663]
curr_Stock_Price:  99.18979476710749
curr_Factors:  [99.18979477 -0.45229578 -0.88986606]
mat_Sqrt:  [[25.91633036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02667294 -0.58518191 -0.5646849 ]
Stock Position:  -0.026672938374396313
Bond Position:  [-1.26431334]


portfolio before change:  [-3.87979314]
curr_Stock_Price:  98.05150502754357
curr_Factors:  [98.05150503 -0.59206337 -0.88312314]
mat_Sqrt:  [[22.4279152   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00081493 -0.00315138  0.00901091]
Stock Position:  0.0008149329866826543
Bond Position:  [-3.95969855]


portfolio before change:  [-3.88008369]
curr_Stock_Price:  98.30238029758813
curr_Factors:  [98.3023803  -0.83314722 -0.86898962]
mat_Sqrt:  [[17.91989228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01209294 0.07220666 0.89795013]
Stock Position:  0.012092938967797978
Bond Position:  [-5.06884838]


portfolio before change:  [-3.86409346]
curr_Stock_Price:  99.67705646471019
curr_Factors:  [99.67705646 -1.07373837 -0.86332826]
mat_Sqrt:  [[14.36606591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177561 -0.02855031  0.11265975]
Stock Position:  0.0017756132972020036
Bond Position:  [-4.04108137]


portfolio before change:  [-3.86715525]
curr_Stock_Price:  98.23720632459865
curr_Factors:  [98.23720632 -1.11171831 -0.86236334]
mat_Sqrt:  [[13.64404795  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00794218 -0.01653244  0.09110854]
Stock Position:  0.00794218021359161
Bond Position:  [-4.64737284]


portfolio before change:  [-3.87465105]
curr_Stock_Price:  97.36655778388466
curr_Factors:  [97.36655778 -1.04450411 -0.85160748]
mat_Sqrt:  [[14.61971862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00634883 -0.0285554  -0.24383343]
Stock Position:  -0.006348831421620316
Bond Position:  [-3.25648719]


portfolio before change:  [-3.87215352]
curr_Stock_Price:  96.90905308969771
curr_Factors:  [96.90905309 -0.79958925 -0.84358421]
mat_Sqrt:  [[18.73886061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00558363 -0.00457437  0.18126711]
Stock Position:  -0.0055836288385926695
Bond Position:  [-3.33104933]


portfolio before change:  [-3.87023979]
curr_Stock_Price:  96.49173707986526
curr_Factors:  [96.49173708 -0.87018423 -0.84410675]
mat_Sqrt:  [[17.37732859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0052409   0.00575266 -0.09682263]
Stock Position:  0.005240900951234301
Bond Position:  [-4.37594342]


portfolio before change:  [-3.8645059]
curr_Stock_Price:  97.69017967207915
curr_Factors:  [97.69017967 -0.93150615 -0.8837216 ]
mat_Sqrt:  [[15.90404193  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00423447 -0.01491152  0.73716925]
Stock Position:  0.004234472898999464
Bond Position:  [-4.27817231]


portfolio before change:  [-3.8671]
curr_Stock_Price:  97.20386208914076
curr_Factors:  [97.20386209 -1.21944869 -0.90712062]
mat_Sqrt:  [[11.59114135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00271658 -0.0407312   0.11086332]
Stock Position:  0.0027165797818029065
Bond Position:  [-4.13116205]


portfolio before change:  [-3.86741976]
curr_Stock_Price:  97.27625838949457
curr_Factors:  [97.27625839 -1.15745486 -0.94018262]
mat_Sqrt:  [[11.94027901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0041787  -0.0081768   0.16398332]
Stock Position:  -0.004178698834968714
Bond Position:  [-3.46093157]


portfolio before change:  [-3.8645613]
curr_Stock_Price:  96.4886680449731
curr_Factors:  [96.48866804 -1.0542999  -0.93388487]
mat_Sqrt:  [[13.21352332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00891845 0.00843431 0.32367744]
Stock Position:  0.008918448671271378
Bond Position:  [-4.72509053]


portfolio before change:  [-3.87383335]
curr_Stock_Price:  95.51524988346425
curr_Factors:  [95.51524988 -0.99601514 -0.89722184]
mat_Sqrt:  [[14.38302851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00984978  0.04001778 -0.07678887]
Stock Position:  -0.009849779555008728
Bond Position:  [-2.93302919]


portfolio before change:  [-3.87226371]
curr_Stock_Price:  95.31866788834462
curr_Factors:  [95.31866789 -0.85930948 -0.8929356 ]
mat_Sqrt:  [[16.5267553   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00426634 -0.00359268 -0.12538452]
Stock Position:  0.004266336605684561
Bond Position:  [-4.27892523]


portfolio before change:  [-3.87247358]
curr_Stock_Price:  95.3948531222593
curr_Factors:  [95.39485312 -0.75092581 -0.86959   ]
mat_Sqrt:  [[18.8687821   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00070678 -0.00063841 -0.16860329]
Stock Position:  0.0007067849117498524
Bond Position:  [-3.93989722]


portfolio before change:  [-3.87323254]
curr_Stock_Price:  95.01787734167328
curr_Factors:  [95.01787734 -0.85933748 -0.88926407]
mat_Sqrt:  [[16.53473807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00163195 0.0140981  0.27245059]
Stock Position:  0.0016319518211936439
Bond Position:  [-4.02829714]


portfolio before change:  [-3.87301128]
curr_Stock_Price:  95.46202358195137
curr_Factors:  [95.46202358 -0.96118181 -0.88294726]
mat_Sqrt:  [[15.09856104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003511  -0.01525643 -0.03613286]
Stock Position:  -0.0003511001707155803
Bond Position:  [-3.83949455]


portfolio before change:  [-3.87308679]
curr_Stock_Price:  94.31005151882266
curr_Factors:  [94.31005152 -0.73452944 -0.9071762 ]
mat_Sqrt:  [[18.26309097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362923  0.02085814  0.13243462]
Stock Position:  -0.003629234660825155
Bond Position:  [-3.53081348]


portfolio before change:  [-3.8783751]
curr_Stock_Price:  95.64557466919504
curr_Factors:  [95.64557467 -0.70329049 -0.89870728]
mat_Sqrt:  [[19.27196893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0070098  -0.01971069 -0.20308701]
Stock Position:  -0.007009804933917577
Bond Position:  [-3.20791828]


portfolio before change:  [-3.87992934]
curr_Stock_Price:  95.81009049083447
curr_Factors:  [95.81009049 -0.85346461 -0.89906712]
mat_Sqrt:  [[16.60719903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.14591241 0.43773084 0.45610204]
Stock Position:  0.1459124126639474
Bond Position:  [-17.8598108]


portfolio before change:  [-3.88559894]
curr_Stock_Price:  95.7865353233128
curr_Factors:  [95.78653532 -0.97367023 -0.90765147]
mat_Sqrt:  [[14.59677213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00307902 -0.02997822  0.12115054]
Stock Position:  0.003079022900079061
Bond Position:  [-4.18052788]


portfolio before change:  [-3.88395065]
curr_Stock_Price:  96.49159513013747
curr_Factors:  [96.49159513 -1.31545465 -0.89498368]
mat_Sqrt:  [[10.58055182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194832 -0.00471921 -0.10465834]
Stock Position:  0.0019483178508215692
Bond Position:  [-4.07194694]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.88410158]
Stock Price:  96.67538872330104
PL:  [-3.88410158]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-1.15103941e-02 -1.16539356e-01  9.14582356e-02]
 [ 1.16844851e+00  2.38697745e-01  3.34794888e-01]
 [-1.70899468e-01 -7.08390368e-02  3.47815167e-02]
 [ 3.61923159e-02  2.63877208e-01  2.31735191e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.85473813e-02  3.70714673e-02 -3.88524392e-03]
 [-3.21888650e-02 -1.19266517e-01  2.13006366e-03]
 [ 1.66675969e-01  6.15101665e-02 -1.54532379e-01]
 [ 2.37543499e-02  5.48272084e-02 -4.50242145e-02]
 [-4.57375469e-01  6.31558768e-02 -1.67797481e-01]
 [ 5.29875162e-01  1.04827466e+00 -1.79158217e-01]
 [-2.23909365e-04  1.67581613e-02 -5.76125843e-02]
 [-1.14845656e-01 -3.87129540e-03 -2.40657873e-01]
 [ 1.56888259e+00 -3.00368543e+00  2.51498995e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.27834004e-01 -7.00989507e-02  1.46453619e-02]
 [-1.14949586e-01 -1.22407168e-01 -4.14639170e-02]
 [-2.60916381e-01 -1.70480297e+00 -1.99634588e-01]
 [ 3.91715030e-04  3.46880449e-02  7.37167683e-02]
 [ 3.14255313e-01 -4.60007153e-01  2.81922532e-01]
 [ 7.95203626e-02 -8.63792892e-03 -1.08745006e-01]
 [ 2.70114761e-02 -5.43251292e-02 -8.20812968e-02]
 [ 2.00140778e-01  2.57057665e-01  2.10413957e-01]
 [-1.60459614e-01  4.98208321e-02  8.89400948e-02]
 [-7.14720714e-02 -2.24096420e-01  8.62989985e-02]
 [ 1.01962868e-01 -2.62377972e-02 -9.74051913e-02]
 [ 4.42370849e-01 -2.87832713e-02  2.70018838e-01]
 [-5.87570848e-02  6.08282941e-02  1.05578460e-01]
 [-1.07283924e-02 -7.61248443e-02 -5.19356087e-03]
 [ 2.47640792e-01 -8.61815786e-02  3.05793712e-03]
 [-1.69345983e-02 -7.30174102e-02 -2.96266644e-02]
 [ 2.54340937e-02 -1.43335507e-02 -1.29037361e-02]
 [-1.18069121e-01 -3.87448071e-02  2.12500833e-02]
 [ 5.18275263e-02  5.87381925e-03  1.05928174e-02]
 [-1.08995584e-01  2.45440965e-02  3.13013816e-02]
 [-1.14043890e-01 -5.21679625e-02 -1.00327280e-01]
 [ 2.82574543e+00  1.80404978e+00  1.88045405e-01]
 [-2.05233651e-02 -8.69550057e-02 -3.93667443e-02]
 [ 3.31033318e-02 -1.38311912e-02 -6.87180209e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.50639979]
curr_Stock_Price:  99.05648113389697
curr_Factors:  [99.05648113 -1.0176509  -0.99372611]
mat_Sqrt:  [[13.25418292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012547  -0.03761292  0.26090489]
Stock Position:  -0.001254702496252282
Bond Position:  [-4.38211337]


portfolio before change:  [-4.50876738]
curr_Stock_Price:  100.50686174103042
curr_Factors:  [100.50686174  -0.94251625  -1.00063385]
mat_Sqrt:  [[14.39780694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08928528 0.07703937 0.95507663]
Stock Position:  0.08928527851073301
Bond Position:  [-13.48255052]


portfolio before change:  [-4.48474138]
curr_Stock_Price:  100.79483107023809
curr_Factors:  [100.79483107  -0.76754834  -0.99274658]
mat_Sqrt:  [[17.33611958  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01028256 -0.0228632   0.09922199]
Stock Position:  -0.010282559367690989
Bond Position:  [-3.44831255]


portfolio before change:  [-4.50691481]
curr_Stock_Price:  102.90932046771088
curr_Factors:  [102.90932047  -0.93434761  -0.98870314]
mat_Sqrt:  [[15.0412656   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00913213 0.085166   0.661076  ]
Stock Position:  0.009132128697403926
Bond Position:  [-5.44669597]


portfolio before change:  [-4.50592703]
curr_Stock_Price:  103.09204507818755
curr_Factors:  [103.09204508  -0.73449164  -1.00688037]
mat_Sqrt:  [[18.0699478   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0032455  -0.01106097 -0.05874131]
Stock Position:  -0.003245499189150397
Bond Position:  [-4.17134188]


portfolio before change:  [-4.50519622]
curr_Stock_Price:  102.70620064536867
curr_Factors:  [102.70620065  -1.16181997  -1.00513509]
mat_Sqrt:  [[11.76251089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00640352  0.01196476 -0.01108352]
Stock Position:  0.006403521444344659
Bond Position:  [-5.16287758]


portfolio before change:  [-4.500034]
curr_Stock_Price:  103.61314222893905
curr_Factors:  [103.61314223  -1.21679325  -1.00310593]
mat_Sqrt:  [[11.25446568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00498462 -0.0384931   0.00607648]
Stock Position:  -0.004984620776506095
Bond Position:  [-3.98356178]


portfolio before change:  [-4.49757857]
curr_Stock_Price:  103.02063922040227
curr_Factors:  [103.02063922  -1.02883226  -1.01229394]
mat_Sqrt:  [[13.38056324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01103749  0.01985232 -0.44083786]
Stock Position:  0.011037494181583537
Bond Position:  [-5.63466828]


portfolio before change:  [-4.496763]
curr_Stock_Price:  103.15834758000983
curr_Factors:  [103.15834758  -0.80007787  -0.99029432]
mat_Sqrt:  [[17.21692615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149593  0.01769541 -0.12844155]
Stock Position:  0.0014959335588970292
Bond Position:  [-4.65108103]


portfolio before change:  [-4.49612317]
curr_Stock_Price:  103.97472350179297
curr_Factors:  [103.9747235   -0.9061887   -0.95808284]
mat_Sqrt:  [[16.11702694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0297037   0.02038347 -0.47867951]
Stock Position:  -0.02970370085597514
Bond Position:  [-1.40768909]


portfolio before change:  [-4.49357777]
curr_Stock_Price:  103.88310615091876
curr_Factors:  [103.88310615  -0.81136674  -0.95342173]
mat_Sqrt:  [[17.78717719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03976363  0.33832919 -0.51108852]
Stock Position:  0.0397636345066355
Bond Position:  [-8.62434763]


portfolio before change:  [-4.52786029]
curr_Stock_Price:  103.04806165352812
curr_Factors:  [103.04806165  -0.7577807   -0.94309606]
mat_Sqrt:  [[18.80868501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045528  0.00540867 -0.16435267]
Stock Position:  -0.00045528347837955343
Bond Position:  [-4.48094421]


portfolio before change:  [-4.52828085]
curr_Stock_Price:  102.74146408017988
curr_Factors:  [102.74146408  -0.66689376  -0.93129992]
mat_Sqrt:  [[20.78064662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00792853 -0.00124946 -0.68652992]
Stock Position:  -0.007928529215907034
Bond Position:  [-3.71369215]


portfolio before change:  [-4.52836802]
curr_Stock_Price:  102.69390508455933
curr_Factors:  [102.69390508  -0.71397056  -0.94167725]
mat_Sqrt:  [[19.61128083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0749124  -0.9694353   7.17456629]
Stock Position:  0.07491239662942893
Bond Position:  [-12.22141457]


portfolio before change:  [-4.50549184]
curr_Stock_Price:  103.01967163564099
curr_Factors:  [103.01967164  -0.61848382  -0.93227196]
mat_Sqrt:  [[21.84919706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00099177 -0.03053791  0.10625201]
Stock Position:  -0.000991769757957916
Bond Position:  [-4.40332004]


portfolio before change:  [-4.50571148]
curr_Stock_Price:  102.68612140848305
curr_Factors:  [102.68612141  -0.90296076  -0.89854549]
mat_Sqrt:  [[16.94835407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00687468 -0.02262434  0.04177914]
Stock Position:  0.006874684556286237
Bond Position:  [-5.21164617]


portfolio before change:  [-4.51245175]
curr_Stock_Price:  101.80044062566512
curr_Factors:  [101.80044063  -1.02829231  -0.90360931]
mat_Sqrt:  [[14.74807859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0100623  -0.03950674 -0.11828501]
Stock Position:  -0.01006230268520157
Bond Position:  [-3.48810491]


portfolio before change:  [-4.52225289]
curr_Stock_Price:  102.731151338709
curr_Factors:  [102.73115134  -1.04170173  -0.89603241]
mat_Sqrt:  [[14.79636078  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04390661 -0.55022279 -0.56950191]
Stock Position:  -0.043906611886428915
Bond Position:  [-0.0116761]


portfolio before change:  [-4.54834614]
curr_Stock_Price:  103.32540792410346
curr_Factors:  [103.32540792  -0.95275072  -0.89737328]
mat_Sqrt:  [[16.24457984  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00138629 0.01119552 0.21029342]
Stock Position:  0.0013862934649925963
Bond Position:  [-4.69158548]


portfolio before change:  [-4.54808398]
curr_Stock_Price:  103.93757786274578
curr_Factors:  [103.93757786  -1.11117442  -0.88694337]
mat_Sqrt:  [[14.09292245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0197194  -0.14846667  0.80424651]
Stock Position:  0.019719397627208608
Bond Position:  [-6.5976704]


portfolio before change:  [-4.54009399]
curr_Stock_Price:  104.38458687327852
curr_Factors:  [104.38458687  -1.06287379  -0.87910144]
mat_Sqrt:  [[14.97087737  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00371118 -0.00278788 -0.31021923]
Stock Position:  0.0037111833882755483
Bond Position:  [-4.92748433]


portfolio before change:  [-4.54168714]
curr_Stock_Price:  104.12128026668059
curr_Factors:  [104.12128027  -1.21047328  -0.90953591]
mat_Sqrt:  [[12.49773197  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.66016078e-05 -1.75333600e-02 -2.34155093e-01]
Stock Position:  -6.660160779951198e-05
Bond Position:  [-4.5347525]


portfolio before change:  [-4.54224644]
curr_Stock_Price:  104.00751557842746
curr_Factors:  [104.00751558  -1.25573577  -0.90433768]
mat_Sqrt:  [[11.99379839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02464299 0.082965   0.60025245]
Stock Position:  0.024642987404513914
Bond Position:  [-7.10530234]


portfolio before change:  [-4.54226919]
curr_Stock_Price:  104.0426361160413
curr_Factors:  [104.04263612  -1.11324981  -0.90662884]
mat_Sqrt:  [[13.80349918  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00957258  0.0160796   0.25372133]
Stock Position:  -0.00957258419131353
Bond Position:  [-3.54631229]


portfolio before change:  [-4.5429689]
curr_Stock_Price:  104.06942094424613
curr_Factors:  [104.06942094  -1.18006638  -0.91783122]
mat_Sqrt:  [[12.77079072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00779904 -0.07232681  0.24618702]
Stock Position:  -0.007799035655199005
Bond Position:  [-3.73132778]


portfolio before change:  [-4.54466235]
curr_Stock_Price:  104.2267481082627
curr_Factors:  [104.22674811  -1.07024094  -0.90728986]
mat_Sqrt:  [[14.42608452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00531845 -0.00846821 -0.2778699 ]
Stock Position:  0.005318445773703766
Bond Position:  [-5.09898666]


portfolio before change:  [-4.54248673]
curr_Stock_Price:  104.75566758972963
curr_Factors:  [104.75566759  -0.78068331  -0.90442113]
mat_Sqrt:  [[19.4243266   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02530913 -0.00928976  0.77028859]
Stock Position:  0.025309132356417505
Bond Position:  [-7.19376179]


portfolio before change:  [-4.5239387]
curr_Stock_Price:  105.52405851763511
curr_Factors:  [105.52405852  -0.8663643   -0.87376107]
mat_Sqrt:  [[18.51930318  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00133857  0.01963225  0.30118596]
Stock Position:  -0.0013385734970693343
Bond Position:  [-4.38268699]


portfolio before change:  [-4.52164928]
curr_Stock_Price:  103.40441885130143
curr_Factors:  [103.40441885  -0.87717431  -0.7836832 ]
mat_Sqrt:  [[19.64435827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139111 -0.02456919 -0.01481578]
Stock Position:  -0.0013911089372197463
Bond Position:  [-4.37780247]


portfolio before change:  [-4.52409352]
curr_Stock_Price:  104.76806327432668
curr_Factors:  [104.76806327  -0.96959608  -0.79315831]
mat_Sqrt:  [[17.97522813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01283284 -0.02781498  0.00872344]
Stock Position:  0.012832841273154311
Bond Position:  [-5.86856544]


portfolio before change:  [-4.52783886]
curr_Stock_Price:  104.53337416503216
curr_Factors:  [104.53337417  -0.72605798  -0.764669  ]
mat_Sqrt:  [[23.54184341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00160934 -0.02356627 -0.08451663]
Stock Position:  -0.0016093358359000414
Bond Position:  [-4.35960956]


portfolio before change:  [-4.529133]
curr_Stock_Price:  104.99887994946589
curr_Factors:  [104.99887995  -0.76160362  -0.77970207]
mat_Sqrt:  [[22.48040393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00088407 -0.00462613 -0.03681077]
Stock Position:  0.000884072450410715
Bond Position:  [-4.62195962]


portfolio before change:  [-4.53212101]
curr_Stock_Price:  102.27260125740007
curr_Factors:  [102.27260126  -0.40583762  -0.75232325]
mat_Sqrt:  [[32.12006608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378705 -0.01250483  0.06062057]
Stock Position:  -0.003787047509990967
Bond Position:  [-4.14480981]


portfolio before change:  [-4.52620225]
curr_Stock_Price:  100.57288731853518
curr_Factors:  [100.57288732  -0.61688194  -0.7241842 ]
mat_Sqrt:  [[26.3065134   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00209791 0.00189577 0.03021836]
Stock Position:  0.0020979125443415943
Bond Position:  [-4.73719537]


portfolio before change:  [-4.52529054]
curr_Stock_Price:  101.28973746691345
curr_Factors:  [101.28973747  -1.08126296  -0.74492086]
mat_Sqrt:  [[16.3103728   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00598369  0.00792157  0.08929413]
Stock Position:  -0.005983687456403174
Bond Position:  [-3.91920441]


portfolio before change:  [-4.52819023]
curr_Stock_Price:  101.69245867293009
curr_Factors:  [101.69245867  -0.90065087  -0.75168056]
mat_Sqrt:  [[19.48454756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00745061 -0.01683714 -0.2862058 ]
Stock Position:  -0.007450614407219075
Bond Position:  [-3.77051894]


portfolio before change:  [-4.52429322]
curr_Stock_Price:  101.10614982459686
curr_Factors:  [101.10614982  -0.93854125  -0.79608943]
mat_Sqrt:  [[17.84173302  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.18116963 0.58225456 0.5364412 ]
Stock Position:  0.1811696291722181
Bond Position:  [-22.84165689]


portfolio before change:  [-4.53715913]
curr_Stock_Price:  101.05089484474878
curr_Factors:  [101.05089484  -0.65839169  -0.83105525]
mat_Sqrt:  [[22.78670759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203227 -0.02806461 -0.11230236]
Stock Position:  -0.002032267459838402
Bond Position:  [-4.33179668]


portfolio before change:  [-4.53466036]
curr_Stock_Price:  99.55489269777182
curr_Factors:  [99.5548927  -0.47593205 -0.80295618]
mat_Sqrt:  [[27.71076442  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00058652 -0.004464   -0.19603339]
Stock Position:  0.0005865245779584396
Bond Position:  [-4.59305175]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.53506542]
Stock Price:  99.84320541112318
PL:  [-4.53506542]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 5.93918654e-03 -1.01552215e-01  3.10283134e-02]
 [ 1.04361834e+00  2.18702661e-01  3.02304456e-01]
 [-3.51319159e-01 -2.36911637e-01  4.00441019e-02]
 [ 1.82472528e-01  1.45673898e+00  1.18254880e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 2.76564781e-02 -8.98709718e-02  5.01076722e-02]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [ 6.52443961e-02  1.36530829e-01 -4.34072289e-02]
 [ 2.35597939e-03  7.79837035e-02 -4.85422782e-02]
 [-1.96321577e-01 -1.09313547e-01 -8.20734456e-02]
 [ 7.57395625e-01  1.45246406e+00 -2.65275796e-01]
 [-1.34140614e-04  3.33563801e-02 -5.85781662e-02]
 [-3.19851050e-01 -7.96576131e-03 -6.47067066e-01]
 [ 1.78736083e+00 -3.45398904e+00  2.91195331e+00]
 [ 2.48694390e-02 -8.95546301e-02  3.49243860e-02]
 [ 1.11614611e-01 -4.92465203e-02  2.59969042e-03]
 [-1.09897872e-01 -1.08596252e-01 -3.97121900e-02]
 [-2.63278893e-01 -1.71239679e+00 -1.97517716e-01]
 [-2.89304545e-02  1.30490840e-01  3.39920283e-01]
 [ 2.86137024e-01 -7.17690617e-02  4.99860798e-01]
 [ 9.18552557e-02 -3.53409716e-01 -8.89028412e-02]
 [ 1.57772038e-01 -5.54882537e-02 -2.01685659e-02]
 [ 9.08330778e-02  2.05009021e-01  1.35224783e-01]
 [ 3.80640657e-01 -3.66014227e-01 -1.86170469e-01]
 [-3.44496462e-02 -1.01883441e-01  4.69969150e-02]
 [ 4.88352386e-02 -1.42935193e-02 -4.86624623e-04]
 [ 6.74691955e-01 -9.58194079e-02  3.51000780e-01]
 [ 1.42406948e-01 -3.07465885e-01 -1.87846270e-01]
 [-9.08028604e-03 -7.45271718e-02 -2.42695355e-03]
 [ 2.26992267e-01 -1.13132025e-01  6.02437629e-02]
 [-1.54612043e-02 -3.84855944e-02 -5.18332990e-02]
 [-6.26812288e-02  1.97550896e-02 -3.60332561e-02]
 [-3.77305111e-02  3.53096328e-02 -1.03584961e-01]
 [ 3.60196631e-01  6.87663018e-02  9.21872972e-02]
 [-8.36097641e-02 -5.74312248e-02  7.57101837e-02]
 [-1.00338786e-01 -4.62589737e-02 -8.54150258e-02]
 [ 2.10607343e+00  1.37115409e+00  1.63422009e-01]
 [-1.95221257e-02 -1.41330181e-01 -5.51893563e-02]
 [ 3.98958001e-02 -2.35437069e-02 -1.90184327e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.87224108]
curr_Stock_Price:  99.00655784595591
curr_Factors:  [99.00655785 -1.13402213 -1.00057824]
mat_Sqrt:  [[11.71166924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072205 -0.03277584  0.08851514]
Stock Position:  -0.0007220528861482614
Bond Position:  [-4.80075311]


portfolio before change:  [-4.8733104]
curr_Stock_Price:  99.65636134881119
curr_Factors:  [99.65636135 -1.40377457 -1.00603373]
mat_Sqrt:  [[ 8.95238148  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.12845392 0.07058598 0.86239047]
Stock Position:  0.128453917410899
Bond Position:  [-17.67456041]


portfolio before change:  [-4.95929221]
curr_Stock_Price:  99.00420260554324
curr_Factors:  [99.00420261 -1.29257086 -0.99782904]
mat_Sqrt:  [[10.02179677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03906531 -0.0764629   0.11423468]
Stock Position:  -0.03906530781600552
Bond Position:  [-1.09166256]


portfolio before change:  [-4.98436337]
curr_Stock_Price:  99.64248506457884
curr_Factors:  [99.64248506 -1.21305133 -1.02724927]
mat_Sqrt:  [[10.60460175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06800962 0.47016048 3.37348258]
Stock Position:  0.0680096158002144
Bond Position:  [-11.7610105]


portfolio before change:  [-4.98294429]
curr_Stock_Price:  99.68496877938166
curr_Factors:  [99.68496878 -1.3878428  -1.01826036]
mat_Sqrt:  [[ 8.98819219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00652478 -0.01106097 -0.05874131]
Stock Position:  -0.0065247827064395525
Bond Position:  [-4.33252153]


portfolio before change:  [-4.98601765]
curr_Stock_Price:  100.07299105151861
curr_Factors:  [100.07299105  -1.49102927  -1.02650685]
mat_Sqrt:  [[ 8.0716967   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00242078 -0.02900573  0.14294324]
Stock Position:  0.0024207832985594486
Bond Position:  [-5.22827268]


portfolio before change:  [-4.98502264]
curr_Stock_Price:  100.75400284298979
curr_Factors:  [100.75400284  -1.35945136  -1.03022638]
mat_Sqrt:  [[ 9.23503306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00717814 -0.00251018 -0.21167328]
Stock Position:  -0.007178135965440779
Bond Position:  [-4.26179671]


portfolio before change:  [-4.98659345]
curr_Stock_Price:  100.8986155651235
curr_Factors:  [100.89861557  -1.38850278  -1.01317263]
mat_Sqrt:  [[ 9.13799319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0092201   0.04406514 -0.12382874]
Stock Position:  0.00922009565816798
Bond Position:  [-5.91688834]


portfolio before change:  [-4.99187054]
curr_Stock_Price:  100.40649197593075
curr_Factors:  [100.40649198  -1.22297067  -0.99575381]
mat_Sqrt:  [[10.91897806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00076616  0.02516913 -0.13847761]
Stock Position:  0.0007661600860000521
Bond Position:  [-5.06879798]


portfolio before change:  [-4.99218234]
curr_Stock_Price:  100.82655899487264
curr_Factors:  [100.82655899  -1.39016451  -1.00728124]
mat_Sqrt:  [[ 9.17017216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02566891 -0.0352808  -0.2341327 ]
Stock Position:  -0.025668905625344792
Bond Position:  [-2.40407491]


portfolio before change:  [-4.9956324]
curr_Stock_Price:  100.94925737249623
curr_Factors:  [100.94925737  -1.52143345  -1.02806629]
mat_Sqrt:  [[ 7.88623034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12676898  0.46878076 -0.75675801]
Stock Position:  0.1267689847402969
Bond Position:  [-17.79286726]


portfolio before change:  [-5.0171202]
curr_Stock_Price:  100.79729937974876
curr_Factors:  [100.79729938  -1.67163519  -1.00592049]
mat_Sqrt:  [[ 6.92789409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007625   0.01076573 -0.1671072 ]
Stock Position:  -0.0007624995527802163
Bond Position:  [-4.94026231]


portfolio before change:  [-5.01778868]
curr_Stock_Price:  100.86405826149124
curr_Factors:  [100.86405826  -1.53057476  -1.00173768]
mat_Sqrt:  [[ 8.01617368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05658049 -0.00257094 -1.84590223]
Stock Position:  -0.056580493871642205
Bond Position:  [0.68914955]


portfolio before change:  [-5.05845523]
curr_Stock_Price:  101.584318911028
curr_Factors:  [101.58431891  -1.54265197  -1.03163791]
mat_Sqrt:  [[ 7.74152975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.21658746 -1.11477017  8.30699226]
Stock Position:  0.21658745754238068
Bond Position:  [-27.06034459]


portfolio before change:  [-4.9343239]
curr_Stock_Price:  102.17306072207623
curr_Factors:  [102.17306072  -2.0843063   -1.05323186]
mat_Sqrt:  [[ 4.43323644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00309437 -0.02890363  0.09962955]
Stock Position:  0.0030943729909373064
Bond Position:  [-5.25048546]


portfolio before change:  [-4.935287]
curr_Stock_Price:  102.07392966140377
curr_Factors:  [102.07392966  -1.97967899  -1.04160677]
mat_Sqrt:  [[ 4.97493144  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02052146 -0.01589425  0.00741619]
Stock Position:  0.020521461958045432
Bond Position:  [-7.02999326]


portfolio before change:  [-4.93989998]
curr_Stock_Price:  101.89196513103845
curr_Factors:  [101.89196513  -2.05922706  -1.04724677]
mat_Sqrt:  [[ 4.56053191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03073571 -0.03504929 -0.11328782]
Stock Position:  -0.03073571431595089
Bond Position:  [-1.80817765]


portfolio before change:  [-4.9404958]
curr_Stock_Price:  101.90399623589917
curr_Factors:  [101.90399624  -1.72085961  -1.01289492]
mat_Sqrt:  [[ 6.62120001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09864353 -0.55267369 -0.56346306]
Stock Position:  -0.09864353250364244
Bond Position:  [5.11167436]


portfolio before change:  [-4.92800753]
curr_Stock_Price:  101.78387411954638
curr_Factors:  [101.78387412  -1.65967071  -1.00003219]
mat_Sqrt:  [[ 7.12171654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00942074 0.04211574 0.96969795]
Stock Position:  0.00942073633616442
Bond Position:  [-5.88688657]


portfolio before change:  [-4.92582226]
curr_Stock_Price:  102.09395416945362
curr_Factors:  [102.09395417  -1.59361382  -1.01192782]
mat_Sqrt:  [[ 7.54097785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04953216 -0.02316337  1.42596372]
Stock Position:  0.04953215508738773
Bond Position:  [-9.98275583]


portfolio before change:  [-4.90707928]
curr_Stock_Price:  102.49754847265608
curr_Factors:  [102.49754847  -1.91423213  -1.01843547]
mat_Sqrt:  [[ 5.458485    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028737 -0.1140625  -0.25361506]
Stock Position:  0.0002873660000416861
Bond Position:  [-4.93653359]


portfolio before change:  [-4.90763735]
curr_Stock_Price:  102.70299721891499
curr_Factors:  [102.70299722  -2.13178672  -1.05297967]
mat_Sqrt:  [[ 4.25066276  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03348387 -0.01790876 -0.0575353 ]
Stock Position:  0.03348387357142853
Bond Position:  [-8.34653152]


portfolio before change:  [-4.8951918]
curr_Stock_Price:  103.10584569807153
curr_Factors:  [103.1058457   -2.020792    -1.05012991]
mat_Sqrt:  [[ 4.78188192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03351881 0.06616638 0.38575867]
Stock Position:  0.03351881434230142
Bond Position:  [-8.3511775]


portfolio before change:  [-4.88896293]
curr_Stock_Price:  103.32282346218304
curr_Factors:  [103.32282346  -2.06096754  -1.02188947]
mat_Sqrt:  [[ 4.73509258  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05658314 -0.11813058 -0.53109253]
Stock Position:  0.05658314455429655
Bond Position:  [-10.73529318]


portfolio before change:  [-4.88412627]
curr_Stock_Price:  103.43201950444556
curr_Factors:  [103.4320195   -2.15622476  -1.00828886]
mat_Sqrt:  [[ 4.36841815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01045076 -0.03288274  0.13406912]
Stock Position:  -0.010450764993554667
Bond Position:  [-3.80318254]


portfolio before change:  [-4.88268478]
curr_Stock_Price:  103.24859618936756
curr_Factors:  [103.24859619  -1.94901104  -0.99345461]
mat_Sqrt:  [[ 5.44487058  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00841494 -0.00461321 -0.0013882 ]
Stock Position:  0.008414939099022465
Bond Position:  [-5.75151543]


portfolio before change:  [-4.88605099]
curr_Stock_Price:  102.93401037275464
curr_Factors:  [102.93401037  -1.87511532  -0.99806898]
mat_Sqrt:  [[ 5.81769309  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12492592 -0.03092558  1.00130753]
Stock Position:  0.12492591516863923
Bond Position:  [-17.74517643]


portfolio before change:  [-4.96768353]
curr_Stock_Price:  102.29831952363702
curr_Factors:  [102.29831952  -1.72281643  -0.9726658 ]
mat_Sqrt:  [[ 6.90614097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00598044 -0.09923419 -0.53587312]
Stock Position:  0.005980442359425815
Bond Position:  [-5.57947274]


portfolio before change:  [-4.96841455]
curr_Stock_Price:  102.29271148147747
curr_Factors:  [102.29271148  -1.76571922  -0.96783277]
mat_Sqrt:  [[ 6.64780306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372882 -0.02405354 -0.00692342]
Stock Position:  -0.0037288230232007903
Bond Position:  [-4.58698313]


portfolio before change:  [-4.97007512]
curr_Stock_Price:  102.58426702672132
curr_Factors:  [102.58426703  -1.74879063  -0.99976988]
mat_Sqrt:  [[ 6.56743972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03291945 -0.0365132   0.17185869]
Stock Position:  0.032919448838048204
Bond Position:  [-8.34709265]


portfolio before change:  [-4.98691362]
curr_Stock_Price:  102.10445800433082
curr_Factors:  [102.104458    -1.78190412  -0.99134032]
mat_Sqrt:  [[ 6.37734554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00531529 -0.01242117 -0.14786597]
Stock Position:  -0.00531529474970583
Bond Position:  [-4.44419833]


portfolio before change:  [-4.98701946]
curr_Stock_Price:  102.01985063682947
curr_Factors:  [102.01985064  -1.84454159  -1.0282917 ]
mat_Sqrt:  [[ 5.76805028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01144303  0.00637593 -0.10279285]
Stock Position:  -0.01144303401850606
Bond Position:  [-3.81960284]


portfolio before change:  [-4.991172]
curr_Stock_Price:  102.34101188013432
curr_Factors:  [102.34101188  -1.85342901  -1.03863459]
mat_Sqrt:  [[ 5.67600073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00910274  0.01139613 -0.29549906]
Stock Position:  -0.00910273915682844
Bond Position:  [-4.05958847]


portfolio before change:  [-4.99154794]
curr_Stock_Price:  102.3265614094578
curr_Factors:  [102.32656141  -2.01574377  -1.02134864]
mat_Sqrt:  [[ 4.90903249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08006693 0.02219423 0.2629847 ]
Stock Position:  0.08006692715607612
Bond Position:  [-13.18452128]


portfolio before change:  [-4.98985855]
curr_Stock_Price:  102.36824608281684
curr_Factors:  [102.36824608  -2.0985033   -1.00185739]
mat_Sqrt:  [[ 4.60994478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01732745 -0.01853585  0.21598008]
Stock Position:  -0.017327449924537195
Bond Position:  [-3.21607789]


portfolio before change:  [-4.98428384]
curr_Stock_Price:  102.02331688106244
curr_Factors:  [102.02331688  -2.0109196   -1.01616151]
mat_Sqrt:  [[ 4.9437308   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02573292 -0.01493002 -0.24366529]
Stock Position:  -0.025732919838866608
Bond Position:  [-2.35892601]


portfolio before change:  [-4.98173349]
curr_Stock_Price:  101.91274909443966
curr_Factors:  [101.91274909  -1.99904662  -1.03218906]
mat_Sqrt:  [[ 4.91789878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.49194129 0.44253808 0.4661975 ]
Stock Position:  0.49194128936008824
Bond Position:  [-55.11682268]


portfolio before change:  [-4.7775108]
curr_Stock_Price:  102.34189120563686
curr_Factors:  [102.34189121  -1.99871127  -1.03825943]
mat_Sqrt:  [[ 4.91036553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01214502 -0.04561412 -0.15743987]
Stock Position:  -0.01214502419454423
Bond Position:  [-3.53456606]


portfolio before change:  [-4.78187523]
curr_Stock_Price:  102.66486987641007
curr_Factors:  [102.66486988  -2.18826644  -1.05131037]
mat_Sqrt:  [[ 4.0224581   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0077584  -0.0075987  -0.05425429]
Stock Position:  0.007758400186826717
Bond Position:  [-5.57839038]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.78266136]
Stock Price:  102.65342650281978
PL:  [-7.43608786]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.08544593e-01 -5.01374147e-02 -1.41606738e-01]
 [ 1.92421907e+00  4.28798059e-01  6.85356306e-01]
 [ 1.29690584e-01  2.39773832e-01  4.29973334e-02]
 [ 8.76737253e-02  7.62654870e-01  5.75586711e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-4.06421095e-02  4.31461654e-02 -6.75701716e-02]
 [-3.21888650e-02 -1.19266517e-01  2.13006366e-03]
 [ 3.23075110e-01 -8.67130875e-02 -3.34723421e-01]
 [ 6.51121044e-03  7.34870720e-02 -4.78591249e-02]
 [-4.61936128e-01  9.10708183e-02 -1.62245385e-01]
 [ 5.52246528e-01  1.08549164e+00 -1.88262211e-01]
 [-2.51424473e-04  1.95391479e-02 -5.76563995e-02]
 [-3.62828016e-02 -2.40435623e-02 -1.89703330e-01]
 [ 1.62693153e+00 -3.12412590e+00  2.62104816e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.32522640e-01 -8.98913572e-02  2.66119205e-02]
 [-2.11322556e-01 -3.32907896e-01 -8.64885812e-03]
 [-2.50659243e-01 -1.65100557e+00 -2.01301588e-01]
 [-8.72485261e-03  3.94720757e-02  1.75755231e-01]
 [ 2.87334858e-01 -3.74938271e-01  3.02504342e-01]
 [ 5.66528956e-02  5.45452652e-02  2.93575143e-03]
 [-1.70222580e-01 -5.06848845e-02 -1.53454256e-01]
 [ 4.40781913e-01  4.12944805e-01  3.84565713e-01]
 [ 4.65413570e-02  8.54521733e-02  1.77874736e-01]
 [-1.11030138e-01 -3.45749105e-01  1.22594439e-01]
 [ 1.50717445e-01 -4.31932325e-02 -1.59514119e-01]
 [ 4.70981978e-01 -2.39231443e-02  2.91379304e-01]
 [-5.84446324e-02  6.10791557e-02  1.05239926e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 2.96347427e-01 -1.18967661e-01 -8.88993709e-03]
 [-2.81352601e-02 -8.02643999e-02 -2.24199111e-02]
 [ 8.06166562e-03 -1.09322209e-02 -1.13929008e-02]
 [-3.79025310e-02  4.05856703e-02 -1.09909327e-01]
 [ 5.69577683e-01  1.15867081e-01  1.75674524e-01]
 [ 9.93937020e-02  1.46784389e-01 -9.61383345e-02]
 [-4.34262616e-02  4.82572287e-02  2.84712476e-02]
 [ 2.05314495e+00  1.54106828e+00  2.00947834e-01]
 [-1.06316913e-01  7.27159139e-03 -3.28859324e-03]
 [ 3.98879013e-02 -1.18334990e-02 -2.24099536e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.1203477]
curr_Stock_Price:  100.50662409296145
curr_Factors:  [100.50662409  -1.14561287  -0.97531252]
mat_Sqrt:  [[12.05281502  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0057584  -0.01618178 -0.40396461]
Stock Position:  0.005758404313083429
Bond Position:  [5.54158992]


portfolio before change:  [6.12904729]
curr_Stock_Price:  101.89708685626216
curr_Factors:  [101.89708686  -1.32525831  -0.97695331]
mat_Sqrt:  [[10.19351494  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.21107978 0.13839398 1.95513078]
Stock Position:  0.21107977867939315
Bond Position:  [-15.37936725]


portfolio before change:  [6.10634385]
curr_Stock_Price:  101.7986364155196
curr_Factors:  [101.79863642  -1.2278042   -0.99549175]
mat_Sqrt:  [[11.01987834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01700663 0.07738667 0.12265942]
Stock Position:  0.01700663118343179
Bond Position:  [4.37509198]


portfolio before change:  [6.10667671]
curr_Stock_Price:  101.7860497858203
curr_Factors:  [101.78604979  -1.10691869  -0.98259333]
mat_Sqrt:  [[12.59576998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0286478  0.2461458  1.64198867]
Stock Position:  0.02864780357304172
Bond Position:  [3.19072995]


portfolio before change:  [6.12795713]
curr_Stock_Price:  102.5149556872402
curr_Factors:  [102.51495569  -1.19145206  -1.00901985]
mat_Sqrt:  [[11.35362175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0051654  -0.01106097 -0.05874131]
Stock Position:  -0.00516540027815435
Bond Position:  [6.65748791]


portfolio before change:  [6.1258893]
curr_Stock_Price:  103.07639797015919
curr_Factors:  [103.07639797  -1.17234347  -1.02282212]
mat_Sqrt:  [[11.47653888  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00397573  0.01392536 -0.19275889]
Stock Position:  -0.003975731649739195
Bond Position:  [6.53569339]


portfolio before change:  [6.12616503]
curr_Stock_Price:  103.2125435478679
curr_Factors:  [103.21254355  -1.01399517  -1.03905077]
mat_Sqrt:  [[13.24664695  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423498 -0.0384931   0.00607648]
Stock Position:  -0.0042349768713469274
Bond Position:  [6.56326777]


portfolio before change:  [6.11677325]
curr_Stock_Price:  105.62394653059782
curr_Factors:  [105.62394653  -1.04883992  -1.05522928]
mat_Sqrt:  [[12.88180571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0184019  -0.02798653 -0.95487275]
Stock Position:  0.01840190327983881
Bond Position:  [4.17309161]


portfolio before change:  [6.10734899]
curr_Stock_Price:  105.0834623058081
curr_Factors:  [105.08346231  -1.19495975  -1.03936069]
mat_Sqrt:  [[11.25074644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104371  0.02371785 -0.13652876]
Stock Position:  0.001043707926144752
Bond Position:  [5.99767254]


portfolio before change:  [6.10695652]
curr_Stock_Price:  103.98907813655251
curr_Factors:  [103.98907814  -1.16546443  -1.03789052]
mat_Sqrt:  [[11.48372621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04149042  0.02939298 -0.46284092]
Stock Position:  -0.041490415830826334
Bond Position:  [10.42150662]


portfolio before change:  [6.13209584]
curr_Stock_Price:  103.41457081518185
curr_Factors:  [103.41457082  -1.14182145  -1.02502024]
mat_Sqrt:  [[11.84498029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06208476  0.35034092 -0.53705969]
Stock Position:  0.06208475660703152
Bond Position:  [-0.28837262]


portfolio before change:  [6.07330039]
curr_Stock_Price:  102.46813236396662
curr_Factors:  [102.46813236  -1.04606215  -1.00633049]
mat_Sqrt:  [[13.15970104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061035  0.00630623 -0.16447766]
Stock Position:  -0.0006103539770296827
Bond Position:  [6.13584222]


portfolio before change:  [6.07347685]
curr_Stock_Price:  103.43572455088241
curr_Factors:  [103.43572455  -1.20265371  -1.01219726]
mat_Sqrt:  [[11.29205555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00707698 -0.00776003 -0.5411708 ]
Stock Position:  -0.007076984605027689
Bond Position:  [6.80548988]


portfolio before change:  [6.07818165]
curr_Stock_Price:  102.89113286846575
curr_Factors:  [102.89113287  -1.01083532  -1.01693868]
mat_Sqrt:  [[13.54337465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11254516 -1.0083073   7.47712084]
Stock Position:  0.11254515603453835
Bond Position:  [-5.50171695]


portfolio before change:  [6.12980424]
curr_Stock_Price:  103.35592711460137
curr_Factors:  [103.35592711  -1.16231008  -1.00379468]
mat_Sqrt:  [[11.84699052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018291  -0.03053791  0.10625201]
Stock Position:  -0.001829103588988051
Bond Position:  [6.31885293]


portfolio before change:  [6.1297314]
curr_Stock_Price:  103.82760128053278
curr_Factors:  [103.82760128  -1.16971422  -0.98514699]
mat_Sqrt:  [[12.0356206   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00993765 -0.02901231  0.0759164 ]
Stock Position:  0.009937649522414483
Bond Position:  [5.09792909]


portfolio before change:  [6.13642196]
curr_Stock_Price:  104.43672693665235
curr_Factors:  [104.43672694  -0.98228254  -1.02165381]
mat_Sqrt:  [[14.07844705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01996261 -0.10744556 -0.02467278]
Stock Position:  -0.01996260915358417
Bond Position:  [8.22125152]


portfolio before change:  [6.11835338]
curr_Stock_Price:  105.39333018352347
curr_Factors:  [105.39333018  -1.23543187  -1.03105503]
mat_Sqrt:  [[10.92673411  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05754326 -0.53285976 -0.5742574 ]
Stock Position:  -0.05754325604913276
Bond Position:  [12.18302877]


portfolio before change:  [6.17782769]
curr_Stock_Price:  104.3862385015239
curr_Factors:  [104.3862385   -1.11899775  -1.03386398]
mat_Sqrt:  [[12.12459596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00290387 0.01273956 0.50138075]
Stock Position:  0.0029038689155948608
Bond Position:  [5.87470374]


portfolio before change:  [6.17542492]
curr_Stock_Price:  103.30590224755491
curr_Factors:  [103.30590225  -1.11245005  -1.04639165]
mat_Sqrt:  [[11.92757339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02285036 -0.12101081  0.86296069]
Stock Position:  0.022850359824485324
Bond Position:  [3.81484788]


portfolio before change:  [6.17427235]
curr_Stock_Price:  103.2345922353159
curr_Factors:  [103.23459224  -0.95076822  -1.04182575]
mat_Sqrt:  [[14.07513862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00485865 0.01760441 0.00837488]
Stock Position:  0.004858649059562226
Bond Position:  [5.67269169]


portfolio before change:  [6.18506771]
curr_Stock_Price:  105.31052670934994
curr_Factors:  [105.31052671  -0.73794123  -1.03937931]
mat_Sqrt:  [[17.80702143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01189937 -0.01635848 -0.43776228]
Stock Position:  -0.01189936835174297
Bond Position:  [7.43819646]


portfolio before change:  [6.16491133]
curr_Stock_Price:  107.08257180212833
curr_Factors:  [107.0825718   -0.83896003  -1.06176332]
mat_Sqrt:  [[16.00461125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03771245 0.13327736 1.09705894]
Stock Position:  0.03771244777410427
Bond Position:  [2.12656543]


portfolio before change:  [6.17117717]
curr_Stock_Price:  107.24167055412077
curr_Factors:  [107.24167055  -0.92354593  -1.05738626]
mat_Sqrt:  [[14.79297941  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00677975 0.02757957 0.50742711]
Stock Position:  0.006779752379044899
Bond Position:  [5.4441052]


portfolio before change:  [6.16606563]
curr_Stock_Price:  106.38734731644496
curr_Factors:  [106.38734732  -0.75540886  -1.10538946]
mat_Sqrt:  [[16.5483821   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00946204 -0.11159004  0.34972781]
Stock Position:  -0.009462036363664586
Bond Position:  [7.17270658]


portfolio before change:  [6.17199149]
curr_Stock_Price:  105.85583205925211
curr_Factors:  [105.85583206  -0.80304949  -1.12954126]
mat_Sqrt:  [[15.32502847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00713473 -0.01394056 -0.45504938]
Stock Position:  0.007134732619157678
Bond Position:  [5.41673843]


portfolio before change:  [6.17087062]
curr_Stock_Price:  105.6038249296985
curr_Factors:  [105.60382493  -0.63845032  -1.11720293]
mat_Sqrt:  [[18.24774186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02880226 -0.00772116  0.83122405]
Stock Position:  0.02880226178689533
Bond Position:  [3.12924161]


portfolio before change:  [6.18036633]
curr_Stock_Price:  105.91992970204446
curr_Factors:  [105.9199297   -1.07543542  -1.13965892]
mat_Sqrt:  [[11.56044192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00211885  0.01971321  0.30022021]
Stock Position:  -0.0021188543018830852
Bond Position:  [6.40479523]


portfolio before change:  [6.18198338]
curr_Stock_Price:  105.53462793413401
curr_Factors:  [105.53462793  -1.1676571   -1.09838303]
mat_Sqrt:  [[10.94627269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314075 -0.02600141 -0.03673698]
Stock Position:  -0.003140745777608665
Bond Position:  [6.51344082]


portfolio before change:  [6.18414291]
curr_Stock_Price:  105.10628853241262
curr_Factors:  [105.10628853  -1.08563682  -1.07644632]
mat_Sqrt:  [[12.09617119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02234166 -0.03839665 -0.02536052]
Stock Position:  0.0223416649982487
Bond Position:  [3.83589343]


portfolio before change:  [6.19918942]
curr_Stock_Price:  105.75829838752541
curr_Factors:  [105.75829839  -1.00259604  -1.0633873 ]
mat_Sqrt:  [[13.39890435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366415 -0.02590522 -0.06395777]
Stock Position:  -0.003664150890037402
Bond Position:  [6.58670378]


portfolio before change:  [6.19802911]
curr_Stock_Price:  106.29967843412518
curr_Factors:  [106.29967843  -1.22357223  -1.0742699 ]
mat_Sqrt:  [[10.68050512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00032813 -0.00352836 -0.03250077]
Stock Position:  0.00032812766824540963
Bond Position:  [6.16314924]


portfolio before change:  [6.19885878]
curr_Stock_Price:  106.48017363083349
curr_Factors:  [106.48017363  -1.0244554   -1.11126633]
mat_Sqrt:  [[12.58162062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00413724  0.01309897 -0.31354072]
Stock Position:  -0.004137238341387185
Bond Position:  [6.63939263]


portfolio before change:  [6.19805904]
curr_Stock_Price:  106.87408665974385
curr_Factors:  [106.87408666  -1.13015086  -1.09998433]
mat_Sqrt:  [[11.49044926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0547488  0.03739594 0.50115052]
Stock Position:  0.05474880483479186
Bond Position:  [0.34683053]


portfolio before change:  [6.20942615]
curr_Stock_Price:  107.08091775617257
curr_Factors:  [107.08091776  -1.14345675  -1.10388084]
mat_Sqrt:  [[11.31633436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00969676  0.04737446 -0.27425591]
Stock Position:  0.009696760539905066
Bond Position:  [5.17108813]


portfolio before change:  [6.22044614]
curr_Stock_Price:  108.15071473072616
curr_Factors:  [108.15071473  -1.08160228  -1.12727536]
mat_Sqrt:  [[11.87752695  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233753  0.01557495  0.08122054]
Stock Position:  -0.0023375343278865743
Bond Position:  [6.47325215]


portfolio before change:  [6.2213213]
curr_Stock_Price:  108.12250214799138
curr_Factors:  [108.12250215  -1.12594087  -1.13204115]
mat_Sqrt:  [[11.30542664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.21305985 0.49737765 0.57324824]
Stock Position:  0.21305984946696635
Bond Position:  [-16.81524273]


portfolio before change:  [6.18614578]
curr_Stock_Price:  107.96727121386924
curr_Factors:  [107.96727121  -1.13880638  -1.12297325]
mat_Sqrt:  [[11.24640486  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00938112  0.0023469  -0.00938144]
Stock Position:  -0.009381121231822257
Bond Position:  [7.19899984]


portfolio before change:  [6.17983513]
curr_Stock_Price:  108.73589823668917
curr_Factors:  [108.73589824  -1.23281587  -1.10433755]
mat_Sqrt:  [[10.50413068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078747 -0.00381925 -0.6392936 ]
Stock Position:  -0.0007874738103521973
Bond Position:  [6.2654618]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.18041286]
Stock Price:  108.99686539561704
PL:  [-2.81645254]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 8.39582689e-02 -2.92897933e-02  4.09691812e-02]
 [ 1.84874926e+00  4.68955393e-01  6.81312355e-01]
 [ 1.29690584e-01  2.39773832e-01  4.29973334e-02]
 [ 1.09632648e-01  8.15149595e-01  6.94941909e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 2.41611907e-02  9.86515746e-03  2.40997662e-02]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [ 3.46813287e-02  1.85992823e-01 -4.18888241e-02]
 [ 2.06114595e-02  5.82283238e-02 -4.55409309e-02]
 [-7.08414845e-02 -3.13958555e-02  4.65885866e-03]
 [ 8.66640665e-01  1.67110002e+00 -3.00437242e-01]
 [-2.33108751e-04 -2.50658489e-02  1.22209810e-02]
 [-8.37893412e-02 -4.52555564e-03 -1.85233951e-01]
 [ 1.45732130e+00 -2.77822433e+00  2.32154043e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.61928947e-01 -1.47872533e-01  4.77487735e-02]
 [-2.97146898e-01 -5.19184596e-01  2.20539878e-02]
 [-2.45932690e-01 -1.62316475e+00 -2.00967766e-01]
 [ 2.06914647e-04  3.41673464e-02  7.68320607e-02]
 [ 3.63554620e-01 -5.47701470e-01  2.66084020e-01]
 [ 7.27337903e-02  2.65998856e-01 -2.98252437e-01]
 [-4.77058295e-01 -4.71631097e-02 -2.67637637e-01]
 [ 5.23105210e-01  4.56047031e-01  4.42210382e-01]
 [-1.23357369e-02  7.79098023e-02  1.51609557e-01]
 [-1.18062982e-01 -3.73151239e-01  1.30882916e-01]
 [ 1.87927130e-01 -6.07944164e-02 -2.11426009e-01]
 [ 6.52543834e-01  1.84549951e-02  4.36945640e-01]
 [-5.84075917e-02  6.11088949e-02  1.05199793e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 3.37452103e-01 -1.31548057e-01 -3.82247313e-02]
 [-2.95215384e-02 -8.02427090e-02 -2.21303379e-02]
 [ 3.44576548e-02 -6.10158326e-03 -2.56529850e-02]
 [-3.81470506e-02 -6.08214113e-02  1.23268461e-02]
 [ 5.52208795e-01  1.03065673e-01  1.63611973e-01]
 [ 1.41059123e-01  1.56126793e-01 -1.12969756e-01]
 [ 1.86122526e-02  3.15708149e-02  6.95274674e-02]
 [ 1.91060910e+00  1.40058055e+00  1.85396091e-01]
 [-1.00153794e-01 -1.48181671e-03 -1.57579360e-02]
 [ 3.81846570e-02 -1.25977910e-02 -1.79436383e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.66020125]
curr_Stock_Price:  100.98967817015905
curr_Factors:  [100.98967817  -0.94664522  -1.01380097]
mat_Sqrt:  [[14.21890082  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00607236 -0.00945324  0.11687367]
Stock Position:  0.006072362064818231
Bond Position:  [9.04695536]


portfolio before change:  [9.66902404]
curr_Stock_Price:  102.2563770010764
curr_Factors:  [102.256377    -0.99155017  -1.0205867 ]
mat_Sqrt:  [[13.67195007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.15239572 0.1513547  1.94359451]
Stock Position:  0.1523957205533563
Bond Position:  [-5.91441021]


portfolio before change:  [9.63839343]
curr_Stock_Price:  102.06023460569811
curr_Factors:  [102.06023461  -0.95630412  -1.00993342]
mat_Sqrt:  [[14.28665146  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01311791 0.07738667 0.12265942]
Stock Position:  0.013117909896862614
Bond Position:  [8.29957647]


portfolio before change:  [9.62931394]
curr_Stock_Price:  101.28899858450261
curr_Factors:  [101.28899858  -0.81314978  -0.99412942]
mat_Sqrt:  [[16.6215261   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02514082 0.2630884  1.98247583]
Stock Position:  0.025140819358439176
Bond Position:  [7.08282552]


portfolio before change:  [9.61180159]
curr_Stock_Price:  100.557210407548
curr_Factors:  [100.55721041  -0.66984859  -0.97846617]
mat_Sqrt:  [[19.34457593  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303165 -0.01106097 -0.05874131]
Stock Position:  -0.0030316508955567528
Bond Position:  [9.91665595]


portfolio before change:  [9.61521986]
curr_Stock_Price:  99.83858957819936
curr_Factors:  [99.83858958 -1.04436129 -0.99153281]
mat_Sqrt:  [[13.03529496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00238539 0.00318397 0.06874992]
Stock Position:  0.0023853891902720983
Bond Position:  [9.37706597]


portfolio before change:  [9.6185707]
curr_Stock_Price:  100.75191497037696
curr_Factors:  [100.75191497  -1.11654549  -1.00483587]
mat_Sqrt:  [[12.07672262  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0054891  -0.00251018 -0.21167328]
Stock Position:  -0.005489098739570545
Bond Position:  [10.17160791]


portfolio before change:  [9.61827244]
curr_Stock_Price:  101.03789801015151
curr_Factors:  [101.03789801  -0.87837902  -1.01024285]
mat_Sqrt:  [[15.28502817  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00419341  0.06002893 -0.11949716]
Stock Position:  0.004193412902981278
Bond Position:  [9.19457882]


portfolio before change:  [9.61880564]
curr_Stock_Price:  100.89095348279645
curr_Factors:  [100.89095348  -0.79197629  -1.01156193]
mat_Sqrt:  [[16.61825926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139613  0.01879311 -0.1299156 ]
Stock Position:  0.0013961307455388928
Bond Position:  [9.47794868]


portfolio before change:  [9.6189296]
curr_Stock_Price:  100.13110065745622
curr_Factors:  [100.13110066  -0.53359438  -0.97381722]
mat_Sqrt:  [[22.17728879  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344042 -0.01013297  0.01329043]
Stock Position:  -0.0034404183432480357
Bond Position:  [9.96342248]


portfolio before change:  [9.61688185]
curr_Stock_Price:  101.08832743988742
curr_Factors:  [101.08832744  -0.52415928  -0.94833084]
mat_Sqrt:  [[23.18497742  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04944693  0.53934521 -0.85706383]
Stock Position:  0.04944693334449487
Bond Position:  [4.61837406]


portfolio before change:  [9.59751173]
curr_Stock_Price:  100.6849160479861
curr_Factors:  [100.68491605  -0.37114864  -0.96939969]
mat_Sqrt:  [[26.34945707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00010835 -0.00808997  0.03486306]
Stock Position:  -0.00010835352059251392
Bond Position:  [9.60842129]


portfolio before change:  [9.59846505]
curr_Stock_Price:  102.9719443259257
curr_Factors:  [102.97194433  -0.57814099  -0.9515648 ]
mat_Sqrt:  [[22.30365972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00549344 -0.00146062 -0.5284209 ]
Stock Position:  -0.005493440974424164
Bond Position:  [10.16413534]


portfolio before change:  [9.59155051]
curr_Stock_Price:  104.4619263655695
curr_Factors:  [104.46192637  -0.50439729  -0.98173419]
mat_Sqrt:  [[23.63411405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05771746 -0.89666805  6.62270866]
Stock Position:  0.05771746239264651
Bond Position:  [3.56227321]


portfolio before change:  [9.62859958]
curr_Stock_Price:  105.09611498129786
curr_Factors:  [105.09611498  -0.37926227  -0.98353806]
mat_Sqrt:  [[26.89862009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080559 -0.03053791  0.10625201]
Stock Position:  -0.000805594220454784
Bond Position:  [9.71326441]


portfolio before change:  [9.62803762]
curr_Stock_Price:  107.30094055774569
curr_Factors:  [107.30094056  -0.95283205  -0.99704765]
mat_Sqrt:  [[15.26797844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00926719 -0.04772565  0.13621396]
Stock Position:  0.009267190835991803
Bond Position:  [8.63365933]


portfolio before change:  [9.62472889]
curr_Stock_Price:  106.82744182093695
curr_Factors:  [106.82744182  -0.84688613  -0.98492152]
mat_Sqrt:  [[17.10562204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02330364 -0.16756611  0.06291389]
Stock Position:  -0.02330364005702812
Bond Position:  [12.11419715]


portfolio before change:  [9.62944494]
curr_Stock_Price:  106.69005213424616
curr_Factors:  [106.69005213  -1.03592662  -1.00083616]
mat_Sqrt:  [[13.91775186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.044424   -0.52387417 -0.5733051 ]
Stock Position:  -0.04442399804169533
Bond Position:  [14.36904361]


portfolio before change:  [9.69262148]
curr_Stock_Price:  105.30835978043102
curr_Factors:  [105.30835978  -0.80872099  -1.01380475]
mat_Sqrt:  [[17.01962461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00134342 0.01102746 0.21918048]
Stock Position:  0.0013434240914593368
Bond Position:  [9.5511477]


portfolio before change:  [9.69466555]
curr_Stock_Price:  105.94114385827997
curr_Factors:  [105.94114386  -0.68708089  -1.0208744 ]
mat_Sqrt:  [[19.20034808  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01594084 -0.17676989  0.75906365]
Stock Position:  0.015940841136681677
Bond Position:  [8.00587461]


portfolio before change:  [9.72476536]
curr_Stock_Price:  107.76658132732493
curr_Factors:  [107.76658133  -0.53180462  -1.0315964 ]
mat_Sqrt:  [[22.56875861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00293105  0.08585076 -0.85083119]
Stock Position:  0.0029310453837138933
Bond Position:  [9.40889661]


portfolio before change:  [9.72724049]
curr_Stock_Price:  108.20975172155393
curr_Factors:  [108.20975172  -0.48231132  -1.04674373]
mat_Sqrt:  [[23.45342263  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0230805  -0.01522183 -0.76349568]
Stock Position:  -0.023080500306970245
Bond Position:  [12.2247757]


portfolio before change:  [9.73658236]
curr_Stock_Price:  107.87121149420452
curr_Factors:  [107.87121149  -0.41271001  -1.02803211]
mat_Sqrt:  [[25.53872467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02766235 0.14718855 1.26150313]
Stock Position:  0.02766235377102492
Bond Position:  [6.75261075]


portfolio before change:  [9.69899067]
curr_Stock_Price:  106.48174817234147
curr_Factors:  [106.48174817  -0.47017082  -1.0259549 ]
mat_Sqrt:  [[23.85151834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00144707 0.02514528 0.43249987]
Stock Position:  0.0014470653661115814
Bond Position:  [9.54490462]


portfolio before change:  [9.70108184]
curr_Stock_Price:  107.10230243896228
curr_Factors:  [107.10230244  -0.64943903  -1.05837071]
mat_Sqrt:  [[19.41361712  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00862878 -0.12043404  0.37337253]
Stock Position:  -0.008628778212662815
Bond Position:  [10.62524385]


portfolio before change:  [9.70096378]
curr_Stock_Price:  107.26991562871504
curr_Factors:  [107.26991563  -0.64986334  -1.05766725]
mat_Sqrt:  [[19.44942767  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00680536 -0.01962131 -0.60313955]
Stock Position:  0.006805360594692086
Bond Position:  [8.97095332]


portfolio before change:  [9.71061121]
curr_Stock_Price:  108.52275068684574
curr_Factors:  [108.52275069  -0.72248609  -1.07594784]
mat_Sqrt:  [[17.96680538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0414933  0.00595632 1.24648429]
Stock Position:  0.04149330301564984
Bond Position:  [5.20764383]


portfolio before change:  [9.61760591]
curr_Stock_Price:  106.2656080621608
curr_Factors:  [106.26560806  -0.77218131  -1.07523285]
mat_Sqrt:  [[16.75216545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146011  0.01972281  0.30010573]
Stock Position:  -0.0014601081289470235
Bond Position:  [9.77276518]


portfolio before change:  [9.61955044]
curr_Stock_Price:  105.77053579006909
curr_Factors:  [105.77053579  -0.98596482  -1.07757295]
mat_Sqrt:  [[13.4332667   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255928 -0.02600141 -0.03673698]
Stock Position:  -0.0025592776865699268
Bond Position:  [9.89024661]


portfolio before change:  [9.62015553]
curr_Stock_Price:  106.01719291393006
curr_Factors:  [106.01719291  -0.94490052  -1.09904694]
mat_Sqrt:  [[13.73096937  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02205215 -0.04245695 -0.10904452]
Stock Position:  0.022052148684048336
Bond Position:  [7.28224863]


portfolio before change:  [9.6162217]
curr_Stock_Price:  105.79752434824458
curr_Factors:  [105.79752435  -0.84252033  -1.08036756]
mat_Sqrt:  [[15.46592529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325996 -0.02589822 -0.06313169]
Stock Position:  -0.0032599633121463013
Bond Position:  [9.96111775]


portfolio before change:  [9.6181865]
curr_Stock_Price:  105.5767922825365
curr_Factors:  [105.57679228  -0.72287356  -1.07083711]
mat_Sqrt:  [[17.56183197  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00159299 -0.00196928 -0.07318083]
Stock Position:  0.0015929876093364347
Bond Position:  [9.45000398]


portfolio before change:  [9.61976865]
curr_Stock_Price:  105.82841348148088
curr_Factors:  [105.82841348  -0.51546529  -1.0557775 ]
mat_Sqrt:  [[21.9897458   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218493 -0.01963003  0.03516506]
Stock Position:  -0.002184925771306874
Bond Position:  [9.85099588]


portfolio before change:  [9.61858018]
curr_Stock_Price:  106.93596857352809
curr_Factors:  [106.93596857  -0.69956692  -1.07932099]
mat_Sqrt:  [[18.05354952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03360249 0.0332643  0.46673942]
Stock Position:  0.03360248582493503
Bond Position:  [6.02526581]


portfolio before change:  [9.59502442]
curr_Stock_Price:  106.21254085090021
curr_Factors:  [106.21254085  -0.66484261  -1.11105895]
mat_Sqrt:  [[17.98504585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00833295  0.05038971 -0.32227127]
Stock Position:  0.008332951592492964
Bond Position:  [8.70996045]


portfolio before change:  [9.59263235]
curr_Stock_Price:  105.7948159180257
curr_Factors:  [105.79481592  -0.70640282  -1.129459  ]
mat_Sqrt:  [[16.87173438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00232631 0.01018944 0.19834251]
Stock Position:  0.002326308145771445
Bond Position:  [9.346521]


portfolio before change:  [9.59476913]
curr_Stock_Price:  106.21109758387675
curr_Factors:  [106.21109758  -0.81978606  -1.13505348]
mat_Sqrt:  [[15.03813125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.14857865 0.45203543 0.52888344]
Stock Position:  0.14857864910675755
Bond Position:  [-6.18593226]


portfolio before change:  [9.46749218]
curr_Stock_Price:  105.35967200261778
curr_Factors:  [105.359672    -0.7841732   -1.15177294]
mat_Sqrt:  [[15.20210351  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00681964 -0.00047825 -0.04495301]
Stock Position:  -0.006819638093906372
Bond Position:  [10.18600701]


portfolio before change:  [9.46701515]
curr_Stock_Price:  105.61633749847289
curr_Factors:  [105.6163375   -0.61226107  -1.1666573 ]
mat_Sqrt:  [[17.83021874  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.68784227e-05 -4.06591956e-03 -5.11882056e-01]
Stock Position:  -5.6878422699380916e-05
Bond Position:  [9.47302244]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.46823542]
Stock Price:  104.98214711447476
PL:  [4.48608831]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 9.97072043e-03 -1.00213349e-01  1.44264115e-02]
 [ 8.73099499e-01  2.12557410e-01  2.43380686e-01]
 [-2.60288478e-01 -1.53119775e-01  3.73888667e-02]
 [ 1.30490208e-01  7.57779505e-01  7.89228603e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 1.78632595e-02  4.07584700e-02 -8.08161036e-03]
 [-3.79015718e-02 -8.23697637e-02 -2.43469024e-02]
 [ 7.01323535e-02  1.39089113e-01 -5.27605749e-02]
 [ 4.38059146e-02  3.31281748e-02 -4.17275765e-02]
 [-1.81099080e-02  1.34816460e-03  4.11071193e-02]
 [ 1.05247848e+00  2.02310253e+00 -3.65269731e-01]
 [ 5.88137501e-05 -4.42573073e-02 -8.18230711e-03]
 [-1.76962680e-01 -2.06863444e-03 -3.49132301e-01]
 [ 1.65762881e+00 -3.15355815e+00  2.64484714e+00]
 [-3.88268082e-03 -9.35940629e-02  3.66158521e-02]
 [ 1.28860261e-01 -1.25354723e-02 -2.70702640e-02]
 [-8.97563752e-02 -6.93524708e-02 -5.25091416e-02]
 [-2.76211782e-01 -1.79263953e+00 -1.99899212e-01]
 [ 5.15884217e-05  3.37296950e-02  7.94504893e-02]
 [ 1.90610865e-01 -2.04308473e-01  2.43348846e-01]
 [ 4.98711573e-02  8.47654090e-03  6.07399409e-02]
 [ 1.42807924e-01 -5.38058559e-02 -1.54033289e-02]
 [ 3.75516789e-01  1.27721775e-01  2.03909177e-01]
 [-7.83483443e-02 -4.06437825e-02  7.42528999e-02]
 [ 6.35654271e-02 -3.42376927e-02 -9.24050849e-03]
 [ 4.15197871e-02 -2.85091006e-02  2.83323225e-01]
 [-8.97079789e-02 -1.12470518e-01 -3.32351181e-02]
 [-1.34387123e-01  9.51747433e-02  2.04713712e-01]
 [ 5.18969846e-02  5.84825100e-02  2.33006365e-01]
 [-1.05423391e-01  1.06064969e-01 -7.23194956e-03]
 [ 5.31464929e-02 -1.32166433e-02 -8.03881966e-02]
 [ 5.36837980e-03  1.44206330e-02 -5.85943466e-02]
 [-6.13880407e-02 -1.73103332e-02  3.91545982e-02]
 [-6.47005810e-02 -5.65234576e-03 -2.46151012e-03]
 [ 2.62053733e-03 -2.92269709e-02  2.18915966e-02]
 [-1.15860290e-01 -6.41266983e-02 -8.29081230e-02]
 [ 2.09913769e+00  1.36013740e+00  1.61850149e-01]
 [-2.14295537e-02 -8.17688655e-02 -3.90642873e-02]
 [ 3.56686777e-02 -1.34102550e-02 -1.18236594e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.38594303]
curr_Stock_Price:  99.72409805929126
curr_Factors:  [99.72409806 -1.05116937 -1.00408167]
mat_Sqrt:  [[12.77073612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00059045 -0.03234372  0.04115454]
Stock Position:  -0.0005904487170083668
Bond Position:  [0.44482499]


portfolio before change:  [0.38601839]
curr_Stock_Price:  99.69063368464379
curr_Factors:  [99.69063368 -1.00496934 -1.00056511]
mat_Sqrt:  [[13.4171975   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07200963 0.06860261 0.69429735]
Stock Position:  0.07200963343015249
Bond Position:  [-6.7926676]


portfolio before change:  [0.4093158]
curr_Stock_Price:  100.02595756026446
curr_Factors:  [100.02595756  -0.75788836  -0.98409787]
mat_Sqrt:  [[17.52175917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01620339 -0.04941919  0.10666003]
Stock Position:  -0.01620339305845748
Bond Position:  [2.03007571]


portfolio before change:  [0.39490849]
curr_Stock_Price:  100.93077344854926
curr_Factors:  [100.93077345  -0.52539214  -0.97275822]
mat_Sqrt:  [[22.56239334  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01977946 0.24457228 2.25144953]
Stock Position:  0.01977945819500145
Bond Position:  [-1.60144752]


portfolio before change:  [0.39590557]
curr_Stock_Price:  100.99130466419602
curr_Factors:  [100.99130466  -0.43934121  -0.96215414]
mat_Sqrt:  [[24.86693655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00235839 -0.01106097 -0.05874131]
Stock Position:  -0.0023583926716177098
Bond Position:  [0.63408273]


portfolio before change:  [0.39743518]
curr_Stock_Price:  100.37633478931077
curr_Factors:  [100.37633479  -0.52777364  -0.97689876]
mat_Sqrt:  [[22.29258419  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00110052  0.01315474 -0.02305458]
Stock Position:  0.0011005182413476144
Bond Position:  [0.28696919]


portfolio before change:  [0.39914977]
curr_Stock_Price:  101.90172617546224
curr_Factors:  [101.90172618  -0.56223355  -1.01974443]
mat_Sqrt:  [[20.94774281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284923 -0.02658473 -0.06945494]
Stock Position:  -0.0028492339521224634
Bond Position:  [0.68949163]


portfolio before change:  [0.39907305]
curr_Stock_Price:  101.95890339584275
curr_Factors:  [101.9589034   -0.35738034  -1.03588476]
mat_Sqrt:  [[25.31266158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00346681  0.04489082 -0.15051123]
Stock Position:  0.0034668062211353954
Bond Position:  [0.04560129]


portfolio before change:  [0.3969969]
curr_Stock_Price:  101.35839210273308
curr_Factors:  [101.3583921   -0.23506501  -1.03657231]
mat_Sqrt:  [[28.41807412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147971  0.01069207 -0.11903716]
Stock Position:  0.0014797121326133868
Bond Position:  [0.24701566]


portfolio before change:  [0.39581941]
curr_Stock_Price:  100.54176770951494
curr_Factors:  [100.54176771  -0.11782016  -1.03126234]
mat_Sqrt:  [[31.86444269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00029637  0.00043512  0.11726717]
Stock Position:  -0.0002963729685212739
Bond Position:  [0.42561727]


portfolio before change:  [0.39602865]
curr_Stock_Price:  100.0152763800831
curr_Factors:  [100.01527638  -0.23265381  -1.04248956]
mat_Sqrt:  [[27.94335899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04977505  0.65295353 -1.04201287]
Stock Position:  0.049775053163367104
Bond Position:  [-4.58223705]


portfolio before change:  [0.45986064]
curr_Stock_Price:  101.30919366979064
curr_Factors:  [101.30919367  -0.25458041  -1.07427255]
mat_Sqrt:  [[26.82472951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039685 -0.01428398 -0.02334184]
Stock Position:  -0.0003968493962743206
Bond Position:  [0.50006513]


portfolio before change:  [0.45970441]
curr_Stock_Price:  101.86038279560034
curr_Factors:  [101.8603828   -0.75474785  -1.08569595]
mat_Sqrt:  [[16.17002597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.53772957e-02 -6.67648896e-04 -9.95977275e-01]
Stock Position:  -0.015377295694396826
Bond Position:  [2.02604164]


portfolio before change:  [0.46876957]
curr_Stock_Price:  101.28733773994465
curr_Factors:  [101.28733774  -0.78854698  -1.07877725]
mat_Sqrt:  [[15.65260224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09926711 -1.01780652  7.5450127 ]
Stock Position:  0.09926711129667697
Bond Position:  [-9.58573186]


portfolio before change:  [0.47326568]
curr_Stock_Price:  101.34470222712059
curr_Factors:  [101.34470223  -1.04251182  -1.0625573 ]
mat_Sqrt:  [[12.34756013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125639 -0.03020735  0.10445483]
Stock Position:  -0.0012563866258650427
Bond Position:  [0.60059381]


portfolio before change:  [0.47451894]
curr_Stock_Price:  100.40695084456372
curr_Factors:  [100.40695084  -0.93124149  -1.04201736]
mat_Sqrt:  [[13.95688017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00865349 -0.00404581 -0.07722393]
Stock Position:  0.00865349366698234
Bond Position:  [-0.39435198]


portfolio before change:  [0.47977301]
curr_Stock_Price:  101.0198100951805
curr_Factors:  [101.0198101  -1.005667   -1.0350981]
mat_Sqrt:  [[13.12542956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00873353 -0.02238341 -0.14979397]
Stock Position:  -0.008733525420574095
Bond Position:  [1.36203209]


portfolio before change:  [0.48551073]
curr_Stock_Price:  100.38233025499015
curr_Factors:  [100.38233025  -0.75506864  -1.03762753]
mat_Sqrt:  [[16.71472429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04085841 -0.57857192 -0.57025681]
Stock Position:  -0.04085840948012208
Bond Position:  [4.58697308]


portfolio before change:  [0.43293809]
curr_Stock_Price:  101.68306715074374
curr_Factors:  [101.68306715  -0.87996967  -1.0106144 ]
mat_Sqrt:  [[15.35247529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00150819 0.01088621 0.22665013]
Stock Position:  0.001508186552803166
Bond Position:  [0.27958106]


portfolio before change:  [0.43283569]
curr_Stock_Price:  101.59199667760528
curr_Factors:  [101.59199668  -0.67247645  -0.99774868]
mat_Sqrt:  [[19.12009031  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01038593 -0.06594028  0.69420652]
Stock Position:  0.01038593146412944
Bond Position:  [-0.62229182]


portfolio before change:  [0.43662918]
curr_Stock_Price:  101.9647391360487
curr_Factors:  [101.96473914  -0.54237332  -1.01651016]
mat_Sqrt:  [[21.45040618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00298362 0.00273579 0.17327414]
Stock Position:  0.0029836224069010684
Bond Position:  [0.1324049]


portfolio before change:  [0.43616506]
curr_Stock_Price:  101.80363710408481
curr_Factors:  [101.8036371   -0.37097861  -1.03519216]
mat_Sqrt:  [[24.9500308   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00515754 -0.01736577 -0.04394141]
Stock Position:  0.005157535068153843
Bond Position:  [-0.08889077]


portfolio before change:  [0.43484733]
curr_Stock_Price:  101.55029579141768
curr_Factors:  [101.55029579  -0.37813353  -1.03513663]
mat_Sqrt:  [[24.71187841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01793513 0.04122203 0.58169613]
Stock Position:  0.017935126817211378
Bond Position:  [-1.3864701]


portfolio before change:  [0.39740317]
curr_Stock_Price:  99.47220408770758
curr_Factors:  [99.47220409 -0.27331892 -1.02561815]
mat_Sqrt:  [[27.1381687   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263422 -0.01311772  0.21182286]
Stock Position:  -0.002634220192288757
Bond Position:  [0.65943486]


portfolio before change:  [0.40220305]
curr_Stock_Price:  97.68137554811177
curr_Factors:  [97.68137555 -0.42105888 -1.05333744]
mat_Sqrt:  [[22.36091551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00244581 -0.01105017 -0.0263606 ]
Stock Position:  0.0024458066765581784
Bond Position:  [0.16329329]


portfolio before change:  [0.4050974]
curr_Stock_Price:  98.85642229190746
curr_Factors:  [98.85642229 -0.50302348 -1.04796374]
mat_Sqrt:  [[20.96137169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00446218 -0.00920127  0.8082423 ]
Stock Position:  0.00446218423599644
Bond Position:  [-0.03601817]


portfolio before change:  [0.40816774]
curr_Stock_Price:  99.54551225061121
curr_Factors:  [99.54551225 -0.23815597 -1.0638559 ]
mat_Sqrt:  [[27.07479104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00441185 -0.0362997  -0.09481054]
Stock Position:  -0.004411853708367817
Bond Position:  [0.84734798]


portfolio before change:  [0.41160155]
curr_Stock_Price:  98.79120699934904
curr_Factors:  [98.791207   -0.12577698 -1.03497964]
mat_Sqrt:  [[30.94625484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236451  0.03071752  0.58399124]
Stock Position:  -0.0023645073800055766
Bond Position:  [0.64519409]


portfolio before change:  [0.41939979]
curr_Stock_Price:  95.52727683037709
curr_Factors:  [95.52727683 -0.10055195 -1.02746527]
mat_Sqrt:  [[30.91973346  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00360278 0.01887515 0.6647023 ]
Stock Position:  0.0036027769181331804
Bond Position:  [0.07523632]


portfolio before change:  [0.42551775]
curr_Stock_Price:  97.22278975568204
curr_Factors:  [97.22278976  0.10847098 -1.01683698]
mat_Sqrt:  [[39.19852621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217481  0.03423232 -0.02063074]
Stock Position:  -0.002174805875341605
Bond Position:  [0.63695845]


portfolio before change:  [0.4248525]
curr_Stock_Price:  97.56529100241835
curr_Factors:  [ 9.75652910e+01  2.91260459e-02 -1.03246174e+00]
mat_Sqrt:  [[35.77273863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00095155 -0.00426565 -0.22932515]
Stock Position:  0.0009515481980412873
Bond Position:  [0.33201442]


portfolio before change:  [0.42614327]
curr_Stock_Price:  98.87816860664273
curr_Factors:  [98.87816861 -0.1101739  -1.01318559]
mat_Sqrt:  [[32.15374662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.13471745e-04  4.65423930e-03 -1.67153361e-01]
Stock Position:  -0.00011347174482291745
Bond Position:  [0.43736315]


portfolio before change:  [0.42631311]
curr_Stock_Price:  97.8632392042376
curr_Factors:  [97.8632392  -0.40098826 -1.00581601]
mat_Sqrt:  [[23.9691292   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023751  -0.00558689  0.11169717]
Stock Position:  -0.0023751008357968937
Bond Position:  [0.65874817]


portfolio before change:  [0.42517049]
curr_Stock_Price:  98.37899258947458
curr_Factors:  [98.37899259 -0.58794808 -0.9849099 ]
mat_Sqrt:  [[20.40886393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325137 -0.00182429 -0.007022  ]
Stock Position:  -0.0032513723018466664
Bond Position:  [0.74503723]


portfolio before change:  [0.41840279]
curr_Stock_Price:  100.48912787365995
curr_Factors:  [100.48912787  -0.7177543   -1.00926233]
mat_Sqrt:  [[17.86838434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.28602060e-05 -9.43296429e-03  6.24506316e-02]
Stock Position:  6.286020596663375e-05
Bond Position:  [0.41208603]


portfolio before change:  [0.41844058]
curr_Stock_Price:  100.27075483608495
curr_Factors:  [100.27075484  -0.66825157  -1.00455183]
mat_Sqrt:  [[18.82283335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00774982 -0.0206968  -0.2365138 ]
Stock Position:  -0.007749824101671094
Bond Position:  [1.19552129]


portfolio before change:  [0.41561778]
curr_Stock_Price:  100.65427973633115
curr_Factors:  [100.65427974  -0.5523348   -0.98538641]
mat_Sqrt:  [[21.62760404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11142298 0.43898246 0.46171342]
Stock Position:  0.11142298013956625
Bond Position:  [-10.79958203]


portfolio before change:  [0.48700141]
curr_Stock_Price:  101.30705049661164
curr_Factors:  [101.3070505   -0.58099539  -1.00082115]
mat_Sqrt:  [[20.82885888  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221301 -0.02639079 -0.11143954]
Stock Position:  -0.0022130121479489863
Bond Position:  [0.71119515]


portfolio before change:  [0.48364884]
curr_Stock_Price:  102.86215873861046
curr_Factors:  [102.86215874  -0.57178573  -1.01673793]
mat_Sqrt:  [[21.00721951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00041873 -0.00432814 -0.33729609]
Stock Position:  0.00041873115133753553
Bond Position:  [0.44057725]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.48387621]
Stock Price:  103.27361538870137
PL:  [-2.78973918]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 4.15086865e-03 -5.21196347e-02  1.72145358e-01]
 [ 1.33418099e+00  2.79049284e-01  4.05427267e-01]
 [ 1.86697770e-02  1.15530841e-01  3.51969256e-02]
 [ 1.13215446e-01  8.34006136e-01  7.16066490e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 4.23294676e-02  5.06435559e-02 -2.40235831e-02]
 [-4.03370201e-02 -6.67829316e-02 -3.47643243e-02]
 [ 1.04789961e-01  1.16701986e-01 -8.30137273e-02]
 [ 9.80105940e-03  6.99269238e-02 -4.73182474e-02]
 [-5.11658748e-02 -1.91781559e-02  1.82587129e-02]
 [ 8.23098232e-01  1.65396986e+00 -2.68783563e-01]
 [-7.55236078e-04  2.62489282e-02  4.82746549e-02]
 [-4.22170840e-01 -1.15343398e-02 -8.84865523e-01]
 [ 2.09222893e+00 -3.52515501e+00  2.98540644e+00]
 [ 1.80684303e-02 -4.80814516e-02 -1.56278223e-02]
 [ 6.04094773e-02  1.27569400e-01 -8.33608825e-02]
 [-2.61377724e-02  8.22260351e-02 -8.35975033e-02]
 [-2.84594399e-01 -1.83946527e+00 -1.99569969e-01]
 [ 1.00814943e-02 -7.17507351e-02  2.56576161e-01]
 [ 1.34959273e-01  1.67931670e-01  3.42261672e-01]
 [ 2.89384570e-02 -3.17535432e-02  3.58837053e-02]
 [ 1.07600542e-01 -5.07216701e-02  2.21279912e-02]
 [ 3.03561884e-01  7.43912218e-03  7.94933535e-02]
 [-6.60768510e-02 -4.95776561e-02  7.78679053e-02]
 [ 6.16105110e-02 -1.01592045e-02 -1.43638816e-02]
 [ 5.23709409e-02 -4.12256449e-02  2.95714166e-01]
 [-1.44574274e-02 -1.11508972e-01 -2.26675324e-03]
 [-1.31451878e-01  9.78910803e-02  1.68373693e-01]
 [ 7.22946045e-02  3.88981613e-02  1.63339387e-01]
 [-1.48938678e-01  1.19978995e-01 -2.25122886e-02]
 [ 7.39598100e-02 -1.48892791e-02 -5.69591943e-02]
 [-3.97392322e-02 -1.78055336e-03 -4.13022283e-02]
 [ 1.05930034e-02  5.19753074e-02  1.01766415e-01]
 [ 4.65089786e-03 -4.80527611e-02 -1.33694575e-02]
 [-9.41038179e-02  4.87385114e-02  4.35974842e-02]
 [-1.16663891e-01 -6.77537305e-02 -7.91533411e-02]
 [ 8.47077319e-01  5.87700303e-01  1.15248139e-01]
 [ 7.23152216e-03 -1.07917649e-01 -7.35918234e-03]
 [ 3.42050570e-02 -1.43125533e-02 -9.34560094e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.81545471]
curr_Stock_Price:  100.46501790825646
curr_Factors:  [100.46501791  -0.85435838  -1.00818178]
mat_Sqrt:  [[15.59997665  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00183661 -0.01682154  0.49108279]
Stock Position:  0.001836606387567373
Bond Position:  [5.63094002]


portfolio before change:  [5.81720963]
curr_Stock_Price:  101.0372735398882
curr_Factors:  [101.03727354  -0.84426435  -1.03272269]
mat_Sqrt:  [[15.46381002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09531281 0.09006277 1.15657114]
Stock Position:  0.09531280932872015
Bond Position:  [-3.81293676]


portfolio before change:  [5.83674619]
curr_Stock_Price:  101.24724742526483
curr_Factors:  [101.24724743  -0.89460838  -1.05422104]
mat_Sqrt:  [[14.42173011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00342795 0.03728742 0.10040703]
Stock Position:  0.0034279488825995205
Bond Position:  [5.4896758]


portfolio before change:  [5.83698366]
curr_Stock_Price:  101.11633122202328
curr_Factors:  [101.11633122  -0.82038291  -1.04535118]
mat_Sqrt:  [[15.65104301  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0274501  0.26917432 2.04273838]
Stock Position:  0.027450100025094917
Bond Position:  [3.06133026]


portfolio before change:  [5.85178728]
curr_Stock_Price:  101.6416818215181
curr_Factors:  [101.64168182  -0.54152634  -1.07363037]
mat_Sqrt:  [[20.21241448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00290148 -0.01106097 -0.05874131]
Stock Position:  -0.0029014841837702887
Bond Position:  [6.14669901]


portfolio before change:  [5.85361608]
curr_Stock_Price:  101.27620847868094
curr_Factors:  [101.27620848  -0.53539852  -1.09281579]
mat_Sqrt:  [[19.87846961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00240276  0.01634514 -0.0685326 ]
Stock Position:  0.0024027627756759962
Bond Position:  [5.61027338]


portfolio before change:  [5.85514439]
curr_Stock_Price:  101.62038620307763
curr_Factors:  [101.6203862   -0.80168653  -1.0937362 ]
mat_Sqrt:  [[15.26895121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00399931 -0.0215541  -0.09917294]
Stock Position:  -0.003999309847948475
Bond Position:  [6.2615558]


portfolio before change:  [5.85398433]
curr_Stock_Price:  102.10617057966877
curr_Factors:  [102.10617058  -0.84587858  -1.09757309]
mat_Sqrt:  [[14.62250074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00763662  0.0376654  -0.23681506]
Stock Position:  0.007636624520947994
Bond Position:  [5.07423784]


portfolio before change:  [5.84753479]
curr_Stock_Price:  101.17855469377804
curr_Factors:  [101.17855469  -0.96237374  -1.09001345]
mat_Sqrt:  [[12.99415494  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00110942  0.02256882 -0.13498579]
Stock Position:  0.001109424675930406
Bond Position:  [5.73528481]


portfolio before change:  [5.84643779]
curr_Stock_Price:  99.5435122348688
curr_Factors:  [99.54351223 -0.84554525 -1.07134703]
mat_Sqrt:  [[14.63919571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00350795 -0.00618972  0.05208703]
Stock Position:  -0.00350794922774795
Bond Position:  [6.19563138]


portfolio before change:  [5.85088112]
curr_Stock_Price:  98.49765057315503
curr_Factors:  [98.49765057 -0.83862896 -1.06513035]
mat_Sqrt:  [[14.67687887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07534628  0.53381648 -0.76676469]
Stock Position:  0.07534627836189497
Bond Position:  [-1.57055027]


portfolio before change:  [5.81576389]
curr_Stock_Price:  98.03417838432517
curr_Factors:  [98.03417838 -0.97654186 -1.10128471]
mat_Sqrt:  [[12.27407858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00117783 0.00847181 0.13771415]
Stock Position:  0.0011778339640612565
Bond Position:  [5.7002959]


portfolio before change:  [5.81668388]
curr_Stock_Price:  98.21027678406496
curr_Factors:  [98.21027678 -1.15702346 -1.11441935]
mat_Sqrt:  [[10.13168913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05972821 -0.00372269 -2.52427504]
Stock Position:  -0.0597282139552062
Bond Position:  [11.68260831]


portfolio before change:  [5.82800123]
curr_Stock_Price:  98.04524702204985
curr_Factors:  [98.04524702 -1.5612447  -1.0958044 ]
mat_Sqrt:  [[ 6.87835812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.2881579  -1.13773889  8.51653359]
Stock Position:  0.2881578973669095
Bond Position:  [-22.42451099]


portfolio before change:  [5.81886066]
curr_Stock_Price:  98.02325445491218
curr_Factors:  [98.02325445 -1.5045939  -1.10851456]
mat_Sqrt:  [[ 7.18572398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00070471 -0.01551822 -0.04458183]
Stock Position:  0.0007047068988172841
Bond Position:  [5.749783]


portfolio before change:  [5.81969821]
curr_Stock_Price:  98.1918076141355
curr_Factors:  [98.19180761 -1.24906079 -1.1490325 ]
mat_Sqrt:  [[ 8.92476047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00777987  0.04117285 -0.23780539]
Stock Position:  0.007779873013966127
Bond Position:  [5.05577842]


portfolio before change:  [5.826431]
curr_Stock_Price:  98.97598256425864
curr_Factors:  [98.97598256 -0.9266899  -1.15694508]
mat_Sqrt:  [[12.32022527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214426  0.02653834 -0.23848041]
Stock Position:  -0.0021442564252934834
Bond Position:  [6.03866089]


portfolio before change:  [5.82713953]
curr_Stock_Price:  98.99760053274335
curr_Factors:  [98.99760053 -0.8293139  -1.15858168]
mat_Sqrt:  [[13.56102726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05167829 -0.59368486 -0.56931757]
Stock Position:  -0.05167829180057706
Bond Position:  [10.94316642]


portfolio before change:  [5.81841463]
curr_Stock_Price:  99.1929027547905
curr_Factors:  [99.19290275 -0.91419524 -1.12716615]
mat_Sqrt:  [[12.88037817  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00371176 -0.02315745  0.73194037]
Stock Position:  0.003711756424807052
Bond Position:  [5.45023473]


portfolio before change:  [5.81810733]
curr_Stock_Price:  98.92655373878394
curr_Factors:  [98.92655374 -0.93513112 -1.14715744]
mat_Sqrt:  [[12.33066357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01939085 0.05419971 0.97637728]
Stock Position:  0.01939085039155608
Bond Position:  [3.89983732]


portfolio before change:  [5.80419027]
curr_Stock_Price:  98.1837000732976
curr_Factors:  [98.18370007 -1.02645383 -1.13878958]
mat_Sqrt:  [[11.26383103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.002644   -0.01024841  0.10236622]
Stock Position:  0.002643995872857674
Bond Position:  [5.54459297]


portfolio before change:  [5.80637467]
curr_Stock_Price:  98.74772554576457
curr_Factors:  [98.74772555 -0.92680407 -1.1791434 ]
mat_Sqrt:  [[12.02058862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0084658  -0.01637035  0.063125  ]
Stock Position:  0.008465798512895417
Bond Position:  [4.97039632]


portfolio before change:  [5.80789006]
curr_Stock_Price:  98.85333317890608
curr_Factors:  [98.85333318 -0.50642507 -1.16989645]
mat_Sqrt:  [[18.49158459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01737584 0.00240097 0.22677241]
Stock Position:  0.01737584465599448
Bond Position:  [4.0902299]


portfolio before change:  [5.80033691]
curr_Stock_Price:  98.38921406808407
curr_Factors:  [98.38921407 -0.63703011 -1.16762059]
mat_Sqrt:  [[16.1881661   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372507 -0.01600112  0.22213546]
Stock Position:  -0.003725074706516985
Bond Position:  [6.16684408]


portfolio before change:  [5.80300709]
curr_Stock_Price:  97.87935250333418
curr_Factors:  [97.8793525  -0.70089473 -1.17499939]
mat_Sqrt:  [[14.99686995  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00377444 -0.00327887 -0.04097616]
Stock Position:  0.0037744380754167264
Bond Position:  [5.43356753]


portfolio before change:  [5.80367248]
curr_Stock_Price:  97.87568468709321
curr_Factors:  [97.87568469 -0.74570118 -1.18297836]
mat_Sqrt:  [[14.22525078  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00733331 -0.01330552  0.84359021]
Stock Position:  0.007333311330248899
Bond Position:  [5.08591961]


portfolio before change:  [5.80522847]
curr_Stock_Price:  98.00116809902126
curr_Factors:  [98.0011681  -0.82408029 -1.20724286]
mat_Sqrt:  [[12.8540155   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293152 -0.03598937 -0.00646642]
Stock Position:  -0.0029315197356954356
Bond Position:  [6.09252083]


portfolio before change:  [5.80793345]
curr_Stock_Price:  97.33824641951406
curr_Factors:  [97.33824642 -0.9166612  -1.18856237]
mat_Sqrt:  [[11.85759298  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00650223  0.03159421  0.48032328]
Stock Position:  -0.006502231027070179
Bond Position:  [6.44084922]


portfolio before change:  [5.81733461]
curr_Stock_Price:  96.01623886658427
curr_Factors:  [96.01623887 -0.70220778 -1.18830022]
mat_Sqrt:  [[14.49798008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00783393 0.01255433 0.46596181]
Stock Position:  0.007833930701979654
Bond Position:  [5.06515004]


portfolio before change:  [5.81779691]
curr_Stock_Price:  95.99442583659187
curr_Factors:  [95.99442584 -0.76475692 -1.20301331]
mat_Sqrt:  [[13.41696423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00961793  0.03872305 -0.06422129]
Stock Position:  -0.009617926053118724
Bond Position:  [6.7410642]


portfolio before change:  [5.82107846]
curr_Stock_Price:  95.74085112121075
curr_Factors:  [95.74085112 -0.76503735 -1.22601754]
mat_Sqrt:  [[13.07353802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00453541 -0.00480549 -0.16248873]
Stock Position:  0.004535405925890494
Bond Position:  [5.38685483]


portfolio before change:  [5.81806656]
curr_Stock_Price:  94.92828951453185
curr_Factors:  [94.92828951 -0.92856127 -1.19792146]
mat_Sqrt:  [[11.32076926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428712 -0.00057467 -0.11782376]
Stock Position:  -0.004287117510583167
Bond Position:  [6.22503529]


portfolio before change:  [5.81827847]
curr_Stock_Price:  95.060374727633
curr_Factors:  [95.06037473 -0.92422563 -1.2295779 ]
mat_Sqrt:  [[11.03099106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00380522 0.01677496 0.29031125]
Stock Position:  0.0038052248243047255
Bond Position:  [5.45655237]


portfolio before change:  [5.8194768]
curr_Stock_Price:  95.19603510434477
curr_Factors:  [95.1960351  -1.00814785 -1.22922524]
mat_Sqrt:  [[10.16108469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00077618 -0.01550896 -0.03813934]
Stock Position:  -0.0007761828827483954
Bond Position:  [5.89336633]


portfolio before change:  [5.81948658]
curr_Stock_Price:  96.13258891058335
curr_Factors:  [96.13258891 -0.94121162 -1.26388322]
mat_Sqrt:  [[10.59766328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00710117  0.01573029  0.12437149]
Stock Position:  -0.007101170305342443
Bond Position:  [6.50214047]


portfolio before change:  [5.80706089]
curr_Stock_Price:  97.99686097930459
curr_Factors:  [97.99686098 -0.91737527 -1.30478641]
mat_Sqrt:  [[10.62036906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01380848 -0.02186742 -0.22580245]
Stock Position:  -0.013808481652762748
Bond Position:  [7.16024874]


portfolio before change:  [5.81304509]
curr_Stock_Price:  97.62831100780637
curr_Factors:  [97.62831101 -0.88237886 -1.28902882]
mat_Sqrt:  [[11.13128752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08898935 0.18967946 0.32877086]
Stock Position:  0.0889893525245157
Bond Position:  [-2.8748351]


portfolio before change:  [5.84610594]
curr_Stock_Price:  98.00386417017702
curr_Factors:  [98.00386417 -0.95183412 -1.32381708]
mat_Sqrt:  [[10.06793588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161893 -0.03483027 -0.0209937 ]
Stock Position:  -0.0016189279121748062
Bond Position:  [6.00476713]


portfolio before change:  [5.84523029]
curr_Stock_Price:  99.00841658707762
curr_Factors:  [99.00841659 -0.81656422 -1.31020195]
mat_Sqrt:  [[11.80400284  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103413 -0.00461936 -0.26660398]
Stock Position:  0.0010341315076864866
Bond Position:  [5.74284257]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.84466214]
Stock Price:  97.76481806397244
PL:  [5.84466214]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-2.81916404e-02 -7.37567479e-02  2.06655415e-01]
 [ 7.51996408e-01  2.10018845e-01  2.08294250e-01]
 [-2.69183345e-01 -1.61307317e-01  3.76483173e-02]
 [ 1.17954186e-01  1.01080908e+00  7.73445789e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 7.92859649e-02 -5.75263760e-02  6.05983104e-02]
 [-3.28563018e-02 -1.14710736e-01 -2.45393818e-03]
 [ 1.60249138e-01  6.49389594e-02 -1.46923062e-01]
 [ 2.88436778e-02  4.93197331e-02 -4.41874882e-02]
 [-4.18468880e-01  5.70902538e-04 -1.65462379e-01]
 [ 6.63330962e-01  1.29128407e+00 -2.28178965e-01]
 [-2.62116466e-04  1.29853020e-02 -5.73437544e-02]
 [ 4.99372771e-02 -2.47534397e-02 -3.04994300e-02]
 [ 1.58913693e+00 -3.04550895e+00  2.55683717e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.42738658e-01 -9.85281816e-02  2.89039654e-02]
 [-2.64046392e-01 -4.48144209e-01  9.20945644e-03]
 [-2.48496565e-01 -1.64406149e+00 -2.03242077e-01]
 [ 7.10706639e-04  3.55868443e-02  6.83393329e-02]
 [ 3.95258357e-01 -5.92619035e-01  2.83370876e-01]
 [ 8.66656282e-02  7.64110789e-02 -2.40559117e-01]
 [-4.51433321e-01 -4.63852659e-02 -2.56525389e-01]
 [ 3.70157365e-01  3.70703848e-01  3.33106472e-01]
 [ 1.98124100e-01  8.67279943e-02  2.05106481e-01]
 [-1.22573674e-01 -3.90632950e-01  1.36399823e-01]
 [ 2.29291061e-01 -8.63223582e-02 -2.74902590e-01]
 [ 7.03756966e-01  4.41602891e-02  4.89944830e-01]
 [-6.00888419e-02  5.97590540e-02  1.07021385e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 7.35215585e-01 -3.35387820e-01 -2.18843143e-01]
 [-3.09720355e-03 -1.34305951e-01  1.19226686e-02]
 [-2.36749693e-01 -4.94851760e-02  1.13860296e-01]
 [-4.34675399e-02  1.99723374e-01 -3.11776649e-01]
 [ 6.88340576e-01  1.58722016e-01  2.42915606e-01]
 [ 5.05905690e-02  2.81499421e-01 -1.34941352e-01]
 [-1.07349118e-01  6.54504712e-02 -1.38320032e-02]
 [ 3.06869836e+00  2.17360326e+00  2.39918173e-01]
 [-1.13740147e-01  1.87168754e-03  1.61947174e-03]
 [ 3.85320438e-02 -1.20587113e-02 -1.94010314e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.27252875]
curr_Stock_Price:  99.49778034842996
curr_Factors:  [99.49778035 -0.8509704  -0.98511193]
mat_Sqrt:  [[15.86400967  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.70582995e-05 -2.38048880e-02  5.89530378e-01]
Stock Position:  -6.70582995094435e-05
Bond Position:  [-1.2658566]


portfolio before change:  [-1.27268685]
curr_Stock_Price:  99.49576842909711
curr_Factors:  [99.49576843 -0.89419862 -0.96553761]
mat_Sqrt:  [[15.49285389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05404971 0.06778329 0.59420552]
Stock Position:  0.054049706871265174
Bond Position:  [-6.65040397]


portfolio before change:  [-1.25375536]
curr_Stock_Price:  99.86141044480692
curr_Factors:  [99.86141044 -0.96830244 -0.95993932]
mat_Sqrt:  [[14.52021141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02027692 -0.05206171  0.10740017]
Stock Position:  -0.020276917783178448
Bond Position:  [0.77112625]


portfolio before change:  [-1.2800503]
curr_Stock_Price:  101.16295621277747
curr_Factors:  [101.16295621  -1.08221679  -0.954646  ]
mat_Sqrt:  [[13.19542072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03654023 0.32623723 2.20642555]
Stock Position:  0.036540228347105234
Bond Position:  [-4.97656782]


portfolio before change:  [-1.24813368]
curr_Stock_Price:  102.05344681921184
curr_Factors:  [102.05344682  -1.21134634  -0.94874555]
mat_Sqrt:  [[11.76824473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00498341 -0.01106097 -0.05874131]
Stock Position:  -0.004983411058849859
Bond Position:  [-0.73955941]


portfolio before change:  [-1.24842709]
curr_Stock_Price:  102.0937722079565
curr_Factors:  [102.09377221  -0.99517929  -0.93306864]
mat_Sqrt:  [[14.84471319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00538326 -0.01856656  0.17287011]
Stock Position:  0.005383264726077988
Bond Position:  [-1.79802489]


portfolio before change:  [-1.24797506]
curr_Stock_Price:  102.21949542697085
curr_Factors:  [102.21949543  -0.92767469  -0.92179511]
mat_Sqrt:  [[16.08122787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353035 -0.03702273 -0.0070004 ]
Stock Position:  -0.003530354852518138
Bond Position:  [-0.88710396]


portfolio before change:  [-1.2508162]
curr_Stock_Price:  102.99286041710714
curr_Factors:  [102.99286042  -0.95390955  -0.91269908]
mat_Sqrt:  [[15.9275615   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00901043  0.02095896 -0.4191306 ]
Stock Position:  0.009010431583163671
Bond Position:  [-2.17882633]


portfolio before change:  [-1.25079602]
curr_Stock_Price:  103.02532896029068
curr_Factors:  [103.02532896  -0.79584908  -0.88623853]
mat_Sqrt:  [[19.16119729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155999  0.01591788 -0.1260546 ]
Stock Position:  0.001559990871882299
Bond Position:  [-1.41151459]


portfolio before change:  [-1.25057415]
curr_Stock_Price:  103.28066274040778
curr_Factors:  [103.28066274  -0.83775583  -0.9263258 ]
mat_Sqrt:  [[17.69652931  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.55489200e-02  1.84258002e-04 -4.72018112e-01]
Stock Position:  -0.025548920019158698
Bond Position:  [1.38813524]


portfolio before change:  [-1.23179752]
curr_Stock_Price:  102.55252599215862
curr_Factors:  [102.55252599  -0.80544359  -0.92692999]
mat_Sqrt:  [[18.13786127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04853584  0.41676014 -0.65093107]
Stock Position:  0.04853584280025276
Bond Position:  [-6.2092708]


portfolio before change:  [-1.21158708]
curr_Stock_Price:  102.98492082668184
curr_Factors:  [102.98492083  -1.0162725   -0.93279537]
mat_Sqrt:  [[14.66574802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063527  0.00419099 -0.16358577]
Stock Position:  -0.0006352725837498267
Bond Position:  [-1.14616358]


portfolio before change:  [-1.21258206]
curr_Stock_Price:  104.32561785147696
curr_Factors:  [104.32561785  -0.95351432  -0.94625418]
mat_Sqrt:  [[15.60745135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00247695 -0.00798914 -0.08700638]
Stock Position:  0.002476947157336638
Bond Position:  [-1.47099111]


portfolio before change:  [-1.21414803]
curr_Stock_Price:  103.76764190235227
curr_Factors:  [103.7676419   -1.02988599  -0.92353072]
mat_Sqrt:  [[14.71308845  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10122873 -0.98293379  7.29394476]
Stock Position:  0.1012287272013208
Bond Position:  [-11.71841434]


portfolio before change:  [-1.26275221]
curr_Stock_Price:  103.30197081173036
curr_Factors:  [103.30197081  -0.97621256  -0.93851157]
mat_Sqrt:  [[15.22490133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142328 -0.03053791  0.10625201]
Stock Position:  -0.0014232849468409554
Bond Position:  [-1.11572407]


portfolio before change:  [-1.26443436]
curr_Stock_Price:  104.38585531889396
curr_Factors:  [104.38585532  -0.81047375  -0.94799216]
mat_Sqrt:  [[17.98662213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00714568 -0.03179983  0.08245497]
Stock Position:  0.007145681552004805
Bond Position:  [-2.01034244]


portfolio before change:  [-1.25428455]
curr_Stock_Price:  105.84143658029528
curr_Factors:  [105.84143658  -0.62533042  -0.96483457]
mat_Sqrt:  [[21.58021897  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0163874  -0.14463792  0.02627202]
Stock Position:  -0.016387395021066228
Bond Position:  [0.48018088]


portfolio before change:  [-1.26510789]
curr_Stock_Price:  106.50556699909177
curr_Factors:  [106.505567    -0.58464328  -0.98011238]
mat_Sqrt:  [[22.27447934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02808487 -0.53061856 -0.57979307]
Stock Position:  -0.028084868641117377
Bond Position:  [1.72608697]


portfolio before change:  [-1.27309972]
curr_Stock_Price:  106.79780992696813
curr_Factors:  [106.79780993  -0.77221923  -0.96357445]
mat_Sqrt:  [[18.82420865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0011647  0.0114856  0.19495309]
Stock Position:  0.001164699623223641
Bond Position:  [-1.39748709]


portfolio before change:  [-1.27343091]
curr_Stock_Price:  106.6634461129358
curr_Factors:  [106.66344611  -0.76041403  -0.93418049]
mat_Sqrt:  [[19.59126864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01695313 -0.19126697  0.80837824]
Stock Position:  0.016953130847813667
Bond Position:  [-3.08171027]


portfolio before change:  [-1.27730673]
curr_Stock_Price:  106.45755015797418
curr_Factors:  [106.45755016  -0.93369681  -0.94576812]
mat_Sqrt:  [[16.25306306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00327071  0.02466157 -0.6862482 ]
Stock Position:  0.0032707096556335736
Bond Position:  [-1.62549847]


portfolio before change:  [-1.27356088]
curr_Stock_Price:  107.6649479061296
curr_Factors:  [107.66494791  -0.98032522  -0.94441301]
mat_Sqrt:  [[15.70981758  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03267159 -0.01497078 -0.73179553]
Stock Position:  -0.03267158878304716
Bond Position:  [2.24402402]


portfolio before change:  [-1.22664846]
curr_Stock_Price:  106.23765574588765
curr_Factors:  [106.23765575  -0.90784452  -0.8913699 ]
mat_Sqrt:  [[17.5747674   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02923635 0.11964415 0.95026005]
Stock Position:  0.029236349657941148
Bond Position:  [-4.33264971]


portfolio before change:  [-1.16605173]
curr_Stock_Price:  108.32883132417555
curr_Factors:  [108.32883132  -1.08965228  -0.89520161]
mat_Sqrt:  [[14.88445608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.017313   0.02799134 0.5851117 ]
Stock Position:  0.017312998327673464
Bond Position:  [-3.04154861]


portfolio before change:  [-1.17344028]
curr_Stock_Price:  107.9240299722142
curr_Factors:  [107.92402997  -0.83623063  -0.89087551]
mat_Sqrt:  [[19.18869722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00909227 -0.12607624  0.38911073]
Stock Position:  -0.009092268859444074
Bond Position:  [-0.19216598]


portfolio before change:  [-1.18666973]
curr_Stock_Price:  109.37641051907974
curr_Factors:  [109.37641052  -0.81172332  -0.89756492]
mat_Sqrt:  [[19.79653658  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00785775 -0.02786042 -0.78422057]
Stock Position:  0.007857754628623361
Bond Position:  [-2.04612273]


portfolio before change:  [-1.18483047]
curr_Stock_Price:  109.64303131451881
curr_Factors:  [109.64303131  -0.75460423  -0.89428478]
mat_Sqrt:  [[21.08034132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03855634 0.01425267 1.39767623]
Stock Position:  0.038556335720127136
Bond Position:  [-5.412264]


portfolio before change:  [-1.19989678]
curr_Stock_Price:  109.26981828360056
curr_Factors:  [109.26981828  -0.92676609  -0.88003078]
mat_Sqrt:  [[17.93982941  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00145179  0.01928715  0.30530222]
Stock Position:  -0.001451793476967297
Bond Position:  [-1.04125957]


portfolio before change:  [-1.20252008]
curr_Stock_Price:  110.98709864164168
curr_Factors:  [110.98709864  -1.41933215  -0.88914345]
mat_Sqrt:  [[11.03352496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311591 -0.02600141 -0.03673698]
Stock Position:  -0.0031159089988017897
Bond Position:  [-0.85669438]


portfolio before change:  [-1.20221902]
curr_Stock_Price:  110.85610848402172
curr_Factors:  [110.85610848  -1.4462689   -0.89300677]
mat_Sqrt:  [[10.68624476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0582135  -0.10824595 -0.62429857]
Stock Position:  0.05821349572970756
Bond Position:  [-7.65554062]


portfolio before change:  [-1.22192561]
curr_Stock_Price:  110.5340252954796
curr_Factors:  [110.5340253   -1.45776606  -0.93226414]
mat_Sqrt:  [[10.12789191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027724  -0.04334706  0.03401205]
Stock Position:  -0.002772401879437712
Bond Position:  [-0.91548087]


portfolio before change:  [-1.22086104]
curr_Stock_Price:  110.10876012274387
curr_Factors:  [110.10876012  -1.47363291  -0.91463887]
mat_Sqrt:  [[10.1066823   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02212488 -0.01597127  0.32481173]
Stock Position:  -0.022124884328592612
Bond Position:  [1.21528254]


portfolio before change:  [-1.20842463]
curr_Stock_Price:  109.55352584789729
curr_Factors:  [109.55352585  -1.39116424  -0.90728439]
mat_Sqrt:  [[11.00076284  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00603052  0.06446044 -0.889412  ]
Stock Position:  -0.006030519867599804
Bond Position:  [-0.54775992]


portfolio before change:  [-1.20845743]
curr_Stock_Price:  109.54760938717241
curr_Factors:  [109.54760939  -1.61072484  -0.88778289]
mat_Sqrt:  [[ 9.00564412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08553797 0.05122731 0.69297061]
Stock Position:  0.08553796954121493
Bond Position:  [-10.5789375]


portfolio before change:  [-1.23148831]
curr_Stock_Price:  109.29382224892245
curr_Factors:  [109.29382225  -1.71203554  -0.89602207]
mat_Sqrt:  [[ 8.05249729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00999772  0.09085355 -0.38495012]
Stock Position:  0.009997719556520842
Bond Position:  [-2.3241773]


portfolio before change:  [-1.23454267]
curr_Stock_Price:  109.0173778776505
curr_Factors:  [109.01737788  -1.56142276  -0.88706842]
mat_Sqrt:  [[ 9.42170543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01027548  0.02112405 -0.03945885]
Stock Position:  -0.010275479609434956
Bond Position:  [-0.11433682]


portfolio before change:  [-1.23188879]
curr_Stock_Price:  108.75771389956272
curr_Factors:  [108.7577139   -1.61508457  -0.8658611 ]
mat_Sqrt:  [[ 9.09911293  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.391396   0.70152744 0.68441977]
Stock Position:  0.3913959952149506
Bond Position:  [-43.79922246]


portfolio before change:  [-1.34694477]
curr_Stock_Price:  108.47773981834995
curr_Factors:  [108.47773982  -1.44811088  -0.85614924]
mat_Sqrt:  [[10.82961888  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01043689  0.00060408  0.0046199 ]
Stock Position:  -0.01043688779288495
Bond Position:  [-0.21477477]


portfolio before change:  [-1.34255144]
curr_Stock_Price:  108.05422472887508
curr_Factors:  [108.05422473  -1.24309922  -0.85858221]
mat_Sqrt:  [[13.20970452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.67350403e-04 -3.89193234e-03 -5.53457424e-01]
Stock Position:  -0.0002673504027208685
Bond Position:  [-1.31366309]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.34265862]
Stock Price:  107.84088719938835
PL:  [-9.18354582]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 6.01833147e-02 -4.67020408e-02 -7.51387730e-02]
 [ 1.04579486e+00  2.25202727e-01  3.01737837e-01]
 [-3.00215829e-01 -1.89872077e-01  3.85534906e-02]
 [ 2.01454924e-01  1.49630163e+00  1.28614538e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-1.74651416e-02  2.28171477e-01 -9.37790609e-02]
 [-9.46856261e-02  1.18500015e-01  1.27229766e-02]
 [-6.34330807e-02  1.25943358e-01  6.51462416e-04]
 [ 5.01994401e-02  2.62093469e-02 -4.06764296e-02]
 [-1.47452151e-01 -7.89677537e-02 -4.82947169e-02]
 [ 7.88032232e-01  1.53845830e+00 -2.68918491e-01]
 [-6.07793377e-04  2.06978036e-02  2.98597025e-02]
 [-3.68708232e-01 -4.27195039e-03 -7.91498110e-01]
 [ 1.90181373e+00 -3.22118711e+00  2.72113053e+00]
 [ 2.84843254e-02 -7.67799882e-02  1.36717499e-02]
 [ 6.79496581e-02  1.01902810e-01 -6.89565108e-02]
 [-3.29406956e-02  4.20802233e-02 -8.47024331e-02]
 [-2.82430192e-01 -1.81616729e+00 -1.95606087e-01]
 [ 1.83408829e-02 -5.56635511e-02  1.34889980e-01]
 [ 1.26521559e-01  1.97805157e-01  3.33929811e-01]
 [ 2.96722496e-02 -5.34706657e-02  4.09723506e-02]
 [ 1.09069333e-01 -5.08875885e-02  2.59770931e-02]
 [ 1.28278321e-01 -3.61711314e-02 -1.25711524e-02]
 [-4.52794677e-02 -6.47185349e-02  8.39945151e-02]
 [ 6.27896436e-02 -2.28132512e-02 -1.14070165e-02]
 [ 3.36264809e-02 -4.45165717e-02  2.71042156e-01]
 [-1.16515004e-01 -1.28005864e-01 -4.06217990e-02]
 [-1.46852640e-01  1.18740796e-01  1.92241669e-01]
 [ 8.65890799e-02  4.67583825e-02  1.62992767e-01]
 [-1.25399878e-01  1.12452456e-01 -1.42466682e-02]
 [ 6.40809725e-02 -1.99913991e-02 -7.67426698e-02]
 [-6.23258450e-02  1.95183476e-03 -3.62989605e-02]
 [-7.24414002e-02  1.28220418e-02  7.46179411e-02]
 [ 1.14605832e-02 -4.57184090e-02 -1.12710084e-02]
 [-8.20091272e-02  1.44210482e-02  6.38536950e-02]
 [-1.01392632e-01 -5.73888075e-02 -6.47705136e-02]
 [ 1.78488472e+00  1.15837854e+00  1.48616009e-01]
 [ 1.56148802e-01 -2.51649127e-01  1.17339128e-02]
 [ 3.19702044e-02 -1.76320207e-02 -6.35172499e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.95485149]
curr_Stock_Price:  100.0746554176539
curr_Factors:  [100.07465542  -1.16748329  -0.99672905]
mat_Sqrt:  [[11.49260895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00307264 -0.01507302 -0.21435   ]
Stock Position:  0.003072641111260218
Bond Position:  [2.64735799]


portfolio before change:  [2.95462853]
curr_Stock_Price:  99.89438592869985
curr_Factors:  [99.89438593 -1.19751927 -0.99061832]
mat_Sqrt:  [[11.20069573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10297183 0.07268387 0.86077406]
Stock Position:  0.10297183123994992
Bond Position:  [-7.33167932]


portfolio before change:  [2.91396302]
curr_Stock_Price:  99.50836776452485
curr_Factors:  [99.50836776 -1.15728782 -0.97719357]
mat_Sqrt:  [[11.77242985  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02812534 -0.06128095  0.10998238]
Stock Position:  -0.028125341181745814
Bond Position:  [5.71266981]


portfolio before change:  [2.91821023]
curr_Stock_Price:  99.38274844820427
curr_Factors:  [99.38274845 -1.09448599 -0.96216468]
mat_Sqrt:  [[12.70922196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06054026 0.48292927 3.66901478]
Stock Position:  0.060540255210321005
Bond Position:  [-3.09844672]


portfolio before change:  [2.89427919]
curr_Stock_Price:  98.99385494837418
curr_Factors:  [98.99385495 -0.93937346 -0.9467035 ]
mat_Sqrt:  [[15.01396571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0039061  -0.01106097 -0.05874131]
Stock Position:  -0.003906096634742803
Bond Position:  [3.28095875]


portfolio before change:  [2.89666635]
curr_Stock_Price:  98.48771777578075
curr_Factors:  [98.48771778 -0.97916975 -0.97134484]
mat_Sqrt:  [[14.00503992  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071171  0.07364203 -0.26752556]
Stock Position:  0.0007117148929902303
Bond Position:  [2.82657118]


portfolio before change:  [2.89745985]
curr_Stock_Price:  99.10615506813137
curr_Factors:  [99.10615507 -0.98995028 -0.96581462]
mat_Sqrt:  [[14.01918355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00484335  0.03824572  0.03629511]
Stock Position:  -0.004843352312687293
Bond Position:  [3.37746587]


portfolio before change:  [2.89802957]
curr_Stock_Price:  99.07569834252791
curr_Factors:  [99.07569834 -1.08392695 -0.95570721]
mat_Sqrt:  [[12.88739919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291696  0.04064804  0.00185844]
Stock Position:  -0.002916959480136739
Bond Position:  [3.18702937]


portfolio before change:  [2.8986642]
curr_Stock_Price:  98.99471401478654
curr_Factors:  [98.99471401 -0.93451981 -0.96464967]
mat_Sqrt:  [[14.81880489  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00318827  0.00845903 -0.11603853]
Stock Position:  0.0031882705511524986
Bond Position:  [2.58304227]


portfolio before change:  [2.90240736]
curr_Stock_Price:  100.06747489922185
curr_Factors:  [100.0674749   -1.21615031  -0.97301834]
mat_Sqrt:  [[11.20854077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01547298 -0.02548673 -0.13777138]
Stock Position:  -0.015472977003137298
Bond Position:  [4.45074909]


portfolio before change:  [2.91388178]
curr_Stock_Price:  99.36185459998023
curr_Factors:  [99.3618546  -1.2480588  -0.98299681]
mat_Sqrt:  [[10.6729518   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09811493  0.49653528 -0.7671496 ]
Stock Position:  0.09811493383551324
Bond Position:  [-6.83500001]


portfolio before change:  [2.84909368]
curr_Stock_Price:  98.71023438986511
curr_Factors:  [98.71023439 -1.0291067  -0.96673077]
mat_Sqrt:  [[13.41470057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.000724   0.00668019 0.08518142]
Stock Position:  0.000723997846888329
Bond Position:  [2.77762768]


portfolio before change:  [2.84952631]
curr_Stock_Price:  98.82820276522952
curr_Factors:  [98.82820277 -1.02865376 -0.95318885]
mat_Sqrt:  [[13.62001513  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.89973220e-02 -1.37876606e-03 -2.25792380e+00]
Stock Position:  -0.038997321953985954
Bond Position:  [6.70356155]


portfolio before change:  [2.85097501]
curr_Stock_Price:  98.81254280238765
curr_Factors:  [98.8125428  -0.98544504 -0.95475491]
mat_Sqrt:  [[14.19691372  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12676981 -1.03963367  7.76262798]
Stock Position:  0.12676981339649776
Bond Position:  [-9.67547261]


portfolio before change:  [2.7720771]
curr_Stock_Price:  98.19971236260321
curr_Factors:  [98.19971236 -0.98965567 -0.94803145]
mat_Sqrt:  [[14.14436301  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00110308 -0.02478063  0.0390017 ]
Stock Position:  0.0011030832715815868
Bond Position:  [2.66375464]


portfolio before change:  [2.77304337]
curr_Stock_Price:  98.77381307845839
curr_Factors:  [98.77381308 -1.10878043 -0.97324541]
mat_Sqrt:  [[12.31486026  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0060638   0.03288899 -0.19671373]
Stock Position:  0.006063795424906519
Bond Position:  [2.17409917]


portfolio before change:  [2.7735329]
curr_Stock_Price:  98.80972386763145
curr_Factors:  [98.80972387 -1.06641782 -0.96390299]
mat_Sqrt:  [[12.97306399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0032098   0.01358133 -0.24163247]
Stock Position:  -0.0032097982232813234
Bond Position:  [3.09069218]


portfolio before change:  [2.77519253]
curr_Stock_Price:  98.41304242744286
curr_Factors:  [98.41304243 -1.05637246 -0.9602929 ]
mat_Sqrt:  [[13.09863437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05291252 -0.58616547 -0.55800972]
Stock Position:  -0.052912516985752556
Bond Position:  [7.98247431]


portfolio before change:  [2.79752452]
curr_Stock_Price:  98.0098463631099
curr_Factors:  [98.00984636 -0.94679455 -0.97139877]
mat_Sqrt:  [[14.39490937  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239758 -0.01796533  0.38480357]
Stock Position:  0.002397577444368594
Bond Position:  [2.56253832]


portfolio before change:  [2.79958317]
curr_Stock_Price:  98.73487325560323
curr_Factors:  [98.73487326 -0.87239639 -0.96495946]
mat_Sqrt:  [[15.72233587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0149508  0.06384134 0.9526088 ]
Stock Position:  0.014950800367096055
Bond Position:  [1.32341779]


portfolio before change:  [2.80355771]
curr_Stock_Price:  98.98964900655022
curr_Factors:  [98.98964901 -1.07559305 -0.97662361]
mat_Sqrt:  [[12.71520637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213296 -0.01725758  0.11688271]
Stock Position:  0.0021329611885159694
Bond Position:  [2.59241663]


portfolio before change:  [2.80311616]
curr_Stock_Price:  98.63070391235462
curr_Factors:  [98.63070391 -0.86332538 -1.00715031]
mat_Sqrt:  [[15.19409592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00684374 -0.0164239   0.07410542]
Stock Position:  0.006843743773394836
Bond Position:  [2.1281129]


portfolio before change:  [2.79799824]
curr_Stock_Price:  97.84400684302285
curr_Factors:  [97.84400684 -0.66678618 -1.00011903]
mat_Sqrt:  [[18.4759379   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00640448 -0.01167418 -0.035862  ]
Stock Position:  0.006404483767874231
Bond Position:  [2.17135789]


portfolio before change:  [2.80391065]
curr_Stock_Price:  98.72479199591625
curr_Factors:  [98.724792   -0.86589123 -1.0108391 ]
mat_Sqrt:  [[15.11376269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273557 -0.02088782  0.23961297]
Stock Position:  -0.0027355712508517834
Bond Position:  [3.07397935]


portfolio before change:  [2.80640782]
curr_Stock_Price:  97.95241303682145
curr_Factors:  [97.95241304 -0.67131937 -1.00813197]
mat_Sqrt:  [[18.26579974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00305513 -0.00736295 -0.03254104]
Stock Position:  0.003055133722014891
Bond Position:  [2.5071501]


portfolio before change:  [2.80632644]
curr_Stock_Price:  97.82318914271275
curr_Factors:  [97.82318914 -0.88361734 -0.98522483]
mat_Sqrt:  [[15.09433473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00529111 -0.01436766  0.77320783]
Stock Position:  0.005291112435782651
Bond Position:  [2.28873294]


portfolio before change:  [2.80486112]
curr_Stock_Price:  97.4921770253893
curr_Factors:  [97.49217703 -0.7687362  -0.96540809]
mat_Sqrt:  [[17.21236213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00876905 -0.04131371 -0.11588269]
Stock Position:  -0.008769045217013036
Bond Position:  [3.65977443]


portfolio before change:  [2.80826172]
curr_Stock_Price:  97.15655388635837
curr_Factors:  [97.15655389 -0.83358316 -0.9259503 ]
mat_Sqrt:  [[16.72308621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00498554  0.03832343  0.54841197]
Stock Position:  -0.0049855396700618166
Bond Position:  [3.29263957]


portfolio before change:  [2.81514083]
curr_Stock_Price:  95.85930122393245
curr_Factors:  [95.85930122 -0.73073779 -0.95581523]
mat_Sqrt:  [[17.7489877   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0072908 0.0150912 0.464973 ]
Stock Position:  0.0072908019458483905
Bond Position:  [2.11624965]


portfolio before change:  [2.82266275]
curr_Stock_Price:  96.85471594811139
curr_Factors:  [96.85471595 -1.07596836 -0.96636477]
mat_Sqrt:  [[12.56454492  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.008385    0.03629387 -0.04064178]
Stock Position:  -0.008384999689389848
Bond Position:  [3.63478951]


portfolio before change:  [2.82423863]
curr_Stock_Price:  96.72096407640052
curr_Factors:  [96.72096408 -1.34927588 -0.97467377]
mat_Sqrt:  [[ 9.46764808  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00468281 -0.0064522  -0.21892548]
Stock Position:  0.004682811718002789
Bond Position:  [2.37131257]


portfolio before change:  [2.82209884]
curr_Stock_Price:  96.20071473582986
curr_Factors:  [96.20071474 -1.60172712 -0.97970914]
mat_Sqrt:  [[ 7.27905126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00952554  0.00062995 -0.10355083]
Stock Position:  -0.009525543956083024
Bond Position:  [3.73846297]


portfolio before change:  [2.82259923]
curr_Stock_Price:  96.19724404950797
curr_Factors:  [96.19724405 -1.52016219 -0.98530411]
mat_Sqrt:  [[ 7.85330457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00695157  0.0041383   0.21286422]
Stock Position:  -0.006951568975676145
Bond Position:  [3.49132101]


portfolio before change:  [2.82372705]
curr_Stock_Price:  96.09778793980247
curr_Factors:  [96.09778794 -1.37376218 -1.00915876]
mat_Sqrt:  [[ 8.86796506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.94332030e-05 -1.47555531e-02 -3.21530498e-02]
Stock Position:  -1.9433202992713206e-05
Bond Position:  [2.82559454]


portfolio before change:  [2.82408994]
curr_Stock_Price:  95.60052218932921
curr_Factors:  [95.60052219 -1.47570132 -0.98833444]
mat_Sqrt:  [[ 8.13472979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00811722  0.00465437  0.18215682]
Stock Position:  -0.008117216412806189
Bond Position:  [3.60010007]


portfolio before change:  [2.82829463]
curr_Stock_Price:  95.13796868210407
curr_Factors:  [95.13796868 -1.5683472  -0.99560289]
mat_Sqrt:  [[ 7.3256219   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01724472 -0.01852216 -0.18477225]
Stock Position:  -0.01724472000761579
Bond Position:  [4.46892226]


portfolio before change:  [2.82333617]
curr_Stock_Price:  95.45789871435107
curr_Factors:  [95.45789871 -1.92278567 -1.00332613]
mat_Sqrt:  [[ 5.11702643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.40095041 0.37386507 0.42396011]
Stock Position:  0.40095041393772
Bond Position:  [-35.45054783]


portfolio before change:  [2.84414008]
curr_Stock_Price:  95.52083791551705
curr_Factors:  [95.52083792 -2.0333776  -1.00481401]
mat_Sqrt:  [[ 4.57749915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02341373 -0.08121941  0.03347359]
Stock Position:  0.023413726651827595
Bond Position:  [0.60764129]


portfolio before change:  [2.85158141]
curr_Stock_Price:  95.83541284928113
curr_Factors:  [95.83541285 -2.13106907 -1.00628654]
mat_Sqrt:  [[ 4.15900829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00650986 -0.00569071 -0.0181197 ]
Stock Position:  0.006509855468875148
Bond Position:  [2.22770672]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.8510096]
Stock Price:  95.70479802432145
PL:  [2.8510096]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-2.79443840e-02 -7.44067722e-02  2.04932070e-01]
 [ 8.46414399e-01  2.16019181e-01  2.27728314e-01]
 [-1.82688451e-01 -8.16905520e-02  3.51253845e-02]
 [ 8.89641381e-02  5.62976471e-01  5.42788219e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-5.37889314e-02  4.46850657e-01 -2.22007953e-01]
 [-8.07825201e-02  5.66582934e-02  1.14521965e-02]
 [-5.61945647e-02  1.07996681e-01  7.15634502e-03]
 [ 2.58060502e-02  5.26069371e-02 -4.46868985e-02]
 [-6.50922758e-02 -2.78258464e-02  8.63273303e-03]
 [ 8.46623986e-01  1.69180801e+00 -2.78684674e-01]
 [-6.54497923e-04  1.93803137e-02  3.65254716e-02]
 [-4.49856202e-01 -1.47070941e-02 -9.62112045e-01]
 [ 2.01729380e+00 -3.06017803e+00  2.59988943e+00]
 [ 2.18360006e-02 -7.16704971e-02  5.85348527e-03]
 [ 2.95061800e-02  2.07452883e-01 -1.23500214e-01]
 [ 3.41845798e-02  9.42014123e-02 -1.30790924e-02]
 [-2.85017145e-01 -1.83704395e+00 -1.97825675e-01]
 [ 1.45783435e-02 -3.41893859e-02  1.15426370e-01]
 [ 8.04478413e-02  1.75454133e-01  2.53368761e-01]
 [ 2.54561430e-02  7.51004985e-03  7.29067967e-03]
 [ 1.10637433e-01 -5.10670101e-02  3.22788780e-02]
 [ 3.23010696e-01  1.06407942e-02  8.87941565e-02]
 [-1.22262138e-01 -8.67373007e-03  6.13165281e-02]
 [-5.97714534e-02 -2.29191126e-01  8.35403734e-02]
 [ 1.16131478e-01 -2.45470732e-02 -1.01447794e-01]
 [ 4.66424071e-01 -4.68575886e-02  2.68736842e-01]
 [-4.73979133e-02  3.13552147e-02  9.06287081e-02]
 [-1.22304218e-02 -7.75809099e-02 -7.71495487e-03]
 [ 1.07310683e-01 -1.46492845e-04  4.82319736e-02]
 [-2.13663870e-02 -1.47055676e-02 -6.58026683e-02]
 [-2.99761817e-03  1.92666915e-02 -5.78100419e-02]
 [-1.11959662e-01 -3.84649911e-02  2.46688809e-02]
 [ 2.73683868e-01  1.96715456e-02  5.01395760e-02]
 [ 1.37525954e-01  1.22980541e-01 -9.99818625e-02]
 [-3.93713412e-02  2.95274581e-03 -3.13476689e-02]
 [ 1.93895911e+00  1.42817901e+00  1.88422185e-01]
 [-8.69357392e-02 -2.28294139e-03 -1.69799973e-02]
 [ 3.80769414e-02 -1.25239613e-02 -1.78228423e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.57131515]
curr_Stock_Price:  99.45700747829036
curr_Factors:  [99.45700748 -0.85162034 -0.99892465]
mat_Sqrt:  [[15.62981756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.32395552e-05 -2.40146825e-02  5.84614154e-01]
Stock Position:  -8.323955517377604e-05
Bond Position:  [-1.56303639]


portfolio before change:  [-1.57156259]
curr_Stock_Price:  100.08237048234544
curr_Factors:  [100.08237048  -0.61700518  -1.00973707]
mat_Sqrt:  [[19.67308189  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04762823 0.06971989 0.64964549]
Stock Position:  0.047628225351305224
Bond Position:  [-6.33830829]


portfolio before change:  [-1.5446266]
curr_Stock_Price:  100.66455316340699
curr_Factors:  [100.66455316  -0.81864659  -1.03455798]
mat_Sqrt:  [[15.77756769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01218144 -0.02636551  0.10020294]
Stock Position:  -0.012181442015693354
Bond Position:  [-0.31838719]


portfolio before change:  [-1.55683162]
curr_Stock_Price:  101.66322123025353
curr_Factors:  [101.66322123  -0.59396836  -1.04180546]
mat_Sqrt:  [[19.80415537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01588946 0.18169987 1.54842371]
Stock Position:  0.015889463814129423
Bond Position:  [-3.1722057]


portfolio before change:  [-1.58866272]
curr_Stock_Price:  99.6848945072074
curr_Factors:  [99.68489451 -0.41846355 -1.03710458]
mat_Sqrt:  [[23.25327586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252205 -0.01106097 -0.05874131]
Stock Position:  -0.00252205329241566
Bond Position:  [-1.33725211]


portfolio before change:  [-1.58488547]
curr_Stock_Price:  98.12092099023896
curr_Factors:  [98.12092099 -0.39678953 -1.02323832]
mat_Sqrt:  [[23.71654147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.32810187e-04  1.44220429e-01 -6.33326894e-01]
Stock Position:  -0.00033281018669840956
Bond Position:  [-1.55222982]


portfolio before change:  [-1.58494352]
curr_Stock_Price:  97.71232025538953
curr_Factors:  [97.71232026 -0.5831722  -1.04422041]
mat_Sqrt:  [[19.1947162   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00348427  0.01828639  0.03266993]
Stock Position:  -0.0034842674352566832
Bond Position:  [-1.24448767]


portfolio before change:  [-1.5883113]
curr_Stock_Price:  98.63423771115369
curr_Factors:  [98.63423771 -0.78224755 -1.02208324]
mat_Sqrt:  [[16.23367265  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00201366  0.03485578  0.02041506]
Stock Position:  -0.0020136571913359847
Bond Position:  [-1.38969576]


portfolio before change:  [-1.59086701]
curr_Stock_Price:  99.81715487564674
curr_Factors:  [99.81715488 -0.74928423 -1.03849082]
mat_Sqrt:  [[16.70261037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00164182  0.01697882 -0.12747928]
Stock Position:  0.0016418224879974767
Bond Position:  [-1.75474906]


portfolio before change:  [-1.59157178]
curr_Stock_Price:  99.52150252514183
curr_Factors:  [99.52150253 -0.93209942 -1.05649581]
mat_Sqrt:  [[13.62325829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00506561 -0.00898075  0.02462678]
Stock Position:  -0.005065605610560694
Bond Position:  [-1.0874351]


portfolio before change:  [-1.58737937]
curr_Stock_Price:  98.66704478206394
curr_Factors:  [98.66704478 -0.78133921 -1.07070209]
mat_Sqrt:  [[15.48248977  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07331357  0.54602869 -0.7950098 ]
Stock Position:  0.07331356884882646
Bond Position:  [-8.82101255]


portfolio before change:  [-1.56098443]
curr_Stock_Price:  99.04211358132575
curr_Factors:  [99.04211358 -0.851357   -1.10040444]
mat_Sqrt:  [[14.06632587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00076475 0.00625497 0.104197  ]
Stock Position:  0.0007647499994121569
Bond Position:  [-1.63672689]


portfolio before change:  [-1.56221996]
curr_Stock_Price:  97.69405439393219
curr_Factors:  [97.69405439 -0.89137329 -1.08283442]
mat_Sqrt:  [[13.56689984  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04785534 -0.00474669 -2.74463786]
Stock Position:  -0.04785533774665795
Bond Position:  [3.112962]


portfolio before change:  [-1.52564447]
curr_Stock_Price:  96.9378932454029
curr_Factors:  [96.93789325 -0.68865647 -1.06437385]
mat_Sqrt:  [[16.79431058  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11452318 -0.98766821  7.41676088]
Stock Position:  0.11452317609190682
Bond Position:  [-12.62727989]


portfolio before change:  [-1.45062674]
curr_Stock_Price:  97.6067206331605
curr_Factors:  [97.60672063 -0.77391354 -1.07175988]
mat_Sqrt:  [[15.41394974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00054504 -0.02313155  0.01669836]
Stock Position:  0.0005450361201898014
Bond Position:  [-1.50382593]


portfolio before change:  [-1.45111025]
curr_Stock_Price:  97.06451912828123
curr_Factors:  [97.06451913 -0.68141386 -1.07560884]
mat_Sqrt:  [[16.74924539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00278478  0.06695513 -0.35231174]
Stock Position:  0.0027847789923627253
Bond Position:  [-1.72141349]


portfolio before change:  [-1.45059559]
curr_Stock_Price:  97.32660512931822
curr_Factors:  [97.32660513 -0.82102485 -1.08674155]
mat_Sqrt:  [[14.44438838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00351303  0.03040338 -0.03731101]
Stock Position:  0.0035130323782625915
Bond Position:  [-1.79250711]


portfolio before change:  [-1.44660962]
curr_Stock_Price:  98.52501392960093
curr_Factors:  [98.52501393 -0.92607841 -1.08965192]
mat_Sqrt:  [[13.12580484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05335926 -0.59290339 -0.56434159]
Stock Position:  -0.053359255070611185
Bond Position:  [3.81061173]


portfolio before change:  [-1.45291784]
curr_Stock_Price:  98.65216289518573
curr_Factors:  [98.6521629  -0.78350987 -1.06436268]
mat_Sqrt:  [[15.54482219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00200458 -0.01103458  0.3292793 ]
Stock Position:  0.0020045757357471474
Bond Position:  [-1.65067357]


portfolio before change:  [-1.45419796]
curr_Stock_Price:  98.1165016170805
curr_Factors:  [98.11650162 -0.66096626 -1.02898024]
mat_Sqrt:  [[18.10537894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00927796 0.05662758 0.72279055]
Stock Position:  0.00927795814517186
Bond Position:  [-2.36451875]


portfolio before change:  [-1.46235059]
curr_Stock_Price:  97.26965085523742
curr_Factors:  [97.26965086 -0.59517208 -1.03630442]
mat_Sqrt:  [[19.02988287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00149645 0.00242386 0.02079828]
Stock Position:  0.0014964532061874166
Bond Position:  [-1.60791007]


portfolio before change:  [-1.46130202]
curr_Stock_Price:  98.10467033143112
curr_Factors:  [98.10467033 -0.49183688 -1.060045  ]
mat_Sqrt:  [[20.78336894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00513884 -0.01648181  0.09208265]
Stock Position:  0.005138835873449566
Bond Position:  [-1.96544582]


portfolio before change:  [-1.4567952]
curr_Stock_Price:  99.02949440246819
curr_Factors:  [99.0294944  -0.39325424 -1.07588101]
mat_Sqrt:  [[22.78910282  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01506456 0.0034343  0.25330501]
Stock Position:  0.015064558413872928
Bond Position:  [-2.9486308]


portfolio before change:  [-1.43535443]
curr_Stock_Price:  100.47722143507582
curr_Factors:  [100.47722144  -0.41157344  -1.08719417]
mat_Sqrt:  [[22.44714515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00496796 -0.00279943  0.17491899]
Stock Position:  -0.004967957911029256
Bond Position:  [-0.93618783]


portfolio before change:  [-1.44839133]
curr_Stock_Price:  103.07786108412658
curr_Factors:  [103.07786108  -0.64478387  -1.09587325]
mat_Sqrt:  [[18.08038254  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00495024 -0.07397112  0.23831743]
Stock Position:  -0.0049502430939552125
Bond Position:  [-0.93813086]


portfolio before change:  [-1.45358502]
curr_Stock_Price:  104.10334975391866
curr_Factors:  [104.10334975  -0.63058627  -1.11472477]
mat_Sqrt:  [[18.17547426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00497444 -0.00792253 -0.28940232]
Stock Position:  0.004974444254214381
Bond Position:  [-1.97144133]


portfolio before change:  [-1.4519221]
curr_Stock_Price:  104.48718627382071
curr_Factors:  [104.48718627  -0.82920781  -1.12568967]
mat_Sqrt:  [[14.79319033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03459125 -0.01512322  0.76663141]
Stock Position:  0.03459125264535832
Bond Position:  [-5.06626475]


portfolio before change:  [-1.47119456]
curr_Stock_Price:  103.94834645711535
curr_Factors:  [103.94834646  -0.65366551  -1.14790633]
mat_Sqrt:  [[17.15555907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131141  0.01011985  0.25853848]
Stock Position:  -0.0013114145234201713
Bond Position:  [-1.33487519]


portfolio before change:  [-1.47078574]
curr_Stock_Price:  103.50936080415632
curr_Factors:  [103.5093608   -0.74280496  -1.16595079]
mat_Sqrt:  [[15.34678951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193144 -0.02503913 -0.02200862]
Stock Position:  -0.001931437664151657
Bond Position:  [-1.27086386]


portfolio before change:  [-1.47170124]
curr_Stock_Price:  103.90110454768029
curr_Factors:  [103.90110455  -0.38257521  -1.12876305]
mat_Sqrt:  [[22.92209438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.10974648e-03 -4.72803625e-05  1.37592396e-01]
Stock Position:  0.005109746480417261
Bond Position:  [-2.00260954]


portfolio before change:  [-1.4874234]
curr_Stock_Price:  100.87320099452272
curr_Factors:  [100.87320099  -0.38623433  -1.13159353]
mat_Sqrt:  [[22.11014222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170963 -0.0047462  -0.1877167 ]
Stock Position:  -0.001709625450290254
Bond Position:  [-1.31496801]


portfolio before change:  [-1.48782763]
curr_Stock_Price:  101.01349253143204
curr_Factors:  [101.01349253  -0.23875069  -1.08324879]
mat_Sqrt:  [[26.9303692   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040346  0.0062183  -0.16491596]
Stock Position:  -0.00040345702408524055
Bond Position:  [-1.44707302]


portfolio before change:  [-1.48818511]
curr_Stock_Price:  101.45118808035365
curr_Factors:  [101.45118808  -0.14506346  -1.08780982]
mat_Sqrt:  [[29.56834918  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00388171 -0.01241452  0.07037345]
Stock Position:  -0.0038817108215429643
Bond Position:  [-1.09438094]


portfolio before change:  [-1.49225306]
curr_Stock_Price:  102.46392183792031
curr_Factors:  [ 1.02463922e+02 -7.48519140e-02 -1.09828584e+00]
mat_Sqrt:  [[31.7017854   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00908258 0.00634896 0.14303425]
Stock Position:  0.009082580032304725
Bond Position:  [-2.42288983]


portfolio before change:  [-1.47158146]
curr_Stock_Price:  104.77322988691525
curr_Factors:  [104.77322989  -0.36545539  -1.10121654]
mat_Sqrt:  [[24.17034254  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00588409  0.0396918  -0.28522042]
Stock Position:  0.005884092836662993
Bond Position:  [-2.08807687]


portfolio before change:  [-1.47390342]
curr_Stock_Price:  104.42297535228715
curr_Factors:  [104.42297535  -0.37290886  -1.11963074]
mat_Sqrt:  [[23.47439182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192412  0.00095299 -0.08942617]
Stock Position:  -0.0019241150520039967
Bond Position:  [-1.2729816]


portfolio before change:  [-1.47774362]
curr_Stock_Price:  106.33609864873485
curr_Factors:  [106.33609865  -0.40209685  -1.12114992]
mat_Sqrt:  [[23.18158117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09787712 0.46094279 0.53751605]
Stock Position:  0.09787712183977706
Bond Position:  [-11.8856149]


portfolio before change:  [-1.63776306]
curr_Stock_Price:  104.71637751382073
curr_Factors:  [104.71637751  -0.43540812  -1.09286776]
mat_Sqrt:  [[22.71395861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00400053 -0.00073682 -0.04843921]
Stock Position:  -0.004000525474559912
Bond Position:  [-1.21884252]


portfolio before change:  [-1.64224669]
curr_Stock_Price:  105.79905197979552
curr_Factors:  [105.79905198  -0.52420559  -1.07976611]
mat_Sqrt:  [[21.27579123  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.04321513e-05 -4.04209112e-03 -5.08436082e-01]
Stock Position:  -4.043215133250651e-05
Bond Position:  [-1.63796901]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.64246381]
Stock Price:  106.1046608936543
PL:  [-7.7471247]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 4.41743682e-03 -7.47268168e-02  1.02505554e-01]
 [ 5.75247013e-01  1.92933162e-01  1.50371772e-01]
 [-2.52063800e-01 -1.45549128e-01  3.71489645e-02]
 [ 1.71824197e-01  1.30427377e+00  1.10072988e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.15726043e-02 -6.43359749e-02  4.92952227e-02]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [ 6.76460615e-02  1.40893045e-01 -5.01560487e-02]
 [ 1.62048649e-02  6.29969713e-02 -4.62654104e-02]
 [-1.28245853e-01 -6.70414764e-02 -3.50192528e-02]
 [ 9.47355083e-01  1.85830834e+00 -3.19948086e-01]
 [-1.43676321e-03 -6.46024458e-02  1.96285862e-01]
 [-5.07620523e-01 -1.57795639e-02 -1.06909878e+00]
 [ 1.87029326e+00 -2.72338495e+00  2.31261755e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.27377451e-01  3.43921683e-02 -5.59284724e-02]
 [ 9.67396302e-03  1.98732269e-01  1.53580572e-02]
 [-2.85242101e-01 -1.84873234e+00 -2.01585108e-01]
 [ 1.78905836e-02 -3.79432411e-03  4.37663375e-03]
 [ 8.89044186e-02  1.20517068e-01  2.38565514e-01]
 [ 3.10363363e-02 -3.37396436e-02  5.46186137e-02]
 [ 1.12193022e-01 -5.12354470e-02  3.65201373e-02]
 [ 2.62186699e-01 -1.91239947e-02  3.29731438e-02]
 [-1.32630527e-01 -1.12535173e-03  5.82621500e-02]
 [-5.01004475e-02 -2.58239929e-01  8.52288872e-02]
 [ 1.17337972e-01 -2.37363213e-02 -8.03035694e-02]
 [ 2.98357549e-01 -2.14603026e-02  1.90098587e-01]
 [-5.76992932e-02  6.16775731e-02  1.04432369e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 3.83827917e-01 -1.19224212e-01 -1.05431804e-01]
 [-1.31672301e-02 -1.27811570e-01  9.15489637e-03]
 [-3.88830468e-01 -1.03465946e-01  2.31322479e-01]
 [-3.97248350e-02  9.64777131e-02 -1.76906908e-01]
 [ 7.94659240e-01  1.86916827e-01  2.98783860e-01]
 [ 3.64122254e-01  6.32581355e-01 -3.64583896e-01]
 [-2.03095191e-01  9.12031607e-02 -7.71954135e-02]
 [ 2.89212218e+00  2.19912217e+00  2.59561395e-01]
 [-2.01124273e-02 -1.82208500e-01 -3.71920773e-03]
 [ 4.63871091e-02 -9.05385514e-03 -3.90964733e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.53061743]
curr_Stock_Price:  100.15322535800773
curr_Factors:  [100.15322536  -0.94603973  -0.99134147]
mat_Sqrt:  [[14.43015435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00069907 -0.02411798  0.29241981]
Stock Position:  0.0006990741440444577
Bond Position:  [3.4606029]


portfolio before change:  [3.53031026]
curr_Stock_Price:  99.09501130639615
curr_Factors:  [99.09501131 -0.86457655 -0.98213598]
mat_Sqrt:  [[15.63272659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04128031 0.06226891 0.42896881]
Stock Position:  0.04128031248668874
Bond Position:  [-0.56036277]


portfolio before change:  [3.56906379]
curr_Stock_Price:  100.03549797542479
curr_Factors:  [100.03549798  -0.90538498  -0.96970692]
mat_Sqrt:  [[15.33953065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01787479 -0.04697578  0.10597566]
Stock Position:  -0.017874790091633945
Bond Position:  [5.35717732]


portfolio before change:  [3.57012006]
curr_Stock_Price:  100.01387122794144
curr_Factors:  [100.01387123  -1.04744481  -0.96080704]
mat_Sqrt:  [[13.42417302  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04936941 0.42095255 3.14007596]
Stock Position:  0.0493694107122373
Bond Position:  [-1.36750583]


portfolio before change:  [3.56583287]
curr_Stock_Price:  99.93049491118745
curr_Factors:  [99.93049491 -1.03079444 -0.98258565]
mat_Sqrt:  [[13.3443731   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00439481 -0.01106097 -0.05874131]
Stock Position:  -0.004394811244810999
Bond Position:  [4.00500853]


portfolio before change:  [3.56120847]
curr_Stock_Price:  101.09665529380625
curr_Factors:  [101.09665529  -1.18058089  -1.01193065]
mat_Sqrt:  [[11.28602799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00518361 -0.02076435  0.14062555]
Stock Position:  0.005183614964111564
Bond Position:  [3.03716234]


portfolio before change:  [3.56010501]
curr_Stock_Price:  100.81053573559333
curr_Factors:  [100.81053574  -0.99514828  -1.01372336]
mat_Sqrt:  [[13.52271996  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00490214 -0.00251018 -0.21167328]
Stock Position:  -0.00490214417861156
Bond Position:  [4.05429279]


portfolio before change:  [3.55755034]
curr_Stock_Price:  101.43505485589799
curr_Factors:  [101.43505486  -0.88865036  -0.99796801]
mat_Sqrt:  [[15.37588502  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00560408  0.04547303 -0.14308125]
Stock Position:  0.005604078926490157
Bond Position:  [2.98910029]


portfolio before change:  [3.55070267]
curr_Stock_Price:  100.14646942097166
curr_Factors:  [100.14646942  -0.88029184  -1.00763025]
mat_Sqrt:  [[15.16077818  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129414  0.02033219 -0.13198234]
Stock Position:  0.0012941407248929406
Bond Position:  [3.42109904]


portfolio before change:  [3.55263407]
curr_Stock_Price:  101.30842940582822
curr_Factors:  [101.30842941  -0.5963626   -0.99164438]
mat_Sqrt:  [[20.70059906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00720167 -0.02163754 -0.09990018]
Stock Position:  -0.007201671376591229
Bond Position:  [4.28222409]


portfolio before change:  [3.56920332]
curr_Stock_Price:  99.0820102609834
curr_Factors:  [99.08201026 -0.46966357 -0.99635771]
mat_Sqrt:  [[22.87230095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05514843  0.59976644 -0.91272283]
Stock Position:  0.055148432935975406
Bond Position:  [-1.89501428]


portfolio before change:  [3.49720687]
curr_Stock_Price:  97.78080256194477
curr_Factors:  [97.78080256 -0.40065115 -0.99271681]
mat_Sqrt:  [[24.27289524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104821 -0.02085035  0.55994893]
Stock Position:  0.0010482062932903444
Bond Position:  [3.39471241]


portfolio before change:  [3.49678594]
curr_Stock_Price:  96.9743858114362
curr_Factors:  [96.97438581 -0.4598566  -1.01255762]
mat_Sqrt:  [[22.24311802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03277735 -0.00509283 -3.04984125]
Stock Position:  -0.03277734656671593
Bond Position:  [6.67534899]


portfolio before change:  [3.49649698]
curr_Stock_Price:  97.00866049022501
curr_Factors:  [ 9.70086605e+01 -3.38213450e-02 -1.00898588e+00]
mat_Sqrt:  [[34.19204563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05224741 -0.87896871  6.59725416]
Stock Position:  0.05224740662789668
Bond Position:  [-1.57195395]


portfolio before change:  [3.62482754]
curr_Stock_Price:  99.46863083661624
curr_Factors:  [ 9.94686308e+01  1.65806201e-02 -1.00527475e+00]
mat_Sqrt:  [[37.00852157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058552 -0.03053791  0.10625201]
Stock Position:  -0.0005855238728523069
Bond Position:  [3.6830688]


portfolio before change:  [3.62524848]
curr_Stock_Price:  99.5360447901994
curr_Factors:  [ 9.95360448e+01 -5.55591097e-02 -9.78290883e-01]
mat_Sqrt:  [[35.39851412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0034742   0.01110002 -0.15954836]
Stock Position:  0.0034741958656529957
Bond Position:  [3.27944077]


portfolio before change:  [3.61901429]
curr_Stock_Price:  97.62361630244249
curr_Factors:  [ 9.76236163e+01  3.60349481e-02 -9.65352059e-01]
mat_Sqrt:  [[38.54407236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00138478 0.06414056 0.04381226]
Stock Position:  0.0013847775981372244
Bond Position:  [3.48382729]


portfolio before change:  [3.6217838]
curr_Stock_Price:  99.30909348505372
curr_Factors:  [99.30909349  0.17366284 -0.97723876]
mat_Sqrt:  [[44.46317045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01582796 -0.5966758  -0.5750662 ]
Stock Position:  -0.015827962570774852
Bond Position:  [5.19364442]


portfolio before change:  [3.63522919]
curr_Stock_Price:  98.50064221873053
curr_Factors:  [98.50064222 -0.27574695 -0.96578549]
mat_Sqrt:  [[28.46088341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063278 -0.00122461  0.01248532]
Stock Position:  0.0006327789206071277
Bond Position:  [3.57290006]


portfolio before change:  [3.63578183]
curr_Stock_Price:  98.66816760050554
curr_Factors:  [98.6681676  -0.51678211 -0.94984315]
mat_Sqrt:  [[22.76301606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00712567 0.03889672 0.68056101]
Stock Position:  0.0071256745341531395
Bond Position:  [2.93270458]


portfolio before change:  [3.6360706]
curr_Stock_Price:  98.65724322293184
curr_Factors:  [98.65724322 -0.53224908 -0.95455781]
mat_Sqrt:  [[22.3057562   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158247 -0.01088942  0.1558117 ]
Stock Position:  0.0015824721587752116
Bond Position:  [3.47994826]


portfolio before change:  [3.63528691]
curr_Stock_Price:  97.8871105013479
curr_Factors:  [97.8871105  -0.42973872 -0.94633789]
mat_Sqrt:  [[24.72310609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00441649 -0.01653617  0.10418179]
Stock Position:  0.004416486807214773
Bond Position:  [3.20296977]


portfolio before change:  [3.63391797]
curr_Stock_Price:  97.48649048718323
curr_Factors:  [ 9.74864905e+01 -3.28217550e-02 -9.51050348e-01]
mat_Sqrt:  [[36.44636422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00727133 -0.00617224  0.0940632 ]
Stock Position:  0.007271332828718479
Bond Position:  [2.92506125]


portfolio before change:  [3.62898985]
curr_Stock_Price:  96.75845636424312
curr_Factors:  [96.75845636  0.27566004 -0.9766992 ]
mat_Sqrt:  [[47.9989231   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252021 -0.00036321  0.1662057 ]
Stock Position:  -0.002520213357479515
Bond Position:  [3.8728418]


portfolio before change:  [3.61593104]
curr_Stock_Price:  102.13218428840483
curr_Factors:  [ 1.02132184e+02  1.26262078e-02 -9.87454504e-01]
mat_Sqrt:  [[38.53009415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221687 -0.08334658  0.24313429]
Stock Position:  -0.002216869185286604
Bond Position:  [3.84234473]


portfolio before change:  [3.61305842]
curr_Stock_Price:  103.6446537494317
curr_Factors:  [103.64465375  -0.25399716  -1.01468428]
mat_Sqrt:  [[29.14510021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00329733 -0.00766086 -0.22908373]
Stock Position:  0.003297326754431856
Bond Position:  [3.27130813]


portfolio before change:  [3.61662084]
curr_Stock_Price:  104.60102954476055
curr_Factors:  [104.60102954  -0.27802002  -1.01882128]
mat_Sqrt:  [[28.59729378  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01163679 -0.00692628  0.54229835]
Stock Position:  0.011636789714605007
Bond Position:  [2.39940066]


portfolio before change:  [3.63168822]
curr_Stock_Price:  105.87005919621598
curr_Factors:  [ 1.05870059e+02 -7.80134870e-02 -1.01907619e+00]
mat_Sqrt:  [[35.34379348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067317  0.01990635  0.29791648]
Stock Position:  -0.0006731660862381617
Bond Position:  [3.70295635]


portfolio before change:  [3.63003386]
curr_Stock_Price:  109.01527565514522
curr_Factors:  [109.01527566  -0.36493889  -0.99834768]
mat_Sqrt:  [[27.88813812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00123276 -0.02600141 -0.03673698]
Stock Position:  -0.0012327628174928914
Bond Position:  [3.76442384]


portfolio before change:  [3.63141479]
curr_Stock_Price:  108.27681922374587
curr_Factors:  [108.27681922  -0.26943581  -0.98643336]
mat_Sqrt:  [[30.84028883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01095872 -0.03847945 -0.30076759]
Stock Position:  0.010958723550576262
Bond Position:  [2.44483906]


portfolio before change:  [3.65190408]
curr_Stock_Price:  110.11860958851045
curr_Factors:  [110.11860959  -0.29772596  -0.98163347]
mat_Sqrt:  [[30.63669955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00122036 -0.04125101  0.02611637]
Stock Position:  -0.0012203639018972699
Bond Position:  [3.78628886]


portfolio before change:  [3.65036021]
curr_Stock_Price:  111.77154866196746
curr_Factors:  [111.77154866  -0.27521034  -0.99983238]
mat_Sqrt:  [[31.23109791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01161444 -0.03339349  0.65989865]
Stock Position:  -0.011614444781900067
Bond Position:  [4.94852469]


portfolio before change:  [3.65753273]
curr_Stock_Price:  111.20725862427228
curr_Factors:  [111.20725862  -0.41409442  -1.00626865]
mat_Sqrt:  [[26.87059557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208936  0.03113805 -0.50466617]
Stock Position:  -0.0020893610470134475
Bond Position:  [3.88988484]


portfolio before change:  [3.65486589]
curr_Stock_Price:  112.71638355410087
curr_Factors:  [112.71638355  -0.49672635  -1.01852267]
mat_Sqrt:  [[24.76981466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03608434 0.06032715 0.85234719]
Stock Position:  0.03608434256429953
Bond Position:  [-0.41243071]


portfolio before change:  [3.70632824]
curr_Stock_Price:  114.1439808617515
curr_Factors:  [114.14398086  -0.35516755  -1.01178206]
mat_Sqrt:  [[29.09339081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01439595  0.20416475 -1.04005637]
Stock Position:  0.014395950224432042
Bond Position:  [2.06311717]


portfolio before change:  [3.68211567]
curr_Stock_Price:  112.44416399217978
curr_Factors:  [112.44416399  -0.15057729  -0.98116341]
mat_Sqrt:  [[36.26003162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00552222  0.02943569 -0.22021703]
Stock Position:  -0.00552221999947172
Bond Position:  [4.30305708]


portfolio before change:  [3.6687944]
curr_Stock_Price:  114.95387643545692
curr_Factors:  [114.95387644  -0.34742353  -0.98769802]
mat_Sqrt:  [[30.24737569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11220804 0.70976363 0.74045641]
Stock Position:  0.11220804392162484
Bond Position:  [-9.22995522]


portfolio before change:  [3.76910689]
curr_Stock_Price:  115.85814586311429
curr_Factors:  [115.85814586  -0.48528044  -1.00979886]
mat_Sqrt:  [[25.97896732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223507 -0.05880754 -0.01060986]
Stock Position:  -0.002235068122065031
Bond Position:  [4.02805774]


portfolio before change:  [3.76593157]
curr_Stock_Price:  117.50411714294941
curr_Factors:  [117.50411714  -0.73326071  -1.0146396 ]
mat_Sqrt:  [[20.4620727   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017235  -0.00292212 -1.11531356]
Stock Position:  -0.001723498091517696
Bond Position:  [3.96844969]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.76734407]
Stock Price:  116.97240094733777
PL:  [-13.20505688]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-2.68299001e-02 -7.73366925e-02  1.97164263e-01]
 [ 6.12347932e-01  1.98671639e-01  1.66991902e-01]
 [-2.48171263e-01 -1.41966128e-01  3.70354248e-02]
 [ 2.08483682e-01  1.31000190e+00  1.28659473e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 2.10799720e-02  2.97849399e-02  7.78915480e-03]
 [-3.26548052e-02 -1.16086109e-01 -1.07004587e-03]
 [ 1.21791835e-01  1.01572884e-01 -1.02623388e-01]
 [ 1.05049246e-02  6.91652279e-02 -4.72025263e-02]
 [-4.51340718e-01 -8.62991916e-03 -1.85009639e-01]
 [ 4.47237575e-01  8.86405714e-01 -1.51674632e-01]
 [-2.63811099e-04  6.36433080e-03 -5.70531517e-02]
 [ 1.22804927e-02 -2.81263365e-02 -1.17783386e-01]
 [ 1.67382640e+00 -3.22063359e+00  2.71635110e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.22336703e-01 -5.74615353e-02  6.54463702e-03]
 [-1.55476034e-01 -2.09543480e-01 -2.59357614e-02]
 [-2.62003116e-01 -1.70625906e+00 -1.97925022e-01]
 [-8.87757788e-03  3.95524437e-02  1.77504389e-01]
 [ 2.56574971e-01 -1.08956498e-01  4.12372864e-01]
 [ 5.27198134e-02 -6.34931952e-02  2.23673290e-02]
 [ 1.30298327e-01 -5.24307330e-02 -1.04767987e-02]
 [ 3.72995528e-02  9.38387353e-02  6.23455147e-02]
 [-1.65708656e-01  2.29561362e-02  4.85178093e-02]
 [-1.17723145e-02 -1.46133296e-01  4.81470543e-02]
 [ 8.32383881e-03 -2.62222811e-02  2.19623179e-01]
 [ 1.07203492e-01 -1.12529012e-01  4.84189404e-02]
 [ 1.88383035e-02 -1.34801738e-01 -4.81231066e-02]
 [ 4.55228141e-02 -3.72491461e-02  3.46459631e-02]
 [-8.14468112e-02  9.83984501e-02  1.18739653e-03]
 [ 5.86598437e-02 -1.54599294e-02 -8.15991648e-02]
 [-5.59729932e-02  2.21719947e-02 -4.42702510e-02]
 [-8.85541972e-02 -3.75767853e-02  3.73833011e-02]
 [ 1.65865071e-01  3.36367301e-03  3.12906871e-02]
 [-8.62268671e-02 -4.08851001e-02  6.95915129e-02]
 [-1.16390487e-01 -6.56235427e-02 -8.17994330e-02]
 [ 2.57019935e+00  1.64611683e+00  1.78479674e-01]
 [-3.25375234e-03 -1.77356007e-01 -6.62534889e-02]
 [ 3.33409953e-02 -1.35649309e-02 -7.40767696e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.29863234]
curr_Stock_Price:  99.71218350393872
curr_Factors:  [99.7121835  -0.85906725 -0.97643458]
mat_Sqrt:  [[15.90742589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.48999572e-04 -2.49603102e-02  5.62454763e-01]
Stock Position:  -0.00014899957225133164
Bond Position:  [0.31348942]


portfolio before change:  [0.29876989]
curr_Stock_Price:  99.05208553856194
curr_Factors:  [99.05208554 -0.9728005  -0.95935553]
mat_Sqrt:  [[14.34626743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04788623 0.064121   0.47638141]
Stock Position:  0.047886231989165445
Bond Position:  [-4.44446126]


portfolio before change:  [0.34601597]
curr_Stock_Price:  100.05031978256108
curr_Factors:  [100.05031978  -0.95578899  -0.94968185]
mat_Sqrt:  [[14.88274396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01811428 -0.04581937  0.10565176]
Stock Position:  -0.01811427742323259
Bond Position:  [2.15835522]


portfolio before change:  [0.35886149]
curr_Stock_Price:  99.35607698038467
curr_Factors:  [99.35607698 -0.71752169 -0.92540415]
mat_Sqrt:  [[19.21678847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03843055 0.4228013  3.67029665]
Stock Position:  0.03843055004747565
Bond Position:  [-3.4594472]


portfolio before change:  [0.33639451]
curr_Stock_Price:  98.78271755908938
curr_Factors:  [98.78271756 -0.87563107 -0.92233965]
mat_Sqrt:  [[16.36184259  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00358432 -0.01106097 -0.05874131]
Stock Position:  -0.0035843151912691245
Bond Position:  [0.69046291]


portfolio before change:  [0.33178374]
curr_Stock_Price:  100.09317271986973
curr_Factors:  [100.09317272  -0.76163977  -0.93088493]
mat_Sqrt:  [[18.42257437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00156057 0.00961305 0.02222029]
Stock Position:  0.0015605719053733108
Bond Position:  [0.17558115]


portfolio before change:  [0.33519121]
curr_Stock_Price:  102.26258264968351
curr_Factors:  [102.26258265  -0.89446041  -0.90373927]
mat_Sqrt:  [[16.93435099  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033405  -0.03746663 -0.00305254]
Stock Position:  -0.0033405003369100746
Bond Position:  [0.6767994]


portfolio before change:  [0.33488242]
curr_Stock_Price:  102.38034929327141
curr_Factors:  [102.38034929  -0.92468148  -0.88606509]
mat_Sqrt:  [[16.74246352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00726162  0.03278251 -0.29275596]
Stock Position:  0.007261619619569056
Bond Position:  [-0.40856474]


portfolio before change:  [0.34121856]
curr_Stock_Price:  103.25993523121204
curr_Factors:  [103.25993523  -1.25099316  -0.86685318]
mat_Sqrt:  [[12.42118033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120665  0.02232298 -0.13465567]
Stock Position:  0.0012066520132625442
Bond Position:  [0.21661975]


portfolio before change:  [0.34125789]
curr_Stock_Price:  103.2700870225442
curr_Factors:  [103.27008702  -1.07468848  -0.85767653]
mat_Sqrt:  [[14.95405866  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03282502 -0.00278529 -0.527781  ]
Stock Position:  -0.03282501686197426
Bond Position:  [3.73110024]


portfolio before change:  [0.31602878]
curr_Stock_Price:  104.05289016145099
curr_Factors:  [104.05289016  -1.05996931  -0.86344044]
mat_Sqrt:  [[15.20295147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03928276  0.28608621 -0.43268551]
Stock Position:  0.039282762347865874
Bond Position:  [-3.77145617]


portfolio before change:  [0.30103007]
curr_Stock_Price:  103.68307790121668
curr_Factors:  [103.6830779   -1.22055449  -0.87787521]
mat_Sqrt:  [[12.71661256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083439  0.00205408 -0.16275676]
Stock Position:  -0.0008343907058198798
Bond Position:  [0.38754227]


portfolio before change:  [0.30066999]
curr_Stock_Price:  104.17268671398365
curr_Factors:  [104.17268671  -1.24906988  -0.88071928]
mat_Sqrt:  [[12.38221054  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141358 -0.00907774 -0.33600322]
Stock Position:  -0.001413576731869789
Bond Position:  [0.44792608]


portfolio before change:  [0.30175822]
curr_Stock_Price:  103.44246241776841
curr_Factors:  [103.44246242  -1.40601015  -0.88133649]
mat_Sqrt:  [[10.50308374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.14956466 -1.03945502  7.74899359]
Stock Position:  0.14956466209611624
Bond Position:  [-15.16957872]


portfolio before change:  [0.19670527]
curr_Stock_Price:  102.75274982273288
curr_Factors:  [102.75274982  -1.21919658  -0.87194042]
mat_Sqrt:  [[12.69475119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170696 -0.03053791  0.10625201]
Stock Position:  -0.001706955304435977
Bond Position:  [0.37209962]


portfolio before change:  [0.19780392]
curr_Stock_Price:  102.13636556760169
curr_Factors:  [102.13636557  -1.01729245  -0.87053613]
mat_Sqrt:  [[15.46346684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00723921 -0.01854563  0.01867003]
Stock Position:  0.007239213306443219
Bond Position:  [-0.54158301]


portfolio before change:  [0.2038672]
curr_Stock_Price:  102.98327825255858
curr_Factors:  [102.98327825  -1.13152437  -0.87742613]
mat_Sqrt:  [[13.81308224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01473553 -0.06762987 -0.07398751]
Stock Position:  -0.014735526029192208
Bond Position:  [1.72137998]


portfolio before change:  [0.21602036]
curr_Stock_Price:  102.17312930244294
curr_Factors:  [102.1731293   -1.29936468  -0.88851139]
mat_Sqrt:  [[11.45919714  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05678348 -0.55069274 -0.56462499]
Stock Position:  -0.05678347768116769
Bond Position:  [6.01776597]


portfolio before change:  [0.20466811]
curr_Stock_Price:  102.38629903982687
curr_Factors:  [102.38629904  -1.35354129  -0.87626809]
mat_Sqrt:  [[11.01153685  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00321744 0.0127655  0.50637061]
Stock Position:  0.0032174403157614047
Bond Position:  [-0.1247537]


portfolio before change:  [0.20318012]
curr_Stock_Price:  101.9286701019915
curr_Factors:  [101.9286701   -1.26041549  -0.85426706]
mat_Sqrt:  [[12.29989477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02589531 -0.03516556  1.176385  ]
Stock Position:  0.025895309166959965
Bond Position:  [-2.43629431]


portfolio before change:  [0.19631138]
curr_Stock_Price:  101.67518083036842
curr_Factors:  [101.67518083  -1.00185208  -0.86230074]
mat_Sqrt:  [[15.76244812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00281207 -0.02049234  0.06380776]
Stock Position:  0.0028120651568804655
Bond Position:  [-0.08960585]


portfolio before change:  [0.19545892]
curr_Stock_Price:  101.37602112103248
curr_Factors:  [101.37602112  -1.19417174  -0.84849615]
mat_Sqrt:  [[13.14667252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00893438 -0.01692195 -0.02988739]
Stock Position:  0.008934380951417652
Bond Position:  [-0.71027307]


portfolio before change:  [0.1870529]
curr_Stock_Price:  100.44509719538733
curr_Factors:  [100.4450972   -0.89539369  -0.86784799]
mat_Sqrt:  [[17.22513413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00401625 0.03028632 0.1778544 ]
Stock Position:  0.004016254897630287
Bond Position:  [-0.21636021]


portfolio before change:  [0.19106301]
curr_Stock_Price:  101.45030021057386
curr_Factors:  [101.45030021  -1.00745865  -0.87892216]
mat_Sqrt:  [[15.38184956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00982451  0.00740906  0.13840781]
Stock Position:  -0.009824507588655157
Bond Position:  [1.18776225]


portfolio before change:  [0.18983285]
curr_Stock_Price:  101.59062704664782
curr_Factors:  [101.59062705  -0.97242277  -0.9030833 ]
mat_Sqrt:  [[15.57154504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0020405  -0.04716432  0.13735014]
Stock Position:  -0.0020404958052548973
Bond Position:  [0.3971281]


portfolio before change:  [0.19298284]
curr_Stock_Price:  100.07121964974787
curr_Factors:  [100.07121965  -1.13483148  -0.90520787]
mat_Sqrt:  [[13.01161974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00367376 -0.0084632   0.6265238 ]
Stock Position:  0.0036737648893878892
Bond Position:  [-0.1746553]


portfolio before change:  [0.18868231]
curr_Stock_Price:  98.90655847474147
curr_Factors:  [98.90655847 -1.00765546 -0.88431416]
mat_Sqrt:  [[14.91259163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00631125 -0.03631858  0.13812576]
Stock Position:  0.0063112489861680806
Bond Position:  [-0.43554161]


portfolio before change:  [0.1839646]
curr_Stock_Price:  98.16767765165058
curr_Factors:  [98.16767765 -1.32839225 -0.89752019]
mat_Sqrt:  [[10.59905209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174554 -0.04350707 -0.13728183]
Stock Position:  -0.0017455404504654048
Bond Position:  [0.35532026]


portfolio before change:  [0.18357343]
curr_Stock_Price:  98.41722452663875
curr_Factors:  [98.41722453 -1.2963311  -0.91446648]
mat_Sqrt:  [[10.78782571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00417058 -0.01202211  0.09883529]
Stock Position:  0.004170575500524561
Bond Position:  [-0.22688304]


portfolio before change:  [0.1802051]
curr_Stock_Price:  97.6163830421207
curr_Factors:  [97.61638304 -1.22479112 -0.87508467]
mat_Sqrt:  [[11.95523846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00511231  0.03175796  0.00338731]
Stock Position:  -0.005112314203511737
Bond Position:  [0.67925072]


portfolio before change:  [0.1796953]
curr_Stock_Price:  97.73271157065666
curr_Factors:  [97.73271157 -1.19037588 -0.86942515]
mat_Sqrt:  [[12.45890085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00311807 -0.00498967 -0.2327797 ]
Stock Position:  0.0031180711271980572
Bond Position:  [-0.12504225]


portfolio before change:  [0.18468107]
curr_Stock_Price:  99.33671593057062
curr_Factors:  [99.33671593 -1.53052234 -0.86257249]
mat_Sqrt:  [[ 9.07406567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00666557  0.00715598 -0.1262907 ]
Stock Position:  -0.0066655657049260065
Bond Position:  [0.84681647]


portfolio before change:  [0.18126946]
curr_Stock_Price:  99.86442365845554
curr_Factors:  [99.86442366 -1.48387657 -0.86645016]
mat_Sqrt:  [[ 9.52087516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0093052  -0.01212786  0.10664415]
Stock Position:  -0.009305204672932419
Bond Position:  [1.11052836]


portfolio before change:  [0.18296605]
curr_Stock_Price:  99.69701564431412
curr_Factors:  [99.69701564 -1.59964348 -0.86310419]
mat_Sqrt:  [[ 8.49423818  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02035955 0.00108562 0.08926362]
Stock Position:  0.020359549511738274
Bond Position:  [-1.84682028]


portfolio before change:  [0.20021397]
curr_Stock_Price:  100.55552129226704
curr_Factors:  [100.55552129  -1.52977901  -0.85776035]
mat_Sqrt:  [[ 9.23657051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00870098 -0.01319561  0.19852522]
Stock Position:  -0.008700977825637153
Bond Position:  [1.07514533]


portfolio before change:  [0.20186893]
curr_Stock_Price:  100.38076410625885
curr_Factors:  [100.38076411  -1.62502772  -0.84114722]
mat_Sqrt:  [[ 8.52323238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01718633 -0.02117991 -0.23335101]
Stock Position:  -0.017186328976716413
Bond Position:  [1.92704576]


portfolio before change:  [0.19583602]
curr_Stock_Price:  100.74581043655553
curr_Factors:  [100.74581044  -1.50846489  -0.87187867]
mat_Sqrt:  [[ 9.32088016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.31570447 0.53128192 0.50915283]
Stock Position:  0.315704471942352
Bond Position:  [-31.61006687]


portfolio before change:  [0.2587504]
curr_Stock_Price:  100.95760942912938
curr_Factors:  [100.95760943  -1.56951824  -0.87056713]
mat_Sqrt:  [[ 8.79880001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00602131 -0.0572414  -0.18900276]
Stock Position:  -0.006021313398465139
Bond Position:  [0.86664781]


portfolio before change:  [0.26254664]
curr_Stock_Price:  100.345135630407
curr_Factors:  [100.34513563  -1.53182683  -0.84659482]
mat_Sqrt:  [[ 9.30166994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166112 -0.00437806 -0.2113204 ]
Stock Position:  0.0016611219485203966
Bond Position:  [0.09586113]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.26132595]
Stock Price:  99.60306486846467
PL:  [0.26132595]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-5.24319186e-03 -1.10831901e-01  6.99065679e-02]
 [ 3.50123761e-01  2.15585870e-01  9.96099863e-02]
 [-4.38513830e-01 -3.17172531e-01  4.25874461e-02]
 [ 2.55927666e-01  1.91584735e+00  1.63902823e+00]
 [-4.75884878e-02 -3.35214043e-02 -1.94425581e-02]
 [-6.08256713e-03  1.68950710e-01 -6.18114791e-02]
 [-8.63030294e-02  9.50442813e-02 -3.42283660e-03]
 [-6.21236470e-02  1.27047124e-01  1.41626790e-04]
 [ 3.90661346e-02  3.82573828e-02 -4.25068343e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 9.65546665e-01  1.86014166e+00 -3.34513877e-01]
 [-9.54117207e-04  1.83616701e-02  7.72757169e-02]
 [-2.83151669e-01  1.61211553e-03 -6.01617371e-01]
 [ 1.69866104e+00 -3.14667486e+00  2.64279122e+00]
 [ 7.82249805e-03 -9.16208566e-02  3.54021289e-02]
 [ 1.35857780e-01 -3.27845338e-02 -1.37557617e-02]
 [-5.61448520e-02  1.54281424e-03 -6.66680063e-02]
 [-2.78550451e-01 -1.80302010e+00 -1.98838046e-01]
 [ 2.62613405e-03  3.55118178e-02  5.00695552e-02]
 [ 6.16209167e-02  1.90980429e-02  1.69445419e-01]
 [ 2.67962892e-02 -7.60029223e-03  1.82945223e-02]
 [ 1.13163339e-01 -5.14071003e-02  4.00634662e-02]
 [ 1.54330677e-01 -2.63002865e-02 -9.09121307e-03]
 [-1.40825287e-01  4.84058477e-03  5.58480916e-02]
 [ 1.02567770e-01 -2.93448041e-03 -3.32924682e-02]
 [ 5.25853934e-02 -4.11879939e-02  2.95996435e-01]
 [-1.97105640e-01 -1.30923768e-01 -7.33347642e-02]
 [-1.28733036e-01  9.26801332e-02  1.94864579e-01]
 [ 3.20518923e-02 -2.30797488e-02  8.84305203e-02]
 [-1.92866641e-02  7.78230775e-02  2.55374107e-02]
 [-1.68193249e-02 -1.62108450e-02 -6.67820923e-02]
 [-1.68114802e-02  2.14617092e-02 -5.47230052e-02]
 [-1.17528206e-01 -3.87200329e-02  2.15527745e-02]
 [ 2.00101123e-01  6.97727433e-03  3.43045095e-02]
 [ 1.94385106e-02  3.83105411e-02 -3.02324587e-02]
 [-1.10080844e-01 -5.09208682e-02 -9.53271055e-02]
 [ 2.04451946e+00  1.32514395e+00  1.59564229e-01]
 [-2.29252364e-02 -7.57585262e-02 -3.42072637e-02]
 [ 3.29881816e-02 -1.41681080e-02 -6.90498540e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.33831754]
curr_Stock_Price:  99.35234110487315
curr_Factors:  [99.3523411  -1.0108818  -0.99048169]
mat_Sqrt:  [[13.42755637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101262 -0.03577084  0.19942398]
Stock Position:  -0.0010126221186236547
Bond Position:  [-2.23771116]


portfolio before change:  [-2.33765031]
curr_Stock_Price:  98.4171828842361
curr_Factors:  [98.41718288 -1.11348108 -1.00535156]
mat_Sqrt:  [[11.82697301  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03504387 0.06958004 0.28415956]
Stock Position:  0.03504386500985053
Bond Position:  [-5.78656878]


portfolio before change:  [-2.34081369]
curr_Stock_Price:  98.3475554922671
curr_Factors:  [98.34755549 -1.05992851 -1.01137256]
mat_Sqrt:  [[12.39392733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03990368 -0.10236699  0.12149013]
Stock Position:  -0.03990367721687677
Bond Position:  [1.58361542]


portfolio before change:  [-2.33029881]
curr_Stock_Price:  98.08900998629066
curr_Factors:  [98.08900999 -1.30113348 -1.02680272]
mat_Sqrt:  [[ 9.56336002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10263794 0.61833707 4.67569133]
Stock Position:  0.10263794365101965
Bond Position:  [-12.39795309]


portfolio before change:  [-2.2804405]
curr_Stock_Price:  98.58987889552725
curr_Factors:  [98.5898789  -1.28588301 -1.0513254 ]
mat_Sqrt:  [[ 9.52347871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00613218 -0.01081899 -0.05546421]
Stock Position:  -0.00613218269700542
Bond Position:  [-1.67586935]


portfolio before change:  [-2.28259064]
curr_Stock_Price:  98.90634882977666
curr_Factors:  [98.90634883 -1.01577393 -1.02522487]
mat_Sqrt:  [[12.84782626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122878  0.05452861 -0.17633095]
Stock Position:  0.0012287788229410625
Bond Position:  [-2.40412467]


portfolio before change:  [-2.28297698]
curr_Stock_Price:  98.83651867846433
curr_Factors:  [98.83651868 -0.89840161 -1.02981838]
mat_Sqrt:  [[14.37150136  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00470381  0.03067541 -0.0097644 ]
Stock Position:  -0.004703814767865367
Bond Position:  [-1.81806831]


portfolio before change:  [-2.2868633]
curr_Stock_Price:  99.61440774317664
curr_Factors:  [99.61440774 -0.7880203  -1.03287683]
mat_Sqrt:  [[16.12562588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224248  0.04100428  0.00040402]
Stock Position:  -0.002242477420019223
Bond Position:  [-2.06348024]


portfolio before change:  [-2.28679336]
curr_Stock_Price:  99.46818863843802
curr_Factors:  [99.46818864 -0.7131687  -1.03403289]
mat_Sqrt:  [[17.33341746  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00220376  0.01234752 -0.12126017]
Stock Position:  0.002203761549484579
Bond Position:  [-2.50599753]


portfolio before change:  [-2.28943166]
curr_Stock_Price:  98.41316227053619
curr_Factors:  [98.41316227 -0.60185603 -1.02646319]
mat_Sqrt:  [[19.31448508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.52545974e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  4.525459744727531e-05
Bond Position:  [-2.2938853]


portfolio before change:  [-2.28965228]
curr_Stock_Price:  99.87435753553916
curr_Factors:  [99.87435754 -0.60223711 -1.03234405]
mat_Sqrt:  [[19.47889976  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06555628  0.60035814 -0.95427498]
Stock Position:  0.06555627620236518
Bond Position:  [-8.83704325]


portfolio before change:  [-2.3556693]
curr_Stock_Price:  98.88418058306075
curr_Factors:  [98.88418058 -0.63947234 -1.03169793]
mat_Sqrt:  [[18.59288532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00099865 0.0059262  0.22044611]
Stock Position:  0.000998649878828389
Bond Position:  [-2.45441997]


portfolio before change:  [-2.35490983]
curr_Stock_Price:  99.95190884278166
curr_Factors:  [99.95190884 -0.74747915 -1.01225982]
mat_Sqrt:  [[17.20070192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.35820161e-02  5.20308050e-04 -1.71624690e+00]
Stock Position:  -0.023582016060237118
Bond Position:  [0.00215769]


portfolio before change:  [-2.37456309]
curr_Stock_Price:  100.78532044910087
curr_Factors:  [100.78532045  -0.7945209   -1.02357572]
mat_Sqrt:  [[16.36092875  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09753763 -1.01558494  7.53914774]
Stock Position:  0.0975376304238358
Bond Position:  [-12.20492443]


portfolio before change:  [-2.41697297]
curr_Stock_Price:  100.36615736323515
curr_Factors:  [100.36615736  -0.9349843   -1.03699018]
mat_Sqrt:  [[13.96913966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026151 -0.0295705   0.10099242]
Stock Position:  -0.0002615122883269723
Bond Position:  [-2.39072599]


portfolio before change:  [-2.41750469]
curr_Stock_Price:  101.25657291775379
curr_Factors:  [101.25657292  -0.74926268  -1.05651441]
mat_Sqrt:  [[16.64118313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00759308 -0.01058116 -0.03924136]
Stock Position:  0.0075930768414628645
Bond Position:  [-3.18635363]


portfolio before change:  [-2.42717357]
curr_Stock_Price:  100.0356498623518
curr_Factors:  [100.03564986  -0.87520794  -1.03378895]
mat_Sqrt:  [[14.82818449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468287  0.00049794 -0.19018527]
Stock Position:  -0.004682871072266136
Bond Position:  [-1.95871952]


portfolio before change:  [-2.42619182]
curr_Stock_Price:  99.7737150642668
curr_Factors:  [99.77371506 -0.88568791 -1.04721255]
mat_Sqrt:  [[14.44003155  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0475884  -0.58192223 -0.5672296 ]
Stock Position:  -0.047588402528943564
Bond Position:  [2.3218799]


portfolio before change:  [-2.47554108]
curr_Stock_Price:  100.81681625419881
curr_Factors:  [100.81681625  -0.52298686  -1.07246643]
mat_Sqrt:  [[20.44732116  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00098279 0.01146139 0.1428345 ]
Stock Position:  0.0009827868646548126
Bond Position:  [-2.57462253]


portfolio before change:  [-2.47761659]
curr_Stock_Price:  99.03244209395548
curr_Factors:  [99.03244209 -0.17957947 -1.07467634]
mat_Sqrt:  [[28.25277519  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00354327 0.00616387 0.48338062]
Stock Position:  0.0035432692590007075
Bond Position:  [-2.8285152]


portfolio before change:  [-2.48186153]
curr_Stock_Price:  97.93420531046155
curr_Factors:  [97.93420531 -0.19691562 -1.07850143]
mat_Sqrt:  [[27.35443937  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0010594  -0.00245298  0.05218918]
Stock Position:  0.001059398050907042
Bond Position:  [-2.58561283]


portfolio before change:  [-2.48263554]
curr_Stock_Price:  97.50868954071179
curr_Factors:  [97.50868954 -0.35050165 -1.05649838]
mat_Sqrt:  [[23.87761629  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00464233 -0.01659157  0.11428992]
Stock Position:  0.004642332296942424
Bond Position:  [-2.93530328]


portfolio before change:  [-2.48472642]
curr_Stock_Price:  97.13733626879976
curr_Factors:  [97.13733627 -0.37667992 -1.03326326]
mat_Sqrt:  [[23.71677567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00620263 -0.00848838 -0.0259347 ]
Stock Position:  0.006202631383544448
Bond Position:  [-3.08723351]


portfolio before change:  [-2.48855678]
curr_Stock_Price:  96.58201796518603
curr_Factors:  [ 9.65820180e+01 -6.06526784e-03 -1.05645747e+00]
mat_Sqrt:  [[33.37709328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00384807  0.00156229  0.15931906]
Stock Position:  -0.0038480661578379
Bond Position:  [-2.11690279]


portfolio before change:  [-2.48353194]
curr_Stock_Price:  95.20743982826451
curr_Factors:  [95.20743983 -0.1787988  -1.07094813]
mat_Sqrt:  [[27.28429198  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0034882  -0.0009471  -0.09497414]
Stock Position:  0.0034881966167144246
Bond Position:  [-2.81563421]


portfolio before change:  [-2.47840758]
curr_Stock_Price:  96.77740321676998
curr_Factors:  [96.77740322 -0.37194028 -1.04022723]
mat_Sqrt:  [[23.5763956   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00443655 -0.01329337  0.84439544]
Stock Position:  0.004436553847249879
Bond Position:  [-2.90776574]


portfolio before change:  [-2.47726055]
curr_Stock_Price:  97.11787584261354
curr_Factors:  [97.11787584 -0.62623878 -1.0499507 ]
mat_Sqrt:  [[18.16934762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.013143   -0.04225546 -0.20920367]
Stock Position:  -0.013143000113526612
Bond Position:  [-1.2008403]


portfolio before change:  [-2.49683858]
curr_Stock_Price:  98.59607075675723
curr_Factors:  [98.59607076 -0.45312331 -1.03270173]
mat_Sqrt:  [[22.31382339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313878  0.02991238  0.5558944 ]
Stock Position:  -0.0031387815732876433
Bond Position:  [-2.18736705]


portfolio before change:  [-2.49611774]
curr_Stock_Price:  98.27929776520065
curr_Factors:  [98.27929777 -0.31875584 -1.03773097]
mat_Sqrt:  [[25.31321512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017932  -0.00744896  0.25226766]
Stock Position:  0.0017931962580666
Bond Position:  [-2.6723518]


portfolio before change:  [-2.49396606]
curr_Stock_Price:  99.665506811629
curr_Factors:  [99.66550681 -0.52060013 -1.04136779]
mat_Sqrt:  [[20.9021439   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [8.66756620e-05 2.51172902e-02 7.28511246e-02]
Stock Position:  8.667566199305755e-05
Bond Position:  [-2.50260463]


portfolio before change:  [-2.49419647]
curr_Stock_Price:  100.61648046093356
curr_Factors:  [100.61648046  -0.47096395  -1.05375978]
mat_Sqrt:  [[21.90231492  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0015414  -0.00523203 -0.19051072]
Stock Position:  -0.0015413981301888886
Bond Position:  [-2.33910642]


portfolio before change:  [-2.49653168]
curr_Stock_Price:  101.9417725230488
curr_Factors:  [101.94177252  -0.70366824  -1.05395482]
mat_Sqrt:  [[17.58029617  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134246  0.00692674 -0.1561095 ]
Stock Position:  -0.0013424639471583148
Bond Position:  [-2.35967853]


portfolio before change:  [-2.49628495]
curr_Stock_Price:  101.53825069489129
curr_Factors:  [101.53825069  -0.71590649  -1.03928212]
mat_Sqrt:  [[17.55338789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00689511 -0.01249684  0.06148407]
Stock Position:  -0.006895105280636784
Bond Position:  [-1.79616802]


portfolio before change:  [-2.49131737]
curr_Stock_Price:  100.78523675400496
curr_Factors:  [100.78523675  -0.58626423  -1.02572865]
mat_Sqrt:  [[20.10561256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01037162 0.00225191 0.09786122]
Stock Position:  0.010371617953122182
Bond Position:  [-3.53662334]


portfolio before change:  [-2.47227594]
curr_Stock_Price:  102.66378014732263
curr_Factors:  [102.66378015  -0.55843561  -1.00258076]
mat_Sqrt:  [[21.55144815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00097847  0.01236467 -0.08624479]
Stock Position:  0.0009784698504878154
Bond Position:  [-2.57272936]


portfolio before change:  [-2.47395199]
curr_Stock_Price:  101.27954456131097
curr_Factors:  [101.27954456  -0.47132077  -1.00941874]
mat_Sqrt:  [[23.03799832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00607403 -0.01643464 -0.2719417 ]
Stock Position:  -0.0060740340687308264
Bond Position:  [-1.85877658]


portfolio before change:  [-2.46510381]
curr_Stock_Price:  99.78456810907771
curr_Factors:  [99.78456811 -0.26142028 -0.97971235]
mat_Sqrt:  [[28.84339178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08139071 0.42768837 0.45519233]
Stock Position:  0.08139071395885179
Bond Position:  [-10.58664105]


portfolio before change:  [-2.44482835]
curr_Stock_Price:  100.04994086066301
curr_Factors:  [100.04994086  -0.54638688  -0.98632012]
mat_Sqrt:  [[21.60581457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209999 -0.02445096 -0.0975838 ]
Stock Position:  -0.0020999860536781343
Bond Position:  [-2.23472487]


portfolio before change:  [-2.4422406]
curr_Stock_Price:  98.6846422309308
curr_Factors:  [98.68464223 -0.78644844 -0.98232285]
mat_Sqrt:  [[16.82991645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00095077 -0.00457274 -0.19698001]
Stock Position:  0.0009507703894297015
Bond Position:  [-2.53606703]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.4411507]
Stock Price:  100.16441922998483
PL:  [-2.60556993]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.95460494e-03 -1.05011693e-01  4.44218226e-02]
 [ 8.26665736e-01  2.07255399e-01  2.33858847e-01]
 [-2.83278336e-01 -1.74281464e-01  3.80594481e-02]
 [ 1.44666231e-01  1.21907891e+00  9.44502714e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.35000609e-02 -6.59436167e-02  5.19152265e-02]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [ 5.27639286e-02  9.97533086e-02 -1.84906567e-02]
 [-1.28099527e-02  9.43956930e-02 -5.10356791e-02]
 [-1.37270026e-01 -7.26450966e-02 -4.12567951e-02]
 [ 7.33286551e-01  1.45869862e+00 -2.43789050e-01]
 [-6.77237550e-05  3.13508100e-02 -4.69809348e-02]
 [-3.99056607e-01 -8.11632229e-03 -8.52055738e-01]
 [ 1.97553514e+00 -3.50210487e+00  2.95650700e+00]
 [ 3.13305986e-02 -9.42996887e-02  2.84351876e-02]
 [ 1.17103135e-01  2.33687438e-02 -3.95989466e-02]
 [-7.21395484e-02 -3.20754347e-02 -6.00107453e-02]
 [-2.80720757e-01 -1.81880510e+00 -2.00075470e-01]
 [ 1.41937788e-02  7.26785427e-03  1.14262074e-02]
 [ 8.20677691e-02  2.37217268e-02  2.03701797e-01]
 [ 4.83083895e-02  5.98128996e-03  5.80445458e-02]
 [ 1.21218620e-01 -5.14095819e-02 -7.59536324e-03]
 [ 2.64007140e-01  1.05990140e-01  1.49401453e-01]
 [-7.75181082e-02 -4.12482098e-02  7.44974756e-02]
 [ 8.12389863e-03 -1.24760956e-01  3.45125055e-02]
 [ 5.27336136e-02 -6.24100480e-03  1.65685091e-01]
 [ 1.14072800e-01 -9.96536055e-02  4.81776215e-02]
 [-1.06225819e-01  7.15941594e-02  1.61382391e-01]
 [ 1.22422633e-02 -5.38571168e-02  3.33663192e-02]
 [-1.36680120e-02  5.83510391e-02  6.22123637e-02]
 [-2.07348300e-02 -3.71390644e-02 -5.06971907e-02]
 [-2.75152276e-02  2.19712976e-02 -5.19633758e-02]
 [-1.17158912e-01 -3.87031191e-02  2.17594280e-02]
 [ 3.11899752e-01  3.82816946e-02  6.62778557e-02]
 [ 5.66878635e-02 -2.09002918e-02 -9.94986812e-03]
 [-9.47584759e-02 -2.91904575e-02 -1.05798739e-01]
 [ 1.80909690e+00  1.19960520e+00  1.54642994e-01]
 [-2.00212827e-02 -1.33792709e-01 -5.54761350e-02]
 [ 3.56739134e-02 -1.47952815e-02 -9.31066220e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.47903753]
curr_Stock_Price:  99.60606142947222
curr_Factors:  [99.60606143 -1.01051167 -0.97345118]
mat_Sqrt:  [[13.69814159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076019 -0.03389238  0.1267231 ]
Stock Position:  -0.0007601944007594969
Bond Position:  [-0.40331756]


portfolio before change:  [-0.47888023]
curr_Stock_Price:  99.33282726969611
curr_Factors:  [99.33282727 -1.20409619 -0.98617347]
mat_Sqrt:  [[11.11400966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08248219 0.06689139 0.6671342 ]
Stock Position:  0.08248218529560558
Bond Position:  [-8.6720689]


portfolio before change:  [-0.45663987]
curr_Stock_Price:  99.61560884011024
curr_Factors:  [99.61560884 -1.25191217 -0.96720142]
mat_Sqrt:  [[10.8287569   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02872763 -0.0562491   0.10857301]
Stock Position:  -0.028727631577550032
Bond Position:  [2.40508064]


portfolio before change:  [-0.48334713]
curr_Stock_Price:  100.55574608177895
curr_Factors:  [100.55574608  -1.28381115  -0.98420622]
mat_Sqrt:  [[10.40925062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05632543 0.39345603 2.69440334]
Stock Position:  0.056325426481136164
Bond Position:  [-6.14719241]


portfolio before change:  [-0.44187795]
curr_Stock_Price:  101.30563164790344
curr_Factors:  [101.30563165  -1.46704585  -0.99419952]
mat_Sqrt:  [[ 8.64426962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00678438 -0.01106097 -0.05874131]
Stock Position:  -0.006784378958228691
Bond Position:  [0.24541784]


portfolio before change:  [-0.44085056]
curr_Stock_Price:  101.15871910792801
curr_Factors:  [101.15871911  -1.47053462  -0.99987907]
mat_Sqrt:  [[ 8.55295699  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00708954 -0.02128321  0.14809969]
Stock Position:  0.007089539656242111
Bond Position:  [-1.15801931]


portfolio before change:  [-0.4437521]
curr_Stock_Price:  100.76986796976799
curr_Factors:  [100.76986797  -1.42841332  -1.0319759 ]
mat_Sqrt:  [[ 8.60591842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00770288 -0.00251018 -0.21167328]
Stock Position:  -0.007702876053338049
Bond Position:  [0.3324657]


portfolio before change:  [-0.44183609]
curr_Stock_Price:  100.52652347943176
curr_Factors:  [100.52652348  -1.50451041  -1.02476706]
mat_Sqrt:  [[ 8.01363234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0086542   0.03219524 -0.0527487 ]
Stock Position:  0.008654202608046408
Bond Position:  [-1.31181299]


portfolio before change:  [-0.4446452]
curr_Stock_Price:  100.22087664599111
curr_Factors:  [100.22087665  -1.58331338  -1.00675477]
mat_Sqrt:  [[ 7.51806183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052662  0.03046608 -0.14559059]
Stock Position:  -0.0005266153664363764
Bond Position:  [-0.39186735]


portfolio before change:  [-0.44418048]
curr_Stock_Price:  99.24538296643455
curr_Factors:  [99.24538297 -1.61566201 -1.03526045]
mat_Sqrt:  [[ 7.00534155  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02291397 -0.0234461  -0.11769415]
Stock Position:  -0.022913965244217863
Bond Position:  [1.82992478]


portfolio before change:  [-0.43569756]
curr_Stock_Price:  98.88515890273597
curr_Factors:  [98.8851589  -1.34965257 -1.01450271]
mat_Sqrt:  [[ 9.29804239  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10553608  0.47079296 -0.6954623 ]
Stock Position:  0.10553607813277935
Bond Position:  [-10.87164942]


portfolio before change:  [-0.43558362]
curr_Stock_Price:  98.89911603163267
curr_Factors:  [98.89911603 -1.53129116 -1.02259891]
mat_Sqrt:  [[ 7.69222616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042357  0.01011843 -0.13402353]
Stock Position:  -0.000423571740163105
Bond Position:  [-0.39369275]


portfolio before change:  [-0.43570347]
curr_Stock_Price:  99.06586681937213
curr_Factors:  [99.06586682 -1.54718326 -1.02751375]
mat_Sqrt:  [[ 7.54653066  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07614605 -0.00261953 -2.43067785]
Stock Position:  -0.07614604904772007
Bond Position:  [7.10777088]


portfolio before change:  [-0.44213954]
curr_Stock_Price:  99.16205825596221
curr_Factors:  [99.16205826 -1.53380835 -1.02137954]
mat_Sqrt:  [[ 7.70267423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.24201536 -1.13029948  8.43409153]
Stock Position:  0.24201535532161975
Bond Position:  [-24.4408803]


portfolio before change:  [-0.37190277]
curr_Stock_Price:  99.4648988577214
curr_Factors:  [99.46489886 -1.19654643 -1.02532181]
mat_Sqrt:  [[10.78263057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165878 -0.03043509  0.08111768]
Stock Position:  0.0016587847976328538
Bond Position:  [-0.53689363]


portfolio before change:  [-0.37141895]
curr_Stock_Price:  99.79703008360599
curr_Factors:  [99.79703008 -1.0596497  -1.07659119]
mat_Sqrt:  [[11.78582499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00965483  0.00754223 -0.11296477]
Stock Position:  0.00965483190504019
Bond Position:  [-1.3349425]


portfolio before change:  [-0.36505874]
curr_Stock_Price:  100.47307327789986
curr_Factors:  [100.47307328  -0.90470666  -1.07835764]
mat_Sqrt:  [[13.829797    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00657541 -0.0103523  -0.17119395]
Stock Position:  -0.00657540824304755
Bond Position:  [0.29559273]


portfolio before change:  [-0.35999091]
curr_Stock_Price:  99.70796782869269
curr_Factors:  [99.70796783 -0.58907482 -1.05995509]
mat_Sqrt:  [[19.16749133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03614573 -0.58701682 -0.57075962]
Stock Position:  -0.03614573317213109
Bond Position:  [3.24402669]


portfolio before change:  [-0.32918933]
curr_Stock_Price:  98.86703728995077
curr_Factors:  [98.86703729 -0.39709349 -1.06034696]
mat_Sqrt:  [[23.01935629  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00078237 0.00234569 0.03259579]
Stock Position:  0.0007823714937588281
Bond Position:  [-0.40654008]


portfolio before change:  [-0.32876511]
curr_Stock_Price:  99.47422411520013
curr_Factors:  [99.47422412 -0.27342821 -1.04431411]
mat_Sqrt:  [[26.63313813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00482446 0.00765615 0.58110453]
Stock Position:  0.004824455942064616
Bond Position:  [-0.80867412]


portfolio before change:  [-0.31788576]
curr_Stock_Price:  101.75021819830472
curr_Factors:  [101.7502182   -0.34943218  -1.05765782]
mat_Sqrt:  [[24.91402667  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00246358 0.00193045 0.16558493]
Stock Position:  0.002463576416337336
Bond Position:  [-0.5685552]


portfolio before change:  [-0.32015074]
curr_Stock_Price:  100.85968449329691
curr_Factors:  [100.85968449  -0.62137229  -1.07811889]
mat_Sqrt:  [[18.43478029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00592219 -0.01659237 -0.02166746]
Stock Position:  0.005922190802151626
Bond Position:  [-0.91746103]


portfolio before change:  [-0.32018275]
curr_Stock_Price:  100.87364464363455
curr_Factors:  [100.87364464  -0.6170837   -1.07075672]
mat_Sqrt:  [[18.65339697  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01694805 0.03420817 0.42620076]
Stock Position:  0.016948051376574808
Bond Position:  [-2.02979446]


portfolio before change:  [-0.34143807]
curr_Stock_Price:  99.63447091562705
curr_Factors:  [99.63447092 -0.43467622 -1.05185188]
mat_Sqrt:  [[22.53298192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003139   -0.0133128   0.21252056]
Stock Position:  -0.0031390044355133827
Bond Position:  [-0.02868502]


portfolio before change:  [-0.34338168]
curr_Stock_Price:  100.25250829383032
curr_Factors:  [100.25250829  -0.56655085  -1.05675536]
mat_Sqrt:  [[19.77435453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052077 -0.04026643  0.09845457]
Stock Position:  -0.000520774979725835
Bond Position:  [-0.29117268]


portfolio before change:  [-0.3437159]
curr_Stock_Price:  100.82438646890435
curr_Factors:  [100.82438647  -0.50474822  -1.06456634]
mat_Sqrt:  [[20.99041055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00406281 -0.00201428  0.47265345]
Stock Position:  0.004062807695205736
Bond Position:  [-0.75334599]


portfolio before change:  [-0.34648498]
curr_Stock_Price:  100.1659975757836
curr_Factors:  [100.16599758  -0.62181685  -1.04977974]
mat_Sqrt:  [[18.82587393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00550122 -0.03216306  0.13743734]
Stock Position:  0.005501221815700393
Bond Position:  [-0.89752035]


portfolio before change:  [-0.34966366]
curr_Stock_Price:  99.60857959120536
curr_Factors:  [99.60857959 -0.63343402 -1.05398304]
mat_Sqrt:  [[18.42726281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00318385  0.02310692  0.46037904]
Stock Position:  -0.003183852124905396
Bond Position:  [-0.03252467]


portfolio before change:  [-0.34956811]
curr_Stock_Price:  99.57729216722119
curr_Factors:  [99.57729217 -0.55875806 -1.06105513]
mat_Sqrt:  [[19.70989822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040891 -0.01738231  0.09518482]
Stock Position:  0.0004089111279268031
Bond Position:  [-0.39028637]


portfolio before change:  [-0.34917887]
curr_Stock_Price:  100.64849559731981
curr_Factors:  [100.6484956   -0.62230997  -1.08196459]
mat_Sqrt:  [[18.30839409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00059764 0.01883272 0.17747456]
Stock Position:  0.0005976433276502578
Bond Position:  [-0.40933077]


portfolio before change:  [-0.34841497]
curr_Stock_Price:  102.01229988307259
curr_Factors:  [102.01229988  -0.95328565  -1.12658699]
mat_Sqrt:  [[12.74604143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303344 -0.01198658 -0.14462497]
Stock Position:  -0.0030334383214052785
Bond Position:  [-0.03896695]


portfolio before change:  [-0.3455735]
curr_Stock_Price:  101.0739785904522
curr_Factors:  [101.07397859  -0.85984552  -1.12517169]
mat_Sqrt:  [[13.88536627  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0024225   0.00709121 -0.14823705]
Stock Position:  -0.002422502530671297
Bond Position:  [-0.10072153]


portfolio before change:  [-0.34687259]
curr_Stock_Price:  101.60504130706684
curr_Factors:  [101.60504131  -0.55001034  -1.1116085 ]
mat_Sqrt:  [[19.28782963  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00625356 -0.01249138  0.06207359]
Stock Position:  -0.006253556274301255
Bond Position:  [0.28852025]


portfolio before change:  [-0.35281411]
curr_Stock_Price:  102.56091135153191
curr_Factors:  [102.56091135  -0.58030042  -1.12923296]
mat_Sqrt:  [[18.55841827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01795643 0.01235536 0.18907227]
Stock Position:  0.01795642687586041
Bond Position:  [-2.19444162]


portfolio before change:  [-0.3453078]
curr_Stock_Price:  102.99421767422015
curr_Factors:  [102.99421767  -0.82169864  -1.1222559 ]
mat_Sqrt:  [[14.74226169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00341811 -0.00674554 -0.0283842 ]
Stock Position:  0.0034181051767222053
Bond Position:  [-0.69735287]


portfolio before change:  [-0.34567404]
curr_Stock_Price:  102.91257491269677
curr_Factors:  [102.91257491  -0.8670856   -1.11006015]
mat_Sqrt:  [[14.24967479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00858357 -0.00942118 -0.30181435]
Stock Position:  -0.00858356643582118
Bond Position:  [0.53768288]


portfolio before change:  [-0.33588998]
curr_Stock_Price:  101.78054563117952
curr_Factors:  [101.78054563  -1.09443496  -1.09637649]
mat_Sqrt:  [[11.38170825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.18323538 0.38717091 0.44115342]
Stock Position:  0.18323538174059334
Bond Position:  [-18.98568711]


portfolio before change:  [-0.30162311]
curr_Stock_Price:  101.98050825181879
curr_Factors:  [101.98050825  -1.23869125  -1.11960619]
mat_Sqrt:  [[ 9.6454303   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00608118 -0.04318141 -0.15825797]
Stock Position:  -0.006081182675681262
Bond Position:  [0.31853899]


portfolio before change:  [-0.30095452]
curr_Stock_Price:  101.87711168498187
curr_Factors:  [101.87711168  -1.66031034  -1.10414393]
mat_Sqrt:  [[ 6.41932536  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00212616 -0.00477516 -0.26560728]
Stock Position:  0.002126162615238783
Bond Position:  [-0.51756182]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.30131131]
Stock Price:  101.7397282743405
PL:  [-2.04103959]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.86954813e-02 -8.25930523e-02 -4.61246419e-03]
 [ 5.83358363e-01  1.96315959e-01  1.50688446e-01]
 [-3.31968071e-01 -2.19099360e-01  3.94796582e-02]
 [ 1.77805953e-01  1.20792758e+00  1.11260163e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 5.19375088e-02 -6.10183933e-02  4.74618802e-02]
 [-5.23038847e-02 -9.03072359e-05 -6.89089701e-02]
 [ 1.01905439e-01  1.16617530e-01 -7.94744324e-02]
 [ 2.44031496e-02  5.41251023e-02 -4.49175467e-02]
 [-1.11209173e-01 -5.64624376e-02 -2.32434366e-02]
 [ 9.71326018e-01  1.86169379e+00 -3.38897032e-01]
 [-1.20325495e-03 -2.84012732e-02  1.56154232e-01]
 [-2.57406664e-01  7.30971655e-03 -5.64721821e-01]
 [ 1.75372604e+00 -2.92964355e+00  2.47064948e+00]
 [ 1.59504197e-02 -9.02506882e-02  3.45593356e-02]
 [ 1.34526693e-01 -1.23646764e-02 -2.82405676e-02]
 [-8.80348054e-02 -6.82067438e-02 -5.63643349e-02]
 [-2.83475843e-01 -1.83590291e+00 -2.00584150e-01]
 [ 5.99637895e-03  3.02566376e-02  3.10494434e-02]
 [ 3.91838116e-02  4.80054918e-02  1.00129077e-01]
 [ 2.12566657e-02  5.48597627e-02 -2.71909214e-02]
 [ 6.26909110e-02 -4.34972300e-02  5.63015190e-03]
 [ 3.79443631e-01 -2.48764802e-04  9.87146028e-02]
 [-8.58233525e-02 -3.52018386e-02  7.20508701e-02]
 [ 3.98741078e-03 -1.73761325e-01  4.78834253e-02]
 [ 5.62137249e-02 -6.56558138e-03  1.69310539e-01]
 [-1.97199523e-01 -1.31021288e-01 -7.33502893e-02]
 [-1.34167067e-01  9.34932862e-02  2.03599221e-01]
 [ 1.67351600e-02 -4.95017079e-02  4.09083572e-02]
 [-6.53910798e-02  9.30354437e-02  7.65165349e-03]
 [-1.77917421e-02 -5.08628905e-02 -4.25055845e-02]
 [-4.23516027e-03  2.20621030e-02 -5.83354791e-02]
 [-1.18069121e-01 -3.87448071e-02  2.12500833e-02]
 [ 1.28741964e-01  6.44621804e-03  2.28928594e-02]
 [-2.47751300e-02  2.53658632e-02 -4.55381514e-03]
 [-1.09916252e-01 -4.96265878e-02 -9.72789404e-02]
 [ 2.34503867e+00  1.54021222e+00  1.76534205e-01]
 [-2.51476091e-02 -6.23643124e-02 -3.31296960e-02]
 [ 3.47264656e-02 -1.35264025e-02 -9.85851041e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.27316314]
curr_Stock_Price:  99.63415537701952
curr_Factors:  [99.63415538 -1.11130022 -0.99720235]
mat_Sqrt:  [[12.09754401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.39596227e-05 -2.66567930e-02 -1.31580765e-02]
Stock Position:  7.395962266059594e-05
Bond Position:  [-0.28053205]


portfolio before change:  [-0.27322421]
curr_Stock_Price:  99.28260961570739
curr_Factors:  [99.28260962 -0.72149697 -0.98188186]
mat_Sqrt:  [[18.07611774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03619087 0.0633607  0.42987219]
Stock Position:  0.03619086518146598
Bond Position:  [-3.86634775]


portfolio before change:  [-0.26704517]
curr_Stock_Price:  99.46669925108468
curr_Factors:  [99.46669925 -0.6232141  -0.96063931]
mat_Sqrt:  [[20.40886772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01806238 -0.07071401  0.11262448]
Stock Position:  -0.018062383163324935
Bond Position:  [1.52956046]


portfolio before change:  [-0.27501908]
curr_Stock_Price:  99.91874979324625
curr_Factors:  [99.91874979 -0.83429531 -0.96014458]
mat_Sqrt:  [[16.60854736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03922571 0.38985695 3.17394277]
Stock Position:  0.039225705959118194
Bond Position:  [-4.19440258]


portfolio before change:  [-0.26471704]
curr_Stock_Price:  100.19475178259542
curr_Factors:  [100.19475178  -0.76101472  -0.95459284]
mat_Sqrt:  [[18.02046847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325441 -0.01106097 -0.05874131]
Stock Position:  -0.0032544104523316545
Bond Position:  [0.06135781]


portfolio before change:  [-0.26715316]
curr_Stock_Price:  100.94566978451418
curr_Factors:  [100.94566978  -0.98887574  -0.94944416]
mat_Sqrt:  [[14.53068398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00338389 -0.0196936   0.13539553]
Stock Position:  0.003383894190517681
Bond Position:  [-0.60874263]


portfolio before change:  [-0.26954894]
curr_Stock_Price:  100.26016472019548
curr_Factors:  [100.26016472  -0.83389408  -0.95193309]
mat_Sqrt:  [[16.80945105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.94946289e-03 -2.91465351e-05 -1.96578111e-01]
Stock Position:  -0.0039494628928608425
Bond Position:  [0.12642486]


portfolio before change:  [-0.27649879]
curr_Stock_Price:  102.02386335529542
curr_Factors:  [102.02386336  -0.90210946  -0.96900512]
mat_Sqrt:  [[15.70677524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0069707   0.03763815 -0.22671843]
Stock Position:  0.006970701496711639
Bond Position:  [-0.98767669]


portfolio before change:  [-0.27805854]
curr_Stock_Price:  101.8178177374863
curr_Factors:  [101.81781774  -0.7500997   -0.99117931]
mat_Sqrt:  [[17.84826149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147256  0.0174688  -0.12813726]
Stock Position:  0.0014725598912003527
Bond Position:  [-0.42799138]


portfolio before change:  [-0.28015942]
curr_Stock_Price:  100.42747062896046
curr_Factors:  [100.42747063  -0.84104518  -0.99642601]
mat_Sqrt:  [[15.99001692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00797242 -0.01822317 -0.06630705]
Stock Position:  -0.007972415961958815
Bond Position:  [0.52049015]


portfolio before change:  [-0.27648255]
curr_Stock_Price:  99.97443342180021
curr_Factors:  [99.97443342 -0.60924163 -0.96279256]
mat_Sqrt:  [[20.75693271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06177048  0.60085909 -0.9667789 ]
Stock Position:  0.06177047554811151
Bond Position:  [-6.45195084]


portfolio before change:  [-0.39241398]
curr_Stock_Price:  98.11068087558851
curr_Factors:  [98.11068088 -0.48876595 -0.94526933]
mat_Sqrt:  [[23.38420884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00106372 -0.00916647  0.44546456]
Stock Position:  0.0010637182030206278
Bond Position:  [-0.49677609]


portfolio before change:  [-0.39050323]
curr_Stock_Price:  99.9653483715641
curr_Factors:  [99.96534837 -0.43079813 -0.96890214]
mat_Sqrt:  [[24.6585412   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01505312  0.0023592  -1.61099417]
Stock Position:  -0.015053118102799435
Bond Position:  [1.11428696]


portfolio before change:  [-0.38042311]
curr_Stock_Price:  99.3049650718602
curr_Factors:  [99.30496507 -0.3955943  -0.95705235]
mat_Sqrt:  [[25.67580036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06465365 -0.94553839  7.04807527]
Stock Position:  0.06465365238291522
Bond Position:  [-6.8008518]


portfolio before change:  [-0.41534165]
curr_Stock_Price:  98.77802832690531
curr_Factors:  [98.77802833 -0.47019268 -0.95107383]
mat_Sqrt:  [[23.8458137   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00019217 -0.02912828  0.09858817]
Stock Position:  0.00019217083616554435
Bond Position:  [-0.43432391]


portfolio before change:  [-0.4151121]
curr_Stock_Price:  100.2550771620336
curr_Factors:  [100.25507716  -0.41472757  -0.95794217]
mat_Sqrt:  [[25.40759065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00496852 -0.00399068 -0.08056248]
Stock Position:  0.004968522352351201
Bond Position:  [-0.91323169]


portfolio before change:  [-0.41260968]
curr_Stock_Price:  100.78170973979489
curr_Factors:  [100.78170974  -0.28338856  -0.98664592]
mat_Sqrt:  [[28.30171493  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00400904 -0.02201363 -0.16079176]
Stock Position:  -0.004009042229814903
Bond Position:  [-0.00857155]


portfolio before change:  [-0.4069508]
curr_Stock_Price:  99.369913016773
curr_Factors:  [99.36991302 -0.15997869 -0.99590046]
mat_Sqrt:  [[31.27972814  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02235224 -0.59253512 -0.57221075]
Stock Position:  -0.022352241079527477
Bond Position:  [1.81418945]


portfolio before change:  [-0.43679834]
curr_Stock_Price:  100.71538567321625
curr_Factors:  [100.71538567  -0.13449033  -0.983375  ]
mat_Sqrt:  [[32.93161859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00056209 0.00976529 0.08857542]
Stock Position:  0.0005620868674557839
Bond Position:  [-0.49340913]


portfolio before change:  [-0.43839605]
curr_Stock_Price:  97.98265709432543
curr_Factors:  [97.98265709 -0.13907025 -0.9453058 ]
mat_Sqrt:  [[33.12917942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00209548 0.01549371 0.28564039]
Stock Position:  0.0020954836500435246
Bond Position:  [-0.64371711]


portfolio before change:  [-0.44251174]
curr_Stock_Price:  96.05697953214059
curr_Factors:  [96.05697953 -0.28169586 -0.9519802 ]
mat_Sqrt:  [[27.97371998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00096178  0.01770591 -0.07756813]
Stock Position:  0.0009617792808026838
Bond Position:  [-0.53489736]


portfolio before change:  [-0.44174025]
curr_Stock_Price:  96.92865858498052
curr_Factors:  [ 9.69286586e+01 -6.38066226e-02 -9.35620184e-01]
mat_Sqrt:  [[35.67850557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00154046 -0.01403867  0.01606126]
Stock Position:  0.0015404604297148364
Bond Position:  [-0.59105501]


portfolio before change:  [-0.43862056]
curr_Stock_Price:  99.00179032459064
curr_Factors:  [99.00179032 -0.16649824 -0.95438489]
mat_Sqrt:  [[32.27376934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.23798024e-02 -8.02884946e-05  2.81605285e-01]
Stock Position:  0.012379802360051297
Bond Position:  [-1.66424316]


portfolio before change:  [-0.4321413]
curr_Stock_Price:  99.54196892553466
curr_Factors:  [ 9.95419689e+01 -1.09802504e-02 -9.25446634e-01]
mat_Sqrt:  [[39.02304889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200655 -0.01136134  0.20554108]
Stock Position:  -0.0020065468404196945
Bond Position:  [-0.23240567]


portfolio before change:  [-0.43339432]
curr_Stock_Price:  100.15195753007085
curr_Factors:  [ 1.00151958e+02 -6.98174428e-02 -9.38095960e-01]
mat_Sqrt:  [[36.55343654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00059385 -0.05608123  0.13659808]
Stock Position:  -0.0005938513547532918
Bond Position:  [-0.37391894]


portfolio before change:  [-0.43369127]
curr_Stock_Price:  100.57329561960898
curr_Factors:  [ 1.00573296e+02 -1.39341690e-02 -9.56626157e-01]
mat_Sqrt:  [[38.10427364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234708 -0.00211903  0.48299584]
Stock Position:  0.0023470831936973587
Bond Position:  [-0.66974517]


portfolio before change:  [-0.43810893]
curr_Stock_Price:  98.72677692391613
curr_Factors:  [ 9.87267769e+01  4.71090983e-02 -9.69763463e-01]
mat_Sqrt:  [[39.24020429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00608857 -0.04228694 -0.20924796]
Stock Position:  -0.006088569131593222
Bond Position:  [0.16299588]


portfolio before change:  [-0.44010744]
curr_Stock_Price:  99.05836273810877
curr_Factors:  [ 9.90583627e+01  3.25316413e-02 -9.55422149e-01]
mat_Sqrt:  [[39.36270096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186784  0.03017483  0.58081191]
Stock Position:  -0.0018678421729357343
Bond Position:  [-0.25508205]


portfolio before change:  [-0.44180019]
curr_Stock_Price:  99.9475519870333
curr_Factors:  [99.94755199  0.20755129 -0.96908021]
mat_Sqrt:  [[46.67070408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00032099 -0.01597661  0.11670016]
Stock Position:  0.0003209947200553608
Bond Position:  [-0.47388283]


portfolio before change:  [-0.44228104]
curr_Stock_Price:  98.6340983638224
curr_Factors:  [98.63409836  0.12354874 -0.94540085]
mat_Sqrt:  [[43.36119534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103407  0.03002706  0.02182804]
Stock Position:  -0.0010340677149402783
Bond Position:  [-0.34028671]


portfolio before change:  [-0.44652276]
curr_Stock_Price:  102.6949299770605
curr_Factors:  [102.69492998  -0.34740639  -0.94142149]
mat_Sqrt:  [[28.3020677   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00130204 -0.01641593 -0.1212566 ]
Stock Position:  -0.0013020427574728303
Bond Position:  [-0.31280957]


portfolio before change:  [-0.44594325]
curr_Stock_Price:  102.21982547097016
curr_Factors:  [102.21982547  -0.72892657  -0.91491012]
mat_Sqrt:  [[19.75267567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058926  0.00712051 -0.16641488]
Stock Position:  -0.0005892585062625297
Bond Position:  [-0.38570935]


portfolio before change:  [-0.44569215]
curr_Stock_Price:  101.7118745491663
curr_Factors:  [101.71187455  -0.84130622  -0.89705792]
mat_Sqrt:  [[17.8817372   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00680248 -0.01250483  0.06062057]
Stock Position:  -0.006802483165586083
Bond Position:  [0.24620116]


portfolio before change:  [-0.43907654]
curr_Stock_Price:  100.74386900449196
curr_Factors:  [100.743869    -0.49948027  -0.90707595]
mat_Sqrt:  [[24.68078809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00545893 0.00208051 0.06530696]
Stock Position:  0.0054589334073158685
Bond Position:  [-0.98903061]


portfolio before change:  [-0.43386854]
curr_Stock_Price:  101.72054869774195
curr_Factors:  [101.7205487   -0.65659883  -0.91176485]
mat_Sqrt:  [[21.19712688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096838  0.0081868  -0.01299077]
Stock Position:  -0.000968380694685245
Bond Position:  [-0.33536433]


portfolio before change:  [-0.43379566]
curr_Stock_Price:  101.60198969827472
curr_Factors:  [101.6019897   -0.77345337  -0.91614519]
mat_Sqrt:  [[18.75507836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00745948 -0.01601691 -0.27750974]
Stock Position:  -0.007459484538531505
Bond Position:  [0.32410282]


portfolio before change:  [-0.43684692]
curr_Stock_Price:  102.01646541903645
curr_Factors:  [102.01646542  -0.7187983   -0.94218994]
mat_Sqrt:  [[19.37814709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.13909834 0.49710136 0.50360295]
Stock Position:  0.13909833875284294
Bond Position:  [-14.62716778]


portfolio before change:  [-0.54139336]
curr_Stock_Price:  101.27800993944778
curr_Factors:  [101.27800994  -0.41794477  -0.9674655 ]
mat_Sqrt:  [[25.34189705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176152 -0.020128   -0.0945098 ]
Stock Position:  -0.0017615193454917875
Bond Position:  [-0.36299018]


portfolio before change:  [-0.54116108]
curr_Stock_Price:  101.12039091044684
curr_Factors:  [101.12039091  -0.23527382  -0.98222318]
mat_Sqrt:  [[29.92860767  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00039567 -0.00436563 -0.28123586]
Stock Position:  0.0003956682592367471
Bond Position:  [-0.58117121]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.54139376]
Stock Price:  100.71595051469467
PL:  [-1.25734427]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-3.20483301e-02 -6.36177102e-02  2.33536040e-01]
 [ 6.82471186e-01  1.93899575e-01  1.79738189e-01]
 [-4.65476328e-01 -3.41990954e-01  4.33739038e-02]
 [ 2.57444029e-01  1.81819473e+00  1.62855486e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-6.69941816e-03  1.70416886e-01 -6.20050494e-02]
 [-8.07602026e-02  7.95346398e-02 -1.40989374e-02]
 [-3.43968452e-02  2.00516148e-01 -2.70259818e-02]
 [ 1.70291793e-02  6.21049298e-02 -4.61298865e-02]
 [-8.48312801e-02 -4.00829114e-02 -5.01093979e-03]
 [ 8.99107664e-01  1.73908797e+00 -3.10128526e-01]
 [-5.10435617e-04  1.83643961e-02  1.73395849e-02]
 [-3.54232187e-01 -6.39510012e-04 -7.72345383e-01]
 [ 1.89618452e+00 -3.19222256e+00  2.69703244e+00]
 [ 2.85014044e-02 -7.99806439e-02  1.72220828e-02]
 [ 3.60649728e-02  1.72342728e-01 -1.02173612e-01]
 [ 2.38240546e-02  1.48554214e-01 -2.23141554e-02]
 [-2.75095701e-01 -1.78359474e+00 -1.98927882e-01]
 [-7.39399122e-03  2.23530356e-02  2.05705760e-01]
 [ 2.26069724e-01 -3.44796502e-02  4.21530437e-01]
 [ 4.92335598e-02 -8.99830793e-02  6.60593481e-02]
 [ 1.19103189e-01 -5.11813260e-02 -6.63328368e-03]
 [-7.86174543e-03  9.12441713e-02  3.92604187e-02]
 [-4.11660348e-02 -5.93259242e-02  2.03252351e-02]
 [ 2.60396401e-02 -5.79157549e-02  1.17366723e-02]
 [ 4.68178804e-02 -5.80501232e-03  1.74068575e-01]
 [ 3.73141586e-01 -1.00048135e-01  1.66671111e-01]
 [ 5.48160818e-02 -1.66780655e-01 -7.28530617e-02]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 8.28103107e-02 -5.76212164e-03  5.19761132e-02]
 [-7.19763605e-03 -1.75949550e-02 -6.87537427e-02]
 [-4.06161499e-02  2.34164970e-02 -4.88392246e-02]
 [-1.13779457e-01 -2.94879399e-02  4.25362282e-02]
 [ 5.53063143e-03 -4.25592954e-03  8.57404688e-03]
 [-9.42539258e-02 -2.67203330e-03  4.51186339e-02]
 [-1.18076092e-01 -6.84189163e-02 -8.12731307e-02]
 [ 1.80459001e+00  1.17602054e+00  1.50418921e-01]
 [-3.11651484e-02 -7.41473092e-02 -2.34632955e-02]
 [ 3.30940869e-02 -1.42328033e-02 -7.15442690e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.53048733]
curr_Stock_Price:  98.78027091022466
curr_Factors:  [98.78027091 -0.83250793 -1.00471148]
mat_Sqrt:  [[15.73171103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.67566240e-04 -2.05325277e-02  6.66213318e-01]
Stock Position:  0.00016756624005379657
Bond Position:  [-6.54703957]


portfolio before change:  [-6.53121886]
curr_Stock_Price:  99.29887635689587
curr_Factors:  [99.29887636 -0.9408815  -1.02359087]
mat_Sqrt:  [[13.92466716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05448889 0.06258082 0.51274302]
Stock Position:  0.054488891272467616
Bond Position:  [-11.94190454]


portfolio before change:  [-6.59866911]
curr_Stock_Price:  98.08840170958206
curr_Factors:  [98.08840171 -1.12033038 -1.00776327]
mat_Sqrt:  [[11.67880289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04507579 -0.11037711  0.12373367]
Stock Position:  -0.04507579095009488
Bond Position:  [-2.17725682]


portfolio before change:  [-6.6021291]
curr_Stock_Price:  98.15912280965183
curr_Factors:  [98.15912281 -1.11954893 -0.985882  ]
mat_Sqrt:  [[11.95511163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08038477 0.58681982 4.6458137 ]
Stock Position:  0.08038476519109009
Bond Position:  [-14.49262713]


portfolio before change:  [-6.50527435]
curr_Stock_Price:  99.38654990235896
curr_Factors:  [99.3865499  -1.11860758 -0.99346176]
mat_Sqrt:  [[12.02451463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0048772  -0.01106097 -0.05874131]
Stock Position:  -0.00487720317677708
Bond Position:  [-6.02054595]


portfolio before change:  [-6.50353643]
curr_Stock_Price:  98.87590122596724
curr_Factors:  [98.87590123 -1.0006609  -0.97991779]
mat_Sqrt:  [[13.6438225   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113092  0.05500181 -0.17688315]
Stock Position:  0.0011309187905186684
Bond Position:  [-6.61535704]


portfolio before change:  [-6.50349177]
curr_Stock_Price:  99.64662715984223
curr_Factors:  [99.64662716 -1.19496645 -1.00694972]
mat_Sqrt:  [[11.02002446  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00611643  0.02566969 -0.04022034]
Stock Position:  -0.006116428875980866
Bond Position:  [-5.89401026]


portfolio before change:  [-6.50487821]
curr_Stock_Price:  99.75283947877789
curr_Factors:  [99.75283948 -1.1328334  -1.01203018]
mat_Sqrt:  [[11.67946224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.70490953e-05  6.47163084e-02 -7.70976034e-02]
Stock Position:  8.704909533345647e-05
Bond Position:  [-6.5135616]


portfolio before change:  [-6.5056932]
curr_Stock_Price:  99.7442900193095
curr_Factors:  [99.74429002 -1.05257789 -1.00277959]
mat_Sqrt:  [[12.7719624   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158864  0.02004428 -0.13159573]
Stock Position:  0.001588641648474519
Bond Position:  [-6.66415113]


portfolio before change:  [-6.50675062]
curr_Stock_Price:  99.60306635625204
curr_Factors:  [99.60306636 -0.95934274 -1.01669837]
mat_Sqrt:  [[13.80667041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00681091 -0.0129367  -0.01429482]
Stock Position:  -0.0068109124910338366
Bond Position:  [-5.82836285]


portfolio before change:  [-6.5081884]
curr_Stock_Price:  99.70719210724633
curr_Factors:  [99.70719211 -0.84981776 -1.01869634]
mat_Sqrt:  [[15.39008866  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.077374    0.56128823 -0.88471036]
Stock Position:  0.07737400446954641
Bond Position:  [-14.22293313]


portfolio before change:  [-6.55371287]
curr_Stock_Price:  99.14180216580132
curr_Factors:  [99.14180217 -1.01008318 -1.00023401]
mat_Sqrt:  [[13.27966579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00051037 0.00592708 0.04946501]
Stock Position:  0.0005103749662673661
Bond Position:  [-6.60431236]


portfolio before change:  [-6.55467617]
curr_Stock_Price:  98.8719681828499
curr_Factors:  [98.87196818 -0.76835214 -0.97603152]
mat_Sqrt:  [[17.27813979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.96338075e-02 -2.06400969e-04 -2.20328640e+00]
Stock Position:  -0.029633807470089642
Bond Position:  [-3.6247233]


portfolio before change:  [-6.55264664]
curr_Stock_Price:  98.78819062702122
curr_Factors:  [98.78819063 -0.91782433 -1.00785463]
mat_Sqrt:  [[14.401021    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12465118 -1.0302854   7.69388285]
Stock Position:  0.12465118004274249
Bond Position:  [-18.86671118]


portfolio before change:  [-6.59108093]
curr_Stock_Price:  98.49877659427291
curr_Factors:  [98.49877659 -1.03150582 -0.9827977 ]
mat_Sqrt:  [[13.14104601  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00119403 -0.02581364  0.04912981]
Stock Position:  0.0011940348386844635
Bond Position:  [-6.7086919]


portfolio before change:  [-6.59285825]
curr_Stock_Price:  97.71263913527312
curr_Factors:  [97.71263914 -0.90504107 -0.98288195]
mat_Sqrt:  [[14.79231659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00340638  0.05562338 -0.29147287]
Stock Position:  0.0034063754246339093
Bond Position:  [-6.92570418]


portfolio before change:  [-6.59479401]
curr_Stock_Price:  97.39852174560961
curr_Factors:  [97.39852175 -0.71694088 -1.02337049]
mat_Sqrt:  [[17.09010533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00290184  0.04794567 -0.06365607]
Stock Position:  0.0029018369232604595
Bond Position:  [-6.87742864]


portfolio before change:  [-6.58711192]
curr_Stock_Price:  100.34211612106226
curr_Factors:  [100.34211612  -0.98952089  -1.03637797]
mat_Sqrt:  [[13.23264192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05137118 -0.57565273 -0.56748588]
Stock Position:  -0.05137118056295205
Bond Position:  [-1.43241895]


portfolio before change:  [-6.61356484]
curr_Stock_Price:  100.85356755419083
curr_Factors:  [100.85356755  -1.11554773  -1.04768174]
mat_Sqrt:  [[11.59344865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00337762 0.00721441 0.58682127]
Stock Position:  0.0033776244341928124
Bond Position:  [-6.95421032]


portfolio before change:  [-6.61292815]
curr_Stock_Price:  101.29944981660756
curr_Factors:  [101.29944982  -1.22774954  -1.04112414]
mat_Sqrt:  [[10.47726102  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02911793 -0.01112826  1.20250901]
Stock Position:  0.029117928262528306
Bond Position:  [-9.56255826]


portfolio before change:  [-6.61345227]
curr_Stock_Price:  101.32250358687601
curr_Factors:  [101.32250359  -1.10875146  -1.04019317]
mat_Sqrt:  [[11.814929    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00375374 -0.02904191  0.18844893]
Stock Position:  0.003753738054062973
Bond Position:  [-6.99379041]


portfolio before change:  [-6.61614003]
curr_Stock_Price:  100.83938926622525
curr_Factors:  [100.83938927  -1.1960882   -1.078841  ]
mat_Sqrt:  [[10.36671133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01035061 -0.0165187  -0.01892291]
Stock Position:  0.010350614376971483
Bond Position:  [-7.65988966]


portfolio before change:  [-6.6242762]
curr_Stock_Price:  100.14584345723861
curr_Factors:  [100.14584346  -1.32688595  -1.0379857 ]
mat_Sqrt:  [[ 9.4098396   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00199551 0.02944893 0.11199905]
Stock Position:  0.001995506114822596
Bond Position:  [-6.82411785]


portfolio before change:  [-6.62622947]
curr_Stock_Price:  99.59450291461725
curr_Factors:  [99.59450291 -1.11238228 -1.02973484]
mat_Sqrt:  [[11.6929939   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00420141 -0.01914736  0.05798224]
Stock Position:  -0.00420140620357778
Bond Position:  [-6.20779251]


portfolio before change:  [-6.6282283]
curr_Stock_Price:  99.88554866011046
curr_Factors:  [99.88554866 -1.10368991 -1.04942025]
mat_Sqrt:  [[11.59895328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00143232 -0.01869223  0.03348146]
Stock Position:  0.001432316687672355
Bond Position:  [-6.77129604]


portfolio before change:  [-6.62779822]
curr_Stock_Price:  100.77679522221658
curr_Factors:  [100.77679522  -1.02636748  -1.04141592]
mat_Sqrt:  [[12.74481751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00636843 -0.00187356  0.49656919]
Stock Position:  0.006368434563142284
Bond Position:  [-7.26958864]


portfolio before change:  [-6.62584983]
curr_Stock_Price:  101.2254359046626
curr_Factors:  [101.2254359   -1.15816162  -1.03637766]
mat_Sqrt:  [[11.2775135   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0342931  -0.0322904   0.47546629]
Stock Position:  0.034293104040378185
Bond Position:  [-10.09718424]


portfolio before change:  [-6.62305835]
curr_Stock_Price:  101.34364363693489
curr_Factors:  [101.34364364  -1.2565622   -1.0267961 ]
mat_Sqrt:  [[10.33110088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00057119 -0.05382822 -0.20782951]
Stock Position:  0.0005711931685386207
Bond Position:  [-6.68094515]


portfolio before change:  [-6.62367907]
curr_Stock_Price:  101.71907697727782
curr_Factors:  [101.71907698  -1.30178395  -1.05412008]
mat_Sqrt:  [[ 9.64375775  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00229154 -0.02321455 -0.0028026 ]
Stock Position:  -0.0022915374882619167
Bond Position:  [-6.390586]


portfolio before change:  [-6.62235123]
curr_Stock_Price:  100.79100242055375
curr_Factors:  [100.79100242  -1.37105223  -1.04059679]
mat_Sqrt:  [[ 9.03765801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01020659 -0.00185972  0.14827338]
Stock Position:  0.010206593572677442
Bond Position:  [-7.65108403]


portfolio before change:  [-6.63020352]
curr_Stock_Price:  100.1153757754415
curr_Factors:  [100.11537578  -1.19768989  -1.0328006 ]
mat_Sqrt:  [[10.7599702   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230702 -0.00567875 -0.19613529]
Stock Position:  -0.0023070222039467307
Bond Position:  [-6.39923513]


portfolio before change:  [-6.63116839]
curr_Stock_Price:  100.18686003078597
curr_Factors:  [100.18686003  -1.29096668  -1.01457592]
mat_Sqrt:  [[ 9.98909943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00458555  0.00755764 -0.13932471]
Stock Position:  -0.004585552760573907
Bond Position:  [-6.17175626]


portfolio before change:  [-6.62968587]
curr_Stock_Price:  99.69530840625202
curr_Factors:  [99.69530841 -1.13380327 -1.0245714 ]
mat_Sqrt:  [[11.51607574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00964877 -0.00951719  0.12134402]
Stock Position:  -0.009648771779302302
Bond Position:  [-5.6677486]


portfolio before change:  [-6.62066628]
curr_Stock_Price:  98.6870863133107
curr_Factors:  [98.68708631 -1.02590187 -1.03475093]
mat_Sqrt:  [[12.56985263  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00051011 -0.0013736   0.02445937]
Stock Position:  0.0005101144488723302
Bond Position:  [-6.67100799]


portfolio before change:  [-6.6209651]
curr_Stock_Price:  99.73608361052595
curr_Factors:  [99.73608361 -1.02779708 -1.04144751]
mat_Sqrt:  [[12.59478623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00679563 -0.0008624   0.1287109 ]
Stock Position:  -0.006795633375648482
Bond Position:  [-5.94319524]


portfolio before change:  [-6.61766239]
curr_Stock_Price:  99.14075150851178
curr_Factors:  [99.14075151 -1.13679806 -1.04598846]
mat_Sqrt:  [[11.1758372   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01329939 -0.02208211 -0.23184962]
Stock Position:  -0.013299393179544448
Bond Position:  [-5.29915055]


portfolio before change:  [-6.61810344]
curr_Stock_Price:  99.1241052242025
curr_Factors:  [99.12410522 -0.81236716 -1.04532651]
mat_Sqrt:  [[15.46653997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.1341831  0.379559   0.42910331]
Stock Position:  0.13418310319565896
Bond Position:  [-19.91888348]


portfolio before change:  [-6.61087095]
curr_Stock_Price:  99.19656222556863
curr_Factors:  [99.19656223 -0.79390615 -1.03226242]
mat_Sqrt:  [[15.97355896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031984  -0.02393094 -0.06693425]
Stock Position:  -0.0031983999186241895
Bond Position:  [-6.29360067]


portfolio before change:  [-6.60958438]
curr_Stock_Price:  98.54832726736403
curr_Factors:  [98.54832727 -0.62652966 -1.02979517]
mat_Sqrt:  [[18.80687     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082868 -0.00459362 -0.20409589]
Stock Position:  0.000828682035273903
Bond Position:  [-6.69124961]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.6097113]
Stock Price:  99.40456040289813
PL:  [-6.6097113]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 4.55180643e-02 -3.10080718e-02 -6.61094900e-02]
 [ 1.02551210e+00  2.22887750e-01  2.99286977e-01]
 [-3.43042558e-01 -2.29293196e-01  3.98026852e-02]
 [ 2.00817906e-01  1.52297144e+00  1.28767825e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 2.45544675e-03  1.28527109e-01 -4.13617988e-02]
 [-1.46670417e-01  1.90399502e-01  1.94652604e-01]
 [-2.47311456e-02  4.24491207e-02  3.37252206e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 5.10263800e-01  1.26274700e+00 -1.08923099e-01]
 [-1.42121670e-03  3.03415829e-02  1.44577039e-01]
 [-4.41022155e-01 -8.63573489e-02 -1.19457004e+00]
 [ 2.15068115e+00 -3.16301990e+00  2.69527719e+00]
 [-2.62165580e-02  8.35358486e-02 -5.40861663e-02]
 [ 9.96535614e-03  5.12087471e-01 -2.77689314e-01]
 [ 1.90038256e-02 -2.99350636e-01 -1.24812977e-01]
 [-3.14487451e-01 -1.99260448e+00 -1.93394653e-01]
 [ 4.17314706e-02 -2.13220574e-01  3.18858886e-01]
 [-2.69914719e-01  4.92445753e-01  2.93718202e-01]
 [ 1.55962770e-02  1.18681463e-01 -7.36679598e-02]
 [ 1.29355066e-01 -5.35905078e-02  8.17991665e-02]
 [ 1.94469214e-02 -1.22078280e-01 -1.22831989e-01]
 [-2.23735008e-01  6.52003915e-02  3.14240809e-02]
 [ 9.08404412e-02 -1.55858605e-02 -3.19589343e-02]
 [-5.08387512e-03 -5.13128704e-02  2.20090445e-01]
 [-1.98555923e-01 -1.32430231e-01 -7.35745915e-02]
 [-1.93372721e-01  1.52920787e-01  2.46321993e-01]
 [ 1.28150004e-01  9.59183344e-02  2.19982213e-01]
 [-1.65309860e-01  1.21036655e-01 -5.44240690e-02]
 [ 7.09675176e-02 -1.63722092e-02 -6.23431690e-02]
 [-5.58230537e-02  3.47228023e-04 -3.75758526e-02]
 [-2.98783114e-02  2.55197630e-02  7.78109816e-02]
 [-7.65627842e-03 -3.69600842e-02 -9.10506098e-03]
 [-9.16323427e-02  2.58519131e-02  5.07574358e-02]
 [-1.10148183e-01 -6.22071103e-02 -7.31565356e-02]
 [ 1.01428363e+00  6.84557128e-01  1.20243596e-01]
 [ 1.00592116e-01 -1.65912250e-01  2.94863515e-02]
 [ 3.15546166e-02 -1.50169130e-02 -4.85273136e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.25180889]
curr_Stock_Price:  99.70579390070208
curr_Factors:  [99.7057939  -1.24980228 -0.99246828]
mat_Sqrt:  [[10.59045603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00242615 -0.01000781 -0.18859197]
Stock Position:  0.00242614907060041
Bond Position:  [0.00990777]


portfolio before change:  [0.25172187]
curr_Stock_Price:  99.66941473509873
curr_Factors:  [99.66941474 -1.34014464 -0.97792722]
mat_Sqrt:  [[ 9.81377482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11535832 0.07193671 0.85378244]
Stock Position:  0.11535831938407341
Bond Position:  [-11.24597431]


portfolio before change:  [0.18229433]
curr_Stock_Price:  99.0797588902785
curr_Factors:  [99.07975889 -1.28329958 -0.9988423 ]
mat_Sqrt:  [[10.11261124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03774714 -0.07400406  0.11354598]
Stock Position:  -0.03774713938027718
Bond Position:  [3.9222718]


portfolio before change:  [0.1735171]
curr_Stock_Price:  99.32527517462145
curr_Factors:  [99.32527517 -1.14993626 -0.99575184]
mat_Sqrt:  [[11.61981673  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06665676 0.49153692 3.67338762]
Stock Position:  0.06665676314377705
Bond Position:  [-6.44718424]


portfolio before change:  [0.15857453]
curr_Stock_Price:  99.1131942310891
curr_Factors:  [99.11319423 -1.06911844 -1.05231799]
mat_Sqrt:  [[11.87964155  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00493668 -0.01106097 -0.05874131]
Stock Position:  -0.0049366810165608
Bond Position:  [0.64786475]


portfolio before change:  [0.15733784]
curr_Stock_Price:  99.38010965854741
curr_Factors:  [99.38010966 -0.95643955 -1.07833945]
mat_Sqrt:  [[12.98991109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155875  0.04148195 -0.1179937 ]
Stock Position:  0.0015587474753644317
Bond Position:  [0.00242934]


portfolio before change:  [0.15381364]
curr_Stock_Price:  97.11899902364372
curr_Factors:  [97.11899902 -0.80304712 -1.09320505]
mat_Sqrt:  [[14.58049743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0046687   0.06145117  0.5552897 ]
Stock Position:  -0.004668701116108862
Bond Position:  [0.60723322]


portfolio before change:  [0.1559128]
curr_Stock_Price:  96.68563465289701
curr_Factors:  [96.68563465 -0.64727696 -1.10030533]
mat_Sqrt:  [[16.84211406  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054519  0.01370039  0.09620867]
Stock Position:  -0.0005451882864692696
Bond Position:  [0.20862467]


portfolio before change:  [0.15585223]
curr_Stock_Price:  96.84456386474942
curr_Factors:  [96.84456386 -0.85170131 -1.1048824 ]
mat_Sqrt:  [[13.688055    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00379829  0.0064198  -0.11330016]
Stock Position:  0.003798290067954205
Bond Position:  [-0.21199151]


portfolio before change:  [0.15321513]
curr_Stock_Price:  96.15725340188064
curr_Factors:  [96.1572534 -0.8867029 -1.092624 ]
mat_Sqrt:  [[13.28529799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [6.57922199e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  6.579221989354543e-05
Bond Position:  [0.14688873]


portfolio before change:  [0.15316932]
curr_Stock_Price:  95.181937668455
curr_Factors:  [95.18193767 -1.03012638 -1.10402123]
mat_Sqrt:  [[11.26434678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06620776  0.40754984 -0.31072728]
Stock Position:  0.06620775550702088
Bond Position:  [-6.14861314]


portfolio before change:  [0.17016821]
curr_Stock_Price:  95.45029774283103
curr_Factors:  [95.45029774 -0.88932002 -1.10425413]
mat_Sqrt:  [[13.00106822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00263701 0.0097927  0.41243805]
Stock Position:  0.0026370061969204655
Bond Position:  [-0.08153481]


portfolio before change:  [0.16802052]
curr_Stock_Price:  94.6397194244244
curr_Factors:  [94.63971942 -0.74308722 -1.12732495]
mat_Sqrt:  [[14.58020939  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04818109 -0.02787171 -3.40777581]
Stock Position:  -0.048181088735241025
Bond Position:  [4.72786524]


portfolio before change:  [0.22729876]
curr_Stock_Price:  93.42166434583375
curr_Factors:  [93.42166435 -0.73055261 -1.15357652]
mat_Sqrt:  [[14.19648127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.14476852 -1.02086028  7.68887561]
Stock Position:  0.1447685191795588
Bond Position:  [-13.29721724]


portfolio before change:  [0.08653131]
curr_Stock_Price:  92.46078417281606
curr_Factors:  [92.46078417 -0.64001082 -1.15417165]
mat_Sqrt:  [[15.37283711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131434  0.02696108 -0.15429278]
Stock Position:  -0.0013143420873103434
Bond Position:  [0.20805641]


portfolio before change:  [0.08694415]
curr_Stock_Price:  92.16646466506963
curr_Factors:  [92.16646467 -0.6870754  -1.18243909]
mat_Sqrt:  [[14.21193139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00406783  0.16527552 -0.79217032]
Stock Position:  0.004067827103087518
Bond Position:  [-0.28797309]


portfolio before change:  [0.0890315]
curr_Stock_Price:  92.68845033682696
curr_Factors:  [92.68845034 -0.66629998 -1.19264165]
mat_Sqrt:  [[14.44433422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00467853 -0.096615   -0.35605668]
Stock Position:  -0.004678527117365095
Bond Position:  [0.52267693]


portfolio before change:  [0.08833178]
curr_Stock_Price:  92.85197531592874
curr_Factors:  [92.85197532 -0.70797705 -1.1690736 ]
mat_Sqrt:  [[14.21014166  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05353238 -0.64311033 -0.55170111]
Stock Position:  -0.05353237675391807
Bond Position:  [5.05891871]


portfolio before change:  [0.04572609]
curr_Stock_Price:  93.6596752491765
curr_Factors:  [93.65967525 -0.94735625 -1.15740518]
mat_Sqrt:  [[11.4147491   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.005545   -0.06881664  0.90961565]
Stock Position:  0.005545001493277401
Bond Position:  [-0.47361695]


portfolio before change:  [0.04715614]
curr_Stock_Price:  93.92825195577988
curr_Factors:  [93.92825196 -0.98147142 -1.14365391]
mat_Sqrt:  [[11.21672403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00975683  0.15893618  0.83789627]
Stock Position:  -0.009756830350415791
Bond Position:  [0.96359816]


portfolio before change:  [0.0480413]
curr_Stock_Price:  93.84987656431547
curr_Factors:  [93.84987656 -0.94461947 -1.1149411 ]
mat_Sqrt:  [[11.96679677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00207112  0.03830428 -0.21015418]
Stock Position:  0.0020711156369160903
Bond Position:  [-0.14633265]


portfolio before change:  [0.04822563]
curr_Stock_Price:  93.94771399844575
curr_Factors:  [93.947714   -0.95313033 -1.13308907]
mat_Sqrt:  [[11.66413782  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01158364 -0.01729626  0.23335025]
Stock Position:  0.011583636629225688
Bond Position:  [-1.04003055]


portfolio before change:  [0.03797201]
curr_Stock_Price:  93.07375610798562
curr_Factors:  [93.07375611 -0.74459663 -1.13673673]
mat_Sqrt:  [[14.18321033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215362 -0.0394006  -0.35040548]
Stock Position:  -0.002153615243809053
Bond Position:  [0.23841707]


portfolio before change:  [0.03486336]
curr_Stock_Price:  94.53105247563306
curr_Factors:  [94.53105248 -0.90937579 -1.18111989]
mat_Sqrt:  [[11.68648088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01745706  0.02104334  0.08964416]
Stock Position:  -0.017457061923308623
Bond Position:  [1.6850978]


portfolio before change:  [0.02718591]
curr_Stock_Price:  94.98290979623295
curr_Factors:  [94.9829098  -1.23434358 -1.19206623]
mat_Sqrt:  [[ 8.39206964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0096681  -0.00503031 -0.09116994]
Stock Position:  0.009668103816802304
Bond Position:  [-0.89111872]


portfolio before change:  [0.02521962]
curr_Stock_Price:  94.79105266845053
curr_Factors:  [94.79105267 -1.0403244  -1.19139447]
mat_Sqrt:  [[10.1752282   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0028862  -0.01656116  0.62785678]
Stock Position:  0.002886196006614931
Bond Position:  [-0.24836594]


portfolio before change:  [0.02498825]
curr_Stock_Price:  94.72164490669824
curr_Factors:  [94.72164491 -0.73127918 -1.20206887]
mat_Sqrt:  [[13.70272178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01755903 -0.04274167 -0.20988783]
Stock Position:  -0.017559028427337805
Bond Position:  [1.6882083]


portfolio before change:  [0.02864558]
curr_Stock_Price:  94.52537574472247
curr_Factors:  [94.52537574 -0.89482191 -1.21459666]
mat_Sqrt:  [[11.46672955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00975672  0.04935497  0.70268808]
Stock Position:  -0.0097567165033385
Bond Position:  [0.95090287]


portfolio before change:  [0.03196312]
curr_Stock_Price:  94.19753332898068
curr_Factors:  [94.19753333 -0.68014313 -1.20188531]
mat_Sqrt:  [[14.34448515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01342906 0.03095751 0.62754802]
Stock Position:  0.013429058719854397
Bond Position:  [-1.23302109]


portfolio before change:  [0.0368903]
curr_Stock_Price:  94.57591577405914
curr_Factors:  [94.57591577 -0.51507222 -1.20527577]
mat_Sqrt:  [[16.92945252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00896146  0.03906441 -0.15525672]
Stock Position:  -0.008961460695887252
Bond Position:  [0.88442865]


portfolio before change:  [0.02476181]
curr_Stock_Price:  95.9416580187715
curr_Factors:  [95.94165802 -0.72451668 -1.22183751]
mat_Sqrt:  [[13.6998665   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00400732 -0.00528411 -0.17784771]
Stock Position:  0.004007324325348085
Bond Position:  [-0.35970753]


portfolio before change:  [0.02636097]
curr_Stock_Price:  96.35193713755159
curr_Factors:  [96.35193714 -0.70784822 -1.23929123]
mat_Sqrt:  [[13.74765205  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00461332  0.00011207 -0.10719345]
Stock Position:  -0.004613319758444002
Bond Position:  [0.47086327]


portfolio before change:  [0.0266356]
curr_Stock_Price:  96.30516537391034
curr_Factors:  [96.30516537 -0.83810204 -1.20837887]
mat_Sqrt:  [[12.44154203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070618  0.00823647  0.22197307]
Stock Position:  -0.0007061834807413049
Bond Position:  [0.09464472]


portfolio before change:  [0.02639017]
curr_Stock_Price:  96.66947679337767
curr_Factors:  [96.66947679 -1.20771618 -1.19836384]
mat_Sqrt:  [[ 8.71649923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195713 -0.01192882 -0.0259742 ]
Stock Position:  -0.001957125946858688
Bond Position:  [0.21558451]


portfolio before change:  [0.02617143]
curr_Stock_Price:  96.79501257670668
curr_Factors:  [96.79501258 -1.16374059 -1.20151916]
mat_Sqrt:  [[ 9.09146184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00835889  0.00834367  0.14479684]
Stock Position:  -0.008358889494630853
Bond Position:  [0.83527024]


portfolio before change:  [0.02909318]
curr_Stock_Price:  96.45796565090409
curr_Factors:  [96.45796565 -1.24738337 -1.23597774]
mat_Sqrt:  [[ 8.05059669  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01711416 -0.02007726 -0.20869523]
Stock Position:  -0.0171141564388634
Bond Position:  [1.67988989]


portfolio before change:  [0.03901193]
curr_Stock_Price:  95.89067222681435
curr_Factors:  [95.89067223 -1.32371705 -1.21854839]
mat_Sqrt:  [[ 7.54543899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.1561954  0.22093986 0.34302151]
Stock Position:  0.15619540379467373
Bond Position:  [-14.93867034]


portfolio before change:  [-0.00067482]
curr_Stock_Price:  95.64854415028137
curr_Factors:  [95.64854415 -1.34197332 -1.19464148]
mat_Sqrt:  [[ 7.56903566  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00961077 -0.05354795  0.08411635]
Stock Position:  0.009610774619585418
Bond Position:  [-0.91993142]


portfolio before change:  [0.00026125]
curr_Stock_Price:  95.75790710135543
curr_Factors:  [95.7579071  -1.37022297 -1.20758575]
mat_Sqrt:  [[ 7.27187725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00255556 -0.00484669 -0.13843492]
Stock Position:  0.0025555582093320997
Bond Position:  [-0.24445366]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.00154257]
Stock Price:  96.27125084815852
PL:  [0.00154257]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 4.78153153e-02 -8.34285593e-02 -4.68638314e-02]
 [ 1.02536776e+00  2.22314643e-01  2.96597099e-01]
 [-2.48949296e-01 -1.42682292e-01  3.70581189e-02]
 [ 1.72608570e-01  1.43025884e+00  1.12301549e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 2.86420162e-02 -7.10066590e-02  5.61203407e-02]
 [-9.81171059e-02  1.28101798e-01  1.93323884e-02]
 [-2.03094068e-02  2.25794912e-01 -3.43568136e-02]
 [-3.05097741e-03  8.38349046e-02 -4.94312253e-02]
 [-2.57764987e-01 -9.92999869e-02 -1.10907225e-01]
 [ 8.01471143e-01  1.53507455e+00 -2.80872601e-01]
 [-1.91392319e-04  3.27382627e-02 -5.83927713e-02]
 [-2.73767049e-01 -1.39535278e-02 -5.89005334e-01]
 [ 1.78617800e+00 -3.44733646e+00  2.89886345e+00]
 [ 1.97984265e-02 -8.96020085e-02  3.41603315e-02]
 [ 1.14627207e-01 -3.17296999e-02 -1.05935437e-02]
 [-8.63836489e-02 -5.89988662e-02 -4.99231772e-02]
 [-2.65977824e-01 -1.72559136e+00 -1.96731949e-01]
 [-2.65615334e-02  1.14931348e-01  3.39866052e-01]
 [ 2.63511348e-01  5.38410212e-02  5.46255872e-01]
 [ 6.34003568e-02 -2.61535641e-01 -2.94093987e-02]
 [ 1.40966217e-01 -5.36155354e-02 -1.43128024e-02]
 [ 6.52752684e-02  1.61694707e-01  1.12172481e-01]
 [ 1.32903479e-01 -2.48692598e-01 -1.11041791e-01]
 [-3.17062429e-02 -1.36814445e-01  5.37357930e-02]
 [ 4.50984903e-02 -1.03205580e-02  7.21791433e-02]
 [ 5.65074714e-01 -9.68117272e-02  2.84467759e-01]
 [ 1.35345186e-01 -2.95659468e-01 -1.75945857e-01]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 1.59896485e-01 -7.07585798e-02  8.02636153e-02]
 [-2.06594940e-02 -5.88656648e-02 -3.71067193e-02]
 [ 1.07226757e-02  2.41790183e-02 -6.30649508e-02]
 [-3.62416477e-02 -1.03554228e-02 -4.88464313e-02]
 [ 3.63135802e-01  5.78847470e-02  8.36810598e-02]
 [ 8.43079122e-03 -4.69936897e-02  2.67823401e-02]
 [-9.43939457e-02 -3.16083221e-02 -1.00693379e-01]
 [ 2.09126168e+00  1.40227541e+00  1.70720292e-01]
 [-5.81498819e-02 -8.34162915e-02 -3.74363855e-02]
 [ 3.80546068e-02 -1.91172062e-02 -6.26624495e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.18100165]
curr_Stock_Price:  100.2419778289416
curr_Factors:  [100.24197783  -1.06437896  -1.02494785]
mat_Sqrt:  [[12.40699262  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171028 -0.02692645 -0.13368947]
Stock Position:  0.0017102849224185294
Bond Position:  [4.0095593]


portfolio before change:  [4.18067722]
curr_Stock_Price:  99.75921884032034
curr_Factors:  [99.75921884 -1.26866792 -0.98962144]
mat_Sqrt:  [[10.42774573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10848847 0.07175174 0.84610897]
Stock Position:  0.10848846911627373
Bond Position:  [-6.64204771]


portfolio before change:  [4.19038743]
curr_Stock_Price:  99.85637683778401
curr_Factors:  [99.85637684 -1.36795684 -1.01142275]
mat_Sqrt:  [[ 9.24750087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0292522  -0.04605051  0.1057165 ]
Stock Position:  -0.02925219948523286
Bond Position:  [7.11140609]


portfolio before change:  [4.18993696]
curr_Stock_Price:  99.90216680229751
curr_Factors:  [99.9021668  -1.44993349 -1.02108907]
mat_Sqrt:  [[ 8.44157427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08218769 0.46161406 3.20365062]
Stock Position:  0.0821876925680308
Bond Position:  [-4.02079161]


portfolio before change:  [4.20520027]
curr_Stock_Price:  100.09399537776491
curr_Factors:  [100.09399538  -1.42256052  -1.02264038]
mat_Sqrt:  [[ 8.67902157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00675721 -0.01106097 -0.05874131]
Stock Position:  -0.006757213410945586
Bond Position:  [4.88155676]


portfolio before change:  [4.20589096]
curr_Stock_Price:  100.08208851853102
curr_Factors:  [100.08208852  -1.13675213  -1.03504725]
mat_Sqrt:  [[11.40659103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00224461 -0.0229173   0.16009571]
Stock Position:  0.0022446109568893544
Bond Position:  [3.98124561]


portfolio before change:  [4.20543853]
curr_Stock_Price:  99.65879650402154
curr_Factors:  [99.6587965  -1.41431578 -1.03564678]
mat_Sqrt:  [[ 8.60023698  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00790934  0.04134468  0.05514992]
Stock Position:  -0.007909343510215128
Bond Position:  [4.99367418]


portfolio before change:  [4.20371799]
curr_Stock_Price:  99.95525404261848
curr_Factors:  [99.95525404 -1.15210158 -1.02917966]
mat_Sqrt:  [[11.28462733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166312  0.07287499 -0.09801043]
Stock Position:  0.00166312372486604
Bond Position:  [4.03748004]


portfolio before change:  [4.20544636]
curr_Stock_Price:  100.69101061306073
curr_Factors:  [100.69101061  -1.33141468  -1.01760915]
mat_Sqrt:  [[ 9.61219584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00041319  0.0270576  -0.14101353]
Stock Position:  0.00041318802697668373
Bond Position:  [4.16384204]


portfolio before change:  [4.20620958]
curr_Stock_Price:  101.27841506807319
curr_Factors:  [101.27841507  -1.57442279  -1.05188119]
mat_Sqrt:  [[ 7.32702323  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04103622 -0.03204893 -0.31638744]
Stock Position:  -0.04103622236034503
Bond Position:  [8.36229314]


portfolio before change:  [4.23276439]
curr_Stock_Price:  100.65678242113698
curr_Factors:  [100.65678242  -1.39910505  -1.0115846 ]
mat_Sqrt:  [[ 9.03428595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11705231  0.49544318 -0.80125135]
Stock Position:  0.11705231047885645
Bond Position:  [-7.54934456]


portfolio before change:  [4.30970686]
curr_Stock_Price:  101.32217891554865
curr_Factors:  [101.32217892  -1.58149511  -1.00986956]
mat_Sqrt:  [[ 7.59082787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071509  0.01056623 -0.16657832]
Stock Position:  -0.0007150862915016852
Bond Position:  [4.38216096]


portfolio before change:  [4.31030813]
curr_Stock_Price:  101.24741242489524
curr_Factors:  [101.24741242  -1.60672552  -1.03457457]
mat_Sqrt:  [[ 7.21575663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05499708 -0.00450348 -1.68026827]
Stock Position:  -0.0549970754191754
Bond Position:  [9.87861971]


portfolio before change:  [4.30482624]
curr_Stock_Price:  101.36954238343867
curr_Factors:  [101.36954238  -1.47357528  -1.04453837]
mat_Sqrt:  [[ 8.17155334  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.20488411 -1.11262306  8.26965054]
Stock Position:  0.204884107666708
Bond Position:  [-16.46418199]


portfolio before change:  [4.35116135]
curr_Stock_Price:  101.60574057374674
curr_Factors:  [101.60574057  -1.7784336   -1.08152588]
mat_Sqrt:  [[ 5.81907062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00145753 -0.02891892  0.09744992]
Stock Position:  0.0014575251216099518
Bond Position:  [4.20306843]


portfolio before change:  [4.35131643]
curr_Stock_Price:  101.35165624128497
curr_Factors:  [101.35165624  -1.82743562  -1.0748956 ]
mat_Sqrt:  [[ 5.56370912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01904988 -0.01024072 -0.03022043]
Stock Position:  0.01904988361530459
Bond Position:  [2.42057917]


portfolio before change:  [4.34757551]
curr_Stock_Price:  101.13939744272551
curr_Factors:  [101.13939744  -1.77170688  -1.0601178 ]
mat_Sqrt:  [[ 5.95764373  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01823158 -0.0190418  -0.14241693]
Stock Position:  -0.018231581618842113
Bond Position:  [6.19150669]


portfolio before change:  [4.34528202]
curr_Stock_Price:  101.30764854852774
curr_Factors:  [101.30764855  -1.9063389   -1.06115257]
mat_Sqrt:  [[ 5.21047196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12635524 -0.55693222 -0.56122149]
Stock Position:  -0.1263552383419921
Bond Position:  [17.1460341]


portfolio before change:  [4.33131923]
curr_Stock_Price:  101.43511592797424
curr_Factors:  [101.43511593  -1.53607879  -1.05687339]
mat_Sqrt:  [[ 7.58723455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00873488 0.03709393 0.96954325]
Stock Position:  0.008734881821708966
Bond Position:  [3.44529548]


portfolio before change:  [4.33102578]
curr_Stock_Price:  101.35221344467031
curr_Factors:  [101.35221344  -1.64887544  -1.04623504]
mat_Sqrt:  [[ 6.84481368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05639388 0.01737711 1.55831596]
Stock Position:  0.056393881752911004
Bond Position:  [-1.38461896]


portfolio before change:  [4.32657036]
curr_Stock_Price:  101.27627732074896
curr_Factors:  [101.27627732  -1.61652907  -1.01958739]
mat_Sqrt:  [[ 7.25532546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0005529  -0.08441027 -0.08389683]
Stock Position:  0.000552897224097073
Bond Position:  [4.27057499]


portfolio before change:  [4.32743658]
curr_Stock_Price:  101.87741524470094
curr_Factors:  [101.87741524  -1.55796185  -1.02230134]
mat_Sqrt:  [[ 7.71762821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01646884 -0.01730434 -0.04083044]
Stock Position:  0.01646884246161831
Bond Position:  [2.64963348]


portfolio before change:  [4.32949037]
curr_Stock_Price:  101.98201028338431
curr_Factors:  [101.98201028  -1.51141295  -1.03820147]
mat_Sqrt:  [[ 7.96599621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01521193 0.05218674 0.31999687]
Stock Position:  0.015211929678610452
Bond Position:  [2.7781472]


portfolio before change:  [4.33506204]
curr_Stock_Price:  102.32545048222762
curr_Factors:  [102.32545048  -1.74467523  -1.03848203]
mat_Sqrt:  [[ 6.32810713  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00939823 -0.08026519 -0.31677132]
Stock Position:  0.009398229708396948
Bond Position:  [3.37338396]


portfolio before change:  [4.33930609]
curr_Stock_Price:  102.73215978817143
curr_Factors:  [102.73215979  -1.48050079  -1.06212444]
mat_Sqrt:  [[ 8.08087354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0060222  -0.04415667  0.15329326]
Stock Position:  -0.006022195670003008
Bond Position:  [4.95797926]


portfolio before change:  [4.34263417]
curr_Stock_Price:  102.28244182229022
curr_Factors:  [102.28244182  -1.49220502  -1.05076681]
mat_Sqrt:  [[ 8.04271082  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00717735 -0.00333095  0.20590701]
Stock Position:  0.007177346356651967
Bond Position:  [3.60851766]


portfolio before change:  [4.34369773]
curr_Stock_Price:  102.3677751510149
curr_Factors:  [102.36777515  -1.59926703  -1.02509638]
mat_Sqrt:  [[ 7.42021894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08131564 -0.03124585  0.81150734]
Stock Position:  0.081315638511256
Bond Position:  [-3.98040327]


portfolio before change:  [4.35020745]
curr_Stock_Price:  102.453949351448
curr_Factors:  [102.45394935  -1.80821272  -1.05687276]
mat_Sqrt:  [[ 5.83764778  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00669433 -0.09542368 -0.50192456]
Stock Position:  0.006694332043317973
Bond Position:  [3.6643467]


portfolio before change:  [4.34674006]
curr_Stock_Price:  101.86756297211322
curr_Factors:  [101.86756297  -1.41372144  -1.02709973]
mat_Sqrt:  [[ 8.87157545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249099 -0.02321455 -0.0028026 ]
Stock Position:  -0.0024909930093609204
Bond Position:  [4.60049145]


portfolio before change:  [4.34620411]
curr_Stock_Price:  102.31358992815187
curr_Factors:  [102.31358993  -1.43211739  -1.05982606]
mat_Sqrt:  [[ 8.46634647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01911529 -0.02283723  0.22896975]
Stock Position:  0.019115292837085827
Bond Position:  [2.39044988]


portfolio before change:  [4.36906653]
curr_Stock_Price:  103.4939848547355
curr_Factors:  [103.49398485  -1.57169232  -1.07591875]
mat_Sqrt:  [[ 7.32946428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0054915  -0.01899881 -0.10585514]
Stock Position:  -0.005491502967543286
Bond Position:  [4.93740405]


portfolio before change:  [4.36894168]
curr_Stock_Price:  103.62911349098303
curr_Factors:  [103.62911349  -1.37548199  -1.04986518]
mat_Sqrt:  [[ 9.16572641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00030386  0.00780374 -0.17990675]
Stock Position:  0.000303862215162531
Bond Position:  [4.33745271]


portfolio before change:  [4.3693141]
curr_Stock_Price:  103.07030026746482
curr_Factors:  [103.07030027  -1.43942092  -1.04678263]
mat_Sqrt:  [[ 8.57805957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0056337  -0.0033422  -0.13934527]
Stock Position:  -0.005633695500147276
Bond Position:  [4.94998078]


portfolio before change:  [4.37169081]
curr_Stock_Price:  102.7582617510461
curr_Factors:  [102.75826175  -1.36231069  -1.04866797]
mat_Sqrt:  [[ 9.22023567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04251874 0.01868222 0.23871877]
Stock Position:  0.04251873973910286
Bond Position:  [0.00253903]


portfolio before change:  [4.35116728]
curr_Stock_Price:  102.27556037933674
curr_Factors:  [102.27556038  -1.12972244  -1.04006441]
mat_Sqrt:  [[11.68006911  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036859 -0.01516715  0.07640256]
Stock Position:  0.0003685908638033907
Bond Position:  [4.31346944]


portfolio before change:  [4.35197298]
curr_Stock_Price:  102.99854385060364
curr_Factors:  [102.99854385  -1.52314181  -1.04131323]
mat_Sqrt:  [[ 7.92688229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01531496 -0.01020154 -0.28725018]
Stock Position:  -0.015314964048672379
Bond Position:  [5.92939197]


portfolio before change:  [4.35310394]
curr_Stock_Price:  102.97309544998109
curr_Factors:  [102.97309545  -1.48596527  -1.04392146]
mat_Sqrt:  [[ 8.20366511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.29405736 0.45258244 0.48701747]
Stock Position:  0.2940573577674559
Bond Position:  [-25.92689243]


portfolio before change:  [4.47167234]
curr_Stock_Price:  103.38733252901068
curr_Factors:  [103.38733253  -1.66574908  -0.99318611]
mat_Sqrt:  [[ 7.2394646   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01143991 -0.02692249 -0.10679559]
Stock Position:  -0.0114399110845884
Bond Position:  [5.65441423]


portfolio before change:  [4.47094836]
curr_Stock_Price:  103.51240501744006
curr_Factors:  [103.51240502  -1.98571968  -1.01004089]
mat_Sqrt:  [[ 5.17547383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00412743 -0.00617005 -0.17875853]
Stock Position:  0.004127429721333014
Bond Position:  [4.04370819]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.47094035]
Stock Price:  103.38799204378833
PL:  [1.08294831]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.23620334e-01 -1.98569219e-02 -1.70029982e-01]
 [ 1.36687597e+00  2.63158674e-01  4.14976092e-01]
 [-2.14238934e-01 -1.10732121e-01  3.60456671e-02]
 [ 1.62720718e-01  1.37409260e+00  1.06101986e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 3.24972850e-02 -7.24866103e-02  7.21214448e-02]
 [-1.33842140e-01  2.28065679e-01  8.81427771e-02]
 [-1.35903749e-02  1.09701555e-01  1.00156801e-02]
 [ 2.48111405e-02  5.36835902e-02 -4.48504697e-02]
 [-8.36267589e-02 -3.93349560e-02 -4.17837028e-03]
 [ 7.71384290e-01  1.58983746e+00 -2.42221409e-01]
 [-8.19046223e-04  2.55766245e-02  5.70765219e-02]
 [-4.52655896e-01 -1.06194515e-02 -9.62755001e-01]
 [ 1.98060289e+00 -3.12800391e+00  2.65199867e+00]
 [ 2.48108232e-02 -7.03335786e-02  4.21047501e-03]
 [ 8.53180788e-02  8.98923917e-02 -7.00252509e-02]
 [-6.62979755e-02 -2.04989668e-02 -6.34787440e-02]
 [-2.82459827e-01 -1.82663808e+00 -1.99327490e-01]
 [ 1.07846850e-02  2.45241638e-02 -4.15894724e-04]
 [-3.24512373e-02  1.69066042e-01  1.11922313e-01]
 [ 2.23792534e-02  4.22024241e-02 -1.79734357e-02]
 [ 3.82232367e-02 -3.94545567e-02  1.11231396e-02]
 [-7.95331277e-03 -1.10066965e-01 -1.09477931e-01]
 [-1.65993590e-01  2.31635737e-02  4.84338717e-02]
 [ 7.35943635e-02  2.13861568e-03 -2.18232886e-02]
 [ 1.84210855e-02 -4.71861521e-02  2.51028366e-01]
 [-2.04090860e-01 -1.38179578e-01 -7.44898812e-02]
 [-1.71066152e-01  1.35714108e-01  2.21936902e-01]
 [ 1.17909134e-01  6.10583107e-02  1.55210385e-01]
 [-1.55616907e-01  1.22114360e-01 -2.48573404e-02]
 [ 7.00687731e-02 -1.65003771e-02 -6.08719556e-02]
 [-7.46601042e-02  6.09430181e-03 -3.42161272e-02]
 [-9.43551160e-02 -1.22717934e-02  4.99248277e-02]
 [-4.03964568e-02 -2.51019163e-02 -7.04871181e-03]
 [-9.50197428e-02  3.13985257e-02  4.58577139e-02]
 [-1.11270773e-01 -6.31627371e-02 -7.41897247e-02]
 [ 1.54291034e+00  1.00864201e+00  1.39521024e-01]
 [ 6.90987171e-02 -1.10986755e-01  4.21626428e-02]
 [ 3.07402147e-02 -1.50535163e-02 -3.34468315e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.90038089]
curr_Stock_Price:  100.4766070704865
curr_Factors:  [100.47660707  -1.23081911  -0.99155344]
mat_Sqrt:  [[10.88681454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00779473 -0.00640879 -0.48504821]
Stock Position:  0.007794734804830461
Bond Position:  [5.11719238]


portfolio before change:  [5.90168689]
curr_Stock_Price:  100.56208926003166
curr_Factors:  [100.56208926  -1.31973436  -1.01547551]
mat_Sqrt:  [[ 9.73342142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.15465267 0.0849341  1.18381128]
Stock Position:  0.154652673703557
Bond Position:  [-9.65050909]


portfolio before change:  [5.84472345]
curr_Stock_Price:  100.2015584487237
curr_Factors:  [100.20155845  -1.26447129  -1.01308982]
mat_Sqrt:  [[10.2740637   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02233627 -0.03573864  0.10282826]
Stock Position:  -0.022336268246246616
Bond Position:  [8.08285234]


portfolio before change:  [5.84690112]
curr_Stock_Price:  100.14930009013824
curr_Factors:  [100.14930009  -1.51220022  -1.00916376]
mat_Sqrt:  [[ 8.04698982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08199165 0.44348648 3.02679433]
Stock Position:  0.08199164929196469
Bond Position:  [-2.36450517]


portfolio before change:  [5.80850562]
curr_Stock_Price:  99.68461954206174
curr_Factors:  [99.68461954 -1.39320383 -0.98887752]
mat_Sqrt:  [[ 9.20668681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00636994 -0.01106097 -0.05874131]
Stock Position:  -0.0063699354746577395
Bond Position:  [6.44349021]


portfolio before change:  [5.81039814]
curr_Stock_Price:  99.51396850089417
curr_Factors:  [99.5139685  -1.62961992 -0.99401142]
mat_Sqrt:  [[ 7.21864077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00449153 -0.02339495  0.20574241]
Stock Position:  0.004491530600474296
Bond Position:  [5.36342811]


portfolio before change:  [5.81117523]
curr_Stock_Price:  99.5377069048661
curr_Factors:  [99.5377069  -1.6940873  -0.99673013]
mat_Sqrt:  [[ 6.75119218  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01026431  0.07360788  0.25144681]
Stock Position:  -0.010264314453564337
Bond Position:  [6.83286156]


portfolio before change:  [5.81214243]
curr_Stock_Price:  99.52669431088873
curr_Factors:  [99.52669431 -1.47790747 -0.97569738]
mat_Sqrt:  [[ 8.55761083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0012675  0.03540602 0.02857195]
Stock Position:  0.0012675037027255038
Bond Position:  [5.68599198]


portfolio before change:  [5.81272754]
curr_Stock_Price:  99.42753982197966
curr_Factors:  [99.42753982 -1.16225249 -0.98781279]
mat_Sqrt:  [[11.58097722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0022981   0.0173263  -0.12794591]
Stock Position:  0.0022980956728655064
Bond Position:  [5.58423355]


portfolio before change:  [5.81333077]
curr_Stock_Price:  99.38626880949954
curr_Factors:  [99.38626881 -0.85893427 -0.97250544]
mat_Sqrt:  [[15.91996929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00581087 -0.0126953  -0.01191973]
Stock Position:  -0.005810870470899353
Bond Position:  [6.39085151]


portfolio before change:  [5.82463152]
curr_Stock_Price:  97.57899432576767
curr_Factors:  [97.57899433 -0.82562189 -0.99081199]
mat_Sqrt:  [[15.86679188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06595317  0.51311784 -0.69099026]
Stock Position:  0.06595317271400203
Bond Position:  [-0.61101275]


portfolio before change:  [5.8470591]
curr_Stock_Price:  97.92020557674277
curr_Factors:  [97.92020558 -0.9973788  -0.98247953]
mat_Sqrt:  [[13.52168366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00118716 0.00825482 0.16282343]
Stock Position:  0.0011871640422724738
Bond Position:  [5.73081175]


portfolio before change:  [5.84766801]
curr_Stock_Price:  97.82966557599659
curr_Factors:  [97.82966558 -0.82665103 -0.96510553]
mat_Sqrt:  [[16.3049918   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03994759 -0.00342741 -2.74647204]
Stock Position:  -0.03994758978421027
Bond Position:  [9.75572736]


portfolio before change:  [5.86040309]
curr_Stock_Price:  97.54139953436831
curr_Factors:  [97.54139953 -0.83410184 -0.96170222]
mat_Sqrt:  [[16.19128032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11632426 -1.00955892  7.56541404]
Stock Position:  0.11632426155874735
Bond Position:  [-5.48602819]


portfolio before change:  [5.80615862]
curr_Stock_Price:  97.08097393490685
curr_Factors:  [97.08097393 -0.6482296  -0.93727885]
mat_Sqrt:  [[19.88641754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056891 -0.02270006  0.01201131]
Stock Position:  0.0005689059448338655
Bond Position:  [5.75092868]


portfolio before change:  [5.80793784]
curr_Stock_Price:  98.94474307271616
curr_Factors:  [98.94474307 -0.63855454 -0.94968247]
mat_Sqrt:  [[20.2129711   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00442159  0.02901264 -0.19976255]
Stock Position:  0.0044215885658682235
Bond Position:  [5.3704449]


portfolio before change:  [5.81416067]
curr_Stock_Price:  100.20028272541597
curr_Factors:  [100.20028273  -0.32247447  -0.95066238]
mat_Sqrt:  [[28.05127724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297455 -0.00661601 -0.18108719]
Stock Position:  -0.0029745474052625133
Bond Position:  [6.11221116]


portfolio before change:  [5.81776574]
curr_Stock_Price:  99.24518170169377
curr_Factors:  [99.2451817  -0.372935   -0.97221125]
mat_Sqrt:  [[25.85352941  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02692121 -0.58954491 -0.56862585]
Stock Position:  -0.02692121088019041
Bond Position:  [8.4895662]


portfolio before change:  [5.81560799]
curr_Stock_Price:  99.3647530510933
curr_Factors:  [99.36475305 -0.37111648 -0.99634355]
mat_Sqrt:  [[25.31348907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00062045  0.00791514 -0.00118643]
Stock Position:  0.0006204504159739743
Bond Position:  [5.75395709]


portfolio before change:  [5.81489116]
curr_Stock_Price:  97.05009966765294
curr_Factors:  [97.05009967 -0.3437247  -0.97594416]
mat_Sqrt:  [[25.93409411  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00096033 0.05456583 0.31928321]
Stock Position:  0.0009603293029517553
Bond Position:  [5.7216911]


portfolio before change:  [5.8150399]
curr_Stock_Price:  96.46018230170999
curr_Factors:  [96.4601823  -0.22579112 -0.99058314]
mat_Sqrt:  [[28.58139682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00095604  0.01362077 -0.05127321]
Stock Position:  0.0009560405717385674
Bond Position:  [5.72282005]


portfolio before change:  [5.81327667]
curr_Stock_Price:  93.86759022970764
curr_Factors:  [93.86759023 -0.17992724 -1.02798545]
mat_Sqrt:  [[28.04954711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115653 -0.0127339   0.03173122]
Stock Position:  0.0011565288482606084
Bond Position:  [5.7047161]


portfolio before change:  [5.81501309]
curr_Stock_Price:  94.75237644682262
curr_Factors:  [94.75237645 -0.48151853 -1.06441918]
mat_Sqrt:  [[20.19286277  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261319 -0.03552396 -0.31231007]
Stock Position:  -0.0026131870329741667
Bond Position:  [6.06261877]


portfolio before change:  [5.81283305]
curr_Stock_Price:  95.8766408328121
curr_Factors:  [95.87664083 -0.64532451 -1.06537441]
mat_Sqrt:  [[17.32868897  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00873573  0.00747601  0.13816835]
Stock Position:  -0.00873573431569078
Bond Position:  [6.65038591]


portfolio before change:  [5.80014735]
curr_Stock_Price:  97.42396924975732
curr_Factors:  [97.42396925 -0.68961631 -1.06858818]
mat_Sqrt:  [[16.79141566  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00414356  0.00069024 -0.06225577]
Stock Position:  0.0041435604907394145
Bond Position:  [5.39646524]


portfolio before change:  [5.79364767]
curr_Stock_Price:  95.69254046083863
curr_Factors:  [95.69254046 -0.73017978 -1.04687846]
mat_Sqrt:  [[16.18495489  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00370901 -0.01522927  0.71611406]
Stock Position:  0.0037090127021994347
Bond Position:  [5.43872282]


portfolio before change:  [5.79579241]
curr_Stock_Price:  96.08748513102812
curr_Factors:  [96.08748513 -0.69822464 -1.03434019]
mat_Sqrt:  [[16.99117764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01456649 -0.04459727 -0.2124989 ]
Stock Position:  -0.014566490751288316
Bond Position:  [7.19544987]


portfolio before change:  [5.80071094]
curr_Stock_Price:  95.81157488705705
curr_Factors:  [95.81157489 -0.84025833 -1.04986973]
mat_Sqrt:  [[14.47257437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00677564  0.04380154  0.63312421]
Stock Position:  -0.006775639382496285
Bond Position:  [6.44989562]


portfolio before change:  [5.80478343]
curr_Stock_Price:  95.32952349485697
curr_Factors:  [95.32952349 -0.99333408 -1.0638358 ]
mat_Sqrt:  [[12.1845612   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01330001 0.01970649 0.44277203]
Stock Position:  0.01330001087228636
Bond Position:  [4.53689973]


portfolio before change:  [5.81193888]
curr_Stock_Price:  95.82488429033292
curr_Factors:  [95.82488429 -1.13863558 -1.06591815]
mat_Sqrt:  [[10.56945955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01284497  0.03941224 -0.07091107]
Stock Position:  -0.012844970942942258
Bond Position:  [7.04280674]


portfolio before change:  [5.81115077]
curr_Stock_Price:  95.95478092264686
curr_Factors:  [95.95478092 -1.22815591 -1.05647923]
mat_Sqrt:  [[ 9.76927159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00555571 -0.00532547 -0.17365075]
Stock Position:  0.00555570713050207
Bond Position:  [5.27805411]


portfolio before change:  [5.81785829]
curr_Stock_Price:  97.0433414939518
curr_Factors:  [97.04334149 -1.20402094 -1.04951388]
mat_Sqrt:  [[10.19220157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00788843  0.00196693 -0.09760909]
Stock Position:  -0.007888427952468727
Bond Position:  [6.5833777]


portfolio before change:  [5.8151443]
curr_Stock_Price:  97.49171493343407
curr_Factors:  [97.49171493 -1.2038859  -1.05497841]
mat_Sqrt:  [[10.18486809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00850961 -0.0039607   0.14242164]
Stock Position:  -0.008509606788493348
Bond Position:  [6.64476046]


portfolio before change:  [5.8172601]
curr_Stock_Price:  97.34069143082905
curr_Factors:  [97.34069143 -0.98396184 -1.05716389]
mat_Sqrt:  [[12.64284421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371429 -0.00810161 -0.02010801]
Stock Position:  -0.0037142889309294534
Bond Position:  [6.17881155]


portfolio before change:  [5.81914702]
curr_Stock_Price:  97.04062799143675
curr_Factors:  [97.04062799 -0.85038836 -1.05401952]
mat_Sqrt:  [[14.4503965   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00548427  0.01013383  0.13081929]
Stock Position:  -0.005484270204198879
Bond Position:  [6.35134405]


portfolio before change:  [5.82181744]
curr_Stock_Price:  96.698477037706
curr_Factors:  [96.69847704 -1.11811001 -1.06043244]
mat_Sqrt:  [[10.94688782  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01272578 -0.02038569 -0.21164263]
Stock Position:  -0.01272578376948352
Bond Position:  [7.05238135]


portfolio before change:  [5.82896472]
curr_Stock_Price:  96.20611613982936
curr_Factors:  [96.20611614 -0.97579579 -1.06912875]
mat_Sqrt:  [[12.44810499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.142775   0.32553781 0.39801465]
Stock Position:  0.14277499550314426
Bond Position:  [-7.90686308]


portfolio before change:  [5.74547689]
curr_Stock_Price:  95.62828796941574
curr_Factors:  [95.62828797 -1.02560146 -1.0505159 ]
mat_Sqrt:  [[11.99333784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00459005 -0.03582082  0.12027828]
Stock Position:  0.004590052812762376
Bond Position:  [5.30653799]


portfolio before change:  [5.74360939]
curr_Stock_Price:  95.07690861990253
curr_Factors:  [95.07690862 -0.84578939 -1.04066382]
mat_Sqrt:  [[14.41447518  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144578 -0.0048585  -0.0954145 ]
Stock Position:  0.0014457774130364287
Bond Position:  [5.60614934]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.74668253]
Stock Price:  96.71778105847542
PL:  [5.74668253]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.80596496e-01 -1.10476906e-02 -2.58492368e-01]
 [ 1.82506742e+00  3.98548655e-01  6.32792415e-01]
 [ 1.29690584e-01  2.39773832e-01  4.29973334e-02]
 [ 3.38411461e-02  2.41551640e-01  2.15168157e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.00252390e-02 -2.99536858e-02  2.76059763e-02]
 [-4.05089773e-02 -6.56824082e-02 -3.54998565e-02]
 [-4.53429699e-03  2.32469427e-01 -3.27002623e-02]
 [ 1.35733709e-02  6.58446731e-02 -4.66980491e-02]
 [-1.01805207e-01 -5.06229834e-02 -1.67433811e-02]
 [ 8.52330462e-01  1.68501209e+00 -2.85110852e-01]
 [-7.09702366e-04  1.40553664e-02  4.67032001e-02]
 [-3.00254112e-01  2.27508468e-04 -6.38897186e-01]
 [ 1.76563602e+00 -3.19748682e+00  2.69001306e+00]
 [ 1.18900985e-02 -9.09351588e-02  3.49803549e-02]
 [ 8.75111043e-02  8.31661023e-02 -6.63728324e-02]
 [-2.56640149e-02  8.57252900e-02 -8.33455921e-02]
 [-2.86311484e-01 -1.83715523e+00 -1.95203250e-01]
 [ 1.84317061e-02 -9.20478356e-03  1.32228444e-02]
 [ 1.35088780e-01  1.43472676e-01  3.31012742e-01]
 [ 3.30325680e-02 -5.26226674e-02  7.12620282e-02]
 [ 1.00885501e-01 -4.97652496e-02  1.82006414e-02]
 [ 3.82891133e-02  8.97185336e-02  5.91924245e-02]
 [-5.10205955e-02 -5.57538390e-02  4.52877489e-02]
 [ 2.88106706e-03 -1.15647414e-01  3.48724406e-02]
 [ 3.45443747e-02 -1.23993919e-02  2.38968886e-01]
 [ 8.30090963e-02 -1.09475000e-01  3.76550930e-02]
 [-5.06089705e-02 -1.22078438e-02  6.38989595e-02]
 [-4.41147499e-03 -7.00012317e-02  5.41038450e-03]
 [ 3.25488854e-02  2.59271725e-02  6.71384633e-02]
 [-1.12472734e-02 -1.78542561e-02 -6.79710328e-02]
 [-3.60664344e-02  2.29146052e-02 -4.99241864e-02]
 [-1.16795830e-01 -3.86864898e-02  2.19626054e-02]
 [ 2.26620307e-01  7.39790199e-03  3.86921405e-02]
 [-8.36080804e-02 -1.93899265e-02  4.93724654e-02]
 [-1.17717125e-01 -6.76121793e-02 -8.17081062e-02]
 [ 2.21401923e+00  1.43473875e+00  1.66852776e-01]
 [-6.25450124e-03 -1.61731599e-01 -6.13723636e-02]
 [ 3.37070903e-02 -1.36836220e-02 -8.13581611e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.38433099]
curr_Stock_Price:  101.36141727208216
curr_Factors:  [101.36141727  -1.35380525  -0.98837236]
mat_Sqrt:  [[ 9.74266707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01288937 -0.00356563 -0.73740678]
Stock Position:  0.01288937219383839
Bond Position:  [11.07784596]


portfolio before change:  [12.39194512]
curr_Stock_Price:  101.84470802275816
curr_Factors:  [101.84470802  -1.1514666   -1.0034411 ]
mat_Sqrt:  [[11.80521617  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.17243132 0.12863103 1.80518063]
Stock Position:  0.17243132194665556
Bond Position:  [-5.16927252]


portfolio before change:  [12.64143104]
curr_Stock_Price:  103.29532679972846
curr_Factors:  [103.2953268   -1.15745864  -1.00077338]
mat_Sqrt:  [[11.93362585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01570445 0.07738667 0.12265942]
Stock Position:  0.01570444799350483
Bond Position:  [11.01923495]


portfolio before change:  [12.63782124]
curr_Stock_Price:  102.97775533055591
curr_Factors:  [102.97775533  -1.09898697  -0.9876195 ]
mat_Sqrt:  [[12.78032051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00994253 0.07796046 0.61381486]
Stock Position:  0.00994252721508359
Bond Position:  [11.61396211]


portfolio before change:  [12.63537477]
curr_Stock_Price:  102.58567127159357
curr_Factors:  [102.58567127  -1.1776533   -0.98441837]
mat_Sqrt:  [[11.80622105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00496738 -0.01106097 -0.05874131]
Stock Position:  -0.004967381236748464
Bond Position:  [13.14495691]


portfolio before change:  [12.64313163]
curr_Stock_Price:  101.35491403671601
curr_Factors:  [101.35491404  -0.8898295   -1.00195988]
mat_Sqrt:  [[15.28449589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00389584 -0.00966751  0.07875217]
Stock Position:  0.0038958442087060705
Bond Position:  [12.24826868]


portfolio before change:  [12.64549628]
curr_Stock_Price:  101.56886352439616
curr_Factors:  [101.56886352  -1.04103837  -1.01517441]
mat_Sqrt:  [[12.99447482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00470683 -0.02119891 -0.10127121]
Stock Position:  -0.004706825127964626
Bond Position:  [13.12356316]


portfolio before change:  [12.65253457]
curr_Stock_Price:  100.42207261789976
curr_Factors:  [100.42207262  -0.98439293  -1.03114305]
mat_Sqrt:  [[13.38113724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00270855  0.07502919 -0.09328475]
Stock Position:  0.0027085450538664618
Bond Position:  [12.38053686]


portfolio before change:  [12.65390434]
curr_Stock_Price:  100.35639308276006
curr_Factors:  [100.35639308  -0.92163605  -1.02996998]
mat_Sqrt:  [[14.25519987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122634  0.02125128 -0.13321654]
Stock Position:  0.001226335601388293
Bond Position:  [12.53083372]


portfolio before change:  [12.65570228]
curr_Stock_Price:  100.54515727536464
curr_Factors:  [100.54515728  -0.79074258  -1.02249389]
mat_Sqrt:  [[16.40146204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00704549 -0.0163385  -0.04776421]
Stock Position:  -0.007045488308375618
Bond Position:  [13.36409201]


portfolio before change:  [12.66859406]
curr_Stock_Price:  98.95248269024245
curr_Factors:  [98.95248269 -0.84437374 -1.02567958]
mat_Sqrt:  [[15.2501059   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07462795  0.54383531 -0.8133419 ]
Stock Position:  0.07462794772527986
Bond Position:  [5.28397336]


portfolio before change:  [12.69606185]
curr_Stock_Price:  99.31169464896277
curr_Factors:  [99.31169465 -0.73231484 -1.00381541]
mat_Sqrt:  [[17.49881365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00066819 0.00453635 0.13323123]
Stock Position:  0.0006681931880923525
Bond Position:  [12.62970245]


portfolio before change:  [12.69799109]
curr_Stock_Price:  99.83613746397177
curr_Factors:  [99.83613746 -0.86968018 -1.01594188]
mat_Sqrt:  [[15.14860065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.84265210e-02  7.34280423e-05 -1.82259584e+00]
Stock Position:  -0.028426520985534432
Bond Position:  [15.53598515]


portfolio before change:  [12.68856445]
curr_Stock_Price:  100.23607237841908
curr_Factors:  [100.23607238  -0.91534678  -0.98643006]
mat_Sqrt:  [[14.96555589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11105825 -1.03198443  7.67385851]
Stock Position:  0.11105824532579055
Bond Position:  [1.55652214]


portfolio before change:  [12.66969121]
curr_Stock_Price:  100.06438027677522
curr_Factors:  [100.06438028  -0.90896799  -0.97348949]
mat_Sqrt:  [[15.23135761  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.07505054e-05 -2.93491963e-02  9.97892159e-02]
Stock Position:  3.075050535392519e-05
Bond Position:  [12.66661418]


portfolio before change:  [12.67124214]
curr_Stock_Price:  99.00762717628017
curr_Factors:  [99.00762718 -0.7730379  -0.98700835]
mat_Sqrt:  [[17.03296587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.005339    0.02684174 -0.18934322]
Stock Position:  0.005339000668929688
Bond Position:  [12.14264035]


portfolio before change:  [12.67136846]
curr_Stock_Price:  98.74697943644702
curr_Factors:  [98.74697944 -0.70429112 -0.97619664]
mat_Sqrt:  [[18.39489274  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136876  0.02766772 -0.23776178]
Stock Position:  -0.0013687636814232811
Bond Position:  [12.80652974]


portfolio before change:  [12.67439567]
curr_Stock_Price:  97.70495486439704
curr_Factors:  [97.70495486 -0.96966427 -0.96360785]
mat_Sqrt:  [[14.13536978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04960358 -0.5929393  -0.55686054]
Stock Position:  -0.04960357830252617
Bond Position:  [17.52091105]


portfolio before change:  [12.65500161]
curr_Stock_Price:  98.14009085681927
curr_Factors:  [98.14009086 -0.73066119 -0.97396789]
mat_Sqrt:  [[17.84577658  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107879 -0.00297083  0.03772109]
Stock Position:  0.001078792467317794
Bond Position:  [12.54912882]


portfolio before change:  [12.65768844]
curr_Stock_Price:  99.17651225534307
curr_Factors:  [99.17651226 -0.82843265 -0.97968764]
mat_Sqrt:  [[16.2611842   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01426358 0.04630561 0.94428722]
Stock Position:  0.014263580540472139
Bond Position:  [11.24307627]


portfolio before change:  [12.6589222]
curr_Stock_Price:  99.16447355472471
curr_Factors:  [99.16447355 -0.81597326 -0.97129814]
mat_Sqrt:  [[16.60175503  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00221888 -0.01698389  0.20329073]
Stock Position:  0.0022188805666401522
Bond Position:  [12.43888807]


portfolio before change:  [12.66116043]
curr_Stock_Price:  99.47240970897694
curr_Factors:  [99.47240971 -0.80427638 -0.93934304]
mat_Sqrt:  [[17.39635834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00542886 -0.01606167  0.05192136]
Stock Position:  0.00542886050368736
Bond Position:  [12.12113859]


portfolio before change:  [12.66710955]
curr_Stock_Price:  100.28913466109016
curr_Factors:  [100.28913466  -0.95970673  -0.9540776 ]
mat_Sqrt:  [[14.79475955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00464255 0.02895653 0.16885951]
Stock Position:  0.004642551647371278
Bond Position:  [12.20151206]


portfolio before change:  [12.66744221]
curr_Stock_Price:  100.03224434628673
curr_Factors:  [100.03224435  -1.04286157  -0.97341939]
mat_Sqrt:  [[13.31926684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00399098 -0.01799447  0.12919334]
Stock Position:  -0.003990983724599785
Bond Position:  [13.06666927]


portfolio before change:  [12.66570936]
curr_Stock_Price:  100.87571671768313
curr_Factors:  [100.87571672  -0.96027547  -0.96506137]
mat_Sqrt:  [[14.71036567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.000925   -0.03732504  0.09948137]
Stock Position:  -0.0009249977703373039
Bond Position:  [12.75901917]


portfolio before change:  [12.6682692]
curr_Stock_Price:  99.83261337813919
curr_Factors:  [99.83261338 -0.80430735 -0.96060673]
mat_Sqrt:  [[17.09149278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00472707 -0.00400189  0.68171172]
Stock Position:  0.004727069787084622
Bond Position:  [12.19635347]


portfolio before change:  [12.66672076]
curr_Stock_Price:  99.18250932483896
curr_Factors:  [99.18250932 -0.83994201 -0.96205801]
mat_Sqrt:  [[16.36200136  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0041773 -0.0353329  0.1074195]
Stock Position:  0.004177295774976381
Bond Position:  [12.25240608]


portfolio before change:  [12.66909704]
curr_Stock_Price:  99.38470730343417
curr_Factors:  [99.3847073  -0.99077719 -0.96009988]
mat_Sqrt:  [[14.12747069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283544 -0.00394006  0.18228595]
Stock Position:  -0.0028354378881317926
Bond Position:  [12.95089621]


portfolio before change:  [12.66822697]
curr_Stock_Price:  100.26253901840072
curr_Factors:  [100.26253902  -0.93777611  -0.95969726]
mat_Sqrt:  [[15.03406706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00117041 -0.0225928   0.01543432]
Stock Position:  -0.0011704102689774878
Bond Position:  [12.78557527]


portfolio before change:  [12.6693247]
curr_Stock_Price:  100.69022239961488
curr_Factors:  [100.6902224   -1.12698601  -0.94381575]
mat_Sqrt:  [[12.69549153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00406017 0.00836796 0.19152735]
Stock Position:  0.0040601680245927136
Bond Position:  [12.26050548]


portfolio before change:  [12.67010935]
curr_Stock_Price:  100.50599093992555
curr_Factors:  [100.50599094  -1.19164869  -0.95650443]
mat_Sqrt:  [[11.72899782  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245258 -0.00576244 -0.19390244]
Stock Position:  -0.002452578437693143
Bond Position:  [12.91660818]


portfolio before change:  [12.67035757]
curr_Stock_Price:  101.06314213152989
curr_Factors:  [101.06314213  -0.98881597  -0.97723073]
mat_Sqrt:  [[14.14977594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293854  0.00739566 -0.14241981]
Stock Position:  -0.0029385442023352215
Bond Position:  [12.96733608]


portfolio before change:  [12.67093438]
curr_Stock_Price:  101.4184917884971
curr_Factors:  [101.41849179  -0.85276331  -0.94880252]
mat_Sqrt:  [[16.73813443  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00718178 -0.01248601  0.0626532 ]
Stock Position:  -0.007181778755696745
Bond Position:  [13.39929955]


portfolio before change:  [12.6773023]
curr_Stock_Price:  100.7650451974617
curr_Factors:  [100.7650452   -1.01430208  -0.92524276]
mat_Sqrt:  [[14.48692746  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01629251 0.00238766 0.11037791]
Stock Position:  0.01629250908589639
Bond Position:  [11.03558689]


portfolio before change:  [12.67456617]
curr_Stock_Price:  100.51243428789552
curr_Factors:  [100.51243429  -1.13886297  -0.92769456]
mat_Sqrt:  [[12.72697698  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00608848 -0.00625807  0.1408459 ]
Stock Position:  -0.006088478070668256
Bond Position:  [13.28653392]


portfolio before change:  [12.68180091]
curr_Stock_Price:  99.59696424777884
curr_Factors:  [99.59696425 -1.23281879 -0.96572019]
mat_Sqrt:  [[11.05179327  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01340932 -0.02182174 -0.23309048]
Stock Position:  -0.013409317083557921
Bond Position:  [14.01732819]


portfolio before change:  [12.65797329]
curr_Stock_Price:  101.50458514541587
curr_Factors:  [101.50458515  -1.35307867  -0.98279889]
mat_Sqrt:  [[ 9.81808818  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.25880219 0.46305994 0.47598453]
Stock Position:  0.2588021910480489
Bond Position:  [-13.61163574]


portfolio before change:  [12.41404522]
curr_Stock_Price:  100.56863282975985
curr_Factors:  [100.56863283  -1.22467262  -0.96032456]
mat_Sqrt:  [[11.31176374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045789  -0.05219865 -0.17507827]
Stock Position:  -0.004578897512590862
Bond Position:  [12.87453869]


portfolio before change:  [12.41712211]
curr_Stock_Price:  100.24814714473548
curr_Factors:  [100.24814714  -1.26767971  -0.95283189]
mat_Sqrt:  [[10.88229311  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00131468 -0.00441637 -0.23209219]
Stock Position:  0.001314683165379056
Bond Position:  [12.28532756]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.41810326]
Stock Price:  99.82628555743219
PL:  [12.41810326]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 7.33316197e-03 -1.03330368e-01  2.27169630e-02]
 [ 8.54306830e-01  2.11787429e-01  2.41483714e-01]
 [-3.91369121e-01 -2.73776800e-01  4.12123022e-02]
 [ 2.04359717e-01  1.27757113e+00  1.25934982e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 4.15454587e-02 -1.31730975e-02  1.78884300e-02]
 [-3.25132723e-02 -1.17052182e-01 -9.79882221e-05]
 [ 1.21737434e-01  1.09174609e-01 -1.03086806e-01]
 [ 1.76917891e-02  6.13878790e-02 -4.60209481e-02]
 [-3.41087662e-01 -5.86167951e-02 -1.42335258e-01]
 [ 5.83593055e-01  1.14115885e+00 -2.00132008e-01]
 [-1.69356747e-04  1.86151458e-02 -5.78439937e-02]
 [ 1.13769965e-01 -3.39881314e-02  4.53894638e-02]
 [ 1.49521946e+00 -2.89929004e+00  2.49322511e+00]
 [-3.54624274e-03 -9.56344993e-02  3.99310105e-02]
 [ 1.50225266e-01 -1.19267326e-01  3.69093006e-02]
 [-2.38397317e-01 -3.91769947e-01  9.14514602e-04]
 [-2.50822618e-01 -1.65614696e+00 -2.02822727e-01]
 [-3.45525833e-03  3.66990767e-02  1.15402703e-01]
 [ 3.10536467e-01 -4.77455087e-01  2.50122541e-01]
 [ 5.37701542e-02  5.78799844e-02  2.06003857e-02]
 [ 1.62791764e-01 -5.60309671e-02 -2.24188916e-02]
 [ 3.02771389e-01  1.65488528e-01  2.02332532e-01]
 [-1.85518201e-01  3.73778503e-02  4.26822025e-02]
 [-1.71075189e-02 -1.84987933e-01  5.92297545e-02]
 [ 1.09952996e-01 -2.36000647e-02 -8.78661043e-02]
 [ 2.99169511e-01 -4.38886490e-02  1.71112600e-01]
 [-5.83505509e-02  6.11546918e-02  1.05137991e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 3.86726207e-01 -1.34067528e-01 -8.94167938e-02]
 [-8.88638710e-03 -1.30807271e-01  1.04244138e-02]
 [-2.25245051e-01 -6.33537168e-02  1.28678354e-01]
 [-4.03674762e-02  1.15810649e-01 -2.00444484e-01]
 [ 6.47309758e-01  1.31343063e-01  2.15185648e-01]
 [ 2.35289841e-01  5.06375106e-01 -2.78057778e-01]
 [-2.18098805e-01  9.52386620e-02 -8.71245947e-02]
 [ 2.80832570e+00  2.13705346e+00  2.54420192e-01]
 [-8.63295774e-02 -4.82410281e-02 -3.92776821e-03]
 [ 4.03180445e-02 -1.14377322e-02 -2.37850938e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.92931507]
curr_Stock_Price:  99.79824747729397
curr_Factors:  [99.79824748 -1.01386346 -0.98444841]
mat_Sqrt:  [[13.52904359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067425 -0.03334973  0.06480517]
Stock Position:  -0.0006742516809958831
Bond Position:  [0.9966042]


portfolio before change:  [0.92963612]
curr_Stock_Price:  99.50685696100287
curr_Factors:  [99.50685696 -1.11324875 -0.98303206]
mat_Sqrt:  [[12.23065791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07741451 0.0683541  0.68888582]
Stock Position:  0.0774145120461748
Bond Position:  [-6.77363865]


portfolio before change:  [0.88021479]
curr_Stock_Price:  98.87939608785562
curr_Factors:  [98.87939609 -0.7920335  -0.95890654]
mat_Sqrt:  [[17.1665178   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02556378 -0.08836108  0.11756723]
Stock Position:  -0.025563783831972792
Bond Position:  [3.40794629]


portfolio before change:  [0.86808254]
curr_Stock_Price:  99.3706485498854
curr_Factors:  [99.37064855 -0.70826654 -0.96432146]
mat_Sqrt:  [[18.65788398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03870785 0.41233431 3.5925745 ]
Stock Position:  0.03870784802903974
Bond Position:  [-2.97834143]


portfolio before change:  [0.95398242]
curr_Stock_Price:  101.59945245031102
curr_Factors:  [101.59945245  -0.71675604  -0.9849918 ]
mat_Sqrt:  [[18.5281335   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00316524 -0.01106097 -0.05874131]
Stock Position:  -0.0031652406286219255
Bond Position:  [1.27556914]


portfolio before change:  [0.95618505]
curr_Stock_Price:  100.9539506979684
curr_Factors:  [100.9539507   -0.73022241  -0.98882571]
mat_Sqrt:  [[18.09465093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0023492  -0.0042516   0.05103071]
Stock Position:  0.002349200991177524
Bond Position:  [0.71902393]


portfolio before change:  [0.95927624]
curr_Stock_Price:  102.23153916694443
curr_Factors:  [102.23153917  -0.9484128   -0.99005026]
mat_Sqrt:  [[14.71367262  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00383497 -0.03777843 -0.00027953]
Stock Position:  -0.0038349671201002924
Bond Position:  [1.35133083]


portfolio before change:  [0.95866964]
curr_Stock_Price:  102.43376471926534
curr_Factors:  [102.43376472  -0.88675558  -0.97061595]
mat_Sqrt:  [[15.98810267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00769198  0.03523595 -0.29407796]
Stock Position:  0.007691975982135451
Bond Position:  [0.17075158]


portfolio before change:  [0.95653596]
curr_Stock_Price:  102.15359988711391
curr_Factors:  [102.15359989  -0.95898506  -0.95225655]
mat_Sqrt:  [[15.10817455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137863  0.01981285 -0.13128496]
Stock Position:  0.0013786278832552902
Bond Position:  [0.81570416]


portfolio before change:  [0.9569617]
curr_Stock_Price:  102.38844533859798
curr_Factors:  [102.38844534  -0.99209984  -0.94295714]
mat_Sqrt:  [[14.78653386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02584154 -0.01891849 -0.40604287]
Stock Position:  -0.0258415414694143
Bond Position:  [3.60283696]


portfolio before change:  [0.94075238]
curr_Stock_Price:  103.0331320046141
curr_Factors:  [103.033132    -1.09938742  -0.9752283 ]
mat_Sqrt:  [[12.94144409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05993762  0.36830744 -0.57092091]
Stock Position:  0.0599376196978577
Bond Position:  [-5.2348083]


portfolio before change:  [0.97538128]
curr_Stock_Price:  103.62179886692958
curr_Factors:  [103.62179887  -0.91974375  -0.96676004]
mat_Sqrt:  [[15.70915922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052052  0.00600801 -0.16501281]
Stock Position:  -0.0005205187420772449
Bond Position:  [1.02931837]


portfolio before change:  [0.97485351]
curr_Stock_Price:  104.88294439670837
curr_Factors:  [104.8829444   -1.1010606   -0.98354117]
mat_Sqrt:  [[13.04288989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00890119 -0.01096962  0.12948351]
Stock Position:  0.008901190879526231
Bond Position:  [0.0412704]


portfolio before change:  [0.9816669]
curr_Stock_Price:  105.64781210674
curr_Factors:  [105.64781211  -1.08870343  -0.97757   ]
mat_Sqrt:  [[13.38102429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10554736 -0.93574184  7.11247725]
Stock Position:  0.10554736094789148
Bond Position:  [-10.16918086]


portfolio before change:  [0.96744593]
curr_Stock_Price:  105.52512077678432
curr_Factors:  [105.52512078  -0.60286458  -1.00313223]
mat_Sqrt:  [[21.17777384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070435 -0.0308659   0.11391206]
Stock Position:  -0.0007043549469625143
Bond Position:  [1.04177307]


portfolio before change:  [0.96750843]
curr_Stock_Price:  105.62127888032475
curr_Factors:  [105.62127888  -0.9329023   -0.98303079]
mat_Sqrt:  [[15.54791847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00858083 -0.03849336  0.10529196]
Stock Position:  0.008580827394580002
Bond Position:  [0.06119046]


portfolio before change:  [0.96370238]
curr_Stock_Price:  105.17683480834296
curr_Factors:  [105.17683481  -0.84522516  -0.9823541 ]
mat_Sqrt:  [[16.91268302  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01881312 -0.12644321  0.00260886]
Stock Position:  -0.018813120757634885
Bond Position:  [2.94240687]


portfolio before change:  [0.95485591]
curr_Stock_Price:  105.66661471696916
curr_Factors:  [105.66661472  -0.82256545  -0.99024348]
mat_Sqrt:  [[17.24427263  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03655029 -0.53451913 -0.57859679]
Stock Position:  -0.03655029295435495
Bond Position:  [4.81700164]


portfolio before change:  [0.97277297]
curr_Stock_Price:  105.1928869155954
curr_Factors:  [105.19288692  -1.01963636  -0.98428664]
mat_Sqrt:  [[14.18056962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00194579 0.01184458 0.32921179]
Stock Position:  0.0019457883734196424
Bond Position:  [0.76808987]


portfolio before change:  [0.97193698]
curr_Stock_Price:  104.71390033790591
curr_Factors:  [104.71390034  -0.77741046  -0.98619272]
mat_Sqrt:  [[17.95069252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01471433 -0.15409797  0.71352999]
Stock Position:  0.014714329560139789
Bond Position:  [-0.56885786]


portfolio before change:  [0.94362733]
curr_Stock_Price:  102.79478267526456
curr_Factors:  [102.79478268  -0.6731028   -0.98839548]
mat_Sqrt:  [[19.51603291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00357603 0.01868068 0.05876717]
Stock Position:  0.003576028639732045
Bond Position:  [0.57603025]


portfolio before change:  [0.94354486]
curr_Stock_Price:  102.7515842670884
curr_Factors:  [102.75158427  -0.67644119  -0.96685351]
mat_Sqrt:  [[19.86619568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00738834 -0.01808392 -0.06395486]
Stock Position:  0.007388342309336299
Bond Position:  [0.18438099]


portfolio before change:  [0.9395402]
curr_Stock_Price:  102.20643949604175
curr_Factors:  [102.2064395   -0.49263015  -0.95678529]
mat_Sqrt:  [[23.98861261  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01575133 0.05341119 0.5771984 ]
Stock Position:  0.015751329773256502
Bond Position:  [-0.67034714]


portfolio before change:  [0.92523701]
curr_Stock_Price:  101.30369734426166
curr_Factors:  [101.30369734  -0.39292412  -0.93970061]
mat_Sqrt:  [[26.72229346  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00633089  0.01206365  0.12176044]
Stock Position:  -0.006330894126598973
Bond Position:  [1.56657999]


portfolio before change:  [0.92459803]
curr_Stock_Price:  101.43556100721696
curr_Factors:  [101.43556101  -0.49817763  -0.92519529]
mat_Sqrt:  [[24.43583773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175062 -0.0597046   0.168966  ]
Stock Position:  -0.001750617273076036
Bond Position:  [1.10217287]


portfolio before change:  [0.92067755]
curr_Stock_Price:  103.75375028374563
curr_Factors:  [103.75375028  -0.52797525  -0.93976721]
mat_Sqrt:  [[23.90954717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00364708 -0.00761689 -0.25065754]
Stock Position:  0.0036470811977637337
Bond Position:  [0.54227919]


portfolio before change:  [0.91940761]
curr_Stock_Price:  103.38695542951636
curr_Factors:  [103.38695543  -0.53134278  -0.95814543]
mat_Sqrt:  [[23.31252069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01394697 -0.014165    0.48813662]
Stock Position:  0.013946968477835496
Bond Position:  [-0.522527]


portfolio before change:  [0.95704162]
curr_Stock_Price:  106.09000382745438
curr_Factors:  [106.09000383  -0.73717379  -0.96570339]
mat_Sqrt:  [[19.32521352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126292  0.01973759  0.29992942]
Stock Position:  -0.0012629200272046644
Bond Position:  [1.09102481]


portfolio before change:  [0.95716061]
curr_Stock_Price:  106.10377625640066
curr_Factors:  [106.10377626  -0.67400046  -0.95136738]
mat_Sqrt:  [[20.88538844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016461  -0.02600141 -0.03673698]
Stock Position:  -0.0016461010442429173
Bond Position:  [1.13181815]


portfolio before change:  [0.95479569]
curr_Stock_Price:  107.626404943284
curr_Factors:  [107.62640494  -0.58040603  -0.93817344]
mat_Sqrt:  [[23.57263584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01447049 -0.04327011 -0.25508122]
Stock Position:  0.014470492948947372
Bond Position:  [-0.60261144]


portfolio before change:  [0.99337655]
curr_Stock_Price:  110.29778469522098
curr_Factors:  [110.2977847   -0.66407345  -0.93971871]
mat_Sqrt:  [[22.18445203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150824 -0.04221787  0.02973795]
Stock Position:  -0.0015082380581713493
Bond Position:  [1.15973186]


portfolio before change:  [0.99467809]
curr_Stock_Price:  109.53095129893327
curr_Factors:  [109.5309513   -0.78041253  -0.97213264]
mat_Sqrt:  [[18.98524324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01116186 -0.02044732  0.36708353]
Stock Position:  -0.011161864668474313
Bond Position:  [2.21724774]


portfolio before change:  [0.99072452]
curr_Stock_Price:  109.90998642599448
curr_Factors:  [109.90998643  -0.79885657  -0.97147032]
mat_Sqrt:  [[18.71517779  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308003  0.03737773 -0.57181232]
Stock Position:  -0.0030800287366588817
Bond Position:  [1.32925044]


portfolio before change:  [0.99211429]
curr_Stock_Price:  109.51271863653263
curr_Factors:  [109.51271864  -0.51010341  -0.96003412]
mat_Sqrt:  [[25.1763022   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02852066 0.04239079 0.61386476]
Stock Position:  0.028520655220108423
Bond Position:  [-2.1312602]


portfolio before change:  [1.06402139]
curr_Stock_Price:  112.04328895894972
curr_Factors:  [112.04328896  -0.74134163  -0.95353322]
mat_Sqrt:  [[20.57363603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01370175  0.16343186 -0.79322144]
Stock Position:  0.013701754984124114
Bond Position:  [-0.47116831]


portfolio before change:  [1.06733092]
curr_Stock_Price:  112.28912848617506
curr_Factors:  [112.28912849  -0.60261209  -0.97964258]
mat_Sqrt:  [[23.07667532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00937928  0.03073815 -0.24854222]
Stock Position:  -0.009379276894040292
Bond Position:  [2.12052175]


portfolio before change:  [1.06569824]
curr_Stock_Price:  112.49146419342209
curr_Factors:  [112.49146419  -0.58944513  -0.98023067]
mat_Sqrt:  [[23.41089582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.14080979 0.68973104 0.72578999]
Stock Position:  0.14080978556625012
Bond Position:  [-14.77420071]


portfolio before change:  [0.72600103]
curr_Stock_Price:  110.09212583162491
curr_Factors:  [110.09212583  -0.73127137  -0.94528509]
mat_Sqrt:  [[20.58908452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00471019 -0.01556972 -0.01120483]
Stock Position:  -0.004710189433509511
Bond Position:  [1.24455579]


portfolio before change:  [0.7274019]
curr_Stock_Price:  109.82774336178632
curr_Factors:  [109.82774336  -0.95632273  -0.94344717]
mat_Sqrt:  [[16.43056404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.43178910e-04 -3.69151221e-03 -6.78522521e-01]
Stock Position:  -0.0006431789097586235
Bond Position:  [0.79804079]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.72693393]
Stock Price:  110.7104329517225
PL:  [-9.98349902]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.04924039e-01 -1.95884561e-02  1.91976056e-03]
 [ 1.10888946e+00  2.25275644e-01  3.16585348e-01]
 [-1.65286043e-01 -6.56719945e-02  3.46177811e-02]
 [ 1.05499882e-01  9.35856072e-01  6.93713166e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.47167424e-02 -2.56157857e-02  2.90996856e-02]
 [-3.21888650e-02 -1.19266517e-01  2.13006366e-03]
 [ 1.96439630e-01  2.33794122e-02 -1.88157738e-01]
 [ 1.38143466e-02  6.55838984e-02 -4.66584308e-02]
 [-3.58670509e-01 -4.54769275e-02 -1.47677760e-01]
 [ 6.90469694e-01  1.33666758e+00 -2.39163690e-01]
 [-2.20529035e-04  3.24236886e-02 -5.82984196e-02]
 [-1.87633086e-01 -1.05528584e-02 -4.10151483e-01]
 [ 1.78484544e+00 -3.43775709e+00  2.88753300e+00]
 [ 9.16296877e-03 -9.13948861e-02  3.52631340e-02]
 [ 1.16684196e-01 -3.97451889e-02 -5.19132108e-03]
 [-8.57527387e-02 -5.66171355e-02 -4.88831075e-02]
 [-2.63682297e-01 -1.71024419e+00 -1.95910280e-01]
 [-2.48313339e-02  1.10486624e-01  3.05190453e-01]
 [ 3.15030172e-01  6.20323552e-02  6.32956400e-01]
 [ 9.40582608e-02 -4.27970859e-01 -1.14368626e-01]
 [ 1.48124434e-01 -5.44160492e-02 -1.67210487e-02]
 [ 7.08570275e-02  1.86665812e-01  1.19415505e-01]
 [ 1.49372916e-01 -2.36305659e-01 -9.79982851e-02]
 [-2.39768832e-02 -1.35476178e-01  5.05120977e-02]
 [ 5.58494845e-02 -1.34632144e-02  2.87807271e-02]
 [ 5.66509094e-01 -6.68279736e-02  3.11359177e-01]
 [ 2.76399958e-02 -1.07846105e-01 -4.32866530e-03]
 [-1.01898059e-02 -7.56027391e-02 -4.28945822e-03]
 [ 1.25179655e-01 -4.78990425e-02  8.94298725e-02]
 [-1.34518577e-02 -4.09565145e-02 -5.09341569e-02]
 [-3.45231349e-02  2.42705404e-02 -5.07632028e-02]
 [-3.51080613e-02 -4.51237492e-02 -7.16976958e-03]
 [ 2.40840800e-01  1.99003221e-02  4.91126815e-02]
 [-1.05201829e-01  6.30726931e-03  3.90771217e-02]
 [-1.10539856e-01 -4.81993771e-02 -1.00940843e-01]
 [ 2.83929661e+00  1.84475795e+00  1.94856873e-01]
 [-2.26099780e-02 -7.60478604e-02 -3.60790174e-02]
 [ 3.29230578e-02 -1.38427260e-02 -6.56613429e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.50976109]
curr_Stock_Price:  100.96914886510756
curr_Factors:  [100.96914887  -1.04299826  -1.0210238 ]
mat_Sqrt:  [[12.81726329  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00790476 -0.00632215  0.00547654]
Stock Position:  0.007904763233199132
Bond Position:  [8.71162387]


portfolio before change:  [9.50396286]
curr_Stock_Price:  100.0978713059703
curr_Factors:  [100.09787131  -1.17614236  -1.02570468]
mat_Sqrt:  [[11.07069336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11015537 0.0727074  0.90312988]
Stock Position:  0.11015537469672278
Bond Position:  [-1.52235566]


portfolio before change:  [9.56482363]
curr_Stock_Price:  100.6520981864855
curr_Factors:  [100.65209819  -1.19610042  -1.0342606 ]
mat_Sqrt:  [[10.81905549  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01586321 -0.02119555  0.09875489]
Stock Position:  -0.015863210764840013
Bond Position:  [11.16148907]


portfolio before change:  [9.55557356]
curr_Stock_Price:  101.3231692690179
curr_Factors:  [101.32316927  -1.26529674  -1.02831313]
mat_Sqrt:  [[10.22366605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04285491 0.30204625 1.97897057]
Stock Position:  0.0428549120237486
Bond Position:  [5.21337805]


portfolio before change:  [9.55454275]
curr_Stock_Price:  101.28390839928929
curr_Factors:  [101.2839084   -0.80362241  -1.00131437]
mat_Sqrt:  [[16.65966901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00352024 -0.01106097 -0.05874131]
Stock Position:  -0.0035202380604149697
Bond Position:  [9.91108622]


portfolio before change:  [9.55473271]
curr_Stock_Price:  101.58190005245838
curr_Factors:  [101.58190005  -0.89975984  -1.01793065]
mat_Sqrt:  [[14.92704818  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00438318 -0.00826746  0.0830133 ]
Stock Position:  0.004383176748756073
Bond Position:  [9.10948129]


portfolio before change:  [9.55911529]
curr_Stock_Price:  102.32196152365404
curr_Factors:  [102.32196152  -0.93589378  -1.02297238]
mat_Sqrt:  [[14.42926116  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00388788 -0.0384931   0.00607648]
Stock Position:  -0.003887880524681791
Bond Position:  [9.95693085]


portfolio before change:  [9.5564975]
curr_Stock_Price:  103.31542973354792
curr_Factors:  [103.31542973  -1.19741954  -0.99869843]
mat_Sqrt:  [[11.49220252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01416651  0.00754567 -0.53676165]
Stock Position:  0.014166509398819688
Bond Position:  [8.09287849]


portfolio before change:  [9.53698066]
curr_Stock_Price:  101.86634246895163
curr_Factors:  [101.86634247  -1.00632902  -0.98385377]
mat_Sqrt:  [[13.92211795  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00126974  0.02116711 -0.13310352]
Stock Position:  0.0012697415388216692
Bond Position:  [9.40763674]


portfolio before change:  [9.53871187]
curr_Stock_Price:  102.30358275381164
curr_Factors:  [102.30358275  -1.2040943   -0.99868927]
mat_Sqrt:  [[11.30405056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03521729 -0.01467762 -0.42128355]
Stock Position:  -0.03521729160101314
Bond Position:  [13.14156698]


portfolio before change:  [9.5507513]
curr_Stock_Price:  102.00836894128587
curr_Factors:  [102.00836894  -1.13827723  -0.98917552]
mat_Sqrt:  [[12.15331666  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07524668  0.43140761 -0.68226744]
Stock Position:  0.07524668063827225
Bond Position:  [1.87496014]


portfolio before change:  [9.51348051]
curr_Stock_Price:  101.50993923519326
curr_Factors:  [101.50993924  -1.19661995  -0.96886261]
mat_Sqrt:  [[11.64263934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047259  0.0104647  -0.16630916]
Stock Position:  -0.00047258926708611504
Bond Position:  [9.56145301]


portfolio before change:  [9.5143722]
curr_Stock_Price:  102.1522719384542
curr_Factors:  [102.15227194  -1.19583654  -0.94309866]
mat_Sqrt:  [[12.03151395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02273272 -0.00340592 -1.17004802]
Stock Position:  -0.022732716887953565
Bond Position:  [11.83657088]


portfolio before change:  [9.52993709]
curr_Stock_Price:  101.53267035653971
curr_Factors:  [101.53267036  -1.52208624  -0.92587264]
mat_Sqrt:  [[ 8.77951998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.19050374 -1.10953133  8.23732792]
Stock Position:  0.19050374246953297
Bond Position:  [-9.81241659]


portfolio before change:  [9.61117764]
curr_Stock_Price:  101.96556041975411
curr_Factors:  [101.96556042  -1.6369267   -0.9298356 ]
mat_Sqrt:  [[ 7.82929768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00029311 -0.02949757  0.10059591]
Stock Position:  -0.00029311404901816835
Bond Position:  [9.64106518]


portfolio before change:  [9.61251884]
curr_Stock_Price:  101.50160828430135
curr_Factors:  [101.50160828  -1.38836421  -0.94001148]
mat_Sqrt:  [[ 9.89172903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01086883 -0.0128277  -0.01480939]
Stock Position:  0.010868834822043047
Bond Position:  [8.50931463]


portfolio before change:  [9.60976196]
curr_Stock_Price:  101.15008873978016
curr_Factors:  [101.15008874  -1.60937608  -0.90715837]
mat_Sqrt:  [[ 8.16674965  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01313716 -0.0182731  -0.1394499 ]
Stock Position:  -0.01313715863339752
Bond Position:  [10.93858673]


portfolio before change:  [9.60705912]
curr_Stock_Price:  101.45991621483188
curr_Factors:  [101.45991621  -1.70932129  -0.9182729 ]
mat_Sqrt:  [[ 7.33068979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0890468  -0.55197894 -0.5588775 ]
Stock Position:  -0.08904679742300396
Bond Position:  [18.64173973]


portfolio before change:  [9.58138262]
curr_Stock_Price:  101.77443469028559
curr_Factors:  [101.77443469  -1.67397688  -0.92003216]
mat_Sqrt:  [[ 7.60457396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00789241 0.0356594  0.87062341]
Stock Position:  0.007892407170564969
Bond Position:  [8.77813734]


portfolio before change:  [9.58329842]
curr_Stock_Price:  101.87813753505483
curr_Factors:  [101.87813754  -1.99224736  -0.91719562]
mat_Sqrt:  [[ 5.55297817  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08227912 0.02002086 1.80564843]
Stock Position:  0.08227912018060361
Bond Position:  [1.2008549]


portfolio before change:  [9.59796814]
curr_Stock_Price:  102.05460515308451
curr_Factors:  [102.05460515  -2.03981517  -0.94090564]
mat_Sqrt:  [[ 5.17990753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00321363 -0.138127   -0.32626186]
Stock Position:  -0.003213633263359294
Bond Position:  [9.92593421]


portfolio before change:  [9.59859814]
curr_Stock_Price:  102.24467587112339
curr_Factors:  [102.24467587  -1.79060788  -0.91828584]
mat_Sqrt:  [[ 6.8105645   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01961712 -0.0175627  -0.0477005 ]
Stock Position:  0.019617116145567944
Bond Position:  [7.59285246]


portfolio before change:  [9.60849329]
curr_Stock_Price:  102.70070554680464
curr_Factors:  [102.70070555  -1.85609369  -0.94022007]
mat_Sqrt:  [[ 6.26830024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02127141 0.06024613 0.3406592 ]
Stock Position:  0.021271414818086958
Bond Position:  [7.42390398]


portfolio before change:  [9.60950986]
curr_Stock_Price:  102.70486711276159
curr_Factors:  [102.70486711  -1.76535717  -0.9562224 ]
mat_Sqrt:  [[ 6.75497951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0120109  -0.07626732 -0.27956183]
Stock Position:  0.012010903826932446
Bond Position:  [8.37593158]


portfolio before change:  [9.60685889]
curr_Stock_Price:  102.39697796322795
curr_Factors:  [102.39697796  -1.39057463  -0.97414632]
mat_Sqrt:  [[ 9.62280931  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429398 -0.04372475  0.14409695]
Stock Position:  -0.004293975095565987
Bond Position:  [10.04654896]


portfolio before change:  [9.60684899]
curr_Stock_Price:  102.69176169439768
curr_Factors:  [102.69176169  -1.35166629  -0.96852793]
mat_Sqrt:  [[10.08992773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00584505 -0.00434523  0.0821034 ]
Stock Position:  0.005845052639636829
Bond Position:  [9.00661024]


portfolio before change:  [9.61357387]
curr_Stock_Price:  103.64966207974224
curr_Factors:  [103.64966208  -1.39466678  -0.94302098]
mat_Sqrt:  [[10.00744     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06159655 -0.02156864  0.88822107]
Stock Position:  0.061596553805766875
Bond Position:  [3.22911188]


portfolio before change:  [9.62547421]
curr_Stock_Price:  103.83630687919033
curr_Factors:  [103.83630688  -1.34708868  -0.95184759]
mat_Sqrt:  [[10.42158791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00045506 -0.03480718 -0.01234848]
Stock Position:  0.0004550570205593799
Bond Position:  [9.57822277]


portfolio before change:  [9.6262166]
curr_Stock_Price:  102.83651869312507
curr_Factors:  [102.83651869  -1.42042942  -0.92804149]
mat_Sqrt:  [[ 9.82244059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269767 -0.02440068 -0.01223663]
Stock Position:  -0.0026976729623661255
Bond Position:  [9.9036359]


portfolio before change:  [9.62924304]
curr_Stock_Price:  102.17357305402125
curr_Factors:  [102.17357305  -1.30347474  -0.90854116]
mat_Sqrt:  [[11.18593468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01194868 -0.01545935  0.25511853]
Stock Position:  0.01194867521036807
Bond Position:  [8.4084042]


portfolio before change:  [9.63116699]
curr_Stock_Price:  102.24662100939466
curr_Factors:  [102.24662101  -1.66341636  -0.89491174]
mat_Sqrt:  [[ 7.91737446  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00406814 -0.01321866 -0.14530097]
Stock Position:  -0.004068136813195704
Bond Position:  [10.04712023]


portfolio before change:  [9.6306444]
curr_Stock_Price:  102.68381286028868
curr_Factors:  [102.68381286  -1.61805904  -0.88710867]
mat_Sqrt:  [[ 8.38535534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00476198  0.00783328 -0.14481329]
Stock Position:  -0.004761983881101106
Bond Position:  [10.11962306]


portfolio before change:  [9.63397484]
curr_Stock_Price:  102.25008335894208
curr_Factors:  [102.25008336  -1.45106562  -0.8683557 ]
mat_Sqrt:  [[10.0542988   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00455352 -0.01456363 -0.02045336]
Stock Position:  -0.004553518058254473
Bond Position:  [10.09957244]


portfolio before change:  [9.63822395]
curr_Stock_Price:  101.59419867261322
curr_Factors:  [101.59419867  -1.24101704  -0.81918548]
mat_Sqrt:  [[12.9459618   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0196917  0.0064228  0.14010481]
Stock Position:  0.019691701863818828
Bond Position:  [7.63766128]


portfolio before change:  [9.64631342]
curr_Stock_Price:  101.95651900200562
curr_Factors:  [101.956519    -1.30756927  -0.81661648]
mat_Sqrt:  [[12.18688886  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00787221  0.00203566  0.11147615]
Stock Position:  -0.007872212493394672
Bond Position:  [10.44893681]


portfolio before change:  [9.64781579]
curr_Stock_Price:  101.93160024251836
curr_Factors:  [101.93160024  -0.96335603  -0.80652088]
mat_Sqrt:  [[17.36445143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00811906 -0.01555628 -0.28795613]
Stock Position:  -0.008119057291188003
Bond Position:  [10.47540429]


portfolio before change:  [9.64810392]
curr_Stock_Price:  102.05739956101226
curr_Factors:  [102.05739956  -0.64363855  -0.80227976]
mat_Sqrt:  [[24.03754752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.13543941 0.59539307 0.55587242]
Stock Position:  0.13543940936125598
Bond Position:  [-4.17448999]


portfolio before change:  [9.53612618]
curr_Stock_Price:  101.23447878548559
curr_Factors:  [101.23447879  -0.62043037  -0.78549621]
mat_Sqrt:  [[24.81660076  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183336 -0.02454434 -0.10292339]
Stock Position:  -0.0018333607217124492
Bond Position:  [9.72172549]


portfolio before change:  [9.54063073]
curr_Stock_Price:  99.4403621208081
curr_Factors:  [99.44036212 -0.69594661 -0.79421734]
mat_Sqrt:  [[22.40746451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074504 -0.00446772 -0.18731353]
Stock Position:  0.0007450355532814088
Bond Position:  [9.46654412]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.54159718]
Stock Price:  99.14917348693552
PL:  [9.54159718]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 3.19038874e-02 -8.26281511e-02 -2.43783397e-02]
 [ 7.83997372e-01  2.06359505e-01  2.10749324e-01]
 [-1.78489186e-01 -7.78252150e-02  3.50028979e-02]
 [ 1.49552866e-01  9.11570118e-01  9.14123823e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-4.62618964e-02  3.90382838e-01 -1.85590537e-01]
 [-1.04006763e-01  1.37003978e-01  3.91032680e-02]
 [-3.61087581e-02  6.61520355e-02  2.41175435e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 5.92863870e-01  1.41794254e+00 -1.38057004e-01]
 [-2.44956039e-03 -1.32823545e-01  3.32102038e-01]
 [-5.37533200e-01 -2.10188660e-02 -1.11671182e+00]
 [ 1.76500682e+00 -2.96220982e+00  2.49817314e+00]
 [ 3.77566866e-03 -9.23030529e-02  3.58217492e-02]
 [ 1.06433927e-01  5.08641037e-02 -5.35672573e-02]
 [-5.40121461e-02  5.27202432e-03 -6.83217652e-02]
 [-2.76286305e-01 -1.78775847e+00 -1.97982723e-01]
 [ 7.49241660e-03  2.95723376e-02  1.83830040e-02]
 [ 1.64333079e-01  1.28904063e-01  3.92719088e-01]
 [ 3.09360475e-02 -5.46588864e-02  5.22591499e-02]
 [ 1.09361203e-01 -5.09187516e-02  2.66802304e-02]
 [ 1.01412854e-01 -4.72713143e-02 -2.42372197e-02]
 [-9.59438697e-02 -2.78339153e-02  6.90695114e-02]
 [ 7.18562527e-02  2.23770862e-02 -2.57246373e-02]
 [ 3.48697451e-02 -4.42982943e-02  2.72678577e-01]
 [-2.01161881e-01 -1.35137138e-01 -7.40055280e-02]
 [-2.01397416e-01  1.45271948e-01  2.82888065e-01]
 [ 8.93280989e-02  7.40491256e-02  2.20379928e-01]
 [-1.61548183e-01  1.24010888e-01 -2.69401007e-02]
 [ 9.99702986e-02 -2.76037522e-03 -1.75718919e-02]
 [ 5.61526292e-02 -2.06947225e-03 -6.73446768e-02]
 [ 7.46397677e-02  7.55416333e-02  1.14981292e-01]
 [ 1.08926897e-02 -4.59130823e-02 -1.14460085e-02]
 [-1.01006933e-01  8.35752186e-02  2.91341993e-02]
 [-9.83416814e-02 -5.57124651e-02 -6.18480010e-02]
 [ 1.36732999e+00  8.99643166e-01  1.32853769e-01]
 [ 1.60562067e-02 -5.49341789e-02  5.70267928e-02]
 [ 3.19388245e-02 -1.48343459e-02 -5.43724719e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.91673243]
curr_Stock_Price:  100.06945362876816
curr_Factors:  [100.06945363  -1.06157635  -0.99631859]
mat_Sqrt:  [[12.7811259   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0007872  -0.02666812 -0.06954462]
Stock Position:  0.0007871981723487481
Bond Position:  [2.83795794]


portfolio before change:  [2.9167935]
curr_Stock_Price:  99.69636202962984
curr_Factors:  [99.69636203 -0.81487974 -1.01410903]
mat_Sqrt:  [[16.00882966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05429125 0.06660224 0.60120916]
Stock Position:  0.05429124885882806
Bond Position:  [-2.49584651]


portfolio before change:  [2.97579082]
curr_Stock_Price:  100.78879076846746
curr_Factors:  [100.78879077  -0.62143001  -1.01682344]
mat_Sqrt:  [[19.58519055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00955979 -0.02511798  0.09985352]
Stock Position:  -0.009559787233008715
Bond Position:  [3.93931021]


portfolio before change:  [2.97910024]
curr_Stock_Price:  100.49412142319088
curr_Factors:  [100.49412142  -0.60760346  -0.98611312]
mat_Sqrt:  [[20.41730158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02557738 0.29420799 2.60774082]
Stock Position:  0.02557738002102815
Bond Position:  [0.4087239]


portfolio before change:  [2.93336445]
curr_Stock_Price:  98.70398979145664
curr_Factors:  [98.70398979 -0.53058117 -0.9853593 ]
mat_Sqrt:  [[21.67555018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270563 -0.01106097 -0.05874131]
Stock Position:  -0.002705629174742089
Bond Position:  [3.20042085]


portfolio before change:  [2.936233]
curr_Stock_Price:  97.79164243793241
curr_Factors:  [97.79164244 -0.72634219 -0.95300474]
mat_Sqrt:  [[18.23772388  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.44484622e-04  1.25995519e-01 -5.29438143e-01]
Stock Position:  -0.00024448462232189546
Bond Position:  [2.96014156]


portfolio before change:  [2.93653706]
curr_Stock_Price:  98.0615275181024
curr_Factors:  [98.06152752 -0.77760201 -0.92171834]
mat_Sqrt:  [[17.92640508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00379658  0.04421784  0.11155074]
Stock Position:  -0.003796579523800795
Bond Position:  [3.30883545]


portfolio before change:  [2.94045267]
curr_Stock_Price:  97.13912506522088
curr_Factors:  [97.13912507 -0.75011164 -0.92697484]
mat_Sqrt:  [[18.1570289   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00097387  0.02135048  0.06880064]
Stock Position:  -0.0009738684426156485
Bond Position:  [3.0350534]


portfolio before change:  [2.9416797]
curr_Stock_Price:  96.26874919032679
curr_Factors:  [96.26874919 -0.72090416 -0.9076927 ]
mat_Sqrt:  [[18.88837948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00275255  0.0064198  -0.11330016]
Stock Position:  0.0027525497041433855
Bond Position:  [2.67669519]


portfolio before change:  [2.93743326]
curr_Stock_Price:  94.6044553590925
curr_Factors:  [94.60445536 -0.6688201  -0.93839359]
mat_Sqrt:  [[18.96302224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.60933514e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  4.6093351372343494e-05
Bond Position:  [2.93307262]


portfolio before change:  [2.93780509]
curr_Stock_Price:  94.7166782479559
curr_Factors:  [94.71667825 -0.6097596  -0.93011674]
mat_Sqrt:  [[20.30797705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04205832  0.45763899 -0.39383821]
Stock Position:  0.042058320597226764
Bond Position:  [-1.04581933]


portfolio before change:  [2.94298949]
curr_Stock_Price:  94.84305359926294
curr_Factors:  [94.8430536  -0.40829596 -0.95076118]
mat_Sqrt:  [[24.36545423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00156894 -0.04286861  0.94739467]
Stock Position:  0.0015689422913839142
Bond Position:  [2.79418621]


portfolio before change:  [2.94604363]
curr_Stock_Price:  96.56704902594538
curr_Factors:  [96.56704903 -0.3787924  -0.92874316]
mat_Sqrt:  [[26.12001857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02947056 -0.00678381 -3.185668  ]
Stock Position:  -0.029470557306263617
Bond Position:  [5.79192839]


portfolio before change:  [2.86620832]
curr_Stock_Price:  99.3006028353637
curr_Factors:  [99.30060284 -0.46427215 -0.93872711]
mat_Sqrt:  [[24.41389354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06841538 -0.95604911  7.12659261]
Stock Position:  0.06841537695267634
Bond Position:  [-3.92747986]


portfolio before change:  [2.89067498]
curr_Stock_Price:  99.66539842000196
curr_Factors:  [99.66539842 -0.52304144 -0.9340387 ]
mat_Sqrt:  [[23.21360246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033401 -0.02979068  0.10218948]
Stock Position:  -0.0003340080102314769
Bond Position:  [2.92396402]


portfolio before change:  [2.89107776]
curr_Stock_Price:  99.55382604513075
curr_Factors:  [99.55382605 -0.55700709 -0.91550999]
mat_Sqrt:  [[22.83241833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00463736  0.01641632 -0.15281247]
Stock Position:  0.0046373602064151385
Bond Position:  [2.42941081]


portfolio before change:  [2.89315564]
curr_Stock_Price:  99.93641124551272
curr_Factors:  [99.93641125 -0.55514189 -0.92131933]
mat_Sqrt:  [[22.82994097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00292958  0.00170154 -0.19490298]
Stock Position:  -0.0029295792158682615
Bond Position:  [3.18592728]


portfolio before change:  [2.89360616]
curr_Stock_Price:  99.91857571550132
curr_Factors:  [99.91857572 -0.77451577 -0.9294244 ]
mat_Sqrt:  [[18.18169727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03748957 -0.57699656 -0.5647896 ]
Stock Position:  -0.03748957084157858
Bond Position:  [6.63951068]


portfolio before change:  [2.90614465]
curr_Stock_Price:  99.60626226674992
curr_Factors:  [99.60626227 -0.77628071 -0.95124482]
mat_Sqrt:  [[17.7023873   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00097621 0.00954443 0.05244159]
Stock Position:  0.0009762106904367057
Bond Position:  [2.80890795]


portfolio before change:  [2.90663673]
curr_Stock_Price:  99.75064348013267
curr_Factors:  [99.75064348 -1.01119674 -0.96348036]
mat_Sqrt:  [[13.84600031  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01955864 0.04160361 1.12031825]
Stock Position:  0.0195586416710311
Bond Position:  [0.95564964]


portfolio before change:  [2.89618346]
curr_Stock_Price:  99.21007763823017
curr_Factors:  [99.21007764 -1.02194049 -0.98097338]
mat_Sqrt:  [[13.38755744  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227422 -0.01764108  0.14908081]
Stock Position:  0.0022742164501436068
Bond Position:  [2.67055827]


portfolio before change:  [2.89508952]
curr_Stock_Price:  98.58226525812768
curr_Factors:  [98.58226526 -0.86249307 -0.99713152]
mat_Sqrt:  [[15.35232293  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00680116 -0.01643396  0.07611127]
Stock Position:  0.006801155529469917
Bond Position:  [2.2246162]


portfolio before change:  [2.89030051]
curr_Stock_Price:  97.83722925883214
curr_Factors:  [97.83722926 -0.77562373 -1.01524544]
mat_Sqrt:  [[16.32072884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00531938 -0.01525675 -0.06914204]
Stock Position:  0.005319384748328287
Bond Position:  [2.36986664]


portfolio before change:  [2.89200726]
curr_Stock_Price:  98.10239067580187
curr_Factors:  [98.10239068 -1.0442304  -1.00409981]
mat_Sqrt:  [[12.65030757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00691894 -0.00898336  0.19703609]
Stock Position:  -0.006918937619554361
Bond Position:  [3.57077158]


portfolio before change:  [2.89424834]
curr_Stock_Price:  97.84299916750322
curr_Factors:  [97.84299917 -1.09363176 -1.03413298]
mat_Sqrt:  [[11.65341658  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00610747  0.00722217 -0.07338523]
Stock Position:  0.006107473822431337
Bond Position:  [2.29667479]


portfolio before change:  [2.89279209]
curr_Stock_Price:  97.55755212736422
curr_Factors:  [97.55755213 -0.8577761  -1.04879522]
mat_Sqrt:  [[14.49597692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0056214  -0.01429721  0.77787608]
Stock Position:  0.0056213993323680255
Bond Position:  [2.34438213]


portfolio before change:  [2.88941059]
curr_Stock_Price:  96.90387841890518
curr_Factors:  [96.90387842 -0.65035847 -1.03466317]
mat_Sqrt:  [[17.96989583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01357008 -0.04361532 -0.21111717]
Stock Position:  -0.013570081401203865
Bond Position:  [4.20440411]


portfolio before change:  [2.9201798]
curr_Stock_Price:  94.67517973237092
curr_Factors:  [94.67517973 -0.37632704 -1.0326962 ]
mat_Sqrt:  [[23.13689752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00492718  0.04688632  0.80700091]
Stock Position:  -0.004927178313816781
Bond Position:  [3.38666129]


portfolio before change:  [2.91909031]
curr_Stock_Price:  94.98222023696295
curr_Factors:  [94.98222024 -0.41153212 -1.06202882]
mat_Sqrt:  [[21.76120469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00686672 0.02389925 0.62868259]
Stock Position:  0.006866723604228773
Bond Position:  [2.26687366]


portfolio before change:  [2.92189275]
curr_Stock_Price:  95.34907126927519
curr_Factors:  [95.34907127 -0.28705393 -1.06043427]
mat_Sqrt:  [[24.78048363  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00571957  0.04002434 -0.07685261]
Stock Position:  -0.0057195692323394375
Bond Position:  [3.46724837]


portfolio before change:  [2.92869176]
curr_Stock_Price:  94.23612418373833
curr_Factors:  [94.23612418 -0.12431819 -1.06865684]
mat_Sqrt:  [[28.58346945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00335229 -0.00089091 -0.05012772]
Stock Position:  0.0033522869623967715
Bond Position:  [2.61278523]


portfolio before change:  [2.92835511]
curr_Stock_Price:  94.03826860927546
curr_Factors:  [ 9.40382686e+01 -9.21373666e-02 -1.07222846e+00]
mat_Sqrt:  [[29.35127504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00143038 -0.00066792 -0.19211562]
Stock Position:  0.0014303816545865825
Bond Position:  [2.7938445]


portfolio before change:  [2.92896365]
curr_Stock_Price:  94.21953965232575
curr_Factors:  [94.21953965 -0.10370342 -1.06699009]
mat_Sqrt:  [[29.22235726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00388504 0.02438096 0.32800962]
Stock Position:  0.0038850424015909736
Bond Position:  [2.56291675]


portfolio before change:  [2.93303515]
curr_Stock_Price:  95.18506534284036
curr_Factors:  [95.18506534 -0.15441822 -1.0758303 ]
mat_Sqrt:  [[27.81497474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.93254169e-05 -1.48183836e-02 -3.26522764e-02]
Stock Position:  -2.9325416854731622e-05
Bond Position:  [2.93582649]


portfolio before change:  [2.93339193]
curr_Stock_Price:  95.53349478451482
curr_Factors:  [95.53349478 -0.21794577 -1.06873116]
mat_Sqrt:  [[26.38511396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295622  0.02697379  0.08311176]
Stock Position:  -0.0029562206598037345
Bond Position:  [3.21581002]


portfolio before change:  [2.94038186]
curr_Stock_Price:  93.30499944330812
curr_Factors:  [93.30499944 -0.2058582  -1.06808559]
mat_Sqrt:  [[26.09985881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468733 -0.01798112 -0.17643513]
Stock Position:  -0.004687328461308591
Bond Position:  [3.37773303]


portfolio before change:  [2.93309913]
curr_Stock_Price:  94.94878690583406
curr_Factors:  [94.94878691 -0.25035903 -1.08256556]
mat_Sqrt:  [[25.03846065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06302654 0.29035858 0.37899482]
Stock Position:  0.06302654006156444
Bond Position:  [-3.0511944]


portfolio before change:  [2.9635686]
curr_Stock_Price:  95.43827744293414
curr_Factors:  [95.43827744 -0.18668709 -1.10791409]
mat_Sqrt:  [[26.15076764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063032 -0.01772993  0.16268157]
Stock Position:  0.0006303203002754988
Bond Position:  [2.90341191]


portfolio before change:  [2.96440864]
curr_Stock_Price:  96.19518623255914
curr_Factors:  [ 9.61951862e+01 -5.15460312e-02 -1.10718929e+00]
mat_Sqrt:  [[30.19402327  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00058992 -0.00478776 -0.15510953]
Stock Position:  0.0005899194638376303
Bond Position:  [2.90766123]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.96372642]
Stock Price:  94.42256190538448
PL:  [2.96372642]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 2.21259382e-02 -7.63070559e-02 -1.28348558e-02]
 [ 7.04732296e-01  2.02080948e-01  1.96982588e-01]
 [-4.04207786e-01 -2.85594526e-01  4.15867878e-02]
 [ 2.55565155e-01  1.71439310e+00  1.59964986e+00]
 [-4.85249424e-02 -2.85505067e-02 -1.18263810e-02]
 [-3.68540834e-03  1.47398001e-01 -4.70626349e-02]
 [-1.50791006e-01  2.63672999e-01  1.33930002e-01]
 [-5.51654816e-02  1.05852798e-01  8.02534082e-03]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 7.15959112e-01  1.53438509e+00 -2.10406620e-01]
 [-1.66437611e-03 -4.68460613e-02  2.15193412e-01]
 [-5.46528962e-01 -5.79281482e-02 -1.22394560e+00]
 [ 2.02487671e+00 -2.96576448e+00  2.52358546e+00]
 [-2.63551218e-02  1.01854153e-01 -4.21481697e-02]
 [-6.27551331e-03  6.87529565e-01 -3.65371506e-01]
 [ 6.81508359e-03 -2.08286842e-01 -2.80963992e-01]
 [-3.16527788e-01 -1.99432943e+00 -1.89820523e-01]
 [ 6.33500785e-02 -2.00296487e-01  7.66800609e-02]
 [-4.54049786e-01  3.90062574e-01  2.06859012e-01]
 [ 1.03101009e-02  1.78283862e-01 -1.17072365e-01]
 [ 1.90942636e-02 -3.61319284e-02  1.94600222e-02]
 [ 3.42694625e-02 -1.27145929e-01 -1.28434530e-01]
 [-2.67200784e-01  9.68442785e-02  1.86196888e-02]
 [ 1.45738193e-01 -3.28970988e-02 -5.15200557e-02]
 [-6.02816607e-02 -6.10038336e-02  1.47437493e-01]
 [-1.13658544e-01 -3.79577104e-02  5.46473875e-03]
 [-2.83774791e-01  2.06848796e-01  3.78984679e-01]
 [ 3.32994338e-01  3.15673363e-01  4.52946848e-01]
 [-1.16408753e-01  5.49978504e-02 -3.52952363e-01]
 [ 2.44935637e-01  6.38524145e-02  1.92350789e-01]
 [ 1.34972143e-01 -4.18021132e-02 -3.73634964e-02]
 [ 3.09749098e-01  2.27422957e-01  2.49760504e-01]
 [ 3.57325036e-02  3.40368913e-02  1.43074348e-01]
 [-1.01076060e-01  1.96007045e-01  2.49880298e-02]
 [-7.24690555e-02 -4.14967691e-02 -3.70645496e-02]
 [ 1.89426578e+00  1.28136565e+00  1.63509615e-01]
 [ 3.20957503e-01 -5.02324491e-01  1.10603808e-01]
 [ 2.41250950e-02 -1.41503336e-02  2.97050526e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.78221044]
curr_Stock_Price:  99.5646899686137
curr_Factors:  [99.56468997 -1.13214687 -0.97054644]
mat_Sqrt:  [[12.15954277  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0003232  -0.024628   -0.03661427]
Stock Position:  0.00032319650431555165
Bond Position:  [-0.8143894]


portfolio before change:  [-0.7824549]
curr_Stock_Price:  99.12332316916579
curr_Factors:  [99.12332317 -1.11073615 -0.96504019]
mat_Sqrt:  [[12.43591212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06321939 0.06522135 0.56193649]
Stock Position:  0.06321939169762554
Bond Position:  [-7.04897109]


portfolio before change:  [-0.81620228]
curr_Stock_Price:  98.60344769144288
curr_Factors:  [98.60344769 -1.16771434 -0.97451949]
mat_Sqrt:  [[11.57528708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03922284 -0.09217524  0.11863553]
Stock Position:  -0.039222842105153456
Bond Position:  [3.05130518]


portfolio before change:  [-0.80232632]
curr_Stock_Price:  98.25940018578721
curr_Factors:  [98.25940019 -0.9621404  -0.96503857]
mat_Sqrt:  [[14.30246569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06516648 0.55331799 4.56335581]
Stock Position:  0.06516647993826936
Bond Position:  [-7.20554556]


portfolio before change:  [-0.81412368]
curr_Stock_Price:  98.09218840451746
curr_Factors:  [98.0921884  -1.104266   -0.95774487]
mat_Sqrt:  [[12.47712368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454967 -0.00921464 -0.03373737]
Stock Position:  -0.004549673590640111
Bond Position:  [-0.36783624]


portfolio before change:  [-0.81703621]
curr_Stock_Price:  98.72224511901408
curr_Factors:  [98.72224512 -1.14601248 -0.95377917]
mat_Sqrt:  [[12.09169263  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138901  0.0475725  -0.1342566 ]
Stock Position:  0.0013890083816082144
Bond Position:  [-0.95416224]


portfolio before change:  [-0.8181201]
curr_Stock_Price:  98.02778397266596
curr_Factors:  [98.02778397 -1.0519788  -0.93690273]
mat_Sqrt:  [[13.41494547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00519053  0.08510009  0.38206502]
Stock Position:  -0.005190526772025482
Bond Position:  [-0.30930427]


portfolio before change:  [-0.81565452]
curr_Stock_Price:  97.54531937792616
curr_Factors:  [97.54531938 -1.18688978 -0.9282832 ]
mat_Sqrt:  [[11.76517739  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00271311  0.03416384  0.02289406]
Stock Position:  -0.0027131085905512642
Bond Position:  [-0.55100348]


portfolio before change:  [-0.81486671]
curr_Stock_Price:  97.22955814676655
curr_Factors:  [97.22955815 -1.05963815 -0.95910838]
mat_Sqrt:  [[12.9142097   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00402589  0.0064198  -0.11330016]
Stock Position:  0.0040258912113447405
Bond Position:  [-1.20630233]


portfolio before change:  [-0.81717889]
curr_Stock_Price:  96.69268702946778
curr_Factors:  [96.69268703 -1.07784303 -0.96193644]
mat_Sqrt:  [[12.57559842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [6.95051812e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  6.950518123275072e-05
Bond Position:  [-0.82389953]


portfolio before change:  [-0.81729823]
curr_Stock_Price:  96.45754150673177
curr_Factors:  [96.45754151 -0.75999418 -0.98023496]
mat_Sqrt:  [[16.92638751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05826495  0.49522066 -0.60023152]
Stock Position:  0.05826494784831543
Bond Position:  [-6.43739185]


portfolio before change:  [-0.83159934]
curr_Stock_Price:  96.22590324472012
curr_Factors:  [96.22590324 -0.57498092 -0.96182687]
mat_Sqrt:  [[20.6949724   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158006 -0.0151195   0.61388691]
Stock Position:  0.00158006409922782
Bond Position:  [-0.98364244]


portfolio before change:  [-0.83365104]
curr_Stock_Price:  95.00523639899636
curr_Factors:  [95.0052364  -0.35130172 -0.94291774]
mat_Sqrt:  [[26.04205036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03103405 -0.01869623 -3.49157612]
Stock Position:  -0.031034052015249048
Bond Position:  [2.11474641]


portfolio before change:  [-0.76397932]
curr_Stock_Price:  92.76874599388167
curr_Factors:  [92.76874599 -0.32960352 -0.93076943]
mat_Sqrt:  [[26.30441632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07354724 -0.95719637  7.19908689]
Stock Position:  0.07354724274819388
Bond Position:  [-7.5868648]


portfolio before change:  [-0.84089061]
curr_Stock_Price:  91.73590139037978
curr_Factors:  [91.73590139 -0.43085673 -0.96321181]
mat_Sqrt:  [[22.75637387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00062258  0.03287329 -0.120237  ]
Stock Position:  -0.0006225811358945915
Bond Position:  [-0.78377757]


portfolio before change:  [-0.83960871]
curr_Stock_Price:  89.51952654768378
curr_Factors:  [89.51952655 -0.51272383 -0.94560502]
mat_Sqrt:  [[20.82445311  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00285648  0.22189921 -1.04230321]
Stock Position:  0.0028564843834263903
Bond Position:  [-1.09531984]


portfolio before change:  [-0.8400657]
curr_Stock_Price:  89.40748053595473
curr_Factors:  [89.40748054 -0.4781882  -0.95144335]
mat_Sqrt:  [[21.40389276  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00434747 -0.06722429 -0.80151206]
Stock Position:  -0.004347472010638366
Bond Position:  [-0.45136918]


portfolio before change:  [-0.84999232]
curr_Stock_Price:  91.6778106949285
curr_Factors:  [91.67781069 -0.55884678 -0.93636607]
mat_Sqrt:  [[20.55424567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03709042 -0.64366706 -0.54150512]
Stock Position:  -0.037090416430854
Bond Position:  [2.55037586]


portfolio before change:  [-0.79589608]
curr_Stock_Price:  90.2279099434176
curr_Factors:  [90.22790994 -0.43490486 -0.91318939]
mat_Sqrt:  [[23.43532619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00162648 -0.06464541  0.21874687]
Stock Position:  0.001626475388022649
Bond Position:  [-0.94264955]


portfolio before change:  [-0.79390619]
curr_Stock_Price:  91.52379402181367
curr_Factors:  [91.52379402 -0.45244168 -0.96674741]
mat_Sqrt:  [[22.14053061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01500432  0.12589215  0.59011118]
Stock Position:  -0.015004323221177202
Bond Position:  [0.5793464]


portfolio before change:  [-0.80564408]
curr_Stock_Price:  92.31092124098012
curr_Factors:  [92.31092124 -0.56146948 -0.94941814]
mat_Sqrt:  [[20.37431105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00111929  0.05754087 -0.33397487]
Stock Position:  0.0011192940626344483
Bond Position:  [-0.90896715]


portfolio before change:  [-0.80720435]
curr_Stock_Price:  91.01846044046975
curr_Factors:  [91.01846044 -0.60980994 -0.91976758]
mat_Sqrt:  [[19.71707139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079581 -0.01166153  0.05551403]
Stock Position:  0.0007958141827007456
Bond Position:  [-0.87963813]


portfolio before change:  [-0.80625333]
curr_Stock_Price:  92.35166404451942
curr_Factors:  [92.35166404 -0.51952593 -0.93250925]
mat_Sqrt:  [[21.61891322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00082801 -0.04103617 -0.36638796]
Stock Position:  -0.0008280101764150048
Bond Position:  [-0.72978521]


portfolio before change:  [-0.8061222]
curr_Stock_Price:  92.08311897117305
curr_Factors:  [92.08311897 -0.46439404 -0.90152919]
mat_Sqrt:  [[23.49454814  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01036972  0.03125636  0.05311679]
Stock Position:  -0.010369716381095191
Bond Position:  [0.14875363]


portfolio before change:  [-0.79723977]
curr_Stock_Price:  91.22833777597982
curr_Factors:  [91.22833778 -0.51845088 -0.89778652]
mat_Sqrt:  [[22.13429403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00580577 -0.01061749 -0.14697238]
Stock Position:  0.005805769712717295
Bond Position:  [-1.32689049]


portfolio before change:  [-0.80554736]
curr_Stock_Price:  89.82598866734321
curr_Factors:  [89.82598867 -0.65523107 -0.89612558]
mat_Sqrt:  [[19.03953648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223947 -0.0196889   0.42059813]
Stock Position:  -0.0022394696318328924
Bond Position:  [-0.60438478]


portfolio before change:  [-0.80221842]
curr_Stock_Price:  88.30576692429582
curr_Factors:  [88.30576692 -0.4531392  -0.90850453]
mat_Sqrt:  [[22.62740281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00531617 -0.0122508   0.01558938]
Stock Position:  -0.005316171060470971
Bond Position:  [-0.33276986]


portfolio before change:  [-0.81206519]
curr_Stock_Price:  90.15017220806074
curr_Factors:  [90.15017221 -0.34748809 -0.91904629]
mat_Sqrt:  [[25.40491068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.006463    0.06676016  1.0811378 ]
Stock Position:  -0.006463003772442106
Bond Position:  [-0.22942429]


portfolio before change:  [-0.79401035]
curr_Stock_Price:  87.35216612162111
curr_Factors:  [87.35216612 -0.4243971  -0.9124782 ]
mat_Sqrt:  [[22.94436882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02135113 0.10188314 1.29213128]
Stock Position:  0.021351133496689188
Bond Position:  [-2.65907811]


portfolio before change:  [-0.80130101]
curr_Stock_Price:  87.02626972652035
curr_Factors:  [87.02626973 -0.27417248 -0.90260952]
mat_Sqrt:  [[26.82751452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00660622  0.01775048 -1.00687485]
Stock Position:  -0.006606220022364231
Bond Position:  [-0.22638632]


portfolio before change:  [-0.79931657]
curr_Stock_Price:  86.72159561127988
curr_Factors:  [86.72159561 -0.37642271 -0.88768385]
mat_Sqrt:  [[24.49812002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01213289 0.02060828 0.54872326]
Stock Position:  0.012132885988325265
Bond Position:  [-1.8514998]


portfolio before change:  [-0.79499521]
curr_Stock_Price:  87.09684083313883
curr_Factors:  [87.09684083 -0.34386464 -0.86534995]
mat_Sqrt:  [[25.99244776  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00457104 -0.01349157 -0.10658766]
Stock Position:  0.004571040482729916
Bond Position:  [-1.1931184]


portfolio before change:  [-0.79583152]
curr_Stock_Price:  86.94651184942263
curr_Factors:  [86.94651185 -0.21411394 -0.87058355]
mat_Sqrt:  [[29.38827033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01385429 0.07340044 0.7124972 ]
Stock Position:  0.013854294927605185
Bond Position:  [-2.00041414]


portfolio before change:  [-0.80185466]
curr_Stock_Price:  86.52981246413738
curr_Factors:  [86.52981246 -0.31676457 -0.89413415]
mat_Sqrt:  [[25.7797755   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00278843 0.01098536 0.40815129]
Stock Position:  0.0027884332761926567
Bond Position:  [-1.04313727]


portfolio before change:  [-0.80180377]
curr_Stock_Price:  86.59482846931566
curr_Factors:  [86.59482847 -0.43405433 -0.89675099]
mat_Sqrt:  [[22.8839266   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244563  0.063261    0.07128389]
Stock Position:  -0.002445630534115431
Bond Position:  [-0.59002481]


portfolio before change:  [-0.80668173]
curr_Stock_Price:  88.55923064260826
curr_Factors:  [88.55923064 -0.35393616 -0.92688161]
mat_Sqrt:  [[24.60264175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359739 -0.01339302 -0.10573484]
Stock Position:  -0.003597390818655042
Bond Position:  [-0.48809957]


portfolio before change:  [-0.80361262]
curr_Stock_Price:  87.68912039327722
curr_Factors:  [87.68912039 -0.41984536 -0.92234338]
mat_Sqrt:  [[22.91081569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09555311 0.41355898 0.46644742]
Stock Position:  0.09555311052824955
Bond Position:  [-9.18258083]


portfolio before change:  [-0.83824091]
curr_Stock_Price:  87.33873523195575
curr_Factors:  [87.33873523 -0.3532951  -0.89519019]
mat_Sqrt:  [[25.06089785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00961649 -0.16212453  0.31552188]
Stock Position:  0.009616489182346763
Bond Position:  [-1.67813291]


portfolio before change:  [-0.8230927]
curr_Stock_Price:  88.93578209623934
curr_Factors:  [88.9357821  -0.55770765 -0.87870308]
mat_Sqrt:  [[21.1471222   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129096 -0.004567    0.08474025]
Stock Position:  0.001290964720585268
Bond Position:  [-0.93790566]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.82185008]
Stock Price:  89.98915558070134
PL:  [-0.82185008]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 2.97352554e-02 -8.54893660e-02  1.01768286e-02]
 [ 1.23976176e+00  2.51812277e-01  3.62570800e-01]
 [-1.97913756e-01 -9.57051309e-02  3.55694850e-02]
 [ 1.63902962e-01  1.24032630e+00  1.04832744e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 3.23030224e-02 -1.76905318e-02  2.06913439e-02]
 [-5.03659754e-02 -5.51286127e-03 -7.26415989e-02]
 [-5.97402436e-02  1.37921662e-01 -4.09786729e-03]
 [ 2.82676287e-02  4.99431114e-02 -4.42821953e-02]
 [-1.19642393e-01 -6.16991011e-02 -2.90725094e-02]
 [ 9.10319584e-01  1.74852339e+00 -3.17013280e-01]
 [-1.94086217e-04  5.30537970e-03 -1.60433387e-02]
 [-3.04032770e-01 -2.58961457e-03 -6.32564083e-01]
 [ 1.75742328e+00 -3.21411735e+00  2.70285785e+00]
 [ 2.38700604e-02 -8.89156308e-02  3.37381392e-02]
 [ 7.74194430e-02  9.00613808e-02 -6.56913761e-02]
 [ 4.85986764e-03  1.61016019e-01 -9.28778946e-02]
 [-2.90798098e-01 -1.85775644e+00 -1.93415491e-01]
 [ 2.48878972e-02 -1.56511557e-01  3.33924902e-01]
 [ 6.00275696e-02  4.31891858e-01  3.89004537e-01]
 [ 2.27668107e-02  3.78326595e-02 -1.47912310e-02]
 [ 1.16613892e-01 -5.16830065e-02  4.20237012e-02]
 [ 5.29055853e-02 -7.56874117e-02 -5.49445239e-02]
 [-1.81822027e-01  4.35785306e-02 -2.50110648e-02]
 [ 6.94577357e-02  1.21410918e-02 -2.50417711e-02]
 [ 8.64083981e-03 -4.89032500e-02  2.38155319e-01]
 [ 1.46709068e-01 -1.14364606e-01  7.16604397e-02]
 [ 1.84646313e-02 -1.37320473e-01 -4.96601202e-02]
 [ 7.08083360e-02  8.72544929e-03  9.79760101e-02]
 [-4.47275800e-02  8.48312655e-02  2.64280748e-03]
 [ 4.98201636e-02 -1.23091721e-02 -7.96825586e-02]
 [-7.42714505e-02  1.12516685e-02 -3.59136351e-02]
 [-1.07034395e-01 -1.80725788e-02  4.67399618e-02]
 [-4.36661221e-02 -2.43079870e-02 -7.04873165e-03]
 [-8.92156759e-02  5.84531189e-03  5.73071437e-02]
 [-1.15995084e-01 -6.71843961e-02 -7.85377972e-02]
 [ 1.99182454e+00  1.28627815e+00  1.56363529e-01]
 [-2.29043807e-02 -8.22750176e-02 -1.73856541e-02]
 [ 3.34624450e-02 -1.39250752e-02 -7.67555176e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.94260476]
curr_Stock_Price:  100.20944580869993
curr_Factors:  [100.20944581  -1.01341982  -1.01129093]
mat_Sqrt:  [[13.23085644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0010855  -0.02759157  0.02903166]
Stock Position:  0.0010855040358780437
Bond Position:  [3.833827]


portfolio before change:  [3.94361597]
curr_Stock_Price:  100.69949070098654
curr_Factors:  [100.6994907   -0.92969851  -1.00657264]
mat_Sqrt:  [[14.52497525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09398792 0.08127206 1.03431357]
Stock Position:  0.09398791750811464
Bond Position:  [-5.52091946]


portfolio before change:  [3.9229822]
curr_Stock_Price:  100.4872973670087
curr_Factors:  [100.48729737  -0.92826621  -1.02050479]
mat_Sqrt:  [[14.31431847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01468382 -0.0308887   0.10146984]
Stock Position:  -0.014683821223227653
Bond Position:  [5.39851971]


portfolio before change:  [3.92945459]
curr_Stock_Price:  100.09247295630344
curr_Factors:  [100.09247296  -1.02243724  -1.00920673]
mat_Sqrt:  [[13.12410366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04808499 0.40031359 2.99058638]
Stock Position:  0.04808499429130607
Bond Position:  [-0.8834914]


portfolio before change:  [3.94832317]
curr_Stock_Price:  100.48717036679449
curr_Factors:  [100.48717037  -0.83236886  -1.03792939]
mat_Sqrt:  [[15.48283214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378781 -0.01106097 -0.05874131]
Stock Position:  -0.00378780835525455
Bond Position:  [4.32894931]


portfolio before change:  [3.94838145]
curr_Stock_Price:  100.61465043070423
curr_Factors:  [100.61465043  -0.78464404  -1.08127266]
mat_Sqrt:  [[15.57054799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00211396 -0.00570959  0.05902664]
Stock Position:  0.002113962887319101
Bond Position:  [3.73568581]


portfolio before change:  [3.94848308]
curr_Stock_Price:  100.44181672522058
curr_Factors:  [100.44181673  -0.6238991   -1.06548358]
mat_Sqrt:  [[18.54492079  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357614 -0.00177927 -0.20722626]
Stock Position:  -0.00357613755899696
Bond Position:  [4.30767683]


portfolio before change:  [3.95089005]
curr_Stock_Price:  99.91933004434442
curr_Factors:  [99.91933004 -0.510158   -1.05825955]
mat_Sqrt:  [[20.82065671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155728  0.04451403 -0.01169007]
Stock Position:  -0.0015572792100587841
Bond Position:  [4.10649235]


portfolio before change:  [3.9498085]
curr_Stock_Price:  100.943485331308
curr_Factors:  [100.94348533  -0.58244486  -1.04026626]
mat_Sqrt:  [[19.92249886  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147688  0.01611907 -0.12632478]
Stock Position:  0.0014768809135191237
Bond Position:  [3.80072699]


portfolio before change:  [3.9502249]
curr_Stock_Price:  100.9037285468921
curr_Factors:  [100.90372855  -0.89297879  -1.0604526 ]
mat_Sqrt:  [[14.30680767  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00965771 -0.0199133  -0.08293578]
Stock Position:  -0.009657714921463004
Bond Position:  [4.92472435]


portfolio before change:  [3.95680522]
curr_Stock_Price:  100.28612026976778
curr_Factors:  [100.28612027  -0.90483279  -1.05488963]
mat_Sqrt:  [[14.13006615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08510401  0.5643335  -0.90435065]
Stock Position:  0.08510401498120028
Bond Position:  [-4.57794626]


portfolio before change:  [3.92430984]
curr_Stock_Price:  99.91101339960153
curr_Factors:  [99.9110134  -0.86159273 -1.06204521]
mat_Sqrt:  [[14.59445966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00016348  0.0017123  -0.04576718]
Stock Position:  -0.0001634841565756748
Bond Position:  [3.94064371]


portfolio before change:  [3.92476261]
curr_Stock_Price:  100.15467754081487
curr_Factors:  [100.15467754  -1.07989382  -1.06604027]
mat_Sqrt:  [[11.71396445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.70227328e-02 -8.35794507e-04 -1.80452926e+00]
Stock Position:  -0.037022732762259
Bond Position:  [7.63276248]


portfolio before change:  [3.91533887]
curr_Stock_Price:  100.4349890322173
curr_Factors:  [100.43498903  -0.92896814  -1.06709815]
mat_Sqrt:  [[13.64597147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12113926 -1.03735191  7.71050112]
Stock Position:  0.1211392587861309
Bond Position:  [-8.25128126]


portfolio before change:  [3.8604011]
curr_Stock_Price:  99.98999459525784
curr_Factors:  [99.9899946  -1.19993967 -1.05033989]
mat_Sqrt:  [[10.53592212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00119657 -0.0286974   0.09624552]
Stock Position:  0.0011965732077658655
Bond Position:  [3.74075575]


portfolio before change:  [3.85953984]
curr_Stock_Price:  98.87941880866664
curr_Factors:  [98.87941881 -1.10895562 -1.02902316]
mat_Sqrt:  [[11.65718046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00706809  0.02906719 -0.18739921]
Stock Position:  0.007068085603591849
Bond Position:  [3.16065164]


portfolio before change:  [3.85188366]
curr_Stock_Price:  97.74031409357717
curr_Factors:  [97.74031409 -1.01381404 -1.00385909]
mat_Sqrt:  [[12.99599162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144418  0.0519677  -0.26495478]
Stock Position:  0.0014441763758370747
Bond Position:  [3.7107294]


portfolio before change:  [3.85069441]
curr_Stock_Price:  96.59563327541615
curr_Factors:  [96.59563328 -1.2140307  -0.99498468]
mat_Sqrt:  [[10.60704239  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06688875 -0.59958831 -0.55176056]
Stock Position:  -0.06688875082352332
Bond Position:  [10.31185565]


portfolio before change:  [3.85043082]
curr_Stock_Price:  96.61884560159486
curr_Factors:  [96.6188456  -1.23451098 -0.98339059]
mat_Sqrt:  [[10.51573005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00581056 -0.05051389  0.9525948 ]
Stock Position:  0.0058105566013917035
Bond Position:  [3.28902155]


portfolio before change:  [3.8514684]
curr_Stock_Price:  96.72665261442377
curr_Factors:  [96.72665261 -1.34740863 -1.01130255]
mat_Sqrt:  [[ 9.14473039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02488781 0.1393925  1.10972167]
Stock Position:  0.024887813510841895
Bond Position:  [1.44415351]


portfolio before change:  [3.8348213]
curr_Stock_Price:  96.05051326803776
curr_Factors:  [96.05051327 -1.19922005 -1.01318753]
mat_Sqrt:  [[10.51146589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00261335  0.01221044 -0.04219526]
Stock Position:  0.002613348404437731
Bond Position:  [3.58380784]


portfolio before change:  [3.8382302]
curr_Stock_Price:  97.18350292614556
curr_Factors:  [97.18350293 -1.0873708  -1.02577588]
mat_Sqrt:  [[11.74531338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00976068 -0.01668062  0.11988192]
Stock Position:  0.009760675667656775
Bond Position:  [2.88965355]


portfolio before change:  [3.83925584]
curr_Stock_Price:  97.2515734453645
curr_Factors:  [97.25157345 -0.77200547 -1.02472534]
mat_Sqrt:  [[16.12821705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00162699 -0.02442801 -0.15674143]
Stock Position:  0.0016269903287886216
Bond Position:  [3.68102847]


portfolio before change:  [3.84057172]
curr_Stock_Price:  97.77752722167095
curr_Factors:  [97.77752722 -1.36060759 -1.00407526]
mat_Sqrt:  [[ 9.1890442   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01937437  0.01406491 -0.07134961]
Stock Position:  -0.019374371862672334
Bond Position:  [5.73494989]


portfolio before change:  [3.84394036]
curr_Stock_Price:  97.64065954365823
curr_Factors:  [97.64065954 -1.51726259 -1.00847765]
mat_Sqrt:  [[ 7.81116221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00855499  0.00391852 -0.0714372 ]
Stock Position:  0.008554987556757085
Bond Position:  [3.00862573]


portfolio before change:  [3.84579993]
curr_Stock_Price:  97.81406295256104
curr_Factors:  [97.81406295 -1.31907582 -1.01940663]
mat_Sqrt:  [[ 9.4365072   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00500945 -0.01578346  0.67939084]
Stock Position:  0.005009454831087884
Bond Position:  [3.35580479]


portfolio before change:  [3.84599973]
curr_Stock_Price:  97.77020625554137
curr_Factors:  [97.77020626 -1.31108167 -1.03567615]
mat_Sqrt:  [[ 9.35454262  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01475135 -0.03691102  0.20442729]
Stock Position:  0.014751348263478807
Bond Position:  [2.40375737]


portfolio before change:  [3.84876811]
curr_Stock_Price:  97.93750553013496
curr_Factors:  [97.93750553 -1.36406732 -1.03627308]
mat_Sqrt:  [[ 8.8816662   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221835 -0.04431999 -0.1416665 ]
Stock Position:  -0.0022183475612552366
Bond Position:  [4.06602753]


portfolio before change:  [3.85134995]
curr_Stock_Price:  97.00277674101528
curr_Factors:  [97.00277674 -1.06545286 -1.02752965]
mat_Sqrt:  [[11.96226482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00774006 0.00281613 0.27949829]
Stock Position:  0.007740062735870415
Bond Position:  [3.10054237]


portfolio before change:  [3.85968362]
curr_Stock_Price:  98.0293939948963
curr_Factors:  [98.02939399 -1.35746456 -1.05185792]
mat_Sqrt:  [[ 8.81050616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305     0.02737917  0.00753919]
Stock Position:  -0.003049996124912933
Bond Position:  [4.15867289]


portfolio before change:  [3.85986475]
curr_Stock_Price:  98.14045511180784
curr_Factors:  [98.14045511 -1.51389582 -1.03334979]
mat_Sqrt:  [[ 7.68410614  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00403982 -0.00397277 -0.22731216]
Stock Position:  0.004039823191675967
Bond Position:  [3.46339466]


portfolio before change:  [3.85853116]
curr_Stock_Price:  97.70317295828755
curr_Factors:  [97.70317296 -1.4273292  -1.00777845]
mat_Sqrt:  [[ 8.55765659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0092672   0.00363146 -0.1024516 ]
Stock Position:  -0.009267204461182187
Bond Position:  [4.76396644]


portfolio before change:  [3.860289]
curr_Stock_Price:  97.57775150570546
curr_Factors:  [97.57775151 -1.35321852 -1.00252909]
mat_Sqrt:  [[ 9.25257504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01093562 -0.0058329   0.1333361 ]
Stock Position:  -0.010935624846191224
Bond Position:  [4.92736268]


portfolio before change:  [3.86071854]
curr_Stock_Price:  97.59479820173307
curr_Factors:  [97.5947982  -1.29922978 -0.99607411]
mat_Sqrt:  [[ 9.83079987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00509285 -0.00784537 -0.02010807]
Stock Position:  -0.005092849635896341
Bond Position:  [4.35775417]


portfolio before change:  [3.86297595]
curr_Stock_Price:  97.25851257519187
curr_Factors:  [97.25851258 -1.23263501 -0.98885272]
mat_Sqrt:  [[10.5474569   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00723632  0.00188657  0.16348133]
Stock Position:  -0.007236316356799907
Bond Position:  [4.56676931]


portfolio before change:  [3.857654]
curr_Stock_Price:  98.07285345493864
curr_Factors:  [98.07285345 -1.13483424 -0.99203246]
mat_Sqrt:  [[11.69128753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01246574 -0.02168367 -0.22404647]
Stock Position:  -0.012465735870135313
Bond Position:  [5.08020429]


portfolio before change:  [3.86091759]
curr_Stock_Price:  97.86199365826147
curr_Factors:  [97.86199366 -1.26616747 -0.97804527]
mat_Sqrt:  [[10.3744444   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.22037831 0.41514449 0.44606162]
Stock Position:  0.220378311829372
Bond Position:  [-17.70574337]


portfolio before change:  [4.04135652]
curr_Stock_Price:  98.69080608519397
curr_Factors:  [98.69080609 -0.96611006 -0.97446193]
mat_Sqrt:  [[14.17414887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305116 -0.02655415 -0.04959643]
Stock Position:  -0.0030511553510400168
Bond Position:  [4.3424775]


portfolio before change:  [4.03933619]
curr_Stock_Price:  99.53087062018615
curr_Factors:  [99.53087062 -0.73884208 -0.95535501]
mat_Sqrt:  [[18.28846912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00081758 -0.0044943  -0.21896213]
Stock Position:  0.0008175832767203049
Bond Position:  [3.95796142]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.03985331]
Stock Price:  99.55819883418629
PL:  [4.03985331]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.58378179e-02 -8.64308322e-02  3.84149169e-03]
 [ 7.18653833e-01  2.01192967e-01  2.01167851e-01]
 [-3.55803899e-01 -2.41039748e-01  4.01749154e-02]
 [ 2.06013366e-01  1.34598660e+00  1.28059356e+00]
 [-4.96104981e-02 -2.27881491e-02 -2.99756586e-03]
 [-4.74187505e-02  3.93272555e-01 -1.86077174e-01]
 [-1.65197089e-01  1.63211410e-01  3.18217374e-01]
 [-2.79519717e-02  4.91590492e-02  3.10054358e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 8.57267421e-01  1.76164499e+00 -2.69882125e-01]
 [-1.30074091e-03 -1.00781931e-02  1.55007886e-01]
 [-5.02167286e-01 -1.29959053e-02 -1.07159501e+00]
 [ 1.85563852e+00 -2.92222861e+00  2.47343476e+00]
 [ 1.94956362e-02 -8.96530515e-02  3.41917282e-02]
 [ 1.27416213e-01 -2.68161909e-02 -1.65013863e-02]
 [-6.85429852e-02 -2.34572926e-02 -6.02821250e-02]
 [-2.64630174e-01 -1.72782759e+00 -2.00312031e-01]
 [ 1.27118915e-03  3.71660750e-02  5.88909386e-02]
 [ 2.38688459e-01 -2.11060551e-01  3.15226720e-01]
 [ 5.17372871e-02 -5.42236560e-02  3.00383863e-02]
 [ 1.20594054e-01 -5.13551104e-02 -6.92232086e-03]
 [ 6.67342268e-02  1.46386678e-01  1.10573878e-01]
 [-1.39927082e-01  3.26215201e-02  3.90985144e-02]
 [-2.65415682e-02 -1.62035670e-01  5.79739433e-02]
 [ 5.83067163e-02 -1.43686219e-02  1.66814598e-02]
 [ 6.00658487e-01 -7.77952571e-02  3.22296150e-01]
 [ 9.12643658e-02 -2.22461228e-01 -9.80575943e-02]
 [-1.15021113e-02 -7.68748865e-02 -6.49237045e-03]
 [ 2.53398186e-01 -1.11512295e-01  2.90206598e-02]
 [-1.88882158e-02 -6.68428004e-02 -3.28923674e-02]
 [ 1.60727313e-02  1.17798195e-02 -4.64917159e-02]
 [-3.79629743e-02  4.24395311e-02 -1.12131543e-01]
 [ 4.66424399e-01  7.71392255e-02  1.17452696e-01]
 [-3.69542292e-02  6.57283933e-02 -2.12036606e-02]
 [-4.80064461e-02  4.68013459e-03 -3.86644032e-02]
 [ 2.52846294e+00  1.73878216e+00  2.00014120e-01]
 [-1.12743055e-01  5.12376280e-03 -9.95661427e-03]
 [ 3.65043827e-02 -1.30116065e-02 -1.40691408e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.70035436]
curr_Stock_Price:  99.4393985805397
curr_Factors:  [99.43939858 -1.12366202 -0.99558617]
mat_Sqrt:  [[11.94484988  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.54477578e-05 -2.78954311e-02  1.09587065e-02]
Stock Position:  -8.544775778974436e-05
Bond Position:  [-1.69185749]


portfolio before change:  [-1.70053733]
curr_Stock_Price:  99.10554936819237
curr_Factors:  [99.10554937 -1.15935267 -0.97225062]
mat_Sqrt:  [[11.75856781  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06810229 0.06493475 0.57387589]
Stock Position:  0.0681022896872819
Bond Position:  [-8.44985216]


portfolio before change:  [-1.69858241]
curr_Stock_Price:  99.149765433548
curr_Factors:  [99.14976543 -0.8712232  -0.98274628]
mat_Sqrt:  [[15.5282665   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02555374 -0.07779524  0.11460785]
Stock Position:  -0.025553738490963537
Bond Position:  [0.83506476]


portfolio before change:  [-1.70276949]
curr_Stock_Price:  99.31770437415743
curr_Factors:  [99.31770437 -0.80632396 -0.96686061]
mat_Sqrt:  [[16.86329352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04401049 0.43441531 3.65317697]
Stock Position:  0.04401048908056942
Bond Position:  [-6.07379024]


portfolio before change:  [-1.76176248]
curr_Stock_Price:  97.99452633421403
curr_Factors:  [97.99452633 -0.94680334 -0.92083215]
mat_Sqrt:  [[15.13902928  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362467 -0.00735484 -0.00855122]
Stock Position:  -0.003624669991074808
Bond Position:  [-1.40656466]


portfolio before change:  [-1.76078615]
curr_Stock_Price:  97.6766614580893
curr_Factors:  [97.67666146 -0.74723257 -0.90626864]
mat_Sqrt:  [[18.69323024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.74172543e-04  1.26928171e-01 -5.30826384e-01]
Stock Position:  -0.0002741725427208737
Bond Position:  [-1.73400589]


portfolio before change:  [-1.76066754]
curr_Stock_Price:  96.45342242639244
curr_Factors:  [96.45342243 -0.6098985  -0.91765705]
mat_Sqrt:  [[20.93672251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319658  0.05267626  0.90778559]
Stock Position:  -0.003196577192584671
Bond Position:  [-1.45234673]


portfolio before change:  [-1.76273203]
curr_Stock_Price:  97.04247172422089
curr_Factors:  [97.04247172 -0.52211695 -0.90675915]
mat_Sqrt:  [[23.24924434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049844  0.01586601  0.08844988]
Stock Position:  -0.0004984447900090286
Bond Position:  [-1.71436172]


portfolio before change:  [-1.7629672]
curr_Stock_Price:  97.08430654619674
curr_Factors:  [97.08430655 -0.50777334 -0.89841623]
mat_Sqrt:  [[23.79297023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00218515  0.0064198  -0.11330016]
Stock Position:  0.0021851497664133407
Bond Position:  [-1.97511095]


portfolio before change:  [-1.76608825]
curr_Stock_Price:  95.76899586830746
curr_Factors:  [95.76899587 -0.52788379 -0.89627409]
mat_Sqrt:  [[23.05265886  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.79162010e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  3.79162010011608e-05
Bond Position:  [-1.76971945]


portfolio before change:  [-1.76625387]
curr_Stock_Price:  97.23576169705049
curr_Factors:  [97.2357617  -0.37160093 -0.90343538]
mat_Sqrt:  [[27.16969647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04275985  0.56856847 -0.76989858]
Stock Position:  0.04275985346734829
Bond Position:  [-5.92404079]


portfolio before change:  [-1.75757036]
curr_Stock_Price:  97.45615666361795
curr_Factors:  [97.45615666 -0.59710419 -0.90263026]
mat_Sqrt:  [[21.75118322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00130029 -0.00325272  0.44219435]
Stock Position:  0.00130029288124781
Bond Position:  [-1.88429191]


portfolio before change:  [-1.75800449]
curr_Stock_Price:  97.3034394462551
curr_Factors:  [97.30343945 -0.71359222 -0.89378649]
mat_Sqrt:  [[19.50080257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03710404 -0.00419441 -3.05696229]
Stock Position:  -0.0371040359265223
Bond Position:  [1.85234582]


portfolio before change:  [-1.78609296]
curr_Stock_Price:  98.06669963122734
curr_Factors:  [98.06669963 -0.4291923  -0.91739565]
mat_Sqrt:  [[25.50972886  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06915122 -0.94314523  7.05602091]
Stock Position:  0.06915121943915144
Bond Position:  [-8.56752483]


portfolio before change:  [-1.72654608]
curr_Stock_Price:  98.94329864891095
curr_Factors:  [98.94329865 -0.6278367  -0.88749201]
mat_Sqrt:  [[21.74139898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00037599 -0.0289354   0.09753948]
Stock Position:  0.00037599424937845966
Bond Position:  [-1.76374819]


portfolio before change:  [-1.72606436]
curr_Stock_Price:  100.81088753090928
curr_Factors:  [100.81088753  -0.62739087  -0.88227082]
mat_Sqrt:  [[22.27766637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00532255 -0.00865489 -0.04707386]
Stock Position:  0.005322552534978004
Bond Position:  [-2.26263561]


portfolio before change:  [-1.72869393]
curr_Stock_Price:  100.36998531246
curr_Factors:  [100.36998531  -0.53125848  -0.86118873]
mat_Sqrt:  [[24.93858006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343389 -0.00757081 -0.17196812]
Stock Position:  -0.0034338852488060554
Bond Position:  [-1.38403492]


portfolio before change:  [-1.73544538]
curr_Stock_Price:  102.28572652110174
curr_Factors:  [102.28572652  -0.65523893  -0.86883798]
mat_Sqrt:  [[22.28008495  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02954253 -0.55765396 -0.57143447]
Stock Position:  -0.029542527720037536
Bond Position:  [1.28633353]


portfolio before change:  [-1.71617987]
curr_Stock_Price:  101.63904152722448
curr_Factors:  [101.63904153  -0.86096483  -0.86733256]
mat_Sqrt:  [[18.04972295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00115673 0.0119953  0.16799946]
Stock Position:  0.001156734925859945
Bond Position:  [-1.8337493]


portfolio before change:  [-1.71583019]
curr_Stock_Price:  102.13951502820103
curr_Factors:  [102.13951503  -0.97189807  -0.8852915 ]
mat_Sqrt:  [[15.94507659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01630292 -0.0681195   0.89925409]
Stock Position:  0.01630291883522272
Bond Position:  [-3.38100241]


portfolio before change:  [-1.72383064]
curr_Stock_Price:  101.67470264501078
curr_Factors:  [101.67470265  -0.97893738  -0.87609468]
mat_Sqrt:  [[15.90679656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00294217 -0.01750061  0.08569116]
Stock Position:  0.0029421693714344692
Bond Position:  [-2.02297484]


portfolio before change:  [-1.72636977]
curr_Stock_Price:  100.89764276151698
curr_Factors:  [100.89764276  -0.90438458  -0.84705704]
mat_Sqrt:  [[17.50812302  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00620845 -0.01657479 -0.01974745]
Stock Position:  0.006208445242575665
Bond Position:  [-2.35278726]


portfolio before change:  [-1.72180832]
curr_Stock_Price:  101.67973302852096
curr_Factors:  [101.67973303  -1.04323228  -0.85706659]
mat_Sqrt:  [[15.20355262  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00783936 0.0472461  0.3154365 ]
Stock Position:  0.00783935726145475
Bond Position:  [-2.51891208]


portfolio before change:  [-1.71854284]
curr_Stock_Price:  102.1364503237667
curr_Factors:  [102.13645032  -1.28167166  -0.86756852]
mat_Sqrt:  [[11.90632158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01052275  0.01052855  0.11153718]
Stock Position:  -0.010522753875278682
Bond Position:  [-0.64378611]


portfolio before change:  [-1.72150408]
curr_Stock_Price:  102.4102155018
curr_Factors:  [102.4102155   -1.16045823  -0.88430892]
mat_Sqrt:  [[13.25293871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360547 -0.05229679  0.16538352]
Stock Position:  -0.00360547047229741
Bond Position:  [-1.35226707]


portfolio before change:  [-1.72282403]
curr_Stock_Price:  102.72942777044005
curr_Factors:  [102.72942777  -1.2883242   -0.87755012]
mat_Sqrt:  [[11.77789288  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00499061 -0.00463745  0.04758756]
Stock Position:  0.004990605956177083
Bond Position:  [-2.23550613]


portfolio before change:  [-1.72085611]
curr_Stock_Price:  103.17974885293604
curr_Factors:  [103.17974885  -1.61917681  -0.888551  ]
mat_Sqrt:  [[ 8.40431103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07740873 -0.02510831  0.91942121]
Stock Position:  0.07740872751481062
Bond Position:  [-9.70786918]


portfolio before change:  [-1.73814541]
curr_Stock_Price:  102.97207542137748
curr_Factors:  [102.97207542  -1.48187728  -0.86646801]
mat_Sqrt:  [[ 9.83662391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00262679 -0.07179905 -0.27973102]
Stock Position:  0.0026267889620643684
Bond Position:  [-2.00863132]


portfolio before change:  [-1.73768689]
curr_Stock_Price:  103.24221802491748
curr_Factors:  [103.24221802  -1.58490168  -0.86847883]
mat_Sqrt:  [[ 8.87907476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00321198 -0.02481126 -0.01852093]
Stock Position:  -0.003211976711271464
Bond Position:  [-1.40607529]


portfolio before change:  [-1.7396959]
curr_Stock_Price:  103.81296828632155
curr_Factors:  [103.81296829  -1.41198705  -0.89593522]
mat_Sqrt:  [[10.32603764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02290904 -0.03599044  0.08278786]
Stock Position:  0.0229090440699011
Bond Position:  [-4.11795177]


portfolio before change:  [-1.733151]
curr_Stock_Price:  104.12112929501971
curr_Factors:  [104.1211293   -1.40811065  -0.93405034]
mat_Sqrt:  [[10.00809171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00392148 -0.02157342 -0.09383277]
Stock Position:  -0.003921484018189038
Bond Position:  [-1.32484166]


portfolio before change:  [-1.73565563]
curr_Stock_Price:  104.71759096327808
curr_Factors:  [104.71759096  -1.49492866  -0.92468516]
mat_Sqrt:  [[ 9.31525416  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00096478  0.00380192 -0.13262792]
Stock Position:  0.000964782594950531
Bond Position:  [-1.83668534]


portfolio before change:  [-1.735871]
curr_Stock_Price:  104.73234428384289
curr_Factors:  [104.73234428  -1.43797222  -0.925418  ]
mat_Sqrt:  [[ 9.85538273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00529546  0.0136973  -0.31988008]
Stock Position:  -0.0052954611812977385
Bond Position:  [-1.18126494]


portfolio before change:  [-1.73531377]
curr_Stock_Price:  104.59923092565397
curr_Factors:  [104.59923093  -1.42588363  -0.94760407]
mat_Sqrt:  [[ 9.74396871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05194447 0.02489658 0.33505985]
Stock Position:  0.05194447189666939
Bond Position:  [-7.16866558]


portfolio before change:  [-1.76359219]
curr_Stock_Price:  104.07208574405786
curr_Factors:  [104.07208574  -1.13633634  -0.94904508]
mat_Sqrt:  [[12.93196781  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215479  0.02121375 -0.06048814]
Stock Position:  -0.002154788549016023
Bond Position:  [-1.53933885]


portfolio before change:  [-1.76396857]
curr_Stock_Price:  104.15745527917589
curr_Factors:  [104.15745528  -1.29029094  -0.96481259]
mat_Sqrt:  [[10.92223067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00503042  0.00151051 -0.11029878]
Stock Position:  -0.005030424424056915
Bond Position:  [-1.24001236]


portfolio before change:  [-1.76956339]
curr_Stock_Price:  105.2388374905739
curr_Factors:  [105.23883749  -1.46144051  -0.95744321]
mat_Sqrt:  [[ 9.36845966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.31213435 0.56118953 0.57058461]
Stock Position:  0.3121343504531042
Bond Position:  [-34.61821958]


portfolio before change:  [-1.58142764]
curr_Stock_Price:  105.85544151780566
curr_Factors:  [105.85544152  -1.45047201  -0.97421886]
mat_Sqrt:  [[ 9.36878603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0121392   0.00165369 -0.02840345]
Stock Position:  -0.012139198902519093
Bond Position:  [-0.29642738]


portfolio before change:  [-1.56935541]
curr_Stock_Price:  104.85790555689631
curr_Factors:  [104.85790556  -1.22376286  -0.95360436]
mat_Sqrt:  [[11.88454644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00043164 -0.00419948 -0.40135343]
Stock Position:  0.00043164342290486873
Bond Position:  [-1.61461664]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.56971136]
Stock Price:  104.50087539431338
PL:  [-6.07058676]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 6.03111144e-02 -5.29295018e-02 -7.20631747e-02]
 [ 1.35691346e+00  2.71296234e-01  4.13618994e-01]
 [-1.69297320e-01 -6.93642927e-02  3.47347843e-02]
 [ 1.56892459e-01  9.78266433e-01  9.63434736e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 7.19187874e-02  1.37951123e-02  1.20080445e-02]
 [-3.59996019e-02 -9.45423420e-02 -1.62113888e-02]
 [ 2.62745065e-02  1.99739204e-01 -4.25639725e-02]
 [ 3.76595544e-02  3.97795299e-02 -4.27380874e-02]
 [-2.06257849e-01 -4.89402936e-02 -7.01030624e-02]
 [ 6.43460337e-01  1.27095645e+00 -2.16885644e-01]
 [ 3.45304429e-05  3.33252531e-02 -5.90443834e-02]
 [-3.81979303e-02 -8.35481148e-03 -1.17697544e-01]
 [ 1.55857477e+00 -2.98645466e+00  2.50005128e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.45280021e-01 -8.64916952e-02  2.32471737e-02]
 [-2.06429237e-01 -3.22028264e-01 -1.00756058e-02]
 [-2.55800293e-01 -1.68740821e+00 -2.03875521e-01]
 [-1.56342757e-04  3.31438225e-02  8.29557115e-02]
 [ 3.05216397e-01 -4.69558638e-01  2.46267069e-01]
 [ 7.38709153e-02  6.68827622e-02 -1.42503424e-01]
 [-2.09998850e-01 -5.01324265e-02 -1.68115227e-01]
 [ 2.96730344e-01  3.00987665e-01  2.78597538e-01]
 [-2.08215076e-01  7.08588851e-02  5.74790994e-02]
 [-9.15351739e-02 -2.69091835e-01  1.01122945e-01]
 [ 1.22701098e-01 -2.75701116e-02 -1.18133994e-01]
 [ 4.26648203e-01 -3.28253904e-02  2.57090037e-01]
 [-5.88356483e-02  6.07652172e-02  1.05663581e-01]
 [-1.47115952e-02 -7.99861565e-02 -1.18799970e-02]
 [ 1.45952619e-01 -2.36514166e-02  3.55552139e-02]
 [-2.27739834e-02 -5.54237618e-02 -3.82342015e-02]
 [ 8.53249169e-02  2.07550964e-02 -8.23382569e-02]
 [-1.15495978e-01 -3.86269560e-02  2.26899905e-02]
 [ 2.30684723e-01  1.09712694e-02  4.16704776e-02]
 [ 8.14228077e-02 -4.92233533e-02  2.20617036e-03]
 [-1.07638406e-01 -4.96007656e-02 -9.31769503e-02]
 [ 1.70591651e+00  1.11912523e+00  1.47522198e-01]
 [-1.57116972e-02 -1.11544472e-01 -4.83559791e-02]
 [ 3.45996754e-02 -1.37102323e-02 -9.81680691e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.39714833]
curr_Stock_Price:  100.13501195091379
curr_Factors:  [100.13501195  -1.14323704  -0.99683438]
mat_Sqrt:  [[11.78052772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00295378 -0.01708292 -0.20557618]
Stock Position:  0.002953780333602182
Bond Position:  [3.1013715]


portfolio before change:  [3.39933273]
curr_Stock_Price:  100.74328668221602
curr_Factors:  [100.74328668  -1.13836219  -1.01075521]
mat_Sqrt:  [[11.74535878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.12743086 0.08756048 1.17993986]
Stock Position:  0.1274308624991113
Bond Position:  [-9.43847118]


portfolio before change:  [3.39817382]
curr_Stock_Price:  100.74345127099522
curr_Factors:  [100.74345127  -0.91099053  -1.01497571]
mat_Sqrt:  [[14.68183414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01201253 -0.02238723  0.09908867]
Stock Position:  -0.012012534500427535
Bond Position:  [4.60835801]


portfolio before change:  [3.40426536]
curr_Stock_Price:  100.28430909400818
curr_Factors:  [100.28430909  -0.65516618  -1.01223684]
mat_Sqrt:  [[18.927317    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02922974 0.31573413 2.74841113]
Stock Position:  0.029229739775752068
Bond Position:  [0.47298111]


portfolio before change:  [3.47836868]
curr_Stock_Price:  102.81748882062075
curr_Factors:  [102.81748882  -0.8396672   -0.99836562]
mat_Sqrt:  [[16.36136302  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00358442 -0.01106097 -0.05874131]
Stock Position:  -0.003584420249553609
Bond Position:  [3.84690976]


portfolio before change:  [3.48058123]
curr_Stock_Price:  102.33437983734365
curr_Factors:  [102.33437984  -0.88346105  -1.00420146]
mat_Sqrt:  [[15.49601943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00498101 0.00445235 0.03425561]
Stock Position:  0.004981010449301563
Bond Position:  [2.97085262]


portfolio before change:  [3.47950517]
curr_Stock_Price:  102.04378760902593
curr_Factors:  [102.04378761  -0.57888348  -1.00917636]
mat_Sqrt:  [[20.84975429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281093 -0.03051341 -0.04624658]
Stock Position:  -0.0028109258119530423
Bond Position:  [3.76634269]


portfolio before change:  [3.48140672]
curr_Stock_Price:  101.5348011695738
curr_Factors:  [101.53480117  -0.23861012  -1.04502528]
mat_Sqrt:  [[28.12801931  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00207472  0.06446555 -0.12142317]
Stock Position:  0.0020747200693563782
Bond Position:  [3.27075043]


portfolio before change:  [3.47974079]
curr_Stock_Price:  100.53476428937061
curr_Factors:  [100.53476429  -0.34970477  -1.04343671]
mat_Sqrt:  [[24.96218562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148447  0.01283879 -0.12191987]
Stock Position:  0.0014844710281935868
Bond Position:  [3.33049984]


portfolio before change:  [3.48296367]
curr_Stock_Price:  102.42536673370496
curr_Factors:  [102.42536673  -0.53349065  -1.03358128]
mat_Sqrt:  [[21.37159005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01078804 -0.01579541 -0.19998452]
Stock Position:  -0.010788035504063565
Bond Position:  [4.58793217]


portfolio before change:  [3.46997631]
curr_Stock_Price:  103.68239724505689
curr_Factors:  [103.68239725  -0.33861846  -1.02488852]
mat_Sqrt:  [[26.51804307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03237877  0.41019943 -0.61871437]
Stock Position:  0.032378770802541076
Bond Position:  [0.11286773]


portfolio before change:  [3.50390346]
curr_Stock_Price:  104.72978223862586
curr_Factors:  [104.72978224  -0.47550964  -1.04635091]
mat_Sqrt:  [[22.86307073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00022811  0.01075568 -0.16843719]
Stock Position:  -0.00022811306141544904
Bond Position:  [3.52779369]


portfolio before change:  [3.504683]
curr_Stock_Price:  103.24567711834642
curr_Factors:  [103.24567712  -0.55202242  -1.02430942]
mat_Sqrt:  [[21.34418892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299511 -0.0026965  -0.33575833]
Stock Position:  -0.00299511308620045
Bond Position:  [3.81391548]


portfolio before change:  [3.50633838]
curr_Stock_Price:  102.85216728785448
curr_Factors:  [102.85216729  -0.66533218  -1.04570171]
mat_Sqrt:  [[18.5832158   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07852721 -0.9638741   7.13195041]
Stock Position:  0.07852721022983584
Bond Position:  [-4.57035538]


portfolio before change:  [3.54435884]
curr_Stock_Price:  103.34361214016867
curr_Factors:  [103.34361214  -0.84442575  -1.03089213]
mat_Sqrt:  [[15.84321928  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136774 -0.03053791  0.10625201]
Stock Position:  -0.0013677379896284325
Bond Position:  [3.68570583]


portfolio before change:  [3.54422317]
curr_Stock_Price:  103.77967340727476
curr_Factors:  [103.77967341  -0.73815338  -1.04865223]
mat_Sqrt:  [[17.3825097   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00761514 -0.02791507  0.06631772]
Stock Position:  0.007615142452762983
Bond Position:  [2.75392617]


portfolio before change:  [3.54871312]
curr_Stock_Price:  104.32407397652365
curr_Factors:  [104.32407398  -1.10757193  -1.04607975]
mat_Sqrt:  [[12.10780722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02264817 -0.10393418 -0.0287429 ]
Stock Position:  -0.022648168320493003
Bond Position:  [5.9114623]


portfolio before change:  [3.54205487]
curr_Stock_Price:  104.65068876762413
curr_Factors:  [104.65068877  -0.89618289  -1.05691438]
mat_Sqrt:  [[14.84303548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04324297 -0.54460866 -0.58160011]
Stock Position:  -0.04324297198837166
Bond Position:  [8.06746167]


portfolio before change:  [3.55127588]
curr_Stock_Price:  104.46077306354006
curr_Factors:  [104.46077306  -0.82844418  -1.05310889]
mat_Sqrt:  [[15.91494427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00147926 0.01069712 0.23664955]
Stock Position:  0.0014792621947900078
Bond Position:  [3.39675101]


portfolio before change:  [3.55189389]
curr_Stock_Price:  104.5915012610365
curr_Factors:  [104.59150126  -0.73909217  -1.04704224]
mat_Sqrt:  [[17.53024873  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01481081 -0.1515494   0.7025314 ]
Stock Position:  0.014810810755906584
Bond Position:  [2.00280895]


portfolio before change:  [3.56227835]
curr_Stock_Price:  105.27573752715068
curr_Factors:  [105.27573753  -0.98235922  -1.06397837]
mat_Sqrt:  [[13.6023884   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00429593  0.02158632 -0.4065226 ]
Stock Position:  0.00429593028736334
Bond Position:  [3.11002112]


portfolio before change:  [3.56448466]
curr_Stock_Price:  105.69882058662711
curr_Factors:  [105.69882059  -1.03020186  -1.09636671]
mat_Sqrt:  [[12.60413787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02019563 -0.01618017 -0.47958595]
Stock Position:  -0.020195626872693603
Bond Position:  [5.6991386]


portfolio before change:  [3.58293897]
curr_Stock_Price:  104.820319595883
curr_Factors:  [104.8203196   -0.84036418  -1.08303643]
mat_Sqrt:  [[15.31521889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02709969 0.09714335 0.79476123]
Stock Position:  0.027099689591449233
Bond Position:  [0.74234085]


portfolio before change:  [3.55741029]
curr_Stock_Price:  103.87486674293946
curr_Factors:  [103.87486674  -0.53481078  -1.08123152]
mat_Sqrt:  [[20.63821954  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00881947  0.02286961  0.16397187]
Stock Position:  -0.008819471756274368
Bond Position:  [4.47353175]


portfolio before change:  [3.55471728]
curr_Stock_Price:  104.24362409690157
curr_Factors:  [104.2436241   -0.70789478  -1.0748659 ]
mat_Sqrt:  [[17.53098721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0071771  -0.08684902  0.28847561]
Stock Position:  -0.007177101811231729
Bond Position:  [4.30288438]


portfolio before change:  [3.55418771]
curr_Stock_Price:  104.39235490399135
curr_Factors:  [104.3923549   -0.62888063  -1.08082756]
mat_Sqrt:  [[18.8865165   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.004922   -0.00889822 -0.3370034 ]
Stock Position:  0.0049219967306910525
Bond Position:  [3.04036888]


portfolio before change:  [3.55670369]
curr_Stock_Price:  104.8263062772286
curr_Factors:  [104.82630628  -0.65348084  -1.06520534]
mat_Sqrt:  [[18.79552044  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02513503 -0.01059435  0.73340631]
Stock Position:  0.02513503331997178
Bond Position:  [0.92189099]


portfolio before change:  [3.5610566]
curr_Stock_Price:  104.99490235870577
curr_Factors:  [104.99490236  -0.55811931  -1.11585985]
mat_Sqrt:  [[19.68649052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126297  0.01961189  0.30142879]
Stock Position:  -0.0012629733055019778
Bond Position:  [3.69366236]


portfolio before change:  [3.56230365]
curr_Stock_Price:  104.37310786444202
curr_Factors:  [104.37310786  -0.64685838  -1.12695371]
mat_Sqrt:  [[17.71054043  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188948 -0.02581542 -0.03389032]
Stock Position:  -0.0018894790594514354
Bond Position:  [3.75951445]


portfolio before change:  [3.56314078]
curr_Stock_Price:  104.1787874578305
curr_Factors:  [104.17878746  -0.51488047  -1.10418225]
mat_Sqrt:  [[20.63617927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0071904  -0.00763346  0.10142913]
Stock Position:  0.00719040424802673
Bond Position:  [2.81405319]


portfolio before change:  [3.55634276]
curr_Stock_Price:  103.18443484009732
curr_Factors:  [103.18443484  -0.40589234  -1.08165116]
mat_Sqrt:  [[23.31214597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001797   -0.01788794 -0.10907153]
Stock Position:  -0.0017969960853073815
Bond Position:  [3.74176479]


portfolio before change:  [3.55737041]
curr_Stock_Price:  102.87285819326105
curr_Factors:  [ 1.02872858e+02 -3.85483475e-02 -1.09559774e+00]
mat_Sqrt:  [[33.09385956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00219842  0.00669868 -0.23488813]
Stock Position:  0.0021984231460285275
Bond Position:  [3.33121234]


portfolio before change:  [3.55493811]
curr_Stock_Price:  101.57704973350214
curr_Factors:  [101.57704973  -0.28716828  -1.09525282]
mat_Sqrt:  [[25.49281184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465814 -0.0124668   0.06472823]
Stock Position:  -0.004658140435041298
Bond Position:  [4.02809827]


portfolio before change:  [3.55542188]
curr_Stock_Price:  101.5812943775883
curr_Factors:  [101.58129438  -0.22248839  -1.1039722 ]
mat_Sqrt:  [[26.96120055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00895473 0.00354096 0.11887427]
Stock Position:  0.008954726429433613
Bond Position:  [2.64578918]


portfolio before change:  [3.55188946]
curr_Stock_Price:  101.14988436098903
curr_Factors:  [101.14988436  -0.54466698  -1.11335733]
mat_Sqrt:  [[19.27057098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00372721 -0.01588677  0.00629359]
Stock Position:  0.0037272100286936485
Bond Position:  [3.1748826]


portfolio before change:  [3.55272109]
curr_Stock_Price:  101.26652532852478
curr_Factors:  [101.26652533  -0.49856089  -1.08827393]
mat_Sqrt:  [[20.71630532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00660266 -0.01600858 -0.2658079 ]
Stock Position:  -0.00660266310823839
Bond Position:  [4.22134985]


portfolio before change:  [3.55921931]
curr_Stock_Price:  100.36226737138686
curr_Factors:  [100.36226737  -0.70032494  -1.0934749 ]
mat_Sqrt:  [[16.69295003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.1176826  0.36119612 0.42083977]
Stock Position:  0.1176826041437569
Bond Position:  [-8.25167367]


portfolio before change:  [3.66719972]
curr_Stock_Price:  101.28858897645958
curr_Factors:  [101.28858898  -0.79047841  -1.10476131]
mat_Sqrt:  [[15.22188271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317643 -0.03600082 -0.13794615]
Stock Position:  -0.0031764296818770333
Bond Position:  [3.9889358]


portfolio before change:  [3.66976015]
curr_Stock_Price:  100.63950078191833
curr_Factors:  [100.63950078  -0.82525583  -1.10913838]
mat_Sqrt:  [[14.54359402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00080878 -0.00442496 -0.28004618]
Stock Position:  0.0008087830784206552
Bond Position:  [3.58836463]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.67073011]
Stock Price:  101.28415096332807
PL:  [2.38657915]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.68568919e-03 -5.40946570e-02  1.82453114e-01]
 [ 1.56993127e+00  3.39194470e-01  5.17083137e-01]
 [-2.08058073e-01 -1.05042765e-01  3.58653802e-02]
 [ 1.46256801e-01  1.03910815e+00  9.21723000e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-1.99968187e-02  2.49429122e-01 -1.08027381e-01]
 [-5.54024089e-02  8.57981771e-03 -6.29408678e-02]
 [-6.34330807e-02  1.25943358e-01  6.51462416e-04]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-1.22189975e-01 -6.32810392e-02 -3.08334077e-02]
 [ 6.34695084e-01  1.24931145e+00 -2.15098138e-01]
 [-2.25642485e-04  1.85767345e-02 -5.76863092e-02]
 [-2.33279855e-01 -1.01701474e-03 -4.54227221e-01]
 [ 1.68017486e+00 -3.22873276e+00  2.70807887e+00]
 [-7.77678833e-03 -9.42505140e-02  3.70196364e-02]
 [ 1.25687343e-01 -3.82684441e-02 -7.92031659e-03]
 [-7.90783349e-02 -4.54627910e-02 -5.54368727e-02]
 [-2.72429132e-01 -1.76367588e+00 -1.97218065e-01]
 [ 8.06080843e-03  7.26978268e-03  7.07867253e-02]
 [ 1.27159658e-01  1.48677607e-01  3.15580570e-01]
 [ 3.49607761e-02 -4.91829831e-02  8.88484741e-02]
 [ 1.09859492e-01 -5.09708476e-02  2.76478444e-02]
 [ 5.18360922e-02  6.33628538e-02  4.15123744e-02]
 [-1.17977959e-02 -8.68583182e-02  7.65647309e-02]
 [-4.39332985e-03 -1.48727898e-01  4.60237900e-02]
 [ 5.03037391e-02 -9.35426306e-03  1.07018193e-01]
 [ 3.35861375e-01 -6.62300599e-02  1.73697673e-01]
 [ 4.22100361e-02 -1.45057790e-01 -3.64837316e-02]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 1.11806741e-01 -3.77156634e-02  9.12026415e-02]
 [-1.33981159e-02 -3.64485024e-02 -5.40220607e-02]
 [-5.52357845e-02  2.50292298e-02 -4.53529092e-02]
 [-8.94856744e-02 -3.98126081e-02  3.22905840e-02]
 [ 2.43310779e-01  2.20718865e-02  5.09226411e-02]
 [-8.66469224e-02 -3.65612834e-02  6.82920145e-02]
 [-1.18032319e-01 -6.76491128e-02 -8.23515578e-02]
 [ 2.56572165e+00  1.64373334e+00  1.78386898e-01]
 [-8.49518118e-03 -1.49868769e-01 -5.82184452e-02]
 [ 3.33603806e-02 -1.37119901e-02 -7.42098791e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.20237545]
curr_Stock_Price:  100.65427933125983
curr_Factors:  [100.65427933  -0.76777369  -1.00349222]
mat_Sqrt:  [[17.12305424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00162861 -0.01745898  0.52048795]
Stock Position:  0.0016286083711851205
Bond Position:  [7.03844905]


portfolio before change:  [7.20447087]
curr_Stock_Price:  101.40065509492992
curr_Factors:  [101.40065509  -1.00071636  -0.99225367]
mat_Sqrt:  [[13.81989916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.12624681 0.10947454 1.47509426]
Stock Position:  0.12624681162494222
Bond Position:  [-5.59703853]


portfolio before change:  [7.07443496]
curr_Stock_Price:  100.3761838178438
curr_Factors:  [100.37618382  -0.9953179   -0.98078745]
mat_Sqrt:  [[13.91294384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01596922 -0.03390241  0.10231395]
Stock Position:  -0.01596921903018809
Bond Position:  [8.67736423]


portfolio before change:  [7.07289445]
curr_Stock_Price:  100.5405783514606
curr_Factors:  [100.54057835  -0.84667404  -0.98078681]
mat_Sqrt:  [[16.16907655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03379969 0.33537071 2.62941916]
Stock Position:  0.033799690579618846
Bond Position:  [3.67465401]


portfolio before change:  [7.02389395]
curr_Stock_Price:  99.07725535585439
curr_Factors:  [99.07725536 -0.76419487 -0.95746729]
mat_Sqrt:  [[17.71191793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033111  -0.01106097 -0.05874131]
Stock Position:  -0.0033111039218613088
Bond Position:  [7.35194903]


portfolio before change:  [7.025865]
curr_Stock_Price:  98.75953446496356
curr_Factors:  [98.75953446 -0.76104747 -0.96015913]
mat_Sqrt:  [[17.66316415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050199  0.0805029  -0.30817205]
Stock Position:  0.0005019876861037672
Bond Position:  [6.97628893]


portfolio before change:  [7.02735779]
curr_Stock_Price:  99.99601838884112
curr_Factors:  [99.99601839 -0.80232798 -0.97488938]
mat_Sqrt:  [[16.91013266  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393248  0.00276912 -0.17955278]
Stock Position:  -0.003932483155147953
Bond Position:  [7.42059045]


portfolio before change:  [7.03038015]
curr_Stock_Price:  99.46334620924017
curr_Factors:  [99.46334621 -0.78636106 -1.00292171]
mat_Sqrt:  [[16.61833204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226208  0.04064804  0.00185844]
Stock Position:  -0.002262081487552614
Bond Position:  [7.25537434]


portfolio before change:  [7.03262344]
curr_Stock_Price:  98.87260065460603
curr_Factors:  [98.87260065 -0.45649274 -0.99062022]
mat_Sqrt:  [[23.25962896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00223526  0.0064198  -0.11330016]
Stock Position:  0.0022352550609790935
Bond Position:  [6.81161796]


portfolio before change:  [7.03914115]
curr_Stock_Price:  101.40752542911602
curr_Factors:  [101.40752543  -0.47033349  -0.97909003]
mat_Sqrt:  [[23.80090921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00594099 -0.02042387 -0.08795913]
Stock Position:  -0.005940991779195687
Bond Position:  [7.64160243]


portfolio before change:  [7.02801184]
curr_Stock_Price:  103.44162493974035
curr_Factors:  [103.44162494  -0.47199031  -0.97814872]
mat_Sqrt:  [[24.26095842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03486272  0.40321354 -0.61361511]
Stock Position:  0.03486271965559791
Bond Position:  [3.42175547]


portfolio before change:  [7.00740201]
curr_Stock_Price:  102.8381843111652
curr_Factors:  [102.83818431  -0.74871093  -0.96293941]
mat_Sqrt:  [[18.56923901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044207  0.00599562 -0.16456298]
Stock Position:  -0.00044206717302458666
Bond Position:  [7.05286339]


portfolio before change:  [7.00884186]
curr_Stock_Price:  101.57550830905167
curr_Factors:  [101.57550831  -0.93947669  -0.95761065]
mat_Sqrt:  [[15.23682371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.14090680e-02 -3.28240097e-04 -1.29578383e+00]
Stock Position:  -0.021409068012349187
Bond Position:  [9.18347882]


portfolio before change:  [7.00980876]
curr_Stock_Price:  101.58396767554005
curr_Factors:  [101.58396768  -1.03293342  -0.94243183]
mat_Sqrt:  [[14.09077717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11169695 -1.04206902  7.72539524]
Stock Position:  0.11169694997977614
Bond Position:  [-4.3368106]


portfolio before change:  [6.92922493]
curr_Stock_Price:  100.86737068765227
curr_Factors:  [100.86737069  -0.72635753  -0.92926499]
mat_Sqrt:  [[19.26295798  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101018 -0.03041922  0.10560672]
Stock Position:  -0.001010176750819344
Bond Position:  [7.0311188]


portfolio before change:  [6.92957306]
curr_Stock_Price:  101.39283300434631
curr_Factors:  [101.392833    -0.94968345  -0.94258644]
mat_Sqrt:  [[15.28286876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00760715 -0.01235109 -0.02259446]
Stock Position:  0.007607151758688436
Bond Position:  [6.15826239]


portfolio before change:  [6.92540213]
curr_Stock_Price:  100.74334443763424
curr_Factors:  [100.74334444  -0.91763364  -0.9356148 ]
mat_Sqrt:  [[15.78922427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00631281 -0.01467305 -0.15814597]
Stock Position:  -0.006312811246659811
Bond Position:  [7.56137585]


portfolio before change:  [6.92878525]
curr_Stock_Price:  100.35716373273439
curr_Factors:  [100.35716373  -1.02521332  -0.90717162]
mat_Sqrt:  [[14.5319623   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04629072 -0.56922394 -0.56260824]
Stock Position:  -0.046290715556893
Bond Position:  [11.57439017]


portfolio before change:  [6.97078133]
curr_Stock_Price:  99.48119565560559
curr_Factors:  [99.48119566 -0.94634632 -0.9083312 ]
mat_Sqrt:  [[15.56914574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00154113 0.00234631 0.20193482]
Stock Position:  0.001541126712284721
Bond Position:  [6.8174682]


portfolio before change:  [6.97103346]
curr_Stock_Price:  99.09180135939214
curr_Factors:  [99.09180136 -0.75140739 -0.8889846 ]
mat_Sqrt:  [[19.21429839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01155004 0.04798549 0.90026353]
Stock Position:  0.011550042435835099
Bond Position:  [5.82651895]


portfolio before change:  [6.97937162]
curr_Stock_Price:  99.7506558135654
curr_Factors:  [99.75065581 -0.73978732 -0.86854104]
mat_Sqrt:  [[19.97227922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215586 -0.01587374  0.25345997]
Stock Position:  0.0021558611356297525
Bond Position:  [6.76432305]


portfolio before change:  [6.97786443]
curr_Stock_Price:  98.65931633194154
curr_Factors:  [98.65931633 -0.91555639 -0.85161595]
mat_Sqrt:  [[16.85252212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00623638 -0.01645077  0.0788716 ]
Stock Position:  0.006236378328994342
Bond Position:  [6.36258761]


portfolio before change:  [6.98628919]
curr_Stock_Price:  99.8826842874512
curr_Factors:  [99.88268429 -0.8001645  -0.83008695]
mat_Sqrt:  [[19.56505168  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0037436  0.02045027 0.11842325]
Stock Position:  0.0037435964731986284
Bond Position:  [6.61236873]


portfolio before change:  [6.98484042]
curr_Stock_Price:  99.27488117858948
curr_Factors:  [99.27488118 -0.91714763 -0.8063917 ]
mat_Sqrt:  [[17.71396386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078463 -0.0280334   0.21841787]
Stock Position:  -0.000784633283912634
Bond Position:  [7.0627348]


portfolio before change:  [6.98416585]
curr_Stock_Price:  101.25983788425039
curr_Factors:  [101.25983788  -0.85045209  -0.7993949 ]
mat_Sqrt:  [[19.44991838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00130374 -0.04800172  0.13129306]
Stock Position:  -0.0013037441924410535
Bond Position:  [7.11618278]


portfolio before change:  [6.98487966]
curr_Stock_Price:  101.39465985691858
curr_Factors:  [101.39465986  -0.62599026  -0.81559972]
mat_Sqrt:  [[23.9850435   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00292846 -0.00301908  0.30529312]
Stock Position:  0.0029284627007065476
Bond Position:  [6.68794918]


portfolio before change:  [6.98827722]
curr_Stock_Price:  102.26935605661085
curr_Factors:  [102.26935606  -0.90504815  -0.85301265]
mat_Sqrt:  [[17.62907059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02029591 -0.02137566  0.49551111]
Stock Position:  0.020295914532551494
Bond Position:  [4.91262711]


portfolio before change:  [6.98378693]
curr_Stock_Price:  102.01785662208188
curr_Factors:  [102.01785662  -1.14028786  -0.83888084]
mat_Sqrt:  [[14.09724182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036553 -0.0468172  -0.10407793]
Stock Position:  0.0003655345026515959
Bond Position:  [6.94649588]


portfolio before change:  [6.98467381]
curr_Stock_Price:  102.0685147196458
curr_Factors:  [102.06851472  -1.12925182  -0.83424622]
mat_Sqrt:  [[14.32700568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154247 -0.02321455 -0.0028026 ]
Stock Position:  -0.001542473906621698
Bond Position:  [7.14211183]


portfolio before change:  [6.98545825]
curr_Stock_Price:  102.13878112354723
curr_Factors:  [102.13878112  -1.2452438   -0.83432275]
mat_Sqrt:  [[12.76575172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00961359 -0.01217268  0.26017575]
Stock Position:  0.009613591675199895
Bond Position:  [6.00353771]


portfolio before change:  [6.98541908]
curr_Stock_Price:  102.05664168988476
curr_Factors:  [102.05664169  -1.37027413  -0.86178931]
mat_Sqrt:  [[10.95136974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00290971 -0.0117637  -0.1541099 ]
Stock Position:  -0.0029097129452180046
Bond Position:  [7.28237461]


portfolio before change:  [6.98993786]
curr_Stock_Price:  100.81651153605702
curr_Factors:  [100.81651154  -1.433731    -0.84193716]
mat_Sqrt:  [[10.35670344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0057339   0.00807815 -0.12937923]
Stock Position:  -0.0057339035073280045
Bond Position:  [7.56801]


portfolio before change:  [6.99131564]
curr_Stock_Price:  100.74121761403178
curr_Factors:  [100.74121761  -1.27085934  -0.86189504]
mat_Sqrt:  [[11.93888409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00762392 -0.01284946  0.09211605]
Stock Position:  -0.007623920333359703
Bond Position:  [7.75935866]


portfolio before change:  [6.99117431]
curr_Stock_Price:  100.88698401740494
curr_Factors:  [100.88698402  -1.57064072  -0.87200343]
mat_Sqrt:  [[ 8.77017508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02944191 0.00712367 0.14526812]
Stock Position:  0.02944191213873219
Bond Position:  [4.02086859]


portfolio before change:  [6.97251658]
curr_Stock_Price:  100.23619828162082
curr_Factors:  [100.23619828  -1.48201792  -0.87967535]
mat_Sqrt:  [[ 9.44831214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0084851  -0.0118001   0.19481811]
Stock Position:  -0.00848510430137041
Bond Position:  [7.82303117]


portfolio before change:  [6.97522444]
curr_Stock_Price:  100.03232075622144
curr_Factors:  [100.03232076  -1.35452948  -0.84858713]
mat_Sqrt:  [[11.04940664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01345331 -0.02183366 -0.23492607]
Stock Position:  -0.013453308625882383
Bond Position:  [8.32099012]


portfolio before change:  [6.96752043]
curr_Stock_Price:  100.68228708460839
curr_Factors:  [100.68228708  -1.23217563  -0.8669542 ]
mat_Sqrt:  [[12.33992641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.23806142 0.53051265 0.50888817]
Stock Position:  0.23806141806354533
Bond Position:  [-17.00104761]


portfolio before change:  [6.96668862]
curr_Stock_Price:  100.68772035490286
curr_Factors:  [100.68772035  -1.14665295  -0.87152721]
mat_Sqrt:  [[13.38110567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380916 -0.04836994 -0.16608102]
Stock Position:  -0.00380916249140031
Bond Position:  [7.35022451]


portfolio before change:  [6.97026419]
curr_Stock_Price:  99.99026204554653
curr_Factors:  [99.99026205 -1.01797544 -0.86299217]
mat_Sqrt:  [[15.24276843  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00101119 -0.00442553 -0.21170013]
Stock Position:  0.0010111945359541567
Bond Position:  [6.86915458]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.97070607]
Stock Price:  99.57806714962162
PL:  [6.97070607]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-6.03330504e-03 -7.39735041e-02  1.29863586e-01]
 [ 1.25699303e+00  2.38265138e-01  3.67582209e-01]
 [-1.67651859e-01 -6.78496794e-02  3.46867886e-02]
 [ 1.35717111e-01  1.20077195e+00  8.90449974e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 5.58021008e-02 -5.95229470e-02  4.14513411e-02]
 [-9.43646786e-02  1.17601957e-01  1.21047960e-02]
 [ 1.16566243e-01 -1.72711000e-01 -7.70480045e-02]
 [-2.91301486e-02  1.12056783e-01 -5.37188502e-02]
 [-3.44266328e-01 -1.03161984e-01 -1.56584306e-01]
 [ 6.24488457e-01  1.19537712e+00 -2.20254978e-01]
 [-1.80163423e-04  3.28594954e-02 -5.84291332e-02]
 [-2.85382945e-01 -2.49858556e-02 -6.64089445e-01]
 [ 1.90123201e+00 -3.70481723e+00  3.15539585e+00]
 [ 3.37579982e-02 -8.87131092e-02  1.80694136e-02]
 [ 1.09308160e-01 -2.81236170e-02 -1.22120530e-02]
 [-1.04004197e-01 -9.73899028e-02 -4.38029756e-02]
 [-2.65471596e-01 -1.72486067e+00 -1.97509379e-01]
 [-4.57914274e-02  2.16958288e-01  4.78406760e-01]
 [ 2.94146417e-01  7.06309935e-02  6.13603059e-01]
 [ 7.67331769e-02 -3.61022498e-01 -6.52859416e-02]
 [ 1.30756644e-01 -5.24802947e-02 -1.06819562e-02]
 [ 3.45621549e-02  1.44828413e-01  8.89182625e-02]
 [ 9.88699442e-02 -2.26713855e-01 -1.06674505e-01]
 [-1.83044542e-02 -1.02402141e-01  4.02558903e-02]
 [ 1.16367941e-02 -2.77589599e-02  1.06619188e-01]
 [ 6.22866201e-01 -1.10963917e-01  3.06803510e-01]
 [ 2.20793661e-01 -4.39831280e-01 -3.27612355e-01]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 1.68604351e-01 -6.76667830e-02  5.06559472e-02]
 [-1.86247964e-02 -3.23775516e-02 -5.47577590e-02]
 [-5.56028530e-02  2.35855229e-02 -4.30970620e-02]
 [-3.46758278e-02 -5.83808206e-02  8.72143188e-03]
 [ 3.42373967e-01  6.38161003e-02  8.76129507e-02]
 [-6.90714518e-02 -4.39423097e-02  5.60315408e-02]
 [-9.89216254e-02 -4.50723681e-02 -8.49847373e-02]
 [ 1.66835920e+00  1.09901324e+00  1.46720608e-01]
 [-2.47440201e-02 -1.26285353e-01 -5.31408252e-02]
 [ 3.52521740e-02 -1.33982073e-02 -1.10033840e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.424376]
curr_Stock_Price:  100.13872748246769
curr_Factors:  [100.13872748  -0.93138076  -1.0152286 ]
mat_Sqrt:  [[14.2955333   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00037601 -0.02387485  0.37046466]
Stock Position:  0.0003760062700497824
Bond Position:  [3.38672321]


portfolio before change:  [3.42485863]
curr_Stock_Price:  100.29634621766671
curr_Factors:  [100.29634622  -1.31598538  -1.00679281]
mat_Sqrt:  [[ 9.82913639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.14046617 0.07689974 1.04860973]
Stock Position:  0.14046616588868246
Bond Position:  [-10.66338458]


portfolio before change:  [3.44589122]
curr_Stock_Price:  100.45557028113005
curr_Factors:  [100.45557028  -1.6156317   -0.99697847]
mat_Sqrt:  [[ 7.36769847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02367377 -0.02189839  0.09895175]
Stock Position:  -0.023673770897399322
Bond Position:  [5.82405337]


portfolio before change:  [3.44075328]
curr_Stock_Price:  100.70335451275398
curr_Factors:  [100.70335451  -1.67319474  -1.02270825]
mat_Sqrt:  [[ 6.7956053   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08278674 0.38754748 2.54020592]
Stock Position:  0.08278673834304653
Bond Position:  [-4.89614898]


portfolio before change:  [3.45959661]
curr_Stock_Price:  100.93836053437013
curr_Factors:  [100.93836053  -1.81252804  -1.02046721]
mat_Sqrt:  [[ 5.93884568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00987498 -0.01106097 -0.05874131]
Stock Position:  -0.009874983136459656
Bond Position:  [4.45636122]


portfolio before change:  [3.46002592]
curr_Stock_Price:  100.95129939995023
curr_Factors:  [100.9512994   -1.90551958  -1.02978775]
mat_Sqrt:  [[ 5.36196699  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00971905 -0.01921095  0.11824914]
Stock Position:  0.009719054545699447
Bond Position:  [2.47887473]


portfolio before change:  [3.45817368]
curr_Stock_Price:  100.72883773282926
curr_Factors:  [100.72883773  -1.99471062  -1.02259091]
mat_Sqrt:  [[ 4.92897275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01377334  0.03795587  0.03453161]
Stock Position:  -0.013773336140881344
Bond Position:  [4.84554582]


portfolio before change:  [3.45399073]
curr_Stock_Price:  101.076515155692
curr_Factors:  [101.07651516  -2.18940842  -1.04884624]
mat_Sqrt:  [[ 3.96546509  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01653889 -0.05574224 -0.21979651]
Stock Position:  0.016538892116918284
Bond Position:  [1.78229715]


portfolio before change:  [3.45356494]
curr_Stock_Price:  101.03729909771074
curr_Factors:  [101.0372991   -2.2069637   -1.07894248]
mat_Sqrt:  [[ 3.77946917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00455672  0.03616617 -0.15324493]
Stock Position:  -0.004556716103421895
Bond Position:  [3.91396323]


portfolio before change:  [3.45476836]
curr_Stock_Price:  100.8805758949808
curr_Factors:  [100.88057589  -2.24589634  -1.07524119]
mat_Sqrt:  [[ 3.64297211  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10905568 -0.03329539 -0.44669144]
Stock Position:  -0.10905568450242517
Bond Position:  [14.45636862]


portfolio before change:  [3.44152316]
curr_Stock_Price:  101.01860042326749
curr_Factors:  [101.01860042  -2.23421413  -1.06175786]
mat_Sqrt:  [[ 3.74092412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.22014198  0.38580631 -0.62832615]
Stock Position:  0.22014197697360247
Bond Position:  [-18.79691125]


portfolio before change:  [3.51620166]
curr_Stock_Price:  101.36850306267897
curr_Factors:  [101.36850306  -2.23353145  -1.06842009]
mat_Sqrt:  [[ 3.73150217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144702  0.01060536 -0.16668205]
Stock Position:  -0.0014470161468523098
Bond Position:  [3.66288352]


portfolio before change:  [3.51696983]
curr_Stock_Price:  101.15407500337204
curr_Factors:  [101.154075    -2.09048102  -1.08016874]
mat_Sqrt:  [[ 4.24607527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10033733 -0.00806415 -1.89446234]
Stock Position:  -0.10033732920027008
Bond Position:  [13.66649955]


portfolio before change:  [3.53825446]
curr_Stock_Price:  100.95897102868915
curr_Factors:  [100.95897103  -2.02758139  -1.07863424]
mat_Sqrt:  [[ 4.51993935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.39581988 -1.19572462  9.00146608]
Stock Position:  0.3958198782324594
Bond Position:  [-36.42331316]


portfolio before change:  [3.63256885]
curr_Stock_Price:  101.20875028148728
curr_Factors:  [101.20875028  -2.22144524  -1.08580855]
mat_Sqrt:  [[ 3.7059196   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00521811 -0.02863203  0.05154701]
Stock Position:  0.005218114888641987
Bond Position:  [3.10444997]


portfolio before change:  [3.6331394]
curr_Stock_Price:  101.24371720990193
curr_Factors:  [101.24371721  -2.10258247  -1.08800053]
mat_Sqrt:  [[ 4.16596383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02426201 -0.00907686 -0.03483759]
Stock Position:  0.024262014634975126
Bond Position:  [1.17676285]


portfolio before change:  [3.64285325]
curr_Stock_Price:  101.6380271355158
curr_Factors:  [101.63802714  -1.88291337  -1.11931223]
mat_Sqrt:  [[ 5.04900983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02630715 -0.03143246 -0.1249577 ]
Stock Position:  -0.026307152677515242
Bond Position:  [6.31666035]


portfolio before change:  [3.64544258]
curr_Stock_Price:  101.56961626529845
curr_Factors:  [101.56961627  -1.8885197   -1.09527683]
mat_Sqrt:  [[ 5.13945946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12800446 -0.55669639 -0.56343928]
Stock Position:  -0.12800446134329047
Bond Position:  [16.6468066]


portfolio before change:  [3.65293102]
curr_Stock_Price:  101.52737193778019
curr_Factors:  [101.52737194  -1.90375348  -1.10534269]
mat_Sqrt:  [[ 5.00897978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0191954  0.07002299 1.36476132]
Stock Position:  0.019195399650978284
Bond Position:  [1.70407254]


portfolio before change:  [3.65480532]
curr_Stock_Price:  101.61391719153437
curr_Factors:  [101.61391719  -1.91296559  -1.08250549]
mat_Sqrt:  [[ 5.08202308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08536268 0.02279606 1.75043873]
Stock Position:  0.0853626797089031
Bond Position:  [-5.01923095]


portfolio before change:  [3.64712883]
curr_Stock_Price:  101.53133960056189
curr_Factors:  [101.5313396   -1.91849213  -1.05987783]
mat_Sqrt:  [[ 5.16547754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199143 -0.11651951 -0.18624262]
Stock Position:  -0.0019914265031575236
Bond Position:  [3.84932103]


portfolio before change:  [3.64784776]
curr_Stock_Price:  101.41195823664853
curr_Factors:  [101.41195824  -1.55984141  -1.06908144]
mat_Sqrt:  [[ 7.31749574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01610711 -0.01693794 -0.03047265]
Stock Position:  0.01610710931255282
Bond Position:  [2.01439427]


portfolio before change:  [3.64830342]
curr_Stock_Price:  101.4246132687387
curr_Factors:  [101.42461327  -1.58514535  -1.04211395]
mat_Sqrt:  [[ 7.33059361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01122358 0.04674317 0.25365905]
Stock Position:  0.011223578828188377
Bond Position:  [2.50995627]


portfolio before change:  [3.65530764]
curr_Stock_Price:  102.02072051272695
curr_Factors:  [102.02072051  -1.69863998  -1.02921806]
mat_Sqrt:  [[ 6.66798618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00462168 -0.07317158 -0.30431267]
Stock Position:  0.004621684759523847
Bond Position:  [3.18380003]


portfolio before change:  [3.65677065]
curr_Stock_Price:  102.25115967918865
curr_Factors:  [102.25115968  -1.6308647   -1.06698035]
mat_Sqrt:  [[ 6.88666604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045     -0.03305015  0.11483885]
Stock Position:  -0.004500001073001293
Bond Position:  [4.11690098]


portfolio before change:  [3.6585419]
curr_Stock_Price:  101.97191547219086
curr_Factors:  [101.97191547  -1.91567347  -1.06703978]
mat_Sqrt:  [[ 5.16540849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00536919 -0.00895917  0.30415487]
Stock Position:  0.005369192139687685
Bond Position:  [3.11103509]


portfolio before change:  [3.6579001]
curr_Stock_Price:  101.7799490817606
curr_Factors:  [101.77994908  -1.84981864  -1.06476097]
mat_Sqrt:  [[ 5.51920325  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12009737 -0.03581345  0.87522502]
Stock Position:  0.12009736935827864
Bond Position:  [-8.56560404]


portfolio before change:  [3.58284545]
curr_Stock_Price:  101.16391665474112
curr_Factors:  [101.16391665  -1.89122863  -1.06793718]
mat_Sqrt:  [[ 5.24657947  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01222509 -0.14195494 -0.93458686]
Stock Position:  0.012225086001504624
Bond Position:  [2.34610787]


portfolio before change:  [3.58585848]
curr_Stock_Price:  101.38638915215573
curr_Factors:  [101.38638915  -1.86314245  -1.08570138]
mat_Sqrt:  [[ 5.3126726   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00415968 -0.02321455 -0.0028026 ]
Stock Position:  -0.004159682722965946
Bond Position:  [4.00759369]


portfolio before change:  [3.58572864]
curr_Stock_Price:  101.53804173195525
curr_Factors:  [101.53804173  -1.67528646  -1.10315966]
mat_Sqrt:  [[ 6.30906442  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02617377 -0.02183936  0.14450732]
Stock Position:  0.026173774364280433
Bond Position:  [0.92809484]


portfolio before change:  [3.59240929]
curr_Stock_Price:  101.78885152224963
curr_Factors:  [101.78885152  -1.77749471  -1.12312254]
mat_Sqrt:  [[ 5.59729438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00650515 -0.01044981 -0.15620864]
Stock Position:  -0.00650514601882092
Bond Position:  [4.25456064]


portfolio before change:  [3.59068286]
curr_Stock_Price:  102.13600580555432
curr_Factors:  [102.13600581  -1.53209467  -1.13169153]
mat_Sqrt:  [[ 7.1172336   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00837202  0.00761219 -0.12294392]
Stock Position:  -0.008372021016242378
Bond Position:  [4.44576765]


portfolio before change:  [3.59451512]
curr_Stock_Price:  101.74464170191182
curr_Factors:  [101.7446417   -1.40339724  -1.15528525]
mat_Sqrt:  [[ 7.87571266  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00568996 -0.01884233  0.02487982]
Stock Position:  -0.0056899622966572905
Bond Position:  [4.1734383]


portfolio before change:  [3.59188574]
curr_Stock_Price:  102.29844118241967
curr_Factors:  [102.29844118  -1.4853855   -1.1648197 ]
mat_Sqrt:  [[ 7.22602606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05165831 0.02059656 0.24993536]
Stock Position:  0.051658309761626185
Bond Position:  [-1.69267883]


portfolio before change:  [3.58264356]
curr_Stock_Price:  102.12362759721911
curr_Factors:  [102.1236276   -1.65466315  -1.18197543]
mat_Sqrt:  [[ 5.98673113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01112523 -0.01418232  0.15984239]
Stock Position:  -0.0111252278442565
Bond Position:  [4.71879219]


portfolio before change:  [3.58636502]
curr_Stock_Price:  101.84214424412325
curr_Factors:  [101.84214424  -1.65849234  -1.13434642]
mat_Sqrt:  [[ 6.23753613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02011522 -0.01454704 -0.2424378 ]
Stock Position:  -0.020115221506098322
Bond Position:  [5.63494231]


portfolio before change:  [3.59598148]
curr_Stock_Price:  101.39909390649477
curr_Factors:  [101.39909391  -1.28590652  -1.13340871]
mat_Sqrt:  [[ 9.02274777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.21308847 0.354705   0.41855306]
Stock Position:  0.21308847450317034
Bond Position:  [-18.01099675]


portfolio before change:  [3.76759303]
curr_Stock_Price:  102.21501351613122
curr_Factors:  [102.21501352  -1.33105674  -1.12753791]
mat_Sqrt:  [[ 8.7450158   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00701762 -0.04075842 -0.15159598]
Stock Position:  -0.007017624308998238
Bond Position:  [4.4848996]


portfolio before change:  [3.77154944]
curr_Stock_Price:  101.7311234736659
curr_Factors:  [101.73112347  -1.15282142  -1.13863152]
mat_Sqrt:  [[10.28699367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00097761 -0.00432425 -0.31389592]
Stock Position:  0.0009776143720514477
Bond Position:  [3.67209563]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.77194792]
Stock Price:  101.66917586222074
PL:  [2.10277206]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.58502693e-01  1.84793587e-02 -7.55376591e-02]
 [ 1.53825832e+00  3.05611316e-01  4.92683737e-01]
 [-2.07137510e-01 -1.04195406e-01  3.58385287e-02]
 [ 1.63136503e-01  1.23355159e+00  1.04289131e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 2.59237679e-02 -2.40764844e-02  3.69887869e-02]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [-1.68548803e-02  2.28443823e-01 -3.43169625e-02]
 [ 7.83371695e-03  7.20559062e-02 -4.76416942e-02]
 [-1.31995555e-01 -6.93698790e-02 -3.76110612e-02]
 [ 8.06276611e-01  1.54737162e+00 -2.81744148e-01]
 [-1.87009194e-05  2.86319476e-02 -5.86941593e-02]
 [-2.47606348e-01 -3.33566273e-03 -4.88484962e-01]
 [ 1.67453097e+00 -3.15508695e+00  2.64755772e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.32121310e-01 -4.31168836e-02 -5.61160233e-03]
 [-1.12631666e-01 -1.21056173e-01 -4.68941146e-02]
 [-2.67716694e-01 -1.75471275e+00 -2.03674393e-01]
 [ 6.80711382e-04  3.55023289e-02  6.88449812e-02]
 [ 2.27656961e-01 -3.59754453e-01  2.12011608e-01]
 [ 5.20860838e-02  3.23612951e-02  3.54805294e-02]
 [ 1.49701036e-01 -5.45688784e-02 -1.79585666e-02]
 [ 3.69988471e-01  1.71459241e-01  2.29442715e-01]
 [-2.24981625e-01  6.61079518e-02  3.10568454e-02]
 [-2.29746208e-02 -1.42757784e-01  5.12433764e-02]
 [ 5.08600585e-02 -7.17984421e-03  1.42046935e-01]
 [ 2.79050901e-01 -9.42988240e-02  1.15293147e-01]
 [-7.54855185e-02  4.22847004e-02  1.18326554e-01]
 [ 3.70194520e-03 -6.21360914e-02  1.90300440e-02]
 [-3.24491228e-02  8.24850331e-02  1.92812311e-02]
 [ 4.48517173e-02 -1.19369657e-02 -7.86836138e-02]
 [-4.65053040e-02  1.41285517e-02 -4.43680463e-02]
 [-1.06869707e-01 -2.83432700e-02  4.13083005e-02]
 [ 1.02583100e-01 -1.41992713e-02  1.69576153e-02]
 [-9.22867692e-02 -1.33919426e-02  5.74825870e-02]
 [-1.17313800e-01 -6.80773841e-02 -8.01021215e-02]
 [ 1.25729374e+00  8.37906485e-01  1.29956961e-01]
 [ 5.82956701e-03 -1.26260802e-01 -2.36110032e-02]
 [ 3.29779462e-02 -1.45146168e-02 -7.15176037e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.81569094]
curr_Stock_Price:  101.55674293980101
curr_Factors:  [101.55674294  -1.12594508  -1.03345835]
mat_Sqrt:  [[11.71903276  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01253139  0.00596419 -0.21548792]
Stock Position:  0.012531385435757068
Bond Position:  [12.54304425]


portfolio before change:  [13.80961799]
curr_Stock_Price:  100.94699970982616
curr_Factors:  [100.94699971  -1.3506228   -1.03431691]
mat_Sqrt:  [[ 9.2966666   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.18299135 0.09863563 1.40548956]
Stock Position:  0.18299135455899643
Bond Position:  [-4.66281023]


portfolio before change:  [13.68814868]
curr_Stock_Price:  100.28638696052086
curr_Factors:  [100.28638696  -1.2016641   -1.03963873]
mat_Sqrt:  [[10.66243836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02073548 -0.03362892  0.10223735]
Stock Position:  -0.02073548205198891
Bond Position:  [15.76763525]


portfolio before change:  [13.69507478]
curr_Stock_Price:  100.0474233785245
curr_Factors:  [100.04742338  -1.02378429  -1.0415785 ]
mat_Sqrt:  [[12.68324096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04949945 0.39812706 2.97507863]
Stock Position:  0.04949945109625849
Bond Position:  [8.74278224]


portfolio before change:  [13.72665575]
curr_Stock_Price:  100.66335042604932
curr_Factors:  [100.66335043  -1.00714584  -1.02828182]
mat_Sqrt:  [[13.14911061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00446007 -0.01106097 -0.05874131]
Stock Position:  -0.004460073587373471
Bond Position:  [14.1756217]


portfolio before change:  [13.73161706]
curr_Stock_Price:  99.94828473316342
curr_Factors:  [99.94828473 -1.08150438 -1.02026012]
mat_Sqrt:  [[12.21773271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00233754 -0.00777065  0.10551871]
Stock Position:  0.0023375434139980573
Bond Position:  [13.4979836]


portfolio before change:  [13.73487213]
curr_Stock_Price:  100.6189544391738
curr_Factors:  [100.61895444  -1.09374901  -1.02055079]
mat_Sqrt:  [[12.14649753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00545757 -0.00251018 -0.21167328]
Stock Position:  -0.005457566904372335
Bond Position:  [14.28400681]


portfolio before change:  [13.73986768]
curr_Stock_Price:  100.03079156677654
curr_Factors:  [100.03079157  -1.15936864  -1.00227471]
mat_Sqrt:  [[11.51712089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197715  0.07372993 -0.09789674]
Stock Position:  0.0019771520533193422
Bond Position:  [13.5420916]


portfolio before change:  [13.74152298]
curr_Stock_Price:  100.01179211298341
curr_Factors:  [100.01179211  -1.05875458  -1.01928247]
mat_Sqrt:  [[12.51904457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00102382  0.02325594 -0.13590849]
Stock Position:  0.0010238199117400095
Bond Position:  [13.63912892]


portfolio before change:  [13.74377193]
curr_Stock_Price:  100.54309136106448
curr_Factors:  [100.54309136  -0.9721733   -1.00068801]
mat_Sqrt:  [[13.98136105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01100272 -0.02238903 -0.10729389]
Stock Position:  -0.011002716244245231
Bond Position:  [14.85001904]


portfolio before change:  [13.74245451]
curr_Stock_Price:  100.83154646263077
curr_Factors:  [100.83154646  -1.21048937  -0.99599982]
mat_Sqrt:  [[11.10018834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09591024  0.49941204 -0.80373763]
Stock Position:  0.09591024093505833
Bond Position:  [4.0716766]


portfolio before change:  [13.70677063]
curr_Stock_Price:  100.45418448411588
curr_Factors:  [100.45418448  -1.0837048   -1.00578749]
mat_Sqrt:  [[12.43120012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049514  0.00924092 -0.1674381 ]
Stock Position:  -0.0004951351547990921
Bond Position:  [13.75650902]


portfolio before change:  [13.70802818]
curr_Stock_Price:  101.38749304262379
curr_Factors:  [101.38749304  -1.07555298  -1.02766414]
mat_Sqrt:  [[12.37567222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.81195887e-02 -1.07658052e-03 -1.39351163e+00]
Stock Position:  -0.02811958870522432
Bond Position:  [16.55900279]


portfolio before change:  [13.71868934]
curr_Stock_Price:  101.08197112596581
curr_Factors:  [101.08197113  -0.80567521  -1.02869444]
mat_Sqrt:  [[16.14422065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09730615 -1.01829993  7.55274522]
Stock Position:  0.09730615237723447
Bond Position:  [3.88279165]


portfolio before change:  [13.78717725]
curr_Stock_Price:  101.78082239403427
curr_Factors:  [101.78082239  -0.87135035  -1.03844635]
mat_Sqrt:  [[15.07480784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143746 -0.03053791  0.10625201]
Stock Position:  -0.0014374559931111975
Bond Position:  [13.9334827]


portfolio before change:  [13.78902323]
curr_Stock_Price:  101.7083424225119
curr_Factors:  [101.70834242  -0.96612967  -1.04802575]
mat_Sqrt:  [[13.57125445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00900246 -0.01391591 -0.01600834]
Stock Position:  0.00900245806566031
Bond Position:  [12.87339814]


portfolio before change:  [13.78903446]
curr_Stock_Price:  101.53083079346631
curr_Factors:  [101.53083079  -0.63312959  -1.0783524 ]
mat_Sqrt:  [[18.33626001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00801223 -0.03907071 -0.13377586]
Stock Position:  -0.008012232316337662
Bond Position:  [14.60252307]


portfolio before change:  [13.78231118]
curr_Stock_Price:  102.5977879895969
curr_Factors:  [102.59778799  -0.64968651  -1.11271997]
mat_Sqrt:  [[17.60899571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0379051  -0.5663311  -0.58102635]
Stock Position:  -0.03790510294988186
Bond Position:  [17.6712909]


portfolio before change:  [13.80763441]
curr_Stock_Price:  101.98799724010736
curr_Factors:  [101.98799724  -0.64556193  -1.1043623 ]
mat_Sqrt:  [[17.72419941  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00124014 0.01145833 0.19639557]
Stock Position:  0.001240141590588566
Bond Position:  [13.68115486]


portfolio before change:  [13.81012756]
curr_Stock_Price:  102.61929526094329
curr_Factors:  [102.61929526  -0.7186707   -1.10603231]
mat_Sqrt:  [[16.54895521  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01193423 -0.11611025  0.6048101 ]
Stock Position:  0.011934232468207436
Bond Position:  [12.58544504]


portfolio before change:  [13.81053273]
curr_Stock_Price:  102.52141590357837
curr_Factors:  [102.5214159   -0.47428597  -1.108911  ]
mat_Sqrt:  [[21.0494565   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00313235 0.01044456 0.10121607]
Stock Position:  0.0031323487253511564
Bond Position:  [13.4893999]


portfolio before change:  [13.8108818]
curr_Stock_Price:  102.09451230217148
curr_Factors:  [102.0945123   -0.31229479  -1.11218507]
mat_Sqrt:  [[24.56736938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00549088 -0.01761203 -0.05123079]
Stock Position:  0.005490878196954192
Bond Position:  [13.25029327]


portfolio before change:  [13.81415075]
curr_Stock_Price:  102.38819315815218
curr_Factors:  [102.38819316  -0.49686235  -1.14216145]
mat_Sqrt:  [[19.88066413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02272672 0.05533823 0.6545362 ]
Stock Position:  0.022726717630672383
Bond Position:  [11.4872032]


portfolio before change:  [13.8033498]
curr_Stock_Price:  101.84975456088088
curr_Factors:  [101.84975456  -0.76524235  -1.11765259]
mat_Sqrt:  [[15.49633891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01323848  0.02133625  0.08859654]
Stock Position:  -0.013238478163631908
Bond Position:  [15.15168555]


portfolio before change:  [13.80406131]
curr_Stock_Price:  101.93908308702511
curr_Factors:  [101.93908309  -1.05338796  -1.14131716]
mat_Sqrt:  [[11.35513753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366838 -0.04607488  0.14618309]
Stock Position:  -0.003668376615737849
Bond Position:  [14.17801225]


portfolio before change:  [13.80820417]
curr_Stock_Price:  101.29288449346424
curr_Factors:  [101.29288449  -0.83035667  -1.14166129]
mat_Sqrt:  [[14.09751027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00556053 -0.00231728  0.40522037]
Stock Position:  0.005560534207763242
Bond Position:  [13.24496162]


portfolio before change:  [13.80888794]
curr_Stock_Price:  101.11808920022884
curr_Factors:  [101.1180892   -0.81073321  -1.16624172]
mat_Sqrt:  [[14.00359532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02023311 -0.03043481  0.32889926]
Stock Position:  0.020233114658490304
Bond Position:  [11.76295404]


portfolio before change:  [13.80672376]
curr_Stock_Price:  100.93845096430641
curr_Factors:  [100.93845096  -0.79624298  -1.12993347]
mat_Sqrt:  [[14.7071605   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00290341  0.01364733  0.33755272]
Stock Position:  -0.002903407728194289
Bond Position:  [14.09978924]


portfolio before change:  [13.81105956]
curr_Stock_Price:  100.05217686684632
curr_Factors:  [100.05217687  -0.54102787  -1.11484293]
mat_Sqrt:  [[19.10253441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026683 -0.02005434  0.05428742]
Stock Position:  -0.0002668253212512916
Bond Position:  [13.83775601]


portfolio before change:  [13.81302764]
curr_Stock_Price:  99.15923724141197
curr_Factors:  [99.15923724 -0.66518407 -1.10267098]
mat_Sqrt:  [[16.92635647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068982  0.02662193  0.05500399]
Stock Position:  -0.0006898218839040581
Bond Position:  [13.88142985]


portfolio before change:  [13.81547034]
curr_Stock_Price:  98.1337401634061
curr_Factors:  [98.13374016 -0.90321611 -1.0922921 ]
mat_Sqrt:  [[13.34074701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197544 -0.00385264 -0.22446245]
Stock Position:  0.0019754417780260343
Bond Position:  [13.62161285]


portfolio before change:  [13.81734947]
curr_Stock_Price:  98.22299484973412
curr_Factors:  [98.22299485 -1.13248451 -1.10475189]
mat_Sqrt:  [[10.48561122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00502383  0.00455997 -0.12656969]
Stock Position:  -0.005023828738756088
Bond Position:  [14.31080497]


portfolio before change:  [13.81759506]
curr_Stock_Price:  98.53020419782705
curr_Factors:  [98.5302042  -1.09359438 -1.15726704]
mat_Sqrt:  [[10.37606519  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01004458 -0.00914775  0.11784108]
Stock Position:  -0.010044581400353586
Bond Position:  [14.80728972]


portfolio before change:  [13.82302258]
curr_Stock_Price:  98.17414278636835
curr_Factors:  [98.17414279 -1.35354796 -1.15937868]
mat_Sqrt:  [[ 7.95512387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.012966   -0.0045828   0.04837536]
Stock Position:  0.012966001125672292
Bond Position:  [12.55009653]


portfolio before change:  [13.8332093]
curr_Stock_Price:  98.83879380858745
curr_Factors:  [98.83879381 -1.40486691 -1.17617435]
mat_Sqrt:  [[ 7.48161678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01113219 -0.00432223  0.16398182]
Stock Position:  -0.011132193286236616
Bond Position:  [14.93350186]


portfolio before change:  [13.83641678]
curr_Stock_Price:  98.71836204935373
curr_Factors:  [98.71836205 -1.24404805 -1.15892806]
mat_Sqrt:  [[ 8.92891469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01652618 -0.02197188 -0.22850906]
Stock Position:  -0.016526175960831224
Bond Position:  [15.4678538]


portfolio before change:  [13.85529468]
curr_Stock_Price:  97.69306112897135
curr_Factors:  [97.69306113 -1.0627313  -1.17802543]
mat_Sqrt:  [[10.39238994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.13999263 0.27043316 0.37073104]
Stock Position:  0.13999263390694677
Bond Position:  [0.17898574]


portfolio before change:  [13.97389825]
curr_Stock_Price:  98.5401142522271
curr_Factors:  [98.54011425 -1.1654386  -1.18855749]
mat_Sqrt:  [[ 9.36020916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264555 -0.0407505  -0.06735562]
Stock Position:  -0.002645548482816421
Bond Position:  [14.2345909]


portfolio before change:  [13.97756062]
curr_Stock_Price:  97.82837798630813
curr_Factors:  [97.82837799 -1.01525291 -1.18524555]
mat_Sqrt:  [[10.83429142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00142295 -0.00468457 -0.20401982]
Stock Position:  0.001422953488518501
Bond Position:  [13.83835539]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.97987019]
Stock Price:  98.23574865656421
PL:  [13.97987019]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-3.97192057e-02 -4.34513756e-02  2.87001042e-01]
 [ 3.77658538e-01  1.86134522e-01  8.43073193e-02]
 [-2.92560258e-01 -1.82825282e-01  3.83301885e-02]
 [ 1.59960223e-01  9.49690654e-01  9.73271567e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 3.50048036e-02  6.73653851e-02 -3.40344367e-02]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [-5.70905633e-02  1.09863310e-01  6.39973058e-03]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 8.64106693e-01  1.85336980e+00 -2.52422571e-01]
 [-3.84281526e-03 -3.36189985e-01  5.57709780e-01]
 [-6.05477568e-01 -5.24304574e-02 -1.23503655e+00]
 [ 1.86998157e+00 -2.72289624e+00  2.31219218e+00]
 [ 5.56275014e-03 -4.61676389e-02 -3.75802204e-02]
 [ 1.58175132e-02  5.50650499e-01 -3.07635376e-01]
 [ 1.86103019e-02 -1.89409272e-01 -1.15083296e-01]
 [-3.14317827e-01 -1.99859772e+00 -1.95908529e-01]
 [ 3.67237802e-02 -9.29441923e-02  5.44595657e-02]
 [-2.44968713e-01  1.88958296e-01 -2.08109838e-02]
 [ 1.36325327e-02  1.40822964e-01 -8.97921207e-02]
 [ 8.35722636e-02 -4.65005529e-02  5.20959320e-02]
 [ 2.22248883e-02 -1.23170094e-01 -1.24043072e-01]
 [-2.67200784e-01  9.68442785e-02  1.86196888e-02]
 [ 1.23529100e-01 -1.53849532e-02 -4.30316640e-02]
 [ 5.25853934e-02 -4.11879939e-02  2.95996435e-01]
 [-1.96084260e-01 -1.29862823e-01 -7.31658628e-02]
 [-1.52507470e-01  1.08637573e-01  2.25805435e-01]
 [ 5.47292981e-02  1.78150416e-02  1.38504446e-01]
 [-1.19085046e-01  1.10433287e-01 -1.20292228e-02]
 [ 5.86175394e-02 -1.56711171e-02 -8.09959954e-02]
 [-4.15487185e-02  1.12970050e-02 -4.48449387e-02]
 [-8.63400563e-02 -2.35936843e-02  3.77336623e-02]
 [-3.85563745e-02 -2.53542332e-02 -6.94636233e-03]
 [-1.00525844e-01  5.82244487e-02  3.45042475e-02]
 [-1.11768370e-01 -6.35863259e-02 -7.46476937e-02]
 [ 1.17216886e+00  7.84066383e-01  1.26530487e-01]
 [ 3.75888233e-02 -9.87964542e-02  2.51039082e-02]
 [ 3.32666480e-02 -1.45577971e-02 -7.72947833e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.48534939]
curr_Stock_Price:  99.05935370476683
curr_Factors:  [99.0593537  -0.74968788 -1.01265877]
mat_Sqrt:  [[17.00270682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.87857093e-04 -1.40238712e-02  8.18734087e-01]
Stock Position:  0.0005878570927361868
Bond Position:  [-4.54358213]


portfolio before change:  [-4.48598767]
curr_Stock_Price:  98.93977739400091
curr_Factors:  [98.93977739 -0.62047721 -1.01773225]
mat_Sqrt:  [[19.2267378   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02251356 0.06007466 0.24050532]
Stock Position:  0.022513556505519502
Bond Position:  [-6.71347394]


portfolio before change:  [-4.46927629]
curr_Stock_Price:  99.71933514968487
curr_Factors:  [99.71933515 -0.79957857 -1.04651897]
mat_Sqrt:  [[15.74089426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02045978 -0.05900661  0.10934536]
Stock Position:  -0.02045977758565546
Bond Position:  [-2.42904087]


portfolio before change:  [-4.47921969]
curr_Stock_Price:  100.19049135907882
curr_Factors:  [100.19049136  -0.58377793  -1.03305165]
mat_Sqrt:  [[19.89052923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0277762  0.30651134 2.77647287]
Stock Position:  0.02777619622716501
Bond Position:  [-7.26213043]


portfolio before change:  [-4.46492137]
curr_Stock_Price:  100.73794333918309
curr_Factors:  [100.73794334  -0.31351685  -1.02642635]
mat_Sqrt:  [[26.37929237  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00222318 -0.01106097 -0.05874131]
Stock Position:  -0.002223183249566853
Bond Position:  [-4.24096247]


portfolio before change:  [-4.46657178]
curr_Stock_Price:  101.2418406181332
curr_Factors:  [101.24184062  -0.36663318  -1.04579331]
mat_Sqrt:  [[24.65761126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169556  0.02174208 -0.09709077]
Stock Position:  0.0016955598207699283
Bond Position:  [-4.63823338]


portfolio before change:  [-4.46758336]
curr_Stock_Price:  100.98720036725935
curr_Factors:  [100.98720037  -0.43379093  -1.04107379]
mat_Sqrt:  [[23.1068487   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286886 -0.00251018 -0.21167328]
Stock Position:  -0.0028688603879054924
Bond Position:  [-4.17786518]


portfolio before change:  [-4.46362409]
curr_Stock_Price:  99.42507180365904
curr_Factors:  [99.4250718  -0.48215368 -1.06128361]
mat_Sqrt:  [[21.24171682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00157042  0.03545823  0.01825665]
Stock Position:  -0.0015704224798126225
Bond Position:  [-4.30748473]


portfolio before change:  [-4.46146963]
curr_Stock_Price:  97.71028736046739
curr_Factors:  [97.71028736 -0.19246866 -1.0566073 ]
mat_Sqrt:  [[28.02034612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185548  0.0064198  -0.11330016]
Stock Position:  0.0018554804109560128
Bond Position:  [-4.64276915]


portfolio before change:  [-4.4634484]
curr_Stock_Price:  96.95663297378418
curr_Factors:  [96.95663297 -0.11627721 -1.06532537]
mat_Sqrt:  [[29.74500513  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.93854126e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  2.9385412553275573e-05
Bond Position:  [-4.46629751]


portfolio before change:  [-4.46403949]
curr_Stock_Price:  95.84155302377833
curr_Factors:  [ 9.58415530e+01  7.24660170e-02 -1.04339051e+00]
mat_Sqrt:  [[36.29833403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03280863  0.59817253 -0.72009134]
Stock Position:  0.032808631862883686
Bond Position:  [-7.60846972]


portfolio before change:  [-4.54338583]
curr_Stock_Price:  93.45208359503867
curr_Factors:  [93.4520836   0.12526943 -1.05890217]
mat_Sqrt:  [[36.73816333  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.12620555e-03 -1.08504851e-01  1.59099077e+00]
Stock Position:  0.0011262055501955143
Bond Position:  [-4.64863209]


portfolio before change:  [-4.54291447]
curr_Stock_Price:  94.38661416677687
curr_Factors:  [94.38661417  0.41956542 -1.09420477]
mat_Sqrt:  [[48.07488564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.018061   -0.01692186 -3.5232155 ]
Stock Position:  -0.018061003337004035
Bond Position:  [-2.83819752]


portfolio before change:  [-4.52936024]
curr_Stock_Price:  93.6165002537037
curr_Factors:  [93.61650025  0.21413349 -1.11433528]
mat_Sqrt:  [[38.05394886  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04693723 -0.87881098  6.59604069]
Stock Position:  0.04693723013499853
Bond Position:  [-8.92345946]


portfolio before change:  [-4.50893383]
curr_Stock_Price:  94.07545173423833
curr_Factors:  [94.07545173  0.12359545 -1.15285008]
mat_Sqrt:  [[33.61063426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034311 -0.01490054 -0.10720591]
Stock Position:  -0.0003431119438373498
Bond Position:  [-4.47665542]


portfolio before change:  [-4.50863444]
curr_Stock_Price:  91.57188241357048
curr_Factors:  [91.57188241  0.28752344 -1.14149078]
mat_Sqrt:  [[38.98421889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00167819  0.17772168 -0.8775981 ]
Stock Position:  0.001678185921382608
Bond Position:  [-4.66230909]


portfolio before change:  [-4.50676062]
curr_Stock_Price:  93.035754619256
curr_Factors:  [93.03575462  0.11610668 -1.13348916]
mat_Sqrt:  [[33.63615048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129456 -0.06113158 -0.32830061]
Stock Position:  -0.0012945590601735784
Bond Position:  [-4.38632034]


portfolio before change:  [-4.50783068]
curr_Stock_Price:  93.43877562735798
curr_Factors:  [93.43877563 -0.16778163 -1.15006268]
mat_Sqrt:  [[25.01466149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03047291 -0.64504464 -0.5588725 ]
Stock Position:  -0.03047291045607346
Bond Position:  [-1.66047923]


portfolio before change:  [-4.55835953]
curr_Stock_Price:  95.09012029398716
curr_Factors:  [95.09012029 -0.10832255 -1.16192771]
mat_Sqrt:  [[26.69763066  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0010813  -0.02999761  0.15535798]
Stock Position:  0.0010812996509297502
Bond Position:  [-4.66118044]


portfolio before change:  [-4.55970116]
curr_Stock_Price:  94.38823203955369
curr_Factors:  [94.38823204 -0.11436924 -1.16804512]
mat_Sqrt:  [[26.18016452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00804601  0.06098603 -0.05936794]
Stock Position:  -0.008046007001200046
Bond Position:  [-3.80025279]


portfolio before change:  [-4.55330229]
curr_Stock_Price:  93.53390285876203
curr_Factors:  [93.53390286 -0.36619951 -1.1907185 ]
mat_Sqrt:  [[19.7155163   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00121981  0.04545042 -0.25615193]
Stock Position:  0.0012198087826626645
Bond Position:  [-4.66739576]


portfolio before change:  [-4.5543421]
curr_Stock_Price:  93.15978757226974
curr_Factors:  [93.15978757 -0.47569599 -1.22516351]
mat_Sqrt:  [[17.00413694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00498199 -0.01500799  0.14861519]
Stock Position:  0.004981988555838903
Bond Position:  [-5.01846309]


portfolio before change:  [-4.5550752]
curr_Stock_Price:  93.13855961395738
curr_Factors:  [93.13855961 -0.21801463 -1.21915867]
mat_Sqrt:  [[22.12957537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001276   -0.03975298 -0.35386036]
Stock Position:  -0.0012759977212204524
Bond Position:  [-4.43623061]


portfolio before change:  [-4.55536142]
curr_Stock_Price:  92.92826046904655
curr_Factors:  [92.92826047 -0.2632352  -1.19729471]
mat_Sqrt:  [[21.5698799   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.011295    0.03125636  0.05311679]
Stock Position:  -0.01129500033385895
Bond Position:  [-3.50573669]


portfolio before change:  [-4.55522134]
curr_Stock_Price:  92.87705875811214
curr_Factors:  [92.87705876 -0.1071259  -1.21688882]
mat_Sqrt:  [[24.71133262  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00451634 -0.00496547 -0.12275736]
Stock Position:  0.004516343157300844
Bond Position:  [-4.97468601]


portfolio before change:  [-4.54305328]
curr_Stock_Price:  95.70898187238468
curr_Factors:  [ 9.57089819e+01 -5.50633278e-02 -1.21133270e+00]
mat_Sqrt:  [[26.97515139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00387757 -0.01329337  0.84439544]
Stock Position:  0.003877566694304902
Bond Position:  [-4.91417124]


portfolio before change:  [-4.54036767]
curr_Stock_Price:  96.56001221939786
curr_Factors:  [96.56001222 -0.34008051 -1.16675997]
mat_Sqrt:  [[21.39857271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01110015 -0.04191305 -0.20872184]
Stock Position:  -0.011100147651324988
Bond Position:  [-3.46853727]


portfolio before change:  [-4.54956105]
curr_Stock_Price:  97.34917199213331
curr_Factors:  [97.34917199 -0.40683624 -1.17117591]
mat_Sqrt:  [[20.09140436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00419282  0.03506263  0.64416005]
Stock Position:  -0.004192816747365362
Bond Position:  [-4.14139381]


portfolio before change:  [-4.54732268]
curr_Stock_Price:  96.6918402547821
curr_Factors:  [96.69184025 -0.74875282 -1.16530283]
mat_Sqrt:  [[14.2602132   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0060755  0.00574978 0.39511463]
Stock Position:  0.006075496812150395
Bond Position:  [-5.13477365]


portfolio before change:  [-4.54596979]
curr_Stock_Price:  97.02017235444576
curr_Factors:  [97.02017235 -0.67403921 -1.15657873]
mat_Sqrt:  [[15.55373774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00636493  0.03564219 -0.03431602]
Stock Position:  -0.006364926680607084
Bond Position:  [-3.92844351]


portfolio before change:  [-4.5468046]
curr_Stock_Price:  97.07417427246018
curr_Factors:  [97.07417427 -0.77025256 -1.13218365]
mat_Sqrt:  [[14.48392131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00268473 -0.00505783 -0.23105903]
Stock Position:  0.0026847320453419828
Bond Position:  [-4.80742274]


portfolio before change:  [-4.54517381]
curr_Stock_Price:  97.90544788154311
curr_Factors:  [97.90544788 -0.91916758 -1.13480541]
mat_Sqrt:  [[12.5538728   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00385512  0.00364609 -0.12793013]
Stock Position:  -0.003855118062563089
Bond Position:  [-4.16773675]


portfolio before change:  [-4.546455]
curr_Stock_Price:  98.10263783172054
curr_Factors:  [98.10263783 -0.85515786 -1.1445655 ]
mat_Sqrt:  [[13.28042165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00628397 -0.00761483  0.10764364]
Stock Position:  -0.006283968051755943
Bond Position:  [-3.92998116]


portfolio before change:  [-4.54075133]
curr_Stock_Price:  97.11680323179124
curr_Factors:  [97.11680323 -0.67225735 -1.1524948 ]
mat_Sqrt:  [[15.66082339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288297 -0.00818304 -0.01981604]
Stock Position:  -0.0028829714040293436
Bond Position:  [-4.26076636]


portfolio before change:  [-4.54017653]
curr_Stock_Price:  96.73267650935622
curr_Factors:  [96.73267651 -0.51573851 -1.17058587]
mat_Sqrt:  [[17.91479459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00455476  0.01879186  0.09843101]
Stock Position:  -0.004554764908120782
Bond Position:  [-4.09958193]


portfolio before change:  [-4.54022422]
curr_Stock_Price:  96.63063188141211
curr_Factors:  [96.63063188 -0.91599718 -1.17783055]
mat_Sqrt:  [[11.90630463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01175724 -0.0205224  -0.21294909]
Stock Position:  -0.011757239206565831
Bond Position:  [-3.40411477]


portfolio before change:  [-4.54314225]
curr_Stock_Price:  96.84262801107766
curr_Factors:  [96.84262801 -0.92117755 -1.18400874]
mat_Sqrt:  [[11.79765724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.1151113  0.25305634 0.36095626]
Stock Position:  0.11511130091040138
Bond Position:  [-15.69082315]


portfolio before change:  [-4.57581266]
curr_Stock_Price:  96.57585202831208
curr_Factors:  [96.57585203 -0.89669866 -1.20522924]
mat_Sqrt:  [[11.80355591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00191014 -0.03188642  0.07161446]
Stock Position:  0.0019101358525043834
Bond Position:  [-4.76028566]


portfolio before change:  [-4.57393206]
curr_Stock_Price:  97.87192425562596
curr_Factors:  [97.87192426 -0.93597145 -1.26073925]
mat_Sqrt:  [[10.88024796  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133428 -0.00469851 -0.2205005 ]
Stock Position:  0.0013342819563540791
Bond Position:  [-4.7045208]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.57625305]
Stock Price:  96.57318277780945
PL:  [-4.57625305]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.02613815e-02 -1.00361033e-01  1.29493089e-02]
 [ 9.82159312e-01  2.15078039e-01  2.70903920e-01]
 [-2.19722181e-01 -1.15779336e-01  3.62056056e-02]
 [ 1.21687994e-01  1.05925970e+00  7.98579182e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 5.03180298e-02 -5.94379143e-02  4.47121902e-02]
 [-4.83771458e-02 -1.53262502e-02 -6.91552743e-02]
 [ 5.56501623e-02  1.54501400e-01 -4.36713631e-02]
 [-8.95215492e-03  9.02209324e-02 -5.04014262e-02]
 [-3.89435705e-01 -2.19514978e-02 -1.56874442e-01]
 [ 6.46717112e-01  1.25321138e+00 -2.24046725e-01]
 [-2.40707406e-04  2.54155064e-02 -5.79398589e-02]
 [-1.63164055e-01 -2.02681061e-02 -4.10825229e-01]
 [ 1.78569337e+00 -3.48033022e+00  2.97367215e+00]
 [-4.98067948e-03 -9.37791586e-02  3.67297048e-02]
 [ 1.36231702e-01 -4.31710087e-02 -6.33211071e-03]
 [-1.16488341e-01 -1.28629096e-01 -4.45169844e-02]
 [-2.67877116e-01 -1.75142406e+00 -2.02156414e-01]
 [-1.02013737e-03  3.54176521e-02  8.75133257e-02]
 [ 1.88777540e-01 -1.13885275e-01  3.06973118e-01]
 [ 5.10880382e-02 -7.37637674e-02  6.67732255e-02]
 [ 1.47641930e-01 -5.43483658e-02 -1.69719472e-02]
 [ 1.58474627e-01  2.10593064e-01  1.79408802e-01]
 [-9.99538779e-02 -5.63580503e-03  1.02505491e-01]
 [-5.65655076e-02 -1.99881534e-01  7.74916334e-02]
 [ 8.43245734e-02 -1.81897082e-02 -2.68959067e-02]
 [ 5.16840099e-01 -8.19069897e-02  2.68510878e-01]
 [ 1.77722954e-02 -9.62097929e-02  7.70188758e-03]
 [-7.59275168e-03 -7.25644480e-02 -1.03651592e-03]
 [-1.20579662e-02  5.50417386e-02  6.86249479e-02]
 [-2.39346025e-02 -2.37441900e-02 -5.85651096e-02]
 [-1.40069097e-02  2.07093152e-02 -5.52550887e-02]
 [-1.07038551e-01 -4.17917442e-02  2.00185287e-02]
 [ 3.68981793e-01  5.87707136e-02  8.45974541e-02]
 [ 1.35278054e-01 -2.92995485e-02 -3.52008191e-02]
 [-9.21171900e-02 -2.65588559e-02 -1.05671160e-01]
 [ 1.47618220e+00  1.03358438e+00  1.49927095e-01]
 [-2.59044938e-02 -5.63552754e-02 -3.70782697e-02]
 [ 3.59675178e-02 -1.34403370e-02 -1.23738563e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.27939997]
curr_Stock_Price:  99.98248222174165
curr_Factors:  [99.98248222 -1.01671958 -1.01636462]
mat_Sqrt:  [[13.09081437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057914 -0.03239138  0.03694077]
Stock Position:  -0.0005791436513199315
Bond Position:  [2.33730418]


portfolio before change:  [2.27966073]
curr_Stock_Price:  100.03673628060668
curr_Factors:  [100.03673628  -0.96581703  -1.04662897]
mat_Sqrt:  [[13.37104401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08087326 0.06941614 0.77281348]
Stock Position:  0.08087326339532427
Bond Position:  [-5.8106366]


portfolio before change:  [2.2894735]
curr_Stock_Price:  100.16705310904845
curr_Factors:  [100.16705311  -1.21882306  -1.05966034]
mat_Sqrt:  [[10.26105771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02299618 -0.03736762  0.10328452]
Stock Position:  -0.02299617710008582
Bond Position:  [4.59293279]


portfolio before change:  [2.27270326]
curr_Stock_Price:  100.92128237860571
curr_Factors:  [100.92128238  -1.22037823  -1.04686488]
mat_Sqrt:  [[10.45518178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04791096 0.3418746  2.27812412]
Stock Position:  0.047910957243810184
Bond Position:  [-2.56253198]


portfolio before change:  [2.25420429]
curr_Stock_Price:  100.54185690259695
curr_Factors:  [100.5418569   -1.23898924  -1.02027655]
mat_Sqrt:  [[10.49929732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00558571 -0.01106097 -0.05874131]
Stock Position:  -0.005585707229204542
Bond Position:  [2.81580166]


portfolio before change:  [2.25400032]
curr_Stock_Price:  100.64139039539658
curr_Factors:  [100.6413904   -1.35013622  -1.03206252]
mat_Sqrt:  [[ 9.29396131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00509063 -0.0191835   0.12755143]
Stock Position:  0.005090633840303162
Bond Position:  [1.74167185]


portfolio before change:  [2.25542246]
curr_Stock_Price:  100.87798549363511
curr_Factors:  [100.87798549  -1.36155927  -1.03386235]
mat_Sqrt:  [[ 9.19343923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0071379  -0.00494653 -0.19728075]
Stock Position:  -0.007137901625467891
Bond Position:  [2.9754796]


portfolio before change:  [2.25561928]
curr_Stock_Price:  100.90252241944988
curr_Factors:  [100.90252242  -1.26668146  -1.04884456]
mat_Sqrt:  [[ 9.96051636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00785835  0.04986511 -0.12458224]
Stock Position:  0.007858352525543339
Bond Position:  [1.46269168]


portfolio before change:  [2.26521358]
curr_Stock_Price:  102.1001601478324
curr_Factors:  [102.10016015  -1.44611942  -1.0692208 ]
mat_Sqrt:  [[ 8.25330787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.98426645e-05  2.91186807e-02 -1.43781240e-01]
Stock Position:  -9.98426644975534e-05
Bond Position:  [2.27540754]


portfolio before change:  [2.26548659]
curr_Stock_Price:  102.21473737947024
curr_Factors:  [102.21473738  -1.63219262  -1.07074268]
mat_Sqrt:  [[ 6.8492597   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06218751 -0.00708482 -0.44751912]
Stock Position:  -0.06218750867737269
Bond Position:  [8.62196646]


portfolio before change:  [2.26878251]
curr_Stock_Price:  102.17906932099446
curr_Factors:  [102.17906932  -1.50471166  -1.08300878]
mat_Sqrt:  [[ 7.68297176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11151863  0.40447223 -0.63914294]
Stock Position:  0.1115186277245174
Bond Position:  [-9.12608708]


portfolio before change:  [2.26396238]
curr_Stock_Price:  102.1460766560837
curr_Factors:  [102.14607666  -1.60370383  -1.0835342 ]
mat_Sqrt:  [[ 6.95294894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098947  0.00820282 -0.16528629]
Stock Position:  -0.0009894669326206262
Bond Position:  [2.36503254]


portfolio before change:  [2.26425602]
curr_Stock_Price:  102.14810416987044
curr_Factors:  [102.14810417  -1.46354368  -1.08687627]
mat_Sqrt:  [[ 7.97254542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03150319 -0.0065415  -1.17197003]
Stock Position:  -0.03150319003919502
Bond Position:  [5.48224716]


portfolio before change:  [2.26869384]
curr_Stock_Price:  102.02898943079472
curr_Factors:  [102.02898943  -1.70105482  -1.11289541]
mat_Sqrt:  [[ 6.11843747  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.27495128 -1.12327175  8.48305892]
Stock Position:  0.2749512819693906
Bond Position:  [-25.7843076]


portfolio before change:  [2.12840197]
curr_Stock_Price:  101.53046973059493
curr_Factors:  [101.53046973  -1.0952976   -1.09859621]
mat_Sqrt:  [[11.31880088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146887 -0.03026709  0.10477962]
Stock Position:  -0.0014688703030167232
Bond Position:  [2.27753706]


portfolio before change:  [2.12831875]
curr_Stock_Price:  101.78095164838116
curr_Factors:  [101.78095165  -0.96228624  -1.11650145]
mat_Sqrt:  [[12.73094033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00990712 -0.01393338 -0.01806375]
Stock Position:  0.009907117351280196
Bond Position:  [1.11996292]


portfolio before change:  [2.12765105]
curr_Stock_Price:  101.69942413805309
curr_Factors:  [101.69942414  -0.87563916  -1.10163833]
mat_Sqrt:  [[14.07984231  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01078362 -0.04151486 -0.12699457]
Stock Position:  -0.010783617697212847
Bond Position:  [3.22433876]


portfolio before change:  [2.12232563]
curr_Stock_Price:  102.23064596669639
curr_Factors:  [102.23064597  -0.91719892  -1.10677991]
mat_Sqrt:  [[13.50760234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04935369 -0.56526969 -0.57669598]
Stock Position:  -0.049353693106174816
Bond Position:  [7.16778556]


portfolio before change:  [2.14162922]
curr_Stock_Price:  101.8576736497112
curr_Factors:  [101.85767365  -0.82294197  -1.10723692]
mat_Sqrt:  [[14.78181326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00162856 0.011431   0.24965116]
Stock Position:  0.00162855821447102
Bond Position:  [1.97574807]


portfolio before change:  [2.14082315]
curr_Stock_Price:  101.21105591803381
curr_Factors:  [101.21105592  -0.84278143  -1.09312984]
mat_Sqrt:  [[14.60401851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01562525 -0.03675631  0.87570886]
Stock Position:  0.01562524934850298
Bond Position:  [0.55937516]


portfolio before change:  [2.14825692]
curr_Stock_Price:  101.68233426710297
curr_Factors:  [101.68233427  -1.1351833   -1.09863281]
mat_Sqrt:  [[10.89209694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00455937 -0.02380715  0.19048543]
Stock Position:  0.004559369974691976
Bond Position:  [1.68464953]


portfolio before change:  [2.15034989]
curr_Stock_Price:  102.09519454199825
curr_Factors:  [102.09519454  -1.04438674  -1.12697121]
mat_Sqrt:  [[11.64116711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01143216 -0.01754086 -0.04841624]
Stock Position:  0.011432164022415349
Bond Position:  [0.98318088]


portfolio before change:  [2.16156409]
curr_Stock_Price:  103.06537724036585
curr_Factors:  [103.06537724  -1.20937737  -1.1416285 ]
mat_Sqrt:  [[ 9.81937673  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02424629 0.06796862 0.51180337]
Stock Position:  0.02424628680581065
Bond Position:  [-0.33738861]


portfolio before change:  [2.17252987]
curr_Stock_Price:  103.51938342318437
curr_Factors:  [103.51938342  -1.25999801  -1.19442062]
mat_Sqrt:  [[ 8.89367404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00901545 -0.00181895  0.29241963]
Stock Position:  -0.009015445767827337
Bond Position:  [3.10580326]


portfolio before change:  [2.17483414]
curr_Stock_Price:  103.3068575104742
curr_Factors:  [103.30685751  -1.01395039  -1.19365863]
mat_Sqrt:  [[11.35995828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00717857 -0.06451149  0.22106206]
Stock Position:  -0.0071785687409506175
Bond Position:  [2.91642952]


portfolio before change:  [2.17384587]
curr_Stock_Price:  103.49531419282746
curr_Factors:  [103.49531419  -1.1436722   -1.21599617]
mat_Sqrt:  [[ 9.77529192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00768484 -0.0058707  -0.07672654]
Stock Position:  0.0076848355407966315
Bond Position:  [1.3785014]


portfolio before change:  [2.1724139]
curr_Stock_Price:  103.28655426160131
curr_Factors:  [103.28655426  -1.1851206   -1.23253748]
mat_Sqrt:  [[ 9.20594183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0602796  -0.02643537  0.7659868 ]
Stock Position:  0.06027959640420404
Bond Position:  [-4.0536579]


portfolio before change:  [2.15027051]
curr_Stock_Price:  102.92761589674504
curr_Factors:  [102.9276159   -1.00613839  -1.2518066 ]
mat_Sqrt:  [[10.76264126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.73450663e-05 -3.10515772e-02  2.19713415e-02]
Stock Position:  -2.7345066322112326e-05
Bond Position:  [2.15308507]


portfolio before change:  [2.15056343]
curr_Stock_Price:  102.05830512041692
curr_Factors:  [102.05830512  -0.80073065  -1.22750874]
mat_Sqrt:  [[13.42750047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168434 -0.02342007 -0.00295689]
Stock Position:  -0.00168434070013916
Bond Position:  [2.32246439]


portfolio before change:  [2.15287245]
curr_Stock_Price:  100.85979882139739
curr_Factors:  [100.85979882  -0.54284288  -1.21177532]
mat_Sqrt:  [[17.44604935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00075578 0.01776464 0.19576787]
Stock Position:  0.0007557808794573231
Bond Position:  [2.07664454]


portfolio before change:  [2.15352814]
curr_Stock_Price:  101.38389026570827
curr_Factors:  [101.38389027  -0.57114338  -1.2199745 ]
mat_Sqrt:  [[16.90815953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240925 -0.0076634  -0.16706996]
Stock Position:  -0.0024092461287707127
Bond Position:  [2.39778689]


portfolio before change:  [2.15298384]
curr_Stock_Price:  101.73422569130868
curr_Factors:  [101.73422569  -0.55584849  -1.21181999]
mat_Sqrt:  [[17.36914394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121241  0.0066839  -0.15762739]
Stock Position:  -0.001212410713205055
Bond Position:  [2.27632751]


portfolio before change:  [2.15180902]
curr_Stock_Price:  102.93792511882877
curr_Factors:  [102.93792512  -0.59465394  -1.22577589]
mat_Sqrt:  [[16.67142731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00668707 -0.01348823  0.05710729]
Stock Position:  -0.006687069316230944
Bond Position:  [2.84016206]


portfolio before change:  [2.15180231]
curr_Stock_Price:  102.99202221401073
curr_Factors:  [102.99202221  -0.80510407  -1.22938351]
mat_Sqrt:  [[13.46594567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02957436 0.01896817 0.24133299]
Stock Position:  0.029574357964591687
Bond Position:  [-0.89412062]


portfolio before change:  [2.15019306]
curr_Stock_Price:  102.9413878958765
curr_Factors:  [102.9413879   -0.44868642  -1.228554  ]
mat_Sqrt:  [[19.2386131   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00634723 -0.00945639 -0.10041814]
Stock Position:  0.006347233593530383
Bond Position:  [1.49680003]


portfolio before change:  [2.1499652]
curr_Stock_Price:  102.87600845419767
curr_Factors:  [102.87600845  -0.62604488  -1.22569848]
mat_Sqrt:  [[16.14775615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00737617 -0.00857183 -0.30145041]
Stock Position:  -0.007376165947006926
Bond Position:  [2.90879571]


portfolio before change:  [2.15054398]
curr_Stock_Price:  102.84683892978966
curr_Factors:  [102.84683893  -0.76654529  -1.20129293]
mat_Sqrt:  [[14.3737361   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11950724 0.33358793 0.42770027]
Stock Position:  0.11950723589271352
Bond Position:  [-10.14039746]


portfolio before change:  [2.0676473]
curr_Stock_Price:  102.16379201715824
curr_Factors:  [102.16379202  -0.55253473  -1.22797354]
mat_Sqrt:  [[17.21995808  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261188 -0.01818859 -0.10577398]
Stock Position:  -0.00261188419622499
Bond Position:  [2.3344873]


portfolio before change:  [2.06811533]
curr_Stock_Price:  102.09633011866825
curr_Factors:  [102.09633012  -0.8053563   -1.25869654]
mat_Sqrt:  [[12.95995138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00061466 -0.00433785 -0.35299168]
Stock Position:  0.0006146621886318363
Bond Position:  [2.00536058]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.06825378]
Stock Price:  101.91373240865067
PL:  [0.15452137]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-3.22503173e-02 -6.30866964e-02  2.34943864e-01]
 [ 1.45288556e+00  3.25394959e-01  4.68307819e-01]
 [ 1.09571091e-01  2.12252178e-01  3.90776771e-02]
 [ 1.24230167e-01  9.42387705e-01  7.92528370e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 2.61626195e-02 -5.34099247e-02  4.27356763e-02]
 [-3.82413507e-02 -8.01951837e-02 -2.58002777e-02]
 [ 7.48329885e-02  1.30880087e-01 -5.17348132e-02]
 [ 1.43794580e-02  6.49723565e-02 -4.65655219e-02]
 [-2.78737540e-01 -6.54767402e-02 -1.12141362e-01]
 [ 7.95167579e-01  1.53416837e+00 -2.75893664e-01]
 [-5.45162136e-04  7.79358156e-03  2.84550811e-02]
 [-2.88933106e-01  2.29053816e-03 -6.20871533e-01]
 [ 1.85763906e+00 -3.06398018e+00  2.58915649e+00]
 [ 3.85319180e-03 -9.22899844e-02  3.58137108e-02]
 [ 4.46984520e-02  1.50780345e-01 -9.13697579e-02]
 [-2.89062552e-02  6.17775426e-02 -8.50695892e-02]
 [-2.91609955e-01 -1.86219262e+00 -1.93347884e-01]
 [ 2.92277871e-02 -4.74232493e-02  8.42848131e-03]
 [-1.48113047e-01  2.88948248e-01  8.87660243e-02]
 [ 1.70854701e-02  1.01890596e-01 -6.14403039e-02]
 [ 3.89540348e-02 -3.93752877e-02  4.91486522e-03]
 [-3.19350605e-02 -9.84782214e-02 -9.65698911e-02]
 [-1.65624755e-01  2.28950545e-02  4.85425254e-02]
 [ 1.22295588e-01 -1.17786943e-03 -4.38044083e-02]
 [-1.38490357e-02 -5.28517518e-02  2.08553482e-01]
 [-2.08030690e-01 -1.42272026e-01 -7.51413944e-02]
 [-2.17170255e-01  1.58694304e-01  2.96314421e-01]
 [ 1.52319782e-01  1.44297267e-01  2.97782763e-01]
 [-1.57308098e-01  1.13996299e-01 -7.96861994e-02]
 [ 1.49726978e-01  2.01032363e-02  5.44801967e-02]
 [ 1.45689750e-01 -1.99628673e-02 -6.94784277e-02]
 [ 2.02413970e-01  1.59202766e-01  1.92618855e-01]
 [ 2.87231021e-03 -2.15427637e-02  4.18388893e-02]
 [-9.24302406e-02  1.22173904e-01  3.60829900e-02]
 [-7.93126513e-02 -4.52569780e-02 -4.36200467e-02]
 [ 2.48558770e+00  1.63811427e+00  1.83947795e-01]
 [ 3.76555737e-01 -5.77843601e-01  1.18140228e-01]
 [ 2.41322402e-02 -1.47779076e-02  3.01386905e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.48816719]
curr_Stock_Price:  100.14743253019516
curr_Factors:  [100.14743253  -0.73577921  -0.98534066]
mat_Sqrt:  [[17.91294359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.57979627e-04 -2.03611437e-02  6.70229448e-01]
Stock Position:  0.00015797962688888806
Bond Position:  [3.47234593]


portfolio before change:  [3.48880551]
curr_Stock_Price:  101.44034568584806
curr_Factors:  [101.44034569  -0.71450072  -0.97779134]
mat_Sqrt:  [[18.67487126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08647446 0.10502077 1.33595186]
Stock Position:  0.0864744625924368
Bond Position:  [-5.28319387]


portfolio before change:  [3.49873012]
curr_Stock_Price:  101.56275236393412
curr_Factors:  [101.56275236  -0.76386839  -0.99240045]
mat_Sqrt:  [[17.53866759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00917251 0.0685041  0.11147774]
Stock Position:  0.009172508768970074
Bond Position:  [2.56714489]


portfolio before change:  [3.49374608]
curr_Stock_Price:  100.98439895536457
curr_Factors:  [100.98439896  -0.88883779  -0.98761774]
mat_Sqrt:  [[15.46393443  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03093446 0.30415432 2.26086284]
Stock Position:  0.03093445785105187
Bond Position:  [0.36984845]


portfolio before change:  [3.50923934]
curr_Stock_Price:  101.48374573414809
curr_Factors:  [101.48374573  -0.81492989  -0.98172797]
mat_Sqrt:  [[16.83130901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00348434 -0.01106097 -0.05874131]
Stock Position:  -0.0034843398631514222
Bond Position:  [3.8628432]


portfolio before change:  [3.51396444]
curr_Stock_Price:  100.26623542025243
curr_Factors:  [100.26623542  -0.9215569   -0.99018823]
mat_Sqrt:  [[14.82157463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00161816 -0.01723798  0.12191299]
Stock Position:  0.0016181646197951584
Bond Position:  [3.35171717]


portfolio before change:  [3.51669406]
curr_Stock_Price:  101.69416255977758
curr_Factors:  [101.69416256  -1.22999586  -0.98982184]
mat_Sqrt:  [[11.04692602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00542029 -0.02588288 -0.07360101]
Stock Position:  -0.005420293713738275
Bond Position:  [4.06790629]


portfolio before change:  [3.51896701]
curr_Stock_Price:  101.36863920111725
curr_Factors:  [101.3686392   -1.06306777  -0.96763132]
mat_Sqrt:  [[13.30399916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00683918  0.04224137 -0.14758502]
Stock Position:  0.006839180369478755
Bond Position:  [2.8256886]


portfolio before change:  [3.52550534]
curr_Stock_Price:  102.27300200156716
curr_Factors:  [102.273002    -1.03599027  -0.95507411]
mat_Sqrt:  [[13.9653792   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129869  0.02096974 -0.13283847]
Stock Position:  0.0012986928006655026
Bond Position:  [3.39268413]


portfolio before change:  [3.52595494]
curr_Stock_Price:  102.29262652787948
curr_Factors:  [102.29262653  -0.83192212  -0.9660386 ]
mat_Sqrt:  [[16.94337447  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01859097 -0.02113253 -0.31990809]
Stock Position:  -0.018590965088181303
Bond Position:  [5.42767359]


portfolio before change:  [3.54347504]
curr_Stock_Price:  101.38672446281076
curr_Factors:  [101.38672446  -0.81801093  -0.9607957 ]
mat_Sqrt:  [[17.11808539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06145616  0.49515071 -0.78704783]
Stock Position:  0.061456161920782355
Bond Position:  [-2.68736392]


portfolio before change:  [3.43412013]
curr_Stock_Price:  99.61279393383033
curr_Factors:  [99.61279393 -0.77404568 -0.89405605]
mat_Sqrt:  [[18.78744605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00036482 0.00251537 0.08117443]
Stock Position:  0.0003648215476308718
Bond Position:  [3.39777924]


portfolio before change:  [3.43467818]
curr_Stock_Price:  99.97817850922388
curr_Factors:  [99.97817851 -0.74215317 -0.88659736]
mat_Sqrt:  [[19.61317278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.11694675e-02  7.39268013e-04 -1.77117367e+00]
Stock Position:  -0.02116946747256838
Bond Position:  [5.55116298]


portfolio before change:  [3.46459545]
curr_Stock_Price:  98.59773128924687
curr_Factors:  [98.59773129 -0.70651791 -0.84667684]
mat_Sqrt:  [[20.86041818  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08440464 -0.98889535  7.38614279]
Stock Position:  0.08440463963949972
Bond Position:  [-4.85751053]


portfolio before change:  [3.56301596]
curr_Stock_Price:  99.77098115260273
curr_Factors:  [99.77098115 -0.56017014 -0.82605876]
mat_Sqrt:  [[24.94437805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030768 -0.02978646  0.10216655]
Stock Position:  -0.00030768372990562244
Bond Position:  [3.59371387]


portfolio before change:  [3.56394121]
curr_Stock_Price:  98.22390794405453
curr_Factors:  [98.22390794 -0.64097208 -0.80825982]
mat_Sqrt:  [[23.05811447  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00246445  0.04866415 -0.26065249]
Stock Position:  0.0024644507427872176
Bond Position:  [3.32187323]


portfolio before change:  [3.56533847]
curr_Stock_Price:  98.62237405406141
curr_Factors:  [98.62237405 -0.53347452 -0.78766414]
mat_Sqrt:  [[26.31553606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00127912  0.01993862 -0.24267986]
Stock Position:  -0.0012791198417992785
Bond Position:  [3.69148831]


portfolio before change:  [3.5686298]
curr_Stock_Price:  96.41001794818388
curr_Factors:  [96.41001795 -0.54470658 -0.79433112]
mat_Sqrt:  [[25.26885008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02814514 -0.60102008 -0.5515677 ]
Stock Position:  -0.02814514319128523
Bond Position:  [6.28210356]


portfolio before change:  [3.56982266]
curr_Stock_Price:  96.39553796808573
curr_Factors:  [96.39553797 -0.5390846  -0.79254543]
mat_Sqrt:  [[25.45290516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00083558 -0.01530579  0.02404411]
Stock Position:  0.0008355829424827282
Bond Position:  [3.48927619]


portfolio before change:  [3.56984691]
curr_Stock_Price:  95.90254572011455
curr_Factors:  [95.90254572 -0.41126051 -0.79776901]
mat_Sqrt:  [[28.6256456   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248073  0.09325765  0.25322476]
Stock Position:  -0.0024807281086284085
Bond Position:  [3.80775505]


portfolio before change:  [3.57372745]
curr_Stock_Price:  94.53015049463784
curr_Factors:  [94.53015049 -0.53315438 -0.76574079]
mat_Sqrt:  [[25.79095025  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098261  0.03288505 -0.17527209]
Stock Position:  0.0009826063449586877
Bond Position:  [3.48084152]


portfolio before change:  [3.57416592]
curr_Stock_Price:  94.5335483292771
curr_Factors:  [94.53354833 -0.46800254 -0.73841353]
mat_Sqrt:  [[28.29085789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112827 -0.01270832  0.01402074]
Stock Position:  0.0011282736860176842
Bond Position:  [3.4675062]


portfolio before change:  [3.57630327]
curr_Stock_Price:  96.04372049067874
curr_Factors:  [96.04372049 -0.56453501 -0.76270229]
mat_Sqrt:  [[25.47165352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281682 -0.03178371 -0.27548702]
Stock Position:  -0.002816821045683345
Bond Position:  [3.84684124]


portfolio before change:  [3.57795663]
curr_Stock_Price:  95.62747900068756
curr_Factors:  [95.627479   -0.72430368 -0.77504824]
mat_Sqrt:  [[21.35120765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0070742   0.00738935  0.13847831]
Stock Position:  -0.007074195618402288
Bond Position:  [4.25444413]


portfolio before change:  [3.589095]
curr_Stock_Price:  94.12815237061677
curr_Factors:  [94.12815237 -0.69508562 -0.74423456]
mat_Sqrt:  [[22.31673833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00506856 -0.00038016 -0.12496178]
Stock Position:  0.005068555140226289
Bond Position:  [3.11200127]


portfolio before change:  [3.58673031]
curr_Stock_Price:  93.58485769705797
curr_Factors:  [93.5848577  -0.58824988 -0.76748295]
mat_Sqrt:  [[24.12227682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074344 -0.01705783  0.59494503]
Stock Position:  0.0007434392300800704
Bond Position:  [3.51715565]


portfolio before change:  [3.58866428]
curr_Stock_Price:  95.59483586494095
curr_Factors:  [95.59483586 -0.69546684 -0.76600413]
mat_Sqrt:  [[22.167956    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01138626 -0.0459181  -0.21435748]
Stock Position:  -0.011386255826437578
Bond Position:  [4.67713153]


portfolio before change:  [3.61288327]
curr_Stock_Price:  93.51914801531665
curr_Factors:  [93.51914802 -0.55144527 -0.75048463]
mat_Sqrt:  [[25.43780141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00488611  0.05121837  0.84530256]
Stock Position:  -0.004886113627961757
Bond Position:  [4.06982845]


portfolio before change:  [3.61646169]
curr_Stock_Price:  92.89090480031504
curr_Factors:  [92.8909048  -0.22205403 -0.76330063]
mat_Sqrt:  [[34.67680719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00699485 0.04657174 0.84949134]
Stock Position:  0.006994847844083616
Bond Position:  [2.96670395]


portfolio before change:  [3.62358804]
curr_Stock_Price:  93.85668507383853
curr_Factors:  [93.85668507 -0.33813668 -0.78186182]
mat_Sqrt:  [[30.62358587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00490813  0.03679215 -0.22732255]
Stock Position:  -0.004908131238100805
Bond Position:  [4.08424897]


portfolio before change:  [3.63468937]
curr_Stock_Price:  91.69888458885264
curr_Factors:  [91.69888459 -0.24865414 -0.77553164]
mat_Sqrt:  [[32.92803542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00500945 0.00648829 0.15541684]
Stock Position:  0.005009447266366772
Bond Position:  [3.17532865]


portfolio before change:  [3.62427102]
curr_Stock_Price:  89.53990438018604
curr_Factors:  [89.53990438 -0.21700317 -0.72678449]
mat_Sqrt:  [[34.84454943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00365718 -0.00644299 -0.19820262]
Stock Position:  0.0036571751974529784
Bond Position:  [3.2968079]


portfolio before change:  [3.62536607]
curr_Stock_Price:  89.72663993413173
curr_Factors:  [89.72663993 -0.36193643 -0.71955453]
mat_Sqrt:  [[30.42536841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00901318 0.05138247 0.54948798]
Stock Position:  0.009013177871704685
Bond Position:  [2.8166439]


portfolio before change:  [3.64208954]
curr_Stock_Price:  91.54302111900391
curr_Factors:  [91.54302112 -0.41272717 -0.7071347 ]
mat_Sqrt:  [[29.87276401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00023484 -0.0069529   0.11935471]
Stock Position:  0.0002348373088331167
Bond Position:  [3.62059182]


portfolio before change:  [3.64222168]
curr_Stock_Price:  90.17843270706486
curr_Factors:  [90.17843271 -0.58287014 -0.72574266]
mat_Sqrt:  [[24.36572644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00246765  0.03943146  0.10293473]
Stock Position:  -0.0024676542035342542
Bond Position:  [3.86475087]


portfolio before change:  [3.64345435]
curr_Stock_Price:  89.87468513708932
curr_Factors:  [89.87468514 -0.32247271 -0.72231401]
mat_Sqrt:  [[31.61493368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308255 -0.01460663 -0.12443585]
Stock Position:  -0.003082549498984343
Bond Position:  [3.92049752]


portfolio before change:  [3.64709213]
curr_Stock_Price:  88.85355588205158
curr_Factors:  [88.85355588 -0.46627243 -0.73957951]
mat_Sqrt:  [[26.60602337  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10740104 0.52869911 0.52475186]
Stock Position:  0.10740103927956346
Bond Position:  [-5.89587212]


portfolio before change:  [3.34460571]
curr_Stock_Price:  86.04399844718337
curr_Factors:  [86.04399845 -0.53859562 -0.72223754]
mat_Sqrt:  [[24.38640046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01159331 -0.18649822  0.33702119]
Stock Position:  0.011593313228996534
Bond Position:  [2.34707068]


portfolio before change:  [3.3545867]
curr_Stock_Price:  86.87961728632133
curr_Factors:  [86.87961729 -0.85238383 -0.73658729]
mat_Sqrt:  [[17.7352171   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00153749 -0.00476955  0.08597729]
Stock Position:  0.0015374915735896274
Bond Position:  [3.22101002]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.35475558]
Stock Price:  86.72756882951234
PL:  [3.35475558]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 9.77595942e-02 -1.67140262e-02 -1.33764759e-01]
 [ 1.22154648e+00  2.39711512e-01  3.56072005e-01]
 [-2.61182650e-01 -1.53942841e-01  3.74149484e-02]
 [ 1.98486130e-01  1.37741116e+00  1.24874206e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 1.77106470e-02  5.94587533e-02 -7.61146548e-03]
 [-4.98621744e-02 -6.92257032e-03 -7.36119756e-02]
 [-6.34330807e-02  1.25943358e-01  6.51462416e-04]
 [ 1.22358036e-02  6.72921371e-02 -4.69179559e-02]
 [-1.79358705e-01 -9.87803389e-02 -7.03486451e-02]
 [ 6.76874992e-01  1.30954018e+00 -2.34767925e-01]
 [-2.70603718e-04  1.19908044e-02 -5.72772833e-02]
 [-8.84519139e-02 -1.36230463e-02 -2.37877235e-01]
 [ 1.56180147e+00 -2.98549819e+00  2.50135119e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.51197548e-01 -9.28619895e-02  2.51751261e-02]
 [-1.62406689e-01 -2.28119563e-01 -2.78743147e-02]
 [-2.58826704e-01 -1.69852542e+00 -2.01665682e-01]
 [ 1.30094623e-03  3.72499194e-02  5.83893053e-02]
 [ 2.20603226e-01 -3.38697282e-01  1.70929077e-01]
 [ 6.05597590e-02  1.31157103e-01 -5.80138934e-02]
 [-1.25024710e-01 -5.13997482e-02 -1.36923052e-01]
 [ 5.67800275e-01  4.24000471e-01  4.37271396e-01]
 [-1.24158740e-01  5.81941996e-02  1.03741412e-01]
 [-6.68902478e-02 -2.76368834e-01  9.38059735e-02]
 [ 8.02170168e-02 -1.60192028e-02  1.94210501e-02]
 [ 3.14661489e-01 -6.26941151e-02  1.64066791e-01]
 [-7.31154044e-02  4.93002973e-02  1.21135336e-01]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 1.39456693e-01 -1.99307671e-02  3.79805499e-02]
 [-1.74848216e-02 -5.67160880e-02 -3.88512231e-02]
 [ 5.54443566e-02  7.09781772e-03 -4.95973392e-02]
 [-1.18069121e-01 -3.87448071e-02  2.12500833e-02]
 [ 6.33934408e-01  1.24965376e-01  2.07171758e-01]
 [ 1.74415566e-01  3.97229730e-01 -2.19086146e-01]
 [-1.68216043e-01  8.18217642e-02 -5.41128815e-02]
 [ 2.89185274e+00  2.16097813e+00  2.52146596e-01]
 [-4.87909317e-02 -1.28745026e-01 -3.65411760e-03]
 [ 4.24965710e-02 -1.05247918e-02 -2.93663040e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.13710417]
curr_Stock_Price:  100.2359875090713
curr_Factors:  [100.23598751  -1.23940354  -0.98959874]
mat_Sqrt:  [[10.78897745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00621405 -0.00539443 -0.38159362]
Stock Position:  0.006214049592970337
Bond Position:  [3.51423277]


portfolio before change:  [4.13826699]
curr_Stock_Price:  100.35241889509881
curr_Factors:  [100.3524189   -1.18573376  -0.99422435]
mat_Sqrt:  [[11.34446631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11839784 0.07736656 1.01577432]
Stock Position:  0.11839783790595003
Bond Position:  [-7.74324244]


portfolio before change:  [4.08066348]
curr_Stock_Price:  99.87406945156738
curr_Factors:  [99.87406945 -1.09528019 -0.97186956]
mat_Sqrt:  [[12.6386596   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02254739 -0.04968484  0.10673443]
Stock Position:  -0.022547391517038273
Bond Position:  [6.33256323]


portfolio before change:  [4.09045327]
curr_Stock_Price:  99.47499155393128
curr_Factors:  [99.47499155 -0.92509658 -0.9586127 ]
mat_Sqrt:  [[15.12270097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0485725  0.44455754 3.5623135 ]
Stock Position:  0.04857250117349201
Bond Position:  [-0.74129588]


portfolio before change:  [4.10999852]
curr_Stock_Price:  99.8792927234633
curr_Factors:  [99.87929272 -0.86451184 -0.94752601]
mat_Sqrt:  [[16.31238345  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359518 -0.01106097 -0.05874131]
Stock Position:  -0.003595182832974311
Bond Position:  [4.46908284]


portfolio before change:  [4.1099074]
curr_Stock_Price:  100.06003239903838
curr_Factors:  [100.0600324   -0.68546508  -0.93298972]
mat_Sqrt:  [[19.83237163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00142665  0.01919023 -0.02171339]
Stock Position:  0.001426653901317948
Bond Position:  [3.96715636]


portfolio before change:  [4.11095909]
curr_Stock_Price:  100.44959242914366
curr_Factors:  [100.44959243  -0.92987739  -0.92897185]
mat_Sqrt:  [[15.65525731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423508 -0.00223425 -0.20999448]
Stock Position:  -0.004235076971869101
Bond Position:  [4.53637085]


portfolio before change:  [4.1167349]
curr_Stock_Price:  99.21969032441471
curr_Factors:  [99.21969032 -1.07520381 -0.92121287]
mat_Sqrt:  [[13.47612768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00278953  0.04064804  0.00185844]
Stock Position:  -0.0027895269431203002
Bond Position:  [4.3935109]


portfolio before change:  [4.11429222]
curr_Stock_Price:  100.29224109452274
curr_Factors:  [100.29224109  -1.08650655  -0.91034307]
mat_Sqrt:  [[13.61590661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120408  0.02171844 -0.13384387]
Stock Position:  0.0012040818390170423
Bond Position:  [3.99353215]


portfolio before change:  [4.11504479]
curr_Stock_Price:  100.50265347587238
curr_Factors:  [100.50265348  -1.07532583  -0.89757386]
mat_Sqrt:  [[13.97520161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0153044  -0.03188122 -0.2006851 ]
Stock Position:  -0.01530439559509592
Bond Position:  [5.65317716]


portfolio before change:  [4.09209338]
curr_Stock_Price:  102.0484909543679
curr_Factors:  [102.04849095  -0.94978579  -0.86750828]
mat_Sqrt:  [[16.57928509  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05405914  0.42265227 -0.66972754]
Stock Position:  0.054059143953749424
Bond Position:  [-1.42456069]


portfolio before change:  [4.14429987]
curr_Stock_Price:  103.01751432712398
curr_Factors:  [103.01751433  -1.19663914  -0.89016625]
mat_Sqrt:  [[12.78271194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00074434  0.00387002 -0.16339615]
Stock Position:  -0.0007443387264573665
Bond Position:  [4.22097979]


portfolio before change:  [4.14472815]
curr_Stock_Price:  103.15101771114666
curr_Factors:  [103.15101771  -0.99537658  -0.88889362]
mat_Sqrt:  [[15.67275588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00891925 -0.00439682 -0.67859754]
Stock Position:  -0.008919247835487252
Bond Position:  [5.06475764]


portfolio before change:  [4.13642308]
curr_Stock_Price:  104.15314378714118
curr_Factors:  [104.15314379  -0.97425591  -0.87785263]
mat_Sqrt:  [[16.3422506   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08952105 -0.9635654   7.13565869]
Stock Position:  0.08952104627388575
Bond Position:  [-5.18747533]


portfolio before change:  [4.14196685]
curr_Stock_Price:  104.22231468997637
curr_Factors:  [104.22231469  -0.56850143  -0.90890094]
mat_Sqrt:  [[23.78663539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091099 -0.03053791  0.10625201]
Stock Position:  -0.0009109894073685065
Bond Position:  [4.23691228]


portfolio before change:  [4.14253659]
curr_Stock_Price:  104.17830340486839
curr_Factors:  [104.1783034   -0.30765838  -0.910051  ]
mat_Sqrt:  [[30.8271102   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0044565  -0.02997108  0.07181763]
Stock Position:  0.004456500283333337
Bond Position:  [3.67826595]


portfolio before change:  [4.13749492]
curr_Stock_Price:  102.94381843430057
curr_Factors:  [102.94381843  -0.3919044   -0.90780206]
mat_Sqrt:  [[28.0637      0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00764907 -0.07362527 -0.07951766]
Stock Position:  -0.007649070512245778
Bond Position:  [4.92491945]


portfolio before change:  [4.13370645]
curr_Stock_Price:  103.51959072545135
curr_Factors:  [103.51959073  -0.74378834  -0.89630742]
mat_Sqrt:  [[20.07881182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03220816 -0.54819672 -0.57529606]
Stock Position:  -0.032208160237597885
Bond Position:  [7.46788202]


portfolio before change:  [4.16362411]
curr_Stock_Price:  102.6196909364195
curr_Factors:  [102.61969094  -0.59326835  -0.87543421]
mat_Sqrt:  [[23.62551513  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00088139 0.01202236 0.16656844]
Stock Position:  0.0008813869710969845
Bond Position:  [4.07317645]


portfolio before change:  [4.16426644]
curr_Stock_Price:  102.77075237206324
curr_Factors:  [102.77075237  -0.3125677   -0.88366091]
mat_Sqrt:  [[31.07091576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00599782 -0.10931408  0.48761308]
Stock Position:  0.005997817559805757
Bond Position:  [3.54786621]


portfolio before change:  [4.17126512]
curr_Stock_Price:  103.86367908757299
curr_Factors:  [103.86367909  -0.36450558  -0.86061886]
mat_Sqrt:  [[30.50695912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00247452  0.04233077 -0.16549749]
Stock Position:  0.002474519135731585
Bond Position:  [3.91425246]


portfolio before change:  [4.1743758]
curr_Stock_Price:  104.92302096587288
curr_Factors:  [104.92302097  -0.31472417  -0.86227144]
mat_Sqrt:  [[32.3376225   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00505498 -0.0165892  -0.39060335]
Stock Position:  -0.005054977079043463
Bond Position:  [4.70475926]


portfolio before change:  [4.16319234]
curr_Stock_Price:  107.25173262701162
curr_Factors:  [107.25173263  -0.11562949  -0.87694296]
mat_Sqrt:  [[39.74985753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01870715 0.13684556 1.24741358]
Stock Position:  0.01870715280152477
Bond Position:  [2.15681779]


portfolio before change:  [4.12603359]
curr_Stock_Price:  105.2509807299126
curr_Factors:  [105.25098073  -0.21226789  -0.85918119]
mat_Sqrt:  [[36.04970617  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252717  0.0187821   0.29594537]
Stock Position:  -0.00252717099757415
Bond Position:  [4.39202082]


portfolio before change:  [4.13244288]
curr_Stock_Price:  102.9320826331498
curr_Factors:  [102.93208263  -0.17715442  -0.8525227 ]
mat_Sqrt:  [[36.75933708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283345 -0.08919766  0.26760233]
Stock Position:  -0.002833449781468401
Bond Position:  [4.42409577]


portfolio before change:  [4.13445304]
curr_Stock_Price:  102.41782685233309
curr_Factors:  [102.41782685  -0.43724505  -0.87402386]
mat_Sqrt:  [[27.59934039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00293164 -0.00517018  0.05540285]
Stock Position:  0.0029316431052882727
Bond Position:  [3.83420053]


portfolio before change:  [4.13486438]
curr_Stock_Price:  102.39464128031359
curr_Factors:  [102.39464128  -0.79825729  -0.88319246]
mat_Sqrt:  [[19.05604982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0175983  -0.02023444  0.46803689]
Stock Position:  0.017598300978012394
Bond Position:  [2.33289266]


portfolio before change:  [4.12385291]
curr_Stock_Price:  101.75235794879713
curr_Factors:  [101.75235795  -0.73376218  -0.85780525]
mat_Sqrt:  [[20.71741339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184991  0.0159116   0.3455654 ]
Stock Position:  -0.001849911262547224
Bond Position:  [4.31208574]


portfolio before change:  [4.12461095]
curr_Stock_Price:  101.6339768541562
curr_Factors:  [101.63397685  -0.65989403  -0.87428846]
mat_Sqrt:  [[21.91552748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00100837 -0.02321455 -0.0028026 ]
Stock Position:  -0.0010083732842175593
Bond Position:  [4.22709594]


portfolio before change:  [4.12273122]
curr_Stock_Price:  104.0221282838448
curr_Factors:  [104.02212828  -0.58113665  -0.88499562]
mat_Sqrt:  [[24.01002331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00596172 -0.00643263  0.10834794]
Stock Position:  0.005961722238387028
Bond Position:  [3.50258019]


portfolio before change:  [4.11740092]
curr_Stock_Price:  103.05459781172722
curr_Factors:  [103.05459781  -0.41348024  -0.91554423]
mat_Sqrt:  [[27.28219948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135592 -0.01830504 -0.11083173]
Stock Position:  -0.0013559177038209968
Bond Position:  [4.25713448]


portfolio before change:  [4.11547564]
curr_Stock_Price:  104.8669909457755
curr_Factors:  [104.86699095  -0.61701406  -0.89701786]
mat_Sqrt:  [[23.07294853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202701  0.00229081 -0.1414874 ]
Stock Position:  0.0020270134979857076
Bond Position:  [3.90290884]


portfolio before change:  [4.1147043]
curr_Stock_Price:  104.24576112799589
curr_Factors:  [104.24576113  -0.33854542  -0.89544639]
mat_Sqrt:  [[30.348873    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00400806 -0.01250483  0.06062057]
Stock Position:  -0.004008063702165063
Bond Position:  [4.53252795]


portfolio before change:  [4.09496546]
curr_Stock_Price:  109.31190762557311
curr_Factors:  [109.31190763  -0.47133929  -0.93049854]
mat_Sqrt:  [[26.90648954  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02608039 0.0403324  0.59100336]
Stock Position:  0.02608038539142789
Bond Position:  [1.24406878]


portfolio before change:  [4.08841058]
curr_Stock_Price:  109.0546110588686
curr_Factors:  [109.05461106  -0.50017727  -0.92312926]
mat_Sqrt:  [[26.27301186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00802264  0.12820534 -0.62499179]
Stock Position:  0.008022642169821738
Bond Position:  [3.21350446]


portfolio before change:  [4.10584145]
curr_Stock_Price:  111.17724741520017
curr_Factors:  [111.17724742  -0.6847772   -0.93157369]
mat_Sqrt:  [[22.08226634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00736156  0.02640786 -0.15436899]
Stock Position:  -0.00736156280697099
Bond Position:  [4.92427974]


portfolio before change:  [4.10532804]
curr_Stock_Price:  111.33060935199126
curr_Factors:  [111.33060935  -0.49958536  -0.93646765]
mat_Sqrt:  [[26.48162833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.12780293 0.69745269 0.71930406]
Stock Position:  0.12780293250475255
Bond Position:  [-10.12305031]


portfolio before change:  [4.39624625]
curr_Stock_Price:  113.61681411624026
curr_Factors:  [113.61681412  -0.8352171   -0.95120428]
mat_Sqrt:  [[19.0374888   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0039825  -0.04155228 -0.01042418]
Stock Position:  -0.003982499713308547
Bond Position:  [4.84872518]


portfolio before change:  [4.39968232]
curr_Stock_Price:  112.9062217137427
curr_Factors:  [112.90622171  -1.0096985   -0.92396316]
mat_Sqrt:  [[16.32823665  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012001  -0.00339686 -0.83773891]
Stock Position:  -0.0012000995905229158
Bond Position:  [4.53518103]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.40040018]
Stock Price:  112.78045397723018
PL:  [-8.3800538]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 4.79958864e-02 -4.08996623e-02 -6.39824342e-02]
 [ 8.58362481e-01  2.02552533e-01  2.41731274e-01]
 [-2.43091930e-01 -1.37290707e-01  3.68872679e-02]
 [ 1.68853276e-01  1.38470467e+00  1.09793829e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 1.40529566e-02  5.17404897e-02  5.72919030e-03]
 [-7.74535445e-02  7.02821260e-02 -2.04679286e-02]
 [ 2.29290781e-02  2.00463091e-01 -3.69473126e-02]
 [-7.95574568e-04  8.13941943e-02 -4.90604190e-02]
 [-1.22154206e-01 -6.32588285e-02 -3.08086844e-02]
 [ 7.88630618e-01  1.54704456e+00 -2.67249566e-01]
 [-2.46586626e-04  2.04862291e-02 -1.88771857e-02]
 [-3.32440580e-01 -2.55594186e-03 -7.08026388e-01]
 [ 1.78996033e+00 -3.22425251e+00  2.71393847e+00]
 [-2.07862025e-04 -9.29745785e-02  3.62348060e-02]
 [ 1.32131782e-01 -3.73483100e-02 -9.77495566e-03]
 [-1.45163823e-01 -1.90077404e-01 -3.32706893e-02]
 [-2.73391966e-01 -1.77683988e+00 -1.99992624e-01]
 [ 1.07296083e-04  3.40859062e-02  7.80008997e-02]
 [ 2.03216522e-01 -1.67346769e-01  2.94530309e-01]
 [ 5.86924497e-02 -8.26903372e-03  1.34283140e-02]
 [ 1.29409613e-01 -5.56554898e-02 -3.91528719e-02]
 [ 1.78906375e-01  2.20965477e-01  1.93345399e-01]
 [-5.82750858e-02 -1.87780478e-02  9.87098569e-02]
 [-7.21742646e-02 -2.02366829e-01  8.29924546e-02]
 [ 8.76644033e-02 -2.10035967e-02 -7.56175997e-02]
 [ 5.25789652e-01 -6.82675249e-02  2.85714408e-01]
 [ 3.57086877e-02 -1.22436149e-01 -1.45133790e-02]
 [-1.19949714e-02 -7.73526645e-02 -7.31971416e-03]
 [ 1.55619704e-01 -5.33449751e-02  6.27676105e-02]
 [-2.64047564e-02 -7.20938483e-02 -2.78413469e-02]
 [ 2.86648674e-02  2.31566259e-02 -6.76388832e-02]
 [-6.14184068e-02 -5.43932430e-02  1.49250750e-02]
 [ 2.97117136e-01  4.15943479e-02  6.83565845e-02]
 [ 5.10263596e-02 -6.06917844e-02  1.92602754e-02]
 [-1.01930391e-01 -4.59724972e-02 -8.90169705e-02]
 [ 1.59936304e+00  1.05326973e+00  1.43533014e-01]
 [-1.44662651e-02 -1.22931601e-01 -4.70495304e-02]
 [ 3.41645138e-02 -1.40133166e-02 -9.09377271e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.54367404]
curr_Stock_Price:  99.88208388498064
curr_Factors:  [99.88208388 -1.20430464 -1.00264749]
mat_Sqrt:  [[10.99057623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00241906 -0.01320031 -0.18252408]
Stock Position:  0.0024190649855402972
Bond Position:  [1.30205279]


portfolio before change:  [1.54238412]
curr_Stock_Price:  99.28156748511806
curr_Factors:  [99.28156749 -1.33109963 -1.01732623]
mat_Sqrt:  [[ 9.48331623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10007591 0.06537355 0.68959204]
Stock Position:  0.1000759133990432
Bond Position:  [-8.39330943]


portfolio before change:  [1.59694679]
curr_Stock_Price:  99.83726468885374
curr_Factors:  [99.83726469 -1.52233244 -1.03270944]
mat_Sqrt:  [[ 7.75625509  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03398376 -0.04431039  0.10522911]
Stock Position:  -0.03398375803921646
Bond Position:  [4.98979224]


portfolio before change:  [1.59351304]
curr_Stock_Price:  99.95666034060692
curr_Factors:  [99.95666034 -1.31388518 -1.02445684]
mat_Sqrt:  [[ 9.64456628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07005195 0.44691151 3.13211232]
Stock Position:  0.07005194712715301
Bond Position:  [-5.40864564]


portfolio before change:  [1.52528754]
curr_Stock_Price:  98.99238483806103
curr_Factors:  [98.99238484 -1.3314232  -1.00102744]
mat_Sqrt:  [[ 9.60796349  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0061039  -0.01106097 -0.05874131]
Stock Position:  -0.006103895064218517
Bond Position:  [2.12952667]


portfolio before change:  [1.52352864]
curr_Stock_Price:  99.3241583689881
curr_Factors:  [99.32415837 -1.20689261 -0.97693812]
mat_Sqrt:  [[11.18482669  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00230526 0.01669917 0.01634379]
Stock Position:  0.0023052575212882875
Bond Position:  [1.29456088]


portfolio before change:  [1.52442616]
curr_Stock_Price:  99.64329315215811
curr_Factors:  [99.64329315 -1.15324071 -1.00224313]
mat_Sqrt:  [[11.5433891   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0058289   0.02268346 -0.0583893 ]
Stock Position:  -0.00582890028995996
Bond Position:  [2.10523698]


portfolio before change:  [1.5196361]
curr_Stock_Price:  100.51021929504036
curr_Factors:  [100.5102193   -1.2822256   -1.00210736]
mat_Sqrt:  [[10.23615897  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00550075  0.06469918 -0.1054004 ]
Stock Position:  0.005500754406932711
Bond Position:  [0.96675407]


portfolio before change:  [1.51591468]
curr_Stock_Price:  99.81171950457818
curr_Factors:  [99.8117195  -1.56057587 -1.00326399]
mat_Sqrt:  [[ 7.68634778  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00075517  0.02626986 -0.13995572]
Stock Position:  0.0007551739583319593
Bond Position:  [1.44053947]


portfolio before change:  [1.51566514]
curr_Stock_Price:  99.24282610050051
curr_Factors:  [99.2428261  -1.38331151 -1.00844793]
mat_Sqrt:  [[ 9.07760322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01557191 -0.0204167  -0.0878886 ]
Stock Position:  -0.015571914032739278
Bond Position:  [3.0610659]


portfolio before change:  [1.5151243]
curr_Stock_Price:  99.30213142539075
curr_Factors:  [99.30213143 -1.21962515 -1.02947174]
mat_Sqrt:  [[10.4758242   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10021815  0.49930648 -0.76238862]
Stock Position:  0.10021814576324062
Bond Position:  [-8.43675118]


portfolio before change:  [1.49008587]
curr_Stock_Price:  99.06281574565386
curr_Factors:  [99.06281575 -1.2611764  -1.02401548]
mat_Sqrt:  [[10.08009089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.12075835e-06  6.61190202e-03 -5.38513565e-02]
Stock Position:  8.120758353971354e-06
Bond Position:  [1.48928141]


portfolio before change:  [1.49027654]
curr_Stock_Price:  99.61710778037325
curr_Factors:  [99.61710778 -1.10838067 -1.03831995]
mat_Sqrt:  [[11.64216349  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.10136476e-02 -8.24926687e-04 -2.01980221e+00]
Stock Position:  -0.04101364763723282
Bond Position:  [5.5759375]


portfolio before change:  [1.47097175]
curr_Stock_Price:  100.10479505116268
curr_Factors:  [100.10479505  -0.96162409  -1.03661561]
mat_Sqrt:  [[13.5715798   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12421494 -1.04062302  7.74211104]
Stock Position:  0.12421493592407082
Bond Position:  [-10.96353896]


portfolio before change:  [1.48977119]
curr_Stock_Price:  100.26717469320623
curr_Factors:  [100.26717469  -0.68257348  -1.04827672]
mat_Sqrt:  [[17.76070043  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066382 -0.03000742  0.10336782]
Stock Position:  -0.0006638150137261792
Bond Position:  [1.55633005]


portfolio before change:  [1.48920957]
curr_Stock_Price:  101.4063123508078
curr_Factors:  [101.40631235  -0.8169306   -1.00760755]
mat_Sqrt:  [[16.35603913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00749037 -0.01205412 -0.02788523]
Stock Position:  0.007490370053131702
Bond Position:  [0.72963877]


portfolio before change:  [1.49776734]
curr_Stock_Price:  102.53663816517675
curr_Factors:  [102.53663817  -0.86176409  -1.03110295]
mat_Sqrt:  [[15.44604748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01234973 -0.06134722 -0.09491202]
Stock Position:  -0.012349732959085036
Bond Position:  [2.76406744]


portfolio before change:  [1.51888316]
curr_Stock_Price:  100.8547972441812
curr_Factors:  [100.85479724  -0.8991943   -1.04844284]
mat_Sqrt:  [[14.38296741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04706339 -0.57347261 -0.57052329]
Stock Position:  -0.047063390492287284
Bond Position:  [6.26545186]


portfolio before change:  [1.50572666]
curr_Stock_Price:  101.15098760729775
curr_Factors:  [101.15098761  -0.81305029  -1.05834792]
mat_Sqrt:  [[15.56797808  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00147655 0.01100118 0.22251486]
Stock Position:  0.0014765513806568873
Bond Position:  [1.35637203]


portfolio before change:  [1.50652822]
curr_Stock_Price:  101.57900990897679
curr_Factors:  [101.57900991  -0.84861321  -1.06244677]
mat_Sqrt:  [[15.02592348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01525216 -0.05401094  0.84021299]
Stock Position:  0.015252157608640016
Bond Position:  [-0.04277085]


portfolio before change:  [1.52453836]
curr_Stock_Price:  102.76018647434495
curr_Factors:  [102.76018647  -1.08610044  -1.03091922]
mat_Sqrt:  [[12.37128832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00482937 -0.00266882  0.03830724]
Stock Position:  0.004829374427294594
Bond Position:  [1.02827095]


portfolio before change:  [1.52641533]
curr_Stock_Price:  103.12222649102456
curr_Factors:  [103.12222649  -1.0579445   -1.06483936]
mat_Sqrt:  [[12.3435183   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00891617 -0.01796273 -0.11169225]
Stock Position:  0.008916172441729299
Bond Position:  [0.60695978]


portfolio before change:  [1.5275656]
curr_Stock_Price:  103.24272540351994
curr_Factors:  [103.2427254   -1.04854712  -1.08339219]
mat_Sqrt:  [[12.24531553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02151657 0.0713163  0.55156061]
Stock Position:  0.0215165732506875
Bond Position:  [-0.69386407]


portfolio before change:  [1.54283057]
curr_Stock_Price:  103.95620855783005
curr_Factors:  [103.95620856  -1.32901238  -1.10616912]
mat_Sqrt:  [[ 9.10467708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460852 -0.00606059  0.28159175]
Stock Position:  -0.004608518594198229
Bond Position:  [2.02191469]


portfolio before change:  [1.54158483]
curr_Stock_Price:  104.28136577280848
curr_Factors:  [104.28136577  -1.4292855   -1.09379058]
mat_Sqrt:  [[ 8.36466768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01154158 -0.06531361  0.23675437]
Stock Position:  -0.011541577080063039
Bond Position:  [2.74515625]


portfolio before change:  [1.54485909]
curr_Stock_Price:  104.02740669136956
curr_Factors:  [104.02740669  -1.39344689  -1.08861558]
mat_Sqrt:  [[ 8.69364173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0078151  -0.00677888 -0.21571596]
Stock Position:  0.007815100535298151
Bond Position:  [0.73187444]


portfolio before change:  [1.54256312]
curr_Stock_Price:  103.72191392837208
curr_Factors:  [103.72191393  -1.18113753  -1.10706259]
mat_Sqrt:  [[10.52247338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05418648 -0.02203325  0.81506368]
Stock Position:  0.05418648166625909
Bond Position:  [-4.07776247]


portfolio before change:  [1.52873054]
curr_Stock_Price:  103.47604392072653
curr_Factors:  [103.47604392  -1.08274504  -1.08136035]
mat_Sqrt:  [[11.8844965   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065245 -0.0395161  -0.04140263]
Stock Position:  0.0006524451659492384
Bond Position:  [1.46121809]


portfolio before change:  [1.52884021]
curr_Stock_Price:  103.3641686969374
curr_Factors:  [103.3641687   -1.10598893  -1.08679175]
mat_Sqrt:  [[11.53605894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253801 -0.02496547 -0.02088111]
Stock Position:  -0.0025380113359432036
Bond Position:  [1.79117964]


portfolio before change:  [1.52970963]
curr_Stock_Price:  103.10983258553452
curr_Factors:  [103.10983259  -1.05248142  -1.09824752]
mat_Sqrt:  [[12.00191015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0131265  -0.01721702  0.17905852]
Stock Position:  0.013126501484916259
Bond Position:  [0.17623826]


portfolio before change:  [1.55361694]
curr_Stock_Price:  104.92945530608277
curr_Factors:  [104.92945531  -1.16609629  -1.08332403]
mat_Sqrt:  [[11.06589603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00422957 -0.02326819 -0.07942361]
Stock Position:  -0.004229566462316409
Bond Position:  [1.99742304]


portfolio before change:  [1.56081254]
curr_Stock_Price:  103.2872287710784
curr_Factors:  [103.28722877  -0.89280755  -1.09637655]
mat_Sqrt:  [[14.13041595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138601  0.00747377 -0.19295491]
Stock Position:  0.0013860147318340385
Bond Position:  [1.41765492]


portfolio before change:  [1.56029208]
curr_Stock_Price:  102.78385677883966
curr_Factors:  [102.78385678  -0.96245346  -1.11266393]
mat_Sqrt:  [[12.90365905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00538412 -0.01755534  0.04257708]
Stock Position:  -0.0053841172176677604
Bond Position:  [2.11369241]


portfolio before change:  [1.56386013]
curr_Stock_Price:  102.17023297547154
curr_Factors:  [102.17023298  -0.9445909   -1.10621156]
mat_Sqrt:  [[13.14232472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02431539 0.01342452 0.19500231]
Stock Position:  0.02431539189418669
Bond Position:  [-0.92044913]


portfolio before change:  [1.56131973]
curr_Stock_Price:  102.0704880762538
curr_Factors:  [102.07048808  -0.97065078  -1.11269663]
mat_Sqrt:  [[12.70907393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00334951 -0.01958819  0.0549442 ]
Stock Position:  0.0033495114152917306
Bond Position:  [1.21943346]


portfolio before change:  [1.56006182]
curr_Stock_Price:  101.6494291382407
curr_Factors:  [101.64942914  -1.13948915  -1.12831683]
mat_Sqrt:  [[10.52469018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01230298 -0.01483756 -0.25394064]
Stock Position:  -0.012302975030409096
Bond Position:  [2.81065221]


portfolio before change:  [1.57662905]
curr_Stock_Price:  100.33138396574265
curr_Factors:  [100.33138397  -1.1029013   -1.13024297]
mat_Sqrt:  [[10.75460756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.17142972 0.33994134 0.40945974]
Stock Position:  0.1714297218254633
Bond Position:  [-15.62315219]


portfolio before change:  [1.49001453]
curr_Stock_Price:  99.83752846140979
curr_Factors:  [99.83752846 -1.06137741 -1.14238465]
mat_Sqrt:  [[11.02077456  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00446099 -0.039676   -0.13421921]
Stock Position:  -0.004460985752750032
Bond Position:  [1.93538832]


portfolio before change:  [1.490912]
curr_Stock_Price:  99.69057970326796
curr_Factors:  [99.6905797  -0.71092436 -1.14658794]
mat_Sqrt:  [[15.55774961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00081898 -0.00452278 -0.25942002]
Stock Position:  0.0008189790970703744
Bond Position:  [1.4092675]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.4899549]
Stock Price:  98.30682014269834
PL:  [1.4899549]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-5.68343443e-02  1.54343749e-03  4.06291326e-01]
 [ 7.43770328e-01  2.11368937e-01  2.03367491e-01]
 [-3.89047695e-01 -2.71639976e-01  4.11445895e-02]
 [ 2.53345387e-01  1.31980012e+00  1.51390202e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 2.51276258e-02 -3.43027206e-02  3.53051965e-02]
 [-3.88069555e-02 -7.65753217e-02 -2.82196038e-02]
 [ 2.95940679e-02  1.93359079e-01 -4.11167398e-02]
 [ 1.84411990e-02  6.05768963e-02 -4.58977391e-02]
 [-3.04225248e-01 -3.50708446e-02 -1.16670110e-01]
 [ 6.06427539e-01  1.19182185e+00 -2.06230958e-01]
 [-9.70072060e-05  2.11359418e-02 -5.81534012e-02]
 [ 5.85893059e-02 -2.41452747e-02 -1.12489742e-02]
 [ 1.53778173e+00 -2.93929474e+00  2.45980752e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.42074119e-01 -9.07396071e-02  2.55824508e-02]
 [-1.86248653e-01 -2.77448502e-01 -1.63210518e-02]
 [-2.56652807e-01 -1.68612331e+00 -2.01657647e-01]
 [-2.12359154e-02  9.35778926e-02  2.71537934e-01]
 [ 3.03869549e-01 -2.48985905e-01  4.12636370e-01]
 [ 7.08719905e-02 -1.60435419e-01 -2.88036683e-02]
 [ 1.50548562e-01 -5.46757659e-02 -1.78791544e-02]
 [ 8.96364670e-02  1.54832512e-01  1.27308534e-01]
 [-2.15077116e-01  5.88972858e-02  3.39745715e-02]
 [-2.42157081e-02 -1.74417965e-01  5.94559871e-02]
 [ 5.00545526e-02 -9.38666857e-03  1.02211828e-01]
 [ 2.34153879e-01 -9.44576513e-02  9.67168301e-02]
 [-1.59190666e-02 -6.07953281e-02  2.25589762e-02]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 2.15102326e-02  3.87194974e-02  5.21316215e-02]
 [-2.32671302e-03 -1.81890688e-02 -6.97459121e-02]
 [-3.08423349e-02  2.23383201e-02 -5.11699671e-02]
 [-1.15970719e-01 -2.87852800e-02  4.29838514e-02]
 [ 1.31018618e-01  6.46316094e-03  2.32569384e-02]
 [-2.19839650e-02 -2.80305421e-02  3.05273212e-02]
 [-1.18355082e-01 -6.79347795e-02 -8.26319573e-02]
 [ 2.35222700e+00  1.51021314e+00  1.70087987e-01]
 [ 2.57295886e-04 -5.98610069e-02  1.88719975e-02]
 [ 3.28255496e-02 -1.39908791e-02 -6.48415504e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.26306754]
curr_Stock_Price:  98.13445544535084
curr_Factors:  [98.13445545 -0.62152824 -0.9891037 ]
mat_Sqrt:  [[19.60347006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.34744400e-03 4.98142307e-04 1.15903606e+00]
Stock Position:  0.0013474440043429337
Bond Position:  [-11.39529822]


portfolio before change:  [-11.26247851]
curr_Stock_Price:  99.62878677695021
curr_Factors:  [99.62878678 -0.76387055 -0.96784598]
mat_Sqrt:  [[17.63233823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04698345 0.06821903 0.58015085]
Stock Position:  0.04698344803102035
Bond Position:  [-15.94338244]


portfolio before change:  [-11.29586603]
curr_Stock_Price:  98.96058390130625
curr_Factors:  [98.9605839  -0.6556192  -0.94453752]
mat_Sqrt:  [[19.97666628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02183034 -0.08767143  0.11737406]
Stock Position:  -0.02183033760337833
Bond Position:  [-9.13552308]


portfolio before change:  [-11.28501864]
curr_Stock_Price:  98.41137567696781
curr_Factors:  [98.41137568 -0.33084675 -0.95504324]
mat_Sqrt:  [[27.20134497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03057836 0.42596366 4.31874106]
Stock Position:  0.03057835610924247
Bond Position:  [-14.29427673]


portfolio before change:  [-11.23659263]
curr_Stock_Price:  100.05348183704199
curr_Factors:  [100.05348184  -0.71342813  -0.94740634]
mat_Sqrt:  [[19.00819865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0030853  -0.01106097 -0.05874131]
Stock Position:  -0.0030853002966837973
Bond Position:  [-10.9278976]


portfolio before change:  [-11.23845107]
curr_Stock_Price:  100.2130654958171
curr_Factors:  [100.2130655   -0.89283404  -0.97081382]
mat_Sqrt:  [[15.54362703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00162975 -0.01107116  0.1007159 ]
Stock Position:  0.0016297518792759377
Bond Position:  [-11.4017735]


portfolio before change:  [-11.2373391]
curr_Stock_Price:  101.76991561659261
curr_Factors:  [101.76991562  -0.84099697  -0.97633401]
mat_Sqrt:  [[16.53341627  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003641   -0.02471458 -0.08050267]
Stock Position:  -0.0036409976698999185
Bond Position:  [-10.86679508]


portfolio before change:  [-11.23528717]
curr_Stock_Price:  100.8332593773013
curr_Factors:  [100.83325938  -1.05155844  -0.95764395]
mat_Sqrt:  [[13.52129527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00448703  0.06240637 -0.11729461]
Stock Position:  0.004487026133960196
Bond Position:  [-11.68772864]


portfolio before change:  [-11.23335352]
curr_Stock_Price:  101.58982145206126
curr_Factors:  [101.58982145  -0.93862924  -0.94222711]
mat_Sqrt:  [[15.48833244  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138411  0.01955111 -0.13093347]
Stock Position:  0.001384110880382893
Bond Position:  [-11.37396509]


portfolio before change:  [-11.23330195]
curr_Stock_Price:  102.65433334533851
curr_Factors:  [102.65433335  -0.72453096  -0.99315031]
mat_Sqrt:  [[18.42458824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01819304 -0.01131907 -0.33282735]
Stock Position:  -0.018193038341336083
Bond Position:  [-9.36570773]


portfolio before change:  [-11.2471611]
curr_Stock_Price:  103.35176333676462
curr_Factors:  [103.35176334  -0.75708353  -0.99334483]
mat_Sqrt:  [[17.95215182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04498683  0.38465885 -0.58831952]
Stock Position:  0.04498683190727184
Bond Position:  [-15.89662951]


portfolio before change:  [-11.2057487]
curr_Stock_Price:  104.31648146478375
curr_Factors:  [104.31648146  -0.87823183  -0.97545535]
mat_Sqrt:  [[16.34206061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046831  0.0068216  -0.16589547]
Stock Position:  -0.0004683108605142329
Bond Position:  [-11.15689615]


portfolio before change:  [-11.20715733]
curr_Stock_Price:  104.34624688778958
curr_Factors:  [104.34624689  -0.88987575  -0.96885604]
mat_Sqrt:  [[16.26446833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00315808 -0.00779285 -0.03209019]
Stock Position:  0.0031580795688086376
Bond Position:  [-11.53669108]


portfolio before change:  [-11.21092262]
curr_Stock_Price:  103.61063855896647
curr_Factors:  [103.61063856  -0.73957813  -0.93393921]
mat_Sqrt:  [[19.43591568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07408485 -0.9486533   7.01714618]
Stock Position:  0.07408484581633767
Bond Position:  [-18.8869008]


portfolio before change:  [-11.20298991]
curr_Stock_Price:  103.74958351917189
curr_Factors:  [103.74958352  -0.69902566  -0.94796297]
mat_Sqrt:  [[19.98519044  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108427 -0.03053791  0.10625201]
Stock Position:  -0.0010842715234672248
Bond Position:  [-11.0904972]


portfolio before change:  [-11.20468043]
curr_Stock_Price:  104.03006358690706
curr_Factors:  [104.03006359  -0.84085723  -0.98935397]
mat_Sqrt:  [[16.68430946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00771827 -0.02928608  0.07297961]
Stock Position:  0.007718267908163694
Bond Position:  [-12.00761233]


portfolio before change:  [-11.20799849]
curr_Stock_Price:  103.79464626057126
curr_Factors:  [103.79464626  -1.12017774  -0.97791222]
mat_Sqrt:  [[12.73462211  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01933423 -0.08954612 -0.04655942]
Stock Position:  -0.019334229937647444
Bond Position:  [-9.20120893]


portfolio before change:  [-11.21091236]
curr_Stock_Price:  103.8858651452226
curr_Factors:  [103.88586515  -1.18436212  -1.00220627]
mat_Sqrt:  [[11.66653465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05502872 -0.54419396 -0.57527314]
Stock Position:  -0.05502872098513843
Bond Position:  [-5.49420607]


portfolio before change:  [-11.16296733]
curr_Stock_Price:  103.00211124899776
curr_Factors:  [103.00211125  -1.45764552  -1.01304661]
mat_Sqrt:  [[ 8.70639104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00612114 0.03020213 0.77462214]
Stock Position:  0.006121140232486761
Bond Position:  [-11.7934577]


portfolio before change:  [-11.164538]
curr_Stock_Price:  102.98636357513128
curr_Factors:  [102.98636358  -1.42792624  -1.00781456]
mat_Sqrt:  [[ 9.01469288  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03741387 -0.08035986  1.17713671]
Stock Position:  0.037413871450346706
Bond Position:  [-15.01765657]


portfolio before change:  [-11.18544851]
curr_Stock_Price:  102.47764347661644
curr_Factors:  [102.47764348  -1.43946263  -1.01587035]
mat_Sqrt:  [[ 8.79612846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00366567 -0.05178031 -0.08216885]
Stock Position:  0.003665672206694247
Bond Position:  [-11.56109796]


portfolio before change:  [-11.18769676]
curr_Stock_Price:  102.25857917397896
curr_Factors:  [102.25857917  -1.15161383  -0.99874783]
mat_Sqrt:  [[11.9071973   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01139969 -0.01764653 -0.05100425]
Stock Position:  0.011399689424191804
Bond Position:  [-12.3534128]


portfolio before change:  [-11.19359795]
curr_Stock_Price:  101.87638267045256
curr_Factors:  [101.87638267  -1.0080796   -0.99529143]
mat_Sqrt:  [[13.7410694   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01071447 0.04997198 0.36317581]
Stock Position:  0.010714469345764113
Bond Position:  [-12.28514933]


portfolio before change:  [-11.19551594]
curr_Stock_Price:  101.84070673134038
curr_Factors:  [101.84070673  -0.85320705  -0.99989861]
mat_Sqrt:  [[15.96348991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01228552  0.01900902  0.09692   ]
Stock Position:  -0.012285517026695805
Bond Position:  [-9.9443502]


portfolio before change:  [-11.19716702]
curr_Stock_Price:  101.87391304913734
curr_Factors:  [101.87391305  -0.75415942  -1.0126791 ]
mat_Sqrt:  [[17.40743449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273919 -0.05629316  0.16961138]
Stock Position:  -0.002739187306026273
Bond Position:  [-10.91811529]


portfolio before change:  [-11.19795805]
curr_Stock_Price:  101.66442690781575
curr_Factors:  [101.66442691  -0.8218732   -0.97251861]
mat_Sqrt:  [[16.8995271   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0040831  -0.00302953  0.2915819 ]
Stock Position:  0.004083097032973612
Bond Position:  [-11.61306377]


portfolio before change:  [-11.20417559]
curr_Stock_Price:  100.497220596473
curr_Factors:  [100.4972206   -0.87712095  -0.98158648]
mat_Sqrt:  [[15.6649017   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01497711 -0.03048608  0.2759062 ]
Stock Position:  0.0149771148311654
Bond Position:  [-12.709334]


portfolio before change:  [-11.20699633]
curr_Stock_Price:  100.4149635646236
curr_Factors:  [100.41496356  -1.03218105  -0.95372157]
mat_Sqrt:  [[13.78262331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017213  -0.01962161  0.06435448]
Stock Position:  -0.0017212999843220433
Bond Position:  [-11.03415205]


portfolio before change:  [-11.20924447]
curr_Stock_Price:  100.91969319738975
curr_Factors:  [100.9196932   -1.12975647  -0.95189622]
mat_Sqrt:  [[12.58709899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175569 -0.02321455 -0.0028026 ]
Stock Position:  -0.00175568909359886
Bond Position:  [-11.03206087]


portfolio before change:  [-11.20940698]
curr_Stock_Price:  100.2267538944437
curr_Factors:  [100.22675389  -1.17516217  -0.93564263]
mat_Sqrt:  [[12.14151242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00329902 0.01249666 0.14871701]
Stock Position:  0.003299023891500913
Bond Position:  [-11.54005744]


portfolio before change:  [-11.21153982]
curr_Stock_Price:  100.0175282536494
curr_Factors:  [100.01752825  -0.91436168  -0.91779177]
mat_Sqrt:  [[16.00965534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126651 -0.0058705  -0.19896567]
Stock Position:  -0.0012665085789865188
Bond Position:  [-11.08486676]


portfolio before change:  [-11.2125512]
curr_Stock_Price:  99.72197909291468
curr_Factors:  [99.72197909 -1.06643538 -0.89161262]
mat_Sqrt:  [[14.07412654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260958  0.00720966 -0.14597367]
Stock Position:  -0.0026095807875158
Bond Position:  [-10.95231864]


portfolio before change:  [-11.21450712]
curr_Stock_Price:  99.94684011245452
curr_Factors:  [99.94684011 -1.1458852  -0.89205876]
mat_Sqrt:  [[13.02270657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00868271 -0.00929041  0.12262096]
Stock Position:  -0.008682714864950857
Bond Position:  [-10.3466972]


portfolio before change:  [-11.21683808]
curr_Stock_Price:  100.06633528671072
curr_Factors:  [100.06633529  -0.90206597  -0.90189832]
mat_Sqrt:  [[16.47541097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00832059 0.00208598 0.06634557]
Stock Position:  0.008320594114959142
Bond Position:  [-12.04944944]


portfolio before change:  [-11.21467148]
curr_Stock_Price:  100.50775473588043
curr_Factors:  [100.50775474  -0.80346913  -0.91025199]
mat_Sqrt:  [[18.1108963   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118571 -0.00904682  0.08708595]
Stock Position:  -0.0011857122751791484
Bond Position:  [-11.0954982]


portfolio before change:  [-11.21527221]
curr_Stock_Price:  99.8446139864854
curr_Factors:  [99.84461399 -1.07025368 -0.90042906]
mat_Sqrt:  [[13.91451275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01071467 -0.02192586 -0.23572597]
Stock Position:  -0.010714668288964243
Bond Position:  [-10.14547029]


portfolio before change:  [-11.20819492]
curr_Stock_Price:  99.06572388788484
curr_Factors:  [99.06572389 -0.76376512 -0.88924241]
mat_Sqrt:  [[18.96842917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.14208963 0.48741919 0.48521368]
Stock Position:  0.14208962742239145
Bond Position:  [-25.28440672]


portfolio before change:  [-11.47211314]
curr_Stock_Price:  97.23056199309504
curr_Factors:  [97.23056199 -0.81336476 -0.86206798]
mat_Sqrt:  [[18.20420021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044548 -0.01932006  0.05383656]
Stock Position:  -0.0004454768975099668
Bond Position:  [-11.42879917]


portfolio before change:  [-11.47435016]
curr_Stock_Price:  99.04508267204459
curr_Factors:  [99.04508267 -0.87376955 -0.86390018]
mat_Sqrt:  [[17.42499029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00096034 -0.00451554 -0.18497489]
Stock Position:  0.0009603418460084503
Bond Position:  [-11.5694673]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.47582389]
Stock Price:  99.01649555273391
PL:  [-11.47582389]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-1.97193778e-02 -9.60298874e-02  1.47604850e-01]
 [ 6.68741037e-01  2.00141215e-01  1.74028197e-01]
 [-3.48773126e-01 -2.34568067e-01  3.99698377e-02]
 [ 1.71668489e-01  9.65001160e-01  1.03546954e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 5.86072077e-02  3.96771602e-02 -1.48338073e-02]
 [-3.21888650e-02 -1.19266517e-01  2.13006366e-03]
 [ 2.34821318e-01  1.99518227e-02 -2.34570618e-01]
 [ 3.69334767e-02  4.05652633e-02 -4.28574604e-02]
 [-3.43320440e-01  1.56973792e-02 -1.22447739e-01]
 [ 4.63929905e-01  9.36267450e-01 -1.52901549e-01]
 [-3.91052349e-05  3.11046747e-02 -5.87443746e-02]
 [-1.87539400e-02 -1.27648158e-02 -1.02278670e-01]
 [ 1.57491026e+00 -3.02046097e+00  2.53473591e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.52544238e-01 -9.24572097e-02  2.47997860e-02]
 [-2.25375165e-01 -3.65424245e-01 -6.14225022e-03]
 [-2.54103547e-01 -1.67831495e+00 -2.04081187e-01]
 [-2.19359913e-04  3.29662636e-02  8.40180300e-02]
 [ 2.92006478e-01 -4.52948014e-01  2.57681248e-01]
 [ 6.71461804e-02  3.20170488e-02 -6.29155469e-02]
 [-1.78592440e-01 -5.08580443e-02 -1.56964861e-01]
 [ 2.99760443e-01  3.23023875e-01  2.83405106e-01]
 [ 4.00645013e-02  5.63934983e-02  1.68759920e-01]
 [-1.01441391e-01 -3.07901496e-01  1.12341593e-01]
 [ 1.65141604e-01 -5.20394796e-02 -1.81595367e-01]
 [ 6.63240844e-01 -1.48177477e-02  4.14466594e-01]
 [-5.89044029e-02  6.07100155e-02  1.05738075e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 3.11614440e-01 -1.05057842e-01 -4.34949640e-02]
 [-2.84512567e-02 -8.61337818e-02 -1.81227833e-02]
 [-7.31875775e-02 -3.74830658e-02  4.85657515e-02]
 [-7.65994099e-02 -5.01998457e-02  1.66200222e-02]
 [ 4.02877643e-01  5.18839651e-02  8.18779762e-02]
 [ 3.27864251e-02 -3.63206276e-03 -1.04989335e-02]
 [-1.07109670e-01 -4.67617364e-02 -9.72572869e-02]
 [ 1.90313122e+00  1.24007087e+00  1.54721693e-01]
 [-5.38021853e-02 -1.26686413e-02  8.33807623e-03]
 [ 3.29920114e-02 -1.43093991e-02 -7.02070563e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.86513883]
curr_Stock_Price:  99.28045022855447
curr_Factors:  [99.28045023 -0.93594473 -0.99362605]
mat_Sqrt:  [[14.41656505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063758 -0.03099351  0.42107555]
Stock Position:  -0.0006375778565559379
Bond Position:  [-2.80183982]


portfolio before change:  [-2.86565137]
curr_Stock_Price:  99.53498125214581
curr_Factors:  [99.53498125 -0.70068134 -1.00534016]
mat_Sqrt:  [[18.07423878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04122542 0.0645953  0.49645401]
Stock Position:  0.04122541798066156
Bond Position:  [-6.96902258]


portfolio before change:  [-2.87531882]
curr_Stock_Price:  99.32161117527488
curr_Factors:  [99.32161118 -0.61427771 -0.9839872 ]
mat_Sqrt:  [[20.08751096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01934014 -0.07570652  0.11402282]
Stock Position:  -0.019340142458316407
Bond Position:  [-0.95442471]


portfolio before change:  [-2.88926582]
curr_Stock_Price:  100.03658469708172
curr_Factors:  [100.0365847   -0.49529574  -0.99068093]
mat_Sqrt:  [[22.6364015   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02562302 0.31145279 2.95390639]
Stock Position:  0.02562301527591858
Bond Position:  [-5.45250476]


portfolio before change:  [-2.85240278]
curr_Stock_Price:  101.50185511308906
curr_Factors:  [101.50185511  -0.6058141   -0.98564844]
mat_Sqrt:  [[20.66857715  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283745 -0.01106097 -0.05874131]
Stock Position:  -0.002837447421687178
Bond Position:  [-2.56439661]


portfolio before change:  [-2.85369712]
curr_Stock_Price:  101.8450393594014
curr_Factors:  [101.84503936  -0.51078372  -0.99135186]
mat_Sqrt:  [[22.67622125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00280815  0.01280575 -0.04231672]
Stock Position:  0.0028081546387507717
Bond Position:  [-3.13969374]


portfolio before change:  [-2.8491374]
curr_Stock_Price:  103.60854948258279
curr_Factors:  [103.60854948  -0.4598617   -1.02984532]
mat_Sqrt:  [[23.35737614  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240178 -0.0384931   0.00607648]
Stock Position:  -0.0024017784835520537
Bond Position:  [-2.60029261]


portfolio before change:  [-2.85212528]
curr_Stock_Price:  104.71723711740982
curr_Factors:  [104.71723712  -0.56914845  -1.01459044]
mat_Sqrt:  [[21.48864921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00888899  0.00643942 -0.66916468]
Stock Position:  0.008888992431519187
Bond Position:  [-3.782956]


portfolio before change:  [-2.85707524]
curr_Stock_Price:  104.21357363278906
curr_Factors:  [104.21357363  -0.51584571  -0.99366688]
mat_Sqrt:  [[23.03304209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158319  0.01309238 -0.12226041]
Stock Position:  0.0015831857465810476
Bond Position:  [-3.02206468]


portfolio before change:  [-2.85862763]
curr_Stock_Price:  103.47164436690997
curr_Factors:  [103.47164437  -0.32483554  -0.99837874]
mat_Sqrt:  [[27.55222589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01325159  0.00506631 -0.34930932]
Stock Position:  -0.013251588702313546
Bond Position:  [-1.48746396]


portfolio before change:  [-2.87920396]
curr_Stock_Price:  105.01035663964767
curr_Factors:  [105.01035664  -0.60345006  -1.02599551]
mat_Sqrt:  [[20.58604486  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03030372  0.30217902 -0.43618556]
Stock Position:  0.030303722940133428
Bond Position:  [-6.06140871]


portfolio before change:  [-2.90955211]
curr_Stock_Price:  104.03389457925351
curr_Factors:  [104.03389458  -0.71399169  -1.05921722]
mat_Sqrt:  [[17.66363213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032162  0.01003899 -0.16758135]
Stock Position:  -0.00032162328289402775
Bond Position:  [-2.87609239]


portfolio before change:  [-2.90972001]
curr_Stock_Price:  103.4380392228638
curr_Factors:  [103.43803922  -0.66470016  -1.03212166]
mat_Sqrt:  [[18.95657719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0022281  -0.00411983 -0.29177258]
Stock Position:  -0.002228097026949156
Bond Position:  [-2.67925002]


portfolio before change:  [-2.91006125]
curr_Stock_Price:  103.44087191727392
curr_Factors:  [103.44087192  -0.87662699  -1.00942698]
mat_Sqrt:  [[15.68878606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09406477 -0.97484959  7.23089603]
Stock Position:  0.0940647695087594
Bond Position:  [-12.64020302]


portfolio before change:  [-2.95439359]
curr_Stock_Price:  102.98637420759349
curr_Factors:  [102.98637421  -0.57982553  -1.03125336]
mat_Sqrt:  [[20.56350291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105378 -0.03053791  0.10625201]
Stock Position:  -0.0010537782875065197
Bond Position:  [-2.84586879]


portfolio before change:  [-2.95618343]
curr_Stock_Price:  104.34726458147017
curr_Factors:  [104.34726458  -0.60722287  -1.03439661]
mat_Sqrt:  [[20.20853295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00686511 -0.02984044  0.07074689]
Stock Position:  0.0068651061875105905
Bond Position:  [-3.67253848]


portfolio before change:  [-2.9542565]
curr_Stock_Price:  104.69482224329535
curr_Factors:  [104.69482224  -0.5376537   -1.03206789]
mat_Sqrt:  [[21.7873185   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01382551 -0.11794017 -0.01752213]
Stock Position:  -0.013825513145355179
Bond Position:  [-1.50679686]


portfolio before change:  [-2.9630988]
curr_Stock_Price:  105.3207617400281
curr_Factors:  [105.32076174  -0.77344999  -1.07360157]
mat_Sqrt:  [[16.60923735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03843319 -0.54167382 -0.58218682]
Stock Position:  -0.038433194496196955
Bond Position:  [1.08471452]


portfolio before change:  [-2.96173704]
curr_Stock_Price:  105.28885810705034
curr_Factors:  [105.28885811  -0.79713747  -1.07801103]
mat_Sqrt:  [[16.14417174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00146554 0.01063982 0.23968005]
Stock Position:  0.0014655418325582052
Bond Position:  [-3.11604227]


portfolio before change:  [-2.96413974]
curr_Stock_Price:  103.9151858694157
curr_Factors:  [103.91518587  -0.95757968  -1.08205548]
mat_Sqrt:  [[13.51688826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01865428 -0.14618834  0.73509288]
Stock Position:  0.018654279837882145
Bond Position:  [-4.9026027]


portfolio before change:  [-2.9603358]
curr_Stock_Price:  104.15195750443317
curr_Factors:  [104.1519575   -1.05170294  -1.08692825]
mat_Sqrt:  [[12.27076708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00495805  0.01033346 -0.17948054]
Stock Position:  0.004958047893761845
Bond Position:  [-3.4767262]


portfolio before change:  [-2.95344597]
curr_Stock_Price:  105.62924347034004
curr_Factors:  [105.62924347  -1.42493574  -1.10415903]
mat_Sqrt:  [[ 8.42194234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02624265 -0.01641436 -0.44777706]
Stock Position:  -0.02624265333978465
Bond Position:  [-0.18145435]


portfolio before change:  [-2.94581775]
curr_Stock_Price:  105.3376989401678
curr_Factors:  [105.33769894  -1.21621477  -1.0771974 ]
mat_Sqrt:  [[10.63083978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03984137 0.10425551 0.80847588]
Stock Position:  0.039841371771115436
Bond Position:  [-7.14261617]


portfolio before change:  [-2.91424195]
curr_Stock_Price:  106.15264770535232
curr_Factors:  [106.15264771  -1.10416058  -1.08660957]
mat_Sqrt:  [[11.87111313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00724648 0.01820092 0.48142508]
Stock Position:  0.007246477182455532
Bond Position:  [-3.68347469]


portfolio before change:  [-2.91706248]
curr_Stock_Price:  105.82696397736945
curr_Factors:  [105.82696398  -1.00797392  -1.07604504]
mat_Sqrt:  [[13.16795703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01073514 -0.09937478  0.32047929]
Stock Position:  -0.010735142042259907
Bond Position:  [-1.78099499]


portfolio before change:  [-2.92549974]
curr_Stock_Price:  106.59217304366156
curr_Factors:  [106.59217304  -0.86211408  -1.07935945]
mat_Sqrt:  [[15.29516186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00767897 -0.01679567 -0.51804104]
Stock Position:  0.007678970128301999
Bond Position:  [-3.74401786]


portfolio before change:  [-2.92284601]
curr_Stock_Price:  106.998707502063
curr_Factors:  [106.9987075   -1.03911316  -1.09049697]
mat_Sqrt:  [[12.72039519  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05855312 -0.00478241  1.18235783]
Stock Position:  0.058553119789205764
Bond Position:  [-9.18795415]


portfolio before change:  [-2.91718504]
curr_Stock_Price:  107.11500416782278
curr_Factors:  [107.11500417  -0.89238564  -1.09572363]
mat_Sqrt:  [[14.66984164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00169929  0.01959407  0.3016413 ]
Stock Position:  -0.0016992909138507655
Bond Position:  [-2.73516549]


portfolio before change:  [-2.91747279]
curr_Stock_Price:  107.08312498773475
curr_Factors:  [107.08312499  -0.53404096  -1.0938257 ]
mat_Sqrt:  [[21.02555805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00163513 -0.02600141 -0.03673698]
Stock Position:  -0.0016351270982500282
Bond Position:  [-2.74237827]


portfolio before change:  [-2.91659652]
curr_Stock_Price:  106.33756536263711
curr_Factors:  [106.33756536  -0.63579884  -1.09504847]
mat_Sqrt:  [[18.83602579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01493368 -0.03390727 -0.12407903]
Stock Position:  0.01493368233214479
Bond Position:  [-4.50460794]


portfolio before change:  [-2.91711495]
curr_Stock_Price:  106.34055749830482
curr_Factors:  [106.3405575   -0.55216578  -1.05897742]
mat_Sqrt:  [[21.23187399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234235 -0.02779956 -0.05169926]
Stock Position:  -0.002342352773114771
Bond Position:  [-2.66802785]


portfolio before change:  [-2.91927235]
curr_Stock_Price:  107.11921010762278
curr_Factors:  [107.11921011  -0.466235    -1.0368793 ]
mat_Sqrt:  [[23.82720581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297665 -0.01209761  0.13854457]
Stock Position:  -0.0029766534234050165
Bond Position:  [-2.60041559]


portfolio before change:  [-2.91251891]
curr_Stock_Price:  104.7412003812267
curr_Factors:  [104.74120038  -0.47941017  -1.04711942]
mat_Sqrt:  [[22.75905218  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366684 -0.01620193  0.0474123 ]
Stock Position:  -0.0036668426255013886
Bond Position:  [-2.52844942]


portfolio before change:  [-2.90913174]
curr_Stock_Price:  103.73127229832619
curr_Factors:  [103.7312723   -0.68094849  -1.05124242]
mat_Sqrt:  [[18.34969076  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02344354 0.01674548 0.23357508]
Stock Position:  0.02344353866110971
Bond Position:  [-5.34095984]


portfolio before change:  [-2.93791894]
curr_Stock_Price:  102.53181469568445
curr_Factors:  [102.5318147   -0.72758468  -1.05290049]
mat_Sqrt:  [[17.28238833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017302  -0.00117224 -0.02995053]
Stock Position:  0.0017301976430717184
Bond Position:  [-3.11531924]


portfolio before change:  [-2.93992153]
curr_Stock_Price:  101.59946403038353
curr_Factors:  [101.59946403  -0.56403107  -1.02672226]
mat_Sqrt:  [[20.70313054  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00659356 -0.01509229 -0.27744797]
Stock Position:  -0.006593564687702865
Bond Position:  [-2.27001889]


portfolio before change:  [-2.93308832]
curr_Stock_Price:  100.52008209864987
curr_Factors:  [100.5200821   -0.60408647  -1.03906908]
mat_Sqrt:  [[19.43745708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11255804 0.40023115 0.44137792]
Stock Position:  0.112558039395533
Bond Position:  [-14.24743168]


portfolio before change:  [-3.18962487]
curr_Stock_Price:  98.25675634996563
curr_Factors:  [98.25675635 -0.43580287 -1.01982009]
mat_Sqrt:  [[22.91888065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238607 -0.00408879  0.02378621]
Stock Position:  -0.0023860745646019535
Bond Position:  [-2.95517692]


portfolio before change:  [-3.19003528]
curr_Stock_Price:  98.27393395913526
curr_Factors:  [98.27393396 -0.54617453 -1.04798202]
mat_Sqrt:  [[19.95744527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078869 -0.00461834 -0.20028119]
Stock Position:  0.0007886862243678271
Bond Position:  [-3.26754258]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.19018575]
Stock Price:  98.60104837659497
PL:  [-3.19018575]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.64777096e-01  2.75163273e-02 -7.56262690e-02]
 [ 2.00138646e+00  4.49233201e-01  7.22823339e-01]
 [ 1.29690584e-01  2.39773832e-01  4.29973334e-02]
 [ 3.47856040e-02  2.50709972e-01  2.21461198e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-1.70311705e-01 -4.41750944e-02 -8.85568352e-02]
 [-3.21888650e-02 -1.19266517e-01  2.13006366e-03]
 [ 2.11257206e-01 -9.86574717e-02 -1.97669202e-01]
 [-2.36470152e-02  1.06123146e-01 -5.28173790e-02]
 [-4.11962847e-01 -6.22143065e-03 -1.64032005e-01]
 [ 6.06980212e-01  1.17501762e+00 -2.10921199e-01]
 [-2.45294983e-04  2.33554915e-02 -5.78381870e-02]
 [-1.15194447e-01 -4.36071286e-02 -4.32838057e-01]
 [ 1.79134234e+00 -3.50465674e+00  3.01427716e+00]
 [ 2.00728399e-02 -9.31820740e-02  3.99246623e-02]
 [ 1.21830959e-01 -5.73554761e-02  6.56158231e-03]
 [-1.44913039e-01 -1.88249535e-01 -3.17555787e-02]
 [-2.65294453e-01 -1.73854508e+00 -2.02817006e-01]
 [-8.06736130e-03  3.91260865e-02  1.68225000e-01]
 [ 2.60922918e-01 -3.74988824e-01  2.61870885e-01]
 [ 4.73908013e-02 -1.15798113e-02  8.73443114e-02]
 [ 1.32240570e-01 -5.26343921e-02 -1.15380568e-02]
 [ 2.41300293e-01  1.33295911e-01  1.63902780e-01]
 [-2.15625765e-01  5.92967124e-02  3.38129474e-02]
 [-4.89024692e-02 -2.07028042e-01  7.61593972e-02]
 [ 5.35105813e-02 -6.36280187e-03  1.62148992e-01]
 [ 1.39723518e-01 -9.10516466e-02  5.67485059e-02]
 [-7.58633090e-02  4.70940617e-02  1.24112621e-01]
 [-5.59342718e-03 -7.11470148e-02  3.42629073e-03]
 [-1.49556852e-02  6.16984375e-02  5.72395742e-02]
 [-2.23929013e-02 -1.44359961e-02 -6.55854930e-02]
 [-1.03829619e-02  2.00813894e-02 -5.60488735e-02]
 [-9.21067795e-02 -3.33212374e-02  3.82792514e-02]
 [ 2.31375545e-01  1.15786285e-02  4.21767004e-02]
 [-1.40325954e-03 -3.03471160e-02  2.39528617e-02]
 [-1.05843137e-01 -5.01590339e-02 -8.88316143e-02]
 [ 1.56763219e+00  1.03558368e+00  1.42720439e-01]
 [-2.32732809e-02 -7.28330915e-02 -3.44016051e-02]
 [ 3.39535520e-02 -1.41361041e-02 -8.70132808e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.79797433]
curr_Stock_Price:  101.82724850215483
curr_Factors:  [101.8272485   -1.22441201  -1.03177469]
mat_Sqrt:  [[10.66631916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01452766  0.00888086 -0.2157407 ]
Stock Position:  0.014527663472272008
Bond Position:  [14.31866233]


portfolio before change:  [15.80220937]
curr_Stock_Price:  101.99555500455794
curr_Factors:  [101.995555    -1.47314518  -1.04514001]
mat_Sqrt:  [[ 8.22060692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.27256278 0.14498939 2.06201379]
Stock Position:  0.27256278337453643
Bond Position:  [-11.99798299]


portfolio before change:  [15.92893189]
curr_Stock_Price:  102.46598739950308
curr_Factors:  [102.4659874   -1.49979771  -1.0611849 ]
mat_Sqrt:  [[ 7.91332707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02368296 0.07738667 0.12265942]
Stock Position:  0.0236829597647138
Bond Position:  [13.50223404]


portfolio before change:  [15.9377262]
curr_Stock_Price:  102.76605218615622
curr_Factors:  [102.76605219  -1.62917002  -1.06374424]
mat_Sqrt:  [[ 6.95555631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01885789 0.0809163  0.63176716]
Stock Position:  0.018857893574876168
Bond Position:  [13.99977493]


portfolio before change:  [15.93748497]
curr_Stock_Price:  102.66045662050765
curr_Factors:  [102.66045662  -1.61637934  -1.06248274]
mat_Sqrt:  [[ 7.04673877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00832243 -0.01106097 -0.05874131]
Stock Position:  -0.00832243153507879
Bond Position:  [16.79186959]


portfolio before change:  [15.94054183]
curr_Stock_Price:  102.54537652825269
curr_Factors:  [102.54537653  -1.64210931  -1.0553709 ]
mat_Sqrt:  [[ 6.90900194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02857222 -0.01425745 -0.252628  ]
Stock Position:  -0.02857221605504953
Bond Position:  [18.87049049]


portfolio before change:  [15.94129158]
curr_Stock_Price:  102.60169746930129
curr_Factors:  [102.60169747  -1.56248013  -1.03350181]
mat_Sqrt:  [[ 7.65127681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00733201 -0.0384931   0.00607648]
Stock Position:  -0.007332010700200081
Bond Position:  [16.69356832]


portfolio before change:  [15.939902]
curr_Stock_Price:  103.07583789910687
curr_Factors:  [103.0758379   -1.69785251  -1.04498957]
mat_Sqrt:  [[ 6.6367536   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0227174  -0.03184156 -0.56389521]
Stock Position:  0.022717398576364345
Bond Position:  [13.59828711]


portfolio before change:  [15.93904676]
curr_Stock_Price:  102.96336289851219
curr_Factors:  [102.9633629   -1.84609733  -1.03758497]
mat_Sqrt:  [[ 5.75858004  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221687  0.0342511  -0.15067328]
Stock Position:  -0.002216869601556223
Bond Position:  [16.1673031]


portfolio before change:  [15.94224185]
curr_Stock_Price:  102.4337612223168
curr_Factors:  [102.43376122  -1.71413849  -1.05517938]
mat_Sqrt:  [[ 6.42308471  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06954847 -0.00200796 -0.46793765]
Stock Position:  -0.06954846532230366
Bond Position:  [23.06635274]


portfolio before change:  [15.95896725]
curr_Stock_Price:  102.23473557717939
curr_Factors:  [102.23473558  -1.66390852  -1.05000546]
mat_Sqrt:  [[ 6.77580052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11862444  0.37923531 -0.60169947]
Stock Position:  0.11862444407847042
Bond Position:  [3.83142858]


portfolio before change:  [15.97204952]
curr_Stock_Price:  102.34098104623375
curr_Factors:  [102.34098105  -1.79721813  -1.05142482]
mat_Sqrt:  [[ 5.92788354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00122878  0.00753795 -0.16499625]
Stock Position:  -0.0012287767950275139
Bond Position:  [16.09780375]


portfolio before change:  [15.97353036]
curr_Stock_Price:  102.7735391131151
curr_Factors:  [102.77353911  -2.26572425  -1.09041263]
mat_Sqrt:  [[ 3.58368298  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05928214 -0.01407414 -1.2347665 ]
Stock Position:  -0.05928214477586508
Bond Position:  [22.06616618]


portfolio before change:  [15.99735202]
curr_Stock_Price:  102.4182345468443
curr_Factors:  [102.41823455  -1.85425363  -1.11041005]
mat_Sqrt:  [[ 5.28250855  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.32015926 -1.1311231   8.59889373]
Stock Position:  0.32015925960672637
Bond Position:  [-16.79279413]


portfolio before change:  [16.09623597]
curr_Stock_Price:  102.73365002997471
curr_Factors:  [102.73365003  -1.97094583  -1.08833529]
mat_Sqrt:  [[ 4.82040811  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00190891 -0.03007439  0.11389395]
Stock Position:  0.0019089081353715228
Bond Position:  [15.90012687]


portfolio before change:  [16.09771873]
curr_Stock_Price:  102.4691623544474
curr_Factors:  [102.46916235  -1.74772693  -1.11785902]
mat_Sqrt:  [[ 5.83559332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01910049 -0.0185114   0.01871837]
Stock Position:  0.019100491165298328
Bond Position:  [14.1405074]


portfolio before change:  [16.10288985]
curr_Stock_Price:  102.64734863271939
curr_Factors:  [102.64734863  -1.44928393  -1.14359507]
mat_Sqrt:  [[ 7.67847004  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02472125 -0.06075728 -0.09058983]
Stock Position:  -0.024721252212624764
Bond Position:  [18.64046085]


portfolio before change:  [16.10147867]
curr_Stock_Price:  102.79869139056851
curr_Factors:  [102.79869139  -1.03809815  -1.14782792]
mat_Sqrt:  [[11.55186105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05726985 -0.56111301 -0.57858046]
Stock Position:  -0.05726984829925017
Bond Position:  [21.98874413]


portfolio before change:  [16.10632664]
curr_Stock_Price:  102.76203670629067
curr_Factors:  [102.76203671  -0.97275338  -1.14387288]
mat_Sqrt:  [[12.37637883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00276801 0.01262789 0.4798991 ]
Stock Position:  0.002768014970843696
Bond Position:  [15.82187979]


portfolio before change:  [16.10901672]
curr_Stock_Price:  103.01933870491773
curr_Factors:  [103.0193387   -0.94866876  -1.12768692]
mat_Sqrt:  [[12.91721665  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01841208 -0.12102712  0.74704475]
Stock Position:  0.018412079198000385
Bond Position:  [14.2122165]


portfolio before change:  [16.08869679]
curr_Stock_Price:  101.8192263765429
curr_Factors:  [101.81922638  -0.91608244  -1.11049421]
mat_Sqrt:  [[13.41833831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00468435 -0.00373737  0.24916901]
Stock Position:  0.004684347917638605
Bond Position:  [15.61174011]


portfolio before change:  [16.08854003]
curr_Stock_Price:  101.36914133039
curr_Factors:  [101.36914133  -0.79898215  -1.13988697]
mat_Sqrt:  [[14.58362896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00816953 -0.01698768 -0.03291486]
Stock Position:  0.008169532044859186
Bond Position:  [15.26040158]


portfolio before change:  [16.09091354]
curr_Stock_Price:  101.42616319927663
curr_Factors:  [101.4261632   -0.74296552  -1.15189643]
mat_Sqrt:  [[15.24831691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01980322 0.04302107 0.46756901]
Stock Position:  0.019803216513959193
Bond Position:  [14.08234927]


portfolio before change:  [16.09592403]
curr_Stock_Price:  101.59028217649124
curr_Factors:  [101.59028218  -0.49452949  -1.15912388]
mat_Sqrt:  [[19.43925582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01011458  0.01913793  0.09645893]
Stock Position:  -0.010114576228973349
Bond Position:  [17.12346668]


portfolio before change:  [16.08625528]
curr_Stock_Price:  102.75783624687594
curr_Factors:  [102.75783625  -0.71723983  -1.17836165]
mat_Sqrt:  [[15.43709901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00489832 -0.06681801  0.21726156]
Stock Position:  -0.004898324441725237
Bond Position:  [16.5895965]


portfolio before change:  [16.09687632]
curr_Stock_Price:  101.01291026183736
curr_Factors:  [101.01291026  -0.55199574  -1.1861985 ]
mat_Sqrt:  [[17.76187124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.004803   -0.00205359  0.46256594]
Stock Position:  0.004803002061297056
Bond Position:  [15.61171111]


portfolio before change:  [16.09684518]
curr_Stock_Price:  100.60010072733024
curr_Factors:  [100.60010073  -0.52469657  -1.18951379]
mat_Sqrt:  [[18.11866986  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00732512 -0.02938679  0.16188769]
Stock Position:  0.0073251193218835265
Bond Position:  [15.35993744]


portfolio before change:  [16.10564765]
curr_Stock_Price:  101.53965623926972
curr_Factors:  [101.53965624  -0.52472382  -1.20290759]
mat_Sqrt:  [[18.04408649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226755  0.01519954  0.35405876]
Stock Position:  -0.0022675512658838735
Bond Position:  [16.33589403]


portfolio before change:  [16.10802181]
curr_Stock_Price:  101.39322277795186
curr_Factors:  [101.39322278  -0.35712954  -1.21526357]
mat_Sqrt:  [[21.04395067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00092268 -0.0229626   0.00977425]
Stock Position:  -0.0009226814114443924
Bond Position:  [16.20157545]


portfolio before change:  [16.11032912]
curr_Stock_Price:  101.08760730852993
curr_Factors:  [101.08760731  -0.28457312  -1.19184102]
mat_Sqrt:  [[23.09401298  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00040367 0.01991309 0.16328857]
Stock Position:  0.00040367322840909595
Bond Position:  [16.06952276]


portfolio before change:  [16.1122391]
curr_Stock_Price:  100.84275824429425
curr_Factors:  [100.84275824  -0.54848535  -1.19101708]
mat_Sqrt:  [[17.70877054  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218689 -0.0046592  -0.18709716]
Stock Position:  -0.002186894863994279
Bond Position:  [16.33277161]


portfolio before change:  [16.11488053]
curr_Stock_Price:  100.56852894570126
curr_Factors:  [100.56852895  -0.55562849  -1.16721788]
mat_Sqrt:  [[17.95723343  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098706  0.00648124 -0.15989184]
Stock Position:  -0.0009870559334259007
Bond Position:  [16.2141473]


portfolio before change:  [16.11824206]
curr_Stock_Price:  99.21638951640071
curr_Factors:  [99.21638952 -0.58061846 -1.17434292]
mat_Sqrt:  [[17.15589488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00530982 -0.01075438  0.10920005]
Stock Position:  -0.005309820896122058
Bond Position:  [16.64506332]


portfolio before change:  [16.11483104]
curr_Stock_Price:  100.25065986195825
curr_Factors:  [100.25065986  -0.79618253  -1.17633999]
mat_Sqrt:  [[13.94541995  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01737834 0.00373699 0.12031839]
Stock Position:  0.0173783440625972
Bond Position:  [14.37264058]


portfolio before change:  [16.12549464]
curr_Stock_Price:  100.76088727853616
curr_Factors:  [100.76088728  -0.89653432  -1.1672351 ]
mat_Sqrt:  [[12.79405783  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0002117  -0.00979449  0.06833085]
Stock Position:  -0.00021169837294163527
Bond Position:  [16.14682555]


portfolio before change:  [16.12741987]
curr_Stock_Price:  101.20137018026784
curr_Factors:  [101.20137018  -0.72306392  -1.13906602]
mat_Sqrt:  [[15.72076358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0085374  -0.01618876 -0.25341187]
Stock Position:  -0.008537402399275175
Bond Position:  [16.99141669]


portfolio before change:  [16.13595351]
curr_Stock_Price:  100.45060569001973
curr_Factors:  [100.45060569  -0.35481096  -1.1277005 ]
mat_Sqrt:  [[22.8089879   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07927368 0.33423319 0.40714169]
Stock Position:  0.07927368460962642
Bond Position:  [8.17286387]


portfolio before change:  [16.1382191]
curr_Stock_Price:  100.4662971539209
curr_Factors:  [100.46629715  -0.31925074  -1.13035038]
mat_Sqrt:  [[23.57581021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191563 -0.02350678 -0.0981382 ]
Stock Position:  -0.001915627554860019
Bond Position:  [16.3306751]


portfolio before change:  [16.14263679]
curr_Stock_Price:  99.22585435460225
curr_Factors:  [99.22585435 -0.21770912 -1.11999595]
mat_Sqrt:  [[26.04155519  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00051097 -0.00456241 -0.24822467]
Stock Position:  0.000510972567174251
Bond Position:  [16.0919351]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.14397398]
Stock Price:  97.90597694140678
PL:  [16.14397398]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 8.68474920e-02 -5.44247511e-02 -1.09430516e-01]
 [ 1.12423024e+00  2.34918850e-01  3.19058275e-01]
 [-3.07613736e-01 -1.96681697e-01  3.87692770e-02]
 [ 1.77993626e-01  1.14971192e+00  1.10206106e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 5.54558016e-02  9.58959149e-02 -4.76287987e-02]
 [-3.21888650e-02 -1.19266517e-01  2.13006366e-03]
 [ 1.95266526e-01  2.98656669e-02 -1.87175209e-01]
 [ 8.03511797e-03  7.18379578e-02 -4.76085823e-02]
 [-4.86080958e-01  1.09732556e-01 -1.69406767e-01]
 [ 2.98249817e-01  6.08178894e-01 -9.86960028e-02]
 [-1.12731934e-04  1.44724687e-02 -5.78220713e-02]
 [ 6.49759585e-02 -4.87223380e-02 -1.17661402e-01]
 [ 1.70288437e+00 -3.33694485e+00  2.89590526e+00]
 [ 5.32080813e-02 -1.04629462e-01  6.36980709e-02]
 [ 1.15373013e-01 -9.89869879e-02  3.31217310e-02]
 [-1.78343127e-01 -2.58550464e-01 -1.69742149e-02]
 [-2.59045389e-01 -1.69565610e+00 -2.00179332e-01]
 [-1.42515379e-02  5.71011987e-02  2.24336332e-01]
 [ 2.92677517e-01 -4.14754276e-01  2.81205621e-01]
 [ 6.67033190e-02 -2.90775303e-02 -6.93717291e-03]
 [ 1.38818489e-01 -5.33729060e-02 -1.36638835e-02]
 [ 9.84707900e-02  1.67081296e-01  1.34677903e-01]
 [-8.14935194e-02  1.87692508e-03  3.87178761e-02]
 [-2.50274428e-02 -1.55676935e-01  5.54168849e-02]
 [ 4.69077634e-02 -7.08489958e-03  1.39258568e-01]
 [ 4.26424302e-01 -8.41094052e-02  2.12430793e-01]
 [ 2.74092514e-02 -1.18221583e-01 -2.60922569e-02]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 5.52850859e-02  6.15403580e-03  9.76378304e-02]
 [-1.85650839e-02 -2.49223957e-02 -5.98530523e-02]
 [-3.77279209e-02  2.30978884e-02 -4.95279749e-02]
 [-8.85579004e-02 -4.68965921e-02  1.79551784e-02]
 [ 2.42475037e-01  2.13371167e-02  5.03102238e-02]
 [-3.47356544e-02 -1.58555487e-02  2.93037714e-02]
 [-1.18954133e-01 -6.94194064e-02 -8.16948086e-02]
 [ 1.82595117e+00  1.18811126e+00  1.51001917e-01]
 [-3.92655130e-02 -5.41546464e-02 -1.21626502e-02]
 [ 3.40375166e-02 -1.38926068e-02 -8.80499753e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.15512675]
curr_Stock_Price:  100.3749084979994
curr_Factors:  [100.3749085   -1.13820275  -0.99893443]
mat_Sqrt:  [[11.84345121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00450888 -0.01756551 -0.3121748 ]
Stock Position:  0.004508877906834607
Bond Position:  [4.70254854]


portfolio before change:  [5.15614794]
curr_Stock_Price:  100.47101558038406
curr_Factors:  [100.47101558  -0.88151463  -1.00787854]
mat_Sqrt:  [[15.18755148  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08146872 0.07581973 0.91018445]
Stock Position:  0.08146871779536276
Bond Position:  [-3.02909688]


portfolio before change:  [5.08347838]
curr_Stock_Price:  99.58367010927681
curr_Factors:  [99.58367011 -0.82425792 -1.00923399]
mat_Sqrt:  [[15.91888724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0213487  -0.06347874  0.11059796]
Stock Position:  -0.021348695303783412
Bond Position:  [7.20945981]


portfolio before change:  [5.07909849]
curr_Stock_Price:  99.83104487051902
curr_Factors:  [99.83104487 -0.74543763 -1.01109776]
mat_Sqrt:  [[17.23502785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03699645 0.37106793 3.14387344]
Stock Position:  0.03699645080240405
Bond Position:  [1.38570415]


portfolio before change:  [5.13014602]
curr_Stock_Price:  101.2061581527506
curr_Factors:  [101.20615815  -0.89147487  -1.03392543]
mat_Sqrt:  [[14.75761619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00397395 -0.01106097 -0.05874131]
Stock Position:  -0.003973948107999384
Bond Position:  [5.53233404]


portfolio before change:  [5.12408876]
curr_Stock_Price:  102.9044301830166
curr_Factors:  [102.90443018  -0.97152845  -1.0617019 ]
mat_Sqrt:  [[13.47141918  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00484791  0.03095027 -0.13587171]
Stock Position:  0.004847914285807944
Bond Position:  [4.62521691]


portfolio before change:  [5.12683792]
curr_Stock_Price:  103.35224439730003
curr_Factors:  [103.3522444   -1.17068795  -1.04876475]
mat_Sqrt:  [[11.23114028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00499497 -0.0384931   0.00607648]
Stock Position:  -0.004994973086243311
Bond Position:  [5.6430796]


portfolio before change:  [5.12749279]
curr_Stock_Price:  103.36236615884872
curr_Factors:  [103.36236616  -1.14555683  -1.03935136]
mat_Sqrt:  [[11.62703216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01403246  0.0096391  -0.53395877]
Stock Position:  0.014032458830206224
Bond Position:  [3.67706464]


portfolio before change:  [5.12563006]
curr_Stock_Price:  103.19686487421048
curr_Factors:  [103.19686487  -1.12230005  -1.03007864]
mat_Sqrt:  [[11.99224011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00108244  0.0231856  -0.13581403]
Stock Position:  0.0010824431811113301
Bond Position:  [5.01392532]


portfolio before change:  [5.12740481]
curr_Stock_Price:  104.25739932535835
curr_Factors:  [104.25739933  -1.22905279  -1.02125741]
mat_Sqrt:  [[10.98524082  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04535739  0.03541603 -0.48327035]
Stock Position:  -0.04535739483777344
Bond Position:  [9.85624883]


portfolio before change:  [5.09197067]
curr_Stock_Price:  105.06578449684653
curr_Factors:  [105.0657845   -1.65348502  -1.01464308]
mat_Sqrt:  [[ 7.28967214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05518048  0.19628889 -0.28155222]
Stock Position:  0.05518047580097796
Bond Position:  [-0.70560931]


portfolio before change:  [5.08927553]
curr_Stock_Price:  105.01854077694247
curr_Factors:  [105.01854078  -1.87202753  -0.99497787]
mat_Sqrt:  [[ 5.97229646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0015005   0.00467097 -0.16495027]
Stock Position:  -0.0015005002789818885
Bond Position:  [5.24685588]


portfolio before change:  [5.09062876]
curr_Stock_Price:  104.5538118116789
curr_Factors:  [104.55381181  -1.87740482  -1.00586969]
mat_Sqrt:  [[ 5.84991639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00530145 -0.01572507 -0.33565523]
Stock Position:  0.005301446667202079
Bond Position:  [4.5363423]


portfolio before change:  [5.09027791]
curr_Stock_Price:  104.38066660790237
curr_Factors:  [104.38066661  -1.90514381  -0.98518999]
mat_Sqrt:  [[ 5.79914605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.27811983 -1.07699432  8.26121165]
Stock Position:  0.2781198349582587
Bond Position:  [-23.94005585]


portfolio before change:  [5.05717541]
curr_Stock_Price:  104.27240461649855
curr_Factors:  [104.27240462  -2.10613645  -0.96378247]
mat_Sqrt:  [[ 4.84083793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00926554 -0.03376901  0.18171287]
Stock Position:  0.009265543830758328
Bond Position:  [4.09103488]


portfolio before change:  [5.05492828]
curr_Stock_Price:  103.97468353265374
curr_Factors:  [103.97468353  -1.8368076   -0.95080599]
mat_Sqrt:  [[ 6.40150971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01592254 -0.03194791  0.09448708]
Stock Position:  0.015922544584407186
Bond Position:  [3.39938674]


portfolio before change:  [5.05074302]
curr_Stock_Price:  103.68514369749627
curr_Factors:  [103.6851437   -1.4549318   -0.95080599]
mat_Sqrt:  [[ 9.35228834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0250831  -0.0834468  -0.04842271]
Stock Position:  -0.025083098189075774
Bond Position:  [7.65148766]


portfolio before change:  [5.06479227]
curr_Stock_Price:  103.16316826816254
curr_Factors:  [103.16316827  -1.20541815  -0.95340786]
mat_Sqrt:  [[11.91128044  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05423692 -0.54727065 -0.57105592]
Stock Position:  -0.05423692090349362
Bond Position:  [10.66004487]


portfolio before change:  [5.02738326]
curr_Stock_Price:  103.87747130459184
curr_Factors:  [103.8774713   -1.31966583  -0.9924398 ]
mat_Sqrt:  [[10.28931947  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0041982  0.01842933 0.63996911]
Stock Position:  0.004198203539244147
Bond Position:  [4.5912845]


portfolio before change:  [5.0264691]
curr_Stock_Price:  103.52300869598338
curr_Factors:  [103.5230087   -1.06426689  -0.98676804]
mat_Sqrt:  [[13.31323918  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01993632 -0.13386137  0.80220136]
Stock Position:  0.01993632113500096
Bond Position:  [2.96260116]


portfolio before change:  [5.01877549]
curr_Stock_Price:  103.11852269074227
curr_Factors:  [103.11852269  -1.14229166  -1.01101264]
mat_Sqrt:  [[11.97204962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00495753 -0.00938473 -0.01978982]
Stock Position:  0.004957534457868034
Bond Position:  [4.50756186]


portfolio before change:  [5.01246596]
curr_Stock_Price:  101.73214628208842
curr_Factors:  [101.73214628  -1.15423341  -0.99593306]
mat_Sqrt:  [[11.84821088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01056148 -0.01722603 -0.03897926]
Stock Position:  0.010561481661206568
Bond Position:  [3.93802376]


portfolio before change:  [5.01753177]
curr_Stock_Price:  102.16518433759302
curr_Factors:  [102.16518434  -1.12060045  -0.99719548]
mat_Sqrt:  [[12.29011186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01302406 0.05392526 0.38419857]
Stock Position:  0.013024057903832655
Bond Position:  [3.68692649]


portfolio before change:  [5.01644897]
curr_Stock_Price:  102.04665785624117
curr_Factors:  [102.04665786  -1.31762899  -1.01523293]
mat_Sqrt:  [[ 9.90033132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00739441  0.00060577  0.11045132]
Stock Position:  -0.0073944131719369584
Bond Position:  [5.77102412]


portfolio before change:  [5.01663168]
curr_Stock_Price:  102.11951148664191
curr_Factors:  [102.11951149  -1.04230692  -1.03121888]
mat_Sqrt:  [[12.84067675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00354288 -0.05024451  0.15808895]
Stock Position:  -0.0035428771145095306
Bond Position:  [5.37842856]


portfolio before change:  [5.02053388]
curr_Stock_Price:  101.20786527683285
curr_Factors:  [101.20786528  -1.09968704  -0.98388475]
mat_Sqrt:  [[12.59883918  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00586464 -0.00228664  0.39726593]
Stock Position:  0.005864635573922455
Bond Position:  [4.42698663]


portfolio before change:  [5.02715248]
curr_Stock_Price:  102.24206287054598
curr_Factors:  [102.24206287  -1.15448872  -1.01982826]
mat_Sqrt:  [[11.62346828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03893999 -0.02714619  0.60600592]
Stock Position:  0.03893999491696754
Bond Position:  [1.04584707]


portfolio before change:  [5.00631783]
curr_Stock_Price:  101.70366040827753
curr_Factors:  [101.70366041  -1.13645268  -1.01447658]
mat_Sqrt:  [[11.83586154  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00017309 -0.03815585 -0.07443395]
Stock Position:  -0.0001730915701091257
Bond Position:  [5.02392187]


portfolio before change:  [5.00692823]
curr_Stock_Price:  101.80552067070957
curr_Factors:  [101.80552067  -1.04632439  -1.01765186]
mat_Sqrt:  [[12.92402623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170992 -0.02321455 -0.0028026 ]
Stock Position:  -0.0017099185671570394
Bond Position:  [5.18100738]


portfolio before change:  [5.00682287]
curr_Stock_Price:  102.24590530745671
curr_Factors:  [102.24590531  -0.80027957  -1.00483464]
mat_Sqrt:  [[16.81491923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00454784 0.00198621 0.27853355]
Stock Position:  0.004547837004027303
Bond Position:  [4.54182516]


portfolio before change:  [5.00394715]
curr_Stock_Price:  101.48873577024125
curr_Factors:  [101.48873577  -0.9583387   -1.03485291]
mat_Sqrt:  [[13.82883908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259384 -0.00804367 -0.1707441 ]
Stock Position:  -0.0025938402775830447
Bond Position:  [5.26719272]


portfolio before change:  [5.00602216]
curr_Stock_Price:  100.94260926737314
curr_Factors:  [100.94260927  -1.08802309  -1.03774707]
mat_Sqrt:  [[12.04659412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357968  0.00745481 -0.14128953]
Stock Position:  -0.0035796789768264975
Bond Position:  [5.36736429]


portfolio before change:  [5.00413048]
curr_Stock_Price:  101.65849531033787
curr_Factors:  [101.65849531  -1.02577388  -1.0441345 ]
mat_Sqrt:  [[12.82903198  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00736342 -0.01513581  0.05122113]
Stock Position:  -0.007363419302408868
Bond Position:  [5.7526846]


portfolio before change:  [5.00491461]
curr_Stock_Price:  101.64966731824968
curr_Factors:  [101.64966732  -0.67019636  -1.04884299]
mat_Sqrt:  [[18.2195086   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01411125 0.00688652 0.14352106]
Stock Position:  0.014111247189264849
Bond Position:  [3.57051103]


portfolio before change:  [4.9826363]
curr_Stock_Price:  100.03927449261201
curr_Factors:  [100.03927449  -0.80282951  -1.0447911 ]
mat_Sqrt:  [[15.76736415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202891 -0.00511736  0.0835955 ]
Stock Position:  -0.0020289090221053525
Bond Position:  [5.18560689]


portfolio before change:  [4.98537528]
curr_Stock_Price:  99.00879892393
curr_Factors:  [99.00879892 -0.96769155 -1.04219279]
mat_Sqrt:  [[13.26759216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01129068 -0.02240502 -0.23305255]
Stock Position:  -0.011290684152144915
Bond Position:  [6.10325236]


portfolio before change:  [4.99040518]
curr_Stock_Price:  98.63088199812348
curr_Factors:  [98.630882   -0.65130806 -1.02744939]
mat_Sqrt:  [[18.40508475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11406068 0.38346126 0.43076644]
Stock Position:  0.11406068107910196
Bond Position:  [-6.2595004]


portfolio before change:  [5.01061259]
curr_Stock_Price:  98.81490597959575
curr_Factors:  [98.81490598 -0.69484569 -1.04431855]
mat_Sqrt:  [[17.35853335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304187 -0.01747834 -0.03469666]
Stock Position:  -0.0030418741816742854
Bond Position:  [5.3111951]


portfolio before change:  [5.00793656]
curr_Stock_Price:  99.9129030671239
curr_Factors:  [99.91290307 -0.82404964 -1.07418172]
mat_Sqrt:  [[14.97028863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00088366 -0.00448382 -0.25118207]
Stock Position:  0.0008836552526669198
Bond Position:  [4.919648]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.00899075]
Stock Price:  100.40991493168323
PL:  [4.59907581]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.28716641e-03 -1.09461255e-01  4.28845744e-02]
 [ 6.63908759e-01  1.94847641e-01  1.78161421e-01]
 [-4.27182036e-01 -3.06741849e-01  4.22569139e-02]
 [ 2.11961001e-01  1.52699593e+00  1.34442340e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-1.76367531e-03  1.35319099e-01 -3.98287866e-02]
 [-1.13427883e-01  1.70943597e-01  4.88226484e-02]
 [-5.98671660e-02  1.15647790e-01  4.05506449e-03]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-1.52206104e-01 -8.19197524e-02 -5.15806671e-02]
 [ 7.81252258e-01  1.50630551e+00 -2.71418334e-01]
 [-4.65514281e-04  2.22666509e-02  1.02150649e-02]
 [-4.33814619e-01 -1.19369175e-02 -9.12720710e-01]
 [ 2.01121620e+00 -3.35711369e+00  2.84140918e+00]
 [ 2.38505558e-02 -5.02418675e-02 -4.91539106e-04]
 [ 2.75067878e-02  1.74449990e-01 -9.88766589e-02]
 [-2.55482593e-02  9.29298032e-02 -8.41072463e-02]
 [-2.85490385e-01 -1.83298221e+00 -1.95384935e-01]
 [ 1.60539487e-02 -5.14431135e-02  1.45981401e-01]
 [ 6.71689523e-02  1.96818042e-01  2.44187319e-01]
 [ 2.72590739e-02 -1.28182567e-02  2.20944137e-02]
 [ 9.04514746e-02 -4.76690421e-02  3.84557654e-02]
 [ 7.55776003e-02 -7.46095881e-02 -5.99281413e-02]
 [-1.69971774e-01  2.60597652e-02  4.72619559e-02]
 [ 1.22561442e-01  4.17544522e-03 -4.33914394e-02]
 [-1.23524607e-02 -5.25890012e-02  2.10523318e-01]
 [-1.95123408e-01 -1.22463260e-01 -6.12363042e-02]
 [-2.40399823e-01  1.83205815e-01  3.09397530e-01]
 [ 2.41486822e-01  1.75529251e-01  2.54621093e-01]
 [-1.35288719e-01  8.46546953e-02 -2.11637049e-01]
 [ 1.60972097e-01  2.52704632e-02  7.07641285e-02]
 [ 1.34781862e-01 -2.30637942e-03 -8.86989160e-02]
 [ 7.41385881e-02  9.27765467e-02  1.39809546e-01]
 [ 1.30426924e-03 -2.41949446e-02  3.70080794e-02]
 [-8.83781238e-02  8.78954727e-02  4.26440692e-02]
 [-8.57542391e-02 -4.87963039e-02 -4.97904594e-02]
 [ 2.01116036e+00  1.32776268e+00  1.62845856e-01]
 [ 2.21522186e-01 -3.12851491e-01  7.64171988e-02]
 [ 2.58539910e-02 -1.42332084e-02  1.73280411e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.98003243]
curr_Stock_Price:  99.53769486339395
curr_Factors:  [99.53769486 -1.02312691 -1.00820837]
mat_Sqrt:  [[13.05539077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094235 -0.03532847  0.12233775]
Stock Position:  -0.0009423495485700713
Bond Position:  [-0.88623313]


portfolio before change:  [-0.97978235]
curr_Stock_Price:  99.15474488226607
curr_Factors:  [99.15474488 -1.01271228 -0.99972492]
mat_Sqrt:  [[13.25327257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05583896 0.06288681 0.50824494]
Stock Position:  0.055838956875916834
Bond Position:  [-6.51647987]


portfolio before change:  [-1.01989977]
curr_Stock_Price:  98.45088482727924
curr_Factors:  [98.45088483 -1.0513025  -1.00143402]
mat_Sqrt:  [[12.63942971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03806895 -0.09900051  0.12054721]
Stock Position:  -0.03806894838923289
Bond Position:  [2.72802189]


portfolio before change:  [-1.04377129]
curr_Stock_Price:  99.08690309835033
curr_Factors:  [99.0869031  -1.05681174 -1.00487664]
mat_Sqrt:  [[12.60771456  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06330148 0.49283582 3.83526574]
Stock Position:  0.06330148202133959
Bond Position:  [-7.31611911]


portfolio before change:  [-1.02595495]
curr_Stock_Price:  99.38280311828163
curr_Factors:  [99.38280312 -1.01037829 -0.97585682]
mat_Sqrt:  [[13.63641765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430069 -0.01106097 -0.05874131]
Stock Position:  -0.004300689699559521
Bond Position:  [-0.59854035]


portfolio before change:  [-1.02301542]
curr_Stock_Price:  98.68190221543117
curr_Factors:  [98.68190222 -1.22032276 -0.97286356]
mat_Sqrt:  [[11.00902341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00161033  0.04367405 -0.11362044]
Stock Position:  0.0016103338578431013
Bond Position:  [-1.18192623]


portfolio before change:  [-1.02251839]
curr_Stock_Price:  99.08230146501398
curr_Factors:  [99.08230147 -1.19023397 -0.97991129]
mat_Sqrt:  [[11.31133783  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00606191  0.05517181  0.13927743]
Stock Position:  -0.0060619077476924965
Bond Position:  [-0.42189062]


portfolio before change:  [-1.01681763]
curr_Stock_Price:  98.1331781425638
curr_Factors:  [98.13317814 -1.09745787 -0.96754852]
mat_Sqrt:  [[12.44500234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284716  0.03732516  0.01156797]
Stock Position:  -0.0028471608257783568
Bond Position:  [-0.73741669]


portfolio before change:  [-1.01763938]
curr_Stock_Price:  98.38942118978213
curr_Factors:  [98.38942119 -1.17451308 -0.93738339]
mat_Sqrt:  [[11.90593269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00436683  0.0064198  -0.11330016]
Stock Position:  0.0043668316217618
Bond Position:  [-1.44728942]


portfolio before change:  [-1.01205902]
curr_Stock_Price:  99.70874899439794
curr_Factors:  [99.70874899 -1.35215238 -0.95479907]
mat_Sqrt:  [[ 9.92743344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01807685 -0.02643949 -0.14714529]
Stock Position:  -0.01807685380336045
Bond Position:  [0.79036146]


portfolio before change:  [-1.0118335]
curr_Stock_Price:  99.70173886917568
curr_Factors:  [99.70173887 -1.378694   -0.94901118]
mat_Sqrt:  [[ 9.72284183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10627783  0.48615801 -0.77428096]
Stock Position:  0.10627783171240886
Bond Position:  [-11.60791812]


portfolio before change:  [-1.13478182]
curr_Stock_Price:  98.55853490222417
curr_Factors:  [98.5585349  -1.20553943 -0.94236863]
mat_Sqrt:  [[11.50454963  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00053586 0.00718653 0.02914074]
Stock Position:  0.000535856542128933
Bond Position:  [-1.18759505]


portfolio before change:  [-1.1351384]
curr_Stock_Price:  98.17014885915356
curr_Factors:  [98.17014886 -1.16502989 -0.95397778]
mat_Sqrt:  [[11.79522183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05278066 -0.00385262 -2.60373813]
Stock Position:  -0.0527806577822114
Bond Position:  [4.04634664]


portfolio before change:  [-1.13258789]
curr_Stock_Price:  98.13140956540688
curr_Factors:  [98.13140957 -1.27131475 -0.94581989]
mat_Sqrt:  [[10.68854766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.17831688 -1.08350378  8.1057495 ]
Stock Position:  0.17831687892179035
Bond Position:  [-18.63107456]


portfolio before change:  [-1.12024604]
curr_Stock_Price:  98.21368376459718
curr_Factors:  [98.21368376 -1.46913871 -0.94718591]
mat_Sqrt:  [[ 8.76547692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00153952 -0.01621549 -0.00140222]
Stock Position:  0.0015395217744395616
Bond Position:  [-1.27144814]


portfolio before change:  [-1.12114401]
curr_Stock_Price:  97.73364277580013
curr_Factors:  [97.73364278 -1.12723491 -0.95370412]
mat_Sqrt:  [[12.19842458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00351956  0.05630349 -0.28206759]
Stock Position:  0.0035195634529544446
Bond Position:  [-1.46512377]


portfolio before change:  [-1.11916274]
curr_Stock_Price:  98.34861333727774
curr_Factors:  [98.34861334 -1.09757816 -0.9596345 ]
mat_Sqrt:  [[12.56990902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188922  0.02999297 -0.23993456]
Stock Position:  -0.001889223090390602
Bond Position:  [-0.93336026]


portfolio before change:  [-1.1183871]
curr_Stock_Price:  97.87629602755575
curr_Factors:  [97.87629603 -0.96798045 -0.96248638]
mat_Sqrt:  [[14.19993759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04926283 -0.59159246 -0.55737883]
Stock Position:  -0.04926282878984758
Bond Position:  [3.70327611]


portfolio before change:  [-1.14418818]
curr_Stock_Price:  98.40943671500928
curr_Factors:  [98.40943672 -0.96435848 -0.97210736]
mat_Sqrt:  [[14.1918926   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00249096 -0.01660319  0.41644431]
Stock Position:  0.0024909641655799326
Bond Position:  [-1.38932256]


portfolio before change:  [-1.14591494]
curr_Stock_Price:  97.78594836539502
curr_Factors:  [97.78594837 -0.65859783 -0.9713888 ]
mat_Sqrt:  [[19.15941539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00820426 0.06352275 0.69659845]
Stock Position:  0.008204258401821402
Bond Position:  [-1.94817613]


portfolio before change:  [-1.14640264]
curr_Stock_Price:  97.75618768399177
curr_Factors:  [97.75618768 -0.77523751 -0.98647652]
mat_Sqrt:  [[16.78964741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00173634 -0.00413707  0.06302921]
Stock Position:  0.0017363414968851432
Bond Position:  [-1.31614077]


portfolio before change:  [-1.15038491]
curr_Stock_Price:  95.55746231271327
curr_Factors:  [95.55746231 -0.49612097 -0.9901039 ]
mat_Sqrt:  [[21.61749392  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00409718 -0.01538512  0.10970359]
Stock Position:  0.004097182714011645
Bond Position:  [-1.54190129]


portfolio before change:  [-1.14798042]
curr_Stock_Price:  96.19137107935408
curr_Factors:  [96.19137108 -0.26456513 -0.96913803]
mat_Sqrt:  [[28.01209827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171766 -0.02408014 -0.17095831]
Stock Position:  0.0017176578792657902
Bond Position:  [-1.31320429]


portfolio before change:  [-1.14886319]
curr_Stock_Price:  95.77300714457462
curr_Factors:  [95.77300714 -0.13920438 -0.96136337]
mat_Sqrt:  [[31.8619699   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00486489  0.00841075  0.13482521]
Stock Position:  -0.004864891946440282
Bond Position:  [-0.68293786]


portfolio before change:  [-1.14066707]
curr_Stock_Price:  94.0707100326357
curr_Factors:  [94.07071003 -0.16939595 -0.92561836]
mat_Sqrt:  [[31.46992792  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00364019  0.00134762 -0.1237837 ]
Stock Position:  0.003640189811706382
Bond Position:  [-1.48310231]


portfolio before change:  [-1.14720019]
curr_Stock_Price:  92.32692176073802
curr_Factors:  [92.32692176 -0.42146787 -0.92323786]
mat_Sqrt:  [[24.06190892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082644 -0.01697303  0.60056443]
Stock Position:  0.0008264409448183773
Bond Position:  [-1.22350294]


portfolio before change:  [-1.14703862]
curr_Stock_Price:  92.70748604945572
curr_Factors:  [92.70748605 -0.65748034 -0.90313239]
mat_Sqrt:  [[19.46925382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01194812 -0.03952485 -0.17469013]
Stock Position:  -0.01194811712258195
Bond Position:  [-0.03935872]


portfolio before change:  [-1.13822787]
curr_Stock_Price:  91.96965668698137
curr_Factors:  [91.96965669 -0.79771602 -0.89531487]
mat_Sqrt:  [[16.91884027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00826579  0.05912942  0.88262503]
Stock Position:  -0.008265790318717638
Bond Position:  [-0.37802597]


portfolio before change:  [-1.13652801]
curr_Stock_Price:  91.75828917937679
curr_Factors:  [91.75828918 -1.05180315 -0.87080043]
mat_Sqrt:  [[13.41742518  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02454203 0.05665182 0.72636311]
Stock Position:  0.024542033103115594
Bond Position:  [-3.38846298]


portfolio before change:  [-1.15791781]
curr_Stock_Price:  90.90399069979684
curr_Factors:  [90.9039907  -1.2256602  -0.85553109]
mat_Sqrt:  [[11.34313381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01421202  0.02732219 -0.60374159]
Stock Position:  -0.014212023424385241
Bond Position:  [0.13401183]


portfolio before change:  [-1.16218939]
curr_Stock_Price:  91.2057300865999
curr_Factors:  [91.20573009 -1.02786131 -0.86163402]
mat_Sqrt:  [[13.78557005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01309885 0.00815601 0.20187036]
Stock Position:  0.013098847247732954
Bond Position:  [-2.35687931]


portfolio before change:  [-1.1578273]
curr_Stock_Price:  91.56123571164036
curr_Factors:  [91.56123571 -0.80070428 -0.89138139]
mat_Sqrt:  [[16.8596353   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00689253 -0.00074438 -0.25303332]
Stock Position:  0.006892526550270901
Bond Position:  [-1.78891555]


portfolio before change:  [-1.15008031]
curr_Stock_Price:  92.7176507562034
curr_Factors:  [92.71765076 -1.00459005 -0.9296616 ]
mat_Sqrt:  [[13.40070361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00907527 0.0299435  0.39883772]
Stock Position:  0.00907527164549465
Bond Position:  [-1.99151818]


portfolio before change:  [-1.15605404]
curr_Stock_Price:  92.08684046117848
curr_Factors:  [92.08684046 -1.1737649  -0.90401286]
mat_Sqrt:  [[11.53002261  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00033996 -0.00780888  0.10557375]
Stock Position:  0.00033995938879167613
Bond Position:  [-1.18735982]


portfolio before change:  [-1.15638051]
curr_Stock_Price:  91.56313680790278
curr_Factors:  [91.56313681 -1.02173428 -0.92066496]
mat_Sqrt:  [[13.12645305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00470286  0.02836814  0.12165166]
Stock Position:  -0.0047028585022127695
Bond Position:  [-0.72577203]


portfolio before change:  [-1.15808714]
curr_Stock_Price:  91.90673846853215
curr_Factors:  [91.90673847 -1.26252423 -0.92633625]
mat_Sqrt:  [[10.29763094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0102818  -0.01574894 -0.14203832]
Stock Position:  -0.010281799622328702
Bond Position:  [-0.21312047]


portfolio before change:  [-1.15488807]
curr_Stock_Price:  91.59300805228783
curr_Factors:  [91.59300805 -1.16162398 -0.9023232 ]
mat_Sqrt:  [[11.62790436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.19912699 0.42853356 0.4645539 ]
Stock Position:  0.19912698634317225
Bond Position:  [-19.39352774]


portfolio before change:  [-1.17404481]
curr_Stock_Price:  91.508979259497
curr_Factors:  [91.50897926 -1.17032599 -0.88577643]
mat_Sqrt:  [[11.7087296   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01479753 -0.10097238  0.217997  ]
Stock Position:  0.014797526683543623
Bond Position:  [-2.52815138]


portfolio before change:  [-1.17488885]
curr_Stock_Price:  91.4732975555191
curr_Factors:  [91.47329756 -1.41344927 -0.87333334]
mat_Sqrt:  [[ 9.29302845  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00285006 -0.00459375  0.04943208]
Stock Position:  0.002850063491835288
Bond Position:  [-1.43559356]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.17410774]
Stock Price:  91.81033302073253
PL:  [-1.17410774]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.32800416e-02 -9.38054022e-02  6.88890755e-03]
 [ 4.49043479e-01  2.01085894e-01  1.18480200e-01]
 [-3.69337905e-01 -2.53497520e-01  4.05696830e-02]
 [ 1.08853161e-01  9.36242676e-01  7.13716859e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 1.74164723e-02  3.79026294e-02 -9.65204817e-03]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [-3.11741011e-02  2.28580413e-01 -3.71188627e-02]
 [ 2.05375442e-02  5.83083120e-02 -4.55530832e-02]
 [-3.46807177e-01 -5.27871895e-02 -1.43632800e-01]
 [ 6.38621625e-01  1.23854438e+00 -2.21054447e-01]
 [-2.38149186e-04  2.65642549e-02 -5.79965554e-02]
 [-2.66773124e-01 -2.06463498e-03 -5.36889956e-01]
 [ 1.78639105e+00 -3.29062539e+00  2.76773291e+00]
 [ 6.11928165e-03 -9.19079772e-02  3.55787374e-02]
 [ 1.28731106e-01 -9.67186835e-03 -2.91121861e-02]
 [-8.12727634e-02 -5.15566109e-02 -5.63159087e-02]
 [-2.68928908e-01 -1.75542231e+00 -2.01437031e-01]
 [-2.53242861e-03  3.62134595e-02  1.04833558e-01]
 [ 1.68748784e-01  8.18420382e-02  4.01270826e-01]
 [ 3.64937846e-02 -5.68890615e-02  1.02103153e-01]
 [ 1.07313743e-01 -5.00991933e-02  4.44782622e-03]
 [ 1.86068691e-01  5.90825792e-02  8.33477166e-02]
 [-6.31658317e-02 -5.11344665e-02  7.43744087e-02]
 [-1.37986695e-02 -1.44439571e-01  4.79370492e-02]
 [ 5.18839417e-02 -6.16441753e-03  1.63584076e-01]
 [ 3.01721156e-01 -8.41728088e-02  1.37666324e-01]
 [-2.72225147e-02 -2.76461683e-02  6.05337916e-02]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 3.16386375e-02  1.81220862e-02  1.08477178e-01]
 [-2.03763105e-02 -1.59404150e-02 -6.52590406e-02]
 [-1.32821739e-02  2.04012096e-02 -5.53575041e-02]
 [-1.08416185e-01 -3.83026983e-02  2.66517781e-02]
 [ 1.92379038e-01  6.91980641e-03  3.30696052e-02]
 [ 4.88348405e-02 -2.63077902e-02  3.12303554e-03]
 [-1.12702065e-01 -5.90289228e-02 -8.57527328e-02]
 [ 1.33257634e+00  8.89615191e-01  1.33785432e-01]
 [-5.80819260e-02  7.74241312e-03  1.47219771e-02]
 [ 3.15659835e-02 -1.50891477e-02 -4.92964047e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.04610084]
curr_Stock_Price:  99.81418425068159
curr_Factors:  [99.81418425 -1.06273925 -1.02347009]
mat_Sqrt:  [[12.39261775  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036003 -0.03027556  0.01965214]
Stock Position:  -0.0003600299527731404
Bond Position:  [1.08203694]


portfolio before change:  [1.04661675]
curr_Stock_Price:  98.75691382498104
curr_Factors:  [98.75691382 -0.96453452 -1.00714132]
mat_Sqrt:  [[13.74926783  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03740378 0.06490019 0.33799103]
Stock Position:  0.037403783283040476
Bond Position:  [-2.64726545]


portfolio before change:  [1.0560319]
curr_Stock_Price:  99.01747760808863
curr_Factors:  [99.01747761 -0.89977674 -1.00140691]
mat_Sqrt:  [[14.79238809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02790635 -0.08181597  0.11573401]
Stock Position:  -0.027906353922880083
Bond Position:  [3.81924867]


portfolio before change:  [0.99471456]
curr_Stock_Price:  101.23183982971219
curr_Factors:  [101.23183983  -1.02369243  -1.01784635]
mat_Sqrt:  [[13.14280611  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03390826 0.30217102 2.03603554]
Stock Position:  0.033908264164271555
Bond Position:  [-2.43788141]


portfolio before change:  [0.97662498]
curr_Stock_Price:  100.70734165544555
curr_Factors:  [100.70734166  -0.86357342  -1.00664855]
mat_Sqrt:  [[15.51793942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377924 -0.01106097 -0.05874131]
Stock Position:  -0.0037792389410047597
Bond Position:  [1.35722209]


portfolio before change:  [0.97776127]
curr_Stock_Price:  100.45156928132673
curr_Factors:  [100.45156928  -0.4879538   -0.99846602]
mat_Sqrt:  [[22.72023381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00102037  0.01223302 -0.02753461]
Stock Position:  0.001020372334389862
Bond Position:  [0.87526327]


portfolio before change:  [0.97695121]
curr_Stock_Price:  99.55045455045857
curr_Factors:  [99.55045455 -0.30620874 -0.99555249]
mat_Sqrt:  [[27.08292278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244768 -0.00251018 -0.21167328]
Stock Position:  -0.0024476797969270716
Bond Position:  [1.22061885]


portfolio before change:  [0.97520838]
curr_Stock_Price:  100.32482588284905
curr_Factors:  [100.32482588  -0.58498662  -1.01867582]
mat_Sqrt:  [[20.18118522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00039184  0.07377401 -0.10588978]
Stock Position:  0.00039184141518023744
Bond Position:  [0.93589696]


portfolio before change:  [0.97542683]
curr_Stock_Price:  100.58373837141954
curr_Factors:  [100.58373837  -0.80072647  -0.9984896 ]
mat_Sqrt:  [[16.63941922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139075  0.01881893 -0.12995027]
Stock Position:  0.001390745319613512
Bond Position:  [0.83554047]


portfolio before change:  [0.9777735]
curr_Stock_Price:  102.1959827736108
curr_Factors:  [102.19598277  -1.22996391  -0.9988775 ]
mat_Sqrt:  [[11.00171267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03516736 -0.01703699 -0.4097444 ]
Stock Position:  -0.03516736445442114
Bond Position:  [4.57173687]


portfolio before change:  [0.97480333]
curr_Stock_Price:  102.29669185641899
curr_Factors:  [102.29669186  -1.31129805  -1.00349573]
mat_Sqrt:  [[10.10553754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08374774  0.39973848 -0.63060681]
Stock Position:  0.08374773578635443
Bond Position:  [-7.59231299]


portfolio before change:  [0.94355545]
curr_Stock_Price:  101.93490558196237
curr_Factors:  [101.93490558  -1.05324776  -1.01417016]
mat_Sqrt:  [[12.89599128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051599  0.00857358 -0.16544803]
Stock Position:  -0.0005159929549649263
Bond Position:  [0.99615314]


portfolio before change:  [0.94421027]
curr_Stock_Price:  100.90719208962557
curr_Factors:  [100.90719209  -1.02186924  -1.03237427]
mat_Sqrt:  [[12.93527009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.91286356e-02 -6.66358074e-04 -1.53159760e+00]
Stock Position:  -0.02912863564415221
Bond Position:  [3.8834991]


portfolio before change:  [0.95890546]
curr_Stock_Price:  100.41936546915083
curr_Factors:  [100.41936547  -1.08489523  -1.07016124]
mat_Sqrt:  [[11.63826764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.14432183 -1.06204478  7.89557159]
Stock Position:  0.1443218289241455
Bond Position:  [-13.53380102]


portfolio before change:  [0.98044305]
curr_Stock_Price:  100.58032117823213
curr_Factors:  [100.58032118  -0.98124692  -1.04382297]
mat_Sqrt:  [[13.27505528  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040519 -0.02966317  0.10149623]
Stock Position:  -0.00040518673254269456
Bond Position:  [1.02119687]


portfolio before change:  [0.9806963]
curr_Stock_Price:  100.27037185577241
curr_Factors:  [100.27037186  -0.89035779  -1.03128349]
mat_Sqrt:  [[14.67622705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00823198 -0.00312158 -0.08304896]
Stock Position:  0.00823197566506565
Bond Position:  [0.15527304]


portfolio before change:  [0.98459996]
curr_Stock_Price:  100.74222101851689
curr_Factors:  [100.74222102  -0.88545843  -1.04212652]
mat_Sqrt:  [[14.65790887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00704685 -0.01663982 -0.16065361]
Stock Position:  -0.00704685437750374
Bond Position:  [1.69451572]


portfolio before change:  [0.97665843]
curr_Stock_Price:  101.89924144291354
curr_Factors:  [101.89924144  -0.96948569  -1.09451761]
mat_Sqrt:  [[12.93557411  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05166923 -0.56656011 -0.57464378]
Stock Position:  -0.05166922951059486
Bond Position:  [6.24171373]


portfolio before change:  [1.00080206]
curr_Stock_Price:  101.44706983075756
curr_Factors:  [101.44706983  -0.91027076  -1.07835394]
mat_Sqrt:  [[13.88643529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00189096 0.01168784 0.29906096]
Stock Position:  0.0018909585345129342
Bond Position:  [0.80896985]


portfolio before change:  [0.99858526]
curr_Stock_Price:  100.22127510225593
curr_Factors:  [100.2212751   -1.01609621  -1.07955165]
mat_Sqrt:  [[12.32626849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02169057 0.0264144  1.14471397]
Stock Position:  0.02169056962317095
Bond Position:  [-1.17527129]


portfolio before change:  [1.00223676]
curr_Stock_Price:  100.39639359841756
curr_Factors:  [100.3963936   -0.87745343  -1.0855398 ]
mat_Sqrt:  [[14.09941155  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00324291 -0.01836087  0.29127188]
Stock Position:  0.0032429064324672975
Bond Position:  [0.67666065]


portfolio before change:  [1.00131343]
curr_Stock_Price:  100.08558828597072
curr_Factors:  [100.08558829  -0.96973883  -1.10548124]
mat_Sqrt:  [[12.56362378  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00779991 -0.01616945  0.01268841]
Stock Position:  0.0077999149234366585
Bond Position:  [0.22065436]


portfolio before change:  [0.9988331]
curr_Stock_Price:  99.76405687463517
curr_Factors:  [99.76405687 -0.75643814 -1.11310189]
mat_Sqrt:  [[15.38307585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01398564 0.01906882 0.23776784]
Stock Position:  0.013985639503381445
Bond Position:  [-0.39643104]


portfolio before change:  [0.99788184]
curr_Stock_Price:  99.6995831774171
curr_Factors:  [99.69958318 -0.78414529 -1.11819174]
mat_Sqrt:  [[14.8771201   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00392697 -0.01650358  0.21216949]
Stock Position:  -0.0039269695964171195
Bond Position:  [1.38939907]


portfolio before change:  [0.99150052]
curr_Stock_Price:  101.36880922297114
curr_Factors:  [101.36880922  -0.80996937  -1.11001856]
mat_Sqrt:  [[14.86155257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225395 -0.04661767  0.13675106]
Stock Position:  -0.0022539478410429385
Bond Position:  [1.21998053]


portfolio before change:  [0.99256201]
curr_Stock_Price:  100.96552386072528
curr_Factors:  [100.96552386  -0.67772761  -1.14079545]
mat_Sqrt:  [[16.3831939   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00512825 -0.00198956  0.46665984]
Stock Position:  0.005128248826000728
Bond Position:  [0.47478568]


portfolio before change:  [0.99697732]
curr_Stock_Price:  101.8149281898069
curr_Factors:  [101.81492819  -0.77126128  -1.12673473]
mat_Sqrt:  [[15.25886622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0204891  -0.02716666  0.3927237 ]
Stock Position:  0.020489102519965732
Bond Position:  [-1.08911918]


portfolio before change:  [0.99893246]
curr_Stock_Price:  101.91699658198976
curr_Factors:  [101.91699658  -0.92669971  -1.11113989]
mat_Sqrt:  [[13.28079664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154429 -0.00892276  0.17268606]
Stock Position:  -0.001544286631687585
Bond Position:  [1.15632152]


portfolio before change:  [0.99928739]
curr_Stock_Price:  101.78076697810295
curr_Factors:  [101.78076698  -0.88602936  -1.11498644]
mat_Sqrt:  [[13.76054388  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00160597 -0.02321455 -0.0028026 ]
Stock Position:  -0.0016059708547885062
Bond Position:  [1.16274433]


portfolio before change:  [0.99907548]
curr_Stock_Price:  102.00322395243359
curr_Factors:  [102.00322395  -0.73439534  -1.11630829]
mat_Sqrt:  [[16.02741657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00358639 0.00584888 0.30945519]
Stock Position:  0.0035863923465546906
Bond Position:  [0.6332519]


portfolio before change:  [0.99578457]
curr_Stock_Price:  101.06354179437898
curr_Factors:  [101.06354179  -0.88908138  -1.10285006]
mat_Sqrt:  [[13.78826688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267989 -0.00514475 -0.18616588]
Stock Position:  -0.0026798930073092886
Bond Position:  [1.26662405]


portfolio before change:  [0.99905101]
curr_Stock_Price:  99.90375777781779
curr_Factors:  [99.90375778 -0.72753667 -1.11995207]
mat_Sqrt:  [[15.74808169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129651  0.00658446 -0.15791955]
Stock Position:  -0.001296513319778592
Bond Position:  [1.12857756]


portfolio before change:  [0.99744518]
curr_Stock_Price:  101.25114616358984
curr_Factors:  [101.25114616  -0.55016396  -1.13586531]
mat_Sqrt:  [[18.75714518  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00590678 -0.01236214  0.0760301 ]
Stock Position:  -0.005906784775039039
Bond Position:  [1.59551391]


portfolio before change:  [1.00386884]
curr_Stock_Price:  100.19740760598702
curr_Factors:  [100.19740761  -0.56206336  -1.14521142]
mat_Sqrt:  [[18.17173809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01103592 0.00223336 0.09433838]
Stock Position:  0.011035919714664236
Bond Position:  [-0.1019017]


portfolio before change:  [1.00302001]
curr_Stock_Price:  100.12164682100791
curr_Factors:  [100.12164682  -0.44816696  -1.17011025]
mat_Sqrt:  [[19.84810823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00222199 -0.0084908   0.00890915]
Stock Position:  0.0022219887056392764
Bond Position:  [0.78055085]


portfolio before change:  [1.00353361]
curr_Stock_Price:  100.30887460138617
curr_Factors:  [100.3088746   -0.11303074  -1.1698944 ]
mat_Sqrt:  [[27.8081469   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00511561 -0.0190515  -0.24462868]
Stock Position:  -0.005115605063955876
Bond Position:  [1.51667419]


portfolio before change:  [1.0081991]
curr_Stock_Price:  99.43392416754726
curr_Factors:  [99.43392417 -0.3209342  -1.17483659]
mat_Sqrt:  [[22.28073819  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06918429 0.28712207 0.3816526 ]
Stock Position:  0.06918429310547292
Bond Position:  [-5.87106665]


portfolio before change:  [0.93286159]
curr_Stock_Price:  98.35559288009787
curr_Factors:  [ 9.83555929e+01 -9.77021901e-02 -1.16908143e+00]
mat_Sqrt:  [[27.71034461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193056  0.00249885  0.0419977 ]
Stock Position:  -0.0019305570634987293
Bond Position:  [1.12274267]


portfolio before change:  [0.93880917]
curr_Stock_Price:  95.34753357557607
curr_Factors:  [95.34753358 -0.21108779 -1.18508299]
mat_Sqrt:  [[23.60261898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078056 -0.00487    -0.14062892]
Stock Position:  0.000780563277619299
Bond Position:  [0.86438439]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.93873636]
Stock Price:  95.11582056609026
PL:  [0.93873636]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-3.24520164e-02 -6.25564399e-02  2.36349680e-01]
 [ 4.97791786e-01  1.80811307e-01  1.16876625e-01]
 [-3.51333251e-01 -2.36924608e-01  4.00445129e-02]
 [ 2.81941593e-01  1.60794821e+00  1.71135664e+00]
 [-6.13821167e-02  2.72532119e-02  6.51872583e-02]
 [-6.79030073e-02  5.25509202e-01 -2.66260714e-01]
 [-2.15185256e-01  2.97934775e-01  4.20227936e-01]
 [-1.92492917e-02  3.10288060e-02  3.83543009e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 6.71150705e-01  1.48451351e+00 -1.85956085e-01]
 [-1.68259125e-03 -1.89944802e-02  2.07648344e-01]
 [-4.90044722e-01 -5.91115990e-02 -1.17995844e+00]
 [ 1.98433021e+00 -3.15024212e+00  2.67044902e+00]
 [ 3.02333437e-02 -8.91087938e-02  2.44917648e-02]
 [ 7.82198556e-02  8.34429438e-02 -6.13315954e-02]
 [-2.72583731e-02  7.74090020e-02 -8.46419330e-02]
 [-2.85736108e-01 -1.83540502e+00 -1.95754644e-01]
 [ 2.22475555e-02 -2.55707886e-02  1.89583935e-02]
 [ 1.21281658e-01  1.49066239e-01  3.04527778e-01]
 [ 3.80512899e-02 -5.29365070e-02  1.15953259e-01]
 [ 1.10415898e-01 -5.05493234e-02  6.51179613e-03]
 [ 4.01167066e-01  1.40504284e-02  1.18159353e-01]
 [-5.74416373e-02 -5.58642510e-02  8.04117150e-02]
 [ 6.91104472e-02 -3.29724463e-02 -1.14239113e-02]
 [ 5.01871968e-02 -9.23471001e-03  2.77933710e-01]
 [-1.65486236e-01 -1.28741121e-01 -6.07489835e-02]
 [-1.34417807e-01  9.71667888e-02  2.00988531e-01]
 [ 2.93176866e-02 -3.73042209e-02  6.20301190e-02]
 [-4.42732149e-02  8.56336741e-02  1.74082903e-02]
 [ 3.54319075e-02 -1.42139155e-02 -7.69566687e-02]
 [ 1.98592080e-02  1.66710712e-02 -6.32377595e-02]
 [-4.12336781e-02 -2.02281757e-02  3.27830480e-02]
 [-7.18837786e-02 -1.31168142e-02 -4.76548488e-03]
 [-9.67687220e-02  7.39590801e-02  3.57738785e-02]
 [-1.03258148e-01 -5.84138144e-02 -6.65574967e-02]
 [ 1.66001375e+00  1.07757989e+00  1.43234847e-01]
 [ 1.50295036e-01 -2.46667965e-01  7.85929033e-02]
 [ 2.75890849e-02 -1.53972761e-02  5.75407583e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.03688072]
curr_Stock_Price:  99.66639885427536
curr_Factors:  [99.66639885 -0.64402477 -1.01672142]
mat_Sqrt:  [[18.93633208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.59660290e-04 -2.01900042e-02  6.74239851e-01]
Stock Position:  0.00015966029021180844
Bond Position:  [-0.05279349]


portfolio before change:  [-0.03697587]
curr_Stock_Price:  99.11182255836496
curr_Factors:  [99.11182256 -0.70875622 -1.0345497 ]
mat_Sqrt:  [[17.33873154  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03221441 0.0583566  0.33341648]
Stock Position:  0.03221441427717822
Bond Position:  [-3.22980518]


portfolio before change:  [-0.03195893]
curr_Stock_Price:  99.28009139301001
curr_Factors:  [99.28009139 -0.63647449 -1.05120985]
mat_Sqrt:  [[18.36158512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02132284 -0.07646709  0.11423585]
Stock Position:  -0.02132284491868568
Bond Position:  [2.08497506]


portfolio before change:  [0.00448776]
curr_Stock_Price:  97.58303557643809
curr_Factors:  [97.58303558 -0.56314383 -1.05918156]
mat_Sqrt:  [[19.26670106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04980053 0.51896305 4.88202415]
Stock Position:  0.04980052657216572
Bond Position:  [-4.85519879]


portfolio before change:  [-0.04420338]
curr_Stock_Price:  96.61749948526425
curr_Factors:  [96.61749949 -0.57760186 -1.04889735]
mat_Sqrt:  [[18.9966124   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223791  0.00879594  0.1859611 ]
Stock Position:  -0.002237913996337139
Bond Position:  [0.17201827]


portfolio before change:  [-0.04317194]
curr_Stock_Price:  96.16621201309127
curr_Factors:  [96.16621201 -0.79403846 -1.07460799]
mat_Sqrt:  [[14.84156392  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00100961  0.16960737 -0.7595677 ]
Stock Position:  -0.0010096059416473014
Bond Position:  [0.05391804]


portfolio before change:  [-0.04322629]
curr_Stock_Price:  96.22672086514169
curr_Factors:  [96.22672087 -0.90905749 -1.07744152]
mat_Sqrt:  [[13.19988437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00519633  0.09615804  1.19879333]
Stock Position:  -0.005196326305352999
Bond Position:  [0.45679916]


portfolio before change:  [-0.04220611]
curr_Stock_Price:  96.04138346198881
curr_Factors:  [96.04138346 -0.73814988 -1.06633803]
mat_Sqrt:  [[15.8044456   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032184  0.0100145   0.10941414]
Stock Position:  -0.00032184136375102573
Bond Position:  [-0.01129602]


portfolio before change:  [-0.04213158]
curr_Stock_Price:  95.80544150934338
curr_Factors:  [95.80544151 -0.71335659 -1.03426957]
mat_Sqrt:  [[16.68805721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00311547  0.0064198  -0.11330016]
Stock Position:  0.0031154737005128466
Bond Position:  [-0.34061092]


portfolio before change:  [-0.04131541]
curr_Stock_Price:  96.08108391620087
curr_Factors:  [96.08108392 -0.86986102 -1.04571953]
mat_Sqrt:  [[14.14854674  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [6.17780231e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  6.177802307459892e-05
Bond Position:  [-0.04725111]


portfolio before change:  [-0.04133169]
curr_Stock_Price:  95.91320353248896
curr_Factors:  [95.91320353 -0.76996095 -1.04083799]
mat_Sqrt:  [[15.68405689  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05969231  0.47912467 -0.53048095]
Stock Position:  0.05969231276715309
Bond Position:  [-5.76661263]


portfolio before change:  [-0.0859786]
curr_Stock_Price:  95.17732923215831
curr_Factors:  [95.17732923 -0.7451663  -1.00609465]
mat_Sqrt:  [[16.51849779  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00222939 -0.00613044  0.59236293]
Stock Position:  0.002229392644173222
Bond Position:  [-0.29816623]


portfolio before change:  [-0.08528315]
curr_Stock_Price:  95.5059933008414
curr_Factors:  [95.5059933  -0.74368066 -0.97377385]
mat_Sqrt:  [[17.14547851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04333322 -0.01907819 -3.366093  ]
Stock Position:  -0.04333322250398749
Bond Position:  [4.05329931]


portfolio before change:  [-0.17542744]
curr_Stock_Price:  97.5979444688827
curr_Factors:  [97.59794447 -0.87409782 -0.96947571]
mat_Sqrt:  [[15.44496251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12213645 -1.01673627  7.61804775]
Stock Position:  0.12213644783166897
Bond Position:  [-12.09569369]


portfolio before change:  [-0.06034698]
curr_Stock_Price:  98.55255315392343
curr_Factors:  [98.55255315 -0.89126853 -0.96397232]
mat_Sqrt:  [[15.41512376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00110563 -0.02875974  0.06986819]
Stock Position:  0.0011056315935832198
Bond Position:  [-0.1693098]


portfolio before change:  [-0.05981001]
curr_Stock_Price:  99.05736162742646
curr_Factors:  [99.05736163 -1.0669246  -0.96059314]
mat_Sqrt:  [[13.04208398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00634357  0.02693109 -0.17496197]
Stock Position:  0.006343565633165054
Bond Position:  [-0.68818689]


portfolio before change:  [-0.06380531]
curr_Stock_Price:  98.44110405650461
curr_Factors:  [98.44110406 -1.1909077  -0.97802986]
mat_Sqrt:  [[11.2517186   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255381  0.02498365 -0.24145988]
Stock Position:  -0.002553813331182552
Bond Position:  [0.18759489]


portfolio before change:  [-0.06245399]
curr_Stock_Price:  97.92114536893118
curr_Factors:  [97.92114537 -0.90267775 -0.96788522]
mat_Sqrt:  [[15.08347157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04643128 -0.59237442 -0.55843351]
Stock Position:  -0.04643127645778586
Bond Position:  [4.48414979]


portfolio before change:  [-0.04071796]
curr_Stock_Price:  97.46508492613292
curr_Factors:  [97.46508493 -0.70792872 -0.97162855]
mat_Sqrt:  [[18.1729993   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114994 -0.00825294  0.05408302]
Stock Position:  0.0011499370934882544
Bond Position:  [-0.15279668]


portfolio before change:  [-0.0389986]
curr_Stock_Price:  98.97687201382718
curr_Factors:  [98.97687201 -0.73178906 -0.94950133]
mat_Sqrt:  [[18.42292514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01160897 0.04811092 0.86873299]
Stock Position:  0.01160896805956891
Bond Position:  [-1.18801795]


portfolio before change:  [-0.0282447]
curr_Stock_Price:  99.91600954695217
curr_Factors:  [99.91600955 -0.55439584 -0.95687517]
mat_Sqrt:  [[22.04440692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00230963 -0.01708518  0.33078237]
Stock Position:  0.002309634850326104
Bond Position:  [-0.2590142]


portfolio before change:  [-0.02787268]
curr_Stock_Price:  100.09109984910673
curr_Factors:  [100.09109985  -0.47233136  -0.96896225]
mat_Sqrt:  [[23.6837026   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00428256 -0.01631472  0.01857634]
Stock Position:  0.004282555709960207
Bond Position:  [-0.45651839]


portfolio before change:  [-0.03124393]
curr_Stock_Price:  99.31722173562757
curr_Factors:  [99.31722174 -0.14695738 -0.96432761]
mat_Sqrt:  [[32.68884831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01309787 0.00453476 0.33707575]
Stock Position:  0.013097869667259364
Bond Position:  [-1.33208795]


portfolio before change:  [-0.042414]
curr_Stock_Price:  98.47711918455555
curr_Factors:  [98.47711918 -0.14348877 -0.93050029]
mat_Sqrt:  [[33.64401477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0015584  -0.01803011  0.22939224]
Stock Position:  -0.0015584022163556812
Bond Position:  [0.11105296]


portfolio before change:  [-0.04096894]
curr_Stock_Price:  97.55875676632961
curr_Factors:  [97.55875677 -0.4354707  -0.92742983]
mat_Sqrt:  [[24.96698362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024051  -0.01064181 -0.03258924]
Stock Position:  0.0024050994541879736
Bond Position:  [-0.27560745]


portfolio before change:  [-0.03763822]
curr_Stock_Price:  98.95793771702797
curr_Factors:  [98.95793772 -0.2563822  -0.89670518]
mat_Sqrt:  [[31.23713165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00336251 -0.00298049  0.79286751]
Stock Position:  0.0033625094548216596
Bond Position:  [-0.37038523]


portfolio before change:  [-0.04018271]
curr_Stock_Price:  98.21498501510628
curr_Factors:  [98.21498502 -0.45369681 -0.90922935]
mat_Sqrt:  [[25.1342796   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.008123   -0.04155102 -0.17329994]
Stock Position:  -0.00812299952919026
Bond Position:  [0.75761757]


portfolio before change:  [-0.04043599]
curr_Stock_Price:  98.25782516322174
curr_Factors:  [98.25782516 -0.46169261 -0.93170107]
mat_Sqrt:  [[24.39068308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00301579  0.03136045  0.57336433]
Stock Position:  -0.003015787107594284
Bond Position:  [0.25588869]


portfolio before change:  [-0.04198994]
curr_Stock_Price:  98.78370412039177
curr_Factors:  [98.78370412 -0.4062086  -0.9129435 ]
mat_Sqrt:  [[26.41099882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00130116 -0.01203989  0.17695466]
Stock Position:  0.001301156372714012
Bond Position:  [-0.17052299]


portfolio before change:  [-0.04108171]
curr_Stock_Price:  99.49810816645478
curr_Factors:  [99.49810817 -0.121775   -0.90265385]
mat_Sqrt:  [[35.71996516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00065061  0.02763815  0.04966101]
Stock Position:  -0.0006506126724911352
Bond Position:  [0.02365302]


portfolio before change:  [-0.04041755]
curr_Stock_Price:  98.48183578069197
curr_Factors:  [ 9.84818358e+01  6.30351465e-02 -9.18195396e-01]
mat_Sqrt:  [[41.87595824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040171 -0.00458752 -0.21953596]
Stock Position:  0.00040170519509530924
Bond Position:  [-0.07997822]


portfolio before change:  [-0.040058]
curr_Stock_Price:  99.40178358080558
curr_Factors:  [99.40178358  0.1263318  -0.90853715]
mat_Sqrt:  [[45.46599625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00022773  0.00538057 -0.18039973]
Stock Position:  0.0002277267278106322
Bond Position:  [-0.06269445]


portfolio before change:  [-0.04037895]
curr_Stock_Price:  98.0268628406217
curr_Factors:  [98.02686284  0.10353916 -0.92170505]
mat_Sqrt:  [[43.25339233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00089406 -0.00652862  0.09352091]
Stock Position:  -0.0008940553197815036
Bond Position:  [0.04726249]


portfolio before change:  [-0.04006576]
curr_Stock_Price:  97.68317637489712
curr_Factors:  [97.68317637 -0.19843743 -0.91605381]
mat_Sqrt:  [[32.04810658  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00235689 -0.00423343 -0.0135946 ]
Stock Position:  -0.002356893922471379
Bond Position:  [0.19016312]


portfolio before change:  [-0.03422519]
curr_Stock_Price:  95.21518362962404
curr_Factors:  [95.21518363 -0.35973432 -0.94030994]
mat_Sqrt:  [[25.94801628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028661   0.02387019  0.10205292]
Stock Position:  -0.002866098694255478
Bond Position:  [0.23867092]


portfolio before change:  [-0.03149209]
curr_Stock_Price:  94.27199584109137
curr_Factors:  [94.27199584 -0.21579526 -0.95570102]
mat_Sqrt:  [[29.21516421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00440757 -0.01885298 -0.18987001]
Stock Position:  -0.00440756757126049
Bond Position:  [0.3840181]


portfolio before change:  [-0.03318432]
curr_Stock_Price:  94.66682450790766
curr_Factors:  [94.66682451 -0.24576121 -0.99499621]
mat_Sqrt:  [[27.37434322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06974456 0.34778741 0.40860915]
Stock Position:  0.06974455973416116
Bond Position:  [-6.63568032]


portfolio before change:  [-0.21580651]
curr_Stock_Price:  92.06027460121301
curr_Factors:  [92.0602746  -0.36021698 -1.02158845]
mat_Sqrt:  [[23.11861385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00501703 -0.07961174  0.22420368]
Stock Position:  0.005017033383031062
Bond Position:  [-0.67767598]


portfolio before change:  [-0.22065164]
curr_Stock_Price:  91.1114225384695
curr_Factors:  [91.11142254 -0.31962695 -1.04547456]
mat_Sqrt:  [[23.26573472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00110122 -0.00496945  0.01641478]
Stock Position:  0.0011012192494628983
Bond Position:  [-0.3209853]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.22007908]
Stock Price:  91.66780016636326
PL:  [-0.22007908]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-3.61473331e-02 -5.28416437e-02  2.62105556e-01]
 [ 6.12344728e-01  1.88175426e-01  1.56512000e-01]
 [-3.88399134e-01 -2.71042989e-01  4.11256719e-02]
 [ 2.39209028e-01  1.64493255e+00  1.50386045e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 1.11447733e-02  8.56811335e-02 -1.90436853e-02]
 [-5.04515066e-02 -5.27353237e-03 -7.24768562e-02]
 [-6.19008518e-02  1.19884556e-01  2.33774497e-03]
 [ 3.84853883e-02  3.88858441e-02 -4.26023137e-02]
 [-5.03282463e-02 -1.86580250e-02  1.88376847e-02]
 [ 9.02859246e-01  1.74441432e+00 -3.11885698e-01]
 [-3.45682762e-04 -7.01821994e-02  7.02652347e-02]
 [-2.63856228e-01  1.42854297e-02 -6.16443726e-01]
 [ 1.59298649e+00 -2.74392912e+00  2.30533862e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.60334575e-01 -4.82227171e-02 -7.14177320e-03]
 [-1.97005498e-01 -3.07138478e-01 -2.04033699e-02]
 [-2.49192168e-01 -1.65483524e+00 -2.05702938e-01]
 [ 1.30094623e-03  3.72499194e-02  5.83893053e-02]
 [ 5.67769980e-01 -8.10107652e-01  3.05843402e-01]
 [ 8.58765040e-02  4.95264975e-01 -5.97123586e-01]
 [-6.39818118e-01 -5.21036696e-02 -3.38218289e-01]
 [ 7.99125081e-01  6.91258514e-01  6.50396290e-01]
 [ 6.70540126e-01  8.82697966e-02  2.78394720e-01]
 [-1.62459428e-01 -5.44928837e-01  1.85798467e-01]
 [ 3.44545955e-01 -1.44066421e-01 -4.38817892e-01]
 [ 1.07355682e+00  9.81990587e-02  7.58408029e-01]
 [-5.28947493e-02  4.23309019e-02  9.76380369e-02]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 8.13967784e-01 -3.44547805e-01 -2.78225960e-01]
 [ 2.11051722e-02 -1.45595691e-01  4.33832290e-02]
 [-2.80487351e-01 -7.92661141e-02  1.66465838e-01]
 [-3.98232657e-02  9.94966891e-02 -1.80525743e-01]
 [ 7.07713553e-01  1.53219227e-01  2.48931309e-01]
 [ 3.46712394e-01  5.00094230e-01 -3.07510986e-01]
 [-2.20526204e-01  9.58915562e-02 -8.87310136e-02]
 [ 2.51470808e+00  1.88604921e+00  2.12584227e-01]
 [-4.66651500e-02 -1.22688004e-01 -4.00063428e-03]
 [ 4.27984541e-02 -1.05694880e-02 -2.98927528e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.18618362]
curr_Stock_Price:  99.64602474195888
curr_Factors:  [99.64602474 -0.76783268 -1.00088002]
mat_Sqrt:  [[16.99486862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.86498080e-04 -1.70545672e-02  7.47714194e-01]
Stock Position:  0.0003864980801450897
Bond Position:  [-0.22469662]


portfolio before change:  [-0.18639176]
curr_Stock_Price:  99.18018451840368
curr_Factors:  [99.18018452 -0.89348862 -1.02773978]
mat_Sqrt:  [[14.522655    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04700957 0.06073336 0.44648517]
Stock Position:  0.047009569118595246
Bond Position:  [-4.8488095]


portfolio before change:  [-0.19723132]
curr_Stock_Price:  98.96249632695061
curr_Factors:  [98.96249633 -0.64395811 -1.0048949 ]
mat_Sqrt:  [[19.02755024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02287897 -0.08747875  0.11732009]
Stock Position:  -0.022878973089429402
Bond Position:  [2.06692897]


portfolio before change:  [-0.18698599]
curr_Stock_Price:  98.52598410305988
curr_Factors:  [98.5259841  -1.00293609 -1.00286632]
mat_Sqrt:  [[13.2568964   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06652792 0.5308997  4.29009526]
Stock Position:  0.0665279173542109
Bond Position:  [-6.74171452]


portfolio before change:  [-0.17417021]
curr_Stock_Price:  98.73128952330514
curr_Factors:  [98.73128952 -1.06178345 -1.01848666]
mat_Sqrt:  [[12.33118973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00475591 -0.01106097 -0.05874131]
Stock Position:  -0.004755907759309328
Bond Position:  [0.29538669]


portfolio before change:  [-0.17857473]
curr_Stock_Price:  99.66516918630977
curr_Factors:  [99.66516919 -0.90902782 -1.03988758]
mat_Sqrt:  [[14.19515714  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00174335  0.02765347 -0.05432633]
Stock Position:  0.0017433470565636157
Bond Position:  [-0.35232571]


portfolio before change:  [-0.17884275]
curr_Stock_Price:  99.53669936245375
curr_Factors:  [99.53669936 -0.69266303 -1.02449978]
mat_Sqrt:  [[17.87429422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371048 -0.00170203 -0.2067563 ]
Stock Position:  -0.003710481510522822
Bond Position:  [0.19048634]


portfolio before change:  [-0.178567]
curr_Stock_Price:  99.46880209804783
curr_Factors:  [99.4688021  -0.60466718 -1.02663761]
mat_Sqrt:  [[19.46346777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189855  0.03869257  0.00666894]
Stock Position:  -0.0018985480643074276
Bond Position:  [0.0102793]


portfolio before change:  [-0.1806526]
curr_Stock_Price:  100.5680028301331
curr_Factors:  [100.56800283  -0.32219188  -1.0514905 ]
mat_Sqrt:  [[25.46109932  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148174  0.01255035 -0.12153254]
Stock Position:  0.0014817414867452187
Bond Position:  [-0.32966838]


portfolio before change:  [-0.18041465]
curr_Stock_Price:  100.75640629706179
curr_Factors:  [100.7564063   -0.37938517  -1.05435553]
mat_Sqrt:  [[24.02188024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209357 -0.00602185  0.05373867]
Stock Position:  -0.0020935735652682676
Bond Position:  [0.0305263]


portfolio before change:  [-0.1812136]
curr_Stock_Price:  101.1398495579955
curr_Factors:  [101.13984956  -0.4238317   -1.03525832]
mat_Sqrt:  [[23.50972558  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05084164  0.5630073  -0.88972308]
Stock Position:  0.05084163672035906
Bond Position:  [-5.32332909]


portfolio before change:  [-0.21780727]
curr_Stock_Price:  100.43318050358907
curr_Factors:  [100.4331805  -0.2334071  -1.0420792]
mat_Sqrt:  [[28.05049659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.17193380e-05 -2.26512075e-02  2.00447157e-01]
Stock Position:  -1.1719338042523958e-05
Bond Position:  [-0.21663026]


portfolio before change:  [-0.2178235]
curr_Stock_Price:  99.50721265464243
curr_Factors:  [ 9.95072127e+01 -3.52287136e-02 -1.04175796e+00]
mat_Sqrt:  [[33.89418461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01141114  0.0046106  -1.75854237]
Stock Position:  -0.011411139701452754
Bond Position:  [0.91766721]


portfolio before change:  [-0.22762145]
curr_Stock_Price:  100.37589644863039
curr_Factors:  [ 1.00375896e+02  2.37104730e-02 -1.03407436e+00]
mat_Sqrt:  [[36.5455058   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04113938 -0.88559932  6.57648941]
Stock Position:  0.04113938342214223
Bond Position:  [-4.35702394]


portfolio before change:  [-0.22984739]
curr_Stock_Price:  100.33502857341321
curr_Factors:  [100.33502857   0.3533193   -1.05197993]
mat_Sqrt:  [[49.89167927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043433 -0.03053791  0.10625201]
Stock Position:  -0.00043432839299844406
Bond Position:  [-0.18626904]


portfolio before change:  [-0.23051062]
curr_Stock_Price:  101.80843761790408
curr_Factors:  [101.80843762   0.30244799  -1.07361273]
mat_Sqrt:  [[47.08376486  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316528 -0.01556382 -0.02037349]
Stock Position:  0.0031652809880711253
Bond Position:  [-0.55276293]


portfolio before change:  [-0.22464174]
curr_Stock_Price:  103.68440943955888
curr_Factors:  [103.68440944   0.13197513  -1.06129176]
mat_Sqrt:  [[40.93703395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00644562 -0.09912852 -0.05820514]
Stock Position:  -0.006445623236157381
Bond Position:  [0.44366889]


portfolio before change:  [-0.24845999]
curr_Stock_Price:  107.38827351990464
curr_Factors:  [ 1.07388274e+02 -1.07177181e-01 -1.06968703e+00]
mat_Sqrt:  [[33.1017709   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01900119 -0.53409578 -0.58681323]
Stock Position:  -0.01900118680110723
Bond Position:  [1.79204465]


portfolio before change:  [-0.24049493]
curr_Stock_Price:  106.98087552396733
curr_Factors:  [106.98087552  -0.19677224  -1.07451471]
mat_Sqrt:  [[30.0049728   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00069399 0.01202236 0.16656844]
Stock Position:  0.0006939923379749326
Bond Position:  [-0.31473884]


portfolio before change:  [-0.23793344]
curr_Stock_Price:  110.72852296131276
curr_Factors:  [ 1.10728523e+02 -9.14913243e-02 -1.10441381e+00]
mat_Sqrt:  [[33.48763711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01388087 -0.26146112  0.87248609]
Stock Position:  0.013880868018531048
Bond Position:  [-1.77494145]


portfolio before change:  [-0.21481081]
curr_Stock_Price:  112.41029862619031
curr_Factors:  [ 1.12410299e+02 -1.04445735e-01 -1.09315500e+00]
mat_Sqrt:  [[33.93866161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00191772  0.15984608 -1.70342738]
Stock Position:  0.001917715635634375
Bond Position:  [-0.4303818]


portfolio before change:  [-0.21453754]
curr_Stock_Price:  112.58085198825344
curr_Factors:  [112.58085199  -0.56176116  -1.08172463]
mat_Sqrt:  [[21.76244665  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03306118 -0.01681639 -0.96484264]
Stock Position:  -0.03306118404779821
Bond Position:  [3.50751873]


portfolio before change:  [-0.22674121]
curr_Stock_Price:  112.96323801527022
curr_Factors:  [112.96323802  -0.8099652   -1.08891728]
mat_Sqrt:  [[16.9146475   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06343551 0.22310273 1.85539958]
Stock Position:  0.06343550587560615
Bond Position:  [-7.39262136]


portfolio before change:  [-0.17159953]
curr_Stock_Price:  113.84706180199196
curr_Factors:  [113.8470618   -1.11856071  -1.10122708]
mat_Sqrt:  [[12.36745209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06026991 0.02848895 0.79418265]
Stock Position:  0.06026990861812467
Bond Position:  [-7.03315154]


portfolio before change:  [-0.15019869]
curr_Stock_Price:  114.21673280793662
curr_Factors:  [114.21673281  -1.09173532  -1.08213565]
mat_Sqrt:  [[12.9906107   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.018149   -0.17587503  0.53003131]
Stock Position:  -0.01814900109064698
Bond Position:  [1.92272091]


portfolio before change:  [-0.15808401]
curr_Stock_Price:  114.66445268513765
curr_Factors:  [114.66445269  -1.04009253  -1.07924278]
mat_Sqrt:  [[13.7725124   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01637793 -0.04649724 -1.2518253 ]
Stock Position:  0.01637792630245928
Bond Position:  [-2.03604996]


portfolio before change:  [-0.15942936]
curr_Stock_Price:  114.59784921822585
curr_Factors:  [114.59784922  -1.01198738  -1.07420942]
mat_Sqrt:  [[14.22829001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08774146 0.03169361 2.16352701]
Stock Position:  0.08774146481755933
Bond Position:  [-10.21441251]


portfolio before change:  [-0.29894189]
curr_Stock_Price:  113.02236095972091
curr_Factors:  [113.02236096  -0.8471602   -1.10736124]
mat_Sqrt:  [[16.0076102   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151951  0.01366224  0.27853414]
Stock Position:  -0.0015195090941149414
Bond Position:  [-0.12720338]


portfolio before change:  [-0.29975332]
curr_Stock_Price:  113.54590689384428
curr_Factors:  [113.54590689  -0.85840066  -1.08127338]
mat_Sqrt:  [[16.32231492  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210629 -0.02600141 -0.03673698]
Stock Position:  -0.0021062857743268213
Bond Position:  [-0.06059319]


portfolio before change:  [-0.29935572]
curr_Stock_Price:  113.35354476808038
curr_Factors:  [113.35354477  -0.86884073  -1.06408768]
mat_Sqrt:  [[16.40495205  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04186813 -0.11120233 -0.79370122]
Stock Position:  0.04186812732999384
Bond Position:  [-5.04525637]


portfolio before change:  [-0.32486073]
curr_Stock_Price:  112.75943386206013
curr_Factors:  [112.75943386  -0.52152675  -1.05930547]
mat_Sqrt:  [[23.20631482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.03911645e-05 -4.69908073e-02  1.23760277e-01]
Stock Position:  1.0391164504472623e-05
Bond Position:  [-0.32603243]


portfolio before change:  [-0.32492727]
curr_Stock_Price:  110.27807120308515
curr_Factors:  [110.2780712   -0.46612352  -1.06346573]
mat_Sqrt:  [[23.88894624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01099621 -0.02558303  0.4748807 ]
Stock Position:  -0.01099620631719269
Bond Position:  [0.88771315]


portfolio before change:  [-0.33526666]
curr_Stock_Price:  111.22843170380783
curr_Factors:  [111.2284317   -0.41086206  -1.06994804]
mat_Sqrt:  [[25.29928     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00222786  0.03211242 -0.5149897 ]
Stock Position:  -0.002227859928427664
Bond Position:  [-0.0874653]


portfolio before change:  [-0.3345603]
curr_Stock_Price:  110.90646640181113
curr_Factors:  [110.9064664   -0.20795462  -1.07749601]
mat_Sqrt:  [[30.66851534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02575287 0.04945129 0.71013174]
Stock Position:  0.0257528667043284
Bond Position:  [-3.19071975]


portfolio before change:  [-0.31207386]
curr_Stock_Price:  111.79511738175255
curr_Factors:  [111.79511738  -0.2033563   -1.08842485]
mat_Sqrt:  [[30.71916513  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0125662   0.16140472 -0.87724325]
Stock Position:  0.012566203619629422
Bond Position:  [-1.71691407]


portfolio before change:  [-0.30074985]
curr_Stock_Price:  112.71334494258922
curr_Factors:  [112.71334494  -0.22721076  -1.06870709]
mat_Sqrt:  [[30.84362165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00710243  0.03094887 -0.25312488]
Stock Position:  -0.0071024267764824974
Bond Position:  [0.49978843]


portfolio before change:  [-0.30969343]
curr_Stock_Price:  113.98136984823887
curr_Factors:  [113.98136985  -0.32811019  -1.08232076]
mat_Sqrt:  [[27.81579609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10580642 0.60871977 0.60644363]
Stock Position:  0.10580642127931592
Bond Position:  [-12.36965426]


portfolio before change:  [-0.37530458]
curr_Stock_Price:  113.37587873838687
curr_Factors:  [113.37587874  -0.73858202  -1.06728786]
mat_Sqrt:  [[18.63122215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389268 -0.03959738 -0.0114127 ]
Stock Position:  -0.0038926786134778615
Bond Position:  [0.06603128]


portfolio before change:  [-0.37182631]
curr_Stock_Price:  112.48445736459858
curr_Factors:  [112.48445736  -0.7449741   -1.05396978]
mat_Sqrt:  [[18.61320327  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109478 -0.00341129 -0.85275703]
Stock Position:  -0.001094779843578499
Bond Position:  [-0.24868059]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.36998609]
Stock Price:  110.77515937547976
PL:  [-11.14514546]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.13666692e-02 -9.83949676e-02  1.91398458e-02]
 [ 1.26374692e+00  2.54346810e-01  3.74835399e-01]
 [-2.17293021e-01 -1.13543344e-01  3.61347505e-02]
 [ 1.50243027e-01  1.00650796e+00  9.35467660e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 7.30182324e-02  1.40924693e-02  1.27837768e-02]
 [-3.21888650e-02 -1.19266517e-01  2.13006366e-03]
 [-2.93240028e-02  2.41713377e-01 -4.06701754e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 9.30225473e-01  1.88709090e+00 -2.98546141e-01]
 [-2.84144402e-03 -2.14725573e-01  4.03830506e-01]
 [-5.77926257e-01 -2.91277165e-02 -1.17470433e+00]
 [ 1.89615001e+00 -2.76392712e+00  2.34790558e+00]
 [ 2.59706143e-02 -7.49117657e-02  1.17158459e-02]
 [ 7.63586816e-02  1.12261125e-01 -8.12314011e-02]
 [ 3.27266437e-02  1.07714018e-01 -1.87009369e-02]
 [-2.95663653e-01 -1.88502805e+00 -1.93257753e-01]
 [ 3.70047191e-02 -8.25528351e-02  2.47319631e-02]
 [ 2.21933434e-02  2.21312505e-01  2.16097601e-01]
 [ 3.48974780e-02 -3.77603830e-02  8.90747184e-02]
 [ 7.53787986e-02 -4.53519776e-02  1.27107064e-02]
 [ 1.07777830e-01  2.35262768e-02  2.67987456e-02]
 [-2.82415695e-02 -7.58241007e-02  7.89701292e-02]
 [ 7.13561073e-02 -5.92305525e-02 -5.45073167e-03]
 [ 4.89758482e-02 -4.39296301e-03  2.02143527e-01]
 [-2.09124890e-01 -1.43408613e-01 -7.53223378e-02]
 [-1.94275799e-01  1.40187289e-01  2.74715396e-01]
 [ 1.89391998e-01  1.69901024e-01  3.08144846e-01]
 [-1.42746987e-01  9.59927580e-02 -1.58176649e-01]
 [ 1.60646424e-01  2.51208135e-02  7.02925243e-02]
 [ 1.08183116e-01 -8.78768790e-02  2.63333387e-02]
 [ 1.32104697e-01  1.25554044e-01  1.68550986e-01]
 [ 6.10971173e-03 -1.60670302e-02  5.18126537e-02]
 [-8.58073772e-02  6.68105787e-02  4.95738284e-02]
 [-7.92243207e-02 -4.52084448e-02 -4.35354346e-02]
 [ 3.06741563e+00  1.99271895e+00  2.04756595e-01]
 [ 2.21824339e-01 -3.14376930e-01  7.71082507e-02]
 [ 2.48606663e-02 -1.36381999e-02  2.04914758e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.57289146]
curr_Stock_Price:  100.02253254015423
curr_Factors:  [100.02253254  -0.99543778  -0.98492146]
mat_Sqrt:  [[13.80507457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034851 -0.03175684  0.05460065]
Stock Position:  -0.000348510594219498
Bond Position:  [2.60775037]


portfolio before change:  [2.57302498]
curr_Stock_Price:  100.5747962898584
curr_Factors:  [100.57479629  -1.07308411  -0.97308203]
mat_Sqrt:  [[12.99722083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10711353 0.08209008 1.06930106]
Stock Position:  0.1071135298855729
Bond Position:  [-8.19989647]


portfolio before change:  [2.54761954]
curr_Stock_Price:  100.34718373413982
curr_Factors:  [100.34718373  -0.8771656   -0.98150249]
mat_Sqrt:  [[15.64213011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01490168 -0.03664596  0.10308239]
Stock Position:  -0.01490167786423081
Bond Position:  [4.04296095]


portfolio before change:  [2.54674929]
curr_Stock_Price:  100.43949878797297
curr_Factors:  [100.43949879  -0.75941446  -0.99637285]
mat_Sqrt:  [[17.35304923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0315015  0.32484905 2.66862885]
Stock Position:  0.0315015034790447
Bond Position:  [-0.61724593]


portfolio before change:  [2.58187323]
curr_Stock_Price:  101.55694055263268
curr_Factors:  [101.55694055  -0.74833106  -1.0025604 ]
mat_Sqrt:  [[17.63222465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332607 -0.01106097 -0.05874131]
Stock Position:  -0.003326069291582877
Bond Position:  [2.91965865]


portfolio before change:  [2.57957356]
curr_Stock_Price:  102.35808230041161
curr_Factors:  [102.3580823   -0.81031731  -0.99741371]
mat_Sqrt:  [[16.78937514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00467583 0.00454832 0.03646856]
Stock Position:  0.004675833523242432
Bond Position:  [2.1009642]


portfolio before change:  [2.58266665]
curr_Stock_Price:  102.96341937082222
curr_Factors:  [102.96341937  -0.66087475  -0.97981088]
mat_Sqrt:  [[19.95915909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028107  -0.0384931   0.00607648]
Stock Position:  -0.00281070175328305
Bond Position:  [2.87206611]


portfolio before change:  [2.58908778]
curr_Stock_Price:  100.80662625814769
curr_Factors:  [100.80662626  -0.17862237  -0.94754566]
mat_Sqrt:  [[32.68891608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035834  0.07801266 -0.11602069]
Stock Position:  0.000358340690485042
Bond Position:  [2.55296466]


portfolio before change:  [2.58827733]
curr_Stock_Price:  97.65435481814325
curr_Factors:  [ 9.76543548e+01 -4.71976413e-02 -9.44507776e-01]
mat_Sqrt:  [[36.22425184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00143526  0.0064198  -0.11330016]
Stock Position:  0.0014352595484051316
Bond Position:  [2.44811799]


portfolio before change:  [2.58729333]
curr_Stock_Price:  96.75553929915401
curr_Factors:  [96.7555393   0.14695819 -0.93898153]
mat_Sqrt:  [[43.82323881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.99453366e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  1.9945336554644687e-05
Bond Position:  [2.58536351]


portfolio before change:  [2.58763248]
curr_Stock_Price:  97.55549388296053
curr_Factors:  [97.55549388 -0.13978987 -0.9066581 ]
mat_Sqrt:  [[34.25982614  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03661682  0.60905597 -0.85166904]
Stock Position:  0.03661681788612302
Bond Position:  [-0.98453927]


portfolio before change:  [2.51224855]
curr_Stock_Price:  95.50013067711104
curr_Factors:  [95.50013068 -0.09603087 -0.88118273]
mat_Sqrt:  [[35.94226903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.94913224e-04 -6.93023807e-02  1.15201603e+00]
Stock Position:  0.000994913224420651
Bond Position:  [2.4172342]


portfolio before change:  [2.51289024]
curr_Stock_Price:  95.84139021371439
curr_Factors:  [ 9.58413902e+01 -7.34937467e-02 -8.68927524e-01]
mat_Sqrt:  [[37.34777617  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02205372 -0.00940093 -3.35110449]
Stock Position:  -0.022053721266587088
Bond Position:  [4.62654955]


portfolio before change:  [2.50119016]
curr_Stock_Price:  96.39814156909809
curr_Factors:  [96.39814157 -0.13405967 -0.86251443]
mat_Sqrt:  [[35.58459522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05089927 -0.89205364  6.69792109]
Stock Position:  0.050899271431234926
Bond Position:  [-2.40540502]


portfolio before change:  [2.51178841]
curr_Stock_Price:  96.61226922844692
curr_Factors:  [96.61226923 -0.30365361 -0.87891622]
mat_Sqrt:  [[29.61070387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00044142 -0.02417767  0.03342205]
Stock Position:  0.0004414214941032356
Bond Position:  [2.46914167]


portfolio before change:  [2.51302413]
curr_Stock_Price:  98.7124437892648
curr_Factors:  [98.71244379 -0.31140084 -0.85162935]
mat_Sqrt:  [[30.85135964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00268036  0.03623212 -0.23173058]
Stock Position:  0.0026803550433568144
Bond Position:  [2.24843973]


portfolio before change:  [2.50778393]
curr_Stock_Price:  96.65254181136127
curr_Factors:  [96.65254181 -0.68633901 -0.83333224]
mat_Sqrt:  [[21.14601051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024069   0.03476455 -0.05334857]
Stock Position:  0.002406901421376449
Bond Position:  [2.27515079]


portfolio before change:  [2.50589862]
curr_Stock_Price:  95.75108181944626
curr_Factors:  [95.75108182 -0.49191566 -0.82941777]
mat_Sqrt:  [[25.54440973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02818198 -0.60839019 -0.55131058]
Stock Position:  -0.028181976922945096
Bond Position:  [5.2043534]


portfolio before change:  [2.53015958]
curr_Stock_Price:  94.9132989927908
curr_Factors:  [94.91329899 -0.66336153 -0.80583983]
mat_Sqrt:  [[21.84042203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115392 -0.02664381  0.07055341]
Stock Position:  0.0011539192353951305
Bond Position:  [2.4206373]


portfolio before change:  [2.53336106]
curr_Stock_Price:  97.42550094424621
curr_Factors:  [97.42550094 -0.56350056 -0.78512186]
mat_Sqrt:  [[25.29142927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00440779 0.0714283  0.6164663 ]
Stock Position:  0.004407789935172155
Bond Position:  [2.10392991]


portfolio before change:  [2.54139635]
curr_Stock_Price:  99.1888077530522
curr_Factors:  [99.18880775 -0.49328778 -0.73409097]
mat_Sqrt:  [[29.06824775  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00156088 -0.01218711  0.25410538]
Stock Position:  0.0015608774656852965
Bond Position:  [2.38657478]


portfolio before change:  [2.53880336]
curr_Stock_Price:  97.33643102416579
curr_Factors:  [97.33643102 -0.46784712 -0.70313933]
mat_Sqrt:  [[30.18022457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227685 -0.01463729  0.03626011]
Stock Position:  0.0022768527413015815
Bond Position:  [2.31718264]


portfolio before change:  [2.54348939]
curr_Stock_Price:  99.2673261180384
curr_Factors:  [99.26732612 -0.5416388  -0.70881361]
mat_Sqrt:  [[28.42770116  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00415265 0.00759307 0.07644936]
Stock Position:  0.00415265313613778
Bond Position:  [2.13126662]


portfolio before change:  [2.54333268]
curr_Stock_Price:  99.16543072779436
curr_Factors:  [99.16543073 -0.44524973 -0.68744866]
mat_Sqrt:  [[31.94740885  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008639  -0.02447212  0.2252798 ]
Stock Position:  -0.0008639007066266138
Bond Position:  [2.62900176]


portfolio before change:  [2.5450283]
curr_Stock_Price:  97.58310419187315
curr_Factors:  [97.58310419 -0.28827277 -0.65847797]
mat_Sqrt:  [[37.86221439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00153591 -0.01911658 -0.01554942]
Stock Position:  0.0015359137430637994
Bond Position:  [2.39514906]


portfolio before change:  [2.54886509]
curr_Stock_Price:  99.88621615195821
curr_Factors:  [99.88621615 -0.44185699 -0.67578491]
mat_Sqrt:  [[32.66779738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00273485 -0.00141782  0.57665922]
Stock Position:  0.002734849615159498
Bond Position:  [2.27569131]


portfolio before change:  [2.54392564]
curr_Stock_Price:  97.97608076748507
curr_Factors:  [97.97608077 -0.42535888 -0.65834547]
mat_Sqrt:  [[33.14921463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00765548 -0.04628493 -0.21487366]
Stock Position:  -0.0076554802803826425
Bond Position:  [3.29397959]


portfolio before change:  [2.56655698]
curr_Stock_Price:  95.07364149645974
curr_Factors:  [95.0736415  -0.34134842 -0.66388309]
mat_Sqrt:  [[34.79314059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314959  0.04524525  0.78368656]
Stock Position:  -0.003149590427847097
Bond Position:  [2.86600001]


portfolio before change:  [2.57624898]
curr_Stock_Price:  92.11016777242288
curr_Factors:  [92.11016777 -0.3475096  -0.64617974]
mat_Sqrt:  [[34.09995261  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00841563 0.05483532 0.87905147]
Stock Position:  0.008415633472732447
Bond Position:  [1.80108357]


portfolio before change:  [2.57581088]
curr_Stock_Price:  92.03135614888072
curr_Factors:  [92.03135615 -0.70773847 -0.65063074]
mat_Sqrt:  [[23.65939129  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00656992  0.03098153 -0.45123395]
Stock Position:  -0.00656991628084425
Bond Position:  [3.18044918]


portfolio before change:  [2.58152724]
curr_Stock_Price:  91.22179032189264
curr_Factors:  [91.22179032 -0.75930501 -0.63270405]
mat_Sqrt:  [[22.67549299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00794349 0.00810771 0.20052501]
Stock Position:  0.00794349167167275
Bond Position:  [1.8569077]


portfolio before change:  [2.5801969]
curr_Stock_Price:  91.02509242058036
curr_Factors:  [91.02509242 -0.98671121 -0.64223066]
mat_Sqrt:  [[17.85338883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00535588 -0.02836214  0.07512169]
Stock Position:  0.005355879163643144
Bond Position:  [2.0926775]


portfolio before change:  [2.57949361]
curr_Stock_Price:  90.84493761074557
curr_Factors:  [90.84493761 -0.84532362 -0.60120168]
mat_Sqrt:  [[21.38369619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00898529 0.04052239 0.48082905]
Stock Position:  0.0089852864319964
Bond Position:  [1.76322582]


portfolio before change:  [2.58312793]
curr_Stock_Price:  91.22488140774834
curr_Factors:  [91.22488141 -0.81034916 -0.58538921]
mat_Sqrt:  [[22.59185196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00059341 -0.00518561  0.14780708]
Stock Position:  0.0005934111370749226
Bond Position:  [2.52899407]


portfolio before change:  [2.58398821]
curr_Stock_Price:  92.14184817303425
curr_Factors:  [92.14184817 -0.95036786 -0.57669693]
mat_Sqrt:  [[20.01064597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310087  0.02156302  0.14142033]
Stock Position:  -0.0031008748891070423
Bond Position:  [2.86970856]


portfolio before change:  [2.58981045]
curr_Stock_Price:  90.37992550418394
curr_Factors:  [90.3799255  -0.86038886 -0.57081205]
mat_Sqrt:  [[21.60276404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00450586 -0.01459096 -0.12419448]
Stock Position:  -0.0045058627250146414
Bond Position:  [2.99704999]


portfolio before change:  [2.58900823]
curr_Stock_Price:  90.64111308772621
curr_Factors:  [90.64111309 -1.0016072  -0.56846624]
mat_Sqrt:  [[18.85606204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.18646382 0.64314728 0.58411357]
Stock Position:  0.18646382484905002
Bond Position:  [-14.3122804]


portfolio before change:  [2.72671597]
curr_Stock_Price:  91.38923075672476
curr_Factors:  [91.38923076 -1.23030151 -0.58962606]
mat_Sqrt:  [[14.80848128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01170897 -0.10146472  0.21996838]
Stock Position:  0.011708970656285886
Bond Position:  [1.65664214]


portfolio before change:  [2.72810118]
curr_Stock_Price:  91.48984790191815
curr_Factors:  [91.4898479  -1.35605109 -0.59584231]
mat_Sqrt:  [[12.99201079  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202121 -0.00440171  0.05845648]
Stock Position:  0.0020212102494801248
Bond Position:  [2.54318096]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.72907897]
Stock Price:  91.81632109042162
PL:  [2.72907897]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.68140283e-01 -1.08264540e-03 -2.48695479e-01]
 [ 1.55665456e+00  3.22637985e-01  5.06716989e-01]
 [ 1.26462305e-02  1.07993506e-01  3.43750193e-02]
 [ 9.25847913e-02  8.09694299e-01  6.09418488e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 7.49186253e-02  6.19233221e-02 -1.38807121e-02]
 [-3.21888650e-02 -1.19266517e-01  2.13006366e-03]
 [ 2.21766847e-01  4.46919671e-03 -2.17663130e-01]
 [ 2.05813999e-02  5.82608531e-02 -4.55458729e-02]
 [-5.78326572e-01  2.27188244e-01 -1.84998104e-01]
 [ 2.94273688e-01  6.16903060e-01 -9.32134231e-02]
 [-9.87844072e-06  2.16104203e-02 -5.84154136e-02]
 [ 8.96836338e-02 -2.40440793e-02  4.78878583e-02]
 [ 1.39862835e+00 -2.67415174e+00  2.25281492e+00]
 [-4.33573617e-03 -9.55093729e-02  3.96003936e-02]
 [ 1.71812640e-01 -1.15720458e-01  3.21839864e-02]
 [-2.94452605e-01 -5.15870996e-01  1.79216196e-02]
 [-2.51602358e-01 -1.66379190e+00 -2.03980285e-01]
 [ 8.21738847e-04  3.58996917e-02  6.64675955e-02]
 [ 2.78085514e-01 -4.28216963e-01  2.23754844e-01]
 [ 6.01269824e-02  1.58752795e-01 -9.62424129e-02]
 [ 3.61287007e-02 -5.38348659e-02 -7.78136415e-02]
 [ 4.22476009e-01  1.88379583e-01  2.54999919e-01]
 [-1.67311640e-01  2.41231383e-02  4.80455932e-02]
 [-3.11801468e-02 -1.93490038e-01  6.64169377e-02]
 [ 7.55114311e-02 -1.30255776e-02  6.78213613e-02]
 [ 2.01018416e-01 -6.64950028e-02  9.26834834e-02]
 [-7.59836065e-02  4.69974774e-02  1.24242961e-01]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 1.22088718e-02  4.79087206e-02  8.34819152e-02]
 [-2.86901434e-02 -7.09050400e-02 -2.76384343e-02]
 [ 1.10756839e-01  2.15632775e-02 -8.95181514e-02]
 [-1.18069121e-01 -3.87448071e-02  2.12500833e-02]
 [ 3.04530179e-01  2.95814955e-02  5.45173053e-02]
 [ 2.14372061e-01  2.42908889e-01 -1.70964545e-01]
 [ 1.86122526e-02  3.15708149e-02  6.95274674e-02]
 [ 2.09522791e+00  1.47934929e+00  1.85418400e-01]
 [-1.10012379e-01  3.94835691e-02 -1.48552096e-03]
 [ 3.90979845e-02 -1.20666556e-02 -2.04351403e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.38027966]
curr_Stock_Price:  100.95147962246477
curr_Factors:  [100.95147962  -1.34223924  -1.00552941]
mat_Sqrt:  [[ 9.64916467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.21414175e-02 -3.49422301e-04 -7.09458977e-01]
Stock Position:  0.012141417548284546
Bond Position:  [8.15458559]


portfolio before change:  [9.383523]
curr_Stock_Price:  101.13465052570344
curr_Factors:  [101.13465053  -1.20968474  -1.00142261]
mat_Sqrt:  [[11.08225799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.15573956 0.10413096 1.44552253]
Stock Position:  0.155739556023619
Bond Position:  [-6.36714257]


portfolio before change:  [9.40494559]
curr_Stock_Price:  101.27731519502268
curr_Factors:  [101.2773152   -1.16092978  -0.99556165]
mat_Sqrt:  [[11.72086999  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00355836 0.03485475 0.09806236]
Stock Position:  0.0035583607757430874
Bond Position:  [9.04456436]


portfolio before change:  [9.40725656]
curr_Stock_Price:  101.60902189500392
curr_Factors:  [101.6090219   -1.00088879  -1.00522128]
mat_Sqrt:  [[13.66752069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02796849 0.26132771 1.73850132]
Stock Position:  0.027968494406458367
Bond Position:  [6.5654052]


portfolio before change:  [9.43979244]
curr_Stock_Price:  102.7429815864129
curr_Factors:  [102.74298159  -0.96775851  -1.00164175]
mat_Sqrt:  [[14.33680896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00409059 -0.01106097 -0.05874131]
Stock Position:  -0.004090589552607508
Bond Position:  [9.8600718]


portfolio before change:  [9.43966994]
curr_Stock_Price:  103.0742490550012
curr_Factors:  [103.07424906  -0.97693843  -0.98107296]
mat_Sqrt:  [[14.54777707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00582393  0.01998567 -0.03959781]
Stock Position:  0.005823933208282396
Bond Position:  [8.8393724]


portfolio before change:  [9.44274008]
curr_Stock_Price:  103.41167488264794
curr_Factors:  [103.41167488  -1.14086806  -0.96190178]
mat_Sqrt:  [[12.62839713  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00444231 -0.0384931   0.00607648]
Stock Position:  -0.004442309096249112
Bond Position:  [9.9021267]


portfolio before change:  [9.44170171]
curr_Stock_Price:  103.92406778001316
curr_Factors:  [103.92406778  -1.04130422  -0.95867499]
mat_Sqrt:  [[14.06488559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01267332  0.00144243 -0.62093232]
Stock Position:  0.01267332154508746
Bond Position:  [8.12463859]


portfolio before change:  [9.45297656]
curr_Stock_Price:  104.7335799481235
curr_Factors:  [104.73357995  -0.92689864  -0.97871112]
mat_Sqrt:  [[15.57722694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148787  0.01880361 -0.1299297 ]
Stock Position:  0.0014878665133480672
Bond Position:  [9.29714698]


portfolio before change:  [9.45612813]
curr_Stock_Price:  106.07062488561593
curr_Factors:  [106.07062489  -0.94595883  -0.96754586]
mat_Sqrt:  [[15.65202737  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03639877  0.07332469 -0.5277481 ]
Stock Position:  -0.03639877006175987
Bond Position:  [13.31696841]


portfolio before change:  [9.45683764]
curr_Stock_Price:  106.09686784592752
curr_Factors:  [106.09686785  -0.8693833   -0.97670707]
mat_Sqrt:  [[16.74772048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02395379  0.19910461 -0.26591195]
Stock Position:  0.02395379050954283
Bond Position:  [6.91541549]


portfolio before change:  [9.44205499]
curr_Stock_Price:  105.44364630427826
curr_Factors:  [105.4436463   -0.95738279  -0.96910275]
mat_Sqrt:  [[15.35883855  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048979  0.00697473 -0.16664292]
Stock Position:  -0.000489793953314082
Bond Position:  [9.49370065]


portfolio before change:  [9.44313276]
curr_Stock_Price:  105.6662230881779
curr_Factors:  [105.66622309  -0.78469121  -0.98322428]
mat_Sqrt:  [[18.03600077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00524233 -0.00776019  0.13661073]
Stock Position:  0.005242333154732087
Bond Position:  [8.88919521]


portfolio before change:  [9.44259616]
curr_Stock_Price:  105.3518943630205
curr_Factors:  [105.35189436  -0.44310446  -1.00116952]
mat_Sqrt:  [[24.85433418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05281265 -0.86307876  6.42665391]
Stock Position:  0.05281265342141839
Bond Position:  [3.87868308]


portfolio before change:  [9.46409306]
curr_Stock_Price:  105.74975425905083
curr_Factors:  [105.74975426  -0.48893019  -1.02916631]
mat_Sqrt:  [[23.17279587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067959 -0.03082552  0.1129689 ]
Stock Position:  -0.0006795946788658889
Bond Position:  [9.53596003]


portfolio before change:  [9.46520085]
curr_Stock_Price:  105.87377303607926
curr_Factors:  [105.87377304  -0.27193296  -1.04893352]
mat_Sqrt:  [[28.25812667  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00547668 -0.03734862  0.09181195]
Stock Position:  0.005476683951956311
Bond Position:  [8.88536366]


portfolio before change:  [9.47026625]
curr_Stock_Price:  106.59586388342403
curr_Factors:  [106.59586388  -0.42783304  -1.04833159]
mat_Sqrt:  [[24.35848079  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01626112 -0.16649665  0.05112539]
Stock Position:  -0.01626111657079272
Bond Position:  [11.20363402]


portfolio before change:  [9.4822231]
curr_Stock_Price:  105.9466894150149
curr_Factors:  [105.94668942  -0.62472827  -1.03501465]
mat_Sqrt:  [[20.14977486  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03140778 -0.53698653 -0.58189898]
Stock Position:  -0.03140778313592273
Bond Position:  [12.80977374]


portfolio before change:  [9.5305176]
curr_Stock_Price:  104.46001399485036
curr_Factors:  [104.46001399  -0.68276787  -1.0368869 ]
mat_Sqrt:  [[18.71171098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00116063 0.01158658 0.18961355]
Stock Position:  0.0011606300382977584
Bond Position:  [9.40927817]


portfolio before change:  [9.53115921]
curr_Stock_Price:  103.99938599758114
curr_Factors:  [103.999386    -0.60637323  -1.04559542]
mat_Sqrt:  [[19.93379131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01185674 -0.13820643  0.63831029]
Stock Position:  0.011856743939262835
Bond Position:  [8.29806512]


portfolio before change:  [9.54130249]
curr_Stock_Price:  104.76738374840018
curr_Factors:  [104.76738375  -0.45235585  -1.07364882]
mat_Sqrt:  [[22.77669426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00320006  0.05123724 -0.27455282]
Stock Position:  0.0032000631855339783
Bond Position:  [9.20604024]


portfolio before change:  [9.53860787]
curr_Stock_Price:  103.56570551077627
curr_Factors:  [103.56570551  -0.42268456  -1.06509568]
mat_Sqrt:  [[23.39274684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00039568 -0.01737513 -0.22198066]
Stock Position:  0.00039568083767258763
Bond Position:  [9.4976289]


portfolio before change:  [9.53946531]
curr_Stock_Price:  102.73210730710382
curr_Factors:  [102.73210731  -0.35867412  -1.07251047]
mat_Sqrt:  [[24.5556044   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02089057 0.06079925 0.72744379]
Stock Position:  0.020890565873253133
Bond Position:  [7.39333345]


portfolio before change:  [9.50941208]
curr_Stock_Price:  101.24926323442826
curr_Factors:  [101.24926323  -0.6643972   -1.09305219]
mat_Sqrt:  [[17.46390243  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00873689  0.00778571  0.1370607 ]
Stock Position:  -0.008736893718002963
Bond Position:  [10.39401613]


portfolio before change:  [9.50478438]
curr_Stock_Price:  101.92765415316046
curr_Factors:  [101.92765415  -0.53948372  -1.1102033 ]
mat_Sqrt:  [[19.58132428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291701 -0.06244864  0.18946904]
Stock Position:  -0.002917005714694433
Bond Position:  [9.80210793]


portfolio before change:  [9.50582193]
curr_Stock_Price:  101.99203234708398
curr_Factors:  [101.99203235  -0.31522736  -1.0688301 ]
mat_Sqrt:  [[25.55510853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00339253 -0.00420399  0.19347547]
Stock Position:  0.0033925339616520463
Bond Position:  [9.1598105]


portfolio before change:  [9.50709537]
curr_Stock_Price:  102.02987606745735
curr_Factors:  [102.02987607  -0.40869687  -1.07538554]
mat_Sqrt:  [[23.13122093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00892145 -0.02146117  0.26440018]
Stock Position:  0.008921453706117384
Bond Position:  [8.59684055]


portfolio before change:  [9.50453243]
curr_Stock_Price:  101.62213883449097
curr_Factors:  [101.62213883  -0.3854933   -1.09414381]
mat_Sqrt:  [[23.141425    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177298  0.01516837  0.35443058]
Stock Position:  -0.00177298063785266
Bond Position:  [9.68470651]


portfolio before change:  [9.50508408]
curr_Stock_Price:  101.99383830925146
curr_Factors:  [101.99383831  -0.41664109  -1.08140059]
mat_Sqrt:  [[22.8025125   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096915 -0.02321455 -0.0028026 ]
Stock Position:  -0.0009691490104212204
Bond Position:  [9.60393131]


portfolio before change:  [9.50581428]
curr_Stock_Price:  102.47918093824013
curr_Factors:  [102.47918094  -0.27890461  -1.08650073]
mat_Sqrt:  [[26.1605964   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0014919  0.01546247 0.23815067]
Stock Position:  0.00149189538358716
Bond Position:  [9.35292606]


portfolio before change:  [9.51050307]
curr_Stock_Price:  104.83832978278807
curr_Factors:  [ 1.04838330e+02 -7.33866724e-02 -1.07768995e+00]
mat_Sqrt:  [[33.15994993  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00147181 -0.0228845  -0.07884476]
Stock Position:  -0.0014718130129156063
Bond Position:  [9.66480549]


portfolio before change:  [9.51388396]
curr_Stock_Price:  103.36211512434184
curr_Factors:  [ 1.03362115e+02 -5.29820846e-02 -1.07552462e+00]
mat_Sqrt:  [[33.43929797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00289736  0.00695952 -0.25537037]
Stock Position:  0.0028973577247425023
Bond Position:  [9.21440693]


portfolio before change:  [9.51485604]
curr_Stock_Price:  103.30006107116411
curr_Factors:  [103.30006107   0.34573981  -1.04968261]
mat_Sqrt:  [[51.09543578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238065 -0.01250483  0.06062057]
Stock Position:  -0.0023806473987763614
Bond Position:  [9.76077706]


portfolio before change:  [9.51581383]
curr_Stock_Price:  103.41027498685047
curr_Factors:  [103.41027499   0.12782779  -1.0425072 ]
mat_Sqrt:  [[41.43081456  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00776467 0.00954739 0.1555227 ]
Stock Position:  0.007764674159847398
Bond Position:  [8.71286674]


portfolio before change:  [9.53203358]
curr_Stock_Price:  105.35891788171217
curr_Factors:  [105.35891788   0.22980107  -1.0516038 ]
mat_Sqrt:  [[46.31982472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00494513  0.07839851 -0.48771426]
Stock Position:  0.004945131819111002
Bond Position:  [9.01101984]


portfolio before change:  [9.54109337]
curr_Stock_Price:  106.96319023865398
curr_Factors:  [106.96319024   0.38401804  -1.05164514]
mat_Sqrt:  [[54.86401458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00071538 0.01018944 0.19834251]
Stock Position:  0.0007153842716898949
Bond Position:  [9.46457358]


portfolio before change:  [9.54058273]
curr_Stock_Price:  104.59553869425662
curr_Factors:  [104.59553869   0.14989402  -1.03814709]
mat_Sqrt:  [[43.02786088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05659234 0.47745793 0.52894709]
Stock Position:  0.056592336774633434
Bond Position:  [3.62127678]


portfolio before change:  [9.66450995]
curr_Stock_Price:  106.77736281402542
curr_Factors:  [ 1.06777363e+02  3.10872304e-02 -1.06322089e+00]
mat_Sqrt:  [[38.03901288  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268819  0.01274327 -0.00423778]
Stock Position:  -0.0026881890934751817
Bond Position:  [9.95154769]


portfolio before change:  [9.66602684]
curr_Stock_Price:  106.67585683226639
curr_Factors:  [106.67585683   0.17154047  -1.06002502]
mat_Sqrt:  [[43.87349211  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.15745670e-04 -3.89449635e-03 -5.82957673e-01]
Stock Position:  -0.00011574567042993463
Bond Position:  [9.6783741]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.66729863]
Stock Price:  106.14087719229231
PL:  [3.52642144]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-3.00351182e-02 -6.89103402e-02  2.19504215e-01]
 [ 4.39565147e-01  1.94943160e-01  1.10597234e-01]
 [-2.98501308e-01 -1.88293896e-01  3.85034805e-02]
 [ 2.23143386e-01  1.46244811e+00  1.38868100e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 4.87088294e-03  1.13353101e-01 -3.22766227e-02]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [-6.29698976e-02  1.36052576e-01 -3.15911357e-03]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 7.76454254e-01  1.73469462e+00 -2.09914002e-01]
 [-2.68967697e-03 -2.55785684e-01  4.01683111e-01]
 [-3.75225173e-01  8.28528809e-03 -8.63696853e-01]
 [ 1.90195052e+00 -2.77302204e+00  2.35582183e+00]
 [ 2.23024060e-02 -7.80000686e-02  1.60417411e-02]
 [ 5.39420692e-02  1.63050008e-01 -1.05505052e-01]
 [ 4.20200505e-02  1.34029165e-01  5.99165509e-02]
 [-3.03815398e-01 -1.93682488e+00 -1.95199151e-01]
 [ 2.91279481e-02 -5.27945943e-02  2.33570045e-02]
 [ 5.77730108e-02  1.75499507e-01  2.20010399e-01]
 [ 2.88403557e-02 -3.06474370e-02  3.50782027e-02]
 [ 1.14462925e-01 -5.15344733e-02  4.18551292e-02]
 [ 7.01612779e-02 -7.26673651e-02 -5.66670910e-02]
 [-1.63739842e-01  2.15228031e-02  4.90977937e-02]
 [ 9.00413771e-02  7.88051210e-03 -2.99869893e-02]
 [ 1.65862368e-02 -4.75082928e-02  2.48613284e-01]
 [-2.06686215e-01 -1.40875470e-01 -7.49190642e-02]
 [-1.31556202e-01  1.07189528e-01  1.74938550e-01]
 [ 4.38509838e-02  1.10572194e-02  1.37322170e-01]
 [-1.29090689e-01  1.13632594e-01 -1.55426919e-02]
 [ 7.37205981e-02 -1.48223329e-02 -5.55837888e-02]
 [ 6.80962648e-03 -1.92080348e-03 -5.39440338e-02]
 [-2.46126833e-02  3.93048134e-02  9.68332639e-02]
 [ 4.57510865e-03 -4.80787415e-02 -1.33928125e-02]
 [-8.40295614e-02  1.61776177e-02  6.12265132e-02]
 [-1.05292864e-01 -5.95317877e-02 -6.85065562e-02]
 [ 2.01763683e+00  1.29787482e+00  1.56480455e-01]
 [ 8.31249403e-02 -1.67168238e-01  1.15301300e-02]
 [ 3.11140944e-02 -1.47477974e-02 -3.81515020e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.23160228]
curr_Stock_Price:  99.2304420410802
curr_Factors:  [99.23044204 -0.84616666 -0.96467836]
mat_Sqrt:  [[16.22575533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.34326671e-05 -2.22407166e-02  6.26184428e-01]
Stock Position:  4.343266706067905e-05
Bond Position:  [-3.23591212]


portfolio before change:  [-3.23202036]
curr_Stock_Price:  98.91793224195266
curr_Factors:  [98.91793224 -0.75533135 -0.98067983]
mat_Sqrt:  [[17.43150781  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0287946  0.06291763 0.31550313]
Stock Position:  0.028794601367860193
Bond Position:  [-6.08032279]


portfolio before change:  [-3.21449121]
curr_Stock_Price:  99.55309442544683
curr_Factors:  [99.55309443 -1.07882187 -1.00520195]
mat_Sqrt:  [[12.38724477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02656581 -0.06077159  0.10983971]
Stock Position:  -0.02656580658452196
Bond Position:  [-0.56978296]


portfolio before change:  [-3.19783916]
curr_Stock_Price:  98.92359046708309
curr_Factors:  [98.92359047 -0.84500147 -0.9823436 ]
mat_Sqrt:  [[15.91087231  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05060236 0.4720031  3.96152036]
Stock Position:  0.05060235932892651
Bond Position:  [-8.20360623]


portfolio before change:  [-3.1792469]
curr_Stock_Price:  99.31127538076375
curr_Factors:  [99.31127538 -0.76027182 -0.96573581]
mat_Sqrt:  [[17.67677238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331769 -0.01106097 -0.05874131]
Stock Position:  -0.0033176871701050825
Bond Position:  [-2.84976316]


portfolio before change:  [-3.18031128]
curr_Stock_Price:  99.52471846088814
curr_Factors:  [99.52471846 -0.86397176 -0.95467705]
mat_Sqrt:  [[16.14737064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00132657  0.03658456 -0.09207622]
Stock Position:  0.0013265658076537924
Bond Position:  [-3.31233737]


portfolio before change:  [-3.18033598]
curr_Stock_Price:  99.81823539653743
curr_Factors:  [99.8182354  -0.61595992 -1.00736485]
mat_Sqrt:  [[19.68833072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00336699 -0.00251018 -0.21167328]
Stock Position:  -0.0033669854431589174
Bond Position:  [-2.84424943]


portfolio before change:  [-3.180814]
curr_Stock_Price:  99.85460775339222
curr_Factors:  [99.85460775 -0.53470638 -1.01396265]
mat_Sqrt:  [[21.22216542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168895  0.04391078 -0.00901207]
Stock Position:  -0.0016889479687182548
Bond Position:  [-3.01216476]


portfolio before change:  [-3.17934128]
curr_Stock_Price:  98.75968605442456
curr_Factors:  [98.75968605 -0.17672217 -1.00569901]
mat_Sqrt:  [[30.27336578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171739  0.0064198  -0.11330016]
Stock Position:  0.001717390914766829
Bond Position:  [-3.34895026]


portfolio before change:  [-3.18088357]
curr_Stock_Price:  98.10540966271861
curr_Factors:  [ 9.81054097e+01 -3.10945536e-02 -9.93858404e-01]
mat_Sqrt:  [[35.20153015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.48304333e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  2.483043331924347e-05
Bond Position:  [-3.18331957]


portfolio before change:  [-3.18135482]
curr_Stock_Price:  95.15280741086475
curr_Factors:  [ 9.51528074e+01 -1.66713108e-02 -9.83816362e-01]
mat_Sqrt:  [[34.98769492  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03108804  0.55987028 -0.59882622]
Stock Position:  0.03108803814345739
Bond Position:  [-6.13946893]


portfolio before change:  [-3.12051001]
curr_Stock_Price:  97.13467251993156
curr_Factors:  [97.13467252  0.15579259 -0.97938527]
mat_Sqrt:  [[42.62776117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.35536792e-04 -8.25544745e-02  1.14589011e+00]
Stock Position:  0.0006355367918090738
Bond Position:  [-3.18224267]


portfolio before change:  [-3.12014125]
curr_Stock_Price:  98.34083767310945
curr_Factors:  [98.34083767  0.12078791 -0.9591889 ]
mat_Sqrt:  [[42.52271452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01293039  0.00267407 -2.46388672]
Stock Position:  -0.012930391066486576
Bond Position:  [-1.84855576]


portfolio before change:  [-3.09941244]
curr_Stock_Price:  96.71985849150468
curr_Factors:  [96.71985849 -0.13981162 -0.9652763 ]
mat_Sqrt:  [[32.03185303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05671823 -0.89498901  6.72050393]
Stock Position:  0.056718226041971596
Bond Position:  [-8.58519124]


portfolio before change:  [-3.11319983]
curr_Stock_Price:  96.49569473866147
curr_Factors:  [ 9.64956947e+01 -7.81160239e-02 -9.84054395e-01]
mat_Sqrt:  [[33.35901247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028943 -0.02517441  0.04576262]
Stock Position:  0.0002894334874346153
Bond Position:  [-3.14112891]


portfolio before change:  [-3.11320854]
curr_Stock_Price:  97.82226474432761
curr_Factors:  [97.82226474 -0.39149452 -0.97420352]
mat_Sqrt:  [[24.96448382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00263127  0.05262416 -0.30097655]
Stock Position:  0.0026312734788324307
Bond Position:  [-3.37060567]


portfolio before change:  [-3.11656735]
curr_Stock_Price:  96.70589951252899
curr_Factors:  [96.70589951 -0.21226971 -0.96958146]
mat_Sqrt:  [[29.66070901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00275142 0.04325773 0.17092524]
Stock Position:  0.002751419531421644
Bond Position:  [-3.38264585]


portfolio before change:  [-3.12191466]
curr_Stock_Price:  94.91611514459161
curr_Factors:  [94.91611514 -0.19747252 -0.96916236]
mat_Sqrt:  [[29.55812366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02500203 -0.62510754 -0.55684885]
Stock Position:  -0.025002026143436242
Bond Position:  [-0.74881946]


portfolio before change:  [-3.16035323]
curr_Stock_Price:  96.44978946961287
curr_Factors:  [96.44978947 -0.31604906 -0.96280928]
mat_Sqrt:  [[26.84727216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00086113 -0.01703938  0.06663103]
Stock Position:  0.0008611312565013754
Bond Position:  [-3.24340916]


portfolio before change:  [-3.15961042]
curr_Stock_Price:  97.78322637436345
curr_Factors:  [97.78322637 -0.56647212 -0.96051255]
mat_Sqrt:  [[21.23749781  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00652177 0.05664222 0.62762843]
Stock Position:  0.006521772647875561
Bond Position:  [-3.79733039]


portfolio before change:  [-3.15647725]
curr_Stock_Price:  98.33642980687743
curr_Factors:  [98.33642981 -0.66227275 -0.97644898]
mat_Sqrt:  [[19.09970387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155734 -0.00989142  0.10006835]
Stock Position:  0.0015573425710310727
Bond Position:  [-3.30962075]


portfolio before change:  [-3.15835036]
curr_Stock_Price:  97.39933123120602
curr_Factors:  [97.39933123 -0.52714355 -0.9846221 ]
mat_Sqrt:  [[21.47852709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00523719 -0.01663268  0.11940103]
Stock Position:  0.0052371904455044685
Bond Position:  [-3.66844921]


portfolio before change:  [-3.16326514]
curr_Stock_Price:  96.54845626708206
curr_Factors:  [96.54845627 -0.45561274 -1.01039747]
mat_Sqrt:  [[22.2876968   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00196346 -0.02345329 -0.16165544]
Stock Position:  0.001963459618400389
Bond Position:  [-3.35283413]


portfolio before change:  [-3.16492538]
curr_Stock_Price:  95.91634907575215
curr_Factors:  [95.91634908 -0.46484321 -1.01355191]
mat_Sqrt:  [[21.86924529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00682806  0.00694645  0.14006234]
Stock Position:  -0.006828057876835652
Bond Position:  [-2.510003]


portfolio before change:  [-3.16887882]
curr_Stock_Price:  96.44939456781921
curr_Factors:  [96.44939457 -0.61002648 -0.98053306]
mat_Sqrt:  [[19.65749953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00435096  0.00254342 -0.08554453]
Stock Position:  0.004350955789546789
Bond Position:  [-3.58852587]


portfolio before change:  [-3.17076708]
curr_Stock_Price:  96.11851058559787
curr_Factors:  [96.11851059 -0.78718539 -0.96760936]
mat_Sqrt:  [[16.62299803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00346728 -0.01533324  0.7092245 ]
Stock Position:  0.0034672819654768443
Bond Position:  [-3.50403705]


portfolio before change:  [-3.16932124]
curr_Stock_Price:  96.66183679459763
curr_Factors:  [96.66183679 -0.68737555 -0.95926844]
mat_Sqrt:  [[18.62630235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01346135 -0.04546736 -0.21372324]
Stock Position:  -0.013461345425435046
Bond Position:  [-1.86812287]


portfolio before change:  [-3.18809681]
curr_Stock_Price:  98.0392651459597
curr_Factors:  [98.03926515 -0.81314118 -0.98207188]
mat_Sqrt:  [[16.28354349  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454244  0.03459527  0.49905099]
Stock Position:  -0.004542441839122434
Bond Position:  [-2.74275915]


portfolio before change:  [-3.18368648]
curr_Stock_Price:  96.99286849071996
curr_Factors:  [96.99286849 -0.64639596 -0.98635324]
mat_Sqrt:  [[18.95159796  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00391201 0.0035687  0.39174193]
Stock Position:  0.003912007843431853
Bond Position:  [-3.56312334]


portfolio before change:  [-3.18576379]
curr_Stock_Price:  96.57571867942679
curr_Factors:  [96.57571868 -0.62787994 -0.93857023]
mat_Sqrt:  [[20.16356335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00540917  0.03667476 -0.04433897]
Stock Position:  -0.005409171457309079
Bond Position:  [-2.66336917]


portfolio before change:  [-3.18150287]
curr_Stock_Price:  95.72644607081907
curr_Factors:  [95.72644607 -0.8072151  -0.92356897]
mat_Sqrt:  [[16.95750545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349987 -0.00478389 -0.15856508]
Stock Position:  0.0034998667023715666
Bond Position:  [-3.51653268]


portfolio before change:  [-3.18469018]
curr_Stock_Price:  94.9413556616281
curr_Factors:  [94.94135566 -1.26945817 -0.90117682]
mat_Sqrt:  [[10.83329649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042404 -0.00061994 -0.15388731]
Stock Position:  -0.0004240385805803115
Bond Position:  [-3.14443138]


portfolio before change:  [-3.18507088]
curr_Stock_Price:  94.9121640230593
curr_Factors:  [94.91216402 -1.36781076 -0.87732118]
mat_Sqrt:  [[10.05248565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00031598 0.01268557 0.27623835]
Stock Position:  0.00031598009503726717
Bond Position:  [-3.21506123]


portfolio before change:  [-3.18525871]
curr_Stock_Price:  95.58967728008254
curr_Factors:  [95.58967728 -1.443232   -0.89696465]
mat_Sqrt:  [[ 9.20611728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086602 -0.01551735 -0.03820597]
Stock Position:  -0.0008660241360759346
Bond Position:  [-3.10247574]


portfolio before change:  [-3.18584908]
curr_Stock_Price:  95.82355348252003
curr_Factors:  [95.82355348 -1.30207418 -0.90230981]
mat_Sqrt:  [[10.57110702  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00645434  0.0052213   0.1746622 ]
Stock Position:  -0.006454339100103563
Bond Position:  [-2.56737138]


portfolio before change:  [-3.18461269]
curr_Stock_Price:  95.5822687030131
curr_Factors:  [95.5822687  -1.22653646 -0.92967675]
mat_Sqrt:  [[11.06485783  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01187802 -0.0192138  -0.19543014]
Stock Position:  -0.01187801813546639
Bond Position:  [-2.04928477]


portfolio before change:  [-3.19416203]
curr_Stock_Price:  96.36465229181691
curr_Factors:  [96.36465229 -1.47252306 -0.94743109]
mat_Sqrt:  [[ 8.56929365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.27009296 0.4188873  0.44639518]
Stock Position:  0.27009295601302147
Bond Position:  [-29.22157583]


portfolio before change:  [-3.17802535]
curr_Stock_Price:  96.43792189741808
curr_Factors:  [96.4379219  -1.47504574 -0.99619654]
mat_Sqrt:  [[ 8.14706083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00630355 -0.05395332  0.03289225]
Stock Position:  0.006303554826997422
Bond Position:  [-3.78592708]


portfolio before change:  [-3.1796333]
curr_Stock_Price:  96.25791631647971
curr_Factors:  [96.25791632 -1.69816809 -0.99127355]
mat_Sqrt:  [[ 6.53772716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00310751 -0.00475983 -0.10883562]
Stock Position:  0.0031075126951336106
Bond Position:  [-3.478756]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.18055321]
Stock Price:  96.10182982638322
PL:  [-3.18055321]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 4.41712044e-02 -6.80328874e-02 -4.58091423e-02]
 [ 8.69460861e-01  2.13002979e-01  2.47785149e-01]
 [-2.29996306e-01 -1.25236456e-01  3.65052872e-02]
 [ 1.79981802e-01  1.30682272e+00  1.14221297e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 1.08738097e-02  9.73354152e-02 -2.88484381e-02]
 [-4.73998161e-02 -2.15811454e-02 -6.49748300e-02]
 [-5.54317035e-02  1.06407417e-01  7.80053327e-03]
 [ 4.88468017e-02  2.76731202e-02 -4.08988142e-02]
 [-1.06461900e-01 -5.35145876e-02 -1.99621044e-02]
 [ 7.93533221e-01  1.52854645e+00 -2.75959954e-01]
 [-1.85150884e-04  3.28056483e-02 -5.84129826e-02]
 [-2.86600077e-01 -2.38492605e-03 -5.87563476e-01]
 [ 1.71596005e+00 -3.30124253e+00  2.77028540e+00]
 [ 1.10864576e-02 -9.10706330e-02  3.50636853e-02]
 [ 1.18152935e-01 -2.42601723e-02 -1.66335356e-02]
 [-7.94443831e-02 -4.57136105e-02 -5.46261779e-02]
 [-2.71028997e-01 -1.75980920e+00 -1.98701558e-01]
 [ 4.97344629e-03  1.18511175e-02  8.87914540e-02]
 [ 1.43801379e-01  2.00895669e-01  3.70331561e-01]
 [ 3.10959538e-02 -5.00678040e-02  5.40175368e-02]
 [ 1.04328901e-01 -5.02373066e-02  1.96609812e-02]
 [-2.18628400e-02  3.31434355e-03 -2.46351436e-02]
 [-4.57320150e-02 -6.43890721e-02  8.38612012e-02]
 [ 5.77727331e-02 -3.31181518e-02 -6.70847743e-03]
 [ 3.22004801e-02 -4.47669318e-02  2.69165212e-01]
 [ 4.03016252e-02 -1.18013352e-01  2.19971712e-02]
 [-1.00796008e-01  4.05365698e-02  1.20527749e-01]
 [ 5.20425397e-02 -4.00822132e-03  9.44675810e-02]
 [-5.29180140e-02  8.81820142e-02  4.35076062e-03]
 [ 5.48079019e-02 -1.38926416e-02 -8.07531132e-02]
 [-5.52204721e-02  9.41096051e-03 -4.05371870e-02]
 [-8.00733243e-02 -1.54491584e-03  5.77010301e-02]
 [-3.95038526e-02 -2.51784575e-02 -6.97493429e-03]
 [-9.71718044e-02  1.79048170e-02  4.59831762e-02]
 [-1.17241303e-01 -6.82452634e-02 -7.96847687e-02]
 [ 2.00522746e+00  1.29762668e+00  1.57462883e-01]
 [ 7.60580087e-03 -5.29422127e-02  3.13395153e-02]
 [ 3.07390160e-02 -1.48747924e-02 -3.20518146e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.02242666]
curr_Stock_Price:  100.083876833486
curr_Factors:  [100.08387683  -1.10371749  -0.99822297]
mat_Sqrt:  [[12.23215495  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171133 -0.02195752 -0.13068073]
Stock Position:  0.0017113335684917062
Bond Position:  [2.85114977]


portfolio before change:  [3.02175018]
curr_Stock_Price:  99.48031467171948
curr_Factors:  [99.48031467 -1.16583955 -0.97739848]
mat_Sqrt:  [[11.66650301  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08258849 0.06874642 0.70686206]
Stock Position:  0.0825884879935741
Bond Position:  [-5.19417859]


portfolio before change:  [3.08077637]
curr_Stock_Price:  100.20287907758933
curr_Factors:  [100.20287908  -0.9615904   -0.96600967]
mat_Sqrt:  [[14.57921441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01701796 -0.04041989  0.10413942]
Stock Position:  -0.017017959481689666
Bond Position:  [4.78602491]


portfolio before change:  [3.08750136]
curr_Stock_Price:  99.8428652142221
curr_Factors:  [99.84286521 -0.97831041 -0.96569792]
mat_Sqrt:  [[14.29041844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04757657 0.42177522 3.25841567]
Stock Position:  0.04757657174058963
Bond Position:  [-1.66267988]


portfolio before change:  [3.08086151]
curr_Stock_Price:  99.70767256623762
curr_Factors:  [99.70767257 -0.68467517 -0.95205346]
mat_Sqrt:  [[19.40467481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302226 -0.01106097 -0.05874131]
Stock Position:  -0.00302226146515279
Bond Position:  [3.38220417]


portfolio before change:  [3.08056472]
curr_Stock_Price:  99.94577044864093
curr_Factors:  [99.94577045 -0.63544624 -0.95551926]
mat_Sqrt:  [[20.36183362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012206   0.03141487 -0.08229656]
Stock Position:  0.0012206000595221264
Bond Position:  [2.95857091]


portfolio before change:  [3.08247048]
curr_Stock_Price:  101.20409595925143
curr_Factors:  [101.20409596  -0.57730147  -0.96986184]
mat_Sqrt:  [[21.54138413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0030206  -0.00696528 -0.1853551 ]
Stock Position:  -0.0030206035143376356
Bond Position:  [3.38816793]


portfolio before change:  [3.09017492]
curr_Stock_Price:  98.7936858993059
curr_Factors:  [98.7936859  -0.66201859 -0.95273379]
mat_Sqrt:  [[19.65400861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00163423  0.03434285  0.02225275]
Stock Position:  -0.001634226582164707
Bond Position:  [3.25162619]


portfolio before change:  [3.08974313]
curr_Stock_Price:  99.3066281465897
curr_Factors:  [99.30662815 -0.66542622 -0.98561929]
mat_Sqrt:  [[19.05189958  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00242218  0.00893146 -0.11667293]
Stock Position:  0.0024221793770067964
Bond Position:  [2.84920467]


portfolio before change:  [3.09322754]
curr_Stock_Price:  100.59812445121645
curr_Factors:  [100.59812445  -0.66425341  -0.97289252]
mat_Sqrt:  [[19.56980242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00620651 -0.01727176 -0.05694633]
Stock Position:  -0.006206514742194908
Bond Position:  [3.71759128]


portfolio before change:  [3.08969693]
curr_Stock_Price:  101.24185804687743
curr_Factors:  [101.24185805  -0.92947269  -0.95962164]
mat_Sqrt:  [[15.30864891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06853749  0.49333624 -0.78723694]
Stock Position:  0.06853748978611272
Bond Position:  [-3.84916588]


portfolio before change:  [3.08961685]
curr_Stock_Price:  101.24771028493832
curr_Factors:  [101.24771028  -1.12578198  -0.94728384]
mat_Sqrt:  [[12.73691243  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042492  0.01058798 -0.16663598]
Stock Position:  -0.0004249244966992421
Bond Position:  [3.13263948]


portfolio before change:  [3.09022696]
curr_Stock_Price:  100.7334857673944
curr_Factors:  [100.73348577  -1.09251096  -0.94733978]
mat_Sqrt:  [[13.10020049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.10699665e-02 -7.69731572e-04 -1.67615505e+00]
Stock Position:  -0.031069966475875167
Bond Position:  [6.22001299]


portfolio before change:  [3.07254833]
curr_Stock_Price:  101.32750590165102
curr_Factors:  [101.3275059   -1.15136756  -0.9524925 ]
mat_Sqrt:  [[12.36040039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.1300588  -1.06547145  7.90285314]
Stock Position:  0.13005880269189093
Bond Position:  [-10.10598577]


portfolio before change:  [3.00800406]
curr_Stock_Price:  100.84094952076956
curr_Factors:  [100.84094952  -1.21244917  -0.93256998]
mat_Sqrt:  [[11.80502597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.93021557e-05 -2.93929204e-02  1.00026934e-01]
Stock Position:  -2.930215565997723e-05
Bond Position:  [3.01095892]


portfolio before change:  [3.00838061]
curr_Stock_Price:  100.83562080655318
curr_Factors:  [100.83562081  -1.2400664   -0.94431747]
mat_Sqrt:  [[11.34875218  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00967556 -0.00782994 -0.04745085]
Stock Position:  0.009675560817621763
Bond Position:  [2.03273943]


portfolio before change:  [3.00826073]
curr_Stock_Price:  100.79696810345929
curr_Factors:  [100.7969681   -1.10340744  -0.95899206]
mat_Sqrt:  [[12.81618437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00779687 -0.014754   -0.15583328]
Stock Position:  -0.0077968725877890915
Bond Position:  [3.79416185]


portfolio before change:  [3.00773586]
curr_Stock_Price:  100.92511798211916
curr_Factors:  [100.92511798  -0.99338541  -0.96686802]
mat_Sqrt:  [[14.2125503   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04719831 -0.56797598 -0.56684024]
Stock Position:  -0.04719830838096602
Bond Position:  [7.7712307]


portfolio before change:  [3.05864175]
curr_Stock_Price:  99.86714740160943
curr_Factors:  [99.8671474  -0.91451484 -0.95088643]
mat_Sqrt:  [[15.46283656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00165022 0.00382493 0.2532973 ]
Stock Position:  0.0016502163152575177
Bond Position:  [2.89383935]


portfolio before change:  [3.05748492]
curr_Stock_Price:  98.94691648418164
curr_Factors:  [98.94691648 -0.99872843 -0.95976059]
mat_Sqrt:  [[13.9585817   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01865538 0.0648388  1.05645286]
Stock Position:  0.01865538022473245
Bond Position:  [1.21159257]


portfolio before change:  [3.05627553]
curr_Stock_Price:  98.87397001320652
curr_Factors:  [98.87397001 -0.8845021  -0.94051114]
mat_Sqrt:  [[15.94001748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00200139 -0.01615931  0.154097  ]
Stock Position:  0.002001389873539048
Bond Position:  [2.85839017]


portfolio before change:  [3.05741016]
curr_Stock_Price:  99.26235327748505
curr_Factors:  [99.26235328 -1.04285596 -0.93783523]
mat_Sqrt:  [[13.69560787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00716197 -0.01621402  0.05608731]
Stock Position:  0.007161970179982908
Bond Position:  [2.34649615]


portfolio before change:  [3.05401607]
curr_Stock_Price:  98.74749135257086
curr_Factors:  [98.74749135 -1.01023777 -0.95105973]
mat_Sqrt:  [[13.89138003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188714  0.0010697  -0.07027721]
Stock Position:  -0.0018871364837781159
Bond Position:  [3.24036606]


portfolio before change:  [3.05464336]
curr_Stock_Price:  98.62973451544538
curr_Factors:  [98.62973452 -0.9827143  -0.93348298]
mat_Sqrt:  [[14.51489694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287686 -0.02078148  0.23923266]
Stock Position:  -0.0028768570289249363
Bond Position:  [3.33838701]


portfolio before change:  [3.05599728]
curr_Stock_Price:  98.30417337093543
curr_Factors:  [98.30417337 -0.74605381 -0.92894219]
mat_Sqrt:  [[18.41324937  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00269606 -0.01068884 -0.01913742]
Stock Position:  0.0026960562739330304
Bond Position:  [2.79096369]


portfolio before change:  [3.05652513]
curr_Stock_Price:  98.3705505242922
curr_Factors:  [98.37055052 -0.96951542 -0.9182163 ]
mat_Sqrt:  [[14.89476417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00523711 -0.01444847  0.76785343]
Stock Position:  0.005237114618190255
Bond Position:  [2.54134728]


portfolio before change:  [3.05636815]
curr_Stock_Price:  98.27991655288923
curr_Factors:  [98.27991655 -0.9910454  -0.91400123]
mat_Sqrt:  [[14.62559487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141549 -0.03808865  0.06275181]
Stock Position:  0.0014154914389702335
Bond Position:  [2.91725377]


portfolio before change:  [3.05471299]
curr_Stock_Price:  96.8529631267636
curr_Factors:  [96.85296313 -1.04235059 -0.92189103]
mat_Sqrt:  [[13.58481146  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00499962  0.01308312  0.34383212]
Stock Position:  -0.004999619726081436
Bond Position:  [3.53894098]


portfolio before change:  [3.05213331]
curr_Stock_Price:  97.45742533598754
curr_Factors:  [97.45742534 -0.94916219 -0.91509687]
mat_Sqrt:  [[15.10697504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00466721 -0.00129365  0.26948971]
Stock Position:  0.004667213589520797
Bond Position:  [2.59727869]


portfolio before change:  [3.05472559]
curr_Stock_Price:  97.94328254380508
curr_Factors:  [97.94328254 -1.35882428 -0.95090769]
mat_Sqrt:  [[ 9.72457892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00349936  0.02846062  0.01241151]
Stock Position:  -0.003499363897801005
Bond Position:  [3.39746477]


portfolio before change:  [3.05534701]
curr_Stock_Price:  97.88706706166981
curr_Factors:  [97.88706706 -1.26413292 -0.95326004]
mat_Sqrt:  [[10.65917983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00332938 -0.00448383 -0.23036615]
Stock Position:  0.0033293760510785257
Bond Position:  [2.72944416]


portfolio before change:  [3.0551768]
curr_Stock_Price:  97.73345851264648
curr_Factors:  [97.73345851 -0.93714495 -0.95437969]
mat_Sqrt:  [[14.74227651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0041767   0.00303737 -0.11564131]
Stock Position:  -0.00417670136978402
Bond Position:  [3.46338027]


portfolio before change:  [3.05845175]
curr_Stock_Price:  97.05301737539732
curr_Factors:  [97.05301738 -1.05892663 -0.94664482]
mat_Sqrt:  [[13.06172175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00525279 -0.00049862  0.16460498]
Stock Position:  -0.005252791846758075
Bond Position:  [3.56825104]


portfolio before change:  [3.05834176]
curr_Stock_Price:  97.15887344702423
curr_Factors:  [97.15887345 -0.65206446 -0.95298604]
mat_Sqrt:  [[19.5172172   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236033 -0.00812631 -0.01989755]
Stock Position:  -0.0023603332243206875
Bond Position:  [3.28766908]


portfolio before change:  [3.05670351]
curr_Stock_Price:  98.0270718945768
curr_Factors:  [98.02707189 -0.77985455 -0.96200633]
mat_Sqrt:  [[17.1737629   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00489879  0.00577875  0.1311772 ]
Stock Position:  -0.004898793755253886
Bond Position:  [3.53691792]


portfolio before change:  [3.05644896]
curr_Stock_Price:  98.16928942063089
curr_Factors:  [98.16928942 -0.84968234 -0.98775908]
mat_Sqrt:  [[15.63093575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00943241 -0.02202606 -0.22731847]
Stock Position:  -0.009432409969180502
Bond Position:  [3.98242194]


portfolio before change:  [3.05181206]
curr_Stock_Price:  98.71366092676763
curr_Factors:  [98.71366093 -0.7134596  -0.97962039]
mat_Sqrt:  [[18.15858331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.12678557 0.41880721 0.44919778]
Stock Position:  0.12678557197550147
Bond Position:  [-9.4636559]


portfolio before change:  [2.80047148]
curr_Stock_Price:  96.74058513270393
curr_Factors:  [96.74058513 -0.70220848 -0.95539116]
mat_Sqrt:  [[18.43836182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00017334 -0.01708703  0.08940291]
Stock Position:  0.00017334342183436625
Bond Position:  [2.78370214]


portfolio before change:  [2.80061138]
curr_Stock_Price:  95.5401380607987
curr_Factors:  [95.54013806 -0.85565353 -0.9418875 ]
mat_Sqrt:  [[15.83156007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133658 -0.00480082 -0.09143491]
Stock Position:  0.0013365810019933858
Bond Position:  [2.67291425]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.80062767]
Stock Price:  95.30233586456308
PL:  [2.80062767]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 9.24827778e-02 -2.48941359e-02  2.68378694e-02]
 [ 1.63659980e+00  3.62692560e-01  5.49840641e-01]
 [ 1.23027014e-01  2.30658669e-01  4.16991445e-02]
 [ 1.11748934e-01  7.92363203e-01  7.01289526e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 5.08442168e-02  9.61759006e-03  1.44464439e-03]
 [-5.20313230e-02 -8.52974772e-04 -6.94339543e-02]
 [-6.34330807e-02  1.25943358e-01  6.51462416e-04]
 [ 2.69295397e-02  5.13911399e-02 -4.45021879e-02]
 [-1.10220128e-01 -5.58482840e-02 -2.25598054e-02]
 [ 8.48264703e-01  1.62793548e+00 -2.96132206e-01]
 [-8.37424763e-05  3.36808049e-02 -5.87318806e-02]
 [-3.02934831e-01 -1.89915161e-03 -6.33661087e-01]
 [ 1.73357659e+00 -3.17063728e+00  2.66534915e+00]
 [ 1.64747274e-03 -9.26618146e-02  3.60424242e-02]
 [ 1.26916518e-01 -2.01843285e-02 -2.11932383e-02]
 [-6.26092879e-02 -1.06744506e-02 -6.25247520e-02]
 [-2.77355795e-01 -1.79607482e+00 -1.98786764e-01]
 [ 7.37257364e-03  2.98963509e-02  1.87079675e-02]
 [ 1.16968899e-01  1.76458875e-01  3.06761982e-01]
 [ 2.83012072e-02 -2.45684599e-02  3.06512939e-02]
 [ 1.14360650e-01 -5.14428821e-02  3.66911726e-02]
 [-6.11911928e-02 -8.36999384e-02 -8.00963522e-02]
 [-1.10723319e-01 -3.47819750e-02 -1.25152484e-01]
 [ 5.64611967e-02  2.15972109e-04 -1.36609053e-02]
 [ 8.06156480e-03 -4.90049522e-02  2.37392860e-01]
 [ 4.15510637e-01 -8.34080113e-02  2.12356840e-01]
 [ 6.91193658e-02 -2.14643365e-01 -1.21836694e-01]
 [ 2.45005995e-02 -5.66426857e-02  3.03106208e-03]
 [ 5.80897409e-03  5.89671111e-02  2.43349784e-02]
 [ 2.54416975e-02 -1.56193604e-02 -7.50686416e-02]
 [-3.48430950e-02  2.27796552e-02 -5.02159137e-02]
 [-4.83142927e-02 -5.64497278e-02  1.67204210e-02]
 [ 2.51579028e-01  2.93411934e-02  5.69814769e-02]
 [-8.26861806e-02 -5.00801591e-02  7.53594684e-02]
 [-1.15507602e-01 -6.50135196e-02 -8.07706904e-02]
 [ 2.45233028e+00  1.57296665e+00  1.74008153e-01]
 [ 1.34529021e-03 -2.02063341e-01 -7.18287422e-02]
 [ 3.61111823e-02 -1.92189029e-02 -2.52577348e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.17941309]
curr_Stock_Price:  101.06053064940583
curr_Factors:  [101.06053065  -0.96042328  -1.02237283]
mat_Sqrt:  [[13.91438971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00667507 -0.00803455  0.07656097]
Stock Position:  0.006675071108829056
Bond Position:  [9.50482687]


portfolio before change:  [10.18462521]
curr_Stock_Price:  101.66336171209578
curr_Factors:  [101.66336171  -0.90963676  -0.99024905]
mat_Sqrt:  [[15.20738505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11986741 0.11705852 1.5685423 ]
Stock Position:  0.11986741027202534
Bond Position:  [-2.00149868]


portfolio before change:  [10.17893471]
curr_Stock_Price:  101.61797570044571
curr_Factors:  [101.6179757   -0.93655552  -1.00520381]
mat_Sqrt:  [[14.57723576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01225348 0.07444477 0.11895605]
Stock Position:  0.01225347678129754
Bond Position:  [8.9337612]


portfolio before change:  [10.17560004]
curr_Stock_Price:  101.25469466602557
curr_Factors:  [101.25469467  -0.75617653  -0.99289838]
mat_Sqrt:  [[17.6117124   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02365696 0.25573412 2.00058382]
Stock Position:  0.023656956875527338
Bond Position:  [7.7802221]


portfolio before change:  [10.16997333]
curr_Stock_Price:  100.97573655736198
curr_Factors:  [100.97573656  -0.61245726  -0.98645374]
mat_Sqrt:  [[20.40886279  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287356 -0.01106097 -0.05874131]
Stock Position:  -0.0028735555501459733
Bond Position:  [10.46013272]


portfolio before change:  [10.17023206]
curr_Stock_Price:  101.34074357738875
curr_Factors:  [101.34074358  -0.65730463  -1.00148704]
mat_Sqrt:  [[19.29212286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00275254 0.00310406 0.00412117]
Stock Position:  0.002752537204376782
Bond Position:  [9.89128789]


portfolio before change:  [10.16843316]
curr_Stock_Price:  100.23798484588869
curr_Factors:  [100.23798485  -0.93862418  -0.99020647]
mat_Sqrt:  [[14.56638614  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00455697 -0.0002753  -0.19807574]
Stock Position:  -0.004556969837867369
Bond Position:  [10.62521464]


portfolio before change:  [10.17434017]
curr_Stock_Price:  99.23320049428287
curr_Factors:  [99.23320049 -0.81346953 -0.97790602]
mat_Sqrt:  [[16.54521752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227208  0.04064804  0.00185844]
Stock Position:  -0.0022720777893713846
Bond Position:  [10.39980572]


portfolio before change:  [10.17432679]
curr_Stock_Price:  99.81127672002135
curr_Factors:  [99.81127672 -0.78807219 -0.98593098]
mat_Sqrt:  [[16.93323056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00167338  0.01658642 -0.12695235]
Stock Position:  0.001673380695627997
Bond Position:  [10.00730453]


portfolio before change:  [10.17560279]
curr_Stock_Price:  99.82622240611789
curr_Factors:  [99.82622241 -0.99156943 -0.97448111]
mat_Sqrt:  [[13.97654198  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00903121 -0.01802496 -0.06435685]
Stock Position:  -0.009031211911430534
Bond Position:  [11.07715456]


portfolio before change:  [10.16941665]
curr_Stock_Price:  100.66452338397231
curr_Factors:  [100.66452338  -1.02744348  -0.98647955]
mat_Sqrt:  [[13.43509628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08337253  0.52541392 -0.84478276]
Stock Position:  0.08337252563311916
Bond Position:  [1.77676109]


portfolio before change:  [10.16229969]
curr_Stock_Price:  100.5764959202978
curr_Factors:  [100.57649592  -1.15352965  -0.97820241]
mat_Sqrt:  [[11.93155448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043559  0.01087043 -0.16754571]
Stock Position:  -0.0004355905085727821
Bond Position:  [10.20610986]


portfolio before change:  [10.16375116]
curr_Stock_Price:  100.17329433010107
curr_Factors:  [100.17329433  -1.04373051  -1.01006937]
mat_Sqrt:  [[12.84688998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.36788143e-02 -6.12948547e-04 -1.80765870e+00]
Stock Position:  -0.03367881427658459
Bond Position:  [13.53746894]


portfolio before change:  [10.15499576]
curr_Stock_Price:  100.48350987717825
curr_Factors:  [100.48350988  -0.8547305   -0.99414902]
mat_Sqrt:  [[15.81745567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10307821 -1.02331878  7.60349923]
Stock Position:  0.10307821380547945
Bond Position:  [-0.20266496]


portfolio before change:  [10.1514364]
curr_Stock_Price:  100.4492250065273
curr_Factors:  [100.44922501  -0.80181218  -0.97364108]
mat_Sqrt:  [[17.01676634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058236 -0.02990647  0.102819  ]
Stock Position:  -0.0005823616379474109
Bond Position:  [10.20993418]


portfolio before change:  [10.15258819]
curr_Stock_Price:  100.66306504667821
curr_Factors:  [100.66306505  -0.89589076  -0.98114406]
mat_Sqrt:  [[15.40580104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00768998 -0.00651446 -0.06045841]
Stock Position:  0.007689983606291308
Bond Position:  [9.37849087]


portfolio before change:  [10.15039981]
curr_Stock_Price:  100.22603320660544
curr_Factors:  [100.22603321  -0.78907529  -0.968204  ]
mat_Sqrt:  [[17.29035235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448522 -0.00344516 -0.17836571]
Stock Position:  -0.00448521875327252
Bond Position:  [10.59993549]


portfolio before change:  [10.15303443]
curr_Stock_Price:  99.93406414870115
curr_Factors:  [99.93406415 -0.65878342 -0.95684688]
mat_Sqrt:  [[19.86342916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03446309 -0.57968066 -0.56708331]
Stock Position:  -0.034463093249847365
Bond Position:  [13.5970714]


portfolio before change:  [10.16307448]
curr_Stock_Price:  99.69205701034653
curr_Factors:  [99.69205701 -0.68511933 -0.95011756]
mat_Sqrt:  [[19.43059956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00089003 0.00964901 0.05336862]
Stock Position:  0.0008900337094495925
Bond Position:  [10.07434519]


portfolio before change:  [10.16350468]
curr_Stock_Price:  98.76043204164111
curr_Factors:  [98.76043204 -0.75360585 -0.92215452]
mat_Sqrt:  [[18.48457618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0116641  0.05695186 0.87510655]
Stock Position:  0.0116640998934132
Bond Position:  [9.01155313]


portfolio before change:  [10.15629402]
curr_Stock_Price:  98.04565996975941
curr_Factors:  [98.04565997 -0.85930303 -0.93019518]
mat_Sqrt:  [[16.37793613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00180382 -0.00792944  0.08743961]
Stock Position:  0.0018038207142020747
Bond Position:  [9.97943723]


portfolio before change:  [10.15702238]
curr_Stock_Price:  97.75785471169738
curr_Factors:  [97.75785471 -1.11199765 -0.92262234]
mat_Sqrt:  [[12.77989916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00871286 -0.01660312  0.1046697 ]
Stock Position:  0.00871285979159564
Bond Position:  [9.3052719]


portfolio before change:  [10.15977989]
curr_Stock_Price:  97.94083472471613
curr_Factors:  [97.94083472 -1.19940252 -0.90931669]
mat_Sqrt:  [[11.8893657   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00795887 -0.02701404 -0.2284926 ]
Stock Position:  -0.007958874591898498
Bond Position:  [10.93927871]


portfolio before change:  [10.1566799]
curr_Stock_Price:  98.50215630210401
curr_Factors:  [98.5021563  -1.54536991 -0.90211946]
mat_Sqrt:  [[ 8.52147173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01682454 -0.01122583 -0.3570252 ]
Stock Position:  -0.016824535548992714
Bond Position:  [11.81393293]


portfolio before change:  [10.15152764]
curr_Stock_Price:  98.89616964280258
curr_Factors:  [98.89616964 -1.36149173 -0.87176809]
mat_Sqrt:  [[10.59954095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.06783845e-03  6.97046985e-05 -3.89707605e-02]
Stock Position:  0.005067838449032144
Bond Position:  [9.65033783]


portfolio before change:  [10.15236811]
curr_Stock_Price:  98.8239702170016
curr_Factors:  [98.82397022 -1.43758773 -0.88790587]
mat_Sqrt:  [[ 9.65857948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00481604 -0.01581628  0.67721575]
Stock Position:  0.004816037964530136
Bond Position:  [9.67642812]


portfolio before change:  [10.15251938]
curr_Stock_Price:  98.60421231030061
curr_Factors:  [98.60421231 -1.73640567 -0.90601764]
mat_Sqrt:  [[ 7.01949072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06294363 -0.02691982  0.60579496]
Stock Position:  0.06294362714660053
Bond Position:  [3.9460126]


portfolio before change:  [10.16422773]
curr_Stock_Price:  98.7823886898484
curr_Factors:  [98.78238869 -1.45954233 -0.90035206]
mat_Sqrt:  [[ 9.32804027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.67044977e-05 -6.92758482e-02 -3.47566174e-01]
Stock Position:  4.670449772984083e-05
Bond Position:  [10.15961415]


portfolio before change:  [10.16552028]
curr_Stock_Price:  99.26456916964115
curr_Factors:  [99.26456917 -1.50511679 -0.89451487]
mat_Sqrt:  [[ 9.00839604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150495 -0.01828135  0.00864678]
Stock Position:  0.0015049485656509504
Bond Position:  [10.01613221]


portfolio before change:  [10.16699111]
curr_Stock_Price:  99.40991122410583
curr_Factors:  [99.40991122 -1.28297516 -0.91624999]
mat_Sqrt:  [[11.02347037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00206949 0.01903155 0.06942092]
Stock Position:  0.002069488203781664
Bond Position:  [9.96126347]


portfolio before change:  [10.16753053]
curr_Stock_Price:  99.06885427124607
curr_Factors:  [99.06885427 -1.15407104 -0.92098289]
mat_Sqrt:  [[12.43806054  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00055717 -0.00504113 -0.21414994]
Stock Position:  0.0005571677860648573
Bond Position:  [10.11233255]


portfolio before change:  [10.16925235]
curr_Stock_Price:  99.8903373876151
curr_Factors:  [99.89033739 -1.15245526 -0.92445946]
mat_Sqrt:  [[12.51788274  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323086  0.0073521  -0.14325202]
Stock Position:  -0.003230857698171308
Bond Position:  [10.49198382]


portfolio before change:  [10.16599067]
curr_Stock_Price:  101.30583284200019
curr_Factors:  [101.30583284  -1.438483    -0.95538552]
mat_Sqrt:  [[ 9.2467808   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00610202 -0.01821907  0.04769871]
Stock Position:  -0.006102015905111287
Bond Position:  [10.78416047]


portfolio before change:  [10.1703998]
curr_Stock_Price:  100.80419082380223
curr_Factors:  [100.80419082  -1.66437915  -0.94774865]
mat_Sqrt:  [[ 7.39683445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03639389 0.00946983 0.16255229]
Stock Position:  0.03639388863608079
Bond Position:  [6.5017433]


portfolio before change:  [10.14061566]
curr_Stock_Price:  99.96347515760598
curr_Factors:  [99.96347516 -1.79018377 -0.92224668]
mat_Sqrt:  [[ 6.63510453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01168423 -0.0161633   0.21497959]
Stock Position:  -0.011684226345449892
Bond Position:  [11.30861153]


portfolio before change:  [10.13920673]
curr_Stock_Price:  100.2050477713792
curr_Factors:  [100.20504777  -1.86266976  -0.89735944]
mat_Sqrt:  [[ 6.3419695   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02290545 -0.02098302 -0.2304163 ]
Stock Position:  -0.02290545222021587
Bond Position:  [12.43444867]


portfolio before change:  [10.13464888]
curr_Stock_Price:  100.47189515340342
curr_Factors:  [100.47189515  -1.78915339  -0.90521052]
mat_Sqrt:  [[ 6.79042904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.41366017 0.5076728  0.49639683]
Stock Position:  0.4136601675604159
Bond Position:  [-31.42657211]


portfolio before change:  [10.18774681]
curr_Stock_Price:  100.60975347979851
curr_Factors:  [100.60975348  -2.09964559  -0.91034903]
mat_Sqrt:  [[ 4.95925034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01100221 -0.06521566 -0.20490741]
Stock Position:  -0.011002206655761373
Bond Position:  [11.29467611]


portfolio before change:  [10.18714783]
curr_Stock_Price:  100.79252615656864
curr_Factors:  [100.79252616  -2.21199761  -0.90684157]
mat_Sqrt:  [[ 4.45588204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00606668 -0.00620287 -0.07205329]
Stock Position:  0.00606668362793381
Bond Position:  [9.57567146]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.19036103]
Stock Price:  101.12486145514838
PL:  [9.06549958]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 9.38328656e-03 -1.01251457e-01  1.58783678e-02]
 [ 9.13347554e-01  2.18156046e-01  2.58403190e-01]
 [-3.63720798e-01 -2.48327090e-01  4.04058400e-02]
 [ 2.08886421e-01  1.52544983e+00  1.32885341e+00]
 [-4.76237276e-02 -3.33343440e-02 -1.91559530e-02]
 [ 9.19535399e-03  7.18846103e-02 -3.38556919e-03]
 [-2.03546961e-01  3.94623581e-01  2.54079149e-01]
 [-6.32024915e-02  1.24876279e-01  9.26490316e-04]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 6.92724839e-01  1.49177597e+00 -2.01948304e-01]
 [-1.13449906e-03  2.51411420e-02  9.98078184e-02]
 [-5.05671192e-01 -1.44982911e-02 -1.07172524e+00]
 [ 2.02038952e+00 -3.18888740e+00  2.70507474e+00]
 [ 2.30931839e-02 -6.53676797e-02 -4.00661393e-03]
 [ 2.71125121e-02  1.97274179e-01 -1.14532639e-01]
 [-1.86946809e-02  1.51493740e-01 -8.14926877e-02]
 [-2.77534992e-01 -1.79390010e+00 -1.97632558e-01]
 [ 9.02787219e-03 -2.97046249e-02  1.57500868e-01]
 [ 1.73996469e-01  1.80630890e-01  4.24713828e-01]
 [ 3.36012763e-02 -5.78671041e-02  7.60130011e-02]
 [ 1.02153693e-01 -4.99275825e-02  1.83915032e-02]
 [ 1.20834136e-01 -1.88467624e-02 -4.55771612e-03]
 [-1.15911655e-01 -1.32969993e-02  6.31872892e-02]
 [ 7.93695667e-02  1.73862644e-02 -2.82401861e-02]
 [ 4.95221020e-02 -4.17258098e-02  2.91964441e-01]
 [-1.47450085e-01 -1.27031915e-01 -5.36812578e-02]
 [-1.25537133e-01  9.84654912e-02  1.75926282e-01]
 [ 1.36998309e-02 -5.24441524e-02  3.58130771e-02]
 [ 1.27260531e-02  4.57308359e-02  5.01505949e-02]
 [ 1.16630674e-02 -1.56537725e-02 -7.23580554e-02]
 [-4.39293421e-02  1.77868096e-02 -4.61989860e-02]
 [-1.22596477e-01 -2.66606346e-02  4.43373378e-02]
 [ 4.18637837e-02 -1.86624715e-02  6.85060809e-03]
 [-8.76038572e-02 -2.32901659e-02  6.46806208e-02]
 [-1.14188651e-01 -6.56466360e-02 -7.68752266e-02]
 [ 2.17225707e+00  1.39636059e+00  1.62839004e-01]
 [-3.30697212e-02 -5.91808552e-02 -9.50673274e-03]
 [ 3.22039176e-02 -1.42840709e-02 -5.51472409e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.83223672]
curr_Stock_Price:  99.78500001085133
curr_Factors:  [99.78500001 -1.02829458 -0.97929829]
mat_Sqrt:  [[13.40228212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060015 -0.03267877  0.04529656]
Stock Position:  -0.0006001531919270608
Bond Position:  [0.89212301]


portfolio before change:  [0.83236475]
curr_Stock_Price:  99.75749907152309
curr_Factors:  [99.75749907 -1.02665752 -0.98448459]
mat_Sqrt:  [[13.35111793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07569589 0.07040956 0.73715238]
Stock Position:  0.07569589350660569
Bond Position:  [-6.71886828]


portfolio before change:  [0.77824717]
curr_Stock_Price:  99.05366077438717
curr_Factors:  [99.05366077 -0.93623015 -0.97869495]
mat_Sqrt:  [[14.59584107  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02782728 -0.08014722  0.11526661]
Stock Position:  -0.027827279290859624
Bond Position:  [3.53464105]


portfolio before change:  [0.77495309]
curr_Stock_Price:  99.18791534448522
curr_Factors:  [99.18791534 -1.0786377  -0.98392558]
mat_Sqrt:  [[12.60953037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06277146 0.49233682 3.79084891]
Stock Position:  0.06277146000862165
Bond Position:  [-5.45121717]


portfolio before change:  [0.73845254]
curr_Stock_Price:  98.6172881337898
curr_Factors:  [98.61728813 -1.10248889 -0.96920968]
mat_Sqrt:  [[12.42298026  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.004696   -0.01075861 -0.0546466 ]
Stock Position:  -0.004695995920728634
Bond Position:  [1.20155892]


portfolio before change:  [0.73713569]
curr_Stock_Price:  98.92969253829337
curr_Factors:  [98.92969254 -1.31156564 -0.94411714]
mat_Sqrt:  [[10.36802595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00223549  0.02320066 -0.00965809]
Stock Position:  0.002235494232699724
Bond Position:  [0.51597894]


portfolio before change:  [0.73488796]
curr_Stock_Price:  97.89536223919764
curr_Factors:  [97.89536224 -1.34076807 -0.95072337]
mat_Sqrt:  [[ 9.89874262  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00718587  0.12736421  0.72481709]
Stock Position:  -0.007185869315180472
Bond Position:  [1.43835124]


portfolio before change:  [0.73217455]
curr_Stock_Price:  98.29798732361515
curr_Factors:  [98.29798732 -1.13289281 -0.95899585]
mat_Sqrt:  [[12.13525543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309207  0.04030365  0.00264302]
Stock Position:  -0.0030920740868445352
Bond Position:  [1.03611921]


portfolio before change:  [0.73773151]
curr_Stock_Price:  96.54271295765139
curr_Factors:  [96.54271296 -1.02723128 -0.95721412]
mat_Sqrt:  [[13.27045493  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00391782  0.0064198  -0.11330016]
Stock Position:  0.003917816201740002
Bond Position:  [0.35949491]


portfolio before change:  [0.73863392]
curr_Stock_Price:  96.76157587583728
curr_Factors:  [96.76157588 -1.07964884 -0.95503879]
mat_Sqrt:  [[12.64879991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [6.91029389e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  6.910293889086474e-05
Bond Position:  [0.73194741]


portfolio before change:  [0.73869478]
curr_Stock_Price:  96.3182478798213
curr_Factors:  [96.31824788 -0.83215013 -0.93552165]
mat_Sqrt:  [[16.44441662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05813583  0.48146862 -0.5761023 ]
Stock Position:  0.05813582993041343
Bond Position:  [-4.8608465]


portfolio before change:  [0.81944125]
curr_Stock_Price:  97.71762784195683
curr_Factors:  [97.71762784 -0.76487483 -0.94733323]
mat_Sqrt:  [[17.63479453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00138196 0.00811427 0.28472392]
Stock Position:  0.0013819611350860193
Bond Position:  [0.68439929]


portfolio before change:  [0.81875665]
curr_Stock_Price:  97.16033513019646
curr_Factors:  [97.16033513 -0.64272751 -0.96936038]
mat_Sqrt:  [[19.3806407   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03753207 -0.0046793  -3.0573338 ]
Stock Position:  -0.03753207403200239
Bond Position:  [4.46538554]


portfolio before change:  [0.81227667]
curr_Stock_Price:  97.34785961357585
curr_Factors:  [97.34785961 -0.95757518 -0.96032281]
mat_Sqrt:  [[14.30190524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.13436194 -1.02920898  7.71682529]
Stock Position:  0.13436193578047642
Bond Position:  [-12.26757019]


portfolio before change:  [0.7546148]
curr_Stock_Price:  96.93011978139404
curr_Factors:  [96.93011978 -0.73016971 -0.95739534]
mat_Sqrt:  [[17.92910306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004982  -0.02109733 -0.01142975]
Stock Position:  0.0004981964520548715
Bond Position:  [0.70632456]


portfolio before change:  [0.75492258]
curr_Stock_Price:  97.3706764246119
curr_Factors:  [97.37067642 -0.73191361 -0.94977198]
mat_Sqrt:  [[18.11679692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024288   0.06366997 -0.32672974]
Stock Position:  0.00242879899260245
Bond Position:  [0.51842878]


portfolio before change:  [0.75673592]
curr_Stock_Price:  98.0905930147129
curr_Factors:  [98.09059301 -0.74595109 -0.92065957]
mat_Sqrt:  [[18.52795759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023779  0.04889439 -0.23247595]
Stock Position:  -0.00023779069735194934
Bond Position:  [0.78006095]


portfolio before change:  [0.7564634]
curr_Stock_Price:  99.64674167774696
curr_Factors:  [99.64674168 -0.87459237 -0.95698806]
mat_Sqrt:  [[15.9594466   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04286207 -0.57897877 -0.56379068]
Stock Position:  -0.04286206856446429
Bond Position:  [5.02752887]


portfolio before change:  [0.77009181]
curr_Stock_Price:  99.34344487575534
curr_Factors:  [99.34344488 -0.98769862 -0.97177465]
mat_Sqrt:  [[14.0007335   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00250802 -0.00958713  0.44930614]
Stock Position:  0.002508023675114693
Bond Position:  [0.52093609]


portfolio before change:  [0.77043557]
curr_Stock_Price:  99.45454732889151
curr_Factors:  [99.45454733 -1.1810756  -0.98897413]
mat_Sqrt:  [[11.35491852  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02620555 0.05829837 1.21159033]
Stock Position:  0.02620555497756664
Bond Position:  [-1.83582603]


portfolio before change:  [0.77883242]
curr_Stock_Price:  99.78372714046017
curr_Factors:  [99.78372714 -0.9604484  -0.99950261]
mat_Sqrt:  [[14.05606677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00265403 -0.01867653  0.21684393]
Stock Position:  0.0026540349175421954
Bond Position:  [0.51400292]


portfolio before change:  [0.7776815]
curr_Stock_Price:  99.32586623773828
curr_Factors:  [99.32586624 -0.97629766 -1.01020617]
mat_Sqrt:  [[13.62494347  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00702509 -0.01611406  0.05246584]
Stock Position:  0.007025087312563288
Bond Position:  [0.07990861]


portfolio before change:  [0.76891791]
curr_Stock_Price:  98.07697384324322
curr_Factors:  [98.07697384 -0.75855269 -1.04437862]
mat_Sqrt:  [[16.16456185  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0071797  -0.00608277 -0.0130019 ]
Stock Position:  0.0071797007560239845
Bond Position:  [0.06475458]


portfolio before change:  [0.76142738]
curr_Stock_Price:  97.03255394706214
curr_Factors:  [97.03255395 -0.90373278 -1.04385463]
mat_Sqrt:  [[13.83856299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00764009 -0.00429159  0.18025575]
Stock Position:  -0.007640088218631707
Bond Position:  [1.50276465]


portfolio before change:  [0.76087696]
curr_Stock_Price:  97.12918665393234
curr_Factors:  [97.12918665 -0.92418849 -1.06772038]
mat_Sqrt:  [[13.2517954   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00582216  0.00561139 -0.08056139]
Stock Position:  0.0058221559283738135
Bond Position:  [0.19537569]


portfolio before change:  [0.76328718]
curr_Stock_Price:  97.53896589776348
curr_Factors:  [97.5389659  -0.63128966 -1.07111775]
mat_Sqrt:  [[17.77591644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00565945 -0.01346695  0.83289328]
Stock Position:  0.005659446528689056
Bond Position:  [0.21127062]


portfolio before change:  [0.76320274]
curr_Stock_Price:  97.51937938092425
curr_Factors:  [97.51937938 -0.65606688 -1.03054919]
mat_Sqrt:  [[18.0552238   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01020968 -0.04099937 -0.15313769]
Stock Position:  -0.010209677216054584
Bond Position:  [1.75884412]


portfolio before change:  [0.75320426]
curr_Stock_Price:  98.52022905727856
curr_Factors:  [98.52022906 -0.68556265 -1.03044381]
mat_Sqrt:  [[17.71223142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00392537  0.0317796   0.50186872]
Stock Position:  -0.003925374820997682
Bond Position:  [1.13993308]


portfolio before change:  [0.75024663]
curr_Stock_Price:  99.30999471940538
curr_Factors:  [99.30999472 -0.81193784 -1.01069392]
mat_Sqrt:  [[16.0484851   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00064212 -0.01692628  0.10216474]
Stock Position:  0.0006421183550642818
Bond Position:  [0.68647786]


portfolio before change:  [0.75084981]
curr_Stock_Price:  100.1157159347583
curr_Factors:  [100.11571593  -1.13143713  -1.0171749 ]
mat_Sqrt:  [[11.67809249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00276567 0.01475956 0.14306569]
Stock Position:  0.002765671558787732
Bond Position:  [0.47396263]


portfolio before change:  [0.74884183]
curr_Stock_Price:  99.36825557334559
curr_Factors:  [99.36825557 -0.81134885 -1.03263679]
mat_Sqrt:  [[15.71863676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040094 -0.00505223 -0.20641739]
Stock Position:  -0.0004009426388438116
Bond Position:  [0.7886828]


portfolio before change:  [0.74917958]
curr_Stock_Price:  98.77177213879963
curr_Factors:  [98.77177214 -1.20554202 -1.02052913]
mat_Sqrt:  [[10.66258317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00466387  0.00574067 -0.13179285]
Stock Position:  -0.004663874835421368
Bond Position:  [1.20983876]


portfolio before change:  [0.75151091]
curr_Stock_Price:  98.30433034130114
curr_Factors:  [98.30433034 -1.51503691 -1.00051349]
mat_Sqrt:  [[ 7.94480045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01497687 -0.00860468  0.12648208]
Stock Position:  -0.01497686894565208
Bond Position:  [2.22380198]


portfolio before change:  [0.75541472]
curr_Stock_Price:  98.06223597922238
curr_Factors:  [98.06223598 -1.53818077 -0.9897336 ]
mat_Sqrt:  [[ 7.82785063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00504004 -0.00602329  0.01954288]
Stock Position:  0.005040042158837671
Bond Position:  [0.26117691]


portfolio before change:  [0.75715427]
curr_Stock_Price:  98.40090528465645
curr_Factors:  [98.40090528 -1.5175679  -0.98720263]
mat_Sqrt:  [[ 8.03879722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00984663 -0.00751687  0.18451581]
Stock Position:  -0.009846630507316772
Bond Position:  [1.72607163]


portfolio before change:  [0.76395387]
curr_Stock_Price:  97.73226791420241
curr_Factors:  [97.73226791 -1.30903905 -0.92327864]
mat_Sqrt:  [[10.48466898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01366574 -0.02118736 -0.21930362]
Stock Position:  -0.013665744256988716
Bond Position:  [2.09953805]


portfolio before change:  [0.76404493]
curr_Stock_Price:  97.74481027493255
curr_Factors:  [97.74481027 -1.13008003 -0.9226581 ]
mat_Sqrt:  [[12.5487614   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.19846798 0.45067344 0.46453435]
Stock Position:  0.198467982322258
Bond Position:  [-18.63517035]


portfolio before change:  [0.92375489]
curr_Stock_Price:  98.56126187719258
curr_Factors:  [98.56126188 -0.83722713 -0.89691255]
mat_Sqrt:  [[17.40119059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270617 -0.01910054 -0.02712006]
Stock Position:  -0.002706166344010003
Bond Position:  [1.19047806]


portfolio before change:  [0.92559876]
curr_Stock_Price:  97.93489469793253
curr_Factors:  [97.9348947  -0.85843758 -0.89856711]
mat_Sqrt:  [[16.89973983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00106696 -0.00461016 -0.15731973]
Stock Position:  0.0010669578733653918
Bond Position:  [0.82110636]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.92482422]
Stock Price:  97.1127577083252
PL:  [0.92482422]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-4.27061779e-02 -3.55987802e-02  3.07819849e-01]
 [ 4.52307791e-01  1.92497219e-01  1.12561818e-01]
 [-3.62906717e-01 -2.47577745e-01  4.03820944e-02]
 [ 1.72051397e-01  1.09076754e+00  1.06091875e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 5.31491839e-02  1.86499077e-02 -4.72428007e-03]
 [-5.08558376e-02 -4.14215503e-03 -7.16980698e-02]
 [ 1.10457046e-01  1.14637855e-01 -8.97608361e-02]
 [ 1.79903591e-02  6.10647780e-02 -4.59718608e-02]
 [-1.49736446e-01 -8.03862023e-02 -4.98736307e-02]
 [ 7.35562177e-01  1.42846035e+00 -2.53287187e-01]
 [ 4.21139119e-05 -2.49311976e-03 -4.20650277e-02]
 [-1.69435342e-01  5.30171749e-03 -3.21212204e-01]
 [ 1.63100418e+00 -2.86545490e+00  2.40769383e+00]
 [ 9.79595714e-03 -9.12881798e-02  3.51974988e-02]
 [ 3.40407191e-02  2.35242622e-01 -1.45477683e-01]
 [ 3.23257274e-02 -1.10366793e-01  2.07998566e-02]
 [-3.00966186e-01 -1.93050921e+00 -1.98778935e-01]
 [ 3.01073241e-02 -5.71057755e-02  2.51168585e-02]
 [-3.27346546e-01  2.10338386e-01 -6.71636396e-02]
 [ 1.69980986e-02  1.02875722e-01 -6.21577046e-02]
 [ 6.61137262e-02 -4.40415206e-02  1.38235768e-02]
 [ 4.21922321e-03 -1.15100990e-01 -1.15068031e-01]
 [-2.39723605e-01  7.68403851e-02  2.67140703e-02]
 [ 1.16593444e-01  1.56657080e-03 -4.10262997e-02]
 [ 4.28476119e-02 -4.28976365e-02  2.83179280e-01]
 [-1.95055866e-01 -1.28794592e-01 -7.29958017e-02]
 [-1.97176405e-01  1.42091536e-01  2.76358087e-01]
 [ 5.97062975e-02  2.67719569e-02  1.52314215e-01]
 [-1.05300070e-01  1.06025537e-01 -7.18864556e-03]
 [ 4.81007830e-02 -1.18725983e-02 -7.93196335e-02]
 [-3.35771606e-02  6.65012810e-03 -4.55832228e-02]
 [-5.52442491e-02 -7.36275152e-03  4.75082166e-02]
 [-7.58025983e-02 -7.52644368e-03 -3.43345304e-03]
 [-4.58899906e-02 -9.76725903e-03  3.04833732e-02]
 [-1.12192007e-01 -6.04365561e-02 -8.21641913e-02]
 [ 1.76609729e+00  1.15553607e+00  1.49622409e-01]
 [-2.12199482e-02 -1.06220695e-01 -3.76350218e-02]
 [ 3.45004743e-02 -1.36053006e-02 -9.60606697e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.13411113]
curr_Stock_Price:  99.24374583903148
curr_Factors:  [99.24374584 -0.71286575 -1.02622032]
mat_Sqrt:  [[17.43522938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.37628097e-04 -1.14894569e-02  8.78124349e-01]
Stock Position:  0.0007376280970981602
Bond Position:  [-3.2073161]


portfolio before change:  [-3.13478612]
curr_Stock_Price:  98.87220949729847
curr_Factors:  [98.8722095  -0.85853653 -1.02457987]
mat_Sqrt:  [[15.03997721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.034214   0.06212821 0.32110754]
Stock Position:  0.034213995069714016
Bond Position:  [-6.51759941]


portfolio before change:  [-3.12423863]
curr_Stock_Price:  99.20430309774203
curr_Factors:  [99.2043031  -0.58688206 -1.03040531]
mat_Sqrt:  [[19.68573028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02058346 -0.07990537  0.11519888]
Stock Position:  -0.020583455459150864
Bond Position:  [-1.08227127]


portfolio before change:  [-3.13958348]
curr_Stock_Price:  99.94322469700928
curr_Factors:  [99.9432247  -0.70405856 -1.02079179]
mat_Sqrt:  [[17.80985441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03432159 0.35204371 3.0265059 ]
Stock Position:  0.034321590067889166
Bond Position:  [-6.56979387]


portfolio before change:  [-3.10847112]
curr_Stock_Price:  100.87364879560376
curr_Factors:  [100.8736488   -0.77876382  -1.02908816]
mat_Sqrt:  [[16.54388849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00354487 -0.01106097 -0.05874131]
Stock Position:  -0.003544874046464368
Bond Position:  [-2.75088674]


portfolio before change:  [-3.11068749]
curr_Stock_Price:  101.40187341908035
curr_Factors:  [101.40187342  -0.68532782  -1.05458488]
mat_Sqrt:  [[17.79965127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00314567  0.00601923 -0.01347706]
Stock Position:  0.003145665041050683
Bond Position:  [-3.42966382]


portfolio before change:  [-3.11428436]
curr_Stock_Price:  100.3947312663713
curr_Factors:  [100.39473127  -0.6752449   -1.04103706]
mat_Sqrt:  [[18.04426242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367633 -0.00133687 -0.20453464]
Stock Position:  -0.0036763297455835804
Bond Position:  [-2.74520022]


portfolio before change:  [-3.1213669]
curr_Stock_Price:  102.22790923827101
curr_Factors:  [102.22790924  -0.84256271  -1.07790552]
mat_Sqrt:  [[14.98030733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00771246  0.03699921 -0.25606268]
Stock Position:  0.007712461639873536
Bond Position:  [-3.90979572]


portfolio before change:  [-3.13088857]
curr_Stock_Price:  101.05669775035912
curr_Factors:  [101.05669775  -0.78586142  -1.07465454]
mat_Sqrt:  [[15.72364711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013401   0.01970857 -0.13114492]
Stock Position:  0.0013400954459341363
Bond Position:  [-3.2663142]


portfolio before change:  [-3.13050294]
curr_Stock_Price:  101.64915339933859
curr_Factors:  [101.6491534   -0.85487361  -1.07136871]
mat_Sqrt:  [[14.80973739  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01190606 -0.02594454 -0.14227559]
Stock Position:  -0.011906060110427842
Bond Position:  [-1.92026201]


portfolio before change:  [-3.13634908]
curr_Stock_Price:  102.12001400128389
curr_Factors:  [102.120014    -0.89699815  -1.05739731]
mat_Sqrt:  [[14.46530857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06743329  0.46103359 -0.72255784]
Stock Position:  0.06743329319844532
Bond Position:  [-10.02263793]


portfolio before change:  [-3.23677027]
curr_Stock_Price:  100.64940107217579
curr_Factors:  [100.64940107  -0.70313545  -1.05639941]
mat_Sqrt:  [[17.32426882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052258 -0.00080465 -0.11999982]
Stock Position:  -0.000522577890522203
Bond Position:  [-3.18417311]


portfolio before change:  [-3.23771561]
curr_Stock_Price:  101.69669650926613
curr_Factors:  [101.69669651  -0.39631502  -1.0498914 ]
mat_Sqrt:  [[23.9456913   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00976878  0.00171112 -0.91632901]
Stock Position:  -0.00976878459920875
Bond Position:  [-2.24426248]


portfolio before change:  [-3.22581639]
curr_Stock_Price:  100.44989195992902
curr_Factors:  [100.44989196  -0.21773366  -1.06063593]
mat_Sqrt:  [[27.97438945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05496328 -0.92482159  6.86848034]
Stock Position:  0.05496327630137372
Bond Position:  [-8.74687156]


portfolio before change:  [-3.32581757]
curr_Stock_Price:  98.65036760347407
curr_Factors:  [98.6503676  -0.26196455 -1.04022492]
mat_Sqrt:  [[26.82656135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.16368664e-05 -2.94631333e-02  1.00408667e-01]
Stock Position:  -6.163686644815436e-05
Bond Position:  [-3.31973707]


portfolio before change:  [-3.326108]
curr_Stock_Price:  96.62947780913359
curr_Factors:  [ 9.66294778e+01  4.28807436e-02 -1.05108355e+00]
mat_Sqrt:  [[35.2575975   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148518  0.07592423 -0.41500734]
Stock Position:  0.001485180900109487
Bond Position:  [-3.46962026]


portfolio before change:  [-3.3283678]
curr_Stock_Price:  95.39995582299328
curr_Factors:  [ 9.53999558e+01  6.93352046e-02 -1.04621404e+00]
mat_Sqrt:  [[35.91658896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00039099 -0.03562073  0.0593362 ]
Stock Position:  0.00039098793989972855
Bond Position:  [-3.36566803]


portfolio before change:  [-3.32848056]
curr_Stock_Price:  96.18761847903507
curr_Factors:  [96.18761848  0.13355137 -1.04165125]
mat_Sqrt:  [[38.7914849   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01896306 -0.62306917 -0.56706097]
Stock Position:  -0.018963061365945652
Bond Position:  [-1.50446885]


portfolio before change:  [-3.33546956]
curr_Stock_Price:  96.54625904936258
curr_Factors:  [96.54625905  0.24025413 -1.04319321]
mat_Sqrt:  [[43.25371749  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0005451  -0.01843081  0.07165141]
Stock Position:  0.0005451002862230445
Bond Position:  [-3.38809695]


portfolio before change:  [-3.33757556]
curr_Stock_Price:  93.45973565923741
curr_Factors:  [93.45973566  0.36044282 -1.07193656]
mat_Sqrt:  [[45.8803523   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00649779  0.06788642 -0.19159917]
Stock Position:  -0.006497794984338449
Bond Position:  [-2.73029336]


portfolio before change:  [-3.34714043]
curr_Stock_Price:  94.87922667334908
curr_Factors:  [ 9.48792267e+01  9.05318144e-02 -1.07802692e+00]
mat_Sqrt:  [[35.34332958  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071611  0.033203   -0.17731863]
Stock Position:  0.0007161076607674618
Bond Position:  [-3.41508417]


portfolio before change:  [-3.34660923]
curr_Stock_Price:  96.21716948538668
curr_Factors:  [ 9.62171695e+01 -2.65603299e-03 -1.08153288e+00]
mat_Sqrt:  [[32.538334    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0018423  -0.01421434  0.03943482]
Stock Position:  0.00184230435016559
Bond Position:  [-3.52387054]


portfolio before change:  [-3.3506952]
curr_Stock_Price:  94.23842323069577
curr_Factors:  [94.23842323 -0.15005631 -1.0855387 ]
mat_Sqrt:  [[27.39150632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156121 -0.03714868 -0.32825706]
Stock Position:  -0.0015612077321865755
Bond Position:  [-3.20356944]


portfolio before change:  [-3.35099709]
curr_Stock_Price:  94.17528335220288
curr_Factors:  [94.17528335 -0.16652216 -1.07889855]
mat_Sqrt:  [[27.10551082  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00806425  0.02480013  0.07620781]
Stock Position:  -0.00806425091961802
Bond Position:  [-2.59154398]


portfolio before change:  [-3.35134551]
curr_Stock_Price:  94.17831547100425
curr_Factors:  [94.17831547 -0.17925546 -1.05477572]
mat_Sqrt:  [[27.41687716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00395883  0.00050561 -0.11703661]
Stock Position:  0.003958830167807865
Bond Position:  [-3.72418146]


portfolio before change:  [-3.34890026]
curr_Stock_Price:  94.91358202057951
curr_Factors:  [94.91358202 -0.17081584 -1.05541344]
mat_Sqrt:  [[27.84734246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00329995 -0.01384515  0.80783166]
Stock Position:  0.0032999521276849933
Bond Position:  [-3.66211054]


portfolio before change:  [-3.34713836]
curr_Stock_Price:  95.58622645754492
curr_Factors:  [95.58622646 -0.3700089  -1.05366606]
mat_Sqrt:  [[23.01977844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01026275 -0.04156828 -0.2082367 ]
Stock Position:  -0.010262746812177129
Bond Position:  [-2.36616112]


portfolio before change:  [-3.33866409]
curr_Stock_Price:  94.73167374410913
curr_Factors:  [94.73167374 -0.49385582 -1.04329915]
mat_Sqrt:  [[20.36654159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00548747  0.04585985  0.7883727 ]
Stock Position:  -0.005487467432812547
Bond Position:  [-2.81882712]


portfolio before change:  [-3.34856526]
curr_Stock_Price:  96.4717830399293
curr_Factors:  [96.47178304 -0.65782422 -1.03314369]
mat_Sqrt:  [[17.78370615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00541294 0.00864061 0.43451006]
Stock Position:  0.005412938591508575
Bond Position:  [-3.8707611]


portfolio before change:  [-3.3437572]
curr_Stock_Price:  97.44942892760552
curr_Factors:  [97.44942893 -0.59052212 -1.0394786 ]
mat_Sqrt:  [[19.09321129  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445839  0.03421959 -0.0205072 ]
Stock Position:  -0.004458394792049423
Bond Position:  [-2.90928917]


portfolio before change:  [-3.34645999]
curr_Stock_Price:  97.97408126103748
curr_Factors:  [97.97408126 -0.42230696 -1.049412  ]
mat_Sqrt:  [[22.4880489   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013112  -0.00383186 -0.22627684]
Stock Position:  0.0013111963045634501
Bond Position:  [-3.47492324]


portfolio before change:  [-3.34747391]
curr_Stock_Price:  97.53209937790055
curr_Factors:  [97.53209938 -0.46165769 -1.04218852]
mat_Sqrt:  [[21.67881131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191543  0.00214632 -0.13003625]
Stock Position:  -0.0019154346020933944
Bond Position:  [-3.16065755]


portfolio before change:  [-3.34791788]
curr_Stock_Price:  97.5576106532723
curr_Factors:  [97.55761065 -0.46037366 -1.04705372]
mat_Sqrt:  [[21.60696468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217752 -0.00237632  0.13552772]
Stock Position:  -0.0021775196573747936
Bond Position:  [-3.13548427]


portfolio before change:  [-3.34989101]
curr_Stock_Price:  98.2837423680801
curr_Factors:  [98.28374237 -0.6394195  -1.03104165]
mat_Sqrt:  [[18.49309596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421994 -0.00242915 -0.00979469]
Stock Position:  -0.004219941217219881
Bond Position:  [-2.93513939]


portfolio before change:  [-3.35651405]
curr_Stock_Price:  99.76625732289685
curr_Factors:  [99.76625732 -0.78133636 -1.04172416]
mat_Sqrt:  [[16.11530603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0025852  -0.00315237  0.08696058]
Stock Position:  -0.0025852026268783366
Bond Position:  [-3.09859806]


portfolio before change:  [-3.35895919]
curr_Stock_Price:  100.56224581406542
curr_Factors:  [100.56224581  -0.86786939  -1.06012516]
mat_Sqrt:  [[14.6257306   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00966107 -0.01950581 -0.23439157]
Stock Position:  -0.009661073769772967
Bond Position:  [-2.38741991]


portfolio before change:  [-3.35725288]
curr_Stock_Price:  100.35473724234777
curr_Factors:  [100.35473724  -0.86375709  -1.07937785]
mat_Sqrt:  [[14.37623275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.14137999 0.37294766 0.42683109]
Stock Position:  0.141379990277356
Bond Position:  [-17.54540465]


portfolio before change:  [-3.48136074]
curr_Stock_Price:  99.49241897983171
curr_Factors:  [99.49241898 -1.02933858 -1.07200189]
mat_Sqrt:  [[12.16716554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00415745 -0.03428258 -0.10736224]
Stock Position:  -0.004157449262046186
Bond Position:  [-3.06772606]


portfolio before change:  [-3.48735458]
curr_Stock_Price:  100.84188731805997
curr_Factors:  [100.84188732  -1.01824243  -1.05931319]
mat_Sqrt:  [[12.62903079  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009593  -0.00439109 -0.27403435]
Stock Position:  0.0009592978307101879
Bond Position:  [-3.58409198]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.48898237]
Stock Price:  99.61207620812176
PL:  [-3.48898237]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.20466586e-01 -3.01843922e-02 -8.18623219e-02]
 [ 1.30680831e+00  2.71245984e-01  3.93967188e-01]
 [ 1.15740968e-01  2.20692014e-01  4.02796855e-02]
 [ 9.58480380e-02  7.37052104e-01  6.10478065e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 5.23724929e-02 -3.72436403e-02  3.21228575e-02]
 [-3.21888650e-02 -1.19266517e-01  2.13006366e-03]
 [ 1.20135562e-01  1.11321135e-01 -1.01303164e-01]
 [ 1.69521313e-02  6.21883083e-02 -4.61425538e-02]
 [-4.57921294e-01  1.10714144e-01 -1.54615076e-01]
 [ 3.73961889e-01  7.67253393e-01 -1.21162604e-01]
 [ 1.37568956e-04  3.23040594e-02 -6.08256171e-02]
 [ 8.61687364e-02 -2.28026017e-02  4.72419608e-02]
 [ 1.40683862e+00 -2.74548854e+00  2.39251932e+00]
 [ 5.28551071e-02 -1.04573520e-01  6.35502556e-02]
 [ 1.70770306e-01 -1.45738725e-01  4.55144549e-02]
 [-3.42412561e-01 -6.16929616e-01  3.88743055e-02]
 [-2.40177249e-01 -1.58737200e+00 -1.99878018e-01]
 [-4.78375203e-03  3.73981650e-02  1.30617907e-01]
 [ 4.74458013e-01 -6.99233628e-01  3.11679028e-01]
 [ 6.69970145e-02  2.94930486e-01 -2.77474558e-01]
 [-3.91954270e-01 -4.69097777e-02 -2.34158732e-01]
 [ 4.70954053e-01  4.20989206e-01  4.04815035e-01]
 [ 4.89135427e-02  9.04552475e-02  1.77175309e-01]
 [-1.10941978e-01 -3.45655260e-01  1.21953251e-01]
 [ 1.82670203e-01 -5.33159666e-02 -1.99261510e-01]
 [ 4.19266062e-01  1.52543965e-02  2.94410584e-01]
 [-5.89869546e-02  6.06437364e-02  1.05827518e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 4.67859400e-01 -1.83145950e-01 -1.16682231e-01]
 [-2.12182786e-02 -1.00726469e-01 -8.87842809e-03]
 [-4.84292154e-02 -2.94321660e-02  3.01903584e-02]
 [-3.69839613e-02  1.24121396e-02 -7.61378224e-02]
 [ 5.46221568e-01  9.97484442e-02  1.59970644e-01]
 [ 1.35661377e-01  2.68614818e-01 -1.56369816e-01]
 [ 1.86122526e-02  3.15708149e-02  6.95274674e-02]
 [ 2.27188679e+00  1.59896291e+00  1.94065693e-01]
 [-1.13457983e-01  1.12842840e-02 -9.28470170e-03]
 [ 3.74934919e-02 -1.26828569e-02 -1.64911419e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.5717723]
curr_Stock_Price:  100.84114941456761
curr_Factors:  [100.84114941  -1.10879649  -0.99450426]
mat_Sqrt:  [[12.30795433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00792944 -0.00974197 -0.23353042]
Stock Position:  0.007929436797043363
Bond Position:  [7.77215878]


portfolio before change:  [8.57318713]
curr_Stock_Price:  100.89704863566055
curr_Factors:  [100.89704864  -0.89915819  -1.01058375]
mat_Sqrt:  [[14.94473019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09652863 0.08754426 1.12387873]
Stock Position:  0.09652863305296651
Bond Position:  [-1.16626706]


portfolio before change:  [8.6340459]
curr_Stock_Price:  101.52903283087223
curr_Factors:  [101.52903283  -1.10056216  -1.04710957]
mat_Sqrt:  [[11.85409122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01425766 0.07122804 0.11490673]
Stock Position:  0.014257659247997911
Bond Position:  [7.18647955]


portfolio before change:  [8.63468911]
curr_Stock_Price:  101.51113676552326
curr_Factors:  [101.51113677  -0.81594969  -1.02965456]
mat_Sqrt:  [[16.03164006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02313622 0.23788254 1.741524  ]
Stock Position:  0.023136215668394064
Bond Position:  [6.28610556]


portfolio before change:  [8.62155298]
curr_Stock_Price:  100.90939857186925
curr_Factors:  [100.90939857  -0.8413014   -1.01188679]
mat_Sqrt:  [[15.81620228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00370797 -0.01106097 -0.05874131]
Stock Position:  -0.0037079698336163797
Bond Position:  [8.99572199]


portfolio before change:  [8.62209838]
curr_Stock_Price:  101.06558696121887
curr_Factors:  [101.06558696  -0.91324061  -1.00873882]
mat_Sqrt:  [[14.7876186   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00347096 -0.01202033  0.09163757]
Stock Position:  0.0034709589765932955
Bond Position:  [8.27130387]


portfolio before change:  [8.62797839]
curr_Stock_Price:  102.46175280169126
curr_Factors:  [102.4617528   -0.97976606  -1.04265917]
mat_Sqrt:  [[13.55918742  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00413736 -0.0384931   0.00607648]
Stock Position:  -0.004137360280601507
Bond Position:  [9.05189957]


portfolio before change:  [8.62958277]
curr_Stock_Price:  102.34747063314045
curr_Factors:  [102.34747063  -0.93304626  -1.04773083]
mat_Sqrt:  [[14.12006048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00865297  0.03592874 -0.28898973]
Stock Position:  0.0086529708635789
Bond Position:  [7.74397309]


portfolio before change:  [8.63497112]
curr_Stock_Price:  102.85831182715768
curr_Factors:  [102.85831183  -0.89412422  -1.04056274]
mat_Sqrt:  [[14.85988738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00136121  0.02007119 -0.13163186]
Stock Position:  0.0013612120114374648
Bond Position:  [8.49495915]


portfolio before change:  [8.63806717]
curr_Stock_Price:  104.3526511497754
curr_Factors:  [104.35265115  -0.86711009  -1.04386444]
mat_Sqrt:  [[15.43752924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03024335  0.03573284 -0.44107378]
Stock Position:  -0.030243345723930604
Bond Position:  [11.79404048]


portfolio before change:  [8.6021014]
curr_Stock_Price:  105.59061322923023
curr_Factors:  [105.59061323  -0.82913613  -1.04225151]
mat_Sqrt:  [[16.2514451   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03112613  0.24762997 -0.34564318]
Stock Position:  0.031126131585306794
Bond Position:  [5.31547408]


portfolio before change:  [8.61882669]
curr_Stock_Price:  106.10660446892813
curr_Factors:  [106.10660447  -0.68053276  -1.03500033]
mat_Sqrt:  [[19.08516249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00029784  0.01042609 -0.17351855]
Stock Position:  -0.00029784234820030744
Bond Position:  [8.65042973]


portfolio before change:  [8.61975135]
curr_Stock_Price:  106.63275947675288
curr_Factors:  [106.63275948  -0.73942827  -1.03812354]
mat_Sqrt:  [[18.02642923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00505688 -0.00735951  0.13476816]
Stock Position:  0.005056875021868594
Bond Position:  [8.08052281]


portfolio before change:  [8.62092029]
curr_Stock_Price:  106.66416378414493
curr_Factors:  [106.66416378  -0.92178057  -1.062047  ]
mat_Sqrt:  [[14.67077868  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09098284 -0.88610262  6.82519168]
Stock Position:  0.09098283815486875
Bond Position:  [-1.08368806]


portfolio before change:  [8.64339248]
curr_Stock_Price:  106.91264654934336
curr_Factors:  [106.91264655  -0.894411    -1.05713874]
mat_Sqrt:  [[15.18734291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00292884 -0.03375096  0.18129119]
Stock Position:  0.0029288380931557024
Bond Position:  [8.33026265]


portfolio before change:  [8.64597643]
curr_Stock_Price:  107.4393405079821
curr_Factors:  [107.43934051  -0.82023895  -1.07582974]
mat_Sqrt:  [[16.13285253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00931714 -0.04703697  0.12984007]
Stock Position:  0.00931714412346436
Bond Position:  [7.64494861]


portfolio before change:  [8.65350334]
curr_Stock_Price:  108.14462379023135
curr_Factors:  [108.14462379  -1.10463772  -1.04798517]
mat_Sqrt:  [[12.5641379   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03664458 -0.19911318  0.11089757]
Stock Position:  -0.03664458405936802
Bond Position:  [12.6164181]


portfolio before change:  [8.64836653]
curr_Stock_Price:  108.32784217108612
curr_Factors:  [108.32784217  -1.04172609  -1.03750089]
mat_Sqrt:  [[13.54388608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04466946 -0.51232211 -0.57019635]
Stock Position:  -0.04466946392705406
Bond Position:  [13.48731317]


portfolio before change:  [8.6692542]
curr_Stock_Price:  107.89798135858453
curr_Factors:  [107.89798136  -0.9486258   -1.04501476]
mat_Sqrt:  [[14.6955628   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00200825 0.01207021 0.37261653]
Stock Position:  0.0020082514378011312
Bond Position:  [8.45256792]


portfolio before change:  [8.67148089]
curr_Stock_Price:  108.48060298173785
curr_Factors:  [108.48060298  -0.66167228  -1.0434341 ]
mat_Sqrt:  [[19.71668051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02005149 -0.22567668  0.88913351]
Stock Position:  0.020051486948854245
Bond Position:  [6.49628349]


portfolio before change:  [8.65414222]
curr_Stock_Price:  107.57539560484648
curr_Factors:  [107.5753956   -0.41944727  -1.06262888]
mat_Sqrt:  [[24.43742613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00288738  0.09518841 -0.79155768]
Stock Position:  0.002887382267639615
Bond Position:  [8.34353093]


portfolio before change:  [8.65318229]
curr_Stock_Price:  106.88171073289122
curr_Factors:  [106.88171073  -0.48643541  -1.056854  ]
mat_Sqrt:  [[22.83817099  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01967439 -0.01514007 -0.66798969]
Stock Position:  -0.019674392472094397
Bond Position:  [10.75601502]


portfolio before change:  [8.64844137]
curr_Stock_Price:  107.19102179445375
curr_Factors:  [107.19102179  -0.55521495  -1.07254409]
mat_Sqrt:  [[21.04900829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03038246 0.13587368 1.15482462]
Stock Position:  0.030382459330993056
Bond Position:  [5.39171451]


portfolio before change:  [8.64611088]
curr_Stock_Price:  107.09213248452974
curr_Factors:  [107.09213248  -0.53422695  -1.08785621]
mat_Sqrt:  [[21.14929057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00489583 0.02919431 0.50543184]
Stock Position:  0.004895833312963233
Bond Position:  [8.12180565]


portfolio before change:  [8.63926601]
curr_Stock_Price:  105.48665433090005
curr_Factors:  [105.48665433  -0.46075347  -1.06210874]
mat_Sqrt:  [[23.00524502  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00680736 -0.11155976  0.34789868]
Stock Position:  -0.006807358900610601
Bond Position:  [9.35735153]


portfolio before change:  [8.63339774]
curr_Stock_Price:  106.52053795835761
curr_Factors:  [106.52053796  -0.30713898  -1.0611636 ]
mat_Sqrt:  [[27.11359422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00483569 -0.01720765 -0.56843763]
Stock Position:  0.004835693873302373
Bond Position:  [8.11829703]


portfolio before change:  [8.63699618]
curr_Stock_Price:  107.05481387613324
curr_Factors:  [107.05481388  -0.22124465  -1.03669415]
mat_Sqrt:  [[30.42918477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0158557  0.00492334 0.83987145]
Stock Position:  0.015855704491218578
Bond Position:  [6.93956669]


portfolio before change:  [8.65078563]
curr_Stock_Price:  107.86978539694775
curr_Factors:  [107.8697854   -0.49555175  -1.04284082]
mat_Sqrt:  [[23.16244537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010796   0.01957268  0.30189645]
Stock Position:  -0.00107959896801932
Bond Position:  [8.76724174]


portfolio before change:  [8.65323627]
curr_Stock_Price:  106.61500457744059
curr_Factors:  [106.61500458  -0.64987907  -1.05771409]
mat_Sqrt:  [[19.32947425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017786  -0.02600141 -0.03673698]
Stock Position:  -0.0017786029393381025
Bond Position:  [8.84286203]


portfolio before change:  [8.65129262]
curr_Stock_Price:  108.32931414745475
curr_Factors:  [108.32931415  -0.77833405  -1.0655015 ]
mat_Sqrt:  [[17.13872028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0237274  -0.0591101  -0.33286193]
Stock Position:  0.02372739753130716
Bond Position:  [6.08091991]


portfolio before change:  [8.63560276]
curr_Stock_Price:  107.63602218888163
curr_Factors:  [107.63602219  -0.83828238  -1.03801091]
mat_Sqrt:  [[16.48518466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264427 -0.03250933 -0.02532768]
Stock Position:  -0.0026442703221717105
Bond Position:  [8.9202215]


portfolio before change:  [8.63860324]
curr_Stock_Price:  106.92301644326965
curr_Factors:  [106.92301644  -0.87304822  -1.05136411]
mat_Sqrt:  [[15.60664491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0030932  -0.00949919  0.08612469]
Stock Position:  -0.0030931984581703035
Bond Position:  [8.96933735]


portfolio before change:  [8.64147619]
curr_Stock_Price:  106.35670518116373
curr_Factors:  [106.35670518  -0.90895441  -1.02507252]
mat_Sqrt:  [[15.37544343  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325141  0.004006   -0.21720001]
Stock Position:  -0.003251412685699935
Bond Position:  [8.98728573]


portfolio before change:  [8.640932]
curr_Stock_Price:  106.86961375900928
curr_Factors:  [106.86961376  -0.77546556  -1.01400097]
mat_Sqrt:  [[17.85249006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03356599 0.03219367 0.45635172]
Stock Position:  0.033565990130392916
Bond Position:  [5.05374759]


portfolio before change:  [8.66768954]
curr_Stock_Price:  107.64795468801384
curr_Factors:  [107.64795469  -0.71252557  -1.00182511]
mat_Sqrt:  [[19.3853095   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00818008  0.08669506 -0.44607956]
Stock Position:  0.008180075306744035
Bond Position:  [7.78712116]


portfolio before change:  [8.6561669]
curr_Stock_Price:  106.12032906680976
curr_Factors:  [106.12032907  -0.95178307  -1.00166631]
mat_Sqrt:  [[15.04618175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00260856 0.01018944 0.19834251]
Stock Position:  0.0026085590186472915
Bond Position:  [8.37934575]


portfolio before change:  [8.65600822]
curr_Stock_Price:  105.65794537539918
curr_Factors:  [105.65794538  -1.18471867  -1.03125495]
mat_Sqrt:  [[11.52171277  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.22894923 0.51606306 0.5536154 ]
Stock Position:  0.2289492261072652
Bond Position:  [-15.5342966]


portfolio before change:  [8.72198279]
curr_Stock_Price:  105.95458961537157
curr_Factors:  [105.95458962  -1.18385955  -1.03088059]
mat_Sqrt:  [[11.56832154  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00977236  0.00364199 -0.02648667]
Stock Position:  -0.009772361509735001
Bond Position:  [9.75740934]


portfolio before change:  [8.7226472]
curr_Stock_Price:  106.01141706141357
curr_Factors:  [106.01141706  -1.3065506   -1.0081291 ]
mat_Sqrt:  [[10.47369734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.18603022e-04 -4.09337447e-03 -4.70446376e-01]
Stock Position:  0.00011860302237419507
Bond Position:  [8.71007392]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.72374214]
Stock Price:  106.06296706998529
PL:  [2.66077507]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-1.49919327e-02 -1.08458096e-01  1.14655174e-01]
 [ 1.09373311e+00  2.25419460e-01  3.12699791e-01]
 [-3.06461984e-01 -1.95621534e-01  3.87356820e-02]
 [ 1.77197600e-01  1.19758404e+00  1.10699007e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 5.82087425e-02 -5.19015640e-02  4.08913484e-02]
 [-4.91545354e-02 -1.03509692e-02 -7.24804915e-02]
 [ 1.17307739e-01  1.11885559e-01 -9.78933354e-02]
 [ 2.05027243e-02  5.83459928e-02 -4.55588078e-02]
 [-5.07789360e-01  1.45462420e-01 -1.70480405e-01]
 [ 3.50091219e-01  7.13288643e-01 -1.15039534e-01]
 [ 3.16973294e-05  2.69512036e-02 -5.87612873e-02]
 [ 9.32293657e-02 -2.52964478e-02  4.85394219e-02]
 [ 1.48667549e+00 -2.89215415e+00  2.49972040e+00]
 [ 5.07969914e-02 -1.04247330e-01  6.26883766e-02]
 [ 1.66398261e-01 -1.27900699e-01  3.83255459e-02]
 [-2.03475012e-01 -3.19127210e-01 -1.55221399e-02]
 [-2.52129866e-01 -1.66868515e+00 -2.04662724e-01]
 [ 3.29092682e-04  3.45115985e-02  7.47724313e-02]
 [ 3.92878296e-01 -5.88861480e-01  2.81048057e-01]
 [ 5.89148852e-02  1.40109791e-01 -7.52921941e-02]
 [ 1.39703794e-01 -5.34636160e-02 -1.42114814e-02]
 [ 3.05378705e-01  1.21071438e-01  1.76167797e-01]
 [-1.14377580e-01 -1.44138339e-02  6.36392055e-02]
 [ 2.58488071e-03 -1.39013365e-01  4.02097075e-02]
 [ 5.36311875e-02 -5.40878830e-03  1.84367501e-01]
 [ 1.24630382e-01 -9.68672392e-02  5.18862568e-02]
 [-9.43733334e-02  6.56117477e-02  1.39109177e-01]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 1.07271528e-02  3.08023429e-02  1.04983263e-01]
 [ 4.52421436e-03 -1.66872100e-02 -7.10105305e-02]
 [-6.40502606e-03  1.96425722e-02 -5.69974840e-02]
 [-1.18069121e-01 -3.87448071e-02  2.12500833e-02]
 [ 3.53469319e-01  3.17682733e-02  6.26368883e-02]
 [ 7.57792717e-02  1.33859252e-01 -8.72017284e-02]
 [-6.56219404e-02 -6.89407858e-03 -7.30158711e-02]
 [ 2.14554201e+00  1.45650300e+00  1.76784480e-01]
 [-7.98994219e-02 -1.59253590e-02 -2.02329912e-02]
 [ 3.68454890e-02 -1.29199565e-02 -1.48314096e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.58189704]
curr_Stock_Price:  99.18264025724297
curr_Factors:  [99.18264026 -0.97816375 -1.01933392]
mat_Sqrt:  [[13.45654123  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010201 -0.0350047  0.3270793]
Stock Position:  -0.0010200956659966935
Bond Position:  [-3.48072126]


portfolio before change:  [-3.58323376]
curr_Stock_Price:  100.06647631874765
curr_Factors:  [100.06647632  -1.16665402  -1.0179583 ]
mat_Sqrt:  [[11.25961472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.1068932  0.07275382 0.89204547]
Stock Position:  0.10689319964464812
Bond Position:  [-14.27965959]


portfolio before change:  [-3.64067287]
curr_Stock_Price:  99.54582535069967
curr_Factors:  [99.54582535 -0.9307431  -1.02143677]
mat_Sqrt:  [[14.13195034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02395184 -0.06313658  0.11050212]
Stock Position:  -0.02395183723782557
Bond Position:  [-1.25636747]


portfolio before change:  [-3.64715929]
curr_Stock_Price:  99.81007922625518
curr_Factors:  [99.81007923 -0.83382553 -1.02467214]
mat_Sqrt:  [[15.56105799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04161779 0.38651859 3.15793453]
Stock Position:  0.041617788495190496
Bond Position:  [-7.80103406]


portfolio before change:  [-3.64934244]
curr_Stock_Price:  99.78105434624356
curr_Factors:  [99.78105435 -0.88300267 -1.01625858]
mat_Sqrt:  [[14.93514387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00392671 -0.01106097 -0.05874131]
Stock Position:  -0.003926711484014777
Bond Position:  [-3.25753102]


portfolio before change:  [-3.6550093]
curr_Stock_Price:  101.12050845565584
curr_Factors:  [101.12050846  -1.01410364  -1.01437833]
mat_Sqrt:  [[13.30089046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00420733 -0.01675116  0.11665164]
Stock Position:  0.004207334227285735
Bond Position:  [-4.08045708]


portfolio before change:  [-3.65600905]
curr_Stock_Price:  101.00412539515054
curr_Factors:  [101.0041254   -0.77476154  -0.99778557]
mat_Sqrt:  [[17.16056896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00384966 -0.00334076 -0.20676667]
Stock Position:  -0.0038496646934694156
Bond Position:  [-3.26717704]


portfolio before change:  [-3.66173281]
curr_Stock_Price:  102.38485117948836
curr_Factors:  [102.38485118  -0.83432289  -1.02619008]
mat_Sqrt:  [[15.9303452   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00754308  0.03611091 -0.27926244]
Stock Position:  0.007543081372163717
Bond Position:  [-4.43403007]


portfolio before change:  [-3.6548885]
curr_Stock_Price:  103.36569606546605
curr_Factors:  [103.36569607  -0.84310064  -1.02386544]
mat_Sqrt:  [[15.97950668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144641  0.01883109 -0.1299666 ]
Stock Position:  0.001446408699883166
Bond Position:  [-3.80439755]


portfolio before change:  [-3.65332448]
curr_Stock_Price:  104.77581269554504
curr_Factors:  [104.7758127   -1.1202367   -1.01952908]
mat_Sqrt:  [[12.33026952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04159651  0.04694779 -0.48633314]
Stock Position:  -0.041596506368306335
Bond Position:  [0.70498328]


portfolio before change:  [-3.67085483]
curr_Stock_Price:  105.19936937695508
curr_Factors:  [105.19936938  -1.21198089  -1.01541995]
mat_Sqrt:  [[11.34136277  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04163594  0.23021292 -0.32817577]
Stock Position:  0.04163594065845463
Bond Position:  [-8.05092953]


portfolio before change:  [-3.66095563]
curr_Stock_Price:  105.46129752666911
curr_Factors:  [105.46129753  -0.99226445  -1.02288158]
mat_Sqrt:  [[14.05808977  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045963  0.00869846 -0.1676296 ]
Stock Position:  -0.00045962921911944104
Bond Position:  [-3.61248254]


portfolio before change:  [-3.66128154]
curr_Stock_Price:  105.18787001178066
curr_Factors:  [105.18787001  -0.79536989  -1.05243146]
mat_Sqrt:  [[16.57584708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00591064 -0.00816439  0.13846946]
Stock Position:  0.005910637170199599
Bond Position:  [-4.28300888]


portfolio before change:  [-3.65817582]
curr_Stock_Price:  105.80390155609608
curr_Factors:  [105.80390156  -1.10125076  -1.01502115]
mat_Sqrt:  [[12.74724896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11034305 -0.93343874  7.13100652]
Stock Position:  0.11034304680793042
Bond Position:  [-15.33290068]


portfolio before change:  [-3.55895541]
curr_Stock_Price:  106.72047168693668
curr_Factors:  [106.72047169  -0.94625932  -1.02590833]
mat_Sqrt:  [[14.85067544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00284928 -0.03364568  0.17883249]
Stock Position:  0.0028492849206481425
Bond Position:  [-3.86303244]


portfolio before change:  [-3.56038429]
curr_Stock_Price:  106.38846794601413
curr_Factors:  [106.38846795  -0.59332362  -1.02987321]
mat_Sqrt:  [[20.98694045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00705743 -0.04127977  0.10933211]
Stock Position:  0.007057427432766511
Bond Position:  [-4.31121318]


portfolio before change:  [-3.57779809]
curr_Stock_Price:  103.99738876867407
curr_Factors:  [103.99738877  -0.25859027  -1.03042619]
mat_Sqrt:  [[28.65561273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00948453 -0.10299786 -0.04428034]
Stock Position:  -0.009484530221370987
Bond Position:  [-2.59143172]


portfolio before change:  [-3.59738973]
curr_Stock_Price:  106.02887422362272
curr_Factors:  [106.02887422  -0.49394282  -1.04495166]
mat_Sqrt:  [[22.75572972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0278842  -0.53856582 -0.58384578]
Stock Position:  -0.02788420358820232
Bond Position:  [-0.64085901]


portfolio before change:  [-3.61475393]
curr_Stock_Price:  106.64872663981173
curr_Factors:  [106.64872664  -0.73318744  -1.04391968]
mat_Sqrt:  [[18.03714758  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.001255   0.01113857 0.21330493]
Stock Position:  0.001254998981724202
Bond Position:  [-3.74859797]


portfolio before change:  [-3.61527686]
curr_Stock_Price:  106.60543639725238
curr_Factors:  [106.6054364   -0.71711553  -1.0220236 ]
mat_Sqrt:  [[18.72754388  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01762357 -0.19005423  0.80175188]
Stock Position:  0.017623568083376746
Bond Position:  [-5.49404503]


portfolio before change:  [-3.65478668]
curr_Stock_Price:  104.40253291655145
curr_Factors:  [104.40253292  -0.60036444  -1.01998927]
mat_Sqrt:  [[20.65381861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349309  0.04522024 -0.21478767]
Stock Position:  0.003493093613978699
Bond Position:  [-4.0194745]


portfolio before change:  [-3.66476114]
curr_Stock_Price:  101.69089843676063
curr_Factors:  [101.69089844  -0.5625329   -1.02282379]
mat_Sqrt:  [[20.8338927   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00604254 -0.01725531 -0.0405414 ]
Stock Position:  0.006042542035701954
Bond Position:  [-4.27923267]


portfolio before change:  [-3.66768223]
curr_Stock_Price:  101.29600681399707
curr_Factors:  [101.29600681  -0.5008867   -1.01057379]
mat_Sqrt:  [[22.34464068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01638211 0.03907564 0.50255769]
Stock Position:  0.016382112144048635
Bond Position:  [-5.32712477]


portfolio before change:  [-3.68215909]
curr_Stock_Price:  100.45295723974849
curr_Factors:  [100.45295724  -0.48283094  -0.97928344]
mat_Sqrt:  [[23.27954661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448159 -0.00465204  0.18154494]
Stock Position:  -0.00448159472919687
Bond Position:  [-3.23196965]


portfolio before change:  [-3.68285943]
curr_Stock_Price:  100.51907485860613
curr_Factors:  [100.51907486  -0.54825106  -1.01727943]
mat_Sqrt:  [[21.00618723  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083705 -0.04486637  0.1147071 ]
Stock Position:  -0.0008370548764251482
Bond Position:  [-3.59871944]


portfolio before change:  [-3.68328627]
curr_Stock_Price:  100.49157051305116
curr_Factors:  [100.49157051  -0.33177249  -1.02496041]
mat_Sqrt:  [[25.8766482   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00348426 -0.00174568  0.52594916]
Stock Position:  0.0034842604465462634
Bond Position:  [-4.03342508]


portfolio before change:  [-3.68268821]
curr_Stock_Price:  100.80792777550266
curr_Factors:  [100.80792778  -0.4814943   -1.02066089]
mat_Sqrt:  [[22.44486398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00514366 -0.03126377  0.14801705]
Stock Position:  0.0051436568022534
Bond Position:  [-4.20120959]


portfolio before change:  [-3.68684891]
curr_Stock_Price:  100.10113225529618
curr_Factors:  [100.10113226  -0.77613249  -1.03190359]
mat_Sqrt:  [[16.41416884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320363  0.0211761   0.39683976]
Stock Position:  -0.00320362548310406
Bond Position:  [-3.36616237]


portfolio before change:  [-3.69131633]
curr_Stock_Price:  101.36427271275227
curr_Factors:  [101.36427271  -0.88117478  -1.03312018]
mat_Sqrt:  [[14.9457312   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00147862 -0.02321455 -0.0028026 ]
Stock Position:  -0.0014786183508027763
Bond Position:  [-3.54143726]


portfolio before change:  [-3.69192886]
curr_Stock_Price:  101.47912172805853
curr_Factors:  [101.47912173  -0.78850222  -1.02185984]
mat_Sqrt:  [[16.60146625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00231572 0.00994141 0.29948803]
Stock Position:  0.0023157155493035452
Bond Position:  [-3.92692564]


portfolio before change:  [-3.6967284]
curr_Stock_Price:  99.61851289133494
curr_Factors:  [99.61851289 -0.51085022 -0.98575511]
mat_Sqrt:  [[22.3034793   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00059977 -0.00538577 -0.20257328]
Stock Position:  -0.0005997724290408903
Bond Position:  [-3.63697996]


portfolio before change:  [-3.69763527]
curr_Stock_Price:  100.37249824237907
curr_Factors:  [100.37249824  -0.39423202  -0.99352514]
mat_Sqrt:  [[25.05644518  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055994  0.00633961 -0.16259796]
Stock Position:  -0.0005599383872493481
Bond Position:  [-3.64143285]


portfolio before change:  [-3.69939187]
curr_Stock_Price:  102.6966846386879
curr_Factors:  [102.69668464  -0.31057358  -0.99551751]
mat_Sqrt:  [[27.81815146  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00437269 -0.01250483  0.06062057]
Stock Position:  -0.004372692284161568
Bond Position:  [-3.25033087]


portfolio before change:  [-3.70294521]
curr_Stock_Price:  103.41638292112329
curr_Factors:  [103.41638292  -0.22734384  -1.01910358]
mat_Sqrt:  [[29.73473734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0125355  0.01025317 0.17868561]
Stock Position:  0.012535496366532853
Bond Position:  [-4.9993209]


portfolio before change:  [-3.68957953]
curr_Stock_Price:  104.53246397323716
curr_Factors:  [104.53246397  -0.5220791   -1.00305149]
mat_Sqrt:  [[22.74549462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00375033  0.04320289 -0.24876226]
Stock Position:  0.003750333868400583
Bond Position:  [-4.08161117]


portfolio before change:  [-3.69207542]
curr_Stock_Price:  104.00300282475933
curr_Factors:  [104.00300282  -0.69766601  -1.01270184]
mat_Sqrt:  [[18.8036673   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435731 -0.00222505 -0.20829396]
Stock Position:  -0.004357314413367341
Bond Position:  [-3.23890164]


portfolio before change:  [-3.68898523]
curr_Stock_Price:  103.20088419048105
curr_Factors:  [103.20088419  -0.57407206  -1.01497253]
mat_Sqrt:  [[21.06542011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11767795 0.47008432 0.50431691]
Stock Position:  0.11767794847301784
Bond Position:  [-15.83345356]


portfolio before change:  [-3.56823657]
curr_Stock_Price:  104.24379805799414
curr_Factors:  [104.24379806  -0.52995139  -1.0230586 ]
mat_Sqrt:  [[22.05903739  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00395666 -0.00513989 -0.05771909]
Stock Position:  -0.003956664685547485
Bond Position:  [-3.15577882]


portfolio before change:  [-3.56965722]
curr_Stock_Price:  104.50314521971136
curr_Factors:  [104.50314522  -0.52240619  -1.000298  ]
mat_Sqrt:  [[22.79435636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.72574552e-04 -4.16989803e-03 -4.23098833e-01]
Stock Position:  0.00017257455247297792
Bond Position:  [-3.5876918]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.57003597]
Stock Price:  104.90726110315657
PL:  [-8.47729707]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.77591493e-02 -4.78801653e-02  1.49598602e-01]
 [ 1.15581867e+00  2.37576315e-01  3.27044904e-01]
 [-1.27841734e-01 -3.09384540e-02  3.36591601e-02]
 [ 1.11654020e-01  9.96037055e-01  7.33758564e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.51560061e-02 -6.73247978e-02  5.41661632e-02]
 [-3.48088163e-02 -1.02163352e-01 -1.11179051e-02]
 [ 1.22324189e-01  4.14183325e-02 -9.91324724e-02]
 [-7.41441701e-03  8.85568515e-02 -5.01486097e-02]
 [-4.02426671e-01 -9.77090024e-03 -1.60121807e-01]
 [ 7.51406784e-01  1.45455606e+00 -2.59801478e-01]
 [ 2.26694299e-05  1.73772999e-02 -5.83228438e-02]
 [-2.07205371e-01 -1.72462707e-03 -4.04516976e-01]
 [ 1.53892777e+00 -2.95698015e+00  2.49416444e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.39302710e-01 -8.80679747e-02  2.48164012e-02]
 [-1.08966246e-01 -1.10404941e-01 -4.48350175e-02]
 [-2.67357027e-01 -1.73475559e+00 -1.97205148e-01]
 [-9.16461462e-03  3.97034900e-02  1.80791814e-01]
 [ 2.53423238e-01 -6.38324124e-02  4.41795927e-01]
 [ 6.30990455e-02 -1.69225803e-01 -2.99353245e-02]
 [ 1.32975560e-01 -5.27302404e-02 -1.13742345e-02]
 [ 1.04378723e-02  1.33211514e-01  7.08557271e-02]
 [ 1.18339890e-01 -2.05211523e-01 -1.70413282e-01]
 [ 1.68581972e-02 -5.47090773e-02  1.52760796e-02]
 [-5.01838945e-03 -3.26957210e-02  1.85807620e-01]
 [ 4.13603546e-01 -1.09881538e-01  1.82374374e-01]
 [ 6.89666790e-03 -1.00300934e-01 -1.40670319e-02]
 [ 7.15437850e-04 -6.50312083e-02  1.40167189e-02]
 [ 6.94873398e-02 -4.90788911e-05  6.44426778e-02]
 [-1.09972940e-02 -1.74237742e-02 -6.79961444e-02]
 [-6.79880591e-02  1.78762974e-02 -3.19920770e-02]
 [-7.18608208e-02 -4.29297585e-02  3.39732372e-02]
 [ 2.38870186e-01  1.81677914e-02  4.76686485e-02]
 [-8.28665789e-02 -5.17296124e-02  7.54686204e-02]
 [-1.15218689e-01 -6.35207155e-02 -8.24089546e-02]
 [ 2.91518586e+00  1.85748617e+00  1.91034685e-01]
 [-1.03853737e-03 -1.89113445e-01 -6.92978586e-02]
 [ 3.31934303e-02 -1.34834845e-02 -7.07294184e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.23813551]
curr_Stock_Price:  100.52269760668702
curr_Factors:  [100.52269761  -0.87903098  -1.00310791]
mat_Sqrt:  [[15.30599624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00251681 -0.01545326  0.42676317]
Stock Position:  0.0025168135187124386
Bond Position:  [5.98513863]


portfolio before change:  [6.23914451]
curr_Stock_Price:  100.62632384375694
curr_Factors:  [100.62632384  -0.82011872  -1.01503466]
mat_Sqrt:  [[16.05885664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07915081 0.07667743 0.93296808]
Stock Position:  0.07915080875707672
Bond Position:  [-1.7255104]


portfolio before change:  [6.26602163]
curr_Stock_Price:  100.96861748184286
curr_Factors:  [100.96861748  -1.16108539  -1.0182405 ]
mat_Sqrt:  [[11.4213437   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01114461 -0.00998534  0.09602021]
Stock Position:  -0.011144605733221824
Bond Position:  [7.39127706]


portfolio before change:  [6.26449783]
curr_Stock_Price:  101.18825417487604
curr_Factors:  [101.18825417  -1.40510834  -1.04006379]
mat_Sqrt:  [[ 8.77415572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05296773 0.32146958 2.09320894]
Stock Position:  0.05296772557415018
Bond Position:  [0.90478615]


portfolio before change:  [6.27054736]
curr_Stock_Price:  101.30033036962679
curr_Factors:  [101.30033037  -1.24549439  -1.03107317]
mat_Sqrt:  [[10.39704992  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00564064 -0.01106097 -0.05874131]
Stock Position:  -0.005640638582984614
Bond Position:  [6.84194591]


portfolio before change:  [6.27084119]
curr_Stock_Price:  101.39987012792062
curr_Factors:  [101.39987013  -1.43591837  -1.0313213 ]
mat_Sqrt:  [[ 8.60060152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00726345 -0.02172899  0.15452099]
Stock Position:  0.007263446743820746
Bond Position:  [5.53432863]


portfolio before change:  [6.27462067]
curr_Stock_Price:  101.82496504332906
curr_Factors:  [101.82496504  -1.59841898  -1.04043645]
mat_Sqrt:  [[ 7.2746804   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00796355 -0.03297308 -0.03171629]
Stock Position:  -0.00796354654197522
Bond Position:  [7.08550852]


portfolio before change:  [6.27612483]
curr_Stock_Price:  101.74730939386424
curr_Factors:  [101.74730939  -1.51491783  -1.05115182]
mat_Sqrt:  [[ 7.81795283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01413968  0.01336771 -0.28279735]
Stock Position:  0.014139678460079656
Bond Position:  [4.83745059]


portfolio before change:  [6.28307398]
curr_Stock_Price:  102.19600645325308
curr_Factors:  [102.19600645  -1.47014835  -1.01844705]
mat_Sqrt:  [[ 8.48497706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.01630706e-05  2.85816009e-02 -1.43060025e-01]
Stock Position:  5.0163070647675346e-05
Bond Position:  [6.27794752]


portfolio before change:  [6.28388434]
curr_Stock_Price:  102.70569478557873
curr_Factors:  [102.70569479  -1.27794173  -1.01040006]
mat_Sqrt:  [[10.41790308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04195718 -0.00315354 -0.45678295]
Stock Position:  -0.041957183818988664
Bond Position:  [10.59312606]


portfolio before change:  [6.32283199]
curr_Stock_Price:  101.80898486043365
curr_Factors:  [101.80898486  -0.9252549   -1.01563383]
mat_Sqrt:  [[14.61735663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06808926  0.46945595 -0.7411413 ]
Stock Position:  0.06808926304982255
Bond Position:  [-0.60926676]


portfolio before change:  [6.25836803]
curr_Stock_Price:  100.86334686150403
curr_Factors:  [100.86334686  -0.91045224  -0.99029026]
mat_Sqrt:  [[15.07479438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055293  0.0056085  -0.16637884]
Stock Position:  -0.0005529299106352595
Bond Position:  [6.31413839]


portfolio before change:  [6.25864019]
curr_Stock_Price:  101.79865429248254
curr_Factors:  [101.79865429  -0.87998123  -0.99090948]
mat_Sqrt:  [[15.67561272  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.85083094e-02 -5.56620993e-04 -1.15397434e+00]
Stock Position:  -0.018508309438345125
Bond Position:  [8.14276118]


portfolio before change:  [6.21788886]
curr_Stock_Price:  104.05543713485254
curr_Factors:  [104.05543713  -0.85865808  -1.00939213]
mat_Sqrt:  [[16.06870507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08989249 -0.95436124  7.1151569 ]
Stock Position:  0.08989249017975917
Bond Position:  [-3.1359135]


portfolio before change:  [6.20509794]
curr_Stock_Price:  103.9175067091505
curr_Factors:  [103.91750671  -0.84022213  -0.99253665]
mat_Sqrt:  [[16.6238532   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00130351 -0.03053791  0.10625201]
Stock Position:  -0.0013035108419818951
Bond Position:  [6.34055554]


portfolio before change:  [6.20602879]
curr_Stock_Price:  103.8114622641033
curr_Factors:  [103.81146226  -0.82750749  -0.96230171]
mat_Sqrt:  [[17.33568677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00729083 -0.02842382  0.07079428]
Stock Position:  0.007290829511381426
Bond Position:  [5.44915712]


portfolio before change:  [6.19038949]
curr_Stock_Price:  101.57296698571916
curr_Factors:  [101.57296699  -0.87323557  -0.93031567]
mat_Sqrt:  [[16.73037927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00840713 -0.03563304 -0.12790183]
Stock Position:  -0.00840712980003893
Bond Position:  [7.04432661]


portfolio before change:  [6.19470798]
curr_Stock_Price:  101.16404108085227
curr_Factors:  [101.16404108  -1.28184621  -0.91492913]
mat_Sqrt:  [[11.24549981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05884281 -0.55988996 -0.5625714 ]
Stock Position:  -0.05884281460394855
Bond Position:  [12.14748489]


portfolio before change:  [6.15784365]
curr_Stock_Price:  101.81633581407388
curr_Factors:  [101.81633581  -1.28595123  -0.93882602]
mat_Sqrt:  [[11.00547973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0032569  0.01281425 0.51574872]
Stock Position:  0.003256904887678019
Bond Position:  [5.82623753]


portfolio before change:  [6.15823783]
curr_Stock_Price:  101.71373867470273
curr_Factors:  [101.71373867  -1.33721944  -0.92473012]
mat_Sqrt:  [[10.5932057   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0312063  -0.02060182  1.26032081]
Stock Position:  0.031206296400929312
Bond Position:  [2.98412875]


portfolio before change:  [6.16200772]
curr_Stock_Price:  101.82259036907517
curr_Factors:  [101.82259037  -1.38223717  -0.92074629]
mat_Sqrt:  [[10.17820355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00220525 -0.05461739 -0.08539715]
Stock Position:  0.002205246784615436
Bond Position:  [5.93746378]


portfolio before change:  [6.16210082]
curr_Stock_Price:  101.52823120302605
curr_Factors:  [101.5282312   -1.50679929  -0.9089088 ]
mat_Sqrt:  [[ 9.06688538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01322287 -0.01701861 -0.03244753]
Stock Position:  0.013222874647885175
Bond Position:  [4.81960574]


portfolio before change:  [6.15742158]
curr_Stock_Price:  101.12879252960441
curr_Factors:  [101.12879253  -1.57792291  -0.91213108]
mat_Sqrt:  [[ 8.38413214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00621328 0.04299383 0.20213167]
Stock Position:  0.006213275573320509
Bond Position:  [5.52908052]


portfolio before change:  [6.1552621]
curr_Stock_Price:  100.66999204912595
curr_Factors:  [100.66999205  -1.73334201  -0.8882681 ]
mat_Sqrt:  [[ 7.31727248  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00569417 -0.06623173 -0.48614166]
Stock Position:  0.005694170611154219
Bond Position:  [5.58202999]


portfolio before change:  [6.15674293]
curr_Stock_Price:  100.8075052361613
curr_Factors:  [100.80750524  -1.58718313  -0.89758629]
mat_Sqrt:  [[ 8.40177826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104846 -0.01765728  0.0435784 ]
Stock Position:  0.001048464980535361
Bond Position:  [6.05104979]


portfolio before change:  [6.15719867]
curr_Stock_Price:  100.52071920069206
curr_Factors:  [100.5207192   -1.42991252  -0.90071753]
mat_Sqrt:  [[ 9.77407838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00268419 -0.0105525   0.53005742]
Stock Position:  0.00268418617668489
Bond Position:  [5.88738234]


portfolio before change:  [6.15823412]
curr_Stock_Price:  100.63229220890085
curr_Factors:  [100.63229221  -1.4552656   -0.89726791]
mat_Sqrt:  [[ 9.57293353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04475129 -0.03546411  0.52026332]
Stock Position:  0.0447512857645912
Bond Position:  [1.65480965]


portfolio before change:  [6.13969038]
curr_Stock_Price:  100.21329638865551
curr_Factors:  [100.21329639  -1.1221326   -0.87948098]
mat_Sqrt:  [[13.54052843  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121477 -0.03237199 -0.04012933]
Stock Position:  -0.0012147676117316248
Bond Position:  [6.26142625]


portfolio before change:  [6.14085967]
curr_Stock_Price:  99.89507785347284
curr_Factors:  [99.89507785 -1.02765114 -0.85591091]
mat_Sqrt:  [[15.18880073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063849 -0.02098873  0.0399858 ]
Stock Position:  -0.0006384869587883196
Bond Position:  [6.20464138]


portfolio before change:  [6.14097099]
curr_Stock_Price:  100.93552375051341
curr_Factors:  [100.93552375  -1.30709466  -0.83967498]
mat_Sqrt:  [[11.79543145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.00539259e-03 -1.58401440e-05  1.83837022e-01]
Stock Position:  0.007005392593332455
Bond Position:  [5.43387802]


portfolio before change:  [6.14254801]
curr_Stock_Price:  101.06367476161296
curr_Factors:  [101.06367476  -1.58590586  -0.82449802]
mat_Sqrt:  [[ 9.07339837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313373 -0.0056235  -0.19397407]
Stock Position:  -0.003133727929184854
Bond Position:  [6.45925407]


portfolio before change:  [6.14361027]
curr_Stock_Price:  100.98236681271673
curr_Factors:  [100.98236681  -1.70553928  -0.81779295]
mat_Sqrt:  [[ 8.09797218  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0087515   0.00576955 -0.09126449]
Stock Position:  -0.00875150333437083
Bond Position:  [7.02735779]


portfolio before change:  [6.148403]
curr_Stock_Price:  100.53509957479253
curr_Factors:  [100.53509957  -1.49693543  -0.78011644]
mat_Sqrt:  [[10.31351367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0071449  -0.01385552  0.09691619]
Stock Position:  -0.00714490380620714
Bond Position:  [6.86671662]


portfolio before change:  [6.14625877]
curr_Stock_Price:  100.95534713419626
curr_Factors:  [100.95534713  -1.61442626  -0.78936178]
mat_Sqrt:  [[ 9.12383547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02765383 0.00586363 0.13598539]
Stock Position:  0.02765382975959878
Bond Position:  [3.35445679]


portfolio before change:  [6.1439668]
curr_Stock_Price:  100.85730270867953
curr_Factors:  [100.85730271  -1.65048704  -0.79488248]
mat_Sqrt:  [[ 8.74373243  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00892306 -0.01669566  0.21529097]
Stock Position:  -0.008923062867669569
Bond Position:  [7.04392285]


portfolio before change:  [6.14428537]
curr_Stock_Price:  100.92028253385556
curr_Factors:  [100.92028253  -1.63329447  -0.80184569]
mat_Sqrt:  [[ 8.83915036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01640502 -0.02050122 -0.23508981]
Stock Position:  -0.01640502225971352
Bond Position:  [7.79988485]


portfolio before change:  [6.14246874]
curr_Stock_Price:  101.0904549031731
curr_Factors:  [101.0904549   -1.54236985  -0.78163412]
mat_Sqrt:  [[ 9.89482346  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.336877   0.59950108 0.54496878]
Stock Position:  0.33687699813467137
Bond Position:  [-27.91258025]


portfolio before change:  [5.93641497]
curr_Stock_Price:  100.48915389885497
curr_Factors:  [100.4891539   -1.61871362  -0.76924004]
mat_Sqrt:  [[ 9.226651    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00582947 -0.0610361  -0.1976875 ]
Stock Position:  -0.0058294741893300936
Bond Position:  [6.5222139]


portfolio before change:  [5.93740398]
curr_Stock_Price:  100.4593591524034
curr_Factors:  [100.45935915  -1.51317034  -0.77359501]
mat_Sqrt:  [[10.20612376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00156803 -0.00435178 -0.20177134]
Stock Position:  0.0015680334510227733
Bond Position:  [5.77988035]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.93743257]
Stock Price:  100.01680067168064
PL:  [5.9206319]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.24476371e-02 -9.61796254e-02  7.91021406e-03]
 [ 1.17582619e+00  2.40743300e-01  3.36096034e-01]
 [ 1.29690584e-01  2.39773832e-01  4.29973334e-02]
 [ 4.96825573e-02  3.95718957e-01  3.19666628e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.48368158e-02  8.48404795e-02 -3.61719072e-02]
 [-3.55863508e-02 -9.71871425e-02 -1.44437427e-02]
 [ 1.50694342e-01  7.62755091e-02 -1.36114979e-01]
 [ 9.04913211e-03  7.07406306e-02 -4.74418702e-02]
 [-4.07387293e-01  7.22317882e-02 -1.39463634e-01]
 [ 7.41225238e-01  1.44721849e+00 -2.53239357e-01]
 [-1.94198785e-06  2.23727278e-02 -5.84703315e-02]
 [-6.00979964e-02 -9.12111714e-03 -1.62698225e-01]
 [ 1.45952022e+00 -2.81747493e+00  2.39903968e+00]
 [ 2.31043408e-02 -9.98583363e-02  5.10914999e-02]
 [ 1.51764976e-01 -9.56562391e-02  2.63184730e-02]
 [-2.59452710e-01 -4.36977380e-01  9.06210540e-03]
 [-2.52133686e-01 -1.66145434e+00 -2.02042877e-01]
 [-1.63380655e-02  6.79983227e-02  2.38437437e-01]
 [ 3.73803557e-01 -5.72557179e-01  2.99153411e-01]
 [ 5.79032726e-02  1.37952746e-01 -7.45824203e-02]
 [ 8.19292454e-02 -5.47607249e-02 -6.00784503e-02]
 [ 1.69734661e-01  2.11691904e-01  1.86292508e-01]
 [-8.68393715e-02 -2.92732123e-02  7.91920228e-02]
 [-3.38087307e-02 -1.39904887e-01  5.51682887e-02]
 [ 6.19834812e-02 -1.34272123e-02  3.69097502e-02]
 [ 5.29642806e-01 -6.80467992e-02  2.88214461e-01]
 [-3.75946245e-02 -6.62065556e-03  7.68680793e-02]
 [-9.46610718e-03 -7.49011864e-02 -3.07461539e-03]
 [ 9.85181498e-02 -3.15688402e-02  9.79249965e-02]
 [-2.02995076e-02 -1.88057518e-02 -6.33395189e-02]
 [-4.39640129e-02  2.39371727e-02 -4.80875781e-02]
 [-7.40213633e-02 -4.99807136e-02  1.82733176e-02]
 [ 2.59072247e-01  3.59291069e-02  6.24723837e-02]
 [-4.02570741e-02 -2.10767220e-02  3.39493151e-02]
 [-1.10909448e-01 -6.05774666e-02 -7.94463718e-02]
 [ 1.56445486e+00  1.03147723e+00  1.42183711e-01]
 [-2.04723095e-02 -1.03977711e-01 -3.85091720e-02]
 [ 3.40843404e-02 -1.39687564e-02 -8.92101297e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.39771458]
curr_Stock_Price:  99.72570442477127
curr_Factors:  [99.72570442 -1.05834026 -0.98426517]
mat_Sqrt:  [[12.93346367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043069 -0.03104184  0.02256564]
Stock Position:  -0.00043068748977307856
Bond Position:  [0.4406652]


portfolio before change:  [0.39739012]
curr_Stock_Price:  100.60696889622538
curr_Factors:  [100.6069689   -0.87243193  -0.99988683]
mat_Sqrt:  [[15.47000161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08361816 0.07769957 0.95878843]
Stock Position:  0.0836181572027586
Bond Position:  [-8.01517922]


portfolio before change:  [0.54987969]
curr_Stock_Price:  102.44259324107264
curr_Factors:  [102.44259324  -0.97790882  -1.01886054]
mat_Sqrt:  [[13.90895967  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01347412 0.07738667 0.12265942]
Stock Position:  0.013474121070327728
Bond Position:  [-0.83044422]


portfolio before change:  [0.55054937]
curr_Stock_Price:  102.49999903300005
curr_Factors:  [102.49999903  -0.82426109  -1.03477452]
mat_Sqrt:  [[15.97184026  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01225344 0.12771774 0.91191991]
Stock Position:  0.012253442627363345
Bond Position:  [-0.70542849]


portfolio before change:  [0.55313796]
curr_Stock_Price:  102.7184498431558
curr_Factors:  [102.71844984  -0.58205806  -1.04496295]
mat_Sqrt:  [[20.18562544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00290533 -0.01106097 -0.05874131]
Stock Position:  -0.002905334843974378
Bond Position:  [0.85156945]


portfolio before change:  [0.55362874]
curr_Stock_Price:  102.58616359207716
curr_Factors:  [102.58616359  -0.76248013  -1.07177142]
mat_Sqrt:  [[16.38639658  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00456301  0.02738215 -0.10318838]
Stock Position:  0.004563007255107776
Bond Position:  [0.08552734]


portfolio before change:  [0.55057424]
curr_Stock_Price:  101.91441368534363
curr_Factors:  [101.91441369  -1.03740388  -1.07870407]
mat_Sqrt:  [[12.28065709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00475324 -0.03136702 -0.04120398]
Stock Position:  -0.004753239946044109
Bond Position:  [1.0349979]


portfolio before change:  [0.54725355]
curr_Stock_Price:  102.64024863168378
curr_Factors:  [102.64024863  -1.127983    -1.08084001]
mat_Sqrt:  [[11.27296221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01228423  0.02461781 -0.38829815]
Stock Position:  0.012284230098580705
Bond Position:  [-0.71360288]


portfolio before change:  [0.55799788]
curr_Stock_Price:  103.52215471987186
curr_Factors:  [103.52215472  -1.01538344  -1.11096981]
mat_Sqrt:  [[12.34723809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00111806  0.02283144 -0.13533845]
Stock Position:  0.0011180615089937656
Bond Position:  [0.44225375]


portfolio before change:  [0.55819965]
curr_Stock_Price:  103.65317075609428
curr_Factors:  [103.65317076  -0.90055577  -1.10362159]
mat_Sqrt:  [[13.96945371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03014513  0.02331271 -0.39785093]
Stock Position:  -0.030145125593376648
Bond Position:  [3.6828375]


portfolio before change:  [0.59200944]
curr_Stock_Price:  102.54687553464342
curr_Factors:  [102.54687553  -0.72438743  -1.13905178]
mat_Sqrt:  [[15.90893346  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06191145  0.46708776 -0.7224214 ]
Stock Position:  0.061911454396957166
Bond Position:  [-5.75681676]


portfolio before change:  [0.56438214]
curr_Stock_Price:  102.11226040038142
curr_Factors:  [102.1122604   -0.65690749  -1.13385721]
mat_Sqrt:  [[17.03564816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043264  0.00722077 -0.16679958]
Stock Position:  -0.00043264185905356786
Bond Position:  [0.60856018]


portfolio before change:  [0.56412335]
curr_Stock_Price:  102.88627308601957
curr_Factors:  [102.88627309  -0.63104146  -1.10782062]
mat_Sqrt:  [[18.079201    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00526409 -0.00294383 -0.46413275]
Stock Position:  -0.005264086212540491
Bond Position:  [1.10572556]


portfolio before change:  [0.55426428]
curr_Stock_Price:  104.78542265132344
curr_Factors:  [104.78542265  -0.65930408  -1.1063525 ]
mat_Sqrt:  [[17.92610588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07665399 -0.90933612  6.84379244]
Stock Position:  0.07665398681629167
Bond Position:  [-7.47795612]


portfolio before change:  [0.65404875]
curr_Stock_Price:  106.09936955389277
curr_Factors:  [106.09936955  -0.78328078  -1.08727136]
mat_Sqrt:  [[16.34339711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0008046  -0.03222914  0.14574983]
Stock Position:  0.0008045972281431103
Bond Position:  [0.56868149]


portfolio before change:  [0.65290444]
curr_Stock_Price:  104.5888060298086
curr_Factors:  [104.58880603  -0.87069222  -1.10039518]
mat_Sqrt:  [[14.56977427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.009445   -0.03087292  0.07507928]
Stock Position:  0.009444996275810948
Bond Position:  [-0.33493644]


portfolio before change:  [0.66459528]
curr_Stock_Price:  105.83101982611946
curr_Factors:  [105.83101983  -1.25584979  -1.10089552]
mat_Sqrt:  [[10.02516432  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.034593   -0.14103384  0.02585166]
Stock Position:  -0.034593004036920054
Bond Position:  [4.32560817]


portfolio before change:  [0.68362511]
curr_Stock_Price:  105.29654475939341
curr_Factors:  [105.29654476  -1.1707528   -1.06945282]
mat_Sqrt:  [[11.20740791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05643753 -0.53623208 -0.57637209]
Stock Position:  -0.05643753372386758
Bond Position:  [6.62630241]


portfolio before change:  [0.66085468]
curr_Stock_Price:  105.71468450571423
curr_Factors:  [105.71468451  -1.19076219  -1.10989423]
mat_Sqrt:  [[10.591877    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00436305 0.02194636 0.68019564]
Stock Position:  0.004363048409096356
Bond Position:  [0.19961639]


portfolio before change:  [0.66253942]
curr_Stock_Price:  106.0951038362789
curr_Factors:  [106.09510384  -1.01123071  -1.0974894 ]
mat_Sqrt:  [[12.87922809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02469055 -0.18479204  0.85340141]
Stock Position:  0.024690551621144138
Bond Position:  [-1.95700722]


portfolio before change:  [0.62320296]
curr_Stock_Price:  104.51183378788562
curr_Factors:  [104.51183379  -0.69808906  -1.09266803]
mat_Sqrt:  [[17.43610773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00406276  0.04452406 -0.21276289]
Stock Position:  0.0040627580004543645
Bond Position:  [0.19859668]


portfolio before change:  [0.61856644]
curr_Stock_Price:  103.36449652931223
curr_Factors:  [103.36449653  -0.74689125  -1.05609054]
mat_Sqrt:  [[17.03516512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00343336 -0.01767395 -0.1713871 ]
Stock Position:  0.0034333566162131506
Bond Position:  [0.26367926]


portfolio before change:  [0.6175082]
curr_Stock_Price:  103.04667362673378
curr_Factors:  [103.04667363  -1.00395834  -1.08154277]
mat_Sqrt:  [[12.80301787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01960264 0.06832327 0.53144067]
Stock Position:  0.019602635228591708
Bond Position:  [-1.40247815]


portfolio before change:  [0.62328786]
curr_Stock_Price:  103.35045859016878
curr_Factors:  [103.35045859  -1.32025416  -1.10584677]
mat_Sqrt:  [[ 9.13419252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00839152 -0.00944789  0.2259128 ]
Stock Position:  -0.008391517563542304
Bond Position:  [1.49055505]


portfolio before change:  [0.62851982]
curr_Stock_Price:  102.7491815899643
curr_Factors:  [102.74918159  -1.4362536   -1.10878754]
mat_Sqrt:  [[ 8.06271022  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0063385  -0.04515411  0.15737977]
Stock Position:  -0.0063385034302507704
Bond Position:  [1.27979586]


portfolio before change:  [0.62941977]
curr_Stock_Price:  102.6324410812035
curr_Factors:  [102.63244108  -1.15570833  -1.07769117]
mat_Sqrt:  [[10.99845245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00607148 -0.00433361  0.10529324]
Stock Position:  0.0060714754607203115
Bond Position:  [0.00628942]


portfolio before change:  [0.63567909]
curr_Stock_Price:  103.66325032777597
curr_Factors:  [103.66325033  -1.22077027  -1.0657923 ]
mat_Sqrt:  [[10.53375744  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05454695 -0.02196201  0.82219563]
Stock Position:  0.054546950184361676
Bond Position:  [-5.01883507]


portfolio before change:  [0.5615247]
curr_Stock_Price:  102.31529246740271
curr_Factors:  [102.31529247  -0.84680211  -1.07177731]
mat_Sqrt:  [[15.02145816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154815 -0.00213681  0.21928323]
Stock Position:  -0.0015481472523283541
Bond Position:  [0.71992384]


portfolio before change:  [0.56120511]
curr_Stock_Price:  102.5798599454119
curr_Factors:  [102.57985995  -1.06978186  -1.09305905]
mat_Sqrt:  [[11.79647441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215173 -0.02417425 -0.00877102]
Stock Position:  -0.002151731966547982
Bond Position:  [0.78192947]


portfolio before change:  [0.56240158]
curr_Stock_Price:  102.0692363260578
curr_Factors:  [102.06923633  -1.13866805  -1.11783048]
mat_Sqrt:  [[10.68833378  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01048461 -0.0101888   0.27935276]
Stock Position:  0.01048461301893983
Bond Position:  [-0.50775486]


portfolio before change:  [0.55309346]
curr_Stock_Price:  101.18750139015953
curr_Factors:  [101.18750139  -1.03387596  -1.11493234]
mat_Sqrt:  [[11.80079554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314109 -0.00606953 -0.18069002]
Stock Position:  -0.003141088293720362
Bond Position:  [0.87093233]


portfolio before change:  [0.55119975]
curr_Stock_Price:  101.82504650565535
curr_Factors:  [101.82504651  -1.19173377  -1.11820486]
mat_Sqrt:  [[10.10790184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483718  0.00772569 -0.13718048]
Stock Position:  -0.0048371753666660395
Bond Position:  [1.04374535]


portfolio before change:  [0.55338894]
curr_Stock_Price:  101.39944256147305
curr_Factors:  [101.39944256  -1.14645393  -1.09981222]
mat_Sqrt:  [[10.72740242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00750355 -0.01613121  0.05212869]
Stock Position:  -0.007503550742781598
Bond Position:  [1.31424481]


portfolio before change:  [0.55458873]
curr_Stock_Price:  101.2614415824008
curr_Factors:  [101.26144158  -1.21764111  -1.1086747 ]
mat_Sqrt:  [[ 9.8886723   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02823012 0.01159607 0.17821632]
Stock Position:  0.02823011616470485
Bond Position:  [-2.30403353]


portfolio before change:  [0.5327905]
curr_Stock_Price:  100.49948195277263
curr_Factors:  [100.49948195  -1.01398407  -1.14291663]
mat_Sqrt:  [[11.62609194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323664 -0.00680248  0.09684795]
Stock Position:  -0.0032366393781929205
Bond Position:  [0.85807108]


portfolio before change:  [0.53349458]
curr_Stock_Price:  100.31508805403163
curr_Factors:  [100.31508805  -0.94662231  -1.14849739]
mat_Sqrt:  [[12.34432465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01130007 -0.01955129 -0.22663839]
Stock Position:  -0.011300066859612308
Bond Position:  [1.66706179]


portfolio before change:  [0.5382665]
curr_Stock_Price:  99.9112391221545
curr_Factors:  [99.91123912 -0.79200913 -1.12679651]
mat_Sqrt:  [[14.66518833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.12301427 0.33290784 0.40561055]
Stock Position:  0.12301426739313022
Bond Position:  [-11.75224139]


portfolio before change:  [0.50392672]
curr_Stock_Price:  99.64402899080969
curr_Factors:  [99.64402899 -0.93519758 -1.10618725]
mat_Sqrt:  [[12.93865436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00383018 -0.03355866 -0.10985595]
Stock Position:  -0.0038301759430742176
Bond Position:  [0.88558088]


portfolio before change:  [0.50361235]
curr_Stock_Price:  99.75500783686061
curr_Factors:  [99.75500784 -0.74869104 -1.1121884 ]
mat_Sqrt:  [[15.51547355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00083936 -0.0045084  -0.25449167]
Stock Position:  0.0008393581064972761
Bond Position:  [0.41988218]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.50378774]
Stock Price:  99.90143015114712
PL:  [0.50378774]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 2.62681898e-02 -8.17018406e-02 -1.77335720e-02]
 [ 1.30562557e+00  2.58893960e-01  3.88446836e-01]
 [-2.26571352e-01 -1.22083856e-01  3.64053862e-02]
 [ 1.37307000e-01  9.05151160e-01  8.50654580e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-1.14900501e-02  2.21300942e-01 -9.83762158e-02]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [-5.44387917e-02  1.04338889e-01  8.63898467e-03]
 [ 3.79426570e-02  3.94731671e-02 -4.26915431e-02]
 [-3.21136188e-02 -7.34753193e-03  3.14277027e-02]
 [ 9.19879659e-01  1.77317918e+00 -3.18698827e-01]
 [-5.86068934e-04  1.01958360e-02  3.26533363e-02]
 [-2.80543040e-01  2.49669431e-03 -5.99733243e-01]
 [ 1.74264597e+00 -2.99848509e+00  2.52580552e+00]
 [ 1.23607780e-02 -9.08558138e-02  3.49315496e-02]
 [ 7.51895172e-02  1.34034931e-01 -9.64006168e-02]
 [-3.12073416e-03  2.09429518e-01 -4.64580311e-02]
 [-2.85790406e-01 -1.84716170e+00 -1.99889812e-01]
 [ 1.18495548e-02  1.78074986e-02  6.73892015e-03]
 [ 5.28894379e-02  3.73266836e-02  1.48458733e-01]
 [ 2.78866742e-02 -6.88087905e-03  2.81541237e-02]
 [ 5.86239811e-02 -4.26339651e-02  3.39006931e-04]
 [ 1.15028994e-01 -5.89921710e-02 -5.43150679e-02]
 [-2.67200784e-01  9.68442785e-02  1.86196888e-02]
 [ 1.46685144e-01 -2.21773921e-02 -5.13947378e-02]
 [-3.11358227e-03 -5.09669501e-02  2.22683802e-01]
 [-1.83253884e-01 -1.13361100e-01 -7.27246034e-02]
 [-2.59673964e-01  1.89327522e-01  3.51149420e-01]
 [ 1.55847051e-01  1.49148904e-01  3.03936167e-01]
 [-1.55381866e-01  1.08307893e-01 -1.10781648e-01]
 [ 1.58500639e-01  2.41348074e-02  6.71852375e-02]
 [ 1.55406518e-01 -2.36852080e-03 -9.43001895e-02]
 [ 1.83670758e-01  1.45566417e-01  1.78146988e-01]
 [ 6.69783166e-03 -1.50722855e-02  5.36245296e-02]
 [-9.66348949e-02  1.57314161e-01  2.74836524e-02]
 [-8.53124981e-02 -4.85535896e-02 -4.93673146e-02]
 [ 1.36369981e+00  9.04258115e-01  1.34055122e-01]
 [ 1.97348660e-01 -3.39810415e-01  9.60773554e-02]
 [ 2.79333886e-02 -1.57191593e-02  3.38308694e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.54116575]
curr_Stock_Price:  100.01820319935753
curr_Factors:  [100.0182032   -1.07200854  -1.01191345]
mat_Sqrt:  [[12.44638501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047974 -0.02636916 -0.05058894]
Stock Position:  0.0004797393954560531
Bond Position:  [2.49318308]


portfolio before change:  [2.54181812]
curr_Stock_Price:  100.72837872080557
curr_Factors:  [100.72837872  -1.05606394  -1.03614729]
mat_Sqrt:  [[12.43128572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11565686 0.08355767 1.1081307 ]
Stock Position:  0.11565685886979053
Bond Position:  [-9.10810977]


portfolio before change:  [2.47941169]
curr_Stock_Price:  100.19864066247233
curr_Factors:  [100.19864066  -1.01654445  -1.03596219]
mat_Sqrt:  [[12.86676958  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01896827 -0.0394024   0.10385443]
Stock Position:  -0.018968272886841882
Bond Position:  [4.38000685]


portfolio before change:  [2.47225074]
curr_Stock_Price:  100.60502909520449
curr_Factors:  [100.6050291   -0.72024287  -1.05555417]
mat_Sqrt:  [[17.03730251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02909553 0.29213628 2.42668074]
Stock Position:  0.02909552993828355
Bond Position:  [-0.4549059]


portfolio before change:  [2.46832189]
curr_Stock_Price:  100.47195076360603
curr_Factors:  [100.47195076  -0.59078393  -1.02501646]
mat_Sqrt:  [[19.96694596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293715 -0.01106097 -0.05874131]
Stock Position:  -0.0029371542872909263
Bond Position:  [2.76342351]


portfolio before change:  [2.47126912]
curr_Stock_Price:  99.58613172936856
curr_Factors:  [99.58613173 -0.45590701 -1.0162801 ]
mat_Sqrt:  [[22.84736528  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00059534  0.07142457 -0.28063996]
Stock Position:  0.000595335803182308
Bond Position:  [2.41198194]


portfolio before change:  [2.4713089]
curr_Stock_Price:  99.14647995173668
curr_Factors:  [99.14647995 -0.55829625 -0.98884374]
mat_Sqrt:  [[21.10391068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314114 -0.00251018 -0.21167328]
Stock Position:  -0.00314113928676752
Bond Position:  [2.7827418]


portfolio before change:  [2.47208601]
curr_Stock_Price:  99.00982854938651
curr_Factors:  [99.00982855 -0.55897185 -1.01282871]
mat_Sqrt:  [[20.56146221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152602  0.03367523  0.02464462]
Stock Position:  -0.0015260237557328709
Bond Position:  [2.62317736]


portfolio before change:  [2.47088896]
curr_Stock_Price:  100.00913528611382
curr_Factors:  [100.00913529  -0.36424651  -1.0130144 ]
mat_Sqrt:  [[25.2291641   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147788  0.01273991 -0.12178709]
Stock Position:  0.0014778812576491656
Bond Position:  [2.32308733]


portfolio before change:  [2.47097353]
curr_Stock_Price:  99.86985969287318
curr_Factors:  [99.86985969 -0.38488309 -1.01547099]
mat_Sqrt:  [[24.61888549  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110477 -0.00237141  0.08965449]
Stock Position:  -0.0011047727774495452
Bond Position:  [2.58130703]


portfolio before change:  [2.4713652]
curr_Stock_Price:  99.80741822611901
curr_Factors:  [99.80741823 -0.78874298 -1.00769172]
mat_Sqrt:  [[16.55698077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0734901   0.57229112 -0.90915904]
Stock Position:  0.073490102776682
Bond Position:  [-4.86349223]


portfolio before change:  [2.44953051]
curr_Stock_Price:  99.51858054411349
curr_Factors:  [99.51858054 -0.74818696 -0.97360931]
mat_Sqrt:  [[17.78842738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00045875 0.00329069 0.09315088]
Stock Position:  0.00045875228646106384
Bond Position:  [2.40387614]


portfolio before change:  [2.44999672]
curr_Stock_Price:  99.8797877894265
curr_Factors:  [99.87978779 -0.68465757 -1.00874478]
mat_Sqrt:  [[18.36717292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.19115616e-02  8.05804623e-04 -1.71087201e+00]
Stock Position:  -0.021911561565964736
Bond Position:  [4.63851884]


portfolio before change:  [2.45365379]
curr_Stock_Price:  99.73934958345752
curr_Factors:  [99.73934958 -0.50778127 -1.03035653]
mat_Sqrt:  [[21.42208673  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07684409 -0.9677569   7.20542009]
Stock Position:  0.07684408513203037
Bond Position:  [-5.21072528]


portfolio before change:  [2.40145233]
curr_Stock_Price:  99.06850964086254
curr_Factors:  [99.06850964 -0.50519582 -1.02780436]
mat_Sqrt:  [[21.38760289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.41978153e-05 -2.93235878e-02  9.96499880e-02]
Stock Position:  4.4197815320779326e-05
Bond Position:  [2.39707372]


portfolio before change:  [2.40171245]
curr_Stock_Price:  98.17399377174735
curr_Factors:  [98.17399377 -0.29052572 -1.02893014]
mat_Sqrt:  [[26.2400139   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00315821  0.04325959 -0.27500413]
Stock Position:  0.0031582143904132828
Bond Position:  [2.09165793]


portfolio before change:  [2.4017718]
curr_Stock_Price:  98.10999639538207
curr_Factors:  [98.1099964  -0.32083276 -1.05470734]
mat_Sqrt:  [[24.79269768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00121591  0.06759309 -0.13253183]
Stock Position:  0.0012159096911368422
Bond Position:  [2.28247891]


portfolio before change:  [2.40296907]
curr_Stock_Price:  98.86000252212773
curr_Factors:  [98.86000252 -0.41884928 -1.06706735]
mat_Sqrt:  [[22.37150608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03145265 -0.59616887 -0.57023   ]
Stock Position:  -0.03145264530957869
Bond Position:  [5.51237766]


portfolio before change:  [2.39246812]
curr_Stock_Price:  99.21577676447033
curr_Factors:  [99.21577676 -0.31101323 -1.05902689]
mat_Sqrt:  [[25.21040802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00066877 0.00574735 0.01922426]
Stock Position:  0.0006687742427420942
Bond Position:  [2.32611516]


portfolio before change:  [2.39234709]
curr_Stock_Price:  98.6000129893364
curr_Factors:  [98.60001299 -0.19727786 -1.03452432]
mat_Sqrt:  [[28.7681597   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00315671 0.01204714 0.42351144]
Stock Position:  0.003156709649035055
Bond Position:  [2.08109548]


portfolio before change:  [2.39083471]
curr_Stock_Price:  98.03849800524499
curr_Factors:  [98.03849801 -0.13311206 -1.01207184]
mat_Sqrt:  [[31.19245801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103323 -0.00222079  0.08031588]
Stock Position:  0.0010332323634296627
Bond Position:  [2.28953816]


portfolio before change:  [2.38950469]
curr_Stock_Price:  96.47425729003221
curr_Factors:  [96.47425729  0.11937906 -1.015392  ]
mat_Sqrt:  [[39.38020465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00126943 -0.01376005  0.00096709]
Stock Position:  0.0012694336994595425
Bond Position:  [2.26703702]


portfolio before change:  [2.38807553]
curr_Stock_Price:  95.12518205999537
curr_Factors:  [95.12518206  0.15852764 -1.03124306]
mat_Sqrt:  [[39.74477212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00231226 -0.01903964 -0.15494577]
Stock Position:  0.0023122600890987817
Bond Position:  [2.16812137]


portfolio before change:  [2.38030592]
curr_Stock_Price:  91.64778786146897
curr_Factors:  [ 9.16477879e+01  3.73827223e-02 -1.05816818e+00]
mat_Sqrt:  [[33.0217812   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00737791  0.03125636  0.05311679]
Stock Position:  -0.007377912149930073
Bond Position:  [3.05647525]


portfolio before change:  [2.3827337]
curr_Stock_Price:  91.37051482954607
curr_Factors:  [91.37051483  0.1225821  -1.04965626]
mat_Sqrt:  [[36.15620828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00364162 -0.00715772 -0.14661488]
Stock Position:  0.003641623448456893
Bond Position:  [2.04999669]


portfolio before change:  [2.37822855]
curr_Stock_Price:  90.06301705763542
curr_Factors:  [90.06301706  0.11058247 -1.04825381]
mat_Sqrt:  [[35.26314149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009057  -0.01644951  0.6352549 ]
Stock Position:  0.0009057041451857147
Bond Position:  [2.2966581]


portfolio before change:  [2.3786725]
curr_Stock_Price:  90.23619855809666
curr_Factors:  [ 9.02361986e+01  5.22941043e-02 -1.05122172e+00]
mat_Sqrt:  [[33.23166024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00665746 -0.03658714 -0.20746305]
Stock Position:  -0.0066574606214133275
Bond Position:  [2.97941644]


portfolio before change:  [2.36997997]
curr_Stock_Price:  91.59782653960177
curr_Factors:  [91.59782654 -0.28602599 -1.03846175]
mat_Sqrt:  [[24.35944859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00613107  0.06110519  1.00173155]
Stock Position:  -0.006131073513383808
Bond Position:  [2.93157298]


portfolio before change:  [2.36408651]
curr_Stock_Price:  92.61884325484584
curr_Factors:  [92.61884325 -0.27217037 -1.03282445]
mat_Sqrt:  [[25.11581665  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0098875  0.0481376  0.86704529]
Stock Position:  0.009887500662965908
Bond Position:  [1.44831764]


portfolio before change:  [2.36871209]
curr_Stock_Price:  93.06835328128473
curr_Factors:  [93.06835328 -0.26687772 -1.03342691]
mat_Sqrt:  [[25.35635959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00614784  0.03495622 -0.31602921]
Stock Position:  -0.006147839123848022
Bond Position:  [2.94088135]


portfolio before change:  [2.38054837]
curr_Stock_Price:  91.20287820618296
curr_Factors:  [91.20287821 -0.2895873  -1.04626068]
mat_Sqrt:  [[23.98043934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00738691 0.00778948 0.19166078]
Stock Position:  0.007386906575342799
Bond Position:  [1.70684122]


portfolio before change:  [2.37567004]
curr_Stock_Price:  90.51359213038721
curr_Factors:  [90.51359213 -0.20161884 -1.05011228]
mat_Sqrt:  [[25.88772464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00524087 -0.00076444 -0.26901219]
Stock Position:  0.005240866169561901
Bond Position:  [1.90130042]


portfolio before change:  [2.37766024]
curr_Stock_Price:  90.84798828048461
curr_Factors:  [90.84798828 -0.26694064 -1.03948457]
mat_Sqrt:  [[24.60039342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01015221 0.04698136 0.50820377]
Stock Position:  0.010152214889075585
Bond Position:  [1.45535195]


portfolio before change:  [2.37848116]
curr_Stock_Price:  90.91092907382483
curr_Factors:  [90.91092907 -0.32212298 -1.05623161]
mat_Sqrt:  [[22.90890358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063588 -0.00486456  0.15297586]
Stock Position:  0.0006358783375261634
Bond Position:  [2.32067287]


portfolio before change:  [2.37825698]
curr_Stock_Price:  90.10214142587559
curr_Factors:  [90.10214143 -0.29249567 -1.09351422]
mat_Sqrt:  [[22.5319441   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261465  0.05077293  0.07840321]
Stock Position:  -0.0026146522868093977
Bond Position:  [2.61384275]


portfolio before change:  [2.37702182]
curr_Stock_Price:  90.69950769261779
curr_Factors:  [ 9.06995077e+01 -6.27826122e-02 -1.07813539e+00]
mat_Sqrt:  [[28.98081124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00363346 -0.0156706  -0.14083121]
Stock Position:  -0.0036334565700070747
Bond Position:  [2.70657454]


portfolio before change:  [2.37968458]
curr_Stock_Price:  90.05978158749981
curr_Factors:  [ 9.00597816e+01  4.82641473e-02 -1.07641151e+00]
mat_Sqrt:  [[32.2115901   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04891546 0.29184805 0.38242195]
Stock Position:  0.04891545569596028
Bond Position:  [-2.02563068]


portfolio before change:  [2.3752462]
curr_Stock_Price:  89.97422242644234
curr_Factors:  [89.97422243  0.10657965 -1.07083988]
mat_Sqrt:  [[34.30403484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00430261 -0.10967334  0.27408195]
Stock Position:  0.004302609231515848
Bond Position:  [1.98812228]


portfolio before change:  [2.3791206]
curr_Stock_Price:  90.81693634848287
curr_Factors:  [ 9.08169363e+01  8.83897388e-02 -1.09752561e+00]
mat_Sqrt:  [[33.1058471   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0007677  -0.00507334  0.00965101]
Stock Position:  0.0007676981750362072
Bond Position:  [2.3094006]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.38047163]
Stock Price:  92.20074202776921
PL:  [2.38047163]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-3.99169815e-02 -4.29314331e-02  2.88379514e-01]
 [ 5.18258045e-02  2.09551310e-01 -5.89317961e-04]
 [-5.52584838e-01 -4.32929716e-01  4.47878397e-02]
 [ 2.59860326e-01  1.34642078e+00  1.55132050e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-2.40693027e-02  2.92786116e-01 -1.39035250e-01]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [-2.83778927e-02  5.00463681e-02  3.06457724e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 5.77532433e-01  1.28837122e+00 -1.58036480e-01]
 [-1.15284507e-03  3.44708328e-02  9.97607760e-02]
 [-4.40047471e-01 -6.18654571e-02 -1.14650218e+00]
 [ 2.15632882e+00 -3.17187518e+00  2.70298486e+00]
 [-6.40772200e-03  3.31779635e-02 -3.11493523e-02]
 [ 1.57296833e-02  3.73828790e-01 -2.03822492e-01]
 [ 3.21621199e-02 -2.09772250e-01  2.22636538e-02]
 [-3.02011179e-01 -1.92204303e+00 -1.93571010e-01]
 [ 2.85685110e-02 -5.40733513e-02  3.20791790e-02]
 [ 5.85736618e-03  2.98267441e-01  2.55803010e-01]
 [ 2.66003190e-02 -5.39069989e-03  1.66854252e-02]
 [ 1.14589793e-01 -5.14633540e-02  3.64028094e-02]
 [-5.56840682e-02 -5.10258020e-02 -6.18757343e-02]
 [-1.59667682e-01  2.49588633e-02  7.84003362e-04]
 [ 7.24170262e-02  1.16341476e-02 -2.60376530e-02]
 [ 4.66617189e-03 -4.96010744e-02  2.32923744e-01]
 [ 2.17707516e-01 -1.05259301e-01  1.11536324e-01]
 [-2.06694486e-02 -8.04384775e-02  5.32594408e-03]
 [ 5.71994755e-02 -3.69844813e-02  2.11957598e-02]
 [-4.15781009e-03  6.63049491e-02 -1.78997091e-02]
 [ 5.49032746e-02 -1.39314471e-02 -8.07740612e-02]
 [-7.13656909e-02  8.91476621e-03 -3.59843047e-02]
 [-9.14418330e-02 -9.99992735e-03  5.15189740e-02]
 [-2.71770257e-02 -2.99777550e-02 -7.92524812e-03]
 [-8.97501948e-02  8.53384141e-03  5.61889285e-02]
 [-1.12634166e-01 -6.43233504e-02 -7.54445379e-02]
 [ 1.54423663e+00  1.00983591e+00  1.39643636e-01]
 [ 5.01393734e-02 -1.25746622e-01  1.46246239e-02]
 [ 3.14646699e-02 -1.47985936e-02 -4.51542485e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.5878904]
curr_Stock_Price:  99.454745592798
curr_Factors:  [99.45474559 -0.73305216 -1.0246076 ]
mat_Sqrt:  [[17.15076826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.93845011e-04 -1.38560605e-02  8.22666484e-01]
Stock Position:  0.0005938450111684088
Bond Position:  [-1.6469511]


portfolio before change:  [-1.58877321]
curr_Stock_Price:  98.3148440769327
curr_Factors:  [98.31484408 -0.56467905 -1.02821429]
mat_Sqrt:  [[19.99099014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00472613  0.06763239 -0.00168116]
Stock Position:  0.00472612871059944
Bond Position:  [-2.05342181]


portfolio before change:  [-1.5926501]
curr_Stock_Price:  97.5488472910065
curr_Factors:  [97.54884729 -0.46971954 -0.99857509]
mat_Sqrt:  [[22.46724822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02812156 -0.13972746  0.12776724]
Stock Position:  -0.028121555447847106
Bond Position:  [1.15057522]


portfolio before change:  [-1.61064448]
curr_Stock_Price:  98.19384043710336
curr_Factors:  [98.19384044 -0.32287977 -0.99850598]
mat_Sqrt:  [[26.19471683  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03250118 0.43455544 4.42548557]
Stock Position:  0.03250118310017485
Bond Position:  [-4.80206047]


portfolio before change:  [-1.57317394]
curr_Stock_Price:  99.36520805181365
curr_Factors:  [99.36520805 -0.51763309 -1.00969467]
mat_Sqrt:  [[21.57368483  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027184  -0.01106097 -0.05874131]
Stock Position:  -0.002718404454292055
Bond Position:  [-1.30305912]


portfolio before change:  [-1.57361451]
curr_Stock_Price:  99.46735320447033
curr_Factors:  [99.4673532  -0.26845601 -1.0011137 ]
mat_Sqrt:  [[27.94560001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.61757180e-04  9.44963127e-02 -3.96628868e-01]
Stock Position:  0.0002617571803590216
Bond Position:  [-1.5996508]


portfolio before change:  [-1.57394866]
curr_Stock_Price:  98.95471498598354
curr_Factors:  [98.95471499 -0.26730247 -1.00714408]
mat_Sqrt:  [[27.6663196   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00239607 -0.00251018 -0.21167328]
Stock Position:  -0.002396065825997595
Bond Position:  [-1.33684665]


portfolio before change:  [-1.56953394]
curr_Stock_Price:  97.04248036165653
curr_Factors:  [97.04248036 -0.56320783 -0.97879728]
mat_Sqrt:  [[20.76240124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057347  0.0161524   0.08742386]
Stock Position:  -0.0005734730970847462
Bond Position:  [-1.51388269]


portfolio before change:  [-1.56950464]
curr_Stock_Price:  96.66138731666908
curr_Factors:  [96.66138732 -0.68453029 -0.97919163]
mat_Sqrt:  [[18.31081926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00283937  0.0064198  -0.11330016]
Stock Position:  0.0028393706801407696
Bond Position:  [-1.84396215]


portfolio before change:  [-1.5695869]
curr_Stock_Price:  96.71359856801087
curr_Factors:  [96.71359857 -1.16776422 -0.98403006]
mat_Sqrt:  [[11.24540661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [7.77267801e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  7.77267801361127e-05
Bond Position:  [-1.57710414]


portfolio before change:  [-1.56983886]
curr_Stock_Price:  96.00845949106728
curr_Factors:  [96.00845949 -1.24486423 -0.96709354]
mat_Sqrt:  [[10.51159086  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07689236  0.41582002 -0.45083409]
Stock Position:  0.07689236169655106
Bond Position:  [-8.95215605]


portfolio before change:  [-1.53358606]
curr_Stock_Price:  96.49448809893664
curr_Factors:  [96.4944881  -0.99093253 -0.99636885]
mat_Sqrt:  [[13.22599893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00198451 0.01112541 0.28458973]
Stock Position:  0.0019845054784491385
Bond Position:  [-1.7250799]


portfolio before change:  [-1.53500423]
curr_Stock_Price:  95.88853509035602
curr_Factors:  [95.88853509 -1.10126803 -0.99343629]
mat_Sqrt:  [[11.80451527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05817304 -0.01996699 -3.27065161]
Stock Position:  -0.058173035242389905
Bond Position:  [4.0431229]


portfolio before change:  [-1.47737862]
curr_Stock_Price:  94.90663374684992
curr_Factors:  [94.90663375 -0.89003355 -1.01209454]
mat_Sqrt:  [[14.16487796  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.14547368 -1.02371831  7.71086344]
Stock Position:  0.14547368454136475
Bond Position:  [-15.28379632]


portfolio before change:  [-1.60452802]
curr_Stock_Price:  94.04573026140966
curr_Factors:  [94.04573026 -0.68471251 -0.99442836]
mat_Sqrt:  [[17.5427416   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034166  0.01070814 -0.08886043]
Stock Position:  -0.000341658880169568
Bond Position:  [-1.57239646]


portfolio before change:  [-1.60489067]
curr_Stock_Price:  94.5318425121063
curr_Factors:  [94.53184251 -0.74181732 -1.01200021]
mat_Sqrt:  [[16.36457942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00308178  0.12065272 -0.58144884]
Stock Position:  0.0030817824447642458
Bond Position:  [-1.89621724]


portfolio before change:  [-1.60214861]
curr_Stock_Price:  95.49852168272048
curr_Factors:  [95.49852168 -0.45597877 -1.02866258]
mat_Sqrt:  [[21.63839776  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0002825  -0.0677037   0.06351201]
Stock Position:  -0.0002825029857258307
Bond Position:  [-1.57517]


portfolio before change:  [-1.60215986]
curr_Stock_Price:  94.84133654848763
curr_Factors:  [94.84133655 -0.6382493  -0.98285193]
mat_Sqrt:  [[18.74831943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03914266 -0.62033672 -0.55220421]
Stock Position:  -0.039142659618688555
Bond Position:  [2.11018229]


portfolio before change:  [-1.65903982]
curr_Stock_Price:  96.30122051792101
curr_Factors:  [96.30122052 -0.72724249 -0.99286446]
mat_Sqrt:  [[17.24244433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139649 -0.0174521   0.09151297]
Stock Position:  0.0013964939605756092
Bond Position:  [-1.79352389]


portfolio before change:  [-1.65834215]
curr_Stock_Price:  96.96135065290676
curr_Factors:  [96.96135065 -0.81070135 -0.96990199]
mat_Sqrt:  [[16.34152002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0072794  0.0962654  0.72973479]
Stock Position:  0.007279403831837888
Bond Position:  [-2.36416298]


portfolio before change:  [-1.65508294]
curr_Stock_Price:  97.44968148257027
curr_Factors:  [97.44968148 -0.93482126 -0.96688936]
mat_Sqrt:  [[14.5505026   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00198659 -0.00173984  0.04759887]
Stock Position:  0.001986587401105174
Bond Position:  [-1.84867524]


portfolio before change:  [-1.65488748]
curr_Stock_Price:  97.66440077850713
curr_Factors:  [97.66440078 -1.21157999 -1.00540893]
mat_Sqrt:  [[10.63923093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01048154 -0.01660973  0.10384708]
Stock Position:  0.01048154445220774
Bond Position:  [-2.67856123]


portfolio before change:  [-1.64926171]
curr_Stock_Price:  98.23307729463724
curr_Factors:  [98.23307729 -1.32872998 -1.03566696]
mat_Sqrt:  [[ 9.23449614  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00852564 -0.01646851 -0.17651425]
Stock Position:  -0.008525640885942579
Bond Position:  [-0.81176177]


portfolio before change:  [-1.64697162]
curr_Stock_Price:  97.95256288470557
curr_Factors:  [97.95256288 -1.27647504 -1.02244759]
mat_Sqrt:  [[ 9.83119678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01570642  0.00805544  0.00223654]
Stock Position:  -0.01570642360286798
Bond Position:  [-0.10848717]


portfolio before change:  [-1.63870989]
curr_Stock_Price:  97.42569013425847
curr_Factors:  [97.42569013 -1.42348984 -1.01402466]
mat_Sqrt:  [[ 8.51283845  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00816143  0.0037549  -0.07427818]
Stock Position:  0.008161428580042786
Bond Position:  [-2.43384271]


portfolio before change:  [-1.6361937]
curr_Stock_Price:  97.7712716993072
curr_Factors:  [97.7712717  -1.38830812 -1.03574404]
mat_Sqrt:  [[ 8.65882147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00486056 -0.01600868  0.66446661]
Stock Position:  0.004860563906845179
Bond Position:  [-2.11141722]


portfolio before change:  [-1.63624934]
curr_Stock_Price:  97.81412785044505
curr_Factors:  [97.81412785 -1.45260576 -1.02432289]
mat_Sqrt:  [[ 8.21646754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02665243 -0.03397229  0.31818209]
Stock Position:  0.026652427853253557
Bond Position:  [-4.24323333]


portfolio before change:  [-1.64579272]
curr_Stock_Price:  97.47596205511881
curr_Factors:  [97.47596206 -1.27263817 -1.03553506]
mat_Sqrt:  [[ 9.69327718  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371409 -0.02596141  0.01519344]
Stock Position:  -0.0037140927294075305
Bond Position:  [-1.28375796]


portfolio before change:  [-1.64907869]
curr_Stock_Price:  98.31748485397421
curr_Factors:  [98.31748485 -1.48908317 -1.06212645]
mat_Sqrt:  [[ 7.66751261  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00703965 -0.01193669  0.0604656 ]
Stock Position:  0.007039651444832843
Bond Position:  [-2.34119952]


portfolio before change:  [-1.65094416]
curr_Stock_Price:  98.09406476017445
curr_Factors:  [98.09406476 -1.54468611 -1.0535223 ]
mat_Sqrt:  [[ 7.29886204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078408  0.02139983 -0.05106289]
Stock Position:  0.0007840767674063761
Bond Position:  [-1.72785744]


portfolio before change:  [-1.6514918]
curr_Stock_Price:  97.67109131029548
curr_Factors:  [97.67109131 -1.24021434 -1.05325623]
mat_Sqrt:  [[ 9.85653861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00360893 -0.00449636 -0.23042591]
Stock Position:  0.003608933633598646
Bond Position:  [-2.00398029]


portfolio before change:  [-1.65274593]
curr_Stock_Price:  97.39300009913485
curr_Factors:  [97.3930001  -1.3000483  -1.06689762]
mat_Sqrt:  [[ 9.13221633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00841978  0.00287723 -0.10265321]
Stock Position:  -0.008419778350520156
Bond Position:  [-0.83271845]


portfolio before change:  [-1.65350485]
curr_Stock_Price:  97.47077285228481
curr_Factors:  [97.47077285 -1.19664057 -1.10086692]
mat_Sqrt:  [[ 9.79669494  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00846886 -0.00322746  0.14696929]
Stock Position:  -0.008468855426189976
Bond Position:  [-0.82803897]


portfolio before change:  [-1.65062291]
curr_Stock_Price:  97.11825191240051
curr_Factors:  [97.11825191 -1.16808403 -1.12322415]
mat_Sqrt:  [[ 9.8219644   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355468 -0.00967528 -0.02260853]
Stock Position:  -0.0035546803502156743
Bond Position:  [-1.30539857]


portfolio before change:  [-1.65134776]
curr_Stock_Price:  97.27625802801691
curr_Factors:  [97.27625803 -1.29837243 -1.11464696]
mat_Sqrt:  [[ 8.71055546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00878689  0.00275429  0.16029137]
Stock Position:  -0.008786892532089705
Bond Position:  [-0.79659174]


portfolio before change:  [-1.65195866]
curr_Stock_Price:  97.33444860897006
curr_Factors:  [97.33444861 -1.4003876  -1.0986827 ]
mat_Sqrt:  [[ 7.99712956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01765185 -0.02076027 -0.21522227]
Stock Position:  -0.017651854350432004
Bond Position:  [0.06617485]


portfolio before change:  [-1.63910561]
curr_Stock_Price:  96.6067756724684
curr_Factors:  [96.60677567 -1.31527459 -1.08219553]
mat_Sqrt:  [[ 8.78616882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.20246289 0.32592314 0.39836442]
Stock Position:  0.20246289282995322
Bond Position:  [-21.19839288]


portfolio before change:  [-1.61227113]
curr_Stock_Price:  96.75240453311677
curr_Factors:  [96.75240453 -1.15536723 -1.07631309]
mat_Sqrt:  [[10.38616734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00264358 -0.04058455  0.04171998]
Stock Position:  0.002643582523156141
Bond Position:  [-1.8680441]


portfolio before change:  [-1.6138615]
curr_Stock_Price:  96.23914378519127
curr_Factors:  [96.23914379 -1.2200874  -1.06070772]
mat_Sqrt:  [[ 9.83592069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00195476 -0.00477623 -0.1288125 ]
Stock Position:  0.0019547582666122622
Bond Position:  [-1.80198576]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.61314508]
Stock Price:  96.72087953610614
PL:  [-1.61314508]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.16784863e-01 -3.27420583e-02 -7.57302836e-02]
 [ 1.50634699e+00  3.13281564e-01  4.85405823e-01]
 [ 1.29690584e-01  2.39773832e-01  4.29973334e-02]
 [ 3.27032480e-02  2.30517535e-01  2.07586201e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-1.14909151e-01  7.01441081e-02 -1.24067643e-01]
 [-3.44901928e-02 -1.04553625e-01 -7.61893558e-03]
 [ 2.32948398e-01 -9.66565194e-03 -2.30324004e-01]
 [ 7.09483777e-03  7.28554929e-02 -4.77631719e-02]
 [-4.61403538e-01  8.17317112e-02 -1.64614780e-01]
 [ 4.65357337e-01  9.25120121e-01 -1.56889201e-01]
 [-1.53476644e-04  2.22125014e-02 -5.80433539e-02]
 [-1.32450644e-01 -4.99896523e-03 -2.79299055e-01]
 [ 1.58818813e+00 -3.04368711e+00  2.54926982e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.40858276e-01 -7.34354474e-02  1.46455549e-02]
 [-1.85574110e-01 -2.79394117e-01 -2.08254652e-02]
 [-2.63431043e-01 -1.72920214e+00 -2.03275326e-01]
 [ 1.24814659e-03  3.71011497e-02  5.92793810e-02]
 [ 1.60138800e-01 -7.51782237e-02  2.76516586e-01]
 [ 5.03278842e-02  1.53563523e-02  5.62962698e-02]
 [ 1.36500122e-01 -5.31071101e-02 -1.30805135e-02]
 [ 3.83349321e-01  4.57843949e-02  1.38946869e-01]
 [-6.46879613e-02 -5.05887934e-02  7.82770522e-02]
 [ 2.42119067e-02 -1.33594448e-01  3.00900229e-02]
 [ 6.14184206e-02 -1.94732138e-02  2.98185136e-01]
 [-1.97272288e-01 -1.31096872e-01 -7.33623221e-02]
 [-7.45349114e-02  4.81606046e-02  1.22673336e-01]
 [-1.47936338e-02 -8.00656847e-02 -1.20177118e-02]
 [ 3.08070453e-01 -8.53104614e-02 -6.47777920e-02]
 [-2.72007794e-02 -7.69570682e-02 -2.45981747e-02]
 [ 8.94855791e-02  2.74587519e-02 -8.73985155e-02]
 [-8.72938895e-02 -4.72457456e-02  1.78140526e-02]
 [ 4.50924211e-01  6.26931737e-02  1.05409624e-01]
 [ 5.62854674e-02  8.12439212e-02 -6.05692589e-02]
 [-4.28786964e-02  2.95371516e-03 -3.52210062e-02]
 [ 2.25110550e+00  1.58467404e+00  1.93005944e-01]
 [-1.13737247e-01  1.60178908e-02 -8.88448347e-03]
 [ 3.78420097e-02 -1.25659852e-02 -1.73064656e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.41424751]
curr_Stock_Price:  100.81965332989921
curr_Factors:  [100.81965333  -1.10281724  -0.99708365]
mat_Sqrt:  [[12.34723832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00766512 -0.01056745 -0.21603742]
Stock Position:  0.007665117985137236
Bond Position:  [7.64145297]


portfolio before change:  [8.417001]
curr_Stock_Price:  101.05425578679372
curr_Factors:  [101.05425579  -1.16746323  -0.98592948]
mat_Sqrt:  [[11.73135111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.14230061 0.10111119 1.3847277 ]
Stock Position:  0.142300605626129
Bond Position:  [-5.9630808]


portfolio before change:  [8.56551473]
curr_Stock_Price:  102.10315615884004
curr_Factors:  [102.10315616  -0.99844324  -0.98697585]
mat_Sqrt:  [[14.02111687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01336634 0.07738667 0.12265942]
Stock Position:  0.013366339382021855
Bond Position:  [7.20076929]


portfolio before change:  [8.57739006]
curr_Stock_Price:  102.92426178212321
curr_Factors:  [102.92426178  -1.01245376  -1.02949281]
mat_Sqrt:  [[13.35708328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00914352 0.07439921 0.59218565]
Stock Position:  0.009143523021412185
Bond Position:  [7.6362997]


portfolio before change:  [8.5828862]
curr_Stock_Price:  103.42095646385465
curr_Factors:  [103.42095646  -0.92355802  -1.03532117]
mat_Sqrt:  [[14.58404929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00402124 -0.01106097 -0.05874131]
Stock Position:  -0.004021242643429867
Bond Position:  [8.99876696]


portfolio before change:  [8.58341469]
curr_Stock_Price:  103.56927539426678
curr_Factors:  [103.56927539  -1.06762422  -1.03118403]
mat_Sqrt:  [[12.69784728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00991635  0.02263891 -0.35393045]
Stock Position:  -0.009916345975389183
Bond Position:  [9.61044345]


portfolio before change:  [8.58106613]
curr_Stock_Price:  103.92726370931511
curr_Factors:  [103.92726371  -1.16710279  -1.02032929]
mat_Sqrt:  [[11.66110782  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00492126 -0.03374454 -0.0217347 ]
Stock Position:  -0.004921258058798811
Bond Position:  [9.09251901]


portfolio before change:  [8.58205062]
curr_Stock_Price:  103.95817926106034
curr_Factors:  [103.95817926  -1.17305731  -1.00963813]
mat_Sqrt:  [[11.71995868  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01569636 -0.00311958 -0.65705027]
Stock Position:  0.01569636204328859
Bond Position:  [6.9502854]


portfolio before change:  [8.58303703]
curr_Stock_Price:  103.96566934437595
curr_Factors:  [103.96566934  -1.20304157  -0.99523688]
mat_Sqrt:  [[11.53957337  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00105869  0.02351401 -0.13625503]
Stock Position:  0.0010586861365458043
Bond Position:  [8.47297002]


portfolio before change:  [8.5841379]
curr_Stock_Price:  104.00504302688447
curr_Factors:  [104.00504303  -1.06348676  -1.00645514]
mat_Sqrt:  [[13.12472014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03644436  0.0263788  -0.46960015]
Stock Position:  -0.03644435600697104
Bond Position:  [12.37453472]


portfolio before change:  [8.57975431]
curr_Stock_Price:  104.16777069947662
curr_Factors:  [104.1677707   -1.12950047  -0.99553782]
mat_Sqrt:  [[12.44058972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05001144  0.29858124 -0.44756122]
Stock Position:  0.05001144086149761
Bond Position:  [3.37017401]


portfolio before change:  [8.54525257]
curr_Stock_Price:  103.46946977692521
curr_Factors:  [103.46946978  -0.92938447  -1.00434559]
mat_Sqrt:  [[14.96249186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049908  0.00716905 -0.16558153]
Stock Position:  -0.0004990758798796262
Bond Position:  [8.59689169]


portfolio before change:  [8.54684462]
curr_Stock_Price:  102.43281426260128
curr_Factors:  [102.43281426  -0.74762958  -1.00995237]
mat_Sqrt:  [[17.6657044   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01078263 -0.00161341 -0.79676246]
Stock Position:  -0.01078262885263641
Bond Position:  [9.65133964]


portfolio before change:  [8.54613465]
curr_Stock_Price:  102.61055037944516
curr_Factors:  [102.61055038  -0.78022205  -0.97491876]
mat_Sqrt:  [[17.73960916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08383869 -0.98234579  7.27235721]
Stock Position:  0.08383869171102333
Bond Position:  [-0.05659965]


portfolio before change:  [8.56027151]
curr_Stock_Price:  102.779254556355
curr_Factors:  [102.77925456  -0.6102662   -1.00513828]
mat_Sqrt:  [[20.43356825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106048 -0.03053791  0.10625201]
Stock Position:  -0.0010604791396805003
Bond Position:  [8.66926677]


portfolio before change:  [8.56116801]
curr_Stock_Price:  102.95580837379346
curr_Factors:  [102.95580837  -0.70618636  -1.04451082]
mat_Sqrt:  [[17.87856784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00720739 -0.02370119  0.04177969]
Stock Position:  0.007207391594783761
Bond Position:  [7.81912518]


portfolio before change:  [8.56649331]
curr_Stock_Price:  103.5590575627569
curr_Factors:  [103.55905756  -0.49155757  -1.03874114]
mat_Sqrt:  [[22.41753232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01101175 -0.09017406 -0.05940926]
Stock Position:  -0.011011746157597676
Bond Position:  [9.70685937]


portfolio before change:  [8.57199321]
curr_Stock_Price:  103.16979453515877
curr_Factors:  [103.16979454  -0.58454819  -1.00830235]
mat_Sqrt:  [[20.97907643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03135964 -0.55809759 -0.57988792]
Stock Position:  -0.03135964335742561
Bond Position:  [11.80736117]


portfolio before change:  [8.60888732]
curr_Stock_Price:  102.04037824403133
curr_Factors:  [102.04037824  -0.64567985  -1.03028136]
mat_Sqrt:  [[19.09463475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00109569 0.01197434 0.16910757]
Stock Position:  0.0010956868410181293
Bond Position:  [8.49708302]


portfolio before change:  [8.60853879]
curr_Stock_Price:  100.75284582816921
curr_Factors:  [100.75284583  -0.666993    -1.00572148]
mat_Sqrt:  [[18.91501327  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.010639   -0.02426367  0.78882485]
Stock Position:  0.010638999707634711
Bond Position:  [7.53662929]


portfolio before change:  [8.62336424]
curr_Stock_Price:  102.05779179709732
curr_Factors:  [102.0577918   -0.57791865  -0.9925969 ]
mat_Sqrt:  [[21.22168819  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00306073 0.00495624 0.16059759]
Stock Position:  0.003060732675883209
Bond Position:  [8.31099262]


portfolio before change:  [8.62280467]
curr_Stock_Price:  101.53552855228249
curr_Factors:  [101.53552855  -0.44067461  -0.99215921]
mat_Sqrt:  [[24.22959822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00507601 -0.01714025 -0.03731506]
Stock Position:  0.005076007815316382
Bond Position:  [8.10740954]


portfolio before change:  [8.61568105]
curr_Stock_Price:  99.93247506416377
curr_Factors:  [99.93247506 -0.21908372 -0.96422265]
mat_Sqrt:  [[30.60576352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01375746 0.01477685 0.39637674]
Stock Position:  0.013757455601901057
Bond Position:  [7.24086446]


portfolio before change:  [8.59488368]
curr_Stock_Price:  98.35496427203216
curr_Factors:  [98.35496427 -0.14972335 -0.99518435]
mat_Sqrt:  [[31.30179084  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188603 -0.01632746  0.22330264]
Stock Position:  -0.0018860300818933158
Bond Position:  [8.7803841]


portfolio before change:  [8.59440106]
curr_Stock_Price:  99.19283002475247
curr_Factors:  [ 9.91928300e+01 -5.66428538e-02 -9.95821027e-01]
mat_Sqrt:  [[34.62589641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.90707422e-05 -4.31174228e-02  8.58384600e-02]
Stock Position:  8.90707422114651e-05
Bond Position:  [8.58556588]


portfolio before change:  [8.59540426]
curr_Stock_Price:  98.40631417833224
curr_Factors:  [ 9.84063142e+01 -2.05646339e-03 -1.01783572e+00]
mat_Sqrt:  [[35.48864487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00333375 -0.00628495  0.85063919]
Stock Position:  0.003333749537178539
Bond Position:  [8.26734226]


portfolio before change:  [8.59887605]
curr_Stock_Price:  99.13771341488474
curr_Factors:  [ 9.91377134e+01  7.11060057e-02 -1.02620528e+00]
mat_Sqrt:  [[38.14560889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00626566 -0.04231133 -0.20928228]
Stock Position:  -0.006265658169067865
Bond Position:  [9.22003907]


portfolio before change:  [8.57899083]
curr_Stock_Price:  102.49534828201172
curr_Factors:  [102.49534828   0.14080903  -1.0346213 ]
mat_Sqrt:  [[41.93015018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094594  0.01554377  0.34995288]
Stock Position:  -0.0009459441263423729
Bond Position:  [8.67594571]


portfolio before change:  [8.57787074]
curr_Stock_Price:  104.82598399331454
curr_Factors:  [ 1.04825984e+02  1.61963447e-02 -1.00452648e+00]
mat_Sqrt:  [[39.01598938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086093 -0.02584109 -0.03428319]
Stock Position:  -0.0008609310931344782
Bond Position:  [8.66811869]


portfolio before change:  [8.57699145]
curr_Stock_Price:  107.10592790594463
curr_Factors:  [107.10592791  -0.29082111  -0.99071089]
mat_Sqrt:  [[29.73385583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00933057 -0.02753383 -0.18479301]
Stock Position:  0.00933056977276243
Bond Position:  [7.57763212]


portfolio before change:  [8.56148919]
curr_Stock_Price:  105.34295641827212
curr_Factors:  [105.34295642  -0.38056613  -0.99889329]
mat_Sqrt:  [[26.51635905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180759 -0.02483779 -0.07017175]
Stock Position:  -0.0018075881559237524
Bond Position:  [8.75190587]


portfolio before change:  [8.56441629]
curr_Stock_Price:  104.32887353470525
curr_Factors:  [104.32887353  -0.46984561  -1.00434629]
mat_Sqrt:  [[23.8875227   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00323392  0.00886227 -0.24932364]
Stock Position:  0.0032339237134729427
Bond Position:  [8.22702467]


portfolio before change:  [8.56411487]
curr_Stock_Price:  103.91765157813452
curr_Factors:  [103.91765158  -0.58449362  -1.0087399 ]
mat_Sqrt:  [[21.12305833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00441705 -0.0152485   0.05081853]
Stock Position:  -0.004417050185361226
Bond Position:  [9.02312435]


portfolio before change:  [8.56097333]
curr_Stock_Price:  104.88424629232222
curr_Factors:  [104.88424629  -0.59135544  -1.02095583]
mat_Sqrt:  [[20.91666176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02319864 0.02023413 0.30070432]
Stock Position:  0.023198637347819406
Bond Position:  [6.12780174]


portfolio before change:  [8.53907741]
curr_Stock_Price:  103.90738071426141
curr_Factors:  [103.90738071  -0.60979277  -1.02908366]
mat_Sqrt:  [[20.17861747  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0029985   0.02622136 -0.17278724]
Stock Position:  0.0029985039982698934
Bond Position:  [8.22751071]


portfolio before change:  [8.54156494]
curr_Stock_Price:  104.39396820182394
curr_Factors:  [104.3939682   -0.53177413  -1.02657449]
mat_Sqrt:  [[21.97319451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225116  0.00095331 -0.10047573]
Stock Position:  -0.002251162413202225
Bond Position:  [8.77657272]


portfolio before change:  [8.54051539]
curr_Stock_Price:  105.34756053859
curr_Factors:  [105.34756054  -0.67791734  -1.02235931]
mat_Sqrt:  [[19.2399402   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.1358618  0.51145135 0.55059223]
Stock Position:  0.13586179978961974
Bond Position:  [-5.77219379]


portfolio before change:  [8.613423]
curr_Stock_Price:  105.88950223468564
curr_Factors:  [105.88950223  -0.56208745  -1.04212934]
mat_Sqrt:  [[21.28876206  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0052742   0.00516975 -0.02534496]
Stock Position:  -0.0052741980073971965
Bond Position:  [9.1719052]


portfolio before change:  [8.61498748]
curr_Stock_Price:  105.81026241731264
curr_Factors:  [105.81026242  -0.67669567  -1.03703888]
mat_Sqrt:  [[19.0661205   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.60599613e-06 -4.05565430e-03 -4.93705291e-01]
Stock Position:  -2.6059961313962786e-06
Bond Position:  [8.61526322]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.61606738]
Stock Price:  104.68916767952278
PL:  [3.9268997]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.08252600e-01 -4.37565546e-02 -1.42667547e-01]
 [ 1.28304928e+00  2.62478763e-01  3.85287902e-01]
 [-1.29222734e-01 -3.24764638e-02  3.35658658e-02]
 [ 9.40259207e-02  8.24578387e-01  6.17290453e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 7.17343891e-02 -5.33721206e-02  5.16025599e-02]
 [-3.21888650e-02 -1.19266517e-01  2.13006366e-03]
 [ 1.59813603e-01  5.17793644e-02 -1.45540284e-01]
 [-6.90478810e-04  8.12804637e-02 -4.90431404e-02]
 [-3.63101320e-01 -3.37400392e-02 -1.46638740e-01]
 [ 7.67265191e-01  1.47948104e+00 -2.66622124e-01]
 [-1.94594843e-04  3.27036867e-02 -5.83824008e-02]
 [-2.35470127e-01 -1.06088790e-02 -5.00650123e-01]
 [ 1.66371196e+00 -3.20006646e+00  2.68328529e+00]
 [-5.97802270e-03 -9.39472862e-02  3.68331204e-02]
 [ 1.32438872e-01 -4.51042777e-02 -4.23658880e-03]
 [-9.57622380e-02 -8.23604707e-02 -5.03263768e-02]
 [-2.72644253e-01 -1.77282195e+00 -2.00079367e-01]
 [ 1.97626522e-04  3.41411759e-02  7.69886363e-02]
 [ 2.39221946e-01 -3.75858569e-01  2.13385455e-01]
 [ 5.45070816e-02  6.90941256e-02  6.24095610e-03]
 [ 1.59901176e-01 -5.57094035e-02 -2.13953671e-02]
 [ 2.70563709e-01  2.36617012e-01  2.35567418e-01]
 [-2.20098938e-01  7.60941673e-02  4.96500864e-02]
 [-4.71737323e-02 -2.29575329e-01  7.93233653e-02]
 [ 6.41862531e-02 -9.69615798e-03  1.17808083e-01]
 [ 1.16611324e-01 -8.56421743e-02  4.58681684e-02]
 [-8.57416673e-02  5.25377338e-02  1.38422295e-01]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [-4.16927123e-02  8.51330933e-02  1.71443273e-02]
 [-1.60103100e-02 -1.63015579e-02 -6.69464365e-02]
 [-1.41272385e-03  1.90918574e-02 -5.81879885e-02]
 [-9.72036486e-02 -3.48032133e-02  3.91501805e-02]
 [ 1.88649153e-01  6.89204854e-03  3.24731276e-02]
 [ 4.53438521e-02 -1.25242075e-02 -5.47865423e-03]
 [-1.19087438e-01 -6.76144846e-02 -8.47472202e-02]
 [ 2.07779454e+00  1.34738743e+00  1.61137118e-01]
 [-5.17146706e-02  2.49916813e-03  6.24493968e-03]
 [ 3.43238205e-02 -1.37618488e-02 -9.19199299e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.98683215]
curr_Stock_Price:  100.48840434755787
curr_Factors:  [100.48840435  -1.1669571   -0.99520764]
mat_Sqrt:  [[11.56377766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00607059 -0.01412237 -0.4069908 ]
Stock Position:  0.006070588866598938
Bond Position:  [5.37680836]


portfolio before change:  [5.98848174]
curr_Stock_Price:  100.64941770156287
curr_Factors:  [100.6494177   -1.04359072  -0.96316934]
mat_Sqrt:  [[13.52964652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.1046054  0.08471466 1.09911914]
Stock Position:  0.10460540056862051
Bond Position:  [-4.53999092]


portfolio before change:  [6.0233158]
curr_Stock_Price:  100.98784761714484
curr_Factors:  [100.98784762  -1.16961216  -0.95211805]
mat_Sqrt:  [[12.10078083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0106605  -0.01048173  0.09575407]
Stock Position:  -0.010660498934403588
Bond Position:  [7.09989664]


portfolio before change:  [6.01671177]
curr_Stock_Price:  101.69058861929555
curr_Factors:  [101.69058862  -1.21368958  -0.96851521]
mat_Sqrt:  [[11.46994306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03385772 0.26613153 1.76095784]
Stock Position:  0.03385772390332774
Bond Position:  [2.5736999]


portfolio before change:  [6.03571939]
curr_Stock_Price:  102.24248276883593
curr_Factors:  [102.24248277  -1.11552353  -0.99046435]
mat_Sqrt:  [[12.44550344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00471222 -0.01106097 -0.05874131]
Stock Position:  -0.004712224075528011
Bond Position:  [6.51750887]


portfolio before change:  [6.03874925]
curr_Stock_Price:  101.77240140853465
curr_Factors:  [101.77240141  -1.13553922  -0.99244212]
mat_Sqrt:  [[12.11879581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00588946 -0.01722578  0.14720774]
Stock Position:  0.005889461306484602
Bond Position:  [5.43936463]


portfolio before change:  [6.04373002]
curr_Stock_Price:  102.50265549926202
curr_Factors:  [102.5026555   -1.27375642  -1.01371394]
mat_Sqrt:  [[10.40637231  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00539085 -0.0384931   0.00607648]
Stock Position:  -0.005390854927929692
Bond Position:  [6.59630697]


portfolio before change:  [6.04425339]
curr_Stock_Price:  102.55853161025422
curr_Factors:  [102.55853161  -1.31500477  -0.98837922]
mat_Sqrt:  [[10.24766308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01372749  0.01671172 -0.41518592]
Stock Position:  0.0137274942443137
Bond Position:  [4.63638174]


portfolio before change:  [6.04558104]
curr_Stock_Price:  102.61302546559995
curr_Factors:  [102.61302547  -1.31042297  -1.03046271]
mat_Sqrt:  [[ 9.87571976  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00059641  0.02623316 -0.13990643]
Stock Position:  0.000596405871193279
Bond Position:  [5.98438203]


portfolio before change:  [6.0461741]
curr_Stock_Price:  102.35307930549077
curr_Factors:  [102.35307931  -1.23166139  -1.02927341]
mat_Sqrt:  [[10.67061387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03747872 -0.01088955 -0.41831951]
Stock Position:  -0.03747872320987947
Bond Position:  [9.88223683]


portfolio before change:  [6.08312391]
curr_Stock_Price:  101.40015313217606
curr_Factors:  [101.40015313  -1.14995124  -1.03538371]
mat_Sqrt:  [[11.40143983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08900972  0.47750045 -0.76059871]
Stock Position:  0.08900972117202793
Bond Position:  [-2.94247544]


portfolio before change:  [6.07113421]
curr_Stock_Price:  101.26958456323977
curr_Factors:  [101.26958456  -1.23488683  -1.02211268]
mat_Sqrt:  [[10.59928562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051289  0.01055507 -0.16654874]
Stock Position:  -0.000512887433454495
Bond Position:  [6.12307411]


portfolio before change:  [6.07176402]
curr_Stock_Price:  101.53400480443331
curr_Factors:  [101.5340048   -1.33137353  -1.04010567]
mat_Sqrt:  [[ 9.47744316  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03585676 -0.003424   -1.42821545]
Stock Position:  -0.035856763056656554
Bond Position:  [9.71244477]


portfolio before change:  [6.05950631]
curr_Stock_Price:  101.90971756857066
curr_Factors:  [101.90971757  -0.9766796   -1.08067603]
mat_Sqrt:  [[13.02319067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11964998 -1.03281701  7.65466606]
Stock Position:  0.11964997533139948
Bond Position:  [-6.13398888]


portfolio before change:  [5.97871982]
curr_Stock_Price:  101.24093601636385
curr_Factors:  [101.24093602  -0.94508692  -1.08113927]
mat_Sqrt:  [[13.34680459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013214  -0.03032136  0.10507464]
Stock Position:  -0.001321395159668854
Bond Position:  [6.1124991]


portfolio before change:  [5.97869239]
curr_Stock_Price:  101.8399550022
curr_Factors:  [101.839955    -1.06379528  -1.08361082]
mat_Sqrt:  [[11.89355208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01028853 -0.01455734 -0.01208581]
Stock Position:  0.010288533553130731
Bond Position:  [4.93090859]


portfolio before change:  [5.97267989]
curr_Stock_Price:  101.19565520090927
curr_Factors:  [101.1956552   -1.06727828  -1.05753771]
mat_Sqrt:  [[12.08832158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01016244 -0.02658173 -0.14356714]
Stock Position:  -0.010162438729228195
Bond Position:  [7.00107453]


portfolio before change:  [5.9756215]
curr_Stock_Price:  100.9923156358529
curr_Factors:  [100.99231564  -0.8993512   -1.04321217]
mat_Sqrt:  [[14.47584013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04665436 -0.57217582 -0.57077074]
Stock Position:  -0.046654359356964555
Bond Position:  [10.68735329]


portfolio before change:  [5.93541757]
curr_Stock_Price:  101.88269199025271
curr_Factors:  [101.88269199  -0.80906837  -1.04379536]
mat_Sqrt:  [[15.97393517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00143245 0.01101902 0.21962715]
Stock Position:  0.0014324525664112392
Bond Position:  [5.78947544]


portfolio before change:  [5.93774808]
curr_Stock_Price:  103.00439369605652
curr_Factors:  [103.0043937   -0.69267113  -1.0281192 ]
mat_Sqrt:  [[18.43002849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01118052 -0.12130783  0.60872931]
Stock Position:  0.011180517761991695
Bond Position:  [4.78610563]


portfolio before change:  [5.93831329]
curr_Stock_Price:  103.0014341745595
curr_Factors:  [103.00143417  -0.51021039  -1.02249454]
mat_Sqrt:  [[22.24323647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00314184 0.02230003 0.01780371]
Stock Position:  0.0031418445271314426
Bond Position:  [5.6146988]


portfolio before change:  [5.93783298]
curr_Stock_Price:  102.6251586650355
curr_Factors:  [102.62515867  -0.77537324  -1.03106215]
mat_Sqrt:  [[16.85500629  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00855308 -0.01798013 -0.06103503]
Stock Position:  0.008553080767475994
Bond Position:  [5.0600717]


portfolio before change:  [5.94632258]
curr_Stock_Price:  103.54378131157401
curr_Factors:  [103.54378131  -0.67820525  -1.05600175]
mat_Sqrt:  [[18.27963377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02007414 0.07636781 0.67200828]
Stock Position:  0.02007414134267652
Bond Position:  [3.86777008]


portfolio before change:  [5.94896065]
curr_Stock_Price:  103.65111189728398
curr_Factors:  [103.6511119   -0.5953794   -1.03301113]
mat_Sqrt:  [[20.34103033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00955859  0.02455929  0.14163788]
Stock Position:  -0.009558586576436087
Bond Position:  [6.93971878]


portfolio before change:  [5.96158476]
curr_Stock_Price:  102.4211606429614
curr_Factors:  [102.42116064  -0.39184368  -1.04196983]
mat_Sqrt:  [[24.41700545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031881  -0.07409512  0.22628748]
Stock Position:  -0.003188097168510536
Bond Position:  [6.28811338]


portfolio before change:  [5.96581195]
curr_Stock_Price:  101.34179520621771
curr_Factors:  [101.34179521  -0.18097948  -1.04049487]
mat_Sqrt:  [[29.87507654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00288717 -0.00312942  0.33607367]
Stock Position:  0.0028871727704696246
Bond Position:  [5.67322068]


portfolio before change:  [5.96615894]
curr_Stock_Price:  101.21634069059016
curr_Factors:  [101.21634069  -0.3523582   -1.0086077 ]
mat_Sqrt:  [[25.95318421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00418032 -0.02764089  0.13084912]
Stock Position:  0.004180315149278218
Bond Position:  [5.54304273]


portfolio before change:  [5.96542827]
curr_Stock_Price:  100.87579431623405
curr_Factors:  [100.87579432  -0.42752795  -1.01033761]
mat_Sqrt:  [[23.95134402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195238  0.01695648  0.39488028]
Stock Position:  -0.0019523795713764177
Bond Position:  [6.16237611]


portfolio before change:  [5.96435074]
curr_Stock_Price:  101.82226598224082
curr_Factors:  [101.82226598  -0.42106038  -1.00526096]
mat_Sqrt:  [[24.45677969  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0009036  -0.02321455 -0.0028026 ]
Stock Position:  -0.0009035953505537109
Bond Position:  [6.05635687]


portfolio before change:  [5.96739564]
curr_Stock_Price:  99.29037780999738
curr_Factors:  [99.29037781 -0.37055823 -0.99930289]
mat_Sqrt:  [[25.2338803   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008249   0.02747659  0.04890799]
Stock Position:  -0.0008248997399678786
Bond Position:  [6.04930024]


portfolio before change:  [5.96692574]
curr_Stock_Price:  100.7767515234582
curr_Factors:  [100.77675152  -0.42053677  -0.97507542]
mat_Sqrt:  [[24.96052318  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132222 -0.00526131 -0.19097955]
Stock Position:  -0.0013222173056407235
Bond Position:  [6.1001745]


portfolio before change:  [5.96820146]
curr_Stock_Price:  100.38865290419153
curr_Factors:  [100.3886529   -0.26532337  -0.99020348]
mat_Sqrt:  [[28.60330681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003284   0.00616187 -0.16599413]
Stock Position:  -0.00032839518366330694
Bond Position:  [6.00116861]


portfolio before change:  [5.96926739]
curr_Stock_Price:  99.42718672316164
curr_Factors:  [99.42718672 -0.48002652 -0.95353293]
mat_Sqrt:  [[23.70927063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00406239 -0.01123269  0.11168457]
Stock Position:  -0.004062391001021023
Bond Position:  [6.3731795]


portfolio before change:  [5.96253648]
curr_Stock_Price:  101.28018508557747
curr_Factors:  [101.28018509  -0.35959561  -0.98100778]
mat_Sqrt:  [[26.50378084  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.007421   0.0022244  0.09263679]
Stock Position:  0.007420999194585893
Bond Position:  [5.21093631]


portfolio before change:  [5.95733589]
curr_Stock_Price:  100.49161147488638
curr_Factors:  [100.49161147  -0.30822412  -0.9657471 ]
mat_Sqrt:  [[28.10937174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148239 -0.00404217 -0.01562908]
Stock Position:  0.0014823893519751324
Bond Position:  [5.80836819]


portfolio before change:  [5.95727001]
curr_Stock_Price:  99.95736067048861
curr_Factors:  [ 9.99573607e+01 -3.90368018e-02 -9.57944237e-01]
mat_Sqrt:  [[36.88343974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00407197 -0.02182248 -0.24176023]
Stock Position:  -0.004071966774092007
Bond Position:  [6.36429306]


portfolio before change:  [5.95572411]
curr_Stock_Price:  100.5323875361647
curr_Factors:  [100.53238754  -0.2356186   -0.98341555]
mat_Sqrt:  [[29.70887401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08030331 0.43486742 0.45967934]
Stock Position:  0.08030330689549697
Bond Position:  [-2.11735906]


portfolio before change:  [5.82208459]
curr_Stock_Price:  98.87149918220497
curr_Factors:  [ 9.88714992e+01 -6.20119017e-02 -1.01364022e+00]
mat_Sqrt:  [[33.7226223   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014806   0.0008066   0.01781507]
Stock Position:  -0.001480602150131773
Bond Position:  [5.96847395]


portfolio before change:  [5.82063694]
curr_Stock_Price:  100.35316379359193
curr_Factors:  [100.35316379  -0.2603871   -1.01017339]
mat_Sqrt:  [[28.16655011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00045272 -0.00444162 -0.26222197]
Stock Position:  0.0004527220290354426
Bond Position:  [5.77520486]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.82200689]
Stock Price:  101.78450947053003
PL:  [4.03749742]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-5.17712893e-02 -1.17670718e-02  3.71002493e-01]
 [ 1.85294065e-01  2.02253869e-01  3.67826230e-02]
 [-2.79860637e-01 -1.71135543e-01  3.79597587e-02]
 [ 1.52830177e-01  7.80097603e-01  9.05675144e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.41334507e-02  4.55940753e-02 -1.35520788e-02]
 [-3.79302159e-02 -8.21864417e-02 -2.44694252e-02]
 [ 1.46261208e-01  1.02435901e-01 -1.32466147e-01]
 [ 2.73605845e-02  5.09246798e-02 -4.44313206e-02]
 [-1.94541482e-01 -2.89556784e-02 -5.84066789e-02]
 [ 9.64237131e-01  1.85768957e+00 -3.34049885e-01]
 [ 6.70040704e-05 -4.15666587e-02 -1.28446281e-02]
 [-2.40228308e-01  6.17694436e-03 -5.13056387e-01]
 [ 1.62081505e+00 -2.90538935e+00  2.43936352e+00]
 [ 3.63049600e-03 -9.23275254e-02  3.58368023e-02]
 [ 8.87702913e-02  1.01358462e-01 -8.03086165e-02]
 [-1.72235518e-02  1.48068009e-01 -7.88575430e-02]
 [-2.81585535e-01 -1.82494272e+00 -2.00513603e-01]
 [ 1.34807164e-02  1.18420769e-02  6.43675226e-03]
 [ 8.00853744e-02  1.17495233e-01  2.24392567e-01]
 [ 3.42236970e-02 -5.40985864e-02  8.18750313e-02]
 [ 1.06751744e-01 -5.06207975e-02  2.22343894e-02]
 [ 2.16964263e-01 -1.77571494e-02  2.42556684e-02]
 [-7.65050346e-02 -4.14984776e-02  7.10265693e-02]
 [ 1.10645242e-02 -1.20944494e-01  3.27356380e-02]
 [ 5.25853934e-02 -4.11879939e-02  2.95996435e-01]
 [-1.98821995e-01 -1.32706611e-01 -7.36185908e-02]
 [-1.17646613e-01  7.81110978e-02  1.82612269e-01]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 1.13117534e-01 -7.46401207e-03  5.11567880e-02]
 [-1.73363460e-02 -4.60767182e-02 -4.59390344e-02]
 [ 5.94837966e-02  2.30558359e-02 -7.60062836e-02]
 [-1.11264870e-01 -4.06243223e-02  2.04903940e-02]
 [ 5.42979535e-01  9.04275165e-02  1.55297324e-01]
 [ 1.38919600e-01  2.66234577e-01 -1.58067547e-01]
 [ 1.35731106e-02  2.95246419e-02  6.13280719e-02]
 [ 2.69385231e+00  1.93752846e+00  2.25026525e-01]
 [-9.43345326e-02 -2.87335034e-02 -3.91557573e-03]
 [ 4.02838845e-02 -1.14445664e-02 -2.36636142e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.6986429]
curr_Stock_Price:  98.8937857318351
curr_Factors:  [98.89378573 -0.64531769 -0.99192225]
mat_Sqrt:  [[19.23644124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112065 -0.00379781  1.05836685]
Stock Position:  0.0011206508385334863
Bond Position:  [-5.8094683]


portfolio before change:  [-5.69961436]
curr_Stock_Price:  98.67495879949784
curr_Factors:  [98.6749588  -0.4648766  -0.97303855]
mat_Sqrt:  [[23.42762916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00999193 0.06527716 0.10493059]
Stock Position:  0.009991928040650298
Bond Position:  [-6.68556744]


portfolio before change:  [-5.68700231]
curr_Stock_Price:  100.02082440706249
curr_Factors:  [100.02082441  -0.38480208  -0.96303911]
mat_Sqrt:  [[25.98546173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01181603 -0.05523376  0.10828863]
Stock Position:  -0.01181603133760362
Bond Position:  [-4.50515312]


portfolio before change:  [-5.69259796]
curr_Stock_Price:  100.44672637288005
curr_Factors:  [100.44672637  -0.36242157  -0.99259168]
mat_Sqrt:  [[25.90961797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01917964 0.25177542 2.5836391 ]
Stock Position:  0.019179638174584075
Bond Position:  [-7.61912983]


portfolio before change:  [-5.6921434]
curr_Stock_Price:  100.5200858362771
curr_Factors:  [100.52008584  -0.57230806  -1.04070658]
mat_Sqrt:  [[20.03223918  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00292758 -0.01106097 -0.05874131]
Stock Position:  -0.0029275809069318585
Bond Position:  [-5.39786272]


portfolio before change:  [-5.69746751]
curr_Stock_Price:  102.1081986393798
curr_Factors:  [102.10819864  -0.72237472  -1.07532228]
mat_Sqrt:  [[16.91728733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00417762  0.01471542 -0.03866031]
Stock Position:  0.0041776198764726935
Bond Position:  [-6.12403675]


portfolio before change:  [-5.69932212]
curr_Stock_Price:  101.84750923746569
curr_Factors:  [101.84750924  -0.64171411  -1.0935828 ]
mat_Sqrt:  [[17.96058751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332401 -0.02652556 -0.06980446]
Stock Position:  -0.0033240145152877393
Bond Position:  [-5.36077952]


portfolio before change:  [-5.70416938]
curr_Stock_Price:  103.1041580068034
curr_Factors:  [103.10415801  -0.67514072  -1.0781227 ]
mat_Sqrt:  [[17.85844143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00784678  0.03306104 -0.37788905]
Stock Position:  0.007846782704108055
Bond Position:  [-6.5132053]


portfolio before change:  [-5.70776016]
curr_Stock_Price:  102.7503081804682
curr_Factors:  [102.75030818  -0.61255735  -1.07267302]
mat_Sqrt:  [[19.05008362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150582  0.01643587 -0.12675019]
Stock Position:  0.001505822044180528
Bond Position:  [-5.86248384]


portfolio before change:  [-5.70860295]
curr_Stock_Price:  102.67730412693378
curr_Factors:  [102.67730413  -0.3493154   -1.06191873]
mat_Sqrt:  [[25.03705596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0084824  -0.00934541 -0.166618  ]
Stock Position:  -0.008482396993772241
Bond Position:  [-4.8376533]


portfolio before change:  [-5.69170571]
curr_Stock_Price:  100.6139736102813
curr_Factors:  [100.61397361  -0.39300522  -1.0390714 ]
mat_Sqrt:  [[24.02787306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05307373  0.59956673 -0.95295134]
Stock Position:  0.05307372713793129
Bond Position:  [-11.03166429]


portfolio before change:  [-5.65704466]
curr_Stock_Price:  101.29303079085808
curr_Factors:  [101.29303079  -0.27516065  -1.05411911]
mat_Sqrt:  [[26.80900527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041179 -0.01341558 -0.03664215]
Stock Position:  -0.00041178899528390337
Bond Position:  [-5.6153333]


portfolio before change:  [-5.65729805]
curr_Stock_Price:  100.20370678875679
curr_Factors:  [100.20370679  -0.43673973  -1.0737531 ]
mat_Sqrt:  [[22.12509213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01553416  0.0019936  -1.46360706]
Stock Position:  -0.015534156380076445
Bond Position:  [-4.10071799]


portfolio before change:  [-5.66563517]
curr_Stock_Price:  100.70740361676226
curr_Factors:  [100.70740362  -0.29778067  -1.04758965]
mat_Sqrt:  [[26.22856283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05816895 -0.93771038  6.95882513]
Stock Position:  0.05816894888658006
Bond Position:  [-11.52367899]


portfolio before change:  [-5.75592919]
curr_Stock_Price:  99.1798967256733
curr_Factors:  [99.17989673 -0.32405337 -1.04792524]
mat_Sqrt:  [[25.15248586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031411 -0.02979858  0.10223242]
Stock Position:  -0.0003141090947950004
Bond Position:  [-5.72477589]


portfolio before change:  [-5.75648792]
curr_Stock_Price:  98.68033593556785
curr_Factors:  [98.68033594 -0.40992036 -1.01445222]
mat_Sqrt:  [[23.74835158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00391889  0.0327133  -0.22909813]
Stock Position:  0.003918885602685906
Bond Position:  [-6.14320487]


portfolio before change:  [-5.75708711]
curr_Stock_Price:  98.7233994062222
curr_Factors:  [98.72339941 -0.27607206 -0.99871176]
mat_Sqrt:  [[27.59233926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.12205946e-04  4.77887445e-02 -2.24958620e-01]
Stock Position:  -0.00011220594601864974
Bond Position:  [-5.74600975]


portfolio before change:  [-5.75791028]
curr_Stock_Price:  99.6581063054575
curr_Factors:  [99.65810631 -0.30322096 -1.00962787]
mat_Sqrt:  [[26.81326061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02592113 -0.58899773 -0.5720095 ]
Stock Position:  -0.02592113230208826
Bond Position:  [-3.17465932]


portfolio before change:  [-5.73916691]
curr_Stock_Price:  98.91970394588337
curr_Factors:  [98.91970395 -0.53010787 -1.00498219]
mat_Sqrt:  [[21.31089385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00080766 0.00382201 0.01836226]
Stock Position:  0.0008076557871114209
Bond Position:  [-5.81905998]


portfolio before change:  [-5.74021624]
curr_Stock_Price:  98.52114499346028
curr_Factors:  [98.52114499 -0.49251396 -0.9952956 ]
mat_Sqrt:  [[22.25266177  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00673506 0.03792142 0.64012954]
Stock Position:  0.006735056282926967
Bond Position:  [-6.4037617]


portfolio before change:  [-5.73537217]
curr_Stock_Price:  99.35923624429721
curr_Factors:  [99.35923624 -0.77607527 -0.98689033]
mat_Sqrt:  [[17.04362664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234067 -0.01746024  0.23356667]
Stock Position:  0.0023406720247185655
Bond Position:  [-5.96793955]


portfolio before change:  [-5.73685066]
curr_Stock_Price:  99.04631298867807
curr_Factors:  [99.04631299 -0.77835437 -0.9486536 ]
mat_Sqrt:  [[17.61198398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00573231 -0.01633779  0.06342852]
Stock Position:  0.00573231233844308
Bond Position:  [-6.30461506]


portfolio before change:  [-5.74334999]
curr_Stock_Price:  98.04999560734159
curr_Factors:  [98.04999561 -0.35836402 -0.94131901]
mat_Sqrt:  [[26.73021254  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00816644 -0.0057311   0.06919467]
Stock Position:  0.008166443378545385
Bond Position:  [-6.54406972]


portfolio before change:  [-5.72919258]
curr_Stock_Price:  99.88377575265294
curr_Factors:  [99.88377575 -0.38122686 -0.94833625]
mat_Sqrt:  [[26.42853124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266673 -0.01339358  0.20261903]
Stock Position:  -0.0026667254965846983
Bond Position:  [-5.46282997]


portfolio before change:  [-5.73094714]
curr_Stock_Price:  100.28563966785687
curr_Factors:  [100.28563967  -0.66166228  -0.95682342]
mat_Sqrt:  [[19.87647384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034921 -0.03903467  0.09338566]
Stock Position:  -0.00034920847853795936
Bond Position:  [-5.69592655]


portfolio before change:  [-5.73100433]
curr_Stock_Price:  98.41040450976867
curr_Factors:  [98.41040451 -0.53167672 -0.92847876]
mat_Sqrt:  [[22.85091253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00457741 -0.01329337  0.84439544]
Stock Position:  0.0045774079472362846
Bond Position:  [-6.1814689]


portfolio before change:  [-5.73864085]
curr_Stock_Price:  96.91091231948495
curr_Factors:  [96.91091232 -0.27284763 -0.9302459 ]
mat_Sqrt:  [[29.09884834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00827998 -0.04283087 -0.21001335]
Stock Position:  -0.008279982352458772
Bond Position:  [-4.9362202]


portfolio before change:  [-5.75910263]
curr_Stock_Price:  99.3076220575959
curr_Factors:  [99.30762206 -0.38215807 -0.94224578]
mat_Sqrt:  [[26.41200079  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0024393   0.02521025  0.52094197]
Stock Position:  -0.002439295652125344
Bond Position:  [-5.51686198]


portfolio before change:  [-5.7661015]
curr_Stock_Price:  101.89411603563366
curr_Factors:  [101.89411604  -0.56879551  -0.94892444]
mat_Sqrt:  [[22.33632423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098938 -0.02321455 -0.0028026 ]
Stock Position:  -0.0009893764163390925
Bond Position:  [-5.66528987]


portfolio before change:  [-5.76858653]
curr_Stock_Price:  103.69001286216987
curr_Factors:  [103.69001286  -0.54336869  -0.96293328]
mat_Sqrt:  [[22.99102284  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.005308   -0.002409    0.14593608]
Stock Position:  0.005307997171674019
Bond Position:  [-6.31897282]


portfolio before change:  [-5.77585474]
curr_Stock_Price:  102.46953479096948
curr_Factors:  [102.46953479  -0.70256409  -0.95872219]
mat_Sqrt:  [[19.45840773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185621 -0.0148712  -0.13105128]
Stock Position:  -0.0018562147219287057
Bond Position:  [-5.58564928]


portfolio before change:  [-5.77802279]
curr_Stock_Price:  103.26136299323329
curr_Factors:  [103.26136299  -0.60737863  -0.96761038]
mat_Sqrt:  [[21.37611696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227709  0.00744124 -0.21682477]
Stock Position:  0.0022770895140676217
Bond Position:  [-6.01315816]


portfolio before change:  [-5.77535087]
curr_Stock_Price:  104.76486934694199
curr_Factors:  [104.76486935  -0.25694509  -0.98508418]
mat_Sqrt:  [[30.25584027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0038133  -0.01311144  0.05845339]
Stock Position:  -0.0038133031511901894
Bond Position:  [-5.37585066]


portfolio before change:  [-5.78594302]
curr_Stock_Price:  107.36632174332287
curr_Factors:  [107.36632174  -0.24697278  -0.98218419]
mat_Sqrt:  [[31.40884637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01888442 0.02918536 0.44302004]
Stock Position:  0.018884421963302558
Bond Position:  [-7.81349394]


portfolio before change:  [-5.80836033]
curr_Stock_Price:  106.23096473262355
curr_Factors:  [106.23096473  -0.27804397  -0.95908062]
mat_Sqrt:  [[30.83008675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00522214  0.08592684 -0.45092271]
Stock Position:  0.0052221423855810835
Bond Position:  [-6.36311355]


portfolio before change:  [-5.81342253]
curr_Stock_Price:  105.41391248006433
curr_Factors:  [105.41391248  -0.2972532   -0.92931286]
mat_Sqrt:  [[30.91769178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00103883 0.00952904 0.17495192]
Stock Position:  0.0010388337960450425
Bond Position:  [-5.92293006]


portfolio before change:  [-5.81162284]
curr_Stock_Price:  107.85905796101856
curr_Factors:  [107.85905796  -0.29904006  -0.93158154]
mat_Sqrt:  [[31.50681134  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09951124 0.62533462 0.64193804]
Stock Position:  0.09951124423277798
Bond Position:  [-16.5448119]


portfolio before change:  [-5.68130217]
curr_Stock_Price:  109.1894493367532
curr_Factors:  [109.18944934  -0.49570389  -0.94972316]
mat_Sqrt:  [[25.72999386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00392534 -0.0092737  -0.01117005]
Stock Position:  -0.0039253409252361674
Bond Position:  [-5.25269636]


portfolio before change:  [-5.68170028]
curr_Stock_Price:  109.12358922108128
curr_Factors:  [109.12358922  -0.2202053   -0.94982862]
mat_Sqrt:  [[33.86720588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.05764171e-04 -3.69371791e-03 -6.75057047e-01]
Stock Position:  -0.00030576417063302006
Bond Position:  [-5.64833419]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.68266948]
Stock Price:  109.98412091731724
PL:  [-15.6667904]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-1.46613727e-02 -9.14592952e-02  1.30175795e-01]
 [ 1.06903021e+00  2.22927529e-01  3.01250359e-01]
 [-2.92956806e-02  6.73724250e-02  3.45899709e-02]
 [ 1.07360830e-01  8.22046782e-01  6.84492652e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.21769538e-02 -3.70829768e-02  3.36881957e-02]
 [-4.16843481e-02 -5.81600534e-02 -4.05274043e-02]
 [ 6.14703053e-02  1.49921865e-01 -4.93259534e-02]
 [ 3.53784315e-02  4.22480735e-02 -4.31131223e-02]
 [-1.95515385e-01 -5.95153062e-02 -6.75600597e-02]
 [ 8.86731404e-01  1.71716256e+00 -3.05428692e-01]
 [ 1.96475330e-06  4.45808700e-03 -5.77075755e-02]
 [ 9.32787858e-02 -2.53139032e-02  4.85485034e-02]
 [ 1.45729268e+00 -2.78837481e+00  2.34308251e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.36371519e-01 -3.68911344e-02 -1.08882150e-02]
 [-1.71722967e-01 -2.47129172e-01 -2.30276095e-02]
 [-2.62160925e-01 -1.71479725e+00 -2.00684636e-01]
 [-4.03052958e-03  3.70017996e-02  1.21991270e-01]
 [ 2.73798308e-01 -2.91606107e-01  3.29287607e-01]
 [ 5.89320004e-02  6.15106164e-02 -1.54003486e-02]
 [-7.72021468e-03 -5.35834083e-02 -9.45015515e-02]
 [ 2.49517324e-01  2.72607751e-01  2.44255753e-01]
 [-1.76668404e-01  5.69614054e-02  7.82618469e-02]
 [-9.67646723e-02 -2.89915140e-01  1.06322885e-01]
 [ 5.99749099e-02 -1.22520313e-02  6.03216635e-02]
 [ 3.63201299e-01 -7.95474434e-02  1.78514734e-01]
 [ 1.90136243e-02 -1.07899217e-01 -1.72767206e-02]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 2.96888612e-02  2.92706926e-02  6.31587210e-02]
 [ 1.52854649e-02 -1.64230955e-02 -7.31142443e-02]
 [-4.03540421e-02  1.88901548e-02 -4.75137946e-02]
 [-1.13067165e-01 -2.97163469e-02  4.23907235e-02]
 [ 6.91776177e-02  4.23012781e-03  1.46664368e-02]
 [-9.39834088e-02 -1.25571881e-02  5.53982831e-02]
 [-1.15887388e-01 -6.47918219e-02 -8.19525350e-02]
 [ 2.45042487e+00  1.57435738e+00  1.74437590e-01]
 [-2.12406186e-02 -1.44234175e-01 -5.53131082e-02]
 [ 3.48013002e-02 -1.33219813e-02 -1.02284435e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.04624195]
curr_Stock_Price:  99.95066510563659
curr_Factors:  [99.95066511 -0.9134532  -1.01589748]
mat_Sqrt:  [[14.51708221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046555 -0.02951836  0.37135531]
Stock Position:  -0.0004655481134223544
Bond Position:  [2.09277379]


portfolio before change:  [2.04641432]
curr_Stock_Price:  100.14235357818725
curr_Factors:  [100.14235358  -1.05594247  -1.03317698]
mat_Sqrt:  [[12.39723249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09486211 0.07194955 0.85938342]
Stock Position:  0.0948621055631265
Bond Position:  [-7.4533002]


portfolio before change:  [2.13990808]
curr_Stock_Price:  101.13775080375916
curr_Factors:  [101.1377508   -1.06497944  -1.05574669]
mat_Sqrt:  [[12.13091703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069926  0.02174436  0.09867556]
Stock Position:  -0.0006992623640928257
Bond Position:  [2.2106299]


portfolio before change:  [2.1400953]
curr_Stock_Price:  101.26520212018491
curr_Factors:  [101.26520212  -0.85117986  -1.02932841]
mat_Sqrt:  [[15.44421604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02686325 0.26531446 1.95266701]
Stock Position:  0.026863254410426793
Bond Position:  [-0.58021759]


portfolio before change:  [2.14884912]
curr_Stock_Price:  101.59376799192141
curr_Factors:  [101.59376799  -1.05450747  -1.03995902]
mat_Sqrt:  [[12.50984211  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468799 -0.01106097 -0.05874131]
Stock Position:  -0.004687988898022812
Bond Position:  [2.62511957]


portfolio before change:  [2.15022995]
curr_Stock_Price:  101.36922162074347
curr_Factors:  [101.36922162  -0.9619644   -1.02513609]
mat_Sqrt:  [[13.89694481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00442428 -0.01196848  0.09610305]
Stock Position:  0.004424281581012315
Bond Position:  [1.70174397]


portfolio before change:  [2.15113926]
curr_Stock_Price:  101.52666763778585
curr_Factors:  [101.52666764  -0.86247968  -1.02996723]
mat_Sqrt:  [[15.30033289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00404101 -0.01877108 -0.1156134 ]
Stock Position:  -0.004041012798795851
Bond Position:  [2.56140983]


portfolio before change:  [2.15089615]
curr_Stock_Price:  101.66606726456304
curr_Factors:  [101.66606726  -0.54816812  -1.04457253]
mat_Sqrt:  [[20.6755727   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00396624  0.04838707 -0.14071322]
Stock Position:  0.003966243692196441
Bond Position:  [1.74766375]


portfolio before change:  [2.15855306]
curr_Stock_Price:  103.54150601030707
curr_Factors:  [103.54150601  -0.50947248  -1.01632343]
mat_Sqrt:  [[22.51488503  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00156349  0.01363551 -0.12298974]
Stock Position:  0.0015634925106742558
Bond Position:  [1.99666669]


portfolio before change:  [2.15697818]
curr_Stock_Price:  102.3745797619136
curr_Factors:  [102.37457976  -0.49104699  -1.0103846 ]
mat_Sqrt:  [[22.81017816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00970858 -0.01920848 -0.19273005]
Stock Position:  -0.009708584193331265
Bond Position:  [3.15089041]


portfolio before change:  [2.16646677]
curr_Stock_Price:  101.4378103574797
curr_Factors:  [101.43781036  -0.28655388  -1.01882444]
mat_Sqrt:  [[27.49674361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04272871  0.55421183 -0.87130304]
Stock Position:  0.04272870961010527
Bond Position:  [-2.16783997]


portfolio before change:  [2.20154441]
curr_Stock_Price:  102.2650909233783
curr_Factors:  [102.26509092  -0.5604514   -1.01989631]
mat_Sqrt:  [[21.05673922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051611  0.00143884 -0.16462365]
Stock Position:  -0.000516107525746645
Bond Position:  [2.25432419]


portfolio before change:  [2.20012544]
curr_Stock_Price:  105.56048857076028
curr_Factors:  [105.56048857  -0.81320464  -1.013506  ]
mat_Sqrt:  [[16.98912606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00576966 -0.00817003  0.13849537]
Stock Position:  0.00576966280354803
Bond Position:  [1.59107701]


portfolio before change:  [2.19465931]
curr_Stock_Price:  104.57862522366382
curr_Factors:  [104.57862522  -0.55029841  -1.01953044]
mat_Sqrt:  [[21.76080315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0627917 -0.8999441  6.6841622]
Stock Position:  0.06279169732619667
Bond Position:  [-4.37201007]


portfolio before change:  [2.09207019]
curr_Stock_Price:  102.95352833977657
curr_Factors:  [102.95352834  -0.34595908  -0.98124304]
mat_Sqrt:  [[27.30515713  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007936  -0.03053791  0.10625201]
Stock Position:  -0.000793600006749417
Bond Position:  [2.17377411]


portfolio before change:  [2.0936422]
curr_Stock_Price:  101.31507274837891
curr_Factors:  [101.31507275  -0.5056666   -0.97169221]
mat_Sqrt:  [[23.12412354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00547561 -0.01190656 -0.03106105]
Stock Position:  0.005475606444756111
Bond Position:  [1.53888074]


portfolio before change:  [2.10473167]
curr_Stock_Price:  103.30518990567616
curr_Factors:  [103.30518991  -0.84210231  -0.9754815 ]
mat_Sqrt:  [[16.77859236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01352131 -0.0797606  -0.06569136]
Stock Position:  -0.013521306466812533
Bond Position:  [3.50155281]


portfolio before change:  [2.11227414]
curr_Stock_Price:  102.77974174350999
curr_Factors:  [102.77974174  -0.96211609  -0.95194407]
mat_Sqrt:  [[15.15799489  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04308994 -0.55344843 -0.57249741]
Stock Position:  -0.04308993584019713
Bond Position:  [6.54104662]


portfolio before change:  [2.12545687]
curr_Stock_Price:  102.49278266463683
curr_Factors:  [102.49278266  -1.08811553  -0.96811636]
mat_Sqrt:  [[13.1124281   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0021677  0.01194228 0.34800714]
Stock Position:  0.0021676988160727055
Bond Position:  [1.90328339]


portfolio before change:  [2.12643203]
curr_Stock_Price:  102.83288163842433
curr_Factors:  [102.83288164  -1.1262318   -0.974548  ]
mat_Sqrt:  [[12.58273157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02237114 -0.09411547  0.93936589]
Stock Position:  0.022371137014555013
Bond Position:  [-0.17405646]


portfolio before change:  [2.13908568]
curr_Stock_Price:  103.39947840234869
curr_Factors:  [103.3994784   -0.90617456  -0.97445566]
mat_Sqrt:  [[15.76779701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00433442  0.01985247 -0.04393291]
Stock Position:  0.004334417758609032
Bond Position:  [1.69090915]


portfolio before change:  [2.14300536]
curr_Stock_Price:  104.25502606206224
curr_Factors:  [104.25502606  -1.01731661  -0.96346419]
mat_Sqrt:  [[14.38317715  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263836 -0.01729397 -0.26958662]
Stock Position:  -0.002638355221214005
Bond Position:  [2.41806715]


portfolio before change:  [2.14330869]
curr_Stock_Price:  104.25462634498771
curr_Factors:  [104.25462634  -0.89528278  -0.98100385]
mat_Sqrt:  [[15.96740737  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02223414 0.08798377 0.69679368]
Stock Position:  0.022234144609959667
Bond Position:  [-0.17470375]


portfolio before change:  [2.15406372]
curr_Stock_Price:  104.73932515502223
curr_Factors:  [104.73932516  -0.70125399  -0.9784266 ]
mat_Sqrt:  [[19.52692055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00763388  0.01838421  0.22325927]
Stock Position:  -0.007633875109058993
Bond Position:  [2.95363064]


portfolio before change:  [2.1582308]
curr_Stock_Price:  104.2418251474659
curr_Factors:  [104.24182515  -0.52377484  -0.97135216]
mat_Sqrt:  [[23.37311522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00574336 -0.09356971  0.3033096 ]
Stock Position:  -0.0057433629687900145
Bond Position:  [2.75692944]


portfolio before change:  [2.17046939]
curr_Stock_Price:  102.17092095950133
curr_Factors:  [102.17092096  -0.86864371  -0.97150911]
mat_Sqrt:  [[16.22404318  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00430146 -0.00395433  0.17208092]
Stock Position:  0.004301460599680364
Bond Position:  [1.7309852]


portfolio before change:  [2.17017041]
curr_Stock_Price:  102.05110876344766
curr_Factors:  [102.05110876  -0.98958836  -0.98333825]
mat_Sqrt:  [[14.19013701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02701897 -0.02567383  0.50925285]
Stock Position:  0.027018971856253394
Bond Position:  [-0.58714563]


portfolio before change:  [2.15243185]
curr_Stock_Price:  101.3973029843352
curr_Factors:  [101.39730298  -1.11406624  -0.96855152]
mat_Sqrt:  [[12.63446924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051746 -0.03482432 -0.04928568]
Stock Position:  -0.0005174579884520585
Bond Position:  [2.20490069]


portfolio before change:  [2.15281692]
curr_Stock_Price:  101.18581162146477
curr_Factors:  [101.18581162  -1.21482139  -0.93269236]
mat_Sqrt:  [[11.81588484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187028 -0.02321455 -0.0028026 ]
Stock Position:  -0.0018702816352744115
Bond Position:  [2.34206288]


portfolio before change:  [2.15426841]
curr_Stock_Price:  100.56627074671208
curr_Factors:  [100.56627075  -1.14245032  -0.93297243]
mat_Sqrt:  [[12.62140494  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00384711 0.00944708 0.18017425]
Stock Position:  0.00384711024092022
Bond Position:  [1.76737888]


portfolio before change:  [2.1498689]
curr_Stock_Price:  99.36525403764004
curr_Factors:  [99.36525404 -0.82622919 -0.92376333]
mat_Sqrt:  [[17.2672211   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.73233898e-04 -5.30053128e-03 -2.08574588e-01]
Stock Position:  -0.0001732338978248517
Bond Position:  [2.16708233]


portfolio before change:  [2.15019748]
curr_Stock_Price:  99.03234244940651
curr_Factors:  [99.03234245 -1.12609773 -0.93169064]
mat_Sqrt:  [[12.6500113   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365192  0.00609677 -0.13554363]
Stock Position:  -0.003651919120206977
Bond Position:  [2.51185558]


portfolio before change:  [2.14948354]
curr_Stock_Price:  99.3138211305923
curr_Factors:  [99.31382113 -1.08067315 -0.93497248]
mat_Sqrt:  [[13.23201286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00834945 -0.00959091  0.12092893]
Stock Position:  -0.008349449128030286
Bond Position:  [2.97869924]


portfolio before change:  [2.14903669]
curr_Stock_Price:  99.41193651428506
curr_Factors:  [99.41193651 -0.9099501  -0.94024126]
mat_Sqrt:  [[15.62826033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00467326 0.00136527 0.04183926]
Stock Position:  0.004673256088856426
Bond Position:  [1.68445925]


portfolio before change:  [2.14953226]
curr_Stock_Price:  99.47292022707728
curr_Factors:  [99.47292023 -1.16023224 -0.95164536]
mat_Sqrt:  [[12.03727221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00708121 -0.00405282  0.15803588]
Stock Position:  -0.007081214539566579
Bond Position:  [2.85392134]


portfolio before change:  [2.14394023]
curr_Stock_Price:  100.31300100102564
curr_Factors:  [100.313001    -1.32474299  -0.91787772]
mat_Sqrt:  [[10.65122176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01369246 -0.02091147 -0.23378777]
Stock Position:  -0.01369246252351667
Bond Position:  [3.51747223]


portfolio before change:  [2.13403942]
curr_Stock_Price:  101.06819870600357
curr_Factors:  [101.06819871  -1.22028649  -0.90617662]
mat_Sqrt:  [[12.05322694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.23291656 0.50812166 0.49762189]
Stock Position:  0.23291655947170511
Bond Position:  [-21.40641769]


portfolio before change:  [2.30472997]
curr_Stock_Price:  101.81252759356572
curr_Factors:  [101.81252759  -1.37604074  -0.91417455]
mat_Sqrt:  [[10.30797499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00601214 -0.04655138 -0.1577929 ]
Stock Position:  -0.006012144703714426
Bond Position:  [2.91684162]


portfolio before change:  [2.30046754]
curr_Stock_Price:  102.58214728874647
curr_Factors:  [102.58214729  -1.39906087  -0.88955665]
mat_Sqrt:  [[10.40250237  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107698 -0.00429965 -0.29178902]
Stock Position:  0.0010769754122540293
Bond Position:  [2.18998909]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.30018483]
Stock Price:  102.06544840572901
PL:  [0.23473643]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-2.55947358e-02 -8.05838755e-02  1.88555329e-01]
 [ 1.23109227e+00  2.44368076e-01  3.59196078e-01]
 [-2.38805121e-01 -1.33344788e-01  3.67622278e-02]
 [ 1.69249715e-01  1.38272731e+00  1.10015643e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 5.59257748e-03  1.10897191e-01 -3.13964157e-02]
 [-4.99088955e-02 -6.79183793e-03 -7.35219857e-02]
 [-3.35378429e-02  2.01701573e-01 -2.74128093e-02]
 [ 2.18766503e-02  5.68591828e-02 -4.53329234e-02]
 [-1.94185652e-01 -7.37541684e-02 -7.09057178e-02]
 [ 7.64666668e-01  1.47849661e+00 -2.64723557e-01]
 [-1.43901582e-04  1.38736291e-02 -5.77098092e-02]
 [-9.73904782e-02 -5.04930344e-03 -2.13412367e-01]
 [ 1.58834923e+00 -3.04379063e+00  2.54936816e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.39037658e-01 -5.15819268e-02 -7.83028294e-04]
 [-1.35608630e-01 -1.69707586e-01 -3.71505396e-02]
 [-2.76956958e-01 -1.79290726e+00 -1.98463002e-01]
 [ 9.45319286e-03  2.65725229e-02  7.16971122e-03]
 [ 1.12220248e-01  1.53431161e-01  2.88584462e-01]
 [ 3.14646327e-02 -3.05316473e-02  5.86951874e-02]
 [ 1.10735454e-01 -5.10738520e-02  3.17524886e-02]
 [ 8.51834034e-02 -1.16443805e-02 -7.21039212e-03]
 [-1.44159113e-01  7.26767135e-03  5.48659945e-02]
 [ 1.08575811e-01  6.09229812e-03 -3.87000260e-02]
 [ 2.37926586e-03 -5.00025819e-02  2.29913651e-01]
 [-2.06690426e-01 -1.40879844e-01 -7.49197606e-02]
 [-1.38399765e-01  1.08983180e-01  1.79936374e-01]
 [ 9.63891168e-02  5.54728747e-02  1.70106876e-01]
 [-6.64608398e-02  9.36066813e-02  6.44970175e-03]
 [ 5.88808854e-02 -1.55498674e-02 -8.16477150e-02]
 [-4.45353840e-02  1.25103900e-02 -4.44054969e-02]
 [-6.74068003e-02 -5.81720005e-03  5.13348652e-02]
 [-5.80496869e-02 -1.84192572e-02 -5.78796115e-03]
 [-9.81834154e-02  4.20839234e-02  4.02340169e-02]
 [-1.12400096e-01 -6.41240942e-02 -7.52291094e-02]
 [ 1.98186882e+00  1.27830755e+00  1.55636443e-01]
 [ 8.50391431e-03 -5.69447497e-02  6.08867759e-02]
 [ 3.17927923e-02 -1.45694595e-02 -4.95839140e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.60164348]
curr_Stock_Price:  99.45286882500321
curr_Factors:  [99.45286883 -0.87774555 -0.98116138]
mat_Sqrt:  [[15.49902197  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.29379320e-04 -2.60083340e-02  5.37895871e-01]
Stock Position:  -0.00022937931980565701
Bond Position:  [-1.57883105]


portfolio before change:  [-1.60207692]
curr_Stock_Price:  100.48204548638115
curr_Factors:  [100.48204549  -1.08929861  -0.98146662]
mat_Sqrt:  [[12.66970652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10689232 0.07886946 1.02468643]
Stock Position:  0.106892317125481
Bond Position:  [-12.34283559]


portfolio before change:  [-1.64718387]
curr_Stock_Price:  100.0744951755377
curr_Factors:  [100.07449518  -1.07680276  -0.98155483]
mat_Sqrt:  [[12.77585769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02023504 -0.04303685  0.1048724 ]
Stock Position:  -0.020235037013705225
Bond Position:  [0.37782724]


portfolio before change:  [-1.64489402]
curr_Stock_Price:  99.96366649030422
curr_Factors:  [99.96366649 -1.28571929 -1.0143847 ]
mat_Sqrt:  [[10.02119948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0674636  0.44627332 3.13844008]
Stock Position:  0.06746360419033126
Bond Position:  [-8.38880325]


portfolio before change:  [-1.67452914]
curr_Stock_Price:  99.5399349771624
curr_Factors:  [99.53993498 -1.11599207 -1.01436554]
mat_Sqrt:  [[11.82482705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00495957 -0.01106097 -0.05874131]
Stock Position:  -0.0049595652166632125
Bond Position:  [-1.18085434]


portfolio before change:  [-1.67445106]
curr_Stock_Price:  99.49442835511726
curr_Factors:  [99.49442836 -0.92692807 -1.02605676]
mat_Sqrt:  [[14.11328871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0015461   0.03579191 -0.08956523]
Stock Position:  0.0015461035204193912
Bond Position:  [-1.82827975]


portfolio before change:  [-1.67329835]
curr_Stock_Price:  100.38780850973252
curr_Factors:  [100.38780851  -0.95321605  -1.05889615]
mat_Sqrt:  [[13.42244864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0049397  -0.00219206 -0.20973776]
Stock Position:  -0.004939701228097109
Bond Position:  [-1.17741257]


portfolio before change:  [-1.67163338]
curr_Stock_Price:  100.0209530149399
curr_Factors:  [100.02095301  -0.83214526  -1.0847737 ]
mat_Sqrt:  [[14.70901735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0001386   0.0650989  -0.07820111]
Stock Position:  0.0001386021898878498
Bond Position:  [-1.6854965]


portfolio before change:  [-1.67167647]
curr_Stock_Price:  101.23024458127801
curr_Factors:  [101.23024458  -0.71916269  -1.05744552]
mat_Sqrt:  [[17.12928151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0014145   0.01835122 -0.12932221]
Stock Position:  0.0014145040567578994
Bond Position:  [-1.81486706]


portfolio before change:  [-1.67089154]
curr_Stock_Price:  101.94554899816907
curr_Factors:  [101.945549    -0.83191499  -1.04342548]
mat_Sqrt:  [[15.62853433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01431447 -0.02380406 -0.20227428]
Stock Position:  -0.014314472682685094
Bond Position:  [-0.21159477]


portfolio before change:  [-1.66700262]
curr_Stock_Price:  101.67202373527752
curr_Factors:  [101.67202374  -0.88802217  -0.9936244 ]
mat_Sqrt:  [[15.48862075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06536586  0.47718273 -0.75518262]
Stock Position:  0.06536586257984545
Bond Position:  [-8.31288215]


portfolio before change:  [-1.59619983]
curr_Stock_Price:  102.77109852401857
curr_Factors:  [102.77109852  -0.64221096  -0.97351642]
mat_Sqrt:  [[20.42535018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044513  0.00447769 -0.16463002]
Stock Position:  -0.00044512942418005144
Bond Position:  [-1.55045339]


portfolio before change:  [-1.59642723]
curr_Stock_Price:  102.84654578235333
curr_Factors:  [102.84654578  -0.64540098  -0.95774678]
mat_Sqrt:  [[20.69910095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00685942 -0.00162966 -0.60880608]
Stock Position:  -0.006859417728726257
Bond Position:  [-0.89095981]


portfolio before change:  [-1.59685683]
curr_Stock_Price:  102.89293852646789
curr_Factors:  [102.89293853  -0.83061658  -0.98481863]
mat_Sqrt:  [[16.74758054  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08881436 -0.9823792   7.27263775]
Stock Position:  0.08881436101339975
Bond Position:  [-10.73522742]


portfolio before change:  [-1.61511577]
curr_Stock_Price:  102.7024631469403
curr_Factors:  [102.70246315  -0.67335165  -0.98702703]
mat_Sqrt:  [[19.52034821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111009 -0.03053791  0.10625201]
Stock Position:  -0.0011100915131847372
Bond Position:  [-1.50110664]


portfolio before change:  [-1.61445732]
curr_Stock_Price:  101.9402709737769
curr_Factors:  [101.94027097  -0.4816801   -0.97902132]
mat_Sqrt:  [[23.65762901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00542526 -0.016648   -0.00223376]
Stock Position:  0.005425256523183563
Bond Position:  [-2.16750944]


portfolio before change:  [-1.61317626]
curr_Stock_Price:  102.22634317818644
curr_Factors:  [102.22634318  -0.60828163  -0.96437583]
mat_Sqrt:  [[21.21125522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00838392 -0.05477289 -0.10598015]
Stock Position:  -0.008383915329015128
Bond Position:  [-0.75611925]


portfolio before change:  [-1.59394532]
curr_Stock_Price:  99.92127944312794
curr_Factors:  [99.92127944 -0.68071024 -0.93858389]
mat_Sqrt:  [[19.78825415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03453785 -0.57865833 -0.5661597 ]
Stock Position:  -0.03453784778678195
Bond Position:  [1.85712062]


portfolio before change:  [-1.57757576]
curr_Stock_Price:  99.45404112124174
curr_Factors:  [99.45404112 -0.61564896 -0.94006993]
mat_Sqrt:  [[20.98854381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00077856 0.00857624 0.02045319]
Stock Position:  0.0007785579458451234
Bond Position:  [-1.65500649]


portfolio before change:  [-1.5782619]
curr_Stock_Price:  98.83848150518622
curr_Factors:  [98.83848151 -0.6757098  -0.92351754]
mat_Sqrt:  [[19.97056981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01013723 0.04951969 0.82325115]
Stock Position:  0.010137232489089026
Bond Position:  [-2.58021056]


portfolio before change:  [-1.58036994]
curr_Stock_Price:  98.6623490758586
curr_Factors:  [98.66234908 -0.4551187  -0.91552863]
mat_Sqrt:  [[25.05456572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0014853  -0.00985405  0.16744103]
Stock Position:  0.0014852977954551828
Bond Position:  [-1.72691291]


portfolio before change:  [-1.5811245]
curr_Stock_Price:  98.29967313195573
curr_Factors:  [98.29967313 -0.62241662 -0.90960471]
mat_Sqrt:  [[21.24240391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00502728 -0.01648401  0.09058101]
Stock Position:  0.005027279267989745
Bond Position:  [-2.07530441]


portfolio before change:  [-1.58081902]
curr_Stock_Price:  98.41204201924215
curr_Factors:  [98.41204202 -0.74813312 -0.93440016]
mat_Sqrt:  [[18.29503837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00444572 -0.00375821 -0.02056924]
Stock Position:  0.004445723880954197
Bond Position:  [-2.01833178]


portfolio before change:  [-1.59075841]
curr_Stock_Price:  96.2330738892684
curr_Factors:  [96.23307389 -0.87927484 -0.90445363]
mat_Sqrt:  [[16.16817212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00813179  0.00234563  0.15651741]
Stock Position:  -0.008131786978119377
Bond Position:  [-0.80821156]


portfolio before change:  [-1.58144337]
curr_Stock_Price:  95.0751396342245
curr_Factors:  [95.07513963 -0.63611449 -0.89446001]
mat_Sqrt:  [[20.57533488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00495349  0.00196628 -0.1104004 ]
Stock Position:  0.004953493453471221
Bond Position:  [-2.05239745]


portfolio before change:  [-1.57788951]
curr_Stock_Price:  95.844380387879
curr_Factors:  [95.84438039 -0.89252993 -0.88080975]
mat_Sqrt:  [[16.27102887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00240326 -0.01613826  0.65587965]
Stock Position:  0.00240325669203771
Bond Position:  [-1.80822816]


portfolio before change:  [-1.57774727]
curr_Stock_Price:  95.99762170920356
curr_Factors:  [95.99762171 -0.73372175 -0.90537066]
mat_Sqrt:  [[18.63853117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01345279 -0.04546877 -0.21372522]
Stock Position:  -0.013452794860933719
Bond Position:  [-0.28631096]


portfolio before change:  [-1.5960837]
curr_Stock_Price:  97.35798080422366
curr_Factors:  [97.3579808  -0.85953706 -0.89412589]
mat_Sqrt:  [[16.85642272  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00471181  0.03517417  0.51330839]
Stock Position:  -0.004711812802725594
Bond Position:  [-1.13735112]


portfolio before change:  [-1.58799063]
curr_Stock_Price:  95.61019326221455
curr_Factors:  [95.61019326 -0.72711188 -0.88849779]
mat_Sqrt:  [[19.00438553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00749487 0.01790379 0.48526757]
Stock Position:  0.007494869558284475
Bond Position:  [-2.30457655]


portfolio before change:  [-1.56712976]
curr_Stock_Price:  98.4319839874699
curr_Factors:  [98.43198399 -0.71471053 -0.91040289]
mat_Sqrt:  [[19.38020872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237546  0.03021143  0.0183992 ]
Stock Position:  -0.0023754602868401404
Bond Position:  [-1.33330849]


portfolio before change:  [-1.56514745]
curr_Stock_Price:  97.5273244389245
curr_Factors:  [97.52732444 -0.84061574 -0.92278128]
mat_Sqrt:  [[16.72217309  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00233466 -0.0050187  -0.2329182 ]
Stock Position:  0.002334655413707848
Bond Position:  [-1.79284015]


portfolio before change:  [-1.56370709]
curr_Stock_Price:  98.24026882984998
curr_Factors:  [98.24026883 -0.87327509 -0.92486106]
mat_Sqrt:  [[16.26930245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313756  0.00403771 -0.12667652]
Stock Position:  -0.003137562018295452
Bond Position:  [-1.25547216]


portfolio before change:  [-1.56085333]
curr_Stock_Price:  97.2807005010143
curr_Factors:  [97.2807005  -0.70688347 -0.92118504]
mat_Sqrt:  [[19.09701624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304317 -0.00187749  0.14644408]
Stock Position:  -0.0030431741302059637
Bond Position:  [-1.26481122]


portfolio before change:  [-1.56177366]
curr_Stock_Price:  97.5311690258203
curr_Factors:  [97.53116903 -0.52264458 -0.91536369]
mat_Sqrt:  [[23.15391178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272053 -0.00594479 -0.01651144]
Stock Position:  -0.002720532288972895
Bond Position:  [-1.29643697]


portfolio before change:  [-1.56046719]
curr_Stock_Price:  96.99137188532005
curr_Factors:  [96.99137189 -0.49701428 -0.89355457]
mat_Sqrt:  [[24.14441694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337057  0.01358253  0.11477645]
Stock Position:  -0.003370565395406413
Bond Position:  [-1.23355143]


portfolio before change:  [-1.55850233]
curr_Stock_Price:  96.36267336899515
curr_Factors:  [96.36267337 -0.36308209 -0.9290387 ]
mat_Sqrt:  [[26.46963239  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00532102 -0.02069596 -0.21460771]
Stock Position:  -0.005321020233882951
Bond Position:  [-1.04575459]


portfolio before change:  [-1.55852085]
curr_Stock_Price:  96.34158554506752
curr_Factors:  [96.34158555 -0.2139339  -0.93414621]
mat_Sqrt:  [[30.56391145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07442017 0.41257199 0.44398745]
Stock Position:  0.07442016757984858
Bond Position:  [-8.72827779]


portfolio before change:  [-1.65014823]
curr_Stock_Price:  95.12502976128265
curr_Factors:  [ 9.51250298e+01  1.91238253e-02 -9.16839513e-01]
mat_Sqrt:  [[38.76339764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00024014 -0.01837884  0.17369302]
Stock Position:  0.0002401383162513314
Bond Position:  [-1.6729914]


portfolio before change:  [-1.64996259]
curr_Stock_Price:  96.76901457795336
curr_Factors:  [ 9.67690146e+01  7.12882630e-02 -9.25141671e-01]
mat_Sqrt:  [[41.20144951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00045381 -0.00470227 -0.14144911]
Stock Position:  0.00045380781341260884
Bond Position:  [-1.69387712]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.65064845]
Stock Price:  95.72426675840829
PL:  [-1.65064845]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 5.55343006e-02 -3.67439932e-02  8.67057211e-02]
 [ 1.53842119e+00  3.36045931e-01  5.02886654e-01]
 [-2.57019424e-01 -1.50110678e-01  3.72935130e-02]
 [ 1.78583895e-01  1.13900451e+00  1.10294573e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 1.34874223e-02  9.43825669e-02 -3.09056165e-02]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [-3.98716987e-02  2.02880722e-01 -2.81903040e-02]
 [ 3.31440259e-02  4.46660615e-02 -4.34804765e-02]
 [-3.97793299e-02 -1.21076058e-02  2.61291348e-02]
 [ 8.80228907e-01  1.74487092e+00 -2.93076215e-01]
 [-9.74697145e-04  1.93168692e-02  7.97972376e-02]
 [-3.80189520e-01  1.37983778e-03 -8.44009107e-01]
 [ 1.72509775e+00 -2.96944259e+00  2.50061124e+00]
 [ 7.73031147e-03 -9.16363970e-02  3.54116879e-02]
 [ 7.39510262e-02  1.16199939e-01 -8.27363058e-02]
 [-6.46140930e-02 -1.60744725e-02 -6.31187509e-02]
 [-2.78123733e-01 -1.80291955e+00 -1.99679538e-01]
 [ 1.93852729e-03  3.63003191e-02  5.46768939e-02]
 [ 2.16763563e-01 -3.40394324e-01  1.87812828e-01]
 [ 4.98615465e-02  8.10807526e-03  6.14206068e-02]
 [ 1.11357193e-01 -5.51872360e-02 -4.60973535e-02]
 [ 3.15541094e-01  1.78062906e-01  2.13814235e-01]
 [-2.32365782e-01  7.14837542e-02  2.88815791e-02]
 [-3.74954253e-02 -2.04871648e-01  7.16812157e-02]
 [ 7.37685814e-02 -1.66053660e-02 -5.88171179e-03]
 [ 3.77070161e-01 -8.33214003e-02  1.83546970e-01]
 [ 3.44818617e-02 -1.28062074e-01 -1.62634350e-02]
 [-8.16724072e-03 -7.35362919e-02 -1.11905771e-03]
 [ 1.47608598e-01 -4.98608594e-02  6.71677519e-02]
 [-1.58413208e-02 -5.16319197e-02 -4.27413798e-02]
 [-2.83417933e-02  2.36187703e-02 -5.22465477e-02]
 [-3.62415270e-02 -6.13477677e-02  1.21140958e-02]
 [ 3.11163075e-01  4.44997721e-02  7.11732783e-02]
 [-3.38050090e-02 -3.74596266e-02  3.76759495e-02]
 [-1.11002216e-01 -5.65195735e-02 -8.69165998e-02]
 [ 2.23596334e+00  1.44368174e+00  1.66773617e-01]
 [-1.22637368e-02 -1.30312590e-01 -5.19228898e-02]
 [ 3.38295755e-02 -1.35817694e-02 -8.30638570e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.76242973]
curr_Stock_Price:  100.73070523404569
curr_Factors:  [100.73070523  -0.93698583  -1.0030296 ]
mat_Sqrt:  [[14.47517683  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00454106 -0.01185907  0.24734729]
Stock Position:  0.004541063390145851
Bond Position:  [7.30500522]


portfolio before change:  [7.76674693]
curr_Stock_Price:  101.48031199116647
curr_Factors:  [101.48031199  -0.87229506  -1.00731145]
mat_Sqrt:  [[15.49098594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11036532 0.10845836 1.43459565]
Stock Position:  0.11036531775091699
Bond Position:  [-3.43315995]


portfolio before change:  [7.61314757]
curr_Stock_Price:  100.09246485637921
curr_Factors:  [100.09246486  -0.6587974   -1.01627968]
mat_Sqrt:  [[18.74669231  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01493854 -0.04844801  0.10638801]
Stock Position:  -0.014938535643783548
Bond Position:  [9.10838242]


portfolio before change:  [7.61851252]
curr_Stock_Price:  99.80954969618524
curr_Factors:  [99.8095497  -0.7235383  -1.01752589]
mat_Sqrt:  [[17.49997892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03635548 0.36761212 3.14639718]
Stock Position:  0.036355476446278984
Bond Position:  [3.98988879]


portfolio before change:  [7.61197023]
curr_Stock_Price:  99.61587716148644
curr_Factors:  [99.61587716 -0.58239071 -0.99784567]
mat_Sqrt:  [[20.51354047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00285889 -0.01106097 -0.05874131]
Stock Position:  -0.002858892205092485
Bond Position:  [7.89676129]


portfolio before change:  [7.61134326]
curr_Stock_Price:  100.18047750745305
curr_Factors:  [100.18047751  -0.49945418  -0.98440795]
mat_Sqrt:  [[22.71694676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00116409  0.03046184 -0.08816512]
Stock Position:  0.00116409131987159
Bond Position:  [7.49472403]


portfolio before change:  [7.61122252]
curr_Stock_Price:  99.27192248465145
curr_Factors:  [99.27192248 -0.38956969 -0.98624407]
mat_Sqrt:  [[25.07945575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264321 -0.00251018 -0.21167328]
Stock Position:  -0.0026432121813634414
Bond Position:  [7.87361927]


portfolio before change:  [7.60983105]
curr_Stock_Price:  100.17072693030582
curr_Factors:  [100.17072693  -0.63101557  -0.98920402]
mat_Sqrt:  [[19.81930384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00021258  0.06547947 -0.08041909]
Stock Position:  -0.00021257893111707233
Bond Position:  [7.63112524]


portfolio before change:  [7.61076728]
curr_Stock_Price:  100.25406676462438
curr_Factors:  [100.25406676  -0.53557325  -0.96586845]
mat_Sqrt:  [[22.33747873  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149462  0.01441591 -0.1240377 ]
Stock Position:  0.0014946195505078559
Bond Position:  [7.4609256]


portfolio before change:  [7.60968426]
curr_Stock_Price:  98.90543195624399
curr_Factors:  [98.90543196 -0.55332859 -0.96393195]
mat_Sqrt:  [[21.69113442  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170195 -0.00390771  0.07453915]
Stock Position:  -0.0017019486635401284
Bond Position:  [7.77801623]


portfolio before change:  [7.61108947]
curr_Stock_Price:  98.6510785870889
curr_Factors:  [98.65107859 -0.65368759 -0.95015343]
mat_Sqrt:  [[19.84095323  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05930034  0.56315467 -0.83606487]
Stock Position:  0.05930033940983037
Bond Position:  [1.76104703]


portfolio before change:  [7.61151033]
curr_Stock_Price:  98.65446325996172
curr_Factors:  [98.65446326 -0.69916382 -0.96970868]
mat_Sqrt:  [[18.59236421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00103574 0.00623449 0.22763931]
Stock Position:  0.0010357416071628757
Bond Position:  [7.5093298]


portfolio before change:  [7.61229648]
curr_Stock_Price:  98.50715549478363
curr_Factors:  [98.50715549 -0.47341814 -0.98163117]
mat_Sqrt:  [[22.99047224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.40182321e-02  4.45340730e-04 -2.40772306e+00]
Stock Position:  -0.02401823212278011
Bond Position:  [9.97826421]


portfolio before change:  [7.58245901]
curr_Stock_Price:  99.80137367351271
curr_Factors:  [99.80137367 -0.45318993 -1.0029854 ]
mat_Sqrt:  [[23.26631524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07003249 -0.95838347  7.13354784]
Stock Position:  0.07003248849446679
Bond Position:  [0.59312046]


portfolio before change:  [7.58578833]
curr_Stock_Price:  99.84785460951034
curr_Factors:  [99.84785461 -0.70948044 -0.99198728]
mat_Sqrt:  [[18.21380546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0002057  -0.02957552  0.10101969]
Stock Position:  -0.0002056961260051648
Bond Position:  [7.60632665]


portfolio before change:  [7.58701664]
curr_Stock_Price:  98.49895562434233
curr_Factors:  [98.49895562 -0.63841876 -0.99819572]
mat_Sqrt:  [[19.17162769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00421361  0.03750337 -0.23602365]
Stock Position:  0.004213609974392546
Bond Position:  [7.17198046]


portfolio before change:  [7.59515748]
curr_Stock_Price:  100.2182137646285
curr_Factors:  [100.21821376  -0.62149745  -0.99726286]
mat_Sqrt:  [[19.85765639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00406792 -0.00518801 -0.18006023]
Stock Position:  -0.004067919215085236
Bond Position:  [8.00283708]


portfolio before change:  [7.59700435]
curr_Stock_Price:  100.01013318227082
curr_Factors:  [100.01013318  -0.42378392  -0.94831276]
mat_Sqrt:  [[25.36004328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02708602 -0.58188978 -0.56963014]
Stock Position:  -0.027086016831882897
Bond Position:  [10.3058805]


portfolio before change:  [7.56629374]
curr_Stock_Price:  101.19151495693637
curr_Factors:  [101.19151496  -0.54129334  -0.9496666 ]
mat_Sqrt:  [[22.78391879  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00090016 0.01171588 0.15597796]
Stock Position:  0.0009001600347461122
Bond Position:  [7.47520518]


portfolio before change:  [7.56852211]
curr_Stock_Price:  102.6289383721744
curr_Factors:  [102.62893837  -0.51349259  -0.95894679]
mat_Sqrt:  [[23.53951649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00788538 -0.1098618   0.53577772]
Stock Position:  0.007885378414644283
Bond Position:  [6.7592541]


portfolio before change:  [7.56355021]
curr_Stock_Price:  101.89126184011242
curr_Factors:  [101.89126184  -0.52644886  -0.97196557]
mat_Sqrt:  [[22.77109027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00281295 0.00261687 0.17521589]
Stock Position:  0.0028129539940553163
Bond Position:  [7.27693478]


portfolio before change:  [7.56787108]
curr_Stock_Price:  103.10393570994823
curr_Factors:  [103.10393571  -0.50948059  -0.95994912]
mat_Sqrt:  [[23.71974557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00382308 -0.0178116  -0.13150292]
Stock Position:  0.003823083276263167
Bond Position:  [7.17369615]


portfolio before change:  [7.56627823]
curr_Stock_Price:  102.45272946111176
curr_Factors:  [102.45272946  -0.47939208  -0.95982203]
mat_Sqrt:  [[24.29297976  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01628177 0.05746956 0.6099525 ]
Stock Position:  0.016281768815772337
Bond Position:  [5.89816658]


portfolio before change:  [7.55654991]
curr_Stock_Price:  101.80994646730593
curr_Factors:  [101.80994647  -0.58830706  -0.99692698]
mat_Sqrt:  [[20.86084108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01015677  0.02307128  0.08239111]
Stock Position:  -0.01015677141650972
Bond Position:  [8.59061026]


portfolio before change:  [7.55155587]
curr_Stock_Price:  102.40737348673306
curr_Factors:  [102.40737349  -0.6777573   -0.97611055]
mat_Sqrt:  [[19.59140352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330159 -0.06612204  0.20448656]
Stock Position:  -0.0033015913577925586
Bond Position:  [7.88966317]


portfolio before change:  [7.55056966]
curr_Stock_Price:  103.00480636075773
curr_Factors:  [103.00480636  -1.0552356   -0.97572749]
mat_Sqrt:  [[13.51516725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00511858 -0.00535936 -0.01677889]
Stock Position:  0.005118577120136786
Bond Position:  [7.02333162]


portfolio before change:  [7.54619296]
curr_Stock_Price:  101.97821885038665
curr_Factors:  [101.97821885  -1.04388977  -1.00035514]
mat_Sqrt:  [[13.20392767  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03010685 -0.02689187  0.52360842]
Stock Position:  0.03010684623698467
Bond Position:  [4.47595041]


portfolio before change:  [7.56797403]
curr_Stock_Price:  102.6830928191764
curr_Factors:  [102.68309282  -1.06116877  -1.00034421]
mat_Sqrt:  [[13.06758177  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00038427 -0.04133186 -0.04639505]
Stock Position:  0.0003842746634916883
Bond Position:  [7.52851551]


portfolio before change:  [7.56876182]
curr_Stock_Price:  102.28408853164457
curr_Factors:  [102.28408853  -1.15766804  -0.97581564]
mat_Sqrt:  [[12.11289317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193234 -0.02373374 -0.00319236]
Stock Position:  -0.001932337701676511
Bond Position:  [7.76640922]


portfolio before change:  [7.56848275]
curr_Stock_Price:  102.93093766601702
curr_Factors:  [102.93093767  -1.10089099  -0.97938333]
mat_Sqrt:  [[12.85565679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0117568  -0.01609252  0.1916109 ]
Stock Position:  0.011756797392735985
Bond Position:  [6.35834457]


portfolio before change:  [7.5666572]
curr_Stock_Price:  102.70805414901665
curr_Factors:  [102.70805415  -1.42250131  -0.97123427]
mat_Sqrt:  [[ 9.37601623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374415 -0.01666413 -0.12192926]
Stock Position:  -0.003744147735098411
Bond Position:  [7.95121133]


portfolio before change:  [7.56785254]
curr_Stock_Price:  102.65426896226575
curr_Factors:  [102.65426896  -1.23175842  -0.98586747]
mat_Sqrt:  [[11.17568947  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305891  0.00762293 -0.14904486]
Stock Position:  -0.0030589087122518685
Bond Position:  [7.88186258]


portfolio before change:  [7.56911707]
curr_Stock_Price:  102.56298515391612
curr_Factors:  [102.56298515  -1.20725902  -0.99488354]
mat_Sqrt:  [[11.33998011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00408213 -0.01979991  0.03455814]
Stock Position:  -0.004082133103725755
Bond Position:  [7.98779282]


portfolio before change:  [7.57156244]
curr_Stock_Price:  102.20855359081631
curr_Factors:  [102.20855359  -1.36944366  -0.97453243]
mat_Sqrt:  [[ 9.80643963  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03413826 0.01436224 0.20303755]
Stock Position:  0.034138255037900946
Bond Position:  [4.08234077]


portfolio before change:  [7.56765283]
curr_Stock_Price:  102.07908212472056
curr_Factors:  [102.07908212  -1.24675331  -0.9669726 ]
mat_Sqrt:  [[11.15649583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302612 -0.01209004  0.107479  ]
Stock Position:  -0.0030261161606630568
Bond Position:  [7.87655599]


portfolio before change:  [7.57164963]
curr_Stock_Price:  101.08369326020072
curr_Factors:  [101.08369326  -1.11814244  -0.96144869]
mat_Sqrt:  [[12.63357165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01110383 -0.01824161 -0.24794887]
Stock Position:  -0.01110382761742144
Bond Position:  [8.69406553]


portfolio before change:  [7.57378875]
curr_Stock_Price:  100.98892413779876
curr_Factors:  [100.98892414  -0.9921273   -0.96094744]
mat_Sqrt:  [[14.32399505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.17904894 0.46594628 0.47575871]
Stock Position:  0.17904894212654554
Bond Position:  [-10.50817128]


portfolio before change:  [7.48930861]
curr_Stock_Price:  100.52443360687863
curr_Factors:  [100.52443361  -0.93924479  -0.9223175 ]
mat_Sqrt:  [[15.62447397  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031657  -0.04205821 -0.14812155]
Stock Position:  -0.003165700066803992
Bond Position:  [7.80753882]


portfolio before change:  [7.49020371]
curr_Stock_Price:  100.54999095172033
curr_Factors:  [100.54999095  -1.17287539  -0.92005043]
mat_Sqrt:  [[12.40040587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113721 -0.0043835  -0.23695806]
Stock Position:  0.0011372103255571336
Bond Position:  [7.37585722]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.49124718]
Stock Price:  100.65677342818923
PL:  [6.83447375]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.96044642e-02 -8.06760095e-02 -6.50276686e-03]
 [ 1.06659857e+00  2.22042282e-01  3.02650272e-01]
 [-3.73238446e-01 -2.57087888e-01  4.06834562e-02]
 [ 2.64501511e-01  1.92392675e+00  1.68369080e+00]
 [-5.13934636e-02 -1.33237939e-02  1.15032769e-02]
 [-5.43452404e-02  4.31976597e-01 -2.07884566e-01]
 [-9.99596330e-02  9.20727600e-02  6.86790613e-02]
 [-2.54659603e-03 -3.76782400e-03  5.24586754e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 8.12569686e-01  1.65052655e+00 -2.60953668e-01]
 [-1.10370618e-03  2.56154787e-02  9.55197225e-02]
 [-3.35210814e-01 -1.00090005e-04 -7.29036932e-01]
 [ 1.83540670e+00 -3.14213935e+00  2.65094155e+00]
 [ 2.82048664e-02 -9.25322143e-02  3.17616644e-02]
 [ 6.58608187e-02  1.31861384e-01 -8.95568901e-02]
 [-1.87470355e-02  1.43165324e-01 -8.04908959e-02]
 [-2.89838129e-01 -1.85930291e+00 -1.95948905e-01]
 [ 3.47998102e-02 -7.74384270e-02  3.27077167e-02]
 [ 9.66719553e-02  8.17464806e-02  2.35253851e-01]
 [ 2.74223343e-02 -1.46590416e-02  2.34349332e-02]
 [ 6.88330592e-02 -4.43219452e-02  2.06501765e-02]
 [ 1.92669346e-01 -1.72403917e-02  1.05605355e-02]
 [-1.58392939e-01  1.76301595e-02  5.06729142e-02]
 [ 1.08083348e-01 -3.88487336e-02 -2.70468066e-02]
 [ 2.77180514e-02 -4.55539027e-02  2.63265307e-01]
 [-1.82360199e-01 -1.12402337e-01 -7.25929428e-02]
 [-2.52745536e-01  1.86753379e-01  3.44540060e-01]
 [ 1.25274920e-01  1.50837336e-01  3.46416819e-01]
 [-1.59047851e-01  1.12945371e-01 -9.03639896e-02]
 [ 1.37337293e-01  1.44100721e-02  3.65388329e-02]
 [ 1.01134214e-01 -2.20500021e-03 -7.95608397e-02]
 [ 1.81606370e-01  1.42977256e-01  1.75481444e-01]
 [ 7.40396802e-03 -1.38779281e-02  5.57999896e-02]
 [-9.58607905e-02  1.50533934e-01  2.77682693e-02]
 [-9.17259684e-02 -5.20774663e-02 -5.55107934e-02]
 [ 1.81913728e+00  1.18606125e+00  1.51168223e-01]
 [ 2.22161206e-01 -3.57164922e-01  9.31788044e-02]
 [ 2.74073960e-02 -1.51382586e-02  6.98546266e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.15974715]
curr_Stock_Price:  99.69323100803886
curr_Factors:  [99.69323101 -1.11328203 -1.01442561]
mat_Sqrt:  [[11.8744632   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00015236 -0.02603807 -0.01855058]
Stock Position:  0.00015235813279931563
Bond Position:  [0.14455807]


portfolio before change:  [0.15981649]
curr_Stock_Price:  100.0297169979953
curr_Factors:  [100.029717    -1.14416909  -1.02724191]
mat_Sqrt:  [[11.40505089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10291063 0.07166384 0.86337698]
Stock Position:  0.10291063161231886
Bond Position:  [-10.13430487]


portfolio before change:  [0.03908398]
curr_Stock_Price:  98.86884921256208
curr_Factors:  [98.86884921 -1.15273672 -1.03894508]
mat_Sqrt:  [[11.04648653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03778684 -0.08297476  0.11605858]
Stock Position:  -0.03778683968113229
Bond Position:  [3.77502534]


portfolio before change:  [0.07554086]
curr_Stock_Price:  97.91653423665315
curr_Factors:  [97.91653424 -1.23660424 -1.0274978 ]
mat_Sqrt:  [[10.17581055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09836104 0.62094469 4.8031012 ]
Stock Position:  0.09836104495861542
Bond Position:  [-9.55563176]


portfolio before change:  [0.03558395]
curr_Stock_Price:  97.52245154625619
curr_Factors:  [97.52245155 -1.03656077 -1.02495843]
mat_Sqrt:  [[12.41075487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00417099 -0.00430024  0.03281565]
Stock Position:  -0.004170985216056889
Bond Position:  [0.44234865]


portfolio before change:  [0.03771378]
curr_Stock_Price:  97.02507888687227
curr_Factors:  [97.02507889 -0.94364734 -1.02996683]
mat_Sqrt:  [[13.48199818  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063808  0.13941985 -0.5930368 ]
Stock Position:  -0.0006380839212616091
Bond Position:  [0.09962392]


portfolio before change:  [0.03739259]
curr_Stock_Price:  97.54795772341116
curr_Factors:  [97.54795772 -0.63174453 -1.02056172]
mat_Sqrt:  [[18.69092064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359246  0.02971636  0.19592225]
Stock Position:  -0.0035924557302022433
Bond Position:  [0.38782931]


portfolio before change:  [0.04625347]
curr_Stock_Price:  95.09492983717264
curr_Factors:  [95.09492984 -0.57562938 -0.96950506]
mat_Sqrt:  [[20.28215043  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036448 -0.00121606  0.14965   ]
Stock Position:  0.0003644772485677327
Bond Position:  [0.01159353]


portfolio before change:  [0.04628123]
curr_Stock_Price:  95.16713055594948
curr_Factors:  [95.16713056 -0.51764726 -0.98627145]
mat_Sqrt:  [[21.15160737  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00245803  0.0064198  -0.11330016]
Stock Position:  0.0024580261170226475
Bond Position:  [-0.18764206]


portfolio before change:  [0.05047155]
curr_Stock_Price:  96.88142346853537
curr_Factors:  [96.88142347 -0.62055823 -0.99182743]
mat_Sqrt:  [[19.31925234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.52434303e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  4.5243430321259305e-05
Bond Position:  [0.04608831]


portfolio before change:  [0.05052784]
curr_Stock_Price:  97.99823650865387
curr_Factors:  [97.99823651 -0.75906114 -1.00182451]
mat_Sqrt:  [[16.84516782  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06507594  0.53270515 -0.74442818]
Stock Position:  0.06507593604742357
Bond Position:  [-6.32679913]


portfolio before change:  [0.03588416]
curr_Stock_Price:  97.78536542607264
curr_Factors:  [97.78536543 -0.74074434 -1.02895094]
mat_Sqrt:  [[16.66114979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00141784 0.00826736 0.27249118]
Stock Position:  0.0014178441181634312
Bond Position:  [-0.10276025]


portfolio before change:  [0.03772948]
curr_Stock_Price:  99.09592574578734
curr_Factors:  [99.09592575 -0.87402853 -1.01778438]
mat_Sqrt:  [[14.94348496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.23917270e-02 -3.23039103e-05 -2.07973944e+00]
Stock Position:  -0.032391726992007285
Bond Position:  [3.24761766]


portfolio before change:  [0.0322778]
curr_Stock_Price:  99.27676388347207
curr_Factors:  [99.27676388 -0.81013621 -1.00974269]
mat_Sqrt:  [[16.08734041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10785757 -1.01412112  7.56239837]
Stock Position:  0.1078575654253135
Bond Position:  [-10.67547225]


portfolio before change:  [-0.06975072]
curr_Stock_Price:  98.3431807524465
curr_Factors:  [98.34318075 -0.60585042 -1.01631562]
mat_Sqrt:  [[19.41987771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00081361 -0.02986464  0.09060719]
Stock Position:  0.0008136060438470652
Bond Position:  [-0.14976333]


portfolio before change:  [-0.06982188]
curr_Stock_Price:  98.27872995937719
curr_Factors:  [98.27872996 -0.60548479 -0.98824536]
mat_Sqrt:  [[19.9669313   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00373098  0.04255808 -0.25548088]
Stock Position:  0.003730978298884405
Bond Position:  [-0.43649769]


portfolio before change:  [-0.0696717]
curr_Stock_Price:  98.33360758194506
curr_Factors:  [98.33360758 -0.77936941 -0.98877116]
mat_Sqrt:  [[16.78063063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035479  0.04620641 -0.22961812]
Stock Position:  -0.00035479425788906846
Bond Position:  [-0.0347835]


portfolio before change:  [-0.06931407]
curr_Stock_Price:  97.31335422025973
curr_Factors:  [97.31335422 -0.7152993  -0.97893729]
mat_Sqrt:  [[17.88030158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03967297 -0.60008743 -0.55898768]
Stock Position:  -0.03967296891978543
Bond Position:  [3.79139561]


portfolio before change:  [0.00619784]
curr_Stock_Price:  95.4219416649514
curr_Factors:  [95.42194166 -0.3238726  -0.96098447]
mat_Sqrt:  [[26.40230921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00097223 -0.02499314  0.09330601]
Stock Position:  0.0009722328454250585
Bond Position:  [-0.08657451]


portfolio before change:  [0.00979595]
curr_Stock_Price:  99.13394556918573
curr_Factors:  [99.13394557 -0.43677448 -0.96354975]
mat_Sqrt:  [[24.43820499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00660357 0.02638356 0.67111376]
Stock Position:  0.0066035691683282065
Bond Position:  [-0.64484192]


portfolio before change:  [0.00204747]
curr_Stock_Price:  97.97277470334592
curr_Factors:  [97.9727747  -0.47887397 -0.97574165]
mat_Sqrt:  [[22.87567242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00127706 -0.00473119  0.06685334]
Stock Position:  0.0012770643480009044
Bond Position:  [-0.12307007]


portfolio before change:  [-0.00090968]
curr_Stock_Price:  95.66923652561684
curr_Factors:  [95.66923653 -0.30898256 -0.95300636]
mat_Sqrt:  [[27.08304445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00236314 -0.01430485  0.05890921]
Stock Position:  0.0023631419926647026
Bond Position:  [-0.22698967]


portfolio before change:  [0.00357187]
curr_Stock_Price:  97.57768125601581
curr_Factors:  [97.57768126 -0.28497485 -0.94807921]
mat_Sqrt:  [[28.43425932  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.006728   -0.00556431  0.03012627]
Stock Position:  0.006728004561586985
Bond Position:  [-0.65293122]


portfolio before change:  [-0.00662595]
curr_Stock_Price:  96.07408578028584
curr_Factors:  [ 9.60740858e+01  6.60052573e-02 -9.46340917e-01]
mat_Sqrt:  [[39.83651528  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362609  0.00569011  0.14455572]
Stock Position:  -0.003626086057349613
Bond Position:  [0.34174695]


portfolio before change:  [-0.00108015]
curr_Stock_Price:  94.55644819989207
curr_Factors:  [94.5564482   0.42957693 -0.9903869 ]
mat_Sqrt:  [[53.96777005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017535  -0.01253837 -0.07715701]
Stock Position:  0.0017534998677888162
Bond Position:  [-0.16688487]


portfolio before change:  [-0.00652824]
curr_Stock_Price:  91.46136085091149
curr_Factors:  [91.46136085  0.3655724  -0.99092493]
mat_Sqrt:  [[48.93848299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147447 -0.01470246  0.75102264]
Stock Position:  0.0014744675622533109
Bond Position:  [-0.14138505]


portfolio before change:  [-0.00375072]
curr_Stock_Price:  93.3570933102961
curr_Factors:  [93.35709331  0.30965704 -0.99837021]
mat_Sqrt:  [[46.88597929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00469484 -0.0362777  -0.20708746]
Stock Position:  -0.004694840671058207
Bond Position:  [0.43454596]


portfolio before change:  [4.15833746e-06]
curr_Stock_Price:  92.56887515925482
curr_Factors:  [ 9.25688752e+01  8.44814325e-02 -1.00456732e+00]
mat_Sqrt:  [[36.88729104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0039118   0.06027439  0.98287689]
Stock Position:  -0.003911800319595385
Bond Position:  [0.36211511]


portfolio before change:  [-0.00020048]
curr_Stock_Price:  92.63276131633964
curr_Factors:  [92.63276132  0.1874213  -0.99460241]
mat_Sqrt:  [[41.3247569   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00548767 0.04868254 0.98823076]
Stock Position:  0.005487666873358015
Bond Position:  [-0.50853822]


portfolio before change:  [0.00434822]
curr_Stock_Price:  93.47324098122094
curr_Factors:  [ 9.34732410e+01  7.61911121e-03 -1.01226539e+00]
mat_Sqrt:  [[34.2274832   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00451212  0.03645296 -0.25778331]
Stock Position:  -0.004512118071881916
Bond Position:  [0.42611052]


portfolio before change:  [0.00976984]
curr_Stock_Price:  92.28347580105171
curr_Factors:  [ 9.22834758e+01 -5.20463156e-02 -1.00044540e+00]
mat_Sqrt:  [[32.21310595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00458624 0.00465083 0.10423512]
Stock Position:  0.0045862449411211694
Bond Position:  [-0.41346478]


portfolio before change:  [0.01275909]
curr_Stock_Price:  92.94653099651029
curr_Factors:  [92.946531   -0.25258041 -0.97984251]
mat_Sqrt:  [[27.10183598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0031158  -0.00071166 -0.22696493]
Stock Position:  0.003115797451440373
Bond Position:  [-0.27684347]


portfolio before change:  [0.00640457]
curr_Stock_Price:  90.91818459929921
curr_Factors:  [90.9181846  -0.19510899 -0.97277924]
mat_Sqrt:  [[28.27765166  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00872107 0.04614571 0.50059972]
Stock Position:  0.008721073544852695
Bond Position:  [-0.78649961]


portfolio before change:  [0.00496883]
curr_Stock_Price:  90.76482974605109
curr_Factors:  [90.76482975 -0.2192031  -0.98534839]
mat_Sqrt:  [[27.21369635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00058652 -0.00447908  0.15918184]
Stock Position:  0.0005865161710747464
Bond Position:  [-0.04826621]


portfolio before change:  [0.00492698]
curr_Stock_Price:  90.70376584268494
curr_Factors:  [ 9.07037658e+01 -8.96260473e-02 -9.46660125e-01]
mat_Sqrt:  [[32.17895618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184795  0.04858462  0.07921514]
Stock Position:  -0.0018479470011610716
Bond Position:  [0.17254273]


portfolio before change:  [0.00256268]
curr_Stock_Price:  91.99485779909106
curr_Factors:  [91.9948578  -0.11843355 -0.95369532]
mat_Sqrt:  [[31.48791476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361051 -0.01680793 -0.15835684]
Stock Position:  -0.0036105067878786676
Bond Position:  [0.33471074]


portfolio before change:  [0.00674896]
curr_Stock_Price:  90.84697417683618
curr_Factors:  [90.84697418 -0.23723478 -0.93988939]
mat_Sqrt:  [[27.99573893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07472916 0.38279962 0.43124086]
Stock Position:  0.07472916162951944
Bond Position:  [-6.78216925]


portfolio before change:  [-0.05986926]
curr_Stock_Price:  89.96685725275374
curr_Factors:  [89.96685725 -0.30661504 -0.95116553]
mat_Sqrt:  [[25.57616263  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00657938 -0.11527448  0.26581319]
Stock Position:  0.006579378929751819
Bond Position:  [-0.6517953]


portfolio before change:  [-0.05010233]
curr_Stock_Price:  91.4637167060404
curr_Factors:  [91.46371671 -0.58893422 -0.98978785]
mat_Sqrt:  [[18.86333856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00136472 -0.00488585  0.01992758]
Stock Position:  0.0013647220216554702
Bond Position:  [-0.17492488]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.0469687]
Stock Price:  93.77591165500257
PL:  [-0.0469687]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 8.95136506e-02  2.62020483e-02 -1.46711277e-01]
 [ 1.17764907e+00  2.33024406e-01  3.44262374e-01]
 [-2.64424591e-01 -1.56926981e-01  3.75095112e-02]
 [ 1.83749093e-01  1.34422347e+00  1.16810529e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 5.00420585e-02 -5.87486228e-02  4.32411703e-02]
 [-3.83997400e-02 -7.91814948e-02 -2.64777743e-02]
 [ 1.27142276e-01  8.08730790e-02 -1.07767100e-01]
 [ 1.54491527e-03  7.88614060e-02 -4.86756237e-02]
 [-3.93988752e-01 -5.61283895e-02 -1.68896600e-01]
 [ 5.93357235e-01  1.14351377e+00 -2.07604689e-01]
 [-2.01825686e-04  3.26256190e-02 -5.83589856e-02]
 [-2.51040828e-01 -1.60638550e-02 -5.56311438e-01]
 [ 1.82436940e+00 -3.51762438e+00  2.95606091e+00]
 [ 1.33507867e-02 -9.06889226e-02  3.48288945e-02]
 [ 1.13896601e-01 -3.79908573e-02 -5.94177070e-03]
 [-8.11999487e-02 -4.69771683e-02 -5.08138922e-02]
 [-2.61669747e-01 -1.69682707e+00 -1.95203684e-01]
 [-2.07653317e-02  8.54119845e-02  2.96930432e-01]
 [ 2.59763092e-01  1.76242880e-01  6.08560977e-01]
 [ 7.40829280e-02 -4.09846602e-01 -1.18883564e-01]
 [ 1.23667139e-01 -5.17021023e-02 -7.85610455e-03]
 [ 5.38978859e-03  1.37454208e-01  6.81703435e-02]
 [ 2.69390535e-01 -3.25091972e-01 -2.06979661e-01]
 [ 9.58825632e-03 -5.53241671e-02  1.84097122e-02]
 [-3.20920981e-03 -3.39019837e-02  1.00815730e-01]
 [ 5.58364251e-01 -9.54355185e-02  2.81642366e-01]
 [ 1.41415017e-01 -3.06872718e-01 -1.84131285e-01]
 [-9.20808708e-03 -7.46510620e-02 -2.64148783e-03]
 [ 1.81714007e-01 -8.10712167e-02  6.28573239e-02]
 [-1.39367877e-02 -5.38521021e-02 -4.19720374e-02]
 [-3.38678872e-02  2.42327310e-02 -5.09300970e-02]
 [-3.56584040e-02 -2.82441416e-02 -2.74032915e-02]
 [ 2.89894733e-01  4.34839953e-02  6.95868690e-02]
 [-9.13097584e-02 -4.22748156e-02  6.40875742e-02]
 [-1.08199940e-01 -5.25116550e-02 -8.88560627e-02]
 [ 2.41795010e+00  1.56784557e+00  1.75865521e-01]
 [-6.07254649e-02 -8.41967957e-02 -3.66693703e-02]
 [ 3.51268346e-02 -1.33308380e-02 -1.08705648e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.39617154]
curr_Stock_Price:  99.72549385800279
curr_Factors:  [99.72549386 -1.41507058 -0.98568114]
mat_Sqrt:  [[ 9.04009449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00718077  0.00845667 -0.41852644]
Stock Position:  0.007180766448035253
Bond Position:  [-0.31993395]


portfolio before change:  [0.39866801]
curr_Stock_Price:  100.07872544867944
curr_Factors:  [100.07872545  -1.32639298  -0.99646746]
mat_Sqrt:  [[ 9.80700275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.13209818 0.0752083  0.98208473]
Stock Position:  0.13209818232127193
Bond Position:  [-12.82154971]


portfolio before change:  [0.3670283]
curr_Stock_Price:  99.8513421650262
curr_Factors:  [99.85134217 -1.07423687 -0.9977116 ]
mat_Sqrt:  [[12.57529316  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02296571 -0.05064797  0.10700419]
Stock Position:  -0.02296571351466543
Bond Position:  [2.66018562]


portfolio before change:  [0.37012803]
curr_Stock_Price:  99.7308500976239
curr_Factors:  [99.7308501  -1.00826146 -0.98099879]
mat_Sqrt:  [[13.64283957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.051058   0.43384626 3.33227925]
Stock Position:  0.05105799638245161
Bond Position:  [-4.72192935]


portfolio before change:  [0.39052115]
curr_Stock_Price:  100.14182188658474
curr_Factors:  [100.14182189  -1.17684519  -0.97637996]
mat_Sqrt:  [[11.62737525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00504379 -0.01106097 -0.05874131]
Stock Position:  -0.005043786725513158
Bond Position:  [0.89561514]


portfolio before change:  [0.38799653]
curr_Stock_Price:  100.664559300264
curr_Factors:  [100.6645593   -1.34417404  -0.95017357]
mat_Sqrt:  [[10.14972062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00461851 -0.01896104  0.12335502]
Stock Position:  0.004618512642927545
Bond Position:  [-0.07692401]


portfolio before change:  [0.39268212]
curr_Stock_Price:  101.6811648266907
curr_Factors:  [101.68116483  -1.29571951  -0.94407668]
mat_Sqrt:  [[10.82703117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00553867 -0.02555572 -0.07553372]
Stock Position:  -0.005538669561886834
Bond Position:  [0.9558605]


portfolio before change:  [0.39098598]
curr_Stock_Price:  102.00897477258606
curr_Factors:  [102.00897477  -1.31335083  -0.95313101]
mat_Sqrt:  [[10.57591198  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0115028   0.02610167 -0.30742954]
Stock Position:  0.011502795874067728
Bond Position:  [-0.78240243]


portfolio before change:  [0.39519182]
curr_Stock_Price:  102.38311341885286
curr_Factors:  [102.38311342  -1.32544902  -0.96600424]
mat_Sqrt:  [[10.35291922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074439  0.02545241 -0.13885801]
Stock Position:  0.0007443854355022367
Bond Position:  [0.31897932]


portfolio before change:  [0.39511293]
curr_Stock_Price:  102.22357527014671
curr_Factors:  [102.22357527  -1.37683128  -0.95582601]
mat_Sqrt:  [[ 9.919525    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04434908 -0.01811536 -0.48181499]
Stock Position:  -0.04434907780004011
Bond Position:  [4.92863423]


portfolio before change:  [0.40543842]
curr_Stock_Price:  102.00464460736431
curr_Factors:  [102.00464461  -1.69906359  -0.94359116]
mat_Sqrt:  [[ 7.25988215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10804568  0.36906748 -0.59223839]
Stock Position:  0.10804567617276098
Bond Position:  [-10.61572238]


portfolio before change:  [0.34211783]
curr_Stock_Price:  101.43087297851736
curr_Factors:  [101.43087298  -1.60765628  -0.93059648]
mat_Sqrt:  [[ 8.01347697  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068068  0.01052987 -0.16648194]
Stock Position:  -0.0006806817007724265
Bond Position:  [0.41115997]


portfolio before change:  [0.3419935]
curr_Stock_Price:  101.68903725589037
curr_Factors:  [101.68903726  -1.65253897  -0.92853358]
mat_Sqrt:  [[ 7.69712555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.047794   -0.00518459 -1.58700168]
Stock Position:  -0.047794003440684726
Bond Position:  [5.2021197]


portfolio before change:  [0.36771272]
curr_Stock_Price:  101.16451730409715
curr_Factors:  [101.1645173   -1.64021299  -0.92607276]
mat_Sqrt:  [[ 7.77149318  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.22000157 -1.13530839  8.43281896]
Stock Position:  0.22000157402070009
Bond Position:  [-21.88864033]


portfolio before change:  [0.41220576]
curr_Stock_Price:  101.37919438636311
curr_Factors:  [101.37919439  -1.5010538   -0.94865842]
mat_Sqrt:  [[ 8.75089218  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00022265 -0.02926972  0.09935714]
Stock Position:  0.0002226522945296313
Bond Position:  [0.38963345]


portfolio before change:  [0.41227013]
curr_Stock_Price:  101.44954625051578
curr_Factors:  [101.44954625  -1.53059041  -0.94591568]
mat_Sqrt:  [[ 8.52544741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01230773 -0.0122615  -0.01695022]
Stock Position:  0.012307728401068599
Bond Position:  [-0.83634333]


portfolio before change:  [0.40610612]
curr_Stock_Price:  100.95721607842421
curr_Factors:  [100.95721608  -1.696824    -0.92928334]
mat_Sqrt:  [[ 7.30522233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01384783 -0.01516182 -0.14495789]
Stock Position:  -0.013847828408087915
Bond Position:  [1.80414432]


portfolio before change:  [0.39719643]
curr_Stock_Price:  101.61690220130923
curr_Factors:  [101.6169022   -1.85443559  -0.89260229]
mat_Sqrt:  [[ 6.5154221   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09943775 -0.54764858 -0.55686177]
Stock Position:  -0.09943774913347932
Bond Position:  [10.50175246]


portfolio before change:  [0.43306747]
curr_Stock_Price:  101.26936575519767
curr_Factors:  [101.26936576  -1.62151979  -0.89559164]
mat_Sqrt:  [[ 8.17166371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00700959 0.0275666  0.84705987]
Stock Position:  0.0070095869390582105
Bond Position:  [-0.27678895]


portfolio before change:  [0.42997764]
curr_Stock_Price:  100.83350066895403
curr_Factors:  [100.83350067  -1.75972601  -0.86461669]
mat_Sqrt:  [[ 7.30915701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05745676 0.05688214 1.73605508]
Stock Position:  0.05745676394349317
Bond Position:  [-5.36358901]


portfolio before change:  [0.43414338]
curr_Stock_Price:  100.91767240248275
curr_Factors:  [100.9176724   -1.94861163  -0.88216684]
mat_Sqrt:  [[ 5.95080553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00568724 -0.13227742 -0.33914172]
Stock Position:  -0.005687241008580666
Bond Position:  [1.00808651]


portfolio before change:  [0.43283562]
curr_Stock_Price:  101.16977790195722
curr_Factors:  [101.1697779   -1.92671845  -0.87353011]
mat_Sqrt:  [[ 6.15061155  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01812988 -0.01668678 -0.02241128]
Stock Position:  0.01812988341738271
Bond Position:  [-1.40136066]


portfolio before change:  [0.43397814]
curr_Stock_Price:  101.24245954580944
curr_Factors:  [101.24245955  -1.72827993  -0.90506489]
mat_Sqrt:  [[ 7.27303309  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0065121  0.04436315 0.19447101]
Stock Position:  0.0065121007638781585
Bond Position:  [-0.22532295]


portfolio before change:  [0.43753746]
curr_Stock_Price:  101.79335459903542
curr_Factors:  [101.7933546   -1.96251862  -0.92843414]
mat_Sqrt:  [[ 5.65190165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02844739 -0.10492298 -0.59045536]
Stock Position:  0.028447393017419987
Bond Position:  [-2.4582181]


portfolio before change:  [0.42243915]
curr_Stock_Price:  101.27341188521078
curr_Factors:  [101.27341189  -1.77456701  -0.90173922]
mat_Sqrt:  [[ 6.96932006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00029459 -0.0178558   0.05251778]
Stock Position:  0.0002945947028898593
Bond Position:  [0.39260454]


portfolio before change:  [0.42262984]
curr_Stock_Price:  101.75410234738374
curr_Factors:  [101.75410235  -1.83332136  -0.89545347]
mat_Sqrt:  [[ 6.64446589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00157266 -0.01094182  0.28759922]
Stock Position:  0.0015726623567071806
Bond Position:  [0.26260499]


portfolio before change:  [0.4232382]
curr_Stock_Price:  102.12006635148047
curr_Factors:  [102.12006635  -1.67140327  -0.8966055 ]
mat_Sqrt:  [[ 7.83139356  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07615165 -0.03080168  0.80344728]
Stock Position:  0.076151653013119
Bond Position:  [-7.35337366]


portfolio before change:  [0.43845549]
curr_Stock_Price:  102.33196609046611
curr_Factors:  [102.33196609  -1.70479625  -0.87498738]
mat_Sqrt:  [[ 7.75578072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00531078 -0.09904274 -0.5252753 ]
Stock Position:  0.00531077997831426
Bond Position:  [-0.10500707]


portfolio before change:  [0.438727]
curr_Stock_Price:  102.38556128731834
curr_Factors:  [102.38556129  -1.76559654  -0.92044226]
mat_Sqrt:  [[ 6.97761312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00358079 -0.02409353 -0.00753543]
Stock Position:  -0.00358078935077095
Bond Position:  [0.80534812]


portfolio before change:  [0.44050084]
curr_Stock_Price:  101.91829703316064
curr_Factors:  [101.91829703  -1.70105595  -0.93285471]
mat_Sqrt:  [[ 7.31744209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02432491 -0.02616562  0.17931445]
Stock Position:  0.024324908831090897
Bond Position:  [-2.03865244]


portfolio before change:  [0.46225226]
curr_Stock_Price:  102.82297737476874
curr_Factors:  [102.82297737  -1.64208878  -0.91428464]
mat_Sqrt:  [[ 7.9775825   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00419887 -0.01738069 -0.11973454]
Stock Position:  -0.00419886704201616
Bond Position:  [0.89399228]


portfolio before change:  [0.46277037]
curr_Stock_Price:  102.72620024719191
curr_Factors:  [102.72620025  -1.54184178  -0.9401537 ]
mat_Sqrt:  [[ 8.58547417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00457953  0.00782108 -0.14528939]
Stock Position:  -0.004579533224875668
Bond Position:  [0.93320842]


portfolio before change:  [0.4648336]
curr_Stock_Price:  102.30114144988903
curr_Factors:  [102.30114145  -1.51736088  -0.94940399]
mat_Sqrt:  [[ 8.68116695  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00541602 -0.00911576 -0.07817396]
Stock Position:  -0.005416021718500987
Bond Position:  [1.01889881]


portfolio before change:  [0.46745207]
curr_Stock_Price:  101.84119290532736
curr_Factors:  [101.84119291  -1.58402243  -0.94801954]
mat_Sqrt:  [[ 8.09602095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03865791 0.0140344  0.19851197]
Stock Position:  0.03865790714368396
Bond Position:  [-3.46951531]


portfolio before change:  [0.46851977]
curr_Stock_Price:  101.88003167399211
curr_Factors:  [101.88003167  -1.61225323  -0.95329391]
mat_Sqrt:  [[ 7.83224218  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0110897  -0.01364414  0.18282401]
Stock Position:  -0.01108970403822722
Bond Position:  [1.59833917]


portfolio before change:  [0.47286538]
curr_Stock_Price:  101.50618893093494
curr_Factors:  [101.50618893  -1.38848464  -0.93428406]
mat_Sqrt:  [[ 9.94779644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01377757 -0.01694806 -0.25348161]
Stock Position:  -0.013777574316272544
Bond Position:  [1.87137445]


portfolio before change:  [0.46786319]
curr_Stock_Price:  101.88623658731251
curr_Factors:  [101.88623659  -1.55683249  -0.93551855]
mat_Sqrt:  [[ 8.42754761  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.32914482 0.50601998 0.50169538]
Stock Position:  0.3291448194459699
Bond Position:  [-33.06746376]


portfolio before change:  [0.89782468]
curr_Stock_Price:  103.20509429885485
curr_Factors:  [103.2050943   -1.45562187  -0.90179535]
mat_Sqrt:  [[ 9.76984889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00874089 -0.0271744  -0.10460751]
Stock Position:  -0.008740889314919951
Bond Position:  [1.79992898]


portfolio before change:  [0.90037878]
curr_Stock_Price:  102.93863440152495
curr_Factors:  [102.9386344   -1.26702517  -0.91603584]
mat_Sqrt:  [[11.60077631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00088065 -0.00430251 -0.31010695]
Stock Position:  0.000880651516849937
Bond Position:  [0.80972572]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.90000743]
Stock Price:  102.40201351738963
PL:  [-1.50200609]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.71394101e-01  3.70467424e-02 -7.57197173e-02]
 [ 1.87711349e+00  5.14186210e-01  7.18522689e-01]
 [ 1.29690584e-01  2.39773832e-01  4.29973334e-02]
 [ 2.87592653e-02  1.92832150e-01  1.80243280e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 5.58637913e-02  5.71861503e-02 -2.75716420e-02]
 [-3.29858351e-02 -1.13830403e-01 -3.32025907e-03]
 [ 2.08096151e-01  4.09756640e-02 -2.03488323e-01]
 [ 3.56873855e-02  4.19137354e-02 -4.30623278e-02]
 [-3.43080003e-01 -4.03669678e-03 -1.27910525e-01]
 [ 6.28206647e-01  1.23105506e+00 -2.14337727e-01]
 [-1.57545218e-04  2.35994202e-02 -5.80919653e-02]
 [-1.61786935e-01 -1.14597356e-02 -3.65772383e-01]
 [ 1.63829569e+00 -3.14691222e+00  2.63775473e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.30899757e-01 -3.94213918e-02 -8.05178121e-03]
 [-9.43272649e-02 -7.91239677e-02 -5.06872162e-02]
 [-2.72034487e-01 -1.77069526e+00 -2.00565508e-01]
 [-6.56211828e-03  3.83339880e-02  1.50985490e-01]
 [ 3.09079036e-01 -3.25811401e-01  3.71640364e-01]
 [ 7.75682314e-02 -7.23751095e-02 -5.05911950e-02]
 [ 9.90083540e-02 -5.52514146e-02 -5.38850541e-02]
 [ 2.65582365e-01  1.86255772e-01  2.03754251e-01]
 [-2.52320213e-01  9.02888348e-02  2.84229146e-02]
 [-1.02120757e-01 -3.10944638e-01  1.12289735e-01]
 [ 1.42749358e-01 -4.23751123e-02 -1.51253335e-01]
 [ 5.76249222e-01 -3.81938606e-02  3.42054787e-01]
 [-5.96887392e-02  6.00802881e-02  1.06587884e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 2.93418120e-01 -1.13696873e-01 -1.23805764e-02]
 [-2.54957086e-02 -7.15693127e-02 -2.83567235e-02]
 [ 4.20690555e-02  2.43374070e-02 -7.16560716e-02]
 [-3.61159423e-02 -1.42109447e-02 -4.42248317e-02]
 [ 4.46724199e-01  7.08447303e-02  1.06984438e-01]
 [ 1.64099631e-02  2.27752750e-02 -1.97554869e-02]
 [-9.15762340e-02 -2.31539619e-02 -1.10584489e-01]
 [ 1.92980438e+00  1.35497483e+00  1.74909570e-01]
 [-7.91079611e-02 -2.08830088e-02 -2.22060584e-02]
 [ 3.75656735e-02 -1.27451444e-02 -1.65050330e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.25763539]
curr_Stock_Price:  102.0264361848609
curr_Factors:  [102.02643618  -1.04061902  -0.97663339]
mat_Sqrt:  [[13.57160236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01204722  0.01195678 -0.21600728]
Stock Position:  0.012047215076575569
Bond Position:  [16.02850097]


portfolio before change:  [17.26461555]
curr_Stock_Price:  102.43951711454257
curr_Factors:  [102.43951711  -0.94047653  -0.97333542]
mat_Sqrt:  [[15.11156882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.14086818 0.16595289 2.04974523]
Stock Position:  0.14086817661346165
Bond Position:  [2.83414756]


portfolio before change:  [17.24104581]
curr_Stock_Price:  102.26968439727122
curr_Factors:  [102.2696844   -0.7942506   -0.96465321]
mat_Sqrt:  [[17.614272    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01063972 0.07738667 0.12265942]
Stock Position:  0.010639724797824568
Bond Position:  [16.15292452]


portfolio before change:  [17.25143175]
curr_Stock_Price:  103.05604789381393
curr_Factors:  [103.05604789  -0.76556681  -0.98709454]
mat_Sqrt:  [[17.86085848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0058739  0.06223631 0.51418391]
Stock Position:  0.005873904023371962
Bond Position:  [16.64609041]


portfolio before change:  [17.24984068]
curr_Stock_Price:  102.43091675002334
curr_Factors:  [102.43091675  -0.51348764  -0.99254868]
mat_Sqrt:  [[22.71787979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258149 -0.01106097 -0.05874131]
Stock Position:  -0.002581490943642158
Bond Position:  [17.51426516]


portfolio before change:  [17.25343172]
curr_Stock_Price:  101.88796494786368
curr_Factors:  [101.88796495  -0.37968773  -0.96543695]
mat_Sqrt:  [[26.54255108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00233244  0.01845675 -0.07865422]
Stock Position:  0.0023324369749494504
Bond Position:  [17.01578447]


portfolio before change:  [17.25648055]
curr_Stock_Price:  102.28314089435699
curr_Factors:  [102.28314089  -0.5804257   -0.97450481]
mat_Sqrt:  [[21.60261458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026339  -0.0367386  -0.00947177]
Stock Position:  -0.00263389941532781
Bond Position:  [17.52588406]


portfolio before change:  [17.25362483]
curr_Stock_Price:  104.19915809893209
curr_Factors:  [104.1991581   -0.62493472  -0.98827121]
mat_Sqrt:  [[20.76145449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00842539  0.01322484 -0.58049555]
Stock Position:  0.008425392013953198
Bond Position:  [16.37570607]


portfolio before change:  [17.24295642]
curr_Stock_Price:  102.68996983518754
curr_Factors:  [102.68996984  -0.49217672  -1.0062357 ]
mat_Sqrt:  [[22.94963478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00154481  0.0135276  -0.12284483]
Stock Position:  0.0015448145630755777
Bond Position:  [17.08431946]


portfolio before change:  [17.24556681]
curr_Stock_Price:  102.99727155406869
curr_Factors:  [102.99727155  -0.68551641  -1.01995074]
mat_Sqrt:  [[18.71331585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01977274 -0.00130284 -0.36489313]
Stock Position:  -0.019772744713309805
Bond Position:  [19.28210557]


portfolio before change:  [17.24610796]
curr_Stock_Price:  103.09180907359622
curr_Factors:  [103.09180907  -0.87382684  -1.03128593]
mat_Sqrt:  [[15.34066537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05447894  0.39732131 -0.61144588]
Stock Position:  0.05447894098735324
Bond Position:  [11.62977538]


portfolio before change:  [17.25981455]
curr_Stock_Price:  103.3167176215955
curr_Factors:  [103.31671762  -1.10843386  -1.03700457]
mat_Sqrt:  [[12.08978368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0005954   0.00761668 -0.16572021]
Stock Position:  -0.0005954040777757696
Bond Position:  [17.32132975]


portfolio before change:  [17.26263783]
curr_Stock_Price:  102.2116336310318
curr_Factors:  [102.21163363  -1.11445923  -1.02371342]
mat_Sqrt:  [[12.04768892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01982033 -0.00369861 -1.0434468 ]
Stock Position:  -0.019820325712466363
Bond Position:  [19.2885057]


portfolio before change:  [17.26698857]
curr_Stock_Price:  102.11377790074305
curr_Factors:  [102.1137779   -0.9093326   -1.02854556]
mat_Sqrt:  [[14.70532257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10434075 -1.01566155  7.52478004]
Stock Position:  0.10434074781586551
Bond Position:  [6.61236063]


portfolio before change:  [17.23551759]
curr_Stock_Price:  101.8042383902128
curr_Factors:  [101.80423839  -0.96680644  -1.00160939]
mat_Sqrt:  [[14.21980786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152389 -0.03053791  0.10625201]
Stock Position:  -0.0015238864755792478
Bond Position:  [17.39065569]


portfolio before change:  [17.23812615]
curr_Stock_Price:  101.51905097787743
curr_Factors:  [101.51905098  -0.9249989   -1.02029835]
mat_Sqrt:  [[14.51161303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00835257 -0.0127232  -0.02296949]
Stock Position:  0.00835257496402025
Bond Position:  [16.39018066]


portfolio before change:  [17.23713869]
curr_Stock_Price:  101.15552779296175
curr_Factors:  [101.15552779  -1.01531845  -1.02635113]
mat_Sqrt:  [[13.13118104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00920137 -0.02553715 -0.14459652]
Stock Position:  -0.009201370502818284
Bond Position:  [18.16790818]


portfolio before change:  [17.23898513]
curr_Stock_Price:  101.20168325124476
curr_Factors:  [101.20168325  -0.8831384   -1.0588586 ]
mat_Sqrt:  [[14.51406814  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04646639 -0.57148944 -0.57215757]
Stock Position:  -0.046466393793032044
Bond Position:  [21.9414624]


portfolio before change:  [17.19992805]
curr_Stock_Price:  102.10125670087366
curr_Factors:  [102.1012567   -1.06433375  -1.04623706]
mat_Sqrt:  [[12.37148498  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00259327 0.01237224 0.43071958]
Stock Position:  0.0025932665663722485
Bond Position:  [16.93515228]


portfolio before change:  [17.20527309]
curr_Stock_Price:  103.34602512896032
curr_Factors:  [103.34602513  -1.34394014  -1.02265555]
mat_Sqrt:  [[ 9.69380611  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03284921 -0.10515518  1.06018651]
Stock Position:  0.032849205992738446
Bond Position:  [13.81043823]


portfolio before change:  [17.2173196]
curr_Stock_Price:  103.66019080239222
curr_Factors:  [103.6601908   -1.26751496  -1.01530021]
mat_Sqrt:  [[10.57299365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00496244 -0.02335897 -0.1443226 ]
Stock Position:  0.00496243933944183
Bond Position:  [16.70291219]


portfolio before change:  [17.21812095]
curr_Stock_Price:  103.40091485498453
curr_Factors:  [103.40091485  -1.07722086  -1.03305934]
mat_Sqrt:  [[12.53260442  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00612251 -0.01783232 -0.15371906]
Stock Position:  0.0061225075818726145
Bond Position:  [16.58504807]


portfolio before change:  [17.21519056]
curr_Stock_Price:  102.5836600909843
curr_Factors:  [102.58366009  -0.62428463  -1.01921903]
mat_Sqrt:  [[19.82958464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01740797 0.06011379 0.58125416]
Stock Position:  0.017407970647003782
Bond Position:  [15.42941722]


portfolio before change:  [17.22245729]
curr_Stock_Price:  102.8902972537089
curr_Factors:  [102.89029725  -0.5542795   -1.01107181]
mat_Sqrt:  [[21.50557125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01060601  0.0291406   0.08108266]
Stock Position:  -0.010606008844504463
Bond Position:  [18.3137127]


portfolio before change:  [17.20423613]
curr_Stock_Price:  104.82415574086502
curr_Factors:  [104.82415574  -0.55150869  -1.00305427]
mat_Sqrt:  [[22.14742574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00644188 -0.10035695  0.32033136]
Stock Position:  -0.006441878192414742
Bond Position:  [17.87950057]


portfolio before change:  [17.20081421]
curr_Stock_Price:  105.70231603379123
curr_Factors:  [105.70231603  -0.90278888  -1.02181636]
mat_Sqrt:  [[15.42549359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00669185 -0.01367651 -0.43148366]
Stock Position:  0.006691851792538431
Bond Position:  [16.49346997]


portfolio before change:  [17.19985246]
curr_Stock_Price:  105.2504893558223
curr_Factors:  [105.25048936  -1.09929845  -1.0177756 ]
mat_Sqrt:  [[12.67040644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05037522 -0.01232702  0.9757871 ]
Stock Position:  0.05037522487050751
Bond Position:  [11.89783539]


portfolio before change:  [17.21040577]
curr_Stock_Price:  105.43045844451687
curr_Factors:  [105.43045844  -1.24893729  -1.03226618]
mat_Sqrt:  [[10.7709005   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238306  0.01939083  0.30406556]
Stock Position:  -0.002383063613895331
Bond Position:  [17.46165326]


portfolio before change:  [17.21295376]
curr_Stock_Price:  105.2772304057182
curr_Factors:  [105.27723041  -1.11093657  -1.05839594]
mat_Sqrt:  [[12.02832938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00285821 -0.02600141 -0.03673698]
Stock Position:  -0.0028582073738922177
Bond Position:  [17.51385792]


portfolio before change:  [17.21523029]
curr_Stock_Price:  105.24673573809397
curr_Factors:  [105.24673574  -1.00616646  -1.06632461]
mat_Sqrt:  [[13.24759983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02020613 -0.03669551 -0.03531834]
Stock Position:  0.020206125774433953
Bond Position:  [15.08860151]


portfolio before change:  [17.20874349]
curr_Stock_Price:  104.83235688182342
curr_Factors:  [104.83235688  -1.08205019  -1.05550396]
mat_Sqrt:  [[12.36423865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371176 -0.0230989  -0.08089384]
Stock Position:  -0.0037117550584384396
Bond Position:  [17.59785552]


portfolio before change:  [17.21511406]
curr_Stock_Price:  103.70871133900117
curr_Factors:  [103.70871134  -1.02515228  -1.02472578]
mat_Sqrt:  [[13.35255903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00242726  0.00785486 -0.20441483]
Stock Position:  0.002427263081411887
Bond Position:  [16.96338573]


portfolio before change:  [17.21971202]
curr_Stock_Price:  104.72936846811677
curr_Factors:  [104.72936847  -1.08256108  -1.03739448]
mat_Sqrt:  [[12.57139525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0038217  -0.00458656 -0.12616114]
Stock Position:  -0.0038216995224739617
Bond Position:  [17.6199562]


portfolio before change:  [17.22359413]
curr_Stock_Price:  104.28990979551831
curr_Factors:  [104.2899098   -1.08213677  -1.05329659]
mat_Sqrt:  [[12.32637472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03918617 0.02286504 0.30519682]
Stock Position:  0.03918617084598363
Bond Position:  [13.13687191]


portfolio before change:  [17.20379792]
curr_Stock_Price:  103.74281821287138
curr_Factors:  [103.74281821  -0.95899819  -1.05990066]
mat_Sqrt:  [[13.7772142   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00123584  0.00735069 -0.05635691]
Stock Position:  0.0012358358160848614
Bond Position:  [17.07558883]


portfolio before change:  [17.20543297]
curr_Stock_Price:  103.33861341013191
curr_Factors:  [103.33861341  -0.77080189  -1.08174876]
mat_Sqrt:  [[16.20727897  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0073347  -0.00747291 -0.31546677]
Stock Position:  -0.007334697032231578
Bond Position:  [17.96339039]


portfolio before change:  [17.20158562]
curr_Stock_Price:  104.16931049965469
curr_Factors:  [104.1693105   -0.51495077  -1.09042617]
mat_Sqrt:  [[20.91863982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10718148 0.43731625 0.49896832]
Stock Position:  0.10718147769361737
Bond Position:  [6.03656499]


portfolio before change:  [17.20863055]
curr_Stock_Price:  104.22799887016176
curr_Factors:  [104.22799887  -0.56338409  -1.07927177]
mat_Sqrt:  [[20.16452622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435931 -0.00673996 -0.0633477 ]
Stock Position:  -0.0043593129409057515
Bond Position:  [17.66299301]


portfolio before change:  [17.20715312]
curr_Stock_Price:  105.07341562197205
curr_Factors:  [105.07341562  -0.53427828  -1.08917581]
mat_Sqrt:  [[20.72219213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.14473689e-05 -4.11347766e-03 -4.70842652e-01]
Stock Position:  6.144736889438827e-05
Bond Position:  [17.20069664]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.20921755]
Stock Price:  103.67726107370386
PL:  [13.53195648]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-1.65320623e-02 -1.04409175e-01  1.25389677e-01]
 [ 8.44093939e-01  2.12760156e-01  2.36398934e-01]
 [-2.55956889e-01 -1.49132637e-01  3.72625204e-02]
 [ 1.29523284e-01  1.09294237e+00  8.47020921e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-6.09701486e-02 -8.96990435e-04 -5.21245157e-02]
 [-3.21888650e-02 -1.19266517e-01  2.13006366e-03]
 [ 1.28424680e-01  8.61467265e-02 -1.09695480e-01]
 [-6.62797466e-03  8.77057937e-02 -5.00193123e-02]
 [-2.03965178e-01 -1.14059891e-01 -8.73567307e-02]
 [ 7.24158681e-01  1.39563966e+00 -2.52135908e-01]
 [-1.02608245e-04  2.99509492e-02 -5.85185224e-02]
 [-2.96201017e-01 -1.80850309e-03 -6.16345676e-01]
 [ 1.82288479e+00 -3.23810383e+00  2.72808186e+00]
 [ 1.28956722e-02 -9.07656437e-02  3.48760858e-02]
 [ 1.21682841e-01 -9.73802029e-03 -2.73273661e-02]
 [-6.75247115e-02 -2.20128282e-02 -6.16036784e-02]
 [-2.76515251e-01 -1.79520234e+00 -2.00200702e-01]
 [ 7.75830104e-04  3.61226016e-02  6.63389744e-02]
 [ 1.93197425e-01 -2.49409122e-01  2.16282903e-01]
 [ 5.54551605e-02  7.62525504e-02 -7.27060310e-04]
 [-5.08142001e-02 -5.24427658e-02 -1.09588192e-01]
 [ 4.96348324e-01  3.56941493e-01  3.76500181e-01]
 [ 1.33460229e-01  1.17912475e-01  2.08672844e-01]
 [-1.48484814e-01 -4.91268192e-01  1.67631302e-01]
 [ 2.44043806e-01 -8.27365037e-02 -2.85261503e-01]
 [ 3.86367291e-01  2.36502754e-02  2.81990347e-01]
 [-5.86917855e-02  6.08807216e-02  1.05507710e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 1.99621273e-01 -2.67216695e-02 -1.97864032e-02]
 [-2.62859539e-02 -7.81449450e-02 -2.40551744e-02]
 [ 8.18770903e-02  2.19428424e-02 -8.17652312e-02]
 [-8.40164553e-02 -3.77185949e-02  3.65280896e-02]
 [ 1.07011299e-02  5.47719255e-03  4.08230537e-03]
 [-5.67441670e-02  5.45780310e-02  3.55644535e-03]
 [-1.17382530e-01 -6.83654860e-02 -7.98147490e-02]
 [ 1.74090714e+00  1.13250867e+00  1.47225084e-01]
 [-3.82837361e-02 -1.60591932e-02 -1.19008735e-02]
 [ 3.54875290e-02 -1.34757251e-02 -1.13404037e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.32014636]
curr_Stock_Price:  99.0818975740483
curr_Factors:  [99.08189757 -0.9745215  -0.98276647]
mat_Sqrt:  [[13.99442157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087531 -0.03369792  0.35770185]
Stock Position:  -0.0008753084410525197
Bond Position:  [-4.23341914]


portfolio before change:  [-4.32113799]
curr_Stock_Price:  99.6101894650312
curr_Factors:  [99.61018947 -1.00351423 -0.98426885]
mat_Sqrt:  [[13.64647692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06857287 0.06866804 0.67438036]
Stock Position:  0.06857287489042602
Bond Position:  [-11.15169505]


portfolio before change:  [-4.29754421]
curr_Stock_Price:  99.9745876414015
curr_Factors:  [99.97458764 -0.95803554 -1.00018217]
mat_Sqrt:  [[14.10738363  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01976215 -0.04813235  0.1062996 ]
Stock Position:  -0.019762153528952695
Bond Position:  [-2.32183106]


portfolio before change:  [-4.3145541]
curr_Stock_Price:  100.82063120497787
curr_Factors:  [100.8206312   -1.1101672   -1.00329054]
mat_Sqrt:  [[12.18109636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04314198 0.35274563 2.41631492]
Stock Position:  0.04314198135402789
Bond Position:  [-8.66415589]


portfolio before change:  [-4.27695077]
curr_Stock_Price:  101.71735442936205
curr_Factors:  [101.71735443  -1.12059476  -1.00304726]
mat_Sqrt:  [[12.16491407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00482091 -0.01106097 -0.05874131]
Stock Position:  -0.004820913701581262
Bond Position:  [-3.78658018]


portfolio before change:  [-4.28307743]
curr_Stock_Price:  102.89001663031702
curr_Factors:  [102.89001663  -1.35066858  -1.0026411 ]
mat_Sqrt:  [[ 9.780112    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00734073 -0.0002895  -0.14869673]
Stock Position:  -0.007340725565739916
Bond Position:  [-3.52779005]


portfolio before change:  [-4.27929374]
curr_Stock_Price:  102.31450297637831
curr_Factors:  [102.31450298  -1.47373467  -1.01777237]
mat_Sqrt:  [[ 8.47011755  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0066232  -0.0384931   0.00607648]
Stock Position:  -0.0066231953823197515
Bond Position:  [-3.6016448]


portfolio before change:  [-4.27821351]
curr_Stock_Price:  102.08342666747542
curr_Factors:  [102.08342667  -1.27521589  -1.02172387]
mat_Sqrt:  [[10.26613515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01204132  0.02780374 -0.31293067]
Stock Position:  0.012041319262439457
Bond Position:  [-5.50743264]


portfolio before change:  [-4.28152686]
curr_Stock_Price:  101.86543714228428
curr_Factors:  [101.86543714  -1.45602776  -1.00735021]
mat_Sqrt:  [[ 8.67352024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.22758248e-04  2.83069232e-02 -1.42691175e-01]
Stock Position:  0.00012275824843270048
Bond Position:  [-4.29403169]


portfolio before change:  [-4.28216987]
curr_Stock_Price:  101.00016467779461
curr_Factors:  [101.00016468  -1.34640882  -0.99583798]
mat_Sqrt:  [[ 9.70727245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02524697 -0.03681267 -0.24920444]
Stock Position:  -0.025246965633473326
Bond Position:  [-1.73222218]


portfolio before change:  [-4.29541034]
curr_Stock_Price:  101.51602595738575
curr_Factors:  [101.51602596  -1.30710085  -1.01113777]
mat_Sqrt:  [[ 9.99393146  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09581569  0.45044076 -0.71927357]
Stock Position:  0.09581568682234402
Bond Position:  [-14.02223809]


portfolio before change:  [-4.35543311]
curr_Stock_Price:  100.90788046690578
curr_Factors:  [100.90788047  -1.06559351  -1.01933105]
mat_Sqrt:  [[12.54451439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047303  0.00966663 -0.16693706]
Stock Position:  -0.0004730306423172933
Bond Position:  [-4.30770059]


portfolio before change:  [-4.35567019]
curr_Stock_Price:  100.27068034863866
curr_Factors:  [100.27068035  -1.02703353  -1.02245798]
mat_Sqrt:  [[12.91490183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.27049494e-02 -5.83691863e-04 -1.75826266e+00]
Stock Position:  -0.032704949375041766
Bond Position:  [-1.07632267]


portfolio before change:  [-4.33993721]
curr_Stock_Price:  99.78550821631444
curr_Factors:  [99.78550822 -1.00142406 -1.00739439]
mat_Sqrt:  [[13.38593479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12840172 -1.04509352  7.7824582 ]
Stock Position:  0.12840171541603568
Bond Position:  [-17.15256764]


portfolio before change:  [-4.33934646]
curr_Stock_Price:  99.80680823019804
curr_Factors:  [99.80680823 -0.8267503  -0.97541704]
mat_Sqrt:  [[16.46223647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.03439800e-05 -2.92944856e-02  9.94917652e-02]
Stock Position:  9.034398002682265e-05
Bond Position:  [-4.3483634]


portfolio before change:  [-4.33985129]
curr_Stock_Price:  100.23567256354518
curr_Factors:  [100.23567256  -1.03905178  -0.96621918]
mat_Sqrt:  [[13.49410847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00845679 -0.00314293 -0.07795737]
Stock Position:  0.008456794402590688
Bond Position:  [-5.18752376]


portfolio before change:  [-4.33975016]
curr_Stock_Price:  100.32431241543071
curr_Factors:  [100.32431242  -0.69586152  -0.99275148]
mat_Sqrt:  [[18.53748804  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00456334 -0.00710461 -0.17573815]
Stock Position:  -0.004563339934029471
Bond Position:  [-3.88193622]


portfolio before change:  [-4.34057448]
curr_Stock_Price:  100.3986108357989
curr_Factors:  [100.39861084  -0.63639377  -1.02314834]
mat_Sqrt:  [[19.09843236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0358053  -0.57939906 -0.57111688]
Stock Position:  -0.03580530472032872
Bond Position:  [-0.74577163]


portfolio before change:  [-4.35884552]
curr_Stock_Price:  100.90629552500697
curr_Factors:  [100.90629553  -0.77216471  -1.00453706]
mat_Sqrt:  [[17.07286815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00127048 0.01165852 0.18924663]
Stock Position:  0.0012704784884849656
Bond Position:  [-4.48704479]


portfolio before change:  [-4.35827211]
curr_Stock_Price:  101.79912842228441
curr_Factors:  [101.79912842  -0.60862199  -0.97520264]
mat_Sqrt:  [[20.88804358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00892547 -0.08049645  0.61699492]
Stock Position:  0.008925467955504104
Bond Position:  [-5.26687697]


portfolio before change:  [-4.34770799]
curr_Stock_Price:  103.05648687770235
curr_Factors:  [103.05648688  -0.49416705  -0.97270707]
mat_Sqrt:  [[23.76949728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00298163  0.0246104  -0.0020741 ]
Stock Position:  0.0029816253910618503
Bond Position:  [-4.65498383]


portfolio before change:  [-4.34476597]
curr_Stock_Price:  104.23836919182338
curr_Factors:  [104.23836919  -0.26720128  -0.97447043]
mat_Sqrt:  [[30.11455396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00278565 -0.01692583 -0.31262461]
Stock Position:  -0.0027856507821836735
Bond Position:  [-4.05439428]


portfolio before change:  [-4.35004596]
curr_Stock_Price:  105.95184751787605
curr_Factors:  [105.95184752  -0.27258385  -0.97436582]
mat_Sqrt:  [[30.44844884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02121821 0.11520237 1.07405022]
Stock Position:  0.02121820662675054
Bond Position:  [-6.59815415]


portfolio before change:  [-4.31514691]
curr_Stock_Price:  107.635489756395
curr_Factors:  [107.63548976  -0.27981561  -0.96549245]
mat_Sqrt:  [[30.98311468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00645914 0.03805609 0.59528554]
Stock Position:  0.006459136862672287
Bond Position:  [-5.01037927]


portfolio before change:  [-4.29611419]
curr_Stock_Price:  110.67909444507131
curr_Factors:  [110.67909445  -0.29479094  -0.99704591]
mat_Sqrt:  [[30.41080959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00705496 -0.15855613  0.47820545]
Stock Position:  -0.0070549558043711625
Bond Position:  [-3.51527807]


portfolio before change:  [-4.28437828]
curr_Stock_Price:  108.95330862868346
curr_Factors:  [108.95330863  -0.13152294  -0.98475989]
mat_Sqrt:  [[35.68165169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00473427 -0.02670309 -0.81377167]
Stock Position:  0.004734268729126909
Bond Position:  [-4.80019252]


portfolio before change:  [-4.29342131]
curr_Stock_Price:  107.16993585020772
curr_Factors:  [107.16993585  -0.10862225  -0.98213511]
mat_Sqrt:  [[36.00502089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0124637  0.00763309 0.80443997]
Stock Position:  0.012463703968911482
Bond Position:  [-5.62915566]


portfolio before change:  [-4.28773916]
curr_Stock_Price:  107.68229052960116
curr_Factors:  [107.68229053  -0.20093205  -0.98959233]
mat_Sqrt:  [[32.74206862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075523  0.01964917  0.30098413]
Stock Position:  -0.0007552329524085997
Bond Position:  [-4.20641395]


portfolio before change:  [-4.28730981]
curr_Stock_Price:  106.4175347284083
curr_Factors:  [106.41753473  -0.15910895  -0.95259955]
mat_Sqrt:  [[35.01098465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098196 -0.02600141 -0.03673698]
Stock Position:  -0.0009819620916554233
Bond Position:  [-4.18281182]


portfolio before change:  [-4.28734525]
curr_Stock_Price:  105.92113989676311
curr_Factors:  [105.9211399   -0.12038409  -0.94072273]
mat_Sqrt:  [[36.65640002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00518676 -0.00862438 -0.0564451 ]
Stock Position:  0.005186757358211596
Bond Position:  [-4.8367325]


portfolio before change:  [-4.29075154]
curr_Stock_Price:  105.38098463952409
curr_Factors:  [ 1.05380985e+02 -5.52937480e-02 -9.35721916e-01]
mat_Sqrt:  [[39.1173673   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120528 -0.02522117 -0.06862272]
Stock Position:  -0.001205282183742132
Bond Position:  [-4.16373771]


portfolio before change:  [-4.28833343]
curr_Stock_Price:  102.9428807061887
curr_Factors:  [102.94288071  -0.20412067  -0.92110926]
mat_Sqrt:  [[33.41297681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.002085    0.00708202 -0.23325345]
Stock Position:  0.002084995201730194
Bond Position:  [-4.50296884]


portfolio before change:  [-4.29512249]
curr_Stock_Price:  99.95671006767026
curr_Factors:  [ 9.99567101e+01 -3.09642307e-02 -9.36060773e-01]
mat_Sqrt:  [[38.00478941  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221707 -0.01217362  0.10420447]
Stock Position:  -0.002217074938892357
Bond Position:  [-4.07351097]


portfolio before change:  [-4.29365936]
curr_Stock_Price:  99.06709347898287
curr_Factors:  [ 9.90670935e+01 -8.88604450e-02 -9.45632901e-01]
mat_Sqrt:  [[35.20907938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00035935 0.00176776 0.01164568]
Stock Position:  0.0003593520334824486
Bond Position:  [-4.32925933]


portfolio before change:  [-4.294783]
curr_Stock_Price:  97.44628188143339
curr_Factors:  [97.44628188  0.15936599 -0.97704139]
mat_Sqrt:  [[43.01831144  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104322  0.01761498  0.01014555]
Stock Position:  -0.0010432189281771433
Bond Position:  [-4.19312519]


portfolio before change:  [-4.29525308]
curr_Stock_Price:  97.3944302654263
curr_Factors:  [ 9.73944303e+01  5.11126726e-02 -9.72380337e-01]
mat_Sqrt:  [[38.7643636   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380839 -0.02206487 -0.22768926]
Stock Position:  -0.0038083868916560046
Bond Position:  [-3.92433741]


portfolio before change:  [-4.29251783]
curr_Stock_Price:  96.54740033813819
curr_Factors:  [96.54740034  0.19416393 -0.9982585 ]
mat_Sqrt:  [[43.20427763  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04634105 0.3655156  0.41999218]
Stock Position:  0.046341052628148416
Bond Position:  [-8.76662599]


portfolio before change:  [-4.13894392]
curr_Stock_Price:  99.88504151076019
curr_Factors:  [ 9.98850415e+01  7.87281056e-02 -1.02002484e+00]
mat_Sqrt:  [[38.9673144   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112892 -0.00518308 -0.03394988]
Stock Position:  -0.001128922058306276
Bond Position:  [-4.0261815]


portfolio before change:  [-4.14189101]
curr_Stock_Price:  102.04974326287682
curr_Factors:  [ 1.02049743e+02 -5.91073449e-02 -1.03726751e+00]
mat_Sqrt:  [[34.09277616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.81241572e-04 -4.34927157e-03 -3.23510152e-01]
Stock Position:  0.0002812415722586029
Bond Position:  [-4.17059164]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.14256743]
Stock Price:  101.49838771915563
PL:  [-5.64095515]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-2.58401800e-03 -9.99818362e-02  6.91701889e-02]
 [ 1.04183275e+00  2.27587345e-01  2.89801666e-01]
 [ 1.18079077e-01  2.23890336e-01  4.07351930e-02]
 [ 8.55025967e-02  5.30633356e-01  5.19159492e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-1.59299891e-01  1.79848489e-01 -2.15354265e-01]
 [-4.15040816e-02 -5.97122990e-02 -3.73315193e-02]
 [ 3.81849734e-01 -1.24907009e-01 -4.03612982e-01]
 [ 2.94955897e-02  4.86142590e-02 -4.40803087e-02]
 [-5.61101087e-01  2.27027997e-01 -1.76904365e-01]
 [ 3.61581350e-01  7.48391193e-01 -1.15687482e-01]
 [ 1.83014104e-04  3.47032717e-02 -6.30890397e-02]
 [ 5.60923910e-02 -1.21795006e-02  4.17151319e-02]
 [ 1.25125615e+00 -2.42140444e+00  2.09781158e+00]
 [ 1.96118811e-02 -9.93048182e-02  4.96289593e-02]
 [ 1.69945601e-01 -1.11737827e-01  3.07097004e-02]
 [-3.18921746e-01 -5.69164401e-01  2.64444576e-02]
 [-2.56521328e-01 -1.69504998e+00 -2.05152700e-01]
 [-6.84943901e-03  3.84851838e-02  1.54276167e-01]
 [ 4.08912896e-01 -6.23202815e-01  3.20698407e-01]
 [ 8.17132392e-02  1.10774491e-01 -2.45532678e-01]
 [-4.42689874e-01 -4.62550877e-02 -2.52932662e-01]
 [ 4.19344923e-01  4.18562812e-01  3.72562823e-01]
 [ 1.75958882e-01  2.02392585e-02  1.64219038e-01]
 [-1.06099427e-01 -3.25832196e-01  1.18301401e-01]
 [ 1.61535086e-01 -6.03854387e-02 -1.86290949e-01]
 [ 9.02391223e-01 -2.45527257e-02  5.49289168e-01]
 [-6.01533408e-02  5.97072692e-02  1.07091268e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 6.62133161e-01 -3.25265662e-01 -1.50041113e-01]
 [-1.32336909e-02 -1.12548179e-01 -1.46308513e-03]
 [-9.44578208e-02 -8.77799408e-03  1.68973454e-02]
 [-4.52448303e-02  2.64229088e-01 -3.92295153e-01]
 [ 6.75590237e-01  1.69968515e-01  2.40881197e-01]
 [ 3.33144841e-02  8.84910631e-02 -5.24242988e-02]
 [-8.67500260e-02  5.99099619e-02 -1.99812830e-04]
 [ 2.08802431e+00  1.55288940e+00  2.00355350e-01]
 [-1.07706064e-01  4.08840455e-03 -2.01568833e-03]
 [ 4.45392091e-02 -2.44555588e-02 -1.01081572e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.69559688]
curr_Stock_Price:  99.90281551882948
curr_Factors:  [99.90281552 -0.96670442 -1.0186729 ]
mat_Sqrt:  [[13.71953246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064677 -0.032269    0.1973233 ]
Stock Position:  -0.0006467727080530462
Bond Position:  [1.76021129]


portfolio before change:  [1.69549979]
curr_Stock_Price:  100.39313944178535
curr_Factors:  [100.39313944  -0.77763804  -1.02204777]
mat_Sqrt:  [[16.60008908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06912278 0.0734535  0.82672349]
Stock Position:  0.06912278205534765
Bond Position:  [-5.24395331]


portfolio before change:  [1.77521485]
curr_Stock_Price:  101.55586169376238
curr_Factors:  [101.55586169  -0.76764773  -1.04174733]
mat_Sqrt:  [[16.63009403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01034844 0.0722603  0.11620617]
Stock Position:  0.010348440389130933
Bond Position:  [0.72427007]


portfolio before change:  [1.77700362]
curr_Stock_Price:  101.71996673586018
curr_Factors:  [101.71996674  -0.5738781   -1.0517289 ]
mat_Sqrt:  [[20.0176946   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01497628 0.17126118 1.48101752]
Stock Position:  0.014976283249650809
Bond Position:  [0.25361659]


portfolio before change:  [1.78310059]
curr_Stock_Price:  102.12495778586369
curr_Factors:  [102.12495779  -0.48970369  -1.08523385]
mat_Sqrt:  [[21.14195805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277392 -0.01106097 -0.05874131]
Stock Position:  -0.002773915301827241
Bond Position:  [2.06638657]


portfolio before change:  [1.77753857]
curr_Stock_Price:  104.22319514897207
curr_Factors:  [104.22319515  -0.67398192  -1.10836377]
mat_Sqrt:  [[17.53482691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0094981   0.05804585 -0.61434577]
Stock Position:  -0.0094980964207346
Bond Position:  [2.76746053]


portfolio before change:  [1.77185667]
curr_Stock_Price:  104.85783372780374
curr_Factors:  [104.85783373  -0.40744737  -1.12254854]
mat_Sqrt:  [[22.70555383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270036 -0.01927206 -0.10649643]
Stock Position:  -0.002700355540241924
Bond Position:  [2.0550101]


portfolio before change:  [1.76643062]
curr_Stock_Price:  106.96234977606652
curr_Factors:  [106.96234978  -0.76020993  -1.10556181]
mat_Sqrt:  [[16.55528115  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01654856 -0.04031356 -1.15139549]
Stock Position:  0.016548558723323642
Bond Position:  [-0.00364211]


portfolio before change:  [1.76296272]
curr_Stock_Price:  106.75281860426676
curr_Factors:  [106.7528186   -0.65093315  -1.08414508]
mat_Sqrt:  [[18.82974546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00161559  0.01569018 -0.12574885]
Stock Position:  0.001615586283122705
Bond Position:  [1.59049433]


portfolio before change:  [1.76222865]
curr_Stock_Price:  106.17538608448176
curr_Factors:  [106.17538608  -0.63233914  -1.07493949]
mat_Sqrt:  [[19.25582631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02860795  0.07327297 -0.50465891]
Stock Position:  -0.02860794623414348
Bond Position:  [4.79968839]


portfolio before change:  [1.76963377]
curr_Stock_Price:  105.93751091096091
curr_Factors:  [105.93751091  -0.67926768  -1.04873843]
mat_Sqrt:  [[18.8185539   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.026077    0.24154222 -0.33002419]
Stock Position:  0.026077001283392284
Bond Position:  [-0.99289883]


portfolio before change:  [1.77781587]
curr_Stock_Price:  106.25603749446682
curr_Factors:  [106.25603749  -0.59077687  -1.0486233 ]
mat_Sqrt:  [[20.62391776  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027207  0.01120043 -0.17997547]
Stock Position:  -0.00027207277428748384
Bond Position:  [1.80672525]


portfolio before change:  [1.77765653]
curr_Stock_Price:  107.67180333854597
curr_Factors:  [107.67180334  -0.4131307   -1.05735722]
mat_Sqrt:  [[24.74441524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00251052 -0.00393092  0.11900166]
Stock Position:  0.0025105190756355028
Bond Position:  [1.50734442]


portfolio before change:  [1.77753559]
curr_Stock_Price:  107.54857211141753
curr_Factors:  [107.54857211  -0.30024852  -1.08479877]
mat_Sqrt:  [[26.9206942   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04402572 -0.78150492  5.98447252]
Stock Position:  0.044025723218952845
Bond Position:  [-2.95736808]


portfolio before change:  [1.74421592]
curr_Stock_Price:  106.8001465090218
curr_Factors:  [106.80014651  -0.4024215   -1.07271006]
mat_Sqrt:  [[24.43038715  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00038771 -0.03205049  0.14157761]
Stock Position:  0.00038770727642559015
Bond Position:  [1.70280872]


portfolio before change:  [1.74399393]
curr_Stock_Price:  105.67854680915181
curr_Factors:  [105.67854681  -0.36754187  -1.07834989]
mat_Sqrt:  [[24.8910958   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00616308 -0.03606323  0.08760623]
Stock Position:  0.0061630795700015045
Bond Position:  [1.09268864]


portfolio before change:  [1.75402517]
curr_Stock_Price:  107.28401730975655
curr_Factors:  [107.28401731  -0.53248698  -1.10961185]
mat_Sqrt:  [[20.7673253   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02069135 -0.18369702  0.07543868]
Stock Position:  -0.020691349740409745
Bond Position:  [3.97387629]


portfolio before change:  [1.80084073]
curr_Stock_Price:  105.04545857666969
curr_Factors:  [105.04545858  -0.68245932  -1.11737327]
mat_Sqrt:  [[17.3668046   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03710519 -0.54707503 -0.58524355]
Stock Position:  -0.037105189525158615
Bond Position:  [5.69857238]


portfolio before change:  [1.74963051]
curr_Stock_Price:  106.4447935553385
curr_Factors:  [106.44479356  -0.93827477  -1.11150211]
mat_Sqrt:  [[13.70621812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00237103 0.01242104 0.44010696]
Stock Position:  0.002371026541131881
Bond Position:  [1.49724708]


portfolio before change:  [1.75084903]
curr_Stock_Price:  106.8797741892785
curr_Factors:  [106.87977419  -1.08612384  -1.11504456]
mat_Sqrt:  [[11.82878775  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02934911 -0.20113784  0.91486329]
Stock Position:  0.02934911417460857
Bond Position:  [-1.38597767]


portfolio before change:  [1.75059471]
curr_Stock_Price:  106.87701212654783
curr_Factors:  [106.87701213  -0.94637885  -1.13510924]
mat_Sqrt:  [[13.33231331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00406575  0.03575231 -0.70043639]
Stock Position:  0.0040657489963842755
Bond Position:  [1.3160596]


portfolio before change:  [1.75296863]
curr_Stock_Price:  107.42043123964174
curr_Factors:  [107.42043124  -1.0070203   -1.15691538]
mat_Sqrt:  [[12.33961383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04082472 -0.01492877 -0.72154648]
Stock Position:  -0.040824723073745385
Bond Position:  [6.13837799]


portfolio before change:  [1.75720787]
curr_Stock_Price:  107.33538727099702
curr_Factors:  [107.33538727  -1.33270847  -1.14516296]
mat_Sqrt:  [[ 9.00776483  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06448134 0.13509057 1.06281803]
Stock Position:  0.06448134223582355
Bond Position:  [-5.16392197]


portfolio before change:  [1.75036819]
curr_Stock_Price:  107.23932616718054
curr_Factors:  [107.23932617  -1.27480829  -1.10758578]
mat_Sqrt:  [[ 9.90132868  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.021574   0.00653219 0.46847121]
Stock Position:  0.02157400093360376
Bond Position:  [-0.56321313]


portfolio before change:  [1.75475985]
curr_Stock_Price:  107.44615236395332
curr_Factors:  [107.44615236  -1.42604087  -1.11318952]
mat_Sqrt:  [[ 8.48041528  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01750639 -0.10516189  0.33748097]
Stock Position:  -0.0175063918791912
Bond Position:  [3.6357543]


portfolio before change:  [1.75201748]
curr_Stock_Price:  107.62876395582994
curr_Factors:  [107.62876396  -1.66726583  -1.14815229]
mat_Sqrt:  [[ 6.44477556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01725157 -0.01948932 -0.53143622]
Stock Position:  0.01725156725895332
Bond Position:  [-0.10474738]


portfolio before change:  [1.75684123]
curr_Stock_Price:  107.90913489915162
curr_Factors:  [107.9091349   -1.65819127  -1.14736876]
mat_Sqrt:  [[ 6.5255778   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.15469934 -0.00792436  1.5669691 ]
Stock Position:  0.15469934338106278
Bond Position:  [-14.93663109]


portfolio before change:  [1.83303672]
curr_Stock_Price:  108.4137439748544
curr_Factors:  [108.41374397  -1.72663695  -1.16828971]
mat_Sqrt:  [[ 5.99561403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435414  0.01927044  0.30550158]
Stock Position:  -0.004354138181388078
Bond Position:  [2.30508515]


portfolio before change:  [1.83275781]
curr_Stock_Price:  108.54397919479457
curr_Factors:  [108.54397919  -1.56400848  -1.16086932]
mat_Sqrt:  [[ 7.11551511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483162 -0.02600141 -0.03673698]
Stock Position:  -0.004831619242351048
Bond Position:  [2.35720099]


portfolio before change:  [1.83235404]
curr_Stock_Price:  108.68853647579024
curr_Factors:  [108.68853648  -1.86934632  -1.14843681]
mat_Sqrt:  [[ 5.31590464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10630581 -0.10497904 -0.42802553]
Stock Position:  0.10630581448125734
Bond Position:  [-9.72186936]


portfolio before change:  [1.83525777]
curr_Stock_Price:  108.72728358456168
curr_Factors:  [108.72728358  -1.88762775  -1.10150368]
mat_Sqrt:  [[ 5.47236746  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.006671   -0.03632477 -0.00417377]
Stock Position:  -0.006670996234853682
Bond Position:  [2.56057707]


portfolio before change:  [1.83732689]
curr_Stock_Price:  108.46509932294612
curr_Factors:  [108.46509932  -2.03904981  -1.10316089]
mat_Sqrt:  [[ 4.68430591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01981093 -0.00283309  0.04820342]
Stock Position:  -0.01981093184195944
Bond Position:  [3.98612158]


portfolio before change:  [1.84213679]
curr_Stock_Price:  108.24746185691829
curr_Factors:  [108.24746186  -1.97510085  -1.1289859 ]
mat_Sqrt:  [[ 4.85657361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01469888  0.08527957 -1.11910888]
Stock Position:  -0.014698882805596978
Bond Position:  [3.43325355]


portfolio before change:  [1.84355316]
curr_Stock_Price:  108.18030148224558
curr_Factors:  [108.18030148  -2.18006426  -1.13913246]
mat_Sqrt:  [[ 3.91416715  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.19402712 0.0548571  0.68716701]
Stock Position:  0.19402712115127635
Bond Position:  [-19.14635931]


portfolio before change:  [1.78288821]
curr_Stock_Price:  107.87997492204659
curr_Factors:  [107.87997492  -1.95206039  -1.1450675 ]
mat_Sqrt:  [[ 4.87388512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00834582  0.02856037 -0.14955193]
Stock Position:  0.008345822797347243
Bond Position:  [0.88254106]


portfolio before change:  [1.78583759]
curr_Stock_Price:  108.22015098822716
curr_Factors:  [108.22015099  -1.88273591  -1.14295633]
mat_Sqrt:  [[ 5.25129832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01419873  0.01933586 -0.00057001]
Stock Position:  -0.01419872540530138
Bond Position:  [3.32242579]


portfolio before change:  [1.7838198]
curr_Stock_Price:  108.39151272126384
curr_Factors:  [108.39151272  -2.26735019  -1.14839628]
mat_Sqrt:  [[ 3.56086437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.68688488 0.5011929  0.57155805]
Stock Position:  0.6868848806043337
Bond Position:  [-72.66867148]


portfolio before change:  [1.80748042]
curr_Stock_Price:  108.43918413679006
curr_Factors:  [108.43918414  -2.01653616  -1.12265133]
mat_Sqrt:  [[ 4.69736638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02283896  0.00131953 -0.0057502 ]
Stock Position:  -0.02283896214022883
Bond Position:  [4.28411884]


portfolio before change:  [1.79913591]
curr_Stock_Price:  108.82799589034721
curr_Factors:  [108.82799589  -1.96796867  -1.1137844 ]
mat_Sqrt:  [[ 4.99289324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00378819 -0.007893   -0.28835759]
Stock Position:  0.0037881942978520286
Bond Position:  [1.38687432]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.8001904]
Stock Price:  109.06059013795462
PL:  [-7.26039974]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-3.90752274e-02 -4.51443612e-02  2.82512597e-01]
 [ 9.78639875e-01  2.19571349e-01  2.62037199e-01]
 [-1.19670769e-01 -1.94014233e-02  3.54311798e-02]
 [ 1.81118750e-01  9.10278242e-01  1.07221244e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.69491351e-02  1.44453483e-01 -6.96264219e-02]
 [-3.64499578e-02 -9.20244186e-02 -1.59209891e-02]
 [ 1.53353637e-01  9.93593518e-02 -1.40864592e-01]
 [ 5.03588236e-02  2.60368682e-02 -4.06502257e-02]
 [-2.69385989e-01  4.36515801e-02 -7.64272774e-02]
 [ 5.22040651e-01  1.05898914e+00 -1.69986866e-01]
 [ 2.30070486e-04  3.70000185e-02 -6.15512329e-02]
 [ 5.39059052e-02 -1.14072240e-02  4.13133433e-02]
 [ 1.45453456e+00 -2.79998947e+00  2.37062490e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.50326103e-01 -7.79534575e-02  1.61552760e-02]
 [-1.58542237e-01 -2.21133403e-01 -3.10089567e-02]
 [-2.66088289e-01 -1.75226856e+00 -2.06141314e-01]
 [ 8.51124392e-04  3.59824892e-02  6.59722255e-02]
 [ 1.67251870e-01 -1.93449132e-01  2.22541336e-01]
 [ 4.32829435e-02 -2.78111671e-02  1.00257031e-01]
 [ 1.40314121e-01 -5.35301732e-02 -1.44678954e-02]
 [ 3.19008908e-01  1.37438866e-01  1.93130615e-01]
 [-1.75767954e-01  3.02794911e-02  4.55544847e-02]
 [-2.27500990e-02 -1.49283324e-01  5.24015013e-02]
 [ 5.03727435e-02 -3.83178045e-03  2.02507137e-01]
 [ 2.68607204e-01 -9.25600545e-02  1.10545958e-01]
 [-8.26536203e-02  4.59148810e-02  1.16643557e-01]
 [ 1.68484679e-02 -4.93918673e-02  4.10985625e-02]
 [-3.29050308e-02  8.28772014e-02  1.82327824e-02]
 [ 4.80117418e-02 -1.11274028e-02 -7.92603851e-02]
 [-2.91264785e-02  1.18840749e-02 -4.84113122e-02]
 [-6.68579957e-02 -6.84806999e-03  4.99293756e-02]
 [-3.10481064e-02 -2.71093095e-02 -6.91050543e-03]
 [-9.79876154e-02  4.88920292e-02  3.91606876e-02]
 [-1.12143533e-01 -6.39056905e-02 -7.49929792e-02]
 [ 1.07891568e+00  7.27879642e-01  1.23321668e-01]
 [ 3.25848155e-03 -3.84076742e-02  4.05689221e-02]
 [ 3.13946274e-02 -1.50216622e-02 -4.55460059e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.9995558]
curr_Stock_Price:  99.39856907389287
curr_Factors:  [99.39856907 -0.74452434 -1.01626161]
mat_Sqrt:  [[17.08757803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.48782331e-04 -1.45702799e-02  8.05929803e-01]
Stock Position:  0.0005487823308323331
Bond Position:  [-2.05410398]


portfolio before change:  [-1.99921991]
curr_Stock_Price:  100.47853632463259
curr_Factors:  [100.47853632  -0.5871395   -1.06048739]
mat_Sqrt:  [[19.34274189  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0556771  0.07086635 0.74751919]
Stock Position:  0.05567710173488458
Bond Position:  [-7.5935736]


portfolio before change:  [-1.97314855]
curr_Stock_Price:  100.96384576364015
curr_Factors:  [100.96384576  -0.43347933  -1.08388437]
mat_Sqrt:  [[22.14028472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00525733 -0.00626178  0.10107529]
Stock Position:  -0.005257326618575605
Bond Position:  [-1.44234863]


portfolio before change:  [-1.96704551]
curr_Stock_Price:  99.76868662072982
curr_Factors:  [99.76868662 -0.32765926 -1.0397856 ]
mat_Sqrt:  [[25.41677792  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02304749 0.29379104 3.05872363]
Stock Position:  0.023047491182448566
Bond Position:  [-4.26646343]


portfolio before change:  [-1.94646028]
curr_Stock_Price:  100.68499315362308
curr_Factors:  [100.68499315  -0.1051686   -1.0643078 ]
mat_Sqrt:  [[31.26565971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187573 -0.01106097 -0.05874131]
Stock Position:  -0.001875732080394475
Bond Position:  [-1.75760221]


portfolio before change:  [-1.9509837]
curr_Stock_Price:  102.97940454973336
curr_Factors:  [102.97940455  -0.1762414   -1.07703636]
mat_Sqrt:  [[29.4075442   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00279599  0.04662216 -0.1986248 ]
Stock Position:  0.002795988149112588
Bond Position:  [-2.23891289]


portfolio before change:  [-1.94753579]
curr_Stock_Price:  104.3126696058527
curr_Factors:  [104.31266961  -0.50658066  -1.11064431]
mat_Sqrt:  [[20.70070694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282523 -0.02970075 -0.04541815]
Stock Position:  -0.002825228241810989
Bond Position:  [-1.65282869]


portfolio before change:  [-1.94597317]
curr_Stock_Price:  103.68644303701274
curr_Factors:  [103.68644304  -0.18884225  -1.09830637]
mat_Sqrt:  [[28.62334833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00506165  0.03206809 -0.40184747]
Stock Position:  0.005061651546823592
Bond Position:  [-2.47079781]


portfolio before change:  [-1.94554718]
curr_Stock_Price:  103.83162399977333
curr_Factors:  [ 1.03831624e+02 -4.90480498e-02 -1.12126439e+00]
mat_Sqrt:  [[32.21583649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147058  0.00840336 -0.11596378]
Stock Position:  0.0014705775070296531
Bond Position:  [-2.09823963]


portfolio before change:  [-1.94619222]
curr_Stock_Price:  103.57135597241854
curr_Factors:  [103.57135597  -0.11225903  -1.11421332]
mat_Sqrt:  [[30.38012021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0090874   0.01408849 -0.21802575]
Stock Position:  -0.009087399847273218
Bond Position:  [-1.0049979]


portfolio before change:  [-1.9632]
curr_Stock_Price:  105.42910898649691
curr_Factors:  [ 1.05429109e+02 -7.57519910e-02 -1.10350494e+00]
mat_Sqrt:  [[32.42020508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02169966  0.34178727 -0.48492521]
Stock Position:  0.021699661634241182
Bond Position:  [-4.25097599]


portfolio before change:  [-1.9638823]
curr_Stock_Price:  105.42215509471293
curr_Factors:  [105.42215509  -0.26053326  -1.12128281]
mat_Sqrt:  [[26.47383115  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018061  0.0119417  -0.17558853]
Stock Position:  -0.0001806094902774487
Bond Position:  [-1.94484206]


portfolio before change:  [-1.96388407]
curr_Stock_Price:  104.08584105388054
curr_Factors:  [104.08584105  -0.32232237  -1.12861961]
mat_Sqrt:  [[24.39245775  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00246021 -0.00368167  0.11785547]
Stock Position:  0.0024602058093760627
Bond Position:  [-2.21995666]


portfolio before change:  [-1.96342647]
curr_Stock_Price:  104.38464285908393
curr_Factors:  [104.38464286  -0.51653268  -1.13672344]
mat_Sqrt:  [[19.9818915   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06840648 -0.90369271  6.762733  ]
Stock Position:  0.06840648113252489
Bond Position:  [-9.10401257]


portfolio before change:  [-1.96748456]
curr_Stock_Price:  104.34195662927372
curr_Factors:  [104.34195663  -0.72753372  -1.14938565]
mat_Sqrt:  [[15.97067437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135682 -0.03053791  0.10625201]
Stock Position:  -0.0013568226599405292
Bond Position:  [-1.82591103]


portfolio before change:  [-1.96621629]
curr_Stock_Price:  103.23899546916573
curr_Factors:  [103.23899547  -0.569784    -1.14872212]
mat_Sqrt:  [[18.51424654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00743814 -0.02515937  0.04608651]
Stock Position:  0.007438142392941324
Bond Position:  [-2.73412264]


portfolio before change:  [-1.96973783]
curr_Stock_Price:  102.81150216307341
curr_Factors:  [102.81150216  -0.76437177  -1.17573371]
mat_Sqrt:  [[14.77286077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01421597 -0.0713705  -0.08845992]
Stock Position:  -0.014215972400945747
Bond Position:  [-0.50817235]


portfolio before change:  [-1.97858721]
curr_Stock_Price:  103.4295291437189
curr_Factors:  [103.42952914  -0.5463325   -1.20614679]
mat_Sqrt:  [[17.92885128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0371383  -0.56554224 -0.58806379]
Stock Position:  -0.03713829849332276
Bond Position:  [1.86260952]


portfolio before change:  [-1.93557654]
curr_Stock_Price:  102.27767700893074
curr_Factors:  [102.27767701  -0.47188747  -1.21160803]
mat_Sqrt:  [[18.99538269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00114041 0.0116133  0.1882004 ]
Stock Position:  0.0011404110004763603
Bond Position:  [-2.05221513]


portfolio before change:  [-1.93695769]
curr_Stock_Price:  101.29153804291775
curr_Factors:  [101.29153804  -0.58592101  -1.18283962]
mat_Sqrt:  [[17.2746869   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01002567 -0.06243544  0.63484849]
Stock Position:  0.010025668907889864
Bond Position:  [-2.95247311]


portfolio before change:  [-1.93820565]
curr_Stock_Price:  101.20387467707837
curr_Factors:  [101.20387468  -0.72462015  -1.18235309]
mat_Sqrt:  [[15.03173764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00386322 -0.00897602  0.2860054 ]
Stock Position:  0.0038632189386606083
Bond Position:  [-2.32917838]


portfolio before change:  [-1.93648289]
curr_Stock_Price:  101.72518231073113
curr_Factors:  [101.72518231  -0.78362115  -1.17271682]
mat_Sqrt:  [[14.38141753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00879149 -0.01727679 -0.04127288]
Stock Position:  0.008791488945862125
Bond Position:  [-2.83079871]


portfolio before change:  [-1.93733278]
curr_Stock_Price:  101.6687626143805
curr_Factors:  [101.66876261  -0.61080642  -1.19160821]
mat_Sqrt:  [[16.76520273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02305287 0.0443582  0.55094789]
Stock Position:  0.02305287486284953
Bond Position:  [-4.28109004]


portfolio before change:  [-1.94523372]
curr_Stock_Price:  101.34924618489823
curr_Factors:  [101.34924618  -0.71524315  -1.2005751 ]
mat_Sqrt:  [[14.92076966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01074264  0.00977266  0.12995427]
Stock Position:  -0.010742636774159773
Bond Position:  [-0.85647558]


portfolio before change:  [-1.94912622]
curr_Stock_Price:  101.70162081918622
curr_Factors:  [101.70162082  -0.85335832  -1.220548  ]
mat_Sqrt:  [[12.78326544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332669 -0.04818099  0.1494869 ]
Stock Position:  -0.003326694449171794
Bond Position:  [-1.610796]


portfolio before change:  [-1.9455526]
curr_Stock_Price:  100.56686512174203
curr_Factors:  [100.56686512  -0.86953379  -1.24382209]
mat_Sqrt:  [[12.15167415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00748269 -0.0012367   0.5776965 ]
Stock Position:  0.00748268755203733
Bond Position:  [-2.69806303]


portfolio before change:  [-1.94264155]
curr_Stock_Price:  101.00097761336546
curr_Factors:  [101.00097761  -0.78191841  -1.22219691]
mat_Sqrt:  [[13.61285912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02000157 -0.02987363  0.31535685]
Stock Position:  0.020001570453628013
Bond Position:  [-3.96281972]


portfolio before change:  [-1.96503633]
curr_Stock_Price:  99.90609385929741
curr_Factors:  [99.90609386 -0.86361665 -1.23878307]
mat_Sqrt:  [[12.20482011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00405344  0.01481896  0.3327516 ]
Stock Position:  -0.004053440988038552
Bond Position:  [-1.56007287]


portfolio before change:  [-1.96213354]
curr_Stock_Price:  99.14185195657801
curr_Factors:  [99.14185196 -0.74831589 -1.20592489]
mat_Sqrt:  [[14.04562411  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107903 -0.01594116  0.11724276]
Stock Position:  0.001079026752287836
Bond Position:  [-2.06911025]


portfolio before change:  [-1.96270846]
curr_Stock_Price:  98.84874755716297
curr_Factors:  [98.84874756 -0.95247656 -1.19663461]
mat_Sqrt:  [[11.52455192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106434  0.0267485   0.05201305]
Stock Position:  -0.0010643400137533817
Bond Position:  [-1.85749978]


portfolio before change:  [-1.96185694]
curr_Stock_Price:  97.83053405605831
curr_Factors:  [97.83053406 -0.82049056 -1.19900495]
mat_Sqrt:  [[12.98430383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0022767  -0.00359135 -0.22610782]
Stock Position:  0.002276703644799147
Bond Position:  [-2.18458807]


portfolio before change:  [-1.9617092]
curr_Stock_Price:  98.01537666782504
curr_Factors:  [98.01537667 -0.78080976 -1.21577794]
mat_Sqrt:  [[13.31028004  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00274844  0.00383557 -0.138104  ]
Stock Position:  -0.0027484447709771515
Bond Position:  [-1.69231935]


portfolio before change:  [-1.96089688]
curr_Stock_Price:  97.64285001493842
curr_Factors:  [97.64285001 -0.76911901 -1.22200071]
mat_Sqrt:  [[13.33239406  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435511 -0.00221021  0.14243461]
Stock Position:  -0.004355111378634206
Bond Position:  [-1.53565139]


portfolio before change:  [-1.95920823]
curr_Stock_Price:  97.2110306752565
curr_Factors:  [97.21103068 -1.04113333 -1.20255439]
mat_Sqrt:  [[10.31084715  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036847  -0.00874949 -0.01971375]
Stock Position:  -0.0036846993716795388
Bond Position:  [-1.6010148]


portfolio before change:  [-1.9577995]
curr_Stock_Price:  96.77439586740556
curr_Factors:  [96.77439587 -0.73840268 -1.22229305]
mat_Sqrt:  [[13.62200806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00587387  0.01577983  0.11171454]
Stock Position:  -0.0058738718624345414
Bond Position:  [-1.3893591]


portfolio before change:  [-1.95608721]
curr_Stock_Price:  96.45331767200015
curr_Factors:  [96.45331767 -0.61294446 -1.21750455]
mat_Sqrt:  [[15.46547514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0090845  -0.02062547 -0.2139341 ]
Stock Position:  -0.009084499790955587
Bond Position:  [-1.07985706]


portfolio before change:  [-1.96086774]
curr_Stock_Price:  96.96468840567171
curr_Factors:  [96.96468841 -0.69220099 -1.20829374]
mat_Sqrt:  [[14.49570145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08641641 0.23492214 0.35180239]
Stock Position:  0.08641640567669151
Bond Position:  [-10.34020759]


portfolio before change:  [-2.00182623]
curr_Stock_Price:  96.50567974800691
curr_Factors:  [96.50567975 -0.47501128 -1.19428066]
mat_Sqrt:  [[18.17977893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0002035  -0.01239602  0.11573184]
Stock Position:  0.00020350326774845658
Bond Position:  [-2.02146545]


portfolio before change:  [-2.00227679]
curr_Stock_Price:  95.53339947138413
curr_Factors:  [95.53339947 -0.77897863 -1.14616459]
mat_Sqrt:  [[13.93401112  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00136582 -0.00484822 -0.12993008]
Stock Position:  0.0013658166177805604
Bond Position:  [-2.1327579]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.00277851]
Stock Price:  95.36125899876154
PL:  [-2.00277851]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 9.63254078e-02 -5.84259944e-02 -1.05253544e-01]
 [ 1.13211545e+00  2.41049615e-01  3.30195403e-01]
 [-2.59518813e-01 -1.52411314e-01  3.73664167e-02]
 [ 1.66585902e-01  1.35889229e+00  1.08290419e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 2.12974964e-02  6.85832461e-03  3.24230149e-02]
 [-9.30831761e-02  1.14016125e-01  9.63647991e-03]
 [-5.86324761e-02  1.29447172e-01 -1.01493756e-03]
 [ 2.48080852e-02  5.36868965e-02 -4.48509720e-02]
 [-1.53564639e-01 -8.27633436e-02 -5.25196914e-02]
 [ 8.50738633e-01  1.63230996e+00 -2.97073755e-01]
 [-1.11992284e-04  2.99747396e-02 -4.29410189e-02]
 [-3.71090921e-01 -5.34905056e-03 -7.94225683e-01]
 [ 1.98533998e+00 -3.41783813e+00  2.88866667e+00]
 [ 1.81703083e-02 -3.87574560e-02 -9.05805071e-03]
 [ 4.22129195e-02  1.26461874e-01 -7.22885217e-02]
 [ 1.17152565e-02  1.14489486e-01 -1.23328584e-01]
 [-2.85076446e-01 -1.82719594e+00 -1.94146289e-01]
 [ 2.10095575e-02 -9.95285984e-02  2.23189865e-01]
 [ 2.52176221e-02  3.81248144e-01  3.27392360e-01]
 [ 2.57681856e-02  3.99172405e-03  9.85283895e-03]
 [ 1.17654307e-01 -5.18816091e-02  4.71189698e-02]
 [ 1.40562905e-02 -9.62089382e-02 -7.46421205e-02]
 [-1.29259564e-01 -3.57947552e-03  5.92551874e-02]
 [ 8.88064554e-02  1.75952901e-02 -3.17200224e-02]
 [ 2.67929097e-02 -4.57163279e-02  2.62047608e-01]
 [ 3.67264256e-02 -1.13514168e-01  1.94353401e-02]
 [-1.22519538e-01  9.76201784e-02  1.69876282e-01]
 [ 2.42302470e-02 -2.27816854e-02  8.99527307e-02]
 [-7.30301157e-02  9.57072092e-02  4.14290869e-03]
 [ 5.28041766e-02 -1.30773608e-02 -8.03130092e-02]
 [-6.95968343e-02  8.71429471e-03 -3.64044713e-02]
 [-7.87367494e-02 -5.66328957e-04  5.84113909e-02]
 [-3.22336330e-02 -2.81697263e-02 -7.61997796e-03]
 [-8.96143193e-02 -5.57011681e-03  5.90270153e-02]
 [-1.16813282e-01 -6.78809021e-02 -7.92908345e-02]
 [ 2.30027863e+00  1.47579979e+00  1.67693397e-01]
 [ 2.47409396e-02 -1.01770424e-01  8.99231543e-03]
 [ 3.10873437e-02 -1.46020650e-02 -3.65278518e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.4016788]
curr_Stock_Price:  100.54501498567532
curr_Factors:  [100.54501499  -1.10917388  -1.00238268]
mat_Sqrt:  [[12.17091362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00516925 -0.01885691 -0.30025906]
Stock Position:  0.005169247265795815
Bond Position:  [5.88193676]


portfolio before change:  [6.40114719]
curr_Stock_Price:  100.29993117286745
curr_Factors:  [100.29993117  -1.02079349  -0.95801184]
mat_Sqrt:  [[13.8648891   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09006349 0.07779843 0.94195558]
Stock Position:  0.09006349352158442
Bond Position:  [-2.63221501]


portfolio before change:  [6.35757115]
curr_Stock_Price:  99.81974780687165
curr_Factors:  [99.81974781 -1.25582094 -0.96706446]
mat_Sqrt:  [[10.81009742  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02617944 -0.04919054  0.10659599]
Stock Position:  -0.02617943612715499
Bond Position:  [8.97079587]


portfolio before change:  [6.35214756]
curr_Stock_Price:  100.06975390635596
curr_Factors:  [100.06975391  -1.2501046   -0.98710324]
mat_Sqrt:  [[10.68306362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06224951 0.4385806  3.08922423]
Stock Position:  0.062249514348703336
Bond Position:  [0.12285397]


portfolio before change:  [6.33414022]
curr_Stock_Price:  99.78023046653625
curr_Factors:  [99.78023047 -1.35924673 -0.99079499]
mat_Sqrt:  [[ 9.51555999  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00616317 -0.01106097 -0.05874131]
Stock Position:  -0.0061631686383051484
Bond Position:  [6.94910261]


portfolio before change:  [6.33816817]
curr_Stock_Price:  99.26762698423961
curr_Factors:  [99.26762698 -1.41564612 -1.0096004 ]
mat_Sqrt:  [[ 8.78084801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0033386  0.00221351 0.09249384]
Stock Position:  0.00333860308717912
Bond Position:  [6.00675297]


portfolio before change:  [6.33965953]
curr_Stock_Price:  99.4894156415962
curr_Factors:  [99.48941564 -1.24332247 -1.01655286]
mat_Sqrt:  [[10.38306312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00653398  0.03679855  0.02749019]
Stock Position:  -0.0065339768280965795
Bond Position:  [6.98972107]


portfolio before change:  [6.34117045]
curr_Stock_Price:  99.3919019467571
curr_Factors:  [99.39190195 -1.09033214 -1.04224028]
mat_Sqrt:  [[11.78111968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275155  0.0417789  -0.00289533]
Stock Position:  -0.002751551378561624
Bond Position:  [6.61465238]


portfolio before change:  [6.34157356]
curr_Stock_Price:  99.54591455179639
curr_Factors:  [99.54591455 -0.9911057  -1.03183427]
mat_Sqrt:  [[13.1665434   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202116  0.01732737 -0.12794734]
Stock Position:  0.0020211615110007743
Bond Position:  [6.14037519]


portfolio before change:  [6.34464198]
curr_Stock_Price:  100.68428187800863
curr_Factors:  [100.68428188  -1.20569041  -1.04229272]
mat_Sqrt:  [[10.63346996  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01703857 -0.02671175 -0.14982406]
Stock Position:  -0.017038574744742317
Bond Position:  [8.06015864]


portfolio before change:  [6.35148851]
curr_Stock_Price:  100.34159180055973
curr_Factors:  [100.3415918   -1.17333754  -1.03354012]
mat_Sqrt:  [[11.04196061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10172945  0.52682577 -0.84746873]
Stock Position:  0.10172945015380896
Bond Position:  [-3.85620645]


portfolio before change:  [6.28490816]
curr_Stock_Price:  99.69184590901693
curr_Factors:  [99.69184591 -1.21607151 -1.03845974]
mat_Sqrt:  [[10.45993907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026374  0.00967431 -0.12249877]
Stock Position:  -0.00026374178080514234
Bond Position:  [6.31120107]


portfolio before change:  [6.28580365]
curr_Stock_Price:  99.28789321587824
curr_Factors:  [99.28789322 -1.35644997 -1.0501512 ]
mat_Sqrt:  [[ 8.9479322   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.97125032e-02 -1.72639865e-03 -2.26570481e+00]
Stock Position:  -0.05971250317700082
Bond Position:  [12.21453229]


portfolio before change:  [6.31984987]
curr_Stock_Price:  98.74329528043457
curr_Factors:  [98.74329528 -1.35350602 -1.03728503]
mat_Sqrt:  [[ 9.04066252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.20765329 -1.10310251  8.24056196]
Stock Position:  0.20765328948327533
Bond Position:  [-14.18452021]


portfolio before change:  [6.17515741]
curr_Stock_Price:  98.05503607769671
curr_Factors:  [98.05503608 -1.56743121 -1.03982558]
mat_Sqrt:  [[ 7.23023922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00116317 -0.01250892 -0.0258401 ]
Stock Position:  0.0011631715936026817
Bond Position:  [6.06110258]


portfolio before change:  [6.17630463]
curr_Stock_Price:  98.3899263921297
curr_Factors:  [98.38992639 -1.70925175 -1.02797286]
mat_Sqrt:  [[ 6.37072841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00836184  0.04081539 -0.20621903]
Stock Position:  0.008361839529241985
Bond Position:  [5.35358385]


portfolio before change:  [6.17349129]
curr_Stock_Price:  97.97344133249784
curr_Factors:  [97.97344133 -1.57102571 -1.01060816]
mat_Sqrt:  [[ 7.41172024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013372   0.03695132 -0.35182212]
Stock Position:  0.0013372041868664147
Bond Position:  [6.04248079]


portfolio before change:  [6.17384425]
curr_Stock_Price:  97.67252102290374
curr_Factors:  [97.67252102 -1.35218088 -1.00154601]
mat_Sqrt:  [[ 9.28029536  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07517877 -0.58972496 -0.55384532]
Stock Position:  -0.07517877118438061
Bond Position:  [13.51674436]


portfolio before change:  [6.1925222]
curr_Stock_Price:  97.44654963968318
curr_Factors:  [97.44654964 -1.02194038 -1.01282937]
mat_Sqrt:  [[12.73729455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00363121 -0.03212272  0.63669856]
Stock Position:  0.0036312112882917326
Bond Position:  [5.83867319]


portfolio before change:  [6.1906807]
curr_Stock_Price:  96.73841742272987
curr_Factors:  [96.73841742 -1.11501516 -1.00714862]
mat_Sqrt:  [[11.58657186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01466079 0.12304731 0.93395927]
Stock Position:  0.014660786756120673
Bond Position:  [4.77241939]


portfolio before change:  [6.19653898]
curr_Stock_Price:  97.09731300897738
curr_Factors:  [97.09731301 -1.0806287  -0.97999142]
mat_Sqrt:  [[12.36776606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00231199 0.00128832 0.02810741]
Stock Position:  0.002311993536957445
Bond Position:  [5.97205062]


portfolio before change:  [6.19681847]
curr_Stock_Price:  96.89529525835775
curr_Factors:  [96.89529526 -0.86789541 -0.97775152]
mat_Sqrt:  [[15.30200759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00762528 -0.01674472  0.13441731]
Stock Position:  0.007625282926845796
Bond Position:  [5.45796443]


portfolio before change:  [6.19948602]
curr_Stock_Price:  97.15564745870859
curr_Factors:  [97.15564746 -0.81777983 -0.97304219]
mat_Sqrt:  [[16.20779475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00128448 -0.0310513  -0.21293319]
Stock Position:  -0.0012844767713305158
Bond Position:  [6.32428019]


portfolio before change:  [6.20091713]
curr_Stock_Price:  96.65698305947643
curr_Factors:  [96.65698306 -0.79027231 -0.9613445 ]
mat_Sqrt:  [[16.76933033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00703038 -0.00115527  0.16903856]
Stock Position:  -0.007030382498764333
Bond Position:  [6.88045269]


portfolio before change:  [6.2016812]
curr_Stock_Price:  96.67064428756196
curr_Factors:  [96.67064429 -0.8099131  -0.96781468]
mat_Sqrt:  [[16.33944313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00525864  0.00567886 -0.09048839]
Stock Position:  0.005258640443508338
Bond Position:  [5.69332504]


portfolio before change:  [6.20958127]
curr_Stock_Price:  98.03760746488895
curr_Factors:  [98.03760746 -1.03285803 -0.97472426]
mat_Sqrt:  [[13.16772642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00538828 -0.01475488  0.74754889]
Stock Position:  0.005388276231220174
Bond Position:  [5.68132756]


portfolio before change:  [6.21353401]
curr_Stock_Price:  98.6393817682001
curr_Factors:  [98.63938177 -0.85601818 -0.99144957]
mat_Sqrt:  [[15.54910129  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112692 -0.03663654  0.05544362]
Stock Position:  0.0011269246373156448
Bond Position:  [6.10237486]


portfolio before change:  [6.21430404]
curr_Stock_Price:  98.64576230680859
curr_Factors:  [98.64576231 -0.71937543 -0.97792435]
mat_Sqrt:  [[18.06968173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00375862  0.03150678  0.48460975]
Stock Position:  -0.0037586191413465034
Bond Position:  [6.5850759]


portfolio before change:  [6.21744246]
curr_Stock_Price:  98.02978359636785
curr_Factors:  [98.0297836  -0.82597958 -0.95707515]
mat_Sqrt:  [[16.4811387   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00230212 -0.00735276  0.2566101 ]
Stock Position:  0.002302115154727497
Bond Position:  [5.99176661]


portfolio before change:  [6.21813857]
curr_Stock_Price:  98.0068019600061
curr_Factors:  [98.00680196 -1.00089568 -0.96823156]
mat_Sqrt:  [[13.67965435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00384866  0.03088937  0.01181857]
Stock Position:  -0.003848656873649893
Bond Position:  [6.59533312]


portfolio before change:  [6.21869376]
curr_Stock_Price:  98.07677022756732
curr_Factors:  [98.07677023 -1.28519558 -0.94101793]
mat_Sqrt:  [[10.58604931  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0031873  -0.0042207  -0.22911066]
Stock Position:  0.0031873030394953196
Bond Position:  [5.90609337]


portfolio before change:  [6.21756024]
curr_Stock_Price:  97.48949582064715
curr_Factors:  [97.48949582 -1.20243387 -0.94684664]
mat_Sqrt:  [[11.36415529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00662162  0.00281253 -0.10385182]
Stock Position:  -0.0066216155948864005
Bond Position:  [6.86309821]


portfolio before change:  [6.22161857]
curr_Stock_Price:  97.0061714238951
curr_Factors:  [97.00617142 -1.04294285 -0.93008523]
mat_Sqrt:  [[13.48727335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00496239 -0.00018278  0.16663144]
Stock Position:  -0.004962394833883439
Bond Position:  [6.7030015]


portfolio before change:  [6.22160566]
curr_Stock_Price:  97.17762902634638
curr_Factors:  [97.17762903 -1.00096986 -0.92961856]
mat_Sqrt:  [[14.0968605   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280482 -0.00909174 -0.02173768]
Stock Position:  -0.0028048213848121057
Bond Position:  [6.49417155]


portfolio before change:  [6.22048904]
curr_Stock_Price:  97.86517326029512
curr_Factors:  [97.86517326 -1.26565194 -0.94807156]
mat_Sqrt:  [[10.6959723   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00735814 -0.00179775  0.16838764]
Stock Position:  -0.007358141307560111
Bond Position:  [6.94059482]


portfolio before change:  [6.21817616]
curr_Stock_Price:  98.29741722358465
curr_Factors:  [98.29741722 -1.107726   -0.91737822]
mat_Sqrt:  [[12.97330176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01131975 -0.02190847 -0.22619468]
Stock Position:  -0.011319754162467114
Bond Position:  [7.33087876]


portfolio before change:  [6.2191624]
curr_Stock_Price:  98.29124894214709
curr_Factors:  [98.29124894 -1.17191799 -0.89727994]
mat_Sqrt:  [[12.41291011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.21233983 0.47631233 0.47838258]
Stock Position:  0.21233983405509202
Bond Position:  [-14.65198509]


portfolio before change:  [5.9950993]
curr_Stock_Price:  97.24466486993944
curr_Factors:  [97.24466487 -1.08911836 -0.90175566]
mat_Sqrt:  [[13.28128769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00043691 -0.03284626  0.02565257]
Stock Position:  0.0004369069871390975
Bond Position:  [5.95261242]


portfolio before change:  [5.99551771]
curr_Stock_Price:  96.49917953594053
curr_Factors:  [96.49917954 -1.09642956 -0.87166619]
mat_Sqrt:  [[13.48312308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00153158 -0.0047128  -0.10420379]
Stock Position:  0.0015315808518765706
Bond Position:  [5.84772142]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.99618256]
Stock Price:  96.4559774797198
PL:  [5.99618256]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.86486412e-02 -5.81425855e-02  1.12686898e-01]
 [ 1.07417504e+00  2.24892438e-01  2.97029903e-01]
 [ 7.39373860e-02  1.70225700e-01  3.54982559e-02]
 [ 4.25664417e-02  3.25655215e-01  2.74266468e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.05472321e-02  1.14648505e-02  3.54352864e-03]
 [-3.21888650e-02 -1.19266517e-01  2.13006366e-03]
 [ 6.03496251e-02  1.51805725e-01 -4.94796694e-02]
 [ 2.18411733e-02  5.68975747e-02 -4.53387561e-02]
 [-1.42752392e-01 -7.60494074e-02 -4.50462261e-02]
 [ 8.09785509e-01  1.56010066e+00 -2.81435795e-01]
 [-2.00053459e-04  3.23802406e-02 -5.83533024e-02]
 [-2.21169252e-01 -5.87699476e-03 -4.50869134e-01]
 [ 1.69514143e+00 -3.22102454e+00  2.70309222e+00]
 [ 4.82302366e-03 -9.21264945e-02  3.57131478e-02]
 [ 1.17878346e-01 -2.69810530e-02 -1.46199659e-02]
 [-7.85068457e-02 -4.29716678e-02 -5.40775222e-02]
 [-2.67153964e-01 -1.73698292e+00 -1.98427456e-01]
 [-9.08472521e-04  3.53588911e-02  8.62344311e-02]
 [ 1.99658338e-01 -1.06488180e-01  3.24807882e-01]
 [ 4.06660778e-02 -4.02702048e-02  9.86297152e-02]
 [ 1.24824899e-01 -5.18163341e-02 -8.70454611e-03]
 [ 1.52216447e-01  1.97956505e-01  1.73169790e-01]
 [-1.17521305e-01  3.09049139e-02  1.17227580e-01]
 [-7.43716865e-02 -2.11004033e-01  8.51924742e-02]
 [ 1.01125110e-01 -2.72143414e-02 -9.75648827e-02]
 [ 5.96055723e-01 -5.41021939e-02  3.40109109e-01]
 [-4.04058641e-02  2.17919892e-02  8.20138677e-02]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 2.60578076e-01 -9.05009365e-02 -5.71581503e-03]
 [-1.83527414e-02 -6.18152104e-02 -3.58406807e-02]
 [ 2.06812570e-02  5.81968869e-03 -4.03071562e-02]
 [-3.76655942e-02  3.33185623e-02 -1.01198272e-01]
 [ 4.53123670e-01  7.17657001e-02  1.09872194e-01]
 [-5.55135874e-02  6.91165116e-02 -1.49924674e-02]
 [ 1.86122526e-02  3.15708149e-02  6.95274674e-02]
 [ 2.49041669e+00  1.70130105e+00  1.95866583e-01]
 [-7.53623691e-02 -5.93300706e-02 -2.96404722e-02]
 [ 3.52582959e-02 -1.33107903e-02 -1.11721361e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.88030053]
curr_Stock_Price:  100.33740527335229
curr_Factors:  [100.33740527  -0.95350702  -1.01693396]
mat_Sqrt:  [[13.98657001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00212936 -0.01876544  0.32146435]
Stock Position:  0.002129360688183206
Bond Position:  [4.66664601]


portfolio before change:  [4.88108945]
curr_Stock_Price:  100.43393751831546
curr_Factors:  [100.43393752  -0.82585197  -1.05015783]
mat_Sqrt:  [[15.38649793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07673689 0.07258372 0.84734364]
Stock Position:  0.07673688978997437
Bond Position:  [-2.82589854]


portfolio before change:  [4.95524585]
curr_Stock_Price:  101.40491327198157
curr_Factors:  [101.40491327  -0.81267768  -1.01390028]
mat_Sqrt:  [[16.32248463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00710251 0.05494011 0.10126664]
Stock Position:  0.007102510146566663
Bond Position:  [4.23501643]


portfolio before change:  [4.96503443]
curr_Stock_Price:  102.70856056091594
curr_Factors:  [102.70856056  -0.85364356  -1.01029204]
mat_Sqrt:  [[15.92610937  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01036191 0.10510477 0.78240589]
Stock Position:  0.010361911924499822
Bond Position:  [3.90077737]


portfolio before change:  [4.95281883]
curr_Stock_Price:  101.48260687808192
curr_Factors:  [101.48260688  -0.84290283  -1.04163873]
mat_Sqrt:  [[15.41507393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380446 -0.01106097 -0.05874131]
Stock Position:  -0.0038044579738809965
Bond Position:  [5.33890515]


portfolio before change:  [4.95286738]
curr_Stock_Price:  101.64527292577485
curr_Factors:  [101.64527293  -0.73528235  -1.04855707]
mat_Sqrt:  [[17.07558426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00372525 0.00370026 0.0101087 ]
Stock Position:  0.0037252490862138836
Bond Position:  [4.57421342]


portfolio before change:  [4.9565584]
curr_Stock_Price:  102.48258718696287
curr_Factors:  [102.48258719  -0.76573281  -1.02737759]
mat_Sqrt:  [[17.05737242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328886 -0.0384931   0.00607648]
Stock Position:  -0.003288856107387682
Bond Position:  [5.29360888]


portfolio before change:  [4.96030168]
curr_Stock_Price:  101.54562261826878
curr_Factors:  [101.54562262  -0.67931173  -1.00197375]
mat_Sqrt:  [[18.90114865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00429798  0.04899509 -0.14115172]
Stock Position:  0.004297984492933835
Bond Position:  [4.52386017]


portfolio before change:  [4.95682998]
curr_Stock_Price:  100.60629275200007
curr_Factors:  [100.60629275  -0.7559026   -1.01176653]
mat_Sqrt:  [[17.1765603   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140893  0.01836361 -0.12933885]
Stock Position:  0.001408932105112716
Bond Position:  [4.81508254]


portfolio before change:  [4.95763813]
curr_Stock_Price:  100.7526701648397
curr_Factors:  [100.75267016  -0.95632569  -0.99550112]
mat_Sqrt:  [[14.30833015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01170444 -0.02454484 -0.12850434]
Stock Position:  -0.01170443597679302
Bond Position:  [6.13689131]


portfolio before change:  [4.95348102]
curr_Stock_Price:  101.17338896723025
curr_Factors:  [101.17338897  -0.99828419  -1.02223983]
mat_Sqrt:  [[13.41417182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07982542  0.50352032 -0.80285799]
Stock Position:  0.07982541874358116
Bond Position:  [-3.12272712]


portfolio before change:  [4.96933845]
curr_Stock_Price:  101.37693067671226
curr_Factors:  [101.37693068  -1.06747363  -1.01598423]
mat_Sqrt:  [[12.62132321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043591  0.01045068 -0.16646573]
Stock Position:  -0.000435911702909143
Bond Position:  [5.01352985]


portfolio before change:  [4.96984178]
curr_Stock_Price:  101.66002356369387
curr_Factors:  [101.66002356  -1.09218939  -1.01786715]
mat_Sqrt:  [[12.32435772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02551063 -0.00189679 -1.28620414]
Stock Position:  -0.025510632870060293
Bond Position:  [7.56325332]


portfolio before change:  [4.9850606]
curr_Stock_Price:  101.10051751636043
curr_Factors:  [101.10051752  -0.94517252  -1.00459241]
mat_Sqrt:  [[14.38736394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11047326 -1.0395812   7.71116972]
Stock Position:  0.11047325626330506
Bond Position:  [-6.18384278]


portfolio before change:  [4.9876846]
curr_Stock_Price:  101.1312672529524
curr_Factors:  [101.13126725  -1.17538277  -0.99168707]
mat_Sqrt:  [[11.58081105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057788 -0.0297337   0.10187967]
Stock Position:  -0.0005778785681601009
Bond Position:  [5.04612619]


portfolio before change:  [4.98839335]
curr_Stock_Price:  100.99638180287461
curr_Factors:  [100.9963818   -1.3590904   -0.97582594]
mat_Sqrt:  [[ 9.77832654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01118664 -0.0087081  -0.04170669]
Stock Position:  0.011186635385339828
Bond Position:  [3.85858365]


portfolio before change:  [4.98702197]
curr_Stock_Price:  100.83067190002996
curr_Factors:  [100.8306719   -1.37965393  -1.00251332]
mat_Sqrt:  [[ 9.31173414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01055839 -0.01386905 -0.15426812]
Stock Position:  -0.010558390857972786
Bond Position:  [6.05163161]


portfolio before change:  [4.98085921]
curr_Stock_Price:  101.48600477919923
curr_Factors:  [101.48600478  -1.29855715  -0.99080261]
mat_Sqrt:  [[10.2837105   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06439485 -0.56060883 -0.5660583 ]
Stock Position:  -0.06439484590110049
Bond Position:  [11.51603484]


portfolio before change:  [4.98887087]
curr_Stock_Price:  101.38394591047991
curr_Factors:  [101.38394591  -0.95321887  -1.00989233]
mat_Sqrt:  [[14.23642121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00167961 0.01141203 0.24600283]
Stock Position:  0.0016796117583095902
Bond Position:  [4.8185852]


portfolio before change:  [4.98933521]
curr_Stock_Price:  101.30177452288821
curr_Factors:  [101.30177452  -0.90296113  -1.00475003]
mat_Sqrt:  [[15.03517978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01624341 -0.03436891  0.92658648]
Stock Position:  0.016243414735947096
Bond Position:  [3.34384847]


portfolio before change:  [4.98142127]
curr_Stock_Price:  100.78883114108595
curr_Factors:  [100.78883114  -0.82606     -1.01176113]
mat_Sqrt:  [[16.04193802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00327758 -0.01299715  0.28136312]
Stock Position:  0.0032775754983406483
Bond Position:  [4.65107826]


portfolio before change:  [4.98296725]
curr_Stock_Price:  101.08312383106231
curr_Factors:  [101.08312383  -1.03356866  -1.02586526]
mat_Sqrt:  [[12.89074051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00872495 -0.01672365 -0.02483165]
Stock Position:  0.008724954649913276
Bond Position:  [4.10102158]


portfolio before change:  [4.99812412]
curr_Stock_Price:  102.76155219414787
curr_Factors:  [102.76155219  -0.9690246   -1.05059973]
mat_Sqrt:  [[13.63700343  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01671718 0.06389019 0.49400521]
Stock Position:  0.016717183206183137
Bond Position:  [3.28024043]


portfolio before change:  [5.01623366]
curr_Stock_Price:  103.82031180721931
curr_Factors:  [103.82031181  -1.19544137  -1.07736635]
mat_Sqrt:  [[10.69582963  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00816055  0.00997452  0.33441766]
Stock Position:  -0.008160553171536591
Bond Position:  [5.86346483]


portfolio before change:  [5.01316609]
curr_Stock_Price:  104.28603350871431
curr_Factors:  [104.28603351  -1.35042662  -1.06448655]
mat_Sqrt:  [[ 9.32057464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01073462 -0.06810126  0.24303042]
Stock Position:  -0.010734623911360583
Bond Position:  [6.13263744]


portfolio before change:  [5.01128516]
curr_Stock_Price:  104.53267032132108
curr_Factors:  [104.53267032  -1.33166339  -1.04574931]
mat_Sqrt:  [[ 9.69962242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00779975 -0.00878339 -0.27832545]
Stock Position:  0.007799752864022758
Bond Position:  [4.19595617]


portfolio before change:  [5.01196412]
curr_Stock_Price:  104.5524690343623
curr_Factors:  [104.55246903  -1.30287489  -1.00324664]
mat_Sqrt:  [[10.41833786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06281584 -0.01746141  0.97023662]
Stock Position:  0.06281583959768655
Bond Position:  [-1.55558701]


portfolio before change:  [5.0212111]
curr_Stock_Price:  104.70277259940995
curr_Factors:  [104.7027726   -1.13756514  -0.95765626]
mat_Sqrt:  [[12.88294312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149163  0.00703333  0.23396274]
Stock Position:  -0.0014916298335323132
Bond Position:  [5.17738888]


portfolio before change:  [5.02174831]
curr_Stock_Price:  104.77652331482828
curr_Factors:  [104.77652331  -1.15844615  -0.93866121]
mat_Sqrt:  [[12.8677268   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267176 -0.02600141 -0.03673698]
Stock Position:  -0.0026717585989633054
Bond Position:  [5.30168588]


portfolio before change:  [5.02152879]
curr_Stock_Price:  105.10674351810316
curr_Factors:  [105.10674352  -0.87446642  -0.95641123]
mat_Sqrt:  [[16.84575655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01430259 -0.02920905 -0.01630563]
Stock Position:  0.014302587898484959
Bond Position:  [3.51823035]


portfolio before change:  [5.00054108]
curr_Stock_Price:  103.60858700388333
curr_Factors:  [103.608587    -1.02809502  -0.93828742]
mat_Sqrt:  [[14.50129228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264022 -0.01995077 -0.10224349]
Stock Position:  -0.002640224468538981
Bond Position:  [5.27409101]


portfolio before change:  [4.99945956]
curr_Stock_Price:  104.26793180514929
curr_Factors:  [104.26793181  -1.12536929  -0.94826689]
mat_Sqrt:  [[13.10937574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104059  0.0018783  -0.1149851 ]
Stock Position:  0.001040593574960537
Bond Position:  [4.89095903]


portfolio before change:  [5.0001282]
curr_Stock_Price:  104.32292339230091
curr_Factors:  [104.32292339  -1.46786411  -0.92770297]
mat_Sqrt:  [[ 9.5060082   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00541989  0.01075352 -0.2886905 ]
Stock Position:  -0.00541988613333997
Bond Position:  [5.56554656]


portfolio before change:  [5.0006182]
curr_Stock_Price:  104.36088299963384
curr_Factors:  [104.360883    -1.39232073  -0.93645168]
mat_Sqrt:  [[10.16634256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04821797 0.02316228 0.31343479]
Stock Position:  0.04821796502124322
Bond Position:  [-0.03145121]


portfolio before change:  [5.02302602]
curr_Stock_Price:  104.82568382190965
curr_Factors:  [104.82568382  -1.43610436  -0.94986008]
mat_Sqrt:  [[ 9.64398469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0046107   0.02230726 -0.04276934]
Stock Position:  -0.004610704450257389
Bond Position:  [5.50634626]


portfolio before change:  [5.02190298]
curr_Stock_Price:  105.21854640896301
curr_Factors:  [105.21854641  -1.41888731  -0.95154252]
mat_Sqrt:  [[ 9.8316792   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00399208 0.01018944 0.19834251]
Stock Position:  0.0039920803255261645
Bond Position:  [4.60186209]


portfolio before change:  [5.02014844]
curr_Stock_Price:  104.63494020157054
curr_Factors:  [104.6349402   -1.19463661  -0.9531836 ]
mat_Sqrt:  [[12.21490981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.23558704 0.54909255 0.55875284]
Stock Position:  0.23558703679180393
Bond Position:  [-19.63048706]


portfolio before change:  [4.81769164]
curr_Stock_Price:  103.78598501267166
curr_Factors:  [103.78598501  -1.48401807  -0.94201565]
mat_Sqrt:  [[ 9.17330117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01019517 -0.0191487  -0.08455602]
Stock Position:  -0.01019517437346749
Bond Position:  [5.87580786]


portfolio before change:  [4.82347499]
curr_Stock_Price:  103.29076814003663
curr_Factors:  [103.29076814  -1.40914647  -0.91441086]
mat_Sqrt:  [[10.11470866  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00096258 -0.00429604 -0.31870995]
Stock Position:  0.000962579853824258
Bond Position:  [4.72404937]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.82446373]
Stock Price:  103.70445065171815
PL:  [1.12001308]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-2.15181301e-02 -9.13010608e-02  1.60141919e-01]
 [ 7.85400003e-01  2.10569513e-01  2.12056397e-01]
 [-2.72571558e-01 -1.64426096e-01  3.77471466e-02]
 [ 1.66842572e-01  1.05319363e+00  1.02751375e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.64572905e-02 -4.91496321e-03  1.83542260e-02]
 [-3.72551415e-02 -8.65069079e-02 -2.15818519e-02]
 [ 1.51538828e-01  8.71714073e-02 -1.37860817e-01]
 [ 1.84196285e-02  6.06002391e-02 -4.59012855e-02]
 [-3.82678998e-01  1.79371310e-02 -1.42099503e-01]
 [ 6.90038843e-01  1.34731932e+00 -2.36124152e-01]
 [-7.17502053e-05  3.10872016e-02 -5.86531272e-02]
 [-1.89556681e-02 -1.89085923e-02 -1.32271484e-01]
 [ 1.62019224e+00 -3.13876891e+00  2.67016972e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.34352454e-01 -8.10927616e-02  2.13717026e-02]
 [-1.80359213e-01 -2.65894141e-01 -1.99637101e-02]
 [-2.55866679e-01 -1.68425762e+00 -2.02600871e-01]
 [-6.58258963e-03  3.83447606e-02  1.51219948e-01]
 [ 2.93360277e-01 -4.57079151e-01  2.51819644e-01]
 [ 5.81081772e-02  1.43954732e-01 -8.45347189e-02]
 [-1.94922891e-01 -5.02770102e-02 -1.62463137e-01]
 [ 4.02607082e-01  3.74178983e-01  3.55229547e-01]
 [ 1.28015229e-01  1.09704511e-01  2.09052990e-01]
 [-1.21225673e-01 -3.85441845e-01  1.34679599e-01]
 [ 1.92520776e-01 -6.45830638e-02 -2.19398200e-01]
 [ 6.17870862e-01  9.52762435e-03  4.08422328e-01]
 [-5.82842349e-02  6.12079355e-02  1.05066139e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 3.49419280e-01 -1.21843737e-01 -6.38203396e-02]
 [-2.32725793e-02 -9.70516418e-02 -1.11427094e-02]
 [-7.07289334e-02 -2.88724366e-02  3.62236119e-02]
 [-3.84061282e-02  5.60315421e-02 -1.28424236e-01]
 [ 5.77581549e-01  1.15545360e-01  1.79172941e-01]
 [ 5.26779359e-02  1.71470093e-01 -9.34251578e-02]
 [-1.70877831e-02  4.11730044e-02  4.59016838e-02]
 [ 2.40981315e+00  1.73149704e+00  2.08449569e-01]
 [-1.24012370e-01  2.76338098e-02 -3.78109214e-03]
 [ 3.75512099e-02 -1.26635425e-02 -1.66180468e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.22714835]
curr_Stock_Price:  99.50397303038935
curr_Factors:  [99.50397303 -0.91108963 -0.9980676 ]
mat_Sqrt:  [[14.74700989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050628 -0.02946729  0.45684032]
Stock Position:  -0.0005062754290963875
Bond Position:  [-1.17677193]


portfolio before change:  [-1.22743677]
curr_Stock_Price:  99.78311167082614
curr_Factors:  [99.78311167 -0.73589983 -0.99784155]
mat_Sqrt:  [[17.62392869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04945936 0.06796102 0.60493788]
Stock Position:  0.04945935556966993
Bond Position:  [-6.16264517]


portfolio before change:  [-1.22088437]
curr_Stock_Price:  99.93116817453345
curr_Factors:  [99.93116817 -0.721539   -1.01246197]
mat_Sqrt:  [[17.64549772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01691252 -0.05306829  0.1076821 ]
Stock Position:  -0.01691251757589884
Bond Position:  [0.46920326]


portfolio before change:  [-1.22261112]
curr_Stock_Price:  100.03673487021138
curr_Factors:  [100.03673487  -0.69114445  -1.03015067]
mat_Sqrt:  [[17.89000805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03306679 0.33991678 2.93121074]
Stock Position:  0.03306679271822666
Bond Position:  [-4.53050509]


portfolio before change:  [-1.16324699]
curr_Stock_Price:  101.84914157113485
curr_Factors:  [101.84914157  -1.06916853  -1.04898946]
mat_Sqrt:  [[12.24765796  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00478834 -0.01106097 -0.05874131]
Stock Position:  -0.0047883441174032485
Bond Position:  [-0.67555825]


portfolio before change:  [-1.16342295]
curr_Stock_Price:  101.86825225654951
curr_Factors:  [101.86825226  -0.9720325   -1.04458002]
mat_Sqrt:  [[13.55923439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00510357 -0.0015863   0.0523595 ]
Stock Position:  0.00510357492133711
Bond Position:  [-1.68331521]


portfolio before change:  [-1.16369015]
curr_Stock_Price:  101.85712817071126
curr_Factors:  [101.85712817  -0.83917662  -1.05216281]
mat_Sqrt:  [[15.3671435   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0038601  -0.02791998 -0.06156702]
Stock Position:  -0.003860097172847842
Bond Position:  [-0.77051174]


portfolio before change:  [-1.16801562]
curr_Stock_Price:  102.9527369007464
curr_Factors:  [102.9527369   -0.87877348  -1.06389005]
mat_Sqrt:  [[14.7553612   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00956885  0.02813445 -0.39327854]
Stock Position:  0.009568853878230971
Bond Position:  [-2.15315532]


portfolio before change:  [-1.17761791]
curr_Stock_Price:  101.97737209810116
curr_Factors:  [101.9773721   -0.8125035   -1.06281891]
mat_Sqrt:  [[15.63369529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137012  0.01955864 -0.13094359]
Stock Position:  0.0013701200828740824
Bond Position:  [-1.31733915]


portfolio before change:  [-1.17626749]
curr_Stock_Price:  103.08318525111328
curr_Factors:  [103.08318525  -0.88652573  -1.05928141]
mat_Sqrt:  [[14.72768633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02770452  0.00578918 -0.40537033]
Stock Position:  -0.027704523747067767
Bond Position:  [1.67960306]


portfolio before change:  [-1.16474724]
curr_Stock_Price:  102.67493848362803
curr_Factors:  [102.67493848  -0.85870276  -1.08166789]
mat_Sqrt:  [[14.74932637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06216288  0.43484544 -0.67359648]
Stock Position:  0.062162880098133685
Bond Position:  [-7.54731713]


portfolio before change:  [-1.10486543]
curr_Stock_Price:  103.65342090774026
curr_Factors:  [103.65342091  -0.93128159  -1.08586934]
mat_Sqrt:  [[13.78942377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041326  0.01003335 -0.16732105]
Stock Position:  -0.00041326028583344744
Bond Position:  [-1.06202959]


portfolio before change:  [-1.10488848]
curr_Stock_Price:  103.38794449536577
curr_Factors:  [103.3879445   -0.90347663  -1.08195777]
mat_Sqrt:  [[14.19733068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00350877 -0.00610272 -0.37733373]
Stock Position:  -0.0035087702864819176
Bond Position:  [-0.74212394]


portfolio before change:  [-1.10467148]
curr_Stock_Price:  103.29965974561347
curr_Factors:  [103.29965975  -1.13027077  -1.10313964]
mat_Sqrt:  [[11.06983318  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.13772022 -1.01303331  7.61725098]
Stock Position:  0.13772021759143216
Bond Position:  [-15.3311231]


portfolio before change:  [-1.15323438]
curr_Stock_Price:  102.96095575565255
curr_Factors:  [102.96095576  -1.2390829   -1.07831134]
mat_Sqrt:  [[10.14474269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213602 -0.03053791  0.10625201]
Stock Position:  -0.0021360199609447537
Bond Position:  [-0.93330772]


portfolio before change:  [-1.15419028]
curr_Stock_Price:  103.35384918075287
curr_Factors:  [103.35384918  -1.13911557  -1.06994266]
mat_Sqrt:  [[11.34866706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01076443 -0.02617258  0.06096752]
Stock Position:  0.010764431026428566
Bond Position:  [-2.26673566]


portfolio before change:  [-1.15214042]
curr_Stock_Price:  103.57060219124736
curr_Factors:  [103.57060219  -1.07835614  -1.0700952 ]
mat_Sqrt:  [[12.08303233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01975578 -0.08581696 -0.05695091]
Stock Position:  -0.019755777870661077
Bond Position:  [0.89397739]


portfolio before change:  [-1.16604971]
curr_Stock_Price:  104.28032094174198
curr_Factors:  [104.28032094  -1.23079897  -1.07061079]
mat_Sqrt:  [[10.4402957   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06139865 -0.54359181 -0.57796389]
Stock Position:  -0.06139864943498078
Bond Position:  [5.23662116]


portfolio before change:  [-1.17610633]
curr_Stock_Price:  104.45477491186269
curr_Factors:  [104.45477491  -1.00743628  -1.06991343]
mat_Sqrt:  [[13.08418825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00245427 0.01237572 0.43138842]
Stock Position:  0.002454271052911272
Bond Position:  [-1.43246666]


portfolio before change:  [-1.17672048]
curr_Stock_Price:  104.2774992501561
curr_Factors:  [104.27749925  -0.86112105  -1.07032275]
mat_Sqrt:  [[15.11385402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01663784 -0.14752166  0.71837135]
Stock Position:  0.016637838021244765
Bond Position:  [-2.91167262]


portfolio before change:  [-1.17108836]
curr_Stock_Price:  104.63788859322372
curr_Factors:  [104.63788859  -0.76875288  -1.0585613 ]
mat_Sqrt:  [[16.83048     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00417322  0.04646119 -0.24115402]
Stock Position:  0.004173216486943003
Bond Position:  [-1.60776492]


portfolio before change:  [-1.16769849]
curr_Stock_Price:  105.49834055161017
curr_Factors:  [105.49834055  -0.77563679  -1.06123714]
mat_Sqrt:  [[16.80743412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01418112 -0.01622684 -0.46346211]
Stock Position:  -0.0141811230336676
Bond Position:  [0.32838645]


portfolio before change:  [-1.17851418]
curr_Stock_Price:  106.26391707162537
curr_Factors:  [106.26391707  -0.65636767  -1.06044031]
mat_Sqrt:  [[19.08910596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02889067 0.12076575 1.01337102]
Stock Position:  0.028890665472382976
Bond Position:  [-4.24854946]


portfolio before change:  [-1.13293627]
curr_Stock_Price:  107.85989992952152
curr_Factors:  [107.85989993  -0.61706875  -1.06928691]
mat_Sqrt:  [[19.97492045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00966619 0.03540698 0.59636999]
Stock Position:  0.009666187759128824
Bond Position:  [-2.17553032]


portfolio before change:  [-1.13706264]
curr_Stock_Price:  107.46114795027518
curr_Factors:  [107.46114795  -0.61322899  -1.04515358]
mat_Sqrt:  [[20.46562803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00842448 -0.12440082  0.38420341]
Stock Position:  -0.008424481361684947
Bond Position:  [-0.2317582]


portfolio before change:  [-1.13864768]
curr_Stock_Price:  107.64585549657475
curr_Factors:  [107.6458555   -0.76873529  -1.06793255]
mat_Sqrt:  [[17.15309933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00784426 -0.02084409 -0.625882  ]
Stock Position:  0.007844258364911299
Bond Position:  [-1.98304958]


portfolio before change:  [-1.13676223]
curr_Stock_Price:  107.91781765948933
curr_Factors:  [107.91781766  -0.71657604  -1.08056604]
mat_Sqrt:  [[17.88974972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03930656 0.00307503 1.16511522]
Stock Position:  0.03930656102382674
Bond Position:  [-5.37864052]


portfolio before change:  [-1.20854584]
curr_Stock_Price:  106.10867355339806
curr_Factors:  [106.10867355  -0.69660983  -1.05122919]
mat_Sqrt:  [[18.47881185  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131738  0.01975478  0.29972445]
Stock Position:  -0.0013173834851031713
Bond Position:  [-1.06876003]


portfolio before change:  [-1.20828342]
curr_Stock_Price:  105.8080592226081
curr_Factors:  [105.80805922  -0.61174237  -1.05399973]
mat_Sqrt:  [[20.00304664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00171871 -0.02600141 -0.03673698]
Stock Position:  -0.0017187111712486595
Bond Position:  [-1.02642993]


portfolio before change:  [-1.21027029]
curr_Stock_Price:  106.88942553801373
curr_Factors:  [106.88942554  -0.6477687   -1.03330851]
mat_Sqrt:  [[19.89995938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01565434 -0.0393249  -0.18206166]
Stock Position:  0.015654341444772207
Bond Position:  [-2.88355385]


portfolio before change:  [-1.20388961]
curr_Stock_Price:  107.32005012728723
curr_Factors:  [107.32005013  -0.7570563   -1.04949494]
mat_Sqrt:  [[17.62404667  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257362 -0.03132328 -0.03178705]
Stock Position:  -0.0025736233921783056
Bond Position:  [-0.92768822]


portfolio before change:  [-1.20419326]
curr_Stock_Price:  107.39297362054381
curr_Factors:  [107.39297362  -1.05711067  -1.05239739]
mat_Sqrt:  [[13.02651235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00531442 -0.00931854  0.10333588]
Stock Position:  -0.005314421782473677
Bond Position:  [-0.6334617]


portfolio before change:  [-1.19998557]
curr_Stock_Price:  106.58632510460548
curr_Factors:  [106.5863251   -1.11668807  -1.01566937]
mat_Sqrt:  [[12.63660522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00420866  0.0180841  -0.3663586 ]
Stock Position:  -0.00420866394944609
Bond Position:  [-0.75139955]


portfolio before change:  [-1.20296395]
curr_Stock_Price:  107.27168452092322
curr_Factors:  [107.27168452  -1.05615829  -1.03147769]
mat_Sqrt:  [[13.29953065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04795212 0.0372921  0.51113053]
Stock Position:  0.04795211851853743
Bond Position:  [-6.34686848]


portfolio before change:  [-1.22634336]
curr_Stock_Price:  106.8006730577831
curr_Factors:  [106.80067306  -1.1722268   -1.00373316]
mat_Sqrt:  [[12.1217853   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00565996  0.05534173 -0.26651597]
Stock Position:  0.0056599576588681234
Bond Position:  [-1.83083064]


portfolio before change:  [-1.22356436]
curr_Stock_Price:  107.33210118160112
curr_Factors:  [107.33210118  -1.36446707  -0.99878248]
mat_Sqrt:  [[10.1014424   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [6.79371504e-05 1.32885300e-02 1.30944727e-01]
Stock Position:  6.793715039265273e-05
Bond Position:  [-1.2308562]


portfolio before change:  [-1.22372217]
curr_Stock_Price:  107.27405377023679
curr_Factors:  [107.27405377  -1.24294015  -1.01997911]
mat_Sqrt:  [[11.16146863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.25138297 0.55883827 0.5946486 ]
Stock Position:  0.2513829667068866
Bond Position:  [-28.19059206]


portfolio before change:  [-1.4184403]
curr_Stock_Price:  106.51348479812859
curr_Factors:  [106.5134848   -1.20511472  -1.00977491]
mat_Sqrt:  [[11.62760445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0102466   0.00891877 -0.0107864 ]
Stock Position:  -0.01024660368531631
Bond Position:  [-0.32703884]


portfolio before change:  [-1.41171422]
curr_Stock_Price:  105.85307454376881
curr_Factors:  [105.85307454  -1.06758106  -1.01508747]
mat_Sqrt:  [[13.18900478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.92197101e-05 -4.08714076e-03 -4.74066620e-01]
Stock Position:  7.921971012182182e-05
Bond Position:  [-1.42009987]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.41190378]
Stock Price:  105.70116215636342
PL:  [-7.11306594]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.20551580e-02 -7.88346384e-02  7.19538142e-02]
 [ 1.01066745e+00  2.24480540e-01  2.88060890e-01]
 [-2.87568985e-01 -1.78230918e-01  3.81846002e-02]
 [ 2.05961073e-01  1.37241805e+00  1.28489004e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 2.30228907e-02  1.86530878e-02  1.77436269e-02]
 [-5.90056761e-02  1.86622872e-02 -5.60005745e-02]
 [-6.00270617e-02  1.15980900e-01  3.92004266e-03]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-3.86145086e-02 -1.13843024e-02  2.69342636e-02]
 [ 8.13744084e-01  1.65251035e+00 -2.61424011e-01]
 [-5.73273976e-04  2.05565832e-02  2.52348226e-02]
 [-3.62475748e-01 -2.68573422e-03 -7.82631706e-01]
 [ 1.78567799e+00 -3.13044037e+00  2.63709673e+00]
 [ 2.93354312e-02 -9.15070900e-02  2.86971704e-02]
 [ 7.34588573e-02  9.94710839e-02 -7.02972282e-02]
 [-3.25490391e-02  4.27222524e-02 -8.50539735e-02]
 [-2.81173903e-01 -1.81301021e+00 -1.97050002e-01]
 [ 1.05180267e-02 -4.03082466e-02  1.70630969e-01]
 [ 1.47279302e-01  7.39251043e-02  3.55224225e-01]
 [ 4.21436824e-02 -3.39457914e-02  9.84639995e-02]
 [ 1.36122795e-01 -5.30693230e-02 -1.28207872e-02]
 [ 8.45514536e-02  1.45723691e-01  1.20936671e-01]
 [-1.75434022e-01  3.00363824e-02  4.56528563e-02]
 [-2.71721015e-02 -1.83976908e-01  6.27984974e-02]
 [ 8.52459820e-02 -1.64892897e-02  1.35738481e-02]
 [ 4.00943196e-01 -3.46658541e-02  2.40092313e-01]
 [-5.88396758e-02  6.07619835e-02  1.05667945e-01]
 [-1.39881538e-02 -7.92848533e-02 -1.06655862e-02]
 [ 1.47103082e-01 -4.78967335e-02  6.52198669e-02]
 [-2.31569383e-02 -6.11700750e-02 -3.49413598e-02]
 [-1.73505564e-02  2.20769762e-02 -5.47659761e-02]
 [-9.95225280e-02 -4.38678700e-02  1.91793706e-02]
 [ 2.85406568e-01  3.87091918e-02  6.56418335e-02]
 [ 4.09693279e-02 -5.88634922e-02  2.21295557e-02]
 [-9.18280534e-02 -2.52396419e-02 -1.07428596e-01]
 [ 1.75900395e+00  1.18021574e+00  1.55023578e-01]
 [-6.04106804e-02 -4.93816741e-02 -3.16537623e-02]
 [ 3.55621652e-02 -1.34302945e-02 -1.15725290e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.74298215]
curr_Stock_Price:  100.18220498721755
curr_Factors:  [100.18220499  -0.97187484  -1.01510721]
mat_Sqrt:  [[13.73584075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00077539 -0.02544377  0.2052642 ]
Stock Position:  0.0007753886983291428
Bond Position:  [3.665302]


portfolio before change:  [3.74328279]
curr_Stock_Price:  99.979020196301
curr_Factors:  [99.9790202  -1.05097322 -0.99352696]
mat_Sqrt:  [[12.94177152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0861775  0.07245078 0.82175754]
Stock Position:  0.08617750127799144
Bond Position:  [-4.87265935]


portfolio before change:  [3.71722157]
curr_Stock_Price:  99.68367514577308
curr_Factors:  [99.68367515 -0.99675206 -1.00251615]
mat_Sqrt:  [[13.50059436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02341792 -0.05752378  0.10893004]
Stock Position:  -0.023417918621331975
Bond Position:  [6.05160576]


portfolio before change:  [3.7288111]
curr_Stock_Price:  99.22107953121778
curr_Factors:  [99.22107953 -0.8585456  -1.01495493]
mat_Sqrt:  [[15.23887846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04911003 0.44294602 3.66543364]
Stock Position:  0.04911003237411683
Bond Position:  [-1.14393933]


portfolio before change:  [3.74768035]
curr_Stock_Price:  99.60821536349802
curr_Factors:  [99.60821536 -0.95211221 -1.02015327]
mat_Sqrt:  [[13.85961429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423143 -0.01106097 -0.05874131]
Stock Position:  -0.004231430955635608
Bond Position:  [4.16916563]


portfolio before change:  [3.74700319]
curr_Stock_Price:  99.891413104292
curr_Factors:  [99.8914131  -0.97865213 -0.99937719]
mat_Sqrt:  [[13.8191375   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00220364 0.00602026 0.05061763]
Stock Position:  0.0022036352833071423
Bond Position:  [3.52687895]


portfolio before change:  [3.7468993]
curr_Stock_Price:  99.64419287121694
curr_Factors:  [99.64419287 -0.91548356 -1.0045215 ]
mat_Sqrt:  [[14.60845846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00456087  0.00602323 -0.15975405]
Stock Position:  -0.004560872886520323
Bond Position:  [4.2013638]


portfolio before change:  [3.75146928]
curr_Stock_Price:  98.75735044779107
curr_Factors:  [98.75735045 -0.83883717 -0.98752729]
mat_Sqrt:  [[15.89971813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223604  0.03743267  0.01118279]
Stock Position:  -0.0022360386507076536
Bond Position:  [3.97229453]


portfolio before change:  [3.75190306]
curr_Stock_Price:  98.78542733097179
curr_Factors:  [98.78542733 -0.97750255 -0.9624954 ]
mat_Sqrt:  [[14.19588515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00366241  0.0064198  -0.11330016]
Stock Position:  0.0036624136360166185
Bond Position:  [3.39010997]


portfolio before change:  [3.75018828]
curr_Stock_Price:  98.20150197975282
curr_Factors:  [98.20150198 -0.83679152 -0.99225373]
mat_Sqrt:  [[15.76790062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224763 -0.00367427  0.07683596]
Stock Position:  -0.002247628708128933
Bond Position:  [3.97090879]


portfolio before change:  [3.75122444]
curr_Stock_Price:  97.9613524423576
curr_Factors:  [97.96135244 -0.74761542 -0.98218096]
mat_Sqrt:  [[17.37055726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06319304  0.53334542 -0.74576994]
Stock Position:  0.06319304428465568
Bond Position:  [-2.43925164]


portfolio before change:  [3.80305989]
curr_Stock_Price:  98.78644925792477
curr_Factors:  [98.78644926 -1.03322334 -0.99114561]
mat_Sqrt:  [[13.04743404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00067246 0.00663461 0.07198792]
Stock Position:  0.0006724584748644234
Bond Position:  [3.73663011]


portfolio before change:  [3.80353881]
curr_Stock_Price:  98.8040146367545
curr_Factors:  [98.80401464 -0.86058647 -0.99113585]
mat_Sqrt:  [[15.50892896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.37081949e-02 -8.66816991e-04 -2.23263041e+00]
Stock Position:  -0.03370819486230064
Bond Position:  [7.13404379]


portfolio before change:  [3.77185044]
curr_Stock_Price:  99.77055071961577
curr_Factors:  [99.77055072 -0.78203493 -1.00584171]
mat_Sqrt:  [[16.69311585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10093829 -1.01034528  7.52290296]
Stock Position:  0.1009382945650892
Bond Position:  [-6.2988188]


portfolio before change:  [3.6986006]
curr_Stock_Price:  99.05266224682704
curr_Factors:  [99.05266225 -0.99580182 -1.0404896 ]
mat_Sqrt:  [[12.92754401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00127746 -0.02953379  0.08186504]
Stock Position:  0.0012774592008364656
Bond Position:  [3.57206486]


portfolio before change:  [3.69866207]
curr_Stock_Price:  98.75123095793384
curr_Factors:  [98.75123096 -1.04122387 -1.01681735]
mat_Sqrt:  [[12.61091425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00629724  0.03210415 -0.20053843]
Stock Position:  0.00629723936663868
Bond Position:  [3.07680193]


portfolio before change:  [3.70142258]
curr_Stock_Price:  99.12852158882303
curr_Factors:  [99.12852159 -0.79766289 -1.04732328]
mat_Sqrt:  [[15.6650331   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262942  0.01378855 -0.24263531]
Stock Position:  -0.0026294209020220746
Bond Position:  [3.96207319]


portfolio before change:  [3.7023842]
curr_Stock_Price:  98.95117130959731
curr_Factors:  [98.95117131 -1.05664476 -1.02960273]
mat_Sqrt:  [[12.28500011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05628618 -0.58514653 -0.56212881]
Stock Position:  -0.05628617990522329
Bond Position:  [9.27196763]


portfolio before change:  [3.69216093]
curr_Stock_Price:  99.15339389442391
curr_Factors:  [99.15339389 -0.94164009 -1.01662094]
mat_Sqrt:  [[13.99089898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00265316 -0.01300943  0.48676266]
Stock Position:  0.0026531562414416907
Bond Position:  [3.42909149]


portfolio before change:  [3.69489134]
curr_Stock_Price:  100.02094243710641
curr_Factors:  [100.02094244  -0.83124624  -1.03708402]
mat_Sqrt:  [[15.44135539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01521104 0.02385922 1.01335584]
Stock Position:  0.015211037903504076
Bond Position:  [2.17346899]


portfolio before change:  [3.70988219]
curr_Stock_Price:  100.98860462771765
curr_Factors:  [100.98860463  -0.81144991  -1.0444153 ]
mat_Sqrt:  [[15.78630005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00350389 -0.01095596  0.28089038]
Stock Position:  0.0035038866787925316
Bond Position:  [3.35602956]


portfolio before change:  [3.71234825]
curr_Stock_Price:  101.57268091388949
curr_Factors:  [101.57268091  -0.92372004  -1.05244448]
mat_Sqrt:  [[14.07795491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00871384 -0.01712805 -0.03657414]
Stock Position:  0.008713838977539518
Bond Position:  [2.82726027]


portfolio before change:  [3.71258858]
curr_Stock_Price:  101.55970082693015
curr_Factors:  [101.55970083  -0.98695153  -1.05479416]
mat_Sqrt:  [[13.18264405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0105429  0.04703212 0.34499866]
Stock Position:  0.010542898037270232
Bond Position:  [2.641855]


portfolio before change:  [3.71125091]
curr_Stock_Price:  101.40149762909213
curr_Factors:  [101.40149763  -0.68940153  -1.03861072]
mat_Sqrt:  [[18.01267373  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00888175  0.0096942   0.13023489]
Stock Position:  -0.008881747569767992
Bond Position:  [4.61187341]


portfolio before change:  [3.7073276]
curr_Stock_Price:  101.90813499978688
curr_Factors:  [101.908135    -0.65945671  -1.03811673]
mat_Sqrt:  [[18.66216737  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00278143 -0.05937829  0.17914663]
Stock Position:  -0.0027814315457805176
Bond Position:  [3.9907781]


portfolio before change:  [3.70570662]
curr_Stock_Price:  102.67028413048264
curr_Factors:  [102.67028413  -0.50588867  -1.05316514]
mat_Sqrt:  [[21.59515371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0039199  -0.0053219   0.03872241]
Stock Position:  0.003919901247042291
Bond Position:  [3.30324924]


portfolio before change:  [3.71356094]
curr_Stock_Price:  104.56864565085341
curr_Factors:  [104.56864565  -0.62037246  -1.04990777]
mat_Sqrt:  [[19.67922538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02250473 -0.01118836  0.68491654]
Stock Position:  0.022504732147447675
Bond Position:  [1.36027158]


portfolio before change:  [3.7200902]
curr_Stock_Price:  104.85121794427366
curr_Factors:  [104.85121794  -0.41720088  -1.05132948]
mat_Sqrt:  [[24.1434234   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102998  0.01961085  0.30144124]
Stock Position:  -0.0010299827176158288
Bond Position:  [3.82808514]


portfolio before change:  [3.7212427]
curr_Stock_Price:  104.19686992323803
curr_Factors:  [104.19686992  -0.7095137   -1.05666247]
mat_Sqrt:  [[17.81616015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181572 -0.02558908 -0.03042595]
Stock Position:  -0.0018157229247101768
Bond Position:  [3.91043535]


portfolio before change:  [3.72383362]
curr_Stock_Price:  103.03916163488354
curr_Factors:  [103.03916163  -1.03646733  -1.05339741]
mat_Sqrt:  [[12.74634267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01181823 -0.0154586   0.18605413]
Stock Position:  0.011818225505281032
Bond Position:  [2.50609357]


portfolio before change:  [3.73272323]
curr_Stock_Price:  103.7648484748478
curr_Factors:  [103.76484847  -0.90469514  -1.0750781 ]
mat_Sqrt:  [[14.32998257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298504 -0.01974256 -0.09967797]
Stock Position:  -0.002985042208901047
Bond Position:  [4.04246568]


portfolio before change:  [3.73732287]
curr_Stock_Price:  102.3932410626051
curr_Factors:  [102.39324106  -0.90183416  -1.06954142]
mat_Sqrt:  [[14.25981052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168468  0.00712531 -0.15623209]
Stock Position:  -0.0016846767018578413
Bond Position:  [3.90982238]


portfolio before change:  [3.73898741]
curr_Stock_Price:  101.69531474782471
curr_Factors:  [101.69531475  -0.93384802  -1.08520537]
mat_Sqrt:  [[13.50321553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00774349 -0.01415829  0.05471341]
Stock Position:  -0.007743492400587504
Bond Position:  [4.52646431]


portfolio before change:  [3.73676811]
curr_Stock_Price:  102.05499057828033
curr_Factors:  [102.05499058  -0.9080922   -1.10415689]
mat_Sqrt:  [[13.643493    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0224801  0.01249334 0.18725788]
Stock Position:  0.022480103330630663
Bond Position:  [1.44256137]


portfolio before change:  [3.73645605]
curr_Stock_Price:  102.03308709939614
curr_Factors:  [102.0330871   -1.00821371  -1.10325063]
mat_Sqrt:  [[12.35218302  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00270973 -0.01899811  0.06312946]
Stock Position:  0.0027097270590920757
Bond Position:  [3.45997423]


portfolio before change:  [3.74011394]
curr_Stock_Price:  103.22337877312667
curr_Factors:  [103.22337877  -0.98003679  -1.12612856]
mat_Sqrt:  [[12.56267374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00946525 -0.00814606 -0.30646388]
Stock Position:  -0.009465249713918197
Bond Position:  [4.71714899]


portfolio before change:  [3.75104847]
curr_Stock_Price:  102.13044941874249
curr_Factors:  [102.13044942  -1.05590673  -1.11546925]
mat_Sqrt:  [[11.64497705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.17445793 0.38091299 0.44223912]
Stock Position:  0.17445792531205226
Bond Position:  [-14.06641785]


portfolio before change:  [3.95250527]
curr_Stock_Price:  103.29528741716419
curr_Factors:  [103.29528742  -0.7325964   -1.12093451]
mat_Sqrt:  [[16.18461083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00475464 -0.01593787 -0.09029937]
Stock Position:  -0.004754638243069577
Bond Position:  [4.443637]


portfolio before change:  [3.95836922]
curr_Stock_Price:  102.17880875963543
curr_Factors:  [102.17880876  -0.64260264  -1.10360034]
mat_Sqrt:  [[17.82356271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00051608 -0.00433461 -0.33013204]
Stock Position:  0.0005160804337048355
Bond Position:  [3.90563673]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.95883498]
Stock Price:  102.13526626551227
PL:  [1.82356871]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-3.83191779e-02 -4.71319761e-02  2.77243031e-01]
 [ 7.39660016e-01  2.09160054e-01  2.01830839e-01]
 [-3.34173576e-01 -2.21129482e-01  3.95439897e-02]
 [ 1.63371384e-01  1.13339077e+00  1.02571955e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 2.47236985e-02  3.28841767e-03  2.94605252e-02]
 [-1.40800659e-01  2.47536635e-01  1.01545659e-01]
 [-5.77474916e-02  1.11231885e-01  5.84499607e-03]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-4.81546386e-02 -1.73083090e-02  2.03400905e-02]
 [ 6.73325294e-01  1.37354539e+00 -2.15709995e-01]
 [-3.69362873e-04  2.36145703e-02 -3.13854449e-03]
 [-3.90496271e-01 -7.39476009e-03 -8.32982445e-01]
 [ 2.00606880e+00 -3.41723864e+00  2.88997391e+00]
 [ 3.24624540e-02 -8.43611495e-02  1.54005894e-02]
 [ 3.30637899e-02  1.63564815e-01 -9.40989450e-02]
 [-8.31103564e-03  1.17261060e-01 -9.98749755e-02]
 [-2.81875255e-01 -1.80627962e+00 -1.93175941e-01]
 [ 2.05949166e-02 -1.13751199e-01  2.64168502e-01]
 [ 1.63972039e-01  3.99875087e-01  4.86250518e-01]
 [ 2.68290804e-02 -1.51474002e-02  1.80637934e-02]
 [ 1.11647429e-01 -5.11438621e-02  2.81918026e-02]
 [-5.67457422e-02 -8.53008450e-02 -8.18685330e-02]
 [-1.74054786e-01  4.02643811e-02 -4.08286103e-02]
 [ 7.14524094e-02  1.58035928e-02 -2.59307266e-02]
 [-4.75147378e-03 -5.12545113e-02  2.20527961e-01]
 [ 2.85857951e-01 -1.02314331e-01  1.30805133e-01]
 [ 1.98719428e-02 -1.30722924e-01 -4.68755054e-02]
 [ 7.16388547e-03 -5.87800905e-02  2.48414585e-02]
 [-1.16316286e-02  7.43143391e-02  1.46747597e-02]
 [ 3.80521986e-02 -1.48484706e-02 -7.75080343e-02]
 [-7.35497412e-02  1.85281972e-02 -3.83558909e-02]
 [-1.05939696e-01 -3.20018730e-02  4.09347494e-02]
 [ 7.22320857e-02 -5.29155706e-03  1.77667157e-02]
 [-8.55991693e-02 -3.89483039e-02  6.99353057e-02]
 [-1.17802688e-01 -6.87231532e-02 -8.02014459e-02]
 [ 2.43718172e+00  1.56055737e+00  1.72846983e-01]
 [-2.41372917e-03 -1.20322814e-01 -2.90270205e-02]
 [ 3.24820884e-02 -1.40578682e-02 -5.91897317e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.12604949]
curr_Stock_Price:  99.65423074129134
curr_Factors:  [99.65423074 -0.75034856 -0.96927003]
mat_Sqrt:  [[17.85150677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.84667463e-04 -1.52117799e-02  7.90897198e-01]
Stock Position:  0.0004846674626994575
Bond Position:  [-0.17434866]


portfolio before change:  [-0.12610979]
curr_Stock_Price:  99.5747856997828
curr_Factors:  [99.5747857  -0.80449939 -0.97470507]
mat_Sqrt:  [[16.80547159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04900506 0.06750612 0.57576721]
Stock Position:  0.04900506223405755
Bond Position:  [-5.00577836]


portfolio before change:  [-0.13888564]
curr_Stock_Price:  99.32685038044531
curr_Factors:  [99.32685038 -0.89972857 -0.9686247 ]
mat_Sqrt:  [[15.33384777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02421046 -0.07136923  0.112808  ]
Stock Position:  -0.024210463362323607
Bond Position:  [2.26586343]


portfolio before change:  [-0.15949703]
curr_Stock_Price:  100.18989217697465
curr_Factors:  [100.18989218  -0.84555248  -0.97627693]
mat_Sqrt:  [[16.20367232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03728154 0.3658003  2.92609237]
Stock Position:  0.03728154461319953
Bond Position:  [-3.89473097]


portfolio before change:  [-0.14219417]
curr_Stock_Price:  100.6670647989027
curr_Factors:  [100.6670648   -1.20722707  -0.96665034]
mat_Sqrt:  [[11.44944521  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00512217 -0.01106097 -0.05874131]
Stock Position:  -0.005122169666520548
Bond Position:  [0.37343962]


portfolio before change:  [-0.13752928]
curr_Stock_Price:  99.7654538981586
curr_Factors:  [99.7654539  -1.11393438 -0.97985475]
mat_Sqrt:  [[12.29303493  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00255499 0.00106133 0.08404268]
Stock Position:  0.002554987324038652
Bond Position:  [-0.39242875]


portfolio before change:  [-0.14129862]
curr_Stock_Price:  98.30936998914594
curr_Factors:  [98.30936999 -1.08224415 -0.95479858]
mat_Sqrt:  [[12.82089943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00542431  0.07989211  0.2896815 ]
Stock Position:  -0.005424310127833754
Bond Position:  [0.3919619]


portfolio before change:  [-0.14041868]
curr_Stock_Price:  98.15618158169518
curr_Factors:  [98.15618158 -1.00982073 -0.94265724]
mat_Sqrt:  [[13.93051736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242986  0.03589994  0.01667415]
Stock Position:  -0.002429864770698852
Bond Position:  [0.09808757]


portfolio before change:  [-0.14169354]
curr_Stock_Price:  98.6858920426028
curr_Factors:  [98.68589204 -0.93279782 -0.92101414]
mat_Sqrt:  [[15.45805216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00336337  0.0064198  -0.11330016]
Stock Position:  0.00336337352323339
Bond Position:  [-0.47361105]


portfolio before change:  [-0.14526447]
curr_Stock_Price:  97.64178442172339
curr_Factors:  [97.64178442 -1.04904381 -0.90949023]
mat_Sqrt:  [[13.77384462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345116 -0.00558623  0.05802462]
Stock Position:  -0.0034511627000276286
Bond Position:  [0.19171322]


portfolio before change:  [-0.14642893]
curr_Stock_Price:  97.9861388731616
curr_Factors:  [97.98613887 -1.38674404 -0.89748043]
mat_Sqrt:  [[ 9.98018434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09114736  0.44330987 -0.61536057]
Stock Position:  0.09114735987285603
Bond Position:  [-9.07760679]


portfolio before change:  [-0.11498832]
curr_Stock_Price:  98.34353135011375
curr_Factors:  [98.34353135 -1.37406175 -0.87255823]
mat_Sqrt:  [[10.40042625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036636  0.00762157 -0.00895339]
Stock Position:  0.00036635886777078064
Bond Position:  [-0.15101734]


portfolio before change:  [-0.11480303]
curr_Stock_Price:  98.90082050613627
curr_Factors:  [98.90082051 -1.36784208 -0.89012291]
mat_Sqrt:  [[10.34137201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05434845 -0.00238665 -2.37626706]
Stock Position:  -0.054348450979107905
Bond Position:  [5.26030337]


portfolio before change:  [-0.08666429]
curr_Stock_Price:  98.39517303137451
curr_Factors:  [98.39517303 -1.39566695 -0.89574302]
mat_Sqrt:  [[ 9.95009175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.19079637 -1.10290903  8.24429117]
Stock Position:  0.19079636518011917
Bond Position:  [-18.86010566]


portfolio before change:  [0.00944176]
curr_Stock_Price:  98.9112400620793
curr_Factors:  [98.91124006 -1.28725482 -0.91445537]
mat_Sqrt:  [[10.94095066  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168047 -0.02722744  0.04393359]
Stock Position:  0.0016804699297154786
Bond Position:  [-0.1567756]


portfolio before change:  [0.00776652]
curr_Stock_Price:  97.92601334007071
curr_Factors:  [97.92601334 -1.07374621 -0.92397472]
mat_Sqrt:  [[13.28308333  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00355666  0.05279032 -0.2684381 ]
Stock Position:  0.0035566630172853986
Bond Position:  [-0.34052331]


portfolio before change:  [0.00730101]
curr_Stock_Price:  97.8070973064462
curr_Factors:  [97.80709731 -1.17279742 -0.91134599]
mat_Sqrt:  [[12.16853759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039135  0.03784584 -0.28491551]
Stock Position:  -0.00039134661449583523
Bond Position:  [0.04557748]


portfolio before change:  [0.00725287]
curr_Stock_Price:  97.94466335274069
curr_Factors:  [97.94466335 -1.36477043 -0.90213983]
mat_Sqrt:  [[10.15018976  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06798025 -0.58297424 -0.55107719]
Stock Position:  -0.06798024757232336
Bond Position:  [6.66555533]


portfolio before change:  [0.04250331]
curr_Stock_Price:  97.43838112140874
curr_Factors:  [97.43838112 -1.26221389 -0.89182923]
mat_Sqrt:  [[11.30423093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00453801 -0.03671304  0.7535992 ]
Stock Position:  0.004538010602466976
Bond Position:  [-0.3996731]


portfolio before change:  [0.04506048]
curr_Stock_Price:  98.0128906502835
curr_Factors:  [98.01289065 -1.52182768 -0.90130857]
mat_Sqrt:  [[ 8.68817368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03969208 0.12905913 1.38713738]
Stock Position:  0.039692078349281464
Bond Position:  [-3.84527486]


portfolio before change:  [0.02453402]
curr_Stock_Price:  97.50785868605044
curr_Factors:  [97.50785869 -1.53863723 -0.89244039]
mat_Sqrt:  [[ 8.57503747  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00319817 -0.0048888   0.05153097]
Stock Position:  0.003198165231450419
Bond Position:  [-0.28731223]


portfolio before change:  [0.0274372]
curr_Stock_Price:  98.42685535724624
curr_Factors:  [98.42685536 -1.40699833 -0.92223098]
mat_Sqrt:  [[ 9.58389784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01116063 -0.01650661  0.08042337]
Stock Position:  0.011160632219240928
Bond Position:  [-1.07106873]


portfolio before change:  [0.01733927]
curr_Stock_Price:  97.53407082125486
curr_Factors:  [97.53407082 -1.47788406 -0.94465697]
mat_Sqrt:  [[ 8.65087726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01050403 -0.02753073 -0.23354814]
Stock Position:  -0.01050402703049773
Bond Position:  [1.04183979]


portfolio before change:  [0.01851374]
curr_Stock_Price:  97.43465811470087
curr_Factors:  [97.43465811 -1.4745433  -0.92577624]
mat_Sqrt:  [[ 8.83624882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01971085  0.01299527 -0.11647266]
Stock Position:  -0.019710848201279572
Bond Position:  [1.9390335]


portfolio before change:  [0.01222029]
curr_Stock_Price:  97.76624475842942
curr_Factors:  [97.76624476 -1.51839317 -0.92372251]
mat_Sqrt:  [[ 8.50337963  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00815972  0.00510059 -0.07397315]
Stock Position:  0.008159722355566177
Bond Position:  [-0.78552513]


portfolio before change:  [0.017907]
curr_Stock_Price:  98.4752036077742
curr_Factors:  [98.47520361 -1.58744555 -0.90493892]
mat_Sqrt:  [[ 8.14513087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00365879 -0.01654232  0.62910489]
Stock Position:  0.0036587901356221553
Bond Position:  [-0.34239311]


portfolio before change:  [0.01977102]
curr_Stock_Price:  98.99636605016784
curr_Factors:  [98.99636605 -1.39785447 -0.88720613]
mat_Sqrt:  [[10.07465168  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02895124 -0.03302181  0.37315063]
Stock Position:  0.028951235321438715
Bond Position:  [-2.84629607]


portfolio before change:  [0.01537874]
curr_Stock_Price:  98.85694296082117
curr_Factors:  [98.85694296 -1.27388523 -0.89176496]
mat_Sqrt:  [[11.33645443  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144491 -0.04219064 -0.13372277]
Stock Position:  -0.0014449124983897735
Bond Position:  [0.15821837]


portfolio before change:  [0.0146313]
curr_Stock_Price:  99.38792011150073
curr_Factors:  [99.38792011 -1.18258604 -0.89555705]
mat_Sqrt:  [[12.43963182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.89869953e-05 -1.89711926e-02  7.08657667e-02]
Stock Position:  1.898699525712118e-05
Bond Position:  [0.01274422]


portfolio before change:  [0.01462106]
curr_Stock_Price:  98.76463411585976
curr_Factors:  [98.76463412 -1.30981954 -0.91130951]
mat_Sqrt:  [[10.71463471  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00060975 0.02398485 0.041863  ]
Stock Position:  0.0006097450190136108
Bond Position:  [-0.04560018]


portfolio before change:  [0.01459298]
curr_Stock_Price:  98.72793282130448
curr_Factors:  [98.72793282 -1.57323463 -0.89567116]
mat_Sqrt:  [[ 8.36003089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00229664 -0.00479232 -0.22110885]
Stock Position:  0.002296642954724001
Bond Position:  [-0.21214983]


portfolio before change:  [0.01448608]
curr_Stock_Price:  98.69293414294903
curr_Factors:  [98.69293414 -1.69698937 -0.89469918]
mat_Sqrt:  [[ 7.39145646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01049821  0.00597995 -0.10941868]
Stock Position:  -0.010498208663475095
Bond Position:  [1.0505851]


portfolio before change:  [0.01636254]
curr_Stock_Price:  98.52670287962366
curr_Factors:  [98.52670288 -1.64804069 -0.89452363]
mat_Sqrt:  [[ 7.75054596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01343341 -0.01032856  0.11677545]
Stock Position:  -0.013433412399575904
Bond Position:  [1.33991238]


portfolio before change:  [0.01085699]
curr_Stock_Price:  98.94901236376327
curr_Factors:  [98.94901236 -1.57754848 -0.89664084]
mat_Sqrt:  [[ 8.33459876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00897207 -0.00170784  0.05068349]
Stock Position:  0.008972065596402163
Bond Position:  [-0.87692004]


portfolio before change:  [0.01035183]
curr_Stock_Price:  98.90492794531319
curr_Factors:  [98.90492795 -1.62142958 -0.8839795 ]
mat_Sqrt:  [[ 8.0748152   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00981744 -0.01257051  0.19950596]
Stock Position:  -0.009817435086913242
Bond Position:  [0.98134454]


portfolio before change:  [0.00840247]
curr_Stock_Price:  99.11598495942177
curr_Factors:  [99.11598496 -1.68946277 -0.87857447]
mat_Sqrt:  [[ 7.60079985  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01949818 -0.0221803  -0.2287924 ]
Stock Position:  -0.019498184066140154
Bond Position:  [1.94098419]


portfolio before change:  [0.00992816]
curr_Stock_Price:  99.05018121296821
curr_Factors:  [99.05018121 -1.55985501 -0.87955592]
mat_Sqrt:  [[ 8.63838524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.32309411 0.50366772 0.49308433]
Stock Position:  0.32309411155010015
Bond Position:  [-31.99260213]


portfolio before change:  [-0.07270671]
curr_Stock_Price:  98.80679842662741
curr_Factors:  [98.80679843 -1.28546337 -0.87674487]
mat_Sqrt:  [[11.36977109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00289361 -0.03883402 -0.08280601]
Stock Position:  -0.002893605870974598
Bond Position:  [0.21320123]


portfolio before change:  [-0.07242749]
curr_Stock_Price:  98.71951319665203
curr_Factors:  [98.7195132  -1.26372923 -0.86544587]
mat_Sqrt:  [[11.74124124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149307 -0.00453716 -0.16885183]
Stock Position:  0.0014930691128143062
Bond Position:  [-0.21982254]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.07334478]
Stock Price:  98.12354650688393
PL:  [-0.07334478]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.64766996e-02 -9.87058980e-02  2.39427488e-03]
 [ 1.11580309e+00  2.39373846e-01  3.26151449e-01]
 [-2.28553840e-01 -1.23908695e-01  3.64632125e-02]
 [ 1.75444517e-01  1.30305670e+00  1.11867157e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 9.64187915e-03  7.83641892e-02 -9.90248724e-03]
 [-5.78561300e-02  1.54456887e-02 -5.82147282e-02]
 [-4.13521002e-02  1.92162305e-01 -2.43492241e-02]
 [ 2.26391679e-02  5.60340156e-02 -4.52075594e-02]
 [-2.06408693e-01 -1.15577207e-01 -8.90456970e-02]
 [ 6.46068041e-01  1.25259798e+00 -2.23665082e-01]
 [-2.06821703e-04  3.25716796e-02 -5.83428072e-02]
 [-2.95381309e-01 -3.69053716e-03 -6.03254440e-01]
 [ 1.72945720e+00 -3.32658606e+00  2.79211348e+00]
 [ 4.72565162e-03 -9.21429090e-02  3.57232444e-02]
 [ 1.16719623e-01 -2.56385832e-02 -1.53742975e-02]
 [-6.32489335e-02 -1.01764578e-02 -5.99374825e-02]
 [-2.70990320e-01 -1.75709365e+00 -1.97800181e-01]
 [-1.64954171e-02  5.91616284e-02  2.87846760e-01]
 [ 2.32660404e-01  1.58651917e-01  5.52644676e-01]
 [ 5.36259636e-02 -2.30363351e-01 -1.34685926e-02]
 [ 1.09342422e-01 -5.02690317e-02  2.04813092e-03]
 [ 1.04019455e-02  1.37900739e-01  7.15792054e-02]
 [-1.91905885e-01  5.68513461e-02  1.52008523e-02]
 [-8.95612067e-03 -1.38078140e-01  4.51386285e-02]
 [ 4.08135966e-02 -1.14221381e-02  1.09953653e-01]
 [ 4.37714313e-01 -8.47689455e-02  2.18622000e-01]
 [ 1.17942155e-01 -2.66702002e-01 -1.51469601e-01]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 1.34511663e-01 -5.46034653e-02  8.76800763e-02]
 [-1.27492397e-02 -4.05497855e-02 -5.14842926e-02]
 [-4.93681083e-02  2.44683713e-02 -4.61712673e-02]
 [-3.56518721e-02 -2.84444822e-02 -2.71631440e-02]
 [ 3.29250326e-01  4.17134802e-02  6.96327897e-02]
 [-9.52729494e-02 -2.73027769e-02  5.67408139e-02]
 [-2.98011330e-02  9.68940459e-03 -4.55265247e-03]
 [ 2.80501391e+00  1.85955863e+00  2.00590412e-01]
 [-7.33179808e-02 -6.77970471e-02 -3.06636705e-02]
 [ 3.69438084e-02 -1.75876045e-02 -6.79067286e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.6315355]
curr_Stock_Price:  100.03053519980492
curr_Factors:  [100.0305352   -1.01329491  -0.98944096]
mat_Sqrt:  [[13.50067421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023575 -0.03185719  0.0068302 ]
Stock Position:  -0.00023575327147838557
Bond Position:  [2.65511802]


portfolio before change:  [2.63182563]
curr_Stock_Price:  100.20773534639092
curr_Factors:  [100.20773535  -1.06307361  -0.95498049]
mat_Sqrt:  [[13.31899592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09244244 0.07725758 0.9304193 ]
Stock Position:  0.09244243809317544
Bond Position:  [-6.63162174]


portfolio before change:  [2.63200773]
curr_Stock_Price:  100.21867299930237
curr_Factors:  [100.218673    -0.95648586  -0.95848018]
mat_Sqrt:  [[14.76690437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0166862  -0.03999136  0.1040194 ]
Stock Position:  -0.016686203693075777
Bond Position:  [4.30427692]


portfolio before change:  [2.63730371]
curr_Stock_Price:  99.9335329196296
curr_Factors:  [99.93353292 -1.01334258 -0.96558791]
mat_Sqrt:  [[13.81251142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04849066 0.42055974 3.19125862]
Stock Position:  0.04849065538220118
Bond Position:  [-2.2085388]


portfolio before change:  [2.62193854]
curr_Stock_Price:  99.62235783375617
curr_Factors:  [99.62235783 -0.88074639 -0.94322814]
mat_Sqrt:  [[16.07736021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364774 -0.01106097 -0.05874131]
Stock Position:  -0.003647738196342925
Bond Position:  [2.98533482]


portfolio before change:  [2.62340019]
curr_Stock_Price:  99.32396397187456
curr_Factors:  [99.32396397 -1.10040624 -0.95866595]
mat_Sqrt:  [[12.67098435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186383  0.02529193 -0.02824904]
Stock Position:  0.0018638303778537911
Bond Position:  [2.43827717]


portfolio before change:  [2.62451234]
curr_Stock_Price:  99.75713156837698
curr_Factors:  [99.75713157 -0.89930337 -0.97857362]
mat_Sqrt:  [[15.25430207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00436508  0.00498507 -0.16607042]
Stock Position:  -0.004365084900332662
Bond Position:  [3.05996069]


portfolio before change:  [2.62400882]
curr_Stock_Price:  99.96011519182547
curr_Factors:  [99.96011519 -0.82992998 -0.98368481]
mat_Sqrt:  [[16.29985914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043543  0.06202012 -0.06946156]
Stock Position:  -0.0004354269856890697
Bond Position:  [2.66753415]


portfolio before change:  [2.62409019]
curr_Stock_Price:  100.53908542366784
curr_Factors:  [100.53908542  -0.77629324  -0.9758046 ]
mat_Sqrt:  [[17.43446029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00142529  0.0180849  -0.12896458]
Stock Position:  0.0014252869641006032
Bond Position:  [2.48079314]


portfolio before change:  [2.6256865]
curr_Stock_Price:  101.4414983327841
curr_Factors:  [101.44149833  -1.10597182  -0.96936476]
mat_Sqrt:  [[12.73234586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01949187 -0.03730238 -0.25402259]
Stock Position:  -0.01949186513344726
Bond Position:  [4.60297051]


portfolio before change:  [2.61002212]
curr_Stock_Price:  102.27465574800199
curr_Factors:  [102.27465575  -1.16015551  -0.94695775]
mat_Sqrt:  [[12.43541744  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06884353  0.40427426 -0.63805422]
Stock Position:  0.06884353444648485
Bond Position:  [-4.43092667]


portfolio before change:  [2.54868528]
curr_Stock_Price:  101.39174152566085
curr_Factors:  [101.39174153  -1.24348552  -0.92800498]
mat_Sqrt:  [[11.55942523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047298  0.01051246 -0.16643579]
Stock Position:  -0.0004729760345519265
Bond Position:  [2.59664115]


portfolio before change:  [2.54925291]
curr_Stock_Price:  100.87790334007016
curr_Factors:  [100.87790334  -1.21899594  -0.90348455]
mat_Sqrt:  [[12.07854118  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.47122577e-02 -1.19111575e-03 -1.72091701e+00]
Stock Position:  -0.03471225771571699
Bond Position:  [6.05095269]


portfolio before change:  [2.54289421]
curr_Stock_Price:  101.08287760927031
curr_Factors:  [101.08287761  -1.18162404  -0.90759503]
mat_Sqrt:  [[12.51241909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12950001 -1.07365104  7.9651226 ]
Stock Position:  0.12950001336684894
Bond Position:  [-10.54733979]


portfolio before change:  [2.51783767]
curr_Stock_Price:  100.8995723136777
curr_Factors:  [100.89957231  -1.07066925  -0.94410711]
mat_Sqrt:  [[13.45498041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050472 -0.029739    0.10190847]
Stock Position:  -0.0005047175087774402
Bond Position:  [2.56876345]


portfolio before change:  [2.51817565]
curr_Stock_Price:  100.8661632481462
curr_Factors:  [100.86616325  -1.24093034  -0.91745448]
mat_Sqrt:  [[11.6512061   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00929929 -0.00827482 -0.04385859]
Stock Position:  0.00929928650115075
Bond Position:  [1.5801923]


portfolio before change:  [2.51252207]
curr_Stock_Price:  100.23696264747313
curr_Factors:  [100.23696265  -1.34520701  -0.93959163]
mat_Sqrt:  [[10.20357719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00760134 -0.00328444 -0.17098495]
Stock Position:  -0.0076013421750887634
Bond Position:  [3.27445752]


portfolio before change:  [2.50919888]
curr_Stock_Price:  100.72799701135827
curr_Factors:  [100.72799701  -1.15117131  -0.96113002]
mat_Sqrt:  [[12.18398589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05499279 -0.56709954 -0.56426886]
Stock Position:  -0.054992787917289135
Bond Position:  [8.04851226]


portfolio before change:  [2.50642844]
curr_Stock_Price:  100.7966709308097
curr_Factors:  [100.79667093  -1.45381603  -0.95489076]
mat_Sqrt:  [[ 9.06479774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00599433 0.01909433 0.82114668]
Stock Position:  0.005994328289071021
Bond Position:  [1.9022201]


portfolio before change:  [2.50541682]
curr_Stock_Price:  100.588237852975
curr_Factors:  [100.58823785  -1.55946694  -0.9414832 ]
mat_Sqrt:  [[ 8.24894401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04580625 0.05120469 1.57654143]
Stock Position:  0.04580625258873338
Bond Position:  [-2.10215341]


portfolio before change:  [2.50529287]
curr_Stock_Price:  100.59126878351114
curr_Factors:  [100.59126878  -1.44063325  -0.92145426]
mat_Sqrt:  [[ 9.47804386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040662 -0.07434945 -0.03842215]
Stock Position:  0.0004066215231734478
Bond Position:  [2.46439029]


portfolio before change:  [2.50550693]
curr_Stock_Price:  100.36009553343148
curr_Factors:  [100.36009553  -1.70107599  -0.89587902]
mat_Sqrt:  [[ 7.47683565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01330768 -0.01622426  0.00584275]
Stock Position:  0.013307684763804088
Bond Position:  [1.16994642]


portfolio before change:  [2.5179614]
curr_Stock_Price:  101.28499046089843
curr_Factors:  [101.28499046  -1.65114891  -0.8804369 ]
mat_Sqrt:  [[ 8.05547853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00659947 0.04450727 0.20419555]
Stock Position:  0.006599466428485473
Bond Position:  [1.8495345]


portfolio before change:  [2.5208666]
curr_Stock_Price:  101.69017476728129
curr_Factors:  [101.69017477  -1.21519167  -0.87945742]
mat_Sqrt:  [[12.51942699  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01415387  0.01834869  0.0433638 ]
Stock Position:  -0.014153865942709069
Bond Position:  [3.9601757]


portfolio before change:  [2.52394819]
curr_Stock_Price:  101.50743067926645
curr_Factors:  [101.50743068  -1.02183732  -0.89972546]
mat_Sqrt:  [[14.85845736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187956 -0.04456453  0.12876794]
Stock Position:  -0.00187955709846124
Bond Position:  [2.7147372]


portfolio before change:  [2.52413697]
curr_Stock_Price:  101.58754598760412
curr_Factors:  [101.58754599  -1.32455893  -0.89752593]
mat_Sqrt:  [[11.01035392  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00553354 -0.00368648  0.31366717]
Stock Position:  0.005533542184865164
Bond Position:  [1.961998]


portfolio before change:  [2.52699028]
curr_Stock_Price:  102.05886140564289
curr_Factors:  [102.05886141  -1.26371532  -0.92283259]
mat_Sqrt:  [[11.4615942   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0405735  -0.02735906  0.62366771]
Stock Position:  0.04057349657975192
Bond Position:  [-1.61389458]


portfolio before change:  [2.53068788]
curr_Stock_Price:  102.15496723410422
curr_Factors:  [102.15496723  -1.42220945  -0.92511657]
mat_Sqrt:  [[ 9.7685195   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00333553 -0.0860777  -0.43210061]
Stock Position:  0.0033355345118486522
Bond Position:  [2.18994646]


portfolio before change:  [2.52972265]
curr_Stock_Price:  101.78351549390752
curr_Factors:  [101.78351549  -1.2374366   -0.89868461]
mat_Sqrt:  [[12.0218635   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183824 -0.02321455 -0.0028026 ]
Stock Position:  -0.0018382368444998718
Bond Position:  [2.71682486]


portfolio before change:  [2.52934311]
curr_Stock_Price:  102.17474013276973
curr_Factors:  [102.17474013  -1.3713572   -0.86481483]
mat_Sqrt:  [[10.91908809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01293729 -0.01762319  0.25012685]
Stock Position:  0.01293728895554694
Bond Position:  [1.20747898]


portfolio before change:  [2.53034998]
curr_Stock_Price:  102.24089919693942
curr_Factors:  [102.2408992   -1.57842742  -0.85654962]
mat_Sqrt:  [[ 8.95627806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00352106 -0.01308739 -0.14687036]
Stock Position:  -0.003521062768507423
Bond Position:  [2.8903466]


portfolio before change:  [2.53138247]
curr_Stock_Price:  102.0502809286893
curr_Factors:  [102.05028093  -1.40004637  -0.8278065 ]
mat_Sqrt:  [[10.99689294  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00489213  0.00789713 -0.13171377]
Stock Position:  -0.004892126683967049
Bond Position:  [3.03062537]


portfolio before change:  [2.52986532]
curr_Stock_Price:  102.43784404260623
curr_Factors:  [102.43784404  -1.51504131  -0.84590769]
mat_Sqrt:  [[ 9.66302953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00486418 -0.00918042 -0.07748889]
Stock Position:  -0.0048641816831945335
Bond Position:  [3.0281416]


portfolio before change:  [2.52988954]
curr_Stock_Price:  102.51068620610586
curr_Factors:  [102.51068621  -1.45295818  -0.84986536]
mat_Sqrt:  [[10.24862456  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.034344   0.01346297 0.19864297]
Stock Position:  0.03434400257474238
Bond Position:  [-0.99073773]


portfolio before change:  [2.53656724]
curr_Stock_Price:  102.70872806245316
curr_Factors:  [102.70872806  -1.72950208  -0.8550082 ]
mat_Sqrt:  [[ 7.7476287   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01152145 -0.00881193  0.16186575]
Stock Position:  -0.011521452389379693
Bond Position:  [3.71992096]


portfolio before change:  [2.52056584]
curr_Stock_Price:  104.13792460694816
curr_Factors:  [104.13792461  -1.98968096  -0.85411772]
mat_Sqrt:  [[ 6.06125904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00474367  0.00312724 -0.01298745]
Stock Position:  -0.004743667549118257
Bond Position:  [3.01456153]


portfolio before change:  [2.52236176]
curr_Stock_Price:  103.83877315719363
curr_Factors:  [103.83877316  -1.83093909  -0.86372702]
mat_Sqrt:  [[ 7.01586013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.45974977 0.60016997 0.57222861]
Stock Position:  0.45974976852194144
Bond Position:  [-45.21749017]


portfolio before change:  [2.45405113]
curr_Stock_Price:  103.70248577709958
curr_Factors:  [103.70248578  -1.65035635  -0.85842425]
mat_Sqrt:  [[ 8.4380014   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01107089 -0.0218814  -0.08747492]
Stock Position:  -0.011070890625003169
Bond Position:  [3.60213]


portfolio before change:  [2.45644568]
curr_Stock_Price:  103.5268665461061
curr_Factors:  [103.52686655  -2.02023577  -0.87245134]
mat_Sqrt:  [[ 5.73819127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00339695 -0.00567637 -0.193719  ]
Stock Position:  0.003396950321940083
Bond Position:  [2.10477006]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.4574794]
Stock Price:  103.75371801755286
PL:  [-1.29623862]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.88367105e-02 -9.46477454e-02 -3.57518977e-03]
 [ 1.12095853e+00  2.33765957e-01  3.23657267e-01]
 [-1.94485326e-01 -9.25493316e-02  3.54694825e-02]
 [ 1.59206608e-01  1.34326483e+00  1.03829957e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 5.60941357e-02 -5.98287213e-02  4.19967657e-02]
 [-4.13154487e-02 -6.05210037e-02 -3.89494688e-02]
 [ 1.35991392e-01  7.15392379e-02 -1.17911741e-01]
 [-3.76608239e-03  8.46087638e-02 -4.95487943e-02]
 [-4.32898037e-01 -1.15712902e-03 -1.73388532e-01]
 [ 5.75326821e-01  1.11432501e+00 -2.00064019e-01]
 [-2.32369096e-04  2.91597586e-02 -5.81246564e-02]
 [-1.99702929e-01 -2.10956650e-02 -4.83732374e-01]
 [ 1.77217401e+00 -3.43068093e+00  2.90573773e+00]
 [ 5.01541839e-03 -9.20940614e-02  3.56931982e-02]
 [ 1.16040238e-01 -5.12947783e-02  3.25948703e-03]
 [-1.21542182e-01 -1.33353958e-01 -3.49019149e-02]
 [-2.61360136e-01 -1.69686906e+00 -1.95855761e-01]
 [-4.11789810e-02  1.90827857e-01  4.37742223e-01]
 [ 2.73881210e-01  3.07113909e-02  5.46308149e-01]
 [ 6.13997366e-02 -2.17473140e-01 -8.40913405e-03]
 [ 1.33960224e-01 -5.28371586e-02 -1.18018039e-02]
 [ 1.54598330e-02  1.37488749e-01  7.49660310e-02]
 [-1.90633249e-02 -1.09972481e-01 -4.89336401e-02]
 [-3.03001690e-03 -6.81736466e-02  2.59417741e-02]
 [ 1.21005995e-02 -2.69436583e-02  1.27767975e-01]
 [ 6.22178872e-01 -1.13753158e-01  3.03970095e-01]
 [ 2.21610245e-01 -4.40953402e-01 -3.28465272e-01]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 1.55883724e-01 -6.02160061e-02  5.62836334e-02]
 [-1.94030899e-02 -4.07946399e-02 -4.87283899e-02]
 [-3.59564314e-02  2.40130677e-02 -5.02931558e-02]
 [-7.08709739e-02 -5.17821922e-02  1.59804468e-02]
 [ 2.76348949e-01  4.38635815e-02  6.93891380e-02]
 [-2.90689735e-03 -5.30894688e-02  3.57337293e-02]
 [-9.69780443e-02 -3.78890081e-02 -9.42881041e-02]
 [ 1.72139887e+00  1.15857954e+00  1.53928775e-01]
 [-2.38076715e-02 -1.30156899e-01 -5.35806242e-02]
 [ 3.51582787e-02 -1.33926958e-02 -1.08234606e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.50607387]
curr_Stock_Price:  100.01341450594758
curr_Factors:  [100.01341451  -1.03026557  -0.98977475]
mat_Sqrt:  [[13.26679113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.14284560e-05 -3.05474285e-02 -1.01990213e-02]
Stock Position:  -9.14284559899575e-05
Bond Position:  [2.51521795]


portfolio before change:  [2.5063702]
curr_Stock_Price:  100.21136076417534
curr_Factors:  [100.21136076  -1.08770805  -0.9895965 ]
mat_Sqrt:  [[12.55321765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0983606  0.07544764 0.9233041 ]
Stock Position:  0.09836060377718472
Bond Position:  [-7.35047975]


portfolio before change:  [2.52770698]
curr_Stock_Price:  100.43762666222601
curr_Factors:  [100.43762666  -1.11675138  -1.0056887 ]
mat_Sqrt:  [[12.02631091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01714048 -0.02987017  0.10118456]
Stock Position:  -0.01714047663389635
Bond Position:  [4.24925577]


portfolio before change:  [2.53212404]
curr_Stock_Price:  100.21091936477185
curr_Factors:  [100.21091936  -1.46189339  -1.0127567 ]
mat_Sqrt:  [[ 8.43700234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07648942 0.43353686 2.96197966]
Stock Position:  0.07648941872560003
Bond Position:  [-5.13295093]


portfolio before change:  [2.53727878]
curr_Stock_Price:  100.28669972657046
curr_Factors:  [100.28669973  -1.39540031  -1.01669894]
mat_Sqrt:  [[ 8.98839075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00652464 -0.01106097 -0.05874131]
Stock Position:  -0.006524638568466441
Bond Position:  [3.19161325]


portfolio before change:  [2.53515432]
curr_Stock_Price:  100.67345433835946
curr_Factors:  [100.67345434  -1.57083077  -0.99854527]
mat_Sqrt:  [[ 7.70990685  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00680348 -0.01930964  0.11980508]
Stock Position:  0.006803480771881567
Bond Position:  [1.85022441]


portfolio before change:  [2.54013895]
curr_Stock_Price:  101.37211616914722
curr_Factors:  [101.37211617  -1.5156098   -1.01130274]
mat_Sqrt:  [[ 8.10017387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00760722 -0.01953307 -0.11111199]
Stock Position:  -0.007607216197000981
Bond Position:  [3.31129855]


portfolio before change:  [2.53521781]
curr_Stock_Price:  102.07343418647288
curr_Factors:  [102.07343419  -1.39118169  -1.02681769]
mat_Sqrt:  [[ 9.09471174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.013912    0.02308919 -0.33636938]
Stock Position:  0.013912001601138663
Bond Position:  [1.11517203]


portfolio before change:  [2.54284403]
curr_Stock_Price:  102.611589567018
curr_Factors:  [102.61158957  -1.41451362  -1.00176301]
mat_Sqrt:  [[ 9.15842528  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00037021  0.02730736 -0.14134892]
Stock Position:  0.00037020599238168304
Bond Position:  [2.50485661]


portfolio before change:  [2.54319195]
curr_Stock_Price:  102.70557253833977
curr_Factors:  [102.70557254  -1.63007086  -0.99915888]
mat_Sqrt:  [[ 7.40856408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.32412727e-02 -3.73461784e-04 -4.94629219e-01]
Stock Position:  -0.0632412726825278
Bond Position:  [9.03842307]


portfolio before change:  [2.56450124]
curr_Stock_Price:  102.38648639280851
curr_Factors:  [102.38648639  -1.66305248  -0.99884629]
mat_Sqrt:  [[ 7.14816702  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.1065937   0.35964685 -0.57072696]
Stock Position:  0.10659369903080934
Bond Position:  [-8.34925308]


portfolio before change:  [2.51157693]
curr_Stock_Price:  101.89977296243109
curr_Factors:  [101.89977296  -1.67828888  -0.96945555]
mat_Sqrt:  [[ 7.21559956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008516   0.00941127 -0.16581347]
Stock Position:  -0.0008515999322792338
Bond Position:  [2.59835477]


portfolio before change:  [2.51178638]
curr_Stock_Price:  102.03524698324193
curr_Factors:  [102.03524698  -1.65828315  -0.99580972]
mat_Sqrt:  [[ 7.17946911  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04216893 -0.0068086  -1.37995382]
Stock Position:  -0.0421689286505391
Bond Position:  [6.81450343]


portfolio before change:  [2.50560709]
curr_Stock_Price:  102.20198466257801
curr_Factors:  [102.20198466  -1.63326869  -0.99487335]
mat_Sqrt:  [[ 7.38026139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.22560453 -1.10724751  8.28926095]
Stock Position:  0.22560453427367505
Bond Position:  [-20.55162406]


portfolio before change:  [2.46036661]
curr_Stock_Price:  102.0128423415553
curr_Factors:  [102.01284234  -1.55404289  -1.0022315 ]
mat_Sqrt:  [[ 7.91551156  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00082084 -0.02972323  0.10182276]
Stock Position:  -0.000820838876229431
Bond Position:  [2.54410272]


portfolio before change:  [2.46063934]
curr_Stock_Price:  102.06804152251027
curr_Factors:  [102.06804152  -1.62938592  -0.99013684]
mat_Sqrt:  [[ 7.43439277  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01428968 -0.01655532  0.00929841]
Stock Position:  0.014289677476814311
Bond Position:  [1.00211994]


portfolio before change:  [2.46308683]
curr_Stock_Price:  102.23055178478985
curr_Factors:  [102.23055178  -1.95601499  -0.96358405]
mat_Sqrt:  [[ 5.51588182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02826153 -0.04303981 -0.09956545]
Stock Position:  -0.028261531550521777
Bond Position:  [5.35227879]


portfolio before change:  [2.47498825]
curr_Stock_Price:  101.83310890749127
curr_Factors:  [101.83310891  -2.06686619  -0.99349349]
mat_Sqrt:  [[ 4.7730027   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.13570304 -0.54766213 -0.55872197]
Stock Position:  -0.13570303905227987
Bond Position:  [16.29405061]


portfolio before change:  [2.5034133]
curr_Stock_Price:  101.63865367707751
curr_Factors:  [101.63865368  -1.91494983  -1.0061607 ]
mat_Sqrt:  [[ 5.47566306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01591174 0.06158943 1.24875672]
Stock Position:  0.015911744086392825
Bond Position:  [0.88616505]


portfolio before change:  [2.50221864]
curr_Stock_Price:  101.5566112915529
curr_Factors:  [101.55661129  -1.67233942  -1.00729273]
mat_Sqrt:  [[ 6.96560343  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05622841 0.00991206 1.55846509]
Stock Position:  0.05622841359717806
Bond Position:  [-3.2081485]


portfolio before change:  [2.49281253]
curr_Stock_Price:  101.39645982690752
curr_Factors:  [101.39645983  -1.49053037  -1.01057317]
mat_Sqrt:  [[ 8.31394841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00183928 -0.07018915 -0.02398892]
Stock Position:  0.0018392837852383075
Bond Position:  [2.30631567]


portfolio before change:  [2.49340968]
curr_Stock_Price:  101.56437457180951
curr_Factors:  [101.56437457  -1.60147485  -1.04851255]
mat_Sqrt:  [[ 7.17573671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01682975 -0.01705312 -0.03366726]
Stock Position:  0.016829749517460035
Bond Position:  [0.7841067]


portfolio before change:  [2.48686152]
curr_Stock_Price:  101.16946765043346
curr_Factors:  [101.16946765  -1.69377259  -1.04200757]
mat_Sqrt:  [[ 6.56017216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00896729 0.0443743  0.21385722]
Stock Position:  0.008967292603555254
Bond Position:  [1.5796453]


portfolio before change:  [2.4890522]
curr_Stock_Price:  101.39174354819724
curr_Factors:  [101.39174355  -1.46777001  -1.09116155]
mat_Sqrt:  [[ 7.8464414   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00656347 -0.03549347 -0.13959405]
Stock Position:  -0.006563472331648947
Bond Position:  [3.1545341]


portfolio before change:  [2.48817501]
curr_Stock_Price:  101.5854720195666
curr_Factors:  [101.58547202  -1.68833033  -1.10407266]
mat_Sqrt:  [[ 6.22452753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187172 -0.02200295  0.07400466]
Stock Position:  -0.0018717182491151906
Bond Position:  [2.67831439]


portfolio before change:  [2.48831662]
curr_Stock_Price:  101.68869052343068
curr_Factors:  [101.68869052  -1.81920273  -1.0907086 ]
mat_Sqrt:  [[ 5.54005685  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00589909 -0.00869603  0.36448647]
Stock Position:  0.005899086945252884
Bond Position:  [1.8884462]


portfolio before change:  [2.4876043]
curr_Stock_Price:  101.52792114009084
curr_Factors:  [101.52792114  -1.8686559   -1.07991399]
mat_Sqrt:  [[ 5.32154651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12421328 -0.03671367  0.86714207]
Stock Position:  0.124213278871829
Bond Position:  [-10.12351168]


portfolio before change:  [2.4439516]
curr_Stock_Price:  101.1866759578622
curr_Factors:  [101.18667596  -1.8924866   -1.06004516]
mat_Sqrt:  [[ 5.28268945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01221978 -0.1423171  -0.93701999]
Stock Position:  0.012219782488964034
Bond Position:  [1.20747243]


portfolio before change:  [2.44636623]
curr_Stock_Price:  101.37192376969885
curr_Factors:  [101.37192377  -1.64772489  -1.07069079]
mat_Sqrt:  [[ 6.68843882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330406 -0.02321455 -0.0028026 ]
Stock Position:  -0.0033040643716991352
Bond Position:  [2.78130559]


portfolio before change:  [2.44608381]
curr_Stock_Price:  101.56263014144652
curr_Factors:  [101.56263014  -1.59317681  -1.11435336]
mat_Sqrt:  [[ 6.77436397  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02289234 -0.01943463  0.16056154]
Stock Position:  0.022892338228399336
Bond Position:  [0.12107773]


portfolio before change:  [2.45992969]
curr_Stock_Price:  102.16679505345554
curr_Factors:  [102.16679505  -1.58675119  -1.1367953 ]
mat_Sqrt:  [[ 6.70638613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00561806 -0.01316641 -0.13900853]
Stock Position:  -0.005618063307116378
Bond Position:  [3.03390922]


portfolio before change:  [2.45830859]
curr_Stock_Price:  102.52285479944481
curr_Factors:  [102.5228548   -1.32272595  -1.13685435]
mat_Sqrt:  [[ 8.76271203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00471553  0.00775018 -0.14347237]
Stock Position:  -0.004715530048165132
Bond Position:  [2.94175819]


portfolio before change:  [2.4616468]
curr_Stock_Price:  101.89292158635486
curr_Factors:  [101.89292159  -1.07978514  -1.11244081]
mat_Sqrt:  [[11.378169    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00687096 -0.01671263  0.04558777]
Stock Position:  -0.0068709626860265684
Bond Position:  [3.16174926]


portfolio before change:  [2.46327056]
curr_Stock_Price:  101.71412422303038
curr_Factors:  [101.71412422  -1.28561427  -1.09073511]
mat_Sqrt:  [[ 9.44812957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03169586 0.01415691 0.1979479 ]
Stock Position:  0.03169585692693607
Bond Position:  [-0.76064577]


portfolio before change:  [2.47438216]
curr_Stock_Price:  102.06769378807121
curr_Factors:  [102.06769379  -1.26013263  -1.12383759]
mat_Sqrt:  [[ 9.408994    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068547 -0.01713455  0.10193838]
Stock Position:  -0.0006854742234118647
Bond Position:  [2.54434693]


portfolio before change:  [2.47452816]
curr_Stock_Price:  102.31870363375346
curr_Factors:  [102.31870363  -1.29555648  -1.12743237]
mat_Sqrt:  [[ 9.07119166  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01366508 -0.01222862 -0.26897772]
Stock Position:  -0.013665082716997186
Bond Position:  [3.87272171]


portfolio before change:  [2.47464893]
curr_Stock_Price:  102.34529355194424
curr_Factors:  [102.34529355  -1.39029072  -1.13594994]
mat_Sqrt:  [[ 8.18343241  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.24309036 0.37392994 0.43911595]
Stock Position:  0.24309035694682313
Bond Position:  [-22.40450501]


portfolio before change:  [2.43550314]
curr_Stock_Price:  102.1957810321782
curr_Factors:  [102.19578103  -1.43337417  -1.09056273]
mat_Sqrt:  [[ 8.1903243   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00748602 -0.04200796 -0.15285061]
Stock Position:  -0.007486020596058976
Bond Position:  [3.20054286]


portfolio before change:  [2.43844874]
curr_Stock_Price:  101.85574571883062
curr_Factors:  [101.85574572  -1.09527943  -1.0832906 ]
mat_Sqrt:  [[11.53040581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.000896   -0.00432247 -0.3087632 ]
Stock Position:  0.0008959970644341636
Bond Position:  [2.34718629]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.43858384]
Stock Price:  101.67904433041298
PL:  [0.75953951]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-3.19592513e-02 -6.38518938e-02  2.32915172e-01]
 [-7.83046468e-02  9.17216876e-02 -4.32466673e-02]
 [-3.88352592e-01 -2.71000148e-01  4.11243144e-02]
 [ 2.68492909e-01  1.66092687e+00  1.65399856e+00]
 [-5.33758165e-02 -2.80104869e-03  2.76257355e-02]
 [-7.67957684e-02  5.86858769e-01 -3.04550584e-01]
 [-3.02237819e-01  2.99126964e-01  8.57444786e-01]
 [ 7.37575753e-03 -2.44390062e-02  6.08374780e-02]
 [ 1.98883339e-02 -6.30359041e-02 -6.19523245e-03]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 4.10322611e-01  1.20075023e+00 -4.19833795e-02]
 [-1.80846632e-03 -3.99216591e-03  2.16486900e-01]
 [-4.56521195e-01 -1.20600274e-01 -1.30830052e+00]
 [ 2.13082660e+00 -3.13188890e+00  2.66818068e+00]
 [-1.98291773e-02  8.09015101e-02 -3.75296363e-02]
 [ 1.04633828e-02  4.44169284e-01 -2.38480220e-01]
 [ 2.20640264e-02 -2.93921734e-01 -8.98071255e-02]
 [-3.06467048e-01 -1.94023708e+00 -1.90976960e-01]
 [ 5.29222321e-02 -1.59558958e-01  7.13722314e-02]
 [-3.60950974e-01  4.57679440e-01  2.68017873e-01]
 [ 1.41280151e-02  1.35236328e-01 -8.57237506e-02]
 [ 1.16340258e-01 -5.14683128e-02  7.45337463e-02]
 [ 7.95976352e-03 -1.17802573e-01 -1.18095103e-01]
 [-2.67200784e-01  9.68442785e-02  1.86196888e-02]
 [ 1.10714822e-01 -1.66148590e-02 -3.92875731e-02]
 [-2.19793039e-02 -5.42791665e-02  1.97852184e-01]
 [-1.32953317e-01 -9.92465124e-02 -7.02348099e-03]
 [-2.31250960e-01  1.73881955e-01  2.77024666e-01]
 [ 2.42549969e-01  1.75642515e-01  2.53384467e-01]
 [-1.43271033e-01  9.30555812e-02 -1.77807384e-01]
 [ 1.48349518e-01  1.94702820e-02  5.24855129e-02]
 [ 9.80919536e-02 -2.19583399e-03 -7.87346184e-02]
 [ 1.42669348e-01  1.29355206e-01  1.68620108e-01]
 [-2.18798688e-03 -3.01017385e-02  2.62491607e-02]
 [-8.93807936e-02  9.61192269e-02  3.99412510e-02]
 [-1.00801861e-01 -5.70642090e-02 -6.42046129e-02]
 [ 1.54718748e+00  1.00964213e+00  1.39360735e-01]
 [ 2.96237565e-02 -6.02752691e-02  5.38520267e-02]
 [ 3.04997833e-02 -1.51270302e-02 -2.94762312e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.39475794]
curr_Stock_Price:  98.93525435865281
curr_Factors:  [98.93525436 -0.82564125 -1.01839723]
mat_Sqrt:  [[15.64931508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.62987700e-04 -2.06081101e-02  6.64442155e-01]
Stock Position:  0.00016298770011579608
Bond Position:  [-5.41088317]


portfolio before change:  [-5.39567459]
curr_Stock_Price:  97.46125528275388
curr_Factors:  [97.46125528 -0.68968995 -1.01274788]
mat_Sqrt:  [[17.76121389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00385164  0.02960305 -0.1233707 ]
Stock Position:  -0.003851635655957971
Bond Position:  [-5.02028935]


portfolio before change:  [-5.40179191]
curr_Stock_Price:  98.88655749908284
curr_Factors:  [98.8865575  -0.81853289 -1.01070344]
mat_Sqrt:  [[15.87486399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02741918 -0.08746492  0.11731622]
Stock Position:  -0.027419182971756006
Bond Position:  [-2.6904033]


portfolio before change:  [-5.37496041]
curr_Stock_Price:  97.89572486571592
curr_Factors:  [97.89572487 -0.76736105 -1.0282089 ]
mat_Sqrt:  [[16.25390079  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05814907 0.53606184 4.71839752]
Stock Position:  0.05814907097172079
Bond Position:  [-11.06750586]


portfolio before change:  [-5.41375684]
curr_Stock_Price:  97.25232850987061
curr_Factors:  [97.25232851 -0.65507406 -1.03287495]
mat_Sqrt:  [[17.98179603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268652 -0.00090403  0.07880853]
Stock Position:  -0.0026865224375540353
Bond Position:  [-5.15248627]


portfolio before change:  [-5.41230101]
curr_Stock_Price:  96.47067561999098
curr_Factors:  [96.47067562 -0.4182925  -1.06770943]
mat_Sqrt:  [[21.82895177  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087818  0.18940785 -0.86879804]
Stock Position:  -0.0008781847003678232
Bond Position:  [-5.32758194]


portfolio before change:  [-5.41040803]
curr_Stock_Price:  93.55674126889227
curr_Factors:  [93.55674127 -0.53318328 -1.04785356]
mat_Sqrt:  [[19.25038913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343648  0.09654281  2.44605131]
Stock Position:  -0.0034364811422326626
Bond Position:  [-5.08890205]


portfolio before change:  [-5.41285737]
curr_Stock_Price:  94.08437276001199
curr_Factors:  [94.08437276 -0.73184928 -1.06412563]
mat_Sqrt:  [[15.61476677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094818 -0.00788766  0.17355239]
Stock Position:  0.0009481771124517577
Bond Position:  [-5.50206602]


portfolio before change:  [-5.41381379]
curr_Stock_Price:  93.80107575697176
curr_Factors:  [93.80107576 -0.95656452 -1.07173893]
mat_Sqrt:  [[12.34033132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00046649 -0.02034475 -0.01767327]
Stock Position:  0.00046648563941991767
Bond Position:  [-5.45757065]


portfolio before change:  [-5.41467887]
curr_Stock_Price:  93.40912248227818
curr_Factors:  [93.40912248 -0.85741071 -1.05455138]
mat_Sqrt:  [[13.80494583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [6.33156593e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  6.331565929757462e-05
Bond Position:  [-5.42059313]


portfolio before change:  [-5.41534426]
curr_Stock_Price:  93.60224962058021
curr_Factors:  [93.60224962 -0.73357235 -1.04317295]
mat_Sqrt:  [[15.8363688   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04084616  0.38754047 -0.1197669 ]
Stock Position:  0.040846163148844976
Bond Position:  [-9.23863702]


portfolio before change:  [-5.40084756]
curr_Stock_Price:  93.98543385877812
curr_Factors:  [93.98543386 -0.88542131 -1.04416232]
mat_Sqrt:  [[13.6474976   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00304575 -0.00128847  0.61757687]
Stock Position:  0.003045748086834109
Bond Position:  [-5.68710351]


portfolio before change:  [-5.4040633]
curr_Stock_Price:  93.16303644236942
curr_Factors:  [93.16303644 -0.69511369 -1.03654119]
mat_Sqrt:  [[16.48904397  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04537524 -0.03892357 -3.73221722]
Stock Position:  -0.0453752412634919
Bond Position:  [-1.17676805]


portfolio before change:  [-5.41729182]
curr_Stock_Price:  93.45133054062661
curr_Factors:  [93.45133054 -0.69886936 -1.04869471]
mat_Sqrt:  [[16.27901248  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12507961 -1.0108128   7.61157679]
Stock Position:  0.12507961144736443
Bond Position:  [-17.10614794]


portfolio before change:  [-5.39096743]
curr_Stock_Price:  93.67888798209006
curr_Factors:  [93.67888798 -1.03306988 -1.06386084]
mat_Sqrt:  [[11.50684557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095386  0.02611085 -0.10706161]
Stock Position:  -0.0009538609463209478
Bond Position:  [-5.3016108]


portfolio before change:  [-5.39135245]
curr_Stock_Price:  93.38773699958314
curr_Factors:  [93.387737   -0.85333592 -1.05174947]
mat_Sqrt:  [[13.89702309  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00377415  0.14335502 -0.68031769]
Stock Position:  0.0037741526945594575
Bond Position:  [-5.74381203]


portfolio before change:  [-5.39219981]
curr_Stock_Price:  93.35346735664262
curr_Factors:  [93.35346736 -1.00174789 -1.02122606]
mat_Sqrt:  [[12.34707336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00455689 -0.09486283 -0.25619473]
Stock Position:  -0.004556893562445762
Bond Position:  [-4.966798]


portfolio before change:  [-5.39375147]
curr_Stock_Price:  93.55772206823877
curr_Factors:  [93.55772207 -1.06518366 -1.02202303]
mat_Sqrt:  [[11.60425571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06389891 -0.62620882 -0.54480411]
Stock Position:  -0.06389891005941026
Bond Position:  [0.584485]


portfolio before change:  [-5.29220936]
curr_Stock_Price:  91.96975994935376
curr_Factors:  [91.96975995 -0.60305506 -0.99962148]
mat_Sqrt:  [[18.51874178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00188572 -0.05149743  0.20360511]
Stock Position:  0.0018857216257191318
Bond Position:  [-5.46563872]


portfolio before change:  [-5.29136415]
curr_Stock_Price:  92.78030268440664
curr_Factors:  [92.78030268 -0.74503856 -0.97824424]
mat_Sqrt:  [[16.55936101  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01285186  0.1477154   0.76458039]
Stock Position:  -0.012851862491618836
Bond Position:  [-4.09896445]


portfolio before change:  [-5.29953499]
curr_Stock_Price:  93.3762041478909
curr_Factors:  [93.37620415 -0.90882814 -1.00032412]
mat_Sqrt:  [[13.83891125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017512   0.04364734 -0.244546  ]
Stock Position:  0.0017512018970022914
Bond Position:  [-5.46305558]


portfolio before change:  [-5.29980239]
curr_Stock_Price:  93.61348286309216
curr_Factors:  [93.61348286 -1.05644815 -1.0083287 ]
mat_Sqrt:  [[11.87455137  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01019394 -0.01661133  0.21262403]
Stock Position:  0.01019394049201647
Bond Position:  [-6.25409267]


portfolio before change:  [-5.29970093]
curr_Stock_Price:  93.70013009649894
curr_Factors:  [93.7001301  -1.23904367 -1.01147757]
mat_Sqrt:  [[ 9.87077468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00407188 -0.03802062 -0.33689246]
Stock Position:  -0.004071883848316199
Bond Position:  [-4.91816488]


portfolio before change:  [-5.30165484]
curr_Stock_Price:  94.0289971451901
curr_Factors:  [94.02899715 -1.23253982 -0.98667956]
mat_Sqrt:  [[10.22038073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02383784  0.03125636  0.05311679]
Stock Position:  -0.023837840010537487
Bond Position:  [-3.06020665]


portfolio before change:  [-5.30035408]
curr_Stock_Price:  93.95838205721807
curr_Factors:  [93.95838206 -1.03068003 -0.98400755]
mat_Sqrt:  [[12.53048353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00792498 -0.00536242 -0.11207651]
Stock Position:  0.007924976404103369
Bond Position:  [-6.04497204]


portfolio before change:  [-5.30216526]
curr_Stock_Price:  93.82519426431999
curr_Factors:  [93.82519426 -0.95879934 -0.9996547 ]
mat_Sqrt:  [[13.23651606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.53575839e-04 -1.75185257e-02  5.64417209e-01]
Stock Position:  0.0005535758388243244
Bond Position:  [-5.35410462]


portfolio before change:  [-5.30369059]
curr_Stock_Price:  92.2788382041109
curr_Factors:  [92.2788382  -1.00853564 -1.00361173]
mat_Sqrt:  [[12.3377969   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0125343  -0.03203167 -0.02003604]
Stock Position:  -0.012534295216883855
Bond Position:  [-4.14704039]


portfolio before change:  [-5.29374564]
curr_Stock_Price:  91.44405915080878
curr_Factors:  [91.44405915 -1.12452691 -1.02492893]
mat_Sqrt:  [[10.6575821   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01306207  0.05612016  0.79027426]
Stock Position:  -0.013062065126366765
Bond Position:  [-4.09929738]


portfolio before change:  [-5.297256]
curr_Stock_Price:  91.67357260297278
curr_Factors:  [91.6735726  -1.1111366  -1.05000038]
mat_Sqrt:  [[10.56025224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03126107 0.05668838 0.72283536]
Stock Position:  0.031261065308373505
Bond Position:  [-8.16306954]


portfolio before change:  [-5.29815016]
curr_Stock_Price:  91.67761254309035
curr_Factors:  [91.67761254 -1.01047127 -1.05695715]
mat_Sqrt:  [[11.59819852  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01384447  0.03003356 -0.50723497]
Stock Position:  -0.013844470959247785
Bond Position:  [-4.02892211]


portfolio before change:  [-5.30021216]
curr_Stock_Price:  91.79017403560782
curr_Factors:  [91.79017404 -0.68919227 -1.03974838]
mat_Sqrt:  [[16.29021485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0100083  0.00628401 0.14972656]
Stock Position:  0.010008304649309666
Bond Position:  [-6.21887618]


portfolio before change:  [-5.30019302]
curr_Stock_Price:  91.86976275453483
curr_Factors:  [91.86976275 -0.7204935  -1.03677171]
mat_Sqrt:  [[15.8490054   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00514683 -0.0007087  -0.22460795]
Stock Position:  0.0051468273338745995
Bond Position:  [-5.77303082]


portfolio before change:  [-5.30375172]
curr_Stock_Price:  91.31854444411312
curr_Factors:  [91.31854444 -0.72827523 -1.02868781]
mat_Sqrt:  [[15.75867245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0129131  0.04174921 0.48102623]
Stock Position:  0.012913099435650078
Bond Position:  [-6.48295716]


portfolio before change:  [-5.28997141]
curr_Stock_Price:  92.44846090074715
curr_Factors:  [92.4484609  -0.79077632 -1.04911157]
mat_Sqrt:  [[14.68407283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00020256 -0.00971529  0.07488155]
Stock Position:  -0.00020255899360127743
Bond Position:  [-5.27124515]


portfolio before change:  [-5.29070891]
curr_Stock_Price:  92.83623911425674
curr_Factors:  [92.83623911 -0.64134489 -1.06562824]
mat_Sqrt:  [[16.84180089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365802  0.03102235  0.11394127]
Stock Position:  -0.003658015270855852
Bond Position:  [-4.95111253]


portfolio before change:  [-5.29566866]
curr_Stock_Price:  94.02290123992006
curr_Factors:  [94.02290124 -0.48110646 -1.06437329]
mat_Sqrt:  [[20.0465815   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0062632  -0.01841739 -0.18315789]
Stock Position:  -0.006263200309417395
Bond Position:  [-4.7067844]


portfolio before change:  [-5.30405326]
curr_Stock_Price:  95.26766675456226
curr_Factors:  [95.26766675 -0.56553028 -1.04345824]
mat_Sqrt:  [[19.06209783  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0934696  0.3258606  0.39755739]
Stock Position:  0.09346960255603112
Bond Position:  [-14.20868421]


portfolio before change:  [-5.276702]
curr_Stock_Price:  95.57929166583207
curr_Factors:  [95.57929167 -0.4961668  -1.03286335]
mat_Sqrt:  [[20.71640781  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00136668 -0.01945376  0.15362484]
Stock Position:  0.0013666760112196628
Bond Position:  [-5.40732793]


portfolio before change:  [-5.27859019]
curr_Stock_Price:  94.69230012480787
curr_Factors:  [94.69230012 -0.58294372 -1.02011836]
mat_Sqrt:  [[19.05959411  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112254 -0.00488223 -0.08408748]
Stock Position:  0.0011225412555779357
Bond Position:  [-5.38488621]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.27890704]
Stock Price:  95.00971364029908
PL:  [-5.27890704]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 4.31762658e-02 -5.55834491e-02  5.99005526e-02]
 [ 1.13414477e+00  2.40684213e-01  3.24320317e-01]
 [-3.66572611e-01 -2.50952124e-01  4.04890233e-02]
 [ 1.98775872e-01  1.41322949e+00  1.25718219e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 3.26770291e-02 -8.09007745e-02  5.04607611e-02]
 [-4.55090265e-02 -3.36821699e-02 -5.68871392e-02]
 [ 7.86875848e-02  1.25068628e-01 -5.18312410e-02]
 [-8.92992081e-03  9.01968715e-02 -5.03977707e-02]
 [-2.05334728e-01 -1.14910322e-01 -8.83033685e-02]
 [ 8.04203558e-01  1.54045040e+00 -2.81775389e-01]
 [-1.20961601e-04  3.34986671e-02 -5.86208430e-02]
 [-3.48243358e-01 -5.61736112e-03 -7.32133992e-01]
 [ 1.88161121e+00 -3.55349932e+00  2.99026361e+00]
 [ 2.23196995e-02 -8.91769837e-02  3.38988979e-02]
 [ 1.21197039e-01 -3.11956191e-02 -1.21928573e-02]
 [-1.07052374e-01 -1.05980293e-01 -4.51812317e-02]
 [-2.67407749e-01 -1.74408451e+00 -2.00470693e-01]
 [-1.03638697e-02  4.03345695e-02  1.94526851e-01]
 [ 2.87792642e-01 -2.77295928e-01  3.66538881e-01]
 [ 7.87414317e-02 -1.21271818e-01 -3.80001886e-02]
 [ 1.48413696e-01 -5.44354771e-02 -1.72073970e-02]
 [ 1.34665352e-01  1.83529626e-01  1.59943220e-01]
 [-2.67200784e-01  9.68442785e-02  1.86196888e-02]
 [-4.37009856e-02 -1.90069312e-01  7.10460997e-02]
 [ 7.17617671e-02 -1.63142345e-02 -4.66055658e-03]
 [ 4.43352877e-01 -6.51238110e-02  2.39056083e-01]
 [ 3.60914483e-02 -1.23857518e-01 -1.50464490e-02]
 [-1.13003731e-02 -7.66793217e-02 -6.15372091e-03]
 [ 1.53123895e-01 -5.92083295e-02  7.30045324e-02]
 [-1.49247618e-02 -4.32568426e-02 -4.87959724e-02]
 [-2.42423235e-02  2.27108587e-02 -5.30835121e-02]
 [-7.93507645e-02 -4.94398482e-02  1.69272088e-02]
 [ 1.56421723e-01  6.65221136e-03  2.73193651e-02]
 [-8.77150397e-02 -1.91590333e-02  5.07985502e-02]
 [-1.16483812e-01 -6.35938913e-02 -8.51062716e-02]
 [ 2.65360251e+00  1.69899521e+00  1.81861653e-01]
 [-1.19435004e-02 -1.31738922e-01 -5.30476301e-02]
 [ 3.43193823e-02 -1.33455168e-02 -9.21229524e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.51633151]
curr_Stock_Price:  100.42419907755509
curr_Factors:  [100.42419908  -0.9878592   -0.98784138]
mat_Sqrt:  [[13.9252345   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316386 -0.01793948  0.1708796 ]
Stock Position:  0.003163859886066541
Bond Position:  [5.19860341]


portfolio before change:  [5.51738364]
curr_Stock_Price:  100.55134250846832
curr_Factors:  [100.55134251  -0.82273559  -0.98411416]
mat_Sqrt:  [[16.50756424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07569111 0.0776805  0.92519559]
Stock Position:  0.07569110861628374
Bond Position:  [-2.09345895]


portfolio before change:  [5.40712064]
curr_Stock_Price:  99.09805029963331
curr_Factors:  [99.0980503  -0.78691551 -0.9475327 ]
mat_Sqrt:  [[17.4905645   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02341452 -0.08099445  0.11550391]
Stock Position:  -0.02341452222144453
Bond Position:  [7.72745414]


portfolio before change:  [5.39859259]
curr_Stock_Price:  99.50352683897648
curr_Factors:  [99.50352684 -0.97764637 -0.93640228]
mat_Sqrt:  [[14.67498649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05068975 0.45611786 3.58639086]
Stock Position:  0.05068974846335536
Bond Position:  [0.35478385]


portfolio before change:  [5.41416837]
curr_Stock_Price:  99.80992861920014
curr_Factors:  [99.80992862 -1.13787949 -0.95561776]
mat_Sqrt:  [[12.30210529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00476715 -0.01106097 -0.05874131]
Stock Position:  -0.004767151599897768
Bond Position:  [5.88997743]


portfolio before change:  [5.41216295]
curr_Stock_Price:  100.38505574114106
curr_Factors:  [100.38505574  -1.1683788   -0.98451964]
mat_Sqrt:  [[11.65942557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00226971 -0.02611061  0.14395051]
Stock Position:  0.0022697076512707207
Bond Position:  [5.18431822]


portfolio before change:  [5.41452816]
curr_Stock_Price:  101.1415964033638
curr_Factors:  [101.1415964   -1.27982508  -0.97113576]
mat_Sqrt:  [[10.65000799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00600905 -0.01087087 -0.16228317]
Stock Position:  -0.006009048012646856
Bond Position:  [6.02229286]


portfolio before change:  [5.41430636]
curr_Stock_Price:  101.30378967805704
curr_Factors:  [101.30378968  -1.17099853  -0.99595412]
mat_Sqrt:  [[11.60192663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00807082  0.04036573 -0.1478601 ]
Stock Position:  0.008070823648076781
Bond Position:  [4.59670134]


portfolio before change:  [5.41328776]
curr_Stock_Price:  101.1063840307998
curr_Factors:  [101.10638403  -1.5121426   -0.98820935]
mat_Sqrt:  [[ 8.29639696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.71461928e-05  2.91109151e-02 -1.43770812e-01]
Stock Position:  -9.714619279164354e-05
Bond Position:  [5.42310986]


portfolio before change:  [5.41399894]
curr_Stock_Price:  100.76415436776905
curr_Factors:  [100.76415437  -1.45543167  -0.995625  ]
mat_Sqrt:  [[ 8.68611709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02841495 -0.03708715 -0.25190493]
Stock Position:  -0.02841494607734989
Bond Position:  [8.27720695]


portfolio before change:  [5.4313639]
curr_Stock_Price:  100.18944812422556
curr_Factors:  [100.18944812  -1.36534583  -0.98273914]
mat_Sqrt:  [[ 9.57329931  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11084261  0.49717823 -0.80382675]
Stock Position:  0.11084261386667041
Bond Position:  [-5.67389641]


portfolio before change:  [5.46719011]
curr_Stock_Price:  100.51906410170605
curr_Factors:  [100.5190641   -1.3811515   -1.00560979]
mat_Sqrt:  [[ 9.24040865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056805  0.01081165 -0.16722895]
Stock Position:  -0.0005680489339376759
Bond Position:  [5.52428986]


portfolio before change:  [5.46824184]
curr_Stock_Price:  99.88330497044929
curr_Factors:  [99.88330497 -1.37276203 -1.01618043]
mat_Sqrt:  [[ 9.16195972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.44464544e-02 -1.81299550e-03 -2.08857449e+00]
Stock Position:  -0.05444645443938391
Bond Position:  [10.90653365]


portfolio before change:  [5.44295954]
curr_Stock_Price:  100.37269766448922
curr_Factors:  [100.37269766  -1.63532612  -1.01061505]
mat_Sqrt:  [[ 7.12029436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.24811351 -1.14688697  8.53038976]
Stock Position:  0.24811350669537868
Bond Position:  [-19.46086245]


portfolio before change:  [5.57510311]
curr_Stock_Price:  100.91509590653436
curr_Factors:  [100.91509591  -1.5454104   -0.99669542]
mat_Sqrt:  [[ 7.94206812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138958 -0.02878175  0.09670412]
Stock Position:  0.0013895760308486737
Bond Position:  [5.43487391]


portfolio before change:  [5.57616453]
curr_Stock_Price:  101.19001368588124
curr_Factors:  [101.19001369  -1.28755349  -0.99874199]
mat_Sqrt:  [[10.28518594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01092254 -0.01006834 -0.03478283]
Stock Position:  0.010922544730939999
Bond Position:  [4.47091208]


portfolio before change:  [5.5808048]
curr_Stock_Price:  101.56367824748216
curr_Factors:  [101.56367825  -1.18637648  -1.02677054]
mat_Sqrt:  [[11.10659361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01241678 -0.03420499 -0.12888948]
Stock Position:  -0.012416776525374552
Bond Position:  [6.84189829]


portfolio before change:  [5.57732653]
curr_Stock_Price:  101.91268691252769
curr_Factors:  [101.91268691  -1.03264927  -1.0346552 ]
mat_Sqrt:  [[12.89464317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0515205  -0.56290086 -0.57188709]
Stock Position:  -0.051520496485932994
Bond Position:  [10.82791875]


portfolio before change:  [5.56812785]
curr_Stock_Price:  102.1175034738663
curr_Factors:  [102.11750347  -1.19682932  -1.03078613]
mat_Sqrt:  [[11.00674972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.003414   0.01301793 0.55493096]
Stock Position:  0.0034139975957402334
Bond Position:  [5.21949894]


portfolio before change:  [5.57153756]
curr_Stock_Price:  102.92513026383467
curr_Factors:  [102.92513026  -1.26842881  -1.02082565]
mat_Sqrt:  [[10.43063734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02933754 -0.08949688  1.0456334 ]
Stock Position:  0.029337544108884842
Bond Position:  [2.55196702]


portfolio before change:  [5.58184769]
curr_Stock_Price:  103.2656872724242
curr_Factors:  [103.26568727  -1.37889064  -1.02027735]
mat_Sqrt:  [[ 9.37584931  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00493077 -0.03914031 -0.10840396]
Stock Position:  0.0049307713844730485
Bond Position:  [5.07266819]


portfolio before change:  [5.57689194]
curr_Stock_Price:  102.13201695752836
curr_Factors:  [102.13201696  -0.95246527  -1.03060468]
mat_Sqrt:  [[14.05806588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00951693 -0.01756897 -0.04908791]
Stock Position:  0.00951693190346093
Bond Position:  [4.60490849]


portfolio before change:  [5.5805915]
curr_Stock_Price:  102.46026463415082
curr_Factors:  [102.46026463  -0.92250357  -1.02100044]
mat_Sqrt:  [[14.67244228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01395653 0.05923393 0.45627349]
Stock Position:  0.01395653489663164
Bond Position:  [4.15060124]


portfolio before change:  [5.57994339]
curr_Stock_Price:  102.37665015759669
curr_Factors:  [102.37665016  -0.99115404  -1.02566113]
mat_Sqrt:  [[13.62414378  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01788236  0.03125636  0.05311679]
Stock Position:  -0.017882356843531524
Bond Position:  [7.41067918]


portfolio before change:  [5.57088561]
curr_Stock_Price:  102.93497560520869
curr_Factors:  [102.93497561  -1.02912309  -1.03432169]
mat_Sqrt:  [[13.07435529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00520075 -0.06134461  0.20267475]
Stock Position:  -0.005200753349174036
Bond Position:  [6.10622503]


portfolio before change:  [5.57089745]
curr_Stock_Price:  103.07947045615735
curr_Factors:  [103.07947046  -1.17668479  -1.03027875]
mat_Sqrt:  [[11.3422729   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00594945 -0.0052654  -0.01329527]
Stock Position:  0.005949451790798846
Bond Position:  [4.95763111]


portfolio before change:  [5.57205314]
curr_Stock_Price:  103.16955398566016
curr_Factors:  [103.16955399  -1.05209567  -0.98236121]
mat_Sqrt:  [[13.48957162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03549828 -0.02101862  0.68196046]
Stock Position:  0.03549828465593933
Bond Position:  [1.90971095]


portfolio before change:  [5.59109162]
curr_Stock_Price:  103.69915004938835
curr_Factors:  [103.69915005  -1.34051952  -0.96767398]
mat_Sqrt:  [[10.31191906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00075037 -0.03997484 -0.04292333]
Stock Position:  0.000750373888311195
Bond Position:  [5.51327849]


portfolio before change:  [5.59139532]
curr_Stock_Price:  103.18539776918361
curr_Factors:  [103.18539777  -1.38179642  -0.94280987]
mat_Sqrt:  [[10.09379681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279465 -0.02474814 -0.01755485]
Stock Position:  -0.0027946468113532663
Bond Position:  [5.87976206]


portfolio before change:  [5.59357661]
curr_Stock_Price:  102.66788260793969
curr_Factors:  [102.66788261  -1.26042385  -0.93936214]
mat_Sqrt:  [[11.37836049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01370497 -0.01910941  0.20826161]
Stock Position:  0.013704965080151399
Bond Position:  [4.18651686]


portfolio before change:  [5.58977277]
curr_Stock_Price:  102.35214428012209
curr_Factors:  [102.35214428  -1.18757676  -0.90756348]
mat_Sqrt:  [[12.59473696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267691 -0.01396109 -0.13920133]
Stock Position:  -0.002676908942488807
Bond Position:  [5.86376014]


portfolio before change:  [5.59098122]
curr_Stock_Price:  102.17453772848322
curr_Factors:  [102.17453773  -0.95390013  -0.89405808]
mat_Sqrt:  [[16.09847097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189099  0.0073299  -0.15143248]
Stock Position:  -0.0018909942123267248
Bond Position:  [5.78419268]


portfolio before change:  [5.59182171]
curr_Stock_Price:  102.11244682165096
curr_Factors:  [102.11244682  -1.04126206  -0.86654447]
mat_Sqrt:  [[15.15405421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00567422 -0.01595664  0.04828862]
Stock Position:  -0.005674216153746668
Bond Position:  [6.1712298]


portfolio before change:  [5.60175575]
curr_Stock_Price:  100.49766983967007
curr_Factors:  [100.49766984  -1.02622921  -0.8173283 ]
mat_Sqrt:  [[15.90410151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01027132 0.00214699 0.07793454]
Stock Position:  0.01027132164549323
Bond Position:  [4.56951186]


portfolio before change:  [5.60158184]
curr_Stock_Price:  100.42512399460682
curr_Factors:  [100.42512399  -1.0866466   -0.83041791]
mat_Sqrt:  [[14.76630513  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00550284 -0.00618355  0.14491412]
Stock Position:  -0.005502842426922612
Bond Position:  [6.15420547]


portfolio before change:  [5.60115815]
curr_Stock_Price:  100.6419229653201
curr_Factors:  [100.64192297  -0.9738104   -0.87042077]
mat_Sqrt:  [[15.91620434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00922564 -0.02052484 -0.2427845 ]
Stock Position:  -0.009225635851368905
Bond Position:  [6.52964388]


portfolio before change:  [5.59697891]
curr_Stock_Price:  101.18340244771738
curr_Factors:  [101.18340245  -1.03720492  -0.84773846]
mat_Sqrt:  [[15.36345072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.19771149 0.54834835 0.51880068]
Stock Position:  0.1977114945697952
Bond Position:  [-14.40814281]


portfolio before change:  [5.61854968]
curr_Stock_Price:  101.30161458135991
curr_Factors:  [101.30161458  -1.10819277  -0.84651004]
mat_Sqrt:  [[14.34497263  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00346204 -0.04251855 -0.15133012]
Stock Position:  -0.003462041983799336
Bond Position:  [5.96926012]


portfolio before change:  [5.6172398]
curr_Stock_Price:  101.89550915313183
curr_Factors:  [101.89550915  -1.19355653  -0.83186981]
mat_Sqrt:  [[13.44384703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00095142 -0.00430725 -0.26280114]
Stock Position:  0.0009514182321095934
Bond Position:  [5.52029455]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.61821035]
Stock Price:  102.19030253007439
PL:  [3.42790782]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 4.47040749e-02 -3.32195143e-02 -6.49842929e-02]
 [ 7.31590727e-01  2.03525417e-01  2.03740771e-01]
 [-3.87835481e-01 -2.70524157e-01  4.11092309e-02]
 [ 2.52800259e-01  1.78719089e+00  1.59933052e+00]
 [-5.10506032e-02 -1.51437692e-02  8.71479584e-03]
 [-4.24041727e-02  3.64718408e-01 -1.69818248e-01]
 [-1.77013307e-01  2.87562250e-01  2.39464384e-01]
 [-5.12969965e-02  6.92760111e-02  2.43082847e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.24296066e-02 -4.48011423e-02 -1.02629311e-02]
 [ 5.79169416e-01  1.20196994e+00 -1.81156867e-01]
 [ 4.42201034e-06  3.48523697e-02 -5.90268655e-02]
 [-4.28501488e-01 -1.33311560e-02 -8.99097479e-01]
 [ 2.07974168e+00 -3.64691302e+00  3.08357528e+00]
 [ 2.33882999e-02 -4.95761390e-02 -1.36969523e-03]
 [ 4.97173699e-02  1.11632960e-01 -6.57426557e-02]
 [-3.37214844e-02  4.49650573e-02 -7.91039492e-02]
 [-2.74792371e-01 -1.76656668e+00 -1.93400823e-01]
 [-3.89046255e-02  2.04647192e-01  4.94499643e-01]
 [ 2.20385584e-01  3.34079535e-01  5.77473645e-01]
 [ 4.08096977e-02 -1.44522745e-01 -1.03585749e-02]
 [ 9.93443715e-02 -4.94397288e-02  1.41071613e-02]
 [-3.69367945e-02  6.65980664e-02  7.53816582e-03]
 [-4.75664526e-02 -4.73223201e-02 -3.83707837e-02]
 [ 3.80470563e-02 -4.67636287e-02  4.43453503e-03]
 [ 3.74041563e-02 -4.38533329e-02  2.76014443e-01]
 [ 6.19230805e-02 -1.13226809e-01  2.98129913e-02]
 [ 2.94788011e-02 -1.46753611e-01 -6.19223357e-02]
 [ 2.36121427e-02 -5.02457395e-02  3.07837969e-02]
 [ 1.01356394e-02  6.01828027e-02  9.55075363e-03]
 [ 2.76033990e-02 -1.44349707e-02 -7.54278948e-02]
 [-5.71785395e-02  1.83175575e-02 -4.27522228e-02]
 [-1.14942009e-01 -2.91151509e-02  4.27737100e-02]
 [ 1.65515698e-01  4.92889543e-03  3.00860017e-02]
 [-9.44218896e-02 -7.70754836e-03  5.39778137e-02]
 [-1.18701690e-01 -6.90124666e-02 -8.17557533e-02]
 [ 1.71276496e+00  1.11926445e+00  1.46980462e-01]
 [ 2.03858730e-03 -1.04600744e-01 -1.15520342e-02]
 [ 3.32294908e-02 -1.41666674e-02 -7.39338521e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.3122152]
curr_Stock_Price:  99.71403704180373
curr_Factors:  [99.71403704 -1.23955212 -0.97891201]
mat_Sqrt:  [[10.84649871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227339 -0.01072155 -0.1853821 ]
Stock Position:  0.002273388617190941
Bond Position:  [0.08552644]


portfolio before change:  [0.31113264]
curr_Stock_Price:  99.23314915916197
curr_Factors:  [99.23314916 -1.07884395 -0.97383937]
mat_Sqrt:  [[12.74053706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06394735 0.06568755 0.58121571]
Stock Position:  0.06394735053078743
Bond Position:  [-6.03456433]


portfolio before change:  [0.28603524]
curr_Stock_Price:  98.85247609109462
curr_Factors:  [98.85247609 -0.91908463 -0.97672002]
mat_Sqrt:  [[14.84738788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02927549 -0.0873113   0.11727319]
Stock Position:  -0.02927549344245552
Bond Position:  [3.17999026]


portfolio before change:  [0.3037914]
curr_Stock_Price:  98.25953513928737
curr_Factors:  [98.25953514 -1.11056355 -0.9849891 ]
mat_Sqrt:  [[12.08614376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07811185 0.57681338 4.5624448 ]
Stock Position:  0.07811184979402502
Bond Position:  [-7.37144265]


portfolio before change:  [0.24793235]
curr_Stock_Price:  97.55621596779051
curr_Factors:  [97.55621597 -1.07808362 -1.02959807]
mat_Sqrt:  [[11.85496883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00441696 -0.00488763  0.02486089]
Stock Position:  -0.004416959047845858
Bond Position:  [0.67883417]


portfolio before change:  [0.24798602]
curr_Stock_Price:  97.56327922946606
curr_Factors:  [97.56327923 -0.98101716 -1.04084255]
mat_Sqrt:  [[12.91825564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.02840394e-04  1.17712360e-01 -4.84444192e-01]
Stock Position:  -0.00020284039414415352
Bond Position:  [0.26777579]


portfolio before change:  [0.2480688]
curr_Stock_Price:  97.32019137552015
curr_Factors:  [97.32019138 -1.03518266 -1.06279312]
mat_Sqrt:  [[11.94163115  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00581449  0.09281032  0.68312523]
Stock Position:  -0.005814485923761694
Bond Position:  [0.81393568]


portfolio before change:  [0.24554069]
curr_Stock_Price:  97.77248456727828
curr_Factors:  [97.77248457 -1.38264007 -1.04988084]
mat_Sqrt:  [[ 8.58590825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374965  0.02235874  0.06934477]
Stock Position:  -0.0037496536374569565
Bond Position:  [0.61215365]


portfolio before change:  [0.24509]
curr_Stock_Price:  97.91308800227392
curr_Factors:  [97.913088   -1.45796926 -1.0546467 ]
mat_Sqrt:  [[ 7.93643568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00655095  0.0064198  -0.11330016]
Stock Position:  0.006550951262315663
Bond Position:  [-0.39633386]


portfolio before change:  [0.24549504]
curr_Stock_Price:  97.98247897024416
curr_Factors:  [97.98247897 -1.57712646 -1.0262998 ]
mat_Sqrt:  [[ 7.25261739  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01429408 -0.01445951 -0.02927729]
Stock Position:  -0.014294082810742448
Bond Position:  [1.6460647]


portfolio before change:  [0.24433639]
curr_Stock_Price:  98.07793197809119
curr_Factors:  [98.07793198 -1.79853006 -1.02919802]
mat_Sqrt:  [[ 5.80102313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.13575916  0.38793413 -0.51679012]
Stock Position:  0.1357591572767063
Bond Position:  [-13.070641]


portfolio before change:  [0.27457665]
curr_Stock_Price:  98.31271677133654
curr_Factors:  [98.31271677 -1.8057719  -1.01740768]
mat_Sqrt:  [[ 5.84141932  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.000844    0.01124855 -0.16838722]
Stock Position:  -0.0008440031431693617
Bond Position:  [0.35755289]


portfolio before change:  [0.27422748]
curr_Stock_Price:  98.7793785182244
curr_Factors:  [98.77937852 -1.78646878 -1.01792027]
mat_Sqrt:  [[ 5.98047395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10279289 -0.00430261 -2.56487485]
Stock Position:  -0.10279289036636186
Bond Position:  [10.42804531]


portfolio before change:  [0.29198503]
curr_Stock_Price:  98.6193093971376
curr_Factors:  [98.6193094  -1.8136234  -1.02994376]
mat_Sqrt:  [[ 5.74138183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.34220871 -1.17703612  8.79658197]
Stock Position:  0.3422087055216568
Bond Position:  [-33.45640117]


portfolio before change:  [0.41435909]
curr_Stock_Price:  98.98913156970502
curr_Factors:  [98.98913157 -1.81487815 -1.02407196]
mat_Sqrt:  [[ 5.78958113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00224352 -0.01600063 -0.00390736]
Stock Position:  0.00224351722380841
Bond Position:  [0.19227527]


portfolio before change:  [0.41360666]
curr_Stock_Price:  98.64303683426861
curr_Factors:  [98.64303683 -1.65734839 -0.99603468]
mat_Sqrt:  [[ 6.9457126   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00850664  0.03602938 -0.1875455 ]
Stock Position:  0.008506641804453626
Bond Position:  [-0.42551432]


portfolio before change:  [0.41632472]
curr_Stock_Price:  98.96881265427356
curr_Factors:  [98.96881265 -1.90900728 -1.01160538]
mat_Sqrt:  [[ 5.33448377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00762774  0.01451241 -0.22566155]
Stock Position:  -0.00762774024678316
Bond Position:  [1.17123312]


portfolio before change:  [0.41515021]
curr_Stock_Price:  99.14198709152461
curr_Factors:  [99.14198709 -1.92910594 -0.99158704]
mat_Sqrt:  [[ 5.34338878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12629982 -0.57015694 -0.55171872]
Stock Position:  -0.12629982375927937
Bond Position:  [12.9367657]


portfolio before change:  [0.42798093]
curr_Stock_Price:  99.05320210605466
curr_Factors:  [99.05320211 -1.99995189 -0.97821879]
mat_Sqrt:  [[ 5.04040494  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0205952  0.0660496  1.41066984]
Stock Position:  0.020595195423634284
Bond Position:  [-1.61203912]


portfolio before change:  [0.42925963]
curr_Stock_Price:  99.12507382316107
curr_Factors:  [99.12507382 -1.81191724 -0.97233717]
mat_Sqrt:  [[ 6.12346444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06637674 0.10782371 1.64737157]
Stock Position:  0.06637673840747671
Bond Position:  [-6.15033947]


portfolio before change:  [0.42047528]
curr_Stock_Price:  99.00431611345466
curr_Factors:  [99.00431611 -1.61382574 -0.98968338]
mat_Sqrt:  [[ 7.32764604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125479 -0.04664452 -0.02955013]
Stock Position:  0.001254793241500113
Bond Position:  [0.29624534]


portfolio before change:  [0.42131865]
curr_Stock_Price:  99.64691945429384
curr_Factors:  [99.64691945 -1.58052602 -0.98359965]
mat_Sqrt:  [[ 7.67146395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01200972 -0.0159566   0.0402438 ]
Stock Position:  0.012009720954912494
Bond Position:  [-0.77541305]


portfolio before change:  [0.42146325]
curr_Stock_Price:  99.66703103366503
curr_Factors:  [99.66703103 -1.35118447 -0.96624775]
mat_Sqrt:  [[ 9.81981927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00222039  0.02149443  0.02150429]
Stock Position:  -0.0022203870453836676
Bond Position:  [0.64276264]


portfolio before change:  [0.42233169]
curr_Stock_Price:  99.31209996059256
curr_Factors:  [99.31209996 -1.30369101 -0.97049161]
mat_Sqrt:  [[10.21732481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00636747 -0.01527321 -0.10946117]
Stock Position:  -0.006367467554317256
Bond Position:  [1.05469826]


portfolio before change:  [0.42217823]
curr_Stock_Price:  99.35690661570051
curr_Factors:  [99.35690662 -1.02700392 -0.97719323]
mat_Sqrt:  [[13.39017639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00219614 -0.0150929   0.01265049]
Stock Position:  0.002196137328531548
Bond Position:  [0.20397681]


portfolio before change:  [0.42044471]
curr_Stock_Price:  98.555946402422
curr_Factors:  [98.5559464  -0.98238768 -0.99169155]
mat_Sqrt:  [[13.68835042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0061946  -0.0141536   0.78739238]
Stock Position:  0.006194599201967781
Bond Position:  [-0.19006988]


portfolio before change:  [0.41867259]
curr_Stock_Price:  98.2737068655008
curr_Factors:  [98.27370687 -1.0174932  -1.01696879]
mat_Sqrt:  [[12.84936664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349405 -0.0365438   0.08504817]
Stock Position:  0.003494048183434613
Bond Position:  [0.07529952]


portfolio before change:  [0.4204172]
curr_Stock_Price:  98.77032460349011
curr_Factors:  [98.7703246  -1.32762466 -1.01802998]
mat_Sqrt:  [[ 9.46066391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138648 -0.04736452 -0.17664719]
Stock Position:  -0.0013864775523348043
Bond Position:  [0.55736004]


portfolio before change:  [0.42038517]
curr_Stock_Price:  98.84368526502024
curr_Factors:  [98.84368527 -1.26985056 -1.0152917 ]
mat_Sqrt:  [[10.05829236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00195257 -0.01621674  0.0878176 ]
Stock Position:  0.001952567055410164
Bond Position:  [0.22738624]


portfolio before change:  [0.42093309]
curr_Stock_Price:  99.10974529552043
curr_Factors:  [99.1097453  -1.35310727 -1.04491105]
mat_Sqrt:  [[ 9.00886826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00270511 0.01942392 0.02724564]
Stock Position:  0.002705105825167885
Bond Position:  [0.15283074]


portfolio before change:  [0.42042714]
curr_Stock_Price:  98.91564862988353
curr_Factors:  [98.91564863 -1.37908298 -1.02616662]
mat_Sqrt:  [[ 8.92644177  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103739 -0.00465887 -0.21517479]
Stock Position:  0.0010373919028956765
Bond Position:  [0.31781285]


portfolio before change:  [0.42025912]
curr_Stock_Price:  98.71538484609705
curr_Factors:  [98.71538485 -1.46860441 -1.00675424]
mat_Sqrt:  [[ 8.30520273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00748522  0.00591197 -0.12196019]
Stock Position:  -0.007485217000836973
Bond Position:  [1.1591652]


portfolio before change:  [0.41349671]
curr_Stock_Price:  99.63817931531275
curr_Factors:  [99.63817932 -1.18274939 -1.02959722]
mat_Sqrt:  [[10.90475361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01028487 -0.00939687  0.12202149]
Stock Position:  -0.01028486941076812
Bond Position:  [1.43826237]


portfolio before change:  [0.41469612]
curr_Stock_Price:  99.53904161096504
curr_Factors:  [99.53904161 -1.12034306 -1.04894932]
mat_Sqrt:  [[11.37317566  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01518161 0.00159079 0.08582699]
Stock Position:  0.015181607104355043
Bond Position:  [-1.0964665]


portfolio before change:  [0.40951705]
curr_Stock_Price:  99.20692873190724
curr_Factors:  [99.20692873 -1.18060401 -1.06657392]
mat_Sqrt:  [[10.48588348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00810394 -0.0024876   0.15398368]
Stock Position:  -0.008103943877745856
Bond Position:  [1.21348443]


portfolio before change:  [0.41119295]
curr_Stock_Price:  99.01884607913593
curr_Factors:  [99.01884608 -0.87220743 -1.06561568]
mat_Sqrt:  [[14.26040883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01048197 -0.02227368 -0.23322641]
Stock Position:  -0.010481966261039078
Bond Position:  [1.44910516]


portfolio before change:  [0.41427768]
curr_Stock_Price:  98.74183936230966
curr_Factors:  [98.74183936 -0.67489119 -1.06174613]
mat_Sqrt:  [[17.38958468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11335729 0.36124105 0.41929435]
Stock Position:  0.11335728611313985
Bond Position:  [-10.77882926]


portfolio before change:  [0.35096502]
curr_Stock_Price:  98.19520293901734
curr_Factors:  [98.19520294 -1.05744447 -1.07382248]
mat_Sqrt:  [[11.65447712  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185946 -0.03375974 -0.03295474]
Stock Position:  -0.0018594570136257205
Bond Position:  [0.53355478]


portfolio before change:  [0.34982004]
curr_Stock_Price:  98.8468318508682
curr_Factors:  [98.84683185 -1.01201175 -1.05105224]
mat_Sqrt:  [[12.55987879  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00121387 -0.00457227 -0.2109127 ]
Stock Position:  0.0012138690037986797
Bond Position:  [0.22983294]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.34997442]
Stock Price:  98.95034206149244
PL:  [0.34997442]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-1.31121485e-02 -5.80221121e-02  2.03087856e-01]
 [ 8.96141105e-01  2.18094023e-01  2.47823254e-01]
 [-1.45802304e-01 -4.77376152e-02  3.40494682e-02]
 [ 1.48389080e-01  1.15507685e+00  9.54129638e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.68343686e-02 -6.74615433e-02  5.56999636e-02]
 [-3.26364248e-02 -1.16211570e-01 -9.43807711e-04]
 [ 1.59451281e-01  3.70608051e-02 -1.44079789e-01]
 [-1.66139252e-02  9.85122061e-02 -5.16610827e-02]
 [-3.99533058e-01 -3.48915934e-02 -1.65742067e-01]
 [ 5.02807398e-01  9.79565659e-01 -1.74108789e-01]
 [-2.59413221e-04  1.70158088e-02 -5.75252922e-02]
 [-9.69206562e-02 -3.22557286e-02 -3.43658156e-01]
 [ 1.80029403e+00 -3.50544213e+00  2.99774188e+00]
 [ 6.58484014e-03 -9.18294954e-02  3.55304631e-02]
 [ 1.09037290e-01 -5.67752570e-02  8.50714038e-03]
 [-1.21773380e-01 -1.34901814e-01 -3.61270845e-02]
 [-2.62074678e-01 -1.70762880e+00 -1.98272600e-01]
 [-3.60446809e-02  1.70118181e-01  3.66680033e-01]
 [ 2.93362106e-01 -1.46937367e-01  4.60007544e-01]
 [ 6.24164616e-02 -1.06078033e-01 -1.53547915e-02]
 [ 1.45666371e-01 -5.41381554e-02 -1.59845609e-02]
 [ 5.78623111e-02  1.50303993e-01  1.05329528e-01]
 [-1.22213885e-01  1.76648362e-02 -4.82424766e-03]
 [ 9.67114216e-03 -7.42852220e-02  2.24725051e-02]
 [-4.30581565e-04 -3.07767211e-02  1.69457882e-01]
 [ 4.76910007e-01 -1.01842396e-01  2.27280790e-01]
 [ 1.35098510e-01 -2.99870814e-01 -1.96385489e-01]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 5.50602285e-02  2.92682010e-03  8.80361666e-02]
 [-1.61614314e-02 -1.59675022e-02 -6.68979842e-02]
 [-3.11519646e-02  2.23724763e-02 -5.10961303e-02]
 [-1.03150931e-01 -3.69398415e-02  3.19362739e-02]
 [ 2.37641466e-01  1.70875218e-02  4.67682633e-02]
 [-8.72373527e-02 -1.63397638e-02  4.92289051e-02]
 [-1.11872466e-01 -5.76567413e-02 -8.64816678e-02]
 [ 2.22574242e+00  1.43601272e+00  1.66127361e-01]
 [-1.21686513e-02 -1.31439138e-01 -5.04959955e-02]
 [ 3.40051338e-02 -1.36002459e-02 -8.66520274e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.87274403]
curr_Stock_Price:  100.47283569987373
curr_Factors:  [100.4728357   -0.79069334  -1.0139091 ]
mat_Sqrt:  [[16.5317862   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099803 -0.01872656  0.57935312]
Stock Position:  0.00099803325546909
Bond Position:  [5.7724688]


portfolio before change:  [5.87295724]
curr_Stock_Price:  99.96344468680626
curr_Factors:  [99.96344469 -0.82077051 -0.9995223 ]
mat_Sqrt:  [[16.19191034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0612186  0.07038954 0.70697076]
Stock Position:  0.06121859926095817
Bond Position:  [-0.24666482]


portfolio before change:  [5.92405967]
curr_Stock_Price:  100.79870173816998
curr_Factors:  [100.79870174  -1.2512154   -1.0227548 ]
mat_Sqrt:  [[10.372471    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01432604 -0.01540725  0.09713366]
Stock Position:  -0.014326035263398401
Bond Position:  [7.36810543]


portfolio before change:  [5.93045149]
curr_Stock_Price:  100.41682744201667
curr_Factors:  [100.41682744  -1.02322373  -1.00987699]
mat_Sqrt:  [[13.14746657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04403351 0.37279945 2.72186628]
Stock Position:  0.0440335061508859
Bond Position:  [1.5087465]


portfolio before change:  [5.94049151]
curr_Stock_Price:  100.64055279648085
curr_Factors:  [100.6405528   -1.24153508  -1.01317496]
mat_Sqrt:  [[10.55759222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00555487 -0.01106097 -0.05874131]
Stock Position:  -0.005554865136805815
Bond Position:  [6.4995362]


portfolio before change:  [5.9373469]
curr_Stock_Price:  101.35291961618745
curr_Factors:  [101.35291962  -1.12192102  -1.01731476]
mat_Sqrt:  [[11.93377834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00539926 -0.02177312  0.15889649]
Stock Position:  0.005399257832064421
Bond Position:  [5.39011635]


portfolio before change:  [5.94219222]
curr_Stock_Price:  102.12552846668034
curr_Factors:  [102.12552847  -1.21623148  -1.02103685]
mat_Sqrt:  [[10.9018707   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00518724 -0.03750712 -0.00269242]
Stock Position:  -0.005187244248771015
Bond Position:  [6.47194228]


portfolio before change:  [5.94144589]
curr_Stock_Price:  102.42537399698854
curr_Factors:  [102.425374    -1.43444005  -1.01624497]
mat_Sqrt:  [[ 8.83260027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01557934  0.01196132 -0.41101953]
Stock Position:  0.015579344546755277
Bond Position:  [4.3457257]


portfolio before change:  [5.94263557]
curr_Stock_Price:  102.46686693591055
curr_Factors:  [102.46686694  -1.68739402  -1.02193213]
mat_Sqrt:  [[ 6.82241384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103343  0.03179468 -0.14737469]
Stock Position:  -0.0010334289059100296
Bond Position:  [6.04852779]


portfolio before change:  [5.94361682]
curr_Stock_Price:  102.24901793519834
curr_Factors:  [102.24901794  -1.57609515  -1.01149038]
mat_Sqrt:  [[ 7.68926856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05728597 -0.01126121 -0.47281598]
Stock Position:  -0.05728597315196817
Bond Position:  [11.80105131]


portfolio before change:  [5.90574027]
curr_Stock_Price:  102.93595343205884
curr_Factors:  [102.93595343  -1.83074611  -1.03317832]
mat_Sqrt:  [[ 5.87192523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11362893  0.31615346 -0.49668391]
Stock Position:  0.11362893208676529
Bond Position:  [-5.79076219]


portfolio before change:  [5.8890011]
curr_Stock_Price:  102.79500973515664
curr_Factors:  [102.79500974  -1.79130861  -1.01486026]
mat_Sqrt:  [[ 6.21252825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137277  0.00549183 -0.16410365]
Stock Position:  -0.0013727707231150472
Bond Position:  [6.03011508]


portfolio before change:  [5.88945958]
curr_Stock_Price:  103.01014289301
curr_Factors:  [103.01014289  -1.76015237  -1.00309484]
mat_Sqrt:  [[ 6.49855761  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02672189 -0.01041049 -0.98036106]
Stock Position:  -0.02672189226797867
Bond Position:  [8.64208552]


portfolio before change:  [5.90140501]
curr_Stock_Price:  102.60354360065006
curr_Factors:  [102.6035436   -1.91867536  -0.98585924]
mat_Sqrt:  [[ 5.6200349   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.30189495 -1.13137658  8.55172317]
Stock Position:  0.30189494973271097
Bond Position:  [-25.07408663]


portfolio before change:  [5.88736295]
curr_Stock_Price:  102.56741313613718
curr_Factors:  [102.56741314  -1.83017239  -1.00623307]
mat_Sqrt:  [[ 6.01414867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00081593 -0.02963784  0.10135852]
Stock Position:  -0.0008159345538165846
Bond Position:  [5.97105125]


portfolio before change:  [5.88827794]
curr_Stock_Price:  102.36082594600407
curr_Factors:  [102.36082595  -2.04301901  -1.0047467 ]
mat_Sqrt:  [[ 4.85854185  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02041448 -0.01832414  0.0242685 ]
Stock Position:  0.02041447935318889
Bond Position:  [3.79863497]


portfolio before change:  [5.88507657]
curr_Stock_Price:  102.1807464767662
curr_Factors:  [102.18074648  -1.86207231  -1.02051733]
mat_Sqrt:  [[ 5.72105729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02738733 -0.04353937 -0.10306052]
Stock Position:  -0.0273873341065213
Bond Position:  [8.68353481]


portfolio before change:  [5.88390671]
curr_Stock_Price:  102.263097497716
curr_Factors:  [102.2630975   -1.59709016  -1.00294049]
mat_Sqrt:  [[ 7.59521343  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08572704 -0.55113483 -0.56561654]
Stock Position:  -0.0857270410163716
Bond Position:  [14.65061946]


portfolio before change:  [5.84899534]
curr_Stock_Price:  102.69169975413371
curr_Factors:  [102.69169975  -1.82122598  -0.97850166]
mat_Sqrt:  [[ 6.24638975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01177141 0.05490541 1.04603607]
Stock Position:  0.011771406969819053
Bond Position:  [4.64016955]


portfolio before change:  [5.84697081]
curr_Stock_Price:  102.47043551545369
curr_Factors:  [102.47043552  -1.50922528  -0.97656459]
mat_Sqrt:  [[ 8.53166421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04187545 -0.04742383  1.31227348]
Stock Position:  0.04187545123854205
Bond Position:  [1.55597508]


portfolio before change:  [5.83855864]
curr_Stock_Price:  102.26490516147368
curr_Factors:  [102.26490516  -1.27276602  -0.96619738]
mat_Sqrt:  [[10.89826005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00345276 -0.03423654 -0.04380295]
Stock Position:  0.0034527612660724574
Bond Position:  [5.48546234]


portfolio before change:  [5.83863213]
curr_Stock_Price:  102.08758638447267
curr_Factors:  [102.08758638  -1.4926391   -0.97148376]
mat_Sqrt:  [[ 8.68596303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0151224  -0.01747301 -0.0455995 ]
Stock Position:  0.01512240282483541
Bond Position:  [4.29482252]


portfolio before change:  [5.83332457]
curr_Stock_Price:  101.70111061637938
curr_Factors:  [101.70111062  -1.31495142  -0.95272372]
mat_Sqrt:  [[10.53141901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01044905 0.04851041 0.30047583]
Stock Position:  0.010449046320354455
Bond Position:  [4.77064496]


portfolio before change:  [5.82878987]
curr_Stock_Price:  101.2100543581594
curr_Factors:  [101.21005436  -1.28018578  -0.99075715]
mat_Sqrt:  [[10.44637649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01144826  0.0057013  -0.01376224]
Stock Position:  -0.011448257802301314
Bond Position:  [6.98746867]


portfolio before change:  [5.83337821]
curr_Stock_Price:  100.88556366993218
curr_Factors:  [100.88556367  -1.38113512  -0.98649683]
mat_Sqrt:  [[ 9.453215    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.57435516e-05 -2.39754523e-02  6.41078020e-02]
Stock Position:  -9.574355160859301e-05
Bond Position:  [5.84303736]


portfolio before change:  [5.83411343]
curr_Stock_Price:  100.83550083953394
curr_Factors:  [100.83550084  -1.50853704  -0.96670812]
mat_Sqrt:  [[ 8.48453696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00328569 -0.00993314  0.48341617]
Stock Position:  0.0032856939517816606
Bond Position:  [5.50279884]


portfolio before change:  [5.83709929]
curr_Stock_Price:  101.53488692293833
curr_Factors:  [101.53488692  -1.47812527  -0.96744845]
mat_Sqrt:  [[ 8.8006778   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05709958 -0.03286949  0.64836883]
Stock Position:  0.057099580721806355
Bond Position:  [0.03949982]


portfolio before change:  [5.81725573]
curr_Stock_Price:  101.18727484033352
curr_Factors:  [101.18727484  -1.55866241  -0.96669698]
mat_Sqrt:  [[ 8.09797167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00417396 -0.09678289 -0.56023314]
Stock Position:  0.004173960788239199
Bond Position:  [5.39490401]


portfolio before change:  [5.8171151]
curr_Stock_Price:  100.99200934814543
curr_Factors:  [100.99200935  -1.47844979  -0.95371647]
mat_Sqrt:  [[ 8.8717772   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249094 -0.02321455 -0.0028026 ]
Stock Position:  -0.0024909363630480166
Bond Position:  [6.06867977]


portfolio before change:  [5.81685759]
curr_Stock_Price:  101.39994624264048
curr_Factors:  [101.39994624  -1.08532988  -0.95775354]
mat_Sqrt:  [[13.14431237  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00560151 0.00094463 0.25114268]
Stock Position:  0.005601507964461649
Bond Position:  [5.24886498]


portfolio before change:  [5.81571578]
curr_Stock_Price:  101.07896938160734
curr_Factors:  [101.07896938  -1.16029049  -0.96169163]
mat_Sqrt:  [[12.10864866  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273162 -0.00515349 -0.19084133]
Stock Position:  -0.0027316242225621165
Bond Position:  [6.09182554]


portfolio before change:  [5.8186036]
curr_Stock_Price:  100.30057285885978
curr_Factors:  [100.30057286  -0.99466069  -0.94581905]
mat_Sqrt:  [[14.4066754   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00256931  0.00722069 -0.14576304]
Stock Position:  -0.0025693058894709323
Bond Position:  [6.07630645]


portfolio before change:  [5.81796317]
curr_Stock_Price:  100.84547130088714
curr_Factors:  [100.8454713   -1.10004305  -0.9458554 ]
mat_Sqrt:  [[13.03568908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00799131 -0.01192228  0.0911053 ]
Stock Position:  -0.007991313640514565
Bond Position:  [6.62385096]


portfolio before change:  [5.81883121]
curr_Stock_Price:  100.84046483478078
curr_Factors:  [100.84046483  -1.27133974  -0.93430031]
mat_Sqrt:  [[11.11060055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02256187 0.00551497 0.13341684]
Stock Position:  0.022561874388179203
Bond Position:  [3.54368131]


portfolio before change:  [5.80820588]
curr_Stock_Price:  100.34988835514066
curr_Factors:  [100.34988836  -1.10574366  -0.91702808]
mat_Sqrt:  [[13.27511486  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00606578 -0.00527364  0.14043636]
Stock Position:  -0.006065776881536048
Bond Position:  [6.41690591]


portfolio before change:  [5.80477918]
curr_Stock_Price:  101.04705592466063
curr_Factors:  [101.04705592  -1.16951742  -0.93657588]
mat_Sqrt:  [[12.29869318  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01148859 -0.01860863 -0.24670813]
Stock Position:  -0.011488586144501952
Bond Position:  [6.96566698]


portfolio before change:  [5.8115629]
curr_Stock_Price:  100.53237480809088
curr_Factors:  [100.53237481  -1.14335862  -0.95831433]
mat_Sqrt:  [[12.29025726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.20770744 0.46347111 0.47391512]
Stock Position:  0.2077074415154809
Bond Position:  [-15.06975946]


portfolio before change:  [5.66973361]
curr_Stock_Price:  99.85861246663204
curr_Factors:  [99.85861247 -1.22626902 -0.96894327]
mat_Sqrt:  [[11.1177511   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00443489 -0.0424218  -0.14405102]
Stock Position:  -0.004434890154893245
Bond Position:  [6.11259558]


portfolio before change:  [5.66721211]
curr_Stock_Price:  100.59946899883793
curr_Factors:  [100.599469    -1.19692215  -0.9696601 ]
mat_Sqrt:  [[11.52553186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117489 -0.00438946 -0.24719411]
Stock Position:  0.0011748893084044594
Bond Position:  [5.54901887]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.66729984]
Stock Price:  100.08372691339588
PL:  [5.58357293]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.38353074e-01 -2.11891833e-02 -1.91129651e-01]
 [ 1.42701726e+00  2.92692455e-01  4.48020973e-01]
 [ 5.16363726e-02  1.45837722e-01  3.42162187e-02]
 [ 7.67225268e-02  6.57368898e-01  5.00892128e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-8.78595005e-02 -5.95311343e-02 -3.23969590e-02]
 [-3.21888650e-02 -1.19266517e-01  2.13006366e-03]
 [ 1.92552581e-01 -5.53010878e-02 -1.77924580e-01]
 [-4.45139923e-03  8.53503874e-02 -4.96614659e-02]
 [-3.97048491e-01 -1.26488561e-02 -1.58164582e-01]
 [ 6.59350358e-01  1.27765436e+00 -2.28324570e-01]
 [-2.43295565e-04  2.42533144e-02 -5.78824990e-02]
 [-2.17591442e-01 -8.80285136e-03 -4.58223093e-01]
 [ 1.66455607e+00 -3.19908923e+00  2.68256185e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.39022013e-01 -3.02410761e-02 -1.61753128e-02]
 [-5.37765596e-03  2.08997892e-01 -5.52412926e-02]
 [-2.84271075e-01 -1.83883140e+00 -2.00006118e-01]
 [ 2.04154953e-02 -1.79286156e-02  1.67648111e-02]
 [ 8.41106152e-02  1.59828660e-01  2.50959516e-01]
 [ 2.86957513e-02 -2.90170025e-02  3.38908673e-02]
 [ 1.10898770e-01 -5.10892095e-02  3.17082793e-02]
 [ 1.81538807e-01  7.73217114e-02  9.72354879e-02]
 [-2.01933015e-01  6.80914044e-02  6.16176809e-02]
 [-3.89991869e-02 -2.05769133e-01  7.24745546e-02]
 [ 7.98310052e-02 -1.45800937e-02  4.30445689e-02]
 [ 2.11893472e-01 -7.56691673e-02  9.12336417e-02]
 [-7.32580552e-02  4.91857660e-02  1.21289895e-01]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [-2.03207589e-04  4.08511812e-02  9.52259338e-02]
 [-2.06951883e-02 -1.47608366e-02 -6.59378972e-02]
 [-5.68095523e-03  1.95626979e-02 -5.71701518e-02]
 [-9.13525436e-02 -3.66794550e-02  3.79549374e-02]
 [ 2.33462741e-01  1.34136559e-02  4.37061625e-02]
 [ 9.94016560e-02 -8.38364938e-04 -3.68712397e-02]
 [-1.02353953e-01 -3.72522335e-02 -1.05530417e-01]
 [ 1.85616147e+00  1.29145999e+00  1.68642980e-01]
 [-2.92526107e-02 -3.90406040e-02 -3.13354927e-02]
 [ 3.50609012e-02 -1.34557918e-02 -1.05586207e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.96940448]
curr_Stock_Price:  100.62248773971676
curr_Factors:  [100.62248774  -1.23128975  -1.00695032]
mat_Sqrt:  [[10.73098875  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00885414 -0.00683878 -0.54523969]
Stock Position:  0.008854139668141364
Bond Position:  [6.07847892]


portfolio before change:  [6.97272354]
curr_Stock_Price:  100.91152827105874
curr_Factors:  [100.91152827  -1.1306188   -0.99514411]
mat_Sqrt:  [[12.04297215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.13104861 0.09446608 1.27807913]
Stock Position:  0.13104860969733736
Bond Position:  [-6.25159194]


portfolio before change:  [7.03061042]
curr_Stock_Price:  101.35921235145324
curr_Factors:  [101.35921235  -1.42765867  -0.98979935]
mat_Sqrt:  [[ 9.03596525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00978199 0.04706892 0.09760935]
Stock Position:  0.009781990842934813
Bond Position:  [6.03911554]


portfolio before change:  [7.03761724]
curr_Stock_Price:  101.99833335296778
curr_Factors:  [101.99833335  -1.61401201  -1.00153166]
mat_Sqrt:  [[ 7.45893618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04198341 0.2121649  1.42890582]
Stock Position:  0.04198340907243161
Bond Position:  [2.75537948]


portfolio before change:  [7.04853169]
curr_Stock_Price:  102.25009967487952
curr_Factors:  [102.25009967  -1.61549211  -1.00716761]
mat_Sqrt:  [[ 7.42432708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00789917 -0.01106097 -0.05874131]
Stock Position:  -0.00789916719311839
Bond Position:  [7.85622232]


portfolio before change:  [7.04771027]
curr_Stock_Price:  102.47841610324562
curr_Factors:  [102.4784161   -1.62094506  -0.99840376]
mat_Sqrt:  [[ 7.46558191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01428211 -0.01921359 -0.09241951]
Stock Position:  -0.014282107571478922
Bond Position:  [8.51131803]


portfolio before change:  [7.04236604]
curr_Stock_Price:  102.92710374589089
curr_Factors:  [102.92710375  -1.4978083   -1.01021792]
mat_Sqrt:  [[ 8.38123085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00669344 -0.0384931   0.00607648]
Stock Position:  -0.006693437331714786
Bond Position:  [7.73130216]


portfolio before change:  [7.0440553]
curr_Stock_Price:  102.81911935414564
curr_Factors:  [102.81911935  -1.62379607  -1.02182164]
mat_Sqrt:  [[ 7.29619954  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0198659  -0.01784835 -0.5075693 ]
Stock Position:  0.019865902847035294
Bond Position:  [5.00146067]


portfolio before change:  [7.0469422]
curr_Stock_Price:  102.93296663237048
curr_Factors:  [102.93296663  -1.40548619  -1.0310344 ]
mat_Sqrt:  [[ 9.00299567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00031474  0.02754672 -0.14167034]
Stock Position:  0.0003147365020279409
Bond Position:  [7.01454544]


portfolio before change:  [7.04771498]
curr_Stock_Price:  102.60223880321774
curr_Factors:  [102.6022388   -1.32573939  -1.02546313]
mat_Sqrt:  [[ 9.77332984  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04419329 -0.0040824  -0.45119953]
Stock Position:  -0.044193293907909756
Bond Position:  [11.58204588]


portfolio before change:  [7.06790931]
curr_Stock_Price:  102.17804594787273
curr_Factors:  [102.17804595  -1.22420301  -0.98793309]
mat_Sqrt:  [[11.18507981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07809903  0.41236117 -0.65134645]
Stock Position:  0.07809903176513729
Bond Position:  [-0.91209715]


portfolio before change:  [7.06731472]
curr_Stock_Price:  102.17189264697886
curr_Factors:  [102.17189265  -1.34812595  -0.98440747]
mat_Sqrt:  [[ 9.91573799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071682  0.00782772 -0.16512266]
Stock Position:  -0.0007168225039393025
Bond Position:  [7.14055384]


portfolio before change:  [7.0684931]
curr_Stock_Price:  101.77326009623364
curr_Factors:  [101.7732601   -1.21057009  -0.99212302]
mat_Sqrt:  [[11.24646987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02782408 -0.00284111 -1.30718294]
Stock Position:  -0.02782408327117067
Bond Position:  [9.90024076]


portfolio before change:  [7.06539792]
curr_Stock_Price:  101.92898097915493
curr_Factors:  [101.92898098  -1.00497172  -1.00725607]
mat_Sqrt:  [[13.62693728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11441458 -1.03250161  7.65260227]
Stock Position:  0.11441458364230295
Bond Position:  [-4.596764]


portfolio before change:  [7.07188519]
curr_Stock_Price:  101.9907030550711
curr_Factors:  [101.99070306  -0.85820107  -1.02440221]
mat_Sqrt:  [[15.52231059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139601 -0.03053791  0.10625201]
Stock Position:  -0.001396014643574302
Bond Position:  [7.2142657]


portfolio before change:  [7.07404095]
curr_Stock_Price:  101.09248599136437
curr_Factors:  [101.09248599  -0.5009247   -1.02853906]
mat_Sqrt:  [[21.90187051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0059149  -0.00976027 -0.04614366]
Stock Position:  0.00591489695071648
Bond Position:  [6.47608932]


portfolio before change:  [7.057204]
curr_Stock_Price:  98.10908463579236
curr_Factors:  [98.10908464 -0.40992659 -1.05451429]
mat_Sqrt:  [[22.68352949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114655  0.06745378 -0.15758803]
Stock Position:  0.001146549018990604
Bond Position:  [6.94471713]


portfolio before change:  [7.05923523]
curr_Stock_Price:  99.12350497718856
curr_Factors:  [99.12350498 -0.39168367 -1.04429162]
mat_Sqrt:  [[23.57982115  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02970536 -0.59348028 -0.57056178]
Stock Position:  -0.029705358538184137
Bond Position:  [10.00373448]


portfolio before change:  [7.09674708]
curr_Stock_Price:  97.90280595973299
curr_Factors:  [97.90280596 -0.48257018 -1.01151897]
mat_Sqrt:  [[21.97457407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091824 -0.00578644  0.04782534]
Stock Position:  0.0009182400826789882
Bond Position:  [7.0068488]


portfolio before change:  [7.09798635]
curr_Stock_Price:  98.29852453917897
curr_Factors:  [98.29852454 -0.62157352 -0.99765501]
mat_Sqrt:  [[19.46816354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00862754 0.05158448 0.71591764]
Stock Position:  0.008627542093759728
Bond Position:  [6.24991169]


portfolio before change:  [7.09860028]
curr_Stock_Price:  98.27912607557751
curr_Factors:  [98.27912608 -0.68729916 -1.01504231]
mat_Sqrt:  [[17.91198767  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165758 -0.0093652   0.09668121]
Stock Position:  0.0016575840367788568
Bond Position:  [6.93569437]


portfolio before change:  [7.09928968]
curr_Stock_Price:  98.17197354241947
curr_Factors:  [98.17197354 -0.66320586 -1.01410023]
mat_Sqrt:  [[18.34605724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00582919 -0.01648897  0.0904549 ]
Stock Position:  0.005829190023308118
Bond Position:  [6.52702659]


portfolio before change:  [7.11192024]
curr_Stock_Price:  100.19877841354726
curr_Factors:  [100.19877841  -0.71712641  -1.02900883]
mat_Sqrt:  [[17.47935988  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01242438 0.02495548 0.27738578]
Stock Position:  0.012424376392855783
Bond Position:  [5.8670129]


portfolio before change:  [7.14471519]
curr_Stock_Price:  102.77931289068425
curr_Factors:  [102.77931289  -1.10370965  -1.06405984]
mat_Sqrt:  [[11.76130141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0149181   0.02197641  0.17577809]
Stock Position:  -0.014918099031727975
Bond Position:  [8.67798716]


portfolio before change:  [7.15210255]
curr_Stock_Price:  102.3568369865353
curr_Factors:  [102.35683699  -0.60974864  -1.06895413]
mat_Sqrt:  [[19.10141354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00346612 -0.0664117   0.20674973]
Stock Position:  -0.003466121950782418
Bond Position:  [7.50688383]


portfolio before change:  [7.15316645]
curr_Stock_Price:  102.32063512739751
curr_Factors:  [102.32063513  -0.42197362  -1.07540486]
mat_Sqrt:  [[22.89074968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00374131 -0.00470571  0.12279417]
Stock Position:  0.0037413056823898216
Bond Position:  [6.77035367]


portfolio before change:  [7.15148228]
curr_Stock_Price:  101.64426340466024
curr_Factors:  [101.6442634   -0.51762798  -1.07612681]
mat_Sqrt:  [[20.65018588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01041495 -0.02442212  0.26026419]
Stock Position:  0.010414945311506559
Bond Position:  [6.09286284]


portfolio before change:  [7.1564226]
curr_Stock_Price:  102.0454813440281
curr_Factors:  [102.04548134  -0.45319262  -1.06957894]
mat_Sqrt:  [[22.25678834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172801  0.01587464  0.34600631]
Stock Position:  -0.0017280056786080655
Bond Position:  [7.33275777]


portfolio before change:  [7.15766492]
curr_Stock_Price:  101.8570182321505
curr_Factors:  [101.85701823  -0.46043073  -1.04620214]
mat_Sqrt:  [[22.57712391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00097882 -0.02321455 -0.0028026 ]
Stock Position:  -0.0009788240747875614
Bond Position:  [7.25736502]


portfolio before change:  [7.1590933]
curr_Stock_Price:  101.32458390665025
curr_Factors:  [101.32458391  -0.67339313  -1.061544  ]
mat_Sqrt:  [[17.87480059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00154259 0.01318466 0.27165308]
Stock Position:  0.0015425860028615971
Bond Position:  [7.00279142]


portfolio before change:  [7.15949819]
curr_Stock_Price:  101.01956308682874
curr_Factors:  [101.01956309  -0.56522715  -1.08269111]
mat_Sqrt:  [[19.4412273   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019118  -0.00476404 -0.18810247]
Stock Position:  -0.0019118005155770712
Bond Position:  [7.35262744]


portfolio before change:  [7.16175822]
curr_Stock_Price:  100.31818373161451
curr_Factors:  [100.31818373  -0.43841823  -1.08326714]
mat_Sqrt:  [[21.90383204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060983  0.00631383 -0.16309053]
Stock Position:  -0.0006098268362177954
Bond Position:  [7.22293494]


portfolio before change:  [7.16263606]
curr_Stock_Price:  100.35930946152148
curr_Factors:  [100.35930946  -0.28137569  -1.08784035]
mat_Sqrt:  [[25.52199924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00356916 -0.01183824  0.10827487]
Stock Position:  -0.0035691634466311693
Bond Position:  [7.52083484]


portfolio before change:  [7.15821556]
curr_Stock_Price:  101.86124901377487
curr_Factors:  [101.86124901  -0.16557375  -1.09720499]
mat_Sqrt:  [[28.81317785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0085073  0.00432924 0.12468152]
Stock Position:  0.008507297463181991
Bond Position:  [6.29165161]


portfolio before change:  [7.15927848]
curr_Stock_Price:  101.89374027465418
curr_Factors:  [101.89374027  -0.21609869  -1.10340526]
mat_Sqrt:  [[27.23292069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0033674  -0.00027058 -0.10518338]
Stock Position:  0.003367402864800193
Bond Position:  [6.8161612]


portfolio before change:  [7.16093836]
curr_Stock_Price:  102.13363115279334
curr_Factors:  [102.13363115  -0.19607858  -1.09823851]
mat_Sqrt:  [[27.99329402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00469753 -0.01202311 -0.30104891]
Stock Position:  -0.0046975300507169256
Bond Position:  [7.64071416]


portfolio before change:  [7.15540578]
curr_Stock_Price:  103.51472530281139
curr_Factors:  [103.5147253   -0.42461622  -1.09872479]
mat_Sqrt:  [[22.56438697  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09546919 0.41681692 0.48109148]
Stock Position:  0.09546918992751571
Bond Position:  [-2.72706119]


portfolio before change:  [7.03284022]
curr_Stock_Price:  102.23447296493573
curr_Factors:  [102.23447296  -0.47707123  -1.09755335]
mat_Sqrt:  [[21.17125464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206025 -0.0126003  -0.08939144]
Stock Position:  -0.0020602497128097332
Bond Position:  [7.24346876]


portfolio before change:  [7.03530611]
curr_Stock_Price:  101.47708915539599
curr_Factors:  [101.47708916  -0.64435096  -1.06722778]
mat_Sqrt:  [[18.32478131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00058727 -0.00434284 -0.30120806]
Stock Position:  0.0005872678544078423
Bond Position:  [6.97571188]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.03660718]
Stock Price:  102.20768561765053
PL:  [4.82892157]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-3.00547800e-02 -6.88586503e-02  2.19641255e-01]
 [ 8.69429993e-01  2.14955405e-01  2.36106296e-01]
 [-3.54320975e-01 -2.39674747e-01  4.01316606e-02]
 [ 2.36592513e-01  1.35434854e+00  1.43571479e+00]
 [-5.51096443e-02  6.40247324e-03  4.17269418e-02]
 [-6.87532453e-02  5.31374842e-01 -2.69921613e-01]
 [-6.76840964e-02 -2.88007111e-02  4.04977785e-02]
 [-2.60535466e-02  4.52040711e-02  3.26085363e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 5.84207421e-01  1.40401830e+00 -1.34414194e-01]
 [-2.04739887e-03 -3.26118318e-02  2.52383551e-01]
 [-4.86315376e-01 -1.45732645e-01 -1.41813296e+00]
 [ 2.09090920e+00 -3.06930031e+00  2.61370337e+00]
 [-1.83775134e-02  7.55459973e-02 -3.69699797e-02]
 [ 4.86883730e-03  5.80843391e-01 -3.11630359e-01]
 [ 4.67702300e-03 -1.39335857e-01 -2.88591394e-01]
 [-3.16392759e-01 -1.99914973e+00 -1.91839533e-01]
 [ 7.05470415e-02 -2.30472210e-01  8.56992571e-02]
 [-6.65512865e-01  3.54627960e-01  1.65431017e-01]
 [ 7.25210873e-04  3.03411296e-01 -2.07548517e-01]
 [-1.17583422e-02 -2.93826512e-02 -1.08898097e-02]
 [ 1.80899777e-01 -1.90737932e-01 -1.99120317e-01]
 [-2.67200784e-01  9.68442785e-02  1.86196888e-02]
 [ 2.06291554e-01 -9.29417443e-02 -7.23523369e-02]
 [-9.20765119e-02 -6.65859911e-02  1.05588173e-01]
 [-5.25914561e-03  3.11701407e-02  9.97810633e-02]
 [-3.62548937e-01  2.66480102e-01  4.64012867e-01]
 [ 3.93461104e-01  3.78920215e-01  5.19561490e-01]
 [-1.02028830e-01  3.47631565e-02 -4.45844263e-01]
 [ 2.31712447e-01  5.77762477e-02  1.73202436e-01]
 [ 1.50697961e-01 -1.08943999e-02 -8.22720452e-02]
 [ 2.32200224e-01  1.83381132e-01  2.15900388e-01]
 [ 2.21516335e-02  1.10662391e-02  1.01234496e-01]
 [-9.74670788e-02  1.64954386e-01  2.86460254e-02]
 [-7.16734051e-02 -4.10595995e-02 -3.63023942e-02]
 [ 1.96277778e+00  1.32728705e+00  1.66772113e-01]
 [ 3.45961828e-01 -5.26905413e-01  1.10315196e-01]
 [ 2.40899149e-02 -1.44382572e-02  3.03635732e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.5661686]
curr_Stock_Price:  99.88515352821592
curr_Factors:  [99.88515353 -0.82253355 -1.01502044]
mat_Sqrt:  [[15.90235273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.55020953e-05 -2.22240338e-02  6.26575365e-01]
Stock Position:  4.5502095321606185e-05
Bond Position:  [1.56162361]


portfolio before change:  [1.56636931]
curr_Stock_Price:  100.00599245984542
curr_Factors:  [100.00599246  -0.73431632  -1.01490556]
mat_Sqrt:  [[17.39196345  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0552843  0.06937656 0.67354554]
Stock Position:  0.05528430300061544
Bond Position:  [-3.96239228]


portfolio before change:  [1.52634105]
curr_Stock_Price:  99.29090839779842
curr_Factors:  [99.2909084  -0.56069816 -1.02412766]
mat_Sqrt:  [[20.35299739  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01941004 -0.07735469  0.11448446]
Stock Position:  -0.01941004214888699
Bond Position:  [3.45358177]


portfolio before change:  [1.53931061]
curr_Stock_Price:  98.64496275534715
curr_Factors:  [98.64496276 -0.54807465 -1.00197251]
mat_Sqrt:  [[20.93620619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03850324 0.43711411 4.09569468]
Stock Position:  0.03850324166494707
Bond Position:  [-2.25884023]


portfolio before change:  [1.47951142]
curr_Stock_Price:  97.09920137956486
curr_Factors:  [97.09920138 -0.52794824 -1.00070999]
mat_Sqrt:  [[21.05367061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215094  0.00206639  0.11903535]
Stock Position:  -0.0021509440997519755
Bond Position:  [1.68836637]


portfolio before change:  [1.48047355]
curr_Stock_Price:  96.75001819761069
curr_Factors:  [96.7500182  -0.50396954 -0.96651217]
mat_Sqrt:  [[22.2345816   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.91909957e-04  1.71500493e-01 -7.70011230e-01]
Stock Position:  -0.0006919099569520835
Bond Position:  [1.54741585]


portfolio before change:  [1.48030464]
curr_Stock_Price:  97.2737034809051
curr_Factors:  [97.27370348 -0.31248566 -0.94334662]
mat_Sqrt:  [[27.70731356  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00235665 -0.00929539  0.11552889]
Stock Position:  -0.0023566500745531376
Bond Position:  [1.70954472]


portfolio before change:  [1.48004177]
curr_Stock_Price:  97.47593025043459
curr_Factors:  [97.47593025 -0.28369861 -0.93590315]
mat_Sqrt:  [[28.78929787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035326  0.01458955  0.09302308]
Stock Position:  -0.0003532602527312331
Bond Position:  [1.51447614]


portfolio before change:  [1.48065329]
curr_Stock_Price:  96.28077587383547
curr_Factors:  [96.28077587 -0.44310823 -0.93299345]
mat_Sqrt:  [[24.31678846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213808  0.0064198  -0.11330016]
Stock Position:  0.0021380785304747425
Bond Position:  [1.27479743]


portfolio before change:  [1.47738573]
curr_Stock_Price:  94.67797132333887
curr_Factors:  [94.67797132 -0.37921803 -0.9166524 ]
mat_Sqrt:  [[25.90953196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.37354317e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  3.373543173969754e-05
Bond Position:  [1.47419173]


portfolio before change:  [1.47756968]
curr_Stock_Price:  94.6681136818267
curr_Factors:  [94.66811368 -0.62950237 -0.92127292]
mat_Sqrt:  [[20.07754336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04200535  0.45314496 -0.38344628]
Stock Position:  0.04200535187004404
Bond Position:  [-2.49899774]


portfolio before change:  [1.45533185]
curr_Stock_Price:  94.1461459201369
curr_Factors:  [94.14614592 -0.77675382 -0.88530567]
mat_Sqrt:  [[17.86402344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239662 -0.01052542  0.71998002]
Stock Position:  0.00239662221576597
Bond Position:  [1.22969911]


portfolio before change:  [1.45041051]
curr_Stock_Price:  92.02855733428513
curr_Factors:  [92.02855733 -0.70553257 -0.87426465]
mat_Sqrt:  [[18.95943544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04248745 -0.04703501 -4.0455386 ]
Stock Position:  -0.04248745214755118
Bond Position:  [5.36046944]


portfolio before change:  [1.49529662]
curr_Stock_Price:  90.9878733973974
curr_Factors:  [90.9878734  -0.46583265 -0.87345597]
mat_Sqrt:  [[23.8417351   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08379889 -0.99061242  7.45616821]
Stock Position:  0.08379888711682837
Bond Position:  [-6.12938591]


portfolio before change:  [1.54662967]
curr_Stock_Price:  91.6095912694082
curr_Factors:  [ 9.16095913e+01 -8.68903505e-02 -8.77495817e-01]
mat_Sqrt:  [[34.92314559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030075  0.02438237 -0.10546506]
Stock Position:  -0.00030075231119623626
Bond Position:  [1.57418146]


portfolio before change:  [1.54688016]
curr_Stock_Price:  91.43100892173868
curr_Factors:  [ 9.14310089e+01 -1.81609368e-02 -8.62472876e-01]
mat_Sqrt:  [[37.89999098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00157841  0.1874664  -0.88899467]
Stock Position:  0.0015784098067356817
Bond Position:  [1.40256456]


portfolio before change:  [1.54392611]
curr_Stock_Price:  89.44838905064661
curr_Factors:  [ 8.94483891e+01  1.91581207e-02 -8.88958823e-01]
mat_Sqrt:  [[37.48201052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220568 -0.04497045 -0.82327092]
Stock Position:  -0.0022056784098138725
Bond Position:  [1.74122049]


portfolio before change:  [1.53820034]
curr_Stock_Price:  92.14299447129063
curr_Factors:  [ 9.21429945e+01 -3.20640017e-02 -8.92238436e-01]
mat_Sqrt:  [[36.56308849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02088518 -0.6452228  -0.54726479]
Stock Position:  -0.02088517688885828
Bond Position:  [3.46262308]


portfolio before change:  [1.6038958]
curr_Stock_Price:  89.01816530836587
curr_Factors:  [89.01816531 -0.28118981 -0.90804782]
mat_Sqrt:  [[27.1018724   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00151264 -0.07438459  0.24447613]
Stock Position:  0.0015126403703270327
Bond Position:  [1.46924333]


portfolio before change:  [1.60358441]
curr_Stock_Price:  88.6908850348336
curr_Factors:  [ 8.86908850e+01  8.31251498e-03 -9.09941114e-01]
mat_Sqrt:  [[36.00034506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01553753  0.11445568  0.47192864]
Stock Position:  -0.015537525271957588
Bond Position:  [2.98162128]


portfolio before change:  [1.59891418]
curr_Stock_Price:  89.01545182340281
curr_Factors:  [89.01545182 -0.14347876 -0.91798283]
mat_Sqrt:  [[30.7948781   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065898  0.09792557 -0.59207815]
Stock Position:  0.000658977071028595
Bond Position:  [1.54025503]


portfolio before change:  [1.59788976]
curr_Stock_Price:  87.16871261097667
curr_Factors:  [87.16871261 -0.27398981 -0.91474481]
mat_Sqrt:  [[26.55215317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075244 -0.00948321 -0.0310656 ]
Stock Position:  -0.0007524408197890852
Bond Position:  [1.66347906]


portfolio before change:  [1.59984797]
curr_Stock_Price:  84.84259447895958
curr_Factors:  [84.84259448 -0.23729961 -0.9082663 ]
mat_Sqrt:  [[26.98366818  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00375487 -0.0615604  -0.56803484]
Stock Position:  0.0037548747910941664
Bond Position:  [1.28127466]


portfolio before change:  [1.60097924]
curr_Stock_Price:  85.10121639551633
curr_Factors:  [85.1012164  -0.25922095 -0.9207296 ]
mat_Sqrt:  [[26.1510875   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00931632  0.03125636  0.05311679]
Stock Position:  -0.0093163162223864
Bond Position:  [2.39380908]


portfolio before change:  [1.60156039]
curr_Stock_Price:  85.07095723803779
curr_Factors:  [85.07095724 -0.19566305 -0.91914804]
mat_Sqrt:  [[27.90133697  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00618433 -0.02999682 -0.20640108]
Stock Position:  0.006184328775938061
Bond Position:  [1.07545362]


portfolio before change:  [1.60724826]
curr_Stock_Price:  85.96894273243683
curr_Factors:  [85.96894273 -0.38233421 -0.92641755]
mat_Sqrt:  [[23.22511734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362174 -0.02149054  0.30121367]
Stock Position:  -0.0036217351919112374
Bond Position:  [1.91860501]


portfolio before change:  [1.60768672]
curr_Stock_Price:  85.91410271191741
curr_Factors:  [85.91410271 -0.70675341 -0.90253244]
mat_Sqrt:  [[17.18543356  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00124938 0.01006012 0.2846476 ]
Stock Position:  0.0012493811632999358
Bond Position:  [1.50034726]


portfolio before change:  [1.60701795]
curr_Stock_Price:  85.22870263455033
curr_Factors:  [85.22870263 -0.72856943 -0.92066534]
mat_Sqrt:  [[16.38069479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01302983  0.08600608  1.32369955]
Stock Position:  -0.013029830938232496
Bond Position:  [2.71753354]


portfolio before change:  [1.6061339]
curr_Stock_Price:  85.32262254031757
curr_Factors:  [85.32262254 -0.48318513 -0.94485676]
mat_Sqrt:  [[20.45848548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02819676 0.12229597 1.48216431]
Stock Position:  0.02819675554860223
Bond Position:  [-0.79968723]


portfolio before change:  [1.59012788]
curr_Stock_Price:  84.75851325116501
curr_Factors:  [84.75851325 -0.39787575 -0.93517813]
mat_Sqrt:  [[22.34834588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0083201   0.01121976 -1.27186958]
Stock Position:  -0.00832009715771887
Bond Position:  [2.29532695]


portfolio before change:  [1.56822203]
curr_Stock_Price:  87.42588485972679
curr_Factors:  [87.42588486 -0.53130628 -0.94132051]
mat_Sqrt:  [[20.04870599  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01390917 0.0186472  0.49409834]
Stock Position:  0.01390916569591919
Bond Position:  [0.35220091]


portfolio before change:  [1.60269654]
curr_Stock_Price:  89.9012661453843
curr_Factors:  [89.90126615 -0.78318619 -0.93884027]
mat_Sqrt:  [[16.065684    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00819638 -0.00351615 -0.23469924]
Stock Position:  0.008196379294505526
Bond Position:  [0.86583167]


portfolio before change:  [1.59323451]
curr_Stock_Price:  88.73364456511406
curr_Factors:  [88.73364457 -0.6794753  -0.94579961]
mat_Sqrt:  [[17.4678879   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01795885 0.05918601 0.61590371]
Stock Position:  0.017958852543165725
Bond Position:  [-0.00031993]


portfolio before change:  [1.59235124]
curr_Stock_Price:  88.68446374909911
curr_Factors:  [88.68446375 -0.5680487  -0.92698848]
mat_Sqrt:  [[19.88662787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00226659 0.00357161 0.28879384]
Stock Position:  0.0022665946885195958
Bond Position:  [1.3913395]


portfolio before change:  [1.59235876]
curr_Stock_Price:  88.611045679791
curr_Factors:  [88.61104568 -0.45671737 -0.94284558]
mat_Sqrt:  [[21.86076715  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026508   0.0532388   0.08171914]
Stock Position:  -0.002650801779580725
Bond Position:  [1.82724907]


portfolio before change:  [1.59253771]
curr_Stock_Price:  88.6297059832371
curr_Factors:  [88.62970598 -0.5975484  -0.92607655]
mat_Sqrt:  [[19.31423009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00452852 -0.01325193 -0.10356063]
Stock Position:  -0.004528518898301541
Bond Position:  [1.99389901]


portfolio before change:  [1.59522316]
curr_Stock_Price:  88.09173953999931
curr_Factors:  [88.09173954 -0.61646014 -0.9067415 ]
mat_Sqrt:  [[19.20512399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11808054 0.42838005 0.47575442]
Stock Position:  0.11808053587703644
Bond Position:  [-8.80669666]


portfolio before change:  [1.47839979]
curr_Stock_Price:  87.11170964219771
curr_Factors:  [87.11170964 -0.59552499 -0.90560048]
mat_Sqrt:  [[19.41538602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01343912 -0.17005799  0.31469855]
Stock Position:  0.013439120186041691
Bond Position:  [0.30769506]


portfolio before change:  [1.49185674]
curr_Stock_Price:  88.11017403246362
curr_Factors:  [88.11017403 -0.51283965 -0.91935916]
mat_Sqrt:  [[21.03923864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129951 -0.00465993  0.08661882]
Stock Position:  0.0012995078823016149
Bond Position:  [1.37735688]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.49221713]
Stock Price:  88.25500046203219
PL:  [1.49221713]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-1.13177437e-02 -9.71241122e-02  1.09988983e-01]
 [ 7.49610243e-01  1.98121214e-01  2.06701598e-01]
 [-3.20287646e-01 -2.08347770e-01  3.91389569e-02]
 [ 1.76888985e-01  1.41836320e+00  1.14756310e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 3.02550938e-02 -7.96131450e-02  6.42216269e-02]
 [-1.09074828e-01  1.58763109e-01  4.04381789e-02]
 [-6.34330807e-02  1.25943358e-01  6.51462416e-04]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-1.23551284e-01 -6.41263533e-02 -3.17743499e-02]
 [ 7.89411577e-01  1.58799630e+00 -2.57577238e-01]
 [-7.73603585e-04  1.76707761e-02  5.30777729e-02]
 [-3.04402789e-01  1.53975857e-03 -6.57502737e-01]
 [ 1.63533163e+00 -3.13866770e+00  2.63077744e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.43915957e-01 -6.99254602e-02  1.15484441e-02]
 [-6.10800116e-02 -1.05254309e-02 -6.66834458e-02]
 [-2.82375067e-01 -1.82876690e+00 -2.00270845e-01]
 [ 1.30094623e-03  3.72499194e-02  5.83893053e-02]
 [ 2.43581163e-01 -3.58412697e-01  1.49317841e-01]
 [ 5.47923136e-02  5.88226985e-02  3.40818172e-03]
 [-6.76333365e-02 -5.22267113e-02 -1.15813294e-01]
 [ 4.59828195e-01  3.74876689e-01  3.74418070e-01]
 [-1.72646315e-02  8.13614397e-02  1.47883564e-01]
 [-1.36919387e-01 -4.46572612e-01  1.53211383e-01]
 [ 1.93341979e-01 -6.13792318e-02 -2.17067681e-01]
 [ 3.97010305e-01  4.29832758e-02  3.05151590e-01]
 [-6.09457050e-02  5.90710964e-02  1.07949775e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 5.70087084e-01 -2.01264726e-01 -2.07782855e-01]
 [-7.57895873e-03 -1.42995683e-01  1.90277660e-02]
 [-3.81749225e-01 -1.03245472e-01  2.28880827e-01]
 [-3.71756895e-02  1.82926526e-02 -8.31867712e-02]
 [ 7.21490346e-01  1.54828296e-01  2.55774270e-01]
 [ 3.03438709e-01  6.04659980e-01 -3.38304812e-01]
 [-1.32259728e-01  7.21506437e-02 -3.03174960e-02]
 [ 3.07512131e+00  2.25887243e+00  2.56010095e-01]
 [-8.15634598e-02 -6.44525530e-02 -3.68874893e-03]
 [ 3.99963662e-02 -1.14416396e-02 -2.30995366e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.14417296]
curr_Stock_Price:  99.69110572874239
curr_Factors:  [99.69110573 -0.94987889 -0.98574844]
mat_Sqrt:  [[14.38878575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060406 -0.03134667  0.31376795]
Stock Position:  -0.0006040615959635952
Bond Position:  [0.20439252]


portfolio before change:  [0.14450358]
curr_Stock_Price:  99.1860743435536
curr_Factors:  [99.18607434 -1.17328422 -1.00591104]
mat_Sqrt:  [[11.22117219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07416733 0.06394335 0.58966213]
Stock Position:  0.07416732762350846
Bond Position:  [-7.2118625]


portfolio before change:  [0.15287027]
curr_Stock_Price:  99.31103818801306
curr_Factors:  [99.31103819 -1.20240925 -1.0044413 ]
mat_Sqrt:  [[10.92885108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03246702 -0.06724395  0.11165255]
Stock Position:  -0.03246702217792556
Bond Position:  [3.37720395]


portfolio before change:  [0.13531462]
curr_Stock_Price:  99.86476386736521
curr_Factors:  [99.86476387 -1.19620383 -0.97365344]
mat_Sqrt:  [[11.40394833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06143982 0.45777475 3.2736781 ]
Stock Position:  0.061439816881641525
Bond Position:  [-6.00035818]


portfolio before change:  [0.14006442]
curr_Stock_Price:  99.95428060089245
curr_Factors:  [99.9542806  -1.28708277 -0.96162244]
mat_Sqrt:  [[10.54875317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00555952 -0.01106097 -0.05874131]
Stock Position:  -0.005559519690545685
Bond Position:  [0.69576222]


portfolio before change:  [0.14005039]
curr_Stock_Price:  99.97245004942259
curr_Factors:  [99.97245005 -1.25296898 -0.96928006]
mat_Sqrt:  [[10.83352633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00250272 -0.02569503  0.18320643]
Stock Position:  0.002502722797221792
Bond Position:  [-0.11015294]


portfolio before change:  [0.13820524]
curr_Stock_Price:  99.24069799608787
curr_Factors:  [99.240698   -1.2146315  -0.95436935]
mat_Sqrt:  [[11.34239351  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00603162  0.05124057  0.11535887]
Stock Position:  -0.0060316224178699205
Bond Position:  [0.73678766]


portfolio before change:  [0.14189435]
curr_Stock_Price:  98.64434051030794
curr_Factors:  [98.64434051 -1.21129442 -0.93154429]
mat_Sqrt:  [[11.57308511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324823  0.04064804  0.00185844]
Stock Position:  -0.00324822818748207
Bond Position:  [0.46231368]


portfolio before change:  [0.14358034]
curr_Stock_Price:  98.1430848305183
curr_Factors:  [98.14308483 -1.05300314 -0.91627759]
mat_Sqrt:  [[13.69657402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00379593  0.0064198  -0.11330016]
Stock Position:  0.0037959275987595625
Bond Position:  [-0.22896371]


portfolio before change:  [0.14816158]
curr_Stock_Price:  99.35750855295345
curr_Factors:  [99.35750855 -1.06877075 -0.92150174]
mat_Sqrt:  [[13.57801653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01054108 -0.02069669 -0.09064338]
Stock Position:  -0.010541078161902796
Bond Position:  [1.19549684]


portfolio before change:  [0.16048101]
curr_Stock_Price:  98.20297897763204
curr_Factors:  [98.20297898 -0.93439365 -0.91591666]
mat_Sqrt:  [[15.43636731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06873264  0.5125236  -0.73479617]
Stock Position:  0.06873263693101611
Bond Position:  [-6.58926869]


portfolio before change:  [0.21116005]
curr_Stock_Price:  98.95229907564698
curr_Factors:  [98.95229908 -0.84291474 -0.92292142]
mat_Sqrt:  [[16.92516799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00080755 0.00570322 0.15141611]
Stock Position:  0.0008075478782057061
Bond Position:  [0.13125133]


portfolio before change:  [0.21178144]
curr_Stock_Price:  99.70145652021921
curr_Factors:  [99.70145652 -0.79891327 -0.9285347 ]
mat_Sqrt:  [[17.72067997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.47338517e-02  4.96954943e-04 -1.87567230e+00]
Stock Position:  -0.02473385173843634
Bond Position:  [2.67778248]


portfolio before change:  [0.16986291]
curr_Stock_Price:  101.40977386147205
curr_Factors:  [101.40977386  -0.79414694  -0.92402891]
mat_Sqrt:  [[18.19221278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08419311 -1.01300065  7.50487576]
Stock Position:  0.08419310949724225
Bond Position:  [-8.36814128]


portfolio before change:  [0.24286425]
curr_Stock_Price:  102.28926885662891
curr_Factors:  [102.28926886  -0.4777121   -0.94617626]
mat_Sqrt:  [[24.62879818  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087984 -0.03053791  0.10625201]
Stock Position:  -0.0008798388262868284
Bond Position:  [0.33286232]


portfolio before change:  [0.24257001]
curr_Stock_Price:  102.67098095149682
curr_Factors:  [102.67098095  -0.28878524  -0.95748603]
mat_Sqrt:  [[29.52561635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00447069 -0.02256835  0.0329445 ]
Stock Position:  0.004470687313701275
Bond Position:  [-0.21643984]


portfolio before change:  [0.23075609]
curr_Stock_Price:  100.03450439562461
curr_Factors:  [100.0345044   -0.22668785  -0.92990877]
mat_Sqrt:  [[31.46634469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244198 -0.00339707 -0.19022931]
Stock Position:  -0.00244198073754828
Bond Position:  [0.47503843]


portfolio before change:  [0.23221064]
curr_Stock_Price:  99.46318056463491
curr_Factors:  [ 9.94631806e+01 -8.37122193e-02 -9.37899068e-01]
mat_Sqrt:  [[35.80817588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01945228 -0.59023198 -0.57131698]
Stock Position:  -0.019452279991064646
Bond Position:  [2.16699628]


portfolio before change:  [0.15493159]
curr_Stock_Price:  103.44985688229971
curr_Factors:  [103.44985688   0.17756751  -0.94818541]
mat_Sqrt:  [[47.869048    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.000435   0.01202236 0.16656844]
Stock Position:  0.0004350038718437512
Bond Position:  [0.1099305]


portfolio before change:  [0.15491245]
curr_Stock_Price:  103.37428011673342
curr_Factors:  [ 1.03374280e+02  8.15170012e-02 -9.28039553e-01]
mat_Sqrt:  [[44.33762493  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00453114 -0.1156772   0.42596224]
Stock Position:  0.0045311370215430765
Bond Position:  [-0.31349057]


portfolio before change:  [0.15137559]
curr_Stock_Price:  102.6023611885567
curr_Factors:  [ 1.02602361e+02 -7.57263899e-02 -9.06102719e-01]
mat_Sqrt:  [[38.43743433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00175597 0.01898494 0.00972259]
Stock Position:  0.0017559740930629304
Bond Position:  [-0.02879149]


portfolio before change:  [0.15452963]
curr_Stock_Price:  104.40058371977383
curr_Factors:  [104.40058372  -0.16955802  -0.8828115 ]
mat_Sqrt:  [[36.4472404   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279676 -0.0168561  -0.33038309]
Stock Position:  -0.0027967647977681525
Bond Position:  [0.4465135]


portfolio before change:  [0.14939975]
curr_Stock_Price:  106.25475970131373
curr_Factors:  [106.2547597   -0.29314583  -0.88359231]
mat_Sqrt:  [[32.75650169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01870704 0.12099093 1.06811053]
Stock Position:  0.018707044875020343
Bond Position:  [-1.83831281]


portfolio before change:  [0.15136348]
curr_Stock_Price:  106.37201660342316
curr_Factors:  [106.3720166   -0.41975729  -0.89262967]
mat_Sqrt:  [[28.6328765   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00103133 0.02625929 0.42187064]
Stock Position:  0.0010313252629789392
Bond Position:  [0.04165933]


portfolio before change:  [0.15417308]
curr_Stock_Price:  109.09123310842213
curr_Factors:  [109.09123311  -0.45938201  -0.87802942]
mat_Sqrt:  [[28.63910548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00687178 -0.14413069  0.43706943]
Stock Position:  -0.006871775275641134
Bond Position:  [0.90382352]


portfolio before change:  [0.16851189]
curr_Stock_Price:  107.0210507089292
curr_Factors:  [107.02105071  -0.28290677  -0.87308651]
mat_Sqrt:  [[33.68431398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00405246 -0.01981006 -0.61923368]
Stock Position:  0.004052457215204059
Bond Position:  [-0.26518633]


portfolio before change:  [0.17213306]
curr_Stock_Price:  107.92280386971412
curr_Factors:  [ 1.07922804e+02 -4.51490585e-02 -8.71747040e-01]
mat_Sqrt:  [[43.14299629  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01084934 0.01387279 0.87051255]
Stock Position:  0.010849340040913362
Bond Position:  [-0.99875814]


portfolio before change:  [0.21679642]
curr_Stock_Price:  112.0510005488594
curr_Factors:  [112.05100055  -0.3003996   -0.8875488 ]
mat_Sqrt:  [[34.15830438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078613  0.01906511  0.30795066]
Stock Position:  -0.0007861254525426953
Bond Position:  [0.30488256]


portfolio before change:  [0.21606955]
curr_Stock_Price:  113.02410462856477
curr_Factors:  [ 1.13024105e+02 -5.36636617e-02 -9.19143189e-01]
mat_Sqrt:  [[42.7254286   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080466 -0.02600141 -0.03673698]
Stock Position:  -0.0008046603824245047
Bond Position:  [0.30701557]


portfolio before change:  [0.21752034]
curr_Stock_Price:  111.26880919939168
curr_Factors:  [111.2688092   -0.18394305  -0.94471677]
mat_Sqrt:  [[35.99172889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01351951 -0.06495791 -0.59274665]
Stock Position:  0.013519511587172562
Bond Position:  [-1.28677961]


portfolio before change:  [0.22019142]
curr_Stock_Price:  111.47827935292989
curr_Factors:  [111.47827935  -0.1197941   -0.9368521 ]
mat_Sqrt:  [[38.75204657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084857 -0.04615166  0.05428092]
Stock Position:  -0.0008485694772837924
Bond Position:  [0.31478849]


portfolio before change:  [0.22013206]
curr_Stock_Price:  111.59460209566585
curr_Factors:  [111.5946021   -0.26456088  -0.94264584]
mat_Sqrt:  [[33.37028912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01067129 -0.03332233  0.65293329]
Stock Position:  -0.010671289493166432
Bond Position:  [1.41099037]


portfolio before change:  [0.23646185]
curr_Stock_Price:  110.08087646875573
curr_Factors:  [110.08087647  -0.20781085  -0.94193938]
mat_Sqrt:  [[34.86436017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144624  0.00590393 -0.2373087 ]
Stock Position:  -0.0014462375259947364
Bond Position:  [0.39566495]


portfolio before change:  [0.23455428]
curr_Stock_Price:  111.43406699662853
curr_Factors:  [111.434067    -0.29555682  -0.93765238]
mat_Sqrt:  [[32.46699005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02480379 0.04997062 0.7296528 ]
Stock Position:  0.02480378508290103
Bond Position:  [-2.52943237]


portfolio before change:  [0.24923984]
curr_Stock_Price:  112.03888434115683
curr_Factors:  [ 1.12038884e+02 -8.43274600e-02 -9.02072115e-01]
mat_Sqrt:  [[41.7811975   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00856386  0.19515317 -0.96508946]
Stock Position:  0.008563857707870852
Bond Position:  [-0.71024522]


portfolio before change:  [0.24017626]
curr_Stock_Price:  110.99089997920504
curr_Factors:  [110.99089998  -0.14854591  -0.89184502]
mat_Sqrt:  [[39.21491997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00315494  0.02328652 -0.08648738]
Stock Position:  -0.003154936244984363
Bond Position:  [0.59034548]


portfolio before change:  [0.24103944]
curr_Stock_Price:  110.74069476294207
curr_Factors:  [110.74069476  -0.25462483  -0.87054773]
mat_Sqrt:  [[35.94603653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09982935 0.72904794 0.73032554]
Stock Position:  0.0998293526145676
Bond Position:  [-10.81413242]


portfolio before change:  [0.2351617]
curr_Stock_Price:  110.69535841950923
curr_Factors:  [110.69535842  -0.52509956  -0.85425197]
mat_Sqrt:  [[27.86664285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00342606 -0.02080197 -0.01052297]
Stock Position:  -0.0034260583651795776
Bond Position:  [0.61441045]


portfolio before change:  [0.24021186]
curr_Stock_Price:  109.24373046315928
curr_Factors:  [109.24373046  -0.31754753  -0.85819522]
mat_Sqrt:  [[33.71148898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.81532520e-04 -3.69277331e-03 -6.58965483e-01]
Stock Position:  -0.00028153252038266835
Bond Position:  [0.27096753]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.23926903]
Stock Price:  112.71296983833838
PL:  [-12.47370081]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-6.50596918e-03 -1.10754404e-01  7.54735298e-02]
 [ 9.53261554e-01  2.12166876e-01  2.73182864e-01]
 [-2.96922153e-01 -1.86840316e-01  3.84574188e-02]
 [ 1.88066154e-01  1.52086886e+00  1.22011013e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 2.96463676e-03  1.05151494e-01 -2.16346826e-02]
 [-1.68959610e-01  3.26329504e-01  1.55782929e-01]
 [-5.08036373e-02  9.67657928e-02  1.17086437e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 6.15306873e-01  1.33651009e+00 -1.77112947e-01]
 [-9.36101417e-04  3.66518320e-02  6.98912856e-02]
 [-4.38742830e-01 -6.87978352e-02 -1.16474026e+00]
 [ 2.12721930e+00 -3.12623283e+00  2.66325761e+00]
 [ 1.26347914e-02 -2.42324744e-02 -1.51621962e-02]
 [ 2.17909234e-02  2.47206070e-01 -1.37151828e-01]
 [ 3.45337760e-02 -2.24920068e-01  3.75995295e-02]
 [-2.96440426e-01 -1.88489731e+00 -1.91612606e-01]
 [ 3.30945090e-02 -2.11297031e-01  3.97187323e-01]
 [-1.67821139e-01  5.86454613e-01  3.83901474e-01]
 [ 2.15786960e-02  5.12288242e-02 -2.45467538e-02]
 [ 1.25584573e-01 -5.28544365e-02  6.35103467e-02]
 [-2.01400345e-02 -1.05657849e-01 -1.04596553e-01]
 [-2.35259046e-01  7.35901034e-02  2.80292653e-02]
 [ 1.05522689e-01 -3.38061975e-03 -3.75839020e-02]
 [-1.86828370e-02 -5.37004125e-02  2.02191091e-01]
 [-1.83294419e-01 -1.45331356e-01 -5.67427742e-02]
 [-1.69883979e-01  1.32752107e-01  2.13681575e-01]
 [ 1.07576418e-01  6.03626302e-02  1.66827766e-01]
 [-1.64679454e-01  1.25012112e-01 -2.80396425e-02]
 [ 1.04356694e-01 -7.44789843e-04 -1.12200023e-02]
 [ 1.94555766e-02 -1.95890529e-03 -5.73784389e-02]
 [ 9.34145059e-02  9.96239534e-02  1.43294533e-01]
 [ 4.92871198e-03 -1.80645705e-02  4.81742378e-02]
 [-8.87470128e-02  9.09210480e-02  4.16496840e-02]
 [-9.18986135e-02 -5.21723260e-02 -5.56761706e-02]
 [ 1.80583874e+00  1.17465606e+00  1.50049151e-01]
 [ 1.48100413e-01 -1.97397505e-01  6.05267478e-02]
 [ 2.93984245e-02 -1.52593413e-02 -9.71799023e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.59032829]
curr_Stock_Price:  99.317951314982
curr_Factors:  [99.31795131 -1.00907441 -0.98741971]
mat_Sqrt:  [[13.48842904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101625 -0.03574583  0.21530497]
Stock Position:  -0.001016252327802626
Bond Position:  [-2.48939619]


portfolio before change:  [-2.59081972]
curr_Stock_Price:  99.49530139646181
curr_Factors:  [99.4953014  -1.34692485 -1.00569223]
mat_Sqrt:  [[ 9.46398313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11119347 0.06847656 0.77931467]
Stock Position:  0.11119347329585041
Bond Position:  [-13.65404786]


portfolio before change:  [-2.59399658]
curr_Stock_Price:  99.48208114752802
curr_Factors:  [99.48208115 -1.27544682 -1.00282825]
mat_Sqrt:  [[10.19301289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03210147 -0.06030245  0.10970831]
Stock Position:  -0.03210146878804349
Bond Position:  [0.59952434]


portfolio before change:  [-2.59554695]
curr_Stock_Price:  99.53271153658146
curr_Factors:  [99.53271154 -1.37223802 -1.03263582]
mat_Sqrt:  [[ 8.98550311  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08319692 0.49085831 3.48063458]
Stock Position:  0.08319691592075038
Bond Position:  [-10.87636158]


portfolio before change:  [-2.63387455]
curr_Stock_Price:  99.08836849972742
curr_Factors:  [99.0883685  -1.28282651 -1.03442654]
mat_Sqrt:  [[ 9.76455525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00600601 -0.01106097 -0.05874131]
Stock Position:  -0.006006008411459545
Bond Position:  [-2.03874897]


portfolio before change:  [-2.63111659]
curr_Stock_Price:  98.58673405230383
curr_Factors:  [98.58673405 -1.39476909 -1.00529688]
mat_Sqrt:  [[ 8.94299669  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00223778  0.0339375  -0.06171773]
Stock Position:  0.002237777251990318
Bond Position:  [-2.85173174]


portfolio before change:  [-2.63245427]
curr_Stock_Price:  98.14826860628219
curr_Factors:  [98.14826861 -1.22318631 -0.9917115 ]
mat_Sqrt:  [[10.71432331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00658453  0.10532239  0.44440533]
Stock Position:  -0.006584533580061
Bond Position:  [-1.98619369]


portfolio before change:  [-2.63113239]
curr_Stock_Price:  97.90980677387313
curr_Factors:  [97.90980677 -0.90222746 -0.96530376]
mat_Sqrt:  [[15.12751835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189465  0.03123103  0.0334015 ]
Stock Position:  -0.0018946521799490857
Bond Position:  [-2.44562737]


portfolio before change:  [-2.62940742]
curr_Stock_Price:  96.83800299944686
curr_Factors:  [96.838003   -0.91402686 -0.96083384]
mat_Sqrt:  [[14.85265752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00350046  0.0064198  -0.11330016]
Stock Position:  0.0035004647000904635
Bond Position:  [-2.96838543]


portfolio before change:  [-2.63148135]
curr_Stock_Price:  96.35153794907502
curr_Factors:  [96.35153795 -0.91697113 -0.98572636]
mat_Sqrt:  [[14.37234487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [6.08160502e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  6.081605019304551e-05
Bond Position:  [-2.63734107]


portfolio before change:  [-2.63179738]
curr_Stock_Price:  96.57610284284625
curr_Factors:  [96.57610284 -1.23265168 -0.98665919]
mat_Sqrt:  [[10.49627523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08116859  0.43135678 -0.50525394]
Stock Position:  0.08116858642938145
Bond Position:  [-10.47074313]


portfolio before change:  [-2.65334992]
curr_Stock_Price:  96.32670068896316
curr_Factors:  [96.32670069 -1.2341528  -0.98457884]
mat_Sqrt:  [[10.47523505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00198677 0.01182933 0.19938038]
Stock Position:  0.001986773691388707
Bond Position:  [-2.84472928]


portfolio before change:  [-2.65510913]
curr_Stock_Price:  95.62022998874129
curr_Factors:  [95.62022999 -1.10552196 -0.98589909]
mat_Sqrt:  [[11.81019753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05846962 -0.02220441 -3.32267975]
Stock Position:  -0.05846961805424262
Bond Position:  [2.93576919]


portfolio before change:  [-2.63625949]
curr_Stock_Price:  95.30412302844206
curr_Factors:  [95.30412303 -0.82448037 -0.98148867]
mat_Sqrt:  [[15.65991149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12980373 -1.00898731  7.59753265]
Stock Position:  0.12980372731137046
Bond Position:  [-15.00708988]


portfolio before change:  [-2.48996197]
curr_Stock_Price:  96.44564276232944
curr_Factors:  [96.44564276 -1.05549871 -0.98144591]
mat_Sqrt:  [[12.57907789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036516 -0.007821   -0.04325353]
Stock Position:  0.0003651609453119982
Bond Position:  [-2.52518016]


portfolio before change:  [-2.49023832]
curr_Stock_Price:  96.55333429125358
curr_Factors:  [96.55333429 -0.99724586 -0.98867246]
mat_Sqrt:  [[13.25238088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00333945  0.07978542 -0.39125599]
Stock Position:  0.003339449097002326
Bond Position:  [-2.81267326]


portfolio before change:  [-2.49269829]
curr_Stock_Price:  95.921982603853
curr_Factors:  [95.9219826  -0.95478711 -0.98088248]
mat_Sqrt:  [[13.84418914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026747 -0.07259264  0.10726099]
Stock Position:  -0.0002674673673211504
Bond Position:  [-2.46704229]


portfolio before change:  [-2.49283714]
curr_Stock_Price:  95.28806821614818
curr_Factors:  [95.28806822 -1.24095857 -0.97411097]
mat_Sqrt:  [[10.40030422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06925819 -0.60834799 -0.54661743]
Stock Position:  -0.0692581892252392
Bond Position:  [4.10664192]


portfolio before change:  [-2.4767359]
curr_Stock_Price:  95.06299914044236
curr_Factors:  [95.06299914 -1.37608432 -0.95029759]
mat_Sqrt:  [[ 9.28275071  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00765282 -0.06819582  1.13306488]
Stock Position:  0.00765281845502738
Bond Position:  [-3.20423577]


portfolio before change:  [-2.47852281]
curr_Stock_Price:  94.88184242301958
curr_Factors:  [94.88184242 -1.36710592 -0.96865993]
mat_Sqrt:  [[ 9.1785249   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00329595 0.18927741 1.09516405]
Stock Position:  0.003295950990125703
Bond Position:  [-2.79124872]


portfolio before change:  [-2.47679185]
curr_Stock_Price:  95.51288669256655
curr_Factors:  [95.51288669 -1.45792547 -0.96872195]
mat_Sqrt:  [[ 8.43688998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00320321  0.01653403 -0.07002506]
Stock Position:  0.0032032124286206524
Bond Position:  [-2.78273992]


portfolio before change:  [-2.47736397]
curr_Stock_Price:  95.44287563241228
curr_Factors:  [95.44287563 -1.42665517 -0.99030023]
mat_Sqrt:  [[ 8.51281363  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01500793 -0.0170587   0.18117734]
Stock Position:  0.015007928926351076
Bond Position:  [-3.90976387]


portfolio before change:  [-2.48222078]
curr_Stock_Price:  95.15182556066539
curr_Factors:  [95.15182556 -1.38848076 -0.96641605]
mat_Sqrt:  [[ 9.03022218  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.006983   -0.03410092 -0.29838485]
Stock Position:  -0.0069829992256228565
Bond Position:  [-1.81777566]


portfolio before change:  [-2.47915929]
curr_Stock_Price:  94.68086333903977
curr_Factors:  [94.68086334 -1.08235573 -0.9552497 ]
mat_Sqrt:  [[12.34074598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01738275  0.0237511   0.07995969]
Stock Position:  -0.017382748123822424
Bond Position:  [-0.83334569]


portfolio before change:  [-2.48223584]
curr_Stock_Price:  94.85185907482773
curr_Factors:  [94.85185907 -0.91736084 -0.93812645]
mat_Sqrt:  [[14.83262291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00655048 -0.00109109 -0.10721641]
Stock Position:  0.006550482779089271
Bond Position:  [-3.10356131]


portfolio before change:  [-2.48964905]
curr_Stock_Price:  93.7793821157921
curr_Factors:  [93.77938212 -0.8393528  -0.93025998]
mat_Sqrt:  [[15.97990904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00072764 -0.01733173  0.5767949 ]
Stock Position:  0.0007276446722554067
Bond Position:  [-2.55788712]


portfolio before change:  [-2.48898642]
curr_Stock_Price:  95.12947351629312
curr_Factors:  [95.12947352 -0.94433667 -0.92342714]
mat_Sqrt:  [[14.69452583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0152807  -0.04690549 -0.16187134]
Stock Position:  -0.015280699105783809
Bond Position:  [-1.03534156]


portfolio before change:  [-2.49437335]
curr_Stock_Price:  95.47353544018904
curr_Factors:  [95.47353544 -0.93766201 -0.93855652]
mat_Sqrt:  [[14.62351094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00678144  0.04284556  0.60957406]
Stock Position:  -0.006781442563177524
Bond Position:  [-1.84692506]


portfolio before change:  [-2.49424628]
curr_Stock_Price:  95.42075159418947
curr_Factors:  [95.42075159 -0.82792567 -0.94240007]
mat_Sqrt:  [[16.24800827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0094751  0.01948196 0.47591318]
Stock Position:  0.009475097562294178
Bond Position:  [-3.39836721]


portfolio before change:  [-2.49582043]
curr_Stock_Price:  95.29945269127879
curr_Factors:  [95.29945269 -0.60082065 -0.9578135 ]
mat_Sqrt:  [[20.05322349  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00722502  0.04034749 -0.0799893 ]
Stock Position:  -0.007225024509307758
Bond Position:  [-1.80727954]


portfolio before change:  [-2.48719969]
curr_Stock_Price:  94.07500623814072
curr_Factors:  [94.07500624 -0.47235784 -0.94427108]
mat_Sqrt:  [[22.81603292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00446679 -0.00024038 -0.03200754]
Stock Position:  0.004466788383202124
Bond Position:  [-2.90741284]


portfolio before change:  [-2.48392267]
curr_Stock_Price:  94.8900149470751
curr_Factors:  [94.89001495 -0.91855289 -0.93110705]
mat_Sqrt:  [[14.92531176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00049201 -0.00063223 -0.16368472]
Stock Position:  0.0004920092809595479
Bond Position:  [-2.53060944]


portfolio before change:  [-2.48540076]
curr_Stock_Price:  92.52880248968744
curr_Factors:  [92.52880249 -0.74666095 -0.91491041]
mat_Sqrt:  [[17.5657083   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00814086 0.03215349 0.40877942]
Stock Position:  0.008140863546388299
Bond Position:  [-3.23866511]


portfolio before change:  [-2.49492236]
curr_Stock_Price:  91.40892753679837
curr_Factors:  [91.40892754 -0.85907213 -0.89503131]
mat_Sqrt:  [[15.81944232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00070008 -0.00583032  0.13742769]
Stock Position:  0.0007000766433620339
Bond Position:  [-2.55891562]


portfolio before change:  [-2.49471885]
curr_Stock_Price:  92.15655277658374
curr_Factors:  [92.15655278 -0.79474159 -0.92136687]
mat_Sqrt:  [[16.56646256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372355  0.02934464  0.11881496]
Stock Position:  -0.003723554455137439
Bond Position:  [-2.15156891]


portfolio before change:  [-2.49788836]
curr_Stock_Price:  92.93552385059864
curr_Factors:  [92.93552385 -1.10947479 -0.91964497]
mat_Sqrt:  [[12.21648414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00932454 -0.01683855 -0.15882862]
Stock Position:  -0.009324540051301603
Bond Position:  [-1.63130734]


portfolio before change:  [-2.50167297]
curr_Stock_Price:  93.31953028790575
curr_Factors:  [93.31953029 -1.16330047 -0.96436453]
mat_Sqrt:  [[11.11576554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.18678363 0.37911861 0.42804846]
Stock Position:  0.1867836317064313
Bond Position:  [-19.93223374]


portfolio before change:  [-2.42575969]
curr_Stock_Price:  93.73929386754094
curr_Factors:  [93.73929387 -1.27465691 -0.95943159]
mat_Sqrt:  [[10.03851266  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01197008 -0.06370977  0.17266596]
Stock Position:  0.011970078699884657
Bond Position:  [-3.54782641]


portfolio before change:  [-2.42564388]
curr_Stock_Price:  93.78601975976416
curr_Factors:  [93.78601976 -1.02450184 -0.904587  ]
mat_Sqrt:  [[13.625281    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00178345 -0.00492493 -0.02772272]
Stock Position:  0.0017834456423264043
Bond Position:  [-2.59290615]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.42679543]
Stock Price:  93.32207600987348
PL:  [-2.42679543]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 3.62065555e-02 -4.22567821e-02  1.19155937e-01]
 [ 1.52751185e+00  3.34176541e-01  4.99082027e-01]
 [ 1.29690584e-01  2.39773832e-01  4.29973334e-02]
 [ 7.85839687e-02  6.74488634e-01  5.15065446e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.06704446e-02 -4.66182697e-02  3.80277297e-02]
 [-4.41737058e-02 -4.22282018e-02 -5.11754193e-02]
 [ 6.12896732e-02  1.49028153e-01 -4.78660545e-02]
 [ 1.77997553e-02  6.12710421e-02 -4.60031976e-02]
 [-1.31978698e-01 -6.93594116e-02 -3.75994096e-02]
 [ 8.86477595e-01  1.71390166e+00 -3.06040582e-01]
 [-3.87085579e-05  1.62030652e-02 -4.38506738e-02]
 [-3.44398531e-01 -3.86223037e-03 -7.32130187e-01]
 [ 1.84854093e+00 -3.36327820e+00  2.83234022e+00]
 [ 3.05135421e-02 -9.49453174e-02  3.05433983e-02]
 [ 1.03964997e-01  1.31038747e-02 -2.69270905e-02]
 [-5.87833677e-02 -1.02176706e-03 -6.22071031e-02]
 [-2.72755624e-01 -1.76227530e+00 -1.96040497e-01]
 [ 7.78281751e-03 -1.32524468e-02  1.26794926e-01]
 [ 1.77837340e-01  1.19040019e-01  4.25128355e-01]
 [ 5.67845901e-02 -1.99927662e-01 -4.61428828e-04]
 [ 1.37424329e-01 -5.32241042e-02 -1.29807937e-02]
 [ 2.33141261e-02  1.34151517e-01  7.95978953e-02]
 [-1.09427778e-01  5.46556431e-03 -2.22036437e-02]
 [ 2.44831540e-02 -6.87544664e-02  1.53739377e-02]
 [ 2.08930557e-02 -4.67521533e-02  2.54282046e-01]
 [ 1.79165158e-01 -1.05671130e-01  7.66089450e-02]
 [-6.15049552e-02  6.94351662e-03  7.64154072e-02]
 [ 6.30647802e-02  7.50735881e-03  1.05154039e-01]
 [-1.09557061e-01  1.07386711e-01 -8.68348264e-03]
 [ 2.83524217e-02 -1.53488597e-02 -7.56265138e-02]
 [-3.15077477e-02  1.66527260e-02 -4.92340250e-02]
 [-9.41915942e-02 -2.90098458e-02  3.89041333e-02]
 [-3.91541524e-02 -4.04578375e-03  1.25894424e-03]
 [-9.21030380e-02 -1.40940630e-02  5.78247057e-02]
 [-1.19189395e-01 -6.93683405e-02 -8.22951690e-02]
 [ 2.46188477e+00  1.57800569e+00  1.74196985e-01]
 [-1.65034959e-02 -1.19798056e-01 -4.43145275e-02]
 [ 3.27005492e-02 -1.39215187e-02 -6.24615863e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.90092793]
curr_Stock_Price:  100.61314332055021
curr_Factors:  [100.61314332  -0.90876348  -0.99810668]
mat_Sqrt:  [[14.94553711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00347284 -0.01363832  0.33991872]
Stock Position:  0.0034728447360167086
Bond Position:  [6.55151411]


portfolio before change:  [6.90458283]
curr_Stock_Price:  101.42973686825766
curr_Factors:  [101.42973687  -0.88647081  -0.99196698]
mat_Sqrt:  [[15.50137179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10951289 0.10785501 1.4237421 ]
Stock Position:  0.10951289120859943
Bond Position:  [-4.20328091]


portfolio before change:  [7.00994931]
curr_Stock_Price:  102.39667256220687
curr_Factors:  [102.39667256  -1.16856182  -1.00242995]
mat_Sqrt:  [[11.67981854  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01604571 0.07738667 0.12265942]
Stock Position:  0.016045712179773776
Bond Position:  [5.36692177]


portfolio before change:  [7.00285614]
curr_Stock_Price:  101.9127999973785
curr_Factors:  [101.9128      -1.04833916  -1.01737994]
mat_Sqrt:  [[12.91511652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02488562 0.21769027 1.46933835]
Stock Position:  0.024885619735412694
Bond Position:  [4.46669295]


portfolio before change:  [6.99339726]
curr_Stock_Price:  101.51026838845827
curr_Factors:  [101.51026839  -0.9695238   -0.98811244]
mat_Sqrt:  [[14.33241461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00409184 -0.01106097 -0.05874131]
Stock Position:  -0.004091843736846154
Bond Position:  [7.40876141]


portfolio before change:  [6.99528097]
curr_Stock_Price:  101.27625203088579
curr_Factors:  [101.27625203  -0.95478787  -0.98365561]
mat_Sqrt:  [[14.57646826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00404192 -0.01504598  0.10848253]
Stock Position:  0.004041919271769574
Bond Position:  [6.58593054]


portfolio before change:  [6.99614677]
curr_Stock_Price:  101.28676927591397
curr_Factors:  [101.28676928  -1.1002852   -0.98935193]
mat_Sqrt:  [[12.53241726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00504608 -0.01362909 -0.14598923]
Stock Position:  -0.005046084792333445
Bond Position:  [7.5072484]


portfolio before change:  [6.99745231]
curr_Stock_Price:  101.214025025777
curr_Factors:  [101.21402503  -1.04007913  -0.99364227]
mat_Sqrt:  [[13.24362012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00618708  0.04809863 -0.13654853]
Stock Position:  0.006187077198328459
Bond Position:  [6.37123332]


portfolio before change:  [7.00093385]
curr_Stock_Price:  101.64800813412914
curr_Factors:  [101.64800813  -0.89028479  -0.99947411]
mat_Sqrt:  [[15.35985132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00136175  0.01977514 -0.13123432]
Stock Position:  0.0013617508741528442
Bond Position:  [6.86251459]


portfolio before change:  [6.9999649]
curr_Stock_Price:  100.30648802611681
curr_Factors:  [100.30648803  -1.00895692  -0.97902534]
mat_Sqrt:  [[13.73913217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01119514 -0.02238565 -0.10726065]
Stock Position:  -0.01119514495927595
Bond Position:  [8.12291058]


portfolio before change:  [7.00885055]
curr_Stock_Price:  99.60348538944724
curr_Factors:  [99.60348539 -0.88787146 -0.96138541]
mat_Sqrt:  [[15.67301246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07489664  0.55315938 -0.8730486 ]
Stock Position:  0.07489664392820933
Bond Position:  [-0.45111623]


portfolio before change:  [7.05126342]
curr_Stock_Price:  100.17052372425675
curr_Factors:  [100.17052372  -1.00866388  -0.98337627]
mat_Sqrt:  [[13.66494538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041583  0.00522952 -0.12509377]
Stock Position:  -0.00041582698544217225
Bond Position:  [7.09291703]


portfolio before change:  [7.05233207]
curr_Stock_Price:  99.7329048841226
curr_Factors:  [99.73290488 -1.24351238 -0.97696051]
mat_Sqrt:  [[10.82678082  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.56860042e-02 -1.24652949e-03 -2.08856364e+00]
Stock Position:  -0.04568600421852067
Bond Position:  [11.60872998]


portfolio before change:  [7.04309698]
curr_Stock_Price:  99.96681166048347
curr_Factors:  [99.96681166 -1.26369547 -0.96215364]
mat_Sqrt:  [[10.79398616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.16121604 -1.08549337  8.07987828]
Stock Position:  0.16121603692021877
Bond Position:  [-9.07315622]


portfolio before change:  [7.03725331]
curr_Stock_Price:  99.93759958812272
curr_Factors:  [99.93759959 -1.33038336 -0.96773961]
mat_Sqrt:  [[10.03845301  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017301  -0.03064347  0.08713181]
Stock Position:  0.0017301027783069162
Bond Position:  [6.86435099]


portfolio before change:  [7.03829391]
curr_Stock_Price:  100.0430834233778
curr_Factors:  [100.04308342  -1.39910871  -0.94455032]
mat_Sqrt:  [[ 9.60171659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01053388  0.00422926 -0.07681549]
Stock Position:  0.01053388154108636
Bond Position:  [5.98445192]


portfolio before change:  [7.03908282]
curr_Stock_Price:  100.04695737102388
curr_Factors:  [100.04695737  -1.22930694  -0.92715868]
mat_Sqrt:  [[11.57877906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00619149 -0.00032977 -0.17745955]
Stock Position:  -0.0061914910391253275
Bond Position:  [7.65852266]


portfolio before change:  [7.0400612]
curr_Stock_Price:  100.04356536564258
curr_Factors:  [100.04356537  -1.27710752  -0.91918843]
mat_Sqrt:  [[11.12627905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06044205 -0.56877191 -0.55924897]
Stock Position:  -0.06044205431581471
Bond Position:  [13.08689981]


portfolio before change:  [7.07420411]
curr_Stock_Price:  99.50574535651737
curr_Factors:  [99.50574536 -1.04918896 -0.8975044 ]
mat_Sqrt:  [[14.20397741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00217964 -0.00427721  0.36171063]
Stock Position:  0.0021796415219987294
Bond Position:  [6.85731725]


portfolio before change:  [7.07641727]
curr_Stock_Price:  100.12784195223978
curr_Factors:  [100.12784195  -1.0814357   -0.90904178]
mat_Sqrt:  [[13.68048424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02111879 0.03842    1.21277287]
Stock Position:  0.02111878786269283
Bond Position:  [4.96183862]


portfolio before change:  [7.09604808]
curr_Stock_Price:  101.02801387331384
curr_Factors:  [101.02801387  -1.35441336  -0.92387133]
mat_Sqrt:  [[10.35131076  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00153414 -0.06452638 -0.00131633]
Stock Position:  0.0015341379067494985
Bond Position:  [6.94105717]


portfolio before change:  [7.09798492]
curr_Stock_Price:  101.72492419910014
curr_Factors:  [101.7249242   -1.48257079  -0.90953547]
mat_Sqrt:  [[ 9.30141076  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01332167 -0.01717801 -0.03703059]
Stock Position:  0.013321668530147322
Bond Position:  [5.7428392]


portfolio before change:  [7.0917603]
curr_Stock_Price:  101.20377887653197
curr_Factors:  [101.20377888  -1.40480712  -0.88837658]
mat_Sqrt:  [[10.21597224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00655303 0.04329722 0.22707064]
Stock Position:  0.006553027022253851
Bond Position:  [6.4285692]


portfolio before change:  [7.0902312]
curr_Stock_Price:  100.84780356959998
curr_Factors:  [100.84780357  -1.3146718   -0.87732294]
mat_Sqrt:  [[11.264067    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01001809  0.001764   -0.06334082]
Stock Position:  -0.010018088823619186
Bond Position:  [8.10053346]


portfolio before change:  [7.09830584]
curr_Stock_Price:  100.14287854342302
curr_Factors:  [100.14287854  -1.16582754  -0.89274404]
mat_Sqrt:  [[12.78185229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00106298 -0.02219041  0.04385757]
Stock Position:  0.0010629835907291327
Bond Position:  [6.9918556]


portfolio before change:  [7.097743]
curr_Stock_Price:  98.79114306444669
curr_Factors:  [98.79114306 -1.2353285  -0.90694965]
mat_Sqrt:  [[11.59680706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00545451 -0.01508919  0.7253959 ]
Stock Position:  0.005454511518469946
Bond Position:  [6.55888557]


portfolio before change:  [7.100822]
curr_Stock_Price:  99.20531286335743
curr_Factors:  [99.20531286 -1.10367412 -0.9321257 ]
mat_Sqrt:  [[12.95383331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0133731  -0.03410521  0.218544  ]
Stock Position:  0.013373096601708627
Bond Position:  [5.77413977]


portfolio before change:  [7.09792302]
curr_Stock_Price:  98.9345605832553
curr_Factors:  [98.93456058 -0.97666333 -0.91825409]
mat_Sqrt:  [[14.87290661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029913   0.00224101  0.21799189]
Stock Position:  -0.002991304071895981
Bond Position:  [7.39386638]


portfolio before change:  [7.10431301]
curr_Stock_Price:  97.10736392490517
curr_Factors:  [97.10736392 -0.94254345 -0.90244417]
mat_Sqrt:  [[15.34561228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00560823 0.00242299 0.2999752 ]
Stock Position:  0.005608227952833877
Bond Position:  [6.55971278]


portfolio before change:  [7.10639668]
curr_Stock_Price:  97.33268513367787
curr_Factors:  [97.33268513 -0.84695107 -0.90899803]
mat_Sqrt:  [[16.81356084  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00531769  0.03465891 -0.02477156]
Stock Position:  -0.005317692628369068
Bond Position:  [7.62398198]


portfolio before change:  [7.09895191]
curr_Stock_Price:  98.91190925183875
curr_Factors:  [98.91190925 -0.78988229 -0.90612323]
mat_Sqrt:  [[18.14189912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0005392  -0.00495382 -0.21574139]
Stock Position:  0.000539202165883722
Bond Position:  [7.04561839]


portfolio before change:  [7.09982963]
curr_Stock_Price:  98.9062805929867
curr_Factors:  [98.90628059 -0.81026229 -0.88415011]
mat_Sqrt:  [[18.16979028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0021001   0.00537464 -0.14045097]
Stock Position:  -0.00210010004925528
Bond Position:  [7.30754272]


portfolio before change:  [7.10183736]
curr_Stock_Price:  98.38524472196765
curr_Factors:  [98.38524472 -0.72523556 -0.89260725]
mat_Sqrt:  [[19.51235829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00472377 -0.00936289  0.11098266]
Stock Position:  -0.004723771974617964
Bond Position:  [7.56658682]


portfolio before change:  [7.10098239]
curr_Stock_Price:  98.76647584277985
curr_Factors:  [98.76647584 -1.05212995 -0.90066742]
mat_Sqrt:  [[14.01265523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028348  -0.00130577  0.00359142]
Stock Position:  -0.0028347956168375582
Bond Position:  [7.38096517]


portfolio before change:  [7.10143622]
curr_Stock_Price:  98.9318676290019
curr_Factors:  [98.93186763 -1.14659962 -0.8805577 ]
mat_Sqrt:  [[13.03025654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00638334 -0.00454884  0.16495779]
Stock Position:  -0.0063833400092120594
Bond Position:  [7.73295197]


portfolio before change:  [7.09808394]
curr_Stock_Price:  99.60846590137089
curr_Factors:  [99.6084659  -1.26378726 -0.87699963]
mat_Sqrt:  [[11.7102002   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01282195 -0.02238854 -0.23476521]
Stock Position:  -0.012821948071153172
Bond Position:  [8.37525852]


portfolio before change:  [7.09595711]
curr_Stock_Price:  99.855995086248
curr_Factors:  [99.85599509 -1.3765907  -0.88385248]
mat_Sqrt:  [[10.41540458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.27070976 0.50929915 0.49693551]
Stock Position:  0.2707097570425299
Bond Position:  [-19.93603506]


portfolio before change:  [7.0238944]
curr_Stock_Price:  99.59900193724197
curr_Factors:  [99.59900194 -1.24708236 -0.87428208]
mat_Sqrt:  [[11.93872964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418829 -0.03866466 -0.12641701]
Stock Position:  -0.004188287890236545
Bond Position:  [7.44104369]


portfolio before change:  [7.02670179]
curr_Stock_Price:  99.15079770932618
curr_Factors:  [99.15079771 -1.09453574 -0.82860351]
mat_Sqrt:  [[14.49063612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118069 -0.00449315 -0.17818552]
Stock Position:  0.0011806875177244557
Bond Position:  [6.90963568]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.02841305]
Stock Price:  99.86859763469899
PL:  [7.02841305]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-2.49098211e-02 -8.23844807e-02  1.83781563e-01]
 [ 6.20185713e-01  2.04352995e-01  1.68264623e-01]
 [-2.46946334e-01 -1.40838607e-01  3.69996954e-02]
 [ 2.07160596e-01  1.32720642e+00  1.28304697e+00]
 [-4.78021223e-02 -3.23873876e-02 -1.77050706e-02]
 [-5.25302393e-02  4.29227341e-01 -2.08696373e-01]
 [-1.40038656e-01  7.47807128e-02  2.89813091e-01]
 [-3.45871325e-02  6.29820416e-02  2.54024605e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 8.09480167e-01  1.66660885e+00 -2.54349675e-01]
 [-1.05641804e-03  1.98866246e-02  9.06824078e-02]
 [-2.67352203e-01  2.64567147e-03 -5.65738557e-01]
 [ 1.63512996e+00 -3.13959770e+00  2.63151804e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.35782843e-01 -8.52130539e-02  2.40797396e-02]
 [-1.43611962e-01 -1.85847771e-01 -3.27488363e-02]
 [-2.60613758e-01 -1.70884175e+00 -2.01716051e-01]
 [-4.89873192e-05  3.34463101e-02  8.11459557e-02]
 [ 1.85527511e-01 -5.31782747e-02  3.31510585e-01]
 [ 4.89753129e-02  7.26034512e-03  6.36329336e-02]
 [ 1.38501762e-01 -5.33317523e-02 -1.37299624e-02]
 [ 2.17844111e-01  2.42038445e-01  2.20263348e-01]
 [-1.64499301e-01  5.16004643e-02  8.62787744e-02]
 [-7.41314136e-02 -2.41556726e-01  9.03697766e-02]
 [ 7.12152031e-02 -1.34910743e-02  5.31517103e-02]
 [ 2.84086417e-01 -6.97469572e-02  1.39626000e-01]
 [-7.18213438e-02  5.03392717e-02  1.19733254e-01]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [-8.95158499e-03  5.36011517e-02  7.07131262e-02]
 [-2.01141428e-02 -2.55327348e-02 -5.88350032e-02]
 [ 5.98354100e-02  2.31906086e-02 -7.61436939e-02]
 [-4.56688050e-02 -5.87437025e-02  1.31666441e-02]
 [ 4.44137392e-01  6.41857387e-02  1.03173012e-01]
 [ 6.76047951e-02  1.19480996e-01 -7.77207792e-02]
 [ 1.86122526e-02  3.15708149e-02  6.95274674e-02]
 [ 2.06993869e+00  1.48415386e+00  1.88455874e-01]
 [-1.19634701e-01  2.66122276e-02 -5.72289282e-03]
 [ 3.80401982e-02 -1.25824170e-02 -1.77083788e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.15275947]
curr_Stock_Price:  99.65058585441604
curr_Factors:  [99.65058585 -0.88470415 -0.95025138]
mat_Sqrt:  [[15.90628628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.64815324e-04 -2.65894768e-02  5.24277645e-01]
Stock Position:  -0.0002648153236514171
Bond Position:  [-0.12637047]


portfolio before change:  [-0.15267552]
curr_Stock_Price:  99.2738913563538
curr_Factors:  [99.27389136 -0.78975423 -0.94354497]
mat_Sqrt:  [[17.54174386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03969081 0.06595465 0.48001213]
Stock Position:  0.03969080673711032
Bond Position:  [-4.09293635]


portfolio before change:  [-0.12061725]
curr_Stock_Price:  100.09448221059358
curr_Factors:  [100.09448221  -0.87480029  -0.95985171]
mat_Sqrt:  [[15.9819916   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01677778 -0.04545546  0.10554983]
Stock Position:  -0.016777781498625917
Bond Position:  [1.5587461]


portfolio before change:  [-0.10789805]
curr_Stock_Price:  99.34799797948315
curr_Factors:  [99.34799798 -0.76060061 -0.94131043]
mat_Sqrt:  [[18.11459162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04084974 0.42835403 3.66017587]
Stock Position:  0.040849738900235744
Bond Position:  [-4.16623783]


portfolio before change:  [-0.14194519]
curr_Stock_Price:  98.5272747809959
curr_Factors:  [98.52727478 -0.78488786 -0.93509052]
mat_Sqrt:  [[17.64328104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328891 -0.01045298 -0.05050764]
Stock Position:  -0.0032889122144676756
Bond Position:  [0.18210237]


portfolio before change:  [-0.13954187]
curr_Stock_Price:  97.80346216719843
curr_Factors:  [97.80346217 -0.57638051 -0.94710179]
mat_Sqrt:  [[21.31642029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.52523730e-04  1.38532529e-01 -5.95352663e-01]
Stock Position:  -0.00035252372975964555
Bond Position:  [-0.10506383]


portfolio before change:  [-0.13897851]
curr_Stock_Price:  96.16812549897979
curr_Factors:  [96.1681255  -0.38908622 -0.9651689 ]
mat_Sqrt:  [[24.82479258  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264317  0.02413537  0.82675608]
Stock Position:  -0.0026431744407041384
Bond Position:  [0.11521062]


portfolio before change:  [-0.14285198]
curr_Stock_Price:  97.63903538133074
curr_Factors:  [97.63903538 -0.49650113 -0.96027309]
mat_Sqrt:  [[22.74858943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072733  0.02032737  0.07246615]
Stock Position:  -0.0007273295614195836
Bond Position:  [-0.07183622]


portfolio before change:  [-0.1422135]
curr_Stock_Price:  96.74884583936084
curr_Factors:  [96.74884584 -0.71126469 -0.92208859]
mat_Sqrt:  [[18.89250195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00275195  0.0064198  -0.11330016]
Stock Position:  0.0027519490791710465
Bond Position:  [-0.40846139]


portfolio before change:  [-0.14220916]
curr_Stock_Price:  96.76897471875256
curr_Factors:  [96.76897472 -0.68388261 -0.93271689]
mat_Sqrt:  [[19.21568609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.54872776e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  4.548727756811823e-05
Bond Position:  [-0.14661092]


portfolio before change:  [-0.1421983]
curr_Stock_Price:  97.41074183534873
curr_Factors:  [97.41074184 -0.62015131 -0.95027058]
mat_Sqrt:  [[20.2572873   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05419069  0.53789569 -0.72558882]
Stock Position:  0.05419068941731744
Bond Position:  [-5.42095355]


portfolio before change:  [-0.08419428]
curr_Stock_Price:  98.49361568429775
curr_Factors:  [98.49361568 -0.6675476  -0.9497432 ]
mat_Sqrt:  [[19.54463701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00110073 0.00641838 0.25869167]
Stock Position:  0.0011007311715821237
Bond Position:  [-0.19260927]


portfolio before change:  [-0.08230653]
curr_Stock_Price:  100.23048593688476
curr_Factors:  [100.23048594  -0.67608018  -0.95051854]
mat_Sqrt:  [[19.70502503  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.94007902e-02  8.53886797e-04 -1.61389463e+00]
Stock Position:  -0.019400790220383136
Bond Position:  [1.8622441]


portfolio before change:  [-0.10865176]
curr_Stock_Price:  101.60043139144284
curr_Factors:  [101.60043139  -0.81501787  -0.97210644]
mat_Sqrt:  [[17.01207641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0900195  -1.0133008   7.50698851]
Stock Position:  0.09001950122779813
Bond Position:  [-9.25467192]


portfolio before change:  [-0.13814072]
curr_Stock_Price:  101.2856989682294
curr_Factors:  [101.28569897  -0.74293469  -0.95424474]
mat_Sqrt:  [[18.55549191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00116781 -0.03053791  0.10625201]
Stock Position:  -0.0011678145203369837
Bond Position:  [-0.01985781]


portfolio before change:  [-0.14071308]
curr_Stock_Price:  103.48628410967571
curr_Factors:  [103.48628411  -0.84652901  -0.9617802 ]
mat_Sqrt:  [[16.96461787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00726831 -0.02750239  0.06869279]
Stock Position:  0.007268307415346743
Bond Position:  [-0.8928832]


portfolio before change:  [-0.14784529]
curr_Stock_Price:  102.52036569745893
curr_Factors:  [102.5203657   -0.7534286   -0.91227123]
mat_Sqrt:  [[19.38232638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00971157 -0.05998211 -0.09342331]
Stock Position:  -0.009711569368492408
Bond Position:  [0.84778836]


portfolio before change:  [-0.15487079]
curr_Stock_Price:  103.25469444770249
curr_Factors:  [103.25469445  -0.78775436  -0.93808932]
mat_Sqrt:  [[18.38168916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03539418 -0.5515263  -0.57543975]
Stock Position:  -0.03539417571200745
Bond Position:  [3.49974401]


portfolio before change:  [-0.10975195]
curr_Stock_Price:  101.99230180739544
curr_Factors:  [101.99230181  -0.98082198  -0.94449783]
mat_Sqrt:  [[14.87344675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00156938 0.01079475 0.23148682]
Stock Position:  0.0015693780581243666
Bond Position:  [-0.26981643]


portfolio before change:  [-0.11143595]
curr_Stock_Price:  100.94075707339849
curr_Factors:  [100.94075707  -0.86753435  -0.94655594]
mat_Sqrt:  [[16.45194148  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01473029 -0.01716321  0.94570743]
Stock Position:  0.014730289192808173
Bond Position:  [-1.59832249]


portfolio before change:  [-0.09687838]
curr_Stock_Price:  101.94259565133503
curr_Factors:  [101.94259565  -0.84381738  -0.96547888]
mat_Sqrt:  [[16.69507236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0038003  0.00234327 0.18152705]
Stock Position:  0.0038003035542836378
Bond Position:  [-0.48429119]


portfolio before change:  [-0.09804912]
curr_Stock_Price:  101.65046156740975
curr_Factors:  [101.65046157  -0.62742476  -0.98779135]
mat_Sqrt:  [[20.21295965  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00617489 -0.01721275 -0.03916776]
Stock Position:  0.006174892184496953
Bond Position:  [-0.72572976]


portfolio before change:  [-0.08599083]
curr_Stock_Price:  103.61794759647164
curr_Factors:  [103.6179476   -0.79489515  -1.00060402]
mat_Sqrt:  [[17.20519512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01814633 0.07811757 0.62835002]
Stock Position:  0.018146325410996457
Bond Position:  [-1.96627582]


portfolio before change:  [-0.07148815]
curr_Stock_Price:  104.43070021981936
curr_Factors:  [104.43070022  -1.02208358  -1.00729338]
mat_Sqrt:  [[13.72400849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0099355   0.01665398  0.24612933]
Stock Position:  -0.00993549511820252
Bond Position:  [0.96608256]


portfolio before change:  [-0.06492384]
curr_Stock_Price:  103.78216173384206
curr_Factors:  [103.78216173  -0.8373368   -1.00950596]
mat_Sqrt:  [[16.37001572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0064137  -0.0779621   0.25779982]
Stock Position:  -0.006413696987388987
Bond Position:  [0.6007035]


portfolio before change:  [-0.0544918]
curr_Stock_Price:  102.1673455378101
curr_Factors:  [102.16734554  -0.54590446  -0.99135864]
mat_Sqrt:  [[21.96277582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00361115 -0.00435423  0.15162703]
Stock Position:  0.003611150848921256
Bond Position:  [-0.4234335]


portfolio before change:  [-0.05442908]
curr_Stock_Price:  102.19937175723926
curr_Factors:  [102.19937176  -0.67781237  -1.02468954]
mat_Sqrt:  [[18.62348875  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01602011 -0.02251073  0.39831411]
Stock Position:  0.01602011421902498
Bond Position:  [-1.69167469]


portfolio before change:  [-0.05591348]
curr_Stock_Price:  102.11991348122795
curr_Factors:  [102.11991348  -0.64730949  -1.03704032]
mat_Sqrt:  [[18.94988622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195808  0.01624693  0.34156565]
Stock Position:  -0.0019580821959051865
Bond Position:  [0.1440457]


portfolio before change:  [-0.05427191]
curr_Stock_Price:  101.29075166484903
curr_Factors:  [101.29075166  -0.7285066   -1.01510521]
mat_Sqrt:  [[17.7144962   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124751 -0.02321455 -0.0028026 ]
Stock Position:  -0.0012475112002756777
Bond Position:  [0.07208944]


portfolio before change:  [-0.05346756]
curr_Stock_Price:  100.653209765306
curr_Factors:  [100.65320977  -0.76641414  -1.04395495]
mat_Sqrt:  [[16.4662355   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00099743 0.0172997  0.20172487]
Stock Position:  0.0009974326395219418
Bond Position:  [-0.15386236]


portfolio before change:  [-0.05262688]
curr_Stock_Price:  101.51533947098538
curr_Factors:  [101.51533947  -0.52251357  -1.05469574]
mat_Sqrt:  [[20.96806571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017806  -0.00824065 -0.16783989]
Stock Position:  -0.0017805951050487599
Bond Position:  [0.12813084]


portfolio before change:  [-0.0560911]
curr_Stock_Price:  103.46987710776094
curr_Factors:  [103.46987711  -0.68459952  -1.04459521]
mat_Sqrt:  [[18.35837355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00267052  0.00748474 -0.21721676]
Stock Position:  0.002670520164085995
Bond Position:  [-0.33240949]


portfolio before change:  [-0.05126439]
curr_Stock_Price:  105.29284141264478
curr_Factors:  [105.29284141  -0.57264555  -1.0593618 ]
mat_Sqrt:  [[20.5886115   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267003 -0.01895945  0.03756077]
Stock Position:  -0.002670028673040799
Bond Position:  [0.22987052]


portfolio before change:  [-0.04920217]
curr_Stock_Price:  104.53124579005733
curr_Factors:  [104.53124579  -0.75368362  -1.04938878]
mat_Sqrt:  [[17.22589251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0277663  0.02071586 0.29432389]
Stock Position:  0.027766303166641273
Bond Position:  [-2.95164843]


portfolio before change:  [-0.02313153]
curr_Stock_Price:  105.48346560602893
curr_Factors:  [105.48346561  -0.89806685  -1.04624876]
mat_Sqrt:  [[15.09311387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00504396  0.03856233 -0.22171575]
Stock Position:  0.005043960073123462
Bond Position:  [-0.55518592]


portfolio before change:  [-0.01938567]
curr_Stock_Price:  106.23986690539009
curr_Factors:  [106.23986691  -1.12123136  -1.0696184 ]
mat_Sqrt:  [[11.87992111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0033038  0.01018944 0.19834251]
Stock Position:  0.0033037974540301414
Bond Position:  [-0.37038067]


portfolio before change:  [-0.02080916]
curr_Stock_Price:  105.82301571816318
curr_Factors:  [105.82301572  -0.95074967  -1.08634638]
mat_Sqrt:  [[13.8000468   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.17473555 0.4790086  0.53761215]
Stock Position:  0.1747355466762161
Bond Position:  [-18.51185167]


portfolio before change:  [0.07973627]
curr_Stock_Price:  106.41167419827933
curr_Factors:  [106.4116742   -1.07029276  -1.10188804]
mat_Sqrt:  [[12.12336389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00951639  0.00858906 -0.01632582]
Stock Position:  -0.009516392063647374
Bond Position:  [1.09239148]


portfolio before change:  [0.08207161]
curr_Stock_Price:  106.18062242747848
curr_Factors:  [106.18062243  -1.15233266  -1.10238574]
mat_Sqrt:  [[11.13867431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.06224527e-05 -4.06095764e-03 -5.05170757e-01]
Stock Position:  -6.0622452702999135e-05
Bond Position:  [0.08850854]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.08205194]
Stock Price:  106.68750995701656
PL:  [-6.60545801]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.90314442e-03 -1.06928745e-01  4.30185523e-02]
 [ 5.37123743e-01  2.02466653e-01  1.46809431e-01]
 [-2.44708019e-01 -1.38778284e-01  3.69344069e-02]
 [ 1.87658063e-01  1.42780497e+00  1.20320441e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 2.49186710e-03  1.30273359e-01 -4.29683619e-02]
 [-5.54174685e-02  8.62195667e-03 -6.29118614e-02]
 [-6.34330807e-02  1.25943358e-01  6.51462416e-04]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 8.88281425e-01  1.75318026e+00 -2.97634760e-01]
 [-9.23643534e-04  2.52340553e-02  7.12989327e-02]
 [-4.96046552e-01 -1.36267540e-02 -1.05275732e+00]
 [ 1.97950010e+00 -3.04654633e+00  2.58550320e+00]
 [ 2.30651956e-02 -7.08897941e-02  4.80991955e-03]
 [ 2.82770692e-02  1.98125917e-01 -1.16490714e-01]
 [ 3.42243529e-02 -1.74596394e-01  3.72019813e-02]
 [-3.03198678e-01 -1.92883983e+00 -1.93583383e-01]
 [ 4.10487926e-02 -1.19375983e-01  8.14533256e-02]
 [-2.30377673e-01  3.81356507e-01  1.77693315e-01]
 [ 1.76695356e-02  9.53051728e-02 -5.66445846e-02]
 [ 7.65843748e-02 -4.55758501e-02  2.49469984e-02]
 [ 1.12199113e-01 -5.17887300e-02 -3.97594498e-02]
 [-8.33545924e-02 -3.69991416e-02  7.27781313e-02]
 [ 8.91300432e-02 -1.90496023e-02 -2.35403665e-02]
 [ 3.20988616e-02 -4.47847727e-02  2.69031458e-01]
 [-1.92106879e-01 -1.25731368e-01 -7.25081399e-02]
 [-2.09199760e-01  1.53452092e-01  2.93317480e-01]
 [ 1.12639506e-01  1.18285374e-01  2.89709896e-01]
 [-1.60813874e-01  1.15708756e-01 -7.72124546e-02]
 [ 1.12151457e-01  2.83696930e-03  6.75069811e-05]
 [ 1.22025614e-01 -2.26794529e-03 -8.52345561e-02]
 [ 8.75604779e-02  8.98026212e-02  1.31450099e-01]
 [-6.75482258e-03 -3.78260738e-02  1.21796846e-02]
 [-9.23491317e-02  1.20982809e-01  3.41036447e-02]
 [-9.38452820e-02 -5.32419216e-02 -5.75408891e-02]
 [ 1.83633901e+00  1.19051876e+00  1.50608437e-01]
 [ 2.13736389e-01 -3.42166589e-01  9.06975224e-02]
 [ 2.40774523e-02 -1.43382470e-02  3.04297900e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.89596337]
curr_Stock_Price:  98.73039746526973
curr_Factors:  [98.73039747 -1.15191935 -0.99913403]
mat_Sqrt:  [[11.4884192   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096989 -0.0345111   0.12271996]
Stock Position:  -0.00096988705169436
Bond Position:  [-6.80020604]


portfolio before change:  [-6.89689644]
curr_Stock_Price:  98.81596714926317
curr_Factors:  [98.81596715 -1.09032202 -1.00439379]
mat_Sqrt:  [[12.16476184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05001491 0.06534583 0.41880644]
Stock Position:  0.05001490641133359
Bond Position:  [-11.83916779]


portfolio before change:  [-6.83625767]
curr_Stock_Price:  100.05797211289727
curr_Factors:  [100.05797211  -0.97701367  -1.04052585]
mat_Sqrt:  [[13.30593557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01995326 -0.0447905   0.10536358]
Stock Position:  -0.01995326157970365
Bond Position:  [-4.83977478]


portfolio before change:  [-6.82682253]
curr_Stock_Price:  99.55478861909606
curr_Factors:  [99.55478862 -1.11752653 -1.02295768]
mat_Sqrt:  [[11.70743279  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06190175 0.46082207 3.43240726]
Stock Position:  0.061901752046340096
Bond Position:  [-12.98943837]


portfolio before change:  [-6.77305826]
curr_Stock_Price:  100.44956209637871
curr_Factors:  [100.4495621   -1.08072885  -0.98899847]
mat_Sqrt:  [[12.67876322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00462553 -0.01106097 -0.05874131]
Stock Position:  -0.004625530104240317
Bond Position:  [-6.30842579]


portfolio before change:  [-6.76952537]
curr_Stock_Price:  99.51529253116125
curr_Factors:  [99.51529253 -0.83278909 -1.00672348]
mat_Sqrt:  [[15.81246816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128461  0.04204555 -0.12257678]
Stock Position:  0.0012846144459207874
Bond Position:  [-6.89736415]


portfolio before change:  [-6.76988303]
curr_Stock_Price:  99.90806664234222
curr_Factors:  [99.90806664 -0.72378122 -1.0200833 ]
mat_Sqrt:  [[17.46826688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380687  0.00278272 -0.17947003]
Stock Position:  -0.003806865865293251
Bond Position:  [-6.38954642]


portfolio before change:  [-6.76878509]
curr_Stock_Price:  99.40983941034278
curr_Factors:  [99.40983941 -0.8599289  -1.03147855]
mat_Sqrt:  [[14.9969021   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250665  0.04064804  0.00185844]
Stock Position:  -0.0025066524403538405
Bond Position:  [-6.51959917]


portfolio before change:  [-6.76814999]
curr_Stock_Price:  98.83133982416064
curr_Factors:  [98.83133982 -0.73015453 -1.04726981]
mat_Sqrt:  [[16.70971725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00311144  0.0064198  -0.11330016]
Stock Position:  0.0031114352540314912
Bond Position:  [-7.07565731]


portfolio before change:  [-6.76973167]
curr_Stock_Price:  98.60727398681186
curr_Factors:  [98.60727399 -0.49065304 -1.04066622]
mat_Sqrt:  [[21.32384162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.09902335e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  4.099023350344399e-05
Bond Position:  [-6.77377361]


portfolio before change:  [-6.77056244]
curr_Stock_Price:  98.9979192059877
curr_Factors:  [98.99791921 -0.69678336 -1.03883917]
mat_Sqrt:  [[17.45238475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06792157  0.5658365  -0.84906912]
Stock Position:  0.06792157194028847
Bond Position:  [-13.49465673]


portfolio before change:  [-6.84454379]
curr_Stock_Price:  97.93353835920092
curr_Factors:  [97.93353836 -0.88465025 -1.00977713]
mat_Sqrt:  [[14.72963844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00127505 0.00814426 0.20339601]
Stock Position:  0.0012750530309276525
Bond Position:  [-6.96941425]


portfolio before change:  [-6.84619388]
curr_Stock_Price:  97.32269763012077
curr_Factors:  [97.32269763 -0.74526759 -0.99231708]
mat_Sqrt:  [[17.12342774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04168098 -0.00439802 -3.00322361]
Stock Position:  -0.041680982393323435
Bond Position:  [-2.78968823]


portfolio before change:  [-6.84395327]
curr_Stock_Price:  97.26057484801233
curr_Factors:  [97.26057485 -0.66817339 -1.01324985]
mat_Sqrt:  [[18.10105951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.1041591  -0.9832686   7.37572096]
Stock Position:  0.10415909974576994
Bond Position:  [-16.97452719]


portfolio before change:  [-6.8320054]
curr_Stock_Price:  97.3956549508619
curr_Factors:  [97.39565495 -0.73278903 -1.0159764 ]
mat_Sqrt:  [[16.94573491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056514 -0.02287958  0.01372136]
Stock Position:  0.0005651391195584951
Bond Position:  [-6.88704749]


portfolio before change:  [-6.83293036]
curr_Stock_Price:  97.28236231512325
curr_Factors:  [97.28236232 -0.74713    -1.01547955]
mat_Sqrt:  [[16.69331181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00269214  0.06394486 -0.33231558]
Stock Position:  0.002692143156163218
Bond Position:  [-7.09482841]


portfolio before change:  [-6.83817852]
curr_Stock_Price:  95.66237059049125
curr_Factors:  [95.66237059 -0.48768315 -1.00233299]
mat_Sqrt:  [[21.55933446  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0002866  -0.05635074  0.1061269 ]
Stock Position:  0.00028659677509697723
Bond Position:  [-6.86559505]


portfolio before change:  [-6.8393236]
curr_Stock_Price:  94.661559387505
curr_Factors:  [94.66155939 -0.68690139 -1.01538658]
mat_Sqrt:  [[17.25358641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0426831  -0.62253038 -0.55223951]
Stock Position:  -0.042683096979547176
Bond Position:  [-2.79887508]


portfolio before change:  [-6.81108882]
curr_Stock_Price:  93.99186429914754
curr_Factors:  [93.9918643  -0.80727352 -1.00084101]
mat_Sqrt:  [[15.41118741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00216128 -0.03852843  0.23236367]
Stock Position:  0.0021612781513288305
Bond Position:  [-7.01423138]


portfolio before change:  [-6.81063234]
curr_Stock_Price:  94.60877302078794
curr_Factors:  [94.60877302 -0.65195827 -1.00477669]
mat_Sqrt:  [[18.04764575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00644195  0.12308228  0.50690957]
Stock Position:  -0.006441954119292301
Bond Position:  [-6.20116697]


portfolio before change:  [-6.81288487]
curr_Stock_Price:  94.83810259385298
curr_Factors:  [94.83810259 -0.36666584 -0.99918071]
mat_Sqrt:  [[24.19932413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00105627  0.03075961 -0.16159123]
Stock Position:  0.00105627310000896
Bond Position:  [-6.91305981]


portfolio before change:  [-6.81265275]
curr_Stock_Price:  95.87599824955596
curr_Factors:  [95.87599825 -0.27139908 -1.01008008]
mat_Sqrt:  [[26.6177027   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.002719   -0.01470954  0.07116684]
Stock Position:  0.0027189997915594397
Bond Position:  [-7.07333957]


portfolio before change:  [-6.81243542]
curr_Stock_Price:  96.28113215962705
curr_Factors:  [96.28113216 -0.26114506 -1.04847538]
mat_Sqrt:  [[25.98844287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00359821 -0.01671474 -0.11342264]
Stock Position:  0.00359821169089009
Bond Position:  [-7.15887531]


portfolio before change:  [-6.80738625]
curr_Stock_Price:  97.9330884495084
curr_Factors:  [97.93308845 -0.12507983 -1.02734078]
mat_Sqrt:  [[30.93424619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245848 -0.01194142  0.20761575]
Stock Position:  -0.0024584803586802234
Bond Position:  [-6.56661967]


portfolio before change:  [-6.8037079]
curr_Stock_Price:  96.10300389551982
curr_Factors:  [96.1030039  -0.14137572 -1.03254389]
mat_Sqrt:  [[29.71051317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00270734 -0.00614823 -0.06715411]
Stock Position:  0.0027073380292797454
Bond Position:  [-7.06389121]


portfolio before change:  [-6.80959011]
curr_Stock_Price:  94.25647866447798
curr_Factors:  [94.25647866 -0.16037176 -0.99639444]
mat_Sqrt:  [[29.64381103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00262696 -0.01445422  0.76747187]
Stock Position:  0.0026269572609183846
Bond Position:  [-7.05719785]


portfolio before change:  [-6.80666843]
curr_Stock_Price:  95.70449501739094
curr_Factors:  [95.70449502 -0.18681247 -1.00231834]
mat_Sqrt:  [[29.14066019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00798103 -0.04057962 -0.20684554]
Stock Position:  -0.007981025392304142
Bond Position:  [-6.04284843]


portfolio before change:  [-6.80005294]
curr_Stock_Price:  94.78094189691818
curr_Factors:  [ 9.47809419e+01 -3.75947619e-02 -9.99699594e-01]
mat_Sqrt:  [[33.59153157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00351289  0.04952645  0.83675313]
Stock Position:  -0.0035128884470314943
Bond Position:  [-6.46709806]


portfolio before change:  [-6.79683031]
curr_Stock_Price:  93.63343369361485
curr_Factors:  [93.63343369 -0.09766891 -1.00342287]
mat_Sqrt:  [[31.13385272  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00629287 0.03817644 0.82646169]
Stock Position:  0.00629286692726388
Bond Position:  [-7.38605304]


portfolio before change:  [-6.79665507]
curr_Stock_Price:  93.80800374311775
curr_Factors:  [ 9.38080037e+01 -1.36145578e-02 -9.92118492e-01]
mat_Sqrt:  [[34.3127543   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0044577   0.03734484 -0.22026564]
Stock Position:  -0.0044576966376205125
Bond Position:  [-6.37848745]


portfolio before change:  [-6.79654731]
curr_Stock_Price:  93.60495643467415
curr_Factors:  [ 9.36049564e+01 -1.86843842e-02 -9.40819860e-01]
mat_Sqrt:  [[35.85844454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00314415 0.00091563 0.00019258]
Stock Position:  0.0031441500663019232
Bond Position:  [-7.09085534]


portfolio before change:  [-6.79983726]
curr_Stock_Price:  92.8405105085042
curr_Factors:  [92.84051051 -0.18745446 -0.91295793]
mat_Sqrt:  [[30.89117936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00337197 -0.00073198 -0.24315046]
Stock Position:  0.0033719735911671546
Bond Position:  [-7.11289301]


portfolio before change:  [-6.7996257]
curr_Stock_Price:  93.1669443827861
curr_Factors:  [93.16694438 -0.42409186 -0.91376872]
mat_Sqrt:  [[24.44760871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00542889 0.02898367 0.37499054]
Stock Position:  0.005428894986354574
Bond Position:  [-7.30541926]


portfolio before change:  [-6.80154307]
curr_Stock_Price:  92.9819819416125
curr_Factors:  [92.98198194 -0.40087734 -0.93112442]
mat_Sqrt:  [[24.54244251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048854 -0.01220831  0.03474525]
Stock Position:  -0.0004885361292188243
Bond Position:  [-6.75611802]


portfolio before change:  [-6.80156812]
curr_Stock_Price:  91.30448106544911
curr_Factors:  [91.30448107 -0.4590036  -0.92835091]
mat_Sqrt:  [[22.80193384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266171  0.03904703  0.09728821]
Stock Position:  -0.0026617146702379016
Bond Position:  [-6.55854165]


portfolio before change:  [-6.80561551]
curr_Stock_Price:  92.51705395857194
curr_Factors:  [92.51705396 -0.24298971 -0.9230736 ]
mat_Sqrt:  [[28.8274968   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403985 -0.01718376 -0.16414814]
Stock Position:  -0.004039848807248252
Bond Position:  [-6.4318606]


portfolio before change:  [-6.80083881]
curr_Stock_Price:  91.1356310331841
curr_Factors:  [91.13563103 -0.18264411 -0.93270798]
mat_Sqrt:  [[29.87424552  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07063259 0.38423828 0.42964395]
Stock Position:  0.07063259411072528
Bond Position:  [-13.23798484]


portfolio before change:  [-6.86295057]
curr_Stock_Price:  90.27969606218382
curr_Factors:  [90.27969606 -0.35857042 -0.93825978]
mat_Sqrt:  [[24.68220123  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00657986 -0.11043379  0.25873479]
Stock Position:  0.0065798621136770544
Bond Position:  [-7.45697852]


portfolio before change:  [-6.87631009]
curr_Stock_Price:  88.39100175535309
curr_Factors:  [88.39100176 -0.31066381 -0.93748974]
mat_Sqrt:  [[25.37124966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107847 -0.00462765  0.08680772]
Stock Position:  0.0010784697276345822
Bond Position:  [-6.97163711]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.87548505]
Stock Price:  89.96411294258363
PL:  [-6.87548505]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.54290961e-01  3.02779452e-02 -2.25511280e-01]
 [ 1.67753711e+00  3.48806744e-01  5.62434700e-01]
 [ 4.65734416e-02  1.41678015e-01  3.46145101e-02]
 [ 9.59060332e-02  8.43389797e-01  6.28714216e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 7.33424365e-02 -6.82422065e-02  6.17956858e-02]
 [-3.21888650e-02 -1.19266517e-01  2.13006366e-03]
 [ 1.24280034e-01  9.27015104e-02 -1.05086457e-01]
 [ 1.53889514e-02  6.38799215e-02 -4.63995531e-02]
 [-3.24731487e-01 -6.14731992e-02 -1.34713751e-01]
 [ 6.31591991e-01  1.22660250e+00 -2.18256076e-01]
 [-2.24309484e-04  1.99324411e-02 -5.77485461e-02]
 [-1.49011149e-01 -3.51902900e-03 -3.03401798e-01]
 [ 1.61320214e+00 -3.09491322e+00  2.59319382e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.45385168e-01 -9.14420278e-02  2.54048503e-02]
 [-1.77411380e-01 -2.59654652e-01 -2.12165793e-02]
 [-2.60108444e-01 -1.70569122e+00 -2.01617480e-01]
 [-1.02546321e-02  4.02770858e-02  1.93275755e-01]
 [ 3.50375490e-01 -4.35348835e-01  3.70487910e-01]
 [ 9.07553745e-02 -6.80954644e-02 -1.57713758e-01]
 [-1.43778934e-01 -5.15237212e-02 -1.44400952e-01]
 [ 3.08512566e-01  3.29239570e-01  2.89812880e-01]
 [-5.10704984e-02  2.28430567e-02  1.34491370e-01]
 [-7.52926146e-02 -2.31584221e-01  8.91126945e-02]
 [ 1.10117773e-01 -2.74615535e-02 -1.06233622e-01]
 [ 6.30108741e-01 -4.35920930e-02  3.69635145e-01]
 [-5.91665728e-02  6.04995247e-02  1.06022130e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 3.69149217e-01 -1.56198475e-01 -4.17717153e-02]
 [-3.04949384e-02 -7.56043146e-02 -2.47429362e-02]
 [ 5.64847690e-02  2.55631109e-02 -7.68072638e-02]
 [-3.45905893e-02 -6.17534792e-02  1.20346611e-02]
 [ 4.70128473e-01  7.61092315e-02  1.18343166e-01]
 [ 1.53852043e-01  1.02362473e-01 -9.48824614e-02]
 [ 1.86122526e-02  3.15708149e-02  6.95274674e-02]
 [ 1.77031548e+00  1.35633088e+00  1.88422222e-01]
 [-1.08083421e-01  1.79174784e-02 -4.06692667e-03]
 [ 3.96962607e-02 -1.20290317e-02 -2.17404458e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.20015835]
curr_Stock_Price:  100.51751518256371
curr_Factors:  [100.51751518  -1.3871045   -0.98989884]
mat_Sqrt:  [[ 9.33087367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01226457  0.00977216 -0.64332091]
Stock Position:  0.012264566823213354
Bond Position:  [4.96735457]


portfolio before change:  [6.20961615]
curr_Stock_Price:  101.23803263512153
curr_Factors:  [101.23803264  -1.36416935  -0.98448241]
mat_Sqrt:  [[ 9.66801238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.19275353 0.11257689 1.60446965]
Stock Position:  0.19275352714744892
Bond Position:  [-13.30437173]


portfolio before change:  [6.24333567]
curr_Stock_Price:  101.42159696437645
curr_Factors:  [101.42159696  -1.50969297  -0.96645718]
mat_Sqrt:  [[ 8.52613295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00968305 0.04572638 0.09874556]
Stock Position:  0.009683053631129337
Bond Position:  [5.2612649]


portfolio before change:  [6.24598509]
curr_Stock_Price:  101.62728861865371
curr_Factors:  [101.62728862  -1.60708038  -0.98296619]
mat_Sqrt:  [[ 7.62372819  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0519953  0.27220289 1.79354666]
Stock Position:  0.051995296398326805
Bond Position:  [0.9618441]


portfolio before change:  [6.24150466]
curr_Stock_Price:  101.53880619323552
curr_Factors:  [101.53880619  -1.7886371   -0.95742487]
mat_Sqrt:  [[ 6.51677147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00899924 -0.01106097 -0.05874131]
Stock Position:  -0.008999241602850516
Bond Position:  [7.15527691]


portfolio before change:  [6.23879591]
curr_Stock_Price:  101.93919647730698
curr_Factors:  [101.93919648  -1.50855925  -0.96696337]
mat_Sqrt:  [[ 8.57502494  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00839957 -0.02202508  0.17628589]
Stock Position:  0.00839957276331425
Bond Position:  [5.38255022]


portfolio before change:  [6.24460821]
curr_Stock_Price:  102.55106468552873
curr_Factors:  [102.55106469  -1.28265109  -0.99196529]
mat_Sqrt:  [[10.54597725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00531949 -0.0384931   0.00607648]
Stock Position:  -0.00531949217227081
Bond Position:  [6.79012779]


portfolio before change:  [6.24775311]
curr_Stock_Price:  102.11942823304639
curr_Factors:  [102.11942823  -1.18492576  -0.99047127]
mat_Sqrt:  [[11.59699441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01049858  0.02991928 -0.29978241]
Stock Position:  0.010498579500791383
Bond Position:  [5.17564418]


portfolio before change:  [6.25080504]
curr_Stock_Price:  102.34850035298552
curr_Factors:  [102.34850035  -0.98313921  -0.98268742]
mat_Sqrt:  [[14.33289191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00132263  0.02061716 -0.13236501]
Stock Position:  0.0013226302693959714
Bond Position:  [6.11543582]


portfolio before change:  [6.25142971]
curr_Stock_Price:  102.24279328167523
curr_Factors:  [102.24279328  -1.06227363  -0.96872908]
mat_Sqrt:  [[13.41465282  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0271925  -0.01984039 -0.38430083]
Stock Position:  -0.027192502514379487
Bond Position:  [9.03166712]


portfolio before change:  [6.24727673]
curr_Stock_Price:  102.43703837373646
curr_Factors:  [102.43703837  -1.16968216  -0.96034155]
mat_Sqrt:  [[12.17305178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06879293  0.39588425 -0.62262383]
Stock Position:  0.06879292532316575
Bond Position:  [-0.79966681]


portfolio before change:  [6.26976826]
curr_Stock_Price:  102.76543693408226
curr_Factors:  [102.76543693  -0.9495204   -0.99606237]
mat_Sqrt:  [[14.68558368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0005409   0.00643317 -0.16474053]
Stock Position:  -0.0005409039081931486
Bond Position:  [6.32535448]


portfolio before change:  [6.27082879]
curr_Stock_Price:  102.26662272047989
curr_Factors:  [102.26662272  -0.74244689  -1.01446104]
mat_Sqrt:  [[17.64893468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01199285 -0.00113576 -0.86552088]
Stock Position:  -0.011992854211766676
Bond Position:  [7.49729748]


portfolio before change:  [6.26821516]
curr_Stock_Price:  102.56270337159013
curr_Factors:  [102.56270337  -0.88103163  -1.00453391]
mat_Sqrt:  [[15.5631947   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09707448 -0.99887895  7.39766016]
Stock Position:  0.09707448378635493
Bond Position:  [-3.68800633]


portfolio before change:  [6.31832058]
curr_Stock_Price:  103.08360698432841
curr_Factors:  [103.08360698  -0.57179803  -1.01728906]
mat_Sqrt:  [[21.040587    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102988 -0.03053791  0.10625201]
Stock Position:  -0.0010298844267491217
Bond Position:  [6.42448478]


portfolio before change:  [6.31805881]
curr_Stock_Price:  104.11758797207985
curr_Factors:  [104.11758797  -0.72495619  -0.98808462]
mat_Sqrt:  [[18.77413452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00702591 -0.02951279  0.07247297]
Stock Position:  0.007025910326050588
Bond Position:  [5.58653797]


portfolio before change:  [6.31412057]
curr_Stock_Price:  103.45765985411705
curr_Factors:  [103.45765985  -0.85246775  -0.99646675]
mat_Sqrt:  [[16.28473135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01441497 -0.08380318 -0.060525  ]
Stock Position:  -0.014414974083595948
Bond Position:  [7.80546006]


portfolio before change:  [6.31700427]
curr_Stock_Price:  103.32530048193367
curr_Factors:  [103.32530048  -1.02123429  -0.99761614]
mat_Sqrt:  [[13.72243151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04732661 -0.55050947 -0.57515855]
Stock Position:  -0.047326612753332886
Bond Position:  [11.20704075]


portfolio before change:  [6.25377114]
curr_Stock_Price:  104.69100348001594
curr_Factors:  [104.69100348  -1.18428098  -1.01603551]
mat_Sqrt:  [[11.59642306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00322678 0.01299937 0.55136193]
Stock Position:  0.0032267831014505736
Bond Position:  [5.91595598]


portfolio before change:  [6.25300374]
curr_Stock_Price:  104.22399200308422
curr_Factors:  [104.223992    -1.46088381  -1.01490092]
mat_Sqrt:  [[ 8.76492206  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03846421 -0.14050823  1.05689888]
Stock Position:  0.03846421067051672
Bond Position:  [2.24411015]


portfolio before change:  [6.28912706]
curr_Stock_Price:  105.15583986727073
curr_Factors:  [105.15583987  -1.30335711  -1.03316237]
mat_Sqrt:  [[10.16473081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00439385 -0.02197772 -0.44991345]
Stock Position:  0.00439384582897083
Bond Position:  [5.82708851]


portfolio before change:  [6.29108905]
curr_Stock_Price:  105.43658540767645
curr_Factors:  [105.43658541  -1.53143314  -1.07310215]
mat_Sqrt:  [[ 7.7957163   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02357345 -0.01662921 -0.41193572]
Stock Position:  -0.023573445162162643
Bond Position:  [8.77659261]


portfolio before change:  [6.29157178]
curr_Stock_Price:  105.46264915394165
curr_Factors:  [105.46264915  -1.21183257  -1.08312809]
mat_Sqrt:  [[10.62698153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04092189 0.10626161 0.82675548]
Stock Position:  0.040921885171925736
Bond Position:  [1.97584136]


portfolio before change:  [6.25898716]
curr_Stock_Price:  104.66034957098545
curr_Factors:  [104.66034957  -1.20845327  -1.11356735]
mat_Sqrt:  [[10.26458607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184662  0.00737256  0.38366644]
Stock Position:  -0.001846615423175897
Bond Position:  [6.45225458]


portfolio before change:  [6.26111494]
curr_Stock_Price:  103.94488164516115
curr_Factors:  [103.94488165  -0.98418207  -1.07667004]
mat_Sqrt:  [[13.23690363  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00788511 -0.07474349  0.25421371]
Stock Position:  -0.0078851139235312
Bond Position:  [7.08073217]


portfolio before change:  [6.25720652]
curr_Stock_Price:  104.5528072184926
curr_Factors:  [104.55280722  -1.1032299   -1.10950086]
mat_Sqrt:  [[11.43823303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00724127 -0.00886318 -0.30305495]
Stock Position:  0.007241272252595998
Bond Position:  [5.50011118]


portfolio before change:  [6.26474086]
curr_Stock_Price:  105.49832946077802
curr_Factors:  [105.49832946  -1.19630498  -1.12179944]
mat_Sqrt:  [[10.38737057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06706818 -0.01406929  1.05446618]
Stock Position:  0.06706817626015646
Bond Position:  [-0.81083969]


portfolio before change:  [6.32788671]
curr_Stock_Price:  106.44135808642307
curr_Factors:  [106.44135809  -1.66559729  -1.12899166]
mat_Sqrt:  [[ 6.50782474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00386849  0.01952614  0.30245163]
Stock Position:  -0.0038684942200237923
Bond Position:  [6.73965449]


portfolio before change:  [6.3297032]
curr_Stock_Price:  106.18958467031904
curr_Factors:  [106.18958467  -1.45806117  -1.13286616]
mat_Sqrt:  [[ 7.9589629   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00431959 -0.02600141 -0.03673698]
Stock Position:  -0.004319590397834724
Bond Position:  [6.78839871]


portfolio before change:  [6.33129498]
curr_Stock_Price:  106.01753756804268
curr_Factors:  [106.01753757  -1.14245151  -1.14501257]
mat_Sqrt:  [[10.76328109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03054261 -0.05041284 -0.11916308]
Stock Position:  0.030542612291222928
Bond Position:  [3.09324243]


portfolio before change:  [6.31395537]
curr_Stock_Price:  105.43715869784211
curr_Factors:  [105.4371587   -1.13853029  -1.16617548]
mat_Sqrt:  [[10.52137977  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0048452  -0.02440119 -0.07058471]
Stock Position:  -0.004845204364654274
Bond Position:  [6.82481995]


portfolio before change:  [6.32098894]
curr_Stock_Price:  104.16158532089672
curr_Factors:  [104.16158532  -0.87158668  -1.16851061]
mat_Sqrt:  [[13.54267908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00339849  0.00825046 -0.21910974]
Stock Position:  0.0033984856194995278
Bond Position:  [5.96699729]


portfolio before change:  [6.32665124]
curr_Stock_Price:  105.60822300429034
curr_Factors:  [105.608223    -0.55337309  -1.20521737]
mat_Sqrt:  [[18.19498085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245889 -0.01993085  0.03433154]
Stock Position:  -0.002458886927024837
Bond Position:  [6.58632992]


portfolio before change:  [6.32914333]
curr_Stock_Price:  104.92956383451784
curr_Factors:  [104.92956383  -0.6791585   -1.16589615]
mat_Sqrt:  [[16.58062192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.030748   0.02456415 0.33760011]
Stock Position:  0.030747996343267803
Bond Position:  [3.10276948]


portfolio before change:  [6.35419483]
curr_Stock_Price:  105.73168541782368
curr_Factors:  [105.73168542  -0.65964849  -1.18288136]
mat_Sqrt:  [[16.74960651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00927657  0.03303735 -0.27067325]
Stock Position:  0.009276569777271418
Bond Position:  [5.37336747]


portfolio before change:  [6.36273081]
curr_Stock_Price:  106.57944124477494
curr_Factors:  [106.57944124  -0.82014658  -1.1860012 ]
mat_Sqrt:  [[14.33555556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00273787 0.01018944 0.19834251]
Stock Position:  0.002737867600713185
Bond Position:  [6.07093041]


portfolio before change:  [6.36637793]
curr_Stock_Price:  107.63435045578703
curr_Factors:  [107.63435046  -0.93272025  -1.19999178]
mat_Sqrt:  [[12.75633234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.16349816 0.43775391 0.53751615]
Stock Position:  0.16349816141701864
Bond Position:  [-11.23164048]


portfolio before change:  [6.33809782]
curr_Stock_Price:  107.46996899280349
curr_Factors:  [107.46996899  -1.03316778  -1.19982103]
mat_Sqrt:  [[11.52158966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00913556  0.00578284 -0.01160181]
Stock Position:  -0.009135561371364459
Bond Position:  [7.31989631]


portfolio before change:  [6.33688302]
curr_Stock_Price:  107.70310690319718
curr_Factors:  [107.7031069   -0.83900537  -1.19863862]
mat_Sqrt:  [[14.03752973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.08398159e-04 -3.88235329e-03 -6.20194405e-01]
Stock Position:  -0.0005083981591903578
Bond Position:  [6.39163908]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.33763132]
Stock Price:  107.80282644094865
PL:  [-1.46519512]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-3.56408544e-02 -5.41731500e-02  2.58575465e-01]
 [ 2.61099846e-01  1.98801340e-01  5.85656018e-02]
 [-5.58997247e-01 -4.39890036e-01  4.48640649e-02]
 [ 2.84922820e-01  1.61327987e+00  1.72825040e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 1.95420126e-02  4.12913357e-02  5.15852074e-03]
 [-5.00341071e-02 -6.44147741e-03 -7.32808141e-02]
 [ 3.57792718e-02  1.84923409e-01 -4.27007168e-02]
 [ 6.17331547e-03  7.38527290e-02 -4.79146776e-02]
 [-2.24070494e-01 -1.26544420e-01 -1.01253600e-01]
 [ 7.69909014e-01  1.47824960e+00 -2.69116382e-01]
 [-2.23208526e-04  3.23947595e-02 -5.82897428e-02]
 [-2.72150364e-01 -3.04854955e-03 -5.45428445e-01]
 [ 1.78748931e+00 -3.39135263e+00  2.84993560e+00]
 [ 2.64195713e-02 -9.06701478e-02  3.27082008e-02]
 [ 1.17371354e-01 -2.25155156e-02 -1.77476943e-02]
 [-1.01146738e-01 -9.16043920e-02 -4.53458715e-02]
 [-2.65513045e-01 -1.72720967e+00 -1.98272640e-01]
 [-4.13907548e-03  3.70589193e-02  1.23234443e-01]
 [ 2.63039310e-01 -2.90363394e-01  3.08145743e-01]
 [ 5.12786796e-02 -2.13107666e-02  3.92484187e-02]
 [ 1.25838370e-01 -5.19328837e-02 -8.94880796e-03]
 [ 3.84382374e-02  1.24754041e-01  8.60311530e-02]
 [-1.71682561e-01  3.06569592e-02  2.08302935e-02]
 [ 2.19638287e-03 -1.04524670e-01  3.26306887e-02]
 [ 4.60863020e-02 -7.54230244e-03  1.29937424e-01]
 [ 4.15810883e-01 -8.93357753e-02  2.01534746e-01]
 [ 1.03134513e-02 -9.98051173e-02 -1.12111146e-02]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 8.31476224e-06  4.31917831e-02  9.11803140e-02]
 [-1.71914706e-02 -4.50384397e-02 -4.67017967e-02]
 [-1.75073130e-02  2.08672966e-02 -5.43499435e-02]
 [-9.97681228e-02 -3.39808774e-02  3.96740423e-02]
 [ 2.05001092e-01  7.01373999e-03  3.50881052e-02]
 [-7.83044991e-03 -2.66044076e-02  2.45168436e-02]
 [-1.11659071e-01 -5.39551867e-02 -9.27911178e-02]
 [ 2.22331774e+00  1.46591388e+00  1.72158785e-01]
 [-4.81879968e-02 -2.49053437e-02 -2.51505595e-02]
 [ 3.60256033e-02 -1.32791763e-02 -1.27056932e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.33348985]
curr_Stock_Price:  99.71694021435592
curr_Factors:  [99.71694021 -0.7586812  -0.98783604]
mat_Sqrt:  [[17.38866101  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.49802294e-04 -1.74843090e-02  7.37643829e-01]
Stock Position:  0.0003498022944518501
Bond Position:  [0.29860863]


portfolio before change:  [0.33316859]
curr_Stock_Price:  98.69183135566404
curr_Factors:  [98.69183136 -0.6115448  -0.98119168]
mat_Sqrt:  [[20.07079347  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01562642 0.06416286 0.16707136]
Stock Position:  0.015626420247249022
Bond Position:  [-1.20903144]


portfolio before change:  [0.3125811]
curr_Stock_Price:  97.38402396127327
curr_Factors:  [97.38402396 -0.72340752 -0.9496223 ]
mat_Sqrt:  [[18.27679733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03499692 -0.1419739   0.12798469]
Stock Position:  -0.034996918471287025
Bond Position:  [3.72072185]


portfolio before change:  [0.30176471]
curr_Stock_Price:  97.70638129855017
curr_Factors:  [97.7063813  -0.52837004 -0.96296929]
mat_Sqrt:  [[21.9908738   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04397323 0.52068384 4.93021733]
Stock Position:  0.0439732335281445
Bond Position:  [-3.99470081]


portfolio before change:  [0.37062923]
curr_Stock_Price:  99.28379305499682
curr_Factors:  [99.28379305 -0.63256901 -0.98129485]
mat_Sqrt:  [[19.7690679   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296655 -0.01106097 -0.05874131]
Stock Position:  -0.0029665536708128907
Bond Position:  [0.66515994]


portfolio before change:  [0.36893462]
curr_Stock_Price:  99.88306108468666
curr_Factors:  [99.88306108 -0.89301196 -0.97641081]
mat_Sqrt:  [[15.40323182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00188425 0.01332672 0.01471582]
Stock Position:  0.0018842506704525646
Bond Position:  [0.1807299]


portfolio before change:  [0.36986398]
curr_Stock_Price:  100.36429482592067
curr_Factors:  [100.36429483  -1.09814459  -0.98446504]
mat_Sqrt:  [[12.50585436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0053021  -0.00207898 -0.20904977]
Stock Position:  -0.005302104902732151
Bond Position:  [0.902006]


portfolio before change:  [0.3668502]
curr_Stock_Price:  100.95397410874725
curr_Factors:  [100.95397411  -1.00084537  -0.96508395]
mat_Sqrt:  [[14.1361507   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00458472  0.05968377 -0.12181326]
Stock Position:  0.004584724563397714
Bond Position:  [-0.09599597]


portfolio before change:  [0.36616067]
curr_Stock_Price:  100.8061952445556
curr_Factors:  [100.80619524  -1.22129169  -0.92753789]
mat_Sqrt:  [[11.75607626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00097549  0.02383587 -0.13668724]
Stock Position:  0.0009754868711881011
Bond Position:  [0.26782555]


portfolio before change:  [0.36661395]
curr_Stock_Price:  101.23654416915355
curr_Factors:  [101.23654417  -1.16102065  -0.90896679]
mat_Sqrt:  [[12.77477292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02117999 -0.04084204 -0.28884834]
Stock Position:  -0.021179990601154598
Bond Position:  [2.51080301]


portfolio before change:  [0.37069642]
curr_Stock_Price:  101.05861213802216
curr_Factors:  [101.05861214  -1.09215805  -0.89853784]
mat_Sqrt:  [[13.80464013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07365076  0.47710301 -0.76771413]
Stock Position:  0.0736507645127074
Bond Position:  [-7.07234762]


portfolio before change:  [0.40355593]
curr_Stock_Price:  101.51676901873813
curr_Factors:  [101.51676902  -1.11031642  -0.91745051]
mat_Sqrt:  [[13.36256395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041227  0.01045536 -0.16628441]
Stock Position:  -0.0004122711686106773
Bond Position:  [0.44540836]


portfolio before change:  [0.40374465]
curr_Stock_Price:  101.19405260079591
curr_Factors:  [101.1940526   -1.14157846  -0.92789198]
mat_Sqrt:  [[12.77601445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.00647563e-02 -9.83915137e-04 -1.55595554e+00]
Stock Position:  -0.030064756342531987
Bond Position:  [3.44611919]


portfolio before change:  [0.41814809]
curr_Stock_Price:  100.72930105256853
curr_Factors:  [100.72930105  -1.31095266  -0.94972365]
mat_Sqrt:  [[10.50404505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.15965021 -1.09455436  8.13007298]
Stock Position:  0.15965021175655178
Bond Position:  [-15.66330616]


portfolio before change:  [0.31550607]
curr_Stock_Price:  100.09864742435137
curr_Factors:  [100.09864742  -1.29998244  -0.95495382]
mat_Sqrt:  [[10.49836903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138956 -0.02926366  0.09330739]
Stock Position:  0.001389562359203785
Bond Position:  [0.17641275]


portfolio before change:  [0.31651683]
curr_Stock_Price:  100.81017675007485
curr_Factors:  [100.81017675  -1.36321747  -0.97765272]
mat_Sqrt:  [[ 9.70235966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01125011 -0.00726685 -0.05062923]
Stock Position:  0.011250114916329856
Bond Position:  [-0.81760924]


portfolio before change:  [0.3241058]
curr_Stock_Price:  101.49382999777171
curr_Factors:  [101.49383     -1.44065772  -0.98511839]
mat_Sqrt:  [[ 8.97301642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01438776 -0.02956519 -0.12935915]
Stock Position:  -0.014387758585466648
Bond Position:  [1.78437453]


portfolio before change:  [0.3212551]
curr_Stock_Price:  101.70746741305837
curr_Factors:  [101.70746741  -1.31959595  -0.96498866]
mat_Sqrt:  [[10.3554828   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06359438 -0.55745452 -0.56561665]
Stock Position:  -0.06359437676324525
Bond Position:  [6.7892781]


portfolio before change:  [0.31607394]
curr_Stock_Price:  101.80228518673118
curr_Factors:  [101.80228519  -1.13436056  -0.94131303]
mat_Sqrt:  [[12.77332428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00223753 0.01196071 0.35155357]
Stock Position:  0.002237527956102599
Bond Position:  [0.08828848]


portfolio before change:  [0.31812452]
curr_Stock_Price:  102.71380451572564
curr_Factors:  [102.71380452  -1.03384085  -0.92954635]
mat_Sqrt:  [[14.41918076  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01849405 -0.09371438  0.87905403]
Stock Position:  0.018494054643152433
Bond Position:  [-1.58147019]


portfolio before change:  [0.30408474]
curr_Stock_Price:  101.9653431316341
curr_Factors:  [101.96534313  -0.96188079  -0.94297576]
mat_Sqrt:  [[15.17692873  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00361998 -0.00687802  0.11196481]
Stock Position:  0.003619980596618409
Bond Position:  [-0.06502782]


portfolio before change:  [0.30116517]
curr_Stock_Price:  101.16107246743253
curr_Factors:  [101.16107247  -1.18615079  -0.94039033]
mat_Sqrt:  [[12.06336164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00940127 -0.01676127 -0.02552846]
Stock Position:  0.00940127221589114
Bond Position:  [-0.64987761]


portfolio before change:  [0.29946929]
curr_Stock_Price:  100.98932557774594
curr_Factors:  [100.98932558  -1.09731492  -0.94840308]
mat_Sqrt:  [[13.0566401   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00623932 0.04026419 0.24542293]
Stock Position:  0.006239322239159131
Bond Position:  [-0.33063566]


portfolio before change:  [0.3002114]
curr_Stock_Price:  101.11489099443898
curr_Factors:  [101.11489099  -1.10977116  -0.96933421]
mat_Sqrt:  [[12.64361106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01274737  0.00989449  0.05942303]
Stock Position:  -0.012747368494060279
Bond Position:  [1.58916018]


portfolio before change:  [0.30090782]
curr_Stock_Price:  101.07584298684802
curr_Factors:  [101.07584299  -1.16354581  -0.95354599]
mat_Sqrt:  [[12.1676325   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102558 -0.03373519  0.09308627]
Stock Position:  -0.0010255828054096616
Bond Position:  [0.40456946]


portfolio before change:  [0.30073297]
curr_Stock_Price:  101.29564364553576
curr_Factors:  [101.29564365  -1.1569039   -0.93566621]
mat_Sqrt:  [[12.49680861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00568706 -0.00243427  0.3706753 ]
Stock Position:  0.005687060089058834
Bond Position:  [-0.27534144]


portfolio before change:  [0.30289002]
curr_Stock_Price:  101.68098644524589
curr_Factors:  [101.68098645  -1.26746116  -0.90378789]
mat_Sqrt:  [[11.59520062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03783578 -0.028833    0.57492253]
Stock Position:  0.03783577500041356
Bond Position:  [-3.54428891]


portfolio before change:  [0.27076716]
curr_Stock_Price:  100.84368910146404
curr_Factors:  [100.8436891   -1.09840663  -0.89079256]
mat_Sqrt:  [[13.79591444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00089502 -0.03221196 -0.03198219]
Stock Position:  -0.0008950216536209672
Bond Position:  [0.36102444]


portfolio before change:  [0.27046772]
curr_Stock_Price:  101.22867475776246
curr_Factors:  [101.22867476  -0.86806786  -0.9355006 ]
mat_Sqrt:  [[16.67338283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132541 -0.02321455 -0.0028026 ]
Stock Position:  -0.0013254078457136961
Bond Position:  [0.404637]


portfolio before change:  [0.27031959]
curr_Stock_Price:  101.37859883838476
curr_Factors:  [101.37859884  -0.64021841  -0.94002764]
mat_Sqrt:  [[20.87632959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00131426 0.01394009 0.26011206]
Stock Position:  0.0013142590083705197
Bond Position:  [0.13708185]


portfolio before change:  [0.27171416]
curr_Stock_Price:  102.42666895939088
curr_Factors:  [102.42666896  -0.65354292  -0.94745096]
mat_Sqrt:  [[20.65904505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017386  -0.01453609 -0.13322723]
Stock Position:  -0.0017386025264842409
Bond Position:  [0.44979343]


portfolio before change:  [0.27533498]
curr_Stock_Price:  100.37640699990378
curr_Factors:  [100.376407    -0.64393572  -0.95002602]
mat_Sqrt:  [[20.3883865   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00119391  0.00673489 -0.15504526]
Stock Position:  -0.0011939115274710963
Bond Position:  [0.39517553]


portfolio before change:  [0.27582379]
curr_Stock_Price:  100.00836331436936
curr_Factors:  [100.00836331  -0.54874598  -0.94162481]
mat_Sqrt:  [[22.53079466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0043765  -0.01096728  0.113179  ]
Stock Position:  -0.004376499449999257
Bond Position:  [0.71351034]


portfolio before change:  [0.27146793]
curr_Stock_Price:  101.02402779492364
curr_Factors:  [101.02402779  -0.66567273  -0.95399769]
mat_Sqrt:  [[19.99911382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01068023 0.00226367 0.1000966 ]
Stock Position:  0.010680228013282068
Bond Position:  [-0.80749172]


portfolio before change:  [0.2644235]
curr_Stock_Price:  100.37390257500309
curr_Factors:  [100.37390258  -0.7193598   -0.96871919]
mat_Sqrt:  [[18.55655797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044494 -0.00858654  0.06993973]
Stock Position:  -0.00044494092785880087
Bond Position:  [0.30908396]


portfolio before change:  [0.26412084]
curr_Stock_Price:  101.1409711455675
curr_Factors:  [101.14097115  -0.63377875  -0.97347131]
mat_Sqrt:  [[20.27249893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0069855  -0.01741396 -0.26470723]
Stock Position:  -0.00698549967157601
Bond Position:  [0.97064106]


portfolio before change:  [0.25904701]
curr_Stock_Price:  101.88467853028824
curr_Factors:  [101.88467853  -0.4531069   -0.96923296]
mat_Sqrt:  [[24.56939873  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10410055 0.47312167 0.49112109]
Stock Position:  0.10410055015096203
Bond Position:  [-10.34720408]


portfolio before change:  [0.36434629]
curr_Stock_Price:  102.90861894153028
curr_Factors:  [102.90861894  -0.50444107  -0.97468277]
mat_Sqrt:  [[23.446414    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249103 -0.00803817 -0.07174755]
Stock Position:  -0.002491025503378635
Bond Position:  [0.62069428]


portfolio before change:  [0.36363435]
curr_Stock_Price:  103.22556862219759
curr_Factors:  [103.22556862  -0.43270145  -1.02046212]
mat_Sqrt:  [[24.13717079  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.05736543e-04 -4.28583572e-03 -3.62458061e-01]
Stock Position:  0.0003057365432780291
Bond Position:  [0.33207452]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.36360183]
Stock Price:  102.98343016169285
PL:  [-2.61982833]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 5.74631565e-02 -4.93324966e-02  4.21362216e-02]
 [ 1.51054051e+00  2.94598796e-01  4.82149065e-01]
 [-1.46872920e-01 -4.87230947e-02  3.40806965e-02]
 [ 1.22918021e-01  1.06349205e+00  8.06117091e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 2.58609430e-02 -1.15602449e-02  3.49606688e-02]
 [-5.79700526e-02  1.57644609e-02 -5.79953006e-02]
 [-6.34330807e-02  1.25943358e-01  6.51462416e-04]
 [ 4.03232999e-02  3.68969267e-02 -4.23001463e-02]
 [-1.49457450e-01 -8.02129575e-02 -4.96807872e-02]
 [ 6.98316880e-01  1.40876517e+00 -2.27481674e-01]
 [-4.99975548e-04  1.98968918e-02  1.55117581e-02]
 [-3.39491646e-01 -4.80266081e-04 -7.38751196e-01]
 [ 1.89696489e+00 -3.22169966e+00  2.72112823e+00]
 [ 3.26434628e-02 -9.50014025e-02  2.69925396e-02]
 [ 6.07824527e-02  1.09901389e-01 -7.07272151e-02]
 [-2.09476597e-02  1.33661280e-01 -8.25361795e-02]
 [-2.72676593e-01 -1.76782617e+00 -1.98208213e-01]
 [ 4.22569676e-03  3.39540998e-02  3.86430606e-02]
 [ 1.47874248e-01  2.80106239e-01  4.07827293e-01]
 [ 2.95613096e-02 -3.87762968e-02  4.09979028e-02]
 [ 1.08687717e-01 -5.08437529e-02  2.44074632e-02]
 [ 6.56839068e-02  5.12128214e-02  3.59264568e-02]
 [-5.98557056e-02 -5.41067647e-02  7.97005652e-02]
 [ 6.66626703e-02  1.05601004e-02 -2.04456463e-02]
 [ 1.81813824e-02 -4.72282363e-02  2.50712862e-01]
 [ 1.36834486e-01 -1.15542771e-01  6.14271571e-02]
 [ 3.70669233e-04 -1.11878381e-01 -2.41973903e-02]
 [ 5.06001148e-02 -2.64423050e-02  5.05553914e-02]
 [-3.96004717e-02  8.50180706e-02  1.58816866e-02]
 [ 3.18845291e-02 -1.48266207e-02 -7.62926205e-02]
 [-5.38321891e-02  1.71547406e-02 -4.33052884e-02]
 [-1.17878724e-01 -2.81734506e-02  4.33736118e-02]
 [ 7.83439433e-03 -1.88381677e-03  8.07076032e-03]
 [-9.28354385e-02 -2.31613075e-02  5.87189649e-02]
 [-1.16329349e-01 -6.50834102e-02 -8.24885563e-02]
 [ 2.49706550e+00  1.60001087e+00  1.75565115e-01]
 [-1.24824270e-02 -1.29618247e-01 -5.04542445e-02]
 [ 3.28233723e-02 -1.38725270e-02 -6.46004498e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.15052167]
curr_Stock_Price:  100.51074168100362
curr_Factors:  [100.51074168  -1.00242495  -0.97791945]
mat_Sqrt:  [[13.87266291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0040363  -0.01592199  0.12020291]
Stock Position:  0.004036299548873281
Bond Position:  [5.74483021]


portfolio before change:  [6.15180719]
curr_Stock_Price:  100.65130863988236
curr_Factors:  [100.65130864  -1.52646554  -0.98199192]
mat_Sqrt:  [[ 8.19238201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.20373727 0.09508135 1.37543708]
Stock Position:  0.20373726516352914
Bond Position:  [-14.35461517]


portfolio before change:  [6.15736333]
curr_Stock_Price:  100.68738737763073
curr_Factors:  [100.68738738  -1.50305373  -0.97532784]
mat_Sqrt:  [[ 8.44554401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01774448 -0.01572531  0.09722274]
Stock Position:  -0.017744479968289296
Bond Position:  [7.94400866]


portfolio before change:  [6.15214848]
curr_Stock_Price:  101.03723775467375
curr_Factors:  [101.03723775  -1.20853783  -0.97343513]
mat_Sqrt:  [[11.39889226  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04426311 0.34324058 2.29962768]
Stock Position:  0.044263107106644876
Bond Position:  [1.6799264]


portfolio before change:  [6.1280764]
curr_Stock_Price:  100.48865268500032
curr_Factors:  [100.48865269  -0.92439419  -0.95642426]
mat_Sqrt:  [[15.32102955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00382781 -0.01106097 -0.05874131]
Stock Position:  -0.0038278107053197103
Bond Position:  [6.51272795]


portfolio before change:  [6.13126683]
curr_Stock_Price:  99.86785701778419
curr_Factors:  [99.86785702 -1.07921405 -0.96078138]
mat_Sqrt:  [[12.98574796  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235932 -0.00373105  0.09973306]
Stock Position:  0.002359319970859436
Bond Position:  [5.89564661]


portfolio before change:  [6.1316559]
curr_Stock_Price:  99.72038482712668
curr_Factors:  [99.72038483 -0.96160531 -1.00135467]
mat_Sqrt:  [[14.00494011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00475478  0.00508796 -0.16544445]
Stock Position:  -0.004754778396585043
Bond Position:  [6.60580423]


portfolio before change:  [6.13667054]
curr_Stock_Price:  98.83940503803154
curr_Factors:  [98.83940504 -1.11339754 -0.96845762]
mat_Sqrt:  [[12.32514146  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305003  0.04064804  0.00185844]
Stock Position:  -0.0030500275700215893
Bond Position:  [6.43813345]


portfolio before change:  [6.13579459]
curr_Stock_Price:  99.39047197096801
curr_Factors:  [99.39047197 -0.84477992 -0.94762299]
mat_Sqrt:  [[16.55442349  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00236918  0.01190843 -0.12067054]
Stock Position:  0.0023691777834318264
Bond Position:  [5.90032089]


portfolio before change:  [6.13690636]
curr_Stock_Price:  99.54840945132281
curr_Factors:  [99.54840945 -1.24069068 -0.91630089]
mat_Sqrt:  [[11.51502249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01528194 -0.02588862 -0.14172546]
Stock Position:  -0.01528194144897897
Bond Position:  [7.65819932]


portfolio before change:  [6.15807723]
curr_Stock_Price:  98.22570191451211
curr_Factors:  [98.22570191 -1.34679267 -0.88135984]
mat_Sqrt:  [[10.58158675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08878114  0.454677   -0.6489419 ]
Stock Position:  0.08878114282756178
Bond Position:  [-2.56251284]


portfolio before change:  [6.20855998]
curr_Stock_Price:  98.79793021199546
curr_Factors:  [98.79793021 -1.14249532 -0.89725777]
mat_Sqrt:  [[12.84973987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00052357 0.00642169 0.04425073]
Stock Position:  0.0005235736233937749
Bond Position:  [6.15683199]


portfolio before change:  [6.20964929]
curr_Stock_Price:  99.4084630102209
curr_Factors:  [99.40846301 -0.99923169 -0.89323387]
mat_Sqrt:  [[14.98083459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.27342668e-02 -1.55005211e-04 -2.10745153e+00]
Stock Position:  -0.03273426678407229
Bond Position:  [9.46371244]


portfolio before change:  [6.22980374]
curr_Stock_Price:  98.82890475384288
curr_Factors:  [98.82890475 -1.00090294 -0.88544198]
mat_Sqrt:  [[14.9849325   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11977272 -1.03979909  7.76262144]
Stock Position:  0.11977272361756046
Bond Position:  [-5.60720335]


portfolio before change:  [6.18432822]
curr_Stock_Price:  98.45507522136356
curr_Factors:  [98.45507522 -0.80853937 -0.90239326]
mat_Sqrt:  [[17.79055544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00105456 -0.03066157  0.0770022 ]
Stock Position:  0.0010545602084052327
Bond Position:  [6.08050141]


portfolio before change:  [6.18540083]
curr_Stock_Price:  98.75141089760321
curr_Factors:  [98.7514109  -1.04388507 -0.89175669]
mat_Sqrt:  [[14.25295047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00482559  0.03547052 -0.20176506]
Stock Position:  0.004825586639770587
Bond Position:  [5.70886734]


portfolio before change:  [6.18307211]
curr_Stock_Price:  98.12094277785002
curr_Factors:  [98.12094278 -0.78974184 -0.89352086]
mat_Sqrt:  [[18.2276219   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0005767   0.04313899 -0.23545275]
Stock Position:  -0.000576695762693976
Bond Position:  [6.23965804]


portfolio before change:  [6.18245889]
curr_Stock_Price:  100.5368128177666
curr_Factors:  [100.53681282  -0.77624779  -0.89284821]
mat_Sqrt:  [[18.94287651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03558022 -0.57056344 -0.56543286]
Stock Position:  -0.03558021829602388
Bond Position:  [9.75958064]


portfolio before change:  [6.19281811]
curr_Stock_Price:  100.27995121810117
curr_Factors:  [100.27995122  -0.82846019  -0.8761189 ]
mat_Sqrt:  [[18.23580005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00104435 0.01095864 0.1102379 ]
Stock Position:  0.001044348479703598
Bond Position:  [6.08809089]


portfolio before change:  [6.19176973]
curr_Stock_Price:  98.54735215705261
curr_Factors:  [98.54735216 -1.16424751 -0.89397134]
mat_Sqrt:  [[12.58264285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02291236 0.0904039  1.16341775]
Stock Position:  0.02291236393812319
Bond Position:  [3.93381693]


portfolio before change:  [6.18748579]
curr_Stock_Price:  98.33891903281659
curr_Factors:  [98.33891903 -1.0764399  -0.93179835]
mat_Sqrt:  [[13.19953524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227393 -0.012515    0.11695561]
Stock Position:  0.0022739280192819946
Bond Position:  [5.96387017]


portfolio before change:  [6.18935675]
curr_Stock_Price:  98.83384793208597
curr_Factors:  [98.83384793 -0.96985283 -0.93021043]
mat_Sqrt:  [[14.7815071   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00698788 -0.01640975  0.0696277 ]
Stock Position:  0.006987882304750041
Bond Position:  [5.49871746]


portfolio before change:  [6.19516441]
curr_Stock_Price:  99.5665836885213
curr_Factors:  [99.56658369 -0.84618382 -0.93683021]
mat_Sqrt:  [[16.74019267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00498627 0.01652887 0.10248818]
Stock Position:  0.004986271013505541
Bond Position:  [5.69869844]


portfolio before change:  [6.18956794]
curr_Stock_Price:  98.3013386850006
curr_Factors:  [98.30133869 -0.84894091 -0.92518979]
mat_Sqrt:  [[16.67493923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00327626 -0.01746288  0.22736353]
Stock Position:  -0.0032762573960228377
Bond Position:  [6.51162842]


portfolio before change:  [6.19058387]
curr_Stock_Price:  98.23970472077718
curr_Factors:  [98.23970472 -1.16804337 -0.93019482]
mat_Sqrt:  [[12.05129683  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00536414  0.00340826 -0.05832574]
Stock Position:  0.005364135713774296
Bond Position:  [5.66361276]


portfolio before change:  [6.19233954]
curr_Stock_Price:  98.43501536625158
curr_Factors:  [98.43501537 -1.22075912 -0.92758986]
mat_Sqrt:  [[11.48506625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00519958 -0.01524285  0.71521401]
Stock Position:  0.005199578866664632
Bond Position:  [5.68051891]


portfolio before change:  [6.19256254]
curr_Stock_Price:  98.34133298612447
curr_Factors:  [98.34133299 -1.19798886 -0.94244765]
mat_Sqrt:  [[11.56528465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01087636 -0.03729127  0.17523458]
Stock Position:  0.010876358522783684
Bond Position:  [5.12296694]


portfolio before change:  [6.1859706]
curr_Stock_Price:  97.67637280336953
curr_Factors:  [97.6763728  -1.31619648 -0.93883723]
mat_Sqrt:  [[10.2433221   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267547 -0.03610859 -0.06902842]
Stock Position:  -0.002675468073858316
Bond Position:  [6.44730062]


portfolio before change:  [6.18569716]
curr_Stock_Price:  98.07981894701878
curr_Factors:  [98.07981895 -1.23425167 -0.9564374 ]
mat_Sqrt:  [[10.96921327  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00506164 -0.00853422  0.14422046]
Stock Position:  0.0050616371994808744
Bond Position:  [5.6892527]


portfolio before change:  [6.18870107]
curr_Stock_Price:  98.53277710319136
curr_Factors:  [98.5327771  -1.15483137 -0.92761088]
mat_Sqrt:  [[12.27969402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154763  0.02743946  0.04530603]
Stock Position:  -0.0015476277348315918
Bond Position:  [6.34119313]


portfolio before change:  [6.18904066]
curr_Stock_Price:  98.82555485097753
curr_Factors:  [98.82555485 -1.20104232 -0.94071309]
mat_Sqrt:  [[11.6069124   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114457 -0.00478527 -0.21764161]
Stock Position:  0.001144567257564357
Bond Position:  [6.07592816]


portfolio before change:  [6.18966955]
curr_Stock_Price:  98.71141276471256
curr_Factors:  [98.71141276 -1.27291714 -0.91157877]
mat_Sqrt:  [[11.10843425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0053266   0.00553667 -0.12353793]
Stock Position:  -0.005326596526311917
Bond Position:  [6.71546542]


portfolio before change:  [6.19061003]
curr_Stock_Price:  98.69245303719282
curr_Factors:  [98.69245304 -1.27472728 -0.90363676]
mat_Sqrt:  [[11.1746122   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01027114 -0.00909294  0.12373284]
Stock Position:  -0.010271139778088252
Bond Position:  [7.20429401]


portfolio before change:  [6.18835417]
curr_Stock_Price:  98.9997659872171
curr_Factors:  [98.99976599 -1.23243082 -0.86375506]
mat_Sqrt:  [[12.16948523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074755 -0.000608    0.02302363]
Stock Position:  0.0007475500172981922
Bond Position:  [6.11434689]


portfolio before change:  [6.19001428]
curr_Stock_Price:  100.19803752180665
curr_Factors:  [100.19803752  -1.25317491  -0.86783682]
mat_Sqrt:  [[12.01477171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00712267 -0.00747528  0.16750886]
Stock Position:  -0.007122670669753764
Bond Position:  [6.9036919]


portfolio before change:  [6.18906191]
curr_Stock_Price:  100.45291105828902
curr_Factors:  [100.45291106  -1.24564943  -0.87490985]
mat_Sqrt:  [[12.05078482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01215293 -0.02100558 -0.23531689]
Stock Position:  -0.012152930493909229
Bond Position:  [7.40985916]


portfolio before change:  [6.19685004]
curr_Stock_Price:  99.88828676579413
curr_Factors:  [99.88828677 -1.13204044 -0.87007858]
mat_Sqrt:  [[13.48979409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.21197532 0.51640129 0.5008384 ]
Stock Position:  0.21197532121038973
Bond Position:  [-14.97700163]


portfolio before change:  [6.22010645]
curr_Stock_Price:  100.00683194145697
curr_Factors:  [100.00683194  -1.16256866  -0.85818786]
mat_Sqrt:  [[13.25642032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371439 -0.04183411 -0.14393192]
Stock Position:  -0.0037143941800727377
Bond Position:  [6.59157125]


portfolio before change:  [6.22344183]
curr_Stock_Price:  99.33071024200245
curr_Factors:  [99.33071024 -1.08166346 -0.83039031]
mat_Sqrt:  [[14.67875216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114486 -0.00447734 -0.1842871 ]
Stock Position:  0.0011448618262276862
Bond Position:  [6.10972189]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.22414337]
Stock Price:  99.27635419265495
PL:  [6.22414337]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-1.55100150e-02 -1.07096084e-01  1.18266140e-01]
 [ 6.60528568e-01  1.91827105e-01  1.75150947e-01]
 [-3.03215128e-01 -1.92632869e-01  3.86409759e-02]
 [ 2.36563123e-01  1.49636820e+00  1.46224970e+00]
 [-4.75245410e-02 -3.38608471e-02 -1.99626365e-02]
 [-5.70972182e-02  4.50961999e-01 -2.19733853e-01]
 [-1.67442492e-01  1.57434784e-01  3.35952649e-01]
 [-3.23249230e-02  5.82691936e-02  2.73127539e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 8.28357327e-01  1.66359815e+00 -2.70702219e-01]
 [-8.64618521e-04  2.09067397e-02  6.44967586e-02]
 [-4.00346364e-01 -1.18406109e-03 -8.80381016e-01]
 [ 1.79035065e+00 -3.17035599e+00  2.67003868e+00]
 [ 1.33433875e-02 -9.06901699e-02  3.48296617e-02]
 [ 7.97979690e-02  1.11796866e-01 -8.28344814e-02]
 [-1.54794407e-02  1.60950315e-01 -7.79301465e-02]
 [-2.81533839e-01 -1.82118385e+00 -1.99262133e-01]
 [ 2.02366309e-02 -1.63923195e-02  1.44961919e-02]
 [ 8.95461990e-02  8.18002064e-02  2.20806970e-01]
 [ 2.92255316e-02 -2.68692446e-02  3.88065688e-02]
 [ 1.09054967e-01 -5.03240760e-02  4.77009378e-03]
 [ 1.26514592e-01  1.14623862e-01  1.10127115e-01]
 [-1.47304161e-01  9.55732471e-03  5.39395085e-02]
 [-7.60597023e-03 -1.38075878e-01  4.43350363e-02]
 [ 4.74388922e-02 -5.60047255e-03  1.72132276e-01]
 [ 2.53451828e-01 -7.35270403e-02  1.17990983e-01]
 [-4.94930141e-02  1.08454101e-02  9.16096109e-02]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 7.32539398e-02 -2.50843248e-03  8.88498380e-02]
 [-1.53209477e-02 -5.62171027e-02 -3.98297269e-02]
 [ 2.01709640e-02 -2.24739829e-03 -2.87316807e-02]
 [-4.88784954e-02 -5.78571005e-02  1.35250036e-02]
 [ 4.08936223e-01  5.07663235e-02  8.83297867e-02]
 [ 1.20728225e-01  2.97691006e-01 -1.65512314e-01]
 [ 1.86122526e-02  3.15708149e-02  6.95274674e-02]
 [ 2.74566686e+00  1.91785896e+00  2.16887366e-01]
 [-9.53480648e-02 -2.73969842e-02 -1.93572585e-02]
 [ 3.62703490e-02 -1.29846190e-02 -1.36280242e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.76761186]
curr_Stock_Price:  99.2937589149147
curr_Factors:  [99.29375891 -0.97399593 -0.99982406]
mat_Sqrt:  [[13.79440024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095908 -0.03456511  0.33738038]
Stock Position:  -0.0009590802513239819
Bond Position:  [-2.67238118]


portfolio before change:  [-2.76780405]
curr_Stock_Price:  99.14582040467322
curr_Factors:  [99.1458204  -1.02077089 -1.0157409 ]
mat_Sqrt:  [[12.93685103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05684827 0.06191193 0.4996569 ]
Stock Position:  0.056848273819242075
Bond Position:  [-8.40407279]


portfolio before change:  [-2.74664151]
curr_Stock_Price:  99.53656415326651
curr_Factors:  [99.53656415 -1.0196323  -1.0141468 ]
mat_Sqrt:  [[13.0233768   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02569599 -0.06217199  0.11023195]
Stock Position:  -0.02569599239495825
Bond Position:  [-0.18895072]


portfolio before change:  [-2.72192089]
curr_Stock_Price:  98.57360300889317
curr_Factors:  [98.57360301 -0.78577821 -1.02288999]
mat_Sqrt:  [[16.15347674  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05203143 0.48295076 4.17139137]
Stock Position:  0.05203142862496553
Bond Position:  [-7.85084628]


portfolio before change:  [-2.72002171]
curr_Stock_Price:  98.6289657179775
curr_Factors:  [98.62896572 -0.77293555 -1.03350348]
mat_Sqrt:  [[16.19861852  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361211 -0.01092854 -0.05694785]
Stock Position:  -0.003612111339407566
Bond Position:  [-2.3637629]


portfolio before change:  [-2.7158165]
curr_Stock_Price:  97.38296360578335
curr_Factors:  [97.38296361 -0.74117949 -1.01481558]
mat_Sqrt:  [[16.82147277  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.88412841e-04  1.45547359e-01 -6.26839521e-01]
Stock Position:  -0.0005884128408746082
Bond Position:  [-2.65851511]


portfolio before change:  [-2.71546797]
curr_Stock_Price:  96.2258377557991
curr_Factors:  [96.22583776 -0.58252337 -0.98909741]
mat_Sqrt:  [[19.98690127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033387   0.05081186  0.9583794 ]
Stock Position:  -0.0033386968404156316
Bond Position:  [-2.39419907]


portfolio before change:  [-2.71973124]
curr_Stock_Price:  97.41312242451049
curr_Factors:  [97.41312242 -0.54042795 -1.0088238 ]
mat_Sqrt:  [[20.69121433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071797  0.0188063   0.07791568]
Stock Position:  -0.000717965649990656
Bond Position:  [-2.64979197]


portfolio before change:  [-2.72000664]
curr_Stock_Price:  97.3353338024629
curr_Factors:  [97.3353338  -0.73765196 -1.03074297]
mat_Sqrt:  [[16.60605083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00313086  0.0064198  -0.11330016]
Stock Position:  0.0031308589778106578
Bond Position:  [-3.02474984]


portfolio before change:  [-2.71853539]
curr_Stock_Price:  97.92602512166775
curr_Factors:  [97.92602512 -0.74145583 -1.01939733]
mat_Sqrt:  [[16.83330191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [5.19250027e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  5.192500269872546e-05
Bond Position:  [-2.72362019]


portfolio before change:  [-2.71885329]
curr_Stock_Price:  98.36072282684559
curr_Factors:  [98.36072283 -0.7911283  -0.99756512]
mat_Sqrt:  [[16.44379408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06766571  0.53692399 -0.77223808]
Stock Position:  0.06766571100654006
Bond Position:  [-9.37450153]


portfolio before change:  [-2.70652177]
curr_Stock_Price:  98.5602833270836
curr_Factors:  [98.56028333 -0.8052408  -1.00538789]
mat_Sqrt:  [[16.11966067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00102783 0.00674762 0.1839913 ]
Stock Position:  0.0010278316586886341
Bond Position:  [-2.80782515]


portfolio before change:  [-2.70714963]
curr_Stock_Price:  98.29092127825251
curr_Factors:  [98.29092128 -0.51118908 -0.99686011]
mat_Sqrt:  [[21.75584523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.66730654e-02 -3.82154073e-04 -2.51148199e+00]
Stock Position:  -0.02667306537962465
Bond Position:  [-0.08542946]


portfolio before change:  [-2.74950895]
curr_Stock_Price:  99.87861445161009
curr_Factors:  [99.87861445 -0.86024808 -1.01310805]
mat_Sqrt:  [[15.34208121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11003877 -1.023228    7.61687715]
Stock Position:  0.11003877417658203
Bond Position:  [-13.74002925]


portfolio before change:  [-2.77663996]
curr_Stock_Price:  99.64766501466724
curr_Factors:  [99.64766501 -0.77405814 -1.00692521]
mat_Sqrt:  [[16.78788098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00011561 -0.02927013  0.09935933]
Stock Position:  0.00011561370148648539
Bond Position:  [-2.78816059]


portfolio before change:  [-2.7771206]
curr_Stock_Price:  98.50502178712317
curr_Factors:  [98.50502179 -0.60309039 -1.04393592]
mat_Sqrt:  [[18.97422024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00451718  0.03608228 -0.23630372]
Stock Position:  0.004517175927259435
Bond Position:  [-3.22208512]


portfolio before change:  [-2.77724971]
curr_Stock_Price:  98.56560712142202
curr_Factors:  [98.56560712 -0.51468745 -1.034725  ]
mat_Sqrt:  [[20.93264587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.00809761e-05  5.19464909e-02 -2.22313016e-01]
Stock Position:  7.008097612384977e-05
Bond Position:  [-2.78415729]


portfolio before change:  [-2.77754009]
curr_Stock_Price:  99.38847500452944
curr_Factors:  [99.388475   -0.59086671 -1.02299859]
mat_Sqrt:  [[19.78988319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03506618 -0.58778456 -0.5684394 ]
Stock Position:  -0.03506618215223488
Bond Position:  [0.70763428]


portfolio before change:  [-2.72797967]
curr_Stock_Price:  97.97765821295039
curr_Factors:  [97.97765821 -0.4157062  -1.0029447 ]
mat_Sqrt:  [[23.71454524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00083702 -0.0052906   0.0413536 ]
Stock Position:  0.000837021553363408
Bond Position:  [-2.80998908]


portfolio before change:  [-2.72754881]
curr_Stock_Price:  98.91207593210794
curr_Factors:  [98.91207593 -0.4294419  -1.00470442]
mat_Sqrt:  [[23.57259993  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00641913 0.0264009  0.62990082]
Stock Position:  0.006419131982965986
Bond Position:  [-3.36247848]


portfolio before change:  [-2.73130587]
curr_Stock_Price:  98.39226722949688
curr_Factors:  [98.39226723 -0.47675198 -1.00183347]
mat_Sqrt:  [[22.42949355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141163 -0.00867201  0.11070434]
Stock Position:  0.0014116336422238993
Bond Position:  [-2.8701997]


portfolio before change:  [-2.72919308]
curr_Stock_Price:  100.14314044743185
curr_Factors:  [100.14314045  -0.89397848  -1.01066791]
mat_Sqrt:  [[14.90883777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00669108 -0.01624203  0.01360775]
Stock Position:  0.006691084928625574
Bond Position:  [-3.39925933]


portfolio before change:  [-2.72464064]
curr_Stock_Price:  100.88702183561334
curr_Factors:  [100.88702184  -0.85308341  -1.00719764]
mat_Sqrt:  [[15.7009346   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01097971 0.03699469 0.31416201]
Stock Position:  0.010979708991633612
Bond Position:  [-3.83235078]


portfolio before change:  [-2.72424839]
curr_Stock_Price:  100.966379570095
curr_Factors:  [100.96637957  -0.61111258  -1.02818932]
mat_Sqrt:  [[19.59913989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00685453  0.00308461  0.1538744 ]
Stock Position:  -0.0068545316478029
Bond Position:  [-2.03217114]


portfolio before change:  [-2.72663847]
curr_Stock_Price:  101.27800516724612
curr_Factors:  [101.27800517  -0.89326821  -0.97680862]
mat_Sqrt:  [[15.60813787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00171326 -0.0445638   0.12647552]
Stock Position:  -0.0017132562328685847
Bond Position:  [-2.5531233]


portfolio before change:  [-2.72593308]
curr_Stock_Price:  100.6799914393455
curr_Factors:  [100.67999144  -0.92464003  -0.94623812]
mat_Sqrt:  [[15.50354857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00525248 -0.00180754  0.49104547]
Stock Position:  0.0052524784156897635
Bond Position:  [-3.25475256]


portfolio before change:  [-2.72102794]
curr_Stock_Price:  101.69132526237836
curr_Factors:  [101.69132526  -0.69758953  -0.94931645]
mat_Sqrt:  [[19.59032883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0134009  -0.02373075  0.33659543]
Stock Position:  0.013400897682147321
Bond Position:  [-4.08378298]


portfolio before change:  [-2.7170291]
curr_Stock_Price:  102.02782110025548
curr_Factors:  [102.0278211   -0.81059518  -0.92035881]
mat_Sqrt:  [[18.07069455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158154  0.00350034  0.26133672]
Stock Position:  -0.001581536914020507
Bond Position:  [-2.55566833]


portfolio before change:  [-2.71588356]
curr_Stock_Price:  101.10149550654303
curr_Factors:  [101.10149551  -0.75038451  -0.90692541]
mat_Sqrt:  [[19.27511724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00114651 -0.02321455 -0.0028026 ]
Stock Position:  -0.0011465057329740512
Bond Position:  [-2.59997011]


portfolio before change:  [-2.7177504]
curr_Stock_Price:  102.44629962429578
curr_Factors:  [102.44629962  -0.84513928  -0.90958005]
mat_Sqrt:  [[17.71867955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00512895 -0.00080959  0.25346386]
Stock Position:  0.0051289547358850315
Bond Position:  [-3.24319283]


portfolio before change:  [-2.71558742]
curr_Stock_Price:  102.94706546614493
curr_Factors:  [102.94706547  -0.88614339  -0.89361041]
mat_Sqrt:  [[17.36507727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0020113  -0.01814399 -0.11362312]
Stock Position:  -0.0020113025796670327
Bond Position:  [-2.50852972]


portfolio before change:  [-2.71921271]
curr_Stock_Price:  104.59361336008716
curr_Factors:  [104.59361336  -1.01000029  -0.91840524]
mat_Sqrt:  [[15.20580043  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091066 -0.00072534 -0.08196349]
Stock Position:  0.00091066471971981
Bond Position:  [-2.81446243]


portfolio before change:  [-2.72008776]
curr_Stock_Price:  104.01907237103924
curr_Factors:  [104.01907237  -0.85166562  -0.89632442]
mat_Sqrt:  [[18.11217273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319828 -0.0186733   0.03858307]
Stock Position:  -0.003198277072246826
Bond Position:  [-2.38740594]


portfolio before change:  [-2.72233134]
curr_Stock_Price:  104.6272551987663
curr_Factors:  [104.6272552   -0.48807333  -0.90416221]
mat_Sqrt:  [[26.00187219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01681914 0.01638476 0.2519803 ]
Stock Position:  0.016819138813994994
Bond Position:  [-4.48207167]


portfolio before change:  [-2.69001341]
curr_Stock_Price:  106.58206517929379
curr_Factors:  [106.58206518  -0.34887897  -0.90653765]
mat_Sqrt:  [[30.37131651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00486344  0.09607936 -0.47216056]
Stock Position:  0.004863440378062178
Bond Position:  [-3.20836893]


portfolio before change:  [-2.68664191]
curr_Stock_Price:  107.35776604708512
curr_Factors:  [107.35776605  -0.53452655  -0.92187313]
mat_Sqrt:  [[25.02229377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00156856 0.01018944 0.19834251]
Stock Position:  0.0015685553636987683
Bond Position:  [-2.85503851]


portfolio before change:  [-2.68860247]
curr_Stock_Price:  106.33538826684888
curr_Factors:  [106.33538827  -0.62389774  -0.89826039]
mat_Sqrt:  [[23.20667634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.13709073 0.61898632 0.61871929]
Stock Position:  0.13709072675314157
Bond Position:  [-17.26619812]


portfolio before change:  [-2.92442578]
curr_Stock_Price:  104.63093376350615
curr_Factors:  [104.63093376  -1.00737136  -0.87771374]
mat_Sqrt:  [[15.88466444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00660333 -0.00884234 -0.05522087]
Stock Position:  -0.006603333365394687
Bond Position:  [-2.23351285]


portfolio before change:  [-2.9258694]
curr_Stock_Price:  104.80727103539472
curr_Factors:  [104.80727104  -1.05060202  -0.86457726]
mat_Sqrt:  [[15.43972707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.75770037e-04 -4.19076775e-03 -3.88769597e-01]
Stock Position:  0.0003757700365079251
Bond Position:  [-2.96525283]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.92642025]
Stock Price:  104.32782083941304
PL:  [-7.25424108]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-3.72148539e-02 -5.00351866e-02  2.69546037e-01]
 [ 6.46224024e-01  1.94935795e-01  1.65732173e-01]
 [-2.10997495e-01 -1.07748443e-01  3.59511190e-02]
 [ 2.09550246e-01  1.51189458e+00  1.32983181e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.23107534e-03  1.00468594e-01 -2.33295399e-02]
 [-1.23363990e-01  1.92386360e-01  7.50329808e-02]
 [-2.39970546e-02  4.09197932e-02  3.43451142e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 5.91756734e-01  1.26269801e+00 -1.76255036e-01]
 [-8.56253089e-04  3.83973932e-02  5.86323695e-02]
 [-4.80129168e-01 -4.85085233e-02 -1.16498438e+00]
 [ 2.16312282e+00 -3.31731617e+00  2.82212931e+00]
 [ 2.11288283e-03  3.26466801e-02 -7.05865520e-03]
 [ 1.26266923e-02  2.78535133e-01 -1.44048076e-01]
 [ 2.97441336e-02 -1.63358602e-01 -2.56940252e-02]
 [-2.96087244e-01 -1.88016453e+00 -1.90629523e-01]
 [ 3.45043066e-02 -1.84062762e-01  3.12777597e-01]
 [-2.07457528e-01  4.99126286e-01  2.97752262e-01]
 [ 2.05939642e-02  6.23318178e-02 -3.26323150e-02]
 [ 1.15731392e-01 -5.15422597e-02  5.81205380e-02]
 [-2.88447480e-02 -1.00956657e-01 -9.93502382e-02]
 [-2.00956452e-01  4.86171819e-02  3.81343159e-02]
 [ 1.10021505e-01 -5.46513958e-03 -3.91137764e-02]
 [-3.34752040e-02 -5.62974784e-02  1.82720941e-01]
 [-1.52329893e-01 -1.23924837e-01 -2.35991990e-02]
 [-2.25505430e-01  1.64941574e-01  3.05680837e-01]
 [ 1.77943661e-01  1.51061665e-01  2.80331459e-01]
 [-1.41969497e-01  9.07299333e-02 -1.89310492e-01]
 [ 1.43367432e-01  1.71809717e-02  4.52710100e-02]
 [ 1.12818686e-01 -2.24020513e-03 -8.27341253e-02]
 [ 1.32802858e-01  1.19215641e-01  1.58228507e-01]
 [ 1.08842089e-02 -7.99145682e-03  6.65218918e-02]
 [-9.22226713e-02  1.19549498e-01  3.27888867e-02]
 [-8.56228547e-02 -4.87241148e-02 -4.96646060e-02]
 [ 2.32519658e+00  1.53498108e+00  1.77162481e-01]
 [ 2.42898771e-01 -4.02580788e-01  1.02692301e-01]
 [ 2.42205319e-02 -1.40838867e-02  2.85096346e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.60243626]
curr_Stock_Price:  99.45276064125359
curr_Factors:  [99.45276064 -0.759183   -1.02212148]
mat_Sqrt:  [[16.74966542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.53299250e-04 -1.61487870e-02  7.68939817e-01]
Stock Position:  0.00045329924993147845
Bond Position:  [-1.64751812]


portfolio before change:  [-1.60265101]
curr_Stock_Price:  99.43334810349882
curr_Factors:  [99.4333481  -0.74643961 -1.02052506]
mat_Sqrt:  [[16.98826623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04237307 0.06291526 0.47278776]
Stock Position:  0.04237307416748795
Bond Position:  [-5.81594765]


portfolio before change:  [-1.56426192]
curr_Stock_Price:  100.35648467557158
curr_Factors:  [100.35648468  -0.98417775  -0.97426918]
mat_Sqrt:  [[14.15802729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01593817 -0.03477566  0.10255854]
Stock Position:  -0.01593817118792127
Bond Position:  [0.03523691]


portfolio before change:  [-1.54614486]
curr_Stock_Price:  99.22005221384224
curr_Factors:  [99.22005221 -1.04649818 -0.96179744]
mat_Sqrt:  [[13.3170413   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05929359 0.48796188 3.79364001]
Stock Position:  0.05929359229606474
Bond Position:  [-7.42925818]


portfolio before change:  [-1.55516965]
curr_Stock_Price:  99.08351012155944
curr_Factors:  [99.08351012 -1.03347056 -0.96290269]
mat_Sqrt:  [[13.45821602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435764 -0.01106097 -0.05874131]
Stock Position:  -0.004357635578198098
Bond Position:  [-1.12339982]


portfolio before change:  [-1.55654435]
curr_Stock_Price:  99.36675300810649
curr_Factors:  [99.36675301 -0.99970436 -0.95990974]
mat_Sqrt:  [[14.00204622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00156956  0.0324261  -0.06655268]
Stock Position:  0.0015695576591699277
Bond Position:  [-1.7125062]


portfolio before change:  [-1.55881238]
curr_Stock_Price:  98.05813344487551
curr_Factors:  [98.05813344 -0.90338232 -0.94631557]
mat_Sqrt:  [[15.42304186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445938  0.06209243  0.21404821]
Stock Position:  -0.004459382650704366
Bond Position:  [-1.12153364]


portfolio before change:  [-1.55129069]
curr_Stock_Price:  96.33998328176608
curr_Factors:  [96.33998328 -0.71039884 -0.93322415]
mat_Sqrt:  [[18.62044993  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046367  0.01320681  0.09797705]
Stock Position:  -0.0004636660108606168
Bond Position:  [-1.50662111]


portfolio before change:  [-1.55155568]
curr_Stock_Price:  96.50529007586732
curr_Factors:  [96.50529008 -0.98459773 -0.91421084]
mat_Sqrt:  [[14.4513705   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00359767  0.0064198  -0.11330016]
Stock Position:  0.0035976659324632302
Bond Position:  [-1.89874947]


portfolio before change:  [-1.55026818]
curr_Stock_Price:  96.92913716161262
curr_Factors:  [96.92913716 -1.1914138  -0.90747905]
mat_Sqrt:  [[11.88274456  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [7.35578588e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  7.355785882555341e-05
Bond Position:  [-1.55739807]


portfolio before change:  [-1.55045557]
curr_Stock_Price:  97.02830044697806
curr_Factors:  [97.02830045 -1.47641358 -0.90993494]
mat_Sqrt:  [[ 8.9231959   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0911698   0.40753403 -0.50280656]
Stock Position:  0.09116979905828052
Bond Position:  [-10.39650622]


portfolio before change:  [-1.64259853]
curr_Stock_Price:  96.03188150588578
curr_Factors:  [96.03188151 -1.40974516 -0.90433873]
mat_Sqrt:  [[ 9.49339544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00199611 0.01239271 0.16726183]
Stock Position:  0.0019961102879704055
Bond Position:  [-1.83428875]


portfolio before change:  [-1.64221595]
curr_Stock_Price:  96.33841662126184
curr_Factors:  [96.33841662 -1.30242329 -0.89891678]
mat_Sqrt:  [[10.66030568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.068275   -0.01565606 -3.32337616]
Stock Position:  -0.06827499982269018
Bond Position:  [4.93528943]


portfolio before change:  [-1.63562691]
curr_Stock_Price:  96.25094546736892
curr_Factors:  [96.25094547 -1.24449828 -0.91699776]
mat_Sqrt:  [[11.083558    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.18604524 -1.07065919  8.05074939]
Stock Position:  0.18604524136489642
Bond Position:  [-19.54265729]


portfolio before change:  [-1.63792687]
curr_Stock_Price:  96.25171422003262
curr_Factors:  [96.25171422 -1.47541779 -0.90192339]
mat_Sqrt:  [[ 8.93186839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082133  0.01053667 -0.02013638]
Stock Position:  0.0008213305678829316
Bond Position:  [-1.71698134]


portfolio before change:  [-1.63819473]
curr_Stock_Price:  96.18691261603824
curr_Factors:  [96.18691262 -1.51490421 -0.8973746 ]
mat_Sqrt:  [[ 8.61939151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00464983  0.08989683 -0.41092907]
Stock Position:  0.004649834943273496
Bond Position:  [-2.085448]


portfolio before change:  [-1.63897639]
curr_Stock_Price:  96.07487436708905
curr_Factors:  [96.07487437 -1.36957434 -0.9116176 ]
mat_Sqrt:  [[ 9.81523616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090126 -0.05272376 -0.0732979 ]
Stock Position:  -0.0009012592530334201
Bond Position:  [-1.55238802]


portfolio before change:  [-1.63830084]
curr_Stock_Price:  95.10999588300217
curr_Factors:  [95.10999588 -1.2285253  -0.9061485 ]
mat_Sqrt:  [[11.24991171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06389262 -0.60682049 -0.54381297]
Stock Position:  -0.06389261780173945
Bond Position:  [4.43852578]


portfolio before change:  [-1.62381285]
curr_Stock_Price:  94.89192461077593
curr_Factors:  [94.89192461 -1.28767329 -0.92043486]
mat_Sqrt:  [[10.42941786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00582757 -0.059406    0.89226742]
Stock Position:  0.005827565163778915
Bond Position:  [-2.17680172]


portfolio before change:  [-1.62391747]
curr_Stock_Price:  94.92066578446669
curr_Factors:  [94.92066578 -1.00016887 -0.92282995]
mat_Sqrt:  [[13.87436131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00322864  0.16109232  0.84940432]
Stock Position:  -0.003228644166448038
Bond Position:  [-1.31745242]


portfolio before change:  [-1.62605534]
curr_Stock_Price:  95.53181331296867
curr_Factors:  [95.53181331 -0.83437823 -0.93581983]
mat_Sqrt:  [[16.26899676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00163848  0.02011751 -0.09309091]
Stock Position:  0.0016384753304931725
Bond Position:  [-1.78258186]


portfolio before change:  [-1.62618214]
curr_Stock_Price:  95.5904275806208
curr_Factors:  [95.59042758 -0.82332279 -0.94103574]
mat_Sqrt:  [[16.37431832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00714987 -0.01663519  0.16580172]
Stock Position:  0.007149865756850846
Bond Position:  [-2.30964086]


portfolio before change:  [-1.62600083]
curr_Stock_Price:  95.65616740595007
curr_Factors:  [95.65616741 -0.97321042 -0.95623745]
mat_Sqrt:  [[13.89198849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0050196  -0.03258362 -0.28341858]
Stock Position:  -0.0050195997275081766
Bond Position:  [-1.14584516]


portfolio before change:  [-1.62237276]
curr_Stock_Price:  94.90485008784088
curr_Factors:  [94.90485009 -0.8424537  -0.95679344]
mat_Sqrt:  [[15.69948131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01167226  0.01569113  0.10878659]
Stock Position:  -0.011672256722252626
Bond Position:  [-0.51461898]


portfolio before change:  [-1.61748398]
curr_Stock_Price:  94.48050134229726
curr_Factors:  [94.48050134 -0.8199642  -0.94265848]
mat_Sqrt:  [[16.2123095   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00622502 -0.00176387 -0.11158072]
Stock Position:  0.006225015153324749
Bond Position:  [-2.20562654]


portfolio before change:  [-1.62485849]
curr_Stock_Price:  93.34013632619904
curr_Factors:  [93.34013633 -1.00648447 -0.9522888 ]
mat_Sqrt:  [[13.16388287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058259 -0.01816993  0.52125199]
Stock Position:  -0.0005825881895878563
Bond Position:  [-1.57047963]


portfolio before change:  [-1.62504587]
curr_Stock_Price:  93.32478972088157
curr_Factors:  [93.32478972 -1.0042597  -0.94747616]
mat_Sqrt:  [[13.25466963  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01376444 -0.03999657 -0.06732195]
Stock Position:  -0.013764440405656145
Bond Position:  [-0.34048237]


portfolio before change:  [-1.62131433]
curr_Stock_Price:  93.05059678792458
curr_Factors:  [93.05059679 -0.57373634 -0.93608546]
mat_Sqrt:  [[20.55946857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00629588  0.05323466  0.87202234]
Stock Position:  -0.006295884156976061
Bond Position:  [-1.03547855]


portfolio before change:  [-1.61842297]
curr_Stock_Price:  92.57079210492577
curr_Factors:  [92.5707921  -0.52729011 -0.93263479]
mat_Sqrt:  [[21.49991055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01237221 0.04875494 0.79970762]
Stock Position:  0.012372210236684405
Bond Position:  [-2.76372828]


portfolio before change:  [-1.63679477]
curr_Stock_Price:  91.11379250588817
curr_Factors:  [91.11379251 -0.29142727 -0.92446836]
mat_Sqrt:  [[27.01017287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00600115  0.02928296 -0.54005014]
Stock Position:  -0.006001152592817833
Bond Position:  [-1.09000699]


portfolio before change:  [-1.64235677]
curr_Stock_Price:  92.01790928958322
curr_Factors:  [92.01790929 -0.30042428 -0.9053372 ]
mat_Sqrt:  [[27.55604008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00566538 0.00554513 0.12914559]
Stock Position:  0.005665378218079504
Bond Position:  [-2.16367303]


portfolio before change:  [-1.63794429]
curr_Stock_Price:  92.8445001505172
curr_Factors:  [92.84450015 -0.37946105 -0.91057548]
mat_Sqrt:  [[25.55644452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00373578 -0.00072302 -0.23601743]
Stock Position:  0.00373578465181704
Bond Position:  [-1.98479135]


portfolio before change:  [-1.64239539]
curr_Stock_Price:  91.71944077865115
curr_Factors:  [91.71944078 -0.50945821 -0.88629969]
mat_Sqrt:  [[22.71388619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00834009 0.03847668 0.45138189]
Stock Position:  0.008340092317406036
Bond Position:  [-2.40734399]


portfolio before change:  [-1.65423118]
curr_Stock_Price:  90.33637945604451
curr_Factors:  [90.33637946 -0.43849343 -0.85352413]
mat_Sqrt:  [[24.81684585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00092001 -0.00257923  0.18976844]
Stock Position:  0.0009200074823632584
Bond Position:  [-1.73734133]


portfolio before change:  [-1.65289396]
curr_Stock_Price:  92.0259428626466
curr_Factors:  [92.02594286 -0.17099018 -0.83741054]
mat_Sqrt:  [[33.57124199  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182081  0.03858443  0.09353757]
Stock Position:  -0.0018208062943061776
Bond Position:  [-1.48533254]


portfolio before change:  [-1.65066657]
curr_Stock_Price:  90.700671174986
curr_Factors:  [ 9.07006712e+01  6.60280420e-02 -8.08292923e-01]
mat_Sqrt:  [[43.17665156  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244823 -0.01572564 -0.1416793 ]
Stock Position:  -0.002448229875519619
Bond Position:  [-1.42861048]


portfolio before change:  [-1.64459397]
curr_Stock_Price:  88.14732293767065
curr_Factors:  [ 8.81473229e+01 -8.50925073e-02 -7.80999209e-01]
mat_Sqrt:  [[37.0740707   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0721444  0.49541301 0.50539525]
Stock Position:  0.07214439545572955
Bond Position:  [-8.0039293]


portfolio before change:  [-1.59487687]
curr_Stock_Price:  88.85032502671835
curr_Factors:  [ 8.88503250e+01 -6.21246211e-02 -8.03185039e-01]
mat_Sqrt:  [[37.39898455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.004858   -0.12993239  0.29295255]
Stock Position:  0.004858000616602844
Bond Position:  [-2.0265118]


portfolio before change:  [-1.59388956]
curr_Stock_Price:  89.10570475413672
curr_Factors:  [ 8.91057048e+01  1.18994562e-02 -7.90847513e-01]
mat_Sqrt:  [[40.88958158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00066435 -0.00454555  0.08133005]
Stock Position:  0.0006643544464987288
Bond Position:  [-1.65308733]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.59240504]
Stock Price:  91.65129480013097
PL:  [-1.59240504]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-4.49271462e-02 -2.97599696e-02  3.23299708e-01]
 [ 1.04536866e+00  2.30158683e-01  2.84384987e-01]
 [-1.80808757e-01 -7.99603321e-02  3.50705565e-02]
 [ 1.57702082e-01  7.59137156e-01  9.25899856e-01]
 [-4.84049570e-02 -2.91874145e-02 -1.28022215e-02]
 [-1.35261860e-02  2.36793228e-01 -1.08419216e-01]
 [-5.43566407e-02 -3.25353597e-02 -2.24886572e-02]
 [-8.74788270e-03  9.15128089e-03  4.72220794e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 8.57002420e-01  1.80652215e+00 -2.58356772e-01]
 [-2.89275138e-03 -1.97533537e-01  4.04021736e-01]
 [-5.29973027e-01 -7.84906527e-02 -1.25837929e+00]
 [ 2.04829394e+00 -3.00248160e+00  2.55554415e+00]
 [-1.60832343e-02  6.16900669e-02 -3.97155563e-02]
 [ 7.89329806e-03  5.23623139e-01 -2.81859642e-01]
 [ 1.43849411e-02 -2.37572494e-01 -1.73812735e-01]
 [-3.12053937e-01 -1.97355996e+00 -1.91521245e-01]
 [ 5.02531559e-02 -2.07534812e-01  2.21858762e-01]
 [-4.48432813e-01  6.27355679e-01  4.49938461e-01]
 [ 6.68050728e-03  2.19208054e-01 -1.46874693e-01]
 [ 1.04591688e-01 -4.93997418e-02  8.48840862e-02]
 [ 5.81334581e-02 -1.39614457e-01 -1.42341300e-01]
 [-2.67200784e-01  9.68442785e-02  1.86196888e-02]
 [ 1.31296009e-01 -4.02547917e-02 -4.62798423e-02]
 [-3.50106046e-02 -5.65670455e-02  1.80700002e-01]
 [-1.62278328e-01 -1.11131228e-01 -3.27323684e-02]
 [-2.16117027e-01  1.63826808e-01  2.83831003e-01]
 [ 1.79877246e-01  1.45949617e-01  2.66374716e-01]
 [-1.41955022e-01  9.04540587e-02 -1.91004375e-01]
 [ 1.41955944e-01  1.65323812e-02  4.32270504e-02]
 [ 1.00229375e-01 -2.20227397e-03 -7.93151023e-02]
 [ 1.10504248e-01  1.03046376e-01  1.41943721e-01]
 [-4.73156677e-03 -3.44039436e-02  1.84129172e-02]
 [-9.77238274e-02  1.12163671e-01  2.74198919e-02]
 [-1.12013844e-01 -6.37952895e-02 -7.48736176e-02]
 [ 1.46847393e+00  9.64644637e-01  1.37125790e-01]
 [-2.49625220e-02  2.00873565e-03  5.11199908e-02]
 [ 3.18487396e-02 -1.46986391e-02 -5.16311738e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.43111506]
curr_Stock_Price:  99.33967780681726
curr_Factors:  [99.33967781 -0.69216373 -1.01096955]
mat_Sqrt:  [[18.0909494   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.28668620e-04 -9.60498887e-03  9.22284079e-01]
Stock Position:  0.0008286686195283972
Bond Position:  [-2.51343474]


portfolio before change:  [-2.43027716]
curr_Stock_Price:  100.72998105613728
curr_Factors:  [100.72998106  -0.5055002   -1.0392627 ]
mat_Sqrt:  [[21.49199597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05352688 0.0742834  0.81127121]
Stock Position:  0.05352687817800355
Bond Position:  [-7.82203858]


portfolio before change:  [-2.42436218]
curr_Stock_Price:  100.85875359920408
curr_Factors:  [100.8587536   -0.40071983  -1.05405912]
mat_Sqrt:  [[23.54567408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00806823 -0.02580709  0.10004654]
Stock Position:  -0.00806822701403216
Bond Position:  [-1.61061086]


portfolio before change:  [-2.41996189]
curr_Stock_Price:  100.28841388934421
curr_Factors:  [100.28841389  -0.2896045   -1.02764492]
mat_Sqrt:  [[26.86436682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01867376 0.24501046 2.64133457]
Stock Position:  0.01867376309299235
Bond Position:  [-4.29272397]


portfolio before change:  [-2.46118179]
curr_Stock_Price:  98.1097812899459
curr_Factors:  [98.10978129 -0.25849615 -1.01630247]
mat_Sqrt:  [[27.42043261  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207787 -0.0094202  -0.03652117]
Stock Position:  -0.0020778685856935536
Bond Position:  [-2.25732255]


portfolio before change:  [-2.46468185]
curr_Stock_Price:  99.65842710422085
curr_Factors:  [99.6584271  -0.34215118 -0.99972443]
mat_Sqrt:  [[26.04622921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00048675  0.07642469 -0.30928985]
Stock Position:  0.0004867518190334794
Bond Position:  [-2.51319077]


portfolio before change:  [-2.46601696]
curr_Stock_Price:  97.56097419001199
curr_Factors:  [97.56097419 -0.18821848 -0.99533915]
mat_Sqrt:  [[29.87195054  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219565 -0.01050074 -0.06415388]
Stock Position:  -0.0021956507665189845
Bond Position:  [-2.25180713]


portfolio before change:  [-2.4653475]
curr_Stock_Price:  97.12786620546315
curr_Factors:  [ 9.71278662e+01  9.47882681e-02 -1.00624316e+00]
mat_Sqrt:  [[39.03947947  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [7.06792539e-05 2.95356321e-03 1.34711448e-01]
Stock Position:  7.067925386422887e-05
Bond Position:  [-2.47221242]


portfolio before change:  [-2.4657946]
curr_Stock_Price:  95.17462862079336
curr_Factors:  [ 9.51746286e+01 -4.09591928e-02 -9.83969504e-01]
mat_Sqrt:  [[34.15075531  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0015224   0.0064198  -0.11330016]
Stock Position:  0.0015224027368388546
Bond Position:  [-2.61068871]


portfolio before change:  [-2.46563287]
curr_Stock_Price:  95.49522972738811
curr_Factors:  [ 9.54952297e+01 -8.74482085e-02 -1.03165778e+00]
mat_Sqrt:  [[31.18603213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.80275876e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  2.8027587582868576e-05
Bond Position:  [-2.46830937]


portfolio before change:  [-2.46591144]
curr_Stock_Price:  96.56512694250712
curr_Factors:  [96.56512694 -0.15855931 -1.04605757]
mat_Sqrt:  [[28.95088547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0405176   0.58305252 -0.73701996]
Stock Position:  0.04051759851354289
Bond Position:  [-6.37849848]


portfolio before change:  [-2.56007896]
curr_Stock_Price:  94.26069241339809
curr_Factors:  [94.26069241 -0.2507713  -1.02799831]
mat_Sqrt:  [[26.24025426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149604 -0.06375367  1.15256155]
Stock Position:  0.001496040220496151
Bond Position:  [-2.70109674]


portfolio before change:  [-2.56046756]
curr_Stock_Price:  94.2266413330883
curr_Factors:  [94.22664133 -0.30854701 -0.99816363]
mat_Sqrt:  [[25.50800482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03147484 -0.02533275 -3.58980584]
Stock Position:  -0.03147484352061431
Bond Position:  [0.40530124]


portfolio before change:  [-2.53639172]
curr_Stock_Price:  93.46332803016804
curr_Factors:  [93.46332803 -0.4343578  -0.9890862 ]
mat_Sqrt:  [[22.51372559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08692756 -0.96904677  7.29025614]
Stock Position:  0.08692755935698657
Bond Position:  [-10.66093072]


portfolio before change:  [-2.61014497]
curr_Stock_Price:  92.63021430372534
curr_Factors:  [92.6302143  -0.40832889 -0.98906113]
mat_Sqrt:  [[22.90202557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050641  0.01991038 -0.11329743]
Stock Position:  -0.0005064052555561614
Bond Position:  [-2.56323654]


portfolio before change:  [-2.61023771]
curr_Stock_Price:  92.18060562983375
curr_Factors:  [92.18060563 -0.43250574 -1.0044088 ]
mat_Sqrt:  [[21.90763517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00261293  0.16899864 -0.80406711]
Stock Position:  0.0026129276262744786
Bond Position:  [-2.85109896]


portfolio before change:  [-2.61170735]
curr_Stock_Price:  91.75455541349422
curr_Factors:  [91.75455541 -0.50492887 -1.01832547]
mat_Sqrt:  [[20.00261066  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347898 -0.07667619 -0.49583935]
Stock Position:  -0.003478981735368799
Bond Position:  [-2.29249493]


portfolio before change:  [-2.61560962]
curr_Stock_Price:  92.79384857027111
curr_Factors:  [92.79384857 -0.7748828  -1.04299718]
mat_Sqrt:  [[15.06690123  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05004342 -0.63696374 -0.5463568 ]
Stock Position:  -0.05004342136488615
Bond Position:  [2.02811205]


portfolio before change:  [-2.58500661]
curr_Stock_Price:  92.1873857613616
curr_Factors:  [92.18738576 -0.99894664 -1.01516055]
mat_Sqrt:  [[12.30143732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00432283 -0.06698157  0.63290129]
Stock Position:  0.004322829808599474
Bond Position:  [-2.98351699]


portfolio before change:  [-2.58843226]
curr_Stock_Price:  91.48120753611063
curr_Factors:  [91.48120754 -1.16901277 -0.9995246 ]
mat_Sqrt:  [[10.4603948   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02184727  0.20247817  1.28354919]
Stock Position:  -0.02184726981891792
Bond Position:  [-0.58981764]


portfolio before change:  [-2.57326065]
curr_Stock_Price:  90.78339303207528
curr_Factors:  [90.78339303 -1.1779426  -0.99327594]
mat_Sqrt:  [[10.35280847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00207147  0.0707491  -0.41899262]
Stock Position:  0.0020714662006670274
Bond Position:  [-2.76131538]


portfolio before change:  [-2.57273373]
curr_Stock_Price:  91.20440139804207
curr_Factors:  [91.2044014  -1.33078093 -1.00894279]
mat_Sqrt:  [[ 8.78793217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01272596 -0.0159437   0.24215067]
Stock Position:  0.012725962920794434
Bond Position:  [-3.73339757]


portfolio before change:  [-2.57421655]
curr_Stock_Price:  91.12455601669774
curr_Factors:  [91.12455602 -1.11949761 -1.03000071]
mat_Sqrt:  [[10.61989363  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.45655363e-05 -4.50603722e-02 -4.06060109e-01]
Stock Position:  5.456553630360347e-05
Bond Position:  [-2.57918881]


portfolio before change:  [-2.57449165]
curr_Stock_Price:  91.9917598023106
curr_Factors:  [91.9917598  -1.0244137  -1.03618779]
mat_Sqrt:  [[11.71766477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02079184  0.03125636  0.05311679]
Stock Position:  -0.020791839110612626
Bond Position:  [-0.66181378]


portfolio before change:  [-2.56833152]
curr_Stock_Price:  91.69150458064205
curr_Factors:  [91.69150458 -0.93535344 -1.02973231]
mat_Sqrt:  [[12.85000214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00884297 -0.01299218 -0.13202351]
Stock Position:  0.008842971327661903
Bond Position:  [-3.37915687]


portfolio before change:  [-2.56628732]
curr_Stock_Price:  91.97044053578684
curr_Factors:  [91.97044054 -0.80902892 -1.03731377]
mat_Sqrt:  [[14.51415726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066639 -0.01825694  0.51548681]
Stock Position:  -0.0006663887408773235
Bond Position:  [-2.50499925]


portfolio before change:  [-2.56693877]
curr_Stock_Price:  92.47811639614923
curr_Factors:  [92.4781164  -0.90228871 -1.04046823]
mat_Sqrt:  [[13.25288273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01446058 -0.03586745 -0.09337634]
Stock Position:  -0.014460579322696879
Bond Position:  [-1.22965164]


portfolio before change:  [-2.58052869]
curr_Stock_Price:  93.4072769436574
curr_Factors:  [93.40727694 -0.73892694 -1.05068041]
mat_Sqrt:  [[15.60141956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00799538  0.05287487  0.80969085]
Stock Position:  -0.00799537879962431
Bond Position:  [-1.83370213]


portfolio before change:  [-2.57486092]
curr_Stock_Price:  92.6697266872129
curr_Factors:  [92.66972669 -0.65680279 -1.05119171]
mat_Sqrt:  [[16.79443098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01572203 0.04710504 0.75989292]
Stock Position:  0.01572203299607759
Bond Position:  [-4.03181742]


portfolio before change:  [-2.59808842]
curr_Stock_Price:  91.22439935598625
curr_Factors:  [91.22439936 -0.68144618 -1.04370507]
mat_Sqrt:  [[16.25127153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00999797  0.02919392 -0.54488232]
Stock Position:  -0.009997972735588249
Bond Position:  [-1.68602936]


portfolio before change:  [-2.60691949]
curr_Stock_Price:  92.08660469572358
curr_Factors:  [92.0866047  -0.45633889 -1.07380763]
mat_Sqrt:  [[19.93711305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00773203 0.0053358  0.12331474]
Stock Position:  0.007732026530194396
Bond Position:  [-3.31893556]


portfolio before change:  [-2.60851691]
curr_Stock_Price:  91.93366502414773
curr_Factors:  [91.93366502 -0.43692866 -1.08362695]
mat_Sqrt:  [[20.09581674  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00415956 -0.00071078 -0.22626391]
Stock Position:  0.004159557755714038
Bond Position:  [-2.9909203]


portfolio before change:  [-2.6053349]
curr_Stock_Price:  92.78853968275237
curr_Factors:  [92.78853968 -0.38942444 -1.07126834]
mat_Sqrt:  [[21.53394142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00745394 0.03325807 0.40492593]
Stock Position:  0.00745393698262587
Bond Position:  [-3.29697483]


portfolio before change:  [-2.60670978]
curr_Stock_Price:  92.6593830448879
curr_Factors:  [92.65938304 -0.37449044 -1.05736996]
mat_Sqrt:  [[22.13300246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036126 -0.01110383  0.05252693]
Stock Position:  -0.0003612578721609196
Bond Position:  [-2.57323584]


portfolio before change:  [-2.60736073]
curr_Stock_Price:  93.57086459693494
curr_Factors:  [93.5708646  -0.13667944 -1.05958963]
mat_Sqrt:  [[28.28834802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244735  0.03620067  0.07822132]
Stock Position:  -0.0024473487049920402
Bond Position:  [-2.3783602]


portfolio before change:  [-2.61363628]
curr_Stock_Price:  96.01360595767893
curr_Factors:  [96.01360596 -0.1358426  -1.07794375]
mat_Sqrt:  [[28.52279394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00491956 -0.02058984 -0.21359359]
Stock Position:  -0.004919557178647811
Bond Position:  [-2.14129186]


portfolio before change:  [-2.61434636]
curr_Stock_Price:  96.10353166944638
curr_Factors:  [ 9.61035317e+01 -5.77484739e-02 -1.07149362e+00]
mat_Sqrt:  [[31.06817477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05450503 0.31133772 0.39118171]
Stock Position:  0.05450503249140475
Bond Position:  [-7.85247247]


portfolio before change:  [-2.59941524]
curr_Stock_Price:  96.39548154287613
curr_Factors:  [96.39548154 -0.11988295 -1.06738948]
mat_Sqrt:  [[29.40565199  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004801   0.00064832  0.1458311 ]
Stock Position:  -0.0004801004273485595
Bond Position:  [-2.55313573]


portfolio before change:  [-2.59980949]
curr_Stock_Price:  96.55187492261778
curr_Factors:  [96.55187492 -0.34958209 -1.03112793]
mat_Sqrt:  [[24.27314056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0007543  -0.00474397 -0.14728937]
Stock Position:  0.0007542997252392911
Bond Position:  [-2.67263854]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.60005966]
Stock Price:  96.66314300749676
PL:  [-2.60005966]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 2.69362537e-02 -7.43994329e-02  4.77911245e-02]
 [ 1.12941825e+00  2.33449765e-01  3.21873190e-01]
 [-2.46368391e-01 -1.40306622e-01  3.69828376e-02]
 [ 2.15588484e-01  1.34238265e+00  1.32805831e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-3.05860177e-02  3.17800048e-01 -1.49488387e-01]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [ 9.56001988e-02  1.17117314e-01 -7.18012694e-02]
 [ 3.84402963e-02  3.89346410e-02 -4.26097272e-02]
 [-1.47627085e-01 -7.90763805e-02 -4.84156323e-02]
 [ 8.39179971e-01  1.62316822e+00 -2.89828574e-01]
 [-3.84978534e-05  2.87161322e-03 -5.75269052e-02]
 [-1.87949148e-01  5.14009019e-03 -3.69356488e-01]
 [ 1.51208105e+00 -2.89160967e+00  2.41871050e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.35897417e-01 -1.57395649e-02 -2.60592355e-02]
 [-1.44269754e-01 -1.90140702e-01 -3.60959054e-02]
 [-2.78519100e-01 -1.81087408e+00 -2.01739633e-01]
 [ 1.02638914e-02  2.48919900e-02  3.66141138e-03]
 [ 8.72564456e-02  5.08580428e-02  2.14579867e-01]
 [ 2.46604309e-02  1.64818180e-02  7.57146266e-04]
 [ 4.09206094e-02 -3.98312710e-02  1.00060371e-02]
 [-1.90082457e-02 -1.04583779e-01 -1.03367693e-01]
 [-1.77261608e-01  3.13668985e-02  4.51144759e-02]
 [ 9.26816810e-02  8.91389440e-03 -3.11510396e-02]
 [ 2.27772746e-02 -4.64213449e-02  2.56762111e-01]
 [-2.01157737e-01 -1.35132833e-01 -7.40048427e-02]
 [-1.78044852e-01  1.37230605e-01  2.36917149e-01]
 [ 9.57109858e-02  3.35356279e-02  1.21957604e-01]
 [-1.56414659e-01  1.22369442e-01 -2.51374699e-02]
 [ 7.85601903e-02 -1.25984997e-02 -4.85756295e-02]
 [-1.03527937e-02 -1.86909369e-03 -4.92830392e-02]
 [-3.07499428e-02  2.96379007e-02  8.52018153e-02]
 [ 1.15422891e-02 -4.56904003e-02 -1.12458302e-02]
 [-9.02417039e-02  5.37727025e-03  5.62318063e-02]
 [-1.12312789e-01 -6.40497724e-02 -7.51487553e-02]
 [ 2.30573382e+00  1.47270333e+00  1.66636515e-01]
 [ 4.73820725e-02 -1.29650255e-01  7.22690007e-03]
 [ 3.11637840e-02 -1.45542298e-02 -3.76023753e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.28793536]
curr_Stock_Price:  100.25657017380365
curr_Factors:  [100.25657017  -0.98939945  -1.00162283]
mat_Sqrt:  [[13.69061177  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00157077 -0.02401231  0.13633478]
Stock Position:  0.0015707738858756518
Bond Position:  [4.13045495]


portfolio before change:  [4.28864722]
curr_Stock_Price:  100.38104502172577
curr_Factors:  [100.38104502  -0.97037855  -1.0094825 ]
mat_Sqrt:  [[13.86146021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08965672 0.07534559 0.91821462]
Stock Position:  0.08965672120918682
Bond Position:  [-4.71118815]


portfolio before change:  [4.26205249]
curr_Stock_Price:  100.09098543982219
curr_Factors:  [100.09098544  -0.88234531  -0.99600214]
mat_Sqrt:  [[15.29815413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01748311 -0.04528377  0.10550174]
Stock Position:  -0.01748310729100429
Bond Position:  [6.01195393]


portfolio before change:  [4.27972869]
curr_Stock_Price:  99.12292746742663
curr_Factors:  [99.12292747 -0.71391571 -0.97026455]
mat_Sqrt:  [[18.39686948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04134888 0.43325214 3.78858071]
Stock Position:  0.041348880811679034
Bond Position:  [0.18110658]


portfolio before change:  [4.29561707]
curr_Stock_Price:  99.50663159296293
curr_Factors:  [99.50663159 -0.60038814 -0.93208076]
mat_Sqrt:  [[21.49360387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272853 -0.01106097 -0.05874131]
Stock Position:  -0.0027285326964285347
Bond Position:  [4.56712417]


portfolio before change:  [4.29781992]
curr_Stock_Price:  98.90853695437983
curr_Factors:  [98.90853695 -0.43224969 -0.94753654]
mat_Sqrt:  [[24.88858627  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.51493394e-04  1.02569525e-01 -4.26448758e-01]
Stock Position:  0.00015149339377840105
Bond Position:  [4.28283593]


portfolio before change:  [4.29859678]
curr_Stock_Price:  100.50250674524389
curr_Factors:  [100.50250675  -0.30450692  -0.94756175]
mat_Sqrt:  [[28.73494569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230696 -0.00251018 -0.21167328]
Stock Position:  -0.0023069583512820113
Bond Position:  [4.53045188]


portfolio before change:  [4.29452723]
curr_Stock_Price:  102.51203035357555
curr_Factors:  [102.51203035  -0.23605408  -0.92849358]
mat_Sqrt:  [[31.99029248  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00327757  0.03779945 -0.20482904]
Stock Position:  0.00327756608559425
Bond Position:  [3.95853728]


portfolio before change:  [4.29102751]
curr_Stock_Price:  101.29326962305205
curr_Factors:  [101.29326962  -0.49119238  -0.91921841]
mat_Sqrt:  [[24.71991467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152469  0.0125661  -0.12155369]
Stock Position:  0.001524686591570919
Bond Position:  [4.13658702]


portfolio before change:  [4.29231273]
curr_Stock_Price:  101.79704968410907
curr_Factors:  [101.79704968  -0.40532378  -0.94169418]
mat_Sqrt:  [[26.46870668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00656063 -0.02552179 -0.13811632]
Stock Position:  -0.006560625921060077
Bond Position:  [4.96016509]


portfolio before change:  [4.29496625]
curr_Stock_Price:  101.48710009763923
curr_Factors:  [101.4871001   -0.44511608  -0.9579084 ]
mat_Sqrt:  [[24.95083311  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04454147  0.52387529 -0.82680025]
Stock Position:  0.0445414700863075
Bond Position:  [-0.22541838]


portfolio before change:  [4.34454368]
curr_Stock_Price:  102.60079501098303
curr_Factors:  [102.60079501  -0.53296437  -0.96797246]
mat_Sqrt:  [[22.87189463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048946  0.00092681 -0.16410825]
Stock Position:  -0.0004894637194921313
Bond Position:  [4.39476305]


portfolio before change:  [4.34563388]
curr_Stock_Price:  101.49587722768378
curr_Factors:  [101.49587723  -0.44768738  -0.9738636 ]
mat_Sqrt:  [[24.4949557   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0107081   0.00165896 -1.05367125]
Stock Position:  -0.010708103021607802
Bond Position:  [5.43246218]


portfolio before change:  [4.33641991]
curr_Stock_Price:  102.41976285139876
curr_Factors:  [102.41976285  -0.38659798  -0.97140574]
mat_Sqrt:  [[26.33966463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05374218 -0.93326301  6.89990781]
Stock Position:  0.05374217668919901
Bond Position:  [-1.16784108]


portfolio before change:  [4.32991018]
curr_Stock_Price:  102.30135029271364
curr_Factors:  [102.30135029  -0.25709788  -0.94149399]
mat_Sqrt:  [[30.85599336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070227 -0.03053791  0.10625201]
Stock Position:  -0.0007022743564276311
Bond Position:  [4.40175379]


portfolio before change:  [4.33183559]
curr_Stock_Price:  100.34319730406199
curr_Factors:  [100.3431973   -0.26387837  -0.92164506]
mat_Sqrt:  [[30.66349489  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00415365 -0.00507992 -0.07433975]
Stock Position:  0.004153645028288947
Bond Position:  [3.91504557]


portfolio before change:  [4.34063286]
curr_Stock_Price:  102.34333412105069
curr_Factors:  [ 1.02343334e+02 -9.54391890e-02 -9.13511685e-01]
mat_Sqrt:  [[37.31451183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00510392 -0.06136765 -0.10297157]
Stock Position:  -0.005103915311387699
Bond Position:  [4.86298457]


portfolio before change:  [4.3511315]
curr_Stock_Price:  100.40546352471617
curr_Factors:  [ 1.00405464e+02  4.93281483e-02 -9.30780963e-01]
mat_Sqrt:  [[41.58600981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0165763  -0.5844571  -0.57550702]
Stock Position:  -0.01657629951257656
Bond Position:  [6.01548253]


portfolio before change:  [4.36415624]
curr_Stock_Price:  99.66508362573397
curr_Factors:  [99.66508363 -0.14688006 -0.94049687]
mat_Sqrt:  [[33.59705707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00047898 0.00803386 0.01044499]
Stock Position:  0.0004789803466816056
Bond Position:  [4.31641862]


portfolio before change:  [4.36453867]
curr_Stock_Price:  99.33697595471621
curr_Factors:  [99.33697595 -0.31513625 -0.93854874]
mat_Sqrt:  [[28.3558363   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00498799 0.01641436 0.61213663]
Stock Position:  0.004987993673110852
Bond Position:  [3.86904646]


portfolio before change:  [4.3545281]
curr_Stock_Price:  97.23307747041974
curr_Factors:  [97.23307747 -0.16531578 -0.90452971]
mat_Sqrt:  [[33.35692731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00084478 0.00531948 0.00215993]
Stock Position:  0.0008447816408304976
Bond Position:  [4.27238738]


portfolio before change:  [4.35258171]
curr_Stock_Price:  94.29685478173143
curr_Factors:  [94.29685478 -0.33508784 -0.89271517]
mat_Sqrt:  [[27.62289151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.001261   -0.01285549  0.02854444]
Stock Position:  0.001261003361246005
Bond Position:  [4.23367306]


portfolio before change:  [4.35438433]
curr_Stock_Price:  95.30667015485281
curr_Factors:  [95.30667015 -0.56631045 -0.90486172]
mat_Sqrt:  [[21.88776132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280779 -0.03375427 -0.29487926]
Stock Position:  -0.0028077865654926267
Bond Position:  [4.62198512]


portfolio before change:  [4.35447308]
curr_Stock_Price:  95.48084291668073
curr_Factors:  [95.48084292 -0.58387919 -0.90907854]
mat_Sqrt:  [[21.45521857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00753429  0.01012362  0.12869904]
Stock Position:  -0.007534293447811433
Bond Position:  [5.07385377]


portfolio before change:  [4.34828701]
curr_Stock_Price:  96.3860826112727
curr_Factors:  [96.38608261 -0.63317009 -0.92215921]
mat_Sqrt:  [[20.34901517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00433154  0.00287695 -0.08886525]
Stock Position:  0.0043315385033618
Bond Position:  [3.93078698]


portfolio before change:  [4.34626755]
curr_Stock_Price:  95.8064196877442
curr_Factors:  [95.80641969 -0.5974891  -0.94035864]
mat_Sqrt:  [[20.58333882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00319253 -0.01498242  0.73247083]
Stock Position:  0.003192528879429589
Bond Position:  [4.04040279]


portfolio before change:  [4.34617931]
curr_Stock_Price:  95.62057170048395
curr_Factors:  [95.6205717  -0.58410161 -0.95209186]
mat_Sqrt:  [[20.57742312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01185026 -0.04361393 -0.21111522]
Stock Position:  -0.011850258647955239
Bond Position:  [5.47930782]


portfolio before change:  [4.34802231]
curr_Stock_Price:  95.52284882344155
curr_Factors:  [95.52284882 -0.73531687 -0.92881139]
mat_Sqrt:  [[18.08779154  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00562104  0.04429099  0.67585868]
Stock Position:  -0.00562104342290581
Bond Position:  [4.88496039]


portfolio before change:  [4.34447703]
curr_Stock_Price:  96.26220240919704
curr_Factors:  [96.26220241 -1.03425178 -0.91706281]
mat_Sqrt:  [[13.67762324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00931821 0.01082358 0.3479111 ]
Stock Position:  0.0093182058452894
Bond Position:  [3.44748601]


portfolio before change:  [4.33974023]
curr_Stock_Price:  95.70761465972892
curr_Factors:  [95.70761466 -1.0379369  -0.89101577]
mat_Sqrt:  [[13.9063448   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0098205   0.03949457 -0.0717102 ]
Stock Position:  -0.009820500452608648
Bond Position:  [5.2796369]


portfolio before change:  [4.34231953]
curr_Stock_Price:  95.51217604120926
curr_Factors:  [95.51217604 -1.05125997 -0.89349709]
mat_Sqrt:  [[13.66033919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00483685 -0.00406615 -0.13857275]
Stock Position:  0.004836854532188822
Bond Position:  [3.88034103]


portfolio before change:  [4.34476077]
curr_Stock_Price:  95.91660656345013
curr_Factors:  [95.91660656 -1.04938661 -0.8947471 ]
mat_Sqrt:  [[13.72673547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151487 -0.00060325 -0.14059079]
Stock Position:  -0.0015148670400242452
Bond Position:  [4.49006168]


portfolio before change:  [4.34585973]
curr_Stock_Price:  95.56168113696502
curr_Factors:  [95.56168114 -1.06328    -0.89738047]
mat_Sqrt:  [[13.4517801   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0005433   0.00956559  0.24305706]
Stock Position:  -0.0005433023642532911
Bond Position:  [4.39777862]


portfolio before change:  [4.34614978]
curr_Stock_Price:  96.03970289138033
curr_Factors:  [96.03970289 -1.22791928 -0.88854435]
mat_Sqrt:  [[11.56864065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.89538633e-06 -1.47465133e-02 -3.20812234e-02]
Stock Position:  -6.8953863272799505e-06
Bond Position:  [4.34681201]


portfolio before change:  [4.3466837]
curr_Stock_Price:  97.412317972467
curr_Factors:  [97.41231797 -1.10541092 -0.88818159]
mat_Sqrt:  [[13.26806693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00585359  0.00173551  0.16041369]
Stock Position:  -0.005853588485900714
Bond Position:  [4.91689532]


portfolio before change:  [4.34838387]
curr_Stock_Price:  97.2268719162199
curr_Factors:  [97.22687192 -1.32617767 -0.86523771]
mat_Sqrt:  [[10.86592511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01295118 -0.02067198 -0.21437848]
Stock Position:  -0.012951181599086781
Bond Position:  [5.60758675]


portfolio before change:  [4.36780663]
curr_Stock_Price:  95.7813078508547
curr_Factors:  [95.78130785 -1.22314673 -0.85123577]
mat_Sqrt:  [[12.03338719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.21941974 0.47531296 0.4753676 ]
Stock Position:  0.21941973812451196
Bond Position:  [-16.64850286]


portfolio before change:  [4.63686684]
curr_Stock_Price:  97.01702804837217
curr_Factors:  [97.01702805 -1.30757655 -0.83998774]
mat_Sqrt:  [[11.32850621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197665 -0.04184444  0.02061633]
Stock Position:  0.001976651597394787
Bond Position:  [4.44509797]


portfolio before change:  [4.63669631]
curr_Stock_Price:  96.64963983958226
curr_Factors:  [96.64963984 -1.0036402  -0.85478195]
mat_Sqrt:  [[15.06946223  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00136152 -0.00469736 -0.10726911]
Stock Position:  0.00136151916253119
Bond Position:  [4.50510598]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.63774325]
Stock Price:  97.0049486561802
PL:  [4.63774325]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-2.90993649e-02 -6.51486254e-02  2.19188840e-01]
 [ 1.13305353e+00  2.43084566e-01  3.18840319e-01]
 [-2.45711353e-01 -1.39701832e-01  3.69636727e-02]
 [ 1.22020408e-01  8.43199613e-01  7.62471410e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.17598640e-02  1.16903042e-04  1.13097241e-02]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [ 4.58822461e-02  1.71196819e-01 -4.53528729e-02]
 [ 2.49723206e-02  5.35091672e-02 -4.48239704e-02]
 [-1.82449842e-02  1.26428818e-03  4.10137542e-02]
 [ 8.18491140e-01  1.68386279e+00 -2.57446457e-01]
 [-1.40373373e-03 -7.79748052e-02  1.97205695e-01]
 [-5.75934897e-01 -6.86596480e-02 -1.27246701e+00]
 [ 1.82287247e+00 -2.64903141e+00  2.24789999e+00]
 [ 1.78387090e-03 -1.02853562e-02 -3.69070152e-02]
 [ 4.58626956e-03  6.05869420e-01 -3.25953792e-01]
 [ 6.53869283e-03 -1.41613046e-01 -2.60402142e-01]
 [-3.19083521e-01 -2.01102852e+00 -1.90595270e-01]
 [ 6.71820964e-02 -2.15251957e-01  7.85922834e-02]
 [-5.56875385e-01  4.14826855e-01  2.42264768e-01]
 [ 1.50898823e-03  2.87732117e-01 -1.96389450e-01]
 [ 2.26296576e-03 -3.24573075e-02 -1.11102606e-03]
 [ 7.42335235e-02 -1.43999061e-01 -1.47156951e-01]
 [-2.67200784e-01  9.68442785e-02  1.86196888e-02]
 [ 1.41003138e-01 -2.84157171e-02 -4.98279504e-02]
 [-4.62910144e-02 -5.85475242e-02  1.65852394e-01]
 [-1.52055291e-01 -8.70381171e-02 -2.38685783e-02]
 [-2.74412745e-01  1.98723465e-01  3.67426060e-01]
 [ 2.43976536e-01  2.25725987e-01  3.63542518e-01]
 [-1.32660760e-01  7.85076595e-02 -2.43953336e-01]
 [ 2.30117699e-01  5.70434476e-02  1.70893099e-01]
 [ 1.55880028e-01 -3.20149276e-03 -9.22185668e-02]
 [ 3.16800516e-01  2.27097526e-01  2.45031892e-01]
 [ 9.83956336e-03 -9.75836782e-03  6.33035551e-02]
 [-9.86752524e-02  1.74393578e-01  2.34244088e-02]
 [-6.56398571e-02 -3.77444708e-02 -3.05228438e-02]
 [ 1.97277152e+00  1.31580357e+00  1.63702958e-01]
 [ 3.61531813e-01 -5.78083243e-01  1.23971325e-01]
 [ 2.42800456e-02 -1.59640127e-02  2.93533695e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.85717725]
curr_Stock_Price:  100.06132663381926
curr_Factors:  [100.06132663  -0.8616906   -0.99001712]
mat_Sqrt:  [[15.70651423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.49235041e-04 -2.10266284e-02  6.25284751e-01]
Stock Position:  0.0001492350411659359
Bond Position:  [2.84224459]


portfolio before change:  [2.85764711]
curr_Stock_Price:  100.82898427244338
curr_Factors:  [100.82898427  -0.58960642  -0.99844643]
mat_Sqrt:  [[20.60168785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06056572 0.07845521 0.90956268]
Stock Position:  0.06056571549081069
Bond Position:  [-3.24913246]


portfolio before change:  [2.81805644]
curr_Stock_Price:  100.18200932810254
curr_Factors:  [100.18200933  -0.68303702  -1.00196482]
mat_Sqrt:  [[18.57816175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01435463 -0.04508857  0.10544707]
Stock Position:  -0.01435463292124976
Bond Position:  [4.25613241]


portfolio before change:  [2.80662422]
curr_Stock_Price:  101.01548735110079
curr_Factors:  [101.01548735  -0.7487316   -1.00594724]
mat_Sqrt:  [[17.47191978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02574283 0.2721415  2.1751187 ]
Stock Position:  0.025742828413424804
Bond Position:  [0.20619986]


portfolio before change:  [2.80520578]
curr_Stock_Price:  100.95938556362432
curr_Factors:  [100.95938556  -0.70967189  -0.99088032]
mat_Sqrt:  [[18.43343444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031815  -0.01106097 -0.05874131]
Stock Position:  -0.0031815015875338902
Bond Position:  [3.12640823]


portfolio before change:  [2.80323658]
curr_Stock_Price:  101.70118098426893
curr_Factors:  [101.70118098  -0.70178141  -0.97349353]
mat_Sqrt:  [[19.04422633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.36544595e-03 3.77302946e-05 3.22634949e-02]
Stock Position:  0.003365445954648778
Bond Position:  [2.46096675]


portfolio before change:  [2.79949383]
curr_Stock_Price:  100.4976574994474
curr_Factors:  [100.4976575   -0.80287604  -0.97532767]
mat_Sqrt:  [[16.97820922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00390444 -0.00251018 -0.21167328]
Stock Position:  -0.0039044355072580753
Bond Position:  [3.19188045]


portfolio before change:  [2.7966201]
curr_Stock_Price:  101.33586930066498
curr_Factors:  [101.3358693   -0.70627348  -1.01884942]
mat_Sqrt:  [[18.05310221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00396442  0.05525354 -0.12937912]
Stock Position:  0.003964417484779584
Bond Position:  [2.3948824]


portfolio before change:  [2.79216462]
curr_Stock_Price:  100.13648709909329
curr_Factors:  [100.1364871   -0.70296642  -0.98357995]
mat_Sqrt:  [[18.54106039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144248  0.01727001 -0.12787031]
Stock Position:  0.0014424837875982978
Bond Position:  [2.64771936]


portfolio before change:  [2.78969774]
curr_Stock_Price:  98.19686930799969
curr_Factors:  [98.19686931 -0.58929779 -0.97273867]
mat_Sqrt:  [[20.59272535  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046691  0.00040805  0.11700082]
Stock Position:  -0.000466913180540574
Bond Position:  [2.83554715]


portfolio before change:  [2.79040434]
curr_Stock_Price:  97.44270229440212
curr_Factors:  [97.44270229 -0.58663573 -0.96470504]
mat_Sqrt:  [[20.65430483  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05372522  0.54346438 -0.73442308]
Stock Position:  0.05372522404558401
Bond Position:  [-2.44472667]


portfolio before change:  [2.84252122]
curr_Stock_Price:  98.41845426598599
curr_Factors:  [98.41845427 -0.3085123  -0.96757262]
mat_Sqrt:  [[27.47134378  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00083484 -0.02516626  0.56257296]
Stock Position:  0.0008348397513728593
Bond Position:  [2.76035758]


portfolio before change:  [2.83935627]
curr_Stock_Price:  94.2140340637272
curr_Factors:  [ 9.42140341e+01 -4.34660294e-02 -9.60135040e-01]
mat_Sqrt:  [[34.53481972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0246039  -0.02215981 -3.62999419]
Stock Position:  -0.024603899368609822
Bond Position:  [5.15738888]


portfolio before change:  [2.84290947]
curr_Stock_Price:  94.09582161112914
curr_Factors:  [94.09582161  0.29078616 -0.9461961 ]
mat_Sqrt:  [[48.8572951   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03563423 -0.85497121  6.41263298]
Stock Position:  0.035634225388023015
Bond Position:  [-0.51012224]


portfolio before change:  [2.80200829]
curr_Stock_Price:  92.94980493616409
curr_Factors:  [92.94980494  0.174239   -0.94378728]
mat_Sqrt:  [[43.05641945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0001823  -0.00331958 -0.10528544]
Stock Position:  -0.00018230107591296317
Bond Position:  [2.81895313]


portfolio before change:  [2.80272436]
curr_Stock_Price:  90.95484844086864
curr_Factors:  [ 9.09548484e+01 -2.06440162e-02 -9.35491211e-01]
mat_Sqrt:  [[34.96081928  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00176551  0.19554351 -0.92985544]
Stock Position:  0.0017655137696464492
Bond Position:  [2.64214232]


portfolio before change:  [2.80151663]
curr_Stock_Price:  90.083704473776
curr_Factors:  [ 9.00837045e+01  7.06172172e-02 -9.10771598e-01]
mat_Sqrt:  [[38.8840798   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194224 -0.04570541 -0.74285483]
Stock Position:  -0.0019422425398301754
Bond Position:  [2.97648103]


portfolio before change:  [2.7992579]
curr_Stock_Price:  91.43822908321981
curr_Factors:  [91.43822908 -0.19803038 -0.90673572]
mat_Sqrt:  [[30.29242097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02536899 -0.64905666 -0.54371525]
Stock Position:  -0.02536898904542949
Bond Position:  [5.11895333]


portfolio before change:  [2.84479567]
curr_Stock_Price:  89.66843594982629
curr_Factors:  [89.66843595 -0.20980604 -0.90431807]
mat_Sqrt:  [[29.42941604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133494 -0.06947227  0.22420191]
Stock Position:  0.0013349417914804934
Bond Position:  [2.72509353]


portfolio before change:  [2.8457519]
curr_Stock_Price:  90.12955664311458
curr_Factors:  [90.12955664 -0.4071273  -0.89551661]
mat_Sqrt:  [[24.49831254  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01725617  0.13388479  0.69111395]
Stock Position:  -0.017256172995323442
Bond Position:  [4.40104312]


portfolio before change:  [2.86059144]
curr_Stock_Price:  89.30148307492995
curr_Factors:  [89.30148307 -0.36633866 -0.918973  ]
mat_Sqrt:  [[24.69760881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00081604  0.09286514 -0.56024444]
Stock Position:  0.0008160398104009955
Bond Position:  [2.78771788]


portfolio before change:  [2.86097994]
curr_Stock_Price:  89.35051211754792
curr_Factors:  [89.35051212 -0.38185342 -0.89241156]
mat_Sqrt:  [[24.98565843  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018367 -0.01047555 -0.00316945]
Stock Position:  -0.0001836710306724662
Bond Position:  [2.87739104]


portfolio before change:  [2.86116427]
curr_Stock_Price:  90.30527644640593
curr_Factors:  [90.30527645 -0.29066326 -0.90672098]
mat_Sqrt:  [[27.27066682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00054276 -0.0464755  -0.41979782]
Stock Position:  0.0005427645601754335
Bond Position:  [2.81214977]


portfolio before change:  [2.862108]
curr_Stock_Price:  91.39632994359738
curr_Factors:  [91.39632994 -0.3386394  -0.92169263]
mat_Sqrt:  [[25.91633053  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00940071  0.03125636  0.05311679]
Stock Position:  -0.00940070587684014
Bond Position:  [3.72129802]


portfolio before change:  [2.86000682]
curr_Stock_Price:  91.66932746940392
curr_Factors:  [91.66932747 -0.50119902 -0.92025462]
mat_Sqrt:  [[22.1255753   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.005651   -0.00917113 -0.14214527]
Stock Position:  0.005651004074221618
Bond Position:  [2.34198308]


portfolio before change:  [2.85470822]
curr_Stock_Price:  90.67988049766042
curr_Factors:  [90.6798805  -0.62643121 -0.92042936]
mat_Sqrt:  [[19.30713928  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126313 -0.01889613  0.47313072]
Stock Position:  -0.0012631337677454974
Bond Position:  [2.96924904]


portfolio before change:  [2.85410027]
curr_Stock_Price:  91.45503903370239
curr_Factors:  [91.45503903 -0.72573848 -0.90730062]
mat_Sqrt:  [[17.86437279  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00977891 -0.02809143 -0.06809041]
Stock Position:  -0.00977890619374946
Bond Position:  [3.74843052]


portfolio before change:  [2.86485263]
curr_Stock_Price:  90.4034101329732
curr_Factors:  [90.40341013 -0.51176366 -0.90678464]
mat_Sqrt:  [[21.88351671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00725879  0.06413772  1.04816428]
Stock Position:  -0.007258794798691245
Bond Position:  [3.52107244]


portfolio before change:  [2.86656558]
curr_Stock_Price:  90.22806577067851
curr_Factors:  [90.22806577 -0.38340549 -0.88831934]
mat_Sqrt:  [[25.29522663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01440036 0.07285275 1.03708561]
Stock Position:  0.014400363797534817
Bond Position:  [1.56724861]


portfolio before change:  [2.86035013]
curr_Stock_Price:  89.7828432117648
curr_Factors:  [89.78284321 -0.38305917 -0.86926562]
mat_Sqrt:  [[25.66348355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00648518  0.02533824 -0.69593097]
Stock Position:  -0.006485176392110697
Bond Position:  [3.44260771]


portfolio before change:  [2.87579763]
curr_Stock_Price:  87.46723262377557
curr_Factors:  [87.46723262 -0.16862539 -0.88828247]
mat_Sqrt:  [[30.39737851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00910095 0.01841069 0.48751044]
Stock Position:  0.00910095099370541
Bond Position:  [2.07976263]


portfolio before change:  [2.88666693]
curr_Stock_Price:  88.63296970550756
curr_Factors:  [88.63296971 -0.18146957 -0.88782825]
mat_Sqrt:  [[30.42321869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0044835  -0.00103328 -0.2630739 ]
Stock Position:  0.004483499650040917
Bond Position:  [2.48928104]


portfolio before change:  [2.88092717]
curr_Stock_Price:  87.28336723433654
curr_Factors:  [87.28336723  0.18790898 -0.90061088]
mat_Sqrt:  [[42.79657271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00965436 0.07329541 0.69900778]
Stock Position:  0.00965436022981483
Bond Position:  [2.0382621]


portfolio before change:  [2.90980856]
curr_Stock_Price:  90.24851337865665
curr_Factors:  [90.24851338  0.14633394 -0.91046707]
mat_Sqrt:  [[42.03211618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00049413 -0.0031495   0.18058742]
Stock Position:  0.0004941323640533693
Bond Position:  [2.86521385]


portfolio before change:  [2.9099662]
curr_Stock_Price:  89.84268844966282
curr_Factors:  [89.84268845  0.15259097 -0.90066606]
mat_Sqrt:  [[42.52045062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137101  0.05628529  0.06682332]
Stock Position:  -0.0013710067510519204
Bond Position:  [3.03314113]


portfolio before change:  [2.91446623]
curr_Stock_Price:  86.83696517362281
curr_Factors:  [86.83696517  0.12913105 -0.86773597]
mat_Sqrt:  [[41.48896451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191798 -0.01218198 -0.08707318]
Stock Position:  -0.0019179766308026704
Bond Position:  [3.0810175]


portfolio before change:  [2.91446759]
curr_Stock_Price:  87.03706904195799
curr_Factors:  [87.03706904  0.17591771 -0.88179126]
mat_Sqrt:  [[42.96821087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05294087 0.42467378 0.46699897]
Stock Position:  0.052940871406156616
Bond Position:  [-1.69335069]


portfolio before change:  [2.84277645]
curr_Stock_Price:  85.68689374508736
curr_Factors:  [ 8.56868937e+01 -5.62630458e-02 -8.77011824e-01]
mat_Sqrt:  [[33.69754589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00797793 -0.18657556  0.35365568]
Stock Position:  0.007977928316588641
Bond Position:  [2.15917256]


portfolio before change:  [2.82956001]
curr_Stock_Price:  83.9964350689372
curr_Factors:  [83.99643507 -0.23023399 -0.86601126]
mat_Sqrt:  [[28.06516453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00096251 -0.00515236  0.08373699]
Stock Position:  0.000962514814919631
Bond Position:  [2.74871219]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.8293867]
Stock Price:  83.45938664498863
PL:  [2.8293867]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 4.44941414e-02 -3.96435130e-02  1.02782409e-01]
 [ 1.48783134e+00  3.23630775e-01  4.80783130e-01]
 [-2.06308470e-01 -1.03432291e-01  3.58143468e-02]
 [ 9.67916050e-02  7.37394156e-01  6.15611141e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.44613675e-02 -1.62611142e-02  2.33418906e-02]
 [-4.72086621e-02 -2.28045279e-02 -6.41571853e-02]
 [ 4.67975803e-02  1.71021417e-01 -4.69177296e-02]
 [ 3.61224172e-02  4.14429608e-02 -4.29908051e-02]
 [-9.92423223e-02 -4.90315430e-02 -1.49719054e-02]
 [ 8.74479308e-01  1.68523221e+00 -3.03352088e-01]
 [ 1.62889443e-04 -3.44188478e-02 -3.48839172e-02]
 [-1.03522539e-01  5.35596143e-03 -1.69232500e-01]
 [ 1.47048913e+00 -2.80599156e+00  2.34531566e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.46733718e-01 -8.76175137e-02  2.35280343e-02]
 [-1.71114875e-01 -2.47006967e-01 -2.47425332e-02]
 [-2.64679690e-01 -1.73675054e+00 -2.03433407e-01]
 [ 1.30094623e-03  3.72499194e-02  5.83893053e-02]
 [ 2.96782320e-01 -4.57320015e-01  2.40899037e-01]
 [ 7.20535769e-02  3.07753648e-02 -9.36706457e-02]
 [-1.21331788e-01 -5.18411989e-02 -1.36135643e-01]
 [ 2.92442693e-01  3.12456011e-01  2.76867090e-01]
 [ 3.44312099e-02  7.44155214e-02  1.76020215e-01]
 [-1.17024681e-01 -3.68693695e-01  1.30545933e-01]
 [ 1.75795245e-01 -6.41120987e-02 -2.03264325e-01]
 [ 6.44200356e-01 -2.54530258e-03  4.13714487e-01]
 [-5.99235725e-02  5.98917453e-02  1.06842320e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 2.42773339e-01 -9.20226494e-02  1.58851101e-02]
 [-2.21467857e-02 -7.41006526e-02 -2.77640097e-02]
 [-3.20713556e-03 -1.60964417e-02 -1.15180464e-03]
 [-3.81359577e-02  4.77451197e-02 -1.18491332e-01]
 [ 5.30328802e-01  9.32658078e-02  1.50814208e-01]
 [ 4.97089708e-02  1.32710920e-01 -7.86058586e-02]
 [ 1.86122526e-02  3.15708149e-02  6.95274674e-02]
 [ 2.37281025e+00  1.72101629e+00  2.09479791e-01]
 [-1.07800886e-01  3.56810029e-03 -1.87936866e-03]
 [ 3.86134603e-02 -1.21817701e-02 -1.93704381e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.83117997]
curr_Stock_Price:  100.60362540109635
curr_Factors:  [100.6036254   -0.94851968  -1.00695244]
mat_Sqrt:  [[14.23517728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00403102 -0.01279489  0.2932096 ]
Stock Position:  0.004031022130445551
Bond Position:  [6.42564453]


portfolio before change:  [6.83491635]
curr_Stock_Price:  101.33126534423421
curr_Factors:  [101.33126534  -0.88828711  -0.98930051]
mat_Sqrt:  [[15.49949411  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10658616 0.10445138 1.37154045]
Stock Position:  0.10658616496502762
Bond Position:  [-3.96559461]


portfolio before change:  [6.74783816]
curr_Stock_Price:  100.5189416634724
curr_Factors:  [100.51894166  -0.70379147  -0.97027893]
mat_Sqrt:  [[18.84553063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01167974 -0.03338263  0.10216836]
Stock Position:  -0.011679741427600096
Bond Position:  [7.9218734]


portfolio before change:  [6.73668164]
curr_Stock_Price:  101.55893150502041
curr_Factors:  [101.55893151  -0.8019703   -0.99476993]
mat_Sqrt:  [[16.84239152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02214488 0.23799294 1.75616723]
Stock Position:  0.022144875002942047
Bond Position:  [4.4876718]


portfolio before change:  [6.72175761]
curr_Stock_Price:  100.85967167072812
curr_Factors:  [100.85967167  -0.61130876  -0.963841  ]
mat_Sqrt:  [[20.87558724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280931 -0.01106097 -0.05874131]
Stock Position:  -0.0028093102370629662
Bond Position:  [7.00510372]


portfolio before change:  [6.72025366]
curr_Stock_Price:  101.7067273137704
curr_Factors:  [101.70672731  -0.78239462  -0.96447439]
mat_Sqrt:  [[17.72940281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00371737 -0.00524825  0.06658792]
Stock Position:  0.0037173685784406873
Bond Position:  [6.34217227]


portfolio before change:  [6.71901403]
curr_Stock_Price:  101.15998262955263
curr_Factors:  [101.15998263  -0.80275636  -0.95209486]
mat_Sqrt:  [[17.4938962   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371328 -0.00736013 -0.18302259]
Stock Position:  -0.0037132750061522816
Bond Position:  [7.09464887]


portfolio before change:  [6.71930962]
curr_Stock_Price:  101.31922182010793
curr_Factors:  [101.31922182  -0.76364844  -0.95838453]
mat_Sqrt:  [[18.10599647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00398377  0.05519693 -0.13384322]
Stock Position:  0.003983770768920188
Bond Position:  [6.31567707]


portfolio before change:  [6.71549754]
curr_Stock_Price:  100.16413863606087
curr_Factors:  [100.16413864  -0.48008115  -0.95156969]
mat_Sqrt:  [[23.93063381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149626  0.01337566 -0.1226408 ]
Stock Position:  0.001496260610959702
Bond Position:  [6.56562589]


portfolio before change:  [6.7166231]
curr_Stock_Price:  100.36785018701161
curr_Factors:  [100.36785019  -0.62107891  -0.94445934]
mat_Sqrt:  [[20.97442197  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00535447 -0.01582486 -0.04271068]
Stock Position:  -0.005354472783115252
Bond Position:  [7.25404003]


portfolio before change:  [6.71413309]
curr_Stock_Price:  101.00224091757055
curr_Factors:  [101.00224092  -0.52583904  -0.94502792]
mat_Sqrt:  [[23.20286443  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04984533  0.54390636 -0.86537907]
Stock Position:  0.04984532879929086
Bond Position:  [1.67964318]


portfolio before change:  [6.7433294]
curr_Stock_Price:  101.58376673434151
curr_Factors:  [101.58376673  -0.28950252  -0.93474533]
mat_Sqrt:  [[29.86346704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046825 -0.01110864 -0.09951411]
Stock Position:  -0.0004682469794895319
Bond Position:  [6.79089569]


portfolio before change:  [6.74355859]
curr_Stock_Price:  102.90726299199576
curr_Factors:  [102.90726299  -0.29428626  -0.94846983]
mat_Sqrt:  [[29.69777525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00461225  0.00172863 -0.48277322]
Stock Position:  -0.004612254481934194
Bond Position:  [7.21819308]


portfolio before change:  [6.74142169]
curr_Stock_Price:  103.56621059494239
curr_Factors:  [103.56621059  -0.40346248  -0.97032426]
mat_Sqrt:  [[26.21742816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05250149 -0.90562988  6.69053277]
Stock Position:  0.05250149051334594
Bond Position:  [1.30404127]


portfolio before change:  [6.78076405]
curr_Stock_Price:  104.31246254092123
curr_Factors:  [104.31246254  -0.3649319   -0.9723798 ]
mat_Sqrt:  [[27.387293    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079122 -0.03053791  0.10625201]
Stock Position:  -0.0007912199602699656
Bond Position:  [6.86329815]


portfolio before change:  [6.78193149]
curr_Stock_Price:  103.92131857198045
curr_Factors:  [103.92131857  -0.57575441  -0.97261529]
mat_Sqrt:  [[22.09307835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00604947 -0.02827843  0.06711893]
Stock Position:  0.006049474230132645
Bond Position:  [6.15326215]


portfolio before change:  [6.77843585]
curr_Stock_Price:  103.21632420303375
curr_Factors:  [103.2163242   -0.662854    -1.01282344]
mat_Sqrt:  [[19.32016908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01172793 -0.07972116 -0.07058356]
Stock Position:  -0.011727925822638307
Bond Position:  [7.98894925]


portfolio before change:  [6.78182975]
curr_Stock_Price:  103.01209210107467
curr_Factors:  [103.0120921   -0.58882836  -1.03667294]
mat_Sqrt:  [[20.27411773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03258924 -0.56053383 -0.58033889]
Stock Position:  -0.03258923956062057
Bond Position:  [10.1389155]


portfolio before change:  [6.77008461]
curr_Stock_Price:  103.41138303536295
curr_Factors:  [103.41138304  -0.60742306  -0.99391111]
mat_Sqrt:  [[20.85056149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00099869 0.01202236 0.16656844]
Stock Position:  0.0009986887514249003
Bond Position:  [6.66680882]


portfolio before change:  [6.77191245]
curr_Stock_Price:  104.40712241895154
curr_Factors:  [104.40712242  -0.73301602  -0.99714774]
mat_Sqrt:  [[18.50672433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01364939 -0.1475994   0.6872179 ]
Stock Position:  0.013649394026010064
Bond Position:  [5.34681849]


portfolio before change:  [6.77314708]
curr_Stock_Price:  104.44860734474902
curr_Factors:  [104.44860734  -1.02463355  -1.0057564 ]
mat_Sqrt:  [[13.71246409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00431834  0.00993271 -0.26721628]
Stock Position:  0.004318343590707633
Bond Position:  [6.32210211]


portfolio before change:  [6.77724213]
curr_Stock_Price:  105.21388577745365
curr_Factors:  [105.21388578  -1.24810565  -0.9819761 ]
mat_Sqrt:  [[11.31255917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01411727 -0.01673167 -0.3883571 ]
Stock Position:  -0.014117265440203105
Bond Position:  [8.26257448]


portfolio before change:  [6.78003011]
curr_Stock_Price:  105.08956331463573
curr_Factors:  [105.08956331  -1.04624149  -1.00101355]
mat_Sqrt:  [[13.56588155  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03042469 0.10084474 0.78982474]
Stock Position:  0.030424691935733394
Bond Position:  [3.58271252]


portfolio before change:  [6.8195401]
curr_Stock_Price:  106.37345859059052
curr_Factors:  [106.37345859  -1.05591179  -0.99426383]
mat_Sqrt:  [[13.69157228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00624846 0.02401751 0.50213668]
Stock Position:  0.006248456267743414
Bond Position:  [6.15487019]


portfolio before change:  [6.82998885]
curr_Stock_Price:  107.92253673656289
curr_Factors:  [107.92253674  -1.05356408  -1.01684979]
mat_Sqrt:  [[13.61265468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01216782 -0.11899538  0.37241121]
Stock Position:  -0.012167824245439352
Bond Position:  [8.14317131]


portfolio before change:  [6.83404722]
curr_Stock_Price:  107.67266344895027
curr_Factors:  [107.67266345  -1.24815324  -0.99672737]
mat_Sqrt:  [[11.40686226  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0106267  -0.02069209 -0.57985654]
Stock Position:  0.010626696298649124
Bond Position:  [5.68984253]


portfolio before change:  [6.82975138]
curr_Stock_Price:  107.2014807474967
curr_Factors:  [107.20148075  -0.98710919  -0.95624543]
mat_Sqrt:  [[15.35368394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.74237921e-02 -8.21492874e-04  1.18021228e+00]
Stock Position:  0.0474237920607735
Bond Position:  [1.74585065]


portfolio before change:  [6.73205668]
curr_Stock_Price:  105.13684307983127
curr_Factors:  [105.13684308  -1.07888826  -0.95509089]
mat_Sqrt:  [[13.75336629  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188238  0.01932998  0.3047914 ]
Stock Position:  -0.0018823845340920971
Bond Position:  [6.92996465]


portfolio before change:  [6.73299249]
curr_Stock_Price:  105.09991497651505
curr_Factors:  [105.09991498  -1.12866121  -0.92394181]
mat_Sqrt:  [[13.49485426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0025476  -0.02600141 -0.03673698]
Stock Position:  -0.0025475977040630804
Bond Position:  [7.0007448]


portfolio before change:  [6.73572898]
curr_Stock_Price:  104.3692907104711
curr_Factors:  [104.36929071  -1.09125204  -0.92494415]
mat_Sqrt:  [[13.89792139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01635006 -0.02970018  0.0453158 ]
Stock Position:  0.016350058612514515
Bond Position:  [5.02928496]


portfolio before change:  [6.74517431]
curr_Stock_Price:  104.90853258201764
curr_Factors:  [104.90853258  -1.12301827  -0.93641415]
mat_Sqrt:  [[13.37860023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320959 -0.02391588 -0.07920299]
Stock Position:  -0.003209590094830043
Bond Position:  [7.0818877]


portfolio before change:  [6.74155715]
curr_Stock_Price:  106.31134480903359
curr_Factors:  [106.31134481  -1.15018737  -0.96394017]
mat_Sqrt:  [[12.83588111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052415 -0.0051951  -0.00328578]
Stock Position:  -0.0005241493775514578
Bond Position:  [6.79728018]


portfolio before change:  [6.74210857]
curr_Stock_Price:  106.88045106417124
curr_Factors:  [106.88045106  -1.01789685  -0.98136458]
mat_Sqrt:  [[14.47538328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00363216  0.01540967 -0.33802279]
Stock Position:  -0.003632164126248308
Bond Position:  [7.13031591]


portfolio before change:  [6.74417936]
curr_Stock_Price:  106.55572764680254
curr_Factors:  [106.55572765  -0.78080495  -0.9912469 ]
mat_Sqrt:  [[18.11275276  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03203    0.03010141 0.43023096]
Stock Position:  0.03202999753809504
Bond Position:  [3.33119967]


portfolio before change:  [6.6975875]
curr_Stock_Price:  105.0880945331578
curr_Factors:  [105.08809453  -0.80813196  -0.99259241]
mat_Sqrt:  [[17.35836673  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349993  0.04283227 -0.22424063]
Stock Position:  0.0034999329831724574
Bond Position:  [6.32978622]


portfolio before change:  [6.70200475]
curr_Stock_Price:  106.12410537920252
curr_Factors:  [106.12410538  -1.01670555  -0.99521931]
mat_Sqrt:  [[14.19208405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00276555 0.01018944 0.19834251]
Stock Position:  0.002765545423911314
Bond Position:  [6.40851371]


portfolio before change:  [6.70667536]
curr_Stock_Price:  107.52328858584052
curr_Factors:  [107.52328859  -0.94828293  -1.02885373]
mat_Sqrt:  [[14.88822757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.18584288 0.55545562 0.59758754]
Stock Position:  0.18584288126764548
Bond Position:  [-13.27576239]


portfolio before change:  [6.81826382]
curr_Stock_Price:  108.13266372825387
curr_Factors:  [108.13266373  -1.02290362  -1.01803081]
mat_Sqrt:  [[14.04721849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00764964  0.0011516  -0.00536132]
Stock Position:  -0.007649640767502137
Bond Position:  [7.64543986]


portfolio before change:  [6.82637285]
curr_Stock_Price:  107.19754962633056
curr_Factors:  [107.19754963  -0.78730171  -0.98299305]
mat_Sqrt:  [[18.25389777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.86966875e-04 -3.93164938e-03 -5.52584681e-01]
Stock Position:  -0.000186966875202907
Bond Position:  [6.84641524]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.82756375]
Stock Price:  105.40556270572357
PL:  [1.42200104]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.99561279e-02 -9.79769374e-02  3.24728761e-04]
 [ 1.11176078e+00  2.36541835e-01  3.25218762e-01]
 [-2.98033583e-01 -1.87863365e-01  3.84898376e-02]
 [ 2.09536237e-01  1.44043184e+00  1.31591010e+00]
 [-4.84026683e-02 -2.91995634e-02 -1.28208353e-02]
 [-4.56952276e-02  3.92053524e-01 -1.88076607e-01]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [-4.81355068e-02  9.12072920e-02  1.39617118e-02]
 [ 3.17523081e-02  4.61721251e-02 -4.37092861e-02]
 [-1.13032350e-01 -5.75945515e-02 -2.45036234e-02]
 [ 8.84035193e-01  1.69003100e+00 -3.10036985e-01]
 [-1.06136509e-04  1.11134849e-02 -3.20326950e-02]
 [-3.55348893e-01 -2.60236701e-03 -7.68023106e-01]
 [ 1.81326716e+00 -3.24483074e+00  2.73273203e+00]
 [ 2.92268590e-02 -9.36016858e-02  3.12237683e-02]
 [ 1.21715132e-01 -1.39113977e-02 -2.47573399e-02]
 [-8.23310991e-02 -5.25370486e-02 -5.42911364e-02]
 [-2.69061004e-01 -1.74762953e+00 -1.98350307e-01]
 [ 7.21831979e-04  3.56181914e-02  6.81517863e-02]
 [ 2.08277446e-01 -2.37708239e-01  2.47898458e-01]
 [ 4.85832532e-02  7.86897824e-06  5.55674233e-02]
 [ 1.60446483e-01 -5.57770886e-02 -2.13770159e-02]
 [ 1.74882509e-01  2.30845489e-01  1.91199614e-01]
 [-1.92840501e-01  6.40858145e-02  6.76077716e-02]
 [-4.10139653e-02 -2.00951839e-01  7.21052927e-02]
 [ 7.00903528e-02 -1.41845569e-02  3.86060909e-02]
 [ 6.15938801e-02 -1.05317939e-01  2.77788329e-02]
 [-8.20606881e-02  4.90381780e-02  1.32693373e-01]
 [-3.48279917e-03 -6.91009744e-02  6.96931380e-03]
 [ 2.20134122e-03  4.51989468e-02  8.81346022e-02]
 [-1.64687119e-02 -2.48924137e-02 -6.06892447e-02]
 [-2.57997789e-02  2.17820617e-02 -5.23724555e-02]
 [-7.85633981e-02 -4.96573398e-02  1.68393000e-02]
 [ 2.29070673e-01  9.55222317e-03  4.04877282e-02]
 [-1.45618844e-02  7.67905747e-02 -3.73008600e-02]
 [-1.05853129e-01 -3.95490590e-02 -1.07822474e-01]
 [ 2.51264253e+00  1.68300209e+00  1.90452488e-01]
 [-4.62373232e-02 -7.81945194e-03 -2.01267537e-02]
 [ 3.61255647e-02 -1.30781311e-02 -1.31804787e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.90775736]
curr_Stock_Price:  100.06822887670866
curr_Factors:  [100.06822888  -1.00797337  -0.98552112]
mat_Sqrt:  [[13.63115178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.68395659e-06 -3.16219206e-02  9.26360768e-04]
Stock Position:  1.6839565911247244e-06
Bond Position:  [2.90758885]


portfolio before change:  [2.9081209]
curr_Stock_Price:  100.112312076621
curr_Factors:  [100.11231208  -1.1391795   -0.9616566 ]
mat_Sqrt:  [[12.2491504   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10012365 0.07634355 0.92775861]
Stock Position:  0.10012365290618551
Bond Position:  [-7.11548948]


portfolio before change:  [2.84738754]
curr_Stock_Price:  99.51461246800906
curr_Factors:  [99.51461247 -1.18533385 -0.98084311]
mat_Sqrt:  [[11.4058631   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02880311 -0.06063264  0.10980079]
Stock Position:  -0.028803109742471498
Bond Position:  [5.71371785]


portfolio before change:  [2.85807241]
curr_Stock_Price:  99.16844833706133
curr_Factors:  [99.16844834 -0.93504857 -0.99747247]
mat_Sqrt:  [[14.35787923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05378038 0.46489738 3.75392525]
Stock Position:  0.05378037858888997
Bond Position:  [-2.47524429]


portfolio before change:  [2.8025891]
curr_Stock_Price:  98.1425374193406
curr_Factors:  [98.14253742 -0.86375265 -0.98506742]
mat_Sqrt:  [[15.44987348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00368806 -0.00942412 -0.03657427]
Stock Position:  -0.003688059084376544
Bond Position:  [3.16454458]


portfolio before change:  [2.80340943]
curr_Stock_Price:  98.02737405495705
curr_Factors:  [98.02737405 -0.60291911 -0.95231291]
mat_Sqrt:  [[20.69753789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.96091621e-04  1.26534731e-01 -5.36530210e-01]
Stock Position:  -0.000196091621467456
Bond Position:  [2.82263177]


portfolio before change:  [2.80354865]
curr_Stock_Price:  99.11678089019804
curr_Factors:  [99.11678089 -0.54260868 -0.94147004]
mat_Sqrt:  [[22.47087529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295006 -0.00251018 -0.21167328]
Stock Position:  -0.002950055219190786
Bond Position:  [3.09594863]


portfolio before change:  [2.80487604]
curr_Stock_Price:  98.79801872712763
curr_Factors:  [98.79801873 -0.40991234 -0.91178624]
mat_Sqrt:  [[26.34764671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101216  0.02943703  0.03982888]
Stock Position:  -0.0010121577121050742
Bond Position:  [2.90487521]


portfolio before change:  [2.80441592]
curr_Stock_Price:  99.61137931946378
curr_Factors:  [99.61137932 -0.91318281 -0.91345241]
mat_Sqrt:  [[16.03287309  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00201181  0.01490199 -0.12469043]
Stock Position:  0.002011806168408406
Bond Position:  [2.60401713]


portfolio before change:  [2.80400304]
curr_Stock_Price:  99.24434461758008
curr_Factors:  [99.24434462 -1.01972836 -0.92677097]
mat_Sqrt:  [[14.16941268  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00915991 -0.01858856 -0.06990202]
Stock Position:  -0.009159911739209615
Bond Position:  [3.71307248]


portfolio before change:  [2.7961952]
curr_Stock_Price:  100.14741098523123
curr_Factors:  [100.14741099  -1.00888666  -0.91597303]
mat_Sqrt:  [[14.61112925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07978338  0.54545516 -0.88444922]
Stock Position:  0.07978338105452976
Bond Position:  [-5.19390386]


portfolio before change:  [2.78340707]
curr_Stock_Price:  99.99526344025188
curr_Factors:  [99.99526344 -1.02848133 -0.91689377]
mat_Sqrt:  [[14.29268294  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030619  0.00358686 -0.09138036]
Stock Position:  -0.00030618830770029606
Bond Position:  [2.81402445]


portfolio before change:  [2.78405333]
curr_Stock_Price:  99.03349501117097
curr_Factors:  [99.03349501 -1.05093843 -0.91603708]
mat_Sqrt:  [[13.85273407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.70072908e-02 -8.39910340e-04 -2.19095614e+00]
Stock Position:  -0.03700729083428558
Bond Position:  [6.44901468]


portfolio before change:  [2.75449699]
curr_Stock_Price:  99.85394178831088
curr_Factors:  [99.85394179 -1.03706293 -0.89831075]
mat_Sqrt:  [[14.41594458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11853094 -1.04726462  7.79572383]
Stock Position:  0.11853093865777777
Bond Position:  [-9.08128446]


portfolio before change:  [2.6926539]
curr_Stock_Price:  99.34177283868058
curr_Factors:  [99.34177284 -1.04386686 -0.92188854]
mat_Sqrt:  [[13.91282054  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118553 -0.03020981  0.08907272]
Stock Position:  0.0011855266768878727
Bond Position:  [2.57488157]


portfolio before change:  [2.69415475]
curr_Stock_Price:  100.33624806066317
curr_Factors:  [100.33624806  -0.93054947  -0.9174391 ]
mat_Sqrt:  [[15.80835289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00720011 -0.00448988 -0.0706258 ]
Stock Position:  0.00720011186808734
Bond Position:  [1.97172254]


portfolio before change:  [2.69796384]
curr_Stock_Price:  100.83104675966717
curr_Factors:  [100.83104676  -0.89049536  -0.92700107]
mat_Sqrt:  [[16.37817874  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0063583  -0.01695626 -0.1548775 ]
Stock Position:  -0.00635829616218305
Bond Position:  [3.3390775]


portfolio before change:  [2.69635845]
curr_Stock_Price:  101.14918196097867
curr_Factors:  [101.14918196  -0.98129513  -0.91435036]
mat_Sqrt:  [[15.19476535  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04384947 -0.56404501 -0.56583822]
Stock Position:  -0.043849474471807134
Bond Position:  [7.13169692]


portfolio before change:  [2.6760968]
curr_Stock_Price:  101.63158624456854
curr_Factors:  [101.63158624  -0.879348    -0.92465011]
mat_Sqrt:  [[16.73255575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00130905 0.01149572 0.19441808]
Stock Position:  0.001309052262975073
Bond Position:  [2.54305574]


portfolio before change:  [2.6767873]
curr_Stock_Price:  101.9162186521135
curr_Factors:  [101.91621865  -0.72476141  -0.93805683]
mat_Sqrt:  [[19.32371022  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01088598 -0.07672     0.7071853 ]
Stock Position:  0.010885979612988053
Bond Position:  [1.56732942]


portfolio before change:  [2.67673596]
curr_Stock_Price:  101.89350477062631
curr_Factors:  [101.89350477  -0.88226412  -0.94357814]
mat_Sqrt:  [[16.41320075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.65117768e-03 2.53970181e-06 1.58518392e-01]
Stock Position:  0.003651177680971656
Bond Position:  [2.30470467]


portfolio before change:  [2.68002591]
curr_Stock_Price:  102.71566193935838
curr_Factors:  [102.71566194  -1.17544528  -0.93638488]
mat_Sqrt:  [[12.43026785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01164074 -0.01800198 -0.06098268]
Stock Position:  0.011640736043405096
Bond Position:  [1.48434]


portfolio before change:  [2.68888963]
curr_Stock_Price:  103.46116177202609
curr_Factors:  [103.46116177  -1.1643596   -0.94472618]
mat_Sqrt:  [[12.55489361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02079126 0.07450506 0.54543928]
Stock Position:  0.020791263795289942
Bond Position:  [0.53780132]


portfolio before change:  [2.67703634]
curr_Stock_Price:  102.88781909758755
curr_Factors:  [102.8878191   -1.16542685  -0.91242606]
mat_Sqrt:  [[12.88142497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01288356  0.02068361  0.19286615]
Stock Position:  -0.012883563793109327
Bond Position:  [4.00259812]


portfolio before change:  [2.67945356]
curr_Stock_Price:  102.73903577086779
curr_Factors:  [102.73903577  -0.87488536  -0.9305999 ]
mat_Sqrt:  [[16.88974918  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00398553 -0.06485693  0.20569633]
Stock Position:  -0.003985533227200696
Bond Position:  [3.0889234]


portfolio before change:  [2.68148577]
curr_Stock_Price:  102.32602256946129
curr_Factors:  [102.32602257  -0.67732077  -0.93273129]
mat_Sqrt:  [[20.45263975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00367069 -0.00457805  0.11013243]
Stock Position:  0.0036706937837087538
Bond Position:  [2.30587828]


portfolio before change:  [2.67542739]
curr_Stock_Price:  100.59701976378344
curr_Factors:  [100.59701976  -0.40768584  -0.90437538]
mat_Sqrt:  [[27.08720333  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168959 -0.03399122  0.07924528]
Stock Position:  0.0016895903126152342
Bond Position:  [2.50545964]


portfolio before change:  [2.67640264]
curr_Stock_Price:  100.98886294501308
curr_Factors:  [100.98886295  -0.50164636  -0.89703042]
mat_Sqrt:  [[24.93652186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180317  0.015827    0.37853726]
Stock Position:  -0.001803174109487677
Bond Position:  [2.85850315]


portfolio before change:  [2.67727821]
curr_Stock_Price:  100.70146274056553
curr_Factors:  [100.70146274  -0.54941891  -0.91238189]
mat_Sqrt:  [[23.34445611  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069247 -0.02230224  0.01988151]
Stock Position:  -0.00069247153212494
Bond Position:  [2.74701111]


portfolio before change:  [2.67697739]
curr_Stock_Price:  101.63178744483193
curr_Factors:  [101.63178744  -0.51191909  -0.92810905]
mat_Sqrt:  [[24.0787139   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00122174 0.0145879  0.25142349]
Stock Position:  0.0012217404155993549
Bond Position:  [2.55280972]


portfolio before change:  [2.67716603]
curr_Stock_Price:  101.5249920799585
curr_Factors:  [101.52499208  -0.7059754   -0.92063224]
mat_Sqrt:  [[19.95934307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170036 -0.00803399 -0.17312952]
Stock Position:  -0.0017003563007926413
Bond Position:  [2.84979469]


portfolio before change:  [2.67887807]
curr_Stock_Price:  100.72763622580251
curr_Factors:  [100.72763623  -0.75052437  -0.89454131]
mat_Sqrt:  [[19.44042238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164832  0.00703013 -0.14940404]
Stock Position:  -0.0016483189623411711
Bond Position:  [2.84490934]


portfolio before change:  [2.67629497]
curr_Stock_Price:  102.51050199256642
curr_Factors:  [102.51050199  -0.95700063  -0.90043163]
mat_Sqrt:  [[15.99910837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00532919 -0.01602684  0.04803784]
Stock Position:  -0.005329194007619302
Bond Position:  [3.22259332]


portfolio before change:  [2.68144939]
curr_Stock_Price:  101.61889089303794
curr_Factors:  [101.61889089  -0.68316084  -0.89739489]
mat_Sqrt:  [[20.91933222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01143846 0.00308297 0.11550022]
Stock Position:  0.011438464325163267
Bond Position:  [1.51908533]


portfolio before change:  [2.69110452]
curr_Stock_Price:  102.4463821170203
curr_Factors:  [102.44638212  -0.49935031  -0.90076774]
mat_Sqrt:  [[25.25998469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025737  0.02478405 -0.10640897]
Stock Position:  -0.0002573667492061447
Bond Position:  [2.71747081]


portfolio before change:  [2.69147649]
curr_Stock_Price:  102.32099257484633
curr_Factors:  [102.32099257  -0.51425603  -0.91494104]
mat_Sqrt:  [[24.50599531  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00554702 -0.0127644  -0.30758751]
Stock Position:  -0.005547018805816822
Bond Position:  [3.25905296]


portfolio before change:  [2.68707149]
curr_Stock_Price:  103.18855867664307
curr_Factors:  [103.18855868  -0.41478306  -0.90838415]
mat_Sqrt:  [[27.47813973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10535866 0.54318659 0.54330794]
Stock Position:  0.10535865502303786
Bond Position:  [-8.18473626]


portfolio before change:  [2.6561817]
curr_Stock_Price:  102.9050827818008
curr_Factors:  [102.90508278  -0.36519754  -0.88914394]
mat_Sqrt:  [[29.35507836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176943 -0.00252372 -0.05741603]
Stock Position:  -0.0017694321203314183
Bond Position:  [2.83826526]


portfolio before change:  [2.65462206]
curr_Stock_Price:  103.98703629399681
curr_Factors:  [103.98703629  -0.50650382  -0.89908775]
mat_Sqrt:  [[25.49990361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.56921081e-04 -4.22094865e-03 -3.76002371e-01]
Stock Position:  0.0002569210805821312
Bond Position:  [2.6279056]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.65449628]
Stock Price:  102.21883373414029
PL:  [0.43566255]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 4.63732276e-02 -4.24659624e-02  1.14126818e-01]
 [ 1.90689752e+00  5.54820884e-01  7.50941206e-01]
 [ 1.29690584e-01  2.39773832e-01  4.29973334e-02]
 [ 9.28670541e-02  6.73058164e-01  5.83318242e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 5.23764818e-02  1.68508694e-01 -9.19907237e-02]
 [-3.21888650e-02 -1.19266517e-01  2.13006366e-03]
 [ 8.09873936e-02  1.23524064e-01 -5.45039246e-02]
 [ 3.26351779e-02  4.52167172e-02 -4.35641352e-02]
 [-3.55927599e-01  2.40226672e-02 -1.26588722e-01]
 [ 5.68289139e-01  1.12940338e+00 -1.90451463e-01]
 [ 7.89575064e-05  3.35042259e-02 -5.91752650e-02]
 [ 7.31979551e-02 -1.82212631e-02  4.48584502e-02]
 [ 1.43972808e+00 -2.76025660e+00  2.32847289e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.79022142e-01 -1.48263709e-01  4.54117859e-02]
 [-3.77574560e-01 -6.96651490e-01  4.71961440e-02]
 [-2.40295636e-01 -1.59518119e+00 -2.02455398e-01]
 [ 1.20528674e-03  3.69803866e-02  6.00018956e-02]
 [ 4.04441222e-01 -5.91468846e-01  2.50725508e-01]
 [ 6.76139451e-02  2.83263942e-01 -2.53772855e-01]
 [-2.99659213e-01 -4.80980485e-02 -2.00002394e-01]
 [ 5.74241044e-01  3.06758262e-01  3.72695997e-01]
 [-1.85104262e-01  6.06777139e-02  7.27043572e-02]
 [-9.74135119e-02 -2.92332505e-01  1.07325843e-01]
 [ 1.47712222e-01 -4.17837485e-02 -1.55333157e-01]
 [ 4.94586655e-01 -2.96014490e-02  3.00590882e-01]
 [-5.87057311e-02  6.08695250e-02  1.05522819e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 1.33698787e-01 -2.29457364e-02  4.81850665e-02]
 [-2.16283991e-02 -2.25093977e-02 -6.03026401e-02]
 [-1.68519935e-02  2.07950064e-02 -5.45062162e-02]
 [-9.95610191e-02 -3.78971276e-02  3.16070486e-02]
 [ 2.48471926e-01  2.66094811e-02  5.47046441e-02]
 [ 8.03213831e-02 -4.41459886e-02  1.14892194e-04]
 [-1.14799124e-01 -6.32366836e-02 -8.19111191e-02]
 [ 1.54326421e+00  1.04300369e+00  1.46191339e-01]
 [-4.59142257e-02 -2.91258033e-02 -2.89302710e-02]
 [ 3.68602575e-02 -1.31863681e-02 -1.45143796e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.65866018]
curr_Stock_Price:  101.12592947326758
curr_Factors:  [101.12592947  -0.74844299  -1.00521217]
mat_Sqrt:  [[17.5089364   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00348399 -0.01370583  0.32557204]
Stock Position:  0.003483988807078287
Bond Position:  [10.30633857]


portfolio before change:  [10.66548821]
curr_Stock_Price:  102.71596280801815
curr_Factors:  [102.71596281  -0.89551815  -1.04990676]
mat_Sqrt:  [[14.68083102  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.14804578 0.17906767 2.14222624]
Stock Position:  0.1480457804673002
Bond Position:  [-4.54117667]


portfolio before change:  [10.52888062]
curr_Stock_Price:  101.79705847500237
curr_Factors:  [101.79705848  -0.82919164  -1.02890557]
mat_Sqrt:  [[15.87719807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01180378 0.07738667 0.12265942]
Stock Position:  0.011803783372754605
Bond Position:  [9.32729019]


portfolio before change:  [10.52741261]
curr_Stock_Price:  101.57391028021148
curr_Factors:  [101.57391028  -0.73862076  -1.03518594]
mat_Sqrt:  [[17.23565168  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02026751 0.21722859 1.66404458]
Stock Position:  0.020267514139041036
Bond Position:  [8.46876195]


portfolio before change:  [10.54184774]
curr_Stock_Price:  102.23390563112879
curr_Factors:  [102.23390563  -0.55447801  -1.05159178]
mat_Sqrt:  [[20.5157644   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00285858 -0.01106097 -0.05874131]
Stock Position:  -0.0028585822977860746
Bond Position:  [10.83409177]


portfolio before change:  [10.53947642]
curr_Stock_Price:  103.5372322116437
curr_Factors:  [103.53723221  -0.64596704  -1.07023747]
mat_Sqrt:  [[18.61051548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00365361  0.05438595 -0.26242393]
Stock Position:  0.0036536143861359703
Bond Position:  [10.1611913]


portfolio before change:  [10.53815762]
curr_Stock_Price:  102.82861252093423
curr_Factors:  [102.82861252  -0.47591586  -1.07434838]
mat_Sqrt:  [[21.81939833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257107 -0.0384931   0.00607648]
Stock Position:  -0.002571071970598684
Bond Position:  [10.80253739]


portfolio before change:  [10.54152987]
curr_Stock_Price:  102.04223014843001
curr_Factors:  [102.04223015  -0.39463161  -1.06962188]
mat_Sqrt:  [[23.59732272  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0040291   0.03986722 -0.15548453]
Stock Position:  0.004029104131766924
Bond Position:  [10.1303911]


portfolio before change:  [10.54727208]
curr_Stock_Price:  103.15310536970952
curr_Factors:  [103.15310537  -0.50170588  -1.07101887]
mat_Sqrt:  [[21.4021117   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00154062  0.01459363 -0.12427635]
Stock Position:  0.0015406194621877555
Bond Position:  [10.3883524]


portfolio before change:  [10.548713]
curr_Stock_Price:  103.24546768251892
curr_Factors:  [103.24546768  -0.63256802  -1.06666313]
mat_Sqrt:  [[18.87575293  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0199655   0.00775328 -0.36112239]
Stock Position:  -0.019965497970125767
Bond Position:  [12.61006018]


portfolio before change:  [10.53243685]
curr_Stock_Price:  104.13963558673483
curr_Factors:  [104.13963559  -0.5831206   -1.05606402]
mat_Sqrt:  [[20.21748912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03758884  0.36451337 -0.54330501]
Stock Position:  0.03758883666024343
Bond Position:  [6.6179491]


portfolio before change:  [10.57894847]
curr_Stock_Price:  105.35500516130091
curr_Factors:  [105.35500516  -0.70314398  -1.05945948]
mat_Sqrt:  [[18.07865915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00028548  0.01081344 -0.16881056]
Stock Position:  -0.0002854814263316754
Bond Position:  [10.60902537]


portfolio before change:  [10.58035839]
curr_Stock_Price:  105.0617939632077
curr_Factors:  [105.06179396  -0.57677801  -1.0391311 ]
mat_Sqrt:  [[20.87682281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00376663 -0.00588089  0.12796867]
Stock Position:  0.003766629091985848
Bond Position:  [10.18462958]


portfolio before change:  [10.58073406]
curr_Stock_Price:  104.82352119371588
curr_Factors:  [104.82352119  -0.53251943  -1.04189183]
mat_Sqrt:  [[21.71203964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06225074 -0.89086899  6.64248504]
Stock Position:  0.06225074288123304
Bond Position:  [4.055392]


portfolio before change:  [10.60429741]
curr_Stock_Price:  105.19390057174695
curr_Factors:  [105.19390057  -0.44095734  -1.06905166]
mat_Sqrt:  [[23.23817317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093249 -0.03053791  0.10625201]
Stock Position:  -0.0009324903777596437
Bond Position:  [10.70238971]


portfolio before change:  [10.603289]
curr_Stock_Price:  107.71005992657818
curr_Factors:  [107.71005993  -0.56939351  -1.08206095]
mat_Sqrt:  [[20.65564245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00765058 -0.04785191  0.12954718]
Stock Position:  0.007650576901149277
Bond Position:  [9.7792449]


portfolio before change:  [10.61372225]
curr_Stock_Price:  108.91399076677415
curr_Factors:  [108.91399077  -0.48235182  -1.11731955]
mat_Sqrt:  [[21.99658297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02319197 -0.2248433   0.13463746]
Stock Position:  -0.023191969330474682
Bond Position:  [13.13965218]


portfolio before change:  [10.60395414]
curr_Stock_Price:  109.4060002503521
curr_Factors:  [109.40600025  -0.4973053   -1.12008616]
mat_Sqrt:  [[21.70785729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02797313 -0.51484252 -0.5775489 ]
Stock Position:  -0.027973127909463304
Bond Position:  [13.66438218]


portfolio before change:  [10.66760662]
curr_Stock_Price:  107.19157745248279
curr_Factors:  [107.19157745  -0.4999794   -1.10271584]
mat_Sqrt:  [[21.58335544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00097305 0.01193537 0.17116871]
Stock Position:  0.0009730513053293434
Bond Position:  [10.56330372]


portfolio before change:  [10.66869795]
curr_Stock_Price:  106.9560668760087
curr_Factors:  [106.95606688  -0.2693208   -1.0885149 ]
mat_Sqrt:  [[27.51090465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01217289 -0.19089575  0.71525009]
Stock Position:  0.012172892319679232
Bond Position:  [9.36673327]


portfolio before change:  [10.67251512]
curr_Stock_Price:  107.17345590156133
curr_Factors:  [ 1.07173456e+02 -1.04222379e-01 -1.09358117e+00]
mat_Sqrt:  [[32.35100393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227609  0.09142304 -0.72394332]
Stock Position:  0.002276089732306449
Bond Position:  [10.42857872]


portfolio before change:  [10.67099334]
curr_Stock_Price:  105.93209854056089
curr_Factors:  [ 1.05932099e+02 -5.05749266e-02 -1.11164715e+00]
mat_Sqrt:  [[33.13453956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01057213 -0.01552358 -0.57055116]
Stock Position:  -0.010572125281646857
Bond Position:  [11.79092075]


portfolio before change:  [10.681604]
curr_Stock_Price:  105.0678721108723
curr_Factors:  [105.06787211  -0.15669153  -1.07819425]
mat_Sqrt:  [[30.56088014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02332832 0.0990058  1.06319794]
Stock Position:  0.02332832237163575
Bond Position:  [8.23054681]


portfolio before change:  [10.66464162]
curr_Stock_Price:  104.2966522792241
curr_Factors:  [104.29665228  -0.31747579  -1.08585814]
mat_Sqrt:  [[25.63363453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00615901  0.01958365  0.20740529]
Stock Position:  -0.006159008006145185
Bond Position:  [11.30700554]


portfolio before change:  [10.66551004]
curr_Stock_Price:  104.38514854458025
curr_Factors:  [104.38514854  -0.52114838  -1.08733991]
mat_Sqrt:  [[20.89686446  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00646881 -0.09434991  0.30617076]
Stock Position:  -0.0064688096535149234
Bond Position:  [11.34075769]


portfolio before change:  [10.65828489]
curr_Stock_Price:  105.72122501330206
curr_Factors:  [105.72122501  -0.79793292  -1.1196424 ]
mat_Sqrt:  [[15.53709439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00691737 -0.01348565 -0.44312226]
Stock Position:  0.006917374602464448
Bond Position:  [9.92697158]


portfolio before change:  [10.65726937]
curr_Stock_Price:  105.39502184074792
curr_Factors:  [105.39502184  -0.76774012  -1.09052972]
mat_Sqrt:  [[16.43553176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03345813 -0.00955383  0.85750212]
Stock Position:  0.03345812896864012
Bond Position:  [7.13094914]


portfolio before change:  [10.64533502]
curr_Stock_Price:  105.01168356682686
curr_Factors:  [105.01168357  -0.50969475  -1.09862866]
mat_Sqrt:  [[21.02575685  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011767   0.01964555  0.30102723]
Stock Position:  -0.001176701327575625
Bond Position:  [10.7689024]


portfolio before change:  [10.64658261]
curr_Stock_Price:  105.09548034109405
curr_Factors:  [105.09548034  -0.81838228  -1.11817896]
mat_Sqrt:  [[15.15465938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226857 -0.02600141 -0.03673698]
Stock Position:  -0.0022685735690398186
Bond Position:  [10.88499944]


portfolio before change:  [10.65095304]
curr_Stock_Price:  103.76877967262513
curr_Factors:  [103.76877967  -0.6153408   -1.1134954 ]
mat_Sqrt:  [[18.41800924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00753886 -0.0074057   0.13745858]
Stock Position:  0.00753885730824603
Bond Position:  [9.86865502]


portfolio before change:  [10.63402826]
curr_Stock_Price:  101.36013435694204
curr_Factors:  [101.36013436  -0.5121191   -1.11690382]
mat_Sqrt:  [[19.87886176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193836 -0.00726488 -0.17202665]
Stock Position:  -0.0019383572374209936
Bond Position:  [10.83050041]


portfolio before change:  [10.63512421]
curr_Stock_Price:  101.49321359392941
curr_Factors:  [101.49321359  -0.52597815  -1.14425364]
mat_Sqrt:  [[19.10137163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124249  0.00671156 -0.15549106]
Stock Position:  -0.0012424901144021771
Bond Position:  [10.76122852]


portfolio before change:  [10.63721671]
curr_Stock_Price:  100.89178955791787
curr_Factors:  [100.89178956  -0.50238759  -1.14461083]
mat_Sqrt:  [[19.43450573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00518897 -0.01223125  0.09016611]
Stock Position:  -0.00518896531396779
Bond Position:  [11.1607407]


portfolio before change:  [10.63369174]
curr_Stock_Price:  101.83998351144339
curr_Factors:  [101.83998351  -0.43015907  -1.16982323]
mat_Sqrt:  [[20.561502    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01289157 0.00858817 0.15605712]
Stock Position:  0.01289157291680956
Bond Position:  [9.32081417]


portfolio before change:  [10.62292866]
curr_Stock_Price:  100.9147084482055
curr_Factors:  [100.91470845  -0.50795574  -1.16408709]
mat_Sqrt:  [[18.95812986  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00376269 -0.01424806  0.00032776]
Stock Position:  0.0037626904005949894
Bond Position:  [10.24321786]


portfolio before change:  [10.62020024]
curr_Stock_Price:  99.84927142881943
curr_Factors:  [99.84927143 -0.58660652 -1.15625495]
mat_Sqrt:  [[17.47550683  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00826456 -0.02040955 -0.23366962]
Stock Position:  -0.008264555427851943
Bond Position:  [11.44541008]


portfolio before change:  [10.60644451]
curr_Stock_Price:  101.68681647481445
curr_Factors:  [101.68681647  -0.52946944  -1.15890458]
mat_Sqrt:  [[18.79373643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09503207 0.33662799 0.4170432 ]
Stock Position:  0.09503206737278769
Bond Position:  [0.94293612]


portfolio before change:  [10.73252305]
curr_Stock_Price:  103.01227083259309
curr_Factors:  [103.01227083  -0.51448231  -1.18458116]
mat_Sqrt:  [[18.836277    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306668 -0.00940031 -0.08253001]
Stock Position:  -0.0030666820296667476
Bond Position:  [11.04842893]


portfolio before change:  [10.73159]
curr_Stock_Price:  103.76689618578636
curr_Factors:  [103.76689619  -0.72961226  -1.20129477]
mat_Sqrt:  [[15.04792299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.01785703e-04 -4.25588201e-03 -4.14054851e-01]
Stock Position:  0.0003017857026002429
Bond Position:  [10.70027463]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.73312568]
Stock Price:  104.42319723765414
PL:  [6.30992844]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.01575441e-01 -4.01180483e-02 -4.86747063e-02]
 [ 1.52140414e+00  3.00684437e-01  4.83288758e-01]
 [ 1.29690584e-01  2.39773832e-01  4.29973334e-02]
 [ 8.63603366e-02  7.50825954e-01  5.65110053e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.21535605e-02 -6.48205355e-02  5.00849200e-02]
 [-3.83296393e-02 -7.96301381e-02 -2.61779246e-02]
 [ 1.40103438e-01  7.89685675e-02 -1.23409256e-01]
 [ 5.16045477e-03  7.49488079e-02 -4.80812000e-02]
 [-1.86849167e-01 -9.44957696e-02 -7.29963524e-02]
 [ 7.82778381e-01  1.51409502e+00 -2.70716530e-01]
 [-2.26895005e-04  3.16178558e-02 -5.82459757e-02]
 [-1.82489973e-01 -1.29199736e-02 -4.11859946e-01]
 [ 1.66584288e+00 -3.21458183e+00  2.71322494e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.48542698e-01 -1.15440921e-01  3.54765206e-02]
 [-2.69949770e-01 -4.59333845e-01  1.33509393e-02]
 [-2.46723509e-01 -1.62518799e+00 -2.00071803e-01]
 [-1.59210085e-02  6.58201959e-02  2.35618896e-01]
 [ 3.90994675e-01 -5.96453839e-01  3.25100381e-01]
 [ 9.12767869e-02 -1.10089816e-02 -2.09332503e-01]
 [-1.66858834e-01 -5.10620218e-02 -1.52700324e-01]
 [ 3.23600189e-01  3.63677774e-01  3.03794590e-01]
 [ 2.52195083e-01 -6.56631570e-02  1.09940168e-01]
 [-9.45507707e-02 -2.80283267e-01  1.05878412e-01]
 [ 1.36757574e-01 -5.19503455e-02 -1.54902572e-01]
 [ 8.86546708e-01 -3.79843802e-02  5.28135302e-01]
 [-5.94594013e-02  6.02644188e-02  1.06339402e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 4.24739578e-01 -1.97280161e-01 -5.07358689e-02]
 [-2.44904118e-02 -8.90269224e-02 -1.65802554e-02]
 [-4.40951200e-02 -1.21176584e-02  6.01211236e-03]
 [-4.10155926e-02  1.33353905e-01 -2.23720198e-01]
 [ 6.21976047e-01  1.37101589e-01  2.05896145e-01]
 [ 7.81487924e-02  1.35337763e-01 -8.46335487e-02]
 [-8.57548895e-03  3.88834643e-02  5.15350008e-02]
 [ 2.04065874e+00  1.49722126e+00  1.93435901e-01]
 [-1.16587754e-01  3.17536022e-02 -1.71035818e-03]
 [ 3.82297155e-02 -1.24493922e-02 -1.82382290e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.03842808]
curr_Stock_Price:  100.76836841002543
curr_Factors:  [100.76836841  -1.0850403   -1.02498365]
mat_Sqrt:  [[12.21665943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00683089 -0.01294804 -0.13885539]
Stock Position:  0.006830893177030855
Bond Position:  [7.35009012]


portfolio before change:  [8.04070151]
curr_Stock_Price:  100.96667495544476
curr_Factors:  [100.96667496  -1.30857157  -1.05643444]
mat_Sqrt:  [[ 9.48569141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.17725982 0.09704548 1.3786883 ]
Stock Position:  0.17725982468835405
Bond Position:  [-9.85663359]


portfolio before change:  [8.16383708]
curr_Stock_Price:  101.66828755614965
curr_Factors:  [101.66828756  -1.38738523  -1.04330061]
mat_Sqrt:  [[ 8.94441748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02095285 0.07738667 0.12265942]
Stock Position:  0.02095284652104841
Bond Position:  [6.03359706]


portfolio before change:  [8.16624888]
curr_Stock_Price:  101.74739637132248
curr_Factors:  [101.74739637  -1.68441124  -1.02165409]
mat_Sqrt:  [[ 6.79663681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05222799 0.24232803 1.61210169]
Stock Position:  0.052227985555746176
Bond Position:  [2.85218734]


portfolio before change:  [8.15386375]
curr_Stock_Price:  101.50343365588823
curr_Factors:  [101.50343366  -1.50379285  -1.02996153]
mat_Sqrt:  [[ 8.05536435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00728037 -0.01106097 -0.05874131]
Stock Position:  -0.007280366023742855
Bond Position:  [8.8928459]


portfolio before change:  [8.15801985]
curr_Stock_Price:  101.08526382483642
curr_Factors:  [101.08526382  -1.325113    -1.03583751]
mat_Sqrt:  [[ 9.53542531  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00620273 -0.02092074  0.14287834]
Stock Position:  0.006202729677700203
Bond Position:  [7.53101529]


portfolio before change:  [8.16190916]
curr_Stock_Price:  101.56051841183094
curr_Factors:  [101.56051841  -1.60974409  -1.03259481]
mat_Sqrt:  [[ 7.23055617  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00828811 -0.02570052 -0.07467833]
Stock Position:  -0.008288106510585593
Bond Position:  [9.00365356]


portfolio before change:  [8.15632408]
curr_Stock_Price:  102.37018614919324
curr_Factors:  [102.37018615  -1.19991905  -1.02398217]
mat_Sqrt:  [[11.07504413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01183129  0.025487   -0.35205226]
Stock Position:  0.011831286519112577
Bond Position:  [6.94515308]


portfolio before change:  [8.15564494]
curr_Stock_Price:  102.23940240932106
curr_Factors:  [102.23940241  -1.17132366  -1.02457232]
mat_Sqrt:  [[11.3750364   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009358   0.02418962 -0.13716228]
Stock Position:  0.0009358020404007175
Bond Position:  [8.0599691]


portfolio before change:  [8.15614291]
curr_Stock_Price:  101.69485809301251
curr_Factors:  [101.69485809  -0.94423539  -1.02101028]
mat_Sqrt:  [[14.24963196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01551186 -0.03049838 -0.20823828]
Stock Position:  -0.015511864025970708
Bond Position:  [9.73361972]


portfolio before change:  [8.15847194]
curr_Stock_Price:  101.62315475215928
curr_Factors:  [101.62315475  -0.94057804  -1.06116017]
mat_Sqrt:  [[13.72931324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07550137  0.48867207 -0.77227891]
Stock Position:  0.0755013695040238
Bond Position:  [0.48578458]


portfolio before change:  [8.15545207]
curr_Stock_Price:  101.58235288818715
curr_Factors:  [101.58235289  -1.09718706  -1.0430959 ]
mat_Sqrt:  [[11.94827445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004739   0.01020462 -0.16615956]
Stock Position:  -0.00047390418046452525
Bond Position:  [8.20359237]


portfolio before change:  [8.15630782]
curr_Stock_Price:  101.9405873129651
curr_Factors:  [101.94058731  -1.23006425  -1.07366997]
mat_Sqrt:  [[10.18235118  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02643769 -0.0041699  -1.17492179]
Stock Position:  -0.026437686704567878
Bond Position:  [10.85138113]


portfolio before change:  [8.13961561]
curr_Stock_Price:  102.62327614412985
curr_Factors:  [102.62327614  -1.17112987  -1.06444555]
mat_Sqrt:  [[10.97356668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.14247909 -1.03750182  7.74007555]
Stock Position:  0.14247909365151315
Bond Position:  [-6.48205576]


portfolio before change:  [8.30705368]
curr_Stock_Price:  103.80413973838819
curr_Factors:  [103.80413974  -1.03089701  -1.07468511]
mat_Sqrt:  [[12.64072475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00171425 -0.03053791  0.10625201]
Stock Position:  -0.0017142508282528765
Bond Position:  [8.48500001]


portfolio before change:  [8.30521665]
curr_Stock_Price:  105.49451157983121
curr_Factors:  [105.49451158  -1.14526058  -1.05491788]
mat_Sqrt:  [[11.68703924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01131339 -0.0372584   0.10120464]
Stock Position:  0.011313390071091806
Bond Position:  [7.11171609]


portfolio before change:  [8.3134463]
curr_Stock_Price:  106.14335613229997
curr_Factors:  [106.14335613  -1.24819997  -1.06183236]
mat_Sqrt:  [[10.53558171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03426348 -0.14824936  0.03808651]
Stock Position:  -0.03426347581104673
Bond Position:  [11.95028661]


portfolio before change:  [8.30618797]
curr_Stock_Price:  106.39879446985644
curr_Factors:  [106.39879447  -1.37055245  -1.06623201]
mat_Sqrt:  [[ 9.30367786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06656541 -0.52452717 -0.57074916]
Stock Position:  -0.06656540701450746
Bond Position:  [15.38866703]


portfolio before change:  [8.34059874]
curr_Stock_Price:  105.91074716599122
curr_Factors:  [105.91074717  -1.30231962  -1.01653862]
mat_Sqrt:  [[10.4201194   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00437711 0.02124338 0.67215513]
Stock Position:  0.004377108039851396
Bond Position:  [7.87701596]


portfolio before change:  [8.34196853]
curr_Stock_Price:  105.99872780542043
curr_Factors:  [105.99872781  -1.29169199  -1.02381831]
mat_Sqrt:  [[10.46374882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0320731  -0.19250465  0.9274209 ]
Stock Position:  0.032073101874217566
Bond Position:  [4.94226054]


portfolio before change:  [8.34174974]
curr_Stock_Price:  105.97264327603223
curr_Factors:  [105.97264328  -1.17924086  -1.02910258]
mat_Sqrt:  [[11.6445416   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00397609 -0.00355313 -0.59716736]
Stock Position:  0.003976092081175179
Bond Position:  [7.92039275]


portfolio before change:  [8.34100838]
curr_Stock_Price:  105.53717137267581
curr_Factors:  [105.53717137  -1.25115754  -1.01395116]
mat_Sqrt:  [[10.95673707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01902497 -0.0164802  -0.43561152]
Stock Position:  -0.01902497498283218
Bond Position:  [10.34885042]


portfolio before change:  [8.32834112]
curr_Stock_Price:  106.27099305228442
curr_Factors:  [106.27099305  -1.56924218  -1.01460187]
mat_Sqrt:  [[ 8.02168354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05732555 0.1173765  0.86664141]
Stock Position:  0.05732554928954097
Bond Position:  [2.23629807]


portfolio before change:  [8.36460694]
curr_Stock_Price:  106.89874563390381
curr_Factors:  [106.89874563  -1.62491434  -1.04190375]
mat_Sqrt:  [[ 7.42656913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03517547 -0.02119269  0.3136287 ]
Stock Position:  0.03517547413579073
Bond Position:  [4.60439288]


portfolio before change:  [8.36987111]
curr_Stock_Price:  107.03203682373798
curr_Factors:  [107.03203682  -1.85048313  -1.05667916]
mat_Sqrt:  [[ 5.84721749  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02225862 -0.09046104  0.30204164]
Stock Position:  -0.022258623494975805
Bond Position:  [10.75225692]


portfolio before change:  [8.37541532]
curr_Stock_Price:  106.84334145597366
curr_Factors:  [106.84334146  -1.83532699  -1.05170505]
mat_Sqrt:  [[ 5.95559803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01587312 -0.0167669  -0.44189392]
Stock Position:  0.01587311605338651
Bond Position:  [6.67947856]


portfolio before change:  [8.37864727]
curr_Stock_Price:  106.99434922980517
curr_Factors:  [106.99434923  -1.80737148  -1.06417256]
mat_Sqrt:  [[ 6.05710516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.16288282 -0.01225941  1.50662301]
Stock Position:  0.1628828160621174
Bond Position:  [-9.04889363]


portfolio before change:  [8.36013783]
curr_Stock_Price:  106.88765743221447
curr_Factors:  [106.88765743  -1.74144551  -1.09689906]
mat_Sqrt:  [[ 6.25532924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00406878  0.01945026  0.30335671]
Stock Position:  -0.004068776842363463
Bond Position:  [8.79503986]


portfolio before change:  [8.36303641]
curr_Stock_Price:  106.44547784977993
curr_Factors:  [106.44547785  -1.61162303  -1.0952337 ]
mat_Sqrt:  [[ 7.10483958  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483888 -0.02600141 -0.03673698]
Stock Position:  -0.004838879096255724
Bond Position:  [8.87811321]


portfolio before change:  [8.3659748]
curr_Stock_Price:  106.06758920283798
curr_Factors:  [106.0675892   -1.48843745  -1.10521546]
mat_Sqrt:  [[ 7.92818095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04718781 -0.0636719  -0.14473531]
Stock Position:  0.047187812638616856
Bond Position:  [3.36087727]


portfolio before change:  [8.39118835]
curr_Stock_Price:  106.5930090312308
curr_Factors:  [106.59300903  -1.28800481  -1.09577042]
mat_Sqrt:  [[ 9.82807115  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468529 -0.02873332 -0.04729885]
Stock Position:  -0.004685292362843752
Bond Position:  [8.89060776]


portfolio before change:  [8.38871439]
curr_Stock_Price:  107.35824428761828
curr_Factors:  [107.35824429  -1.52726358  -1.11817755]
mat_Sqrt:  [[ 7.61964812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00595059 -0.00391096  0.01715088]
Stock Position:  -0.00595059097310947
Bond Position:  [9.02755939]


portfolio before change:  [8.38965295]
curr_Stock_Price:  107.39016715067699
curr_Factors:  [107.39016715  -1.38213199  -1.10300363]
mat_Sqrt:  [[ 8.94713176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00664588  0.04303979 -0.63821145]
Stock Position:  -0.0066458767600342215
Bond Position:  [9.10335476]


portfolio before change:  [8.38732295]
curr_Stock_Price:  107.91199333823147
curr_Factors:  [107.91199334  -1.19679144  -1.13642086]
mat_Sqrt:  [[10.46570498  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06611979 0.04424935 0.58736439]
Stock Position:  0.06611978526408843
Bond Position:  [1.25220512]


portfolio before change:  [8.36963823]
curr_Stock_Price:  107.64216107983815
curr_Factors:  [107.64216108  -1.4477424   -1.11350201]
mat_Sqrt:  [[ 8.31090073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01064851  0.04368008 -0.24143596]
Stock Position:  0.01064851450072435
Bond Position:  [7.22340912]


portfolio before change:  [8.36547555]
curr_Stock_Price:  107.16644543443614
curr_Factors:  [107.16644543  -1.33614454  -1.12060482]
mat_Sqrt:  [[ 9.18557052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00107572 0.01254958 0.14701501]
Stock Position:  0.0010757201131825836
Bond Position:  [8.25019445]


portfolio before change:  [8.36617367]
curr_Stock_Price:  106.85668751116054
curr_Factors:  [106.85668751  -0.97997789  -1.1120603 ]
mat_Sqrt:  [[13.18988679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.18087818 0.48322608 0.55181878]
Stock Position:  0.18087817750630006
Bond Position:  [-10.96186922]


portfolio before change:  [8.36856222]
curr_Stock_Price:  106.8774687293936
curr_Factors:  [106.87746873  -0.67213551  -1.09007645]
mat_Sqrt:  [[18.34709153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00602031  0.01024843 -0.00487918]
Stock Position:  -0.006020311323928383
Bond Position:  [9.01199786]


portfolio before change:  [8.37374861]
curr_Stock_Price:  106.2031147906632
curr_Factors:  [106.20311479  -0.69126145  -1.06789524]
mat_Sqrt:  [[18.28711565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.42196845e-05 -4.01802405e-03 -5.20285908e-01]
Stock Position:  -8.421968453076058e-05
Bond Position:  [8.38269301]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.37476812]
Stock Price:  106.5403166529218
PL:  [1.83445147]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 2.36891046e-02 -7.18283483e-02 -1.47296204e-02]
 [ 9.28597361e-01  2.05615796e-01  2.59443195e-01]
 [-3.48116456e-01 -2.33963615e-01  3.99506836e-02]
 [ 1.78217089e-01  1.49396811e+00  1.16019463e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-1.01656108e-03  1.30609485e-01 -3.70043932e-02]
 [-1.36664126e-01  2.35962009e-01  9.35782358e-02]
 [-2.87927800e-02 -3.58791751e-02  6.95477763e-02]
 [ 5.17805698e-02  2.44983090e-02 -4.04164792e-02]
 [-1.06905706e-01 -5.37901715e-02 -2.02688644e-02]
 [ 6.52803715e-01  1.32484402e+00 -2.11027471e-01]
 [-2.06392950e-04  2.47432746e-02 -2.63743335e-02]
 [-4.61173733e-01 -1.73882468e-02 -9.53324202e-01]
 [ 2.06726212e+00 -3.42770761e+00  2.90380936e+00]
 [ 2.26766998e-02 -6.42052421e-02 -5.93248985e-03]
 [ 5.58393192e-02  1.17581672e-01 -7.35214382e-02]
 [ 2.32945840e-02  1.25650764e-01 -1.40243606e-01]
 [-2.81596930e-01 -1.80775727e+00 -1.94282261e-01]
 [ 6.05967335e-03 -1.07518316e-01  4.14908342e-01]
 [ 1.66774396e-01  3.30508093e-01  4.67892703e-01]
 [ 2.97793870e-02 -4.35816900e-02  4.26250613e-02]
 [ 9.96137041e-02 -4.95080222e-02  1.51659300e-02]
 [-2.60947746e-02  6.65396811e-02  1.49018071e-02]
 [-7.33614675e-02 -3.23199024e-02 -1.67533575e-02]
 [ 4.57777341e-02 -1.86829289e-02 -5.56798811e-03]
 [ 2.77074298e-02 -4.55557675e-02  2.63251326e-01]
 [ 2.97271968e-02 -1.15462949e-01  1.70010357e-02]
 [-1.38427793e-01  1.10588400e-01  1.85972286e-01]
 [ 2.95415830e-02  7.40644679e-03  1.48255102e-01]
 [-1.64843886e-01  1.21675392e-01 -4.93264400e-02]
 [ 8.36310625e-02 -1.02683913e-02 -4.12325564e-02]
 [ 6.64974616e-03 -1.92032176e-03 -5.39006132e-02]
 [ 3.12985021e-02  5.60750979e-02  1.01576273e-01]
 [ 9.38410623e-03 -4.23997928e-02 -9.79007890e-03]
 [-9.53742789e-02  8.71748881e-02  3.48415047e-02]
 [-9.55618464e-02 -5.41850868e-02 -5.91851904e-02]
 [ 1.49214486e+00  9.73234898e-01  1.36834415e-01]
 [ 1.72545134e-01 -2.56941748e-01  7.38603193e-02]
 [ 2.82583832e-02 -1.55502086e-02  1.04016482e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.596242]
curr_Stock_Price:  99.59006752026532
curr_Factors:  [99.59006752 -1.15075198 -1.01194645]
mat_Sqrt:  [[11.4542862   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00052561 -0.0231825  -0.04201951]
Stock Position:  0.0005256140008820754
Bond Position:  [-0.64858793]


portfolio before change:  [-0.59634594]
curr_Stock_Price:  99.54656642316348
curr_Factors:  [99.54656642 -1.26770204 -1.04246029]
mat_Sqrt:  [[ 9.87951283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10360097 0.06636221 0.74011922]
Stock Position:  0.10360097176340362
Bond Position:  [-10.90946696]


portfolio before change:  [-0.65085829]
curr_Stock_Price:  99.03355403115489
curr_Factors:  [99.03355403 -1.2664337  -1.06471336]
mat_Sqrt:  [[ 9.62449743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04028462 -0.07551143  0.11396818]
Stock Position:  -0.04028461568459109
Bond Position:  [3.33867037]


portfolio before change:  [-0.67643024]
curr_Stock_Price:  99.6786962779733
curr_Factors:  [99.67869628 -1.61203641 -1.08519696]
mat_Sqrt:  [[ 6.71751708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10718183 0.48217613 3.30971235]
Stock Position:  0.10718183232430896
Bond Position:  [-11.36017555]


portfolio before change:  [-0.75533537]
curr_Stock_Price:  98.95576572916643
curr_Factors:  [98.95576573 -1.51218068 -1.08965969]
mat_Sqrt:  [[ 7.3362849   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00799396 -0.01106097 -0.05874131]
Stock Position:  -0.00799396448430466
Bond Position:  [0.03571351]


portfolio before change:  [-0.75113302]
curr_Stock_Price:  98.4306338440523
curr_Factors:  [98.43063384 -1.4430719  -1.12016654]
mat_Sqrt:  [[ 7.58455266  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00238518  0.04215403 -0.10556323]
Stock Position:  0.0023851767009862392
Bond Position:  [-0.98590747]


portfolio before change:  [-0.75057956]
curr_Stock_Price:  98.71434630640981
curr_Factors:  [98.71434631 -1.36278451 -1.13992297]
mat_Sqrt:  [[ 8.08105804  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00858761  0.07615641  0.26695266]
Stock Position:  -0.008587613789335575
Bond Position:  [0.09714112]


portfolio before change:  [-0.75117001]
curr_Stock_Price:  98.78451661114063
curr_Factors:  [98.78451661 -1.4502581  -1.14399305]
mat_Sqrt:  [[ 7.37938077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297047 -0.01157995  0.19840045]
Stock Position:  -0.0029704667951449422
Bond Position:  [-0.45773389]


portfolio before change:  [-0.75049789]
curr_Stock_Price:  98.53898362546525
curr_Factors:  [98.53898363 -1.59071761 -1.10590809]
mat_Sqrt:  [[ 6.6447465   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00730371  0.0079068  -0.11529697]
Stock Position:  0.00730370781186459
Bond Position:  [-1.47019783]


portfolio before change:  [-0.7482608]
curr_Stock_Price:  98.87044148328386
curr_Factors:  [98.87044148 -1.63882837 -1.09496052]
mat_Sqrt:  [[ 6.42387444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01899523 -0.0173607  -0.05782143]
Stock Position:  -0.018995225425471683
Bond Position:  [1.12980552]


portfolio before change:  [-0.7436103]
curr_Stock_Price:  98.63305194125836
curr_Factors:  [98.63305194 -1.61502353 -1.10228068]
mat_Sqrt:  [[ 6.5149674   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.13509823  0.42759157 -0.60200264]
Stock Position:  0.13509823028783294
Bond Position:  [-14.06876106]


portfolio before change:  [-0.70362624]
curr_Stock_Price:  98.94203276968818
curr_Factors:  [98.94203277 -1.31171126 -1.08597415]
mat_Sqrt:  [[ 8.99661812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.99482423e-05  7.98585755e-03 -7.52386322e-02]
Stock Position:  -5.9948242258126045e-05
Bond Position:  [-0.69769484]


portfolio before change:  [-0.70365332]
curr_Stock_Price:  97.93892669866715
curr_Factors:  [97.9389267  -1.46260666 -1.06576379]
mat_Sqrt:  [[ 7.8144426   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08437193 -0.00561203 -2.71956859]
Stock Position:  -0.08437192715691814
Bond Position:  [7.55964267]


portfolio before change:  [-0.70022997]
curr_Stock_Price:  97.90955273528171
curr_Factors:  [97.90955274 -1.37834034 -1.080958  ]
mat_Sqrt:  [[ 8.37076923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.23418658 -1.10628787  8.28375985]
Stock Position:  0.23418658221135474
Bond Position:  [-23.62933349]


portfolio before change:  [-0.566258]
curr_Stock_Price:  98.49423961838028
curr_Factors:  [98.49423962 -1.43729219 -1.09923115]
mat_Sqrt:  [[ 7.79493938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107248 -0.02072215 -0.01692374]
Stock Position:  0.0010724772547092386
Bond Position:  [-0.67189083]


portfolio before change:  [-0.56641949]
curr_Stock_Price:  98.42197711813094
curr_Factors:  [98.42197712 -1.51730629 -1.09685069]
mat_Sqrt:  [[ 7.20739184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00899536  0.03794932 -0.2097362 ]
Stock Position:  0.008995358960060814
Bond Position:  [-1.4517605]


portfolio before change:  [-0.57061839]
curr_Stock_Price:  97.97536747304353
curr_Factors:  [97.97536747 -1.78086611 -1.08881836]
mat_Sqrt:  [[ 5.55685122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.003656    0.04055361 -0.40007597]
Stock Position:  0.003655997238485333
Bond Position:  [-0.92881606]


portfolio before change:  [-0.56965892]
curr_Stock_Price:  98.2695610240771
curr_Factors:  [98.26956102 -1.67364851 -1.06076661]
mat_Sqrt:  [[ 6.38083657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10817728 -0.58345115 -0.55423321]
Stock Position:  -0.10817727885435524
Bond Position:  [10.06087478]


portfolio before change:  [-0.55975133]
curr_Stock_Price:  98.18960054992722
curr_Factors:  [98.18960055 -1.36094586 -1.05201407]
mat_Sqrt:  [[ 8.79286314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00782514 -0.03470139  1.18361801]
Stock Position:  0.007825141674109793
Bond Position:  [-1.32809886]


portfolio before change:  [-0.5584003]
curr_Stock_Price:  98.38346975269533
curr_Factors:  [98.38346975 -1.46012698 -1.0689767 ]
mat_Sqrt:  [[ 7.84415853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0420373  0.10667103 1.33476765]
Stock Position:  0.04203730397307783
Bond Position:  [-4.69417612]


portfolio before change:  [-0.55723598]
curr_Stock_Price:  98.42512614422014
curr_Factors:  [98.42512614 -1.26606696 -1.0609104 ]
mat_Sqrt:  [[ 9.60533575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00307997 -0.01406593  0.12159744]
Stock Position:  0.003079966881255912
Bond Position:  [-0.86038211]


portfolio before change:  [-0.55399942]
curr_Stock_Price:  99.51089182822747
curr_Factors:  [99.51089183 -1.39131143 -1.05158609]
mat_Sqrt:  [[ 8.648359    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01070766 -0.01597865  0.04326418]
Stock Position:  0.010707656091340325
Bond Position:  [-1.61952782]


portfolio before change:  [-0.55340158]
curr_Stock_Price:  99.5856315619581
curr_Factors:  [99.58563156 -1.28082955 -1.09063964]
mat_Sqrt:  [[ 9.29567     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101882  0.02147559  0.04251071]
Stock Position:  -0.001018818488479962
Bond Position:  [-0.4519419]


portfolio before change:  [-0.55280505]
curr_Stock_Price:  98.94466600465903
curr_Factors:  [98.944666   -1.24895003 -1.08349384]
mat_Sqrt:  [[ 9.6033971   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00868219 -0.0104312  -0.04779267]
Stock Position:  -0.008682188593403735
Bond Position:  [0.3062512]


portfolio before change:  [-0.5531506]
curr_Stock_Price:  98.9888755130503
curr_Factors:  [98.98887551 -1.11668598 -1.08430532]
mat_Sqrt:  [[10.9574126   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00372602 -0.00602989 -0.01588392]
Stock Position:  0.003726019803208792
Bond Position:  [-0.92198511]


portfolio before change:  [-0.55529485]
curr_Stock_Price:  98.44433021388012
curr_Factors:  [98.44433021 -1.18316152 -1.07322217]
mat_Sqrt:  [[10.30993016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00699756 -0.01470306  0.75098276]
Stock Position:  0.0069975594911883595
Bond Position:  [-1.2441649]


portfolio before change:  [-0.56123185]
curr_Stock_Price:  97.61811781963746
curr_Factors:  [97.61811782 -1.08774937 -1.09269935]
mat_Sqrt:  [[11.02995104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00087296 -0.03726551  0.04849922]
Stock Position:  0.000872963346166711
Bond Position:  [-0.64644888]


portfolio before change:  [-0.56123614]
curr_Stock_Price:  97.70577119706384
curr_Factors:  [97.7057712  -0.77773536 -1.08251984]
mat_Sqrt:  [[15.20623338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00512241  0.03569225  0.53052717]
Stock Position:  -0.00512241227084314
Bond Position:  [-0.0607469]


portfolio before change:  [-0.55822148]
curr_Stock_Price:  97.11576463061154
curr_Factors:  [97.11576463 -0.45431839 -1.07304891]
mat_Sqrt:  [[21.08446298  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00290811 0.00239042 0.42293054]
Stock Position:  0.0029081064912817333
Bond Position:  [-0.84064446]


portfolio before change:  [-0.56545656]
curr_Stock_Price:  94.66399882602701
curr_Factors:  [94.66399883 -0.43103317 -1.06775465]
mat_Sqrt:  [[21.14801282  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00709645  0.03927056 -0.1407146 ]
Stock Position:  -0.007096445413647302
Bond Position:  [0.10632134]


portfolio before change:  [-0.56875587]
curr_Stock_Price:  95.13079551309312
curr_Factors:  [95.13079551 -0.43236397 -1.08343368]
mat_Sqrt:  [[20.89385489  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349952 -0.00331411 -0.11762501]
Stock Position:  0.0034995205993788698
Bond Position:  [-0.90166804]


portfolio before change:  [-0.57025887]
curr_Stock_Price:  94.73351639687397
curr_Factors:  [94.7335164  -0.61407416 -1.08308151]
mat_Sqrt:  [[17.35554728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027338 -0.00061978 -0.15376345]
Stock Position:  -0.00027337971013197956
Bond Position:  [-0.54436065]


portfolio before change:  [-0.5703775]
curr_Stock_Price:  94.91853832971424
curr_Factors:  [94.91853833 -0.47170482 -1.07396832]
mat_Sqrt:  [[20.23362651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0031373  0.01809816 0.28976883]
Stock Position:  0.0031372998551269828
Bond Position:  [-0.86816541]


portfolio before change:  [-0.56747295]
curr_Stock_Price:  95.87894235338868
curr_Factors:  [95.87894235 -0.44239774 -1.08524349]
mat_Sqrt:  [[20.81023948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.09847249e-05 -1.36844743e-02 -2.79283701e-02]
Stock Position:  -6.098472489577986e-05
Bond Position:  [-0.5616258]


portfolio before change:  [-0.56745294]
curr_Stock_Price:  94.39960393284063
curr_Factors:  [94.39960393 -0.45156574 -1.09202673]
mat_Sqrt:  [[20.1649189   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00349457  0.02813557  0.09939311]
Stock Position:  -0.00349457329025239
Bond Position:  [-0.23756661]


portfolio before change:  [-0.56407627]
curr_Stock_Price:  93.4248456227666
curr_Factors:  [93.42484562 -0.91534212 -1.05474442]
mat_Sqrt:  [[13.02760777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00911168 -0.01748816 -0.16883887]
Stock Position:  -0.009111684924080722
Bond Position:  [0.28718148]


portfolio before change:  [-0.56726839]
curr_Stock_Price:  93.77911820583282
curr_Factors:  [93.77911821 -0.7614766  -1.04772411]
mat_Sqrt:  [[15.35961247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11189975 0.31411021 0.3903505 ]
Stock Position:  0.11189975064947558
Bond Position:  [-11.06112834]


portfolio before change:  [-0.73708961]
curr_Stock_Price:  92.27385576178308
curr_Factors:  [92.27385576 -0.79827848 -1.04453021]
mat_Sqrt:  [[14.61359354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00924987 -0.08292759  0.21070293]
Stock Position:  0.009249866818575125
Bond Position:  [-1.59061049]


portfolio before change:  [-0.74199428]
curr_Stock_Price:  91.76511061433857
curr_Factors:  [91.76511061 -0.72894514 -1.04820319]
mat_Sqrt:  [[15.51929114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00163001 -0.00501881  0.0029673 ]
Stock Position:  0.0016300056944696746
Bond Position:  [-0.89157193]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.74239551]
Stock Price:  91.5873309657259
PL:  [-0.74239551]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.01813038e-02 -1.00442235e-01  1.32164238e-02]
 [ 1.13239640e+00  2.39027294e-01  3.28856194e-01]
 [-4.16737412e-01 -2.97127788e-01  4.19522591e-02]
 [ 2.14243008e-01  1.68282045e+00  1.38507435e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 1.18588229e-02  6.10470227e-02  1.42885206e-03]
 [-1.14593808e-01  1.74206025e-01  5.10683487e-02]
 [-6.34330807e-02  1.25943358e-01  6.51462416e-04]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-7.40747729e-02 -3.34035873e-02  2.42399780e-03]
 [ 7.57723965e-01  1.52575078e+00 -2.47083029e-01]
 [-7.80551349e-04  1.97635759e-02  5.34498474e-02]
 [-3.58159003e-01 -1.36832939e-03 -7.78702854e-01]
 [ 1.82981242e+00 -3.16629386e+00  2.67014635e+00]
 [-3.41175075e-03 -9.35146757e-02  3.65670208e-02]
 [ 1.28404637e-01 -1.50635410e-02 -2.51623345e-02]
 [-5.66389762e-02  5.09108324e-04 -6.64744540e-02]
 [-2.85771702e-01 -1.83840648e+00 -1.96765643e-01]
 [ 8.01741691e-03 -2.94989898e-02  1.66754737e-01]
 [ 1.72798503e-01  3.79962175e-02  3.73856664e-01]
 [ 3.94694591e-02 -4.53172578e-02  9.90641202e-02]
 [ 1.21819286e-01 -5.14822118e-02 -7.63315302e-03]
 [ 2.18099881e-01  1.09868372e-01  1.37132480e-01]
 [-1.52223305e-01  1.31385519e-02  5.24903996e-02]
 [ 1.17273016e-02 -9.17761613e-02  2.56032845e-02]
 [ 3.46340364e-02 -1.31492317e-02  2.01403407e-01]
 [ 2.81255169e-01 -9.46658121e-02  1.16295098e-01]
 [-1.44102821e-02 -5.94069013e-02  2.44574187e-02]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 6.54292761e-02  4.44228991e-03  5.95903846e-02]
 [-1.66374186e-02 -1.59318584e-02 -6.68022841e-02]
 [-4.16672501e-02  2.35324468e-02 -4.85885709e-02]
 [-6.88948323e-02 -4.42577707e-02  3.25816851e-02]
 [ 2.31761801e-01  1.68917739e-02  4.63970395e-02]
 [-8.73219805e-02 -3.23646586e-02  6.67273262e-02]
 [-1.16230443e-01 -6.64622085e-02 -8.01632896e-02]
 [ 1.84663827e+00  1.20194716e+00  1.51981173e-01]
 [-9.07957211e-03 -1.25562515e-01 -3.73929455e-02]
 [ 3.32380435e-02 -1.41531379e-02 -7.43641785e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.05706612]
curr_Stock_Price:  99.67921899017439
curr_Factors:  [99.67921899 -1.0496163  -0.97576413]
mat_Sqrt:  [[13.15203876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057965 -0.03241759  0.03770278]
Stock Position:  -0.0005796508476065167
Bond Position:  [0.11484526]


portfolio before change:  [0.05672124]
curr_Stock_Price:  100.29895110219876
curr_Factors:  [100.2989511   -1.02793606  -0.96986785]
mat_Sqrt:  [[13.60382934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09176204 0.07714573 0.93813518]
Stock Position:  0.09176204027706161
Bond Position:  [-9.14691515]


portfolio before change:  [-0.10775343]
curr_Stock_Price:  98.51900774204294
curr_Factors:  [98.51900774 -1.11682465 -0.96013277]
mat_Sqrt:  [[12.34550564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03797535 -0.09589758  0.11967812]
Stock Position:  -0.03797535009607399
Bond Position:  [3.63354038]


portfolio before change:  [-0.12820039]
curr_Stock_Price:  99.06939585650565
curr_Factors:  [99.06939586 -1.3105664  -0.97493721]
mat_Sqrt:  [[10.07761831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0834001  0.54312796 3.95123158]
Stock Position:  0.08340010348437343
Bond Position:  [-8.39059825]


portfolio before change:  [-0.13246145]
curr_Stock_Price:  99.03088065806328
curr_Factors:  [99.03088066 -1.3207247  -0.97435251]
mat_Sqrt:  [[ 9.97771904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0058777  -0.01106097 -0.05874131]
Stock Position:  -0.005877696163677653
Bond Position:  [0.44961198]


portfolio before change:  [-0.13310514]
curr_Stock_Price:  99.14995701920954
curr_Factors:  [99.14995702 -1.25322379 -0.96534555]
mat_Sqrt:  [[10.78400564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00228224 0.01970284 0.00407612]
Stock Position:  0.0022822370687607756
Bond Position:  [-0.35938884]


portfolio before change:  [-0.13391539]
curr_Stock_Price:  98.81461706998698
curr_Factors:  [98.81461707 -1.04565074 -0.97899377]
mat_Sqrt:  [[13.04755857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00525844  0.05622475  0.14568378]
Stock Position:  -0.0052584449946718285
Bond Position:  [0.38569584]


portfolio before change:  [-0.13129762]
curr_Stock_Price:  98.32596434378638
curr_Factors:  [98.32596434 -1.17044527 -0.97221944]
mat_Sqrt:  [[11.5377402   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325818  0.04064804  0.00185844]
Stock Position:  -0.003258178863443139
Bond Position:  [0.18906596]


portfolio before change:  [-0.13068968]
curr_Stock_Price:  98.14663028626367
curr_Factors:  [98.14663029 -1.12464324 -0.97552273]
mat_Sqrt:  [[12.01669121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00432658  0.0064198  -0.11330016]
Stock Position:  0.00432658228591543
Bond Position:  [-0.55532916]


portfolio before change:  [-0.13066676]
curr_Stock_Price:  98.16797403159362
curr_Factors:  [98.16797403 -1.19164249 -0.9958844 ]
mat_Sqrt:  [[11.01384516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00729976 -0.01078096  0.00691499]
Stock Position:  -0.007299762608628185
Bond Position:  [0.58593615]


portfolio before change:  [-0.13232207]
curr_Stock_Price:  98.40477090543611
curr_Factors:  [98.40477091 -1.11355907 -0.99412392]
mat_Sqrt:  [[11.9580692   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08519192  0.49243395 -0.70485911]
Stock Position:  0.08519192441838261
Bond Position:  [-8.51561388]


portfolio before change:  [-0.10314181]
curr_Stock_Price:  98.75979023491065
curr_Factors:  [98.75979023 -0.84472387 -0.99508049]
mat_Sqrt:  [[15.68784467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00090287 0.00637867 0.15247754]
Stock Position:  0.0009028694764952007
Bond Position:  [-0.19230901]


portfolio before change:  [-0.10308169]
curr_Stock_Price:  98.85300491759169
curr_Factors:  [98.85300492 -0.80394857 -0.95169604]
mat_Sqrt:  [[17.08138599  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.02897181e-02 -4.41626411e-04 -2.22142249e+00]
Stock Position:  -0.030289718138116893
Bond Position:  [2.89114797]


portfolio before change:  [-0.11935635]
curr_Stock_Price:  99.40223664643158
curr_Factors:  [99.40223665 -0.87190373 -0.95449423]
mat_Sqrt:  [[16.00300721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10801324 -1.02191695  7.61718432]
Stock Position:  0.10801324474403957
Bond Position:  [-10.85611446]


portfolio before change:  [0.05590162]
curr_Stock_Price:  101.037360808873
curr_Factors:  [101.03736081  -0.91872417  -0.99156971]
mat_Sqrt:  [[14.95725522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00100527 -0.03018173  0.10431553]
Stock Position:  -0.0010052741561125745
Bond Position:  [0.15747187]


portfolio before change:  [0.05650745]
curr_Stock_Price:  100.45429020710833
curr_Factors:  [100.45429021  -0.83384551  -0.99506966]
mat_Sqrt:  [[16.13172182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00745076 -0.00486174 -0.07178114]
Stock Position:  0.007450758547296906
Bond Position:  [-0.69195321]


portfolio before change:  [0.0532759]
curr_Stock_Price:  100.03217886425315
curr_Factors:  [100.03217886  -0.73455591  -0.98540461]
mat_Sqrt:  [[17.91308414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.91356929e-03  1.64314005e-04 -1.89633114e-01]
Stock Position:  -0.00391356928822674
Bond Position:  [0.44475876]


portfolio before change:  [0.06071666]
curr_Stock_Price:  98.14511455380418
curr_Factors:  [98.14511455 -0.75173403 -0.98230072]
mat_Sqrt:  [[17.32953718  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04046268 -0.59334314 -0.56131761]
Stock Position:  -0.04046267741105742
Bond Position:  [4.03193077]


portfolio before change:  [0.00764741]
curr_Stock_Price:  99.46913152500524
curr_Factors:  [99.46913153 -0.98383725 -0.98478019]
mat_Sqrt:  [[13.89084404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00259413 -0.00952076  0.47570485]
Stock Position:  0.00259412811596958
Bond Position:  [-0.25038826]


portfolio before change:  [0.01013727]
curr_Stock_Price:  100.4410045102444
curr_Factors:  [100.44100451  -0.94583733  -1.00312373]
mat_Sqrt:  [[14.30500501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01795649 0.01226323 1.066509  ]
Stock Position:  0.017956485878799625
Bond Position:  [-1.79343021]


portfolio before change:  [0.01399372]
curr_Stock_Price:  100.66825621986501
curr_Factors:  [100.66825622  -0.8484756   -1.01105072]
mat_Sqrt:  [[15.67871719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00321713 -0.01462608  0.28260236]
Stock Position:  0.0032171312777301304
Bond Position:  [-0.30986928]


portfolio before change:  [0.01483314]
curr_Stock_Price:  100.94122038667719
curr_Factors:  [100.94122039  -0.94924677  -0.99742562]
mat_Sqrt:  [[14.40918684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00761684 -0.01661581 -0.02177526]
Stock Position:  0.0076168359629719936
Bond Position:  [-0.75401957]


portfolio before change:  [0.01469213]
curr_Stock_Price:  100.93508164853931
curr_Factors:  [100.93508165  -0.66171444  -1.00666737]
mat_Sqrt:  [[19.03150464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01410917 0.03545986 0.3912008 ]
Stock Position:  0.014109169179758513
Bond Position:  [-1.40941802]


portfolio before change:  [0.01878135]
curr_Stock_Price:  101.23739665981365
curr_Factors:  [101.23739666  -0.95236632  -0.99847384]
mat_Sqrt:  [[14.39136044  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00964654  0.00424045  0.1497405 ]
Stock Position:  -0.009646541190018397
Bond Position:  [0.99537207]


portfolio before change:  [0.02590301]
curr_Stock_Price:  100.51203494734185
curr_Factors:  [100.51203495  -1.03818371  -1.00132536]
mat_Sqrt:  [[13.07586808  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00013614 -0.02962063  0.07303904]
Stock Position:  -0.00013614242270986636
Bond Position:  [0.03958697]


portfolio before change:  [0.02591901]
curr_Stock_Price:  100.43089775382853
curr_Factors:  [100.43089775  -1.04712493  -0.99952161]
mat_Sqrt:  [[12.97239145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00563206 -0.0042439   0.57454786]
Stock Position:  0.005632057847884404
Bond Position:  [-0.53971362]


portfolio before change:  [0.02569918]
curr_Stock_Price:  100.4038447435589
curr_Factors:  [100.40384474  -1.02725343  -1.02073283]
mat_Sqrt:  [[12.95153412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02205686 -0.03055326  0.33175754]
Stock Position:  0.022056864117270873
Bond Position:  [-2.18889478]


portfolio before change:  [0.03406365]
curr_Stock_Price:  100.79547334659847
curr_Factors:  [100.79547335  -1.0218168   -1.03089021]
mat_Sqrt:  [[12.94081708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166483 -0.01917349  0.06977021]
Stock Position:  -0.0016648342426534087
Bond Position:  [0.2018714]


portfolio before change:  [0.03342573]
curr_Stock_Price:  101.19380492603253
curr_Factors:  [101.19380493  -1.2639524   -1.04080031]
mat_Sqrt:  [[10.09746929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218857 -0.02321455 -0.0028026 ]
Stock Position:  -0.0021885713923586922
Bond Position:  [0.25489559]


portfolio before change:  [0.03428092]
curr_Stock_Price:  100.817608721221
curr_Factors:  [100.81760872  -1.26696882  -1.0286146 ]
mat_Sqrt:  [[10.15259779  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.007732   0.00143374 0.16999478]
Stock Position:  0.007732000485431979
Bond Position:  [-0.74524088]


portfolio before change:  [0.03528429]
curr_Stock_Price:  100.95942551014402
curr_Factors:  [100.95942551  -1.30384422  -1.02561951]
mat_Sqrt:  [[ 9.82819179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00341115 -0.00514199 -0.19056832]
Stock Position:  -0.0034111518611930442
Bond Position:  [0.37967222]


portfolio before change:  [0.03620399]
curr_Stock_Price:  100.70372343239112
curr_Factors:  [100.70372343  -1.23285337  -1.04008209]
mat_Sqrt:  [[10.37342578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00450977  0.00759506 -0.13860967]
Stock Position:  -0.0045097743977774276
Bond Position:  [0.49035506]


portfolio before change:  [0.03614367]
curr_Stock_Price:  100.73069156923192
curr_Factors:  [100.73069157  -1.36875331  -1.03777975]
mat_Sqrt:  [[ 9.07857712  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00785125 -0.01428413  0.09294648]
Stock Position:  -0.007851252717828798
Bond Position:  [0.82700578]


portfolio before change:  [0.04117505]
curr_Stock_Price:  100.10302049360133
curr_Factors:  [100.10302049  -1.44705159  -1.02646969]
mat_Sqrt:  [[ 8.43743694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0289994  0.0054518  0.13235784]
Stock Position:  0.028999396104524722
Bond Position:  [-2.86175209]


portfolio before change:  [0.02536561]
curr_Stock_Price:  99.57019198355886
curr_Factors:  [99.57019198 -1.56417133 -1.01226113]
mat_Sqrt:  [[ 7.57179668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01060617 -0.01044565  0.19035449]
Stock Position:  -0.010606165719100573
Bond Position:  [1.08142356]


portfolio before change:  [0.02704597]
curr_Stock_Price:  99.42450554805855
curr_Factors:  [99.42450555 -1.64052545 -1.03535307]
mat_Sqrt:  [[ 6.84501127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02135281 -0.02145059 -0.22868355]
Stock Position:  -0.021352813332043034
Bond Position:  [2.15003888]


portfolio before change:  [0.01956824]
curr_Stock_Price:  99.78729144037979
curr_Factors:  [99.78729144 -1.5769111  -1.05943023]
mat_Sqrt:  [[ 7.14704872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.29704677 0.38792678 0.43355998]
Stock Position:  0.2970467698194322
Bond Position:  [-29.62192435]


portfolio before change:  [-0.16899548]
curr_Stock_Price:  99.16496268772048
curr_Factors:  [99.16496269 -1.25311917 -1.04323121]
mat_Sqrt:  [[ 9.97851598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00424339 -0.04052513 -0.10667167]
Stock Position:  -0.004243388131368162
Bond Position:  [0.25179995]


portfolio before change:  [-0.16779363]
curr_Stock_Price:  98.88915134361778
curr_Factors:  [98.88915134 -1.18319292 -1.06577824]
mat_Sqrt:  [[10.43356889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00145391 -0.00456791 -0.2121403 ]
Stock Position:  0.001453914962782344
Bond Position:  [-0.31157004]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.16881459]
Stock Price:  98.21372070416612
PL:  [-0.16881459]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-3.55426259e-02 -5.44313875e-02  2.57890826e-01]
 [ 2.55926178e-01  1.96770705e-01  5.47254733e-02]
 [-6.17883497e-01 -5.03807848e-01  4.55640537e-02]
 [ 3.13934746e-01  1.65707072e+00  1.88206429e+00]
 [-1.01315729e-01  2.18111950e-01  2.30658411e-01]
 [-8.54422501e-02  6.46509297e-01 -3.41780040e-01]
 [-2.63746104e-01  2.60845161e-01  7.06105726e-01]
 [-5.24667105e-03  1.85722676e-03  5.01786321e-02]
 [ 4.96400142e-02  1.46523138e-03 -3.30843704e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 4.81515777e-01  1.33982509e+00 -6.57557575e-02]
 [-2.50793864e-03 -1.15095555e-01  3.32540622e-01]
 [-4.88156251e-01 -7.48561842e-02 -1.21879237e+00]
 [ 2.11564159e+00 -3.10807952e+00  2.64745692e+00]
 [ 1.77706448e-02 -4.26932330e-02 -1.28546069e-02]
 [ 2.44772814e-02  2.19445645e-01 -1.24235337e-01]
 [ 3.10647778e-02 -1.53352804e-01 -1.10874149e-02]
 [-2.97571400e-01 -1.89001421e+00 -1.91134429e-01]
 [ 3.44206341e-02 -2.35465136e-01  4.47228914e-01]
 [-2.15283553e-01  5.45357713e-01  3.45656298e-01]
 [ 1.85014333e-02  8.59254063e-02 -4.98139335e-02]
 [ 1.25579366e-01 -5.29930756e-02  6.77506539e-02]
 [-1.42202924e-02 -1.07347036e-01 -1.06454545e-01]
 [-2.67200784e-01  9.68442785e-02  1.86196888e-02]
 [ 1.02061087e-01 -4.18610090e-03 -3.63581191e-02]
 [-1.78887787e-02 -5.35610013e-02  2.03236254e-01]
 [-1.62156723e-01 -1.46142629e-01 -5.51932044e-02]
 [-9.88108720e-02  1.36491750e-02  1.06082247e-01]
 [ 1.58493219e-01  7.98687239e-02  1.45907088e-01]
 [-1.63724508e-01  1.22209488e-01 -4.33461660e-02]
 [ 7.83147555e-02 -1.27112790e-02 -4.89310410e-02]
 [-1.71063677e-02 -1.84874541e-03 -4.74488939e-02]
 [-5.51741341e-02  1.88689701e-02  7.72187087e-02]
 [ 7.71567154e-03 -4.70021603e-02 -1.24250275e-02]
 [-8.50656896e-02  2.77825828e-02  5.78423030e-02]
 [-1.06090331e-01 -5.99699550e-02 -6.92704511e-02]
 [ 1.47156021e+00  9.63404013e-01  1.36627530e-01]
 [ 7.87335894e-02 -1.21011503e-01  4.34095998e-02]
 [ 3.15283175e-02 -1.48618871e-02 -4.68408189e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.23247988]
curr_Stock_Price:  99.7031562333049
curr_Factors:  [99.70315623 -0.7581531  -1.00484357]
mat_Sqrt:  [[17.10208976  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.50153584e-04 -1.75676548e-02  7.35690743e-01]
Stock Position:  0.00035015358397943146
Bond Position:  [0.19756847]


portfolio before change:  [0.23215591]
curr_Stock_Price:  98.70738158929211
curr_Factors:  [98.70738159 -0.60307889 -1.00945473]
mat_Sqrt:  [[19.68045695  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01561258 0.06350747 0.15611654]
Stock Position:  0.015612575509444412
Bond Position:  [-1.30892054]


portfolio before change:  [0.20422628]
curr_Stock_Price:  96.92894352039244
curr_Factors:  [96.92894352 -0.43864664 -0.99793635]
mat_Sqrt:  [[23.04376382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03087265 -0.16260328  0.12998156]
Stock Position:  -0.03087265282049999
Bond Position:  [3.1966799]


portfolio before change:  [0.20149246]
curr_Stock_Price:  97.03043881710964
curr_Factors:  [97.03043882 -0.34505492 -1.01179971]
mat_Sqrt:  [[24.98236309  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04148357 0.53481728 5.36900556]
Stock Position:  0.041483571899904814
Bond Position:  [-3.82367672]


portfolio before change:  [0.14413456]
curr_Stock_Price:  95.659295721879
curr_Factors:  [95.65929572 -0.34078488 -1.02792145]
mat_Sqrt:  [[24.3391594   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.98981011e-04  7.03953292e-02  6.58004243e-01]
Stock Position:  -0.00039898101092355283
Bond Position:  [0.1823008]


portfolio before change:  [0.1441463]
curr_Stock_Price:  95.6869987826285
curr_Factors:  [95.68699878 -0.33230769 -1.03340912]
mat_Sqrt:  [[24.4191004   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.51699715e-04  2.08659978e-01 -9.75003320e-01]
Stock Position:  -0.0009516997153375783
Bond Position:  [0.23521159]


portfolio before change:  [0.14546735]
curr_Stock_Price:  94.3297905357635
curr_Factors:  [94.32979054 -0.55611664 -1.0420612 ]
mat_Sqrt:  [[19.07959065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347849  0.08418741  2.01432309]
Stock Position:  -0.0034784855766363484
Bond Position:  [0.47359217]


portfolio before change:  [0.14252788]
curr_Stock_Price:  95.19185415394193
curr_Factors:  [95.19185415 -0.64825823 -1.0429482 ]
mat_Sqrt:  [[17.5435776   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00030639 0.00059942 0.14314567]
Stock Position:  0.00030638586301113185
Bond Position:  [0.11336244]


portfolio before change:  [0.14236278]
curr_Stock_Price:  94.60674070511294
curr_Factors:  [94.60674071 -0.63909134 -1.02850361]
mat_Sqrt:  [[17.85232548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00241906  0.0004729  -0.0943805 ]
Stock Position:  0.0024190565256496607
Bond Position:  [-0.08649627]


portfolio before change:  [0.14297171]
curr_Stock_Price:  94.86293340136707
curr_Factors:  [94.8629334  -0.58089803 -1.03418506]
mat_Sqrt:  [[18.86578478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.63309243e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  4.633092433713836e-05
Bond Position:  [0.13857663]


portfolio before change:  [0.14292419]
curr_Stock_Price:  93.46335617951294
curr_Factors:  [93.46335618 -0.39451499 -1.01696536]
mat_Sqrt:  [[22.78469645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03254746  0.43242669 -0.18758287]
Stock Position:  0.032547464118853495
Bond Position:  [-2.89907104]


portfolio before change:  [0.15627223]
curr_Stock_Price:  93.88460071613586
curr_Factors:  [93.88460072 -0.53955679 -0.9963359 ]
mat_Sqrt:  [[20.2099223   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00207214 -0.03714693  0.94864583]
Stock Position:  0.0020721430365897844
Bond Position:  [-0.03827009]


portfolio before change:  [0.15825817]
curr_Stock_Price:  94.84530800989536
curr_Factors:  [94.84530801 -0.69044854 -0.98317447]
mat_Sqrt:  [[17.78978151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04228389 -0.02415973 -3.47687537]
Stock Position:  -0.04228388946947251
Bond Position:  [4.16868669]


portfolio before change:  [0.15081114]
curr_Stock_Price:  95.03375202750236
curr_Factors:  [95.03375203 -0.76603364 -0.9861844 ]
mat_Sqrt:  [[16.47780081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12268733 -1.00312835  7.55245767]
Stock Position:  0.12268733043416022
Bond Position:  [-11.5086262]


portfolio before change:  [0.3717205]
curr_Stock_Price:  96.84606654230504
curr_Factors:  [96.84606654 -1.03300044 -0.97855523]
mat_Sqrt:  [[12.95610503  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00049644 -0.01377918 -0.03667062]
Stock Position:  0.000496444684541921
Bond Position:  [0.32364179]


portfolio before change:  [0.37183253]
curr_Stock_Price:  96.99023805222009
curr_Factors:  [96.99023805 -0.91526346 -0.98444855]
mat_Sqrt:  [[14.51087433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00302614  0.07082578 -0.35440884]
Stock Position:  0.003026144609146368
Bond Position:  [0.07832605]


portfolio before change:  [0.36992783]
curr_Stock_Price:  96.3575853305777
curr_Factors:  [96.35758533 -1.15551015 -0.9847933 ]
mat_Sqrt:  [[11.33349686  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00022071 -0.0494944  -0.03162931]
Stock Position:  -0.00022071221905811613
Bond Position:  [0.39119512]


portfolio before change:  [0.37027639]
curr_Stock_Price:  94.9998622184026
curr_Factors:  [94.99986222 -1.2701786  -0.97030313]
mat_Sqrt:  [[10.10867237  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07146182 -0.60999946 -0.54525332]
Stock Position:  -0.07146181624599068
Bond Position:  [7.15913909]


portfolio before change:  [0.38691627]
curr_Stock_Price:  94.77953579564426
curr_Factors:  [94.7795358  -1.40834134 -0.9809403 ]
mat_Sqrt:  [[ 8.69085976  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0089343  -0.07599605  1.27581961]
Stock Position:  0.008934298382641119
Bond Position:  [-0.45987239]


portfolio before change:  [0.38532537]
curr_Stock_Price:  94.607903415548
curr_Factors:  [94.60790342 -1.15763374 -0.95990125]
mat_Sqrt:  [[11.38396781  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293448  0.17601344  0.98606121]
Stock Position:  -0.0029344847172953
Bond Position:  [0.66295081]


portfolio before change:  [0.38498076]
curr_Stock_Price:  94.75357915984664
curr_Factors:  [94.75357916 -1.00755655 -0.97547049]
mat_Sqrt:  [[13.04301295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00198364  0.02773231 -0.14210529]
Stock Position:  0.001983641118062739
Bond Position:  [0.19702366]


portfolio before change:  [0.38601115]
curr_Stock_Price:  95.26061024734113
curr_Factors:  [95.26061025 -1.06374566 -0.96343061]
mat_Sqrt:  [[12.54647977  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01024923 -0.01710344  0.19327376]
Stock Position:  0.010249228969821349
Bond Position:  [-0.59033665]


portfolio before change:  [0.38166811]
curr_Stock_Price:  94.84406665021899
curr_Factors:  [94.84406665 -1.06623362 -0.95043359]
mat_Sqrt:  [[12.62358552  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00458367 -0.03464611 -0.30368519]
Stock Position:  -0.004583670576906309
Bond Position:  [0.81640206]


portfolio before change:  [0.38115996]
curr_Stock_Price:  94.97719248120693
curr_Factors:  [94.97719248 -1.201618   -0.94557197]
mat_Sqrt:  [[11.09447025  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02195975  0.03125636  0.05311679]
Stock Position:  -0.021959750689080883
Bond Position:  [2.46683543]


portfolio before change:  [0.38060452]
curr_Stock_Price:  95.01652845881722
curr_Factors:  [95.01652846 -1.01609289 -0.95682293]
mat_Sqrt:  [[13.21212598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00709841 -0.00135106 -0.10371959]
Stock Position:  0.007098405857638658
Bond Position:  [-0.29386136]


portfolio before change:  [0.38214391]
curr_Stock_Price:  95.23856736678466
curr_Factors:  [95.23856737 -1.18378104 -0.98970444]
mat_Sqrt:  [[10.83627709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00116863 -0.01728674  0.57977646]
Stock Position:  0.0011686259144021657
Bond Position:  [0.27084565]


portfolio before change:  [0.38300899]
curr_Stock_Price:  95.94985026516372
curr_Factors:  [95.94985027 -0.99148577 -1.00271607]
mat_Sqrt:  [[13.06091017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01556203 -0.04716733 -0.15745085]
Stock Position:  -0.01556202634877543
Bond Position:  [1.87618309]


portfolio before change:  [0.3946027]
curr_Stock_Price:  95.21992166648434
curr_Factors:  [95.21992167 -1.21780528 -1.01644911]
mat_Sqrt:  [[10.1953812   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00729456  0.00440525  0.30262312]
Stock Position:  -0.007294557839356392
Bond Position:  [1.08918992]


portfolio before change:  [0.39838937]
curr_Stock_Price:  94.71947756959246
curr_Factors:  [94.71947757 -1.2804542  -1.0126659 ]
mat_Sqrt:  [[ 9.56202524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.021395   0.02577752 0.41623231]
Stock Position:  0.02139499825472915
Bond Position:  [-1.62813368]


portfolio before change:  [0.40539687]
curr_Stock_Price:  95.056520090591
curr_Factors:  [95.05652009 -1.08394914 -1.03847403]
mat_Sqrt:  [[11.38217444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01296998  0.03944294 -0.12365455]
Stock Position:  -0.012969982167622891
Bond Position:  [1.63827824]


portfolio before change:  [0.39999034]
curr_Stock_Price:  95.4891595618759
curr_Factors:  [95.48915956 -0.98891156 -1.06442908]
mat_Sqrt:  [[12.25179047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0053651  -0.00410255 -0.13958664]
Stock Position:  0.005365099065208903
Bond Position:  [-0.11231846]


portfolio before change:  [0.39778033]
curr_Stock_Price:  95.07985334294956
curr_Factors:  [95.07985334 -1.05684281 -1.04192098]
mat_Sqrt:  [[11.65754151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233061 -0.00059668 -0.13535849]
Stock Position:  -0.0023306120063682654
Bond Position:  [0.61937458]


portfolio before change:  [0.39534895]
curr_Stock_Price:  96.15631361448051
curr_Factors:  [96.15631361 -1.28918099 -1.06331164]
mat_Sqrt:  [[ 9.14751722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00388743  0.00608993  0.22028348]
Stock Position:  -0.0038874284684729393
Bond Position:  [0.76914974]


portfolio before change:  [0.39705054]
curr_Stock_Price:  95.74332954830653
curr_Factors:  [95.74332955 -1.33612448 -1.03510723]
mat_Sqrt:  [[ 8.93913881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049388 -0.01516988 -0.03544514]
Stock Position:  -0.0004938789364860735
Bond Position:  [0.44433616]


portfolio before change:  [0.39722501]
curr_Stock_Price:  95.50253152297404
curr_Factors:  [95.50253152 -1.29822882 -1.04942168]
mat_Sqrt:  [[ 9.12942078  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00740327  0.00896679  0.16500799]
Stock Position:  -0.007403271751914166
Bond Position:  [1.10425621]


portfolio before change:  [0.39510312]
curr_Stock_Price:  95.8077927201009
curr_Factors:  [95.80779272 -1.34062436 -1.06401193]
mat_Sqrt:  [[ 8.65128388  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01531234 -0.01935522 -0.19760932]
Stock Position:  -0.015312342078273767
Bond Position:  [1.86214482]


portfolio before change:  [0.39775241]
curr_Stock_Price:  95.64997856792479
curr_Factors:  [95.64997857 -1.13111735 -1.08197296]
mat_Sqrt:  [[10.46048852  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.16214379 0.31093731 0.38976031]
Stock Position:  0.16214378565925197
Bond Position:  [-15.11129722]


portfolio before change:  [0.36659367]
curr_Stock_Price:  95.46946157548739
curr_Factors:  [95.46946158 -1.06888937 -1.09494973]
mat_Sqrt:  [[10.96783964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00573433 -0.03905629  0.12383551]
Stock Position:  0.005734325933838997
Bond Position:  [-0.18085934]


portfolio before change:  [0.37018434]
curr_Stock_Price:  96.09957534367153
curr_Factors:  [96.09957534 -1.15144051 -1.1043079 ]
mat_Sqrt:  [[10.07076314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00188003 -0.00479665 -0.13362382]
Stock Position:  0.0018800268777900357
Bond Position:  [0.18951455]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.37082783]
Stock Price:  96.42925246933179
PL:  [0.37082783]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-2.19118781e-02 -9.02659178e-02  1.62886291e-01]
 [ 9.23521526e-01  2.16793131e-01  2.56429774e-01]
 [-1.43756204e-01 -4.58542228e-02  3.39897864e-02]
 [ 1.26886390e-01  1.00960323e+00  8.18111377e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 3.75519729e-02 -7.18635257e-02  5.16154494e-02]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [ 2.38595327e-02  1.97978799e-01 -3.56786741e-02]
 [ 8.76438198e-03  7.10487763e-02 -4.74886855e-02]
 [-1.34370369e-01 -7.08445355e-02 -3.92525414e-02]
 [ 7.70916104e-01  1.49352240e+00 -2.66100458e-01]
 [-3.64909195e-05  1.79360965e-02 -5.81829793e-02]
 [-2.15364846e-01  4.95093389e-04 -4.15534252e-01]
 [ 1.68535409e+00 -3.16453529e+00  2.65619720e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.38089224e-01 -4.07676176e-02 -8.40915317e-03]
 [-1.36955477e-01 -1.73265019e-01 -3.74616299e-02]
 [-2.69474682e-01 -1.76097332e+00 -2.02319498e-01]
 [-1.02144781e-02  4.02559557e-02  1.92815873e-01]
 [ 2.43392700e-01 -1.14716039e-01  4.07467925e-01]
 [ 4.99826116e-02 -8.94385264e-02  7.02215931e-02]
 [ 1.38917760e-01 -5.33758923e-02 -1.39416269e-02]
 [ 2.30200947e-01  1.59894781e-01  1.78863924e-01]
 [-2.62391050e-01  9.47254121e-02  2.17883112e-02]
 [-6.02996587e-02 -2.17501352e-01  8.18044146e-02]
 [ 9.57634779e-02 -2.03783223e-02 -5.15830071e-02]
 [ 4.59295629e-01 -5.82203839e-02  2.54600955e-01]
 [-5.91021473e-02  6.05512506e-02  1.05952326e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 3.50385815e-01 -1.27279911e-01 -5.79514600e-02]
 [-3.44118060e-02 -8.71709525e-02 -1.55257649e-02]
 [ 5.67147356e-02  1.88669768e-02 -6.41295371e-02]
 [-5.10519091e-02 -5.72567457e-02  1.37676635e-02]
 [ 4.58186346e-01  7.30638541e-02  1.12396276e-01]
 [ 1.50917957e-01 -1.09920976e-02 -5.01989018e-02]
 [-9.11335160e-02 -2.40543331e-02 -1.08228130e-01]
 [ 1.26686164e+00  8.97661073e-01  1.40812906e-01]
 [-3.86850067e-02  9.91022852e-03 -1.55863987e-02]
 [ 3.77418165e-02 -1.28091881e-02 -1.67307305e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.76010143]
curr_Stock_Price:  99.15832220097107
curr_Factors:  [99.1583222  -0.92069711 -0.98565244]
mat_Sqrt:  [[14.73710176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048098 -0.0291332   0.46466925]
Stock Position:  -0.00048098374932118544
Bond Position:  [-3.71240789]


portfolio before change:  [-3.76093488]
curr_Stock_Price:  99.92626864373173
curr_Factors:  [99.92626864 -0.91692827 -1.01088077]
mat_Sqrt:  [[14.5359307   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07017905 0.06996968 0.73152277]
Stock Position:  0.07017904586754722
Bond Position:  [-10.77366507]


portfolio before change:  [-3.6978128]
curr_Stock_Price:  100.84490286982106
curr_Factors:  [100.84490287  -1.18639067  -1.01970514]
mat_Sqrt:  [[11.10602679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01316204 -0.01479939  0.0969634 ]
Stock Position:  -0.013162044822664882
Bond Position:  [-2.37048767]


portfolio before change:  [-3.69768607]
curr_Stock_Price:  100.81276065288294
curr_Factors:  [100.81276065  -0.98469648  -1.04217175]
mat_Sqrt:  [[13.28182704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03764294 0.32584804 2.33384404]
Stock Position:  0.03764294398420603
Bond Position:  [-7.49257518]


portfolio before change:  [-3.70916349]
curr_Stock_Price:  100.53274039672117
curr_Factors:  [100.5327404   -1.15260736  -1.04334144]
mat_Sqrt:  [[11.18456447  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524348 -0.01106097 -0.05874131]
Stock Position:  -0.005243476495458476
Bond Position:  [-3.18202243]


portfolio before change:  [-3.70925043]
curr_Stock_Price:  100.47346046229148
curr_Factors:  [100.47346046  -1.0890026   -1.05649065]
mat_Sqrt:  [[11.75643051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0028426  -0.02319385  0.14724451]
Stock Position:  0.0028426018929373882
Bond Position:  [-3.99485648]


portfolio before change:  [-3.70938278]
curr_Stock_Price:  100.60258410382662
curr_Factors:  [100.6025841   -1.07249444  -1.08397953]
mat_Sqrt:  [[11.64298642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00569358 -0.00251018 -0.21167328]
Stock Position:  -0.00569358415037955
Bond Position:  [-3.1365935]


portfolio before change:  [-3.71047984]
curr_Stock_Price:  100.72640194332494
curr_Factors:  [100.72640194  -1.01787796  -1.11099921]
mat_Sqrt:  [[11.98350087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00475561  0.06389738 -0.10178133]
Stock Position:  0.004755614207709007
Bond Position:  [-4.18949575]


portfolio before change:  [-3.70981279]
curr_Stock_Price:  100.97679486147655
curr_Factors:  [100.97679486  -0.96051576  -1.10850313]
mat_Sqrt:  [[12.75434315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00106423  0.02293089 -0.135472  ]
Stock Position:  0.0010642308439927828
Bond Position:  [-3.81727541]


portfolio before change:  [-3.70971111]
curr_Stock_Price:  101.52072353159693
curr_Factors:  [101.52072353  -0.91836283  -1.1180461 ]
mat_Sqrt:  [[13.24809844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01183897 -0.02286498 -0.11197657]
Stock Position:  -0.011838970082782514
Bond Position:  [-2.5078103]


portfolio before change:  [-3.71305606]
curr_Stock_Price:  101.77678026290407
curr_Factors:  [101.77678026  -1.058041    -1.13228869]
mat_Sqrt:  [[11.38677163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08970607  0.48203228 -0.75911054]
Stock Position:  0.08970607226826575
Bond Position:  [-12.84305126]


portfolio before change:  [-3.76891807]
curr_Stock_Price:  101.17195459075062
curr_Factors:  [101.17195459  -0.84632458  -1.1263965 ]
mat_Sqrt:  [[14.07078274  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058645  0.00578885 -0.16597984]
Stock Position:  -0.0005864529088605978
Bond Position:  [-3.70958549]


portfolio before change:  [-3.76947693]
curr_Stock_Price:  101.33416705315284
curr_Factors:  [101.33416705  -0.74806045  -1.11871763]
mat_Sqrt:  [[15.66839395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.91522093e-02  1.59790704e-04 -1.18540356e+00]
Stock Position:  -0.019152209263616708
Bond Position:  [-1.82870376]


portfolio before change:  [-3.76408343]
curr_Stock_Price:  101.0406187011034
curr_Factors:  [101.0406187   -0.81102818  -1.09802111]
mat_Sqrt:  [[14.97636529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10560573 -1.02134937  7.57739128]
Stock Position:  0.10560573161230775
Bond Position:  [-14.43455189]


portfolio before change:  [-3.70831156]
curr_Stock_Price:  101.58581927522623
curr_Factors:  [101.58581928  -0.94325289  -1.10356015]
mat_Sqrt:  [[13.11938503  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165171 -0.03053791  0.10625201]
Stock Position:  -0.0016517064500462817
Bond Position:  [-3.54052161]


portfolio before change:  [-3.70888339]
curr_Stock_Price:  101.66406065074312
curr_Factors:  [101.66406065  -0.85022867  -1.11372197]
mat_Sqrt:  [[14.26377655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00897736 -0.01315769 -0.02398897]
Stock Position:  0.008977360035973332
Bond Position:  [-4.62155826]


portfolio before change:  [-3.70404721]
curr_Stock_Price:  102.26712275026361
curr_Factors:  [102.26712275  -0.91190473  -1.13833771]
mat_Sqrt:  [[13.16215674  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01367328 -0.05592104 -0.1068676 ]
Stock Position:  -0.01367328149359828
Bond Position:  [-2.30572005]


portfolio before change:  [-3.70099896]
curr_Stock_Price:  102.02310756434422
curr_Factors:  [102.02310756  -0.97763747  -1.15780072]
mat_Sqrt:  [[12.05839552  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05558203 -0.5683517  -0.57716121]
Stock Position:  -0.05558203408689048
Bond Position:  [1.96965289]


portfolio before change:  [-3.69098009]
curr_Stock_Price:  101.84728375992619
curr_Factors:  [101.84728376  -1.04664573  -1.14369297]
mat_Sqrt:  [[11.39455693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00327886 0.01299255 0.55005002]
Stock Position:  0.0032788558602672067
Bond Position:  [-4.02492265]


portfolio before change:  [-3.69164169]
curr_Stock_Price:  101.79895735746597
curr_Factors:  [101.79895736  -1.26730491  -1.17092104]
mat_Sqrt:  [[ 8.88863869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03410538 -0.03702444  1.16239257]
Stock Position:  0.03410538321982831
Bond Position:  [-7.16353414]


portfolio before change:  [-3.69892605]
curr_Stock_Price:  101.61163040073684
curr_Factors:  [101.6116304   -1.20679219  -1.18743935]
mat_Sqrt:  [[ 9.27132649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.004968   -0.02886616  0.20032266]
Stock Position:  0.004968002318329094
Bond Position:  [-4.20373286]


portfolio before change:  [-3.69916349]
curr_Stock_Price:  101.6696129618709
curr_Factors:  [101.66961296  -0.82260238  -1.15832177]
mat_Sqrt:  [[14.02447919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00892558 -0.017227   -0.03977158]
Stock Position:  0.008925581259183517
Bond Position:  [-4.60662388]


portfolio before change:  [-3.69606399]
curr_Stock_Price:  102.08139109495235
curr_Factors:  [102.08139109  -0.76820969  -1.15436494]
mat_Sqrt:  [[14.92736056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02005376 0.05160582 0.51024899]
Stock Position:  0.02005376482933168
Bond Position:  [-5.7431802]


portfolio before change:  [-3.68360245]
curr_Stock_Price:  102.73859877316409
curr_Factors:  [102.73859877  -0.91673043  -1.1627766 ]
mat_Sqrt:  [[12.84148377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01858101  0.0305725   0.06215599]
Stock Position:  -0.01858101370754673
Bond Position:  [-1.77461513]


portfolio before change:  [-3.69252862]
curr_Stock_Price:  103.20705204999425
curr_Factors:  [103.20705205  -0.7871691   -1.18543694]
mat_Sqrt:  [[14.35547128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00612998 -0.07019826  0.23336522]
Stock Position:  -0.006129975004413858
Bond Position:  [-3.05987197]


portfolio before change:  [-3.69578464]
curr_Stock_Price:  103.67581476664438
curr_Factors:  [103.67581477  -0.93140815  -1.17464293]
mat_Sqrt:  [[12.61917874  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0064247  -0.00657708 -0.14715196]
Stock Position:  0.006424699629608472
Bond Position:  [-4.3618706]


portfolio before change:  [-3.69387322]
curr_Stock_Price:  104.05819621008972
curr_Factors:  [104.05819621  -0.85787838  -1.1989012 ]
mat_Sqrt:  [[13.3054102   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03753222 -0.01879055  0.72630566]
Stock Position:  0.03753222469267383
Bond Position:  [-7.59940882]


portfolio before change:  [-3.64211787]
curr_Stock_Price:  105.46246511648836
curr_Factors:  [105.46246512  -1.10240329  -1.2370127 ]
mat_Sqrt:  [[10.16488484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247074  0.01954283  0.3022525 ]
Stock Position:  -0.002470736000457215
Bond Position:  [-3.38154796]


portfolio before change:  [-3.64330662]
curr_Stock_Price:  105.7725064201849
curr_Factors:  [105.77250642  -0.859444    -1.25366626]
mat_Sqrt:  [[12.78382066  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268929 -0.02600141 -0.03673698]
Stock Position:  -0.0026892945876303654
Bond Position:  [-3.35885319]


portfolio before change:  [-3.64641453]
curr_Stock_Price:  106.77203787380033
curr_Factors:  [106.77203787  -0.66300641  -1.27522127]
mat_Sqrt:  [[15.37078153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0203357  -0.04107941 -0.16531938]
Stock Position:  0.020335701177466876
Bond Position:  [-5.81769879]


portfolio before change:  [-3.64732578]
curr_Stock_Price:  106.76299028066995
curr_Factors:  [106.76299028  -0.5614862   -1.27560627]
mat_Sqrt:  [[17.00519454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325634 -0.0281343  -0.04429069]
Stock Position:  -0.003256339439320125
Bond Position:  [-3.29966925]


portfolio before change:  [-3.64456859]
curr_Stock_Price:  105.78960261105397
curr_Factors:  [105.78960261  -0.43551406  -1.25151329]
mat_Sqrt:  [[19.57836027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024249   0.00608929 -0.18294372]
Stock Position:  0.0024248994017007156
Bond Position:  [-3.90109773]


portfolio before change:  [-3.64548109]
curr_Stock_Price:  105.61440302908701
curr_Factors:  [105.61440303  -0.41904629  -1.26166278]
mat_Sqrt:  [[19.66982392  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304675 -0.01847954  0.03927531]
Stock Position:  -0.003046752280659734
Bond Position:  [-3.32370017]


portfolio before change:  [-3.64326082]
curr_Stock_Price:  104.7492978596017
curr_Factors:  [104.74929786  -0.42049051  -1.25404367]
mat_Sqrt:  [[19.62954189  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02527024 0.02358126 0.32063529]
Stock Position:  0.025270240108416695
Bond Position:  [-6.29030073]


portfolio before change:  [-3.68505115]
curr_Stock_Price:  103.1266782342772
curr_Factors:  [103.12667823  -0.29738449  -1.24197612]
mat_Sqrt:  [[22.1225513   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0062573  -0.00354768 -0.14320349]
Stock Position:  0.006257298023801482
Bond Position:  [-4.33034551]


portfolio before change:  [-3.68760392]
curr_Stock_Price:  102.80522262095118
curr_Factors:  [102.80522262  -0.10957308  -1.2563307 ]
mat_Sqrt:  [[26.23074966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00450371 -0.0077635  -0.30874473]
Stock Position:  -0.004503705085557559
Bond Position:  [-3.22459951]


portfolio before change:  [-3.68512631]
curr_Stock_Price:  102.16559288826515
curr_Factors:  [ 1.02165593e+02  5.60762284e-02 -1.23338333e+00]
mat_Sqrt:  [[31.47796744  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04698014 0.28971887 0.40170003]
Stock Position:  0.0469801379742861
Bond Position:  [-8.48487996]


portfolio before change:  [-3.71445618]
curr_Stock_Price:  101.56386636979838
curr_Factors:  [101.56386637   0.20181795  -1.20637643]
mat_Sqrt:  [[37.19332657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00107126  0.00319851 -0.04446366]
Stock Position:  -0.0010712580395369322
Bond Position:  [-3.60565508]


portfolio before change:  [-3.71775831]
curr_Stock_Price:  104.22558531097383
curr_Factors:  [104.22558531   0.12650521  -1.20154762]
mat_Sqrt:  [[35.57044997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.74298288e-05 -4.13414767e-03 -4.77281171e-01]
Stock Position:  2.7429828757557933e-05
Bond Position:  [-3.7206172]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.71825562]
Stock Price:  103.05135557104012
PL:  [-6.76961119]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-1.62928540e-02 -6.00413516e-02  2.10389983e-01]
 [ 1.47304032e+00  3.25101348e-01  4.74492063e-01]
 [-1.71407533e-01 -7.13066994e-02  3.47963362e-02]
 [ 6.21331771e-02  5.02810070e-01  3.96878074e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 7.44023123e-02 -1.12794692e-04  2.23895397e-02]
 [-4.16603632e-02 -5.83135559e-02 -4.04248113e-02]
 [-4.29421248e-02  1.94584615e-01 -2.53224345e-02]
 [ 3.31984071e-02  4.46072122e-02 -4.34715358e-02]
 [-1.77492986e-01 -7.44837794e-02 -6.25086852e-02]
 [ 7.90638823e-01  1.53348142e+00 -2.72325627e-01]
 [-6.61230007e-04 -4.38509038e-03  5.48680443e-02]
 [-2.29921097e-01  6.52197356e-03 -4.87738500e-01]
 [ 1.48336160e+00 -2.83442624e+00  2.36960936e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.59453409e-01 -1.17711352e-01  3.48718738e-02]
 [-3.06794161e-01 -5.41440328e-01  2.38586693e-02]
 [-2.52375887e-01 -1.66837499e+00 -2.04044587e-01]
 [ 1.30094623e-03  3.72499194e-02  5.83893053e-02]
 [ 2.55288038e-01 -3.84387930e-01  1.80666591e-01]
 [ 5.62705730e-02  8.09217931e-02 -1.49799517e-02]
 [ 1.05969747e-01 -5.48666673e-02 -4.67413735e-02]
 [ 3.69754332e-01  1.01362711e-01  1.81316952e-01]
 [-8.98938788e-02 -3.22384204e-02  7.08517516e-02]
 [ 8.17198333e-02 -2.05908398e-02 -1.97983184e-02]
 [ 5.25853934e-02 -4.11879939e-02  2.95996435e-01]
 [-1.73805930e-01 -1.28064636e-01 -6.43606683e-02]
 [-1.55510720e-01  1.11189575e-01  2.29482493e-01]
 [ 4.38056171e-02  2.58197515e-02  1.70292908e-01]
 [-9.20802116e-02  1.01798483e-01 -2.54650882e-03]
 [ 5.72439310e-02 -1.48838193e-02 -8.12881697e-02]
 [-1.48140003e-02 -1.85565223e-03 -4.80714584e-02]
 [ 5.36462018e-02  6.60928560e-02  1.08576541e-01]
 [-1.93142645e-03 -4.27439685e-02  1.55754714e-04]
 [-9.89914766e-02  1.00634916e-01  2.81751251e-02]
 [-1.12559365e-01 -6.42596752e-02 -7.53756946e-02]
 [ 1.56254084e+00  1.01821487e+00  1.39756858e-01]
 [-6.82674672e-02  5.31608217e-02  4.54546240e-02]
 [ 3.14174642e-02 -1.48195337e-02 -4.44246346e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.63967134]
curr_Stock_Price:  100.57749182780556
curr_Factors:  [100.57749183  -0.74475311  -1.02585833]
mat_Sqrt:  [[17.12119304  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084088 -0.01937826  0.60018406]
Stock Position:  0.0008408836831748208
Bond Position:  [6.55509737]


portfolio before change:  [6.64122366]
curr_Stock_Price:  101.4490571536907
curr_Factors:  [101.44905715  -0.76096318  -1.00320449]
mat_Sqrt:  [[17.38119901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09413946 0.10492601 1.35359378]
Stock Position:  0.09413945727502344
Bond Position:  [-2.90913552]


portfolio before change:  [6.57903951]
curr_Stock_Price:  100.79236662291396
curr_Factors:  [100.79236662  -0.77059425  -0.97029864]
mat_Sqrt:  [[17.67532742  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0101192  -0.02301414  0.09926426]
Stock Position:  -0.01011920033968561
Bond Position:  [7.59897766]


portfolio before change:  [6.56467498]
curr_Stock_Price:  102.30577305982524
curr_Factors:  [102.30577306  -0.72995255  -0.98983583]
mat_Sqrt:  [[18.32337789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01341353 0.16228125 1.13218268]
Stock Position:  0.013413533905541066
Bond Position:  [5.19239302]


portfolio before change:  [6.56821015]
curr_Stock_Price:  102.52093470034826
curr_Factors:  [102.5209347   -0.71399235  -0.98652811]
mat_Sqrt:  [[18.71914044  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313294 -0.01106097 -0.05874131]
Stock Position:  -0.00313294304940674
Bond Position:  [6.8894024]


portfolio before change:  [6.56984321]
curr_Stock_Price:  102.27457444765373
curr_Factors:  [102.27457445  -0.73221099  -0.97078043]
mat_Sqrt:  [[18.62807197  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.23820211e-03 -3.64043304e-05  6.38711246e-02]
Stock Position:  0.004238202105438052
Bond Position:  [6.13638289]


portfolio before change:  [6.56768736]
curr_Stock_Price:  101.58490883724278
curr_Factors:  [101.58490884  -0.73202175  -0.98266626]
mat_Sqrt:  [[18.28730275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338023 -0.01882062 -0.11532073]
Stock Position:  -0.0033802277402597996
Bond Position:  [6.91106749]


portfolio before change:  [6.57331309]
curr_Stock_Price:  100.17619025263812
curr_Factors:  [100.17619025  -0.58087924  -0.98778875]
mat_Sqrt:  [[20.86895297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040211  0.06280191 -0.07223786]
Stock Position:  -0.0004021105854292907
Bond Position:  [6.61359499]


portfolio before change:  [6.57348378]
curr_Stock_Price:  101.80772561128802
curr_Factors:  [101.80772561  -0.51519414  -1.01745428]
mat_Sqrt:  [[21.98669681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152048  0.01439692 -0.12401219]
Stock Position:  0.0015204751481134805
Bond Position:  [6.41868766]


portfolio before change:  [6.57483141]
curr_Stock_Price:  102.16632617454857
curr_Factors:  [102.16632617  -0.5542001   -1.00548748]
mat_Sqrt:  [[21.47553877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.009567   -0.02403954 -0.17831988]
Stock Position:  -0.00956699890443596
Bond Position:  [7.55225654]


portfolio before change:  [6.57858757]
curr_Stock_Price:  101.87239236361086
curr_Factors:  [101.87239236  -0.61722543  -1.01589109]
mat_Sqrt:  [[19.89770598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05267297  0.494929   -0.77686921]
Stock Position:  0.05267296503233005
Bond Position:  [1.21266661]


portfolio before change:  [6.46796915]
curr_Stock_Price:  99.76941590855641
curr_Factors:  [99.76941591 -0.47457301 -1.01743993]
mat_Sqrt:  [[22.44008211  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00042975 -0.00141528  0.15652326]
Stock Position:  0.0004297470821353665
Bond Position:  [6.42509354]


portfolio before change:  [6.46907186]
curr_Stock_Price:  100.466380322046
curr_Factors:  [100.46638032  -0.42018899  -1.02325439]
mat_Sqrt:  [[23.72145156  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01383343  0.00210496 -1.39138218]
Stock Position:  -0.01383342871605315
Bond Position:  [7.85886637]


portfolio before change:  [6.43227995]
curr_Stock_Price:  103.19703620455353
curr_Factors:  [103.1970362   -0.38053057  -1.02394747]
mat_Sqrt:  [[25.33437294  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05480622 -0.91480713  6.75983594]
Stock Position:  0.05480622123466539
Bond Position:  [0.77644035]


portfolio before change:  [6.44653763]
curr_Stock_Price:  103.45541234848433
curr_Factors:  [103.45541235  -0.32682885  -1.0482127 ]
mat_Sqrt:  [[26.15653795  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00082845 -0.03053791  0.10625201]
Stock Position:  -0.0008284495799141293
Bond Position:  [6.53224522]


portfolio before change:  [6.44545206]
curr_Stock_Price:  105.75144231857595
curr_Factors:  [105.75144232  -0.70103383  -1.02914647]
mat_Sqrt:  [[18.74470207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00760449 -0.03799118  0.09947975]
Stock Position:  0.00760448852434897
Bond Position:  [5.64126643]


portfolio before change:  [6.45579725]
curr_Stock_Price:  107.01911325832626
curr_Factors:  [107.01911326  -0.6531982   -1.02917032]
mat_Sqrt:  [[19.89839207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02072756 -0.17474911  0.06806214]
Stock Position:  -0.020727557923587644
Bond Position:  [8.67404212]


portfolio before change:  [6.48551803]
curr_Stock_Price:  105.63754882576515
curr_Factors:  [105.63754883  -0.62601936  -1.01308517]
mat_Sqrt:  [[20.509934    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03094022 -0.53846571 -0.58208241]
Stock Position:  -0.03094022301782625
Bond Position:  [9.75396735]


portfolio before change:  [6.54470313]
curr_Stock_Price:  103.76407243222482
curr_Factors:  [103.76407243  -0.33038927  -1.00843119]
mat_Sqrt:  [[27.2022401   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0007655  0.01202236 0.16656844]
Stock Position:  0.0007654965599542426
Bond Position:  [6.46527209]


portfolio before change:  [6.54535966]
curr_Stock_Price:  103.5659174512893
curr_Factors:  [103.56591745  -0.20739975  -1.02668589]
mat_Sqrt:  [[30.14812283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00708845 -0.12406067  0.5153915 ]
Stock Position:  0.007088454392665775
Bond Position:  [5.81123737]


portfolio before change:  [6.5432355]
curr_Stock_Price:  103.16376924401322
curr_Factors:  [103.16376924  -0.1751057   -1.02015055]
mat_Sqrt:  [[31.22007975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00223353  0.0261174  -0.04273363]
Stock Position:  0.0022335271273402277
Bond Position:  [6.31281642]


portfolio before change:  [6.5435941]
curr_Stock_Price:  102.97100361711628
curr_Factors:  [102.97100362  -0.18902334  -0.99211049]
mat_Sqrt:  [[31.60494517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0026967  -0.01770814 -0.13334013]
Stock Position:  0.0026967011662240655
Bond Position:  [6.26591208]


portfolio before change:  [6.53907545]
curr_Stock_Price:  101.00491913538566
curr_Factors:  [101.00491914  -0.34118766  -1.00223852]
mat_Sqrt:  [[26.35724097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01621779 0.03271467 0.5172468 ]
Stock Position:  0.01621778537128252
Bond Position:  [4.90099935]


portfolio before change:  [6.52193734]
curr_Stock_Price:  99.9103942482288
curr_Factors:  [99.91039425 -0.28185435 -1.00895864]
mat_Sqrt:  [[27.48006247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298442 -0.01040491  0.20212033]
Stock Position:  -0.002984416997798615
Bond Position:  [6.82011162]


portfolio before change:  [6.53231914]
curr_Stock_Price:  96.71739726427788
curr_Factors:  [96.71739726 -0.25503079 -0.99353177]
mat_Sqrt:  [[27.74985838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00264778 -0.00664566 -0.05647909]
Stock Position:  0.0026477767872363674
Bond Position:  [6.27623306]


portfolio before change:  [6.53711916]
curr_Stock_Price:  98.23393085801776
curr_Factors:  [98.23393086 -0.46185289 -1.00610815]
mat_Sqrt:  [[22.63258414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00462156 -0.01329337  0.84439544]
Stock Position:  0.004621564552313548
Bond Position:  [6.08312471]


portfolio before change:  [6.53510349]
curr_Stock_Price:  97.63324553915594
curr_Factors:  [97.63324554 -0.55590638 -1.02193909]
mat_Sqrt:  [[20.15339151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01057314 -0.04133268 -0.18360307]
Stock Position:  -0.010573137544922456
Bond Position:  [7.56739323]


portfolio before change:  [6.54024021]
curr_Stock_Price:  97.23688903478791
curr_Factors:  [97.23688903 -0.36063067 -1.02656349]
mat_Sqrt:  [[24.28735871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353976  0.03588628  0.65464968]
Stock Position:  -0.0035397560555096605
Bond Position:  [6.88443508]


portfolio before change:  [6.54364326]
curr_Stock_Price:  96.51863574403261
curr_Factors:  [96.51863574 -0.45371749 -1.04872934]
mat_Sqrt:  [[21.48358763  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00390237 0.00833329 0.48579827]
Stock Position:  0.0039023717852227496
Bond Position:  [6.16699166]


portfolio before change:  [6.54955552]
curr_Stock_Price:  97.83612729556899
curr_Factors:  [97.8361273  -0.26909906 -1.07608161]
mat_Sqrt:  [[25.48559128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281808  0.03285532 -0.00726448]
Stock Position:  -0.0028180820453067574
Bond Position:  [6.82526576]


portfolio before change:  [6.55204938]
curr_Stock_Price:  97.25394175979073
curr_Factors:  [97.25394176 -0.45669319 -1.07896478]
mat_Sqrt:  [[20.94013289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00179621 -0.00480373 -0.23189252]
Stock Position:  0.0017962114260468114
Bond Position:  [6.37736074]


portfolio before change:  [6.5502678]
curr_Stock_Price:  95.81825473204555
curr_Factors:  [95.81825473 -0.40410253 -1.07887172]
mat_Sqrt:  [[21.74706856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00114983 -0.00059891 -0.13713449]
Stock Position:  -0.0011498252727793286
Bond Position:  [6.66044206]


portfolio before change:  [6.55258813]
curr_Stock_Price:  94.52438726813575
curr_Factors:  [94.52438727 -0.27961725 -1.04395419]
mat_Sqrt:  [[25.16078001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00354919 0.02133138 0.30973865]
Stock Position:  0.003549192161833688
Bond Position:  [6.21710292]


portfolio before change:  [6.55008207]
curr_Stock_Price:  93.59931815059689
curr_Factors:  [93.59931815 -0.12680556 -1.03600484]
mat_Sqrt:  [[29.25974568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036312 -0.01379556  0.00044432]
Stock Position:  -0.0003631169358306386
Bond Position:  [6.58406957]


portfolio before change:  [6.55063254]
curr_Stock_Price:  94.35002401677824
curr_Factors:  [94.35002402 -0.16685898 -1.05749069]
mat_Sqrt:  [[27.73407647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262126  0.03247978  0.08037579]
Stock Position:  -0.002621260425558939
Bond Position:  [6.79794852]


portfolio before change:  [6.54678953]
curr_Stock_Price:  96.14030984982577
curr_Factors:  [ 9.61403098e+01 -9.34526893e-02 -1.03239599e+00]
mat_Sqrt:  [[31.18571093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045233  -0.02073972 -0.21502588]
Stock Position:  -0.004523299661069261
Bond Position:  [6.98166096]


portfolio before change:  [6.555038]
curr_Stock_Price:  94.50970697305436
curr_Factors:  [ 9.45097070e+01  3.82183509e-02 -1.01441212e+00]
mat_Sqrt:  [[35.60580814  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05052296 0.32862744 0.39868742]
Stock Position:  0.05052296022827417
Bond Position:  [1.78012783]


portfolio before change:  [6.69289944]
curr_Stock_Price:  97.2339913467615
curr_Factors:  [ 9.72339913e+01  4.98480959e-02 -1.00220961e+00]
mat_Sqrt:  [[37.51567476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00128313  0.01715758  0.12966939]
Stock Position:  -0.0012831349549624835
Bond Position:  [6.81766377]


portfolio before change:  [6.695464]
curr_Stock_Price:  95.89952444115966
curr_Factors:  [ 9.58995244e+01  7.56917164e-02 -9.90772714e-01]
mat_Sqrt:  [[38.40624302  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050316 -0.00478298 -0.12673112]
Stock Position:  0.0005031551506565353
Bond Position:  [6.64721166]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.69630761]
Stock Price:  95.92467442573144
PL:  [6.69630761]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.06916721e-01  1.15351238e-03 -1.53197832e-01]
 [ 1.10316083e+00  2.26304658e-01  3.21186997e-01]
 [-2.88338185e-01 -1.78938951e-01  3.82070367e-02]
 [ 1.29425641e-01  1.14648974e+00  8.49830371e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.98391072e-02 -5.94291091e-02  5.35468577e-02]
 [-4.13798927e-02 -6.01085633e-02 -3.92251224e-02]
 [ 1.29742102e-01 -4.41428668e-02 -1.02157194e-01]
 [-1.04619045e-02  9.18547255e-02 -5.06496411e-02]
 [-3.55868512e-01 -9.02224805e-02 -1.58901031e-01]
 [ 6.73092342e-01  1.29077964e+00 -2.36369723e-01]
 [-2.05380738e-04  3.25872370e-02 -5.83474734e-02]
 [-2.25615705e-01 -1.19796424e-02 -4.88669969e-01]
 [ 1.71263002e+00 -3.31244048e+00  2.81038108e+00]
 [ 9.01069945e-03 -9.41227836e-02  3.95955330e-02]
 [ 1.15935807e-01 -7.72863864e-02  2.18990469e-02]
 [-1.50956085e-01 -1.98789643e-01 -2.63730096e-02]
 [-2.57642017e-01 -1.68304698e+00 -1.98511454e-01]
 [-2.88100470e-02  1.33134643e-01  3.22725192e-01]
 [ 3.47894109e-01 -2.48925177e-02  6.35242939e-01]
 [ 1.00747105e-01 -4.07196353e-01 -1.21694039e-01]
 [ 1.52024741e-01 -5.48473816e-02 -1.81791001e-02]
 [ 5.92118885e-02  1.63291820e-01  1.08343399e-01]
 [-7.12022573e-03 -1.45784787e-01 -6.46130974e-02]
 [-1.14818967e-02 -9.47302332e-02  3.60145612e-02]
 [ 6.18962249e-02 -1.52017226e-02  3.47133371e-03]
 [ 5.60157643e-01 -7.28792762e-02  3.02300256e-01]
 [ 9.25604494e-02 -2.23618091e-01 -1.02237664e-01]
 [-9.49612823e-03 -7.49302888e-02 -3.12501047e-03]
 [ 1.01334257e-01 -2.90279988e-02  9.16812633e-02]
 [-1.61964593e-02 -4.41826908e-02 -4.76712031e-02]
 [-2.27617909e-02  2.14469327e-02 -5.30969185e-02]
 [-1.08130981e-01 -3.43690609e-02  3.49835057e-02]
 [ 1.66053132e-01  6.72388849e-03  2.88596056e-02]
 [-1.39370420e-02 -8.82632954e-04  8.46393266e-03]
 [-1.17697392e-01 -6.65459982e-02 -8.32925304e-02]
 [ 2.26093028e+00  1.45866323e+00  1.67620723e-01]
 [-1.58431939e-02 -1.11030544e-01 -4.77144051e-02]
 [ 3.38364419e-02 -1.36400447e-02 -8.30305075e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.77952678]
curr_Stock_Price:  100.18719192672134
curr_Factors:  [100.18719193  -1.29790074  -0.99470264]
mat_Sqrt:  [[10.11922398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.49867821e-03  3.72294521e-04 -4.37030773e-01]
Stock Position:  0.007498678206122784
Bond Position:  [3.02825527]


portfolio before change:  [3.77752696]
curr_Stock_Price:  99.87001878512747
curr_Factors:  [99.87001879 -1.34481228 -0.99693046]
mat_Sqrt:  [[ 9.60349207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.12650785 0.07303951 0.9162571 ]
Stock Position:  0.1265078462247002
Bond Position:  [-8.85681402]


portfolio before change:  [3.73751519]
curr_Stock_Price:  99.56249165236878
curr_Factors:  [99.56249165 -1.26294666 -0.99835458]
mat_Sqrt:  [[10.37588399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03055788 -0.0577523   0.10899404]
Stock Position:  -0.03055787506967182
Bond Position:  [6.77993337]


portfolio before change:  [3.69733717]
curr_Stock_Price:  100.90504458793947
curr_Factors:  [100.90504459  -1.46691238  -0.98851834]
mat_Sqrt:  [[ 8.66029863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06199818 0.37002797 2.4243295 ]
Stock Position:  0.06199818273522948
Bond Position:  [-2.55859222]


portfolio before change:  [3.72896162]
curr_Stock_Price:  101.42029011762283
curr_Factors:  [101.42029012  -1.51416927  -0.98390063]
mat_Sqrt:  [[ 8.34116812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00703091 -0.01106097 -0.05874131]
Stock Position:  -0.007030909828298619
Bond Position:  [4.44203853]


portfolio before change:  [3.72636313]
curr_Stock_Price:  101.86884887597918
curr_Factors:  [101.86884888  -1.58218013  -0.99416127]
mat_Sqrt:  [[ 7.74730308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00885965 -0.01918066  0.15275428]
Stock Position:  0.008859650516352789
Bond Position:  [2.82384073]


portfolio before change:  [3.72208164]
curr_Stock_Price:  101.34574776997817
curr_Factors:  [101.34574777  -1.73950178  -1.00099473]
mat_Sqrt:  [[ 6.54068176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00942659 -0.01939996 -0.11189836]
Stock Position:  -0.009426585586985647
Bond Position:  [4.677426]


portfolio before change:  [3.71989464]
curr_Stock_Price:  101.63977936425754
curr_Factors:  [101.63977936  -1.77027411  -1.0051958 ]
mat_Sqrt:  [[ 6.33420988  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01576814 -0.01424705 -0.29142604]
Stock Position:  0.015768143082569124
Bond Position:  [2.11722405]


portfolio before change:  [3.71779831]
curr_Stock_Price:  101.49004744767277
curr_Factors:  [101.49004745  -1.56205951  -0.98420384]
mat_Sqrt:  [[ 7.95417848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025785  0.02964599 -0.14448933]
Stock Position:  -0.0002578458469043607
Bond Position:  [3.7439671]


portfolio before change:  [3.71821272]
curr_Stock_Price:  101.69798265233236
curr_Factors:  [101.69798265  -1.55526541  -0.9569007 ]
mat_Sqrt:  [[ 8.24693283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04931781 -0.02911918 -0.45330041]
Stock Position:  -0.049317806365805565
Bond Position:  [8.73373414]


portfolio before change:  [3.73797415]
curr_Stock_Price:  101.31942478095313
curr_Factors:  [101.31942478  -1.70647968  -0.97081403]
mat_Sqrt:  [[ 6.96560479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.1275299   0.41659734 -0.67429703]
Stock Position:  0.12752989749260732
Bond Position:  [-9.1832817]


portfolio before change:  [3.75590759]
curr_Stock_Price:  101.46904790803752
curr_Factors:  [101.46904791  -1.62868168  -0.95229556]
mat_Sqrt:  [[ 7.681206    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007113   0.01051749 -0.1664491 ]
Stock Position:  -0.0007113032763324612
Bond Position:  [3.82808286]


portfolio before change:  [3.75612159]
curr_Stock_Price:  101.84096620132222
curr_Factors:  [101.8409662   -1.38869898  -0.94195967]
mat_Sqrt:  [[ 9.90216867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03310491 -0.00386641 -1.3940394 ]
Stock Position:  -0.03310490765302613
Bond Position:  [7.12755737]


portfolio before change:  [3.71627632]
curr_Stock_Price:  103.07148679811027
curr_Factors:  [103.0714868   -1.54206783  -0.95219248]
mat_Sqrt:  [[ 8.50932386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.18922157 -1.06908557  8.01723497]
Stock Position:  0.18922156513739585
Bond Position:  [-15.78707174]


portfolio before change:  [3.68694593]
curr_Stock_Price:  102.92691087249797
curr_Factors:  [102.92691087  -1.8249145   -0.96703525]
mat_Sqrt:  [[ 6.30958169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033594 -0.030378    0.11295503]
Stock Position:  -0.00033593811709373746
Bond Position:  [3.721523]


portfolio before change:  [3.68735175]
curr_Stock_Price:  103.10370432117473
curr_Factors:  [103.10370432  -1.64928454  -0.94618481]
mat_Sqrt:  [[ 7.69265498  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01360127 -0.02494407  0.06247189]
Stock Position:  0.013601274704618464
Bond Position:  [2.28500995]


portfolio before change:  [3.68545318]
curr_Stock_Price:  102.94311543780614
curr_Factors:  [102.94311544  -1.56273544  -0.95907221]
mat_Sqrt:  [[ 8.26780382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02381735 -0.06415908 -0.07523486]
Stock Position:  -0.023817354989524905
Bond Position:  [6.13728591]


portfolio before change:  [3.68448086]
curr_Stock_Price:  103.01615159823056
curr_Factors:  [103.0161516   -1.64430002  -0.96974593]
mat_Sqrt:  [[ 7.54465852  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08505534 -0.54320108 -0.56629792]
Stock Position:  -0.08505534389798977
Bond Position:  [12.44655507]


portfolio before change:  [3.69607551]
curr_Stock_Price:  102.89812580891788
curr_Factors:  [102.89812581  -1.69302413  -0.96315666]
mat_Sqrt:  [[ 7.22508236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00889152 0.04296902 0.92064514]
Stock Position:  0.00889151831662628
Bond Position:  [2.78115493]


portfolio before change:  [3.69354448]
curr_Stock_Price:  102.57436854699584
curr_Factors:  [102.57436855  -2.10126219  -0.95475458]
mat_Sqrt:  [[ 4.82867118  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09784915 -0.00803403  1.81217129]
Stock Position:  0.09784914921650442
Bond Position:  [-6.34327022]


portfolio before change:  [3.69986412]
curr_Stock_Price:  102.64705804667067
curr_Factors:  [102.64705805  -2.02145405  -0.95622065]
mat_Sqrt:  [[ 5.22587255  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138009 -0.13142206 -0.34715922]
Stock Position:  -0.0013800936866678584
Bond Position:  [3.84152668]


portfolio before change:  [3.70068056]
curr_Stock_Price:  102.40343993047739
curr_Factors:  [102.40343993  -1.70201567  -0.95231917]
mat_Sqrt:  [[ 7.20363283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0190346  -0.01770192 -0.05185991]
Stock Position:  0.019034600477459276
Bond Position:  [1.751472]


portfolio before change:  [3.69459907]
curr_Stock_Price:  102.07244081968834
curr_Factors:  [102.07244082  -1.56496703  -0.95517276]
mat_Sqrt:  [[ 8.21156046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01396314 0.05270221 0.30907356]
Stock Position:  0.013963143273150798
Bond Position:  [2.26934696]


portfolio before change:  [3.68862917]
curr_Stock_Price:  101.62457662353816
curr_Factors:  [101.62457662  -1.55518534  -0.94508719]
mat_Sqrt:  [[ 8.33958013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0060036  -0.04705184 -0.18432318]
Stock Position:  -0.006003601294260276
Bond Position:  [4.29874261]


portfolio before change:  [3.68637237]
curr_Stock_Price:  102.08999340219133
curr_Factors:  [102.0899934   -1.68785179  -0.95821837]
mat_Sqrt:  [[ 7.24118272  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324079 -0.03057405  0.10273952]
Stock Position:  -0.00324079421976533
Bond Position:  [4.01722503]


portfolio before change:  [3.68395874]
curr_Stock_Price:  102.98971503988142
curr_Factors:  [102.98971504  -1.38421401  -0.96104497]
mat_Sqrt:  [[ 9.86871987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00602933 -0.00490633  0.00990275]
Stock Position:  0.006029330052802438
Bond Position:  [3.06299976]


portfolio before change:  [3.6864662]
curr_Stock_Price:  103.34208592831314
curr_Factors:  [103.34208593  -1.42750486  -0.95177401]
mat_Sqrt:  [[ 9.57126937  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06341771 -0.02352169  0.86237848]
Stock Position:  0.06341771201297078
Bond Position:  [-2.86725245]


portfolio before change:  [3.6607648]
curr_Stock_Price:  102.94246626474033
curr_Factors:  [102.94246626  -1.51332513  -0.96951928]
mat_Sqrt:  [[ 8.59624811  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00302986 -0.07217243 -0.2916556 ]
Stock Position:  0.0030298592636955135
Bond Position:  [3.34886362]


portfolio before change:  [3.66024139]
curr_Stock_Price:  102.63154394317283
curr_Factors:  [102.63154394  -1.35916027  -0.94087782]
mat_Sqrt:  [[10.28932805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247141 -0.02418365 -0.00891479]
Stock Position:  -0.002471405261448896
Bond Position:  [3.91388553]


portfolio before change:  [3.6617604]
curr_Stock_Price:  102.21488113966107
curr_Factors:  [102.21488114  -1.1260138   -0.9325115 ]
mat_Sqrt:  [[13.04691845  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00874715 -0.00936875  0.26154113]
Stock Position:  0.00874714604579308
Bond Position:  [2.7676719]


portfolio before change:  [3.66368635]
curr_Stock_Price:  102.39550781412281
curr_Factors:  [102.39550781  -0.77502021  -0.91820746]
mat_Sqrt:  [[18.83308506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185557 -0.0142599  -0.13599267]
Stock Position:  -0.0018555673058098365
Bond Position:  [3.8536881]


portfolio before change:  [3.66798656]
curr_Stock_Price:  100.33765951371132
curr_Factors:  [100.33765951  -0.75600565  -0.90537699]
mat_Sqrt:  [[19.0517403   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153384  0.00692197 -0.15147073]
Stock Position:  -0.001533839782323915
Bond Position:  [3.82188846]


portfolio before change:  [3.6679363]
curr_Stock_Price:  100.6819103841755
curr_Factors:  [100.68191038  -0.82177491  -0.92140735]
mat_Sqrt:  [[17.61558251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00613125 -0.01109257  0.0997982 ]
Stock Position:  -0.006131251023246043
Bond Position:  [4.28524237]


portfolio before change:  [3.66988057]
curr_Stock_Price:  100.45217346817243
curr_Factors:  [100.45217347  -0.82491047  -0.9276578 ]
mat_Sqrt:  [[17.41119604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00995432 0.00217013 0.08232842]
Stock Position:  0.009954318007704443
Bond Position:  [2.66994769]


portfolio before change:  [3.67931008]
curr_Stock_Price:  101.36592269222459
curr_Factors:  [101.36592269  -0.72092063  -0.9266646 ]
mat_Sqrt:  [[19.514382    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063489 -0.00028487  0.02414524]
Stock Position:  -0.0006348915202274242
Bond Position:  [3.74366645]


portfolio before change:  [3.68055199]
curr_Stock_Price:  100.14694644195828
curr_Factors:  [100.14694644  -0.78614513  -0.91158434]
mat_Sqrt:  [[18.33678416  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00808664 -0.02147763 -0.23761041]
Stock Position:  -0.00808664442917591
Bond Position:  [4.49040473]


portfolio before change:  [3.67656221]
curr_Stock_Price:  100.70973974082948
curr_Factors:  [100.70973974  -0.74973428  -0.94444845]
mat_Sqrt:  [[18.5053483   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.14011593 0.47078153 0.47817527]
Stock Position:  0.14011593108343215
Bond Position:  [-10.43447674]


portfolio before change:  [3.78140634]
curr_Stock_Price:  101.46731608044543
curr_Factors:  [101.46731608  -0.90009297  -0.9588635 ]
mat_Sqrt:  [[15.81217595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305125 -0.03583495 -0.13611592]
Stock Position:  -0.0030512480418921737
Bond Position:  [4.09100829]


portfolio before change:  [3.7851509]
curr_Stock_Price:  100.40769690455066
curr_Factors:  [100.4076969   -0.93300428  -0.92227797]
mat_Sqrt:  [[15.70464633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00089806 -0.00440231 -0.23686293]
Stock Position:  0.0008980557553321898
Bond Position:  [3.69497919]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.78526788]
Stock Price:  100.02362039499171
PL:  [3.76164749]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 5.13714552e-02 -7.52592828e-02 -1.44076578e-02]
 [ 1.19952783e+00  2.40404477e-01  3.50698552e-01]
 [-3.68348858e-01 -2.52587123e-01  4.05408339e-02]
 [ 2.20782563e-01  1.55641714e+00  1.39456928e+00]
 [-4.74759259e-02 -3.41189066e-02 -2.03580233e-02]
 [-1.40115980e-02  2.20867588e-01 -9.34940200e-02]
 [-5.42237572e-02  5.28177736e-03 -6.52110822e-02]
 [-6.34330807e-02  1.25943358e-01  6.51462416e-04]
 [ 1.95333942e-03  7.84194251e-02 -4.86084755e-02]
 [-1.13782621e-01 -5.80604374e-02 -2.50222137e-02]
 [ 8.17601203e-01  1.56834476e+00 -2.85815139e-01]
 [-4.10705925e-05  2.80103449e-02 -5.10823199e-02]
 [-3.29916998e-01 -1.09484475e-03 -7.09817282e-01]
 [ 1.87702399e+00 -3.34339517e+00  2.81860035e+00]
 [ 2.65078258e-02 -6.85495120e-02  1.64157738e-03]
 [ 7.97221925e-02  6.62896130e-02 -4.97093162e-02]
 [-3.82270394e-02  3.34145016e-02 -7.99575531e-02]
 [-2.76175930e-01 -1.78103716e+00 -1.95781839e-01]
 [-6.45951363e-03 -1.61674853e-02  3.59306056e-01]
 [ 1.72449231e-01  2.65429647e-01  4.54026364e-01]
 [ 3.32069739e-02 -8.15140189e-02  1.88574598e-02]
 [ 1.10208497e-01 -5.09996484e-02  2.67078558e-02]
 [-4.64510648e-02  2.39362549e-02 -1.95505635e-02]
 [-5.42900476e-02 -4.21975910e-02 -4.21293293e-02]
 [ 4.10981400e-02 -4.24792592e-02  2.02285338e-03]
 [ 2.96169011e-02 -4.52205255e-02  2.65764629e-01]
 [ 2.80654003e-01 -9.53523439e-02  1.16210581e-01]
 [ 2.26741487e-02 -1.32056902e-01 -4.88741345e-02]
 [ 1.02312940e-02 -5.58065482e-02  2.99905890e-02]
 [ 6.42561294e-03  6.23866284e-02  1.11996214e-02]
 [ 3.31597617e-02 -1.38531915e-02 -7.64891706e-02]
 [-5.87205836e-02  8.16888100e-03 -3.92000539e-02]
 [-9.54308820e-02 -2.43072456e-02  3.93924764e-02]
 [-2.37412776e-03 -3.84381143e-02 -9.20786706e-03]
 [-9.20772042e-02  6.16031862e-02  4.34493565e-02]
 [-1.08232936e-01 -6.11472077e-02 -7.13228575e-02]
 [ 1.67780290e+00  1.08980049e+00  1.44139883e-01]
 [ 3.92171260e-02 -6.62083360e-02  4.92559970e-02]
 [ 3.04232925e-02 -1.49895773e-02 -2.69779432e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.85405266]
curr_Stock_Price:  100.33382344620524
curr_Factors:  [100.33382345  -1.03156412  -0.98460701]
mat_Sqrt:  [[13.3608893   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.002475   -0.02428983 -0.04110104]
Stock Position:  0.0024750049866165812
Bond Position:  [4.60572594]


portfolio before change:  [4.85456913]
curr_Stock_Price:  100.30987269847716
curr_Factors:  [100.3098727   -1.16810091  -0.98041418]
mat_Sqrt:  [[11.70187435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11281836 0.07759021 1.00044535]
Stock Position:  0.11281835651210831
Bond Position:  [-6.46222585]


portfolio before change:  [4.70416948]
curr_Stock_Price:  98.9839198428089
curr_Factors:  [98.98391984 -1.00352714 -0.98247015]
mat_Sqrt:  [[13.58491685  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03030071 -0.08152214  0.11565171]
Stock Position:  -0.030300709955435677
Bond Position:  [7.70345253]


portfolio before change:  [4.70628636]
curr_Stock_Price:  98.94583871486913
curr_Factors:  [98.94583871 -1.02148584 -0.98400229]
mat_Sqrt:  [[13.31757359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06180932 0.50233147 3.97831799]
Stock Position:  0.061809318225027485
Bond Position:  [-1.40948848]


portfolio before change:  [4.68968733]
curr_Stock_Price:  98.6801371830626
curr_Factors:  [98.68013718 -0.85250373 -1.00033285]
mat_Sqrt:  [[15.47223466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378717 -0.01101183 -0.05807577]
Stock Position:  -0.0037871699792173916
Bond Position:  [5.06340578]


portfolio before change:  [4.68880552]
curr_Stock_Price:  99.08011266879971
curr_Factors:  [99.08011267 -0.72643956 -0.99821127]
mat_Sqrt:  [[17.65957112  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00067886  0.07128471 -0.26671242]
Stock Position:  0.000678862619929787
Bond Position:  [4.62154373]


portfolio before change:  [4.68932817]
curr_Stock_Price:  98.99898659267731
curr_Factors:  [98.99898659 -0.71522653 -0.97580421]
mat_Sqrt:  [[18.24842677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364178  0.00170469 -0.18602907]
Stock Position:  -0.0036417810775714187
Bond Position:  [5.04986081]


portfolio before change:  [4.68932856]
curr_Stock_Price:  99.17222303508979
curr_Factors:  [99.17222304 -1.03075416 -0.99162273]
mat_Sqrt:  [[13.12450469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286426  0.04064804  0.00185844]
Stock Position:  -0.0028642620914358535
Bond Position:  [4.9733838]


portfolio before change:  [4.68784368]
curr_Stock_Price:  99.90769785570295
curr_Factors:  [99.90769786 -1.29453766 -0.99674141]
mat_Sqrt:  [[10.10436656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079554  0.02530976 -0.13866645]
Stock Position:  0.0007955445773966118
Bond Position:  [4.60836265]


portfolio before change:  [4.6883163]
curr_Stock_Price:  99.77764502745174
curr_Factors:  [99.77764503 -1.13711748 -1.00344862]
mat_Sqrt:  [[11.73267946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01114339 -0.01873893 -0.07138141]
Stock Position:  -0.011143387718433902
Bond Position:  [5.80017728]


portfolio before change:  [4.68556947]
curr_Stock_Price:  100.08921032972809
curr_Factors:  [100.08921033  -1.29577828  -1.00778197]
mat_Sqrt:  [[ 9.99916553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10794865  0.5061811  -0.81535104]
Stock Position:  0.10794865458729207
Bond Position:  [-6.11892612]


portfolio before change:  [4.67782025]
curr_Stock_Price:  100.02451007726255
curr_Factors:  [100.02451008  -1.13984783  -1.00218521]
mat_Sqrt:  [[11.74446673  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004045   0.0090403  -0.14572364]
Stock Position:  -0.00040449838037451383
Bond Position:  [4.71828]


portfolio before change:  [4.67864237]
curr_Stock_Price:  99.45022466070047
curr_Factors:  [99.45022466 -0.99670202 -1.01862134]
mat_Sqrt:  [[13.25445749  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.58393641e-02 -3.53359624e-04 -2.02491113e+00]
Stock Position:  -0.0358393641026374
Bond Position:  [8.24287518]


portfolio before change:  [4.67383685]
curr_Stock_Price:  99.61306073341068
curr_Factors:  [99.61306073 -1.21720654 -1.01788743]
mat_Sqrt:  [[10.65681207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.16608163 -1.07907615  8.04068226]
Stock Position:  0.16608162837405815
Bond Position:  [-11.87006248]


portfolio before change:  [4.54068394]
curr_Stock_Price:  98.82026345173051
curr_Factors:  [98.82026345 -1.49042759 -1.03154082]
mat_Sqrt:  [[ 7.93540402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00161936 -0.02212426  0.00468296]
Stock Position:  0.001619363145497456
Bond Position:  [4.38065805]


portfolio before change:  [4.54191673]
curr_Stock_Price:  99.2433778593469
curr_Factors:  [99.24337786 -1.53817118 -1.04248305]
mat_Sqrt:  [[ 7.51514989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01105855  0.02139488 -0.14180684]
Stock Position:  0.011058546074905829
Bond Position:  [3.44442926]


portfolio before change:  [4.53933797]
curr_Stock_Price:  98.97124925617543
curr_Factors:  [98.97124926 -1.42821995 -1.0192792 ]
mat_Sqrt:  [[ 8.56196947  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00557437  0.01078448 -0.22809664]
Stock Position:  -0.005574371665164861
Bond Position:  [5.09104049]


portfolio before change:  [4.53725498]
curr_Stock_Price:  99.4590893114224
curr_Factors:  [99.45908931 -1.4634797  -1.00956135]
mat_Sqrt:  [[ 8.38718839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08103936 -0.57482727 -0.55851109]
Stock Position:  -0.08103936474111421
Bond Position:  [12.5973564]


portfolio before change:  [4.55493437]
curr_Stock_Price:  99.26036340382386
curr_Factors:  [99.2603634  -1.42809434 -0.99496694]
mat_Sqrt:  [[ 8.79941331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00722586 -0.00521803  1.02500017]
Stock Position:  0.0072258628502472316
Bond Position:  [3.8376926]


portfolio before change:  [4.55277561]
curr_Stock_Price:  98.89521582201186
curr_Factors:  [98.89521582 -1.34893709 -1.01144616]
mat_Sqrt:  [[ 9.33413036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0342086  0.08566705 1.29521084]
Stock Position:  0.03420860453314113
Bond Position:  [1.16970828]


portfolio before change:  [4.55111865]
curr_Stock_Price:  98.8425046517776
curr_Factors:  [98.84250465 -1.42496937 -1.00961611]
mat_Sqrt:  [[ 8.66197053  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235711 -0.02630854  0.05379508]
Stock Position:  0.0023571146086208677
Bond Position:  [4.31813554]


portfolio before change:  [4.55084177]
curr_Stock_Price:  98.49602643335373
curr_Factors:  [98.49602643 -1.12880225 -1.02113834]
mat_Sqrt:  [[11.47390839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00917298 -0.01646007  0.07619008]
Stock Position:  0.009172982014505324
Bond Position:  [3.64733949]


portfolio before change:  [4.55575972]
curr_Stock_Price:  98.98245545222008
curr_Factors:  [98.98245545 -1.23885121 -1.03832194]
mat_Sqrt:  [[10.15300247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448693  0.00772539 -0.05577232]
Stock Position:  -0.00448693275476868
Bond Position:  [4.99988734]


portfolio before change:  [4.55500865]
curr_Stock_Price:  99.28914460692754
curr_Factors:  [99.28914461 -1.30591479 -1.01239901]
mat_Sqrt:  [[ 9.77396723  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00731568 -0.01361921 -0.12018325]
Stock Position:  -0.007315679129807265
Bond Position:  [5.28137617]


portfolio before change:  [4.55695793]
curr_Stock_Price:  99.1129382481595
curr_Factors:  [99.11293825 -0.94711892 -1.02874875]
mat_Sqrt:  [[13.74111343  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00238991 -0.01371012  0.00577064]
Stock Position:  0.002389909002716852
Bond Position:  [4.32008703]


portfolio before change:  [4.55753106]
curr_Stock_Price:  99.12678051759552
curr_Factors:  [99.12678052 -1.26783226 -1.0371812 ]
mat_Sqrt:  [[ 9.88863567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00754758 -0.01459486  0.75815251]
Stock Position:  0.007547580900039187
Bond Position:  [3.80936366]


portfolio before change:  [4.55949181]
curr_Stock_Price:  99.32347237891742
curr_Factors:  [99.32347238 -1.30337944 -1.06047079]
mat_Sqrt:  [[ 9.34210585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03049759 -0.03077484  0.33151644]
Stock Position:  0.030497585620767608
Bond Position:  [1.5303657]


portfolio before change:  [4.56265305]
curr_Stock_Price:  99.42085506634353
curr_Factors:  [99.42085507 -1.2628143  -1.08289911]
mat_Sqrt:  [[ 9.52241496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149733 -0.04262118 -0.1394243 ]
Stock Position:  -0.0014973349262262607
Bond Position:  [4.71151937]


portfolio before change:  [4.56366232]
curr_Stock_Price:  99.14015953104408
curr_Factors:  [99.14015953 -1.22286095 -1.06824131]
mat_Sqrt:  [[10.02851306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00049475 -0.01801149  0.0855548 ]
Stock Position:  0.0004947526467549932
Bond Position:  [4.51461247]


portfolio before change:  [4.5642125]
curr_Stock_Price:  99.11149878078417
curr_Factors:  [99.11149878 -1.33767863 -1.01587621]
mat_Sqrt:  [[ 9.41863921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00227701 0.0201352  0.0319494 ]
Stock Position:  0.002277010807710467
Bond Position:  [4.33853455]


portfolio before change:  [4.56371586]
curr_Stock_Price:  98.65519916185575
curr_Factors:  [98.65519916 -0.99899144 -1.01662395]
mat_Sqrt:  [[13.14465931  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00111975 -0.0044711  -0.21820231]
Stock Position:  0.001119747874142191
Bond Position:  [4.45324691]


portfolio before change:  [4.56299193]
curr_Stock_Price:  97.5115308400557
curr_Factors:  [97.51153084 -0.96793855 -0.99159612]
mat_Sqrt:  [[13.7417131   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00473411  0.0026365  -0.11182684]
Stock Position:  -0.004734111005114326
Bond Position:  [5.02462234]


portfolio before change:  [4.56150595]
curr_Stock_Price:  97.9580958605989
curr_Factors:  [97.95809586 -0.9761108  -0.99800046]
mat_Sqrt:  [[13.60487977  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00678812 -0.00784513  0.11237577]
Stock Position:  -0.006788124829358062
Bond Position:  [5.22645774]


portfolio before change:  [4.57365401]
curr_Stock_Price:  96.26474120428531
curr_Factors:  [96.2647412  -0.62550025 -1.00599205]
mat_Sqrt:  [[18.83298431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064248 -0.01240585 -0.02626748]
Stock Position:  -0.0006424803836203769
Bond Position:  [4.63550221]


portfolio before change:  [4.57502292]
curr_Stock_Price:  95.03600303695934
curr_Factors:  [95.03600304 -0.70090353 -0.99668558]
mat_Sqrt:  [[17.40341903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0040586   0.01988234  0.12394892]
Stock Position:  -0.004058595816041259
Bond Position:  [4.96073564]


portfolio before change:  [4.57382309]
curr_Stock_Price:  95.48442379554608
curr_Factors:  [95.4844238  -0.528642   -1.02925706]
mat_Sqrt:  [[20.10692083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0067277  -0.01973518 -0.20346426]
Stock Position:  -0.006727697171919925
Bond Position:  [5.21621338]


portfolio before change:  [4.57385689]
curr_Stock_Price:  95.57632226646601
curr_Factors:  [95.57632227 -0.75056197 -1.01565431]
mat_Sqrt:  [[16.34151549  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11808451 0.3517316  0.41119097]
Stock Position:  0.11808451435035744
Bond Position:  [-6.7122267]


portfolio before change:  [4.59592941]
curr_Stock_Price:  95.77034940126623
curr_Factors:  [95.7703494  -0.74789155 -0.9845656 ]
mat_Sqrt:  [[16.93692218  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00211117 -0.02136865  0.14051365]
Stock Position:  0.0021111713140184274
Bond Position:  [4.3937418]


portfolio before change:  [4.59499215]
curr_Stock_Price:  95.06622938883952
curr_Factors:  [95.06622939 -0.9045212  -0.94704007]
mat_Sqrt:  [[14.92462491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146447 -0.00483787 -0.07696056]
Stock Position:  0.00146447287025448
Bond Position:  [4.45577023]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.59632322]
Stock Price:  95.5947925243658
PL:  [4.59632322]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 3.81732356e-02 -4.01199183e-02 -4.35181522e-02]
 [ 8.77565876e-01  2.04740768e-01  2.50585682e-01]
 [-3.01971366e-01 -1.91488013e-01  3.86046971e-02]
 [ 1.87745653e-01  1.45429014e+00  1.20830681e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 2.31069752e-03  1.17819575e-01 -3.16509966e-02]
 [-1.11578768e-01  1.65769502e-01  4.52610474e-02]
 [-3.44482719e-03  1.62163619e-01 -9.12201723e-03]
 [-1.54702976e-02  9.72746162e-02 -5.14730611e-02]
 [-1.51229917e-01 -8.13135830e-02 -5.09059234e-02]
 [ 7.52670059e-01  1.44842592e+00 -2.62389483e-01]
 [-1.05701107e-04  3.36634269e-02 -5.86702602e-02]
 [-3.60038287e-01 -8.96047972e-03 -7.43988343e-01]
 [ 1.94205087e+00 -3.52465611e+00  2.97198855e+00]
 [ 2.71009687e-02 -7.66022706e-02  1.46034840e-02]
 [ 1.15322411e-01  1.33435262e-02 -3.13061580e-02]
 [-5.62079850e-02  3.93895545e-03 -6.38183400e-02]
 [-2.77523106e-01 -1.79735560e+00 -1.98905238e-01]
 [-6.36159244e-03  2.27005540e-03  2.48451300e-01]
 [ 1.51187288e-01  3.24274189e-02  3.41564253e-01]
 [ 3.35793885e-02 -4.49127683e-02  7.67184876e-02]
 [ 1.03188451e-01 -4.97589577e-02  9.48199529e-03]
 [ 5.80217692e-02  9.00959805e-02  6.61859563e-02]
 [-4.90902437e-02 -6.09388449e-02  7.50946776e-02]
 [ 5.25590750e-02 -3.29648633e-02 -5.05467119e-03]
 [ 5.29318863e-02 -5.73109486e-03  2.70720416e-01]
 [-1.61758612e-01 -1.22318206e-01 -6.07446287e-02]
 [-1.70679409e-01  1.24221820e-01  2.48135117e-01]
 [ 3.29001393e-02  2.57814124e-03  1.38428218e-01]
 [-1.18878966e-01  1.10367393e-01 -1.19568583e-02]
 [ 6.59280372e-02 -1.84939099e-02 -6.77523454e-02]
 [-8.16886082e-03  1.38960663e-02 -5.47434118e-02]
 [-5.82862032e-02 -1.77813312e-02  3.80871682e-02]
 [-1.50064906e-02  2.44747323e-03  1.87867316e-03]
 [ 2.57583418e-02 -5.26789762e-03  1.39855567e-03]
 [-1.21017573e-01 -7.14598852e-02 -8.31603018e-02]
 [ 2.01977103e+00  1.31185633e+00  1.59029235e-01]
 [-3.26249386e-02 -2.17718948e-02 -2.51224727e-02]
 [ 3.43120969e-02 -1.37736632e-02 -9.14793368e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.58787793]
curr_Stock_Price:  99.18182409547214
curr_Factors:  [99.1818241  -1.28943031 -1.00164408]
mat_Sqrt:  [[10.03300727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210313 -0.01294865 -0.12414518]
Stock Position:  0.0021031267472476573
Bond Position:  [-3.79646988]


portfolio before change:  [-3.58824765]
curr_Stock_Price:  99.23168569053378
curr_Factors:  [99.23168569 -1.40907914 -1.00486967]
mat_Sqrt:  [[ 8.87739867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10932358 0.0660798  0.7148512 ]
Stock Position:  0.10932357949544487
Bond Position:  [-14.43661073]


portfolio before change:  [-3.56174523]
curr_Stock_Price:  99.49061532386746
curr_Factors:  [99.49061532 -1.14098415 -1.04340077]
mat_Sqrt:  [[11.19736413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02975509 -0.06180249  0.11012846]
Stock Position:  -0.02975508685935147
Bond Position:  [-0.60139333]


portfolio before change:  [-3.5613394]
curr_Stock_Price:  99.47444973901256
curr_Factors:  [99.47444974 -1.1668556  -1.06105413]
mat_Sqrt:  [[10.71871304  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06822143 0.46937012 3.446963  ]
Stock Position:  0.06822143449283269
Bond Position:  [-10.34762906]


portfolio before change:  [-3.58046445]
curr_Stock_Price:  99.21307268775824
curr_Factors:  [99.21307269 -1.47525498 -1.0591821 ]
mat_Sqrt:  [[ 7.86822666  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00745352 -0.01106097 -0.05874131]
Stock Position:  -0.007453522057550595
Bond Position:  [-2.84097763]


portfolio before change:  [-3.57795401]
curr_Stock_Price:  98.8286120974447
curr_Factors:  [98.8286121  -1.27742699 -1.09375429]
mat_Sqrt:  [[ 9.2276636   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215654  0.0380261  -0.09029148]
Stock Position:  0.0021565355788207797
Bond Position:  [-3.79108143]


portfolio before change:  [-3.57748502]
curr_Stock_Price:  99.26584163951468
curr_Factors:  [99.26584164 -1.40052157 -1.1196993 ]
mat_Sqrt:  [[ 7.98512673  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00857874  0.05350188  0.12911717]
Stock Position:  -0.008578741473076202
Bond Position:  [-2.72590903]


portfolio before change:  [-3.58203618]
curr_Stock_Price:  99.75663534490526
curr_Factors:  [99.75663534 -1.38570291 -1.09786458]
mat_Sqrt:  [[ 8.32419286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00333902  0.05233808 -0.02602258]
Stock Position:  0.00333902151037576
Bond Position:  [-3.91512573]


portfolio before change:  [-3.5811172]
curr_Stock_Price:  100.17843611623707
curr_Factors:  [100.17843612  -1.50973876  -1.10432546]
mat_Sqrt:  [[ 7.33669702  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083431  0.03139525 -0.14683832]
Stock Position:  -0.00083431199419374
Bond Position:  [-3.49753712]


portfolio before change:  [-3.58145481]
curr_Stock_Price:  100.05905471563867
curr_Factors:  [100.05905472  -1.63209311  -1.10662593]
mat_Sqrt:  [[ 6.4691293   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02754917 -0.02624385 -0.14522043]
Stock Position:  -0.027549165097051055
Bond Position:  [-0.8249114]


portfolio before change:  [-3.59017476]
curr_Stock_Price:  100.37183465014733
curr_Factors:  [100.37183465  -1.60549271  -1.10996401]
mat_Sqrt:  [[ 6.64207836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.14976769  0.46747745 -0.74852416]
Stock Position:  0.14976769005614227
Bond Position:  [-18.62263258]


portfolio before change:  [-3.57470875]
curr_Stock_Price:  100.49064518679813
curr_Factors:  [100.49064519  -1.66381199  -1.10867546]
mat_Sqrt:  [[ 6.28130139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00082948  0.01086482 -0.16736992]
Stock Position:  -0.0008294777246998504
Bond Position:  [-3.491354]


portfolio before change:  [-3.57476519]
curr_Stock_Price:  100.03251743548752
curr_Factors:  [100.03251744  -1.61494512  -1.11167146]
mat_Sqrt:  [[ 6.5461607   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07847857 -0.00289198 -2.12239166]
Stock Position:  -0.07847856876291723
Bond Position:  [4.2756436]


portfolio before change:  [-3.54754549]
curr_Stock_Price:  99.69248555654116
curr_Factors:  [99.69248556 -1.5586715  -1.13063292]
mat_Sqrt:  [[ 6.77192839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.27012071 -1.13757787  8.47825611]
Stock Position:  0.27012070576819275
Bond Position:  [-30.47655005]


portfolio before change:  [-3.46527636]
curr_Stock_Price:  100.01115395562633
curr_Factors:  [100.01115396  -1.7258042   -1.14257916]
mat_Sqrt:  [[ 5.67969973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00254336 -0.02472328  0.04165968]
Stock Position:  0.002543359701496979
Bond Position:  [-3.7196407]


portfolio before change:  [-3.46575875]
curr_Stock_Price:  100.00431315620182
curr_Factors:  [100.00431316  -1.57299663  -1.16888277]
mat_Sqrt:  [[ 6.44518875  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0173239   0.0043066  -0.08930775]
Stock Position:  0.017323899749373206
Bond Position:  [-5.19822344]


portfolio before change:  [-3.4636706]
curr_Stock_Price:  100.16235893508039
curr_Factors:  [100.16235894  -1.52184563  -1.15465714]
mat_Sqrt:  [[ 6.89150635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00992973  0.00127129 -0.18205596]
Stock Position:  -0.00992973230259488
Bond Position:  [-2.46908519]


portfolio before change:  [-3.4621188]
curr_Stock_Price:  99.97499677454837
curr_Factors:  [99.97499677 -1.27293922 -1.1571649 ]
mat_Sqrt:  [[ 8.80056572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07783683 -0.58009402 -0.56742128]
Stock Position:  -0.07783683056612332
Bond Position:  [4.31961809]


portfolio before change:  [-3.47880875]
curr_Stock_Price:  100.19635656210514
curr_Factors:  [100.19635656  -1.01765467  -1.12948028]
mat_Sqrt:  [[11.70477497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00382892 0.00073266 0.7087624 ]
Stock Position:  0.003828923667812112
Bond Position:  [-3.86245295]


portfolio before change:  [-3.47917754]
curr_Stock_Price:  100.22614283748841
curr_Factors:  [100.22614284  -0.82637076  -1.13632095]
mat_Sqrt:  [[14.07974662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01615995 0.0104659  0.97438774]
Stock Position:  0.016159951211516605
Bond Position:  [-5.09882712]


portfolio before change:  [-3.49766367]
curr_Stock_Price:  99.12163882089227
curr_Factors:  [99.12163882 -0.54778425 -1.12682599]
mat_Sqrt:  [[18.57353151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215746 -0.01449553  0.21885649]
Stock Position:  0.0021574628245376233
Bond Position:  [-3.71151492]


portfolio before change:  [-3.49665653]
curr_Stock_Price:  99.80350733762192
curr_Factors:  [99.80350734 -0.99222699 -1.11973942]
mat_Sqrt:  [[12.07620408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00786397 -0.01605963  0.02704949]
Stock Position:  0.007863973596962687
Bond Position:  [-4.28150867]


portfolio before change:  [-3.49409715]
curr_Stock_Price:  100.19702355645624
curr_Factors:  [100.19702356  -1.04564103  -1.10645298]
mat_Sqrt:  [[11.64695143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00772071 0.02907835 0.18881011]
Stock Position:  0.007720705840738109
Bond Position:  [-4.26768889]


portfolio before change:  [-3.49933433]
curr_Stock_Price:  99.58779357268332
curr_Factors:  [99.58779357 -0.89143775 -1.08545761]
mat_Sqrt:  [[13.79276586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00334963 -0.01966793  0.21422421]
Stock Position:  -0.00334963247152127
Bond Position:  [-3.16575182]


portfolio before change:  [-3.49569853]
curr_Stock_Price:  98.38421546498853
curr_Factors:  [98.38421546 -0.71967172 -1.07560513]
mat_Sqrt:  [[16.33979472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00274167 -0.01063936 -0.01441957]
Stock Position:  0.002741672753046104
Bond Position:  [-3.76543585]


portfolio before change:  [-3.49369546]
curr_Stock_Price:  99.2865028484255
curr_Factors:  [99.28650285 -0.35914926 -1.06103941]
mat_Sqrt:  [[23.99441206  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00446031 -0.0018497   0.77228999]
Stock Position:  0.004460313706926992
Bond Position:  [-3.93654441]


portfolio before change:  [-3.49723844]
curr_Stock_Price:  98.60249774330968
curr_Factors:  [98.60249774 -0.31785904 -1.02560944]
mat_Sqrt:  [[25.72924059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00773929 -0.03947803 -0.17328752]
Stock Position:  -0.007739293984908331
Bond Position:  [-2.73412472]


portfolio before change:  [-3.48359845]
curr_Stock_Price:  96.79590264468216
curr_Factors:  [96.79590264 -0.11341881 -1.04379273]
mat_Sqrt:  [[30.42890962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311126  0.04009242  0.70786042]
Stock Position:  -0.0031112638788045014
Bond Position:  [-3.18244086]


portfolio before change:  [-3.4859106]
curr_Stock_Price:  97.41118938084554
curr_Factors:  [97.41118938 -0.233295   -1.04118901]
mat_Sqrt:  [[27.23375179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00226494 0.00083209 0.39489718]
Stock Position:  0.0022649447046268318
Bond Position:  [-3.70654156]


portfolio before change:  [-3.48758198]
curr_Stock_Price:  96.87782884845122
curr_Factors:  [96.87782885 -0.31152328 -1.04046789]
mat_Sqrt:  [[25.06467561  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00394144  0.03562092 -0.03410959]
Stock Position:  -0.003941443395107109
Bond Position:  [-3.1057435]


portfolio before change:  [-3.48483859]
curr_Stock_Price:  96.08328892376154
curr_Factors:  [96.08328892 -0.27171853 -1.03403924]
mat_Sqrt:  [[26.03541256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185605 -0.00596888 -0.19327858]
Stock Position:  0.001856052556793214
Bond Position:  [-3.66317422]


portfolio before change:  [-3.48058089]
curr_Stock_Price:  98.62396152587124
curr_Factors:  [98.62396153 -0.37629563 -1.06560598]
mat_Sqrt:  [[23.32236198  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070777  0.00448494 -0.15616772]
Stock Position:  -0.0007077666624965969
Bond Position:  [-3.41077814]


portfolio before change:  [-3.48053366]
curr_Stock_Price:  97.95480654584384
curr_Factors:  [97.95480655 -0.34195305 -1.05488034]
mat_Sqrt:  [[24.23196975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223429 -0.0057389   0.10865209]
Stock Position:  -0.002234291810314154
Bond Position:  [-3.26167404]


portfolio before change:  [-3.48261728]
curr_Stock_Price:  98.70488280681099
curr_Factors:  [98.70488281 -0.31501916 -1.04328078]
mat_Sqrt:  [[25.37677746  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055655  0.00078992  0.00535933]
Stock Position:  -0.0005565489818131525
Bond Position:  [-3.42768318]


portfolio before change:  [-3.48314993]
curr_Stock_Price:  98.89203586388797
curr_Factors:  [98.89203586 -0.13581689 -1.01208971]
mat_Sqrt:  [[31.37847348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079572 -0.00170021  0.00398969]
Stock Position:  0.0007957211702140505
Bond Position:  [-3.56184042]


portfolio before change:  [-3.48363191]
curr_Stock_Price:  98.84588290608573
curr_Factors:  [98.84588291 -0.41951101 -1.01959147]
mat_Sqrt:  [[23.4403622   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00650925 -0.02306358 -0.23723319]
Stock Position:  -0.006509254662680407
Bond Position:  [-2.84021889]


portfolio before change:  [-3.49623526]
curr_Stock_Price:  100.72755664431182
curr_Factors:  [100.72755664  -0.56560698  -1.00929399]
mat_Sqrt:  [[20.85342995  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11125337 0.42339981 0.45366614]
Stock Position:  0.11125336653637778
Bond Position:  [-14.70251504]


portfolio before change:  [-3.34600185]
curr_Stock_Price:  102.09444865863978
curr_Factors:  [102.09444866  -0.31737199  -1.00989056]
mat_Sqrt:  [[27.07567714  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155849 -0.00702685 -0.07166742]
Stock Position:  -0.0015584914473759754
Bond Position:  [-3.18688852]


portfolio before change:  [-3.34362589]
curr_Stock_Price:  100.31430294459835
curr_Factors:  [100.31430294  -0.1206045   -0.99748671]
mat_Sqrt:  [[32.79306563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00039116 -0.00444543 -0.26096508]
Stock Position:  0.0003911625210145619
Bond Position:  [-3.38286509]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.34282526]
Stock Price:  103.442205392972
PL:  [-6.78503065]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 9.34786417e-02 -2.15224347e-02  3.06241499e-02]
 [ 1.40469619e+00  3.16708802e-01  4.46697383e-01]
 [ 1.29690584e-01  2.39773832e-01  4.29973334e-02]
 [ 1.38110108e-01  9.46292801e-01  8.63270133e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 7.79068677e-02 -1.63716284e-02  3.50463226e-02]
 [-3.21888650e-02 -1.19266517e-01  2.13006366e-03]
 [ 1.98045681e-01  2.77959844e-02 -1.90385430e-01]
 [ 2.11109813e-02  5.76877604e-02 -4.54588055e-02]
 [-5.16231204e-01  9.76589957e-02 -1.88364559e-01]
 [ 2.40867202e-01  5.09998371e-01 -7.60292296e-02]
 [ 1.03872830e-04  1.80995321e-02 -6.12173783e-02]
 [ 1.27375898e-01 -3.73571574e-02  5.48141884e-02]
 [ 1.40596039e+00 -2.72296776e+00  2.35554995e+00]
 [ 5.68594057e-02 -1.05208159e-01  6.52271394e-02]
 [ 1.79218488e-01 -1.90214867e-01  6.37987854e-02]
 [-4.54346591e-01 -8.59656832e-01  7.91914939e-02]
 [-2.21699085e-01 -1.47111911e+00 -1.95895911e-01]
 [ 6.68137017e-04  3.54668990e-02  6.90569549e-02]
 [ 6.20797714e-01 -8.94272373e-01  3.58782838e-01]
 [ 9.23439205e-02  2.98959827e-01 -4.67616746e-01]
 [-5.38115603e-01 -4.90164989e-02 -2.94115084e-01]
 [ 6.99628589e-01  5.98675294e-01  5.73072453e-01]
 [ 2.69531564e-01  1.35780740e-01  2.39663650e-01]
 [-1.42237252e-01 -4.67312627e-01  1.59435709e-01]
 [ 2.51196991e-01 -9.28831533e-02 -3.01785484e-01]
 [ 5.81937077e-01  4.08762384e-02  4.14111530e-01]
 [-5.97180144e-02  6.00567837e-02  1.06619603e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 4.51756373e-01 -1.38801010e-01 -1.56183834e-01]
 [-1.46592093e-02 -1.22314074e-01  5.22249988e-03]
 [-2.83728639e-01 -8.60308558e-02  1.76382338e-01]
 [-3.85310040e-02  5.98616183e-02 -1.33015333e-01]
 [ 7.63535229e-01  1.70431736e-01  2.79701526e-01]
 [ 3.04993869e-01  6.98447142e-01 -3.74365851e-01]
 [-3.79956472e-01  1.37515340e-01 -1.94986398e-01]
 [ 3.52623973e+00  2.66881805e+00  2.98466697e-01]
 [-2.99424929e-02 -1.77125335e-01 -3.24531743e-03]
 [ 4.59683308e-02 -9.03112413e-03 -3.82925225e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.30097825]
curr_Stock_Price:  101.21358122484394
curr_Factors:  [101.21358122  -0.90941011  -1.01704697]
mat_Sqrt:  [[14.74311023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00646651 -0.00694634  0.08736218]
Stock Position:  0.006466513511504253
Bond Position:  [10.64647926]


portfolio before change:  [11.30370108]
curr_Stock_Price:  101.42883427778638
curr_Factors:  [101.42883428  -0.626094    -0.9826916 ]
mat_Sqrt:  [[20.29900381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07687697 0.10221733 1.2743033 ]
Stock Position:  0.07687696576379184
Bond Position:  [3.50616006]


portfolio before change:  [11.32441825]
curr_Stock_Price:  101.69261766630534
curr_Factors:  [101.69261767  -0.69059546  -0.99977001]
mat_Sqrt:  [[18.75741696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0099913  0.07738667 0.12265942]
Stock Position:  0.009991301413324303
Bond Position:  [10.30837665]


portfolio before change:  [11.31622437]
curr_Stock_Price:  100.74354192251927
curr_Factors:  [100.74354192  -0.76601203  -0.96970908]
mat_Sqrt:  [[17.75837047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02857726 0.30541469 2.4626694 ]
Stock Position:  0.028577261412774335
Bond Position:  [8.43724984]


portfolio before change:  [11.33241442]
curr_Stock_Price:  101.2731701898147
curr_Factors:  [101.27317019  -0.67721224  -0.96176632]
mat_Sqrt:  [[19.66505028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298225 -0.01106097 -0.05874131]
Stock Position:  -0.002982245156547458
Bond Position:  [11.63443584]


portfolio before change:  [11.33060993]
curr_Stock_Price:  102.36593295765505
curr_Factors:  [102.36593296  -0.87205347  -0.95301832]
mat_Sqrt:  [[16.50200982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00495205 -0.00528392  0.0999774 ]
Stock Position:  0.004952052781981597
Bond Position:  [10.82368843]


portfolio before change:  [11.33238657]
curr_Stock_Price:  102.45147253488419
curr_Factors:  [102.45147253  -0.87457191  -0.95797942]
mat_Sqrt:  [[16.39272971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034222  -0.0384931   0.00607648]
Stock Position:  -0.00342220267454187
Bond Position:  [11.68299627]


portfolio before change:  [11.33001732]
curr_Stock_Price:  103.5705508805054
curr_Factors:  [103.57055088  -1.00267719  -0.93726173]
mat_Sqrt:  [[14.88440645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01107584  0.00897112 -0.54311664]
Stock Position:  0.011075836302713459
Bond Position:  [10.18288686]


portfolio before change:  [11.33028337]
curr_Stock_Price:  103.47964134982374
curr_Factors:  [103.47964135  -0.93725518  -0.93064972]
mat_Sqrt:  [[15.9821104   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0014771   0.01861864 -0.12968132]
Stock Position:  0.0014771019419251052
Bond Position:  [11.17743339]


portfolio before change:  [11.33325341]
curr_Stock_Price:  104.54441258834127
curr_Factors:  [104.54441259  -1.06793591  -0.89706912]
mat_Sqrt:  [[14.65244112  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03649538  0.03151931 -0.53735165]
Stock Position:  -0.03649537948444422
Bond Position:  [15.14864142]


portfolio before change:  [11.27944316]
curr_Stock_Price:  106.07074128791866
curr_Factors:  [106.07074129  -1.10412851  -0.90769692]
mat_Sqrt:  [[14.18635811  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02322307  0.16460127 -0.21689023]
Stock Position:  0.023223069588387577
Bond Position:  [8.81615496]


portfolio before change:  [11.30443637]
curr_Stock_Price:  107.09950816138178
curr_Factors:  [107.09950816  -1.1030401   -0.9248681 ]
mat_Sqrt:  [[14.09542377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061705  0.0058416  -0.17463614]
Stock Position:  -0.0006170457027956015
Bond Position:  [11.37052167]


portfolio before change:  [11.30526671]
curr_Stock_Price:  108.05741485098534
curr_Factors:  [108.05741485  -1.25503128  -0.90766596]
mat_Sqrt:  [[12.42816737  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01053569 -0.01205697  0.15636962]
Stock Position:  0.010535688485885354
Bond Position:  [10.16680744]


portfolio before change:  [11.298196]
curr_Stock_Price:  107.26566414103594
curr_Factors:  [107.26566414  -1.03435377  -0.87086167]
mat_Sqrt:  [[15.96012077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08339295 -0.87883407  6.71972834]
Stock Position:  0.08339294941318826
Bond Position:  [2.35299589]


portfolio before change:  [11.31626574]
curr_Stock_Price:  107.47881880066845
curr_Factors:  [107.4788188   -0.68336411  -0.87412646]
mat_Sqrt:  [[22.64192395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0021508  -0.03395579  0.18607487]
Stock Position:  0.002150802835568698
Bond Position:  [11.08509999]


portfolio before change:  [11.322248]
curr_Stock_Price:  109.61594712051668
curr_Factors:  [109.61594712  -0.62313577  -0.89159882]
mat_Sqrt:  [[24.10087803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00636549 -0.06139158  0.18200018]
Stock Position:  0.00636549064730421
Bond Position:  [10.62448872]


portfolio before change:  [11.33396616]
curr_Stock_Price:  111.24818836799818
curr_Factors:  [111.24818837  -0.6930994   -0.88985068]
mat_Sqrt:  [[22.84685685  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02685964 -0.27745305  0.22591129]
Stock Position:  -0.02685964264759383
Bond Position:  [14.32205275]


portfolio before change:  [11.30455667]
curr_Stock_Price:  112.40977729387637
curr_Factors:  [112.40977729  -0.88349517  -0.87975155]
mat_Sqrt:  [[19.27683662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02915297 -0.47480165 -0.55883651]
Stock Position:  -0.029152973247741434
Bond Position:  [14.5816359]


portfolio before change:  [11.33842274]
curr_Stock_Price:  111.31063525208648
curr_Factors:  [111.31063525  -0.84862194  -0.87284541]
mat_Sqrt:  [[19.90274107  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00110558 0.01144689 0.19700027]
Stock Position:  0.001105575320796574
Bond Position:  [11.21536045]


portfolio before change:  [11.34045315]
curr_Stock_Price:  111.87902462475164
curr_Factors:  [111.87902462  -0.52373188  -0.90046475]
mat_Sqrt:  [[26.92947794  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01899374 -0.28862517  1.02350757]
Stock Position:  0.018993735088389592
Bond Position:  [9.21545259]


portfolio before change:  [11.30491274]
curr_Stock_Price:  109.94720813485495
curr_Factors:  [109.94720813  -0.44296589  -0.89838836]
mat_Sqrt:  [[28.75023889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00201449  0.09648887 -1.33398042]
Stock Position:  0.002014486600215716
Bond Position:  [11.08342556]


portfolio before change:  [11.30622523]
curr_Stock_Price:  109.91095832151939
curr_Factors:  [109.91095832  -0.55076288  -0.90185887]
mat_Sqrt:  [[25.71433995  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0236505  -0.01582001 -0.83902847]
Stock Position:  -0.023650501844842516
Bond Position:  [13.90567455]


portfolio before change:  [11.28506244]
curr_Stock_Price:  110.87927226445157
curr_Factors:  [110.87927226  -0.37201492  -0.90796686]
mat_Sqrt:  [[30.82913542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03045206 0.19322162 1.6348162 ]
Stock Position:  0.03045205723800476
Bond Position:  [7.90856049]


portfolio before change:  [11.23505868]
curr_Stock_Price:  109.20475840581122
curr_Factors:  [109.20475841  -0.22416093  -0.90329961]
mat_Sqrt:  [[35.36646678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00978805 0.04382305 0.68369368]
Stock Position:  0.009788052386031965
Bond Position:  [10.16615678]


portfolio before change:  [11.23896533]
curr_Stock_Price:  109.47404628422287
curr_Factors:  [109.47404628  -0.27650401  -0.90309748]
mat_Sqrt:  [[33.65245488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00609413 -0.1508245   0.4548257 ]
Stock Position:  -0.006094127907431894
Bond Position:  [11.90611417]


portfolio before change:  [11.23789376]
curr_Stock_Price:  109.89411078074833
curr_Factors:  [109.89411078  -0.53176958  -0.92523038]
mat_Sqrt:  [[25.59807916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00666595 -0.02997791 -0.86090999]
Stock Position:  0.006665953023373509
Bond Position:  [10.50534478]


portfolio before change:  [11.2325667]
curr_Stock_Price:  108.89795656910732
curr_Factors:  [108.89795657  -0.47152591  -0.91965577]
mat_Sqrt:  [[27.09175906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02490835 0.01319275 1.18134493]
Stock Position:  0.02490835183577731
Bond Position:  [8.52009808]


portfolio before change:  [11.24907053]
curr_Stock_Price:  109.51777919335832
curr_Factors:  [109.51777919  -0.32663157  -0.92036105]
mat_Sqrt:  [[31.47187495  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00081645  0.01938324  0.30415605]
Stock Position:  -0.0008164540406116271
Bond Position:  [11.33848677]


portfolio before change:  [11.25027288]
curr_Stock_Price:  109.7811809684768
curr_Factors:  [109.78118097  -0.32007893  -0.93560185]
mat_Sqrt:  [[31.27466471  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109928 -0.02600141 -0.03673698]
Stock Position:  -0.0010992750851535938
Bond Position:  [11.3709526]


portfolio before change:  [11.25160139]
curr_Stock_Price:  109.86573679808119
curr_Factors:  [ 1.09865737e+02 -2.86097926e-02 -9.31483651e-01]
mat_Sqrt:  [[42.06287835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00930851 -0.04479783 -0.44554901]
Stock Position:  0.009308512847446692
Bond Position:  [10.22891476]


portfolio before change:  [11.2499059]
curr_Stock_Price:  109.54622453858649
curr_Factors:  [ 1.09546225e+02 -7.58718808e-02 -9.26295468e-01]
mat_Sqrt:  [[40.21255473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095892 -0.0394767   0.01489834]
Stock Position:  -0.0009589151215579626
Bond Position:  [11.35495143]


portfolio before change:  [11.25083648]
curr_Stock_Price:  110.0560501907007
curr_Factors:  [110.05605019  -0.28898882  -0.91472714]
mat_Sqrt:  [[33.02529628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0080328  -0.02776634  0.50316971]
Stock Position:  -0.008032803639705207
Bond Position:  [12.13489512]


portfolio before change:  [11.24383112]
curr_Stock_Price:  111.11698854686021
curr_Factors:  [111.11698855  -0.25188395  -0.88583982]
mat_Sqrt:  [[35.61830998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150101  0.01932025 -0.37945572]
Stock Position:  -0.0015010101144454107
Bond Position:  [11.41061885]


portfolio before change:  [11.24340275]
curr_Stock_Price:  112.35268012724738
curr_Factors:  [112.35268013  -0.46090932  -0.87760763]
mat_Sqrt:  [[29.46272492  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02903392 0.05500661 0.7979106 ]
Stock Position:  0.029033916529022184
Bond Position:  [7.98136442]


portfolio before change:  [11.31332786]
curr_Stock_Price:  114.7267095214479
curr_Factors:  [114.72670952  -0.54906174  -0.87088708]
mat_Sqrt:  [[27.73247312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01338311  0.22542285 -1.06796157]
Stock Position:  0.013383108080003748
Bond Position:  [9.7779279]


portfolio before change:  [11.3233919]
curr_Stock_Price:  115.38737223119755
curr_Factors:  [115.38737223  -0.82254875  -0.85375833]
mat_Sqrt:  [[21.58476701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01814649  0.04438289 -0.55624192]
Stock Position:  -0.01814648737828876
Bond Position:  [13.41726739]


portfolio before change:  [11.318667]
curr_Stock_Price:  115.74017677832845
curr_Factors:  [115.74017678  -0.99841317  -0.83911115]
mat_Sqrt:  [[18.42712021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.22423114 0.86135732 0.85144241]
Stock Position:  0.2242311413558753
Bond Position:  [-14.63388494]


portfolio before change:  [11.30109072]
curr_Stock_Price:  115.66995046052094
curr_Factors:  [115.66995046  -0.82425715  -0.85403164]
mat_Sqrt:  [[21.59479035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309151 -0.05716696 -0.00925799]
Stock Position:  -0.0030915094402105357
Bond Position:  [11.65868546]


portfolio before change:  [11.29648448]
curr_Stock_Price:  117.63134424847833
curr_Factors:  [117.63134425  -0.75422371  -0.86924444]
mat_Sqrt:  [[23.19849446  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146731 -0.00291478 -1.09237908]
Stock Position:  -0.0014673117716965548
Bond Position:  [11.46908633]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.29748229]
Stock Price:  117.9284292876997
PL:  [-6.630947]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-1.89727645e-02 -7.49220888e-02  1.65415822e-01]
 [ 1.15611113e+00  2.33003620e-01  3.26144484e-01]
 [-1.76467136e-02  7.76441922e-02  3.40244798e-02]
 [ 9.05104345e-02  7.91069115e-01  5.92762671e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 3.30364928e-02 -7.68277912e-03  1.52976762e-02]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [-1.81793465e-02  2.33606391e-01 -3.60125363e-02]
 [ 1.53834569e-02  6.38858674e-02 -4.64004565e-02]
 [-1.16850110e-01 -5.99652151e-02 -2.71424736e-02]
 [ 8.69291117e-01  1.66789857e+00 -3.03433303e-01]
 [-1.45049545e-04  9.64225769e-03 -2.56596051e-02]
 [-2.60263715e-01  1.28677647e-04 -5.32368593e-01]
 [ 1.65201279e+00 -3.06657304e+00  2.57345490e+00]
 [-5.17318278e-03 -9.38116100e-02  3.67496657e-02]
 [ 1.30222117e-01 -2.86526166e-03 -3.42979577e-02]
 [-2.87024453e-02  6.32829178e-02 -8.49612173e-02]
 [-2.84131073e-01 -1.82972178e+00 -1.97003450e-01]
 [ 1.82638208e-02 -1.12799329e-01  2.84184133e-01]
 [ 1.13929721e-01  2.73093746e-01  3.49998153e-01]
 [ 2.90154262e-02 -3.26213828e-02  3.65156943e-02]
 [ 1.05535147e-01 -5.04528946e-02  2.16847366e-02]
 [ 4.82688871e-02 -7.97485267e-02 -6.18389650e-02]
 [-5.43586898e-02 -5.81086936e-02  8.13199069e-02]
 [ 2.63615056e-02 -9.14385396e-02  1.92403226e-02]
 [ 5.21928095e-02 -6.51555028e-03  1.59063618e-01]
 [ 1.88992841e-01 -8.88770664e-02  7.66539260e-02]
 [-8.99135980e-02  5.71011259e-02  1.40831500e-01]
 [-2.11205389e-03 -6.77721755e-02  9.27032664e-03]
 [ 5.09240574e-02  1.28910526e-02  9.38572632e-02]
 [-2.34259162e-02 -5.77227230e-02 -3.68480711e-02]
 [ 6.17186454e-02  2.76862027e-02 -7.98751227e-02]
 [-3.82349150e-02  5.07802493e-02 -1.22129531e-01]
 [ 5.38058186e-01  1.05444981e-01  1.58227081e-01]
 [ 1.36022283e-01  1.53751660e-01 -1.09833902e-01]
 [ 1.69909042e-02  3.20069068e-02  6.84544817e-02]
 [ 2.12648183e+00  1.54209227e+00  1.95055617e-01]
 [-1.13101522e-01  2.11622603e-02 -1.87388849e-03]
 [ 3.94295572e-02 -1.20327124e-02 -2.12116025e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.92218921]
curr_Stock_Price:  100.07019826981632
curr_Factors:  [100.07019827  -0.90256778  -1.01583432]
mat_Sqrt:  [[14.69444917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.40814751e-05 -2.41810002e-02  4.71885298e-01]
Stock Position:  -3.408147505020389e-05
Bond Position:  [2.92559975]


portfolio before change:  [2.92253912]
curr_Stock_Price:  100.5341996428268
curr_Factors:  [100.53419964  -0.90833808  -1.03337558]
mat_Sqrt:  [[14.42242526  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08807442 0.07520159 0.93039943]
Stock Position:  0.08807442120931892
Bond Position:  [-5.93195233]


portfolio before change:  [2.97605731]
curr_Stock_Price:  101.15026656107807
curr_Factors:  [101.15026656  -1.37063673  -1.04845111]
mat_Sqrt:  [[ 9.00265337  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00057178 0.02505956 0.09706237]
Stock Position:  0.0005717823844790915
Bond Position:  [2.91822137]


portfolio before change:  [2.97670554]
curr_Stock_Price:  101.64596429744249
curr_Factors:  [101.6459643   -1.35833232  -1.03999234]
mat_Sqrt:  [[ 9.23657531  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04038119 0.25531646 1.69098691]
Stock Position:  0.04038119133792309
Bond Position:  [-1.12787959]


portfolio before change:  [2.96691203]
curr_Stock_Price:  101.40692930995549
curr_Factors:  [101.40692931  -0.8111295   -1.01676887]
mat_Sqrt:  [[16.30127051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359763 -0.01106097 -0.05874131]
Stock Position:  -0.0035976337495931847
Bond Position:  [3.33173702]


portfolio before change:  [2.96975488]
curr_Stock_Price:  100.73249925725638
curr_Factors:  [100.73249926  -0.67462442  -1.02291747]
mat_Sqrt:  [[18.44745801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0018751  -0.00247961  0.04364001]
Stock Position:  0.0018751026390548774
Bond Position:  [2.7808711]


portfolio before change:  [2.97001247]
curr_Stock_Price:  100.6844821327636
curr_Factors:  [100.68448213  -0.79796152  -0.9990941 ]
mat_Sqrt:  [[16.6921086   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00397136 -0.00251018 -0.21167328]
Stock Position:  -0.003971357034620015
Bond Position:  [3.3698665]


portfolio before change:  [2.97169771]
curr_Stock_Price:  100.3662074799372
curr_Factors:  [100.36620748  -0.80530429  -0.99080388]
mat_Sqrt:  [[16.65511543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133018  0.07539614 -0.10273374]
Stock Position:  0.001330181723317016
Bond Position:  [2.83819242]


portfolio before change:  [2.97249484]
curr_Stock_Price:  100.69874445526474
curr_Factors:  [100.69874446  -0.9178284   -1.00369814]
mat_Sqrt:  [[14.74061773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128574  0.02061908 -0.13236759]
Stock Position:  0.0012857433694613849
Bond Position:  [2.8430221]


portfolio before change:  [2.97295647]
curr_Stock_Price:  100.78136280670068
curr_Factors:  [100.78136281  -0.77394073  -1.0087975 ]
mat_Sqrt:  [[16.94910811  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00794324 -0.01935369 -0.07742992]
Stock Position:  -0.00794324350452992
Bond Position:  [3.77348738]


portfolio before change:  [2.97524033]
curr_Stock_Price:  100.55322598528218
curr_Factors:  [100.55322599  -0.9780272   -0.99265418]
mat_Sqrt:  [[14.01328514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0819088   0.53831195 -0.86561076]
Stock Position:  0.08190880391534408
Bond Position:  [-5.26095414]


portfolio before change:  [2.91302206]
curr_Stock_Price:  99.80165091497915
curr_Factors:  [99.80165091 -1.01265383 -1.01682467]
mat_Sqrt:  [[13.1143391   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026037  0.00311203 -0.07319971]
Stock Position:  -0.00026036972789788773
Bond Position:  [2.93900739]


portfolio before change:  [2.91315951]
curr_Stock_Price:  100.68480900949294
curr_Factors:  [100.68480901  -0.84744765  -1.01614994]
mat_Sqrt:  [[15.6175823   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.36212446e-02  4.15305319e-05 -1.51869941e+00]
Stock Position:  -0.023621244646413474
Bond Position:  [5.29146001]


portfolio before change:  [2.90695572]
curr_Stock_Price:  100.97544823670094
curr_Factors:  [100.97544824  -0.6294434   -1.01528202]
mat_Sqrt:  [[19.49488223  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07957758 -0.98973219  7.3413505 ]
Stock Position:  0.07957757603082248
Bond Position:  [-5.12842569]


portfolio before change:  [2.90446956]
curr_Stock_Price:  100.95226245511536
curr_Factors:  [100.95226246  -0.83909994  -1.02273365]
mat_Sqrt:  [[15.68671487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010723  -0.03027757  0.10483657]
Stock Position:  -0.0010723024881114818
Bond Position:  [3.01272092]


portfolio before change:  [2.90588835]
curr_Stock_Price:  99.98035705330116
curr_Factors:  [99.98035705 -0.76260625 -1.03112702]
mat_Sqrt:  [[16.63053507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00737416 -0.00092476 -0.09784253]
Stock Position:  0.007374158804206273
Bond Position:  [2.16861732]


portfolio before change:  [2.8988112]
curr_Stock_Price:  98.98387110996296
curr_Factors:  [98.98387111 -0.77310371 -1.05580286]
mat_Sqrt:  [[15.89572726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208405  0.02042447 -0.2423707 ]
Stock Position:  -0.002084051211344488
Bond Position:  [3.10509866]


portfolio before change:  [2.90025953]
curr_Stock_Price:  98.47516560650838
curr_Factors:  [98.47516561 -1.02043366 -1.05706799]
mat_Sqrt:  [[12.33329773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05658135 -0.59054017 -0.56199601]
Stock Position:  -0.05658134940279259
Bond Position:  [8.47211728]


portfolio before change:  [2.93450865]
curr_Stock_Price:  97.8885758702115
curr_Factors:  [97.88857587 -1.0512667  -1.05882643]
mat_Sqrt:  [[11.86670661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00448714 -0.03640583  0.81069823]
Stock Position:  0.00448714198716423
Bond Position:  [2.49526871]


portfolio before change:  [2.93529374]
curr_Stock_Price:  97.99402521500328
curr_Factors:  [97.99402522 -1.04014221 -1.03985856]
mat_Sqrt:  [[12.24240494  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0196953  0.08814063 0.99844731]
Stock Position:  0.01969529869127138
Bond Position:  [1.00527215]


portfolio before change:  [2.94027282]
curr_Stock_Price:  98.24044982450346
curr_Factors:  [98.24044982 -0.95180701 -1.04364539]
mat_Sqrt:  [[13.355999    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00223198 -0.01052851  0.10416911]
Stock Position:  0.0022319819889126025
Bond Position:  [2.7210019]


portfolio before change:  [2.94235878]
curr_Stock_Price:  99.02263401773739
curr_Factors:  [99.02263402 -0.68832159 -1.03606285]
mat_Sqrt:  [[17.65402874  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00564533 -0.0162836   0.06186052]
Stock Position:  0.005645333024034066
Bond Position:  [2.38334304]


portfolio before change:  [2.93052015]
curr_Stock_Price:  96.87279212693986
curr_Factors:  [96.87279213 -0.67837308 -1.03804281]
mat_Sqrt:  [[17.40892143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011125  -0.02573873 -0.17640935]
Stock Position:  0.0011125020840665953
Bond Position:  [2.82274896]


portfolio before change:  [2.93279611]
curr_Stock_Price:  98.60141895825451
curr_Factors:  [98.60141896 -0.50908199 -1.05809362]
mat_Sqrt:  [[20.57157032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0024121  -0.0187545   0.23198306]
Stock Position:  -0.002412101749337049
Bond Position:  [3.17063277]


portfolio before change:  [2.93123438]
curr_Stock_Price:  99.41319739077547
curr_Factors:  [99.41319739 -0.54953261 -1.07554322]
mat_Sqrt:  [[19.57413487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00059385 -0.02951166  0.05488728]
Stock Position:  0.0005938503198315336
Bond Position:  [2.87219782]


portfolio before change:  [2.93250148]
curr_Stock_Price:  100.94229394557955
curr_Factors:  [100.94229395  -0.58660122  -1.075288  ]
mat_Sqrt:  [[19.15683912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00434996 -0.00210288  0.45376423]
Stock Position:  0.004349963622371681
Bond Position:  [2.49340617]


portfolio before change:  [2.93287187]
curr_Stock_Price:  100.955787936189
curr_Factors:  [100.95578794  -0.592472    -1.08905177]
mat_Sqrt:  [[18.78688289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00992702 -0.02868495  0.21867231]
Stock Position:  0.009927022187602188
Bond Position:  [1.93068152]


portfolio before change:  [2.92751736]
curr_Stock_Price:  100.39208824887385
curr_Factors:  [100.39208825  -0.69858475  -1.12226039]
mat_Sqrt:  [[16.25236217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304637  0.01842931  0.40175307]
Stock Position:  -0.0030463737805183377
Bond Position:  [3.23334919]


portfolio before change:  [2.92732146]
curr_Stock_Price:  100.58907475410692
curr_Factors:  [100.58907475  -0.55258153  -1.12741988]
mat_Sqrt:  [[18.74715942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00074964 -0.02187338  0.02644566]
Stock Position:  -0.000749643904599193
Bond Position:  [3.00272745]


portfolio before change:  [2.92629091]
curr_Stock_Price:  102.46452420686846
curr_Factors:  [102.46452421  -0.65259765  -1.13102695]
mat_Sqrt:  [[17.21691004  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0042234  0.00416057 0.26774865]
Stock Position:  0.004223403965924506
Bond Position:  [2.49354183]


portfolio before change:  [2.9307979]
curr_Stock_Price:  103.45786637641763
curr_Factors:  [103.45786638  -0.82162549  -1.11013003]
mat_Sqrt:  [[14.99038391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028505  -0.01862993 -0.10511729]
Stock Position:  -0.002850500628014313
Bond Position:  [3.22570462]


portfolio before change:  [2.92833187]
curr_Stock_Price:  104.4644500228808
curr_Factors:  [104.46445002  -0.78557339  -1.14378389]
mat_Sqrt:  [[15.17257543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00336565  0.00893568 -0.22786149]
Stock Position:  0.0033656531757295795
Bond Position:  [2.57674077]


portfolio before change:  [2.9332642]
curr_Stock_Price:  105.83423251153809
curr_Factors:  [105.83423251  -1.20150197  -1.16202629]
mat_Sqrt:  [[ 9.95769647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00530233  0.01638925 -0.34840156]
Stock Position:  -0.005302333354534118
Bond Position:  [3.49443258]


portfolio before change:  [2.93233144]
curr_Stock_Price:  106.09253262089024
curr_Factors:  [106.09253262  -1.13949337  -1.12939533]
mat_Sqrt:  [[10.97283827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05394047 0.03403222 0.45137782]
Stock Position:  0.05394046701293994
Bond Position:  [-2.79034932]


portfolio before change:  [2.96950195]
curr_Stock_Price:  106.78810174313901
curr_Factors:  [106.78810174  -0.86970453  -1.12847312]
mat_Sqrt:  [[14.47855909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01001391  0.04962314 -0.31332555]
Stock Position:  0.010013907974875495
Bond Position:  [1.90013572]


portfolio before change:  [2.9718553]
curr_Stock_Price:  106.99939036579727
curr_Factors:  [106.99939037  -0.98495282  -1.11563192]
mat_Sqrt:  [[13.09510371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00286347 0.01033018 0.19528158]
Stock Position:  0.002863474780931415
Bond Position:  [2.66546525]


portfolio before change:  [2.97122551]
curr_Stock_Price:  106.66308705465086
curr_Factors:  [106.66308705  -1.09024371  -1.08683451]
mat_Sqrt:  [[12.09263908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.20517239 0.49770814 0.55643938]
Stock Position:  0.20517238988003342
Bond Position:  [-18.91309497]


portfolio before change:  [3.12840029]
curr_Stock_Price:  107.44067248734864
curr_Factors:  [107.44067249  -1.08861254  -1.09577612]
mat_Sqrt:  [[12.0920734   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00902776  0.00683009 -0.00534568]
Stock Position:  -0.009027756961455979
Bond Position:  [4.09834857]


portfolio before change:  [3.12531699]
curr_Stock_Price:  107.83895805798447
curr_Factors:  [107.83895806  -0.97962318  -1.11763505]
mat_Sqrt:  [[13.24182996  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.77623736e-04 -3.88354121e-03 -6.05107978e-01]
Stock Position:  -0.0004776237357903575
Bond Position:  [3.17682343]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.1262058]
Stock Price:  106.80951065617239
PL:  [-3.68330485]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 9.97297105e-02 -4.51861395e-02 -6.30811216e-02]
 [ 1.19767902e+00  2.46117437e-01  3.41759479e-01]
 [-3.80635132e-01 -2.63896385e-01  4.08992070e-02]
 [ 2.32855826e-01  1.30711142e+00  1.40734723e+00]
 [-4.75005648e-02 -3.39881180e-02 -2.01576351e-02]
 [-1.63776864e-02  2.36167184e-01 -1.02778124e-01]
 [-9.43653614e-02  6.10802033e-02  7.49609408e-02]
 [-4.03175999e-02  7.49202914e-02  2.05634417e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 8.52997375e-01  1.69673463e+00 -2.82708374e-01]
 [-2.39929089e-04  7.39973750e-03 -1.13066476e-02]
 [-3.23061518e-01 -2.81492358e-04 -6.96372585e-01]
 [ 1.79525712e+00 -3.15064836e+00  2.65439915e+00]
 [ 1.34455757e-03 -9.27128786e-02  3.60738339e-02]
 [ 1.21964436e-01  4.44532264e-02 -5.76696730e-02]
 [ 5.02184961e-03  2.07811598e-01 -1.18652314e-02]
 [-2.79467924e-01 -1.81721930e+00 -2.02079867e-01]
 [ 1.30094623e-03  3.72499194e-02  5.83893053e-02]
 [ 2.00126787e-01 -3.16644114e-01  1.78264455e-01]
 [ 5.66621032e-02  9.60012614e-02 -2.08987979e-02]
 [-1.39090424e-02 -5.30697371e-02 -9.61536899e-02]
 [ 2.49821720e-01  2.68100475e-01  2.44798318e-01]
 [-1.95502295e-01  6.52584335e-02  6.58541987e-02]
 [-9.43380796e-02 -2.80054880e-01  1.04335761e-01]
 [ 1.43516864e-01 -3.43834882e-02 -1.44239411e-01]
 [ 4.21527871e-01 -3.32429440e-02  2.53659932e-01]
 [-5.97518758e-02  5.50799025e-02  1.06317397e-01]
 [-1.31369482e-02 -7.84596955e-02 -9.23670291e-03]
 [ 2.07110497e-01 -4.51404642e-02 -4.55492634e-03]
 [-2.19536966e-02 -4.74149416e-02 -4.32317620e-02]
 [ 9.51851608e-02  2.31137478e-02 -8.58435872e-02]
 [-8.36876940e-02 -4.82418728e-02  1.74114236e-02]
 [ 2.67923846e-01  2.78194824e-02  5.63780006e-02]
 [ 8.67720226e-02 -6.74014794e-03 -3.02547294e-02]
 [-9.04921788e-02 -2.32096698e-02 -1.08526539e-01]
 [ 1.67376245e+00  1.17124270e+00  1.60354800e-01]
 [-4.27953074e-02 -2.49202552e-02 -2.79129249e-02]
 [ 3.53504810e-02 -1.34481741e-02 -1.11126910e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.6211066]
curr_Stock_Price:  100.71142005272733
curr_Factors:  [100.71142005  -1.09201603  -1.02398553]
mat_Sqrt:  [[12.13698784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00639613 -0.01458376 -0.17995288]
Stock Position:  0.0063961296952278505
Bond Position:  [6.97694329]


portfolio before change:  [7.62282373]
curr_Stock_Price:  100.84352451461884
curr_Factors:  [100.84352451  -0.73577797  -1.04902226]
mat_Sqrt:  [[16.92462786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07785571 0.07943406 0.97494467]
Stock Position:  0.07785570840215046
Bond Position:  [-0.22842031]


portfolio before change:  [7.48726376]
curr_Stock_Price:  99.1027219888719
curr_Factors:  [99.10272199 -0.4575332  -1.05769019]
mat_Sqrt:  [[21.77872369  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01956746 -0.08517219  0.11667405]
Stock Position:  -0.01956745703960257
Bond Position:  [9.42645201]


portfolio before change:  [7.49829163]
curr_Stock_Price:  98.59936118793001
curr_Factors:  [98.59936119 -0.51592693 -1.07019379]
mat_Sqrt:  [[20.18508696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03898633 0.4218684  4.01476991]
Stock Position:  0.03898632577791501
Bond Position:  [3.65426481]


portfolio before change:  [7.50009447]
curr_Stock_Price:  98.63388682181781
curr_Factors:  [98.63388682 -0.64357378 -1.04419208]
mat_Sqrt:  [[18.24058426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00321004 -0.01096962 -0.05750412]
Stock Position:  -0.003210040837784375
Bond Position:  [7.81671327]


portfolio before change:  [7.49974197]
curr_Stock_Price:  99.04810316963082
curr_Factors:  [99.04810317 -0.70700404 -1.03487656]
mat_Sqrt:  [[17.35229937  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00062529  0.07622263 -0.29319738]
Stock Position:  0.0006252912821664077
Bond Position:  [7.43780805]


portfolio before change:  [7.49959564]
curr_Stock_Price:  97.32712646220452
curr_Factors:  [97.32712646 -0.54124777 -1.05292008]
mat_Sqrt:  [[19.7649445   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033694   0.01971355  0.2138427 ]
Stock Position:  -0.0033694038023274375
Bond Position:  [7.82753003]


portfolio before change:  [7.49897369]
curr_Stock_Price:  97.80212216050832
curr_Factors:  [97.80212216 -0.63554996 -1.02773482]
mat_Sqrt:  [[18.53501224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112366  0.02418042  0.05866178]
Stock Position:  -0.0011236606814966443
Bond Position:  [7.60887009]


portfolio before change:  [7.50029651]
curr_Stock_Price:  97.47137500648785
curr_Factors:  [97.47137501 -0.55190959 -1.0055132 ]
mat_Sqrt:  [[20.53510685  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00253182  0.0064198  -0.11330016]
Stock Position:  0.0025318204439116867
Bond Position:  [7.25351649]


portfolio before change:  [7.50113215]
curr_Stock_Price:  97.44328965706912
curr_Factors:  [97.44328966 -0.53989848 -1.02947959]
mat_Sqrt:  [[20.28521896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.30889727e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  4.3088972744935794e-05
Bond Position:  [7.49693341]


portfolio before change:  [7.50212598]
curr_Stock_Price:  98.7582737556485
curr_Factors:  [98.75827376 -0.78477304 -1.04014025]
mat_Sqrt:  [[15.92295689  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07169738  0.54761875 -0.8064883 ]
Stock Position:  0.07169737900576416
Bond Position:  [0.4214166]


portfolio before change:  [7.57706707]
curr_Stock_Price:  99.80278062587048
curr_Factors:  [99.80278063 -0.87742788 -1.06798857]
mat_Sqrt:  [[14.26458072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.27272527e-05  2.38825501e-03 -3.22547184e-02]
Stock Position:  -7.27272526592149e-05
Bond Position:  [7.58432545]


portfolio before change:  [7.57804917]
curr_Stock_Price:  99.3351788292853
curr_Factors:  [99.33517883 -0.90790403 -1.07122075]
mat_Sqrt:  [[13.72714143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.38938328e-02 -9.08512678e-05 -1.98655715e+00]
Stock Position:  -0.03389383280634612
Bond Position:  [10.94489912]


portfolio before change:  [7.56377247]
curr_Stock_Price:  99.79676426167656
curr_Factors:  [99.79676426 -0.80359725 -1.09716715]
mat_Sqrt:  [[14.91505888  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11357385 -1.01686739  7.57226193]
Stock Position:  0.11357385059383393
Bond Position:  [-3.77053032]


portfolio before change:  [7.62873616]
curr_Stock_Price:  100.37290951092271
curr_Factors:  [100.37290951  -0.77194504  -1.09098587]
mat_Sqrt:  [[15.57958537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00065578 -0.02992295  0.10290861]
Stock Position:  -0.0006557837577885332
Bond Position:  [7.69455909]


portfolio before change:  [7.63030924]
curr_Stock_Price:  99.4408976830287
curr_Factors:  [99.44089768 -0.44230675 -1.07775461]
mat_Sqrt:  [[21.74757192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00548414  0.01434722 -0.16451552]
Stock Position:  0.0054841359118206
Bond Position:  [7.08496184]


portfolio before change:  [7.62344974]
curr_Stock_Price:  98.0286103298572
curr_Factors:  [98.02861033 -0.23929019 -1.11898603]
mat_Sqrt:  [[25.20350718  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00178623  0.0670709  -0.0338482 ]
Stock Position:  0.0017862289548990047
Bond Position:  [7.4483482]


portfolio before change:  [7.6285661]
curr_Stock_Price:  100.3716825132089
curr_Factors:  [100.37168251  -0.48797641  -1.13153124]
mat_Sqrt:  [[19.87320746  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03480342 -0.58650501 -0.57647761]
Stock Position:  -0.03480342276954741
Bond Position:  [11.12184421]


portfolio before change:  [7.59524741]
curr_Stock_Price:  101.36896988088445
curr_Factors:  [101.36896988  -0.51660641  -1.11706804]
mat_Sqrt:  [[19.78833403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0010523  0.01202236 0.16656844]
Stock Position:  0.0010522978431746956
Bond Position:  [7.48857706]


portfolio before change:  [7.5971011]
curr_Stock_Price:  102.2409327112285
curr_Factors:  [102.24093271  -0.42903184  -1.13331617]
mat_Sqrt:  [[21.43412118  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.008019   -0.10219645  0.50853887]
Stock Position:  0.008018997169584523
Bond Position:  [6.77723135]


portfolio before change:  [7.6088835]
curr_Stock_Price:  103.60459302042045
curr_Factors:  [103.60459302  -0.45632312  -1.12296027]
mat_Sqrt:  [[21.35526416  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00337117  0.03098427 -0.05961845]
Stock Position:  0.003371174848059274
Bond Position:  [7.2596143]


portfolio before change:  [7.61111169]
curr_Stock_Price:  103.9963500231272
curr_Factors:  [103.99635002  -0.63280092  -1.1212666 ]
mat_Sqrt:  [[17.99849754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00246516 -0.01712818 -0.27429971]
Stock Position:  -0.002465158369287853
Bond Position:  [7.86747916]


portfolio before change:  [7.61165069]
curr_Stock_Price:  104.17665923837866
curr_Factors:  [104.17665924  -0.94482012  -1.12562116]
mat_Sqrt:  [[13.13981351  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02698035 0.08652906 0.69834146]
Stock Position:  0.026980348521315776
Bond Position:  [4.80092812]


portfolio before change:  [7.61309511]
curr_Stock_Price:  104.20795086812525
curr_Factors:  [104.20795087  -0.64371853  -1.12556735]
mat_Sqrt:  [[17.76273205  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00949961  0.02106207  0.1878637 ]
Stock Position:  -0.009499610789885442
Bond Position:  [8.60303008]


portfolio before change:  [7.60997012]
curr_Stock_Price:  104.65011926388793
curr_Factors:  [104.65011926  -0.76360093  -1.10530867]
mat_Sqrt:  [[16.1466563   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.008064   -0.09038732  0.29764088]
Stock Position:  -0.008063997415322977
Bond Position:  [8.45386842]


portfolio before change:  [7.60846431]
curr_Stock_Price:  104.96790442990877
curr_Factors:  [104.96790443  -0.4219147   -1.12225375]
mat_Sqrt:  [[22.40952718  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00477724 -0.01109722 -0.41147489]
Stock Position:  0.004777236762171847
Bond Position:  [7.10700777]


portfolio before change:  [7.60893394]
curr_Stock_Price:  104.88023966969932
curr_Factors:  [104.88023967  -0.60844483  -1.11175855]
mat_Sqrt:  [[18.77668124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02484573 -0.01072911  0.72362118]
Stock Position:  0.024845727222880337
Bond Position:  [5.00310812]


portfolio before change:  [7.590372]
curr_Stock_Price:  104.10797925397412
curr_Factors:  [104.10797925  -0.5888499   -1.11646976]
mat_Sqrt:  [[18.91790763  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141701  0.01777696  0.30329394]
Stock Position:  -0.001417006070169906
Bond Position:  [7.73789364]


portfolio before change:  [7.591566]
curr_Stock_Price:  103.94798846240997
curr_Factors:  [103.94798846  -0.49763345  -1.12397513]
mat_Sqrt:  [[20.53810807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151123 -0.02532276 -0.02634974]
Stock Position:  -0.00151123465219492
Bond Position:  [7.74865581]


portfolio before change:  [7.59034268]
curr_Stock_Price:  105.39843536559611
curr_Factors:  [105.39843537  -0.36687056  -1.13068802]
mat_Sqrt:  [[23.57505625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00835487 -0.01456902 -0.01299394]
Stock Position:  0.008354867368306844
Bond Position:  [6.70975273]


portfolio before change:  [7.56682683]
curr_Stock_Price:  102.48341325149772
curr_Factors:  [102.48341325  -0.41627475  -1.12298108]
mat_Sqrt:  [[21.98686296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184005 -0.01530311 -0.12332818]
Stock Position:  -0.001840047742154506
Bond Position:  [7.7554012]


portfolio before change:  [7.56522295]
curr_Stock_Price:  103.8819418956312
curr_Factors:  [103.8819419   -0.47257416  -1.13266483]
mat_Sqrt:  [[20.86381021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00394849  0.00745993 -0.24488786]
Stock Position:  0.003948487124737757
Bond Position:  [7.15504644]


portfolio before change:  [7.56536]
curr_Stock_Price:  103.69012388118689
curr_Factors:  [103.69012388  -0.6269342   -1.11796381]
mat_Sqrt:  [[18.11080763  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00496836 -0.01557     0.04966995]
Stock Position:  -0.004968355634963568
Bond Position:  [8.08052941]


portfolio before change:  [7.57414303]
curr_Stock_Price:  102.12564182177923
curr_Factors:  [102.12564182  -0.42843137  -1.13248814]
mat_Sqrt:  [[21.44055729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01329772 0.0089787  0.16083074]
Stock Position:  0.013297722692526404
Bond Position:  [6.21610457]


portfolio before change:  [7.58446407]
curr_Stock_Price:  102.84335685294612
curr_Factors:  [102.84335685  -0.52274607  -1.1427096 ]
mat_Sqrt:  [[19.4481384   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00407342 -0.00217537 -0.08630832]
Stock Position:  0.004073422003948616
Bond Position:  [7.16553968]


portfolio before change:  [7.58678565]
curr_Stock_Price:  103.19338912946974
curr_Factors:  [103.19338913  -0.68137824  -1.16439779]
mat_Sqrt:  [[16.29451849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00720382 -0.00749089 -0.30959601]
Stock Position:  -0.007203816413807246
Bond Position:  [8.33017188]


portfolio before change:  [7.58713943]
curr_Stock_Price:  103.28883200580609
curr_Factors:  [103.28883201  -0.54417029  -1.14865918]
mat_Sqrt:  [[19.00495591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10237191 0.37801696 0.45744761]
Stock Position:  0.10237191074958701
Bond Position:  [-2.98673566]


portfolio before change:  [7.54766687]
curr_Stock_Price:  102.906899188772
curr_Factors:  [102.90689919  -0.47200951  -1.15899134]
mat_Sqrt:  [[20.14233533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266006 -0.00804298 -0.07962781]
Stock Position:  -0.002660060727470723
Bond Position:  [7.82140547]


portfolio before change:  [7.5519375]
curr_Stock_Price:  101.6689999883728
curr_Factors:  [101.66899999  -0.57445344  -1.11468235]
mat_Sqrt:  [[18.77613497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00052842 -0.00434038 -0.31701414]
Stock Position:  0.0005284207096066658
Bond Position:  [7.49821349]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.55352706]
Stock Price:  102.90328852549852
PL:  [4.65023853]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 6.40403394e-02 -3.46039948e-02  6.59562924e-02]
 [ 1.20700681e+00  2.31478793e-01  3.43007193e-01]
 [-2.01419455e-01 -9.89320541e-02  3.56717412e-02]
 [ 1.49949468e-01  1.24608056e+00  9.77437674e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 1.47553535e-02  7.04917026e-02 -1.20775967e-02]
 [-6.15545851e-02  2.57945079e-02 -5.10910925e-02]
 [-6.30567101e-02  1.24201658e-01  1.10036637e-03]
 [ 1.67752566e-02  6.23797152e-02 -4.61716334e-02]
 [-6.38198787e-02 -2.70357431e-02  9.51221856e-03]
 [ 8.35760913e-01  1.67336056e+00 -2.74358606e-01]
 [-7.52099262e-04  2.20408570e-02  4.89899450e-02]
 [-3.18398189e-01  5.24230726e-04 -6.88691761e-01]
 [ 1.78414920e+00 -3.29190383e+00  2.76858079e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.43236376e-01 -5.43512125e-02  4.38844092e-04]
 [-1.14380891e-01 -1.25053204e-01 -4.65189558e-02]
 [-2.66765345e-01 -1.74694415e+00 -2.02825189e-01]
 [ 1.30094623e-03  3.72499194e-02  5.83893053e-02]
 [ 1.71637709e-01 -1.65662545e-01  2.35586131e-01]
 [ 4.51193880e-02 -1.84003130e-02  9.06322850e-02]
 [ 1.38116266e-01 -5.32864182e-02 -1.36672177e-02]
 [ 1.76852766e-01  1.67534494e-01  1.65017452e-01]
 [-2.48159686e-01  8.29820072e-02  2.42289225e-02]
 [-1.54105865e-02 -1.44028994e-01  4.88217038e-02]
 [ 4.99214728e-02 -6.81805157e-03  1.49836757e-01]
 [ 1.89982609e-01 -9.54588229e-02  7.86435266e-02]
 [-1.03336211e-01  6.93722104e-02  1.58186749e-01]
 [ 1.86467080e-02 -4.76486554e-02  4.41171929e-02]
 [-4.47532088e-02  8.66258419e-02  1.42158716e-02]
 [ 1.69383055e-02 -1.52565998e-02 -7.33743230e-02]
 [-2.17358297e-02  2.13337561e-02 -5.33415774e-02]
 [-1.01536402e-01 -3.19172074e-02  4.01170192e-02]
 [-1.57876207e-02  2.24109330e-03  1.93970083e-03]
 [-3.62068620e-02  1.51644622e-02  1.46589344e-02]
 [-1.15891204e-01 -6.45726028e-02 -8.22957915e-02]
 [ 1.88573783e+00  1.22973606e+00  1.54151467e-01]
 [-1.61370416e-02 -1.09390145e-01 -4.75128895e-02]
 [ 3.46173165e-02 -1.35567269e-02 -9.72963590e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.56266707]
curr_Stock_Price:  100.70344530199075
curr_Factors:  [100.7034453   -1.00229864  -1.04162324]
mat_Sqrt:  [[13.04308534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00540057 -0.01116839  0.18815494]
Stock Position:  0.0054005703780748236
Bond Position:  [7.01881103]


portfolio before change:  [7.56220877]
curr_Stock_Price:  100.4561180842197
curr_Factors:  [100.45611808  -1.09183202  -1.04840775]
mat_Sqrt:  [[11.81631535  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11207159 0.07470946 0.97850405]
Stock Position:  0.11207159210825421
Bond Position:  [-3.69606832]


portfolio before change:  [7.55194343]
curr_Stock_Price:  100.36864452356205
curr_Factors:  [100.36864452  -1.11480858  -1.07300632]
mat_Sqrt:  [[11.25750435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01903907 -0.03193018  0.10176155]
Stock Position:  -0.019039069865351043
Bond Position:  [9.46286907]


portfolio before change:  [7.55566178]
curr_Stock_Price:  100.23547553006492
curr_Factors:  [100.23547553  -1.21364596  -1.0834973 ]
mat_Sqrt:  [[10.07824271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05991354 0.40217077 2.78835762]
Stock Position:  0.05991354286082471
Bond Position:  [1.55019932]


portfolio before change:  [7.52468178]
curr_Stock_Price:  99.71516272133401
curr_Factors:  [99.71516272 -0.95095827 -1.08327674]
mat_Sqrt:  [[13.04079784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00449712 -0.01106097 -0.05874131]
Stock Position:  -0.0044971175589571455
Bond Position:  [7.97311259]


portfolio before change:  [7.52551552]
curr_Stock_Price:  99.7514004062906
curr_Factors:  [99.75140041 -0.93289771 -1.09818937]
mat_Sqrt:  [[13.08666821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00203865  0.0227511  -0.03445402]
Stock Position:  0.0020386459350992766
Bond Position:  [7.32215773]


portfolio before change:  [7.5257279]
curr_Stock_Price:  99.40658935960727
curr_Factors:  [99.40658936 -0.89676829 -1.06976524]
mat_Sqrt:  [[13.91106925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00479605  0.00832514 -0.14574867]
Stock Position:  -0.004796053242243213
Bond Position:  [8.00248719]


portfolio before change:  [7.52743305]
curr_Stock_Price:  99.25963920210826
curr_Factors:  [99.2596392  -0.74585303 -1.05426084]
mat_Sqrt:  [[16.40563964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00228455  0.04008591  0.00313904]
Stock Position:  -0.0022845522883989874
Bond Position:  [7.75419689]


portfolio before change:  [7.52736654]
curr_Stock_Price:  99.71305194901525
curr_Factors:  [99.71305195 -1.01501195 -1.06147041]
mat_Sqrt:  [[12.5010697   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00160656  0.02013297 -0.13171482]
Stock Position:  0.0016065599146707524
Bond Position:  [7.36717155]


portfolio before change:  [7.52731254]
curr_Stock_Price:  99.1061897109043
curr_Factors:  [99.10618971 -1.06422531 -1.06448697]
mat_Sqrt:  [[11.79268728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00571514 -0.00872575  0.02713571]
Stock Position:  -0.005715139527549927
Bond Position:  [8.09371824]


portfolio before change:  [7.53078503]
curr_Stock_Price:  98.6756292059513
curr_Factors:  [98.67562921 -0.82580434 -1.09837594]
mat_Sqrt:  [[14.4061863   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07783677  0.5400748  -0.78266874]
Stock Position:  0.07783676869903522
Bond Position:  [-0.1498071]


portfolio before change:  [7.52143815]
curr_Stock_Price:  98.55578666949721
curr_Factors:  [98.55578667 -0.88538528 -1.05975705]
mat_Sqrt:  [[14.09021268  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00097564 0.00711366 0.13975468]
Stock Position:  0.0009756419440609903
Bond Position:  [7.42528299]


portfolio before change:  [7.52308457]
curr_Stock_Price:  99.2919278093149
curr_Factors:  [99.29192781 -0.84065875 -1.06938791]
mat_Sqrt:  [[14.70250103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.12103225e-02  1.69194739e-04 -1.96464590e+00]
Stock Position:  -0.03121032246882726
Bond Position:  [10.62201766]


portfolio before change:  [7.48862817]
curr_Stock_Price:  100.43847924395128
curr_Factors:  [100.43847924  -1.09095924  -1.05230497]
mat_Sqrt:  [[11.77856303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.142405   -1.06245739  7.89799037]
Stock Position:  0.14240500495720565
Bond Position:  [-6.81431397]


portfolio before change:  [7.59446608]
curr_Stock_Price:  101.18767874085208
curr_Factors:  [101.18767874  -0.68327764  -1.05261589]
mat_Sqrt:  [[17.83358481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121509 -0.03053791  0.10625201]
Stock Position:  -0.0012150878866298497
Bond Position:  [7.71741801]


portfolio before change:  [7.59428758]
curr_Stock_Price:  102.12855277759206
curr_Factors:  [102.12855278  -0.48867457  -1.04731713]
mat_Sqrt:  [[21.98236705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00601535 -0.01754178  0.0012519 ]
Stock Position:  0.006015346734096753
Bond Position:  [6.97994892]


portfolio before change:  [7.59171638]
curr_Stock_Price:  101.55605921206315
curr_Factors:  [101.55605921  -0.48902603  -1.04087939]
mat_Sqrt:  [[21.99258895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00679333 -0.04036075 -0.13270563]
Stock Position:  -0.00679332988267944
Bond Position:  [8.28162019]


portfolio before change:  [7.58606257]
curr_Stock_Price:  102.54071202812634
curr_Factors:  [102.54071203  -0.57026929  -1.02359875]
mat_Sqrt:  [[20.82995039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03191368 -0.5638238  -0.57860381]
Stock Position:  -0.031913678734297235
Bond Position:  [10.85851392]


portfolio before change:  [7.60298347]
curr_Stock_Price:  102.05303734847959
curr_Factors:  [102.05303735  -0.56107068  -1.0089918 ]
mat_Sqrt:  [[21.23031635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00098082 0.01202236 0.16656844]
Stock Position:  0.0009808248203017637
Bond Position:  [7.50288731]


portfolio before change:  [7.60311915]
curr_Stock_Price:  101.23511755702977
curr_Factors:  [101.23511756  -0.59676524  -0.99389148]
mat_Sqrt:  [[20.63088006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00901129 -0.05346736  0.67206166]
Stock Position:  0.009011287991575915
Bond Position:  [6.69086035]


portfolio before change:  [7.60376133]
curr_Stock_Price:  101.21356324351173
curr_Factors:  [101.21356324  -0.6167755   -1.02341577]
mat_Sqrt:  [[19.62965633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00304965 -0.00593868  0.25854868]
Stock Position:  0.003049654894180457
Bond Position:  [7.29509489]


portfolio before change:  [7.6058849]
curr_Stock_Price:  101.61086219001359
curr_Factors:  [101.61086219  -0.5026608   -1.02887644]
mat_Sqrt:  [[21.96857901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00566488 -0.01719812 -0.03898877]
Stock Position:  0.005664882201519458
Bond Position:  [7.03027133]


portfolio before change:  [7.60995831]
curr_Stock_Price:  102.17478786729303
curr_Factors:  [102.17478787  -0.79289086  -1.0339358 ]
mat_Sqrt:  [[16.44231656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01488444 0.05407153 0.47074886]
Stock Position:  0.014884438388323463
Bond Position:  [6.08914397]


portfolio before change:  [7.60968653]
curr_Stock_Price:  102.10538839495678
curr_Factors:  [102.10538839  -0.84469023  -1.0158825 ]
mat_Sqrt:  [[15.88591342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01424377  0.02678233  0.06911837]
Stock Position:  -0.014243773097499383
Bond Position:  [9.06405251]


portfolio before change:  [7.61717243]
curr_Stock_Price:  101.65938131934517
curr_Factors:  [101.65938132  -0.97740861  -1.01156071]
mat_Sqrt:  [[13.91070246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250488 -0.04648516  0.13927473]
Stock Position:  -0.0025048837986706694
Bond Position:  [7.87181736]


portfolio before change:  [7.61969328]
curr_Stock_Price:  101.04585536966259
curr_Factors:  [101.04585537  -0.79160103  -1.01941596]
mat_Sqrt:  [[16.51976317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00478911 -0.00220052  0.42744256]
Stock Position:  0.004789114889443118
Bond Position:  [7.13577307]


portfolio before change:  [7.61851004]
curr_Stock_Price:  100.61252684524578
curr_Factors:  [100.61252685  -0.72014201  -0.99796066]
mat_Sqrt:  [[18.05051294  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0103349  -0.0308092   0.22434809]
Stock Position:  0.010334897483784229
Bond Position:  [6.57868989]


portfolio before change:  [7.6099846]
curr_Stock_Price:  99.7080351417385
curr_Factors:  [99.70803514 -0.64007184 -1.00403968]
mat_Sqrt:  [[19.26200964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295327  0.02238978  0.45126277]
Stock Position:  -0.002953270906687724
Bond Position:  [7.90444944]


portfolio before change:  [7.61235598]
curr_Stock_Price:  99.23965315548196
curr_Factors:  [99.23965316 -0.54973516 -1.01602335]
mat_Sqrt:  [[20.7340891   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00086456 -0.01537854  0.12585407]
Stock Position:  0.000864559378364814
Bond Position:  [7.52655741]


portfolio before change:  [7.61296939]
curr_Stock_Price:  98.86088874895009
curr_Factors:  [98.86088875 -0.715566   -1.01364325]
mat_Sqrt:  [[17.54035886  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137791  0.02795837  0.04055392]
Stock Position:  -0.00137790682673808
Bond Position:  [7.74919049]


portfolio before change:  [7.61347271]
curr_Stock_Price:  99.19863943895473
curr_Factors:  [99.19863944 -0.85999654 -1.02441414]
mat_Sqrt:  [[15.07011457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.65359744e-05 -4.92404642e-03 -2.09316520e-01]
Stock Position:  -7.653597435828638e-05
Bond Position:  [7.62106498]


portfolio before change:  [7.61437251]
curr_Stock_Price:  99.88979178309467
curr_Factors:  [99.88979178 -0.87190116 -1.00185936]
mat_Sqrt:  [[15.33759456  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184314  0.00688544 -0.15216867]
Stock Position:  -0.001843144227802172
Bond Position:  [7.7984838]


portfolio before change:  [7.61734691]
curr_Stock_Price:  98.80494641728585
curr_Factors:  [98.80494642 -0.78796322 -1.0031478 ]
mat_Sqrt:  [[16.47817277  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0060603  -0.01030123  0.11444269]
Stock Position:  -0.006060297085088429
Bond Position:  [8.21613424]


portfolio before change:  [7.61832507]
curr_Stock_Price:  98.81301845613571
curr_Factors:  [98.81301846 -0.52196718 -1.05575095]
mat_Sqrt:  [[20.39951733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073209  0.00072331  0.00553343]
Stock Position:  -0.0007320869152555068
Bond Position:  [7.69066479]


portfolio before change:  [7.61958546]
curr_Stock_Price:  98.40459480908092
curr_Factors:  [98.40459481 -0.28824811 -1.02681556]
mat_Sqrt:  [[26.41742488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00114013  0.00489431  0.04181786]
Stock Position:  -0.0011401257632698654
Bond Position:  [7.73177908]


portfolio before change:  [7.61873498]
curr_Stock_Price:  99.99829110960908
curr_Factors:  [99.99829111 -0.78569798 -1.04234289]
mat_Sqrt:  [[16.07254009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00907576 -0.02084072 -0.23476699]
Stock Position:  -0.009075764523954822
Bond Position:  [8.52629592]


portfolio before change:  [7.61301957]
curr_Stock_Price:  100.74547490431698
curr_Factors:  [100.7454749   -0.75982784  -1.05088346]
mat_Sqrt:  [[16.4756904   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.13160132 0.39689561 0.43975123]
Stock Position:  0.1316013249437819
Bond Position:  [-5.64521841]


portfolio before change:  [7.69009119]
curr_Stock_Price:  101.33648197125038
curr_Factors:  [101.33648197  -0.80698249  -1.05415372]
mat_Sqrt:  [[15.75740291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305664 -0.03530552 -0.13554105]
Stock Position:  -0.0030566419879726058
Bond Position:  [7.99984053]


portfolio before change:  [7.69210831]
curr_Stock_Price:  101.00373685625627
curr_Factors:  [101.00373686  -0.59790187  -1.01398631]
mat_Sqrt:  [[20.15131087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00059497 -0.00437541 -0.27755943]
Stock Position:  0.0005949749451549952
Bond Position:  [7.63201362]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.69179675]
Stock Price:  98.87655286255442
PL:  [7.69179675]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 2.86934916e-02 -8.78206255e-02  6.33875154e-03]
 [ 1.15059140e+00  2.28296772e-01  3.29521872e-01]
 [-2.51853445e-02  7.06429237e-02  3.42132759e-02]
 [ 9.71605711e-02  8.54476885e-01  6.39124368e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.37666071e-02 -5.79191220e-02  4.73965188e-02]
 [-4.50327739e-02 -3.67301794e-02 -5.48500094e-02]
 [ 7.18904727e-02  1.35709696e-01 -5.19936504e-02]
 [ 3.78115286e-02  3.96150692e-02 -4.27131016e-02]
 [-1.13804550e-01 -5.80740543e-02 -2.50373710e-02]
 [ 8.15968153e-01  1.57295028e+00 -2.83305788e-01]
 [-2.13324961e-04  1.45590869e-02 -5.75469647e-02]
 [-1.84982397e-01 -4.48734085e-03 -3.75916720e-01]
 [ 1.69586896e+00 -3.21551609e+00  2.69866506e+00]
 [-8.47607171e-03 -9.43683961e-02  3.70921459e-02]
 [ 1.23925380e-01 -5.32411349e-02  3.20649330e-03]
 [-1.35392740e-01 -1.67074293e-01 -3.45212319e-02]
 [-2.63839751e-01 -1.72181126e+00 -1.99764752e-01]
 [-1.47169863e-04  3.31696683e-02  8.28010785e-02]
 [ 1.67258564e-01  8.17462685e-02  3.86603884e-01]
 [ 3.38305452e-02 -8.68254463e-02  1.86556526e-02]
 [ 1.12630813e-01 -5.12564021e-02  3.21482839e-02]
 [-5.87497176e-02 -3.71886514e-02 -5.11693540e-02]
 [-7.21837635e-02 -3.18522383e-02 -2.66565930e-02]
 [ 5.34539260e-02 -3.50660940e-02 -4.35183704e-03]
 [ 2.20010718e-02 -2.08302196e-02  2.44141356e-01]
 [ 1.11227092e-01 -1.08785936e-01  4.91890142e-02]
 [-1.18478372e-01  9.27617323e-02  1.66649929e-01]
 [ 2.50475725e-02 -4.14436647e-02  5.48620568e-02]
 [-1.92046627e-02  7.79810236e-02  2.49022004e-02]
 [ 3.64216623e-02 -1.44905846e-02 -7.71670047e-02]
 [-2.87655542e-02  1.46579419e-02 -4.93657007e-02]
 [-1.03545173e-01 -3.17442419e-02  4.05016243e-02]
 [ 3.67316625e-03  2.71042259e-03  4.94741688e-03]
 [-1.00670467e-01  9.20920022e-03  4.36673849e-02]
 [-1.21442694e-01 -7.17508545e-02 -8.36598772e-02]
 [ 2.00585902e+00  1.29684377e+00  1.57257771e-01]
 [-6.62502815e-02  2.99611606e-02  2.95079919e-02]
 [ 3.07411291e-02 -1.50032168e-02 -3.30778336e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.79963003]
curr_Stock_Price:  100.18993524824045
curr_Factors:  [100.18993525  -1.0147412   -1.01025087]
mat_Sqrt:  [[13.22455945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091202 -0.02834399  0.01808269]
Stock Position:  0.0009120208324794022
Bond Position:  [3.70825472]


portfolio before change:  [3.80009603]
curr_Stock_Price:  100.1926027152046
curr_Factors:  [100.19260272  -1.18583862  -1.02773524]
mat_Sqrt:  [[10.95198255  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.1154545  0.07368247 0.94003418]
Stock Position:  0.11545449881724143
Bond Position:  [-7.76759071]


portfolio before change:  [3.91115884]
curr_Stock_Price:  101.16297477598827
curr_Factors:  [101.16297478  -1.21005153  -1.0300249 ]
mat_Sqrt:  [[10.76883587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035117  0.02279991  0.09760095]
Stock Position:  -0.00035116724331671145
Bond Position:  [3.94668396]


portfolio before change:  [3.91153138]
curr_Stock_Price:  101.50703847138786
curr_Factors:  [101.50703847  -1.11246051  -1.01558854]
mat_Sqrt:  [[12.08637867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03326395 0.27578123 1.82324393]
Stock Position:  0.03326394624272269
Bond Position:  [0.53500671]


portfolio before change:  [3.89807039]
curr_Stock_Price:  101.10035588229341
curr_Factors:  [101.10035588  -1.04561931  -1.01404919]
mat_Sqrt:  [[12.88991405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454976 -0.01106097 -0.05874131]
Stock Position:  -0.004549758881764035
Bond Position:  [4.35805263]


portfolio before change:  [3.89775699]
curr_Stock_Price:  101.28897937432123
curr_Factors:  [101.28897937  -1.06373632  -1.01679619]
mat_Sqrt:  [[12.64731712  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00487208 -0.01869332  0.13520908]
Stock Position:  0.0048720759607592005
Bond Position:  [3.40426939]


portfolio before change:  [3.89805293]
curr_Stock_Price:  101.26237401558437
curr_Factors:  [101.26237402  -0.92992606  -1.01320483]
mat_Sqrt:  [[14.50631418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00439302 -0.01185461 -0.15647181]
Stock Position:  -0.004393018163095546
Bond Position:  [4.34290038]


portfolio before change:  [3.8973624]
curr_Stock_Price:  101.54314296116232
curr_Factors:  [101.54314296  -0.83889494  -0.97904205]
mat_Sqrt:  [[16.48658079  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00539705  0.04380012 -0.14832341]
Stock Position:  0.005397052300834469
Bond Position:  [3.34932875]


portfolio before change:  [3.89530018]
curr_Stock_Price:  101.08346308146261
curr_Factors:  [101.08346308  -0.43355094  -0.97843888]
mat_Sqrt:  [[24.62979104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150952  0.01278571 -0.12184859]
Stock Position:  0.0015095193184403092
Bond Position:  [3.74271274]


portfolio before change:  [3.89513069]
curr_Stock_Price:  100.66124132589248
curr_Factors:  [100.66124133  -0.6462188   -0.95514606]
mat_Sqrt:  [[20.29543487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0064433  -0.01874332 -0.07142465]
Stock Position:  -0.006443301133945478
Bond Position:  [4.54372138]


portfolio before change:  [3.89198135]
curr_Stock_Price:  101.23817298617543
curr_Factors:  [101.23817299  -0.7575224   -0.94806288]
mat_Sqrt:  [[18.39153692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05868002  0.50766752 -0.80819256]
Stock Position:  0.058680018797425015
Bond Position:  [-2.04867655]


portfolio before change:  [3.96180969]
curr_Stock_Price:  102.43252234249971
curr_Factors:  [102.43252234  -0.771598    -0.96989121]
mat_Sqrt:  [[17.95224267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050067  0.00469893 -0.16416547]
Stock Position:  -0.0005006721968963709
Bond Position:  [4.01309481]


portfolio before change:  [3.96248393]
curr_Stock_Price:  102.08785155317418
curr_Factors:  [102.08785155  -0.92905948  -0.95723837]
mat_Sqrt:  [[15.4797989   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01696612 -0.00144828 -1.07238577]
Stock Position:  -0.01696611518975151
Bond Position:  [5.69451818]


portfolio before change:  [3.98095438]
curr_Stock_Price:  101.04114176366645
curr_Factors:  [101.04114176  -0.94617384  -0.95125382]
mat_Sqrt:  [[15.15150883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10496428 -1.03780336  7.69854025]
Stock Position:  0.10496427769299789
Bond Position:  [-6.62475608]


portfolio before change:  [4.05602146]
curr_Stock_Price:  101.7641993632687
curr_Factors:  [101.76419936  -1.08912232  -0.95280345]
mat_Sqrt:  [[13.20680984  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152706 -0.03045727  0.10581357]
Stock Position:  -0.0015270559328669712
Bond Position:  [4.21142108]


portfolio before change:  [4.05612882]
curr_Stock_Price:  102.03864541278709
curr_Factors:  [102.03864541  -1.10968773  -0.93842347]
mat_Sqrt:  [[13.16076974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00864023 -0.0171835   0.00914723]
Stock Position:  0.008640231823793174
Bond Position:  [3.17449127]


portfolio before change:  [4.05932906]
curr_Stock_Price:  102.3631043434489
curr_Factors:  [102.36310434  -1.05821096  -0.94526837]
mat_Sqrt:  [[13.80522312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01278815 -0.053923   -0.09847947]
Stock Position:  -0.012788149294966165
Bond Position:  [5.36836372]


portfolio before change:  [4.060762]
curr_Stock_Price:  102.30352914372313
curr_Factors:  [102.30352914  -1.0258249   -0.93997269]
mat_Sqrt:  [[14.32701021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04579321 -0.5557122  -0.56987323]
Stock Position:  -0.04579321182094505
Bond Position:  [8.74556918]


portfolio before change:  [4.0948711]
curr_Stock_Price:  101.58255253449823
curr_Factors:  [101.58255253  -1.01854153  -0.93207549]
mat_Sqrt:  [[14.44364859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00162876 0.01070546 0.23620843]
Stock Position:  0.001628761565959061
Bond Position:  [3.92941734]


portfolio before change:  [4.09312919]
curr_Stock_Price:  100.2114981510594
curr_Factors:  [100.21149815  -0.94375041  -0.90703382]
mat_Sqrt:  [[15.74461981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01669524 0.02638349 1.10287327]
Stock Position:  0.016695235676826743
Bond Position:  [2.42007461]


portfolio before change:  [4.07350285]
curr_Stock_Price:  99.01781219581251
curr_Factors:  [99.0178122  -1.18741381 -0.89349894]
mat_Sqrt:  [[12.35903044  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00161141 -0.02802279  0.05321938]
Stock Position:  0.001611408305319819
Bond Position:  [3.91394472]


portfolio before change:  [4.07261494]
curr_Stock_Price:  98.16316384485418
curr_Factors:  [98.16316384 -1.18354694 -0.8971393 ]
mat_Sqrt:  [[12.25513197  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00887223 -0.01654293  0.09171011]
Stock Position:  0.008872232852076471
Bond Position:  [3.20168849]


portfolio before change:  [4.07851915]
curr_Stock_Price:  98.78352384595306
curr_Factors:  [98.78352385 -1.36953212 -0.90239372]
mat_Sqrt:  [[10.18590588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00753843 -0.01200259 -0.14597192]
Stock Position:  -0.0075384281772952755
Bond Position:  [4.82319165]


portfolio before change:  [4.07889692]
curr_Stock_Price:  98.81339362208686
curr_Factors:  [98.81339362 -1.32570539 -0.89482076]
mat_Sqrt:  [[10.72638947  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00784298 -0.01028027 -0.07604384]
Stock Position:  -0.007842977262239283
Bond Position:  [4.85388811]


portfolio before change:  [4.08088997]
curr_Stock_Price:  98.63663894102676
curr_Factors:  [98.63663894 -0.88169374 -0.89030212]
mat_Sqrt:  [[16.76757441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00270807 -0.01131753 -0.01241458]
Stock Position:  0.0027080705542286408
Bond Position:  [3.81377499]


portfolio before change:  [4.08445199]
curr_Stock_Price:  99.77592282790432
curr_Factors:  [99.77592283 -0.93754777 -0.9121484 ]
mat_Sqrt:  [[15.69325087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00430658 -0.00672292  0.69646733]
Stock Position:  0.0043065816794024304
Bond Position:  [3.65475882]


portfolio before change:  [4.08343196]
curr_Stock_Price:  99.43298364797357
curr_Factors:  [99.43298365 -0.86480404 -0.90685002]
mat_Sqrt:  [[16.90872609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00585863 -0.03511051  0.14032257]
Stock Position:  0.0058586271465218675
Bond Position:  [3.50089119]


portfolio before change:  [4.08061301]
curr_Stock_Price:  98.87712158474604
curr_Factors:  [98.87712158 -0.70072778 -0.90415231]
mat_Sqrt:  [[19.86576286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00329845  0.02993872  0.47540586]
Stock Position:  -0.0032984481132341285
Bond Position:  [4.40675407]


portfolio before change:  [4.0812097]
curr_Stock_Price:  98.86323474606503
curr_Factors:  [98.86323475 -0.61266126 -0.89040673]
mat_Sqrt:  [[21.9917952   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012635  -0.01337589  0.15650618]
Stock Position:  0.001263498046455984
Bond Position:  [3.95629619]


portfolio before change:  [4.08246105]
curr_Stock_Price:  99.46219476866199
curr_Factors:  [99.46219477 -0.65765065 -0.90957164]
mat_Sqrt:  [[20.75018832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [8.65672840e-05 2.51682671e-02 7.10390462e-02]
Stock Position:  8.656728404738124e-05
Bond Position:  [4.07385088]


portfolio before change:  [4.08289242]
curr_Stock_Price:  98.56237333072853
curr_Factors:  [98.56237333 -0.44277468 -0.90163654]
mat_Sqrt:  [[25.69453601  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068933 -0.00467682 -0.22013599]
Stock Position:  0.000689334700317253
Bond Position:  [4.01494995]


portfolio before change:  [4.08345236]
curr_Stock_Price:  98.64657727806559
curr_Factors:  [98.64657728 -0.69495393 -0.93232004]
mat_Sqrt:  [[19.38054173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184981  0.00473083 -0.1408266 ]
Stock Position:  -0.0018498061787656087
Bond Position:  [4.26592941]


portfolio before change:  [4.08382249]
curr_Stock_Price:  98.73477206389434
curr_Factors:  [98.73477206 -0.80346272 -0.92938516]
mat_Sqrt:  [[17.45435694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00582992 -0.01024541  0.11553986]
Stock Position:  -0.005829924301141327
Bond Position:  [4.65943874]


portfolio before change:  [4.08237884]
curr_Stock_Price:  99.0823108855037
curr_Factors:  [99.08231089 -0.77743023 -0.93821605]
mat_Sqrt:  [[17.81970115  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00029385 0.00087479 0.0141136 ]
Stock Position:  0.0002938498316087572
Bond Position:  [4.05326351]


portfolio before change:  [4.08277783]
curr_Stock_Price:  98.71580023209738
curr_Factors:  [98.71580023 -0.81444721 -0.95096933]
mat_Sqrt:  [[16.89180296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00532075  0.00297226  0.12457089]
Stock Position:  -0.005320751110690383
Bond Position:  [4.60802003]


portfolio before change:  [4.08141143]
curr_Stock_Price:  99.08086779923188
curr_Factors:  [99.0808678  -0.45704401 -0.94787391]
mat_Sqrt:  [[24.31317662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0062997  -0.02315749 -0.23865834]
Stock Position:  -0.0062997023825941785
Bond Position:  [4.70559141]


portfolio before change:  [4.08829586]
curr_Stock_Price:  98.08142480982215
curr_Factors:  [98.08142481 -0.48229088 -0.96378355]
mat_Sqrt:  [[23.09748092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09969383 0.41855453 0.44861265]
Stock Position:  0.09969382644544018
Bond Position:  [-5.68981668]


portfolio before change:  [4.05171398]
curr_Stock_Price:  97.72161706368898
curr_Factors:  [97.72161706 -0.14048082 -0.98086133]
mat_Sqrt:  [[31.84182385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00169937  0.00966992  0.08417809]
Stock Position:  -0.001699374753743539
Bond Position:  [4.21777963]


portfolio before change:  [4.0568038]
curr_Stock_Price:  95.0367674358704
curr_Factors:  [ 9.50367674e+01  1.30524907e-02 -9.64970783e-01]
mat_Sqrt:  [[36.6841782   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00057045 -0.00484227 -0.09436185]
Stock Position:  0.0005704537160975184
Bond Position:  [4.00258972]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.05545573]
Stock Price:  91.79649063096228
PL:  [4.05545573]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 2.46821013e-02 -8.76227314e-02  1.69484329e-02]
 [ 4.05333470e-01  2.08482798e-01  1.10940211e-01]
 [-4.39856949e-01 -3.18408844e-01  4.26266230e-02]
 [ 2.69575637e-01  1.67809961e+00  1.66329541e+00]
 [-4.81837381e-02 -3.03616906e-02 -1.46013923e-02]
 [-2.32616203e-03  1.55604143e-01 -5.67324720e-02]
 [-4.70443489e-02 -2.38561301e-02 -6.34543495e-02]
 [-2.37226750e-02  2.36298749e-01 -3.79647813e-02]
 [ 3.32790759e-02  4.45199155e-02 -4.34582732e-02]
 [-8.36335110e-02 -3.93391487e-02 -4.18303734e-03]
 [ 8.22014266e-01  1.68702074e+00 -2.59561216e-01]
 [-2.04906792e-03 -8.29188457e-02  2.70168032e-01]
 [-5.28385814e-01 -1.00161891e-01 -1.32782526e+00]
 [ 2.13554452e+00 -3.13928637e+00  2.67461946e+00]
 [-2.04418155e-02  8.92830204e-02 -3.36445796e-02]
 [ 3.09259481e-03  5.93062536e-01 -3.16572028e-01]
 [-4.88999843e-04 -1.77652412e-01 -3.83466471e-01]
 [-3.35471389e-01 -2.09813431e+00 -1.88348575e-01]
 [ 6.69604009e-02 -2.17530784e-01  8.66560611e-02]
 [-6.82205888e-01  4.35501596e-01  2.73833138e-01]
 [-2.93377476e-03  3.76607962e-01 -2.59643498e-01]
 [-1.23778886e-02 -3.00404753e-02  2.44558280e-03]
 [ 1.60614314e-01 -1.82273327e-01 -1.89718914e-01]
 [-2.67200784e-01  9.68442785e-02  1.86196888e-02]
 [ 2.12290779e-01 -1.02930878e-01 -7.42571345e-02]
 [-8.26108415e-02 -6.49241226e-02  1.18047168e-01]
 [-1.66302051e-01 -7.17532573e-02 -4.05268777e-02]
 [-2.80653176e-01  2.03474774e-01  3.74754753e-01]
 [ 2.47850353e-01  2.31940261e-01  3.72379614e-01]
 [-1.35301033e-01  8.01729272e-02 -2.39737837e-01]
 [ 1.67383135e-01  2.82163890e-02  8.00478809e-02]
 [ 5.74698955e-02 -2.07344112e-03 -6.77024219e-02]
 [ 9.40356495e-02  9.93163421e-02  1.41948212e-01]
 [ 2.74434253e-04 -2.59368051e-02  3.38353709e-02]
 [-9.02223277e-02  1.03021369e-01  3.76727938e-02]
 [-8.30380435e-02 -4.73038921e-02 -4.71886090e-02]
 [ 1.57043758e+00  1.06078084e+00  1.47400250e-01]
 [ 3.03935361e-01 -4.54228784e-01  9.86337555e-02]
 [ 2.40885814e-02 -1.44275560e-02  3.03706585e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.61520711]
curr_Stock_Price:  100.16476860168744
curr_Factors:  [100.1647686   -1.00460169  -0.99987362]
mat_Sqrt:  [[13.49529636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00075995 -0.02828011  0.04834916]
Stock Position:  0.0007599514878900549
Bond Position:  [3.53908675]


portfolio before change:  [3.61448624]
curr_Stock_Price:  98.63402917241822
curr_Factors:  [98.63402917 -0.98927753 -0.98674335]
mat_Sqrt:  [[13.67262208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03441442 0.06728753 0.31648154]
Stock Position:  0.03441442437329939
Bond Position:  [0.2200529]


portfolio before change:  [3.60501406]
curr_Stock_Price:  98.3579913316835
curr_Factors:  [98.35799133 -1.02464818 -0.96437543]
mat_Sqrt:  [[13.45822149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.036866   -0.10276601  0.12160189]
Stock Position:  -0.03686599742958337
Bond Position:  [7.23107952]


portfolio before change:  [3.61930932]
curr_Stock_Price:  97.99474843877206
curr_Factors:  [97.99474844 -0.77465008 -0.96301873]
mat_Sqrt:  [[17.24022088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05519854 0.54160432 4.74491883]
Stock Position:  0.055198541016983155
Bond Position:  [-1.78985782]


portfolio before change:  [3.63542946]
curr_Stock_Price:  98.29084126879597
curr_Factors:  [98.29084127 -0.74178457 -0.95122472]
mat_Sqrt:  [[18.08208306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031723  -0.00979919 -0.04165371]
Stock Position:  -0.00317229982866505
Bond Position:  [3.94723748]


portfolio before change:  [3.63211318]
curr_Stock_Price:  99.49177287036682
curr_Factors:  [99.49177287 -0.72397086 -0.93763447]
mat_Sqrt:  [[18.88692014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094541  0.05022102 -0.16184195]
Stock Position:  0.0009454126514845085
Bond Position:  [3.5380524]


portfolio before change:  [3.63421688]
curr_Stock_Price:  101.24911392924493
curr_Factors:  [101.24911393  -0.54153348  -0.94959705]
mat_Sqrt:  [[22.79299893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028459  -0.00769953 -0.1810176 ]
Stock Position:  -0.002845896940928214
Bond Position:  [3.92236142]


portfolio before change:  [3.63690554]
curr_Stock_Price:  100.47665483994724
curr_Factors:  [100.47665484  -0.60389182  -0.96693213]
mat_Sqrt:  [[20.88646741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00080253  0.07626509 -0.10830295]
Stock Position:  0.000802532873559976
Bond Position:  [3.55626973]


portfolio before change:  [3.63728402]
curr_Stock_Price:  100.39431065206226
curr_Factors:  [100.39431065  -0.57419022  -0.93208123]
mat_Sqrt:  [[22.26095156  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150469  0.01436874 -0.12397436]
Stock Position:  0.0015046878238282224
Bond Position:  [3.48622192]


portfolio before change:  [3.63769307]
curr_Stock_Price:  100.37652525961018
curr_Factors:  [100.37652526  -0.47490032  -0.94151113]
mat_Sqrt:  [[24.34963644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00379954 -0.01269666 -0.01193304]
Stock Position:  -0.003799540920822144
Bond Position:  [4.01907778]


portfolio before change:  [3.64930365]
curr_Stock_Price:  97.45296937767093
curr_Factors:  [97.45296938 -0.58023345 -0.93364867]
mat_Sqrt:  [[21.44491974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05191874  0.5444836  -0.7404559 ]
Stock Position:  0.051918740425197445
Bond Position:  [-1.41033177]


portfolio before change:  [3.55060884]
curr_Stock_Price:  95.55541741537105
curr_Factors:  [95.55541742 -0.50993101 -0.90044335]
mat_Sqrt:  [[23.32048149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155113 -0.02676194  0.77071419]
Stock Position:  0.001551126299908801
Bond Position:  [3.40239032]


portfolio before change:  [3.54782266]
curr_Stock_Price:  93.48497996683507
curr_Factors:  [93.48497997 -0.46890448 -0.89267993]
mat_Sqrt:  [[23.9559416   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03422418 -0.03232711 -3.78791588]
Stock Position:  -0.03422418057618981
Bond Position:  [6.74726949]


portfolio before change:  [3.59847926]
curr_Stock_Price:  92.0294845235128
curr_Factors:  [92.02948452 -0.67579992 -0.90114859]
mat_Sqrt:  [[19.01371374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10732752 -1.01320032  7.62994484]
Stock Position:  0.10732752205020388
Bond Position:  [-6.27881727]


portfolio before change:  [3.65314508]
curr_Stock_Price:  92.5461341466513
curr_Factors:  [92.54613415 -0.60272373 -0.92639899]
mat_Sqrt:  [[20.0571269   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045294  0.02881597 -0.09597862]
Stock Position:  -0.0004529395656085297
Bond Position:  [3.69506289]


portfolio before change:  [3.65422644]
curr_Stock_Price:  91.17851143974877
curr_Factors:  [91.17851144 -0.24154267 -0.92289365]
mat_Sqrt:  [[28.45667982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00209199  0.19141011 -0.90309188]
Stock Position:  0.0020919862666296547
Bond Position:  [3.46348225]


portfolio before change:  [3.6460149]
curr_Stock_Price:  87.04631127782494
curr_Factors:  [87.04631128 -0.23724384 -0.94289155]
mat_Sqrt:  [[26.74385959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430106 -0.05733707 -1.09392311]
Stock Position:  -0.004301058787887674
Bond Position:  [4.0204062]


portfolio before change:  [3.64096505]
curr_Stock_Price:  88.33725561729942
curr_Factors:  [88.33725562 -0.11273603 -0.97515632]
mat_Sqrt:  [[29.76310651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02695276 -0.67716994 -0.53730606]
Stock Position:  -0.026952756218606825
Bond Position:  [6.02189757]


portfolio before change:  [3.60535209]
curr_Stock_Price:  89.68649600952236
curr_Factors:  [89.68649601 -0.17091822 -0.98723529]
mat_Sqrt:  [[28.16743997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0014288  -0.07020776  0.24720562]
Stock Position:  0.00142880254940858
Bond Position:  [3.4772078]


portfolio before change:  [3.60386743]
curr_Stock_Price:  88.34317439331696
curr_Factors:  [88.34317439 -0.36546819 -0.95797092]
mat_Sqrt:  [[23.51855847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02285062  0.14055754  0.78116972]
Stock Position:  -0.022850615709245837
Bond Position:  [5.62256336]


portfolio before change:  [3.63817594]
curr_Stock_Price:  86.87250722904561
curr_Factors:  [86.87250723 -0.564492   -0.93051834]
mat_Sqrt:  [[19.4808372   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107498  0.1215497  -0.74069063]
Stock Position:  0.0010749792894549019
Bond Position:  [3.54478979]


portfolio before change:  [3.63928059]
curr_Stock_Price:  87.48789042980202
curr_Factors:  [87.48789043 -0.44720487 -0.95435444]
mat_Sqrt:  [[21.54063333  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083613 -0.00969552  0.00697657]
Stock Position:  -0.000836125480440245
Bond Position:  [3.71243145]


portfolio before change:  [3.64109839]
curr_Stock_Price:  85.86885294972059
curr_Factors:  [85.86885295 -0.30163675 -0.97527356]
mat_Sqrt:  [[23.94862376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00353597 -0.05882846 -0.54121525]
Stock Position:  0.0035359742277442634
Bond Position:  [3.33746834]


portfolio before change:  [3.63930531]
curr_Stock_Price:  85.24376574983837
curr_Factors:  [85.24376575 -0.42109133 -0.95963257]
mat_Sqrt:  [[21.42998458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01136873  0.03125636  0.05311679]
Stock Position:  -0.011368734297161115
Bond Position:  [4.60841903]


portfolio before change:  [3.65153582]
curr_Stock_Price:  84.21863662100476
curr_Factors:  [84.21863662 -0.14469983 -0.98772682]
mat_Sqrt:  [[27.13948261  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00648953 -0.0332208  -0.21183494]
Stock Position:  0.006489527806079453
Bond Position:  [3.10499664]


portfolio before change:  [3.65299307]
curr_Stock_Price:  84.38337943616303
curr_Factors:  [ 8.43833794e+01  6.26367528e-02 -9.85040426e-01]
mat_Sqrt:  [[33.54764887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213926 -0.02095417  0.33675571]
Stock Position:  -0.002139260057651815
Bond Position:  [3.83351106]


portfolio before change:  [3.64245665]
curr_Stock_Price:  89.53265399117107
curr_Factors:  [89.53265399 -0.4234005  -1.02550071]
mat_Sqrt:  [[21.0247895   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00899991 -0.02315826 -0.1156119 ]
Stock Position:  -0.008999906386669847
Bond Position:  [4.44824216]


portfolio before change:  [3.63791449]
curr_Stock_Price:  90.09912921478232
curr_Factors:  [90.09912921 -0.49850659 -1.04768944]
mat_Sqrt:  [[19.19624088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00847158  0.0656712   1.069071  ]
Stock Position:  -0.008471584036288385
Bond Position:  [4.40119684]


portfolio before change:  [3.63965987]
curr_Stock_Price:  89.95804682011774
curr_Factors:  [89.95804682 -0.39376717 -1.05924392]
mat_Sqrt:  [[21.03804223  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01764454 0.0748584  1.06229539]
Stock Position:  0.017644542521596373
Bond Position:  [2.05239129]


portfolio before change:  [3.63931341]
curr_Stock_Price:  89.92387076526305
curr_Factors:  [89.92387077 -0.44967786 -1.07039379]
mat_Sqrt:  [[19.66601039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00853615  0.0258757  -0.68390532]
Stock Position:  -0.008536153523929283
Bond Position:  [4.40691738]


portfolio before change:  [3.63264406]
curr_Stock_Price:  90.76971495023838
curr_Factors:  [90.76971495 -0.54505112 -1.07362184]
mat_Sqrt:  [[17.98706224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01053438 0.0091068  0.22835432]
Stock Position:  0.01053437656580434
Bond Position:  [2.6764417]


portfolio before change:  [3.65929485]
curr_Stock_Price:  93.26784292692821
curr_Factors:  [93.26784293 -0.57598213 -1.06219838]
mat_Sqrt:  [[18.1250484   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00238493 -0.0006692  -0.19313616]
Stock Position:  0.00238492919615511
Bond Position:  [3.43685765]


portfolio before change:  [3.65856644]
curr_Stock_Price:  92.78227439327028
curr_Factors:  [92.78227439 -0.71925613 -1.07899219]
mat_Sqrt:  [[15.36369556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00932611 0.03205421 0.40493874]
Stock Position:  0.009326113615307855
Bond Position:  [2.79326841]


portfolio before change:  [3.65227735]
curr_Stock_Price:  92.07048057041892
curr_Factors:  [92.07048057 -0.77938327 -1.07504759]
mat_Sqrt:  [[14.41289824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00013091 -0.00837107  0.0965229 ]
Stock Position:  0.00013090512479996562
Bond Position:  [3.64022485]


portfolio before change:  [3.65274326]
curr_Stock_Price:  92.1533806337043
curr_Factors:  [92.15338063 -0.6578732  -1.03200148]
mat_Sqrt:  [[17.00622917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361651  0.03325     0.10746999]
Stock Position:  -0.003616513183867326
Bond Position:  [3.98601718]


portfolio before change:  [3.65768077]
curr_Stock_Price:  90.92589240285174
curr_Factors:  [90.9258924  -0.77440313 -1.02536329]
mat_Sqrt:  [[15.03345999  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00680657 -0.01526727 -0.13461597]
Stock Position:  -0.006806566462410476
Bond Position:  [4.2765739]


portfolio before change:  [3.664161]
curr_Stock_Price:  90.05237928224375
curr_Factors:  [90.05237928 -0.72468159 -1.03138872]
mat_Sqrt:  [[15.55405196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11682207 0.34236554 0.42049188]
Stock Position:  0.11682206779406526
Bond Position:  [-6.85594416]


portfolio before change:  [3.49814134]
curr_Stock_Price:  88.63858295809116
curr_Factors:  [88.63858296 -0.76611022 -1.01247158]
mat_Sqrt:  [[14.96906048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0154552  -0.14660171  0.28137465]
Stock Position:  0.015455200439171405
Bond Position:  [2.12821428]


portfolio before change:  [3.49442669]
curr_Stock_Price:  88.38101937269995
curr_Factors:  [88.38101937 -0.82324961 -1.02547386]
mat_Sqrt:  [[13.91453193  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00196506 -0.00465647  0.08663904]
Stock Position:  0.0019650645616285734
Bond Position:  [3.32075228]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.49440602]
Stock Price:  88.15924783192611
PL:  [3.49440602]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 2.39339407e-04 -1.10329596e-01  4.65735362e-02]
 [ 5.48199042e-01  1.92193490e-01  1.41945952e-01]
 [-4.00580594e-01 -2.82255771e-01  4.14809877e-02]
 [ 2.17333944e-01  1.63872044e+00  1.39272237e+00]
 [-4.81467054e-02 -3.05582682e-02 -1.49025794e-02]
 [-1.37085429e-03  1.27707926e-01 -3.38107000e-02]
 [-1.76854024e-01  2.73735173e-01  2.54037802e-01]
 [-4.00521602e-02  7.43673023e-02  2.07875889e-02]
 [ 4.59120899e-02 -9.27083170e-03 -2.92200506e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 5.10271010e-01  1.23954399e+00 -1.14774868e-01]
 [-8.93501708e-04  3.69020241e-02  6.40689185e-02]
 [-4.53383817e-01 -5.32005776e-02 -1.14249631e+00]
 [ 2.13944302e+00 -3.14539904e+00  2.67993994e+00]
 [ 5.63864909e-03 -6.00109999e-04 -1.93257371e-02]
 [ 1.84023519e-02  2.46333035e-01 -1.32395804e-01]
 [ 2.85485789e-02 -7.84667939e-02 -5.17853953e-02]
 [-2.89209753e-01 -1.85348598e+00 -1.95140301e-01]
 [ 4.41296514e-03 -8.84536111e-02  3.80287760e-01]
 [ 1.51832781e-01  3.05947305e-01  4.28083217e-01]
 [ 2.94278215e-02 -3.72711997e-02  3.99018422e-02]
 [ 1.13190430e-01 -5.13132334e-02  3.28821740e-02]
 [-1.81070745e-02 -6.67304542e-02 -6.49266568e-02]
 [-1.86192776e-01  4.00017558e-02  2.59848471e-02]
 [ 7.59311958e-02  1.26925251e-02 -2.69185619e-02]
 [ 1.34144675e-02 -4.80651539e-02  2.44438508e-01]
 [ 1.60769496e-01 -1.11578428e-01  7.31705596e-02]
 [ 4.30857664e-02 -1.72353471e-01 -8.42245351e-02]
 [ 3.75316752e-02 -5.04950541e-02  1.39654267e-02]
 [ 1.65641462e-03  6.61746471e-02 -5.02962859e-03]
 [ 1.40443113e-02 -1.45725060e-02 -7.27663018e-02]
 [-3.29375455e-02  2.25694487e-02 -5.06703263e-02]
 [-1.03916406e-01 -3.26506703e-02  4.05214389e-02]
 [ 2.34954357e-01  1.47250598e-02  4.47991940e-02]
 [-6.00148661e-02 -1.17774582e-02  3.67711862e-02]
 [-1.11917169e-01 -6.12454575e-02 -8.01002209e-02]
 [ 1.55921884e+00  1.02927037e+00  1.42188365e-01]
 [-1.10441123e-02 -1.35930261e-01 -5.57419590e-02]
 [ 3.51255931e-02 -1.35192851e-02 -1.07453304e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.05603213]
curr_Stock_Price:  99.52732382344014
curr_Factors:  [99.52732382 -1.01590715 -1.00308309]
mat_Sqrt:  [[13.2161818   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0009666  -0.03560872  0.13286134]
Stock Position:  -0.0009666038256754626
Bond Position:  [-0.95982864]


portfolio before change:  [-1.0556538]
curr_Stock_Price:  99.0117943096604
curr_Factors:  [99.01179431 -0.90327501 -1.00264634]
mat_Sqrt:  [[14.72162686  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04187071 0.06203018 0.40493229]
Stock Position:  0.04187071008912896
Bond Position:  [-5.20134794]


portfolio before change:  [-1.06987927]
curr_Stock_Price:  98.68757580847432
curr_Factors:  [98.68757581 -1.03871622 -0.99577101]
mat_Sqrt:  [[12.90315463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03485415 -0.09109766  0.11833371]
Stock Position:  -0.034854154217844824
Bond Position:  [2.36979272]


portfolio before change:  [-1.0798081]
curr_Stock_Price:  98.98094338526155
curr_Factors:  [98.98094339 -1.18966036 -0.99156731]
mat_Sqrt:  [[11.17522944  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07481946 0.52889475 3.97304926]
Stock Position:  0.07481945853178165
Bond Position:  [-8.48550869]


portfolio before change:  [-1.13245249]
curr_Stock_Price:  98.29150202820567
curr_Factors:  [98.29150203 -1.40097725 -1.00510074]
mat_Sqrt:  [[ 8.86277202  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0064795  -0.00986264 -0.04251291]
Stock Position:  -0.006479503471551056
Bond Position:  [-0.49557236]


portfolio before change:  [-1.1331341]
curr_Stock_Price:  98.3871354509267
curr_Factors:  [98.38713545 -1.41388866 -1.00867364]
mat_Sqrt:  [[ 8.72635501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00203932  0.04121756 -0.09645252]
Stock Position:  0.0020393207400606884
Bond Position:  [-1.33377702]


portfolio before change:  [-1.1356125]
curr_Stock_Price:  97.2535862493888
curr_Factors:  [97.25358625 -0.97988288 -0.99513725]
mat_Sqrt:  [[13.49476357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0051222   0.08834765  0.72469914]
Stock Position:  -0.005122195460110297
Bond Position:  [-0.63746062]


portfolio before change:  [-1.1313904]
curr_Stock_Price:  96.41375459754957
curr_Factors:  [96.4137546  -1.22245741 -1.00629534]
mat_Sqrt:  [[10.38015825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198733  0.02400194  0.0593012 ]
Stock Position:  -0.0019873251290621016
Bond Position:  [-0.93978493]


portfolio before change:  [-1.13073134]
curr_Stock_Price:  96.02300343487792
curr_Factors:  [96.02300343 -1.22498602 -0.99500396]
mat_Sqrt:  [[10.42907728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00364895 -0.00299215 -0.08335667]
Stock Position:  0.003648949028232436
Bond Position:  [-1.48111438]


portfolio before change:  [-1.13260147]
curr_Stock_Price:  95.56123168209407
curr_Factors:  [95.56123168 -1.20737002 -1.00934071]
mat_Sqrt:  [[10.41301513  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [8.39400727e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  8.394007271330686e-05
Bond Position:  [-1.14062288]


portfolio before change:  [-1.13277718]
curr_Stock_Price:  95.16664186624138
curr_Factors:  [95.16664187 -1.11200703 -0.99665437]
mat_Sqrt:  [[11.55326493  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06403935  0.4000611  -0.32742075]
Stock Position:  0.06403934729503691
Bond Position:  [-7.22718681]


portfolio before change:  [-1.05713318]
curr_Stock_Price:  96.36196092566405
curr_Factors:  [96.36196093 -1.25223869 -1.01422946]
mat_Sqrt:  [[ 9.99058733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00197357 0.01191008 0.18277079]
Stock Position:  0.001973568216870195
Bond Position:  [-1.24731008]


portfolio before change:  [-1.05752068]
curr_Stock_Price:  96.24462101587079
curr_Factors:  [96.24462102 -1.24802174 -0.99117735]
mat_Sqrt:  [[10.25426784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06801601 -0.01717041 -3.25922395]
Stock Position:  -0.06801601360905564
Bond Position:  [5.48865477]


portfolio before change:  [-1.0307922]
curr_Stock_Price:  95.86173537206477
curr_Factors:  [95.86173537 -0.89351497 -1.00539937]
mat_Sqrt:  [[14.35348196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.14243454 -1.01517318  7.64512271]
Stock Position:  0.14243453865514694
Bond Position:  [-14.68481425]


portfolio before change:  [-0.97232288]
curr_Stock_Price:  96.2851230871394
curr_Factors:  [96.28512309 -1.24348709 -1.02933736]
mat_Sqrt:  [[ 9.91936965  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00015841 -0.00019368 -0.05513095]
Stock Position:  0.00015840750214561069
Bond Position:  [-0.98757517]


portfolio before change:  [-0.97240262]
curr_Stock_Price:  96.56113189508773
curr_Factors:  [96.5611319  -1.3920866  -1.00688368]
mat_Sqrt:  [[ 8.76885306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00475087  0.07950365 -0.37768838]
Stock Position:  0.0047508712194307984
Bond Position:  [-1.43115212]


portfolio before change:  [-0.9712676]
curr_Stock_Price:  96.83769599881637
curr_Factors:  [96.837696   -1.32356733 -1.01433465]
mat_Sqrt:  [[ 9.34773774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00020978 -0.02532505 -0.14772932]
Stock Position:  0.00020977932980663022
Bond Position:  [-0.99158215]


portfolio before change:  [-0.97130587]
curr_Stock_Price:  97.2461429139102
curr_Factors:  [97.24614291 -1.11975262 -1.04715015]
mat_Sqrt:  [[11.13777568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06351213 -0.59821003 -0.55668096]
Stock Position:  -0.06351212860508038
Bond Position:  [5.20500366]


portfolio before change:  [-1.05551477]
curr_Stock_Price:  98.5822587583853
curr_Factors:  [98.58225876 -1.31873904 -1.04259918]
mat_Sqrt:  [[ 9.29571083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00688311 -0.02854828  1.08485513]
Stock Position:  0.006883105827810278
Bond Position:  [-1.73406689]


portfolio before change:  [-1.05741887]
curr_Stock_Price:  98.33711762687199
curr_Factors:  [98.33711763 -1.30601283 -1.07131909]
mat_Sqrt:  [[ 9.125472    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03305759 0.09874407 1.22120226]
Stock Position:  0.033057592437109776
Bond Position:  [-4.30820723]


portfolio before change:  [-1.06413637]
curr_Stock_Price:  98.15020336127796
curr_Factors:  [98.15020336 -1.36652145 -1.08391778]
mat_Sqrt:  [[ 8.4660137   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00353942 -0.01202923  0.11382885]
Stock Position:  0.003539422479341787
Bond Position:  [-1.4115314]


portfolio before change:  [-1.06535423]
curr_Stock_Price:  97.85597250319297
curr_Factors:  [97.8559725  -1.22869732 -1.09657832]
mat_Sqrt:  [[ 9.56605688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01143922 -0.01656127  0.09380369]
Stock Position:  0.011439217558285305
Bond Position:  [-2.18474999]


portfolio before change:  [-1.06795321]
curr_Stock_Price:  97.65264838998814
curr_Factors:  [97.65264839 -1.13677056 -1.11905901]
mat_Sqrt:  [[10.23268703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00439586 -0.02153716 -0.18521768]
Stock Position:  -0.004395860995319622
Bond Position:  [-0.63868574]


portfolio before change:  [-1.06824646]
curr_Stock_Price:  97.70119585463573
curr_Factors:  [97.70119585 -1.20184352 -1.12299528]
mat_Sqrt:  [[ 9.5550996   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01807656  0.01291051  0.07412754]
Stock Position:  -0.01807655848151085
Bond Position:  [0.69785492]


portfolio before change:  [-1.05700602]
curr_Stock_Price:  97.0841981780838
curr_Factors:  [97.08419818 -1.04136195 -1.1317539 ]
mat_Sqrt:  [[11.05035744  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00660859  0.00409649 -0.07679116]
Stock Position:  0.0066085933046297835
Bond Position:  [-1.69859601]


portfolio before change:  [-1.05570622]
curr_Stock_Price:  97.31301283604408
curr_Factors:  [97.31301284 -1.2205828  -1.12696434]
mat_Sqrt:  [[ 9.30345262  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00575045 -0.01551296  0.69731503]
Stock Position:  0.005750446934624732
Bond Position:  [-1.61529953]


portfolio before change:  [-1.05328525]
curr_Stock_Price:  97.7691324739531
curr_Factors:  [97.76913247 -1.33203736 -1.13187752]
mat_Sqrt:  [[ 8.32026439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01838037 -0.03601178  0.20873524]
Stock Position:  0.018380368132298357
Bond Position:  [-2.8503179]


portfolio before change:  [-1.0444082]
curr_Stock_Price:  98.27148182641606
curr_Factors:  [98.27148183 -1.42485219 -1.10786092]
mat_Sqrt:  [[ 7.80699995  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011897  -0.05562684 -0.24026915]
Stock Position:  -0.0011897015207061345
Bond Position:  [-0.92749447]


portfolio before change:  [-1.04511249]
curr_Stock_Price:  98.76601597491477
curr_Factors:  [98.76601597 -1.48174885 -1.12317762]
mat_Sqrt:  [[ 7.29965513  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00412007 -0.01629721  0.03983948]
Stock Position:  0.004120070837347465
Bond Position:  [-1.45203547]


portfolio before change:  [-1.04638827]
curr_Stock_Price:  98.50042250833415
curr_Factors:  [98.50042251 -1.42911283 -1.14004781]
mat_Sqrt:  [[ 7.54511397  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187374  0.02135778 -0.01434813]
Stock Position:  0.0018737409811215896
Bond Position:  [-1.23095255]


portfolio before change:  [-1.0451081]
curr_Stock_Price:  99.26576211552558
curr_Factors:  [99.26576212 -1.33984566 -1.13756122]
mat_Sqrt:  [[ 8.33441919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045398 -0.00470326 -0.207582  ]
Stock Position:  -0.00045397862680924227
Bond Position:  [-1.00004357]


portfolio before change:  [-1.0456043]
curr_Stock_Price:  100.08338411948927
curr_Factors:  [100.08338412  -1.1988302   -1.15090344]
mat_Sqrt:  [[ 9.54741118  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00405069  0.00728426 -0.14454834]
Stock Position:  -0.004050691064495583
Bond Position:  [-0.64019743]


portfolio before change:  [-1.04393988]
curr_Stock_Price:  99.65272899851632
curr_Factors:  [99.652729   -0.82091062 -1.15720618]
mat_Sqrt:  [[13.78491169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00742187 -0.01053796  0.11559639]
Stock Position:  -0.007421867785541095
Bond Position:  [-0.3043305]


portfolio before change:  [-1.04756937]
curr_Stock_Price:  100.13662978449798
curr_Factors:  [100.13662978  -1.01343809  -1.15705417]
mat_Sqrt:  [[11.42773502  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02162324 0.00475249 0.12779963]
Stock Position:  0.021623243251778015
Bond Position:  [-3.21284807]


portfolio before change:  [-1.04840389]
curr_Stock_Price:  100.11660990273118
curr_Factors:  [100.1166099   -1.01096723  -1.14940609]
mat_Sqrt:  [[11.54165062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00475782 -0.00380116  0.10489796]
Stock Position:  -0.00475781537527285
Bond Position:  [-0.57206755]


portfolio before change:  [-1.04886067]
curr_Stock_Price:  100.19758511708802
curr_Factors:  [100.19758512  -0.85201934  -1.15078006]
mat_Sqrt:  [[13.52236103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01041011 -0.01976689 -0.22850363]
Stock Position:  -0.01041010770815651
Bond Position:  [-0.00579302]


portfolio before change:  [-1.05118798]
curr_Stock_Price:  100.42107848444113
curr_Factors:  [100.42107848  -0.95308733  -1.14043613]
mat_Sqrt:  [[12.37710843  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.1452958  0.33219558 0.40562383]
Stock Position:  0.14529579849854538
Bond Position:  [-15.64194877]


portfolio before change:  [-0.91604021]
curr_Stock_Price:  101.3646924089646
curr_Factors:  [101.36469241  -1.01889902  -1.11890193]
mat_Sqrt:  [[11.95230181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00419744 -0.0438713  -0.15901629]
Stock Position:  -0.004197437535997918
Bond Position:  [-0.49056825]


portfolio before change:  [-0.91610672]
curr_Stock_Price:  101.36592657089048
curr_Factors:  [101.36592657  -0.7863255   -1.12760953]
mat_Sqrt:  [[14.95135565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00069774 -0.00436333 -0.30653437]
Stock Position:  0.0006977405307304988
Bond Position:  [-0.98683383]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.91653895]
Stock Price:  100.92325463882938
PL:  [-1.83979359]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-3.25315885e-02 -6.23472489e-02  2.36904288e-01]
 [ 1.08518329e+00  2.44502400e-01  3.13672477e-01]
 [-1.86371998e-01 -8.50811807e-02  3.52328283e-02]
 [ 1.17138398e-01  6.93078081e-01  7.10424534e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-2.01390525e-02  2.59475489e-01 -1.16642397e-01]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [-4.62842102e-02  8.73504964e-02  1.55250152e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-4.85911321e-02 -1.75793525e-02  2.00383845e-02]
 [ 9.34336194e-01  1.78854851e+00 -3.26768885e-01]
 [-3.77352509e-04  4.44139458e-03  8.36126696e-03]
 [-2.44370675e-01 -1.37254633e-03 -4.81549758e-01]
 [ 1.64571194e+00 -3.15757277e+00  2.64708719e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.26505642e-01 -2.59216902e-02 -1.69784111e-02]
 [-7.82010285e-02 -4.32412752e-02 -5.53539095e-02]
 [-2.73295969e-01 -1.76996653e+00 -1.97707239e-01]
 [ 3.88353903e-04  2.47356623e-02  9.96033955e-02]
 [ 1.51730998e-01  8.38741238e-02  3.60311662e-01]
 [ 4.58684609e-02 -1.40397117e-01  3.46096872e-02]
 [ 1.07550739e-01 -5.01952623e-02  6.46265870e-03]
 [-3.99032116e-02  4.93495845e-02 -1.82830589e-03]
 [-2.04617730e-02 -7.14881213e-02  3.90677541e-03]
 [ 4.66427134e-02 -3.21574902e-02 -2.25700250e-03]
 [ 2.17572529e-02 -4.66004280e-02  2.55419528e-01]
 [ 8.05899419e-02 -1.15517143e-01  3.81018694e-02]
 [-1.84671543e-02 -6.95158239e-02  9.40703903e-03]
 [ 1.69936648e-02 -4.92511136e-02  4.13422985e-02]
 [-1.69663013e-02  6.91207812e-02  4.07757111e-02]
 [-1.36285918e-02 -1.69297893e-02 -6.74504817e-02]
 [-2.05048501e-02  2.11979633e-02 -5.36351267e-02]
 [-1.03456285e-01 -3.74878453e-02  3.06522810e-02]
 [ 1.00782295e-01  6.23814162e-03  1.84215909e-02]
 [-6.26748083e-03 -3.57598579e-02  2.84464651e-02]
 [-1.19534163e-01 -6.94940917e-02 -8.28686473e-02]
 [ 1.93675785e+00  1.25078482e+00  1.54017396e-01]
 [-1.14702412e-02 -5.19019075e-02  1.57645804e-02]
 [ 3.27321068e-02 -1.42797746e-02 -6.50771545e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.8343349]
curr_Stock_Price:  100.05820953017246
curr_Factors:  [100.05820953  -0.78441817  -0.95958241]
mat_Sqrt:  [[17.49213826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.77206343e-04 -2.01224880e-02  6.75821992e-01]
Stock Position:  0.00017720634295749767
Bond Position:  [2.81660395]


portfolio before change:  [2.83476]
curr_Stock_Price:  100.47017913028573
curr_Factors:  [100.47017913  -0.7662051   -0.9412874 ]
mat_Sqrt:  [[18.21724109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06582337 0.07891281 0.89482027]
Stock Position:  0.06582337314778881
Bond Position:  [-3.77852609]


portfolio before change:  [2.85087793]
curr_Stock_Price:  100.7222215418408
curr_Factors:  [100.72222154  -0.65396966  -0.90791625]
mat_Sqrt:  [[21.12549357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00930379 -0.02745983  0.10050945]
Stock Position:  -0.009303794459267687
Bond Position:  [3.78797678]


portfolio before change:  [2.84562476]
curr_Stock_Price:  101.33774491163233
curr_Factors:  [101.33774491  -0.52870383  -0.9052634 ]
mat_Sqrt:  [[24.15500763  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01670988 0.22368999 2.02664345]
Stock Position:  0.016709875476261453
Bond Position:  [1.15228366]


portfolio before change:  [2.82596221]
curr_Stock_Price:  100.15242231036645
curr_Factors:  [100.15242231  -0.40813654  -0.91121044]
mat_Sqrt:  [[26.77172435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219059 -0.01106097 -0.05874131]
Stock Position:  -0.0021905948295185495
Bond Position:  [3.04535559]


portfolio before change:  [2.82839032]
curr_Stock_Price:  99.21778126459442
curr_Factors:  [99.21778126 -0.48311582 -0.93452381]
mat_Sqrt:  [[24.0390024   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00037508  0.08374535 -0.33274829]
Stock Position:  0.00037508337403378876
Bond Position:  [2.79117538]


portfolio before change:  [2.8288067]
curr_Stock_Price:  99.3976365559492
curr_Factors:  [99.39763656 -0.26132097 -0.92923167]
mat_Sqrt:  [[30.22216804  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219343 -0.00251018 -0.21167328]
Stock Position:  -0.0021934337349967773
Bond Position:  [3.04682883]


portfolio before change:  [2.8298119]
curr_Stock_Price:  99.11300688878198
curr_Factors:  [99.11300689 -0.22168967 -0.93350095]
mat_Sqrt:  [[31.22034823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080988  0.02819225  0.04428855]
Stock Position:  -0.0008098831615031441
Bond Position:  [2.91008185]


portfolio before change:  [2.83156641]
curr_Stock_Price:  97.39580278264395
curr_Factors:  [97.39580278 -0.51194198 -0.92171569]
mat_Sqrt:  [[23.22258849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00223882  0.0064198  -0.11330016]
Stock Position:  0.0022388203348611725
Bond Position:  [2.61351471]


portfolio before change:  [2.8341132]
curr_Stock_Price:  98.38743226106469
curr_Factors:  [98.38743226 -0.68074057 -0.93414349]
mat_Sqrt:  [[19.57061121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245721 -0.00567371  0.05716393]
Stock Position:  -0.002457214228451901
Bond Position:  [3.0758722]


portfolio before change:  [2.83037699]
curr_Stock_Price:  100.06441954335249
curr_Factors:  [100.06441954  -0.73425417  -0.91804513]
mat_Sqrt:  [[19.17322689  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06429386  0.57725155 -0.93218067]
Stock Position:  0.06429385717768794
Bond Position:  [-3.6031505]


portfolio before change:  [2.81480779]
curr_Stock_Price:  99.82926823711396
curr_Factors:  [99.82926824 -0.80488708 -0.90978346]
mat_Sqrt:  [[17.97156644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00012442 0.00143345 0.02385237]
Stock Position:  0.00012441763721347818
Bond Position:  [2.80238727]


portfolio before change:  [2.81536782]
curr_Stock_Price:  101.51483898131019
curr_Factors:  [101.51483898  -0.99391075  -0.90771968]
mat_Sqrt:  [[15.15869901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.26237606e-02 -4.42987422e-04 -1.37372742e+00]
Stock Position:  -0.022623760616644003
Bond Position:  [5.11201524]


portfolio before change:  [2.80701248]
curr_Stock_Price:  101.91240274832889
curr_Factors:  [101.91240275  -0.94318216  -0.90021708]
mat_Sqrt:  [[16.13054063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09556465 -1.01910223  7.55140294]
Stock Position:  0.09556465250064332
Bond Position:  [-6.93221088]


portfolio before change:  [2.78396248]
curr_Stock_Price:  101.68027283819643
curr_Factors:  [101.68027284  -0.83294038  -0.891131  ]
mat_Sqrt:  [[18.13351571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00119499 -0.03053791  0.10625201]
Stock Position:  -0.001194990162490177
Bond Position:  [2.90546941]


portfolio before change:  [2.78538816]
curr_Stock_Price:  100.79117282908078
curr_Factors:  [100.79117283  -0.69537371  -0.89238319]
mat_Sqrt:  [[20.60005774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00571594 -0.00836619 -0.04843468]
Stock Position:  0.005715940076312735
Bond Position:  [2.20927185]


portfolio before change:  [2.78533563]
curr_Stock_Price:  100.73366681670514
curr_Factors:  [100.73366682  -0.92505201  -0.910054  ]
mat_Sqrt:  [[16.07674904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00611608 -0.01395606 -0.1579093 ]
Stock Position:  -0.006116080189048786
Bond Position:  [3.40143081]


portfolio before change:  [2.78821902]
curr_Stock_Price:  100.33174506462287
curr_Factors:  [100.33174506  -0.93878239  -0.92191216]
mat_Sqrt:  [[15.60806243  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0432434  -0.57125424 -0.56400372]
Stock Position:  -0.04324340049435979
Bond Position:  [7.12690486]


portfolio before change:  [2.77745454]
curr_Stock_Price:  100.60127520469851
curr_Factors:  [100.6012752   -1.03730369  -0.92067817]
mat_Sqrt:  [[14.19916377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00181482 0.0079834  0.28414076]
Stock Position:  0.0018148222113532496
Bond Position:  [2.59488111]


portfolio before change:  [2.77675371]
curr_Stock_Price:  100.03636464772377
curr_Factors:  [100.03636465  -0.83140223  -0.89958695]
mat_Sqrt:  [[17.71735371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0136815  0.02707026 1.02786888]
Stock Position:  0.013681503775476155
Bond Position:  [1.40810581]


portfolio before change:  [2.78391842]
curr_Stock_Price:  100.5471770789046
curr_Factors:  [100.54717708  -1.17067548  -0.90096737]
mat_Sqrt:  [[12.66679732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0019164  -0.04531297  0.0987318 ]
Stock Position:  0.001916403296903354
Bond Position:  [2.59122947]


portfolio before change:  [2.78343817]
curr_Stock_Price:  100.12755134807661
curr_Factors:  [100.12755135  -1.35841475  -0.8996299 ]
mat_Sqrt:  [[10.46880871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00942073 -0.01620045  0.01843617]
Stock Position:  0.009420733704031221
Bond Position:  [1.84016317]


portfolio before change:  [2.77834515]
curr_Stock_Price:  99.56251519156457
curr_Factors:  [99.56251519 -1.2653133  -0.89233415]
mat_Sqrt:  [[11.50910303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262427  0.01592751 -0.00521565]
Stock Position:  -0.0026242680351442546
Bond Position:  [3.03962387]


portfolio before change:  [2.77881384]
curr_Stock_Price:  99.52870897658703
curr_Factors:  [99.52870898 -1.19229314 -0.88303032]
mat_Sqrt:  [[12.49242771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027422  -0.02307269  0.01114494]
Stock Position:  -0.0027422017723836597
Bond Position:  [3.05174164]


portfolio before change:  [2.78039003]
curr_Stock_Price:  99.09303856866292
curr_Factors:  [99.09303857 -1.09637559 -0.90632713]
mat_Sqrt:  [[13.37458784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296218 -0.01037879 -0.0064386 ]
Stock Position:  0.002962176105353293
Bond Position:  [2.486859]


portfolio before change:  [2.77882456]
curr_Stock_Price:  98.4596047982988
curr_Factors:  [98.4596048  -1.13511865 -0.8874408 ]
mat_Sqrt:  [[13.02781795  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00494191 -0.01504022  0.72864082]
Stock Position:  0.004941907655012821
Bond Position:  [2.29224629]


portfolio before change:  [2.77998918]
curr_Stock_Price:  98.63728217150314
curr_Factors:  [98.63728217 -1.01295152 -0.87679546]
mat_Sqrt:  [[14.90508349  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00434668 -0.037283    0.10869403]
Stock Position:  0.004346679133657235
Bond Position:  [2.35124456]


portfolio before change:  [2.7796195]
curr_Stock_Price:  98.48461425790522
curr_Factors:  [98.48461426 -1.16914714 -0.9102344 ]
mat_Sqrt:  [[12.3113154   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249663 -0.02243614  0.02683566]
Stock Position:  -0.0024966307561437094
Bond Position:  [3.02549922]


portfolio before change:  [2.77891917]
curr_Stock_Price:  98.91661422140304
curr_Factors:  [98.91661422 -1.071408   -0.91888776]
mat_Sqrt:  [[13.51745015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113774 -0.01589573  0.11793807]
Stock Position:  0.0011377356360967252
Bond Position:  [2.66637821]


portfolio before change:  [2.78026242]
curr_Stock_Price:  99.80428789459198
curr_Factors:  [99.80428789 -0.96394314 -0.92387042]
mat_Sqrt:  [[15.11061658  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00036175 0.02230864 0.11632175]
Stock Position:  0.0003617474002996443
Bond Position:  [2.74415848]


portfolio before change:  [2.78096905]
curr_Stock_Price:  100.80937963866546
curr_Factors:  [100.80937964  -0.85076617  -0.92186704]
mat_Sqrt:  [[17.12600714  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180151 -0.00546407 -0.19241745]
Stock Position:  -0.001801508214338791
Bond Position:  [2.96257798]


portfolio before change:  [2.78232987]
curr_Stock_Price:  100.2595794729105
curr_Factors:  [100.25957947  -0.74019987  -0.94918121]
mat_Sqrt:  [[18.51130339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146538  0.00684161 -0.15300609]
Stock Position:  -0.0014653780891697716
Bond Position:  [2.92924806]


portfolio before change:  [2.78183207]
curr_Stock_Price:  100.84917633666231
curr_Factors:  [100.84917634  -0.65012346  -0.96057071]
mat_Sqrt:  [[20.14451271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00520497 -0.01209915  0.08744243]
Stock Position:  -0.005204970221187574
Bond Position:  [3.30674903]


portfolio before change:  [2.78863654]
curr_Stock_Price:  99.62129125704621
curr_Factors:  [99.62129126 -0.72648722 -0.99859013]
mat_Sqrt:  [[17.74845652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00596198 0.00201335 0.05255167]
Stock Position:  0.005961979939574552
Bond Position:  [2.1946964]


portfolio before change:  [2.79670869]
curr_Stock_Price:  100.92921234105862
curr_Factors:  [100.92921234  -0.88401609  -0.99378562]
mat_Sqrt:  [[15.43469183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050278 -0.01154144  0.08114985]
Stock Position:  -0.0005027843112502137
Bond Position:  [2.84745432]


portfolio before change:  [2.79787163]
curr_Stock_Price:  99.32418189959137
curr_Factors:  [99.3241819  -0.70057008 -0.97916009]
mat_Sqrt:  [[18.5164384   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00813521 -0.02242912 -0.23640118]
Stock Position:  -0.008135207961656172
Bond Position:  [3.60589451]


portfolio before change:  [2.81940556]
curr_Stock_Price:  96.73258766423362
curr_Factors:  [96.73258766 -0.74274785 -0.96355885]
mat_Sqrt:  [[17.56035214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.12662115 0.40368906 0.43936876]
Stock Position:  0.1266211451783907
Bond Position:  [-9.42898547]


portfolio before change:  [2.91304535]
curr_Stock_Price:  97.48142378564486
curr_Factors:  [97.48142379 -0.70051021 -0.99589626]
mat_Sqrt:  [[17.87235969  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105452 -0.01675127  0.04497196]
Stock Position:  -0.0010545189609449028
Bond Position:  [3.01584136]


portfolio before change:  [2.91259799]
curr_Stock_Price:  98.26316231619754
curr_Factors:  [98.26316232 -0.88087348 -0.99985797]
mat_Sqrt:  [[14.98302297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00110348 -0.00460878 -0.18564701]
Stock Position:  0.00110347835395449
Bond Position:  [2.80416672]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.91233587]
Stock Price:  97.70794923791588
PL:  [2.91233587]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-3.19151784e-02 -6.39677592e-02  2.32607990e-01]
 [ 1.24750038e+00  2.57597325e-01  3.67695387e-01]
 [ 8.68740074e-02  1.82392332e-01  3.52504399e-02]
 [ 1.26509476e-01  1.00649381e+00  8.15639802e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.43234972e-02 -6.12096807e-02  4.98261642e-02]
 [-3.21888650e-02 -1.19266517e-01  2.13006366e-03]
 [ 1.19914083e-01  8.17536591e-02 -9.90307075e-02]
 [-5.37273005e-03  8.63474162e-02 -4.98129400e-02]
 [-2.34920759e-01 -8.36266462e-02 -9.46959392e-02]
 [ 6.99487308e-01  1.34805724e+00 -2.43743418e-01]
 [-1.99555929e-04  3.26501244e-02 -5.83663356e-02]
 [-2.84342192e-01 -3.78847392e-03 -5.73437906e-01]
 [ 1.69539414e+00 -3.25206046e+00  2.72841297e+00]
 [ 4.29599321e-04 -9.28671182e-02  3.61687069e-02]
 [ 1.31515663e-01 -4.61165502e-02 -3.33574235e-03]
 [-1.23663737e-01 -1.42940818e-01 -4.03721130e-02]
 [-2.65551498e-01 -1.73686829e+00 -2.01682521e-01]
 [-1.17920422e-02  4.42562067e-02  2.07714645e-01]
 [ 2.39271902e-01 -1.51121262e-01  3.70092548e-01]
 [ 5.22983241e-02 -2.31744356e-02  5.25544007e-02]
 [ 1.57368794e-01 -5.54339501e-02 -2.03101548e-02]
 [ 1.53792144e-01  2.14554553e-01  1.76691445e-01]
 [-9.27892687e-02  1.17286022e-02  9.64287329e-02]
 [-4.93139106e-02 -1.78086985e-01  7.03485341e-02]
 [ 4.71571982e-02 -9.23251335e-03  9.54464313e-02]
 [ 4.79239901e-01 -9.10756440e-02  2.38024386e-01]
 [ 2.36877028e-02 -1.11040670e-01 -1.47835125e-02]
 [-8.95480243e-03 -7.44055282e-02 -2.21630947e-03]
 [ 8.28156798e-02 -7.57376814e-03  8.47550443e-02]
 [-2.08879632e-02 -1.47570272e-02 -6.58997336e-02]
 [-3.55114854e-02  2.28533872e-02 -5.00565239e-02]
 [-1.02772059e-01 -3.77022445e-02  3.05229480e-02]
 [ 2.35316682e-01  1.50436096e-02  4.50646995e-02]
 [ 7.89138538e-02 -3.60725106e-02 -3.33935988e-03]
 [-1.15105612e-01 -6.32728413e-02 -8.25364250e-02]
 [ 1.49379841e+00  9.87467729e-01  1.39472122e-01]
 [-5.64320292e-02  2.19739022e-03  1.23567194e-02]
 [ 3.47335901e-02 -1.38702291e-02 -1.00309758e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.38256369]
curr_Stock_Price:  99.99656010823468
curr_Factors:  [99.99656011 -0.81414196 -0.99715669]
mat_Sqrt:  [[16.34361236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.53476749e-04 -2.06455055e-02  6.63565849e-01]
Stock Position:  0.0001534767491262248
Bond Position:  [2.36721654]


portfolio before change:  [2.38297821]
curr_Stock_Price:  100.76932047617281
curr_Factors:  [100.76932048  -0.88127157  -0.99891748]
mat_Sqrt:  [[15.37349475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08944861 0.08313918 1.04893259]
Stock Position:  0.0894486089512569
Bond Position:  [-6.63069733]


portfolio before change:  [2.44094622]
curr_Stock_Price:  101.42664650150402
curr_Factors:  [101.4266465   -0.96639139  -1.00920313]
mat_Sqrt:  [[14.0657297   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00933476 0.05886687 0.10055969]
Stock Position:  0.009334755825513436
Bond Position:  [1.49415324]


portfolio before change:  [2.43550433]
curr_Stock_Price:  100.82366635478208
curr_Factors:  [100.82366635  -0.98275562  -1.04072406]
mat_Sqrt:  [[13.32835117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03739779 0.32484448 2.32679332]
Stock Position:  0.03739779480082436
Bond Position:  [-1.33507846]


portfolio before change:  [2.43830862]
curr_Stock_Price:  100.90311458225574
curr_Factors:  [100.90311458  -0.95927064  -1.04975027]
mat_Sqrt:  [[13.5331183   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00433352 -0.01106097 -0.05874131]
Stock Position:  -0.0043335172005594695
Bond Position:  [2.875574]


portfolio before change:  [2.43629386]
curr_Stock_Price:  101.45099078363673
curr_Factors:  [101.45099078  -1.46387598  -1.04257532]
mat_Sqrt:  [[ 8.2740535   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00749329 -0.01975534  0.14214018]
Stock Position:  0.007493285688514543
Bond Position:  [1.6760926]


portfolio before change:  [2.44211089]
curr_Stock_Price:  102.19932834144909
curr_Factors:  [102.19932834  -1.34191984  -1.05115153]
mat_Sqrt:  [[ 9.33577444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00600906 -0.0384931   0.00607648]
Stock Position:  -0.0060090615711778945
Bond Position:  [3.05623295]


portfolio before change:  [2.44476039]
curr_Stock_Price:  101.82199113601557
curr_Factors:  [101.82199114  -1.38980458  -1.07863715]
mat_Sqrt:  [[ 8.62602995  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01349258  0.02638588 -0.28250704]
Stock Position:  0.01349258244645522
Bond Position:  [1.07091877]


portfolio before change:  [2.43895602]
curr_Stock_Price:  101.38188009938686
curr_Factors:  [101.3818801   -1.36223558  -1.05361053]
mat_Sqrt:  [[ 9.05256608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0002303   0.02786851 -0.14210245]
Stock Position:  0.0002303036128635082
Bond Position:  [2.41560741]


portfolio before change:  [2.43927613]
curr_Stock_Price:  101.46064337298579
curr_Factors:  [101.46064337  -1.39713281  -1.08347876]
mat_Sqrt:  [[ 8.4914468   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03195224 -0.02699038 -0.27014116]
Stock Position:  -0.03195223511608662
Bond Position:  [5.68117047]


portfolio before change:  [2.4360844]
curr_Stock_Price:  101.58276084184537
curr_Factors:  [101.58276084  -1.52205795  -1.05792939]
mat_Sqrt:  [[ 7.69742993  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12015756  0.4350836  -0.69533213]
Stock Position:  0.12015756311707836
Bond Position:  [-9.7698526]


portfolio before change:  [2.40474778]
curr_Stock_Price:  101.33212903220537
curr_Factors:  [101.33212903  -1.30554906  -1.06882545]
mat_Sqrt:  [[ 9.43125348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057774  0.01053778 -0.16650291]
Stock Position:  -0.0005777445766820639
Bond Position:  [2.46329187]


portfolio before change:  [2.40535158]
curr_Stock_Price:  100.82001777710674
curr_Factors:  [100.82001778  -1.16780909  -1.04655576]
mat_Sqrt:  [[11.01185111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.65213832e-02 -1.22272470e-03 -1.63585873e+00]
Stock Position:  -0.03652138317974734
Bond Position:  [6.08743808]


portfolio before change:  [2.39091564]
curr_Stock_Price:  101.23612804669874
curr_Factors:  [101.23612805  -0.99952708  -1.03674976]
mat_Sqrt:  [[13.21270469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12022558 -1.049598    7.78340275]
Stock Position:  0.12022557715947528
Bond Position:  [-9.78025629]


portfolio before change:  [2.3953061]
curr_Stock_Price:  101.28281588669141
curr_Factors:  [101.28281589  -1.12790302  -1.03926701]
mat_Sqrt:  [[11.59700336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096093 -0.02997273  0.10317925]
Stock Position:  -0.0009609306018048128
Bond Position:  [2.49263186]


portfolio before change:  [2.39505281]
curr_Stock_Price:  101.87067187392978
curr_Factors:  [101.87067187  -1.07712528  -1.07052896]
mat_Sqrt:  [[11.89418759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01020845 -0.01488405 -0.00951594]
Stock Position:  0.010208453132163597
Bond Position:  [1.35511083]


portfolio before change:  [2.39636996]
curr_Stock_Price:  101.98310320596264
curr_Factors:  [101.98310321  -1.13189263  -1.08948119]
mat_Sqrt:  [[11.06108758  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01456297 -0.04613395 -0.1151704 ]
Stock Position:  -0.014562974091687528
Bond Position:  [3.88154725]


portfolio before change:  [2.38950963]
curr_Stock_Price:  102.48750248588361
curr_Factors:  [102.48750249  -0.99698767  -1.07041373]
mat_Sqrt:  [[12.96611559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05099881 -0.56057183 -0.5753441 ]
Stock Position:  -0.050998814613474705
Bond Position:  [7.61625077]


portfolio before change:  [2.34782276]
curr_Stock_Price:  103.32357997021536
curr_Factors:  [103.32357997  -1.15720295  -1.07890618]
mat_Sqrt:  [[11.04255554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00358987 0.01428363 0.59255206]
Stock Position:  0.0035898658008533483
Bond Position:  [1.97690497]


portfolio before change:  [2.34296543]
curr_Stock_Price:  101.90167191094527
curr_Factors:  [101.90167191  -1.14668648  -1.08575776]
mat_Sqrt:  [[10.93057725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02597934 -0.04877418  1.05577103]
Stock Position:  0.025979344200871536
Bond Position:  [-0.30437318]


portfolio before change:  [2.35040267]
curr_Stock_Price:  102.18941145996364
curr_Factors:  [102.18941146  -1.07299747  -1.08896086]
mat_Sqrt:  [[11.76194989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00495628 -0.00747952  0.14992308]
Stock Position:  0.00495627722743061
Bond Position:  [1.84392361]


portfolio before change:  [2.35259545]
curr_Stock_Price:  102.58532962095745
curr_Factors:  [102.58532962  -1.4177362   -1.09739207]
mat_Sqrt:  [[ 8.29428458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01710908 -0.01789123 -0.05793922]
Stock Position:  0.017109081748976643
Bond Position:  [0.59745466]


portfolio before change:  [2.36258025]
curr_Stock_Price:  103.16456077013184
curr_Factors:  [103.16456077  -1.31454569  -1.09927804]
mat_Sqrt:  [[ 9.23039328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02531364 0.06924718 0.50405151]
Stock Position:  0.025313644965248874
Bond Position:  [-0.24889081]


portfolio before change:  [2.36132116]
curr_Stock_Price:  103.11605025339756
curr_Factors:  [103.11605025  -1.27278767  -1.10020666]
mat_Sqrt:  [[ 9.61054297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00735773  0.00378539  0.27508433]
Stock Position:  -0.00735772633610699
Bond Position:  [3.12002084]


portfolio before change:  [2.36033854]
curr_Stock_Price:  103.30260908246476
curr_Factors:  [103.30260908  -1.27255423  -1.11565571]
mat_Sqrt:  [[ 9.48254457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0075197  -0.05747733  0.20068479]
Stock Position:  -0.007519704152101293
Bond Position:  [3.1371436]


portfolio before change:  [2.37045712]
curr_Stock_Price:  102.00915213597253
curr_Factors:  [102.00915214  -1.30458167  -1.12799997]
mat_Sqrt:  [[ 8.957408    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00722927 -0.00297978  0.2722821 ]
Stock Position:  0.007229272187551811
Bond Position:  [1.63300519]


portfolio before change:  [2.37392006]
curr_Stock_Price:  102.4599310532442
curr_Factors:  [102.45993105  -1.24463757  -1.14755761]
mat_Sqrt:  [[ 9.36778457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05436031 -0.02939454  0.67901732]
Stock Position:  0.054360311467217495
Bond Position:  [-3.1958337]


portfolio before change:  [2.34762544]
curr_Stock_Price:  101.9835702630646
curr_Factors:  [101.98357026  -1.11164546  -1.11457568]
mat_Sqrt:  [[11.00765111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018133 -0.03583822 -0.04217325]
Stock Position:  -0.00018133303723763007
Bond Position:  [2.36611843]


portfolio before change:  [2.34784542]
curr_Stock_Price:  102.40158851648192
curr_Factors:  [102.40158852  -1.05251576  -1.11595728]
mat_Sqrt:  [[11.7098362   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210039 -0.02401428 -0.00632251]
Stock Position:  -0.0021003854473479774
Bond Position:  [2.56292822]


portfolio before change:  [2.3476139]
curr_Stock_Price:  102.66434974757306
curr_Factors:  [102.66434975  -0.76611434  -1.15951905]
mat_Sqrt:  [[14.96675691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00658595 -0.00244442  0.24178255]
Stock Position:  0.006585945267514492
Bond Position:  [1.67147212]


portfolio before change:  [2.33651911]
curr_Stock_Price:  100.94800684980102
curr_Factors:  [100.94800685  -0.87709096  -1.13840818]
mat_Sqrt:  [[13.45171309  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277674 -0.00476281 -0.1879936 ]
Stock Position:  -0.0027767433981930596
Bond Position:  [2.61682582]


portfolio before change:  [2.33501352]
curr_Stock_Price:  101.60802826520253
curr_Factors:  [101.60802827  -0.96820111  -1.14615234]
mat_Sqrt:  [[12.26523815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00334802  0.0073759  -0.14279733]
Stock Position:  -0.003348023249459189
Bond Position:  [2.67519957]


portfolio before change:  [2.33754585]
curr_Stock_Price:  100.95155054857521
curr_Factors:  [100.95155055  -0.70193746  -1.13799766]
mat_Sqrt:  [[16.03390572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00650107 -0.01216835  0.08707347]
Stock Position:  -0.006501068978696114
Bond Position:  [2.99383884]


portfolio before change:  [2.33701426]
curr_Stock_Price:  101.09088769313425
curr_Factors:  [101.09088769  -0.49574357  -1.15647257]
mat_Sqrt:  [[19.3715181   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01278094 0.0048553  0.12855704]
Stock Position:  0.012780941455483193
Bond Position:  [1.04497754]


portfolio before change:  [2.32861879]
curr_Stock_Price:  100.42379257939328
curr_Factors:  [100.42379258  -0.36188786  -1.14064577]
mat_Sqrt:  [[22.35087637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00317075 -0.01164235 -0.00952626]
Stock Position:  0.003170745445132745
Bond Position:  [2.0102005]


portfolio before change:  [2.32738715]
curr_Stock_Price:  99.9561023604375
curr_Factors:  [99.95610236 -0.38098304 -1.14219832]
mat_Sqrt:  [[21.79214857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00664775 -0.02042122 -0.23545345]
Stock Position:  -0.006647752219881445
Bond Position:  [2.99187055]


portfolio before change:  [2.33268162]
curr_Stock_Price:  99.21593292559457
curr_Factors:  [99.21593293 -0.32063179 -1.12550577]
mat_Sqrt:  [[23.3631748   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07378424 0.31870384 0.39787514]
Stock Position:  0.07378423782474029
Bond Position:  [-4.98789037]


portfolio before change:  [2.27061189]
curr_Stock_Price:  98.38315062912824
curr_Factors:  [98.38315063 -0.17024082 -1.13019069]
mat_Sqrt:  [[26.80096904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199475  0.0007092   0.03525028]
Stock Position:  -0.0019947481715933755
Bond Position:  [2.4668615]


portfolio before change:  [2.26707896]
curr_Stock_Price:  100.3088627762586
curr_Factors:  [100.30886278  -0.15293457  -1.13865383]
mat_Sqrt:  [[27.56827474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00041449 -0.0044766  -0.28615582]
Stock Position:  0.0004144872304514942
Bond Position:  [2.22550221]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.26687608]
Stock Price:  99.14818954080063
PL:  [2.26687608]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.68721963e-01 -2.22125963e-02 -2.46765510e-01]
 [ 1.43449693e+00  2.66906252e-01  4.42386146e-01]
 [-2.29308010e-01 -1.24602893e-01  3.64852106e-02]
 [ 1.62673498e-01  1.39954211e+00  1.06235030e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 3.26254497e-02 -8.33235220e-02  4.46746673e-02]
 [-5.18382704e-02 -1.39316400e-03 -6.98057949e-02]
 [ 8.50603846e-02  6.02368032e-03 -5.12322695e-02]
 [-1.51963663e-02  9.69781783e-02 -5.14280246e-02]
 [-2.50527924e-01 -1.42973335e-01 -1.19541072e-01]
 [ 6.99800177e-01  1.33660107e+00 -2.46888160e-01]
 [-9.57602756e-05  3.37707529e-02 -5.87024510e-02]
 [-3.55033771e-01 -1.32917802e-02 -7.39098358e-01]
 [ 1.87927672e+00 -3.64171145e+00  3.07883248e+00]
 [ 2.59014961e-02 -9.01291427e-02  3.29821477e-02]
 [ 1.10764003e-01 -2.57004430e-02 -1.42291411e-02]
 [-7.36201995e-02 -3.14382056e-02 -5.46662942e-02]
 [-2.65307885e-01 -1.72272415e+00 -1.97074376e-01]
 [-3.94153431e-02  1.80194144e-01  4.27163432e-01]
 [ 3.33617435e-01  1.04086702e-01  6.99193927e-01]
 [ 9.71734811e-02 -4.81971064e-01 -1.18957147e-01]
 [ 1.40615377e-01 -5.35804852e-02 -1.40687708e-02]
 [ 2.82067088e-02  1.52878510e-01  8.59593849e-02]
 [ 2.36251716e-01 -2.98697141e-01 -1.99057150e-01]
 [-4.86520204e-03 -6.86954386e-02  2.71334320e-02]
 [-8.04463988e-03 -3.60225368e-02  8.50051339e-02]
 [ 6.77966778e-01 -1.04807325e-01  3.45159354e-01]
 [ 2.24157686e-01 -4.45173540e-01 -3.29862341e-01]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 1.86291554e-01 -8.08580670e-02  5.17327844e-02]
 [-1.66419052e-02 -2.60729032e-02 -5.98187105e-02]
 [-5.82972887e-02  2.53669529e-02 -4.46228383e-02]
 [-4.81217754e-02 -5.47193202e-02  2.04166712e-02]
 [ 2.35309470e-01  1.50372696e-02  4.50594152e-02]
 [-6.55700176e-02 -2.23153804e-02  4.40517220e-02]
 [-1.15516864e-01 -6.38639651e-02 -8.25468203e-02]
 [ 2.17040760e+00  1.40362947e+00  1.64409893e-01]
 [-1.74870998e-02 -1.03198465e-01 -4.32183190e-02]
 [ 3.41985103e-02 -1.36114275e-02 -8.96967318e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.17481937]
curr_Stock_Price:  100.92344218279297
curr_Factors:  [100.92344218  -1.24055938  -1.00979242]
mat_Sqrt:  [[10.63351107  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01070362 -0.00716908 -0.70395331]
Stock Position:  0.010703617652904016
Bond Position:  [8.09457343]


portfolio before change:  [9.1706032]
curr_Stock_Price:  100.43500393974486
curr_Factors:  [100.43500394  -1.57320814  -1.01767676]
mat_Sqrt:  [[ 7.5279736   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.20978828 0.08614362 1.26200454]
Stock Position:  0.2097882801771697
Bond Position:  [-11.89948355]


portfolio before change:  [9.07806878]
curr_Stock_Price:  100.00100976758944
curr_Factors:  [100.00100977  -1.43199402  -0.99630641]
mat_Sqrt:  [[ 8.81874749  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02804196 -0.04021541  0.10408215]
Stock Position:  -0.02804195912037485
Bond Position:  [11.88229301]


portfolio before change:  [9.07360737]
curr_Stock_Price:  100.21307711657411
curr_Factors:  [100.21307712  -1.69632671  -0.98984127]
mat_Sqrt:  [[ 6.82867534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0974135  0.45170027 3.03058972]
Stock Position:  0.09741350241359392
Bond Position:  [-0.68849946]


portfolio before change:  [9.06972935]
curr_Stock_Price:  100.17415075706054
curr_Factors:  [100.17415076  -1.60694399  -0.98713839]
mat_Sqrt:  [[ 7.48445195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00783571 -0.01106097 -0.05874131]
Stock Position:  -0.007835710799237268
Bond Position:  [9.85466503]


portfolio before change:  [9.07090634]
curr_Stock_Price:  100.18116073550192
curr_Factors:  [100.18116074  -1.59101888  -0.98002049]
mat_Sqrt:  [[ 7.65945459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00322951 -0.02689255  0.12744439]
Stock Position:  0.003229510007414794
Bond Position:  [8.74737027]


portfolio before change:  [9.07417914]
curr_Stock_Price:  100.85597475021915
curr_Factors:  [100.85597475  -1.58763704  -0.99546433]
mat_Sqrt:  [[ 7.61859632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0087118  -0.00044964 -0.1991365 ]
Stock Position:  -0.008711801263186436
Bond Position:  [9.95281635]


portfolio before change:  [9.07508677]
curr_Stock_Price:  100.89460697647696
curr_Factors:  [100.89460698  -1.75341365  -0.96357541]
mat_Sqrt:  [[ 6.66644953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0113752   0.00194413 -0.1461514 ]
Stock Position:  0.011375203492818339
Bond Position:  [7.92739008]


portfolio before change:  [9.07229503]
curr_Stock_Price:  100.56206579606983
curr_Factors:  [100.5620658   -1.6674111   -0.96786824]
mat_Sqrt:  [[ 7.21019332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00081808  0.03129957 -0.14670984]
Stock Position:  -0.0008180751707376244
Bond Position:  [9.15456236]


portfolio before change:  [9.07350756]
curr_Stock_Price:  100.47877283885093
curr_Factors:  [100.47877284  -1.85620993  -0.96691324]
mat_Sqrt:  [[ 5.9704561   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05093639 -0.04614445 -0.34101741]
Stock Position:  -0.050936385368849195
Bond Position:  [14.19153306]


portfolio before change:  [9.06465605]
curr_Stock_Price:  100.68737751719618
curr_Factors:  [100.68737752  -1.87349     -0.97663231]
mat_Sqrt:  [[ 5.82348066  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.15836524  0.43138614 -0.7043032 ]
Stock Position:  0.15836523661632243
Bond Position:  [-6.88072432]


portfolio before change:  [9.02978773]
curr_Stock_Price:  100.47263232108314
curr_Factors:  [100.47263232  -1.84202577  -0.97669102]
mat_Sqrt:  [[ 5.99645574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086466  0.01089946 -0.16746175]
Stock Position:  -0.0008646644060570021
Bond Position:  [9.11666284]


portfolio before change:  [9.03077833]
curr_Stock_Price:  100.64501331194167
curr_Factors:  [100.64501331  -1.88116134  -0.98585352]
mat_Sqrt:  [[ 5.72352426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08886391 -0.0042899  -2.10844189]
Stock Position:  -0.08886391350267538
Bond Position:  [17.97448809]


portfolio before change:  [8.9933439]
curr_Stock_Price:  101.09155432151609
curr_Factors:  [101.09155432  -1.91077897  -0.99534748]
mat_Sqrt:  [[ 5.52840931  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.31914778 -1.17535732  8.78305209]
Stock Position:  0.319147775589752
Bond Position:  [-23.26980079]


portfolio before change:  [9.07449923]
curr_Stock_Price:  101.35495656670881
curr_Factors:  [101.35495657  -1.82314665  -1.00491492]
mat_Sqrt:  [[ 5.99285067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00237557 -0.02908906  0.09408889]
Stock Position:  0.0023755663897635877
Bond Position:  [8.8337238]


portfolio before change:  [9.07487842]
curr_Stock_Price:  101.0497257506198
curr_Factors:  [101.04972575  -1.84431908  -1.02724288]
mat_Sqrt:  [[ 5.72046887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01793794 -0.00829478 -0.04059178]
Stock Position:  0.017937937149304025
Bond Position:  [7.26225479]


portfolio before change:  [9.070603]
curr_Stock_Price:  100.76077053352559
curr_Factors:  [100.76077053  -1.63934266  -1.01877374]
mat_Sqrt:  [[ 7.0613249   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01291489 -0.01014664 -0.15594772]
Stock Position:  -0.012914886112739738
Bond Position:  [10.37191688]


portfolio before change:  [9.06252173]
curr_Stock_Price:  101.48689721209651
curr_Factors:  [101.48689721  -1.80308927  -1.0402629 ]
mat_Sqrt:  [[ 5.90959635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11120643 -0.55600683 -0.56219834]
Stock Position:  -0.11120643077962225
Bond Position:  [20.34851734]


portfolio before change:  [9.04991377]
curr_Stock_Price:  101.62314549286737
curr_Factors:  [101.62314549  -1.83854632  -1.03153636]
mat_Sqrt:  [[ 5.76144693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01467704 0.05815741 1.21857837]
Stock Position:  0.014677042754562839
Bond Position:  [7.55838651]


portfolio before change:  [9.05505008]
curr_Stock_Price:  101.90872477824301
curr_Factors:  [101.90872478  -2.22652406  -0.99902013]
mat_Sqrt:  [[ 4.04925687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.12288339 0.03359384 1.99460566]
Stock Position:  0.12288338903264928
Bond Position:  [-3.46783939]


portfolio before change:  [9.05575265]
curr_Stock_Price:  101.9179699194941
curr_Factors:  [101.91796992  -2.18806731  -0.98479667]
mat_Sqrt:  [[ 4.26867849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00597151 -0.15555549 -0.33935163]
Stock Position:  -0.005971514683552588
Bond Position:  [9.6643573]


portfolio before change:  [9.05706435]
curr_Stock_Price:  101.90062456620578
curr_Factors:  [101.90062457  -1.81971713  -0.98904478]
mat_Sqrt:  [[ 6.14252663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02064403 -0.01729303 -0.04013429]
Stock Position:  0.02064403434667462
Bond Position:  [6.95342435]


portfolio before change:  [9.05323537]
curr_Stock_Price:  101.6730424971496
curr_Factors:  [101.6730425   -1.80092636  -0.99395342]
mat_Sqrt:  [[ 6.21448225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01238386 0.04934133 0.2452182 ]
Stock Position:  0.012383861880010014
Bond Position:  [7.79413045]


portfolio before change:  [9.05208501]
curr_Stock_Price:  101.50147380267205
curr_Factors:  [101.5014738   -1.89307621  -0.98976177]
mat_Sqrt:  [[ 5.6816139   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02369891 -0.09640409 -0.56785464]
Stock Position:  0.023698908228050666
Bond Position:  [6.6466109]


portfolio before change:  [9.0618768]
curr_Stock_Price:  101.87958876789239
curr_Factors:  [101.87958877  -1.84766044  -1.00561414]
mat_Sqrt:  [[ 5.8738896   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0022726  -0.02217136  0.07740413]
Stock Position:  -0.0022726016363907747
Bond Position:  [9.29340852]


portfolio before change:  [9.0625428]
curr_Stock_Price:  102.09773092091217
curr_Factors:  [102.09773092  -2.06018537  -1.00431584]
mat_Sqrt:  [[ 4.76562787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00041    -0.01162622  0.24249599]
Stock Position:  0.0004099965260238977
Bond Position:  [9.02068309]


portfolio before change:  [9.06346079]
curr_Stock_Price:  101.58635227260133
curr_Factors:  [101.58635227  -2.00111796  -1.01020734]
mat_Sqrt:  [[ 5.00072998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.14538446 -0.03382642  0.98464356]
Stock Position:  0.14538446055969642
Bond Position:  [-5.70561623]


portfolio before change:  [9.01762143]
curr_Stock_Price:  101.27596067216227
curr_Factors:  [101.27596067  -1.92425826  -0.98609093]
mat_Sqrt:  [[ 5.51515566  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01195871 -0.14367914 -0.94100544]
Stock Position:  0.011958710314123072
Bond Position:  [7.80649156]


portfolio before change:  [9.02297697]
curr_Stock_Price:  101.64219309613733
curr_Factors:  [101.6421931   -1.83962658  -1.02169714]
mat_Sqrt:  [[ 5.81322224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380151 -0.02321455 -0.0028026 ]
Stock Position:  -0.003801511710137443
Bond Position:  [9.40937096]


portfolio before change:  [9.02389288]
curr_Stock_Price:  101.71067417167518
curr_Factors:  [101.71067417  -1.75107337  -1.04205498]
mat_Sqrt:  [[ 6.22768016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02895884 -0.02609683  0.14757923]
Stock Position:  0.028958837887009634
Bond Position:  [6.07846996]


portfolio before change:  [9.0197379]
curr_Stock_Price:  101.54095598536668
curr_Factors:  [101.54095599  -1.5183374   -1.01236344]
mat_Sqrt:  [[ 8.08298619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00422795 -0.00841499 -0.17064613]
Stock Position:  -0.004227949504487733
Bond Position:  [9.44904793]


portfolio before change:  [9.02232384]
curr_Stock_Price:  101.20870580573214
curr_Factors:  [101.20870581  -1.52206591  -0.99347721]
mat_Sqrt:  [[ 8.17958694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0076077   0.00818715 -0.12729654]
Stock Position:  -0.00760770443660037
Bond Position:  [9.79228976]


portfolio before change:  [9.02395483]
curr_Stock_Price:  101.1552231296
curr_Factors:  [101.15522313  -1.46498117  -0.97919137]
mat_Sqrt:  [[ 8.78006374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00627829 -0.01766058  0.05824308]
Stock Position:  -0.006278288633403104
Bond Position:  [9.65903652]


portfolio before change:  [9.02853773]
curr_Stock_Price:  100.61758627574612
curr_Factors:  [100.61758628  -1.21055897  -0.97976541]
mat_Sqrt:  [[11.25714093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02199285 0.00485326 0.12854197]
Stock Position:  0.021992853788357164
Bond Position:  [6.81566987]


portfolio before change:  [9.0285035]
curr_Stock_Price:  100.57728938550714
curr_Factors:  [100.57728939  -1.07935751  -0.96163991]
mat_Sqrt:  [[13.0648975   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00467919 -0.00720226  0.1256673 ]
Stock Position:  -0.004679187527453595
Bond Position:  [9.49912349]


portfolio before change:  [9.03065062]
curr_Stock_Price:  100.3721980815448
curr_Factors:  [100.37219808  -0.90997531  -0.97572677]
mat_Sqrt:  [[15.22872089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00954794 -0.02061201 -0.2354831 ]
Stock Position:  -0.009547935232009086
Bond Position:  [9.98899787]


portfolio before change:  [9.02728126]
curr_Stock_Price:  100.85587012230152
curr_Factors:  [100.85587012  -0.83205521  -0.97407333]
mat_Sqrt:  [[16.56950452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.15030518 0.45301946 0.46901566]
Stock Position:  0.15030517596790943
Bond Position:  [-6.13187805]


portfolio before change:  [8.94358242]
curr_Stock_Price:  100.3041106822243
curr_Factors:  [100.30411068  -0.66447307  -0.98226861]
mat_Sqrt:  [[19.32626404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245129 -0.03330716 -0.12328983]
Stock Position:  -0.0024512911856101986
Bond Position:  [9.18945701]


portfolio before change:  [8.94385778]
curr_Stock_Price:  100.66041181078677
curr_Factors:  [100.66041181  -0.77802802  -0.96962795]
mat_Sqrt:  [[17.53320683  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074777 -0.00439307 -0.25587981]
Stock Position:  0.0007477708293409258
Bond Position:  [8.86858686]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.94657683]
Stock Price:  102.81401926631015
PL:  [6.13255756]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.55804280e-01 -2.07048907e-02 -1.90264918e-01]
 [ 1.21115893e+00  2.39795605e-01  3.49024481e-01]
 [-4.37427396e-02  5.26652790e-02  3.43060509e-02]
 [ 2.06028537e-01  1.31084464e+00  1.27392237e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 4.76064506e-02 -5.88155448e-02  4.49392781e-02]
 [-5.84481810e-02  1.71023342e-02 -5.70743722e-02]
 [-9.83986488e-03  2.32791573e-01 -3.39555454e-02]
 [ 2.54379237e-02  5.30053095e-02 -4.47474215e-02]
 [-9.65776051e-02 -4.73768693e-02 -1.31300430e-02]
 [ 7.44720818e-01  1.47701639e+00 -2.48619643e-01]
 [-6.53098204e-05  3.40995109e-02 -5.88010570e-02]
 [-3.49943288e-01 -8.59737288e-03 -7.19348201e-01]
 [ 1.91202139e+00 -3.63298682e+00  3.05769233e+00]
 [ 3.50282726e-02 -8.74214298e-02  1.44698014e-02]
 [ 9.50090059e-02  2.22228768e-03 -1.64825506e-02]
 [-8.56215487e-02 -5.60417264e-02 -4.85666172e-02]
 [-2.67650937e-01 -1.73012901e+00 -1.94929278e-01]
 [-4.87104969e-02  2.23395325e-01  5.51513478e-01]
 [ 2.67672104e-01  2.21249453e-01  6.32382537e-01]
 [ 6.60592998e-02 -3.40673169e-01 -6.11375022e-02]
 [ 1.26276399e-01 -5.19883056e-02 -8.90237444e-03]
 [-3.90876384e-03  1.47261531e-01  6.36498822e-02]
 [ 3.27943374e-01 -3.54324958e-01 -2.48530922e-01]
 [-2.49872630e-03 -5.05014198e-02  2.16489480e-02]
 [-1.80061090e-02 -3.93463168e-02  9.70110332e-02]
 [ 6.32667586e-01 -1.08843691e-01  3.14516295e-01]
 [ 1.18460792e-01 -2.66097290e-01 -1.48895482e-01]
 [-9.90333074e-03 -7.53250304e-02 -3.80856431e-03]
 [ 1.88672636e-01 -8.89317736e-02  7.16774677e-02]
 [-1.94808511e-02 -3.35913534e-02 -5.35988285e-02]
 [-5.98667063e-02  2.55400798e-02 -4.42485824e-02]
 [-3.53805519e-02 -3.57385338e-02 -1.74311038e-02]
 [ 2.85271730e-01  4.81437262e-02  7.31056888e-02]
 [-7.86552208e-02 -2.21084772e-02  4.88561678e-02]
 [-1.08045147e-01 -5.66909915e-02 -8.11673103e-02]
 [ 1.62328387e+00  1.06839030e+00  1.44494134e-01]
 [-7.11124860e-03 -1.57003541e-01 -6.06477742e-02]
 [ 3.49160598e-02 -1.35610894e-02 -1.04357908e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.16033646]
curr_Stock_Price:  100.9214658213688
curr_Factors:  [100.92146582  -1.19472831  -0.99449508]
mat_Sqrt:  [[11.30357736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00997386 -0.00668247 -0.54277285]
Stock Position:  0.0099738555516805
Bond Position:  [8.15376033]


portfolio before change:  [9.1572201]
curr_Stock_Price:  100.50681753862436
curr_Factors:  [100.50681754  -1.03673238  -1.00539065]
mat_Sqrt:  [[13.04105605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10208923 0.0773937  0.99566969]
Stock Position:  0.1020892264313759
Bond Position:  [-1.10344316]


portfolio before change:  [9.22439443]
curr_Stock_Price:  101.1661649839895
curr_Factors:  [101.16616498  -1.03766698  -0.99934291]
mat_Sqrt:  [[13.1938984   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196983  0.01699765  0.09786561]
Stock Position:  -0.00196983412099628
Bond Position:  [9.42367499]


portfolio before change:  [9.22923839]
curr_Stock_Price:  99.30513262350168
curr_Factors:  [99.30513262 -0.75013053 -0.97745901]
mat_Sqrt:  [[17.64773982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04157144 0.42307329 3.63414592]
Stock Position:  0.04157143642257862
Bond Position:  [5.10098138]


portfolio before change:  [9.28293757]
curr_Stock_Price:  100.58152623023028
curr_Factors:  [100.58152623  -0.94084923  -1.00245067]
mat_Sqrt:  [[14.40634456  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00407085 -0.01106097 -0.05874131]
Stock Position:  -0.004070845362634706
Bond Position:  [9.69238941]


portfolio before change:  [9.28391162]
curr_Stock_Price:  100.63988500247704
curr_Factors:  [100.639885    -1.25262669  -0.99507577]
mat_Sqrt:  [[10.63176474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00421134 -0.01898264  0.12819925]
Stock Position:  0.004211339383641893
Bond Position:  [8.86008291]


portfolio before change:  [9.28115433]
curr_Stock_Price:  99.72215563083734
curr_Factors:  [99.72215563 -0.79139171 -1.01092331]
mat_Sqrt:  [[16.44584488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00405011  0.00551975 -0.1628173 ]
Stock Position:  -0.004050107463553032
Bond Position:  [9.68503978]


portfolio before change:  [9.27951551]
curr_Stock_Price:  100.42572418435442
curr_Factors:  [100.42572418  -0.8841698   -1.02364717]
mat_Sqrt:  [[14.90357949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00206309  0.07513316 -0.09686572]
Stock Position:  0.002063086213503115
Bond Position:  [9.07232858]


portfolio before change:  [9.27873234]
curr_Stock_Price:  99.49639739969824
curr_Factors:  [99.4963974  -1.03933998 -1.01096496]
mat_Sqrt:  [[12.80475386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00211824  0.01710739 -0.12765194]
Stock Position:  0.002118241262819514
Bond Position:  [9.06797496]


portfolio before change:  [9.27805649]
curr_Stock_Price:  98.6421880985712
curr_Factors:  [98.6421881  -1.26350284 -0.99411977]
mat_Sqrt:  [[10.31786063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01055728 -0.01529082 -0.03745636]
Stock Position:  -0.010557278372273937
Bond Position:  [10.31944952]


portfolio before change:  [9.27705077]
curr_Stock_Price:  98.85964218666213
curr_Factors:  [98.85964219 -1.30197743 -0.96685559]
mat_Sqrt:  [[10.22533097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09735296  0.47670499 -0.70924264]
Stock Position:  0.09735296159658667
Bond Position:  [-0.34722818]


portfolio before change:  [9.38657126]
curr_Stock_Price:  99.98507169699361
curr_Factors:  [99.9850717  -1.59176525 -0.97296773]
mat_Sqrt:  [[ 7.69282375  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066393  0.01100557 -0.16774305]
Stock Position:  -0.0006639293921790767
Bond Position:  [9.45295429]


portfolio before change:  [9.38743943]
curr_Stock_Price:  100.4572987926566
curr_Factors:  [100.45729879  -1.62488569  -0.98036528]
mat_Sqrt:  [[ 7.4222466   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06716761 -0.00277479 -2.05210019]
Stock Position:  -0.06716760886609774
Bond Position:  [16.13491598]


portfolio before change:  [9.39798297]
curr_Stock_Price:  100.3303544563315
curr_Factors:  [100.33035446  -1.80623869  -0.97365632]
mat_Sqrt:  [[ 6.22499896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.28828758 -1.17254145  8.72274512]
Stock Position:  0.2882875806615689
Bond Position:  [-19.52601218]


portfolio before change:  [9.40923853]
curr_Stock_Price:  100.37786419066236
curr_Factors:  [100.37786419  -1.9629096   -0.97338601]
mat_Sqrt:  [[ 5.32624293  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00378073 -0.02821515  0.04127832]
Stock Position:  0.0037807295102355604
Bond Position:  [9.02973698]


portfolio before change:  [9.4105093]
curr_Stock_Price:  100.4154177293918
curr_Factors:  [100.41541773  -1.99494892  -0.96512913]
mat_Sqrt:  [[ 5.20301212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01770093  0.00071724 -0.04702013]
Stock Position:  0.017700927820511216
Bond Position:  [7.63306324]


portfolio before change:  [9.4220543]
curr_Stock_Price:  101.01373724111379
curr_Factors:  [101.01373724  -2.18735188  -1.00003316]
mat_Sqrt:  [[ 4.16981422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02565453 -0.01808739 -0.13854704]
Stock Position:  -0.025654533182956473
Bond Position:  [12.01351458]


portfolio before change:  [9.43336106]
curr_Stock_Price:  100.63154466151967
curr_Factors:  [100.63154466  -2.09625165  -1.03521059]
mat_Sqrt:  [[ 4.3929612   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.15037734 -0.55839674 -0.55607897]
Stock Position:  -0.15037733881392915
Bond Position:  [24.56606494]


portfolio before change:  [9.45546839]
curr_Stock_Price:  100.50495390715004
curr_Factors:  [100.50495391  -2.08259501  -1.03576983]
mat_Sqrt:  [[ 4.44527701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02462548 0.07210053 1.57331444]
Stock Position:  0.024625484497731942
Bond Position:  [6.9804852]


portfolio before change:  [9.45377745]
curr_Stock_Price:  100.4008523229163
curr_Factors:  [100.40085232  -1.94737242  -1.05652003]
mat_Sqrt:  [[ 4.9792449   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08875221 0.07140795 1.80401136]
Stock Position:  0.08875221310061797
Bond Position:  [0.54297961]


portfolio before change:  [9.49927726]
curr_Stock_Price:  100.91274866100504
curr_Factors:  [100.91274866  -1.86690741  -1.08695512]
mat_Sqrt:  [[ 5.26138207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303342 -0.10995179 -0.17440828]
Stock Position:  -0.003033415894239389
Bond Position:  [9.8053876]


portfolio before change:  [9.49939619]
curr_Stock_Price:  101.27762352673409
curr_Factors:  [101.27762353  -2.10718085  -1.09841269]
mat_Sqrt:  [[ 4.1052718   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02773194 -0.01677915 -0.025396  ]
Stock Position:  0.027731937428131237
Bond Position:  [6.69077148]


portfolio before change:  [9.50228249]
curr_Stock_Price:  101.35154166170501
curr_Factors:  [101.35154166  -2.2081624   -1.11069719]
mat_Sqrt:  [[ 3.66832624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01067063 0.04752845 0.1815754 ]
Stock Position:  0.010670628920112881
Bond Position:  [8.42079779]


portfolio before change:  [9.50390304]
curr_Stock_Price:  101.40476100833402
curr_Factors:  [101.40476101  -1.9954711   -1.09018539]
mat_Sqrt:  [[ 4.63419983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04421172 -0.11435789 -0.70898954]
Stock Position:  0.044211717311746127
Bond Position:  [5.02062441]


portfolio before change:  [9.52028146]
curr_Stock_Price:  101.76101967815048
curr_Factors:  [101.76101968  -1.9433934   -1.10520517]
mat_Sqrt:  [[ 4.82605106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173811 -0.01629926  0.06175842]
Stock Position:  -0.0017381110006642172
Bond Position:  [9.69715341]


portfolio before change:  [9.52111784]
curr_Stock_Price:  101.97725533779214
curr_Factors:  [101.97725534  -2.1377195   -1.09876567]
mat_Sqrt:  [[ 4.00788884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155577 -0.01269897  0.27674548]
Stock Position:  -0.0015557687044312986
Bond Position:  [9.67977086]


portfolio before change:  [9.52175615]
curr_Stock_Price:  102.34474720536448
curr_Factors:  [102.34474721  -1.79743821  -1.11910061]
mat_Sqrt:  [[ 5.53896781  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12180073 -0.03512915  0.89722745]
Stock Position:  0.12180073147124175
Bond Position:  [-2.94390892]


portfolio before change:  [9.55381197]
curr_Stock_Price:  102.61095106221198
curr_Factors:  [102.61095106  -1.68089124  -1.10508678]
mat_Sqrt:  [[ 6.32788869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00533365 -0.08588253 -0.42475736]
Stock Position:  0.005333650599235805
Bond Position:  [9.00652101]


portfolio before change:  [9.55377397]
curr_Stock_Price:  102.39273566634554
curr_Factors:  [102.39273567  -1.73810887  -1.12091068]
mat_Sqrt:  [[ 5.8696571   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00443917 -0.02431105 -0.01086477]
Stock Position:  -0.004439170409081901
Bond Position:  [10.00831277]


portfolio before change:  [9.55514871]
curr_Stock_Price:  102.36488671143745
curr_Factors:  [102.36488671  -1.57361383  -1.11940347]
mat_Sqrt:  [[ 6.92769015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02672617 -0.02870261  0.20447586]
Stock Position:  0.02672616860288088
Bond Position:  [6.81932749]


portfolio before change:  [9.54206288]
curr_Stock_Price:  101.84336416742605
curr_Factors:  [101.84336417  -1.5301963   -1.13350213]
mat_Sqrt:  [[ 7.09746415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00525237 -0.01084156 -0.15290254]
Stock Position:  -0.005252365022456785
Bond Position:  [10.0769814]


portfolio before change:  [9.54478169]
curr_Stock_Price:  101.56556316387163
curr_Factors:  [101.56556316  -1.58414384  -1.15197282]
mat_Sqrt:  [[ 6.58364059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0096733   0.00824303 -0.12622889]
Stock Position:  -0.009673304998311098
Bond Position:  [10.52725636]


portfolio before change:  [9.54501064]
curr_Stock_Price:  101.67793911344222
curr_Factors:  [101.67793911  -1.55510636  -1.1175901 ]
mat_Sqrt:  [[ 7.02246225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0065837  -0.01153456 -0.04972609]
Stock Position:  -0.006583696303910515
Bond Position:  [10.21442731]


portfolio before change:  [9.54574551]
curr_Stock_Price:  101.76026480312478
curr_Factors:  [101.7602648   -1.31586525  -1.12623783]
mat_Sqrt:  [[ 8.8508776   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03502722 0.01553832 0.20855018]
Stock Position:  0.035027222953518386
Bond Position:  [5.98136603]


portfolio before change:  [9.51460251]
curr_Stock_Price:  100.84980943027196
curr_Factors:  [100.84980943  -1.30903053  -1.12528394]
mat_Sqrt:  [[ 8.84027433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00827976 -0.00713548  0.13937305]
Stock Position:  -0.008279762442430304
Bond Position:  [10.34961497]


portfolio before change:  [9.51614527]
curr_Stock_Price:  100.81973867833061
curr_Factors:  [100.81973868  -1.08427297  -1.11718482]
mat_Sqrt:  [[11.15487214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0122086  -0.01829694 -0.23154774]
Stock Position:  -0.012208598448135618
Bond Position:  [10.74701297]


portfolio before change:  [9.52078472]
curr_Stock_Price:  100.54976609408614
curr_Factors:  [100.54976609  -1.11937725  -1.12776408]
mat_Sqrt:  [[10.62820651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.17602809 0.34482149 0.41220154]
Stock Position:  0.17602808735739078
Bond Position:  [-8.17879829]


portfolio before change:  [9.58427066]
curr_Stock_Price:  100.91623236320241
curr_Factors:  [100.91623236  -1.12965931  -1.12623223]
mat_Sqrt:  [[10.57401162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00487413 -0.05067267 -0.17301122]
Stock Position:  -0.004874132836952696
Bond Position:  [10.07614978]


portfolio before change:  [9.58428729]
curr_Stock_Price:  101.17124524387316
curr_Factors:  [101.17124524  -1.20412117  -1.14931576]
mat_Sqrt:  [[ 9.61551227  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112796 -0.00437682 -0.29770406]
Stock Position:  0.0011279633367000334
Bond Position:  [9.47016983]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.58550572]
Stock Price:  101.20190540640318
PL:  [8.38360031]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 5.95904891e-03 -9.43821010e-02  4.43973653e-02]
 [ 3.02218808e-01  1.95743396e-01  6.88044859e-02]
 [-5.17298064e-01 -3.94627848e-01  4.43683810e-02]
 [ 3.24012397e-01  2.11465619e+00  2.01881292e+00]
 [-4.99178182e-02 -2.11568295e-02 -4.98134179e-04]
 [-2.66168988e-02  2.79031518e-01 -1.22346714e-01]
 [-1.30431212e-01  2.18521402e-01  8.15729500e-02]
 [-6.29234057e-02  1.23584775e-01  1.25936098e-03]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-2.31119409e-02 -1.75788070e-03  3.76496957e-02]
 [ 9.11924526e-01  1.75735666e+00 -3.16113616e-01]
 [ 2.47199242e-05  2.03189879e-02 -5.84555550e-02]
 [-2.88714162e-01 -3.36111370e-03 -5.87501018e-01]
 [ 1.73910373e+00 -3.29268664e+00  2.76531622e+00]
 [-4.38771748e-03 -9.36791997e-02  3.66682199e-02]
 [ 1.41716611e-01 -4.79262326e-02 -3.91526667e-03]
 [-1.26501160e-01 -1.50535245e-01 -4.11524363e-02]
 [-2.65727459e-01 -1.73728765e+00 -2.01472033e-01]
 [-3.61403599e-02  1.70606859e-01  3.67258662e-01]
 [ 3.56093032e-01 -2.37461025e-01  5.22345978e-01]
 [ 1.00541700e-01 -3.22982840e-01 -7.85169120e-02]
 [ 1.19729177e-01 -5.59214197e-02 -4.69610622e-02]
 [ 1.42884748e-01  2.34391837e-01  1.73090394e-01]
 [ 3.15883894e-01 -2.89840581e-01 -1.08198995e-01]
 [-5.49472218e-02 -1.27169748e-01  6.04959016e-02]
 [ 5.95371524e-02 -1.56696744e-02 -1.74258674e-02]
 [ 7.18893795e-01 -9.70573889e-02  3.76407197e-01]
 [ 5.61831459e-02 -1.62865160e-01 -4.05905174e-02]
 [-1.30373246e-02 -7.83631205e-02 -9.06946892e-03]
 [ 2.78263934e-01 -1.40653694e-01  3.87467316e-02]
 [-2.64486018e-02 -5.40957824e-02 -3.83931966e-02]
 [-2.40949195e-02  2.34611006e-02 -5.33552107e-02]
 [-3.59049626e-02 -2.06819222e-02 -3.64680954e-02]
 [ 3.89277764e-01  7.57107436e-02  9.87544758e-02]
 [ 6.89126936e-02 -7.43080884e-02  1.92694002e-02]
 [-9.05013977e-02 -2.84949813e-02 -9.91564653e-02]
 [ 1.28708721e+00  9.06942877e-01  1.40942561e-01]
 [-3.22787398e-02 -1.01338564e-01 -4.84531322e-02]
 [ 3.67818192e-02 -1.33448754e-02 -1.41642506e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.76200496]
curr_Stock_Price:  100.04833927191115
curr_Factors:  [100.04833927  -0.98049496  -1.00078008]
mat_Sqrt:  [[13.79599622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030763 -0.03046169  0.12665333]
Stock Position:  -0.0003076285666743845
Bond Position:  [2.79278269]


portfolio before change:  [2.76276733]
curr_Stock_Price:  98.70502525024601
curr_Factors:  [98.70502525 -0.70689142 -1.01494313]
mat_Sqrt:  [[17.6423331   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02019117 0.06317591 0.19628005]
Stock Position:  0.020191174064039277
Bond Position:  [0.76979698]


portfolio before change:  [2.74283449]
curr_Stock_Price:  97.71305389200029
curr_Factors:  [97.71305389 -0.86265323 -1.05486872]
mat_Sqrt:  [[14.36095711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04099967 -0.12736559  0.12657064]
Stock Position:  -0.04099966832444978
Bond Position:  [6.74903729]


portfolio before change:  [2.78872926]
curr_Stock_Price:  96.61423806316505
curr_Factors:  [96.61423806 -1.01713654 -1.0715295 ]
mat_Sqrt:  [[11.96588981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09759017 0.68250235 5.75911134]
Stock Position:  0.09759017215038426
Bond Position:  [-6.63987087]


portfolio before change:  [2.88013221]
curr_Stock_Price:  97.55934335164005
curr_Factors:  [97.55934335 -1.01655531 -1.09515434]
mat_Sqrt:  [[11.80769212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460193 -0.00682834 -0.00142104]
Stock Position:  -0.004601925472873176
Bond Position:  [3.32909304]


portfolio before change:  [2.87852315]
curr_Stock_Price:  97.99942455169129
curr_Factors:  [97.99942455 -1.11102346 -1.10586822]
mat_Sqrt:  [[10.67676541  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050261  0.09005704 -0.34902112]
Stock Position:  0.0005026103590990176
Bond Position:  [2.82926763]


portfolio before change:  [2.8790165]
curr_Stock_Price:  98.27731326487672
curr_Factors:  [98.27731326 -1.07231311 -1.10846813]
mat_Sqrt:  [[11.10074219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00623154  0.07052748  0.23270492]
Stock Position:  -0.006231539095199828
Bond Position:  [3.49143542]


portfolio before change:  [2.87849323]
curr_Stock_Price:  98.43132482972061
curr_Factors:  [98.43132483 -1.12661097 -1.12102118]
mat_Sqrt:  [[10.39917983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360026  0.03988681  0.00359261]
Stock Position:  -0.003600255373877843
Bond Position:  [3.23287114]


portfolio before change:  [2.87860129]
curr_Stock_Price:  98.51356179958027
curr_Factors:  [98.5135618  -1.04085513 -1.1421825 ]
mat_Sqrt:  [[11.10234774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0046829   0.0064198  -0.11330016]
Stock Position:  0.004682901721898295
Bond Position:  [2.41727196]


portfolio before change:  [2.88321381]
curr_Stock_Price:  99.4340036307205
curr_Factors:  [99.43400363 -0.92058601 -1.16192669]
mat_Sqrt:  [[12.39113687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00127394 -0.00056735  0.1074041 ]
Stock Position:  -0.001273939186984614
Bond Position:  [3.00988668]


portfolio before change:  [2.88228513]
curr_Stock_Price:  100.4583314806474
curr_Factors:  [100.45833148  -0.91072587  -1.16050654]
mat_Sqrt:  [[12.6608002   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09526389  0.56718442 -0.90178416]
Stock Position:  0.09526388624020478
Bond Position:  [-6.68776593]


portfolio before change:  [2.89720522]
curr_Stock_Price:  100.62372582637893
curr_Factors:  [100.62372583  -0.89329588  -1.18617116]
mat_Sqrt:  [[12.57764497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061696  0.00655793 -0.16675743]
Stock Position:  -0.000616957647566135
Bond Position:  [2.9592858]


portfolio before change:  [2.89774189]
curr_Stock_Price:  100.35347109623822
curr_Factors:  [100.3534711   -1.08717463  -1.18695017]
mat_Sqrt:  [[10.32505914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.96436848e-02 -1.08479478e-03 -1.67597687e+00]
Stock Position:  -0.03964368475620264
Bond Position:  [6.87612326]


portfolio before change:  [2.87251352]
curr_Stock_Price:  101.01153142911475
curr_Factors:  [101.01153143  -1.05221798  -1.19803091]
mat_Sqrt:  [[10.6438876   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.1532762  -1.06271004  7.88867746]
Stock Position:  0.15327620467318584
Bond Position:  [-12.61015064]


portfolio before change:  [2.8936277]
curr_Stock_Price:  101.15956842994649
curr_Factors:  [101.15956843  -0.96458951  -1.21688706]
mat_Sqrt:  [[11.41835995  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140344 -0.03023483  0.10460422]
Stock Position:  -0.0014034445473858155
Bond Position:  [3.03559955]


portfolio before change:  [2.89265817]
curr_Stock_Price:  102.12078050357684
curr_Factors:  [102.1207805   -1.07320732  -1.23905651]
mat_Sqrt:  [[10.11371477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01296601 -0.01546813 -0.01116917]
Stock Position:  0.012966008239512737
Bond Position:  [1.56855929]


portfolio before change:  [2.89126019]
curr_Stock_Price:  101.99783872283405
curr_Factors:  [101.99783872  -1.12418509  -1.21491079]
mat_Sqrt:  [[ 9.83409816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01684234 -0.04858504 -0.11739645]
Stock Position:  -0.016842341955773207
Bond Position:  [4.60914267]


portfolio before change:  [2.88445881]
curr_Stock_Price:  102.43587477306751
curr_Factors:  [102.43587477  -1.40070355  -1.18567161]
mat_Sqrt:  [[ 7.71264994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08576496 -0.56070718 -0.57474363]
Stock Position:  -0.08576496107669757
Bond Position:  [11.66986763]


portfolio before change:  [2.83277249]
curr_Stock_Price:  103.0555351054942
curr_Factors:  [103.05553511  -1.57479959  -1.16387329]
mat_Sqrt:  [[ 6.66316858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01105345 0.05506313 1.04768674]
Stock Position:  0.0110534468704466
Bond Position:  [1.69365361]


portfolio before change:  [2.83786502]
curr_Stock_Price:  103.49709976403571
curr_Factors:  [103.49709976  -1.88194185  -1.16006737]
mat_Sqrt:  [[ 4.94083516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08384107 -0.07664022  1.49010768]
Stock Position:  0.0838410746185319
Bond Position:  [-5.83944304]


portfolio before change:  [2.82825032]
curr_Stock_Price:  103.39112870618537
curr_Factors:  [103.39112871  -1.94525221  -1.15559795]
mat_Sqrt:  [[ 4.65372981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00399377 -0.10424226 -0.2239869 ]
Stock Position:  0.003993765625572386
Bond Position:  [2.41533039]


portfolio before change:  [2.82908645]
curr_Stock_Price:  103.5248844019217
curr_Factors:  [103.5248844   -1.97297851  -1.17639377]
mat_Sqrt:  [[ 4.43904711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02224089 -0.01804856 -0.13396684]
Stock Position:  0.022240894398065644
Bond Position:  [0.52660042]


portfolio before change:  [2.83287491]
curr_Stock_Price:  103.69226244552814
curr_Factors:  [103.69226245  -1.96170559  -1.20186682]
mat_Sqrt:  [[ 4.38353331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05157066 0.07564964 0.49377872]
Stock Position:  0.05157066109516323
Bond Position:  [-2.51460361]


portfolio before change:  [2.84444741]
curr_Stock_Price:  103.92275868615529
curr_Factors:  [103.92275869  -1.86772213  -1.24249059]
mat_Sqrt:  [[ 4.63406848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05063249 -0.09354565 -0.30866162]
Stock Position:  0.05063248554261393
Bond Position:  [-2.41742017]


portfolio before change:  [2.84944031]
curr_Stock_Price:  104.02733775785215
curr_Factors:  [104.02733776  -2.04046163  -1.25912654]
mat_Sqrt:  [[ 3.83843815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01786064 -0.04104386  0.17257797]
Stock Position:  -0.0178606404720347
Bond Position:  [4.70743519]


portfolio before change:  [2.85593122]
curr_Stock_Price:  103.69686595419282
curr_Factors:  [103.69686595  -2.00709105  -1.25027598]
mat_Sqrt:  [[ 3.99125158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01322431 -0.00505737 -0.04971115]
Stock Position:  0.013224311259307007
Bond Position:  [1.48461158]


portfolio before change:  [2.85512969]
curr_Stock_Price:  103.6222222791704
curr_Factors:  [103.62222228  -1.8064908   -1.23545527]
mat_Sqrt:  [[ 4.94712074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.1568419  -0.03132514  1.07378496]
Stock Position:  0.15684190386349364
Bond Position:  [-13.39717693]


portfolio before change:  [2.86604657]
curr_Stock_Price:  103.70250459882752
curr_Factors:  [103.7025046   -1.84165293  -1.24696351]
mat_Sqrt:  [[ 4.7251997   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00310102 -0.0525645  -0.11579345]
Stock Position:  0.0031010180860353456
Bond Position:  [2.54446323]


portfolio before change:  [2.86502377]
curr_Stock_Price:  103.27010434465232
curr_Factors:  [103.27010434  -1.66061044  -1.24649641]
mat_Sqrt:  [[ 5.6420139   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00547401 -0.02529159 -0.02587267]
Stock Position:  -0.005474007643007312
Bond Position:  [3.43032511]


portfolio before change:  [2.86425607]
curr_Stock_Price:  103.48868643590336
curr_Factors:  [103.48868644  -1.65288128  -1.25734598]
mat_Sqrt:  [[ 5.63634066  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04567897 -0.04539578  0.11053364]
Stock Position:  0.045678974729955794
Bond Position:  [-1.86300102]


portfolio before change:  [2.85707165]
curr_Stock_Price:  103.33650423057911
curr_Factors:  [103.33650423  -1.62124041  -1.29485348]
mat_Sqrt:  [[ 5.59513126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0081013  -0.01745934 -0.1095251 ]
Stock Position:  -0.008101299762931877
Bond Position:  [3.69423165]


portfolio before change:  [2.85884694]
curr_Stock_Price:  103.17437179997009
curr_Factors:  [103.1743718   -1.35282461  -1.29685426]
mat_Sqrt:  [[ 7.29173578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00414127  0.00757204 -0.15220756]
Stock Position:  -0.004141267602751541
Bond Position:  [3.28611963]


portfolio before change:  [2.86033698]
curr_Stock_Price:  102.91376478577091
curr_Factors:  [102.91376479  -1.35403249  -1.27059851]
mat_Sqrt:  [[ 7.45779957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00637865 -0.00667506 -0.10403333]
Stock Position:  -0.006378645685655506
Bond Position:  [3.51678742]


portfolio before change:  [2.86120792]
curr_Stock_Price:  102.84614549612168
curr_Factors:  [102.8461455   -1.31185676  -1.28350988]
mat_Sqrt:  [[ 7.67422642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05536588 0.02443554 0.28171903]
Stock Position:  0.05536588369622127
Bond Position:  [-2.83295981]


portfolio before change:  [2.86454836]
curr_Stock_Price:  102.91287571621402
curr_Factors:  [102.91287572  -1.20277593  -1.27910655]
mat_Sqrt:  [[ 8.60204779  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00670514 -0.02398283  0.05497024]
Stock Position:  0.006705143922930477
Bond Position:  [2.17450271]


portfolio before change:  [2.86406713]
curr_Stock_Price:  102.80056549160085
curr_Factors:  [102.80056549  -1.07823332  -1.25151127]
mat_Sqrt:  [[10.00461282  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01165044 -0.00919672 -0.2828658 ]
Stock Position:  -0.011650439883231205
Bond Position:  [4.06173894]


portfolio before change:  [2.8672316]
curr_Stock_Price:  102.57252905914318
curr_Factors:  [102.57252906  -0.9415885   -1.25337868]
mat_Sqrt:  [[11.4227042   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.13140373 0.29271455 0.4020699 ]
Stock Position:  0.13140372894101585
Bond Position:  [-10.6111812]


portfolio before change:  [2.85183038]
curr_Stock_Price:  102.46541838713631
curr_Factors:  [102.46541839  -0.96825231  -1.26175884]
mat_Sqrt:  [[11.01782278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00570483 -0.03270688 -0.1382233 ]
Stock Position:  -0.005704833262755226
Bond Position:  [3.43637851]


portfolio before change:  [2.84618854]
curr_Stock_Price:  103.52967740884094
curr_Factors:  [103.52967741  -1.0629997   -1.29087894]
mat_Sqrt:  [[ 9.83531687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00052313 -0.00430704 -0.40406664]
Stock Position:  0.0005231303278572108
Bond Position:  [2.79202902]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.84641278]
Stock Price:  103.2911534822089
PL:  [-0.4447407]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 6.64299582e-02 -4.26516712e-02 -8.42042592e-02]
 [ 1.23939507e+00  2.41800606e-01  3.66316248e-01]
 [-1.85554716e-01 -8.43288896e-02  3.52089894e-02]
 [ 1.49268236e-01  1.27268909e+00  9.75094012e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 3.77252123e-02 -7.43686072e-02  4.46442645e-02]
 [-8.76282511e-02  9.87524457e-02 -8.70312307e-04]
 [ 4.43915612e-02  1.72980323e-01 -4.46616746e-02]
 [ 2.43935491e-03  7.78934778e-02 -4.85285706e-02]
 [-2.67853788e-01 -1.53731944e-01 -1.31516774e-01]
 [ 7.57644301e-01  1.45072960e+00 -2.65918204e-01]
 [-2.21320128e-04  3.24151475e-02 -5.82958578e-02]
 [-2.92847741e-01 -2.46303785e-03 -6.03663562e-01]
 [ 1.73548578e+00 -3.33563671e+00  2.80001340e+00]
 [-4.26392265e-03 -9.36583310e-02  3.66553835e-02]
 [ 1.16530481e-01 -4.28300170e-02 -2.93753781e-03]
 [-1.11789403e-01 -1.14274687e-01 -4.10022028e-02]
 [-2.59888865e-01 -1.69018698e+00 -1.96468586e-01]
 [ 5.38299636e-04  3.51010657e-02  7.12457025e-02]
 [ 1.93066088e-01  2.73324956e-02  3.85170655e-01]
 [ 3.89125866e-02 -3.47100844e-02  7.53569187e-02]
 [ 1.23899008e-01 -5.17725467e-02 -6.59382208e-03]
 [ 2.30143895e-01  1.58339103e-01  1.72772450e-01]
 [-1.89003399e-01  3.99151394e-02  4.16555131e-02]
 [ 3.15861115e-02 -1.02693636e-01  2.07069033e-02]
 [ 1.09245501e-02 -4.85023036e-02  2.41161206e-01]
 [-2.56649317e-02 -1.37297406e-01  1.28302080e-02]
 [ 1.48907655e-02 -1.32761782e-01 -4.34520004e-02]
 [ 9.43193368e-02 -2.59522865e-03  4.58936507e-02]
 [ 2.11900234e-03  6.44576961e-02 -1.46949508e-02]
 [ 5.78115941e-02 -1.56198789e-02 -8.14411299e-02]
 [-4.58245001e-02  1.51615572e-02 -4.48723649e-02]
 [-1.07265481e-01 -2.44411212e-02  4.15953824e-02]
 [-6.00297091e-02 -1.84806517e-02 -6.07326634e-03]
 [-8.89570441e-02 -2.61163367e-02  6.36827381e-02]
 [-1.20915327e-01 -7.13400874e-02 -8.31162256e-02]
 [ 3.16962727e+00  2.00818404e+00  1.99281512e-01]
 [-1.55065356e-03 -1.52335130e-01 -5.40934433e-02]
 [ 3.29347594e-02 -1.35091980e-02 -6.55608699e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.26910048]
curr_Stock_Price:  100.11753833725794
curr_Factors:  [100.11753834  -1.17589139  -0.99993617]
mat_Sqrt:  [[11.36475976  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00356678 -0.01376577 -0.24021131]
Stock Position:  0.0035667801778384144
Bond Position:  [2.91200323]


portfolio before change:  [3.26985362]
curr_Stock_Price:  100.22663296176343
curr_Factors:  [100.22663296  -1.3224103   -0.97492225]
mat_Sqrt:  [[10.07544626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.13533161 0.07804081 1.04499829]
Stock Position:  0.13533161400529622
Bond Position:  [-10.29397838]


portfolio before change:  [3.29592321]
curr_Stock_Price:  100.42877655727801
curr_Factors:  [100.42877656  -1.33406955  -0.95203581]
mat_Sqrt:  [[10.20975285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01915632 -0.02721703  0.10044145]
Stock Position:  -0.01915631812568116
Bond Position:  [5.21976881]


portfolio before change:  [3.29421793]
curr_Stock_Price:  100.55185841819336
curr_Factors:  [100.55185842  -1.44211724  -0.94745658]
mat_Sqrt:  [[ 9.21746244  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06597207 0.41075864 2.7816718 ]
Stock Position:  0.06597206590228046
Bond Position:  [-3.3393959]


portfolio before change:  [3.27484607]
curr_Stock_Price:  100.26454887010019
curr_Factors:  [100.26454887  -1.23167041  -0.92502893]
mat_Sqrt:  [[11.60124991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00505515 -0.01106097 -0.05874131]
Stock Position:  -0.005055145040548006
Bond Position:  [3.78169791]


portfolio before change:  [3.27436415]
curr_Stock_Price:  100.4533996114924
curr_Factors:  [100.45339961  -1.33490836  -0.89542355]
mat_Sqrt:  [[10.7980118   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00293181 -0.02400236  0.12735766]
Stock Position:  0.0029318134525907185
Bond Position:  [2.97985352]


portfolio before change:  [3.27387775]
curr_Stock_Price:  100.16044098450782
curr_Factors:  [100.16044098  -1.4620528   -0.88004658]
mat_Sqrt:  [[ 9.62798461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0070262   0.03187221 -0.00248276]
Stock Position:  -0.0070261998780199834
Bond Position:  [3.97762503]


portfolio before change:  [3.27083209]
curr_Stock_Price:  100.66468140061284
curr_Factors:  [100.6646814   -1.45292411  -0.87577031]
mat_Sqrt:  [[ 9.80704094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00719733  0.05582916 -0.12740733]
Stock Position:  0.0071973285404997945
Bond Position:  [2.54631531]


portfolio before change:  [3.27217979]
curr_Stock_Price:  100.80770496881983
curr_Factors:  [100.80770497  -1.41849892  -0.83014975]
mat_Sqrt:  [[10.63942155  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079266  0.02514001 -0.1384385 ]
Stock Position:  0.0007926597742632468
Bond Position:  [3.19227358]


portfolio before change:  [3.27265492]
curr_Stock_Price:  100.90367732234574
curr_Factors:  [100.90367732  -1.46628076  -0.84387776]
mat_Sqrt:  [[10.01423773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03256163 -0.04961677 -0.37518075]
Stock Position:  -0.03256163352635528
Bond Position:  [6.55824349]


portfolio before change:  [3.27419343]
curr_Stock_Price:  100.88160618099846
curr_Factors:  [100.88160618  -1.21302722  -0.85629551]
mat_Sqrt:  [[12.73844881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07846269  0.46822097 -0.75859062]
Stock Position:  0.07846268643732272
Bond Position:  [-4.64124841]


portfolio before change:  [3.32320871]
curr_Stock_Price:  101.51369609063184
curr_Factors:  [101.51369609  -1.11695345  -0.8590101 ]
mat_Sqrt:  [[14.07260746  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039113  0.01046194 -0.16630186]
Stock Position:  -0.0003911285106955368
Bond Position:  [3.36291361]


portfolio before change:  [3.32388733]
curr_Stock_Price:  100.85348420147962
curr_Factors:  [100.8534842   -1.14268986  -0.83664162]
mat_Sqrt:  [[13.93407579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.98959774e-02 -7.94942047e-04 -1.72208411e+00]
Stock Position:  -0.029895977426015168
Bond Position:  [6.33900081]


portfolio before change:  [3.30148022]
curr_Stock_Price:  101.62949260687896
curr_Factors:  [101.62949261  -1.33174941  -0.83859945]
mat_Sqrt:  [[11.59976595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.14018836 -1.07657212  7.98765887]
Stock Position:  0.14018835668451296
Bond Position:  [-10.94579134]


portfolio before change:  [3.34929226]
curr_Stock_Price:  101.9803088213413
curr_Factors:  [101.98030882  -1.27944526  -0.81702069]
mat_Sqrt:  [[12.53235611  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126868 -0.0302281   0.10456761]
Stock Position:  -0.0012686840725321228
Bond Position:  [3.47867305]


portfolio before change:  [3.3503326]
curr_Stock_Price:  101.50306123875774
curr_Factors:  [101.50306124  -1.13568991  -0.84271673]
mat_Sqrt:  [[14.03679807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00763623 -0.01382333 -0.00837998]
Stock Position:  0.007636229946227172
Bond Position:  [2.57523188]


portfolio before change:  [3.35276962]
curr_Stock_Price:  101.78004380577585
curr_Factors:  [101.78004381  -1.13903643  -0.83237679]
mat_Sqrt:  [[14.17387987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01012321 -0.036882   -0.11696787]
Stock Position:  -0.010123210174024592
Bond Position:  [4.3831104]


portfolio before change:  [3.34939831]
curr_Stock_Price:  102.1671978137503
curr_Factors:  [102.16719781  -1.42152675  -0.80917183]
mat_Sqrt:  [[10.97820652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05875284 -0.5455055  -0.56047019]
Stock Position:  -0.058752840786115396
Bond Position:  [9.35201141]


portfolio before change:  [3.40713489]
curr_Stock_Price:  101.20439316348057
curr_Factors:  [101.20439316  -1.07123003  -0.80645443]
mat_Sqrt:  [[15.47858887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00143723 0.01132882 0.20324416]
Stock Position:  0.0014372268032170291
Bond Position:  [3.26168122]


portfolio before change:  [3.40683136]
curr_Stock_Price:  100.7095076103889
curr_Factors:  [100.70950761  -0.98864855  -0.75747228]
mat_Sqrt:  [[17.56870822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01578192 0.00882153 1.09878467]
Stock Position:  0.015781919601290415
Bond Position:  [1.81744201]


portfolio before change:  [3.40018408]
curr_Stock_Price:  100.27391580627891
curr_Factors:  [100.27391581  -0.6642262   -0.74710099]
mat_Sqrt:  [[24.44873348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193096 -0.01120263  0.21497231]
Stock Position:  0.0019309624755941173
Bond Position:  [3.20655891]


portfolio before change:  [3.40192514]
curr_Stock_Price:  100.96797918115541
curr_Factors:  [100.96797918  -0.51945643  -0.7441566 ]
mat_Sqrt:  [[28.53668348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00392425 -0.01670952 -0.01881034]
Stock Position:  0.003924247976866804
Bond Position:  [3.00570175]


portfolio before change:  [3.40634437]
curr_Stock_Price:  101.99836677044502
curr_Factors:  [101.99836677  -0.495173    -0.76735745]
mat_Sqrt:  [[28.85912834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01031673 0.05110373 0.49287171]
Stock Position:  0.0103167273196164
Bond Position:  [2.35405503]


portfolio before change:  [3.40134238]
curr_Stock_Price:  101.48500040396527
curr_Factors:  [101.4850004   -0.59041057  -0.75508737]
mat_Sqrt:  [[26.42770954  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00652167  0.01288256  0.11883158]
Stock Position:  -0.006521672242709039
Bond Position:  [4.06319429]


portfolio before change:  [3.41463959]
curr_Stock_Price:  99.52395841506352
curr_Factors:  [99.52395842 -0.61673942 -0.75002948]
mat_Sqrt:  [[25.37157625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00058533 -0.03314423  0.05907103]
Stock Position:  0.0005853258661463117
Bond Position:  [3.35638564]


portfolio before change:  [3.41377834]
curr_Stock_Price:  97.33573214756144
curr_Factors:  [97.33573215 -0.95746676 -0.74174195]
mat_Sqrt:  [[17.79571052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00282376 -0.01565405  0.68796579]
Stock Position:  0.002823763834444403
Bond Position:  [3.13892522]


portfolio before change:  [3.41336032]
curr_Stock_Price:  97.0487363406762
curr_Factors:  [97.04873634 -1.10712804 -0.71904748]
mat_Sqrt:  [[15.62758735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00326805 -0.04431255  0.03660101]
Stock Position:  -0.003268047133914575
Bond Position:  [3.73052016]


portfolio before change:  [3.41108046]
curr_Stock_Price:  97.8890538284549
curr_Factors:  [97.88905383 -1.321869   -0.70923673]
mat_Sqrt:  [[12.84210219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164138 -0.04284868 -0.12395646]
Stock Position:  -0.0016413763080781278
Bond Position:  [3.57175324]


portfolio before change:  [3.41226513]
curr_Stock_Price:  97.43932901472127
curr_Factors:  [97.43932901 -1.44948154 -0.67788947]
mat_Sqrt:  [[11.60990837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00888531 -0.00083761  0.13092181]
Stock Position:  0.008885306139085683
Bond Position:  [2.54648686]


portfolio before change:  [3.41939941]
curr_Stock_Price:  98.20643254914071
curr_Factors:  [98.20643255 -1.60050949 -0.66031996]
mat_Sqrt:  [[10.23939231  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00119898  0.02080363 -0.0419206 ]
Stock Position:  0.0011989754676411915
Bond Position:  [3.30165231]


portfolio before change:  [3.41992733]
curr_Stock_Price:  98.30250472108435
curr_Factors:  [98.30250472 -1.47038348 -0.63145414]
mat_Sqrt:  [[12.01567303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316246 -0.00504129 -0.23232887]
Stock Position:  0.0031624611056881957
Bond Position:  [3.10904948]


portfolio before change:  [3.42069717]
curr_Stock_Price:  98.42303718991714
curr_Factors:  [98.42303719 -1.46819851 -0.6650199 ]
mat_Sqrt:  [[11.65874432  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445067  0.00489337 -0.12800837]
Stock Position:  -0.004450667408581061
Bond Position:  [3.85874537]


portfolio before change:  [3.42513635]
curr_Stock_Price:  97.53400002381689
curr_Factors:  [97.53400002 -1.13144623 -0.68092378]
mat_Sqrt:  [[15.92405759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00651617 -0.00788834  0.11866005]
Stock Position:  -0.0065161709886044725
Bond Position:  [4.06068457]


portfolio before change:  [3.42323627]
curr_Stock_Price:  97.90349515376737
curr_Factors:  [97.90349515 -1.06853069 -0.68703472]
mat_Sqrt:  [[16.91865453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00384438 -0.0059646  -0.01732534]
Stock Position:  -0.003844381155528232
Bond Position:  [3.79961462]


portfolio before change:  [3.41923493]
curr_Stock_Price:  99.06787612810793
curr_Factors:  [99.06787613 -1.16942652 -0.66327628]
mat_Sqrt:  [[15.8489371   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00512898 -0.00842901  0.18166913]
Stock Position:  -0.0051289770434254575
Bond Position:  [3.92735179]


portfolio before change:  [3.41515748]
curr_Stock_Price:  99.95857954239798
curr_Factors:  [99.95857954 -1.56067201 -0.67663958]
mat_Sqrt:  [[10.67008784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.014287   -0.02302491 -0.23710746]
Stock Position:  -0.014287004182281281
Bond Position:  [4.84326612]


portfolio before change:  [3.42443258]
curr_Stock_Price:  99.35175886546516
curr_Factors:  [99.35175887 -1.65859933 -0.68065647]
mat_Sqrt:  [[ 9.5774452   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.37799478 0.64813861 0.56849468]
Stock Position:  0.37799477946558646
Bond Position:  [-34.13001361]


portfolio before change:  [3.51278839]
curr_Stock_Price:  99.59679486228275
curr_Factors:  [99.59679486 -1.63064639 -0.68684035]
mat_Sqrt:  [[ 9.81236414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445231 -0.04916595 -0.15431354]
Stock Position:  -0.004452312306011594
Bond Position:  [3.95622442]


portfolio before change:  [3.51033589]
curr_Stock_Price:  100.25871147629739
curr_Factors:  [100.25871148  -1.40006836  -0.71700631]
mat_Sqrt:  [[12.06947208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013915  -0.00436007 -0.18702691]
Stock Position:  0.0013914982558096978
Bond Position:  [3.37082606]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.50974885]
Stock Price:  99.5340173053633
PL:  [3.50974885]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-2.96566186e-02 -6.99053961e-02  2.16866122e-01]
 [ 3.46243586e-01  2.08272470e-01  9.25126000e-02]
 [-4.26771287e-01 -3.06363763e-01  4.22449329e-02]
 [ 2.08909334e-01  1.55876327e+00  1.33542359e+00]
 [-4.77748618e-02 -3.25320921e-02 -1.79267802e-02]
 [ 3.96041479e-03  1.15091709e-01 -3.21867415e-02]
 [-7.75656118e-02  7.05957065e-02 -2.02520746e-02]
 [-2.49410917e-02  2.27482016e-01 -3.58350183e-02]
 [ 5.90620529e-03  7.41417854e-02 -4.79585926e-02]
 [-1.68614614e-01 -9.21087251e-02 -6.29222901e-02]
 [ 7.22191096e-01  1.39960540e+00 -2.49511391e-01]
 [-2.17881860e-04  2.15858529e-02 -5.78377609e-02]
 [-4.76144101e-02 -2.17195801e-02 -1.99875295e-01]
 [ 1.64562755e+00 -3.18342972e+00  2.70606392e+00]
 [ 7.41625418e-04 -9.63140813e-02  4.17266450e-02]
 [ 1.37759165e-01 -9.57347222e-02  2.84085085e-02]
 [-2.03673452e-01 -3.14643223e-01 -9.30632967e-03]
 [-2.61391370e-01 -1.71450622e+00 -2.02162581e-01]
 [-1.63084497e-04  3.31248268e-02  8.30693612e-02]
 [ 2.40352683e-01 -2.32820906e-01  3.08012457e-01]
 [ 5.08578721e-02  3.19946629e-02  3.77645602e-02]
 [ 1.34966024e-01 -5.29415759e-02 -1.23829472e-02]
 [ 3.08394577e-01  2.02385402e-01  2.25631917e-01]
 [-2.43407531e-01  8.63624675e-02  3.42945331e-02]
 [-5.27484253e-02 -2.13777952e-01  7.82353912e-02]
 [ 5.41482327e-02 -1.20196270e-02  5.75279407e-02]
 [ 3.44498700e-01 -8.16895291e-02  1.65450270e-01]
 [ 5.21555484e-02 -1.60833508e-01 -5.50075861e-02]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 3.30930068e-02  1.56461633e-02  1.00210905e-01]
 [-1.44309543e-02 -4.01049130e-02 -5.11325259e-02]
 [ 3.90948324e-02  1.47472591e-02 -5.75364613e-02]
 [-5.71387438e-02 -5.55753999e-02  1.44472539e-02]
 [ 3.62857933e-01  3.57693718e-02  6.61632830e-02]
 [-5.31746118e-02  1.16288381e-01 -4.10656256e-02]
 [ 1.86122526e-02  3.15708149e-02  6.95274674e-02]
 [ 2.98391374e+00  2.01983265e+00  2.16979365e-01]
 [-1.01748477e-01 -2.13167076e-02 -1.62467257e-02]
 [ 3.62377731e-02 -1.29161984e-02 -1.36574287e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.76092697]
curr_Stock_Price:  99.91173056752051
curr_Factors:  [99.91173057 -0.83242211 -0.99115087]
mat_Sqrt:  [[16.13053594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.11780955e-05 -2.25618696e-02  6.18658683e-01]
Stock Position:  2.117809547312309e-05
Bond Position:  [1.75881103]


portfolio before change:  [1.76112069]
curr_Stock_Price:  98.6771997348519
curr_Factors:  [98.67719973 -0.79080983 -0.9467799 ]
mat_Sqrt:  [[17.36165757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02347939 0.06721965 0.2639127 ]
Stock Position:  0.02347938722171652
Bond Position:  [-0.55575949]


portfolio before change:  [1.75692712]
curr_Stock_Price:  98.50155229940097
curr_Factors:  [98.5015523  -0.95344972 -0.96838686]
mat_Sqrt:  [[14.41451559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03334724 -0.09887848  0.12051303]
Stock Position:  -0.03334724041927511
Bond Position:  [5.04168207]


portfolio before change:  [1.73389195]
curr_Stock_Price:  99.2112187692345
curr_Factors:  [99.21121877 -1.13048114 -0.96752012]
mat_Sqrt:  [[12.17335851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06569122 0.50308868 3.80959179]
Stock Position:  0.06569121835665385
Bond Position:  [-4.78341388]


portfolio before change:  [1.6895268]
curr_Stock_Price:  98.54496238462366
curr_Factors:  [98.54496238 -1.08046894 -0.94164794]
mat_Sqrt:  [[13.04488413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445192 -0.01049969 -0.05114011]
Stock Position:  -0.004451916581337893
Bond Position:  [2.12824075]


portfolio before change:  [1.68613089]
curr_Stock_Price:  99.36751865542095
curr_Factors:  [99.36751866 -0.95445879 -0.97474995]
mat_Sqrt:  [[14.43443316  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144677  0.03714569 -0.09181981]
Stock Position:  0.0014467710759799195
Bond Position:  [1.54236884]


portfolio before change:  [1.68656177]
curr_Stock_Price:  99.53207433477779
curr_Factors:  [99.53207433 -1.07794862 -0.98986108]
mat_Sqrt:  [[12.5870719   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0053459   0.02278467 -0.05777353]
Stock Position:  -0.005345902641824433
Bond Position:  [2.21865055]


portfolio before change:  [1.6846584]
curr_Stock_Price:  99.93999890792732
curr_Factors:  [99.93999891 -1.10152858 -0.99341821]
mat_Sqrt:  [[12.30029451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115271  0.0734195  -0.10222733]
Stock Position:  0.0011527112522732256
Bond Position:  [1.56945643]


portfolio before change:  [1.68544245]
curr_Stock_Price:  100.44998023736294
curr_Factors:  [100.44998024  -1.16840304  -0.97183885]
mat_Sqrt:  [[11.81556818  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009522   0.02392916 -0.13681252]
Stock Position:  0.0009522036483598884
Bond Position:  [1.58979361]


portfolio before change:  [1.68595728]
curr_Stock_Price:  100.78193814267603
curr_Factors:  [100.78193814  -1.03929319  -0.95601766]
mat_Sqrt:  [[13.70345928  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01461384 -0.02972796 -0.17949978]
Stock Position:  -0.014613841924936878
Bond Position:  [3.15876859]


portfolio before change:  [1.66839302]
curr_Stock_Price:  102.01085022469127
curr_Factors:  [102.01085022  -0.89859039  -0.97714239]
mat_Sqrt:  [[15.63241122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06121596  0.4517207  -0.71178655]
Stock Position:  0.06121595952112951
Bond Position:  [-4.57629905]


portfolio before change:  [1.70804801]
curr_Stock_Price:  102.6679837331898
curr_Factors:  [102.66798373  -0.88651597  -1.00738626]
mat_Sqrt:  [[15.44983144  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049307  0.0069668  -0.16499503]
Stock Position:  -0.000493065029672086
Bond Position:  [1.75867]


portfolio before change:  [1.70795197]
curr_Stock_Price:  103.30863259277277
curr_Factors:  [103.30863259  -1.14435246  -1.01576379]
mat_Sqrt:  [[11.91269563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00779398 -0.00700996 -0.57018858]
Stock Position:  -0.007793976893245835
Bond Position:  [2.51313707]


portfolio before change:  [1.70621419]
curr_Stock_Price:  103.57190561592299
curr_Factors:  [103.57190562  -1.32398131  -0.99587602]
mat_Sqrt:  [[10.17983479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.15208357 -1.02744752  7.71964715]
Stock Position:  0.15208357440679654
Bond Position:  [-14.04537142]


portfolio before change:  [1.78171545]
curr_Stock_Price:  104.07989631340548
curr_Factors:  [104.07989631  -1.33605509  -0.98307233]
mat_Sqrt:  [[10.23723348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001016   -0.03108524  0.1190345 ]
Stock Position:  -0.0010159960071815777
Bond Position:  [1.88746021]


portfolio before change:  [1.78183637]
curr_Stock_Price:  104.19311185163781
curr_Factors:  [104.19311185  -1.01956493  -0.97085044]
mat_Sqrt:  [[14.23680688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00871096 -0.03089825  0.08104157]
Stock Position:  0.008710960258325764
Bond Position:  [0.87421432]


portfolio before change:  [1.78310706]
curr_Stock_Price:  104.32643876523568
curr_Factors:  [104.32643877  -1.27290984  -0.98439702]
mat_Sqrt:  [[10.9158729   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02471624 -0.10155066 -0.02654837]
Stock Position:  -0.024716243972394934
Bond Position:  [4.36166478]


portfolio before change:  [1.81045648]
curr_Stock_Price:  103.24196256150377
curr_Factors:  [103.24196256  -0.83980532  -0.99204342]
mat_Sqrt:  [[16.53082217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03947957 -0.5533545  -0.57671357]
Stock Position:  -0.039479569925659576
Bond Position:  [5.88640476]


portfolio before change:  [1.80176876]
curr_Stock_Price:  103.4806574424805
curr_Factors:  [103.48065744  -0.94644303  -0.97275273]
mat_Sqrt:  [[15.18319085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00155138 0.01069099 0.23697377]
Stock Position:  0.0015513836996649336
Bond Position:  [1.64123055]


portfolio before change:  [1.8000514]
curr_Stock_Price:  102.24142582400522
curr_Factors:  [102.24142582  -0.97028012  -0.9479988 ]
mat_Sqrt:  [[15.01512487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01702957 -0.07514262  0.87867381]
Stock Position:  0.017029568299408875
Bond Position:  [0.05892406]


portfolio before change:  [1.80199141]
curr_Stock_Price:  102.35491340878818
curr_Factors:  [102.35491341  -0.87168741  -0.9447132 ]
mat_Sqrt:  [[16.64393207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00391118 0.01032623 0.10773178]
Stock Position:  0.003911179976951113
Bond Position:  [1.40166292]


portfolio before change:  [1.79887666]
curr_Stock_Price:  101.51374302590318
curr_Factors:  [101.51374303  -0.74578207  -0.94158897]
mat_Sqrt:  [[18.78057619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00647646 -0.01708682 -0.0353251 ]
Stock Position:  0.006476463227871007
Bond Position:  [1.14142664]


portfolio before change:  [1.80802721]
curr_Stock_Price:  102.90460469906402
curr_Factors:  [102.9046047   -0.49514959  -0.9365602 ]
mat_Sqrt:  [[24.58392069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01609846 0.06531961 0.64366506]
Stock Position:  0.016098459274869685
Bond Position:  [0.15142163]


portfolio before change:  [1.81312241]
curr_Stock_Price:  103.21993096651127
curr_Factors:  [103.21993097  -0.71855818  -0.92595079]
mat_Sqrt:  [[19.9325285   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01097595  0.02787337  0.09783276]
Stock Position:  -0.010975954405342403
Bond Position:  [2.94605967]


portfolio before change:  [1.81372433]
curr_Stock_Price:  103.19864454240593
curr_Factors:  [103.19864454  -0.93462211  -0.91107806]
mat_Sqrt:  [[16.2965846   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00493453 -0.06899654  0.22318379]
Stock Position:  -0.0049345268684666665
Bond Position:  [2.32296081]


portfolio before change:  [1.81904703]
curr_Stock_Price:  102.17882809517403
curr_Factors:  [102.1788281   -1.02509336  -0.88822779]
mat_Sqrt:  [[15.08051243  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00420659 -0.00387932  0.1641112 ]
Stock Position:  0.004206593024291295
Bond Position:  [1.38922228]


portfolio before change:  [1.81655258]
curr_Stock_Price:  101.54455863324384
curr_Factors:  [101.54455863  -1.0739773   -0.84320543]
mat_Sqrt:  [[14.92913944  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02422084 -0.02636518  0.47198357]
Stock Position:  0.02422083946287634
Bond Position:  [-0.64294187]


portfolio before change:  [1.82521416]
curr_Stock_Price:  101.90548571325795
curr_Factors:  [101.90548571  -1.18728353  -0.82031436]
mat_Sqrt:  [[13.68701914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00059159 -0.05190879 -0.15692133]
Stock Position:  0.0005915948109012601
Bond Position:  [1.76492741]


portfolio before change:  [1.82520272]
curr_Stock_Price:  101.51319738169754
curr_Factors:  [101.51319738  -1.18777092  -0.82247285]
mat_Sqrt:  [[13.59830347  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162513 -0.02321455 -0.0028026 ]
Stock Position:  -0.0016251315810382283
Bond Position:  [1.99017502]


portfolio before change:  [1.82546275]
curr_Stock_Price:  101.50627733789602
curr_Factors:  [101.50627734  -0.9587881   -0.83245704]
mat_Sqrt:  [[16.92641648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00335229 0.00504978 0.28587382]
Stock Position:  0.0033522885292942926
Bond Position:  [1.48518442]


portfolio before change:  [1.82806021]
curr_Stock_Price:  102.22572756841835
curr_Factors:  [102.22572757  -0.96871549  -0.86380682]
mat_Sqrt:  [[16.35708384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202082 -0.01294381 -0.14586686]
Stock Position:  -0.0020208197792989085
Bond Position:  [2.03463999]


portfolio before change:  [1.82510958]
curr_Stock_Price:  103.81171001246676
curr_Factors:  [103.81171001  -0.95175616  -0.86100501]
mat_Sqrt:  [[16.94237036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00179199  0.00475966 -0.16413551]
Stock Position:  0.0017919879248383403
Bond Position:  [1.63908024]


portfolio before change:  [1.82428495]
curr_Stock_Price:  103.23719716319978
curr_Factors:  [103.23719716  -0.9702099   -0.83646421]
mat_Sqrt:  [[16.95147939  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00386597 -0.01793688  0.04121399]
Stock Position:  -0.0038659747585794704
Bond Position:  [2.22339735]


portfolio before change:  [1.82426475]
curr_Stock_Price:  103.31431637754258
curr_Factors:  [103.31431638  -0.81748075  -0.86503606]
mat_Sqrt:  [[19.20669952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01997557 0.01154452 0.18874543]
Stock Position:  0.01997557406882178
Bond Position:  [-0.23949802]


portfolio before change:  [1.82827956]
curr_Stock_Price:  103.51680076024469
curr_Factors:  [103.51680076  -0.8483161   -0.8381637 ]
mat_Sqrt:  [[19.16822816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197305  0.03753191 -0.1171488 ]
Stock Position:  -0.001973047837032351
Bond Position:  [2.03252316]


portfolio before change:  [1.82447783]
curr_Stock_Price:  105.57240893841342
curr_Factors:  [105.57240894  -1.27166572  -0.85579903]
mat_Sqrt:  [[12.57778672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00312049 0.01018944 0.19834251]
Stock Position:  0.003120489635359464
Bond Position:  [1.49504022]


portfolio before change:  [1.82378976]
curr_Stock_Price:  105.29201850218703
curr_Factors:  [105.2920185   -1.39563529  -0.82883706]
mat_Sqrt:  [[11.38464216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.30220547 0.65189818 0.61898173]
Stock Position:  0.30220546550030924
Bond Position:  [-29.9960337]


portfolio before change:  [1.68441331]
curr_Stock_Price:  104.84322877135897
curr_Factors:  [104.84322877  -0.98448819  -0.79799442]
mat_Sqrt:  [[17.63672836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00620388 -0.00687994 -0.04634739]
Stock Position:  -0.006203876282263119
Bond Position:  [2.33484773]


portfolio before change:  [1.68322128]
curr_Stock_Price:  105.08241861679514
curr_Factors:  [105.08241862  -1.08805877  -0.80271696]
mat_Sqrt:  [[15.8626811   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.60793707e-04 -4.16868509e-03 -3.89608426e-01]
Stock Position:  0.00036079370735949795
Bond Position:  [1.64530821]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.68325115]
Stock Price:  104.59513892519374
PL:  [-2.91188777]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 2.83151915e-02 -6.61845092e-02 -2.90678117e-02]
 [ 9.78206655e-01  2.23458796e-01  2.76069229e-01]
 [-2.44231493e-01 -1.38339652e-01  3.69205073e-02]
 [ 2.05262667e-01  1.37274449e+00  1.28170858e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-2.40322754e-02  2.68611098e-01 -1.17759866e-01]
 [-5.57552219e-02  9.56703994e-03 -6.22613109e-02]
 [-1.42628075e-02  2.28586185e-01 -3.37852087e-02]
 [ 1.95489424e-02  5.93781390e-02 -4.57156172e-02]
 [-1.03139677e-01 -5.14516313e-02 -1.76657716e-02]
 [ 7.51337861e-01  1.45771865e+00 -2.58947751e-01]
 [ 1.00826046e-04  4.14222741e-03 -5.79679827e-02]
 [-1.95854151e-01  2.53245459e-03 -3.75660963e-01]
 [ 1.62458046e+00 -3.12221100e+00  2.61643133e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.30169125e-01 -8.36460594e-02  2.39866698e-02]
 [-1.71304928e-01 -2.44494574e-01 -2.10175619e-02]
 [-2.62049007e-01 -1.71822908e+00 -2.02154549e-01]
 [-4.29419633e-03  3.71405479e-02  1.25011039e-01]
 [ 2.79272643e-01 -4.32709162e-01  2.48551110e-01]
 [ 6.13964175e-02 -5.71870673e-02  2.49983168e-03]
 [ 1.60565449e-01 -5.57870080e-02 -2.15189524e-02]
 [ 1.78187149e-01  2.20529456e-01  1.92588781e-01]
 [-2.61529339e-01  9.43457963e-02  2.23560011e-02]
 [-3.42064629e-02 -1.89715925e-01  6.69257816e-02]
 [ 8.47131841e-02 -1.63217880e-02  1.53482608e-02]
 [ 1.43518605e-01 -9.44204760e-02  5.91302831e-02]
 [-8.37105772e-02  5.00905652e-02  1.35121994e-01]
 [-8.32489033e-03 -7.37948921e-02 -1.15890234e-03]
 [ 1.53795553e-01 -4.05780830e-02  4.84923084e-02]
 [-2.17863273e-02 -5.54410139e-02 -3.85753294e-02]
 [ 3.69592286e-02  2.11508379e-02 -6.92801912e-02]
 [-1.10308735e-01 -3.83893779e-02  2.55927246e-02]
 [ 2.33996813e-01  1.38832036e-02  4.40975221e-02]
 [ 7.94182295e-02 -3.83698530e-02 -2.39538069e-03]
 [-9.74312467e-02 -3.33740942e-02 -1.03311324e-01]
 [ 1.76248555e+00  1.25009785e+00  1.68359720e-01]
 [-8.35196676e-02 -3.10076131e-02 -2.46543104e-02]
 [ 3.73450139e-02 -1.28769108e-02 -1.59027387e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.22464378]
curr_Stock_Price:  99.83854850555964
curr_Factors:  [99.83854851 -1.13090806 -0.98483683]
mat_Sqrt:  [[12.03488447  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073718 -0.02136096 -0.08292238]
Stock Position:  0.000737181390109464
Bond Position:  [1.15104466]


portfolio before change:  [1.22492215]
curr_Stock_Price:  100.02097486075233
curr_Factors:  [100.02097486  -0.94592843  -0.99491754]
mat_Sqrt:  [[14.36125487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07521435 0.07212102 0.78754867]
Stock Position:  0.07521434558621613
Bond Position:  [-6.29809002]


portfolio before change:  [1.22864726]
curr_Stock_Price:  100.08096897801023
curr_Factors:  [100.08096898  -0.9528972   -0.98230365]
mat_Sqrt:  [[14.45121782  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01833296 -0.04464893  0.10532393]
Stock Position:  -0.018332959388700564
Bond Position:  [3.0634276]


portfolio before change:  [1.24351327]
curr_Stock_Price:  99.29096803920774
curr_Factors:  [99.29096804 -0.86039609 -0.98549257]
mat_Sqrt:  [[15.67654982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04765721 0.44305138 3.65635783]
Stock Position:  0.04765721026990247
Bond Position:  [-3.48841728]


portfolio before change:  [1.22186362]
curr_Stock_Price:  98.84583992014689
curr_Factors:  [98.84583992 -0.93058503 -0.98435671]
mat_Sqrt:  [[14.56497579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00402651 -0.01106097 -0.05874131]
Stock Position:  -0.0040265086455060755
Bond Position:  [1.61986725]


portfolio before change:  [1.22360821]
curr_Stock_Price:  98.46285428109881
curr_Factors:  [98.46285428 -0.84986184 -0.98041867]
mat_Sqrt:  [[15.79034786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00042812  0.08669386 -0.33593612]
Stock Position:  0.0004281161728473923
Bond Position:  [1.18145467]


portfolio before change:  [1.22436342]
curr_Stock_Price:  99.88188821034345
curr_Factors:  [99.88188821 -1.03109703 -1.01979972]
mat_Sqrt:  [[12.84675981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00517729  0.00308775 -0.17761419]
Stock Position:  -0.005177289517216662
Bond Position:  [1.74148087]


portfolio before change:  [1.22313579]
curr_Stock_Price:  100.16105376326398
curr_Factors:  [100.16105376  -1.05943706  -1.03225355]
mat_Sqrt:  [[12.36770723  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00206188  0.07377587 -0.0963798 ]
Stock Position:  0.002061883814809021
Bond Position:  [1.01661534]


portfolio before change:  [1.22346423]
curr_Stock_Price:  100.25870779782589
curr_Factors:  [100.2587078   -0.76813461  -1.0404051 ]
mat_Sqrt:  [[16.43172988  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135943  0.01916421 -0.13041393]
Stock Position:  0.0013594303895901546
Bond Position:  [1.08716949]


portfolio before change:  [1.22437027]
curr_Stock_Price:  100.8252231745756
curr_Factors:  [100.82522317  -0.71816569  -1.03428184]
mat_Sqrt:  [[17.47796637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00670834 -0.01660594 -0.05039553]
Stock Position:  -0.006708343844343363
Bond Position:  [1.90074054]


portfolio before change:  [1.21672868]
curr_Stock_Price:  101.9997599971218
curr_Factors:  [101.99976     -0.84678647  -1.04303139]
mat_Sqrt:  [[15.41209506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0646269   0.47047667 -0.73870586]
Stock Position:  0.06462690134220654
Bond Position:  [-5.37519974]


portfolio before change:  [1.16004264]
curr_Stock_Price:  101.13302954135868
curr_Factors:  [101.13302954  -0.6884205   -1.05972116]
mat_Sqrt:  [[17.60697481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006183   0.0013369  -0.16536652]
Stock Position:  -0.0006182953267348684
Bond Position:  [1.22257272]


portfolio before change:  [1.15999034]
curr_Stock_Price:  101.46480113438304
curr_Factors:  [101.46480113  -0.5854473   -1.07677347]
mat_Sqrt:  [[19.24961722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.41311220e-02  8.17346205e-04 -1.07165616e+00]
Stock Position:  -0.014131121992143073
Bond Position:  [2.59380182]


portfolio before change:  [1.15803055]
curr_Stock_Price:  101.62643211364728
curr_Factors:  [101.62643211  -0.74021447  -1.07778852]
mat_Sqrt:  [[16.49901482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09220785 -1.00768927  7.46395032]
Stock Position:  0.09220784589033168
Bond Position:  [-8.21272384]


portfolio before change:  [1.25920676]
curr_Stock_Price:  102.73482868692993
curr_Factors:  [102.73482869  -1.03405662  -1.06944486]
mat_Sqrt:  [[12.53656668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172849 -0.03053791  0.10625201]
Stock Position:  -0.0017284934092870736
Bond Position:  [1.43678323]


portfolio before change:  [1.25812898]
curr_Stock_Price:  103.46227390923808
curr_Factors:  [103.46227391  -1.3069189   -1.05236633]
mat_Sqrt:  [[ 9.77591607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01206958 -0.02699665  0.06842729]
Stock Position:  0.012069580225533245
Bond Position:  [0.00938277]


portfolio before change:  [1.25783619]
curr_Stock_Price:  103.43791783664916
curr_Factors:  [103.43791784  -1.49692463  -1.07441206]
mat_Sqrt:  [[ 7.90610238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02852257 -0.07891028 -0.05995725]
Stock Position:  -0.02852257092804945
Bond Position:  [4.20815154]


portfolio before change:  [1.2665316]
curr_Stock_Price:  103.15150042997799
curr_Factors:  [103.15150043  -1.06503478  -1.07078074]
mat_Sqrt:  [[12.18716396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05366677 -0.55455605 -0.57669066]
Stock Position:  -0.05366676586255195
Bond Position:  [6.80233902]


portfolio before change:  [1.25825412]
curr_Stock_Price:  103.32158391962604
curr_Factors:  [103.32158392  -0.97353497  -1.05394657]
mat_Sqrt:  [[13.60401207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00211738 0.01198706 0.3566217 ]
Stock Position:  0.002117379602553591
Bond Position:  [1.0394831]


portfolio before change:  [1.25885595]
curr_Stock_Price:  103.54444676183378
curr_Factors:  [103.54444676  -0.930126    -1.04623949]
mat_Sqrt:  [[14.34835736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01684385 -0.13965628  0.70904713]
Stock Position:  0.016843847140017923
Bond Position:  [-0.48523089]


portfolio before change:  [1.24276686]
curr_Stock_Price:  102.5928574419054
curr_Factors:  [102.59285744  -1.19775666  -1.02866231]
mat_Sqrt:  [[11.07122445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0045373  -0.01845705  0.00713132]
Stock Position:  0.004537296888930385
Bond Position:  [0.77727261]


portfolio before change:  [1.24333215]
curr_Stock_Price:  102.69602983317414
curr_Factors:  [102.69602983  -1.0788121   -1.02096429]
mat_Sqrt:  [[12.57860138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01151046 -0.01800518 -0.06138758]
Stock Position:  0.01151045587409204
Bond Position:  [0.06125403]


portfolio before change:  [1.24944535]
curr_Stock_Price:  103.22646418268428
curr_Factors:  [103.22646418  -1.01458473  -1.04631186]
mat_Sqrt:  [[13.14483192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01997093 0.07117558 0.54940219]
Stock Position:  0.0199709328874384
Bond Position:  [-0.81208344]


portfolio before change:  [1.23992986]
curr_Stock_Price:  102.75508041953972
curr_Factors:  [102.75508042  -0.75760142  -1.07400019]
mat_Sqrt:  [[16.45693025  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01444423  0.03044997  0.06377545]
Stock Position:  -0.014444229919350448
Bond Position:  [2.72414787]


portfolio before change:  [1.24762509]
curr_Stock_Price:  102.24590184467023
curr_Factors:  [102.24590184  -0.72860447  -1.07025029]
mat_Sqrt:  [[16.92050087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035029  -0.06123055  0.19092063]
Stock Position:  -0.003502904340499244
Bond Position:  [1.60578271]


portfolio before change:  [1.24627839]
curr_Stock_Price:  102.68765971935649
curr_Factors:  [102.68765972  -0.53959996  -1.08303432]
mat_Sqrt:  [[20.26829142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00416979 -0.00526783  0.04378432]
Stock Position:  0.004169787278341801
Bond Position:  [0.81809269]


portfolio before change:  [1.23853161]
curr_Stock_Price:  100.8052975575092
curr_Factors:  [100.80529756  -0.51960699  -1.06252042]
mat_Sqrt:  [[20.71925564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00657915 -0.03047408  0.16868224]
Stock Position:  0.006579146794224607
Bond Position:  [0.57531876]


portfolio before change:  [1.23864418]
curr_Stock_Price:  100.81147643687973
curr_Factors:  [100.81147644  -0.60649051  -1.06306925]
mat_Sqrt:  [[18.98582108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241782  0.01616666  0.38546544]
Stock Position:  -0.00241781599190874
Bond Position:  [1.48238778]


portfolio before change:  [1.23479199]
curr_Stock_Price:  102.4813719904054
curr_Factors:  [102.48137199  -0.53480755  -1.07084491]
mat_Sqrt:  [[20.57400908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00114828 -0.0238172  -0.00330603]
Stock Position:  -0.0011482822555154688
Bond Position:  [1.35246953]


portfolio before change:  [1.23362023]
curr_Stock_Price:  103.6490587208119
curr_Factors:  [103.64905872  -0.80345544  -1.08811668]
mat_Sqrt:  [[15.63385324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00994067 -0.01309652  0.13833506]
Stock Position:  0.009940673947016062
Bond Position:  [0.20327873]


portfolio before change:  [1.22886847]
curr_Stock_Price:  103.16849132193875
curr_Factors:  [103.16849132  -0.75366699  -1.07937893]
mat_Sqrt:  [[16.49929366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248358 -0.01789351 -0.11004468]
Stock Position:  -0.0024835810479183094
Bond Position:  [1.48509578]


portfolio before change:  [1.23056911]
curr_Stock_Price:  102.55849151505122
curr_Factors:  [102.55849152  -0.39426442  -1.07573256]
mat_Sqrt:  [[23.58088201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115071  0.0068264  -0.1976371 ]
Stock Position:  0.0011507146115906587
Bond Position:  [1.11255355]


portfolio before change:  [1.22924959]
curr_Stock_Price:  101.29093192232732
curr_Factors:  [101.29093192  -0.64463201  -1.10446128]
mat_Sqrt:  [[17.61769162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00640951 -0.01239012  0.07300892]
Stock Position:  -0.00640951398126471
Bond Position:  [1.87847523]


portfolio before change:  [1.2313234]
curr_Stock_Price:  101.00401652903481
curr_Factors:  [101.00401653  -0.59142022  -1.12286263]
mat_Sqrt:  [[18.19009911  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01351461 0.00448078 0.12579796]
Stock Position:  0.013514609129177107
Bond Position:  [-0.13370641]


portfolio before change:  [1.22532569]
curr_Stock_Price:  100.56145889575437
curr_Factors:  [100.5614589   -0.40177556  -1.14623061]
mat_Sqrt:  [[21.38656458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00332438 -0.01238382 -0.00683335]
Stock Position:  0.0033243796937755536
Bond Position:  [0.89102122]


portfolio before change:  [1.23169962]
curr_Stock_Price:  102.44528207203126
curr_Factors:  [102.44528207  -0.57297699  -1.15337128]
mat_Sqrt:  [[18.22839516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00687565 -0.01077144 -0.29471845]
Stock Position:  -0.006875648664967617
Bond Position:  [1.93607738]


portfolio before change:  [1.22028249]
curr_Stock_Price:  104.1409993283897
curr_Factors:  [104.14099933  -0.62699593  -1.13920477]
mat_Sqrt:  [[17.80617016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11524247 0.40346735 0.48028342]
Stock Position:  0.1152424676112896
Bond Position:  [-10.78118326]


portfolio before change:  [1.24612838]
curr_Stock_Price:  104.376968076875
curr_Factors:  [104.37696808  -0.78204378  -1.12578798]
mat_Sqrt:  [[15.48973088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00612545 -0.01000766 -0.07033189]
Stock Position:  -0.006125452464777265
Bond Position:  [1.88548453]


portfolio before change:  [1.24333241]
curr_Stock_Price:  104.87189803086608
curr_Factors:  [104.87189803  -0.79529557  -1.11638215]
mat_Sqrt:  [[15.5034389   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.45464243e-04 -4.15600508e-03 -4.53660871e-01]
Stock Position:  0.0001454642433298956
Bond Position:  [1.22807729]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.2436787]
Stock Price:  106.19713655123337
PL:  [-4.95345785]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-2.99826560e-02 -6.90482605e-02  2.19138561e-01]
 [ 1.12004016e+00  2.44574325e-01  3.15186186e-01]
 [ 1.29690584e-01  2.39773832e-01  4.29973334e-02]
 [ 7.96053270e-02  4.27216718e-01  4.72664580e-01]
 [-4.78216756e-02 -3.22835942e-02 -1.75460433e-02]
 [-4.14859869e-02  3.81337427e-01 -1.86127825e-01]
 [-5.24623129e-02 -2.27646272e-02 -4.28968096e-02]
 [-5.38491321e-02  1.03110455e-01  9.13691511e-03]
 [ 4.60245613e-02  3.07272405e-02 -4.13628132e-02]
 [-1.37329362e-01 -7.26819415e-02 -4.12978082e-02]
 [ 8.05647693e-01  1.56040485e+00 -2.77940996e-01]
 [ 1.65042518e-06  4.79245311e-03 -5.77211427e-02]
 [-1.45416703e-01 -3.64737729e-03 -2.97240699e-01]
 [ 1.54723157e+00 -2.98286911e+00  2.52737360e+00]
 [ 1.11028569e-02 -9.79562274e-02  4.60656274e-02]
 [ 1.56180864e-01 -1.02155227e-01  2.85233095e-02]
 [-2.24528232e-01 -3.63246649e-01 -6.02091033e-03]
 [-2.58840057e-01 -1.70679300e+00 -2.04624709e-01]
 [ 3.12641765e-04  3.44652460e-02  7.50497544e-02]
 [ 2.88497951e-01 -4.49186694e-01  2.50306408e-01]
 [ 5.19390990e-02  3.94419346e-02  3.62544249e-02]
 [ 1.55164800e-01 -5.51827304e-02 -1.97114977e-02]
 [ 2.32284192e-01  1.44569984e-01  1.69611734e-01]
 [-2.57979015e-01  9.01306601e-02  2.13362894e-02]
 [-4.81772320e-02 -2.07839559e-01  7.59034380e-02]
 [ 5.41821771e-02 -8.79006003e-03  1.18717213e-01]
 [ 2.76734704e-01 -8.12642300e-02  1.25222234e-01]
 [-7.84917348e-02  4.54047326e-02  1.27073978e-01]
 [-4.73286458e-03 -7.03127864e-02  4.87088123e-03]
 [ 4.99969842e-02  5.08788407e-03  1.04837081e-01]
 [-2.00833318e-02 -3.41708786e-02 -5.29701003e-02]
 [-1.94361893e-02  2.10800763e-02 -5.38899682e-02]
 [-1.18069121e-01 -3.87448071e-02  2.12500833e-02]
 [ 1.66989208e-01  6.73085479e-03  2.90093015e-02]
 [ 4.89672379e-02 -2.80824321e-02  3.94868567e-03]
 [-1.18008064e-01 -6.88979837e-02 -8.03904664e-02]
 [ 1.60943000e+00  1.05799878e+00  1.43618834e-01]
 [-4.05605588e-02 -4.51952100e-02 -1.01160501e-02]
 [ 3.38774846e-02 -1.40446958e-02 -8.55135440e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.74869925]
curr_Stock_Price:  99.29633976071706
curr_Factors:  [99.29633976 -0.84046029 -0.98420584]
mat_Sqrt:  [[16.01366762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.08649802e-05 -2.22852303e-02  6.25141317e-01]
Stock Position:  4.0864980229292064e-05
Bond Position:  [-2.75275699]


portfolio before change:  [-2.74897977]
curr_Stock_Price:  100.85251677003501
curr_Factors:  [100.85251677  -0.53559649  -0.98563431]
mat_Sqrt:  [[22.03051221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05602688 0.07893602 0.89913846]
Stock Position:  0.0560268769612627
Bond Position:  [-8.39943132]


portfolio before change:  [-2.66681226]
curr_Stock_Price:  102.33783081401364
curr_Factors:  [102.33783081  -0.59747512  -0.98895814]
mat_Sqrt:  [[20.94387304  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00894825 0.07738667 0.12265942]
Stock Position:  0.008948249743397061
Bond Position:  [-3.58255673]


portfolio before change:  [-2.67058367]
curr_Stock_Price:  101.96641055569167
curr_Factors:  [101.96641056  -0.47246093  -0.99885686]
mat_Sqrt:  [[23.41380161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0112452  0.1378836  1.34838048]
Stock Position:  0.011245197685670925
Bond Position:  [-3.81721611]


portfolio before change:  [-2.71033797]
curr_Stock_Price:  98.4736201706931
curr_Factors:  [98.47362017 -0.49030556 -0.99282946]
mat_Sqrt:  [[22.34614166  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259522 -0.01041949 -0.05005398]
Stock Position:  -0.0025952179439833233
Bond Position:  [-2.45477746]


portfolio before change:  [-2.71117424]
curr_Stock_Price:  98.6776130970463
curr_Factors:  [98.6776131  -0.33368864 -0.97887534]
mat_Sqrt:  [[26.55702028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.17160278e-05  1.23076125e-01 -5.30970878e-01]
Stock Position:  -6.171602784183763e-05
Bond Position:  [-2.70508425]


portfolio before change:  [-2.71145519]
curr_Stock_Price:  97.75063378478015
curr_Factors:  [97.75063378 -0.31394    -0.9881757 ]
mat_Sqrt:  [[26.5838523   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247765 -0.00734725 -0.12237266]
Stock Position:  -0.0024776468369851062
Bond Position:  [-2.46926364]


portfolio before change:  [-2.71697052]
curr_Stock_Price:  99.85208558568473
curr_Factors:  [99.85208559 -0.17280364 -1.01011996]
mat_Sqrt:  [[30.59285092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101124  0.03327876  0.02606508]
Stock Position:  -0.001011240624371279
Bond Position:  [-2.61599603]


portfolio before change:  [-2.71806291]
curr_Stock_Price:  100.60895236414285
curr_Factors:  [100.60895236  -0.19479339  -1.00974114]
mat_Sqrt:  [[30.16573596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00145375  0.00991717 -0.11799659]
Stock Position:  0.001453754823327586
Bond Position:  [-2.86432366]


portfolio before change:  [-2.71632726]
curr_Stock_Price:  102.04916380979896
curr_Factors:  [102.04916381  -0.41336478  -1.01032548]
mat_Sqrt:  [[24.5758543   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00653468 -0.023458   -0.11781115]
Stock Position:  -0.006534681526764547
Bond Position:  [-2.04946848]


portfolio before change:  [-2.71432248]
curr_Stock_Price:  101.7031664306305
curr_Factors:  [101.70316643  -0.6033154   -0.99976424]
mat_Sqrt:  [[20.4703765   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05214509  0.5036185  -0.7928883 ]
Stock Position:  0.05214508536919939
Bond Position:  [-8.01764278]


portfolio before change:  [-2.71339476]
curr_Stock_Price:  101.74017827356423
curr_Factors:  [101.74017827  -0.67381592  -1.01175217]
mat_Sqrt:  [[18.85643422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057287  0.00154676 -0.16466235]
Stock Position:  -0.0005728746469453947
Bond Position:  [-2.65511039]


portfolio before change:  [-2.71403555]
curr_Stock_Price:  102.27935300478
curr_Factors:  [102.279353    -0.73196322  -1.0235824 ]
mat_Sqrt:  [[17.67519416  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01170201 -0.00117719 -0.84794498]
Stock Position:  -0.011702005788039191
Bond Position:  [-1.51716197]


portfolio before change:  [-2.73460847]
curr_Stock_Price:  104.02121334847327
curr_Factors:  [104.02121335  -0.91053882  -1.04842771]
mat_Sqrt:  [[14.66741432  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09914862 -0.96271687  7.20989341]
Stock Position:  0.09914862364775957
Bond Position:  [-13.0481686]


portfolio before change:  [-2.61195378]
curr_Stock_Price:  105.27474369364884
curr_Factors:  [105.27474369  -0.96530242  -1.08244674]
mat_Sqrt:  [[13.58307295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.76006589e-05 -3.16152364e-02  1.31412413e-01]
Stock Position:  3.760065891471984e-05
Bond Position:  [-2.61591218]


portfolio before change:  [-2.61229322]
curr_Stock_Price:  104.94419659808152
curr_Factors:  [104.9441966   -0.69545178  -1.06338343]
mat_Sqrt:  [[18.07615269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00780868 -0.03297046  0.08136906]
Stock Position:  0.007808675554080948
Bond Position:  [-3.4317684]


portfolio before change:  [-2.61462261]
curr_Stock_Price:  104.70082679211887
curr_Factors:  [104.70082679  -0.67945433  -1.05644099]
mat_Sqrt:  [[18.4527184   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0162526  -0.11723735 -0.01717598]
Stock Position:  -0.016252600309593898
Bond Position:  [-0.91296192]


portfolio before change:  [-2.6067963]
curr_Stock_Price:  104.2122624952665
curr_Factors:  [104.2122625   -0.66246175  -1.04923307]
mat_Sqrt:  [[18.81651569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03449133 -0.55086507 -0.58373734]
Stock Position:  -0.03449132523323809
Bond Position:  [0.98762274]


portfolio before change:  [-2.6291869]
curr_Stock_Price:  104.865008144569
curr_Factors:  [104.86500814  -0.73274723  -1.06151228]
mat_Sqrt:  [[17.4338615   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00130019 0.01112361 0.21409606]
Stock Position:  0.0013001880047567283
Bond Position:  [-2.76553113]


portfolio before change:  [-2.63056734]
curr_Stock_Price:  104.06918500458305
curr_Factors:  [104.069185    -0.87460966  -1.07014278]
mat_Sqrt:  [[14.8842481   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0166553  -0.14497438  0.71405451]
Stock Position:  0.01665530433917046
Bond Position:  [-4.36387128]


portfolio before change:  [-2.65508651]
curr_Stock_Price:  102.62978435327719
curr_Factors:  [102.62978435  -0.6708599   -1.09302891]
mat_Sqrt:  [[17.58839613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00383153 0.01272983 0.10342378]
Stock Position:  0.0038315349061585047
Bond Position:  [-3.04831611]


portfolio before change:  [-2.65629847]
curr_Stock_Price:  102.41292720327185
curr_Factors:  [102.4129272   -0.83654335  -1.08113784]
mat_Sqrt:  [[15.04930423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00929459 -0.01781015 -0.05623142]
Stock Position:  0.00929458781615607
Bond Position:  [-3.60818441]


portfolio before change:  [-2.66259887]
curr_Stock_Price:  101.78359886965735
curr_Factors:  [101.78359887  -0.70855989  -1.09146054]
mat_Sqrt:  [[16.82437203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01761827 0.04665976 0.48385507]
Stock Position:  0.017618266310800063
Bond Position:  [-4.45584942]


portfolio before change:  [-2.65798912]
curr_Stock_Price:  102.07686036206889
curr_Factors:  [102.07686036  -0.68992105  -1.07934038]
mat_Sqrt:  [[17.39990298  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01351881  0.02908955  0.06086649]
Stock Position:  -0.013518806362613683
Bond Position:  [-1.27803182]


portfolio before change:  [-2.66846881]
curr_Stock_Price:  102.84023546536507
curr_Factors:  [102.84023547  -0.78593866  -1.07095959]
mat_Sqrt:  [[16.05914425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.004677   -0.06707993  0.21653138]
Stock Position:  -0.00467699765313267
Bond Position:  [-2.18748527]


portfolio before change:  [-2.66246746]
curr_Stock_Price:  101.49860412133356
curr_Factors:  [101.49860412  -0.58747193  -1.079462  ]
mat_Sqrt:  [[19.16548713  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00399786 -0.00283698  0.33866717]
Stock Position:  0.0039978615093873154
Bond Position:  [-3.06824482]


portfolio before change:  [-2.66206108]
curr_Stock_Price:  101.69619243219533
curr_Factors:  [101.69619243  -0.73101484  -1.06772886]
mat_Sqrt:  [[16.83139953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01697468 -0.02622792  0.35722418]
Stock Position:  0.01697467839711476
Bond Position:  [-4.38832124]


portfolio before change:  [-2.67411487]
curr_Stock_Price:  101.0184055561309
curr_Factors:  [101.01840556  -0.69877541  -1.07358703]
mat_Sqrt:  [[17.16616488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252151  0.01465431  0.36250669]
Stock Position:  -0.002521510527128042
Bond Position:  [-2.41939589]


portfolio before change:  [-2.67381825]
curr_Stock_Price:  100.78082556359189
curr_Factors:  [100.78082556  -0.65434831  -1.08824013]
mat_Sqrt:  [[17.64336292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102538 -0.02269335  0.01389527]
Stock Position:  -0.00102537921025591
Bond Position:  [-2.57047969]


portfolio before change:  [-2.67543494]
curr_Stock_Price:  102.04412439083589
curr_Factors:  [102.04412439  -0.83829558  -1.10068367]
mat_Sqrt:  [[14.67911969  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00493458 0.00164211 0.29907101]
Stock Position:  0.004934582262220871
Bond Position:  [-3.17898007]


portfolio before change:  [-2.67656637]
curr_Stock_Price:  101.89537218567564
curr_Factors:  [101.89537219  -0.75313037  -1.07816952]
mat_Sqrt:  [[16.3241667   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231993 -0.0110286  -0.15110895]
Stock Position:  -0.002319929114552423
Bond Position:  [-2.44017633]


portfolio before change:  [-2.67569917]
curr_Stock_Price:  101.39008014370276
curr_Factors:  [101.39008014  -0.56626107  -1.06868144]
mat_Sqrt:  [[19.76737295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132205  0.00680357 -0.15373308]
Stock Position:  -0.0013220512647057296
Bond Position:  [-2.54165628]


portfolio before change:  [-2.67640434]
curr_Stock_Price:  101.68314167605392
curr_Factors:  [101.68314168  -0.54285423  -1.09802539]
mat_Sqrt:  [[19.70715757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00617239 -0.01250483  0.06062057]
Stock Position:  -0.006172387663862398
Bond Position:  [-2.04877657]


portfolio before change:  [-2.67144274]
curr_Stock_Price:  100.83780999451302
curr_Factors:  [100.83780999  -0.23656622  -1.0760029 ]
mat_Sqrt:  [[27.13825238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0064221  0.00217237 0.08275546]
Stock Position:  0.006422102437362895
Bond Position:  [-3.31903348]


portfolio before change:  [-2.67642429]
curr_Stock_Price:  100.12672688544207
curr_Factors:  [100.12672689  -0.40395064  -1.08022492]
mat_Sqrt:  [[22.69764314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194033 -0.00906357  0.0112645 ]
Stock Position:  0.0019403317451705273
Bond Position:  [-2.87070336]


portfolio before change:  [-2.68075625]
curr_Stock_Price:  98.07908907059362
curr_Factors:  [98.07908907 -0.53467568 -1.08862277]
mat_Sqrt:  [[19.34580754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00767512 -0.02223673 -0.22933162]
Stock Position:  -0.007675122449050228
Bond Position:  [-1.92798723]


portfolio before change:  [-2.69233299]
curr_Stock_Price:  99.55603363132914
curr_Factors:  [99.55603363 -0.80989048 -1.1080324 ]
mat_Sqrt:  [[14.62595595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.12680943 0.34146764 0.40970456]
Stock Position:  0.12680943240567072
Bond Position:  [-15.31697711]


portfolio before change:  [-2.77443582]
curr_Stock_Price:  98.92368253409303
curr_Factors:  [98.92368253 -0.52288715 -1.11247948]
mat_Sqrt:  [[19.27833722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026896  -0.01458669 -0.02885828]
Stock Position:  -0.0026895951611828565
Bond Position:  [-2.50837116]


portfolio before change:  [-2.77620921]
curr_Stock_Price:  99.46645213675318
curr_Factors:  [99.46645214 -0.73880448 -1.10247639]
mat_Sqrt:  [[15.77678492  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085919 -0.00453291 -0.24394634]
Stock Position:  0.0008591892525712194
Bond Position:  [-2.86166972]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.77692452]
Stock Price:  99.05027375794835
PL:  [-2.77692452]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 9.66461110e-02 -1.33081538e-02 -1.33637844e-01]
 [ 1.06284703e+00  2.28425070e-01  3.02842753e-01]
 [-2.09285872e-01 -1.06172929e-01  3.59011934e-02]
 [ 1.85808190e-01  1.49845362e+00  1.20534650e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 2.92050973e-02 -3.73114739e-02  5.73047548e-02]
 [-1.27095214e-01  2.09186790e-01  7.51474464e-02]
 [-4.17496407e-02  2.46489374e-02  4.37777938e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-8.79554540e-02 -4.20228877e-02 -7.17038031e-03]
 [ 6.65979158e-01  1.38354377e+00 -2.07122494e-01]
 [-4.51713967e-04  2.94974226e-02  6.39361902e-03]
 [-4.69099231e-01 -3.65157474e-02 -1.07708555e+00]
 [ 2.16483660e+00 -3.38983066e+00  2.88138778e+00]
 [ 2.73226079e-03  8.22485879e-03 -2.17236339e-02]
 [ 2.10664038e-02  2.82894547e-01 -1.57175083e-01]
 [ 3.14641475e-02 -2.50128689e-01  1.11275506e-02]
 [-2.96497143e-01 -1.89271213e+00 -1.94318880e-01]
 [ 3.19678279e-02 -6.95465199e-02  3.95121031e-02]
 [-2.30953855e-01  3.48896996e-01  1.44220582e-01]
 [ 1.70024116e-02  1.02827092e-01 -6.21222911e-02]
 [ 1.22354696e-01 -5.25538946e-02  6.60719421e-02]
 [-2.97130322e-02 -1.00779816e-01 -9.91581347e-02]
 [-2.67200784e-01  9.68442785e-02  1.86196888e-02]
 [ 1.05674784e-01 -2.24099954e-02 -3.75085409e-02]
 [-3.99949877e-02 -5.74421436e-02  1.74139410e-01]
 [-1.07804354e-01 -1.35364064e-01  3.77349139e-03]
 [-4.41749037e-02 -7.77746429e-02  2.35722114e-02]
 [ 1.74643862e-01  8.27660372e-02  1.31927787e-01]
 [-1.62886006e-01  1.21567921e-01 -4.53908898e-02]
 [ 8.74008014e-02 -8.53616470e-03 -3.57736399e-02]
 [-4.29925229e-02 -1.77075131e-03 -4.04186950e-02]
 [-2.23570139e-02  3.85580379e-02  9.42250523e-02]
 [ 6.35282559e-03 -4.74693423e-02 -1.28449974e-02]
 [-8.77470209e-02  5.52112787e-02  4.95798632e-02]
 [-9.97382917e-02 -5.64798316e-02 -6.31858174e-02]
 [ 1.51090135e+00  9.85594977e-01  1.37686291e-01]
 [ 3.01885199e-02 -6.90515726e-02  5.70217722e-02]
 [ 3.00025585e-02 -1.52714640e-02 -2.12064829e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.96943656]
curr_Stock_Price:  100.21310731917414
curr_Factors:  [100.21310732  -1.25410457  -1.00331957]
mat_Sqrt:  [[10.48425754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00635723 -0.00429519 -0.38123157]
Stock Position:  0.006357234594870589
Bond Position:  [3.33235833]


portfolio before change:  [3.96950791]
curr_Stock_Price:  100.15880248039807
curr_Factors:  [100.15880248  -1.01301303  -1.00080955]
mat_Sqrt:  [[13.3689435   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08761288 0.07372387 0.86392608]
Stock Position:  0.08761287838182324
Bond Position:  [-4.80569307]


portfolio before change:  [3.97473476]
curr_Stock_Price:  100.22531787249812
curr_Factors:  [100.22531787  -1.30941787  -1.01106481]
mat_Sqrt:  [[ 9.8447483   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02271567 -0.03426717  0.10241611]
Stock Position:  -0.022715667588221924
Bond Position:  [6.25141977]


portfolio before change:  [3.99060725]
curr_Stock_Price:  99.56097397493582
curr_Factors:  [99.56097397 -1.32206571 -1.03935173]
mat_Sqrt:  [[ 9.38725408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07858731 0.48362383 3.43851805]
Stock Position:  0.0785873134651619
Bond Position:  [-3.83362222]


portfolio before change:  [4.03551219]
curr_Stock_Price:  100.13847391440525
curr_Factors:  [100.13847391  -1.44649753  -1.05915995]
mat_Sqrt:  [[ 8.17349404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00717514 -0.01106097 -0.05874131]
Stock Position:  -0.0071751445145073305
Bond Position:  [4.75402021]


portfolio before change:  [4.04120079]
curr_Stock_Price:  99.42847930297862
curr_Factors:  [99.4284793  -1.51420063 -1.042742  ]
mat_Sqrt:  [[ 7.70982859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00431737 -0.01204223  0.16347451]
Stock Position:  0.004317373372491334
Bond Position:  [3.61193092]


portfolio before change:  [4.04044108]
curr_Stock_Price:  99.1479297617132
curr_Factors:  [99.14792976 -1.43479466 -1.04695777]
mat_Sqrt:  [[ 8.28842982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00833158  0.06751475  0.21437475]
Stock Position:  -0.008331581768336618
Bond Position:  [4.86650016]


portfolio before change:  [4.04756762]
curr_Stock_Price:  98.36558193438455
curr_Factors:  [98.36558193 -1.43955001 -1.04807526]
mat_Sqrt:  [[ 8.17487719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339847  0.00795541  0.12488586]
Stock Position:  -0.003398472178022696
Bond Position:  [4.38186031]


portfolio before change:  [4.04774131]
curr_Stock_Price:  98.47565365538655
curr_Factors:  [98.47565366 -1.30733449 -1.03394476]
mat_Sqrt:  [[ 9.47380008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00548789  0.0064198  -0.11330016]
Stock Position:  0.005487893231307776
Bond Position:  [3.50731744]


portfolio before change:  [4.04611045]
curr_Stock_Price:  98.09858713374815
curr_Factors:  [98.09858713 -1.49506564 -1.03919093]
mat_Sqrt:  [[ 7.78124537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.012594   -0.01356283 -0.0204551 ]
Stock Position:  -0.012593997895211321
Bond Position:  [5.28156385]


portfolio before change:  [4.05100337]
curr_Stock_Price:  97.76250005530896
curr_Factors:  [97.76250006 -1.32975592 -1.03404894]
mat_Sqrt:  [[ 9.19570216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09853681  0.44653683 -0.59086282]
Stock Position:  0.09853680891293118
Bond Position:  [-5.58220142]


portfolio before change:  [4.04513949]
curr_Stock_Price:  97.71007232804253
curr_Factors:  [97.71007233 -1.35777088 -1.03912841]
mat_Sqrt:  [[ 8.8915853   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00077315 0.00952025 0.01823922]
Stock Position:  0.0007731483182522794
Bond Position:  [3.96959511]


portfolio before change:  [4.04503368]
curr_Stock_Price:  96.93138250206444
curr_Factors:  [96.9313825  -1.34224147 -1.0512573 ]
mat_Sqrt:  [[ 8.85077084  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07868378 -0.01178541 -3.07262528]
Stock Position:  -0.07868378440642496
Bond Position:  [11.67196168]


portfolio before change:  [4.06883656]
curr_Stock_Price:  96.6474130330897
curr_Factors:  [96.64741303 -1.33947943 -1.05820024]
mat_Sqrt:  [[ 8.78802293  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.23452956 -1.09406314  8.21979732]
Stock Position:  0.23452955801462538
Bond Position:  [-18.59783851]


portfolio before change:  [3.93025417]
curr_Stock_Price:  96.06643077785375
curr_Factors:  [96.06643078 -1.2507457  -1.04347824]
mat_Sqrt:  [[ 9.68730241  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.39128990e-06  2.65456176e-03 -6.19714809e-02]
Stock Position:  -2.3912899035215175e-06
Bond Position:  [3.93048389]


portfolio before change:  [3.9307458]
curr_Stock_Price:  95.94488808669796
curr_Factors:  [95.94488809 -0.89410739 -1.02786866]
mat_Sqrt:  [[14.0384205   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00332864  0.09130382 -0.44837676]
Stock Position:  0.0033286352971552786
Bond Position:  [3.61138026]


portfolio before change:  [3.92886949]
curr_Stock_Price:  95.2455724303346
curr_Factors:  [95.24557243 -0.76906292 -1.02894144]
mat_Sqrt:  [[15.77543796  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109802 -0.08072869  0.0317438 ]
Stock Position:  -0.0010980205826618189
Bond Position:  [4.03345108]


portfolio before change:  [3.9286614]
curr_Stock_Price:  95.89428838430523
curr_Factors:  [95.89428838 -0.84726382 -1.01537549]
mat_Sqrt:  [[14.88876813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04852722 -0.61087021 -0.55433768]
Stock Position:  -0.04852722244716968
Bond Position:  [8.58214486]


portfolio before change:  [3.93882373]
curr_Stock_Price:  95.70698111591052
curr_Factors:  [95.70698112 -0.66959707 -1.01742474]
mat_Sqrt:  [[17.71247922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00145869 -0.02244604  0.11271703]
Stock Position:  0.0014586934989213286
Bond Position:  [3.79921658]


portfolio before change:  [3.93769408]
curr_Stock_Price:  94.60696507166897
curr_Factors:  [94.60696507 -0.55884197 -1.01718532]
mat_Sqrt:  [[19.56424796  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00665994  0.11260602  0.41142118]
Stock Position:  -0.006659936595842142
Bond Position:  [4.56777047]


portfolio before change:  [3.93890906]
curr_Stock_Price:  94.51027161843496
curr_Factors:  [94.51027162 -0.56297015 -0.99659238]
mat_Sqrt:  [[19.86870718  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00127393  0.0331873  -0.17721761]
Stock Position:  0.001273925078500985
Bond Position:  [3.81851005]


portfolio before change:  [3.94031824]
curr_Stock_Price:  95.24174210412805
curr_Factors:  [95.2417421  -0.88678948 -0.98356742]
mat_Sqrt:  [[14.67376799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00852638 -0.0169617   0.18848486]
Stock Position:  0.008526375497510019
Bond Position:  [3.12825138]


portfolio before change:  [3.94405489]
curr_Stock_Price:  95.63412351275755
curr_Factors:  [95.63412351 -1.10054034 -0.98375286]
mat_Sqrt:  [[11.8964079   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00592828 -0.03252655 -0.28287056]
Stock Position:  -0.005928276509215473
Bond Position:  [4.51100041]


portfolio before change:  [3.94978716]
curr_Stock_Price:  94.76230714730423
curr_Factors:  [94.76230715 -1.32653811 -1.02061561]
mat_Sqrt:  [[ 9.0631615   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02688155  0.03125636  0.05311679]
Stock Position:  -0.026881546888374703
Bond Position:  [6.49714457]


portfolio before change:  [3.97066239]
curr_Stock_Price:  94.01595740577189
curr_Factors:  [94.01595741 -1.29518024 -1.01645878]
mat_Sqrt:  [[ 9.31685855  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01002956 -0.00723279 -0.10700143]
Stock Position:  0.010029557043738166
Bond Position:  [3.02772399]


portfolio before change:  [3.96810861]
curr_Stock_Price:  93.7235946864797
curr_Factors:  [93.72359469 -1.24969925 -1.02067137]
mat_Sqrt:  [[ 9.6792009   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00167103 -0.01853937  0.49677127]
Stock Position:  -0.001671032358491213
Bond Position:  [4.12472377]


portfolio before change:  [3.96712952]
curr_Stock_Price:  94.61808119085866
curr_Factors:  [94.61808119 -1.33780174 -1.03431532]
mat_Sqrt:  [[ 8.82626149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01525733 -0.04368856  0.01076472]
Stock Position:  -0.015257328080094902
Bond Position:  [5.41074863]


portfolio before change:  [3.96140329]
curr_Stock_Price:  95.03772314176018
curr_Factors:  [95.03772314 -1.42862332 -1.04504499]
mat_Sqrt:  [[ 8.00931778  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00689683 -0.02510166  0.06724496]
Stock Position:  -0.006896833194581774
Bond Position:  [4.61686262]


portfolio before change:  [3.96501205]
curr_Stock_Price:  94.59815743644965
curr_Factors:  [94.59815744 -1.46944733 -1.03136325]
mat_Sqrt:  [[ 7.75879789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02815746 0.02671262 0.37635326]
Stock Position:  0.028157461860762584
Bond Position:  [1.30136804]


portfolio before change:  [3.97982054]
curr_Stock_Price:  95.11829696477331
curr_Factors:  [95.11829696 -1.38084034 -1.06319594]
mat_Sqrt:  [[ 8.25719598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0178434   0.03923588 -0.12948757]
Stock Position:  -0.01784339805696427
Bond Position:  [5.67705417]


portfolio before change:  [3.98150203]
curr_Stock_Price:  95.06383321311937
curr_Factors:  [95.06383321 -1.34839265 -1.06657868]
mat_Sqrt:  [[ 8.49584532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00922287 -0.00275504 -0.10205224]
Stock Position:  0.009222872757005741
Bond Position:  [3.10474039]


portfolio before change:  [3.98179828]
curr_Stock_Price:  95.05387217662289
curr_Factors:  [95.05387218 -1.52146894 -1.0578899 ]
mat_Sqrt:  [[ 7.20723198  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00716009 -0.00057151 -0.11530329]
Stock Position:  -0.00716008693701617
Bond Position:  [4.66239227]


portfolio before change:  [3.98085009]
curr_Stock_Price:  95.26769941602008
curr_Factors:  [95.26769942 -1.26728701 -1.07058961]
mat_Sqrt:  [[ 9.19641924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0005162  0.01244455 0.26879785]
Stock Position:  0.0005162031887406438
Bond Position:  [3.9316726]


portfolio before change:  [3.98143419]
curr_Stock_Price:  95.44709986805748
curr_Factors:  [95.44709987 -1.09352107 -1.07393306]
mat_Sqrt:  [[10.92570243  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054539 -0.01532066 -0.0366432 ]
Stock Position:  -0.0005453917008299785
Bond Position:  [4.03349025]


portfolio before change:  [3.98237567]
curr_Stock_Price:  94.64536433801089
curr_Factors:  [94.64536434 -1.01485483 -1.09097472]
mat_Sqrt:  [[11.52256573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00575884  0.01781936  0.14143755]
Stock Position:  -0.005758840537844452
Bond Position:  [4.52742323]


portfolio before change:  [3.98674548]
curr_Stock_Price:  93.98484139509499
curr_Factors:  [93.9848414  -0.66207213 -1.06702424]
mat_Sqrt:  [[16.67711039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00744523 -0.01822879 -0.18025155]
Stock Position:  -0.007445231044991531
Bond Position:  [4.68648434]


portfolio before change:  [3.98436752]
curr_Stock_Price:  94.38292175044232
curr_Factors:  [94.38292175 -0.38561105 -1.03437475]
mat_Sqrt:  [[22.81399923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0762773  0.31809941 0.39278066]
Stock Position:  0.07627729628226151
Bond Position:  [-3.21490656]


portfolio before change:  [4.05225918]
curr_Stock_Price:  95.2782542092546
curr_Factors:  [95.27825421 -0.34543085 -1.01792675]
mat_Sqrt:  [[24.37222108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113789 -0.0222863   0.16266724]
Stock Position:  0.0011378916619908725
Bond Position:  [3.94384284]


portfolio before change:  [4.05130705]
curr_Stock_Price:  94.00824482047977
curr_Factors:  [94.00824482 -0.50072629 -0.99919224]
mat_Sqrt:  [[20.97778381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107526 -0.00492884 -0.06049619]
Stock Position:  0.0010752579456563048
Bond Position:  [3.95022394]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.05220693]
Stock Price:  94.38589576613764
PL:  [4.05220693]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.17537819e-02 -9.59682433e-02  1.12743561e-02]
 [ 7.23901002e-01  1.90668414e-01  1.88978336e-01]
 [-3.24057542e-01 -2.11817882e-01  3.92489194e-02]
 [ 1.57337612e-01  1.13645735e+00  9.95143396e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 8.94683724e-04  1.31966294e-01 -4.16127361e-02]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [-4.73320421e-02  8.95334385e-02  1.46401871e-02]
 [ 3.21313753e-02  4.57619131e-02 -4.36469644e-02]
 [-1.06072530e-01 -5.32728054e-02 -1.96929702e-02]
 [ 8.92301666e-01  1.71878456e+00 -3.09621516e-01]
 [-5.49575238e-05  2.54325652e-02 -5.84554999e-02]
 [ 1.03210019e-01 -2.88216598e-02  5.03734667e-02]
 [ 1.55281565e+00 -3.00634208e+00  2.56686261e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.34269947e-01 -7.18641605e-02  1.47294856e-02]
 [-1.54239629e-01 -2.10067307e-01 -3.03882386e-02]
 [-2.63756031e-01 -1.72957859e+00 -2.02742767e-01]
 [ 1.30094623e-03  3.72499194e-02  5.83893053e-02]
 [ 2.17815392e-01 -3.39585660e-01  1.82273620e-01]
 [ 4.54164595e-02 -1.21349677e-02  7.97101969e-02]
 [ 1.37803168e-01 -5.32508933e-02 -1.35772578e-02]
 [ 2.01844888e-01  1.41687628e-01  1.57237640e-01]
 [-1.43593424e-01  6.85583961e-03  5.50326383e-02]
 [-1.04610922e-02 -1.66247088e-01  5.18244251e-02]
 [ 5.56487787e-02 -5.11385982e-03  2.51607613e-01]
 [-1.97341778e-01 -1.31169054e-01 -7.33738134e-02]
 [-1.48469440e-01  1.07410880e-01  2.22108058e-01]
 [ 3.79469293e-02  1.22870035e-02  1.58101167e-01]
 [-6.85123811e-02  9.41294536e-02  6.20958525e-03]
 [ 3.34551049e-02 -1.33702270e-02 -7.65202744e-02]
 [ 8.56874468e-03  1.01868941e-02 -5.81599239e-02]
 [-1.06242418e-01 -3.82031387e-02  2.78681985e-02]
 [ 2.73308837e-01  1.93642885e-02  4.98825429e-02]
 [ 7.11446103e-02  7.33456547e-02 -6.19252066e-02]
 [-9.35692159e-02 -2.38851004e-02 -1.12928131e-01]
 [ 1.95025750e+00  1.38416807e+00  1.78902578e-01]
 [-1.08420023e-01  1.99968508e-02 -9.37098730e-03]
 [ 3.72625740e-02 -1.28595292e-02 -1.57336439e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.85236434]
curr_Stock_Price:  99.78774665763174
curr_Factors:  [99.78774666 -1.06280521 -1.03781897]
mat_Sqrt:  [[12.21202615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045318 -0.03097362  0.0321626 ]
Stock Position:  -0.00045318323018448206
Bond Position:  [0.89758647]


portfolio before change:  [0.85267117]
curr_Stock_Price:  99.35828537614822
curr_Factors:  [99.35828538 -0.99622741 -1.05896792]
mat_Sqrt:  [[12.72459878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06298007 0.06153797 0.53910259]
Stock Position:  0.0629800659550715
Bond Position:  [-5.4049202]


portfolio before change:  [0.84943327]
curr_Stock_Price:  99.31760197751372
curr_Factors:  [99.31760198 -1.09262525 -1.06142691]
mat_Sqrt:  [[11.52214296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03118196 -0.06836393  0.11196624]
Stock Position:  -0.031181962870280258
Bond Position:  [3.94635105]


portfolio before change:  [0.82418648]
curr_Stock_Price:  100.14308285268491
curr_Factors:  [100.14308285  -0.92028147  -1.06297058]
mat_Sqrt:  [[13.78178713  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04298781 0.36679003 2.83886711]
Stock Position:  0.042987806061315685
Bond Position:  [-3.48074495]


portfolio before change:  [0.78016864]
curr_Stock_Price:  99.12924368901632
curr_Factors:  [99.12924369 -0.81026148 -1.04359554]
mat_Sqrt:  [[15.52679859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377708 -0.01106097 -0.05874131]
Stock Position:  -0.003777082608591127
Bond Position:  [1.15458798]


portfolio before change:  [0.77989734]
curr_Stock_Price:  99.23928433571325
curr_Factors:  [99.23928434 -0.9677013  -0.99438175]
mat_Sqrt:  [[13.94960091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138628  0.04259194 -0.11870955]
Stock Position:  0.0013862781210137343
Bond Position:  [0.64232409]


portfolio before change:  [0.78005709]
curr_Stock_Price:  99.2966025529974
curr_Factors:  [99.29660255 -0.6668531  -1.01002053]
mat_Sqrt:  [[18.56425062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357086 -0.00251018 -0.21167328]
Stock Position:  -0.0035708590818963213
Bond Position:  [1.13463127]


portfolio before change:  [0.78330596]
curr_Stock_Price:  98.42649542076715
curr_Factors:  [98.42649542 -0.58618633 -1.01852249]
mat_Sqrt:  [[19.77861316  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131797  0.02889679  0.04176438]
Stock Position:  -0.0013179735902667834
Bond Position:  [0.91302948]


portfolio before change:  [0.78195271]
curr_Stock_Price:  99.53985876875089
curr_Factors:  [99.53985877 -0.80903009 -1.04393303]
mat_Sqrt:  [[15.60505717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0020867   0.01476959 -0.12451264]
Stock Position:  0.002086700934737467
Bond Position:  [0.5742428]


portfolio before change:  [0.78417698]
curr_Stock_Price:  100.57138421170644
curr_Factors:  [100.57138421  -0.93761801  -1.06568519]
mat_Sqrt:  [[13.56597145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00891691 -0.01719372 -0.05617856]
Stock Position:  -0.008916914424327916
Bond Position:  [1.68096341]


portfolio before change:  [0.78201072]
curr_Stock_Price:  100.83788898214037
curr_Factors:  [100.83788898  -0.79440436  -1.07648517]
mat_Sqrt:  [[15.52768614  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07598981  0.55473533 -0.883264  ]
Stock Position:  0.0759898067413904
Bond Position:  [-6.88064098]


portfolio before change:  [0.93850041]
curr_Stock_Price:  102.90855917425012
curr_Factors:  [102.90855917  -0.57617822  -1.06900092]
mat_Sqrt:  [[19.85908689  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003422   0.00820833 -0.16675727]
Stock Position:  -0.0003421978000924616
Bond Position:  [0.97371549]


portfolio before change:  [0.93785871]
curr_Stock_Price:  105.13949041730635
curr_Factors:  [105.13949042  -0.90548852  -1.05131841]
mat_Sqrt:  [[14.85714684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00724293 -0.00930215  0.14370148]
Stock Position:  0.00724292925729867
Bond Position:  [0.17634082]


portfolio before change:  [0.9329089]
curr_Stock_Price:  104.45304740022587
curr_Factors:  [104.4530474   -1.07302984  -1.03607574]
mat_Sqrt:  [[12.67500668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11543247 -0.97029274  7.32254454]
Stock Position:  0.11543246581565887
Bond Position:  [-11.12436393]


portfolio before change:  [0.77927479]
curr_Stock_Price:  103.13415086343971
curr_Factors:  [103.13415086  -1.04956744  -1.03423273]
mat_Sqrt:  [[12.83570071  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168821 -0.03053791  0.10625201]
Stock Position:  -0.001688211136693705
Bond Position:  [0.95338701]


portfolio before change:  [0.77975838]
curr_Stock_Price:  102.9182910084682
curr_Factors:  [102.91829101  -1.00468026  -1.04009039]
mat_Sqrt:  [[13.31864233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0092057  -0.02319406  0.04201912]
Stock Position:  0.009205696575377191
Bond Position:  [-0.16767618]


portfolio before change:  [0.77839646]
curr_Stock_Price:  102.77262481286265
curr_Factors:  [102.77262481  -0.81012428  -1.03876048]
mat_Sqrt:  [[16.17770816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01256806 -0.06779893 -0.08668919]
Stock Position:  -0.01256806032206519
Bond Position:  [2.07004901]


portfolio before change:  [0.77573063]
curr_Stock_Price:  103.00532638132108
curr_Factors:  [103.00532638  -0.77865956  -1.04114524]
mat_Sqrt:  [[16.69277339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03942961 -0.55821909 -0.57836868]
Stock Position:  -0.0394296059437625
Bond Position:  [4.83719006]


portfolio before change:  [0.7748843]
curr_Stock_Price:  103.04212650020439
curr_Factors:  [103.0421265   -0.47372139  -1.0400954 ]
mat_Sqrt:  [[22.67631769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00091828 0.01202236 0.16656844]
Stock Position:  0.0009182805385566645
Bond Position:  [0.68026272]


portfolio before change:  [0.77462143]
curr_Stock_Price:  102.66325414925086
curr_Factors:  [102.66325415  -0.42019318  -1.025461  ]
mat_Sqrt:  [[24.18663164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00767797 -0.1096008   0.5199759 ]
Stock Position:  0.007677968921289268
Bond Position:  [-0.01362385]


portfolio before change:  [0.76339807]
curr_Stock_Price:  101.2017143836449
curr_Factors:  [101.20171438  -0.41126732  -1.02909244]
mat_Sqrt:  [[23.96887082  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024703  -0.00391654  0.227391  ]
Stock Position:  0.0024702955713602386
Bond Position:  [0.51339992]


portfolio before change:  [0.76442709]
curr_Stock_Price:  101.59229281407198
curr_Factors:  [101.59229281  -0.4991618   -1.05647291]
mat_Sqrt:  [[21.44160001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0057907  -0.01718665 -0.03873214]
Stock Position:  0.0057907025721814906
Bond Position:  [0.17613634]


portfolio before change:  [0.76493678]
curr_Stock_Price:  101.67650857323527
curr_Factors:  [101.67650857  -0.73319518  -1.04129546]
mat_Sqrt:  [[17.24126522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01524614 0.04572949 0.44855522]
Stock Position:  0.015246140539567654
Bond Position:  [-0.78523756]


portfolio before change:  [0.75406218]
curr_Stock_Price:  100.96967781425418
curr_Factors:  [100.96967781  -0.71690088  -1.03473601]
mat_Sqrt:  [[17.517202    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00747611  0.00221271  0.1569928 ]
Stock Position:  -0.007476107867159855
Bond Position:  [1.50892238]


portfolio before change:  [0.75383144]
curr_Stock_Price:  101.0257717617654
curr_Factors:  [101.02577176  -0.47397113  -1.0328773 ]
mat_Sqrt:  [[22.38804733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151052 -0.05365602  0.14784066]
Stock Position:  -0.0015105167548751866
Bond Position:  [0.90643256]


portfolio before change:  [0.75628931]
curr_Stock_Price:  99.47361166540382
curr_Factors:  [ 9.94736117e+01 -1.81013115e-02 -1.02137538e+00]
mat_Sqrt:  [[35.17781792  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00301224 -0.00165049  0.71776649]
Stock Position:  0.0030122421356877983
Bond Position:  [0.45665071]


portfolio before change:  [0.75152032]
curr_Stock_Price:  97.87145540956145
curr_Factors:  [97.87145541 -0.10953668 -1.00904803]
mat_Sqrt:  [[31.97870579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00747666 -0.04233463 -0.20931507]
Stock Position:  -0.007476660166451251
Bond Position:  [1.48327193]


portfolio before change:  [0.75103646]
curr_Stock_Price:  97.9609703059379
curr_Factors:  [97.96097031 -0.15059402 -1.01760079]
mat_Sqrt:  [[30.4587811   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266612  0.03466671  0.63361247]
Stock Position:  -0.002666116815271494
Bond Position:  [1.01221185]


portfolio before change:  [0.75308196]
curr_Stock_Price:  97.2412123559972
curr_Factors:  [97.24121236  0.11664728 -1.01076348]
mat_Sqrt:  [[39.76863002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00182876 0.00396561 0.45101862]
Stock Position:  0.0018287597249064358
Bond Position:  [0.57525114]


portfolio before change:  [0.75551932]
curr_Stock_Price:  98.53468438216322
curr_Factors:  [98.53468438  0.11732927 -1.00433667]
mat_Sqrt:  [[40.58510858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118346  0.03038015  0.01771422]
Stock Position:  -0.001183457731494727
Bond Position:  [0.87213095]


portfolio before change:  [0.75577938]
curr_Stock_Price:  98.40705943412985
curr_Factors:  [98.40705943  0.26894402 -1.01152469]
mat_Sqrt:  [[46.8303677   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00032257 -0.00431522 -0.21829104]
Stock Position:  0.0003225745151525673
Bond Position:  [0.72403577]


portfolio before change:  [0.75586578]
curr_Stock_Price:  98.39432246816015
curr_Factors:  [98.39432247  0.15513168 -1.02630447]
mat_Sqrt:  [[41.17413721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.97203320e-05  3.28780593e-03 -1.65914074e-01]
Stock Position:  -2.972033196652359e-05
Bond Position:  [0.75879009]


portfolio before change:  [0.75587715]
curr_Stock_Price:  101.20325409855984
curr_Factors:  [ 1.01203254e+02 -1.88321748e-02 -1.04101554e+00]
mat_Sqrt:  [[35.06779541  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308979 -0.01233001  0.07950021]
Stock Position:  -0.003089787299455873
Bond Position:  [1.06857368]


portfolio before change:  [0.7521978]
curr_Stock_Price:  102.43729671429924
curr_Factors:  [102.43729671  -0.16668291  -1.06417913]
mat_Sqrt:  [[29.91586185  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00960841 0.0062498  0.14230101]
Stock Position:  0.009608407350404866
Bond Position:  [-0.23206147]


portfolio before change:  [0.76318308]
curr_Stock_Price:  103.58361413215478
curr_Factors:  [103.58361413  -0.47581335  -1.04644964]
mat_Sqrt:  [[22.60375769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0032506   0.02367221 -0.17665538]
Stock Position:  0.0032506010927680507
Bond Position:  [0.42647407]


portfolio before change:  [0.76200088]
curr_Stock_Price:  103.20352817052918
curr_Factors:  [103.20352817  -0.42430571  -1.05033215]
mat_Sqrt:  [[23.6193236   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00514393 -0.00770888 -0.32215252]
Stock Position:  -0.005143927992225157
Bond Position:  [1.2928724]


portfolio before change:  [0.75456725]
curr_Stock_Price:  104.68007523595381
curr_Factors:  [104.68007524  -0.43969451  -1.09158986]
mat_Sqrt:  [[22.63787583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.1002443  0.44673832 0.51035926]
Stock Position:  0.10024429752619886
Bond Position:  [-9.73901336]


portfolio before change:  [0.86054255]
curr_Stock_Price:  105.74939048668028
curr_Factors:  [105.74939049  -0.32208187  -1.10121402]
mat_Sqrt:  [[25.47700198  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00417047  0.00645396 -0.02673282]
Stock Position:  -0.004170468257612813
Bond Position:  [1.30156703]


portfolio before change:  [0.86589514]
curr_Stock_Price:  104.50495555373061
curr_Factors:  [104.50495555  -0.32831871  -1.08556871]
mat_Sqrt:  [[25.4151912   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.92110375e-05 -4.15039520e-03 -4.48837066e-01]
Stock Position:  9.921103750317289e-05
Bond Position:  [0.85552709]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.86607189]
Stock Price:  105.20860394474983
PL:  [-4.34253205]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 2.89453948e-02 -7.11158204e-02 -2.72222023e-02]
 [ 1.19849027e+00  2.40012792e-01  3.49959642e-01]
 [-1.67705260e-01 -6.78988341e-02  3.46883462e-02]
 [ 1.03773571e-01  9.19680671e-01  6.81136600e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 6.75410417e-02 -6.86285252e-02  5.70023906e-02]
 [-3.21888650e-02 -1.19266517e-01  2.13006366e-03]
 [ 1.25917557e-01  6.06647254e-02 -1.04869940e-01]
 [-2.15366377e-03  8.28638663e-02 -4.92836997e-02]
 [-2.02013530e-01 -7.80293949e-02 -7.61506082e-02]
 [ 7.44575597e-01  1.43723495e+00 -2.58522292e-01]
 [-1.56929146e-04  3.31103440e-02 -5.85043714e-02]
 [-2.80018087e-01 -3.77088976e-03 -5.62083144e-01]
 [ 1.70116356e+00 -3.27363034e+00  2.74649545e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.35327837e-01 -4.57109386e-02 -4.33279489e-03]
 [-1.12605895e-01 -1.20236886e-01 -4.59489149e-02]
 [-2.69794681e-01 -1.76098784e+00 -2.01666461e-01]
 [-7.19865882e-03  3.86689524e-02  1.58275773e-01]
 [ 2.31533288e-01 -2.21532581e-01  3.11486479e-01]
 [ 5.50281176e-02 -1.15439918e-02  3.20241223e-02]
 [ 1.44063113e-01 -5.59312936e-02 -3.26920813e-02]
 [ 1.43276634e-01  2.03511018e-01  1.68559155e-01]
 [-1.70512224e-01  5.42493801e-02  8.23174987e-02]
 [-3.19300368e-02 -1.59926822e-01  5.90230790e-02]
 [ 6.44230579e-02 -1.37152159e-02  3.43219557e-02]
 [ 4.85579200e-01 -7.03708860e-02  2.59798250e-01]
 [ 8.54728537e-02 -2.07604568e-01 -9.68777376e-02]
 [-1.19488998e-02 -7.73080028e-02 -7.24237570e-03]
 [ 2.38612900e-01 -1.03541707e-01  3.51762522e-02]
 [-2.69086739e-02 -6.76953521e-02 -3.02782338e-02]
 [ 3.49326285e-02  1.53798459e-02 -5.66975354e-02]
 [-3.59555506e-02 -1.91303335e-02 -3.83279790e-02]
 [ 4.51804263e-01  7.68936749e-02  1.11513450e-01]
 [ 3.93303982e-02  5.04446820e-02 -3.92886127e-02]
 [ 1.86122526e-02  3.15708149e-02  6.95274674e-02]
 [ 2.01976389e+00  1.45175625e+00  1.86306980e-01]
 [-1.09596663e-01  9.44960517e-03 -1.10527292e-02]
 [ 3.83348509e-02 -1.24565347e-02 -1.84732354e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.78725551]
curr_Stock_Price:  99.9153234021354
curr_Factors:  [99.9153234  -1.10949577 -0.99034351]
mat_Sqrt:  [[12.23724017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00072502 -0.02295253 -0.07765737]
Stock Position:  0.0007250188673786468
Bond Position:  [1.71481501]


portfolio before change:  [1.78775976]
curr_Stock_Price:  100.31514859424267
curr_Factors:  [100.31514859  -1.16256845  -0.98293319]
mat_Sqrt:  [[11.7378079   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11236492 0.0774638  0.99833745]
Stock Position:  0.11236492404486582
Bond Position:  [-9.4841443]


portfolio before change:  [1.81649333]
curr_Stock_Price:  100.58141648152795
curr_Factors:  [100.58141648  -1.33280695  -0.96943202]
mat_Sqrt:  [[10.06162357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01734157 -0.02191425  0.0989562 ]
Stock Position:  -0.017341567317878327
Bond Position:  [3.56073274]


portfolio before change:  [1.80239722]
curr_Stock_Price:  101.41993565459681
curr_Factors:  [101.41993565  -1.45539768  -1.0082546 ]
mat_Sqrt:  [[ 8.63321868  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04987005 0.29682566 1.94309313]
Stock Position:  0.049870047772136716
Bond Position:  [-3.25541982]


portfolio before change:  [1.80785904]
curr_Stock_Price:  101.53761708087642
curr_Factors:  [101.53761708  -1.44842921  -1.0020406 ]
mat_Sqrt:  [[ 8.75792959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00669633 -0.01106097 -0.05874131]
Stock Position:  -0.006696331630175197
Bond Position:  [2.4877886]


portfolio before change:  [1.8082119]
curr_Stock_Price:  101.53136545459799
curr_Factors:  [101.53136545  -1.41049361  -1.01723235]
mat_Sqrt:  [[ 8.95884942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00727413 -0.02214976  0.16261195]
Stock Position:  0.007274133527825945
Bond Position:  [1.06965919]


portfolio before change:  [1.81277927]
curr_Stock_Price:  102.14087535689845
curr_Factors:  [102.14087536  -1.40367681  -1.02185116]
mat_Sqrt:  [[ 9.03246237  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00621085 -0.0384931   0.00607648]
Stock Position:  -0.006210847181552781
Bond Position:  [2.44716064]


portfolio before change:  [1.81493172]
curr_Stock_Price:  101.84356768037223
curr_Factors:  [101.84356768  -1.45754795  -1.01044793]
mat_Sqrt:  [[ 8.63170545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01354242  0.01957946 -0.29916475]
Stock Position:  0.013542422865855785
Bond Position:  [0.43572306]


portfolio before change:  [1.82598792]
curr_Stock_Price:  102.65595784018441
curr_Factors:  [102.65595784  -1.35305308  -1.02387362]
mat_Sqrt:  [[ 9.53011219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00049326  0.0267442  -0.14059268]
Stock Position:  0.0004932637647358342
Bond Position:  [1.77535145]


portfolio before change:  [1.82576334]
curr_Stock_Price:  101.75073425977112
curr_Factors:  [101.75073426  -1.02749807  -1.06238944]
mat_Sqrt:  [[12.58667274  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01855021 -0.02518388 -0.21723649]
Stock Position:  -0.018550207516387987
Bond Position:  [3.71326057]


portfolio before change:  [1.82960326]
curr_Stock_Price:  101.56875608631786
curr_Factors:  [101.56875609  -1.19561914  -1.04169437]
mat_Sqrt:  [[10.84194556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09086739  0.46386559 -0.73749214]
Stock Position:  0.09086739139510043
Bond Position:  [-7.39968466]


portfolio before change:  [1.76944679]
curr_Stock_Price:  100.91691122030998
curr_Factors:  [100.91691122  -1.19063512  -1.02911779]
mat_Sqrt:  [[10.96320426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048713  0.01068632 -0.16689669]
Stock Position:  -0.0004871261323436436
Bond Position:  [1.81860606]


portfolio before change:  [1.76967254]
curr_Stock_Price:  100.92017819996298
curr_Factors:  [100.9201782   -1.16538319  -1.04026673]
mat_Sqrt:  [[11.11927366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.55708988e-02 -1.21704944e-03 -1.60346676e+00]
Stock Position:  -0.03557089883747743
Bond Position:  [5.35949399]


portfolio before change:  [1.73446042]
curr_Stock_Price:  101.92892698877586
curr_Factors:  [101.92892699  -1.16774577  -1.04262753]
mat_Sqrt:  [[11.17749601  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.14256884 -1.05655965  7.83498704]
Stock Position:  0.1425688364388991
Bond Position:  [-12.7974281]


portfolio before change:  [1.73460796]
curr_Stock_Price:  101.9411829288526
curr_Factors:  [101.94118293  -1.04769003  -1.07702353]
mat_Sqrt:  [[12.17862596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017793  -0.03053791  0.10625201]
Stock Position:  -0.0017792953779393389
Bond Position:  [1.91599143]


portfolio before change:  [1.73503413]
curr_Stock_Price:  101.83627651131805
curr_Factors:  [101.83627651  -0.897383    -1.07327907]
mat_Sqrt:  [[14.19236752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00881549 -0.01475314 -0.01236026]
Stock Position:  0.008815492023647767
Bond Position:  [0.83729725]


portfolio before change:  [1.7329409]
curr_Stock_Price:  101.58695453286991
curr_Factors:  [101.58695453  -0.85471816  -1.09592156]
mat_Sqrt:  [[14.44394652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01014463 -0.03880629 -0.13107946]
Stock Position:  -0.010144625626820536
Bond Position:  [2.76350253]


portfolio before change:  [1.73100288]
curr_Stock_Price:  101.8120477944657
curr_Factors:  [101.81204779  -0.87518424  -1.09117183]
mat_Sqrt:  [[14.25022049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04704628 -0.56835638 -0.57529828]
Stock Position:  -0.047046276382003115
Bond Position:  [6.52088062]


portfolio before change:  [1.72164331]
curr_Stock_Price:  102.02831834272615
curr_Factors:  [102.02831834  -1.01863193  -1.09580588]
mat_Sqrt:  [[12.31493306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00267988 0.01248035 0.45151672]
Stock Position:  0.002679877726226262
Bond Position:  [1.4482199]


portfolio before change:  [1.7220066]
curr_Stock_Price:  102.0963250851183
curr_Factors:  [102.09632509  -0.98296526  -1.11201349]
mat_Sqrt:  [[12.56528656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01988773 -0.07149933  0.88858422]
Stock Position:  0.019887731911951364
Bond Position:  [-0.30845774]


portfolio before change:  [1.73045182]
curr_Stock_Price:  102.52290875086702
curr_Factors:  [102.52290875  -1.09865762  -1.08171708]
mat_Sqrt:  [[11.5850048   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0051108  -0.00372581  0.09135591]
Stock Position:  0.005110796910570197
Bond Position:  [1.20647806]


portfolio before change:  [1.73330656]
curr_Stock_Price:  103.05196946211375
curr_Factors:  [103.05196946  -1.22900934  -1.10225198]
mat_Sqrt:  [[10.01387973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01257983 -0.01805175 -0.09326141]
Stock Position:  0.012579833749382235
Bond Position:  [0.43692992]


portfolio before change:  [1.73182962]
curr_Stock_Price:  102.93022207255973
curr_Factors:  [102.93022207  -1.25673778  -1.09846509]
mat_Sqrt:  [[ 9.7654284   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02244911 0.0656829  0.48085235]
Stock Position:  0.022449106314499066
Bond Position:  [-0.57886188]


portfolio before change:  [1.73061272]
curr_Stock_Price:  102.87923836796426
curr_Factors:  [102.87923837  -1.15617641  -1.11763574]
mat_Sqrt:  [[10.58823741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01347114  0.01750891  0.23482891]
Stock Position:  -0.01347113984577083
Bond Position:  [3.11651333]


portfolio before change:  [1.7375159]
curr_Stock_Price:  102.39571649722856
curr_Factors:  [102.3957165   -1.08462203  -1.10227844]
mat_Sqrt:  [[11.49537069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045694  -0.05161616  0.16837642]
Stock Position:  -0.0045693982770817565
Bond Position:  [2.20540271]


portfolio before change:  [1.73649851]
curr_Stock_Price:  102.67870461571908
curr_Factors:  [102.67870462  -1.12376518  -1.10703522]
mat_Sqrt:  [[11.03204633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00622091 -0.00442657  0.09791099]
Stock Position:  0.006220912146128666
Bond Position:  [1.09774331]


portfolio before change:  [1.74112978]
curr_Stock_Price:  103.40111463884179
curr_Factors:  [103.40111464  -1.10616218  -1.10370521]
mat_Sqrt:  [[11.34467357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04621075 -0.02271211  0.74113209]
Stock Position:  0.046210752125135354
Bond Position:  [-3.03711349]


portfolio before change:  [1.71339415]
curr_Stock_Price:  102.80913191976103
curr_Factors:  [102.80913192  -1.26786486  -1.12943324]
mat_Sqrt:  [[ 9.35186779  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00249369 -0.06700409 -0.27636522]
Stock Position:  0.0024936904516058736
Bond Position:  [1.45702]


portfolio before change:  [1.71450843]
curr_Stock_Price:  103.18293168209841
curr_Factors:  [103.18293168  -1.35449422  -1.13869774]
mat_Sqrt:  [[ 8.52763004  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00342506 -0.02495105 -0.02066048]
Stock Position:  -0.003425063403339273
Bond Position:  [2.06791652]


portfolio before change:  [1.71277079]
curr_Stock_Price:  103.76573696498424
curr_Factors:  [103.76573696  -1.29184825  -1.14890729]
mat_Sqrt:  [[ 9.03747919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02485846 -0.03341794  0.10034806]
Stock Position:  0.024858464933892214
Bond Position:  [-0.86668614]


portfolio before change:  [1.73237907]
curr_Stock_Price:  104.55889199853844
curr_Factors:  [104.558892    -1.22453579  -1.1453398 ]
mat_Sqrt:  [[ 9.77545727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00479849 -0.02184858 -0.08637537]
Stock Position:  -0.004798491469540322
Bond Position:  [2.23410402]


portfolio before change:  [1.73333397]
curr_Stock_Price:  104.41809429632849
curr_Factors:  [104.4180943   -0.99861561  -1.13005992]
mat_Sqrt:  [[12.42520974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213266  0.00496382 -0.16174229]
Stock Position:  0.0021326553878774643
Bond Position:  [1.51064615]


portfolio before change:  [1.73362821]
curr_Stock_Price:  104.46751689103027
curr_Factors:  [104.46751689  -1.09368077  -1.09050765]
mat_Sqrt:  [[11.75980973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00405484 -0.00617429 -0.10933906]
Stock Position:  -0.00405484277153161
Bond Position:  [2.15722757]


portfolio before change:  [1.73498369]
curr_Stock_Price:  104.19973482537533
curr_Factors:  [104.19973483  -1.21648015  -1.09686754]
mat_Sqrt:  [[10.30842882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0475594  0.02481733 0.31811683]
Stock Position:  0.04755940159612588
Bond Position:  [-3.22069334]


portfolio before change:  [1.77348989]
curr_Stock_Price:  105.01784453453938
curr_Factors:  [105.01784453  -1.13728008  -1.0918759 ]
mat_Sqrt:  [[11.301939    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00368146  0.01628095 -0.11207948]
Stock Position:  0.0036814586724194286
Bond Position:  [1.38687104]


portfolio before change:  [1.77583596]
curr_Stock_Price:  105.60801868029758
curr_Factors:  [105.60801868  -1.24629981  -1.11792034]
mat_Sqrt:  [[ 9.92953998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00395274 0.01018944 0.19834251]
Stock Position:  0.003952736299262782
Bond Position:  [1.35839531]


portfolio before change:  [1.77704386]
curr_Stock_Price:  105.8706442059271
curr_Factors:  [105.87064421  -1.15567299  -1.10516019]
mat_Sqrt:  [[11.03845212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.21326651 0.46855232 0.53148196]
Stock Position:  0.21326650865072685
Bond Position:  [-20.8016188]


portfolio before change:  [1.77474864]
curr_Stock_Price:  105.87207503402149
curr_Factors:  [105.87207503  -1.17002299  -1.1067011 ]
mat_Sqrt:  [[10.86457442  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01011764  0.00304985 -0.03153036]
Stock Position:  -0.01011764431326325
Bond Position:  [2.84592464]


portfolio before change:  [1.76662925]
curr_Stock_Price:  106.70973563479659
curr_Factors:  [106.70973563  -1.27208768  -1.09615905]
mat_Sqrt:  [[ 9.99280838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.91754134e-04 -4.02032927e-03 -5.26989985e-01]
Stock Position:  -0.00019175413400661384
Bond Position:  [1.78709129]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.76678538]
Stock Price:  107.06057376298361
PL:  [-5.29378838]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 3.67848895e-02 -4.90401525e-02 -4.75051530e-02]
 [ 1.15322035e+00  2.29886192e-01  3.28750629e-01]
 [-1.52899548e-01 -5.42704819e-02  3.42564847e-02]
 [ 7.53511453e-02  6.43902763e-01  4.92073987e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 5.00005990e-02  1.18665741e-02  1.10387445e-04]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [-2.50798779e-02  2.34493787e-01 -3.77725777e-02]
 [ 4.55444586e-02  3.12467892e-02 -4.14417459e-02]
 [-2.36830651e-01 -1.82220518e-02 -7.71642997e-02]
 [ 4.00868790e-01  8.25547897e-01 -1.28702995e-01]
 [ 4.51911325e-04  3.68812787e-02 -7.78953024e-02]
 [ 6.23611865e-02 -1.43936675e-02  4.28670857e-02]
 [ 1.33677051e+00 -2.59965304e+00  2.26264185e+00]
 [ 4.76047316e-02 -1.03741390e-01  6.13515510e-02]
 [ 1.76243358e-01 -1.53391610e-01  4.80706756e-02]
 [-2.79755303e-01 -4.82132086e-01  1.49634435e-02]
 [-2.45895268e-01 -1.62512668e+00 -2.01753456e-01]
 [-5.49346933e-03  3.77716369e-02  1.38746281e-01]
 [ 4.69671149e-01 -7.06329360e-01  3.45969750e-01]
 [ 1.08598879e-01  1.06823097e-01 -4.34320395e-01]
 [-4.92988543e-01 -4.76466710e-02 -2.74545775e-01]
 [ 4.66633760e-01  4.45878959e-01  4.04638938e-01]
 [ 3.08599585e-01  7.35183516e-02  2.12613224e-01]
 [-1.29317882e-01 -4.16235948e-01  1.45799799e-01]
 [ 2.28594442e-01 -8.98513850e-02 -2.77664578e-01]
 [ 8.67138436e-01  1.86309325e-02  5.65661614e-01]
 [-5.97284780e-02  6.00483827e-02  1.06630940e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 3.11395559e-01 -1.00238232e-01 -4.94026937e-02]
 [-2.10058323e-02 -8.56762127e-02 -2.04602018e-02]
 [ 2.80834148e-02 -1.63002338e-02 -1.03658175e-02]
 [-3.45787902e-02 -6.16058287e-02  1.23479031e-02]
 [ 4.38936234e-01  5.48240353e-02  9.78031075e-02]
 [-1.54873424e-02  1.43691710e-01 -6.56964301e-02]
 [-4.48418654e-02  3.81754753e-03 -3.62783022e-02]
 [ 2.87778124e+00  1.95672305e+00  2.13490599e-01]
 [-1.24456605e-01  2.04148057e-02 -4.01750394e-03]
 [ 3.88577012e-02 -1.18875017e-02 -2.02546362e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.91519557]
curr_Stock_Price:  99.79632070828306
curr_Factors:  [99.79632071 -1.18634218 -0.9896172 ]
mat_Sqrt:  [[11.32680376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150772 -0.01582764 -0.13551898]
Stock Position:  0.0015077211503328975
Bond Position:  [0.76473055]


portfolio before change:  [0.91605478]
curr_Stock_Price:  100.30278617292039
curr_Factors:  [100.30278617  -1.09806138  -1.02935912]
mat_Sqrt:  [[11.95049824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10604174 0.07419545 0.93783404]
Stock Position:  0.10604173879905142
Bond Position:  [-9.72022707]


portfolio before change:  [0.97687148]
curr_Stock_Price:  100.88776156904149
curr_Factors:  [100.88776157  -0.90308587  -1.0229025 ]
mat_Sqrt:  [[14.70253978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0106774  -0.01751572  0.09772422]
Stock Position:  -0.010677399315252753
Bond Position:  [2.0540904]


portfolio before change:  [0.96561273]
curr_Stock_Price:  101.96625687399418
curr_Factors:  [101.96625687  -0.90126889  -1.01617154]
mat_Sqrt:  [[14.98727507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02049949 0.20781872 1.40375012]
Stock Position:  0.020499485512524264
Bond Position:  [-1.12464307]


portfolio before change:  [0.98278787]
curr_Stock_Price:  102.81094766113124
curr_Factors:  [102.81094766  -0.80065829  -1.00824975]
mat_Sqrt:  [[16.84381952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00348175 -0.01106097 -0.05874131]
Stock Position:  -0.0034817519193934914
Bond Position:  [1.34075009]


portfolio before change:  [0.98812651]
curr_Stock_Price:  101.32576739627129
curr_Factors:  [101.3257674   -0.65085649  -1.00759095]
mat_Sqrt:  [[19.29591286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00271795 0.00382992 0.0003149 ]
Stock Position:  0.002717953093361949
Bond Position:  [0.71272782]


portfolio before change:  [0.98722795]
curr_Stock_Price:  100.96238804844701
curr_Factors:  [100.96238805  -0.57922125  -1.02234388]
mat_Sqrt:  [[20.35207598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325718 -0.00251018 -0.21167328]
Stock Position:  -0.003257177449786029
Bond Position:  [1.31608037]


portfolio before change:  [0.98882954]
curr_Stock_Price:  100.52118909188341
curr_Factors:  [100.52118909  -0.50696753  -1.00874849]
mat_Sqrt:  [[22.0795651   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068279  0.07568254 -0.10775465]
Stock Position:  0.0006827883950691652
Bond Position:  [0.92019484]


portfolio before change:  [0.99008445]
curr_Stock_Price:  102.19064616389842
curr_Factors:  [102.19064616  -0.2330247   -1.0211505 ]
mat_Sqrt:  [[29.15612336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149071  0.01008486 -0.11822177]
Stock Position:  0.0014907133325510061
Bond Position:  [0.8377475]


portfolio before change:  [0.99126781]
curr_Stock_Price:  102.91421351950831
curr_Factors:  [102.91421352  -0.321427    -1.03462469]
mat_Sqrt:  [[26.51853883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00966499 -0.00588114 -0.22012827]
Stock Position:  -0.009664986065642825
Bond Position:  [1.98593225]


portfolio before change:  [0.96281629]
curr_Stock_Price:  105.88367187687187
curr_Factors:  [105.88367188  -0.46654771  -1.05499571]
mat_Sqrt:  [[23.12230253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02348865  0.26644444 -0.36715382]
Stock Position:  0.023488649515564262
Bond Position:  [-1.52424816]


portfolio before change:  [1.01365956]
curr_Stock_Price:  108.0563726816919
curr_Factors:  [108.05637268  -0.3667491   -1.04144627]
mat_Sqrt:  [[26.42888907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00029967  0.01190338 -0.22221362]
Stock Position:  -0.0002996736323555041
Bond Position:  [1.04604121]


portfolio before change:  [1.01428892]
curr_Stock_Price:  106.39257757481145
curr_Factors:  [106.39257757  -0.47439675  -1.03491979]
mat_Sqrt:  [[23.51925105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00289862 -0.00464554  0.12228786]
Stock Position:  0.002898616902477777
Bond Position:  [0.70589759]


portfolio before change:  [1.0170175]
curr_Stock_Price:  107.30347384188535
curr_Factors:  [107.30347384  -0.70394268  -1.03664355]
mat_Sqrt:  [[18.82291108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06736356 -0.83903441  6.45468739]
Stock Position:  0.06736356478379384
Bond Position:  [-6.21132701]


portfolio before change:  [1.01406795]
curr_Stock_Price:  107.27121479867148
curr_Factors:  [107.2712148   -0.64176295  -1.03869085]
mat_Sqrt:  [[19.98349223  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194921 -0.03348239  0.1750189 ]
Stock Position:  0.0019492059440421102
Bond Position:  [0.80497426]


portfolio before change:  [1.01533505]
curr_Stock_Price:  107.86964949160364
curr_Factors:  [107.86964949  -0.61949902  -1.0377469 ]
mat_Sqrt:  [[20.56678989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00752401 -0.04950693  0.13713226]
Stock Position:  0.007524013869816502
Bond Position:  [0.20372231]


portfolio before change:  [1.00357768]
curr_Stock_Price:  106.30361826694129
curr_Factors:  [106.30361827  -0.7927602   -1.02276409]
mat_Sqrt:  [[17.30118578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0216815  -0.15560746  0.04268654]
Stock Position:  -0.02168150248188089
Bond Position:  [3.30839984]


portfolio before change:  [0.99114747]
curr_Stock_Price:  106.89600268910691
curr_Factors:  [106.89600269  -0.82370701  -0.98668789]
mat_Sqrt:  [[17.48706595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03538647 -0.52450738 -0.57554645]
Stock Position:  -0.035386474578886454
Bond Position:  [4.77382015]


portfolio before change:  [0.93008181]
curr_Stock_Price:  108.63854497460053
curr_Factors:  [108.63854497  -1.05544616  -0.9735864 ]
mat_Sqrt:  [[14.28191018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00213824 0.01219074 0.39580452]
Stock Position:  0.0021382363738109466
Bond Position:  [0.69778692]


portfolio before change:  [0.92941262]
curr_Stock_Price:  108.284788435529
curr_Factors:  [108.28478844  -1.13297015  -0.94393711]
mat_Sqrt:  [[13.56994518  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02919047 -0.22796682  0.9869554 ]
Stock Position:  0.02919046807116606
Bond Position:  [-2.23147104]


portfolio before change:  [0.95380959]
curr_Stock_Price:  109.13013024078843
curr_Factors:  [109.13013024  -0.91566376  -0.92394675]
mat_Sqrt:  [[17.33851834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00240786  0.03447701 -1.2389952 ]
Stock Position:  0.0024078627785503615
Bond Position:  [0.69103921]


portfolio before change:  [0.95305665]
curr_Stock_Price:  108.78155406443892
curr_Factors:  [108.78155406  -0.93942139  -0.9119955 ]
mat_Sqrt:  [[17.08028534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03271349 -0.0153779  -0.78320268]
Stock Position:  -0.032713493336106444
Bond Position:  [4.5116813]


portfolio before change:  [0.98522171]
curr_Stock_Price:  107.81555927969993
curr_Factors:  [107.81555928  -0.91174857  -0.90084424]
mat_Sqrt:  [[17.59877276  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03638009 0.14390682 1.15432226]
Stock Position:  0.03638009349303368
Bond Position:  [-2.93711841]


portfolio before change:  [1.043679]
curr_Stock_Price:  109.43249992247785
curr_Factors:  [109.43249992  -1.1581696   -0.92496136]
mat_Sqrt:  [[13.62868773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02692893 0.02372795 0.60652635]
Stock Position:  0.026928927805801244
Bond Position:  [-1.90322089]


portfolio before change:  [1.05461549]
curr_Stock_Price:  109.84745904000656
curr_Factors:  [109.84745904  -1.14412135  -0.92773404]
mat_Sqrt:  [[13.83549344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01333674 -0.13433957  0.41592624]
Stock Position:  -0.013336743704485732
Bond Position:  [2.5196229]


portfolio before change:  [1.0556546]
curr_Stock_Price:  109.79316263219606
curr_Factors:  [109.79316263  -1.11179281  -0.9173673 ]
mat_Sqrt:  [[14.43185828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01064143 -0.02899941 -0.79209975]
Stock Position:  0.010641426562675365
Bond Position:  [-0.11270128]


portfolio before change:  [1.05055301]
curr_Stock_Price:  109.31507866379232
curr_Factors:  [109.31507866  -1.36183095  -0.91686864]
mat_Sqrt:  [[11.19575572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08810541 0.00601311 1.61367514]
Stock Position:  0.08810541044057714
Bond Position:  [-8.58069686]


portfolio before change:  [1.01360022]
curr_Stock_Price:  108.90783756976485
curr_Factors:  [108.90783757  -0.70914714  -0.90682822]
mat_Sqrt:  [[21.63963603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118788  0.01938053  0.30418839]
Stock Position:  -0.0011878759769666876
Bond Position:  [1.14296922]


portfolio before change:  [1.01613743]
curr_Stock_Price:  106.89219829098738
curr_Factors:  [106.89219829  -0.86675828  -0.90331578]
mat_Sqrt:  [[18.20591934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188837 -0.02600141 -0.03673698]
Stock Position:  -0.0018883671338458673
Bond Position:  [1.21798914]


portfolio before change:  [1.01708627]
curr_Stock_Price:  106.4703626562028
curr_Factors:  [106.47036266  -0.61153251  -0.89276872]
mat_Sqrt:  [[23.6547852   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01187287 -0.03235175 -0.14093213]
Stock Position:  0.011872871813700586
Bond Position:  [-0.2470227]


portfolio before change:  [1.01117995]
curr_Stock_Price:  105.97550062849496
curr_Factors:  [105.97550063  -0.91942688  -0.86902338]
mat_Sqrt:  [[17.72112952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240791 -0.02765188 -0.05836726]
Stock Position:  -0.002407907301467784
Bond Position:  [1.26635913]


portfolio before change:  [1.01277437]
curr_Stock_Price:  105.37908324493185
curr_Factors:  [105.37908324  -0.69335427  -0.84301111]
mat_Sqrt:  [[22.67354396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099853 -0.00526088 -0.02957079]
Stock Position:  0.0009985307061047303
Bond Position:  [0.90755012]


portfolio before change:  [1.01198043]
curr_Stock_Price:  104.47035437738145
curr_Factors:  [104.47035438  -0.90444204  -0.82799626]
mat_Sqrt:  [[18.47586056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241578 -0.0198832   0.03522513]
Stock Position:  -0.002415775008474102
Bond Position:  [1.2643573]


portfolio before change:  [1.01127452]
curr_Stock_Price:  104.82799010160474
curr_Factors:  [104.8279901   -0.79359148  -0.83234809]
mat_Sqrt:  [[20.62246984  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02279509 0.01769438 0.27900504]
Stock Position:  0.02279509306288868
Bond Position:  [-1.37828927]


portfolio before change:  [0.99663259]
curr_Stock_Price:  104.19322064669008
curr_Factors:  [104.19322065  -0.78140688  -0.86705402]
mat_Sqrt:  [[20.04112007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.16244167e-05  4.63763001e-02 -1.87413629e-01]
Stock Position:  2.1624416664795567e-05
Bond Position:  [0.99437948]


portfolio before change:  [0.99676312]
curr_Stock_Price:  104.48089280340994
curr_Factors:  [104.4808928   -0.55697399  -0.85683703]
mat_Sqrt:  [[25.41128042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0020254   0.00123211 -0.1034919 ]
Stock Position:  -0.002025395349499476
Bond Position:  [1.20837823]


portfolio before change:  [0.99594968]
curr_Stock_Price:  104.95709166685975
curr_Factors:  [104.95709167  -0.62409686  -0.83851841]
mat_Sqrt:  [[24.31118044  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.13659453 0.63152965 0.60902926]
Stock Position:  0.13659452923771978
Bond Position:  [-13.34061484]


portfolio before change:  [1.16107695]
curr_Stock_Price:  106.17818699716332
curr_Factors:  [106.178187    -0.84061779  -0.84304108]
mat_Sqrt:  [[19.71657828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00614252  0.00658885 -0.01146082]
Stock Position:  -0.006142522213866038
Bond Position:  [1.81327882]


portfolio before change:  [1.14882629]
curr_Stock_Price:  108.20949080929762
curr_Factors:  [108.20949081  -0.79190907  -0.83691764]
mat_Sqrt:  [[21.22632951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.31477980e-04 -3.83667467e-03 -5.77808392e-01]
Stock Position:  -0.00023147797972437333
Bond Position:  [1.1738744]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.14917444]
Stock Price:  107.33939652265128
PL:  [-6.19022208]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 9.76408185e-02 -5.29562391e-02 -8.79707867e-02]
 [ 1.52067419e+00  3.21969327e-01  4.90530566e-01]
 [ 1.29690584e-01  2.39773832e-01  4.29973334e-02]
 [ 3.07508469e-02  2.11404405e-01  1.94921187e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-7.65976866e-02  8.68056612e-02 -1.12075210e-01]
 [-3.21888650e-02 -1.19266517e-01  2.13006366e-03]
 [ 2.25157793e-01 -9.85884951e-03 -2.20833588e-01]
 [-3.03978685e-03  8.38227946e-02 -4.94293855e-02]
 [-5.38960753e-01  1.54014624e-01 -1.84125361e-01]
 [ 3.41701364e-01  6.90079529e-01 -1.13956201e-01]
 [-5.18979165e-05  1.72245904e-02 -5.81095465e-02]
 [ 1.29803792e-01 -3.82147005e-02  5.52603381e-02]
 [ 1.53743482e+00 -2.97587536e+00  2.54629525e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.43578127e-01 -1.02614142e-01  3.05744239e-02]
 [-2.14262405e-01 -3.37959647e-01 -5.93548670e-03]
 [-2.59196971e-01 -1.69954917e+00 -2.01273804e-01]
 [-4.69228898e-03  3.73500347e-02  1.29570383e-01]
 [ 3.15851523e-01 -4.66189730e-01  2.87100507e-01]
 [ 6.20862704e-02  5.52268194e-02 -3.75482151e-02]
 [ 9.43344710e-02 -5.50878894e-02 -5.53489404e-02]
 [ 3.13896466e-01  1.99913673e-01  2.26804532e-01]
 [-1.45742774e-01  4.33375183e-02  9.86354551e-02]
 [-1.17699889e-01 -3.71959033e-01  1.29976109e-01]
 [ 1.93434082e-01 -6.07072420e-02 -2.16503743e-01]
 [ 5.25895505e-01  2.14550018e-02  3.63675488e-01]
 [-5.90775310e-02  6.05710145e-02  1.05925655e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 3.27553085e-01 -8.99276029e-02 -8.03987352e-02]
 [-2.21433882e-02 -9.61046962e-02 -1.24529851e-02]
 [ 6.23441082e-02  1.37386149e-02 -5.90608044e-02]
 [-1.18069121e-01 -3.87448071e-02  2.12500833e-02]
 [ 2.74271285e-01  1.86887873e-02  4.79616099e-02]
 [ 3.22360481e-02  4.11048171e-02 -3.64313728e-02]
 [-3.17457267e-02  7.42631439e-03 -1.71678610e-02]
 [ 2.21472389e+00  1.52521012e+00  1.84434004e-01]
 [-4.38977446e-02  2.91797021e-02 -1.24507319e-02]
 [ 3.49397273e-02 -1.34706899e-02 -1.02422027e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.00755753]
curr_Stock_Price:  100.62769416572108
curr_Factors:  [100.62769417  -1.10553757  -1.02630064]
mat_Sqrt:  [[11.93636111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00577012 -0.01709155 -0.25095617]
Stock Position:  0.005770117813248943
Bond Position:  [6.42692388]


portfolio before change:  [7.01236541]
curr_Stock_Price:  101.32169379998233
curr_Factors:  [101.3216938   -0.98479219  -1.03076741]
mat_Sqrt:  [[13.50069204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.12492138 0.10391515 1.39934717]
Stock Position:  0.12492137698574701
Bond Position:  [-5.6448801]


portfolio before change:  [7.0753814]
curr_Stock_Price:  101.83178786089177
curr_Factors:  [101.83178786  -0.93574989  -1.0250445 ]
mat_Sqrt:  [[14.3324748   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01307597 0.07738667 0.12265942]
Stock Position:  0.013075969727286026
Bond Position:  [5.74383203]


portfolio before change:  [7.09137897]
curr_Stock_Price:  103.00030828527656
curr_Factors:  [103.00030829  -0.96641306  -1.00865342]
mat_Sqrt:  [[14.29150785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00795519 0.06823048 0.55605589]
Stock Position:  0.007955193544089873
Bond Position:  [6.27199158]


portfolio before change:  [7.09917026]
curr_Stock_Price:  103.8811473038388
curr_Factors:  [103.8811473   -1.08020677  -1.01121045]
mat_Sqrt:  [[12.83056497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045708  -0.01106097 -0.05874131]
Stock Position:  -0.004570804251862088
Bond Position:  [7.57399065]


portfolio before change:  [7.10084603]
curr_Stock_Price:  103.72166554393395
curr_Factors:  [103.72166554  -0.95497885  -1.01026542]
mat_Sqrt:  [[14.53365152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00562528  0.02801641 -0.31971938]
Stock Position:  -0.005625276719691519
Bond Position:  [7.6843091]


portfolio before change:  [7.10360116]
curr_Stock_Price:  103.40265315894027
curr_Factors:  [103.40265316  -1.12283734  -0.98518789]
mat_Sqrt:  [[12.56110822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00446611 -0.0384931   0.00607648]
Stock Position:  -0.004466106210259457
Bond Position:  [7.56540839]


portfolio before change:  [7.10318963]
curr_Stock_Price:  103.70655607409113
curr_Factors:  [103.70655607  -1.27008764  -0.96927327]
mat_Sqrt:  [[11.04750294  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01611838 -0.00318193 -0.62997676]
Stock Position:  0.016118384182774767
Bond Position:  [5.43160752]


portfolio before change:  [7.1107865]
curr_Stock_Price:  104.13574795224622
curr_Factors:  [104.13574795  -1.45511691  -0.98494293]
mat_Sqrt:  [[ 9.07601738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004386   0.02705369 -0.14100828]
Stock Position:  0.000438599688690008
Bond Position:  [7.0651126]


portfolio before change:  [7.11199613]
curr_Stock_Price:  104.88001915128878
curr_Factors:  [104.88001915  -1.35593619  -0.98971176]
mat_Sqrt:  [[10.04594501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0542614   0.04970801 -0.5252584 ]
Stock Position:  -0.054261404099619846
Bond Position:  [12.80293324]


portfolio before change:  [7.1171991]
curr_Stock_Price:  104.81362759903838
curr_Factors:  [104.8136276   -1.4653966   -0.97816123]
mat_Sqrt:  [[ 9.10319972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05045501  0.22272221 -0.32508532]
Stock Position:  0.050455011433620474
Bond Position:  [1.82882632]


portfolio before change:  [7.14923169]
curr_Stock_Price:  105.44397067659597
curr_Factors:  [105.44397068  -1.43597969  -0.97282606]
mat_Sqrt:  [[ 9.48179816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088564  0.00555921 -0.16577036]
Stock Position:  -0.0008856447367571872
Bond Position:  [7.24261758]


portfolio before change:  [7.15018956]
curr_Stock_Price:  105.38469994207277
curr_Factors:  [105.38469994  -1.22675646  -0.97735117]
mat_Sqrt:  [[11.62909131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01146119 -0.01233374  0.15764236]
Stock Position:  0.011461189417878838
Bond Position:  [5.94235555]


portfolio before change:  [7.14697259]
curr_Stock_Price:  105.03920199704808
curr_Factors:  [105.039202    -1.14241174  -0.97106639]
mat_Sqrt:  [[12.69052317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11423856 -0.96045964  7.2638716 ]
Stock Position:  0.11423856425661927
Bond Position:  [-4.85255504]


portfolio before change:  [7.02210129]
curr_Stock_Price:  103.95143720687562
curr_Factors:  [103.95143721  -0.95625612  -0.97286981]
mat_Sqrt:  [[15.10155783  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143491 -0.03053791  0.10625201]
Stock Position:  -0.0014349097703084555
Bond Position:  [7.17126222]


portfolio before change:  [7.02194709]
curr_Stock_Price:  104.68365144397765
curr_Factors:  [104.68365144  -0.99445     -1.00263324]
mat_Sqrt:  [[14.20877476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00906996 -0.03311857  0.08722032]
Stock Position:  0.009069964419877858
Bond Position:  [6.0724701]


portfolio before change:  [7.0219377]
curr_Stock_Price:  104.59892184981096
curr_Factors:  [104.59892185  -1.1823256   -0.9810611 ]
mat_Sqrt:  [[12.02209905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0236614  -0.10907601 -0.01693229]
Stock Position:  -0.02366140085271167
Bond Position:  [9.49689472]


portfolio before change:  [7.05170573]
curr_Stock_Price:  103.39101188976929
curr_Factors:  [103.39101189  -1.09026036  -0.98559345]
mat_Sqrt:  [[12.97032711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04989857 -0.54852714 -0.57417814]
Stock Position:  -0.049898574683894525
Bond Position:  [12.21076986]


portfolio before change:  [7.02873706]
curr_Stock_Price:  103.88190998431341
curr_Factors:  [103.88190998  -1.06231721  -0.99074849]
mat_Sqrt:  [[13.33229219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00220369 0.01205467 0.36962824]
Stock Position:  0.0022036869782558416
Bond Position:  [6.79981385]


portfolio before change:  [7.02979452]
curr_Stock_Price:  103.97603843532059
curr_Factors:  [103.97603844  -1.14580209  -0.98042794]
mat_Sqrt:  [[12.40290149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02251853 -0.15046209  0.81901783]
Stock Position:  0.02251852832992216
Bond Position:  [4.68840715]


portfolio before change:  [7.02519649]
curr_Stock_Price:  103.74582309465002
curr_Factors:  [103.74582309  -0.94889591  -1.01336947]
mat_Sqrt:  [[14.58040509  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0045057   0.01782438 -0.10711461]
Stock Position:  0.0045056978859373325
Bond Position:  [6.55774916]


portfolio before change:  [7.02430132]
curr_Stock_Price:  103.36520572329893
curr_Factors:  [103.36520572  -0.88015741  -1.01230136]
mat_Sqrt:  [[15.57722069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00460876 -0.01777954 -0.15789512]
Stock Position:  0.004608758451082491
Bond Position:  [6.54791605]


portfolio before change:  [7.02284143]
curr_Stock_Price:  102.87083714964999
curr_Factors:  [102.87083715  -0.53036863  -1.00451164]
mat_Sqrt:  [[22.16676115  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01809015 0.06452186 0.6470102 ]
Stock Position:  0.018090146406910996
Bond Position:  [5.16189293]


portfolio before change:  [7.07025915]
curr_Stock_Price:  105.45635748686867
curr_Factors:  [105.45635749  -0.74426979  -1.03428041]
mat_Sqrt:  [[17.80976655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0065561   0.01398712  0.2813795 ]
Stock Position:  -0.0065561029238565055
Bond Position:  [7.76164189]


portfolio before change:  [7.06320186]
curr_Stock_Price:  106.68079723646042
curr_Factors:  [106.68079724  -0.55061765  -1.00973984]
mat_Sqrt:  [[22.40947104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00745642 -0.12004926  0.37078566]
Stock Position:  -0.007456420834412586
Bond Position:  [7.85865878]


portfolio before change:  [7.06080147]
curr_Stock_Price:  107.13447198078728
curr_Factors:  [107.13447198  -0.38983338  -1.00847918]
mat_Sqrt:  [[26.46365376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00517119 -0.01959318 -0.61762492]
Stock Position:  0.005171191712690745
Bond Position:  [6.50678857]


portfolio before change:  [7.06484367]
curr_Stock_Price:  107.75885402616768
curr_Factors:  [107.75885403  -0.47826266  -0.96417946]
mat_Sqrt:  [[25.46878981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02373532 0.00692457 1.03746494]
Stock Position:  0.023735322386598305
Bond Position:  [4.50715253]


portfolio before change:  [7.07554348]
curr_Stock_Price:  108.1859129033028
curr_Factors:  [108.1859129   -0.35704942  -0.95342806]
mat_Sqrt:  [[29.17679458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085998  0.01954921  0.30217641]
Stock Position:  -0.0008599827700715614
Bond Position:  [7.1685815]


portfolio before change:  [7.07565975]
curr_Stock_Price:  109.09274477125027
curr_Factors:  [109.09274477  -0.28810083  -0.97839536]
mat_Sqrt:  [[30.74422591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111824 -0.02600141 -0.03673698]
Stock Position:  -0.0011182411884698205
Bond Position:  [7.19765175]


portfolio before change:  [7.07823601]
curr_Stock_Price:  107.59351525920502
curr_Factors:  [107.59351526  -0.20278082  -0.98224889]
mat_Sqrt:  [[32.89532889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00890051 -0.02902401 -0.22935521]
Stock Position:  0.008900514953331422
Bond Position:  [6.12059832]


portfolio before change:  [7.07454349]
curr_Stock_Price:  107.09268589065336
curr_Factors:  [107.09268589  -0.40670085  -0.93450739]
mat_Sqrt:  [[28.00789514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158179 -0.03101766 -0.0355249 ]
Stock Position:  -0.001581790842596461
Bond Position:  [7.24394172]


portfolio before change:  [7.07825393]
curr_Stock_Price:  105.31945072474403
curr_Factors:  [105.31945072  -0.34365513  -0.9404723 ]
mat_Sqrt:  [[29.16212217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00182061  0.00443412 -0.16848404]
Stock Position:  0.0018206067003563825
Bond Position:  [6.88650863]


portfolio before change:  [7.07628836]
curr_Stock_Price:  103.7669834346296
curr_Factors:  [103.76698343  -0.3691145   -0.96991103]
mat_Sqrt:  [[27.19742532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00447249 -0.01250483  0.06062057]
Stock Position:  -0.004472490129274619
Bond Position:  [7.54038517]


portfolio before change:  [7.08225189]
curr_Stock_Price:  102.64436007832322
curr_Factors:  [102.64436008  -0.18338214  -0.98395975]
mat_Sqrt:  [[31.94220937  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00901241 0.00603178 0.13682112]
Stock Position:  0.009012408536539248
Bond Position:  [6.15717898]


portfolio before change:  [7.07368781]
curr_Stock_Price:  101.60870168956319
curr_Factors:  [101.60870169  -0.20834253  -0.96834857]
mat_Sqrt:  [[31.32567587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00105951  0.01326652 -0.10392857]
Stock Position:  0.00105951460070726
Bond Position:  [6.96603191]


portfolio before change:  [7.07780953]
curr_Stock_Price:  104.67700571166857
curr_Factors:  [104.67700571  -0.25867724  -0.97779677]
mat_Sqrt:  [[30.39887062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110972  0.00239683 -0.04897513]
Stock Position:  -0.001109719239698018
Bond Position:  [7.19397162]


portfolio before change:  [7.07963463]
curr_Stock_Price:  103.84274661081713
curr_Factors:  [103.84274661  -0.12808979  -0.99749112]
mat_Sqrt:  [[33.69322542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07608958 0.49225945 0.52613888]
Stock Position:  0.07608958479718668
Bond Position:  [-0.82171685]


portfolio before change:  [7.03673269]
curr_Stock_Price:  103.28026200053966
curr_Factors:  [ 1.03280262e+02 -4.65562804e-02 -9.88590091e-01]
mat_Sqrt:  [[36.68250401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011036   0.00941771 -0.03551847]
Stock Position:  -0.0011036039932368691
Bond Position:  [7.1507132]


portfolio before change:  [7.03970442]
curr_Stock_Price:  101.39748626986163
curr_Factors:  [101.39748627  -0.17902874  -0.98992611]
mat_Sqrt:  [[31.50333606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035816 -0.00434765 -0.29218153]
Stock Position:  0.0003581597015057446
Bond Position:  [7.00338793]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.0394586]
Stock Price:  98.2667673923557
PL:  [7.0394586]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-1.29046436e-02 -1.12704867e-01  1.01344643e-01]
 [ 8.75470418e-01  2.02185927e-01  2.40519159e-01]
 [-2.75361745e-01 -1.66994406e-01  3.78285324e-02]
 [ 1.98882864e-01  1.25057938e+00  1.22627847e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-2.30554902e-02  2.70034401e-01 -1.20759391e-01]
 [-7.17829423e-02  5.44149502e-02 -3.13901390e-02]
 [-4.28545171e-02  8.02054364e-02  1.84211749e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 5.65149095e-01  1.33655213e+00 -1.35668072e-01]
 [-1.33267637e-03  3.58591585e-02  1.23677768e-01]
 [-4.41783427e-01 -6.30482511e-02 -1.15379860e+00]
 [ 2.22071897e+00 -3.27762643e+00  2.79476637e+00]
 [ 6.62239769e-03 -1.73009353e-03 -1.72638123e-02]
 [ 1.34130261e-02  3.38715624e-01 -1.80327737e-01]
 [ 2.99988856e-02 -2.63638973e-01 -5.24627153e-03]
 [-2.93788421e-01 -1.87285297e+00 -1.92717337e-01]
 [ 2.90780053e-02 -1.53207898e-01  2.84909285e-01]
 [-1.30314342e-01  4.78182140e-01  2.79409869e-01]
 [ 2.12196032e-02  5.52776475e-02 -2.74952387e-02]
 [ 1.21335002e-01 -5.24147705e-02  5.72222587e-02]
 [-5.27791078e-02 -9.15440850e-02 -8.89093040e-02]
 [-1.24871756e-01 -6.77388040e-03  6.05477724e-02]
 [ 1.03778389e-01  6.89124651e-03 -3.69273305e-02]
 [ 1.06844866e-02 -4.85444511e-02  2.40845227e-01]
 [-2.07162912e-01 -1.41370633e-01 -7.49978936e-02]
 [-1.68728873e-01  1.29524987e-01  2.27647107e-01]
 [ 9.82760285e-02  6.09326763e-02  1.79850713e-01]
 [-1.63509141e-01  1.22121172e-01 -4.33923796e-02]
 [ 7.11609070e-02 -1.59985324e-02 -5.92904487e-02]
 [ 3.94787925e-04 -1.90147579e-03 -5.22018828e-02]
 [-7.59559107e-02  7.40300032e-03  6.82530979e-02]
 [-2.04216545e-02 -3.25016133e-02 -8.39012598e-03]
 [-9.08743736e-02  1.34923480e-02  5.39695684e-02]
 [-1.13870750e-01 -6.53760160e-02 -7.65826420e-02]
 [ 1.87596499e+00  1.21287867e+00  1.51676478e-01]
 [ 1.53840070e-02 -5.21275825e-02  3.91421988e-02]
 [ 3.11308373e-02 -1.48828192e-02 -3.95041339e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.28438252]
curr_Stock_Price:  99.35970116433606
curr_Factors:  [99.35970116 -0.98547744 -1.03679228]
mat_Sqrt:  [[13.1507251   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00115762 -0.03637534  0.28910806]
Stock Position:  -0.0011576197844965477
Bond Position:  [-2.16936176]


portfolio before change:  [-2.28485807]
curr_Stock_Price:  99.53624244416406
curr_Factors:  [99.53624244 -1.16474449 -1.04769617]
mat_Sqrt:  [[10.89257283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08866934 0.06525523 0.68613421]
Stock Position:  0.08866933735826327
Bond Position:  [-11.11067073]


portfolio before change:  [-2.26002094]
curr_Stock_Price:  99.83201614567358
curr_Factors:  [99.83201615 -0.88404316 -1.04490891]
mat_Sqrt:  [[14.50563022  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02080072 -0.05389721  0.10791427]
Stock Position:  -0.020800724576258988
Bond Position:  [-0.18344266]


portfolio before change:  [-2.25107112]
curr_Stock_Price:  99.40064916192567
curr_Factors:  [99.40064916 -0.7211702  -1.00851632]
mat_Sqrt:  [[17.62771055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03996375 0.40362276 3.49823115]
Stock Position:  0.03996374651738893
Bond Position:  [-6.22349347]


portfolio before change:  [-2.22935697]
curr_Stock_Price:  99.96346266052147
curr_Factors:  [99.96346266 -0.52822089 -1.01857127]
mat_Sqrt:  [[21.28521252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275525 -0.01106097 -0.05874131]
Stock Position:  -0.0027552462016716818
Bond Position:  [-1.95393302]


portfolio before change:  [-2.22628078]
curr_Stock_Price:  98.75832555507647
curr_Factors:  [98.75832556 -0.71210584 -1.00595179]
mat_Sqrt:  [[17.71865581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00041849  0.08715323 -0.34449293]
Stock Position:  0.0004184935749789417
Bond Position:  [-2.2676105]


portfolio before change:  [-2.22656869]
curr_Stock_Price:  98.747720592216
curr_Factors:  [98.74772059 -0.77478288 -0.99137661]
mat_Sqrt:  [[16.88471587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003973    0.01756235 -0.08954733]
Stock Position:  -0.003973002740214095
Bond Position:  [-1.83424372]


portfolio before change:  [-2.22364483]
curr_Stock_Price:  97.95407674116656
curr_Factors:  [97.95407674 -0.6384264  -0.99447386]
mat_Sqrt:  [[19.13651909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118739  0.02588619  0.05255048]
Stock Position:  -0.0011873864962630408
Bond Position:  [-2.10733548]


portfolio before change:  [-2.22333199]
curr_Stock_Price:  97.46874282312096
curr_Factors:  [97.46874282 -0.71862484 -0.986313  ]
mat_Sqrt:  [[17.71822738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00293433  0.0064198  -0.11330016]
Stock Position:  0.0029343343575356628
Bond Position:  [-2.50933787]


portfolio before change:  [-2.23042371]
curr_Stock_Price:  95.15883572780425
curr_Factors:  [95.15883573 -0.63939268 -0.98573707]
mat_Sqrt:  [[18.73545482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.66532174e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  4.66532174217952e-05
Bond Position:  [-2.23486318]


portfolio before change:  [-2.23070191]
curr_Stock_Price:  95.18401264069726
curr_Factors:  [95.18401264 -0.90791896 -0.97956838]
mat_Sqrt:  [[14.41579744  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05620768  0.43137035 -0.38702325]
Stock Position:  0.05620767987556255
Bond Position:  [-7.58077442]


portfolio before change:  [-2.17674243]
curr_Stock_Price:  96.16087454660209
curr_Factors:  [96.16087455 -0.90376236 -0.98073405]
mat_Sqrt:  [[14.60736948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00213814 0.01157349 0.35281825]
Stock Position:  0.0021381441987797577
Bond Position:  [-2.38234824]


portfolio before change:  [-2.17769731]
curr_Stock_Price:  95.85356408936204
curr_Factors:  [95.85356409 -1.12879872 -0.97123058]
mat_Sqrt:  [[11.73754108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05880033 -0.02034874 -3.29146625]
Stock Position:  -0.0588003266745838
Bond Position:  [3.45852357]


portfolio before change:  [-2.15483157]
curr_Stock_Price:  95.47204572797945
curr_Factors:  [95.47204573 -1.17656835 -0.94899096]
mat_Sqrt:  [[11.39613402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.18621715 -1.05784938  7.97269054]
Stock Position:  0.1862171476769634
Bond Position:  [-19.93336361]


portfolio before change:  [-2.1421069]
curr_Stock_Price:  95.5537594384723
curr_Factors:  [95.55375944 -0.90465409 -0.94216586]
mat_Sqrt:  [[15.07245745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00018214 -0.00055839 -0.04924885]
Stock Position:  0.00018213903837139956
Bond Position:  [-2.15951097]


portfolio before change:  [-2.14245006]
curr_Stock_Price:  95.15181564891056
curr_Factors:  [95.15181565 -1.13646877 -0.96459745]
mat_Sqrt:  [[11.63953462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00393004  0.10932    -0.51442484]
Stock Position:  0.003930038410414538
Bond Position:  [-2.51640036]


portfolio before change:  [-2.1436612]
curr_Stock_Price:  94.92368509438413
curr_Factors:  [94.92368509 -0.99415188 -0.96184716]
mat_Sqrt:  [[13.42440369  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185387 -0.08508911 -0.01496615]
Stock Position:  -0.0018538689544872738
Bond Position:  [-1.96768512]


portfolio before change:  [-2.1458279]
curr_Stock_Price:  95.9597489435986
curr_Factors:  [95.95974894 -1.16902585 -0.98098375]
mat_Sqrt:  [[11.17768324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06400443 -0.6044607  -0.54976892]
Stock Position:  -0.06400442544812208
Bond Position:  [3.9960207]


portfolio before change:  [-2.1433828]
curr_Stock_Price:  95.92935155872762
curr_Factors:  [95.92935156 -1.10516523 -1.01817715]
mat_Sqrt:  [[11.47613452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00487633 -0.04944764  0.81276689]
Stock Position:  0.00487633168388513
Bond Position:  [-2.61116613]


portfolio before change:  [-2.14522761]
curr_Stock_Price:  95.61797016363874
curr_Factors:  [95.61797016 -1.06085046 -0.99217995]
mat_Sqrt:  [[12.27212417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00198242 0.15433262 0.79707858]
Stock Position:  0.001982417935246937
Bond Position:  [-2.33478239]


portfolio before change:  [-2.1454043]
curr_Stock_Price:  95.67607157612495
curr_Factors:  [95.67607158 -0.95563182 -0.99560691]
mat_Sqrt:  [[13.59537283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197793  0.01784078 -0.07843626]
Stock Position:  0.001977927639208377
Bond Position:  [-2.33464464]


portfolio before change:  [-2.14482289]
curr_Stock_Price:  96.11757127355271
curr_Factors:  [96.11757127 -0.91479471 -0.96432129]
mat_Sqrt:  [[14.67956145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00833242 -0.01691679  0.16323918]
Stock Position:  0.00833242374828984
Bond Position:  [-2.94571523]


portfolio before change:  [-2.1374842]
curr_Stock_Price:  97.04250380159208
curr_Factors:  [97.0425038  -1.12047655 -0.97976593]
mat_Sqrt:  [[11.88059729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00754289 -0.02954573 -0.2536335 ]
Stock Position:  -0.0075428868875459945
Bond Position:  [-1.40550357]


portfolio before change:  [-2.13549382]
curr_Stock_Price:  96.75533578961124
curr_Factors:  [96.75533579 -0.91565725 -0.97541859]
mat_Sqrt:  [[14.60128646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00780035 -0.00218626  0.17272594]
Stock Position:  -0.0078003542051210285
Bond Position:  [-1.38076793]


portfolio before change:  [-2.1246469]
curr_Stock_Price:  95.34263955753478
curr_Factors:  [95.34263956 -0.66863429 -0.94518307]
mat_Sqrt:  [[18.98520101  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00514334  0.00222414 -0.1053434 ]
Stock Position:  0.005143337657662791
Bond Position:  [-2.61502629]


portfolio before change:  [-2.125654]
curr_Stock_Price:  95.21039046748085
curr_Factors:  [95.21039047 -0.65339133 -0.92041697]
mat_Sqrt:  [[19.73277146  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0025307  -0.01566765  0.68706439]
Stock Position:  0.0025306996644210034
Bond Position:  [-2.3666029]


portfolio before change:  [-2.12264247]
curr_Stock_Price:  96.5172906217728
curr_Factors:  [96.51729062 -0.71272226 -0.92914253]
mat_Sqrt:  [[18.68754716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01344901 -0.04562718 -0.21394812]
Stock Position:  -0.013449007018441608
Bond Position:  [-0.82458075]


portfolio before change:  [-2.1168732]
curr_Stock_Price:  96.08065235198873
curr_Factors:  [96.08065235 -0.70227297 -0.94281922]
mat_Sqrt:  [[18.54306348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00516751  0.04180401  0.64941383]
Stock Position:  -0.005167507788724476
Bond Position:  [-1.62037568]


portfolio before change:  [-2.11360443]
curr_Stock_Price:  95.40889248425297
curr_Factors:  [95.40889248 -0.69565059 -0.96315245]
mat_Sqrt:  [[18.16267649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00811696 0.01966594 0.51306402]
Stock Position:  0.00811696074713415
Bond Position:  [-2.88803467]


portfolio before change:  [-2.11758686]
curr_Stock_Price:  94.96274080723687
curr_Factors:  [94.96274081 -0.84833077 -0.96102153]
mat_Sqrt:  [[15.55111457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00948091  0.03941444 -0.12378638]
Stock Position:  -0.009480908452953149
Bond Position:  [-1.2172538]


portfolio before change:  [-2.12612788]
curr_Stock_Price:  95.84755633006357
curr_Factors:  [95.84755633 -0.75797493 -0.9603873 ]
mat_Sqrt:  [[17.19118489  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00324542 -0.0051635  -0.16913915]
Stock Position:  0.0032454195847941964
Bond Position:  [-2.43719341]


portfolio before change:  [-2.12832457]
curr_Stock_Price:  95.26457289130741
curr_Factors:  [95.26457289 -0.89546921 -0.97221873]
mat_Sqrt:  [[14.71651094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072361 -0.0006137  -0.14891744]
Stock Position:  -0.0007236099598950804
Bond Position:  [-2.05939018]


portfolio before change:  [-2.12949036]
curr_Stock_Price:  96.51986790222242
curr_Factors:  [96.5198679  -1.350293   -0.96645224]
mat_Sqrt:  [[ 9.51627631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00635886  0.00238931  0.19470709]
Stock Position:  -0.0063588605838908255
Bond Position:  [-1.51573397]


portfolio before change:  [-2.13248882]
curr_Stock_Price:  96.96161170941097
curr_Factors:  [96.96161171 -1.12925737 -0.97531921]
mat_Sqrt:  [[11.81935638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243403 -0.01048985 -0.02393469]
Stock Position:  -0.002434028122057535
Bond Position:  [-1.89648153]


portfolio before change:  [-2.13324839]
curr_Stock_Price:  97.1762748811426
curr_Factors:  [97.17627488 -1.1147485  -1.00044039]
mat_Sqrt:  [[11.72047968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00657855  0.00435464  0.15396016]
Stock Position:  -0.006578550507317681
Bond Position:  [-1.49396936]


portfolio before change:  [-2.13764625]
curr_Stock_Price:  97.81640089366313
curr_Factors:  [97.81640089 -1.51711039 -0.98910755]
mat_Sqrt:  [[ 7.97948862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01790189 -0.02110002 -0.21846896]
Stock Position:  -0.017901891475753783
Bond Position:  [-0.38654766]


portfolio before change:  [-2.1161786]
curr_Stock_Price:  96.61451806119314
curr_Factors:  [96.61451806 -1.0156071  -0.98350457]
mat_Sqrt:  [[13.0869736   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.16462963 0.39145491 0.43269077]
Stock Position:  0.16462963134844488
Bond Position:  [-18.02179109]


portfolio before change:  [-2.15477165]
curr_Stock_Price:  96.3937790467582
curr_Factors:  [96.39377905 -0.66329382 -0.99885954]
mat_Sqrt:  [[18.28879009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00069624 -0.0168241   0.1116618 ]
Stock Position:  0.0006962394257700626
Bond Position:  [-2.22188479]


portfolio before change:  [-2.15552268]
curr_Stock_Price:  95.71401010045966
curr_Factors:  [95.7140101  -0.66773946 -1.01181658]
mat_Sqrt:  [[17.84652199  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011223  -0.00480341 -0.1126943 ]
Stock Position:  0.0011222997413720126
Bond Position:  [-2.26294249]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.15619522]
Stock Price:  95.36681339112197
PL:  [-2.15619522]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.48939898e-01 -1.06313030e-02 -2.11213664e-01]
 [ 1.23041821e+00  2.36517048e-01  3.57161163e-01]
 [-2.21861959e-01 -1.17748957e-01  3.62680199e-02]
 [ 1.93421390e-01  1.42864092e+00  1.23260151e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 2.75270246e-02 -7.69984056e-02  5.24501408e-02]
 [-6.25508218e-02  2.85821241e-02 -4.91722298e-02]
 [-6.34330807e-02  1.25943358e-01  6.51462416e-04]
 [ 5.03269115e-02  2.60714023e-02 -4.06554723e-02]
 [-6.83495892e-02 -2.98484967e-02  6.38126593e-03]
 [ 9.28544584e-01  1.81199630e+00 -3.16077077e-01]
 [-1.05920674e-03  5.99627627e-04  1.07052810e-01]
 [-2.91307359e-01 -4.06175976e-04 -6.11516037e-01]
 [ 1.73527208e+00 -3.13042516e+00  2.63271725e+00]
 [ 1.54704030e-03 -9.26787450e-02  3.60528382e-02]
 [ 7.83541827e-02  9.82879189e-02 -7.21992402e-02]
 [-3.87214504e-02  3.26040306e-02 -7.95137831e-02]
 [-2.75841193e-01 -1.78717412e+00 -1.98687291e-01]
 [ 3.11060824e-04  3.48081538e-02  7.41864303e-02]
 [ 2.23596519e-01 -1.13867640e-01  3.59408039e-01]
 [ 5.64570663e-02 -5.76062191e-02  1.01741791e-02]
 [ 1.43313535e-01 -5.38728180e-02 -1.52597246e-02]
 [ 1.26937006e-01  1.88218613e-01  1.55208140e-01]
 [-2.09846704e-01  7.15776779e-02  5.64041930e-02]
 [-3.61109042e-02 -1.73512593e-01  6.43179421e-02]
 [ 9.89951321e-02 -2.30918358e-02 -9.15790077e-02]
 [ 3.75734039e-01 -6.58586741e-02  1.97907751e-01]
 [ 6.14826331e-04 -6.26763569e-02  2.95306901e-02]
 [-1.32440633e-02 -7.85635328e-02 -9.41651255e-03]
 [ 1.72677784e-01 -4.06436612e-02  2.77269000e-02]
 [-2.33821428e-02 -6.70808260e-02 -3.13901850e-02]
 [ 7.03310842e-02  2.63654978e-02 -8.11657220e-02]
 [-8.07076384e-02 -4.90650435e-02  1.70787027e-02]
 [ 4.04786931e-01  4.77633001e-02  8.08908629e-02]
 [ 4.71470658e-02  1.05021704e-01 -6.79247721e-02]
 [-1.03025692e-01 -3.50336200e-02 -1.10701350e-01]
 [ 2.24666804e+00  1.52312336e+00  1.81373632e-01]
 [-2.79524891e-02 -4.63638840e-02 -3.20633483e-02]
 [ 3.42749262e-02 -1.36350872e-02 -9.07517277e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.05042469]
curr_Stock_Price:  100.63354388728891
curr_Factors:  [100.63354389  -1.25664629  -0.98403426]
mat_Sqrt:  [[10.7060082   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00968204 -0.00343124 -0.60253379]
Stock Position:  0.009682038538307411
Bond Position:  [6.07608684]


portfolio before change:  [7.04823228]
curr_Stock_Price:  100.32865271085792
curr_Factors:  [100.32865271  -1.2342147   -1.01309344]
mat_Sqrt:  [[10.60306581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.12747278 0.07633555 1.01888138]
Stock Position:  0.12747277913657304
Bond Position:  [-5.7409399]


portfolio before change:  [7.03597098]
curr_Stock_Price:  100.2380949818669
curr_Factors:  [100.23809498  -1.03043118  -1.0037689 ]
mat_Sqrt:  [[13.10964503  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01819227 -0.03800331  0.10346257]
Stock Position:  -0.018192268724011976
Bond Position:  [8.85952934]


portfolio before change:  [7.05067721]
curr_Stock_Price:  99.49059479191526
curr_Factors:  [99.49059479 -1.06203653 -0.99682776]
mat_Sqrt:  [[12.69488088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05802695 0.46109187 3.51626901]
Stock Position:  0.058026950577960444
Bond Position:  [1.27754138]


portfolio before change:  [7.08325792]
curr_Stock_Price:  100.04931813863728
curr_Factors:  [100.04931814  -0.92503207  -0.96481325]
mat_Sqrt:  [[15.11696946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00387948 -0.01106097 -0.05874131]
Stock Position:  -0.003879481338684303
Bond Position:  [7.47139739]


portfolio before change:  [7.08298987]
curr_Stock_Price:  100.35916380686506
curr_Factors:  [100.35916381  -0.91783055  -0.96730611]
mat_Sqrt:  [[15.23535513  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147789 -0.02485113  0.14962565]
Stock Position:  0.0014778868505902032
Bond Position:  [6.93467038]


portfolio before change:  [7.08188982]
curr_Stock_Price:  99.0282562328691
curr_Factors:  [99.02825623 -0.77730127 -0.98773185]
mat_Sqrt:  [[16.95176755  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393786  0.00922484 -0.14027468]
Stock Position:  -0.0039378642540898595
Bond Position:  [7.47184965]


portfolio before change:  [7.08222222]
curr_Stock_Price:  99.18104007346412
curr_Factors:  [99.18104007 -0.80889575 -0.98011919]
mat_Sqrt:  [[16.57560313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226791  0.04064804  0.00185844]
Stock Position:  -0.0022679127241180346
Bond Position:  [7.30715616]


portfolio before change:  [7.08337671]
curr_Stock_Price:  99.07476005813577
curr_Factors:  [99.07476006 -0.79612698 -0.99980474]
mat_Sqrt:  [[16.44370938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00287952  0.00841451 -0.11597875]
Stock Position:  0.0028795176043184888
Bond Position:  [6.79808919]


portfolio before change:  [7.08672233]
curr_Stock_Price:  99.94150607935843
curr_Factors:  [99.94150608 -0.6755717  -1.00678655]
mat_Sqrt:  [[18.58262161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393593 -0.00963356  0.01820398]
Stock Position:  -0.0039359256823280515
Bond Position:  [7.48008467]


portfolio before change:  [7.08988627]
curr_Stock_Price:  99.3752185710252
curr_Factors:  [99.37521857 -0.62670278 -1.02951202]
mat_Sqrt:  [[18.96676005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0650558   0.58481929 -0.90167992]
Stock Position:  0.06505580352826283
Bond Position:  [0.62495157]


portfolio before change:  [7.05777148]
curr_Stock_Price:  98.88036790748374
curr_Factors:  [98.88036791 -0.52956963 -0.96915326]
mat_Sqrt:  [[22.0913875   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [9.46760589e-04 1.93528984e-04 3.05391869e-01]
Stock Position:  0.0009467605887963891
Bond Position:  [6.96415545]


portfolio before change:  [7.05987875]
curr_Stock_Price:  100.18659899582488
curr_Factors:  [100.186599    -0.92209808  -0.99196085]
mat_Sqrt:  [[14.77557553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.81691537e-02 -1.31092733e-04 -1.74448504e+00]
Stock Position:  -0.028169153653113677
Bond Position:  [9.88205045]


portfolio before change:  [7.05762757]
curr_Stock_Price:  100.31036929780421
curr_Factors:  [100.3103693   -0.77513088  -0.99572256]
mat_Sqrt:  [[17.07158912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09569571 -1.01034038  7.5104095 ]
Stock Position:  0.09569571206339612
Bond Position:  [-2.54164464]


portfolio before change:  [7.03818374]
curr_Stock_Price:  100.11050552923017
curr_Factors:  [100.11050553  -0.65693271  -0.98438638]
mat_Sqrt:  [[19.393841    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051623 -0.02991194  0.10284871]
Stock Position:  -0.000516229587039662
Bond Position:  [7.08986375]


portfolio before change:  [7.0397437]
curr_Stock_Price:  98.80552913165916
curr_Factors:  [98.80552913 -0.77919773 -0.97105731]
mat_Sqrt:  [[17.16544814  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00487488  0.03172229 -0.20596434]
Stock Position:  0.004874880706129534
Bond Position:  [6.55807853]


portfolio before change:  [7.0430659]
curr_Stock_Price:  99.31885181043917
curr_Factors:  [99.31885181 -0.80462875 -0.97421997]
mat_Sqrt:  [[16.76824088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288026  0.01052291 -0.22683069]
Stock Position:  -0.002880258217405228
Bond Position:  [7.32912984]


portfolio before change:  [7.04156931]
curr_Stock_Price:  100.15655013787921
curr_Factors:  [100.15655014  -0.80075656  -0.97371465]
mat_Sqrt:  [[16.98385613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04010888 -0.57680797 -0.56679954]
Stock Position:  -0.04010888055970277
Bond Position:  [11.05873641]


portfolio before change:  [7.00938865]
curr_Stock_Price:  100.99334958319541
curr_Factors:  [100.99334958  -0.86540249  -0.99329553]
mat_Sqrt:  [[15.74238339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00143304 0.01123428 0.21163324]
Stock Position:  0.0014330413992308998
Bond Position:  [6.864661]


portfolio before change:  [7.01110119]
curr_Stock_Price:  101.58956599190319
curr_Factors:  [101.58956599  -1.05299124  -0.97013934]
mat_Sqrt:  [[13.4342881   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02037453 -0.03675062  1.0252911 ]
Stock Position:  0.02037452535804059
Bond Position:  [4.941262]


portfolio before change:  [7.02335647]
curr_Stock_Price:  102.16074907726657
curr_Factors:  [102.16074908  -1.1199349   -0.96158504]
mat_Sqrt:  [[12.74357991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00367048 -0.01859233  0.0290241 ]
Stock Position:  0.0036704789346100756
Bond Position:  [6.64837759]


portfolio before change:  [7.02335874]
curr_Stock_Price:  101.93494003398055
curr_Factors:  [101.93494003  -1.1112646   -0.95243367]
mat_Sqrt:  [[12.94405357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00998157 -0.01738738 -0.04353175]
Stock Position:  0.009981565113572989
Bond Position:  [6.0058885]


portfolio before change:  [7.0305439]
curr_Stock_Price:  102.57956609109462
curr_Factors:  [102.57956609  -1.05959314  -0.95041303]
mat_Sqrt:  [[13.74441534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01433591 0.0607473  0.44276562]
Stock Position:  0.014335909825149548
Bond Position:  [5.55997249]


portfolio before change:  [7.04151718]
curr_Stock_Price:  103.29652405571191
curr_Factors:  [103.29652406  -1.05946472  -0.94836245]
mat_Sqrt:  [[13.87067028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0132454   0.0231016   0.16090546]
Stock Position:  -0.01324539552530392
Bond Position:  [8.4097205]


portfolio before change:  [7.04968391]
curr_Stock_Price:  102.75932223978731
curr_Factors:  [102.75932224  -1.15516824  -0.96443472]
mat_Sqrt:  [[12.33926708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00473287 -0.05600095  0.18348119]
Stock Position:  -0.00473287178203702
Bond Position:  [7.53603061]


portfolio before change:  [7.0447495]
curr_Stock_Price:  104.0009532528547
curr_Factors:  [104.00095325  -1.02191337  -0.96770886]
mat_Sqrt:  [[14.2218261   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00531493 -0.00745286 -0.26124942]
Stock Position:  0.005314932392119584
Bond Position:  [6.49199146]


portfolio before change:  [7.03887415]
curr_Stock_Price:  102.74281933443581
curr_Factors:  [102.74281933  -0.90887097  -0.96611318]
mat_Sqrt:  [[15.75637135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02555718 -0.0212558   0.56457573]
Stock Position:  0.025557181602231204
Bond Position:  [4.41305726]


portfolio before change:  [7.05221697]
curr_Stock_Price:  103.24331100009232
curr_Factors:  [103.243311    -0.8788461   -0.98874253]
mat_Sqrt:  [[15.95065364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038563 -0.02022871  0.08424284]
Stock Position:  -0.00038562711637777806
Bond Position:  [7.09203039]


portfolio before change:  [7.05280206]
curr_Stock_Price:  104.02509272462203
curr_Factors:  [104.02509272  -0.73608369  -0.99077508]
mat_Sqrt:  [[18.50004894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168664 -0.02535627 -0.02686269]
Stock Position:  -0.0016866395854284407
Bond Position:  [7.22825489]


portfolio before change:  [7.05323883]
curr_Stock_Price:  104.30186569572516
curr_Factors:  [104.3018657   -0.65052384  -1.01094039]
mat_Sqrt:  [[19.80283323  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00858671 -0.01311769  0.07909713]
Stock Position:  0.008586708762193739
Bond Position:  [6.15762908]


portfolio before change:  [7.05392423]
curr_Stock_Price:  104.29204249759628
curr_Factors:  [104.2920425   -0.66849087  -1.00593906]
mat_Sqrt:  [[19.54589204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00222463 -0.02165024 -0.08954746]
Stock Position:  -0.0022246338868379388
Bond Position:  [7.28593584]


portfolio before change:  [7.0552355]
curr_Stock_Price:  104.11202547438474
curr_Factors:  [104.11202547  -0.69517842  -1.01653049]
mat_Sqrt:  [[18.79815228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00314632  0.00850943 -0.23154321]
Stock Position:  0.003146321743622997
Bond Position:  [6.72766557]


portfolio before change:  [7.05491876]
curr_Stock_Price:  103.74405548387979
curr_Factors:  [103.74405548  -0.66347333  -1.01133096]
mat_Sqrt:  [[19.43591365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448843 -0.01583567  0.04872079]
Stock Position:  -0.004488434370032242
Bond Position:  [7.52056714]


portfolio before change:  [7.05487428]
curr_Stock_Price:  103.96342057085593
curr_Factors:  [103.96342057  -0.55468104  -1.00583508]
mat_Sqrt:  [[21.83519229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01974099 0.01541554 0.23075912]
Stock Position:  0.01974099182353795
Bond Position:  [5.00253325]


portfolio before change:  [7.05305089]
curr_Stock_Price:  103.83937643277366
curr_Factors:  [103.83937643  -0.54229903  -0.98320858]
mat_Sqrt:  [[22.58616694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024227   0.03389561 -0.19377047]
Stock Position:  0.0024226972881150584
Bond Position:  [6.80147951]


portfolio before change:  [7.0507363]
curr_Stock_Price:  102.53305241016272
curr_Factors:  [102.53305241  -0.34186885  -0.97603884]
mat_Sqrt:  [[27.44756662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483736 -0.01130705 -0.31580014]
Stock Position:  -0.004837358460937437
Bond Position:  [7.54672542]


portfolio before change:  [7.04801588]
curr_Stock_Price:  103.29045192184296
curr_Factors:  [103.29045192  -0.43976273  -0.98540649]
mat_Sqrt:  [[24.83802448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10446068 0.49158595 0.51740849]
Stock Position:  0.10446068405178842
Bond Position:  [-3.74177538]


portfolio before change:  [6.92784452]
curr_Stock_Price:  102.14453166528813
curr_Factors:  [102.14453167  -0.55785412  -0.97547234]
mat_Sqrt:  [[22.04448207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199421 -0.01496388 -0.09146781]
Stock Position:  -0.001994212460927949
Bond Position:  [7.13154242]


portfolio before change:  [6.93174698]
curr_Stock_Price:  100.6346821340309
curr_Factors:  [100.63468213  -0.48538648  -0.96444863]
mat_Sqrt:  [[23.60979915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00054922 -0.00440071 -0.25888942]
Stock Position:  0.0005492235127141202
Bond Position:  [6.87647604]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.93156469]
Stock Price:  98.73764224003529
PL:  [6.93156469]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 2.44470107e-03 -1.08287467e-01  3.90233891e-02]
 [ 1.15898815e+00  2.35378300e-01  3.40559566e-01]
 [-3.31518521e-01 -2.18685559e-01  3.94665455e-02]
 [ 1.92361291e-01  1.48122345e+00  1.23758554e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [-1.52012237e-02  2.12028648e-01 -8.35682388e-02]
 [-1.09049543e-01  1.58692358e-01  4.03894775e-02]
 [-4.83985185e-02  1.58282627e-01 -1.23373322e-02]
 [ 3.07652829e-02  4.72402459e-02 -4.38715609e-02]
 [-1.09654991e-01 -5.54973583e-02 -2.21691805e-02]
 [ 8.95533587e-01  1.71800097e+00 -3.12488758e-01]
 [-1.14044572e-05  9.11951651e-03 -4.29440238e-02]
 [-2.92624430e-01  4.48130752e-04 -6.19962255e-01]
 [ 1.83706638e+00 -3.15680360e+00  2.66303887e+00]
 [ 1.01262728e-02 -9.12324966e-02  3.51632480e-02]
 [ 9.78259727e-02  4.86057562e-02 -4.70685557e-02]
 [-3.67287276e-02  3.58706326e-02 -8.13023975e-02]
 [-2.77212621e-01 -1.78939680e+00 -1.96668989e-01]
 [-4.72722890e-03  1.52798442e-02  1.90769845e-01]
 [ 2.41879809e-01 -4.35522247e-02  4.36192701e-01]
 [ 5.90761385e-02 -1.11737396e-01 -2.74399480e-03]
 [ 1.31534245e-01 -5.25662900e-02 -1.09726177e-02]
 [ 6.41921036e-02  1.47490092e-01  1.09096196e-01]
 [-2.34743572e-01  7.32148292e-02  2.81811164e-02]
 [-3.25089548e-03 -1.20339062e-01  3.85653267e-02]
 [ 4.56935891e-02 -9.38050027e-03  9.36934581e-02]
 [ 3.65299688e-01 -8.70220130e-02  1.73282406e-01]
 [ 3.34550530e-02 -1.29724547e-01 -3.67026150e-02]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [ 2.93087997e-02  2.51146978e-02  7.70926470e-02]
 [-1.81705107e-02 -2.32646738e-02 -6.11344167e-02]
 [-6.92539266e-03  2.17138518e-02 -5.74948880e-02]
 [-1.09829481e-01 -3.83674278e-02  2.58609110e-02]
 [ 2.30874606e-01  1.11382113e-02  4.18096206e-02]
 [ 3.36310195e-03  1.47529044e-02 -1.03969125e-02]
 [-8.84870023e-02 -2.03741660e-02 -1.05752168e-01]
 [ 2.25036367e+00  1.54012559e+00  1.84381678e-01]
 [-7.73825578e-02 -4.99946392e-02 -2.84156944e-02]
 [ 3.64424906e-02 -1.31529934e-02 -1.37623073e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.6454483]
curr_Stock_Price:  99.44689114926028
curr_Factors:  [99.44689115 -1.03738612 -0.98615473]
mat_Sqrt:  [[13.1455447   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088956 -0.03494963  0.11132287]
Stock Position:  -0.0008895614423330164
Bond Position:  [-1.55698418]


portfolio before change:  [-1.64618784]
curr_Stock_Price:  100.05944477745352
curr_Factors:  [100.05944478  -1.29286808  -0.97595425]
mat_Sqrt:  [[10.34954056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.12334373 0.07596802 0.97152165]
Stock Position:  0.12334373411355909
Bond Position:  [-13.9878934]


portfolio before change:  [-1.75523715]
curr_Stock_Price:  99.18951238693933
curr_Factors:  [99.18951239 -1.27233852 -0.96303905]
mat_Sqrt:  [[10.60849094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03469876 -0.07058046  0.11258707]
Stock Position:  -0.03469875701296377
Bond Position:  [1.68651564]


portfolio before change:  [-1.76843291]
curr_Stock_Price:  99.57588325343993
curr_Factors:  [99.57588325 -1.15142601 -0.9568466 ]
mat_Sqrt:  [[12.09324935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06179777 0.47806281 3.53048707]
Stock Position:  0.06179777081511228
Bond Position:  [-7.92200052]


portfolio before change:  [-1.81898378]
curr_Stock_Price:  98.77390346078533
curr_Factors:  [98.77390346 -1.2892003  -0.92563259]
mat_Sqrt:  [[10.78332053  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00543858 -0.01106097 -0.05874131]
Stock Position:  -0.005438584598010182
Bond Position:  [-1.28179355]


portfolio before change:  [-1.81717182]
curr_Stock_Price:  98.4112729463295
curr_Factors:  [98.41127295 -1.0691027  -0.95945172]
mat_Sqrt:  [[12.94359337  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085144  0.06843195 -0.23839692]
Stock Position:  0.0008514364785149153
Bond Position:  [-1.90096277]


portfolio before change:  [-1.81649526]
curr_Stock_Price:  99.4849831826675
curr_Factors:  [99.48498318 -1.34498227 -0.93863014]
mat_Sqrt:  [[10.13904988  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00674739  0.05121774  0.11521994]
Stock Position:  -0.006747390932646626
Bond Position:  [-1.14523119]


portfolio before change:  [-1.81563613]
curr_Stock_Price:  99.33643842934197
curr_Factors:  [99.33643843 -1.39807736 -0.93022002]
mat_Sqrt:  [[ 9.68148284  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192197  0.0510855  -0.03519497]
Stock Position:  -0.0019219741811198373
Bond Position:  [-1.62471406]


portfolio before change:  [-1.81563818]
curr_Stock_Price:  99.23182904212065
curr_Factors:  [99.23182904 -1.3734727  -0.97596797]
mat_Sqrt:  [[ 9.46895119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00332169  0.01524672 -0.12515335]
Stock Position:  0.003321689191310868
Bond Position:  [-2.14525547]


portfolio before change:  [-1.8143988]
curr_Stock_Price:  99.68568065483315
curr_Factors:  [99.68568065 -1.01083845 -0.97006819]
mat_Sqrt:  [[13.75105307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0091272 -0.0179117 -0.0632425]
Stock Position:  -0.009127199659947405
Bond Position:  [-0.90454769]


portfolio before change:  [-1.81625413]
curr_Stock_Price:  99.87656662466834
curr_Factors:  [99.87656662 -0.92507223 -0.95513411]
mat_Sqrt:  [[15.23703144  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07760255  0.55448243 -0.89144345]
Stock Position:  0.07760255473222667
Bond Position:  [-9.56693086]


portfolio before change:  [-1.77915814]
curr_Stock_Price:  100.37000306660771
curr_Factors:  [100.37000307  -0.91357969  -0.95492694]
mat_Sqrt:  [[15.4925113   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004464   0.00294331 -0.12250735]
Stock Position:  -0.00044639651725748804
Bond Position:  [-1.73435332]


portfolio before change:  [-1.77922397]
curr_Stock_Price:  100.03178901714723
curr_Factors:  [100.03178902  -0.85903599  -0.98005449]
mat_Sqrt:  [[15.90124728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.63553049e-02  1.44633578e-04 -1.76857975e+00]
Stock Position:  -0.02635530492000244
Bond Position:  [0.85714433]


portfolio before change:  [-1.75949052]
curr_Stock_Price:  99.28710762049069
curr_Factors:  [99.28710762 -0.85071227 -0.95923078]
mat_Sqrt:  [[16.24967137  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10684998 -1.01885398  7.59690864]
Stock Position:  0.10684998099372872
Bond Position:  [-12.36831608]


portfolio before change:  [-1.67380921]
curr_Stock_Price:  100.10346197620402
curr_Factors:  [100.10346198  -0.87571683  -0.93613403]
mat_Sqrt:  [[16.3520524   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.06513260e-05 -2.94451617e-02  1.00310959e-01]
Stock Position:  -8.065132604406024e-05
Bond Position:  [-1.66573573]


portfolio before change:  [-1.67397448]
curr_Stock_Price:  99.57080368868309
curr_Factors:  [99.57080369 -1.02176125 -0.95642219]
mat_Sqrt:  [[13.77266107  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00712569  0.01568744 -0.13427349]
Stock Position:  0.007125692843875194
Bond Position:  [-2.38348544]


portfolio before change:  [-1.67812854]
curr_Stock_Price:  99.0296477723995
curr_Factors:  [99.02964777 -0.99763652 -0.94711668]
mat_Sqrt:  [[14.16346941  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324796  0.0115772  -0.23193311]
Stock Position:  -0.003247964636761531
Bond Position:  [-1.35648375]


portfolio before change:  [-1.67975521]
curr_Stock_Price:  99.47826614353094
curr_Factors:  [99.47826614 -1.01617325 -0.93849018]
mat_Sqrt:  [[14.08732927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04845607 -0.57752534 -0.56104188]
Stock Position:  -0.04845606931020619
Bond Position:  [3.14057055]


portfolio before change:  [-1.72682936]
curr_Stock_Price:  100.45784931703479
curr_Factors:  [100.45784932  -1.18414899  -0.94302159]
mat_Sqrt:  [[11.97196486  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00311833 0.00493155 0.54421327]
Stock Position:  0.003118325869989513
Bond Position:  [-2.04008967]


portfolio before change:  [-1.72380723]
curr_Stock_Price:  101.5087848907852
curr_Factors:  [101.50878489  -1.29230453  -0.94067655]
mat_Sqrt:  [[10.88258996  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02959105 -0.01405642  1.24433636]
Stock Position:  0.029591045085940557
Bond Position:  [-4.72755826]


portfolio before change:  [-1.71103741]
curr_Stock_Price:  101.96030007631838
curr_Factors:  [101.96030008  -1.24768158  -0.95973943]
mat_Sqrt:  [[11.2139945   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00318421 -0.03606309 -0.00782785]
Stock Position:  0.00318421080653718
Bond Position:  [-2.0357005]


portfolio before change:  [-1.71299153]
curr_Stock_Price:  101.42652613360644
curr_Factors:  [101.42652613  -1.27120193  -0.9514443 ]
mat_Sqrt:  [[10.98673265  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0107916  -0.0169657  -0.03130182]
Stock Position:  0.010791599633067313
Bond Position:  [-2.807546]


portfolio before change:  [-1.71101605]
curr_Stock_Price:  101.64210557844916
curr_Factors:  [101.64210558  -1.16529113  -0.94464552]
mat_Sqrt:  [[12.32366281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00945884 0.04760222 0.31122108]
Stock Position:  0.009458840445260939
Bond Position:  [-2.67243251]


portfolio before change:  [-1.7071109]
curr_Stock_Price:  102.0902819537787
curr_Factors:  [102.09028195  -0.97549392  -0.93930598]
mat_Sqrt:  [[15.04517949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0142269   0.02362998  0.08039288]
Stock Position:  -0.01422689650943601
Bond Position:  [-0.25468302]


portfolio before change:  [-1.69546249]
curr_Stock_Price:  101.26928452485397
curr_Factors:  [101.26928452  -1.08735588  -0.9406097 ]
mat_Sqrt:  [[13.32734008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149639 -0.03883927  0.11001614]
Stock Position:  -0.0014963893122392374
Bond Position:  [-1.54392422]


portfolio before change:  [-1.69650836]
curr_Stock_Price:  101.83923437062951
curr_Factors:  [101.83923437  -1.28482362  -0.9508558 ]
mat_Sqrt:  [[10.88859612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00577704 -0.00302754  0.26728136]
Stock Position:  0.005777044065465661
Bond Position:  [-2.2848381]


portfolio before change:  [-1.6978026]
curr_Stock_Price:  101.66464451110322
curr_Factors:  [101.66464451  -1.07532969  -0.96704217]
mat_Sqrt:  [[13.18800546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02903453 -0.02808623  0.49432647]
Stock Position:  0.029034528264097262
Bond Position:  [-4.64958759]


portfolio before change:  [-1.70116696]
curr_Stock_Price:  101.56878865226459
curr_Factors:  [101.56878865  -1.15964523  -0.9592929 ]
mat_Sqrt:  [[12.2044198   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.23411542e-05 -4.18684176e-02 -1.04702345e-01]
Stock Position:  -4.2341154249659175e-05
Bond Position:  [-1.69686642]


portfolio before change:  [-1.70136287]
curr_Stock_Price:  101.1858695577581
curr_Factors:  [101.18586956  -1.14542423  -0.98004426]
mat_Sqrt:  [[12.0792684   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018295  -0.02321455 -0.0028026 ]
Stock Position:  -0.001829500900792264
Bond Position:  [-1.51624323]


portfolio before change:  [-1.70104732]
curr_Stock_Price:  100.90979007601433
curr_Factors:  [100.90979008  -1.0465645   -0.98398654]
mat_Sqrt:  [[13.24573896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00378777 0.00810573 0.21992386]
Stock Position:  0.0037877680318542453
Bond Position:  [-2.0832702]


portfolio before change:  [-1.69934957]
curr_Stock_Price:  101.42676361542728
curr_Factors:  [101.42676362  -0.77844863  -0.99945119]
mat_Sqrt:  [[17.14038157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206521 -0.00750864 -0.17439947]
Stock Position:  -0.002065205072555127
Bond Position:  [-1.48988251]


portfolio before change:  [-1.70115895]
curr_Stock_Price:  102.21270745275581
curr_Factors:  [102.21270745  -0.71684072  -0.98896311]
mat_Sqrt:  [[18.56451897  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076647  0.00700812 -0.16401691]
Stock Position:  -0.0007664710364004194
Bond Position:  [-1.62281587]


portfolio before change:  [-1.7005488]
curr_Stock_Price:  101.15197109328003
curr_Factors:  [101.15197109  -0.83307165  -0.98512131]
mat_Sqrt:  [[16.4188668   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00684471 -0.01238303  0.07377398]
Stock Position:  -0.006844708832833372
Bond Position:  [-1.00819301]


portfolio before change:  [-1.70218793]
curr_Stock_Price:  101.37303213021086
curr_Factors:  [101.37303213  -0.69359529  -0.96724609]
mat_Sqrt:  [[19.25875422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01254923 0.00359484 0.11927121]
Stock Position:  0.012549230056514756
Bond Position:  [-2.97434143]


portfolio before change:  [-1.68908907]
curr_Stock_Price:  102.4464583982038
curr_Factors:  [102.4464584   -0.7321957   -0.99586425]
mat_Sqrt:  [[18.19742966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00023367  0.00476148 -0.0296595 ]
Stock Position:  0.00023367394002619113
Bond Position:  [-1.71302814]


portfolio before change:  [-1.68904938]
curr_Stock_Price:  103.53269587625797
curr_Factors:  [103.53269588  -0.92034105  -1.00347982]
mat_Sqrt:  [[15.12072913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00755469 -0.00657573 -0.3016815 ]
Stock Position:  -0.0075546907473495505
Bond Position:  [-0.90689189]


portfolio before change:  [-1.69331686]
curr_Stock_Price:  104.08256718390824
curr_Factors:  [104.08256718  -1.04242313  -1.00882299]
mat_Sqrt:  [[13.3823728   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.19446307 0.4970734  0.52598961]
Stock Position:  0.19446306574738967
Bond Position:  [-21.93353197]


portfolio before change:  [-1.72967311]
curr_Stock_Price:  103.90970975573046
curr_Factors:  [103.90970976  -1.19113005  -1.02129525]
mat_Sqrt:  [[11.37135014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00821257 -0.0161357  -0.08106207]
Stock Position:  -0.008212569213630314
Bond Position:  [-0.87630743]


portfolio before change:  [-1.73447498]
curr_Stock_Price:  104.481068864736
curr_Factors:  [104.48106886  -1.34356833  -1.03880289]
mat_Sqrt:  [[ 9.64688131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00058728 -0.00424511 -0.39260032]
Stock Position:  0.0005872835759363142
Bond Position:  [-1.795835]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.73404093]
Stock Price:  105.60241350023566
PL:  [-7.33645443]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-2.71580311e-02 -7.64740531e-02  1.99451293e-01]
 [ 8.11331859e-02  2.10061933e-01  1.00078839e-02]
 [-5.50356823e-01 -4.30511327e-01  4.47613550e-02]
 [ 2.67503610e-01  1.51401923e+00  1.62121433e+00]
 [-5.58756192e-02  1.04684290e-02  4.79566093e-02]
 [-5.60282118e-02  4.44893349e-01 -2.16284125e-01]
 [-2.06648137e-01  3.32019645e-01  3.39318016e-01]
 [-2.08783790e-02  3.44226741e-02  3.69786394e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 5.97453673e-01  1.41818342e+00 -1.41787854e-01]
 [-1.63080026e-03 -2.16892677e-02  2.02806473e-01]
 [-5.13752604e-01 -5.50255597e-02 -1.18766766e+00]
 [ 2.08933712e+00 -3.06683536e+00  2.61155787e+00]
 [-2.96678029e-03  2.19131404e-02 -2.88602982e-02]
 [ 2.01833104e-02  3.23932914e-01 -1.80137350e-01]
 [ 2.84200336e-02 -2.16653228e-01 -1.68736379e-02]
 [-2.99939190e-01 -1.91038582e+00 -1.93622420e-01]
 [ 3.49613988e-02 -9.74882518e-02  8.32774216e-02]
 [-1.93217320e-01  4.36025286e-01  2.30715707e-01]
 [ 1.90744478e-02  7.94645848e-02 -4.51089532e-02]
 [ 1.04540511e-01 -4.97793979e-02  5.52908259e-02]
 [-1.65363437e-02 -1.06315845e-01 -1.05307726e-01]
 [-2.67200784e-01  9.68442785e-02  1.86196888e-02]
 [ 1.18589978e-01 -1.25084273e-02 -4.18423445e-02]
 [ 3.35410588e-04 -5.03614174e-02  2.27223468e-01]
 [-1.99006857e-01 -1.32898633e-01 -7.36491605e-02]
 [-2.39596619e-01  1.73730861e-01  3.27395363e-01]
 [ 1.86247830e-01  1.79879128e-01  3.34127970e-01]
 [-1.40738848e-01  8.74540448e-02 -2.06932349e-01]
 [ 1.84492430e-01  3.60782536e-02  1.04823659e-01]
 [ 1.21239440e-01 -2.26557657e-03 -8.50210457e-02]
 [ 8.33322347e-02  8.98484666e-02  1.32264630e-01]
 [-4.06485036e-03 -3.32762610e-02  2.04669325e-02]
 [-8.85831845e-02  8.95773519e-02  4.20913030e-02]
 [-9.68135633e-02 -5.48728417e-02 -6.03842130e-02]
 [ 1.69930659e+00  1.09907343e+00  1.44161639e-01]
 [ 8.22699692e-02 -1.17935910e-01  5.55842303e-02]
 [ 3.01823733e-02 -1.51064609e-02 -2.33311742e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.86311782]
curr_Stock_Price:  99.41718761851999
curr_Factors:  [99.41718762 -0.85814563 -1.00894287]
mat_Sqrt:  [[15.36721756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.33752714e-04 -2.46818945e-02  5.68979023e-01]
Stock Position:  -0.00013375271382798473
Bond Position:  [-1.8498205]


portfolio before change:  [-1.86316121]
curr_Stock_Price:  98.01270941062322
curr_Factors:  [98.01270941 -0.87719401 -1.0177331 ]
mat_Sqrt:  [[14.73418126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00855526 0.0677972  0.02854971]
Stock Position:  0.008555259837462085
Bond Position:  [-2.70168541]


portfolio before change:  [-1.8684663]
curr_Stock_Price:  97.43208919424795
curr_Factors:  [97.43208919 -0.78072954 -1.02524405]
mat_Sqrt:  [[16.00949555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03929529 -0.13894693  0.12769169]
Stock Position:  -0.03929528600094321
Bond Position:  [1.96015551]


portfolio before change:  [-1.8884585]
curr_Stock_Price:  97.94709331485834
curr_Factors:  [97.94709331 -0.53456604 -1.02890884]
mat_Sqrt:  [[20.51082085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04424399 0.48864761 4.62487322]
Stock Position:  0.044243986522937255
Bond Position:  [-6.22202838]


portfolio before change:  [-1.93299347]
curr_Stock_Price:  96.95809635625548
curr_Factors:  [96.95809636 -0.60186016 -1.01769336]
mat_Sqrt:  [[19.19645019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00228947  0.00337867  0.13680686]
Stock Position:  -0.002289467990294906
Bond Position:  [-1.71101101]


portfolio before change:  [-1.93424113]
curr_Stock_Price:  97.40962768720755
curr_Factors:  [97.40962769 -0.75515501 -1.02010926]
mat_Sqrt:  [[16.50495734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.67317389e-04  1.43588711e-01 -6.16998406e-01]
Stock Position:  -0.0005673173892961922
Bond Position:  [-1.87897895]


portfolio before change:  [-1.93420107]
curr_Stock_Price:  96.92499737045968
curr_Factors:  [96.92499737 -1.072651   -1.04483773]
mat_Sqrt:  [[11.66331832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00596845  0.10715888  0.96797985]
Stock Position:  -0.005968448189890514
Bond Position:  [-1.35570925]


portfolio before change:  [-1.93054923]
curr_Stock_Price:  96.2847442032468
curr_Factors:  [96.2847442  -0.66932491 -1.02580421]
mat_Sqrt:  [[17.67552239  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035663  0.01110987  0.10548977]
Stock Position:  -0.00035663143307530033
Bond Position:  [-1.89621106]


portfolio before change:  [-1.93092554]
curr_Stock_Price:  96.67525113327882
curr_Factors:  [96.67525113 -0.84784569 -1.02129266]
mat_Sqrt:  [[14.91278777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00348635  0.0064198  -0.11330016]
Stock Position:  0.003486350381879646
Bond Position:  [-2.26796934]


portfolio before change:  [-1.93766901]
curr_Stock_Price:  94.8223234800236
curr_Factors:  [94.82232348 -0.70830407 -0.98863815]
mat_Sqrt:  [[17.37552551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [5.03046222e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  5.030462223205435e-05
Bond Position:  [-1.94243901]


portfolio before change:  [-1.9379062]
curr_Stock_Price:  94.93425814541406
curr_Factors:  [94.93425815 -0.65640535 -0.97710168]
mat_Sqrt:  [[18.53531073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04628985  0.45771673 -0.40448128]
Stock Position:  0.046289854025275676
Bond Position:  [-6.33239915]


portfolio before change:  [-1.90978645]
curr_Stock_Price:  95.5588301448728
curr_Factors:  [95.55883014 -0.70690399 -0.99270852]
mat_Sqrt:  [[17.46378961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202359 -0.00700018  0.57855042]
Stock Position:  0.0020235925489432535
Bond Position:  [-2.10315859]


portfolio before change:  [-1.91030488]
curr_Stock_Price:  95.43256144960137
curr_Factors:  [95.43256145 -0.56965361 -0.97090626]
mat_Sqrt:  [[20.44748653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03753108 -0.01775942 -3.38808525]
Stock Position:  -0.037531082103519575
Bond Position:  [1.67138242]


portfolio before change:  [-1.92152963]
curr_Stock_Price:  95.73720725290696
curr_Factors:  [95.73720725 -0.71960482 -0.98446138]
mat_Sqrt:  [[17.4186386   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11461309 -0.98981686  7.45004767]
Stock Position:  0.11461308976526163
Bond Position:  [-12.89426676]


portfolio before change:  [-2.08986103]
curr_Stock_Price:  94.28257829314573
curr_Factors:  [94.28257829 -0.66215467 -0.98175677]
mat_Sqrt:  [[18.21754221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024069  0.00707244 -0.0823304 ]
Stock Position:  -0.00024069453916415013
Bond Position:  [-2.06716773]


portfolio before change:  [-2.09037282]
curr_Stock_Price:  95.33526457880171
curr_Factors:  [95.33526458 -0.59946234 -0.98879342]
mat_Sqrt:  [[19.47524213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00254351  0.1045489  -0.51388172]
Stock Position:  0.002543509172791751
Bond Position:  [-2.33285894]


portfolio before change:  [-2.09209251]
curr_Stock_Price:  94.77381095044706
curr_Factors:  [94.77381095 -0.53467958 -0.99114115]
mat_Sqrt:  [[20.60785634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093403 -0.06992453 -0.04813579]
Stock Position:  -0.0009340339904479953
Bond Position:  [-2.00357055]


portfolio before change:  [-2.09272769]
curr_Stock_Price:  95.18569935980126
curr_Factors:  [95.18569936 -0.76412511 -0.9959689 ]
mat_Sqrt:  [[16.37467129  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04454551 -0.61657437 -0.55235087]
Stock Position:  -0.04454550930442233
Bond Position:  [2.14736777]


portfolio before change:  [-2.08783649]
curr_Stock_Price:  95.08192319015517
curr_Factors:  [95.08192319 -0.82839717 -0.99079641]
mat_Sqrt:  [[15.41814846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00207941 -0.0314642   0.2375673 ]
Stock Position:  0.0020794082557835966
Bond Position:  [-2.28555062]


portfolio before change:  [-2.08807165]
curr_Stock_Price:  95.10623330468295
curr_Factors:  [95.1062333  -0.84712943 -0.9968112 ]
mat_Sqrt:  [[15.04512284  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00379654  0.14072656  0.65816769]
Stock Position:  -0.0037965383004756577
Bond Position:  [-1.72699719]


portfolio before change:  [-2.08797396]
curr_Stock_Price:  95.0236373363045
curr_Factors:  [95.02363734 -0.86253794 -0.99258945]
mat_Sqrt:  [[14.86483394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175496  0.02564708 -0.12868329]
Stock Position:  0.001754964895600252
Bond Position:  [-2.25473711]


portfolio before change:  [-2.08857507]
curr_Stock_Price:  94.84172557242118
curr_Factors:  [94.84172557 -0.72998451 -1.0101078 ]
mat_Sqrt:  [[16.64512116  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00634814 -0.01606623  0.15772934]
Stock Position:  0.006348138027287616
Bond Position:  [-2.69064343]


portfolio before change:  [-2.08636025]
curr_Stock_Price:  95.2436019411338
curr_Factors:  [95.24360194 -0.5068133  -1.01595556]
mat_Sqrt:  [[20.77330981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287551 -0.03431329 -0.30041363]
Stock Position:  -0.002875508277510569
Bond Position:  [-1.81248649]


portfolio before change:  [-2.08085846]
curr_Stock_Price:  93.25148050148923
curr_Factors:  [93.2514805  -0.30447041 -1.02666741]
mat_Sqrt:  [[24.63485028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00988972  0.03125636  0.05311679]
Stock Position:  -0.009889721186133993
Bond Position:  [-1.15862732]


portfolio before change:  [-2.08401917]
curr_Stock_Price:  93.55642998563249
curr_Factors:  [93.55642999 -0.57129918 -1.02605855]
mat_Sqrt:  [[18.93869255  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00567598 -0.00403708 -0.11936456]
Stock Position:  0.005675981765065904
Bond Position:  [-2.61504376]


portfolio before change:  [-2.08418418]
curr_Stock_Price:  93.58495125559163
curr_Factors:  [93.58495126 -0.57481097 -1.04105477]
mat_Sqrt:  [[18.59706661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0019593  -0.01625408  0.64820531]
Stock Position:  0.001959299620504933
Bond Position:  [-2.26754514]


portfolio before change:  [-2.08473987]
curr_Stock_Price:  93.44601090681145
curr_Factors:  [93.44601091 -0.68132881 -1.0412781 ]
mat_Sqrt:  [[16.68945258  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01445034 -0.04289285 -0.21010056]
Stock Position:  -0.014450339045658634
Bond Position:  [-0.73441333]


portfolio before change:  [-2.07198787]
curr_Stock_Price:  92.55718704906789
curr_Factors:  [92.55718705 -0.37666491 -0.99601778]
mat_Sqrt:  [[23.45641464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00585361  0.05607139  0.93396784]
Stock Position:  -0.005853608001459299
Bond Position:  [-1.53019438]


portfolio before change:  [-2.06693645]
curr_Stock_Price:  91.66155006673536
curr_Factors:  [91.66155007 -0.25091542 -0.98761257]
mat_Sqrt:  [[26.56448042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01096084 0.05805574 0.9531741 ]
Stock Position:  0.010960842633475335
Bond Position:  [-3.07162427]


portfolio before change:  [-2.07887397]
curr_Stock_Price:  90.60747575710954
curr_Factors:  [90.60747576 -0.0995882  -1.01675911]
mat_Sqrt:  [[29.67157193  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00556517  0.02822567 -0.59032039]
Stock Position:  -0.005565167064172746
Bond Position:  [-1.57462823]


portfolio before change:  [-2.07486982]
curr_Stock_Price:  89.85260371251695
curr_Factors:  [89.85260371 -0.29625053 -0.99861568]
mat_Sqrt:  [[24.61372926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00866402 0.01164421 0.29903272]
Stock Position:  0.008664022853501289
Bond Position:  [-2.85335483]


portfolio before change:  [-2.05856783]
curr_Stock_Price:  91.77534546492231
curr_Factors:  [91.77534546 -0.2977497  -1.04071121]
mat_Sqrt:  [[24.06799096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00429708 -0.00073121 -0.24254138]
Stock Position:  0.004297082088916113
Bond Position:  [-2.45293403]


portfolio before change:  [-2.05246035]
curr_Stock_Price:  93.26801337295618
curr_Factors:  [93.26801337 -0.56742635 -1.04994762]
mat_Sqrt:  [[18.5061525   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00695287 0.02899847 0.37731417]
Stock Position:  0.006952870441395017
Bond Position:  [-2.70094077]


portfolio before change:  [-2.05653655]
curr_Stock_Price:  92.73031311425947
curr_Factors:  [92.73031311 -0.78757101 -1.05698137]
mat_Sqrt:  [[14.66029818  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045562 -0.01073987  0.05838646]
Stock Position:  -0.00045562126437561344
Bond Position:  [-2.01428665]


portfolio before change:  [-2.05660652]
curr_Stock_Price:  92.33123403400377
curr_Factors:  [92.33123403 -0.85981861 -1.00869343]
mat_Sqrt:  [[14.25161802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432978  0.02891097  0.12007477]
Stock Position:  -0.004329784366623949
Bond Position:  [-1.65683219]


portfolio before change:  [-2.06221422]
curr_Stock_Price:  93.57854244276886
curr_Factors:  [93.57854244 -0.81261519 -1.01186588]
mat_Sqrt:  [[15.094343    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00797254 -0.01771013 -0.17225935]
Stock Position:  -0.007972543826945937
Bond Position:  [-1.31615519]


portfolio before change:  [-2.0664196]
curr_Stock_Price:  94.08538884862581
curr_Factors:  [94.08538885 -0.79980359 -0.98350584]
mat_Sqrt:  [[15.81396376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.12350356 0.35472442 0.41125303]
Stock Position:  0.1235035637182783
Bond Position:  [-13.68630042]


portfolio before change:  [-1.97129139]
curr_Stock_Price:  94.8694885550018
curr_Factors:  [94.86948856 -0.91519673 -0.96621876]
mat_Sqrt:  [[14.45566881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00481074 -0.03806365  0.15856634]
Stock Position:  0.004810741494546348
Bond Position:  [-2.42768397]


portfolio before change:  [-1.97285494]
curr_Stock_Price:  94.60755937149347
curr_Factors:  [94.60755937 -0.83453755 -0.96122147]
mat_Sqrt:  [[15.70498784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00142224 -0.00487559 -0.06655735]
Stock Position:  0.001422243948994962
Bond Position:  [-2.10740997]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.97222582]
Stock Price:  95.23513240851693
PL:  [-1.97222582]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-9.37105749e-03 -1.01931639e-01  9.67302940e-02]
 [ 1.03596005e+00  2.24021824e-01  2.91925972e-01]
 [-3.51432962e-01 -2.37016390e-01  4.00474214e-02]
 [ 2.01854252e-01  1.39890224e+00  1.26897990e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 1.11737675e-02  9.48923185e-02 -2.72269642e-02]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [-1.96765017e-02  3.19188101e-02  3.79935490e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 8.77643789e-01  1.82245435e+00 -2.71394182e-01]
 [-2.07020979e-03 -1.37765711e-01  2.91971393e-01]
 [-2.22584119e-01  5.29503419e-03 -4.61690507e-01]
 [ 1.68077582e+00 -2.90969061e+00  2.44806459e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.09267161e-01  6.46121301e-02 -6.51602841e-02]
 [-7.99445710e-02 -4.98820276e-02 -5.83016410e-02]
 [-2.81223049e-01 -1.82146929e+00 -2.00004577e-01]
 [ 5.31903292e-03  3.19650413e-02  3.32010066e-02]
 [ 2.10160982e-01 -3.29493955e-01  1.80102164e-01]
 [ 5.04814104e-02  1.81039803e-02  4.47068623e-02]
 [ 1.54670282e-01 -5.51218467e-02 -1.97131670e-02]
 [ 3.75254948e-01  7.52297711e-02  1.61085768e-01]
 [-1.07918643e-01 -1.91160591e-02  6.55419153e-02]
 [ 2.14342192e-02 -1.09744803e-01  2.54954166e-02]
 [ 5.30430112e-02 -7.52235709e-03  1.41507125e-01]
 [ 2.23614771e-01 -9.20628938e-02  9.17726848e-02]
 [-7.79188442e-02  4.54437152e-02  1.26339742e-01]
 [-9.06111270e-03 -7.45085852e-02 -2.39476809e-03]
 [ 1.03317036e-01 -1.75947791e-02  7.49041382e-02]
 [-2.09301328e-02 -3.04388619e-02 -5.51796193e-02]
 [-9.94248181e-03  2.00327989e-02 -5.61539139e-02]
 [-1.15532978e-01 -3.86286506e-02  2.26692858e-02]
 [ 3.15397162e-01  3.72283878e-02  6.55726478e-02]
 [ 6.93989310e-02  6.78588591e-03 -3.15028332e-02]
 [-9.17496543e-02 -2.29048082e-02 -1.11328676e-01]
 [ 1.88482894e+00  1.30569640e+00  1.69037421e-01]
 [-2.99042516e-02 -3.62120327e-02 -2.88618514e-02]
 [ 3.43547549e-02 -1.39373484e-02 -9.34495191e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.11883298]
curr_Stock_Price:  99.68764779455132
curr_Factors:  [99.68764779 -0.96168485 -1.01338067]
mat_Sqrt:  [[13.83188253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075426 -0.0328983   0.2759446 ]
Stock Position:  -0.0007542557974951044
Bond Position:  [0.19402296]


portfolio before change:  [0.11852326]
curr_Stock_Price:  100.13042712430206
curr_Factors:  [100.13042712  -0.98719501  -1.0169636 ]
mat_Sqrt:  [[13.49494266  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08457075 0.07230273 0.83278354]
Stock Position:  0.08457075260432734
Bond Position:  [-8.34958232]


portfolio before change:  [0.03247189]
curr_Stock_Price:  99.12526153362374
curr_Factors:  [99.12526153 -1.0004978  -1.02729427]
mat_Sqrt:  [[13.04744398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03001654 -0.07649671  0.11424415]
Stock Position:  -0.030016536937731684
Bond Position:  [3.00786896]


portfolio before change:  [0.02932293]
curr_Stock_Price:  99.24269548622387
curr_Factors:  [99.24269549 -0.94429369 -1.04302328]
mat_Sqrt:  [[13.60246945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05487485 0.45149376 3.62004644]
Stock Position:  0.05487484571020913
Bond Position:  [-5.41660467]


portfolio before change:  [0.07720414]
curr_Stock_Price:  100.12758778762397
curr_Factors:  [100.12758779  -0.98155807  -1.02284995]
mat_Sqrt:  [[13.49119485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00434698 -0.01106097 -0.05874131]
Stock Position:  -0.004346983465112354
Bond Position:  [0.51245711]


portfolio before change:  [0.07845329]
curr_Stock_Price:  99.85496448941264
curr_Factors:  [99.85496449 -0.74386213 -1.03587053]
mat_Sqrt:  [[16.84385876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148338  0.03062636 -0.07767095]
Stock Position:  0.0014833833769791432
Bond Position:  [-0.0696699]


portfolio before change:  [0.07754136]
curr_Stock_Price:  99.24607012073042
curr_Factors:  [99.24607012 -0.52866998 -1.01669835]
mat_Sqrt:  [[21.1625687   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313243 -0.00251018 -0.21167328]
Stock Position:  -0.0031324327339182943
Bond Position:  [0.388423]


portfolio before change:  [0.08429351]
curr_Stock_Price:  97.10601181208656
curr_Factors:  [97.10601181 -0.27161038 -1.02051263]
mat_Sqrt:  [[26.67375924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00020266  0.01030175  0.10838502]
Stock Position:  -0.00020265989206665668
Bond Position:  [0.103973]


portfolio before change:  [0.08432614]
curr_Stock_Price:  97.00910299274194
curr_Factors:  [97.00910299 -0.15706447 -1.02496582]
mat_Sqrt:  [[29.74837561  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017477   0.0064198  -0.11330016]
Stock Position:  0.0017476989005979957
Bond Position:  [-0.08521656]


portfolio before change:  [0.08443827]
curr_Stock_Price:  97.07935223206279
curr_Factors:  [ 9.70793522e+01 -1.08898162e-02 -1.00554571e+00]
mat_Sqrt:  [[35.13132505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.48800535e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  2.4880053508806702e-05
Bond Position:  [0.08202293]


portfolio before change:  [0.08444538]
curr_Stock_Price:  96.95340025632369
curr_Factors:  [96.95340026 -0.18691703 -0.9895555 ]
mat_Sqrt:  [[29.89699359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03994558  0.58819461 -0.77421206]
Stock Position:  0.039945575675588804
Bond Position:  [-3.788414]


portfolio before change:  [0.07522237]
curr_Stock_Price:  96.73436644382703
curr_Factors:  [96.73436644 -0.24929327 -0.99650171]
mat_Sqrt:  [[27.83164681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0010566  -0.04446369  0.83291311]
Stock Position:  0.0010565991060214768
Bond Position:  [-0.02698707]


portfolio before change:  [0.07942795]
curr_Stock_Price:  100.71785281637229
curr_Factors:  [100.71785282  -0.47062023  -1.02414615]
mat_Sqrt:  [[22.59111522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01397653  0.00170896 -1.31707451]
Stock Position:  -0.013976532456973967
Bond Position:  [1.48711429]


portfolio before change:  [0.08875037]
curr_Stock_Price:  100.0641479266084
curr_Factors:  [100.06414793  -0.32136742  -1.02835407]
mat_Sqrt:  [[25.94788143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0611436  -0.93909861  6.98364687]
Stock Position:  0.06114359704424415
Bond Position:  [-6.02953156]


portfolio before change:  [0.11765527]
curr_Stock_Price:  100.54921316880198
curr_Factors:  [100.54921317  -0.44542083  -1.03354131]
mat_Sqrt:  [[22.91255809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094574 -0.03053791  0.10625201]
Stock Position:  -0.0009457421907851133
Bond Position:  [0.2127489]


portfolio before change:  [0.11896726]
curr_Stock_Price:  99.1900762954545
curr_Factors:  [99.1900763  -0.43458547 -1.04035765]
mat_Sqrt:  [[22.69387021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0048099   0.02085348 -0.18588415]
Stock Position:  0.004809901043049395
Bond Position:  [-0.35812719]


portfolio before change:  [0.12581832]
curr_Stock_Price:  100.62375088903423
curr_Factors:  [100.62375089  -0.61929943  -1.04672003]
mat_Sqrt:  [[19.01767589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00536488 -0.01609936 -0.16631835]
Stock Position:  -0.005364875840323909
Bond Position:  [0.66565225]


portfolio before change:  [0.13135774]
curr_Stock_Price:  99.60672740571947
curr_Factors:  [99.60672741 -0.49667126 -1.03402905]
mat_Sqrt:  [[21.55330991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03219249 -0.58787669 -0.57055739]
Stock Position:  -0.03219248816999188
Bond Position:  [3.33794613]


portfolio before change:  [0.1078851]
curr_Stock_Price:  100.3488229934665
curr_Factors:  [100.34882299  -0.41946364  -1.03451926]
mat_Sqrt:  [[23.4452858   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00079423 0.01031667 0.09471323]
Stock Position:  0.0007942320222175404
Bond Position:  [0.02818486]


portfolio before change:  [0.10958249]
curr_Stock_Price:  102.48152901890484
curr_Factors:  [102.48152902  -0.41831157  -1.07346389]
mat_Sqrt:  [[23.05556377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00779276 -0.10634372  0.51378134]
Stock Position:  0.007792761527259668
Bond Position:  [-0.68903162]


portfolio before change:  [0.10653475]
curr_Stock_Price:  102.10148311556584
curr_Factors:  [102.10148312  -0.31875134  -1.0716139 ]
mat_Sqrt:  [[25.42167135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0024901  0.00584303 0.12753623]
Stock Position:  0.002490104566260083
Bond Position:  [-0.14770862]


portfolio before change:  [0.10707525]
curr_Stock_Price:  102.32595624272633
curr_Factors:  [102.32595624  -0.35090291  -1.09115737]
mat_Sqrt:  [[24.19396194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00576155 -0.0177905  -0.05623618]
Stock Position:  0.005761546990239135
Bond Position:  [-0.48248056]


portfolio before change:  [0.09598926]
curr_Stock_Price:  100.41229122701013
curr_Factors:  [100.41229123  -0.36901362  -1.0856825 ]
mat_Sqrt:  [[23.44338823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01806448 0.0242803  0.45953286]
Stock Position:  0.01806448159432643
Bond Position:  [-1.71790672]


portfolio before change:  [0.09334337]
curr_Stock_Price:  100.27770987452719
curr_Factors:  [100.27770987  -0.41359382  -1.08375658]
mat_Sqrt:  [[22.43434477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.004388   -0.00616968  0.18697284]
Stock Position:  -0.004388004472278495
Bond Position:  [0.53336241]


portfolio before change:  [0.09673374]
curr_Stock_Price:  99.52025953045835
curr_Factors:  [99.52025953 -0.40638293 -1.07469975]
mat_Sqrt:  [[22.63004734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00018722 -0.03541998  0.07273133]
Stock Position:  0.00018722387545438602
Bond Position:  [0.07810117]


portfolio before change:  [0.09705506]
curr_Stock_Price:  101.18433776662012
curr_Factors:  [101.18433777  -0.53508617  -1.08097054]
mat_Sqrt:  [[20.10336621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00399896 -0.00242783  0.40368044]
Stock Position:  0.003998959012507049
Bond Position:  [-0.30757696]


portfolio before change:  [0.09492077]
curr_Stock_Price:  100.66024234268538
curr_Factors:  [100.66024234  -0.78455509  -1.03862655]
mat_Sqrt:  [[16.25774278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01375071 -0.02971317  0.26180193]
Stock Position:  0.013750711616361466
Bond Position:  [-1.28922919]


portfolio before change:  [0.10030896]
curr_Stock_Price:  101.06381100855927
curr_Factors:  [101.06381101  -0.71332744  -1.04202394]
mat_Sqrt:  [[17.46852565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245319  0.0146669   0.36041212]
Stock Position:  -0.0024531946031181875
Bond Position:  [0.34823816]


portfolio before change:  [0.09655241]
curr_Stock_Price:  102.61284649505318
curr_Factors:  [102.6128465   -0.81509059  -1.04967611]
mat_Sqrt:  [[15.89804968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155736 -0.02404754 -0.00683161]
Stock Position:  -0.0015573573147135314
Bond Position:  [0.25635728]


portfolio before change:  [0.09614002]
curr_Stock_Price:  102.89822640256122
curr_Factors:  [102.8982264  -0.8102253  -1.0775177]
mat_Sqrt:  [[15.58014595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00738217 -0.00567869  0.21368066]
Stock Position:  0.007382168337213507
Bond Position:  [-0.66347201]


portfolio before change:  [0.08740363]
curr_Stock_Price:  101.72601695911732
curr_Factors:  [101.72601696  -0.52714656  -1.08990279]
mat_Sqrt:  [[20.19093507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190219 -0.0098241  -0.15741209]
Stock Position:  -0.0019021868944760015
Bond Position:  [0.28090553]


portfolio before change:  [0.09002665]
curr_Stock_Price:  100.36552725236716
curr_Factors:  [100.36552725  -0.51674171  -1.05139956]
mat_Sqrt:  [[20.91941175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00082773  0.00646556 -0.16019149]
Stock Position:  -0.0008277323353609874
Bond Position:  [0.17310245]


portfolio before change:  [0.08909434]
curr_Stock_Price:  101.518010323343
curr_Factors:  [101.51801032  -0.44709479  -1.05353166]
mat_Sqrt:  [[22.63754403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524751 -0.01246734  0.06466916]
Stock Position:  -0.005247506945725992
Bond Position:  [0.62181081]


portfolio before change:  [0.08337477]
curr_Stock_Price:  102.62278281580721
curr_Factors:  [102.62278282  -0.61697484  -1.08994283]
mat_Sqrt:  [[18.61825021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01806729 0.01201541 0.18706051]
Stock Position:  0.018067290511923274
Bond Position:  [-1.77074086]


portfolio before change:  [0.08308262]
curr_Stock_Price:  102.61886422591422
curr_Factors:  [102.61886423  -0.46993251  -1.09759402]
mat_Sqrt:  [[21.40223268  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00300686  0.00219014 -0.08986881]
Stock Position:  0.003006864106650791
Bond Position:  [-0.22547836]


portfolio before change:  [0.08493536]
curr_Stock_Price:  103.24441009971319
curr_Factors:  [103.2444101   -0.53331696  -1.09781406]
mat_Sqrt:  [[20.20576734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00589683 -0.0073925  -0.31758972]
Stock Position:  -0.005896828734372119
Bond Position:  [0.69374997]


portfolio before change:  [0.08396125]
curr_Stock_Price:  103.42431081210182
curr_Factors:  [103.42431081  -0.45946487  -1.08983952]
mat_Sqrt:  [[21.96687545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09950699 0.4214117  0.48221671]
Stock Position:  0.09950699304730722
Bond Position:  [-10.20748093]


portfolio before change:  [-0.07358396]
curr_Stock_Price:  101.85387655724519
curr_Factors:  [101.85387656  -0.33692432  -1.07877357]
mat_Sqrt:  [[24.72565377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174666 -0.01168738 -0.08233483]
Stock Position:  -0.0017466637279927265
Bond Position:  [0.10432051]


portfolio before change:  [-0.07025473]
curr_Stock_Price:  99.95529003742718
curr_Factors:  [99.95529004 -0.27687747 -1.10254875]
mat_Sqrt:  [[25.16103981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004942  -0.00449826 -0.26658547]
Stock Position:  0.0004941966804334915
Bond Position:  [-0.1196523]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.07033874]
Stock Price:  99.8155603494042
PL:  [-0.07033874]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 4.64689184e-02 -7.74566772e-02 -9.58811807e-03]
 [ 9.73951789e-01  2.15566123e-01  2.67336876e-01]
 [-3.20728562e-01 -2.08753625e-01  3.91518178e-02]
 [ 2.24170716e-01  1.16877655e+00  1.33767074e+00]
 [-4.78967090e-02 -3.18853014e-02 -1.69357977e-02]
 [-7.74714060e-02  5.91519872e-01 -3.07459700e-01]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [-4.34816270e-02  8.15118909e-02  1.78916201e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 8.83852757e-01  1.78276567e+00 -2.86522524e-01]
 [-1.54830703e-04  1.43626901e-02 -5.77006318e-02]
 [-1.00141581e-01 -8.24904119e-03 -2.34023786e-01]
 [ 1.55470185e+00 -2.97617440e+00  2.49133581e+00]
 [-9.95827626e-03 -9.46182595e-02  3.72458374e-02]
 [ 1.41183010e-01 -7.82360762e-02  1.80486957e-02]
 [-1.56302701e-01 -2.14798277e-01 -2.99667613e-02]
 [-2.62926284e-01 -1.72656475e+00 -2.03360974e-01]
 [ 1.16792819e-04  3.39134167e-02  7.83512991e-02]
 [ 1.84012879e-01 -2.08775273e-01  2.33246436e-01]
 [ 4.95492789e-02  5.23578350e-03  6.55689310e-02]
 [ 1.47943095e-01 -5.43775824e-02 -1.72076487e-02]
 [ 3.19460951e-01  2.04397261e-01  2.31906234e-01]
 [-2.50343060e-01  8.94178256e-02  2.97254503e-02]
 [-9.49534730e-02 -2.83899988e-01  1.04774072e-01]
 [ 1.26580026e-01 -2.97926903e-02 -1.23920765e-01]
 [ 3.51260186e-01 -4.90592302e-02  1.97830895e-01]
 [-6.71661740e-02  5.40768109e-02  1.14689495e-01]
 [-1.16850515e-02 -7.70522285e-02 -6.79946444e-03]
 [ 7.34398013e-02 -1.09058023e-03  8.68355580e-02]
 [-2.15609135e-02 -6.06675002e-02 -3.55263630e-02]
 [ 6.71462840e-02  1.82820104e-02 -6.78355817e-02]
 [-1.18069121e-01 -3.87448071e-02  2.12500833e-02]
 [ 3.18087874e-01  2.59240728e-02  5.67225953e-02]
 [ 1.02639258e-02  4.54534563e-02 -3.09414759e-02]
 [-1.10622778e-01 -4.94719073e-02 -9.89405723e-02]
 [ 2.07148484e+00  1.34384118e+00  1.60969812e-01]
 [-2.35604470e-02 -7.11809086e-02 -3.43276091e-02]
 [ 3.56821443e-02 -1.33215644e-02 -1.19748955e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.07288724]
curr_Stock_Price:  100.3636859637727
curr_Factors:  [100.36368596  -1.04126349  -1.04947335]
mat_Sqrt:  [[12.40455327  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00231375 -0.02499904 -0.02735223]
Stock Position:  0.002313745065832638
Bond Position:  [4.84067126]


portfolio before change:  [5.07286008]
curr_Stock_Price:  100.09041468051129
curr_Factors:  [100.09041468  -0.90225137  -1.04661105]
mat_Sqrt:  [[14.25647961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07523063 0.06957367 0.7626377 ]
Stock Position:  0.07523063058224609
Bond Position:  [-2.45700493]


portfolio before change:  [5.03718571]
curr_Stock_Price:  99.62029728722044
curr_Factors:  [99.62029729 -0.45985714 -1.06004912]
mat_Sqrt:  [[21.79018575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01630773 -0.06737494  0.11168924]
Stock Position:  -0.016307726349740228
Bond Position:  [6.66176626]


portfolio before change:  [5.05068076]
curr_Stock_Price:  98.8438387945235
curr_Factors:  [98.84383879 -0.3633566  -1.04830842]
mat_Sqrt:  [[24.09191238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03054125 0.37722101 3.81600229]
Stock Position:  0.030541250339180648
Bond Position:  [2.03186633]


portfolio before change:  [5.03753862]
curr_Stock_Price:  98.40521444405766
curr_Factors:  [98.40521444 -0.29645046 -1.02507606]
mat_Sqrt:  [[26.247409    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220449 -0.01029094 -0.04831312]
Stock Position:  -0.0022044947038908627
Bond Position:  [5.25447239]


portfolio before change:  [5.04226838]
curr_Stock_Price:  96.55766665428952
curr_Factors:  [96.55766665 -0.34472952 -1.03749489]
mat_Sqrt:  [[24.23786313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.04025760e-04  1.90912218e-01 -8.77096944e-01]
Stock Position:  -0.0008040257599861669
Bond Position:  [5.11990323]


portfolio before change:  [5.0415348]
curr_Stock_Price:  98.26608062011069
curr_Factors:  [98.26608062 -0.19259002 -1.05001752]
mat_Sqrt:  [[28.36259993  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233724 -0.00251018 -0.21167328]
Stock Position:  -0.0023372442262965224
Bond Position:  [5.27120663]


portfolio before change:  [5.04088884]
curr_Stock_Price:  98.82438755841422
curr_Factors:  [98.82438756 -0.30052803 -1.04786244]
mat_Sqrt:  [[25.66052802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090376  0.02630785  0.05103981]
Stock Position:  -0.0009037604468748126
Bond Position:  [5.13020241]


portfolio before change:  [5.04195771]
curr_Stock_Price:  98.35130528266369
curr_Factors:  [98.35130528 -0.29094143 -1.04738833]
mat_Sqrt:  [[25.7959127   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00201548  0.0064198  -0.11330016]
Stock Position:  0.002015482217972367
Bond Position:  [4.8437324]


portfolio before change:  [5.04495111]
curr_Stock_Price:  99.53608371901369
curr_Factors:  [99.53608372 -0.27638202 -1.02225445]
mat_Sqrt:  [[27.16376081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.21777700e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  3.217776998114722e-05
Bond Position:  [5.04174826]


portfolio before change:  [5.0455364]
curr_Stock_Price:  98.13858733032642
curr_Factors:  [98.13858733 -0.48152723 -1.02197676]
mat_Sqrt:  [[21.82108377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05450106  0.57538515 -0.81736901]
Stock Position:  0.05450105608426124
Bond Position:  [-0.30312025]


portfolio before change:  [5.2676388]
curr_Stock_Price:  102.21447693898176
curr_Factors:  [102.21447694  -0.75348335  -1.0133369 ]
mat_Sqrt:  [[17.46594654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051535  0.00463554 -0.16460384]
Stock Position:  -0.0005153543207879964
Bond Position:  [5.32031547]


portfolio before change:  [5.26802037]
curr_Stock_Price:  102.76459584077986
curr_Factors:  [102.76459584  -0.77352802  -0.99921793]
mat_Sqrt:  [[17.45620095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00856975 -0.00266237 -0.66760472]
Stock Position:  -0.008569752104422153
Bond Position:  [6.14868749]


portfolio before change:  [5.26522237]
curr_Stock_Price:  103.18078465992895
curr_Factors:  [103.18078466  -0.72274879  -0.99370529]
mat_Sqrt:  [[18.54181697  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07851089 -0.96055616  7.10708761]
Stock Position:  0.0785108920383548
Bond Position:  [-2.83559307]


portfolio before change:  [5.29175366]
curr_Stock_Price:  103.52323084409382
curr_Factors:  [103.52323084  -0.68142995  -1.00029445]
mat_Sqrt:  [[19.26079421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112505 -0.03053791  0.10625201]
Stock Position:  -0.0011250508489035792
Bond Position:  [5.40822256]


portfolio before change:  [5.29287153]
curr_Stock_Price:  103.1305354287433
curr_Factors:  [103.13053543  -0.65618935  -1.02284903]
mat_Sqrt:  [[19.23933987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00669967 -0.02525059  0.05148791]
Stock Position:  0.006699674365585076
Bond Position:  [4.60193052]


portfolio before change:  [5.29133773]
curr_Stock_Price:  102.81573227800077
curr_Factors:  [102.81573228  -0.77696954  -1.04888261]
mat_Sqrt:  [[16.56159127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01245443 -0.06932585 -0.08548683]
Stock Position:  -0.012454428570994313
Bond Position:  [6.57184892]


portfolio before change:  [5.28640269]
curr_Stock_Price:  103.2779426473588
curr_Factors:  [103.27794265  -0.72458451  -1.04988272]
mat_Sqrt:  [[17.51322994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03750711 -0.55724638 -0.58013225]
Stock Position:  -0.03750711460026205
Bond Position:  [9.16006032]


portfolio before change:  [5.30888384]
curr_Stock_Price:  102.7090889262859
curr_Factors:  [102.70908893  -0.83672738  -1.02627588]
mat_Sqrt:  [[15.94104683  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00144487 0.01094551 0.22351445]
Stock Position:  0.0014448694756003248
Bond Position:  [5.16048261]


portfolio before change:  [5.3078348]
curr_Stock_Price:  101.53656949970825
curr_Factors:  [101.5365695   -0.63959374  -1.06140893]
mat_Sqrt:  [[18.53046911  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01019985 -0.06738193  0.66538716]
Stock Position:  0.010199851565679638
Bond Position:  [4.27217686]


portfolio before change:  [5.31307699]
curr_Stock_Price:  101.99815772324898
curr_Factors:  [101.99815772  -0.6331362   -1.0589942 ]
mat_Sqrt:  [[18.78059867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00340789 0.00168984 0.18704991]
Stock Position:  0.003407890868857952
Bond Position:  [4.96547839]


portfolio before change:  [5.31386909]
curr_Stock_Price:  102.04844787105033
curr_Factors:  [102.04844787  -0.47352433  -1.03069639]
mat_Sqrt:  [[22.67418298  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00588029 -0.01755029 -0.04908863]
Stock Position:  0.00588029216487794
Bond Position:  [4.7137944]


portfolio before change:  [5.31985665]
curr_Stock_Price:  102.96648046858206
curr_Factors:  [102.96648047  -0.56009916  -1.05740914]
mat_Sqrt:  [[20.42776906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01999832 0.06596893 0.66156393]
Stock Position:  0.019998318338777906
Bond Position:  [3.2607002]


portfolio before change:  [5.31721682]
curr_Stock_Price:  102.81409546030544
curr_Factors:  [102.81409546  -0.33965305  -1.03470904]
mat_Sqrt:  [[26.01206241  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00868916  0.02885948  0.08479844]
Stock Position:  -0.008689162649825893
Bond Position:  [6.21058522]


portfolio before change:  [5.30643961]
curr_Stock_Price:  104.14374947250967
curr_Factors:  [104.14374947  -0.51669281  -1.04784734]
mat_Sqrt:  [[21.78522528  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.006037   -0.09162833  0.29889126]
Stock Position:  -0.006036999649311656
Bond Position:  [5.93515539]


portfolio before change:  [5.30494513]
curr_Stock_Price:  104.51420204235598
curr_Factors:  [104.51420204  -0.58350953  -1.02447087]
mat_Sqrt:  [[20.93332866  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00454793 -0.00961555 -0.35351145]
Stock Position:  0.004547934048624565
Bond Position:  [4.82962143]


portfolio before change:  [5.30119638]
curr_Stock_Price:  103.55717552962122
curr_Factors:  [103.55717553  -0.65067887  -1.02563861]
mat_Sqrt:  [[19.3715675   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01970042 -0.0158338   0.56435648]
Stock Position:  0.019700423074487175
Bond Position:  [3.26107621]


portfolio before change:  [5.29084794]
curr_Stock_Price:  103.01119217129724
curr_Factors:  [103.01119217  -0.65901906  -1.02449477]
mat_Sqrt:  [[19.13126319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00171013  0.01745322  0.32717721]
Stock Position:  -0.0017101273248966574
Bond Position:  [5.46701019]


portfolio before change:  [5.29062966]
curr_Stock_Price:  103.53846182149252
curr_Factors:  [103.53846182  -0.63668893  -1.02784982]
mat_Sqrt:  [[19.59754706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146963 -0.0248685  -0.01939698]
Stock Position:  -0.0014696332402848135
Bond Position:  [5.44279322]


portfolio before change:  [5.29274231]
curr_Stock_Price:  102.56388917745463
curr_Factors:  [102.56388918  -0.77695222  -1.00664439]
mat_Sqrt:  [[17.23408826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00527689 -0.00035198  0.24771768]
Stock Position:  0.005276891950950054
Bond Position:  [4.75152375]


portfolio before change:  [5.29885271]
curr_Stock_Price:  103.60928162095337
curr_Factors:  [103.60928162  -0.47837172  -1.00077983]
mat_Sqrt:  [[23.60539699  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174521 -0.01958035 -0.10134682]
Stock Position:  -0.0017452112179199256
Bond Position:  [5.47967279]


portfolio before change:  [5.29749374]
curr_Stock_Price:  104.78047163124221
curr_Factors:  [104.78047163  -0.5946792   -0.99239472]
mat_Sqrt:  [[21.43003618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00266127  0.00590049 -0.19351603]
Stock Position:  0.0026612742559590534
Bond Position:  [5.01864417]


portfolio before change:  [5.29472336]
curr_Stock_Price:  103.50373294221103
curr_Factors:  [103.50373294  -0.31389283  -0.98196558]
mat_Sqrt:  [[28.32512634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429443 -0.01250483  0.06062057]
Stock Position:  -0.004294428020920064
Bond Position:  [5.73921269]


portfolio before change:  [5.29781203]
curr_Stock_Price:  102.95156902582394
curr_Factors:  [102.95156903  -0.33358376  -0.98961945]
mat_Sqrt:  [[27.41404468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01221848 0.00836696 0.16181378]
Stock Position:  0.012218483558368541
Bond Position:  [4.03989998]


portfolio before change:  [5.29128075]
curr_Stock_Price:  102.37569530958433
curr_Factors:  [102.37569531  -0.48516475  -0.97157285]
mat_Sqrt:  [[23.85304161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00055449  0.01467004 -0.08826742]
Stock Position:  0.0005544857375081405
Bond Position:  [5.23451489]


portfolio before change:  [5.2913906]
curr_Stock_Price:  101.39369099114566
curr_Factors:  [101.39369099  -0.31139033  -0.98222038]
mat_Sqrt:  [[27.81012512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00506712 -0.01596699 -0.28224991]
Stock Position:  -0.005067123860694272
Bond Position:  [5.80516499]


portfolio before change:  [5.29601018]
curr_Stock_Price:  100.62522963883471
curr_Factors:  [100.62522964  -0.1973076   -0.9861743 ]
mat_Sqrt:  [[30.81252073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07719761 0.43372288 0.45920207]
Stock Position:  0.07719761444890043
Bond Position:  [-2.4720175]


portfolio before change:  [5.29086821]
curr_Stock_Price:  100.5626248408579
curr_Factors:  [100.56262484  -0.36727533  -0.95740329]
mat_Sqrt:  [[26.73843484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168661 -0.02297354 -0.09792711]
Stock Position:  -0.001686608928993303
Bond Position:  [5.46047804]


portfolio before change:  [5.28696028]
curr_Stock_Price:  103.2843828119252
curr_Factors:  [103.28438281  -0.62987923  -0.94412194]
mat_Sqrt:  [[21.4020137   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00039806 -0.00429952 -0.34161044]
Stock Position:  0.0003980577878596312
Bond Position:  [5.24584712]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.28784572]
Stock Price:  103.86136046450038
PL:  [1.42648525]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-3.06262564e-02 -6.73562685e-02  2.23624371e-01]
 [ 1.44451435e+00  3.18051344e-01  4.63210678e-01]
 [-1.07770691e-02  8.63408232e-02  3.50121780e-02]
 [ 4.69937301e-02  3.70798174e-01  2.99557904e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 7.64027730e-02  4.83210137e-02 -4.54519616e-03]
 [-4.14822026e-02 -5.94537811e-02 -3.96627446e-02]
 [ 8.25904412e-02  1.22531973e-01 -5.63747012e-02]
 [ 3.18207653e-02  4.60980433e-02 -4.36980311e-02]
 [-9.05584143e-02 -4.36392131e-02 -8.96955611e-03]
 [ 9.25444826e-01  1.79251586e+00 -3.18424373e-01]
 [-5.44170491e-04  8.91701132e-03  2.76853125e-02]
 [-2.94676045e-01  3.13290435e-03 -6.40629083e-01]
 [ 1.68899424e+00 -3.02878020e+00  2.54585219e+00]
 [ 8.69260188e-03 -9.14741784e-02  3.53119069e-02]
 [ 1.31461310e-01 -7.84689530e-03 -3.09332227e-02]
 [-1.32609757e-01 -1.63996355e-01 -3.92206515e-02]
 [-2.70124095e-01 -1.76327752e+00 -2.01815918e-01]
 [ 1.30094623e-03  3.72499194e-02  5.83893053e-02]
 [ 3.24510276e-01 -4.92541280e-01  2.45213348e-01]
 [ 6.14901151e-02  1.79762028e-01 -1.23428213e-01]
 [-1.69517327e-01 -5.05829236e-02 -1.53029966e-01]
 [ 4.06309937e-01  2.55247350e-01  2.88755742e-01]
 [-2.22780368e-01  7.72754370e-02  4.78835770e-02]
 [-1.07978049e-02 -1.70581342e-01  5.30014874e-02]
 [ 5.25853934e-02 -4.11879939e-02  2.95996435e-01]
 [-2.00165373e-01 -1.34102028e-01 -7.38407396e-02]
 [-1.86258008e-01  1.34892584e-01  2.65757327e-01]
 [ 1.10511225e-01  1.11796450e-01  2.77939505e-01]
 [-1.62970536e-01  1.19022440e-01 -6.15336278e-02]
 [ 1.20540594e-01  6.69184817e-03  1.22157222e-02]
 [ 7.05101646e-02 -2.11273101e-03 -7.12439168e-02]
 [ 1.47501965e-01  1.22422294e-01  1.57561896e-01]
 [-4.36461212e-03 -4.07771176e-02  5.16452188e-03]
 [-9.55367230e-02  1.14645147e-01  2.94297508e-02]
 [-1.03613793e-01 -5.86092231e-02 -6.68981696e-02]
 [ 1.64542392e+00  1.06632719e+00  1.42252771e-01]
 [ 1.11613826e-01 -1.86042836e-01  7.03359656e-02]
 [ 2.91057908e-02 -1.56164899e-02 -6.94073835e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.16448131]
curr_Stock_Price:  99.69387703868361
curr_Factors:  [99.69387704 -0.82081929 -0.99017968]
mat_Sqrt:  [[16.29902496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.80314487e-05 -2.17391422e-02  6.37938086e-01]
Stock Position:  7.803144870674128e-05
Bond Position:  [0.15670205]


portfolio before change:  [0.16462683]
curr_Stock_Price:  101.30773360048181
curr_Factors:  [101.3077336   -0.81132481  -0.9745033 ]
mat_Sqrt:  [[16.98506861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09443523 0.10265063 1.32141113]
Stock Position:  0.09443522594572938
Bond Position:  [-9.40239189]


portfolio before change:  [0.15874073]
curr_Stock_Price:  101.25785043492624
curr_Factors:  [101.25785043  -0.75827182  -0.99164743]
mat_Sqrt:  [[17.59739689  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00079523 0.02786638 0.09988   ]
Stock Position:  0.0007952317411259346
Bond Position:  [0.07821727]


portfolio before change:  [0.15982786]
curr_Stock_Price:  102.61262433672663
curr_Factors:  [102.61262434  -0.7500956   -1.00469804]
mat_Sqrt:  [[17.74612755  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01035886 0.1196746  0.85455532]
Stock Position:  0.010358856665508703
Bond Position:  [-0.9031216]


portfolio before change:  [0.1624988]
curr_Stock_Price:  102.8813639573495
curr_Factors:  [102.88136396  -0.74953352  -0.97790432]
mat_Sqrt:  [[18.2860537   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320714 -0.01106097 -0.05874131]
Stock Position:  -0.003207143646879407
Bond Position:  [0.49245411]


portfolio before change:  [0.16240886]
curr_Stock_Price:  102.92860316405945
curr_Factors:  [102.92860316  -0.82785273  -0.97219529]
mat_Sqrt:  [[17.01316666  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00501603  0.01559554 -0.01296618]
Stock Position:  0.005016025295820072
Bond Position:  [-0.35388362]


portfolio before change:  [0.155702]
curr_Stock_Price:  101.60033565026812
curr_Factors:  [101.60033565  -0.75192629  -0.9627212 ]
mat_Sqrt:  [[18.29082097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337406 -0.01918863 -0.11314677]
Stock Position:  -0.0033740573386147783
Bond Position:  [0.49850735]


portfolio before change:  [0.15512833]
curr_Stock_Price:  101.78882930218315
curr_Factors:  [101.7888293   -0.73671892  -0.94707949]
mat_Sqrt:  [[18.89886661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00508468  0.03954702 -0.16082133]
Stock Position:  0.005084682577942133
Bond Position:  [-0.36243556]


portfolio before change:  [0.15230226]
curr_Stock_Price:  101.2419403445706
curr_Factors:  [101.24194034  -0.63335326  -0.92874448]
mat_Sqrt:  [[21.23000177  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152193  0.01487808 -0.12465832]
Stock Position:  0.00152193419822536
Bond Position:  [-0.00178131]


portfolio before change:  [0.15041774]
curr_Stock_Price:  100.00384384700017
curr_Factors:  [100.00384385  -0.62583673  -0.93590771]
mat_Sqrt:  [[20.97778844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00482878 -0.0140845  -0.02558765]
Stock Position:  -0.004828780433014225
Bond Position:  [0.63331434]


portfolio before change:  [0.15298061]
curr_Stock_Price:  99.489490217946
curr_Factors:  [99.48949022 -0.68829096 -0.94752047]
mat_Sqrt:  [[19.37998019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06327883  0.57853201 -0.9083761 ]
Stock Position:  0.06327883096625057
Bond Position:  [-6.14259803]


portfolio before change:  [0.1574764]
curr_Stock_Price:  99.57267228180778
curr_Factors:  [99.57267228 -0.78486181 -0.9216996 ]
mat_Sqrt:  [[18.0713235   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00038333 0.00287795 0.07897849]
Stock Position:  0.00038332818181552824
Bond Position:  [0.11930739]


portfolio before change:  [0.15753982]
curr_Stock_Price:  99.69920420115656
curr_Factors:  [99.6992042  -0.69262555 -0.92851131]
mat_Sqrt:  [[19.70792504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.15550042e-02  1.01114053e-03 -1.82753646e+00]
Stock Position:  -0.02155500420700248
Bond Position:  [2.30655658]


portfolio before change:  [0.14323486]
curr_Stock_Price:  100.3762301594451
curr_Factors:  [100.37623016  -0.58187088  -0.92228355]
mat_Sqrt:  [[22.30411076  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.071306   -0.97753461  7.26260766]
Stock Position:  0.07130600224140689
Bond Position:  [-7.01419284]


portfolio before change:  [0.0818141]
curr_Stock_Price:  99.52715813362892
curr_Factors:  [99.52715813 -0.59580284 -0.95278849]
mat_Sqrt:  [[21.1542161   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00013101 -0.02952316  0.10073504]
Stock Position:  -0.00013101283310281063
Bond Position:  [0.09485343]


portfolio before change:  [0.08175394]
curr_Stock_Price:  100.07682539642245
curr_Factors:  [100.0768254   -0.53503459  -0.95702095]
mat_Sqrt:  [[22.50826578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00548889 -0.00253257 -0.08824387]
Stock Position:  0.0054888880732632235
Bond Position:  [-0.46755655]


portfolio before change:  [0.09275361]
curr_Stock_Price:  102.09146356504408
curr_Factors:  [102.09146357  -0.4596308   -0.97747582]
mat_Sqrt:  [[24.25838914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00717654 -0.0529296  -0.1118856 ]
Stock Position:  -0.007176538146250015
Bond Position:  [0.8254169]


portfolio before change:  [0.0951354]
curr_Stock_Price:  101.77395678323376
curr_Factors:  [101.77395678  -0.53103112  -0.99784617]
mat_Sqrt:  [[22.06244752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03042487 -0.56909537 -0.57572464]
Stock Position:  -0.030424870683963295
Bond Position:  [3.19159487]


portfolio before change:  [0.06855548]
curr_Stock_Price:  102.66069477790234
curr_Factors:  [102.66069478  -0.48859053  -1.04752561]
mat_Sqrt:  [[22.09415703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00094248 0.01202236 0.16656844]
Stock Position:  0.0009424763839671047
Bond Position:  [-0.0281998]


portfolio before change:  [0.07080944]
curr_Stock_Price:  105.05595855230574
curr_Factors:  [105.05595855  -0.62327494  -1.05893121]
mat_Sqrt:  [[19.5365486   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01402626 -0.15896701  0.69952543]
Stock Position:  0.014026258088628086
Bond Position:  [-1.40273255]


portfolio before change:  [0.071944]
curr_Stock_Price:  105.14934889141732
curr_Factors:  [105.14934889  -0.41290277  -1.04875852]
mat_Sqrt:  [[24.37895892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00299394  0.05801794 -0.35210633]
Stock Position:  0.0029939427325531894
Bond Position:  [-0.24286713]


portfolio before change:  [0.07210573]
curr_Stock_Price:  105.21350889158134
curr_Factors:  [105.21350889  -0.5132463   -1.028094  ]
mat_Sqrt:  [[22.52557677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00937067 -0.01632557 -0.4365519 ]
Stock Position:  -0.009370665019360085
Bond Position:  [1.05802628]


portfolio before change:  [0.08381134]
curr_Stock_Price:  103.97844749882385
curr_Factors:  [103.9784475   -0.40436407  -1.02154854]
mat_Sqrt:  [[24.9848848   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02070668 0.08238073 0.82373976]
Stock Position:  0.020706683566835374
Bond Position:  [-2.06923747]


portfolio before change:  [0.0737522]
curr_Stock_Price:  103.50514764850018
curr_Factors:  [103.50514765  -0.41800211  -1.01252569]
mat_Sqrt:  [[24.75663526  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00796685  0.02494054  0.13659852]
Stock Position:  -0.007966849678292823
Bond Position:  [0.89836215]


portfolio before change:  [0.0936743]
curr_Stock_Price:  101.01861973206942
curr_Factors:  [101.01861973  -0.43161152  -1.02036198]
mat_Sqrt:  [[23.64924894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00147145 -0.05505489  0.15119849]
Stock Position:  -0.001471450205367558
Bond Position:  [0.24231817]


portfolio before change:  [0.09772692]
curr_Stock_Price:  98.28503954669087
curr_Factors:  [98.28503955 -0.42273791 -0.9958059 ]
mat_Sqrt:  [[23.79149141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00439644 -0.01329337  0.84439544]
Stock Position:  0.004396443535883954
Bond Position:  [-0.33437771]


portfolio before change:  [0.09499643]
curr_Stock_Price:  97.67347941874688
curr_Factors:  [97.67347942 -0.26452564 -1.00277083]
mat_Sqrt:  [[27.50405908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00882093 -0.04328124 -0.21064708]
Stock Position:  -0.008820934826682026
Bond Position:  [0.95656782]


portfolio before change:  [0.11241195]
curr_Stock_Price:  95.71269586698703
curr_Factors:  [95.71269587 -0.24697314 -0.98545558]
mat_Sqrt:  [[27.90824692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374354  0.04353639  0.75813168]
Stock Position:  -0.0037435417605866535
Bond Position:  [0.47071642]


portfolio before change:  [0.11945318]
curr_Stock_Price:  93.84751465846118
curr_Factors:  [93.84751466 -0.15112373 -0.97092656]
mat_Sqrt:  [[30.55783088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00621987 0.03608215 0.79288404]
Stock Position:  0.006219870267582601
Bond Position:  [-0.46426619]


portfolio before change:  [0.12161064]
curr_Stock_Price:  94.20371160400016
curr_Factors:  [ 9.42037116e+01 -2.95521469e-02 -9.70554361e-01]
mat_Sqrt:  [[34.65191788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00436442  0.03841433 -0.17553831]
Stock Position:  -0.0043644245654448485
Bond Position:  [0.53275563]


portfolio before change:  [0.12615357]
curr_Stock_Price:  93.17807129492675
curr_Factors:  [93.17807129 -0.13364389 -0.96797756]
mat_Sqrt:  [[30.96603476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00401731 0.00215978 0.03484806]
Stock Position:  0.0040173075655915
Bond Position:  [-0.24817141]


portfolio before change:  [0.13001956]
curr_Stock_Price:  94.14812814507773
curr_Factors:  [94.14812815 -0.14285484 -0.97844885]
mat_Sqrt:  [[30.67861037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00181026 -0.00068188 -0.20323906]
Stock Position:  0.0018102613161196516
Bond Position:  [-0.04041316]


portfolio before change:  [0.12591567]
curr_Stock_Price:  91.88390226105219
curr_Factors:  [91.88390226 -0.2143397  -0.99156734]
mat_Sqrt:  [[27.51190464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00743873 0.03951163 0.44948023]
Stock Position:  0.007438725188830901
Bond Position:  [-0.55758343]


portfolio before change:  [0.13703687]
curr_Stock_Price:  93.38831358604762
curr_Factors:  [93.38831359 -0.37211474 -1.0180357 ]
mat_Sqrt:  [[23.25722341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050023 -0.01316076  0.01473294]
Stock Position:  -0.0005002318023877902
Bond Position:  [0.18375267]


portfolio before change:  [0.13723167]
curr_Stock_Price:  93.044816846791
curr_Factors:  [93.04481685 -0.15639013 -0.99578361]
mat_Sqrt:  [[29.39743846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224943  0.03700156  0.08395489]
Stock Position:  -0.0022494326401356042
Bond Position:  [0.34652971]


portfolio before change:  [0.13422915]
curr_Stock_Price:  94.39886272412029
curr_Factors:  [94.39886272 -0.29058331 -0.99481588]
mat_Sqrt:  [[26.10507768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00495049 -0.01891605 -0.19084186]
Stock Position:  -0.0049504883257422885
Bond Position:  [0.60154962]


portfolio before change:  [0.13782]
curr_Stock_Price:  93.68869937912902
curr_Factors:  [93.68869938 -0.45555031 -0.98993646]
mat_Sqrt:  [[22.07599483  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08570958 0.34415562 0.40580756]
Stock Position:  0.08570958138451526
Bond Position:  [-7.8921992]


portfolio before change:  [0.09629329]
curr_Stock_Price:  93.21570530314588
curr_Factors:  [93.2157053  -0.42504552 -1.01004115]
mat_Sqrt:  [[22.19416796  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00396479 -0.06004507  0.20064893]
Stock Position:  0.003964792027574093
Bond Position:  [-0.27328759]


portfolio before change:  [0.09365411]
curr_Stock_Price:  92.55866607451796
curr_Factors:  [92.55866607 -0.36579351 -1.00906694]
mat_Sqrt:  [[23.40576175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104681 -0.0050402  -0.01979999]
Stock Position:  0.0010468070264333482
Bond Position:  [-0.00323696]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.09432514]
Stock Price:  93.20008722546402
PL:  [0.09432514]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 7.64744237e-02 -3.01705984e-02  5.15340320e-02]
 [ 1.01012152e+00  2.27114108e-01  2.87580811e-01]
 [-1.52454343e-01 -5.38606800e-02  3.42434987e-02]
 [ 1.19082290e-01  1.03470819e+00  7.81625085e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 3.15764778e-02 -8.16028126e-02  5.35202665e-02]
 [-4.93821784e-02 -8.89405750e-03 -7.34542149e-02]
 [ 6.91607166e-02  1.39086084e-01 -5.08648369e-02]
 [ 1.09718356e-02  6.86599547e-02 -4.71257624e-02]
 [-4.97397535e-01  9.26159277e-02 -1.80085168e-01]
 [ 3.97025417e-01  7.94012692e-01 -1.33473108e-01]
 [-1.42698574e-04  1.24452830e-02 -5.76514655e-02]
 [ 7.20043433e-02 -3.62030767e-02 -4.40632471e-02]
 [ 1.62098945e+00 -3.14550902e+00  2.69691869e+00]
 [ 5.21302784e-02 -1.04458642e-01  6.32467184e-02]
 [ 1.35384367e-01 -1.31387811e-01  4.44081251e-02]
 [-2.63836352e-01 -4.42714711e-01  1.53528182e-02]
 [-2.43198552e-01 -1.59779560e+00 -1.97428132e-01]
 [-3.31751152e-02  1.55461951e-01  3.49326047e-01]
 [ 4.42736607e-01 -6.64598409e-01  3.74381234e-01]
 [ 1.28185548e-01 -2.30711205e-01 -3.06101040e-01]
 [-3.43057133e-01 -4.84067723e-02 -2.17338639e-01]
 [ 3.47320854e-01  4.02711786e-01  3.24286970e-01]
 [ 3.49065848e-01 -1.06103292e-01  8.44092585e-02]
 [-1.05006303e-01 -3.21598731e-01  1.16957836e-01]
 [ 1.57398476e-01 -6.05939545e-02 -1.82615163e-01]
 [ 8.59854190e-01 -1.38097432e-02  5.33132437e-01]
 [-6.01199871e-02  5.97340482e-02  1.07055130e-01]
 [-1.53060419e-02 -8.05624125e-02 -1.28778699e-02]
 [ 5.72010293e-01 -2.70396911e-01 -1.20210971e-01]
 [-1.07265468e-02 -1.11103853e-01 -3.56269325e-03]
 [-1.82258312e-01 -4.00632801e-02  8.48708932e-02]
 [-4.10831346e-02  1.35182137e-01 -2.26145827e-01]
 [ 6.00752290e-01  1.26259818e-01  1.93276868e-01]
 [ 2.72879872e-02  2.40814563e-01 -1.12908366e-01]
 [-4.93947774e-02  4.98625721e-02  2.45213675e-02]
 [ 2.79033057e+00  1.97397991e+00  2.24119536e-01]
 [-1.23080727e-01  2.84987268e-02  2.34311018e-03]
 [ 3.87481738e-02 -1.19936212e-02 -1.99273394e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.32676837]
curr_Stock_Price:  100.80771578646193
curr_Factors:  [100.80771579  -0.98034756  -0.99650151]
mat_Sqrt:  [[13.96236971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00578951 -0.00973752  0.14701225]
Stock Position:  0.005789505503587551
Bond Position:  [7.74314154]


portfolio before change:  [8.32345063]
curr_Stock_Price:  100.06746358097277
curr_Factors:  [100.06746358  -0.9706327   -0.98616174]
mat_Sqrt:  [[14.14060078  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07886392 0.07330076 0.82038801]
Stock Position:  0.0788639180367778
Bond Position:  [0.43173838]


portfolio before change:  [8.37757702]
curr_Stock_Price:  100.75310569167804
curr_Factors:  [100.75310569  -1.23842176  -0.97796506]
mat_Sqrt:  [[10.98231449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01424642 -0.01738346  0.09768717]
Stock Position:  -0.014246421710589178
Bond Position:  [9.81294825]


portfolio before change:  [8.37416071]
curr_Stock_Price:  101.07901213355936
curr_Factors:  [101.07901213  -1.18259623  -0.9925158 ]
mat_Sqrt:  [[11.48211347  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04266112 0.33395063 2.2297588 ]
Stock Position:  0.04266111536946364
Bond Position:  [4.06201732]


portfolio before change:  [8.3681354]
curr_Stock_Price:  100.92587263311036
curr_Factors:  [100.92587263  -0.99747191  -0.99637603]
mat_Sqrt:  [[13.74312049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0042673  -0.01106097 -0.05874131]
Stock Position:  -0.004267298753002107
Bond Position:  [8.79881625]


portfolio before change:  [8.37123398]
curr_Stock_Price:  100.45750598805948
curr_Factors:  [100.45750599  -0.9724299   -0.98773461]
mat_Sqrt:  [[14.14795797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00182671 -0.02633719  0.15267842]
Stock Position:  0.0018267054636442112
Bond Position:  [8.1877277]


portfolio before change:  [8.37319774]
curr_Stock_Price:  100.9722184522188
curr_Factors:  [100.97221845  -0.84557543  -0.98319247]
mat_Sqrt:  [[16.21728287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00408154 -0.00287054 -0.20954443]
Stock Position:  -0.004081537554151493
Bond Position:  [8.78531964]


portfolio before change:  [8.37258841]
curr_Stock_Price:  101.39058037754164
curr_Factors:  [101.39058038  -0.96763836  -0.96921258]
mat_Sqrt:  [[14.61618169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00596386  0.04488984 -0.14510322]
Stock Position:  0.005963856026452127
Bond Position:  [7.76790958]


portfolio before change:  [8.3850015]
curr_Stock_Price:  103.30914520195982
curr_Factors:  [103.3091452   -1.10351475  -0.98870475]
mat_Sqrt:  [[12.749683    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120532  0.02215991 -0.13443668]
Stock Position:  0.0012053228474528587
Bond Position:  [8.26048063]


portfolio before change:  [8.38705403]
curr_Stock_Price:  104.1553144909715
curr_Factors:  [104.15531449  -1.30900585  -0.97018126]
mat_Sqrt:  [[10.66210728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04832554  0.02989166 -0.51373286]
Stock Position:  -0.048325542553628885
Bond Position:  [13.42041612]


portfolio before change:  [8.3740998]
curr_Stock_Price:  104.4580920099779
curr_Factors:  [104.45809201  -1.31948697  -0.96515456]
mat_Sqrt:  [[10.63493595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05001041  0.25626649 -0.38076162]
Stock Position:  0.05001040882530625
Bond Position:  [3.15010792]


portfolio before change:  [8.38774651]
curr_Stock_Price:  104.72309525637247
curr_Factors:  [104.72309526  -1.43222121  -0.93879826]
mat_Sqrt:  [[ 9.77961588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095815  0.0040167  -0.16446358]
Stock Position:  -0.0009581533713467975
Bond Position:  [8.4880873]


portfolio before change:  [8.38883883]
curr_Stock_Price:  104.690489637943
curr_Factors:  [104.69048964  -1.36393763  -0.91482845]
mat_Sqrt:  [[10.7214049   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00518776 -0.01168449 -0.12570018]
Stock Position:  0.005187757489766331
Bond Position:  [7.84572996]


portfolio before change:  [8.38976892]
curr_Stock_Price:  104.68071940154753
curr_Factors:  [104.6807194   -1.49820175  -0.9196556 ]
mat_Sqrt:  [[ 9.32834479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.1639542  -1.01520867  7.69355835]
Stock Position:  0.16395420214197248
Bond Position:  [-8.77307491]


portfolio before change:  [8.47039075]
curr_Stock_Price:  105.17914230999178
curr_Factors:  [105.17914231  -1.66856538  -0.93145691]
mat_Sqrt:  [[ 7.81185716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00559636 -0.03371388  0.18042528]
Stock Position:  0.005596355492181382
Bond Position:  [7.88177088]


portfolio before change:  [8.47576506]
curr_Stock_Price:  105.9634070197503
curr_Factors:  [105.96340702  -1.56305949  -0.95036617]
mat_Sqrt:  [[ 8.58201005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01370655 -0.04240523  0.12668402]
Stock Position:  0.013706545675491281
Bond Position:  [7.02337278]


portfolio before change:  [8.47952823]
curr_Stock_Price:  106.17390460636281
curr_Factors:  [106.17390461  -1.75838077  -0.95932755]
mat_Sqrt:  [[ 7.01022673  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05007987 -0.14288556  0.04379732]
Stock Position:  -0.05007986861253986
Bond Position:  [13.79670342]


portfolio before change:  [8.47844209]
curr_Stock_Price:  106.23003155681428
curr_Factors:  [106.23003156  -1.70477757  -0.94038618]
mat_Sqrt:  [[ 7.54166595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08083719 -0.51568631 -0.56320751]
Stock Position:  -0.08083718708652886
Bond Position:  [17.06577903]


portfolio before change:  [8.49012085]
curr_Stock_Price:  106.11194973193678
curr_Factors:  [106.11194973  -1.78951904  -0.92976129]
mat_Sqrt:  [[ 6.99513095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00998756 0.05017513 0.99652998]
Stock Position:  0.00998756191824755
Bond Position:  [7.43032118]


portfolio before change:  [8.49234972]
curr_Stock_Price:  106.24211405616529
curr_Factors:  [106.24211406  -1.7030481   -0.96339025]
mat_Sqrt:  [[ 7.38375439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05193784 -0.21449821  1.06800545]
Stock Position:  0.05193784271138935
Bond Position:  [2.97436352]


portfolio before change:  [8.51855804]
curr_Stock_Price:  106.73956432319277
curr_Factors:  [106.73956432  -1.72017202  -0.96569807]
mat_Sqrt:  [[ 7.27556741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00255777 -0.07446172 -0.87322107]
Stock Position:  0.002557767095684428
Bond Position:  [8.24554309]


portfolio before change:  [8.52038111]
curr_Stock_Price:  107.04933445150678
curr_Factors:  [107.04933445  -1.50118588  -0.95530972]
mat_Sqrt:  [[ 9.17786127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04328919 -0.01562322 -0.62000664]
Stock Position:  -0.04328919078174347
Bond Position:  [13.15446018]


portfolio before change:  [8.514866]
curr_Stock_Price:  107.21472278464219
curr_Factors:  [107.21472278  -1.88154828  -0.96062912]
mat_Sqrt:  [[ 6.25046698  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07930909 0.12997467 0.92510046]
Stock Position:  0.07930909082934257
Bond Position:  [0.01176381]


portfolio before change:  [8.52672182]
curr_Stock_Price:  107.36419310510404
curr_Factors:  [107.36419311  -1.75477871  -0.9907294 ]
mat_Sqrt:  [[ 6.89446296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04998759 -0.03424469  0.24079612]
Stock Position:  0.049987587702286396
Bond Position:  [3.1598448]


portfolio before change:  [8.53385641]
curr_Stock_Price:  107.49901826128782
curr_Factors:  [107.49901826  -1.62373524  -0.97270516]
mat_Sqrt:  [[ 8.01280837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01831798 -0.10379554  0.33364815]
Stock Position:  -0.01831797844381466
Bond Position:  [10.50302111]


portfolio before change:  [8.53641682]
curr_Stock_Price:  107.43091847617934
curr_Factors:  [107.43091848  -1.60643779  -0.95715176]
mat_Sqrt:  [[ 8.27516178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01302133 -0.01955661 -0.52095023]
Stock Position:  0.013021331223934686
Bond Position:  [7.13752325]


portfolio before change:  [8.54169398]
curr_Stock_Price:  107.76766702004204
curr_Factors:  [107.76766702  -1.61647092  -0.94566699]
mat_Sqrt:  [[ 8.3131597   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11618452 -0.00445708  1.52087845]
Stock Position:  0.11618452257228588
Bond Position:  [-3.97924096]


portfolio before change:  [8.57050209]
curr_Stock_Price:  108.01989979585258
curr_Factors:  [108.0198998   -1.77831312  -0.93748444]
mat_Sqrt:  [[ 7.14575097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364892  0.01927908  0.30539849]
Stock Position:  -0.003648922096864487
Bond Position:  [8.96465829]


portfolio before change:  [8.57225147]
curr_Stock_Price:  107.84759400338429
curr_Factors:  [107.847594    -1.77509673  -0.94476742]
mat_Sqrt:  [[ 7.10539895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0048385  -0.02600141 -0.03673698]
Stock Position:  -0.0048384981530395525
Bond Position:  [9.09407186]


portfolio before change:  [8.57313606]
curr_Stock_Price:  107.89972646259048
curr_Factors:  [107.89972646  -1.66339387  -0.94949049]
mat_Sqrt:  [[ 7.91150458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06222303 -0.08727023 -0.34292844]
Stock Position:  0.062223030684558325
Bond Position:  [1.85928807]


portfolio before change:  [8.60301678]
curr_Stock_Price:  108.37621072216233
curr_Factors:  [108.37621072  -1.54834332  -0.93587875]
mat_Sqrt:  [[ 9.03753572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377678 -0.03585861 -0.01016337]
Stock Position:  -0.00377677706198127
Bond Position:  [9.01232957]


portfolio before change:  [8.60079347]
curr_Stock_Price:  109.26318895693589
curr_Factors:  [109.26318896  -1.46990012  -0.91942464]
mat_Sqrt:  [[10.01851399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01727921 -0.01293037  0.24211303]
Stock Position:  -0.017279208932329926
Bond Position:  [10.48877494]


portfolio before change:  [8.62343515]
curr_Stock_Price:  108.02872896076732
curr_Factors:  [108.02872896  -1.31244423  -0.91218335]
mat_Sqrt:  [[11.67873453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00510766  0.04362985 -0.6451311 ]
Stock Position:  -0.005107661265295113
Bond Position:  [9.1752093]


portfolio before change:  [8.62669435]
curr_Stock_Price:  107.61518786329552
curr_Factors:  [107.61518786  -1.48867071  -0.92344961]
mat_Sqrt:  [[ 9.64501762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06904886 0.04075018 0.55136511]
Stock Position:  0.06904885707095851
Bond Position:  [1.19598862]


portfolio before change:  [8.66978287]
curr_Stock_Price:  108.23705217805568
curr_Factors:  [108.23705218  -1.54504812  -0.90787401]
mat_Sqrt:  [[ 9.31291008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00573362  0.07772257 -0.32209614]
Stock Position:  0.005733624603652674
Bond Position:  [8.04919225]


portfolio before change:  [8.66996699]
curr_Stock_Price:  108.09367033373594
curr_Factors:  [108.09367033  -1.28235374  -0.9527496 ]
mat_Sqrt:  [[11.56397692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295843  0.01609308  0.06995264]
Stock Position:  -0.002958430266954993
Bond Position:  [8.98975457]


portfolio before change:  [8.67263679]
curr_Stock_Price:  107.57109083697692
curr_Factors:  [107.57109084  -1.18832272  -0.91667211]
mat_Sqrt:  [[13.10713992  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.24711842 0.63709928 0.63935065]
Stock Position:  0.2471184224853688
Bond Position:  [-17.91016148]


portfolio before change:  [8.60759098]
curr_Stock_Price:  107.31693371857821
curr_Factors:  [107.31693372  -1.12695476  -0.8936644 ]
mat_Sqrt:  [[14.22736601  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00820849  0.00919792  0.00668424]
Stock Position:  -0.008208488016643265
Bond Position:  [9.48850074]


portfolio before change:  [8.60006542]
curr_Stock_Price:  108.37823732161354
curr_Factors:  [108.37823732  -1.36409511  -0.8739187 ]
mat_Sqrt:  [[11.56072409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.78568427e-04 -3.87092459e-03 -5.68471527e-01]
Stock Position:  -0.0003785684268073363
Bond Position:  [8.64109399]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.60154257]
Stock Price:  107.32967574301918
PL:  [1.27186683]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 1.33221055e-01 -1.55731459e-02 -1.84915673e-01]
 [ 1.60408170e+00  3.31708126e-01  5.26891560e-01]
 [-2.59992435e-01 -1.52847273e-01  3.73802315e-02]
 [ 2.22583624e-01  1.72453098e+00  1.43546211e+00]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 7.83254037e-03  9.38882232e-02 -2.03782278e-02]
 [-8.57163408e-02  9.34026405e-02 -4.55286422e-03]
 [-6.23718925e-02  1.21032582e-01  1.91716074e-03]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-4.55945370e-02 -1.57185970e-02  2.21096422e-02]
 [ 5.32845707e-01  1.15148624e+00 -1.55608792e-01]
 [-4.26231877e-04  3.37498427e-02  1.80029683e-03]
 [-5.05536317e-01 -5.23209364e-02 -1.20876984e+00]
 [ 2.20775140e+00 -3.40295134e+00  2.89580114e+00]
 [-5.25282825e-03  5.89892438e-02 -1.04579469e-02]
 [ 1.14114002e-02  3.54761643e-01 -1.87231521e-01]
 [ 2.86308040e-02 -2.94357565e-01 -2.23146405e-02]
 [-3.00905749e-01 -1.90391708e+00 -1.89297381e-01]
 [ 3.57822129e-02 -2.10680614e-01  3.69653646e-01]
 [-2.89721509e-01  6.11785457e-01  4.20848599e-01]
 [ 1.22297739e-02  1.56639272e-01 -1.01310071e-01]
 [ 1.20260592e-01 -5.18908510e-02  8.79876618e-02]
 [ 3.88406879e-02 -1.31874432e-01 -1.33751878e-01]
 [-2.67200784e-01  9.68442785e-02  1.86196888e-02]
 [ 1.18210514e-01 -4.97105327e-02 -4.21171846e-02]
 [-1.08739621e-01 -6.95114994e-02  8.36556983e-02]
 [ 1.41809126e-02 -5.74160513e-02  1.22139365e-01]
 [-1.99222824e-02 -1.58393911e-01 -3.09708360e-02]
 [ 2.78385983e-01  1.71102514e-01  1.98051162e-01]
 [-1.39042198e-01  9.02289257e-02 -1.85557945e-01]
 [ 1.54369005e-01  2.22362867e-02  6.12022642e-02]
 [ 8.55756959e-02 -4.72623033e-02 -1.85627677e-02]
 [ 1.26419834e-01  1.28874771e-01  1.73582097e-01]
 [ 6.26866409e-03 -1.57981786e-02  5.23023531e-02]
 [-8.93777364e-02  9.64815002e-02  4.15685518e-02]
 [-7.96451985e-02 -4.54396958e-02 -4.39385945e-02]
 [ 1.97273459e+00  1.32287818e+00  1.65085405e-01]
 [ 2.88525921e-01 -4.29389310e-01  9.51506393e-02]
 [ 2.40632548e-02 -1.42243156e-02  3.05052241e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.4164245]
curr_Stock_Price:  100.54702720634485
curr_Factors:  [100.54702721  -1.24587427  -1.00608672]
mat_Sqrt:  [[10.57681736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0087263  -0.00502621 -0.52751295]
Stock Position:  0.008726296638711457
Bond Position:  [5.53902131]


portfolio before change:  [6.42294404]
curr_Stock_Price:  101.21479320839336
curr_Factors:  [101.21479321  -1.24557935  -1.01579941]
mat_Sqrt:  [[10.54726049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.16870188 0.10705834 1.50307496]
Stock Position:  0.16870187582140458
Bond Position:  [-10.65218143]


portfolio before change:  [6.17665656]
curr_Stock_Price:  99.76278876508175
curr_Factors:  [99.76278877 -1.37184653 -0.98553812]
mat_Sqrt:  [[ 9.4442926   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0300247  -0.04933125  0.1066354 ]
Stock Position:  -0.03002469934695677
Bond Position:  [9.1720043]


portfolio before change:  [6.20442959]
curr_Stock_Price:  98.87597041263433
curr_Factors:  [98.87597041 -1.28161218 -0.98208587]
mat_Sqrt:  [[10.27967031  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08440101 0.55658998 4.09497385]
Stock Position:  0.08440100560369877
Bond Position:  [-2.14080174]


portfolio before change:  [6.27186793]
curr_Stock_Price:  99.67816418127047
curr_Factors:  [99.67816418 -1.07014157 -0.99747949]
mat_Sqrt:  [[12.60792489  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465152 -0.01106097 -0.05874131]
Stock Position:  -0.004651518901292657
Bond Position:  [6.7355228]


portfolio before change:  [6.27354955]
curr_Stock_Price:  99.49765930625081
curr_Factors:  [99.49765931 -0.95668223 -0.9611813 ]
mat_Sqrt:  [[14.61824768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00156227  0.03030229 -0.05813341]
Stock Position:  0.001562273799673408
Bond Position:  [6.11810696]


portfolio before change:  [6.27322341]
curr_Stock_Price:  98.79934930719362
curr_Factors:  [98.79934931 -0.84020828 -0.91633411]
mat_Sqrt:  [[17.05679441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00396205  0.03014557 -0.01298805]
Stock Position:  -0.003962054915720725
Bond Position:  [6.66467185]


portfolio before change:  [6.27830445]
curr_Stock_Price:  97.7272015411426
curr_Factors:  [97.72720154 -1.31827629 -0.87168055]
mat_Sqrt:  [[10.93778271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034079   0.0390631   0.00546913]
Stock Position:  -0.003407901068422654
Bond Position:  [6.61134909]


portfolio before change:  [6.27959703]
curr_Stock_Price:  97.59042912338829
curr_Factors:  [97.59042912 -1.44609129 -0.87592887]
mat_Sqrt:  [[ 9.57120649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00543204  0.0064198  -0.11330016]
Stock Position:  0.005432042805380467
Bond Position:  [5.74948164]


portfolio before change:  [6.27767412]
curr_Stock_Price:  97.10412335490774
curr_Factors:  [97.10412335 -1.34842365 -0.86732248]
mat_Sqrt:  [[10.59135076  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418171 -0.00507316  0.06307265]
Stock Position:  -0.004181711222015662
Bond Position:  [6.68373553]


portfolio before change:  [6.27942224]
curr_Stock_Price:  96.88588841200483
curr_Factors:  [96.88588841 -1.70470034 -0.8619884 ]
mat_Sqrt:  [[ 7.43980867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09894453  0.37164059 -0.44390857]
Stock Position:  0.09894452559511728
Bond Position:  [-3.30690603]


portfolio before change:  [6.28096802]
curr_Stock_Price:  96.90568911971053
curr_Factors:  [96.90568912 -1.63760941 -0.86449463]
mat_Sqrt:  [[ 7.93778438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00086049 0.01089271 0.00513575]
Stock Position:  0.0008604932605025652
Bond Position:  [6.19758133]


portfolio before change:  [6.28113664]
curr_Stock_Price:  96.20129760969984
curr_Factors:  [96.20129761 -1.57428951 -0.88418333]
mat_Sqrt:  [[ 8.23151438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09268712 -0.01688651 -3.4482839 ]
Stock Position:  -0.09268712402681852
Bond Position:  [15.19775825]


portfolio before change:  [6.29585864]
curr_Stock_Price:  96.06295950907982
curr_Factors:  [96.06295951 -1.42965867 -0.86419044]
mat_Sqrt:  [[ 9.6905841   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.21714169 -1.09829782  8.26091463]
Stock Position:  0.2171416888401323
Bond Position:  [-14.56341462]


portfolio before change:  [6.12602699]
curr_Stock_Price:  95.28921995465885
curr_Factors:  [95.28921995 -1.33991403 -0.87385845]
mat_Sqrt:  [[10.4139287   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00044686  0.0190387  -0.02983361]
Stock Position:  0.0004468612547813179
Bond Position:  [6.08344593]


portfolio before change:  [6.12664945]
curr_Stock_Price:  94.9803683565415
curr_Factors:  [94.98036836 -1.07011339 -0.89273435]
mat_Sqrt:  [[13.34073965  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00341873  0.11449883 -0.53411942]
Stock Position:  0.0034187267128479165
Bond Position:  [5.80193753]


portfolio before change:  [6.12597135]
curr_Stock_Price:  94.56986688085611
curr_Factors:  [94.56986688 -1.31641834 -0.9153219 ]
mat_Sqrt:  [[10.15126825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035473  -0.0950035  -0.06365746]
Stock Position:  -0.0035473044695951456
Bond Position:  [6.46143946]


portfolio before change:  [6.12863388]
curr_Stock_Price:  94.04699180365978
curr_Factors:  [94.0469918  -1.32320549 -0.92308078]
mat_Sqrt:  [[ 9.94936076  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07318876 -0.6144866  -0.54001274]
Stock Position:  -0.07318875854336636
Bond Position:  [13.01181645]


portfolio before change:  [6.08926352]
curr_Stock_Price:  94.60714527015514
curr_Factors:  [94.60714527 -1.34234678 -0.94300114]
mat_Sqrt:  [[ 9.62520408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00708894 -0.06799688  1.05451896]
Stock Position:  0.007088935110712997
Bond Position:  [5.4185996]


portfolio before change:  [6.08261682]
curr_Stock_Price:  93.57397658379112
curr_Factors:  [93.57397658 -1.27393911 -0.93273124]
mat_Sqrt:  [[10.29936222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00766416  0.19745291  1.20056391]
Stock Position:  -0.007664160470363275
Bond Position:  [6.79978279]


portfolio before change:  [6.09149993]
curr_Stock_Price:  92.52583978456494
curr_Factors:  [92.52583978 -1.30446667 -0.9176612 ]
mat_Sqrt:  [[10.02778837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234586  0.05055511 -0.28900943]
Stock Position:  0.0023458612135025996
Bond Position:  [5.87444716]


portfolio before change:  [6.09183102]
curr_Stock_Price:  92.35393586523227
curr_Factors:  [92.35393587 -1.41673265 -0.9314151 ]
mat_Sqrt:  [[ 8.82404673  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01446375 -0.0167477   0.25100431]
Stock Position:  0.014463751866336635
Bond Position:  [4.75604661]


portfolio before change:  [6.0893025]
curr_Stock_Price:  92.13801230308907
curr_Factors:  [92.1380123  -1.52188403 -0.95419308]
mat_Sqrt:  [[ 7.74626253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198548 -0.04256229 -0.38155688]
Stock Position:  -0.0019854807950133516
Bond Position:  [6.27224076]


portfolio before change:  [6.08983347]
curr_Stock_Price:  92.26549168473946
curr_Factors:  [92.26549168 -1.69466903 -0.94681647]
mat_Sqrt:  [[ 6.57440912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0370576   0.03125636  0.05311679]
Stock Position:  -0.037057596568654205
Bond Position:  [9.50897084]


portfolio before change:  [6.0899026]
curr_Stock_Price:  92.29570322143981
curr_Factors:  [92.29570322 -1.82750122 -0.93298361]
mat_Sqrt:  [[ 5.83872679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01703561 -0.01604401 -0.1201486 ]
Stock Position:  0.01703560772927321
Bond Position:  [4.51758921]


portfolio before change:  [6.08452699]
curr_Stock_Price:  91.94700164778904
curr_Factors:  [91.94700165 -1.91890532 -0.9188204 ]
mat_Sqrt:  [[ 5.38429627  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01965948 -0.02243474  0.23864642]
Stock Position:  -0.019659476984575697
Bond Position:  [7.89215695]


portfolio before change:  [6.08136625]
curr_Stock_Price:  92.1579594984011
curr_Factors:  [92.1579595  -1.7029497  -0.87946718]
mat_Sqrt:  [[ 6.9663205   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00393213 -0.01853095  0.34842961]
Stock Position:  0.003932133719147409
Bond Position:  [5.71898883]


portfolio before change:  [6.08237286]
curr_Stock_Price:  92.23214055216177
curr_Factors:  [92.23214055 -1.76797698 -0.87918992]
mat_Sqrt:  [[ 6.53480018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00896373 -0.05112142 -0.08835117]
Stock Position:  -0.008963732329048487
Bond Position:  [6.90911708]


portfolio before change:  [6.08680671]
curr_Stock_Price:  91.83385144400349
curr_Factors:  [91.83385144 -1.62854543 -0.87170883]
mat_Sqrt:  [[ 7.53626516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04693826 0.0552231  0.56498484]
Stock Position:  0.04693825842189659
Bond Position:  [1.77628566]


portfolio before change:  [6.07718741]
curr_Stock_Price:  91.62418560375444
curr_Factors:  [91.6241856  -1.40953462 -0.87391855]
mat_Sqrt:  [[ 9.33940088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01697123  0.02912126 -0.52934517]
Stock Position:  -0.01697123341266643
Bond Position:  [7.63216285]


portfolio before change:  [6.0785872]
curr_Stock_Price:  91.59792280539985
curr_Factors:  [91.59792281 -1.39593745 -0.88806065]
mat_Sqrt:  [[ 9.3316374   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01836771 0.00717673 0.17459302]
Stock Position:  0.018367711932724986
Bond Position:  [4.39614294]


portfolio before change:  [6.07587659]
curr_Stock_Price:  91.42042853104893
curr_Factors:  [91.42042853 -1.34803847 -0.89712996]
mat_Sqrt:  [[ 9.68231018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00745062 -0.01525384 -0.05295441]
Stock Position:  0.007450619556904022
Bond Position:  [5.39473776]


portfolio before change:  [6.07282509]
curr_Stock_Price:  90.92035075368408
curr_Factors:  [90.92035075 -1.21371832 -0.92467351]
mat_Sqrt:  [[10.71443639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01756122 0.04159415 0.49518141]
Stock Position:  0.01756122087427489
Bond Position:  [4.47615273]


portfolio before change:  [6.07995666]
curr_Stock_Price:  91.29458526774012
curr_Factors:  [91.29458527 -1.07278883 -0.90994264]
mat_Sqrt:  [[12.57059066  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00109144 -0.00509884  0.14920406]
Stock Position:  0.001091440161784954
Bond Position:  [5.98031408]


portfolio before change:  [6.08015668]
curr_Stock_Price:  90.79289523273133
curr_Factors:  [90.79289523 -1.05746453 -0.89120057]
mat_Sqrt:  [[12.93472986  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00473132  0.03113927  0.11858351]
Stock Position:  -0.004731323203517568
Bond Position:  [6.50972721]


portfolio before change:  [6.08349128]
curr_Stock_Price:  90.26009892993511
curr_Factors:  [90.26009893 -0.72102901 -0.90358175]
mat_Sqrt:  [[17.78018668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00550554 -0.0146656  -0.12534458]
Stock Position:  -0.005505536433821908
Bond Position:  [6.58042154]


portfolio before change:  [6.08883579]
curr_Stock_Price:  89.43876073527147
curr_Factors:  [89.43876074 -0.80574033 -0.90820613]
mat_Sqrt:  [[16.11269869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.14128384 0.4269571  0.47094271]
Stock Position:  0.14128383656178023
Bond Position:  [-6.54741547]


portfolio before change:  [6.04012501]
curr_Stock_Price:  89.0997814382098
curr_Factors:  [89.09978144 -0.83136679 -0.91275658]
mat_Sqrt:  [[15.57447741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01414492 -0.1385848   0.27143829]
Stock Position:  0.014144920073663357
Bond Position:  [4.77981573]


portfolio before change:  [6.03486361]
curr_Stock_Price:  88.68557525861223
curr_Factors:  [88.68557526 -0.87094983 -0.91292594]
mat_Sqrt:  [[14.8979181   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00183828 -0.00459088  0.08702291]
Stock Position:  0.0018382824459491727
Bond Position:  [5.87183448]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.03641743]
Stock Price:  89.13153155771204
PL:  [6.03641743]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 7.86535074e-02 -2.90632351e-02  4.73709987e-02]
 [ 1.63923360e+00  3.54467630e-01  5.46116619e-01]
 [ 1.15389870e-01  2.20211744e-01  4.02112850e-02]
 [ 8.63232885e-02  7.49596701e-01  5.66518370e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 4.62710678e-02 -2.42060146e-02  2.44450815e-02]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [-5.99039268e-02  1.15724374e-01  4.02402233e-03]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 8.37225016e-01  1.70048679e+00 -2.68733835e-01]
 [-6.65934131e-04  7.94344485e-03  4.50960568e-02]
 [-3.55950442e-01  3.47980544e-03 -7.94946513e-01]
 [ 1.93573529e+00 -2.97436568e+00  2.52287362e+00]
 [ 2.22654099e-02 -7.56988076e-02  1.23595209e-02]
 [ 3.55438123e-02  1.98003695e-01 -1.20534306e-01]
 [-1.89331319e-02  1.35737357e-01 -7.98050323e-02]
 [-2.79131632e-01 -1.80445090e+00 -1.98159331e-01]
 [ 1.17782357e-02  2.10912737e-02 -1.12078389e-03]
 [ 1.59282434e-01  1.37678131e-02  3.30632588e-01]
 [ 2.97417411e-02 -4.08106880e-02  4.24794127e-02]
 [ 1.09585166e-01 -5.09562080e-02  3.00698035e-02]
 [ 2.20947713e-01  1.21136775e-03  4.62558259e-02]
 [-1.15931313e-01 -1.32826881e-02  6.31814983e-02]
 [-2.44414693e-03 -1.43276364e-01  4.32494251e-02]
 [ 5.11707059e-02 -4.01490266e-03  2.05986296e-01]
 [ 1.25625509e-02 -1.13484502e-01  9.40981491e-03]
 [-1.84595431e-02 -6.52468165e-02  1.09691762e-02]
 [ 1.06857018e-02 -5.53660457e-02  3.07533846e-02]
 [-1.74362120e-02  7.77602565e-02  2.42804005e-02]
 [ 3.30251984e-02 -1.38563553e-02 -7.64628570e-02]
 [-4.95282272e-02  8.97978270e-03 -4.19553236e-02]
 [-9.91044861e-02 -2.70015818e-02  3.99313687e-02]
 [-5.42901193e-02 -1.23514567e-02 -2.11470605e-03]
 [-9.12638986e-02  3.37800846e-03  5.54521997e-02]
 [-1.16970702e-01 -6.80149088e-02 -7.94357177e-02]
 [ 1.95524178e+00  1.26367930e+00  1.54996109e-01]
 [ 4.18010592e-02 -1.56044783e-01 -1.60902634e-02]
 [ 3.25134480e-02 -1.43406369e-02 -6.14200851e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.06799774]
curr_Stock_Price:  100.77240353225932
curr_Factors:  [100.77240353  -0.99835875  -0.98980584]
mat_Sqrt:  [[13.80043283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00597014 -0.00938012  0.13513627]
Stock Position:  0.005970143476287531
Bond Position:  [7.46637203]


portfolio before change:  [8.07390694]
curr_Stock_Price:  101.60585978749475
curr_Factors:  [101.60585979  -0.98349773  -1.02882729]
mat_Sqrt:  [[13.58241846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.13422238 0.11440394 1.55791871]
Stock Position:  0.13422238407363277
Bond Position:  [-5.56387379]


portfolio before change:  [8.06450786]
curr_Stock_Price:  101.54101545680466
curr_Factors:  [101.54101546  -1.0880655   -1.03449999]
mat_Sqrt:  [[12.15690499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01386443 0.07107303 0.1147116 ]
Stock Position:  0.013864425097123802
Bond Position:  [6.65670005]


portfolio before change:  [8.06726417]
curr_Stock_Price:  101.67980046384623
curr_Factors:  [101.67980046  -1.09523518  -1.05136975]
mat_Sqrt:  [[11.88436574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.029869   0.24193129 1.61611922]
Stock Position:  0.029869002718416336
Bond Position:  [5.03018993]


portfolio before change:  [8.08417089]
curr_Stock_Price:  102.22477705571715
curr_Factors:  [102.22477706  -1.07607872  -1.03149948]
mat_Sqrt:  [[12.42357514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00472054 -0.01106097 -0.05874131]
Stock Position:  -0.004720541412288193
Bond Position:  [8.56672718]


portfolio before change:  [8.09102005]
curr_Stock_Price:  101.00071069554978
curr_Factors:  [101.0007107   -0.81115099  -0.99620165]
mat_Sqrt:  [[16.57300079  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0027949  -0.00781246  0.06973501]
Stock Position:  0.0027948992275890223
Bond Position:  [7.80873324]


portfolio before change:  [8.0917111]
curr_Stock_Price:  100.89870119001584
curr_Factors:  [100.89870119  -0.65070077  -0.97769508]
mat_Sqrt:  [[19.8007774   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00334786 -0.00251018 -0.21167328]
Stock Position:  -0.0033478646622660327
Bond Position:  [8.4295063]


portfolio before change:  [8.09739919]
curr_Stock_Price:  99.51443378815165
curr_Factors:  [99.51443379 -0.49947451 -0.97107258]
mat_Sqrt:  [[22.86839005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155063  0.03734988  0.01147942]
Stock Position:  -0.0015506289568195742
Bond Position:  [8.25170916]


portfolio before change:  [8.1024311]
curr_Stock_Price:  96.93459206858365
curr_Factors:  [96.93459207 -0.49516339 -0.96271377]
mat_Sqrt:  [[22.55956833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00230462  0.0064198  -0.11330016]
Stock Position:  0.002304618713245245
Bond Position:  [7.87903382]


portfolio before change:  [8.10452313]
curr_Stock_Price:  97.41497137511028
curr_Factors:  [97.41497138 -0.73574792 -0.9794664 ]
mat_Sqrt:  [[17.52740379  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.98687232e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  4.9868723152247994e-05
Bond Position:  [8.09966517]


portfolio before change:  [8.10556243]
curr_Stock_Price:  97.9518826273391
curr_Factors:  [97.95188263 -0.63712095 -1.00709497]
mat_Sqrt:  [[18.92077348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05969525  0.54882975 -0.76662283]
Stock Position:  0.059695253218958785
Bond Position:  [2.25829999]


portfolio before change:  [8.20477304]
curr_Stock_Price:  99.60910501345495
curr_Factors:  [99.60910501 -0.5853367  -1.02689406]
mat_Sqrt:  [[19.86626001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00051146 0.00256374 0.1286465 ]
Stock Position:  0.0005114555428801056
Bond Position:  [8.15382741]


portfolio before change:  [8.20534843]
curr_Stock_Price:  98.74118007095083
curr_Factors:  [98.74118007 -0.46249436 -1.02613707]
mat_Sqrt:  [[22.28403839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.32232550e-02  1.12310238e-03 -2.26776113e+00]
Stock Position:  -0.02322325504587446
Bond Position:  [10.49844004]


portfolio before change:  [8.23697068]
curr_Stock_Price:  97.43602879920599
curr_Factors:  [97.4360288  -0.52815711 -0.9954483 ]
mat_Sqrt:  [[21.23372319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08682297 -0.95997239  7.1970562 ]
Stock Position:  0.08682296747053496
Bond Position:  [-0.22271448]


portfolio before change:  [8.18153753]
curr_Stock_Price:  96.79788763785515
curr_Factors:  [96.79788764 -0.289663   -1.00344836]
mat_Sqrt:  [[26.56285504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035148 -0.02443169  0.03525827]
Stock Position:  0.0003514807488169702
Bond Position:  [8.14751493]


portfolio before change:  [8.18273595]
curr_Stock_Price:  97.30977709292497
curr_Factors:  [97.30977709 -0.37537471 -0.97254647]
mat_Sqrt:  [[25.27910801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00203161  0.06390542 -0.34385083]
Stock Position:  0.002031605904112505
Bond Position:  [7.98504083]


portfolio before change:  [8.18612646]
curr_Stock_Price:  98.4873292856072
curr_Factors:  [98.48732929 -0.62095762 -0.96022485]
mat_Sqrt:  [[20.26196399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037094  0.04380904 -0.22766154]
Stock Position:  -0.0003709410392430922
Bond Position:  [8.22265946]


portfolio before change:  [8.1867746]
curr_Stock_Price:  99.511115474812
curr_Factors:  [99.51111547 -0.7109483  -0.9602437 ]
mat_Sqrt:  [[18.71035953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03676641 -0.58238402 -0.56529342]
Stock Position:  -0.03676640909743166
Bond Position:  [11.84544098]


portfolio before change:  [8.20355616]
curr_Stock_Price:  99.0949533711624
curr_Factors:  [99.09495337 -0.68441693 -0.93549374]
mat_Sqrt:  [[19.61251426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0008084   0.00680718 -0.00319728]
Stock Position:  0.000808396854143289
Bond Position:  [8.12344811]


portfolio before change:  [8.2056212]
curr_Stock_Price:  100.39326570006483
curr_Factors:  [100.3932657   -0.78964278  -0.95387191]
mat_Sqrt:  [[17.55924246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01307476 0.00444354 0.94320274]
Stock Position:  0.013074759469127478
Bond Position:  [6.8930034]


portfolio before change:  [8.18245968]
curr_Stock_Price:  98.55589314569625
curr_Factors:  [98.55589315 -0.7918892  -0.93360155]
mat_Sqrt:  [[17.55138884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171396 -0.01317159  0.12118194]
Stock Position:  0.001713959411876771
Bond Position:  [8.01353888]


portfolio before change:  [8.18322483]
curr_Stock_Price:  98.41784893896839
curr_Factors:  [98.41784894 -0.47382441 -0.95838272]
mat_Sqrt:  [[23.50034371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00448171 -0.01644605  0.08578078]
Stock Position:  0.004481710881636202
Bond Position:  [7.74214448]


portfolio before change:  [8.18572412]
curr_Stock_Price:  98.75956354079727
curr_Factors:  [98.75956354 -0.51093595 -0.98075985]
mat_Sqrt:  [[22.21999257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0103797  0.00039097 0.131955  ]
Stock Position:  0.010379702535840649
Bond Position:  [7.16062923]


portfolio before change:  [8.20498398]
curr_Stock_Price:  100.52885570076498
curr_Factors:  [100.5288557   -0.59560396  -0.99822441]
mat_Sqrt:  [[20.42207538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00517801 -0.00428697  0.18023923]
Stock Position:  -0.005178012450908435
Bond Position:  [8.72552365]


portfolio before change:  [8.20473043]
curr_Stock_Price:  100.78847464135626
curr_Factors:  [100.78847464  -0.61464182  -1.02383511]
mat_Sqrt:  [[19.58075271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00116758 -0.04624225  0.12337857]
Stock Position:  -0.0011675782126732144
Bond Position:  [8.32240886]


portfolio before change:  [8.2064365]
curr_Stock_Price:  100.21831926806534
curr_Factors:  [100.21831927  -0.54604955  -1.01696574]
mat_Sqrt:  [[20.99607914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00440072 -0.0012958   0.58762157]
Stock Position:  0.004400723739776224
Bond Position:  [7.76540336]


portfolio before change:  [8.20125439]
curr_Stock_Price:  98.82017584826465
curr_Factors:  [98.82017585 -0.73770425 -0.99953593]
mat_Sqrt:  [[17.39289179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049915 -0.03662697  0.02684358]
Stock Position:  -0.0004991467679476664
Bond Position:  [8.25058016]


portfolio before change:  [8.20221971]
curr_Stock_Price:  98.95253319947298
curr_Factors:  [98.9525332  -1.14060951 -1.01360208]
mat_Sqrt:  [[11.47796008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257353 -0.02105832  0.03129201]
Stock Position:  -0.0025735339602743065
Bond Position:  [8.45687742]


portfolio before change:  [8.20243447]
curr_Stock_Price:  99.2798748790632
curr_Factors:  [99.27987488 -1.04695839 -1.01431008]
mat_Sqrt:  [[12.63757367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.000448   -0.01786931  0.08773085]
Stock Position:  0.0004480024068491267
Bond Position:  [8.15795684]


portfolio before change:  [8.20344544]
curr_Stock_Price:  99.26016053761583
curr_Factors:  [99.26016054 -0.92496119 -1.03406131]
mat_Sqrt:  [[13.99530326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00024242 0.02509701 0.06926522]
Stock Position:  0.00024242060204970157
Bond Position:  [8.17938273]


portfolio before change:  [8.20431374]
curr_Stock_Price:  98.62412010734941
curr_Factors:  [98.62412011 -0.76278493 -1.00828114]
mat_Sqrt:  [[16.78104189  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00086937 -0.00447212 -0.21812725]
Stock Position:  0.0008693659489299828
Bond Position:  [8.11857329]


portfolio before change:  [8.20452451]
curr_Stock_Price:  97.69917330728559
curr_Factors:  [97.69917331 -0.83919899 -0.99297885]
mat_Sqrt:  [[15.63817833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359756  0.00289821 -0.11968686]
Stock Position:  -0.003597562972561822
Bond Position:  [8.55600344]


portfolio before change:  [8.20369441]
curr_Stock_Price:  98.22721444398675
curr_Factors:  [98.22721444 -0.93747121 -0.98355931]
mat_Sqrt:  [[14.38596082  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00670551 -0.00871472  0.11391308]
Stock Position:  -0.006705510019534144
Bond Position:  [8.86235798]


portfolio before change:  [8.20468134]
curr_Stock_Price:  98.24524947953638
curr_Factors:  [98.24524948 -1.09460204 -0.98862914]
mat_Sqrt:  [[12.2342051   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00467893 -0.00398642 -0.00603267]
Stock Position:  -0.004678931889982105
Bond Position:  [8.66436417]


portfolio before change:  [8.20823793]
curr_Stock_Price:  97.71660903239172
curr_Factors:  [97.71660903 -1.13590261 -0.95672236]
mat_Sqrt:  [[12.05460296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00657469  0.00109025  0.15818969]
Stock Position:  -0.006574686275014233
Bond Position:  [8.85069398]


portfolio before change:  [8.20399051]
curr_Stock_Price:  98.53091839846061
curr_Factors:  [98.5309184  -1.32266215 -0.94727781]
mat_Sqrt:  [[10.18005519  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01444677 -0.02195172 -0.22660799]
Stock Position:  -0.014446771839124515
Bond Position:  [9.6274442]


portfolio before change:  [8.21695134]
curr_Stock_Price:  97.71708041444255
curr_Factors:  [97.71708041 -1.21467983 -0.98478022]
mat_Sqrt:  [[10.83320901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.20721724 0.40785074 0.44216076]
Stock Position:  0.20721724108149694
Bond Position:  [-12.03171247]


portfolio before change:  [8.24163173]
curr_Stock_Price:  97.84344272075887
curr_Factors:  [97.84344272 -1.43532581 -1.0161627 ]
mat_Sqrt:  [[ 8.43070305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079046 -0.05036324 -0.04590104]
Stock Position:  0.0007904607580540074
Bond Position:  [8.16429033]


portfolio before change:  [8.24279838]
curr_Stock_Price:  98.0282054173574
curr_Factors:  [98.02820542 -1.14157735 -1.00576898]
mat_Sqrt:  [[11.44907477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0014891  -0.00462842 -0.17521441]
Stock Position:  0.0014891033310337287
Bond Position:  [8.09682425]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.24399256]
Stock Price:  98.15043339285648
PL:  [8.24399256]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [ 6.32583985e-02 -5.63214848e-02 -7.51405529e-02]
 [ 1.24284533e+00  2.40604998e-01  3.57364171e-01]
 [-1.39024918e-01 -4.14991711e-02  3.38517815e-02]
 [ 6.30293664e-02  5.24460977e-01  4.09893487e-01]
 [-4.74472403e-02 -3.42711758e-02 -2.05913229e-02]
 [ 5.71728201e-02  4.94078471e-02 -1.90024306e-02]
 [-3.25541577e-02 -1.16773107e-01 -3.78792027e-04]
 [ 1.21249899e-01  1.10384956e-01 -1.02604719e-01]
 [ 1.61155200e-03  7.87892943e-02 -4.86646681e-02]
 [-2.24206155e-01 -7.77687082e-02 -8.75151331e-02]
 [ 7.76314047e-01  1.49625193e+00 -2.69871902e-01]
 [-1.80597447e-04  3.28548095e-02 -5.84277277e-02]
 [-1.65451948e-01 -1.79633523e-02 -4.04031920e-01]
 [ 1.71093500e+00 -3.29536111e+00  2.76505581e+00]
 [ 3.58339850e-03 -9.23354649e-02  3.58416859e-02]
 [ 1.21485109e-01 -2.65848837e-02 -1.55722492e-02]
 [-8.71967302e-02 -6.23835498e-02 -5.16577089e-02]
 [-2.75831237e-01 -1.78535315e+00 -1.98049985e-01]
 [-2.24034809e-02  8.27788035e-02  3.64006301e-01]
 [ 2.14365456e-01  1.70840355e-01  5.08797913e-01]
 [ 5.08955919e-02 -2.15854173e-01 -5.56723726e-03]
 [ 1.01174286e-01 -4.95038599e-02  9.26083558e-03]
 [-1.43229571e-02  7.63754734e-02  2.77511557e-02]
 [ 2.83365390e-02 -1.41980644e-01 -1.35346840e-01]
 [ 1.90926599e-02 -2.87226655e-02  7.55292861e-03]
 [ 5.73287587e-03 -2.82690762e-02  2.20913793e-01]
 [ 3.70339189e-01 -1.09497396e-01  1.56788292e-01]
 [ 5.80690027e-02 -1.80296102e-01 -9.07800165e-02]
 [-7.21632311e-03 -7.19276564e-02 -9.82431185e-04]
 [-1.34369176e-02  6.47536305e-02  4.88274474e-02]
 [-1.86259181e-02 -1.58488879e-02 -6.64061755e-02]
 [-2.54073775e-02  2.17387748e-02 -5.24660307e-02]
 [-1.00483088e-01 -3.37516135e-02  3.98200928e-02]
 [ 1.98113767e-01  7.71254670e-03  3.78927255e-02]
 [-9.96609229e-02  2.21824258e-02  4.23443649e-02]
 [-1.15707470e-01 -6.69395588e-02 -7.82730880e-02]
 [ 1.09012435e+00  7.36027106e-01  1.23979160e-01]
 [ 3.00576634e-02 -1.34052067e-01 -8.10544459e-03]
 [ 3.29716381e-02 -1.45491985e-02 -7.16641667e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.12571873]
curr_Stock_Price:  100.23443383422097
curr_Factors:  [100.23443383  -1.14140818  -1.04253882]
mat_Sqrt:  [[11.28601982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00322734 -0.01817768 -0.21435508]
Stock Position:  0.0032273399346820597
Bond Position:  [3.80222814]


portfolio before change:  [4.12743712]
curr_Stock_Price:  100.61960540805822
curr_Factors:  [100.61960541  -1.03014519  -1.05811804]
mat_Sqrt:  [[12.46698434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10948159 0.07765493 1.01946051]
Stock Position:  0.10948159067702558
Bond Position:  [-6.88855733]


portfolio before change:  [4.14898404]
curr_Stock_Price:  100.82427948404221
curr_Factors:  [100.82427948  -1.31422787  -1.06330484]
mat_Sqrt:  [[ 9.35439693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01502886 -0.0133938   0.09656971]
Stock Position:  -0.015028861364284643
Bond Position:  [5.66425816]


portfolio before change:  [4.1290047]
curr_Stock_Price:  102.20079254762977
curr_Factors:  [102.20079255  -1.13561683  -1.0597048 ]
mat_Sqrt:  [[11.3772734   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02230356 0.16926905 1.16931202]
Stock Position:  0.022303557604142137
Bond Position:  [1.84956343]


portfolio before change:  [4.14444238]
curr_Stock_Price:  102.88258853477507
curr_Factors:  [102.88258853  -1.16536043  -1.05954383]
mat_Sqrt:  [[11.11932019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00527424 -0.01106097 -0.05874131]
Stock Position:  -0.0052742433839334
Bond Position:  [4.68707019]


portfolio before change:  [4.14670866]
curr_Stock_Price:  102.56399181380309
curr_Factors:  [102.56399181  -1.16712307  -1.04738607]
mat_Sqrt:  [[11.2007168   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0056585   0.01594631 -0.05420865]
Stock Position:  0.005658503903498965
Bond Position:  [3.56634991]


portfolio before change:  [4.1447205]
curr_Stock_Price:  102.13384625660161
curr_Factors:  [102.13384626  -1.17267544  -1.05944698]
mat_Sqrt:  [[10.95900779  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00515263 -0.03768836 -0.00108059]
Stock Position:  -0.005152627875440944
Bond Position:  [4.6709782]


portfolio before change:  [4.14449351]
curr_Stock_Price:  102.29122184077283
curr_Factors:  [102.29122184  -1.00727972  -1.07554984]
mat_Sqrt:  [[12.74315545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00963953  0.03562659 -0.2927027 ]
Stock Position:  0.009639530340093695
Bond Position:  [3.15845417]


portfolio before change:  [4.14718188]
curr_Stock_Price:  102.52915238598669
curr_Factors:  [102.52915239  -1.18564212  -1.09148067]
mat_Sqrt:  [[10.51733007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0007379   0.02542914 -0.13882675]
Stock Position:  0.0007378978818170036
Bond Position:  [4.07152584]


portfolio before change:  [4.14706667]
curr_Stock_Price:  101.68325939300544
curr_Factors:  [101.68325939  -1.17244096  -1.06614127]
mat_Sqrt:  [[10.840406    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02379473 -0.02509974 -0.24965632]
Stock Position:  -0.023794734078328796
Bond Position:  [6.56659279]


portfolio before change:  [4.15651298]
curr_Stock_Price:  101.32076604829327
curr_Factors:  [101.32076605  -1.17876122  -1.05145533]
mat_Sqrt:  [[10.89250385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09425269  0.48291323 -0.76986942]
Stock Position:  0.0942526930974211
Bond Position:  [-5.39324209]


portfolio before change:  [4.13770161]
curr_Stock_Price:  101.1283346816546
curr_Factors:  [101.12833468  -1.23112336  -1.09472531]
mat_Sqrt:  [[ 9.88028824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054661  0.01060384 -0.16667804]
Stock Position:  -0.0005466082975124571
Bond Position:  [4.19297919]


portfolio before change:  [4.13769383]
curr_Stock_Price:  102.10149231977562
curr_Factors:  [102.10149232  -1.37475814  -1.08931684]
mat_Sqrt:  [[ 8.68756212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02895995 -0.00579765 -1.15259061]
Stock Position:  -0.028959950938960012
Bond Position:  [7.09454803]


portfolio before change:  [4.14995415]
curr_Stock_Price:  101.70876208638357
curr_Factors:  [101.70876209  -1.15937699  -1.09082254]
mat_Sqrt:  [[10.71788587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.14953386 -1.06357322  7.88793458]
Stock Position:  0.14953386376695937
Bond Position:  [-11.05895003]


portfolio before change:  [4.14098911]
curr_Stock_Price:  101.65805396350494
curr_Factors:  [101.65805396  -1.37402577  -1.08918348]
mat_Sqrt:  [[ 8.65732267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091811 -0.02980114  0.10224635]
Stock Position:  -0.0009181066889451747
Bond Position:  [4.23432205]


portfolio before change:  [4.14201084]
curr_Stock_Price:  101.12172286444412
curr_Factors:  [101.12172286  -1.52344287  -1.0955243 ]
mat_Sqrt:  [[ 7.3695585   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01531704 -0.00858023 -0.04442329]
Stock Position:  0.015317039685502038
Bond Position:  [2.5931254]


portfolio before change:  [4.14132742]
curr_Stock_Price:  101.05594116348148
curr_Factors:  [101.05594116  -1.44114409  -1.07690386]
mat_Sqrt:  [[ 8.1468087   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01356056 -0.0201342  -0.14736506]
Stock Position:  -0.013560562025328508
Bond Position:  [5.51170278]


portfolio before change:  [4.15578309]
curr_Stock_Price:  100.04074295086207
curr_Factors:  [100.04074295  -1.3253315   -1.09824131]
mat_Sqrt:  [[ 8.86405842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07679233 -0.57622025 -0.56498148]
Stock Position:  -0.07679233087183814
Bond Position:  [11.83814492]


portfolio before change:  [4.13660332]
curr_Stock_Price:  100.30977542824066
curr_Factors:  [100.30977543  -1.38137092  -1.11390075]
mat_Sqrt:  [[ 8.27295275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00831579 0.02671674 1.03840866]
Stock Position:  0.00831579108034012
Bond Position:  [3.30244818]


portfolio before change:  [4.13462195]
curr_Stock_Price:  100.02186601499194
curr_Factors:  [100.02186601  -1.49351041  -1.10909604]
mat_Sqrt:  [[ 7.40964383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04765358 0.05513849 1.45145882]
Stock Position:  0.047653577505468336
Bond Position:  [-0.63177779]


portfolio before change:  [4.12943559]
curr_Stock_Price:  99.91468851251328
curr_Factors:  [99.91468851 -1.56292159 -1.0975245 ]
mat_Sqrt:  [[ 6.98573784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00081568 -0.06966663 -0.01588178]
Stock Position:  0.0008156813021602752
Bond Position:  [4.04793704]


portfolio before change:  [4.12986935]
curr_Stock_Price:  99.82610493819804
curr_Factors:  [99.82610494 -1.57845747 -1.08897212]
mat_Sqrt:  [[ 6.93097254  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01341222 -0.0159773   0.02641859]
Stock Position:  0.013412217757904441
Bond Position:  [2.7909799]


portfolio before change:  [4.1295498]
curr_Stock_Price:  99.77626632575972
curr_Factors:  [99.77626633 -1.27710626 -1.12575844]
mat_Sqrt:  [[ 9.02560594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00076802 0.02465008 0.07916632]
Stock Position:  0.000768015141082034
Bond Position:  [4.05292012]


portfolio before change:  [4.13037007]
curr_Stock_Price:  100.18461586329788
curr_Factors:  [100.18461586  -1.52749295  -1.14734236]
mat_Sqrt:  [[ 6.90454116  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0040948  -0.04582406 -0.38610686]
Stock Position:  -0.0040947973029418425
Bond Position:  [4.54060576]


portfolio before change:  [4.12962124]
curr_Stock_Price:  100.50610590292506
curr_Factors:  [100.5061059   -1.62056025  -1.15413455]
mat_Sqrt:  [[ 6.26841596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235648 -0.0092702   0.0215464 ]
Stock Position:  0.002356481379682146
Bond Position:  [3.89278047]


portfolio before change:  [4.12994316]
curr_Stock_Price:  100.43620960607772
curr_Factors:  [100.43620961  -1.54593663  -1.18331454]
mat_Sqrt:  [[ 6.55528523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00687328 -0.00912381  0.63020556]
Stock Position:  0.0068732804727224235
Bond Position:  [3.43961692]


portfolio before change:  [4.12962822]
curr_Stock_Price:  100.32783007526267
curr_Factors:  [100.32783008  -1.30072364  -1.19729539]
mat_Sqrt:  [[ 8.25174009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04604997 -0.03534013  0.44727336]
Stock Position:  0.04604997235538981
Bond Position:  [-0.49046558]


portfolio before change:  [4.13817799]
curr_Stock_Price:  100.5148245408335
curr_Factors:  [100.51482454  -1.32163604  -1.18547749]
mat_Sqrt:  [[ 8.19227548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00033395 -0.05819032 -0.25897012]
Stock Position:  0.00033395137611871563
Bond Position:  [4.10461093]


portfolio before change:  [4.13878513]
curr_Stock_Price:  100.7963973544862
curr_Factors:  [100.79639735  -1.33193727  -1.1813333 ]
mat_Sqrt:  [[ 8.16479849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270662 -0.02321455 -0.0028026 ]
Stock Position:  -0.0027066231276963396
Bond Position:  [4.411603]


portfolio before change:  [4.14162414]
curr_Stock_Price:  99.9512405137002
curr_Factors:  [99.95124051 -0.94679877 -1.18815466]
mat_Sqrt:  [[11.81924388  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00082473 0.02089914 0.13929112]
Stock Position:  0.0008247332048904805
Bond Position:  [4.05919103]


portfolio before change:  [4.14252098]
curr_Stock_Price:  100.42340000324933
curr_Factors:  [100.4234      -1.00006527  -1.22048351]
mat_Sqrt:  [[10.90091216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324892 -0.00511521 -0.18943833]
Stock Position:  -0.003248917351743827
Bond Position:  [4.4687883]


portfolio before change:  [4.14476356]
curr_Stock_Price:  99.90508753132454
curr_Factors:  [99.90508753 -1.09494916 -1.23565788]
mat_Sqrt:  [[ 9.71444133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00326108  0.00701616 -0.14967098]
Stock Position:  -0.0032610781486196215
Bond Position:  [4.47056186]


portfolio before change:  [4.1456463]
curr_Stock_Price:  99.80577140608307
curr_Factors:  [99.80577141 -1.24940328 -1.23125578]
mat_Sqrt:  [[ 8.35255055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01188192 -0.01089329  0.11359564]
Stock Position:  -0.011881923290858987
Bond Position:  [5.33153082]


portfolio before change:  [4.15223963]
curr_Stock_Price:  99.30695924563875
curr_Factors:  [99.30695925 -1.10483512 -1.22760369]
mat_Sqrt:  [[ 9.63860945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02152    0.00248921 0.1080974 ]
Stock Position:  0.02152000304747219
Bond Position:  [2.01515356]


portfolio before change:  [4.12959535]
curr_Stock_Price:  98.24301019583
curr_Factors:  [98.2430102  -0.90000776 -1.21686739]
mat_Sqrt:  [[11.82917521  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00731154  0.00715935  0.12079669]
Stock Position:  -0.007311536544353097
Bond Position:  [4.84790271]


portfolio before change:  [4.13353408]
curr_Stock_Price:  97.78719643370083
curr_Factors:  [97.78719643 -0.96539669 -1.21909466]
mat_Sqrt:  [[11.00447823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01320816 -0.02160465 -0.22329133]
Stock Position:  -0.013208157077860676
Bond Position:  [5.42512273]


portfolio before change:  [4.13511425]
curr_Stock_Price:  97.71890627895213
curr_Factors:  [97.71890628 -1.01543522 -1.22468408]
mat_Sqrt:  [[10.40176763  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.12167859 0.23755173 0.35367803]
Stock Position:  0.12167858733072726
Bond Position:  [-7.75518423]


portfolio before change:  [4.13662473]
curr_Stock_Price:  97.73928735085937
curr_Factors:  [97.73928735 -1.18302474 -1.20836918]
mat_Sqrt:  [[ 8.94334501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00011627 -0.04326512 -0.02312258]
Stock Position:  0.000116274486138682
Bond Position:  [4.12526014]


portfolio before change:  [4.13713844]
curr_Stock_Price:  97.7222748694203
curr_Factors:  [97.72227487 -0.94995087 -1.1995482 ]
mat_Sqrt:  [[11.38880046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00134987 -0.00469573 -0.20443792]
Stock Position:  0.0013498707483240158
Bond Position:  [4.005226]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.13887506]
Stock Price:  98.63786982415694
PL:  [4.13887506]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 1.19295398e+02 -4.92756718e+01 -4.92955691e+01]
 [-2.68750355e-02 -7.72180339e-02  1.97478851e-01]
 [ 1.87640272e-01  2.15277480e-01  4.91560602e-02]
 [-5.61148660e-01 -4.42225278e-01  4.48896390e-02]
 [ 2.90499666e-01  1.61942556e+00  1.75694704e+00]
 [-4.77785891e-02 -3.25123067e-02 -1.78964659e-02]
 [-5.42414380e-02  4.46953490e-01 -2.21291247e-01]
 [-4.95566415e-02 -7.77749616e-03 -7.42004660e-02]
 [-3.70390163e-02  6.80900371e-02  2.33319990e-02]
 [ 5.60380674e-02  1.98910086e-02 -3.97165125e-02]
 [-9.97181532e-03  6.40156692e-03  4.67321991e-02]
 [ 8.24955694e-01  1.68855054e+00 -2.61605649e-01]
 [-1.05274266e-03  1.60402123e-02  9.44999736e-02]
 [-4.70046043e-01 -1.44237884e-02 -1.00161278e+00]
 [ 1.90682908e+00 -3.15642548e+00  2.66877479e+00]
 [ 2.32703774e-02 -7.44619361e-02  1.05501287e-02]
 [ 8.41368077e-02  1.05187371e-01 -8.04777226e-02]
 [-1.72524034e-02  1.47854907e-01 -7.88728843e-02]
 [-2.88066547e-01 -1.85344013e+00 -1.97475460e-01]
 [ 2.44857718e-02 -3.73409904e-02  2.79660784e-02]
 [-7.29032119e-02  2.61699124e-01  1.51935782e-01]
 [ 1.72206678e-02  1.00366222e-01 -6.03302055e-02]
 [ 9.07913260e-02 -4.76472564e-02  4.68828358e-02]
 [-8.22985558e-03 -1.09567952e-01 -1.08914780e-01]
 [-2.20894155e-01  6.31321977e-02  3.22609555e-02]
 [ 1.03974585e-01 -1.41944116e-03 -3.68617816e-02]
 [ 3.38229430e-03 -4.98264822e-02  2.31233866e-01]
 [-1.99052971e-01 -1.43480543e-01 -7.10542514e-02]
 [-2.09267550e-01  1.61062425e-01  2.71584280e-01]
 [ 1.46339601e-01  1.09033234e-01  2.26376256e-01]
 [-1.62631726e-01  1.19106275e-01 -6.02109855e-02]
 [ 1.25932058e-01  9.16927088e-03  2.00230400e-02]
 [ 2.27733390e-02 -1.96890159e-03 -5.82794816e-02]
 [ 4.08371780e-02  7.49646818e-02  1.24823814e-01]
 [-7.70459890e-03 -4.04442411e-02  7.17359051e-03]
 [-8.45010134e-02  5.38659379e-02  5.35196504e-02]
 [-9.88471065e-02 -5.59901706e-02 -6.23321490e-02]
 [ 1.48513187e+00  9.69200922e-01  1.36630433e-01]
 [ 1.10542063e-01 -1.52041899e-01  5.76291154e-02]
 [ 3.05672599e-02 -1.51645814e-02 -3.10373517e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29539799 -49.27567179 -49.29556912]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32806888  -15.90365468 -140.62653745]
init_Out:  [2.49906563]
Stock Position:  7.328068876294426
Bond position:  [-730.307822]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.84137423]
curr_Stock_Price:  99.42015478428836
curr_Factors:  [99.42015478 -0.8659283  -0.9845707 ]
mat_Sqrt:  [[15.62474476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.48923969e-04 -2.49220133e-02  5.63352194e-01]
Stock Position:  -0.00014892396941083673
Bond Position:  [-1.82656818]


portfolio before change:  [-1.84144432]
curr_Stock_Price:  98.35758206909212
curr_Factors:  [98.35758207 -0.8049367  -0.97144013]
mat_Sqrt:  [[16.6470464   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01451414 0.06948051 0.14022856]
Stock Position:  0.014514138823168054
Bond Position:  [-3.26901992]


portfolio before change:  [-1.85685728]
curr_Stock_Price:  97.32381044256825
curr_Factors:  [97.32381044 -0.80358377 -0.98183352]
mat_Sqrt:  [[16.32383616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03934458 -0.14272759  0.12805765]
Stock Position:  -0.039344578785221254
Bond Position:  [1.97230705]


portfolio before change:  [-1.86297729]
curr_Stock_Price:  97.4856259113657
curr_Factors:  [97.48562591 -0.49758103 -1.02026335]
mat_Sqrt:  [[21.36727531  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04585043 0.52266735 5.01208088]
Stock Position:  0.045850433584355754
Bond Position:  [-6.3327355]


portfolio before change:  [-1.81824366]
curr_Stock_Price:  98.47853404511514
curr_Factors:  [98.47853405 -0.53278667 -1.02670713]
mat_Sqrt:  [[20.70437021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280464 -0.0104933  -0.05105364]
Stock Position:  -0.0028046367083756256
Bond Position:  [-1.54204715]


portfolio before change:  [-1.81711061]
curr_Stock_Price:  98.00580939670526
curr_Factors:  [98.0058094  -0.45121459 -1.01900411]
mat_Sqrt:  [[22.52910565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.63011545e-04  1.44253619e-01 -6.31282331e-01]
Stock Position:  -0.000363011545499574
Bond Position:  [-1.78153337]


portfolio before change:  [-1.81761751]
curr_Stock_Price:  98.7886973635573
curr_Factors:  [98.78869736 -0.38149803 -1.03926871]
mat_Sqrt:  [[23.86031118  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277827 -0.00251018 -0.21167328]
Stock Position:  -0.0027782673261181967
Bond Position:  [-1.5431561]


portfolio before change:  [-1.81592452]
curr_Stock_Price:  98.10989628637797
curr_Factors:  [98.10989629 -0.40530401 -1.05140254]
mat_Sqrt:  [[22.85984078  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080392  0.02197596  0.0665597 ]
Stock Position:  -0.000803923856528757
Bond Position:  [-1.73705164]


portfolio before change:  [-1.81680878]
curr_Stock_Price:  98.93971127247694
curr_Factors:  [98.93971127 -0.68460691 -1.06257533]
mat_Sqrt:  [[17.24165836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00301544  0.0064198  -0.11330016]
Stock Position:  0.0030154409893176234
Bond Position:  [-2.11515564]


portfolio before change:  [-1.82003578]
curr_Stock_Price:  97.9572367307629
curr_Factors:  [97.95723673 -0.70324553 -1.05501381]
mat_Sqrt:  [[16.88240028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [5.17739914e-05 2.06609684e-03 1.33313956e-01]
Stock Position:  5.177399139664284e-05
Bond Position:  [-1.82510742]


portfolio before change:  [-1.82027074]
curr_Stock_Price:  97.82576753410703
curr_Factors:  [97.82576753 -0.64454229 -1.06433291]
mat_Sqrt:  [[17.71324758  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06301665  0.54497734 -0.7462881 ]
Stock Position:  0.06301665436844006
Bond Position:  [-7.98492332]


portfolio before change:  [-1.78056708]
curr_Stock_Price:  98.47165778649793
curr_Factors:  [98.47165779 -0.61488218 -1.05287236]
mat_Sqrt:  [[18.57867154  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00115784 0.00517696 0.26958212]
Stock Position:  0.0011578426503884142
Bond Position:  [-1.89458176]


portfolio before change:  [-1.78189877]
curr_Stock_Price:  97.52606078748069
curr_Factors:  [97.52606079 -0.8320269  -1.04903854]
mat_Sqrt:  [[14.86566501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04557103 -0.00465526 -2.85732247]
Stock Position:  -0.04557102815930939
Bond Position:  [2.6624641]


portfolio before change:  [-1.8295884]
curr_Stock_Price:  98.57985449623088
curr_Factors:  [98.5798545  -0.83396947 -1.08183861]
mat_Sqrt:  [[14.51320391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.12452714 -1.01873194  7.61327162]
Stock Position:  0.124527141526202
Bond Position:  [-14.10545589]


portfolio before change:  [-1.91373861]
curr_Stock_Price:  97.91825646240258
curr_Factors:  [97.91825646 -0.83373325 -1.06640658]
mat_Sqrt:  [[14.64345067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00069823 -0.02403249  0.03009658]
Stock Position:  0.0006982257499400751
Bond Position:  [-1.98210765]


portfolio before change:  [-1.91353675]
curr_Stock_Price:  98.56222312028767
curr_Factors:  [98.56222312 -0.64838055 -1.07918635]
mat_Sqrt:  [[17.51611222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00509135  0.03394908 -0.22958054]
Stock Position:  0.00509134918295432
Bond Position:  [-2.41535144]


portfolio before change:  [-1.91347443]
curr_Stock_Price:  98.63376782708218
curr_Factors:  [98.63376783 -0.60598923 -1.06260038]
mat_Sqrt:  [[18.59372338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.70568691e-04  4.77199659e-02 -2.25002385e-01]
Stock Position:  -0.00017056869089715504
Bond Position:  [-1.8966506]


portfolio before change:  [-1.91359525]
curr_Stock_Price:  97.95209956970265
curr_Factors:  [97.95209957 -0.72254996 -1.04815241]
mat_Sqrt:  [[16.6727593   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04238698 -0.59819523 -0.56334252]
Stock Position:  -0.042386981365386045
Bond Position:  [2.23829857]


portfolio before change:  [-1.87622056]
curr_Stock_Price:  97.07695145419837
curr_Factors:  [97.07695145 -0.62287214 -1.03225368]
mat_Sqrt:  [[18.54830025  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00121694 -0.01205175  0.07977944]
Stock Position:  0.0012169377002156508
Bond Position:  [-1.99435716]


portfolio before change:  [-1.87712255]
curr_Stock_Price:  96.54062396238501
curr_Factors:  [96.54062396 -0.54735308 -1.04010716]
mat_Sqrt:  [[19.7371698   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00058416 0.08446303 0.43343049]
Stock Position:  0.0005841597231992451
Bond Position:  [-1.93351769]


portfolio before change:  [-1.87852096]
curr_Stock_Price:  94.56051303388979
curr_Factors:  [94.56051303 -0.61052919 -1.04480036]
mat_Sqrt:  [[18.06380902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140574  0.03239306 -0.17210528]
Stock Position:  0.0014057381515031524
Bond Position:  [-2.01144828]


portfolio before change:  [-1.87880038]
curr_Stock_Price:  94.54060706381274
curr_Factors:  [94.54060706 -0.58808988 -1.0439959 ]
mat_Sqrt:  [[18.48470566  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00490326 -0.01537809  0.13374368]
Stock Position:  0.004903258453594087
Bond Position:  [-2.34235742]


portfolio before change:  [-1.87858125]
curr_Stock_Price:  94.64501704169535
curr_Factors:  [94.64501704 -0.62661094 -1.00829063]
mat_Sqrt:  [[18.45308684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028628  -0.0353629  -0.31070355]
Stock Position:  -0.0028627978127030228
Bond Position:  [-1.6076317]


portfolio before change:  [-1.87825658]
curr_Stock_Price:  94.46140918235548
curr_Factors:  [94.46140918 -0.78698438 -0.99410207]
mat_Sqrt:  [[15.91249943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01265811  0.02037583  0.09203153]
Stock Position:  -0.012658106271999044
Bond Position:  [-0.68255403]


portfolio before change:  [-1.88427871]
curr_Stock_Price:  94.93042126936959
curr_Factors:  [94.93042127 -0.77106035 -1.00838131]
mat_Sqrt:  [[16.01783125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00600334 -0.00045812 -0.1051564 ]
Stock Position:  0.006003338505578743
Bond Position:  [-2.45417817]


portfolio before change:  [-1.88164445]
curr_Stock_Price:  95.42032483296818
curr_Factors:  [95.42032483 -0.90447623 -1.02856103]
mat_Sqrt:  [[13.80808571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00292669 -0.01608143  0.65964586]
Stock Position:  0.0029266853057265
Bond Position:  [-2.16090971]


portfolio before change:  [-1.88380952]
curr_Stock_Price:  94.77285264588048
curr_Factors:  [94.77285265 -0.90201596 -1.0563438 ]
mat_Sqrt:  [[13.3714687   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01816141 -0.04630815 -0.202698  ]
Stock Position:  -0.018161408297473747
Bond Position:  [-0.16260105]


portfolio before change:  [-1.86481678]
curr_Stock_Price:  93.72595858158907
curr_Factors:  [93.72595858 -0.79914068 -1.06898936]
mat_Sqrt:  [[14.47242551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00835754  0.05198267  0.77475436]
Stock Position:  -0.008357542471836586
Bond Position:  [-1.0814981]


portfolio before change:  [-1.86590454]
curr_Stock_Price:  93.83993569071174
curr_Factors:  [93.83993569 -0.70947955 -1.04948053]
mat_Sqrt:  [[16.16147686  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01329116 0.03519032 0.64578845]
Stock Position:  0.013291160107799323
Bond Position:  [-3.11314615]


portfolio before change:  [-1.85752011]
curr_Stock_Price:  94.5000440984167
curr_Factors:  [94.5000441  -0.71422439 -1.08880905]
mat_Sqrt:  [[15.5734395   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00967094  0.03844139 -0.17176518]
Stock Position:  -0.009670938442390435
Bond Position:  [-0.943616]


portfolio before change:  [-1.84321778]
curr_Stock_Price:  93.00894947377004
curr_Factors:  [93.00894947 -1.06931522 -1.07763954]
mat_Sqrt:  [[10.86711177  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0121367  0.00295937 0.05712016]
Stock Position:  0.012136703459101617
Bond Position:  [-2.97203982]


portfolio before change:  [-1.8395425]
curr_Stock_Price:  93.34238532551255
curr_Factors:  [93.34238533 -1.11343638 -1.08801338]
mat_Sqrt:  [[10.32764768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00101429 -0.00063546 -0.16625514]
Stock Position:  0.0010142860797762985
Bond Position:  [-1.93421838]


portfolio before change:  [-1.83943721]
curr_Stock_Price:  93.6845807836235
curr_Factors:  [93.68458078 -1.14762122 -1.09471607]
mat_Sqrt:  [[ 9.95023661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0082027  0.02419475 0.3560876 ]
Stock Position:  0.00820270282805946
Bond Position:  [-2.60790398]


portfolio before change:  [-1.84071863]
curr_Stock_Price:  93.56810451630182
curr_Factors:  [93.56810452 -1.21147796 -1.09038123]
mat_Sqrt:  [[ 9.36360512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154812 -0.01305332  0.02046426]
Stock Position:  -0.001548115476882474
Bond Position:  [-1.6958644]


portfolio before change:  [-1.84182003]
curr_Stock_Price:  94.14260906343365
curr_Factors:  [94.14260906 -1.14439993 -1.06893588]
mat_Sqrt:  [[10.29311211  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00607989  0.01738516  0.15267667]
Stock Position:  -0.006079893172894271
Bond Position:  [-1.26944302]


portfolio before change:  [-1.84214604]
curr_Stock_Price:  94.17012888364476
curr_Factors:  [94.17012888 -1.05002109 -1.05798131]
mat_Sqrt:  [[11.43982429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01075187 -0.01807075 -0.17781627]
Stock Position:  -0.010751873955961675
Bond Position:  [-0.82964068]


portfolio before change:  [-1.84734275]
curr_Stock_Price:  94.64381403632669
curr_Factors:  [94.64381404 -1.10316116 -1.05942704]
mat_Sqrt:  [[10.88659605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.15715277 0.31280825 0.38976859]
Stock Position:  0.1571527725603888
Bond Position:  [-16.72088053]


portfolio before change:  [-1.88649446]
curr_Stock_Price:  94.40798324166865
curr_Factors:  [94.40798324 -1.0443932  -1.05684148]
mat_Sqrt:  [[11.5465992   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0079045  -0.04907131  0.16439983]
Stock Position:  0.007904503545527209
Bond Position:  [-2.63274269]


portfolio before change:  [-1.88401056]
curr_Stock_Price:  94.76385806116222
curr_Factors:  [94.76385806 -1.23034352 -1.09019171]
mat_Sqrt:  [[ 9.30780094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227082 -0.00489435 -0.08854093]
Stock Position:  0.002270818842611965
Bond Position:  [-2.09920211]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.88354456]
Stock Price:  95.0846273057079
PL:  [-1.88354456]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  0.2579063195702334
FINAL STD P&L:  5.913635271037658
