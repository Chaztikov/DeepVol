WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-18 23:59:52.980655: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-18 23:59:53.007377: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-18 23:59:53.008070: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 23:59:53.010555: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 23:59:53.013151: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 23:59:53.014026: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 23:59:53.016607: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 23:59:53.018632: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 23:59:53.023809: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 23:59:53.025902: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 23:59:53.026345: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-18 23:59:53.032717: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399775000 Hz
2019-12-18 23:59:53.032880: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55bbc9ce4880 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-18 23:59:53.032897: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-18 23:59:53.033955: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-18 23:59:53.033978: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 23:59:53.033989: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 23:59:53.033999: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 23:59:53.034009: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 23:59:53.034019: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 23:59:53.034028: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 23:59:53.034038: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 23:59:53.035923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 23:59:53.035949: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 23:59:53.127827: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-18 23:59:53.127860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-18 23:59:53.127870: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-18 23:59:53.130802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2019-12-18 23:59:53.132856: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55bbca31db70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-18 23:59:53.132878: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
INFO   Y0_true: -1.0000e+00
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-19 00:00:01.087965: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 2.8296e+02,   Y0: 2.5120e+00,  elapsed time   8
INFO   step:     1,    loss: 2.5943e+02,   Y0: 2.5170e+00,  elapsed time  11
INFO   step:     2,    loss: 2.5940e+02,   Y0: 2.5213e+00,  elapsed time  12
INFO   step:     3,    loss: 2.5936e+02,   Y0: 2.5194e+00,  elapsed time  12
INFO   step:     4,    loss: 2.5933e+02,   Y0: 2.5165e+00,  elapsed time  13
INFO   step:     5,    loss: 2.5931e+02,   Y0: 2.5156e+00,  elapsed time  14
INFO   step:     6,    loss: 2.5927e+02,   Y0: 2.5133e+00,  elapsed time  15
INFO   step:     7,    loss: 2.5924e+02,   Y0: 2.5111e+00,  elapsed time  16
INFO   step:     8,    loss: 2.5921e+02,   Y0: 2.5096e+00,  elapsed time  17
INFO   step:     9,    loss: 2.5918e+02,   Y0: 2.5096e+00,  elapsed time  18
INFO   step:    10,    loss: 2.5914e+02,   Y0: 2.5093e+00,  elapsed time  19
INFO   step:    11,    loss: 2.5910e+02,   Y0: 2.5086e+00,  elapsed time  19
INFO   step:    12,    loss: 2.5907e+02,   Y0: 2.5077e+00,  elapsed time  20
INFO   step:    13,    loss: 2.5905e+02,   Y0: 2.5062e+00,  elapsed time  21
INFO   step:    14,    loss: 2.5902e+02,   Y0: 2.5047e+00,  elapsed time  22
INFO   step:    15,    loss: 2.5899e+02,   Y0: 2.5039e+00,  elapsed time  23
INFO   step:    16,    loss: 2.5896e+02,   Y0: 2.5038e+00,  elapsed time  24
INFO   step:    17,    loss: 2.5893e+02,   Y0: 2.5040e+00,  elapsed time  25
INFO   step:    18,    loss: 2.5890e+02,   Y0: 2.5045e+00,  elapsed time  26
INFO   step:    19,    loss: 2.5887e+02,   Y0: 2.5056e+00,  elapsed time  26
INFO   step:    20,    loss: 2.5884e+02,   Y0: 2.5063e+00,  elapsed time  27
INFO   step:    21,    loss: 2.5881e+02,   Y0: 2.5072e+00,  elapsed time  28
INFO   step:    22,    loss: 2.5877e+02,   Y0: 2.5084e+00,  elapsed time  29
INFO   step:    23,    loss: 2.5873e+02,   Y0: 2.5096e+00,  elapsed time  30
INFO   step:    24,    loss: 2.5871e+02,   Y0: 2.5105e+00,  elapsed time  31
INFO   step:    25,    loss: 2.5869e+02,   Y0: 2.5103e+00,  elapsed time  32
INFO   step:    26,    loss: 2.5867e+02,   Y0: 2.5107e+00,  elapsed time  33
INFO   step:    27,    loss: 2.5866e+02,   Y0: 2.5118e+00,  elapsed time  33
INFO   step:    28,    loss: 2.5864e+02,   Y0: 2.5131e+00,  elapsed time  34
INFO   step:    29,    loss: 2.5862e+02,   Y0: 2.5150e+00,  elapsed time  35
INFO   step:    30,    loss: 2.5860e+02,   Y0: 2.5163e+00,  elapsed time  36
INFO   step:    31,    loss: 2.5858e+02,   Y0: 2.5166e+00,  elapsed time  37
INFO   step:    32,    loss: 2.5856e+02,   Y0: 2.5174e+00,  elapsed time  38
INFO   step:    33,    loss: 2.5854e+02,   Y0: 2.5180e+00,  elapsed time  39
INFO   step:    34,    loss: 2.5852e+02,   Y0: 2.5182e+00,  elapsed time  40
INFO   step:    35,    loss: 2.5849e+02,   Y0: 2.5185e+00,  elapsed time  40
INFO   step:    36,    loss: 2.5847e+02,   Y0: 2.5193e+00,  elapsed time  41
INFO   step:    37,    loss: 2.5845e+02,   Y0: 2.5207e+00,  elapsed time  42
INFO   step:    38,    loss: 2.5843e+02,   Y0: 2.5217e+00,  elapsed time  43
INFO   step:    39,    loss: 2.5841e+02,   Y0: 2.5226e+00,  elapsed time  44
INFO   step:    40,    loss: 2.5839e+02,   Y0: 2.5239e+00,  elapsed time  45
INFO   step:    41,    loss: 2.5836e+02,   Y0: 2.5251e+00,  elapsed time  46
INFO   step:    42,    loss: 2.5833e+02,   Y0: 2.5263e+00,  elapsed time  47
INFO   step:    43,    loss: 2.5831e+02,   Y0: 2.5268e+00,  elapsed time  47
INFO   step:    44,    loss: 2.5828e+02,   Y0: 2.5277e+00,  elapsed time  48
INFO   step:    45,    loss: 2.5825e+02,   Y0: 2.5276e+00,  elapsed time  49
INFO   step:    46,    loss: 2.5822e+02,   Y0: 2.5278e+00,  elapsed time  50
INFO   step:    47,    loss: 2.5820e+02,   Y0: 2.5287e+00,  elapsed time  51
INFO   step:    48,    loss: 2.5817e+02,   Y0: 2.5288e+00,  elapsed time  52
INFO   step:    49,    loss: 2.5814e+02,   Y0: 2.5292e+00,  elapsed time  53
INFO   step:    50,    loss: 2.5811e+02,   Y0: 2.5297e+00,  elapsed time  54
INFO   step:    51,    loss: 2.5808e+02,   Y0: 2.5299e+00,  elapsed time  54
INFO   step:    52,    loss: 2.5804e+02,   Y0: 2.5296e+00,  elapsed time  55
INFO   step:    53,    loss: 2.5801e+02,   Y0: 2.5297e+00,  elapsed time  56
INFO   step:    54,    loss: 2.5797e+02,   Y0: 2.5304e+00,  elapsed time  57
INFO   step:    55,    loss: 2.5793e+02,   Y0: 2.5311e+00,  elapsed time  58
INFO   step:    56,    loss: 2.5789e+02,   Y0: 2.5324e+00,  elapsed time  59
INFO   step:    57,    loss: 2.5786e+02,   Y0: 2.5349e+00,  elapsed time  60
INFO   step:    58,    loss: 2.5782e+02,   Y0: 2.5369e+00,  elapsed time  61
INFO   step:    59,    loss: 2.5779e+02,   Y0: 2.5375e+00,  elapsed time  62
INFO   step:    60,    loss: 2.5775e+02,   Y0: 2.5383e+00,  elapsed time  62
INFO   step:    61,    loss: 2.5772e+02,   Y0: 2.5397e+00,  elapsed time  63
INFO   step:    62,    loss: 2.5769e+02,   Y0: 2.5406e+00,  elapsed time  64
INFO   step:    63,    loss: 2.5766e+02,   Y0: 2.5404e+00,  elapsed time  65
INFO   step:    64,    loss: 2.5763e+02,   Y0: 2.5395e+00,  elapsed time  66
INFO   step:    65,    loss: 2.5760e+02,   Y0: 2.5387e+00,  elapsed time  67
INFO   step:    66,    loss: 2.5757e+02,   Y0: 2.5370e+00,  elapsed time  68
INFO   step:    67,    loss: 2.5755e+02,   Y0: 2.5357e+00,  elapsed time  69
INFO   step:    68,    loss: 2.5752e+02,   Y0: 2.5343e+00,  elapsed time  70
INFO   step:    69,    loss: 2.5750e+02,   Y0: 2.5334e+00,  elapsed time  70
INFO   step:    70,    loss: 2.5748e+02,   Y0: 2.5326e+00,  elapsed time  71
INFO   step:    71,    loss: 2.5745e+02,   Y0: 2.5322e+00,  elapsed time  72
INFO   step:    72,    loss: 2.5742e+02,   Y0: 2.5317e+00,  elapsed time  73
INFO   step:    73,    loss: 2.5740e+02,   Y0: 2.5316e+00,  elapsed time  74
INFO   step:    74,    loss: 2.5737e+02,   Y0: 2.5314e+00,  elapsed time  75
INFO   step:    75,    loss: 2.5734e+02,   Y0: 2.5311e+00,  elapsed time  76
INFO   step:    76,    loss: 2.5731e+02,   Y0: 2.5312e+00,  elapsed time  77
INFO   step:    77,    loss: 2.5728e+02,   Y0: 2.5317e+00,  elapsed time  78
INFO   step:    78,    loss: 2.5725e+02,   Y0: 2.5332e+00,  elapsed time  78
INFO   step:    79,    loss: 2.5721e+02,   Y0: 2.5349e+00,  elapsed time  79
INFO   step:    80,    loss: 2.5718e+02,   Y0: 2.5365e+00,  elapsed time  80
INFO   step:    81,    loss: 2.5715e+02,   Y0: 2.5380e+00,  elapsed time  81
INFO   step:    82,    loss: 2.5711e+02,   Y0: 2.5397e+00,  elapsed time  82
INFO   step:    83,    loss: 2.5708e+02,   Y0: 2.5419e+00,  elapsed time  83
INFO   step:    84,    loss: 2.5705e+02,   Y0: 2.5446e+00,  elapsed time  84
INFO   step:    85,    loss: 2.5702e+02,   Y0: 2.5467e+00,  elapsed time  85
INFO   step:    86,    loss: 2.5698e+02,   Y0: 2.5488e+00,  elapsed time  85
INFO   step:    87,    loss: 2.5695e+02,   Y0: 2.5509e+00,  elapsed time  86
INFO   step:    88,    loss: 2.5692e+02,   Y0: 2.5529e+00,  elapsed time  87
INFO   step:    89,    loss: 2.5689e+02,   Y0: 2.5544e+00,  elapsed time  88
INFO   step:    90,    loss: 2.5686e+02,   Y0: 2.5553e+00,  elapsed time  89
INFO   step:    91,    loss: 2.5683e+02,   Y0: 2.5558e+00,  elapsed time  90
INFO   step:    92,    loss: 2.5680e+02,   Y0: 2.5569e+00,  elapsed time  91
INFO   step:    93,    loss: 2.5677e+02,   Y0: 2.5582e+00,  elapsed time  92
INFO   step:    94,    loss: 2.5674e+02,   Y0: 2.5586e+00,  elapsed time  93
INFO   step:    95,    loss: 2.5671e+02,   Y0: 2.5589e+00,  elapsed time  94
INFO   step:    96,    loss: 2.5668e+02,   Y0: 2.5583e+00,  elapsed time  94
INFO   step:    97,    loss: 2.5665e+02,   Y0: 2.5574e+00,  elapsed time  95
INFO   step:    98,    loss: 2.5661e+02,   Y0: 2.5561e+00,  elapsed time  96
INFO   step:    99,    loss: 2.5659e+02,   Y0: 2.5549e+00,  elapsed time  97
INFO   step:   100,    loss: 2.5656e+02,   Y0: 2.5543e+00,  elapsed time  98
INFO   step:   101,    loss: 2.5653e+02,   Y0: 2.5539e+00,  elapsed time  99
INFO   step:   102,    loss: 2.5650e+02,   Y0: 2.5529e+00,  elapsed time 100
INFO   step:   103,    loss: 2.5647e+02,   Y0: 2.5519e+00,  elapsed time 101
INFO   step:   104,    loss: 2.5645e+02,   Y0: 2.5507e+00,  elapsed time 102
INFO   step:   105,    loss: 2.5642e+02,   Y0: 2.5499e+00,  elapsed time 102
INFO   step:   106,    loss: 2.5639e+02,   Y0: 2.5500e+00,  elapsed time 103
INFO   step:   107,    loss: 2.5637e+02,   Y0: 2.5502e+00,  elapsed time 104
INFO   step:   108,    loss: 2.5634e+02,   Y0: 2.5507e+00,  elapsed time 105
INFO   step:   109,    loss: 2.5631e+02,   Y0: 2.5516e+00,  elapsed time 106
INFO   step:   110,    loss: 2.5628e+02,   Y0: 2.5527e+00,  elapsed time 107
INFO   step:   111,    loss: 2.5625e+02,   Y0: 2.5530e+00,  elapsed time 108
INFO   step:   112,    loss: 2.5622e+02,   Y0: 2.5531e+00,  elapsed time 109
INFO   step:   113,    loss: 2.5619e+02,   Y0: 2.5526e+00,  elapsed time 110
INFO   step:   114,    loss: 2.5616e+02,   Y0: 2.5521e+00,  elapsed time 110
INFO   step:   115,    loss: 2.5613e+02,   Y0: 2.5510e+00,  elapsed time 111
INFO   step:   116,    loss: 2.5610e+02,   Y0: 2.5499e+00,  elapsed time 112
INFO   step:   117,    loss: 2.5607e+02,   Y0: 2.5501e+00,  elapsed time 113
INFO   step:   118,    loss: 2.5604e+02,   Y0: 2.5496e+00,  elapsed time 114
INFO   step:   119,    loss: 2.5601e+02,   Y0: 2.5488e+00,  elapsed time 115
INFO   step:   120,    loss: 2.5598e+02,   Y0: 2.5474e+00,  elapsed time 116
INFO   step:   121,    loss: 2.5595e+02,   Y0: 2.5456e+00,  elapsed time 117
INFO   step:   122,    loss: 2.5593e+02,   Y0: 2.5442e+00,  elapsed time 118
INFO   step:   123,    loss: 2.5590e+02,   Y0: 2.5419e+00,  elapsed time 119
INFO   step:   124,    loss: 2.5588e+02,   Y0: 2.5396e+00,  elapsed time 119
INFO   step:   125,    loss: 2.5585e+02,   Y0: 2.5375e+00,  elapsed time 120
INFO   step:   126,    loss: 2.5582e+02,   Y0: 2.5363e+00,  elapsed time 121
INFO   step:   127,    loss: 2.5579e+02,   Y0: 2.5356e+00,  elapsed time 122
INFO   step:   128,    loss: 2.5576e+02,   Y0: 2.5349e+00,  elapsed time 123
INFO   step:   129,    loss: 2.5574e+02,   Y0: 2.5348e+00,  elapsed time 124
INFO   step:   130,    loss: 2.5571e+02,   Y0: 2.5346e+00,  elapsed time 125
INFO   step:   131,    loss: 2.5568e+02,   Y0: 2.5348e+00,  elapsed time 126
INFO   step:   132,    loss: 2.5566e+02,   Y0: 2.5345e+00,  elapsed time 127
INFO   step:   133,    loss: 2.5563e+02,   Y0: 2.5343e+00,  elapsed time 127
INFO   step:   134,    loss: 2.5560e+02,   Y0: 2.5354e+00,  elapsed time 128
INFO   step:   135,    loss: 2.5557e+02,   Y0: 2.5355e+00,  elapsed time 129
INFO   step:   136,    loss: 2.5554e+02,   Y0: 2.5354e+00,  elapsed time 130
INFO   step:   137,    loss: 2.5551e+02,   Y0: 2.5354e+00,  elapsed time 131
INFO   step:   138,    loss: 2.5548e+02,   Y0: 2.5347e+00,  elapsed time 132
INFO   step:   139,    loss: 2.5545e+02,   Y0: 2.5343e+00,  elapsed time 133
INFO   step:   140,    loss: 2.5542e+02,   Y0: 2.5344e+00,  elapsed time 134
INFO   step:   141,    loss: 2.5539e+02,   Y0: 2.5345e+00,  elapsed time 135
INFO   step:   142,    loss: 2.5537e+02,   Y0: 2.5345e+00,  elapsed time 135
INFO   step:   143,    loss: 2.5534e+02,   Y0: 2.5339e+00,  elapsed time 136
INFO   step:   144,    loss: 2.5531e+02,   Y0: 2.5332e+00,  elapsed time 137
INFO   step:   145,    loss: 2.5528e+02,   Y0: 2.5332e+00,  elapsed time 138
INFO   step:   146,    loss: 2.5525e+02,   Y0: 2.5331e+00,  elapsed time 139
INFO   step:   147,    loss: 2.5522e+02,   Y0: 2.5325e+00,  elapsed time 140
INFO   step:   148,    loss: 2.5519e+02,   Y0: 2.5322e+00,  elapsed time 141
INFO   step:   149,    loss: 2.5516e+02,   Y0: 2.5322e+00,  elapsed time 142
Delta:  120 ,  120.05
Other1:  -50.05 ,  -50
Other2:  -50.05 ,  -50
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 3) dtype=float64>]
num_iterations:  150
total time intervals:  10
# of dimensions:  3
Loss out:  275.7321034372745
Output_Z_Vals:  [[[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
  [ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
  [ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
  ...
  [ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
  [ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
  [ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]]

 [[-8.03153296e-01 -1.84338348e-01 -6.91801174e-02]
  [-1.32741942e+00 -3.12195070e-01 -6.90602822e-02]
  [-1.06691518e+00 -2.67922665e-01 -3.98241302e-02]
  ...
  [-8.67437785e-01 -2.05784554e-01 -7.68897961e-02]
  [-7.76837036e-01 -1.83136718e-01 -4.48578305e-02]
  [-1.20556327e+00 -2.99120309e-01 -3.93100570e-02]]

 [[-2.21908516e-02  1.64731159e-01  2.32313838e-01]
  [-7.98950599e-02  2.08031576e-01  4.54808442e-01]
  [ 2.99823078e-02  5.91931482e-02 -2.93077077e-03]
  ...
  [ 2.10457327e-02  6.66389645e-02 -2.04204514e-02]
  [ 4.88380852e-03  1.02905473e-01  8.01343503e-02]
  [ 4.46462073e-02  4.63107088e-02  2.56163516e-02]]

 ...

 [[-5.04398718e-02 -2.55507156e-02  5.00557302e-02]
  [-2.54908303e-02 -5.46183663e-04 -5.12219562e-02]
  [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
  ...
  [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
  [-5.05026312e-02  3.51720945e-03  5.28509893e-02]
  [-5.04798377e-02 -7.03994482e-03  5.18357816e-02]]

 [[-2.57649949e-02 -7.36463337e-02  2.99965241e-02]
  [-5.90648503e-04 -1.08852687e-02 -2.37149245e-02]
  [ 1.29156045e-02  3.22018536e-04 -3.72230584e-02]
  ...
  [-4.48899963e-03 -1.94677574e-02 -1.62115052e-02]
  [-3.84337256e-02 -1.01993770e-01  5.81807108e-02]
  [-1.15129027e-02 -5.01624631e-02  7.57414435e-03]]

 [[-5.22593701e-02  5.88365939e-02 -4.08364751e-02]
  [ 2.31505060e-01  3.56206620e-03  7.77560512e-02]
  [ 1.69116585e-01  4.11352191e-02  4.13698551e-02]
  ...
  [ 1.19239318e-01  7.80977539e-02  4.05541029e-03]
  [-2.31088722e-02  8.31197941e-02 -3.27920375e-02]
  [ 2.02719838e-01  1.06118436e-02  6.77590380e-02]]]
Z_Vals dimensionality:  (10, 200, 3)
X_test:  [[[ 1.00000000e+02  9.96041643e+01  1.01758085e+02 ...  1.00037386e+02
    9.84104968e+01  9.58791297e+01]
  [-1.00000000e+00 -1.27973196e+00 -1.13740224e+00 ... -5.73729542e-01
   -7.27266108e-01 -2.63986362e-01]
  [-1.00000000e+00 -9.64691453e-01 -9.79547642e-01 ... -1.04333926e+00
   -1.02875861e+00 -9.97169364e-01]]

 [[ 1.00000000e+02  1.01787673e+02  1.03486676e+02 ...  1.10654638e+02
    1.07798019e+02  1.07518840e+02]
  [-1.00000000e+00 -1.07303770e+00 -1.02268545e+00 ... -8.38138654e-01
   -8.72520380e-01 -7.44078738e-01]
  [-1.00000000e+00 -9.65347684e-01 -9.59008015e-01 ... -1.05391823e+00
   -1.04527857e+00 -1.03757507e+00]]

 [[ 1.00000000e+02  1.00269138e+02  9.90134208e+01 ...  1.02822205e+02
    1.05169758e+02  1.06129136e+02]
  [-1.00000000e+00 -8.28956853e-01 -6.51776449e-01 ... -2.86042564e-01
   -1.05056876e+00 -1.02061206e+00]
  [-1.00000000e+00 -1.04485701e+00 -1.12410829e+00 ... -1.20225177e+00
   -1.18099157e+00 -1.18322745e+00]]

 ...

 [[ 1.00000000e+02  1.00168114e+02  9.85598658e+01 ...  1.01477874e+02
    1.02406542e+02  1.04155618e+02]
  [-1.00000000e+00 -1.32577141e+00 -1.11865183e+00 ... -1.15883055e+00
   -1.43414940e+00 -1.51993336e+00]
  [-1.00000000e+00 -9.84391875e-01 -9.72543524e-01 ... -9.86109878e-01
   -9.28030700e-01 -9.11008240e-01]]

 [[ 1.00000000e+02  9.88790916e+01  9.98234288e+01 ...  9.86022309e+01
    1.01207350e+02  1.00454506e+02]
  [-1.00000000e+00 -9.31924864e-01 -1.48241017e+00 ... -4.29054828e-01
   -6.95814031e-01 -6.53171456e-01]
  [-1.00000000e+00 -1.02836605e+00 -9.76819473e-01 ... -9.48376268e-01
   -9.62603873e-01 -9.47289464e-01]]

 [[ 1.00000000e+02  1.00878724e+02  9.90499829e+01 ...  1.01225800e+02
    1.07268326e+02  1.08306669e+02]
  [-1.00000000e+00 -8.36982382e-01 -4.20690484e-01 ... -1.00432786e-01
   -8.13004670e-01 -9.70856732e-01]
  [-1.00000000e+00 -1.04792311e+00 -1.05436244e+00 ... -1.01836592e+00
   -1.03934937e+00 -1.05128364e+00]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.03153296e-01 -1.84338348e-01 -6.91801174e-02]
 [-2.21908516e-02  1.64731159e-01  2.32313838e-01]
 [-8.82753108e-02  3.98528720e-01  4.81356381e-01]
 [ 1.54038859e-01  8.15645065e-02  9.30994257e-02]
 [ 5.27359444e-02  6.03320319e-05  2.81605747e-02]
 [-3.01148554e-02  6.84743069e-03 -2.20640255e-02]
 [-5.04398718e-02 -2.55507156e-02  5.00557302e-02]
 [-2.57649949e-02 -7.36463337e-02  2.99965241e-02]
 [-5.22593701e-02  5.88365939e-02 -4.08364751e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.73357786]
curr_Stock_Price:  99.60416427058935
curr_Factors:  [99.60416427 -1.27973196 -0.96469145]
mat_Sqrt:  [[10.55690937  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08098038 -0.05949495 -0.19735162]
Stock Position:  -0.08098038030950518
Bond Position:  [7.33240524]


portfolio before change:  [-0.90433604]
curr_Stock_Price:  101.75808476454418
curr_Factors:  [101.75808476  -1.13740224  -0.97954764]
mat_Sqrt:  [[12.25150018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00480395 0.05316675 0.66272672]
Stock Position:  0.00480395200723159
Bond Position:  [-1.393177]


portfolio before change:  [-0.91376553]
curr_Stock_Price:  99.94026456912091
curr_Factors:  [99.94026457 -0.77549199 -0.97338629]
mat_Sqrt:  [[17.38650567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00525295 0.12862459 1.37317577]
Stock Position:  0.005252952202686188
Bond Position:  [-1.43874696]


portfolio before change:  [-0.9217604]
curr_Stock_Price:  98.55526728658752
curr_Factors:  [98.55526729 -0.31367549 -1.01452474]
mat_Sqrt:  [[26.11258138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00726439 0.02632483 0.26558675]
Stock Position:  0.007264390387109011
Bond Position:  [-1.63770434]


portfolio before change:  [-0.89535362]
curr_Stock_Price:  102.30311593935117
curr_Factors:  [102.30311594  -0.56237762  -1.02596394]
mat_Sqrt:  [[20.89685291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.79929773e-03 1.94720796e-05 8.03342811e-02]
Stock Position:  0.0027992977267465974
Bond Position:  [-1.1817305]


portfolio before change:  [-0.90073253]
curr_Stock_Price:  100.59272607097789
curr_Factors:  [100.59272607  -0.1394916   -1.0153521 ]
mat_Sqrt:  [[31.69745062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104806  0.00221    -0.06294252]
Stock Position:  -0.0010480631465420542
Bond Position:  [-0.795305]


portfolio before change:  [-0.90071884]
curr_Stock_Price:  100.20015163481197
curr_Factors:  [100.20015163  -0.27213246  -1.01508785]
mat_Sqrt:  [[27.65895089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164279 -0.00824646  0.14279507]
Stock Position:  -0.0016427885085165904
Bond Position:  [-0.73611118]


portfolio before change:  [-0.9008196]
curr_Stock_Price:  100.0373861027588
curr_Factors:  [100.0373861   -0.57372954  -1.04333926]
mat_Sqrt:  [[19.85538346  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174638 -0.02376925  0.08557173]
Stock Position:  -0.0017463764940744255
Bond Position:  [-0.72611666]


portfolio before change:  [-0.89834158]
curr_Stock_Price:  98.41049677242728
curr_Factors:  [98.41049677 -0.72726611 -1.02875861]
mat_Sqrt:  [[16.99845997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00285821  0.01898943 -0.1164951 ]
Stock Position:  -0.002858206643204165
Bond Position:  [-0.61706405]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.89141502]
Stock Price:  95.87912972376274
PL:  [-0.89141502]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.32741942e+00 -3.12195070e-01 -6.90602822e-02]
 [-7.98950599e-02  2.08031576e-01  4.54808442e-01]
 [-1.22996765e-01  6.45163367e-01  6.31547832e-01]
 [ 1.20034847e-01  3.47850552e-02  1.69737584e-02]
 [ 2.89434936e-02 -3.21529176e-02 -1.13120240e-02]
 [ 4.99280558e-02  4.84777406e-03 -4.56444916e-02]
 [-2.54908303e-02 -5.46183663e-04 -5.12219562e-02]
 [-5.90648503e-04 -1.08852687e-02 -2.37149245e-02]
 [ 2.31505060e-01  3.56206620e-03  7.77560512e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.26566415]
curr_Stock_Price:  101.78767267106579
curr_Factors:  [101.78767267  -1.0730377   -0.96534768]
mat_Sqrt:  [[13.2567071   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10600241 -0.10076053 -0.19700976]
Stock Position:  -0.1060024056658963
Bond Position:  [26.05540232]


portfolio before change:  [15.09859672]
curr_Stock_Price:  103.48667552254214
curr_Factors:  [103.48667552  -1.02268545  -0.95900801]
mat_Sqrt:  [[14.26415003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00388432 0.0671419  1.29744189]
Stock Position:  0.0038843248380509197
Bond Position:  [14.69662086]


portfolio before change:  [15.11349952]
curr_Stock_Price:  105.43106650347185
curr_Factors:  [105.4310665   -1.55014144  -0.97235851]
mat_Sqrt:  [[ 8.46176173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01626267 0.20822558 1.80163017]
Stock Position:  0.0162626674907231
Bond Position:  [13.39890914]


portfolio before change:  [15.12297736]
curr_Stock_Price:  105.60180817236947
curr_Factors:  [105.60180817  -1.31670342  -1.01311858]
mat_Sqrt:  [[10.27643578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01270869 0.01122683 0.04842141]
Stock Position:  0.012708693267024165
Bond Position:  [13.78091637]


portfolio before change:  [15.12042215]
curr_Stock_Price:  104.85842770327672
curr_Factors:  [104.8584277   -1.12619664  -1.01681234]
mat_Sqrt:  [[12.30003562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016318  -0.01037731 -0.03227006]
Stock Position:  0.00163180418022348
Bond Position:  [14.94931373]


portfolio before change:  [15.12810149]
curr_Stock_Price:  104.98271793364373
curr_Factors:  [104.98271793  -0.54112173  -1.03689567]
mat_Sqrt:  [[21.66673957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00192001  0.00156461 -0.13021103]
Stock Position:  0.0019200148015588205
Bond Position:  [14.92653312]


portfolio before change:  [15.14630638]
curr_Stock_Price:  110.57629615727033
curr_Factors:  [110.57629616  -1.22615534  -1.03994394]
mat_Sqrt:  [[11.4685266   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314408 -0.00017628 -0.14612198]
Stock Position:  -0.003144079339475735
Bond Position:  [15.49396703]


portfolio before change:  [15.15380898]
curr_Stock_Price:  110.65463841202144
curr_Factors:  [110.65463841  -0.83813865  -1.05391823]
mat_Sqrt:  [[16.68244721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045877 -0.00351321 -0.06765208]
Stock Position:  -0.00045876862470616855
Bond Position:  [15.20457386]


portfolio before change:  [15.1627237]
curr_Stock_Price:  107.7980193598782
curr_Factors:  [107.79801936  -0.87252038  -1.04527857]
mat_Sqrt:  [[15.83876376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01566436 0.00114965 0.22181637]
Stock Position:  0.015664357096637594
Bond Position:  [13.47413703]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.16508929]
Stock Price:  107.51883995083338
PL:  [7.64624934]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.06691518e+00 -2.67922665e-01 -3.98241302e-02]
 [ 2.99823078e-02  5.91931482e-02 -2.93077077e-03]
 [-8.93124430e-02  4.11573226e-01  4.92360787e-01]
 [ 1.74907612e-01  1.01714700e-01  1.45725467e-01]
 [ 4.94858690e-02 -5.79315395e-02  9.94153848e-02]
 [-1.07337997e-01 -6.22253053e-02  1.67179742e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 1.29156045e-02  3.22018536e-04 -3.72230584e-02]
 [ 1.69116585e-01  4.11352191e-02  4.13698551e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.13888736]
curr_Stock_Price:  100.26913756958524
curr_Factors:  [100.26913757  -0.82895685  -1.04485701]
mat_Sqrt:  [[15.39502     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07338306 -0.08647167 -0.11360716]
Stock Position:  -0.07338306330738238
Bond Position:  [11.49694383]


portfolio before change:  [4.23678561]
curr_Stock_Price:  99.0134208360332
curr_Factors:  [99.01342084 -0.65177645 -1.12410829]
mat_Sqrt:  [[16.76629581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00247322  0.01910451 -0.00836067]
Stock Position:  0.0024732247339376593
Bond Position:  [3.99190317]


portfolio before change:  [4.24065154]
curr_Stock_Price:  99.76930706043464
curr_Factors:  [99.76930706 -0.4016318  -1.11187923]
mat_Sqrt:  [[21.96278777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00433471 0.13283469 1.40456828]
Stock Position:  0.004334709954993703
Bond Position:  [3.80818053]


portfolio before change:  [4.23386222]
curr_Stock_Price:  97.76366301608168
curr_Factors:  [ 9.77636630e+01 -8.23377584e-03 -1.12397962e+00]
mat_Sqrt:  [[31.51109077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00715355 0.03282828 0.4157142 ]
Stock Position:  0.007153548760522094
Bond Position:  [3.53450509]


portfolio before change:  [4.20375821]
curr_Stock_Price:  93.30829262760709
curr_Factors:  [93.30829263 -0.36123823 -1.13027272]
mat_Sqrt:  [[20.99738776  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00276004 -0.01869732  0.28360442]
Stock Position:  0.0027600444439404162
Bond Position:  [3.94622317]


portfolio before change:  [4.2049683]
curr_Stock_Price:  93.0316644054103
curr_Factors:  [ 9.30316644e+01 -3.37783490e-02 -1.15587820e+00]
mat_Sqrt:  [[28.31193274  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00411936 -0.02008313  0.04769173]
Stock Position:  -0.004119363500420821
Bond Position:  [4.58819955]


portfolio before change:  [4.16124852]
curr_Stock_Price:  104.20194833749659
curr_Factors:  [104.20194834  -0.59923579  -1.16971344]
mat_Sqrt:  [[17.76768937  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270149 -0.01197701  0.13962421]
Stock Position:  -0.002701485154400099
Bond Position:  [4.44274853]


portfolio before change:  [4.1671978]
curr_Stock_Price:  102.82220475529051
curr_Factors:  [102.82220476  -0.28604256  -1.20225177]
mat_Sqrt:  [[23.21287294  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.31906292e-04  1.03931036e-04 -1.06187025e-01]
Stock Position:  0.0002319062918983947
Bond Position:  [4.14335269]


portfolio before change:  [4.16981441]
curr_Stock_Price:  105.16975758273362
curr_Factors:  [105.16975758  -1.05056876  -1.18099157]
mat_Sqrt:  [[11.29110731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01646941 0.01327633 0.11801668]
Stock Position:  0.016469408848226865
Bond Position:  [2.43773067]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.18683398]
Stock Price:  106.12913623821782
PL:  [-1.94230226]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.68382598e-01 -1.89861525e-01 -1.10859569e-01]
 [-5.94937086e-03  1.27518756e-01  1.42916179e-01]
 [-8.12663050e-02  3.10437414e-01  4.17341771e-01]
 [ 1.03486729e-01  2.54732179e-02  1.20238777e-02]
 [ 5.41407853e-02 -1.31324709e-02  3.68207989e-02]
 [-3.50568580e-02  4.11221013e-03 -1.90373528e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-1.56560289e-02 -2.84042830e-02 -5.26515547e-03]
 [ 1.85624100e-01  1.15277837e-01 -7.54232983e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.53308021]
curr_Stock_Price:  100.86883829209876
curr_Factors:  [100.86883829  -1.71471497  -1.01408134]
mat_Sqrt:  [[ 6.58651732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.14116216 -0.06127754 -0.31625149]
Stock Position:  -0.14116216339174045
Bond Position:  [22.77194364]


portfolio before change:  [8.59166344]
curr_Stock_Price:  100.5345106869453
curr_Factors:  [100.53451069  -1.50088146  -1.01363621]
mat_Sqrt:  [[ 8.13343532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00605561 0.0411565  0.40770008]
Stock Position:  0.0060556120507779575
Bond Position:  [7.98286544]


portfolio before change:  [8.5966976]
curr_Stock_Price:  100.70653775617816
curr_Factors:  [100.70653776  -1.46736108  -0.94328004]
mat_Sqrt:  [[ 9.03919029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00744436 0.10019324 1.19055991]
Stock Position:  0.007444361377538992
Bond Position:  [7.84700174]


portfolio before change:  [8.59892918]
curr_Stock_Price:  100.47913055188323
curr_Factors:  [100.47913055  -1.3870209   -0.94244604]
mat_Sqrt:  [[ 9.78140479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01136246 0.00822145 0.03430078]
Stock Position:  0.011362457078120143
Bond Position:  [7.45723937]


portfolio before change:  [8.58752728]
curr_Stock_Price:  99.14742528715551
curr_Factors:  [99.14742529 -1.41681057 -0.9274958 ]
mat_Sqrt:  [[ 9.50959716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00620175 -0.00423849  0.10503949]
Stock Position:  0.006201750086041986
Bond Position:  [7.97263973]


portfolio before change:  [8.59687824]
curr_Stock_Price:  100.01228400472168
curr_Factors:  [100.012284    -1.25090004  -0.92471554]
mat_Sqrt:  [[11.35521876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00335559  0.00132721 -0.05430827]
Stock Position:  -0.0033555883682923632
Bond Position:  [8.9324783]


portfolio before change:  [8.5995518]
curr_Stock_Price:  100.54685413611968
curr_Factors:  [100.54685414  -1.92540557  -0.883433  ]
mat_Sqrt:  [[ 6.06045731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00792005 -0.01197701  0.13962421]
Stock Position:  -0.007920053980059702
Bond Position:  [9.39588831]


portfolio before change:  [8.60490402]
curr_Stock_Price:  100.46439219455532
curr_Factors:  [100.46439219  -2.0890915   -0.91205821]
mat_Sqrt:  [[ 4.99608024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00450929 -0.00916744 -0.01502002]
Stock Position:  -0.004509289923796249
Bond Position:  [9.05792709]


portfolio before change:  [8.60848006]
curr_Stock_Price:  100.67596839118039
curr_Factors:  [100.67596839  -2.15280234  -0.9509869 ]
mat_Sqrt:  [[ 4.51821895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04595074  0.03720576 -0.02151617]
Stock Position:  0.045950743088663856
Bond Position:  [3.9823445]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.6075482]
Stock Price:  100.61234534324336
PL:  [7.99520286]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.77069515e-01 -1.83576314e-01 -3.13523113e-02]
 [ 7.96076048e-02  5.06009684e-03  1.01007925e-02]
 [-9.41537833e-02  5.09438543e-01  5.62344727e-01]
 [ 1.73717507e-02  1.85269777e-01  8.27353789e-02]
 [-3.60616258e-02 -1.79113615e-01  2.72492959e-01]
 [-9.57894615e-02  3.65409516e-01 -8.71208861e-02]
 [ 3.05052470e-01  6.50369355e-01  3.26107239e-01]
 [-4.21416714e-02 -1.27277835e-01 -1.37716066e-02]
 [ 4.32632959e-02 -4.19240550e-01 -1.83789004e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.44880579]
curr_Stock_Price:  98.55122282594786
curr_Factors:  [98.55122283 -0.84707642 -0.96995124]
mat_Sqrt:  [[16.01536839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05125962 -0.059249   -0.08943942]
Stock Position:  -0.05125961621440669
Bond Position:  [-3.39710793]


portfolio before change:  [-8.27643517]
curr_Stock_Price:  95.15537994097686
curr_Factors:  [95.15537994 -0.49595342 -0.94618563]
mat_Sqrt:  [[22.49677768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00367618 0.00163314 0.02881475]
Stock Position:  0.003676184629687304
Bond Position:  [-8.62624391]


portfolio before change:  [-8.26799153]
curr_Stock_Price:  98.6257810156563
curr_Factors:  [ 9.86257810e+01 -1.42821025e-02 -9.73223487e-01]
mat_Sqrt:  [[36.73856823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00339216 0.16442058 1.60421298]
Stock Position:  0.0033921588822857255
Bond Position:  [-8.60254585]


portfolio before change:  [-8.28792505]
curr_Stock_Price:  94.01775187463127
curr_Factors:  [ 9.40177519e+01  5.41331515e-02 -9.61377803e-01]
mat_Sqrt:  [[37.94884098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00189935 0.05979556 0.23602101]
Stock Position:  0.0018993484990232133
Bond Position:  [-8.46649752]


portfolio before change:  [-8.30170544]
curr_Stock_Price:  88.99177138131247
curr_Factors:  [88.99177138 -0.53747304 -0.87146379]
mat_Sqrt:  [[21.74985471  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078164 -0.05780867  0.77734656]
Stock Position:  -0.0007816441715545258
Bond Position:  [-8.23214554]


portfolio before change:  [-8.30436373]
curr_Stock_Price:  87.12543229522262
curr_Factors:  [87.1254323  -1.05037995 -0.87729205]
mat_Sqrt:  [[12.67557393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307552  0.11793541 -0.24853164]
Stock Position:  -0.0030755240785394233
Bond Position:  [-8.03640737]


portfolio before change:  [-8.31059341]
curr_Stock_Price:  87.8441621548173
curr_Factors:  [87.84416215 -1.14438072 -0.85505945]
mat_Sqrt:  [[11.89507184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04240201 0.20990581 0.93029318]
Stock Position:  0.042402007041141845
Bond Position:  [-12.03536219]


portfolio before change:  [-8.29367789]
curr_Stock_Price:  88.38504957303456
curr_Factors:  [88.38504957 -0.9500076  -0.90543762]
mat_Sqrt:  [[13.8219459   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00513193 -0.04107874 -0.03928656]
Stock Position:  -0.005131930672439958
Bond Position:  [-7.84009194]


portfolio before change:  [-8.29920583]
curr_Stock_Price:  88.69817101769897
curr_Factors:  [88.69817102 -0.66942788 -0.93346213]
mat_Sqrt:  [[17.85617266  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0044707  -0.13530931 -0.52429887]
Stock Position:  -0.004470700299979367
Bond Position:  [-7.90266289]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.32231719]
Stock Price:  92.983638447793
PL:  [-8.32231719]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.05286885e+00 -2.73843301e-01 -2.07558115e-02]
 [-1.13265178e-02  1.40742806e-01  1.58787449e-01]
 [-8.97057575e-02  4.57172319e-01  5.17001463e-01]
 [ 1.01175473e-01  2.41726442e-02  1.13325334e-02]
 [ 5.58783895e-02 -2.57091257e-02  4.00739076e-02]
 [-2.24053384e-02  1.60268626e-02 -2.53076057e-02]
 [-5.04753128e-02 -9.13573726e-03  5.16342439e-02]
 [-1.62518826e-02 -4.27292179e-02  4.65300339e-03]
 [-4.95347789e-02  6.58204422e-02 -3.69948249e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.86390402]
curr_Stock_Price:  99.8221817932311
curr_Factors:  [99.82218179 -0.62954961 -1.00861709]
mat_Sqrt:  [[19.39904279  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05737415 -0.08838255 -0.05921055]
Stock Position:  -0.05737415281472154
Bond Position:  [6.59111713]


portfolio before change:  [0.77955296]
curr_Stock_Price:  101.34982872854815
curr_Factors:  [101.34982873  -0.27313396  -0.99517505]
mat_Sqrt:  [[28.51040709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00174725 0.04542455 0.45297639]
Stock Position:  0.0017472510757395464
Bond Position:  [0.60246936]


portfolio before change:  [0.77569645]
curr_Stock_Price:  98.97019786137096
curr_Factors:  [98.97019786 -0.25225302 -1.00091499]
mat_Sqrt:  [[28.2657482   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00386145 0.14755173 1.47486127]
Stock Position:  0.003861445035547755
Bond Position:  [0.39352847]


portfolio before change:  [0.77784994]
curr_Stock_Price:  99.47691730954271
curr_Factors:  [99.47691731 -1.07609562 -0.95614245]
mat_Sqrt:  [[13.03564548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00831742 0.00780169 0.03232856]
Stock Position:  0.008317419870732352
Bond Position:  [-0.04954135]


portfolio before change:  [0.77602225]
curr_Stock_Price:  99.26015409555465
curr_Factors:  [99.2601541  -1.55619603 -0.89768312]
mat_Sqrt:  [[ 8.53235208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00689266 -0.00829758  0.1143197 ]
Stock Position:  0.006892658411022075
Bond Position:  [0.09185591]


portfolio before change:  [0.78128445]
curr_Stock_Price:  100.01693981307389
curr_Factors:  [100.01693981  -1.32273152  -0.9083788 ]
mat_Sqrt:  [[10.74273013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226197  0.00517265 -0.07219555]
Stock Position:  -0.0022619726875560387
Bond Position:  [1.00752004]


portfolio before change:  [0.78347198]
curr_Stock_Price:  99.27261408848699
curr_Factors:  [99.27261409 -1.20493201 -0.92158659]
mat_Sqrt:  [[11.83843148  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035309  -0.00294855  0.14729813]
Stock Position:  -0.003530902000517361
Bond Position:  [1.13399385]


portfolio before change:  [0.77920297]
curr_Stock_Price:  100.64227755713067
curr_Factors:  [100.64227756  -1.2061562   -0.93636823]
mat_Sqrt:  [[11.81119724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203402 -0.0137908   0.01327372]
Stock Position:  -0.0020340154199680145
Bond Position:  [0.98391092]


portfolio before change:  [0.78090341]
curr_Stock_Price:  100.04820442895625
curr_Factors:  [100.04820443  -0.36398163  -0.9339689 ]
mat_Sqrt:  [[27.32225553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00159763  0.02124346 -0.10553594]
Stock Position:  -0.0015976270477194407
Bond Position:  [0.94074312]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.77718196]
Stock Price:  102.67205805448545
PL:  [-1.8948761]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.13789513e+00 -2.64186218e-01 -8.10555278e-02]
 [-1.97460422e-02  1.58991186e-01  2.20959002e-01]
 [-9.00058570e-02  3.80533699e-01  4.56804655e-01]
 [ 1.08900457e-01  2.85195919e-02  1.36432345e-02]
 [ 4.74552168e-02 -3.24777919e-03  5.18402711e-02]
 [ 3.68766549e-02  1.93777987e-02 -4.57344702e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 5.50339282e-03  7.73093337e-04 -3.42595253e-02]
 [ 1.99696894e-02  7.23909131e-02 -8.44092748e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.00015937]
curr_Stock_Price:  101.47848622871565
curr_Factors:  [101.47848623  -1.44595758  -0.95185419]
mat_Sqrt:  [[ 9.22608733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.13097289 -0.08526574 -0.23122886]
Stock Position:  -0.13097288815076522
Bond Position:  [26.2910898]


portfolio before change:  [13.00867053]
curr_Stock_Price:  101.51389563353601
curr_Factors:  [101.51389563  -1.36000888  -0.97069705]
mat_Sqrt:  [[ 9.86990042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0058573  0.05131418 0.63033453]
Stock Position:  0.005857299752353523
Bond Position:  [12.41407322]


portfolio before change:  [13.01778395]
curr_Stock_Price:  102.0098291331492
curr_Factors:  [102.00982913  -1.6193863   -0.94010737]
mat_Sqrt:  [[ 7.88983727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01025561 0.12281672 1.30313653]
Stock Position:  0.010255613141924233
Bond Position:  [11.97161061]


portfolio before change:  [13.03157779]
curr_Stock_Price:  102.7710258730342
curr_Factors:  [102.77102587  -1.69373473  -0.90446776]
mat_Sqrt:  [[ 7.64690485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0153666  0.00920466 0.03892035]
Stock Position:  0.015366597406999869
Bond Position:  [11.45233682]


portfolio before change:  [13.03939203]
curr_Stock_Price:  102.90681647463609
curr_Factors:  [102.90681647  -1.84425119  -0.94306489]
mat_Sqrt:  [[ 6.33764851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0090529  -0.00104822  0.14788586]
Stock Position:  0.009052903081111884
Bond Position:  [12.1077866]


portfolio before change:  [13.04837521]
curr_Stock_Price:  103.2302230370199
curr_Factors:  [103.23022304  -1.55672199  -0.98302466]
mat_Sqrt:  [[ 8.14345895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00386772  0.00625416 -0.13046771]
Stock Position:  0.003867720344879864
Bond Position:  [12.64910958]


portfolio before change:  [13.05690703]
curr_Stock_Price:  103.80050397130634
curr_Factors:  [103.80050397  -1.22551673  -0.93380467]
mat_Sqrt:  [[11.97893177  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00400696 -0.01197701  0.13962421]
Stock Position:  -0.004006964057910661
Bond Position:  [13.47283192]


portfolio before change:  [13.06967124]
curr_Stock_Price:  102.29659504243386
curr_Factors:  [102.29659504  -0.99884717  -0.93390443]
mat_Sqrt:  [[14.80736634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.99549892e-05  2.49514801e-04 -9.77328897e-02]
Stock Position:  -8.99549892300728e-05
Bond Position:  [13.07887333]


portfolio before change:  [13.07617669]
curr_Stock_Price:  102.6925802490302
curr_Factors:  [102.69258025  -0.72920672  -0.94855486]
mat_Sqrt:  [[19.18211403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00172157  0.02336407 -0.02407962]
Stock Position:  0.001721573831904418
Bond Position:  [12.89938383]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.08134236]
Stock Price:  101.94580126005744
PL:  [11.1355411]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.29460410e-01 -1.58767288e-01 -5.55117732e-02]
 [ 4.43502285e-02  4.24833421e-02 -1.02699953e-02]
 [-6.33284519e-02  3.45953176e-01  3.48164464e-01]
 [ 2.77759916e-01  2.39413718e-01  3.41534111e-01]
 [ 4.78248230e-02 -5.28274042e-02  9.60941597e-02]
 [-4.59909419e-02  1.38832132e-03 -1.49057404e-02]
 [-1.78189677e-02  7.48069869e-02  7.10507288e-02]
 [-3.82403434e-02 -1.07886375e-01  6.37958612e-02]
 [-1.24035867e-01 -1.69866003e-01 -6.09748991e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.5805151]
curr_Stock_Price:  98.8061991815341
curr_Factors:  [98.80619918 -1.1380136  -0.98042475]
mat_Sqrt:  [[11.8784044   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06509291 -0.05124192 -0.15835964]
Stock Position:  -0.06509291268697798
Bond Position:  [-0.1489318]


portfolio before change:  [-6.48164049]
curr_Stock_Price:  97.28607826998444
curr_Factors:  [97.28607827 -0.69836967 -1.05531945]
mat_Sqrt:  [[16.84353286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00302346  0.01371144 -0.02929744]
Stock Position:  0.003023460146750963
Bond Position:  [-6.77578107]


portfolio before change:  [-6.48847726]
curr_Stock_Price:  96.14565033119906
curr_Factors:  [96.14565033 -0.46782456 -1.01750136]
mat_Sqrt:  [[21.77011833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00359932 0.11165591 0.99321631]
Stock Position:  0.003599324405301291
Bond Position:  [-6.83453665]


portfolio before change:  [-6.49977979]
curr_Stock_Price:  93.95512697825508
curr_Factors:  [93.95512698 -0.57572318 -0.99575362]
mat_Sqrt:  [[19.51806588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02030659 0.07727045 0.97430176]
Stock Position:  0.020306591730336637
Bond Position:  [-8.40768819]


portfolio before change:  [-6.47349951]
curr_Stock_Price:  95.45637202832987
curr_Factors:  [95.45637203 -1.01364108 -1.02844067]
mat_Sqrt:  [[12.38625704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00457415 -0.01704997  0.27412989]
Stock Position:  0.004574151194961689
Bond Position:  [-6.91013139]


portfolio before change:  [-6.47629007]
curr_Stock_Price:  95.60183584788125
curr_Factors:  [95.60183585 -0.99786962 -1.04847989]
mat_Sqrt:  [[12.35230289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00394665  0.00044808 -0.04252193]
Stock Position:  -0.0039466465471893085
Bond Position:  [-6.09898342]


portfolio before change:  [-6.48815625]
curr_Stock_Price:  97.83561098752399
curr_Factors:  [97.83561099 -0.35718068 -1.09582795]
mat_Sqrt:  [[22.88038514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00052246 0.02414385 0.20268795]
Stock Position:  0.000522461216806082
Bond Position:  [-6.53927156]


portfolio before change:  [-6.49128397]
curr_Stock_Price:  98.10878906043006
curr_Factors:  [98.10878906 -0.29889415 -1.03557821]
mat_Sqrt:  [[25.83175611  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182877 -0.03482018  0.18199183]
Stock Position:  -0.001828767725962973
Bond Position:  [-6.31186579]


portfolio before change:  [-6.48633509]
curr_Stock_Price:  93.67651266215404
curr_Factors:  [93.67651266  0.21241116 -1.00675455]
mat_Sqrt:  [[42.33034092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00404334 -0.05482402 -0.17394441]
Stock Position:  -0.004043342545606416
Bond Position:  [-6.10756886]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.50837071]
Stock Price:  98.37091337847399
PL:  [-6.50837071]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.60322756e+00 -3.37856368e-01 -1.44675448e-01]
 [-1.00476232e-01  2.19378464e-01  5.30027498e-01]
 [-1.16285109e-01  5.83581477e-01  6.12246571e-01]
 [ 1.18935528e-01  3.41664547e-02  1.66449298e-02]
 [-8.09998013e-03 -6.96698822e-02 -5.20898391e-02]
 [ 8.00438719e-02 -1.44158345e-02 -4.92317862e-02]
 [-4.07456240e-02 -1.96449065e-02  2.19065199e-02]
 [ 6.65108288e-04  2.81486507e-03 -3.35028558e-02]
 [ 4.11330132e-01  1.36099161e-02  1.00790612e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [28.61189076]
curr_Stock_Price:  103.6091088299174
curr_Factors:  [103.60910883  -1.15489058  -1.0243306 ]
mat_Sqrt:  [[11.72125743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.14518271 -0.10904267 -0.41271878]
Stock Position:  -0.14518271349415046
Bond Position:  [43.65414233]


portfolio before change:  [28.56215402]
curr_Stock_Price:  104.10206886290888
curr_Factors:  [104.10206886  -1.01805574  -1.00905065]
mat_Sqrt:  [[13.71191902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00382847 0.07080409 1.51202092]
Stock Position:  0.0038284662427465464
Bond Position:  [28.16360276]


portfolio before change:  [28.57639069]
curr_Stock_Price:  104.14160109683033
curr_Factors:  [104.1416011   -1.30624598  -0.98999564]
mat_Sqrt:  [[10.48043199  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01219532 0.18835011 1.74656905]
Stock Position:  0.012195324496693027
Bond Position:  [27.30635007]


portfolio before change:  [28.60538438]
curr_Stock_Price:  105.39922239205546
curr_Factors:  [105.39922239  -1.21876735  -0.95029665]
mat_Sqrt:  [[12.04550124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01073491 0.01102718 0.04748335]
Stock Position:  0.010734908926925421
Bond Position:  [27.47393332]


portfolio before change:  [28.63148641]
curr_Stock_Price:  106.55075812443067
curr_Factors:  [106.55075812  -1.33551567  -1.00918245]
mat_Sqrt:  [[10.21567555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00322583 -0.02248586 -0.14859781]
Stock Position:  -0.003225834553563952
Bond Position:  [28.97520153]


portfolio before change:  [28.6437578]
curr_Stock_Price:  107.2389001178574
curr_Factors:  [107.23890012  -1.41534093  -1.01224433]
mat_Sqrt:  [[ 9.4637981   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00708509 -0.00465269 -0.14044458]
Stock Position:  0.007085089411623698
Bond Position:  [27.88396061]


portfolio before change:  [28.65475968]
curr_Stock_Price:  106.8234372593267
curr_Factors:  [106.82343726  -1.36482363  -1.05498215]
mat_Sqrt:  [[ 9.50075792  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00424008 -0.00634037  0.0624932 ]
Stock Position:  -0.004240080047606547
Bond Position:  [29.1076996]


portfolio before change:  [28.66517399]
curr_Stock_Price:  107.80058351754619
curr_Factors:  [107.80058352  -1.88759442  -1.06599862]
mat_Sqrt:  [[ 5.62201439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00099592  0.00090849 -0.09557432]
Stock Position:  -0.000995915556618051
Bond Position:  [28.77253426]


portfolio before change:  [28.6800519]
curr_Stock_Price:  107.31053733648585
curr_Factors:  [107.31053734  -2.13728308  -1.02917424]
mat_Sqrt:  [[ 4.52342535  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09609577 0.00439258 0.28752756]
Stock Position:  0.09609577005990026
Bond Position:  [18.36796317]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [28.62281841]
Stock Price:  106.61935428595724
PL:  [22.00346412]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.26674105e-01 -1.97487458e-01 -6.41279748e-02]
 [ 2.28506308e-02  6.46485291e-02 -2.94224108e-02]
 [-6.69624327e-02  2.84287873e-01  3.32663373e-01]
 [ 1.01225186e-01  2.42006182e-02  1.13474036e-02]
 [ 5.46733050e-02 -1.58714181e-02  3.55940759e-02]
 [-4.73225846e-02 -5.83249323e-03 -1.34069612e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-3.03444662e-02 -7.78448143e-02  3.45393085e-02]
 [ 6.04603428e-03  1.07205920e-01 -4.05801627e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.39056765]
curr_Stock_Price:  99.65097684286157
curr_Factors:  [99.65097684 -1.1539945  -1.00972551]
mat_Sqrt:  [[11.44958902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0768653  -0.0637388  -0.18293926]
Stock Position:  -0.07686530323989442
Bond Position:  [7.2691349]


portfolio before change:  [-0.25682984]
curr_Stock_Price:  97.95837521676765
curr_Factors:  [97.95837522 -0.91519848 -1.00954465]
mat_Sqrt:  [[14.29342314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210175  0.02086522 -0.08393395]
Stock Position:  0.002101745102567563
Bond Position:  [-0.46271337]


portfolio before change:  [-0.25504811]
curr_Stock_Price:  98.91622021028222
curr_Factors:  [98.91622021 -1.07223396 -1.02434301]
mat_Sqrt:  [[12.15446096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0048519  0.09175352 0.94899601]
Stock Position:  0.004851898686770555
Bond Position:  [-0.73497959]


portfolio before change:  [-0.25269499]
curr_Stock_Price:  99.47696864511578
curr_Factors:  [99.47696865 -1.29368525 -1.03610609]
mat_Sqrt:  [[ 9.68070576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01120594 0.00781072 0.03237098]
Stock Position:  0.011205938681171191
Bond Position:  [-1.3674278]


portfolio before change:  [-0.25371617]
curr_Stock_Price:  99.44686969563185
curr_Factors:  [99.4468697  -1.46859049 -1.03934634]
mat_Sqrt:  [[ 8.09856352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0072481  -0.00512248  0.10153999]
Stock Position:  0.007248097210849313
Bond Position:  [-0.97451674]


portfolio before change:  [-0.25423045]
curr_Stock_Price:  99.4431574038309
curr_Factors:  [99.4431574  -1.24989761 -1.02281666]
mat_Sqrt:  [[10.24584157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00500201 -0.00188243 -0.03824633]
Stock Position:  -0.0050020119321962046
Bond Position:  [0.24318541]


portfolio before change:  [-0.25808724]
curr_Stock_Price:  100.23851902171532
curr_Factors:  [100.23851902  -1.1164121   -1.00894415]
mat_Sqrt:  [[11.96751967  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00401079 -0.01197701  0.13962421]
Stock Position:  -0.004010785055192896
Bond Position:  [0.14394792]


portfolio before change:  [-0.25495236]
curr_Stock_Price:  99.4748567353272
curr_Factors:  [99.47485674 -1.17243735 -1.06547883]
mat_Sqrt:  [[10.61203499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00369243 -0.02512431  0.09853103]
Stock Position:  -0.003692427094508934
Bond Position:  [0.1123513]


portfolio before change:  [-0.25350119]
curr_Stock_Price:  99.09706076910776
curr_Factors:  [99.09706077 -1.19367267 -1.04298551]
mat_Sqrt:  [[10.5850391   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185601  0.03460056 -0.11576391]
Stock Position:  0.0018560120509057377
Bond Position:  [-0.43742653]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.2560208]
Stock Price:  97.85738949082138
PL:  [-0.2560208]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-9.58025367e-01 -2.31350579e-01 -6.56419855e-02]
 [-1.62198426e-02  1.51104094e-01  1.98632589e-01]
 [-6.75263852e-02  2.06887989e-01  2.83430557e-01]
 [ 1.07606450e-01  2.77914375e-02  1.32561705e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 3.13414543e-02  1.68309396e-02 -4.38212736e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-3.83060465e-02 -1.06360551e-01  6.25860884e-02]
 [-1.52621042e-01 -3.45484878e-02 -4.94877992e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.41473627]
curr_Stock_Price:  100.306784253609
curr_Factors:  [100.30678425  -1.0996816   -1.0778135 ]
mat_Sqrt:  [[11.36727063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08961243 -0.07466808 -0.18725831]
Stock Position:  -0.08961242789692722
Bond Position:  [13.40347074]


portfolio before change:  [4.3327154]
curr_Stock_Price:  101.29687325990824
curr_Factors:  [101.29687326  -1.22685226  -1.18293627]
mat_Sqrt:  [[ 9.09993266  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00606267 0.04876864 0.56664349]
Stock Position:  0.006062666729518242
Bond Position:  [3.71858622]


portfolio before change:  [4.33577459]
curr_Stock_Price:  101.49471214327764
curr_Factors:  [101.49471214  -1.8773055   -1.18010834]
mat_Sqrt:  [[ 4.77117618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0068242  0.06677281 0.80854849]
Stock Position:  0.006824201750797172
Bond Position:  [3.6431542]


portfolio before change:  [4.34127822]
curr_Stock_Price:  102.03420272025845
curr_Factors:  [102.03420272  -1.33437977  -1.14660661]
mat_Sqrt:  [[ 8.53624911  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01358738 0.00896965 0.03781616]
Stock Position:  0.013587379735253802
Bond Position:  [2.95490076]


portfolio before change:  [4.3529002]
curr_Stock_Price:  102.78078960346618
curr_Factors:  [102.7807896   -0.8170386   -1.13130593]
mat_Sqrt:  [[14.64726943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00398172 -0.00140152  0.08089603]
Stock Position:  0.003981717939463346
Bond Position:  [3.94365608]


portfolio before change:  [4.35680266]
curr_Stock_Price:  103.26554127556007
curr_Factors:  [103.26554128  -0.63188953  -1.1512925 ]
mat_Sqrt:  [[17.35918399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148809  0.00543216 -0.1250099 ]
Stock Position:  0.0014880927270160913
Bond Position:  [4.20313396]


portfolio before change:  [4.35495225]
curr_Stock_Price:  100.60945589310961
curr_Factors:  [ 1.00609456e+02 -9.99452055e-02 -1.14708604e+00]
mat_Sqrt:  [[28.91079348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166025 -0.01197701  0.13962421]
Stock Position:  -0.0016602501446589743
Bond Position:  [4.52198912]


portfolio before change:  [4.36109768]
curr_Stock_Price:  98.27012987419364
curr_Factors:  [98.27012987 -0.48193362 -1.16440582]
mat_Sqrt:  [[18.94198091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249401 -0.03432772  0.17854069]
Stock Position:  -0.0024940090167126132
Bond Position:  [4.60618427]


portfolio before change:  [4.36433577]
curr_Stock_Price:  97.89546336935284
curr_Factors:  [ 9.78954634e+01 -5.23635369e-02 -1.13213898e+00]
mat_Sqrt:  [[29.94605798  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00566936 -0.01115048 -0.14117492]
Stock Position:  -0.005669356463080192
Bond Position:  [4.91934005]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.39196445]
Stock Price:  93.45608873493703
PL:  [4.39196445]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.02581524e+00 -2.64178541e-01 -2.83881525e-02]
 [ 1.87210597e-02  7.19427411e-02 -7.28310752e-03]
 [-1.17244454e-01  5.86739788e-01  6.51477088e-01]
 [ 1.17423888e-01  3.33158353e-02  1.61927671e-02]
 [ 5.47048800e-03 -5.88240348e-02 -4.93563264e-02]
 [ 5.95208185e-02  3.06340971e-03 -4.72583584e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 7.81263815e-03  1.28045369e-02 -4.33871198e-02]
 [ 5.04340513e-02  7.27080744e-02 -5.00595072e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.1840802]
curr_Stock_Price:  99.86587807474723
curr_Factors:  [99.86587807 -0.73855069 -0.99150115]
mat_Sqrt:  [[17.70374558  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0613167  -0.08526326 -0.0809835 ]
Stock Position:  -0.06131669514580555
Bond Position:  [7.3075258]


portfolio before change:  [1.23261322]
curr_Stock_Price:  99.13396752361228
curr_Factors:  [99.13396752 -0.87397587 -0.90053285]
mat_Sqrt:  [[16.8098232   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00189887  0.02321942 -0.02077668]
Stock Position:  0.001898868998298151
Bond Position:  [1.0443708]


portfolio before change:  [1.24065915]
curr_Stock_Price:  103.09612549089049
curr_Factors:  [103.09612549  -1.16007345  -0.8323256 ]
mat_Sqrt:  [[14.059       0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00963835 0.18936945 1.8584828 ]
Stock Position:  0.00963834605784011
Bond Position:  [0.24698302]


portfolio before change:  [1.26025441]
curr_Stock_Price:  105.11636195815815
curr_Factors:  [105.11636196  -0.99981388  -0.84602848]
mat_Sqrt:  [[16.59706035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00768388 0.01075264 0.04619346]
Stock Position:  0.007683878132518108
Bond Position:  [0.4525531]


portfolio before change:  [1.26864649]
curr_Stock_Price:  106.17907409083958
curr_Factors:  [106.17907409  -0.73268087  -0.79051499]
mat_Sqrt:  [[23.14852776  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071762 -0.01898538 -0.14079986]
Stock Position:  -0.0007176152164652344
Bond Position:  [1.34484221]


portfolio before change:  [1.26963168]
curr_Stock_Price:  105.74347064047123
curr_Factors:  [105.74347064  -0.65780033  -0.79554794]
mat_Sqrt:  [[24.72136381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00204275  0.00098871 -0.13481494]
Stock Position:  0.0020427498566279703
Bond Position:  [1.05362422]


portfolio before change:  [1.2644452]
curr_Stock_Price:  102.94654068552171
curr_Factors:  [102.94654069  -0.92136094  -0.74703065]
mat_Sqrt:  [[19.41057931  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247283 -0.01197701  0.13962421]
Stock Position:  -0.0024728344420350207
Bond Position:  [1.51901495]


portfolio before change:  [1.26292942]
curr_Stock_Price:  103.8667287763205
curr_Factors:  [103.86672878  -1.33388769  -0.76078532]
mat_Sqrt:  [[12.78708413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.22779717e-04  4.13264653e-03 -1.23771376e-01]
Stock Position:  0.00012277971692616833
Bond Position:  [1.25017669]


portfolio before change:  [1.26340226]
curr_Stock_Price:  102.62545481035254
curr_Factors:  [102.62545481  -0.97956659  -0.78243747]
mat_Sqrt:  [[17.62083373  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00364646  0.02346643 -0.01428058]
Stock Position:  0.0036464613644920205
Bond Position:  [0.88918251]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.2613949]
Stock Price:  101.95300443126555
PL:  [-0.69160953]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-9.85094710e-01 -2.53309759e-01 -3.21313544e-02]
 [ 1.29971448e-02  8.47545943e-02  2.88200510e-02]
 [-7.28005167e-02  3.79085119e-01  4.05366628e-01]
 [ 2.00451988e-01  1.29099131e-01  1.58079335e-01]
 [ 1.71583864e-02 -8.47766838e-02 -1.90560982e-02]
 [-1.07337997e-01 -6.22253053e-02  1.67179742e-02]
 [-2.97074109e-03  8.42766652e-02  5.81655565e-02]
 [-4.00755019e-02 -1.17752292e-01  2.91700172e-02]
 [-4.14202727e-02 -1.11421939e-01 -1.06239080e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.56129627]
curr_Stock_Price:  99.7808831762995
curr_Factors:  [99.78088318 -0.83778252 -0.93638103]
mat_Sqrt:  [[16.92535965  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06164478 -0.08175537 -0.09166181]
Stock Position:  -0.06164478363506184
Bond Position:  [6.71226722]


portfolio before change:  [0.58724426]
curr_Stock_Price:  99.41441225654637
curr_Factors:  [99.41441226 -1.12498238 -0.97280466]
mat_Sqrt:  [[12.20090406  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00296539 0.02735443 0.08221558]
Stock Position:  0.0029653927319644546
Bond Position:  [0.29244149]


portfolio before change:  [0.58307038]
curr_Stock_Price:  97.95755971774005
curr_Factors:  [97.95755972 -0.63928104 -0.96099185]
mat_Sqrt:  [[19.77189391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00441662 0.1223492  1.15639816]
Stock Position:  0.004416624225575355
Bond Position:  [0.15042865]


portfolio before change:  [0.58028865]
curr_Stock_Price:  97.3106937890663
curr_Factors:  [97.31069379 -0.33101287 -1.00623441]
mat_Sqrt:  [[25.55062069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01013956 0.04166657 0.45095634]
Stock Position:  0.010139559822820585
Bond Position:  [-0.40639895]


portfolio before change:  [0.57319544]
curr_Stock_Price:  96.63118138676694
curr_Factors:  [96.63118139  0.2498749  -0.90554538]
mat_Sqrt:  [[50.16065689  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.04692715e-05 -2.73615570e-02 -5.43617440e-02]
Stock Position:  -8.046927146413282e-05
Bond Position:  [0.58097128]


portfolio before change:  [0.57349488]
curr_Stock_Price:  96.52082216141464
curr_Factors:  [96.52082216 -0.64421751 -0.86072894]
mat_Sqrt:  [[21.43043918  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00544213 -0.02008313  0.04769173]
Stock Position:  -0.005442125630289513
Bond Position:  [1.09877332]


portfolio before change:  [0.57310041]
curr_Stock_Price:  96.69428350818947
curr_Factors:  [96.69428351 -0.79571679 -0.90821179]
mat_Sqrt:  [[17.59519253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00148365 0.02720018 0.16593014]
Stock Position:  0.0014836527425346679
Bond Position:  [0.42963967]


portfolio before change:  [0.56870613]
curr_Stock_Price:  93.58765713359446
curr_Factors:  [93.58765713 -0.26990681 -0.89227494]
mat_Sqrt:  [[29.2744979   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198662 -0.03800439  0.08321394]
Stock Position:  -0.001986619318906348
Bond Position:  [0.75462917]


portfolio before change:  [0.56642463]
curr_Stock_Price:  94.92606449643024
curr_Factors:  [94.9260645 -0.6848416 -0.8784548]
mat_Sqrt:  [[19.88174392  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00431804 -0.03596128 -0.30307052]
Stock Position:  -0.004318038821548854
Bond Position:  [0.97631906]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.57453911]
Stock Price:  93.15993992790297
PL:  [0.57453911]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-6.91165893e-01 -1.45193802e-01 -3.34572221e-02]
 [ 2.97709959e-03  1.07242248e-01  9.11132875e-02]
 [-8.26222018e-02  3.35223718e-01  4.25300063e-01]
 [ 1.06862832e-01  2.73729941e-02  1.30337391e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 1.20556306e-02  3.20883487e-02 -4.18311393e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 7.45040975e-03  1.10014686e-02 -4.20121080e-02]
 [ 1.15508080e-01  7.15169875e-02  8.58121685e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.31330676]
curr_Stock_Price:  98.02381219557374
curr_Factors:  [98.0238122  -0.98630869 -0.9111561 ]
mat_Sqrt:  [[14.69850282  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04950388 -0.0468611  -0.09544414]
Stock Position:  -0.04950387729988681
Bond Position:  [-7.46074798]


portfolio before change:  [-12.41319184]
curr_Stock_Price:  99.96616065607604
curr_Factors:  [99.96616066 -1.47059428 -0.9005551 ]
mat_Sqrt:  [[ 9.33417458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00465668 0.03461229 0.25992085]
Stock Position:  0.004656678893445371
Bond Position:  [-12.87870215]


portfolio before change:  [-12.4176664]
curr_Stock_Price:  100.38843622124466
curr_Factors:  [100.38843622  -1.39228039  -0.87940034]
mat_Sqrt:  [[10.35393134  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00701367 0.10819299 1.2132627 ]
Stock Position:  0.007013670699460088
Bond Position:  [-13.12175783]


portfolio before change:  [-12.41393221]
curr_Stock_Price:  101.85652792302918
curr_Factors:  [101.85652792  -1.36274984  -0.95247287]
mat_Sqrt:  [[10.05774036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.011445   0.0088346  0.03718163]
Stock Position:  0.011444998367441395
Bond Position:  [-13.57968]


portfolio before change:  [-12.42457612]
curr_Stock_Price:  101.51992898344648
curr_Factors:  [101.51992898  -1.08743286  -0.9793284 ]
mat_Sqrt:  [[12.85192841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00453794 -0.00140152  0.08089603]
Stock Position:  0.004537941200183044
Bond Position:  [-12.88526759]


portfolio before change:  [-12.43150302]
curr_Stock_Price:  101.41356896115583
curr_Factors:  [101.41356896  -1.1943804   -0.96123895]
mat_Sqrt:  [[11.7468785   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085698  0.01035647 -0.1193326 ]
Stock Position:  0.0008569844134959088
Bond Position:  [-12.51841287]


portfolio before change:  [-12.43767673]
curr_Stock_Price:  101.515165155688
curr_Factors:  [101.51516516  -1.48677834  -0.99245254]
mat_Sqrt:  [[ 8.50774837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00564182 -0.01197701  0.13962421]
Stock Position:  -0.0056418157842302264
Bond Position:  [-11.86494687]


portfolio before change:  [-12.44773307]
curr_Stock_Price:  102.24584934979436
curr_Factors:  [102.24584935  -1.52750007  -0.9948426 ]
mat_Sqrt:  [[ 8.20741103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00013651  0.00355071 -0.11984885]
Stock Position:  0.0001365094899932317
Bond Position:  [-12.4616906]


portfolio before change:  [-12.45387838]
curr_Stock_Price:  102.88385682357034
curr_Factors:  [102.88385682  -1.28833773  -0.97477234]
mat_Sqrt:  [[10.70264253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01232014 0.02308201 0.02447982]
Stock Position:  0.01232014033390285
Bond Position:  [-13.72142193]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.44735618]
Stock Price:  103.97025853953888
PL:  [-16.41761472]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.33492312e+00 -3.35103026e-01 -2.43551187e-02]
 [ 1.72632400e-01 -9.34863300e-02  1.27030493e-01]
 [-1.04414115e-01  6.51588685e-01  6.77807220e-01]
 [-1.98263253e-01  3.23496521e-01  8.16287193e-03]
 [-1.06162017e-01 -3.54702417e-01  2.45675212e-01]
 [-8.56817310e-02  2.91523220e-01 -7.24631968e-02]
 [ 5.66118806e-01  1.16189713e+00  5.93360119e-01]
 [-4.34854202e-02 -1.33198514e-01 -3.88618853e-02]
 [ 1.54679538e-01 -6.33055774e-01 -2.18255343e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.14535868]
curr_Stock_Price:  100.40649648769006
curr_Factors:  [ 1.00406496e+02 -7.04196737e-02 -1.03528069e+00]
mat_Sqrt:  [[33.23244127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04237718 -0.10815404 -0.06947837]
Stock Position:  -0.04237718171929216
Bond Position:  [9.40030303]


portfolio before change:  [5.43990867]
curr_Stock_Price:  93.56676220581917
curr_Factors:  [93.56676221  0.59314717 -0.94849018]
mat_Sqrt:  [[65.58402897  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00273664 -0.03017258  0.36238264]
Stock Position:  0.002736635380037455
Bond Position:  [5.18385056]


portfolio before change:  [5.45119591]
curr_Stock_Price:  96.74390093281227
curr_Factors:  [96.74390093  0.81502941 -0.92172992]
mat_Sqrt:  [[ 8.69529160e+01  0.00000000e+00  0.00000000e+00]
 [-6.32455532e-01  3.09838668e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [1.91997802e-03 2.10299344e-01 1.93359533e+00]
Stock Position:  0.0019199780219049467
Bond Position:  [5.26544975]


portfolio before change:  [5.43866254]
curr_Stock_Price:  88.84445713074763
curr_Factors:  [88.84445713  0.24370435 -0.91594356]
mat_Sqrt:  [[45.36078438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287834  0.10440805  0.0232864 ]
Stock Position:  -0.0028783356421641457
Bond Position:  [5.6943867]


portfolio before change:  [5.44863453]
curr_Stock_Price:  86.36938397803725
curr_Factors:  [ 8.63693840e+01  3.30917785e-02 -8.69390800e-01]
mat_Sqrt:  [[37.42482444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343133 -0.11447971  0.700843  ]
Stock Position:  -0.0034313347783889643
Bond Position:  [5.7449968]


portfolio before change:  [5.46391456]
curr_Stock_Price:  82.7536447884468
curr_Factors:  [82.75364479 -0.20303491 -0.91556866]
mat_Sqrt:  [[27.03857346  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151511  0.09408871 -0.20671733]
Stock Position:  -0.001515105483714623
Bond Position:  [5.58929506]


portfolio before change:  [5.46849784]
curr_Stock_Price:  81.57357426010388
curr_Factors:  [81.57357426 -0.27839951 -0.84682584]
mat_Sqrt:  [[26.47709487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03491354 0.37500069 1.69269126]
Stock Position:  0.03491354305995352
Bond Position:  [2.62047534]


portfolio before change:  [5.61584836]
curr_Stock_Price:  85.75647700297019
curr_Factors:  [85.756477   -0.63416758 -0.82024961]
mat_Sqrt:  [[20.02726176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003925   -0.04298964 -0.11086214]
Stock Position:  -0.003925004984640797
Bond Position:  [5.95244296]


portfolio before change:  [5.62586484]
curr_Stock_Price:  83.96297083536705
curr_Factors:  [83.96297084 -0.52894265 -0.78721729]
mat_Sqrt:  [[22.51576973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084801 -0.20431787 -0.62262174]
Stock Position:  -0.0008480108254379246
Bond Position:  [5.69706635]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.62839211]
Stock Price:  84.34266480922027
PL:  [5.62839211]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.23873676e+00 -3.17552286e-01 -1.60951654e-02]
 [-3.15762251e-02  1.81863414e-01  2.77558822e-01]
 [-1.05215111e-01  4.89049420e-01  6.03347232e-01]
 [ 1.12379658e-01  3.04773828e-02  1.46839348e-02]
 [-9.51109142e-03 -7.58468000e-02 -7.36379947e-02]
 [ 4.11951528e-02  1.41371052e-02 -4.51769339e-02]
 [-3.46343824e-02 -1.05372373e-02 -2.13974603e-03]
 [ 1.31289181e-04  2.06877826e-03 -3.27646415e-02]
 [ 2.05809338e-01  3.34790039e-02  5.07136351e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.99374096]
curr_Stock_Price:  100.52228008724498
curr_Factors:  [100.52228009  -0.59076684  -0.97624155]
mat_Sqrt:  [[20.97583385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06230228 -0.10248956 -0.04591503]
Stock Position:  -0.062302279386416984
Bond Position:  [12.25650813]


portfolio before change:  [5.88420054]
curr_Stock_Price:  102.37887669161181
curr_Factors:  [102.37887669  -0.85680286  -0.96858822]
mat_Sqrt:  [[16.49882768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00377014 0.05869616 0.79179806]
Stock Position:  0.0037701433961772847
Bond Position:  [5.4982175]


portfolio before change:  [5.88098282]
curr_Stock_Price:  100.79604081520002
curr_Factors:  [100.79604082  -0.62212008  -0.9150621 ]
mat_Sqrt:  [[21.66974178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00543474 0.15784002 1.72118171]
Stock Position:  0.005434740440089378
Bond Position:  [5.3331825]


portfolio before change:  [5.9011761]
curr_Stock_Price:  104.02085342705621
curr_Factors:  [104.02085343  -0.55741638  -0.93532483]
mat_Sqrt:  [[23.3792806   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00520111 0.00983653 0.04188918]
Stock Position:  0.005201108446803699
Bond Position:  [5.36015236]


portfolio before change:  [5.911473]
curr_Stock_Price:  105.48518683229707
curr_Factors:  [105.48518683  -0.35093374  -0.90268406]
mat_Sqrt:  [[30.11287218  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132915 -0.02447945 -0.2100687 ]
Stock Position:  -0.0013291507740857801
Bond Position:  [6.05167872]


portfolio before change:  [5.91618468]
curr_Stock_Price:  104.2173997670237
curr_Factors:  [104.21739977  -0.43585506  -0.8923589 ]
mat_Sqrt:  [[27.61240533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00126245  0.00456273 -0.12887722]
Stock Position:  0.0012624461323950723
Bond Position:  [5.78461582]


portfolio before change:  [5.92418464]
curr_Stock_Price:  108.2626674352451
curr_Factors:  [108.26266744  -1.21250007  -0.87734336]
mat_Sqrt:  [[13.39279597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277926 -0.00340088 -0.0061041 ]
Stock Position:  -0.0027792598989151486
Bond Position:  [6.22507473]


portfolio before change:  [5.93114572]
curr_Stock_Price:  106.87821118039791
curr_Factors:  [106.87821118  -0.9882727   -0.92952855]
mat_Sqrt:  [[15.7035801   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039064  0.0006677  -0.0934684 ]
Stock Position:  -0.0003906419824476875
Bond Position:  [5.97289684]


portfolio before change:  [5.93462558]
curr_Stock_Price:  105.61705108928966
curr_Factors:  [105.61705109  -1.24542106  -0.91612915]
mat_Sqrt:  [[12.16143179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01833625 0.0108053  0.14467188]
Stock Position:  0.018336252871768547
Bond Position:  [3.99800462]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.95467987]
Stock Price:  106.60170111944508
PL:  [-0.64702125]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.11413908e-01 -1.59705176e-01 -4.12613560e-02]
 [ 2.87293530e-02  6.05673687e-02 -7.26773296e-03]
 [-7.58176645e-02  3.70235929e-01  4.13818460e-01]
 [ 1.02926258e-01  2.71495624e-02  1.66080256e-02]
 [ 4.80911440e-02  2.99886738e-02  2.68219986e-02]
 [-6.01558070e-02 -1.77560629e-02 -7.22173069e-03]
 [-2.60816892e-02  5.91884020e-02  5.95626041e-02]
 [-4.02299646e-02 -1.14326259e-01  2.58595148e-02]
 [-4.76287241e-02 -2.29923386e-01 -1.39690048e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.72856462]
curr_Stock_Price:  98.37656679267859
curr_Factors:  [98.37656679 -0.87173958 -1.06947811]
mat_Sqrt:  [[14.11989715  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05328906 -0.05154462 -0.11770716]
Stock Position:  -0.05328905884677615
Bond Position:  [-4.48616996]


portfolio before change:  [-9.74303448]
curr_Stock_Price:  98.60599876537573
curr_Factors:  [98.60599877 -0.72685229 -1.01743339]
mat_Sqrt:  [[17.23334927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0022984   0.01954803 -0.02073282]
Stock Position:  0.002298398003989343
Bond Position:  [-9.96967031]


portfolio before change:  [-9.74807493]
curr_Stock_Price:  98.58234385553799
curr_Factors:  [98.58234386 -0.68834221 -0.984264  ]
mat_Sqrt:  [[18.50953431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00455045 0.11949313 1.18050888]
Stock Position:  0.004550453086794581
Bond Position:  [-10.19666926]


portfolio before change:  [-9.7496575]
curr_Stock_Price:  99.35524284660933
curr_Factors:  [99.35524285 -0.5704911  -0.97313948]
mat_Sqrt:  [[21.22269583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00527069 0.00876248 0.04737807]
Stock Position:  0.005270689434853716
Bond Position:  [-10.27332812]


portfolio before change:  [-9.75633783]
curr_Stock_Price:  99.06260917958403
curr_Factors:  [99.06260918 -0.45049497 -0.992371  ]
mat_Sqrt:  [[23.40351195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00255037 0.0096788  0.0765157 ]
Stock Position:  0.0025503682539896135
Bond Position:  [-10.00898396]


portfolio before change:  [-9.75963025]
curr_Stock_Price:  99.73440098318872
curr_Factors:  [99.73440098 -0.78288342 -0.99875975]
mat_Sqrt:  [[16.79141065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00388618 -0.00573074 -0.02060159]
Stock Position:  -0.0038861760397117086
Bond Position:  [-9.37204481]


portfolio before change:  [-9.75768884]
curr_Stock_Price:  98.02871137528314
curr_Factors:  [ 9.80287114e+01 -9.77719757e-02 -9.07086119e-01]
mat_Sqrt:  [[35.88797619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.13191810e-05  1.91029746e-02  1.69915531e-01]
Stock Position:  -5.1319180962919265e-05
Bond Position:  [-9.75265808]


portfolio before change:  [-9.76234247]
curr_Stock_Price:  93.66561965497569
curr_Factors:  [93.66561965 -0.4461896  -0.83169621]
mat_Sqrt:  [[26.0976532   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223346 -0.03689864  0.07377   ]
Stock Position:  -0.002233463780279632
Bond Position:  [-9.55314371]


portfolio before change:  [-9.76510137]
curr_Stock_Price:  92.76169984739178
curr_Factors:  [92.76169985 -0.48628176 -0.78496422]
mat_Sqrt:  [[26.01798041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00473041 -0.07420745 -0.39849682]
Stock Position:  -0.004730411365977934
Bond Position:  [-9.32630037]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.76761378]
Stock Price:  92.30679220212019
PL:  [-9.76761378]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.18634340e+00 -2.81925501e-01 -6.64790587e-02]
 [-1.04033055e-02  1.38156972e-01  1.60851218e-01]
 [-8.80213959e-02  3.57831131e-01  4.67282098e-01]
 [ 1.06261655e-01  2.70347040e-02  1.28539147e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 2.85719806e-02  2.29101305e-02 -4.41142368e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 1.33879045e-02  1.66334644e-02 -4.84257251e-02]
 [ 5.44528973e-02  5.96198142e-02  6.79282826e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.28987572]
curr_Stock_Price:  101.38154974173833
curr_Factors:  [101.38154974  -1.24017736  -0.98188466]
mat_Sqrt:  [[10.98827838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.1144366  -0.09099106 -0.18964625]
Stock Position:  -0.11443659695711225
Bond Position:  [23.89163527]


portfolio before change:  [12.33801]
curr_Stock_Price:  101.06534432112942
curr_Factors:  [101.06534432  -0.87111529  -1.00824709]
mat_Sqrt:  [[15.43140778  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00328107 0.04458997 0.45886375]
Stock Position:  0.0032810671992128983
Bond Position:  [12.00640782]


portfolio before change:  [12.34296112]
curr_Stock_Price:  100.74423244961056
curr_Factors:  [100.74423245  -1.08459236  -1.02098802]
mat_Sqrt:  [[12.26812659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00655391 0.1154895  1.33302576]
Stock Position:  0.006553905043710106
Bond Position:  [11.68269298]


portfolio before change:  [12.35416728]
curr_Stock_Price:  101.56257787753056
curr_Factors:  [101.56257788  -1.15347861  -0.97982544]
mat_Sqrt:  [[12.02960971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00951019 0.00872541 0.03666864]
Stock Position:  0.009510190927812634
Bond Position:  [11.38828778]


portfolio before change:  [12.35978928]
curr_Stock_Price:  101.554841899308
curr_Factors:  [101.5548419   -1.08599694  -0.94559212]
mat_Sqrt:  [[13.3165804   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0043796  -0.00140152  0.08089603]
Stock Position:  0.004379599993467558
Bond Position:  [11.91501969]


portfolio before change:  [12.37192812]
curr_Stock_Price:  102.96589347827981
curr_Factors:  [102.96589348  -0.65183796  -0.96526417]
mat_Sqrt:  [[20.43595132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118633  0.00739421 -0.12584564]
Stock Position:  0.0011863264976888946
Bond Position:  [12.24977695]


portfolio before change:  [12.37802796]
curr_Stock_Price:  102.94349244028683
curr_Factors:  [102.94349244  -0.91656859  -0.93625559]
mat_Sqrt:  [[16.1408938   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297376 -0.01197701  0.13962421]
Stock Position:  -0.002973760291218074
Bond Position:  [12.68415724]


portfolio before change:  [12.38454646]
curr_Stock_Price:  102.88470178642011
curr_Factors:  [102.88470179  -0.94290577  -0.94070707]
mat_Sqrt:  [[15.64257109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.000441    0.00536843 -0.13814511]
Stock Position:  0.00044099761092139615
Bond Position:  [12.33917455]


portfolio before change:  [12.39104917]
curr_Stock_Price:  103.63659163362242
curr_Factors:  [103.63659163  -0.72488216  -0.97165897]
mat_Sqrt:  [[18.99829692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00357976 0.01924221 0.01937805]
Stock Position:  0.0035797588330281427
Bond Position:  [12.02005517]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.40312088]
Stock Price:  105.32949250686724
PL:  [7.07362837]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.57931610e-01 -1.65509593e-01 -6.76540151e-02]
 [ 2.05457577e-02  6.75960739e-02 -1.48072382e-02]
 [-7.24693655e-02  3.94970034e-01  4.11947671e-01]
 [ 1.96412635e-01  1.24962173e-01  1.52424107e-01]
 [ 4.87280617e-02  2.58847532e-02  2.70055507e-02]
 [-6.52270258e-02 -2.17694421e-02 -4.98828292e-03]
 [-4.73935895e-02  2.09130391e-03  5.11977179e-02]
 [-2.87589941e-02 -6.82718619e-02  2.73831889e-02]
 [ 8.99674080e-03  1.10136983e-01 -4.01754339e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.19474707]
curr_Stock_Price:  99.26827438017506
curr_Factors:  [99.26827438 -1.30563328 -0.94738658]
mat_Sqrt:  [[10.43125062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07722237 -0.05341799 -0.19299807]
Stock Position:  -0.077222373645115
Bond Position:  [4.4709847]


portfolio before change:  [-3.15019724]
curr_Stock_Price:  98.72032721209271
curr_Factors:  [98.72032721 -1.22564864 -0.89570697]
mat_Sqrt:  [[11.8335091   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00264683  0.02181654 -0.04224093]
Stock Position:  0.002646825500747118
Bond Position:  [-3.41149272]


portfolio before change:  [-3.15620584]
curr_Stock_Price:  97.09482180480377
curr_Factors:  [97.0948218  -0.61990809 -0.85169364]
mat_Sqrt:  [[22.28884462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00413848 0.12747603 1.17517204]
Stock Position:  0.004138483747517067
Bond Position:  [-3.55803118]


portfolio before change:  [-3.1575884]
curr_Stock_Price:  97.1907260651799
curr_Factors:  [97.19072607 -0.59494254 -0.90525134]
mat_Sqrt:  [[21.68197827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01167024 0.04033137 0.43482355]
Stock Position:  0.011670239158431779
Bond Position:  [-4.29182742]


portfolio before change:  [-3.12545763]
curr_Stock_Price:  100.12787416031438
curr_Factors:  [100.12787416  -0.7116784   -0.84674268]
mat_Sqrt:  [[21.07372555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00282457 0.00835427 0.07703932]
Stock Position:  0.0028245717465944344
Bond Position:  [-3.408276]


portfolio before change:  [-3.12867825]
curr_Stock_Price:  99.59113512132063
curr_Factors:  [99.59113512 -1.03693223 -0.87889501]
mat_Sqrt:  [[14.66180646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0048213  -0.00702606 -0.01423018]
Stock Position:  -0.004821296999210436
Bond Position:  [-2.64851981]


portfolio before change:  [-3.12703383]
curr_Stock_Price:  98.97532305278168
curr_Factors:  [98.97532305 -1.15912834 -0.8960412 ]
mat_Sqrt:  [[12.67588057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288075  0.00067497  0.14605284]
Stock Position:  -0.0028807476693562956
Bond Position:  [-2.8419109]


portfolio before change:  [-3.13046007]
curr_Stock_Price:  99.67129725445052
curr_Factors:  [99.67129725 -1.32792175 -0.9596412 ]
mat_Sqrt:  [[10.11798759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366727 -0.02203465  0.07811662]
Stock Position:  -0.0036672667570636836
Bond Position:  [-2.76493883]


portfolio before change:  [-3.13202702]
curr_Stock_Price:  99.72150787218648
curr_Factors:  [99.72150787 -1.2649684  -0.9403398 ]
mat_Sqrt:  [[10.99096067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00211788  0.03554656 -0.11460933]
Stock Position:  0.0021178842159019057
Bond Position:  [-3.34322563]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.12985156]
Stock Price:  101.53817710763091
PL:  [-4.66802866]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.37632090e+00 -3.10665012e-01 -9.52681042e-02]
 [-2.82902905e-02  1.78876492e-01  2.63300525e-01]
 [-1.12176940e-01  5.39200665e-01  5.91304813e-01]
 [ 1.13807736e-01  3.12809803e-02  1.51111020e-02]
 [ 2.18809310e-02 -4.01777287e-02 -2.27588013e-02]
 [ 6.04092496e-02 -2.70998986e-03 -4.67650961e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 3.16616680e-05  1.92953489e-03 -3.26268674e-02]
 [ 6.99055509e-02  1.89528166e-02  3.89080319e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.56667204]
curr_Stock_Price:  102.23818016666846
curr_Factors:  [102.23818017  -1.10606487  -1.01725777]
mat_Sqrt:  [[12.23110809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11930085 -0.1002667  -0.27177338]
Stock Position:  -0.11930085471155594
Bond Position:  [30.76377432]


portfolio before change:  [18.57786368]
curr_Stock_Price:  102.27333579808221
curr_Factors:  [102.2733358   -0.80525392  -1.08075949]
mat_Sqrt:  [[15.51233606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0039948  0.05773214 0.75112311]
Stock Position:  0.003994802257967702
Bond Position:  [18.16930192]


portfolio before change:  [18.59220859]
curr_Stock_Price:  103.58954453361528
curr_Factors:  [103.58954453  -0.92771292  -1.18410011]
mat_Sqrt:  [[12.53623656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0094595  0.17402627 1.68682804]
Stock Position:  0.009459499592989896
Bond Position:  [17.61230334]


portfolio before change:  [18.60783166]
curr_Stock_Price:  104.309953728598
curr_Factors:  [104.30995373  -1.2236268   -1.13720781]
mat_Sqrt:  [[ 9.84075249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01252724 0.01009589 0.04310777]
Stock Position:  0.012527241206262436
Bond Position:  [17.30111571]


portfolio before change:  [18.62748093]
curr_Stock_Price:  105.18776464996996
curr_Factors:  [105.18776465  -1.20536513  -1.13033453]
mat_Sqrt:  [[10.17615586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00088777 -0.01296731 -0.06492453]
Stock Position:  0.0008877680023488807
Bond Position:  [18.5340986]


portfolio before change:  [18.63728496]
curr_Stock_Price:  105.7900280558104
curr_Factors:  [105.79002806  -0.8180382   -1.06439569]
mat_Sqrt:  [[16.10327036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00312422 -0.00087465 -0.1334078 ]
Stock Position:  0.0031242219005752103
Bond Position:  [18.30677344]


portfolio before change:  [18.6389206]
curr_Stock_Price:  103.38301516683993
curr_Factors:  [103.38301517  -0.43395628  -1.07284845]
mat_Sqrt:  [[22.91143085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209499 -0.01197701  0.13962421]
Stock Position:  -0.00209498696786279
Bond Position:  [18.85550667]


portfolio before change:  [18.64005801]
curr_Stock_Price:  107.34136654700414
curr_Factors:  [107.34136655  -0.5442466   -0.98180809]
mat_Sqrt:  [[23.33511717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026717  0.00062275 -0.09307537]
Stock Position:  -0.00026716836431335073
Bond Position:  [18.66873623]


portfolio before change:  [18.64961882]
curr_Stock_Price:  106.50255753608776
curr_Factors:  [106.50255754  -0.15313099  -0.99655456]
mat_Sqrt:  [[33.73323129  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00242243 0.006117   0.11099379]
Stock Position:  0.0024224286837167407
Bond Position:  [18.39162397]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.66631875]
Stock Price:  109.59937520536722
PL:  [9.06694354]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.11206216e+00 -2.82066872e-01 -3.12652455e-02]
 [-1.95891754e-02  1.58680418e-01  2.19356940e-01]
 [-7.44937789e-02  2.62157151e-01  3.65852842e-01]
 [ 1.04970970e-01  2.63084191e-02  1.24678444e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 4.63630109e-02  9.15321754e-02 -6.28706241e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-3.84270762e-02 -1.01918713e-01  5.80354841e-02]
 [-3.20300847e-02 -9.73514230e-04 -6.86977730e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.67641791]
curr_Stock_Price:  100.34249744849335
curr_Factors:  [100.34249745  -0.87468717  -0.90651703]
mat_Sqrt:  [[16.90120821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06958206 -0.09103669 -0.08919104]
Stock Position:  -0.06958205551580923
Bond Position:  [11.65845513]


portfolio before change:  [4.59979859]
curr_Stock_Price:  101.52742942225093
curr_Factors:  [101.52742942  -1.30194877  -0.95310268]
mat_Sqrt:  [[10.64699348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00540785 0.05121388 0.62576429]
Stock Position:  0.005407853130750983
Bond Position:  [4.05075316]


portfolio before change:  [4.59712493]
curr_Stock_Price:  100.65840805038842
curr_Factors:  [100.65840805  -1.77616093  -0.90580559]
mat_Sqrt:  [[ 6.88789937  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00779602 0.08461086 1.04367633]
Stock Position:  0.007796023321491935
Bond Position:  [3.81238963]


portfolio before change:  [4.60294313]
curr_Stock_Price:  101.16014168165826
curr_Factors:  [101.16014168  -1.86202676  -0.93580131]
mat_Sqrt:  [[ 6.16492981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01831102 0.00849101 0.03556729]
Stock Position:  0.018311018162950377
Bond Position:  [2.75059794]


portfolio before change:  [4.6137097]
curr_Stock_Price:  101.67299851799287
curr_Factors:  [101.67299852  -1.59935828  -0.89976821]
mat_Sqrt:  [[ 8.35312134  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00698198 -0.00140152  0.08089603]
Stock Position:  0.006981976324024347
Bond Position:  [3.90383123]


portfolio before change:  [4.61110103]
curr_Stock_Price:  101.01973404623375
curr_Factors:  [101.01973405  -1.65082129  -0.92794608]
mat_Sqrt:  [[ 7.66411096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00681273  0.02954188 -0.17935239]
Stock Position:  0.006812730892087903
Bond Position:  [3.92288077]


portfolio before change:  [4.61260454]
curr_Stock_Price:  100.95244457159488
curr_Factors:  [100.95244457  -1.16047916  -0.93870329]
mat_Sqrt:  [[12.37238671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00387954 -0.01197701  0.13962421]
Stock Position:  -0.003879538377165135
Bond Position:  [5.00425342]


portfolio before change:  [4.62494133]
curr_Stock_Price:  98.41759700826982
curr_Factors:  [98.41759701 -0.58623384 -0.93945147]
mat_Sqrt:  [[21.40306861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221392 -0.03289412  0.16555908]
Stock Position:  -0.002213920982300624
Bond Position:  [4.84283011]


portfolio before change:  [4.63075008]
curr_Stock_Price:  96.8878517055876
curr_Factors:  [96.88785171 -0.74430853 -0.88800972]
mat_Sqrt:  [[18.93923877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244211 -0.0003142  -0.19597562]
Stock Position:  -0.00244210853461858
Bond Position:  [4.86736073]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.64064515]
Stock Price:  93.83279492687437
PL:  [4.64064515]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-9.96703333e-01 -2.56892697e-01 -3.00442152e-02]
 [-1.27588996e-02  1.43324486e-01  1.77303594e-01]
 [-8.84166587e-02  3.64470205e-01  4.73077412e-01]
 [ 1.06255937e-01  2.70314866e-02  1.28522044e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 7.88019281e-03  2.95874830e-02 -3.98894223e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-3.12522368e-02 -7.93449763e-02  3.59943798e-02]
 [ 2.90154432e-03  1.05835477e-01 -3.95901206e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.44420547]
curr_Stock_Price:  99.76490312241268
curr_Factors:  [99.76490312 -0.74057985 -1.0054953 ]
mat_Sqrt:  [[17.40471766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0606315  -0.08291176 -0.08570778]
Stock Position:  -0.06063149689046336
Bond Position:  [6.49310088]


portfolio before change:  [0.36386219]
curr_Stock_Price:  101.14357007265801
curr_Factors:  [101.14357007  -1.09669028  -0.97855839]
mat_Sqrt:  [[12.69606777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00415003 0.04625778 0.5057978 ]
Stock Position:  0.004150027717693922
Bond Position:  [-0.05588643]


portfolio before change:  [0.36209053]
curr_Stock_Price:  100.72340299324564
curr_Factors:  [100.72340299  -1.229626    -0.92410357]
mat_Sqrt:  [[11.68900441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00706194 0.11763225 1.34955818]
Stock Position:  0.007061938728473796
Bond Position:  [-0.34921197]


portfolio before change:  [0.36841618]
curr_Stock_Price:  101.6438720721847
curr_Factors:  [101.64387207  -1.35126353  -0.89240285]
mat_Sqrt:  [[10.78125393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01061075 0.00872437 0.03666376]
Stock Position:  0.010610747357519422
Bond Position:  [-0.71010127]


portfolio before change:  [0.35591638]
curr_Stock_Price:  100.49930977970781
curr_Factors:  [100.49930978  -1.40329016  -0.98073024]
mat_Sqrt:  [[ 9.26394935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00629551 -0.00140152  0.08089603]
Stock Position:  0.006295511044530836
Bond Position:  [-0.27677813]


portfolio before change:  [0.36092177]
curr_Stock_Price:  101.31637022319731
curr_Factors:  [101.31637022  -1.17330173  -0.94830902]
mat_Sqrt:  [[12.14159607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047583  0.00954932 -0.11379342]
Stock Position:  0.0004758285676590126
Bond Position:  [0.31271255]


portfolio before change:  [0.36061639]
curr_Stock_Price:  100.34591483268798
curr_Factors:  [100.34591483  -1.14399565  -0.95257925]
mat_Sqrt:  [[12.33016222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389282 -0.01197701  0.13962421]
Stock Position:  -0.0038928238092058795
Bond Position:  [0.75124536]


portfolio before change:  [0.36410146]
curr_Stock_Price:  99.547174947701
curr_Factors:  [99.54717495 -0.9929172  -0.98534224]
mat_Sqrt:  [[13.76834638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291256 -0.02560848  0.10268195]
Stock Position:  -0.002912560383874553
Bond Position:  [0.65403862]


portfolio before change:  [0.36386407]
curr_Stock_Price:  99.74099021419138
curr_Factors:  [99.74099021 -1.1423891  -1.01591215]
mat_Sqrt:  [[11.52219847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00142541  0.03415825 -0.11293959]
Stock Position:  0.0014254068837321445
Bond Position:  [0.22169257]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.36402056]
Stock Price:  99.77299298152802
PL:  [0.36402056]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.30613433e+00 -3.06858839e-01 -7.02904912e-02]
 [ 9.78968802e-03  9.23541321e-02  4.26691521e-02]
 [-9.46528077e-02  4.47319239e-01  5.33203881e-01]
 [ 1.72854914e-01  1.00835219e-01  1.19442522e-01]
 [ 4.97939006e-02  1.10719990e-02  4.31524611e-02]
 [-1.07337997e-01 -6.22253053e-02  1.67179742e-02]
 [ 2.32723714e-02  1.34756629e-01  8.30315726e-02]
 [-3.94486247e-02 -1.09955012e-01  3.95876992e-02]
 [ 3.65857881e-02 -1.79853194e-01 -1.50095926e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.14613495]
curr_Stock_Price:  101.63488409448007
curr_Factors:  [101.63488409  -0.96002512  -1.04064597]
mat_Sqrt:  [[13.74555819  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10062302 -0.09903826 -0.20051921]
Stock Position:  -0.10062302258987284
Bond Position:  [24.37294419]


portfolio before change:  [14.34695191]
curr_Stock_Price:  99.76028885927495
curr_Factors:  [99.76028886 -0.75190113 -1.01492195]
mat_Sqrt:  [[17.04653773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00219113 0.02980717 0.12172321]
Stock Position:  0.0021911311901159176
Bond Position:  [14.12836403]


portfolio before change:  [14.35441604]
curr_Stock_Price:  99.94201053602332
curr_Factors:  [99.94201054 -0.51051291 -0.97986558]
mat_Sqrt:  [[22.51567272  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00468543 0.14437166 1.52108226]
Stock Position:  0.004685431221224253
Bond Position:  [13.88614462]


portfolio before change:  [14.3517126]
curr_Stock_Price:  97.88280942427497
curr_Factors:  [97.88280942 -0.65898817 -0.88991146]
mat_Sqrt:  [[20.79830113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01047292 0.03254443 0.34073627]
Stock Position:  0.010472918831339792
Bond Position:  [13.32659388]


portfolio before change:  [14.34732816]
curr_Stock_Price:  96.8277647520107
curr_Factors:  [96.82776475 -0.46378352 -0.90615115]
mat_Sqrt:  [[24.60621622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00247346 0.00357347 0.12310196]
Stock Position:  0.002473457179504498
Bond Position:  [14.10782883]


portfolio before change:  [14.35082238]
curr_Stock_Price:  95.3878939614104
curr_Factors:  [95.38789396 -0.51856174 -0.91807095]
mat_Sqrt:  [[22.67626952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00514314 -0.02008313  0.04769173]
Stock Position:  -0.005143136187389433
Bond Position:  [14.84141531]


portfolio before change:  [14.35498592]
curr_Stock_Price:  96.02156015923582
curr_Factors:  [96.02156016 -0.68574033 -0.865395  ]
mat_Sqrt:  [[20.35725632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00332698 0.04349251 0.23686597]
Stock Position:  0.003326980844234919
Bond Position:  [14.03552402]


portfolio before change:  [14.3588907]
curr_Stock_Price:  95.08535584963532
curr_Factors:  [95.08535585 -0.88394966 -0.89385021]
mat_Sqrt:  [[16.07033622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00334855 -0.03548783  0.11293269]
Stock Position:  -0.003348547998418781
Bond Position:  [14.67728858]


portfolio before change:  [14.37164352]
curr_Stock_Price:  93.46902954057497
curr_Factors:  [93.46902954 -1.17577389 -0.90189146]
mat_Sqrt:  [[11.70439959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262848 -0.05804737 -0.4281819 ]
Stock Position:  -0.002628481174629347
Bond Position:  [14.61732511]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.37235497]
Stock Price:  95.97962249032945
PL:  [14.37235497]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.08562842e+00 -2.53719680e-01 -7.85244930e-02]
 [-1.90506747e-02  1.57577898e-01  2.14399314e-01]
 [-1.24377094e-01  6.25026317e-01  7.20673540e-01]
 [ 1.91526981e-01  1.19942899e-01  1.45882027e-01]
 [ 5.18399791e-02 -1.09504476e-02  6.13634034e-02]
 [-5.38633805e-02  5.89349014e-02 -2.63219292e-02]
 [ 7.60649540e-02  2.19508146e-01  1.12782186e-01]
 [-3.89795347e-02 -1.00888212e-01  4.64601888e-02]
 [ 4.03238457e-02 -3.07162357e-02 -9.72073608e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.81534813]
curr_Stock_Price:  101.18031249620746
curr_Factors:  [101.1803125   -1.37464196  -0.9835086 ]
mat_Sqrt:  [[ 9.57115268  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12051291 -0.08188767 -0.22400852]
Stock Position:  -0.12051291163528027
Bond Position:  [23.00888219]


portfolio before change:  [10.78267332]
curr_Stock_Price:  101.54692989673404
curr_Factors:  [101.5469299   -1.15286559  -0.95057641]
mat_Sqrt:  [[12.39234642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00458984 0.05085805 0.61162157]
Stock Position:  0.004589837452458135
Bond Position:  [10.31658941]


portfolio before change:  [10.79291386]
curr_Stock_Price:  102.653931533519
curr_Factors:  [102.65393153  -0.51239473  -0.95654418]
mat_Sqrt:  [[23.6278129   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00636169 0.20172638 2.05588101]
Stock Position:  0.006361686520513306
Bond Position:  [10.13986172]


portfolio before change:  [10.76646968]
curr_Stock_Price:  97.69999708878743
curr_Factors:  [97.69999709 -0.21564355 -0.93143094]
mat_Sqrt:  [[31.02604581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.007922   0.0387114  0.41616082]
Stock Position:  0.007921997794306444
Bond Position:  [9.99249052]


portfolio before change:  [10.75909409]
curr_Stock_Price:  96.13813254983614
curr_Factors:  [96.13813255 -0.82762173 -0.87243969]
mat_Sqrt:  [[17.5617741   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00353782 -0.00353424  0.17505271]
Stock Position:  0.0035378248400181464
Bond Position:  [10.41897421]


portfolio before change:  [10.7592152]
curr_Stock_Price:  94.69948663923182
curr_Factors:  [94.69948664 -1.03089529 -0.83349974]
mat_Sqrt:  [[14.6774683   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00321624  0.01902116 -0.07508914]
Stock Position:  -0.0032162416873195085
Bond Position:  [11.06379163]


portfolio before change:  [10.76692034]
curr_Stock_Price:  94.0242058666488
curr_Factors:  [94.02420587 -1.149139   -0.80957169]
mat_Sqrt:  [[13.26118791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01085072 0.07084595 0.32173619]
Stock Position:  0.010850719782091995
Bond Position:  [9.74669003]


portfolio before change:  [10.79709318]
curr_Stock_Price:  96.355689028257
curr_Factors:  [96.35568903 -1.66907953 -0.87357952]
mat_Sqrt:  [[ 7.57904638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00660896 -0.03256153  0.13253799]
Stock Position:  -0.006608959221583321
Bond Position:  [11.433904]


portfolio before change:  [10.8042594]
curr_Stock_Price:  96.13661624857957
curr_Factors:  [96.13661625 -1.17359874 -0.87811386]
mat_Sqrt:  [[12.3549608   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115027 -0.00991362 -0.27730554]
Stock Position:  0.0011502708214813533
Bond Position:  [10.69367626]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.81248116]
Stock Price:  98.6347984072205
PL:  [10.81248116]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.20060812e+00 -2.94646348e-01 -4.64007177e-02]
 [ 1.14684997e-02  8.78281397e-02  4.37464182e-02]
 [-6.65835561e-02  2.66574337e-01  3.22124200e-01]
 [ 2.08371420e-01  1.53138927e-01  2.07646247e-01]
 [ 4.97908161e-02  1.17806488e-02  4.17783996e-02]
 [-1.07337997e-01 -6.22253053e-02  1.67179742e-02]
 [-4.37582796e-02  5.40385204e-03  4.97382228e-02]
 [-3.85567294e-02 -9.76935022e-02  5.38209746e-02]
 [-5.27512993e-03  9.90700447e-02 -3.96116182e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.57328102]
curr_Stock_Price:  101.01080046798465
curr_Factors:  [101.01080047  -0.94392099  -1.02907222]
mat_Sqrt:  [[14.0445475   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09044251 -0.0950967  -0.13236833]
Stock Position:  -0.09044250523528095
Bond Position:  [18.70895087]


portfolio before change:  [9.73508579]
curr_Stock_Price:  99.32522181664909
curr_Factors:  [99.32522182 -1.62205097 -1.02504528]
mat_Sqrt:  [[ 7.03785396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0054457  0.02834641 0.12479635]
Stock Position:  0.005445700361010766
Bond Position:  [9.19419039]


portfolio before change:  [9.73903538]
curr_Stock_Price:  99.20610915130598
curr_Factors:  [99.20610915 -1.16984225 -1.03177705]
mat_Sqrt:  [[10.97456474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00488257 0.0860365  0.91893068]
Stock Position:  0.004882565367984219
Bond Position:  [9.25465507]


portfolio before change:  [9.72830137]
curr_Stock_Price:  96.05971049720453
curr_Factors:  [96.0597105  -1.02648622 -1.03336926]
mat_Sqrt:  [[12.24496099  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02303122 0.04942538 0.59235694]
Stock Position:  0.02303121957674073
Bond Position:  [7.51592909]


portfolio before change:  [9.76740378]
curr_Stock_Price:  97.5943017730288
curr_Factors:  [97.59430177 -0.8702377  -1.03053844]
mat_Sqrt:  [[14.58571997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00416322 0.00380219 0.11918215]
Stock Position:  0.004163216567121367
Bond Position:  [9.36109757]


portfolio before change:  [9.76542857]
curr_Stock_Price:  95.9953150058789
curr_Factors:  [95.99531501 -0.63501017 -0.98908681]
mat_Sqrt:  [[18.91967527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00616433 -0.02008313  0.04769173]
Stock Position:  -0.006164331083588501
Bond Position:  [10.35717548]


portfolio before change:  [9.75422509]
curr_Stock_Price:  98.65308443471703
curr_Factors:  [98.65308443 -1.46478491 -1.05082375]
mat_Sqrt:  [[ 7.9725217   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00407681  0.00174409  0.14188931]
Stock Position:  -0.004076809311994252
Bond Position:  [10.1564149]


portfolio before change:  [9.76129771]
curr_Stock_Price:  98.16418689494061
curr_Factors:  [98.16418689 -1.43676146 -1.0798683 ]
mat_Sqrt:  [[ 7.92491583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00599529 -0.03153044  0.15353626]
Stock Position:  -0.005995290380424835
Bond Position:  [10.34982051]


portfolio before change:  [9.76105055]
curr_Stock_Price:  99.06879024965039
curr_Factors:  [99.06879025 -1.04623011 -1.07888732]
mat_Sqrt:  [[11.83069031  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00058     0.03197472 -0.11300092]
Stock Position:  0.0005799974784646146
Bond Position:  [9.7035909]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.7648773]
Stock Price:  97.2993640247851
PL:  [9.7648773]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.05579024e+00 -2.70855281e-01 -2.84202467e-02]
 [ 2.81955476e-02  6.11101541e-02 -8.86764359e-03]
 [-5.70684748e-02  2.76919237e-01  2.86627609e-01]
 [ 1.87784185e-01  1.20222529e-01  1.50241770e-01]
 [ 5.58348386e-02 -3.98190361e-02  6.87509580e-02]
 [-8.06252328e-02 -3.73312958e-02  3.60704481e-03]
 [ 7.09064230e-02  2.28227869e-01  1.34862979e-01]
 [-3.92013035e-02 -1.14501569e-01  4.40221131e-02]
 [-7.75781659e-02 -3.34392162e-02 -6.92190437e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.14928714]
curr_Stock_Price:  99.99760540619303
curr_Factors:  [99.99760541 -0.73303002 -1.00072658]
mat_Sqrt:  [[17.66154425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06323794 -0.08741817 -0.08107505]
Stock Position:  -0.06323793601999018
Bond Position:  [8.47292931]


portfolio before change:  [2.24888846]
curr_Stock_Price:  98.48958977306344
curr_Factors:  [98.48958977 -0.7510377  -0.98828547]
mat_Sqrt:  [[17.29863645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00224639  0.01972322 -0.02529692]
Stock Position:  0.0022463912410494074
Bond Position:  [2.02764231]


portfolio before change:  [2.24604235]
curr_Stock_Price:  96.77119545004872
curr_Factors:  [96.77119545 -0.94773031 -0.96841131]
mat_Sqrt:  [[14.24217683  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00406996 0.0893753  0.81766879]
Stock Position:  0.004069956730344865
Bond Position:  [1.85218777]


portfolio before change:  [2.24752966]
curr_Stock_Price:  96.9090320640054
curr_Factors:  [96.90903206 -1.08732504 -0.98644489]
mat_Sqrt:  [[12.18252806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01994598 0.03880165 0.42859795]
Stock Position:  0.019945981487410235
Bond Position:  [0.3145839]


portfolio before change:  [2.23883636]
curr_Stock_Price:  96.46530160347874
curr_Factors:  [96.4653016  -1.12003456 -0.95491175]
mat_Sqrt:  [[12.112489    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00509726 -0.01285154  0.19612735]
Stock Position:  0.005097263033168164
Bond Position:  [1.74712734]


portfolio before change:  [2.23676117]
curr_Stock_Price:  95.88676170590753
curr_Factors:  [95.88676171 -0.78981908 -0.97469616]
mat_Sqrt:  [[16.42250561  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00532861 -0.01204862  0.01028989]
Stock Position:  -0.0053286123808508525
Bond Position:  [2.74770455]


portfolio before change:  [2.24337211]
curr_Stock_Price:  94.9040009220545
curr_Factors:  [94.90400092 -0.72774193 -1.01031791]
mat_Sqrt:  [[16.68993803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00868919 0.07366023 0.38472654]
Stock Position:  0.008689189372656822
Bond Position:  [1.41873328]


portfolio before change:  [2.2436274]
curr_Stock_Price:  94.85172285738697
curr_Factors:  [94.85172286 -0.85750416 -1.00347293]
mat_Sqrt:  [[14.75139675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00363273 -0.03695522  0.12558284]
Stock Position:  -0.0036327313986984997
Bond Position:  [2.58819824]


portfolio before change:  [2.23908766]
curr_Stock_Price:  96.4577235441288
curr_Factors:  [96.45772354 -0.54240821 -0.97913544]
mat_Sqrt:  [[21.06391037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00467782 -0.01079246 -0.19746266]
Stock Position:  -0.004677820675639405
Bond Position:  [2.69029959]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.24399438]
Stock Price:  95.69642081772882
PL:  [2.24399438]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.48486446e+00 -3.23683338e-01 -1.18879525e-01]
 [-7.11313265e-02  2.06054684e-01  4.23567441e-01]
 [-9.66843331e-02  4.21158804e-01  5.15958004e-01]
 [ 1.03833980e-01  2.56686200e-02  1.21277473e-02]
 [ 5.13208259e-02  9.17851717e-03  2.77527544e-02]
 [ 2.06711546e-02  2.81316320e-02 -4.32227637e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 6.60268568e-03 -1.11986060e-03 -3.34682194e-02]
 [ 1.83699069e-01  4.05966223e-02  4.25555320e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.56368151]
curr_Stock_Price:  102.64719925322258
curr_Factors:  [102.64719925  -0.93806071  -1.02655871]
mat_Sqrt:  [[14.39208559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.1094492  -0.10446835 -0.3391302 ]
Stock Position:  -0.10944919812795569
Bond Position:  [32.79833516]


portfolio before change:  [21.50003079]
curr_Stock_Price:  103.37862524778762
curr_Factors:  [103.37862525  -0.81890625  -1.01232812]
mat_Sqrt:  [[16.56287683  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00346496 0.06650386 1.20832001]
Stock Position:  0.003464962763040151
Bond Position:  [21.1418277]


portfolio before change:  [21.50520334]
curr_Stock_Price:  101.81987709356115
curr_Factors:  [101.81987709  -1.17326953  -1.01075329]
mat_Sqrt:  [[11.46366562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00825249 0.13592842 1.47188457]
Stock Position:  0.008252494207139503
Bond Position:  [20.6649354]


portfolio before change:  [21.50545296]
curr_Stock_Price:  100.59777000713899
curr_Factors:  [100.59777001  -1.52067626  -1.00962915]
mat_Sqrt:  [[ 8.01107278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01392437 0.00828451 0.03459709]
Stock Position:  0.013924368643937106
Bond Position:  [20.10469253]


portfolio before change:  [21.5081185]
curr_Stock_Price:  100.067094516952
curr_Factors:  [100.06709452  -1.08219998  -0.97855927]
mat_Sqrt:  [[12.7442687   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0046185  0.00296235 0.07917088]
Stock Position:  0.0046184988326325
Bond Position:  [21.04595874]


portfolio before change:  [21.52918156]
curr_Stock_Price:  102.34866975314095
curr_Factors:  [102.34866975  -0.46868984  -0.97135552]
mat_Sqrt:  [[24.24814113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00072544  0.00907945 -0.12330251]
Stock Position:  0.0007254448948819589
Bond Position:  [21.45493324]


portfolio before change:  [21.5403099]
curr_Stock_Price:  102.89755948817465
curr_Factors:  [102.89755949  -0.82307873  -1.03432674]
mat_Sqrt:  [[16.05994768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298875 -0.01197701  0.13962421]
Stock Position:  -0.0029887487811488785
Bond Position:  [21.84784486]


portfolio before change:  [21.55266816]
curr_Stock_Price:  102.41856367868866
curr_Factors:  [102.41856368  -0.75209158  -0.96623132]
mat_Sqrt:  [[18.37048092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.49082525e-05 -3.61433454e-04 -9.54755141e-02]
Stock Position:  -2.4908252465713702e-05
Bond Position:  [21.55521922]


portfolio before change:  [21.56338085]
curr_Stock_Price:  105.13284194284489
curr_Factors:  [105.13284194  -1.19740949  -0.99486109]
mat_Sqrt:  [[11.7394402   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01709387 0.0131025  0.12139909]
Stock Position:  0.017093867201537844
Bond Position:  [19.76625401]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.56516791]
Stock Price:  104.65907294340369
PL:  [16.90609496]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.13977966e+00 -2.88295300e-01 -3.11801095e-02]
 [ 7.87874039e-03  9.65813327e-02  5.54827195e-02]
 [-6.45739191e-02  2.67790693e-01  3.14139487e-01]
 [ 1.93668713e-01  1.23211941e-01  1.51143132e-01]
 [ 5.69928055e-02 -3.75107183e-02  4.96076160e-02]
 [-1.72423917e-02  1.54352141e-01 -5.91052371e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-1.10552030e-02 -2.31114460e-02 -1.08609160e-02]
 [ 9.88180371e-02  1.02774236e-01 -1.58889175e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.43168726]
curr_Stock_Price:  100.44557339314746
curr_Factors:  [100.44557339  -0.81969123  -0.96102389]
mat_Sqrt:  [[16.92684642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07118823 -0.09304691 -0.08894817]
Stock Position:  -0.07118823426365745
Bond Position:  [12.58223027]


portfolio before change:  [5.48149652]
curr_Stock_Price:  99.83428459918075
curr_Factors:  [99.8342846  -0.8951375  -1.01946146]
mat_Sqrt:  [[14.71566689  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00264471 0.03117149 0.15827676]
Stock Position:  0.0026447109305033963
Bond Position:  [5.2174637]


portfolio before change:  [5.48154576]
curr_Stock_Price:  98.86626153507537
curr_Factors:  [98.86626154 -1.10347136 -1.05131011]
mat_Sqrt:  [[11.46141951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00472996 0.08642907 0.89615252]
Stock Position:  0.004729962233566985
Bond Position:  [5.01391208]


portfolio before change:  [5.4753455]
curr_Stock_Price:  97.0252655364308
curr_Factors:  [97.02526554 -0.83486979 -0.98911877]
mat_Sqrt:  [[15.65801393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01594527 0.03976648 0.43116929]
Stock Position:  0.01594526671976508
Bond Position:  [3.92825177]


portfolio before change:  [5.50318147]
curr_Stock_Price:  98.64777504392275
curr_Factors:  [98.64777504 -1.51446273 -0.99126757]
mat_Sqrt:  [[ 8.05123412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00738546 -0.01210653  0.14151672]
Stock Position:  0.0073854608497330235
Bond Position:  [4.77462219]


portfolio before change:  [5.51143983]
curr_Stock_Price:  99.44264134030948
curr_Factors:  [99.44264134 -1.79000623 -1.02162472]
mat_Sqrt:  [[ 5.977187    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036803  0.04981694 -0.16861079]
Stock Position:  0.0003680328456785169
Bond Position:  [5.47484167]


portfolio before change:  [5.51432873]
curr_Stock_Price:  99.85236417712125
curr_Factors:  [99.85236418 -2.10981944 -1.05882667]
mat_Sqrt:  [[ 4.19984081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0114288  -0.01197701  0.13962421]
Stock Position:  -0.011428801999556457
Bond Position:  [6.65552163]


portfolio before change:  [5.508307]
curr_Stock_Price:  100.6705006682036
curr_Factors:  [100.67050067  -2.05429614  -1.08672865]
mat_Sqrt:  [[ 4.35283791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00413289 -0.00745919 -0.03098317]
Stock Position:  -0.004132885878159517
Bond Position:  [5.92436669]


portfolio before change:  [5.51101558]
curr_Stock_Price:  100.73204114450421
curr_Factors:  [100.73204114  -1.6573951   -1.07033334]
mat_Sqrt:  [[ 6.58461253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01770088  0.03317024 -0.04532666]
Stock Position:  0.017700878827146493
Bond Position:  [3.72796993]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.49897244]
Stock Price:  99.94634010468883
PL:  [5.49897244]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.21953457e+00 -3.15619974e-01 -1.11375564e-02]
 [ 1.58070845e-02  9.31363658e-02  8.55265753e-02]
 [-9.04982744e-02  5.16885605e-01  5.50456080e-01]
 [-4.52522545e-02  3.35836351e-01  1.02269366e-01]
 [-9.90416439e-02 -3.31527056e-01  2.67894655e-01]
 [-5.78314214e-02 -1.60894151e-02 -7.58041771e-03]
 [ 1.81426834e-01  4.41235565e-01  2.42150694e-01]
 [-3.91192488e-02 -1.13639671e-01  4.73338466e-02]
 [-1.24305975e-01 -8.40647824e-03 -4.72130019e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.96914043]
curr_Stock_Price:  100.38244697131233
curr_Factors:  [100.38244697  -0.57186317  -0.97058816]
mat_Sqrt:  [[21.46741114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05991564 -0.10186591 -0.03177235]
Stock Position:  -0.05991563968938827
Bond Position:  [10.98361895]


portfolio before change:  [4.98223071]
curr_Stock_Price:  100.25565028296886
curr_Factors:  [100.25565028  -0.37368899  -0.98501339]
mat_Sqrt:  [[25.76510463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00202897 0.03005963 0.24398351]
Stock Position:  0.0020289653553504238
Bond Position:  [4.77881547]


portfolio before change:  [4.97988459]
curr_Stock_Price:  97.9213901182096
curr_Factors:  [ 9.79213901e+01  7.16491754e-02 -9.71471676e-01]
mat_Sqrt:  [[39.81893347  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00319878 0.16682411 1.57029798]
Stock Position:  0.0031987781616148086
Bond Position:  [4.66665578]


portfolio before change:  [4.95716691]
curr_Stock_Price:  90.08977897285409
curr_Factors:  [90.08977897  0.11637409 -0.99120421]
mat_Sqrt:  [[37.56138757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00117609 0.10839072 0.29174604]
Stock Position:  0.0011760934138026356
Bond Position:  [4.85121291]


portfolio before change:  [4.95516341]
curr_Stock_Price:  86.32331309972497
curr_Factors:  [ 8.63233131e+01 -1.02141156e-02 -9.47157559e-01]
mat_Sqrt:  [[33.1395697   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338057 -0.1069999   0.76422888]
Stock Position:  -0.003380567529525756
Bond Position:  [5.2469852]


portfolio before change:  [4.94885508]
curr_Stock_Price:  88.96561322065907
curr_Factors:  [ 8.89656132e+01  3.10709381e-02 -9.30972757e-01]
mat_Sqrt:  [[36.17427056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173225 -0.00519284 -0.02162482]
Stock Position:  -0.0017322534722044145
Bond Position:  [5.10296607]


portfolio before change:  [4.94597422]
curr_Stock_Price:  92.10197875315036
curr_Factors:  [92.10197875 -0.39394046 -0.9336078 ]
mat_Sqrt:  [[24.41867381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0131425  0.14240817 0.69078853]
Stock Position:  0.013142502026012743
Bond Position:  [3.73552378]


portfolio before change:  [4.9928278]
curr_Stock_Price:  95.52486983112236
curr_Factors:  [95.52486983 -0.40904055 -0.94473544]
mat_Sqrt:  [[24.67056035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213428 -0.03667705  0.13503029]
Stock Position:  -0.0021342793929016155
Bond Position:  [5.19670457]


portfolio before change:  [4.98987042]
curr_Stock_Price:  98.12827340292905
curr_Factors:  [98.1282734  -0.15597876 -1.02722004]
mat_Sqrt:  [[30.05643361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00451348 -0.00271318 -0.13468555]
Stock Position:  -0.0045134847043105065
Bond Position:  [5.43277088]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.01249347]
Stock Price:  93.71793592309086
PL:  [5.01249347]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.06517302e-01 -2.03797582e-01  2.06988334e-03]
 [-2.34060315e-02  1.68224501e-01  2.28234843e-01]
 [-1.57121529e-01  8.74218207e-01  8.59222975e-01]
 [ 1.22062593e-01  3.59260938e-02  1.75802987e-02]
 [ 6.06780555e-03 -5.81453350e-02 -4.83882130e-02]
 [ 6.43700877e-02 -1.63609281e-03 -4.75507866e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 1.69841761e-04  2.12266088e-03 -3.28179556e-02]
 [ 1.97299332e-01 -4.79514375e-03  7.57872597e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.75892769]
curr_Stock_Price:  97.96299574846587
curr_Factors:  [97.96299575 -0.44737706 -0.9677591 ]
mat_Sqrt:  [[23.79448067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03562569 -0.06577539  0.0059048 ]
Stock Position:  -0.03562569016707607
Bond Position:  [-9.26892836]


portfolio before change:  [-12.91334476]
curr_Stock_Price:  102.16730566178894
curr_Factors:  [102.16730566  -0.24397451  -0.99349697]
mat_Sqrt:  [[29.64045771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00194062 0.05429422 0.65109048]
Stock Position:  0.0019406209488210086
Bond Position:  [-13.11161277]


portfolio before change:  [-12.91226849]
curr_Stock_Price:  106.10094810756762
curr_Factors:  [106.10094811  -0.44749942  -0.95605277]
mat_Sqrt:  [[26.07139648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00754527 0.28215271 2.45112399]
Stock Position:  0.007545267898973561
Bond Position:  [-13.71282857]


portfolio before change:  [-12.92006814]
curr_Stock_Price:  105.97616586481995
curr_Factors:  [105.97616586  -0.68378194  -0.86055139]
mat_Sqrt:  [[22.62104994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0058788 0.0115951 0.0501517]
Stock Position:  0.005878796056922095
Bond Position:  [-13.5430804]


portfolio before change:  [-12.93182108]
curr_Stock_Price:  105.12910242961327
curr_Factors:  [105.12910243  -0.44781758  -0.86977038]
mat_Sqrt:  [[28.15151526  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055692 -0.01876633 -0.1380381 ]
Stock Position:  -0.00055692433356672
Bond Position:  [-12.87327213]


portfolio before change:  [-12.93884868]
curr_Stock_Price:  106.18731907395525
curr_Factors:  [106.18731907  -0.67109342  -0.84657042]
mat_Sqrt:  [[23.2787482   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00233388 -0.00052805 -0.13564916]
Stock Position:  0.0023338822809645023
Bond Position:  [-13.18667738]


portfolio before change:  [-12.9481629]
curr_Stock_Price:  105.02220596318507
curr_Factors:  [105.02220596  -1.00811301  -0.83907429]
mat_Sqrt:  [[16.55990668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00289852 -0.01197701  0.13962421]
Stock Position:  -0.0028985156734281526
Bond Position:  [-12.64375439]


portfolio before change:  [-12.96063221]
curr_Stock_Price:  107.14255077614781
curr_Factors:  [107.14255078  -1.13127447  -0.87269232]
mat_Sqrt:  [[14.44276215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042207  0.00068509 -0.09362049]
Stock Position:  -0.0004220667046473783
Bond Position:  [-12.91541091]


portfolio before change:  [-12.96754489]
curr_Stock_Price:  108.21669367598184
curr_Factors:  [108.21669368  -0.6167509   -0.79976873]
mat_Sqrt:  [[26.24868829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00806861 -0.00154763  0.21619996]
Stock Position:  0.008068614113640342
Bond Position:  [-13.84070363]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.01338838]
Stock Price:  103.39289008500944
PL:  [-16.40627847]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.12833051e+00 -2.84814403e-01 -3.31273639e-02]
 [-1.00452455e-02  1.36959159e-01  1.64611374e-01]
 [-1.06306388e-01  4.89818216e-01  6.00372503e-01]
 [ 1.11679744e-01  3.00835319e-02  1.44745760e-02]
 [ 4.11076772e-02 -1.83314083e-02  8.40329865e-03]
 [ 5.08719138e-02  9.57378987e-03 -4.65231048e-02]
 [-4.20836206e-02 -2.20615733e-02  2.56478835e-02]
 [ 9.98028311e-05  2.02477169e-03 -3.27210993e-02]
 [ 2.09477638e-01 -1.20717308e-02  8.31931413e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.26355736]
curr_Stock_Price:  100.42262774097553
curr_Factors:  [100.42262774  -0.8062378   -0.99524832]
mat_Sqrt:  [[16.57509792  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07198932 -0.09192345 -0.09450315]
Stock Position:  -0.07198932441013896
Bond Position:  [12.49291449]


portfolio before change:  [5.2363868]
curr_Stock_Price:  100.88684360074546
curr_Factors:  [100.8868436   -1.32957203  -0.90626671]
mat_Sqrt:  [[10.78504864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0047763  0.04420338 0.46959043]
Stock Position:  0.004776295741746828
Bond Position:  [4.7545214]


portfolio before change:  [5.24246076]
curr_Stock_Price:  101.66068689109188
curr_Factors:  [101.66068689  -0.8736333   -0.93754754]
mat_Sqrt:  [[16.61755768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00699428 0.15808815 1.71269564]
Stock Position:  0.006994280577883279
Bond Position:  [4.53141739]


portfolio before change:  [5.259538]
curr_Stock_Price:  103.77826938165687
curr_Factors:  [103.77826938  -1.03066699  -0.96926265]
mat_Sqrt:  [[14.0458497   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00859863 0.00970942 0.04129194]
Stock Position:  0.00859863461642981
Bond Position:  [4.36718658]


portfolio before change:  [5.26552412]
curr_Stock_Price:  104.22043001380992
curr_Factors:  [104.22043001  -1.31619928  -0.88396604]
mat_Sqrt:  [[11.54604389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00338481 -0.00591644  0.02397227]
Stock Position:  0.0033848052809192695
Bond Position:  [4.91275825]


portfolio before change:  [5.27042755]
curr_Stock_Price:  104.94320144920586
curr_Factors:  [104.94320145  -0.68525827  -0.80193306]
mat_Sqrt:  [[23.71785018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00182688  0.00308993 -0.13271747]
Stock Position:  0.0018268800165149252
Bond Position:  [5.07870891]


portfolio before change:  [5.27647233]
curr_Stock_Price:  106.8616599737333
curr_Factors:  [106.86165997  -1.11951877  -0.7697317 ]
mat_Sqrt:  [[16.15588903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255954 -0.00712034  0.07316627]
Stock Position:  -0.002559535285429889
Bond Position:  [5.54998852]


portfolio before change:  [5.27937365]
curr_Stock_Price:  106.81257823715985
curr_Factors:  [106.81257824  -0.93762196  -0.72805157]
mat_Sqrt:  [[20.19433585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030534  0.00065349 -0.09334419]
Stock Position:  -0.00030533605277514885
Bond Position:  [5.31198738]


portfolio before change:  [5.28142445]
curr_Stock_Price:  108.79679062626893
curr_Factors:  [108.79679063  -0.55517301  -0.78074102]
mat_Sqrt:  [[28.60460761  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00783074 -0.00389613  0.23732688]
Stock Position:  0.007830739666243956
Bond Position:  [4.42946511]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.27918032]
Stock Price:  108.22731436904618
PL:  [-2.94813405]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.27716281e-01 -1.55584806e-01 -5.95266918e-02]
 [ 2.01013821e-02  6.89794700e-02 -1.79072974e-02]
 [-5.87372972e-02  2.89711083e-01  3.00207144e-01]
 [ 2.36110768e-01  1.86992476e-01  2.59633054e-01]
 [ 5.60680013e-02 -5.98254220e-02  8.80585475e-02]
 [-1.07337997e-01 -6.22253053e-02  1.67179742e-02]
 [ 1.80056048e-02  1.40876844e-01  9.95676944e-02]
 [-4.12010900e-02 -1.28676822e-01  7.15781424e-03]
 [-4.39680534e-02 -2.48785618e-01 -1.40670835e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.02636262]
curr_Stock_Price:  98.88182755157555
curr_Factors:  [98.88182755 -1.22002139 -0.95239566]
mat_Sqrt:  [[11.26283571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06851079 -0.05021478 -0.16981308]
Stock Position:  -0.06851078636694201
Bond Position:  [0.74810914]


portfolio before change:  [-5.9987149]
curr_Stock_Price:  98.48373591329064
curr_Factors:  [98.48373591 -1.00188662 -0.8908525 ]
mat_Sqrt:  [[14.83741898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0020574   0.02226303 -0.05108454]
Stock Position:  0.0020573959446245882
Bond Position:  [-6.20133494]


portfolio before change:  [-6.00440738]
curr_Stock_Price:  97.22435683913753
curr_Factors:  [97.22435684 -1.06182259 -0.9172681 ]
mat_Sqrt:  [[13.43590467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00459063 0.09350385 0.85640742]
Stock Position:  0.004590629221487444
Bond Position:  [-6.45072836]


portfolio before change:  [-6.01599854]
curr_Stock_Price:  95.40216941450358
curr_Factors:  [95.40216941 -0.67078595 -0.88435726]
mat_Sqrt:  [[20.14504015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01624607 0.06035156 0.74066084]
Stock Position:  0.016246074469909534
Bond Position:  [-7.56590929]


portfolio before change:  [-6.04450999]
curr_Stock_Price:  93.88010625836223
curr_Factors:  [93.88010626 -0.46339283 -0.88933713]
mat_Sqrt:  [[24.27115321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00254751 -0.01930857  0.25120653]
Stock Position:  0.002547512404875979
Bond Position:  [-6.28367073]


portfolio before change:  [-6.04309222]
curr_Stock_Price:  95.67024365040494
curr_Factors:  [95.67024365 -0.51738509 -0.92286531]
mat_Sqrt:  [[22.66126141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00514654 -0.02008313  0.04769173]
Stock Position:  -0.005146542384402355
Bond Position:  [-5.55072125]


portfolio before change:  [-6.0516502]
curr_Stock_Price:  96.79370213978662
curr_Factors:  [96.79370214 -0.181118   -0.94142896]
mat_Sqrt:  [[31.50149376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00212962 0.04546781 0.28403892]
Stock Position:  0.002129617762413219
Bond Position:  [-6.25778379]


portfolio before change:  [-6.06834792]
curr_Stock_Price:  90.42258156105909
curr_Factors:  [90.42258156 -0.13176195 -0.9456026 ]
mat_Sqrt:  [[30.78813788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214388 -0.04153027  0.02041925]
Stock Position:  -0.002143879373213103
Bond Position:  [-5.87449282]


portfolio before change:  [-6.07556589]
curr_Stock_Price:  92.41895603807167
curr_Factors:  [92.41895604 -0.5521111  -0.94323923]
mat_Sqrt:  [[20.71756275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00595946 -0.08029521 -0.40129474]
Stock Position:  -0.005959461564457164
Bond Position:  [-5.52479868]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.07492946]
Stock Price:  91.84851431739386
PL:  [-6.07492946]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.52079486e-01 -1.72401937e-01 -4.77410265e-02]
 [ 3.82595286e-02  4.87307196e-02 -1.89537447e-02]
 [-5.43932362e-02  3.97144943e-01  3.35713969e-01]
 [ 2.44683879e-01  1.88924703e-01  2.55092992e-01]
 [ 4.85887464e-02  2.21403782e-02  3.62199819e-02]
 [-9.27998562e-02 -4.86770025e-02  9.58248879e-03]
 [-1.09269387e-02  6.63871908e-02  4.86142552e-02]
 [-3.84932941e-02 -1.06412870e-01  5.61679681e-02]
 [-5.77157840e-03 -4.32976745e-02 -9.04201020e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.74039116]
curr_Stock_Price:  98.78437997744273
curr_Factors:  [98.78437998 -0.97725042 -1.02863743]
mat_Sqrt:  [[13.2905286   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05996872 -0.05564249 -0.13619186]
Stock Position:  -0.059968719401773514
Bond Position:  [-0.8164184]


portfolio before change:  [-6.63961847]
curr_Stock_Price:  97.09715028696692
curr_Factors:  [97.09715029 -0.81345012 -0.96347338]
mat_Sqrt:  [[16.42473669  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00269945  0.01572777 -0.05406976]
Stock Position:  0.0026994483331504457
Bond Position:  [-6.90172721]


portfolio before change:  [-6.65205375]
curr_Stock_Price:  93.76922679876128
curr_Factors:  [93.7692268  -0.23603263 -0.97578184]
mat_Sqrt:  [[27.91103844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00341087 0.12817798 0.95769851]
Stock Position:  0.0034108714009503786
Bond Position:  [-6.97188853]


portfolio before change:  [-6.64978539]
curr_Stock_Price:  95.4565315554711
curr_Factors:  [95.45653156 -0.47429657 -1.0048916 ]
mat_Sqrt:  [[21.74715206  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01541897 0.06097519 0.7277093 ]
Stock Position:  0.015418966597826456
Bond Position:  [-8.12162646]


portfolio before change:  [-6.61734079]
curr_Stock_Price:  97.82416301683708
curr_Factors:  [97.82416302 -0.83019959 -1.01063922]
mat_Sqrt:  [[15.52315537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0038975  0.00714578 0.10332553]
Stock Position:  0.0038975004494784674
Bond Position:  [-6.99861051]


portfolio before change:  [-6.62029288]
curr_Stock_Price:  97.96478860743247
curr_Factors:  [97.96478861 -1.00116174 -0.97349637]
mat_Sqrt:  [[13.59837097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00741118 -0.01571044  0.02733617]
Stock Position:  -0.007411181138548029
Bond Position:  [-5.89425809]


portfolio before change:  [-6.61466185]
curr_Stock_Price:  96.80722755754641
curr_Factors:  [96.80722756 -1.01290415 -0.98183054]
mat_Sqrt:  [[13.17059863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0009527  0.02142637 0.13868294]
Stock Position:  0.0009527002939206575
Bond Position:  [-6.70689013]


portfolio before change:  [-6.61825684]
curr_Stock_Price:  96.55457011229117
curr_Factors:  [96.55457011 -1.43156047 -1.00449975]
mat_Sqrt:  [[ 8.44900019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00576985 -0.03434461  0.16023158]
Stock Position:  -0.005769853312896158
Bond Position:  [-6.06115114]


portfolio before change:  [-6.61850933]
curr_Stock_Price:  96.0729546273777
curr_Factors:  [96.07295463 -0.99331596 -1.00221999]
mat_Sqrt:  [[13.06023206  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253185 -0.01397426 -0.25794338]
Stock Position:  -0.002531854340985527
Bond Position:  [-6.3752666]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.62170295]
Stock Price:  96.07500752150474
PL:  [-6.62170295]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-9.20520573e-01 -2.45574233e-01 -1.80650706e-02]
 [-1.69958017e-02  1.53154488e-01  1.98765628e-01]
 [-9.45859409e-02  4.06862439e-01  5.18276573e-01]
 [ 1.02665519e-01  2.50111124e-02  1.17782369e-02]
 [ 5.04257050e-02  1.49461461e-02  2.74947912e-02]
 [-6.76971147e-02 -2.41078396e-02 -3.72852012e-03]
 [-2.53969333e-02  5.51289451e-02  5.60672452e-02]
 [-3.82344902e-02 -1.07141370e-01  6.24059692e-02]
 [-7.72812139e-02  3.73319276e-02 -4.15520306e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.83110277]
curr_Stock_Price:  99.18142726511986
curr_Factors:  [99.18142727 -0.60434977 -0.98500483]
mat_Sqrt:  [[20.23869097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04814223 -0.07925874 -0.05153462]
Stock Position:  -0.04814223027725965
Bond Position:  [0.94371234]


portfolio before change:  [-3.94278602]
curr_Stock_Price:  101.51109132888288
curr_Factors:  [101.51109133  -0.85625009  -1.00740278]
mat_Sqrt:  [[15.74487951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00348301 0.0494304  0.56702301]
Stock Position:  0.0034830111637132025
Bond Position:  [-4.29635028]


portfolio before change:  [-3.94752449]
curr_Stock_Price:  100.76755046558529
curr_Factors:  [100.76755047  -0.85383936  -1.01242566]
mat_Sqrt:  [[15.58877892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00604648 0.13131429 1.4784988 ]
Stock Position:  0.006046481866909071
Bond Position:  [-4.55681366]


portfolio before change:  [-3.95444947]
curr_Stock_Price:  99.99916880879763
curr_Factors:  [99.99916881 -0.91352403 -1.06129517]
mat_Sqrt:  [[13.87852495  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00793853 0.0080723  0.03360003]
Stock Position:  0.007938531947477826
Bond Position:  [-4.74829607]


portfolio before change:  [-3.95177586]
curr_Stock_Price:  100.63510006779045
curr_Factors:  [100.63510007  -0.79574499  -1.12231464]
mat_Sqrt:  [[14.78246194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00399723 0.00482385 0.07843499]
Stock Position:  0.003997231669963779
Bond Position:  [-4.35403766]


portfolio before change:  [-3.95814693]
curr_Stock_Price:  99.5859957720392
curr_Factors:  [99.58599577 -0.47285899 -1.09252645]
mat_Sqrt:  [[20.81421385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00352544 -0.00778077 -0.01063643]
Stock Position:  -0.003525436433680432
Bond Position:  [-3.60706283]


portfolio before change:  [-3.95373275]
curr_Stock_Price:  97.82219610810594
curr_Factors:  [97.82219611 -0.48017167 -1.03416648]
mat_Sqrt:  [[21.51635525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.25444386e-04  1.77927905e-02  1.59944245e-01]
Stock Position:  -0.0001254443860747976
Bond Position:  [-3.94146151]


portfolio before change:  [-3.95564888]
curr_Stock_Price:  97.38298783318236
curr_Factors:  [97.38298783 -1.06878765 -1.09536439]
mat_Sqrt:  [[11.18417118  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0042351  -0.03457973  0.17802686]
Stock Position:  -0.0042350984214835205
Bond Position:  [-3.54322234]


portfolio before change:  [-3.96281808]
curr_Stock_Price:  98.65737360651836
curr_Factors:  [98.65737361 -0.58677389 -1.13667952]
mat_Sqrt:  [[17.60529254  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00443859  0.01204883 -0.11853638]
Stock Position:  -0.0044385879235708595
Bond Position:  [-3.52491865]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.96957365]
Stock Price:  99.78220598922518
PL:  [-3.96957365]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.99815758e-01 -2.14439437e-01 -7.38864700e-02]
 [-7.12794465e-03  1.30631121e-01  1.43147062e-01]
 [-1.04911143e-01  4.82796624e-01  5.65556529e-01]
 [ 1.07378160e-01  2.76629758e-02  1.31878843e-02]
 [ 4.95524139e-02  2.05731159e-02  2.72431192e-02]
 [-1.96860555e-02  1.21174468e-02 -2.65448803e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-2.00696951e-03 -2.18310243e-02 -1.57127535e-02]
 [-9.12776869e-02  1.17616178e-02 -4.95448193e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.01350578]
curr_Stock_Price:  100.25202602555565
curr_Factors:  [100.25202603  -1.29664132  -0.98069258]
mat_Sqrt:  [[10.28157415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09324156 -0.06921003 -0.21077753]
Stock Position:  -0.09324156232278735
Bond Position:  [13.36116131]


portfolio before change:  [3.9684007]
curr_Stock_Price:  100.8074364029843
curr_Factors:  [100.8074364   -0.97146705  -1.02310844]
mat_Sqrt:  [[13.71700957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00355448 0.04216101 0.40835872]
Stock Position:  0.003554476839793943
Bond Position:  [3.610083]


portfolio before change:  [3.97600953]
curr_Stock_Price:  102.4401211766189
curr_Factors:  [102.44012118  -1.01018331  -1.05417357]
mat_Sqrt:  [[12.99963881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00839124 0.15582194 1.61337536]
Stock Position:  0.008391236867439063
Bond Position:  [3.11641021]


portfolio before change:  [3.97324172]
curr_Stock_Price:  101.9245345391451
curr_Factors:  [101.92453454  -0.54865316  -0.99802378]
mat_Sqrt:  [[21.70528427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00533127 0.00892819 0.03762136]
Stock Position:  0.005331273513446571
Bond Position:  [3.42985415]


portfolio before change:  [3.96202814]
curr_Stock_Price:  99.4994223535534
curr_Factors:  [99.49942235 -0.93983533 -1.00356645]
mat_Sqrt:  [[14.24990251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00416233 0.00663994 0.07771704]
Stock Position:  0.00416233458466723
Bond Position:  [3.54787825]


portfolio before change:  [3.96786392]
curr_Stock_Price:  100.47517305756168
curr_Factors:  [100.47517306  -1.28974947  -0.99429221]
mat_Sqrt:  [[10.23557085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221102  0.00391089 -0.07572515]
Stock Position:  -0.002211019137990048
Bond Position:  [4.19001645]


portfolio before change:  [3.9674224]
curr_Stock_Price:  101.62263205478901
curr_Factors:  [101.62263205  -1.06072851  -0.99718547]
mat_Sqrt:  [[12.9792546   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00369814 -0.01197701  0.13962421]
Stock Position:  -0.0036981437331411165
Bond Position:  [4.3432375]


portfolio before change:  [3.96893128]
curr_Stock_Price:  101.80198812561099
curr_Factors:  [101.80198813  -0.62533435  -0.99066509]
mat_Sqrt:  [[20.22723972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004781  -0.00704593 -0.04482411]
Stock Position:  -0.0004780959343535582
Bond Position:  [4.01760239]


portfolio before change:  [3.97308365]
curr_Stock_Price:  97.31948859024911
curr_Factors:  [97.31948859 -0.4868626  -1.01608155]
mat_Sqrt:  [[21.65107523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00457207  0.00379605 -0.14133758]
Stock Position:  -0.0045720662602232315
Bond Position:  [4.4180348]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.97479707]
Stock Price:  97.42800544719529
PL:  [3.97479707]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.10365490e+00 -2.98696486e-01  7.69997520e-03]
 [ 6.27360379e-02  2.80025920e-02  4.08149709e-02]
 [-7.49863732e-02  3.76316224e-01  4.13323530e-01]
 [ 1.81386754e-01  1.20120181e-01  1.56865515e-01]
 [ 5.49410756e-02 -2.88253612e-02  5.80570616e-02]
 [-4.08784091e-02  7.46842874e-03 -1.82644600e-02]
 [-3.46018028e-02  2.36180037e-02  4.70008902e-02]
 [-3.82667775e-02 -1.06060318e-01  6.14490886e-02]
 [ 4.80555087e-02  1.35934691e-01 -4.53586985e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.75130946]
curr_Stock_Price:  99.46526859670062
curr_Factors:  [99.4652686  -0.30707511 -0.98679876]
mat_Sqrt:  [[27.27402138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0426433  -0.09640388  0.02196589]
Stock Position:  -0.042643301492178674
Bond Position:  [2.49021797]


portfolio before change:  [-1.69429587]
curr_Stock_Price:  98.157485869863
curr_Factors:  [98.15748587 -0.2822532  -0.99061146]
mat_Sqrt:  [[27.48687254  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00279346 0.0090378  0.11643375]
Stock Position:  0.0027934558189978828
Bond Position:  [-1.96849447]


portfolio before change:  [-1.69484074]
curr_Stock_Price:  98.31486037757476
curr_Factors:  [98.31486038 -0.56163775 -1.02760944]
mat_Sqrt:  [[20.06401675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00429616 0.12145554 1.17909698]
Stock Position:  0.004296157036647364
Bond Position:  [-2.11721682]


portfolio before change:  [-1.70320052]
curr_Stock_Price:  96.61545610805221
curr_Factors:  [96.61545611 -1.4671759  -1.01081388]
mat_Sqrt:  [[ 8.1071708   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02934763 0.03876862 0.44749365]
Stock Position:  0.029347626712800515
Bond Position:  [-4.53863486]


portfolio before change:  [-1.68433786]
curr_Stock_Price:  97.3355330005261
curr_Factors:  [97.335533   -1.15794856 -1.08668339]
mat_Sqrt:  [[10.31430905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00590519 -0.00930335  0.16562064]
Stock Position:  0.005905191628349996
Bond Position:  [-2.25912284]


portfolio before change:  [-1.67915807]
curr_Stock_Price:  98.404022177756
curr_Factors:  [98.40402218 -1.35969752 -1.09345237]
mat_Sqrt:  [[ 8.4649304   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508949  0.00241043 -0.05210342]
Stock Position:  -0.005089485411044351
Bond Position:  [-1.17833224]


portfolio before change:  [-1.67785572]
curr_Stock_Price:  98.03234183421095
curr_Factors:  [98.03234183 -1.31279408 -1.0930483 ]
mat_Sqrt:  [[ 8.84148691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00228319  0.00762268  0.13408046]
Stock Position:  -0.0022831885161939416
Bond Position:  [-1.45402941]


portfolio before change:  [-1.67748559]
curr_Stock_Price:  97.55172749880627
curr_Factors:  [97.5517275  -0.93566024 -1.00065646]
mat_Sqrt:  [[14.07029833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00336688 -0.03423082  0.17529715]
Stock Position:  -0.003366880032778961
Bond Position:  [-1.34904062]


portfolio before change:  [-1.68039415]
curr_Stock_Price:  98.21521382971468
curr_Factors:  [98.21521383 -1.33364789 -0.98340427]
mat_Sqrt:  [[ 9.68045562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00687408  0.04387273 -0.12939574]
Stock Position:  0.0068740830303536185
Bond Position:  [-2.35553369]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.68762871]
Stock Price:  97.33415124767583
PL:  [-1.68762871]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.45038019e-01 -1.99741655e-01 -7.70082579e-02]
 [ 1.83298070e-02  7.28720553e-02 -5.62877523e-03]
 [-1.02196680e-01  4.57973116e-01  5.84143653e-01]
 [ 1.06949545e-01  2.74217883e-02  1.30596766e-02]
 [ 5.29143855e-02 -1.08943642e-03  2.82119992e-02]
 [ 3.12630148e-02  2.42323373e-02 -4.51625245e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 8.91045492e-03  1.43388893e-02 -4.49052821e-02]
 [ 1.77142549e-01  5.48708338e-02  3.01851256e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.62950243]
curr_Stock_Price:  100.06314314292368
curr_Factors:  [100.06314314  -1.34011879  -0.97266444]
mat_Sqrt:  [[ 9.90478716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09101956 -0.06446634 -0.21968312]
Stock Position:  -0.09101955889853501
Bond Position:  [11.73720558]


portfolio before change:  [2.71644052]
curr_Stock_Price:  99.17247718936468
curr_Factors:  [99.17247719 -0.82862731 -0.94121273]
mat_Sqrt:  [[16.89504677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00189735  0.02351935 -0.01605733]
Stock Position:  0.0018973480536556909
Bond Position:  [2.52827581]


portfolio before change:  [2.72121266]
curr_Stock_Price:  101.02120850648745
curr_Factors:  [101.02120851  -0.87891561  -0.88953903]
mat_Sqrt:  [[17.23385632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00641322 0.14781019 1.66639925]
Stock Position:  0.006413220139738038
Bond Position:  [2.07334141]


portfolio before change:  [2.7279909]
curr_Stock_Price:  101.91643937290249
curr_Factors:  [101.91643937  -1.13040522  -0.86312966]
mat_Sqrt:  [[13.88235181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00829923 0.00885034 0.03725562]
Stock Position:  0.008299227000040526
Bond Position:  [1.88216324]


portfolio before change:  [2.72244997]
curr_Stock_Price:  101.13537228763605
curr_Factors:  [101.13537229  -1.06518855  -0.87980731]
mat_Sqrt:  [[14.46112607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00404192 -0.00035161  0.08048098]
Stock Position:  0.004041922817087901
Bond Position:  [2.3136686]


portfolio before change:  [2.7305626]
curr_Stock_Price:  102.85621505888903
curr_Factors:  [102.85621506  -1.27997446  -0.90882271]
mat_Sqrt:  [[11.52518766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234188  0.00782095 -0.12883611]
Stock Position:  0.0023418844885551827
Bond Position:  [2.48968523]


portfolio before change:  [2.73596714]
curr_Stock_Price:  104.63230052139222
curr_Factors:  [104.63230052  -1.24595897  -0.87912061]
mat_Sqrt:  [[12.49555185  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0038413  -0.01197701  0.13962421]
Stock Position:  -0.0038412988596599152
Bond Position:  [3.13789108]


portfolio before change:  [2.74109331]
curr_Stock_Price:  103.70635745333223
curr_Factors:  [103.70635745  -1.50279805  -0.86468143]
mat_Sqrt:  [[ 9.71901181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00027483  0.00462786 -0.12810227]
Stock Position:  0.0002748341262577627
Bond Position:  [2.71259126]


portfolio before change:  [2.74255134]
curr_Stock_Price:  104.07530990405994
curr_Factors:  [104.0753099   -1.42737613  -0.88500645]
mat_Sqrt:  [[10.30606127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01887283 0.01770949 0.08610976]
Stock Position:  0.018872828251915497
Bond Position:  [0.77835589]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.72226517]
Stock Price:  102.97979611177887
PL:  [-0.25753094]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.10305088e-01 -1.91939796e-01 -6.02467240e-02]
 [ 2.12038064e-02  6.62644112e-02 -2.11026208e-02]
 [-8.63776485e-02  4.04798593e-01  4.76395019e-01]
 [ 1.06131450e-01  2.69614360e-02  1.28149677e-02]
 [ 5.28136464e-02 -4.40333609e-04  2.81829675e-02]
 [ 3.03597730e-02  1.78248521e-02 -4.36821058e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 1.37808411e-03 -1.25986388e-02 -2.34279448e-02]
 [ 8.89392079e-03  7.74020131e-02 -1.30086133e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.83664197]
curr_Stock_Price:  99.45362277913837
curr_Factors:  [99.45362278 -1.11460336 -1.01168143]
mat_Sqrt:  [[11.86279042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07264585 -0.0619483  -0.17186713]
Stock Position:  -0.07264584599916411
Bond Position:  [5.38825059]


portfolio before change:  [-1.77718441]
curr_Stock_Price:  98.67225992201135
curr_Factors:  [98.67225992 -1.06849202 -1.03542941]
mat_Sqrt:  [[12.03576246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00252767  0.02138675 -0.0601999 ]
Stock Position:  0.0025276685544135275
Bond Position:  [-2.02659518]


portfolio before change:  [-1.77616528]
curr_Stock_Price:  99.47643193224043
curr_Factors:  [99.47643193 -0.47006894 -1.05722429]
mat_Sqrt:  [[21.5985788   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00432877 0.13064818 1.35902239]
Stock Position:  0.004328768348901714
Bond Position:  [-2.20677571]


portfolio before change:  [-1.7690747]
curr_Stock_Price:  101.36940495467127
curr_Factors:  [101.36940495  -0.68883225  -1.09614596]
mat_Sqrt:  [[17.00985884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00671674 0.00870177 0.03655754]
Stock Position:  0.006716738535322582
Bond Position:  [-2.44994649]


portfolio before change:  [-1.77190369]
curr_Stock_Price:  101.13064155069699
curr_Factors:  [101.13064155  -0.27009471  -1.11000922]
mat_Sqrt:  [[25.43965643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00229864 -0.00014212  0.08039816]
Stock Position:  0.002298639055028392
Bond Position:  [-2.00436653]


portfolio before change:  [-1.768038]
curr_Stock_Price:  103.24847257175989
curr_Factors:  [103.24847257  -0.48675382  -1.11551379]
mat_Sqrt:  [[20.79829133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120595  0.00575295 -0.12461289]
Stock Position:  0.0012059492205950307
Bond Position:  [-1.89255041]


portfolio before change:  [-1.77116978]
curr_Stock_Price:  101.43639795316074
curr_Factors:  [101.43639795  -0.27075025  -1.07809845]
mat_Sqrt:  [[26.32669067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182321 -0.01197701  0.13962421]
Stock Position:  -0.0018232124066491719
Bond Position:  [-1.58622968]


portfolio before change:  [-1.7728322]
curr_Stock_Price:  101.91309112743916
curr_Factors:  [101.91309113  -0.89563513  -1.06921546]
mat_Sqrt:  [[14.28585389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004183  -0.00406619 -0.06683341]
Stock Position:  -0.00041830271416198563
Bond Position:  [-1.73020168]


portfolio before change:  [-1.77389294]
curr_Stock_Price:  102.3802500472888
curr_Factors:  [102.38025005  -0.70616346  -1.05044716]
mat_Sqrt:  [[17.673798    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124694  0.02498139 -0.03710995]
Stock Position:  0.0012469401587144162
Bond Position:  [-1.90155498]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.77089216]
Stock Price:  105.54943899200039
PL:  [-7.32033115]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-5.63317746e-01 -9.15047569e-02 -6.78038213e-02]
 [ 2.28640892e-02  6.27737425e-02 -3.49995195e-02]
 [-7.53907464e-02  3.48615314e-01  4.01106643e-01]
 [ 1.28210982e-01  5.48586816e-02  5.63338956e-02]
 [ 5.45240357e-02 -3.73808799e-02  8.03507819e-02]
 [-1.03511738e-01 -5.86595597e-02  1.48400027e-02]
 [-4.37612832e-02  5.48233300e-03  4.97471532e-02]
 [-3.59680328e-02 -8.31781829e-02  4.06085540e-02]
 [ 5.17220932e-02  1.39769490e-01 -4.46996050e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.34447891]
curr_Stock_Price:  98.0195579529487
curr_Factors:  [98.01955795 -1.2895661  -1.03961633]
mat_Sqrt:  [[ 9.54468635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06242599 -0.02953303 -0.19342543]
Stock Position:  -0.06242598769233512
Bond Position:  [-6.22551119]


portfolio before change:  [-12.33422231]
curr_Stock_Price:  97.80538225793256
curr_Factors:  [97.80538226 -1.19545526 -1.01891582]
mat_Sqrt:  [[10.68251747  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00267104  0.02026014 -0.09984389]
Stock Position:  0.002671044427626262
Bond Position:  [-12.59546483]


portfolio before change:  [-12.33756341]
curr_Stock_Price:  98.91289246744665
curr_Factors:  [98.91289247 -0.69626155 -1.054747  ]
mat_Sqrt:  [[17.17115657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00452186 0.11251511 1.14424561]
Stock Position:  0.004521862398029183
Bond Position:  [-12.7848339]


portfolio before change:  [-12.34363964]
curr_Stock_Price:  98.98317028541386
curr_Factors:  [98.98317029 -0.28296835 -1.0367217 ]
mat_Sqrt:  [[26.45009602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00570539 0.01770556 0.16070492]
Stock Position:  0.005705388429959016
Bond Position:  [-12.90837707]


portfolio before change:  [-12.37579745]
curr_Stock_Price:  94.47830504281725
curr_Factors:  [94.47830504 -0.43009176 -0.99512615]
mat_Sqrt:  [[22.71788089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00278614 -0.01206463  0.22921842]
Stock Position:  0.002786141475886575
Bond Position:  [-12.63902737]


portfolio before change:  [-12.37526274]
curr_Stock_Price:  96.93898288864514
curr_Factors:  [96.93898289 -0.79624076 -0.97997095]
mat_Sqrt:  [[16.40965743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00685306 -0.01893229  0.0423344 ]
Stock Position:  -0.006853060068949159
Bond Position:  [-11.71093407]


portfolio before change:  [-12.39315718]
curr_Stock_Price:  98.69549820505088
curr_Factors:  [98.69549821 -1.35919711 -0.96267136]
mat_Sqrt:  [[ 9.68105478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00335579  0.00176942  0.14191478]
Stock Position:  -0.003355792556903206
Bond Position:  [-12.06195556]


portfolio before change:  [-12.40033413]
curr_Stock_Price:  99.03653793559695
curr_Factors:  [99.03653794 -1.52835749 -0.93866148]
mat_Sqrt:  [[ 8.40200092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00531511 -0.02684564  0.1158449 ]
Stock Position:  -0.005315105571386465
Bond Position:  [-11.87394447]


portfolio before change:  [-12.40660192]
curr_Stock_Price:  99.0985008739877
curr_Factors:  [99.09850087 -1.53434401 -0.86511413]
mat_Sqrt:  [[ 8.99488582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00790762  0.04511041 -0.12751553]
Stock Position:  0.007907621467281903
Bond Position:  [-13.19023535]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.41576809]
Stock Price:  98.77357307639191
PL:  [-12.41576809]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.16004165e-01 -1.59073675e-01 -4.09019110e-02]
 [ 2.28027921e-02  6.21356920e-02 -2.28411452e-02]
 [-5.25221454e-02  1.75499766e-01  2.16116274e-01]
 [ 1.28578265e-01  5.42850565e-02  5.45821453e-02]
 [ 3.47357359e-02 -7.82753897e-02  1.09769123e-01]
 [-4.99575354e-02  3.50561520e-01 -9.67315209e-02]
 [-5.04319490e-02 -2.92202944e-02  4.97028525e-02]
 [-2.52346220e-02 -5.42271931e-02  1.63629413e-02]
 [ 9.59170724e-03  1.10363647e-01 -4.03892194e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.65644402]
curr_Stock_Price:  98.38640950411717
curr_Factors:  [98.3864095  -0.92613791 -1.02013051]
mat_Sqrt:  [[14.05016662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05386584 -0.05134081 -0.11668177]
Stock Position:  -0.05386583882966014
Bond Position:  [-4.35677755]


portfolio before change:  [-9.66790688]
curr_Stock_Price:  98.55876224136593
curr_Factors:  [98.55876224 -1.55668743 -1.00213782]
mat_Sqrt:  [[ 7.62801525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00404086  0.02005421 -0.06515943]
Stock Position:  0.004040862112650687
Bond Position:  [-10.06616925]


portfolio before change:  [-9.67159777]
curr_Stock_Price:  98.89122900822306
curr_Factors:  [98.89122901 -1.6976591  -0.97753875]
mat_Sqrt:  [[ 6.81293288  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00402413 0.05664231 0.61651958]
Stock Position:  0.0040241324204558435
Bond Position:  [-10.06954917]


portfolio before change:  [-9.67851231]
curr_Stock_Price:  98.42441893406698
curr_Factors:  [98.42441893 -1.65980806 -0.98971631]
mat_Sqrt:  [[ 6.95711286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02167576 0.01752043 0.15570767]
Stock Position:  0.021675757245779487
Bond Position:  [-11.81193612]


portfolio before change:  [-9.67224718]
curr_Stock_Price:  98.98599453701965
curr_Factors:  [98.98599454 -2.17523391 -1.04936682]
mat_Sqrt:  [[ 3.93683712  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0104562  -0.02526327  0.31314075]
Stock Position:  0.01045620280070073
Bond Position:  [-10.70726481]


portfolio before change:  [-9.6754578]
curr_Stock_Price:  99.19107372063468
curr_Factors:  [99.19107372 -2.44776292 -1.09263503]
mat_Sqrt:  [[ 2.87671805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00064493  0.11314324 -0.2759481 ]
Stock Position:  0.0006449349817462939
Bond Position:  [-9.73942959]


portfolio before change:  [-9.68026456]
curr_Stock_Price:  99.2905749310863
curr_Factors:  [99.29057493 -2.06195345 -1.06268761]
mat_Sqrt:  [[ 4.36408955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01059808 -0.00943081  0.1417884 ]
Stock Position:  -0.010598078665796427
Bond Position:  [-8.62797524]


portfolio before change:  [-9.68651611]
curr_Stock_Price:  99.47329539114561
curr_Factors:  [99.47329539 -2.25865539 -1.13032797]
mat_Sqrt:  [[ 3.35652382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00982076 -0.01750175  0.04667892]
Stock Position:  -0.009820764534899154
Bond Position:  [-8.7096123]


portfolio before change:  [-9.69106583]
curr_Stock_Price:  99.49303149265884
curr_Factors:  [99.49303149 -1.28958195 -1.09448315]
mat_Sqrt:  [[ 9.17078152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0026034   0.03561971 -0.1152192 ]
Stock Position:  0.0026033961549883776
Bond Position:  [-9.95008561]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.694223]
Stock Price:  100.19178131167193
PL:  [-9.88600431]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-6.72114697e-01 -1.34640962e-01 -6.19130125e-02]
 [ 2.20271633e-02  6.47317139e-02 -3.10064565e-02]
 [-5.09603323e-02  2.12754118e-01  2.28191633e-01]
 [ 2.08534465e-01  1.49237969e-01  1.98047648e-01]
 [ 5.24931795e-02 -1.60218021e-02  6.32712030e-02]
 [-7.17065242e-02 -2.90198230e-02 -7.70359056e-04]
 [ 2.34769573e-03  8.75749568e-02  5.58442028e-02]
 [-3.89899860e-02 -1.08784135e-01  4.79601758e-02]
 [ 5.60934037e-02 -9.87702663e-02 -1.25635430e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.21294554]
curr_Stock_Price:  98.58341202853708
curr_Factors:  [98.58341203 -1.22401803 -0.99384379]
mat_Sqrt:  [[10.7299746   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06637817 -0.04345518 -0.17662059]
Stock Position:  -0.06637817290457793
Bond Position:  [-1.66915877]


portfolio before change:  [-8.16945332]
curr_Stock_Price:  97.91561704251882
curr_Factors:  [97.91561704 -1.11119517 -0.97267314]
mat_Sqrt:  [[12.18539066  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00237262  0.02089207 -0.08845279]
Stock Position:  0.002372620084801782
Bond Position:  [-8.40176988]


portfolio before change:  [-8.17370972]
curr_Stock_Price:  97.89266139637076
curr_Factors:  [97.8926614  -1.35422495 -1.02483148]
mat_Sqrt:  [[ 9.06857513  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00430579 0.0686661  0.65096721]
Stock Position:  0.004305785837193772
Bond Position:  [-8.59521455]


portfolio before change:  [-8.1849647]
curr_Stock_Price:  96.27709064491576
curr_Factors:  [96.27709064 -0.88327319 -1.00523099]
mat_Sqrt:  [[14.56652682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0191826  0.04816635 0.56497482]
Stock Position:  0.019182599149458742
Bond Position:  [-10.03180954]


portfolio before change:  [-8.19249295]
curr_Stock_Price:  96.14618622765325
curr_Factors:  [96.14618623 -0.8537045  -0.94485939]
mat_Sqrt:  [[15.91569791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00390419 -0.00517101  0.18049513]
Stock Position:  0.003904190910653275
Bond Position:  [-8.56786601]


portfolio before change:  [-8.19359545]
curr_Stock_Price:  96.96133564656273
curr_Factors:  [96.96133565 -0.99195407 -0.97573822]
mat_Sqrt:  [[13.5531638   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00573943 -0.00936611 -0.00219762]
Stock Position:  -0.005739428874254869
Bond Position:  [-7.63709276]


portfolio before change:  [-8.19361657]
curr_Stock_Price:  96.29953132791289
curr_Factors:  [96.29953133 -1.12717216 -0.96283555]
mat_Sqrt:  [[11.91092142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00265496 0.0282647  0.15930797]
Stock Position:  0.002654959089709373
Bond Position:  [-8.44928789]


portfolio before change:  [-8.19908166]
curr_Stock_Price:  95.83271318894134
curr_Factors:  [95.83271319 -1.02305828 -0.94224703]
mat_Sqrt:  [[13.42741883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00382841 -0.03510993  0.13681703]
Stock Position:  -0.003828407027151923
Bond Position:  [-7.83219502]


portfolio before change:  [-8.19936419]
curr_Stock_Price:  94.88335105664505
curr_Factors:  [94.88335106 -1.33717982 -0.96244812]
mat_Sqrt:  [[ 9.51643506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00108095 -0.03187797 -0.35840291]
Stock Position:  0.0010809491939496067
Bond Position:  [-8.30192827]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.202875]
Stock Price:  95.47652267197572
PL:  [-8.202875]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.45759977e-01 -2.11251523e-01 -4.37657614e-02]
 [ 2.00801407e-02  6.89966808e-02 -1.73127195e-02]
 [-5.62166993e-02  2.70390214e-01  2.79696545e-01]
 [ 1.30881845e-01  5.72592082e-02  5.92742623e-02]
 [ 5.03265190e-02  5.79394763e-03  4.69865704e-02]
 [-1.06283483e-01 -6.09331160e-02  1.60505899e-02]
 [ 1.36712807e-03  1.15591636e-01  9.33808061e-02]
 [-3.82053273e-02 -1.20723415e-01  6.71883100e-02]
 [-1.04448971e-01 -1.55233044e-01 -5.15878498e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.92861935]
curr_Stock_Price:  99.30459435795363
curr_Factors:  [99.30459436 -0.88679339 -1.02714788]
mat_Sqrt:  [[14.6472201   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06129594 -0.06818114 -0.12485154]
Stock Position:  -0.06129594255607787
Bond Position:  [3.15834936]


portfolio before change:  [-2.89440947]
curr_Stock_Price:  98.77225388268967
curr_Factors:  [98.77225388 -0.87981402 -0.99647487]
mat_Sqrt:  [[15.12770519  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202477  0.02226858 -0.04938837]
Stock Position:  0.0020247674570302
Bond Position:  [-3.09440031]


portfolio before change:  [-2.89876205]
curr_Stock_Price:  97.3869125182228
curr_Factors:  [97.38691252 -1.07501131 -0.98535419]
mat_Sqrt:  [[12.40781271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00451887 0.08726807 0.79789639]
Stock Position:  0.004518869802756963
Bond Position:  [-3.33884083]


portfolio before change:  [-2.8944372]
curr_Stock_Price:  98.71350279603529
curr_Factors:  [98.7135028  -0.92764303 -0.96319113]
mat_Sqrt:  [[14.90039291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01038021 0.01848033 0.16909297]
Stock Position:  0.01038020550784088
Bond Position:  [-3.91910365]


portfolio before change:  [-2.91216544]
curr_Stock_Price:  97.19443844751709
curr_Factors:  [97.19443845 -0.86305882 -0.96220351]
mat_Sqrt:  [[15.66534839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00390035 0.00186999 0.13403961]
Stock Position:  0.0039003471621561372
Bond Position:  [-3.29125749]


portfolio before change:  [-2.90954294]
curr_Stock_Price:  98.28883779077513
curr_Factors:  [98.28883779 -0.78707903 -1.00602272]
mat_Sqrt:  [[16.35949925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00705676 -0.01966608  0.04578787]
Stock Position:  -0.007056761872451735
Bond Position:  [-2.21594202]


portfolio before change:  [-2.90500435]
curr_Stock_Price:  97.48863449825478
curr_Factors:  [ 9.74886345e+01 -8.10610793e-02 -1.03069997e+00]
mat_Sqrt:  [[32.0717235   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00137266 0.03730704 0.26638945]
Stock Position:  0.0013726561705943484
Bond Position:  [-3.03882272]


portfolio before change:  [-2.90760555]
curr_Stock_Price:  96.70080938139827
curr_Factors:  [96.70080938  0.39231275 -1.08848673]
mat_Sqrt:  [[48.20427879  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101927 -0.03896331  0.19166955]
Stock Position:  -0.0010192691604186416
Bond Position:  [-2.8090414]


portfolio before change:  [-2.90576663]
curr_Stock_Price:  93.51834031682874
curr_Factors:  [93.51834032  0.26354415 -1.14407115]
mat_Sqrt:  [[38.76937246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378304 -0.05010125 -0.14716578]
Stock Position:  -0.003783040580478652
Bond Position:  [-2.55198296]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.93833609]
Stock Price:  101.79029727332015
PL:  [-4.72863336]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.01586046e+00 -2.37418582e-01 -8.00514974e-02]
 [-5.12533167e-03  1.26063472e-01  1.31809376e-01]
 [-8.83986118e-02  3.71176091e-01  4.68112434e-01]
 [ 1.01725672e-01  2.44822486e-02  1.14971094e-02]
 [ 5.29521128e-02 -2.54406107e-03  3.06382365e-02]
 [ 2.03350380e-02  1.37077961e-01 -6.49318752e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-8.65014117e-03 -3.07867770e-02 -6.74772514e-03]
 [-3.41859696e-03  9.03884459e-02 -2.82636279e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.65465687]
curr_Stock_Price:  100.88543055748696
curr_Factors:  [100.88543056  -1.34317319  -1.02286285]
mat_Sqrt:  [[ 9.46830094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11413492 -0.07662652 -0.22836464]
Stock Position:  -0.11413491991729723
Bond Position:  [20.16920741]


portfolio before change:  [8.68899632]
curr_Stock_Price:  100.6729423781381
curr_Factors:  [100.67294238  -0.98668248  -0.98984781]
mat_Sqrt:  [[13.9481486   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00340638 0.04068681 0.37601546]
Stock Position:  0.0034063834741292097
Bond Position:  [8.34606567]


portfolio before change:  [8.69258626]
curr_Stock_Price:  100.50146026155043
curr_Factors:  [100.50146026  -1.00709788  -0.99775594]
mat_Sqrt:  [[13.53553474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00612613 0.11979657 1.33539448]
Stock Position:  0.006126129659288196
Bond Position:  [8.07690129]


portfolio before change:  [8.69164596]
curr_Stock_Price:  99.68858755236808
curr_Factors:  [99.68858755 -1.01318117 -0.9648254 ]
mat_Sqrt:  [[13.79139212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00790855 0.00790161 0.03279805]
Stock Position:  0.007908551016872349
Bond Position:  [7.90325368]


portfolio before change:  [8.69387055]
curr_Stock_Price:  99.47008720365632
curr_Factors:  [99.4700872  -1.37323015 -0.98001483]
mat_Sqrt:  [[ 9.45564565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00620654 -0.00082109  0.08740236]
Stock Position:  0.006206536766046902
Bond Position:  [8.0765058]


portfolio before change:  [8.70201553]
curr_Stock_Price:  100.13160112771551
curr_Factors:  [100.13160113  -1.73541216  -1.03343582]
mat_Sqrt:  [[ 6.28167927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0055816   0.04424172 -0.18523257]
Stock Position:  0.005581596040757222
Bond Position:  [8.14312138]


portfolio before change:  [8.70871878]
curr_Stock_Price:  100.60291251131844
curr_Factors:  [100.60291251  -1.40783287  -1.07136207]
mat_Sqrt:  [[ 8.43159758  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00569277 -0.01197701  0.13962421]
Stock Position:  -0.005692770388201046
Bond Position:  [9.28142806]


portfolio before change:  [8.71037282]
curr_Stock_Price:  101.12775919335843
curr_Factors:  [101.12775919  -1.10574154  -1.05977777]
mat_Sqrt:  [[11.59837906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140639 -0.00993639 -0.01924938]
Stock Position:  -0.0014063895699476334
Bond Position:  [8.85259784]


portfolio before change:  [8.71472203]
curr_Stock_Price:  101.18335777447409
curr_Factors:  [101.18335777  -0.87055638  -1.03371943]
mat_Sqrt:  [[15.06928367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00061467  0.02917275 -0.08062826]
Stock Position:  0.0006146661401536733
Bond Position:  [8.65252805]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.7186583]
Stock Price:  100.54711013676422
PL:  [8.17154816]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.75991851e-01 -2.31459159e-01 -1.25121514e-02]
 [ 6.11920706e-02  3.04674729e-02  5.05049548e-02]
 [-7.47516797e-02  4.12464412e-01  4.30519308e-01]
 [ 2.58305739e-01  2.94502898e-01  3.30229507e-01]
 [ 4.89581395e-02 -3.83946410e-02  9.63767668e-02]
 [-4.79808613e-02 -6.90953640e-03 -1.24151849e-02]
 [ 1.03953377e-01  2.93837988e-01  1.73953470e-01]
 [-3.92984234e-02 -1.27492967e-01  4.17135291e-02]
 [-6.92995760e-02 -1.91172880e-01 -1.25078770e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.82282766]
curr_Stock_Price:  98.77312939518552
curr_Factors:  [98.7731294  -0.50681063 -1.02906481]
mat_Sqrt:  [[21.26261046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04354086 -0.07470312 -0.03569369]
Stock Position:  -0.04354085723892053
Bond Position:  [-2.52216094]


portfolio before change:  [-6.83458755]
curr_Stock_Price:  99.01424746755684
curr_Factors:  [99.01424747 -0.17864953 -1.08057914]
mat_Sqrt:  [[28.10746164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00276512 0.00983333 0.14407658]
Stock Position:  0.0027651197826900893
Bond Position:  [-7.1083738]


portfolio before change:  [-6.84288251]
curr_Stock_Price:  97.30007502795047
curr_Factors:  [97.30007503 -0.13574926 -1.10781378]
mat_Sqrt:  [[28.05695997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00346872 0.13312232 1.22815175]
Stock Position:  0.00346871691378971
Bond Position:  [-7.18038893]


portfolio before change:  [-6.8621913]
curr_Stock_Price:  92.7688058777826
curr_Factors:  [92.76880588 -0.25319934 -1.13772474]
mat_Sqrt:  [[23.08507626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01671334 0.0950504  0.94205286]
Stock Position:  0.01671333909246492
Bond Position:  [-8.41266781]


portfolio before change:  [-6.84843122]
curr_Stock_Price:  93.84384276540936
curr_Factors:  [93.84384277 -0.54049984 -1.15333374]
mat_Sqrt:  [[17.24976594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00352432 -0.01239182  0.27493609]
Stock Position:  0.003524319782556211
Bond Position:  [-7.17916694]


portfolio before change:  [-6.84863051]
curr_Stock_Price:  94.80606938520239
curr_Factors:  [94.80606939 -0.89375033 -1.2607204 ]
mat_Sqrt:  [[10.99414334  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00472301 -0.00223004 -0.03541707]
Stock Position:  -0.004723014960064226
Bond Position:  [-6.40086003]


portfolio before change:  [-6.84884709]
curr_Stock_Price:  94.17413158972983
curr_Factors:  [94.17413159 -0.88246652 -1.22123629]
mat_Sqrt:  [[11.48960515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01735838 0.0948358  0.49624083]
Stock Position:  0.017358377927199093
Bond Position:  [-8.48355726]


portfolio before change:  [-6.87276538]
curr_Stock_Price:  93.04064696139218
curr_Factors:  [93.04064696 -0.66935164 -1.20943398]
mat_Sqrt:  [[14.21433324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00399653 -0.04114818  0.11899709]
Stock Position:  -0.00399653482953302
Bond Position:  [-6.5009252]


portfolio before change:  [-6.87840321]
curr_Stock_Price:  93.63780159240271
curr_Factors:  [93.63780159 -0.76307698 -1.23703382]
mat_Sqrt:  [[12.67109443  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01056374 -0.06170078 -0.35681491]
Stock Position:  -0.010563742104142808
Bond Position:  [-5.88923762]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.90501713]
Stock Price:  95.87834951892366
PL:  [-6.90501713]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-6.05624685e-01 -1.22325392e-01  1.08428254e-02]
 [ 2.90120906e-02  5.54209855e-02 -5.14292654e-02]
 [-5.24601437e-02  2.82537067e-01  2.69741863e-01]
 [ 2.36225846e-01  1.80041020e-01  2.42716935e-01]
 [ 4.93591814e-02  2.18181917e-02  2.71874319e-02]
 [-1.02386749e-01 -5.68952496e-02  1.39412674e-02]
 [-5.04965796e-02  7.14295595e-04  5.25814527e-02]
 [-2.13072128e-02 -6.01469002e-02  1.86216769e-02]
 [ 3.15431875e-03  7.51429438e-02 -5.22643568e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-23.97744401]
curr_Stock_Price:  96.43194042683209
curr_Factors:  [96.43194043 -0.49991806 -0.92283613]
mat_Sqrt:  [[23.24484278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02703313 -0.03948035  0.03093156]
Stock Position:  -0.02703313479800339
Bond Position:  [-21.37058637]


portfolio before change:  [-23.98185538]
curr_Stock_Price:  96.19975876423216
curr_Factors:  [96.19975876 -1.09100125 -0.95210292]
mat_Sqrt:  [[12.46996165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0023919   0.01788705 -0.14671338]
Stock Position:  0.0023918996584746423
Bond Position:  [-24.21195555]


portfolio before change:  [-23.99526867]
curr_Stock_Price:  95.65446737242289
curr_Factors:  [95.65446737 -0.72532317 -1.03716874]
mat_Sqrt:  [[16.41590185  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00367164 0.09118845 0.76949845]
Stock Position:  0.0036716423720101797
Bond Position:  [-24.34647766]


portfolio before change:  [-24.00709001]
curr_Stock_Price:  95.75113726913924
curr_Factors:  [95.75113727 -0.45150877 -1.06786283]
mat_Sqrt:  [[20.95507591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01539107 0.05810799 0.69240386]
Stock Position:  0.015391065818231825
Bond Position:  [-25.48080207]


portfolio before change:  [-23.96974317]
curr_Stock_Price:  99.00565068870203
curr_Factors:  [99.00565069 -1.01645101 -1.04711572]
mat_Sqrt:  [[12.57373607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00472114 0.00704179 0.07755818]
Stock Position:  0.004721143512750344
Bond Position:  [-24.43716305]


portfolio before change:  [-23.98538672]
curr_Stock_Price:  98.28084443737868
curr_Factors:  [98.28084444 -0.9874586  -1.0583665 ]
mat_Sqrt:  [[12.70510694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00874882 -0.01836286  0.03977056]
Stock Position:  -0.008748820033810585
Bond Position:  [-23.1255453]


portfolio before change:  [-24.00430797]
curr_Stock_Price:  99.12159661324596
curr_Factors:  [99.12159661 -1.12872568 -1.13849611]
mat_Sqrt:  [[10.26895793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003858    0.00023054  0.15000025]
Stock Position:  -0.0038579991048970368
Bond Position:  [-23.62189694]


portfolio before change:  [-24.02013302]
curr_Stock_Price:  100.16129151999823
curr_Factors:  [100.16129152  -1.04703745  -1.12691065]
mat_Sqrt:  [[11.39111548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261463 -0.01941233  0.05312246]
Stock Position:  -0.0026146265955804635
Bond Position:  [-23.75824864]


portfolio before change:  [-24.02557668]
curr_Stock_Price:  97.69882507476368
curr_Factors:  [97.69882507 -1.03027012 -1.07773685]
mat_Sqrt:  [[11.86843752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065926  0.02425228 -0.14909566]
Stock Position:  0.0006592603911241911
Bond Position:  [-24.08998565]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-24.0367427]
Stock Price:  99.036666956478
PL:  [-24.0367427]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.09699847e+00 -2.67593248e-01 -5.46584707e-02]
 [-1.12226144e-03  1.16654522e-01  1.13376105e-01]
 [-6.07075313e-02  2.83239358e-01  3.05377335e-01]
 [ 1.92413321e-01  1.42130397e-01  1.98192468e-01]
 [ 5.63426505e-02 -5.09743599e-02  7.14720748e-02]
 [-6.45230865e-02  1.36856071e-01 -4.17800638e-02]
 [-3.46014189e-02  1.71282574e-02  4.63834691e-02]
 [-3.76601792e-02 -8.74490399e-02  4.42332142e-02]
 [ 2.06667340e-02  1.16901731e-01 -4.24887181e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.55868939]
curr_Stock_Price:  100.73585758326573
curr_Factors:  [100.73585758  -1.08487267  -0.97976079]
mat_Sqrt:  [[12.77983261  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09098537 -0.08636535 -0.1559254 ]
Stock Position:  -0.09098537251200228
Bond Position:  [16.72417892]


portfolio before change:  [7.6089801]
curr_Stock_Price:  100.27505239430279
curr_Factors:  [100.27505239  -1.35995063  -0.9396498 ]
mat_Sqrt:  [[10.05747858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00455706 0.03765008 0.32343047]
Stock Position:  0.004557061023828333
Bond Position:  [7.15202057]


portfolio before change:  [7.60231103]
curr_Stock_Price:  98.02667802356478
curr_Factors:  [98.02667802 -1.17850945 -0.93021444]
mat_Sqrt:  [[11.89973079  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00499535 0.09141511 0.87115654]
Stock Position:  0.004995352342699827
Bond Position:  [7.11263323]


portfolio before change:  [7.59498456]
curr_Stock_Price:  95.84791886345282
curr_Factors:  [95.84791886 -1.67072185 -0.8744151 ]
mat_Sqrt:  [[ 7.52044871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03482258 0.04587239 0.56538794]
Stock Position:  0.034822581067002784
Bond Position:  [4.25731264]


portfolio before change:  [7.6481726]
curr_Stock_Price:  97.31417590777552
curr_Factors:  [97.31417591 -1.40770082 -0.86977316]
mat_Sqrt:  [[ 9.97887823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00606548 -0.0164519   0.20388994]
Stock Position:  0.006065484279099386
Bond Position:  [7.057915]


portfolio before change:  [7.64835559]
curr_Stock_Price:  96.76238861302787
curr_Factors:  [96.76238861 -1.59886488 -0.92314098]
mat_Sqrt:  [[ 7.76986282  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00580651  0.04417011 -0.11918689]
Stock Position:  -0.00580650891365023
Bond Position:  [8.21020726]


portfolio before change:  [7.64481746]
curr_Stock_Price:  98.0788871049908
curr_Factors:  [98.0788871  -1.50438021 -0.96043318]
mat_Sqrt:  [[ 8.33912868  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259465  0.00552812  0.13231913]
Stock Position:  -0.0025946526177818897
Bond Position:  [7.8992981]


portfolio before change:  [7.64682554]
curr_Stock_Price:  98.82756189874014
curr_Factors:  [98.8275619  -1.62685447 -0.97321264]
mat_Sqrt:  [[ 7.33978405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00633283 -0.02822406  0.12618505]
Stock Position:  -0.00633282564999222
Bond Position:  [8.27268326]


portfolio before change:  [7.65234021]
curr_Stock_Price:  98.61007733156018
curr_Factors:  [98.61007733 -1.18597395 -0.98112179]
mat_Sqrt:  [[11.29181033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00317542  0.03772987 -0.12120849]
Stock Position:  0.0031754187908578945
Bond Position:  [7.33921192]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.65068313]
Stock Price:  96.93231421259036
PL:  [7.65068313]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.16408568e+00 -2.93993777e-01 -3.06071959e-02]
 [-5.14414212e-02  1.88736569e-01  3.48396424e-01]
 [-1.22130689e-01  6.29674390e-01  6.21261874e-01]
 [ 1.30513039e-01  4.06812679e-02  2.01080002e-02]
 [-3.03980789e-02 -7.29144286e-02  4.80677872e-03]
 [ 7.54267281e-02 -1.50264360e-02 -4.82387344e-02]
 [-4.54398266e-02 -2.81234961e-02  3.50326516e-02]
 [ 9.39981698e-04  3.19903907e-03 -3.38829761e-02]
 [ 1.94020674e-01  3.65936552e-02  4.84709942e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.98068266]
curr_Stock_Price:  100.52049794655488
curr_Factors:  [100.52049795  -0.75019164  -1.02315461]
mat_Sqrt:  [[17.06475822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07209857 -0.09488608 -0.08731381]
Stock Position:  -0.0720985650831055
Bond Position:  [13.22806632]


portfolio before change:  [5.83476608]
curr_Stock_Price:  102.63610546897674
curr_Factors:  [102.63610547  -1.14640273  -1.02349932]
mat_Sqrt:  [[11.71989389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00496595 0.06091447 0.99387802]
Stock Position:  0.0049659487023532645
Bond Position:  [5.32508044]


portfolio before change:  [5.85140946]
curr_Stock_Price:  105.45131281961005
curr_Factors:  [105.45131282  -1.26079715  -1.16386015]
mat_Sqrt:  [[ 9.33333182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0142731  0.20322654 1.7722872 ]
Stock Position:  0.014273103050971195
Bond Position:  [4.34629201]


portfolio before change:  [5.88299852]
curr_Stock_Price:  107.51220799029036
curr_Factors:  [107.51220799  -0.89182112  -1.21306894]
mat_Sqrt:  [[13.10133772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01090893 0.01312982 0.05736253]
Stock Position:  0.010908931525351908
Bond Position:  [4.7101552]


portfolio before change:  [5.87704329]
curr_Stock_Price:  106.75036463504365
curr_Factors:  [106.75036464  -1.61110964  -1.21590109]
mat_Sqrt:  [[ 6.31850315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00701123 -0.02353303  0.0137124 ]
Stock Position:  -0.007011232516975957
Bond Position:  [6.62549492]


portfolio before change:  [5.87925561]
curr_Stock_Price:  106.9074341044401
curr_Factors:  [106.9074341   -1.31861613  -1.19159794]
mat_Sqrt:  [[ 8.68631925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00719669 -0.00484976 -0.13761168]
Stock Position:  0.007196693731106485
Bond Position:  [5.10987555]


portfolio before change:  [5.87595201]
curr_Stock_Price:  106.09328580403799
curr_Factors:  [106.0932858   -1.34163044  -1.14547242]
mat_Sqrt:  [[ 8.82171151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00499104 -0.00907682  0.0999384 ]
Stock Position:  -0.004991038433485612
Bond Position:  [6.40546768]


portfolio before change:  [5.87863187]
curr_Stock_Price:  106.19821015614114
curr_Factors:  [106.19821016  -1.5557194   -1.11260776]
mat_Sqrt:  [[ 7.3667755   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072262  0.00103249 -0.0966587 ]
Stock Position:  -0.0007226161196644578
Bond Position:  [5.95537241]


portfolio before change:  [5.88211784]
curr_Stock_Price:  105.49584262113511
curr_Factors:  [105.49584262  -1.14425712  -1.13853919]
mat_Sqrt:  [[10.76042702  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01964461 0.01181055 0.13827425]
Stock Position:  0.019644612802457963
Bond Position:  [3.80969286]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.86960466]
Stock Price:  104.76187536557555
PL:  [1.1077293]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-9.37755595e-01 -2.36643407e-01 -4.49701512e-02]
 [-6.51809869e-03  1.28687180e-01  1.48091078e-01]
 [-7.92891070e-02  2.95408014e-01  3.95760856e-01]
 [ 1.07863790e-01  2.79362461e-02  1.33331462e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 3.84427704e-02  1.47199442e-02 -4.49655233e-02]
 [-4.86959575e-02 -3.40046647e-02  4.41375850e-02]
 [ 5.20111373e-03  9.15456659e-03 -3.97756628e-02]
 [ 3.57963482e-01 -1.83303849e-02  1.16800610e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.83625812]
curr_Stock_Price:  99.81840879898172
curr_Factors:  [99.8184088  -0.93852327 -0.98573252]
mat_Sqrt:  [[14.5719265   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06829843 -0.07637633 -0.12828732]
Stock Position:  -0.06829843138844909
Bond Position:  [7.65369887]


portfolio before change:  [0.79189761]
curr_Stock_Price:  100.5239641271159
curr_Factors:  [100.52396413  -1.64844305  -0.97224951]
mat_Sqrt:  [[ 7.31336562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00683393 0.04153361 0.42246263]
Stock Position:  0.006833929724971032
Bond Position:  [0.1049239]


portfolio before change:  [0.79550616]
curr_Stock_Price:  101.04432060528491
curr_Factors:  [101.04432061  -1.66902761  -0.94473351]
mat_Sqrt:  [[ 7.40235442  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00834804 0.09534253 1.12899556]
Stock Position:  0.008348039605835179
Bond Position:  [-0.04801583]


portfolio before change:  [0.80520363]
curr_Stock_Price:  102.20884277208211
curr_Factors:  [102.20884277  -1.05934456  -0.97791431]
mat_Sqrt:  [[13.32656389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00872602 0.00901638 0.03803575]
Stock Position:  0.008726020502998859
Bond Position:  [-0.08667283]


portfolio before change:  [0.80560714]
curr_Stock_Price:  102.26005249702446
curr_Factors:  [102.2600525   -0.71129633  -1.01496353]
mat_Sqrt:  [[18.19704555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00320499 -0.00140152  0.08089603]
Stock Position:  0.003204987056955667
Bond Position:  [0.47786499]


portfolio before change:  [0.81075293]
curr_Stock_Price:  103.79104171643546
curr_Factors:  [103.79104172  -0.80607948  -1.02463203]
mat_Sqrt:  [[16.63764925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193951  0.00475084 -0.12827412]
Stock Position:  0.001939511825548492
Bond Position:  [0.60944898]


portfolio before change:  [0.81538845]
curr_Stock_Price:  106.02393402153255
curr_Factors:  [106.02393402  -1.02599531  -0.99970125]
mat_Sqrt:  [[13.98476192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00333417 -0.01097496  0.12591224]
Stock Position:  -0.0033341707248594576
Bond Position:  [1.16889035]


portfolio before change:  [0.8167087]
curr_Stock_Price:  105.8032926660299
curr_Factors:  [105.80329267  -0.90337711  -1.00490727]
mat_Sqrt:  [[15.6942949   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.68645113e-05  2.95462366e-03 -1.13468894e-01]
Stock Position:  -6.686451134693513e-05
Bond Position:  [0.82378318]


portfolio before change:  [0.81684714]
curr_Stock_Price:  109.89443141347233
curr_Factors:  [109.89443141  -1.1308604   -1.07178393]
mat_Sqrt:  [[12.14449358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03113046 -0.00591611  0.33319963]
Stock Position:  0.031130456761144048
Bond Position:  [-2.6042167]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.89283561]
Stock Price:  112.37723800555747
PL:  [-11.4844024]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-6.35799592e-01 -1.18412533e-01 -7.67500786e-02]
 [ 2.09371299e-02  6.67445347e-02 -1.76473554e-02]
 [-5.75850712e-02  2.80879048e-01  2.90831255e-01]
 [ 2.33819662e-01  1.81314069e-01  2.48376516e-01]
 [ 4.92166817e-02  2.27363753e-02  2.71463652e-02]
 [-1.07337997e-01 -6.22253053e-02  1.67179742e-02]
 [ 9.84435138e-02  2.89397165e-01  1.74787327e-01]
 [-3.88950086e-02 -1.17903928e-01  4.95799729e-02]
 [-5.21716113e-02 -1.22456148e-01 -1.07578303e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.34225639]
curr_Stock_Price:  98.70223997430332
curr_Factors:  [98.70223997 -1.36203096 -1.03608892]
mat_Sqrt:  [[ 8.97091571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07531416 -0.03821748 -0.21894661]
Stock Position:  -0.07531416134160586
Bond Position:  [0.09142003]


portfolio before change:  [-7.35561144]
curr_Stock_Price:  98.88017151845061
curr_Factors:  [98.88017152 -1.09029794 -1.0332657 ]
mat_Sqrt:  [[11.82652742  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00261776  0.02154171 -0.05034299]
Stock Position:  0.0026177633206901116
Bond Position:  [-7.61445632]


portfolio before change:  [-7.36562852]
curr_Stock_Price:  96.50833831243213
curr_Factors:  [96.50833831 -0.69387034 -1.07452063]
mat_Sqrt:  [[16.46502519  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00359033 0.09065332 0.82966062]
Stock Position:  0.003590325866703058
Bond Position:  [-7.7121249]


portfolio before change:  [-7.3723593]
curr_Stock_Price:  95.70792160247207
curr_Factors:  [95.7079216  -0.49464049 -1.07962135]
mat_Sqrt:  [[19.8268925   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01621686 0.05851886 0.70854907]
Stock Position:  0.016216857238988427
Bond Position:  [-8.924441]


portfolio before change:  [-7.32394736]
curr_Stock_Price:  98.96843492599184
curr_Factors:  [98.96843493 -0.99145641 -1.15752788]
mat_Sqrt:  [[11.53997016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00514724 0.00733813 0.07744102]
Stock Position:  0.0051472363165038105
Bond Position:  [-7.83336128]


portfolio before change:  [-7.33497646]
curr_Stock_Price:  97.58683000919592
curr_Factors:  [97.58683001 -0.47592853 -1.13013512]
mat_Sqrt:  [[19.583334    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00595543 -0.02008313  0.04769173]
Stock Position:  -0.005955428342431391
Bond Position:  [-6.75380509]


portfolio before change:  [-7.32021724]
curr_Stock_Price:  94.54137752317402
curr_Factors:  [94.54137752 -0.55703543 -1.14953657]
mat_Sqrt:  [[17.15801806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01125974 0.09340253 0.49861959]
Stock Position:  0.011259737335678558
Bond Position:  [-8.38472831]


portfolio before change:  [-7.3209991]
curr_Stock_Price:  94.84436419028702
curr_Factors:  [94.84436419 -0.85994222 -1.10229913]
mat_Sqrt:  [[13.32971726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00396419 -0.03805333  0.14143786]
Stock Position:  -0.003964193420452593
Bond Position:  [-6.94501769]


portfolio before change:  [-7.32432885]
curr_Stock_Price:  94.80813408453379
curr_Factors:  [94.80813408 -0.79926256 -1.1075167 ]
mat_Sqrt:  [[14.08451478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00703803 -0.03952255 -0.30689095]
Stock Position:  -0.0070380271120411494
Bond Position:  [-6.65706663]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.32814698]
Stock Price:  94.87757954040207
PL:  [-7.32814698]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.02714066e+00 -2.62543083e-01 -3.24545954e-02]
 [-8.92132109e-03  1.34741503e-01  1.52996949e-01]
 [-1.07345959e-01  4.94554148e-01  6.21759513e-01]
 [ 1.01112328e-01  2.41371121e-02  1.13136457e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 7.14573947e-02 -8.57056793e-03 -4.83063229e-02]
 [-2.98077625e-02 -5.26324559e-03 -2.80488421e-02]
 [ 3.83091951e-04  1.18844152e-04 -3.15613246e-02]
 [ 4.68730122e-01 -1.41831422e-02  1.30140203e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.8177565]
curr_Stock_Price:  99.95235951708158
curr_Factors:  [99.95235952 -0.77685861 -1.00302819]
mat_Sqrt:  [[16.85768882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06450213 -0.08473542 -0.09258393]
Stock Position:  -0.06450212817645046
Bond Position:  [8.26489641]


portfolio before change:  [1.7570688]
curr_Stock_Price:  100.95730592710284
curr_Factors:  [100.95730593  -0.92107755  -0.94373506]
mat_Sqrt:  [[15.64083471  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00318481 0.04348763 0.43645771]
Stock Position:  0.0031848072985222503
Bond Position:  [1.43553924]


portfolio before change:  [1.75863305]
curr_Stock_Price:  101.22303520371963
curr_Factors:  [101.2230352   -0.75380381  -0.89143679]
mat_Sqrt:  [[19.5326173   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00617022 0.15961666 1.77370683]
Stock Position:  0.0061702234261886545
Bond Position:  [1.13406431]


portfolio before change:  [1.750298]
curr_Stock_Price:  99.78026316106661
curr_Factors:  [99.78026316 -0.42761999 -0.95936481]
mat_Sqrt:  [[24.92784882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00434649 0.00779022 0.03227468]
Stock Position:  0.004346491544822875
Bond Position:  [1.31660393]


portfolio before change:  [1.7639831]
curr_Stock_Price:  102.77730973049079
curr_Factors:  [102.77730973  -0.80437229  -0.97197049]
mat_Sqrt:  [[17.39567869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00335263 -0.00140152  0.08089603]
Stock Position:  0.0033526312192588524
Bond Position:  [1.41940868]


portfolio before change:  [1.77733625]
curr_Stock_Price:  106.54845816461867
curr_Factors:  [106.54845816  -1.25142194  -1.01652852]
mat_Sqrt:  [[11.03033745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00542571 -0.00276614 -0.13780449]
Stock Position:  0.0054257132456717845
Bond Position:  [1.19923487]


portfolio before change:  [1.79148967]
curr_Stock_Price:  109.04649834160112
curr_Factors:  [109.04649834  -1.47353205  -1.0446008 ]
mat_Sqrt:  [[ 8.79023579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416457 -0.00169871 -0.08001554]
Stock Position:  -0.004164571328543327
Bond Position:  [2.24562159]


portfolio before change:  [1.79501476]
curr_Stock_Price:  108.4697290183249
curr_Factors:  [108.46972902  -1.69113355  -1.02262621]
mat_Sqrt:  [[ 7.19014528  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.39354040e-04  3.83567851e-05 -9.00356740e-02]
Stock Position:  -0.0008393540399173625
Bond Position:  [1.88605926]


portfolio before change:  [1.79526287]
curr_Stock_Price:  109.29793469064585
curr_Factors:  [109.29793469  -2.05296265  -0.98810773]
mat_Sqrt:  [[ 5.22266141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09428139 -0.00457759  0.37125377]
Stock Position:  0.09428138629470097
Bond Position:  [-8.50949794]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.80390625]
Stock Price:  109.43475062750758
PL:  [-7.63084438]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.58041110e+00 -3.33452376e-01 -1.43223017e-01]
 [-5.39670006e-02  1.96562680e-01  3.60598408e-01]
 [-1.27294755e-01  6.65698777e-01  6.78154248e-01]
 [ 1.15753687e-01  3.23759920e-02  1.56931759e-02]
 [ 2.91646831e-03 -6.17260304e-02 -5.34958004e-02]
 [ 2.83328188e-02  2.17311116e-02 -4.39972641e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 1.45624805e-02  2.22383849e-02 -5.27214247e-02]
 [ 1.42504695e-01  6.22370058e-02  2.03655952e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [27.40879107]
curr_Stock_Price:  103.44491490827113
curr_Factors:  [103.44491491  -1.10249716  -1.0416395 ]
mat_Sqrt:  [[12.12055273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.13841877 -0.10762129 -0.4085754 ]
Stock Position:  -0.13841877462380334
Bond Position:  [41.72750943]


portfolio before change:  [27.49248965]
curr_Stock_Price:  102.991005334451
curr_Factors:  [102.99100533  -0.77179189  -1.00139249]
mat_Sqrt:  [[17.48699176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00341757 0.06344033 1.02868689]
Stock Position:  0.003417570672858928
Bond Position:  [27.14051061]


portfolio before change:  [27.51278571]
curr_Stock_Price:  104.95801971914328
curr_Factors:  [104.95801972  -1.08781015  -1.0442303 ]
mat_Sqrt:  [[12.44750258  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01181105 0.21485336 1.93458531]
Stock Position:  0.01181105157270602
Bond Position:  [26.27312112]


portfolio before change:  [27.52253705]
curr_Stock_Price:  104.67112735967518
curr_Factors:  [104.67112736  -0.82559078  -1.05511316]
mat_Sqrt:  [[15.96053916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00786726 0.01044931 0.04476826]
Stock Position:  0.007867263367010999
Bond Position:  [26.69906173]


portfolio before change:  [27.54848994]
curr_Stock_Price:  106.2727025698447
curr_Factors:  [106.27270257  -0.68623758  -1.05534358]
mat_Sqrt:  [[18.62355733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110629 -0.01992199 -0.15260863]
Stock Position:  -0.0011062918353046966
Bond Position:  [27.66605856]


portfolio before change:  [27.56607157]
curr_Stock_Price:  102.8873883359804
curr_Factors:  [102.88738834  -0.7872654   -1.05220085]
mat_Sqrt:  [[16.34903427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00145499  0.00701369 -0.12551195]
Stock Position:  0.0014549947757963651
Bond Position:  [27.41637096]


portfolio before change:  [27.57825164]
curr_Stock_Price:  101.83477554068557
curr_Factors:  [101.83477554  -0.62562787  -1.05602075]
mat_Sqrt:  [[18.94808812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253319 -0.01197701  0.13962421]
Stock Position:  -0.0025331922015207242
Bond Position:  [27.8362187]


portfolio before change:  [27.58770269]
curr_Stock_Price:  103.59955976405297
curr_Factors:  [103.59955976  -1.21822378  -1.07279988]
mat_Sqrt:  [[10.48042705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079578  0.00717741 -0.15039955]
Stock Position:  0.0007957839883750285
Bond Position:  [27.50525982]


portfolio before change:  [27.60145403]
curr_Stock_Price:  103.5936144418629
curr_Factors:  [103.59361444  -1.28157818  -1.03472195]
mat_Sqrt:  [[10.21825231  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0155962  0.02008691 0.05809737]
Stock Position:  0.015596197461147474
Bond Position:  [25.98578756]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [27.61778208]
Stock Price:  103.80725054483348
PL:  [23.81053153]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-6.24556985e-01 -1.05042669e-01 -1.01033982e-01]
 [ 3.64906802e-03  1.05523593e-01  9.01332656e-02]
 [-7.32310485e-02  2.50506405e-01  3.46193204e-01]
 [ 1.06898388e-01  2.73930016e-02  1.30443745e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 1.12900078e-02  3.17084429e-02 -4.17638400e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-8.43871162e-03 -2.40233628e-02 -1.13996982e-02]
 [ 1.26648620e-01  9.63157086e-02 -8.46031700e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.81703654]
curr_Stock_Price:  99.18334696411065
curr_Factors:  [99.18334696 -1.7131728  -0.9843597 ]
mat_Sqrt:  [[ 6.68213558  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09976185 -0.03390238 -0.28822183]
Stock Position:  -0.09976184968969569
Bond Position:  [6.07767761]


portfolio before change:  [-3.87740088]
curr_Stock_Price:  99.81889992188479
curr_Factors:  [99.81889992 -1.71426651 -0.98573155]
mat_Sqrt:  [[ 6.70839336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00649744 0.03405759 0.25712512]
Stock Position:  0.006497436079772895
Bond Position:  [-4.5259678]


portfolio before change:  [-3.87189878]
curr_Stock_Price:  101.01408604024732
curr_Factors:  [101.01408604  -1.80195864  -0.99556692]
mat_Sqrt:  [[ 6.15789141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0078874  0.08085059 0.98759285]
Stock Position:  0.00788739942171629
Bond Position:  [-4.66863723]


portfolio before change:  [-3.86817054]
curr_Stock_Price:  101.7827990926861
curr_Factors:  [101.78279909  -1.31674038  -1.08075692]
mat_Sqrt:  [[ 9.2566649   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01243997 0.00884105 0.03721197]
Stock Position:  0.012439969873631341
Bond Position:  [-5.13434549]


portfolio before change:  [-3.86663505]
curr_Stock_Price:  102.11264771368185
curr_Factors:  [102.11264771  -1.12412154  -1.04018305]
mat_Sqrt:  [[11.72557097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00497386 -0.00140152  0.08089603]
Stock Position:  0.004973855481981524
Bond Position:  [-4.3745286]


portfolio before change:  [-3.87292877]
curr_Stock_Price:  101.28714886590183
curr_Factors:  [101.28714887  -1.28760011  -1.04511071]
mat_Sqrt:  [[ 9.82813045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009399   0.01023386 -0.11914061]
Stock Position:  0.0009398998656712986
Bond Position:  [-3.96812855]


portfolio before change:  [-3.87424263]
curr_Stock_Price:  102.00073631393994
curr_Factors:  [102.00073631  -1.24520976  -1.00494701]
mat_Sqrt:  [[10.7491133   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00446541 -0.01197701  0.13962421]
Stock Position:  -0.0044654054440354755
Bond Position:  [-3.41876799]


portfolio before change:  [-3.87222227]
curr_Stock_Price:  101.16538645090031
curr_Factors:  [101.16538645  -1.36451038  -0.94469052]
mat_Sqrt:  [[10.04983045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155917 -0.00775351 -0.03252017]
Stock Position:  -0.0015591719425430061
Bond Position:  [-3.71448803]


portfolio before change:  [-3.87399308]
curr_Stock_Price:  101.10965506318296
curr_Factors:  [101.10965506  -1.79974922  -0.85522058]
mat_Sqrt:  [[ 7.108106    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02034044  0.03108576 -0.02413493]
Stock Position:  0.020340443249685897
Bond Position:  [-5.93060828]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.86717169]
Stock Price:  101.59083599319601
PL:  [-5.45800769]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.82109631e-01 -2.14868823e-01 -6.46595790e-02]
 [ 1.64361536e-02  7.70839418e-02  6.72046460e-03]
 [-8.83478213e-02  3.73017985e-01  4.68822506e-01]
 [ 9.98965818e-02  2.40132402e-02  1.22866022e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 3.42940134e-02  1.76140481e-02 -4.44886440e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 4.98292060e-03  8.74062588e-03 -3.94004654e-02]
 [ 1.19593005e-01  2.40515345e-02  4.40350697e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.98900201]
curr_Stock_Price:  99.97573037459865
curr_Factors:  [99.97573037 -1.16575651 -0.99446598]
mat_Sqrt:  [[11.52714826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08147446 -0.06934861 -0.18445578]
Stock Position:  -0.08147445538985941
Bond Position:  [10.1344702]


portfolio before change:  [2.05349663]
curr_Stock_Price:  99.24634699004721
curr_Factors:  [99.24634699 -0.9484215  -0.99834252]
mat_Sqrt:  [[14.16594852  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00236784 0.02487874 0.01917161]
Stock Position:  0.00236783695380137
Bond Position:  [1.81849746]


portfolio before change:  [2.05721657]
curr_Stock_Price:  100.4332809251758
curr_Factors:  [100.43328093  -0.89194188  -1.04434608]
mat_Sqrt:  [[14.48633333  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00576351 0.12039104 1.33742012]
Stock Position:  0.005763511548657852
Bond Position:  [1.4783682]


portfolio before change:  [2.05229415]
curr_Stock_Price:  99.45093019948693
curr_Factors:  [99.4509302  -0.39843357 -1.04599619]
mat_Sqrt:  [[23.45853987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00457429 0.00775024 0.03505026]
Stock Position:  0.004574293909981247
Bond Position:  [1.59737637]


portfolio before change:  [2.06478783]
curr_Stock_Price:  102.00756439603975
curr_Factors:  [102.0075644   -0.83186064  -1.03872239]
mat_Sqrt:  [[15.71261584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00371175 -0.00140152  0.08089603]
Stock Position:  0.0037117495940182997
Bond Position:  [1.6861613]


portfolio before change:  [2.07113361]
curr_Stock_Price:  103.49001541388112
curr_Factors:  [103.49001541  -0.66219011  -1.01274352]
mat_Sqrt:  [[19.38581296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148605  0.00568491 -0.12691372]
Stock Position:  0.0014860485601553646
Bond Position:  [1.91734242]


portfolio before change:  [2.07510941]
curr_Stock_Price:  105.5201576755472
curr_Factors:  [105.52015768  -0.69143514  -1.01494879]
mat_Sqrt:  [[19.15412453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250594 -0.01197701  0.13962421]
Stock Position:  -0.002505943249190524
Bond Position:  [2.33953694]


portfolio before change:  [2.07458685]
curr_Stock_Price:  106.19560147582091
curr_Factors:  [106.19560148  -0.71267345  -1.02456695]
mat_Sqrt:  [[18.6910031   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.82410106e-05  2.82102487e-03 -1.12398561e-01]
Stock Position:  -6.824101064791254e-05
Bond Position:  [2.08183375]


portfolio before change:  [2.07562568]
curr_Stock_Price:  106.23003267632559
curr_Factors:  [106.23003268  -0.5227776   -1.04056791]
mat_Sqrt:  [[22.24820551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00600009 0.0077626  0.1256198 ]
Stock Position:  0.006000085028969548
Bond Position:  [1.43823645]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.07859484]
Stock Price:  106.60500441437496
PL:  [-4.52640958]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.03729873e+00 -2.78964856e-01 -2.65367709e-03]
 [ 6.56907663e-02  2.25462761e-02  2.07516706e-02]
 [-7.85046548e-02  4.41231689e-01  4.61058001e-01]
 [ 1.01334301e-01  3.32702664e-01  1.85691224e-01]
 [ 5.04842748e-02  3.02070016e-03  5.05343951e-02]
 [-1.05309363e-01 -5.97394398e-02  1.54340852e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-3.35589513e-03 -2.19155578e-02 -1.50611196e-02]
 [-7.15452648e-02  4.14596964e-02 -4.20381545e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.25195893]
curr_Stock_Price:  99.39694209041652
curr_Factors:  [99.39694209 -0.46691898 -0.94864417]
mat_Sqrt:  [[24.13246914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0453656  -0.09003552 -0.0075702 ]
Stock Position:  -0.04536559720962341
Bond Position:  [2.25724271]


portfolio before change:  [-2.13281847]
curr_Stock_Price:  96.79559739851801
curr_Factors:  [96.7955974  -0.4458264  -0.94705345]
mat_Sqrt:  [[24.04006151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0031002  0.00727678 0.05919874]
Stock Position:  0.0031001968379419215
Bond Position:  [-2.43290387]


portfolio before change:  [-2.13352609]
curr_Stock_Price:  96.95982310423481
curr_Factors:  [96.9598231  -0.26412371 -0.90827521]
mat_Sqrt:  [[30.02101915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00352002 0.14240692 1.31527014]
Stock Position:  0.003520015641633749
Bond Position:  [-2.47482618]


portfolio before change:  [-2.15402243]
curr_Stock_Price:  91.48864833030257
curr_Factors:  [91.48864833 -0.13794692 -0.89083328]
mat_Sqrt:  [[32.70194973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00633452 0.10737932 0.52972538]
Stock Position:  0.006334515592818797
Bond Position:  [-2.7335587]


portfolio before change:  [-2.12451545]
curr_Stock_Price:  96.36259705592062
curr_Factors:  [96.36259706 -0.47791914 -0.9206518 ]
mat_Sqrt:  [[23.79670642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00258087 0.00097493 0.14416056]
Stock Position:  0.0025808681978874847
Bond Position:  [-2.37321461]


portfolio before change:  [-2.12038902]
curr_Stock_Price:  98.42133484134861
curr_Factors:  [98.42133484 -0.55462645 -0.90627537]
mat_Sqrt:  [[22.83640046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00500749 -0.01928082  0.04402915]
Stock Position:  -0.00500749474301874
Bond Position:  [-1.62754471]


portfolio before change:  [-2.13899478]
curr_Stock_Price:  101.97436588455965
curr_Factors:  [101.97436588  -0.83530141  -0.8701935 ]
mat_Sqrt:  [[18.52695229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259077 -0.01197701  0.13962421]
Stock Position:  -0.0025907741488711555
Bond Position:  [-1.87480223]


portfolio before change:  [-2.1394806]
curr_Stock_Price:  101.79997171895405
curr_Factors:  [101.79997172  -0.6263766   -0.87012042]
mat_Sqrt:  [[22.79435241  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047835 -0.00707322 -0.04296518]
Stock Position:  -0.00047835216436850267
Bond Position:  [-2.09078437]


portfolio before change:  [-2.13902133]
curr_Stock_Price:  98.65390001764261
curr_Factors:  [98.65390002 -0.36334582 -0.8417943 ]
mat_Sqrt:  [[29.56164196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0024242   0.01338106 -0.11992315]
Stock Position:  -0.0024242003243679306
Bond Position:  [-1.89986451]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.12504405]
Stock Price:  92.49621925815461
PL:  [-2.12504405]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.30882547e+00 -3.07512354e-01 -7.01795081e-02]
 [-1.50740156e-02  1.48641326e-01  1.89857487e-01]
 [-7.70317608e-02  3.38578737e-01  4.03073629e-01]
 [ 1.02723446e-01  2.50437088e-02  1.17955641e-02]
 [ 4.95436081e-02  2.06030303e-02  2.72940620e-02]
 [-1.57442622e-02  3.95569273e-02 -3.26788399e-02]
 [-5.04599145e-02 -1.62676394e-02  5.09484187e-02]
 [-2.80315544e-02 -7.38762403e-02  3.08400454e-02]
 [-5.07475255e-03  9.69435611e-02 -3.54914957e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.23299629]
curr_Stock_Price:  101.78321429959321
curr_Factors:  [101.7832143   -1.11333412  -0.98734969]
mat_Sqrt:  [[12.45548878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11126994 -0.09924919 -0.2002026 ]
Stock Position:  -0.11126994080623885
Bond Position:  [26.55840852]


portfolio before change:  [15.29685351]
curr_Stock_Price:  101.32869175577174
curr_Factors:  [101.32869176  -1.0265641   -0.9465391 ]
mat_Sqrt:  [[14.08719751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00383481 0.04797378 0.54161056]
Stock Position:  0.003834812794983437
Bond Position:  [14.90827694]


portfolio before change:  [15.29693919]
curr_Stock_Price:  99.40674181893087
curr_Factors:  [99.40674182 -0.96906383 -0.96695507]
mat_Sqrt:  [[14.3421253   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00518455 0.10927582 1.14985687]
Stock Position:  0.005184545042016806
Bond Position:  [14.78156046]


portfolio before change:  [15.30767484]
curr_Stock_Price:  100.05154698653119
curr_Factors:  [100.05154699  -0.82927578  -0.99791388]
mat_Sqrt:  [[16.09479387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00684962 0.00808282 0.03364946]
Stock Position:  0.006849620594278913
Bond Position:  [14.6223597]


portfolio before change:  [15.30729038]
curr_Stock_Price:  98.92776606980458
curr_Factors:  [98.92776607 -1.06722025 -0.97711901]
mat_Sqrt:  [[12.80775295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00463161 0.0066496  0.07786236]
Stock Position:  0.004631613468955047
Bond Position:  [14.8490952]


portfolio before change:  [15.31732965]
curr_Stock_Price:  99.49190528999576
curr_Factors:  [99.49190529 -1.44206379 -0.96329281]
mat_Sqrt:  [[ 8.97748425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00159736  0.01276694 -0.09322363]
Stock Position:  -0.0015973604763295582
Bond Position:  [15.47625409]


portfolio before change:  [15.32526268]
curr_Stock_Price:  99.37110379421063
curr_Factors:  [99.37110379 -1.27050291 -0.91563883]
mat_Sqrt:  [[11.16428259  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00388567 -0.00525036  0.14534166]
Stock Position:  -0.0038856710919172527
Bond Position:  [15.71138611]


portfolio before change:  [15.33150142]
curr_Stock_Price:  99.78774072521674
curr_Factors:  [99.78774073 -0.91895984 -1.02190637]
mat_Sqrt:  [[14.32747659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00256963 -0.02384345  0.08797807]
Stock Position:  -0.0025696277148156204
Bond Position:  [15.58791877]


portfolio before change:  [15.33729673]
curr_Stock_Price:  100.56629688411489
curr_Factors:  [100.56629688  -0.98952166  -1.00441979]
mat_Sqrt:  [[13.69287655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00054547  0.0312884  -0.10124736]
Stock Position:  0.0005454732444373231
Bond Position:  [15.28244051]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.34450886]
Stock Price:  99.77615588363834
PL:  [15.34450886]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.10646158e+00 -2.79639794e-01 -3.37428443e-02]
 [ 3.08352659e-02  5.80029080e-02 -1.05512629e-02]
 [-7.51762071e-02  3.97090568e-01  4.24595036e-01]
 [ 2.42736534e-01  2.04817319e-01  2.95576028e-01]
 [ 5.27620208e-02 -2.42201979e-02  7.62398706e-02]
 [-6.89068518e-02 -2.64107680e-02 -2.14447018e-03]
 [ 1.34646690e-01  3.44172276e-01  1.89926516e-01]
 [-3.99278828e-02 -1.21851202e-01  2.74847130e-02]
 [ 7.14902830e-02 -1.98580437e-01 -1.65429213e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.53853231]
curr_Stock_Price:  100.32367941018543
curr_Factors:  [100.32367941  -0.77028743  -1.03393294]
mat_Sqrt:  [[16.513552    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07087697 -0.09025336 -0.09625894]
Stock Position:  -0.07087697062469273
Bond Position:  [11.64917079]


portfolio before change:  [4.69810086]
curr_Stock_Price:  98.15453336428426
curr_Factors:  [98.15453336 -0.76231661 -0.9752923 ]
mat_Sqrt:  [[17.2693663   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234643  0.01872036 -0.03009982]
Stock Position:  0.0023464261338707604
Bond Position:  [4.46778849]


portfolio before change:  [4.6998485]
curr_Stock_Price:  97.94706673356123
curr_Factors:  [97.94706673 -0.48742985 -0.99547656]
mat_Sqrt:  [[22.23173521  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00416295 0.12816043 1.21125145]
Stock Position:  0.004162952803397596
Bond Position:  [4.29209949]


portfolio before change:  [4.68881242]
curr_Stock_Price:  94.780404096964
curr_Factors:  [94.7804041  -0.85486345 -0.9957103 ]
mat_Sqrt:  [[14.89445416  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02315485 0.06610451 0.84319613]
Stock Position:  0.02315485311317195
Bond Position:  [2.49418609]


portfolio before change:  [4.69451623]
curr_Stock_Price:  94.97286475436209
curr_Factors:  [94.97286475 -0.67805795 -1.01443997]
mat_Sqrt:  [[17.48062797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00362576 -0.00781704  0.21749113]
Stock Position:  0.003625756018907002
Bond Position:  [4.35016779]


portfolio before change:  [4.6960109]
curr_Stock_Price:  94.78505418446176
curr_Factors:  [94.78505418 -0.71806713 -1.01925838]
mat_Sqrt:  [[16.68126485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448022 -0.00852404 -0.00611758]
Stock Position:  -0.004480215746548832
Bond Position:  [5.12066839]


portfolio before change:  [4.70641497]
curr_Stock_Price:  93.03444669755349
curr_Factors:  [93.0344467  -0.92419461 -1.05528621]
mat_Sqrt:  [[12.85186587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01895983 0.11108112 0.54180749]
Stock Position:  0.018959826663779815
Bond Position:  [2.94249799]


portfolio before change:  [4.69169434]
curr_Stock_Price:  92.18041735996381
curr_Factors:  [92.18041736 -1.38877753 -1.11596669]
mat_Sqrt:  [[ 7.53081667  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00785975 -0.03932731  0.07840624]
Stock Position:  -0.00785975336431754
Bond Position:  [5.41620969]


portfolio before change:  [4.68749806]
curr_Stock_Price:  93.05895175460459
curr_Factors:  [93.05895175 -1.49694496 -1.04309355]
mat_Sqrt:  [[ 7.33894183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.83280827e-04 -6.40915606e-02 -4.71923498e-01]
Stock Position:  -0.000383280827315427
Bond Position:  [4.72316577]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.68960437]
Stock Price:  93.72650731081093
PL:  [4.68960437]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.11265059e-01 -1.95820863e-01 -3.97020715e-02]
 [-1.55444444e-02  1.49879606e-01  1.90010731e-01]
 [-7.59780632e-02  3.40015164e-01  3.99289175e-01]
 [ 1.05962812e-01  3.01455261e-02  2.05874117e-02]
 [ 5.02336877e-02  1.61833916e-02  2.74394542e-02]
 [-6.16230167e-02 -1.89967294e-02 -6.53991376e-03]
 [-5.04865235e-02 -3.94333221e-03  5.21335612e-02]
 [-3.83207435e-02 -1.10469475e-01  6.15390903e-02]
 [ 1.49422362e-02 -1.11873236e-02 -8.39247922e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.36250952]
curr_Stock_Price:  98.97242739509507
curr_Factors:  [98.9724274  -0.91528909 -0.97956004]
mat_Sqrt:  [[14.87961528  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0577529  -0.06320091 -0.11325896]
Stock Position:  -0.05775290294502745
Bond Position:  [0.35343548]


portfolio before change:  [-5.50359226]
curr_Stock_Price:  101.41835640566207
curr_Factors:  [101.41835641  -0.83071474  -1.04373798]
mat_Sqrt:  [[15.56152278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00345952 0.04837343 0.54204773]
Stock Position:  0.003459518771338011
Bond Position:  [-5.85445097]


portfolio before change:  [-5.51424902]
curr_Stock_Price:  99.18428622095992
curr_Factors:  [99.18428622 -0.80240315 -1.03033282]
mat_Sqrt:  [[15.86703417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00472248 0.10973942 1.13906088]
Stock Position:  0.004722483255963063
Bond Position:  [-5.98264515]


portfolio before change:  [-5.51764571]
curr_Stock_Price:  99.09860813296199
curr_Factors:  [99.09860813 -1.02790771 -1.04954876]
mat_Sqrt:  [[12.4119401   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00937151 0.00972943 0.05873016]
Stock Position:  0.009371510694952383
Bond Position:  [-6.44634937]


portfolio before change:  [-5.50740595]
curr_Stock_Price:  100.53527438684122
curr_Factors:  [100.53527439  -0.81191741  -1.07415907]
mat_Sqrt:  [[15.24775353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00387848 0.00522317 0.07827713]
Stock Position:  0.0038784837175570627
Bond Position:  [-5.89733038]


portfolio before change:  [-5.51349798]
curr_Stock_Price:  99.72500302813233
curr_Factors:  [99.72500303 -0.56049314 -1.0674702 ]
mat_Sqrt:  [[19.57891233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00341366 -0.00613117 -0.01865655]
Stock Position:  -0.0034136555185205336
Bond Position:  [-5.17307117]


portfolio before change:  [-5.51521127]
curr_Stock_Price:  99.46900335404254
curr_Factors:  [99.46900335 -0.59641183 -1.02750128]
mat_Sqrt:  [[19.6079081   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207313 -0.0012727   0.14872254]
Stock Position:  -0.0020731295735750797
Bond Position:  [-5.30899914]


portfolio before change:  [-5.51247032]
curr_Stock_Price:  96.86611950568174
curr_Factors:  [96.86611951 -0.7782796  -1.02301006]
mat_Sqrt:  [[15.99122527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302095 -0.03565387  0.1755539 ]
Stock Position:  -0.0030209452683904567
Bond Position:  [-5.21984307]


portfolio before change:  [-5.51422358]
curr_Stock_Price:  96.58232938583004
curr_Factors:  [96.58232939 -1.09037144 -0.96840673]
mat_Sqrt:  [[12.32485091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036288 -0.00361069 -0.23941407]
Stock Position:  -0.000362880100746653
Bond Position:  [-5.47917577]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.51712462]
Stock Price:  97.02536673062254
PL:  [-5.51712462]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.37183489e-01 -2.07471466e-01 -3.61028394e-02]
 [ 2.21153654e-02  6.47315275e-02 -3.45577061e-02]
 [-5.38166681e-02  2.87918778e-01  2.78254570e-01]
 [ 2.37246719e-01  1.67061450e-01  2.10265953e-01]
 [ 5.61223811e-02 -4.24009947e-02  7.02876003e-02]
 [-1.07337997e-01 -6.22253053e-02  1.67179742e-02]
 [ 1.07998119e-01  2.77889770e-01  1.41965264e-01]
 [-3.94459869e-02 -1.08071577e-01  3.77611237e-02]
 [-6.52579535e-02 -4.97212036e-02 -7.81207246e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.72644403]
curr_Stock_Price:  99.05923490388183
curr_Factors:  [99.0592349  -0.8548204  -0.98436764]
mat_Sqrt:  [[15.74511184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05632878 -0.06696113 -0.10299135]
Stock Position:  -0.0563287765240993
Bond Position:  [0.85344148]


portfolio before change:  [-4.65072313]
curr_Stock_Price:  97.72254567328328
curr_Factors:  [97.72254567 -1.01509619 -0.98747247]
mat_Sqrt:  [[13.19138057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00214341  0.02089201 -0.09858352]
Stock Position:  0.0021434125676879846
Bond Position:  [-4.86018286]


portfolio before change:  [-4.65734889]
curr_Stock_Price:  95.76535796972097
curr_Factors:  [95.76535797 -0.77473364 -0.99490796]
mat_Sqrt:  [[16.3178469   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00378438 0.09292539 0.79378284]
Stock Position:  0.0037843830060919005
Bond Position:  [-5.01976168]


portfolio before change:  [-4.65856123]
curr_Stock_Price:  96.10839256682937
curr_Factors:  [96.10839257 -0.35471673 -0.96901427]
mat_Sqrt:  [[25.57833341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01228651 0.05391885 0.59983024]
Stock Position:  0.012286506222563687
Bond Position:  [-5.83939759]


portfolio before change:  [-4.67297275]
curr_Stock_Price:  95.17313097099732
curr_Factors:  [95.17313097 -0.29544266 -0.90726509]
mat_Sqrt:  [[28.58808171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00216225 -0.01368486  0.20051096]
Stock Position:  0.0021622545796637703
Bond Position:  [-4.87876129]


portfolio before change:  [-4.67335187]
curr_Stock_Price:  96.12624357128283
curr_Factors:  [96.12624357 -0.45510391 -0.92791228]
mat_Sqrt:  [[24.11046985  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0048372  -0.02008313  0.04769173]
Stock Position:  -0.004837199070613147
Bond Position:  [-4.20837009]


portfolio before change:  [-4.66085664]
curr_Stock_Price:  93.10798080983159
curr_Factors:  [93.10798081 -1.32349584 -0.89430055]
mat_Sqrt:  [[10.13468303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01911265 0.08968854 0.40498738]
Stock Position:  0.01911265189815801
Bond Position:  [-6.44039707]


portfolio before change:  [-4.63105698]
curr_Stock_Price:  94.83566736667247
curr_Factors:  [94.83566737 -1.43466555 -0.92388745]
mat_Sqrt:  [[ 8.96737132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00599931 -0.03487995  0.10772198]
Stock Position:  -0.005999310838692706
Bond Position:  [-4.06210833]


portfolio before change:  [-4.64082222]
curr_Stock_Price:  96.12476247175158
curr_Factors:  [96.12476247 -0.60431354 -0.96251317]
mat_Sqrt:  [[20.06185497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045536  -0.01604745 -0.22285668]
Stock Position:  -0.004553595761407064
Bond Position:  [-4.20310891]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.64413252]
Stock Price:  96.39009588771903
PL:  [-4.64413252]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.26734305e+00 -3.09976090e-01 -4.54931982e-02]
 [-4.57523902e-02  1.88180504e-01  3.29022282e-01]
 [-1.29274459e-01  6.81957004e-01  6.98603523e-01]
 [ 1.31992950e-01  4.15140327e-02  2.05506718e-02]
 [-3.67477221e-02 -1.06794322e-01 -1.17782261e-01]
 [ 8.26304579e-02 -1.70670840e-02 -4.89073798e-02]
 [-3.82573776e-02 -1.51506779e-02  1.49487781e-02]
 [-4.76235856e-04 -9.78276117e-05 -3.10364576e-02]
 [ 2.39550562e-01 -7.57195363e-03  9.17813984e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.1756859]
curr_Stock_Price:  101.22948986053497
curr_Factors:  [101.22948986  -0.92801605  -0.98016507]
mat_Sqrt:  [[15.01739203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08922341 -0.10004435 -0.12977943]
Stock Position:  -0.08922340897970459
Bond Position:  [20.20772608]


portfolio before change:  [11.06089685]
curr_Stock_Price:  102.62929557838835
curr_Factors:  [102.62929558  -0.9945171   -0.95771343]
mat_Sqrt:  [[14.56895498  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00410607 0.060735   0.93860899]
Stock Position:  0.004106072564538594
Bond Position:  [10.63949352]


portfolio before change:  [11.07540918]
curr_Stock_Price:  104.86774921672952
curr_Factors:  [104.86774922  -1.08772207  -0.98226504]
mat_Sqrt:  [[13.23298953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01152659 0.22010068 1.9929214 ]
Stock Position:  0.011526592512091456
Bond Position:  [9.86664137]


portfolio before change:  [11.11506569]
curr_Stock_Price:  107.88008425263891
curr_Factors:  [107.88008425  -0.83654545  -1.01965096]
mat_Sqrt:  [[16.85797547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00858121 0.0133986  0.05862535]
Stock Position:  0.008581211580391282
Bond Position:  [10.18932387]


portfolio before change:  [11.12397648]
curr_Stock_Price:  108.32464302417101
curr_Factors:  [108.32464302  -0.71797164  -0.96990507]
mat_Sqrt:  [[20.03049695  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00412317 -0.03446772 -0.33600001]
Stock Position:  -0.004123174048015332
Bond Position:  [11.57061784]


portfolio before change:  [11.13162988]
curr_Stock_Price:  107.87192300375378
curr_Factors:  [107.871923    -0.65378453  -0.9199179 ]
mat_Sqrt:  [[22.35929661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00309328 -0.00550838 -0.13951914]
Stock Position:  0.0030932760592844335
Bond Position:  [10.79795225]


portfolio before change:  [11.13738986]
curr_Stock_Price:  107.98819298580048
curr_Factors:  [107.98819299  -0.95074931  -0.93114889]
mat_Sqrt:  [[16.44668108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00232865 -0.00488986  0.0426447 ]
Stock Position:  -0.0023286516015716342
Bond Position:  [11.38885674]


portfolio before change:  [11.14357216]
curr_Stock_Price:  107.77929956930828
curr_Factors:  [107.77929957  -0.61465971  -0.88774683]
mat_Sqrt:  [[23.99100736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.84752328e-04 -3.15737259e-05 -8.85383746e-02]
Stock Position:  -0.00028475232845389693
Bond Position:  [11.17426256]


portfolio before change:  [11.14852187]
curr_Stock_Price:  110.02270912989096
curr_Factors:  [110.02270913  -0.23824271  -0.85935634]
mat_Sqrt:  [[36.71141512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00699346 -0.00244384  0.26182678]
Stock Position:  0.006993458099811303
Bond Position:  [10.37908266]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.14363886]
Stock Price:  108.58224237753046
PL:  [2.56139649]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.39381894e+00 -3.27166925e-01 -6.87486272e-02]
 [-2.38760367e-02  1.69268822e-01  2.31316178e-01]
 [-1.14920708e-01  5.36610254e-01  6.77572091e-01]
 [ 1.06369210e-01  2.70952268e-02  1.28860867e-02]
 [ 4.54169437e-02 -1.34350199e-02  1.53876210e-02]
 [ 3.88942756e-02  1.45038513e-02 -4.50352497e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-3.84176257e-02 -1.02451865e-01  5.86215895e-02]
 [-8.66897585e-02  3.25908853e-02 -3.91091037e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.40597249]
curr_Stock_Price:  101.39739413381932
curr_Factors:  [101.39739413  -0.44739471  -1.05872834]
mat_Sqrt:  [[22.48670718  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06557807 -0.10559267 -0.1961207 ]
Stock Position:  -0.06557807007540636
Bond Position:  [19.05541791]


portfolio before change:  [12.36461511]
curr_Stock_Price:  102.17337714003664
curr_Factors:  [102.17337714  -0.28213186  -1.07071964]
mat_Sqrt:  [[26.41203135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00219192 0.05463128 0.65988067]
Stock Position:  0.0021919190202919405
Bond Position:  [12.14065934]


portfolio before change:  [12.3688552]
curr_Stock_Price:  101.3376869504386
curr_Factors:  [101.33768695  -0.10833075  -1.12241144]
mat_Sqrt:  [[29.59827799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00449091 0.17319021 1.93292458]
Stock Position:  0.004490910778994528
Bond Position:  [11.91375669]


portfolio before change:  [12.37522056]
curr_Stock_Price:  101.42831363719677
curr_Factors:  [101.42831364  -0.43645672  -1.10121753]
mat_Sqrt:  [[21.79494444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0052549  0.00874495 0.03676042]
Stock Position:  0.005254904964839579
Bond Position:  [11.84222441]


portfolio before change:  [12.39498302]
curr_Stock_Price:  104.06201761068849
curr_Factors:  [104.06201761  -0.77813536  -1.08386657]
mat_Sqrt:  [[16.16720992  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00283385 -0.00433613  0.0438966 ]
Stock Position:  0.002833854260903282
Bond Position:  [12.10008642]


portfolio before change:  [12.40034494]
curr_Stock_Price:  103.81866392341767
curr_Factors:  [103.81866392  -0.8299253   -1.02257172]
mat_Sqrt:  [[16.28344163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00200585  0.0046811  -0.12847303]
Stock Position:  0.002005846227105186
Bond Position:  [12.19210067]


portfolio before change:  [12.40211499]
curr_Stock_Price:  101.66120723626433
curr_Factors:  [101.66120724  -0.48694248  -0.99651864]
mat_Sqrt:  [[23.06196383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208131 -0.01197701  0.13962421]
Stock Position:  -0.0020813123029842684
Bond Position:  [12.61370371]


portfolio before change:  [12.41531143]
curr_Stock_Price:  98.35175347143897
curr_Factors:  [98.35175347 -0.70826431 -1.04651497]
mat_Sqrt:  [[17.00948446  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00278459 -0.0330662   0.16723108]
Stock Position:  -0.0027845901674552168
Bond Position:  [12.68918075]


portfolio before change:  [12.4172745]
curr_Stock_Price:  99.9258105137378
curr_Factors:  [99.92581051 -0.22549832 -1.06225388]
mat_Sqrt:  [[27.56855508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319278  0.01051866 -0.11156739]
Stock Position:  -0.0031927782932128293
Bond Position:  [12.73631546]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.42861337]
Stock Price:  98.36944773207492
PL:  [12.42861337]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.65515424e+00 -3.47879158e-01 -1.47980953e-01]
 [-1.31853332e-01  2.39558460e-01  6.50535537e-01]
 [-1.19559041e-01  5.92600592e-01  6.75560797e-01]
 [ 1.07709906e-01  2.78496535e-02  1.32871163e-02]
 [ 4.81606466e-02  2.95408398e-02  2.68420285e-02]
 [ 4.05644649e-02  1.27397419e-02 -4.50115310e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-3.85497015e-02 -9.90694466e-02  5.54700257e-02]
 [-8.63148123e-02 -5.86628156e-02 -7.61727000e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [26.84280522]
curr_Stock_Price:  103.36767157018723
curr_Factors:  [103.36767157  -0.81018584  -0.98594198]
mat_Sqrt:  [[17.15285171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10239529 -0.11227752 -0.42214847]
Stock Position:  -0.10239529199688586
Bond Position:  [37.42716813]


portfolio before change:  [26.66457779]
curr_Stock_Price:  105.29105773973983
curr_Factors:  [105.29105774  -1.21807425  -0.98303303]
mat_Sqrt:  [[11.65367071  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00427645 0.07731716 1.85579681]
Stock Position:  0.004276450360085534
Bond Position:  [26.21430581]


portfolio before change:  [26.66721805]
curr_Stock_Price:  102.84272358637097
curr_Factors:  [102.84272359  -0.7278701   -0.97829022]
mat_Sqrt:  [[18.67228887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00746043 0.19126102 1.92718691]
Stock Position:  0.007460430765274757
Bond Position:  [25.89996703]


portfolio before change:  [26.67443138]
curr_Stock_Price:  102.07334637778781
curr_Factors:  [102.07334638  -0.52204664  -0.97256093]
mat_Sqrt:  [[22.89878991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00507044 0.00898844 0.03790444]
Stock Position:  0.005070438860370847
Bond Position:  [26.15687472]


portfolio before change:  [26.67600662]
curr_Stock_Price:  99.80402263527077
curr_Factors:  [99.80402264 -0.50075636 -1.00807125]
mat_Sqrt:  [[22.07356812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00270322 0.00953427 0.07657284]
Stock Position:  0.002703221839785219
Bond Position:  [26.40621421]


portfolio before change:  [26.70072633]
curr_Stock_Price:  104.06312606855266
curr_Factors:  [104.06312607  -0.65890268  -1.01818263]
mat_Sqrt:  [[19.45127041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00174678  0.00411173 -0.12840537]
Stock Position:  0.0017467760644452716
Bond Position:  [26.51895135]


portfolio before change:  [26.71212422]
curr_Stock_Price:  102.99550350355014
curr_Factors:  [102.9955035   -0.4592833   -0.98941015]
mat_Sqrt:  [[24.19127133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198415 -0.01197701  0.13962421]
Stock Position:  -0.0019841515731106488
Bond Position:  [26.91648292]


portfolio before change:  [26.73309755]
curr_Stock_Price:  99.209642184373
curr_Factors:  [99.20964218 -0.23657493 -0.95426651]
mat_Sqrt:  [[30.15629749  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00157345 -0.03197453  0.15824054]
Stock Position:  -0.001573448995786252
Bond Position:  [26.88919887]


portfolio before change:  [26.75155176]
curr_Stock_Price:  96.02794228269735
curr_Factors:  [96.02794228 -0.48455545 -0.97109941]
mat_Sqrt:  [[22.39828398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508244 -0.01893334 -0.21729951]
Stock Position:  -0.005082442777675515
Bond Position:  [27.23960828]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [26.7686687]
Stock Price:  95.34052956391317
PL:  [26.7686687]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.48876030e+00 -3.39683538e-01 -8.70226341e-02]
 [ 5.99853514e-02  2.61148450e-02 -2.99269969e-03]
 [-5.18497226e-02  3.04920369e-01  2.78399993e-01]
 [ 2.58633028e-01  2.27512732e-01  3.33327792e-01]
 [ 5.23288993e-02 -1.94725055e-02  7.22136589e-02]
 [-6.29585625e-02 -2.08674716e-02 -5.06395841e-03]
 [ 1.83683123e-01  4.56344368e-01  2.58548052e-01]
 [-4.31870330e-02 -1.39403838e-01 -3.28691860e-02]
 [ 4.09670880e-02 -4.40443453e-01 -1.68309919e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.26740235]
curr_Stock_Price:  101.78790989282014
curr_Factors:  [101.78790989  -0.36324726  -1.03443409]
mat_Sqrt:  [[25.15885649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06263644 -0.10963239 -0.24825135]
Stock Position:  -0.06263644489467404
Bond Position:  [21.64303516]


portfolio before change:  [15.63209581]
curr_Stock_Price:  96.13833586732987
curr_Factors:  [96.13833587 -0.63502489 -0.96965968]
mat_Sqrt:  [[19.31928035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00334925  0.00842853 -0.00853734]
Stock Position:  0.003349252059263107
Bond Position:  [15.31010429]


portfolio before change:  [15.63638666]
curr_Stock_Price:  95.13330108321729
curr_Factors:  [95.13330108 -0.72889112 -0.96513759]
mat_Sqrt:  [[17.48337393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0038448  0.09841263 0.79419769]
Stock Position:  0.003844798381434172
Bond Position:  [15.2706183]


portfolio before change:  [15.64071166]
curr_Stock_Price:  94.27182139593756
curr_Factors:  [94.2718214  -0.71378776 -1.01502873]
mat_Sqrt:  [[16.73271582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02229848 0.07342942 0.95089141]
Stock Position:  0.022298479465269038
Bond Position:  [13.53859339]


portfolio before change:  [15.66925557]
curr_Stock_Price:  95.2482520829432
curr_Factors:  [95.24825208 -0.69600533 -0.99337075]
mat_Sqrt:  [[17.58613092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00358775 -0.00628472  0.20600547]
Stock Position:  0.0035877500542101626
Bond Position:  [15.32752865]


portfolio before change:  [15.66637121]
curr_Stock_Price:  92.30767975343733
curr_Factors:  [92.30767975 -0.40578665 -0.97706517]
mat_Sqrt:  [[23.15650006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294741 -0.00673495 -0.01444606]
Stock Position:  -0.0029474140435653677
Bond Position:  [15.93844016]


portfolio before change:  [15.67387492]
curr_Stock_Price:  92.46629643161909
curr_Factors:  [ 9.24662964e+01 -3.51217690e-02 -9.74364671e-01]
mat_Sqrt:  [[33.69528023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00978208 0.14728451 0.73756563]
Stock Position:  0.009782080015897183
Bond Position:  [14.76936221]


portfolio before change:  [15.61363065]
curr_Stock_Price:  85.55255315190652
curr_Factors:  [85.55255315 -0.41192024 -0.943504  ]
mat_Sqrt:  [[22.05868957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355198 -0.0449924  -0.09376664]
Stock Position:  -0.0035519841987444165
Bond Position:  [15.91751197]


portfolio before change:  [15.61269625]
curr_Stock_Price:  88.05683043188012
curr_Factors:  [88.05683043 -0.46623593 -0.96675836]
mat_Sqrt:  [[21.00978144  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00396454 -0.14215251 -0.48014135]
Stock Position:  -0.003964542604043737
Bond Position:  [15.9618013]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.6146586]
Stock Price:  89.57542784132703
PL:  [15.6146586]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-9.37919285e-01 -2.30143161e-01 -5.87332492e-02]
 [ 9.68674412e-03  9.19969402e-02  5.22409968e-02]
 [-7.64345759e-02  3.37351015e-01  3.99900774e-01]
 [ 1.05716297e-01  2.67278243e-02  1.26907871e-02]
 [ 4.98173922e-02  1.88657528e-02  2.73194828e-02]
 [-9.25508859e-02 -4.41053494e-02  7.35945848e-03]
 [-4.42259209e-02  1.29403260e-02  5.06832854e-02]
 [-3.91949321e-02 -1.09392480e-01  4.52552105e-02]
 [ 7.60234435e-02  9.63928123e-02 -6.65479381e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.90612978]
curr_Stock_Price:  100.10089606564327
curr_Factors:  [100.10089607  -1.0947911   -0.99898276]
mat_Sqrt:  [[12.3345563   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08082058 -0.07427839 -0.16754961]
Stock Position:  -0.08082057521018908
Bond Position:  [10.99634178]


portfolio before change:  [2.96018253]
curr_Stock_Price:  99.50014299646374
curr_Factors:  [99.500143   -1.47538716 -1.01281522]
mat_Sqrt:  [[ 8.26439642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00473467 0.02969188 0.14902902]
Stock Position:  0.004734669991823786
Bond Position:  [2.48908219]


portfolio before change:  [2.96068476]
curr_Stock_Price:  99.3432955645344
curr_Factors:  [99.34329556 -0.97818488 -0.95744905]
mat_Sqrt:  [[14.33849038  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00516486 0.10887957 1.1408056 ]
Stock Position:  0.005164861379149387
Bond Position:  [2.44759041]


portfolio before change:  [2.97199303]
curr_Stock_Price:  101.29575207590081
curr_Factors:  [101.29575208  -0.83548185  -0.97661328]
mat_Sqrt:  [[16.54277328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00687688 0.00862637 0.03620328]
Stock Position:  0.006876875227705848
Bond Position:  [2.27539478]


portfolio before change:  [2.96931097]
curr_Stock_Price:  100.74026084280356
curr_Factors:  [100.74026084  -0.68298959  -0.98903943]
mat_Sqrt:  [[18.92561919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00313041 0.0060889  0.07793488]
Stock Position:  0.003130408224813556
Bond Position:  [2.65395283]


portfolio before change:  [2.9647863]
curr_Stock_Price:  98.87086189431386
curr_Factors:  [98.87086189 -0.90000969 -0.92606702]
mat_Sqrt:  [[15.92257414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00628363 -0.01423494  0.02099449]
Stock Position:  -0.0062836328199664376
Bond Position:  [3.58605449]


portfolio before change:  [2.96710778]
curr_Stock_Price:  98.78683348378188
curr_Factors:  [98.78683348 -0.83043856 -0.87997708]
mat_Sqrt:  [[17.85973425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174912  0.00417647  0.14458531]
Stock Position:  -0.0017491192828136897
Bond Position:  [3.13989773]


portfolio before change:  [2.97398557]
curr_Stock_Price:  95.75247403485821
curr_Factors:  [95.75247403 -0.67955469 -0.88927525]
mat_Sqrt:  [[19.94416308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262166 -0.03530627  0.12910052]
Stock Position:  -0.002621664155122489
Bond Position:  [3.2250164]


portfolio before change:  [2.97124956]
curr_Stock_Price:  97.41131682202918
curr_Factors:  [97.41131682 -1.42946653 -0.90206356]
mat_Sqrt:  [[ 9.4632162   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00867734  0.03111065 -0.18984274]
Stock Position:  0.008677335616707029
Bond Position:  [2.12597887]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.96659518]
Stock Price:  96.75240159348645
PL:  [2.96659518]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.79557425e-01 -2.28446481e-01 -3.31420461e-02]
 [ 1.01112719e-02  9.16846322e-02  3.98769804e-02]
 [-7.05988706e-02  3.74302631e-01  3.93540230e-01]
 [ 1.70774151e-01  9.87041786e-02  1.16529386e-01]
 [ 5.14123261e-02  8.58894429e-03  2.77791237e-02]
 [-1.01885739e-01 -5.55441713e-02  1.32673313e-02]
 [-5.04385330e-02 -2.61708189e-02  4.99960992e-02]
 [-3.86264762e-02 -9.59106159e-02  5.21607871e-02]
 [-3.65917166e-02  7.81229673e-02 -3.56689709e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.0968732]
curr_Stock_Price:  99.28163178979781
curr_Factors:  [99.28163179 -0.72709963 -1.0431649 ]
mat_Sqrt:  [[16.90646434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05518327 -0.07373078 -0.09454503]
Stock Position:  -0.05518326842461181
Bond Position:  [2.38181174]


portfolio before change:  [-3.12225915]
curr_Stock_Price:  99.76324799738903
curr_Factors:  [99.763248   -0.67866664 -1.03304808]
mat_Sqrt:  [[18.01284536  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00205221 0.02959109 0.11375793]
Stock Position:  0.002052211787142305
Bond Position:  [-3.32699446]


portfolio before change:  [-3.12813459]
curr_Stock_Price:  97.71105636314196
curr_Factors:  [97.71105636 -0.62445354 -0.97267714]
mat_Sqrt:  [[19.78420789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0043538  0.12080565 1.12266073]
Stock Position:  0.004353795590442624
Bond Position:  [-3.55354856]


portfolio before change:  [-3.12797091]
curr_Stock_Price:  98.15685289594607
curr_Factors:  [98.1568529  -0.4380046  -1.00414936]
mat_Sqrt:  [[23.2060444   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00925227 0.03185664 0.3324259 ]
Stock Position:  0.009252266988764744
Bond Position:  [-4.03614432]


portfolio before change:  [-3.12596689]
curr_Stock_Price:  98.5916207261718
curr_Factors:  [98.59162073 -0.24280887 -0.92657656]
mat_Sqrt:  [[30.61839114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00192159 0.00277207 0.07924611]
Stock Position:  0.0019215877990240997
Bond Position:  [-3.31541935]


portfolio before change:  [-3.12783312]
curr_Stock_Price:  98.48332624829949
curr_Factors:  [98.48332625 -0.82074964 -0.96006605]
mat_Sqrt:  [[16.59450411  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00665976 -0.0179268   0.037848  ]
Stock Position:  -0.0066597629249557444
Bond Position:  [-2.47195751]


portfolio before change:  [-3.13876038]
curr_Stock_Price:  99.9384790966886
curr_Factors:  [99.9384791  -0.66710036 -0.92841748]
mat_Sqrt:  [[20.26787139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224864 -0.0084466   0.14262495]
Stock Position:  -0.0022486435372763938
Bond Position:  [-2.91403436]


portfolio before change:  [-3.13794027]
curr_Stock_Price:  98.92565030102875
curr_Factors:  [98.9256503  -0.74714059 -0.88125174]
mat_Sqrt:  [[19.41364631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244966 -0.03095502  0.14880021]
Stock Position:  -0.002449662049160291
Bond Position:  [-2.89560586]


portfolio before change:  [-3.14484222]
curr_Stock_Price:  101.15199188305456
curr_Factors:  [101.15199188  -0.51878086  -0.83042805]
mat_Sqrt:  [[26.24342122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106411  0.02521408 -0.10175365]
Stock Position:  -0.001064107862092145
Bond Position:  [-3.03720559]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.14801452]
Stock Price:  102.70570376518694
PL:  [-5.85371828]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.02655318e+00 -2.62962977e-01 -3.12943696e-02]
 [-1.42333931e-02  1.46762389e-01  1.84515383e-01]
 [-8.73948899e-02  3.56825594e-01  4.63989820e-01]
 [ 1.01576416e-01  2.43982603e-02  1.14524639e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [-8.89873325e-03  2.43215160e-01 -8.23615519e-02]
 [-4.33413497e-02  4.86785003e-03  4.94837230e-02]
 [-2.74643932e-02 -7.05660723e-02  2.83588563e-02]
 [-1.20238373e-02  9.47531445e-02 -3.86021115e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.83898247]
curr_Stock_Price:  99.95525634685318
curr_Factors:  [99.95525635 -0.85046806 -0.91952611]
mat_Sqrt:  [[17.02577684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06382195 -0.08487094 -0.08927413]
Stock Position:  -0.06382194588334607
Bond Position:  [8.21832143]


portfolio before change:  [1.75824647]
curr_Stock_Price:  101.28467666322341
curr_Factors:  [101.28467666  -0.98892698  -0.95893872]
mat_Sqrt:  [[14.44097176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00369701 0.04736736 0.52637103]
Stock Position:  0.0036970087508349943
Bond Position:  [1.38379613]


portfolio before change:  [1.75677664]
curr_Stock_Price:  100.69990648182007
curr_Factors:  [100.69990648  -1.20892213  -0.95307384]
mat_Sqrt:  [[11.59007238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00691569 0.11516497 1.32363381]
Stock Position:  0.006915690622649591
Bond Position:  [1.06036724]


portfolio before change:  [1.75009866]
curr_Stock_Price:  99.65759590966894
curr_Factors:  [99.65759591 -0.97320046 -0.90845756]
mat_Sqrt:  [[15.181571    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0071728  0.0078745  0.03267069]
Stock Position:  0.007172802791819927
Bond Position:  [1.03527438]


portfolio before change:  [1.76456251]
curr_Stock_Price:  101.60189606096293
curr_Factors:  [101.60189606  -1.17245224  -0.90288225]
mat_Sqrt:  [[12.75250487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00457332 -0.00140152  0.08089603]
Stock Position:  0.00457332077629336
Bond Position:  [1.29990444]


portfolio before change:  [1.75709706]
curr_Stock_Price:  99.82735166252137
curr_Factors:  [99.82735166 -2.07020297 -0.89890301]
mat_Sqrt:  [[ 5.12605437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00466936  0.07849736 -0.23495458]
Stock Position:  0.004669355847342136
Bond Position:  [1.29096763]


portfolio before change:  [1.75246786]
curr_Stock_Price:  98.69767806021294
curr_Factors:  [98.69767806 -1.34625204 -0.89249265]
mat_Sqrt:  [[10.52040524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306517  0.00157109  0.14116329]
Stock Position:  -0.0030651748264090752
Bond Position:  [2.0549935]


portfolio before change:  [1.74984125]
curr_Stock_Price:  99.88989604742564
curr_Factors:  [99.88989605 -0.93588189 -0.94108189]
mat_Sqrt:  [[15.28855889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00235993 -0.0227751   0.08089992]
Stock Position:  -0.0023599284499081076
Bond Position:  [1.98557426]


portfolio before change:  [1.75166208]
curr_Stock_Price:  99.53912655756487
curr_Factors:  [99.53912656 -0.880828   -0.92736244]
mat_Sqrt:  [[16.31949435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.44407538e-05  3.05814459e-02 -1.10121079e-01]
Stock Position:  -3.444075383645167e-05
Bond Position:  [1.75509028]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.7524742]
Stock Price:  101.44526029477369
PL:  [0.3072139]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.16090499e+00 -2.99496640e-01 -1.75259159e-02]
 [-1.24790159e-02  1.42840388e-01  1.73376502e-01]
 [-8.06712517e-02  3.58863931e-01  4.28856308e-01]
 [ 1.01045779e-01  2.40996637e-02  1.12937393e-02]
 [ 5.07738188e-02  1.27031065e-02  2.75951135e-02]
 [ 1.61663172e-02  3.28994049e-02 -4.33692664e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 1.51559957e-02  2.30679053e-02 -5.35421923e-02]
 [ 1.01927936e-01  6.70559037e-02  9.40750740e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.91137804]
curr_Stock_Price:  100.2380880669167
curr_Factors:  [100.23808807  -0.6002151   -1.01157172]
mat_Sqrt:  [[20.00058285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06127906 -0.09666212 -0.04999656]
Stock Position:  -0.061279061397612
Bond Position:  [10.053874]


portfolio before change:  [3.85819383]
curr_Stock_Price:  101.18804404684795
curr_Factors:  [101.18804405  -0.91389243  -1.00875731]
mat_Sqrt:  [[14.79561522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00351918 0.04610154 0.4945949 ]
Stock Position:  0.0035191835974084464
Bond Position:  [3.50209452]


portfolio before change:  [3.85414252]
curr_Stock_Price:  99.53914185308
curr_Factors:  [99.53914185 -0.80487722 -1.01465134]
mat_Sqrt:  [[16.13550933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00496554 0.11582284 1.22340768]
Stock Position:  0.004965537011634743
Bond Position:  [3.35987723]


portfolio before change:  [3.85504238]
curr_Stock_Price:  99.38195788067512
curr_Factors:  [99.38195788 -1.08620136 -1.02367568]
mat_Sqrt:  [[12.05034809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00898484 0.00777813 0.03221789]
Stock Position:  0.008984838124764466
Bond Position:  [2.96211157]


portfolio before change:  [3.86201664]
curr_Stock_Price:  99.99330242184753
curr_Factors:  [99.99330242 -1.01027974 -1.03406695]
mat_Sqrt:  [[12.94560721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0045575  0.00409991 0.07872118]
Stock Position:  0.004557504146182843
Bond Position:  [3.40629675]


portfolio before change:  [3.87113239]
curr_Stock_Price:  101.61967028005078
curr_Factors:  [101.61967028  -1.06533306  -1.00499851]
mat_Sqrt:  [[12.81870648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00109443  0.01061824 -0.12372045]
Stock Position:  0.0010944291222227138
Bond Position:  [3.75991686]


portfolio before change:  [3.87383199]
curr_Stock_Price:  102.3681681139429
curr_Factors:  [102.36816811  -1.01973289  -1.04081831]
mat_Sqrt:  [[13.04003971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00368091 -0.01197701  0.13962421]
Stock Position:  -0.003680905128638344
Bond Position:  [4.25063951]


portfolio before change:  [3.87435343]
curr_Stock_Price:  102.80404408426993
curr_Factors:  [102.80404408  -1.43805704  -1.02359569]
mat_Sqrt:  [[ 8.76855443  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00101903  0.00744513 -0.15274097]
Stock Position:  0.0010190343194863539
Bond Position:  [3.76959258]


portfolio before change:  [3.87661489]
curr_Stock_Price:  103.17321464781296
curr_Factors:  [103.17321465  -1.13698426  -0.96486906]
mat_Sqrt:  [[12.6108298   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00932024 0.0216422  0.026837  ]
Stock Position:  0.009320240330389848
Bond Position:  [2.91501574]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.86078505]
Stock Price:  101.31835728945399
PL:  [2.54242776]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.32552020e+00 -2.94605172e-01 -1.05202770e-01]
 [-2.37767548e-02  1.68393270e-01  2.40610378e-01]
 [-9.75463160e-02  4.20486819e-01  5.28638094e-01]
 [ 1.04592306e-01  2.60953398e-02  1.23545781e-02]
 [ 5.19521244e-02  5.11080379e-03  2.79346871e-02]
 [-1.55187459e-03  2.33494844e-02 -3.55572666e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-5.88098506e-03 -2.92210670e-02 -9.02381080e-03]
 [ 5.06405540e-03  1.06543561e-01 -3.85502644e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.60891078]
curr_Stock_Price:  102.38042046963551
curr_Factors:  [102.38042047  -1.30401446  -1.08583341]
mat_Sqrt:  [[ 9.38251287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.14997375 -0.09508341 -0.30011422]
Stock Position:  -0.14997375112805722
Bond Position:  [34.96328648]


portfolio before change:  [19.70309407]
curr_Stock_Price:  101.86901577521638
curr_Factors:  [101.86901578  -1.07997116  -1.09094426]
mat_Sqrt:  [[11.62051899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00513839 0.05434869 0.68639444]
Stock Position:  0.00513839057909619
Bond Position:  [19.17965128]


portfolio before change:  [19.71120385]
curr_Stock_Price:  101.58051152570309
curr_Factors:  [101.58051153  -0.91659178  -1.09000399]
mat_Sqrt:  [[13.65705089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00704347 0.13571154 1.50805734]
Stock Position:  0.007043467608490786
Bond Position:  [18.9957248]


portfolio before change:  [19.71445706]
curr_Stock_Price:  100.69358648649414
curr_Factors:  [100.69358649  -0.52108356  -1.12712469]
mat_Sqrt:  [[19.37287442  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00580404 0.00842223 0.03524417]
Stock Position:  0.005804036089081786
Bond Position:  [19.13002785]


portfolio before change:  [19.72724175]
curr_Stock_Price:  101.24790499790693
curr_Factors:  [101.247905    -0.81806716  -1.10401428]
mat_Sqrt:  [[14.81278374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00396262 0.0016495  0.07968989]
Stock Position:  0.0039626249859791894
Bond Position:  [19.32603427]


portfolio before change:  [19.73607825]
curr_Stock_Price:  101.03871824614518
curr_Factors:  [101.03871825  -0.95849182  -1.09930622]
mat_Sqrt:  [[12.90617338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031332  0.00753601 -0.10143498]
Stock Position:  -0.00031332119720040865
Bond Position:  [19.76773582]


portfolio before change:  [19.74536695]
curr_Stock_Price:  102.94614528580561
curr_Factors:  [102.94614529  -0.72922836  -1.127066  ]
mat_Sqrt:  [[16.08539352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298402 -0.01197701  0.13962421]
Stock Position:  -0.0029840208136548483
Bond Position:  [20.05256039]


portfolio before change:  [19.76012683]
curr_Stock_Price:  101.36066950968511
curr_Factors:  [101.36066951  -0.86938584  -1.10289067]
mat_Sqrt:  [[14.10329751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00097053 -0.00943106 -0.02574242]
Stock Position:  -0.0009705310426690344
Bond Position:  [19.85850051]


portfolio before change:  [19.77132869]
curr_Stock_Price:  100.05198321808028
curr_Factors:  [100.05198322  -1.16658439  -1.09139728]
mat_Sqrt:  [[10.46156654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00181074  0.03438679 -0.10997317]
Stock Position:  0.0018107354111192115
Bond Position:  [19.59016102]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.77857087]
Stock Price:  98.64076218747773
PL:  [19.77857087]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-9.10229526e-01 -2.17722782e-01 -7.18684726e-02]
 [ 1.07969309e-02  9.01110129e-02  3.61430159e-02]
 [-8.09856040e-02  3.85443994e-01  4.43583543e-01]
 [ 1.02583796e-01  2.49651255e-02  1.17537917e-02]
 [ 3.77457795e-02 -2.21513523e-02  2.95444150e-03]
 [-1.36841921e-03  2.69828642e-02 -3.62865396e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 1.07171066e-02  8.09042260e-03 -4.14900445e-02]
 [ 3.86631134e-01 -7.66390763e-03  1.26749896e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.14445083]
curr_Stock_Price:  100.26989684828082
curr_Factors:  [100.26989685  -1.31216684  -0.94354805]
mat_Sqrt:  [[10.50814458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09224674 -0.07026973 -0.20502075]
Stock Position:  -0.09224674112091827
Bond Position:  [13.39402205]


portfolio before change:  [4.20076097]
curr_Stock_Price:  99.73208435299406
curr_Factors:  [99.73208435 -0.68414608 -0.91842084]
mat_Sqrt:  [[20.08394047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00182078 0.0290832  0.10310596]
Stock Position:  0.001820779477326169
Bond Position:  [4.01917083]


portfolio before change:  [4.20161694]
curr_Stock_Price:  99.09822753550343
curr_Factors:  [99.09822754 -0.76005633 -0.92207019]
mat_Sqrt:  [[18.43009694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00478776 0.12440151 1.26542038]
Stock Position:  0.004787762837998997
Bond Position:  [3.72715813]


portfolio before change:  [4.20803882]
curr_Stock_Price:  100.05020406440208
curr_Factors:  [100.05020406  -0.85802346  -0.91643837]
mat_Sqrt:  [[16.96598192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00648822 0.00805746 0.0335303 ]
Stock Position:  0.006488219411253823
Bond Position:  [3.55889115]


portfolio before change:  [4.23339664]
curr_Stock_Price:  103.68416308062935
curr_Factors:  [103.68416308  -0.4362892   -0.94521676]
mat_Sqrt:  [[26.04545873  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129878 -0.00714932  0.0084282 ]
Stock Position:  0.0012987763740828857
Bond Position:  [4.0987341]


portfolio before change:  [4.23225869]
curr_Stock_Price:  101.22967638599681
curr_Factors:  [101.22967639  -0.40085695  -0.93491321]
mat_Sqrt:  [[26.61890812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00012275  0.00870868 -0.1035154 ]
Stock Position:  -0.0001227519919693635
Bond Position:  [4.24468483]


portfolio before change:  [4.23401042]
curr_Stock_Price:  104.25321402194339
curr_Factors:  [104.25321402  -0.49702448  -0.95882637]
mat_Sqrt:  [[24.31204336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019743  -0.01197701  0.13962421]
Stock Position:  -0.001974295140519142
Bond Position:  [4.43983703]


portfolio before change:  [4.23246087]
curr_Stock_Price:  106.16276786163522
curr_Factors:  [ 1.06162768e+02  9.52208560e-02 -9.68022160e-01]
mat_Sqrt:  [[44.35263664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.79189524e-05  2.61117267e-03 -1.18359548e-01]
Stock Position:  8.791895240126692e-05
Bond Position:  [4.22312715]


portfolio before change:  [4.23512213]
curr_Stock_Price:  112.40908428308018
curr_Factors:  [112.40908428  -0.29100794  -0.99750528]
mat_Sqrt:  [[30.98897622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01326083 -0.00247352  0.36158217]
Stock Position:  0.013260827240535558
Bond Position:  [2.74448468]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.2571279]
Stock Price:  113.9650341756385
PL:  [-9.70790628]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.23494038e-01 -2.04623466e-01 -2.17406500e-02]
 [ 3.78177153e-02  5.26347496e-02  1.05583846e-02]
 [-7.80188591e-02  3.76480806e-01  4.26379206e-01]
 [ 1.02619720e-01  2.49853406e-02  1.17645374e-02]
 [ 4.96185821e-02  2.01467674e-02  2.72621881e-02]
 [ 2.20888950e-02  2.80857932e-02 -4.39258211e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-3.82557368e-02 -1.09707720e-01  6.31915858e-02]
 [-4.87646783e-03  8.52157246e-03 -7.19441977e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.87178938]
curr_Stock_Price:  98.6299715678778
curr_Factors:  [98.62997157 -0.71660249 -0.96674605]
mat_Sqrt:  [[18.32060975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04747115 -0.06604194 -0.06202002]
Stock Position:  -0.04747115036673252
Bond Position:  [-3.18971117]


portfolio before change:  [-7.87255926]
curr_Stock_Price:  98.61258470575613
curr_Factors:  [98.61258471 -0.58558536 -0.96593981]
mat_Sqrt:  [[20.89842348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00242683 0.01698779 0.03012013]
Stock Position:  0.0024268318521609264
Bond Position:  [-8.11187542]


portfolio before change:  [-7.87620484]
curr_Stock_Price:  98.78209485090801
curr_Factors:  [98.78209485 -0.62519459 -1.01060764]
mat_Sqrt:  [[19.24236064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00446225 0.12150866 1.21634119]
Stock Position:  0.004462251605483234
Bond Position:  [-8.3169954]


portfolio before change:  [-7.87493614]
curr_Stock_Price:  99.9985744931452
curr_Factors:  [99.99857449 -0.62169022 -0.96831341]
mat_Sqrt:  [[20.39219646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00540017 0.00806398 0.03356095]
Stock Position:  0.005400166561792568
Bond Position:  [-8.4149451]


portfolio before change:  [-7.87983576]
curr_Stock_Price:  99.87059813267703
curr_Factors:  [99.87059813 -0.86632728 -1.00806984]
mat_Sqrt:  [[15.32488847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00386925 0.00650234 0.07777143]
Stock Position:  0.003869254562718085
Bond Position:  [-8.26626053]


portfolio before change:  [-7.87539838]
curr_Stock_Price:  102.08589220489517
curr_Factors:  [102.0858922   -1.21223662  -1.04477746]
mat_Sqrt:  [[10.68456801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00176475  0.00906465 -0.12530814]
Stock Position:  0.0017647473294714396
Bond Position:  [-8.05555419]


portfolio before change:  [-7.88175007]
curr_Stock_Price:  100.76961481672991
curr_Factors:  [100.76961482  -0.91968839  -1.04422807]
mat_Sqrt:  [[14.13876635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339486 -0.01197701  0.13962421]
Stock Position:  -0.0033948611840090154
Bond Position:  [-7.53965121]


portfolio before change:  [-7.87327192]
curr_Stock_Price:  97.16153914572138
curr_Factors:  [97.16153915 -0.68662319 -1.00586391]
mat_Sqrt:  [[17.88366701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267008 -0.03540801  0.18026801]
Stock Position:  -0.002670078957547523
Bond Position:  [-7.61384294]


portfolio before change:  [-7.87664575]
curr_Stock_Price:  96.99898100816985
curr_Factors:  [96.99898101 -0.98263128 -0.98434917]
mat_Sqrt:  [[13.56808073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131357  0.00275033 -0.20523677]
Stock Position:  -0.0013135650761475935
Bond Position:  [-7.74923127]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.87991873]
Stock Price:  96.54022788336842
PL:  [-7.87991873]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.03526865e+00 -2.75218798e-01 -9.58668795e-03]
 [ 2.52039000e-02  5.81708447e-02 -5.93892668e-02]
 [-5.43660407e-02  2.56204559e-01  2.64637374e-01]
 [ 2.19578466e-01  1.52642140e-01  1.94409547e-01]
 [ 5.11527307e-02 -5.03566397e-03  5.82016695e-02]
 [-1.07337997e-01 -6.22253053e-02  1.67179742e-02]
 [-4.07116248e-02  2.27196489e-02  4.98979112e-02]
 [-6.53681936e-03 -3.48025186e-02 -4.97261020e-03]
 [ 8.63100159e-02  1.01638739e-01 -1.79059433e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.39181325]
curr_Stock_Price:  99.5143311090442
curr_Factors:  [99.51433111 -0.49956087 -0.99876896]
mat_Sqrt:  [[22.24176524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04915996 -0.08882649 -0.02734815]
Stock Position:  -0.049159961446622706
Bond Position:  [3.50030744]


portfolio before change:  [-1.23550209]
curr_Stock_Price:  96.37029771924792
curr_Factors:  [96.37029772 -1.17868348 -1.03832059]
mat_Sqrt:  [[10.49809665  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00237712  0.01877456 -0.16942105]
Stock Position:  0.002377115719298081
Bond Position:  [-1.46458544]


portfolio before change:  [-1.23480906]
curr_Stock_Price:  96.96997802864401
curr_Factors:  [96.96997803 -0.95673812 -1.04728911]
mat_Sqrt:  [[13.07071456  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00397456 0.08268967 0.75493677]
Stock Position:  0.003974562632787675
Bond Position:  [-1.62022231]


portfolio before change:  [-1.23732047]
curr_Stock_Price:  96.54198202091389
curr_Factors:  [96.54198202 -0.40862688 -1.02933029]
mat_Sqrt:  [[22.92024994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0126709  0.04926504 0.55459632]
Stock Position:  0.012670895651789305
Bond Position:  [-2.46059385]


portfolio before change:  [-1.24148074]
curr_Stock_Price:  96.31077013176677
curr_Factors:  [96.31077013 -0.78319288 -0.9705343 ]
mat_Sqrt:  [[16.67403913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00371867 -0.00162525  0.16603316]
Stock Position:  0.003718666825609642
Bond Position:  [-1.5996284]


portfolio before change:  [-1.23886274]
curr_Stock_Price:  97.22991920082688
curr_Factors:  [97.2299192 -0.4304352 -0.9406687]
mat_Sqrt:  [[24.67954039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00472566 -0.02008313  0.04769173]
Stock Position:  -0.00472566103318085
Bond Position:  [-0.7793871]


portfolio before change:  [-1.24542025]
curr_Stock_Price:  98.53507311995642
curr_Factors:  [98.53507312 -0.67414484 -0.93953472]
mat_Sqrt:  [[19.62360137  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131926  0.00733274  0.14234485]
Stock Position:  -0.0013192597492045206
Bond Position:  [-1.11542689]


portfolio before change:  [-1.24994148]
curr_Stock_Price:  101.53931590494291
curr_Factors:  [101.5393159   -0.38383221  -0.98618838]
mat_Sqrt:  [[25.80131556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056803 -0.01123246 -0.01418547]
Stock Position:  -0.0005680285370900548
Bond Position:  [-1.19226425]


portfolio before change:  [-1.25009282]
curr_Stock_Price:  100.75601134222161
curr_Factors:  [100.75601134  -1.59148125  -0.99010513]
mat_Sqrt:  [[ 7.62258446  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0135652   0.03280376 -0.05108067]
Stock Position:  0.013565202442589127
Bond Position:  [-2.61686851]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.22998222]
Stock Price:  102.33500461487746
PL:  [-3.56498683]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.19607806e+00 -2.95667959e-01 -4.21203630e-02]
 [-7.62100039e-03  1.31714672e-01  1.46561516e-01]
 [-9.41764151e-02  4.04302481e-01  5.04360766e-01]
 [ 1.09046477e-01  2.86017589e-02  1.36869120e-02]
 [ 5.32857884e-02 -3.48253693e-03  2.83190331e-02]
 [-3.83820990e-02 -7.44069018e-04 -1.76456974e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-1.25757277e-02 -4.27688674e-02  3.05914562e-03]
 [-3.42618861e-02  7.10868374e-02 -2.79696055e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.8717375]
curr_Stock_Price:  100.91505679627701
curr_Factors:  [100.9150568   -0.93089463  -0.99066927]
mat_Sqrt:  [[14.77173027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0856385  -0.09542642 -0.12015767]
Stock Position:  -0.0856384994369032
Bond Position:  [17.51395153]


portfolio before change:  [8.88772732]
curr_Stock_Price:  100.83062450226576
curr_Factors:  [100.8306245   -1.01273587  -0.9850834 ]
mat_Sqrt:  [[13.67573172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00359629 0.04251073 0.41809921]
Stock Position:  0.003596289371292202
Bond Position:  [8.52511121]


portfolio before change:  [8.89451907]
curr_Stock_Price:  101.53360882797084
curr_Factors:  [101.53360883  -1.28953086  -0.93831085]
mat_Sqrt:  [[10.94133867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00834484 0.13048806 1.43880088]
Stock Position:  0.008344837520142596
Bond Position:  [8.04723761]


portfolio before change:  [8.90834045]
curr_Stock_Price:  102.70759874113925
curr_Factors:  [102.70759874  -0.96902048  -0.93791696]
mat_Sqrt:  [[15.2556308   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00771378 0.00923118 0.03904495]
Stock Position:  0.007713782356579152
Bond Position:  [8.11607639]


portfolio before change:  [8.90942292]
curr_Stock_Price:  102.32171991340816
curr_Factors:  [102.32171991  -0.66334198  -0.94056519]
mat_Sqrt:  [[20.57784061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00283584 -0.00112398  0.08078632]
Stock Position:  0.002835842597359459
Bond Position:  [8.61925463]


portfolio before change:  [8.90783803]
curr_Stock_Price:  100.24276387629683
curr_Factors:  [100.24276388  -0.93329827  -0.94436987]
mat_Sqrt:  [[15.33176387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00274827 -0.00024015 -0.05033826]
Stock Position:  -0.002748274412351572
Bond Position:  [9.18333266]


portfolio before change:  [8.91116098]
curr_Stock_Price:  100.7048231290318
curr_Factors:  [100.70482313  -0.80701148  -0.95521322]
mat_Sqrt:  [[17.28724576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277656 -0.01197701  0.13962421]
Stock Position:  -0.0027765642782464853
Bond Position:  [9.1907744]


portfolio before change:  [8.9148087]
curr_Stock_Price:  101.04654632717582
curr_Factors:  [101.04654633  -0.67221247  -0.95029108]
mat_Sqrt:  [[19.94697918  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103682 -0.01380359  0.00872689]
Stock Position:  -0.0010368206885599158
Bond Position:  [9.01957585]


portfolio before change:  [8.91843337]
curr_Stock_Price:  101.90131856921896
curr_Factors:  [101.90131857  -0.46810959  -0.88883193]
mat_Sqrt:  [[26.23418573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00097051  0.02294318 -0.0797895 ]
Stock Position:  -0.000970512987064496
Bond Position:  [9.01732993]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.92075182]
Stock Price:  104.15924118882849
PL:  [4.76151063]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.40670651e-01 -1.68743895e-01 -4.85949229e-02]
 [ 4.66689250e-02  4.00453173e-02 -1.16459225e-02]
 [-4.04103829e-02  1.76295136e-01  1.64703249e-01]
 [ 2.06126972e-01  1.52807336e-01  2.09255816e-01]
 [ 5.41955749e-02 -3.53047828e-02  8.03364856e-02]
 [-5.10455516e-02  3.83369109e-02 -2.22356647e-02]
 [ 5.91292661e-02  1.91289726e-01  1.06006025e-01]
 [-3.95264391e-02 -1.17838167e-01  3.71360903e-02]
 [ 3.06441791e-02 -1.93478412e-01 -1.53551799e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.10218652]
curr_Stock_Price:  98.73500368830584
curr_Factors:  [98.73500369 -0.96506224 -1.05112398]
mat_Sqrt:  [[13.14778509  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05970852 -0.05446186 -0.13862779]
Stock Position:  -0.059708517121404514
Bond Position:  [-1.20686586]


portfolio before change:  [-6.98853914]
curr_Stock_Price:  96.82152526192503
curr_Factors:  [96.82152526 -0.73051759 -0.98010255]
mat_Sqrt:  [[17.5008456   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00299791  0.01292457 -0.03322258]
Stock Position:  0.002997908123365825
Bond Position:  [-7.27880118]


portfolio before change:  [-6.99524751]
curr_Stock_Price:  95.79812574198921
curr_Factors:  [95.79812574 -1.296853   -1.00221554]
mat_Sqrt:  [[ 9.61355979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00303692 0.05689901 0.46985253]
Stock Position:  0.0030369209388956746
Bond Position:  [-7.28617885]


portfolio before change:  [-6.99836032]
curr_Stock_Price:  95.9730375268304
curr_Factors:  [95.97303753 -1.14916143 -1.04089443]
mat_Sqrt:  [[10.74039029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02607287 0.04931836 0.5969486 ]
Stock Position:  0.026072870282139168
Bond Position:  [-9.50065288]


portfolio before change:  [-7.02989116]
curr_Stock_Price:  94.94594220355405
curr_Factors:  [94.9459422  -0.76322321 -1.03668998]
mat_Sqrt:  [[15.69582113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0040385  -0.01139457  0.22917763]
Stock Position:  0.004038503768915732
Bond Position:  [-7.4133307]


portfolio before change:  [-7.045346]
curr_Stock_Price:  92.03713048972591
curr_Factors:  [92.03713049 -0.62752425 -1.01001112]
mat_Sqrt:  [[17.89742272  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266848  0.01237318 -0.06343216]
Stock Position:  -0.0026684791012481007
Bond Position:  [-6.79974684]


portfolio before change:  [-7.05573205]
curr_Stock_Price:  94.65485015622643
curr_Factors:  [94.65485016 -1.32672837 -1.0320849 ]
mat_Sqrt:  [[ 8.94794453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01339017 0.06173849 0.30240568]
Stock Position:  0.013390170967702068
Bond Position:  [-8.32317668]


portfolio before change:  [-7.07158765]
curr_Stock_Price:  93.78159963013941
curr_Factors:  [93.78159963 -0.9555005  -1.03834361]
mat_Sqrt:  [[12.77033071  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00438514 -0.0380321   0.10593893]
Stock Position:  -0.0043851394936765134
Bond Position:  [-6.66034226]


portfolio before change:  [-7.07264356]
curr_Stock_Price:  93.26277976967465
curr_Factors:  [93.26277977 -1.21873897 -1.00210568]
mat_Sqrt:  [[10.12063542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0039714  -0.06244489 -0.43804054]
Stock Position:  -0.003971397487206655
Bond Position:  [-6.70225999]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.0778129]
Stock Price:  93.72039661627309
PL:  [-7.0778129]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.83792259e-01 -1.88097494e-01 -3.09893283e-02]
 [ 3.61987986e-02  4.68421246e-02 -5.32498420e-02]
 [-4.29812986e-02  2.14376160e-01  1.94874413e-01]
 [ 1.75522771e-01  1.03567541e-01  1.23177610e-01]
 [ 4.76898982e-02  3.25740636e-02  2.67063644e-02]
 [-5.78186543e-02 -1.50953369e-02 -8.61454839e-03]
 [-3.10430710e-02  3.98907254e-02  4.68114063e-02]
 [-2.22615512e-02 -6.00255939e-02  1.89606195e-02]
 [-1.55268511e-02  9.33791233e-02 -3.73754053e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.13104503]
curr_Stock_Price:  98.59458946141169
curr_Factors:  [98.59458946 -0.79928354 -1.00261714]
mat_Sqrt:  [[16.26662905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0509333  -0.0607082  -0.08840393]
Stock Position:  -0.05093330438235503
Bond Position:  [-3.10929679]


portfolio before change:  [-7.98522837]
curr_Stock_Price:  95.70116438863613
curr_Factors:  [95.70116439 -1.06413983 -1.01704006]
mat_Sqrt:  [[11.94186829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00292172  0.01511823 -0.15190698]
Stock Position:  0.0029217227902899228
Bond Position:  [-8.26484064]


portfolio before change:  [-7.99002394]
curr_Stock_Price:  95.47454395751986
curr_Factors:  [95.47454396 -1.18550934 -0.95626819]
mat_Sqrt:  [[11.21309312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0036169  0.06918961 0.55592246]
Stock Position:  0.003616898955763314
Bond Position:  [-8.33534572]


portfolio before change:  [-7.98660357]
curr_Stock_Price:  97.57277312910566
curr_Factors:  [97.57277313 -0.89230033 -0.98146101]
mat_Sqrt:  [[14.98181525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01480508 0.03342628 0.35139143]
Stock Position:  0.014805077184342564
Bond Position:  [-9.43117601]


portfolio before change:  [-7.97133958]
curr_Stock_Price:  98.92236134679582
curr_Factors:  [98.92236135 -0.42166502 -1.03956795]
mat_Sqrt:  [[22.9450527   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00260581 0.01051323 0.07618582]
Stock Position:  0.00260581074724996
Bond Position:  [-8.22911254]


portfolio before change:  [-7.97298366]
curr_Stock_Price:  99.87082112696146
curr_Factors:  [99.87082113 -0.41808537 -1.00064675]
mat_Sqrt:  [[24.17080374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259232 -0.004872   -0.02457491]
Stock Position:  -0.002592318197075075
Bond Position:  [-7.71408671]


portfolio before change:  [-7.97161314]
curr_Stock_Price:  97.85389100228832
curr_Factors:  [97.853891   -0.67212081 -1.02703527]
mat_Sqrt:  [[17.8913862   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00074589  0.01287468  0.13353991]
Stock Position:  -0.000745893711916839
Bond Position:  [-7.89862454]


portfolio before change:  [-7.97727579]
curr_Stock_Price:  100.14959301610651
curr_Factors:  [100.14959302  -1.06938835  -1.04704387]
mat_Sqrt:  [[12.06408407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254009 -0.01937318  0.05408937]
Stock Position:  -0.0025400937087482413
Bond Position:  [-7.72288644]


portfolio before change:  [-7.98188267]
curr_Stock_Price:  100.44268106937692
curr_Factors:  [100.44268107  -0.75891684  -0.98639547]
mat_Sqrt:  [[17.53633338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023352  0.03013798 -0.10662163]
Stock Position:  -0.0002335231605096516
Bond Position:  [-7.95842698]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.98571905]
Stock Price:  99.82676534751964
PL:  [-7.98571905]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.53281176e-01 -2.15714611e-01 -3.06743089e-02]
 [ 2.59734022e-02  6.20828494e-02 -2.10719314e-02]
 [-5.67914540e-02  2.74795820e-01  2.84373437e-01]
 [ 1.02569787e-01  2.49572428e-02  1.17496015e-02]
 [ 4.84706871e-02  2.75431230e-02  2.69313784e-02]
 [-4.28362346e-02  1.65396232e-03 -1.61956584e-02]
 [-2.10739263e-02  3.90147503e-02  4.18617317e-02]
 [-3.85821797e-02 -9.64830873e-02  5.25217359e-02]
 [ 3.04201418e-02  1.24525394e-01 -4.28249727e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.87096188]
curr_Stock_Price:  99.03951172258388
curr_Factors:  [99.03951172 -0.77541457 -0.99124007]
mat_Sqrt:  [[16.92622565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05338314 -0.06962159 -0.08750527]
Stock Position:  -0.05338314176480554
Bond Position:  [0.41607841]


portfolio before change:  [-4.82236339]
curr_Stock_Price:  98.13303830072515
curr_Factors:  [98.1330383  -0.8414036  -1.01417271]
mat_Sqrt:  [[15.34435701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00223826  0.02003715 -0.06011235]
Stock Position:  0.002238263930414781
Bond Position:  [-5.04201103]


portfolio before change:  [-4.82651111]
curr_Stock_Price:  97.40654579532573
curr_Factors:  [97.4065458  -0.99802725 -1.01978479]
mat_Sqrt:  [[12.94981329  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00442852 0.08868997 0.81123826]
Stock Position:  0.004428518870132656
Bond Position:  [-5.25787784]


portfolio before change:  [-4.81749865]
curr_Stock_Price:  100.03542922015716
curr_Factors:  [100.03542922  -1.38770616  -1.04749834]
mat_Sqrt:  [[ 8.7610864   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01256266 0.00805492 0.03351834]
Stock Position:  0.012562658941606124
Bond Position:  [-6.07420963]


portfolio before change:  [-4.82615226]
curr_Stock_Price:  99.5884101814971
curr_Factors:  [99.58841018 -0.752997   -1.03944702]
mat_Sqrt:  [[16.58671006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00359265 0.0088895  0.07682773]
Stock Position:  0.0035926502536788936
Bond Position:  [-5.18393859]


portfolio before change:  [-4.83324865]
curr_Stock_Price:  98.33480140348894
curr_Factors:  [98.3348014  -1.33349031 -1.00763223]
mat_Sqrt:  [[ 9.461732    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00484103  0.00053381 -0.04620171]
Stock Position:  -0.00484103184081838
Bond Position:  [-4.35720675]


portfolio before change:  [-4.82970975]
curr_Stock_Price:  97.15363738614832
curr_Factors:  [97.15363739 -1.53462453 -1.01300703]
mat_Sqrt:  [[ 7.60390594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060036  0.01259196  0.11941987]
Stock Position:  -0.0006003603409122992
Bond Position:  [-4.77138256]


portfolio before change:  [-4.83258794]
curr_Stock_Price:  97.97298553553287
curr_Factors:  [97.97298554 -1.69900044 -1.04806633]
mat_Sqrt:  [[ 6.28160182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00757064 -0.03113978  0.14982989]
Stock Position:  -0.0075706411044611415
Bond Position:  [-4.09086963]


portfolio before change:  [-4.84244583]
curr_Stock_Price:  99.00485872727856
curr_Factors:  [99.00485873 -1.38503486 -1.04131446]
mat_Sqrt:  [[ 8.74795188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00538379  0.0401904  -0.12216773]
Stock Position:  0.005383793943141864
Bond Position:  [-5.37546759]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.84699839]
Stock Price:  98.65860648771171
PL:  [-4.84699839]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.01200862e+00 -2.44368795e-01 -6.36073762e-02]
 [ 2.26464390e-02  7.18933685e-02  1.71705744e-02]
 [-8.91208640e-02  4.54881552e-01  5.13345972e-01]
 [ 1.13641866e-01  3.86186793e-02  3.27901917e-02]
 [ 4.89235637e-02  2.34776593e-02  2.93493907e-02]
 [-5.05773443e-02 -1.00022422e-02 -1.15179499e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-3.84005400e-02 -1.02809266e-01  5.89299994e-02]
 [-9.65012554e-02 -5.63773972e-02 -7.28451441e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.05460756]
curr_Stock_Price:  100.53058690184413
curr_Factors:  [100.5305869   -1.1532052   -1.00968259]
mat_Sqrt:  [[11.56027014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09298001 -0.07886969 -0.18145414]
Stock Position:  -0.09298000664560763
Bond Position:  [15.4019422]


portfolio before change:  [6.166641]
curr_Stock_Price:  99.40851185216447
curr_Factors:  [99.40851185 -0.62702539 -1.01752103]
mat_Sqrt:  [[19.19579636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00212685 0.02320348 0.04898287]
Stock Position:  0.0021268479541864376
Bond Position:  [5.95521421]


portfolio before change:  [6.16862892]
curr_Stock_Price:  98.94283187318075
curr_Factors:  [98.94283187 -0.32419975 -0.96556155]
mat_Sqrt:  [[27.24257276  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00398339 0.14681239 1.46443317]
Stock Position:  0.003983388527169063
Bond Position:  [5.77450118]


portfolio before change:  [6.17199054]
curr_Stock_Price:  99.06173640258521
curr_Factors:  [99.0617364  -0.81581056 -0.98682289]
mat_Sqrt:  [[16.33172944  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00785086 0.01246413 0.09354129]
Stock Position:  0.00785086119583661
Bond Position:  [5.39427059]


portfolio before change:  [6.17072775]
curr_Stock_Price:  98.55725716205274
curr_Factors:  [98.55725716 -0.97807503 -0.94792723]
mat_Sqrt:  [[14.36271211  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00415707 0.00757738 0.08372564]
Stock Position:  0.004157072817122911
Bond Position:  [5.76101806]


portfolio before change:  [6.17926975]
curr_Stock_Price:  99.91897767500201
curr_Factors:  [99.91897768 -1.0808476  -0.95905701]
mat_Sqrt:  [[12.99357527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423056 -0.00322821 -0.03285751]
Stock Position:  -0.004230562718461261
Bond Position:  [6.60198325]


portfolio before change:  [6.18293765]
curr_Stock_Price:  99.83244469511506
curr_Factors:  [99.8324447  -1.35638104 -0.94466845]
mat_Sqrt:  [[ 9.99858653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00480059 -0.01197701  0.13962421]
Stock Position:  -0.004800593455107268
Bond Position:  [6.66219263]


portfolio before change:  [6.19292443]
curr_Stock_Price:  98.44618838647303
curr_Factors:  [98.44618839 -0.45272099 -0.93081084]
mat_Sqrt:  [[24.67963123  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191888 -0.03318155  0.16811089]
Stock Position:  -0.0019188843403030924
Bond Position:  [6.38183128]


portfolio before change:  [6.20065681]
curr_Stock_Price:  96.07988565521144
curr_Factors:  [96.07988566 -0.35249726 -0.88059943]
mat_Sqrt:  [[27.99660629  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00438906 -0.01819573 -0.20780692]
Stock Position:  -0.004389056834503446
Bond Position:  [6.62235689]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.21086918]
Stock Price:  94.50771100229862
PL:  [6.21086918]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-9.37415481e-01 -2.42991535e-01 -3.14444073e-02]
 [-1.66023800e-02  1.52320444e-01  1.95577272e-01]
 [-8.51385127e-02  3.31414008e-01  4.46115062e-01]
 [ 1.04072436e-01  2.58028026e-02  1.21990745e-02]
 [ 4.97418111e-02  1.93527526e-02  2.72977012e-02]
 [ 1.33497929e-02  3.20933485e-02 -4.23242058e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-1.54912344e-04  1.11862906e-03 -3.19980411e-02]
 [ 2.60793648e-01 -1.32275983e-02  9.51272149e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.36551383]
curr_Stock_Price:  99.51792034146956
curr_Factors:  [99.51792034 -0.7194642  -1.03480471]
mat_Sqrt:  [[17.219954    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05769089 -0.07842518 -0.08970214]
Stock Position:  -0.05769089064379156
Bond Position:  [4.37576363]


portfolio before change:  [-1.47810017]
curr_Stock_Price:  101.50739857284873
curr_Factors:  [101.50739857  -0.78532408  -1.03243827]
mat_Sqrt:  [[16.48365582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00330096 0.04916121 0.55792752]
Stock Position:  0.003300963365977146
Bond Position:  [-1.81317237]


portfolio before change:  [-1.48118354]
curr_Stock_Price:  100.84802963826178
curr_Factors:  [100.84802964  -1.21312358  -1.03665214]
mat_Sqrt:  [[10.63168842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00692025 0.10696341 1.2726421 ]
Stock Position:  0.006920250225438544
Bond Position:  [-2.17907714]


portfolio before change:  [-1.48403023]
curr_Stock_Price:  100.59415375004777
curr_Factors:  [100.59415375  -1.00248426  -1.05445761]
mat_Sqrt:  [[12.86039291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00869565 0.00832782 0.03480056]
Stock Position:  0.008695654757137662
Bond Position:  [-2.35876226]


portfolio before change:  [-1.49096326]
curr_Stock_Price:  99.93251806736815
curr_Factors:  [99.93251807 -0.86656878 -1.04998409]
mat_Sqrt:  [[14.70139328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0040312  0.00624607 0.07787274]
Stock Position:  0.004031202622518246
Bond Position:  [-1.89381149]


portfolio before change:  [-1.4845878]
curr_Stock_Price:  101.74899878249373
curr_Factors:  [101.74899878  -0.3690101   -1.03020488]
mat_Sqrt:  [[25.11069871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00044847  0.01035808 -0.12073918]
Stock Position:  0.0004484713066524427
Bond Position:  [-1.53021931]


portfolio before change:  [-1.48352947]
curr_Stock_Price:  105.81534337417814
curr_Factors:  [105.81534337  -0.55010068  -1.07719727]
mat_Sqrt:  [[20.7884508   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230893 -0.01197701  0.13962421]
Stock Position:  -0.002308933432624364
Bond Position:  [-1.23920888]


portfolio before change:  [-1.4891606]
curr_Stock_Price:  107.98577249738271
curr_Factors:  [107.9857725  -1.0732336  -1.0745909]
mat_Sqrt:  [[12.60602625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051231  0.00036104 -0.0912815 ]
Stock Position:  -0.0005123062421773923
Bond Position:  [-1.43383882]


portfolio before change:  [-1.49040885]
curr_Stock_Price:  109.02255378511148
curr_Factors:  [109.02255379  -0.76668593  -1.08207639]
mat_Sqrt:  [[17.16362729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01616857 -0.00426919  0.27137147]
Stock Position:  0.016168571652344192
Bond Position:  [-3.25314782]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.5397756]
Stock Price:  106.0699265144804
PL:  [-7.60970211]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.21386935e+00 -3.27811654e-01  1.71947697e-02]
 [-1.35299435e-01  2.45365038e-01  6.69176445e-01]
 [-1.37368925e-01  7.54571422e-01  7.12177386e-01]
 [ 1.27508099e-01  3.89903497e-02  1.92091611e-02]
 [-1.00949570e-02 -7.65102151e-02 -7.45843055e-02]
 [ 6.70472331e-02 -8.50731321e-03 -4.70521251e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 8.29115133e-03 -9.07913701e-03 -2.88477381e-02]
 [-1.23168026e-01 -1.59206726e-01 -7.44518408e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.07645674]
curr_Stock_Price:  99.69384536217777
curr_Factors:  [99.69384536 -0.15554339 -0.9770018 ]
mat_Sqrt:  [[32.12256547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03976251 -0.10580076  0.04905189]
Stock Position:  -0.03976250757988924
Bond Position:  [3.88762054]


portfolio before change:  [-0.31039132]
curr_Stock_Price:  105.62603860249821
curr_Factors:  [105.6260386   -1.2259001   -0.96846771]
mat_Sqrt:  [[11.76980217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00436546 0.07919123 1.90897414]
Stock Position:  0.004365456817099289
Bond Position:  [-0.77149723]


portfolio before change:  [-0.30668236]
curr_Stock_Price:  106.56404053514935
curr_Factors:  [106.56404054  -1.40057832  -0.97321368]
mat_Sqrt:  [[ 9.92398064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01632711 0.24353688 2.03164385]
Stock Position:  0.016327109792711098
Bond Position:  [-2.04656515]


portfolio before change:  [-0.30019807]
curr_Stock_Price:  107.02387874457845
curr_Factors:  [107.02387874  -0.89061761  -0.97983394]
mat_Sqrt:  [[16.48746553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00845418 0.01258408 0.05479839]
Stock Position:  0.008454181381546863
Bond Position:  [-1.20499735]


portfolio before change:  [-0.3016142]
curr_Stock_Price:  106.92765624690544
curr_Factors:  [106.92765625  -0.77808149  -1.04584604]
mat_Sqrt:  [[17.2571227   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237218 -0.02469357 -0.21276826]
Stock Position:  -0.0023721797391113857
Bond Position:  [-0.04796258]


portfolio before change:  [-0.300765]
curr_Stock_Price:  106.55956296768214
curr_Factors:  [106.55956297  -0.50932109  -1.05025304]
mat_Sqrt:  [[22.40154611  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00248671 -0.00274572 -0.13422662]
Stock Position:  0.002486712747041201
Bond Position:  [-0.56574803]


portfolio before change:  [-0.31062671]
curr_Stock_Price:  102.70758747414172
curr_Factors:  [102.70758747  -0.51452313  -1.07898444]
mat_Sqrt:  [[20.87137126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00229976 -0.01197701  0.13962421]
Stock Position:  -0.0022997602052979927
Bond Position:  [-0.07442388]


portfolio before change:  [-0.31055803]
curr_Stock_Price:  102.66154124688877
curr_Factors:  [ 1.02661541e+02 -9.30864498e-02 -1.06681008e+00]
mat_Sqrt:  [[32.18630476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.70681400e-05 -2.93027887e-03 -8.22945672e-02]
Stock Position:  1.7068140009707265e-05
Bond Position:  [-0.31231027]


portfolio before change:  [-0.3108601]
curr_Stock_Price:  94.11510485959815
curr_Factors:  [ 9.41151049e+01  3.43340974e-03 -1.02733667e+00]
mat_Sqrt:  [[33.8052222   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00505435 -0.05138375 -0.21239038]
Stock Position:  -0.005054348706459112
Bond Position:  [0.16483046]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.31488485]
Stock Price:  94.92771029913187
PL:  [-0.31488485]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.16868245e+00 -3.01113377e-01 -1.77777257e-02]
 [ 6.99377273e-02  2.02024562e-02  4.10967842e-02]
 [-1.14415298e-01  5.41894793e-01  6.78949167e-01]
 [ 1.04651942e-01  2.61288982e-02  1.23724167e-02]
 [-1.65149939e-02 -8.38049587e-02 -8.49896976e-02]
 [ 3.97405868e-02  1.26473278e-02 -4.44384007e-02]
 [-3.35583547e-02 -9.36147421e-03 -7.91581849e-03]
 [-1.34823454e-03 -3.79606756e-02 -5.13122385e-03]
 [ 6.38949051e-01 -1.48816864e-02  1.84222852e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.28413222]
curr_Stock_Price:  100.28895996938012
curr_Factors:  [100.28895997  -0.63627784  -0.98125646]
mat_Sqrt:  [[19.89605191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06201109 -0.09718392 -0.0507149 ]
Stock Position:  -0.06201108769370447
Bond Position:  [10.50315971]


portfolio before change:  [4.46753736]
curr_Stock_Price:  97.41605044218323
curr_Factors:  [97.41605044 -0.28462552 -0.92948167]
mat_Sqrt:  [[28.93013518  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00284998 0.00652031 0.11723769]
Stock Position:  0.002849982615582671
Bond Position:  [4.18990331]


portfolio before change:  [4.48042214]
curr_Stock_Price:  101.2017939029249
curr_Factors:  [101.2017939   -0.39416756  -0.93829303]
mat_Sqrt:  [[26.69979522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00504829 0.17489579 1.93685299]
Stock Position:  0.005048294577671123
Bond Position:  [3.96952567]


portfolio before change:  [4.48042485]
curr_Stock_Price:  100.80907697401885
curr_Factors:  [100.80907697  -0.35028448  -0.94683115]
mat_Sqrt:  [[27.55303723  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00408343 0.00843307 0.03529506]
Stock Position:  0.004083433326440955
Bond Position:  [4.0687777]


portfolio before change:  [4.50132105]
curr_Stock_Price:  105.42805849338221
curr_Factors:  [105.42805849  -0.25884252  -0.93838615]
mat_Sqrt:  [[31.8424446   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016007  -0.02704793 -0.24245195]
Stock Position:  -0.0016006955343409103
Bond Position:  [4.67007927]


portfolio before change:  [4.50539116]
curr_Stock_Price:  104.34447081254962
curr_Factors:  [ 1.04344471e+02  2.13829101e-02 -9.40356743e-01]
mat_Sqrt:  [[41.62595171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079881  0.00408191 -0.12677039]
Stock Position:  0.0007988108350657786
Bond Position:  [4.42203967]


portfolio before change:  [4.51248304]
curr_Stock_Price:  110.4539268397395
curr_Factors:  [110.45392684  -0.23576176  -0.91334447]
mat_Sqrt:  [[35.00504709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105942 -0.0030214  -0.02258163]
Stock Position:  -0.0010594205791513685
Bond Position:  [4.6295002]


portfolio before change:  [4.50819537]
curr_Stock_Price:  116.68657367949125
curr_Factors:  [116.68657368  -0.52510485  -0.93366931]
mat_Sqrt:  [[27.13209436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037389 -0.01225176 -0.01463795]
Stock Position:  -0.00037388679046782453
Bond Position:  [4.55182294]


portfolio before change:  [4.51085746]
curr_Stock_Price:  115.65521434383278
curr_Factors:  [115.65521434  -0.81813501  -0.93489631]
mat_Sqrt:  [[20.03703182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03361355 -0.00480304  0.52553652]
Stock Position:  0.03361354505706802
Bond Position:  [0.6232757]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.63830615]
Stock Price:  119.43752794594319
PL:  [-14.7992218]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.24217673e+00 -3.10981318e-01 -3.15471930e-02]
 [ 6.76884673e-02  2.31991689e-02  5.13437011e-02]
 [-1.39558202e-01  7.21784162e-01  7.90453384e-01]
 [ 1.26468902e-01  3.84055806e-02  1.88983162e-02]
 [-5.21094451e-02 -1.24249024e-01 -1.42680054e-01]
 [ 8.04862342e-02 -1.76464196e-02 -4.86389450e-02]
 [-3.63689950e-02 -1.24326284e-02  7.17158283e-03]
 [ 3.30814417e-06  1.88990688e-03 -3.25876575e-02]
 [ 1.57045344e-01  3.42162596e-02  4.39373111e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.04933822]
curr_Stock_Price:  100.80281924573504
curr_Factors:  [100.80281925  -0.70558595  -1.01606731]
mat_Sqrt:  [[18.0205554   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07281102 -0.10036879 -0.08999536]
Stock Position:  -0.07281102276578978
Bond Position:  [15.38889459]


portfolio before change:  [8.22013694]
curr_Stock_Price:  98.56274157497715
curr_Factors:  [98.56274157 -0.15155921 -1.09388565]
mat_Sqrt:  [[28.36762306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0029225  0.0074875  0.14646929]
Stock Position:  0.0029225031199552037
Bond Position:  [7.93208702]


portfolio before change:  [8.23889447]
curr_Stock_Price:  103.6236416526398
curr_Factors:  [ 1.03623642e+02  1.29201731e-02 -1.09864652e+00]
mat_Sqrt:  [[34.98919009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00483366 0.23295484 2.25494349]
Stock Position:  0.004833664181437506
Bond Position:  [7.73801258]


portfolio before change:  [8.25767068]
curr_Stock_Price:  106.707479456905
curr_Factors:  [106.70747946  -0.34973209  -1.05767578]
mat_Sqrt:  [[26.11953193  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00528976 0.01239535 0.05391164]
Stock Position:  0.005289758318688174
Bond Position:  [7.6932139]


portfolio before change:  [8.27399489]
curr_Stock_Price:  109.06612140889257
curr_Factors:  [109.06612141  -0.8846299   -1.07917594]
mat_Sqrt:  [[15.30452395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00696501 -0.0401012  -0.40702648]
Stock Position:  -0.006965006908839507
Bond Position:  [9.03364118]


portfolio before change:  [8.28926214]
curr_Stock_Price:  107.52279193968852
curr_Factors:  [107.52279194  -0.99421806  -1.08064839]
mat_Sqrt:  [[13.50198073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00495896 -0.00569536 -0.13875337]
Stock Position:  0.004958960626173032
Bond Position:  [7.75606085]


portfolio before change:  [8.29875844]
curr_Stock_Price:  108.65554852580354
curr_Factors:  [108.65554853  -0.89947133  -1.16847428]
mat_Sqrt:  [[13.7389816   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027253  -0.00401261  0.02045853]
Stock Position:  -0.0027253039948410217
Bond Position:  [8.59487784]


portfolio before change:  [8.30600396]
curr_Stock_Price:  107.57419855065591
curr_Factors:  [107.57419855  -0.70401045  -1.13309912]
mat_Sqrt:  [[17.13411083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036552  0.00060996 -0.09296352]
Stock Position:  -0.00036551905282372003
Bond Position:  [8.34532438]


portfolio before change:  [8.31089321]
curr_Stock_Price:  105.61658954946627
curr_Factors:  [105.61658955  -0.88002741  -1.13944832]
mat_Sqrt:  [[14.01796501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01234119 0.01104325 0.12534092]
Stock Position:  0.01234119037237814
Bond Position:  [7.00745877]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.32185373]
Stock Price:  106.22073859365433
PL:  [2.10111514]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.23235499e+00 -3.15149501e-01 -1.81544117e-02]
 [ 2.43527193e-02  6.59084520e-02 -5.17116347e-03]
 [-7.85596495e-02  3.49120294e-01  4.14917288e-01]
 [ 1.19547642e-01  4.51229688e-02  4.21459289e-02]
 [ 4.85781913e-02  1.93733553e-02  4.18689903e-02]
 [-1.07337997e-01 -6.22253053e-02  1.67179742e-02]
 [ 7.40039228e-03  1.17161666e-01  8.52569088e-02]
 [-3.84148836e-02 -1.01696077e-01  5.76638981e-02]
 [-3.07393502e-02 -2.01183889e-02 -7.59222040e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.83431449]
curr_Stock_Price:  100.50052224161992
curr_Factors:  [100.50052224  -0.56343811  -1.00565984]
mat_Sqrt:  [[20.92751858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06213782 -0.10171406 -0.05178948]
Stock Position:  -0.06213781905212542
Bond Position:  [12.07919775]


portfolio before change:  [5.93623396]
curr_Stock_Price:  98.95752691221732
curr_Factors:  [98.95752691 -0.73576152 -0.9773767 ]
mat_Sqrt:  [[17.84195165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00205979  0.02127186 -0.01475189]
Stock Position:  0.002059789600331911
Bond Position:  [5.73240227]


portfolio before change:  [5.94005585]
curr_Stock_Price:  99.42115296675735
curr_Factors:  [99.42115297 -0.8790745  -0.98726912]
mat_Sqrt:  [[15.37928196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00503267 0.11267809 1.18364353]
Stock Position:  0.005032671159523266
Bond Position:  [5.43970188]


portfolio before change:  [5.94077715]
curr_Stock_Price:  99.02390197052874
curr_Factors:  [99.02390197 -0.67246745 -0.94411013]
mat_Sqrt:  [[19.66388436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00698546 0.01456338 0.1202306 ]
Stock Position:  0.006985462734979577
Bond Position:  [5.24904937]


portfolio before change:  [5.93093449]
curr_Stock_Price:  97.23907573459839
curr_Factors:  [97.23907573 -0.76101432 -0.93486117]
mat_Sqrt:  [[17.83739599  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00342422 0.00625272 0.11944058]
Stock Position:  0.0034242236257603334
Bond Position:  [5.59796615]


portfolio before change:  [5.93040807]
curr_Stock_Price:  96.26773200972204
curr_Factors:  [96.26773201 -0.46886272 -0.95878658]
mat_Sqrt:  [[23.09194574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00505056 -0.02008313  0.04769173]
Stock Position:  -0.005050555013164005
Bond Position:  [6.41661355]


portfolio before change:  [5.93023941]
curr_Stock_Price:  96.93652393005043
curr_Factors:  [96.93652393 -0.34220744 -0.95152879]
mat_Sqrt:  [[26.58428207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00183262 0.03781377 0.24321423]
Stock Position:  0.0018326208942860177
Bond Position:  [5.75259151]


portfolio before change:  [5.93477844]
curr_Stock_Price:  97.84343077749931
curr_Factors:  [97.84343078 -1.03486485 -0.89248048]
mat_Sqrt:  [[14.23954887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332896 -0.03282227  0.16449905]
Stock Position:  -0.003328961810706601
Bond Position:  [6.26049549]


portfolio before change:  [5.94226912]
curr_Stock_Price:  96.53382048316053
curr_Factors:  [96.53382048 -0.73199662 -0.86125644]
mat_Sqrt:  [[19.62178353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0025657  -0.00649318 -0.21658492]
Stock Position:  -0.0025656971504972354
Bond Position:  [6.18994567]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.94973922]
Stock Price:  94.82888275066652
PL:  [5.94973922]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-5.05289283e-01 -6.43848871e-02 -7.06316162e-02]
 [ 2.60747700e-02  5.54680609e-02 -5.34405626e-02]
 [-4.63118766e-02  1.94467838e-01  1.99099064e-01]
 [ 1.96734351e-01  1.39404939e-01  1.86967738e-01]
 [ 4.74836713e-02 -7.32317966e-02  9.27980024e-02]
 [-6.03215862e-02  1.06143609e-01 -3.56872732e-02]
 [-3.67604576e-02  1.45824782e-02  4.71952605e-02]
 [-3.83955871e-02 -1.01810984e-01  5.71001264e-02]
 [ 9.24435033e-02  1.77524874e-02 -9.57449401e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.74253373]
curr_Stock_Price:  97.6922816457767
curr_Factors:  [97.69228165 -1.41969793 -0.983868  ]
mat_Sqrt:  [[ 8.8308972   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06033922 -0.02078013 -0.20149234]
Stock Position:  -0.060339215779455446
Bond Position:  [-8.84785807]


portfolio before change:  [-14.68822031]
curr_Stock_Price:  96.71881102227363
curr_Factors:  [96.71881102 -1.67017524 -1.00280389]
mat_Sqrt:  [[ 6.67806843  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00396651  0.01790224 -0.15245105]
Stock Position:  0.003966510923591274
Bond Position:  [-15.07185653]


portfolio before change:  [-14.69611203]
curr_Stock_Price:  96.62958695287625
curr_Factors:  [96.62958695 -1.31712239 -0.97764605]
mat_Sqrt:  [[ 9.73878668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00349372 0.06276422 0.56797421]
Stock Position:  0.003493723810090385
Bond Position:  [-15.03370912]


portfolio before change:  [-14.70489071]
curr_Stock_Price:  96.26895624898377
curr_Factors:  [96.26895625 -1.23745308 -1.01909564]
mat_Sqrt:  [[10.08044277  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02612533 0.04499275 0.53336692]
Stock Position:  0.0261253300994762
Bond Position:  [-17.21994897]


portfolio before change:  [-14.66569801]
curr_Stock_Price:  98.09878286872036
curr_Factors:  [98.09878287 -1.70826784 -1.02267232]
mat_Sqrt:  [[ 6.39192069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00805354 -0.02363546  0.26472687]
Stock Position:  0.008053542715338612
Bond Position:  [-15.45574075]


portfolio before change:  [-14.67583637]
curr_Stock_Price:  97.79971508485352
curr_Factors:  [97.79971508 -1.64154732 -0.95260381]
mat_Sqrt:  [[ 7.30654507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00628748  0.0342577  -0.10180586]
Stock Position:  -0.006287478743716568
Bond Position:  [-14.06092274]


portfolio before change:  [-14.68556277]
curr_Stock_Price:  98.22821507543736
curr_Factors:  [98.22821508 -1.45122533 -0.95365936]
mat_Sqrt:  [[ 8.86764106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027234   0.00470647  0.13463494]
Stock Position:  -0.0027233995300750863
Bond Position:  [-14.4180481]


portfolio before change:  [-14.68950353]
curr_Stock_Price:  97.02748482471354
curr_Factors:  [97.02748482 -1.78389651 -0.9726338 ]
mat_Sqrt:  [[ 6.16238563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00771165 -0.03285935  0.16289077]
Stock Position:  -0.007711648623407407
Bond Position:  [-13.94126166]


portfolio before change:  [-14.69058062]
curr_Stock_Price:  96.2630199939906
curr_Factors:  [96.26301999 -1.49588362 -0.97711435]
mat_Sqrt:  [[ 8.11801985  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00942636  0.00572959 -0.27313366]
Stock Position:  0.009426357909324275
Bond Position:  [-15.5979903]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.70230575]
Stock Price:  95.84672137865117
PL:  [-14.70230575]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.65329396e-01 -1.62434865e-01 -1.06034145e-01]
 [ 1.80637000e-02  7.33199051e-02 -1.70640024e-03]
 [-8.52431452e-02  3.88773297e-01  4.63473306e-01]
 [ 1.03687504e-01  2.55861964e-02  1.20839335e-02]
 [ 5.18764753e-02  5.59824177e-03  2.79128859e-02]
 [-4.31326147e-02 -2.91232034e-03 -1.55065319e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 1.22821733e-02  1.82682584e-02 -4.90401844e-02]
 [-3.40267607e-02  5.70856005e-02 -1.44476472e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.84827141]
curr_Stock_Price:  100.22947554226079
curr_Factors:  [100.22947554  -1.66273379  -1.0160869 ]
mat_Sqrt:  [[ 6.88015803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11920226 -0.05242563 -0.3024859 ]
Stock Position:  -0.11920226248958157
Bond Position:  [15.79585166]


portfolio before change:  [3.98893992]
curr_Stock_Price:  99.11566609900723
curr_Factors:  [99.1156661  -1.02301176 -0.96018025]
mat_Sqrt:  [[13.64121202  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239581  0.0236639  -0.00486788]
Stock Position:  0.002395809509546654
Bond Position:  [3.75147766]


portfolio before change:  [3.99215281]
curr_Stock_Price:  99.67359123821379
curr_Factors:  [99.67359124 -0.7920481  -0.95729658]
mat_Sqrt:  [[17.3320272   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0051189  0.12547604 1.32216033]
Stock Position:  0.005118902883330658
Bond Position:  [3.48193337]


portfolio before change:  [3.9975968]
curr_Stock_Price:  100.39690856883787
curr_Factors:  [100.39690857  -0.54690117  -1.01513311]
mat_Sqrt:  [[21.05413828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00529002 0.00825791 0.0344721 ]
Stock Position:  0.0052900235437265295
Bond Position:  [3.46649479]


portfolio before change:  [4.00504538]
curr_Stock_Price:  101.47722479860475
curr_Factors:  [101.4772248  -0.7430068  -0.9846153]
mat_Sqrt:  [[18.03316005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00325605 0.00180682 0.07962769]
Stock Position:  0.0032560519292588927
Bond Position:  [3.67463026]


portfolio before change:  [4.00282849]
curr_Stock_Price:  100.23195389127919
curr_Factors:  [100.23195389  -0.43687282  -0.98569718]
mat_Sqrt:  [[24.16528364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194048 -0.00093995 -0.04423582]
Stock Position:  -0.001940484038898127
Bond Position:  [4.19732699]


portfolio before change:  [3.99685777]
curr_Stock_Price:  104.39065837758379
curr_Factors:  [104.39065838  -0.52164226  -0.95905969]
mat_Sqrt:  [[23.74657319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202131 -0.01197701  0.13962421]
Stock Position:  -0.002021308450738918
Bond Position:  [4.20786349]


portfolio before change:  [3.99936956]
curr_Stock_Price:  104.18914230992965
curr_Factors:  [104.18914231  -0.81148609  -0.90955258]
mat_Sqrt:  [[18.6373801   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00032198  0.00589606 -0.139898  ]
Stock Position:  0.00032198088775266633
Bond Position:  [3.96582265]


portfolio before change:  [4.00100814]
curr_Stock_Price:  103.11818634248195
curr_Factors:  [103.11818634  -0.20658358  -0.93819917]
mat_Sqrt:  [[32.82180289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00077154  0.0184243  -0.04121512]
Stock Position:  -0.000771539730687986
Bond Position:  [4.08056792]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.99985899]
Stock Price:  107.25269559325719
PL:  [-3.2528366]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.22102749e+00 -3.13871908e-01 -1.55198324e-02]
 [ 1.20703386e-02  8.71156183e-02  3.03147006e-02]
 [-6.71236616e-02  2.93642375e-01  3.38062880e-01]
 [ 1.56241410e-01  8.38202782e-02  9.61830693e-02]
 [ 4.73078431e-02  3.50358003e-02  2.65962607e-02]
 [-9.33081527e-02 -4.50332954e-02  7.83871996e-03]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 4.37262889e-03  4.12582715e-03 -3.60208981e-02]
 [ 1.36294598e-01  7.20219075e-02  1.14378611e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.11407056]
curr_Stock_Price:  100.40222641849688
curr_Factors:  [100.40222642  -0.52278768  -1.02220933]
mat_Sqrt:  [[21.41705089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06015134 -0.10130172 -0.04427376]
Stock Position:  -0.0601513395516466
Bond Position:  [11.15339897]


portfolio before change:  [5.16864262]
curr_Stock_Price:  99.58771481435734
curr_Factors:  [99.58771481 -0.8158553  -0.99205663]
mat_Sqrt:  [[16.33200834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00220675 0.02811644 0.0864794 ]
Stock Position:  0.002206752610115746
Bond Position:  [4.94887717]


portfolio before change:  [5.16929029]
curr_Stock_Price:  98.75962945154535
curr_Factors:  [98.75962945 -1.02986907 -1.0153121 ]
mat_Sqrt:  [[12.77522486  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00483926 0.09477267 0.9643993 ]
Stock Position:  0.004839259920242911
Bond Position:  [4.69136678]


portfolio before change:  [5.16988713]
curr_Stock_Price:  98.39812080567053
curr_Factors:  [98.39812081 -0.63395829 -0.98811102]
mat_Sqrt:  [[19.43260634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00993096 0.02705288 0.27438352]
Stock Position:  0.009930960163909113
Bond Position:  [4.19269931]


portfolio before change:  [5.17549893]
curr_Stock_Price:  98.75205675997913
curr_Factors:  [98.75205676 -0.77146715 -0.9762679 ]
mat_Sqrt:  [[17.19944616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.003482   0.01130776 0.07587173]
Stock Position:  0.0034819978693463225
Bond Position:  [4.83164448]


portfolio before change:  [5.17818403]
curr_Stock_Price:  98.82921904699968
curr_Factors:  [98.82921905 -0.90622705 -0.94841882]
mat_Sqrt:  [[15.46759866  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00652334 -0.01453443  0.02236169]
Stock Position:  -0.006523343782329706
Bond Position:  [5.822881]


portfolio before change:  [5.16885428]
curr_Stock_Price:  100.7058516632608
curr_Factors:  [100.70585166  -1.09068016  -0.97106587]
mat_Sqrt:  [[12.81296922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374614 -0.01197701  0.13962421]
Stock Position:  -0.0037461378564022816
Bond Position:  [5.54611229]


portfolio before change:  [5.1663548]
curr_Stock_Price:  102.11349604925167
curr_Factors:  [102.11349605  -1.39168002  -0.9250366 ]
mat_Sqrt:  [[10.06806246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00021235  0.0013316  -0.1027576 ]
Stock Position:  -0.00021234723171068579
Bond Position:  [5.18803832]


portfolio before change:  [5.16879141]
curr_Stock_Price:  102.85784164286956
curr_Factors:  [102.85784164  -1.43505398  -0.94182062]
mat_Sqrt:  [[ 9.54935159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01605667 0.02324497 0.03262903]
Stock Position:  0.01605666628166337
Bond Position:  [3.51723737]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.1549039]
Stock Price:  101.88338227314489
PL:  [3.27152163]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-9.45580164e-01 -2.16813122e-01 -9.04004362e-02]
 [-1.22796085e-02  1.42036011e-01  1.77555425e-01]
 [-8.86568775e-02  3.69661919e-01  4.41759293e-01]
 [ 1.06878770e-01  2.73819626e-02  1.30385065e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [-7.22309716e-02 -2.79993845e-02 -1.59574883e-03]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-3.44408252e-02 -9.15631493e-02  4.81941262e-02]
 [-3.52078316e-02  7.74373497e-02 -3.71495501e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.9784487]
curr_Stock_Price:  100.79314454621233
curr_Factors:  [100.79314455  -1.48384788  -1.00236257]
mat_Sqrt:  [[ 8.38848469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12019929 -0.06997613 -0.25788728]
Stock Position:  -0.1201992857167777
Bond Position:  [20.09371268]


portfolio before change:  [7.96146283]
curr_Stock_Price:  101.01806466637348
curr_Factors:  [101.01806467  -1.3424062   -0.99727041]
mat_Sqrt:  [[ 9.73397898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0054404  0.04584193 0.5065162 ]
Stock Position:  0.005440398039370683
Bond Position:  [7.41188435]


portfolio before change:  [7.97119311]
curr_Stock_Price:  102.125228053083
curr_Factors:  [102.12522805  -1.61825295  -0.99511838]
mat_Sqrt:  [[ 7.48445684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01028448 0.11930787 1.2602163 ]
Stock Position:  0.010284484957149573
Bond Position:  [6.92088774]


portfolio before change:  [7.97117984]
curr_Stock_Price:  101.78738143022704
curr_Factors:  [101.78738143  -1.30646695  -1.05867545]
mat_Sqrt:  [[ 9.5614916   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01204096 0.00883749 0.03719523]
Stock Position:  0.012040962719646655
Bond Position:  [6.74556177]


portfolio before change:  [7.96595155]
curr_Stock_Price:  101.07299415779873
curr_Factors:  [101.07299416  -1.14985825  -1.08436186]
mat_Sqrt:  [[10.82245199  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00538892 -0.00140152  0.08089603]
Stock Position:  0.005388916992251973
Bond Position:  [7.42127758]


portfolio before change:  [7.96101656]
curr_Stock_Price:  99.4684858025587
curr_Factors:  [99.4684858  -0.4892758  -1.09833473]
mat_Sqrt:  [[20.33269808  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00384957 -0.00903676 -0.00455223]
Stock Position:  -0.0038495654902349786
Bond Position:  [8.34392701]


portfolio before change:  [7.95702912]
curr_Stock_Price:  101.58832121479062
curr_Factors:  [101.58832121  -0.51653264  -1.16578396]
mat_Sqrt:  [[18.88960903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254103 -0.01197701  0.13962421]
Stock Position:  -0.002541034542930312
Bond Position:  [8.21516855]


portfolio before change:  [7.96707649]
curr_Stock_Price:  99.25117875147352
curr_Factors:  [99.25117875 -0.63980849 -1.17330797]
mat_Sqrt:  [[16.1923244   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026737  -0.02955188  0.13748443]
Stock Position:  -0.0026737044574146125
Bond Position:  [8.23244481]


portfolio before change:  [7.96836733]
curr_Stock_Price:  100.3082917886064
curr_Factors:  [100.30829179  -0.52779837  -1.16787694]
mat_Sqrt:  [[18.40409242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014662   0.0249928  -0.10597733]
Stock Position:  -0.0014662021015533994
Bond Position:  [8.11543956]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.97395571]
Stock Price:  99.26502478892706
PL:  [7.97395571]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-6.98496476e-01 -1.43486213e-01 -7.68381316e-02]
 [ 5.86130234e-03  1.00755104e-01  7.33985757e-02]
 [-7.53795063e-02  3.04471428e-01  3.78833124e-01]
 [ 1.01579776e-01  2.44001508e-02  1.14534688e-02]
 [ 4.72212334e-02  3.55938617e-02  2.65713008e-02]
 [-1.03838133e-01 -5.89637311e-02  1.50002007e-02]
 [ 1.24419298e-01  3.31489330e-01  1.86653688e-01]
 [-4.00435353e-02 -1.22172802e-01  3.08974097e-02]
 [-1.85716273e-01 -6.70771408e-02 -5.15614375e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.32873945]
curr_Stock_Price:  99.1135119301932
curr_Factors:  [99.11351193 -1.33893009 -1.03059835]
mat_Sqrt:  [[ 9.26957326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08020542 -0.04630998 -0.2191978 ]
Stock Position:  -0.08020541762667743
Bond Position:  [3.62070116]


portfolio before change:  [-4.38080186]
curr_Stock_Price:  99.78520232949583
curr_Factors:  [99.78520233 -1.39801154 -1.00542117]
mat_Sqrt:  [[ 9.02128864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00459028 0.03251857 0.20938571]
Stock Position:  0.004590283614321906
Bond Position:  [-4.83884424]


portfolio before change:  [-4.38301967]
curr_Stock_Price:  99.82925627075045
curr_Factors:  [99.82925627 -1.20592897 -0.98927315]
mat_Sqrt:  [[11.11459567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00576714 0.09826773 1.08070546]
Stock Position:  0.005767141969829089
Bond Position:  [-4.95874916]


portfolio before change:  [-4.38668136]
curr_Stock_Price:  99.624354734467
curr_Factors:  [99.62435473 -1.00314337 -0.96932504]
mat_Sqrt:  [[13.85904722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00785757 0.00787511 0.03267356]
Stock Position:  0.007857565076379728
Bond Position:  [-5.16948621]


portfolio before change:  [-4.39853826]
curr_Stock_Price:  98.44440720482216
curr_Factors:  [98.4444072  -0.82821066 -0.96688293]
mat_Sqrt:  [[16.35278803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00366363 0.01148787 0.07580053]
Stock Position:  0.003663634849313017
Bond Position:  [-4.75920262]


portfolio before change:  [-4.41814735]
curr_Stock_Price:  93.74172888801318
curr_Factors:  [93.74172889 -0.35156496 -0.9627669 ]
mat_Sqrt:  [[25.1840681   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0044795  -0.01903046  0.0427914 ]
Stock Position:  -0.004479504669286091
Bond Position:  [-3.99823084]


portfolio before change:  [-4.41928738]
curr_Stock_Price:  93.54983417529078
curr_Factors:  [93.54983418 -0.5391796  -0.95737661]
mat_Sqrt:  [[20.94579829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01098955 0.10698772 0.53247102]
Stock Position:  0.01098954528442929
Bond Position:  [-5.44735751]


portfolio before change:  [-4.42371076]
curr_Stock_Price:  93.39523022636057
curr_Factors:  [93.39523023  0.13575949 -0.92999898]
mat_Sqrt:  [[42.20762073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139015 -0.0394311   0.08814171]
Stock Position:  -0.0013901529068625306
Bond Position:  [-4.29387711]


portfolio before change:  [-4.4304758]
curr_Stock_Price:  96.71684999827573
curr_Factors:  [96.71685     0.17580667 -0.89528558]
mat_Sqrt:  [[47.10168318  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445702 -0.02164905 -0.14709043]
Stock Position:  -0.00445702271522915
Bond Position:  [-3.9994066]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.42017774]
Stock Price:  93.95755077909106
PL:  [-4.42017774]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-6.51697600e-01 -1.21802760e-01 -8.21331147e-02]
 [ 4.95899402e-03  1.03063802e-01  7.47006326e-02]
 [-9.36988819e-02  3.99287866e-01  5.04080035e-01]
 [ 1.04985436e-01  2.63165594e-02  1.24721715e-02]
 [ 4.73952843e-02  3.44723813e-02  2.66214602e-02]
 [-1.00467942e-02  1.94678244e-02 -3.17311931e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-3.87491894e-02 -9.16427569e-02  4.78389096e-02]
 [ 5.73766802e-02  4.88749297e-02 -7.53106340e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.71511888]
curr_Stock_Price:  98.92430477134593
curr_Factors:  [98.92430477 -1.45653647 -1.00375068]
mat_Sqrt:  [[ 8.44916659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08205849 -0.03931167 -0.23430291]
Stock Position:  -0.08205848806597546
Bond Position:  [2.40246]


portfolio before change:  [-5.7992549]
curr_Stock_Price:  99.96426478727287
curr_Factors:  [99.96426479 -1.08122238 -0.99322588]
mat_Sqrt:  [[12.55808291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00328434 0.0332637  0.21310011]
Stock Position:  0.003284339464185568
Bond Position:  [-6.12757148]


portfolio before change:  [-5.79760078]
curr_Stock_Price:  101.40098189699835
curr_Factors:  [101.4009819   -1.25102597  -0.94319512]
mat_Sqrt:  [[11.30066625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0080261  0.1288696  1.43800003]
Stock Position:  0.008026103661148329
Bond Position:  [-6.61145557]


portfolio before change:  [-5.80369372]
curr_Stock_Price:  101.05381642781927
curr_Factors:  [101.05381643  -1.0621665   -0.93517868]
mat_Sqrt:  [[13.71250286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00823359 0.00849363 0.03557963]
Stock Position:  0.008233591914066774
Bond Position:  [-6.63572961]


portfolio before change:  [-5.82206583]
curr_Stock_Price:  99.22552437444983
curr_Factors:  [99.22552437 -0.67952029 -0.96931032]
mat_Sqrt:  [[19.07855012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00313787 0.01112591 0.07594362]
Stock Position:  0.0031378701237788557
Bond Position:  [-6.13342264]


portfolio before change:  [-5.81984046]
curr_Stock_Price:  100.91228691404977
curr_Factors:  [100.91228691  -0.94988886  -0.90410875]
mat_Sqrt:  [[15.80385791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079411  0.00628321 -0.09052026]
Stock Position:  -0.0007941126725725269
Bond Position:  [-5.73970474]


portfolio before change:  [-5.82188989]
curr_Stock_Price:  99.87824815970829
curr_Factors:  [99.87824816 -1.15923556 -0.87761167]
mat_Sqrt:  [[13.02804962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00368429 -0.01197701  0.13962421]
Stock Position:  -0.003684292773742354
Bond Position:  [-5.45390918]


portfolio before change:  [-5.82088561]
curr_Stock_Price:  98.86532236070491
curr_Factors:  [98.86532236 -1.21957366 -0.83550748]
mat_Sqrt:  [[12.66291186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00376616 -0.02957757  0.13647109]
Stock Position:  -0.0037661647524842336
Bond Position:  [-5.44854252]


portfolio before change:  [-5.81722473]
curr_Stock_Price:  97.169743605942
curr_Factors:  [97.16974361 -1.23538352 -0.78648775]
mat_Sqrt:  [[12.86599915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00404015  0.01577432 -0.21484028]
Stock Position:  0.004040145970940212
Bond Position:  [-6.20980468]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.82472863]
Stock Price:  96.08111483558949
PL:  [-5.82472863]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.57479651e-01 -1.83531861e-01  1.01553481e-02]
 [ 4.19664481e-02  4.43637180e-02 -1.99110680e-02]
 [-6.31908306e-02  3.23848275e-01  3.36446416e-01]
 [ 2.13821207e-01  1.53537252e-01  2.02755282e-01]
 [ 4.82802817e-02  1.85745775e-02  4.72025227e-02]
 [-5.21848690e-02  4.66651838e-02 -2.38878417e-02]
 [ 9.42728414e-02  2.62537008e-01  1.44951196e-01]
 [-3.93630423e-02 -1.14624664e-01  3.91212095e-02]
 [-1.99639554e-02 -2.72856329e-01 -1.59131892e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.5774024]
curr_Stock_Price:  97.44186658522128
curr_Factors:  [97.44186659 -0.43541604 -0.92093863]
mat_Sqrt:  [[25.10083956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03158739 -0.05923465  0.02897038]
Stock Position:  -0.03158738898322668
Bond Position:  [-13.49946826]


portfolio before change:  [-16.5639211]
curr_Stock_Price:  96.8013350541526
curr_Factors:  [96.80133505 -0.80469161 -0.98324264]
mat_Sqrt:  [[16.19538844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00289946  0.01431833 -0.05680073]
Stock Position:  0.0028994565024797075
Bond Position:  [-16.84459236]


portfolio before change:  [-16.5713892]
curr_Stock_Price:  97.13115598092507
curr_Factors:  [97.13115598 -0.74571805 -0.99112696]
mat_Sqrt:  [[17.10237222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00418604 0.10452158 0.95978798]
Stock Position:  0.004186042607852522
Bond Position:  [-16.97798436]


portfolio before change:  [-16.58339731]
curr_Stock_Price:  96.29098551868279
curr_Factors:  [96.29098552 -0.71587735 -1.00960437]
mat_Sqrt:  [[17.14819622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01671016 0.04955394 0.57840438]
Stock Position:  0.016710160782706127
Bond Position:  [-18.19243516]


portfolio before change:  [-16.58595372]
curr_Stock_Price:  96.68248849898156
curr_Factors:  [96.6824885  -0.63121608 -1.04028274]
mat_Sqrt:  [[18.1729363   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00339554 0.00599492 0.13465566]
Stock Position:  0.003395542419642051
Bond Position:  [-16.91424321]


portfolio before change:  [-16.59885263]
curr_Stock_Price:  95.3749892865388
curr_Factors:  [95.37498929 -1.12343565 -1.05533304]
mat_Sqrt:  [[10.79461811  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00440363  0.01506112 -0.06814536]
Stock Position:  -0.0044036262293160365
Bond Position:  [-16.17885682]


portfolio before change:  [-16.60046164]
curr_Stock_Price:  93.90292090890472
curr_Factors:  [93.90292091 -1.1190198  -1.03107871]
mat_Sqrt:  [[10.93712518  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01622465 0.08473346 0.41350541]
Stock Position:  0.016224649506743665
Bond Position:  [-18.12400362]


portfolio before change:  [-16.60589678]
curr_Stock_Price:  94.12660069733272
curr_Factors:  [94.1266007  -1.34046679 -1.04330649]
mat_Sqrt:  [[ 8.67866241  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00631147 -0.03699495  0.11160192]
Stock Position:  -0.006311470345667061
Bond Position:  [-16.01181953]


portfolio before change:  [-16.60013932]
curr_Stock_Price:  91.94559220147084
curr_Factors:  [91.9455922  -0.80123316 -1.01646207]
mat_Sqrt:  [[14.93192873  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00724241 -0.088064   -0.45395899]
Stock Position:  -0.007242412132972311
Bond Position:  [-15.93423145]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.60148838]
Stock Price:  91.03152467166409
PL:  [-16.60148838]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.38105617e+00 -3.17965697e-01 -8.21224692e-02]
 [-3.77440864e-02  1.94435997e-01  3.03058175e-01]
 [-2.10528374e-01  1.29425200e+00  1.01067068e+00]
 [ 1.60887330e-01  5.77732703e-02  2.91935727e-02]
 [-1.74849454e-01 -2.34591569e-01 -2.18975538e-01]
 [ 1.61241104e-01 -7.92642013e-02 -5.54459791e-02]
 [-2.41467136e-02  9.22517056e-04 -5.84371189e-02]
 [-1.02373999e-03 -3.02817376e-02 -1.04501337e-02]
 [ 6.27415551e-01 -1.08196385e-02  1.82809249e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.28732846]
curr_Stock_Price:  101.92710506409884
curr_Factors:  [101.92710506  -0.90616931  -1.00384569]
mat_Sqrt:  [[15.09317874  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09691291 -0.10262299 -0.23427255]
Stock Position:  -0.09691290683788649
Bond Position:  [26.1653805]


portfolio before change:  [16.20184961]
curr_Stock_Price:  102.9441503477114
curr_Factors:  [102.94415035  -0.36452829  -1.02938178]
mat_Sqrt:  [[25.54078376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00249822 0.06275395 0.86454062]
Stock Position:  0.0024982195801604786
Bond Position:  [15.94467252]


portfolio before change:  [16.23760883]
curr_Stock_Price:  114.0660289688018
curr_Factors:  [114.06602897  -0.87354376  -1.13420518]
mat_Sqrt:  [[15.31799904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01697102 0.41771804 2.88316214]
Stock Position:  0.01697101549679614
Bond Position:  [14.30179249]


portfolio before change:  [16.23586366]
curr_Stock_Price:  113.54173142475244
curr_Factors:  [113.54173142  -0.93586568  -1.09205788]
mat_Sqrt:  [[14.94305853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01195467 0.01864624 0.08328114]
Stock Position:  0.01195467194844676
Bond Position:  [14.87850951]


portfolio before change:  [16.25211376]
curr_Stock_Price:  114.2785970927499
curr_Factors:  [114.27859709  -0.740746    -1.07267187]
mat_Sqrt:  [[18.63835286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01434856 -0.0757141  -0.62467626]
Stock Position:  -0.014348556131385526
Bond Position:  [17.89184662]


portfolio before change:  [16.2512905]
curr_Stock_Price:  114.95960107073874
curr_Factors:  [114.95960107  -0.82180411  -1.07431466]
mat_Sqrt:  [[17.26121369  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00774821 -0.02558241 -0.15817195]
Stock Position:  0.007748209700038915
Bond Position:  [15.3605594]


portfolio before change:  [16.2445784]
curr_Stock_Price:  113.10184402066909
curr_Factors:  [ 1.13101844e+02 -1.00214896e-01 -1.04495434e+00]
mat_Sqrt:  [[35.98562142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00099725  0.00029774 -0.16670483]
Stock Position:  -0.0009972547676252795
Bond Position:  [16.35736976]


portfolio before change:  [16.25076081]
curr_Stock_Price:  115.10567302914367
curr_Factors:  [115.10567303  -0.7645332   -1.00579462]
mat_Sqrt:  [[19.5998669   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047644 -0.00977339 -0.02981132]
Stock Position:  -0.00047643682729915697
Bond Position:  [16.30560139]


portfolio before change:  [16.25844791]
curr_Stock_Price:  116.0874170901348
curr_Factors:  [116.08741709  -0.53051391  -1.00030896]
mat_Sqrt:  [[25.11639039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02637811 -0.00349202  0.5215039 ]
Stock Position:  0.026378105025828175
Bond Position:  [13.19628183]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.25812216]
Stock Price:  115.82486840995361
PL:  [0.43325375]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.07868186e+00 -2.76942645e-01 -2.63636912e-02]
 [ 2.45197843e-02  6.93753370e-02  1.63294338e-02]
 [-9.09828907e-02  4.38304763e-01  5.12965589e-01]
 [ 2.20929849e-01  1.63875795e-01  2.20095097e-01]
 [ 4.59010516e-02  4.41003315e-02  2.61908401e-02]
 [-1.07337997e-01 -6.22253053e-02  1.67179742e-02]
 [ 1.23783794e-01  3.35977295e-01  1.93970850e-01]
 [-3.99059008e-02 -1.22488877e-01  3.21174378e-02]
 [-8.18820384e-02 -3.72196165e-02 -6.95254308e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.50337108]
curr_Stock_Price:  100.0459292745896
curr_Factors:  [100.04592927  -0.67649866  -1.0329815 ]
mat_Sqrt:  [[18.10429512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06300129 -0.08938285 -0.07520827]
Stock Position:  -0.06300129336125003
Bond Position:  [8.80639402]


portfolio before change:  [2.54963358]
curr_Stock_Price:  99.38152715144332
curr_Factors:  [99.38152715 -0.61753349 -1.00148458]
mat_Sqrt:  [[19.68679652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00213413 0.02239079 0.04658333]
Stock Position:  0.0021341307299466896
Bond Position:  [2.3375404]


portfolio before change:  [2.55116087]
curr_Stock_Price:  99.54938769386112
curr_Factors:  [99.54938769 -0.44754718 -0.98736469]
mat_Sqrt:  [[23.70632778  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00435303 0.14146225 1.46334804]
Stock Position:  0.004353030033712292
Bond Position:  [2.1178194]


portfolio before change:  [2.53686335]
curr_Stock_Price:  96.02156840153694
curr_Factors:  [96.0215684  -0.69485589 -0.94024713]
mat_Sqrt:  [[18.71770402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01599061 0.05289069 0.62787005]
Stock Position:  0.015990613943034686
Bond Position:  [1.00141951]


portfolio before change:  [2.57168565]
curr_Stock_Price:  98.16791925724196
curr_Factors:  [98.16791926 -0.68326584 -1.03898329]
mat_Sqrt:  [[17.53905919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00343514 0.01423332 0.07471518]
Stock Position:  0.0034351430282708087
Bond Position:  [2.2344648]


portfolio before change:  [2.57063218]
curr_Stock_Price:  97.53592749326275
curr_Factors:  [97.53592749 -0.59687953 -1.04021462]
mat_Sqrt:  [[18.97508216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00614633 -0.02008313  0.04769173]
Stock Position:  -0.006146331348775104
Bond Position:  [3.17012031]


portfolio before change:  [2.59522532]
curr_Stock_Price:  93.79260762284586
curr_Factors:  [93.79260762 -0.3819435  -1.00006614]
mat_Sqrt:  [[23.54883636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00985013 0.10843621 0.55334484]
Stock Position:  0.009850126019164473
Bond Position:  [1.67135631]


portfolio before change:  [2.5903324]
curr_Stock_Price:  93.21101045024143
curr_Factors:  [93.21101045 -0.23847131 -0.99571591]
mat_Sqrt:  [[27.13104487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215078 -0.03953312  0.09162211]
Stock Position:  -0.002150779444952828
Bond Position:  [2.79080873]


portfolio before change:  [2.58486]
curr_Stock_Price:  96.40434318126921
curr_Factors:  [96.40434318 -0.52368037 -0.98815681]
mat_Sqrt:  [[21.25759149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00487691 -0.01201258 -0.1983367 ]
Stock Position:  -0.004876906207886853
Bond Position:  [3.05501494]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.57775712]
Stock Price:  98.1740653714435
PL:  [2.57775712]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.35736966e+00 -3.24091126e-01 -5.80915576e-02]
 [-1.59408051e-02  1.50564967e-01  1.95575181e-01]
 [-8.12464629e-02  3.80482324e-01  4.42201396e-01]
 [ 1.01809879e-01  2.45296327e-02  1.15222974e-02]
 [ 5.02793264e-02  1.58893226e-02  2.74526067e-02]
 [-1.07337997e-01 -6.22253053e-02  1.67179742e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 8.58586134e-03  1.38852244e-02 -4.44564042e-02]
 [-2.31685139e-02  5.61905586e-02 -7.75267567e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.50542231]
curr_Stock_Price:  101.4109666220828
curr_Factors:  [101.41096662  -0.69844578  -0.97959518]
mat_Sqrt:  [[18.93742787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07579606 -0.10459996 -0.16571904]
Stock Position:  -0.07579605739316163
Bond Position:  [20.19197376]


portfolio before change:  [12.51866169]
curr_Stock_Price:  101.36952830759358
curr_Factors:  [101.36952831  -1.08122825  -0.92472883]
mat_Sqrt:  [[13.63739237  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00401211 0.04859463 0.55792155]
Stock Position:  0.0040121128178828526
Bond Position:  [12.1119557]


portfolio before change:  [12.51622515]
curr_Stock_Price:  99.25243264613316
curr_Factors:  [99.25243265 -0.86188239 -0.88971856]
mat_Sqrt:  [[17.21989635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00503389 0.12280014 1.2614775 ]
Stock Position:  0.005033894900574223
Bond Position:  [12.01659884]


portfolio before change:  [12.52520586]
curr_Stock_Price:  99.84261271188166
curr_Factors:  [99.84261271 -1.38280966 -0.85926087]
mat_Sqrt:  [[10.60711014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01029205 0.0079169  0.03286991]
Stock Position:  0.010292053817514843
Bond Position:  [11.49762031]


portfolio before change:  [12.53212866]
curr_Stock_Price:  99.95654087248556
curr_Factors:  [99.95654087 -0.96671266 -0.82160058]
mat_Sqrt:  [[16.7169346   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00353692 0.00512826 0.07831465]
Stock Position:  0.003536920021860569
Bond Position:  [12.17859037]


portfolio before change:  [12.53195612]
curr_Stock_Price:  98.1856908254611
curr_Factors:  [98.18569083 -0.77759736 -0.84358589]
mat_Sqrt:  [[19.40784259  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00600928 -0.02008313  0.04769173]
Stock Position:  -0.006009279072503682
Bond Position:  [13.12198134]


portfolio before change:  [12.52245277]
curr_Stock_Price:  100.85922070863357
curr_Factors:  [100.85922071  -0.42975273  -0.8208931 ]
mat_Sqrt:  [[28.87799426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166214 -0.01197701  0.13962421]
Stock Position:  -0.0016621358333819588
Bond Position:  [12.69009449]


portfolio before change:  [12.5222241]
curr_Stock_Price:  104.81515333067806
curr_Factors:  [104.81515333  -0.77066644  -0.84759972]
mat_Sqrt:  [[20.77877836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.12881776e-04  4.48143691e-03 -1.26821747e-01]
Stock Position:  0.00011288177615275721
Bond Position:  [12.51039238]


portfolio before change:  [12.52833455]
curr_Stock_Price:  103.51900786652375
curr_Factors:  [103.51900787  -0.26397339  -0.82896565]
mat_Sqrt:  [[34.70265538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038271  0.01813542 -0.02211623]
Stock Position:  -0.0003827134364484785
Bond Position:  [12.56795267]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.53402733]
Stock Price:  105.06786921343488
PL:  [7.46615812]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.00584394e+00 -2.14985352e-01 -1.22575972e-01]
 [-4.68803837e-02  1.71428628e-01  3.24884692e-01]
 [-7.52135869e-02  2.72910965e-01  3.26675216e-01]
 [ 1.09771708e-01  2.90098559e-02  1.39038435e-02]
 [ 3.67533146e-02 -1.28351550e-03  9.39779821e-02]
 [ 6.24799738e-02  4.67382365e-02 -5.81312960e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 1.31188679e-02  2.02207346e-02 -5.07250640e-02]
 [ 4.03138849e-02  7.52456212e-02 -6.54378646e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.93372042]
curr_Stock_Price:  101.87884614413338
curr_Factors:  [101.87884614  -1.73386455  -1.09756312]
mat_Sqrt:  [[ 6.0035842   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.17901779 -0.06938622 -0.34967513]
Stock Position:  -0.17901778711799235
Bond Position:  [34.17184601]


portfolio before change:  [15.95633744]
curr_Stock_Price:  101.8479730658063
curr_Factors:  [101.84797307  -2.00987731  -1.07945571]
mat_Sqrt:  [[ 4.63737385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01173706 0.05532835 0.9268056 ]
Stock Position:  0.011737062871313889
Bond Position:  [14.76094138]


portfolio before change:  [15.96841562]
curr_Stock_Price:  102.2480610676294
curr_Factors:  [102.24806107  -2.0097367   -1.09208571]
mat_Sqrt:  [[ 4.59780686  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01026064 0.08808164 0.93191346]
Stock Position:  0.010260637597027968
Bond Position:  [14.91928532]


portfolio before change:  [15.98462998]
curr_Stock_Price:  103.10111311554745
curr_Factors:  [103.10111312  -2.28705709  -1.07917035]
mat_Sqrt:  [[ 3.55901117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0333046  0.00936289 0.0396638 ]
Stock Position:  0.03330459631692927
Bond Position:  [12.55088903]


portfolio before change:  [15.97170856]
curr_Stock_Price:  102.52466315471221
curr_Factors:  [102.52466315  -2.08863795  -1.03965569]
mat_Sqrt:  [[ 4.48980716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0124002  -0.00041425  0.26809302]
Stock Position:  0.012400197022574982
Bond Position:  [14.70038254]


portfolio before change:  [15.98418155]
curr_Stock_Price:  102.9376371092583
curr_Factors:  [102.93763711  -1.82619496  -1.08482893]
mat_Sqrt:  [[ 5.60186423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01073828  0.0150847  -0.16583241]
Stock Position:  0.010738277967274687
Bond Position:  [14.87880859]


portfolio before change:  [15.99442009]
curr_Stock_Price:  103.19813301199537
curr_Factors:  [103.19813301  -2.15780412  -1.07423611]
mat_Sqrt:  [[ 4.07393977  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.011782   -0.01197701  0.13962421]
Stock Position:  -0.011781997723191313
Bond Position:  [17.21030026]


portfolio before change:  [16.00504175]
curr_Stock_Price:  103.02716387617325
curr_Factors:  [103.02716388  -1.56418018  -1.00255589]
mat_Sqrt:  [[ 7.91101909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00087121  0.00652621 -0.14470449]
Stock Position:  0.0008712149073031887
Bond Position:  [15.91528295]


portfolio before change:  [16.01258298]
curr_Stock_Price:  102.54691657243146
curr_Factors:  [102.54691657  -0.87896869  -1.00564271]
mat_Sqrt:  [[15.57565338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00348862  0.02428542 -0.0186676 ]
Stock Position:  0.0034886233579399014
Bond Position:  [15.65483542]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.0174469]
Stock Price:  101.69687982343915
PL:  [14.32056708]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.10751642e+00 -2.56544468e-01 -8.28654834e-02]
 [ 2.64983763e-03  1.08067553e-01  9.17684575e-02]
 [-7.39305028e-02  2.51705067e-01  3.53016387e-01]
 [ 1.06617781e-01  2.72351007e-02  1.29604393e-02]
 [ 5.11324662e-02  1.03921954e-02  2.76984714e-02]
 [-5.42499237e-02 -1.28231662e-02 -9.93883342e-03]
 [-5.04634946e-02 -1.46094936e-02  5.11078710e-02]
 [-3.82571162e-02 -1.06921759e-01  6.26291852e-02]
 [-6.07985506e-02 -1.42686073e-02 -6.64255526e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.04127993]
curr_Stock_Price:  101.34762244723892
curr_Factors:  [101.34762245  -1.36841108  -1.04298078]
mat_Sqrt:  [[ 9.08990586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12946209 -0.08279937 -0.23639216]
Stock Position:  -0.1294620874934712
Bond Position:  [25.1619547]


portfolio before change:  [12.22797735]
curr_Stock_Price:  100.0027244945075
curr_Factors:  [100.00272449  -1.3842945   -1.01886846]
mat_Sqrt:  [[ 9.04339332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00480364 0.03487865 0.26178987]
Stock Position:  0.004803638507542599
Bond Position:  [11.74760042]


portfolio before change:  [12.23838975]
curr_Stock_Price:  100.94724430166094
curr_Factors:  [100.9472443   -1.65181658  -1.05307798]
mat_Sqrt:  [[ 6.75108675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0073333  0.08123746 1.00705749]
Stock Position:  0.007333300419027199
Bond Position:  [11.49811329]


portfolio before change:  [12.24968176]
curr_Stock_Price:  101.70290880852902
curr_Factors:  [101.70290881  -1.51113626  -1.06817795]
mat_Sqrt:  [[ 7.71172345  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01488936 0.00879009 0.03697253]
Stock Position:  0.01488936449311431
Bond Position:  [10.73539008]


portfolio before change:  [12.24020732]
curr_Stock_Price:  100.70599025191223
curr_Factors:  [100.70599025  -0.9035129   -1.03288235]
mat_Sqrt:  [[14.52411007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00405586 0.00335407 0.07901603]
Stock Position:  0.004055855450620236
Bond Position:  [11.83175838]


portfolio before change:  [12.24283443]
curr_Stock_Price:  99.8947574196886
curr_Factors:  [99.89475742 -0.64600696 -1.04832914]
mat_Sqrt:  [[18.35278093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320912 -0.00413866 -0.02835273]
Stock Position:  -0.0032091156980337387
Bond Position:  [12.56340827]


portfolio before change:  [12.25019555]
curr_Stock_Price:  99.55888967070874
curr_Factors:  [99.55888967 -0.83449438 -1.04670309]
mat_Sqrt:  [[15.17352075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283476 -0.00471519  0.14579653]
Stock Position:  -0.002834760317546299
Bond Position:  [12.53242114]


portfolio before change:  [12.26171577]
curr_Stock_Price:  97.70601793267197
curr_Factors:  [97.70601793 -0.82491729 -1.09896923]
mat_Sqrt:  [[14.26881865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033148  -0.03450885  0.17866363]
Stock Position:  -0.003314801397426047
Bond Position:  [12.58559182]


portfolio before change:  [12.27104074]
curr_Stock_Price:  96.79175568854097
curr_Factors:  [96.79175569 -0.78416235 -1.16046481]
mat_Sqrt:  [[13.84514538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00558103 -0.00460517 -0.18949361]
Stock Position:  -0.005581030385992111
Bond Position:  [12.81123847]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.27449207]
Stock Price:  97.32138784555687
PL:  [12.27449207]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.41181264e+00 -3.30090052e-01 -7.10520389e-02]
 [-5.76446648e-02  2.03927400e-01  3.76372399e-01]
 [-1.48544219e-01  8.01423063e-01  8.24817932e-01]
 [ 1.18476464e-01  3.39081332e-02  1.65076141e-02]
 [ 2.34313957e-02 -3.84160188e-02 -2.02458573e-02]
 [ 5.50297858e-02  1.56943713e-03 -4.62013276e-02]
 [-3.98965232e-02 -1.81112750e-02  1.95322276e-02]
 [ 9.54759242e-03  7.88494455e-03 -4.08359810e-02]
 [ 1.83978070e-01  5.84814043e-04  7.15840791e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.44643078]
curr_Stock_Price:  101.6758671894132
curr_Factors:  [101.67586719  -0.66593297  -0.9737712 ]
mat_Sqrt:  [[19.72892461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07571094 -0.10653611 -0.20269169]
Stock Position:  -0.07571094007484643
Bond Position:  [22.14440627]


portfolio before change:  [14.33105921]
curr_Stock_Price:  103.34598961390903
curr_Factors:  [103.34598961  -0.51688259  -0.9920731 ]
mat_Sqrt:  [[22.85401448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00266074 0.06581729 1.07368569]
Stock Position:  0.002660737605635262
Bond Position:  [14.05608265]


portfolio before change:  [14.34237417]
curr_Stock_Price:  104.95650516224802
curr_Factors:  [104.95650516  -0.26631837  -1.01521935]
mat_Sqrt:  [[29.13698453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00629478 0.25865818 2.35297597]
Stock Position:  0.006294777486089999
Bond Position:  [13.68169632]


portfolio before change:  [14.35059204]
curr_Stock_Price:  105.17499011128577
curr_Factors:  [105.17499011  -0.30185419  -0.95453205]
mat_Sqrt:  [[29.94131479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00430066 0.0109438  0.04709163]
Stock Position:  0.004300664012943176
Bond Position:  [13.89826975]


portfolio before change:  [14.3577954]
curr_Stock_Price:  105.23369816765339
curr_Factors:  [105.23369817  -0.63337891  -1.01044103]
mat_Sqrt:  [[20.33540856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056341 -0.01239872 -0.0577558 ]
Stock Position:  0.0005634059618237732
Bond Position:  [14.2985061]


portfolio before change:  [14.36504403]
curr_Stock_Price:  105.40691256539235
curr_Factors:  [105.40691257  -0.60776677  -1.02003765]
mat_Sqrt:  [[20.69772517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00221857  0.00050653 -0.13179953]
Stock Position:  0.0022185693809861277
Bond Position:  [14.13119148]


portfolio before change:  [14.3802653]
curr_Stock_Price:  109.08221145527845
curr_Factors:  [109.08221146  -0.29106084  -1.07470986]
mat_Sqrt:  [[27.83602732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142285 -0.00584539  0.05572001]
Stock Position:  -0.0014228493167588055
Bond Position:  [14.53547285]


portfolio before change:  [14.39140263]
curr_Stock_Price:  106.363876496728
curr_Factors:  [ 1.06363876e+02 -9.49327197e-02 -1.05346831e+00]
mat_Sqrt:  [[33.73260857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.36428128e-05  2.54485491e-03 -1.16493687e-01]
Stock Position:  8.364281281636613e-05
Bond Position:  [14.38250606]


portfolio before change:  [14.39872683]
curr_Stock_Price:  107.93180481534841
curr_Factors:  [107.93180482  -0.54565348  -1.01432366]
mat_Sqrt:  [[22.68088378  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [8.76109968e-03 1.88747921e-04 2.04209453e-01]
Stock Position:  0.008761099681006872
Bond Position:  [13.45312553]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.38293005]
Stock Price:  105.36077821671508
PL:  [9.02215184]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.32136281e+00 -3.27919137e-01 -3.31066012e-02]
 [-3.64500800e-02  1.83882533e-01  2.94688081e-01]
 [-8.85886192e-02  3.83575530e-01  4.75168108e-01]
 [ 1.33702352e-01  6.03730705e-02  6.37603458e-02]
 [ 5.40926492e-02 -3.06600004e-02  7.23689475e-02]
 [-4.80444745e-02  1.63993981e-02 -1.78836635e-02]
 [ 9.24198030e-03  9.36278077e-02  5.32460394e-02]
 [-3.93664456e-02 -1.09428747e-01  3.97440454e-02]
 [ 3.26486212e-02 -9.15703609e-02 -1.17276955e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.21304398]
curr_Stock_Price:  100.82516111105076
curr_Factors:  [100.82516111  -0.46478777  -0.97764137]
mat_Sqrt:  [[23.83032184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05854125 -0.10583545 -0.09444392]
Stock Position:  -0.05854125202982494
Bond Position:  [14.11547515]


portfolio before change:  [8.12467562]
curr_Stock_Price:  102.45525722821709
curr_Factors:  [102.45525723  -0.88573733  -1.0483449 ]
mat_Sqrt:  [[14.81061207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00413472 0.05934783 0.84066307]
Stock Position:  0.004134720245905321
Bond Position:  [7.70105179]


portfolio before change:  [8.1194351]
curr_Stock_Price:  100.25631546039962
curr_Factors:  [100.25631546  -0.79175958  -1.04562359]
mat_Sqrt:  [[15.96417078  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00543102 0.12379847 1.35552235]
Stock Position:  0.005431017559653708
Bond Position:  [7.57494129]


portfolio before change:  [8.11466112]
curr_Stock_Price:  98.67974279726589
curr_Factors:  [98.6797428  -0.86846075 -0.97785668]
mat_Sqrt:  [[15.5733677   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01021237 0.01948532 0.18189052]
Stock Position:  0.010212369119334395
Bond Position:  [7.10690716]


portfolio before change:  [8.08747819]
curr_Stock_Price:  95.66993452802195
curr_Factors:  [95.66993453 -0.88395807 -0.96141391]
mat_Sqrt:  [[15.11264942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00414265 -0.00989547  0.20644846]
Stock Position:  0.004142652330813446
Bond Position:  [7.69115091]


portfolio before change:  [8.09031782]
curr_Stock_Price:  95.42687521820602
curr_Factors:  [95.42687522 -1.00801956 -0.95649826]
mat_Sqrt:  [[13.38108882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361312  0.00529288 -0.05101711]
Stock Position:  -0.0036131177045004457
Bond Position:  [8.43510635]


portfolio before change:  [8.09303202]
curr_Stock_Price:  95.84324737891338
curr_Factors:  [95.84324738 -1.36153478 -0.9428016 ]
mat_Sqrt:  [[ 9.56755454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00409953 0.03021824 0.15189613]
Stock Position:  0.004099530201685158
Bond Position:  [7.70011974]


portfolio before change:  [8.09307678]
curr_Stock_Price:  94.91478286004006
curr_Factors:  [94.91478286 -1.27859739 -0.93994479]
mat_Sqrt:  [[10.32364907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00519107 -0.03531798  0.1133787 ]
Stock Position:  -0.005191069112418519
Bond Position:  [8.58578597]


portfolio before change:  [8.09652241]
curr_Stock_Price:  95.07820384109561
curr_Factors:  [95.07820384 -1.18096214 -0.94359022]
mat_Sqrt:  [[11.36055648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087867 -0.02955421 -0.33455851]
Stock Position:  -0.0008786681014918757
Bond Position:  [8.1800646]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.10085097]
Stock Price:  94.80790116809456
PL:  [8.10085097]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.59771398e-01 -2.16867445e-01 -4.42160282e-02]
 [-1.93450283e-03  1.18603368e-01  1.16513067e-01]
 [-8.61026390e-02  3.42362289e-01  4.44117098e-01]
 [ 1.10088633e-01  2.91881934e-02  1.39986421e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 5.80889404e-02 -6.47840912e-04 -4.67424688e-02]
 [-4.84751328e-02 -3.36058148e-02  4.35201054e-02]
 [-1.58643523e-04  2.72118283e-04 -3.14258197e-02]
 [ 2.74804805e-01  2.54995562e-04  8.79470851e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.17742371]
curr_Stock_Price:  99.40711433981755
curr_Factors:  [99.40711434 -0.8837783  -1.02823273]
mat_Sqrt:  [[14.69067091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0621527  -0.06999367 -0.12613602]
Stock Position:  -0.0621526984280512
Bond Position:  [4.00099669]


portfolio before change:  [-2.23471353]
curr_Stock_Price:  100.3610684652522
curr_Factors:  [100.36106847  -1.24324278  -1.01773975]
mat_Sqrt:  [[10.46244149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00440226 0.03827907 0.33237935]
Stock Position:  0.00440226485001398
Bond Position:  [-2.67652953]


portfolio before change:  [-2.23197708]
curr_Stock_Price:  101.28674044013111
curr_Factors:  [101.28674044  -1.39720408  -1.00268738]
mat_Sqrt:  [[ 9.18952319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00810018 0.11049695 1.26694246]
Stock Position:  0.008100180166102944
Bond Position:  [-3.05241792]


portfolio before change:  [-2.21830932]
curr_Stock_Price:  103.1625438363431
curr_Factors:  [103.16254384  -1.63603046  -1.04326503]
mat_Sqrt:  [[ 7.0781342   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01679879 0.00942045 0.03993423]
Stock Position:  0.016798792635767584
Bond Position:  [-3.9513155]


portfolio before change:  [-2.21889684]
curr_Stock_Price:  103.24520631824727
curr_Factors:  [103.24520632  -1.0147617   -1.07460227]
mat_Sqrt:  [[12.77822857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00456411 -0.00140152  0.08089603]
Stock Position:  0.004564114277976336
Bond Position:  [-2.69011976]


portfolio before change:  [-2.21014189]
curr_Stock_Price:  105.45819824968115
curr_Factors:  [105.45819825  -1.04760275  -1.08764963]
mat_Sqrt:  [[12.46671468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00388358 -0.00020909 -0.13334325]
Stock Position:  0.003883575998258395
Bond Position:  [-2.61969682]


portfolio before change:  [-2.20973819]
curr_Stock_Price:  105.89951130454257
curr_Factors:  [105.8995113   -1.12608273  -1.04403678]
mat_Sqrt:  [[12.08990884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00384216 -0.01084623  0.12415075]
Stock Position:  -0.0038421618643851136
Bond Position:  [-1.80285513]


portfolio before change:  [-2.21959896]
curr_Stock_Price:  108.23130023605782
curr_Factors:  [108.23130024  -1.10293883  -1.09760456]
mat_Sqrt:  [[11.98585506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.43796514e-04  8.78257983e-05 -8.96491164e-02]
Stock Position:  -0.0005437965144114446
Bond Position:  [-2.16074315]


portfolio before change:  [-2.22061292]
curr_Stock_Price:  108.10868154038891
curr_Factors:  [108.10868154  -1.06370247  -1.09961007]
mat_Sqrt:  [[12.42641548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.35634307e-02 8.22994638e-05 2.50888554e-01]
Stock Position:  0.023563430655659964
Bond Position:  [-4.76802434]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.29628459]
Stock Price:  104.99847815853238
PL:  [-7.29476275]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-6.57049549e-01 -1.38865891e-01 -1.12250634e-02]
 [ 5.82499828e-02  2.97648269e-02  1.09319456e-02]
 [-3.46597324e-02  3.37614688e-01  2.21322970e-01]
 [ 2.53659172e-01  2.56070616e-01  2.91086836e-01]
 [ 4.94481587e-02  2.12448749e-02  2.72130741e-02]
 [-1.07337997e-01 -6.22253053e-02  1.67179742e-02]
 [ 1.97009861e-02  1.46589848e-01  1.08820244e-01]
 [-3.87710908e-02 -1.25205551e-01  5.35436145e-02]
 [-7.82418753e-02 -8.19380572e-02 -8.65538395e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.69112013]
curr_Stock_Price:  97.28987113279914
curr_Factors:  [97.28987113 -0.70060255 -0.94724926]
mat_Sqrt:  [[18.72469198  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0367262  -0.04481877 -0.03202198]
Stock Position:  -0.03672619756399656
Bond Position:  [-14.11803311]


portfolio before change:  [-17.68463827]
curr_Stock_Price:  96.92112501774771
curr_Factors:  [96.92112502 -0.53868611 -0.95016288]
mat_Sqrt:  [[21.8685279   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00304351 0.00960656 0.0311858 ]
Stock Position:  0.00304351427009089
Bond Position:  [-17.9796191]


portfolio before change:  [-17.70916347]
curr_Stock_Price:  91.81743977322174
curr_Factors:  [91.81743977 -0.56682045 -0.92086864]
mat_Sqrt:  [[20.74101553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00382975 0.10896467 0.63137283]
Stock Position:  0.003829751697590854
Bond Position:  [-18.06080146]


portfolio before change:  [-17.71087451]
curr_Stock_Price:  93.72921204999523
curr_Factors:  [93.72921205 -0.31285717 -1.00118247]
mat_Sqrt:  [[25.18806471  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01450478 0.08264644 0.83038972]
Stock Position:  0.014504775295722118
Bond Position:  [-19.07039567]


portfolio before change:  [-17.62001208]
curr_Stock_Price:  100.65107121274188
curr_Factors:  [100.65107121  -0.63857269  -1.07439901]
mat_Sqrt:  [[18.15031816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00326934 0.00685675 0.07763133]
Stock Position:  0.0032693419249815443
Bond Position:  [-17.94907485]


portfolio before change:  [-17.63774475]
curr_Stock_Price:  97.97289080310179
curr_Factors:  [97.9728908  -0.58777202 -1.07240434]
mat_Sqrt:  [[18.62518046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0062618  -0.02008313  0.04769173]
Stock Position:  -0.006261799321750535
Bond Position:  [-17.02425817]


portfolio before change:  [-17.63940687]
curr_Stock_Price:  96.87861362682125
curr_Factors:  [96.87861363 -0.40623031 -1.1711502 ]
mat_Sqrt:  [[20.00692122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00359058 0.04731167 0.31043387]
Stock Position:  0.0035905750811528886
Bond Position:  [-17.9872568]


portfolio before change:  [-17.6566813]
curr_Stock_Price:  94.57297834483182
curr_Factors:  [94.57297834 -0.25775722 -1.18087701]
mat_Sqrt:  [[22.43758743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237989 -0.04040992  0.15274503]
Stock Position:  -0.00237989143904519
Bond Position:  [-17.43160788]


portfolio before change:  [-17.66793279]
curr_Stock_Price:  95.63752735147521
curr_Factors:  [95.63752735 -0.72546058 -1.21631274]
mat_Sqrt:  [[13.71914047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00821007 -0.02644539 -0.24691401]
Stock Position:  -0.008210072634383614
Bond Position:  [-16.88274175]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.69164401]
Stock Price:  97.49716177756558
PL:  [-17.69164401]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.16155757e-01 -2.11778363e-01  1.23952257e-02]
 [-9.82090128e-03  1.37210973e-01  1.51747836e-01]
 [-1.09762851e-01  5.11064318e-01  6.37985314e-01]
 [ 1.07143339e-01  2.75308387e-02  1.31176444e-02]
 [ 5.20393256e-03 -5.91269075e-02 -4.97883510e-02]
 [ 5.92869510e-02 -3.83730607e-03 -4.62571632e-02]
 [-5.02525379e-02 -3.68161340e-02  4.84901623e-02]
 [ 2.60467134e-04  2.24932251e-03 -3.29432807e-02]
 [ 2.77901702e-01  8.07321263e-04  8.83149427e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.01369141]
curr_Stock_Price:  97.7917509402496
curr_Factors:  [97.79175094 -0.28792032 -0.9960491 ]
mat_Sqrt:  [[27.08204069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03163922 -0.06835117  0.03536013]
Stock Position:  -0.03163922096129972
Bond Position:  [-10.9196366]


portfolio before change:  [-14.12678232]
curr_Stock_Price:  101.193532776443
curr_Factors:  [101.19353278  -0.41086375  -1.0288432 ]
mat_Sqrt:  [[23.98258395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00204993 0.04428465 0.43289434]
Stock Position:  0.0020499279320751965
Bond Position:  [-14.33422177]


portfolio before change:  [-14.13429328]
curr_Stock_Price:  101.02666994475598
curr_Factors:  [101.02666994  -0.34727728  -1.02665354]
mat_Sqrt:  [[25.57086766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00488    0.1649453  1.81999452]
Stock Position:  0.00488000346157773
Bond Position:  [-14.62730378]


portfolio before change:  [-14.13823029]
curr_Stock_Price:  101.71898048138331
curr_Factors:  [101.71898048  -0.13088203  -1.0767289 ]
mat_Sqrt:  [[30.40487584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00379678 0.00888554 0.03742099]
Stock Position:  0.0037967816802507806
Bond Position:  [-14.52443505]


portfolio before change:  [-14.12859951]
curr_Stock_Price:  106.16875290582183
curr_Factors:  [106.16875291  -0.57691982  -1.09051898]
mat_Sqrt:  [[20.03721     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084983 -0.01908313 -0.14203231]
Stock Position:  -0.0008498339573488103
Bond Position:  [-14.03837369]


portfolio before change:  [-14.13533883]
curr_Stock_Price:  105.83737376729742
curr_Factors:  [105.83737377  -0.56351889  -1.11653828]
mat_Sqrt:  [[19.72420452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00248737 -0.00123849 -0.13195881]
Stock Position:  0.0024873733279032664
Bond Position:  [-14.39859589]


portfolio before change:  [-14.14124504]
curr_Stock_Price:  106.35795858534172
curr_Factors:  [106.35795859  -0.77083504  -1.16287482]
mat_Sqrt:  [[15.38050061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311236 -0.01188236  0.13832894]
Stock Position:  -0.0031123555812759053
Bond Position:  [-13.81022125]


portfolio before change:  [-14.15027025]
curr_Stock_Price:  107.03859351251427
curr_Factors:  [107.03859351  -1.17727616  -1.09419064]
mat_Sqrt:  [[11.04218189  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054382  0.00072597 -0.09397801]
Stock Position:  -0.0005438156066679247
Bond Position:  [-14.092061]


portfolio before change:  [-14.15788839]
curr_Stock_Price:  108.08737087777045
curr_Factors:  [108.08737088  -1.08186064  -1.12658056]
mat_Sqrt:  [[11.87575219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02493263 0.00026056 0.25193795]
Stock Position:  0.02493262769995672
Bond Position:  [-16.85279057]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.22149395]
Stock Price:  105.87432459252871
PL:  [-20.09581854]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.16248596e-01 -1.63060001e-01 -8.57444323e-03]
 [ 1.06720779e-02  9.01200905e-02  4.10360948e-02]
 [-5.81480174e-02  2.65899038e-01  2.85697417e-01]
 [ 1.59496783e-01  8.71543120e-02  1.00740699e-01]
 [ 5.49210898e-02 -2.77410327e-02  5.61462710e-02]
 [-2.44604261e-02  6.68326103e-03 -2.41101520e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-5.58109181e-03 -1.50759464e-02 -1.86902987e-02]
 [ 4.60188907e-02  9.72536388e-02 -2.12050304e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.31919081]
curr_Stock_Price:  97.61358194395319
curr_Factors:  [97.61358194 -0.65104541 -0.93883431]
mat_Sqrt:  [[19.90830385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03773718 -0.05262739 -0.0244605 ]
Stock Position:  -0.037737184222202735
Bond Position:  [-11.63552908]


portfolio before change:  [-15.3997574]
curr_Stock_Price:  99.59431740390364
curr_Factors:  [99.5943174  -1.03364772 -1.03529438]
mat_Sqrt:  [[12.58068884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00297633 0.02908613 0.11706456]
Stock Position:  0.002976325274085839
Bond Position:  [-15.69618249]


portfolio before change:  [-15.41255589]
curr_Stock_Price:  97.93172026858066
curr_Factors:  [97.93172027 -1.07538335 -1.03371293]
mat_Sqrt:  [[11.88377741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00458155 0.08581855 0.81501521]
Stock Position:  0.00458155143464559
Bond Position:  [-15.8612351]


portfolio before change:  [-15.42096076]
curr_Stock_Price:  97.82863841635249
curr_Factors:  [97.82863842 -1.1597622  -1.03004858]
mat_Sqrt:  [[10.95073504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01806734 0.02812893 0.28738517]
Stock Position:  0.018067343518095292
Bond Position:  [-17.18846438]


portfolio before change:  [-15.43588649]
curr_Stock_Price:  97.47831868296547
curr_Factors:  [97.47831868 -1.20334049 -0.98667795]
mat_Sqrt:  [[10.90925528  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00556585 -0.00895338  0.16016968]
Stock Position:  0.005565850574967291
Bond Position:  [-15.97843625]


portfolio before change:  [-15.42735159]
curr_Stock_Price:  100.44751760023914
curr_Factors:  [100.4475176   -1.26460452  -1.06502083]
mat_Sqrt:  [[ 9.7767784   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286574  0.00215701 -0.06877955]
Stock Position:  -0.0028657369676763937
Bond Position:  [-15.13949543]


portfolio before change:  [-15.43776784]
curr_Stock_Price:  101.44014357377932
curr_Factors:  [101.44014357  -1.99088929  -1.0173649 ]
mat_Sqrt:  [[ 5.00889188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00958279 -0.01197701  0.13962421]
Stock Position:  -0.00958278801287704
Bond Position:  [-14.46568844]


portfolio before change:  [-15.44271084]
curr_Stock_Price:  101.20100114814149
curr_Factors:  [101.20100115  -1.72092814  -1.03970569]
mat_Sqrt:  [[ 6.40113178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194866 -0.00486574 -0.05331822]
Stock Position:  -0.0019486550408889607
Bond Position:  [-15.245505]


portfolio before change:  [-15.45000618]
curr_Stock_Price:  101.0320025588343
curr_Factors:  [101.03200256  -1.26061979  -1.03005234]
mat_Sqrt:  [[10.22427907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00601923  0.03138848 -0.06049205]
Stock Position:  0.006019226139480982
Bond Position:  [-16.05814065]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.46305345]
Stock Price:  100.19864097110485
PL:  [-15.66169442]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.01545929e+00 -2.69705033e-01 -1.18843654e-02]
 [ 1.06434023e-02  9.00531264e-02  4.32083830e-02]
 [-6.85571532e-02  2.91927956e-01  3.43332110e-01]
 [ 1.45313603e-01  7.26284195e-02  8.08837801e-02]
 [ 5.26820146e-02  4.07823603e-04  2.81450327e-02]
 [ 3.18749055e-02  2.58760337e-02 -4.53622363e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-3.79635757e-02 -9.22951135e-02  4.86223617e-02]
 [-5.00377148e-02  4.57339229e-02 -1.31078057e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.63992359]
curr_Stock_Price:  99.48047006589356
curr_Factors:  [99.48047007 -0.54650487 -0.97880798]
mat_Sqrt:  [[21.64227308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04957605 -0.08704693 -0.03390279]
Stock Position:  -0.04957605321382297
Bond Position:  [3.29192549]


portfolio before change:  [-1.64194421]
curr_Stock_Price:  99.5544371460206
curr_Factors:  [99.55443715 -1.18455949 -0.93906907]
mat_Sqrt:  [[11.90639971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00317857 0.02906452 0.12326149]
Stock Position:  0.0031785673997970524
Bond Position:  [-1.9583847]


portfolio before change:  [-1.64448073]
curr_Stock_Price:  99.06456848955047
curr_Factors:  [99.06456849 -1.2594375  -0.90296666]
mat_Sqrt:  [[11.39719963  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00536226 0.09421934 0.97943094]
Stock Position:  0.0053622614980016435
Bond Position:  [-2.17569085]


portfolio before change:  [-1.64896751]
curr_Stock_Price:  98.43075731391436
curr_Factors:  [98.43075731 -1.00785718 -0.88195839]
mat_Sqrt:  [[14.87285535  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01187729 0.02344072 0.23073891]
Stock Position:  0.011877285553072577
Bond Position:  [-2.81805772]


portfolio before change:  [-1.61587946]
curr_Stock_Price:  101.33524481228235
curr_Factors:  [101.33524481  -0.95936572  -0.83914931]
mat_Sqrt:  [[16.7754959   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00348785 0.00013162 0.08028994]
Stock Position:  0.0034878457452650466
Bond Position:  [-1.96932117]


portfolio before change:  [-1.61105174]
curr_Stock_Price:  103.00178354925471
curr_Factors:  [103.00178355  -1.06628404  -0.7735034 ]
mat_Sqrt:  [[16.36195557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00170501  0.00835145 -0.12940583]
Stock Position:  0.0017050101976960926
Bond Position:  [-1.78667083]


portfolio before change:  [-1.61098397]
curr_Stock_Price:  103.56561161557822
curr_Factors:  [103.56561162  -0.68543156  -0.81561428]
mat_Sqrt:  [[23.08445613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207928 -0.01197701  0.13962421]
Stock Position:  -0.0020792843805147753
Bond Position:  [-1.39564161]


portfolio before change:  [-1.60291298]
curr_Stock_Price:  99.34830464389808
curr_Factors:  [99.34830464 -0.58209822 -0.80274192]
mat_Sqrt:  [[24.87322109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188469 -0.02978812  0.13870606]
Stock Position:  -0.001884687095475499
Bond Position:  [-1.41567251]


portfolio before change:  [-1.61164219]
curr_Stock_Price:  103.60428499155275
curr_Factors:  [ 1.03604285e+02  1.79615556e-02 -8.38461677e-01]
mat_Sqrt:  [[45.60779152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095111  0.01476056 -0.03739292]
Stock Position:  -0.0009511080237994536
Bond Position:  [-1.51310332]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.6134327]
Stock Price:  104.69120414619564
PL:  [-6.30463685]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.17670529e+00 -2.80828199e-01 -6.42589786e-02]
 [-1.03015336e-02  1.38189491e-01  1.56256573e-01]
 [-9.36786700e-02  3.97227367e-01  5.13085487e-01]
 [ 1.11736497e-01  3.01154679e-02  1.44915522e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 3.94039562e-02  1.45886828e-02 -4.50482287e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 1.33303830e-03 -1.42985063e-02 -2.22623194e-02]
 [ 5.07347814e-03  1.07468472e-01 -3.97174371e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.5104878]
curr_Stock_Price:  101.27518219713298
curr_Factors:  [101.2751822   -1.16117597  -1.02961442]
mat_Sqrt:  [[11.32543404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11011904 -0.09063691 -0.18331298]
Stock Position:  -0.11011903874726502
Bond Position:  [22.66281351]


portfolio before change:  [11.53252138]
curr_Stock_Price:  101.17802062032345
curr_Factors:  [101.17802062  -0.54803548  -1.00759608]
mat_Sqrt:  [[21.3542329   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00233218 0.04460047 0.44575651]
Stock Position:  0.0023321848095343117
Bond Position:  [11.29655553]


portfolio before change:  [11.53740832]
curr_Stock_Price:  100.85096652246503
curr_Factors:  [100.85096652  -0.95758656  -0.99333537]
mat_Sqrt:  [[14.33525549  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00642738 0.12820458 1.46369008]
Stock Position:  0.006427382015994985
Bond Position:  [10.88920063]


portfolio before change:  [11.56125471]
curr_Stock_Price:  103.71378533471874
curr_Factors:  [103.71378533  -0.77590719  -1.05062787]
mat_Sqrt:  [[16.69484483  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00723827 0.00971973 0.04134036]
Stock Position:  0.007238274365576275
Bond Position:  [10.81054587]


portfolio before change:  [11.56581033]
curr_Stock_Price:  103.59621561189891
curr_Factors:  [103.59621561  -1.13775468  -0.98342601]
mat_Sqrt:  [[12.42014942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0046957  -0.00140152  0.08089603]
Stock Position:  0.004695699984547254
Bond Position:  [11.07935358]


portfolio before change:  [11.57296445]
curr_Stock_Price:  103.93973463814059
curr_Factors:  [103.93973464  -0.67585211  -0.9748492 ]
mat_Sqrt:  [[19.94762212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166368  0.00470848 -0.12851006]
Stock Position:  0.0016636783681573115
Bond Position:  [11.40004217]


portfolio before change:  [11.5746924]
curr_Stock_Price:  101.5513518358879
curr_Factors:  [101.55135184  -0.41073218  -0.9338377 ]
mat_Sqrt:  [[26.4695422   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181337 -0.01197701  0.13962421]
Stock Position:  -0.001813372845719455
Bond Position:  [11.75884286]


portfolio before change:  [11.57952955]
curr_Stock_Price:  102.12693090070802
curr_Factors:  [102.1269309   -0.54007585  -0.92039029]
mat_Sqrt:  [[23.70652495  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025857 -0.00461482 -0.0635082 ]
Stock Position:  -0.0002585747598328852
Bond Position:  [11.605937]


portfolio before change:  [11.5859245]
curr_Stock_Price:  99.8431495060066
curr_Factors:  [99.84314951 -1.17945153 -0.9208424 ]
mat_Sqrt:  [[12.22284232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00154654  0.0346853  -0.11330279]
Stock Position:  0.001546538823668658
Bond Position:  [11.43151319]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.5913083]
Stock Price:  99.62757866862293
PL:  [11.5913083]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.10055234e+00 -2.77991820e-01 -3.44349679e-02]
 [ 2.18006734e-02  6.80772409e-02 -1.36672552e-02]
 [-6.59490248e-02  3.44990365e-01  3.58890382e-01]
 [ 1.04552986e-01  2.60732140e-02  1.23428167e-02]
 [ 5.26162168e-02 -5.25487205e-03  2.70559742e-02]
 [ 6.48162702e-02 -5.68171636e-04 -4.82978166e-02]
 [-3.79192454e-02 -1.45399491e-02  1.40032781e-02]
 [ 9.92661231e-05  2.02402157e-03 -3.27203571e-02]
 [ 1.17096399e-01  2.31978089e-02  4.33256616e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.70123085]
curr_Stock_Price:  100.34588381413987
curr_Factors:  [100.34588381  -0.87978471  -0.9374788 ]
mat_Sqrt:  [[16.30316961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07141717 -0.08972147 -0.09823338]
Stock Position:  -0.07141716731928968
Bond Position:  [11.86764963]


portfolio before change:  [4.83437744]
curr_Stock_Price:  98.56464156367761
curr_Factors:  [98.56464156 -0.83088702 -0.91293934]
mat_Sqrt:  [[17.2340355   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00190942  0.02197184 -0.03898887]
Stock Position:  0.001909423084283211
Bond Position:  [4.64617584]


portfolio before change:  [4.83430425]
curr_Stock_Price:  97.30936240176348
curr_Factors:  [97.3093624  -0.81787134 -0.90774094]
mat_Sqrt:  [[17.32729354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00448599 0.11134516 1.02381437]
Stock Position:  0.004485988015529963
Bond Position:  [4.39777562]


portfolio before change:  [4.8526481]
curr_Stock_Price:  100.90821638240274
curr_Factors:  [100.90821638  -1.15757849  -0.90594962]
mat_Sqrt:  [[12.81585717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00876997 0.00841509 0.03521062]
Stock Position:  0.008769965493005592
Bond Position:  [3.96768653]


portfolio before change:  [4.87822263]
curr_Stock_Price:  103.59809968120702
curr_Factors:  [103.59809968  -1.40063707  -0.96471593]
mat_Sqrt:  [[ 9.72953379  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00586527 -0.001696    0.07718316]
Stock Position:  0.005865270561754036
Bond Position:  [4.27059174]


portfolio before change:  [4.89307071]
curr_Stock_Price:  105.76547651821035
curr_Factors:  [105.76547652  -1.54533402  -0.92351505]
mat_Sqrt:  [[ 8.9564602   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00612313 -0.00018338 -0.13778023]
Stock Position:  0.006123126869837948
Bond Position:  [4.24545528]


portfolio before change:  [4.901712]
curr_Stock_Price:  106.82997046808545
curr_Factors:  [106.82997047  -1.57255307  -0.9218262 ]
mat_Sqrt:  [[ 8.81856567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00431236 -0.00469275  0.03994745]
Stock Position:  -0.004312355803659101
Bond Position:  [5.36240084]


portfolio before change:  [4.90408052]
curr_Stock_Price:  106.90263259579389
curr_Factors:  [106.9026326   -0.96455414  -0.93061744]
mat_Sqrt:  [[16.06666875  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038381  0.00065325 -0.09334207]
Stock Position:  -0.0003838130490687123
Bond Position:  [4.94511115]


portfolio before change:  [4.90680935]
curr_Stock_Price:  106.23654416517489
curr_Factors:  [106.23654417  -0.52976516  -0.93995657]
mat_Sqrt:  [[24.43328709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00534825 0.00748706 0.12359605]
Stock Position:  0.005348254814962748
Bond Position:  [4.33862924]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.92412866]
Stock Price:  109.06914132449984
PL:  [-4.14501267]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.21125807e+00 -3.21127985e-01  4.34986190e-03]
 [ 1.58702701e-02  7.85462124e-02  7.31886754e-03]
 [-6.41659813e-02  3.31322993e-01  3.44381408e-01]
 [ 1.55313468e-01  9.57532656e-02  1.40639727e-01]
 [-1.19098317e-02 -1.29144172e-01 -6.28866681e-02]
 [-1.03832830e-01 -5.89587891e-02  1.49975979e-02]
 [ 2.78740998e-01  6.26977513e-01  3.35465044e-01]
 [-3.99803097e-02 -1.14009185e-01  3.07222769e-02]
 [-9.93829231e-02 -6.88883552e-02 -7.66508888e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.37781662]
curr_Stock_Price:  100.02879413640441
curr_Factors:  [100.02879414  -0.39645186  -0.95429034]
mat_Sqrt:  [[25.91225162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04924003 -0.10364361  0.01240895]
Stock Position:  -0.0492400332402407
Bond Position:  [7.30323777]


portfolio before change:  [2.41429]
curr_Stock_Price:  99.36224609650591
curr_Factors:  [99.3622461  -0.73390814 -1.00621284]
mat_Sqrt:  [[17.43799159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00191521 0.02535068 0.02087869]
Stock Position:  0.0019152094423074645
Bond Position:  [2.22399049]


portfolio before change:  [2.4114567]
curr_Stock_Price:  97.30212096631017
curr_Factors:  [97.30212097 -0.80737666 -0.95315999]
mat_Sqrt:  [[16.73134886  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00440859 0.10693404 0.9824243 ]
Stock Position:  0.00440858669436414
Bond Position:  [1.98249187]


portfolio before change:  [2.41303811]
curr_Stock_Price:  97.4359315761707
curr_Factors:  [ 9.74359316e+01 -6.81514730e-02 -9.94232857e-01]
mat_Sqrt:  [[33.67685208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00604472 0.03090423 0.401206  ]
Stock Position:  0.00604471536724236
Bond Position:  [1.82406564]


portfolio before change:  [2.40670399]
curr_Stock_Price:  96.23713517956669
curr_Factors:  [96.23713518  0.54324313 -0.95688095]
mat_Sqrt:  [[63.635881    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080313 -0.0416811  -0.17939816]
Stock Position:  -0.0008031312211567347
Bond Position:  [2.48399504]


portfolio before change:  [2.41185914]
curr_Stock_Price:  91.36515299165524
curr_Factors:  [ 9.13651530e+01 -2.48377126e-02 -9.62180409e-01]
mat_Sqrt:  [[34.05054457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331291 -0.01902887  0.04278397]
Stock Position:  -0.0033129094284228703
Bond Position:  [2.71454362]


portfolio before change:  [2.41915452]
curr_Stock_Price:  89.57284103191779
curr_Factors:  [89.57284103 -0.24724873 -0.92163518]
mat_Sqrt:  [[27.83149379  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01707414 0.20235612 0.9569884 ]
Stock Position:  0.017074137867299995
Bond Position:  [0.88977548]


portfolio before change:  [2.49710263]
curr_Stock_Price:  94.11205202313732
curr_Factors:  [94.11205202 -0.43201021 -0.85342362]
mat_Sqrt:  [[26.02486142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218949 -0.03679631  0.0876421 ]
Stock Position:  -0.0021894901834584347
Bond Position:  [2.70316005]


portfolio before change:  [2.49461323]
curr_Stock_Price:  95.86648664860459
curr_Factors:  [95.86648665 -0.34742094 -0.89567835]
mat_Sqrt:  [[27.65640019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00466767 -0.02223362 -0.21866365]
Stock Position:  -0.004667671711720083
Bond Position:  [2.94208652]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.48439549]
Stock Price:  98.37076484852345
PL:  [2.48439549]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-5.73351400e-01 -1.03850086e-01 -2.68873546e-02]
 [ 3.85887785e-02  4.62010092e-02 -3.53518804e-02]
 [-6.73892884e-02  3.20832104e-01  3.52888623e-01]
 [ 1.05108495e-01  2.95745966e-02  2.01166850e-02]
 [ 4.94494452e-02  2.12365853e-02  2.72134448e-02]
 [-1.02250473e-01 -5.74841684e-02  1.42209593e-02]
 [-2.95186085e-02  3.97255954e-02  4.60515463e-02]
 [-3.83333642e-02 -1.04083586e-01  5.98956046e-02]
 [-3.69274073e-02  1.95665193e-02 -6.00837765e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.93232029]
curr_Stock_Price:  97.12047742221448
curr_Factors:  [97.12047742 -0.8573118  -1.00103557]
mat_Sqrt:  [[15.14400697  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03962215 -0.03351747 -0.07670214]
Stock Position:  -0.039622146852527365
Bond Position:  [-15.08419847]


portfolio before change:  [-18.9119276]
curr_Stock_Price:  96.4154001831933
curr_Factors:  [96.41540018 -0.91790617 -1.02290144]
mat_Sqrt:  [[13.8440887   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00294735  0.01491131 -0.10084907]
Stock Position:  0.002947348036795585
Bond Position:  [-19.19609734]


portfolio before change:  [-18.916142]
curr_Stock_Price:  98.24282215383892
curr_Factors:  [98.24282215 -0.7856377  -1.05500709]
mat_Sqrt:  [[15.59261495  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00449786 0.10354812 1.00669302]
Stock Position:  0.0044978587212693944
Bond Position:  [-19.35802434]


portfolio before change:  [-18.92101192]
curr_Stock_Price:  99.31255769768937
curr_Factors:  [99.3125577  -0.52781489 -1.02887997]
mat_Sqrt:  [[20.93824024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00550436 0.00954516 0.0573873 ]
Stock Position:  0.005504363514299988
Bond Position:  [-19.46766433]


portfolio before change:  [-18.92710166]
curr_Stock_Price:  99.97503547664378
curr_Factors:  [99.97503548 -0.81813795 -1.001856  ]
mat_Sqrt:  [[16.19862823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00366323 0.00685408 0.07763238]
Stock Position:  0.003663227859149122
Bond Position:  [-19.293333]


portfolio before change:  [-18.94616837]
curr_Stock_Price:  97.4041802945508
curr_Factors:  [97.40418029 -0.86668203 -0.97377103]
mat_Sqrt:  [[15.4624741   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00718394 -0.01855294  0.04056844]
Stock Position:  -0.007183943395060194
Bond Position:  [-18.24642225]


portfolio before change:  [-18.95793263]
curr_Stock_Price:  97.77149473475208
curr_Factors:  [97.77149473 -0.74600558 -0.9729124 ]
mat_Sqrt:  [[17.52651879  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068521  0.01282138  0.13137224]
Stock Position:  -0.0006852143850195302
Bond Position:  [-18.89093819]


portfolio before change:  [-18.96737258]
curr_Stock_Price:  97.75999127353325
curr_Factors:  [97.75999127 -0.92807256 -0.95373858]
mat_Sqrt:  [[14.89021471  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00318016 -0.03359283  0.17086549]
Stock Position:  -0.0031801554938859088
Bond Position:  [-18.6564806]


portfolio before change:  [-18.9751525]
curr_Stock_Price:  97.2723892302543
curr_Factors:  [97.27238923 -0.71558671 -0.89008602]
mat_Sqrt:  [[19.52786561  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231454  0.00631507 -0.17140229]
Stock Position:  -0.0023145365033832616
Bond Position:  [-18.750012]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.98261188]
Stock Price:  96.44372829202987
PL:  [-18.98261188]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.11404804e+00 -2.89579925e-01 -1.63801135e-02]
 [-2.65516725e-02  1.75633991e-01  2.42478851e-01]
 [-1.20652095e-01  5.86393216e-01  6.93345219e-01]
 [ 1.02230543e-01  2.47663459e-02  1.16481267e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [-4.28086094e-02 -1.73144588e-03 -1.58906813e-02]
 [ 1.13263384e-01  3.22643153e-01  1.94638615e-01]
 [-3.96814390e-02 -1.29767463e-01  3.70616819e-02]
 [-1.01406146e-01 -1.89959736e-01 -9.05786902e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.26829016]
curr_Stock_Price:  100.01384643202404
curr_Factors:  [100.01384643  -0.60858044  -0.98454859]
mat_Sqrt:  [[20.33166684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05786549 -0.09346152 -0.0467279 ]
Stock Position:  -0.057865490112797464
Bond Position:  [8.05564041]


portfolio before change:  [2.1220937]
curr_Stock_Price:  102.60995839960542
curr_Factors:  [ 1.02609958e+02  1.59275013e-02 -1.06659233e+00]
mat_Sqrt:  [[35.88323389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00163852 0.05668563 0.69172467]
Stock Position:  0.001638516029568711
Bond Position:  [1.95396564]


portfolio before change:  [2.12261979]
curr_Stock_Price:  102.33462299590234
curr_Factors:  [102.334623    -0.27157943  -1.10704278]
mat_Sqrt:  [[25.78069224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00545266 0.1892576  1.97792092]
Stock Position:  0.0054526627113589314
Bond Position:  [1.5646236]


portfolio before change:  [2.11114854]
curr_Stock_Price:  100.08732516862922
curr_Factors:  [ 1.00087325e+02 -9.97541870e-02 -1.12980890e+00]
mat_Sqrt:  [[29.2675669   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00374693 0.0079933  0.03322886]
Stock Position:  0.003746933141765694
Bond Position:  [1.73612802]


portfolio before change:  [2.11212555]
curr_Stock_Price:  100.11634435338374
curr_Factors:  [100.11634435   0.11443158  -1.10708087]
mat_Sqrt:  [[37.10247469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0015719  -0.00140152  0.08089603]
Stock Position:  0.0015718977222611333
Bond Position:  [1.9547529]


portfolio before change:  [2.11347524]
curr_Stock_Price:  100.35304576067736
curr_Factors:  [100.35304576   0.20629539  -1.07960804]
mat_Sqrt:  [[41.90402015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110743 -0.00055882 -0.04533169]
Stock Position:  -0.0011074286158008766
Bond Position:  [2.22460908]


portfolio before change:  [2.12124258]
curr_Stock_Price:  94.34384869525566
curr_Factors:  [94.3438487  -0.30812979 -1.12134147]
mat_Sqrt:  [[22.58926532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00968837 0.10413263 0.55524979]
Stock Position:  0.009688366544834025
Bond Position:  [1.20720479]


portfolio before change:  [2.10745105]
curr_Stock_Price:  92.85801682130014
curr_Factors:  [92.85801682  0.10837678 -1.11551173]
mat_Sqrt:  [[33.91768909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172786 -0.04188227  0.10572666]
Stock Position:  -0.0017278573213261536
Bond Position:  [2.26789645]


portfolio before change:  [2.10743556]
curr_Stock_Price:  93.5234194228405
curr_Factors:  [93.52341942 -0.19335392 -1.11776232]
mat_Sqrt:  [[25.20634213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00629488 -0.06130924 -0.25839579]
Stock Position:  -0.0062948765716386015
Bond Position:  [2.69615394]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.0821209]
Stock Price:  97.75909836472735
PL:  [2.0821209]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.06723180e+00 -2.56127115e-01 -6.48082878e-02]
 [-2.78037999e-02  1.69341918e-01  2.58729198e-01]
 [-9.73019445e-02  4.23741458e-01  5.21105595e-01]
 [ 1.03265939e-01  2.53489765e-02  1.19578348e-02]
 [ 4.97768853e-02  1.91267552e-02  2.73078092e-02]
 [-2.30180229e-02  8.90391865e-03 -2.50442850e-02]
 [-5.04242269e-02 -3.27968829e-02  4.93589169e-02]
 [-2.26347702e-02 -5.73479024e-02  1.73202944e-02]
 [-1.28078863e-02  9.46926114e-02 -3.81272895e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.02564979]
curr_Stock_Price:  100.79958635047433
curr_Factors:  [100.79958635  -1.164726    -1.0194979 ]
mat_Sqrt:  [[11.34651164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09983178 -0.08266467 -0.18488001]
Stock Position:  -0.09983178124102216
Bond Position:  [18.08865205]


portfolio before change:  [7.93392082]
curr_Stock_Price:  101.80904006918047
curr_Factors:  [101.80904007  -1.45327611  -1.0422121 ]
mat_Sqrt:  [[ 8.39478505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00709677 0.05465487 0.73808238]
Stock Position:  0.007096769047421141
Bond Position:  [7.21140557]


portfolio before change:  [7.93748123]
curr_Stock_Price:  101.80253052437347
curr_Factors:  [101.80253052  -1.09211711  -1.04049789]
mat_Sqrt:  [[12.06634244  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00791989 0.13676197 1.48656921]
Stock Position:  0.007919893946492793
Bond Position:  [7.13121598]


portfolio before change:  [7.92921346]
curr_Stock_Price:  100.30828525698648
curr_Factors:  [100.30828526  -1.32985357  -1.05539443]
mat_Sqrt:  [[ 9.23499706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01200663 0.00818135 0.03411237]
Stock Position:  0.012006626491320508
Bond Position:  [6.72484935]


portfolio before change:  [7.93390047]
curr_Stock_Price:  100.41853664759007
curr_Factors:  [100.41853665  -0.79045434  -1.0282814 ]
mat_Sqrt:  [[16.29097181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00363731 0.00617313 0.07790158]
Stock Position:  0.003637309167883548
Bond Position:  [7.56864721]


portfolio before change:  [7.93818763]
curr_Stock_Price:  100.55651806675897
curr_Factors:  [100.55651807  -0.9818217   -1.03589545]
mat_Sqrt:  [[13.36985823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196806  0.00287373 -0.07144437]
Stock Position:  -0.0019680583666851874
Bond Position:  [8.13608872]


portfolio before change:  [7.9436138]
curr_Stock_Price:  99.86694842645552
curr_Factors:  [99.86694843 -1.01239787 -1.05806482]
mat_Sqrt:  [[12.59595949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00373481 -0.01058515  0.14080725]
Stock Position:  -0.003734810033361354
Bond Position:  [8.31659788]


portfolio before change:  [7.94725347]
curr_Stock_Price:  100.00609116392312
curr_Factors:  [100.00609116  -1.37868231  -1.08627489]
mat_Sqrt:  [[ 8.5017659   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362341 -0.01850896  0.04940998]
Stock Position:  -0.003623408569053171
Bond Position:  [8.3096164]


portfolio before change:  [7.95214126]
curr_Stock_Price:  99.80408771750862
curr_Factors:  [99.80408772 -0.83068248 -1.11104798]
mat_Sqrt:  [[14.31744436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.81119770e-05  3.05619089e-02 -1.08766544e-01]
Stock Position:  -8.811197698311513e-05
Bond Position:  [7.96093519]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.95624963]
Stock Price:  98.3637574630275
PL:  [7.95624963]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.64814570e-01 -2.14642236e-01 -4.97876420e-02]
 [-1.20173937e-03  1.16882503e-01  1.13116884e-01]
 [-9.93381522e-02  4.37649939e-01  5.52134319e-01]
 [ 1.05971552e-01  2.68714594e-02  1.27671390e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 2.63247990e-02  2.50663295e-02 -4.45049440e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 1.57248231e-02  1.51293686e-02 -4.84421130e-02]
 [ 8.42695233e-02  6.81796361e-02  7.16500918e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.07819441]
curr_Stock_Price:  99.55713247139788
curr_Factors:  [99.55713247 -1.01348247 -0.97345478]
mat_Sqrt:  [[13.65074948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06730701 -0.06927548 -0.14203028]
Stock Position:  -0.0673070071601841
Bond Position:  [5.62269821]


portfolio before change:  [-1.12528803]
curr_Stock_Price:  100.29859560354923
curr_Factors:  [100.2985956   -1.30393608  -0.95659887]
mat_Sqrt:  [[10.4606097   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00437323 0.03772367 0.32269098]
Stock Position:  0.004373233516711607
Bond Position:  [-1.56391721]


portfolio before change:  [-1.12152783]
curr_Stock_Price:  101.33726728696769
curr_Factors:  [101.33726729  -1.01136634  -0.94374039]
mat_Sqrt:  [[14.34422613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00715972 0.14125091 1.57508553]
Stock Position:  0.007159724926137979
Bond Position:  [-1.84707478]


portfolio before change:  [-1.12184865]
curr_Stock_Price:  101.42148006538778
curr_Factors:  [101.42148007  -1.06083493  -0.99369044]
mat_Sqrt:  [[12.99753255  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00877572 0.00867273 0.03642109]
Stock Position:  0.008775723129294854
Bond Position:  [-2.01189548]


portfolio before change:  [-1.11855946]
curr_Stock_Price:  101.9109428602272
curr_Factors:  [101.91094286  -1.25942578  -0.99596811]
mat_Sqrt:  [[10.68355283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00545898 -0.00140152  0.08089603]
Stock Position:  0.005458979460230913
Bond Position:  [-1.67488921]


portfolio before change:  [-1.11723114]
curr_Stock_Price:  102.30771617320173
curr_Factors:  [102.30771617  -1.52679791  -1.08755748]
mat_Sqrt:  [[ 7.49045619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00298472  0.00809012 -0.12696022]
Stock Position:  0.0029847192076786367
Bond Position:  [-1.42259095]


portfolio before change:  [-1.1167245]
curr_Stock_Price:  102.71583253119458
curr_Factors:  [102.71583253  -1.24812744  -1.15807489]
mat_Sqrt:  [[ 9.26055465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00518318 -0.01197701  0.13962421]
Stock Position:  -0.005183182959894237
Bond Position:  [-0.58432955]


portfolio before change:  [-1.11802497]
curr_Stock_Price:  102.91035146386076
curr_Factors:  [102.91035146  -0.83709145  -1.15729994]
mat_Sqrt:  [[14.00573441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063723  0.00488298 -0.13819186]
Stock Position:  0.0006372309598590838
Bond Position:  [-1.18360263]


portfolio before change:  [-1.11845835]
curr_Stock_Price:  103.15918085070685
curr_Factors:  [103.15918085  -0.98544433  -1.13813277]
mat_Sqrt:  [[12.33815061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00807651 0.02200488 0.02043978]
Stock Position:  0.008076509006406832
Bond Position:  [-1.95162441]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.11301923]
Stock Price:  103.95348193544115
PL:  [-5.06650116]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.91273761e-01 -2.32982774e-01 -2.65595342e-02]
 [ 5.17217774e-02  3.53645590e-02 -1.47303428e-03]
 [-6.89741646e-02  3.68178645e-01  3.83506537e-01]
 [ 1.41379702e-01  6.85994620e-02  7.53761886e-02]
 [ 4.92319527e-02  1.29614520e-02  4.64423238e-02]
 [-1.07337997e-01 -6.22253053e-02  1.67179742e-02]
 [ 1.00769030e-01  2.79307222e-01  1.56500872e-01]
 [-3.87526930e-02 -1.11819461e-01  5.06220402e-02]
 [ 7.39086953e-02  5.10020788e-02 -7.98020715e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.72369631]
curr_Stock_Price:  99.1960856415328
curr_Factors:  [99.19608564 -0.68887976 -1.00751325]
mat_Sqrt:  [[18.1869725   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05191918 -0.07519487 -0.07576696]
Stock Position:  -0.05191917527630526
Bond Position:  [1.42648265]


portfolio before change:  [-3.61036977]
curr_Stock_Price:  97.02707743973092
curr_Factors:  [97.02707744 -0.62515173 -1.02016392]
mat_Sqrt:  [[18.7215345   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00313221  0.01141386 -0.00420216]
Stock Position:  0.003132214184625593
Bond Position:  [-3.91427936]


portfolio before change:  [-3.61193882]
curr_Stock_Price:  97.15113737551177
curr_Factors:  [97.15113738 -0.45798343 -1.03173959]
mat_Sqrt:  [[21.90127528  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00385653 0.11882915 1.0940374 ]
Stock Position:  0.003856530247268715
Bond Position:  [-3.98660512]


portfolio before change:  [-3.60834937]
curr_Stock_Price:  98.59887714543024
curr_Factors:  [98.59887715 -0.68740957 -1.03516433]
mat_Sqrt:  [[17.61033541  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00969707 0.02214038 0.21502729]
Stock Position:  0.009697067352335475
Bond Position:  [-4.56446932]


portfolio before change:  [-3.63103183]
curr_Stock_Price:  96.49518341797423
curr_Factors:  [96.49518342 -0.36746881 -1.08214901]
mat_Sqrt:  [[22.6435553   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00270972 0.00418329 0.13248702]
Stock Position:  0.0027097201309363634
Bond Position:  [-3.89250677]


portfolio before change:  [-3.63172788]
curr_Stock_Price:  96.9567418612258
curr_Factors:  [96.95674186 -0.61845402 -1.0691812 ]
mat_Sqrt:  [[17.93276883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00650358 -0.02008313  0.04769173]
Stock Position:  -0.006503576967423973
Bond Position:  [-3.00116224]


portfolio before change:  [-3.61336219]
curr_Stock_Price:  93.90201583540835
curr_Factors:  [93.90201584 -0.93429498 -1.02468988]
mat_Sqrt:  [[13.24032367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01432956 0.09014602 0.44645343]
Stock Position:  0.014329557870876246
Bond Position:  [-4.95893656]


portfolio before change:  [-3.59493664]
curr_Stock_Price:  95.36093268299126
curr_Factors:  [95.36093268 -1.45852399 -1.07689222]
mat_Sqrt:  [[ 7.55532618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00678257 -0.03608958  0.14441059]
Stock Position:  -0.0067825746859149485
Bond Position:  [-2.94814399]


portfolio before change:  [-3.6058364]
curr_Stock_Price:  96.75056964798553
curr_Factors:  [96.75056965 -1.39628079 -1.05433846]
mat_Sqrt:  [[ 8.34378517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00815336  0.01646085 -0.2276531 ]
Stock Position:  0.008153364454768466
Bond Position:  [-4.39467906]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.59789088]
Stock Price:  97.99464667401047
PL:  [-3.59789088]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-5.64005235e-01 -9.04903590e-02 -5.79089420e-02]
 [ 2.32750923e-02  6.21377650e-02 -4.19038328e-02]
 [-4.25927002e-02  1.65959634e-01  1.68835398e-01]
 [ 1.76047186e-01  1.11132144e-01  1.40888069e-01]
 [ 5.53299975e-02 -2.98391003e-02  5.51941414e-02]
 [-4.68493668e-02 -5.85508042e-03 -1.29705353e-02]
 [ 2.52640888e-04  8.54208232e-02  5.98305358e-02]
 [-3.82026120e-02 -1.07810361e-01  6.26888816e-02]
 [ 8.31014596e-02  8.88224050e-02 -7.10672502e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.13167558]
curr_Stock_Price:  97.7756489638449
curr_Factors:  [97.77564896 -1.2635897  -0.96725532]
mat_Sqrt:  [[10.50478158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05657396 -0.02920564 -0.16519809]
Stock Position:  -0.0565739621272047
Bond Position:  [-8.60011972]


portfolio before change:  [-14.1062773]
curr_Stock_Price:  97.25068274158946
curr_Factors:  [97.25068274 -1.18465374 -0.96710514]
mat_Sqrt:  [[11.30825648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00242348  0.02005488 -0.11953997]
Stock Position:  0.0024234793819073166
Bond Position:  [-14.34196232]


portfolio before change:  [-14.11564063]
curr_Stock_Price:  96.3467939496964
curr_Factors:  [96.34679395 -1.40504178 -0.97668758]
mat_Sqrt:  [[ 8.90154411  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00289243 0.05356324 0.4816404 ]
Stock Position:  0.0028924250881495243
Bond Position:  [-14.39431651]


portfolio before change:  [-14.12131545]
curr_Stock_Price:  96.87373276883982
curr_Factors:  [96.87373277 -1.45214116 -1.0297913 ]
mat_Sqrt:  [[ 8.09685691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02809616 0.03586775 0.40191444]
Stock Position:  0.028096161097379842
Bond Position:  [-16.84309545]


portfolio before change:  [-14.1062613]
curr_Stock_Price:  97.70935588448944
curr_Factors:  [97.70935588 -1.24319642 -1.07283989]
mat_Sqrt:  [[ 9.64038464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00627626 -0.00963053  0.15745352]
Stock Position:  0.006276261357716242
Bond Position:  [-14.71951076]


portfolio before change:  [-14.11561654]
curr_Stock_Price:  97.39170871687477
curr_Factors:  [97.39170872 -1.22840976 -1.11429354]
mat_Sqrt:  [[ 9.35618655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00541803 -0.00188972 -0.03700133]
Stock Position:  -0.005418033214452681
Bond Position:  [-13.58794502]


portfolio before change:  [-14.11732268]
curr_Stock_Price:  96.45234047624808
curr_Factors:  [96.45234048 -1.3222363  -1.15027192]
mat_Sqrt:  [[ 8.13797021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00367437 0.02756945 0.17067987]
Stock Position:  0.003674374521862573
Bond Position:  [-14.4717247]


portfolio before change:  [-14.12273777]
curr_Stock_Price:  96.94836428474771
curr_Factors:  [96.94836428 -1.4783094  -1.1940403 ]
mat_Sqrt:  [[ 6.6981329   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00707854 -0.03479564  0.17883393]
Stock Position:  -0.007078539088221117
Bond Position:  [-13.43648499]


portfolio before change:  [-14.12964996]
curr_Stock_Price:  96.97552533707778
curr_Factors:  [96.97552534 -1.51133307 -1.16902667]
mat_Sqrt:  [[ 6.64655642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01304822  0.02866731 -0.20273508]
Stock Position:  0.013048217733849414
Bond Position:  [-15.39500773]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.14748896]
Stock Price:  96.19844028284908
PL:  [-14.14748896]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-6.25505415e-01 -1.24270295e-01 -2.65202577e-02]
 [ 4.60737409e-02  4.44149191e-02  1.89121579e-02]
 [-8.29843819e-02  4.17159185e-01  4.68102081e-01]
 [ 1.91520843e-01  1.19952179e-01  1.45575437e-01]
 [ 5.06050278e-02  1.37906958e-02  2.75464699e-02]
 [-5.29299644e-02 -1.04125263e-02 -1.09297790e-02]
 [-5.04633364e-02 -1.46827559e-02  5.11008259e-02]
 [-3.80759002e-02 -1.12121475e-01  6.64296195e-02]
 [-9.97856274e-02  1.51954685e-02 -4.44619590e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.51928889]
curr_Stock_Price:  97.44979766997255
curr_Factors:  [97.44979767 -0.84590469 -0.98598755]
mat_Sqrt:  [[15.60271764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04206225 -0.04010807 -0.07565491]
Stock Position:  -0.04206224985305143
Bond Position:  [-12.42033115]


portfolio before change:  [-16.56099922]
curr_Stock_Price:  98.29375187398531
curr_Factors:  [98.29375187 -0.50911757 -0.94331088]
mat_Sqrt:  [[23.00086936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00256513 0.01433485 0.05395112]
Stock Position:  0.0025651346225026594
Bond Position:  [-16.81313592]


portfolio before change:  [-16.56818114]
curr_Stock_Price:  98.77198946293771
curr_Factors:  [98.77198946 -0.56746437 -0.927657  ]
mat_Sqrt:  [[22.14679257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00441232 0.13463755 1.33536494]
Stock Position:  0.004412323680852066
Bond Position:  [-17.00399513]


portfolio before change:  [-16.58187991]
curr_Stock_Price:  97.59468695325445
curr_Factors:  [97.59468695 -0.3339914  -0.95219326]
mat_Sqrt:  [[26.96766064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00911171 0.0387144  0.4152862 ]
Stock Position:  0.009111707684636884
Bond Position:  [-17.47113417]


portfolio before change:  [-16.55803463]
curr_Stock_Price:  101.1706388741583
curr_Factors:  [101.17063887  -0.52239028  -0.98658499]
mat_Sqrt:  [[22.37251768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00263908 0.00445093 0.07858241]
Stock Position:  0.0026390834633789667
Bond Position:  [-16.82503239]


portfolio before change:  [-16.57099359]
curr_Stock_Price:  99.44869887445563
curr_Factors:  [99.44869887 -1.20753459 -0.93765623]
mat_Sqrt:  [[11.64004252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0049215  -0.00336063 -0.03117962]
Stock Position:  -0.004921497848122815
Bond Position:  [-16.08155703]


portfolio before change:  [-16.5794379]
curr_Stock_Price:  99.53028332404904
curr_Factors:  [99.53028332 -0.87581947 -1.01622017]
mat_Sqrt:  [[15.00558283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286757 -0.00473884  0.14577643]
Stock Position:  -0.002867567989805933
Bond Position:  [-16.29402804]


portfolio before change:  [-16.58107433]
curr_Stock_Price:  97.2591545440679
curr_Factors:  [97.25915454 -0.55541506 -1.05927216]
mat_Sqrt:  [[19.3499898   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244975 -0.03618705  0.18950521]
Stock Position:  -0.00244975380982765
Bond Position:  [-16.34281335]


portfolio before change:  [-16.59230785]
curr_Stock_Price:  98.50828532824896
curr_Factors:  [98.50828533 -0.32841331 -1.06002351]
mat_Sqrt:  [[24.57436547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430366  0.00490432 -0.12683759]
Stock Position:  -0.004303656381087863
Bond Position:  [-16.16836204]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.60337985]
Stock Price:  99.20206799290727
PL:  [-16.60337985]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.44075018e+00 -3.36442747e-01 -7.12787395e-02]
 [-4.20193865e-03  1.24324121e-01  1.21012525e-01]
 [-7.96561309e-02  3.81041243e-01  4.35679444e-01]
 [ 1.37651866e-01  6.47815488e-02  7.01570950e-02]
 [ 5.08825440e-02  1.20025458e-02  2.76264468e-02]
 [ 5.32484673e-02  5.80416442e-03 -4.67054682e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 3.80409433e-03  6.67404803e-03 -3.74878534e-02]
 [ 1.48257482e-01  2.26953412e-02  4.88794042e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.81647157]
curr_Stock_Price:  101.4534173001677
curr_Factors:  [101.4534173  -0.332466   -1.0356297]
mat_Sqrt:  [[25.82915906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05900215 -0.10858643 -0.2033384 ]
Stock Position:  -0.05900215232013524
Bond Position:  [18.80244155]


portfolio before change:  [12.86658302]
curr_Stock_Price:  100.76347842664369
curr_Factors:  [100.76347843  -0.55277587  -1.04594552]
mat_Sqrt:  [[20.36982377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00225221 0.04012544 0.34521505]
Stock Position:  0.0022522136156376588
Bond Position:  [12.63964215]


portfolio before change:  [12.86876418]
curr_Stock_Price:  98.92518000508193
curr_Factors:  [98.92518001 -0.55102573 -1.04560097]
mat_Sqrt:  [[20.04013685  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0043441  0.12298053 1.24287218]
Stock Position:  0.004344096135568959
Bond Position:  [12.43902369]


portfolio before change:  [12.87396476]
curr_Stock_Price:  98.6902652171274
curr_Factors:  [98.69026522 -0.62799498 -1.01284865]
mat_Sqrt:  [[19.1277981   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00863644 0.02090815 0.20013866]
Stock Position:  0.008636441066825911
Bond Position:  [12.0216321]


portfolio before change:  [12.902759]
curr_Stock_Price:  101.32814886760264
curr_Factors:  [101.32814887  -0.63784614  -0.9755705 ]
mat_Sqrt:  [[20.18515855  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00292154 0.0038738  0.07881056]
Stock Position:  0.0029215414937373676
Bond Position:  [12.60672461]


portfolio before change:  [12.91972493]
curr_Stock_Price:  104.97724610198782
curr_Factors:  [104.9772461   -1.07580201  -0.95981633]
mat_Sqrt:  [[13.70999711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00327495  0.00187329 -0.1332377 ]
Stock Position:  0.0032749477103900327
Bond Position:  [12.57592994]


portfolio before change:  [12.92579204]
curr_Stock_Price:  104.9093271457782
curr_Factors:  [104.90932715  -0.80064433  -0.99899266]
mat_Sqrt:  [[17.34769148  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00276689 -0.01197701  0.13962421]
Stock Position:  -0.0027668897109260223
Bond Position:  [13.21606458]


portfolio before change:  [12.92794729]
curr_Stock_Price:  106.5192341256033
curr_Factors:  [106.51923413  -0.59125359  -0.98936279]
mat_Sqrt:  [[21.92679014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00011337  0.00215404 -0.10694241]
Stock Position:  -0.00011336576558263351
Bond Position:  [12.94002292]


portfolio before change:  [12.93444315]
curr_Stock_Price:  106.30551690574043
curr_Factors:  [106.30551691  -0.71480016  -0.93123882]
mat_Sqrt:  [[20.4969932   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00794593 0.00732489 0.13943933]
Stock Position:  0.007945927182431705
Bond Position:  [12.08974725]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.95095247]
Stock Price:  107.62228406863964
PL:  [5.3286684]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.33122976e+00 -3.18587227e-01 -5.73927689e-02]
 [-5.75857812e-02  1.97628457e-01  3.73528924e-01]
 [-9.62634941e-02  4.15689615e-01  5.21891547e-01]
 [ 1.05229061e-01  2.64536503e-02  1.25450448e-02]
 [ 5.28370404e-02 -5.91070546e-04  2.81897093e-02]
 [-1.00598254e-02  2.03692092e-02 -3.18906199e-02]
 [-5.03256450e-02  3.84006655e-03  5.27953015e-02]
 [-1.05540764e-02 -3.89804172e-02 -3.85613879e-04]
 [-2.30193190e-02  8.67914871e-02 -3.77099385e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.71913622]
curr_Stock_Price:  101.44013338509528
curr_Factors:  [101.44013339  -0.8195751   -0.9781267 ]
mat_Sqrt:  [[16.80652165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08377559 -0.10282359 -0.16372559]
Stock Position:  -0.08377559494663961
Bond Position:  [21.21734374]


portfolio before change:  [12.59656993]
curr_Stock_Price:  103.02982792512002
curr_Factors:  [103.02982793  -0.84178916  -0.99340814]
mat_Sqrt:  [[16.4417074   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00358851 0.06378431 1.06557405]
Stock Position:  0.003588509966649903
Bond Position:  [12.22684637]


portfolio before change:  [12.59717272]
curr_Stock_Price:  101.49376690428876
curr_Factors:  [101.4937669   -1.10548911  -0.99043057]
mat_Sqrt:  [[12.47938029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00762213 0.13416325 1.48881132]
Stock Position:  0.007622130029701386
Bond Position:  [11.82357403]


portfolio before change:  [12.60003517]
curr_Stock_Price:  101.09350940690508
curr_Factors:  [101.09350941  -0.8840973   -0.99054374]
mat_Sqrt:  [[15.50875783  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00729843 0.00853788 0.03578752]
Stock Position:  0.007298433422178093
Bond Position:  [11.86221092]


portfolio before change:  [12.60458536]
curr_Stock_Price:  100.90409899229232
curr_Factors:  [100.90409899  -1.11763805  -0.99025952]
mat_Sqrt:  [[12.25915463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00476954 -0.00019077  0.08041739]
Stock Position:  0.004769544939600061
Bond Position:  [12.12331872]


portfolio before change:  [12.61107669]
curr_Stock_Price:  100.99386858094685
curr_Factors:  [100.99386858  -0.53060691  -0.94553351]
mat_Sqrt:  [[23.07891386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00053779  0.00657413 -0.09097506]
Stock Position:  -0.0005377906265063668
Bond Position:  [12.66539025]


portfolio before change:  [12.61814215]
curr_Stock_Price:  99.63427627631926
curr_Factors:  [ 9.96342763e+01 -6.30564676e-02 -9.25339788e-01]
mat_Sqrt:  [[37.08119579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104541  0.00123938  0.1506103 ]
Stock Position:  -0.0010454085428983455
Bond Position:  [12.72230067]


portfolio before change:  [12.62285618]
curr_Stock_Price:  101.21137271450596
curr_Factors:  [101.21137271  -0.62693857  -0.94511345]
mat_Sqrt:  [[21.01337435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088466 -0.01258088 -0.00110005]
Stock Position:  -0.0008846572437269169
Bond Position:  [12.71239355]


portfolio before change:  [12.63072689]
curr_Stock_Price:  99.50118373488246
curr_Factors:  [99.50118373 -0.67401773 -0.92840956]
mat_Sqrt:  [[20.04024     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064872  0.02801183 -0.10757596]
Stock Position:  -0.0006487242579542267
Bond Position:  [12.69527572]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.63655965]
Stock Price:  100.2973137126642
PL:  [12.33924594]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-6.85361124e-01 -1.44677970e-01 -4.26735985e-02]
 [ 2.05446731e-02  7.09872972e-02 -1.80194280e-03]
 [-6.06779410e-02  3.04586492e-01  3.15998542e-01]
 [ 9.93002465e-02  2.31174304e-02  1.07716149e-02]
 [ 5.25234471e-02 -1.74316967e-02  6.57019425e-02]
 [-5.28147575e-02  5.12695934e-02 -2.48012723e-02]
 [ 7.83439502e-02  2.28399981e-01  1.20829800e-01]
 [-4.01900765e-02 -1.07910897e-01  2.58316359e-02]
 [-1.12153287e-02 -1.11163051e-01 -1.13567598e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.87529018]
curr_Stock_Price:  98.22006657296298
curr_Factors:  [98.22006657 -0.99819263 -0.99060648]
mat_Sqrt:  [[13.44236694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05383011 -0.04669461 -0.1217359 ]
Stock Position:  -0.053830110890057035
Bond Position:  [-5.5880931]


portfolio before change:  [-10.93167661]
curr_Stock_Price:  99.21563740343932
curr_Factors:  [99.2156374  -0.73559922 -0.98702788]
mat_Sqrt:  [[17.71954964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00195643  0.02291105 -0.00514044]
Stock Position:  0.0019564308979880783
Bond Position:  [-11.12578515]


portfolio before change:  [-10.94184906]
curr_Stock_Price:  96.86024194223549
curr_Factors:  [96.86024194 -0.82171528 -0.97139445]
mat_Sqrt:  [[16.12159064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00409379 0.09830487 0.90145588]
Stock Position:  0.004093792604269592
Bond Position:  [-11.3383748]


portfolio before change:  [-10.93696588]
curr_Stock_Price:  99.43823977926714
curr_Factors:  [99.43823978 -0.58452883 -0.97988826]
mat_Sqrt:  [[20.80346712  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00510577 0.00746112 0.03072842]
Stock Position:  0.005105774834420826
Bond Position:  [-11.44467514]


portfolio before change:  [-10.96310984]
curr_Stock_Price:  95.4388097465469
curr_Factors:  [95.43880975 -0.50209125 -0.90980412]
mat_Sqrt:  [[23.25662258  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0026821  -0.00562606  0.18742935]
Stock Position:  0.0026820992383922463
Bond Position:  [-11.21908619]


portfolio before change:  [-10.97562306]
curr_Stock_Price:  92.86534863449921
curr_Factors:  [92.86534863 -0.74907538 -0.81542049]
mat_Sqrt:  [[19.42682248  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244054  0.01654719 -0.07075113]
Stock Position:  -0.0024405398333231247
Bond Position:  [-10.74898148]


portfolio before change:  [-10.98411441]
curr_Stock_Price:  94.14191593726943
curr_Factors:  [94.14191594 -0.98758283 -0.82035301]
mat_Sqrt:  [[15.43854878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00969198 0.07371578 0.34469379]
Stock Position:  0.009691984834460056
Bond Position:  [-11.89653643]


portfolio before change:  [-10.98863452]
curr_Stock_Price:  94.28942342324378
curr_Factors:  [94.28942342 -0.81220714 -0.76099442]
mat_Sqrt:  [[19.55375742  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029122  -0.03482809  0.07369047]
Stock Position:  -0.0029121991438419786
Bond Position:  [-10.71404494]


portfolio before change:  [-10.99554217]
curr_Stock_Price:  94.82142308125948
curr_Factors:  [94.82142308 -0.7935667  -0.7846517 ]
mat_Sqrt:  [[19.56567913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291778 -0.03587772 -0.32397675]
Stock Position:  -0.002917776584130484
Bond Position:  [-10.71887445]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.00294186]
Stock Price:  95.52021298604497
PL:  [-11.00294186]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.14758951e+00 -2.68733659e-01 -7.60378505e-02]
 [-2.46072241e-02  1.70511180e-01  2.41914701e-01]
 [-9.37460957e-02  4.35131342e-01  5.23188688e-01]
 [ 1.54234139e-01  8.17645044e-02  9.33728231e-02]
 [ 4.88324075e-02  2.52124111e-02  2.70356219e-02]
 [-3.11052907e-02  5.24935787e-03 -2.14092537e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-3.83652980e-02 -1.03800678e-01  5.98810196e-02]
 [-3.58866610e-02  6.99682630e-02 -4.26057223e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.29319647]
curr_Stock_Price:  101.38200294292064
curr_Factors:  [101.38200294  -1.27985166  -1.0517163 ]
mat_Sqrt:  [[ 9.84858339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12366913 -0.08673342 -0.21691482]
Stock Position:  -0.1236691264471909
Bond Position:  [24.83102021]


portfolio before change:  [12.22501456]
curr_Stock_Price:  102.03374623116748
curr_Factors:  [102.03374623  -0.79508373  -1.06323541]
mat_Sqrt:  [[15.91058274  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00374461 0.05503225 0.6901153 ]
Stock Position:  0.0037446055354986526
Bond Position:  [11.84293843]


portfolio before change:  [12.22336784]
curr_Stock_Price:  100.01225920748448
curr_Factors:  [100.01225921  -0.45349239  -1.05170207]
mat_Sqrt:  [[22.20013364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00458872 0.14043804 1.4925117 ]
Stock Position:  0.004588718378792914
Bond Position:  [11.76443975]


portfolio before change:  [12.22054268]
curr_Stock_Price:  98.11437562934363
curr_Factors:  [98.11437563 -1.03722239 -0.99995468]
mat_Sqrt:  [[12.79375077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01484974 0.02638938 0.26636667]
Stock Position:  0.014849741813408942
Bond Position:  [10.76356953]


portfolio before change:  [12.24900072]
curr_Stock_Price:  99.66826855325046
curr_Factors:  [99.66826855 -0.79721982 -0.96905377]
mat_Sqrt:  [[17.04017451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0034916  0.00813727 0.0771251 ]
Stock Position:  0.003491601127849402
Bond Position:  [11.90099888]


portfolio before change:  [12.25782328]
curr_Stock_Price:  100.49040675415516
curr_Factors:  [100.49040675  -0.53907287  -0.97938572]
mat_Sqrt:  [[22.0123504   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156294  0.00169422 -0.06107464]
Stock Position:  -0.0015629369436472595
Bond Position:  [12.41488345]


portfolio before change:  [12.26307049]
curr_Stock_Price:  101.10577730182325
curr_Factors:  [101.1057773   -0.12070911  -0.98887423]
mat_Sqrt:  [[33.33420112  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143994 -0.01197701  0.13962421]
Stock Position:  -0.0014399369850457624
Bond Position:  [12.40865644]


portfolio before change:  [12.27352321]
curr_Stock_Price:  98.15645069156218
curr_Factors:  [98.15645069 -0.69064564 -1.01521085]
mat_Sqrt:  [[17.82685735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.002655   -0.03350152  0.17082388]
Stock Position:  -0.002655003052721388
Bond Position:  [12.53412889]


portfolio before change:  [12.27999752]
curr_Stock_Price:  98.07898276813943
curr_Factors:  [98.07898277 -0.80252399 -1.01045489]
mat_Sqrt:  [[16.00328829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189344  0.02258216 -0.12154227]
Stock Position:  -0.0018934424733897354
Bond Position:  [12.46570444]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.28784419]
Stock Price:  97.22749050192277
PL:  [12.28784419]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.24251971e+00 -3.02245417e-01 -5.01016964e-02]
 [ 1.29182338e-02  8.96347351e-02  4.67762209e-02]
 [-6.93921147e-02  2.76952516e-01  3.39364239e-01]
 [ 1.08059841e-01  2.80465664e-02  1.33917890e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 2.50273223e-02  2.09266850e-02 -4.34229532e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 2.16977284e-02  2.15287295e-02 -5.53885701e-02]
 [ 1.12581144e-01  5.54465467e-02  2.22392277e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.23331719]
curr_Stock_Price:  101.23735513355862
curr_Factors:  [101.23735513  -0.96090827  -1.03258494]
mat_Sqrt:  [[13.7904262   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09531556 -0.09754929 -0.14292619]
Stock Position:  -0.09531556457443385
Bond Position:  [20.88281285]


portfolio before change:  [11.3772019]
curr_Stock_Price:  99.83736664538714
curr_Factors:  [99.83736665 -0.56368811 -1.07543196]
mat_Sqrt:  [[19.38350532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00210297 0.02892949 0.13343954]
Stock Position:  0.002102973785865412
Bond Position:  [11.16724654]


portfolio before change:  [11.38183215]
curr_Stock_Price:  99.38335443991092
curr_Factors:  [99.38335444 -0.96550566 -1.13306422]
mat_Sqrt:  [[12.18754776  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00462874 0.08938604 0.96811171]
Stock Position:  0.004628742157129507
Bond Position:  [10.92181222]


portfolio before change:  [11.40043483]
curr_Stock_Price:  102.22222865411938
curr_Factors:  [102.22222865  -1.48798095  -1.17780061]
mat_Sqrt:  [[ 7.10904269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01639017 0.00905199 0.03820305]
Stock Position:  0.016390168842002655
Bond Position:  [9.72499525]


portfolio before change:  [11.41308921]
curr_Stock_Price:  102.69755423082663
curr_Factors:  [102.69755423  -1.25544611  -1.26257602]
mat_Sqrt:  [[ 8.27936422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00704418 -0.00140152  0.08089603]
Stock Position:  0.007044175606016561
Bond Position:  [10.68966961]


portfolio before change:  [11.41701267]
curr_Stock_Price:  102.49558458206198
curr_Factors:  [102.49558458  -1.02547537  -1.24863021]
mat_Sqrt:  [[10.54565732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193779  0.00675406 -0.1238736 ]
Stock Position:  0.0019377920402395383
Bond Position:  [11.21839755]


portfolio before change:  [11.42556125]
curr_Stock_Price:  104.01172760748207
curr_Factors:  [104.01172761  -0.78107226  -1.24725085]
mat_Sqrt:  [[13.68336064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00350785 -0.01197701  0.13962421]
Stock Position:  -0.003507847984390408
Bond Position:  [11.79041858]


portfolio before change:  [11.43091081]
curr_Stock_Price:  104.16769833911984
curr_Factors:  [104.16769834  -0.36351766  -1.2738532 ]
mat_Sqrt:  [[20.25965008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00072983  0.00694837 -0.15800817]
Stock Position:  0.0007298308361399292
Bond Position:  [11.35488601]


portfolio before change:  [11.43657196]
curr_Stock_Price:  104.14343338982547
curr_Factors:  [104.14343339  -0.9076993   -1.26293953]
mat_Sqrt:  [[11.88325516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01080838 0.0178953  0.06344233]
Stock Position:  0.010808375718404737
Bond Position:  [10.3109506]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.45671331]
Stock Price:  105.52981970293195
PL:  [5.92689361]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-6.75084998e-01 -1.30094459e-01 -1.03572232e-01]
 [-8.20077636e-04  1.15937644e-01  1.12085048e-01]
 [-6.92737647e-02  2.47215622e-01  3.23886100e-01]
 [ 1.03610826e-01  2.55430484e-02  1.20609973e-02]
 [ 5.24870744e-02  1.66390297e-03  2.80888533e-02]
 [-4.20249558e-02 -2.87860757e-03 -1.59193526e-02]
 [ 3.47829746e-02  1.79457803e-01  1.26541135e-01]
 [-3.83993635e-02 -1.21789475e-01  6.18979217e-02]
 [-1.26960934e-01 -1.60628389e-01 -6.78193016e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.78277023]
curr_Stock_Price:  99.59745070585139
curr_Factors:  [99.59745071 -1.59433513 -1.08446433]
mat_Sqrt:  [[ 6.83691844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10571751 -0.04198781 -0.29546275]
Stock Position:  -0.10571751273268658
Bond Position:  [9.74642454]


portfolio before change:  [-0.8437222]
curr_Stock_Price:  100.22011386886912
curr_Factors:  [100.22011387  -1.40945871  -1.05313097]
mat_Sqrt:  [[ 8.54015557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0053541  0.03741871 0.31974744]
Stock Position:  0.005354101487590424
Bond Position:  [-1.38031086]


portfolio before change:  [-0.84546464]
curr_Stock_Price:  100.02360726033967
curr_Factors:  [100.02360726  -1.49389066  -1.01866516]
mat_Sqrt:  [[ 8.10799342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00583398 0.0797885  0.92395689]
Stock Position:  0.005833981790610325
Bond Position:  [-1.42900055]


portfolio before change:  [-0.84385162]
curr_Stock_Price:  100.42259813210457
curr_Factors:  [100.42259813  -1.1433577   -1.05716339]
mat_Sqrt:  [[11.12134433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01000659 0.00824398 0.03440667]
Stock Position:  0.01000658876334948
Bond Position:  [-1.84873926]


portfolio before change:  [-0.8364108]
curr_Stock_Price:  101.25858925103712
curr_Factors:  [101.25858925  -0.91617154  -1.03527424]
mat_Sqrt:  [[14.38565825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00407074 0.00053702 0.08012968]
Stock Position:  0.004070743884155957
Bond Position:  [-1.24860858]


portfolio before change:  [-0.84119264]
curr_Stock_Price:  100.237304968634
curr_Factors:  [100.23730497  -0.39784102  -1.06866107]
mat_Sqrt:  [[23.12786881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198298 -0.00092907 -0.04541348]
Stock Position:  -0.001982978790898789
Bond Position:  [-0.64242419]


portfolio before change:  [-0.83436252]
curr_Stock_Price:  96.63090547746066
curr_Factors:  [96.63090548 -0.09906484 -1.07770043]
mat_Sqrt:  [[29.78882598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00326447 0.05791976 0.36098663]
Stock Position:  0.0032644705863587964
Bond Position:  [-1.14981127]


portfolio before change:  [-0.83741628]
curr_Stock_Price:  95.87160698901701
curr_Factors:  [ 9.58716070e+01 -6.45546587e-03 -1.13206180e+00]
mat_Sqrt:  [[30.70706019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164863 -0.03930738  0.17657754]
Stock Position:  -0.0016486330968657299
Bond Position:  [-0.67935918]


portfolio before change:  [-0.83474463]
curr_Stock_Price:  94.04499616598198
curr_Factors:  [ 9.40449962e+01  7.88452665e-03 -1.12657084e+00]
mat_Sqrt:  [[30.72531893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00564982 -0.05184259 -0.19346959]
Stock Position:  -0.005649823324298525
Bond Position:  [-0.30340702]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.84878834]
Stock Price:  96.5038276661892
PL:  [-0.84878834]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.92475512e-01 -1.83467930e-01 -6.18265883e-02]
 [ 3.37164794e-02  5.79426408e-02  1.67332720e-02]
 [-8.94773520e-02  4.91025627e-01  5.33068722e-01]
 [ 2.08227120e-01  2.25223504e-01  2.00482985e-01]
 [ 1.94554385e-02 -1.69819252e-01  1.63201447e-02]
 [-1.07337997e-01 -6.22253053e-02  1.67179742e-02]
 [ 6.23610034e-01  1.29761652e+00  6.82491008e-01]
 [-4.61716631e-02 -1.57365630e-01 -9.00975744e-02]
 [ 2.18839744e-01 -8.28820814e-01 -1.64524600e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.45045407]
curr_Stock_Price:  99.36985231851003
curr_Factors:  [99.36985232 -1.16189921 -0.99531477]
mat_Sqrt:  [[11.4918121   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07331707 -0.05921402 -0.17637405]
Stock Position:  -0.0733170746272797
Bond Position:  [4.83505281]


portfolio before change:  [-2.44056922]
curr_Stock_Price:  99.26801078671407
curr_Factors:  [99.26801079 -0.54617247 -0.9705802 ]
mat_Sqrt:  [[21.78171166  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00224774 0.01870091 0.04773537]
Stock Position:  0.0022477405380793352
Bond Position:  [-2.66369795]


portfolio before change:  [-2.44413865]
curr_Stock_Price:  98.27267664680839
curr_Factors:  [ 9.82726766e+01 -6.28057998e-02 -9.83235716e-01]
mat_Sqrt:  [[34.52571862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00346307 0.15847784 1.52069669]
Stock Position:  0.003463071487154907
Bond Position:  [-2.78446396]


portfolio before change:  [-2.45764656]
curr_Stock_Price:  94.77424193993173
curr_Factors:  [94.77424194 -0.17270616 -0.98228417]
mat_Sqrt:  [[29.85962785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00988372 0.07269057 0.57192215]
Stock Position:  0.00988371638401368
Bond Position:  [-3.39436829]


portfolio before change:  [-2.46911612]
curr_Stock_Price:  93.78555027082318
curr_Factors:  [93.78555027  0.30975704 -1.02500405]
mat_Sqrt:  [[45.86782037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025895 -0.05480893  0.04655683]
Stock Position:  -0.00025894920317281084
Bond Position:  [-2.44483042]


portfolio before change:  [-2.46953933]
curr_Stock_Price:  90.69804324689136
curr_Factors:  [90.69804325  0.59760945 -1.01943321]
mat_Sqrt:  [[59.4842768   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196064 -0.02008313  0.04769173]
Stock Position:  -0.001960638148831526
Bond Position:  [-2.29171329]


portfolio before change:  [-2.45185769]
curr_Stock_Price:  81.09515786643676
curr_Factors:  [81.09515787  0.68024787 -0.92636972]
mat_Sqrt:  [[63.40237973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01621071 0.41880393 1.94695688]
Stock Position:  0.01621071314683756
Bond Position:  [-3.76646803]


portfolio before change:  [-2.49159936]
curr_Stock_Price:  78.75979106093963
curr_Factors:  [ 7.87597911e+01 -2.15403037e-04 -8.76834204e-01]
mat_Sqrt:  [[32.76474185  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295088 -0.05078954 -0.2570233 ]
Stock Position:  -0.0029508817331500513
Bond Position:  [-2.25918853]


portfolio before change:  [-2.49429097]
curr_Stock_Price:  79.28903528362699
curr_Factors:  [79.28903528  0.41212346 -0.87077244]
mat_Sqrt:  [[50.12154094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.20699650e-04 -2.67500768e-01 -4.69342888e-01]
Stock Position:  0.00032069965023080705
Bond Position:  [-2.51971894]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.49583737]
Stock Price:  78.39653452420225
PL:  [-2.49583737]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-6.16222760e-01 -1.18835587e-01 -3.44001588e-02]
 [ 3.74939266e-02  5.31345140e-02  1.19517899e-02]
 [-6.97414973e-02  3.29813719e-01  3.67473284e-01]
 [ 1.02586142e-01  2.49664459e-02  1.17544935e-02]
 [ 5.07067303e-02  1.31353850e-02  2.75757794e-02]
 [-9.15410537e-02 -4.28679126e-02  6.72035253e-03]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 1.95881588e-02  2.49143436e-02 -5.67406121e-02]
 [ 7.34461689e-02  5.46250500e-02  1.47454975e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.60595606]
curr_Stock_Price:  97.57444544388774
curr_Factors:  [97.57444544 -0.93469072 -0.99186111]
mat_Sqrt:  [[14.21167487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04556126 -0.03835402 -0.09813408]
Stock Position:  -0.045561264353401826
Bond Position:  [-11.16034096]


portfolio before change:  [-15.66394581]
curr_Stock_Price:  98.72472492937442
curr_Factors:  [98.72472493 -0.57347814 -0.97183291]
mat_Sqrt:  [[21.05260628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00241203 0.01714909 0.03409513]
Stock Position:  0.0024120345050366947
Bond Position:  [-15.90207325]


portfolio before change:  [-15.67249726]
curr_Stock_Price:  98.4766268680167
curr_Factors:  [98.47662687 -0.95909152 -0.94116258]
mat_Sqrt:  [[14.72527089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00492973 0.10644692 1.04829899]
Stock Position:  0.004929730437435211
Bond Position:  [-16.15796048]


portfolio before change:  [-15.67305087]
curr_Stock_Price:  100.00356462179718
curr_Factors:  [100.00356462  -0.80543877  -0.97943301]
mat_Sqrt:  [[16.78245591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00655934 0.00805789 0.0335323 ]
Stock Position:  0.006559336311283856
Bond Position:  [-16.32900788]


portfolio before change:  [-15.67584251]
curr_Stock_Price:  100.82299289983865
curr_Factors:  [100.8229929   -0.43824584  -1.01969499]
mat_Sqrt:  [[23.46302091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00251531 0.00423943 0.07866602]
Stock Position:  0.0025153138720451643
Bond Position:  [-15.92944398]


portfolio before change:  [-15.68846122]
curr_Stock_Price:  98.9735236195204
curr_Factors:  [98.97352362 -0.38821633 -1.08888195]
mat_Sqrt:  [[22.59557521  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00437783 -0.01383556  0.0191713 ]
Stock Position:  -0.0043778324983061966
Bond Position:  [-15.25517171]


portfolio before change:  [-15.71100783]
curr_Stock_Price:  102.38094535500738
curr_Factors:  [102.38094536  -0.52179944  -1.14450943]
mat_Sqrt:  [[19.34418287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248132 -0.01197701  0.13962421]
Stock Position:  -0.0024813221305571087
Bond Position:  [-15.45696772]


portfolio before change:  [-15.72094224]
curr_Stock_Price:  103.26918058968134
curr_Factors:  [103.26918059  -0.8535198   -1.10700198]
mat_Sqrt:  [[14.53874578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090047  0.00804107 -0.16186517]
Stock Position:  0.0009004661862369869
Bond Position:  [-15.81393265]


portfolio before change:  [-15.72812879]
curr_Stock_Price:  104.07143352625815
curr_Factors:  [104.07143353  -0.71431573  -1.09933357]
mat_Sqrt:  [[16.96968018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00516252 0.01763016 0.0420648 ]
Stock Position:  0.0051625234930935664
Bond Position:  [-16.26540001]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.72995355]
Stock Price:  105.29369848155896
PL:  [-21.02365203]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-6.76410372e-01 -1.35833967e-01 -5.72203841e-02]
 [ 2.24639480e-02  6.40062944e-02 -3.75915081e-02]
 [-3.53797081e-02  1.52822852e-01  1.31364533e-01]
 [ 2.02359636e-01  1.53397824e-01  2.14728449e-01]
 [ 3.55172384e-02 -8.27342359e-02  1.18384161e-01]
 [-5.37951544e-02  5.84361766e-02 -2.62229913e-02]
 [-6.51986173e-03  6.35808470e-02  4.04355214e-02]
 [-3.86621603e-02 -1.15033509e-01  5.43378445e-02]
 [-4.08097909e-02 -5.22138110e-02 -8.50274048e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.86781664]
curr_Stock_Price:  98.4940380097233
curr_Factors:  [98.49403801 -1.20816416 -0.96080742]
mat_Sqrt:  [[11.25738592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06358647 -0.04384022 -0.16323383]
Stock Position:  -0.0635864694539876
Bond Position:  [-2.6049285]


portfolio before change:  [-8.80410493]
curr_Stock_Price:  97.47157994161834
curr_Factors:  [97.47157994 -1.07088966 -0.95814762]
mat_Sqrt:  [[12.81381092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00217389  0.02065794 -0.10723811]
Stock Position:  0.0021738922008922384
Bond Position:  [-9.01599764]


portfolio before change:  [-8.81298682]
curr_Stock_Price:  95.46009313211914
curr_Factors:  [95.46009313 -1.48405609 -0.95362714]
mat_Sqrt:  [[ 8.33968183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00271351 0.04932336 0.37474645]
Stock Position:  0.002713508688061994
Bond Position:  [-9.07201861]


portfolio before change:  [-8.81679964]
curr_Stock_Price:  95.72702599678884
curr_Factors:  [95.727026   -1.43778858 -0.96467618]
mat_Sqrt:  [[ 8.66278182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03203395 0.04950893 0.6125605 ]
Stock Position:  0.03203394734472908
Bond Position:  [-11.88331415]


portfolio before change:  [-8.7962425]
curr_Stock_Price:  96.55428211162604
curr_Factors:  [96.55428211 -1.48195826 -1.00862708]
mat_Sqrt:  [[ 8.00062785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00534886 -0.02670236  0.33771706]
Stock Position:  0.005348861313607465
Bond Position:  [-9.31269796]


portfolio before change:  [-8.80566234]
curr_Stock_Price:  95.66393721387715
curr_Factors:  [95.66393721 -1.19891693 -1.03068147]
mat_Sqrt:  [[10.29072488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00458857  0.01886019 -0.0748069 ]
Stock Position:  -0.004588565530555209
Bond Position:  [-8.3667021]


portfolio before change:  [-8.81263173]
curr_Stock_Price:  96.27087902033799
curr_Factors:  [96.27087902 -1.54380169 -1.05881924]
mat_Sqrt:  [[ 7.13166655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00206297 0.02052063 0.11535129]
Stock Position:  0.0020629666918088934
Bond Position:  [-9.01123535]


portfolio before change:  [-8.81847345]
curr_Stock_Price:  95.62376531931963
curr_Factors:  [95.62376532 -0.84798855 -1.07527863]
mat_Sqrt:  [[13.97338149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365349 -0.03712691  0.15501075]
Stock Position:  -0.003653490107433508
Bond Position:  [-8.46911297]


portfolio before change:  [-8.82422098]
curr_Stock_Price:  96.03759149222712
curr_Factors:  [96.03759149 -0.86129893 -1.10302424]
mat_Sqrt:  [[13.46934722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00510968 -0.01685194 -0.24255952]
Stock Position:  -0.00510967871183364
Bond Position:  [-8.33349974]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.84025611]
Stock Price:  98.36011441509604
PL:  [-8.84025611]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.03857743e-01 -1.89467877e-01 -5.48551369e-02]
 [ 1.88966653e-02  7.62587504e-02  1.54866848e-02]
 [-1.04445973e-01  4.91385581e-01  5.97284916e-01]
 [ 1.04413537e-01  2.59947442e-02  1.23011047e-02]
 [-6.11590286e-03 -1.96541793e-01 -3.20806304e-02]
 [-6.15504267e-02 -1.95552096e-02 -5.75508753e-03]
 [ 2.97694350e-01  6.75149799e-01  3.71021385e-01]
 [-3.91835152e-02 -1.20658670e-01  4.50411534e-02]
 [-1.48822036e-02 -6.88194843e-02 -9.73894559e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.10948337]
curr_Stock_Price:  99.27991080723831
curr_Factors:  [99.27991081 -1.08394408 -0.98836874]
mat_Sqrt:  [[12.49877227  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06830511 -0.06115049 -0.15648644]
Stock Position:  -0.06830510633788028
Bond Position:  [3.6718415]


portfolio before change:  [-3.11782808]
curr_Stock_Price:  99.42896398373671
curr_Factors:  [99.42896398 -0.67061207 -0.98060473]
mat_Sqrt:  [[19.07210256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00197273 0.02461241 0.0441792 ]
Stock Position:  0.0019727307863542593
Bond Position:  [-3.31397466]


portfolio before change:  [-3.1171909]
curr_Stock_Price:  100.59211392146084
curr_Factors:  [100.59211392  -0.50803219  -0.94422831]
mat_Sqrt:  [[23.54264278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00500275 0.15859401 1.70388761]
Stock Position:  0.005002750215686658
Bond Position:  [-3.62042812]


portfolio before change:  [-3.11868579]
curr_Stock_Price:  100.65523524962032
curr_Factors:  [100.65523525  -0.12889291  -0.98553682]
mat_Sqrt:  [[33.02521736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00339833 0.00838977 0.03509163]
Stock Position:  0.0033983317323190497
Bond Position:  [-3.46074567]


portfolio before change:  [-3.14243165]
curr_Stock_Price:  94.17703866019185
curr_Factors:  [94.17703866  0.54546807 -1.01924076]
mat_Sqrt:  [[58.63921711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090014 -0.06343359 -0.09151711]
Stock Position:  -0.0009001358161755779
Bond Position:  [-3.05765953]


portfolio before change:  [-3.13967832]
curr_Stock_Price:  89.41936884331771
curr_Factors:  [ 8.94193688e+01 -2.61189879e-02 -1.02348995e+00]
mat_Sqrt:  [[31.30345191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213129 -0.00631142 -0.01641766]
Stock Position:  -0.0021312943251513105
Bond Position:  [-2.94909932]


portfolio before change:  [-3.14145618]
curr_Stock_Price:  89.56151047080165
curr_Factors:  [ 8.95615105e+01  6.44309797e-02 -1.04447147e+00]
mat_Sqrt:  [[33.61206792  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01521011 0.21790366 1.05842074]
Stock Position:  0.015210106974218816
Bond Position:  [-4.50369634]


portfolio before change:  [-3.07134059]
curr_Stock_Price:  94.31939927216798
curr_Factors:  [94.31939927 -0.52825634 -1.08047066]
mat_Sqrt:  [[18.87729517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00289336 -0.03894242  0.12848987]
Stock Position:  -0.002893363461541636
Bond Position:  [-2.79844029]


portfolio before change:  [-3.07661321]
curr_Stock_Price:  95.65799671454745
curr_Factors:  [95.65799671 -1.00305201 -1.08368135]
mat_Sqrt:  [[11.87037667  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00411187 -0.02221139 -0.27782501]
Stock Position:  -0.004111871329078389
Bond Position:  [-2.68327984]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.08477767]
Stock Price:  97.3172122082972
PL:  [-3.08477767]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.99101200e-01 -2.00216182e-01 -1.42701339e-02]
 [ 5.13455667e-02  3.79830477e-02  1.64554935e-02]
 [-7.87361173e-02  3.96713407e-01  4.39634250e-01]
 [-6.31368953e-02 -3.83079125e-02 -1.91162295e-02]
 [ 4.86217283e-02  2.65699027e-02  2.69749067e-02]
 [-8.94536984e-02 -4.06426686e-02  5.54716439e-03]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-3.67680421e-02 -9.03632549e-02  4.67770062e-02]
 [-2.26557773e-02  8.49841517e-02 -3.94181691e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.20004395]
curr_Stock_Price:  98.31222130104163
curr_Factors:  [98.3122213  -0.55734403 -1.03535494]
mat_Sqrt:  [[19.99434292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04215608 -0.06461949 -0.04070872]
Stock Position:  -0.04215607578941196
Bond Position:  [-6.0555865]


portfolio before change:  [-10.18475477]
curr_Stock_Price:  97.87769952676027
curr_Factors:  [97.87769953 -0.49733646 -0.99299673]
mat_Sqrt:  [[22.05160855  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00283235 0.01225898 0.04694294]
Stock Position:  0.002832346096342898
Bond Position:  [-10.46197829]


portfolio before change:  [-10.18815916]
curr_Stock_Price:  98.52306725809679
curr_Factors:  [98.52306726 -0.62842964 -0.94071747]
mat_Sqrt:  [[20.51473879  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00448373 0.1280387  1.25415414]
Stock Position:  0.004483734066966569
Bond Position:  [-10.6299104]


portfolio before change:  [-10.19331536]
curr_Stock_Price:  98.55877260780386
curr_Factors:  [98.55877261  0.23917594 -0.9717678 ]
mat_Sqrt:  [[47.37341376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158018 -0.01236383 -0.05453328]
Stock Position:  -0.0015801805954191626
Bond Position:  [-10.0375747]


portfolio before change:  [-10.19922049]
curr_Stock_Price:  99.11889507228437
curr_Factors:  [99.11889507 -0.4256418  -0.98621291]
mat_Sqrt:  [[24.15437152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00246546 0.0085754  0.0769519 ]
Stock Position:  0.002465455029690007
Bond Position:  [-10.44359367]


portfolio before change:  [-10.20479878]
curr_Stock_Price:  98.97482933731261
curr_Factors:  [98.97482934 -0.92256233 -0.95901868]
mat_Sqrt:  [[15.07872108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00640754 -0.01311736  0.01582452]
Stock Position:  -0.006407541972912913
Bond Position:  [-9.57061341]


portfolio before change:  [-10.21628199]
curr_Stock_Price:  100.01995801094893
curr_Factors:  [100.01995801  -1.25389375  -1.00688836]
mat_Sqrt:  [[10.42897131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460248 -0.01197701  0.13962421]
Stock Position:  -0.004602481645575013
Bond Position:  [-9.75594197]


portfolio before change:  [-10.21693597]
curr_Stock_Price:  99.10192824430356
curr_Factors:  [99.10192824 -1.02875016 -0.98639139]
mat_Sqrt:  [[13.21043906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345674 -0.02916462  0.13344178]
Stock Position:  -0.0034567395988662464
Bond Position:  [-9.87436641]


portfolio before change:  [-10.22041633]
curr_Stock_Price:  98.68012802342568
curr_Factors:  [98.68012802 -0.84772565 -1.02170751]
mat_Sqrt:  [[15.21756614  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087758  0.02742852 -0.11244906]
Stock Position:  -0.0008775818669351688
Bond Position:  [-10.13381644]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.22474746]
Stock Price:  97.84026234817306
PL:  [-10.22474746]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.18188638e+00 -3.05285462e-01 -1.52000283e-02]
 [ 1.34017523e-02  8.40327552e-02  2.34772058e-02]
 [-5.89165673e-02  2.01729261e-01  2.56677220e-01]
 [ 1.10325605e-01  3.45642274e-02  2.65773434e-02]
 [ 5.52520209e-02 -2.52903422e-02  4.71047377e-02]
 [-7.72840063e-02 -3.42175588e-02  1.96713277e-03]
 [ 2.97488525e-02  1.44732782e-01  8.72525117e-02]
 [-3.96325470e-02 -1.11272872e-01  3.54228185e-02]
 [-1.99841375e-02 -1.15739703e-01 -1.13064146e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.39635549]
curr_Stock_Price:  100.30427572338547
curr_Factors:  [100.30427572  -0.63512038  -0.95370662]
mat_Sqrt:  [[20.47861801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06090768 -0.09853046 -0.04336145]
Stock Position:  -0.0609076844699019
Bond Position:  [10.50565667]


portfolio before change:  [4.451873]
curr_Stock_Price:  99.47903718802549
curr_Factors:  [99.47903719 -0.88145876 -0.96138967]
mat_Sqrt:  [[15.75406642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00224368 0.02712146 0.06697393]
Stock Position:  0.0022436830106918053
Bond Position:  [4.22867358]


portfolio before change:  [4.45369297]
curr_Stock_Price:  99.34760399876112
curr_Factors:  [99.347604   -1.626075   -0.98699686]
mat_Sqrt:  [[ 7.2830737   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00475833 0.06510784 0.73222866]
Stock Position:  0.004758329434096398
Bond Position:  [3.98096435]


portfolio before change:  [4.45347032]
curr_Stock_Price:  98.88239134457451
curr_Factors:  [98.88239134 -1.43647117 -0.99352525]
mat_Sqrt:  [[ 8.7053237   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01410701 0.01115556 0.07581776]
Stock Position:  0.01410700854226025
Bond Position:  [3.05853558]


portfolio before change:  [4.44851248]
curr_Stock_Price:  98.42251408313234
curr_Factors:  [98.42251408 -1.38281223 -0.92309257]
mat_Sqrt:  [[ 9.80963225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00608635 -0.00816242  0.13437671]
Stock Position:  0.006086351074430666
Bond Position:  [3.8494785]


portfolio before change:  [4.44756881]
curr_Stock_Price:  97.95114943182561
curr_Factors:  [97.95114943 -1.08713278 -0.93890482]
mat_Sqrt:  [[12.91554056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0064935  -0.01104367  0.00561168]
Stock Position:  -0.0064935026633542725
Bond Position:  [5.08361486]


portfolio before change:  [4.46428559]
curr_Stock_Price:  95.76829999658821
curr_Factors:  [95.7683     -0.83622563 -0.91385595]
mat_Sqrt:  [[16.64067754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00463338 0.0467123  0.24890713]
Stock Position:  0.004633384194320361
Bond Position:  [4.02055426]


portfolio before change:  [4.46032323]
curr_Stock_Price:  94.47914697683174
curr_Factors:  [94.47914698 -1.02559478 -0.91316793]
mat_Sqrt:  [[13.59383572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00405444 -0.03591317  0.10105144]
Stock Position:  -0.00405443875375632
Bond Position:  [4.84338314]


portfolio before change:  [4.46143613]
curr_Stock_Price:  94.80210107852545
curr_Factors:  [94.80210108 -0.87672874 -0.95868669]
mat_Sqrt:  [[15.12541048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00440904 -0.03735483 -0.32254054]
Stock Position:  -0.004409039192813354
Bond Position:  [4.8794223]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.45471763]
Stock Price:  96.87938237966561
PL:  [4.45471763]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.21073319e+00 -2.89252027e-01 -6.25176907e-02]
 [-2.13904663e-03  1.19372931e-01  1.13069740e-01]
 [-9.22331843e-02  4.35301113e-01  5.16802010e-01]
 [ 1.06347497e-01  2.70830085e-02  1.28795918e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 3.55282847e-02  1.71249681e-02 -4.46174203e-02]
 [-4.91447865e-02 -3.48153321e-02  4.53926201e-02]
 [ 1.31375498e-02  1.54158558e-02 -4.74946507e-02]
 [ 1.23574066e-01 -4.29544282e-03  6.54604839e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.43091735]
curr_Stock_Price:  101.40079850149179
curr_Factors:  [101.4007985   -1.1717193   -1.00328757]
mat_Sqrt:  [[11.51987833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11133259 -0.09335569 -0.17834557]
Stock Position:  -0.11133258959423946
Bond Position:  [23.72013083]


portfolio before change:  [12.54114705]
curr_Stock_Price:  100.51725960376363
curr_Factors:  [100.5172596   -0.86747425  -0.99231169]
mat_Sqrt:  [[15.65113608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00289488 0.03852745 0.3225565 ]
Stock Position:  0.002894877073654248
Bond Position:  [12.25016194]


portfolio before change:  [12.5451748]
curr_Stock_Price:  99.79223460550408
curr_Factors:  [99.79223461 -0.47289512 -1.01312097]
mat_Sqrt:  [[22.58021966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00452228 0.14049283 1.47429228]
Stock Position:  0.0045222789405675624
Bond Position:  [12.09388648]


portfolio before change:  [12.5589436]
curr_Stock_Price:  101.49941400419456
curr_Factors:  [101.499414    -0.59492049  -1.01079021]
mat_Sqrt:  [[20.37568597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00561968 0.008741   0.03674189]
Stock Position:  0.005619679695250743
Bond Position:  [11.98854941]


portfolio before change:  [12.56956435]
curr_Stock_Price:  102.32241000568898
curr_Factors:  [102.32241001  -0.72149443  -1.03976472]
mat_Sqrt:  [[17.58189288  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00331712 -0.00140152  0.08089603]
Stock Position:  0.003317122670141056
Bond Position:  [12.23014836]


portfolio before change:  [12.58001454]
curr_Stock_Price:  103.62883868100623
curr_Factors:  [103.62883868  -0.60228109  -0.98170504]
mat_Sqrt:  [[21.26004588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140717  0.00552706 -0.12728108]
Stock Position:  0.0014071658930896538
Bond Position:  [12.43419157]


portfolio before change:  [12.59036637]
curr_Stock_Price:  106.56607543551236
curr_Factors:  [106.56607544  -0.69267063  -0.96078864]
mat_Sqrt:  [[20.39533005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230375 -0.0112366   0.12949251]
Stock Position:  -0.0023037482872341783
Bond Position:  [12.83586778]


portfolio before change:  [12.6009144]
curr_Stock_Price:  104.7739996208335
curr_Factors:  [104.77399962  -0.4230092   -0.94985293]
mat_Sqrt:  [[26.54771068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00024821  0.00497545 -0.13548902]
Stock Position:  0.00024821323671370333
Bond Position:  [12.5749081]


portfolio before change:  [12.60810334]
curr_Stock_Price:  108.39958450086341
curr_Factors:  [ 1.08399585e+02 -2.96520131e-02 -9.77635759e-01]
mat_Sqrt:  [[39.58841336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00343685 -0.00138635  0.18674054]
Stock Position:  0.0034368471967578485
Bond Position:  [12.23555053]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.6107896]
Stock Price:  107.40069079304608
PL:  [5.21009881]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.30109631e+00 -3.11926032e-01 -5.72534681e-02]
 [-3.75374894e-03  1.23034515e-01  1.22534738e-01]
 [-1.15435810e-01  5.65945127e-01  6.35395943e-01]
 [ 1.26016819e-01  3.81511873e-02  1.87630887e-02]
 [ 1.65242831e-02 -4.62642004e-02 -3.14406862e-02]
 [ 4.00349814e-02  1.59880282e-02 -4.55374505e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 1.31256903e-02  1.66304791e-02 -4.83081193e-02]
 [ 1.12093753e-01  4.43045676e-02  2.70148561e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.22127962]
curr_Stock_Price:  101.37218803716533
curr_Factors:  [101.37218804  -0.84169022  -1.01715294]
mat_Sqrt:  [[15.79914165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08712212 -0.10067369 -0.16332821]
Stock Position:  -0.08712212293818733
Bond Position:  [21.05303985]


portfolio before change:  [12.29691848]
curr_Stock_Price:  100.62484964778473
curr_Factors:  [100.62484965  -0.87597778  -0.97212182]
mat_Sqrt:  [[15.85206286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00292535 0.03970922 0.3495575 ]
Stock Position:  0.0029253520775380294
Bond Position:  [12.00255536]


portfolio before change:  [12.31005736]
curr_Stock_Price:  103.06425142795908
curr_Factors:  [103.06425143  -0.9489189   -0.98831154]
mat_Sqrt:  [[14.85181621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00873879 0.182658   1.81260776]
Stock Position:  0.00873879040111562
Bond Position:  [11.40940047]


portfolio before change:  [12.34760285]
curr_Stock_Price:  106.70770304775408
curr_Factors:  [106.70770305  -0.77072594  -0.99301083]
mat_Sqrt:  [[18.29003874  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0075251  0.01231324 0.05352587]
Stock Position:  0.007525101418459149
Bond Position:  [11.54461656]


portfolio before change:  [12.34496742]
curr_Stock_Price:  105.59021838581023
curr_Factors:  [105.59021839  -0.63949962  -0.99952992]
mat_Sqrt:  [[20.50228222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.23300338e-05 -1.49317065e-02 -8.96915264e-02]
Stock Position:  3.2330033841695875e-05
Bond Position:  [12.34155368]


portfolio before change:  [12.35108241]
curr_Stock_Price:  103.81720104336137
curr_Factors:  [103.81720104  -0.99159317  -0.93752981]
mat_Sqrt:  [[15.08210122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00225454  0.00516011 -0.12990567]
Stock Position:  0.0022545420152346464
Bond Position:  [12.11702217]


portfolio before change:  [12.35205124]
curr_Stock_Price:  101.55900340760171
curr_Factors:  [101.55900341  -1.21286091  -0.95268113]
mat_Sqrt:  [[11.6475739   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00412096 -0.01197701  0.13962421]
Stock Position:  -0.004120956816731397
Bond Position:  [12.77057151]


portfolio before change:  [12.35277428]
curr_Stock_Price:  102.93340251592868
curr_Factors:  [102.93340252  -0.89349412  -0.88840688]
mat_Sqrt:  [[17.32553116  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00038438  0.00536746 -0.13780962]
Stock Position:  0.00038437603976637684
Bond Position:  [12.31320915]


portfolio before change:  [12.35962849]
curr_Stock_Price:  104.74430821860463
curr_Factors:  [104.74430822  -0.85101868  -0.90997849]
mat_Sqrt:  [[18.00275949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00703513 0.01429924 0.07706587]
Stock Position:  0.007035130893855857
Bond Position:  [11.62273858]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.34787001]
Stock Price:  102.2466558901706
PL:  [10.10121412]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.46537105e+00 -3.16854736e-01 -1.24094082e-01]
 [-1.33216922e-01  2.41631992e-01  6.57592647e-01]
 [-1.29605367e-01  6.91829190e-01  6.70697057e-01]
 [ 1.21775417e-01  3.57644964e-02  1.74943986e-02]
 [-2.14329389e-02 -7.35451054e-02 -2.62187961e-02]
 [ 8.70995573e-02 -2.19080757e-02 -4.94838082e-02]
 [-3.20048457e-02 -7.66397292e-03 -1.62549906e-02]
 [-5.32392436e-04 -7.79894813e-03 -2.58208891e-02]
 [ 3.01795209e-01 -3.23527945e-03  9.56233393e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.45370486]
curr_Stock_Price:  102.76866584931747
curr_Factors:  [102.76866585  -1.0702158   -1.04247984]
mat_Sqrt:  [[12.42592305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12517214 -0.10226443 -0.35400587]
Stock Position:  -0.12517213770244112
Bond Position:  [35.31747846]


portfolio before change:  [22.17032302]
curr_Stock_Price:  105.17371386230359
curr_Factors:  [105.17371386  -1.36811668  -1.07299961]
mat_Sqrt:  [[ 9.15680311  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00549717 0.07798639 1.87592878]
Stock Position:  0.005497173854506777
Bond Position:  [21.59216483]


portfolio before change:  [22.18506827]
curr_Stock_Price:  105.89162302946029
curr_Factors:  [105.89162303  -1.33967836  -1.04388403]
mat_Sqrt:  [[ 9.76548039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01520858 0.22328691 1.91331202]
Stock Position:  0.015208584993610321
Bond Position:  [20.57460652]


portfolio before change:  [22.19538846]
curr_Stock_Price:  105.89361646952136
curr_Factors:  [105.89361647  -1.144725    -1.07119457]
mat_Sqrt:  [[11.54803619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01148653 0.01154294 0.04990665]
Stock Position:  0.011486528208815067
Bond Position:  [20.97903845]


portfolio before change:  [22.21575394]
curr_Stock_Price:  106.75317405184565
curr_Factors:  [106.75317405  -1.46142028  -1.13036602]
mat_Sqrt:  [[ 7.99433436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00522835 -0.02373658 -0.07479493]
Stock Position:  -0.005228347751782304
Bond Position:  [22.77389666]


portfolio before change:  [22.22080183]
curr_Stock_Price:  107.9661582104052
curr_Factors:  [107.96615821  -1.28814339  -1.09349667]
mat_Sqrt:  [[ 9.9759557   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00727016 -0.0070708  -0.14116353]
Stock Position:  0.007270155580498776
Bond Position:  [21.43587106]


portfolio before change:  [22.23794086]
curr_Stock_Price:  108.849002692032
curr_Factors:  [108.84900269  -1.33485955  -1.13980219]
mat_Sqrt:  [[ 9.16415696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00402517 -0.00247354 -0.04637096]
Stock Position:  -0.004025169343625142
Bond Position:  [22.67607653]


portfolio before change:  [22.24415171]
curr_Stock_Price:  110.1234908504738
curr_Factors:  [110.12349085  -0.90396703  -1.1709547 ]
mat_Sqrt:  [[13.82779434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00053479 -0.0025171  -0.07365981]
Stock Position:  -0.0005347933870799295
Bond Position:  [22.30304502]


portfolio before change:  [22.25621796]
curr_Stock_Price:  108.41826198876421
curr_Factors:  [108.41826199  -1.14800549  -1.16639694]
mat_Sqrt:  [[10.71445875  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02992721 -0.00104418  0.27278677]
Stock Position:  0.029927208661495747
Bond Position:  [19.01156201]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.24169279]
Stock Price:  107.61520248004344
PL:  [14.62649031]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.71872071e-01 -1.82476777e-01 -3.98745364e-02]
 [ 2.21137282e-02  6.43245608e-02 -2.83121853e-02]
 [-6.68347879e-02  3.46322544e-01  3.63350351e-01]
 [ 1.35817862e-01  6.29032290e-02  6.75894287e-02]
 [ 4.47012190e-02  5.04911647e-02  2.85168993e-02]
 [-5.22995599e-02 -1.10891024e-02 -1.08831970e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-2.08606820e-03 -3.00526184e-02 -1.01362548e-02]
 [-1.15245214e-01  5.29305567e-03 -3.19986547e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.13414065]
curr_Stock_Price:  98.7306427245065
curr_Factors:  [98.73064272 -0.87428186 -1.0301945 ]
mat_Sqrt:  [[14.70105114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0555919  -0.05889413 -0.11375095]
Stock Position:  -0.05559189849416131
Bond Position:  [-1.64551678]


portfolio before change:  [-7.11257725]
curr_Stock_Price:  98.32795153134848
curr_Factors:  [98.32795153 -1.09480699 -1.0702718 ]
mat_Sqrt:  [[11.28223698  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0026116   0.02076066 -0.08076678]
Stock Position:  0.002611602963276077
Bond Position:  [-7.36937082]


portfolio before change:  [-7.11804139]
curr_Stock_Price:  97.6469398496305
curr_Factors:  [97.64693985 -0.59100897 -1.06816529]
mat_Sqrt:  [[18.58182703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00419908 0.11177512 1.03653742]
Stock Position:  0.0041990803796034945
Bond Position:  [-7.52806874]


portfolio before change:  [-7.11727881]
curr_Stock_Price:  98.72516385451073
curr_Factors:  [98.72516385 -0.52681562 -1.12050432]
mat_Sqrt:  [[19.01104125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00854527 0.02030193 0.19281383]
Stock Position:  0.008545274380733912
Bond Position:  [-7.96091243]


portfolio before change:  [-7.13124572]
curr_Stock_Price:  97.5566283075131
curr_Factors:  [97.55662831 -0.46298035 -1.12331501]
mat_Sqrt:  [[19.96813305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00304629 0.01629595 0.08135078]
Stock Position:  0.0030462874217587377
Bond Position:  [-7.42843125]


portfolio before change:  [-7.12761172]
curr_Stock_Price:  99.9691219667361
curr_Factors:  [99.96912197 -0.46768048 -1.08877068]
mat_Sqrt:  [[21.08180196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269354 -0.00357899 -0.03104673]
Stock Position:  -0.0026935380973838506
Bond Position:  [-6.85834108]


portfolio before change:  [-7.13502373]
curr_Stock_Price:  101.44747161024397
curr_Factors:  [ 1.01447472e+02 -7.52229432e-02 -1.07452315e+00]
mat_Sqrt:  [[32.13015661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014939  -0.01197701  0.13962421]
Stock Position:  -0.0014938971396839828
Bond Position:  [-6.98347165]


portfolio before change:  [-7.13911253]
curr_Stock_Price:  101.84655359378307
curr_Factors:  [101.84655359  -0.19298935  -1.07466371]
mat_Sqrt:  [[28.66893813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035891 -0.00969944 -0.02891591]
Stock Position:  -0.0003589106624870841
Bond Position:  [-7.10255872]


portfolio before change:  [-7.14267556]
curr_Stock_Price:  101.87682957731538
curr_Factors:  [101.87682958   0.33119512  -1.14429539]
mat_Sqrt:  [[45.18044072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267143  0.00170833 -0.09128326]
Stock Position:  -0.0026714319310850113
Bond Position:  [-6.87051855]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.14733768]
Stock Price:  102.33575805696708
PL:  [-9.48309574]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.08355556e+00 -2.80085259e-01 -2.20378709e-02]
 [ 1.98147994e-02  6.96605839e-02 -1.67018402e-02]
 [-8.38912478e-02  3.93272397e-01  4.59955154e-01]
 [ 1.07815821e-01  2.79092534e-02  1.33187977e-02]
 [ 5.27975436e-02 -3.36576456e-04  2.81783268e-02]
 [ 3.83816227e-02  1.90245295e-02 -4.57510596e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 1.38510047e-02  2.00157497e-02 -5.09096499e-02]
 [ 1.29416929e-01  5.95564636e-02  1.95294195e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.16737139]
curr_Stock_Price:  100.00007346707444
curr_Factors:  [100.00007347  -0.68988016  -0.97012988]
mat_Sqrt:  [[19.01372097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06023157 -0.09039713 -0.06286791]
Stock Position:  -0.06023156564413875
Bond Position:  [8.19053238]


portfolio before change:  [2.25381648]
curr_Stock_Price:  98.63286996599435
curr_Factors:  [98.63286997 -0.90350647 -0.92642582]
mat_Sqrt:  [[15.82312195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193546  0.02248286 -0.0476457 ]
Stock Position:  0.0019354560874360065
Bond Position:  [2.0629169]


portfolio before change:  [2.2562965]
curr_Stock_Price:  99.38117076755924
curr_Factors:  [99.38117077 -0.73347858 -0.93856395]
mat_Sqrt:  [[18.6700406   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00483518 0.12692812 1.31212403]
Stock Position:  0.004835184816915629
Bond Position:  [1.77577018]


portfolio before change:  [2.27072263]
curr_Stock_Price:  102.18106742995552
curr_Factors:  [102.18106743  -0.71609969  -0.91478366]
mat_Sqrt:  [[20.00261575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00581081 0.00900767 0.03799482]
Stock Position:  0.005810813124737053
Bond Position:  [1.67696754]


portfolio before change:  [2.26753586]
curr_Stock_Price:  101.48831329557403
curr_Factors:  [101.4883133   -0.90794662  -0.89918015]
mat_Sqrt:  [[16.65677222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00351093 -0.00010863  0.08038492]
Stock Position:  0.0035109273436028294
Bond Position:  [1.91121776]


portfolio before change:  [2.27571094]
curr_Stock_Price:  103.54453219866319
curr_Factors:  [103.5445322   -1.19691217  -0.88646095]
mat_Sqrt:  [[12.89227977  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00255394  0.00614014 -0.13051504]
Stock Position:  0.002553938726197777
Bond Position:  [2.01126455]


portfolio before change:  [2.27490005]
curr_Stock_Price:  102.83317020208992
curr_Factors:  [102.8331702   -1.23952376  -0.94547566]
mat_Sqrt:  [[11.56644858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00414986 -0.01197701  0.13962421]
Stock Position:  -0.004149860584991208
Bond Position:  [2.70164337]


portfolio before change:  [2.27630522]
curr_Stock_Price:  102.82015583571491
curr_Factors:  [102.82015584  -1.18016589  -0.9824974 ]
mat_Sqrt:  [[11.82620826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063797  0.00646006 -0.14523106]
Stock Position:  0.0006379740294923044
Bond Position:  [2.21070863]


portfolio before change:  [2.27799372]
curr_Stock_Price:  103.73378749120307
curr_Factors:  [103.73378749  -1.18051566  -0.97307247]
mat_Sqrt:  [[12.0400639   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01208966 0.01922177 0.055712  ]
Stock Position:  0.012089659012538218
Bond Position:  [1.0238876]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.27787956]
Stock Price:  103.68198890583574
PL:  [-1.40410934]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.00464288e+00 -2.53631246e-01 -4.06431560e-02]
 [-4.80955736e-04  1.15587059e-01  1.03743664e-01]
 [-8.36853601e-02  3.84177161e-01  4.54495134e-01]
 [ 1.09318128e-01  2.87546205e-02  1.37681684e-02]
 [ 5.11200197e-02 -6.95492058e-03  2.46309855e-02]
 [-5.80549771e-02 -1.44587762e-02 -8.87956360e-03]
 [ 3.28841925e-03  1.15810965e-01  9.01764950e-02]
 [-4.00752094e-02 -1.26104537e-01  3.08189931e-02]
 [-4.09227383e-02 -3.25199231e-01 -1.07354642e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.32599871]
curr_Stock_Price:  100.02172224916706
curr_Factors:  [100.02172225  -0.87454608  -1.0037176 ]
mat_Sqrt:  [[15.28884851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06963974 -0.08185913 -0.11594361]
Stock Position:  -0.06963973738202842
Bond Position:  [9.29148518]


portfolio before change:  [2.30530853]
curr_Stock_Price:  100.3855531376089
curr_Factors:  [100.38555314  -0.89619096  -1.06394743]
mat_Sqrt:  [[14.13819376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00313263 0.03730556 0.2959518 ]
Stock Position:  0.0031326307546653068
Bond Position:  [1.99083766]


portfolio before change:  [2.3034849]
curr_Stock_Price:  99.48557377633352
curr_Factors:  [99.48557378 -0.6208538  -1.03544465]
mat_Sqrt:  [[18.98623417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00460902 0.12399265 1.29654811]
Stock Position:  0.004609018543939848
Bond Position:  [1.84495404]


portfolio before change:  [2.31882434]
curr_Stock_Price:  102.61351391171381
curr_Factors:  [ 1.02613514e+02 -4.59212307e-02 -1.05651743e+00]
mat_Sqrt:  [[34.07387553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00346301 0.00928051 0.03927675]
Stock Position:  0.0034630066041439326
Bond Position:  [1.96347306]


portfolio before change:  [2.31395345]
curr_Stock_Price:  100.92340157603788
curr_Factors:  [ 1.00923402e+02 -3.94558879e-02 -1.04779528e+00]
mat_Sqrt:  [[34.02551405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00160844 -0.00224469  0.07026535]
Stock Position:  0.0016084439231254769
Bond Position:  [2.15162382]


portfolio before change:  [2.31349922]
curr_Stock_Price:  99.97197725545423
curr_Factors:  [99.97197726  0.12042694 -1.03249707]
mat_Sqrt:  [[40.15792447  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0015643  -0.00466655 -0.02533092]
Stock Position:  -0.001564296377850595
Bond Position:  [2.46988502]


portfolio before change:  [2.31891421]
curr_Stock_Price:  97.300012299736
curr_Factors:  [97.3000123  -0.15592124 -0.99191418]
mat_Sqrt:  [[30.87552175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00146833 0.03737783 0.25724844]
Stock Position:  0.0014683293063951007
Bond Position:  [2.17604575]


portfolio before change:  [2.31370721]
curr_Stock_Price:  93.01262182001896
curr_Factors:  [93.01262182  0.37165561 -0.97112877]
mat_Sqrt:  [[51.07330989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00116549 -0.04070006  0.08791801]
Stock Position:  -0.001165487213902406
Bond Position:  [2.42211223]


portfolio before change:  [2.31802457]
curr_Stock_Price:  90.34764079691706
curr_Factors:  [ 9.03476408e+01 -7.90471280e-03 -9.93567584e-01]
mat_Sqrt:  [[33.18814083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389348 -0.1049576  -0.30625291]
Stock Position:  -0.0038934819672697472
Bond Position:  [2.66979148]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.31364451]
Stock Price:  91.8155520598691
PL:  [2.31364451]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-9.36602618e-01 -2.26615300e-01 -6.55421948e-02]
 [ 3.76235301e-02  5.29917273e-02  1.51865441e-02]
 [-8.76611543e-02  4.19090713e-01  4.89081544e-01]
 [ 1.14607863e-01  3.17312221e-02  1.53504365e-02]
 [ 3.11141664e-03 -6.15045211e-02 -5.31798343e-02]
 [ 5.56116226e-02 -2.54478029e-03 -4.52911210e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 1.93740210e-02  1.81841394e-02 -5.21098299e-02]
 [-1.04381744e-01  2.09503972e-02 -3.67249857e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.83192068]
curr_Stock_Price:  100.22724406412713
curr_Factors:  [100.22724406  -1.15073931  -1.02563141]
mat_Sqrt:  [[11.37103504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08761199 -0.07313977 -0.18697364]
Stock Position:  -0.08761199079576941
Bond Position:  [12.61302906]


portfolio before change:  [3.93621602]
curr_Stock_Price:  99.10882126715161
curr_Factors:  [99.10882127 -0.51752845 -1.05669315]
mat_Sqrt:  [[20.53225076  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00251021 0.01710301 0.04332298]
Stock Position:  0.002510214885049516
Bond Position:  [3.68743158]


portfolio before change:  [3.93878688]
curr_Stock_Price:  99.39831185927746
curr_Factors:  [99.39831186 -0.42148013 -1.03393684]
mat_Sqrt:  [[23.18993045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00421384 0.13526095 1.39521351]
Stock Position:  0.00421384322923622
Bond Position:  [3.51993797]


portfolio before change:  [3.96131445]
curr_Stock_Price:  104.32663189967852
curr_Factors:  [ 1.04326632e+02 -4.68021656e-02 -1.07115815e+00]
mat_Sqrt:  [[34.10917316  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00364179 0.01024121 0.04379052]
Stock Position:  0.0036417876754200914
Bond Position:  [3.58137901]


portfolio before change:  [3.96301306]
curr_Stock_Price:  104.30122222555798
curr_Factors:  [104.30122223  -0.14956534  -1.08491579]
mat_Sqrt:  [[30.3501648   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066881 -0.0198505  -0.15170726]
Stock Position:  -0.000668807880071306
Bond Position:  [4.03277053]


portfolio before change:  [3.96395683]
curr_Stock_Price:  105.90574630599164
curr_Factors:  [105.90574631   0.19274845  -1.06303419]
mat_Sqrt:  [[44.35670009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0010336  -0.00082132 -0.12920296]
Stock Position:  0.001033601689234226
Bond Position:  [3.85449247]


portfolio before change:  [3.96522278]
curr_Stock_Price:  105.26548964134406
curr_Factors:  [105.26548964   0.40934679  -1.02130823]
mat_Sqrt:  [[57.08401852  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084085 -0.01197701  0.13962421]
Stock Position:  -0.000840850912383033
Bond Position:  [4.05373537]


portfolio before change:  [3.96803816]
curr_Stock_Price:  104.32834545367773
curr_Factors:  [ 1.04328345e+02 -4.17268368e-02 -1.01274963e+00]
mat_Sqrt:  [[36.34536271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00034252  0.00586891 -0.14865484]
Stock Position:  0.00034251875762940603
Bond Position:  [3.93230374]


portfolio before change:  [3.96900335]
curr_Stock_Price:  101.40456842989573
curr_Factors:  [101.40456843   0.20583316  -1.03139872]
mat_Sqrt:  [[44.41390424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0024227   0.00676171 -0.10476616]
Stock Position:  -0.0024227034387708144
Bond Position:  [4.21467655]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.97069587]
Stock Price:  101.57600918551623
PL:  [2.39468668]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.25995453e+00 -3.11256677e-01 -3.93239434e-02]
 [ 8.17314822e-03  9.61018279e-02  5.09006342e-02]
 [-8.35200559e-02  3.97405484e-01  4.60448130e-01]
 [ 1.59440162e-01  8.70963223e-02  1.00661427e-01]
 [ 4.80146968e-02  3.04812542e-02  2.67999675e-02]
 [-1.07337997e-01 -6.22253053e-02  1.67179742e-02]
 [ 2.26776387e-01  5.28598948e-01  2.85335469e-01]
 [-4.18253354e-02 -1.25574443e-01 -4.60537562e-03]
 [ 2.99164364e-02 -4.22055059e-01 -1.61682910e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.56133106]
curr_Stock_Price:  101.14564532903472
curr_Factors:  [101.14564533  -0.93139552  -0.95801656]
mat_Sqrt:  [[15.28924181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08708846 -0.10045766 -0.11218026]
Stock Position:  -0.08708845817104442
Bond Position:  [19.36994936]


portfolio before change:  [10.67841432]
curr_Stock_Price:  99.91246402973607
curr_Factors:  [99.91246403 -0.65563193 -0.95511968]
mat_Sqrt:  [[19.95625915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00191318 0.03101673 0.14520534]
Stock Position:  0.0019131792115380957
Bond Position:  [10.48726387]


portfolio before change:  [10.68238915]
curr_Stock_Price:  99.24859289046958
curr_Factors:  [99.24859289 -0.71449955 -0.9204272 ]
mat_Sqrt:  [[19.35016596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00473322 0.12826207 1.31353035]
Stock Position:  0.004733219344350539
Bond Position:  [10.2126238]


portfolio before change:  [10.68337076]
curr_Stock_Price:  98.37688429842599
curr_Factors:  [98.3768843  -0.59027003 -0.8997694 ]
mat_Sqrt:  [[22.17058539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0089202  0.02811022 0.28715903]
Stock Position:  0.008920199814936398
Bond Position:  [9.80582929]


portfolio before change:  [10.69176049]
curr_Stock_Price:  98.76763767164485
curr_Factors:  [98.76763767 -0.55488325 -0.85236236]
mat_Sqrt:  [[24.17996469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00246928 0.00983778 0.07645285]
Stock Position:  0.0024692830591082422
Bond Position:  [10.44787524]


portfolio before change:  [10.68792902]
curr_Stock_Price:  95.0998854519398
curr_Factors:  [95.09988545 -0.17857123 -0.85666876]
mat_Sqrt:  [[33.77388189  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345318 -0.02008313  0.04769173]
Stock Position:  -0.003453175525636652
Bond Position:  [11.01632562]


portfolio before change:  [10.70778638]
curr_Stock_Price:  90.94492112642988
curr_Factors:  [90.94492113 -0.20255631 -0.86224082]
mat_Sqrt:  [[31.3576083   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01253029 0.17060458 0.81398267]
Stock Position:  0.012530294079551436
Bond Position:  [9.56821977]


portfolio before change:  [10.69911017]
curr_Stock_Price:  89.87060313577376
curr_Factors:  [89.87060314 -0.15317013 -0.81786941]
mat_Sqrt:  [[34.03302412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200976 -0.04052898 -0.01313785]
Stock Position:  -0.002009759088272482
Bond Position:  [10.87972843]


portfolio before change:  [10.70747499]
curr_Stock_Price:  88.41590102673926
curr_Factors:  [88.41590103 -0.30947609 -0.81663303]
mat_Sqrt:  [[28.67262153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311233 -0.13621768 -0.46123634]
Stock Position:  -0.0031123271143267107
Bond Position:  [10.9826542]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.70452044]
Stock Price:  91.13002821432151
PL:  [10.70452044]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.09822826e+00 -2.72126989e-01 -4.56908243e-02]
 [ 5.28421600e-03  1.02581924e-01  6.89129378e-02]
 [-7.18455828e-02  2.74648812e-01  3.48700183e-01]
 [ 1.00518808e-01  2.38031308e-02  1.11361117e-02]
 [ 4.74149586e-02  3.43456113e-02  2.66271301e-02]
 [-6.98930307e-02 -2.69247659e-02 -2.27781053e-03]
 [-3.35691601e-02  3.73046504e-02  4.77985380e-02]
 [-3.85868677e-02 -1.12986798e-01  5.58975373e-02]
 [-1.09856174e-01 -7.01544631e-02 -7.45342128e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.00575765]
curr_Stock_Price:  100.52392007417895
curr_Factors:  [100.52392007  -0.8827675   -1.066412  ]
mat_Sqrt:  [[14.31368693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08125807 -0.08782861 -0.1303432 ]
Stock Position:  -0.08125806833379001
Bond Position:  [14.17413721]


portfolio before change:  [6.05273014]
curr_Stock_Price:  100.03309311125707
curr_Factors:  [100.03309311  -0.78176926  -1.13174763]
mat_Sqrt:  [[14.76093506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00272953 0.03310817 0.19658943]
Stock Position:  0.002729532909918291
Bond Position:  [5.77968652]


portfolio before change:  [6.05502496]
curr_Stock_Price:  99.81483480524355
curr_Factors:  [99.81483481 -1.09292795 -1.1274894 ]
mat_Sqrt:  [[10.83627676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.005112   0.08864252 0.99474456]
Stock Position:  0.005111995505259338
Bond Position:  [5.54477198]


portfolio before change:  [6.05686487]
curr_Stock_Price:  99.63229038642385
curr_Factors:  [99.63229039 -0.46577942 -1.15885869]
mat_Sqrt:  [[19.62586235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00548515 0.00768243 0.03176823]
Stock Position:  0.005485147582334405
Bond Position:  [5.51036706]


portfolio before change:  [6.05643827]
curr_Stock_Price:  99.0520907238319
curr_Factors:  [99.05209072 -0.70104639 -1.15802985]
mat_Sqrt:  [[15.43395018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00387853 0.011085   0.07595979]
Stock Position:  0.0038785253714673385
Bond Position:  [5.67226222]


portfolio before change:  [6.06072314]
curr_Stock_Price:  99.42543623822948
curr_Factors:  [99.42543624 -0.95247168 -1.0993275 ]
mat_Sqrt:  [[12.77651597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00593698 -0.00868993 -0.00649796]
Stock Position:  -0.005936984840788329
Bond Position:  [6.65101044]


portfolio before change:  [6.07254497]
curr_Stock_Price:  97.99449169572927
curr_Factors:  [97.9944917  -0.67373948 -1.09281841]
mat_Sqrt:  [[16.74924839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096706  0.01204002  0.13635592]
Stock Position:  -0.0009670609752330007
Bond Position:  [6.16731162]


portfolio before change:  [6.07754437]
curr_Stock_Price:  96.01429334843833
curr_Factors:  [96.01429335 -0.86500774 -1.04837747]
mat_Sqrt:  [[14.16978474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00354558 -0.03646633  0.15946012]
Stock Position:  -0.00354558415216664
Bond Position:  [6.41797113]


portfolio before change:  [6.08109403]
curr_Stock_Price:  95.91843545396911
curr_Factors:  [95.91843545 -0.44454568 -1.10094081]
mat_Sqrt:  [[20.45058964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00681597 -0.02264226 -0.21262536]
Stock Position:  -0.006815971030522477
Bond Position:  [6.73487131]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.05661696]
Stock Price:  100.00374417644709
PL:  [6.05287278]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.33036198e+00 -3.02945177e-01 -8.99189333e-02]
 [ 8.77197920e-04  1.12455380e-01  9.65699158e-02]
 [-6.52584441e-02  2.32750645e-01  2.99425987e-01]
 [ 1.07645737e-01  2.78135447e-02  1.32679220e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 4.53207339e-02  3.61440216e-02 -5.16195143e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-1.03754087e-02 -3.72502466e-02 -1.63056991e-03]
 [ 3.27813309e-03  1.05657735e-01 -3.99858619e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.84367543]
curr_Stock_Price:  102.00303292818913
curr_Factors:  [102.00303293  -1.0566792   -1.07599492]
mat_Sqrt:  [[12.08939258  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11667708 -0.09777514 -0.25651369]
Stock Position:  -0.11667708065239278
Bond Position:  [28.74509153]


portfolio before change:  [17.06022683]
curr_Stock_Price:  100.27025674519888
curr_Factors:  [100.27025675  -0.95333265  -1.08812381]
mat_Sqrt:  [[13.01903669  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00334466 0.03629482 0.27548709]
Stock Position:  0.0033446643486698584
Bond Position:  [16.72485648]


portfolio before change:  [17.06657748]
curr_Stock_Price:  99.6681413451642
curr_Factors:  [99.66814135 -1.3928013  -1.06562505]
mat_Sqrt:  [[ 8.52855323  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00508546 0.07511995 0.854179  ]
Stock Position:  0.0050854646529730485
Bond Position:  [16.55971867]


portfolio before change:  [17.08730791]
curr_Stock_Price:  102.11600068677372
curr_Factors:  [102.11600069  -1.47619992  -1.07502041]
mat_Sqrt:  [[ 7.96366321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01457011 0.00897678 0.03784969]
Stock Position:  0.014570110922333613
Bond Position:  [15.59946645]


portfolio before change:  [17.11402399]
curr_Stock_Price:  103.4141644790588
curr_Factors:  [103.41416448  -1.38083554  -1.10461781]
mat_Sqrt:  [[ 8.61313691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0067712  -0.00140152  0.08089603]
Stock Position:  0.006771202643799594
Bond Position:  [16.41378572]


portfolio before change:  [17.11701115]
curr_Stock_Price:  102.64298947293602
curr_Factors:  [102.64298947  -1.68851926  -1.09742789]
mat_Sqrt:  [[ 6.33005987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00666057  0.01166543 -0.14725611]
Stock Position:  0.006660570837666494
Bond Position:  [16.43335025]


portfolio before change:  [17.12430857]
curr_Stock_Price:  102.50466720672236
curr_Factors:  [102.50466721  -1.02135887  -1.1184981 ]
mat_Sqrt:  [[12.06189564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0039794  -0.01197701  0.13962421]
Stock Position:  -0.003979403443356016
Bond Position:  [17.532216]


portfolio before change:  [17.13912684]
curr_Stock_Price:  100.98434599985586
curr_Factors:  [100.984346    -1.00080956  -1.11624173]
mat_Sqrt:  [[12.15711053  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150627 -0.01202247 -0.00465156]
Stock Position:  -0.0015062725737591464
Bond Position:  [17.29123679]


portfolio before change:  [17.15024758]
curr_Stock_Price:  99.34257377617307
curr_Factors:  [99.34257378 -1.1798209  -1.15375714]
mat_Sqrt:  [[ 9.63108778  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00173224  0.03410089 -0.11406853]
Stock Position:  0.001732239230920429
Bond Position:  [16.97816248]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.15902344]
Stock Price:  99.5069010130384
PL:  [17.15902344]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.20544765e-01 -1.52471608e-01 -6.48544163e-02]
 [ 2.05642334e-02  6.76441078e-02 -1.62810795e-02]
 [-8.37636226e-02  3.44120175e-01  4.34662163e-01]
 [ 1.02916800e-01  2.51525116e-02  1.18534002e-02]
 [ 5.02311218e-02  1.61999243e-02  2.74387147e-02]
 [-7.19482713e-02 -2.75812856e-02 -1.77310360e-03]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-2.08223568e-02 -4.10692665e-02  5.54897200e-03]
 [ 1.55905138e-01  1.11435366e-01 -1.13888604e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.4207973]
curr_Stock_Price:  98.96447252695924
curr_Factors:  [98.96447253 -1.2587141  -0.97403358]
mat_Sqrt:  [[10.61229515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07207736 -0.04921    -0.1850116 ]
Stock Position:  -0.07207736338148686
Bond Position:  [1.71230095]


portfolio before change:  [-5.41160692]
curr_Stock_Price:  98.84884661540812
curr_Factors:  [98.84884662 -1.06890355 -0.99015675]
mat_Sqrt:  [[12.61052252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00246212  0.02183204 -0.04644539]
Stock Position:  0.0024621238038012097
Bond Position:  [-5.65498502]


portfolio before change:  [-5.4107991]
curr_Stock_Price:  100.32562868568075
curr_Factors:  [100.32562869  -1.09681295  -1.00187772]
mat_Sqrt:  [[12.30161449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0061134  0.11106431 1.23997016]
Stock Position:  0.006113397262240178
Bond Position:  [-6.02412953]


portfolio before change:  [-5.41459453]
curr_Stock_Price:  100.19761409464402
curr_Factors:  [100.19761409  -1.01410877  -0.93431167]
mat_Sqrt:  [[14.27805785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00773709 0.00811794 0.03381445]
Stock Position:  0.007737088738045664
Bond Position:  [-6.18983236]


portfolio before change:  [-5.41646696]
curr_Stock_Price:  100.35571671500479
curr_Factors:  [100.35571672  -0.90760897  -0.93796617]
mat_Sqrt:  [[15.84962589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00373124 0.0052285  0.07827502]
Stock Position:  0.0037312440141621848
Bond Position:  [-5.79091863]


portfolio before change:  [-5.42319457]
curr_Stock_Price:  99.32886776461807
curr_Factors:  [99.32886776 -1.10767839 -0.92547616]
mat_Sqrt:  [[13.00432104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00599341 -0.00890182 -0.00505817]
Stock Position:  -0.00599340870417663
Bond Position:  [-4.82787607]


portfolio before change:  [-5.4362599]
curr_Stock_Price:  101.10595176445206
curr_Factors:  [101.10595176  -1.57100589  -0.98818167]
mat_Sqrt:  [[ 7.82232198  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00613618 -0.01197701  0.13962421]
Stock Position:  -0.006136176595901005
Bond Position:  [-4.81585593]


portfolio before change:  [-5.43248359]
curr_Stock_Price:  100.09802160086201
curr_Factors:  [100.0980216   -1.9975333   -0.92748888]
mat_Sqrt:  [[ 5.3716104   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00522616 -0.01325505  0.01582967]
Stock Position:  -0.0052261620864659155
Bond Position:  [-4.90935511]


portfolio before change:  [-5.43772548]
curr_Stock_Price:  100.63122263629337
curr_Factors:  [100.63122264  -2.01626683  -0.91382057]
mat_Sqrt:  [[ 5.3729396   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03281761  0.03596561 -0.03248925]
Stock Position:  0.032817611791206326
Bond Position:  [-8.74020188]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.42014886]
Stock Price:  101.30000419368444
PL:  [-6.72015305]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-9.75070951e-01 -2.50534932e-01 -3.32620014e-02]
 [-2.30489127e-02  1.66989194e-01  2.32602245e-01]
 [-9.59946983e-02  4.44313380e-01  5.37431036e-01]
 [ 1.05606701e-01  2.66661532e-02  1.26580046e-02]
 [ 4.95097810e-02  2.08478173e-02  2.72308329e-02]
 [-5.92224675e-02 -1.58434782e-02 -8.15889552e-03]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-1.26052935e-02 -4.40688238e-02  3.94839339e-03]
 [ 3.38791483e-02  7.95718868e-02 -1.21146534e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.29814725]
curr_Stock_Price:  99.7449697191928
curr_Factors:  [99.74496972 -0.80741275 -0.97724324]
mat_Sqrt:  [[16.74267143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06169868 -0.0808598  -0.09488723]
Stock Position:  -0.06169868179919879
Bond Position:  [6.4522804]


portfolio before change:  [0.1642155]
curr_Stock_Price:  101.968010704371
curr_Factors:  [101.9680107   -0.75271882  -0.90719818]
mat_Sqrt:  [[19.38970302  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00301796 0.05389553 0.66354946]
Stock Position:  0.003017960007781912
Bond Position:  [-0.14351988]


portfolio before change:  [0.1589767]
curr_Stock_Price:  100.2559213359639
curr_Factors:  [100.25592134  -0.77320162  -0.89047416]
mat_Sqrt:  [[18.99261748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00549703 0.14340153 1.53314116]
Stock Position:  0.005497032813627199
Bond Position:  [-0.39213338]


portfolio before change:  [0.16462377]
curr_Stock_Price:  101.31889209682002
curr_Factors:  [101.3188921   -1.10860275  -0.93006695]
mat_Sqrt:  [[13.19190242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0086139  0.00860646 0.03610976]
Stock Position:  0.008613898723810987
Bond Position:  [-0.7081269]


portfolio before change:  [0.15965946]
curr_Stock_Price:  100.78369153275662
curr_Factors:  [100.78369153  -0.59281143  -0.92109558]
mat_Sqrt:  [[22.17730684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00267498 0.0067286  0.07768199]
Stock Position:  0.0026749773898690097
Bond Position:  [-0.10993464]


portfolio before change:  [0.15710932]
curr_Stock_Price:  99.85091487333948
curr_Factors:  [99.85091487 -0.47407721 -0.91401869]
mat_Sqrt:  [[24.91779805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257334 -0.00511346 -0.02327506]
Stock Position:  -0.0025733385972387347
Bond Position:  [0.41405953]


portfolio before change:  [0.15203162]
curr_Stock_Price:  101.90458337915125
curr_Factors:  [101.90458338  -0.47699106  -0.86640762]
mat_Sqrt:  [[26.59273991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180497 -0.01197701  0.13962421]
Stock Position:  -0.0018049719289343832
Bond Position:  [0.33596653]


portfolio before change:  [0.15360487]
curr_Stock_Price:  101.1260543591279
curr_Factors:  [101.12605436  -0.50960865  -0.90408938]
mat_Sqrt:  [[24.59811405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084538 -0.01422315  0.01126367]
Stock Position:  -0.0008453835950730388
Bond Position:  [0.23909517]


portfolio before change:  [0.15284891]
curr_Stock_Price:  102.16172532187241
curr_Factors:  [102.16172532  -0.96424315  -0.85303827]
mat_Sqrt:  [[16.59789174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00287077  0.02568172 -0.03455973]
Stock Position:  0.00287077414006984
Bond Position:  [-0.14043433]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.14804267]
Stock Price:  100.5119964027821
PL:  [-0.36395373]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.09277054e+00 -2.65147744e-01 -5.78200835e-02]
 [-7.94735484e-03  1.32530879e-01  1.47318258e-01]
 [-9.62870964e-02  4.18870158e-01  5.11446782e-01]
 [ 1.03007256e-01  2.52034121e-02  1.18804574e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 3.00881366e-02  2.23664250e-02 -4.45179094e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 9.93516711e-03  1.57710678e-02 -4.63223487e-02]
 [ 2.18683955e-01  4.54633684e-02  4.40105255e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.85087493]
curr_Stock_Price:  100.77573382096105
curr_Factors:  [100.77573382  -1.10273008  -0.99940192]
mat_Sqrt:  [[12.3143543   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09409312 -0.08557607 -0.1649446 ]
Stock Position:  -0.09409312469999227
Bond Position:  [17.33317862]


portfolio before change:  [7.84865217]
curr_Stock_Price:  100.89148631110187
curr_Factors:  [100.89148631  -0.91841365  -0.95599501]
mat_Sqrt:  [[15.48136248  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0031765  0.04277416 0.42025798]
Stock Position:  0.0031765040801372494
Bond Position:  [7.52816995]


portfolio before change:  [7.85550774]
curr_Stock_Price:  101.86442523086693
curr_Factors:  [101.86442523  -1.20385478  -1.01123634]
mat_Sqrt:  [[11.11784693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00842007 0.13518976 1.45901531]
Stock Position:  0.008420070396609249
Bond Position:  [6.99780211]


portfolio before change:  [7.84476023]
curr_Stock_Price:  100.1723621230757
curr_Factors:  [100.17236212  -0.90356727  -1.00773146]
mat_Sqrt:  [[14.81430981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0074642  0.00813437 0.03389164]
Stock Position:  0.007464199862722389
Bond Position:  [7.09705369]


portfolio before change:  [7.85915388]
curr_Stock_Price:  101.6251953597022
curr_Factors:  [101.62519536  -0.94413009  -0.97254835]
mat_Sqrt:  [[14.94853135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00390147 -0.00140152  0.08089603]
Stock Position:  0.003901473266560929
Bond Position:  [7.46266589]


portfolio before change:  [7.86798538]
curr_Stock_Price:  102.93219882513282
curr_Factors:  [102.93219883  -0.97469267  -0.98962437]
mat_Sqrt:  [[14.43640972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177097  0.00721873 -0.1269972 ]
Stock Position:  0.001770972445166487
Bond Position:  [7.68569529]


portfolio before change:  [7.87200386]
curr_Stock_Price:  103.03082634466455
curr_Factors:  [103.03082634  -1.23150614  -0.90981779]
mat_Sqrt:  [[12.10603752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00396489 -0.01197701  0.13962421]
Stock Position:  -0.003964893465552542
Bond Position:  [8.28051011]


portfolio before change:  [7.87130475]
curr_Stock_Price:  104.25164043841704
curr_Factors:  [104.25164044  -1.12034755  -0.92523364]
mat_Sqrt:  [[13.48026006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00027439  0.00509009 -0.13214477]
Stock Position:  0.00027439478125590016
Bond Position:  [7.84269864]


portfolio before change:  [7.87537303]
curr_Stock_Price:  104.78354644375047
curr_Factors:  [104.78354644  -1.52764611  -0.88798498]
mat_Sqrt:  [[ 9.35831892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02531948 0.01467324 0.12554978]
Stock Position:  0.025319476645520343
Bond Position:  [5.22230847]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.87811566]
Stock Price:  104.78871328108765
PL:  [3.08940238]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-4.35497060e-01 -4.81606933e-02 -2.03256315e-02]
 [ 3.00312160e-02  5.33908421e-02 -5.85535264e-02]
 [-6.19100746e-02  3.06576820e-01  3.22271629e-01]
 [ 1.01418732e-01  2.52001199e-02  1.35300369e-02]
 [ 5.40958501e-02 -1.50001685e-02  4.11086065e-02]
 [-4.57184813e-02 -6.03332622e-04 -1.45106327e-02]
 [-2.89794798e-02  2.81310302e-02  4.46856263e-02]
 [-3.84853665e-02 -1.00360486e-01  5.65635300e-02]
 [ 4.49842973e-02 -5.08708019e-02 -1.05624081e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-26.72052862]
curr_Stock_Price:  96.05757592331192
curr_Factors:  [96.05757592 -0.88516519 -0.97176202]
mat_Sqrt:  [[14.9995553   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02996601 -0.0155438  -0.05798337]
Stock Position:  -0.0299660065287216
Bond Position:  [-23.84206668]


portfolio before change:  [-26.72467443]
curr_Stock_Price:  95.79800804703821
curr_Factors:  [95.79800805 -1.13872981 -0.96551771]
mat_Sqrt:  [[11.6813595   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00248065  0.01723182 -0.16703691]
Stock Position:  0.002480651975222619
Bond Position:  [-26.96231594]


portfolio before change:  [-26.73332344]
curr_Stock_Price:  97.74729976750443
curr_Factors:  [97.74729977 -1.03998414 -0.93088512]
mat_Sqrt:  [[13.61968699  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00487919 0.09894724 0.91935125]
Stock Position:  0.004879192713017752
Bond Position:  [-27.21025135]


portfolio before change:  [-26.73960466]
curr_Stock_Price:  99.24904513720865
curr_Factors:  [99.24904514 -0.96721235 -0.920897  ]
mat_Sqrt:  [[15.02210737  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00727757 0.0081333  0.03859743]
Stock Position:  0.007277573614314737
Bond Position:  [-27.46189689]


portfolio before change:  [-26.75730408]
curr_Stock_Price:  98.70421607872875
curr_Factors:  [98.70421608 -1.35531712 -0.89632577]
mat_Sqrt:  [[10.38627037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00572152 -0.00484128  0.11727141]
Stock Position:  0.005721516056579423
Bond Position:  [-27.32204183]


portfolio before change:  [-26.77905115]
curr_Stock_Price:  97.29154153918626
curr_Factors:  [97.29154154 -1.18036396 -0.82088088]
mat_Sqrt:  [[13.15059776  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371113 -0.00019472 -0.0413948 ]
Stock Position:  -0.0037111321858074794
Bond Position:  [-26.41798938]


portfolio before change:  [-26.79412159]
curr_Stock_Price:  97.79223392559473
curr_Factors:  [97.79223393 -1.19191789 -0.78710443]
mat_Sqrt:  [[13.51530644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104443  0.00907925  0.12747565]
Stock Position:  -0.0010444337371677253
Bond Position:  [-26.69198408]


portfolio before change:  [-26.80765903]
curr_Stock_Price:  97.97234148676995
curr_Factors:  [97.97234149 -0.98315358 -0.85381795]
mat_Sqrt:  [[15.60690856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303874 -0.03239121  0.16136001]
Stock Position:  -0.003038742916138659
Bond Position:  [-26.50994627]


portfolio before change:  [-26.81414604]
curr_Stock_Price:  95.74402779968776
curr_Factors:  [95.7440278  -1.1434763  -0.80246778]
mat_Sqrt:  [[13.67725417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009534  -0.01641848 -0.3013161 ]
Stock Position:  0.0009534013852192776
Bond Position:  [-26.90542853]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-26.82649189]
Stock Price:  96.90852340395374
PL:  [-26.82649189]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.41709360e-01 -1.75590657e-01 -2.06391722e-02]
 [ 2.71079973e-02  5.97780735e-02 -3.19119579e-02]
 [-6.71538645e-02  3.31540231e-01  3.57272788e-01]
 [ 1.01614864e-01  2.44198952e-02  1.14639643e-02]
 [ 5.17817065e-02  6.20887535e-03  2.78855747e-02]
 [-8.35891594e-03  1.92471430e-02 -3.23106977e-02]
 [-5.04162461e-02 -3.64932971e-02  4.90034586e-02]
 [ 9.44842253e-03  3.16915318e-03 -3.76136623e-02]
 [ 2.00338517e-01 -6.89544689e-03  8.29789088e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.85659746]
curr_Stock_Price:  98.08614193420063
curr_Factors:  [98.08614193 -0.65451683 -1.03942928]
mat_Sqrt:  [[18.02752891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04336505 -0.05667164 -0.05887781]
Stock Position:  -0.043365045199068405
Bond Position:  [-7.60308749]


portfolio before change:  [-11.82878978]
curr_Stock_Price:  97.35720981204355
curr_Factors:  [97.35720981 -0.94110811 -0.96237694]
mat_Sqrt:  [[14.5109239   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0022601   0.01929329 -0.09103593]
Stock Position:  0.0022601003574295197
Bond Position:  [-12.04882685]


portfolio before change:  [-11.83328807]
curr_Stock_Price:  98.03312444464108
curr_Factors:  [98.03312444 -0.86256407 -0.97244836]
mat_Sqrt:  [[15.64721573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00469409 0.10700415 1.01919982]
Stock Position:  0.004694094184047037
Bond Position:  [-12.29346479]


portfolio before change:  [-11.83205295]
curr_Stock_Price:  99.60603444121021
curr_Factors:  [99.60603444 -1.02837136 -1.02619922]
mat_Sqrt:  [[12.76429949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00853471 0.00788149 0.0327035 ]
Stock Position:  0.008534712467309736
Bond Position:  [-12.68216181]


portfolio before change:  [-11.83147334]
curr_Stock_Price:  100.4171080860161
curr_Factors:  [100.41710809  -1.11747014  -1.04572387]
mat_Sqrt:  [[11.54368558  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0050886  0.00200391 0.07954978]
Stock Position:  0.00508860074293891
Bond Position:  [-12.34245591]


portfolio before change:  [-11.83506544]
curr_Stock_Price:  100.92425434830469
curr_Factors:  [100.92425435  -0.78323955  -1.08941832]
mat_Sqrt:  [[15.51352794  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007107   0.00621199 -0.09217343]
Stock Position:  -0.0007107024869373674
Bond Position:  [-11.76333832]


portfolio before change:  [-11.84052491]
curr_Stock_Price:  100.32811864535182
curr_Factors:  [100.32811865  -0.46775053  -1.07142179]
mat_Sqrt:  [[21.52626207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00222345 -0.01177816  0.13979323]
Stock Position:  -0.0022234524491212978
Bond Position:  [-11.61745011]


portfolio before change:  [-11.86183865]
curr_Stock_Price:  107.30086404544069
curr_Factors:  [107.30086405   0.38675617  -1.09612268]
mat_Sqrt:  [[52.78727672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.57963868e-05  1.02283979e-03 -1.07301309e-01]
Stock Position:  4.5796386780886426e-05
Bond Position:  [-11.86675264]


portfolio before change:  [-11.86768941]
curr_Stock_Price:  109.13724530554481
curr_Factors:  [109.13724531  -0.26477142  -1.0871529 ]
mat_Sqrt:  [[28.23837602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00764453 -0.0022255   0.23671573]
Stock Position:  0.0076445256141621475
Bond Position:  [-12.70199188]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.87504798]
Stock Price:  109.00565046734833
PL:  [-20.88069844]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.57277792e-01 -1.80671889e-01 -2.04234698e-02]
 [ 4.06205463e-02  4.60271504e-02 -1.72441718e-02]
 [-5.89402450e-02  2.76320079e-01  2.94333280e-01]
 [ 1.18843027e-01  4.41392167e-02  4.05341094e-02]
 [ 5.10979101e-02  3.55374851e-03  4.17658506e-02]
 [-3.96426446e-02  8.44572722e-03 -1.91618676e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-1.41444246e-02 -3.36159364e-02 -2.41869708e-03]
 [ 1.49960479e-01  1.02393913e-01 -6.87385637e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.18938767]
curr_Stock_Price:  98.17719988502166
curr_Factors:  [98.17719989 -0.67442373 -1.01502713]
mat_Sqrt:  [[18.12556093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04404422 -0.0583116  -0.05826247]
Stock Position:  -0.04404422092026071
Bond Position:  [-6.86524939]


portfolio before change:  [-11.1473229]
curr_Stock_Price:  97.14418690051619
curr_Factors:  [97.1441869  -0.77422478 -1.01961834]
mat_Sqrt:  [[16.15699717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00287775  0.0148552  -0.04919282]
Stock Position:  0.002877753008691828
Bond Position:  [-11.42687988]


portfolio before change:  [-11.15102537]
curr_Stock_Price:  97.84348292255689
curr_Factors:  [97.84348292 -1.00701743 -1.03921268]
mat_Sqrt:  [[12.64344602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00455128 0.08918192 0.83965092]
Stock Position:  0.004551281678816306
Bond Position:  [-11.59633862]


portfolio before change:  [-11.15223018]
curr_Stock_Price:  98.85304698755421
curr_Factors:  [98.85304699 -1.0401129  -1.06849547]
mat_Sqrt:  [[12.00143226  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01134255 0.01424587 0.11563253]
Stock Position:  0.011342554305980884
Bond Position:  [-12.27347623]


portfolio before change:  [-11.1687315]
curr_Stock_Price:  97.93940355562614
curr_Factors:  [97.93940356 -1.00139028 -1.05828952]
mat_Sqrt:  [[12.48676342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00483302 0.00114697 0.11914635]
Stock Position:  0.004833016573288877
Bond Position:  [-11.64207426]


portfolio before change:  [-11.17127353]
curr_Stock_Price:  98.61816471602248
curr_Factors:  [98.61816472 -1.35469734 -1.02407752]
mat_Sqrt:  [[ 9.13835705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00457742  0.00272585 -0.05466347]
Stock Position:  -0.004577416642634638
Bond Position:  [-10.7198571]


portfolio before change:  [-11.18211056]
curr_Stock_Price:  99.8144208038036
curr_Factors:  [99.8144208  -1.77753772 -1.05057325]
mat_Sqrt:  [[ 5.90147134  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00813342 -0.01197701  0.13962421]
Stock Position:  -0.008133420685606444
Bond Position:  [-10.37027788]


portfolio before change:  [-11.19351414]
curr_Stock_Price:  100.5788163453829
curr_Factors:  [100.57881635  -1.70028885  -1.03936108]
mat_Sqrt:  [[ 6.49668297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330938 -0.0108495  -0.00689987]
Stock Position:  -0.0033093754881134323
Bond Position:  [-10.86066108]


portfolio before change:  [-11.19976535]
curr_Stock_Price:  100.82645005249687
curr_Factors:  [100.82645005  -1.95947476  -1.08057106]
mat_Sqrt:  [[ 4.82280113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03513693  0.03304749 -0.0196092 ]
Stock Position:  0.035136930721750094
Bond Position:  [-14.74249734]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.19239508]
Stock Price:  101.24604720771744
PL:  [-12.43844229]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.42872311e+00 -3.10574652e-01 -1.20090197e-01]
 [-5.87805549e-02  1.94070099e-01  3.75848803e-01]
 [-8.04048201e-02  3.07329681e-01  3.86517839e-01]
 [ 1.04783265e-01  2.62027951e-02  1.24116980e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 5.54809136e-02  1.80764990e-01 -8.51755045e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-6.83639198e-03 -1.99191717e-02 -1.48724209e-02]
 [ 8.40736483e-02  8.60172181e-02 -6.60217824e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.36568523]
curr_Stock_Price:  102.75665330494463
curr_Factors:  [102.7566533   -1.21763099  -1.03156132]
mat_Sqrt:  [[10.83922276  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.13992075 -0.10023754 -0.3425839 ]
Stock Position:  -0.13992075242786658
Bond Position:  [36.74347348]


portfolio before change:  [22.36951448]
curr_Stock_Price:  102.86061992296877
curr_Factors:  [102.86061992  -1.08787273  -1.0325777 ]
mat_Sqrt:  [[12.34096767  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00466363 0.06263586 1.07219202]
Stock Position:  0.004663625697550775
Bond Position:  [21.88981105]


portfolio before change:  [22.37493945]
curr_Stock_Price:  101.67641894445677
curr_Factors:  [101.67641894  -1.76316383  -0.99909242]
mat_Sqrt:  [[ 6.42077711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00953564 0.09919023 1.10262781]
Stock Position:  0.009535638880900801
Bond Position:  [21.40538983]


portfolio before change:  [22.37981676]
curr_Stock_Price:  101.06523144272153
curr_Factors:  [101.06523144  -1.90444445  -0.97303477]
mat_Sqrt:  [[ 5.68759189  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01980898 0.00845692 0.03540712]
Stock Position:  0.019808983751325806
Bond Position:  [20.37781723]


portfolio before change:  [22.38623163]
curr_Stock_Price:  100.8745814445675
curr_Factors:  [100.87458144  -1.87395291  -0.99267882]
mat_Sqrt:  [[ 5.73877775  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01016267 -0.00140152  0.08089603]
Stock Position:  0.010162668432051573
Bond Position:  [21.3610767]


portfolio before change:  [22.39976195]
curr_Stock_Price:  101.15473522786675
curr_Factors:  [101.15473523  -1.9277099   -1.00890198]
mat_Sqrt:  [[ 5.36576791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0139762   0.05834165 -0.24298201]
Stock Position:  0.013976198167782516
Bond Position:  [20.98600332]


portfolio before change:  [22.40113232]
curr_Stock_Price:  100.50182146441841
curr_Factors:  [100.50182146  -1.6992133   -1.00442065]
mat_Sqrt:  [[ 6.72977631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00713235 -0.01197701  0.13962421]
Stock Position:  -0.007132354304677361
Bond Position:  [23.11794692]


portfolio before change:  [22.4079093]
curr_Stock_Price:  101.17269134993084
curr_Factors:  [101.17269135  -1.53925928  -1.02217547]
mat_Sqrt:  [[ 7.80991532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178468 -0.00642889 -0.04242688]
Stock Position:  -0.0017846795414893492
Bond Position:  [22.58847014]


portfolio before change:  [22.41796862]
curr_Stock_Price:  101.86622902365767
curr_Factors:  [101.86622902  -1.30806464  -1.03864903]
mat_Sqrt:  [[ 9.74687579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01028885  0.02776194 -0.01883418]
Stock Position:  0.0102888533377681
Bond Position:  [21.36988193]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.43955332]
Stock Price:  102.92534507471736
PL:  [19.51420825]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.07133783e+00 -2.56727374e-01 -6.54745061e-02]
 [-2.18036013e-02  1.64087366e-01  2.26485307e-01]
 [-1.15670729e-01  5.74291085e-01  6.22617053e-01]
 [ 1.12210372e-01  3.03821230e-02  1.46332977e-02]
 [ 2.43970201e-03 -5.43469573e-02 -2.09108265e-02]
 [ 6.96766693e-02 -4.40387269e-03 -4.86763992e-02]
 [-4.36267967e-02 -2.48488320e-02  2.99629792e-02]
 [ 1.14099937e-03  3.47998937e-03 -3.41609619e-02]
 [ 2.65574817e-01  1.62126312e-02  7.28123758e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.35289313]
curr_Stock_Price:  100.84424712766247
curr_Factors:  [100.84424713  -1.21024565  -0.98463146]
mat_Sqrt:  [[11.23125042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10124492 -0.0828584  -0.18678054]
Stock Position:  -0.10124491716994853
Bond Position:  [18.56286058]


portfolio before change:  [8.26135488]
curr_Stock_Price:  101.84006999564842
curr_Factors:  [101.84007     -0.84739351  -0.97484686]
mat_Sqrt:  [[16.46378756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00351813 0.05295897 0.64609954]
Stock Position:  0.003518127983109557
Bond Position:  [7.90306848]


portfolio before change:  [8.271495]
curr_Stock_Price:  103.59884464665033
curr_Factors:  [103.59884465  -1.16350601  -0.97164136]
mat_Sqrt:  [[12.2481978   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01050335 0.18535165 1.77615315]
Stock Position:  0.010503351034835282
Bond Position:  [7.18335997]


portfolio before change:  [8.27988183]
curr_Stock_Price:  104.05529498872757
curr_Factors:  [104.05529499  -1.51943383  -0.98470208]
mat_Sqrt:  [[ 8.5061254   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01427196 0.00980579 0.04174473]
Stock Position:  0.014271962868566496
Bond Position:  [6.79480853]


portfolio before change:  [8.3090009]
curr_Stock_Price:  105.85748639128543
curr_Factors:  [105.85748639  -1.47624379  -0.97530404]
mat_Sqrt:  [[ 9.12069393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014168  -0.01754041 -0.05965277]
Stock Position:  -0.001416803246930284
Bond Position:  [8.45898013]


portfolio before change:  [8.31270835]
curr_Stock_Price:  106.22669258567616
curr_Factors:  [106.22669259  -1.51078706  -0.92520178]
mat_Sqrt:  [[ 9.29602213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00632977 -0.00142134 -0.13886022]
Stock Position:  0.0063297723856354186
Bond Position:  [7.64031757]


portfolio before change:  [8.31863725]
curr_Stock_Price:  106.55968790133178
curr_Factors:  [106.5596879   -1.2070702   -0.97504661]
mat_Sqrt:  [[12.02019886  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00354261 -0.00801993  0.08547604]
Stock Position:  -0.0035426099271969533
Bond Position:  [8.69613666]


portfolio before change:  [8.32614142]
curr_Stock_Price:  105.66909752693161
curr_Factors:  [105.66909753  -1.56708524  -0.91965034]
mat_Sqrt:  [[ 8.78966778  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0005827   0.00112316 -0.09745172]
Stock Position:  -0.0005826986930966607
Bond Position:  [8.38771467]


portfolio before change:  [8.32963679]
curr_Stock_Price:  106.86961464990571
curr_Factors:  [106.86961465  -1.34849118  -0.86701672]
mat_Sqrt:  [[11.65927077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0243366  0.0052326  0.20771344]
Stock Position:  0.024336596701820885
Bond Position:  [5.72879408]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.3303604]
Stock Price:  106.78161978088268
PL:  [1.54874062]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.32180805e-01 -2.06305284e-01 -3.17052835e-02]
 [ 1.48989162e-02  8.25303430e-02  2.22106267e-02]
 [-1.09058199e-01  5.33896928e-01  6.38419261e-01]
 [ 2.55184814e-01  2.12660203e-01  3.01152229e-01]
 [ 5.48377571e-02 -3.47104528e-02  7.10872853e-02]
 [-5.63398690e-02 -1.46994160e-02 -8.31248863e-03]
 [ 8.46351321e-02  2.49221840e-01  1.40714931e-01]
 [-3.96609016e-02 -1.19010446e-01  3.53864970e-02]
 [-7.75448183e-02 -1.91452464e-01 -1.17705277e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.72728373]
curr_Stock_Price:  98.92264456459182
curr_Factors:  [98.92264456 -0.81209222 -0.97962667]
mat_Sqrt:  [[16.48777647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05341924 -0.06658474 -0.09044635]
Stock Position:  -0.05341924123545144
Bond Position:  [-0.44291112]


portfolio before change:  [-5.7607071]
curr_Stock_Price:  99.54417823703706
curr_Factors:  [99.54417824 -0.67125997 -0.99178224]
mat_Sqrt:  [[18.86973546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00192261 0.02663655 0.06336074]
Stock Position:  0.0019226065538732798
Bond Position:  [-5.95209139]


portfolio before change:  [-5.76199554]
curr_Stock_Price:  100.42233520817709
curr_Factors:  [100.42233521  -0.14165247  -0.99899993]
mat_Sqrt:  [[32.09602676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00405782 0.17231449 1.82123245]
Stock Position:  0.004057818180604401
Bond Position:  [-6.16949111]


portfolio before change:  [-5.7881534]
curr_Stock_Price:  94.73643541032808
curr_Factors:  [94.73643541 -0.59165728 -1.01049815]
mat_Sqrt:  [[19.08577402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01886569 0.06863579 0.85910348]
Stock Position:  0.018865692162028484
Bond Position:  [-7.57542183]


portfolio before change:  [-5.78593488]
curr_Stock_Price:  95.05485333153624
curr_Factors:  [95.05485333 -0.31059672 -0.99481451]
mat_Sqrt:  [[25.76566768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00241652 -0.01120275  0.20279224]
Stock Position:  0.002416515951786889
Bond Position:  [-6.01563645]


portfolio before change:  [-5.78658371]
curr_Stock_Price:  96.03136080292626
curr_Factors:  [96.0313608  -0.96484809 -1.01421854]
mat_Sqrt:  [[13.27135794  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00459916 -0.00474422 -0.02371322]
Stock Position:  -0.004599164202096684
Bond Position:  [-5.34491971]


portfolio before change:  [-5.78147767]
curr_Stock_Price:  94.33993085305961
curr_Factors:  [94.33993085 -0.84673535 -0.96620989]
mat_Sqrt:  [[15.39371507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01066868 0.080436   0.40142053]
Stock Position:  0.010668681429148898
Bond Position:  [-6.78796034]


portfolio before change:  [-5.79230418]
curr_Stock_Price:  93.64334308180216
curr_Factors:  [93.64334308 -0.70498009 -1.0148909 ]
mat_Sqrt:  [[16.77051609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338276 -0.03841046  0.10094783]
Stock Position:  -0.0033827562890658973
Bond Position:  [-5.47553157]


portfolio before change:  [-5.79486495]
curr_Stock_Price:  93.59081805636352
curr_Factors:  [93.59081806 -0.48332917 -1.02571145]
mat_Sqrt:  [[20.69499045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0067964  -0.06179102 -0.33578039]
Stock Position:  -0.006796397336350808
Bond Position:  [-5.15878456]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.80340558]
Stock Price:  94.46784067702622
PL:  [-5.80340558]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.47526761e-01 -2.04425028e-01 -6.11520924e-02]
 [ 1.63638007e-02  7.72819530e-02  6.62922094e-03]
 [-6.28401314e-02  2.48497841e-01  2.97008927e-01]
 [ 1.00996265e-01  2.40718018e-02  1.12789288e-02]
 [ 4.65733316e-02  3.97685572e-02  2.63845832e-02]
 [-8.47797604e-02 -4.12029599e-02  5.64613433e-03]
 [-1.93895465e-02  4.73033946e-02  4.18278400e-02]
 [-3.88782266e-02 -1.03756613e-01  4.94767919e-02]
 [ 8.52390500e-02  4.17953424e-02 -8.61395758e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.02503477]
curr_Stock_Price:  99.7076964906896
curr_Factors:  [99.70769649 -1.16231638 -0.9666226 ]
mat_Sqrt:  [[11.86157153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07602175 -0.06597789 -0.1744499 ]
Stock Position:  -0.07602175323684017
Bond Position:  [7.60498867]


portfolio before change:  [0.06147788]
curr_Stock_Price:  99.27835007900838
curr_Factors:  [99.27835008 -0.90010887 -0.93412059]
mat_Sqrt:  [[15.85837984  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00211195 0.02494264 0.01891132]
Stock Position:  0.002111949496840281
Bond Position:  [-0.14819298]


portfolio before change:  [0.06092687]
curr_Stock_Price:  99.05254267691667
curr_Factors:  [99.05254268 -1.47350213 -0.90434568]
mat_Sqrt:  [[ 9.18712122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00528032 0.08020233 0.8472838 ]
Stock Position:  0.005280323416570414
Bond Position:  [-0.46210259]


portfolio before change:  [0.06304072]
curr_Stock_Price:  99.49663605914236
curr_Factors:  [99.49663606 -1.36437482 -0.87347875]
mat_Sqrt:  [[10.61502299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01019425 0.00776914 0.03217564]
Stock Position:  0.010194250441089618
Bond Position:  [-0.95125291]


portfolio before change:  [0.04978423]
curr_Stock_Price:  98.24291554748325
curr_Factors:  [98.24291555 -0.78512126 -0.87786904]
mat_Sqrt:  [[18.62403291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00322577 0.01283525 0.07526787]
Stock Position:  0.0032257666832596716
Bond Position:  [-0.26712449]


portfolio before change:  [0.04688855]
curr_Stock_Price:  97.38665746517363
curr_Factors:  [97.38665747 -0.95518748 -0.89238999]
mat_Sqrt:  [[15.3499428   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00599597 -0.0132982   0.01610685]
Stock Position:  -0.00599596808158112
Bond Position:  [0.63081584]


portfolio before change:  [0.0487687]
curr_Stock_Price:  97.12570520415413
curr_Factors:  [97.1257052  -1.0677499  -0.86626638]
mat_Sqrt:  [[14.04111467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.51577288e-05  1.52671049e-02  1.19323185e-01]
Stock Position:  -8.515772875590892e-05
Bond Position:  [0.0570397]


portfolio before change:  [0.04885512]
curr_Stock_Price:  96.44583814091058
curr_Factors:  [96.44583814 -1.31084701 -0.89637599]
mat_Sqrt:  [[10.60959289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00470876 -0.0334873   0.14114352]
Stock Position:  -0.004708762085482577
Bond Position:  [0.50299562]


portfolio before change:  [0.04804214]
curr_Stock_Price:  96.6719154288583
curr_Factors:  [96.67191543 -1.45470336 -0.91954278]
mat_Sqrt:  [[ 8.99867004  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00846651  0.01348939 -0.24573223]
Stock Position:  0.008466509040616611
Bond Position:  [-0.77043151]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.05503697]
Stock Price:  97.54360295588364
PL:  [0.05503697]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.10506430e+00 -2.72825644e-01 -4.74331235e-02]
 [ 2.17584877e-02  6.51741298e-02 -2.68980700e-02]
 [-6.23287038e-02  2.43607413e-01  2.92358848e-01]
 [ 1.01048397e-01  2.45211330e-02  1.22965342e-02]
 [ 4.84117871e-02  2.54426027e-02  3.18587169e-02]
 [-1.03203694e-01 -5.83724884e-02  1.46888109e-02]
 [-5.04578109e-02 -1.72419522e-02  5.08547259e-02]
 [-2.04980193e-02 -6.42100440e-02  2.10036496e-02]
 [-2.65658026e-02  8.31066804e-02 -3.83276752e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.52203427]
curr_Stock_Price:  100.59437930824886
curr_Factors:  [100.59437931  -0.91573901  -1.05640035]
mat_Sqrt:  [[13.99859577  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08361102 -0.0880541  -0.1353135 ]
Stock Position:  -0.0836110183369162
Bond Position:  [14.93283276]


portfolio before change:  [6.71719491]
curr_Stock_Price:  98.34955121558518
curr_Factors:  [98.34955122 -1.05435822 -1.04777683]
mat_Sqrt:  [[12.01784864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00246064  0.02103486 -0.07673271]
Stock Position:  0.0024606363868064198
Bond Position:  [6.47519243]


portfolio before change:  [6.72199514]
curr_Stock_Price:  98.98427505864153
curr_Factors:  [98.98427506 -1.16193661 -1.09162027]
mat_Sqrt:  [[10.39582332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00452826 0.07862395 0.83401842]
Stock Position:  0.004528256175166113
Bond Position:  [6.27376899]


portfolio before change:  [6.7254185]
curr_Stock_Price:  99.04736532586021
curr_Factors:  [99.04736533 -1.43409792 -1.0404329 ]
mat_Sqrt:  [[ 8.34003454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01301718 0.00791416 0.03507859]
Stock Position:  0.013017184917929647
Bond Position:  [5.43610063]


portfolio before change:  [6.7176817]
curr_Stock_Price:  98.24415517187683
curr_Factors:  [98.24415517 -0.85661497 -1.1086431 ]
mat_Sqrt:  [[13.76594374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00436645 0.00821156 0.09088405]
Stock Position:  0.004366454716103172
Bond Position:  [6.28870304]


portfolio before change:  [6.71754546]
curr_Stock_Price:  97.49265760908051
curr_Factors:  [97.49265761 -0.89361635 -1.08288316]
mat_Sqrt:  [[13.50793868  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00830035 -0.01883964  0.04190309]
Stock Position:  -0.008300347654616692
Bond Position:  [7.52676841]


portfolio before change:  [6.70518783]
curr_Stock_Price:  99.43497961552687
curr_Factors:  [99.43497962 -1.11897619 -1.12683384]
mat_Sqrt:  [[10.52437431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00414244 -0.00556482  0.14507438]
Stock Position:  -0.004142444097558424
Bond Position:  [7.11709168]


portfolio before change:  [6.70510597]
curr_Stock_Price:  100.31400198788218
curr_Factors:  [100.31400199  -0.66192143  -1.14159937]
mat_Sqrt:  [[16.52351449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177429 -0.0207237   0.05991757]
Stock Position:  -0.0017742888528892277
Bond Position:  [6.88309198]


portfolio before change:  [6.7102701]
curr_Stock_Price:  99.34362909659453
curr_Factors:  [99.3436291  -0.70891111 -1.05292948]
mat_Sqrt:  [[17.0601315   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102141  0.02682257 -0.10933819]
Stock Position:  -0.0010214063390015342
Bond Position:  [6.81174031]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.71607512]
Stock Price:  96.99558619216272
PL:  [6.71607512]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.94947209e-01 -2.28735181e-01 -4.14985526e-02]
 [-8.70549921e-03  1.34219213e-01  1.52231127e-01]
 [-1.03976925e-01  4.71402919e-01  5.79157732e-01]
 [ 1.74516216e-01  1.02536665e-01  1.21768400e-01]
 [ 5.10934413e-02  1.06436490e-02  2.76872249e-02]
 [-2.83307923e-02  4.56878351e-03 -2.23039313e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-8.72315321e-03 -3.53997460e-02 -3.60624351e-03]
 [-9.69107802e-02  2.21448047e-02 -4.07486907e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.27699301]
curr_Stock_Price:  99.53000128524121
curr_Factors:  [99.53000129 -0.81807891 -1.05409304]
mat_Sqrt:  [[15.30664681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06207162 -0.07382396 -0.11838382]
Stock Position:  -0.062071624862993606
Bond Position:  [4.90099589]


portfolio before change:  [-1.36037704]
curr_Stock_Price:  100.91284140859531
curr_Factors:  [100.91284141  -0.96937992  -1.0278468 ]
mat_Sqrt:  [[13.69499542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00363388 0.04331906 0.43427303]
Stock Position:  0.0036338772050879004
Bond Position:  [-1.72708191]


portfolio before change:  [-1.35834837]
curr_Stock_Price:  101.70880213417144
curr_Factors:  [101.70880213  -0.88517134  -0.99271665]
mat_Sqrt:  [[15.55256932  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00710287 0.15214464 1.6521758 ]
Stock Position:  0.007102869451140125
Bond Position:  [-2.08077271]


portfolio before change:  [-1.38829289]
curr_Stock_Price:  97.63947872576496
curr_Factors:  [97.63947873 -0.85606394 -0.9810865 ]
mat_Sqrt:  [[15.55110146  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01416635 0.03309357 0.34737135]
Stock Position:  0.014166346770713389
Bond Position:  [-2.7714876]


portfolio before change:  [-1.3473095]
curr_Stock_Price:  100.63033268239398
curr_Factors:  [100.63033268  -0.93244646  -1.00056544]
mat_Sqrt:  [[14.56238498  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00404588 0.00343522 0.07898395]
Stock Position:  0.00404588247198237
Bond Position:  [-1.754448]


portfolio before change:  [-1.34916685]
curr_Stock_Price:  100.388135827249
curr_Factors:  [100.38813583  -1.1788773   -1.03426909]
mat_Sqrt:  [[10.97804793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291044  0.00147457 -0.06362691]
Stock Position:  -0.00291044130789302
Bond Position:  [-1.05699307]


portfolio before change:  [-1.35473933]
curr_Stock_Price:  102.12115664417719
curr_Factors:  [102.12115664  -1.31352289  -1.00552184]
mat_Sqrt:  [[10.04540369  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00477822 -0.01197701  0.13962421]
Stock Position:  -0.004778220021828943
Bond Position:  [-0.86678198]


portfolio before change:  [-1.35112919]
curr_Stock_Price:  101.27489203999093
curr_Factors:  [101.27489204  -0.70432138  -1.00666473]
mat_Sqrt:  [[18.29910977  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0009118  -0.01142522 -0.01028761]
Stock Position:  -0.000911804873914751
Bond Position:  [-1.25878625]


portfolio before change:  [-1.35042718]
curr_Stock_Price:  99.81452703762842
curr_Factors:  [ 9.98145270e+01 -6.35800407e-02 -9.72653323e-01]
mat_Sqrt:  [[35.41304909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284382  0.0071472  -0.11624467]
Stock Position:  -0.0028438184549280177
Bond Position:  [-1.06657278]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.34258043]
Stock Price:  96.86772712173327
PL:  [-1.34258043]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-9.71708038e-01 -2.48715090e-01 -3.55128970e-02]
 [ 5.46996306e-02  3.53060111e-02  2.52221104e-02]
 [-7.08702957e-02  4.33815855e-01  4.24664916e-01]
 [ 2.28593641e-01  3.06844473e-01  2.99029323e-01]
 [ 1.88141612e-02 -1.34065558e-01  1.66305453e-01]
 [-4.69403922e-02  8.32868922e-03 -1.62825825e-02]
 [ 2.61685568e-01  5.79339400e-01  2.97454574e-01]
 [-4.35070249e-02 -1.32876945e-01 -3.76835686e-02]
 [ 2.59596533e-01 -8.11499920e-01 -2.62579812e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.53773063]
curr_Stock_Price:  99.77766703804241
curr_Factors:  [99.77766704 -0.83754957 -0.9746576 ]
mat_Sqrt:  [[16.29302678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0632004  -0.08027245 -0.10130841]
Stock Position:  -0.0632004014519994
Bond Position:  [6.84371924]


portfolio before change:  [0.65406429]
curr_Stock_Price:  97.99111274976526
curr_Factors:  [97.99111275 -0.42805762 -0.97465165]
mat_Sqrt:  [[24.09893195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00278248 0.01139497 0.07195166]
Stock Position:  0.0027824835467004138
Bond Position:  [0.38140563]


portfolio before change:  [0.64774016]
curr_Stock_Price:  95.64972254472954
curr_Factors:  [95.64972254 -0.12829357 -0.96330764]
mat_Sqrt:  [[32.10756227  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00325052 0.14001346 1.2114508 ]
Stock Position:  0.0032505226301945958
Bond Position:  [0.33682858]


portfolio before change:  [0.63739841]
curr_Stock_Price:  92.4163308816217
curr_Factors:  [92.41633088 -0.36629279 -0.90607285]
mat_Sqrt:  [[25.89210409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01360519 0.09903363 0.85304742]
Stock Position:  0.013605194495906544
Bond Position:  [-0.61994375]


portfolio before change:  [0.62471043]
curr_Stock_Price:  91.50653680814256
curr_Factors:  [91.50653681 -0.36093843 -0.84460897]
mat_Sqrt:  [[27.40876912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00092653 -0.04326947  0.47442317]
Stock Position:  0.0009265320259673958
Bond Position:  [0.5399267]


portfolio before change:  [0.62408871]
curr_Stock_Price:  90.54407416858534
curr_Factors:  [90.54407417 -0.28847032 -0.84658598]
mat_Sqrt:  [[29.10123001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166879  0.00268807 -0.04644968]
Stock Position:  -0.00166879454554037
Bond Position:  [0.77518817]


portfolio before change:  [0.6263649]
curr_Stock_Price:  89.41242245114158
curr_Factors:  [89.41242245 -0.64318214 -0.77649196]
mat_Sqrt:  [[21.61928034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02038275 0.18698099 0.8485551 ]
Stock Position:  0.02038275008538747
Bond Position:  [-1.19610617]


portfolio before change:  [0.5596062]
curr_Stock_Price:  86.16651650362026
curr_Factors:  [86.1665165  -0.2126911  -0.76248817]
mat_Sqrt:  [[32.49552515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241026 -0.04288585 -0.10750073]
Stock Position:  -0.002410256290213151
Bond Position:  [0.76728959]


portfolio before change:  [0.57441237]
curr_Stock_Price:  80.18274576273852
curr_Factors:  [80.18274576 -0.61237154 -0.68108757]
mat_Sqrt:  [[21.99574983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00183449 -0.26191047 -0.74906712]
Stock Position:  0.00183448739812284
Bond Position:  [0.42731813]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.58084973]
Stock Price:  83.5753311180039
PL:  [0.58084973]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.17555115e+00 -2.95096481e-01 -3.36748519e-02]
 [-1.33532681e-03  1.17479150e-01  1.09440018e-01]
 [-8.38060197e-02  4.03199669e-01  4.64588707e-01]
 [ 1.72732737e-01  1.00710090e-01  1.19271470e-01]
 [ 5.05191569e-02  1.43439972e-02  2.75217230e-02]
 [-7.04460124e-02 -2.58833361e-02 -2.69711862e-03]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 1.52415651e-02  1.74889642e-02 -4.98195216e-02]
 [ 8.99040611e-02  7.63962644e-02  6.50925208e-04]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.88250062]
curr_Stock_Price:  100.64357422089623
curr_Factors:  [100.64357422  -0.8128492   -1.00109058]
mat_Sqrt:  [[16.40597383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07574444 -0.09524198 -0.09606498]
Stock Position:  -0.0757444408599189
Bond Position:  [14.50569188]


portfolio before change:  [6.90635135]
curr_Stock_Price:  100.4244681864631
curr_Factors:  [100.42446819  -0.95467292  -1.03994453]
mat_Sqrt:  [[13.66432513  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0032921  0.03791623 0.31220191]
Stock Position:  0.0032921021660227124
Bond Position:  [6.57574374]


portfolio before change:  [6.90547789]
curr_Stock_Price:  99.16018340767442
curr_Factors:  [99.16018341 -0.61348494 -0.95728657]
mat_Sqrt:  [[20.61388858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00452756 0.13013213 1.32534226]
Stock Position:  0.004527556285510874
Bond Position:  [6.45652457]


portfolio before change:  [6.90403844]
curr_Stock_Price:  98.12904908643229
curr_Factors:  [98.12904909 -0.40331903 -0.93960657]
mat_Sqrt:  [[25.61960408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00849491 0.03250404 0.34024831]
Stock Position:  0.008494912107801502
Bond Position:  [6.07044079]


portfolio before change:  [6.92821775]
curr_Stock_Price:  100.61798940627254
curr_Factors:  [100.61798941  -0.4398231   -0.99726883]
mat_Sqrt:  [[23.90862172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00247045 0.00462951 0.07851182]
Stock Position:  0.0024704460979188495
Bond Position:  [6.67964643]


portfolio before change:  [6.92888982]
curr_Stock_Price:  99.53778626217908
curr_Factors:  [99.53778626 -0.53168886 -0.98797194]
mat_Sqrt:  [[21.77748281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035027  -0.00835381 -0.00769413]
Stock Position:  -0.0035026992750177596
Bond Position:  [7.27754075]


portfolio before change:  [6.92878365]
curr_Stock_Price:  100.60720573806164
curr_Factors:  [100.60720574  -0.82504883  -0.90743251]
mat_Sqrt:  [[17.79188668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269781 -0.01197701  0.13962421]
Stock Position:  -0.0026978110825595257
Bond Position:  [7.20020288]


portfolio before change:  [6.92529809]
curr_Stock_Price:  103.2339874074439
curr_Factors:  [103.23398741  -0.60387594  -0.87965719]
mat_Sqrt:  [[23.41706439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036905  0.00564454 -0.14212123]
Stock Position:  0.0003690521389498667
Bond Position:  [6.88719936]


portfolio before change:  [6.92847443]
curr_Stock_Price:  102.50748136609513
curr_Factors:  [102.50748137  -1.21450892  -0.96505281]
mat_Sqrt:  [[11.59268216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00911189 0.02465679 0.00185691]
Stock Position:  0.009111890704344736
Bond Position:  [5.99443746]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.91233728]
Stock Price:  100.40746482403502
PL:  [6.50487245]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.23773651e+00 -3.07379327e-01 -3.70439839e-02]
 [ 2.38930182e-02  6.49489298e-02 -1.57986012e-02]
 [-6.57907708e-02  3.43777318e-01  3.57602639e-01]
 [ 1.67949376e-01  9.58111470e-02  1.12574607e-01]
 [ 4.99154756e-02  7.99921369e-03  4.77518046e-02]
 [-1.07337997e-01 -6.22253053e-02  1.67179742e-02]
 [ 6.19513311e-02  2.16305892e-01  1.36139742e-01]
 [-3.79781495e-02 -1.15432340e-01  6.78451009e-02]
 [-8.58024032e-02  2.62255023e-02 -4.48628220e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.38417177]
curr_Stock_Price:  100.84851590230816
curr_Factors:  [100.8485159   -0.70558677  -1.05195456]
mat_Sqrt:  [[17.39318068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07520428 -0.09920625 -0.10567617]
Stock Position:  -0.07520427986667226
Bond Position:  [15.96841178]


portfolio before change:  [8.55982617]
curr_Stock_Price:  98.61901243936506
curr_Factors:  [98.61901244 -0.79873663 -1.03350442]
mat_Sqrt:  [[15.78441438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00214932  0.02096218 -0.04506901]
Stock Position:  0.002149321866021972
Bond Position:  [8.34786217]


portfolio before change:  [8.55963056]
curr_Stock_Price:  96.58554200844439
curr_Factors:  [96.58554201 -0.45365832 -1.03952029]
mat_Sqrt:  [[21.69865886  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00356602 0.11095365 1.02014079]
Stock Position:  0.003566018240725007
Bond Position:  [8.21520476]


portfolio before change:  [8.56768158]
curr_Stock_Price:  97.69108516624392
curr_Factors:  [97.69108517 -1.01938038 -1.0775376 ]
mat_Sqrt:  [[11.9998281   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01754075 0.03092291 0.32114402]
Stock Position:  0.017540746210427102
Bond Position:  [6.85410705]


portfolio before change:  [8.56033014]
curr_Stock_Price:  97.07655291590824
curr_Factors:  [97.07655292 -0.77823512 -1.12007288]
mat_Sqrt:  [[14.54419402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00421444 0.00258174 0.13622261]
Stock Position:  0.004214438039460806
Bond Position:  [8.15120702]


portfolio before change:  [8.56836333]
curr_Stock_Price:  98.01536504693537
curr_Factors:  [98.01536505 -0.75977234 -1.1810377 ]
mat_Sqrt:  [[14.07379018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00828683 -0.02008313  0.04769173]
Stock Position:  -0.008286832532240404
Bond Position:  [9.38060024]


portfolio before change:  [8.59504651]
curr_Stock_Price:  95.36155160598754
curr_Factors:  [95.36155161 -0.78731208 -1.18526255]
mat_Sqrt:  [[13.26462665  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01009406 0.06981243 0.38836879]
Stock Position:  0.010094064358105006
Bond Position:  [7.63246087]


portfolio before change:  [8.61216957]
curr_Stock_Price:  96.67973978454249
curr_Factors:  [96.67973978 -0.81984973 -1.17978148]
mat_Sqrt:  [[13.08900616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364366 -0.03725563  0.19354319]
Stock Position:  -0.00364365739110145
Bond Position:  [8.96443742]


portfolio before change:  [8.61232923]
curr_Stock_Price:  97.8663718284909
curr_Factors:  [97.86637183 -0.72605619 -1.27357983]
mat_Sqrt:  [[13.24959479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00676298  0.00846424 -0.12798114]
Stock Position:  -0.006762978915385851
Bond Position:  [9.27419744]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.611894]
Stock Price:  98.61655676987554
PL:  [8.611894]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.89656218e-01 -1.82914374e-01 -7.06356134e-02]
 [ 2.15959362e-02  6.54762831e-02 -2.49361230e-02]
 [-8.51775746e-02  3.45180471e-01  4.41244809e-01]
 [ 1.05868513e-01  2.68134778e-02  1.27363178e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 1.53641258e-02  3.41675458e-02 -4.34918088e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 1.97450698e-02  2.38586691e-02 -5.60982243e-02]
 [-1.43685425e-02  8.21914051e-02 -2.60119601e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.98417927]
curr_Stock_Price:  99.5699632571495
curr_Factors:  [99.56996326 -1.19938575 -1.04896749]
mat_Sqrt:  [[10.51189316  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0800438  -0.05903536 -0.20150374]
Stock Position:  -0.08004380177359305
Bond Position:  [6.98577913]


portfolio before change:  [-0.89143634]
curr_Stock_Price:  98.45495908218986
curr_Factors:  [98.45495908 -1.06969596 -1.04145121]
mat_Sqrt:  [[11.92279366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00250538  0.02113238 -0.07113582]
Stock Position:  0.0025053827637167947
Bond Position:  [-1.1381037]


portfolio before change:  [-0.88695803]
curr_Stock_Price:  100.46962392041183
curr_Factors:  [100.46962392  -0.91411778  -1.11289833]
mat_Sqrt:  [[13.23466225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00569344 0.11140652 1.25874862]
Stock Position:  0.005693444386099553
Bond Position:  [-1.45897624]


portfolio before change:  [-0.882721]
curr_Stock_Price:  101.34197772372139
curr_Factors:  [101.34197772  -1.54507767  -1.15882803]
mat_Sqrt:  [[ 6.78419074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01679516 0.00865401 0.03633317]
Stock Position:  0.016795161754435635
Bond Position:  [-2.58477591]


portfolio before change:  [-0.88694705]
curr_Stock_Price:  101.16732353787684
curr_Factors:  [101.16732354  -1.56805429  -1.15206405]
mat_Sqrt:  [[ 6.66358396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00875224 -0.00140152  0.08089603]
Stock Position:  0.008752241404532029
Bond Position:  [-1.77238789]


portfolio before change:  [-0.88737188]
curr_Stock_Price:  101.22006333084249
curr_Factors:  [101.22006333  -1.41900528  -1.16636975]
mat_Sqrt:  [[ 7.62873442  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00176449  0.01102753 -0.12407002]
Stock Position:  0.0017644890850817135
Bond Position:  [-1.06597358]


portfolio before change:  [-0.88582654]
curr_Stock_Price:  102.39800176971168
curr_Factors:  [102.39800177  -1.16769744  -1.24463097]
mat_Sqrt:  [[ 9.17551748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00523122 -0.01197701  0.13962421]
Stock Position:  -0.005231219837844296
Bond Position:  [-0.35016008]


portfolio before change:  [-0.88918521]
curr_Stock_Price:  103.00656911954043
curr_Factors:  [103.00656912  -1.10277355  -1.31364783]
mat_Sqrt:  [[ 9.19234788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00143208  0.00770035 -0.16003262]
Stock Position:  0.0014320822438876324
Bond Position:  [-1.03669909]


portfolio before change:  [-0.89175915]
curr_Stock_Price:  101.5712752738249
curr_Factors:  [101.57127527  -0.60963899  -1.277878  ]
mat_Sqrt:  [[15.38270442  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018859  0.02652716 -0.07420488]
Stock Position:  -0.00018858591227890388
Bond Position:  [-0.87260424]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.89201975]
Stock Price:  100.63903186001502
PL:  [-1.53105161]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.14969176e+00 -2.95160726e-01 -2.13842889e-02]
 [ 3.95453160e-02  5.13884296e-02  1.85619997e-02]
 [-1.26164523e-01  6.52854226e-01  6.97413881e-01]
 [ 1.23050385e-01  3.64819373e-02  1.78757677e-02]
 [-4.94856442e-02 -9.41342968e-02 -2.41575040e-02]
 [ 7.66677946e-02 -9.76816174e-03 -4.91874810e-02]
 [-3.26725446e-02 -8.39355986e-03 -1.26708101e-02]
 [-4.33143899e-05 -3.77721642e-03 -2.87472741e-02]
 [ 3.65762653e-01 -1.40766537e-02  1.12528029e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.0977091]
curr_Stock_Price:  100.26351773607057
curr_Factors:  [100.26351774  -0.63279367  -1.02458126]
mat_Sqrt:  [[19.11411302  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0635293  -0.09526271 -0.06100342]
Stock Position:  -0.06352930097089655
Bond Position:  [10.4673803]


portfolio before change:  [4.1822357]
curr_Stock_Price:  99.01540712822992
curr_Factors:  [99.01540713 -0.50057178 -1.01846555]
mat_Sqrt:  [[21.67670415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00248303 0.01658554 0.05295222]
Stock Position:  0.0024830291189195212
Bond Position:  [3.93637756]


portfolio before change:  [4.19662153]
curr_Stock_Price:  104.01621725057666
curr_Factors:  [104.01621725  -0.95671093  -0.94720666]
mat_Sqrt:  [[15.49673306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00964447 0.2107078  1.98952768]
Stock Position:  0.009644471514103395
Bond Position:  [3.19344009]


portfolio before change:  [4.21930296]
curr_Stock_Price:  106.20237226850713
curr_Factors:  [106.20237227  -1.12935782  -0.93375394]
mat_Sqrt:  [[13.49385892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00994127 0.01177449 0.05099459]
Stock Position:  0.009941270766050678
Bond Position:  [3.16351642]


portfolio before change:  [4.23659367]
curr_Stock_Price:  107.78250765589993
curr_Factors:  [107.78250766  -1.53657341  -0.90939516]
mat_Sqrt:  [[ 9.33851095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00788475 -0.03038171 -0.06891463]
Stock Position:  -0.007884753497986823
Bond Position:  [5.08643217]


portfolio before change:  [4.24582476]
curr_Stock_Price:  106.93438456022923
curr_Factors:  [106.93438456  -1.37209248  -0.90571983]
mat_Sqrt:  [[10.96165321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00589633 -0.00315266 -0.14031819]
Stock Position:  0.005896329976703557
Bond Position:  [3.61530435]


portfolio before change:  [4.257698]
curr_Stock_Price:  108.6414013508784
curr_Factors:  [108.64140135  -1.28149377  -0.9280029 ]
mat_Sqrt:  [[11.92403242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310065 -0.00270901 -0.03614629]
Stock Position:  -0.0031006533578879646
Bond Position:  [4.59455733]


portfolio before change:  [4.25858962]
curr_Stock_Price:  109.09493125188565
curr_Factors:  [109.09493125  -1.25820052  -0.97458476]
mat_Sqrt:  [[11.69817867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057123 -0.00121909 -0.08200797]
Stock Position:  -0.000571229795586084
Bond Position:  [4.32090789]


portfolio before change:  [4.26071496]
curr_Stock_Price:  109.1573316390871
curr_Factors:  [109.15733164  -1.43157865  -0.97459659]
mat_Sqrt:  [[ 9.84156764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03920706 -0.00454322  0.32101115]
Stock Position:  0.03920706237474064
Bond Position:  [-0.01902335]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.26620508]
Stock Price:  109.29760293352442
PL:  [-5.03139786]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.18135356e-01 -1.56747765e-01 -4.48556364e-02]
 [ 3.13807567e-02  5.62176632e-02 -2.02607473e-02]
 [-4.90230049e-02  2.46481261e-01  2.36884694e-01]
 [ 2.77452919e-01  2.34378972e-01  3.29701477e-01]
 [ 1.81117606e-02 -9.05078831e-02  1.60161859e-01]
 [-6.15523202e-02  1.15140127e-01 -3.74720177e-02]
 [ 2.20632539e-01  5.01283524e-01  2.60552090e-01]
 [-4.15108369e-02 -1.26046279e-01  4.08976391e-04]
 [ 3.05240671e-02 -4.13803635e-01 -1.67267160e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.9512576]
curr_Stock_Price:  98.48265034334264
curr_Factors:  [98.48265034 -1.02268299 -0.97818348]
mat_Sqrt:  [[13.3166339   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05701797 -0.05059012 -0.12796065]
Stock Position:  -0.057017973453380444
Bond Position:  [-3.33597646]


portfolio before change:  [-8.90574461]
curr_Stock_Price:  97.65516740928118
curr_Factors:  [97.65516741 -0.83212684 -0.98606871]
mat_Sqrt:  [[15.85122873  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00244274  0.01814417 -0.05779827]
Stock Position:  0.0024427400583848665
Bond Position:  [-9.1442908]


portfolio before change:  [-8.9148321]
curr_Stock_Price:  95.80715989498903
curr_Factors:  [95.80715989 -1.02505848 -0.96507513]
mat_Sqrt:  [[13.09465075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00379114 0.07955149 0.6757661 ]
Stock Position:  0.003791140248724759
Bond Position:  [-9.27805048]


portfolio before change:  [-8.92604073]
curr_Stock_Price:  94.07458210880206
curr_Factors:  [94.07458211 -0.56658591 -0.93337351]
mat_Sqrt:  [[20.99172835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01870238 0.07564549 0.94054654]
Stock Position:  0.018702383720709356
Bond Position:  [-10.68545966]


portfolio before change:  [-8.96775578]
curr_Stock_Price:  92.12985769362751
curr_Factors:  [92.12985769 -0.59290337 -0.90972508]
mat_Sqrt:  [[20.50298786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00157683 -0.02921129  0.4568972 ]
Stock Position:  0.0015768345101223845
Bond Position:  [-9.11302931]


portfolio before change:  [-8.9729487]
curr_Stock_Price:  91.7269819426474
curr_Factors:  [91.72698194 -0.8137435  -0.82517445]
mat_Sqrt:  [[17.81246743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00256553  0.03716132 -0.10689724]
Stock Position:  -0.0025655279934023835
Bond Position:  [-8.73762056]


portfolio before change:  [-8.97418694]
curr_Stock_Price:  90.50631321245963
curr_Factors:  [90.50631321 -0.84155839 -0.88711608]
mat_Sqrt:  [[16.06664111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02341134 0.16178856 0.74328259]
Stock Position:  0.023411339048885437
Bond Position:  [-11.09306092]


portfolio before change:  [-8.99050348]
curr_Stock_Price:  90.04633853830329
curr_Factors:  [90.04633854 -0.41414355 -0.8939121 ]
mat_Sqrt:  [[24.3435947   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275869 -0.04068126  0.0011667 ]
Stock Position:  -0.0027586905187229893
Bond Position:  [-8.7420935]


portfolio before change:  [-8.99110486]
curr_Stock_Price:  88.6794721349613
curr_Factors:  [88.67947213 -0.44823429 -0.88686808]
mat_Sqrt:  [[23.33433922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377497 -0.13355455 -0.47716665]
Stock Position:  -0.003774973496037152
Bond Position:  [-8.6563422]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.9976648]
Stock Price:  89.27038571664163
PL:  [-8.9976648]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.92627002e-01 -1.91246341e-01 -3.35692645e-02]
 [-9.03122811e-04  1.16667092e-01  1.04355103e-01]
 [-9.22662978e-02  4.27693032e-01  5.13113173e-01]
 [ 2.14580054e-01  1.43568577e-01  1.77859092e-01]
 [ 5.07956668e-02  1.26739910e-03  5.01194938e-02]
 [-4.98542472e-02  2.96286190e-02 -2.05080989e-02]
 [ 8.29954285e-02  2.67004819e-01  1.65715933e-01]
 [-4.13906123e-02 -1.27425307e-01  1.79281356e-03]
 [ 5.77399565e-02 -3.80963413e-01 -2.15246832e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.25826039]
curr_Stock_Price:  98.71370339059429
curr_Factors:  [98.71370339 -0.81964935 -1.00685459]
mat_Sqrt:  [[15.8904745   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05276855 -0.06172449 -0.09576377]
Stock Position:  -0.052768549828488706
Bond Position:  [-2.04928142]


portfolio before change:  [-7.35213579]
curr_Stock_Price:  100.47328366825305
curr_Factors:  [100.47328367  -0.74572685  -1.03673387]
mat_Sqrt:  [[16.90198601  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00261584 0.03765414 0.29769606]
Stock Position:  0.002615837205462705
Bond Position:  [-7.61495754]


portfolio before change:  [-7.35727366]
curr_Stock_Price:  99.96505835939227
curr_Factors:  [99.96505836 -0.60695698 -0.9855865 ]
mat_Sqrt:  [[20.33365163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00490689 0.13803733 1.46376906]
Stock Position:  0.004906888659958606
Bond Position:  [-7.84779107]


portfolio before change:  [-7.3759987]
curr_Stock_Price:  96.9488563639813
curr_Factors:  [96.94885636 -0.23852048 -0.98403652]
mat_Sqrt:  [[28.54913328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00981435 0.04633656 0.50738248]
Stock Position:  0.009814350546668876
Bond Position:  [-8.32748876]


portfolio before change:  [-7.38617653]
curr_Stock_Price:  96.33617753489035
curr_Factors:  [96.33617753 -0.37832833 -0.99571871]
mat_Sqrt:  [[24.38082293  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00251365 0.00040905 0.14297697]
Stock Position:  0.0025136547923457703
Bond Position:  [-7.62833243]


portfolio before change:  [-7.3975065]
curr_Stock_Price:  93.34656560106744
curr_Factors:  [93.3465656  -0.76576262 -0.94721907]
mat_Sqrt:  [[16.83293507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00285111  0.0095626  -0.0585039 ]
Stock Position:  -0.002851108772374831
Bond Position:  [-7.13136529]


portfolio before change:  [-7.40634079]
curr_Stock_Price:  95.19416658780278
curr_Factors:  [ 9.51941666e+01 -9.15024838e-02 -9.96185003e-01]
mat_Sqrt:  [[32.07994849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00534054 0.08617543 0.47274143]
Stock Position:  0.005340537945572458
Bond Position:  [-7.91472885]


portfolio before change:  [-7.43891905]
curr_Stock_Price:  89.83517261182301
curr_Factors:  [89.83517261 -0.62906178 -0.95853607]
mat_Sqrt:  [[18.36375207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365041 -0.04112634  0.0051144 ]
Stock Position:  -0.003650410728028341
Bond Position:  [-7.11098378]


portfolio before change:  [-7.44218324]
curr_Stock_Price:  89.75512939165884
curr_Factors:  [89.75512939 -1.22207365 -0.98071587]
mat_Sqrt:  [[ 9.91744829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00644934 -0.12295541 -0.6140393 ]
Stock Position:  -0.0064493353768790744
Bond Position:  [-6.86332231]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.4496018]
Stock Price:  90.3731828396642
PL:  [-7.4496018]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.00615846e+00 -2.58777480e-01 -3.05202527e-02]
 [-2.00569521e-02  1.60124273e-01  2.16281780e-01]
 [-1.07595589e-01  5.08759794e-01  5.68599251e-01]
 [ 1.05977132e-01  2.68745993e-02  1.27688081e-02]
 [ 5.19469111e-02  5.14439515e-03  2.79331847e-02]
 [-5.25694914e-02 -1.18462904e-02 -1.04374085e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-3.78162644e-03 -2.84680918e-02 -1.04568149e-02]
 [-5.03527874e-02  6.26576067e-02 -3.90125299e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.95237741]
curr_Stock_Price:  99.8342562646262
curr_Factors:  [99.83425626 -0.79830263 -0.95746748]
mat_Sqrt:  [[17.24877745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06175575 -0.08352007 -0.08706579]
Stock Position:  -0.06175574560247763
Bond Position:  [7.11771634]


portfolio before change:  [0.83951572]
curr_Stock_Price:  101.71944826738572
curr_Factors:  [101.71944827  -0.8429424   -1.01381289]
mat_Sqrt:  [[15.88639725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00357391 0.05167989 0.61699172]
Stock Position:  0.003573913636284307
Bond Position:  [0.4759792]


portfolio before change:  [0.84475521]
curr_Stock_Price:  103.11887657367255
curr_Factors:  [103.11887657  -1.15158011  -1.05615916]
mat_Sqrt:  [[11.33781049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00990662 0.16420152 1.62205539]
Stock Position:  0.009906622242358202
Bond Position:  [-0.17680455]


portfolio before change:  [0.82754553]
curr_Stock_Price:  101.39061335406576
curr_Factors:  [101.39061335  -1.20147032  -1.07670157]
mat_Sqrt:  [[10.38963444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01097915 0.00867374 0.03642586]
Stock Position:  0.010979145543106562
Bond Position:  [-0.28563677]


portfolio before change:  [0.81793891]
curr_Stock_Price:  100.52863694891704
curr_Factors:  [100.52863695  -1.10454579  -1.03483293]
mat_Sqrt:  [[11.83503162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00495975 0.00166035 0.0796856 ]
Stock Position:  0.004959753863377866
Bond Position:  [0.31934162]


portfolio before change:  [0.81374935]
curr_Stock_Price:  99.65172437470731
curr_Factors:  [99.65172437 -1.20081105 -1.05876299]
mat_Sqrt:  [[10.40313613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00549047 -0.00382337 -0.02977502]
Stock Position:  -0.005490472456133366
Bond Position:  [1.3608844]


portfolio before change:  [0.80772272]
curr_Stock_Price:  100.87333948760335
curr_Factors:  [100.87333949  -0.75859278  -1.01365562]
mat_Sqrt:  [[17.1434687   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279985 -0.01197701  0.13962421]
Stock Position:  -0.0027998504794629403
Bond Position:  [1.09015299]


portfolio before change:  [0.80598958]
curr_Stock_Price:  101.68708172677037
curr_Factors:  [101.68708173  -0.47549069  -1.02250057]
mat_Sqrt:  [[22.73507775  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051582 -0.00918804 -0.02983038]
Stock Position:  -0.0005158170063757551
Bond Position:  [0.8584415]


portfolio before change:  [0.80773284]
curr_Stock_Price:  99.13979410466854
curr_Factors:  [99.1397941  -0.55852782 -0.96643649]
mat_Sqrt:  [[21.57567687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00211007  0.02022266 -0.11129189]
Stock Position:  -0.0021100731456094655
Bond Position:  [1.01692506]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.8189643]
Stock Price:  94.0580409735082
PL:  [0.8189643]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.24785077e+00 -3.04544467e-01 -4.77669737e-02]
 [-2.13879892e-03  1.19504819e-01  1.11057121e-01]
 [-9.30794871e-02  4.81515340e-01  5.43690252e-01]
 [ 1.03563996e-01  2.55166969e-02  1.20469897e-02]
 [-7.93903568e-06 -6.50488776e-02 -5.82355870e-02]
 [ 8.03338250e-02 -1.95045763e-02 -4.78075759e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-1.65545939e-03 -2.86220310e-02 -1.12903465e-02]
 [-5.26180695e-02  6.70473754e-02 -3.39398304e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.66284215]
curr_Stock_Price:  101.15949912948246
curr_Factors:  [101.15949913  -0.88694841  -1.03540993]
mat_Sqrt:  [[14.79575226  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08919898 -0.0982913  -0.13626588]
Stock Position:  -0.0891989823228254
Bond Position:  [19.68616652]


portfolio before change:  [10.72536158]
curr_Stock_Price:  100.5689779183628
curr_Factors:  [100.56897792  -0.71026984  -1.03607122]
mat_Sqrt:  [[17.54032956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00256121 0.03857001 0.31681506]
Stock Position:  0.0025612095804857854
Bond Position:  [10.46778335]


portfolio before change:  [10.72659829]
curr_Stock_Price:  99.00780324562781
curr_Factors:  [99.00780325 -0.15368299 -0.9893095 ]
mat_Sqrt:  [[31.56996457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00368039 0.15540841 1.55099696]
Stock Position:  0.0036803882941778576
Bond Position:  [10.36221113]


portfolio before change:  [10.73645328]
curr_Stock_Price:  100.27739622403026
curr_Factors:  [100.27739622  -0.22175743  -1.05112276]
mat_Sqrt:  [[28.08007109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00396123 0.00823548 0.03436671]
Stock Position:  0.003961231122537171
Bond Position:  [10.33923134]


portfolio before change:  [10.7452575]
curr_Stock_Price:  101.19461325300145
curr_Factors:  [101.19461325   0.34519037  -1.03633353]
mat_Sqrt:  [[50.69880637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049653 -0.02099443 -0.16612992]
Stock Position:  -0.0004965259894598654
Bond Position:  [10.79550326]


portfolio before change:  [10.74727401]
curr_Stock_Price:  108.00711982276975
curr_Factors:  [ 1.08007120e+02 -6.07756104e-02 -1.02096013e+00]
mat_Sqrt:  [[36.61512513  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00181875 -0.00629507 -0.13638171]
Stock Position:  0.001818750836070971
Bond Position:  [10.55083598]


portfolio before change:  [10.74314652]
curr_Stock_Price:  102.8364079464472
curr_Factors:  [ 1.02836408e+02 -3.00202937e-02 -9.88297250e-01]
mat_Sqrt:  [[37.14473023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129222 -0.01197701  0.13962421]
Stock Position:  -0.0012922196167044048
Bond Position:  [10.87603374]


portfolio before change:  [10.74965653]
curr_Stock_Price:  102.00787777346162
curr_Factors:  [ 1.02007878e+02 -4.75465747e-02 -9.63047316e-01]
mat_Sqrt:  [[37.13114675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.000264   -0.00923772 -0.03220822]
Stock Position:  -0.0002639977536366972
Bond Position:  [10.77658639]


portfolio before change:  [10.75514465]
curr_Stock_Price:  101.63485896435732
curr_Factors:  [101.63485896  -0.2316738   -0.96927477]
mat_Sqrt:  [[30.58280765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149954  0.02163945 -0.09682089]
Stock Position:  -0.0014995359727585868
Bond Position:  [10.90754978]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.75759376]
Stock Price:  103.63950048579994
PL:  [7.11809327]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.06099803e+00 -2.87024405e-01  3.17562592e-03]
 [-1.21439390e-02  1.42383178e-01  1.66817138e-01]
 [-1.03125525e-01  4.57622505e-01  5.78400939e-01]
 [ 1.15986861e-01  3.25072018e-02  1.57629229e-02]
 [-6.64509071e-03 -7.25903171e-02 -6.89928717e-02]
 [ 7.09708955e-02 -1.25723866e-02 -4.73666113e-02]
 [-3.48704522e-02 -1.07951881e-02 -8.72532853e-04]
 [-2.90316316e-04 -5.64547728e-03 -2.73791164e-02]
 [ 3.95426081e-01 -1.35845728e-02  1.18806734e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.43538002]
curr_Stock_Price:  99.37190956016688
curr_Factors:  [99.37190956 -0.3684259  -0.97654018]
mat_Sqrt:  [[25.89120643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04321693 -0.09263673  0.00905918]
Stock Position:  -0.04321692855405977
Bond Position:  [1.85916869]


portfolio before change:  [-2.51768826]
curr_Stock_Price:  101.29796159726261
curr_Factors:  [101.2979616   -0.54446308  -1.03779175]
mat_Sqrt:  [[20.81786381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00244844 0.04595397 0.47588286]
Stock Position:  0.0024484409945110105
Bond Position:  [-2.76571034]


portfolio before change:  [-2.51872742]
curr_Stock_Price:  101.43847623848032
curr_Factors:  [101.43847624  -0.65238866  -1.08955731]
mat_Sqrt:  [[17.76990859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00609749 0.14769703 1.65001688]
Stock Position:  0.006097491939563087
Bond Position:  [-3.13724771]


portfolio before change:  [-2.50060017]
curr_Stock_Price:  104.66870067381414
curr_Factors:  [104.66870067  -0.62589061  -1.09944794]
mat_Sqrt:  [[18.64282912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00675005 0.01049165 0.04496723]
Stock Position:  0.006750046246389253
Bond Position:  [-3.20711874]


portfolio before change:  [-2.48836713]
curr_Stock_Price:  106.71861247841267
curr_Factors:  [106.71861248  -0.90884039  -1.08816968]
mat_Sqrt:  [[14.48604115  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245379 -0.02342842 -0.19681746]
Stock Position:  -0.0024537855268252228
Bond Position:  [-2.22650254]


portfolio before change:  [-2.48974216]
curr_Stock_Price:  106.82518250707217
curr_Factors:  [106.82518251  -0.70689913  -1.13474608]
mat_Sqrt:  [[16.93781129  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00346774 -0.00405772 -0.13512376]
Stock Position:  0.0034677384082923827
Bond Position:  [-2.86018395]


portfolio before change:  [-2.48182882]
curr_Stock_Price:  109.51967263625225
curr_Factors:  [109.51967264  -0.65183182  -1.19206724]
mat_Sqrt:  [[17.3259457   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215008 -0.00348413 -0.00248909]
Stock Position:  -0.0021500769112930635
Bond Position:  [-2.2463531]


portfolio before change:  [-2.48345421]
curr_Stock_Price:  109.75311978239887
curr_Factors:  [109.75311978  -1.14030886  -1.18043139]
mat_Sqrt:  [[10.77785135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006524  -0.00182207 -0.078105  ]
Stock Position:  -0.000652396571595834
Bond Position:  [-2.41185165]


portfolio before change:  [-2.48433151]
curr_Stock_Price:  109.24894640411594
curr_Factors:  [109.2489464   -1.55590158  -1.15490225]
mat_Sqrt:  [[ 7.26323532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05739928 -0.0043844   0.33892254]
Stock Position:  0.057399278233431994
Bond Position:  [-8.75514219]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.40274726]
Stock Price:  110.74657715186812
PL:  [-13.14932441]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.50726156e+00 -3.19333187e-01 -1.38566526e-01]
 [-6.63373620e-02  1.98323593e-01  4.03663471e-01]
 [-1.04640510e-01  4.90236444e-01  5.34750612e-01]
 [ 1.07093939e-01  2.75030408e-02  1.31028679e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [-9.40143901e-03  2.44090539e-02 -3.12460383e-02]
 [-5.04383739e-02 -2.62445041e-02  4.99890134e-02]
 [-3.22668963e-02 -7.38580092e-02  3.26948499e-02]
 [ 5.52730877e-02  1.24204906e-01 -3.68297192e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.92263412]
curr_Stock_Price:  103.242090538629
curr_Factors:  [103.24209054  -1.25557412  -1.01644562]
mat_Sqrt:  [[10.64464424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.1503789  -0.10306434 -0.39529173]
Stock Position:  -0.15037890479592123
Bond Position:  [41.44806663]


portfolio before change:  [25.97450013]
curr_Stock_Price:  103.03503499446728
curr_Factors:  [103.03503499  -1.10740137  -1.02743375]
mat_Sqrt:  [[12.18534445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00464022 0.06400866 1.15153953]
Stock Position:  0.004640224428125616
Bond Position:  [25.49639444]


portfolio before change:  [25.98916122]
curr_Stock_Price:  103.44658942285545
curr_Factors:  [103.44658942  -1.32824848  -1.08850222]
mat_Sqrt:  [[ 9.22857584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01133264 0.15822313 1.52549465]
Stock Position:  0.011332636659869465
Bond Position:  [24.8168386]


portfolio before change:  [25.98418376]
curr_Stock_Price:  101.91217399206457
curr_Factors:  [101.91217399  -1.50726264  -1.04598487]
mat_Sqrt:  [[ 7.93167227  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01454707 0.00887657 0.03737883]
Stock Position:  0.014547069182275559
Bond Position:  [24.50166032]


portfolio before change:  [25.98999849]
curr_Stock_Price:  101.46953064052376
curr_Factors:  [101.46953064  -1.21612671  -1.0593716 ]
mat_Sqrt:  [[10.42555751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00559407 -0.00140152  0.08089603]
Stock Position:  0.005594069708397642
Bond Position:  [25.42237087]


portfolio before change:  [25.99577947]
curr_Stock_Price:  100.23011322416272
curr_Factors:  [100.23011322  -1.38831319  -1.06136826]
mat_Sqrt:  [[ 8.65197157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124793  0.00787799 -0.08913625]
Stock Position:  -0.0012479274258827852
Bond Position:  [26.12085938]


portfolio before change:  [26.00990452]
curr_Stock_Price:  99.37962188910505
curr_Factors:  [99.37962189 -1.69332784 -1.01807838]
mat_Sqrt:  [[ 6.60311072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00690456 -0.00847038  0.14260474]
Stock Position:  -0.006904555766868956
Bond Position:  [26.69607666]


portfolio before change:  [26.02431954]
curr_Stock_Price:  99.22557204001316
curr_Factors:  [99.22557204 -1.69563676 -0.99461357]
mat_Sqrt:  [[ 6.73383918  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00603954 -0.02383757  0.09326931]
Stock Position:  -0.006039539994640869
Bond Position:  [26.62359635]


portfolio before change:  [26.03496665]
curr_Stock_Price:  99.6673304575184
curr_Factors:  [99.66733046 -1.57643866 -0.99472672]
mat_Sqrt:  [[ 7.61920907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00959528  0.04008696 -0.10506494]
Stock Position:  0.009595283756062212
Bond Position:  [25.07863033]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [26.04094602]
Stock Price:  98.98334075514086
PL:  [26.04094602]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.20587946e+00 -2.86889114e-01 -6.52112508e-02]
 [-1.12189708e-01  2.20270942e-01  5.70583552e-01]
 [-1.04881655e-01  5.00186532e-01  5.26777073e-01]
 [ 1.15353199e-01  3.21506323e-02  1.55733818e-02]
 [ 3.67085941e-02 -2.33298505e-02  1.27340435e-03]
 [ 6.41009919e-02 -2.37271729e-03 -4.74491059e-02]
 [-4.44000436e-02 -2.62454574e-02  3.21251653e-02]
 [ 9.48963821e-05  2.01791424e-03 -3.27143142e-02]
 [ 2.82741426e-01  1.85691567e-02  7.50579189e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.67006568]
curr_Stock_Price:  101.43343644680233
curr_Factors:  [101.43343645  -1.19945423  -1.00799342]
mat_Sqrt:  [[11.15575075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11453749 -0.09259306 -0.18602955]
Stock Position:  -0.11453748626377667
Bond Position:  [24.28799651]


portfolio before change:  [12.359902]
curr_Stock_Price:  104.2474558351787
curr_Factors:  [104.24745584  -1.34556393  -1.00692107]
mat_Sqrt:  [[ 9.91731731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00496533 0.07109214 1.62771605]
Stock Position:  0.004965333666826106
Bond Position:  [11.8422786]


portfolio before change:  [12.36380584]
curr_Stock_Price:  103.84088057280263
curr_Factors:  [103.84088057  -1.59685254  -1.01063794]
mat_Sqrt:  [[ 7.65507822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01368326 0.16143451 1.50274836]
Stock Position:  0.013683258290081232
Bond Position:  [10.94292425]


portfolio before change:  [12.38113262]
curr_Stock_Price:  104.7071908791779
curr_Factors:  [104.70719088  -1.42087841  -0.98912779]
mat_Sqrt:  [[ 9.40424884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01330195 0.01037657 0.04442652]
Stock Position:  0.01330194733812463
Bond Position:  [10.98832308]


portfolio before change:  [12.38309099]
curr_Stock_Price:  104.44127758352293
curr_Factors:  [104.44127758  -1.29891304  -0.9346301 ]
mat_Sqrt:  [[11.19068614  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00287796 -0.00752968  0.00363267]
Stock Position:  0.002877959444115995
Bond Position:  [12.08251323]


portfolio before change:  [12.39400461]
curr_Stock_Price:  106.13374598666756
curr_Factors:  [106.13374599  -0.74499304  -0.90343332]
mat_Sqrt:  [[20.41507705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00264173 -0.00076579 -0.13535909]
Stock Position:  0.0026417316303516338
Bond Position:  [12.11362774]


portfolio before change:  [12.40152946]
curr_Stock_Price:  106.6888825701309
curr_Factors:  [106.68888257  -1.05876895  -0.94424887]
mat_Sqrt:  [[14.39526219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300098 -0.00847068  0.09164415]
Stock Position:  -0.0030009771720489625
Bond Position:  [12.72170036]


portfolio before change:  [12.40526868]
curr_Stock_Price:  107.56300451178993
curr_Factors:  [107.56300451  -1.21129758  -0.98034323]
mat_Sqrt:  [[12.01836573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051346  0.00065128 -0.09332483]
Stock Position:  -0.0005134624919132845
Bond Position:  [12.46049825]


portfolio before change:  [12.4119005]
curr_Stock_Price:  106.78395837438865
curr_Factors:  [106.78395837  -1.44977821  -0.98291503]
mat_Sqrt:  [[ 9.37563652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03219546 0.00599317 0.21411935]
Stock Position:  0.03219546453988687
Bond Position:  [8.97394136]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.45272822]
Stock Price:  107.91267727775436
PL:  [4.54005095]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.42485459e-01 -1.55160315e-01 -7.83723582e-02]
 [ 3.38999914e-03  1.06614259e-01  8.40112542e-02]
 [-8.52316387e-02  3.98911978e-01  4.68528675e-01]
 [ 1.24368809e-01  5.03892389e-02  4.96797030e-02]
 [ 4.75124649e-02  3.13990192e-02  3.12771357e-02]
 [-1.07337997e-01 -6.22253053e-02  1.67179742e-02]
 [ 1.28637372e-02  1.01828090e-01  5.77607924e-02]
 [-3.89844687e-02 -1.07851745e-01  4.76418411e-02]
 [-4.79265391e-02 -9.77214130e-03 -6.79661693e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.14863503]
curr_Stock_Price:  99.41104329522256
curr_Factors:  [99.4110433  -1.47058664 -0.92065896]
mat_Sqrt:  [[ 9.0976634   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08685253 -0.05007778 -0.22357452]
Stock Position:  -0.08685253363511841
Bond Position:  [6.48546595]


portfolio before change:  [-2.20339204]
curr_Stock_Price:  100.0788481861528
curr_Factors:  [100.07884819  -1.09053329  -0.90177364]
mat_Sqrt:  [[13.64879752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00309927 0.0344096  0.23966072]
Stock Position:  0.003099267103086176
Bond Position:  [-2.51356312]


portfolio before change:  [-2.20641402]
curr_Stock_Price:  99.50939321439792
curr_Factors:  [99.50939321 -0.86609826 -0.87016768]
mat_Sqrt:  [[17.53126916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00523829 0.12874829 1.3365819 ]
Stock Position:  0.005238294057260255
Bond Position:  [-2.72767349]


portfolio before change:  [-2.21072]
curr_Stock_Price:  98.94779814131613
curr_Factors:  [98.94779814 -0.63731318 -0.94941004]
mat_Sqrt:  [[20.24421762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00715243 0.01626306 0.14172236]
Stock Position:  0.007152427352403905
Bond Position:  [-2.91843694]


portfolio before change:  [-2.2223141]
curr_Stock_Price:  97.53086512064093
curr_Factors:  [97.53086512 -0.4708039  -0.93832879]
mat_Sqrt:  [[23.83216657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00253045 0.01013399 0.08922496]
Stock Position:  0.0025304531718162754
Bond Position:  [-2.46911138]


portfolio before change:  [-2.22692929]
curr_Stock_Price:  96.195005822011
curr_Factors:  [96.19500582 -0.56208918 -0.90425534]
mat_Sqrt:  [[22.19868205  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00525379 -0.02008313  0.04769173]
Stock Position:  -0.005253786781936219
Bond Position:  [-1.72154124]


portfolio before change:  [-2.22568732]
curr_Stock_Price:  95.79473201851805
curr_Factors:  [95.79473202 -1.26732468 -0.91415876]
mat_Sqrt:  [[10.81273112  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00420242 0.03286487 0.16477546]
Stock Position:  0.004202424066458945
Bond Position:  [-2.62825741]


portfolio before change:  [-2.22679353]
curr_Stock_Price:  95.84428783910802
curr_Factors:  [95.84428784 -1.15951583 -0.9416793 ]
mat_Sqrt:  [[11.72273067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00437396 -0.034809    0.13590891]
Stock Position:  -0.004373960745348098
Bond Position:  [-1.80757437]


portfolio before change:  [-2.23188103]
curr_Stock_Price:  96.80074162269591
curr_Factors:  [96.80074162 -0.73756365 -1.00161304]
mat_Sqrt:  [[17.00449913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00375164 -0.00315395 -0.19388856]
Stock Position:  -0.003751642714924006
Bond Position:  [-1.86871923]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.23248557]
Stock Price:  96.71276484402962
PL:  [-2.23248557]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-5.60357107e-01 -8.29600890e-02 -8.42322597e-02]
 [ 2.61160359e-02  6.03665674e-02 -3.91080368e-02]
 [-5.56526267e-02  2.63966919e-01  2.74049491e-01]
 [ 1.93914065e-01  1.27554208e-01  1.61369163e-01]
 [ 5.02283369e-02  9.41161582e-03  4.10071644e-02]
 [-9.69429307e-02 -5.25379932e-02  1.16159570e-02]
 [-4.69560424e-02  1.49062962e-03  5.09270031e-02]
 [-3.84509521e-02 -1.01150900e-01  5.72720932e-02]
 [ 6.70952529e-02  6.90539500e-02  1.29411675e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.78307468]
curr_Stock_Price:  98.36912749102598
curr_Factors:  [98.36912749 -1.5573718  -0.97822254]
mat_Sqrt:  [[ 7.79227355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07629161 -0.02677525 -0.24029119]
Stock Position:  -0.07629161105284991
Bond Position:  [-2.27833547]


portfolio before change:  [-9.67113327]
curr_Stock_Price:  96.88690859693168
curr_Factors:  [96.8869086  -1.02436582 -0.89247415]
mat_Sqrt:  [[14.24925224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213733  0.01948323 -0.11156434]
Stock Position:  0.0021373342794430233
Bond Position:  [-9.87821298]


portfolio before change:  [-9.67441118]
curr_Stock_Price:  97.6647159351121
curr_Factors:  [97.66471594 -1.35159876 -0.87182125]
mat_Sqrt:  [[10.57106282  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00512432 0.08519496 0.78178692]
Stock Position:  0.005124320428502155
Bond Position:  [-10.17487647]


portfolio before change:  [-9.68407864]
curr_Stock_Price:  96.77118129915445
curr_Factors:  [96.7711813  -1.00459167 -0.93875714]
mat_Sqrt:  [[13.85990889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01824617 0.04116794 0.46034131]
Stock Position:  0.018246173452592482
Bond Position:  [-11.4497824]


portfolio before change:  [-9.67164819]
curr_Stock_Price:  97.76628182757136
curr_Factors:  [97.76628183 -0.93463815 -0.99227419]
mat_Sqrt:  [[14.23448305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00425165 0.00303759 0.11698203]
Stock Position:  0.004251649116640937
Bond Position:  [-10.08731612]


portfolio before change:  [-9.67532498]
curr_Stock_Price:  98.08806963116267
curr_Factors:  [98.08806963 -0.98694648 -0.94187561]
mat_Sqrt:  [[14.25408672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00738708 -0.01695656  0.03313709]
Stock Position:  -0.00738708192573591
Bond Position:  [-8.95074037]


portfolio before change:  [-9.68613289]
curr_Stock_Price:  98.9451636551129
curr_Factors:  [98.94516366 -1.22191362 -0.89119838]
mat_Sqrt:  [[11.95863726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303181  0.0004811   0.14528056]
Stock Position:  -0.003031811831298902
Bond Position:  [-9.38614978]


portfolio before change:  [-9.68948645]
curr_Stock_Price:  98.5029550215775
curr_Factors:  [98.50295502 -0.55678054 -0.90413273]
mat_Sqrt:  [[22.85507704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207427 -0.03264631  0.16338134]
Stock Position:  -0.002074273302361377
Bond Position:  [-9.4851644]


portfolio before change:  [-9.70344996]
curr_Stock_Price:  102.94776385739334
curr_Factors:  [102.94776386  -0.98813759  -0.87742545]
mat_Sqrt:  [[15.9372425   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00511098 0.02228707 0.00369175]
Stock Position:  0.005110984027773636
Bond Position:  [-10.22961434]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.71301489]
Stock Price:  102.077317220621
PL:  [-11.79033211]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.28824819e+00 -3.00742080e-01 -7.47617803e-02]
 [-1.94143768e-03  1.19073696e-01  1.09650856e-01]
 [-1.01162095e-01  4.62825233e-01  5.68857178e-01]
 [ 1.01791122e-01  2.45190778e-02  1.15166867e-02]
 [ 4.87780576e-02  2.55626092e-02  2.70199589e-02]
 [ 4.63858915e-02  8.91614604e-02 -6.29007981e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-1.74434770e-02 -4.77454351e-02  8.55939958e-03]
 [-1.70493193e-02  9.22668140e-02 -3.72599099e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.60937062]
curr_Stock_Price:  101.9710560052965
curr_Factors:  [101.97105601  -1.32793623  -0.97551625]
mat_Sqrt:  [[10.18826455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.13396762 -0.09706409 -0.21327455]
Stock Position:  -0.1339676241488828
Bond Position:  [30.27019072]


portfolio before change:  [16.81303558]
curr_Stock_Price:  100.56380493468399
curr_Factors:  [100.56380493  -0.68879385  -1.03560214]
mat_Sqrt:  [[17.92858583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00249583 0.03843087 0.31280337]
Stock Position:  0.002495833544505809
Bond Position:  [16.56204506]


portfolio before change:  [16.82137536]
curr_Stock_Price:  100.58651936184347
curr_Factors:  [100.58651936  -0.37300338  -1.09166736]
mat_Sqrt:  [[23.25098525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00470643 0.1493762  1.62279119]
Stock Position:  0.004706432612875489
Bond Position:  [16.34797169]


portfolio before change:  [16.8255359]
curr_Stock_Price:  99.73332772842248
curr_Factors:  [99.73332773 -0.61421228 -1.07868986]
mat_Sqrt:  [[18.3494162   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00594825 0.0079135  0.0328539 ]
Stock Position:  0.005948248717375886
Bond Position:  [16.23229726]


portfolio before change:  [16.83198356]
curr_Stock_Price:  99.45248551023752
curr_Factors:  [99.45248551 -0.82016918 -1.12871468]
mat_Sqrt:  [[14.16531165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00420121 0.0082503  0.07708042]
Stock Position:  0.004201208618008945
Bond Position:  [16.41416292]


portfolio before change:  [16.84638687]
curr_Stock_Price:  100.92686578976004
curr_Factors:  [100.92686579  -1.66665012  -1.16476515]
mat_Sqrt:  [[ 5.94755895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00870043  0.02877674 -0.17943847]
Stock Position:  0.008700431089818501
Bond Position:  [15.96827963]


portfolio before change:  [16.85664685]
curr_Stock_Price:  101.18821398100263
curr_Factors:  [101.18821398  -1.57939005  -1.18349219]
mat_Sqrt:  [[ 6.38594862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00751637 -0.01197701  0.13962421]
Stock Position:  -0.007516369437966155
Bond Position:  [17.61721485]


portfolio before change:  [16.87197844]
curr_Stock_Price:  100.3206704949725
curr_Factors:  [100.32067049  -1.3980794   -1.16178369]
mat_Sqrt:  [[ 7.75632528  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0032802  -0.01540977  0.02441758]
Stock Position:  -0.0032801993272054686
Bond Position:  [17.20105024]


portfolio before change:  [16.88088154]
curr_Stock_Price:  100.22908330698925
curr_Factors:  [100.22908331  -0.70652985  -1.16109865]
mat_Sqrt:  [[15.48435092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037593  0.02977899 -0.10629215]
Stock Position:  -0.0003759332250597762
Bond Position:  [16.91856098]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.8893978]
Stock Price:  100.08314039084648
PL:  [16.80625741]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-6.17716051e-01 -1.26681921e-01 -7.52151042e-03]
 [ 5.14781289e-02  3.77484619e-02  1.63677052e-02]
 [-7.35268148e-02  4.03075586e-01  4.20552342e-01]
 [ 2.13963523e-01  1.42937149e-01  1.76995929e-01]
 [ 5.25525145e-02 -1.66126416e-02  6.37040178e-02]
 [-9.02097446e-02 -4.62632403e-02  8.31123248e-03]
 [ 3.45020830e-02  1.65278236e-01  1.09953631e-01]
 [-3.82088979e-02 -1.07897438e-01  6.29969302e-02]
 [-3.01608759e-02 -3.44918105e-02 -8.12501283e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.11777332]
curr_Stock_Price:  96.95869184249682
curr_Factors:  [96.95869184 -0.61080347 -1.00094858]
mat_Sqrt:  [[19.34691503  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03334435 -0.04088641 -0.02145678]
Stock Position:  -0.03334434510648904
Bond Position:  [-16.88474924]


portfolio before change:  [-20.15793108]
curr_Stock_Price:  97.90977583056652
curr_Factors:  [97.90977583 -0.49148337 -1.01019384]
mat_Sqrt:  [[21.81001337  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00286678 0.01218326 0.04669251]
Stock Position:  0.0028667816099401315
Bond Position:  [-20.43861702]


portfolio before change:  [-20.16997725]
curr_Stock_Price:  97.27341348712213
curr_Factors:  [97.27341349 -0.40251117 -0.97610728]
mat_Sqrt:  [[24.50573712  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00386014 0.13009209 1.19971877]
Stock Position:  0.003860138206345375
Bond Position:  [-20.54546607]


portfolio before change:  [-20.18193761]
curr_Stock_Price:  96.83688591492769
curr_Factors:  [96.83688591 -0.37839613 -0.90805832]
mat_Sqrt:  [[26.75104473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01043958 0.04613277 0.50492012]
Stock Position:  0.010439576933623464
Bond Position:  [-21.19287373]


portfolio before change:  [-20.20623089]
curr_Stock_Price:  95.52512845746516
curr_Factors:  [95.52512846 -0.42759837 -0.96269918]
mat_Sqrt:  [[23.78587191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00261353 -0.00536171  0.18172983]
Stock Position:  0.0026135262843090686
Bond Position:  [-20.45588832]


portfolio before change:  [-20.2144881]
curr_Stock_Price:  96.2801603979101
curr_Factors:  [96.2801604  -0.79575577 -1.02858038]
mat_Sqrt:  [[15.53236836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00630661 -0.0149314   0.02370963]
Stock Position:  -0.006306614905398678
Bond Position:  [-19.6072862]


portfolio before change:  [-20.22325996]
curr_Stock_Price:  96.11616888618357
curr_Factors:  [96.11616889 -0.66597466 -1.10977977]
mat_Sqrt:  [[16.2778148   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00557099 0.05334332 0.3136671 ]
Stock Position:  0.005570990556626682
Bond Position:  [-20.75872223]


portfolio before change:  [-20.22698313]
curr_Stock_Price:  97.31142965876336
curr_Factors:  [97.31142966 -1.05858151 -1.10807715]
mat_Sqrt:  [[11.14797415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00424958 -0.03482375  0.17971271]
Stock Position:  -0.004249577103213697
Bond Position:  [-19.81345071]


portfolio before change:  [-20.23274891]
curr_Stock_Price:  96.33640871957712
curr_Factors:  [96.33640872 -0.9663978  -1.15645661]
mat_Sqrt:  [[11.53045637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00466474 -0.01113218 -0.231784  ]
Stock Position:  -0.004664741667534759
Bond Position:  [-19.78336445]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.24476987]
Stock Price:  96.79234111132665
PL:  [-20.24476987]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.33708689e+00 -3.11015484e-01 -7.60881101e-02]
 [-1.81757712e-03  1.18882627e-01  1.07561195e-01]
 [-1.16610843e-01  5.57922791e-01  6.85691348e-01]
 [ 1.79306566e-01  1.07442765e-01  1.28475048e-01]
 [ 5.14990734e-02 -1.49729836e-02  7.36638964e-02]
 [-9.51926851e-02 -5.09069141e-02  1.07569165e-02]
 [ 8.03730807e-02  2.47094698e-01  1.43745732e-01]
 [-3.85775668e-02 -1.08736809e-01  5.63589291e-02]
 [-3.03397176e-02 -1.61067530e-01 -1.26873398e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.84343019]
curr_Stock_Price:  101.8665237183664
curr_Factors:  [101.86652372  -1.04726566  -0.99557786]
mat_Sqrt:  [[13.20796219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10721594 -0.10037982 -0.2170582 ]
Stock Position:  -0.10721594016714682
Bond Position:  [26.7651453]


portfolio before change:  [15.99208234]
curr_Stock_Price:  100.60489943494157
curr_Factors:  [100.60489943  -0.57293515  -0.99044288]
mat_Sqrt:  [[21.06942475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00210756 0.0383692  0.30684215]
Stock Position:  0.002107559888523123
Bond Position:  [15.78005149]


portfolio before change:  [16.00208733]
curr_Stock_Price:  101.6074777986139
curr_Factors:  [101.6074778   -0.36744368  -0.99155985]
mat_Sqrt:  [[26.10465387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00525733 0.18006881 1.95608656]
Stock Position:  0.005257331927885554
Bond Position:  [15.4679031]


portfolio before change:  [15.99063722]
curr_Stock_Price:  97.95809905159929
curr_Factors:  [97.95809905 -0.36036934 -1.00851769]
mat_Sqrt:  [[24.91955403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0091279  0.034677   0.36650355]
Stock Position:  0.009127895622224201
Bond Position:  [15.09648592]


portfolio before change:  [15.97021777]
curr_Stock_Price:  94.89391183248992
curr_Factors:  [94.89391183 -0.58866611 -0.99079859]
mat_Sqrt:  [[19.55624842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00324599 -0.00483251  0.21014259]
Stock Position:  0.0032459858594986526
Bond Position:  [15.66219348]


portfolio before change:  [15.97282632]
curr_Stock_Price:  93.2843823774481
curr_Factors:  [93.28438238 -0.3401042  -0.95649624]
mat_Sqrt:  [[25.50953407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00405293 -0.01643014  0.03068649]
Stock Position:  -0.004052926593484077
Bond Position:  [16.35090107]


portfolio before change:  [15.97534717]
curr_Stock_Price:  94.6800756759964
curr_Factors:  [94.68007568 -0.5989023  -0.9491925 ]
mat_Sqrt:  [[20.13397687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00795437 0.07974947 0.41006656]
Stock Position:  0.007954367409335123
Bond Position:  [15.22222706]


portfolio before change:  [15.9982845]
curr_Stock_Price:  96.606604541843
curr_Factors:  [96.60660454 -0.88974378 -0.97406189]
mat_Sqrt:  [[14.98187952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328858 -0.03509465  0.16077634]
Stock Position:  -0.003288583167532712
Bond Position:  [16.31598336]


portfolio before change:  [16.01498312]
curr_Stock_Price:  94.0101721180746
curr_Factors:  [94.01017212 -0.7910723  -0.92645257]
mat_Sqrt:  [[16.87575736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00528068 -0.05198432 -0.36193449]
Stock Position:  -0.0052806763867765125
Bond Position:  [16.51142042]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.01923303]
Stock Price:  94.76913999390248
PL:  [16.01923303]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.40266998e+00 -3.37042955e-01 -5.21152822e-02]
 [ 2.67488247e-02  5.99102418e-02 -3.37964682e-02]
 [-5.29284079e-02  2.61647072e-01  2.61227438e-01]
 [ 2.13602817e-01  1.71206082e-01  2.45672151e-01]
 [ 5.30697485e-02 -2.28700458e-02  6.96838012e-02]
 [-6.23115133e-02 -2.02644772e-02 -5.38153751e-03]
 [ 6.10753432e-02  2.09010838e-01  1.22337116e-01]
 [-4.02291952e-02 -1.17703279e-01  2.46192443e-02]
 [-1.61535762e-02 -3.18180363e-01 -1.49391185e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.69955954]
curr_Stock_Price:  101.16451016233316
curr_Factors:  [101.16451016  -0.3593746   -0.9851131 ]
mat_Sqrt:  [[26.37087817  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0562024  -0.10878015 -0.14867039]
Stock Position:  -0.05620239728570134
Bond Position:  [16.38524753]


portfolio before change:  [10.92348182]
curr_Stock_Price:  97.32610422669829
curr_Factors:  [97.32610423 -0.95212683 -0.97461159]
mat_Sqrt:  [[14.17285923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00226343  0.01933595 -0.09641192]
Stock Position:  0.0022634301132186813
Bond Position:  [10.70319099]


portfolio before change:  [10.92612603]
curr_Stock_Price:  96.12936984584641
curr_Factors:  [96.12936985 -0.97681314 -0.95552947]
mat_Sqrt:  [[13.92035668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00386505 0.08444623 0.74520917]
Stock Position:  0.003865052158682194
Bond Position:  [10.554581]


portfolio before change:  [10.92798472]
curr_Stock_Price:  95.24453892387427
curr_Factors:  [95.24453892 -1.42980269 -0.92001657]
mat_Sqrt:  [[ 9.0850338   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.032878   0.05525653 0.70083427]
Stock Position:  0.03287799870935668
Bond Position:  [7.7965349]


portfolio before change:  [10.94609119]
curr_Stock_Price:  95.67665845183193
curr_Factors:  [95.67665845 -0.81432543 -0.97315791]
mat_Sqrt:  [[16.0144433   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00391057 -0.00738128  0.19878849]
Stock Position:  0.003910567802911236
Bond Position:  [10.57194113]


portfolio before change:  [10.94646391]
curr_Stock_Price:  94.41991685380206
curr_Factors:  [94.41991685 -0.69013032 -0.92450879]
mat_Sqrt:  [[18.78601892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359557 -0.00654033 -0.01535203]
Stock Position:  -0.0035955720290611376
Bond Position:  [11.28595752]


portfolio before change:  [10.94957874]
curr_Stock_Price:  95.12343700196972
curr_Factors:  [95.123437   -0.58012082 -0.88332245]
mat_Sqrt:  [[22.01517789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00584649 0.06745796 0.34899374]
Stock Position:  0.005846487452271166
Bond Position:  [10.39344076]


portfolio before change:  [10.94204308]
curr_Stock_Price:  92.94543184508849
curr_Factors:  [92.94543185 -0.70413096 -0.9241778 ]
mat_Sqrt:  [[18.24158377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324697 -0.03798857  0.07023185]
Stock Position:  -0.003246971042543817
Bond Position:  [11.24383421]


portfolio before change:  [10.95440139]
curr_Stock_Price:  90.87119662232944
curr_Factors:  [90.87119662 -0.49912889 -0.96349209]
mat_Sqrt:  [[21.04834868  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0053019  -0.10269227 -0.42617147]
Stock Position:  -0.0053018989978258135
Bond Position:  [11.43619129]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.95504445]
Stock Price:  91.82867620801738
PL:  [10.95504445]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.44147028e-01 -2.21644832e-01  2.81889020e-04]
 [ 9.93611483e-02 -7.26790499e-03  9.44810639e-02]
 [-8.96869763e-02  5.02131487e-01  5.39557030e-01]
 [-5.45422399e-02 -7.22245515e-02 -5.47207287e-02]
 [ 5.14528541e-02  8.32780557e-03  2.77908034e-02]
 [ 3.34446884e-02  1.53708889e-02 -4.40895320e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-9.98825898e-03 -3.53146831e-02 -3.10587408e-03]
 [-1.54608564e-02  8.70104674e-02 -3.13823987e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.54476279]
curr_Stock_Price:  98.26517554315363
curr_Factors:  [98.26517554 -0.37738032 -1.02633499]
mat_Sqrt:  [[24.14203193  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03683752 -0.07153556  0.00080415]
Stock Position:  -0.03683751855075058
Bond Position:  [-6.92491756]


portfolio before change:  [-10.53954525]
curr_Stock_Price:  98.0295228555757
curr_Factors:  [98.02952286  0.24542589 -1.05675603]
mat_Sqrt:  [[43.55125615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00269024 -0.00234571  0.26952818]
Stock Position:  0.0026902429501949638
Bond Position:  [-10.80326848]


portfolio before change:  [-10.54485381]
curr_Stock_Price:  98.06462322151783
curr_Factors:  [ 9.80646232e+01  8.37618939e-02 -1.02605761e+00]
mat_Sqrt:  [[38.2189309   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00321691 0.16206224 1.53920602]
Stock Position:  0.0032169084473663745
Bond Position:  [-10.86031872]


portfolio before change:  [-10.54559222]
curr_Stock_Price:  99.52351011479023
curr_Factors:  [99.52351011  0.39360656 -1.06893941]
mat_Sqrt:  [[50.65617051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158825 -0.02331037 -0.15610301]
Stock Position:  -0.0015882534323909464
Bond Position:  [-10.38752366]


portfolio before change:  [-10.55299995]
curr_Stock_Price:  100.91665969281961
curr_Factors:  [100.91665969  -0.86025694  -1.11089834]
mat_Sqrt:  [[14.05727064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00418471 0.00268779 0.07927943]
Stock Position:  0.0041847052537488305
Bond Position:  [-10.97530643]


portfolio before change:  [-10.54811283]
curr_Stock_Price:  103.39620002825076
curr_Factors:  [103.39620003  -0.74742334  -1.16398465]
mat_Sqrt:  [[15.28940688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00180403  0.00496093 -0.12577516]
Stock Position:  0.0018040281175225597
Bond Position:  [-10.73464249]


portfolio before change:  [-10.55768691]
curr_Stock_Price:  101.06507398273689
curr_Factors:  [101.06507398  -1.04103935  -1.14213568]
mat_Sqrt:  [[11.38833488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421476 -0.01197701  0.13962421]
Stock Position:  -0.004214764453658135
Bond Position:  [-10.13172143]


portfolio before change:  [-10.56217153]
curr_Stock_Price:  100.92686678458209
curr_Factors:  [100.92686678  -1.16310461  -1.16775521]
mat_Sqrt:  [[ 9.81131533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181737 -0.01139776 -0.00886019]
Stock Position:  -0.0018173732845118884
Bond Position:  [-10.37874974]


portfolio before change:  [-10.56771127]
curr_Stock_Price:  101.11893896494439
curr_Factors:  [101.11893896  -0.71133076  -1.2131334 ]
mat_Sqrt:  [[14.75870804  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0002782   0.02808251 -0.08952525]
Stock Position:  -0.00027819673996755644
Bond Position:  [-10.53958031]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.5726959]
Stock Price:  100.08916984436787
PL:  [-10.66186574]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.18980163e+00 -3.03499456e-01 -2.26810264e-02]
 [ 5.79751191e-02  3.32869584e-02  4.26919025e-02]
 [-4.90275514e-02  2.60837016e-01  2.44131937e-01]
 [ 2.95495020e-01  2.75270249e-01  4.09104273e-01]
 [ 2.41853435e-02 -7.54292183e-02  1.45873397e-01]
 [-4.99035080e-02  2.99887096e-02 -2.05795343e-02]
 [ 6.61472471e-02  2.17754996e-01  1.30291787e-01]
 [-3.95743597e-02 -1.16696255e-01  3.71548975e-02]
 [-6.02179590e-02 -2.16367605e-01 -1.30120431e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.58218204]
curr_Stock_Price:  100.46611227902353
curr_Factors:  [100.46611228  -0.64160251  -1.03627169]
mat_Sqrt:  [[18.76411507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06695669 -0.09795403 -0.06470266]
Stock Position:  -0.06695668514934185
Bond Position:  [12.30905988]


portfolio before change:  [5.69853377]
curr_Stock_Price:  98.82033695836016
curr_Factors:  [98.82033696 -0.25558032 -1.0563978 ]
mat_Sqrt:  [[26.61101694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00276142 0.01074332 0.12178811]
Stock Position:  0.002761421682309977
Bond Position:  [5.42564914]


portfolio before change:  [5.69217099]
curr_Stock_Price:  95.53352446124335
curr_Factors:  [95.53352446 -0.94678965 -0.96675652]
mat_Sqrt:  [[14.09656371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00383418 0.08418478 0.69644046]
Stock Position:  0.003834182969438936
Bond Position:  [5.32587798]


portfolio before change:  [5.6844561]
curr_Stock_Price:  92.82669104499938
curr_Factors:  [92.82669104 -0.77728342 -0.93248097]
mat_Sqrt:  [[16.79312924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02591491 0.08884309 1.16706062]
Stock Position:  0.02591490708649592
Bond Position:  [3.27886103]


portfolio before change:  [5.68843247]
curr_Stock_Price:  92.91685249953315
curr_Factors:  [92.9168525  -0.69964329 -1.00116632]
mat_Sqrt:  [[16.96064104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227378 -0.02434468  0.4161362 ]
Stock Position:  0.0022737761548135066
Bond Position:  [5.47716035]


portfolio before change:  [5.69243823]
curr_Stock_Price:  93.47385213835418
curr_Factors:  [93.47385214 -0.80010635 -1.03003028]
mat_Sqrt:  [[14.99242556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320047  0.00967881 -0.05870768]
Stock Position:  -0.003200473996927257
Bond Position:  [5.99159886]


portfolio before change:  [5.69059307]
curr_Stock_Price:  94.98666215886009
curr_Factors:  [94.98666216 -0.9097869  -1.09775687]
mat_Sqrt:  [[12.75843626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01075304 0.07028012 0.3716862 ]
Stock Position:  0.010753041864362324
Bond Position:  [4.66919751]


portfolio before change:  [5.68319465]
curr_Stock_Price:  94.08146743677484
curr_Factors:  [94.08146744 -0.73018588 -0.98533662]
mat_Sqrt:  [[16.9224068   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00329803 -0.03766355  0.10599258]
Stock Position:  -0.0032980339029589894
Bond Position:  [5.99347852]


portfolio before change:  [5.68952564]
curr_Stock_Price:  93.07071462110159
curr_Factors:  [93.07071462 -0.51550902 -0.94464377]
mat_Sqrt:  [[21.61109384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00605913 -0.06983234 -0.37119737]
Stock Position:  -0.0060591349117316015
Bond Position:  [6.25345365]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.71575785]
Stock Price:  89.25751210196523
PL:  [5.71575785]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.06008586e+00 -2.80174723e-01 -1.08174943e-02]
 [ 9.04447550e-03  9.38813643e-02  4.95071683e-02]
 [-8.04438301e-02  3.25610310e-01  4.11140974e-01]
 [ 1.36212118e-01  6.30241022e-02  6.74664444e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 7.26769778e-02 -9.11893433e-03 -4.82845282e-02]
 [-4.81744572e-02 -3.30627396e-02  4.26793434e-02]
 [ 1.40642177e-02  1.79875872e-02 -4.96365926e-02]
 [ 5.02012516e-03  8.09967642e-02 -1.70184222e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.32262815]
curr_Stock_Price:  99.6602489360487
curr_Factors:  [99.66024894 -0.5448614  -0.97322954]
mat_Sqrt:  [[21.83853221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05126189 -0.090426   -0.0308593 ]
Stock Position:  -0.051261888354416016
Bond Position:  [4.7861444]


portfolio before change:  [-0.32463255]
curr_Stock_Price:  99.74604498542475
curr_Factors:  [99.74604499 -0.94909631 -0.95383411]
mat_Sqrt:  [[14.87522368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00257566 0.03030008 0.14123017]
Stock Position:  0.002575661245288129
Bond Position:  [-0.58154457]


portfolio before change:  [-0.32370819]
curr_Stock_Price:  100.21784977848179
curr_Factors:  [100.21784978  -1.29962422  -0.93228377]
mat_Sqrt:  [[10.7557266   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00650304 0.10509028 1.17287076]
Stock Position:  0.006503037736672765
Bond Position:  [-0.97542865]


portfolio before change:  [-0.33456257]
curr_Stock_Price:  98.62374209650663
curr_Factors:  [98.6237421  -0.94302348 -0.92537667]
mat_Sqrt:  [[15.22458993  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01069641 0.02034094 0.19246299]
Stock Position:  0.01069640563684908
Bond Position:  [-1.38948212]


portfolio before change:  [-0.31075935]
curr_Stock_Price:  100.91405675253668
curr_Factors:  [100.91405675  -0.36334069  -0.90567861]
mat_Sqrt:  [[28.36766454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00205591 -0.00140152  0.08089603]
Stock Position:  0.0020559075409499914
Bond Position:  [-0.51822932]


portfolio before change:  [-0.29890421]
curr_Stock_Price:  106.80649927168804
curr_Factors:  [106.80649927  -0.95816282  -0.95046006]
mat_Sqrt:  [[15.83774328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.003849   -0.00294312 -0.13774232]
Stock Position:  0.003849004492385852
Bond Position:  [-0.7100029]


portfolio before change:  [-0.30048971]
curr_Stock_Price:  106.48682945593255
curr_Factors:  [106.48682946  -0.83434689  -0.99415346]
mat_Sqrt:  [[17.10756836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270123 -0.01067095  0.12175229]
Stock Position:  -0.0027012299590425588
Bond Position:  [-0.01284429]


portfolio before change:  [-0.29464732]
curr_Stock_Price:  104.32158859168699
curr_Factors:  [104.32158859  -0.61282999  -0.96340634]
mat_Sqrt:  [[21.56867442  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035254  0.00580547 -0.14159938]
Stock Position:  0.00035254329505942354
Bond Position:  [-0.3314252]


portfolio before change:  [-0.29560245]
curr_Stock_Price:  102.0824834882449
curr_Factors:  [102.08248349  -0.77122886  -0.96492423]
mat_Sqrt:  [[17.98661834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00100517  0.02614159 -0.04854882]
Stock Position:  0.0010051722456522023
Bond Position:  [-0.39821293]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.29448479]
Stock Price:  103.39253217020229
PL:  [-3.68701696]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-9.98706875e-01 -2.64496228e-01 -1.49768837e-02]
 [ 2.32551877e-02  7.67051660e-02  4.72324080e-02]
 [-8.79280433e-02  4.75853929e-01  5.18802259e-01]
 [ 1.03080226e-01  2.52444734e-02  1.19022843e-02]
 [ 5.11598676e-02 -6.90964350e-03  2.46955697e-02]
 [ 5.29911335e-02  4.36291627e-03 -4.63145799e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 1.25432142e-02  1.59585227e-02 -4.75984216e-02]
 [ 3.29670230e-02  6.80671929e-02 -2.41378933e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.64806013]
curr_Stock_Price:  99.47935962523397
curr_Factors:  [99.47935963 -0.61110287 -0.95179438]
mat_Sqrt:  [[20.84372474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05065093 -0.08536579 -0.04272488]
Stock Position:  -0.050650932024990755
Bond Position:  [3.39066215]


portfolio before change:  [-1.65980204]
curr_Stock_Price:  99.74465906232561
curr_Factors:  [99.74465906 -0.48447128 -1.0128184 ]
mat_Sqrt:  [[22.31644455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0021757  0.02475649 0.13474091]
Stock Position:  0.0021756977898050767
Bond Position:  [-1.87681628]


portfolio before change:  [-1.66382326]
curr_Stock_Price:  98.32783835322479
curr_Factors:  [98.32783835 -0.1079472  -1.00295274]
mat_Sqrt:  [[32.37567096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0035553  0.1535812  1.47999844]
Stock Position:  0.0035553024106417513
Bond Position:  [-2.01340846]


portfolio before change:  [-1.65837398]
curr_Stock_Price:  100.14378452761802
curr_Factors:  [100.14378453  -0.23234879  -1.03703246]
mat_Sqrt:  [[28.14094815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00393245 0.00814762 0.0339539 ]
Stock Position:  0.003932446623685516
Bond Position:  [-2.05218406]


portfolio before change:  [-1.64523838]
curr_Stock_Price:  103.7450920646411
curr_Factors:  [103.74509206  -0.51254975  -1.01883044]
mat_Sqrt:  [[22.4335288   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00244234 -0.00223008  0.07044959]
Stock Position:  0.002442344451508142
Bond Position:  [-1.89861963]


portfolio before change:  [-1.64287415]
curr_Stock_Price:  105.1018935216747
curr_Factors:  [105.10189352  -0.81766711  -0.99514787]
mat_Sqrt:  [[17.15200905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00259024  0.00140813 -0.13212261]
Stock Position:  0.0025902380252907494
Bond Position:  [-1.91511307]


portfolio before change:  [-1.64210543]
curr_Stock_Price:  105.76843817890808
curr_Factors:  [105.76843818  -0.77102285  -0.97160283]
mat_Sqrt:  [[18.51583815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259233 -0.01197701  0.13962421]
Stock Position:  -0.0025923292631912054
Bond Position:  [-1.36791882]


portfolio before change:  [-1.6400763]
curr_Stock_Price:  104.72178824268109
curr_Factors:  [104.72178824  -0.57497649  -0.97297337]
mat_Sqrt:  [[22.27260252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00027319  0.00515059 -0.13578505]
Stock Position:  0.0002731942487196317
Bond Position:  [-1.66868569]


portfolio before change:  [-1.64136769]
curr_Stock_Price:  103.0495678806831
curr_Factors:  [103.04956788  -0.71001937  -1.0284415 ]
mat_Sqrt:  [[18.11516154  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00255965  0.02196859 -0.00688587]
Stock Position:  0.002559649704109431
Bond Position:  [-1.90513849]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.64592483]
Stock Price:  101.6414348366506
PL:  [-3.28735967]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.29386798e-01 -2.01485605e-01 -6.55740810e-02]
 [ 9.25937344e-04  1.12465991e-01  9.44448528e-02]
 [-1.06119415e-01  4.85529620e-01  5.96321538e-01]
 [ 1.07454203e-01  2.77057661e-02  1.32106303e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 1.86353814e-02  2.78078505e-02 -4.28321485e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-4.58084167e-04 -2.32757805e-02 -1.54217446e-02]
 [-2.80083221e-02  8.06747909e-02 -3.93354625e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.09658469]
curr_Stock_Price:  99.71746131914104
curr_Factors:  [99.71746132 -1.09249394 -1.07214637]
mat_Sqrt:  [[11.44668875  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07721885 -0.0650292  -0.1870646 ]
Stock Position:  -0.07721884885658017
Bond Position:  [7.79665226]


portfolio before change:  [0.05237701]
curr_Stock_Price:  100.34045660941591
curr_Factors:  [100.34045661  -0.79351851  -0.98888839]
mat_Sqrt:  [[16.88055009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00255687 0.03629824 0.26942488]
Stock Position:  0.00255687381849271
Bond Position:  [-0.20418088]


portfolio before change:  [0.05579219]
curr_Stock_Price:  101.71607909872942
curr_Factors:  [101.7160791   -0.77862662  -1.00858207]
mat_Sqrt:  [[17.03000357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00673591 0.15670401 1.70113936]
Stock Position:  0.00673590748189302
Bond Position:  [-0.62935791]


portfolio before change:  [0.05751389]
curr_Stock_Price:  102.0184076103719
curr_Factors:  [102.01840761  -1.21382968  -1.04671179]
mat_Sqrt:  [[10.63990757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01088414 0.008942   0.03768625]
Stock Position:  0.010884138486843947
Bond Position:  [-1.05286859]


portfolio before change:  [0.05026137]
curr_Stock_Price:  101.4004488143677
curr_Factors:  [101.40044881  -1.0315553   -1.08805997]
mat_Sqrt:  [[12.17594459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00478988 -0.00140152  0.08089603]
Stock Position:  0.004789878519428588
Bond Position:  [-0.43543446]


portfolio before change:  [0.05366508]
curr_Stock_Price:  102.15651718576167
curr_Factors:  [102.15651719  -0.51658412  -1.06791996]
mat_Sqrt:  [[20.94713822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074323  0.00897495 -0.1221882 ]
Stock Position:  0.0007432308525741048
Bond Position:  [-0.0222608]


portfolio before change:  [0.05291199]
curr_Stock_Price:  101.15823226694675
curr_Factors:  [101.15823227  -0.29041825  -1.02906983]
mat_Sqrt:  [[27.03677216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177533 -0.01197701  0.13962421]
Stock Position:  -0.0017753283853892473
Bond Position:  [0.23250107]


portfolio before change:  [0.05176223]
curr_Stock_Price:  101.8713596656411
curr_Factors:  [101.87135967  -0.46666674  -1.09926849]
mat_Sqrt:  [[21.28016918  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039272 -0.00751223 -0.04399394]
Stock Position:  -0.000392721661771034
Bond Position:  [0.09176932]


portfolio before change:  [0.05294215]
curr_Stock_Price:  98.9837635296378
curr_Factors:  [98.98376353 -0.80028925 -1.10379349]
mat_Sqrt:  [[14.7445437   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132727  0.02603768 -0.11221313]
Stock Position:  -0.0013272684049767738
Bond Position:  [0.18432017]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.055539]
Stock Price:  97.09667841095361
PL:  [0.055539]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-9.01387106e-01 -2.08605972e-01 -8.69073468e-02]
 [-1.61104902e-02  1.50565402e-01  2.02405983e-01]
 [-8.74982489e-02  3.65905964e-01  4.33932091e-01]
 [ 1.07149934e-01  2.75345499e-02  1.31196171e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 3.66487927e-02  2.51011185e-02 -4.64331255e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 7.59626978e-03  1.25021319e-02 -4.30879056e-02]
 [ 1.62298396e-01  2.67090489e-02  4.61405275e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.11506403]
curr_Stock_Price:  100.53883774357924
curr_Factors:  [100.53883774  -1.48384665  -0.95606036]
mat_Sqrt:  [[ 8.76386563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10973565 -0.06732729 -0.24792247]
Stock Position:  -0.1097356520380173
Bond Position:  [17.14775894]


portfolio before change:  [6.05054237]
curr_Stock_Price:  101.20496292122688
curr_Factors:  [101.20496292  -1.55385407  -0.93341778]
mat_Sqrt:  [[ 8.41382298  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00664852 0.04859477 0.57740793]
Stock Position:  0.006648522583424053
Bond Position:  [5.37767889]


portfolio before change:  [6.05923595]
curr_Stock_Price:  102.10803108483391
curr_Factors:  [102.10803108  -1.80792666  -0.90705709]
mat_Sqrt:  [[ 6.76016726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01120801 0.11809564 1.23788747]
Stock Position:  0.01120800824521824
Bond Position:  [4.9148083]


portfolio before change:  [6.06087108]
curr_Stock_Price:  102.03461072146106
curr_Factors:  [102.03461072  -1.13462619  -0.80790538]
mat_Sqrt:  [[14.6257036   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00789353 0.00888674 0.03742662]
Stock Position:  0.007893530056410972
Bond Position:  [5.25545781]


portfolio before change:  [6.06640871]
curr_Stock_Price:  102.40317187097313
curr_Factors:  [102.40317187  -1.31324098  -0.72630364]
mat_Sqrt:  [[13.32141726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00437801 -0.00140152  0.08089603]
Stock Position:  0.004378009808802235
Bond Position:  [5.61808662]


portfolio before change:  [6.0725443]
curr_Stock_Price:  103.16284244353322
curr_Factors:  [103.16284244  -1.54567586  -0.71731174]
mat_Sqrt:  [[10.73297883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0030089   0.00810135 -0.13246078]
Stock Position:  0.003008895806940102
Bond Position:  [5.76213806]


portfolio before change:  [6.07378941]
curr_Stock_Price:  102.61889475262954
curr_Factors:  [102.61889475  -1.41656042  -0.74381145]
mat_Sqrt:  [[11.83013632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00405736 -0.01197701  0.13962421]
Stock Position:  -0.004057362296250249
Bond Position:  [6.49015144]


portfolio before change:  [6.07052693]
curr_Stock_Price:  104.2229821038103
curr_Factors:  [104.2229821   -1.06953976  -0.73360779]
mat_Sqrt:  [[17.17380243  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.87813222e-05  4.03504572e-03 -1.22917801e-01]
Stock Position:  7.878132222311272e-05
Bond Position:  [6.06231611]


portfolio before change:  [6.07369253]
curr_Stock_Price:  105.91987010994079
curr_Factors:  [105.91987011  -0.95407104  -0.6831359 ]
mat_Sqrt:  [[20.60380835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00859884 0.00862031 0.13162608]
Stock Position:  0.008598835273887342
Bond Position:  [5.16290502]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.07244381]
Stock Price:  105.47436597800599
PL:  [0.59807783]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.59062911e+00 -3.35424637e-01 -1.43873467e-01]
 [-1.30771054e-01  2.41609106e-01  6.50195289e-01]
 [-1.31858193e-01  7.01277496e-01  7.07911424e-01]
 [ 1.11533992e-01  3.00015156e-02  1.44309787e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 3.66810601e-02  1.85497779e-02 -4.52824557e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 9.43764716e-03  1.29037537e-02 -4.41703583e-02]
 [ 3.07040300e-02  5.69122833e-02  3.96405068e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [29.0803268]
curr_Stock_Price:  103.67303898474928
curr_Factors:  [103.67303898  -1.30890977  -0.96455862]
mat_Sqrt:  [[10.6736032   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.15819076 -0.10825784 -0.41043095]
Stock Position:  -0.15819076235478582
Bond Position:  [45.48044387]


portfolio before change:  [28.7606761]
curr_Stock_Price:  105.83749284838038
curr_Factors:  [105.83749285  -0.83542359  -0.97721696]
mat_Sqrt:  [[17.27506769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00296773 0.077979   1.85482618]
Stock Position:  0.002967731120414592
Bond Position:  [28.44657888]


portfolio before change:  [28.77293112]
curr_Stock_Price:  105.17306919681
curr_Factors:  [105.1730692   -1.07850272  -0.99096275]
mat_Sqrt:  [[13.27844172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01173265 0.22633634 2.01947425]
Stock Position:  0.011732648636991305
Bond Position:  [27.53897245]


portfolio before change:  [28.76955485]
curr_Stock_Price:  103.71140484504409
curr_Factors:  [103.71140485  -1.05748927  -0.98611666]
mat_Sqrt:  [[13.43692026  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00897555 0.00968295 0.04116757]
Stock Position:  0.00897554906813369
Bond Position:  [27.83868805]


portfolio before change:  [28.77317201]
curr_Stock_Price:  102.56321120985095
curr_Factors:  [102.56321121  -1.01389871  -0.92333649]
mat_Sqrt:  [[14.77954462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00394608 -0.00140152  0.08089603]
Stock Position:  0.0039460820319055815
Bond Position:  [28.36844916]


portfolio before change:  [28.79099679]
curr_Stock_Price:  103.48488748314062
curr_Factors:  [103.48488748  -1.04434232  -0.94516532]
mat_Sqrt:  [[14.15287728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00220621  0.00598692 -0.12917824]
Stock Position:  0.002206213937919764
Bond Position:  [28.56268699]


portfolio before change:  [28.80681308]
curr_Stock_Price:  104.17900542862738
curr_Factors:  [104.17900543  -1.14247539  -0.93958188]
mat_Sqrt:  [[12.98835718  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00369555 -0.01197701  0.13962421]
Stock Position:  -0.0036955519776206915
Bond Position:  [29.19181201]


portfolio before change:  [28.81791268]
curr_Stock_Price:  105.12607564950147
curr_Factors:  [105.12607565  -0.51762064  -0.8731084 ]
mat_Sqrt:  [[26.16522688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.16772472e-04  4.16466861e-03 -1.26005738e-01]
Stock Position:  0.00011677247212563001
Bond Position:  [28.80563685]


portfolio before change:  [28.83215888]
curr_Stock_Price:  103.75398102285891
curr_Factors:  [103.75398102  -0.56671122  -0.8866956 ]
mat_Sqrt:  [[24.25482845  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00177822 0.01836836 0.01130833]
Stock Position:  0.0017782174692527444
Bond Position:  [28.64766174]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [28.85250032]
Stock Price:  107.13603634000651
PL:  [21.71646398]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.17290791e+00 -2.90686369e-01 -4.17178036e-02]
 [ 1.62603900e-03  1.10944004e-01  8.93449251e-02]
 [-7.83310559e-02  3.46387211e-01  4.12563332e-01]
 [ 1.18709108e-01  4.35387721e-02  3.92413174e-02]
 [ 5.07457960e-02  1.28836691e-02  2.75870377e-02]
 [-7.25906440e-02 -2.65624875e-02 -2.20886308e-03]
 [-5.01216845e-02  1.14046979e-02  5.34152049e-02]
 [-3.82374642e-02 -1.11015700e-01  6.57271449e-02]
 [-1.13732397e-01 -1.72806785e-01 -8.12942958e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.03136028]
curr_Stock_Price:  100.8003656932921
curr_Factors:  [100.80036569  -0.91564203  -0.99762203]
mat_Sqrt:  [[14.87791539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08339607 -0.09381862 -0.11900928]
Stock Position:  -0.08339606681843265
Bond Position:  [16.43771431]


portfolio before change:  [8.07831351]
curr_Stock_Price:  100.33592754103708
curr_Factors:  [100.33592754  -0.70200779  -0.93102295]
mat_Sqrt:  [[19.59928511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00216895 0.03580702 0.2548762 ]
Stock Position:  0.0021689487793715954
Bond Position:  [7.86069002]


portfolio before change:  [8.08036433]
curr_Stock_Price:  99.4689145652959
curr_Factors:  [99.46891457 -1.01343352 -0.93045397]
mat_Sqrt:  [[14.23861563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00537897 0.11179599 1.17692835]
Stock Position:  0.0053789691998151435
Bond Position:  [7.5453241]


portfolio before change:  [8.07976318]
curr_Stock_Price:  98.6556069994536
curr_Factors:  [98.655607   -1.62427706 -1.00057025]
mat_Sqrt:  [[ 7.14767946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0189721  0.01405208 0.11194456]
Stock Position:  0.018972104752118656
Bond Position:  [6.20805867]


portfolio before change:  [8.09435773]
curr_Stock_Price:  99.26121969667322
curr_Factors:  [99.2612197  -0.32791603 -0.95105712]
mat_Sqrt:  [[27.62667541  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00213586 0.00415819 0.07869814]
Stock Position:  0.0021358648314754977
Bond Position:  [7.88234918]


portfolio before change:  [8.09897804]
curr_Stock_Price:  99.57872447145091
curr_Factors:  [99.57872447 -0.21997479 -0.90348329]
mat_Sqrt:  [[32.37836494  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242333 -0.00857301 -0.00630127]
Stock Position:  -0.0024233333407927757
Bond Position:  [8.34029048]


portfolio before change:  [8.10396404]
curr_Stock_Price:  99.24248694304116
curr_Factors:  [99.24248694 -0.3554673  -0.90861521]
mat_Sqrt:  [[28.0358405   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131583  0.00368085  0.15237871]
Stock Position:  -0.00131582918980552
Bond Position:  [8.2345502]


portfolio before change:  [8.11024167]
curr_Stock_Price:  97.60145295112423
curr_Factors:  [ 9.76014530e+01 -5.76770757e-02 -9.58740353e-01]
mat_Sqrt:  [[35.32090334  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013443  -0.03583016  0.18750125]
Stock Position:  -0.001344301742334393
Bond Position:  [8.24144747]


portfolio before change:  [8.11943112]
curr_Stock_Price:  93.83168782460413
curr_Factors:  [ 9.38316878e+01 -9.60300191e-03 -9.76905457e-01]
mat_Sqrt:  [[34.98761577  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00473312 -0.05577315 -0.23191   ]
Stock Position:  -0.004733119395080636
Bond Position:  [8.5635477]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.16124838]
Stock Price:  85.90152374540581
PL:  [8.16124838]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.16432861e-01 -1.95385083e-01 -6.09312268e-02]
 [-3.06328729e-03  1.21377531e-01  1.19873096e-01]
 [-1.08006073e-01  5.12189279e-01  5.64860909e-01]
 [ 1.06513183e-01  2.71762420e-02  1.29291518e-02]
 [ 4.95765914e-02  2.04173310e-02  2.72500868e-02]
 [-4.14165185e-02 -2.10070758e-03 -1.56322084e-02]
 [-4.24137218e-02  1.15059831e-02  4.96622553e-02]
 [-3.85104861e-02 -9.98450102e-02  5.61224636e-02]
 [-1.11759571e-01  9.47402949e-04 -4.80127398e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.38735859]
curr_Stock_Price:  99.51493906161065
curr_Factors:  [99.51493906 -1.09272928 -1.03342129]
mat_Sqrt:  [[11.87169737  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07317852 -0.06306026 -0.17381983]
Stock Position:  -0.07317851702518713
Bond Position:  [5.89499707]


portfolio before change:  [-1.45813487]
curr_Stock_Price:  100.52240020097058
curr_Factors:  [100.5224002   -0.99321501  -1.06192233]
mat_Sqrt:  [[12.8744309   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00358709 0.03917443 0.34196458]
Stock Position:  0.0035870937642833076
Bond Position:  [-1.81871814]


portfolio before change:  [-1.44888712]
curr_Stock_Price:  103.35403227782405
curr_Factors:  [103.35403228  -1.15369051  -1.09559244]
mat_Sqrt:  [[10.90124876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01025991 0.16530838 1.61139095]
Stock Position:  0.010259914126642119
Bond Position:  [-2.50929062]


portfolio before change:  [-1.46828967]
curr_Stock_Price:  101.58524618524685
curr_Factors:  [101.58524619  -1.18270867  -1.11272054]
mat_Sqrt:  [[10.23147856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01121047 0.00877109 0.03688327]
Stock Position:  0.011210467914106745
Bond Position:  [-2.60710782]


portfolio before change:  [-1.48359231]
curr_Stock_Price:  100.33652415830184
curr_Factors:  [100.33652416  -0.7647671   -1.13000588]
mat_Sqrt:  [[15.08584369  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00393128 0.00658967 0.07773691]
Stock Position:  0.0039312791171395136
Bond Position:  [-1.87804319]


portfolio before change:  [-1.48729882]
curr_Stock_Price:  99.63261927624346
curr_Factors:  [99.63261928 -1.27790568 -1.1518571 ]
mat_Sqrt:  [[ 8.77342126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00513326 -0.000678   -0.04459434]
Stock Position:  -0.005133257995147329
Bond Position:  [-0.97585888]


portfolio before change:  [-1.48217327]
curr_Stock_Price:  98.53904562692422
curr_Factors:  [98.53904563 -1.33718003 -1.12347629]
mat_Sqrt:  [[ 8.41315492  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355726  0.00371354  0.14167259]
Stock Position:  -0.0035572633233831538
Bond Position:  [-1.13164394]


portfolio before change:  [-1.482717]
curr_Stock_Price:  98.53279583293919
curr_Factors:  [98.53279583 -0.91648096 -1.11113   ]
mat_Sqrt:  [[12.9718092   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036568  -0.03222484  0.16010177]
Stock Position:  -0.003656800130433701
Bond Position:  [-1.12240226]


portfolio before change:  [-1.47885585]
curr_Stock_Price:  97.32340801488522
curr_Factors:  [97.32340801 -0.42214038 -1.08691884]
mat_Sqrt:  [[21.51994805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00563973  0.00030577 -0.13696698]
Stock Position:  -0.005639732151521483
Bond Position:  [-0.9299779]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.47015501]
Stock Price:  95.69816188549714
PL:  [-1.47015501]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.64425186e-01 -2.20806771e-01 -4.38446965e-02]
 [ 1.80198613e-03  1.09910960e-01  9.79413472e-02]
 [-8.30936172e-02  3.14996497e-01  4.16603396e-01]
 [ 1.05446049e-01  2.65757518e-02  1.26099501e-02]
 [ 4.97816015e-02  1.90963670e-02  2.73091683e-02]
 [-4.81271074e-02  1.70034347e-02 -1.80034933e-02]
 [-2.93475182e-02  2.79097936e-02  4.48442398e-02]
 [-3.81576328e-02 -1.09522746e-01  6.39319056e-02]
 [ 1.27315286e-02 -7.56066289e-02 -1.06623401e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.97811051]
curr_Stock_Price:  99.43431575515844
curr_Factors:  [99.43431576 -0.82029407 -1.07583619]
mat_Sqrt:  [[14.9299167   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06151722 -0.07126508 -0.12507672]
Stock Position:  -0.06151721800501964
Bond Position:  [4.13881197]


portfolio before change:  [-2.01106873]
curr_Stock_Price:  100.00371956283296
curr_Factors:  [100.00371956  -1.49762093  -1.11350703]
mat_Sqrt:  [[ 7.34543782  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00602138 0.03547361 0.2793994 ]
Stock Position:  0.0060213784149066515
Bond Position:  [-2.61322897]


portfolio before change:  [-2.00444211]
curr_Stock_Price:  101.3212845803454
curr_Factors:  [101.32128458  -1.2907791   -1.13855464]
mat_Sqrt:  [[ 8.92594994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00742146 0.10166468 1.18845353]
Stock Position:  0.007421460578252929
Bond Position:  [-2.75639403]


portfolio before change:  [-2.00735929]
curr_Stock_Price:  101.11396160166949
curr_Factors:  [101.1139616   -1.17797252  -1.16308964]
mat_Sqrt:  [[ 9.72972907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0116596  0.00857729 0.03597268]
Stock Position:  0.011659604867688298
Bond Position:  [-3.18630813]


portfolio before change:  [-2.02850606]
curr_Stock_Price:  99.4369563370521
curr_Factors:  [99.43695634 -0.97567168 -1.12196165]
mat_Sqrt:  [[12.20554682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00485469 0.00616333 0.07790546]
Stock Position:  0.004854685547849666
Bond Position:  [-2.51124122]


portfolio before change:  [-2.03715257]
curr_Stock_Price:  97.91459710207972
curr_Factors:  [97.9145971  -1.37504164 -1.07861495]
mat_Sqrt:  [[ 8.41856216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00574103  0.00548783 -0.05135896]
Stock Position:  -0.005741033043552472
Bond Position:  [-1.47502164]


portfolio before change:  [-2.03650756]
curr_Stock_Price:  97.67375075479518
curr_Factors:  [97.67375075 -1.51964932 -1.08919575]
mat_Sqrt:  [[ 7.19069464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00201603  0.00900785  0.12792813]
Stock Position:  -0.00201603099943218
Bond Position:  [-1.83959425]


portfolio before change:  [-2.03617977]
curr_Stock_Price:  97.0547994142088
curr_Factors:  [97.05479941 -0.99086336 -1.04971154]
mat_Sqrt:  [[12.61265729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00376319 -0.03534831  0.18237993]
Stock Position:  -0.003763189866528491
Bond Position:  [-1.67094413]


portfolio before change:  [-2.03095814]
curr_Stock_Price:  95.44517989006013
curr_Factors:  [95.44517989 -1.1365513  -1.04126161]
mat_Sqrt:  [[10.81289205  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226267 -0.02440193 -0.30416688]
Stock Position:  -0.00226267129577618
Bond Position:  [-1.81499707]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.0283892]
Stock Price:  93.9086496656346
PL:  [-2.0283892]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-6.10525531e-01 -1.13652693e-01 -6.78393285e-02]
 [ 2.21122756e-02  6.44871577e-02 -3.07225932e-02]
 [-4.29449023e-02  1.31951402e-01  1.53219734e-01]
 [ 1.49618667e-01  7.70375081e-02  8.69110114e-02]
 [ 5.45936329e-02 -3.02797943e-02  6.53197586e-02]
 [-1.03239480e-01 -5.84058385e-02  1.47063754e-02]
 [-3.32747395e-02  3.96749733e-02  5.28512222e-02]
 [-3.81455515e-02 -1.10693307e-01  6.59955571e-02]
 [-1.09529974e-01 -6.29898579e-03 -5.15759686e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.97126765]
curr_Stock_Price:  98.34344371657497
curr_Factors:  [98.34344372 -1.19493993 -1.09784436]
mat_Sqrt:  [[ 9.93120274  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06520584 -0.03668125 -0.19352672]
Stock Position:  -0.06520584176173447
Bond Position:  [-3.55870062]


portfolio before change:  [-9.97452713]
curr_Stock_Price:  98.36613616089674
curr_Factors:  [98.36613616 -0.91905964 -1.15291702]
mat_Sqrt:  [[12.38789681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234135  0.02081314 -0.08764301]
Stock Position:  0.0023413529299677097
Bond Position:  [-10.20483697]


portfolio before change:  [-9.98003528]
curr_Stock_Price:  98.19338960638804
curr_Factors:  [98.19338961 -1.48480766 -1.19226836]
mat_Sqrt:  [[ 6.75216283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00226082 0.04258713 0.43709325]
Stock Position:  0.0022608181090952293
Bond Position:  [-10.20203267]


portfolio before change:  [-9.98553467]
curr_Stock_Price:  98.01774433468
curr_Factors:  [98.01774433 -1.28735043 -1.21474266]
mat_Sqrt:  [[ 8.02896345  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02280301 0.02486375 0.24793292]
Stock Position:  0.022803008118218077
Bond Position:  [-12.22063409]


portfolio before change:  [-10.02415807]
curr_Stock_Price:  96.59198705208097
curr_Factors:  [96.59198705 -0.9875111  -1.22902815]
mat_Sqrt:  [[10.52713847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00586542 -0.00977276  0.18633909]
Stock Position:  0.005865424479813081
Bond Position:  [-10.59071108]


portfolio before change:  [-10.02795655]
curr_Stock_Price:  96.84741646927853
curr_Factors:  [96.84741647 -0.82888027 -1.21106826]
mat_Sqrt:  [[12.59359291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00890608 -0.0188504   0.0419532 ]
Stock Position:  -0.008906083969694655
Bond Position:  [-9.16542533]


portfolio before change:  [-10.04321881]
curr_Stock_Price:  98.04641763575222
curr_Factors:  [98.04641764 -0.85219881 -1.28063078]
mat_Sqrt:  [[11.61864831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00123835  0.01280504  0.15076983]
Stock Position:  -0.0012383461948612465
Bond Position:  [-9.92180341]


portfolio before change:  [-10.0474176]
curr_Stock_Price:  97.42998279662199
curr_Factors:  [97.4299828  -0.85504085 -1.28731838]
mat_Sqrt:  [[11.43609712  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00413335 -0.03572611  0.18826695]
Stock Position:  -0.004133354330807542
Bond Position:  [-9.64470496]


portfolio before change:  [-10.05090131]
curr_Stock_Price:  97.10582942472237
curr_Factors:  [97.10582942 -0.58762387 -1.285169  ]
mat_Sqrt:  [[14.92456548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00813046 -0.00203299 -0.14713188]
Stock Position:  -0.008130464520314113
Bond Position:  [-9.26138581]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.07714118]
Stock Price:  99.76348935391496
PL:  [-10.07714118]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.30560372e+00 -3.26086265e-01 -2.95580690e-02]
 [ 1.18959956e-01 -3.45076879e-02  7.29132578e-02]
 [-4.28147714e-02  3.01895832e-01  2.38226168e-01]
 [ 2.79000572e-01  2.41546916e-01  3.45354753e-01]
 [ 8.55315117e-03 -1.67639119e-01  1.52970000e-01]
 [-6.27085345e-02  1.23591914e-01 -3.91486977e-02]
 [ 1.87744314e-01  4.52156898e-01  2.48012439e-01]
 [-3.95849586e-02 -1.16522480e-01  3.69505479e-02]
 [-6.04949049e-02 -1.35964331e-01 -1.10406726e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.52071954]
curr_Stock_Price:  100.8671513602241
curr_Factors:  [100.86715136  -0.60020768  -0.94050626]
mat_Sqrt:  [[21.60857824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06378019 -0.10524389 -0.08432094]
Stock Position:  -0.06378019413943462
Bond Position:  [14.95404603]


portfolio before change:  [8.88265654]
curr_Stock_Price:  95.30965640039764
curr_Factors:  [ 9.53096564e+01  9.48757905e-02 -9.88169078e-01]
mat_Sqrt:  [[39.01077324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00325037 -0.01113731  0.20800123]
Stock Position:  0.00325037032727477
Bond Position:  [8.57286486]


portfolio before change:  [8.88195333]
curr_Stock_Price:  93.77422871815943
curr_Factors:  [93.77422872 -0.61025089 -1.02330029]
mat_Sqrt:  [[18.30801409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00368348 0.09743646 0.67959295]
Stock Position:  0.003683478155913263
Bond Position:  [8.53653801]


portfolio before change:  [8.88656038]
curr_Stock_Price:  93.86591263103759
curr_Factors:  [93.86591263 -0.6098283  -0.95809912]
mat_Sqrt:  [[19.56886701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02037938 0.07795893 0.98520098]
Stock Position:  0.020379379797480338
Bond Position:  [6.9736313]


portfolio before change:  [8.8297624]
curr_Stock_Price:  90.90774259395461
curr_Factors:  [90.90774259 -0.11167079 -0.99537119]
mat_Sqrt:  [[30.04821323  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.84997014e-04 -5.41052931e-02  4.36380831e-01]
Stock Position:  0.00018499701380354024
Bond Position:  [8.81294474]


portfolio before change:  [8.83364946]
curr_Stock_Price:  88.09407215925452
curr_Factors:  [88.09407216 -0.36636408 -0.94679   ]
mat_Sqrt:  [[23.69469454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191906  0.03988912 -0.11168034]
Stock Position:  -0.0019190639912295385
Bond Position:  [9.00270762]


portfolio before change:  [8.83084269]
curr_Stock_Price:  91.90282632748378
curr_Factors:  [91.90282633 -0.5140658  -0.99430953]
mat_Sqrt:  [[20.33526262  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01626071 0.14593301 0.70751045]
Stock Position:  0.016260708685695575
Bond Position:  [7.33643761]


portfolio before change:  [8.87000086]
curr_Stock_Price:  94.08532850789527
curr_Factors:  [94.08532851 -0.73467608 -0.98141959]
mat_Sqrt:  [[16.91340403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330079 -0.03760747  0.10540963]
Stock Position:  -0.003300785057504004
Bond Position:  [9.18055631]


portfolio before change:  [8.87302616]
curr_Stock_Price:  94.55979854404222
curr_Factors:  [94.55979854 -0.64041452 -0.9674656 ]
mat_Sqrt:  [[18.94144351  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00584882 -0.0438823  -0.31495966]
Stock Position:  -0.005848824898033517
Bond Position:  [9.42608987]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.8912141]
Stock Price:  92.25613672198784
PL:  [8.8912141]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.23465545e+00 -3.15004757e-01 -1.95405100e-02]
 [-3.50000151e-03  1.22599822e-01  1.18910616e-01]
 [-1.21327887e-01  6.04427244e-01  6.84686527e-01]
 [ 1.08022092e-01  2.80253242e-02  1.33804973e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 2.62942765e-02  2.70914164e-02 -4.47326424e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-1.42974743e-02 -3.91076884e-02  1.35039719e-03]
 [ 8.70551486e-02  8.59326589e-02 -6.10391971e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.51328609]
curr_Stock_Price:  100.59318539352459
curr_Factors:  [100.59318539  -0.64052644  -0.98499728]
mat_Sqrt:  [[19.79760159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06581324 -0.10166735 -0.05574364]
Stock Position:  -0.06581323579803709
Bond Position:  [13.13364912]


portfolio before change:  [6.51480406]
curr_Stock_Price:  100.66992513105563
curr_Factors:  [100.66992513  -0.70338566  -0.98421756]
mat_Sqrt:  [[18.62014163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0024596  0.03956892 0.33921889]
Stock Position:  0.0024596005258233243
Bond Position:  [6.26719626]


portfolio before change:  [6.5237026]
curr_Stock_Price:  103.01346057037249
curr_Factors:  [103.01346057  -0.64402923  -1.02385685]
mat_Sqrt:  [[19.4330182   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00729744 0.19507805 1.95322008]
Stock Position:  0.007297443859479263
Bond Position:  [5.77196766]


portfolio before change:  [6.52104963]
curr_Stock_Price:  102.25433393021608
curr_Factors:  [102.25433393  -0.93011586  -0.9800311 ]
mat_Sqrt:  [[15.13963623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00769332 0.00904513 0.03817083]
Stock Position:  0.00769331691379971
Bond Position:  [5.73437463]


portfolio before change:  [6.5249951]
curr_Stock_Price:  102.39439974522298
curr_Factors:  [102.39439975  -1.2665729   -0.95797632]
mat_Sqrt:  [[11.07048766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00526818 -0.00140152  0.08089603]
Stock Position:  0.005268177630876683
Bond Position:  [5.98556321]


portfolio before change:  [6.52755826]
curr_Stock_Price:  102.31270713110416
curr_Factors:  [102.31270713  -1.47494308  -0.98385083]
mat_Sqrt:  [[ 8.75163003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00259303  0.00874372 -0.12760978]
Stock Position:  0.0025930342425661045
Bond Position:  [6.26225791]


portfolio before change:  [6.52804551]
curr_Stock_Price:  101.29279544902761
curr_Factors:  [101.29279545  -1.04285506  -1.00260309]
mat_Sqrt:  [[13.0992783   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366426 -0.01197701  0.13962421]
Stock Position:  -0.0036642590488572893
Bond Position:  [6.89920855]


portfolio before change:  [6.53373399]
curr_Stock_Price:  100.68202594216042
curr_Factors:  [100.68202594  -1.31611831  -1.02759225]
mat_Sqrt:  [[ 9.66254173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227731 -0.01262195  0.00385231]
Stock Position:  -0.002277314781510597
Bond Position:  [6.76301866]


portfolio before change:  [6.53440621]
curr_Stock_Price:  101.87208311792914
curr_Factors:  [101.87208312  -1.32755069  -1.03118892]
mat_Sqrt:  [[ 9.63091587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01073108  0.02773465 -0.01741278]
Stock Position:  0.01073107928121422
Bond Position:  [5.44120881]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.54520562]
Stock Price:  102.6248612336149
PL:  [3.92034438]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-5.60501210e-01 -8.03818147e-02 -9.25860448e-02]
 [ 2.29111897e-02  6.20528553e-02 -2.59511713e-02]
 [-7.27062937e-02  3.87152442e-01  4.09025259e-01]
 [ 1.62107208e-01  8.98278136e-02  1.04395380e-01]
 [ 4.77176108e-02  2.63379342e-02  3.87909869e-02]
 [-1.07337997e-01 -6.22253053e-02  1.67179742e-02]
 [ 1.77903781e-01  4.40517227e-01  2.44455795e-01]
 [-4.04089985e-02 -1.16739162e-01  2.26474579e-02]
 [-3.05629176e-02 -2.63358991e-01 -1.50843861e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.36458939]
curr_Stock_Price:  98.56271632156009
curr_Factors:  [98.56271632 -1.66683258 -0.96801817]
mat_Sqrt:  [[ 7.0698716   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08427425 -0.02594312 -0.26412221]
Stock Position:  -0.08427425000597993
Bond Position:  [-0.05829039]


portfolio before change:  [-8.33665409]
curr_Stock_Price:  98.23088954086394
curr_Factors:  [98.23088954 -1.56732365 -0.94752972]
mat_Sqrt:  [[ 7.94440067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00381154  0.02002747 -0.07403147]
Stock Position:  0.0038115417789117917
Bond Position:  [-8.71106523]


portfolio before change:  [-8.342515]
curr_Stock_Price:  97.83622303268935
curr_Factors:  [97.83622303 -0.79092736 -0.84731219]
mat_Sqrt:  [[19.01171439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00472408 0.12495291 1.16683521]
Stock Position:  0.004724076805879846
Bond Position:  [-8.80470083]


portfolio before change:  [-8.34625637]
curr_Stock_Price:  97.97637410793944
curr_Factors:  [97.97637411 -0.92183222 -0.8653644 ]
mat_Sqrt:  [[16.40407462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01229895 0.0289918  0.29781096]
Stock Position:  0.012298947445380702
Bond Position:  [-9.55126264]


portfolio before change:  [-8.35940361]
curr_Stock_Price:  97.2957943729139
curr_Factors:  [97.29579437 -0.72891041 -0.87037392]
mat_Sqrt:  [[19.65774554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00310371 0.00850053 0.11065989]
Stock Position:  0.0031037127836726747
Bond Position:  [-8.66138181]


portfolio before change:  [-8.36937731]
curr_Stock_Price:  95.47799506995756
curr_Factors:  [ 9.54779951e+01  4.62690808e-03 -8.79271795e-01]
mat_Sqrt:  [[39.81528628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00292921 -0.02008313  0.04769173]
Stock Position:  -0.002929205167827566
Bond Position:  [-8.08970267]


portfolio before change:  [-8.36444327]
curr_Stock_Price:  92.41235165437138
curr_Factors:  [ 9.24123517e+01 -4.35690132e-02 -8.44109973e-01]
mat_Sqrt:  [[38.03784782  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00835282 0.14217632 0.69736434]
Stock Position:  0.008352820476284807
Bond Position:  [-9.13634706]


portfolio before change:  [-8.36280558]
curr_Stock_Price:  93.15545474506128
curr_Factors:  [93.15545475 -0.33022128 -0.84162264]
mat_Sqrt:  [[28.85911045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206574 -0.0376774   0.06460689]
Stock Position:  -0.0020657389033689405
Bond Position:  [-8.17037073]


portfolio before change:  [-8.3647088]
curr_Stock_Price:  92.09869675309199
curr_Factors:  [92.09869675 -0.56244156 -0.82735836]
mat_Sqrt:  [[22.94410122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00501705 -0.08499875 -0.43031555]
Stock Position:  -0.005017050771578296
Bond Position:  [-7.90264496]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.37492715]
Stock Price:  93.34764441008099
PL:  [-8.37492715]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.05459026e+00 -2.54545583e-01 -6.21959739e-02]
 [ 1.15100946e-02  8.79652187e-02  3.99888994e-02]
 [-7.91828198e-02  3.07755105e-01  3.96756753e-01]
 [ 1.04598589e-01  2.60988758e-02  1.23564578e-02]
 [ 5.33844883e-02 -4.11850043e-03  2.83474773e-02]
 [ 2.45985681e-02  1.14272359e-01 -6.09374087e-02]
 [-5.04211372e-02 -3.42279134e-02  4.92213047e-02]
 [-3.86387291e-02 -9.70927455e-02  5.37213039e-02]
 [-2.87146978e-02 -8.61238970e-02 -1.00233806e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.46211507]
curr_Stock_Price:  100.72267753132536
curr_Factors:  [100.72267753  -1.2320161   -0.92350275]
mat_Sqrt:  [[11.66802419  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09592411 -0.08215423 -0.1774278 ]
Stock Position:  -0.09592411215024815
Bond Position:  [17.12384848]


portfolio before change:  [7.59375545]
curr_Stock_Price:  99.43961831064166
curr_Factors:  [99.43961831 -1.33100704 -0.95866781]
mat_Sqrt:  [[10.07317306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00373553 0.02839065 0.1140772 ]
Stock Position:  0.0037355279545148268
Bond Position:  [7.22229597]


portfolio before change:  [7.60084785]
curr_Stock_Price:  100.37130713020854
curr_Factors:  [100.37130713  -1.3837001   -0.95624753]
mat_Sqrt:  [[ 9.66903731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00668371 0.09932753 1.13183658]
Stock Position:  0.006683712030479214
Bond Position:  [6.92999494]


portfolio before change:  [7.60835612]
curr_Stock_Price:  100.97612223586691
curr_Factors:  [100.97612224  -1.67060682  -0.94214541]
mat_Sqrt:  [[ 7.40482521  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01518581 0.00842338 0.03524953]
Stock Position:  0.015185807671942468
Bond Position:  [6.07495215]


portfolio before change:  [7.60572391]
curr_Stock_Price:  100.6027175565383
curr_Factors:  [100.60271756  -1.33147978  -0.94508386]
mat_Sqrt:  [[10.32549035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00564915 -0.00132924  0.08086746]
Stock Position:  0.005649146479479847
Bond Position:  [7.03740442]


portfolio before change:  [7.60695748]
curr_Stock_Price:  100.19805239460743
curr_Factors:  [100.19805239  -1.64492247  -0.88018295]
mat_Sqrt:  [[ 8.02084144  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00442416  0.03688125 -0.17383747]
Stock Position:  0.004424164162408732
Bond Position:  [7.16366484]


portfolio before change:  [7.60909236]
curr_Stock_Price:  99.87079423130783
curr_Factors:  [99.87079423 -1.03425233 -0.83345917]
mat_Sqrt:  [[15.42771848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306984 -0.01104701  0.14041468]
Stock Position:  -0.003069839789598132
Bond Position:  [7.9156797]


portfolio before change:  [7.61814164]
curr_Stock_Price:  98.21258035990186
curr_Factors:  [98.21258036 -0.96645436 -0.77464405]
mat_Sqrt:  [[17.21938706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275805 -0.03133655  0.15325193]
Stock Position:  -0.0027580475082084424
Bond Position:  [7.8890166]


portfolio before change:  [7.63006964]
curr_Stock_Price:  95.31832005598751
curr_Factors:  [95.31832006 -0.66732086 -0.75925319]
mat_Sqrt:  [[22.88880615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291648 -0.02779637 -0.28593915]
Stock Position:  -0.0029164825865990143
Bond Position:  [7.90806386]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.62898082]
Stock Price:  97.04774654800956
PL:  [7.62898082]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.80586030e-01 -2.35421195e-01 -1.09282483e-04]
 [-9.04987395e-03  1.42757465e-01  1.84680682e-01]
 [-1.36899729e-01  7.15745340e-01  7.74076965e-01]
 [ 1.18408245e-01  3.38697455e-02  1.64872084e-02]
 [-1.70986261e-02 -8.44681087e-02 -8.59356301e-02]
 [ 8.41446188e-03  3.43038217e-02 -4.10598380e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 8.58486689e-03  1.38838345e-02 -4.44550289e-02]
 [ 1.11019780e-01  3.95600041e-02  3.08433346e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.759001]
curr_Stock_Price:  98.50888870573215
curr_Factors:  [98.50888871 -0.38465475 -1.00955234]
mat_Sqrt:  [[24.43312268  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03800838 -0.07598186 -0.00031175]
Stock Position:  -0.03800838312115655
Bond Position:  [-5.01483741]


portfolio before change:  [-8.87997371]
curr_Stock_Price:  101.62569237933423
curr_Factors:  [101.62569238  -0.11720256  -1.03167352]
mat_Sqrt:  [[32.21461751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00179385 0.04607477 0.52684258]
Stock Position:  0.0017938489551922844
Bond Position:  [-9.06227485]


portfolio before change:  [-8.88050496]
curr_Stock_Price:  103.8561008010628
curr_Factors:  [103.8561008   -0.36307573  -1.00139149]
mat_Sqrt:  [[26.536976    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00630098 0.23100582 2.20822612]
Stock Position:  0.006300980760526345
Bond Position:  [-9.53490026]


portfolio before change:  [-8.87706337]
curr_Stock_Price:  105.15910958621632
curr_Factors:  [105.15910959  -0.39521286  -0.99078706]
mat_Sqrt:  [[26.29751935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00489352 0.01093141 0.04703342]
Stock Position:  0.004893515359626662
Bond Position:  [-9.39166109]


portfolio before change:  [-8.88644343]
curr_Stock_Price:  104.20211886431186
curr_Factors:  [ 1.04202119e+02 -4.01076943e-02 -9.63834370e-01]
mat_Sqrt:  [[38.18300036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135878 -0.02726196 -0.24515043]
Stock Position:  -0.0013587759773922964
Bond Position:  [-8.74485609]


portfolio before change:  [-8.887224]
curr_Stock_Price:  101.55786279208604
curr_Factors:  [101.55786279  -0.15799279  -0.89591211]
mat_Sqrt:  [[35.40042479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00019874  0.01107151 -0.11713229]
Stock Position:  0.00019873761042762212
Bond Position:  [-8.90740736]


portfolio before change:  [-8.89113121]
curr_Stock_Price:  104.31329979673268
curr_Factors:  [104.3132998   -0.87922677  -0.93883053]
mat_Sqrt:  [[16.93430695  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283443 -0.01197701  0.13962421]
Stock Position:  -0.002834432445167471
Bond Position:  [-8.5954622]


portfolio before change:  [-8.89520818]
curr_Stock_Price:  104.23503575013964
curr_Factors:  [104.23503575  -1.40916726  -0.96903683]
mat_Sqrt:  [[ 9.66435348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0002426   0.00448099 -0.12681782]
Stock Position:  0.0002425974971437206
Bond Position:  [-8.92049534]


portfolio before change:  [-8.8994581]
curr_Stock_Price:  105.10660069662005
curr_Factors:  [105.1066007   -0.74408324  -0.97627241]
mat_Sqrt:  [[18.81434154  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00666464 0.01276794 0.08798745]
Stock Position:  0.006664639370852113
Bond Position:  [-9.59995569]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.90751472]
Stock Price:  104.61813645333575
PL:  [-13.52565117]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.37855657e+00 -3.29247047e-01 -5.71948402e-02]
 [ 1.00287596e-02  1.09023929e-01  1.32012446e-01]
 [-1.53973696e-01  8.52106903e-01  8.28101307e-01]
 [ 1.06535830e-01  2.71889858e-02  1.29359260e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 3.06730121e-02  2.27511518e-02 -4.49401859e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 1.51696206e-02  2.30869481e-02 -5.35610341e-02]
 [ 1.63924194e-01  6.80958949e-02  2.04625748e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.21513135]
curr_Stock_Price:  101.37134894722739
curr_Factors:  [101.37134895  -0.59982928  -0.97320608]
mat_Sqrt:  [[21.02590281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06931634 -0.10626403 -0.16316096]
Stock Position:  -0.06931634315612491
Bond Position:  [19.24182256]


portfolio before change:  [12.26156249]
curr_Stock_Price:  100.84033669143352
curr_Factors:  [100.84033669  -0.20579193  -1.00021113]
mat_Sqrt:  [[30.19074399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00196186 0.03518732 0.37659476]
Stock Position:  0.001961862995462279
Bond Position:  [12.06372756]


portfolio before change:  [12.27831543]
curr_Stock_Price:  106.30431006880212
curr_Factors:  [106.30431007  -0.53941835  -1.01705167]
mat_Sqrt:  [[22.41736337  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00843085 0.27501632 2.36234253]
Stock Position:  0.00843084735490087
Bond Position:  [11.38208002]


portfolio before change:  [12.24495455]
curr_Stock_Price:  101.6721139641471
curr_Factors:  [101.67211396  -1.23975165  -1.00375992]
mat_Sqrt:  [[10.78591909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01063667 0.00877521 0.0369026 ]
Stock Position:  0.01063667289752789
Bond Position:  [11.16350153]


portfolio before change:  [12.25096517]
curr_Stock_Price:  101.71230208922846
curr_Factors:  [101.71230209  -1.31671776  -0.98464457]
mat_Sqrt:  [[10.1836748   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00572694 -0.00140152  0.08089603]
Stock Position:  0.005726940088564128
Bond Position:  [11.66846491]


portfolio before change:  [12.26275481]
curr_Stock_Price:  102.751941736673
curr_Factors:  [102.75194174  -1.41387697  -1.02250568]
mat_Sqrt:  [[ 8.98840215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0029086   0.0073429  -0.12820184]
Stock Position:  0.0029086031172889755
Bond Position:  [11.9638902]


portfolio before change:  [12.27226467]
curr_Stock_Price:  103.96435166182992
curr_Factors:  [103.96435166  -1.17227172  -1.06460991]
mat_Sqrt:  [[11.10245704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432329 -0.01197701  0.13962421]
Stock Position:  -0.004323290679613841
Bond Position:  [12.72173279]


portfolio before change:  [12.28186447]
curr_Stock_Price:  103.2155380569014
curr_Factors:  [103.21553806  -1.36283661  -1.07868067]
mat_Sqrt:  [[ 8.98271454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099626  0.00745128 -0.15279472]
Stock Position:  0.0009962605189921668
Bond Position:  [12.1790349]


portfolio before change:  [12.28798973]
curr_Stock_Price:  103.24988362240968
curr_Factors:  [103.24988362  -1.47921639  -1.11198842]
mat_Sqrt:  [[ 7.73648382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02352504 0.02197786 0.05837403]
Stock Position:  0.023525043124865568
Bond Position:  [9.85903176]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.28685128]
Stock Price:  102.99189504820103
PL:  [9.29495623]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.16806168e+00 -2.79930837e-01 -6.20854032e-02]
 [-2.93816306e-02  1.79977828e-01  2.68795797e-01]
 [-7.43611985e-02  2.76210211e-01  3.60247982e-01]
 [ 1.02483740e-01  2.49088230e-02  1.17238630e-02]
 [ 5.19588095e-02  5.06772901e-03  2.79366137e-02]
 [-3.69332217e-02 -6.33949480e-05 -1.83016584e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-8.52016565e-03 -2.92725870e-02 -7.82563774e-03]
 [-5.62426782e-04  8.32765971e-02 -1.98162376e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.91523519]
curr_Stock_Price:  101.19394465729714
curr_Factors:  [101.19394466  -1.14132564  -1.02190311]
mat_Sqrt:  [[11.63258447  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10641448 -0.09034729 -0.17711237]
Stock Position:  -0.10641448243261624
Bond Position:  [21.68373644]


portfolio before change:  [10.80880257]
curr_Stock_Price:  102.29602395817786
curr_Factors:  [102.29602396  -0.86814777  -1.03760246]
mat_Sqrt:  [[15.21254747  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0040903  0.05808759 0.76679959]
Stock Position:  0.004090301245667608
Bond Position:  [10.39038102]


portfolio before change:  [10.8055203]
curr_Stock_Price:  100.22312926668232
curr_Factors:  [100.22312927  -1.37079062  -1.02976269]
mat_Sqrt:  [[ 9.08700784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00611371 0.08914646 1.02768722]
Stock Position:  0.006113705091881702
Bond Position:  [10.19278564]


portfolio before change:  [10.80911462]
curr_Stock_Price:  99.97723117762982
curr_Factors:  [99.97723118 -1.03169963 -1.00470799]
mat_Sqrt:  [[13.04669507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00842829 0.00803929 0.03344492]
Stock Position:  0.008428292007980351
Bond Position:  [9.96647732]


portfolio before change:  [10.82293621]
curr_Stock_Price:  101.0257367272383
curr_Factors:  [101.02573673  -0.91984989  -1.02446407]
mat_Sqrt:  [[14.45530307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0040605  0.0016356  0.07969538]
Stock Position:  0.004060502394154865
Bond Position:  [10.41272097]


portfolio before change:  [10.82511791]
curr_Stock_Price:  100.28051770969252
curr_Factors:  [100.28051771  -0.80688166  -1.01508692]
mat_Sqrt:  [[16.21607202  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.50874395e-03 -2.04606315e-05 -5.22095371e-02]
Stock Position:  -0.0025087439473379107
Bond Position:  [11.07669605]


portfolio before change:  [10.82981894]
curr_Stock_Price:  100.6148310133858
curr_Factors:  [100.61483101  -1.27830657  -1.05057886]
mat_Sqrt:  [[ 9.80031215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00489772 -0.01197701  0.13962421]
Stock Position:  -0.004897716349565263
Bond Position:  [11.32260184]


portfolio before change:  [10.83283991]
curr_Stock_Price:  101.1542146699457
curr_Factors:  [101.15421467  -1.1400766   -1.02716242]
mat_Sqrt:  [[11.58147927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138953 -0.00944769 -0.02232437]
Stock Position:  -0.0013895296697038866
Bond Position:  [10.97339669]


portfolio before change:  [10.8373124]
curr_Stock_Price:  101.88509037381256
curr_Factors:  [101.88509037  -0.74484573  -1.06668742]
mat_Sqrt:  [[16.64837245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0007443   0.02687741 -0.05653021]
Stock Position:  0.0007442988727659637
Bond Position:  [10.76147945]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.84527116]
Stock Price:  105.34697078983542
PL:  [5.49830037]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.14175724e+00 -2.70250455e-01 -7.01027828e-02]
 [-5.90226517e-02  1.86533311e-01  3.73300040e-01]
 [-9.27647966e-02  3.89069619e-01  4.86799024e-01]
 [ 1.03219830e-01  2.53230300e-02  1.19440425e-02]
 [ 4.94202915e-02  2.14244344e-02  2.72050431e-02]
 [-1.06949927e-01 -6.17497681e-02  1.64723708e-02]
 [ 1.14027542e-02  1.24379111e-01  8.88794951e-02]
 [-2.20714966e-02 -6.88515341e-02  2.48702125e-02]
 [-1.27675829e-02  7.18362348e-02 -1.58543780e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.29558167]
curr_Stock_Price:  101.24585272408851
curr_Factors:  [101.24585272  -1.24581097  -1.01367767]
mat_Sqrt:  [[10.57045778  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11458648 -0.08722296 -0.19998373]
Stock Position:  -0.11458648056646835
Bond Position:  [22.8969876]


portfolio before change:  [11.16205575]
curr_Stock_Price:  102.51107421897318
curr_Factors:  [102.51107422  -1.54744259  -1.04984651]
mat_Sqrt:  [[ 7.63453272  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00723723 0.06020337 1.06492111]
Stock Position:  0.0072372278236663735
Bond Position:  [10.42015975]


portfolio before change:  [11.16124968]
curr_Stock_Price:  101.67961685696251
curr_Factors:  [101.67961686  -1.15711261  -1.07741686]
mat_Sqrt:  [[10.88403887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00790342 0.12557168 1.38870212]
Stock Position:  0.007903421008599244
Bond Position:  [10.35763286]


portfolio before change:  [11.15473634]
curr_Stock_Price:  100.20007369815463
curr_Factors:  [100.2000737   -0.60561698  -1.03541478]
mat_Sqrt:  [[19.41677063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00570779 0.00817297 0.03407303]
Stock Position:  0.005707794619319693
Bond Position:  [10.5828149]


portfolio before change:  [11.15688802]
curr_Stock_Price:  99.64976411936455
curr_Factors:  [99.64976412 -0.88303586 -1.03398746]
mat_Sqrt:  [[14.65290139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00405017 0.00691471 0.07760842]
Stock Position:  0.004050170030927123
Bond Position:  [10.75328953]


portfolio before change:  [11.15711474]
curr_Stock_Price:  98.37789913780965
curr_Factors:  [98.37789914 -0.3460114  -0.96926487]
mat_Sqrt:  [[26.40464431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00440044 -0.01992965  0.04699109]
Stock Position:  -0.0044004431709663465
Bond Position:  [11.59002109]


portfolio before change:  [11.16977331]
curr_Stock_Price:  96.81848606035548
curr_Factors:  [96.81848606 -0.37418245 -0.9666454 ]
mat_Sqrt:  [[25.33052258  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00216869 0.04014319 0.25354846]
Stock Position:  0.0021686873881839514
Bond Position:  [10.95980428]


portfolio before change:  [11.18285479]
curr_Stock_Price:  100.3230087632319
curr_Factors:  [100.32300876  -0.43755471  -1.06444826]
mat_Sqrt:  [[22.34029728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138983 -0.02222174  0.07094779]
Stock Position:  -0.0013898269065361249
Bond Position:  [11.32228641]


portfolio before change:  [11.18548917]
curr_Stock_Price:  102.50183067364956
curr_Factors:  [102.50183067  -0.49175957  -1.09350244]
mat_Sqrt:  [[21.00202054  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.38192966e-05  2.31850451e-02 -4.52281273e-02]
Stock Position:  -6.381929657371504e-05
Bond Position:  [11.19203076]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.19105166]
Stock Price:  103.04898698436239
PL:  [8.14206468]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.38534437e+00 -3.18760714e-01 -8.24642596e-02]
 [-5.45806592e-02  2.01720555e-01  3.64861277e-01]
 [-1.00093106e-01  4.75206039e-01  5.70517551e-01]
 [ 1.13690546e-01  3.12150362e-02  1.50760482e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [-1.99127426e-02  1.27330665e-02 -2.68819759e-02]
 [-4.74399716e-02 -3.17361241e-02  4.06255431e-02]
 [ 6.29557394e-03  1.06842277e-02 -4.12891834e-02]
 [ 2.75142563e-01  3.03199958e-02  6.58726605e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.78750042]
curr_Stock_Price:  101.85889066233355
curr_Factors:  [101.85889066  -0.81508132  -1.02783078]
mat_Sqrt:  [[16.12992653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09096409 -0.10287958 -0.23524758]
Stock Position:  -0.09096408919306707
Bond Position:  [25.05300164]


portfolio before change:  [15.67516655]
curr_Stock_Price:  103.23155879373212
curr_Factors:  [103.23155879  -0.53322714  -0.94798081]
mat_Sqrt:  [[23.47102454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00260203 0.06510503 1.04084767]
Stock Position:  0.0026020326851344585
Bond Position:  [15.40655466]


portfolio before change:  [15.67505248]
curr_Stock_Price:  100.22649568803676
curr_Factors:  [100.22649569  -0.44317007  -0.97559446]
mat_Sqrt:  [[24.25609812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00467364 0.15337209 1.62752777]
Stock Position:  0.004673642388643414
Bond Position:  [15.20662968]


portfolio before change:  [15.701454]
curr_Stock_Price:  104.24826365885481
curr_Factors:  [104.24826366  -0.47336902  -0.97907287]
mat_Sqrt:  [[24.39390524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00504797 0.01007461 0.04300777]
Stock Position:  0.0050479688754228105
Bond Position:  [15.17521201]


portfolio before change:  [15.70340526]
curr_Stock_Price:  103.13133036214488
curr_Factors:  [103.13133036  -0.5119219   -0.99117006]
mat_Sqrt:  [[22.94066879  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00254227 -0.00140152  0.08089603]
Stock Position:  0.0025422665738932025
Bond Position:  [15.44121793]


portfolio before change:  [15.70503894]
curr_Stock_Price:  100.73627803802768
curr_Factors:  [100.73627804  -0.55907281  -1.00720652]
mat_Sqrt:  [[21.03581908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108391  0.00410958 -0.07668679]
Stock Position:  -0.0010839072416962373
Bond Position:  [15.81422772]


portfolio before change:  [15.7072464]
curr_Stock_Price:  105.99653794002883
curr_Factors:  [105.99653794  -1.18002078  -1.06838625]
mat_Sqrt:  [[11.18976365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00407743 -0.01024279  0.11589337]
Stock Position:  -0.00407742540286872
Bond Position:  [16.13943937]


portfolio before change:  [15.71959952]
curr_Stock_Price:  104.94651618537263
curr_Factors:  [104.94651619  -1.38162347  -1.03250313]
mat_Sqrt:  [[ 9.38698588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.15218858e-06  3.44831966e-03 -1.17786547e-01]
Stock Position:  5.1521885833565096e-06
Bond Position:  [15.71905881]


portfolio before change:  [15.72746637]
curr_Stock_Price:  105.98655724617286
curr_Factors:  [105.98655725  -1.5709409   -1.04539575]
mat_Sqrt:  [[ 7.74444353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03806314 0.00978574 0.18791637]
Stock Position:  0.03806313595809404
Bond Position:  [11.69328563]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.73592671]
Stock Price:  106.0551861271471
PL:  [9.68074058]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.81772540e-01 -1.93167024e-01 -7.43942244e-03]
 [ 2.90820382e-02  5.74704660e-02 -2.97516762e-02]
 [-6.81824900e-02  2.94373525e-01  3.42960608e-01]
 [ 1.83832317e-01  1.12077874e-01  1.34811248e-01]
 [ 4.88187325e-02  1.42769500e-02  4.90087736e-02]
 [-9.76786245e-02 -5.32235968e-02  1.19770439e-02]
 [ 3.03315770e-03  1.00476155e-01  6.89641429e-02]
 [-4.01853794e-02 -1.14615715e-01  2.70854978e-02]
 [-2.74700581e-02  8.41625995e-02 -3.68673581e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.25914081]
curr_Stock_Price:  98.03120453319464
curr_Factors:  [98.03120453 -0.52793777 -1.00182582]
mat_Sqrt:  [[21.23227122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03874862 -0.06234439 -0.0212226 ]
Stock Position:  -0.03874861766586964
Bond Position:  [-8.46056715]


portfolio before change:  [-12.24339859]
curr_Stock_Price:  97.5157395126219
curr_Factors:  [97.51573951 -0.89179724 -1.03941738]
mat_Sqrt:  [[14.13705231  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00245738  0.01854851 -0.08487325]
Stock Position:  0.002457380199779992
Bond Position:  [-12.48303184]


portfolio before change:  [-12.24618153]
curr_Stock_Price:  98.92379889934912
curr_Factors:  [98.9237989  -1.10337137 -0.97848252]
mat_Sqrt:  [[12.33568097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.005019   0.09500865 0.97837115]
Stock Position:  0.005019000993994989
Bond Position:  [-12.74268018]


portfolio before change:  [-12.25932325]
curr_Stock_Price:  97.57516746863348
curr_Factors:  [97.57516747 -0.61162033 -0.96634028]
mat_Sqrt:  [[20.13908427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01163054 0.03617298 0.38457897]
Stock Position:  0.011630536190436492
Bond Position:  [-13.39417476]


portfolio before change:  [-12.2775889]
curr_Stock_Price:  96.58064005648396
curr_Factors:  [96.58064006 -0.69191001 -0.88096064]
mat_Sqrt:  [[20.0355392   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00308137 0.00460787 0.13980839]
Stock Position:  0.003081368369950086
Bond Position:  [-12.57518943]


portfolio before change:  [-12.28155436]
curr_Stock_Price:  97.33475337120457
curr_Factors:  [97.33475337 -0.8737727  -0.91450821]
mat_Sqrt:  [[16.27898791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00651748 -0.01717784  0.03416717]
Stock Position:  -0.006517483913975494
Bond Position:  [-11.64717667]


portfolio before change:  [-12.28334022]
curr_Stock_Price:  96.71500761792544
curr_Factors:  [96.71500762 -0.54537745 -0.86461218]
mat_Sqrt:  [[23.61256454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00159322 0.03242854 0.1967355 ]
Stock Position:  0.0015932201527325118
Bond Position:  [-12.43742852]


portfolio before change:  [-12.29421239]
curr_Stock_Price:  93.79519817769199
curr_Factors:  [93.79519818 -0.33905724 -0.82971539]
mat_Sqrt:  [[29.14668068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199173 -0.03699206  0.07726739]
Stock Position:  -0.001991733153114144
Bond Position:  [-12.10739739]


portfolio before change:  [-12.31257387]
curr_Stock_Price:  99.97386902121966
curr_Factors:  [99.97386902 -0.55003312 -0.81936995]
mat_Sqrt:  [[25.41922499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070089  0.02716336 -0.10517231]
Stock Position:  -0.0007008851508998197
Bond Position:  [-12.24250367]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.31922941]
Stock Price:  100.73398934402702
PL:  [-13.05321875]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.81037659e-01 -2.09525508e-01 -7.54059514e-02]
 [ 6.91548592e-03  9.83646527e-02  6.72181340e-02]
 [-6.73595102e-02  2.80678349e-01  3.32544737e-01]
 [ 1.02785939e-01  2.50788739e-02  1.18142567e-02]
 [ 4.96280380e-02  1.97956030e-02  2.78435411e-02]
 [-1.07337997e-01 -6.22253053e-02  1.67179742e-02]
 [-3.22848485e-02  4.46556883e-02  5.28066589e-02]
 [ 9.01944767e-04 -1.79780442e-02 -1.95921462e-02]
 [-2.82912917e-02  8.40287483e-02 -3.64271327e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.38514687]
curr_Stock_Price:  100.16627027820807
curr_Factors:  [100.16627028  -1.21449576  -1.074172  ]
mat_Sqrt:  [[10.1570063   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0924681  -0.06762407 -0.21511219]
Stock Position:  -0.09246809754651976
Bond Position:  [12.64733132]


portfolio before change:  [3.43357015]
curr_Stock_Price:  99.7109994620546
curr_Factors:  [99.71099946 -1.39478525 -1.03997323]
mat_Sqrt:  [[ 8.73656871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00466029 0.03174706 0.19175463]
Stock Position:  0.004660288504129836
Bond Position:  [2.96888812]


portfolio before change:  [3.43186959]
curr_Stock_Price:  99.02748574793796
curr_Factors:  [99.02748575 -1.01933975 -1.06911314]
mat_Sqrt:  [[12.26739032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00471283 0.09058855 0.94865757]
Stock Position:  0.0047128302341975
Bond Position:  [2.96516986]


portfolio before change:  [3.43843973]
curr_Stock_Price:  100.10691945211082
curr_Factors:  [100.10691945  -1.17539204  -1.02778115]
mat_Sqrt:  [[11.05702104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00997707 0.00809417 0.03370279]
Stock Position:  0.0099770740094526
Bond Position:  [2.43966559]


portfolio before change:  [3.42775588]
curr_Stock_Price:  98.91378502974518
curr_Factors:  [98.91378503 -1.05887591 -1.02386445]
mat_Sqrt:  [[12.32350297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00481619 0.006389   0.07942987]
Stock Position:  0.004816190470606128
Bond Position:  [2.95136825]


portfolio before change:  [3.42410747]
curr_Stock_Price:  97.84977724681043
curr_Factors:  [97.84977725 -0.6937423  -1.03145385]
mat_Sqrt:  [[17.43077412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00669088 -0.02008313  0.04769173]
Stock Position:  -0.006690875661560344
Bond Position:  [4.07880816]


portfolio before change:  [3.42444252]
curr_Stock_Price:  98.10458221537024
curr_Factors:  [98.10458222 -0.38992499 -1.03613824]
mat_Sqrt:  [[23.56990889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052569  0.01441256  0.1506427 ]
Stock Position:  -0.0005256885069882809
Bond Position:  [3.47601497]


portfolio before change:  [3.42413866]
curr_Stock_Price:  101.98958604560325
curr_Factors:  [101.98958605  -0.55188136  -1.04749646]
mat_Sqrt:  [[20.60415786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032843 -0.00580239 -0.05589094]
Stock Position:  -0.0003284307114882502
Bond Position:  [3.45763517]


portfolio before change:  [3.42645438]
curr_Stock_Price:  100.20389809571546
curr_Factors:  [100.2038981   -0.50235687  -1.00543379]
mat_Sqrt:  [[22.18500107  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083726  0.02712016 -0.10391647]
Stock Position:  -0.0008372617404228655
Bond Position:  [3.51035127]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.42739051]
Stock Price:  101.18267071053974
PL:  [2.2447198]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.44842370e+00 -3.23438887e-01 -1.02265108e-01]
 [-7.73785260e-03  1.36800998e-01  1.61730822e-01]
 [-1.74955962e-01  1.01513151e+00  9.35297021e-01]
 [ 1.66405614e-01  6.08784792e-02  3.08442044e-02]
 [-1.93910772e-01 -2.29545566e-01 -1.37406603e-01]
 [ 1.66554061e-01 -7.60024049e-02 -5.72472116e-02]
 [-2.34164585e-02  1.72045840e-03 -6.23570983e-02]
 [-1.75757448e-04 -2.91670152e-02 -1.15753154e-02]
 [ 8.03374999e-01 -2.57989514e-02  2.19732462e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.1499732]
curr_Stock_Price:  102.31778662444712
curr_Factors:  [102.31778662  -0.8867049   -1.01172177]
mat_Sqrt:  [[15.32762655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10016686 -0.10438945 -0.29173389]
Stock Position:  -0.10016685646784777
Bond Position:  [29.39882425]


portfolio before change:  [19.26095348]
curr_Stock_Price:  101.35661847174234
curr_Factors:  [101.35661847  -0.22120002  -0.96069412]
mat_Sqrt:  [[31.08579714  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00171138 0.04415233 0.46137302]
Stock Position:  0.00171138284412397
Bond Position:  [19.0874935]


portfolio before change:  [19.28201299]
curr_Stock_Price:  108.08414854172067
curr_Factors:  [108.08414854  -0.54892538  -0.90219716]
mat_Sqrt:  [[25.32488572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00881242 0.32763229 2.66814206]
Stock Position:  0.00881242257245548
Bond Position:  [18.3295298]


portfolio before change:  [19.34965481]
curr_Stock_Price:  114.71964066236997
curr_Factors:  [114.71964066  -0.98995493  -0.89741932]
mat_Sqrt:  [[17.37647002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01065397 0.01964844 0.08798993]
Stock Position:  0.010653972181587928
Bond Position:  [18.12743495]


portfolio before change:  [19.35290673]
curr_Stock_Price:  114.1739227264086
curr_Factors:  [114.17392273  -1.18551908  -0.86053375]
mat_Sqrt:  [[14.75629975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01821694 -0.07408551 -0.39198279]
Stock Position:  -0.018216936076960233
Bond Position:  [21.43280578]


portfolio before change:  [19.34785946]
curr_Stock_Price:  115.03940075387365
curr_Factors:  [115.03940075  -1.47320518  -0.83508919]
mat_Sqrt:  [[11.43844805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.012183   -0.02452967 -0.16331036]
Stock Position:  0.012182998645445468
Bond Position:  [17.94633459]


portfolio before change:  [19.36920379]
curr_Stock_Price:  116.05466136054511
curr_Factors:  [116.05466136  -1.22177293  -0.81637513]
mat_Sqrt:  [[15.11841043  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236757  0.00055528 -0.17788744]
Stock Position:  -0.002367567734905022
Bond Position:  [19.64397106]


portfolio before change:  [19.38158511]
curr_Stock_Price:  114.97470019505322
curr_Factors:  [114.9747002   -1.59172892  -0.7874209 ]
mat_Sqrt:  [[10.65002548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079739 -0.00941361 -0.03302115]
Stock Position:  -0.0007973925393137485
Bond Position:  [19.47326508]


portfolio before change:  [19.38993546]
curr_Stock_Price:  116.71627672704038
curr_Factors:  [116.71627673  -1.62205796  -0.85339107]
mat_Sqrt:  [[ 9.81878088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08585195 -0.00832658  0.62683555]
Stock Position:  0.08585195270755003
Bond Position:  [9.36961519]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.36710548]
Stock Price:  116.39577208363896
PL:  [2.9713334]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-9.24551307e-01 -2.28446162e-01 -5.60225870e-02]
 [-3.17008001e-02  1.78631773e-01  2.76283458e-01]
 [-1.25062045e-01  6.45076210e-01  6.84780041e-01]
 [ 1.10845298e-01  2.96139788e-02  1.42249763e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 4.62381995e-02  1.21243531e-02 -4.60707826e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-6.80653683e-04 -1.82840002e-03 -2.97798791e-02]
 [ 7.30129926e-02  8.23073570e-02 -8.53113070e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.02197553]
curr_Stock_Price:  99.98023045944484
curr_Factors:  [99.98023046 -1.04670868 -1.01118047]
mat_Sqrt:  [[12.76980399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07694858 -0.07373068 -0.15981685]
Stock Position:  -0.07694857710816426
Bond Position:  [9.715312]


portfolio before change:  [1.8539039]
curr_Stock_Price:  102.22758187086
curr_Factors:  [102.22758187  -1.04051275  -1.0185584 ]
mat_Sqrt:  [[13.04141907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00468955 0.05765316 0.7881598 ]
Stock Position:  0.004689549677140161
Bond Position:  [1.37450258]


portfolio before change:  [1.863518]
curr_Stock_Price:  104.13110675063122
curr_Factors:  [104.13110675  -0.99321918  -0.97478487]
mat_Sqrt:  [[14.55081048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01006086 0.20819745 1.95348685]
Stock Position:  0.010060863979243473
Bond Position:  [0.8158691]


portfolio before change:  [1.85710122]
curr_Stock_Price:  103.45275394653875
curr_Factors:  [103.45275395  -0.98826882  -0.93271051]
mat_Sqrt:  [[15.15204781  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00790612 0.00955787 0.0405799 ]
Stock Position:  0.007906118640456662
Bond Position:  [1.03919148]


portfolio before change:  [1.85232204]
curr_Stock_Price:  102.78252552363918
curr_Factors:  [102.78252552  -0.62180376  -0.88757393]
mat_Sqrt:  [[22.71981975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00256698 -0.00140152  0.08089603]
Stock Position:  0.002566978792169601
Bond Position:  [1.58848148]


portfolio before change:  [1.85744435]
curr_Stock_Price:  104.4685013918712
curr_Factors:  [104.46850139  -0.80660729  -0.86745913]
mat_Sqrt:  [[19.5860815   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00200698  0.00391312 -0.13142712]
Stock Position:  0.0020069820314797438
Bond Position:  [1.64777794]


portfolio before change:  [1.85746819]
curr_Stock_Price:  104.06976570137543
curr_Factors:  [ 1.04069766e+02 -9.61453024e-02 -8.35333480e-01]
mat_Sqrt:  [[41.00043661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011707  -0.01197701  0.13962421]
Stock Position:  -0.0011706984857515269
Bond Position:  [1.9793025]


portfolio before change:  [1.85390406]
curr_Stock_Price:  107.95976842885557
curr_Factors:  [107.95976843  -0.37292757  -0.81384185]
mat_Sqrt:  [[32.9499327   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00021647 -0.00059011 -0.08495371]
Stock Position:  -0.00021646983955353683
Bond Position:  [1.8772741]


portfolio before change:  [1.85614168]
curr_Stock_Price:  101.96012608521374
curr_Factors:  [101.96012609  -1.28964184  -0.73415794]
mat_Sqrt:  [[13.47427124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00653635  0.02656459 -0.02433694]
Stock Position:  0.006536346213624776
Bond Position:  [1.18969499]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.8588984]
Stock Price:  102.2908492172942
PL:  [-0.43195082]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.17711416e+00 -2.84093942e-01 -5.75752072e-02]
 [-7.78608054e-02  2.08150337e-01  4.47859348e-01]
 [-1.13402678e-01  5.58056747e-01  6.17952604e-01]
 [ 1.05183684e-01  2.64281161e-02  1.25314716e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [-3.25777084e-02  7.01352242e-03 -2.03220973e-02]
 [-3.61652618e-02  2.28375382e-02  4.76898514e-02]
 [-3.83331376e-02 -1.05080512e-01  6.12135070e-02]
 [-7.79376854e-02  3.15187155e-02 -4.56945513e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.61222407]
curr_Stock_Price:  101.15259098932059
curr_Factors:  [101.15259099  -1.12214381  -0.98827944]
mat_Sqrt:  [[12.25834502  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10171496 -0.09169093 -0.16424604]
Stock Position:  -0.10171496111395462
Bond Position:  [20.90095592]


portfolio before change:  [10.38696318]
curr_Stock_Price:  103.46998829035435
curr_Factors:  [103.46998829  -0.94908956  -0.9637572 ]
mat_Sqrt:  [[15.27832014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00366838 0.06718023 1.27761806]
Stock Position:  0.0036683752023433775
Bond Position:  [10.00739644]


portfolio before change:  [10.39076794]
curr_Stock_Price:  103.14281521764252
curr_Factors:  [103.14281522  -1.23672384  -0.88294211]
mat_Sqrt:  [[12.38453649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0102264  0.18011204 1.76284677]
Stock Position:  0.010226400111736388
Bond Position:  [9.33598824]


portfolio before change:  [10.374903]
curr_Stock_Price:  101.13486518255353
curr_Factors:  [101.13486518  -1.16646686  -0.95884498]
mat_Sqrt:  [[12.07507105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00936941 0.00852964 0.0357488 ]
Stock Position:  0.009369408791948327
Bond Position:  [9.4273291]


portfolio before change:  [10.3856557]
curr_Stock_Price:  101.77928778370755
curr_Factors:  [101.77928778  -1.32383947  -1.048877  ]
mat_Sqrt:  [[ 9.48859118  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00614647 -0.00140152  0.08089603]
Stock Position:  0.006146465198486856
Bond Position:  [9.76007285]


portfolio before change:  [10.37695706]
curr_Stock_Price:  99.56990438546856
curr_Factors:  [99.56990439 -1.32810121 -1.07391244]
mat_Sqrt:  [[ 9.01460739  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391524  0.0022636  -0.05797329]
Stock Position:  -0.003915235386772325
Bond Position:  [10.76679667]


portfolio before change:  [10.38792456]
curr_Stock_Price:  98.14399762804659
curr_Factors:  [98.14399763 -1.21606589 -1.08646539]
mat_Sqrt:  [[ 9.81492788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221794  0.00737078  0.13604587]
Stock Position:  -0.002217939751666184
Bond Position:  [10.60560204]


portfolio before change:  [10.39325853]
curr_Stock_Price:  98.1305431222206
curr_Factors:  [98.13054312 -0.67192482 -1.10208525]
mat_Sqrt:  [[16.64797513  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284043 -0.03391459  0.1746251 ]
Stock Position:  -0.0028404326705554293
Bond Position:  [10.67199173]


portfolio before change:  [10.39993694]
curr_Stock_Price:  97.65840244472477
curr_Factors:  [97.65840244 -0.64991307 -1.12312208]
mat_Sqrt:  [[16.58403605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00487404  0.01017262 -0.13035384]
Stock Position:  -0.0048740436598766045
Bond Position:  [10.87592826]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.40956141]
Stock Price:  96.79974362618715
PL:  [10.40956141]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.10599620e-01 -1.49270621e-01 -7.86835152e-02]
 [ 2.29980290e-02  6.25529112e-02 -3.70433925e-02]
 [-4.82373425e-02  2.09226905e-01  2.14766957e-01]
 [ 2.07656976e-01  1.57159058e-01  2.18124943e-01]
 [ 9.82644395e-03 -1.02853642e-01  1.73371481e-01]
 [-4.75663671e-02  1.29044901e-02 -1.71903377e-02]
 [ 5.63899503e-02  2.01448779e-01  1.22060561e-01]
 [-3.96482339e-02 -1.19639855e-01  3.59106259e-02]
 [-1.77612856e-01 -6.92323312e-02 -4.98164463e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.38699816]
curr_Stock_Price:  99.24203677048791
curr_Factors:  [99.24203677 -1.32258167 -1.05639692]
mat_Sqrt:  [[ 9.1942942   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08234787 -0.04817689 -0.22446217]
Stock Position:  -0.08234787214046194
Bond Position:  [4.78537239]


portfolio before change:  [-3.25810191]
curr_Stock_Price:  97.70583480262549
curr_Factors:  [97.7058348  -1.1620812  -1.03057054]
mat_Sqrt:  [[10.90596115  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00258621  0.02018887 -0.10567449]
Stock Position:  0.0025862129254323866
Bond Position:  [-3.51079001]


portfolio before change:  [-3.26245068]
curr_Stock_Price:  96.70323712806233
curr_Factors:  [96.70323713 -1.21742901 -1.00131266]
mat_Sqrt:  [[10.51607677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.003643   0.06752769 0.61267035]
Stock Position:  0.0036429975782444725
Bond Position:  [-3.61474034]


portfolio before change:  [-3.26761464]
curr_Stock_Price:  95.78197934100803
curr_Factors:  [95.78197934 -1.2383357  -0.9942367 ]
mat_Sqrt:  [[10.27282604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02767121 0.05072287 0.62224975]
Stock Position:  0.027671207633854684
Bond Position:  [-5.91801768]


portfolio before change:  [-3.34190072]
curr_Stock_Price:  93.20434204840424
curr_Factors:  [93.20434205 -0.98454754 -0.9875202 ]
mat_Sqrt:  [[12.97113575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186729 -0.03319587  0.49458058]
Stock Position:  0.0018672873403644131
Bond Position:  [-3.51594001]


portfolio before change:  [-3.34194156]
curr_Stock_Price:  94.12416337907932
curr_Factors:  [94.12416338 -0.82785055 -1.01421732]
mat_Sqrt:  [[14.91767759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324724  0.00416491 -0.04903925]
Stock Position:  -0.0032472354863604777
Bond Position:  [-3.03629824]


portfolio before change:  [-3.34733301]
curr_Stock_Price:  95.31684593901045
curr_Factors:  [95.31684594 -0.71158867 -1.01028513]
mat_Sqrt:  [[17.03606823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00718628 0.06501731 0.3482048 ]
Stock Position:  0.0071862836037575985
Bond Position:  [-4.0323069]


portfolio before change:  [-3.36125763]
curr_Stock_Price:  93.65980659958294
curr_Factors:  [93.6598066  -0.61414647 -1.01734317]
mat_Sqrt:  [[18.32341041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309655 -0.0386136   0.10244302]
Stock Position:  -0.003096551890514222
Bond Position:  [-3.07123517]


portfolio before change:  [-3.37106093]
curr_Stock_Price:  96.32964891739223
curr_Factors:  [96.32964892  0.11409578 -1.00727338]
mat_Sqrt:  [[39.4328234   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00512044 -0.02234464 -0.14211246]
Stock Position:  -0.005120444557498805
Bond Position:  [-2.87781031]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.39469216]
Stock Price:  100.66364096747965
PL:  [-4.05833313]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-6.84129665e-01 -1.38845272e-01 -7.17781804e-02]
 [ 2.19690251e-02  6.46225592e-02 -2.70063446e-02]
 [-6.34791840e-02  2.44162072e-01  2.97559799e-01]
 [ 1.22265271e-01  4.79361281e-02  4.60219461e-02]
 [ 4.74388927e-02  3.41913946e-02  2.66340276e-02]
 [-3.39482117e-03  2.25630579e-02 -3.47373568e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-3.11901755e-02 -8.38960174e-02  4.06422325e-02]
 [-3.18072273e-03  1.01998261e-01 -3.86370193e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.8871809]
curr_Stock_Price:  98.90082248016554
curr_Factors:  [98.90082248 -1.28960193 -1.02871779]
mat_Sqrt:  [[ 9.73568339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07468638 -0.04481212 -0.20476317]
Stock Position:  -0.0746863849849169
Bond Position:  [1.49936401]


portfolio before change:  [-5.85375361]
curr_Stock_Price:  98.46329407832361
curr_Factors:  [98.46329408 -1.05809347 -1.09429538]
mat_Sqrt:  [[11.44204785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00259109  0.02085684 -0.07704158]
Stock Position:  0.00259109235862899
Bond Position:  [-6.1088811]


portfolio before change:  [-5.85506199]
curr_Stock_Price:  99.13745877779866
curr_Factors:  [99.13745878 -1.1274252  -1.11594104]
mat_Sqrt:  [[10.51855792  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00447774 0.07880297 0.84885528]
Stock Position:  0.004477736426394793
Bond Position:  [-6.29897341]


portfolio before change:  [-5.8596494]
curr_Stock_Price:  98.81650902994697
curr_Factors:  [98.81650903 -0.94804904 -1.09588127]
mat_Sqrt:  [[12.79858188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01105157 0.01547132 0.1312878 ]
Stock Position:  0.011051566812686077
Bond Position:  [-6.95172665]


portfolio before change:  [-5.84910269]
curr_Stock_Price:  100.08541846640725
curr_Factors:  [100.08541847  -0.47618522  -1.13375377]
mat_Sqrt:  [[20.00705608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00299169 0.01103523 0.07597947]
Stock Position:  0.0029916860208955695
Bond Position:  [-6.14852684]


portfolio before change:  [-5.84934172]
curr_Stock_Price:  101.0333787127387
curr_Factors:  [101.03337871  -0.79058066  -1.1025365 ]
mat_Sqrt:  [[15.21579121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038643  0.0072822  -0.09909601]
Stock Position:  -0.0003864333727258984
Bond Position:  [-5.81029906]


portfolio before change:  [-5.85243643]
curr_Stock_Price:  101.52202410691991
curr_Factors:  [101.52202411  -0.56833191  -1.10942329]
mat_Sqrt:  [[18.96358507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253112 -0.01197701  0.13962421]
Stock Position:  -0.0025311220884708507
Bond Position:  [-5.59547179]


portfolio before change:  [-5.85029463]
curr_Stock_Price:  99.5702269754132
curr_Factors:  [99.57022698 -0.62371356 -1.11114715]
mat_Sqrt:  [[17.56665461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227814 -0.02707732  0.11594098]
Stock Position:  -0.0022781410714717808
Bond Position:  [-5.6234596]


portfolio before change:  [-5.85445597]
curr_Stock_Price:  100.16233643403133
curr_Factors:  [100.16233643  -1.00848264  -1.12051799]
mat_Sqrt:  [[11.91492245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00081854  0.0329198  -0.11022066]
Stock Position:  0.0008185396653733622
Bond Position:  [-5.93644282]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.85723488]
Stock Price:  100.39452569820612
PL:  [-6.25176058]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.07613347e-01 -1.40815555e-01 -1.02696255e-01]
 [-1.87649735e-02  1.56566659e-01  2.18242120e-01]
 [-8.72289879e-02  3.70354331e-01  4.62695107e-01]
 [ 1.03923461e-01  2.57189722e-02  1.21545129e-02]
 [ 5.27015975e-02  2.81643219e-04  2.81506763e-02]
 [-5.72762371e-04  2.48630318e-02 -3.61924825e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-3.07612976e-02 -7.98719933e-02  3.65727382e-02]
 [ 3.85570251e-02  1.30661927e-01 -4.32867720e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.53842173]
curr_Stock_Price:  99.77776135687381
curr_Factors:  [99.77776136 -1.63105331 -1.03342949]
mat_Sqrt:  [[ 6.94806029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10899733 -0.04544802 -0.29296383]
Stock Position:  -0.10899732523406416
Bond Position:  [11.41393084]


portfolio before change:  [0.37331121]
curr_Stock_Price:  101.34494581450215
curr_Factors:  [101.34494581  -1.6074114   -1.05363046]
mat_Sqrt:  [[ 7.08151691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00815398 0.05053167 0.62258402]
Stock Position:  0.008153980120466194
Bond Position:  [-0.45305346]


portfolio before change:  [0.36478059]
curr_Stock_Price:  100.32654320955486
curr_Factors:  [100.32654321  -0.93234686  -1.01686437]
mat_Sqrt:  [[14.2851289   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00579739 0.11953135 1.31994035]
Stock Position:  0.005797393718104573
Bond Position:  [-0.21685188]


portfolio before change:  [0.36618657]
curr_Stock_Price:  100.58776908070988
curr_Factors:  [100.58776908  -1.09582431  -0.98913748]
mat_Sqrt:  [[12.50425371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00892931 0.00830076 0.03467344]
Stock Position:  0.008929309662081572
Bond Position:  [-0.53199277]


portfolio before change:  [0.36856056]
curr_Stock_Price:  100.88343055380695
curr_Factors:  [100.88343055  -1.10488371  -0.98199654]
mat_Sqrt:  [[12.51697163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.67407949e-03 9.08999580e-05 8.03060438e-02]
Stock Position:  0.004674079493861791
Bond Position:  [-0.10297662]


portfolio before change:  [0.3694411]
curr_Stock_Price:  101.08283762477583
curr_Factors:  [101.08283762  -1.01377842  -1.0031479 ]
mat_Sqrt:  [[13.45046981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00021452  0.00802451 -0.10324708]
Stock Position:  -0.00021451866450960025
Bond Position:  [0.39112526]


portfolio before change:  [0.36958683]
curr_Stock_Price:  101.31535261291393
curr_Factors:  [101.31535261  -0.82500775  -0.95670426]
mat_Sqrt:  [[17.05640757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281414 -0.01197701  0.13962421]
Stock Position:  -0.002814141773846794
Bond Position:  [0.6547026]


portfolio before change:  [0.37457769]
curr_Stock_Price:  99.65821433503177
curr_Factors:  [99.65821434 -0.77690635 -0.99370937]
mat_Sqrt:  [[16.96463283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233425 -0.02577857  0.10433184]
Stock Position:  -0.0023342515834002754
Bond Position:  [0.60720503]


portfolio before change:  [0.37592867]
curr_Stock_Price:  99.20954533151085
curr_Factors:  [99.20954533 -1.50657513 -1.04686897]
mat_Sqrt:  [[ 7.71981292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00730489  0.04217096 -0.12348511]
Stock Position:  0.007304892561957041
Bond Position:  [-0.34878639]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.37676651]
Stock Price:  99.34811944389352
PL:  [0.37676651]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-5.84902619e-01 -1.10871439e-01 -1.61213715e-02]
 [ 1.22097202e-01 -4.20323881e-02  5.04103502e-02]
 [-7.87493204e-02  3.95400568e-01  4.39029748e-01]
 [ 2.46705250e-01  2.04310201e-01  2.90088500e-01]
 [ 4.56241215e-02  4.58847048e-02  2.61110322e-02]
 [-9.70315209e-02 -4.95958679e-02  1.01951775e-02]
 [-5.04206327e-02 -3.44615786e-02  4.91988348e-02]
 [-1.63922301e-02 -4.85512932e-02  8.63914705e-03]
 [ 1.50053970e-02  1.12950129e-01 -4.19096217e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.23262931]
curr_Stock_Price:  96.9430167864325
curr_Factors:  [96.94301679 -0.73528816 -0.99404617]
mat_Sqrt:  [[17.19792994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03551735 -0.0357836  -0.04598979]
Stock Position:  -0.03551735119140461
Bond Position:  [-16.78947013]


portfolio before change:  [-20.12209879]
curr_Stock_Price:  93.59458707649073
curr_Factors:  [93.59458708 -0.12429681 -0.99786615]
mat_Sqrt:  [[30.47204145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00406298 -0.01356589  0.1438067 ]
Stock Position:  0.004062981685853264
Bond Position:  [-20.50237188]


portfolio before change:  [-20.11239175]
curr_Stock_Price:  98.50742811695288
curr_Factors:  [98.50742812 -0.46801506 -1.03453729]
mat_Sqrt:  [[21.92394912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00417708 0.12761498 1.25242967]
Stock Position:  0.004177078415369161
Bond Position:  [-20.52386501]


portfolio before change:  [-20.13736758]
curr_Stock_Price:  94.98550971418022
curr_Factors:  [94.98550971 -0.606296   -1.03166509]
mat_Sqrt:  [[18.46289906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01882824 0.06594083 0.82754174]
Stock Position:  0.01882824365394641
Bond Position:  [-21.9257779]


portfolio before change:  [-20.08899107]
curr_Stock_Price:  98.13727176486435
curr_Factors:  [98.13727176 -0.4453512  -1.08595808]
mat_Sqrt:  [[21.22241537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00284229 0.01480922 0.07448751]
Stock Position:  0.0028422867374868085
Bond Position:  [-20.36792533]


portfolio before change:  [-20.09753992]
curr_Stock_Price:  98.71344673974005
curr_Factors:  [98.71344674 -0.54364306 -1.06741037]
mat_Sqrt:  [[19.71082057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00533079 -0.016007    0.029084  ]
Stock Position:  -0.0053307853289348076
Bond Position:  [-19.57131973]


portfolio before change:  [-20.11544902]
curr_Stock_Price:  100.23686068752184
curr_Factors:  [100.23686069  -0.52932881  -1.05432353]
mat_Sqrt:  [[20.57102759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230481 -0.01112243  0.14035058]
Stock Position:  -0.002304814512090661
Bond Position:  [-19.88442165]


portfolio before change:  [-20.12650085]
curr_Stock_Price:  100.7172173206244
curr_Factors:  [100.71721732  -0.84369686  -0.95345629]
mat_Sqrt:  [[16.69590729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146978 -0.01566986  0.02464508]
Stock Position:  -0.0014697771401918846
Bond Position:  [-19.97846899]


portfolio before change:  [-20.13355643]
curr_Stock_Price:  98.71952945803454
curr_Factors:  [98.71952946 -1.13903576 -0.91265225]
mat_Sqrt:  [[12.6872149   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00232569  0.0364545  -0.11955649]
Stock Position:  0.0023256861373585364
Bond Position:  [-20.36314707]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.14465375]
Stock Price:  98.32687034116621
PL:  [-20.14465375]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.03975036e+00 -2.48869774e-01 -6.71707433e-02]
 [ 6.58638195e-03  9.93627153e-02  6.53242968e-02]
 [-6.42629672e-02  3.00851306e-01  3.29454513e-01]
 [ 1.39063948e-01  6.62277519e-02  7.21340570e-02]
 [ 4.50994725e-02  4.92652319e-02  2.59598346e-02]
 [-9.74246696e-02 -5.00776278e-02  1.04439947e-02]
 [-5.05193342e-02  1.12534401e-02  5.35949285e-02]
 [-2.50964239e-02 -6.68784139e-02  2.48293642e-02]
 [ 1.51055294e-02  9.96368750e-02 -2.86343401e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.51936356]
curr_Stock_Price:  100.73049056191641
curr_Factors:  [100.73049056  -1.20497299  -1.00572455]
mat_Sqrt:  [[11.04249492  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10000112 -0.08032237 -0.19161943]
Stock Position:  -0.100001119899026
Bond Position:  [17.59252543]


portfolio before change:  [7.61611729]
curr_Stock_Price:  99.85094774248014
curr_Factors:  [99.85094774 -1.08581035 -1.01371086]
mat_Sqrt:  [[12.23324619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00328637 0.03206918 0.18635204]
Stock Position:  0.0032863703464429237
Bond Position:  [7.2879701]


portfolio before change:  [7.61424473]
curr_Stock_Price:  98.17205624910926
curr_Factors:  [98.17205625 -0.91898744 -1.03320546]
mat_Sqrt:  [[13.93674279  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00462071 0.09709934 0.93984202]
Stock Position:  0.004620711620512511
Bond Position:  [7.16061997]


portfolio before change:  [7.62008068]
curr_Stock_Price:  98.66002140276142
curr_Factors:  [98.6600214  -0.59169043 -1.08034402]
mat_Sqrt:  [[18.53471323  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00902668 0.02137492 0.20577839]
Stock Position:  0.00902668048488913
Bond Position:  [6.72950819]


portfolio before change:  [7.61787476]
curr_Stock_Price:  98.04279460233067
curr_Factors:  [98.0427946  -0.59546478 -0.99163014]
mat_Sqrt:  [[20.05160385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00301496 0.01590029 0.07405618]
Stock Position:  0.003014957076777318
Bond Position:  [7.32227995]


portfolio before change:  [7.62371025]
curr_Stock_Price:  98.76367794557639
curr_Factors:  [98.76367795 -0.43228278 -0.95730706]
mat_Sqrt:  [[24.60968507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428753 -0.01616248  0.02979381]
Stock Position:  -0.004287533577438638
Bond Position:  [8.04716284]


portfolio before change:  [7.6259581]
curr_Stock_Price:  99.17807534376944
curr_Factors:  [99.17807534 -0.51291975 -0.9858501 ]
mat_Sqrt:  [[22.15685946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168265  0.00363203  0.15289141]
Stock Position:  -0.001682648953442024
Bond Position:  [7.79283998]


portfolio before change:  [7.62848615]
curr_Stock_Price:  99.99187835143253
curr_Factors:  [99.99187835 -0.96719423 -1.01939046]
mat_Sqrt:  [[13.71519406  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245565 -0.02158492  0.07083126]
Stock Position:  -0.0024556451827706235
Bond Position:  [7.87403072]


portfolio before change:  [7.63043712]
curr_Stock_Price:  100.80104596105771
curr_Factors:  [100.80104596  -1.12997845  -0.97591606]
mat_Sqrt:  [[12.27118985  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00241206  0.03215766 -0.0816858 ]
Stock Position:  0.002412061223354439
Bond Position:  [7.38729882]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.64035403]
Stock Price:  103.38072261252482
PL:  [4.25963142]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.24644262e-01 -2.00931707e-01 -3.70893529e-02]
 [ 2.98685222e-02  6.54438392e-02  3.15479826e-02]
 [-9.47479886e-02  4.44688029e-01  5.32286306e-01]
 [ 1.19861141e-01  3.46873089e-02  1.69217995e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 3.92474711e-02  1.53426304e-02 -4.49670181e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 1.54389855e-02  2.17278152e-02 -5.27636789e-02]
 [-5.39568693e-03  8.98688236e-02 -2.95659419e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.2000189]
curr_Stock_Price:  98.99460342218231
curr_Factors:  [98.99460342 -0.90108844 -0.96113396]
mat_Sqrt:  [[15.37653952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05678977 -0.06485043 -0.1058056 ]
Stock Position:  -0.056789767688201154
Bond Position:  [0.42186163]


portfolio before change:  [-5.22884941]
curr_Stock_Price:  99.50598933693763
curr_Factors:  [99.50598934 -0.51166335 -0.9390129 ]
mat_Sqrt:  [[23.32536952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00212931 0.02112191 0.08999761]
Stock Position:  0.00212930795494326
Bond Position:  [-5.4407283]


portfolio before change:  [-5.23042312]
curr_Stock_Price:  100.04481707577456
curr_Factors:  [100.04481708  -0.68364704  -0.90948216]
mat_Sqrt:  [[20.33795936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00514683 0.14352244 1.51846467]
Stock Position:  0.005146832117848231
Bond Position:  [-5.745337]


portfolio before change:  [-5.20547985]
curr_Stock_Price:  105.44943352452432
curr_Factors:  [105.44943352  -0.29612008  -0.94744402]
mat_Sqrt:  [[30.40683531  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00428837 0.01119528 0.04827318]
Stock Position:  0.004288371513377719
Bond Position:  [-5.6576862]


portfolio before change:  [-5.21646578]
curr_Stock_Price:  103.54745735528319
curr_Factors:  [103.54745736  -0.63929187  -0.90972593]
mat_Sqrt:  [[21.99933515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00265105 -0.00140152  0.08089603]
Stock Position:  0.002651048090420196
Bond Position:  [-5.49097507]


portfolio before change:  [-5.21788377]
curr_Stock_Price:  104.0484619594881
curr_Factors:  [104.04846196  -0.42486892  -0.90336132]
mat_Sqrt:  [[27.56719636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120435  0.00495181 -0.12827839]
Stock Position:  0.0012043451155710203
Bond Position:  [-5.34319403]


portfolio before change:  [-5.22372548]
curr_Stock_Price:  101.41678900798917
curr_Factors:  [101.41678901  -0.50722188  -0.88880616]
mat_Sqrt:  [[25.10860488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191166 -0.01197701  0.13962421]
Stock Position:  -0.00191166133189796
Bond Position:  [-5.02985093]


portfolio before change:  [-5.23020634]
curr_Stock_Price:  103.4910592884003
curr_Factors:  [103.49105929  -0.80340199  -0.88719978]
mat_Sqrt:  [[19.0846328   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047702  0.00701262 -0.15052009]
Stock Position:  0.0004770233957243755
Bond Position:  [-5.27957399]


portfolio before change:  [-5.23396116]
curr_Stock_Price:  101.15495563258824
curr_Factors:  [101.15495563  -0.92663251  -0.80754461]
mat_Sqrt:  [[17.85844375  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00038713  0.02900504 -0.0843434 ]
Stock Position:  0.0003871326837276146
Bond Position:  [-5.27312155]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.23643153]
Stock Price:  101.58593086243272
PL:  [-6.8223624]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.51135718e+00 -3.36909706e-01 -1.03484632e-01]
 [-2.63476328e-03  1.20741822e-01  1.12258704e-01]
 [-1.37510425e-01  7.36330982e-01  7.45856360e-01]
 [ 1.19679468e-01  3.45850792e-02  1.68674574e-02]
 [ 1.93193632e-03 -6.28447013e-02 -5.50914986e-02]
 [ 4.36222212e-02  9.76202110e-03 -4.49184165e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-3.14572188e-02 -8.92439311e-02  4.49147165e-02]
 [-6.98658421e-02  5.49062590e-02 -3.22584234e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.59151065]
curr_Stock_Price:  102.24157003363442
curr_Factors:  [102.24157003  -0.59392154  -1.01318178]
mat_Sqrt:  [[20.4961082   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0781247  -0.10873714 -0.29521285]
Stock Position:  -0.07812469952385004
Bond Position:  [26.57910258]


portfolio before change:  [18.72840249]
curr_Stock_Price:  100.65949713733107
curr_Factors:  [100.65949714  -0.57134778  -0.99420643]
mat_Sqrt:  [[21.03503303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00213578 0.03896926 0.32024284]
Stock Position:  0.0021357831910760448
Bond Position:  [18.51341563]


portfolio before change:  [18.74730412]
curr_Stock_Price:  105.17428491002353
curr_Factors:  [105.17428491  -0.83578432  -0.9966251 ]
mat_Sqrt:  [[16.83078101  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00980583 0.2376498  2.12772059]
Stock Position:  0.009805831321021098
Bond Position:  [17.71598282]


portfolio before change:  [18.75873731]
curr_Stock_Price:  105.43667804356967
curr_Factors:  [105.43667804  -0.55517953  -0.98018472]
mat_Sqrt:  [[22.70865915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00573271 0.01116229 0.04811816]
Stock Position:  0.005732710702327655
Bond Position:  [18.15429934]


portfolio before change:  [18.76847347]
curr_Stock_Price:  105.55123802640857
curr_Factors:  [105.55123803  -0.40869544  -0.9801813 ]
mat_Sqrt:  [[26.31975405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084126 -0.02028304 -0.15716071]
Stock Position:  -0.0008412574689892556
Bond Position:  [18.85726923]


portfolio before change:  [18.77872237]
curr_Stock_Price:  104.57898933705458
curr_Factors:  [104.57898934  -0.20822448  -0.9755417 ]
mat_Sqrt:  [[32.01410191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113843  0.00315068 -0.12813974]
Stock Position:  0.0011384343116161032
Bond Position:  [18.65966606]


portfolio before change:  [18.78597827]
curr_Stock_Price:  102.75519601483167
curr_Factors:  [102.75519601   0.12044691  -0.95653562]
mat_Sqrt:  [[44.53434574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010778  -0.01197701  0.13962421]
Stock Position:  -0.0010778007009130995
Bond Position:  [18.89672789]


portfolio before change:  [18.79841857]
curr_Stock_Price:  99.98141767761147
curr_Factors:  [99.98141768  0.21974068 -0.91203237]
mat_Sqrt:  [[50.03349383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080958 -0.02880335  0.12812918]
Stock Position:  -0.0008095753211110616
Bond Position:  [18.87936106]


portfolio before change:  [18.80615065]
curr_Stock_Price:  102.09358895808455
curr_Factors:  [ 1.02093589e+02  7.19201395e-02 -8.44628333e-01]
mat_Sqrt:  [[47.14282097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138394  0.01772092 -0.0920243 ]
Stock Position:  -0.0013839407712412757
Bond Position:  [18.94744213]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.82036867]
Stock Price:  98.66719526190668
PL:  [18.82036867]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.37194312e+00 -3.07113596e-01 -1.00687760e-01]
 [-2.70419186e-02  1.75520632e-01  2.58612922e-01]
 [-1.05701100e-01  4.99261412e-01  5.45974476e-01]
 [ 1.10127324e-01  2.92099654e-02  1.40102154e-02]
 [ 5.29267545e-02 -1.16913539e-03  2.82155639e-02]
 [ 3.92611063e-02  1.36947787e-02 -4.52075033e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 6.37407312e-03  7.64515505e-03 -3.92753521e-02]
 [ 2.20308213e-01  7.92264906e-03  7.29157717e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.43445314]
curr_Stock_Price:  102.2201354947176
curr_Factors:  [102.22013549  -1.03781952  -1.07424661]
mat_Sqrt:  [[12.36738235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11766316 -0.09912049 -0.28723415]
Stock Position:  -0.11766315519457661
Bond Position:  [30.46199681]


portfolio before change:  [18.46431641]
curr_Stock_Price:  102.09581057705441
curr_Factors:  [102.09581058  -1.0408572   -1.07370541]
mat_Sqrt:  [[12.32154167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00499736 0.05664904 0.73775068]
Stock Position:  0.004997363448113949
Bond Position:  [17.95410654]


portfolio before change:  [18.4797113]
curr_Stock_Price:  103.37960553509757
curr_Factors:  [103.37960554  -1.34515157  -1.04097977]
mat_Sqrt:  [[ 9.50935798  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01132114 0.16113593 1.55751321]
Stock Position:  0.011321140957628059
Bond Position:  [17.30933621]


portfolio before change:  [18.48515176]
curr_Stock_Price:  103.09550270465763
curr_Factors:  [103.0955027   -1.06081911  -1.04626772]
mat_Sqrt:  [[12.53555414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00948898 0.00942748 0.03996724]
Stock Position:  0.009488978706377752
Bond Position:  [17.50688073]


portfolio before change:  [18.48283101]
curr_Stock_Price:  101.9282131842136
curr_Factors:  [101.92821318  -0.72946261  -1.05865258]
mat_Sqrt:  [[17.05005764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.003428   -0.00037734  0.08049115]
Stock Position:  0.0034279991814745877
Bond Position:  [18.13342118]


portfolio before change:  [18.49789605]
curr_Stock_Price:  103.67735698589003
curr_Factors:  [103.67735699  -1.17964088  -1.10534507]
mat_Sqrt:  [[10.55181404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00311118  0.00441997 -0.12896442]
Stock Position:  0.0031111805203908834
Bond Position:  [18.17533708]


portfolio before change:  [18.50672349]
curr_Stock_Price:  103.5929839539433
curr_Factors:  [103.59298395  -0.43956428  -1.0808785 ]
mat_Sqrt:  [[22.64698703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00211945 -0.01197701  0.13962421]
Stock Position:  -0.002119449664174432
Bond Position:  [18.72628361]


portfolio before change:  [18.50997403]
curr_Stock_Price:  106.4781378471726
curr_Factors:  [106.47813785  -0.46834227  -1.07741555]
mat_Sqrt:  [[22.69584491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.63122932e-06  2.46746318e-03 -1.12041647e-01]
Stock Position:  -3.631229320937346e-06
Bond Position:  [18.51036068]


portfolio before change:  [18.51922785]
curr_Stock_Price:  107.49099497812286
curr_Factors:  [107.49099498  -0.86699402  -1.06679239]
mat_Sqrt:  [[15.54315992  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01523559 0.00255702 0.2080084 ]
Stock Position:  0.01523559479207192
Bond Position:  [16.88153861]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.46495176]
Stock Price:  103.37438691053339
PL:  [15.09056485]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.16277927e+00 -3.07341362e-01 -1.89000296e-03]
 [-7.10666482e-02  2.10880695e-01  4.26683892e-01]
 [-1.34671093e-01  7.02151642e-01  7.39386468e-01]
 [ 1.11520525e-01  2.99939375e-02  1.44269504e-02]
 [ 3.02409145e-02 -3.06787278e-02 -9.20920538e-03]
 [ 3.81206860e-02  1.49401582e-02 -4.50407118e-02]
 [-4.91730529e-02 -3.48663864e-02  4.54716598e-02]
 [ 9.39456626e-04  3.19830521e-03 -3.38822500e-02]
 [ 3.96523980e-01 -2.16846671e-02  1.24948371e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.51593491]
curr_Stock_Price:  99.91116819102726
curr_Factors:  [99.91116819 -0.37777957 -1.03935904]
mat_Sqrt:  [[24.21913129  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05061704 -0.099194   -0.00539165]
Stock Position:  -0.050617044994893
Bond Position:  [6.573143]


portfolio before change:  [1.32773774]
curr_Stock_Price:  103.69417359090438
curr_Factors:  [103.69417359  -0.55770425  -1.07680341]
mat_Sqrt:  [[20.22538029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00292087 0.06806145 1.21721038]
Stock Position:  0.002920868588979634
Bond Position:  [1.02486069]


portfolio before change:  [1.33030662]
curr_Stock_Price:  104.39818341680511
curr_Factors:  [104.39818342  -0.50890149  -1.08067962]
mat_Sqrt:  [[21.29838314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00749266 0.22661847 2.10926379]
Stock Position:  0.0074926645919411936
Bond Position:  [0.54808605]


portfolio before change:  [1.32413907]
curr_Stock_Price:  103.5384534410524
curr_Factors:  [103.53845344  -0.37729653  -1.09833715]
mat_Sqrt:  [[23.67239     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00509403 0.0096805  0.04115607]
Stock Position:  0.00509403151973497
Bond Position:  [0.79671092]


portfolio before change:  [1.33133004]
curr_Stock_Price:  104.87188037176495
curr_Factors:  [104.87188037  -0.60391596  -1.10465138]
mat_Sqrt:  [[18.99492952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00116341 -0.00990152 -0.0262713 ]
Stock Position:  0.0011634064874272545
Bond Position:  [1.20932141]


portfolio before change:  [1.33053797]
curr_Stock_Price:  103.67119618292197
curr_Factors:  [103.67119618  -0.98276832  -1.05481735]
mat_Sqrt:  [[13.51281708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00236638  0.00482192 -0.12848861]
Stock Position:  0.002366378238593949
Bond Position:  [1.08521271]


portfolio before change:  [1.3367983]
curr_Stock_Price:  106.08737463079417
curr_Factors:  [106.08737463  -0.99398584  -1.12232882]
mat_Sqrt:  [[12.78085537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367802 -0.01125308  0.12971799]
Stock Position:  -0.003678021477826441
Bond Position:  [1.72698995]


portfolio before change:  [1.33337872]
curr_Stock_Price:  107.25193910541884
curr_Factors:  [107.25193911  -0.77673709  -1.12681026]
mat_Sqrt:  [[15.9847203   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033306  0.00103225 -0.09665663]
Stock Position:  -0.00033306040279681667
Bond Position:  [1.36910009]


portfolio before change:  [1.33317129]
curr_Stock_Price:  109.93058386857366
curr_Factors:  [109.93058387  -1.397486    -1.10386848]
mat_Sqrt:  [[ 9.01143773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04634139 -0.0069987   0.35644292]
Stock Position:  0.04634139498043078
Bond Position:  [-3.76116532]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.35740516]
Stock Price:  110.4941173016538
PL:  [-9.13671214]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.23167572e+00 -3.12698875e-01 -2.29948684e-02]
 [-5.66184568e-02  1.91185732e-01  3.67337182e-01]
 [-1.06198955e-01  5.07232769e-01  5.34361555e-01]
 [ 1.13465958e-01  3.10886576e-02  1.50088693e-02]
 [ 1.80261510e-02 -2.66749428e-02  4.63051007e-02]
 [ 5.36902056e-02  2.41170690e-03 -4.66330938e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 6.65681344e-03  1.11891104e-02 -4.17887387e-02]
 [ 2.10964532e-01  3.03616995e-02  5.54556599e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.27676258]
curr_Stock_Price:  100.69738141280789
curr_Factors:  [100.69738141  -0.7607648   -0.93197098]
mat_Sqrt:  [[18.52986976  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07016773 -0.10092313 -0.06559796]
Stock Position:  -0.0701677310205427
Bond Position:  [14.34246935]


portfolio before change:  [7.14098993]
curr_Stock_Price:  102.73458099869802
curr_Factors:  [102.734581    -1.19279685  -1.00529778]
mat_Sqrt:  [[11.40502615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00503195 0.06170493 1.04791073]
Stock Position:  0.005031953005959674
Bond Position:  [6.62403435]


portfolio before change:  [7.15030383]
curr_Stock_Price:  103.92716968470775
curr_Factors:  [103.92716968  -1.47493077  -1.07046229]
mat_Sqrt:  [[ 8.15227728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01305348 0.16370867 1.52438478]
Stock Position:  0.013053480908304703
Bond Position:  [5.7936925]


portfolio before change:  [7.15817543]
curr_Stock_Price:  104.30822022972058
curr_Factors:  [104.30822023  -1.56007896  -1.0986153 ]
mat_Sqrt:  [[ 7.30570764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01681912 0.01003382 0.04281613]
Stock Position:  0.016819120402441306
Bond Position:  [5.40380292]


portfolio before change:  [7.16555796]
curr_Stock_Price:  104.58647198374751
curr_Factors:  [104.58647198  -1.75861268  -1.13402243]
mat_Sqrt:  [[ 5.79722356  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00380064 -0.0086093   0.13209556]
Stock Position:  0.003800636633143817
Bond Position:  [6.76806278]


portfolio before change:  [7.1697508]
curr_Stock_Price:  104.79905852853473
curr_Factors:  [104.79905853  -1.55692637  -1.18432478]
mat_Sqrt:  [[ 6.75845041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00660855  0.00077838 -0.13303124]
Stock Position:  0.006608549306731718
Bond Position:  [6.47718106]


portfolio before change:  [7.17504531]
curr_Stock_Price:  105.11003582822676
curr_Factors:  [105.11003583  -1.23276679  -1.08888032]
mat_Sqrt:  [[10.31254018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465444 -0.01197701  0.13962421]
Stock Position:  -0.0046544448022836984
Bond Position:  [7.66427417]


portfolio before change:  [7.17552334]
curr_Stock_Price:  105.83086565706037
curr_Factors:  [105.83086566  -0.88938577  -1.10519203]
mat_Sqrt:  [[14.40052137  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.85191389e-05  3.61126985e-03 -1.19211640e-01]
Stock Position:  2.8519138873508812e-05
Bond Position:  [7.17250514]


portfolio before change:  [7.17911334]
curr_Stock_Price:  105.93068423196596
curr_Factors:  [105.93068423  -1.16157743  -1.09751344]
mat_Sqrt:  [[11.06397225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02065099 0.0097992  0.15819956]
Stock Position:  0.020650985247304906
Bond Position:  [4.99154034]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.18419739]
Stock Price:  106.0559884229497
PL:  [1.12820897]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.27099274e+00 -2.97275173e-01 -7.39503051e-02]
 [-1.14361920e-02  1.40459151e-01  1.67513870e-01]
 [-9.94424236e-02  4.31047059e-01  5.49545107e-01]
 [ 1.09773694e-01  2.90109736e-02  1.39044376e-02]
 [ 5.34192426e-02 -4.34243684e-03  2.83574931e-02]
 [ 1.87295440e-02  2.85069865e-02 -4.28013491e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [ 6.31514947e-03  6.75510754e-03 -3.86494547e-02]
 [ 4.26236947e-02  1.81111894e-02  3.47843481e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.57985661]
curr_Stock_Price:  101.83055231974414
curr_Factors:  [101.83055232  -1.23914199  -1.02612372]
mat_Sqrt:  [[10.57026073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12741113 -0.09594515 -0.21095964]
Stock Position:  -0.1274111256928357
Bond Position:  [28.55420192]


portfolio before change:  [15.68849445]
curr_Stock_Price:  101.08997990729434
curr_Factors:  [101.08997991  -0.94132863  -1.13487458]
mat_Sqrt:  [[12.6772341   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00405676 0.045333   0.47787045]
Stock Position:  0.00405676328056279
Bond Position:  [15.27839633]


portfolio before change:  [15.69733227]
curr_Stock_Price:  101.38497042508655
curr_Factors:  [101.38497043  -0.75808465  -1.09858403]
mat_Sqrt:  [[15.83553042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00636039 0.13911984 1.56769923]
Stock Position:  0.0063603877656796416
Bond Position:  [15.05248454]


portfolio before change:  [15.71429589]
curr_Stock_Price:  102.86844937020737
curr_Factors:  [102.86844937  -0.73943907  -1.10343924]
mat_Sqrt:  [[16.29034617  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00727632 0.00936325 0.03966549]
Stock Position:  0.007276319659708596
Bond Position:  [14.96579217]


portfolio before change:  [15.72327939]
curr_Stock_Price:  103.0744237790297
curr_Factors:  [103.07442378  -0.79147285  -1.075617  ]
mat_Sqrt:  [[15.93250628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00366052 -0.00140152  0.08089603]
Stock Position:  0.00366052235783945
Bond Position:  [15.34597316]


portfolio before change:  [15.72803616]
curr_Stock_Price:  102.27723087517448
curr_Factors:  [102.27723088  -0.2841591   -0.99306598]
mat_Sqrt:  [[28.51590496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00055449  0.00920059 -0.12210034]
Stock Position:  0.000554487730825083
Bond Position:  [15.67132469]


portfolio before change:  [15.73780258]
curr_Stock_Price:  105.7557660367517
curr_Factors:  [105.75576604  -0.22133195  -1.00251954]
mat_Sqrt:  [[31.1022713   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154327 -0.01197701  0.13962421]
Stock Position:  -0.0015432682904052383
Bond Position:  [15.9010121]


portfolio before change:  [15.74470993]
curr_Stock_Price:  106.4329948408305
curr_Factors:  [106.43299484  -0.27611144  -0.96171098]
mat_Sqrt:  [[30.86717173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.32571314e-06  2.18020158e-03 -1.10256136e-01]
Stock Position:  -6.325713142856232e-06
Bond Position:  [15.7453832]


portfolio before change:  [15.75258403]
curr_Stock_Price:  106.5213128179477
curr_Factors:  [ 1.06521313e+02  2.22297219e-02 -9.83660901e-01]
mat_Sqrt:  [[40.7279222   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00131165 0.00584536 0.09923006]
Stock Position:  0.0013116542202181313
Bond Position:  [15.6128649]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.75964924]
Stock Price:  105.95471465624509
PL:  [9.80493458]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-8.67437785e-01 -2.05784554e-01 -7.68897961e-02]
 [ 2.10457327e-02  6.66389645e-02 -2.04204514e-02]
 [-7.01645336e-02  2.57553363e-01  3.32901577e-01]
 [ 1.04050059e-01  2.57902105e-02  1.21923810e-02]
 [ 5.35973865e-02 -5.85894805e-03  2.91438043e-02]
 [ 2.90175815e-02  4.45581823e-02 -4.91909476e-02]
 [-5.04149159e-02 -3.71094184e-02  4.89442106e-02]
 [-4.48899963e-03 -1.94677574e-02 -1.62115052e-02]
 [ 1.19239318e-01  7.80977539e-02  4.05541029e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.39865937]
curr_Stock_Price:  100.16811440579826
curr_Factors:  [100.16811441  -1.32577141  -0.98439188]
mat_Sqrt:  [[ 9.94118899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09306115 -0.06641668 -0.21934519]
Stock Position:  -0.09306114653896087
Bond Position:  [12.72041894]


portfolio before change:  [3.55468662]
curr_Stock_Price:  98.55986584314996
curr_Factors:  [98.55986584 -1.11865183 -0.97254352]
mat_Sqrt:  [[12.17602418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00250328  0.02150763 -0.05825386]
Stock Position:  0.002503284049937165
Bond Position:  [3.30796328]


portfolio before change:  [3.55994741]
curr_Stock_Price:  100.00052952946477
curr_Factors:  [100.00052953  -1.61919382  -0.92211665]
mat_Sqrt:  [[ 7.87635331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00639402 0.08312499 0.94967554]
Stock Position:  0.006394021990837106
Bond Position:  [2.92054182]


portfolio before change:  [3.56605452]
curr_Stock_Price:  100.72722078215205
curr_Factors:  [100.72722078  -1.59515676  -0.96234098]
mat_Sqrt:  [[ 7.80620041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01432236 0.00832375 0.03478147]
Stock Position:  0.014322361294056568
Bond Position:  [2.12340287]


portfolio before change:  [3.56581345]
curr_Stock_Price:  100.6362417129024
curr_Factors:  [100.63624171  -1.764754    -0.99640896]
mat_Sqrt:  [[ 6.36204257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00917164 -0.00189097  0.08313916]
Stock Position:  0.009171643743260094
Bond Position:  [2.6428137]


portfolio before change:  [3.57506157]
curr_Stock_Price:  101.50046797786851
curr_Factors:  [101.50046798  -1.49679411  -1.0244465 ]
mat_Sqrt:  [[ 8.15656235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00344164  0.01438109 -0.14032808]
Stock Position:  0.003441636442912651
Bond Position:  [3.22573386]


portfolio before change:  [3.5759824]
curr_Stock_Price:  101.29927452302412
curr_Factors:  [101.29927452  -1.52964862  -1.0333308 ]
mat_Sqrt:  [[ 7.8076173   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00614773 -0.01197701  0.13962421]
Stock Position:  -0.006147733327430869
Bond Position:  [4.19874333]


portfolio before change:  [3.57698432]
curr_Stock_Price:  101.47787371877212
curr_Factors:  [101.47787372  -1.15883055  -0.98610988]
mat_Sqrt:  [[11.88052326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00099087 -0.00628319 -0.04624691]
Stock Position:  -0.0009908653316292528
Bond Position:  [3.67753523]


portfolio before change:  [3.57790336]
curr_Stock_Price:  102.4065416152605
curr_Factors:  [102.40654162  -1.4341494   -0.9280307 ]
mat_Sqrt:  [[ 9.64819153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01409681 0.02520594 0.01156896]
Stock Position:  0.014096814097691876
Bond Position:  [2.13429738]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.60362719]
Stock Price:  104.15561832468003
PL:  [-0.55199114]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-7.76837036e-01 -1.83136718e-01 -4.48578305e-02]
 [ 4.88380852e-03  1.02905473e-01  8.01343503e-02]
 [-7.74597210e-02  3.09629668e-01  3.90329227e-01]
 [ 1.02219884e-01  2.47603476e-02  1.16449381e-02]
 [ 5.49622418e-02 -1.74777488e-02  3.51681538e-02]
 [-5.01828908e-03  2.73822638e-02 -3.36069695e-02]
 [-5.05026312e-02  3.51720945e-03  5.28509893e-02]
 [-3.84337256e-02 -1.01993770e-01  5.81807108e-02]
 [-2.31088722e-02  8.31197941e-02 -3.27920375e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.04640979]
curr_Stock_Price:  98.87909159962594
curr_Factors:  [98.8790916  -0.93192486 -1.02836605]
mat_Sqrt:  [[13.92390153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05913402 -0.05910712 -0.1279669 ]
Stock Position:  -0.059134016895227334
Bond Position:  [-0.19929191]


portfolio before change:  [-6.10235191]
curr_Stock_Price:  99.82342876998939
curr_Factors:  [99.82342877 -1.48241017 -0.97681947]
mat_Sqrt:  [[ 8.53498216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00494982 0.0332126  0.228601  ]
Stock Position:  0.004949823576805505
Bond Position:  [-6.59646027]


portfolio before change:  [-6.10446769]
curr_Stock_Price:  100.06248158095424
curr_Factors:  [100.06248158  -1.28916964  -0.96136747]
mat_Sqrt:  [[10.54084481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00620622 0.09993255 1.11350064]
Stock Position:  0.006206218902805025
Bond Position:  [-6.72547736]


portfolio before change:  [-6.10869632]
curr_Stock_Price:  99.92309727946758
curr_Factors:  [99.92309728 -1.29166989 -0.97702592]
mat_Sqrt:  [[10.33674531  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01060789 0.00799137 0.03321977]
Stock Position:  0.010607892347455926
Bond Position:  [-7.16866978]


portfolio before change:  [-6.11217257]
curr_Stock_Price:  99.93337146601549
curr_Factors:  [99.93337147 -1.67424306 -1.02501817]
mat_Sqrt:  [[ 6.72103693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00871492 -0.00564092  0.10032495]
Stock Position:  0.008714917238798268
Bond Position:  [-6.98308363]


portfolio before change:  [-6.11131369]
curr_Stock_Price:  100.43266396513977
curr_Factors:  [100.43266397  -1.38156913  -0.97930747]
mat_Sqrt:  [[ 9.47456551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066377  0.00883759 -0.09587133]
Stock Position:  -0.0006637667780027784
Bond Position:  [-6.04464982]


portfolio before change:  [-6.11350223]
curr_Stock_Price:  99.17539158155388
curr_Factors:  [99.17539158 -0.87454829 -0.99203671]
mat_Sqrt:  [[15.33756305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254255  0.00113517  0.15076916]
Stock Position:  -0.0025425499934236505
Bond Position:  [-5.86134384]


portfolio before change:  [-6.11497635]
curr_Stock_Price:  98.60223086104529
curr_Factors:  [98.60223086 -0.42905483 -0.94837627]
mat_Sqrt:  [[24.87001325  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190499 -0.03291835  0.16597337]
Stock Position:  -0.0019049860715066535
Bond Position:  [-5.92714047]


portfolio before change:  [-6.12290338]
curr_Stock_Price:  101.2073502078057
curr_Factors:  [101.20735021  -0.69581403  -0.96260387]
mat_Sqrt:  [[19.27393145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066596  0.0268268  -0.09354656]
Stock Position:  -0.0006659649036117255
Bond Position:  [-6.05550283]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.12543052]
Stock Price:  100.45450618106791
PL:  [-6.5799367]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 1.19277351e+02 -4.92643128e+01 -4.92688573e+01]
 [-1.20556327e+00 -2.99120309e-01 -3.93100570e-02]
 [ 4.46462073e-02  4.63107088e-02  2.56163516e-02]
 [-1.02604255e-01  4.53000068e-01  5.79562411e-01]
 [ 1.06201673e-01  2.70009511e-02  1.28359727e-02]
 [ 4.71211450e-02  3.62387725e-02  2.65424565e-02]
 [-5.46285073e-02 -1.25856483e-02 -1.00128171e-02]
 [-5.04798377e-02 -7.03994482e-03  5.18357816e-02]
 [-1.15129027e-02 -5.01624631e-02  7.57414435e-03]
 [ 2.02719838e-01  1.06118436e-02  6.77590380e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.27735084 -49.26431284 -49.26885734]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [   7.32730958  -15.8999886  -140.55033618]
init_Out:  [2.53202383]
Stock Position:  7.3273095771406656
Bond position:  [-730.19893389]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.60551494]
curr_Stock_Price:  100.87872387583494
curr_Factors:  [100.87872388  -0.83698238  -1.04792311]
mat_Sqrt:  [[15.31776935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08321349 -0.09654066 -0.11214065]
Stock Position:  -0.08321349239938447
Bond Position:  [16.99998586]


portfolio before change:  [8.76619299]
curr_Stock_Price:  99.04998285015192
curr_Factors:  [99.04998285 -0.42069048 -1.05436244]
mat_Sqrt:  [[22.65932981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00261827 0.01494672 0.07307632]
Stock Position:  0.002618270600264176
Bond Position:  [8.50685333]


portfolio before change:  [8.77621715]
curr_Stock_Price:  101.25360141896738
curr_Factors:  [101.25360142  -0.63963412  -1.06940341]
mat_Sqrt:  [[18.33094751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00590077 0.14620514 1.65333024]
Stock Position:  0.0059007685210151215
Bond Position:  [8.17874308]


portfolio before change:  [8.78123824]
curr_Stock_Price:  101.41132632434604
curr_Factors:  [101.41132632  -0.41698994  -1.01565877]
mat_Sqrt:  [[24.20443975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00472365 0.00871452 0.03661746]
Stock Position:  0.004723652015040401
Bond Position:  [8.30220642]


portfolio before change:  [8.77447353]
curr_Stock_Price:  99.10022332068728
curr_Factors:  [99.10022332 -0.66373226 -0.99240803]
mat_Sqrt:  [[18.91568373  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0031686  0.01169601 0.07571824]
Stock Position:  0.0031686039225466383
Bond Position:  [8.46046418]


portfolio before change:  [8.78132532]
curr_Stock_Price:  99.92724199872566
curr_Factors:  [99.927242   -0.52917808 -0.99538713]
mat_Sqrt:  [[21.75572924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272303 -0.004062   -0.02856378]
Stock Position:  -0.0027230252366839554
Bond Position:  [9.05342972]


portfolio before change:  [8.78646502]
curr_Stock_Price:  99.70254579030136
curr_Factors:  [99.70254579 -0.36123254 -1.01828052]
mat_Sqrt:  [[25.09523909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164716 -0.00227213  0.14787306]
Stock Position:  -0.001647162063651146
Bond Position:  [8.95069127]


portfolio before change:  [8.78843244]
curr_Stock_Price:  101.22580018201641
curr_Factors:  [ 1.01225800e+02 -1.00432786e-01 -1.01836592e+00]
mat_Sqrt:  [[33.06763352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061106 -0.01618987  0.02160693]
Stock Position:  -0.000611056938674145
Bond Position:  [8.85028716]


portfolio before change:  [8.78916636]
curr_Stock_Price:  107.26832601074146
curr_Factors:  [107.26832601  -0.81300467  -1.03934937]
mat_Sqrt:  [[16.82690976  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01299806 0.00342496 0.19329767]
Stock Position:  0.012998062670144953
Bond Position:  [7.39488594]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.80636117]
Stock Price:  108.30666900906891
PL:  [0.49969217]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  0.022930989531811222
FINAL STD P&L:  9.983065633177947
