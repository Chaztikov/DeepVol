WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-17 01:29:29.889165: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-17 01:29:30.138537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:04:00.0
2019-12-17 01:29:30.139127: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 01:29:30.141132: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 01:29:30.143104: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 01:29:30.144103: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 01:29:30.146473: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 01:29:30.148361: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 01:29:30.153516: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 01:29:30.193716: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 01:29:30.194145: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-17 01:29:30.200779: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399990000 Hz
2019-12-17 01:29:30.200966: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563b5c8b49c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-17 01:29:30.200983: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-17 01:29:30.224255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:04:00.0
2019-12-17 01:29:30.224287: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 01:29:30.224301: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 01:29:30.224312: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 01:29:30.224323: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 01:29:30.224333: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 01:29:30.224344: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 01:29:30.224355: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 01:29:30.270025: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 01:29:30.270066: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 01:29:31.041167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-17 01:29:31.041200: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-17 01:29:31.041210: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-17 01:29:31.106355: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:04:00.0, compute capability: 6.0)
2019-12-17 01:29:31.108333: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563b5ceedbd0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-17 01:29:31.108351: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
INFO   Y0_true: -1.0000e+00
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-17 01:30:06.826781: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 1.5632e+02,   Y0: 2.4489e+00,  elapsed time  35
INFO   step:     1,    loss: 4.0562e+01,   Y0: 2.4539e+00,  elapsed time  53
INFO   step:     2,    loss: 4.0563e+01,   Y0: 2.4564e+00,  elapsed time  56
INFO   step:     3,    loss: 4.0558e+01,   Y0: 2.4574e+00,  elapsed time  58
INFO   step:     4,    loss: 4.0551e+01,   Y0: 2.4600e+00,  elapsed time  60
INFO   step:     5,    loss: 4.0545e+01,   Y0: 2.4632e+00,  elapsed time  63
INFO   step:     6,    loss: 4.0539e+01,   Y0: 2.4666e+00,  elapsed time  65
INFO   step:     7,    loss: 4.0535e+01,   Y0: 2.4704e+00,  elapsed time  67
INFO   step:     8,    loss: 4.0530e+01,   Y0: 2.4737e+00,  elapsed time  70
INFO   step:     9,    loss: 4.0527e+01,   Y0: 2.4772e+00,  elapsed time  72
INFO   step:    10,    loss: 4.0522e+01,   Y0: 2.4808e+00,  elapsed time  74
INFO   step:    11,    loss: 4.0517e+01,   Y0: 2.4828e+00,  elapsed time  77
INFO   step:    12,    loss: 4.0513e+01,   Y0: 2.4852e+00,  elapsed time  79
INFO   step:    13,    loss: 4.0509e+01,   Y0: 2.4873e+00,  elapsed time  81
INFO   step:    14,    loss: 4.0505e+01,   Y0: 2.4897e+00,  elapsed time  84
INFO   step:    15,    loss: 4.0501e+01,   Y0: 2.4918e+00,  elapsed time  86
INFO   step:    16,    loss: 4.0496e+01,   Y0: 2.4925e+00,  elapsed time  88
INFO   step:    17,    loss: 4.0491e+01,   Y0: 2.4931e+00,  elapsed time  91
INFO   step:    18,    loss: 4.0487e+01,   Y0: 2.4934e+00,  elapsed time  93
INFO   step:    19,    loss: 4.0483e+01,   Y0: 2.4937e+00,  elapsed time  96
INFO   step:    20,    loss: 4.0478e+01,   Y0: 2.4943e+00,  elapsed time  98
INFO   step:    21,    loss: 4.0474e+01,   Y0: 2.4949e+00,  elapsed time 100
INFO   step:    22,    loss: 4.0470e+01,   Y0: 2.4956e+00,  elapsed time 102
INFO   step:    23,    loss: 4.0467e+01,   Y0: 2.4967e+00,  elapsed time 105
INFO   step:    24,    loss: 4.0465e+01,   Y0: 2.4986e+00,  elapsed time 107
INFO   step:    25,    loss: 4.0463e+01,   Y0: 2.5001e+00,  elapsed time 109
INFO   step:    26,    loss: 4.0461e+01,   Y0: 2.5012e+00,  elapsed time 112
INFO   step:    27,    loss: 4.0460e+01,   Y0: 2.5011e+00,  elapsed time 114
INFO   step:    28,    loss: 4.0458e+01,   Y0: 2.5008e+00,  elapsed time 116
INFO   step:    29,    loss: 4.0455e+01,   Y0: 2.5002e+00,  elapsed time 119
INFO   step:    30,    loss: 4.0453e+01,   Y0: 2.4990e+00,  elapsed time 121
INFO   step:    31,    loss: 4.0450e+01,   Y0: 2.4985e+00,  elapsed time 123
INFO   step:    32,    loss: 4.0450e+01,   Y0: 2.4987e+00,  elapsed time 126
INFO   step:    33,    loss: 4.0449e+01,   Y0: 2.5001e+00,  elapsed time 128
INFO   step:    34,    loss: 4.0447e+01,   Y0: 2.5010e+00,  elapsed time 130
INFO   step:    35,    loss: 4.0446e+01,   Y0: 2.5028e+00,  elapsed time 133
INFO   step:    36,    loss: 4.0445e+01,   Y0: 2.5047e+00,  elapsed time 135
INFO   step:    37,    loss: 4.0444e+01,   Y0: 2.5063e+00,  elapsed time 137
INFO   step:    38,    loss: 4.0446e+01,   Y0: 2.5081e+00,  elapsed time 139
INFO   step:    39,    loss: 4.0448e+01,   Y0: 2.5102e+00,  elapsed time 142
INFO   step:    40,    loss: 4.0450e+01,   Y0: 2.5117e+00,  elapsed time 144
INFO   step:    41,    loss: 4.0448e+01,   Y0: 2.5139e+00,  elapsed time 147
INFO   step:    42,    loss: 4.0442e+01,   Y0: 2.5156e+00,  elapsed time 149
INFO   step:    43,    loss: 4.0436e+01,   Y0: 2.5171e+00,  elapsed time 151
INFO   step:    44,    loss: 4.0428e+01,   Y0: 2.5189e+00,  elapsed time 154
INFO   step:    45,    loss: 4.0420e+01,   Y0: 2.5205e+00,  elapsed time 156
INFO   step:    46,    loss: 4.0415e+01,   Y0: 2.5215e+00,  elapsed time 158
INFO   step:    47,    loss: 4.0409e+01,   Y0: 2.5218e+00,  elapsed time 161
INFO   step:    48,    loss: 4.0404e+01,   Y0: 2.5221e+00,  elapsed time 163
INFO   step:    49,    loss: 4.0399e+01,   Y0: 2.5229e+00,  elapsed time 165
INFO   step:    50,    loss: 4.0392e+01,   Y0: 2.5238e+00,  elapsed time 168
INFO   step:    51,    loss: 4.0383e+01,   Y0: 2.5246e+00,  elapsed time 170
INFO   step:    52,    loss: 4.0375e+01,   Y0: 2.5245e+00,  elapsed time 172
INFO   step:    53,    loss: 4.0369e+01,   Y0: 2.5232e+00,  elapsed time 174
INFO   step:    54,    loss: 4.0363e+01,   Y0: 2.5222e+00,  elapsed time 177
INFO   step:    55,    loss: 4.0356e+01,   Y0: 2.5215e+00,  elapsed time 179
INFO   step:    56,    loss: 4.0350e+01,   Y0: 2.5208e+00,  elapsed time 182
INFO   step:    57,    loss: 4.0345e+01,   Y0: 2.5200e+00,  elapsed time 184
INFO   step:    58,    loss: 4.0339e+01,   Y0: 2.5193e+00,  elapsed time 186
INFO   step:    59,    loss: 4.0333e+01,   Y0: 2.5184e+00,  elapsed time 189
INFO   step:    60,    loss: 4.0329e+01,   Y0: 2.5168e+00,  elapsed time 191
INFO   step:    61,    loss: 4.0324e+01,   Y0: 2.5157e+00,  elapsed time 193
INFO   step:    62,    loss: 4.0319e+01,   Y0: 2.5149e+00,  elapsed time 196
INFO   step:    63,    loss: 4.0313e+01,   Y0: 2.5140e+00,  elapsed time 198
INFO   step:    64,    loss: 4.0308e+01,   Y0: 2.5133e+00,  elapsed time 200
INFO   step:    65,    loss: 4.0303e+01,   Y0: 2.5124e+00,  elapsed time 203
INFO   step:    66,    loss: 4.0297e+01,   Y0: 2.5107e+00,  elapsed time 205
INFO   step:    67,    loss: 4.0291e+01,   Y0: 2.5088e+00,  elapsed time 207
INFO   step:    68,    loss: 4.0284e+01,   Y0: 2.5070e+00,  elapsed time 209
INFO   step:    69,    loss: 4.0277e+01,   Y0: 2.5051e+00,  elapsed time 212
INFO   step:    70,    loss: 4.0271e+01,   Y0: 2.5036e+00,  elapsed time 214
INFO   step:    71,    loss: 4.0265e+01,   Y0: 2.5026e+00,  elapsed time 217
INFO   step:    72,    loss: 4.0259e+01,   Y0: 2.5010e+00,  elapsed time 219
INFO   step:    73,    loss: 4.0254e+01,   Y0: 2.4993e+00,  elapsed time 221
INFO   step:    74,    loss: 4.0249e+01,   Y0: 2.4973e+00,  elapsed time 223
INFO   step:    75,    loss: 4.0245e+01,   Y0: 2.4959e+00,  elapsed time 226
INFO   step:    76,    loss: 4.0240e+01,   Y0: 2.4939e+00,  elapsed time 228
INFO   step:    77,    loss: 4.0236e+01,   Y0: 2.4924e+00,  elapsed time 231
INFO   step:    78,    loss: 4.0232e+01,   Y0: 2.4910e+00,  elapsed time 233
INFO   step:    79,    loss: 4.0228e+01,   Y0: 2.4903e+00,  elapsed time 235
INFO   step:    80,    loss: 4.0225e+01,   Y0: 2.4895e+00,  elapsed time 238
INFO   step:    81,    loss: 4.0221e+01,   Y0: 2.4886e+00,  elapsed time 240
INFO   step:    82,    loss: 4.0218e+01,   Y0: 2.4871e+00,  elapsed time 242
INFO   step:    83,    loss: 4.0218e+01,   Y0: 2.4855e+00,  elapsed time 245
INFO   step:    84,    loss: 4.0214e+01,   Y0: 2.4837e+00,  elapsed time 247
INFO   step:    85,    loss: 4.0208e+01,   Y0: 2.4821e+00,  elapsed time 249
INFO   step:    86,    loss: 4.0203e+01,   Y0: 2.4805e+00,  elapsed time 252
INFO   step:    87,    loss: 4.0197e+01,   Y0: 2.4792e+00,  elapsed time 254
INFO   step:    88,    loss: 4.0192e+01,   Y0: 2.4784e+00,  elapsed time 256
INFO   step:    89,    loss: 4.0187e+01,   Y0: 2.4787e+00,  elapsed time 258
INFO   step:    90,    loss: 4.0182e+01,   Y0: 2.4796e+00,  elapsed time 261
INFO   step:    91,    loss: 4.0177e+01,   Y0: 2.4796e+00,  elapsed time 263
INFO   step:    92,    loss: 4.0172e+01,   Y0: 2.4787e+00,  elapsed time 266
INFO   step:    93,    loss: 4.0168e+01,   Y0: 2.4773e+00,  elapsed time 268
INFO   step:    94,    loss: 4.0164e+01,   Y0: 2.4757e+00,  elapsed time 270
INFO   step:    95,    loss: 4.0160e+01,   Y0: 2.4746e+00,  elapsed time 272
INFO   step:    96,    loss: 4.0156e+01,   Y0: 2.4738e+00,  elapsed time 275
INFO   step:    97,    loss: 4.0151e+01,   Y0: 2.4736e+00,  elapsed time 277
INFO   step:    98,    loss: 4.0147e+01,   Y0: 2.4741e+00,  elapsed time 279
INFO   step:    99,    loss: 4.0144e+01,   Y0: 2.4745e+00,  elapsed time 282
INFO   step:   100,    loss: 4.0140e+01,   Y0: 2.4743e+00,  elapsed time 284
INFO   step:   101,    loss: 4.0136e+01,   Y0: 2.4737e+00,  elapsed time 286
INFO   step:   102,    loss: 4.0132e+01,   Y0: 2.4733e+00,  elapsed time 289
INFO   step:   103,    loss: 4.0128e+01,   Y0: 2.4737e+00,  elapsed time 291
INFO   step:   104,    loss: 4.0124e+01,   Y0: 2.4744e+00,  elapsed time 293
INFO   step:   105,    loss: 4.0120e+01,   Y0: 2.4747e+00,  elapsed time 296
INFO   step:   106,    loss: 4.0117e+01,   Y0: 2.4747e+00,  elapsed time 298
INFO   step:   107,    loss: 4.0114e+01,   Y0: 2.4749e+00,  elapsed time 300
INFO   step:   108,    loss: 4.0110e+01,   Y0: 2.4745e+00,  elapsed time 303
INFO   step:   109,    loss: 4.0108e+01,   Y0: 2.4738e+00,  elapsed time 305
INFO   step:   110,    loss: 4.0105e+01,   Y0: 2.4741e+00,  elapsed time 307
INFO   step:   111,    loss: 4.0102e+01,   Y0: 2.4741e+00,  elapsed time 310
INFO   step:   112,    loss: 4.0098e+01,   Y0: 2.4737e+00,  elapsed time 312
INFO   step:   113,    loss: 4.0095e+01,   Y0: 2.4735e+00,  elapsed time 314
INFO   step:   114,    loss: 4.0091e+01,   Y0: 2.4735e+00,  elapsed time 317
INFO   step:   115,    loss: 4.0087e+01,   Y0: 2.4738e+00,  elapsed time 319
INFO   step:   116,    loss: 4.0084e+01,   Y0: 2.4737e+00,  elapsed time 321
INFO   step:   117,    loss: 4.0081e+01,   Y0: 2.4736e+00,  elapsed time 324
INFO   step:   118,    loss: 4.0077e+01,   Y0: 2.4730e+00,  elapsed time 326
INFO   step:   119,    loss: 4.0073e+01,   Y0: 2.4726e+00,  elapsed time 328
INFO   step:   120,    loss: 4.0069e+01,   Y0: 2.4728e+00,  elapsed time 331
INFO   step:   121,    loss: 4.0065e+01,   Y0: 2.4728e+00,  elapsed time 333
INFO   step:   122,    loss: 4.0062e+01,   Y0: 2.4733e+00,  elapsed time 335
INFO   step:   123,    loss: 4.0059e+01,   Y0: 2.4736e+00,  elapsed time 338
INFO   step:   124,    loss: 4.0055e+01,   Y0: 2.4741e+00,  elapsed time 340
INFO   step:   125,    loss: 4.0052e+01,   Y0: 2.4745e+00,  elapsed time 342
INFO   step:   126,    loss: 4.0047e+01,   Y0: 2.4745e+00,  elapsed time 344
INFO   step:   127,    loss: 4.0043e+01,   Y0: 2.4738e+00,  elapsed time 347
INFO   step:   128,    loss: 4.0039e+01,   Y0: 2.4733e+00,  elapsed time 349
INFO   step:   129,    loss: 4.0035e+01,   Y0: 2.4731e+00,  elapsed time 352
INFO   step:   130,    loss: 4.0031e+01,   Y0: 2.4724e+00,  elapsed time 354
INFO   step:   131,    loss: 4.0027e+01,   Y0: 2.4720e+00,  elapsed time 356
INFO   step:   132,    loss: 4.0024e+01,   Y0: 2.4716e+00,  elapsed time 358
INFO   step:   133,    loss: 4.0020e+01,   Y0: 2.4713e+00,  elapsed time 361
INFO   step:   134,    loss: 4.0016e+01,   Y0: 2.4713e+00,  elapsed time 363
INFO   step:   135,    loss: 4.0010e+01,   Y0: 2.4718e+00,  elapsed time 366
INFO   step:   136,    loss: 4.0006e+01,   Y0: 2.4721e+00,  elapsed time 368
INFO   step:   137,    loss: 4.0002e+01,   Y0: 2.4723e+00,  elapsed time 370
INFO   step:   138,    loss: 3.9999e+01,   Y0: 2.4734e+00,  elapsed time 372
INFO   step:   139,    loss: 3.9995e+01,   Y0: 2.4742e+00,  elapsed time 375
INFO   step:   140,    loss: 3.9990e+01,   Y0: 2.4750e+00,  elapsed time 377
INFO   step:   141,    loss: 3.9985e+01,   Y0: 2.4752e+00,  elapsed time 379
INFO   step:   142,    loss: 3.9980e+01,   Y0: 2.4750e+00,  elapsed time 382
INFO   step:   143,    loss: 3.9975e+01,   Y0: 2.4742e+00,  elapsed time 384
INFO   step:   144,    loss: 3.9969e+01,   Y0: 2.4746e+00,  elapsed time 386
INFO   step:   145,    loss: 3.9964e+01,   Y0: 2.4754e+00,  elapsed time 389
INFO   step:   146,    loss: 3.9960e+01,   Y0: 2.4758e+00,  elapsed time 391
INFO   step:   147,    loss: 3.9956e+01,   Y0: 2.4762e+00,  elapsed time 393
INFO   step:   148,    loss: 3.9952e+01,   Y0: 2.4765e+00,  elapsed time 396
INFO   step:   149,    loss: 3.9948e+01,   Y0: 2.4772e+00,  elapsed time 398
Delta:  100 ,  100.05
Other1:  -10.05 ,  -10
Other2:  -10.05 ,  -10
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_10:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_11:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_12:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_13:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_14:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_15:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_16:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_17:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_18:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_19:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_20:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_21:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_22:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_23:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_24:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_25:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_26:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_27:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_28:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_29:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_30:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_31:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_32:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_33:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_34:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_35:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_36:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_37:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_38:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_39:0' shape=(?, 3) dtype=float64>]
num_iterations:  150
total time intervals:  40
# of dimensions:  3
Loss out:  44.07233296265527
Output_Z_Vals:  [[[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
  [ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
  [ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
  ...
  [ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
  [ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
  [ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]]

 [[ 1.84272257e-01 -6.47846707e-02  3.57985733e-01]
  [-1.64806985e-01  2.09498559e-01  2.44620465e-01]
  [-8.39812849e-02 -1.12849485e-02 -2.32978329e-03]
  ...
  [-8.96636370e-02 -5.39787873e-03  8.97961318e-03]
  [-9.67307592e-02  1.19278322e-02  3.24064031e-02]
  [-1.81210871e-01  1.95077224e-01  2.51402019e-01]]

 [[-8.52458913e-02  5.29645885e-02  7.61225314e-02]
  [-1.16136697e-01 -2.61850179e-02  1.29379301e-01]
  [-6.34678023e-02  5.87196231e-02  5.65335576e-02]
  ...
  [-3.09598636e-02  1.02436456e-02 -3.11885795e-02]
  [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
  [-7.05733705e-02  5.10296101e-02  5.11739494e-02]]

 ...

 [[ 4.61031802e-03  4.70384806e-03 -4.63448080e-02]
  [ 2.48697264e-01  1.89348308e-01  5.56336822e-02]
  [-1.71377892e-02 -2.18230969e-02 -4.47999850e-02]
  ...
  [ 1.16374386e-01  9.07951669e-02 -2.15102916e-02]
  [ 1.30023016e-01  1.07622491e-01  3.97834561e-02]
  [ 7.74349879e-02  6.65998076e-02 -3.16536318e-02]]

 [[-6.64309925e-02  8.40513051e-02 -5.31249943e-03]
  [-1.38928587e-01  1.72647651e-01  1.07727888e-05]
  [-9.01594413e-02  7.02121247e-03 -1.26948103e-04]
  ...
  [-1.56802791e-02  6.45837241e-02 -1.08707371e-02]
  [-1.21488490e-01  2.28739659e-01  1.31231133e-02]
  [-2.35494649e-02  7.03658420e-02 -1.00674554e-02]]

 [[-7.32523634e-02 -2.18077868e-01  7.76876520e-02]
  [ 1.44159076e-03 -2.02364319e-01  6.32071987e-02]
  [ 1.96271725e-04 -2.80885398e-01  1.01710479e-01]
  ...
  [-9.25274207e-02 -2.04625945e-01  5.36791060e-02]
  [ 1.48281519e-03 -2.04892276e-01  6.44015759e-02]
  [-1.01171326e-01 -1.93084947e-01  3.84949162e-02]]]
Z_Vals dimensionality:  (40, 200, 3)
X_test:  [[[100.          98.67712308  99.01543699 ... 103.29712856 103.44632467
   105.94267607]
  [ -1.          -1.04857236  -1.16597068 ...  -1.11958633  -0.62471801
    -0.60255863]
  [ -1.          -0.99430589  -0.98006957 ...  -0.96657178  -0.97003156
    -1.00761394]]

 [[100.          99.31744962  98.26687267 ...  93.32278864  94.38125377
    93.49660661]
  [ -1.          -0.9654236   -0.74841353 ...  -1.03594118  -1.04700619
    -1.23256658]
  [ -1.          -1.01650241  -0.99071833 ...  -0.91714115  -0.92631164
    -0.8956063 ]]

 [[100.         100.59655991 100.96982894 ... 100.42794747  99.43609389
   100.20514686]
  [ -1.          -1.10797919  -1.57356447 ...  -1.003984    -1.06754249
    -0.9638992 ]
  [ -1.          -1.03182249  -1.03584833 ...  -0.85771017  -0.85055812
    -0.85028649]]

 ...

 [[100.         100.61848649 101.36336697 ... 105.97918879 104.8505237
   105.55828757]
  [ -1.          -1.05773188  -1.28502087 ...  -0.53455572  -0.59409892
    -0.50683208]
  [ -1.          -0.98595186  -0.97834564 ...  -1.02918051  -1.06854656
    -1.09681328]]

 [[100.          99.95044576  99.85779541 ...  95.87973926  95.71582562
    95.09574819]
  [ -1.          -1.26102974  -1.1780756  ...  -0.3379219   -0.29276064
    -0.29936932]
  [ -1.          -0.98116408  -0.96724925 ...  -0.99572695  -1.02763428
    -1.03555949]]

 [[100.          99.28538656  98.89656431 ... 105.68739287 105.94642964
   106.14585336]
  [ -1.          -0.95463714  -0.67308891 ...  -0.73980011  -0.86842242
    -0.92753876]
  [ -1.          -0.98118275  -0.93734621 ...  -0.90370416  -0.89613572
    -0.90982325]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [ 1.84272257e-01 -6.47846707e-02  3.57985733e-01]
 [-8.52458913e-02  5.29645885e-02  7.61225314e-02]
 [ 2.14876244e-01  1.81442287e-01  2.57485228e-01]
 [-1.38532508e-02  3.01881241e-02  1.23476941e-01]
 [-8.21077652e-01 -2.45728799e-01  3.25885617e-02]
 [-2.45853965e-02 -5.72100057e-02 -5.50216452e-02]
 [ 1.97487530e-02  1.07583905e-01  3.40704961e-02]
 [ 2.72176182e-01 -1.10276508e-01 -5.13414851e-02]
 [-5.11140120e-01 -2.72605286e-02 -6.59273096e-02]
 [ 1.25326751e-02  4.19402097e-02 -1.36494476e-02]
 [-1.99613263e-02 -2.12199831e-01  1.51833887e-01]
 [-2.25133315e-01  3.61842983e-02  1.92160709e-01]
 [ 3.51287250e-02  9.18881741e-03  2.11582770e-01]
 [ 2.23436389e-02  4.28664097e-01  3.83598783e-01]
 [ 5.91762798e-02 -1.14405000e-01 -4.46887623e-02]
 [-1.49923640e-02 -9.68439093e-03  3.58635260e-02]
 [-5.57251149e-01 -2.44383506e-01  1.59206024e-01]
 [-1.24672032e-01  1.85411113e-02 -2.25526625e-02]
 [ 1.65880159e-01  8.52242462e-01  2.63217595e-01]
 [-2.35103561e-02  4.45849265e-02  2.56154425e-02]
 [ 2.88911236e-02 -1.45258172e-01  7.01556250e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.72496263e-01 -2.69743493e-02  1.74648540e-01]
 [ 7.52325901e-02 -1.95516547e-01 -8.33129494e-02]
 [-1.04915230e-01  1.32541741e-01  1.53823805e-01]
 [ 1.45179773e-02  6.29252307e-02 -7.00690359e-03]
 [-1.70269579e-01 -4.53177821e-02  2.17623580e-01]
 [ 5.69134957e-02  6.23959148e-02 -8.77135080e-02]
 [-6.17123673e-01 -6.05166164e-02 -9.06133728e-01]
 [-1.61055023e-01  1.28228194e-01 -4.41662910e-02]
 [-1.10950557e-01 -1.12346848e-02  1.20964985e-01]
 [ 1.87664338e-02  9.94676938e-02  2.23142947e-03]
 [-1.66027488e-01 -2.87067519e-03 -1.21578641e-01]
 [-6.04229262e-02  3.34568897e-02  7.21503827e-02]
 [ 1.62891047e-01 -1.61620336e-01 -9.81642770e-02]
 [-5.12871399e-03  1.21638118e-01  7.90897650e-02]
 [ 4.61031802e-03  4.70384806e-03 -4.63448080e-02]
 [-6.64309925e-02  8.40513051e-02 -5.31249943e-03]
 [-7.32523634e-02 -2.18077868e-01  7.76876520e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.10680327]
curr_Stock_Price:  98.6771230795439
curr_Factors:  [98.67712308 -1.04857236 -0.99430589]
mat_Sqrt:  [[12.79398176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01998385 -0.02048671  1.02123365]
Stock Position:  0.01998385335739431
Bond Position:  [-9.07875243]


portfolio before change:  [-7.10117737]
curr_Stock_Price:  99.01543698603433
curr_Factors:  [99.01543699 -1.16597068 -0.98006957]
mat_Sqrt:  [[11.57949104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00590181  0.01674887  0.21715639]
Stock Position:  -0.005901805586726374
Bond Position:  [-6.51680751]


portfolio before change:  [-7.10645416]
curr_Stock_Price:  99.77149902947278
curr_Factors:  [99.77149903 -1.15731242 -0.99553605]
mat_Sqrt:  [[11.58874177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02348141 0.05737709 0.73453369]
Stock Position:  0.023481411636432536
Bond Position:  [-9.4492298]


portfolio before change:  [-7.10634067]
curr_Stock_Price:  99.82663686018505
curr_Factors:  [99.82663686 -1.06996101 -1.0074933 ]
mat_Sqrt:  [[12.5031516   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00097022 0.00954632 0.35224534]
Stock Position:  0.0009702216485602532
Bond Position:  [-7.20319463]


portfolio before change:  [-7.10680158]
curr_Stock_Price:  100.27967258067675
curr_Factors:  [100.27967258  -1.08985134  -1.02116525]
mat_Sqrt:  [[12.14535042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06757897 -0.07770627  0.0929661 ]
Stock Position:  -0.06757896652530956
Bond Position:  [-0.33000494]


portfolio before change:  [-7.11025203]
curr_Stock_Price:  100.330120201121
curr_Factors:  [100.3301202   -0.8545561   -1.03231589]
mat_Sqrt:  [[15.20453837  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245281 -0.01809139 -0.15696144]
Stock Position:  -0.0024528070412967343
Bond Position:  [-6.86416161]


portfolio before change:  [-7.11375543]
curr_Stock_Price:  101.40860988590774
curr_Factors:  [101.40860989  -0.91963168  -1.01876116]
mat_Sqrt:  [[14.59625736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00201978 0.03402102 0.09719364]
Stock Position:  0.0020197758672358796
Bond Position:  [-7.3185781]


portfolio before change:  [-7.11472041]
curr_Stock_Price:  101.38380812262314
curr_Factors:  [101.38380812  -0.77397742  -1.0314139 ]
mat_Sqrt:  [[16.66852282  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0155292  -0.03487249 -0.14646297]
Stock Position:  0.015529199579329061
Bond Position:  [-8.6891298]


portfolio before change:  [-7.11121182]
curr_Stock_Price:  101.67968943759232
curr_Factors:  [101.67968944  -0.78620024  -1.04264951]
mat_Sqrt:  [[16.32957412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03216871 -0.00862054 -0.18807226]
Stock Position:  -0.0321687103069622
Bond Position:  [-3.84030734]


portfolio before change:  [-7.14621844]
curr_Stock_Price:  102.75298560118169
curr_Factors:  [102.7529856   -0.89897789  -1.07309498]
mat_Sqrt:  [[14.29993561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0007573   0.01326266 -0.03893807]
Stock Position:  0.0007573030481090473
Bond Position:  [-7.22403359]


portfolio before change:  [-7.14662288]
curr_Stock_Price:  103.41139616632124
curr_Factors:  [103.41139617  -1.06720686  -1.04560427]
mat_Sqrt:  [[12.5021927   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00044413 -0.06710348  0.43313982]
Stock Position:  0.00044413489152244305
Bond Position:  [-7.19255149]


portfolio before change:  [-7.14703294]
curr_Stock_Price:  104.51257264856594
curr_Factors:  [104.51257265  -1.21860863  -1.0466718 ]
mat_Sqrt:  [[10.84850138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01705069  0.01144248  0.54818101]
Stock Position:  -0.01705068686974964
Bond Position:  [-5.36502179]


portfolio before change:  [-7.14230616]
curr_Stock_Price:  104.19601987832007
curr_Factors:  [104.19601988  -1.0051827   -1.07507526]
mat_Sqrt:  [[13.01387341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00603626 0.00290576 0.60358675]
Stock Position:  0.006036260594550111
Bond Position:  [-7.77126049]


portfolio before change:  [-7.14456865]
curr_Stock_Price:  103.98214273115113
curr_Factors:  [103.98214273  -0.76222395  -1.06637443]
mat_Sqrt:  [[16.70354211  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00668801 0.13555549 1.09430055]
Stock Position:  0.006688010919551945
Bond Position:  [-7.84000236]


portfolio before change:  [-7.14621739]
curr_Stock_Price:  103.88216058650154
curr_Factors:  [103.88216059  -0.69855685  -1.05896781]
mat_Sqrt:  [[17.91668706  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00262885 -0.03617804 -0.1274846 ]
Stock Position:  0.002628850963093125
Bond Position:  [-7.41930811]


portfolio before change:  [-7.14668077]
curr_Stock_Price:  104.05870042430675
curr_Factors:  [104.05870042  -0.89993167  -1.02588316]
mat_Sqrt:  [[15.16727796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0005223  -0.00306247  0.10230866]
Stock Position:  -0.0005222955811735481
Bond Position:  [-7.09233137]


portfolio before change:  [-7.14785052]
curr_Stock_Price:  104.60083919748023
curr_Factors:  [104.6008392   -1.17093965  -1.01714038]
mat_Sqrt:  [[11.72908374  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04527748 -0.07728085  0.45417047]
Stock Position:  -0.04527747620414292
Bond Position:  [-2.41178851]


portfolio before change:  [-7.13822233]
curr_Stock_Price:  104.38153192065073
curr_Factors:  [104.38153192  -1.07414105  -1.0129863 ]
mat_Sqrt:  [[12.94779382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0099474   0.00586321 -0.06433647]
Stock Position:  -0.009947397012094095
Bond Position:  [-6.09989779]


portfolio before change:  [-7.13661478]
curr_Stock_Price:  104.1432699175007
curr_Factors:  [104.14326992  -1.08247315  -1.04741449]
mat_Sqrt:  [[12.377495    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01952043 0.26950273 0.75088653]
Stock Position:  0.019520430520651742
Bond Position:  [-9.16953625]


portfolio before change:  [-7.14135542]
curr_Stock_Price:  103.95913591352075
curr_Factors:  [103.95913591  -1.20413148  -1.06364012]
mat_Sqrt:  [[10.76420522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00159143  0.01409899  0.07307373]
Stock Position:  -0.001591427104247554
Bond Position:  [-6.97591203]


portfolio before change:  [-7.14212493]
curr_Stock_Price:  103.89470463232071
curr_Factors:  [103.89470463  -1.21350666  -1.08763401]
mat_Sqrt:  [[10.40448806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00379269 -0.04593467  0.20013447]
Stock Position:  0.0037926931653515217
Bond Position:  [-7.53616566]


portfolio before change:  [-7.14090679]
curr_Stock_Price:  104.46427855289504
curr_Factors:  [104.46427855  -1.17922703  -1.10476462]
mat_Sqrt:  [[10.64247994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365224  0.01916992 -0.08961985]
Stock Position:  -0.003652237439483766
Bond Position:  [-6.75937844]


portfolio before change:  [-7.13979336]
curr_Stock_Price:  103.92805755989635
curr_Factors:  [103.92805756  -1.32780472  -1.10511565]
mat_Sqrt:  [[ 9.12281611  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02273966 -0.00853004  0.49822367]
Stock Position:  0.022739663894197657
Bond Position:  [-9.50308245]


portfolio before change:  [-7.13331431]
curr_Stock_Price:  104.26522188269404
curr_Factors:  [104.26522188  -1.48566406  -1.09154998]
mat_Sqrt:  [[ 7.92263482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00671218 -0.06182776 -0.23766865]
Stock Position:  0.0067121849232513265
Bond Position:  [-7.83316176]


portfolio before change:  [-7.13732581]
curr_Stock_Price:  103.8134630492801
curr_Factors:  [103.81346305  -1.80048098  -1.06692062]
mat_Sqrt:  [[ 5.9014263   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01187744  0.04191338  0.4388165 ]
Stock Position:  -0.01187744465848752
Bond Position:  [-5.90428714]


portfolio before change:  [-7.1383521]
curr_Stock_Price:  103.83772875267952
curr_Factors:  [103.83772875  -1.84322757  -1.03352508]
mat_Sqrt:  [[ 5.84786558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00251586  0.01989871 -0.01998875]
Stock Position:  0.002515861788932875
Bond Position:  [-7.39959348]


portfolio before change:  [-7.13970228]
curr_Stock_Price:  103.66873416769481
curr_Factors:  [103.66873417  -1.6781752   -1.00889553]
mat_Sqrt:  [[ 7.05777491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01799681 -0.01433074  0.6208195 ]
Stock Position:  -0.017996812481825223
Bond Position:  [-5.27399551]


portfolio before change:  [-7.1467308]
curr_Stock_Price:  104.02264283001533
curr_Factors:  [104.02264283  -1.49847092  -1.02935925]
mat_Sqrt:  [[ 8.30434125  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00489143  0.01973132 -0.25022222]
Stock Position:  0.00489143030375329
Bond Position:  [-7.6555503]


portfolio before change:  [-7.14667878]
curr_Stock_Price:  104.22892613314909
curr_Factors:  [104.22892613  -1.71344379  -1.03260497]
mat_Sqrt:  [[ 6.68951203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12013581 -0.01913703 -2.58494731]
Stock Position:  -0.12013581473568687
Bond Position:  [5.37494818]


portfolio before change:  [-7.16162442]
curr_Stock_Price:  104.35892524034723
curr_Factors:  [104.35892524  -1.72065051  -1.02580293]
mat_Sqrt:  [[ 6.69514553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02490754  0.04054932 -0.12599413]
Stock Position:  -0.02490753805323708
Bond Position:  [-4.56230052]


portfolio before change:  [-7.16225766]
curr_Stock_Price:  104.36145133259775
curr_Factors:  [104.36145133  -1.51406596  -1.0211966 ]
mat_Sqrt:  [[ 8.2696965   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01046577 -0.00355272  0.34507943]
Stock Position:  -0.010465772350620881
Bond Position:  [-6.07003447]


portfolio before change:  [-7.17120694]
curr_Stock_Price:  105.14404770995394
curr_Factors:  [105.14404771  -1.38726776  -1.00326669]
mat_Sqrt:  [[ 9.62916819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00226293 0.03145445 0.00636565]
Stock Position:  0.002262933493113747
Bond Position:  [-7.40914092]


portfolio before change:  [-7.1712118]
curr_Stock_Price:  105.55118862451758
curr_Factors:  [105.55118862  -1.41118008  -0.99147912]
mat_Sqrt:  [[ 9.54995873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01999158 -0.00090779 -0.34683002]
Stock Position:  -0.01999157799200455
Bond Position:  [-5.06107698]


portfolio before change:  [-7.16091095]
curr_Stock_Price:  105.0042817876929
curr_Factors:  [105.00428179  -1.40469988  -0.97456072]
mat_Sqrt:  [[ 9.72539521  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460973  0.01058     0.20582496]
Stock Position:  -0.00460972914718087
Bond Position:  [-6.67686965]


portfolio before change:  [-7.16008594]
curr_Stock_Price:  104.64424629054255
curr_Factors:  [104.64424629  -1.45752896  -0.97537474]
mat_Sqrt:  [[ 9.18583629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01509719 -0.05110884 -0.28003536]
Stock Position:  0.015097191366776142
Bond Position:  [-8.73992015]


portfolio before change:  [-7.1743843]
curr_Stock_Price:  103.76952752211754
curr_Factors:  [103.76952752  -1.41815177  -0.98526486]
mat_Sqrt:  [[ 9.38165071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00150891 0.03846535 0.22562109]
Stock Position:  0.0015089134994252114
Bond Position:  [-7.33096354]


portfolio before change:  [-7.17593893]
curr_Stock_Price:  103.3465725340462
curr_Factors:  [103.34657253  -1.27723879  -0.95949094]
mat_Sqrt:  [[11.03816034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042836  0.00148749 -0.13220884]
Stock Position:  -0.00042836154865986845
Bond Position:  [-7.13166923]


portfolio before change:  [-7.17680926]
curr_Stock_Price:  103.2971285616951
curr_Factors:  [103.29712856  -1.11958633  -0.96657178]
mat_Sqrt:  [[12.82570638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00509486  0.02657936 -0.01515508]
Stock Position:  -0.005094862192054628
Bond Position:  [-6.65052463]


portfolio before change:  [-7.17840076]
curr_Stock_Price:  103.44632467072113
curr_Factors:  [103.44632467  -0.62471801  -0.97003156]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.17840076]
Stock Price:  105.94267607426508
PL:  [-13.12107684]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.64806985e-01  2.09498559e-01  2.44620465e-01]
 [-1.16136697e-01 -2.61850179e-02  1.29379301e-01]
 [ 1.80725051e-01  2.13088151e-01  3.40738816e-01]
 [-4.04953537e-02 -7.55481930e-02  7.59989178e-02]
 [-3.04670798e-02 -2.17791077e-02  5.19090531e-02]
 [ 1.38914207e-01 -3.02167960e-01 -4.24141430e-01]
 [-5.47359889e-04 -5.44001730e-01 -8.74014957e-02]
 [ 9.82463670e-02  3.59409102e-01 -3.28315096e-02]
 [ 7.11878244e-02  2.74920913e-02 -3.73924616e-02]
 [ 1.64552531e-01  8.83365091e-02  4.51175580e-01]
 [ 2.52362307e-01 -1.72215448e-01 -8.97001880e-02]
 [-1.60594686e-01 -1.19216923e-01 -2.61493023e-01]
 [ 3.19888815e-01 -4.06288947e-01 -1.34034322e-01]
 [ 6.85489482e-02 -9.46575266e-02 -5.19939544e-02]
 [-1.72711538e-01  2.62191490e-01  1.91808015e-01]
 [ 6.26810641e-02 -4.42275898e-01 -1.19247019e-01]
 [ 1.50693238e-01 -2.06134324e-01 -1.13123395e-01]
 [-3.28961233e-01 -1.28419411e-01 -3.74716458e-02]
 [ 2.10477132e-01  1.21202278e+00  2.56352383e-01]
 [-3.64832858e-01 -6.14251380e-02  2.77614186e-01]
 [-8.40511605e-02 -9.66735563e-02 -4.85319524e-02]
 [ 2.48095412e-01 -6.51024650e-02  1.25803777e-01]
 [-9.49023703e-02  6.84159913e-02 -1.13842533e-01]
 [-6.12643281e-03 -1.06872751e-01  1.04840619e-01]
 [-1.00549366e-01  7.10858223e-02 -4.86275536e-02]
 [ 8.45860383e-02 -1.62943472e-01 -1.97313970e-01]
 [ 4.70361756e-02 -5.18284343e-02  1.05998510e-01]
 [-1.49042550e-01  3.99271645e-02  1.42044735e-01]
 [-3.90680499e-01 -2.26745329e-02 -5.83329948e-01]
 [ 2.44180362e-01 -1.67307362e-01 -1.70678459e-01]
 [ 1.34505362e-01  5.72781730e-03 -3.78012009e-02]
 [ 3.93337583e-02  2.20677580e-01 -7.03469926e-02]
 [-1.66550485e-01  2.73128477e-02 -1.62517847e-01]
 [-2.90751031e-03  1.38037257e-01  9.45432298e-02]
 [-2.55200464e-01  7.72818904e-02 -1.78356810e-02]
 [-1.69166507e-01 -5.25243147e-02 -3.22452893e-02]
 [ 2.48697264e-01  1.89348308e-01  5.56336822e-02]
 [-1.38928587e-01  1.72647651e-01  1.07727888e-05]
 [ 1.44159076e-03 -2.02364319e-01  6.32071987e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.51104719]
curr_Stock_Price:  99.31744961805549
curr_Factors:  [99.31744962 -0.9654236  -1.01650241]
mat_Sqrt:  [[13.6862991   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00799813  0.06624926  0.6978341 ]
Stock Position:  -0.007998130917569303
Bond Position:  [-1.71669322]


portfolio before change:  [-2.50285913]
curr_Stock_Price:  98.26687267319133
curr_Factors:  [98.26687267 -0.74841353 -0.99071833]
mat_Sqrt:  [[17.26282102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00523688 -0.00828043  0.36908313]
Stock Position:  -0.00523688176147254
Bond Position:  [-1.98824714]


portfolio before change:  [-2.49808323]
curr_Stock_Price:  97.30743692716152
curr_Factors:  [97.30743693 -0.91772393 -0.96718642]
mat_Sqrt:  [[14.77542121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01731118 0.06738439 0.972033  ]
Stock Position:  0.01731118049487001
Bond Position:  [-4.18258983]


portfolio before change:  [-2.50902022]
curr_Stock_Price:  96.70585281915218
curr_Factors:  [96.70585282 -0.87554475 -0.9226504 ]
mat_Sqrt:  [[16.01424708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016818  -0.02389044  0.21680376]
Stock Position:  -0.0016818015499361519
Bond Position:  [-2.34638016]


portfolio before change:  [-2.50844476]
curr_Stock_Price:  96.18928226167344
curr_Factors:  [96.18928226 -1.05597533 -0.91631819]
mat_Sqrt:  [[13.38352436  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152677 -0.00688716  0.14808208]
Stock Position:  -0.0015267669655932674
Bond Position:  [-2.36158615]


portfolio before change:  [-2.50834815]
curr_Stock_Price:  95.93264183198856
curr_Factors:  [95.93264183 -1.0577155  -0.88855824]
mat_Sqrt:  [[13.69968111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00325079 -0.0955539  -1.20995744]
Stock Position:  0.0032507878729120913
Bond Position:  [-2.82020482]


portfolio before change:  [-2.51051719]
curr_Stock_Price:  95.37385734009457
curr_Factors:  [95.37385734 -1.07730118 -0.88777937]
mat_Sqrt:  [[13.36613082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242659 -0.17202845 -0.24933214]
Stock Position:  -0.0024265945167364256
Bond Position:  [-2.27908351]


portfolio before change:  [-2.51061941]
curr_Stock_Price:  95.298574296433
curr_Factors:  [95.2985743  -0.83063149 -0.89442955]
mat_Sqrt:  [[16.97860147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00593833  0.11365514 -0.09365916]
Stock Position:  0.005938331633983452
Bond Position:  [-3.07653395]


portfolio before change:  [-2.50891191]
curr_Stock_Price:  95.65087667654261
curr_Factors:  [95.65087668 -0.88584986 -0.91798123]
mat_Sqrt:  [[15.75052613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00408018  0.00869376 -0.10667028]
Stock Position:  0.00408017880538745
Bond Position:  [-2.89918459]


portfolio before change:  [-2.51192199]
curr_Stock_Price:  95.00196899094779
curr_Factors:  [95.00196899 -0.91831155 -0.93162905]
mat_Sqrt:  [[14.93872779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01733275 0.02793446 1.28707835]
Stock Position:  0.017332747712418876
Bond Position:  [-4.15856715]


portfolio before change:  [-2.51281811]
curr_Stock_Price:  94.98026044368194
curr_Factors:  [94.98026044 -0.91857567 -0.96002095]
mat_Sqrt:  [[14.51340148  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01582026 -0.05445931 -0.25588967]
Stock Position:  0.015820257543070423
Bond Position:  [-4.0154303]


portfolio before change:  [-2.49408728]
curr_Stock_Price:  96.19596738273836
curr_Factors:  [96.19596738 -1.12020802 -0.95703021]
mat_Sqrt:  [[12.05101888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01801092 -0.0376997  -0.74596681]
Stock Position:  -0.01801091641041836
Bond Position:  [-0.76150975]


portfolio before change:  [-2.4899651]
curr_Stock_Price:  95.9618106483137
curr_Factors:  [95.96181065 -1.12876028 -0.92686523]
mat_Sqrt:  [[12.28433412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02295923 -0.12847985 -0.38236261]
Stock Position:  0.022959228863419383
Bond Position:  [-4.69317427]


portfolio before change:  [-2.50379179]
curr_Stock_Price:  95.38513557330162
curr_Factors:  [95.38513557 -0.86580292 -0.9538251 ]
mat_Sqrt:  [[15.46059816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00358923 -0.02993334 -0.14832428]
Stock Position:  0.00358923240142271
Bond Position:  [-2.84615121]


portfolio before change:  [-2.50112087]
curr_Stock_Price:  96.22841304482002
curr_Factors:  [96.22841304 -0.93981243 -0.94396446]
mat_Sqrt:  [[14.62815026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00866748  0.08291223  0.54717488]
Stock Position:  -0.008667475586300348
Bond Position:  [-1.66706345]


portfolio before change:  [-2.49468721]
curr_Stock_Price:  95.46209420482302
curr_Factors:  [95.4620942  -0.88419457 -0.93219968]
mat_Sqrt:  [[15.52318954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017342  -0.13985992 -0.34017855]
Stock Position:  0.0017342024736026196
Bond Position:  [-2.66023781]


portfolio before change:  [-2.49626141]
curr_Stock_Price:  94.7461161931412
curr_Factors:  [94.74611619 -0.92403689 -0.94301749]
mat_Sqrt:  [[14.64569552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00834919 -0.0651854  -0.32270956]
Stock Position:  0.008349187387912129
Bond Position:  [-3.28731449]


portfolio before change:  [-2.49978474]
curr_Stock_Price:  94.37333907114227
curr_Factors:  [94.37333907 -0.77669873 -0.95117331]
mat_Sqrt:  [[16.76656234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02027404 -0.04060978 -0.10689618]
Stock Position:  -0.02027403521230708
Bond Position:  [-0.58645634]


portfolio before change:  [-2.49384889]
curr_Stock_Price:  94.07694231976534
curr_Factors:  [94.07694232 -1.00996271 -0.94753689]
mat_Sqrt:  [[13.28470515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02213818 0.38327526 0.731302  ]
Stock Position:  0.022138175729385732
Bond Position:  [-4.57654077]


portfolio before change:  [-2.49173577]
curr_Stock_Price:  94.1982361142154
curr_Factors:  [94.19823611 -1.00418984 -0.93978298]
mat_Sqrt:  [[13.48298663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02297348 -0.01942433  0.791956  ]
Stock Position:  -0.022973477504258676
Bond Position:  [-0.32767471]


portfolio before change:  [-2.49622228]
curr_Stock_Price:  94.39174398934206
curr_Factors:  [94.39174399 -1.39426265 -0.92485125]
mat_Sqrt:  [[ 9.28443842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01038876 -0.03057086 -0.13844815]
Stock Position:  -0.010388760193616592
Bond Position:  [-1.51560909]


portfolio before change:  [-2.49652229]
curr_Stock_Price:  94.4023844611751
curr_Factors:  [94.40238446 -1.6141444  -0.94882016]
mat_Sqrt:  [[ 7.27614922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03739534 -0.02058721  0.35888316]
Stock Position:  0.03739533838690848
Bond Position:  [-6.0267314]


portfolio before change:  [-2.48013019]
curr_Stock_Price:  94.8608771693748
curr_Factors:  [94.86087717 -1.92722086 -0.91306669]
mat_Sqrt:  [[ 5.54071647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0210034   0.02163504 -0.32476106]
Stock Position:  -0.021003400424295864
Bond Position:  [-0.4877292]


portfolio before change:  [-2.47454062]
curr_Stock_Price:  94.59184750831542
curr_Factors:  [94.59184751 -1.73234012 -0.91294275]
mat_Sqrt:  [[ 6.71462795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186379 -0.03379613  0.2990811 ]
Stock Position:  0.0018637855159432577
Bond Position:  [-2.65083953]


portfolio before change:  [-2.47488653]
curr_Stock_Price:  94.58404923712436
curr_Factors:  [94.58404924 -1.46028997 -0.9075625 ]
mat_Sqrt:  [[ 8.86079404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01226075  0.02247931 -0.13872088]
Stock Position:  -0.012260751756120167
Bond Position:  [-1.31521498]


portfolio before change:  [-2.47966343]
curr_Stock_Price:  94.96024852531698
curr_Factors:  [94.96024853 -1.47110207 -0.91950767]
mat_Sqrt:  [[ 8.69587371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00461165 -0.05152725 -0.56288183]
Stock Position:  0.004611648227896194
Bond Position:  [-2.91758669]


portfolio before change:  [-2.48124552]
curr_Stock_Price:  94.69627157925541
curr_Factors:  [94.69627158 -1.52060874 -0.87367277]
mat_Sqrt:  [[ 8.6399183   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00779346 -0.01638959  0.30238425]
Stock Position:  0.007793456388978006
Bond Position:  [-3.21925678]


portfolio before change:  [-2.48142568]
curr_Stock_Price:  94.72479143853549
curr_Factors:  [94.72479144 -1.29289339 -0.89024111]
mat_Sqrt:  [[10.6743243   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01114983  0.01262608  0.40521409]
Stock Position:  -0.01114982748388615
Bond Position:  [-1.4252606]


portfolio before change:  [-2.47558696]
curr_Stock_Price:  94.18515195917448
curr_Factors:  [94.18515196 -1.21153663 -0.86773063]
mat_Sqrt:  [[11.77519604  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04334006 -0.00717032 -1.66407797]
Stock Position:  -0.043340058028782616
Bond Position:  [1.60640299]


portfolio before change:  [-2.48024766]
curr_Stock_Price:  94.29732322059087
curr_Factors:  [94.29732322 -1.03031672 -0.860318  ]
mat_Sqrt:  [[14.23662804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01440095 -0.05290723 -0.48689814]
Stock Position:  0.014400945868202
Bond Position:  [-3.83821831]


portfolio before change:  [-2.47851857]
curr_Stock_Price:  94.45070901963771
curr_Factors:  [94.45070902 -1.06809681 -0.88979472]
mat_Sqrt:  [[13.33225886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00952105  0.00181129 -0.1078363 ]
Stock Position:  0.009521050910750202
Bond Position:  [-3.37778857]


portfolio before change:  [-2.47461949]
curr_Stock_Price:  94.90457998569944
curr_Factors:  [94.90457999 -1.03055067 -0.87240284]
mat_Sqrt:  [[14.15288458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0021672   0.06978438 -0.20068039]
Stock Position:  0.0021671984243131887
Bond Position:  [-2.68029654]


portfolio before change:  [-2.47629477]
curr_Stock_Price:  94.28616416712394
curr_Factors:  [94.28616417 -0.92592029 -0.88533306]
mat_Sqrt:  [[15.41099329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0129141   0.00863708 -0.46361818]
Stock Position:  -0.01291409860304133
Bond Position:  [-1.25867395]


portfolio before change:  [-2.46491172]
curr_Stock_Price:  93.39253661177565
curr_Factors:  [93.39253661 -0.93816344 -0.86428783]
mat_Sqrt:  [[15.39988688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0012958  0.04365121 0.26970552]
Stock Position:  0.001295798630413888
Bond Position:  [-2.58592965]


portfolio before change:  [-2.46592866]
curr_Stock_Price:  92.85720711695001
curr_Factors:  [92.85720712 -0.89958572 -0.8925791 ]
mat_Sqrt:  [[15.46992913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0166029   0.02443868 -0.05088023]
Stock Position:  -0.01660290396602091
Bond Position:  [-0.92422937]


portfolio before change:  [-2.474125]
curr_Stock_Price:  93.34391693699673
curr_Factors:  [93.34391694 -0.93664082 -0.94009302]
mat_Sqrt:  [[14.28995524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01239365 -0.01660965 -0.09198684]
Stock Position:  -0.012393651244289256
Bond Position:  [-1.31725304]


portfolio before change:  [-2.4680107]
curr_Stock_Price:  92.8372898664222
curr_Factors:  [92.83728987 -0.82537785 -0.91881935]
mat_Sqrt:  [[16.226589    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01632767 0.05987719 0.15870741]
Stock Position:  0.016327670207918362
Bond Position:  [-3.98382736]


portfolio before change:  [-2.46058165]
curr_Stock_Price:  93.32278863901826
curr_Factors:  [93.32278864 -1.03594118 -0.91714115]
mat_Sqrt:  [[13.23655069  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.01588886e-02  5.45959809e-02  3.07317679e-05]
Stock Position:  -0.010158888648935677
Bond Position:  [-1.51252583]


portfolio before change:  [-2.47152356]
curr_Stock_Price:  94.38125377468366
curr_Factors:  [94.38125377 -1.04700619 -0.92631164]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.47152356]
Stock Price:  93.49660660824465
PL:  [-2.47152356]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-8.39812849e-02 -1.12849485e-02 -2.32978329e-03]
 [-6.34678023e-02  5.87196231e-02  5.65335576e-02]
 [ 1.63742158e-01 -2.49809569e-01 -3.96770477e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.24061949e+00 -3.64568933e-01  2.23360369e-02]
 [-6.25667382e-02  2.39275382e-02  6.44909665e-02]
 [ 1.04744728e-02  1.37687359e-01  4.84746861e-02]
 [ 4.42218167e-01  9.48477227e-02 -1.35912539e-01]
 [-5.46402793e-01 -3.16251292e-02 -6.32380449e-02]
 [ 1.10700404e-02  4.44250687e-02 -1.24850574e-02]
 [-1.73631330e-02 -2.11132956e-01  1.22404544e-01]
 [-8.54830130e-02  7.63202070e-03  5.50308580e-02]
 [ 1.24411655e-01 -3.68657239e-02  2.85314428e-01]
 [ 5.93765532e-02  2.33663612e-01  1.93534878e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-2.78452213e-02  2.23067173e-02  4.08318213e-02]
 [-4.83389446e-01 -2.26942639e-01  1.29354446e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 1.27977066e-01  7.85070656e-01  2.13373659e-01]
 [-9.23569545e-03  3.03082674e-02  2.77418586e-02]
 [-1.03519707e-02 -1.27663387e-01  1.97539332e-02]
 [-2.00922120e-02  5.73608009e-02 -2.58011618e-02]
 [ 9.78302483e-02 -3.16567355e-02  1.17873951e-01]
 [ 8.01211576e-02  5.94600744e-03 -2.39240978e-02]
 [-5.99648728e-02 -1.36101955e-01  1.24096406e-01]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [-2.50940934e-01  4.27406508e-02  2.32351604e-01]
 [ 9.39186692e-03  4.81222855e-02 -6.59634543e-02]
 [-5.93148315e-01  1.16354274e-02 -8.34136457e-01]
 [-2.27186377e-01  9.44964465e-02 -1.49650198e-02]
 [-8.91699354e-02  6.06509583e-02  1.40700608e-01]
 [ 5.92249674e-03 -1.56213785e-03  3.61796811e-02]
 [-1.20098818e-01 -1.09466360e-03 -1.45388904e-01]
 [-7.10660814e-02 -1.35479816e-01 -3.74085830e-02]
 [ 2.38396559e-01 -1.75227521e-01 -6.76394803e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-1.71377892e-02 -2.18230969e-02 -4.47999850e-02]
 [-9.01594413e-02  7.02121247e-03 -1.26948103e-04]
 [ 1.96271725e-04 -2.80885398e-01  1.01710479e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.66939207]
curr_Stock_Price:  100.59655990528485
curr_Factors:  [100.59655991  -1.10797919  -1.03182249]
mat_Sqrt:  [[11.83802004  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00715899 -0.00356861 -0.00664622]
Stock Position:  -0.007158986534732306
Bond Position:  [7.38956148]


portfolio before change:  [6.66764359]
curr_Stock_Price:  100.96982894089712
curr_Factors:  [100.96982894  -1.57356447  -1.03584833]
mat_Sqrt:  [[ 7.4291314   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00678569  0.01856878  0.1612745 ]
Stock Position:  -0.006785692885445179
Bond Position:  [7.35279384]


portfolio before change:  [6.67090229]
curr_Stock_Price:  100.6250533525063
curr_Factors:  [100.62505335  -1.63866141  -0.99336399]
mat_Sqrt:  [[ 7.23822401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01054149 -0.07899672 -1.13187573]
Stock Position:  0.010541490314342029
Bond Position:  [5.61016426]


portfolio before change:  [6.6709922]
curr_Stock_Price:  100.56705368436593
curr_Factors:  [100.56705368  -1.52728405  -0.97208859]
mat_Sqrt:  [[ 8.26022703  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00238529 -0.00659539  0.21422481]
Stock Position:  0.0023852920549189533
Bond Position:  [6.43111041]


portfolio before change:  [6.6718516]
curr_Stock_Price:  100.5903035871971
curr_Factors:  [100.59030359  -1.58210447  -0.97889199]
mat_Sqrt:  [[ 7.76836261  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.16032636 -0.11528682  0.0637185 ]
Stock Position:  -0.1603263597371365
Bond Position:  [22.7991288]


portfolio before change:  [6.62865589]
curr_Stock_Price:  100.87750389647167
curr_Factors:  [100.8775039   -1.76252498  -0.96810443]
mat_Sqrt:  [[ 6.57501945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00741971  0.00756655  0.18397478]
Stock Position:  -0.007419714697950234
Bond Position:  [7.37713819]


portfolio before change:  [6.62453653]
curr_Stock_Price:  101.55698449293241
curr_Factors:  [101.55698449  -1.8122817   -0.97103127]
mat_Sqrt:  [[ 6.27960508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00380986 0.04354057 0.13828479]
Stock Position:  0.0038098572588606727
Bond Position:  [6.23761892]


portfolio before change:  [6.62616691]
curr_Stock_Price:  101.78025409789137
curr_Factors:  [101.7802541   -1.85548598  -0.96761558]
mat_Sqrt:  [[ 6.04792089  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06893676  0.02999348 -0.38772064]
Stock Position:  0.06893676375176852
Bond Position:  [-0.39023442]


portfolio before change:  [6.64583502]
curr_Stock_Price:  102.06626822102638
curr_Factors:  [102.06626822  -1.64742518  -0.97095201]
mat_Sqrt:  [[ 7.44278491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07525782 -0.01000074 -0.18040054]
Stock Position:  -0.07525781929516749
Bond Position:  [14.32711979]


portfolio before change:  [6.64312188]
curr_Stock_Price:  102.1261176356604
curr_Factors:  [102.12611764  -1.4733556   -0.97313087]
mat_Sqrt:  [[ 8.84384755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00109326  0.01404844 -0.03561639]
Stock Position:  0.0010932559630052118
Bond Position:  [6.53147189]


portfolio before change:  [6.64374817]
curr_Stock_Price:  101.95214881691095
curr_Factors:  [101.95214882  -1.29621767  -0.96020237]
mat_Sqrt:  [[10.67691066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.03351008e-04 -6.67661032e-02  3.49186094e-01]
Stock Position:  0.0002033510080918036
Bond Position:  [6.6230161]


portfolio before change:  [6.64465545]
curr_Stock_Price:  102.34236605412507
curr_Factors:  [102.34236605  -1.28098762  -0.92740579]
mat_Sqrt:  [[11.24507561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00658536  0.00241346  0.15698772]
Stock Position:  -0.006585356179182417
Bond Position:  [7.31861639]


portfolio before change:  [6.64763783]
curr_Stock_Price:  102.0284126183109
curr_Factors:  [102.02841262  -1.11676854  -0.93821145]
mat_Sqrt:  [[13.0693703   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01390269 -0.01165797  0.81392265]
Stock Position:  0.013902685865107232
Bond Position:  [5.22916886]


portfolio before change:  [6.63472179]
curr_Stock_Price:  101.05236143701282
curr_Factors:  [101.05236144  -0.92071724  -0.90891303]
mat_Sqrt:  [[16.21616431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00646977 0.07389092 0.55210114]
Stock Position:  0.0064697706124103496
Bond Position:  [5.98093619]


portfolio before change:  [6.64496099]
curr_Stock_Price:  102.51942028414251
curr_Factors:  [102.51942028  -0.78371027  -0.91948157]
mat_Sqrt:  [[18.66892541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00229934 -0.03587186 -0.12433753]
Stock Position:  0.00229933607276867
Bond Position:  [6.40923438]


portfolio before change:  [6.64631287]
curr_Stock_Price:  102.75891328100731
curr_Factors:  [102.75891328  -0.97199207  -0.90370976]
mat_Sqrt:  [[15.74753377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120238  0.007054    0.11648182]
Stock Position:  -0.001202378989944084
Bond Position:  [6.76986802]


portfolio before change:  [6.64643102]
curr_Stock_Price:  103.36449272153367
curr_Factors:  [103.36449272  -0.78880498  -0.89255553]
mat_Sqrt:  [[19.23825975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02405855 -0.07176556  0.36901223]
Stock Position:  -0.02405855415592377
Bond Position:  [9.13323126]


portfolio before change:  [6.64127558]
curr_Stock_Price:  103.62623576213501
curr_Factors:  [103.62623576  -0.83369099  -0.92448203]
mat_Sqrt:  [[17.86096354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00735185  0.00580111 -0.05715682]
Stock Position:  -0.007351847702406262
Bond Position:  [7.40311988]


portfolio before change:  [6.63587774]
curr_Stock_Price:  104.48633152179596
curr_Factors:  [104.48633152  -1.07849391  -0.92492965]
mat_Sqrt:  [[14.09235865  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01361037 0.24826114 0.60869566]
Stock Position:  0.013610370257899657
Bond Position:  [5.21378008]


portfolio before change:  [6.62003035]
curr_Stock_Price:  103.27408293709883
curr_Factors:  [103.27408294  -1.30874433  -0.89680139]
mat_Sqrt:  [[11.37980994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0002452   0.00958432  0.0791398 ]
Stock Position:  -0.0002452023536724857
Bond Position:  [6.6453534]


portfolio before change:  [6.6210452]
curr_Stock_Price:  102.52314744323532
curr_Factors:  [102.52314744  -1.32428003  -0.89414937]
mat_Sqrt:  [[11.15244997  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086223 -0.04037071  0.05635247]
Stock Position:  -0.0008622294187384385
Bond Position:  [6.70944367]


portfolio before change:  [6.62186081]
curr_Stock_Price:  102.54996868553494
curr_Factors:  [102.54996869  -1.53471457  -0.88739925]
mat_Sqrt:  [[ 9.09965372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262403  0.01813908 -0.07360353]
Stock Position:  -0.0026240342012165217
Bond Position:  [6.89095543]


portfolio before change:  [6.62232627]
curr_Stock_Price:  102.70086630224044
curr_Factors:  [102.7008663   -1.55533918  -0.85839843]
mat_Sqrt:  [[ 9.18969678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01317495 -0.01001074  0.33626157]
Stock Position:  0.013174949878574465
Bond Position:  [5.2692475]


portfolio before change:  [6.61677456]
curr_Stock_Price:  102.22948653829513
curr_Factors:  [102.22948654  -1.51153828  -0.86477961]
mat_Sqrt:  [[ 9.49630022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00793901  0.00188029 -0.06824879]
Stock Position:  0.007939007303318575
Bond Position:  [5.80517392]


portfolio before change:  [6.61619783]
curr_Stock_Price:  102.06543274214467
curr_Factors:  [102.06543274  -1.67367666  -0.86005697]
mat_Sqrt:  [[ 8.10013298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00470954 -0.04303922  0.3540125 ]
Stock Position:  -0.004709544574326695
Bond Position:  [7.09687953]


portfolio before change:  [6.6173334]
curr_Stock_Price:  102.01268756145645
curr_Factors:  [102.01268756  -1.7894875   -0.84811302]
mat_Sqrt:  [[ 7.29724351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177548  0.02004328 -0.05140267]
Stock Position:  0.001775476299161041
Bond Position:  [6.43621229]


portfolio before change:  [6.61917746]
curr_Stock_Price:  102.59815176632206
curr_Factors:  [102.59815177  -2.09676743  -0.87517102]
mat_Sqrt:  [[ 5.25343142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03852888  0.01351578  0.66283445]
Stock Position:  -0.03852887505434563
Bond Position:  [10.57216883]


portfolio before change:  [6.63226653]
curr_Stock_Price:  102.29273220059382
curr_Factors:  [102.2927322   -2.10020402  -0.869432  ]
mat_Sqrt:  [[ 5.24986625  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00053913  0.0152176  -0.18817537]
Stock Position:  -0.0005391289212184314
Bond Position:  [6.6874155]


portfolio before change:  [6.63332534]
curr_Stock_Price:  101.87941845815261
curr_Factors:  [101.87941846  -2.01525054  -0.8925284 ]
mat_Sqrt:  [[ 5.56229621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.13719429  0.00367945 -2.37955913]
Stock Position:  -0.13719429041577977
Bond Position:  [20.61059986]


portfolio before change:  [6.64032708]
curr_Stock_Price:  101.84716308020354
curr_Factors:  [101.84716308  -1.96643584  -0.90110283]
mat_Sqrt:  [[ 5.78885556  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03935168  0.0298824  -0.04269104]
Stock Position:  -0.03935168341660768
Bond Position:  [10.6481844]


portfolio before change:  [6.64433521]
curr_Stock_Price:  101.77913478829815
curr_Factors:  [101.77913479  -1.92187628  -0.93383647]
mat_Sqrt:  [[ 5.85380793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01005902  0.01917952  0.40137967]
Stock Position:  -0.010059015207581755
Bond Position:  [7.66813308]


portfolio before change:  [6.64327419]
curr_Stock_Price:  101.97991027087578
curr_Factors:  [101.97991027  -2.04768012  -0.92658199]
mat_Sqrt:  [[ 5.20965551  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00254668 -0.00049399  0.10321056]
Stock Position:  0.0025466768303114696
Bond Position:  [6.38356431]


portfolio before change:  [6.64443108]
curr_Stock_Price:  102.12083718078419
curr_Factors:  [102.12083718  -1.88995513  -0.92374821]
mat_Sqrt:  [[ 6.12545749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.44560456e-02 -3.46163024e-04 -4.14754075e-01]
Stock Position:  -0.02445604560497878
Bond Position:  [9.14190293]


portfolio before change:  [6.64635493]
curr_Stock_Price:  102.08890066021499
curr_Factors:  [102.08890066  -1.94035132  -0.9095005 ]
mat_Sqrt:  [[ 5.90613821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01391775 -0.04284248 -0.10671627]
Stock Position:  -0.013917749187644945
Bond Position:  [8.06720264]


portfolio before change:  [6.65299508]
curr_Stock_Price:  101.68425992885004
curr_Factors:  [101.68425993  -1.66540837  -0.8982751 ]
mat_Sqrt:  [[ 7.83177402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02809904 -0.05541181 -0.19295661]
Stock Position:  0.02809904269192449
Bond Position:  [3.79576472]


portfolio before change:  [6.66008947]
curr_Stock_Price:  101.91985125498503
curr_Factors:  [101.91985125  -1.45613471  -0.88705277]
mat_Sqrt:  [[ 9.78645471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00250467 0.00777784 0.21633947]
Stock Position:  0.0025046745096745427
Bond Position:  [6.40481342]


portfolio before change:  [6.65806394]
curr_Stock_Price:  100.791489278161
curr_Factors:  [100.79148928  -1.16839681  -0.88407044]
mat_Sqrt:  [[12.94340861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207411 -0.00690107 -0.12780189]
Stock Position:  -0.002074107261612705
Bond Position:  [6.8671163]


portfolio before change:  [6.65967641]
curr_Stock_Price:  100.42794746747145
curr_Factors:  [100.42794747  -1.003984    -0.85771017]
mat_Sqrt:  [[15.60741868  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00576675  0.0022203  -0.00036215]
Stock Position:  -0.005766749096262247
Bond Position:  [7.23881919]


portfolio before change:  [6.66630109]
curr_Stock_Price:  99.4360938912501
curr_Factors:  [99.43609389 -1.06754249 -0.85055812]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.66630109]
Stock Price:  100.20514686095625
PL:  [6.46115423]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-8.53929751e-02  5.60346341e-02  5.46057802e-02]
 [-4.69190984e-02  3.55186466e-02  1.38581793e-02]
 [ 3.35504952e-01  6.35089490e-02  1.65222903e-03]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-8.29637962e-01 -2.30812791e-01 -6.31973297e-02]
 [-6.14111424e-03  7.52264667e-02  9.57504760e-02]
 [ 1.16836309e-03  1.61950914e-01  9.38097689e-02]
 [ 2.66809974e-01 -1.34559201e-01 -4.68904729e-02]
 [-5.36304260e-01 -2.76938040e-02 -7.52983328e-02]
 [ 2.85716257e-02  1.46917570e-02 -2.64179101e-02]
 [-3.41830204e-03 -2.42821122e-01  1.30289058e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.56800733e-01 -9.64743643e-02  2.32578392e-01]
 [ 7.36930634e-02  1.45331140e-01  1.06153864e-01]
 [ 3.09218013e-02 -9.10810861e-02 -4.39642252e-02]
 [-3.37763044e-02 -2.85430340e-02  1.46315667e-02]
 [-3.39204435e-01 -2.17796482e-01  7.37448376e-02]
 [-2.05862661e-01 -7.07387493e-02 -3.28431233e-02]
 [ 2.51413990e-01  1.16795838e+00  3.09757366e-01]
 [-1.69273894e-01 -2.79357780e-02  1.31414733e-01]
 [-9.81394695e-02  3.60318251e-01 -2.71036908e-02]
 [-2.42488798e-02  4.01991746e-02 -1.26726957e-02]
 [ 4.98652745e-02 -3.60605160e-02  6.66234266e-02]
 [ 7.62501878e-02  1.58098139e-01  3.53326479e-02]
 [-5.77817600e-02 -1.86552251e-01  5.10123587e-02]
 [ 4.77033078e-02  4.40910607e-02 -1.25937038e-02]
 [ 2.65524474e-02 -6.82941348e-02  5.26464792e-02]
 [ 2.00061869e-03  4.25631726e-02 -6.54756681e-02]
 [-6.14340917e-01  3.20093378e-03 -8.72229061e-01]
 [-1.74271687e-01 -1.61961474e-04  7.00168659e-03]
 [-4.74980764e-02  6.46079212e-02  1.69989476e-01]
 [ 1.16810862e-02  4.09061517e-02  1.56770298e-02]
 [-1.21431204e-01 -4.53128879e-03 -1.46950447e-01]
 [-6.68247247e-02 -3.39261845e-02  2.69975376e-02]
 [ 2.38890349e-01 -1.76089420e-01 -6.91596348e-02]
 [ 5.00196513e-04  8.12520886e-02  7.77357186e-02]
 [ 1.50323917e-02  1.45591427e-02 -4.41799485e-02]
 [-6.08760924e-02  9.77926900e-02 -6.25717607e-03]
 [-5.64540921e-02 -2.38989036e-01  1.03694737e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.83801142]
curr_Stock_Price:  100.89871356550961
curr_Factors:  [100.89871357  -0.91136154  -1.02158015]
mat_Sqrt:  [[14.60224795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00498552  0.01771971  0.15577509]
Stock Position:  -0.004985520659528247
Bond Position:  [9.34104404]


portfolio before change:  [8.83914302]
curr_Stock_Price:  100.90595405458569
curr_Factors:  [100.90595405  -0.79395068  -1.02383467]
mat_Sqrt:  [[16.38561133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263483  0.01123198  0.03953353]
Stock Position:  -0.00263482521433689
Bond Position:  [9.10501258]


portfolio before change:  [8.83960696]
curr_Stock_Price:  101.16185641243163
curr_Factors:  [101.16185641  -0.68002709  -1.04124584]
mat_Sqrt:  [[18.09161992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01865405 0.02008329 0.00471335]
Stock Position:  0.018654051266924283
Bond Position:  [6.95252851]


portfolio before change:  [8.8451115]
curr_Stock_Price:  101.41035000155667
curr_Factors:  [101.41035     -0.42087638  -1.05442389]
mat_Sqrt:  [[23.19356555  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084951 -0.00659539  0.21422481]
Stock Position:  0.0008495051723829284
Bond Position:  [8.75896288]


portfolio before change:  [8.84710575]
curr_Stock_Price:  102.46898438649858
curr_Factors:  [102.46898439  -0.69298254  -1.06635908]
mat_Sqrt:  [[17.64087293  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04809839 -0.07298941 -0.18028439]
Stock Position:  -0.04809839211460034
Bond Position:  [13.77569914]


portfolio before change:  [8.81506972]
curr_Stock_Price:  103.17083943363482
curr_Factors:  [103.17083943  -0.70574422  -1.05574669]
mat_Sqrt:  [[17.72356908  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00086586 0.0237887  0.27314946]
Stock Position:  0.0008658644758218901
Bond Position:  [8.72573776]


portfolio before change:  [8.81577771]
curr_Stock_Price:  102.72874267971325
curr_Factors:  [102.72874268  -0.72210421  -1.02512721]
mat_Sqrt:  [[17.90107067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00136856 0.05121338 0.26761316]
Stock Position:  0.0013685637602299282
Bond Position:  [8.67518688]


portfolio before change:  [8.8163791]
curr_Stock_Price:  102.37576397318198
curr_Factors:  [102.37576397  -0.71099104  -1.04674154]
mat_Sqrt:  [[17.65320614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01437496 -0.04255136 -0.13376547]
Stock Position:  0.014374963452815288
Bond Position:  [7.34473124]


portfolio before change:  [8.81691185]
curr_Stock_Price:  102.34895311462999
curr_Factors:  [102.34895311  -0.85506632  -1.03528985]
mat_Sqrt:  [[15.45653529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03573825 -0.00875755 -0.21480518]
Stock Position:  -0.035738249756768176
Bond Position:  [12.4746843]


portfolio before change:  [8.83847268]
curr_Stock_Price:  101.78928956237381
curr_Factors:  [101.78928956  -0.94233166  -1.04628507]
mat_Sqrt:  [[13.93339063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169079  0.00464594 -0.07536294]
Stock Position:  0.001690789595112718
Bond Position:  [8.6663684]


portfolio before change:  [8.83978317]
curr_Stock_Price:  101.92362423310715
curr_Factors:  [101.92362423  -0.99742599  -1.0374705 ]
mat_Sqrt:  [[13.32080722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00126923 -0.07678678  0.37167842]
Stock Position:  0.0012692343566369174
Bond Position:  [8.71041821]


portfolio before change:  [8.84001601]
curr_Stock_Price:  101.24917674607444
curr_Factors:  [101.24917675  -0.89279693  -1.02945614]
mat_Sqrt:  [[14.81042774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00486992  0.00225658  0.15019092]
Stock Position:  -0.004869921373380568
Bond Position:  [9.33309154]


portfolio before change:  [8.84691659]
curr_Stock_Price:  100.07177122388177
curr_Factors:  [100.07177122  -0.61596446  -1.01355053]
mat_Sqrt:  [[19.61653135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01028646 -0.03050787  0.66348142]
Stock Position:  0.010286458771471536
Bond Position:  [7.81753244]


portfolio before change:  [8.86093129]
curr_Stock_Price:  101.33920866217863
curr_Factors:  [101.33920866  -0.59334575  -1.02563461]
mat_Sqrt:  [[20.07535664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0049371  0.04595774 0.30282743]
Stock Position:  0.00493710103138306
Bond Position:  [8.36060938]


portfolio before change:  [8.85417784]
curr_Stock_Price:  99.75962031760837
curr_Factors:  [99.75962032 -0.6773849  -1.04885536]
mat_Sqrt:  [[17.75244456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00110384 -0.02880237 -0.1254177 ]
Stock Position:  0.0011038444796012332
Bond Position:  [8.74405874]


portfolio before change:  [8.85574641]
curr_Stock_Price:  100.19037926203286
curr_Factors:  [100.19037926  -0.49720972  -1.02935989]
mat_Sqrt:  [[21.76933993  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144821 -0.0090261   0.04173979]
Stock Position:  -0.0014482123211515402
Bond Position:  [9.00084335]


portfolio before change:  [8.85822801]
curr_Stock_Price:  99.25376098065158
curr_Factors:  [99.25376098 -0.30480293 -1.06293666]
mat_Sqrt:  [[25.27814589  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01304585 -0.06887329  0.2103735 ]
Stock Position:  -0.013045846616996157
Bond Position:  [10.15307735]


portfolio before change:  [8.86228512]
curr_Stock_Price:  99.0400611191808
curr_Factors:  [99.04006112 -0.3489572  -1.06270856]
mat_Sqrt:  [[24.13972111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00888135 -0.02236956 -0.09369229]
Stock Position:  -0.008881345449034612
Bond Position:  [9.74189411]


portfolio before change:  [8.85380377]
curr_Stock_Price:  100.13214377120836
curr_Factors:  [100.13214377  -0.52590913  -1.03663649]
mat_Sqrt:  [[20.98788003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01642851 0.36934087 0.88365155]
Stock Position:  0.016428505528285512
Bond Position:  [7.20878229]


portfolio before change:  [8.84406597]
curr_Stock_Price:  99.48455320837748
curr_Factors:  [99.48455321 -0.46465472 -1.03264201]
mat_Sqrt:  [[22.25809262  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00643228 -0.00883407  0.37488965]
Stock Position:  -0.0064322794946152
Bond Position:  [9.48397843]


portfolio before change:  [8.84539954]
curr_Stock_Price:  99.46154509626763
curr_Factors:  [99.4615451  -0.48870067 -1.00791783]
mat_Sqrt:  [[22.26804273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423785  0.11394264 -0.07731929]
Stock Position:  -0.004237849329652032
Bond Position:  [9.26690258]


portfolio before change:  [8.84618846]
curr_Stock_Price:  99.54874028525467
curr_Factors:  [99.54874029 -0.54184453 -1.0076244 ]
mat_Sqrt:  [[21.14024242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00122031  0.0127121  -0.03615167]
Stock Position:  -0.001220314517865518
Bond Position:  [8.96766923]


portfolio before change:  [8.84620775]
curr_Stock_Price:  100.45156689781328
curr_Factors:  [100.4515669   -0.7547716   -1.01075975]
mat_Sqrt:  [[17.18684629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00363846 -0.01140334  0.19005809]
Stock Position:  0.003638459610131151
Bond Position:  [8.48071878]


portfolio before change:  [8.8491466]
curr_Stock_Price:  100.96790985217105
curr_Factors:  [100.96790985  -0.88733139  -1.01881865]
mat_Sqrt:  [[15.00904022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00583279 0.04999502 0.10079421]
Stock Position:  0.0058327854049382314
Bond Position:  [8.26022245]


portfolio before change:  [8.85106831]
curr_Stock_Price:  101.12034487648702
curr_Factors:  [101.12034488  -0.72472313  -1.01861807]
mat_Sqrt:  [[17.68948058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029501  -0.058993    0.14552406]
Stock Position:  -0.0029500959098461917
Bond Position:  [9.14938303]


portfolio before change:  [8.85375689]
curr_Stock_Price:  100.59669063050512
curr_Factors:  [100.59669063  -0.79926966  -0.99918   ]
mat_Sqrt:  [[16.65432098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00277832  0.01394282 -0.03592633]
Stock Position:  0.002778321321527066
Bond Position:  [8.57426696]


portfolio before change:  [8.85569028]
curr_Stock_Price:  100.90678396758916
curr_Factors:  [100.90678397  -0.68117906  -0.97818081]
mat_Sqrt:  [[19.1985987   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185094 -0.0215965   0.15018575]
Stock Position:  0.0018509433154953415
Bond Position:  [8.66891754]


portfolio before change:  [8.85630715]
curr_Stock_Price:  100.65458416126157
curr_Factors:  [100.65458416  -0.95987722  -0.96205049]
mat_Sqrt:  [[14.72824368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.000697    0.01345966 -0.18678386]
Stock Position:  -0.0006969989044852719
Bond Position:  [8.92646329]


portfolio before change:  [8.85774995]
curr_Stock_Price:  100.18554719808442
curr_Factors:  [100.1855472   -1.04428813  -0.98837437]
mat_Sqrt:  [[13.12293463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.03753126e-02  1.01222414e-03 -2.48822673e+00]
Stock Position:  -0.060375312623678457
Bond Position:  [14.90648368]


portfolio before change:  [8.81349768]
curr_Stock_Price:  100.94936427617962
curr_Factors:  [100.94936428  -1.34988672  -0.97194015]
mat_Sqrt:  [[ 9.9025488   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.74547643e-02 -5.12167152e-05  1.99738630e-02]
Stock Position:  -0.017454764338165427
Bond Position:  [10.57554504]


portfolio before change:  [8.8032088]
curr_Stock_Price:  101.61456431327154
curr_Factors:  [101.61456431  -1.14120177  -0.96982666]
mat_Sqrt:  [[12.30687981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090445  0.02043082  0.48493266]
Stock Position:  -0.00090444944647052
Bond Position:  [8.89511403]


portfolio before change:  [8.80487448]
curr_Stock_Price:  101.00233694653318
curr_Factors:  [101.00233695  -1.28052954  -0.97346447]
mat_Sqrt:  [[10.60313424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00150308 0.01293566 0.0447222 ]
Stock Position:  0.0015030780905004985
Bond Position:  [8.65306008]


portfolio before change:  [8.80764676]
curr_Stock_Price:  102.12707736946149
curr_Factors:  [102.12707737  -1.3446309   -0.9358419 ]
mat_Sqrt:  [[10.44104939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01451428 -0.00143292 -0.41920872]
Stock Position:  -0.014514282053075462
Bond Position:  [10.28994796]


portfolio before change:  [8.80385575]
curr_Stock_Price:  102.47689346884474
curr_Factors:  [102.47689347  -1.33571073  -0.944703  ]
mat_Sqrt:  [[10.477432    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0059356  -0.0107284   0.07701646]
Stock Position:  -0.005935600035589949
Bond Position:  [9.4121176]


portfolio before change:  [8.80703092]
curr_Stock_Price:  102.14018222268187
curr_Factors:  [102.14018222  -1.28819357  -0.96154125]
mat_Sqrt:  [[10.76835123  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02045128 -0.05568436 -0.19729319]
Stock Position:  0.020451282096844527
Bond Position:  [6.71813324]


portfolio before change:  [8.82113845]
curr_Stock_Price:  102.78892928809445
curr_Factors:  [102.78892929  -0.89079445  -0.97262107]
mat_Sqrt:  [[15.94686312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00115796 0.02569417 0.22175837]
Stock Position:  0.0011579614991601372
Bond Position:  [8.70211283]


portfolio before change:  [8.82143963]
curr_Stock_Price:  102.10958441083734
curr_Factors:  [102.10958441  -0.56493462  -0.95693013]
mat_Sqrt:  [[22.29097402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028667  0.00460401 -0.1260331 ]
Stock Position:  0.0002866681799340634
Bond Position:  [8.79216806]


portfolio before change:  [8.82259644]
curr_Stock_Price:  102.3109404917862
curr_Factors:  [102.31094049  -0.70812599  -0.94031854]
mat_Sqrt:  [[19.67939376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302999  0.03092476 -0.01784998]
Stock Position:  -0.003029988495140492
Bond Position:  [9.13259741]


portfolio before change:  [8.82394185]
curr_Stock_Price:  102.24369295381547
curr_Factors:  [102.24369295  -0.73492285  -0.93275452]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.82394185]
Stock Price:  101.4399818537876
PL:  [7.38395999]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.09592717e-01 -8.56677060e-03  2.63577671e-02]
 [-1.05494040e-01 -5.39903063e-03  1.41446042e-01]
 [ 1.62878582e-01  2.25148268e-01  3.57773963e-01]
 [-3.35054884e-02  8.72663060e-03  9.14982300e-02]
 [-1.02231481e+00 -3.02731579e-01  2.76708424e-02]
 [-3.59029540e-02 -3.55011948e-02 -2.20999629e-02]
 [ 3.33839452e-02  3.16669188e-02 -1.86835757e-02]
 [ 2.80961547e-01 -2.24629451e-02 -6.34375683e-02]
 [-3.62520050e-01 -9.13275768e-03 -7.61352164e-02]
 [ 5.41497249e-02 -2.87626835e-02 -4.67804019e-02]
 [ 3.31521305e-02 -3.29968377e-01  1.47245182e-01]
 [-1.15481502e-01  1.37653780e-02  8.44879256e-02]
 [ 8.09339648e-02 -1.39890143e-02  2.52704422e-01]
 [ 6.95697570e-03  5.52918258e-01  5.08997372e-01]
 [ 7.52180282e-02 -1.17915551e-01 -4.86886644e-02]
 [-1.53123690e-02 -8.88788965e-03  3.59872246e-02]
 [-4.59420470e-01 -1.98084201e-01  1.20707376e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 4.60253330e-02  6.01726617e-01  6.53157410e-02]
 [ 1.27975167e-03  1.97913481e-02  2.93082857e-02]
 [-7.44793666e-03 -2.24479815e-01  4.97093945e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.54192827e-01 -2.94142360e-02  1.60963177e-01]
 [ 7.92651014e-02  1.38131715e-01  2.26688961e-02]
 [-6.58446728e-02 -1.79544337e-01  3.08224908e-03]
 [ 2.00029486e-02  6.19010962e-02 -1.50986006e-02]
 [ 4.96958587e-02 -5.80264038e-02  2.35793826e-01]
 [ 4.42071758e-02  5.75106020e-02 -7.06932953e-02]
 [-7.83768027e-01 -2.08803931e-01 -1.25315283e+00]
 [-2.20300440e-02 -5.59751444e-02  7.84883331e-02]
 [-4.53253068e-03 -1.01486735e-01  1.15974632e-01]
 [ 5.72038267e-02  2.03136481e-01 -4.07883968e-02]
 [-1.07007083e-01 -3.72056690e-03 -1.35131465e-02]
 [-5.79341691e-02  1.38485165e-01  1.12225490e-01]
 [ 6.51911207e-02 -1.37294730e-01 -1.25343730e-01]
 [-6.77438401e-02  4.19239653e-01  8.88972682e-02]
 [ 2.99888712e-01  2.05634400e-01  2.65712264e-02]
 [ 7.06683180e-02  1.23010011e-02 -1.48860814e-02]
 [-2.36600908e-01 -5.11246596e-01  1.17026547e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.54472077]
curr_Stock_Price:  100.02186959513712
curr_Factors:  [100.0218696   -1.14994743  -0.96638147]
mat_Sqrt:  [[12.04994332  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00866673 -0.00270905  0.07519137]
Stock Position:  -0.00866673395890817
Bond Position:  [3.41158371]


portfolio before change:  [2.55686509]
curr_Stock_Price:  98.6698215715739
curr_Factors:  [98.66982157 -1.21436343 -0.96905475]
mat_Sqrt:  [[11.11572704  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00690561 -0.00170732  0.40350619]
Stock Position:  -0.006905611265240048
Bond Position:  [3.23824052]


portfolio before change:  [2.55470628]
curr_Stock_Price:  99.0410586989574
curr_Factors:  [99.0410587  -1.38822171 -0.95612501]
mat_Sqrt:  [[ 9.49901193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02544709 0.07119813 1.02062953]
Stock Position:  0.025447087643221507
Bond Position:  [0.03439977]


portfolio before change:  [2.57135848]
curr_Stock_Price:  99.69527518132614
curr_Factors:  [99.69527518 -1.39253108 -0.93535225]
mat_Sqrt:  [[ 9.72047954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150231  0.0027596   0.26101898]
Stock Position:  -0.0015023096064605073
Bond Position:  [2.72113165]


portfolio before change:  [2.57117152]
curr_Stock_Price:  100.04614800145609
curr_Factors:  [100.046148    -1.39300406  -0.92176959]
mat_Sqrt:  [[ 9.88341316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.1036568  -0.09573213  0.07893721]
Stock Position:  -0.10365680424984398
Bond Position:  [12.9416355]


portfolio before change:  [2.54336966]
curr_Stock_Price:  100.32996600375343
curr_Factors:  [100.329966    -1.29432842  -0.92788756]
mat_Sqrt:  [[10.87262795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380136 -0.01122646 -0.06304504]
Stock Position:  -0.0038013557607104527
Bond Position:  [2.92475956]


portfolio before change:  [2.54443283]
curr_Stock_Price:  100.14646552859756
curr_Factors:  [100.14646553  -1.16184311  -0.94145252]
mat_Sqrt:  [[12.22322879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00248607  0.01001396 -0.05329904]
Stock Position:  0.002486070834212815
Bond Position:  [2.29546162]


portfolio before change:  [2.5448027]
curr_Stock_Price:  100.17982015783633
curr_Factors:  [100.17982016  -0.92422905  -0.96532561]
mat_Sqrt:  [[15.14108812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01766269 -0.00710341 -0.18096972]
Stock Position:  0.017662694695615377
Bond Position:  [0.77535712]


portfolio before change:  [2.53451636]
curr_Stock_Price:  99.59195604756515
curr_Factors:  [99.59195605 -0.95340132 -0.95544867]
mat_Sqrt:  [[14.76458506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02562191 -0.00288803 -0.21719258]
Stock Position:  -0.025621911536700823
Bond Position:  [5.08625265]


portfolio before change:  [2.51861243]
curr_Stock_Price:  100.23748756940381
curr_Factors:  [100.23748757  -0.77508715  -0.9794854 ]
mat_Sqrt:  [[17.33919755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00252942 -0.00909556 -0.13345147]
Stock Position:  0.0025294172862595178
Bond Position:  [2.26507]


portfolio before change:  [2.52171924]
curr_Stock_Price:  101.3538150667017
curr_Factors:  [101.35381507  -0.453745    -1.03051686]
mat_Sqrt:  [[22.97382794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00238048 -0.10434516  0.42004952]
Stock Position:  0.0023804775013796277
Bond Position:  [2.28044877]


portfolio before change:  [2.52520695]
curr_Stock_Price:  102.69918965875897
curr_Factors:  [102.69918966  -0.37239552  -1.04691407]
mat_Sqrt:  [[24.8409781   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00394027  0.00435299  0.24102053]
Stock Position:  -0.003940265796748633
Bond Position:  [2.92986905]


portfolio before change:  [2.52752725]
curr_Stock_Price:  102.20327210416941
curr_Factors:  [102.2032721   -0.44304918  -1.06567833]
mat_Sqrt:  [[22.60647073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00584593 -0.00442371  0.72089538]
Stock Position:  0.005845929941465145
Bond Position:  [1.93005409]


portfolio before change:  [2.54500808]
curr_Stock_Price:  105.15225568901351
curr_Factors:  [105.15225569  -0.45969604  -1.06228851]
mat_Sqrt:  [[22.95245286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00545179 0.17484811 1.45202782]
Stock Position:  0.005451788437992904
Bond Position:  [1.97174023]


portfolio before change:  [2.54133094]
curr_Stock_Price:  104.43256084911071
curr_Factors:  [104.43256085  -0.51511044  -1.03682414]
mat_Sqrt:  [[22.12275974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00281316 -0.03728817 -0.13889521]
Stock Position:  0.0028131630261098097
Bond Position:  [2.24754512]


portfolio before change:  [2.5428864]
curr_Stock_Price:  104.88561065645855
curr_Factors:  [104.88561066  -0.5427602   -1.04045885]
mat_Sqrt:  [[21.53439196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003806  -0.0028106   0.10266153]
Stock Position:  -0.0003806001081867177
Bond Position:  [2.58280587]


portfolio before change:  [2.54345645]
curr_Stock_Price:  104.23615972443616
curr_Factors:  [104.23615972  -0.48932865  -1.04499764]
mat_Sqrt:  [[22.47340929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01957405 -0.06263972  0.34434454]
Stock Position:  -0.019574052447082026
Bond Position:  [4.58378051]


portfolio before change:  [2.554032]
curr_Stock_Price:  103.72514934280512
curr_Factors:  [103.72514934  -0.52773489  -1.04588328]
mat_Sqrt:  [[21.50158035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00610704  0.00580111 -0.05715682]
Stock Position:  -0.006107043373571211
Bond Position:  [3.18748599]


portfolio before change:  [2.54215629]
curr_Stock_Price:  105.73498893890387
curr_Factors:  [105.73498894  -0.75646994  -1.01939938]
mat_Sqrt:  [[17.90475904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00418293 0.19028266 0.18632763]
Stock Position:  0.004182930754496376
Bond Position:  [2.09987415]


portfolio before change:  [2.53342473]
curr_Stock_Price:  103.58480768323476
curr_Factors:  [103.58480768  -0.42407667  -0.9957661 ]
mat_Sqrt:  [[25.04183699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00031041 0.00625857 0.08360838]
Stock Position:  0.00031041216592083445
Bond Position:  [2.50127074]


portfolio before change:  [2.53373444]
curr_Stock_Price:  103.57524440759342
curr_Factors:  [103.57524441  -0.45001319  -0.99287226]
mat_Sqrt:  [[24.46914404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.26571363e-04 -7.09867505e-02  1.41807066e-01]
Stock Position:  -0.00012657136295126097
Bond Position:  [2.5468441]


portfolio before change:  [2.53396569]
curr_Stock_Price:  104.26354812426527
curr_Factors:  [104.26354812  -0.42519136  -0.99381135]
mat_Sqrt:  [[25.22710721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154076  0.01916992 -0.08961985]
Stock Position:  -0.0015407578588724105
Bond Position:  [2.69461058]


portfolio before change:  [2.5363012]
curr_Stock_Price:  102.96635464108083
curr_Factors:  [102.96635464  -0.52124062  -0.96203914]
mat_Sqrt:  [[23.36227444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00797396 -0.0093016   0.45918314]
Stock Position:  0.00797395929948687
Bond Position:  [1.71525168]


portfolio before change:  [2.52446312]
curr_Stock_Price:  101.45487173966188
curr_Factors:  [101.45487174  -0.41012108  -0.94580043]
mat_Sqrt:  [[26.14590498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00334503 0.04368108 0.06466805]
Stock Position:  0.003345033038164813
Bond Position:  [2.18509322]


portfolio before change:  [2.51960926]
curr_Stock_Price:  99.9221468877387
curr_Factors:  [99.92214689 -0.46221095 -0.92282373]
mat_Sqrt:  [[25.01202418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279271 -0.0567769   0.0087928 ]
Stock Position:  -0.0027927098469744615
Bond Position:  [2.79866282]


portfolio before change:  [2.51571051]
curr_Stock_Price:  101.44346608537003
curr_Factors:  [101.44346609  -0.51655068  -0.94120958]
mat_Sqrt:  [[23.61167752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078433  0.01957485 -0.0430721 ]
Stock Position:  0.0007843254295095345
Bond Position:  [2.43614582]


portfolio before change:  [2.51768144]
curr_Stock_Price:  103.56808636649936
curr_Factors:  [103.56808637  -0.2475805   -0.93935843]
mat_Sqrt:  [[31.60420914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00304797 -0.01834956  0.67265415]
Stock Position:  0.003047974908936315
Bond Position:  [2.20200851]


portfolio before change:  [2.51764239]
curr_Stock_Price:  103.46496277892146
curr_Factors:  [103.46496278  -0.28485521  -0.95195636]
mat_Sqrt:  [[30.03674493  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104079  0.01818645 -0.20166829]
Stock Position:  0.0010407880324664021
Bond Position:  [2.4099573]


portfolio before change:  [2.51758289]
curr_Stock_Price:  103.11833242507015
curr_Factors:  [103.11833243  -0.29811793  -0.92798919]
mat_Sqrt:  [[30.25828615  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03453461 -0.0660296  -3.57489621]
Stock Position:  -0.0345346086663688
Bond Position:  [6.07873414]


portfolio before change:  [2.4455107]
curr_Stock_Price:  105.22729141020771
curr_Factors:  [105.22729141  -0.57415092  -0.91897622]
mat_Sqrt:  [[23.64130859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031529 -0.01770089  0.22390537]
Stock Position:  -0.00031529354789274963
Bond Position:  [2.47868819]


portfolio before change:  [2.44582137]
curr_Stock_Price:  105.22470716948523
curr_Factors:  [105.22470717  -0.45577297  -0.93588459]
mat_Sqrt:  [[26.16546911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063138 -0.03209292  0.33084334]
Stock Position:  0.0006313785421170919
Bond Position:  [2.37938475]


portfolio before change:  [2.4473874]
curr_Stock_Price:  107.23393719876212
curr_Factors:  [107.2339372   -0.65892418  -0.95079158]
mat_Sqrt:  [[21.44082921  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00252429  0.0642374  -0.11635794]
Stock Position:  0.0025242909668472054
Bond Position:  [2.17669774]


portfolio before change:  [2.44703749]
curr_Stock_Price:  106.98752557013874
curr_Factors:  [106.98752557  -0.97973065  -0.97735042]
mat_Sqrt:  [[15.11414664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00726879 -0.00117655 -0.03854925]
Stock Position:  -0.007268786641172852
Bond Position:  [3.22470698]


portfolio before change:  [2.45417851]
curr_Stock_Price:  106.06056141720177
curr_Factors:  [106.06056142  -0.65979961  -0.98175178]
mat_Sqrt:  [[20.54173919  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153106  0.04379285  0.32014808]
Stock Position:  -0.0015310566013253763
Bond Position:  [2.61656323]


portfolio before change:  [2.45064123]
curr_Stock_Price:  108.58455120465649
curr_Factors:  [108.5845512   -0.47101372  -0.98572528]
mat_Sqrt:  [[25.29963942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00142534 -0.04341641 -0.35757077]
Stock Position:  0.001425336692004374
Bond Position:  [2.29587168]


portfolio before change:  [2.45462589]
curr_Stock_Price:  111.17879150601586
curr_Factors:  [111.17879151  -0.48031678  -0.99947325]
mat_Sqrt:  [[25.31379771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0015317   0.13257522  0.25359916]
Stock Position:  -0.0015316958882634244
Bond Position:  [2.62491799]


portfolio before change:  [2.4524708]
curr_Stock_Price:  112.80002141142856
curr_Factors:  [112.80002141  -0.66318776  -0.99940674]
mat_Sqrt:  [[21.39210721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0145204  0.06502731 0.07580031]
Stock Position:  0.01452040210205892
Bond Position:  [0.81456913]


portfolio before change:  [2.4539284]
curr_Stock_Price:  112.89339181439433
curr_Factors:  [112.89339181  -0.66987943  -0.98849743]
mat_Sqrt:  [[21.50030408  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0031603   0.00388992 -0.04246585]
Stock Position:  0.003160295759927141
Bond Position:  [2.09715189]


portfolio before change:  [2.45680362]
curr_Stock_Price:  113.7202315353254
curr_Factors:  [113.72023154  -0.78516999  -0.99337776]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.45680362]
Stock Price:  115.92484910158545
PL:  [-13.46804548]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.61234590e-02  8.35290078e-03  2.71167469e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.43119784e-01  2.93551449e-01  4.21295523e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-8.29892838e-01 -2.45471214e-01  1.71907746e-02]
 [-5.25015218e-02 -3.66259600e-03  2.61836687e-02]
 [ 3.06574076e-02  7.14927116e-02  1.95501774e-03]
 [ 2.71722856e-01 -1.15557094e-01 -5.06423372e-02]
 [-5.16113912e-01 -2.77019025e-02 -6.62816867e-02]
 [ 4.56027592e-02 -1.42423077e-02 -3.99762404e-02]
 [ 1.23596986e-02 -2.88688125e-01  1.60513671e-01]
 [-5.14431761e-02  3.04427956e-03  3.54554483e-02]
 [ 1.51272287e-01 -6.48581105e-02  2.97440471e-01]
 [ 6.72717327e-02  1.70866800e-01  1.30221815e-01]
 [ 5.84792381e-02 -1.13367233e-01 -4.52671544e-02]
 [-5.06882365e-02  7.91635974e-02  4.96618300e-02]
 [-4.51561186e-01 -2.29578535e-01  1.17576768e-01]
 [-1.67911655e-01 -7.10525484e-02 -1.83881006e-02]
 [ 2.20812980e-01  1.04049829e+00  2.63945591e-01]
 [-1.67119463e-01 -2.87193305e-02  1.28504939e-01]
 [-9.68444179e-02  3.18309804e-01 -2.90734591e-02]
 [-8.22867239e-03  2.11583086e-02  4.94440317e-03]
 [ 2.15159982e-02 -3.23829101e-02  1.51256498e-02]
 [ 4.93948286e-02  2.29134688e-01  1.11523350e-01]
 [-9.68491914e-02 -4.89867611e-03  4.17280470e-02]
 [ 1.20437156e-01 -2.38610537e-02 -2.44902609e-03]
 [ 2.98765900e-02 -6.74866939e-02  7.49214406e-02]
 [-2.02255784e-02  4.26193534e-02  2.64352066e-02]
 [-6.29735769e-01  2.41417708e-02 -8.73250046e-01]
 [ 3.58775988e-02 -1.08808410e-01 -7.23709317e-02]
 [ 4.66150993e-02  4.27632576e-02  6.00210902e-02]
 [ 2.42648957e-02  1.26056096e-01 -2.51888988e-02]
 [-1.09387928e-01 -3.11095270e-03 -1.60151108e-01]
 [-6.01616543e-02  1.25612155e-01  1.28178021e-01]
 [ 8.37531861e-02 -7.14290955e-02  3.47147454e-03]
 [-5.23226082e-03 -9.23415686e-04  6.88667002e-02]
 [ 2.28315553e-02  1.02102373e-02 -2.13811578e-02]
 [-9.98635088e-02 -2.20602861e-02  2.46882558e-03]
 [ 2.39436020e-03 -2.60789857e-01  9.08113644e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.10602097]
curr_Stock_Price:  100.37873546355355
curr_Factors:  [100.37873546  -0.94324794  -1.00150296]
mat_Sqrt:  [[14.3564524   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00629491  0.00264142  0.07735653]
Stock Position:  -0.00629491205451507
Bond Position:  [5.73789628]


portfolio before change:  [5.11096942]
curr_Stock_Price:  99.70657839647558
curr_Factors:  [99.7065784  -0.98564962 -1.01755363]
mat_Sqrt:  [[13.45066317  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337389  0.01411938  0.0859571 ]
Stock Position:  -0.003373888875834649
Bond Position:  [5.44736833]


portfolio before change:  [5.11339409]
curr_Stock_Price:  99.18975429778432
curr_Factors:  [99.1897543  -0.9111415  -0.99330967]
mat_Sqrt:  [[14.76978513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02279626 0.09282912 1.20183886]
Stock Position:  0.022796258426788892
Bond Position:  [2.85223882]


portfolio before change:  [5.15870353]
curr_Stock_Price:  101.16169590359536
curr_Factors:  [101.1616959   -1.00262411  -1.00025997]
mat_Sqrt:  [[13.65131841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144331 -0.00659539  0.21422481]
Stock Position:  0.001443307768073774
Bond Position:  [5.01269607]


portfolio before change:  [5.16002027]
curr_Stock_Price:  101.63984419476107
curr_Factors:  [101.63984419  -0.80097368  -1.00369846]
mat_Sqrt:  [[16.72263995  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04979607 -0.07762481  0.04904049]
Stock Position:  -0.04979607453142783
Bond Position:  [10.22128553]


portfolio before change:  [5.18442677]
curr_Stock_Price:  101.17537471640043
curr_Factors:  [101.17537472  -0.90755665  -1.01515337]
mat_Sqrt:  [[14.79287097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031942  -0.00115821  0.07469472]
Stock Position:  -0.0031941987952027995
Bond Position:  [5.50760103]


portfolio before change:  [5.18636691]
curr_Stock_Price:  100.78352592354146
curr_Factors:  [100.78352592  -0.75572564  -0.99776914]
mat_Sqrt:  [[17.45245142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00188526 0.02260798 0.00557712]
Stock Position:  0.0018852599581467924
Bond Position:  [4.99636376]


portfolio before change:  [5.18858699]
curr_Stock_Price:  101.62982905939144
curr_Factors:  [101.62982906  -0.74425985  -1.00277201]
mat_Sqrt:  [[17.71311312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01458817 -0.03654236 -0.14446849]
Stock Position:  0.014588167509172094
Bond Position:  [3.70599402]


portfolio before change:  [5.19419499]
curr_Stock_Price:  101.98249294308111
curr_Factors:  [101.98249294  -0.85679654  -0.98975677]
mat_Sqrt:  [[16.09080264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03296037 -0.00876011 -0.1890832 ]
Stock Position:  -0.032960373482009864
Bond Position:  [8.55557605]


portfolio before change:  [5.2167312]
curr_Stock_Price:  101.33120481993585
curr_Factors:  [101.33120482  -0.63557395  -0.96804731]
mat_Sqrt:  [[20.38446614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00181878 -0.00450381 -0.11404109]
Stock Position:  0.0018187824115918421
Bond Position:  [5.03243179]


portfolio before change:  [5.21935515]
curr_Stock_Price:  102.42800926953666
curr_Factors:  [102.42800927  -0.72083146  -0.94433839]
mat_Sqrt:  [[19.37513132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194427 -0.0912912   0.45790083]
Stock Position:  0.0019442716865193397
Bond Position:  [5.02020727]


portfolio before change:  [5.21619489]
curr_Stock_Price:  100.47981548240546
curr_Factors:  [100.47981548  -0.55403959  -0.93402086]
mat_Sqrt:  [[22.68936743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194484  0.00096269  0.10114453]
Stock Position:  -0.0019448431164050426
Bond Position:  [5.41161237]


portfolio before change:  [5.21628282]
curr_Stock_Price:  100.78244727398904
curr_Factors:  [100.78244727  -0.79759166  -0.94657462]
mat_Sqrt:  [[17.61582994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01193883 -0.02050994  0.84851487]
Stock Position:  0.011938832302647615
Bond Position:  [4.01305808]


portfolio before change:  [5.2197873]
curr_Stock_Price:  101.03396473696274
curr_Factors:  [101.03396474  -0.88004375  -0.97451096]
mat_Sqrt:  [[15.81410145  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00621375 0.05403283 0.37148659]
Stock Position:  0.006213752417005978
Bond Position:  [4.59198726]


portfolio before change:  [5.22525543]
curr_Stock_Price:  101.82158665681582
curr_Factors:  [101.82158666  -1.03049428  -0.96143556]
mat_Sqrt:  [[13.89171043  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00333379 -0.03584987 -0.12913459]
Stock Position:  0.0033337859830035585
Bond Position:  [4.88580405]


portfolio before change:  [5.22429205]
curr_Stock_Price:  101.34940906343287
curr_Factors:  [101.34940906  -0.82534881  -0.95920372]
mat_Sqrt:  [[17.0137443   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226329  0.02503373  0.14167138]
Stock Position:  -0.0022632914829209174
Bond Position:  [5.45367531]


portfolio before change:  [5.22327834]
curr_Stock_Price:  102.0985250791111
curr_Factors:  [102.09852508  -0.73246042  -0.9638566 ]
mat_Sqrt:  [[18.72053879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02315578 -0.07259911  0.33541379]
Stock Position:  -0.0231557769729994
Bond Position:  [7.58744901]


portfolio before change:  [5.25022962]
curr_Stock_Price:  100.97557432405883
curr_Factors:  [100.97557432  -0.54252988  -0.9272634 ]
mat_Sqrt:  [[23.22165781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00747146 -0.02246879 -0.05245613]
Stock Position:  -0.007471459639373375
Bond Position:  [6.00466455]


portfolio before change:  [5.25157255]
curr_Stock_Price:  100.89629964919237
curr_Factors:  [100.89629965  -0.58607689  -0.93925329]
mat_Sqrt:  [[21.94991078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01373838 0.32903445 0.7529633 ]
Stock Position:  0.013738379232588648
Bond Position:  [3.86542092]


portfolio before change:  [5.23312989]
curr_Stock_Price:  99.51870857328062
curr_Factors:  [99.51870857 -0.6549263  -0.92801041]
mat_Sqrt:  [[20.43826614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00692965 -0.00908185  0.36658882]
Stock Position:  -0.006929650058235243
Bond Position:  [5.92275971]


portfolio before change:  [5.23446852]
curr_Stock_Price:  99.43237819613724
curr_Factors:  [99.4323782  -0.6459767  -0.93323961]
mat_Sqrt:  [[20.49665059  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00461345  0.1006584  -0.08293849]
Stock Position:  -0.0046134507994155935
Bond Position:  [5.6931949]


portfolio before change:  [5.2387517]
curr_Stock_Price:  98.65823145898716
curr_Factors:  [98.65823146 -0.62526819 -0.90831504]
mat_Sqrt:  [[21.28661442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031349  0.00669084  0.01410501]
Stock Position:  -0.0003134878568483999
Bond Position:  [5.26967986]


portfolio before change:  [5.23930234]
curr_Stock_Price:  99.00308975473095
curr_Factors:  [99.00308975 -0.30394355 -0.92116223]
mat_Sqrt:  [[29.07984376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00081731 -0.01024038  0.04314927]
Stock Position:  0.0008173147566215152
Bond Position:  [5.15838566]


portfolio before change:  [5.24012086]
curr_Stock_Price:  99.21559084850847
curr_Factors:  [99.21559085 -0.40079265 -0.91559433]
mat_Sqrt:  [[26.59991957  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00293518 0.07245875 0.31814508]
Stock Position:  0.0029351844146637824
Bond Position:  [4.94890481]


portfolio before change:  [5.23817915]
curr_Stock_Price:  98.34329087995629
curr_Factors:  [98.34329088 -0.28172662 -0.92308326]
mat_Sqrt:  [[29.47830125  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300078 -0.0015491   0.1190385 ]
Stock Position:  -0.003000782575302009
Bond Position:  [5.53328599]


portfolio before change:  [5.23809904]
curr_Stock_Price:  98.60049586722229
curr_Factors:  [98.60049587 -0.60432151 -0.93788496]
mat_Sqrt:  [[21.09149363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00565731 -0.00754553 -0.00698639]
Stock Position:  0.005657312060739179
Bond Position:  [4.68028527]


portfolio before change:  [5.2390748]
curr_Stock_Price:  98.66955439242994
curr_Factors:  [98.66955439 -0.95090178 -0.93072568]
mat_Sqrt:  [[15.03151463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00288909 -0.02134117  0.21373002]
Stock Position:  0.0028890878370120654
Bond Position:  [4.95400979]


portfolio before change:  [5.23777972]
curr_Stock_Price:  98.0069353211022
curr_Factors:  [98.00693532 -0.89295631 -0.94037255]
mat_Sqrt:  [[15.66939392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087617  0.01347742  0.07541229]
Stock Position:  -0.0008761722068052138
Bond Position:  [5.32365068]


portfolio before change:  [5.2379055]
curr_Stock_Price:  98.62293996585058
curr_Factors:  [98.62293997 -0.65287519 -0.95810053]
mat_Sqrt:  [[19.69427863  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04099484  0.0076343  -2.49113932]
Stock Position:  -0.04099484247501211
Bond Position:  [9.28093738]


portfolio before change:  [5.26904238]
curr_Stock_Price:  97.89170900189431
curr_Factors:  [97.891709   -0.6675295  -0.94123863]
mat_Sqrt:  [[19.59145945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00093385 -0.03440824 -0.20645412]
Stock Position:  0.0009338519805632887
Bond Position:  [5.17762602]


portfolio before change:  [5.26997227]
curr_Stock_Price:  98.19437626166146
curr_Factors:  [98.19437626 -0.66497637 -0.97312461]
mat_Sqrt:  [[19.08395569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00314248 0.01352293 0.17122346]
Stock Position:  0.003142482438864979
Bond Position:  [4.96139817]


portfolio before change:  [5.26984804]
curr_Stock_Price:  97.95747821328305
curr_Factors:  [97.95747821 -0.79518891 -0.98388821]
mat_Sqrt:  [[16.53461998  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013534   0.03986244 -0.07185692]
Stock Position:  0.0013534019937224686
Bond Position:  [5.13727219]


portfolio before change:  [5.27036034]
curr_Stock_Price:  97.86149945613448
curr_Factors:  [97.86149946 -0.76236081 -0.97730608]
mat_Sqrt:  [[17.18241222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00827352 -0.00098377 -0.45686653]
Stock Position:  -0.008273515913830106
Bond Position:  [6.08001901]


portfolio before change:  [5.27338887]
curr_Stock_Price:  97.58731343202223
curr_Factors:  [97.58731343 -0.83807207 -0.95514289]
mat_Sqrt:  [[16.24089649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189362  0.03972205  0.36565622]
Stock Position:  -0.0018936228959105595
Bond Position:  [5.45818244]


portfolio before change:  [5.27007077]
curr_Stock_Price:  99.69988786611799
curr_Factors:  [99.69988787 -0.6928781  -0.95611787]
mat_Sqrt:  [[19.16658851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0043105  -0.02258786  0.00990315]
Stock Position:  0.004310496176934433
Bond Position:  [4.84031478]


portfolio before change:  [5.27065554]
curr_Stock_Price:  99.6951776874157
curr_Factors:  [99.69517769 -0.77238587 -0.94312968]
mat_Sqrt:  [[17.93226786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00049081 -0.00029201  0.19645753]
Stock Position:  0.0004908053504176
Bond Position:  [5.22172462]


portfolio before change:  [5.27100463]
curr_Stock_Price:  99.07646162770492
curr_Factors:  [99.07646163 -0.85928446 -0.94223067]
mat_Sqrt:  [[16.35243416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114544  0.00322876 -0.06099449]
Stock Position:  0.0011454424277485985
Bond Position:  [5.15751825]


portfolio before change:  [5.2720779]
curr_Stock_Price:  99.4505885488145
curr_Factors:  [99.45058855 -0.94917919 -0.94366745]
mat_Sqrt:  [[14.98147266  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00667018 -0.00697607  0.00704287]
Stock Position:  -0.0066701824487107
Bond Position:  [5.93543147]


portfolio before change:  [5.27666103]
curr_Stock_Price:  98.87471987950045
curr_Factors:  [98.87471988 -0.64799676 -0.90406429]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.27666103]
Stock Price:  99.54072837821687
PL:  [5.27666103]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.36481138e-02  2.66812217e-01  3.46238145e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.29989356e-01  2.57860738e-01  3.71482948e-01]
 [-9.56942266e-03  3.57106757e-02  1.27224443e-01]
 [-9.31311447e-01 -2.76953811e-01  2.98947309e-02]
 [-1.24242756e-02 -6.48635443e-02 -7.33140954e-02]
 [ 2.98803325e-02 -1.47740562e-02 -2.90949282e-02]
 [ 3.81249266e-01  4.35446721e-02 -1.07815346e-01]
 [-4.47545278e-01 -1.99858079e-02 -6.82650046e-02]
 [ 4.80025992e-02 -1.83193780e-02 -4.18867312e-02]
 [ 1.80245049e-02 -2.66578324e-01  7.39680324e-02]
 [-4.94361414e-02  2.78451374e-03  3.43639318e-02]
 [ 1.81065736e-01 -1.23846093e-01  2.03884869e-01]
 [ 9.26820889e-02 -9.96876575e-03 -5.05126320e-02]
 [ 9.19360829e-02 -1.12790552e-01 -6.05922044e-02]
 [-3.77960482e-02  4.70745935e-02  4.46783314e-02]
 [-4.74095978e-01 -2.59876447e-01  1.29356014e-01]
 [-1.30267961e-01  1.81775684e-02 -1.78936726e-02]
 [ 2.97096382e-01  1.29175351e+00  4.15666548e-01]
 [-8.29207573e-02 -1.07663004e-02  8.59882640e-02]
 [-9.41988410e-02  2.32493475e-01 -3.30973710e-02]
 [ 2.15946998e-02  2.14758687e-02  1.23317666e-02]
 [ 6.10515804e-04 -2.62364727e-02 -1.53323778e-02]
 [ 2.83633818e-02  1.04412276e-01  1.09849053e-01]
 [-7.78097495e-02 -6.62140113e-02 -5.75037529e-02]
 [ 9.86008044e-02  2.26462634e-03 -1.10763586e-02]
 [ 4.82839834e-04 -3.54068065e-02 -3.04176567e-02]
 [ 4.76707551e-03  4.16244453e-02 -2.01970085e-02]
 [-5.63812962e-01  5.24653291e-02 -7.52702612e-01]
 [-5.46839041e-02 -1.25263711e-01 -9.69767541e-03]
 [-7.09552994e-02  8.31554336e-02  1.90812784e-01]
 [ 2.11965588e-02  9.94101869e-02 -1.21976589e-02]
 [-1.20117738e-01 -6.57851228e-03 -1.47396104e-01]
 [-6.39348284e-02  3.52685304e-02  7.08813760e-02]
 [ 1.14714917e-01 -9.78239140e-02 -2.04971412e-02]
 [ 1.86104646e-02  2.50153976e-02  6.40306185e-02]
 [-7.08527007e-03 -1.58564702e-02 -3.91128624e-02]
 [-9.98635088e-02 -2.20602861e-02  2.46882558e-03]
 [-9.06850497e-03 -3.17453940e-01  1.24471813e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.50264764]
curr_Stock_Price:  98.90063002975722
curr_Factors:  [98.90063003 -0.90672968 -1.02002583]
mat_Sqrt:  [[14.40189935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111676  0.08437343  0.98772105]
Stock Position:  -0.0011167614893714246
Bond Position:  [-5.39219922]


portfolio before change:  [-5.50389918]
curr_Stock_Price:  99.41772827009567
curr_Factors:  [99.41772827 -1.0169715  -1.0279583 ]
mat_Sqrt:  [[12.86358746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00352787  0.01411938  0.0859571 ]
Stock Position:  -0.003527868332727404
Bond Position:  [-5.15316652]


portfolio before change:  [-5.50420224]
curr_Stock_Price:  99.32103301426447
curr_Factors:  [99.32103301 -0.95405367 -1.02118059]
mat_Sqrt:  [[13.77868875  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02267821 0.08154273 1.05973745]
Stock Position:  0.022678205202511268
Bond Position:  [-7.756625]


portfolio before change:  [-5.49782806]
curr_Stock_Price:  99.64486008050051
curr_Factors:  [99.64486008 -1.01489225 -1.04951188]
mat_Sqrt:  [[12.64432294  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00136996 0.01129271 0.36293592]
Stock Position:  0.0013699589817975325
Bond Position:  [-5.63433743]


portfolio before change:  [-5.49854126]
curr_Stock_Price:  99.63838876479203
curr_Factors:  [99.63838876 -1.40418474 -1.0423908 ]
mat_Sqrt:  [[ 8.62764841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10806654 -0.08758049  0.08528135]
Stock Position:  -0.10806654182939465
Bond Position:  [5.26903485]


portfolio before change:  [-5.49752624]
curr_Stock_Price:  99.63509129852656
curr_Factors:  [99.6350913  -1.51322714 -1.05261356]
mat_Sqrt:  [[ 7.65740939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00379557 -0.02051165 -0.20914471]
Stock Position:  -0.003795568541432509
Bond Position:  [-5.11935443]


portfolio before change:  [-5.49828936]
curr_Stock_Price:  99.66753947206006
curr_Factors:  [99.66753947 -1.58835333 -1.06435907]
mat_Sqrt:  [[ 7.0225587   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00335489 -0.00467197 -0.08299973]
Stock Position:  0.003354886963637368
Bond Position:  [-5.83266269]


portfolio before change:  [-5.49637804]
curr_Stock_Price:  100.45458463986238
curr_Factors:  [100.45458464  -1.57218928  -1.089389  ]
mat_Sqrt:  [[ 7.01553839  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05136682  0.01377003 -0.30756717]
Stock Position:  0.05136681595742701
Bond Position:  [-10.6564102]


portfolio before change:  [-5.50962238]
curr_Stock_Price:  100.2226801056852
curr_Factors:  [100.22268011  -1.25419577  -1.05125584]
mat_Sqrt:  [[ 9.99358013  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04622926 -0.00632007 -0.19474106]
Stock Position:  -0.04622926314975414
Bond Position:  [-0.87640172]


portfolio before change:  [-5.48804707]
curr_Stock_Price:  99.75360782425439
curr_Factors:  [99.75360782 -0.95452802 -1.06613516]
mat_Sqrt:  [[13.22408836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00294761 -0.0057931  -0.11949119]
Stock Position:  0.0029476135268764725
Bond Position:  [-5.78208215]


portfolio before change:  [-5.48774894]
curr_Stock_Price:  100.09996753286332
curr_Factors:  [100.09996753  -1.00969675  -1.08230686]
mat_Sqrt:  [[12.35629622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00212363 -0.08429947  0.21101021]
Stock Position:  0.0021236253216130895
Bond Position:  [-5.70032376]


portfolio before change:  [-5.48878683]
curr_Stock_Price:  99.94678076545496
curr_Factors:  [99.94678077 -1.19173857 -1.0598577 ]
mat_Sqrt:  [[10.51751096  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00402659  0.00088054  0.09803073]
Stock Position:  -0.004026593129483922
Bond Position:  [-5.08634181]


portfolio before change:  [-5.48949113]
curr_Stock_Price:  99.96378330124863
curr_Factors:  [99.9637833  -0.99058399 -1.06913951]
mat_Sqrt:  [[12.74430434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01722227 -0.03916357  0.58162678]
Stock Position:  0.017222271378738614
Bond Position:  [-7.21109453]


portfolio before change:  [-5.48820863]
curr_Stock_Price:  100.09059241831464
curr_Factors:  [100.09059242  -0.95728272  -1.05817924]
mat_Sqrt:  [[13.33795511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0061564  -0.0031524  -0.14409848]
Stock Position:  0.00615640463362552
Bond Position:  [-6.10440682]


portfolio before change:  [-5.48599533]
curr_Stock_Price:  100.57405578117742
curr_Factors:  [100.57405578  -1.17333828  -1.06191531]
mat_Sqrt:  [[10.757904    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00712551 -0.0356675  -0.17285269]
Stock Position:  0.007125506181971739
Bond Position:  [-6.20263639]


portfolio before change:  [-5.48632766]
curr_Stock_Price:  100.6362342069086
curr_Factors:  [100.63623421  -1.36051581  -1.06265495]
mat_Sqrt:  [[ 8.9204074   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307841  0.01488629  0.12745484]
Stock Position:  -0.0030784088665522973
Bond Position:  [-5.17652818]


portfolio before change:  [-5.48634163]
curr_Stock_Price:  100.43056538424719
curr_Factors:  [100.43056538  -1.1244874   -1.05431645]
mat_Sqrt:  [[11.36641259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03997755 -0.08218015  0.3690167 ]
Stock Position:  -0.03997754517369568
Bond Position:  [-1.47137417]


portfolio before change:  [-5.49511198]
curr_Stock_Price:  100.64534628850288
curr_Factors:  [100.64534629  -0.9804629   -1.05263423]
mat_Sqrt:  [[13.17743359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01012725  0.00574825 -0.05104567]
Stock Position:  -0.010127248807028694
Bond Position:  [-4.47585152]


portfolio before change:  [-5.48614707]
curr_Stock_Price:  99.70487124820151
curr_Factors:  [99.70487125 -0.7493756  -1.03471647]
mat_Sqrt:  [[16.74538096  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02480068 0.40848833 1.18578096]
Stock Position:  0.024800683516672226
Bond Position:  [-7.95889603]


portfolio before change:  [-5.48132972]
curr_Stock_Price:  99.93923065905463
curr_Factors:  [99.93923066 -0.88183827 -1.04820763]
mat_Sqrt:  [[14.50533351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00452568 -0.0034046   0.24530058]
Stock Position:  -0.0045256774735944385
Bond Position:  [-5.029037]


portfolio before change:  [-5.47720603]
curr_Stock_Price:  98.88914185378131
curr_Factors:  [98.88914185 -0.98368613 -1.06529291]
mat_Sqrt:  [[12.74348813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00745101  0.07352089 -0.09441759]
Stock Position:  -0.007451010023843635
Bond Position:  [-4.74038204]


portfolio before change:  [-5.48345414]
curr_Stock_Price:  99.64817094719018
curr_Factors:  [99.64817095 -1.30320743 -1.08992448]
mat_Sqrt:  [[ 9.10217844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00270995 0.00679127 0.0351791 ]
Stock Position:  0.002709946401908561
Bond Position:  [-5.75349535]


portfolio before change:  [-5.48596755]
curr_Stock_Price:  98.98610201406497
curr_Factors:  [98.98610201 -1.14399456 -1.10569865]
mat_Sqrt:  [[10.43625966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003063  -0.0082967  -0.04373901]
Stock Position:  -0.0003062989641505962
Bond Position:  [-5.45564821]


portfolio before change:  [-5.48668306]
curr_Stock_Price:  99.09550462335567
curr_Factors:  [99.09550462 -1.23529904 -1.10715404]
mat_Sqrt:  [[ 9.5222484   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00561655 0.03301806 0.31336877]
Stock Position:  0.005616545277047351
Bond Position:  [-6.04325744]


portfolio before change:  [-5.48734122]
curr_Stock_Price:  99.11282591469585
curr_Factors:  [99.11282591 -1.23258746 -1.09462146]
mat_Sqrt:  [[ 9.67020911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00943695 -0.02093871 -0.1640422 ]
Stock Position:  -0.009436951293597616
Bond Position:  [-4.55201831]


portfolio before change:  [-5.49273491]
curr_Stock_Price:  99.62407654713097
curr_Factors:  [99.62407655 -1.35724267 -1.08941225]
mat_Sqrt:  [[ 8.62572435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01117568  0.00071614 -0.03159777]
Stock Position:  0.011175678774726413
Bond Position:  [-6.60610159]


portfolio before change:  [-5.49901927]
curr_Stock_Price:  99.13564559583638
curr_Factors:  [99.1356456  -1.28660488 -1.06600075]
mat_Sqrt:  [[ 9.42988058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070418 -0.01119662 -0.08677311]
Stock Position:  -0.000704180513547731
Bond Position:  [-5.42920988]


portfolio before change:  [-5.49977262]
curr_Stock_Price:  99.24166322970729
curr_Factors:  [99.24166323 -1.33761901 -1.04403853]
mat_Sqrt:  [[ 9.1696615   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00018748  0.01316281 -0.05761644]
Stock Position:  0.00018747878215415664
Bond Position:  [-5.51837833]


portfolio before change:  [-5.50036338]
curr_Stock_Price:  99.7701786377914
curr_Factors:  [99.77017864 -1.2517947  -1.04029549]
mat_Sqrt:  [[10.0822771   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07102593  0.01659099 -2.14725104]
Stock Position:  -0.07102592830196829
Bond Position:  [1.58590618]


portfolio before change:  [-5.46061962]
curr_Stock_Price:  99.2134030457501
curr_Factors:  [99.21340305 -1.18738893 -1.02846185]
mat_Sqrt:  [[10.82028191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00553569 -0.03961186 -0.02766477]
Stock Position:  -0.005535690236660339
Bond Position:  [-4.91140496]


portfolio before change:  [-5.45894185]
curr_Stock_Price:  98.79940955257074
curr_Factors:  [98.79940955 -1.24878039 -1.01701056]
mat_Sqrt:  [[10.25023541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291298  0.02629606  0.54433576]
Stock Position:  -0.0029129807945713834
Bond Position:  [-5.17114106]


portfolio before change:  [-5.45739193]
curr_Stock_Price:  98.04542317055609
curr_Factors:  [98.04542317 -1.17675387 -1.04273804]
mat_Sqrt:  [[10.65403793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00199675  0.03143626 -0.03479653]
Stock Position:  0.0019967529925353717
Bond Position:  [-5.65316442]


portfolio before change:  [-5.45570315]
curr_Stock_Price:  99.24510671248848
curr_Factors:  [99.24510671 -1.11779465 -1.05523058]
mat_Sqrt:  [[11.29734095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01331063 -0.00208031 -0.42048006]
Stock Position:  -0.013310627636114201
Bond Position:  [-4.13468849]


portfolio before change:  [-5.45619968]
curr_Stock_Price:  99.24357892950769
curr_Factors:  [99.24357893 -1.10184482 -1.06846025]
mat_Sqrt:  [[11.32793897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428636  0.01115289  0.20220484]
Stock Position:  -0.0042863577158372785
Bond Position:  [-5.0308062]


portfolio before change:  [-5.45846272]
curr_Stock_Price:  99.62482272470092
curr_Factors:  [99.62482272 -1.18070893 -1.07947317]
mat_Sqrt:  [[10.39400561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0103911  -0.03093464 -0.05847264]
Stock Position:  0.010391100153068959
Bond Position:  [-6.49367423]


portfolio before change:  [-5.45627306]
curr_Stock_Price:  99.9136674670125
curr_Factors:  [99.91366747 -1.45047253 -1.06879389]
mat_Sqrt:  [[ 8.04491383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00401826 0.00791056 0.18266153]
Stock Position:  0.004018259898904025
Bond Position:  [-5.85775215]


portfolio before change:  [-5.45748903]
curr_Stock_Price:  99.79329254647793
curr_Factors:  [99.79329255 -1.44558947 -1.05135248]
mat_Sqrt:  [[ 8.21662073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188381 -0.00501426 -0.11157811]
Stock Position:  -0.0018838111758873923
Bond Position:  [-5.26949731]


portfolio before change:  [-5.45751914]
curr_Stock_Price:  99.45960071874428
curr_Factors:  [99.45960072 -1.52866571 -1.07274675]
mat_Sqrt:  [[ 7.37679363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01354642 -0.00697607  0.00704287]
Stock Position:  -0.013546421518600311
Bond Position:  [-4.11019747]


portfolio before change:  [-5.46185474]
curr_Stock_Price:  99.74172626731365
curr_Factors:  [99.74172627 -1.75764333 -1.06861216]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.46185474]
Stock Price:  99.71026647536817
PL:  [-5.46185474]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.26950540e-01  1.47107484e-01  1.63605215e-01]
 [-1.06501609e-01 -4.08872857e-03  1.41508065e-01]
 [ 1.48535152e-01  1.74763148e-01  3.00297587e-01]
 [-5.31274039e-02 -1.64244469e-02  9.04803195e-02]
 [-1.79420747e-01 -6.39719761e-02  4.82690081e-02]
 [ 8.09091126e-02 -2.51969460e-01 -3.42566630e-01]
 [ 1.08561074e-02 -4.00418632e-01 -6.32207792e-02]
 [ 1.19173883e-01  3.20550807e-01 -3.68253255e-02]
 [ 2.91055187e-02  2.68882888e-02 -5.35722471e-02]
 [ 1.52962615e-01  6.72626399e-02  3.74079231e-01]
 [ 2.45388820e-01 -1.79920194e-01 -8.42519999e-02]
 [-2.85930173e-01 -1.88159962e-01 -4.15426803e-01]
 [ 2.90668449e-01 -4.46203987e-01 -1.66571895e-01]
 [ 7.05859556e-02 -9.26949822e-02 -5.12084167e-02]
 [-2.64833779e-01  4.89618488e-01  3.43307519e-01]
 [ 1.31615560e-01 -6.93690389e-01 -2.04452391e-01]
 [ 1.50693238e-01 -2.06134324e-01 -1.13123395e-01]
 [-3.90511752e-01 -2.41602341e-01 -7.45523200e-02]
 [ 1.13600082e-01  1.00515290e+00 -2.94267129e-02]
 [-3.81778146e-01 -6.39214735e-02  2.85733087e-01]
 [-8.87564762e-02  5.59558868e-02 -4.13751859e-02]
 [ 3.98517064e-03 -7.44328231e-03  2.25814468e-02]
 [-5.58083783e-02 -1.92493430e-02 -6.96437645e-02]
 [ 4.33999480e-02  1.92971734e-01  1.10841097e-01]
 [-8.93580632e-02 -5.39457853e-02  3.65345303e-02]
 [ 1.07907044e-01  1.43259742e-03 -9.55049552e-03]
 [ 3.57895015e-02 -6.60504357e-02  1.14543650e-01]
 [-5.25247363e-02  4.35040359e-02  5.49174702e-02]
 [-6.21982067e-01 -2.68006824e-02 -9.12508377e-01]
 [ 7.13504638e-02 -1.01682555e-01 -9.72380161e-02]
 [ 1.30202648e-01  5.28766951e-03 -3.97192947e-02]
 [ 2.08477293e-02  1.10998144e-01 -1.82405356e-02]
 [-1.29716698e-01 -1.20470395e-02 -1.41055745e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 1.89768299e-01 -1.46330506e-01 -5.22223989e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-1.62602091e-02 -1.78709775e-02 -4.77927286e-02]
 [-8.93367391e-02  9.48671601e-03 -3.47015484e-04]
 [-4.22158920e-02 -2.54411378e-01  1.24464661e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.26844174]
curr_Stock_Price:  99.49058179287636
curr_Factors:  [99.49058179 -1.13533446 -0.97928313]
mat_Sqrt:  [[12.00646666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00747568  0.04651947  0.46672014]
Stock Position:  -0.007475676980510752
Bond Position:  [-0.52468228]


portfolio before change:  [-1.26226017]
curr_Stock_Price:  98.65491768727924
curr_Factors:  [98.65491769 -1.20138837 -0.97571699]
mat_Sqrt:  [[11.18443093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00694912 -0.00129297  0.40368312]
Stock Position:  -0.006949121223379794
Bond Position:  [-0.57669519]


portfolio before change:  [-1.2548294]
curr_Stock_Price:  97.57523225788995
curr_Factors:  [97.57523226 -1.16019699 -0.96581623]
mat_Sqrt:  [[11.64189783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01841156 0.05526496 0.85666543]
Stock Position:  0.018411560461898176
Bond Position:  [-3.05134169]


portfolio before change:  [-1.24112043]
curr_Stock_Price:  98.34053481860626
curr_Factors:  [98.34053482 -0.9741674  -0.98920512]
mat_Sqrt:  [[13.80545467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254119 -0.00519387  0.25811517]
Stock Position:  -0.0025411885525928163
Bond Position:  [-0.99121858]


portfolio before change:  [-1.23902053]
curr_Stock_Price:  97.46542979398987
curr_Factors:  [97.46542979 -0.93795886 -0.99970757]
mat_Sqrt:  [[14.03888968  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01219609 -0.02022972  0.13769804]
Stock Position:  -0.012196094583272038
Bond Position:  [-0.05032293]


portfolio before change:  [-1.2359575]
curr_Stock_Price:  97.21376540951636
curr_Factors:  [97.21376541 -0.59907145 -0.98953569]
mat_Sqrt:  [[19.85200849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.25527238e-04 -7.96797395e-02 -9.77247242e-01]
Stock Position:  0.00022552723833112992
Bond Position:  [-1.25788185]


portfolio before change:  [-1.23626659]
curr_Stock_Price:  96.54046170990375
curr_Factors:  [96.54046171 -0.97306478 -0.98110488]
mat_Sqrt:  [[13.6780527   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090565 -0.12662349 -0.18035129]
Stock Position:  -0.0009056511958280858
Bond Position:  [-1.14883461]


portfolio before change:  [-1.23661317]
curr_Stock_Price:  96.76457142078559
curr_Factors:  [96.76457142 -0.8168692  -0.98852915]
mat_Sqrt:  [[15.9089617   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00753874  0.10136707 -0.1050524 ]
Stock Position:  0.007538740339817621
Bond Position:  [-1.96609615]


portfolio before change:  [-1.24187919]
curr_Stock_Price:  96.09864578084127
curr_Factors:  [96.09864578 -0.95066721 -0.95166922]
mat_Sqrt:  [[14.33979865  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00131553  0.00850282 -0.15282671]
Stock Position:  0.0013155262962425813
Bond Position:  [-1.36829948]


portfolio before change:  [-1.242686]
curr_Stock_Price:  95.61537074398524
curr_Factors:  [95.61537074 -0.83875481 -0.9735647 ]
mat_Sqrt:  [[15.61159775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0148004  0.02127031 1.06714392]
Stock Position:  0.014800402599614003
Bond Position:  [-2.65783198]


portfolio before change:  [-1.24996814]
curr_Stock_Price:  95.14579633376218
curr_Factors:  [95.14579633 -0.89492576 -0.9586863 ]
mat_Sqrt:  [[14.90651476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01499649 -0.05689576 -0.2403475 ]
Stock Position:  0.014996492256125683
Bond Position:  [-2.67682133]


portfolio before change:  [-1.26003359]
curr_Stock_Price:  94.49692246619907
curr_Factors:  [94.49692247 -0.85523355 -0.95524595]
mat_Sqrt:  [[15.45739872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02429821 -0.0595014  -1.18509704]
Stock Position:  -0.024298207646884954
Bond Position:  [1.03607225]


portfolio before change:  [-1.25262849]
curr_Stock_Price:  94.19749355503245
curr_Factors:  [94.19749356 -0.69018781 -0.93341589]
mat_Sqrt:  [[18.5745037   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01319799 -0.14110209 -0.47518325]
Stock Position:  0.013197992792955941
Bond Position:  [-2.49584633]


portfolio before change:  [-1.24100292]
curr_Stock_Price:  95.10199210214404
curr_Factors:  [95.1019921  -0.99165106 -0.94736115]
mat_Sqrt:  [[13.68003826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00422073 -0.02931273 -0.14608336]
Stock Position:  0.004220727023139554
Bond Position:  [-1.64240247]


portfolio before change:  [-1.24518244]
curr_Stock_Price:  94.16040001045023
curr_Factors:  [94.16040001 -0.73365404 -0.93877477]
mat_Sqrt:  [[17.68241959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01029919  0.15483096  0.97936079]
Stock Position:  -0.010299186094925656
Bond Position:  [-0.27540696]


portfolio before change:  [-1.2312298]
curr_Stock_Price:  92.80232521223463
curr_Factors:  [92.80232521 -0.67353183 -0.95213939]
mat_Sqrt:  [[18.26159958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00394111 -0.21936416 -0.58324576]
Stock Position:  0.00394110500268482
Bond Position:  [-1.59697351]


portfolio before change:  [-1.23266517]
curr_Stock_Price:  92.48877405992762
curr_Factors:  [92.48877406 -0.39977683 -0.97126657]
mat_Sqrt:  [[23.4775319   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00520837 -0.0651854  -0.32270956]
Stock Position:  0.005208369295718149
Bond Position:  [-1.71438087]


portfolio before change:  [-1.23271182]
curr_Stock_Price:  92.52096605707638
curr_Factors:  [92.52096606 -0.19515521 -0.95790336]
mat_Sqrt:  [[29.20607408  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01410555 -0.07640137 -0.21267702]
Stock Position:  -0.014105553004676724
Bond Position:  [0.07234757]


portfolio before change:  [-1.23241307]
curr_Stock_Price:  92.50042813699072
curr_Factors:  [92.50042814 -0.43523301 -0.94266716]
mat_Sqrt:  [[23.32004073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00572668  0.31785726 -0.08394622]
Stock Position:  0.005726675928250136
Bond Position:  [-1.76213305]


portfolio before change:  [-1.2152998]
curr_Stock_Price:  95.52723709364987
curr_Factors:  [95.52723709 -0.3913985  -0.94061122]
mat_Sqrt:  [[25.21405789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01289374 -0.02021374  0.81511696]
Stock Position:  -0.012893742485976526
Bond Position:  [0.01640379]


portfolio before change:  [-1.21116071]
curr_Stock_Price:  95.20638063284181
curr_Factors:  [95.20638063 -0.47187241 -0.94987725]
mat_Sqrt:  [[22.97248764  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416835  0.01769481 -0.11803189]
Stock Position:  -0.004168350307558237
Bond Position:  [-0.81430716]


portfolio before change:  [-1.21992551]
curr_Stock_Price:  97.28466149435698
curr_Factors:  [97.28466149 -0.42339322 -0.92516979]
mat_Sqrt:  [[25.2563682   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00033268 -0.00235377  0.06441858]
Stock Position:  0.0003326845878128654
Bond Position:  [-1.25229062]


portfolio before change:  [-1.21992166]
curr_Stock_Price:  97.76678740321252
curr_Factors:  [97.7667874  -0.69079084 -0.95434402]
mat_Sqrt:  [[18.86767356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00373768 -0.00608718 -0.19867428]
Stock Position:  -0.00373768222606631
Bond Position:  [-0.85450047]


portfolio before change:  [-1.22523315]
curr_Stock_Price:  99.15927334737289
curr_Factors:  [99.15927335 -0.65021327 -0.95778557]
mat_Sqrt:  [[19.86041469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00357534 0.06102302 0.3161988 ]
Stock Position:  0.003575343311449701
Bond Position:  [-1.57976159]


portfolio before change:  [-1.22661873]
curr_Stock_Price:  98.82696964686127
curr_Factors:  [98.82696965 -0.4684901  -0.96552094]
mat_Sqrt:  [[23.55550365  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353605 -0.01705916  0.10422285]
Stock Position:  -0.003536046560102075
Bond Position:  [-0.87716196]


portfolio before change:  [-1.22815877]
curr_Stock_Price:  99.231485029593
curr_Factors:  [99.23148503 -0.48589883 -0.95010583]
mat_Sqrt:  [[23.6048145   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00449038  0.00045303 -0.02724491]
Stock Position:  0.00449037830437909
Bond Position:  [-1.67374567]


portfolio before change:  [-1.23566602]
curr_Stock_Price:  97.6062283601933
curr_Factors:  [97.60622836 -0.23665975 -0.93737097]
mat_Sqrt:  [[30.17188672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00190459 -0.02088698  0.32676115]
Stock Position:  0.0019045945566867869
Bond Position:  [-1.42156631]


portfolio before change:  [-1.23682485]
curr_Stock_Price:  97.09109149767828
curr_Factors:  [97.0910915  -0.23586852 -0.91391907]
mat_Sqrt:  [[30.74914028  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00130708  0.01375718  0.15666426]
Stock Position:  -0.0013070767150892195
Bond Position:  [-1.10991934]


portfolio before change:  [-1.2373202]
curr_Stock_Price:  97.36391295592084
curr_Factors:  [97.36391296 -0.43792812 -0.88495707]
mat_Sqrt:  [[25.93440457  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03119173 -0.00847512 -2.60313241]
Stock Position:  -0.031191734035766833
Bond Position:  [1.79962908]


portfolio before change:  [-1.23726972]
curr_Stock_Price:  97.36950702154654
curr_Factors:  [97.36950702 -0.44421441 -0.88410178]
mat_Sqrt:  [[25.79541866  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00189477 -0.03215485 -0.27739299]
Stock Position:  0.0018947707416164833
Bond Position:  [-1.42176261]


portfolio before change:  [-1.23777521]
curr_Stock_Price:  97.19652371987192
curr_Factors:  [97.19652372 -0.4910605  -0.90085446]
mat_Sqrt:  [[24.16293832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00505864  0.00167211 -0.11330809]
Stock Position:  0.005058635926965813
Bond Position:  [-1.72945704]


portfolio before change:  [-1.22698142]
curr_Stock_Price:  99.37299646921916
curr_Factors:  [99.37299647 -0.54524671 -0.92299694]
mat_Sqrt:  [[22.88854925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00087338  0.0351007  -0.05203517]
Stock Position:  0.0008733779961770125
Bond Position:  [-1.31377161]


portfolio before change:  [-1.22642309]
curr_Stock_Price:  100.20031897892682
curr_Factors:  [100.20031898  -0.81824209  -0.92083812]
mat_Sqrt:  [[17.60338417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00902216 -0.00380961 -0.40239278]
Stock Position:  -0.009022164879945456
Bond Position:  [-0.32239929]


portfolio before change:  [-1.23439105]
curr_Stock_Price:  101.07900534491394
curr_Factors:  [101.07900534  -0.79157342  -0.90093791]
mat_Sqrt:  [[18.60426975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281729  0.0049611   0.16678008]
Stock Position:  -0.0028172943237846026
Bond Position:  [-0.94962174]


portfolio before change:  [-1.23352504]
curr_Stock_Price:  100.72947837741793
curr_Factors:  [100.72947838  -0.76301191  -0.91685094]
mat_Sqrt:  [[18.77592824  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00933803 -0.04627377 -0.14897597]
Stock Position:  0.009338031486029104
Bond Position:  [-2.17414008]


portfolio before change:  [-1.22973368]
curr_Stock_Price:  101.16459605321376
curr_Factors:  [101.16459605  -1.14570782  -0.90366759]
mat_Sqrt:  [[13.03155133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00188096 0.00777784 0.21633947]
Stock Position:  0.0018809643637047115
Bond Position:  [-1.42002068]


portfolio before change:  [-1.22964427]
curr_Stock_Price:  101.306503494989
curr_Factors:  [101.30650349  -1.01777813  -0.88387465]
mat_Sqrt:  [[15.12725122  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017503  -0.0056513  -0.13633935]
Stock Position:  -0.0017503038207409372
Bond Position:  [-1.05232711]


portfolio before change:  [-1.22936642]
curr_Stock_Price:  101.07260257355807
curr_Factors:  [101.07260257  -1.13477399  -0.9049399 ]
mat_Sqrt:  [[13.14610099  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00678244  0.00299996 -0.00098994]
Stock Position:  -0.006782438950186266
Bond Position:  [-0.54384766]


portfolio before change:  [-1.2321334]
curr_Stock_Price:  101.47054163007807
curr_Factors:  [101.47054163  -1.0282363   -0.90106165]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.2321334]
Stock Price:  101.59959934675601
PL:  [-2.83173275]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.97226695e-01  6.73729812e-02  2.78574152e-01]
 [-3.32774829e-02  1.39141117e-02 -2.46468349e-02]
 [ 2.96996114e-01 -2.44388139e-01 -4.63073218e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-7.73507261e-01 -2.26421904e-01  1.60691042e-03]
 [-7.03548351e-02  3.05827971e-02  7.81172338e-02]
 [ 2.16667341e-02  1.02962318e-01  3.70486861e-02]
 [ 2.19377030e-01 -1.70112282e-01 -2.54675366e-02]
 [-4.70769473e-01 -2.52207756e-02 -5.65551762e-02]
 [ 5.69964898e-02 -3.21604135e-02 -5.44024999e-02]
 [ 1.81201777e-02 -2.86385699e-01  1.15301767e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 8.27754441e-02 -1.45789903e-02  2.54082783e-01]
 [ 5.29917662e-02  2.25858530e-01  1.81816911e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-3.48933032e-02  3.98495829e-02  4.35562700e-02]
 [-4.77254535e-01 -2.46850884e-01  1.29159475e-01]
 [-1.27594723e-01  1.83512369e-02 -2.01193244e-02]
 [ 2.86091714e-01  1.14686427e+00  4.59470112e-01]
 [ 1.61769972e-03  1.94533528e-02  2.93586280e-02]
 [-2.68773995e-02 -1.47617214e-01  4.40438416e-03]
 [-3.22207202e-02  6.02344224e-02 -3.07185272e-02]
 [ 1.29884408e-01 -2.98683731e-02  1.42268892e-01]
 [ 7.88043894e-02 -1.28437571e-01 -6.73382274e-02]
 [-8.34224519e-02 -5.11839916e-03  1.35663134e-01]
 [ 1.46095496e-02  6.30125157e-02 -9.10922252e-03]
 [-1.19155765e-01 -7.13472054e-02  1.74088692e-01]
 [ 5.83308974e-02  6.09007163e-02 -8.73523925e-02]
 [-6.85703829e-01 -1.04029900e-01 -1.03768388e+00]
 [-1.39154067e-01  1.08340146e-01 -4.00585401e-02]
 [-4.25415860e-02 -1.32460326e-02  1.13271461e-01]
 [ 1.31322578e-02  3.85595195e-02  1.72232079e-02]
 [-1.30645156e-01 -3.17098312e-03 -1.41861952e-01]
 [-6.66767658e-02 -3.03835058e-02  2.92443327e-02]
 [ 2.11073900e-01 -1.70884738e-01 -7.99409566e-02]
 [-1.02798594e-02  1.58596303e-01  8.03288840e-02]
 [ 1.07590597e-02  1.05950830e-02 -4.51457764e-02]
 [-7.20896244e-02  6.48459820e-02 -4.23984849e-03]
 [-6.86022164e-02 -2.00799904e-01  7.21243121e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.60158479]
curr_Stock_Price:  99.44416498316174
curr_Factors:  [99.44416498 -0.70578368 -0.98116013]
mat_Sqrt:  [[18.40555494  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01296475  0.02130521  0.79469452]
Stock Position:  -0.012964750181196747
Bond Position:  [-0.31231603]


portfolio before change:  [-1.62253102]
curr_Stock_Price:  101.05678305796044
curr_Factors:  [101.05678306  -0.90733493  -1.01402256]
mat_Sqrt:  [[14.79552955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00256491  0.00440003 -0.07031056]
Stock Position:  -0.0025649123284516026
Bond Position:  [-1.36332923]


portfolio before change:  [-1.62424374]
curr_Stock_Price:  101.65808920308973
curr_Factors:  [101.6580892   -1.08145875  -1.01562412]
mat_Sqrt:  [[12.48505401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01571172 -0.07728232 -1.321019  ]
Stock Position:  0.015711715318351718
Bond Position:  [-3.2214667]


portfolio before change:  [-1.61631802]
curr_Stock_Price:  102.18816676751126
curr_Factors:  [102.18816677  -1.13017478  -1.02318294]
mat_Sqrt:  [[11.86340164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166083 -0.00659539  0.21422481]
Stock Position:  0.0016608266755259787
Bond Position:  [-1.78603486]


portfolio before change:  [-1.61715902]
curr_Stock_Price:  101.816229398176
curr_Factors:  [101.8162294   -0.70418513  -1.03014114]
mat_Sqrt:  [[17.97250772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04334539 -0.07160089  0.00458407]
Stock Position:  -0.04334539469143678
Bond Position:  [2.79610563]


portfolio before change:  [-1.62395025]
curr_Stock_Price:  101.98097046970621
curr_Factors:  [101.98097047  -0.65801908  -1.01873259]
mat_Sqrt:  [[19.06843902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281195  0.00967113  0.22284672]
Stock Position:  -0.0028119541973605916
Bond Position:  [-1.33718443]


portfolio before change:  [-1.6229386]
curr_Stock_Price:  101.56175633347023
curr_Factors:  [101.56175633  -0.42179344  -1.02490744]
mat_Sqrt:  [[23.90209638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0013341  0.03255954 0.10568959]
Stock Position:  0.001334098091198061
Bond Position:  [-1.75843194]


portfolio before change:  [-1.6238523]
curr_Stock_Price:  101.04164303759318
curr_Factors:  [101.04164304  -0.44292158  -1.04582668]
mat_Sqrt:  [[22.80054594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00920093 -0.05379423 -0.07265179]
Stock Position:  0.009200929280931303
Bond Position:  [-2.55352931]


portfolio before change:  [-1.62558895]
curr_Stock_Price:  100.88758889567688
curr_Factors:  [100.8875889   -0.39621685  -1.05914989]
mat_Sqrt:  [[23.53856592  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02051803 -0.00797551 -0.16133618]
Stock Position:  -0.02051802772290907
Bond Position:  [0.4444254]


portfolio before change:  [-1.60114872]
curr_Stock_Price:  99.69913787968439
curr_Factors:  [99.69913788 -0.54165824 -1.06556001]
mat_Sqrt:  [[19.98413638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00225485 -0.01017002 -0.15519519]
Stock Position:  0.002254850892845744
Bond Position:  [-1.82595541]


portfolio before change:  [-1.59906877]
curr_Stock_Price:  100.72280241230916
curr_Factors:  [100.72280241  -0.80890587  -1.04811084]
mat_Sqrt:  [[15.72663079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00217857 -0.09056311  0.32892385]
Stock Position:  0.002178572503398344
Bond Position:  [-1.8185007]


portfolio before change:  [-1.59682452]
curr_Stock_Price:  101.85729308353413
curr_Factors:  [101.85729308  -0.84959911  -1.08253467]
mat_Sqrt:  [[14.75288957  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00488891  0.00225658  0.15019092]
Stock Position:  -0.0048889146943183635
Bond Position:  [-1.09885291]


portfolio before change:  [-1.59868008]
curr_Stock_Price:  102.20873902668784
curr_Factors:  [102.20873903  -0.58552776  -1.09759254]
mat_Sqrt:  [[18.98970299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00707033 -0.00461028  0.72482746]
Stock Position:  0.007070328961814347
Bond Position:  [-2.32132949]


portfolio before change:  [-1.59693724]
curr_Stock_Price:  102.4962821717207
curr_Factors:  [102.49628217  -0.82797014  -1.10235031]
mat_Sqrt:  [[14.87238412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00645066 0.07142274 0.51867304]
Stock Position:  0.0064506557346300135
Bond Position:  [-2.25810547]


portfolio before change:  [-1.59783521]
curr_Stock_Price:  102.4008360732615
curr_Factors:  [102.40083607  -0.93562647  -1.06816463]
mat_Sqrt:  [[13.80600686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00310924 -0.03587186 -0.12433753]
Stock Position:  0.0031092360051403448
Bond Position:  [-1.91622358]


portfolio before change:  [-1.60044398]
curr_Stock_Price:  101.63883882002766
curr_Factors:  [101.63883882  -0.9250777   -1.06630228]
mat_Sqrt:  [[13.87440471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179997  0.01260154  0.12425391]
Stock Position:  -0.0017999694747884872
Bond Position:  [-1.41749717]


portfolio before change:  [-1.60065779]
curr_Stock_Price:  101.65917601831599
curr_Factors:  [101.65917602  -0.98718126  -1.08160195]
mat_Sqrt:  [[12.84356095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03560256 -0.0780611   0.36845603]
Stock Position:  -0.0356025585155349
Bond Position:  [2.01866898]


portfolio before change:  [-1.6020677]
curr_Stock_Price:  101.70586543265253
curr_Factors:  [101.70586543  -1.29901073  -1.08858668]
mat_Sqrt:  [[ 9.34169357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01404753  0.00580317 -0.05739483]
Stock Position:  -0.014047531621208545
Bond Position:  [-0.17335134]


portfolio before change:  [-1.60596994]
curr_Stock_Price:  101.98211123154385
curr_Factors:  [101.98211123  -1.22718089  -1.07987085]
mat_Sqrt:  [[10.15276087  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04033312 0.36267032 1.31074034]
Stock Position:  0.04033312422344417
Bond Position:  [-5.7192271]


portfolio before change:  [-1.62616004]
curr_Stock_Price:  101.49925384753413
curr_Factors:  [101.49925385  -1.22387916  -1.09479607]
mat_Sqrt:  [[ 9.98791851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00081226 0.00615169 0.08375199]
Stock Position:  0.0008122601283620607
Bond Position:  [-1.70860383]


portfolio before change:  [-1.62581621]
curr_Stock_Price:  102.18550880174364
curr_Factors:  [102.1855088   -1.23330538  -1.05799313]
mat_Sqrt:  [[10.33453671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288255 -0.04668066  0.01256448]
Stock Position:  -0.002882549963417771
Bond Position:  [-1.33126137]


portfolio before change:  [-1.62845072]
curr_Stock_Price:  103.04172714482297
curr_Factors:  [103.04172714  -1.35279576  -1.03860785]
mat_Sqrt:  [[ 9.42843772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0039175   0.0190478  -0.08763141]
Stock Position:  -0.003917496018475293
Bond Position:  [-1.22478516]


portfolio before change:  [-1.62866284]
curr_Stock_Price:  103.0567907466403
curr_Factors:  [103.05679075  -1.26588512  -1.0077992 ]
mat_Sqrt:  [[10.60786681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0149091  -0.00944521  0.40585355]
Stock Position:  0.014909097994731467
Bond Position:  [-3.16514663]


portfolio before change:  [-1.62194491]
curr_Stock_Price:  103.53392186789416
curr_Factors:  [103.53392187  -1.21829204  -0.99411565]
mat_Sqrt:  [[11.33042536  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00544929 -0.04061553 -0.19209722]
Stock Position:  0.0054492912247023646
Bond Position:  [-2.1861314]


portfolio before change:  [-1.623436]
curr_Stock_Price:  103.310442916278
curr_Factors:  [103.31044292  -1.32780476  -0.99440443]
mat_Sqrt:  [[10.13028321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00551441 -0.00161858  0.38700916]
Stock Position:  -0.00551440526750619
Bond Position:  [-1.05374035]


portfolio before change:  [-1.62531026]
curr_Stock_Price:  103.62644002460388
curr_Factors:  [103.62644002  -1.45665531  -1.01169334]
mat_Sqrt:  [[ 8.7797142   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00163754  0.01992631 -0.02598608]
Stock Position:  0.001637537755380156
Bond Position:  [-1.79500247]


portfolio before change:  [-1.62555911]
curr_Stock_Price:  103.6115011981945
curr_Factors:  [103.6115012   -1.47119309  -0.98901412]
mat_Sqrt:  [[ 8.85020948  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00965652 -0.02256197  0.49662658]
Stock Position:  -0.009656521311196821
Bond Position:  [-0.62503244]


portfolio before change:  [-1.62759957]
curr_Stock_Price:  103.81471352121677
curr_Factors:  [103.81471352  -1.3856909   -0.95889961]
mat_Sqrt:  [[ 9.95442519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00422652  0.0192585  -0.24919206]
Stock Position:  0.004226523767516071
Bond Position:  [-2.06637492]


portfolio before change:  [-1.62809127]
curr_Stock_Price:  103.75949226256652
curr_Factors:  [103.75949226  -1.39658668  -0.9227097 ]
mat_Sqrt:  [[10.20399454  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08822096 -0.03289714 -2.96022326]
Stock Position:  -0.08822096090932041
Bond Position:  [7.52567084]


portfolio before change:  [-1.63510896]
curr_Stock_Price:  103.84970276993575
curr_Factors:  [103.84970277  -1.27281733  -0.93978817]
mat_Sqrt:  [[11.36273547  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01271997  0.03426016 -0.11427586]
Stock Position:  -0.01271996978863865
Bond Position:  [-0.31414388]


portfolio before change:  [-1.63331332]
curr_Stock_Price:  103.70544771226848
curr_Factors:  [103.70544771  -1.10774775  -0.94884923]
mat_Sqrt:  [[13.26272763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149005 -0.00418876  0.32313195]
Stock Position:  -0.0014900522288189345
Bond Position:  [-1.47878678]


portfolio before change:  [-1.63229607]
curr_Stock_Price:  102.89869370599423
curr_Factors:  [102.89869371  -1.41960514  -0.9200888 ]
mat_Sqrt:  [[ 9.91502225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00177947 0.01219359 0.04913302]
Stock Position:  0.0017794748670249552
Bond Position:  [-1.81540171]


portfolio before change:  [-1.63239647]
curr_Stock_Price:  102.96980494451863
curr_Factors:  [102.96980494  -1.39680388  -0.93101734]
mat_Sqrt:  [[10.04037606  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01590423 -0.00100275 -0.40469266]
Stock Position:  -0.015904232994817993
Bond Position:  [0.0052593]


portfolio before change:  [-1.63462865]
curr_Stock_Price:  103.11019749356626
curr_Factors:  [103.11019749  -1.39830362  -0.9426484 ]
mat_Sqrt:  [[ 9.9229105   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00619695 -0.00960811  0.08342594]
Stock Position:  -0.006196951005715977
Bond Position:  [-0.9956598]


portfolio before change:  [-1.63466587]
curr_Stock_Price:  103.09612006845998
curr_Factors:  [103.09612007  -1.30366864  -0.93555021]
mat_Sqrt:  [[10.98403553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01732913 -0.0540385  -0.2280493 ]
Stock Position:  0.01732913144161131
Bond Position:  [-3.42123209]


portfolio before change:  [-1.61923394]
curr_Stock_Price:  104.01131995676627
curr_Factors:  [104.01131996  -1.14688667  -0.93976296]
mat_Sqrt:  [[12.90803666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00079115 0.05015255 0.22915595]
Stock Position:  0.000791146210519751
Bond Position:  [-1.7015221]


portfolio before change:  [-1.62030998]
curr_Stock_Price:  102.92006623202651
curr_Factors:  [102.92006623  -0.99966096  -0.91562738]
mat_Sqrt:  [[15.16005934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.19872919e-04  3.35045944e-03 -1.28788334e-01]
Stock Position:  0.00011987291902182413
Bond Position:  [-1.63264731]


portfolio before change:  [-1.62049757]
curr_Stock_Price:  103.05771984234201
curr_Factors:  [103.05771984  -1.23711414  -0.90522267]
mat_Sqrt:  [[12.09693852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00589246  0.0205061  -0.01209511]
Stock Position:  -0.00589246309278028
Bond Position:  [-1.01323376]


portfolio before change:  [-1.62696167]
curr_Stock_Price:  104.13323585393525
curr_Factors:  [104.13323585  -1.38761049  -0.88926039]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.62696167]
Stock Price:  102.84861906043415
PL:  [-4.47558073]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.66602793e-01  1.15446919e-01  1.82183775e-01]
 [-1.53859449e-02 -1.44211216e-02 -7.51477395e-02]
 [ 3.27184851e-01 -3.34870407e-01 -6.22916242e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-9.47332277e-01 -2.57615370e-01 -1.02096107e-01]
 [-5.84954720e-02  4.31527658e-02  7.23227252e-02]
 [ 1.64808350e-02  1.20075736e-01  4.40431017e-02]
 [ 3.46689397e-01 -2.55735443e-02 -8.78822404e-02]
 [-5.39421929e-01 -2.94197104e-02 -6.94183412e-02]
 [ 2.92748403e-02  1.34970710e-02 -2.69777328e-02]
 [-2.87308911e-03 -2.27871745e-01  8.58026840e-02]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 2.09954215e-01 -1.60299901e-01  1.77219602e-01]
 [ 6.53068447e-02  1.28101766e-01  8.32693086e-02]
 [ 8.50603437e-02 -1.12871253e-01 -5.72592098e-02]
 [-3.65539774e-02  4.39830459e-02  4.41982067e-02]
 [-4.68176959e-01 -2.50440566e-01  1.26103987e-01]
 [-1.34898600e-01  1.78767362e-02 -1.40383516e-02]
 [ 2.67180683e-01  1.12619346e+00  3.96172257e-01]
 [-5.32639744e-04  2.16039933e-02  2.90383040e-02]
 [-1.52052248e-02 -1.10465343e-01  8.32515580e-03]
 [-1.50728970e-02  5.13092191e-02 -1.97967939e-02]
 [ 7.04648979e-02 -3.45574847e-02  9.23979201e-02]
 [ 5.28645307e-02  1.20346025e-01  6.80420959e-02]
 [-5.77911422e-02 -1.67267385e-01 -3.68851277e-03]
 [ 2.04563886e-02  6.17668999e-02 -1.48340532e-02]
 [-1.84149117e-02  5.62124495e-03 -5.04744988e-02]
 [ 9.35564684e-04  4.40133106e-02 -6.40316372e-02]
 [-5.78563541e-01  2.60496180e-02 -7.99444285e-01]
 [-1.50487154e-01  1.83870349e-03 -3.89095612e-03]
 [-8.85452012e-02  8.32880158e-02  1.92124272e-01]
 [ 1.16910337e-02  4.17279332e-02  1.52565897e-02]
 [-1.14668878e-01 -3.47429632e-03 -1.50995217e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 2.14846435e-01 -1.68138600e-01 -7.22569793e-02]
 [ 8.06780215e-03  3.05971563e-02  6.85441223e-02]
 [ 2.28087618e-02  1.00075382e-02 -2.12696392e-02]
 [-8.98745631e-02  7.87494585e-03 -2.03151145e-04]
 [ 2.26626125e-03 -2.85067250e-01  1.02573046e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.79352549]
curr_Stock_Price:  99.556751857164
curr_Factors:  [99.55675186 -1.01920734 -1.00892591]
mat_Sqrt:  [[13.09976912  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00965161  0.03650752  0.5197196 ]
Stock Position:  -0.009651609707665673
Bond Position:  [0.16735742]


portfolio before change:  [-0.80969432]
curr_Stock_Price:  101.23416665238125
curr_Factors:  [101.23416665  -1.27919784  -1.04241272]
mat_Sqrt:  [[ 9.93263452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313087 -0.00456036 -0.21437558]
Stock Position:  -0.0031308677130187177
Bond Position:  [-0.49274354]


portfolio before change:  [-0.81262033]
curr_Stock_Price:  102.14906082839397
curr_Factors:  [102.14906083  -0.98341777  -1.04443204]
mat_Sqrt:  [[13.44467773  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0142351  -0.10589532 -1.77700665]
Stock Position:  0.01423509678181707
Bond Position:  [-2.2667221]


portfolio before change:  [-0.80695824]
curr_Stock_Price:  102.56672224770323
curr_Factors:  [102.56672225  -0.91079119  -1.04496589]
mat_Sqrt:  [[14.50881591  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135801 -0.00659539  0.21422481]
Stock Position:  0.0013580056444272694
Bond Position:  [-0.94624443]


portfolio before change:  [-0.80671345]
curr_Stock_Price:  102.83408077857133
curr_Factors:  [102.83408078  -0.79147773  -1.03222147]
mat_Sqrt:  [[16.60024779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05872347 -0.08146513 -0.29125178]
Stock Position:  -0.05872347027703209
Bond Position:  [5.23206063]


portfolio before change:  [-0.77647298]
curr_Stock_Price:  102.33025446641163
curr_Factors:  [102.33025447  -1.08249106  -0.99057775]
mat_Sqrt:  [[12.87305754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331067  0.0136461   0.2063166 ]
Stock Position:  -0.0033106709751468642
Bond Position:  [-0.43769117]


portfolio before change:  [-0.77415955]
curr_Stock_Price:  101.61495028424055
curr_Factors:  [101.61495028  -0.99134569  -0.98447613]
mat_Sqrt:  [[14.08864072  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00202798 0.03797128 0.12564271]
Stock Position:  0.002027976879977689
Bond Position:  [-0.98023232]


portfolio before change:  [-0.77381673]
curr_Stock_Price:  101.84442196717015
curr_Factors:  [101.84442197  -1.23424217  -0.99845493]
mat_Sqrt:  [[10.92167413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03004028 -0.00808706 -0.25070357]
Stock Position:  0.03004028498400277
Bond Position:  [-3.83325219]


portfolio before change:  [-0.77054187]
curr_Stock_Price:  101.96938882532149
curr_Factors:  [101.96938883  -1.21896268  -1.05154545]
mat_Sqrt:  [[10.52932822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05264833 -0.00930333 -0.19803121]
Stock Position:  -0.0526483258033349
Bond Position:  [4.59797573]


portfolio before change:  [-0.72394298]
curr_Stock_Price:  101.09520891693658
curr_Factors:  [101.09520892  -1.24104266  -1.04966671]
mat_Sqrt:  [[10.23029449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235736  0.00426815 -0.07695996]
Stock Position:  0.002357363859273184
Bond Position:  [-0.96226117]


portfolio before change:  [-0.72514227]
curr_Stock_Price:  100.63749488241405
curr_Factors:  [100.63749488  -1.21262724  -1.07334346]
mat_Sqrt:  [[10.23234928  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085588 -0.07205937  0.24477117]
Stock Position:  0.0008558823611420407
Bond Position:  [-0.81127613]


portfolio before change:  [-0.72528578]
curr_Stock_Price:  100.58831315065797
curr_Factors:  [100.58831315  -1.24441245  -1.07760025]
mat_Sqrt:  [[ 9.86529831  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00731104  0.00225658  0.15019092]
Stock Position:  -0.007311042841100775
Bond Position:  [0.01011969]


portfolio before change:  [-0.71930731]
curr_Stock_Price:  99.77075531083216
curr_Factors:  [99.77075531 -1.29945299 -1.02387356]
mat_Sqrt:  [[ 9.77226783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02476294 -0.05069128  0.50555819]
Stock Position:  0.024762940727542645
Bond Position:  [-3.18992461]


portfolio before change:  [-0.69538489]
curr_Stock_Price:  100.75291611373518
curr_Factors:  [100.75291611  -1.32405531  -1.01309476]
mat_Sqrt:  [[ 9.73298923  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00879603 0.04050934 0.23754416]
Stock Position:  0.008796033000345644
Bond Position:  [-1.58161087]


portfolio before change:  [-0.69486303]
curr_Stock_Price:  100.8347228995271
curr_Factors:  [100.8347229   -1.17525817  -1.03708643]
mat_Sqrt:  [[11.03572976  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00638454 -0.03569302 -0.16334459]
Stock Position:  0.006384537749311342
Bond Position:  [-1.33864612]


portfolio before change:  [-0.69094017]
curr_Stock_Price:  101.47536488201054
curr_Factors:  [101.47536488  -1.05374005  -1.02655055]
mat_Sqrt:  [[12.67365543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208278  0.01390866  0.12608518]
Stock Position:  -0.0020827786474377423
Bond Position:  [-0.47958944]


portfolio before change:  [-0.68996191]
curr_Stock_Price:  100.97688937236688
curr_Factors:  [100.97688937  -1.00569321  -1.01392631]
mat_Sqrt:  [[13.4002337   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0334996  -0.07919626  0.35973957]
Stock Position:  -0.033499597718884576
Bond Position:  [2.69272327]


portfolio before change:  [-0.67828216]
curr_Stock_Price:  100.63828433100063
curr_Factors:  [100.63828433  -0.98551098  -1.00098767]
mat_Sqrt:  [[13.80504499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00994583  0.00565312 -0.04004751]
Stock Position:  -0.009945827147036202
Bond Position:  [0.32264882]


portfolio before change:  [-0.68540961]
curr_Stock_Price:  101.35896656479835
curr_Factors:  [101.35896656  -0.99591145  -0.99789999]
mat_Sqrt:  [[13.80259887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02732291 0.35613364 1.13016917]
Stock Position:  0.02732291213922172
Bond Position:  [-3.45483175]


portfolio before change:  [-0.67085147]
curr_Stock_Price:  101.90759127091911
curr_Factors:  [101.90759127  -1.31706716  -1.01294033]
mat_Sqrt:  [[ 9.915101    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00060036 0.00683178 0.0828382 ]
Stock Position:  0.0006003561574629667
Bond Position:  [-0.73203232]


portfolio before change:  [-0.67077773]
curr_Stock_Price:  102.18284183500285
curr_Factors:  [102.18284184  -1.5464106   -1.00148921]
mat_Sqrt:  [[ 7.99538072  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204594 -0.03493221  0.02374935]
Stock Position:  -0.00204593913918212
Bond Position:  [-0.46171785]


portfolio before change:  [-0.66977847]
curr_Stock_Price:  101.66621894256834
curr_Factors:  [101.66621894  -1.46119775  -0.99553132]
mat_Sqrt:  [[ 8.71430575  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204137  0.0162254  -0.05647474]
Stock Position:  -0.002041367696871265
Bond Position:  [-0.46224033]


portfolio before change:  [-0.66976686]
curr_Stock_Price:  101.63222718000202
curr_Factors:  [101.63222718  -1.19382242  -0.98196423]
mat_Sqrt:  [[11.53717039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00766507 -0.01092804  0.26358555]
Stock Position:  0.00766507479375544
Bond Position:  [-1.44878548]


portfolio before change:  [-0.67674801]
curr_Stock_Price:  100.74508165014966
curr_Factors:  [100.74508165  -1.3829166   -1.00572759]
mat_Sqrt:  [[ 9.24376425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00755762 0.03805675 0.19410516]
Stock Position:  0.007557623113400882
Bond Position:  [-1.43814136]


portfolio before change:  [-0.67790318]
curr_Stock_Price:  100.61602036454757
curr_Factors:  [100.61602036  -1.09369539  -1.00318823]
mat_Sqrt:  [[12.35953557  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508618 -0.05289459 -0.0105223 ]
Stock Position:  -0.005086184809227169
Bond Position:  [-0.16615151]


portfolio before change:  [-0.68178728]
curr_Stock_Price:  101.37559337898203
curr_Factors:  [101.37559338  -1.34627597  -0.9954113 ]
mat_Sqrt:  [[ 9.74880873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00195134  0.01953241 -0.04231742]
Stock Position:  0.001951337355564247
Bond Position:  [-0.87960526]


portfolio before change:  [-0.68186681]
curr_Stock_Price:  101.39118653299556
curr_Factors:  [101.39118653  -1.16201658  -1.01589222]
mat_Sqrt:  [[11.48540807  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248775  0.00177759 -0.1439897 ]
Stock Position:  -0.0024877510214793086
Bond Position:  [-0.42963078]


portfolio before change:  [-0.68194728]
curr_Stock_Price:  101.40194222958715
curr_Factors:  [101.40194223  -1.39640207  -1.02322867]
mat_Sqrt:  [[ 9.02015485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121932  0.01391823 -0.18266444]
Stock Position:  -0.001219316067864814
Bond Position:  [-0.55830626]


portfolio before change:  [-0.68144561]
curr_Stock_Price:  100.93327293841762
curr_Factors:  [100.93327294  -1.61011675  -0.97736916]
mat_Sqrt:  [[ 7.59107887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0976247   0.00823761 -2.28059202]
Stock Position:  -0.09762470340626522
Bond Position:  [9.17213522]


portfolio before change:  [-0.66090465]
curr_Stock_Price:  100.73461033727608
curr_Factors:  [100.73461034  -1.79106679  -0.9609753 ]
mat_Sqrt:  [[ 6.42661102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02353245  0.00058145 -0.01109981]
Stock Position:  -0.023532452189037906
Bond Position:  [1.70962776]


portfolio before change:  [-0.66847971]
curr_Stock_Price:  101.06559092356699
curr_Factors:  [101.06559092  -1.46662825  -0.94331572]
mat_Sqrt:  [[ 9.07774445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00519705  0.02633798  0.54807707]
Stock Position:  -0.0051970521184927
Bond Position:  [-0.14323657]


portfolio before change:  [-0.66838642]
curr_Stock_Price:  101.0441951111601
curr_Factors:  [101.04419511  -1.3640671   -0.94400464]
mat_Sqrt:  [[10.04913202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0015805  0.01319553 0.0435228 ]
Stock Position:  0.0015805029327887025
Bond Position:  [-0.82808707]


portfolio before change:  [-0.67067729]
curr_Stock_Price:  99.66023683466659
curr_Factors:  [99.66023683 -1.23254133 -0.94738484]
mat_Sqrt:  [[11.26657756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01292144 -0.00109867 -0.43074732]
Stock Position:  -0.012921435310302428
Bond Position:  [0.61707601]


portfolio before change:  [-0.67774495]
curr_Stock_Price:  100.21317856688577
curr_Factors:  [100.21317857  -1.39032928  -0.93762618]
mat_Sqrt:  [[ 9.7702714   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00536461  0.0049611   0.16678008]
Stock Position:  -0.005364610807965039
Bond Position:  [-0.14014025]


portfolio before change:  [-0.67964177]
curr_Stock_Price:  100.56349177509702
curr_Factors:  [100.56349178  -1.25150666  -0.9563319 ]
mat_Sqrt:  [[11.0557508   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01770623 -0.05317009 -0.20612905]
Stock Position:  0.01770623494322195
Bond Position:  [-2.46024258]


portfolio before change:  [-0.68944338]
curr_Stock_Price:  100.0272930381548
curr_Factors:  [100.02729304  -1.1969468   -0.94294147]
mat_Sqrt:  [[11.7700104   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00194132 0.00967567 0.1955373 ]
Stock Position:  0.001941317546012735
Bond Position:  [-0.88362812]


portfolio before change:  [-0.69142188]
curr_Stock_Price:  99.06503773168335
curr_Factors:  [99.06503773 -0.86916076 -0.95044849]
mat_Sqrt:  [[16.05736036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00116616  0.00316466 -0.06067636]
Stock Position:  0.0011661635530936668
Bond Position:  [-0.80694792]


portfolio before change:  [-0.69079637]
curr_Stock_Price:  99.6879234318026
curr_Factors:  [99.68792343 -0.70614041 -0.96833869]
mat_Sqrt:  [[18.68209241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00480207  0.00249028 -0.00057953]
Stock Position:  -0.004802069219752315
Bond Position:  [-0.21208806]


portfolio before change:  [-0.68892382]
curr_Stock_Price:  99.29245709123714
curr_Factors:  [99.29245709 -1.15690328 -0.96661475]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.68892382]
Stock Price:  99.05206510290436
PL:  [-0.68892382]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-8.25429684e-02 -1.27750832e-02 -5.19241681e-03]
 [-2.13240668e-02 -5.01678364e-03 -5.83867138e-02]
 [ 2.63953300e-01  2.95584217e-01  4.12433472e-01]
 [-1.29354586e-02  2.11404451e-02  1.15044036e-01]
 [-1.08008416e+00 -3.19095423e-01  2.62591080e-02]
 [-4.67327584e-02 -1.47279689e-02  9.40289289e-03]
 [ 3.32758502e-02  2.34662511e-02 -2.01974752e-02]
 [ 3.51591949e-01 -1.83973766e-03 -9.21036954e-02]
 [-4.27285984e-01 -2.17301132e-02 -5.19072921e-02]
 [ 5.45682751e-02 -2.94737553e-02 -4.71136059e-02]
 [ 4.56845172e-02 -3.25696412e-01  8.03261362e-02]
 [-5.93680284e-02  4.06997471e-03  3.97653424e-02]
 [ 1.98174273e-01 -1.51793926e-01  1.83545098e-01]
 [ 8.29785759e-02  7.69705887e-02  3.75922733e-02]
 [ 5.41477340e-02 -1.07483430e-01 -5.93382466e-02]
 [-4.70976617e-02  7.02265602e-02  4.82738869e-02]
 [-5.35443919e-01 -2.86370278e-01  1.55434536e-01]
 [-1.23724328e-01  1.86026794e-02 -2.33416899e-02]
 [ 3.60549714e-01  1.38683098e+00  6.07669223e-01]
 [ 1.04310218e-02  1.06387968e-02  3.06714991e-02]
 [-6.03922463e-02 -1.12189293e-01 -4.20186436e-02]
 [-1.12902771e-02  4.27871393e-02 -1.20378588e-02]
 [ 6.32397641e-02 -3.21471233e-02  8.57901410e-02]
 [ 7.52456286e-02  6.91739661e-02  7.06954293e-03]
 [-5.53864798e-02 -1.61520285e-01  9.97886529e-02]
 [ 3.37608221e-02  5.27745781e-02 -1.42535093e-02]
 [-5.29942357e-02  3.15387704e-02 -3.30963236e-02]
 [ 3.65833222e-04  4.28111431e-02 -6.44414676e-02]
 [-6.48081864e-01 -4.61448282e-02 -9.68239918e-01]
 [-2.14234706e-01  3.78741438e-02  1.14727812e-02]
 [-8.21226101e-02  9.22209037e-02  2.15433251e-01]
 [ 1.32849614e-02  5.46021979e-02  9.00575540e-03]
 [-1.36655307e-01 -1.59999648e-02 -1.36472616e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 2.24871015e-01 -1.71379179e-01 -7.10711446e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-9.01733069e-03 -1.34637495e-02 -4.31606709e-02]
 [-7.67297910e-02  4.90973168e-02 -3.36025794e-03]
 [-4.36455184e-02 -2.82300477e-01  1.38666930e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.02397593]
curr_Stock_Price:  100.64596406241853
curr_Factors:  [100.64596406  -1.12960265  -1.0130477 ]
mat_Sqrt:  [[11.8101425   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00710683 -0.00403984 -0.01481252]
Stock Position:  -0.0071068335761968245
Bond Position:  [7.73925004]


portfolio before change:  [7.02110246]
curr_Stock_Price:  101.18642042153495
curr_Factors:  [101.18642042  -1.05940257  -1.01114118]
mat_Sqrt:  [[12.7613467   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261506 -0.00158645 -0.16656104]
Stock Position:  -0.0026150639442618687
Bond Position:  [7.28571142]


portfolio before change:  [7.0266615]
curr_Stock_Price:  99.40892210046583
curr_Factors:  [99.4089221  -0.8588363  -0.97931337]
mat_Sqrt:  [[15.81710887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02249291 0.09347194 1.1765579 ]
Stock Position:  0.02249291477384868
Bond Position:  [4.79066509]


portfolio before change:  [7.04419486]
curr_Stock_Price:  100.16180288077247
curr_Factors:  [100.16180288  -0.91053299  -0.99569457]
mat_Sqrt:  [[14.88805699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00074514 0.0066852  0.32818861]
Stock Position:  0.0007451375807285555
Bond Position:  [6.96956053]


portfolio before change:  [7.0454515]
curr_Stock_Price:  100.6790092525785
curr_Factors:  [100.67900925  -1.33887967  -0.96414712]
mat_Sqrt:  [[10.06345497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10761344 -0.10090683  0.07490993]
Stock Position:  -0.10761344448016937
Bond Position:  [17.87986647]


portfolio before change:  [7.05368577]
curr_Stock_Price:  100.623262016747
curr_Factors:  [100.62326202  -1.3414402   -0.93526591]
mat_Sqrt:  [[10.32612771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00437663 -0.00465739  0.02682384]
Stock Position:  -0.004376633405226584
Bond Position:  [7.4940769]


portfolio before change:  [7.05702398]
curr_Stock_Price:  100.07457703441204
curr_Factors:  [100.07457703  -1.16479721  -0.96479731]
mat_Sqrt:  [[11.89741513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0025013   0.00742068 -0.05761777]
Stock Position:  0.002501295747435291
Bond Position:  [6.80670787]


portfolio before change:  [7.05977552]
curr_Stock_Price:  100.83444081412587
curr_Factors:  [100.83444081  -1.27855266  -0.9567167 ]
mat_Sqrt:  [[10.78558594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03085079 -0.00058178 -0.26274621]
Stock Position:  0.03085079113186874
Bond Position:  [3.94895325]


portfolio before change:  [7.03882516]
curr_Stock_Price:  100.13935305396416
curr_Factors:  [100.13935305  -0.86954041  -0.96101664]
mat_Sqrt:  [[16.05476504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02730919 -0.00687167 -0.14807706]
Stock Position:  -0.027309187224431347
Bond Position:  [9.7735495]


portfolio before change:  [7.04702011]
curr_Stock_Price:  99.88401105681305
curr_Factors:  [99.88401106 -0.83045865 -0.94353443]
mat_Sqrt:  [[16.94574107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00260775 -0.00932042 -0.134402  ]
Stock Position:  0.0026077491246997617
Bond Position:  [6.78654767]


portfolio before change:  [7.04770852]
curr_Stock_Price:  99.82266908880123
curr_Factors:  [99.82266909 -0.69402275 -0.96386737]
mat_Sqrt:  [[19.02026863  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00282181 -0.10299425  0.22914811]
Stock Position:  0.0028218095597296526
Bond Position:  [6.76602796]


portfolio before change:  [7.05024617]
curr_Stock_Price:  100.4222287686872
curr_Factors:  [100.42222877  -0.74455734  -0.98780594]
mat_Sqrt:  [[17.7612712   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287963  0.00128704  0.11343945]
Stock Position:  -0.0028796292226377406
Bond Position:  [7.33942495]


portfolio before change:  [7.05337773]
curr_Stock_Price:  99.65335374865961
curr_Factors:  [99.65335375 -1.00069455 -0.98190678]
mat_Sqrt:  [[13.72331714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0168852  -0.04800145  0.52360307]
Stock Position:  0.016885200204963088
Bond Position:  [5.3707109]


portfolio before change:  [7.06685397]
curr_Stock_Price:  100.4117020197395
curr_Factors:  [100.41170202  -0.80967306  -0.99356115]
mat_Sqrt:  [[16.54434819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00559946 0.02434024 0.10724029]
Stock Position:  0.005599461374199437
Bond Position:  [6.50460253]


portfolio before change:  [7.0662133]
curr_Stock_Price:  100.1520697993074
curr_Factors:  [100.1520698   -0.92126803  -0.97776798]
mat_Sqrt:  [[14.99405389  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00261838 -0.03398925 -0.1692755 ]
Stock Position:  0.0026183816041369656
Bond Position:  [6.80397696]


portfolio before change:  [7.06782111]
curr_Stock_Price:  100.44127824735791
curr_Factors:  [100.44127825  -1.36455462  -0.9792297 ]
mat_Sqrt:  [[ 9.6387259   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367585  0.02220759  0.13771196]
Stock Position:  -0.003675854488361428
Bond Position:  [7.43702863]


portfolio before change:  [7.06934889]
curr_Stock_Price:  100.27856752288282
curr_Factors:  [100.27856752  -1.58153551  -0.97608636]
mat_Sqrt:  [[ 7.77046586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06577598 -0.09055823  0.44341147]
Stock Position:  -0.06577598245593644
Bond Position:  [13.66527019]


portfolio before change:  [7.07151879]
curr_Stock_Price:  100.27154930904146
curr_Factors:  [100.27154931  -1.60922435  -0.975074  ]
mat_Sqrt:  [[ 7.56538808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0169203   0.00588268 -0.06658734]
Stock Position:  -0.016920296816143172
Bond Position:  [8.76814317]


portfolio before change:  [7.07280716]
curr_Stock_Price:  100.26018502088912
curr_Factors:  [100.26018502  -1.41838194  -0.96499673]
mat_Sqrt:  [[ 9.24783979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05627233 0.43855446 1.73351115]
Stock Position:  0.05627233047576045
Bond Position:  [1.4309329]


portfolio before change:  [7.10192756]
curr_Stock_Price:  100.77449679289052
curr_Factors:  [100.77449679  -1.57357112  -0.93838873]
mat_Sqrt:  [[ 8.17373094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00207574 0.00336428 0.08749725]
Stock Position:  0.0020757360412894227
Bond Position:  [6.89274631]


portfolio before change:  [7.10300738]
curr_Stock_Price:  100.87960257412887
curr_Factors:  [100.87960257  -1.45948775  -0.89017829]
mat_Sqrt:  [[ 9.62401668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00746736 -0.03547737 -0.11986749]
Stock Position:  -0.007467358328427878
Bond Position:  [7.85631152]


portfolio before change:  [7.10485616]
curr_Stock_Price:  100.7635401446304
curr_Factors:  [100.76354014  -1.25099424  -0.8938168 ]
mat_Sqrt:  [[11.79841909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00107156  0.01353048 -0.03434066]
Stock Position:  -0.0010715618272142274
Bond Position:  [7.21283053]


portfolio before change:  [7.10468161]
curr_Stock_Price:  101.76788370745146
curr_Factors:  [101.76788371  -1.53777732  -0.92102137]
mat_Sqrt:  [[ 8.7049853   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00918113 -0.01016581  0.24473539]
Stock Position:  0.009181126143108466
Bond Position:  [6.17033783]


portfolio before change:  [7.10330698]
curr_Stock_Price:  101.53414664837683
curr_Factors:  [101.53414665  -1.50494085  -0.93684201]
mat_Sqrt:  [[ 8.83403879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00888323 0.02187473 0.02016744]
Stock Position:  0.008883225327151915
Bond Position:  [6.20135627]


portfolio before change:  [7.10453532]
curr_Stock_Price:  101.5851558459545
curr_Factors:  [101.58515585  -1.4368707   -0.90321199]
mat_Sqrt:  [[ 9.784649    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00400501 -0.0510772   0.28466925]
Stock Position:  -0.004005012557554221
Bond Position:  [7.51138515]


portfolio before change:  [7.10721195]
curr_Stock_Price:  101.1512882809021
curr_Factors:  [101.15128828  -1.37355933  -0.90109057]
mat_Sqrt:  [[10.40168068  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.003097    0.01668879 -0.04066129]
Stock Position:  0.0030969966712735783
Bond Position:  [6.79394675]


portfolio before change:  [7.10838255]
curr_Stock_Price:  101.255035871857
curr_Factors:  [101.25503587  -1.45879921  -0.92357519]
mat_Sqrt:  [[ 9.34898746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00630396  0.00997343 -0.0944146 ]
Stock Position:  -0.006303962560069454
Bond Position:  [7.74669051]


portfolio before change:  [7.11090098]
curr_Stock_Price:  101.00915426590562
curr_Factors:  [101.00915427  -1.19049868  -0.94968337]
mat_Sqrt:  [[11.88205283  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098323  0.01353807 -0.18383357]
Stock Position:  -0.000983234756017136
Bond Position:  [7.21021669]


portfolio before change:  [7.11166049]
curr_Stock_Price:  101.15339302943639
curr_Factors:  [101.15339303  -1.06298653  -0.95101634]
mat_Sqrt:  [[13.49926499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06273782 -0.01459228 -2.76211898]
Stock Position:  -0.0627378204661017
Bond Position:  [13.4578039]


portfolio before change:  [7.08299253]
curr_Stock_Price:  101.6371569552535
curr_Factors:  [101.63715696  -1.15187827  -0.95640656]
mat_Sqrt:  [[12.34343514  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01708721  0.01197686  0.03272865]
Stock Position:  -0.01708721484425511
Bond Position:  [8.81968846]


portfolio before change:  [7.10251199]
curr_Stock_Price:  100.5593371930617
curr_Factors:  [100.55933719  -1.0288946   -0.98145107]
mat_Sqrt:  [[13.46915556  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00265543  0.02916281  0.6145711 ]
Stock Position:  -0.0026554261927525676
Bond Position:  [7.36953989]


portfolio before change:  [7.10403465]
curr_Stock_Price:  100.33285462915973
curr_Factors:  [100.33285463  -0.99413331  -1.00744832]
mat_Sqrt:  [[13.557116    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00121951 0.01726673 0.02569091]
Stock Position:  0.0012195127772117835
Bond Position:  [6.98167745]


portfolio before change:  [7.10480753]
curr_Stock_Price:  100.2509459221947
curr_Factors:  [100.25094592  -0.68505021  -1.00890618]
mat_Sqrt:  [[18.42521503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00895109 -0.00505963 -0.38931839]
Stock Position:  -0.008951091190442297
Bond Position:  [8.00216289]


portfolio before change:  [7.10951537]
curr_Stock_Price:  99.83674959092933
curr_Factors:  [99.83674959 -0.81345958 -1.01236745]
mat_Sqrt:  [[16.08213975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325912  0.0049611   0.16678008]
Stock Position:  -0.003259124991004756
Bond Position:  [7.43489581]


portfolio before change:  [7.10625508]
curr_Stock_Price:  101.12228166426357
curr_Factors:  [101.12228166  -0.97835439  -1.00739624]
mat_Sqrt:  [[13.88181712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01483514 -0.05419486 -0.20274619]
Stock Position:  0.014835139033633005
Bond Position:  [5.60609197]


portfolio before change:  [7.09923177]
curr_Stock_Price:  100.60161840493193
curr_Factors:  [100.6016184   -1.01638643  -1.00616829]
mat_Sqrt:  [[13.3113044   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00184143 0.00777784 0.21633947]
Stock Position:  0.001841433634895189
Bond Position:  [6.91398057]


portfolio before change:  [7.09994254]
curr_Stock_Price:  100.51824141866639
curr_Factors:  [100.51824142  -0.88943082  -1.02732382]
mat_Sqrt:  [[14.78457748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00122933 -0.00425761 -0.12312538]
Stock Position:  -0.0012293282171526167
Bond Position:  [7.22351245]


portfolio before change:  [7.09983681]
curr_Stock_Price:  101.33878834346395
curr_Factors:  [101.33878834  -0.76442045  -1.04336868]
mat_Sqrt:  [[16.62121875  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00458137  0.01552593 -0.00958588]
Stock Position:  -0.004581373641492498
Bond Position:  [7.56410767]


portfolio before change:  [7.10209654]
curr_Stock_Price:  101.05194220826758
curr_Factors:  [101.05194221  -0.77120539  -1.03281624]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.10209654]
Stock Price:  99.77135835991382
PL:  [7.10209654]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.08166922e-02 -4.20328243e-03  1.12745007e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.24578249e-01  3.19799251e-01  4.74717548e-01]
 [-1.67933238e-02  3.12033217e-02  1.22531990e-01]
 [-6.18872677e-01 -1.88451875e-01  3.75299319e-02]
 [-4.96135762e-02 -9.20211851e-03  1.77829138e-02]
 [ 1.91056691e-02  1.08714239e-01  3.63095406e-02]
 [ 2.29089578e-01 -1.10670264e-01 -3.50738147e-02]
 [-4.90258285e-01 -2.70848800e-02 -5.73767027e-02]
 [ 4.29857087e-02 -9.79622037e-03 -3.78928303e-02]
 [ 2.21551968e-02 -2.98505080e-01  1.25914998e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.66630993e-01 -9.58498953e-02  2.40250531e-01]
 [ 8.40807895e-02  1.17554193e-02 -3.17212961e-02]
 [ 7.47228772e-02 -1.10140139e-01 -6.48919683e-02]
 [-5.01126282e-02  7.77308930e-02  4.94393276e-02]
 [-4.92323134e-01 -2.60908313e-01  1.36372605e-01]
 [-1.25739876e-01  1.84717381e-02 -2.16636097e-02]
 [ 2.50634332e-01  1.09735099e+00  3.49093967e-01]
 [ 1.09907302e-02  1.00790101e-02  3.07548757e-02]
 [-5.55774504e-02 -5.42219439e-02 -2.09895008e-02]
 [-2.48002219e-02  4.74848842e-02 -1.87372284e-02]
 [ 4.04360277e-02 -3.38214204e-02  5.72491863e-02]
 [ 7.24313681e-02  1.35490506e-01  3.50698976e-02]
 [-5.88647600e-02 -1.73456501e-01  2.55474518e-02]
 [ 1.97431488e-02  6.19779844e-02 -1.52501739e-02]
 [ 1.90476378e-02 -7.01170682e-02  2.35701778e-03]
 [ 1.83219744e-02  4.39477754e-02 -8.13962235e-02]
 [-6.43680011e-01 -8.91655326e-02 -1.00440999e+00]
 [-2.29502852e-01  4.73706165e-02  1.65280551e-02]
 [-3.75351442e-03  3.87590860e-02  1.32956079e-01]
 [ 1.48628918e-02  5.65625461e-02  8.36582473e-03]
 [-1.35885227e-01 -1.67146140e-02 -1.31123207e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 1.51267825e-01 -1.16350820e-01 -2.75174849e-02]
 [ 3.11815054e-03  1.39772510e-02  7.37055836e-02]
 [ 1.30847053e-02  5.56957672e-03 -2.98285171e-02]
 [-9.17173916e-02  2.35229103e-03  2.89793262e-04]
 [-1.39455487e-02 -2.80923271e-01  1.09593156e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.53826209]
curr_Stock_Price:  100.57828957010477
curr_Factors:  [100.57828957  -1.03916066  -1.04766009]
mat_Sqrt:  [[12.47985406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00710135 -0.00132919  0.03216301]
Stock Position:  -0.007101350886519883
Bond Position:  [7.25250382]


portfolio before change:  [6.5425758]
curr_Stock_Price:  100.09850882264796
curr_Factors:  [100.09850882  -0.8812894   -1.05259684]
mat_Sqrt:  [[14.47276419  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313562  0.01411938  0.0859571 ]
Stock Position:  -0.003135616820373534
Bond Position:  [6.85644637]


portfolio before change:  [6.54810495]
curr_Stock_Price:  98.60851927386989
curr_Factors:  [98.60851927 -0.83966743 -1.03451233]
mat_Sqrt:  [[15.13451517  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02178707 0.1011294  1.35423703]
Stock Position:  0.02178707016116259
Bond Position:  [4.39971422]


portfolio before change:  [6.57260318]
curr_Stock_Price:  99.70771407919747
curr_Factors:  [99.70771408 -1.11718125 -1.01688197]
mat_Sqrt:  [[11.80094754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00076469 0.00986736 0.34954966]
Stock Position:  0.0007646911572709862
Bond Position:  [6.49635757]


portfolio before change:  [6.57332705]
curr_Stock_Price:  99.59233746528406
curr_Factors:  [99.59233747 -0.98589185 -1.04570444]
mat_Sqrt:  [[13.05914874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04717595 -0.05959372  0.10706245]
Stock Position:  -0.04717594769651443
Bond Position:  [11.27168995]


portfolio before change:  [6.51326972]
curr_Stock_Price:  100.89525506647516
curr_Factors:  [100.89525507  -1.09368221  -1.02835221]
mat_Sqrt:  [[12.08600872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00382436 -0.00290997  0.0507297 ]
Stock Position:  -0.0038243602925375035
Bond Position:  [6.89912953]


portfolio before change:  [6.51200883]
curr_Stock_Price:  101.4504699712093
curr_Factors:  [101.45046997  -0.88283679  -1.04753978]
mat_Sqrt:  [[14.71980892  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00199217 0.03437846 0.10358101]
Stock Position:  0.0019921666631970525
Bond Position:  [6.30990258]


portfolio before change:  [6.51095619]
curr_Stock_Price:  100.52613955438267
curr_Factors:  [100.52613955  -0.59737537  -1.06353907]
mat_Sqrt:  [[19.09646702  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0114719  -0.03499701 -0.10005583]
Stock Position:  0.011471895393232893
Bond Position:  [5.35773084]


portfolio before change:  [6.51706135]
curr_Stock_Price:  100.99994076322388
curr_Factors:  [100.99994076  -0.77322138  -1.0657061 ]
mat_Sqrt:  [[16.0577637   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03130383 -0.00856499 -0.16367976]
Stock Position:  -0.03130383493896567
Bond Position:  [9.67874682]


portfolio before change:  [6.52311176]
curr_Stock_Price:  100.84531133517288
curr_Factors:  [100.84531134  -0.80259652  -1.07748154]
mat_Sqrt:  [[15.3867956   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227454 -0.00309784 -0.1080977 ]
Stock Position:  0.0022745431025733677
Bond Position:  [6.29373476]


portfolio before change:  [6.52414127]
curr_Stock_Price:  100.95203174551827
curr_Factors:  [100.95203175  -0.67298442  -1.07147945]
mat_Sqrt:  [[17.64022135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227606 -0.09439559  0.35920044]
Stock Position:  0.002276055351785084
Bond Position:  [6.29436886]


portfolio before change:  [6.52427983]
curr_Stock_Price:  100.66720177935255
curr_Factors:  [100.66720178  -0.95844791  -1.04427664]
mat_Sqrt:  [[13.58675601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00530852  0.00225658  0.15019092]
Stock Position:  -0.005308523871356414
Bond Position:  [7.05867407]


portfolio before change:  [6.52582015]
curr_Stock_Price:  100.54326310108088
curr_Factors:  [100.5432631   -1.1433664   -1.06880399]
mat_Sqrt:  [[11.00574845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01937143 -0.0303104   0.68536789]
Stock Position:  0.01937143073477737
Bond Position:  [4.57815329]


portfolio before change:  [6.52135795]
curr_Stock_Price:  100.28337007309547
curr_Factors:  [100.28337007  -1.20730063  -1.07471327]
mat_Sqrt:  [[10.23676833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00761073  0.00371739 -0.09049203]
Stock Position:  0.0076107252012251325
Bond Position:  [5.75812878]


portfolio before change:  [6.51842181]
curr_Stock_Price:  99.8030013324967
curr_Factors:  [99.80300133 -1.02797481 -1.07654092]
mat_Sqrt:  [[12.16645453  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00481924 -0.03482937 -0.18511872]
Stock Position:  0.004819239109091166
Bond Position:  [6.03744728]


portfolio before change:  [6.52108414]
curr_Stock_Price:  100.1988331091527
curr_Factors:  [100.19883311  -1.14274735  -1.08083319]
mat_Sqrt:  [[10.84361033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00350565  0.02458067  0.14103664]
Stock Position:  -0.003505646508269733
Bond Position:  [6.87234583]


portfolio before change:  [6.51915259]
curr_Stock_Price:  100.9948778993025
curr_Factors:  [100.9948779   -1.18302651  -1.06897515]
mat_Sqrt:  [[10.6234959   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04435666 -0.08250645  0.38903308]
Stock Position:  -0.04435666194340757
Bond Position:  [10.99894825]


portfolio before change:  [6.50477586]
curr_Stock_Price:  101.34999229656623
curr_Factors:  [101.3499923   -0.97998274  -1.07374706]
mat_Sqrt:  [[12.99870834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00997676  0.00584128 -0.06180025]
Stock Position:  -0.009976760806920315
Bond Position:  [7.51592049]


portfolio before change:  [6.50513051]
curr_Stock_Price:  101.40861793833976
curr_Factors:  [101.40861794  -0.83883826  -1.05526994]
mat_Sqrt:  [[15.25717489  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02295486 0.34701285 0.99586792]
Stock Position:  0.022954860466744033
Bond Position:  [4.17730984]


portfolio before change:  [6.51343126]
curr_Stock_Price:  101.74748098596926
curr_Factors:  [101.74748099  -0.76592049  -1.05494365]
mat_Sqrt:  [[16.47147214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00106419 0.00318726 0.0877351 ]
Stock Position:  0.0010641903587542394
Bond Position:  [6.40515257]


portfolio before change:  [6.51382284]
curr_Stock_Price:  101.36303921101744
curr_Factors:  [101.36303921  -0.94626227  -1.04582137]
mat_Sqrt:  [[13.82702313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00443059 -0.01714648 -0.0598772 ]
Stock Position:  -0.004430593505515844
Bond Position:  [6.96292126]


portfolio before change:  [6.51807686]
curr_Stock_Price:  100.59934814445221
curr_Factors:  [100.59934814  -0.98873491  -1.04353093]
mat_Sqrt:  [[13.18236483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207845  0.01501604 -0.0534521 ]
Stock Position:  -0.0020784501492033683
Bond Position:  [6.72716759]


portfolio before change:  [6.51910832]
curr_Stock_Price:  100.50768951903139
curr_Factors:  [100.50768952  -1.14599124  -1.03384699]
mat_Sqrt:  [[11.36338128  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00450999 -0.01069527  0.16331599]
Stock Position:  0.0045099871551271525
Bond Position:  [6.06581993]


portfolio before change:  [6.5220644]
curr_Stock_Price:  100.99500965177292
curr_Factors:  [100.99500965  -1.12713083  -1.0594403 ]
mat_Sqrt:  [[11.34185619  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00732581 0.04284586 0.10004466]
Stock Position:  0.0073258141676554485
Bond Position:  [5.78219373]


portfolio before change:  [6.52215813]
curr_Stock_Price:  100.90913737696309
curr_Factors:  [100.90913738  -0.9770248   -1.08821079]
mat_Sqrt:  [[12.79410981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454338 -0.05485176  0.07287977]
Stock Position:  -0.004543382592641356
Bond Position:  [6.98062695]


portfolio before change:  [6.5211587]
curr_Stock_Price:  101.32117938488689
curr_Factors:  [101.32117938  -0.98084773  -1.09434129]
mat_Sqrt:  [[12.71912094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00143331  0.01959916 -0.0435045 ]
Stock Position:  0.0014333132610351458
Bond Position:  [6.37593371]


portfolio before change:  [6.52131955]
curr_Stock_Price:  100.87731675220854
curr_Factors:  [100.87731675  -0.82747766  -1.06686305]
mat_Sqrt:  [[15.17371095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011677  -0.02217296  0.00672392]
Stock Position:  0.0011677003188563303
Bond Position:  [6.40352507]


portfolio before change:  [6.5226158]
curr_Stock_Price:  101.3018747149925
curr_Factors:  [101.30187471  -0.80033661  -1.07051482]
mat_Sqrt:  [[15.59972803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.82167698e-04  1.38975068e-02 -2.32200769e-01]
Stock Position:  0.00018216769845917868
Bond Position:  [6.50416187]


portfolio before change:  [6.52344223]
curr_Stock_Price:  101.37522734636626
curr_Factors:  [101.37522735  -0.49856565  -1.10841867]
mat_Sqrt:  [[20.3248533   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04187024 -0.02819662 -2.86530214]
Stock Position:  -0.0418702449642843
Bond Position:  [10.76804783]


portfolio before change:  [6.49632389]
curr_Stock_Price:  102.05505215732242
curr_Factors:  [102.05505216  -0.64398283  -1.11464373]
mat_Sqrt:  [[17.58217909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0127917   0.0149799   0.04714994]
Stock Position:  -0.012791700699142608
Bond Position:  [7.80178157]


portfolio before change:  [6.49270821]
curr_Stock_Price:  102.4139535199516
curr_Factors:  [102.41395352  -0.55090871  -1.11190178]
mat_Sqrt:  [[19.4182331   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00125587 0.0122567  0.37928669]
Stock Position:  0.0012558705377229043
Bond Position:  [6.36408955]


portfolio before change:  [6.49179725]
curr_Stock_Price:  101.05511370807173
curr_Factors:  [101.05511371  -0.67005943  -1.08887789]
mat_Sqrt:  [[17.40449877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.001036   0.01788665 0.02386537]
Stock Position:  0.0010359963566434506
Bond Position:  [6.38710452]


portfolio before change:  [6.49284837]
curr_Stock_Price:  101.29901989381155
curr_Factors:  [101.29901989  -0.60196863  -1.09105794]
mat_Sqrt:  [[18.63516093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00875132 -0.00528563 -0.37405801]
Stock Position:  -0.008751317463808743
Bond Position:  [7.37934825]


portfolio before change:  [6.50315665]
curr_Stock_Price:  100.22651819174465
curr_Factors:  [100.22651819  -0.51662124  -1.08726233]
mat_Sqrt:  [[20.15695183  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260028  0.0049611   0.16678008]
Stock Position:  -0.0026002792485681553
Bond Position:  [6.76377359]


portfolio before change:  [6.50245705]
curr_Stock_Price:  100.82073447620444
curr_Factors:  [100.82073448  -0.47928783  -1.11253959]
mat_Sqrt:  [[20.52239274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00695078 -0.03679336 -0.07849972]
Stock Position:  0.006950781956577236
Bond Position:  [5.8016741]


portfolio before change:  [6.49732959]
curr_Stock_Price:  99.97871294757758
curr_Factors:  [99.97871295 -0.49448449 -1.10490776]
mat_Sqrt:  [[20.19762535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00091714 0.00441999 0.21026151]
Stock Position:  0.0009171439978643897
Bond Position:  [6.40563472]


portfolio before change:  [6.49784298]
curr_Stock_Price:  99.66538157493864
curr_Factors:  [99.66538157 -0.60697046 -1.09594711]
mat_Sqrt:  [[18.15417969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00039329  0.00176125 -0.08509246]
Stock Position:  0.00039328632631960205
Bond Position:  [6.45864595]


portfolio before change:  [6.49866623]
curr_Stock_Price:  99.70572988991795
curr_Factors:  [99.70572989 -0.67425372 -1.10328595]
mat_Sqrt:  [[16.85560897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00543424  0.00074386  0.0008267 ]
Stock Position:  -0.005434244593949883
Bond Position:  [7.04049155]


portfolio before change:  [6.49965077]
curr_Stock_Price:  99.68651282957173
curr_Factors:  [99.68651283 -0.48578329 -1.09239549]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.49965077]
Stock Price:  99.33027583435798
PL:  [6.49965077]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-6.72341802e-02 -2.77084858e-02 -3.47936193e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 1.99506511e-01 -1.96222697e-02 -5.22936119e-02]
 [-3.66837025e-02  2.24045078e-03  8.26331633e-02]
 [-6.64986875e-01 -2.01514261e-01  3.64030193e-02]
 [ 2.09044978e-02 -1.44466600e-01 -1.87347356e-01]
 [ 3.41518754e-02  3.20042706e-02 -1.75928953e-02]
 [ 3.23717165e-01 -3.39045409e-02 -7.83962614e-02]
 [-4.26912552e-01 -2.19971931e-02 -5.06166010e-02]
 [ 5.08704767e-02 -2.31915934e-02 -4.41698223e-02]
 [ 5.81493082e-02 -2.44651454e-01  1.80050072e-02]
 [ 1.62945578e-02 -2.19158135e-02 -4.42422621e-02]
 [ 2.54325554e-01 -2.30948715e-01  1.18532398e-01]
 [ 9.22370481e-02 -5.71137886e-02 -5.54121481e-02]
 [-1.02138675e-01  8.91778678e-02  7.58294745e-02]
 [-1.68306379e-03 -1.87367711e-01 -3.46632339e-02]
 [-4.65556942e-01 -2.78212290e-01  1.28081932e-01]
 [-2.08681817e-01 -3.38815567e-02 -3.58868883e-02]
 [ 3.57486502e-01  1.35061683e+00  5.95184237e-01]
 [-1.40531906e-01 -1.53779989e-02  1.23792300e-01]
 [-9.12054050e-02  1.35393410e-01 -3.76503751e-02]
 [ 4.00586062e-02  1.00374459e-02  2.55841864e-02]
 [ 1.79557274e-02 -2.81504245e-02  1.47875960e-02]
 [ 2.86565661e-02  6.64235194e-02  9.65563893e-02]
 [-6.07856028e-02 -1.41204529e-01 -8.57287451e-02]
 [ 1.05151065e-01 -4.51563953e-03 -9.44708271e-03]
 [-9.16387197e-02  1.76973302e-02  4.02525638e-02]
 [ 5.46856393e-03  4.19189623e-02 -6.08149499e-02]
 [-5.51031778e-01  6.84890374e-02 -7.18960857e-01]
 [-1.17795685e-01 -6.56503341e-02  3.23035994e-03]
 [-9.02798921e-02  9.22946337e-02  2.11615573e-01]
 [ 1.29018004e-02  4.42132429e-02  1.42608332e-02]
 [-1.16269018e-01 -7.73349025e-04 -1.48605164e-01]
 [-6.55780573e-02 -4.07639398e-03  4.59285121e-02]
 [ 2.23910931e-01 -1.70839599e-01 -7.03834101e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-1.83653333e-02 -2.12179332e-02 -4.68507657e-02]
 [-8.17903495e-02  3.21020080e-02 -2.36562466e-03]
 [-4.41288698e-02 -2.72387085e-01  1.30552607e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.96263169]
curr_Stock_Price:  100.21942707473686
curr_Factors:  [100.21942707  -1.21006261  -0.97543462]
mat_Sqrt:  [[11.26685046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0066613  -0.00876219 -0.09925651]
Stock Position:  -0.006661296193491625
Bond Position:  [4.63022298]


portfolio before change:  [3.96524875]
curr_Stock_Price:  99.9134435532194
curr_Factors:  [99.91344355 -1.3399584  -0.991618  ]
mat_Sqrt:  [[ 9.70584082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00467564  0.01411938  0.0859571 ]
Stock Position:  -0.004675642603970533
Bond Position:  [4.43240831]


portfolio before change:  [3.96433525]
curr_Stock_Price:  100.2273227865941
curr_Factors:  [100.22732279  -1.36218874  -0.98564171]
mat_Sqrt:  [[ 9.57935614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01965951 -0.00620511 -0.14917912]
Stock Position:  0.019659513035231335
Bond Position:  [1.99391489]


portfolio before change:  [3.95392253]
curr_Stock_Price:  99.68499134845754
curr_Factors:  [99.68499135 -1.40561695 -0.99046235]
mat_Sqrt:  [[ 9.07874373  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217634  0.00070849  0.23572941]
Stock Position:  -0.0021763397118069456
Bond Position:  [4.17087094]


portfolio before change:  [3.95496527]
curr_Stock_Price:  99.44543988353276
curr_Factors:  [99.44543988 -1.06593408 -0.95135468]
mat_Sqrt:  [[13.22779627  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05010352 -0.0637244   0.10384768]
Stock Position:  -0.050103524568109625
Bond Position:  [8.93753231]


portfolio before change:  [3.98567227]
curr_Stock_Price:  98.85486779709476
curr_Factors:  [98.8548678  -0.9685971  -0.90915367]
mat_Sqrt:  [[15.11824092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139353 -0.04568435 -0.53444986]
Stock Position:  -0.0013935306956350205
Bond Position:  [4.12342957]


portfolio before change:  [3.98435244]
curr_Stock_Price:  100.17187557992993
curr_Factors:  [100.17187558  -1.05159695  -0.89490581]
mat_Sqrt:  [[14.30179008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00219463  0.01012064 -0.05018763]
Stock Position:  0.0021946264916482354
Bond Position:  [3.76451259]


portfolio before change:  [3.985817]
curr_Stock_Price:  100.62478407635739
curr_Factors:  [100.62478408  -1.04928423  -0.87399585]
mat_Sqrt:  [[14.70398451  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02086776 -0.01072156 -0.22364271]
Stock Position:  0.020867757580410273
Bond Position:  [1.8860034]


portfolio before change:  [3.98039684]
curr_Stock_Price:  100.35374736521311
curr_Factors:  [100.35374737  -1.11605764  -0.87427592]
mat_Sqrt:  [[13.71332316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03192608 -0.00695612 -0.14439507]
Stock Position:  -0.03192607527442633
Bond Position:  [7.18429813]


portfolio before change:  [4.00395975]
curr_Stock_Price:  99.6438318846605
curr_Factors:  [99.64383188 -1.18173961 -0.86287119]
mat_Sqrt:  [[12.89695639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00319886 -0.00733383 -0.12600421]
Stock Position:  0.0031988590055632197
Bond Position:  [3.68521318]


portfolio before change:  [4.00227341]
curr_Stock_Price:  98.97264844867568
curr_Factors:  [98.97264845 -1.18651666 -0.86582298]
mat_Sqrt:  [[12.71145924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00436674 -0.07736558  0.05136327]
Stock Position:  0.00436674425054892
Bond Position:  [3.57008516]


portfolio before change:  [4.00043881]
curr_Stock_Price:  98.45031749061732
curr_Factors:  [98.45031749 -1.36646494 -0.85134627]
mat_Sqrt:  [[10.71603078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00062502 -0.00693039 -0.12621086]
Stock Position:  0.0006250243365189759
Bond Position:  [3.93890497]


portfolio before change:  [4.0012589]
curr_Stock_Price:  98.9746023040565
curr_Factors:  [98.9746023  -1.38963835 -0.86774498]
mat_Sqrt:  [[10.35510822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0263211  -0.0730324   0.33813994]
Stock Position:  0.026321097067513288
Bond Position:  [1.39613878]


portfolio before change:  [3.97706585]
curr_Stock_Price:  98.04882127876772
curr_Factors:  [98.04882128 -1.28480218 -0.87301227]
mat_Sqrt:  [[11.33223228  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0070111  -0.01806097 -0.15807543]
Stock Position:  0.007011100471335606
Bond Position:  [3.28963571]


portfolio before change:  [3.97542127]
curr_Stock_Price:  97.75559825522792
curr_Factors:  [97.75559826 -1.12448258 -0.87624708]
mat_Sqrt:  [[13.22013185  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00638099  0.02820052  0.21632038]
Stock Position:  -0.006380986734105408
Bond Position:  [4.59919844]


portfolio before change:  [3.97409266]
curr_Stock_Price:  98.05391301077208
curr_Factors:  [98.05391301 -1.11689016 -0.90102528]
mat_Sqrt:  [[13.03453035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104311 -0.05925087 -0.09888456]
Stock Position:  -0.001043112403930225
Bond Position:  [4.07637391]


portfolio before change:  [3.97381609]
curr_Stock_Price:  98.80756651722189
curr_Factors:  [98.80756652 -1.32912374 -0.93051199]
mat_Sqrt:  [[10.31437395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04329839 -0.08797845  0.3653821 ]
Stock Position:  -0.04329838532230774
Bond Position:  [8.25202418]


portfolio before change:  [3.99585527]
curr_Stock_Price:  98.32238413427473
curr_Factors:  [98.32238413 -1.25351926 -0.91753576]
mat_Sqrt:  [[11.21437783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01933964 -0.01071429 -0.1023753 ]
Stock Position:  -0.019339638700031248
Bond Position:  [5.89737466]


portfolio before change:  [3.9997213]
curr_Stock_Price:  98.1606018353646
curr_Factors:  [98.16060184 -1.36171011 -0.91204754]
mat_Sqrt:  [[10.10315021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05086045 0.42710254 1.69789496]
Stock Position:  0.0508604486512136
Bond Position:  [-0.99277095]


portfolio before change:  [4.03348128]
curr_Stock_Price:  98.82681855975967
curr_Factors:  [98.82681856 -1.41805301 -0.93282615]
mat_Sqrt:  [[ 9.41674842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01228237 -0.00486295  0.35314497]
Stock Position:  -0.012282367755421377
Bond Position:  [5.24730861]


portfolio before change:  [4.0313254]
curr_Stock_Price:  99.05575088458518
curr_Factors:  [99.05575088 -1.41961212 -0.95141419]
mat_Sqrt:  [[ 9.25030495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01031262  0.04281516 -0.10740604]
Stock Position:  -0.010312623566067823
Bond Position:  [5.05285007]


portfolio before change:  [4.03037587]
curr_Stock_Price:  99.20907547064738
curr_Factors:  [99.20907547 -1.42782426 -0.94291059]
mat_Sqrt:  [[ 9.26732382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00491405 0.00317412 0.07298456]
Stock Position:  0.004914053178933783
Bond Position:  [3.5428572]


portfolio before change:  [4.0335803]
curr_Stock_Price:  99.77104371079479
curr_Factors:  [99.77104371 -1.5136014  -0.95197503]
mat_Sqrt:  [[ 8.47653338  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00238864 -0.00890195  0.0421849 ]
Stock Position:  0.002388640616531676
Bond Position:  [3.79526313]


portfolio before change:  [4.03419465]
curr_Stock_Price:  99.82962082102988
curr_Factors:  [99.82962082 -1.6100152  -0.95385367]
mat_Sqrt:  [[ 7.68750344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00651461 0.02100496 0.2754485 ]
Stock Position:  0.006514612293782674
Bond Position:  [3.38384338]


portfolio before change:  [4.03321068]
curr_Stock_Price:  99.61364802405517
curr_Factors:  [99.61364802 -1.87122715 -0.93234165]
mat_Sqrt:  [[ 6.03593267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01357384 -0.04465279 -0.24456025]
Stock Position:  -0.013573841754369147
Bond Position:  [5.38535058]


portfolio before change:  [4.03424533]
curr_Stock_Price:  99.58702068734436
curr_Factors:  [99.58702069 -1.67353737 -0.96883141]
mat_Sqrt:  [[ 7.08984205  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01454279 -0.00142797 -0.0269499 ]
Stock Position:  0.014542791405820222
Bond Position:  [2.58597206]


portfolio before change:  [4.04422619]
curr_Stock_Price:  100.25110167137883
curr_Factors:  [100.25110167  -1.8468225   -0.98300522]
mat_Sqrt:  [[ 5.91712292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01402122  0.00559639  0.11482936]
Stock Position:  -0.014021215628566855
Bond Position:  [5.4498685]


portfolio before change:  [4.04431555]
curr_Stock_Price:  100.29331732225087
curr_Factors:  [100.29331732  -1.81012214  -0.9936465 ]
mat_Sqrt:  [[ 6.07590186  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096494  0.01325594 -0.17348812]
Stock Position:  -0.0009649419818066199
Bond Position:  [4.14109278]


portfolio before change:  [4.04492072]
curr_Stock_Price:  100.20263693448922
curr_Factors:  [100.20263693  -1.65920953  -0.99537284]
mat_Sqrt:  [[ 7.04707149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09876736  0.02165814 -2.0509952 ]
Stock Position:  -0.09876736322182056
Bond Position:  [13.94167096]


portfolio before change:  [4.04550003]
curr_Stock_Price:  100.21441720047883
curr_Factors:  [100.2144172   -1.39556057  -0.96473088]
mat_Sqrt:  [[ 9.45951023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01256211 -0.02076046  0.00921532]
Stock Position:  -0.012562106487594876
Bond Position:  [5.30440421]


portfolio before change:  [4.0446448]
curr_Stock_Price:  100.33528231331938
curr_Factors:  [100.33528231  -1.5743982   -0.96722288]
mat_Sqrt:  [[ 7.90026514  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00565817  0.02918613  0.60368033]
Stock Position:  -0.005658165408224353
Bond Position:  [4.61235842]


portfolio before change:  [4.04610575]
curr_Stock_Price:  100.17898367270486
curr_Factors:  [100.17898367  -1.68645724  -0.9765658 ]
mat_Sqrt:  [[ 6.98619029  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00242684 0.01398146 0.04068219]
Stock Position:  0.0024268393915299583
Bond Position:  [3.80298744]


portfolio before change:  [4.04726636]
curr_Stock_Price:  100.46133287766455
curr_Factors:  [100.46133288  -1.68680586  -0.97576196]
mat_Sqrt:  [[ 7.00907041  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.09190205e-02 -2.44554435e-04 -4.23929170e-01]
Stock Position:  -0.020919020504603078
Bond Position:  [6.14881905]


portfolio before change:  [4.04245979]
curr_Stock_Price:  100.72784758914361
curr_Factors:  [100.72784759  -1.58228534  -0.96845967]
mat_Sqrt:  [[ 7.85914083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00716468 -0.00128907  0.13102126]
Stock Position:  -0.0071646751583033805
Bond Position:  [4.7641421]


portfolio before change:  [4.04093537]
curr_Stock_Price:  101.02374015212226
curr_Factors:  [101.02374015  -1.54243387  -0.97506834]
mat_Sqrt:  [[ 8.14865867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02517383 -0.05402422 -0.20078428]
Stock Position:  0.025173826299181322
Bond Position:  [1.49778128]


portfolio before change:  [4.04003529]
curr_Stock_Price:  100.98054798290478
curr_Factors:  [100.98054798  -1.46539475  -0.98156488]
mat_Sqrt:  [[ 8.74050763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0028044  0.00777784 0.21633947]
Stock Position:  0.0028044004622288605
Bond Position:  [3.7568454]


portfolio before change:  [4.04035482]
curr_Stock_Price:  100.92702352291892
curr_Factors:  [100.92702352  -0.99915722  -0.9953136 ]
mat_Sqrt:  [[13.73471955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207333 -0.0067097  -0.13365219]
Stock Position:  -0.0020733259487494436
Bond Position:  [4.24960944]


portfolio before change:  [4.03956418]
curr_Stock_Price:  101.56458917308962
curr_Factors:  [101.56458917  -1.0058309   -0.97810585]
mat_Sqrt:  [[13.96784904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00583084  0.01015155 -0.00674847]
Stock Position:  -0.005830844829902505
Bond Position:  [4.63177154]


portfolio before change:  [4.04278566]
curr_Stock_Price:  101.11139949776226
curr_Factors:  [101.1113995   -0.6811151   -0.97297863]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.04278566]
Stock Price:  100.99427760811217
PL:  [3.04850805]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-4.65590219e-02  4.15334053e-02  3.91816178e-03]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 3.36105107e-01  9.64536121e-03 -8.35656808e-02]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-4.88115813e-01 -1.51413464e-01  4.07252937e-02]
 [-4.29117716e-02 -2.20572076e-02 -1.71198888e-03]
 [ 2.22654293e-02  9.67562669e-02  2.57738558e-02]
 [ 2.64615136e-01 -1.21709392e-01 -4.73496292e-02]
 [-4.62196307e-01 -2.57840946e-02 -5.03691487e-02]
 [ 7.64314041e-02 -4.22163300e-02 -6.86222677e-02]
 [ 8.87914894e-02 -3.40674785e-01  3.27438773e-02]
 [-1.46238352e-01 -1.11319964e-01 -2.43860948e-01]
 [ 2.29853710e-01 -2.82684926e-01 -4.82155602e-02]
 [ 9.54537136e-02 -6.32243552e-02 -4.49429509e-02]
 [ 7.08417280e-03 -5.58217357e-02 -1.98763702e-02]
 [-2.86455432e-02 -4.38368280e-02  8.96417016e-03]
 [-4.61267646e-01 -2.52907545e-01  1.23749954e-01]
 [-1.27717144e-01  1.83432838e-02 -2.00174006e-02]
 [ 3.45757884e-01  1.39955795e+00  5.45463427e-01]
 [-1.77042939e-01 -2.49222229e-02  1.42183253e-01]
 [-9.76009173e-02  3.42848876e-01 -2.79228265e-02]
 [-1.63295797e-02 -4.96152412e-04  1.38338987e-02]
 [-8.94332589e-02  1.72248129e-02 -1.01943709e-01]
 [-5.06768080e-03 -1.04660996e-01  1.03561730e-01]
 [-1.18166101e-01  1.17084275e-01  8.58457890e-02]
 [ 5.80123753e-02 -1.90113451e-01 -2.57168342e-01]
 [ 9.32359409e-02  2.82479625e-03  9.84182569e-02]
 [-1.50600011e-01  4.06299103e-02  1.47579180e-01]
 [-4.03564689e-01 -1.29064271e-01 -6.71722261e-01]
 [ 3.11236155e-01 -2.31604463e-01 -1.86774042e-01]
 [ 1.34083552e-01  1.42393853e-02 -3.20280242e-02]
 [ 4.83865689e-02  2.80203158e-01 -9.88552782e-02]
 [-1.36462192e-01  2.61445782e-02 -1.68099592e-01]
 [-3.89849858e-02  1.47800844e-01  9.49433382e-02]
 [-1.69058975e-01  9.12767709e-02  9.59182810e-02]
 [-1.00952215e-01 -7.84784804e-02  7.22696030e-03]
 [ 5.86992012e-02  4.24073162e-02 -6.41430627e-04]
 [-1.19249255e-01  2.01919090e-01  7.99255729e-03]
 [ 1.68044070e-03 -2.17011028e-01  7.01272920e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.89699725]
curr_Stock_Price:  101.04626202499176
curr_Factors:  [101.04626202  -1.1335367   -1.00854508]
mat_Sqrt:  [[11.86385843  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00376664  0.01313402  0.01117742]
Stock Position:  -0.003766636529936652
Bond Position:  [10.27760179]


portfolio before change:  [9.90079555]
curr_Stock_Price:  100.3789500726684
curr_Factors:  [100.37895007  -0.73683966  -1.01165843]
mat_Sqrt:  [[17.46946388  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259774  0.01411938  0.0859571 ]
Stock Position:  -0.0025977352921080607
Bond Position:  [10.16155349]


portfolio before change:  [9.89972579]
curr_Stock_Price:  101.27974813946878
curr_Factors:  [101.27974814  -0.74979212  -1.0194737 ]
mat_Sqrt:  [[17.2639525   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01849498  0.00305013 -0.23838963]
Stock Position:  0.018494975333844248
Bond Position:  [8.02655935]


portfolio before change:  [9.89732999]
curr_Stock_Price:  101.09595858486176
curr_Factors:  [101.09595858  -0.62808125  -1.04160147]
mat_Sqrt:  [[19.03705665  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103498 -0.00659539  0.21422481]
Stock Position:  0.0010349842555856976
Bond Position:  [9.79269726]


portfolio before change:  [9.89821107]
curr_Stock_Price:  100.76447266751495
curr_Factors:  [100.76447267  -0.5309236   -1.04584489]
mat_Sqrt:  [[20.82215065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02323066 -0.04788114  0.11617793]
Stock Position:  -0.023230658764344537
Bond Position:  [12.23903615]


portfolio before change:  [9.89381548]
curr_Stock_Price:  101.01954781497997
curr_Factors:  [101.01954781  -0.73354185  -1.0466035 ]
mat_Sqrt:  [[17.03327341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257324 -0.0069751  -0.00488383]
Stock Position:  -0.0025732425878685376
Bond Position:  [10.15376328]


portfolio before change:  [9.89455541]
curr_Stock_Price:  101.22527049695631
curr_Factors:  [101.2252705   -0.86981783  -1.07206134]
mat_Sqrt:  [[14.51916148  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00206794 0.03059702 0.07352564]
Stock Position:  0.002067938405624221
Bond Position:  [9.68522778]


portfolio before change:  [9.89636368]
curr_Stock_Price:  101.51422912498225
curr_Factors:  [101.51422912  -0.73913712  -1.06466907]
mat_Sqrt:  [[16.71644191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01506346 -0.03848789 -0.13507531]
Stock Position:  0.015063457416650307
Bond Position:  [8.36720842]


portfolio before change:  [9.88079585]
curr_Stock_Price:  100.41130807690602
curr_Factors:  [100.41130808  -0.5274097   -1.0795372 ]
mat_Sqrt:  [[20.13234921  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02350166 -0.00815365 -0.14368916]
Stock Position:  -0.02350165915390655
Bond Position:  [12.24062818]


portfolio before change:  [9.91258146]
curr_Stock_Price:  99.12393340917754
curr_Factors:  [99.12393341 -0.42829521 -1.06997105]
mat_Sqrt:  [[22.15591856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00276829 -0.01334998 -0.19576023]
Stock Position:  0.0027682861009035217
Bond Position:  [9.63817805]


portfolio before change:  [9.91264173]
curr_Stock_Price:  98.71047082065718
curr_Factors:  [98.71047082 -0.34082854 -1.08507986]
mat_Sqrt:  [[23.71914724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00365439 -0.10773083  0.09340917]
Stock Position:  0.003654394458271077
Bond Position:  [9.55191473]


portfolio before change:  [9.90741211]
curr_Stock_Price:  96.95267348907328
curr_Factors:  [96.95267349 -0.4309512  -1.05770878]
mat_Sqrt:  [[21.87978109  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00909015 -0.03520246 -0.69566741]
Stock Position:  -0.00909015168412151
Bond Position:  [10.78872661]


portfolio before change:  [9.90841384]
curr_Stock_Price:  96.99084061873681
curr_Factors:  [96.99084062 -0.33681271 -1.07988919]
mat_Sqrt:  [[23.52149428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00904334 -0.08939282 -0.13754557]
Stock Position:  0.009043339405100444
Bond Position:  [9.03129274]


portfolio before change:  [9.92334631]
curr_Stock_Price:  98.51721190771009
curr_Factors:  [98.51721191 -0.53911781 -1.0731588 ]
mat_Sqrt:  [[19.64758971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00430828 -0.0199933  -0.12820973]
Stock Position:  0.004308280435151383
Bond Position:  [9.49890653]


portfolio before change:  [9.92863199]
curr_Stock_Price:  99.46846056985952
curr_Factors:  [99.46846057 -0.65566897 -1.07322988]
mat_Sqrt:  [[17.65363603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.98180238e-05 -1.76523828e-02 -5.67017517e-02]
Stock Position:  8.981802375585488e-05
Bond Position:  [9.91969793]


portfolio before change:  [9.92985525]
curr_Stock_Price:  99.28162964826397
curr_Factors:  [99.28162965 -0.7245758  -1.08635765]
mat_Sqrt:  [[16.23268991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172169 -0.01386242  0.02557228]
Stock Position:  -0.0017216864135922434
Bond Position:  [10.10078709]


portfolio before change:  [9.92888173]
curr_Stock_Price:  100.58047193092379
curr_Factors:  [100.58047193  -1.01311649  -1.06886536]
mat_Sqrt:  [[12.54066135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0352882  -0.07997639  0.35302417]
Stock Position:  -0.035288197694032915
Bond Position:  [13.47818531]


portfolio before change:  [9.92737661]
curr_Stock_Price:  100.67087041787389
curr_Factors:  [100.67087042  -1.07319719  -1.05526453]
mat_Sqrt:  [[11.98187118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01096069  0.00580066 -0.05710407]
Stock Position:  -0.010960688445642276
Bond Position:  [11.03079866]


portfolio before change:  [9.94264484]
curr_Stock_Price:  99.40367893772124
curr_Factors:  [99.40367894 -1.03288681 -1.06731268]
mat_Sqrt:  [[12.1701913   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04052825 0.44257908 1.55605533]
Stock Position:  0.04052825126699277
Bond Position:  [5.91398756]


portfolio before change:  [9.92882854]
curr_Stock_Price:  99.0445319994575
curr_Factors:  [99.044532   -0.82146139 -1.05677293]
mat_Sqrt:  [[15.13992415  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0098193  -0.0078811   0.40560924]
Stock Position:  -0.009819295781023954
Bond Position:  [10.90137609]


portfolio before change:  [9.93013066]
curr_Stock_Price:  99.05070638721428
curr_Factors:  [99.05070639 -0.48904896 -1.06759729]
mat_Sqrt:  [[20.88404892  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00452251  0.10841833 -0.07965605]
Stock Position:  -0.004522510018656811
Bond Position:  [10.37808848]


portfolio before change:  [9.93746931]
curr_Stock_Price:  97.71487760942163
curr_Factors:  [97.71487761 -0.40432572 -1.03908287]
mat_Sqrt:  [[23.07258768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058591 -0.0001569   0.03946426]
Stock Position:  -0.0005859142352256251
Bond Position:  [9.99472184]


portfolio before change:  [9.93969588]
curr_Stock_Price:  96.04713321266695
curr_Factors:  [96.04713321 -0.27792751 -1.0172756 ]
mat_Sqrt:  [[26.30176194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00417454  0.00544696 -0.29081703]
Stock Position:  -0.004174537387895472
Bond Position:  [10.34064823]


portfolio before change:  [9.94088032]
curr_Stock_Price:  96.07305721556321
curr_Factors:  [96.07305722 -0.19988559 -1.00720078]
mat_Sqrt:  [[28.73231755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00046531 -0.03309671  0.29543279]
Stock Position:  0.00046530996164123156
Bond Position:  [9.89617657]


portfolio before change:  [9.94093638]
curr_Stock_Price:  93.5348690894156
curr_Factors:  [93.53486909 -0.33568211 -0.98093905]
mat_Sqrt:  [[25.07103357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389373  0.0370253   0.24489414]
Stock Position:  -0.003893728586290865
Bond Position:  [10.30513577]


portfolio before change:  [9.94242716]
curr_Stock_Price:  93.48284596417163
curr_Factors:  [93.48284596 -0.41909148 -0.96637235]
mat_Sqrt:  [[23.39012958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.60536849e-05 -6.01191518e-02 -7.33629699e-01]
Stock Position:  2.6053684920360973e-05
Bond Position:  [9.93999159]


portfolio before change:  [9.94367888]
curr_Stock_Price:  93.83366773706086
curr_Factors:  [93.83366774 -0.36181179 -0.97031255]
mat_Sqrt:  [[24.76420784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00457913 0.00089328 0.28075989]
Stock Position:  0.004579125654607589
Bond Position:  [9.51400272]


portfolio before change:  [9.94671797]
curr_Stock_Price:  94.23762393727723
curr_Factors:  [94.23762394 -0.61819103 -0.9706776 ]
mat_Sqrt:  [[19.23921951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00620745  0.01284831  0.42100232]
Stock Position:  -0.006207449180171419
Bond Position:  [10.53169323]


portfolio before change:  [9.95305199]
curr_Stock_Price:  93.42932420634435
curr_Factors:  [93.42932421 -0.44082412 -0.94969467]
mat_Sqrt:  [[23.25886792  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02338944 -0.04081371 -1.91623664]
Stock Position:  -0.02338943789243701
Bond Position:  [12.13831137]


portfolio before change:  [9.97820668]
curr_Stock_Price:  92.41872678249497
curr_Factors:  [92.41872678 -0.66401917 -0.93795664]
mat_Sqrt:  [[18.62218877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01434477 -0.07323976 -0.53281435]
Stock Position:  0.014344772513239634
Bond Position:  [8.65248107]


portfolio before change:  [9.97687403]
curr_Stock_Price:  92.2504228940696
curr_Factors:  [92.25042289 -0.66813622 -0.94209014]
mat_Sqrt:  [[18.43554341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00693842  0.00450289 -0.09136704]
Stock Position:  0.006938418663019469
Bond Position:  [9.33680197]


portfolio before change:  [9.98070292]
curr_Stock_Price:  92.63404363721509
curr_Factors:  [92.63404364 -0.59008994 -0.92501497]
mat_Sqrt:  [[20.35958498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00174083  0.08860802 -0.28200659]
Stock Position:  0.0017408328427925685
Bond Position:  [9.81944254]


portfolio before change:  [9.9851446]
curr_Stock_Price:  94.48038298911987
curr_Factors:  [94.48038299 -0.57801598 -0.95517844]
mat_Sqrt:  [[20.39312441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00834106  0.00826764 -0.47954135]
Stock Position:  -0.008341062590592663
Bond Position:  [10.77321139]


portfolio before change:  [9.98254744]
curr_Stock_Price:  94.95321153092416
curr_Factors:  [94.95321153 -0.6803215  -0.94889472]
mat_Sqrt:  [[18.61872962  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084799  0.04673873  0.27084692]
Stock Position:  -0.0008479932319709257
Bond Position:  [10.06306712]


portfolio before change:  [9.98346114]
curr_Stock_Price:  95.35918975427029
curr_Factors:  [95.35918975 -0.59942741 -0.9420903 ]
mat_Sqrt:  [[20.41220484  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0072076   0.02886425  0.27362816]
Stock Position:  -0.007207598751791683
Bond Position:  [10.67077191]


portfolio before change:  [9.97874567]
curr_Stock_Price:  96.19849782173267
curr_Factors:  [96.19849782 -0.57701107 -0.96297573]
mat_Sqrt:  [[20.62341216  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00492175 -0.02481707  0.02061651]
Stock Position:  -0.004921752171412805
Bond Position:  [10.45221084]


portfolio before change:  [9.97198882]
curr_Stock_Price:  97.83682910590866
curr_Factors:  [97.83682911 -0.48025983 -0.94135388]
mat_Sqrt:  [[23.61040192  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00252699  0.01341037 -0.00182982]
Stock Position:  0.0025269888296810547
Bond Position:  [9.72475624]


portfolio before change:  [9.9711649]
curr_Stock_Price:  97.0297066008795
curr_Factors:  [97.0297066  -0.45151711 -0.94038223]
mat_Sqrt:  [[24.12184459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465985  0.06385242  0.02280054]
Stock Position:  -0.004659853116539282
Bond Position:  [10.42330908]


portfolio before change:  [9.97494898]
curr_Stock_Price:  96.49726893869072
curr_Factors:  [96.49726894 -0.3872817  -0.94671548]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.97494898]
Stock Price:  95.11134117677943
PL:  [9.97494898]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.38304252e-02  1.61976604e-02  3.11088327e-02]
 [-9.22963588e-03 -2.41710074e-02 -9.25246231e-02]
 [ 2.43382267e-01  4.93306652e-02  3.21362720e-02]
 [-4.77229497e-03  1.93264146e-03  9.67727924e-02]
 [-7.95780802e-01 -2.38563171e-01  3.32067518e-02]
 [ 1.27808992e-02 -1.21484939e-01 -1.55651714e-01]
 [ 2.79461704e-02 -1.07402363e-01 -3.08230503e-02]
 [ 3.34038623e-01  1.54128713e-01 -1.01099469e-01]
 [-2.73230093e-01  8.35836116e-03 -1.10058025e-01]
 [ 4.81839694e-02 -1.86275063e-02 -4.20311183e-02]
 [ 1.79071966e-02 -2.59867497e-01  5.71035699e-02]
 [-5.77102457e-02  3.85541176e-03  3.88637649e-02]
 [ 1.95814767e-01 -1.33803527e-01  2.31807457e-01]
 [ 8.93592602e-02  7.66520634e-02  4.84981185e-02]
 [-1.06366312e-01  9.97598323e-02  8.27918218e-02]
 [ 3.09966619e-02 -3.22994330e-01 -7.89247920e-02]
 [-4.02209566e-01 -2.54228917e-01  1.01514367e-01]
 [-2.62033030e-01 -1.81212904e-01 -3.88692473e-02]
 [ 2.40651663e-01  1.08934303e+00  2.49857864e-01]
 [-2.52365933e-01 -4.31608691e-02  1.80688015e-01]
 [-9.61674357e-02  2.96350087e-01 -3.01031462e-02]
 [-2.56226363e-02  4.30698815e-02 -1.53074425e-02]
 [ 1.99825724e-02 -3.09436342e-02  1.37552502e-02]
 [ 3.82326638e-02  1.82804684e-01  1.17293100e-01]
 [-9.52863074e-02  7.28469411e-03  1.01964268e-03]
 [ 2.64735468e-02  5.99861117e-02 -1.13235034e-02]
 [ 2.95454986e-02 -6.75671166e-02  7.27028092e-02]
 [ 2.68180474e-02  4.28914575e-02 -7.86599727e-02]
 [-7.48794262e-01 -1.16586799e-01 -1.16786832e+00]
 [-2.07926286e-01 -3.96863505e-02  3.45676323e-02]
 [-3.60058385e-02  7.84294063e-02  2.05237261e-01]
 [ 2.24056880e-02  1.15495203e-01 -2.01901368e-02]
 [-1.44786522e-01 -1.35301534e-02 -1.32173655e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 2.45931710e-01 -1.77877745e-01 -6.74975742e-02]
 [-1.74178291e-02  2.09809456e-01  8.20459378e-02]
 [ 9.82442170e-02  7.94524017e-02 -2.62595478e-02]
 [-1.57753049e-02  6.46535471e-02 -1.08610370e-02]
 [-1.11407826e-01 -2.18538413e-01  4.41424350e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.37062262]
curr_Stock_Price:  100.83359230049969
curr_Factors:  [100.8335923   -0.99479229  -1.0096071 ]
mat_Sqrt:  [[13.58643899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00640802  0.00512215  0.08874484]
Stock Position:  -0.006408017550392548
Bond Position:  [9.01676605]


portfolio before change:  [8.36860666]
curr_Stock_Price:  101.32409144016128
curr_Factors:  [101.32409144  -0.93537311  -0.99002014]
mat_Sqrt:  [[14.77491715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019452  -0.00764354 -0.263947  ]
Stock Position:  -0.0019452046953851014
Bond Position:  [8.56570276]


portfolio before change:  [8.37155297]
curr_Stock_Price:  100.35991251201939
curr_Factors:  [100.35991251  -1.17450629  -0.96603613]
mat_Sqrt:  [[11.80142671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0212869  0.01559973 0.09167584]
Stock Position:  0.021286898118202304
Bond Position:  [6.23520173]


portfolio before change:  [8.36468212]
curr_Stock_Price:  100.00052268630841
curr_Factors:  [100.00052269  -1.36196375  -0.95481258]
mat_Sqrt:  [[ 9.85914136  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0015246  0.00061115 0.27606584]
Stock Position:  0.001524602256340038
Bond Position:  [8.2122211]


portfolio before change:  [8.36496097]
curr_Stock_Price:  99.51007246511776
curr_Factors:  [99.51007247 -1.23038814 -0.95707579]
mat_Sqrt:  [[11.1651234   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0712184  -0.0754403   0.09472962]
Stock Position:  -0.0712183957574108
Bond Position:  [15.45190869]


portfolio before change:  [8.40479298]
curr_Stock_Price:  98.97790092612345
curr_Factors:  [98.97790093 -1.24756457 -0.94967663]
mat_Sqrt:  [[10.99736175  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00201213 -0.03841691 -0.44403101]
Stock Position:  -0.0020121281846609824
Bond Position:  [8.60394921]


portfolio before change:  [8.40587]
curr_Stock_Price:  98.97717607054423
curr_Factors:  [98.97717607 -1.47384603 -0.94086472]
mat_Sqrt:  [[ 8.84788575  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213399 -0.03396361 -0.08792958]
Stock Position:  0.002133992805645756
Bond Position:  [8.19465342]


portfolio before change:  [8.40684053]
curr_Stock_Price:  98.95193100699454
curr_Factors:  [98.95193101 -1.43243524 -0.91537391]
mat_Sqrt:  [[ 9.45766039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03355813  0.04873978 -0.28840864]
Stock Position:  0.03355812677229123
Bond Position:  [5.08619908]


portfolio before change:  [8.41593471]
curr_Stock_Price:  99.2039822006003
curr_Factors:  [99.2039822  -1.31362953 -0.91163174]
mat_Sqrt:  [[10.7179176   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02756877  0.00264315 -0.31396491]
Stock Position:  -0.02756876774314283
Bond Position:  [11.15086625]


portfolio before change:  [8.4108993]
curr_Stock_Price:  99.4371934818457
curr_Factors:  [99.43719348 -1.2543752  -0.90379459]
mat_Sqrt:  [[11.4886138   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00340541 -0.00589053 -0.11990308]
Stock Position:  0.003405410245077862
Bond Position:  [8.07227487]


portfolio before change:  [8.41325461]
curr_Stock_Price:  99.83250760113746
curr_Factors:  [99.8325076  -1.28873206 -0.89062347]
mat_Sqrt:  [[11.29249481  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202379 -0.08217732  0.16290059]
Stock Position:  0.002023792301322597
Bond Position:  [8.21121435]


portfolio before change:  [8.41468785]
curr_Stock_Price:  100.03350178187345
curr_Factors:  [100.03350178  -1.21419937  -0.87312215]
mat_Sqrt:  [[12.40604213  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00400431  0.00121919  0.1108675 ]
Stock Position:  -0.004004312256800647
Bond Position:  [8.81525322]


portfolio before change:  [8.41565997]
curr_Stock_Price:  100.06593044591685
curr_Factors:  [100.06593045  -1.02950522  -0.8684583 ]
mat_Sqrt:  [[14.99723353  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01598145 -0.04231239  0.66128215]
Stock Position:  0.015981445756245292
Bond Position:  [6.81646173]


portfolio before change:  [8.40310064]
curr_Stock_Price:  99.22674228687654
curr_Factors:  [99.22674229 -0.88056694 -0.83881406]
mat_Sqrt:  [[17.77915237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0056942  0.02423951 0.13835163]
Stock Position:  0.005694199747132142
Bond Position:  [7.83808375]


portfolio before change:  [8.39609822]
curr_Stock_Price:  97.82492348426078
curr_Factors:  [97.82492348 -0.89393352 -0.81816561]
mat_Sqrt:  [[17.65608091  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00492129  0.03154683  0.23618202]
Stock Position:  -0.004921291112085393
Bond Position:  [8.87752315]


portfolio before change:  [8.3974415]
curr_Stock_Price:  97.77747293393745
curr_Factors:  [97.77747293 -0.62022752 -0.84302176]
mat_Sqrt:  [[22.63381283  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028924 -0.10213978 -0.22515046]
Stock Position:  0.00028923666176286364
Bond Position:  [8.36916067]


portfolio before change:  [8.39869094]
curr_Stock_Price:  98.48010403359707
curr_Factors:  [98.48010403 -0.74094696 -0.81691939]
mat_Sqrt:  [[20.73842352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01871175 -0.08039424  0.28959223]
Stock Position:  -0.01871174992735743
Bond Position:  [10.24142602]


portfolio before change:  [8.40777458]
curr_Stock_Price:  98.06307288597233
curr_Factors:  [98.06307289 -0.53794446 -0.84985067]
mat_Sqrt:  [[24.47900342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01121966 -0.05730455 -0.11088314]
Stock Position:  -0.01121965932486319
Bond Position:  [9.50800885]


portfolio before change:  [8.4139265]
curr_Stock_Price:  97.62069332889743
curr_Factors:  [97.62069333 -0.49439652 -0.85689109]
mat_Sqrt:  [[25.27464917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01265222 0.34448051 0.71277494]
Stock Position:  0.012652219202276462
Bond Position:  [7.17880809]


portfolio before change:  [8.42940911]
curr_Stock_Price:  98.77347134080436
curr_Factors:  [98.77347134 -0.58375329 -0.85240635]
mat_Sqrt:  [[23.49222286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00921997 -0.01364867  0.51545261]
Stock Position:  -0.009219968519832294
Bond Position:  [9.34009741]


portfolio before change:  [8.43906752]
curr_Stock_Price:  97.8525543462141
curr_Factors:  [97.85255435 -0.31778052 -0.82312628]
mat_Sqrt:  [[31.26674269  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302751  0.09371413 -0.0858759 ]
Stock Position:  -0.003027513589523729
Bond Position:  [8.73531746]


portfolio before change:  [8.43466642]
curr_Stock_Price:  99.6669422072199
curr_Factors:  [99.66694221 -0.43598335 -0.84325985]
mat_Sqrt:  [[27.73210735  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00099651  0.01361989 -0.04366787]
Stock Position:  -0.0009965054217959063
Bond Position:  [8.53398507]


portfolio before change:  [8.43621086]
curr_Stock_Price:  99.18764152807908
curr_Factors:  [99.18764153 -0.66161772 -0.885791  ]
mat_Sqrt:  [[21.10699936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0010419  -0.00978524  0.0392399 ]
Stock Position:  0.0010419003437152658
Bond Position:  [8.33286722]


portfolio before change:  [8.43690868]
curr_Stock_Price:  98.85761544464685
curr_Factors:  [98.85761544 -0.52763407 -0.90831004]
mat_Sqrt:  [[23.51730367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0028445  0.05780792 0.33460457]
Stock Position:  0.002844501865967211
Bond Position:  [8.15570801]


portfolio before change:  [8.43643564]
curr_Stock_Price:  98.33289617023925
curr_Factors:  [98.33289617 -0.57735553 -0.88988027]
mat_Sqrt:  [[22.67182172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418538  0.00230362  0.00290876]
Stock Position:  -0.004185375346020338
Bond Position:  [8.84799572]


portfolio before change:  [8.42632201]
curr_Stock_Price:  101.01358655123961
curr_Factors:  [101.01358655  -0.57093212  -0.87097506]
mat_Sqrt:  [[23.88732177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107634  0.01896927 -0.0323028 ]
Stock Position:  0.0010763442344335636
Bond Position:  [8.31759662]


portfolio before change:  [8.42556408]
curr_Stock_Price:  99.34340187965968
curr_Factors:  [99.34340188 -0.75199305 -0.87853432]
mat_Sqrt:  [[19.45404819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0021919  -0.0213666   0.20740088]
Stock Position:  0.002191899677683395
Bond Position:  [8.20781331]


portfolio before change:  [8.42894603]
curr_Stock_Price:  100.41822627511935
curr_Factors:  [100.41822628  -0.6105891   -0.84674272]
mat_Sqrt:  [[23.38306183  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050759  0.01356347 -0.22439501]
Stock Position:  0.0005075939361586843
Bond Position:  [8.37797435]


portfolio before change:  [8.43017306]
curr_Stock_Price:  100.77228757700291
curr_Factors:  [100.77228758  -0.45732906  -0.83724125]
mat_Sqrt:  [[27.61317689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0358595  -0.03686798 -3.33160325]
Stock Position:  -0.035859497325856575
Bond Position:  [12.04381664]


portfolio before change:  [8.42147193]
curr_Stock_Price:  101.05691800820736
curr_Factors:  [101.05691801  -0.35639126  -0.83539817]
mat_Sqrt:  [[30.68869896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0065788  -0.01254993  0.09861183]
Stock Position:  -0.006578802668614541
Bond Position:  [9.08630545]


portfolio before change:  [8.42149688]
curr_Stock_Price:  101.22578066163173
curr_Factors:  [101.22578066  -0.58523968  -0.81308999]
mat_Sqrt:  [[25.0036998   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.16476387e-04 2.48015560e-02 5.85484779e-01]
Stock Position:  0.0003164763866822828
Bond Position:  [8.38946131]


portfolio before change:  [8.42244926]
curr_Stock_Price:  100.92128597762775
curr_Factors:  [100.92128598  -0.75183188  -0.80496483]
mat_Sqrt:  [[21.27524418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099959  0.03652279 -0.05759684]
Stock Position:  0.0009995874431141568
Bond Position:  [8.32156961]


portfolio before change:  [8.42414861]
curr_Stock_Price:  101.5806439677739
curr_Factors:  [101.58064397  -0.68984175  -0.81681424]
mat_Sqrt:  [[22.51534347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00764437 -0.00427861 -0.37705465]
Stock Position:  -0.007644373852433604
Bond Position:  [9.20066903]


portfolio before change:  [8.42964824]
curr_Stock_Price:  101.01166572775934
curr_Factors:  [101.01166573  -0.60712635  -0.8173103 ]
mat_Sqrt:  [[24.30785033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215625  0.0049611   0.16678008]
Stock Position:  -0.0021562459389395613
Bond Position:  [8.64745424]


portfolio before change:  [8.42853242]
curr_Stock_Price:  102.03048566304804
curr_Factors:  [102.03048566  -0.73045463  -0.8122284 ]
mat_Sqrt:  [[21.81479942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0104315  -0.05624988 -0.19255179]
Stock Position:  0.010431498243224233
Bond Position:  [7.36420159]


portfolio before change:  [8.45466296]
curr_Stock_Price:  104.4472010094899
curr_Factors:  [104.44720101  -0.90188016  -0.84067761]
mat_Sqrt:  [[18.28578378  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0002596  0.06634758 0.23405422]
Stock Position:  0.0002595997376038837
Bond Position:  [8.4275485]


portfolio before change:  [8.45608404]
curr_Stock_Price:  105.86309820082008
curr_Factors:  [105.8630982   -0.9115858   -0.85711819]
mat_Sqrt:  [[18.0553628   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00525802  0.02512506 -0.07491118]
Stock Position:  0.005258020148758184
Bond Position:  [7.89945373]


portfolio before change:  [8.46035899]
curr_Stock_Price:  106.48832479190538
curr_Factors:  [106.48832479  -0.81649929  -0.83434076]
mat_Sqrt:  [[20.4339004   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079882  0.02044525 -0.03098352]
Stock Position:  -0.0007988175048615363
Bond Position:  [8.54542372]


portfolio before change:  [8.4612165]
curr_Stock_Price:  106.7521213501405
curr_Factors:  [106.75212135  -1.04726045  -0.84978287]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.4612165]
Stock Price:  106.08625609204691
PL:  [2.37496041]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.95041610e-02  2.13223579e-02  4.09276157e-02]
 [-5.25897165e-02  4.44993328e-02  2.98641451e-02]
 [ 2.74688698e-01 -3.88559490e-01 -6.78446980e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-5.60486720e-01 -1.71913370e-01  3.89567347e-02]
 [-6.47132255e-02  1.97613245e-02  6.17063359e-02]
 [ 1.90511545e-02  1.10742122e-01  3.33329115e-02]
 [ 2.73617475e-01 -1.14786012e-01 -5.14330912e-02]
 [-4.74575553e-01 -2.66289023e-02 -5.23194814e-02]
 [ 2.46506735e-02  2.13530332e-02 -2.32964758e-02]
 [-9.13915361e-03 -2.35865506e-01  1.46294813e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.73325570e-01 -1.11366724e-01  2.29160984e-01]
 [ 8.44608408e-02  8.31077775e-02  4.49575431e-02]
 [ 6.55590007e-02 -1.12819129e-01 -5.48318040e-02]
 [-4.31615491e-02  4.95255438e-04  2.54754086e-02]
 [-4.48879920e-01 -2.41916514e-01  1.17880603e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 2.36008153e-01  9.92636172e-01  3.52933507e-01]
 [ 1.08093284e-02  1.02604373e-02  3.07278533e-02]
 [-7.19735707e-02  5.28442077e-02 -3.09490818e-02]
 [-7.82513358e-03  3.35642608e-02 -3.77414368e-03]
 [ 3.15538948e-02 -3.24537362e-02  2.74095619e-02]
 [ 4.87129055e-02  1.86706776e-01  9.86033807e-02]
 [-6.08935666e-02 -1.96183498e-01 -1.64219490e-02]
 [ 1.09005656e-01  1.49856454e-03 -9.38508354e-03]
 [ 3.27024542e-02 -6.68002857e-02  9.38574561e-02]
 [-1.37271918e-02  4.26422489e-02  1.93000042e-02]
 [-6.31604737e-01  1.96155712e-02 -8.80333458e-01]
 [-1.07348591e-02 -1.18554782e-01 -3.94797960e-02]
 [ 7.32717510e-02  2.94859833e-02  3.15117707e-02]
 [ 3.41744527e-02  1.87300706e-01 -5.43814217e-02]
 [-1.37828724e-01  1.17970431e-02 -1.55487479e-01]
 [-5.69594343e-02  1.44118321e-01  1.05244753e-01]
 [-1.17331532e-01  8.57900778e-02  1.37041347e-01]
 [-1.24896276e-01 -6.64576191e-02 -1.05173430e-02]
 [ 1.46412283e-01  1.24075052e-01  4.80522141e-02]
 [-1.28689616e-01  1.89631731e-01  3.68918188e-03]
 [ 1.77345099e-03 -2.22714586e-01  7.28220377e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.36422846]
curr_Stock_Price:  100.69337143570338
curr_Factors:  [100.69337144  -0.93527536  -1.00809929]
mat_Sqrt:  [[14.42128628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00628233  0.00674272  0.1167551 ]
Stock Position:  -0.006282331809597147
Bond Position:  [7.99681763]


portfolio before change:  [7.36415281]
curr_Stock_Price:  100.86453591567916
curr_Factors:  [100.86453592  -1.02377985  -0.99744025]
mat_Sqrt:  [[13.36391675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339307  0.01407192  0.08519409]
Stock Position:  -0.003393073785249387
Bond Position:  [7.70639362]


portfolio before change:  [7.36166956]
curr_Stock_Price:  101.88031261415891
curr_Factors:  [101.88031261  -1.25964097  -1.02002407]
mat_Sqrt:  [[10.42423811  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0121034  -0.1228733  -1.93542039]
Stock Position:  0.01210340019737132
Bond Position:  [6.12857137]


portfolio before change:  [7.35311027]
curr_Stock_Price:  101.10983428627468
curr_Factors:  [101.10983429  -1.13192858  -0.98823278]
mat_Sqrt:  [[12.13441985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00162373 -0.00659539  0.21422481]
Stock Position:  0.0016237326667008919
Bond Position:  [7.18893493]


portfolio before change:  [7.35220352]
curr_Stock_Price:  99.9979371307619
curr_Factors:  [99.99793713 -0.78851448 -0.98454533]
mat_Sqrt:  [[16.98090949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03279998 -0.05436378  0.11113272]
Stock Position:  -0.03279998016083699
Bond Position:  [10.63213388]


portfolio before change:  [7.30662273]
curr_Stock_Price:  101.42811772971015
curr_Factors:  [101.42811773  -1.07319651  -0.97484292]
mat_Sqrt:  [[13.08296386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00394461  0.00624908  0.176031  ]
Stock Position:  -0.003944613603904701
Bond Position:  [7.70671746]


portfolio before change:  [7.30781238]
curr_Stock_Price:  101.3707594935318
curr_Factors:  [101.37075949  -1.11842361  -0.98107324]
mat_Sqrt:  [[12.41974854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00231201 0.03501973 0.09508952]
Stock Position:  0.0023120078270466443
Bond Position:  [7.0734424]


portfolio before change:  [7.30949401]
curr_Stock_Price:  101.71565109495654
curr_Factors:  [101.71565109  -0.74999601  -0.99667688]
mat_Sqrt:  [[17.73443609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01466948 -0.03629852 -0.14672429]
Stock Position:  0.014669481246760641
Bond Position:  [5.81737818]


portfolio before change:  [7.2988257]
curr_Stock_Price:  100.93883235486555
curr_Factors:  [100.93883235  -0.6697056   -1.00598909]
mat_Sqrt:  [[18.89353923  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02572005 -0.0084208  -0.14925292]
Stock Position:  -0.025720050201886648
Bond Position:  [9.89497754]


portfolio before change:  [7.26755503]
curr_Stock_Price:  102.20273440265576
curr_Factors:  [102.2027344   -0.93914874  -0.97957903]
mat_Sqrt:  [[15.00270722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00136286  0.00675242 -0.06645836]
Stock Position:  0.0013628629127661793
Bond Position:  [7.12826671]


portfolio before change:  [7.2690253]
curr_Stock_Price:  102.62771326425491
curr_Factors:  [102.62771326  -1.04579068  -0.96751273]
mat_Sqrt:  [[13.70560116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00106768 -0.07458722  0.41733838]
Stock Position:  0.0010676750842522227
Bond Position:  [7.15945225]


portfolio before change:  [7.26810414]
curr_Stock_Price:  100.9266750633396
curr_Factors:  [100.92667506  -0.89221321  -0.99723811]
mat_Sqrt:  [[15.25554345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00472783  0.00225658  0.15019092]
Stock Position:  -0.0047278301697139345
Bond Position:  [7.74526831]


portfolio before change:  [7.27300395]
curr_Stock_Price:  100.09509007758456
curr_Factors:  [100.09509008  -0.84448893  -0.98828213]
mat_Sqrt:  [[16.01217824  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01356639 -0.03521725  0.6537325 ]
Stock Position:  0.013566385545883717
Bond Position:  [5.91507536]


portfolio before change:  [7.27921989]
curr_Stock_Price:  100.4987726194002
curr_Factors:  [100.49877262  -0.66790484  -0.98933592]
mat_Sqrt:  [[19.16153241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00499874 0.02628099 0.12825136]
Stock Position:  0.004998743963488562
Bond Position:  [6.77685226]


portfolio before change:  [7.28325784]
curr_Stock_Price:  101.13709089594279
curr_Factors:  [101.1370909   -0.59438302  -0.99207755]
mat_Sqrt:  [[20.69757144  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00248597 -0.03567654 -0.15641987]
Stock Position:  0.002485969347062361
Bond Position:  [7.03183413]


portfolio before change:  [7.28232432]
curr_Stock_Price:  100.407975350337
curr_Factors:  [100.40797535  -0.67645097  -0.98897638]
mat_Sqrt:  [[18.98813472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199854  0.00015661  0.07267425]
Stock Position:  -0.0019985436274340524
Bond Position:  [7.48299403]


portfolio before change:  [7.28208608]
curr_Stock_Price:  100.99523549657366
curr_Factors:  [100.9952355   -0.86149484  -0.9904826 ]
mat_Sqrt:  [[15.84883354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02719846 -0.07650072  0.33628055]
Stock Position:  -0.027198462244459175
Bond Position:  [10.02900118]


portfolio before change:  [7.22938889]
curr_Stock_Price:  102.97883655576
curr_Factors:  [102.97883656  -1.04476397  -0.99287255]
mat_Sqrt:  [[13.42189028  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00978335  0.00580111 -0.05715682]
Stock Position:  -0.00978335249287793
Bond Position:  [8.23686715]


portfolio before change:  [7.23546596]
curr_Stock_Price:  102.46291898340341
curr_Factors:  [102.46291898  -1.0714941   -0.98157075]
mat_Sqrt:  [[13.15018884  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02537455 0.31389912 1.00682106]
Stock Position:  0.025374552671086764
Bond Position:  [4.63551523]


portfolio before change:  [7.21999636]
curr_Stock_Price:  101.83043182531105
curr_Factors:  [101.83043183  -0.90515036  -0.98480974]
mat_Sqrt:  [[15.38432142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00112755 0.00324464 0.08765801]
Stock Position:  0.0011275472015807638
Bond Position:  [7.10517774]


portfolio before change:  [7.21956312]
curr_Stock_Price:  100.65847031485022
curr_Factors:  [100.65847031  -0.94732972  -0.96607628]
mat_Sqrt:  [[14.85486325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00517855  0.01671081 -0.08828912]
Stock Position:  -0.005178546088036341
Bond Position:  [7.74082765]


portfolio before change:  [7.22530641]
curr_Stock_Price:  99.7362765432385
curr_Factors:  [99.73627654 -0.93911381 -0.96718382]
mat_Sqrt:  [[14.82376802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052139  0.01061395 -0.01076658]
Stock Position:  -0.0005213857864576214
Bond Position:  [7.27730749]


portfolio before change:  [7.22634002]
curr_Stock_Price:  99.49865911625862
curr_Factors:  [99.49865912 -0.73249381 -0.96940412]
mat_Sqrt:  [[18.14230025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00200145 -0.01026277  0.07819185]
Stock Position:  0.0020014494211985567
Bond Position:  [7.02719849]


portfolio before change:  [7.22812781]
curr_Stock_Price:  99.9529960980051
curr_Factors:  [99.9529961  -0.88773624 -0.95801017]
mat_Sqrt:  [[15.78331897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00466701 0.05904187 0.281288  ]
Stock Position:  0.0046670148800721034
Bond Position:  [6.76164569]


portfolio before change:  [7.2298452]
curr_Stock_Price:  100.13986801486068
curr_Factors:  [100.13986801  -0.60073287  -0.95677784]
mat_Sqrt:  [[21.09544573  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0032856  -0.06203867 -0.04684725]
Stock Position:  -0.0032855963268384686
Bond Position:  [7.55886438]


portfolio before change:  [7.2339781]
curr_Stock_Price:  99.16957624540272
curr_Factors:  [99.16957625 -0.34370228 -0.94298891]
mat_Sqrt:  [[27.38896194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00391138  0.00047389 -0.02677303]
Stock Position:  0.003911379598640126
Bond Position:  [6.84608825]


portfolio before change:  [7.23293344]
curr_Stock_Price:  98.68369082142469
curr_Factors:  [98.68369082 -0.3985512  -0.94114034]
mat_Sqrt:  [[25.84786886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193967 -0.02112411  0.2677492 ]
Stock Position:  0.0019396667308267728
Bond Position:  [7.04151996]


portfolio before change:  [7.23306426]
curr_Stock_Price:  98.2973230094195
curr_Factors:  [98.29732301 -0.60161667 -0.94050316]
mat_Sqrt:  [[21.02846434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041309  0.01348466  0.05505754]
Stock Position:  -0.00041308659901854826
Bond Position:  [7.27366956]


portfolio before change:  [7.23351701]
curr_Stock_Price:  99.40243913528936
curr_Factors:  [99.40243914 -0.92195187 -0.93590107]
mat_Sqrt:  [[15.50749886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0522841   0.00620299 -2.51134632]
Stock Position:  -0.052284097333751424
Bond Position:  [12.43068382]


portfolio before change:  [7.28079369]
curr_Stock_Price:  98.52793330567805
curr_Factors:  [98.52793331 -1.01169586 -0.90248416]
mat_Sqrt:  [[14.52919494  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150419 -0.03749031 -0.11262487]
Stock Position:  -0.0015041927703409353
Bond Position:  [7.4289987]


portfolio before change:  [7.28346825]
curr_Stock_Price:  97.36725885712836
curr_Factors:  [97.36725886 -0.99378115 -0.8921331 ]
mat_Sqrt:  [[14.76966998  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00544802 0.00932429 0.08989431]
Stock Position:  0.005448015365542021
Bond Position:  [6.75300993]


portfolio before change:  [7.27736592]
curr_Stock_Price:  96.09220565396171
curr_Factors:  [96.09220565 -1.15109207 -0.87047234]
mat_Sqrt:  [[12.72723003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00219293  0.05922968 -0.15513506]
Stock Position:  0.002192933956701427
Bond Position:  [7.06664206]


portfolio before change:  [7.27862675]
curr_Stock_Price:  96.26432475738989
curr_Factors:  [96.26432476 -1.29990898 -0.85241296]
mat_Sqrt:  [[11.1872624   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01512996  0.00373055 -0.4435625 ]
Stock Position:  -0.015129963728469214
Bond Position:  [8.7351025]


portfolio before change:  [7.27342498]
curr_Stock_Price:  96.68030299646553
curr_Factors:  [96.680303   -1.38213875 -0.88990849]
mat_Sqrt:  [[ 9.96782542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00318578  0.04557421  0.30023399]
Stock Position:  -0.0031857821231505894
Bond Position:  [7.58142736]


portfolio before change:  [7.27429013]
curr_Stock_Price:  96.70622582873122
curr_Factors:  [96.70622583 -1.13585703 -0.90082854]
mat_Sqrt:  [[12.61633257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00690716  0.0271292   0.39094082]
Stock Position:  -0.006907157345174376
Bond Position:  [7.94225525]


portfolio before change:  [7.28540813]
curr_Stock_Price:  95.24033289772326
curr_Factors:  [95.2403329  -0.84778553 -0.86944123]
mat_Sqrt:  [[17.10168078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00752903 -0.02101574 -0.03000305]
Stock Position:  -0.00752902884194782
Bond Position:  [8.00247534]


portfolio before change:  [7.28773231]
curr_Stock_Price:  95.06450553815452
curr_Factors:  [95.06450554 -0.75250091 -0.88392513]
mat_Sqrt:  [[18.5066409   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00861445 0.03923598 0.13707959]
Stock Position:  0.008614448480336764
Bond Position:  [6.46880402]


portfolio before change:  [7.29680398]
curr_Stock_Price:  96.02371082543472
curr_Factors:  [96.02371083 -0.75203634 -0.90020064]
mat_Sqrt:  [[18.40013803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00668692  0.05996682  0.01052421]
Stock Position:  -0.00668692239551401
Bond Position:  [7.93890708]


portfolio before change:  [7.29478886]
curr_Stock_Price:  96.47347715616631
curr_Factors:  [96.47347716 -0.64760232 -0.90278141]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.29478886]
Stock Price:  97.54626862089896
PL:  [7.29478886]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.03958486e-01  3.84105758e-02  5.91244555e-02]
 [ 7.99923665e-03 -5.14567624e-02 -1.41155079e-01]
 [ 3.97937334e-01 -2.56288610e-02 -1.74060328e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-9.16775266e-01 -2.47040177e-01 -1.11929345e-01]
 [ 5.58796399e-04  7.93310138e-02  9.87485805e-02]
 [ 3.26415143e-03  1.58391133e-01  8.76859648e-02]
 [ 2.72222910e-01 -1.43694597e-01 -4.80150766e-02]
 [-4.71435828e-01 -2.59072379e-02 -5.39612461e-02]
 [ 3.28346817e-02  7.44928320e-03 -2.98116902e-02]
 [-4.21739960e-03 -2.59549798e-01  1.90812133e-01]
 [-1.35795058e-01  1.79185969e-02  1.04434856e-01]
 [ 7.97764758e-02 -1.36181762e-02  2.51838032e-01]
 [ 3.66127939e-02  3.48798477e-01  3.05285677e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-4.97215742e-02  7.67575490e-02  4.92881650e-02]
 [-4.71156859e-01 -2.33585559e-01  1.25430129e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 2.16961709e-01  9.79039783e-01  2.86396773e-01]
 [-1.46701411e-02 -2.29730122e-03  4.26073192e-02]
 [-7.42381934e-02  2.70605003e-01 -1.68968678e-02]
 [-2.87099991e-02  1.87998281e-03  8.64853569e-03]
 [ 1.74753964e-02 -3.09247963e-02  8.10592787e-03]
 [ 5.56946601e-02  2.32921646e-01  1.00771796e-01]
 [-6.99062302e-02 -1.51513629e-01 -1.46329898e-03]
 [ 1.18417844e-01 -2.33450306e-02 -4.78781399e-03]
 [ 3.27663021e-02 -6.67847770e-02  9.42852980e-02]
 [-5.57351519e-02  4.35000122e-02  5.83584156e-02]
 [-5.46387395e-01 -7.90776254e-03 -7.87651445e-01]
 [ 4.52316534e-02 -1.06818341e-01 -7.89906382e-02]
 [ 1.27344483e-01  7.16430705e-03 -3.52429523e-02]
 [ 2.71320786e-02  1.47716338e-01 -3.56622582e-02]
 [-1.03024942e-01 -1.09030300e-02 -1.23856856e-01]
 [-3.33024348e-02  1.46262985e-01  9.48803172e-02]
 [-2.19782556e-01  9.38985607e-02  4.44672443e-02]
 [-1.19209669e-01 -1.08961789e-01  1.04619134e-02]
 [ 1.73255446e-01  1.47350060e-01  6.41491069e-02]
 [-1.22678566e-01  2.31339418e-01  1.34558230e-02]
 [ 1.77323461e-03 -2.22701318e-01  7.28157688e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.1200194]
curr_Stock_Price:  100.52001582987234
curr_Factors:  [100.52001583  -0.83746195  -1.01863047]
mat_Sqrt:  [[15.70948155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00578619  0.01214649  0.16866561]
Stock Position:  -0.00578618712600975
Bond Position:  [6.70164702]


portfolio before change:  [6.11527207]
curr_Stock_Price:  101.48525947260963
curr_Factors:  [101.48525947  -0.62902502  -1.01795615]
mat_Sqrt:  [[19.54916141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113266 -0.01627206 -0.40267615]
Stock Position:  -0.0011326588703253352
Bond Position:  [6.23022025]


portfolio before change:  [6.11552752]
curr_Stock_Price:  101.94734263180976
curr_Factors:  [101.94734263  -0.57597639  -1.0086916 ]
mat_Sqrt:  [[20.90082104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01730773 -0.00810456 -0.49654567]
Stock Position:  0.01730772598899195
Bond Position:  [4.35105085]


portfolio before change:  [6.12264811]
curr_Stock_Price:  102.32732764786698
curr_Factors:  [102.32732765  -0.61036129  -0.99852068]
mat_Sqrt:  [[20.47684623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00096221 -0.00659539  0.21422481]
Stock Position:  0.000962211352207378
Bond Position:  [6.02418759]


portfolio before change:  [6.12398896]
curr_Stock_Price:  102.93818667707937
curr_Factors:  [102.93818668  -0.72366565  -0.9884497 ]
mat_Sqrt:  [[18.57865476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05091872 -0.07812096 -0.31930327]
Stock Position:  -0.05091871883917537
Bond Position:  [11.36546954]


portfolio before change:  [6.11644328]
curr_Stock_Price:  103.11428007143806
curr_Factors:  [103.11428007  -0.74946304  -1.03112704]
mat_Sqrt:  [[17.37874335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00130988 0.02508667 0.28170221]
Stock Position:  0.0013098808987133852
Bond Position:  [5.98137585]


portfolio before change:  [6.11650202]
curr_Stock_Price:  102.58829241263197
curr_Factors:  [102.58829241  -0.77326916  -1.00138023]
mat_Sqrt:  [[17.39311482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00145187 0.05008767 0.25014365]
Stock Position:  0.0014518742501222555
Bond Position:  [5.96755672]


portfolio before change:  [6.11816546]
curr_Stock_Price:  103.22020523232113
curr_Factors:  [103.22020523  -0.67026534  -0.97240372]
mat_Sqrt:  [[19.96928928  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01295548 -0.04544022 -0.13697365]
Stock Position:  0.012955478369158757
Bond Position:  [4.78089833]


portfolio before change:  [6.09293861]
curr_Stock_Price:  101.22687791444966
curr_Factors:  [101.22687791  -0.50630339  -0.96176119]
mat_Sqrt:  [[23.31972877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0207172  -0.00819259 -0.15393642]
Stock Position:  -0.02071720249830741
Bond Position:  [8.19007633]


portfolio before change:  [6.07212687]
curr_Stock_Price:  102.28085976620537
curr_Factors:  [102.28085977  -0.63697268  -0.95546003]
mat_Sqrt:  [[20.80700785  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129484  0.00235567 -0.08504445]
Stock Position:  0.0012948394972100844
Bond Position:  [5.93968958]


portfolio before change:  [6.07530492]
curr_Stock_Price:  104.16182072394
curr_Factors:  [104.16182072  -0.75292671  -0.93722178]
mat_Sqrt:  [[19.21703575  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00145862 -0.08207685  0.5443339 ]
Stock Position:  0.0014586233457329638
Bond Position:  [5.92337206]


portfolio before change:  [6.07446358]
curr_Stock_Price:  103.0773641533153
curr_Factors:  [103.07736415  -0.87796741  -0.95560518]
mat_Sqrt:  [[16.47604045  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00692003  0.00566636  0.29792357]
Stock Position:  -0.006920031940385763
Bond Position:  [6.78776223]


portfolio before change:  [6.07372546]
curr_Stock_Price:  103.30664571841949
curr_Factors:  [103.30664572  -1.07532051  -0.9374415 ]
mat_Sqrt:  [[13.80374179  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00947794 -0.00430645  0.71842381]
Stock Position:  0.00947794309003194
Bond Position:  [5.09459096]


portfolio before change:  [6.0657581]
curr_Stock_Price:  102.39882954960518
curr_Factors:  [102.39882955  -0.99946698  -0.96203508]
mat_Sqrt:  [[14.40208842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00749439 0.11029976 0.87089506]
Stock Position:  0.0074943929454630975
Bond Position:  [5.29834103]


portfolio before change:  [6.06637752]
curr_Stock_Price:  102.39310326027461
curr_Factors:  [102.39310326  -0.79599246  -0.94013496]
mat_Sqrt:  [[18.04181172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00237926 -0.03587186 -0.12433753]
Stock Position:  0.0023792584851289327
Bond Position:  [5.82275786]


portfolio before change:  [6.06434743]
curr_Stock_Price:  101.23392592065512
curr_Factors:  [101.23392592  -0.88469694  -0.97224499]
mat_Sqrt:  [[15.80761852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238358  0.02427287  0.14060542]
Stock Position:  -0.002383584739415306
Bond Position:  [6.30564707]


portfolio before change:  [6.0622518]
curr_Stock_Price:  102.44381604754027
curr_Factors:  [102.44381605  -0.82824186  -0.96018973]
mat_Sqrt:  [[17.13088402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02636085 -0.07386624  0.35781725]
Stock Position:  -0.026360851767949046
Bond Position:  [8.76275805]


portfolio before change:  [6.05938921]
curr_Stock_Price:  102.59396335662576
curr_Factors:  [102.59396336  -0.7831928   -0.98800573]
mat_Sqrt:  [[17.45420461  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00752318  0.00580111 -0.05715682]
Stock Position:  -0.007523177750309783
Bond Position:  [6.83122183]


portfolio before change:  [6.06445061]
curr_Stock_Price:  102.03469927434996
curr_Factors:  [102.03469927  -0.80140955  -1.0033349 ]
mat_Sqrt:  [[16.78639088  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01791337 0.30959956 0.81701028]
Stock Position:  0.017913374344460595
Bond Position:  [4.23666484]


portfolio before change:  [6.04556299]
curr_Stock_Price:  100.95074766331447
curr_Factors:  [100.95074766  -0.74331922  -1.00053822]
mat_Sqrt:  [[17.65069759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034176 -0.00072647  0.12154682]
Stock Position:  -0.00034175842149347625
Bond Position:  [6.08006376]


portfolio before change:  [6.04649627]
curr_Stock_Price:  100.44387708233737
curr_Factors:  [100.44387708  -0.27503687  -1.0296282 ]
mat_Sqrt:  [[27.24674492  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259481  0.08557282 -0.04820206]
Stock Position:  -0.002594814945161356
Bond Position:  [6.30712955]


portfolio before change:  [6.05409229]
curr_Stock_Price:  97.82034755122743
curr_Factors:  [97.82034755 -0.32792598 -1.00659363]
mat_Sqrt:  [[25.75459362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104432  0.0005945   0.02467187]
Stock Position:  -0.001044321784143895
Bond Position:  [6.15624821]


portfolio before change:  [6.0536125]
curr_Stock_Price:  99.01668674888968
curr_Factors:  [99.01668675 -0.52608894 -0.98763676]
mat_Sqrt:  [[21.79243063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084119 -0.00977928  0.02312396]
Stock Position:  0.0008411882764218507
Bond Position:  [5.97032083]


portfolio before change:  [6.05512542]
curr_Stock_Price:  99.92798576904087
curr_Factors:  [99.92798577 -0.60641888 -1.00635113]
mat_Sqrt:  [[19.91911401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00413064 0.07365629 0.28747388]
Stock Position:  0.0041306369276088006
Bond Position:  [5.64235919]


portfolio before change:  [6.05488973]
curr_Stock_Price:  99.70016991722983
curr_Factors:  [99.70016992 -0.65904804 -1.01870291]
mat_Sqrt:  [[18.62335484  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00397979 -0.04791282 -0.00417438]
Stock Position:  -0.003979787238436919
Bond Position:  [6.45167519]


portfolio before change:  [6.05998957]
curr_Stock_Price:  98.62138702596249
curr_Factors:  [98.62138703 -0.68183853 -1.01730556]
mat_Sqrt:  [[18.03192952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00647949 -0.00738235 -0.0136583 ]
Stock Position:  0.0064794934705895086
Bond Position:  [5.42097293]


portfolio before change:  [6.06057825]
curr_Stock_Price:  98.6076538517846
curr_Factors:  [98.60765385 -0.51566231 -0.99857374]
mat_Sqrt:  [[21.69133404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00231834 -0.0211192   0.26896971]
Stock Position:  0.002318337465852468
Bond Position:  [5.83197243]


portfolio before change:  [6.05739138]
curr_Stock_Price:  96.91855114872668
curr_Factors:  [96.91855115 -0.42025653 -0.98805122]
mat_Sqrt:  [[23.70208916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180151  0.01375591  0.16648032]
Stock Position:  -0.0018015131258509822
Bond Position:  [6.23199142]


portfolio before change:  [6.05816186]
curr_Stock_Price:  96.92330397231295
curr_Factors:  [96.92330397 -0.60826543 -0.9717146 ]
mat_Sqrt:  [[19.96418572  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03543196 -0.00250065 -2.24695033]
Stock Position:  -0.03543196104782992
Bond Position:  [9.49234459]


portfolio before change:  [6.02884656]
curr_Stock_Price:  97.78416303895625
curr_Factors:  [97.78416304 -0.58362087 -0.99609316]
mat_Sqrt:  [[20.14686319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00130788 -0.03377893 -0.2253383 ]
Stock Position:  0.0013078819737698559
Bond Position:  [5.90095641]


portfolio before change:  [6.02871561]
curr_Stock_Price:  97.12002414100807
curr_Factors:  [97.12002414 -0.58543487 -1.02482634]
mat_Sqrt:  [[19.40801964  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0062003   0.00226555 -0.10053833]
Stock Position:  0.006200299097196782
Bond Position:  [5.42654241]


portfolio before change:  [6.02968593]
curr_Stock_Price:  97.16711203336651
curr_Factors:  [97.16711203 -0.30697286 -1.04455237]
mat_Sqrt:  [[25.15123675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094097  0.04671201 -0.1017345 ]
Stock Position:  0.0009409704300757287
Bond Position:  [5.93825455]


portfolio before change:  [6.03128139]
curr_Stock_Price:  98.07376715335307
curr_Factors:  [98.07376715 -0.13172749 -1.07025101]
mat_Sqrt:  [[29.48086529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00436177 -0.00344784 -0.35332913]
Stock Position:  -0.00436176586636056
Bond Position:  [6.4590562]


portfolio before change:  [6.0488547]
curr_Stock_Price:  94.2299398780768
curr_Factors:  [94.22993988 -0.09982541 -1.05751141]
mat_Sqrt:  [[29.61855851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034298  0.04625242  0.27066714]
Stock Position:  -0.0003429801324361649
Bond Position:  [6.08117369]


portfolio before change:  [6.04931558]
curr_Stock_Price:  95.10260722002631
curr_Factors:  [ 9.51026072e+01 -1.08624947e-02 -1.02348238e+00]
mat_Sqrt:  [[33.80509433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00616124  0.02969333  0.12685267]
Stock Position:  -0.006161239050344012
Bond Position:  [6.63526548]


portfolio before change:  [6.04678121]
curr_Stock_Price:  95.64857337542996
curr_Factors:  [ 9.56485734e+01 -1.09605618e-02 -1.03193736e+00]
mat_Sqrt:  [[33.70960662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355648 -0.03445674  0.02984493]
Stock Position:  -0.003556479376022179
Bond Position:  [6.38695339]


portfolio before change:  [6.05232593]
curr_Stock_Price:  94.31402331751943
curr_Factors:  [94.31402332 -0.18197957 -1.01229873]
mat_Sqrt:  [[28.56983927  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00665577 0.04659618 0.18299955]
Stock Position:  0.006655773882773234
Bond Position:  [5.42459312]


portfolio before change:  [6.06254368]
curr_Stock_Price:  95.74730977990833
curr_Factors:  [95.74730978 -0.34699016 -1.00581394]
mat_Sqrt:  [[24.75205296  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460401  0.07315595  0.03838572]
Stock Position:  -0.00460401202196847
Bond Position:  [6.50336545]


portfolio before change:  [6.05806542]
curr_Stock_Price:  96.89657465052386
curr_Factors:  [96.89657465 -0.32450016 -0.97936305]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.05806542]
Stock Price:  97.54559450002313
PL:  [6.05806542]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.43334507e-02  1.48585482e-03  1.98041918e-02]
 [-2.14807721e-02 -4.76860591e-03 -5.79443952e-02]
 [ 2.36476240e-01 -7.56726636e-02 -1.62422394e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-9.94855123e-01 -2.94953300e-01  2.83418868e-02]
 [-3.09690744e-02 -4.49651326e-02 -3.64521424e-02]
 [ 3.30240251e-02  4.99624030e-02 -1.61416851e-02]
 [ 3.30861620e-01 -1.10884148e-02 -8.33702849e-02]
 [-4.38439658e-01 -1.87989408e-02 -6.92113446e-02]
 [ 6.29807860e-02 -3.57791536e-02 -8.35437844e-02]
 [ 4.15098586e-02 -3.03579062e-01  5.99970002e-02]
 [-5.52772625e-02  3.54051643e-03  3.75405984e-02]
 [ 1.25294427e-01 -3.77234038e-02  2.85979470e-01]
 [ 5.90474547e-02  1.84016005e-01  1.40045783e-01]
 [ 6.65843298e-02 -1.13215999e-01 -4.89237634e-02]
 [-5.13001355e-02  8.06866307e-02  4.98983607e-02]
 [-4.45750322e-01 -2.32678033e-01  1.15706593e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 1.90325859e-01  9.18290951e-01  2.18823868e-01]
 [ 9.02706918e-03  1.20429460e-02  3.04623602e-02]
 [-5.18679367e-02  3.88965721e-02 -1.07929265e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 2.46159789e-01  6.04356311e-03  2.27897737e-01]
 [ 7.57147380e-02 -1.97500553e-01 -8.49349492e-02]
 [-6.25588552e-02 -1.92054101e-01  1.77127863e-01]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [ 2.60808929e-02 -6.84086764e-02  4.94866094e-02]
 [ 2.70142289e-02  4.73007111e-02 -8.13532409e-02]
 [-5.76838233e-01 -1.08593453e-02 -8.33359003e-01]
 [-9.53463649e-02 -1.14362296e-01  9.40670768e-03]
 [-6.86769199e-02  8.59735136e-02  1.87277287e-01]
 [ 1.61186247e-02  7.13962118e-02  1.02798688e-03]
 [-1.36453876e-01 -1.69704838e-02 -1.33439103e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 1.74769597e-01 -1.36276371e-01 -4.54171270e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-2.23560435e-02 -2.63068138e-02 -4.63422874e-02]
 [-9.09095849e-02  4.77315539e-03  7.37103126e-05]
 [-4.35161507e-02 -3.04450588e-01  1.45182330e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.37478447]
curr_Stock_Price:  100.41618227248227
curr_Factors:  [100.41618227  -0.97760088  -1.00426416]
mat_Sqrt:  [[13.83855225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00652182  0.00046987  0.05649585]
Stock Position:  -0.006521821842295804
Bond Position:  [6.02968092]


portfolio before change:  [5.37046448]
curr_Stock_Price:  101.1941464026502
curr_Factors:  [101.1941464   -1.08208046  -0.99527759]
mat_Sqrt:  [[12.6756504   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263748 -0.00150797 -0.16529923]
Stock Position:  -0.0026374778457262204
Bond Position:  [5.6373618]


portfolio before change:  [5.37240817]
curr_Stock_Price:  100.72438866719989
curr_Factors:  [100.72438867  -1.22486942  -1.00082305]
mat_Sqrt:  [[10.87748977  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01851236 -0.0239298  -0.46334588]
Stock Position:  0.01851236377274586
Bond Position:  [3.50776165]


portfolio before change:  [5.37158667]
curr_Stock_Price:  100.65632635158475
curr_Factors:  [100.65632635  -1.27649609  -0.98294241]
mat_Sqrt:  [[10.50943576  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0018748  -0.00659539  0.21422481]
Stock Position:  0.001874796549124421
Bond Position:  [5.18287654]


portfolio before change:  [5.37207818]
curr_Stock_Price:  100.57290926292694
curr_Factors:  [100.57290926  -1.25477121  -0.99721954]
mat_Sqrt:  [[10.57922513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09421158 -0.09327242  0.08085151]
Stock Position:  -0.09421158057576337
Bond Position:  [14.84721093]


portfolio before change:  [5.39552099]
curr_Stock_Price:  100.34377826728308
curr_Factors:  [100.34377827  -1.06032218  -1.01617873]
mat_Sqrt:  [[12.5799109   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314556 -0.01421922 -0.10398782]
Stock Position:  -0.003145557373977075
Bond Position:  [5.7111581]


portfolio before change:  [5.3962437]
curr_Stock_Price:  100.34099054118957
curr_Factors:  [100.34099054  -1.13909728  -1.02074402]
mat_Sqrt:  [[11.57367346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00268015  0.0157995  -0.04604773]
Stock Position:  0.0026801465570758117
Bond Position:  [5.12731514]


portfolio before change:  [5.39650374]
curr_Stock_Price:  100.19886473051054
curr_Factors:  [100.19886473  -1.20642926  -1.02424563]
mat_Sqrt:  [[10.76695767  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02912219 -0.00350646 -0.23783222]
Stock Position:  0.0291221940165086
Bond Position:  [2.47849296]


portfolio before change:  [5.39536163]
curr_Stock_Price:  100.14900780041054
curr_Factors:  [100.1490078  -1.2346523  -1.0381731]
mat_Sqrt:  [[10.31742023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04391144 -0.00594475 -0.1974407 ]
Stock Position:  -0.04391143726706934
Bond Position:  [9.7930485]


portfolio before change:  [5.45523029]
curr_Stock_Price:  98.81349112870953
curr_Factors:  [98.81349113 -0.9295332  -1.04592682]
mat_Sqrt:  [[13.70518367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0032837  -0.01131436 -0.23832716]
Stock Position:  0.003283696866383453
Bond Position:  [5.13075674]


portfolio before change:  [5.45862522]
curr_Stock_Price:  99.65204136804165
curr_Factors:  [99.65204137 -0.73584331 -1.06759032]
mat_Sqrt:  [[16.41590867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00279718 -0.09600013  0.17115474]
Stock Position:  0.0027971840158219925
Bond Position:  [5.17988012]


portfolio before change:  [5.46116527]
curr_Stock_Price:  100.32862366393259
curr_Factors:  [100.32862366  -0.79664807  -1.10262049]
mat_Sqrt:  [[15.01699386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00316461  0.00111961  0.10709288]
Stock Position:  -0.003164608354256512
Bond Position:  [5.77866607]


portfolio before change:  [5.45869769]
curr_Stock_Price:  101.33663435899173
curr_Factors:  [101.33663436  -1.00732405  -1.11703964]
mat_Sqrt:  [[12.11063869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01508556 -0.01192919  0.81581983]
Stock Position:  0.015085556803795655
Bond Position:  [3.92997814]


portfolio before change:  [5.47146324]
curr_Stock_Price:  102.15027820620467
curr_Factors:  [102.15027821  -0.86842483  -1.10624242]
mat_Sqrt:  [[14.17922404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00651555 0.05819097 0.39951164]
Stock Position:  0.006515550710653926
Bond Position:  [4.80589792]


portfolio before change:  [5.46859434]
curr_Stock_Price:  101.61775611315115
curr_Factors:  [101.61775611  -0.77465633  -1.09976776]
mat_Sqrt:  [[15.59256493  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00344232 -0.03580204 -0.13956588]
Stock Position:  0.0034423190909740518
Bond Position:  [5.1187936]


portfolio before change:  [5.46536744]
curr_Stock_Price:  100.49444805100907
curr_Factors:  [100.49444805  -0.83994506  -1.10132314]
mat_Sqrt:  [[14.42314614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270616  0.02551535  0.14234613]
Stock Position:  -0.0027061609910841466
Bond Position:  [5.7373216]


portfolio before change:  [5.46268312]
curr_Stock_Price:  101.75140834093172
curr_Factors:  [101.75140834  -0.74740859  -1.08644166]
mat_Sqrt:  [[16.2595823   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02633152 -0.07357925  0.3300787 ]
Stock Position:  -0.026331521029794427
Bond Position:  [8.14195246]


portfolio before change:  [5.45358423]
curr_Stock_Price:  102.13561292998014
curr_Factors:  [102.13561293  -0.84034578  -1.06868791]
mat_Sqrt:  [[15.1389029   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00867375  0.00580111 -0.05715682]
Stock Position:  -0.008673751632310111
Bond Position:  [6.33948317]


portfolio before change:  [5.45298125]
curr_Stock_Price:  102.29649669708128
curr_Factors:  [102.2964967   -0.61571546  -1.07295645]
mat_Sqrt:  [[18.90078617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01368743 0.2903891  0.62424359]
Stock Position:  0.013687434039702507
Bond Position:  [4.0528047]


portfolio before change:  [5.45288423]
curr_Stock_Price:  102.25239405078074
curr_Factors:  [102.25239405  -0.58922866  -1.05910502]
mat_Sqrt:  [[19.67031253  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00079084 0.00380831 0.08690063]
Stock Position:  0.0007908425405721681
Bond Position:  [5.37201869]


portfolio before change:  [5.45290064]
curr_Stock_Price:  101.42399193407975
curr_Factors:  [101.42399193  -0.5246273   -1.05527787]
mat_Sqrt:  [[20.89279782  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253995  0.01230018 -0.03078922]
Stock Position:  -0.002539953189947709
Bond Position:  [5.71051283]


portfolio before change:  [5.45051794]
curr_Stock_Price:  102.64313076531784
curr_Factors:  [102.64313077  -0.38606763  -1.06575316]
mat_Sqrt:  [[24.03322936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016173   0.01916992 -0.08961985]
Stock Position:  -0.0016172967477553375
Bond Position:  [5.61652234]


portfolio before change:  [5.44611474]
curr_Stock_Price:  105.79982361625746
curr_Factors:  [105.79982362  -0.45302392  -1.08531386]
mat_Sqrt:  [[22.71921568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01288932 0.00191114 0.65012881]
Stock Position:  0.012889320994798049
Bond Position:  [4.08242685]


portfolio before change:  [5.43864257]
curr_Stock_Price:  105.18051181717082
curr_Factors:  [105.18051182  -0.21372288  -1.09501765]
mat_Sqrt:  [[28.4155778   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187496 -0.06245516 -0.24229577]
Stock Position:  0.0018749582406222625
Bond Position:  [5.2414335]


portfolio before change:  [5.43356756]
curr_Stock_Price:  102.12431994833338
curr_Factors:  [102.12431995  -0.29482721  -1.09997245]
mat_Sqrt:  [[25.31485129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00123886 -0.06073284  0.50529649]
Stock Position:  -0.0012388616007520394
Bond Position:  [5.56008546]


portfolio before change:  [5.43461082]
curr_Stock_Price:  101.84324600370483
curr_Factors:  [101.843246    -0.82434908  -1.10108442]
mat_Sqrt:  [[14.85002164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00087246  0.02004328 -0.05140267]
Stock Position:  0.0008724622234858255
Bond Position:  [5.34575644]


portfolio before change:  [5.4347353]
curr_Stock_Price:  101.2199660238051
curr_Factors:  [101.21996602  -0.76863848  -1.13497011]
mat_Sqrt:  [[15.08479728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0022815  -0.02163272  0.14117152]
Stock Position:  0.002281502340701445
Bond Position:  [5.20380171]


portfolio before change:  [5.43659326]
curr_Stock_Price:  101.74920031018651
curr_Factors:  [101.74920031  -0.81845584  -1.12731378]
mat_Sqrt:  [[14.53764287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079995  0.0149578  -0.23207815]
Stock Position:  0.0007999486101845073
Bond Position:  [5.35519913]


portfolio before change:  [5.43647548]
curr_Stock_Price:  100.7651108304328
curr_Factors:  [100.76511083  -0.98183536  -1.12423919]
mat_Sqrt:  [[12.26460691  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0609255  -0.00343403 -2.37734127]
Stock Position:  -0.060925500514069676
Bond Position:  [11.57564029]


portfolio before change:  [5.48694068]
curr_Stock_Price:  99.96055191631015
curr_Factors:  [99.96055192 -0.64212726 -1.1384972 ]
mat_Sqrt:  [[16.84663903  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00572097 -0.03616453  0.02683472]
Stock Position:  -0.005720966083875486
Bond Position:  [6.05881161]


portfolio before change:  [5.48936479]
curr_Stock_Price:  99.66921776820504
curr_Factors:  [99.66921777 -0.55460311 -1.12380548]
mat_Sqrt:  [[18.60533356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151727  0.02718721  0.53424997]
Stock Position:  -0.0015172679916680433
Bond Position:  [5.64058971]


portfolio before change:  [5.49107681]
curr_Stock_Price:  99.00559024650725
curr_Factors:  [99.00559025 -0.63656274 -1.13474466]
mat_Sqrt:  [[16.84188465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00107897 0.02257746 0.00293256]
Stock Position:  0.001078970925877001
Bond Position:  [5.38425266]


portfolio before change:  [5.49211356]
curr_Stock_Price:  99.34264495818765
curr_Factors:  [99.34264496 -0.56501433 -1.13086605]
mat_Sqrt:  [[18.22318272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00900667 -0.00536654 -0.38066462]
Stock Position:  -0.009006670083344076
Bond Position:  [6.38685999]


portfolio before change:  [5.48726384]
curr_Stock_Price:  99.96975001142378
curr_Factors:  [99.96975001 -0.81276749 -1.10835117]
mat_Sqrt:  [[14.63987511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035802   0.0049611   0.16678008]
Stock Position:  -0.0035802015490456252
Bond Position:  [5.84517569]


portfolio before change:  [5.48546939]
curr_Stock_Price:  100.67505597874936
curr_Factors:  [100.67505598  -0.82611167  -1.09249859]
mat_Sqrt:  [[14.78019057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01095928 -0.04309437 -0.12956242]
Stock Position:  0.010959278422340646
Bond Position:  [4.38214342]


portfolio before change:  [5.48560564]
curr_Stock_Price:  100.63750246952632
curr_Factors:  [100.63750247  -0.94682912  -1.08874272]
mat_Sqrt:  [[13.14383894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0018649  0.00777784 0.21633947]
Stock Position:  0.001864895314071089
Bond Position:  [5.29792723]


portfolio before change:  [5.48691758]
curr_Stock_Price:  100.98586893007872
curr_Factors:  [100.98586893  -1.1260457   -1.09571394]
mat_Sqrt:  [[10.94870251  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296792 -0.00831894 -0.13220165]
Stock Position:  -0.0029679190055629553
Bond Position:  [5.78663546]


portfolio before change:  [5.48796853]
curr_Stock_Price:  100.87549733538094
curr_Factors:  [100.87549734  -0.99193509  -1.10001603]
mat_Sqrt:  [[12.45268098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0072893   0.0015094   0.00021028]
Stock Position:  -0.007289297512438163
Bond Position:  [6.22328004]


portfolio before change:  [5.48801917]
curr_Stock_Price:  100.97527658251562
curr_Factors:  [100.97527658  -0.82151691  -1.12977496]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.48801917]
Stock Price:  99.8183669431243
PL:  [5.48801917]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.02913555e-01  3.25196148e-01  3.62309307e-01]
 [-8.27474514e-02 -3.14916823e-01  3.71957977e-02]
 [ 2.50117520e-01  3.06442678e-01  4.42561615e-01]
 [ 1.03735237e-02  6.52660660e-02  1.45972655e-01]
 [-2.50797700e-01 -8.41903328e-02  4.65247388e-02]
 [ 5.97225906e-02 -2.14321144e-01 -2.88547816e-01]
 [ 3.46430230e-02 -1.00464922e-01 -1.13910117e-02]
 [ 3.74954059e-02  2.21906848e-01  3.80919289e-03]
 [-2.27241554e-01  4.95861020e-03 -7.52832063e-02]
 [ 9.90651950e-02 -2.78120444e-02  2.49155637e-02]
 [ 8.48046123e-02 -3.19252463e-01  2.84723541e-02]
 [-2.01468826e-02 -4.19610832e-02 -8.89986898e-02]
 [ 2.43559121e-01 -2.93438485e-01 -4.17601011e-02]
 [ 1.01435083e-01 -6.24751188e-02 -3.96125829e-02]
 [-1.44751398e-01  1.91250962e-01  1.45696919e-01]
 [ 1.82264755e-02 -2.51100867e-01 -5.74544282e-02]
 [-2.40804120e-01 -2.83186362e-01  4.34558220e-02]
 [-2.05961195e-01 -3.79355964e-02 -3.49869779e-02]
 [ 3.00548463e-01  1.27001164e+00  4.18851555e-01]
 [-2.21849977e-01 -3.39604465e-02  1.68675277e-01]
 [-9.19876794e-02  1.60768563e-01 -3.64605389e-02]
 [ 3.33906839e-02  1.64058101e-03  2.86137979e-02]
 [-8.49475787e-02 -4.63055996e-03 -9.56753351e-02]
 [-1.19226289e-02 -1.18981127e-01  1.11841965e-01]
 [-1.05728940e-01  8.46100306e-02 -9.09045201e-03]
 [ 1.06680452e-01 -1.03461930e-01 -1.02451086e-01]
 [ 4.91930946e-02 -5.00652025e-02  1.11401680e-01]
 [-5.97208866e-02  4.34440097e-02  6.30668029e-02]
 [-5.88108644e-01 -2.70135410e-02 -8.65105701e-01]
 [ 2.75033753e-02 -1.03498815e-01 -7.04277941e-02]
 [-4.96121327e-02  9.19270561e-02  2.30648432e-01]
 [ 2.52394071e-02  1.11379814e-01 -1.74110961e-02]
 [-1.13929375e-01 -6.83533054e-03 -4.17050974e-02]
 [-6.06405788e-02  1.14144947e-01  1.20905426e-01]
 [ 1.88166193e-01 -1.67206551e-01 -9.06046820e-02]
 [-8.33060467e-03  1.44610886e-01  7.98599866e-02]
 [ 8.20662733e-02  6.96387084e-02 -3.03919996e-02]
 [-2.47009964e-02  7.12119640e-02 -9.94990781e-03]
 [-8.72139047e-02 -1.92252179e-01  5.13993634e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.37722807]
curr_Stock_Price:  98.91810473390858
curr_Factors:  [98.91810473 -0.81290597 -0.99098133]
mat_Sqrt:  [[16.28761467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.007402    0.10283605  1.03356761]
Stock Position:  -0.007402001542698684
Bond Position:  [-4.6450361]


portfolio before change:  [-5.36593018]
curr_Stock_Price:  97.31332947579617
curr_Factors:  [97.31332948 -0.78586154 -0.98352063]
mat_Sqrt:  [[16.58591426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00502149 -0.09958544  0.10610926]
Stock Position:  -0.005021490351651212
Bond Position:  [-4.87727224]


portfolio before change:  [-5.36533389]
curr_Stock_Price:  97.07316306191072
curr_Factors:  [97.07316306 -0.42916994 -0.99254775]
mat_Sqrt:  [[23.42367496  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01487245 0.09690568 1.2625051 ]
Stock Position:  0.014872446248323058
Bond Position:  [-6.80904929]


portfolio before change:  [-5.33853664]
curr_Stock_Price:  98.93220023532884
curr_Factors:  [98.93220024 -0.58323448 -0.98336425]
mat_Sqrt:  [[20.65249294  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00202664 0.02063894 0.41641935]
Stock Position:  0.002026642967131701
Bond Position:  [-5.53903689]


portfolio before change:  [-5.33765209]
curr_Stock_Price:  99.71032274497311
curr_Factors:  [99.71032274 -0.42911535 -0.97869035]
mat_Sqrt:  [[24.39708126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00997966 -0.02662332  0.13272213]
Stock Position:  -0.009979663536742697
Bond Position:  [-4.34257662]


portfolio before change:  [-5.32266847]
curr_Stock_Price:  98.15451117118141
curr_Factors:  [98.15451117 -0.3463647  -0.97891357]
mat_Sqrt:  [[26.08250054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.80608978e-04 -6.77742967e-02 -8.23146602e-01]
Stock Position:  -0.0001806089778211851
Bond Position:  [-5.30494088]


portfolio before change:  [-5.32351026]
curr_Stock_Price:  99.1435543840233
curr_Factors:  [99.14355438 -0.22161587 -0.9867009 ]
mat_Sqrt:  [[29.61414353  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0010037  -0.0317698  -0.03249539]
Stock Position:  0.0010037045064980792
Bond Position:  [-5.42302109]


portfolio before change:  [-5.32598803]
curr_Stock_Price:  97.35034419437875
curr_Factors:  [97.35034419 -0.30891306 -0.98134113]
mat_Sqrt:  [[26.79089461  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00164244 0.07017311 0.01086657]
Stock Position:  0.0016424447543829626
Bond Position:  [-5.48588059]


portfolio before change:  [-5.32478872]
curr_Stock_Price:  98.49807724038587
curr_Factors:  [98.49807724 -0.509574   -0.96629039]
mat_Sqrt:  [[22.5147949   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01076984  0.00156805 -0.21476203]
Stock Position:  -0.010769835787546615
Bond Position:  [-4.2639806]


portfolio before change:  [-5.32644079]
curr_Stock_Price:  98.60198192370856
curr_Factors:  [98.60198192 -0.34693842 -0.98388125]
mat_Sqrt:  [[26.0566157   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00396955 -0.00879494  0.07107717]
Stock Position:  0.003969546945529544
Bond Position:  [-5.71784598]


portfolio before change:  [-5.32663886]
curr_Stock_Price:  98.73214887407262
curr_Factors:  [98.73214887 -0.53640815 -1.01013759]
mat_Sqrt:  [[21.02821015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00391728 -0.10095649  0.0812237 ]
Stock Position:  0.003917282715735937
Bond Position:  [-5.7134006]


portfolio before change:  [-5.32736854]
curr_Stock_Price:  98.72820191889286
curr_Factors:  [98.72820192 -0.39321601 -1.01317611]
mat_Sqrt:  [[24.19094821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162859 -0.01326926 -0.25388849]
Stock Position:  -0.0016285882720833164
Bond Position:  [-5.16658095]


portfolio before change:  [-5.32528256]
curr_Stock_Price:  97.05077079888841
curr_Factors:  [97.0507708  -0.49446464 -1.01429827]
mat_Sqrt:  [[21.46602268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0105962  -0.0927934  -0.11912994]
Stock Position:  0.010596202681747284
Bond Position:  [-6.3536522]


portfolio before change:  [-5.32031023]
curr_Stock_Price:  97.59498358776916
curr_Factors:  [97.59498359 -0.65109071 -1.03500583]
mat_Sqrt:  [[18.07861147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00507429 -0.01975637 -0.11300367]
Stock Position:  0.005074288926137397
Bond Position:  [-5.81553537]


portfolio before change:  [-5.32363775]
curr_Stock_Price:  97.08249139399022
curr_Factors:  [97.08249139 -0.7813824  -1.01933942]
mat_Sqrt:  [[16.03604866  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0068641   0.06047886  0.41563276]
Stock Position:  -0.006864101169706646
Bond Position:  [-4.6572537]


portfolio before change:  [-5.3259849]
curr_Stock_Price:  97.339620933964
curr_Factors:  [97.33962093 -0.83084838 -0.99117702]
mat_Sqrt:  [[15.73961388  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.68445007e-07 -7.94050661e-02 -1.63901491e-01]
Stock Position:  9.684450067191554e-07
Bond Position:  [-5.32607917]


portfolio before change:  [-5.32665039]
curr_Stock_Price:  97.66528377544603
curr_Factors:  [97.66528378 -0.78442822 -0.99238133]
mat_Sqrt:  [[16.52272342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01447979 -0.08955139  0.12396736]
Stock Position:  -0.014479790758678902
Bond Position:  [-3.91247752]


portfolio before change:  [-5.33896446]
curr_Stock_Price:  98.48193776637217
curr_Factors:  [98.48193777 -0.85541542 -1.0088643 ]
mat_Sqrt:  [[15.26547039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01402396 -0.01199629 -0.09980811]
Stock Position:  -0.014023961891174153
Bond Position:  [-3.95785752]


portfolio before change:  [-5.34106379]
curr_Stock_Price:  98.59635375679895
curr_Factors:  [98.59635376 -0.77217717 -0.98059615]
mat_Sqrt:  [[17.08602638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02451347 0.40161294 1.1948669 ]
Stock Position:  0.024513466683724696
Bond Position:  [-7.75800222]


portfolio before change:  [-5.33821149]
curr_Stock_Price:  98.75227263090665
curr_Factors:  [98.75227263 -0.70718266 -0.98201357]
mat_Sqrt:  [[18.2363742   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01032531 -0.01073924  0.48118362]
Stock Position:  -0.010325305543048162
Bond Position:  [-4.3185641]


portfolio before change:  [-5.32676763]
curr_Stock_Price:  97.59165737421763
curr_Factors:  [97.59165737 -1.0248192  -0.95097923]
mat_Sqrt:  [[13.53113843  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00704147  0.05083948 -0.10401177]
Stock Position:  -0.007041471773642284
Bond Position:  [-4.63957873]


portfolio before change:  [-5.32930795]
curr_Stock_Price:  97.8700552493688
curr_Factors:  [97.87005525 -0.84051207 -0.96699737]
mat_Sqrt:  [[16.05678007  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00244593 0.0005188  0.0816272 ]
Stock Position:  0.0024459331401542514
Bond Position:  [-5.56869156]


portfolio before change:  [-5.3316603]
curr_Stock_Price:  97.19292022298927
curr_Factors:  [97.19292022 -1.0065962  -0.94459734]
mat_Sqrt:  [[13.81153807  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00757315 -0.00146431 -0.2729351 ]
Stock Position:  -0.007573145344222248
Bond Position:  [-4.59560419]


portfolio before change:  [-5.33170506]
curr_Stock_Price:  97.12297176678634
curr_Factors:  [97.12297177 -0.96743638 -0.94527674]
mat_Sqrt:  [[14.34303992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00054625 -0.03762514  0.31905399]
Stock Position:  0.0005462535882138653
Bond Position:  [-5.38475883]


portfolio before change:  [-5.33274094]
curr_Stock_Price:  96.4589145588941
curr_Factors:  [96.45891456 -0.82222394 -0.94385444]
mat_Sqrt:  [[16.49469444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00638993  0.02675604 -0.02593253]
Stock Position:  -0.006389927378426555
Bond Position:  [-4.71637548]


portfolio before change:  [-5.33325125]
curr_Stock_Price:  96.44650850202797
curr_Factors:  [96.4465085  -0.86155377 -0.96019499]
mat_Sqrt:  [[15.59951419  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00532685 -0.03271753 -0.29226443]
Stock Position:  0.005326854079915716
Bond Position:  [-5.84700773]


portfolio before change:  [-5.33698197]
curr_Stock_Price:  95.88336247354351
curr_Factors:  [95.88336247 -0.7509858  -0.91784866]
mat_Sqrt:  [[18.0708116   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00390908 -0.01583201  0.31779798]
Stock Position:  0.003909076737843986
Bond Position:  [-5.71179739]


portfolio before change:  [-5.33428201]
curr_Stock_Price:  96.75671010054765
curr_Factors:  [96.7567101  -0.62226264 -0.90223856]
mat_Sqrt:  [[21.06680299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217051  0.0137382   0.17991203]
Stock Position:  -0.0021705101550960992
Bond Position:  [-5.12427058]


portfolio before change:  [-5.33569564]
curr_Stock_Price:  97.11287366299435
curr_Factors:  [97.11287366 -0.38966291 -0.94925899]
mat_Sqrt:  [[25.45601483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03006736 -0.00854243 -2.46790577]
Stock Position:  -0.030067357258286284
Bond Position:  [-2.41576817]


portfolio before change:  [-5.36361289]
curr_Stock_Price:  98.03132046485263
curr_Factors:  [98.03132046 -0.38367602 -0.92231802]
mat_Sqrt:  [[26.55698996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00039368 -0.0327292  -0.20091089]
Stock Position:  0.00039368294953156136
Bond Position:  [-5.40220615]


portfolio before change:  [-5.36326436]
curr_Stock_Price:  100.63202351121873
curr_Factors:  [100.63202351  -0.5584942   -0.90702539]
mat_Sqrt:  [[23.24176643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.78400831e-06  2.90698876e-02  6.57975775e-01]
Stock Position:  -6.784008312554858e-06
Bond Position:  [-5.36258167]


portfolio before change:  [-5.36395437]
curr_Stock_Price:  103.52794415091437
curr_Factors:  [103.52794415  -0.40080462  -0.93068499]
mat_Sqrt:  [[27.34003075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00089836  0.03522139 -0.04966901]
Stock Position:  0.0008983602347912357
Bond Position:  [-5.45695976]


portfolio before change:  [-5.36327247]
curr_Stock_Price:  105.04633762764281
curr_Factors:  [105.04633763  -0.52328754  -0.94515415]
mat_Sqrt:  [[24.19049688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00506889 -0.00216152 -0.11897303]
Stock Position:  -0.005068886386417422
Bond Position:  [-4.83080452]


portfolio before change:  [-5.35799082]
curr_Stock_Price:  103.8852261038851
curr_Factors:  [103.8852261   -0.46187904  -0.96918969]
mat_Sqrt:  [[24.83410652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132937  0.0360958   0.34490953]
Stock Position:  -0.0013293674208319057
Bond Position:  [-5.21988918]


portfolio before change:  [-5.35893407]
curr_Stock_Price:  104.10392137393703
curr_Factors:  [104.10392137  -0.36563893  -0.96266569]
mat_Sqrt:  [[27.57983856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00599548 -0.05287535 -0.25846994]
Stock Position:  0.0059954787314762436
Bond Position:  [-5.98308691]


portfolio before change:  [-5.36608994]
curr_Stock_Price:  103.03512557332222
curr_Factors:  [103.03512557  -0.21037723  -0.94541298]
mat_Sqrt:  [[32.43635127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00036085 0.04572998 0.22781831]
Stock Position:  0.00036084773384606445
Bond Position:  [-5.40326994]


portfolio before change:  [-5.36655738]
curr_Stock_Price:  103.61157922606533
curr_Factors:  [103.61157923  -0.1859707   -0.96507616]
mat_Sqrt:  [[32.77290896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00236966  0.02202169 -0.08669992]
Stock Position:  0.0023696583111403415
Bond Position:  [-5.61208142]


portfolio before change:  [-5.36749785]
curr_Stock_Price:  103.51075807544154
curr_Factors:  [ 1.03510758e+02 -1.02920966e-01 -9.56362323e-01]
mat_Sqrt:  [[35.88761537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069365  0.0225192  -0.02838432]
Stock Position:  -0.0006936467516021122
Bond Position:  [-5.29569795]


portfolio before change:  [-5.36845817]
curr_Stock_Price:  103.94083056628001
curr_Factors:  [ 1.03940831e+02 -2.99449531e-02 -9.33043106e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.36845817]
Stock Price:  103.16368355853523
PL:  [-8.53214173]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-8.71111660e-02 -8.04230740e-03  3.89951507e-03]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.70106823e-01 -1.20433180e-01 -2.52907208e-01]
 [-8.79140821e-03  1.13895556e-02  1.05768593e-01]
 [-5.75568120e-01 -1.76185353e-01  3.85881840e-02]
 [-3.21805329e-02 -4.26413693e-02 -3.29281266e-02]
 [ 2.31610513e-02  9.49859001e-02  2.36351699e-02]
 [ 2.76998049e-01 -9.91526205e-02 -5.42707287e-02]
 [-4.65408335e-01 -2.65112754e-02 -4.87363237e-02]
 [ 6.17603778e-02 -3.72293166e-02 -6.94546074e-02]
 [ 2.76908653e-02 -2.98528965e-01  9.70955874e-02]
 [-2.76882015e-02 -3.02713951e-05  2.25364158e-02]
 [ 1.41683164e-01 -6.00903335e-02  2.79788247e-01]
 [ 8.99372304e-02 -6.39153592e-02 -4.98590299e-02]
 [ 6.32940774e-02 -1.13277392e-01 -4.74393673e-02]
 [-4.94608599e-02  7.61086241e-02  4.91873854e-02]
 [-4.43416885e-01 -2.25376676e-01  1.14041455e-01]
 [-1.32223198e-01  1.80505453e-02 -1.62658052e-02]
 [ 2.23076553e-01  1.04954319e+00  2.68967966e-01]
 [ 1.34824300e-02  7.58696146e-03  3.11260503e-02]
 [-3.84312233e-02 -8.19449867e-02  1.01026713e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.98977939e-01 -1.51045718e-02  1.93791365e-01]
 [ 8.35943641e-02 -6.82286163e-02 -5.60973079e-02]
 [-8.54453859e-02  7.27244815e-03  1.38694938e-01]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [ 1.09914452e-02 -6.56751825e-02 -1.29768183e-02]
 [ 2.96066235e-02  4.73614536e-02 -7.63558376e-02]
 [-6.40547942e-01 -6.30538743e-02 -9.74298585e-01]
 [-2.49877953e-01  9.44928687e-02  3.71039719e-03]
 [-2.77601365e-02  6.44573091e-03  1.13033162e-01]
 [ 1.86644127e-02  6.53437129e-02  4.73631555e-03]
 [-1.24871840e-01 -1.17590159e-02 -8.62697297e-02]
 [-6.12527336e-02  9.94877154e-02  1.11609694e-01]
 [ 1.96554496e-01 -1.68328591e-01 -8.62370485e-02]
 [-1.32907139e-02  1.80198433e-01  8.10531515e-02]
 [ 6.41534030e-02  5.79740955e-02 -3.52411653e-02]
 [-5.59132234e-02  9.41460747e-02 -6.76378270e-03]
 [-7.44722304e-02 -2.25711272e-01  8.08627914e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.67730071]
curr_Stock_Price:  100.73699178212507
curr_Factors:  [100.73699178  -1.09905717  -1.01862399]
mat_Sqrt:  [[12.11969614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00713903 -0.0025432   0.01112423]
Stock Position:  -0.0071390265320627755
Bond Position:  [8.39646477]


portfolio before change:  [7.67912423]
curr_Stock_Price:  100.6285886389915
curr_Factors:  [100.62858864  -1.24894352  -1.05475653]
mat_Sqrt:  [[10.05164552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00451479  0.01411938  0.0859571 ]
Stock Position:  -0.004514787431295091
Bond Position:  [8.13344091]


portfolio before change:  [7.67750455]
curr_Stock_Price:  101.21254008874146
curr_Factors:  [101.21254009  -1.0059373   -1.07339825]
mat_Sqrt:  [[12.65290851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0170216  -0.03808432 -0.72147387]
Stock Position:  0.01702160286741394
Bond Position:  [5.95470489]


portfolio before change:  [7.66356732]
curr_Stock_Price:  100.35001161919322
curr_Factors:  [100.35001162  -0.80244284  -1.07053317]
mat_Sqrt:  [[15.42035178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00084905 0.00360169 0.30172836]
Stock Position:  0.0008490462969248273
Bond Position:  [7.57836552]


portfolio before change:  [7.6647704]
curr_Stock_Price:  100.65120264103567
curr_Factors:  [100.65120264  -0.68379685  -1.0763648 ]
mat_Sqrt:  [[17.31372349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03305126 -0.0557147   0.11008135]
Stock Position:  -0.03305126284175555
Bond Position:  [10.99141976]


portfolio before change:  [7.67034693]
curr_Stock_Price:  100.5240511958894
curr_Factors:  [100.5240512   -0.88432027  -1.06098951]
mat_Sqrt:  [[14.36920304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00278394 -0.01348438 -0.09393478]
Stock Position:  -0.0027839368593604087
Bond Position:  [7.95019954]


portfolio before change:  [7.6694734]
curr_Stock_Price:  101.19481522415838
curr_Factors:  [101.19481522  -0.85762511  -1.04307675]
mat_Sqrt:  [[15.12494945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00201244 0.03003718 0.06742456]
Stock Position:  0.0020124421318970806
Bond Position:  [7.46582469]


portfolio before change:  [7.67022393]
curr_Stock_Price:  101.10399906770081
curr_Factors:  [101.10399907  -0.8212153   -1.03909197]
mat_Sqrt:  [[15.73429015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01673796 -0.03135481 -0.15481928]
Stock Position:  0.016737963413150307
Bond Position:  [5.97794889]


portfolio before change:  [7.66133156]
curr_Stock_Price:  100.52808309914784
curr_Factors:  [100.5280831   -0.66394878  -1.04100491]
mat_Sqrt:  [[18.2740758   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02605008 -0.0083836  -0.13903117]
Stock Position:  -0.026050078728981588
Bond Position:  [10.28009604]


portfolio before change:  [7.69333378]
curr_Stock_Price:  99.34892631844691
curr_Factors:  [99.34892632 -0.72933287 -1.00789604]
mat_Sqrt:  [[17.48615193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00266621 -0.01177294 -0.19813466]
Stock Position:  0.002666210311023476
Bond Position:  [7.42844864]


portfolio before change:  [7.69672948]
curr_Stock_Price:  100.27424433630053
curr_Factors:  [100.27424434  -0.81796359  -1.02351158]
mat_Sqrt:  [[15.9018222   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00250301 -0.09440315  0.27698668]
Stock Position:  0.0025030109022648856
Bond Position:  [7.44574196]


portfolio before change:  [7.69720266]
curr_Stock_Price:  100.09142562369422
curr_Factors:  [100.09142562  -0.68232333  -1.0077252 ]
mat_Sqrt:  [[18.46792593  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.25020842e-03 -9.57265563e-06  6.42901214e-02]
Stock Position:  -0.001250208419474975
Bond Position:  [7.8223378]


portfolio before change:  [7.69747687]
curr_Stock_Price:  100.65424884931595
curr_Factors:  [100.65424885  -0.7029996   -1.04812259]
mat_Sqrt:  [[17.47146842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01128944 -0.01900223  0.79815799]
Stock Position:  0.011289444635191138
Bond Position:  [6.5611463]


portfolio before change:  [7.67923076]
curr_Stock_Price:  98.96538740779586
curr_Factors:  [98.96538741 -0.57733474 -1.05362098]
mat_Sqrt:  [[19.37172345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00403214 -0.02021181 -0.14223393]
Stock Position:  0.00403214051875083
Bond Position:  [7.28018841]


portfolio before change:  [7.69145801]
curr_Stock_Price:  101.77212933056128
curr_Factors:  [101.77212933  -0.57191401  -1.09438023]
mat_Sqrt:  [[19.22943251  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00263584 -0.03582146 -0.13533131]
Stock Position:  0.0026358420806571934
Bond Position:  [7.42320275]


portfolio before change:  [7.69065667]
curr_Stock_Price:  101.11605562730243
curr_Factors:  [101.11605563  -0.67540642  -1.08574059]
mat_Sqrt:  [[17.37655556  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215551  0.02406766  0.14031792]
Stock Position:  -0.0021555141100920057
Bond Position:  [7.90861375]


portfolio before change:  [7.68916761]
curr_Stock_Price:  102.26552523400669
curr_Factors:  [102.26552523  -0.66087811  -1.06879462]
mat_Sqrt:  [[18.1360177   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02348682 -0.07127036  0.32532853]
Stock Position:  -0.02348682487548014
Bond Position:  [10.09106009]


portfolio before change:  [7.70272388]
curr_Stock_Price:  101.74204829236406
curr_Factors:  [101.74204829  -0.54300283  -1.06018269]
mat_Sqrt:  [[20.47603429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00659685  0.00570808 -0.04640181]
Stock Position:  -0.006596852522572408
Bond Position:  [8.37390117]


portfolio before change:  [7.7076894]
curr_Stock_Price:  101.14802020409422
curr_Factors:  [101.1480202   -0.58000108  -1.04261358]
mat_Sqrt:  [[19.96479219  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01528083 0.3318947  0.76729074]
Stock Position:  0.015280825127001985
Bond Position:  [6.16206419]


portfolio before change:  [7.71856216]
curr_Stock_Price:  101.80914031704467
curr_Factors:  [101.80914032  -0.60285916  -1.06198638]
mat_Sqrt:  [[19.26431369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00103985 0.00239921 0.08879396]
Stock Position:  0.0010398451367365936
Bond Position:  [7.61269642]


portfolio before change:  [7.71996747]
curr_Stock_Price:  102.24541179090069
curr_Factors:  [102.24541179  -0.50094553  -1.03104865]
mat_Sqrt:  [[22.0956717   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174174 -0.02591328  0.02882011]
Stock Position:  -0.001741736352616916
Bond Position:  [7.89805202]


portfolio before change:  [7.71717685]
curr_Stock_Price:  104.4144736465983
curr_Factors:  [104.41447365  -0.66144448  -1.04065658]
mat_Sqrt:  [[19.03476877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204199  0.01916992 -0.08961985]
Stock Position:  -0.0020419929529862805
Bond Position:  [7.93039047]


portfolio before change:  [7.7184309]
curr_Stock_Price:  104.28582990585599
curr_Factors:  [104.28582991  -0.5921073   -1.06232355]
mat_Sqrt:  [[19.93953904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01194338 -0.00477649  0.55283282]
Stock Position:  0.011943377263186604
Bond Position:  [6.47290589]


portfolio before change:  [7.7082486]
curr_Stock_Price:  103.36553240847347
curr_Factors:  [103.36553241  -0.52160559  -1.0419205 ]
mat_Sqrt:  [[21.64437217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00325174 -0.02157578 -0.16003001]
Stock Position:  0.0032517410644925765
Bond Position:  [7.37213066]


portfolio before change:  [7.70938828]
curr_Stock_Price:  103.43260554389566
curr_Factors:  [103.43260554  -0.91321749  -1.04275566]
mat_Sqrt:  [[14.62814044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389295  0.00229975  0.39565805]
Stock Position:  -0.0038929504863947717
Bond Position:  [8.11204629]


portfolio before change:  [7.71347782]
curr_Stock_Price:  102.64259646184662
curr_Factors:  [102.64259646  -0.92076922  -1.03734914]
mat_Sqrt:  [[14.48530459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00089443  0.02004328 -0.05140267]
Stock Position:  0.0008944294422053898
Bond Position:  [7.62167126]


portfolio before change:  [7.71449847]
curr_Stock_Price:  102.71849842412121
curr_Factors:  [102.71849842  -0.79750977  -1.03857242]
mat_Sqrt:  [[16.37752613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040585 -0.02076832 -0.03701925]
Stock Position:  0.0004058511198624612
Bond Position:  [7.67281006]


portfolio before change:  [7.71511211]
curr_Stock_Price:  101.86714462187037
curr_Factors:  [101.86714462  -0.71947078  -1.03431042]
mat_Sqrt:  [[17.63504754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00086438  0.01497701 -0.21782195]
Stock Position:  0.0008643821820772855
Bond Position:  [7.62705997]


portfolio before change:  [7.71551631]
curr_Stock_Price:  101.23172843805901
curr_Factors:  [101.23172844  -0.82880239  -1.02972076]
mat_Sqrt:  [[15.78230045  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05329095 -0.01993939 -2.77940267]
Stock Position:  -0.05329095429841589
Bond Position:  [13.11025173]


portfolio before change:  [7.6313462]
curr_Stock_Price:  102.84192656189636
curr_Factors:  [102.84192656  -0.92841513  -1.06046757]
mat_Sqrt:  [[14.07373672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01752774  0.02988127  0.01058473]
Stock Position:  -0.017527738421873607
Bond Position:  [9.43393259]


portfolio before change:  [7.62576413]
curr_Stock_Price:  103.22768029524151
curr_Factors:  [103.2276803   -1.08845921  -1.04395759]
mat_Sqrt:  [[12.23768629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036943  0.00203832  0.32245215]
Stock Position:  -0.000369425290197071
Bond Position:  [7.66389904]


portfolio before change:  [7.62651832]
curr_Stock_Price:  103.77948672726615
curr_Factors:  [103.77948673  -0.85416912  -1.05034762]
mat_Sqrt:  [[15.45220309  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00137963 0.0206635  0.01351139]
Stock Position:  0.0013796334624465497
Bond Position:  [7.48334067]


portfolio before change:  [7.62732676]
curr_Stock_Price:  103.68740405559232
curr_Factors:  [103.68740406  -0.94295789  -1.03520546]
mat_Sqrt:  [[14.34235848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00995549 -0.00371853 -0.24610353]
Stock Position:  -0.009955488928755895
Bond Position:  [8.65958556]


portfolio before change:  [7.62451217]
curr_Stock_Price:  104.07885723445162
curr_Factors:  [104.07885723  -0.86683677  -1.03453322]
mat_Sqrt:  [[15.54561911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230944  0.03146078  0.31839139]
Stock Position:  -0.0023094441138009148
Bond Position:  [7.86487647]


portfolio before change:  [7.62650645]
curr_Stock_Price:  103.64104130905316
curr_Factors:  [103.64104131  -0.87541163  -1.00876122]
mat_Sqrt:  [[15.74874292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01108693 -0.05323017 -0.2460103 ]
Stock Position:  0.011086929769544625
Bond Position:  [6.4774455]


portfolio before change:  [7.63100678]
curr_Stock_Price:  103.97391931047204
curr_Factors:  [103.97391931  -0.7386443   -1.03004713]
mat_Sqrt:  [[17.73337861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00044588 0.05698375 0.23122208]
Stock Position:  0.00044587639446813323
Bond Position:  [7.58464726]


portfolio before change:  [7.63226602]
curr_Stock_Price:  104.67165609496256
curr_Factors:  [104.67165609  -0.82986007  -1.04834876]
mat_Sqrt:  [[16.00049289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00365343  0.01833302 -0.10053324]
Stock Position:  0.0036534321377953614
Bond Position:  [7.24985523]


portfolio before change:  [7.62788078]
curr_Stock_Price:  103.22328487417093
curr_Factors:  [103.22328487  -0.77611722  -1.03983361]
mat_Sqrt:  [[16.79268928  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00326708  0.0297716  -0.01929519]
Stock Position:  -0.0032670784687718122
Bond Position:  [7.96511935]


portfolio before change:  [7.62672541]
curr_Stock_Price:  103.88169544019065
curr_Factors:  [103.88169544  -0.9870292   -1.03682709]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.62672541]
Stock Price:  103.84807917345563
PL:  [3.77864623]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.94130567e-02  8.98442156e-02  2.54616553e-02]
 [-7.32198180e-02  8.20765935e-02  1.79944475e-01]
 [ 3.01604259e-01 -2.76224991e-01 -5.16068595e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-8.44893742e-01 -2.52474985e-01  3.20065577e-02]
 [ 4.42944853e-03 -1.12864928e-01 -1.39423028e-01]
 [ 2.99938701e-02 -1.59233309e-01 -2.19627698e-02]
 [ 2.30460674e-01  7.19453778e-02 -5.38638129e-02]
 [-4.58156455e-01 -2.13258734e-02 -6.73434263e-02]
 [ 1.95155461e-02  3.00770625e-02 -1.92084476e-02]
 [-3.32688197e-02 -1.63233400e-01  8.76718968e-02]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.33878386e-01 -4.60633700e-02  2.92446256e-01]
 [ 5.31186223e-02  1.69510033e-01  1.21369885e-01]
 [ 8.27021752e-02 -1.12915254e-01 -5.61953230e-02]
 [-4.27777959e-02  5.94742978e-02  4.66040350e-02]
 [-4.66995538e-01 -2.51948401e-01  1.25817639e-01]
 [-1.30412748e-01  1.81681622e-02 -1.77731274e-02]
 [ 3.30438725e-01  1.31412869e+00  5.33734582e-01]
 [ 4.73603121e-04  4.61685535e-03  4.03621780e-02]
 [-9.08378087e-02  1.26548974e-01 -3.80003466e-02]
 [ 7.21548346e-03  3.12984011e-02  1.26450956e-03]
 [ 2.95276339e-02 -3.13618173e-02  4.47796724e-02]
 [ 3.88500112e-02  1.15428654e-01  9.35317419e-02]
 [-6.04857594e-02 -1.60243516e-01 -5.85948415e-02]
 [ 1.01704733e-01  1.14014917e-03 -1.04915122e-02]
 [ 2.83603712e-02 -6.78549865e-02  6.47613125e-02]
 [ 3.54137713e-03  4.22289079e-02 -5.93100526e-02]
 [-6.18985701e-01  1.00432235e-02 -8.72020961e-01]
 [-3.57507407e-02 -1.10284163e-01 -2.94115711e-02]
 [-6.95060889e-02  9.21068686e-02  2.21337890e-01]
 [ 1.91685978e-02  9.61066763e-02 -1.09718574e-02]
 [-1.32754920e-01 -1.53060971e-02 -1.18374618e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 2.43109721e-01 -1.77129310e-01 -6.84040399e-02]
 [ 3.76332473e-03  1.52750638e-02  7.39659889e-02]
 [ 1.01902901e-02  5.74746673e-03 -3.34017303e-02]
 [-1.06404913e-01  1.00448669e-01  3.14326237e-03]
 [ 1.59630603e-03 -2.11851738e-01  6.76896954e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.64021234]
curr_Stock_Price:  101.14981415790267
curr_Factors:  [101.14981416  -1.06317993  -1.03295458]
mat_Sqrt:  [[12.4344173   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176091  0.02841124  0.07263502]
Stock Position:  -0.0017609148770932573
Bond Position:  [10.81832855]


portfolio before change:  [10.63864708]
curr_Stock_Price:  102.80669644717314
curr_Factors:  [102.80669645  -1.10654286  -1.02351836]
mat_Sqrt:  [[12.21652168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281337  0.0259549   0.5133315 ]
Stock Position:  -0.002813370144218488
Bond Position:  [10.92788038]


portfolio before change:  [10.64284511]
curr_Stock_Price:  101.80008924645821
curr_Factors:  [101.80008925  -1.05398952  -1.03575309]
mat_Sqrt:  [[12.59460277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01501676 -0.08735001 -1.47220005]
Stock Position:  0.015016757789510707
Bond Position:  [9.11413783]


portfolio before change:  [10.63289885]
curr_Stock_Price:  101.0618735163276
curr_Factors:  [101.06187352  -1.14840419  -1.02799083]
mat_Sqrt:  [[11.46544724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171847 -0.00659539  0.21422481]
Stock Position:  0.0017184723368563806
Bond Position:  [10.45922681]


portfolio before change:  [10.63332818]
curr_Stock_Price:  100.55086484967464
curr_Factors:  [100.55086485  -1.06937609  -1.05530742]
mat_Sqrt:  [[12.01288971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07033106 -0.0798396   0.0913058 ]
Stock Position:  -0.07033106328174188
Bond Position:  [17.70517741]


portfolio before change:  [10.70687917]
curr_Stock_Price:  99.53655195238476
curr_Factors:  [99.53655195 -0.72614502 -1.02812619]
mat_Sqrt:  [[17.22313826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156443 -0.03569102 -0.39773509]
Stock Position:  -0.001564425571337514
Bond Position:  [10.86259669]


portfolio before change:  [10.70971544]
curr_Stock_Price:  98.59156594896385
curr_Factors:  [98.59156595 -0.53596385 -1.01540368]
mat_Sqrt:  [[20.89726288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00102403 -0.05035399 -0.06265367]
Stock Position:  0.0010240265569253523
Bond Position:  [10.60875505]


portfolio before change:  [10.71172261]
curr_Stock_Price:  99.25658327184696
curr_Factors:  [99.25658327 -0.89064927 -1.02507637]
mat_Sqrt:  [[14.61403851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01514457  0.02275113 -0.15365847]
Stock Position:  0.015144574214823358
Bond Position:  [9.20852392]


portfolio before change:  [10.72915044]
curr_Stock_Price:  100.33133737991653
curr_Factors:  [100.33133738  -1.31063475  -1.05798085]
mat_Sqrt:  [[ 9.3920396   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05030361 -0.00674383 -0.19211205]
Stock Position:  -0.050303610947548136
Bond Position:  [15.776179]


portfolio before change:  [10.6926503]
curr_Stock_Price:  101.09613901746037
curr_Factors:  [101.09613902  -1.55820593  -1.08309551]
mat_Sqrt:  [[ 7.20496585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227221  0.0095112  -0.05479635]
Stock Position:  0.0022722140433222827
Bond Position:  [10.46293823]


portfolio before change:  [10.69445]
curr_Stock_Price:  101.3125580601543
curr_Factors:  [101.31255806  -1.57756594  -1.07596678]
mat_Sqrt:  [[ 7.13261304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00274619 -0.05161893  0.25010352]
Stock Position:  -0.002746193698558466
Bond Position:  [10.97267391]


portfolio before change:  [10.69575614]
curr_Stock_Price:  101.33642065984962
curr_Factors:  [101.33642066  -1.39200985  -1.09299134]
mat_Sqrt:  [[ 8.44390343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00854174  0.00225658  0.15019092]
Stock Position:  -0.008541738926390577
Bond Position:  [11.56134539]


portfolio before change:  [10.69334512]
curr_Stock_Price:  101.78788376296052
curr_Factors:  [101.78788376  -1.6098039   -1.08653431]
mat_Sqrt:  [[ 6.86580208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02802067 -0.01456652  0.83426777]
Stock Position:  0.02802067039124689
Bond Position:  [7.84118038]


portfolio before change:  [10.68760576]
curr_Stock_Price:  101.54807612287566
curr_Factors:  [101.54807612  -1.4599531   -1.07989187]
mat_Sqrt:  [[ 8.00997291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01027093 0.05360378 0.3462345 ]
Stock Position:  0.010270930675556993
Bond Position:  [9.64461251]


portfolio before change:  [10.68230733]
curr_Stock_Price:  100.91482480422863
curr_Factors:  [100.9148248   -1.29763587  -1.06663069]
mat_Sqrt:  [[ 9.48783338  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00720037 -0.03570694 -0.16030961]
Stock Position:  0.007200368181695698
Bond Position:  [9.95568343]


portfolio before change:  [10.68405782]
curr_Stock_Price:  100.98509271519299
curr_Factors:  [100.98509272  -1.00009879  -1.06968839]
mat_Sqrt:  [[12.74559507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248942  0.01880742  0.13294834]
Stock Position:  -0.002489422202425012
Bond Position:  [10.93545235]


portfolio before change:  [10.68580083]
curr_Stock_Price:  100.8340567672161
curr_Factors:  [100.83405677  -1.0184257   -1.04027592]
mat_Sqrt:  [[12.86839807  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03479986 -0.07967308  0.3589227 ]
Stock Position:  -0.034799856031599484
Bond Position:  [14.19481149]


portfolio before change:  [10.68281044]
curr_Stock_Price:  100.97097840422778
curr_Factors:  [100.9709784   -0.91488255  -1.05500538]
mat_Sqrt:  [[14.08267343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00948482  0.00574528 -0.05070179]
Stock Position:  -0.009484816448437796
Bond Position:  [11.64050164]


portfolio before change:  [10.68742112]
curr_Stock_Price:  100.63828563633434
curr_Factors:  [100.63828564  -1.22700106  -1.04719275]
mat_Sqrt:  [[10.35364821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04571505 0.41556398 1.5225962 ]
Stock Position:  0.04571504531616847
Bond Position:  [6.08673733]


portfolio before change:  [10.68165105]
curr_Stock_Price:  100.49542320177382
curr_Factors:  [100.4954232   -1.13940097  -1.0709116 ]
mat_Sqrt:  [[11.02096772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00080135 0.00145998 0.11514206]
Stock Position:  0.0008013547567649621
Bond Position:  [10.60111856]


portfolio before change:  [10.68254842]
curr_Stock_Price:  99.96151229607251
curr_Factors:  [99.9615123  -1.17031551 -1.07865619]
mat_Sqrt:  [[10.54670545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00903857  0.0400183  -0.10840441]
Stock Position:  -0.009038568201228525
Bond Position:  [11.58605737]


portfolio before change:  [10.6820459]
curr_Stock_Price:  100.1773506799758
curr_Factors:  [100.17735068  -1.28870338  -1.05218837]
mat_Sqrt:  [[ 9.64124619  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00085899 0.00989742 0.00360729]
Stock Position:  0.0008589887113082345
Bond Position:  [10.59599468]


portfolio before change:  [10.68362727]
curr_Stock_Price:  100.47629303761308
curr_Factors:  [100.47629304  -1.53167334  -1.04905057]
mat_Sqrt:  [[ 7.60798153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00497615 -0.00991748  0.12774394]
Stock Position:  0.004976153989263684
Bond Position:  [10.18364176]


portfolio before change:  [10.68337147]
curr_Stock_Price:  100.16906089617011
curr_Factors:  [100.1690609   -1.41442498  -1.04226618]
mat_Sqrt:  [[ 8.58630254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00709531 0.03650175 0.26682003]
Stock Position:  0.007095307068674876
Bond Position:  [9.97264122]


portfolio before change:  [10.68374632]
curr_Stock_Price:  100.0461903648858
curr_Factors:  [100.04619036  -1.20619487  -1.05269208]
mat_Sqrt:  [[10.45149507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00732755 -0.05067345 -0.16715477]
Stock Position:  -0.007327549843612803
Bond Position:  [11.41683977]


portfolio before change:  [10.68929226]
curr_Stock_Price:  99.48410060131607
curr_Factors:  [99.4841006  -1.12719122 -1.07940028]
mat_Sqrt:  [[10.95073236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00909461  0.00036055 -0.02992936]
Stock Position:  0.009094606435096849
Bond Position:  [9.78452352]


portfolio before change:  [10.68466301]
curr_Stock_Price:  98.84059920651723
curr_Factors:  [98.84059921 -0.96685112 -1.04446244]
mat_Sqrt:  [[13.22613615  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00301129 -0.02145763  0.184746  ]
Stock Position:  0.0030112884127088107
Bond Position:  [10.38702546]


portfolio before change:  [10.69045664]
curr_Stock_Price:  100.33337250603684
curr_Factors:  [100.33337251  -0.90828492  -1.05269803]
mat_Sqrt:  [[14.11891536  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052942  0.01335395 -0.16919507]
Stock Position:  -0.0005294238803593872
Bond Position:  [10.74357552]


portfolio before change:  [10.69238145]
curr_Stock_Price:  99.23447679682356
curr_Factors:  [99.2344768  -0.62666495 -1.02915008]
mat_Sqrt:  [[18.94747115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04204925  0.00317595 -2.48763308]
Stock Position:  -0.042049248290466176
Bond Position:  [14.8651166]


portfolio before change:  [10.70493547]
curr_Stock_Price:  98.98011396619535
curr_Factors:  [98.98011397 -0.49435486 -1.00567745]
mat_Sqrt:  [[22.08473505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00201958 -0.03487491 -0.08390303]
Stock Position:  -0.0020195794625969135
Bond Position:  [10.90483368]


portfolio before change:  [10.70393224]
curr_Stock_Price:  100.15185435216365
curr_Factors:  [100.15185435  -0.5399754   -1.0084454 ]
mat_Sqrt:  [[21.29062377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103085  0.02912675  0.63141539]
Stock Position:  -0.0010308524694024684
Bond Position:  [10.80717402]


portfolio before change:  [10.70572755]
curr_Stock_Price:  99.72081674486792
curr_Factors:  [99.72081674 -0.39980317 -1.01117445]
mat_Sqrt:  [[24.32237788  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079805  0.0303916  -0.03129966]
Stock Position:  0.0007980486374737542
Bond Position:  [10.62614549]


portfolio before change:  [10.70857935]
curr_Stock_Price:  101.62977195812788
curr_Factors:  [101.62977196  -0.55125572  -0.99553361]
mat_Sqrt:  [[21.64008094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00726953 -0.00484021 -0.33768984]
Stock Position:  -0.007269531033944893
Bond Position:  [11.44738013]


portfolio before change:  [10.7072219]
curr_Stock_Price:  102.01335304809368
curr_Factors:  [102.01335305  -0.43431236  -0.98508376]
mat_Sqrt:  [[24.67295236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00212434  0.0049611   0.16678008]
Stock Position:  -0.0021243385385106483
Bond Position:  [10.9239328]


portfolio before change:  [10.70853752]
curr_Stock_Price:  102.03686917586346
curr_Factors:  [102.03686918  -0.67994856  -0.98775524]
mat_Sqrt:  [[19.25229755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01166476 -0.05601321 -0.19513769]
Stock Position:  0.011664755614390966
Bond Position:  [9.51830238]


portfolio before change:  [10.68678474]
curr_Stock_Price:  100.07003422783202
curr_Factors:  [100.07003423  -0.63825107  -0.97195424]
mat_Sqrt:  [[19.998654    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00096286 0.0048304  0.21100438]
Stock Position:  0.0009628632727530236
Bond Position:  [10.59043098]


portfolio before change:  [10.68799897]
curr_Stock_Price:  99.9561559220419
curr_Factors:  [99.95615592 -0.50239084 -0.96949605]
mat_Sqrt:  [[22.93914311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00015348  0.00181751 -0.09528584]
Stock Position:  0.00015347519138253865
Bond Position:  [10.67265818]


portfolio before change:  [10.68908456]
curr_Stock_Price:  98.33647152487642
curr_Factors:  [98.33647152 -0.4371869  -0.96771828]
mat_Sqrt:  [[24.13081864  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427543  0.03176466  0.00896685]
Stock Position:  -0.004275434045527548
Bond Position:  [11.10951566]


portfolio before change:  [10.69919392]
curr_Stock_Price:  96.29677603849831
curr_Factors:  [96.29677604 -0.27462533 -0.98278854]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.69919392]
Stock Price:  95.64439728601188
PL:  [10.69919392]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-8.11784308e-02 -1.41887809e-02 -7.90821071e-03]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.31536612e-01  1.72948414e-01  2.34411126e-01]
 [-1.29522352e-02  2.11799202e-02  1.15081586e-01]
 [-6.98008379e-01 -2.10867988e-01  3.55960586e-02]
 [-1.72748388e-02 -7.12327766e-02 -7.62873518e-02]
 [ 3.37101931e-02 -1.14241954e-01 -1.82867894e-02]
 [ 1.46805044e-01  1.21880321e-01 -2.73522838e-02]
 [-1.68982565e-01  1.25036881e-02 -8.11331386e-02]
 [ 9.49878863e-02 -3.04016378e-02  8.08747498e-03]
 [ 1.20865226e-01 -3.08582119e-01  9.72039707e-03]
 [-1.06927331e-01 -8.96962296e-02 -1.95580176e-01]
 [ 2.03150091e-01 -2.17683418e-01  5.38465051e-02]
 [ 8.22310323e-02 -6.41001252e-02 -5.76375378e-02]
 [ 3.04750831e-02 -1.05378377e-01 -5.26844743e-02]
 [-5.18792288e-03 -1.49458789e-01 -2.46455345e-02]
 [-4.03889448e-01 -2.19923818e-01  9.84813508e-02]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 1.71823368e-01  8.40156607e-01  1.92254336e-01]
 [-5.63776352e-03  2.67098318e-02  2.82778223e-02]
 [-4.69984241e-03 -1.75077529e-01  3.84185836e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 8.70642699e-02 -3.73439367e-02  1.09857076e-01]
 [ 7.96022391e-02  4.30356999e-02 -1.03663640e-02]
 [-6.04429819e-02 -1.42843769e-01  9.04762469e-02]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [ 2.89932083e-03 -6.15906595e-02 -8.49645969e-03]
 [ 3.20016947e-02  4.96631389e-02 -8.40971394e-02]
 [-6.33848597e-01 -7.44722031e-02 -9.69219600e-01]
 [-2.09026288e-01  7.79041387e-02  6.43009970e-03]
 [-6.60207078e-03  1.63530888e-02  1.14661477e-01]
 [ 1.24235934e-02  3.35088952e-02  1.96559637e-02]
 [-1.31498570e-01 -1.30621723e-02 -1.39878773e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 2.29491198e-01 -1.74195011e-01 -7.25377069e-02]
 [ 4.92417933e-03  4.95111147e-02  7.66715201e-02]
 [ 4.47374104e-03  4.55611813e-03 -4.63542832e-02]
 [-6.21633035e-02  9.85357863e-02 -6.12148308e-03]
 [-7.95047591e-02 -2.06227864e-01  6.57575637e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.88075403]
curr_Stock_Price:  100.3473490295174
curr_Factors:  [100.34734903  -1.09861258  -1.00433833]
mat_Sqrt:  [[12.25197012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0067874  -0.00448689 -0.02255992]
Stock Position:  -0.0067874014931284385
Bond Position:  [5.56185178]


portfolio before change:  [4.88664765]
curr_Stock_Price:  99.58146769868848
curr_Factors:  [99.5814677  -1.07956276 -0.99025693]
mat_Sqrt:  [[12.56803127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361083  0.01411938  0.0859571 ]
Stock Position:  -0.003610831470030018
Bond Position:  [5.24621955]


portfolio before change:  [4.88598102]
curr_Stock_Price:  99.94771468289389
curr_Factors:  [99.94771468 -1.08245642 -1.00383542]
mat_Sqrt:  [[12.4081728   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02287614 0.05469109 0.66870969]
Stock Position:  0.022876139452830298
Bond Position:  [2.59956316]


portfolio before change:  [4.89277449]
curr_Stock_Price:  100.23047692855452
curr_Factors:  [100.23047693  -0.82369621  -1.02071597]
mat_Sqrt:  [[15.84826647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00069948 0.00669768 0.32829573]
Stock Position:  0.0006994808135593017
Bond Position:  [4.82266519]


portfolio before change:  [4.89334065]
curr_Stock_Price:  100.17799518666057
curr_Factors:  [100.17799519  -0.94623342  -1.02711089]
mat_Sqrt:  [[13.92386454  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04999955 -0.06668231  0.10154565]
Stock Position:  -0.04999954936700365
Bond Position:  [9.90219527]


portfolio before change:  [4.90001889]
curr_Stock_Price:  100.06918646220558
curr_Factors:  [100.06918646  -0.88654192  -1.02925452]
mat_Sqrt:  [[14.73263902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00235437 -0.02252578 -0.21762658]
Stock Position:  -0.002354374636446994
Bond Position:  [5.13561924]


portfolio before change:  [4.90324334]
curr_Stock_Price:  98.97231198252837
curr_Factors:  [98.97231198 -0.69281681 -1.03769197]
mat_Sqrt:  [[17.53732304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00154115 -0.03612648 -0.05216712]
Stock Position:  0.0015411533007936174
Bond Position:  [4.75071183]


portfolio before change:  [4.90340429]
curr_Stock_Price:  98.69140235992452
curr_Factors:  [98.69140236 -0.62391279 -1.06103731]
mat_Sqrt:  [[18.30268437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00788784  0.03854194 -0.07802845]
Stock Position:  0.007887843970870808
Bond Position:  [4.1249419]


portfolio before change:  [4.8981523]
curr_Stock_Price:  97.96019623613047
curr_Factors:  [97.96019624 -0.67645637 -1.02298512]
mat_Sqrt:  [[17.90571151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01034424  0.00395401 -0.23145026]
Stock Position:  -0.010344238683535815
Bond Position:  [5.91147595]


portfolio before change:  [4.89354204]
curr_Stock_Price:  98.47731863201045
curr_Factors:  [98.47731863 -0.70846541 -1.01443554]
mat_Sqrt:  [[17.58287302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00545154 -0.00961384  0.02307131]
Stock Position:  0.005451541860102222
Bond Position:  [4.35668882]


portfolio before change:  [4.89163514]
curr_Stock_Price:  98.02762583407649
curr_Factors:  [98.02762583 -0.49413327 -0.98865198]
mat_Sqrt:  [[22.25271639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0051626  -0.09758223  0.02772959]
Stock Position:  0.005162598391378795
Bond Position:  [4.38555788]


portfolio before change:  [4.88886342]
curr_Stock_Price:  97.38454804893327
curr_Factors:  [97.38454805 -0.51467334 -1.00610094]
mat_Sqrt:  [[21.28267312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0070088  -0.02836444 -0.5579358 ]
Stock Position:  -0.007008795984775902
Bond Position:  [5.57141185]


portfolio before change:  [4.88500694]
curr_Stock_Price:  98.03415261461417
curr_Factors:  [98.03415261 -0.35341043 -1.01479129]
mat_Sqrt:  [[24.95599797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00835554 -0.06883754  0.15360909]
Stock Position:  0.008355542484658517
Bond Position:  [4.06587842]


portfolio before change:  [4.89702944]
curr_Stock_Price:  99.41218790322799
curr_Factors:  [99.4121879  -0.27610384 -1.02616272]
mat_Sqrt:  [[27.03164358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00254556 -0.02027024 -0.16442385]
Stock Position:  0.0025455633463147206
Bond Position:  [4.64396942]


portfolio before change:  [4.90052431]
curr_Stock_Price:  100.55705583641364
curr_Factors:  [100.55705584  -0.30426984  -1.00878024]
mat_Sqrt:  [[27.04968083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00062848 -0.03332357 -0.15029414]
Stock Position:  0.000628475135572898
Bond Position:  [4.8373267]


portfolio before change:  [4.90023523]
curr_Stock_Price:  99.13491097040497
curr_Factors:  [99.13491097 -0.44199787 -0.9969085 ]
mat_Sqrt:  [[23.51351336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00059871 -0.04726302 -0.07030685]
Stock Position:  -0.0005987059719024014
Bond Position:  [4.95958789]


portfolio before change:  [4.89955445]
curr_Stock_Price:  101.3075450154543
curr_Factors:  [101.30754502  -0.49838065  -1.03292378]
mat_Sqrt:  [[21.90810063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01777723 -0.06954602  0.28093988]
Stock Position:  -0.01777723415495674
Bond Position:  [6.7005224]


portfolio before change:  [4.88138528]
curr_Stock_Price:  102.37670944029763
curr_Factors:  [102.37670944  -0.60751737  -1.02834491]
mat_Sqrt:  [[19.94137985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00658485  0.00580111 -0.05715682]
Stock Position:  -0.006584854446693418
Bond Position:  [5.55552101]


portfolio before change:  [4.87874456]
curr_Stock_Price:  102.883204746902
curr_Factors:  [102.88320475  -0.65584707  -1.04782222]
mat_Sqrt:  [[18.72622832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01242962 0.26568085 0.54844811]
Stock Position:  0.01242961831995363
Bond Position:  [3.5999456]


portfolio before change:  [4.88233774]
curr_Stock_Price:  103.1360810350676
curr_Factors:  [103.13608104  -0.8116552   -1.05975648]
mat_Sqrt:  [[15.87328656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [5.19153785e-05 8.44639043e-03 8.06687561e-02]
Stock Position:  5.191537849123003e-05
Bond Position:  [4.87698339]


portfolio before change:  [4.88294808]
curr_Stock_Price:  103.14921234515663
curr_Factors:  [103.14921235  -0.96325412  -1.08551467]
mat_Sqrt:  [[13.29526313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.03658291e-04 -5.53643760e-02  1.09597525e-01]
Stock Position:  -0.00010365829078918179
Bond Position:  [4.89364036]


portfolio before change:  [4.88366921]
curr_Stock_Price:  102.09401663947969
curr_Factors:  [102.09401664  -0.92530564  -1.08569125]
mat_Sqrt:  [[13.665812    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284424  0.01916992 -0.08961985]
Stock Position:  -0.002844241066514802
Bond Position:  [5.1740492]


portfolio before change:  [4.88504297]
curr_Stock_Price:  101.83842348354025
curr_Factors:  [101.83842348  -0.87581055  -1.06034887]
mat_Sqrt:  [[14.69089716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0073872  -0.01180919  0.31339166]
Stock Position:  0.007387195909641716
Bond Position:  [4.13274259]


portfolio before change:  [4.88674569]
curr_Stock_Price:  101.99898449015419
curr_Factors:  [101.99898449  -1.07788996  -1.05747048]
mat_Sqrt:  [[12.05648162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0065191   0.01360908 -0.02957235]
Stock Position:  0.006519098467602811
Bond Position:  [4.22180427]


portfolio before change:  [4.88517571]
curr_Stock_Price:  101.67720051298247
curr_Factors:  [101.67720051  -1.08153931  -1.06707873]
mat_Sqrt:  [[11.86016197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0038501  -0.04517117  0.25810355]
Stock Position:  -0.003850099658867838
Bond Position:  [5.27664307]


portfolio before change:  [4.88278706]
curr_Stock_Price:  102.46893948066459
curr_Factors:  [102.46893948  -1.06317335  -1.08810507]
mat_Sqrt:  [[11.92075864  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00108685  0.02004328 -0.05140267]
Stock Position:  0.0010868505343208698
Bond Position:  [4.77141864]


portfolio before change:  [4.88383358]
curr_Stock_Price:  102.88303673635973
curr_Factors:  [102.88303674  -0.97689783  -1.06579575]
mat_Sqrt:  [[13.34176307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.18755272e-05 -1.94766766e-02 -2.42380345e-02]
Stock Position:  -3.187552715472827e-05
Bond Position:  [4.88711304]


portfolio before change:  [4.88446887]
curr_Stock_Price:  102.11876240435103
curr_Factors:  [102.1187624   -0.9804008   -1.07638472]
mat_Sqrt:  [[13.05734676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00123438  0.01570486 -0.23990573]
Stock Position:  0.0012343805401099724
Bond Position:  [4.75841546]


portfolio before change:  [4.88519459]
curr_Stock_Price:  102.22479038041999
curr_Factors:  [102.22479038  -0.92881687  -1.07288561]
mat_Sqrt:  [[13.81108777  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06035821 -0.02355018 -2.76491374]
Stock Position:  -0.060358213441080326
Bond Position:  [11.05530031]


portfolio before change:  [4.83180733]
curr_Stock_Price:  103.13219389966822
curr_Factors:  [103.1321939   -0.88081639  -1.08245885]
mat_Sqrt:  [[14.47953623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01420641  0.02463545  0.01834328]
Stock Position:  -0.014206413085214661
Bond Position:  [6.29694588]


portfolio before change:  [4.83536113]
curr_Stock_Price:  102.937448905492
curr_Factors:  [102.93744891  -0.9781717   -1.055129  ]
mat_Sqrt:  [[13.4747937   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00127834 0.0051713  0.32709728]
Stock Position:  0.0012783379511235435
Bond Position:  [4.70377228]


portfolio before change:  [4.83516862]
curr_Stock_Price:  102.32687456785183
curr_Factors:  [102.32687457  -1.09009553  -1.04891408]
mat_Sqrt:  [[12.05118184  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00143563 0.01059644 0.05607299]
Stock Position:  0.0014356306632437588
Bond Position:  [4.68826502]


portfolio before change:  [4.83453646]
curr_Stock_Price:  101.47830697273344
curr_Factors:  [101.47830697  -0.96940605  -1.0464175 ]
mat_Sqrt:  [[13.51799153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01186482 -0.00413062 -0.3990352 ]
Stock Position:  -0.011864815034185244
Bond Position:  [6.0385578]


portfolio before change:  [4.83003169]
curr_Stock_Price:  101.9216037452406
curr_Factors:  [101.92160375  -1.17437065  -1.02768602]
mat_Sqrt:  [[11.27003293  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465071  0.0049611   0.16678008]
Stock Position:  -0.004650714321369128
Bond Position:  [5.30403995]


portfolio before change:  [4.82844369]
curr_Stock_Price:  102.4056247662133
curr_Factors:  [102.40562477  -1.38018801  -0.99203063]
mat_Sqrt:  [[ 9.55173673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02200509 -0.0550853  -0.20692989]
Stock Position:  0.022005087735147706
Bond Position:  [2.57499894]


portfolio before change:  [4.83566592]
curr_Stock_Price:  102.7192035303238
curr_Factors:  [102.71920353  -1.30367542  -0.98823986]
mat_Sqrt:  [[10.38210664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00210488 0.01565679 0.21872251]
Stock Position:  0.002104877176792915
Bond Position:  [4.61945461]


portfolio before change:  [4.83811279]
curr_Stock_Price:  103.60733604471675
curr_Factors:  [103.60733604  -1.38957827  -0.98040262]
mat_Sqrt:  [[ 9.68547411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050288  0.00144077 -0.13223587]
Stock Position:  -0.0005028818280502532
Bond Position:  [4.89021504]


portfolio before change:  [4.83815269]
curr_Stock_Price:  104.74362690786948
curr_Factors:  [104.74362691  -1.41122348  -0.99342088]
mat_Sqrt:  [[ 9.45809849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00643561  0.03115975 -0.01746289]
Stock Position:  -0.00643561313611081
Bond Position:  [5.51224215]


portfolio before change:  [4.83769253]
curr_Stock_Price:  104.92220064516667
curr_Factors:  [104.92220065  -1.45782498  -1.01221983]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.83769253]
Stock Price:  105.65161456022969
PL:  [-0.81392203]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.60286880e-01  7.70702489e-02  2.48809267e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.11533820e-01  2.54241832e-01  3.85468325e-01]
 [ 2.07509791e-02 -1.70844863e-02  1.22638857e-01]
 [ 9.12443745e-02 -3.99990506e-02  1.05199054e-01]
 [ 8.71009264e-02 -2.62972274e-01 -3.58353763e-01]
 [ 2.98057172e-02 -1.61381779e-01 -2.16777530e-02]
 [ 1.59073017e-02  1.73044856e-01  1.68296174e-02]
 [ 4.36204732e-02  1.76056866e-02 -8.02974785e-03]
 [ 1.87726617e-01  1.32143503e-01  6.04261396e-01]
 [ 2.52493365e-01 -3.64052993e-01 -3.05039522e-02]
 [-5.27134997e-01 -3.09112205e-01 -6.77318500e-01]
 [ 2.17077362e-01 -4.27307446e-01 -1.87579921e-01]
 [-1.31793521e-01 -2.32292902e-01 -1.62655826e-01]
 [-1.36470163e-01  1.67717494e-01  1.31869345e-01]
 [-6.07670429e-03 -1.19690869e-01 -1.76312368e-02]
 [-3.36375450e-01 -2.14738740e-01  7.23458656e-02]
 [-1.98355712e-01 -5.65756246e-02 -3.19988801e-02]
 [ 2.06097671e-01  1.03469262e+00  2.14384076e-01]
 [-1.96339902e-01 -3.30534207e-02  1.38754362e-01]
 [-9.90198422e-02  3.88875484e-01 -2.57646473e-02]
 [-3.30166386e-02  5.02643583e-02 -2.38099619e-02]
 [-2.54697993e-03 -2.98957127e-02 -1.49112798e-02]
 [-4.24375034e-03 -1.02939788e-01  1.02566488e-01]
 [-9.57955979e-02 -2.72978186e-02  6.83984341e-02]
 [ 1.21070184e-01 -4.73763770e-02 -1.94965051e-02]
 [ 4.40694244e-02 -5.62180954e-02  1.12912090e-01]
 [ 3.65706494e-02  4.31598470e-02 -5.83220291e-02]
 [-6.93994547e-01 -1.16529908e-01 -1.09615762e+00]
 [-1.67851570e-01 -6.21438688e-03  6.78019718e-02]
 [ 3.23527680e-02 -6.11343462e-02  1.07034142e-01]
 [ 2.24360325e-02  9.45753412e-02 -9.42087233e-03]
 [-1.36453876e-01 -1.69704838e-02 -1.33439103e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 1.77031423e-01 -1.64918739e-01 -9.45521496e-02]
 [-2.64755835e-02  2.51166580e-01  8.34059966e-02]
 [ 1.21004509e-01  9.39482359e-02 -2.02096032e-02]
 [-1.87341100e-02  6.68276170e-02 -1.05590039e-02]
 [-9.71865327e-02 -2.00504874e-01  4.71417904e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.03655353]
curr_Stock_Price:  99.52289076825204
curr_Factors:  [99.52289077 -0.77939533 -1.02058771]
mat_Sqrt:  [[16.4513022   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01261353  0.02437175  0.70978358]
Stock Position:  -0.012613527709025516
Bond Position:  [0.21878121]


portfolio before change:  [-1.03075297]
curr_Stock_Price:  99.06519032772182
curr_Factors:  [99.06519033 -0.74433809 -1.0571097 ]
mat_Sqrt:  [[16.35167482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277531  0.01411938  0.0859571 ]
Stock Position:  -0.002775314659288174
Bond Position:  [-0.75581589]


portfolio before change:  [-1.02565749]
curr_Stock_Price:  97.195146653298
curr_Factors:  [97.19514665 -0.59223365 -1.04163562]
mat_Sqrt:  [[18.96986202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01564491 0.08039833 1.09963384]
Stock Position:  0.015644905987067977
Bond Position:  [-2.54626642]


portfolio before change:  [-1.01194783]
curr_Stock_Price:  98.09179391662681
curr_Factors:  [98.09179392 -0.45884195 -1.06171631]
mat_Sqrt:  [[21.44186797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00211471 -0.00540259  0.34985452]
Stock Position:  0.002114713675692299
Bond Position:  [-1.21938389]


portfolio before change:  [-1.01351984]
curr_Stock_Price:  97.4205076392396
curr_Factors:  [97.42050764 -0.52880738 -1.06046144]
mat_Sqrt:  [[19.88106786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00561767 -0.01264881  0.30010362]
Stock Position:  0.005617669591677703
Bond Position:  [-1.56079607]


portfolio before change:  [-1.01412236]
curr_Stock_Price:  97.34798572993076
curr_Factors:  [97.34798573 -0.21997675 -1.03852623]
mat_Sqrt:  [[27.65451651  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.58994079e-04 -8.31591348e-02 -1.02228354e+00]
Stock Position:  0.000258994078617479
Bond Position:  [-1.03933491]


portfolio before change:  [-1.01391458]
curr_Stock_Price:  98.6518805758798
curr_Factors:  [98.65188058 -0.30573916 -1.03683171]
mat_Sqrt:  [[25.76524354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082335 -0.0510334  -0.0618406 ]
Stock Position:  0.0008233535528219951
Bond Position:  [-1.09513996]


portfolio before change:  [-1.01460016]
curr_Stock_Price:  97.98549169644474
curr_Factors:  [97.9854917  -0.13467762 -1.02835707]
mat_Sqrt:  [[30.62402226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00077751 0.05472159 0.04801021]
Stock Position:  0.0007775148466100854
Bond Position:  [-1.09078533]


portfolio before change:  [-1.01681552]
curr_Stock_Price:  95.31157425330488
curr_Factors:  [95.31157425  0.16590533 -1.05295397]
mat_Sqrt:  [[39.25593384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00108101  0.00556741 -0.02290664]
Stock Position:  0.0010810081568226255
Bond Position:  [-1.11984811]


portfolio before change:  [-1.01779545]
curr_Stock_Price:  94.53458262996456
curr_Factors:  [94.53458263  0.33927807 -1.03001504]
mat_Sqrt:  [[47.38135289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00663727 0.04178744 1.72378957]
Stock Position:  0.006637271183980746
Bond Position:  [-1.64524711]


portfolio before change:  [-1.00959617]
curr_Stock_Price:  95.80090765248319
curr_Factors:  [95.80090765  0.34354947 -1.05442708]
mat_Sqrt:  [[47.05864318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00503344 -0.11512366 -0.08701929]
Stock Position:  0.005033442271414739
Bond Position:  [-1.49180451]


portfolio before change:  [-1.02860772]
curr_Stock_Price:  92.0609114442997
curr_Factors:  [92.06091144  0.42712824 -1.06139053]
mat_Sqrt:  [[48.82234758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01379232 -0.09774986 -1.93220115]
Stock Position:  -0.013792317108872751
Bond Position:  [0.24112557]


portfolio before change:  [-1.03927398]
curr_Stock_Price:  92.83644518427437
curr_Factors:  [92.83644518  0.28057816 -1.09897356]
mat_Sqrt:  [[40.95377121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0040962  -0.13512648 -0.5351133 ]
Stock Position:  0.004096197606487787
Bond Position:  [-1.41955041]


portfolio before change:  [-1.03033803]
curr_Stock_Price:  95.06129058005695
curr_Factors:  [95.06129058  0.1366384  -1.12473515]
mat_Sqrt:  [[35.38985178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0048317  -0.07345747 -0.4640118 ]
Stock Position:  -0.0048317037552272155
Bond Position:  [-0.57103004]


portfolio before change:  [-1.04327219]
curr_Stock_Price:  97.723452051324
curr_Factors:  [97.72345205 -0.32570341 -1.11311064]
mat_Sqrt:  [[23.18087356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00453917  0.05303693  0.37618654]
Stock Position:  -0.0045391731469452785
Bond Position:  [-0.59968852]


portfolio before change:  [-1.04988073]
curr_Stock_Price:  99.16282872209648
curr_Factors:  [99.16282872 -0.14276526 -1.14232804]
mat_Sqrt:  [[27.43089507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046539 -0.03784958 -0.05029701]
Stock Position:  -0.000465390223603441
Bond Position:  [-1.00373132]


portfolio before change:  [-1.05016783]
curr_Stock_Price:  99.5101165014021
curr_Factors:  [99.5101165  -0.25981817 -1.1674024 ]
mat_Sqrt:  [[23.8799392   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01369989 -0.06790635  0.20638262]
Stock Position:  -0.013699885897297594
Bond Position:  [0.31310941]


portfolio before change:  [-1.04523546]
curr_Stock_Price:  99.15294309012536
curr_Factors:  [99.15294309 -0.16758424 -1.1316182 ]
mat_Sqrt:  [[27.04388989  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00763012 -0.01789078 -0.0912839 ]
Stock Position:  -0.007630123958280497
Bond Position:  [-0.28868621]


portfolio before change:  [-1.05647707]
curr_Stock_Price:  100.62153350963577
curr_Factors:  [ 1.00621534e+02 -4.17927082e-02 -1.10528033e+00]
mat_Sqrt:  [[31.95386843  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00865542 0.32719854 0.6115781 ]
Stock Position:  0.008655424197536364
Bond Position:  [-1.92739913]


portfolio before change:  [-1.06532776]
curr_Stock_Price:  99.62681112117492
curr_Factors:  [ 9.96268111e+01 -3.76498659e-02 -1.07362571e+00]
mat_Sqrt:  [[32.79105409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00514989 -0.01045241  0.39582757]
Stock Position:  -0.005149886973275167
Bond Position:  [-0.55226094]


portfolio before change:  [-1.05630986]
curr_Stock_Price:  97.86231938794833
curr_Factors:  [ 9.78623194e+01 -9.06495167e-02 -1.07015116e+00]
mat_Sqrt:  [[30.65393102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307426  0.12297323 -0.07349937]
Stock Position:  -0.003074264992911271
Bond Position:  [-0.75545516]


portfolio before change:  [-1.06252907]
curr_Stock_Price:  99.85459228255944
curr_Factors:  [ 9.98545923e+01 -4.60338774e-02 -1.08806289e+00]
mat_Sqrt:  [[32.12447769  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113866  0.01589499 -0.06792319]
Stock Position:  -0.0011386646324463103
Bond Position:  [-0.94882818]


portfolio before change:  [-1.06092855]
curr_Stock_Price:  98.34481219288652
curr_Factors:  [ 9.83448122e+01 -3.61871922e-02 -1.06915716e+00]
mat_Sqrt:  [[32.56165739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0001954  -0.00945385 -0.04253773]
Stock Position:  -0.00019540271196430135
Bond Position:  [-1.04171171]


portfolio before change:  [-1.06060029]
curr_Stock_Price:  95.99846703285989
curr_Factors:  [95.99846703 -0.19031993 -1.06196353]
mat_Sqrt:  [[27.44128838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00051144 -0.03255242  0.29259364]
Stock Position:  0.0005114429092925335
Bond Position:  [-1.10969803]


portfolio before change:  [-1.05944797]
curr_Stock_Price:  98.52278782263255
curr_Factors:  [98.52278782 -0.24358441 -1.04302793]
mat_Sqrt:  [[27.21247547  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303312 -0.00863233  0.19512169]
Stock Position:  -0.003033118129901545
Bond Position:  [-0.76061671]


portfolio before change:  [-1.05713809]
curr_Stock_Price:  97.7298878517685
curr_Factors:  [97.72988785 -0.16374664 -1.05236531]
mat_Sqrt:  [[28.96521084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00400022 -0.01498173 -0.0556181 ]
Stock Position:  0.004000220286310178
Bond Position:  [-1.44807917]


portfolio before change:  [-1.05860175]
curr_Stock_Price:  97.4092465880142
curr_Factors:  [97.40924659 -0.16364375 -1.04778482]
mat_Sqrt:  [[29.00570586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0022639  -0.01777772  0.32210676]
Stock Position:  0.0022638981293476457
Bond Position:  [-1.27912636]


portfolio before change:  [-1.0541593]
curr_Stock_Price:  99.44217545745444
curr_Factors:  [99.44217546 -0.2283984  -1.04131127]
mat_Sqrt:  [[27.93461644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00092287  0.01364834 -0.16637652]
Stock Position:  0.0009228727925826315
Bond Position:  [-1.14593178]


portfolio before change:  [-1.05302618]
curr_Stock_Price:  100.82522249307593
curr_Factors:  [100.82522249  -0.16249409  -1.04192518]
mat_Sqrt:  [[30.23406521  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03045424 -0.03684999 -3.12703259]
Stock Position:  -0.030454243181682786
Bond Position:  [2.01752967]


portfolio before change:  [-1.1261526]
curr_Stock_Price:  103.23469412037154
curr_Factors:  [103.23469412  -0.26406052  -1.06311544]
mat_Sqrt:  [[27.38044353  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00563073 -0.00196516  0.19342015]
Stock Position:  -0.005630734392459846
Bond Position:  [-0.54486546]


portfolio before change:  [-1.13033058]
curr_Stock_Price:  103.96459208548963
curr_Factors:  [103.96459209  -0.41024928  -1.05577097]
mat_Sqrt:  [[23.99943107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00219266 -0.01933238  0.30533861]
Stock Position:  0.0021926577592528977
Bond Position:  [-1.35828935]


portfolio before change:  [-1.13329535]
curr_Stock_Price:  102.68989469859231
curr_Factors:  [102.6898947   -0.20323301  -1.04385678]
mat_Sqrt:  [[29.50689376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00077795  0.02990735 -0.02687513]
Stock Position:  0.0007779514161975678
Bond Position:  [-1.2131831]


portfolio before change:  [-1.13598348]
curr_Stock_Price:  99.42944072373919
curr_Factors:  [99.42944072 -0.19314841 -1.02655233]
mat_Sqrt:  [[29.36335634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00558963 -0.00536654 -0.38066462]
Stock Position:  -0.0055896264945831465
Bond Position:  [-0.58021005]


portfolio before change:  [-1.14990693]
curr_Stock_Price:  101.90740809072234
curr_Factors:  [101.90740809  -0.40446045  -0.99751781]
mat_Sqrt:  [[25.08039271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208983  0.0049611   0.16678008]
Stock Position:  -0.002089827865401318
Bond Position:  [-0.93693798]


portfolio before change:  [-1.15522893]
curr_Stock_Price:  104.39798482901773
curr_Factors:  [104.39798483  -0.47366406  -1.02289749]
mat_Sqrt:  [[23.37457322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0065658  -0.05215188 -0.26973096]
Stock Position:  0.006565803830244383
Bond Position:  [-1.84068562]


portfolio before change:  [-1.14695696]
curr_Stock_Price:  105.69288559251183
curr_Factors:  [105.69288559  -0.29809487  -1.05382653]
mat_Sqrt:  [[27.34725554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.08431812e-04  7.94258466e-02  2.37934093e-01]
Stock Position:  -0.00010843181162853676
Bond Position:  [-1.13549649]


portfolio before change:  [-1.14702073]
curr_Stock_Price:  104.97187895166398
curr_Factors:  [104.97187895  -0.1061322   -1.06704058]
mat_Sqrt:  [[32.47659629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00367357  0.02970904 -0.05765237]
Stock Position:  0.0036735676558016283
Bond Position:  [-1.53264203]


portfolio before change:  [-1.14809582]
curr_Stock_Price:  104.7313776775942
curr_Factors:  [104.73137768  -0.23252575  -1.05829674]
mat_Sqrt:  [[28.80578613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066528  0.02113275 -0.0301219 ]
Stock Position:  -0.0006652821740187929
Bond Position:  [-1.0784199]


portfolio before change:  [-1.14820399]
curr_Stock_Price:  104.69133205690346
curr_Factors:  [104.69133206  -0.14024122  -1.06280091]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.14820399]
Stock Price:  104.23366050066986
PL:  [-5.38186449]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.10878154e-01  6.49566409e-02  8.73927336e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.35530690e-01  3.19308042e-01  4.68933470e-01]
 [-2.19408138e-02  3.48359348e-02  1.21505704e-01]
 [-1.72281782e-01 -6.19497808e-02  4.84434661e-02]
 [ 5.48402084e-02 -2.05645182e-01 -2.76099312e-01]
 [ 3.70171805e-02  5.16370839e-02 -1.01111221e-02]
 [ 1.96265166e-01 -1.48138636e-01 -1.89614250e-02]
 [-5.05864609e-01 -2.60491248e-02 -6.86809520e-02]
 [ 4.62034340e-02 -1.52627896e-02 -4.04544321e-02]
 [ 3.27631543e-02 -3.22934758e-01  1.25812328e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.15806695e-01 -2.87339169e-02  2.78631383e-01]
 [ 6.49972609e-02  1.94757742e-01  1.54517644e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-3.59978310e-02  4.25987825e-02  4.39832273e-02]
 [-3.50317798e-01 -1.97425496e-01  7.57766311e-02]
 [-1.50755664e-01 -4.20783573e-02 -1.29495016e-02]
 [ 1.81084648e-01  9.21453336e-01  1.81428087e-01]
 [ 1.13328787e-02  8.76601496e-03  3.05737011e-02]
 [-8.10960891e-02  3.10340557e-01 -1.88750573e-02]
 [-3.21633246e-02  5.67378051e-02 -2.78519198e-02]
 [ 4.98758787e-02 -3.78498026e-02  6.47104600e-02]
 [ 7.72465345e-02  1.46846337e-01  2.95051851e-02]
 [-6.08555293e-02 -1.74214540e-01  1.21389961e-01]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [ 1.69065033e-02 -6.43131104e-02  2.62085190e-02]
 [ 6.75854408e-02  6.17799258e-02 -7.75970953e-02]
 [-6.39721147e-01 -1.18002433e-01 -9.76669680e-01]
 [-2.40856617e-01  7.57414054e-02  3.78254891e-03]
 [-3.76072153e-02  6.22031144e-02  1.69389878e-01]
 [ 7.34965545e-03  2.55008764e-03  3.59816308e-02]
 [-1.37880772e-01 -1.66981127e-02 -1.35663164e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 2.12011421e-01 -1.70725028e-01 -7.94221298e-02]
 [-4.13825045e-03  1.14531789e-01  7.88515069e-02]
 [ 2.46390837e-02  2.45924076e-02 -4.31495077e-02]
 [-5.98930559e-02  9.70703748e-02 -6.35752383e-03]
 [-7.20500246e-02 -2.72047255e-01  1.08582052e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.7762836]
curr_Stock_Price:  100.19346320143481
curr_Factors:  [100.1934632   -0.67810087  -0.99084194]
mat_Sqrt:  [[18.88107585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483881  0.02054109  0.24930714]
Stock Position:  -0.004838813950987881
Bond Position:  [4.26110113]


portfolio before change:  [3.77972324]
curr_Stock_Price:  99.59270255733267
curr_Factors:  [99.59270256 -0.79036602 -1.00094255]
mat_Sqrt:  [[16.60626992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273277  0.01411938  0.0859571 ]
Stock Position:  -0.0027327655790670763
Bond Position:  [4.05188675]


portfolio before change:  [3.78430015]
curr_Stock_Price:  98.10322340842121
curr_Factors:  [98.10322341 -0.76473827 -0.97712003]
mat_Sqrt:  [[17.18714858  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01975289 0.10097407 1.33773666]
Stock Position:  0.019752888648297176
Bond Position:  [1.84647811]


portfolio before change:  [3.79682992]
curr_Stock_Price:  98.72586348368111
curr_Factors:  [98.72586348 -0.77667891 -0.99455536]
mat_Sqrt:  [[16.79552849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.23922347e-04 1.10160898e-02 3.46621952e-01]
Stock Position:  0.00022392234653937737
Bond Position:  [3.77472299]


portfolio before change:  [3.79730325]
curr_Stock_Price:  98.73238984259952
curr_Factors:  [98.73238984 -0.59445359 -1.00414356]
mat_Sqrt:  [[19.96170928  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00821537 -0.01959024  0.13819572]
Stock Position:  -0.008215370499506505
Bond Position:  [4.60842641]


portfolio before change:  [3.80183661]
curr_Stock_Price:  98.25069922001632
curr_Factors:  [98.25069922 -0.40128595 -0.99393833]
mat_Sqrt:  [[24.34430855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.80478839e-04 -6.50307165e-02 -7.87634486e-01]
Stock Position:  -0.0002804788392899882
Bond Position:  [3.82939385]


portfolio before change:  [3.80165038]
curr_Stock_Price:  100.62138878142348
curr_Factors:  [100.62138878  -0.29438029  -0.99681778]
mat_Sqrt:  [[27.6649641   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00131164  0.01632908 -0.02884422]
Stock Position:  0.001311641684838662
Bond Position:  [3.66967117]


portfolio before change:  [3.80258121]
curr_Stock_Price:  100.98131527804476
curr_Factors:  [100.98131528  -0.34822035  -0.98257357]
mat_Sqrt:  [[26.6860667   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00706623 -0.04684555 -0.05409167]
Stock Position:  0.007066225250106345
Bond Position:  [3.08902449]


portfolio before change:  [3.81076578]
curr_Stock_Price:  102.08493320754367
curr_Factors:  [102.08493321  -0.51732087  -0.98441354]
mat_Sqrt:  [[22.73875502  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02289293 -0.00823746 -0.19592764]
Stock Position:  -0.022892925973278088
Bond Position:  [6.1477886]


portfolio before change:  [3.82036719]
curr_Stock_Price:  101.69909817873096
curr_Factors:  [101.69909818  -0.39512285  -0.9968643 ]
mat_Sqrt:  [[25.28044792  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0014854  -0.00482652 -0.11540523]
Stock Position:  0.0014854018479434545
Bond Position:  [3.66930316]


portfolio before change:  [3.81922372]
curr_Stock_Price:  100.62049136851506
curr_Factors:  [100.62049137  -0.61852363  -0.9972529 ]
mat_Sqrt:  [[19.99694275  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0025057  -0.10212094  0.35890755]
Stock Position:  0.002505700460321026
Bond Position:  [3.56709891]


portfolio before change:  [3.82350304]
curr_Stock_Price:  102.15036407659846
curr_Factors:  [102.15036408  -0.70527741  -1.0220619 ]
mat_Sqrt:  [[18.15791545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00397213  0.00225658  0.15019092]
Stock Position:  -0.003972130984816056
Bond Position:  [4.22925766]


portfolio before change:  [3.82759336]
curr_Stock_Price:  101.25370810093342
curr_Factors:  [101.2537081   -0.49854487  -1.06758519]
mat_Sqrt:  [[21.14702592  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0081307  -0.00908646  0.79485778]
Stock Position:  0.008130702718875098
Bond Position:  [3.00432956]


portfolio before change:  [3.83687468]
curr_Stock_Price:  102.34903185061265
curr_Factors:  [102.34903185  -0.44422809  -1.08971882]
mat_Sqrt:  [[22.07491612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.004601   0.06158781 0.44079583]
Stock Position:  0.004600998966352946
Bond Position:  [3.36596689]


portfolio before change:  [3.84082809]
curr_Stock_Price:  103.11682961173813
curr_Factors:  [103.11682961  -0.38224761  -1.08559151]
mat_Sqrt:  [[23.76047517  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00180662 -0.03587186 -0.12433753]
Stock Position:  0.0018066193256397905
Bond Position:  [3.65453523]


portfolio before change:  [3.84007844]
curr_Stock_Price:  102.4490136375552
curr_Factors:  [102.44901364  -0.35607293  -1.11196756]
mat_Sqrt:  [[23.60184204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109821  0.01347092  0.1254719 ]
Stock Position:  -0.001098214981644906
Bond Position:  [3.95258949]


portfolio before change:  [3.84173834]
curr_Stock_Price:  101.38748354565236
curr_Factors:  [101.38748355  -0.10631662  -1.10192541]
mat_Sqrt:  [[30.28666831  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01122433 -0.06243142  0.21616964]
Stock Position:  -0.011224326788625179
Bond Position:  [4.97974459]


portfolio before change:  [3.84269081]
curr_Stock_Price:  101.35808630824297
curr_Factors:  [ 1.01358086e+02  2.61942504e-02 -1.09010532e+00]
mat_Sqrt:  [[34.97902473  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00441652 -0.01330634 -0.03694132]
Stock Position:  -0.004416516171490824
Bond Position:  [4.29034044]


portfolio before change:  [3.84065003]
curr_Stock_Price:  101.94160194472913
curr_Factors:  [101.94160194  -0.39290081  -1.10714816]
mat_Sqrt:  [[22.74513213  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0106357  0.29138913 0.51756383]
Stock Position:  0.010635696567575448
Bond Position:  [2.75643008]


portfolio before change:  [3.84260831]
curr_Stock_Price:  102.09332698697371
curr_Factors:  [102.09332699  -0.36200965  -1.1182018 ]
mat_Sqrt:  [[23.23537532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00076608 0.00277206 0.08721826]
Stock Position:  0.0007660752864817176
Bond Position:  [3.76439713]


portfolio before change:  [3.84162584]
curr_Stock_Price:  100.19658246553175
curr_Factors:  [100.19658247  -0.34316115  -1.12001647]
mat_Sqrt:  [[23.19545739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331686  0.0981383  -0.05384528]
Stock Position:  -0.0033168557099658544
Bond Position:  [4.17396344]


portfolio before change:  [3.84115614]
curr_Stock_Price:  100.49550312057907
curr_Factors:  [100.49550312  -0.3401968   -1.13985139]
mat_Sqrt:  [[22.87546149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00159051  0.01794207 -0.07945377]
Stock Position:  -0.0015905082432663522
Bond Position:  [4.00099506]


portfolio before change:  [3.84220453]
curr_Stock_Price:  100.15080736141125
curr_Factors:  [100.15080736  -0.40791589  -1.16155661]
mat_Sqrt:  [[20.84688681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00297923 -0.01196916  0.18460093]
Stock Position:  0.002979225097242552
Bond Position:  [3.54383273]


portfolio before change:  [3.84570041]
curr_Stock_Price:  101.17552671355804
curr_Factors:  [101.17552671  -0.58253065  -1.16167426]
mat_Sqrt:  [[17.68385334  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00492318 0.04643689 0.08417008]
Stock Position:  0.004923181032121036
Bond Position:  [3.34759498]


portfolio before change:  [3.84972367]
curr_Stock_Price:  101.90773282027851
curr_Factors:  [101.90773282  -0.70669804  -1.1758471 ]
mat_Sqrt:  [[15.51058497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261596 -0.05509147  0.34629177]
Stock Position:  -0.0026159624213207035
Bond Position:  [4.11631047]


portfolio before change:  [3.84869723]
curr_Stock_Price:  102.49681386551342
curr_Factors:  [102.49681387  -0.67450019  -1.20211181]
mat_Sqrt:  [[15.69307773  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082559  0.02004328 -0.05140267]
Stock Position:  0.0008255922211321847
Bond Position:  [3.76407665]


portfolio before change:  [3.84948936]
curr_Stock_Price:  102.88634701498604
curr_Factors:  [102.88634701  -0.81159218  -1.20430435]
mat_Sqrt:  [[13.70455718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150284 -0.02033759  0.07476561]
Stock Position:  0.001502838597011689
Bond Position:  [3.69486779]


portfolio before change:  [3.85114195]
curr_Stock_Price:  103.67865010215857
curr_Factors:  [103.6786501   -0.82660095  -1.22092719]
mat_Sqrt:  [[13.38009381  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00398661  0.01953653 -0.22136291]
Stock Position:  0.003986605147064798
Bond Position:  [3.43781611]


portfolio before change:  [3.85294519]
curr_Stock_Price:  104.02317540527872
curr_Factors:  [104.02317541  -0.75133072  -1.20906838]
mat_Sqrt:  [[14.64669362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05749624 -0.03731565 -2.78616675]
Stock Position:  -0.05749624063182206
Bond Position:  [9.83388672]


portfolio before change:  [3.9532937]
curr_Stock_Price:  102.29925058687724
curr_Factors:  [102.29925059  -0.82958208  -1.22801772]
mat_Sqrt:  [[13.06977806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01821981  0.02395154  0.01079056]
Stock Position:  -0.018219809994544343
Bond Position:  [5.81716661]


portfolio before change:  [3.96564879]
curr_Stock_Price:  101.66104988826466
curr_Factors:  [101.66104989  -0.99206864  -1.22331969]
mat_Sqrt:  [[11.0923525   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.28428463e-04  1.96703519e-02  4.83222172e-01]
Stock Position:  -0.0001284284630589492
Bond Position:  [3.97870496]


portfolio before change:  [3.96609802]
curr_Stock_Price:  102.03583553245183
curr_Factors:  [102.03583553  -1.07596274  -1.21584044]
mat_Sqrt:  [[10.31419296  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00143106 0.00080641 0.10264558]
Stock Position:  0.0014310589419182689
Bond Position:  [3.82007873]


portfolio before change:  [3.96543456]
curr_Stock_Price:  101.23851974729718
curr_Factors:  [101.23851975  -0.8836238   -1.20955129]
mat_Sqrt:  [[12.48220742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01329925 -0.00528041 -0.38700925]
Stock Position:  -0.013299253698898927
Bond Position:  [5.31183132]


portfolio before change:  [3.95557149]
curr_Stock_Price:  102.0300746591856
curr_Factors:  [102.03007466  -0.99142813  -1.24401847]
mat_Sqrt:  [[10.91154086  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00480351  0.0049611   0.16678008]
Stock Position:  -0.004803510725724176
Bond Position:  [4.44567405]


portfolio before change:  [3.95199312]
curr_Stock_Price:  102.89071763365516
curr_Factors:  [102.89071763  -1.04896431  -1.22035525]
mat_Sqrt:  [[10.63709982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01799281 -0.05398799 -0.22656923]
Stock Position:  0.017992812742239163
Bond Position:  [2.10069971]


portfolio before change:  [3.96227089]
curr_Stock_Price:  103.44733775243981
curr_Factors:  [103.44733775  -1.06358686  -1.23898995]
mat_Sqrt:  [[10.34481939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00144173 0.03621813 0.2249414 ]
Stock Position:  0.0014417307367699088
Bond Position:  [3.81312768]


portfolio before change:  [3.9635755]
curr_Stock_Price:  104.02160835937791
curr_Factors:  [104.02160836  -1.04371274  -1.21135954]
mat_Sqrt:  [[10.90832612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150951  0.0077768  -0.12309354]
Stock Position:  0.0015095075449189537
Bond Position:  [3.8065541]


portfolio before change:  [3.9643557]
curr_Stock_Price:  104.22322742373532
curr_Factors:  [104.22322742  -1.04948781  -1.21764757]
mat_Sqrt:  [[10.79841785  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00543454  0.03069635 -0.01813625]
Stock Position:  -0.0054345399997595325
Bond Position:  [4.530761]


portfolio before change:  [3.97004608]
curr_Stock_Price:  103.28036987965685
curr_Factors:  [103.28036988  -0.93349122  -1.23517618]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.97004608]
Stock Price:  103.8749667689195
PL:  [0.09507931]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.59249077e-01  4.09987638e-03  8.88996130e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.92879090e-01  1.10926201e-01  1.00640812e-01]
 [-4.52066302e-04  4.15400266e-02  1.33194431e-01]
 [-2.60210171e-01 -8.68565254e-02  4.62947222e-02]
 [-7.04162851e-03 -9.08616433e-02 -1.06054773e-01]
 [ 2.78063199e-02 -1.86670847e-01 -2.62718146e-02]
 [ 1.04485387e-01  1.82618209e-01 -1.74906668e-02]
 [-2.22535818e-01  1.20992600e-02 -1.03255746e-01]
 [ 5.75133635e-02 -2.74512626e-02 -7.56147438e-02]
 [ 1.76171702e-02 -2.66236348e-01  7.50073111e-02]
 [ 5.72117810e-04 -2.76820695e-03  8.59498691e-03]
 [ 1.74451810e-01 -1.08421933e-01  2.24861148e-01]
 [ 8.26780140e-02  1.97707662e-02 -2.38998354e-02]
 [ 5.55749415e-02 -1.03009958e-01 -5.87853501e-02]
 [-4.29392333e-02 -1.09513709e-02  2.29084308e-02]
 [-4.57755284e-01 -2.58172237e-01  1.22982280e-01]
 [-1.61083682e-01  7.47603489e-03 -2.20074673e-02]
 [ 3.04004360e-01  1.25290116e+00  4.65320477e-01]
 [-3.98629432e-02 -5.35324571e-03  5.87230050e-02]
 [-7.65830730e-02  4.82594583e-02 -3.39012402e-02]
 [ 8.83644570e-03  2.61439515e-02  5.81598610e-03]
 [ 3.03844669e-02 -3.20615412e-02  2.90825474e-02]
 [ 1.39177597e-02  6.58602329e-02  1.24491108e-01]
 [-1.03089265e-01  7.77176651e-02 -2.92398131e-02]
 [ 1.10687304e-01 -6.36430098e-02 -4.98656910e-02]
 [ 1.92064334e-02 -6.49959473e-02  1.52952559e-02]
 [-2.25076257e-02  4.13772098e-02  2.98737483e-02]
 [-5.00302544e-01  8.36708765e-02 -6.32708468e-01]
 [ 6.91755431e-02 -1.17114964e-01 -8.72903229e-02]
 [ 2.85566006e-02  4.27411063e-02  8.18410291e-02]
 [ 2.48291993e-02  1.20347076e-01 -2.21200990e-02]
 [-1.31075463e-01  8.52933127e-03 -1.54495632e-01]
 [-5.89836105e-02  1.32420268e-01  1.19741250e-01]
 [-6.53054015e-02  2.95408843e-02  7.50352370e-02]
 [-6.10053676e-02 -3.27183232e-02  9.65698503e-03]
 [ 5.09863205e-02  3.80990055e-02 -6.92149480e-03]
 [-1.17005086e-01  1.50647768e-01  4.58970616e-03]
 [ 2.51656537e-03 -2.68283699e-01  9.43519606e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.55540375]
curr_Stock_Price:  99.88402808739365
curr_Factors:  [99.88402809 -1.05478659 -1.00914386]
mat_Sqrt:  [[12.68067708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01111902  0.00129649  0.25360585]
Stock Position:  -0.011119016805654925
Bond Position:  [2.66601593]


portfolio before change:  [1.56083446]
curr_Stock_Price:  99.42558412729349
curr_Factors:  [99.42558413 -0.92351324 -1.01841262]
mat_Sqrt:  [[14.26035934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00318232  0.01411938  0.0859571 ]
Stock Position:  -0.0031823211295830016
Bond Position:  [1.8772386]


portfolio before change:  [1.55701876]
curr_Stock_Price:  100.69835706600968
curr_Factors:  [100.69835707  -0.81467004  -1.04156342]
mat_Sqrt:  [[15.73513371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02010065 0.03507794 0.28710022]
Stock Position:  0.020100649765442315
Bond Position:  [-0.46708365]


portfolio before change:  [1.54392998]
curr_Stock_Price:  100.050099987804
curr_Factors:  [100.05009999  -0.46925293  -1.0059223 ]
mat_Sqrt:  [[22.88532383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00121513 0.01313611 0.37996664]
Stock Position:  0.0012151321119062124
Bond Position:  [1.42235589]


portfolio before change:  [1.54435654]
curr_Stock_Price:  100.25481062174256
curr_Factors:  [100.25481062  -0.32792046  -1.01688066]
mat_Sqrt:  [[26.12555444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00968412 -0.02746644  0.13206596]
Stock Position:  -0.00968411701528948
Bond Position:  [2.51523586]


portfolio before change:  [1.54428564]
curr_Stock_Price:  100.29459997964129
curr_Factors:  [100.29459998  -0.31845061  -1.02874556]
mat_Sqrt:  [[26.07340134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00119033 -0.02873297 -0.30254475]
Stock Position:  -0.001190332073230311
Bond Position:  [1.66366952]


portfolio before change:  [1.54674377]
curr_Stock_Price:  98.40424110919528
curr_Factors:  [98.40424111 -0.44840184 -1.02728268]
mat_Sqrt:  [[22.49739169  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078337 -0.05903051 -0.07494617]
Stock Position:  0.0007833702635320641
Bond Position:  [1.46965681]


portfolio before change:  [1.54671113]
curr_Stock_Price:  98.12805596439998
curr_Factors:  [98.12805596 -0.53705739 -1.0517216 ]
mat_Sqrt:  [[20.03527228  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00527222  0.05774895 -0.049896  ]
Stock Position:  0.005272216931043511
Bond Position:  [1.02935873]


portfolio before change:  [1.54905284]
curr_Stock_Price:  98.54780934887614
curr_Factors:  [98.54780935 -0.79036268 -1.0599698 ]
mat_Sqrt:  [[15.49022727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0157067   0.00382612 -0.2945599 ]
Stock Position:  -0.01570670351208006
Bond Position:  [3.09691406]


portfolio before change:  [1.54779023]
curr_Stock_Price:  98.65284378296735
curr_Factors:  [98.65284378 -1.10266602 -1.06745812]
mat_Sqrt:  [[11.26254836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00367322 -0.00868085 -0.21570782]
Stock Position:  0.0036732166405063524
Bond Position:  [1.18541696]


portfolio before change:  [1.55333534]
curr_Stock_Price:  100.1221067138022
curr_Factors:  [100.12210671  -1.01217298  -1.07909629]
mat_Sqrt:  [[12.36810808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210653 -0.08419133  0.21397498]
Stock Position:  0.0021065291789271563
Bond Position:  [1.3424252]


portfolio before change:  [1.55212549]
curr_Stock_Price:  99.46811184165098
curr_Factors:  [99.46811184 -0.98967416 -1.04984502]
mat_Sqrt:  [[12.93993068  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00017427 -0.00087538  0.02451911]
Stock Position:  0.00017427352782892268
Bond Position:  [1.53479083]


portfolio before change:  [1.55245231]
curr_Stock_Price:  100.24250613112136
curr_Factors:  [100.24250613  -1.04706122  -1.07499957]
mat_Sqrt:  [[12.00750079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.018118   -0.03428603  0.64146627]
Stock Position:  0.01811800484488149
Bond Position:  [-0.2637419]


portfolio before change:  [1.55264498]
curr_Stock_Price:  100.25495986774894
curr_Factors:  [100.25495987  -1.23112046  -1.06340978]
mat_Sqrt:  [[10.10657595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00774842  0.00625207 -0.06817958]
Stock Position:  0.0077484164694594715
Bond Position:  [0.7758278]


portfolio before change:  [1.54773721]
curr_Stock_Price:  99.60905286455292
curr_Factors:  [99.60905286 -1.14133344 -1.00140567]
mat_Sqrt:  [[11.6874304   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00350083 -0.03257461 -0.16769824]
Stock Position:  0.0035008316694915345
Bond Position:  [1.19902268]


portfolio before change:  [1.54781687]
curr_Stock_Price:  99.58899507708978
curr_Factors:  [99.58899508 -1.14260079 -0.96246959]
mat_Sqrt:  [[12.13363419  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317678 -0.00346313  0.06535138]
Stock Position:  -0.0031767755662232837
Bond Position:  [1.86418876]


portfolio before change:  [1.54696066]
curr_Stock_Price:  99.9318739836164
curr_Factors:  [99.93187398 -1.06550709 -0.9796971 ]
mat_Sqrt:  [[12.92656505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03398564 -0.08164123  0.35083421]
Stock Position:  -0.03398564182292402
Bond Position:  [4.94320954]


portfolio before change:  [1.55117013]
curr_Stock_Price:  99.82619626730433
curr_Factors:  [99.82619627 -1.01862125 -0.98909013]
mat_Sqrt:  [[13.40622645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01233628  0.00236413 -0.06278118]
Stock Position:  -0.012336275840382636
Bond Position:  [2.78265362]


portfolio before change:  [1.54315207]
curr_Stock_Price:  100.50435150363606
curr_Factors:  [100.5043515   -1.05168967  -0.98540555]
mat_Sqrt:  [[13.10646736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03291026 0.39620213 1.3274298 ]
Stock Position:  0.03291026188683264
Bond Position:  [-1.76447246]


portfolio before change:  [1.53933111]
curr_Stock_Price:  100.39495133412399
curr_Factors:  [100.39495133  -0.97689534  -0.98334516]
mat_Sqrt:  [[14.13807373  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198148 -0.00169284  0.16752039]
Stock Position:  -0.0019814849419604015
Bond Position:  [1.73826219]


portfolio before change:  [1.53930348]
curr_Stock_Price:  100.51855938967098
curr_Factors:  [100.51855939  -1.08906088  -1.01403665]
mat_Sqrt:  [[12.27107474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00670333  0.01526098 -0.0967108 ]
Stock Position:  -0.006703331418715408
Bond Position:  [2.2131127]


portfolio before change:  [1.54561228]
curr_Stock_Price:  99.61868711144126
curr_Factors:  [99.61868711 -1.12351627 -1.02569675]
mat_Sqrt:  [[11.61313458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00092126 0.00826744 0.01659139]
Stock Position:  0.0009212553886124898
Bond Position:  [1.45383803]


portfolio before change:  [1.54584552]
curr_Stock_Price:  99.67458680705589
curr_Factors:  [99.67458681 -0.90221045 -1.02740153]
mat_Sqrt:  [[14.4732015   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00245233 -0.01013875  0.08296441]
Stock Position:  0.002452331755371309
Bond Position:  [1.30141036]


portfolio before change:  [1.54225859]
curr_Stock_Price:  98.14558602821056
curr_Factors:  [98.14558603 -0.85109523 -1.0027571 ]
mat_Sqrt:  [[15.37279854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00266899 0.02082683 0.35513848]
Stock Position:  0.0026689938373139735
Bond Position:  [1.28030862]


portfolio before change:  [1.53990344]
curr_Stock_Price:  97.20321133781283
curr_Factors:  [97.20321134 -0.99069491 -0.9961303 ]
mat_Sqrt:  [[13.32948548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00803115  0.02457648 -0.08341305]
Stock Position:  -0.00803115436735851
Bond Position:  [2.32055744]


portfolio before change:  [1.53612438]
curr_Stock_Price:  97.7098824056406
curr_Factors:  [97.70988241 -1.13176232 -0.97892976]
mat_Sqrt:  [[11.83795189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00835155 -0.02012569 -0.14225294]
Stock Position:  0.008351550867389996
Bond Position:  [0.72009532]


portfolio before change:  [1.53795856]
curr_Stock_Price:  97.9187253511339
curr_Factors:  [97.91872535 -1.23870102 -0.99968084]
mat_Sqrt:  [[10.44116272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197779 -0.02055352  0.04363311]
Stock Position:  0.0019777851222373423
Bond Position:  [1.34429636]


portfolio before change:  [1.5381674]
curr_Stock_Price:  97.93935245099127
curr_Factors:  [97.93935245 -1.43163484 -1.02388468]
mat_Sqrt:  [[ 8.40501798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182526  0.01308462  0.08522149]
Stock Position:  -0.0018252569374556252
Bond Position:  [1.71693188]


portfolio before change:  [1.53821981]
curr_Stock_Price:  98.02822602209554
curr_Factors:  [98.02822602 -1.33959987 -1.02482583]
mat_Sqrt:  [[ 9.2149739   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06807325  0.02645905 -1.80494115]
Stock Position:  -0.06807325269295184
Bond Position:  [8.21132001]


portfolio before change:  [1.58270871]
curr_Stock_Price:  97.38976064127142
curr_Factors:  [97.38976064 -1.16444674 -1.01192697]
mat_Sqrt:  [[11.04908226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00437444 -0.037035   -0.24901499]
Stock Position:  0.004374443419776994
Bond Position:  [1.15668271]


portfolio before change:  [1.58277566]
curr_Stock_Price:  97.37201094575055
curr_Factors:  [97.37201095 -1.2957695  -1.00099262]
mat_Sqrt:  [[ 9.79406604  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00473408 0.01351592 0.23346968]
Stock Position:  0.004734080931930036
Bond Position:  [1.12180868]


portfolio before change:  [1.5823054]
curr_Stock_Price:  97.243054987364
curr_Factors:  [97.24305499 -1.38921052 -1.01049306]
mat_Sqrt:  [[ 8.82430622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00265418  0.03805709 -0.06310249]
Stock Position:  0.002654180459972261
Bond Position:  [1.32420479]


portfolio before change:  [1.58149671]
curr_Stock_Price:  96.87600015524123
curr_Factors:  [96.87600016 -1.42504714 -1.01728216]
mat_Sqrt:  [[ 8.42414942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0192769   0.00269721 -0.44073304]
Stock Position:  -0.0192769047254727
Bond Position:  [3.44896613]


portfolio before change:  [1.57654667]
curr_Stock_Price:  97.15515225997532
curr_Factors:  [97.15515226 -1.3103818  -1.01585487]
mat_Sqrt:  [[ 9.48842407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328004  0.04187497  0.34158846]
Stock Position:  -0.0032800445286076253
Bond Position:  [1.89521989]


portfolio before change:  [1.57641402]
curr_Stock_Price:  97.2678236421554
curr_Factors:  [97.26782364 -1.47048797 -1.02477456]
mat_Sqrt:  [[ 8.0221439   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00613628  0.00934165  0.21405465]
Stock Position:  -0.00613628428626647
Bond Position:  [2.17327704]


portfolio before change:  [1.57850505]
curr_Stock_Price:  96.97133274918599
curr_Factors:  [96.97133275 -1.40520695 -1.03094209]
mat_Sqrt:  [[ 8.48471535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00705727 -0.01034644  0.02754869]
Stock Position:  -0.007057270011541303
Bond Position:  [2.26285793]


portfolio before change:  [1.57229781]
curr_Stock_Price:  97.89096783817502
curr_Factors:  [97.89096784 -1.39939891 -1.06574638]
mat_Sqrt:  [[ 8.32038892  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0060763   0.01204796 -0.0197451 ]
Stock Position:  0.006076301110265083
Bond Position:  [0.97748281]


portfolio before change:  [1.57115776]
curr_Stock_Price:  97.68323656857946
curr_Factors:  [97.68323657 -1.35728256 -1.04792632]
mat_Sqrt:  [[ 8.81558415  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01272502  0.04763901  0.01309315]
Stock Position:  -0.012725022577150693
Bond Position:  [2.81417916]


portfolio before change:  [1.57343976]
curr_Stock_Price:  97.53155116424283
curr_Factors:  [97.53155116 -1.44417535 -1.03803538]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.57343976]
Stock Price:  98.07849450911401
PL:  [1.57343976]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.41467481e-02  7.69603949e-04  1.90414732e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.48858871e-01  1.70036673e-01  2.19700022e-01]
 [ 2.27745952e-02  6.12149139e-02  1.50036586e-01]
 [-1.77762945e-01 -6.35023844e-02  4.83095206e-02]
 [ 3.34252372e-02 -1.67590914e-01 -2.21498026e-01]
 [ 2.15520730e-02 -2.65114322e-01 -3.85884767e-02]
 [ 2.83877350e-02  2.01292767e-01  9.30229874e-03]
 [-1.29280907e-01  8.82734610e-03 -4.79907085e-02]
 [ 1.66873601e-01  9.35650253e-02  4.65970158e-01]
 [ 2.48852906e-01 -2.46320254e-01 -6.58546940e-02]
 [-3.28660710e-01 -2.11664662e-01 -4.67907335e-01]
 [ 2.67038633e-01 -4.19005612e-01 -1.62535107e-01]
 [ 2.00716741e-02 -1.41963458e-01 -7.03260753e-02]
 [-2.27861117e-01  3.95679461e-01  2.82324308e-01]
 [ 4.93847717e-02 -3.60345034e-01 -9.52912291e-02]
 [ 1.50693238e-01 -2.06134324e-01 -1.13123395e-01]
 [-2.83701706e-01 -6.09221812e-02 -4.34042263e-02]
 [ 2.40158277e-01  1.11389783e+00  2.01945933e-01]
 [-3.13738242e-01 -4.81024319e-02  2.44483922e-01]
 [-9.42017278e-02  2.32587118e-01 -3.30929801e-02]
 [ 3.60983714e-02 -1.65017306e-02  3.78524770e-02]
 [-7.49225245e-02 -3.31958458e-03 -8.77677696e-02]
 [-2.50940624e-03 -9.93167069e-02  1.00471537e-01]
 [-1.14538492e-01  1.07612347e-01  5.81552534e-02]
 [ 1.12692303e-01 -5.99483601e-02 -4.33268956e-02]
 [ 3.51909135e-02 -6.61958340e-02  1.10532533e-01]
 [ 6.03144247e-03  4.16722409e-02 -4.46320413e-02]
 [-5.58752237e-01  6.45603507e-03 -7.90889086e-01]
 [-1.09569392e-01 -1.13013524e-01  1.55701511e-02]
 [-4.89738070e-02  9.19212866e-02  2.30947173e-01]
 [ 1.67856168e-02  7.73399751e-02 -1.87397586e-03]
 [-9.44912607e-02 -2.54059491e-03 -1.25558980e-01]
 [-6.11954683e-02  1.00858858e-01  1.12479283e-01]
 [-1.24197030e-01  9.72472962e-02  1.52251733e-01]
 [-1.23951063e-01 -1.24385382e-01  1.45661170e-02]
 [ 1.43917527e-01  1.20104007e-01  4.78136724e-02]
 [-2.86526142e-02  1.17031914e-01  2.18728274e-02]
 [-9.48819925e-04 -2.33927349e-01  6.52893419e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.81125752]
curr_Stock_Price:  100.19833611709777
curr_Factors:  [100.19833612  -0.94769115  -1.02804   ]
mat_Sqrt:  [[13.89349073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00649513  0.00024337  0.05432002]
Stock Position:  -0.006495131741290804
Bond Position:  [4.46205892]


portfolio before change:  [3.81269632]
curr_Stock_Price:  100.06269602155623
curr_Factors:  [100.06269602  -0.79112881  -1.00424668]
mat_Sqrt:  [[16.61692009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273101  0.01411938  0.0859571 ]
Stock Position:  -0.00273101408667876
Bond Position:  [4.08596895]


portfolio before change:  [3.81303244]
curr_Stock_Price:  100.12664749697599
curr_Factors:  [100.1266475   -0.98587583  -1.02171679]
mat_Sqrt:  [[13.44817282  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02216623 0.05377032 0.62674301]
Stock Position:  0.022166228991091278
Bond Position:  [1.59360224]


portfolio before change:  [3.79536435]
curr_Stock_Price:  99.32058757703051
curr_Factors:  [99.32058758 -0.49989327 -1.0334552 ]
mat_Sqrt:  [[21.43455636  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00256508 0.01935786 0.42801262]
Stock Position:  0.002565075125466096
Bond Position:  [3.54059958]


portfolio before change:  [3.79761408]
curr_Stock_Price:  100.0251015752854
curr_Factors:  [100.02510158  -0.27367886  -1.04196911]
mat_Sqrt:  [[26.83677627  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0063175  -0.02008122  0.13781362]
Stock Position:  -0.006317503582405837
Bond Position:  [4.42952302]


portfolio before change:  [3.80478004]
curr_Stock_Price:  98.97844862982542
curr_Factors:  [98.97844863 -0.35874622 -1.01015201]
mat_Sqrt:  [[25.17883868  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064002 -0.0529969  -0.63187221]
Stock Position:  -0.0006400230360232942
Bond Position:  [3.86812853]


portfolio before change:  [3.80596948]
curr_Stock_Price:  97.8755329648299
curr_Factors:  [97.87553296 -0.18242248 -0.9962805 ]
mat_Sqrt:  [[30.11410371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0002268  -0.08383651 -0.11008218]
Stock Position:  0.0002268043861953159
Bond Position:  [3.78377088]


portfolio before change:  [3.80621665]
curr_Stock_Price:  96.87986027201646
curr_Factors:  [96.87986027 -0.28594364 -1.00918503]
mat_Sqrt:  [[26.53177284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00133741 0.06365436 0.02653687]
Stock Position:  0.0013374121620102644
Bond Position:  [3.67664835]


portfolio before change:  [3.80736306]
curr_Stock_Price:  97.39338969342462
curr_Factors:  [97.39338969 -0.33160806 -1.00545906]
mat_Sqrt:  [[25.57694141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00542868  0.00279145 -0.13690413]
Stock Position:  -0.005428680720195193
Bond Position:  [4.33608068]


portfolio before change:  [3.81977402]
curr_Stock_Price:  95.20705487658438
curr_Factors:  [95.20705488 -0.27956642 -1.04330158]
mat_Sqrt:  [[25.36032747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01042594 0.02958786 1.32928316]
Stock Position:  0.010425937922639046
Bond Position:  [2.82715118]


portfolio before change:  [3.82138056]
curr_Stock_Price:  95.32724750250958
curr_Factors:  [95.3272475  -0.40579098 -1.05501985]
mat_Sqrt:  [[22.1205016   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01035467 -0.0778933  -0.18786511]
Stock Position:  0.01035466623678294
Bond Position:  [2.83429873]


portfolio before change:  [3.81032758]
curr_Stock_Price:  94.22559123085138
curr_Factors:  [94.22559123 -0.59999376 -1.07044295]
mat_Sqrt:  [[17.72994657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02423228 -0.06693424 -1.33480939]
Stock Position:  -0.024232281298203158
Bond Position:  [6.09362862]


portfolio before change:  [3.80768658]
curr_Stock_Price:  94.36601352821036
curr_Factors:  [94.36601353 -0.69793214 -1.10117099]
mat_Sqrt:  [[15.6125933   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01428607 -0.13250121 -0.46366742]
Stock Position:  0.014286070894172304
Bond Position:  [2.45956702]


portfolio before change:  [3.80841221]
curr_Stock_Price:  94.3952838036337
curr_Factors:  [94.3952838  -0.60469119 -1.10900839]
mat_Sqrt:  [[17.00983204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.20573996e-04 -4.48927871e-02 -2.00620718e-01]
Stock Position:  0.0001205739958605557
Bond Position:  [3.79703059]


portfolio before change:  [3.80897121]
curr_Stock_Price:  95.09479071531248
curr_Factors:  [95.09479072 -0.78505569 -1.10420031]
mat_Sqrt:  [[14.37683448  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01113009  0.12512483  0.80539267]
Stock Position:  -0.011130093315629712
Bond Position:  [4.8673851]


portfolio before change:  [3.80620256]
curr_Stock_Price:  95.39821239647199
curr_Factors:  [95.3982124  -0.85104993 -1.11082002]
mat_Sqrt:  [[13.41253728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00153807 -0.11395111 -0.27183935]
Stock Position:  0.0015380730604491373
Bond Position:  [3.65947314]


portfolio before change:  [3.80637685]
curr_Stock_Price:  95.21410366465574
curr_Factors:  [95.21410366 -0.93762423 -1.09963824]
mat_Sqrt:  [[12.41450579  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00984974 -0.0651854  -0.32270956]
Stock Position:  0.009849740166394035
Bond Position:  [2.86854266]


portfolio before change:  [3.80385966]
curr_Stock_Price:  94.92213931839696
curr_Factors:  [94.92213932 -0.62520906 -1.12980309]
mat_Sqrt:  [[16.41252593  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01792135 -0.01926529 -0.12382018]
Stock Position:  -0.01792134626184307
Bond Position:  [5.50499219]


portfolio before change:  [3.79944966]
curr_Stock_Price:  95.20661428405464
curr_Factors:  [95.20661428 -0.57648719 -1.10920041]
mat_Sqrt:  [[17.64340082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0175783  0.35224542 0.57609554]
Stock Position:  0.017578302448798284
Bond Position:  [2.125879]


portfolio before change:  [3.81943553]
curr_Stock_Price:  96.32845904425973
curr_Factors:  [96.32845904 -0.59478859 -1.10908966]
mat_Sqrt:  [[17.52950658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01512166 -0.01521132  0.69744458]
Stock Position:  -0.015121656090691693
Bond Position:  [5.27608136]


portfolio before change:  [3.80247214]
curr_Stock_Price:  97.49387044795589
curr_Factors:  [97.49387045 -0.53743061 -1.13110895]
mat_Sqrt:  [[18.37975787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00516609  0.0735505  -0.09440506]
Stock Position:  -0.005166087127157505
Bond Position:  [4.30613396]


portfolio before change:  [3.8061364]
curr_Stock_Price:  96.88877773630628
curr_Factors:  [96.88877774 -0.60455449 -1.11473538]
mat_Sqrt:  [[17.36182495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00249967 -0.00521831  0.10798258]
Stock Position:  0.002499674038714554
Bond Position:  [3.56394603]


portfolio before change:  [3.80651786]
curr_Stock_Price:  96.86315101868
curr_Factors:  [96.86315102 -0.41665505 -1.14614682]
mat_Sqrt:  [[20.29749126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00457809 -0.00104974 -0.25037702]
Stock Position:  -0.004578090736343683
Bond Position:  [4.24996615]


portfolio before change:  [3.81336785]
curr_Stock_Price:  95.48294543650108
curr_Factors:  [95.48294544 -0.45271519 -1.14965134]
mat_Sqrt:  [[19.23210696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00080256 -0.0314067   0.28661733]
Stock Position:  0.000802559704919098
Bond Position:  [3.73673708]


portfolio before change:  [3.81439949]
curr_Stock_Price:  96.18634823958303
curr_Factors:  [96.18634824 -0.47523189 -1.16234874]
mat_Sqrt:  [[18.70342766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00534068  0.03403001  0.16590075]
Stock Position:  -0.00534068209627052
Bond Position:  [4.3281002]


portfolio before change:  [3.80763087]
curr_Stock_Price:  97.55502542732093
curr_Factors:  [97.55502543 -0.66950296 -1.16286108]
mat_Sqrt:  [[15.61219809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00655259 -0.01895734 -0.12359957]
Stock Position:  0.00655259286144747
Bond Position:  [3.1683925]


portfolio before change:  [3.81175721]
curr_Stock_Price:  98.12430713407716
curr_Factors:  [98.12430713 -0.41283161 -1.17012086]
mat_Sqrt:  [[20.15157895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00278113 -0.02093296  0.31531855]
Stock Position:  0.002781127141248351
Bond Position:  [3.53886104]


portfolio before change:  [3.81705433]
curr_Stock_Price:  99.86990596439615
curr_Factors:  [99.86990596 -0.71726888 -1.1744664 ]
mat_Sqrt:  [[15.06136888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00013299  0.01317792 -0.12732279]
Stock Position:  -0.0001329933678235439
Bond Position:  [3.83033636]


portfolio before change:  [3.81750933]
curr_Stock_Price:  100.04901879616929
curr_Factors:  [100.0490188   -0.73034217  -1.19233929]
mat_Sqrt:  [[14.62860399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.92203564e-02  2.04157755e-03 -2.25618642e+00]
Stock Position:  -0.04922035637436551
Bond Position:  [8.74195769]


portfolio before change:  [3.81371409]
curr_Stock_Price:  100.1483283983602
curr_Factors:  [100.1483284  -0.3458023  -1.191397 ]
mat_Sqrt:  [[21.530124    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00507703 -0.03573801  0.04441731]
Stock Position:  -0.0050770327795502754
Bond Position:  [4.32217043]


portfolio before change:  [3.81206258]
curr_Stock_Price:  100.58004089178017
curr_Factors:  [100.58004089  -0.49235444  -1.21411895]
mat_Sqrt:  [[18.2557564   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.96610440e-05 2.90680631e-02 6.58828003e-01]
Stock Position:  2.9661043976107653e-05
Bond Position:  [3.80907927]


portfolio before change:  [3.81248119]
curr_Stock_Price:  98.63968189577606
curr_Factors:  [98.6396819  -0.30311574 -1.1965349 ]
mat_Sqrt:  [[22.01717863  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00083571  0.02445705 -0.00534593]
Stock Position:  0.0008357111953873979
Bond Position:  [3.7300469]


portfolio before change:  [3.81199502]
curr_Stock_Price:  97.49998591103862
curr_Factors:  [ 9.74999859e+01 -2.96880184e-02 -1.22138234e+00]
mat_Sqrt:  [[27.90432998  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430709 -0.00080341 -0.35818482]
Stock Position:  -0.004307090627795235
Bond Position:  [4.23193629]


portfolio before change:  [3.8124875]
curr_Stock_Price:  97.5084688852966
curr_Factors:  [ 9.75084689e+01  4.64030587e-02 -1.19276521e+00]
mat_Sqrt:  [[30.98728872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00114988  0.03189437  0.32087209]
Stock Position:  -0.0011498768612466948
Bond Position:  [3.92461024]


portfolio before change:  [3.8127726]
curr_Stock_Price:  97.68719657846535
curr_Factors:  [97.68719658  0.2453555  -1.18460932]
mat_Sqrt:  [[38.1878222   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237269  0.0307523   0.43433182]
Stock Position:  -0.002372689923190337
Bond Position:  [4.04455402]


portfolio before change:  [3.81849478]
curr_Stock_Price:  95.48860006965901
curr_Factors:  [95.48860007  0.30468631 -1.18265015]
mat_Sqrt:  [[39.687768    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00312916 -0.03933411  0.04155308]
Stock Position:  -0.0031291601842074264
Bond Position:  [4.11729391]


portfolio before change:  [3.82066861]
curr_Stock_Price:  94.95838209081445
curr_Factors:  [94.95838209  0.5832645  -1.16127632]
mat_Sqrt:  [[53.27285341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00294293 0.03798022 0.1363991 ]
Stock Position:  0.0029429346042420465
Bond Position:  [3.54121231]


portfolio before change:  [3.82678288]
curr_Stock_Price:  96.88556783720888
curr_Factors:  [96.88556784  0.64740113 -1.16988584]
mat_Sqrt:  [[57.45751782  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036838  0.03700874  0.06239709]
Stock Position:  -0.0003683780949359299
Bond Position:  [3.8624734]


portfolio before change:  [3.8266868]
curr_Stock_Price:  98.45708841015556
curr_Factors:  [98.45708841  0.65515542 -1.17108468]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.8266868]
Stock Price:  97.91149489791704
PL:  [3.8266868]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [ 6.62925416e-02  6.84755411e-02  3.06744185e-01]
 [-5.64111418e-02  4.75689013e-02  3.66489667e-02]
 [ 1.93321662e-01  2.75321841e-01  4.21084200e-01]
 [-7.48347578e-02  3.42546686e-02  9.81246804e-02]
 [-6.87854038e-01 -2.07991653e-01  3.58442046e-02]
 [ 4.90334402e-02 -1.85869953e-01 -2.49433009e-01]
 [ 3.05932195e-02 -1.30698410e-01 -2.26862515e-02]
 [ 2.27894699e-01  2.29357340e-01 -6.86489140e-02]
 [-1.94393694e-01  1.69804158e-02 -1.11287878e-01]
 [ 1.01104090e-01 -1.86041531e-02  5.22898117e-02]
 [ 1.00620750e-01 -1.96622674e-01 -1.61292925e-02]
 [-5.76034448e-02 -6.25647389e-02 -1.35001864e-01]
 [ 2.90302409e-01 -3.26156674e-01 -3.03521304e-02]
 [ 8.69999379e-02 -6.42832893e-02 -5.24766327e-02]
 [-1.07716175e-01  1.03132441e-01  8.50144489e-02]
 [ 1.03495269e-02 -2.46405772e-01 -5.30211649e-02]
 [-3.48653818e-01 -2.98784325e-01  8.59882202e-02]
 [-2.00168909e-01 -7.05781109e-03 -3.91279573e-02]
 [ 3.54838694e-01  1.33209349e+00  6.05134666e-01]
 [-1.46534107e-01 -1.16117915e-02  1.46674085e-01]
 [-8.96281452e-02  8.42307885e-02 -4.00493810e-02]
 [ 7.21082603e-02 -2.15339636e-03  4.23313098e-02]
 [-9.27972909e-02 -1.49302489e-03 -1.00992059e-01]
 [-4.17778032e-03 -5.57569179e-02  1.18255561e-01]
 [-9.82449986e-02  4.73026767e-02 -3.34255972e-02]
 [ 1.17070639e-01 -2.35807984e-02 -6.74287527e-03]
 [ 4.63438909e-03 -4.44200468e-02 -2.60114728e-02]
 [ 3.60772567e-03  4.17466983e-02 -1.34875251e-02]
 [-5.76402390e-01  7.73656400e-02 -7.45881898e-01]
 [-1.04717318e-01 -5.36006650e-02 -6.11714986e-03]
 [-9.02798921e-02  9.22946337e-02  2.11615573e-01]
 [ 1.25205533e-02  4.01245462e-02  1.62752041e-02]
 [-1.26129457e-01 -1.60062527e-03 -1.40324383e-01]
 [-6.70370778e-02 -3.90106961e-02  2.37729000e-02]
 [ 2.11480192e-01 -1.66922858e-01 -7.22092605e-02]
 [ 1.92161458e-02  3.40072870e-02  6.75437174e-02]
 [-3.19431144e-02 -3.80298857e-02 -4.56314186e-02]
 [-9.98635088e-02 -2.20602861e-02  2.46882558e-03]
 [-3.44022918e-02 -2.81177097e-01  1.40881469e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.3518026]
curr_Stock_Price:  98.92164726388967
curr_Factors:  [98.92164726 -1.05444487 -1.00566343]
mat_Sqrt:  [[12.60659127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01036557 0.02165387 0.87505578]
Stock Position:  0.010365567042727664
Bond Position:  [-6.37718156]


portfolio before change:  [-5.34950027]
curr_Stock_Price:  99.22066867514448
curr_Factors:  [99.22066868 -1.17480752 -1.00178891]
mat_Sqrt:  [[11.25429588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423856  0.01504261  0.1045493 ]
Stock Position:  -0.004238557397475266
Bond Position:  [-4.92894777]


portfolio before change:  [-5.3479536]
curr_Stock_Price:  98.71039516755215
curr_Factors:  [98.71039517 -1.11371871 -0.98295738]
mat_Sqrt:  [[12.12796776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02361351 0.08706441 1.20123602]
Stock Position:  0.023613510515353365
Bond Position:  [-7.67885256]


portfolio before change:  [-5.33936975]
curr_Stock_Price:  99.1145605476921
curr_Factors:  [99.11456055 -1.21119913 -0.97415909]
mat_Sqrt:  [[11.14418832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483846  0.01083228  0.2799224 ]
Stock Position:  -0.004838458215279463
Bond Position:  [-4.85980809]


portfolio before change:  [-5.34235727]
curr_Stock_Price:  99.6064534220697
curr_Factors:  [99.60645342 -1.0591612  -0.97440576]
mat_Sqrt:  [[13.03528612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0526193  -0.06577274  0.10225354]
Stock Position:  -0.052619304715892136
Bond Position:  [-0.10113495]


portfolio before change:  [-5.26027235]
curr_Stock_Price:  98.04623581607137
curr_Factors:  [98.04623582 -1.00696176 -0.968266  ]
mat_Sqrt:  [[13.60192605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.91180521e-04 -5.87772400e-02 -7.11562946e-01]
Stock Position:  -0.0004911805214631839
Bond Position:  [-5.21211395]


portfolio before change:  [-5.26128898]
curr_Stock_Price:  98.78950169061967
curr_Factors:  [98.78950169 -1.11005439 -0.98133054]
mat_Sqrt:  [[12.20207971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185114 -0.04133047 -0.06471756]
Stock Position:  0.0018511425894075892
Bond Position:  [-5.44416244]


portfolio before change:  [-5.26356764]
curr_Stock_Price:  97.92620129516804
curr_Factors:  [97.9262013  -1.11971334 -0.95887992]
mat_Sqrt:  [[12.25116312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01794146  0.07252916 -0.19583624]
Stock Position:  0.017941462141817494
Bond Position:  [-7.02050687]


portfolio before change:  [-5.25431272]
curr_Stock_Price:  98.4909565346144
curr_Factors:  [98.49095653 -1.16469838 -0.94457639]
mat_Sqrt:  [[11.9495063   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01813228  0.00536968 -0.31747334]
Stock Position:  -0.018132280905660075
Bond Position:  [-3.46844703]


portfolio before change:  [-5.24283776]
curr_Stock_Price:  97.83419717590613
curr_Factors:  [97.83419718 -1.2134358  -0.91812249]
mat_Sqrt:  [[11.60824815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00958778 -0.00588315  0.14916828]
Stock Position:  0.00958778143528866
Bond Position:  [-6.18085066]


portfolio before change:  [-5.24278246]
curr_Stock_Price:  97.92055219587708
curr_Factors:  [97.9205522  -1.29719597 -0.93703547]
mat_Sqrt:  [[10.48478354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00879862 -0.06217755 -0.04601238]
Stock Position:  0.008798617162389801
Bond Position:  [-6.10434791]


portfolio before change:  [-5.24640977]
curr_Stock_Price:  97.59502177803374
curr_Factors:  [97.59502178 -1.24618229 -0.93568693]
mat_Sqrt:  [[11.01168814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00788035 -0.01978471 -0.38512274]
Stock Position:  -0.007880353887032825
Bond Position:  [-4.47732646]


portfolio before change:  [-5.24516056]
curr_Stock_Price:  97.365475328228
curr_Factors:  [97.36547533 -1.23900835 -0.92662623]
mat_Sqrt:  [[11.16559424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02469062 -0.1031398  -0.08658618]
Stock Position:  0.02469062292260812
Bond Position:  [-7.6491748]


portfolio before change:  [-5.24389074]
curr_Stock_Price:  97.45563214773365
curr_Factors:  [97.45563215 -1.22599288 -0.91772829]
mat_Sqrt:  [[11.423539    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00653286 -0.02032816 -0.14970123]
Stock Position:  0.00653286190148179
Bond Position:  [-5.88055493]


portfolio before change:  [-5.24351352]
curr_Stock_Price:  97.62589929579624
curr_Factors:  [97.6258993  -1.11055228 -0.8637805 ]
mat_Sqrt:  [[13.55573962  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00646957  0.03261334  0.24252256]
Stock Position:  -0.006469569921715283
Bond Position:  [-4.61191594]


portfolio before change:  [-5.24275005]
curr_Stock_Price:  97.41877572037389
curr_Factors:  [97.41877572 -1.27135486 -0.84944025]
mat_Sqrt:  [[11.68404047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058503 -0.07792035 -0.15125463]
Stock Position:  -0.0005850324407214783
Bond Position:  [-5.1857569]


portfolio before change:  [-5.24374857]
curr_Stock_Price:  98.01748294242203
curr_Factors:  [98.01748294 -1.33813755 -0.87078332]
mat_Sqrt:  [[10.76419108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03147623 -0.0944839   0.24530046]
Stock Position:  -0.03147622723499773
Bond Position:  [-2.15852801]


portfolio before change:  [-5.24625683]
curr_Stock_Price:  98.08859776713702
curr_Factors:  [98.08859777 -1.75023565 -0.87555694]
mat_Sqrt:  [[ 7.09988469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02934387 -0.00223188 -0.11162117]
Stock Position:  -0.02934387116789411
Bond Position:  [-2.36795766]


portfolio before change:  [-5.2312462]
curr_Stock_Price:  97.56696789286092
curr_Factors:  [97.56696789 -1.51088879 -0.8424754 ]
mat_Sqrt:  [[ 9.27362917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05529182 0.42124495 1.72628076]
Stock Position:  0.05529181581264178
Bond Position:  [-10.62590102]


portfolio before change:  [-5.2388387]
curr_Stock_Price:  97.45367483481638
curr_Factors:  [97.45367483 -1.68481977 -0.84553806]
mat_Sqrt:  [[ 7.76028687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01506313 -0.00367197  0.41842034]
Stock Position:  -0.015063128656637781
Bond Position:  [-3.77088146]


portfolio before change:  [-5.24156994]
curr_Stock_Price:  97.60369959909228
curr_Factors:  [97.6036996  -1.55712334 -0.84750217]
mat_Sqrt:  [[ 8.81354625  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01085016  0.02663611 -0.11424974]
Stock Position:  -0.010850157077559142
Bond Position:  [-4.18255446]


portfolio before change:  [-5.24694053]
curr_Stock_Price:  98.05048988208596
curr_Factors:  [98.05048988 -1.27930063 -0.88605105]
mat_Sqrt:  [[11.24733115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00717446 -0.00068096  0.12075944]
Stock Position:  0.007174457757676103
Bond Position:  [-5.95039963]


portfolio before change:  [-5.25446109]
curr_Stock_Price:  97.10592915914178
curr_Factors:  [97.10592916 -1.13722307 -0.87981215]
mat_Sqrt:  [[12.91988015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0087811  -0.00047214 -0.28810223]
Stock Position:  -0.008781099909960713
Bond Position:  [-4.40176422]


portfolio before change:  [-5.25965781]
curr_Stock_Price:  97.63507342520455
curr_Factors:  [97.63507343 -0.97638563 -0.876426  ]
mat_Sqrt:  [[15.30875906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120986 -0.01763189  0.3373502 ]
Stock Position:  0.0012098562274786096
Bond Position:  [-5.37778222]


portfolio before change:  [-5.25981213]
curr_Stock_Price:  98.06317724606927
curr_Factors:  [98.06317725 -0.81809955 -0.89302357]
mat_Sqrt:  [[17.71636558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00586162  0.01495842 -0.09535393]
Stock Position:  -0.0058616209790974625
Bond Position:  [-4.68500296]


portfolio before change:  [-5.2645274]
curr_Stock_Price:  98.76769264529786
curr_Factors:  [98.76769265 -0.96842409 -0.92872082]
mat_Sqrt:  [[14.81478467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00776828 -0.0074569  -0.01923555]
Stock Position:  0.007768280409450319
Bond Position:  [-6.03178253]


portfolio before change:  [-5.2617028]
curr_Stock_Price:  99.22836305510275
curr_Factors:  [99.22836306 -1.12850722 -0.91912179]
mat_Sqrt:  [[12.80447704  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0001423  -0.01404685 -0.07420349]
Stock Position:  -0.00014230188714113129
Bond Position:  [-5.24758242]


portfolio before change:  [-5.26234513]
curr_Stock_Price:  99.13237320957634
curr_Factors:  [99.13237321 -1.22781754 -0.93785517]
mat_Sqrt:  [[11.3677836   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00017     0.01320147 -0.03847615]
Stock Position:  0.0001699971882445619
Bond Position:  [-5.27919736]


portfolio before change:  [-5.26295327]
curr_Stock_Price:  99.43710566547523
curr_Factors:  [99.43710567 -1.48100116 -0.93750524]
mat_Sqrt:  [[ 8.85532473  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0820588   0.02446516 -2.12779344]
Stock Position:  -0.08205880018690728
Bond Position:  [2.89673632]


portfolio before change:  [-5.31871692]
curr_Stock_Price:  100.12107575260937
curr_Factors:  [100.12107575  -1.8173726   -0.93096716]
mat_Sqrt:  [[ 6.4111615   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01674423 -0.01695002 -0.01745053]
Stock Position:  -0.016744226296015668
Bond Position:  [-3.64226697]


portfolio before change:  [-5.32164979]
curr_Stock_Price:  100.26904086354729
curr_Factors:  [100.26904086  -1.96303139  -0.9527755 ]
mat_Sqrt:  [[ 5.43060257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00823132  0.02918613  0.60368033]
Stock Position:  -0.008231316212321255
Bond Position:  [-4.49630361]


portfolio before change:  [-5.32326196]
curr_Stock_Price:  100.39661465303331
curr_Factors:  [100.39661465  -1.95679562  -0.93232067]
mat_Sqrt:  [[ 5.58459657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00302237 0.0126885  0.04642863]
Stock Position:  0.0030223717147012017
Bond Position:  [-5.62669785]


portfolio before change:  [-5.32245917]
curr_Stock_Price:  100.89495603658446
curr_Factors:  [100.89495604  -1.95117091  -0.93653973]
mat_Sqrt:  [[ 5.62021147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02754601 -0.00050616 -0.40030641]
Stock Position:  -0.027546006109508716
Bond Position:  [-2.5432061]


portfolio before change:  [-5.3137599]
curr_Stock_Price:  100.56760563599684
curr_Factors:  [100.56760564  -1.78857065  -0.94119571]
mat_Sqrt:  [[ 6.56048039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00963218 -0.01233627  0.06781747]
Stock Position:  -0.009632176765588652
Bond Position:  [-4.34507494]


portfolio before change:  [-5.31238985]
curr_Stock_Price:  100.36897756730806
curr_Factors:  [100.36897757  -1.67811432  -0.94746075]
mat_Sqrt:  [[ 7.26652437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0264818  -0.05278564 -0.20599292]
Stock Position:  0.026481795056379487
Bond Position:  [-7.97034054]


portfolio before change:  [-5.31824529]
curr_Stock_Price:  100.18548979560651
curr_Factors:  [100.1854898   -1.55483361  -0.96201772]
mat_Sqrt:  [[ 8.08630617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00418999 0.01075405 0.19268343]
Stock Position:  0.004189986515424784
Bond Position:  [-5.73802114]


portfolio before change:  [-5.31626747]
curr_Stock_Price:  100.82871798770348
curr_Factors:  [100.82871799  -1.54263212  -0.96692534]
mat_Sqrt:  [[ 8.19779943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00515254 -0.01202611 -0.13017374]
Stock Position:  -0.00515254324794095
Bond Position:  [-4.79674314]


portfolio before change:  [-5.31967451]
curr_Stock_Price:  101.37357747410998
curr_Factors:  [101.37357747  -1.67676394  -0.94456516]
mat_Sqrt:  [[ 7.37048407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01355802 -0.00697607  0.00704287]
Stock Position:  -0.013558018038557638
Bond Position:  [-3.94524972]


portfolio before change:  [-5.31770313]
curr_Stock_Price:  101.1917984707935
curr_Factors:  [101.19179847  -1.49615102  -0.95880437]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.31770313]
Stock Price:  101.31960851469533
PL:  [-6.63731165]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-6.99409255e-02  2.43231678e-02  1.36117694e-02]
 [-3.27698924e-02  1.31102291e-02 -2.60795669e-02]
 [ 2.73121425e-01 -4.11393948e-02 -1.28885371e-01]
 [-1.23694950e-02  3.14449870e-02  1.24552845e-01]
 [-3.92998642e-01 -1.24470413e-01  4.30497131e-02]
 [ 3.96714459e-02 -1.78690387e-01 -2.37423848e-01]
 [ 3.60007923e-02 -3.46923942e-02 -2.45513426e-02]
 [ 2.28494432e-01 -1.59043431e-01 -3.00091563e-02]
 [-3.93012218e-01 -1.66431716e-02 -5.80779707e-02]
 [ 6.13059741e-02 -3.68128819e-02 -6.77691941e-02]
 [ 1.10950594e-01 -2.99184446e-01  1.09569286e-02]
 [-2.70649768e-02 -4.57665054e-02 -9.74953130e-02]
 [ 1.81017049e-01 -1.43750338e-01  1.74658086e-01]
 [ 8.57524657e-02 -5.94899433e-02 -5.93655741e-02]
 [-5.05673422e-02 -1.34266573e-02  1.01677287e-02]
 [ 4.46681071e-03 -1.83145374e-01 -3.63517690e-02]
 [-4.02688676e-01 -2.46572788e-01  1.00876946e-01]
 [-1.70979837e-01 -6.16941231e-03 -2.48463819e-02]
 [ 3.14004563e-01  1.31950826e+00  4.54001470e-01]
 [-1.33162674e-01 -1.81184506e-02  1.16284176e-01]
 [-9.35128974e-02  2.10243069e-01 -3.41406884e-02]
 [-4.30815994e-03  3.28368959e-02 -2.43469034e-03]
 [ 4.60898234e-02 -3.65614039e-02  6.09025066e-02]
 [ 6.62967640e-02  2.41509844e-01  8.30862562e-02]
 [-5.95868461e-02 -1.74650343e-01  1.41417189e-01]
 [ 2.86066777e-02  5.73263635e-02 -1.29608539e-02]
 [ 1.00272107e-02 -5.46245773e-02 -1.67751304e-02]
 [ 5.74737870e-03  4.17600492e-02 -4.88929903e-02]
 [-6.40528649e-01 -3.39832423e-02 -9.45649125e-01]
 [-2.29901918e-01  3.67451509e-02  1.92941355e-02]
 [-2.06561325e-02  5.91683168e-02  1.68035294e-01]
 [ 1.86267058e-02  8.75176021e-02 -6.67980000e-03]
 [-1.32518737e-01 -1.51998237e-02 -1.17412730e-01]
 [-6.29731583e-02  5.82944399e-02  8.54845909e-02]
 [ 2.29319157e-01 -1.74803975e-01 -7.44535324e-02]
 [-9.11513371e-03  1.50239686e-01  8.00487068e-02]
 [ 7.30839998e-02  6.36544486e-02 -3.28698691e-02]
 [-4.40974003e-02  8.54640478e-02 -7.96993472e-03]
 [-7.81649924e-02 -2.34515128e-01  8.25602477e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.16387541]
curr_Stock_Price:  100.94411618437236
curr_Factors:  [100.94411618  -1.08073305  -0.98699022]
mat_Sqrt:  [[12.76674557  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00521154  0.00769166  0.03883059]
Stock Position:  -0.005211540631114344
Bond Position:  [9.68994977]


portfolio before change:  [9.16445893]
curr_Stock_Price:  101.06458036676874
curr_Factors:  [101.06458037  -1.03971437  -1.01297376]
mat_Sqrt:  [[12.975612    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00290968  0.00414582 -0.07439775]
Stock Position:  -0.0029096783254286217
Bond Position:  [9.45852435]


portfolio before change:  [9.16594391]
curr_Stock_Price:  100.96058475661206
curr_Factors:  [100.96058476  -1.01871912  -1.0239041 ]
mat_Sqrt:  [[13.09338286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01876907 -0.01300942 -0.36767409]
Stock Position:  0.018769068095951854
Bond Position:  [7.27100782]


portfolio before change:  [9.14594828]
curr_Stock_Price:  99.84680723914562
curr_Factors:  [99.84680724 -1.00639885 -1.00934076]
mat_Sqrt:  [[13.30177475  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00104247 0.00994378 0.3553146 ]
Stock Position:  0.0010424664658347826
Bond Position:  [9.04186133]


portfolio before change:  [9.1463384]
curr_Stock_Price:  99.13677638106121
curr_Factors:  [99.13677638 -0.78649183 -0.99688979]
mat_Sqrt:  [[16.66180298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02325228 -0.039361    0.12280885]
Stock Position:  -0.02325228360668539
Bond Position:  [11.45149484]


portfolio before change:  [9.16397597]
curr_Stock_Price:  98.43981056483483
curr_Factors:  [98.43981056 -0.70534744 -1.010105  ]
mat_Sqrt:  [[17.70758114  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075709 -0.05650686 -0.67730415]
Stock Position:  -0.0007570915549138271
Bond Position:  [9.23850392]


portfolio before change:  [9.16415069]
curr_Stock_Price:  99.73445741545412
curr_Factors:  [99.73445742 -0.54359932 -1.04401084]
mat_Sqrt:  [[20.38707398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147611 -0.0109707  -0.07003815]
Stock Position:  0.0014761076918387052
Bond Position:  [9.01693189]


portfolio before change:  [9.167209]
curr_Stock_Price:  101.04271435048764
curr_Factors:  [101.04271435  -0.48541616  -1.01600516]
mat_Sqrt:  [[22.51365521  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00969467 -0.05029395 -0.08560777]
Stock Position:  0.009694665449719472
Bond Position:  [8.18763369]


portfolio before change:  [9.15428032]
curr_Stock_Price:  99.60355164044046
curr_Factors:  [99.60355164 -0.52668676 -1.0159347 ]
mat_Sqrt:  [[21.29721604  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01903052 -0.00526303 -0.16568028]
Stock Position:  -0.019030518261956272
Bond Position:  [11.04978753]


portfolio before change:  [9.15407985]
curr_Stock_Price:  99.6866696345373
curr_Factors:  [99.68666963 -0.43674231 -1.02496361]
mat_Sqrt:  [[23.11140075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00201295 -0.01164126 -0.19332665]
Stock Position:  0.0020129520191684955
Bond Position:  [8.95341537]


portfolio before change:  [9.15212871]
curr_Stock_Price:  98.16135164109392
curr_Factors:  [98.16135164 -0.57952778 -0.9999734 ]
mat_Sqrt:  [[20.22888202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00521345 -0.09461043  0.03125707]
Stock Position:  0.0052134496568005265
Bond Position:  [8.64036944]


portfolio before change:  [9.15525837]
curr_Stock_Price:  98.55447873414803
curr_Factors:  [98.55447873 -0.44751016 -0.98993114]
mat_Sqrt:  [[23.41011454  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00205671 -0.01447264 -0.27812699]
Stock Position:  -0.002056709729419757
Bond Position:  [9.35795632]


portfolio before change:  [9.15462386]
curr_Stock_Price:  99.43176548501613
curr_Factors:  [99.43176549 -0.65046689 -0.99022274]
mat_Sqrt:  [[19.27448133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01104867 -0.04545785  0.49825091]
Stock Position:  0.011048668976799524
Bond Position:  [8.0560352]


portfolio before change:  [9.15510717]
curr_Stock_Price:  99.38436068099566
curr_Factors:  [99.38436068 -0.3079839  -0.99974221]
mat_Sqrt:  [[26.87693964  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00268254 -0.01881237 -0.16935346]
Stock Position:  0.002682541089628682
Bond Position:  [8.88850454]


portfolio before change:  [9.15640803]
curr_Stock_Price:  99.45508830163041
curr_Factors:  [99.4550883  -0.30442126 -1.01926904]
mat_Sqrt:  [[26.47010186  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184505 -0.00424588  0.0290057 ]
Stock Position:  -0.0018450453389514973
Bond Position:  [9.33990718]


portfolio before change:  [9.15981887]
curr_Stock_Price:  98.23924923639188
curr_Factors:  [98.23924924 -0.57388148 -1.04604899]
mat_Sqrt:  [[19.44277142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039512 -0.05791565 -0.10370148]
Stock Position:  -0.0003951214634149463
Bond Position:  [9.19863531]


portfolio before change:  [9.16065663]
curr_Stock_Price:  99.02923365608805
curr_Factors:  [99.02923366 -0.79113195 -1.03149436]
mat_Sqrt:  [[16.00320121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02427413 -0.07797316  0.28777385]
Stock Position:  -0.024274126934939206
Bond Position:  [11.56450482]


portfolio before change:  [9.1475071]
curr_Stock_Price:  99.63049881523547
curr_Factors:  [99.63049882 -0.74133241 -1.04394278]
mat_Sqrt:  [[16.71310488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01054328 -0.00195094 -0.07087981]
Stock Position:  -0.010543275994127074
Bond Position:  [10.19793895]


portfolio before change:  [9.15666238]
curr_Stock_Price:  98.88305986201082
curr_Factors:  [98.88305986 -0.80558905 -1.03225258]
mat_Sqrt:  [[15.73828541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02800475 0.41726515 1.29513982]
Stock Position:  0.02800475211038398
Bond Position:  [6.3874668]


portfolio before change:  [9.1729228]
curr_Stock_Price:  99.43517832666227
curr_Factors:  [99.43517833 -0.89662408 -1.04379742]
mat_Sqrt:  [[14.28320612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00769394 -0.00572956  0.33172639]
Stock Position:  -0.007693936624544664
Bond Position:  [9.93797076]


portfolio before change:  [9.17676501]
curr_Stock_Price:  99.09726497059278
curr_Factors:  [99.09726497 -1.00653954 -1.0326677 ]
mat_Sqrt:  [[12.89570872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00737093  0.0664847  -0.09739388]
Stock Position:  -0.007370931337848462
Bond Position:  [9.90720414]


portfolio before change:  [9.17289306]
curr_Stock_Price:  99.79058698226218
curr_Factors:  [99.79058698 -0.99797769 -1.0378742 ]
mat_Sqrt:  [[13.02957745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030372  0.01038394 -0.00694549]
Stock Position:  -0.00030371622070120264
Bond Position:  [9.20320108]


portfolio before change:  [9.1739281]
curr_Stock_Price:  100.17064296516946
curr_Factors:  [100.17064297  -0.60421443  -1.04631542]
mat_Sqrt:  [[19.22757251  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00299453 -0.01156173  0.1737379 ]
Stock Position:  0.0029945269503055686
Bond Position:  [8.87396441]


portfolio before change:  [9.17511849]
curr_Stock_Price:  100.19771701528097
curr_Factors:  [100.19771702  -0.51721106  -1.03796392]
mat_Sqrt:  [[21.15699166  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00422992 0.07637212 0.23702196]
Stock Position:  0.0042299223721551866
Bond Position:  [8.75128992]


portfolio before change:  [9.18425139]
curr_Stock_Price:  102.09820552139448
curr_Factors:  [102.09820552  -0.57984676  -1.05526459]
mat_Sqrt:  [[19.90207108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177015 -0.05522929  0.40342388]
Stock Position:  -0.0017701492296168832
Bond Position:  [9.36498045]


portfolio before change:  [9.18743222]
curr_Stock_Price:  100.9626292535798
curr_Factors:  [100.96262925  -0.80936111  -1.04663524]
mat_Sqrt:  [[15.78017005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00173897  0.01812819 -0.03697371]
Stock Position:  0.0017389682560696555
Bond Position:  [9.01186142]


portfolio before change:  [9.18829064]
curr_Stock_Price:  100.80843867413122
curr_Factors:  [100.80843867  -0.82428848  -1.02050086]
mat_Sqrt:  [[15.93364209  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00032589 -0.01727381 -0.04785478]
Stock Position:  0.00032588914440930835
Bond Position:  [9.15543827]


portfolio before change:  [9.18918815]
curr_Stock_Price:  100.05052468756575
curr_Factors:  [100.05052469  -0.80978865  -0.99635206]
mat_Sqrt:  [[16.4369952   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00019192  0.01320569 -0.13947809]
Stock Position:  -0.00019192202044785673
Bond Position:  [9.20839005]


portfolio before change:  [9.19026501]
curr_Stock_Price:  100.43744471502511
curr_Factors:  [100.43744472  -0.79196547  -0.9981789 ]
mat_Sqrt:  [[16.76663216  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04976765 -0.01074644 -2.69767374]
Stock Position:  -0.04976765182800448
Bond Position:  [14.18880079]


portfolio before change:  [9.12010665]
curr_Stock_Price:  101.8828027623548
curr_Factors:  [101.88280276  -0.72390293  -1.00013027]
mat_Sqrt:  [[18.17032837  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01238364  0.01161984  0.0550408 ]
Stock Position:  -0.012383637716326322
Bond Position:  [10.38178637]


portfolio before change:  [9.12201125]
curr_Stock_Price:  101.83380266858012
curr_Factors:  [101.83380267  -0.59396707  -1.03358345]
mat_Sqrt:  [[20.00118599  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00075854 0.01871066 0.47935792]
Stock Position:  0.0007585373993586244
Bond Position:  [9.0447665]


portfolio before change:  [9.12209371]
curr_Stock_Price:  100.45192298224951
curr_Factors:  [100.45192298  -0.50070554  -1.01023053]
mat_Sqrt:  [[22.17006952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0008806   0.0276755  -0.01905561]
Stock Position:  0.0008805967922846637
Bond Position:  [9.03363607]


portfolio before change:  [9.12391686]
curr_Stock_Price:  101.23987862157959
curr_Factors:  [101.23987862  -0.15307682  -1.0247461 ]
mat_Sqrt:  [[31.17666264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0050319  -0.00480661 -0.33494584]
Stock Position:  -0.0050319038234821305
Bond Position:  [9.63334619]


portfolio before change:  [9.11370551]
curr_Stock_Price:  103.50852062205738
curr_Factors:  [103.50852062  -0.24346353  -1.04424044]
mat_Sqrt:  [[28.55836744  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154135  0.01843432  0.24386374]
Stock Position:  -0.0015413532792756524
Bond Position:  [9.27324871]


portfolio before change:  [9.11619393]
curr_Stock_Price:  102.64617053152507
curr_Factors:  [102.64617053  -0.40878272  -1.03062979]
mat_Sqrt:  [[24.33401894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00861378 -0.05527787 -0.2123952 ]
Stock Position:  0.008613783631800579
Bond Position:  [8.23202202]


portfolio before change:  [9.1239253]
curr_Stock_Price:  103.42426165926867
curr_Factors:  [103.42426166  -0.54458849  -1.05793611]
mat_Sqrt:  [[20.8283486   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00053312 0.04750996 0.22835668]
Stock Position:  0.0005331153403383466
Bond Position:  [9.06878824]


portfolio before change:  [9.12562716]
curr_Stock_Price:  104.49005463070836
curr_Factors:  [104.49005463  -0.6058052   -1.08544463]
mat_Sqrt:  [[19.2563729   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00353223  0.0201293  -0.09376859]
Stock Position:  0.003532234083045541
Bond Position:  [8.75654383]


portfolio before change:  [9.12727407]
curr_Stock_Price:  104.6464072371363
curr_Factors:  [104.64640724  -0.85047226  -1.08503788]
mat_Sqrt:  [[15.10577288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288086  0.0270261  -0.02273601]
Stock Position:  -0.0028808578381287987
Bond Position:  [9.42874549]


portfolio before change:  [9.13177642]
curr_Stock_Price:  103.49269463520106
curr_Factors:  [103.49269464  -0.48384446  -1.08302759]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.13177642]
Stock Price:  104.04066201550965
PL:  [5.0911144]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.62620606e-01 -1.23147181e-02  7.69811188e-02]
 [-1.24205914e-01  7.61906117e-03  1.38440359e-01]
 [ 2.51655448e-01  3.51879311e-01  5.11318428e-01]
 [ 7.01564704e-04  6.37962952e-02  1.41235651e-01]
 [-3.57539712e-02 -2.32766815e-02  5.17798551e-02]
 [-3.24022208e-02 -4.22161378e-02 -3.22832577e-02]
 [ 3.49599902e-02  4.56054231e-02 -1.42773053e-02]
 [ 1.83997790e-01  1.15744321e-01 -4.07466686e-02]
 [-4.84695629e-01 -2.69909546e-02 -5.52973931e-02]
 [ 4.63300925e-02 -1.54779688e-02 -4.05552638e-02]
 [-4.23590278e-03 -2.44994854e-01  1.42726803e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.57343739e-01 -7.57925641e-02  2.80467660e-01]
 [ 4.39635596e-02  2.90479683e-01  2.46497158e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-4.49599354e-02  6.49057017e-02  4.74475449e-02]
 [-4.04722327e-01 -2.31020489e-01  9.99839054e-02]
 [-1.67424128e-01 -4.58952016e-02 -2.01231186e-02]
 [ 2.69140369e-01  1.17202054e+00  3.76090231e-01]
 [-8.22050965e-03 -3.93365442e-04  4.01255597e-02]
 [-6.01987108e-02  3.00556831e-02 -2.61518877e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.55426819e-01 -2.84433136e-02  1.61708041e-01]
 [ 7.48991424e-02 -1.94144433e-01 -8.21911940e-02]
 [-1.20796071e-01  2.28644966e-01  2.02137584e-01]
 [ 1.24633618e-02  6.09668101e-02  4.01630055e-02]
 [-1.35670673e-01 -1.27585320e-01  2.73835136e-01]
 [ 1.05931506e-01  7.66817256e-02 -9.11087975e-02]
 [-7.71785284e-01 -1.29768639e-01 -1.10895519e+00]
 [-5.11685481e-02 -5.59280975e-02  1.02132187e-01]
 [-1.30578271e-01 -1.04808725e-01  1.30959783e-01]
 [ 6.10269684e-02  2.31879410e-01 -3.84493362e-02]
 [-1.03677393e-01 -2.22233532e-03  4.74558259e-05]
 [-5.20742507e-02  1.75530679e-01  1.03359796e-01]
 [ 8.36173761e-02 -1.44032028e-01 -1.24337220e-01]
 [-3.72430558e-02  2.95019224e-01  8.48387471e-02]
 [ 1.33707661e-01  1.01788472e-01 -1.69187059e-02]
 [-1.41645489e-02  6.34699963e-02 -1.10254619e-02]
 [-1.48238512e-01 -3.10428720e-01  6.43393829e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.04176275]
curr_Stock_Price:  99.95179247113951
curr_Factors:  [99.95179247 -0.96974114 -0.98032588]
mat_Sqrt:  [[14.21959549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01035366 -0.00389426  0.2196057 ]
Stock Position:  -0.01035366063193305
Bond Position:  [3.07662969]


portfolio before change:  [2.05960447]
curr_Stock_Price:  98.26571059282124
curr_Factors:  [98.26571059 -0.55343534 -0.9867673 ]
mat_Sqrt:  [[21.06204295  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045461   0.00240936  0.39493181]
Stock Position:  -0.004546100806604729
Bond Position:  [2.5063303]


portfolio before change:  [2.05961641]
curr_Stock_Price:  98.33200300197282
curr_Factors:  [98.332003   -0.70712687 -0.99178557]
mat_Sqrt:  [[17.98318398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02030304 0.11127401 1.45864915]
Stock Position:  0.020303043671114122
Bond Position:  [0.06317746]


portfolio before change:  [2.07179748]
curr_Stock_Price:  98.93157670042606
curr_Factors:  [98.9315767  -0.65625031 -0.95236136]
mat_Sqrt:  [[19.80267051  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00157445 0.02017416 0.402906  ]
Stock Position:  0.0015744535280506516
Bond Position:  [1.91603431]


portfolio before change:  [2.07226478]
curr_Stock_Price:  99.07624793008993
curr_Factors:  [99.07624793 -0.29990244 -0.95960976]
mat_Sqrt:  [[28.11708889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091707 -0.00736073  0.14771351]
Stock Position:  -0.00091707409546764
Bond Position:  [2.16312504]


portfolio before change:  [2.07087668]
curr_Stock_Price:  100.88472450173701
curr_Factors:  [100.8847245   -0.57618137  -0.9737218 ]
mat_Sqrt:  [[21.41465193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187171 -0.01334991 -0.09209515]
Stock Position:  -0.0018717105152990675
Bond Position:  [2.25970368]


portfolio before change:  [2.07207742]
curr_Stock_Price:  100.3941262116591
curr_Factors:  [100.39412621  -0.78822148  -0.97439091]
mat_Sqrt:  [[17.22723072  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00192853  0.0144217  -0.04072918]
Stock Position:  0.001928526698585091
Bond Position:  [1.87846467]


portfolio before change:  [2.06978422]
curr_Stock_Price:  99.08327156449589
curr_Factors:  [99.08327156 -0.71837331 -0.94503592]
mat_Sqrt:  [[18.77547307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00951608  0.03660157 -0.1162389 ]
Stock Position:  0.009516080671233636
Bond Position:  [1.12689982]


portfolio before change:  [2.09119086]
curr_Stock_Price:  101.3179905453526
curr_Factors:  [101.31799055  -0.72610211  -0.9717798 ]
mat_Sqrt:  [[18.54837309  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02677755 -0.00853529 -0.15774807]
Stock Position:  -0.02677755418800323
Bond Position:  [4.80423884]


portfolio before change:  [2.10619478]
curr_Stock_Price:  100.78010155897873
curr_Factors:  [100.78010156  -0.86125551  -0.97418915]
mat_Sqrt:  [[16.07871383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234174 -0.00489456 -0.11569288]
Stock Position:  0.002341738579149874
Bond Position:  [1.87019413]


portfolio before change:  [2.1102008]
curr_Stock_Price:  102.39096894949833
curr_Factors:  [102.39096895  -0.96428053  -1.00816045]
mat_Sqrt:  [[14.24431003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00130384 -0.07747418  0.40715984]
Stock Position:  0.001303843003584297
Bond Position:  [1.97669905]


portfolio before change:  [2.10962594]
curr_Stock_Price:  101.76055495932984
curr_Factors:  [101.76055496  -1.1237616   -1.00083442]
mat_Sqrt:  [[12.15847595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00593213  0.00225658  0.15019092]
Stock Position:  -0.00593212659775181
Bond Position:  [2.71328243]


portfolio before change:  [2.11488219]
curr_Stock_Price:  100.93166725967426
curr_Factors:  [100.93166726  -1.12555742  -0.97495936]
mat_Sqrt:  [[12.35334588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01721291 -0.02396771  0.80009617]
Stock Position:  0.017212907897127767
Bond Position:  [0.3775547]


portfolio before change:  [2.13630839]
curr_Stock_Price:  102.17370031633877
curr_Factors:  [102.17370032  -1.02874862  -0.99968561]
mat_Sqrt:  [[13.44006378  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00757286 0.09185774 0.70318778]
Stock Position:  0.007572860974369498
Bond Position:  [1.36256116]


portfolio before change:  [2.1381302]
curr_Stock_Price:  102.39177934667435
curr_Factors:  [102.39177935  -0.92366172  -0.98885084]
mat_Sqrt:  [[15.12416612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00283825 -0.03587186 -0.12433753]
Stock Position:  0.0028382479593181287
Bond Position:  [1.84751694]


portfolio before change:  [2.13665306]
curr_Stock_Price:  101.78996724065311
curr_Factors:  [101.78996724  -0.74957699  -0.97266582]
mat_Sqrt:  [[18.18630308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184748  0.02052499  0.13535464]
Stock Position:  -0.0018474831128256171
Bond Position:  [2.32470831]


portfolio before change:  [2.1396269]
curr_Stock_Price:  100.3375971861407
curr_Factors:  [100.33759719  -0.62627186  -0.96058366]
mat_Sqrt:  [[20.52584765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01901398 -0.07305509  0.28522625]
Stock Position:  -0.01901398312372608
Bond Position:  [4.04744428]


portfolio before change:  [2.13607402]
curr_Stock_Price:  100.55106325860147
curr_Factors:  [100.55106326  -0.72363233  -0.94076428]
mat_Sqrt:  [[19.03480386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00907373 -0.01451334 -0.05740566]
Stock Position:  -0.009073734256957304
Bond Position:  [3.04844765]


portfolio before change:  [2.13666247]
curr_Stock_Price:  100.52820935542205
curr_Factors:  [100.52820936  -0.81883112  -0.96714416]
mat_Sqrt:  [[16.85189484  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02232217 0.37062544 1.07288075]
Stock Position:  0.02232217266456697
Bond Position:  [-0.10734558]


portfolio before change:  [2.14742612]
curr_Stock_Price:  101.0110061664276
curr_Factors:  [101.01100617  -0.86823886  -0.97235348]
mat_Sqrt:  [[16.03280837  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.49929556e-06 -1.24393075e-04  1.14467053e-01]
Stock Position:  -2.499295561544891e-06
Bond Position:  [2.14767858]


portfolio before change:  [2.14769454]
curr_Stock_Price:  101.0344828396337
curr_Factors:  [101.03448284  -0.77616489  -0.98496634]
mat_Sqrt:  [[17.36281149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372986  0.00950444 -0.07460406]
Stock Position:  -0.003729862995304611
Bond Position:  [2.52453932]


portfolio before change:  [2.14101494]
curr_Stock_Price:  102.9099377788794
curr_Factors:  [102.90993778  -0.97747993  -1.01556173]
mat_Sqrt:  [[14.02459469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277148  0.01916992 -0.08961985]
Stock Position:  -0.0027714785733566716
Bond Position:  [2.42622763]


portfolio before change:  [2.14057725]
curr_Stock_Price:  103.17729931750142
curr_Factors:  [103.17729932  -0.7736407   -1.00222706]
mat_Sqrt:  [[17.4716768   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01074315 -0.00899457  0.46130803]
Stock Position:  0.010743154976086038
Bond Position:  [1.03212753]


portfolio before change:  [2.15810192]
curr_Stock_Price:  104.79652984250576
curr_Factors:  [104.79652984  -0.8188243   -1.02608784]
mat_Sqrt:  [[16.56196022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00320669 -0.06139386 -0.2344686 ]
Stock Position:  0.003206694544712739
Bond Position:  [1.82205146]


portfolio before change:  [2.16295824]
curr_Stock_Price:  106.239933916607
curr_Factors:  [106.23993392  -0.84764173  -1.04855979]
mat_Sqrt:  [[15.95063346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0046162   0.07230389  0.57664226]
Stock Position:  -0.004616200454491156
Bond Position:  [2.65338308]


portfolio before change:  [2.16282044]
curr_Stock_Price:  106.3416402587943
curr_Factors:  [106.34164026  -0.96420116  -1.04683176]
mat_Sqrt:  [[14.23386551  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00156217 0.0192794  0.11457388]
Stock Position:  0.0015621727768641467
Bond Position:  [1.99669643]


portfolio before change:  [2.16358709]
curr_Stock_Price:  106.6726193757199
curr_Factors:  [106.67261938  -0.90631615  -1.06364488]
mat_Sqrt:  [[14.87680798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00558376 -0.04034602  0.78117542]
Stock Position:  -0.005583761594275134
Bond Position:  [2.75922157]


portfolio before change:  [2.16411052]
curr_Stock_Price:  106.64065121360726
curr_Factors:  [106.64065121  -0.99561907  -1.05362868]
mat_Sqrt:  [[13.73870511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0065009   0.02424889 -0.25990804]
Stock Position:  0.006500897557984575
Bond Position:  [1.47085057]


portfolio before change:  [2.16611811]
curr_Stock_Price:  106.92118512797761
curr_Factors:  [106.92118513  -1.01821385  -1.01685877]
mat_Sqrt:  [[13.97149735  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07168168 -0.04103645 -3.16354047]
Stock Position:  -0.07168168165720883
Bond Position:  [9.83040846]


portfolio before change:  [2.20419927]
curr_Stock_Price:  106.40707487039055
curr_Factors:  [106.40707487  -1.2327818   -1.0384011 ]
mat_Sqrt:  [[10.98015077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00289294 -0.01768602  0.2913547 ]
Stock Position:  -0.0028929438773492187
Bond Position:  [2.51202897]


portfolio before change:  [2.20399095]
curr_Stock_Price:  106.58763287964726
curr_Factors:  [106.58763288  -1.17136976  -1.03279661]
mat_Sqrt:  [[11.7611429   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00905969 -0.03314343  0.37359181]
Stock Position:  -0.009059694941266986
Bond Position:  [3.16964239]


portfolio before change:  [2.19287158]
curr_Stock_Price:  107.85871330520361
curr_Factors:  [107.85871331  -1.16686843  -1.02696148]
mat_Sqrt:  [[12.02505329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0049202   0.07332671 -0.10968525]
Stock Position:  0.004920197001132549
Bond Position:  [1.66218546]


portfolio before change:  [2.19287502]
curr_Stock_Price:  107.81718130708249
curr_Factors:  [107.81718131  -1.06572076  -1.02279989]
mat_Sqrt:  [[13.35534097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00776656 -0.00070276  0.00013538]
Stock Position:  -0.007766562228572543
Bond Position:  [3.03024387]


portfolio before change:  [2.19826088]
curr_Stock_Price:  107.17248809152484
curr_Factors:  [107.17248809  -0.93475236  -1.00188423]
mat_Sqrt:  [[15.45299743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00171124  0.05550767  0.29485673]
Stock Position:  -0.0017112432763407438
Bond Position:  [2.38165908]


portfolio before change:  [2.19778313]
curr_Stock_Price:  107.62564954393002
curr_Factors:  [107.62564954  -0.88054069  -0.97352015]
mat_Sqrt:  [[16.8541709   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0032347  -0.04554693 -0.35469948]
Stock Position:  0.003234704145496198
Bond Position:  [1.849646]


portfolio before change:  [2.19571409]
curr_Stock_Price:  106.9145296953674
curr_Factors:  [106.9145297   -0.8409127   -0.95542949]
mat_Sqrt:  [[17.73761534  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006939   0.09329327  0.24202133]
Stock Position:  -0.0006938957239182888
Bond Position:  [2.26990163]


portfolio before change:  [2.19643547]
curr_Stock_Price:  106.28385596666192
curr_Factors:  [106.28385597  -0.51492841  -0.94105723]
mat_Sqrt:  [[24.78225233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00536199  0.03218834 -0.04826436]
Stock Position:  0.0053619949408994245
Bond Position:  [1.62654197]


portfolio before change:  [2.19419586]
curr_Stock_Price:  105.82825326928008
curr_Factors:  [105.82825327  -0.51243217  -0.93881727]
mat_Sqrt:  [[24.79316687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00059598  0.02007098 -0.03145257]
Stock Position:  -0.0005959837135075868
Bond Position:  [2.25726777]


portfolio before change:  [2.19299699]
curr_Stock_Price:  108.31329030821938
curr_Factors:  [108.31329031  -0.62102091  -0.93256082]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.19299699]
Stock Price:  108.67262206437154
PL:  [-6.47962507]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.67002238e-01  5.24770690e-03  9.78880846e-02]
 [-7.31398052e-02  5.27776926e-02  5.53100743e-02]
 [ 1.73566518e-01  2.34266772e-01  3.66216963e-01]
 [-6.69123767e-02  1.35774465e-02  9.45962502e-02]
 [-4.39406367e-01 -1.37615944e-01  4.19156275e-02]
 [ 3.91855414e-02 -1.59231803e-01 -2.12862152e-01]
 [ 2.50486089e-02 -2.11618063e-01 -3.24866471e-02]
 [ 3.21397088e-01  1.96811440e-01 -1.00609205e-01]
 [-1.43840281e-01  2.32900087e-02 -1.15363892e-01]
 [ 1.05513481e-01 -7.28798958e-03  8.59348044e-02]
 [ 7.00190941e-02 -2.11858057e-01  5.16720827e-04]
 [-2.79449217e-02 -4.62505349e-02 -9.85760383e-02]
 [ 2.44839777e-01 -2.42732386e-01  4.89678097e-02]
 [ 8.50031984e-02 -6.45334043e-02 -5.42560506e-02]
 [-5.23675060e-02  5.75552762e-02  5.46210533e-02]
 [-2.84097149e-02 -5.71544444e-02  5.78334197e-03]
 [-3.35294332e-01 -3.18870410e-01  8.30749021e-02]
 [-1.71246363e-01 -3.13564534e-03 -4.76002703e-02]
 [ 4.13579184e-01  1.50866811e+00  7.43984005e-01]
 [-9.64644312e-02  3.79935816e-04  1.15795961e-01]
 [-8.73796415e-02  1.12945870e-02 -4.34693461e-02]
 [ 1.14279810e-01 -1.58191864e-02  6.24285562e-02]
 [-7.05708725e-02 -1.08959742e-02 -9.00963184e-02]
 [-1.62811336e-02 -1.28086135e-01  1.17106693e-01]
 [-9.80793451e-02  6.58384983e-02 -6.52021194e-02]
 [ 1.02861017e-01 -7.34623336e-02 -6.97818465e-02]
 [ 5.07989345e-03 -4.53872612e-02 -2.55386435e-02]
 [-3.11861386e-02  4.14665201e-02  3.80552820e-02]
 [-4.40553613e-01  8.07818165e-02 -5.51570286e-01]
 [ 8.58712219e-02 -1.22068005e-01 -9.43282598e-02]
 [ 1.52384176e-02  4.57038785e-02  9.71051964e-02]
 [ 2.37393230e-02  1.10276384e-01 -1.71938223e-02]
 [-1.31716342e-01  5.40309775e-03 -1.48618112e-01]
 [-5.79460700e-02  1.38416388e-01  1.12310720e-01]
 [-1.13782158e-01  8.06587722e-02  1.30557298e-01]
 [-7.71714012e-02 -4.66840607e-02 -5.73657321e-03]
 [ 1.22786261e-01  1.01231173e-01  2.68993182e-02]
 [-1.25991688e-01  1.65214740e-01 -8.01697847e-04]
 [ 2.05902981e-03 -2.40226794e-01  8.10959860e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.51031964]
curr_Stock_Price:  99.877746519958
curr_Factors:  [99.87774652 -1.03665668 -1.03180319]
mat_Sqrt:  [[12.62257702  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01163672  0.00165947  0.27924746]
Stock Position:  -0.011636722119009997
Bond Position:  [2.67256922]


portfolio before change:  [1.52109047]
curr_Stock_Price:  98.98086693926412
curr_Factors:  [98.98086694 -1.0356581  -1.01347123]
mat_Sqrt:  [[12.75339155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00474281  0.01668977  0.15778425]
Stock Position:  -0.004742814422468317
Bond Position:  [1.99053835]


portfolio before change:  [1.52155534]
curr_Stock_Price:  98.93531600812663
curr_Factors:  [98.93531601 -1.17863615 -1.03135086]
mat_Sqrt:  [[10.85340934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02343678 0.07408166 1.04471506]
Stock Position:  0.023436781611464754
Bond Position:  [-0.79717006]


portfolio before change:  [1.52543271]
curr_Stock_Price:  99.10500760056853
curr_Factors:  [99.1050076  -1.14972703 -1.06057359]
mat_Sqrt:  [[10.86861582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0043476   0.00429357  0.26985677]
Stock Position:  -0.004347603284488297
Bond Position:  [1.95630197]


portfolio before change:  [1.53201547]
curr_Stock_Price:  97.64714615129112
curr_Factors:  [97.64714615 -1.27712295 -1.07038285]
mat_Sqrt:  [[ 9.33578285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04653103 -0.04351798  0.11957362]
Stock Position:  -0.046531031320336466
Bond Position:  [6.07563788]


portfolio before change:  [1.50154723]
curr_Stock_Price:  98.31826260197043
curr_Factors:  [98.3182626  -1.16884212 -1.06618708]
mat_Sqrt:  [[10.5189732   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079629 -0.05035352 -0.60723647]
Stock Position:  -0.0007962859808691025
Bond Position:  [1.57983668]


portfolio before change:  [1.50204395]
curr_Stock_Price:  97.94247694111614
curr_Factors:  [97.94247694 -1.28559343 -1.04173161]
mat_Sqrt:  [[ 9.55491136  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135567 -0.06691951 -0.09267536]
Stock Position:  0.0013556740013916013
Bond Position:  [1.36926588]


portfolio before change:  [1.50238194]
curr_Stock_Price:  98.06552623928063
curr_Factors:  [98.06552624 -1.5148869  -1.03051012]
mat_Sqrt:  [[ 7.69244644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03977174  0.06223724 -0.28701006]
Stock Position:  0.039771738735602635
Bond Position:  [-2.39785455]


portfolio before change:  [1.49716272]
curr_Stock_Price:  97.94183360279864
curr_Factors:  [97.9418336  -1.19616065 -1.05858022]
mat_Sqrt:  [[10.27416916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01623367  0.00736495 -0.32910107]
Stock Position:  -0.016233671942354824
Bond Position:  [3.08711831]


portfolio before change:  [1.50503887]
curr_Stock_Price:  97.4804322001499
curr_Factors:  [97.4804322  -1.20244537 -1.0499572 ]
mat_Sqrt:  [[10.24970676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01198734 -0.00230466  0.24514808]
Stock Position:  0.011987335592832524
Bond Position:  [0.33650821]


portfolio before change:  [1.51693849]
curr_Stock_Price:  98.46960551322908
curr_Factors:  [98.46960551 -1.21432397 -1.08065454]
mat_Sqrt:  [[ 9.92214793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00651617 -0.0669954   0.00147406]
Stock Position:  0.006516171524782191
Bond Position:  [0.87529365]


portfolio before change:  [1.51639519]
curr_Stock_Price:  98.36943730108774
curr_Factors:  [98.3694373  -1.1665242  -1.09126858]
mat_Sqrt:  [[10.28758041  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00478838 -0.0146257  -0.28121   ]
Stock Position:  -0.004788381037910572
Bond Position:  [1.98742554]


portfolio before change:  [1.5163481]
curr_Stock_Price:  98.4311574477556
curr_Factors:  [98.43115745 -1.26724637 -1.10779217]
mat_Sqrt:  [[ 9.155171    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02715055 -0.07675872  0.13969153]
Stock Position:  0.0271505541023878
Bond Position:  [-1.15611237]


portfolio before change:  [1.49644474]
curr_Stock_Price:  97.70340680139728
curr_Factors:  [97.7034068  -1.32875364 -1.09978863]
mat_Sqrt:  [[ 8.61404635  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00838885 -0.02040725 -0.15477741]
Stock Position:  0.008388854695302657
Bond Position:  [0.67682506]


portfolio before change:  [1.49704879]
curr_Stock_Price:  97.76532705908825
curr_Factors:  [97.76532706 -1.42240312 -1.08731958]
mat_Sqrt:  [[ 7.94741944  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00499935  0.01820058  0.15581866]
Stock Position:  -0.00499935351592577
Bond Position:  [1.98581222]


portfolio before change:  [1.49864979]
curr_Stock_Price:  97.49473954997778
curr_Factors:  [97.49473955 -1.63878842 -1.08524198]
mat_Sqrt:  [[ 6.39660914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448752 -0.01807382  0.01649826]
Stock Position:  -0.00448752080042724
Bond Position:  [1.93615947]


portfolio before change:  [1.49552783]
curr_Stock_Price:  98.24437348689
curr_Factors:  [98.24437349 -1.78614617 -1.07410548]
mat_Sqrt:  [[ 5.62491779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05805773 -0.10083568  0.23698957]
Stock Position:  -0.058057726177689624
Bond Position:  [7.19937277]


portfolio before change:  [1.51491417]
curr_Stock_Price:  97.92596005328528
curr_Factors:  [97.92596005 -1.76395194 -1.04633043]
mat_Sqrt:  [[ 5.89396721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03071678 -0.00099158 -0.13579032]
Stock Position:  -0.03071677921149629
Bond Position:  [4.52288426]


portfolio before change:  [1.5141215]
curr_Stock_Price:  97.9701724089841
curr_Factors:  [97.97017241 -1.73361694 -1.06331884]
mat_Sqrt:  [[ 5.97585566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10113998 0.47708275 2.12237928]
Stock Position:  0.10113998068291957
Bond Position:  [-8.39457984]


portfolio before change:  [1.53949095]
curr_Stock_Price:  98.23138301788345
curr_Factors:  [98.23138302 -1.73478818 -1.04610637]
mat_Sqrt:  [[ 6.08867931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.19595508e-02  1.20146254e-04  3.30333646e-01]
Stock Position:  -0.011959550842356543
Bond Position:  [2.71429417]


portfolio before change:  [1.54212196]
curr_Stock_Price:  98.03976209684073
curr_Factors:  [98.0397621  -1.96599258 -1.03061193]
mat_Sqrt:  [[ 4.89771429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01959305  0.00357166 -0.12400594]
Stock Position:  -0.019593049710149964
Bond Position:  [3.46301989]


portfolio before change:  [1.5407339]
curr_Stock_Price:  98.13270114989085
curr_Factors:  [98.13270115 -1.83283614 -1.02904757]
mat_Sqrt:  [[ 5.60936178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.022572   -0.00500247  0.17809129]
Stock Position:  0.02257200392518887
Bond Position:  [-0.67431781]


portfolio before change:  [1.53739795]
curr_Stock_Price:  97.98864411595922
curr_Factors:  [97.98864412 -1.75163478 -1.04480318]
mat_Sqrt:  [[ 5.97995857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01492369 -0.00344561 -0.25701972]
Stock Position:  -0.014923688557687756
Bond Position:  [2.99974996]


portfolio before change:  [1.54375928]
curr_Stock_Price:  97.58751468354018
curr_Factors:  [97.58751468 -1.97293958 -1.01590995]
mat_Sqrt:  [[ 4.91307507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00087847 -0.04050439  0.3340728 ]
Stock Position:  0.0008784722657272432
Bond Position:  [1.45803135]


portfolio before change:  [1.54404994]
curr_Stock_Price:  97.71090734024898
curr_Factors:  [97.71090734 -1.83852181 -1.0222866 ]
mat_Sqrt:  [[ 5.59126063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01961789  0.02081996 -0.1860035 ]
Stock Position:  -0.01961788881202552
Bond Position:  [3.46093165]


portfolio before change:  [1.54452092]
curr_Stock_Price:  97.70895331251538
curr_Factors:  [97.70895331 -1.78516109 -0.99603942]
mat_Sqrt:  [[ 6.05444485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01432337 -0.02323083 -0.19906818]
Stock Position:  0.014323372325812454
Bond Position:  [0.1449992]


portfolio before change:  [1.54511848]
curr_Stock_Price:  97.7494073076152
curr_Factors:  [97.74940731 -1.47746979 -0.98498042]
mat_Sqrt:  [[ 8.33077867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00015665 -0.01435271 -0.07285464]
Stock Position:  -0.0001566545491153844
Bond Position:  [1.56043137]


portfolio before change:  [1.54532415]
curr_Stock_Price:  97.68173185033946
curr_Factors:  [97.68173185 -1.38576255 -0.97968331]
mat_Sqrt:  [[ 9.17303952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243621  0.01311287  0.10856113]
Stock Position:  -0.0024362127386960432
Bond Position:  [1.78329763]


portfolio before change:  [1.54729624]
curr_Stock_Price:  96.96374469035831
curr_Factors:  [96.96374469 -1.57825522 -0.98371096]
mat_Sqrt:  [[ 7.48103357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0736605   0.02554545 -1.5734765 ]
Stock Position:  -0.07366049675137083
Bond Position:  [8.68969384]


portfolio before change:  [1.53650157]
curr_Stock_Price:  97.12503809049561
curr_Factors:  [97.12503809 -1.45891418 -1.02462943]
mat_Sqrt:  [[ 8.10479282  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00783052 -0.03860129 -0.26909227]
Stock Position:  0.007830522698283422
Bond Position:  [0.77596176]


portfolio before change:  [1.53733925]
curr_Stock_Price:  97.21962684529082
curr_Factors:  [97.21962685 -1.48016823 -1.03599741]
mat_Sqrt:  [[ 7.85230384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00461521 0.01445284 0.2770141 ]
Stock Position:  0.004615206262091783
Bond Position:  [1.08865062]


portfolio before change:  [1.53835652]
curr_Stock_Price:  97.41055586706054
curr_Factors:  [97.41055587 -1.68168391 -0.99644592]
mat_Sqrt:  [[ 6.69127705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00344881  0.03487245 -0.04904919]
Stock Position:  0.0034488144096781127
Bond Position:  [1.20240559]


portfolio before change:  [1.53804191]
curr_Stock_Price:  97.27575136097184
curr_Factors:  [97.27575136 -1.62683126 -0.99657704]
mat_Sqrt:  [[ 7.05785682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02294087  0.00170861 -0.42396611]
Stock Position:  -0.022940870541899624
Bond Position:  [3.76963233]


portfolio before change:  [1.54531592]
curr_Stock_Price:  96.97921607425373
curr_Factors:  [96.97921607 -1.49987798 -0.99372469]
mat_Sqrt:  [[ 8.0116282   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00392515  0.04377111  0.32039122]
Stock Position:  -0.003925150262752394
Bond Position:  [1.92597392]


portfolio before change:  [1.54752718]
curr_Stock_Price:  96.47719945491215
curr_Factors:  [96.47719945 -1.39772057 -0.98183412]
mat_Sqrt:  [[ 8.93299758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00952084  0.02550654  0.37244363]
Stock Position:  -0.009520842202147758
Bond Position:  [2.46607137]


portfolio before change:  [1.54981326]
curr_Stock_Price:  96.26946528124782
curr_Factors:  [96.26946528 -1.55228375 -0.97582697]
mat_Sqrt:  [[ 7.68323333  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01035342 -0.0147628  -0.01636485]
Stock Position:  -0.010353421292336377
Bond Position:  [2.54653159]


portfolio before change:  [1.55580674]
curr_Stock_Price:  95.7213237087062
curr_Factors:  [95.72132371 -1.4570221  -0.95212234]
mat_Sqrt:  [[ 8.60459747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01521173 0.03201211 0.07673627]
Stock Position:  0.01521173295014387
Bond Position:  [0.09971952]


portfolio before change:  [1.56596531]
curr_Stock_Price:  96.38831625138953
curr_Factors:  [96.38831625 -1.41918523 -0.95179765]
mat_Sqrt:  [[ 9.00159802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01354087  0.05224549 -0.00228702]
Stock Position:  -0.013540874307409056
Bond Position:  [2.87114739]


portfolio before change:  [1.56485333]
curr_Stock_Price:  96.49694261756692
curr_Factors:  [96.49694262 -1.15307376 -0.95834115]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.56485333]
Stock Price:  96.06698020346973
PL:  [1.56485333]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.56084379e-02  6.37711466e-03  2.50127789e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.22252599e-01 -6.18671275e-02 -1.31937642e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-8.71244965e-01 -2.59939277e-01  3.13626015e-02]
 [-2.71184086e-02 -5.23513001e-02 -4.76533575e-02]
 [ 3.36821303e-02  2.56136089e-02 -1.92855209e-02]
 [ 2.94838853e-01  1.61762250e-01 -8.70990050e-02]
 [-3.25493319e-01 -2.81534106e-03 -8.62621010e-02]
 [ 4.88693177e-02 -1.97918395e-02 -4.25767179e-02]
 [ 4.33639849e-02 -2.66283209e-01  3.53440597e-02]
 [ 2.77351523e-02 -5.63142525e-03 -5.51038254e-03]
 [ 2.05872288e-01 -1.43912936e-01  2.27293062e-01]
 [ 7.09992193e-02  1.50690814e-01  1.10502169e-01]
 [ 3.76469512e-02 -1.03327721e-01 -5.54460139e-02]
 [-5.33380493e-02  4.68660108e-02  4.26111706e-02]
 [-5.08505845e-01 -2.48065509e-01  1.41130428e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 1.07810897e-01  7.41185128e-01  1.95242068e-01]
 [ 2.93335194e-03  1.81375164e-02  2.95546133e-02]
 [ 6.82219401e-02 -1.34014241e-01  1.15933418e-01]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 2.16925680e-01 -7.05992647e-03  2.06765259e-01]
 [ 7.06099424e-02 -1.76494667e-01 -6.77618436e-02]
 [-1.22048087e-01  2.28947119e-01  1.90469396e-01]
 [ 1.38767946e-02  6.23140675e-02  7.71338275e-03]
 [-1.44899378e-01 -5.53116870e-03  1.35449874e-01]
 [ 5.88291770e-02  6.06060860e-02 -8.72819274e-02]
 [-7.53438431e-01 -1.52937351e-01 -1.15784193e+00]
 [-1.13510341e-01  4.38897717e-02  8.66632390e-03]
 [ 1.55302915e-02  8.21638347e-03  1.11217874e-01]
 [ 2.87463485e-02  1.22553702e-01 -1.56558954e-02]
 [-1.30383868e-01 -5.74647413e-03 -5.91258220e-02]
 [-6.01616543e-02  1.25612155e-01  1.28178021e-01]
 [ 1.69477988e-01 -1.63581414e-01 -9.71280047e-02]
 [-1.93935388e-02  2.22323564e-01  8.24636397e-02]
 [ 1.01562439e-01  8.18403576e-02 -2.52834512e-02]
 [ 2.22057295e-02  4.11947612e-02 -1.28257475e-02]
 [-1.36771562e-01 -2.81606352e-01  5.81357105e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.21158356]
curr_Stock_Price:  100.3934434963573
curr_Factors:  [100.3934435   -0.9540686   -0.98796894]
mat_Sqrt:  [[14.39756879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00627454  0.00201662  0.0713545 ]
Stock Position:  -0.006274536395144662
Bond Position:  [5.84150588]


portfolio before change:  [5.21068529]
curr_Stock_Price:  100.65298634695314
curr_Factors:  [100.65298635  -1.03113852  -0.9634362 ]
mat_Sqrt:  [[13.69600391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331345  0.01411938  0.0859571 ]
Stock Position:  -0.0033134513647590106
Bond Position:  [5.54419406]


portfolio before change:  [5.2118766]
curr_Stock_Price:  100.50261617431651
curr_Factors:  [100.50261617  -1.34296522  -0.95776678]
mat_Sqrt:  [[10.06890296  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01923979 -0.0195641  -0.37638137]
Stock Position:  0.01923978604030143
Bond Position:  [3.27822777]


portfolio before change:  [5.21964737]
curr_Stock_Price:  100.88520703114602
curr_Factors:  [100.88520703  -1.40362278  -0.98903268]
mat_Sqrt:  [[ 9.21956489  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213709 -0.00659539  0.21422481]
Stock Position:  0.0021370915145732692
Bond Position:  [5.00404645]


portfolio before change:  [5.21905039]
curr_Stock_Price:  100.31315666315142
curr_Factors:  [100.31315666  -1.13325654  -0.95105343]
mat_Sqrt:  [[12.47824696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06984593 -0.08220002  0.08946877]
Stock Position:  -0.0698459251775273
Bond Position:  [12.22551562]


portfolio before change:  [5.22558169]
curr_Stock_Price:  100.241527284435
curr_Factors:  [100.24152728  -1.11581411  -0.90034417]
mat_Sqrt:  [[13.34877031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286149 -0.01655493 -0.13594176]
Stock Position:  -0.0028614856131782586
Bond Position:  [5.51242138]


portfolio before change:  [5.22669948]
curr_Stock_Price:  100.09171180889189
curr_Factors:  [100.09171181  -1.13492033  -0.91252179]
mat_Sqrt:  [[12.9182982   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235378  0.00809973 -0.05501622]
Stock Position:  0.0023537798777003107
Bond Position:  [4.99110563]


portfolio before change:  [5.22475854]
curr_Stock_Price:  99.00202887375747
curr_Factors:  [99.00202887 -1.24975749 -0.87381927]
mat_Sqrt:  [[11.8409467   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02375119  0.05115372 -0.24846922]
Stock Position:  0.023751185937587356
Bond Position:  [2.87334294]


portfolio before change:  [5.23743861]
curr_Stock_Price:  99.52077691037238
curr_Factors:  [99.52077691 -1.23134019 -0.85006648]
mat_Sqrt:  [[12.41567476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0276404  -0.00089029 -0.24608176]
Stock Position:  -0.02764039775926249
Bond Position:  [7.98823247]


portfolio before change:  [5.23702191]
curr_Stock_Price:  99.5719805137982
curr_Factors:  [99.57198051 -1.34893862 -0.83064452]
mat_Sqrt:  [[11.26046221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00352271 -0.00625873 -0.12145953]
Stock Position:  0.0035227113905171754
Bond Position:  [4.88625856]


portfolio before change:  [5.23684876]
curr_Stock_Price:  99.34943123461773
curr_Factors:  [99.34943123 -1.16100797 -0.82831352]
mat_Sqrt:  [[13.58983052  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00321587 -0.08420614  0.10082676]
Stock Position:  0.0032158721839448735
Bond Position:  [4.91735368]


portfolio before change:  [5.23601887]
curr_Stock_Price:  98.90022473098513
curr_Factors:  [98.90022473 -1.224174   -0.84876971]
mat_Sqrt:  [[12.44311917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00212687 -0.00178081 -0.01571959]
Stock Position:  0.002126874057242661
Bond Position:  [5.02567055]


portfolio before change:  [5.23921063]
curr_Stock_Price:  100.10551841860537
curr_Factors:  [100.10551842  -1.20911806  -0.85606866]
mat_Sqrt:  [[12.69284048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0195821  -0.04550927  0.64840384]
Stock Position:  0.019582100217892286
Bond Position:  [3.27893434]


portfolio before change:  [5.23040342]
curr_Stock_Price:  99.6348284814239
curr_Factors:  [99.63482848 -1.26026303 -0.83628885]
mat_Sqrt:  [[12.24306804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0079593  0.04765262 0.31523193]
Stock Position:  0.00795929580103623
Bond Position:  [4.43738035]


portfolio before change:  [5.2349237]
curr_Stock_Price:  100.13305979760266
curr_Factors:  [100.1330598   -1.14314386  -0.85258389]
mat_Sqrt:  [[13.60955538  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00173857 -0.03267509 -0.15817204]
Stock Position:  0.001738570444670395
Bond Position:  [5.06083532]


portfolio before change:  [5.23679894]
curr_Stock_Price:  100.84778397934726
curr_Factors:  [100.84778398  -1.13086202  -0.84753054]
mat_Sqrt:  [[13.94637647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311407  0.01482033  0.12155781]
Stock Position:  -0.0031140709133772805
Bond Position:  [5.5508461]


portfolio before change:  [5.23245673]
curr_Stock_Price:  102.46499671927722
curr_Factors:  [102.46499672  -1.08909326  -0.88650853]
mat_Sqrt:  [[14.20962365  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0342094  -0.0784452   0.40260583]
Stock Position:  -0.034209402939623317
Bond Position:  [8.73772309]


portfolio before change:  [5.20440005]
curr_Stock_Price:  103.3170711918082
curr_Factors:  [103.31707119  -1.01946492  -0.84713584]
mat_Sqrt:  [[15.97782554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00821833  0.00580111 -0.05715682]
Stock Position:  -0.008218332556162382
Bond Position:  [6.0534941]


portfolio before change:  [5.19340907]
curr_Stock_Price:  104.74652324701668
curr_Factors:  [104.74652325  -1.11954372  -0.82781097]
mat_Sqrt:  [[14.9421887   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01116315 0.23438332 0.55697128]
Stock Position:  0.011163146039513537
Bond Position:  [4.02410834]


portfolio before change:  [5.1777841]
curr_Stock_Price:  103.30176714504275
curr_Factors:  [103.30176715  -0.90407428  -0.82876081]
mat_Sqrt:  [[18.26194499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00051662 0.00573559 0.08431109]
Stock Position:  0.0005166191653343682
Bond Position:  [5.12441642]


portfolio before change:  [5.1793253]
curr_Stock_Price:  105.0450557359647
curr_Factors:  [105.04505574  -1.14902734  -0.82510629]
mat_Sqrt:  [[14.58882365  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00606125 -0.04237902  0.33072577]
Stock Position:  0.0060612506726688675
Bond Position:  [4.54262089]


portfolio before change:  [5.18368517]
curr_Stock_Price:  105.67066898254609
curr_Factors:  [105.67066898  -1.14052038  -0.81980893]
mat_Sqrt:  [[14.87970277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261221  0.01916992 -0.08961985]
Stock Position:  -0.0026122069961668454
Bond Position:  [5.45971883]


portfolio before change:  [5.18491989]
curr_Stock_Price:  105.45926911521204
curr_Factors:  [105.45926912  -1.2046998   -0.81410019]
mat_Sqrt:  [[14.00654641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01848772 -0.00223254  0.58984373]
Stock Position:  0.018487724777069055
Bond Position:  [3.23521795]


portfolio before change:  [5.18152198]
curr_Stock_Price:  105.25360077230388
curr_Factors:  [105.25360077  -1.32177309  -0.83990666]
mat_Sqrt:  [[12.11801199  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00430937 -0.05581251 -0.19330568]
Stock Position:  0.004309373630438733
Bond Position:  [4.72794489]


portfolio before change:  [5.18129673]
curr_Stock_Price:  105.0641813450136
curr_Factors:  [105.06418135  -1.37483404  -0.83032335]
mat_Sqrt:  [[11.58155829  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00667072  0.07239944  0.54335617]
Stock Position:  -0.006670716776408874
Bond Position:  [5.88215013]


portfolio before change:  [5.18528569]
curr_Stock_Price:  104.57643199578371
curr_Factors:  [104.576432    -1.52875478  -0.83218103]
mat_Sqrt:  [[ 9.86489397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00172939 0.01970544 0.02200413]
Stock Position:  0.0017293875253531611
Bond Position:  [5.00443251]


portfolio before change:  [5.18432451]
curr_Stock_Price:  103.65890005012318
curr_Factors:  [103.65890005  -1.48646867  -0.80417493]
mat_Sqrt:  [[10.49041626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01119056 -0.00174911  0.38640079]
Stock Position:  -0.011190557172768347
Bond Position:  [6.34432536]


portfolio before change:  [5.18262052]
curr_Stock_Price:  103.88204190221461
curr_Factors:  [103.8820419   -1.43916886  -0.83339415]
mat_Sqrt:  [[10.70480852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00397743  0.01916533 -0.24899104]
Stock Position:  0.00397743411332986
Bond Position:  [4.76943654]


portfolio before change:  [5.18445555]
curr_Stock_Price:  104.19350138545852
curr_Factors:  [104.19350139  -1.30785293  -0.81009078]
mat_Sqrt:  [[12.53225905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07929382 -0.04836304 -3.30300074]
Stock Position:  -0.07929382456945562
Bond Position:  [13.44635677]


portfolio before change:  [5.20858366]
curr_Stock_Price:  103.91041230075753
curr_Factors:  [103.9104123   -0.7741135   -0.79917676]
mat_Sqrt:  [[21.54704851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00513333  0.01387916  0.02472261]
Stock Position:  -0.005133329792145384
Bond Position:  [5.74199008]


portfolio before change:  [5.21452853]
curr_Stock_Price:  102.89214950455626
curr_Factors:  [102.8921495   -0.64599256  -0.8148054 ]
mat_Sqrt:  [[23.87622953  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00161017 0.00259825 0.31727364]
Stock Position:  0.001610165917014811
Bond Position:  [5.0488551]


portfolio before change:  [5.219295]
curr_Stock_Price:  105.46040827931874
curr_Factors:  [105.46040828  -0.88844705  -0.84936181]
mat_Sqrt:  [[18.55105662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00154789  0.03875488 -0.04466191]
Stock Position:  0.001547886233915041
Bond Position:  [5.05605429]


portfolio before change:  [5.22004477]
curr_Stock_Price:  105.53646103466659
curr_Factors:  [105.53646103  -1.01844418  -0.83786102]
mat_Sqrt:  [[16.48995318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00864777 -0.00181719 -0.16866951]
Stock Position:  -0.008647765545176087
Bond Position:  [6.13269934]


portfolio before change:  [5.22305749]
curr_Stock_Price:  105.27673121681029
curr_Factors:  [105.27673122  -1.09786651  -0.83709632]
mat_Sqrt:  [[15.20508013  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202262  0.03972205  0.36565622]
Stock Position:  -0.0020226222546677213
Bond Position:  [5.43599255]


portfolio before change:  [5.22486117]
curr_Stock_Price:  104.72094800101158
curr_Factors:  [104.720948    -0.89908003  -0.80631928]
mat_Sqrt:  [[19.02777714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00764294 -0.05172899 -0.27707916]
Stock Position:  0.0076429402285786395
Bond Position:  [4.42448522]


portfolio before change:  [5.22606901]
curr_Stock_Price:  104.80661525584026
curr_Factors:  [104.80661526  -0.88069185  -0.78610793]
mat_Sqrt:  [[19.79277785  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.60647024e-04 7.03048840e-02 2.35245810e-01]
Stock Position:  0.0001606470235840715
Bond Position:  [5.20923214]


portfolio before change:  [5.22672625]
curr_Stock_Price:  104.84424835108017
curr_Factors:  [104.84424835  -0.49012222  -0.78924593]
mat_Sqrt:  [[29.16903637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00337737  0.02588019 -0.07212665]
Stock Position:  0.0033773685046595767
Bond Position:  [4.87262859]


portfolio before change:  [5.23818148]
curr_Stock_Price:  108.05565686334974
curr_Factors:  [108.05565686  -0.43730762  -0.81156979]
mat_Sqrt:  [[30.99323719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00066632  0.01302693 -0.03658829]
Stock Position:  0.0006663172604737613
Bond Position:  [5.16618213]


portfolio before change:  [5.23826147]
curr_Stock_Price:  107.20647231433193
curr_Factors:  [107.20647231  -0.18809909  -0.81431894]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.23826147]
Stock Price:  105.63903655797031
PL:  [-0.40077509]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-4.20048163e-02  1.19888711e-01  5.88691234e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.43750144e-01  2.25704566e-01  3.11748759e-01]
 [-1.57055972e-02  4.79966519e-02  1.28694672e-01]
 [-4.84194005e-01 -1.50302566e-01  4.08211326e-02]
 [ 3.48832005e-02 -1.70181705e-01 -2.25215363e-01]
 [ 1.06151653e-02 -4.03134680e-01 -6.27466283e-02]
 [ 1.80684151e-01  2.36593971e-01 -5.15915294e-02]
 [-1.09400514e-01  2.07287099e-02 -8.92573902e-02]
 [ 1.30661654e-01  2.62034404e-02  2.26058907e-01]
 [ 1.82278055e-01 -1.82100411e-01 -5.68555447e-02]
 [-1.88779980e-01 -1.34720751e-01 -2.96109466e-01]
 [ 3.01147919e-01 -4.01643001e-01 -1.39469136e-01]
 [ 1.00484307e-01 -6.25942147e-02 -4.04598783e-02]
 [-1.71098862e-01  2.58127916e-01  1.89150335e-01]
 [ 4.64306868e-02 -3.62685054e-01 -9.45662703e-02]
 [ 7.59849847e-02 -2.26281317e-01 -8.26615941e-02]
 [-2.48223862e-01 -1.51420283e-02 -4.63685129e-02]
 [ 2.72406851e-01  1.33571177e+00  4.01603675e-01]
 [-2.54976465e-01 -3.58474872e-02  2.10959436e-01]
 [-8.72039495e-02  5.59555024e-03 -4.37365728e-02]
 [ 1.83219255e-01 -5.19386936e-02  9.97675398e-02]
 [-9.50339378e-02  5.52778738e-02 -1.10971106e-01]
 [-3.86198775e-03 -1.02142278e-01  1.02105349e-01]
 [-1.07720853e-01  8.98110459e-02  6.11436182e-03]
 [ 9.77404862e-02 -1.20608231e-01 -1.32390471e-01]
 [ 5.30889023e-02 -4.53868205e-02  1.10253232e-01]
 [-1.23347687e-01  4.11562768e-02  1.20928109e-01]
 [-3.62983946e-01  1.84527207e-02 -5.03906823e-01]
 [ 1.94080528e-01 -1.22865152e-01 -1.57527150e-01]
 [ 1.34658071e-01  2.64632909e-03 -3.98912947e-02]
 [ 3.00615965e-02  1.53024934e-01 -3.77089900e-02]
 [-1.25853636e-01  1.85358981e-02 -1.75508932e-01]
 [-3.22006280e-02  1.45964805e-01  9.48680979e-02]
 [-2.34418632e-01  8.25245797e-02  1.22763986e-02]
 [-1.49300229e-01 -6.92674213e-02 -2.15895744e-02]
 [ 1.88644991e-01  1.51537818e-01  4.98748806e-02]
 [-1.36347189e-01  2.00384182e-01  5.40272824e-03]
 [ 1.63852614e-03 -2.14440751e-01  6.89129200e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.1305966]
curr_Stock_Price:  101.2181393803229
curr_Factors:  [101.21813938  -0.90914151  -1.03330735]
mat_Sqrt:  [[14.50987022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185341  0.03791214  0.16793722]
Stock Position:  -0.0018534069016152756
Bond Position:  [11.318195]


portfolio before change:  [11.13368921]
curr_Stock_Price:  100.31291333293635
curr_Factors:  [100.31291333  -0.81288951  -1.03630579]
mat_Sqrt:  [[15.78561592  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287484  0.01411938  0.0859571 ]
Stock Position:  -0.002874835107150927
Bond Position:  [11.4220723]


portfolio before change:  [11.13686546]
curr_Stock_Price:  99.70474199298023
curr_Factors:  [99.70474199 -0.90181211 -1.04378252]
mat_Sqrt:  [[14.24802933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02198292 0.07137405 0.88933244]
Stock Position:  0.021982917955438826
Bond Position:  [8.94506429]


portfolio before change:  [11.12694901]
curr_Stock_Price:  99.2027775332482
curr_Factors:  [99.20277753 -0.8146868  -1.06927379]
mat_Sqrt:  [[15.07752801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00078284 0.01517787 0.36713008]
Stock Position:  0.0007828445761429194
Bond Position:  [11.04928866]


portfolio before change:  [11.12833549]
curr_Stock_Price:  99.20945127481114
curr_Factors:  [99.20945127 -0.91603755 -1.0889805 ]
mat_Sqrt:  [[13.35933298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03591064 -0.04752984  0.11645133]
Stock Position:  -0.03591064185946863
Bond Position:  [14.69101056]


portfolio before change:  [11.15840076]
curr_Stock_Price:  98.42336727074715
curr_Factors:  [98.42336727 -0.82121634 -1.10473829]
mat_Sqrt:  [[14.34388354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010794  -0.05381618 -0.64247674]
Stock Position:  -0.0010793984535540588
Bond Position:  [11.26463879]


portfolio before change:  [11.16175188]
curr_Stock_Price:  96.62333475738791
curr_Factors:  [96.62333476 -0.65710527 -1.08282373]
mat_Sqrt:  [[16.96057053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00074301 -0.12748238 -0.17899867]
Stock Position:  -0.0007430073914373001
Bond Position:  [11.23354373]


portfolio before change:  [11.16250235]
curr_Stock_Price:  97.50328780966834
curr_Factors:  [97.50328781 -0.97517621 -1.05616704]
mat_Sqrt:  [[12.78845548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01378289  0.07481758 -0.14717627]
Stock Position:  0.013782892262666803
Bond Position:  [9.81862504]


portfolio before change:  [11.16400851]
curr_Stock_Price:  97.52351234424779
curr_Factors:  [97.52351234 -1.00719952 -0.99646023]
mat_Sqrt:  [[13.15015766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00966413  0.00655499 -0.25462649]
Stock Position:  -0.009664134248973744
Bond Position:  [12.10648882]


portfolio before change:  [11.17422177]
curr_Stock_Price:  96.6232911900487
curr_Factors:  [96.62329119 -1.02675488 -0.99408285]
mat_Sqrt:  [[12.80687446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01385836 0.00828626 0.64488314]
Stock Position:  0.013858362195779312
Bond Position:  [9.8351812]


portfolio before change:  [11.17079177]
curr_Stock_Price:  96.28706988306435
curr_Factors:  [96.28706988 -1.05565722 -1.02221947]
mat_Sqrt:  [[12.05473283  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01376809 -0.05758521 -0.16219304]
Stock Position:  0.013768090562529402
Bond Position:  [9.84510267]


portfolio before change:  [11.16792058]
curr_Stock_Price:  95.98914154223927
curr_Factors:  [95.98914154 -1.1027597  -1.05857521]
mat_Sqrt:  [[11.05519185  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02285818 -0.04260244 -0.84471789]
Stock Position:  -0.022858178263764063
Bond Position:  [13.36205749]


portfolio before change:  [11.17706328]
curr_Stock_Price:  95.66224126614331
curr_Factors:  [95.66224127 -1.13377868 -1.04410636]
mat_Sqrt:  [[10.83670108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02420557 -0.12701067 -0.39786662]
Stock Position:  0.02420556965318723
Bond Position:  [8.86150424]


portfolio before change:  [11.18447021]
curr_Stock_Price:  95.92247754307958
curr_Factors:  [95.92247754 -1.27285764 -1.03058788]
mat_Sqrt:  [[ 9.58399788  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00945423 -0.01979403 -0.11542077]
Stock Position:  0.009454227186468968
Bond Position:  [10.27759731]


portfolio before change:  [11.18607631]
curr_Stock_Price:  95.95646503388974
curr_Factors:  [95.95646503 -1.35073487 -1.03880536]
mat_Sqrt:  [[ 8.79650402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01430385  0.08162721  0.53959326]
Stock Position:  -0.014303850440107227
Bond Position:  [12.55862324]


portfolio before change:  [11.20067382]
curr_Stock_Price:  95.04569080632955
curr_Factors:  [95.04569081 -1.22978134 -1.04942682]
mat_Sqrt:  [[ 9.72937416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0018257  -0.11469108 -0.26977125]
Stock Position:  0.0018257022040031779
Bond Position:  [11.02714869]


portfolio before change:  [11.20411695]
curr_Stock_Price:  96.17657094350629
curr_Factors:  [96.17657094 -1.14114604 -1.09104777]
mat_Sqrt:  [[10.31905278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00516222 -0.07155644 -0.23581052]
Stock Position:  0.005162217896971027
Bond Position:  [10.70763253]


portfolio before change:  [11.20294393]
curr_Stock_Price:  95.69004491862492
curr_Factors:  [95.69004492 -1.19261969 -1.06137445]
mat_Sqrt:  [[10.04545334  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0256912  -0.00478833 -0.13227646]
Stock Position:  -0.025691200954096768
Bond Position:  [13.66133611]


portfolio before change:  [11.22269126]
curr_Stock_Price:  94.98787652437639
curr_Factors:  [94.98787652 -1.22494388 -1.06036264]
mat_Sqrt:  [[ 9.66433926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0402378  0.42238915 1.1456635 ]
Stock Position:  0.04023780380387806
Bond Position:  [7.40058772]


portfolio before change:  [11.25881052]
curr_Stock_Price:  95.86253002400022
curr_Factors:  [95.86253002 -1.25158015 -1.09296432]
mat_Sqrt:  [[ 9.19234172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02315407 -0.01133597  0.60180855]
Stock Position:  -0.02315407051249826
Bond Position:  [13.4784183]


portfolio before change:  [11.26913051]
curr_Stock_Price:  95.48958998305133
curr_Factors:  [95.48958998 -1.13969403 -1.09895907]
mat_Sqrt:  [[10.17938034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00942957  0.00176947 -0.12476827]
Stock Position:  -0.009429568441153554
Bond Position:  [12.16955613]


portfolio before change:  [11.2757482]
curr_Stock_Price:  94.94911979002065
curr_Factors:  [94.94911979 -1.21522582 -1.08833872]
mat_Sqrt:  [[ 9.48561682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02132103 -0.01642446  0.28460902]
Stock Position:  0.02132103496409217
Bond Position:  [9.2513347]


portfolio before change:  [11.27969315]
curr_Stock_Price:  95.07990426609872
curr_Factors:  [95.07990427 -1.11145883 -1.06829267]
mat_Sqrt:  [[10.75064914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0108141   0.0174804  -0.31656968]
Stock Position:  -0.010814095949321768
Bond Position:  [12.30789636]


portfolio before change:  [11.28083487]
curr_Stock_Price:  95.11660301316964
curr_Factors:  [95.11660301 -1.01280345 -1.07808093]
mat_Sqrt:  [[11.75430028  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122022 -0.03230022  0.29127814]
Stock Position:  0.001220223802618783
Bond Position:  [11.16477133]


portfolio before change:  [11.28377731]
curr_Stock_Price:  96.38420359311655
curr_Factors:  [96.38420359 -0.88397631 -1.09250049]
mat_Sqrt:  [[13.35466177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00779906  0.02840075  0.01744257]
Stock Position:  -0.007799063352329218
Bond Position:  [12.03548382]


portfolio before change:  [11.28939745]
curr_Stock_Price:  95.85649756330741
curr_Factors:  [95.85649756 -0.81487884 -1.1004872 ]
mat_Sqrt:  [[14.11850309  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00478821 -0.03813967 -0.37767316]
Stock Position:  0.00478820615791743
Bond Position:  [10.83041678]


portfolio before change:  [11.29099293]
curr_Stock_Price:  95.90695377203073
curr_Factors:  [95.90695377 -0.89311466 -1.13041785]
mat_Sqrt:  [[12.67771825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00587033 -0.01435257  0.31452178]
Stock Position:  0.005870328144565902
Bond Position:  [10.72798764]


portfolio before change:  [11.28763605]
curr_Stock_Price:  95.10666404229052
curr_Factors:  [95.10666404 -0.88960062 -1.16832349]
mat_Sqrt:  [[12.14691137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00803502  0.01301476  0.34497424]
Stock Position:  -0.008035021138571748
Bond Position:  [12.05182011]


portfolio before change:  [11.28651368]
curr_Stock_Price:  95.4338500158346
curr_Factors:  [95.43385002 -0.92013559 -1.15908723]
mat_Sqrt:  [[11.93184074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03900212  0.00583526 -1.4375059 ]
Stock Position:  -0.039002116945124864
Bond Position:  [15.00863586]


portfolio before change:  [11.27271569]
curr_Stock_Price:  95.83573040993139
curr_Factors:  [95.83573041 -1.00038401 -1.17042888]
mat_Sqrt:  [[10.93340405  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01452    -0.03885337 -0.44938111]
Stock Position:  0.014520003795045151
Bond Position:  [9.88118052]


portfolio before change:  [11.27852656]
curr_Stock_Price:  96.15085778796747
curr_Factors:  [96.15085779 -0.99793999 -1.14949419]
mat_Sqrt:  [[11.22882589  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0112731   0.00083684 -0.11379876]
Stock Position:  0.011273095177081955
Bond Position:  [10.19460879]


portfolio before change:  [11.27056138]
curr_Stock_Price:  95.3312433316566
curr_Factors:  [95.33124333 -0.91455451 -1.14928345]
mat_Sqrt:  [[12.10380226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00217414  0.04839073 -0.10757325]
Stock Position:  0.0021741406021056646
Bond Position:  [11.06329785]


portfolio before change:  [11.27270001]
curr_Stock_Price:  95.6787961806459
curr_Factors:  [95.67879618 -0.74239286 -1.16282125]
mat_Sqrt:  [[14.23612285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01132335  0.00586157 -0.50067813]
Stock Position:  -0.011323353562036021
Bond Position:  [12.35610484]


portfolio before change:  [11.28769637]
curr_Stock_Price:  94.49083050874597
curr_Factors:  [94.49083051 -0.71760773 -1.16761538]
mat_Sqrt:  [[14.3432534   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063214  0.04615812  0.27063228]
Stock Position:  -0.000632141346015356
Bond Position:  [11.34742793]


portfolio before change:  [11.28934438]
curr_Stock_Price:  94.12778831226034
curr_Factors:  [94.12778831 -0.7071661  -1.17573805]
mat_Sqrt:  [[14.32131738  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01604475  0.02609656  0.03502115]
Stock Position:  -0.016044749298291527
Bond Position:  [12.79960115]


portfolio before change:  [11.29054855]
curr_Stock_Price:  94.15246216997232
curr_Factors:  [94.15246217 -0.74380702 -1.19401713]
mat_Sqrt:  [[13.55955209  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01146761 -0.02190428 -0.06158905]
Stock Position:  -0.011467610322543934
Bond Position:  [12.37025229]


portfolio before change:  [11.29300629]
curr_Stock_Price:  94.07298889826198
curr_Factors:  [94.0729889  -0.6672521  -1.22605498]
mat_Sqrt:  [[14.16485471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01431277 0.04792047 0.14227915]
Stock Position:  0.014312772864110767
Bond Position:  [9.94656097]


portfolio before change:  [11.29562892]
curr_Stock_Price:  94.16935251305887
curr_Factors:  [94.16935251 -0.53066491 -1.20670368]
mat_Sqrt:  [[16.57219346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00784872  0.06336704  0.01541248]
Stock Position:  -0.007848717481542441
Bond Position:  [12.03473756]


portfolio before change:  [11.29034681]
curr_Stock_Price:  95.0340224336242
curr_Factors:  [95.03402243 -0.76392289 -1.19468872]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.29034681]
Stock Price:  94.68915392281629
PL:  [11.29034681]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.84550193e-01  1.00224612e-01  1.89983301e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 3.13789277e-01  2.00100564e-01  2.29968852e-01]
 [ 7.11645511e-03  4.79511850e-02  1.38682529e-01]
 [-3.17724931e-01 -1.03148254e-01  4.48892092e-02]
 [ 4.45682495e-02 -1.87391976e-01 -2.49909122e-01]
 [ 2.69959216e-02 -1.97040745e-01 -2.85050289e-02]
 [ 2.11273335e-01  9.21148983e-02 -4.86553151e-02]
 [-4.79477942e-01 -2.78332603e-02 -4.94295066e-02]
 [ 4.91268615e-02 -1.93019884e-02 -4.62343174e-02]
 [ 2.20719310e-02 -2.67666859e-01  6.04937063e-02]
 [ 7.08838338e-03 -3.21086171e-03  5.67324988e-03]
 [ 2.04494061e-01 -1.69572326e-01  1.44119859e-01]
 [ 8.63140158e-02 -5.87547746e-02 -5.96411377e-02]
 [ 9.64687019e-02 -1.00359154e-01 -6.84404809e-02]
 [-5.03253912e-02  7.73758920e-02  4.84521594e-02]
 [-4.51843963e-01 -2.99425651e-01  1.25155259e-01]
 [-1.38078162e-01  1.03487607e-02 -3.64450584e-02]
 [ 4.00647059e-01  1.50381269e+00  7.06605665e-01]
 [-5.92788585e-02  4.04208545e-03  8.21501377e-02]
 [-8.37471390e-02  2.31941196e-02 -4.03300166e-02]
 [ 4.53713065e-02  1.33596504e-02  2.39985359e-02]
 [ 2.17395943e-02 -2.95396798e-02  1.56359366e-02]
 [ 4.31589080e-02  1.19653632e-01  8.66799736e-02]
 [-5.98601736e-02 -1.42091036e-01 -2.30631687e-02]
 [ 8.85892604e-02  1.15740434e-02 -1.34721240e-02]
 [-2.10026798e-04 -3.39025552e-02 -3.11530202e-02]
 [ 5.79340245e-03  4.17712596e-02 -5.09096796e-02]
 [-5.60635157e-01  3.08319571e-02 -7.69535679e-01]
 [-6.54144695e-02 -1.18033792e-01 -7.61093367e-03]
 [-7.36096684e-02  9.21439591e-02  2.19417380e-01]
 [ 1.20776135e-02  4.50198598e-02  1.36533610e-02]
 [-1.36453876e-01 -1.69704838e-02 -1.33439103e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 2.35391479e-01 -1.74843757e-01 -7.00493196e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-6.04517900e-03 -6.82178259e-03 -4.70840473e-02]
 [-9.61206780e-02  5.61088531e-02  4.37628795e-04]
 [-1.40283992e-02 -2.88534183e-01  1.13304160e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.80747854]
curr_Stock_Price:  99.55480777998638
curr_Factors:  [99.55480778 -0.98702163 -0.99644187]
mat_Sqrt:  [[13.69793138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01045284  0.03169381  0.54196948]
Stock Position:  -0.01045283567759174
Bond Position:  [0.23315151]


portfolio before change:  [-0.81385597]
curr_Stock_Price:  100.16771103712847
curr_Factors:  [100.16771104  -0.96799008  -1.0272175 ]
mat_Sqrt:  [[13.62134854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00333161  0.01411938  0.0859571 ]
Stock Position:  -0.003331611603557083
Bond Position:  [-0.48013606]


portfolio before change:  [-0.81540592]
curr_Stock_Price:  100.61492085875335
curr_Factors:  [100.61492086  -0.66601931  -1.04675437]
mat_Sqrt:  [[18.1473925   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02016257 0.06327735 0.65603712]
Stock Position:  0.020162568634131305
Bond Position:  [-2.84406116]


portfolio before change:  [-0.83072959]
curr_Stock_Price:  99.87254811507667
curr_Factors:  [99.87254812 -0.39498604 -1.04821467]
mat_Sqrt:  [[23.58696299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00155438 0.0151635  0.39562265]
Stock Position:  0.0015543757026389119
Bond Position:  [-0.98596905]


portfolio before change:  [-0.83086609]
curr_Stock_Price:  99.86402543521615
curr_Factors:  [99.86402544 -0.49970884 -1.03470811]
mat_Sqrt:  [[21.52882151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01445621 -0.03261834  0.12805642]
Stock Position:  -0.014456213289654138
Bond Position:  [0.61278956]


portfolio before change:  [-0.81258652]
curr_Stock_Price:  98.60484632650329
curr_Factors:  [98.60484633 -0.35521081 -1.03282291]
mat_Sqrt:  [[24.60837139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.58489357e-04 -5.92585460e-02 -7.12921164e-01]
Stock Position:  -0.0004584893572077528
Bond Position:  [-0.76737725]


portfolio before change:  [-0.8125231]
curr_Stock_Price:  98.25729070230764
curr_Factors:  [98.2572907  -0.63972583 -1.0449513 ]
mat_Sqrt:  [[18.22715156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00088274 -0.06230975 -0.08131691]
Stock Position:  0.0008827373132400008
Bond Position:  [-0.89925848]


portfolio before change:  [-0.81195008]
curr_Stock_Price:  99.03377728796524
curr_Factors:  [99.03377729 -0.84954052 -1.0439315 ]
mat_Sqrt:  [[14.90935632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0136639   0.02912929 -0.13880007]
Stock Position:  0.013663903559052308
Bond Position:  [-2.16513806]


portfolio before change:  [-0.79189241]
curr_Stock_Price:  100.52151673882499
curr_Factors:  [100.52151674  -1.00099107  -1.05629573]
mat_Sqrt:  [[12.84667473  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03816446 -0.00880165 -0.14100862]
Stock Position:  -0.03816445572119908
Bond Position:  [3.04445656]


portfolio before change:  [-0.74221648]
curr_Stock_Price:  99.22986073646918
curr_Factors:  [99.22986074 -0.96519503 -1.07995087]
mat_Sqrt:  [[12.83650529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00305309 -0.00610382 -0.13189364]
Stock Position:  0.003053085311276674
Bond Position:  [-1.04517371]


portfolio before change:  [-0.74040567]
curr_Stock_Price:  99.86576601844264
curr_Factors:  [99.86576602 -1.01301755 -1.08729963]
mat_Sqrt:  [[12.22532674  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00225017 -0.08464369  0.17257171]
Stock Position:  0.0022501671394472298
Bond Position:  [-0.96512033]


portfolio before change:  [-0.74166152]
curr_Stock_Price:  99.36126721111233
curr_Factors:  [99.36126721 -1.00314979 -1.07368588]
mat_Sqrt:  [[12.4525659   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065557 -0.00101536  0.0161842 ]
Stock Position:  0.0006555698345893724
Bond Position:  [-0.80679977]


portfolio before change:  [-0.74177239]
curr_Stock_Price:  99.34599662236991
curr_Factors:  [99.34599662 -1.05600833 -1.07409303]
mat_Sqrt:  [[11.8048128   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01944411 -0.05362348  0.41113384]
Stock Position:  0.01944410885606678
Bond Position:  [-2.67346676]


portfolio before change:  [-0.7479541]
curr_Stock_Price:  99.04526245218896
curr_Factors:  [99.04526245 -1.29549445 -1.08640391]
mat_Sqrt:  [[ 9.14931104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00793751 -0.01857989 -0.17013957]
Stock Position:  0.007937513269069933
Bond Position:  [-1.53412718]


portfolio before change:  [-0.74875628]
curr_Stock_Price:  98.96836109420394
curr_Factors:  [98.96836109 -1.78894758 -1.07530208]
mat_Sqrt:  [[ 5.64376026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01415848 -0.03173635 -0.19524164]
Stock Position:  0.014158483232106042
Bond Position:  [-2.14999816]


portfolio before change:  [-0.75291305]
curr_Stock_Price:  98.69375516903507
curr_Factors:  [98.69375517 -1.7161842  -1.09495631]
mat_Sqrt:  [[ 5.93508389  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00647629  0.02446841  0.13822052]
Stock Position:  -0.006476285651922767
Bond Position:  [-0.1137441]


portfolio before change:  [-0.75457499]
curr_Stock_Price:  98.94817879256107
curr_Factors:  [98.94817879 -1.65286267 -1.09086731]
mat_Sqrt:  [[ 6.36533131  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06818622 -0.0946867   0.35703312]
Stock Position:  -0.06818622136694787
Bond Position:  [5.99232743]


portfolio before change:  [-0.75230567]
curr_Stock_Price:  98.92588349031637
curr_Factors:  [98.92588349 -1.62751106 -1.07833005]
mat_Sqrt:  [[ 6.60964408  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02197551  0.00327257 -0.10396761]
Stock Position:  -0.021975506184550284
Bond Position:  [1.42164069]


portfolio before change:  [-0.75112113]
curr_Stock_Price:  98.88006749417059
curr_Factors:  [98.88006749 -1.49377054 -1.07645552]
mat_Sqrt:  [[ 7.56612937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07714785 0.47554733 2.01574928]
Stock Position:  0.07714784987952084
Bond Position:  [-8.37950573]


portfolio before change:  [-0.73782722]
curr_Stock_Price:  99.0659626003824
curr_Factors:  [99.0659626  -1.84779159 -1.07427076]
mat_Sqrt:  [[ 5.33198487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00795307  0.00127822  0.23435148]
Stock Position:  -0.007953073150175101
Bond Position:  [0.05005163]


portfolio before change:  [-0.74168368]
curr_Stock_Price:  99.55165117500785
curr_Factors:  [99.55165118 -1.79582987 -1.06125267]
mat_Sqrt:  [[ 5.7178569   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01598162  0.00733462 -0.11505031]
Stock Position:  -0.01598161708976946
Bond Position:  [0.84931269]


portfolio before change:  [-0.74609833]
curr_Stock_Price:  99.83452739368862
curr_Factors:  [99.83452739 -1.69795738 -1.08688518]
mat_Sqrt:  [[ 6.16366478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00821182 0.00422469 0.06846114]
Stock Position:  0.008211824236895484
Bond Position:  [-1.56592192]


portfolio before change:  [-0.74804619]
curr_Stock_Price:  99.62116388685122
curr_Factors:  [99.62116389 -1.21611022 -1.0908804 ]
mat_Sqrt:  [[ 9.9183246   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00243676 -0.00934127  0.04460497]
Stock Position:  0.0024367578375409575
Bond Position:  [-0.99079884]


portfolio before change:  [-0.74596895]
curr_Stock_Price:  100.52445146355214
curr_Factors:  [100.52445146  -1.47815726  -1.09783909]
mat_Sqrt:  [[ 7.64769765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00836093 0.0378378  0.24727384]
Stock Position:  0.008360925063542803
Bond Position:  [-1.58644636]


portfolio before change:  [-0.74626941]
curr_Stock_Price:  100.51223550390148
curr_Factors:  [100.5122355   -1.47206209  -1.11111588]
mat_Sqrt:  [[ 7.59204881  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00898792 -0.04493313 -0.0657928 ]
Stock Position:  -0.00898791612782297
Bond Position:  [0.15712614]


portfolio before change:  [-0.74103015]
curr_Stock_Price:  99.93149888730248
curr_Factors:  [99.93149889 -1.36672183 -1.07094989]
mat_Sqrt:  [[ 8.7304177   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00986644  0.00366003 -0.03843222]
Stock Position:  0.009866436879206303
Bond Position:  [-1.72699798]


portfolio before change:  [-0.74472964]
curr_Stock_Price:  99.57842307232983
curr_Factors:  [99.57842307 -1.2104695  -1.09643045]
mat_Sqrt:  [[ 9.91496813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075083 -0.01072093 -0.0888709 ]
Stock Position:  -0.0007508315239604876
Bond Position:  [-0.66996302]


portfolio before change:  [-0.74515101]
curr_Stock_Price:  100.02807889877124
curr_Factors:  [100.0280789   -1.1483739   -1.11912589]
mat_Sqrt:  [[10.35998869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033977  0.01320923 -0.14523115]
Stock Position:  -0.0003397651482040784
Bond Position:  [-0.71116495]


portfolio before change:  [-0.74516899]
curr_Stock_Price:  99.81936108342389
curr_Factors:  [99.81936108 -0.956164   -1.12169954]
mat_Sqrt:  [[12.49712508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05736679  0.00974992 -2.19527109]
Stock Position:  -0.05736678531728959
Bond Position:  [4.98114686]


portfolio before change:  [-0.72242771]
curr_Stock_Price:  99.43379642148612
curr_Factors:  [99.43379642 -0.75336041 -1.11165861]
mat_Sqrt:  [[15.40162524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454599 -0.03732556 -0.02171188]
Stock Position:  -0.004545991941486577
Bond Position:  [-0.27040247]


portfolio before change:  [-0.72655838]
curr_Stock_Price:  100.33500259910538
curr_Factors:  [100.3350026   -0.72705477  -1.11065422]
mat_Sqrt:  [[15.97149585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165558  0.02913848  0.62593671]
Stock Position:  -0.0016555829650196404
Bond Position:  [-0.56044546]


portfolio before change:  [-0.72636637]
curr_Stock_Price:  100.17670842948041
curr_Factors:  [100.17670843  -0.85990876  -1.09229456]
mat_Sqrt:  [[14.22117978  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00112698 0.01423653 0.03894924]
Stock Position:  0.0011269811771697441
Bond Position:  [-0.83926364]


portfolio before change:  [-0.72634118]
curr_Stock_Price:  100.29215492268163
curr_Factors:  [100.29215492  -0.60633001  -1.08350952]
mat_Sqrt:  [[18.50883052  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00886767 -0.00536654 -0.38066462]
Stock Position:  -0.00886766964808063
Bond Position:  [0.16301651]


portfolio before change:  [-0.73432326]
curr_Stock_Price:  101.19458501724581
curr_Factors:  [101.19458502  -0.56063945  -1.07530072]
mat_Sqrt:  [[19.70958533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026593   0.0049611   0.16678008]
Stock Position:  -0.0026593001671813055
Bond Position:  [-0.46521648]


portfolio before change:  [-0.73581753]
curr_Stock_Price:  101.73462040668201
curr_Factors:  [101.73462041  -0.56839154  -1.08595718]
mat_Sqrt:  [[19.4533432   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01113322 -0.05529045 -0.19983121]
Stock Position:  0.01113321619827263
Bond Position:  [-1.86845105]


portfolio before change:  [-0.75132056]
curr_Stock_Price:  100.36309715765977
curr_Factors:  [100.36309716  -0.42892098  -1.08915734]
mat_Sqrt:  [[21.99282493  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00111454 0.00777784 0.21633947]
Stock Position:  0.001114540025175879
Bond Position:  [-0.86317925]


portfolio before change:  [-0.75096057]
curr_Stock_Price:  100.78290781241482
curr_Factors:  [100.78290781  -0.52413727  -1.06873017]
mat_Sqrt:  [[20.49336834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00077256 -0.00215724 -0.13431768]
Stock Position:  -0.0007725576056513823
Bond Position:  [-0.67309997]


portfolio before change:  [-0.74964269]
curr_Stock_Price:  98.9681190209166
curr_Factors:  [98.96811902 -0.39516039 -1.07949814]
mat_Sqrt:  [[22.64953305  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00417592  0.01774318  0.00124843]
Stock Position:  -0.0041759193377019525
Bond Position:  [-0.3363598]


portfolio before change:  [-0.75281096]
curr_Stock_Price:  99.71674967553615
curr_Factors:  [99.71674968 -0.70478437 -1.10706779]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.75281096]
Stock Price:  99.44184984973428
PL:  [-0.75281096]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.09541661e-01  2.66439611e-02  1.58503164e-01]
 [-1.03557455e-01  3.60900519e-02  9.71913141e-02]
 [ 2.22839640e-01  3.20664852e-01  4.76839845e-01]
 [-3.56517656e-02 -3.31539112e-02  9.24758655e-02]
 [-4.42092303e-02 -2.56717325e-02  5.15732303e-02]
 [ 1.18788616e-01 -3.08722383e-01 -4.25903993e-01]
 [ 1.73195680e-04 -5.34812330e-01 -8.55115617e-02]
 [ 5.87956315e-02  2.70117263e-01 -9.03760356e-03]
 [-1.02348207e-01  1.03602125e-02 -4.24627517e-02]
 [ 1.56987591e-01  7.45225102e-02  4.00891031e-01]
 [ 1.92667956e-01 -3.13235761e-01 -1.91561229e-02]
 [-1.34243962e-02 -3.82632587e-02 -8.07423072e-02]
 [ 2.00861323e-01 -1.76256186e-01  1.45238547e-01]
 [ 8.51993857e-02  8.06146923e-02  4.26660734e-02]
 [ 4.24340725e-02 -1.05441137e-01 -5.63234062e-02]
 [-4.33837615e-02  6.09825624e-02  4.68382720e-02]
 [-4.44082673e-01 -2.50543455e-01  1.16985739e-01]
 [-1.71469336e-01 -3.71776382e-02 -2.26567595e-02]
 [ 2.83170320e-01  1.15502067e+00  4.41183757e-01]
 [ 1.08725590e-02  1.01971979e-02  3.07372724e-02]
 [ 1.40983584e-02 -1.42617734e-01  5.24714000e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.82185495e-01 -2.26313829e-02  1.81652601e-01]
 [ 7.56506538e-02 -1.97236851e-01 -8.47193626e-02]
 [-9.70754168e-02  8.26610380e-02  1.47213857e-01]
 [ 1.49122127e-02  6.33010085e-02 -1.60577685e-02]
 [-1.20637047e-01 -1.30609324e-02  1.09239798e-01]
 [ 2.20694398e-02  5.42824047e-02 -6.88596081e-02]
 [-6.41661022e-01 -5.63660673e-02 -9.57010471e-01]
 [-1.85289887e-01  1.63667225e-01 -7.49613527e-02]
 [-9.94751611e-02 -4.11214750e-03  1.19683607e-01]
 [ 1.47134853e-02  3.99451383e-02  1.68797156e-02]
 [-1.41604742e-01  1.85864777e-03 -1.35596038e-01]
 [-6.37843008e-02  7.08690889e-03  5.39030987e-02]
 [ 1.96320792e-01 -1.68205910e-01 -8.56888085e-02]
 [-1.35469000e-03  9.45604370e-02  7.81819155e-02]
 [ 1.80058373e-03  1.66466935e-03 -4.65397370e-02]
 [-8.12809054e-02  3.36508935e-02 -2.49754814e-03]
 [-6.03676212e-02 -2.00947312e-01  7.92829658e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.16031314]
curr_Stock_Price:  99.68965016171607
curr_Factors:  [99.68965016 -0.94349096 -0.97063083]
mat_Sqrt:  [[14.70136099  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01200565  0.00842556  0.45216541]
Stock Position:  -0.012005649971563791
Bond Position:  [1.35715219]


portfolio before change:  [0.17341792]
curr_Stock_Price:  98.61223067787796
curr_Factors:  [98.61223068 -0.70847614 -0.97036086]
mat_Sqrt:  [[18.4001405   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00449923  0.01141268  0.27725977]
Stock Position:  -0.004499233008958727
Bond Position:  [0.61709732]


portfolio before change:  [0.17304679]
curr_Stock_Price:  98.71186463222462
curr_Factors:  [98.71186463 -0.93138731 -0.99941461]
mat_Sqrt:  [[14.31636413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02294254 0.10140313 1.36029135]
Stock Position:  0.022942535834521476
Bond Position:  [-2.09165371]


portfolio before change:  [0.15642236]
curr_Stock_Price:  97.99864988361169
curr_Factors:  [97.99864988 -0.82660441 -0.98550095]
mat_Sqrt:  [[16.0041545   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110167 -0.01048419  0.2638079 ]
Stock Position:  -0.001101666379311979
Bond Position:  [0.26438418]


portfolio before change:  [0.15741772]
curr_Stock_Price:  97.1251457339037
curr_Factors:  [97.12514573 -0.82515224 -0.96883398]
mat_Sqrt:  [[16.15151874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00212641 -0.00811811  0.14712407]
Stock Position:  -0.0021264087043575473
Bond Position:  [0.36394547]


portfolio before change:  [0.15934381]
curr_Stock_Price:  96.2407481867774
curr_Factors:  [96.24074819 -0.52845511 -0.99833941]
mat_Sqrt:  [[20.90646259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.14223769e-03 -9.76265896e-02 -1.21498554e+00]
Stock Position:  0.0011422376881275044
Bond Position:  [0.049414]


portfolio before change:  [0.15805398]
curr_Stock_Price:  95.10613173403199
curr_Factors:  [95.10613173 -0.24653915 -0.99764527]
mat_Sqrt:  [[27.40728949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113439 -0.16912251 -0.24394068]
Stock Position:  -0.0011343906792918846
Bond Position:  [0.26594149]


portfolio before change:  [0.15661689]
curr_Stock_Price:  96.40227624587035
curr_Factors:  [96.40227625 -0.50730638 -0.95277331]
mat_Sqrt:  [[22.38632158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00285555  0.08541858 -0.02578177]
Stock Position:  0.002855548908709119
Bond Position:  [-0.11866452]


portfolio before change:  [0.15875589]
curr_Stock_Price:  97.15653895235718
curr_Factors:  [97.15653895 -0.38081534 -0.97079632]
mat_Sqrt:  [[25.14632652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00440416  0.00327619 -0.12113441]
Stock Position:  -0.0044041574159642445
Bond Position:  [0.58664858]


portfolio before change:  [0.16477768]
curr_Stock_Price:  95.80589352845344
curr_Factors:  [95.80589353 -0.25413492 -0.91946568]
mat_Sqrt:  [[29.62811096  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0081255  0.02356609 1.14363052]
Stock Position:  0.008125502604754867
Bond Position:  [-0.61369336]


portfolio before change:  [0.1724984]
curr_Stock_Price:  96.76551792584105
curr_Factors:  [96.76551793 -0.27029515 -0.91055879]
mat_Sqrt:  [[29.70860602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0060814  -0.09905385 -0.05464709]
Stock Position:  0.006081403337716181
Bond Position:  [-0.41597175]


portfolio before change:  [0.18389667]
curr_Stock_Price:  98.64835221907576
curr_Factors:  [98.64835222 -0.48312799 -0.9447649 ]
mat_Sqrt:  [[23.65722684  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00130589 -0.0120999  -0.23033533]
Stock Position:  -0.001305892865364893
Bond Position:  [0.31272085]


portfolio before change:  [0.18338386]
curr_Stock_Price:  99.07097974491721
curr_Factors:  [99.07097974 -0.70911588 -0.93047406]
mat_Sqrt:  [[19.22567506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01175288 -0.0557371   0.41432515]
Stock Position:  0.011752882636766163
Bond Position:  [-0.98098574]


portfolio before change:  [0.19474562]
curr_Stock_Price:  100.04813533899477
curr_Factors:  [100.04813534  -0.79117194  -0.94036713]
mat_Sqrt:  [[17.70969723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0054202  0.0254926  0.12171443]
Stock Position:  0.005420195652424555
Bond Position:  [-0.34753485]


portfolio before change:  [0.19368811]
curr_Stock_Price:  99.86104459102242
curr_Factors:  [99.86104459 -0.96513262 -0.96216962]
mat_Sqrt:  [[14.53380651  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194131 -0.03334342 -0.160675  ]
Stock Position:  0.0019413102039966908
Bond Position:  [-0.00017316]


portfolio before change:  [0.19661226]
curr_Stock_Price:  101.36733229644365
curr_Factors:  [101.3673323   -1.06577186  -0.95418615]
mat_Sqrt:  [[13.44749527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023981   0.01928438  0.13361655]
Stock Position:  -0.002398095377472998
Bond Position:  [0.43970079]


portfolio before change:  [0.1998154]
curr_Stock_Price:  100.05455265119099
curr_Factors:  [100.05455265  -0.94656836  -0.93812335]
mat_Sqrt:  [[15.1958725   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02807816 -0.0792288   0.33372775]
Stock Position:  -0.028078155001557054
Bond Position:  [3.00916263]


portfolio before change:  [0.19542487]
curr_Stock_Price:  100.22431776174164
curr_Factors:  [100.22431776  -0.86355274  -0.93418931]
mat_Sqrt:  [[16.60441791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01066307 -0.0117566  -0.06463343]
Stock Position:  -0.010663068761198402
Bond Position:  [1.26412366]


portfolio before change:  [0.1839763]
curr_Stock_Price:  101.31280327300935
curr_Factors:  [101.31280327  -1.14306259  -0.94842586]
mat_Sqrt:  [[12.51245234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03221184 0.36524961 1.25857446]
Stock Position:  0.032211837604471716
Bond Position:  [-3.07949526]


portfolio before change:  [0.19586493]
curr_Stock_Price:  101.69383067996385
curr_Factors:  [101.69383068  -1.02341456  -0.96383278]
mat_Sqrt:  [[13.93939917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00124898 0.00322464 0.08768488]
Stock Position:  0.0012489827384611415
Bond Position:  [0.0688511]


portfolio before change:  [0.19803168]
curr_Stock_Price:  103.42174812956824
curr_Factors:  [103.42174813  -1.20431606  -0.98870573]
mat_Sqrt:  [[11.53970245  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00183078 -0.04509969  0.1496863 ]
Stock Position:  0.0018307806584452252
Bond Position:  [0.00868914]


portfolio before change:  [0.19934869]
curr_Stock_Price:  104.14052365576289
curr_Factors:  [104.14052366  -1.37748874  -0.99443561]
mat_Sqrt:  [[ 9.71641593  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00400033  0.01916992 -0.08961985]
Stock Position:  -0.004000329337440621
Bond Position:  [0.61594508]


portfolio before change:  [0.19820768]
curr_Stock_Price:  104.44499994082486
curr_Factors:  [104.44499994  -1.52433829  -1.01057755]
mat_Sqrt:  [[ 8.27918704  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02641332 -0.00715667  0.51820431]
Stock Position:  0.02641332245742645
Bond Position:  [-2.56053178]


portfolio before change:  [0.18530239]
curr_Stock_Price:  103.96852822752648
curr_Factors:  [103.96852823  -1.56307065  -1.01725805]
mat_Sqrt:  [[ 7.8755226   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00676333 -0.06237177 -0.24168076]
Stock Position:  0.006763329295718057
Bond Position:  [-0.517871]


portfolio before change:  [0.18295103]
curr_Stock_Price:  103.63043690867349
curr_Factors:  [103.63043691  -1.6621762   -0.98620391]
mat_Sqrt:  [[ 7.33348594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00884862  0.02613972  0.41996016]
Stock Position:  -0.008848617935654288
Bond Position:  [1.09993717]


portfolio before change:  [0.18673832]
curr_Stock_Price:  103.21796754034118
curr_Factors:  [103.21796754  -1.44061071  -0.96856573]
mat_Sqrt:  [[ 9.27819024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00143011  0.02001754 -0.04580834]
Stock Position:  0.0014301128850775812
Bond Position:  [0.03912497]


portfolio before change:  [0.18661773]
curr_Stock_Price:  103.13022816494968
curr_Factors:  [103.13022816  -1.46972199  -0.95296508]
mat_Sqrt:  [[ 9.14589801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01078908 -0.00413023  0.31163074]
Stock Position:  -0.010789077009994673
Bond Position:  [1.2992977]


portfolio before change:  [0.18931988]
curr_Stock_Price:  102.89482989047622
curr_Factors:  [102.89482989  -1.53599447  -0.97039715]
mat_Sqrt:  [[ 8.39230972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112187  0.0171656  -0.1964373 ]
Stock Position:  0.001121871946806817
Bond Position:  [0.07388506]


portfolio before change:  [0.18939984]
curr_Stock_Price:  102.9578656383506
curr_Factors:  [102.95786564  -1.50938305  -0.95235697]
mat_Sqrt:  [[ 8.78090799  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09548732 -0.01782452 -2.73008449]
Stock Position:  -0.095487315442681
Bond Position:  [10.02057003]


portfolio before change:  [0.12667717]
curr_Stock_Price:  103.62785322275963
curr_Factors:  [103.62785322  -1.63423032  -0.92661   ]
mat_Sqrt:  [[ 8.00419533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02453281  0.05175612 -0.21384387]
Stock Position:  -0.02453281455509203
Bond Position:  [2.66896008]


portfolio before change:  [0.11553383]
curr_Stock_Price:  104.09567469277148
curr_Factors:  [104.09567469  -1.48565834  -0.91184072]
mat_Sqrt:  [[ 9.46699335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00793821 -0.00130038  0.34142402]
Stock Position:  -0.007938214334008702
Bond Position:  [0.94186761]


portfolio before change:  [0.11580366]
curr_Stock_Price:  104.07651613717033
curr_Factors:  [104.07651614  -1.62736354  -0.88024993]
mat_Sqrt:  [[ 8.47832487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00226347 0.01263176 0.04815313]
Stock Position:  0.0022634685657992606
Bond Position:  [-0.11977026]


portfolio before change:  [0.11647205]
curr_Stock_Price:  104.37842627961362
curr_Factors:  [104.37842628  -1.68768856  -0.86824723]
mat_Sqrt:  [[ 8.10180778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02088857  0.00058776 -0.38681775]
Stock Position:  -0.020888569775870135
Bond Position:  [2.29678809]


portfolio before change:  [0.12297835]
curr_Stock_Price:  104.080695054058
curr_Factors:  [104.08069505  -1.54336177  -0.85801634]
mat_Sqrt:  [[ 9.42898442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00557837  0.00224108  0.15377054]
Stock Position:  -0.005578373160893086
Bond Position:  [0.7035793]


portfolio before change:  [0.12549232]
curr_Stock_Price:  103.64579788034293
curr_Factors:  [103.64579788  -1.38139968  -0.84958563]
mat_Sqrt:  [[11.13389419  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01567166 -0.05319138 -0.24444632]
Stock Position:  0.01567165779254223
Bond Position:  [-1.49880916]


portfolio before change:  [0.1223244]
curr_Stock_Price:  103.45561009618324
curr_Factors:  [103.4556101   -1.52098185  -0.84218925]
mat_Sqrt:  [[ 9.73737463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00175054 0.02990264 0.22303124]
Stock Position:  0.0017505402938569094
Bond Position:  [-0.05877882]


portfolio before change:  [0.12281064]
curr_Stock_Price:  103.73757343146286
curr_Factors:  [103.73757343  -1.58440198  -0.86101965]
mat_Sqrt:  [[ 8.99296633  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085137  0.00052641 -0.13276492]
Stock Position:  -0.0008513674417444001
Bond Position:  [0.21112943]


portfolio before change:  [0.12255921]
curr_Stock_Price:  104.06389519212875
curr_Factors:  [104.06389519  -1.79453492  -0.86183122]
mat_Sqrt:  [[ 7.30558372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01107671  0.01064135 -0.00712481]
Stock Position:  -0.011076712836390496
Bond Position:  [1.27524509]


portfolio before change:  [0.12176777]
curr_Stock_Price:  104.14973765766337
curr_Factors:  [104.14973766  -1.90234133  -0.84777888]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.12176777]
Stock Price:  103.75325756746831
PL:  [-3.63148979]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.77003040e-01  6.54966377e-03  1.09042571e-01]
 [-1.13722440e-01  2.11028312e-02  1.27783622e-01]
 [ 2.06368172e-01  2.80348441e-01  4.22773436e-01]
 [-4.04953537e-02 -7.55481930e-02  7.59989178e-02]
 [-1.67819845e-01 -6.06858848e-02  4.85525044e-02]
 [ 7.14562908e-02 -2.15643465e-01 -2.93971650e-01]
 [ 2.02998731e-02 -2.81437995e-01 -4.29707811e-02]
 [ 9.13746528e-02  2.69888191e-01 -2.12853427e-02]
 [-1.87588311e-01  1.66148879e-02 -1.06721135e-01]
 [ 1.00631672e-01 -1.43899629e-02  5.60410792e-02]
 [ 6.48947781e-02 -2.82710422e-01  2.45243066e-02]
 [-4.43513960e-02  2.12640701e-03  3.15986167e-02]
 [ 1.58112698e-01 -8.69152950e-02  2.36650587e-01]
 [ 8.95304116e-02 -1.35268124e-02 -5.58778493e-02]
 [ 9.38707981e-02 -1.12774385e-01 -6.15617988e-02]
 [-4.91959686e-02  7.54493024e-02  4.90849912e-02]
 [-4.66670297e-01 -2.60216913e-01  1.26578865e-01]
 [-1.47431932e-01  9.79791627e-03 -2.84629423e-02]
 [ 3.47789455e-01  1.39920303e+00  5.44065647e-01]
 [-1.12077468e-01 -6.01880099e-03  1.13892561e-01]
 [-9.27995781e-02  1.87104657e-01 -3.52256442e-02]
 [ 1.19334130e-02  2.21053234e-02  9.76951477e-03]
 [ 1.00444807e-02 -2.71877224e-02 -7.21822577e-03]
 [ 2.74936041e-02  1.00992434e-01  1.10362423e-01]
 [-9.53821272e-02  2.55487359e-02 -3.00901773e-02]
 [ 1.09162439e-01 -6.10282138e-02 -4.82294142e-02]
 [ 3.09361879e-02 -6.72293154e-02  8.20217680e-02]
 [-4.20150579e-02  4.20207885e-02  4.70993837e-02]
 [-4.76765517e-01  7.48482844e-02 -6.08311523e-01]
 [ 2.12728655e-02 -1.18151180e-01 -5.85328341e-02]
 [-2.67940377e-02  6.64208273e-02  1.42119769e-01]
 [ 1.78340015e-02  7.96752386e-02 -2.83046989e-03]
 [-1.24420671e-01 -9.97962680e-03 -1.45116796e-01]
 [-6.18793878e-02  8.44833180e-02  1.02093786e-01]
 [-5.94320017e-02  4.36600397e-02  1.03692300e-01]
 [-2.93766210e-02 -3.71398845e-02  4.95588679e-02]
 [ 9.75182627e-02  7.96297312e-02  2.01584755e-02]
 [-1.30630699e-01  1.77017491e-01  9.04328990e-04]
 [ 1.69482629e-03 -2.17893178e-01  7.05440793e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.27569608]
curr_Stock_Price:  99.84505642839501
curr_Factors:  [99.84505643 -1.00832324 -1.01621556]
mat_Sqrt:  [[13.18501215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01172359  0.00207119  0.3110681 ]
Stock Position:  -0.011723592263495609
Bond Position:  [2.44623881]


portfolio before change:  [1.29155288]
curr_Stock_Price:  98.5185858842549
curr_Factors:  [98.51858588 -0.88022898 -1.01141179]
mat_Sqrt:  [[14.8589807   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00586136  0.0066733   0.36453111]
Stock Position:  -0.0058613606034882155
Bond Position:  [1.86900584]


portfolio before change:  [1.2932307]
curr_Stock_Price:  98.27219714012658
curr_Factors:  [98.27219714 -0.88108877 -1.02151059]
mat_Sqrt:  [[14.66027993  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02045698 0.08865396 1.20605494]
Stock Position:  0.020456976647811907
Bond Position:  [-0.71712135]


portfolio before change:  [1.27510356]
curr_Stock_Price:  97.39046915748517
curr_Factors:  [97.39046916 -0.92485465 -1.02709844]
mat_Sqrt:  [[13.82910268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194754 -0.02389044  0.21680376]
Stock Position:  -0.001947543972222618
Bond Position:  [1.46477578]


portfolio before change:  [1.27411146]
curr_Stock_Price:  97.99390189536236
curr_Factors:  [97.9939019  -0.79567297 -1.03050028]
mat_Sqrt:  [[15.77982153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01010633 -0.01919056  0.13850678]
Stock Position:  -0.010106325254445592
Bond Position:  [2.2644697]


portfolio before change:  [1.27946827]
curr_Stock_Price:  97.491866708268
curr_Factors:  [97.49186671 -0.96617991 -1.05007142]
mat_Sqrt:  [[12.98140075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.53085824e-04 -6.81924512e-02 -8.38619293e-01]
Stock Position:  0.0004530858235910067
Bond Position:  [1.23529608]


portfolio before change:  [1.27964119]
curr_Stock_Price:  97.53270342020075
curr_Factors:  [97.53270342 -0.81058106 -1.06620693]
mat_Sqrt:  [[14.93040529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028544 -0.08899851 -0.12258368]
Stock Position:  0.00028544445221026076
Bond Position:  [1.25180102]


portfolio before change:  [1.27965625]
curr_Stock_Price:  97.03726742714184
curr_Factors:  [97.03726743 -0.64975399 -1.0773727 ]
mat_Sqrt:  [[17.25269591  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00544832  0.08534614 -0.06072116]
Stock Position:  0.005448324365430206
Bond Position:  [0.75096575]


portfolio before change:  [1.28619044]
curr_Stock_Price:  98.21933942416813
curr_Factors:  [98.21933942 -0.88261161 -1.09871777]
mat_Sqrt:  [[13.5430534   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01542811  0.00525409 -0.30444569]
Stock Position:  -0.01542810703071877
Bond Position:  [2.80152892]


portfolio before change:  [1.29283583]
curr_Stock_Price:  97.81130688696832
curr_Factors:  [97.81130689 -0.94617971 -1.12294925]
mat_Sqrt:  [[12.3531516   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00904218 -0.00455051  0.1598696 ]
Stock Position:  0.00904218340683621
Bond Position:  [0.40840805]


portfolio before change:  [1.30239224]
curr_Stock_Price:  98.86253066985468
curr_Factors:  [98.86253067 -0.75947399 -1.12542227]
mat_Sqrt:  [[15.01176229  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00417015 -0.08940089  0.06996102]
Stock Position:  0.0041701452664479124
Bond Position:  [0.89012112]


portfolio before change:  [1.30760049]
curr_Stock_Price:  100.08478574966753
curr_Factors:  [100.08478575  -0.93808422  -1.13222619]
mat_Sqrt:  [[12.6253573   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299765  0.00067243  0.09014206]
Stock Position:  -0.0029976539195068225
Bond Position:  [1.60762004]


portfolio before change:  [1.3069481]
curr_Stock_Price:  100.36945893593946
curr_Factors:  [100.36945894  -0.91962205  -1.13775144]
mat_Sqrt:  [[12.82612974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01591865 -0.02748503  0.67509825]
Stock Position:  0.015918648732386763
Bond Position:  [-0.29079806]


portfolio before change:  [1.30587005]
curr_Stock_Price:  100.30401993127018
curr_Factors:  [100.30401993  -1.09627143  -1.09902735]
mat_Sqrt:  [[11.1663745   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00696512 -0.00427755 -0.15940395]
Stock Position:  0.006965119485781782
Bond Position:  [0.60724057]


portfolio before change:  [1.30740543]
curr_Stock_Price:  100.51355884794891
curr_Factors:  [100.51355885  -1.15847642  -1.0990602 ]
mat_Sqrt:  [[10.51450801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00745567 -0.03566239 -0.17561868]
Stock Position:  0.007455672323878872
Bond Position:  [0.55800927]


portfolio before change:  [1.30407808]
curr_Stock_Price:  100.05791850282118
curr_Factors:  [100.0579185   -1.1828792   -1.10640478]
mat_Sqrt:  [[10.13976906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367153  0.02385916  0.14002582]
Stock Position:  -0.0036715278089675743
Bond Position:  [1.67144351]


portfolio before change:  [1.30372069]
curr_Stock_Price:  100.21216827409286
curr_Factors:  [100.21216827  -1.10630008  -1.1279962 ]
mat_Sqrt:  [[10.72946125  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04171237 -0.08228781  0.36109427]
Stock Position:  -0.04171237080369671
Bond Position:  [5.48380781]


portfolio before change:  [1.33872998]
curr_Stock_Price:  99.38930026767251
curr_Factors:  [99.38930027 -1.02557005 -1.11291128]
mat_Sqrt:  [[11.71140472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01306324  0.00309837 -0.08119685]
Stock Position:  -0.013063242898137673
Bond Position:  [2.63707655]


portfolio before change:  [1.34890566]
curr_Stock_Price:  98.63558051692725
curr_Factors:  [98.63558052 -1.06157689 -1.09682739]
mat_Sqrt:  [[11.3933264   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04344417 0.44246685 1.55206785]
Stock Position:  0.0434441741840204
Bond Position:  [-2.93623568]


portfolio before change:  [1.3566206]
curr_Stock_Price:  98.82161227379711
curr_Factors:  [98.82161227 -1.48397203 -1.12276479]
mat_Sqrt:  [[ 7.29055379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01220547 -0.00190331  0.32490377]
Stock Position:  -0.012205472202679188
Bond Position:  [2.56278505]


portfolio before change:  [1.3558488]
curr_Stock_Price:  98.91109415135507
curr_Factors:  [98.91109415 -1.28626701 -1.12479449]
mat_Sqrt:  [[ 8.874304    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01072298  0.05916769 -0.10048896]
Stock Position:  -0.010722977390348108
Bond Position:  [2.41647023]


portfolio before change:  [1.3529497]
curr_Stock_Price:  99.20962884222742
curr_Factors:  [99.20962884 -1.01245481 -1.14314977]
mat_Sqrt:  [[11.4917627   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00126163 0.00699032 0.02786971]
Stock Position:  0.0012616309776345399
Bond Position:  [1.22778376]


portfolio before change:  [1.35303738]
curr_Stock_Price:  99.15747044534251
curr_Factors:  [99.15747045 -1.19926922 -1.16534034]
mat_Sqrt:  [[ 9.31941298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084438 -0.00859751 -0.02059159]
Stock Position:  0.0008443753413760028
Bond Position:  [1.26931126]


portfolio before change:  [1.35311729]
curr_Stock_Price:  99.06419309454839
curr_Factors:  [99.06419309 -1.2564335  -1.13173026]
mat_Sqrt:  [[ 9.09390391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00578727 0.03193661 0.31483327]
Stock Position:  0.005787267305138575
Bond Position:  [0.77980633]


portfolio before change:  [1.34911062]
curr_Stock_Price:  98.3550241362384
curr_Factors:  [98.35502414 -1.15671768 -1.14139904]
mat_Sqrt:  [[ 9.87954942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01020943  0.00807922 -0.0858389 ]
Stock Position:  -0.01020943255004406
Bond Position:  [2.35325961]


portfolio before change:  [1.35603444]
curr_Stock_Price:  97.70565982131474
curr_Factors:  [97.70565982 -1.06940958 -1.14529951]
mat_Sqrt:  [[10.66801903  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00916214 -0.01929882 -0.13758509]
Stock Position:  0.009162142365695182
Bond Position:  [0.46084127]


portfolio before change:  [1.35769289]
curr_Stock_Price:  97.88038310883354
curr_Factors:  [97.88038311 -1.1092716  -1.1410346 ]
mat_Sqrt:  [[10.31335801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0044547  -0.02125978  0.23398527]
Stock Position:  0.0044547040512810596
Bond Position:  [0.92166475]


portfolio before change:  [1.35527209]
curr_Stock_Price:  97.31109466027195
curr_Factors:  [97.31109466 -1.1396633  -1.12922597]
mat_Sqrt:  [[10.06459422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031115   0.01328814  0.13436143]
Stock Position:  -0.0031114979531914116
Bond Position:  [1.65805536]


portfolio before change:  [1.35363671]
curr_Stock_Price:  97.90330187281769
curr_Factors:  [97.90330187 -1.12032069 -1.12245667]
mat_Sqrt:  [[10.39373184  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05763127  0.02366911 -1.73534345]
Stock Position:  -0.05763127442542163
Bond Position:  [6.99592877]


portfolio before change:  [1.34018143]
curr_Stock_Price:  98.15194849286578
curr_Factors:  [98.15194849 -1.02835555 -1.13632567]
mat_Sqrt:  [[11.2665206   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00055689 -0.03736268 -0.16697788]
Stock Position:  0.0005568933502263155
Bond Position:  [1.28552127]


portfolio before change:  [1.34053811]
curr_Stock_Price:  98.50385307426008
curr_Factors:  [98.50385307 -0.97647074 -1.13548465]
mat_Sqrt:  [[11.91907759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.29808824e-04 2.10041098e-02 4.05428141e-01]
Stock Position:  0.0003298088241936789
Bond Position:  [1.30805067]


portfolio before change:  [1.34072487]
curr_Stock_Price:  98.57434072955354
curr_Factors:  [98.57434073 -0.87363465 -1.11393716]
mat_Sqrt:  [[13.50742021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00142984  0.02519552 -0.00807454]
Stock Position:  0.0014298392854039453
Bond Position:  [1.19977941]


portfolio before change:  [1.34088332]
curr_Stock_Price:  98.58026112743434
curr_Factors:  [98.58026113 -0.86896955 -1.08629011]
mat_Sqrt:  [[13.95183976  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01105949 -0.00315584 -0.41397783]
Stock Position:  -0.011059486661051394
Bond Position:  [2.4311304]


portfolio before change:  [1.3433883]
curr_Stock_Price:  98.38124039555254
curr_Factors:  [98.3812404  -0.83748231 -1.0727591 ]
mat_Sqrt:  [[14.56481558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266795  0.02671597  0.29124515]
Stock Position:  -0.0026679521572919624
Bond Position:  [1.60586474]


portfolio before change:  [1.34396364]
curr_Stock_Price:  98.24083273175532
curr_Factors:  [98.24083273 -0.61600714 -1.08461016]
mat_Sqrt:  [[17.93590616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207063  0.01380652  0.29580527]
Stock Position:  -0.0020706287031705653
Bond Position:  [1.54738393]


portfolio before change:  [1.34364358]
curr_Stock_Price:  98.488824231258
curr_Factors:  [98.48882423 -0.64075128 -1.10022013]
mat_Sqrt:  [[17.27001357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00117078 -0.01174466  0.14137766]
Stock Position:  -0.0011707811979433157
Bond Position:  [1.45895244]


portfolio before change:  [1.34612141]
curr_Stock_Price:  96.52821323915975
curr_Factors:  [96.52821324 -0.9029221  -1.07144289]
mat_Sqrt:  [[13.40288983  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00773633 0.02518113 0.05750652]
Stock Position:  0.007736326003213473
Bond Position:  [0.59934768]


portfolio before change:  [1.34040925]
curr_Stock_Price:  95.78017303175434
curr_Factors:  [95.78017303 -1.0213859  -1.09740696]
mat_Sqrt:  [[11.51053663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01093568  0.05597785  0.0025798 ]
Stock Position:  -0.010935678783708068
Bond Position:  [2.38783045]


portfolio before change:  [1.34506229]
curr_Stock_Price:  95.38197644001116
curr_Factors:  [95.38197644 -0.83556235 -1.08411768]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.34506229]
Stock Price:  96.40156285853604
PL:  [1.34506229]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-4.61828212e-02  2.73345624e-01  5.30000482e-01]
 [-1.00155544e-01  3.69031429e-02  8.49399741e-02]
 [ 2.45849663e-01  3.47396888e-01  5.06518640e-01]
 [-2.86767024e-03  3.94938119e-02  1.31442824e-01]
 [-5.89050325e-01 -1.80004345e-01  3.82587136e-02]
 [ 1.29581321e-03 -1.06854135e-01 -1.30307586e-01]
 [ 3.55025316e-02 -7.00446097e-02 -2.11250140e-02]
 [ 9.82342074e-02  2.91661522e-01 -2.60477124e-02]
 [-1.74905559e-01  7.11509676e-03 -6.10792845e-02]
 [ 4.63496343e-02 -1.55111683e-02 -4.05708209e-02]
 [ 1.28742720e-02 -2.90420573e-01  1.68920497e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.45381693e-01 -6.56953049e-02  2.78830114e-01]
 [ 7.52197253e-02  9.40066080e-02  5.18335183e-02]
 [ 6.50071091e-02 -1.05664529e-01 -6.18112942e-02]
 [-4.92383855e-02  3.82005392e-02  3.78595503e-02]
 [-5.05331649e-01 -2.77243507e-01  1.43048822e-01]
 [-1.56223645e-01  7.80449138e-03 -2.60102460e-02]
 [ 3.57956782e-01  1.39380933e+00  5.94362878e-01]
 [-4.08906518e-02 -1.13838794e-03  6.57413652e-02]
 [-9.04054543e-02  1.09444878e-01 -3.88670970e-02]
 [-1.11273752e-02  3.89226156e-02 -8.84854417e-03]
 [-4.44826369e-02 -2.06135780e-02 -6.03757281e-02]
 [ 9.25072231e-03  3.80761426e-02  1.24083623e-01]
 [-9.81385595e-02  5.02669079e-02 -3.99711419e-02]
 [ 1.12767420e-01 -4.56417884e-02 -2.74876699e-02]
 [ 3.30271879e-02 -6.67214073e-02  9.60334848e-02]
 [-2.51860795e-02  4.26682453e-02  3.13946799e-02]
 [-5.59530830e-01  5.89816234e-02 -7.40267868e-01]
 [-6.86003270e-02 -1.21813206e-01 -2.83509101e-03]
 [-9.02798921e-02  9.22946337e-02  2.11615573e-01]
 [ 1.64614627e-02  7.50647505e-02 -7.79206145e-04]
 [-1.19637966e-01 -8.18438798e-03 -1.48826773e-01]
 [-6.14558857e-02  9.46235096e-02  1.08524776e-01]
 [ 6.38544239e-03 -1.68797943e-02  4.38899172e-02]
 [-4.48917987e-03 -1.32542445e-03  7.06351125e-02]
 [ 1.46395318e-03  1.21773838e-03 -4.64788807e-02]
 [-5.16263097e-02  9.09961375e-02 -7.20138824e-03]
 [-7.28650724e-02 -2.42408153e-01  9.14823629e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.86419825]
curr_Stock_Price:  98.29293533253738
curr_Factors:  [98.29293533 -0.67709898 -0.99637057]
mat_Sqrt:  [[18.43926954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00374531 0.08643948 1.51194385]
Stock Position:  0.0037453125576698697
Bond Position:  [-10.23233601]


portfolio before change:  [-9.86463963]
curr_Stock_Price:  98.51661216587593
curr_Factors:  [98.51661217 -0.5839463  -1.00100479]
mat_Sqrt:  [[20.19174985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00405435  0.0116698   0.2423101 ]
Stock Position:  -0.004054349402835332
Bond Position:  [-9.46521886]


portfolio before change:  [-9.86673726]
curr_Stock_Price:  98.74215020848145
curr_Factors:  [98.74215021 -0.82213133 -0.99420499]
mat_Sqrt:  [[16.05749284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0223081  0.10985654 1.44495669]
Stock Position:  0.0223080962899861
Bond Position:  [-12.06948666]


portfolio before change:  [-9.84301711]
curr_Stock_Price:  99.87308171672578
curr_Factors:  [99.87308172 -0.70442443 -1.01562018]
mat_Sqrt:  [[17.88309036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.001397   0.01248904 0.37496979]
Stock Position:  0.0013970018143112592
Bond Position:  [-9.98253999]


portfolio before change:  [-9.84479952]
curr_Stock_Price:  99.49047333288189
curr_Factors:  [99.49047333 -0.95793783 -0.98792395]
mat_Sqrt:  [[14.21361212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04122024 -0.05692237  0.10914146]
Stock Position:  -0.04122023907682331
Bond Position:  [-5.74377842]


portfolio before change:  [-9.84519209]
curr_Stock_Price:  99.48257800784054
curr_Factors:  [99.48257801 -0.91979766 -0.97461047]
mat_Sqrt:  [[14.96290901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187544 -0.03379024 -0.37173127]
Stock Position:  -0.0018754423531839085
Bond Position:  [-9.65861824]


portfolio before change:  [-9.84608927]
curr_Stock_Price:  99.3171702134787
curr_Factors:  [99.31717021 -0.74039231 -0.94245714]
mat_Sqrt:  [[18.45746715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00159187 -0.02215005 -0.06026378]
Stock Position:  0.001591868584324797
Bond Position:  [-10.00418916]


portfolio before change:  [-9.85071393]
curr_Stock_Price:  97.19761534535492
curr_Factors:  [97.19761535 -0.6555157  -0.95814041]
mat_Sqrt:  [[19.35769604  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00518904  0.09223147 -0.07430687]
Stock Position:  0.0051890425514446205
Bond Position:  [-10.35507649]


portfolio before change:  [-9.84817879]
curr_Stock_Price:  97.9356328586732
curr_Factors:  [97.93563286 -0.45287505 -0.96564325]
mat_Sqrt:  [[23.70751663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00789579  0.00224999 -0.1742422 ]
Stock Position:  -0.00789579136357608
Bond Position:  [-9.07489947]


portfolio before change:  [-9.87763525]
curr_Stock_Price:  101.52261069553026
curr_Factors:  [101.5226107   -0.50425084  -0.97622718]
mat_Sqrt:  [[23.09932801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00163068 -0.00490506 -0.11573726]
Stock Position:  0.0016306817903525342
Bond Position:  [-10.04318633]


portfolio before change:  [-9.87671542]
curr_Stock_Price:  102.85659702248472
curr_Factors:  [102.85659702  -0.59256461  -1.01372646]
mat_Sqrt:  [[20.63615608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193139 -0.09183905  0.48188316]
Stock Position:  0.0019313866836107383
Bond Position:  [-10.07537128]


portfolio before change:  [-9.88048142]
curr_Stock_Price:  101.55882645897633
curr_Factors:  [101.55882646  -0.74712068  -1.0093877 ]
mat_Sqrt:  [[17.53378896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00411352  0.00225658  0.15019092]
Stock Position:  -0.004113521541853238
Bond Position:  [-9.462717]


portfolio before change:  [-9.87771185]
curr_Stock_Price:  100.59797404707679
curr_Factors:  [100.59797405  -0.68882232  -1.01046603]
mat_Sqrt:  [[18.39067553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01090778 -0.02077468  0.7954247 ]
Stock Position:  0.010907778031829438
Bond Position:  [-10.97501222]


portfolio before change:  [-9.87713472]
curr_Stock_Price:  100.77666173192384
curr_Factors:  [100.77666173  -0.99673069  -1.03418348]
mat_Sqrt:  [[13.22346134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00667204 0.0297275  0.1478666 ]
Stock Position:  0.006672038117493131
Bond Position:  [-10.54952045]


portfolio before change:  [-9.88617042]
curr_Stock_Price:  99.62005453333303
curr_Factors:  [99.62005453 -1.16542601 -1.0277822 ]
mat_Sqrt:  [[11.11344111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00446861 -0.03341406 -0.17633042]
Stock Position:  0.004468614587754261
Bond Position:  [-10.33133405]


portfolio before change:  [-9.88782682]
curr_Stock_Price:  99.53839565307602
curr_Factors:  [99.53839565 -1.30018952 -1.00964437]
mat_Sqrt:  [[ 9.88194708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00410081  0.01208007  0.10800276]
Stock Position:  -0.004100811621030135
Bond Position:  [-9.47963861]


portfolio before change:  [-9.89091836]
curr_Stock_Price:  100.00330542565679
curr_Factors:  [100.00330543  -1.40115415  -0.98839849]
mat_Sqrt:  [[ 9.16737147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05271853 -0.08767209  0.40807847]
Stock Position:  -0.0527185276717552
Bond Position:  [-4.61889133]


portfolio before change:  [-9.86891745]
curr_Stock_Price:  99.57502517854459
curr_Factors:  [99.57502518 -1.21710223 -1.00017191]
mat_Sqrt:  [[10.84427439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01487711  0.002468   -0.07419999]
Stock Position:  -0.014877109058317838
Bond Position:  [-8.38752894]


portfolio before change:  [-9.88022752]
curr_Stock_Price:  100.2647801501201
curr_Factors:  [100.26478015  -1.33822762  -1.03780565]
mat_Sqrt:  [[ 9.31644592  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05530742 0.44076121 1.69555185]
Stock Position:  0.055307421141963374
Bond Position:  [-15.42561394]


portfolio before change:  [-9.89502498]
curr_Stock_Price:  100.03209636785651
curr_Factors:  [100.03209637  -1.2534344   -1.04269282]
mat_Sqrt:  [[10.06801814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273149 -0.00035999  0.18754182]
Stock Position:  -0.0027314854338027577
Bond Position:  [-9.62178877]


portfolio before change:  [-9.89604809]
curr_Stock_Price:  99.96631238162274
curr_Factors:  [99.96631238 -1.1864074  -1.02211217]
mat_Sqrt:  [[10.98261616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00869677  0.03460951 -0.11087701]
Stock Position:  -0.008696772351910752
Bond Position:  [-9.02666383]


portfolio before change:  [-9.89942613]
curr_Stock_Price:  100.22498750249277
curr_Factors:  [100.2249875   -1.05441804  -1.01492462]
mat_Sqrt:  [[12.65528446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094258  0.01230841 -0.02524243]
Stock Position:  -0.0009425785054827935
Bond Position:  [-9.80495621]


portfolio before change:  [-9.89870743]
curr_Stock_Price:  98.16213294219415
curr_Factors:  [98.16213294 -1.04726375 -1.00468585]
mat_Sqrt:  [[12.61227988  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454629 -0.00651859 -0.17223515]
Stock Position:  -0.004546285173743127
Bond Position:  [-9.45243438]


portfolio before change:  [-9.89993363]
curr_Stock_Price:  98.17193756272025
curr_Factors:  [98.17193756 -1.18699465 -1.02433106]
mat_Sqrt:  [[10.75525739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0033065  0.01204073 0.35397604]
Stock Position:  0.0033065045534618515
Bond Position:  [-10.22453959]


portfolio before change:  [-9.90142211]
curr_Stock_Price:  98.10832590808428
curr_Factors:  [98.10832591 -1.04769936 -1.0256699 ]
mat_Sqrt:  [[12.33823504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00851011  0.01589579 -0.11402654]
Stock Position:  -0.008510110918474367
Bond Position:  [-9.06650937]


portfolio before change:  [-9.90357]
curr_Stock_Price:  98.22753778413652
curr_Factors:  [98.22753778 -1.1573846  -1.00339033]
mat_Sqrt:  [[11.31932768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00936258 -0.0144332  -0.07841467]
Stock Position:  0.009362575275559764
Bond Position:  [-10.82323272]


portfolio before change:  [-9.91026121]
curr_Stock_Price:  97.65737161434016
curr_Factors:  [97.65737161 -1.07188008 -1.00670166]
mat_Sqrt:  [[12.2176717   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00416669 -0.02109916  0.2739568 ]
Stock Position:  0.004166685994860365
Bond Position:  [-10.31716881]


portfolio before change:  [-9.91096738]
curr_Stock_Price:  97.79742620671742
curr_Factors:  [97.79742621 -1.01424814 -0.99029917]
mat_Sqrt:  [[13.17539328  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134159  0.01349288  0.08956028]
Stock Position:  -0.0013415901546482108
Bond Position:  [-9.77976331]


portfolio before change:  [-9.91298979]
curr_Stock_Price:  98.39363730902437
curr_Factors:  [98.39363731 -1.01595983 -1.00752216]
mat_Sqrt:  [[13.00708427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05451756  0.01865163 -2.11177818]
Stock Position:  -0.05451755842074477
Bond Position:  [-4.54880892]


portfolio before change:  [-9.9716337]
curr_Stock_Price:  99.45889533846184
curr_Factors:  [99.45889534 -1.04412223 -1.03064357]
mat_Sqrt:  [[12.49062847  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00579028 -0.03852072 -0.00808773]
Stock Position:  -0.0057902803852747
Bond Position:  [-9.39573881]


portfolio before change:  [-9.9742714]
curr_Stock_Price:  99.71158792036897
curr_Factors:  [99.71158792 -0.79113976 -1.03253508]
mat_Sqrt:  [[16.09658374  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277705  0.02918613  0.60368033]
Stock Position:  -0.00277704932205762
Bond Position:  [-9.6973674]


portfolio before change:  [-9.97487126]
curr_Stock_Price:  99.49106983423228
curr_Factors:  [99.49106983 -0.85453143 -1.0310213 ]
mat_Sqrt:  [[15.09728865  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012082   0.02373756 -0.00222286]
Stock Position:  0.0012082018060449813
Bond Position:  [-10.09507655]


portfolio before change:  [-9.97734332]
curr_Stock_Price:  98.48950163283205
curr_Factors:  [98.48950163 -0.88196229 -1.04299952]
mat_Sqrt:  [[14.36777933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01045593 -0.00258813 -0.42456136]
Stock Position:  -0.010455925069528204
Bond Position:  [-8.94754447]


portfolio before change:  [-9.97648663]
curr_Stock_Price:  98.30059477397576
curr_Factors:  [98.30059477 -0.89127099 -1.032362  ]
mat_Sqrt:  [[14.35928951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00256699  0.02992258  0.30959098]
Stock Position:  -0.002566992614434106
Bond Position:  [-9.72414973]


portfolio before change:  [-9.9794224]
curr_Stock_Price:  98.97070577206641
curr_Factors:  [98.97070577 -0.65721421 -1.02370677]
mat_Sqrt:  [[18.42858384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00080899 -0.00533786  0.12520572]
Stock Position:  0.0008089932438915304
Bond Position:  [-10.05948903]


portfolio before change:  [-9.98005436]
curr_Stock_Price:  99.74395221304944
curr_Factors:  [99.74395221 -0.37089381 -1.03534274]
mat_Sqrt:  [[24.44363552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040481 -0.00041914  0.20150231]
Stock Position:  0.00040480597775648824
Bond Position:  [-10.02043131]


portfolio before change:  [-9.98070972]
curr_Stock_Price:  101.21941179922365
curr_Factors:  [101.2194118   -0.41234561  -1.03380673]
mat_Sqrt:  [[23.83459784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033531  0.00038508 -0.13259131]
Stock Position:  -0.0003353136810956094
Bond Position:  [-9.94676946]


portfolio before change:  [-9.98259695]
curr_Stock_Price:  103.13942753851384
curr_Factors:  [103.13942754  -0.63856157  -1.04215079]
mat_Sqrt:  [[19.20881675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264185  0.02877551 -0.02054356]
Stock Position:  -0.002641848137763718
Bond Position:  [-9.71011824]


portfolio before change:  [-9.98403151]
curr_Stock_Price:  103.22297490074207
curr_Factors:  [103.2229749   -0.62411269  -1.0832406 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.98403151]
Stock Price:  103.33000761611756
PL:  [-13.31403913]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.14131379e-01  1.40357875e-02  1.50547824e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 3.51522620e-01  2.45405351e-01  2.81548202e-01]
 [ 1.37436376e-02  5.35649521e-02  1.43488043e-01]
 [-9.79092125e-01 -2.90488247e-01  2.87270939e-02]
 [-5.81200918e-02  7.11468298e-03  4.25275465e-02]
 [ 1.20068008e-02  1.37210037e-01  5.50344916e-02]
 [ 3.44351012e-01 -2.94973209e-02 -8.66088680e-02]
 [-5.44163566e-01 -3.04607145e-02 -6.71446586e-02]
 [ 1.62422149e-02  3.56381004e-02 -1.66025784e-02]
 [-8.85649279e-03 -2.35348210e-01  1.37073684e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.52020752e-01 -6.36900519e-02  3.06113933e-01]
 [ 2.30231999e-02  3.68760849e-01  3.19623052e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-1.16344689e-02 -1.80422821e-02  3.45655256e-02]
 [-6.20852697e-01 -3.00382200e-01  1.89294482e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 3.22150164e-01  1.20954749e+00  5.61013261e-01]
 [ 4.17742597e-03  1.68932682e-02  2.97399360e-02]
 [-1.84256925e-02 -9.34966393e-02  9.11539302e-04]
 [-2.21988059e-03  4.77063116e-02 -1.41304699e-02]
 [ 1.01383601e-01 -3.14584872e-02  1.20578244e-01]
 [ 7.85932475e-02 -5.22006530e-02 -4.08308133e-02]
 [-6.91502058e-02 -8.52081464e-02  1.27890546e-01]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [-2.17074707e-01  4.62150603e-02  1.79696660e-01]
 [ 1.39280416e-02  5.03264437e-02 -6.69997299e-02]
 [-6.00256298e-01  8.66774394e-03 -8.47049309e-01]
 [-2.63373096e-01  1.30863825e-01 -2.39035882e-02]
 [-8.83822401e-02  4.85209255e-02  1.13693546e-01]
 [ 6.53922768e-03  2.73001962e-03  3.41156435e-02]
 [-1.29959084e-01 -1.70602599e-03 -1.37483457e-01]
 [-5.43712814e-02 -2.34814386e-01 -9.34696783e-02]
 [ 2.24706708e-01 -1.73088175e-01 -7.32786874e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-5.02442026e-02 -5.46301223e-02 -5.01504134e-02]
 [-9.98635088e-02 -2.20602861e-02  2.46882558e-03]
 [-3.52314353e-02 -2.35532242e-01  1.20021584e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.85055995]
curr_Stock_Price:  99.78582222591521
curr_Factors:  [99.78582223 -0.86854586 -1.00565883]
mat_Sqrt:  [[15.31482664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01195172  0.00443851  0.42947104]
Stock Position:  -0.011951720673484519
Bond Position:  [2.04317223]


portfolio before change:  [0.84924535]
curr_Stock_Price:  99.91718513119454
curr_Factors:  [99.91718513 -0.61898876 -0.96870865]
mat_Sqrt:  [[20.42264383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00222209  0.01411938  0.0859571 ]
Stock Position:  -0.00222209441776588
Bond Position:  [1.07127077]


portfolio before change:  [0.84781582]
curr_Stock_Price:  100.62077889748026
curr_Factors:  [100.6207789   -0.68209281  -0.92591586]
mat_Sqrt:  [[20.15293853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02060889 0.07760399 0.80317865]
Stock Position:  0.02060889255904793
Bond Position:  [-1.225867]


portfolio before change:  [0.82438041]
curr_Stock_Price:  99.49106416844404
curr_Factors:  [99.49106417 -0.68893127 -0.90408926]
mat_Sqrt:  [[20.22758571  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00219582 0.01693873 0.40933145]
Stock Position:  0.0021958158263772325
Bond Position:  [0.60591635]


portfolio before change:  [0.82782981]
curr_Stock_Price:  101.0274663873738
curr_Factors:  [101.02746639  -1.11230271  -0.9264244 ]
mat_Sqrt:  [[13.15320306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07456196 -0.09186045  0.0819504 ]
Stock Position:  -0.07456196044515419
Bond Position:  [8.36063576]


portfolio before change:  [0.82460167]
curr_Stock_Price:  101.0847781973045
curr_Factors:  [101.0847782   -1.23336017  -0.94208615]
mat_Sqrt:  [[11.47893063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429095  0.00224986  0.12131925]
Stock Position:  -0.004290947823699555
Bond Position:  [1.25835118]


portfolio before change:  [0.82160766]
curr_Stock_Price:  101.81918912078352
curr_Factors:  [101.81918912  -1.24891002  -0.92014143]
mat_Sqrt:  [[11.63650495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00230167 0.04338962 0.15699809]
Stock Position:  0.0023016719695562087
Bond Position:  [0.58725328]


portfolio before change:  [0.82176776]
curr_Stock_Price:  101.85685311791637
curr_Factors:  [101.85685312  -1.17491749  -0.92813526]
mat_Sqrt:  [[12.43500755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02620911 -0.00932787 -0.24707099]
Stock Position:  0.026209106172509072
Bond Position:  [-1.84780932]


portfolio before change:  [0.83723957]
curr_Stock_Price:  102.45598852812954
curr_Factors:  [102.45598853  -1.39249618  -0.93179736]
mat_Sqrt:  [[10.0255796   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05572305 -0.00963252 -0.19154502]
Stock Position:  -0.05572305305578403
Bond Position:  [6.54640005]


portfolio before change:  [0.85720472]
curr_Stock_Price:  102.11238203998425
curr_Factors:  [102.11238204  -1.39566496  -0.90560767]
mat_Sqrt:  [[10.22464892  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00134708  0.01126976 -0.04736254]
Stock Position:  0.0013470779925441798
Bond Position:  [0.71965138]


portfolio before change:  [0.85736658]
curr_Stock_Price:  102.16575617527374
curr_Factors:  [102.16575618  -1.15324381  -0.91334208]
mat_Sqrt:  [[12.93595528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00100858 -0.07442364  0.39103307]
Stock Position:  0.001008575776447591
Bond Position:  [0.75432468]


portfolio before change:  [0.85687756]
curr_Stock_Price:  101.58739028383683
curr_Factors:  [101.58739028  -1.50839626  -0.89899936]
mat_Sqrt:  [[ 9.14789497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0078844   0.00225658  0.15019092]
Stock Position:  -0.007884395131880098
Bond Position:  [1.65783268]


portfolio before change:  [0.85632024]
curr_Stock_Price:  101.6843611790451
curr_Factors:  [101.68436118  -1.58304472  -0.90909929]
mat_Sqrt:  [[ 8.41259094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02530273 -0.02014056  0.87325784]
Stock Position:  0.025302731138971253
Bond Position:  [-1.71657181]


portfolio before change:  [0.86014066]
curr_Stock_Price:  101.84383020072937
curr_Factors:  [101.8438302   -1.77517578  -0.91463464]
mat_Sqrt:  [[ 6.91456558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01414223 0.11661242 0.9117956 ]
Stock Position:  0.014142225602162039
Bond Position:  [-0.58015777]


portfolio before change:  [0.86065332]
curr_Stock_Price:  101.88520864985901
curr_Factors:  [101.88520865  -1.86924975  -0.89161369]
mat_Sqrt:  [[ 6.44292955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00666252 -0.03587186 -0.12433753]
Stock Position:  0.006662517921076969
Bond Position:  [0.18184129]


portfolio before change:  [0.86260468]
curr_Stock_Price:  102.17468324862395
curr_Factors:  [102.17468325  -2.04662023  -0.89258108]
mat_Sqrt:  [[ 5.405855    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093318 -0.00570547  0.09860582]
Stock Position:  -0.0009331845316279738
Bond Position:  [0.95795251]


portfolio before change:  [0.86287465]
curr_Stock_Price:  102.01370200181763
curr_Factors:  [102.013702    -1.96286989  -0.89725799]
mat_Sqrt:  [[ 5.84145121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10099698 -0.09498919  0.54000447]
Stock Position:  -0.10099698444404458
Bond Position:  [11.16595093]


portfolio before change:  [0.83222316]
curr_Stock_Price:  102.33101171817802
curr_Factors:  [102.33101172  -1.72792774  -0.89489747]
mat_Sqrt:  [[ 7.42897255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01767554  0.00580111 -0.05715682]
Stock Position:  -0.017675537610696783
Bond Position:  [2.64097881]


portfolio before change:  [0.84495628]
curr_Stock_Price:  101.62930905718207
curr_Factors:  [101.62930906  -1.57306955  -0.87586332]
mat_Sqrt:  [[ 8.77932123  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05329534 0.3824925  1.60041468]
Stock Position:  0.053295338633442366
Bond Position:  [-4.57141217]


portfolio before change:  [0.85802789]
curr_Stock_Price:  101.88529912757653
curr_Factors:  [101.88529913  -1.49174379  -0.85913132]
mat_Sqrt:  [[ 9.70821614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00110054 0.00534212 0.08483976]
Stock Position:  0.001100536611706952
Bond Position:  [0.74589939]


portfolio before change:  [0.85817612]
curr_Stock_Price:  101.93526033334226
curr_Factors:  [101.93526033  -1.62982437  -0.83890283]
mat_Sqrt:  [[ 8.63316093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00239237 -0.02956623  0.00260037]
Stock Position:  -0.0023923680273896905
Bond Position:  [1.10204278]


portfolio before change:  [0.85807847]
curr_Stock_Price:  102.03365986333775
curr_Factors:  [102.03365986  -1.73344572  -0.84056218]
mat_Sqrt:  [[ 7.77796592  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049788  0.01508606 -0.0403103 ]
Stock Position:  -0.0004978781148723683
Bond Position:  [0.9088788]


portfolio before change:  [0.85780379]
curr_Stock_Price:  102.81357102357939
curr_Factors:  [102.81357102  -1.60835601  -0.85204262]
mat_Sqrt:  [[ 8.78037153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01425729 -0.00994805  0.34397617]
Stock Position:  0.01425728710417887
Bond Position:  [-0.60803881]


portfolio before change:  [0.85660368]
curr_Stock_Price:  102.73472731351221
curr_Factors:  [102.73472731  -1.53887813  -0.84348397]
mat_Sqrt:  [[ 9.48572565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00726469 -0.0165073  -0.11647895]
Stock Position:  0.0072646922424045276
Bond Position:  [0.11026751]


portfolio before change:  [0.85537864]
curr_Stock_Price:  102.56420015022908
curr_Factors:  [102.56420015  -1.66127404  -0.85034073]
mat_Sqrt:  [[ 8.32176337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00543692 -0.02694518  0.36483613]
Stock Position:  -0.005436915268372702
Bond Position:  [1.41301151]


portfolio before change:  [0.85505829]
curr_Stock_Price:  102.65561056478975
curr_Factors:  [102.65561056  -1.72649007  -0.84867144]
mat_Sqrt:  [[ 7.8163547   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165756  0.02004328 -0.05140267]
Stock Position:  0.0016575607692717739
Bond Position:  [0.68490037]


portfolio before change:  [0.85552215]
curr_Stock_Price:  102.88380485519822
curr_Factors:  [102.88380486  -1.88831108  -0.88408037]
mat_Sqrt:  [[ 6.43150642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02786299  0.01461449  0.51262455]
Stock Position:  -0.027862992047249353
Bond Position:  [3.72217279]


portfolio before change:  [0.86475741]
curr_Stock_Price:  102.56905189398161
curr_Factors:  [102.56905189  -1.97242693  -0.85556828]
mat_Sqrt:  [[ 6.06503936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00025576  0.01591462 -0.19113158]
Stock Position:  0.00025576127840016573
Bond Position:  [0.83852422]


portfolio before change:  [0.86476211]
curr_Stock_Price:  102.17758923303369
curr_Factors:  [102.17758923  -2.14573005  -0.85872791]
mat_Sqrt:  [[ 5.06449495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.15261852  0.00274098 -2.41639591]
Stock Position:  -0.1526185182385342
Bond Position:  [16.45895438]


portfolio before change:  [0.84772637]
curr_Stock_Price:  102.30269359840756
curr_Factors:  [102.3026936   -2.01658644  -0.8406997 ]
mat_Sqrt:  [[ 5.8746698   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04508739  0.04138277 -0.06819028]
Stock Position:  -0.04508738624057996
Bond Position:  [5.46028743]


portfolio before change:  [0.85441465]
curr_Stock_Price:  102.16949215526301
curr_Factors:  [102.16949216  -2.16045206  -0.81655719]
mat_Sqrt:  [[ 5.20502171  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0122808   0.01534366  0.32433604]
Stock Position:  -0.012280801279970801
Bond Position:  [2.10913788]


portfolio before change:  [0.84891674]
curr_Stock_Price:  102.63864491684285
curr_Factors:  [102.63864492  -2.32972728  -0.80531164]
mat_Sqrt:  [[ 4.46458203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00304027 0.00086331 0.09732243]
Stock Position:  0.003040271847988955
Bond Position:  [0.53686735]


portfolio before change:  [0.84853643]
curr_Stock_Price:  102.49148120680383
curr_Factors:  [102.49148121  -2.04546649  -0.80148415]
mat_Sqrt:  [[ 5.94665594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02658079 -0.00053949 -0.39220204]
Stock Position:  -0.02658079224871038
Bond Position:  [3.5728412]


portfolio before change:  [0.8388187]
curr_Stock_Price:  102.87387640245738
curr_Factors:  [102.8738764   -2.11268625  -0.79274721]
mat_Sqrt:  [[ 5.62977952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01412375 -0.07425483 -0.26664298]
Stock Position:  -0.014123746882056172
Bond Position:  [2.29178329]


portfolio before change:  [0.84404738]
curr_Stock_Price:  102.5239557435957
curr_Factors:  [102.52395574  -2.17614867  -0.78608317]
mat_Sqrt:  [[ 5.30083652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0387259  -0.05473529 -0.2090437 ]
Stock Position:  0.03872589555037826
Bond Position:  [-3.12628462]


portfolio before change:  [0.84259843]
curr_Stock_Price:  102.49663192593876
curr_Factors:  [102.49663193  -2.15291613  -0.7928474 ]
mat_Sqrt:  [[ 5.38741895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00454984 0.00777784 0.21633947]
Stock Position:  0.004549838031088878
Bond Position:  [0.37625536]


portfolio before change:  [0.84329493]
curr_Stock_Price:  102.63937753893559
curr_Factors:  [102.63937754  -2.43660364  -0.79767357]
mat_Sqrt:  [[ 4.04282799  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.015309   -0.01727556 -0.14306517]
Stock Position:  -0.015309000712178576
Bond Position:  [2.41460124]


portfolio before change:  [0.84751581]
curr_Stock_Price:  102.38338250141922
curr_Factors:  [102.3833825   -2.54070707  -0.82380619]
mat_Sqrt:  [[ 3.5402989   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02822619 -0.00697607  0.00704287]
Stock Position:  -0.028226191844690263
Bond Position:  [3.7374088]


portfolio before change:  [0.83982513]
curr_Stock_Price:  102.67240073702841
curr_Factors:  [102.67240074  -2.37348082  -0.82452437]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.83982513]
Stock Price:  102.4527759677437
PL:  [-1.61295084]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.11100436e-02  1.23418896e-01  2.99519691e-02]
 [-2.81828880e-03 -3.47282863e-02 -1.10525355e-01]
 [ 3.78269617e-01 -2.08168333e-01 -4.50929035e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-5.22201849e-01 -1.61068733e-01  3.98923186e-02]
 [ 1.50634538e-02 -1.33262581e-01 -1.70356323e-01]
 [ 3.49551516e-02 -7.96650872e-02 -2.21343202e-02]
 [ 2.23314410e-01  5.91120117e-02 -4.98880411e-02]
 [-3.76853000e-01 -1.20685674e-02 -7.01504630e-02]
 [ 5.46735322e-02 -2.96525759e-02 -4.71974002e-02]
 [ 1.04276634e-01 -2.98547008e-01  1.35744034e-02]
 [-2.03651924e-01 -1.42901331e-01 -3.14374801e-01]
 [ 2.60741420e-01 -3.27293657e-01 -8.04029339e-02]
 [ 2.71662423e-02 -1.21408893e-01 -7.58646395e-02]
 [-1.62025207e-01  2.34496222e-01  1.74145104e-01]
 [ 3.24712122e-02 -3.12597678e-01 -7.72810991e-02]
 [-3.58339512e-01 -2.36772433e-01  8.30248645e-02]
 [-2.15519805e-01 -9.39430643e-02 -3.36069291e-02]
 [ 2.72980839e-01  1.23606983e+00  3.51869292e-01]
 [-2.16089368e-01 -3.73900004e-02  1.55828272e-01]
 [-9.70568990e-02  3.25202196e-01 -2.87502761e-02]
 [ 3.83659079e-02 -1.59376865e-02  3.69246496e-02]
 [-1.05900570e-01  2.49566683e-02 -1.13747819e-01]
 [-1.11815575e-02 -1.13559446e-01  1.12245167e-01]
 [-1.01049929e-01  7.23928252e-02 -4.48066196e-02]
 [ 1.05915740e-01 -9.01175923e-02 -8.69699200e-02]
 [ 3.26298183e-02 -6.68179292e-02  9.33707252e-02]
 [-2.61175380e-04  4.20641927e-02  8.89915787e-03]
 [-5.51219472e-01  8.43983407e-02 -7.03560708e-01]
 [-2.21558918e-02 -1.25733584e-01 -2.87298003e-02]
 [-4.19890879e-02  6.94564124e-02  1.59630860e-01]
 [ 2.39798924e-02  1.23684594e-01 -2.40354550e-02]
 [-1.03466136e-01  3.31863639e-03 -1.64601393e-01]
 [-6.01616543e-02  1.25612155e-01  1.28178021e-01]
 [ 1.72865493e-03 -1.63998024e-02  4.17646223e-02]
 [-2.51820795e-02 -1.66579626e-02  4.37374446e-02]
 [ 2.19682707e-02  8.99670034e-03 -2.15811027e-02]
 [-8.81923645e-02  1.29162190e-02 -6.53128098e-04]
 [-4.63686522e-02 -2.50511927e-01  1.18738084e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.24468164]
curr_Stock_Price:  101.37336481047188
curr_Factors:  [101.37336481  -1.04031464  -1.0053954 ]
mat_Sqrt:  [[13.10639571  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00013806  0.03902848  0.08544463]
Stock Position:  -0.00013805941579981667
Bond Position:  [12.25867718]


portfolio before change:  [12.24610191]
curr_Stock_Price:  102.18577059882047
curr_Factors:  [102.1857706   -0.95354399  -1.0115591 ]
mat_Sqrt:  [[14.3204608   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183485 -0.01098205 -0.31529807]
Stock Position:  -0.0018348475913533859
Bond Position:  [12.43359722]


portfolio before change:  [12.24770346]
curr_Stock_Price:  102.16001433520337
curr_Factors:  [102.16001434  -0.73297512  -1.0241316 ]
mat_Sqrt:  [[17.62703202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01593287 -0.06582861 -1.28637502]
Stock Position:  0.015932871140077614
Bond Position:  [10.62000112]


portfolio before change:  [12.2298891]
curr_Stock_Price:  100.95860241200208
curr_Factors:  [100.95860241  -0.90149803  -1.01342723]
mat_Sqrt:  [[14.87653742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00132444 -0.00659539  0.21422481]
Stock Position:  0.001324438163554138
Bond Position:  [12.09617568]


portfolio before change:  [12.23009737]
curr_Stock_Price:  99.97414338263775
curr_Factors:  [99.97414338 -0.74376013 -0.99319336]
mat_Sqrt:  [[17.60104187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02944244 -0.05093441  0.11380168]
Stock Position:  -0.029442441233111804
Bond Position:  [15.17358021]


portfolio before change:  [12.25862739]
curr_Stock_Price:  99.06955781823822
curr_Factors:  [99.06955782 -0.88546763 -0.98950329]
mat_Sqrt:  [[15.19325058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152378 -0.04214133 -0.48597917]
Stock Position:  -0.0015237825520020899
Bond Position:  [12.40958785]


portfolio before change:  [12.25992327]
curr_Stock_Price:  99.23717616776626
curr_Factors:  [99.23717617 -0.76705855 -1.02466349]
mat_Sqrt:  [[16.54014848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171583 -0.02519231 -0.06314305]
Stock Position:  0.0017158285304255281
Bond Position:  [12.08964929]


portfolio before change:  [12.26168837]
curr_Stock_Price:  99.3850912351296
curr_Factors:  [99.38509124 -0.82966462 -1.00963532]
mat_Sqrt:  [[15.79513806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01359009  0.01869286 -0.1423167 ]
Stock Position:  0.013590088367564389
Bond Position:  [10.9110362]


portfolio before change:  [12.26565336]
curr_Stock_Price:  99.57648251926898
curr_Factors:  [99.57648252 -0.72315319 -1.01476158]
mat_Sqrt:  [[17.51418718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02235239 -0.00381642 -0.20011974]
Stock Position:  -0.022352394022296638
Bond Position:  [14.49142613]


portfolio before change:  [12.25409374]
curr_Stock_Price:  100.17468061691072
curr_Factors:  [100.17468062  -0.65890369  -0.97983974]
mat_Sqrt:  [[19.45632168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227555 -0.00937697 -0.13464105]
Stock Position:  0.0022755471342213673
Bond Position:  [12.02614153]


portfolio before change:  [12.25128015]
curr_Stock_Price:  98.27757411160212
curr_Factors:  [98.27757411 -0.60146348 -1.00747154]
mat_Sqrt:  [[19.66540194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00505146 -0.09440885  0.03872399]
Stock Position:  0.0050514628333312266
Bond Position:  [11.75483463]


portfolio before change:  [12.2410942]
curr_Stock_Price:  95.97024509121566
curr_Factors:  [95.97024509 -0.45901869 -0.990754  ]
mat_Sqrt:  [[22.51688593  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0120582  -0.04518937 -0.8968238 ]
Stock Position:  -0.01205819972829601
Bond Position:  [13.39832259]


portfolio before change:  [12.23573222]
curr_Stock_Price:  96.5538215627824
curr_Factors:  [96.55382156 -0.41257156 -0.96478444]
mat_Sqrt:  [[24.35518061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00968494 -0.10349934 -0.22936719]
Stock Position:  0.009684943728529596
Bond Position:  [11.30061389]


portfolio before change:  [12.23075634]
curr_Stock_Price:  95.89418542906732
curr_Factors:  [95.89418543 -0.48438192 -0.96144233]
mat_Sqrt:  [[22.58805205  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00037833 -0.03839286 -0.2164207 ]
Stock Position:  0.0003783271560354792
Bond Position:  [12.19447697]


portfolio before change:  [12.23259553]
curr_Stock_Price:  96.72621218202613
curr_Factors:  [96.72621218 -0.67762448 -0.96567225]
mat_Sqrt:  [[18.70120015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00643934  0.07415422  0.49678751]
Stock Position:  -0.006439336477846471
Bond Position:  [12.85544815]


portfolio before change:  [12.2314042]
curr_Stock_Price:  97.16078496552288
curr_Factors:  [97.16078497 -0.66737459 -0.95491733]
mat_Sqrt:  [[19.18397435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004496  -0.09885207 -0.22046146]
Stock Position:  0.0004495959180407974
Bond Position:  [12.18772111]


portfolio before change:  [12.23355565]
curr_Stock_Price:  98.55734989744165
curr_Factors:  [98.5573499  -0.42659283 -0.97018913]
mat_Sqrt:  [[24.38228031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01425238 -0.07487402  0.23684683]
Stock Position:  -0.014252381876916827
Bond Position:  [13.63823264]


portfolio before change:  [12.22904712]
curr_Stock_Price:  98.99330582473458
curr_Factors:  [98.99330582 -0.58188093 -0.9616933 ]
mat_Sqrt:  [[21.14657595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01063082 -0.02970741 -0.09587121]
Stock Position:  -0.010630817541253713
Bond Position:  [13.2814269]


portfolio before change:  [12.22795064]
curr_Stock_Price:  99.25262467011936
curr_Factors:  [99.25262467 -0.5278719  -0.96643707]
mat_Sqrt:  [[22.27264836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01691407 0.3908796  1.00378515]
Stock Position:  0.016914065929373657
Bond Position:  [10.5491852]


portfolio before change:  [12.22787587]
curr_Stock_Price:  99.17023803675069
curr_Factors:  [99.17023804 -0.50131755 -0.92834362]
mat_Sqrt:  [[23.74036539  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00780302 -0.01182376  0.44453469]
Stock Position:  -0.007803016410999112
Bond Position:  [13.00170287]


portfolio before change:  [12.22921687]
curr_Stock_Price:  99.20667437662678
curr_Factors:  [99.20667438 -0.5377917  -0.91799927]
mat_Sqrt:  [[23.13656622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00408569  0.10283796 -0.08201654]
Stock Position:  -0.004085690117991453
Bond Position:  [12.6345446]


portfolio before change:  [12.24078289]
curr_Stock_Price:  96.76238777105957
curr_Factors:  [96.76238777 -0.52917543 -0.90236751]
mat_Sqrt:  [[23.12040183  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0019676  -0.00503994  0.10533575]
Stock Position:  0.001967596043667524
Bond Position:  [12.0503936]


portfolio before change:  [12.24048389]
curr_Stock_Price:  95.84482574585694
curr_Factors:  [95.84482575 -0.5692992  -0.87189869]
mat_Sqrt:  [[22.68111392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0056644   0.00789199 -0.32449087]
Stock Position:  -0.005664398496584803
Bond Position:  [12.78338718]


portfolio before change:  [12.23422839]
curr_Stock_Price:  97.23129673852664
curr_Factors:  [97.23129674 -0.74206256 -0.8941678 ]
mat_Sqrt:  [[18.93216409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00046473 -0.03591065  0.32020422]
Stock Position:  0.00046472759164503354
Bond Position:  [12.18904232]


portfolio before change:  [12.23578247]
curr_Stock_Price:  97.29661750886456
curr_Factors:  [97.29661751 -0.99171106 -0.89188445]
mat_Sqrt:  [[14.79321631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00732274  0.02289262 -0.12782081]
Stock Position:  -0.007322739377234147
Bond Position:  [12.94826024]


portfolio before change:  [12.23927678]
curr_Stock_Price:  97.0404733963406
curr_Factors:  [97.0404734  -1.29329026 -0.90230119]
mat_Sqrt:  [[10.799898    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00794788 -0.02849768 -0.24810097]
Stock Position:  0.007947876246357856
Bond Position:  [11.46801111]


portfolio before change:  [12.2457174]
curr_Stock_Price:  97.6704570968264
curr_Factors:  [97.6704571  -1.01970394 -0.90338379]
mat_Sqrt:  [[14.27502347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00350009 -0.02112968  0.26636069]
Stock Position:  0.0035000857537595713
Bond Position:  [11.90386243]


portfolio before change:  [12.25038689]
curr_Stock_Price:  98.57940901458822
curr_Factors:  [98.57940901 -1.29839217 -0.93258061]
mat_Sqrt:  [[10.58978256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00024943 0.01330187 0.02538682]
Stock Position:  0.00024943386533613355
Bond Position:  [12.22579785]


portfolio before change:  [12.25189548]
curr_Stock_Price:  98.50030391866343
curr_Factors:  [98.50030392 -1.3632541  -0.95160541]
mat_Sqrt:  [[ 9.72986596  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07118845  0.0266891  -2.00706287]
Stock Position:  -0.07118844663711034
Bond Position:  [19.26397911]


portfolio before change:  [12.24090335]
curr_Stock_Price:  98.68854060028393
curr_Factors:  [98.6885406  -1.31616857 -0.95267835]
mat_Sqrt:  [[10.20749165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306312 -0.03976045 -0.08195812]
Stock Position:  -0.003063119323207561
Bond Position:  [12.54319813]


portfolio before change:  [12.24366552]
curr_Stock_Price:  98.29868403534041
curr_Factors:  [98.29868404 -1.2607206  -0.93427325]
mat_Sqrt:  [[10.94646732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069531  0.02196405  0.45538241]
Stock Position:  -0.0006953127343778462
Bond Position:  [12.31201385]


portfolio before change:  [12.24519255]
curr_Stock_Price:  98.31604815163695
curr_Factors:  [98.31604815 -1.05626941 -0.91664554]
mat_Sqrt:  [[13.67093876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016288   0.0391125  -0.06856646]
Stock Position:  0.0016287980358109608
Bond Position:  [12.08505556]


portfolio before change:  [12.245684]
curr_Stock_Price:  97.69026206131177
curr_Factors:  [97.69026206 -1.1277746  -0.90612725]
mat_Sqrt:  [[12.78023745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01071808  0.00104944 -0.46956196]
Stock Position:  -0.010718076898073015
Bond Position:  [13.29273574]


portfolio before change:  [12.24569309]
curr_Stock_Price:  97.84445044376524
curr_Factors:  [97.84445044 -0.89232352 -0.89696035]
mat_Sqrt:  [[16.34782898  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188124  0.03972205  0.36565622]
Stock Position:  -0.001881236553925126
Bond Position:  [12.42976165]


portfolio before change:  [12.2460268]
curr_Stock_Price:  98.49301843381365
curr_Factors:  [98.49301843 -0.92003947 -0.88482334]
mat_Sqrt:  [[16.20180829  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060675 -0.00518607  0.11914284]
Stock Position:  0.0006067459572156642
Bond Position:  [12.18626656]


portfolio before change:  [12.24761712]
curr_Stock_Price:  98.60335730679215
curr_Factors:  [98.60335731 -1.04248523 -0.88832814]
mat_Sqrt:  [[14.30046335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011667  -0.00526771  0.12477076]
Stock Position:  -0.0011666977059008106
Bond Position:  [12.36265743]


portfolio before change:  [12.24860553]
curr_Stock_Price:  99.08078988323912
curr_Factors:  [99.08078988 -0.97694812 -0.88138019]
mat_Sqrt:  [[15.44997314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011518   0.00284501 -0.06156488]
Stock Position:  0.001151803966192332
Bond Position:  [12.13448389]


portfolio before change:  [12.25155861]
curr_Stock_Price:  100.32767909241312
curr_Factors:  [100.32767909  -0.8951585   -0.89000162]
mat_Sqrt:  [[16.83199422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00522767  0.00408447 -0.00186319]
Stock Position:  -0.005227674585062939
Bond Position:  [12.77603907]


portfolio before change:  [12.2457761]
curr_Stock_Price:  101.7393223637299
curr_Factors:  [101.73932236  -0.98492451  -0.91548257]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.2457761]
Stock Price:  102.37232797638117
PL:  [9.87344813]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [ 3.68341826e-03  9.88372354e-02 -1.84405828e-03]
 [-3.23920176e-02  1.25117803e-02 -2.71461615e-02]
 [ 2.81150878e-01 -4.07662387e-02 -1.31966599e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-5.62739283e-01 -1.72551435e-01  3.89016878e-02]
 [ 1.60383928e-02 -1.35132664e-01 -1.73192327e-01]
 [ 2.85134405e-02 -1.78068162e-01 -2.57050440e-02]
 [ 1.72965699e-01  9.07837743e-02 -3.40938108e-02]
 [-2.80210590e-01  1.36574183e-03 -8.37208004e-02]
 [ 5.46735322e-02 -2.96525759e-02 -4.71974002e-02]
 [ 3.22506672e-02 -3.27228750e-01  1.35889804e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 5.65141196e-02 -6.16534668e-03  2.34425985e-01]
 [ 1.78471665e-02  5.03238836e-01  4.61336096e-01]
 [ 7.72049157e-02 -1.18350358e-01 -4.91840814e-02]
 [-2.28797551e-02  9.94753802e-03  3.89124113e-02]
 [-5.14647801e-01 -1.28395533e-01  1.60624543e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 1.42506996e-01  7.66909421e-01  1.38200202e-01]
 [-1.03487665e-02  3.14214943e-02  2.75760506e-02]
 [ 7.09395847e-02 -1.45500402e-01  1.21553935e-01]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 2.41500195e-01  3.95501161e-03  2.24529453e-01]
 [ 7.09629198e-02 -1.77947145e-01 -6.89492993e-02]
 [-1.20689674e-01  2.25880344e-01  1.95003907e-01]
 [ 1.18179511e-02  6.03516169e-02  5.49803570e-02]
 [-9.38868584e-02 -1.00842107e-01  2.57197302e-01]
 [ 9.33653248e-02  7.27787619e-02 -8.69524963e-02]
 [-8.47485691e-01 -1.66489080e-01 -1.23560692e+00]
 [-7.54494285e-03 -6.57749184e-02  7.92469063e-02]
 [ 4.19668758e-02 -9.75360191e-02  1.09638070e-01]
 [ 4.87993310e-02  1.38929714e-01 -3.05421668e-02]
 [-1.07852557e-01 -4.10099749e-03 -1.69564513e-02]
 [-4.39451892e-02  2.35465077e-01  4.01756831e-02]
 [ 8.62119962e-02 -1.43009374e-01 -1.20761457e-01]
 [-5.54609043e-02  3.69214987e-01  8.72628659e-02]
 [ 2.36612410e-01  1.66240883e-01  1.00622533e-02]
 [ 5.38438080e-02  2.23319006e-02 -1.41708058e-02]
 [-1.70651972e-01 -3.66994649e-01  7.63742134e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.0284144]
curr_Stock_Price:  101.34323230367403
curr_Factors:  [101.3432323   -1.18897297  -0.9768649 ]
mat_Sqrt:  [[11.61938967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050424  0.03125508 -0.00526058]
Stock Position:  0.0005042405879486394
Bond Position:  [11.97731303]


portfolio before change:  [12.02979433]
curr_Stock_Price:  101.110557202827
curr_Factors:  [101.1105572   -1.29035974  -0.94557141]
mat_Sqrt:  [[10.80796532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347985  0.00395657 -0.07744044]
Stock Position:  -0.0034798549691071406
Bond Position:  [12.38164441]


portfolio before change:  [12.03204976]
curr_Stock_Price:  100.90720842915768
curr_Factors:  [100.90720843  -1.12052473  -0.94114014]
mat_Sqrt:  [[12.8396302   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01971714 -0.01289142 -0.37646397]
Stock Position:  0.01971713556673695
Bond Position:  [10.04244865]


portfolio before change:  [12.03646606]
curr_Stock_Price:  101.06752165210766
curr_Factors:  [101.06752165  -1.01747723  -0.93534274]
mat_Sqrt:  [[14.33879577  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137411 -0.00659539  0.21422481]
Stock Position:  0.00137410799456585
Bond Position:  [11.89758837]


portfolio before change:  [12.03684008]
curr_Stock_Price:  100.25734161515751
curr_Factors:  [100.25734162  -0.71109209  -0.89824538]
mat_Sqrt:  [[20.05348238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02788811 -0.05456555  0.11097569]
Stock Position:  -0.027888112269405862
Bond Position:  [14.83282808]


portfolio before change:  [12.07020901]
curr_Stock_Price:  99.12730041849066
curr_Factors:  [99.12730042 -0.85295001 -0.89948361]
mat_Sqrt:  [[17.18387187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132703 -0.0427327  -0.4940695 ]
Stock Position:  -0.0013270264935603827
Bond Position:  [12.20175357]


portfolio before change:  [12.07272823]
curr_Stock_Price:  98.37833004970281
curr_Factors:  [98.37833005 -0.73519669 -0.8994112 ]
mat_Sqrt:  [[19.18661037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00097301 -0.0563101  -0.07332934]
Stock Position:  0.0009730077311954448
Bond Position:  [11.97700536]


portfolio before change:  [12.07514162]
curr_Stock_Price:  99.31991180035041
curr_Factors:  [99.3199118  -0.61565679 -0.9213587 ]
mat_Sqrt:  [[21.35595405  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00788306  0.02870835 -0.09726015]
Stock Position:  0.0078830641531713
Bond Position:  [11.29219638]


portfolio before change:  [12.07447769]
curr_Stock_Price:  99.05662120466359
curr_Factors:  [99.0566212  -0.66108624 -0.91527175]
mat_Sqrt:  [[20.47764145  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01451655  0.00043189 -0.23883214]
Stock Position:  -0.014516552801652115
Bond Position:  [13.51243837]


portfolio before change:  [12.06208241]
curr_Stock_Price:  100.02685452186802
curr_Factors:  [100.02685452  -0.70541394  -0.9165949 ]
mat_Sqrt:  [[19.75545899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00224109 -0.00937697 -0.13464105]
Stock Position:  0.002241090781751321
Bond Position:  [11.83791315]


portfolio before change:  [12.06524396]
curr_Stock_Price:  100.77725553794994
curr_Factors:  [100.77725554  -0.6323922   -0.93404986]
mat_Sqrt:  [[21.04095188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00244951 -0.10347882  0.38765579]
Stock Position:  0.0024495112004215
Bond Position:  [11.81838894]


portfolio before change:  [12.0683869]
curr_Stock_Price:  101.45720730140414
curr_Factors:  [101.4572073   -0.63696605  -0.9458298 ]
mat_Sqrt:  [[20.83931309  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00346104  0.00225658  0.15019092]
Stock Position:  -0.003461036277254084
Bond Position:  [12.41953397]


portfolio before change:  [12.06281849]
curr_Stock_Price:  103.51466770175867
curr_Factors:  [103.5146677   -0.68287043  -0.94173565]
mat_Sqrt:  [[20.39127756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00511037 -0.00194965  0.66875208]
Stock Position:  0.005110368121084433
Bond Position:  [11.53382043]


portfolio before change:  [12.06517227]
curr_Stock_Price:  103.69312078883628
curr_Factors:  [103.69312079  -0.65701296  -0.93793001]
mat_Sqrt:  [[21.0414185   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00594117 0.15913809 1.31606347]
Stock Position:  0.005941166640884681
Bond Position:  [11.44911416]


portfolio before change:  [12.07345217]
curr_Stock_Price:  104.84586935926639
curr_Factors:  [104.84586936  -0.66604294  -0.93124887]
mat_Sqrt:  [[21.22542057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00302041 -0.03742567 -0.14030849]
Stock Position:  0.003020409596150241
Bond Position:  [11.7567747]


portfolio before change:  [12.07133695]
curr_Stock_Price:  103.65897240075219
curr_Factors:  [103.6589724   -0.63168113  -0.91760071]
mat_Sqrt:  [[22.01721314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066675  0.00314569  0.11100628]
Stock Position:  -0.0006667486905822514
Bond Position:  [12.14045143]


portfolio before change:  [12.07164707]
curr_Stock_Price:  105.47003272388285
curr_Factors:  [105.47003272  -0.5312455   -0.9189241 ]
mat_Sqrt:  [[24.73594046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0196142  -0.04060223  0.45821711]
Stock Position:  -0.019614197107010546
Bond Position:  [14.14035709]


portfolio before change:  [12.1133782]
curr_Stock_Price:  103.43255590183917
curr_Factors:  [103.4325559   -0.53259695  -0.92953881]
mat_Sqrt:  [[23.96954357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00547825  0.00580111 -0.05715682]
Stock Position:  -0.0054782471520573835
Bond Position:  [12.68000731]


portfolio before change:  [12.11747658]
curr_Stock_Price:  102.97378182499354
curr_Factors:  [102.97378182  -0.60068555  -0.92114373]
mat_Sqrt:  [[22.48042954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00847486 0.24251805 0.39424671]
Stock Position:  0.008474860774146291
Bond Position:  [11.24478811]


portfolio before change:  [12.12711074]
curr_Stock_Price:  103.94470977353994
curr_Factors:  [103.94470977  -0.9671761   -0.91783872]
mat_Sqrt:  [[15.78159362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024766  0.00993635  0.0786668 ]
Stock Position:  -0.0002476637889301666
Bond Position:  [12.15285409]


portfolio before change:  [12.12831197]
curr_Stock_Price:  105.22859916476078
curr_Factors:  [105.22859916  -1.09472838  -0.94059337]
mat_Sqrt:  [[13.74690026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00669204 -0.04601127  0.34675954]
Stock Position:  0.006692044880523798
Bond Position:  [11.42411747]


portfolio before change:  [12.13031939]
curr_Stock_Price:  105.31516658527393
curr_Factors:  [105.31516659  -0.95372101  -0.93768511]
mat_Sqrt:  [[15.88779682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244646  0.01916992 -0.08961985]
Stock Position:  -0.00244646026982403
Bond Position:  [12.38796876]


portfolio before change:  [12.13008464]
curr_Stock_Price:  106.04411634901128
curr_Factors:  [106.04411635  -0.91879639  -0.94639425]
mat_Sqrt:  [[16.42270048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01750225 0.00125068 0.64052003]
Stock Position:  0.017502249142997535
Bond Position:  [10.27407409]


portfolio before change:  [12.13006088]
curr_Stock_Price:  105.96937750915838
curr_Factors:  [105.96937751  -0.55245669  -0.95323213]
mat_Sqrt:  [[23.51083417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00222426 -0.05627183 -0.19669316]
Stock Position:  0.0022242565772102587
Bond Position:  [11.89435779]


portfolio before change:  [12.13155795]
curr_Stock_Price:  105.97395555322672
curr_Factors:  [105.97395555  -0.6957157   -0.92453199]
mat_Sqrt:  [[20.96691412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357957  0.07142964  0.55629187]
Stock Position:  -0.0035795664911428045
Bond Position:  [12.51089877]


portfolio before change:  [12.12909883]
curr_Stock_Price:  107.09785673986062
curr_Factors:  [107.09785674  -0.62227457  -0.95650615]
mat_Sqrt:  [[22.08640476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00111376 0.01908486 0.15684365]
Stock Position:  0.0011137639575779029
Bond Position:  [12.0098171]


portfolio before change:  [12.13051915]
curr_Stock_Price:  107.025133372225
curr_Factors:  [107.02513337  -0.61411926  -0.94650603]
mat_Sqrt:  [[22.47578276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195724 -0.03188907  0.73371231]
Stock Position:  -0.0019572359914991964
Bond Position:  [12.3399926]


portfolio before change:  [12.13331812]
curr_Stock_Price:  106.38322155970233
curr_Factors:  [106.38322156  -0.64596391  -0.93461455]
mat_Sqrt:  [[21.89962259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00353866  0.02301467 -0.24805127]
Stock Position:  0.0035386619128855855
Bond Position:  [11.75686387]


portfolio before change:  [12.13642144]
curr_Stock_Price:  106.84486950163964
curr_Factors:  [106.8448695   -0.56602505  -0.95165098]
mat_Sqrt:  [[23.42261326  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04713401 -0.05264847 -3.5248426 ]
Stock Position:  -0.04713400737976488
Bond Position:  [17.17244831]


portfolio before change:  [12.22724129]
curr_Stock_Price:  104.96357055316132
curr_Factors:  [104.96357055  -0.36278103  -0.97530105]
mat_Sqrt:  [[27.53701951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00025177 -0.02079986  0.22606937]
Stock Position:  0.000251768825976042
Bond Position:  [12.20081473]


portfolio before change:  [12.22868944]
curr_Stock_Price:  104.657577841423
curr_Factors:  [104.65757784  -0.20194762  -0.9915847 ]
mat_Sqrt:  [[31.72679346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194877 -0.0308436   0.3127669 ]
Stock Position:  0.0019487719146297916
Bond Position:  [12.0247357]


portfolio before change:  [12.23299713]
curr_Stock_Price:  106.09668770388784
curr_Factors:  [106.0966877   -0.25047473  -1.02613875]
mat_Sqrt:  [[29.59890447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155925  0.04393343 -0.0871283 ]
Stock Position:  0.0015592498410116353
Bond Position:  [12.06756588]


portfolio before change:  [12.23444388]
curr_Stock_Price:  106.05706197868834
curr_Factors:  [106.05706198  -0.26297876  -1.03542544]
mat_Sqrt:  [[28.95008307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00384868 -0.00129685 -0.04837204]
Stock Position:  -0.003848682067518655
Bond Position:  [12.64262379]


portfolio before change:  [12.22259089]
curr_Stock_Price:  109.54745610992363
curr_Factors:  [109.54745611  -0.24584291  -1.02874043]
mat_Sqrt:  [[30.62370889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096868  0.0744606   0.11461004]
Stock Position:  -0.000968683453647829
Bond Position:  [12.3287077]


portfolio before change:  [12.2257988]
curr_Stock_Price:  107.8268432261279
curr_Factors:  [107.82684323  -0.11921443  -1.05898638]
mat_Sqrt:  [[33.19256212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00174344 -0.04522353 -0.34449882]
Stock Position:  0.0017434382038839858
Bond Position:  [12.03780937]


portfolio before change:  [12.23033458]
curr_Stock_Price:  109.56533545503173
curr_Factors:  [109.56533546  -0.26575214  -1.06951033]
mat_Sqrt:  [[28.82544701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00097537  0.11675603  0.24893667]
Stock Position:  -0.0009753658423815843
Bond Position:  [12.33720086]


portfolio before change:  [12.23196335]
curr_Stock_Price:  109.47662384842668
curr_Factors:  [109.47662385  -0.23131575  -1.04567305]
mat_Sqrt:  [[30.53037965  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00795793 0.05256998 0.02870481]
Stock Position:  0.007957931814505501
Bond Position:  [11.36075584]


portfolio before change:  [12.24039193]
curr_Stock_Price:  110.35730492213435
curr_Factors:  [110.35730492  -0.26896299  -1.03313597]
mat_Sqrt:  [[30.01281233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171686  0.00706197 -0.04042536]
Stock Position:  0.0017168604868538241
Bond Position:  [12.05092384]


portfolio before change:  [12.23969018]
curr_Stock_Price:  109.07110957356512
curr_Factors:  [109.07110957  -0.20708058  -1.02100708]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.23969018]
Stock Price:  110.20748772170539
PL:  [2.03220245]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-7.39173964e-02 -2.17114081e-02 -2.23596061e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 1.76995587e-01  1.70317915e-01  2.61371902e-01]
 [-8.14276795e-02  8.04919144e-03  8.63622068e-02]
 [-7.34839748e-01 -2.21300904e-01  3.46959946e-02]
 [ 4.75578627e-02 -1.64906801e-01 -2.22666636e-01]
 [ 2.83481800e-02 -1.41675557e-01 -2.49944297e-02]
 [ 3.40837828e-01  1.03698031e-01 -9.86139544e-02]
 [-3.24398534e-01  1.54539086e-03 -1.04136135e-01]
 [ 4.44521122e-02 -1.22874822e-02 -3.90602208e-02]
 [-6.48725339e-03 -1.96294859e-01  3.21147812e-02]
 [-7.34301464e-02  5.89000185e-03  4.74129599e-02]
 [ 2.14028268e-01 -1.61341284e-01  1.92769833e-01]
 [ 7.77684514e-02  5.26690667e-02  8.77233874e-03]
 [ 6.67807349e-02 -9.86745057e-02 -6.07808866e-02]
 [-5.20134868e-02  6.57283211e-02  4.65580325e-02]
 [-4.96880256e-01 -2.90461967e-01  1.41260556e-01]
 [-1.30770335e-01  1.58149087e-02 -2.54487597e-02]
 [ 3.75934457e-01  1.43664136e+00  6.39368047e-01]
 [-6.28660233e-02 -5.03278740e-03  7.79977774e-02]
 [-9.03053926e-02  1.06199111e-01 -3.90192904e-02]
 [ 1.84618313e-02  2.11004040e-02  1.19740388e-02]
 [-7.21729276e-04 -2.58390444e-02 -1.33038410e-02]
 [ 2.62807864e-02  8.35853860e-02  1.06842067e-01]
 [-7.24012647e-02 -8.24255020e-02 -7.81665411e-02]
 [ 1.00384394e-01 -1.60197003e-04 -1.05808522e-02]
 [-2.15441244e-02  1.24149368e-02 -5.37956413e-02]
 [ 4.46484811e-03  4.21021830e-02 -6.23506364e-02]
 [-5.78580651e-01  4.33849030e-02 -7.82400373e-01]
 [-1.41519233e-01 -2.31456170e-02  8.91788914e-05]
 [-9.02798921e-02  9.22946337e-02  2.11615573e-01]
 [ 1.71935861e-02  7.41186059e-02 -1.21457973e-04]
 [-1.09161365e-01 -1.77027498e-04 -1.54574160e-01]
 [-6.52336585e-02  4.16977627e-03  5.11582988e-02]
 [ 2.09683078e-01 -1.66443251e-01 -7.27760911e-02]
 [ 1.25352255e-02  3.11308746e-02  7.22125956e-02]
 [-3.88134274e-02 -4.47754653e-02 -4.68054128e-02]
 [-9.98635088e-02 -2.20602861e-02  2.46882558e-03]
 [-2.84079867e-02 -2.96330771e-01  1.41518973e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.97730574]
curr_Stock_Price:  100.22147160918722
curr_Factors:  [100.22147161  -1.1495285   -1.0128255 ]
mat_Sqrt:  [[11.53087775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00685482 -0.00686575 -0.06378573]
Stock Position:  -0.00685482230896438
Bond Position:  [4.66430612]


portfolio before change:  [3.98119977]
curr_Stock_Price:  99.73846050692255
curr_Factors:  [99.73846051 -1.24844019 -1.0155909 ]
mat_Sqrt:  [[10.36588655  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00437792  0.01411938  0.0859571 ]
Stock Position:  -0.004377922007332091
Bond Position:  [4.41784697]


portfolio before change:  [3.98277285]
curr_Stock_Price:  99.50528559129906
curr_Factors:  [99.50528559 -1.29738432 -1.0071195 ]
mat_Sqrt:  [[ 9.93145452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02363657 0.05385925 0.74562128]
Stock Position:  0.02363656722269445
Bond Position:  [1.63080948]


portfolio before change:  [3.96995475]
curr_Stock_Price:  98.95436101289404
curr_Factors:  [98.95436101 -1.22515661 -1.01615345]
mat_Sqrt:  [[10.52074144  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00604437  0.00254538  0.24636734]
Stock Position:  -0.006044368549321314
Bond Position:  [4.56807138]


portfolio before change:  [3.97310377]
curr_Stock_Price:  98.52785294199856
curr_Factors:  [98.52785294 -1.42266927 -0.9827148 ]
mat_Sqrt:  [[ 8.89025027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0825029  -0.06998149  0.09897802]
Stock Position:  -0.08250289923440464
Bond Position:  [12.10193729]


portfolio before change:  [4.00510863]
curr_Stock_Price:  98.15826564630426
curr_Factors:  [98.15826565 -1.27465996 -0.99816379]
mat_Sqrt:  [[10.11234926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.12774434e-04 -5.21481094e-02 -6.35205935e-01]
Stock Position:  -0.00021277443444463496
Bond Position:  [4.0259942]


portfolio before change:  [4.0055051]
curr_Stock_Price:  98.66024912620297
curr_Factors:  [98.66024913 -1.3436454  -0.96258685]
mat_Sqrt:  [[ 9.83010748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00199267 -0.04480174 -0.07130215]
Stock Position:  0.001992670609610157
Bond Position:  [3.80890772]


portfolio before change:  [4.00726641]
curr_Stock_Price:  99.30519659132845
curr_Factors:  [99.30519659 -1.39957545 -0.96375222]
mat_Sqrt:  [[ 9.34526901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03460423  0.0327922  -0.28131816]
Stock Position:  0.03460422703611751
Bond Position:  [0.57088684]


portfolio before change:  [4.01399074]
curr_Stock_Price:  99.49745518801537
curr_Factors:  [99.49745519 -1.31545692 -0.9787455 ]
mat_Sqrt:  [[10.03350155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03444613  0.0004887  -0.29707141]
Stock Position:  -0.034446133337612976
Bond Position:  [7.44129335]


portfolio before change:  [4.02654622]
curr_Stock_Price:  99.15996415819679
curr_Factors:  [99.15996416 -1.34451146 -0.96630901]
mat_Sqrt:  [[ 9.83466982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00367696 -0.00388564 -0.11142794]
Stock Position:  0.0036769629516842017
Bond Position:  [3.6619387]


portfolio before change:  [4.02957134]
curr_Stock_Price:  99.8581907748757
curr_Factors:  [99.85819077 -1.64947164 -0.9886091 ]
mat_Sqrt:  [[ 7.13969704  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070033 -0.06207388  0.09161453]
Stock Position:  -0.000700332600326508
Bond Position:  [4.09950529]


portfolio before change:  [4.03004658]
curr_Stock_Price:  99.91135587660146
curr_Factors:  [99.91135588 -1.6023661  -0.97258887]
mat_Sqrt:  [[ 7.60897432  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00835854  0.00186258  0.13525598]
Stock Position:  -0.00835854276672144
Bond Position:  [4.86515992]


portfolio before change:  [4.02927254]
curr_Stock_Price:  100.07672197174219
curr_Factors:  [100.07672197  -1.51724012  -0.93835368]
mat_Sqrt:  [[ 8.58780617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02901922 -0.05102059  0.54991868]
Stock Position:  0.029019219400154506
Bond Position:  [1.12512419]


portfolio before change:  [4.02354065]
curr_Stock_Price:  99.8743544856832
curr_Factors:  [99.87435449 -1.39953018 -0.98666556]
mat_Sqrt:  [[ 9.18633631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00880863 0.01665542 0.02502504]
Stock Position:  0.008808626670256926
Bond Position:  [3.14378474]


portfolio before change:  [4.01861585]
curr_Stock_Price:  99.27065118805575
curr_Factors:  [99.27065119 -1.48284029 -0.99981066]
mat_Sqrt:  [[ 8.29123571  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00625071 -0.03120362 -0.17339095]
Stock Position:  0.006250711648203292
Bond Position:  [3.39810363]


portfolio before change:  [4.01907317]
curr_Stock_Price:  99.27585528352816
curr_Factors:  [99.27585528 -1.64340497 -0.99433956]
mat_Sqrt:  [[ 7.10044793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00574791  0.02078512  0.13281711]
Stock Position:  -0.005747914864009895
Bond Position:  [4.58970233]


portfolio before change:  [4.02120247]
curr_Stock_Price:  99.00522486131551
curr_Factors:  [99.00522486 -1.55001161 -0.97981777]
mat_Sqrt:  [[ 7.88800494  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06028714 -0.09185214  0.40297705]
Stock Position:  -0.06028714045423099
Bond Position:  [9.98994437]


portfolio before change:  [3.97449281]
curr_Stock_Price:  99.80072600618846
curr_Factors:  [99.80072601 -1.54197638 -1.00165478]
mat_Sqrt:  [[ 7.8423952   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01728511  0.00500111 -0.07259823]
Stock Position:  -0.017285114891551823
Bond Position:  [5.69955982]


portfolio before change:  [3.97023947]
curr_Stock_Price:  100.08801534455024
curr_Factors:  [100.08801534  -1.44693364  -1.01416107]
mat_Sqrt:  [[ 8.54165889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06363387 0.45430589 1.82393907]
Stock Position:  0.06363387262544457
Bond Position:  [-2.39874855]


portfolio before change:  [3.95394654]
curr_Stock_Price:  99.83668584975011
curr_Factors:  [99.83668585 -1.31863606 -0.99644138]
mat_Sqrt:  [[ 9.85972486  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00477445 -0.00159151  0.22250595]
Stock Position:  -0.004774447593524665
Bond Position:  [4.43061156]


portfolio before change:  [3.95484503]
curr_Stock_Price:  99.76450307368609
curr_Factors:  [99.76450307 -1.23272012 -0.99766951]
mat_Sqrt:  [[10.72334141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00890843  0.03358311 -0.11131117]
Stock Position:  -0.00890842872127456
Bond Position:  [4.84358999]


portfolio before change:  [3.95800237]
curr_Stock_Price:  99.47804916398782
curr_Factors:  [99.47804916 -1.21126279 -1.0096884 ]
mat_Sqrt:  [[10.79395028  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0019873  0.00667253 0.0341586 ]
Stock Position:  0.0019873013351812997
Bond Position:  [3.76030951]


portfolio before change:  [3.95768988]
curr_Stock_Price:  99.08427143817728
curr_Factors:  [99.08427144 -1.2604429  -0.98923824]
mat_Sqrt:  [[10.44673596  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003929  -0.00817102 -0.03795216]
Stock Position:  -0.00039290030186978113
Bond Position:  [3.99662012]


portfolio before change:  [3.95814146]
curr_Stock_Price:  99.2065341718351
curr_Factors:  [99.20653417 -1.36098173 -1.00022168]
mat_Sqrt:  [[ 9.35583743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00537076 0.02643202 0.30479068]
Stock Position:  0.005370764259254978
Bond Position:  [3.42532655]


portfolio before change:  [3.95915164]
curr_Stock_Price:  99.31489813061896
curr_Factors:  [99.31489813 -1.34862659 -1.00058393]
mat_Sqrt:  [[ 9.47905916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0095458  -0.02606523 -0.22298738]
Stock Position:  -0.009545795519042334
Bond Position:  [4.90719135]


portfolio before change:  [3.9561418]
curr_Stock_Price:  99.69446645275441
curr_Factors:  [99.69446645 -1.62283228 -0.99943121]
mat_Sqrt:  [[ 7.24163261  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.35633020e-02 -5.06587403e-05 -3.01842262e-02]
Stock Position:  0.013563302012519728
Bond Position:  [2.60395564]


portfolio before change:  [3.96041409]
curr_Stock_Price:  99.98545553825063
curr_Factors:  [99.98545554 -1.54320165 -0.99618977]
mat_Sqrt:  [[ 7.89029327  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00408154  0.00392595 -0.15346399]
Stock Position:  -0.004081541743953757
Bond Position:  [4.3685089]


portfolio before change:  [3.95932151]
curr_Stock_Price:  100.38694115575535
curr_Factors:  [100.38694116  -1.49594016  -0.96468676]
mat_Sqrt:  [[ 8.57117826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083715  0.01331388 -0.17786901]
Stock Position:  -0.0008371484457806665
Bond Position:  [4.04336028]


portfolio before change:  [3.95970009]
curr_Stock_Price:  100.53849409759773
curr_Factors:  [100.5384941   -1.63294611  -0.95172463]
mat_Sqrt:  [[ 7.58270461  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09721693  0.01371951 -2.23197049]
Stock Position:  -0.09721693024850411
Bond Position:  [13.73374385]


portfolio before change:  [3.95814068]
curr_Stock_Price:  100.57219429038683
curr_Factors:  [100.57219429  -1.58789014  -0.96632772]
mat_Sqrt:  [[ 7.81979204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01817167 -0.00731929  0.0002544 ]
Stock Position:  -0.018171665650755477
Bond Position:  [5.78570497]


portfolio before change:  [3.96867554]
curr_Stock_Price:  100.03225502116968
curr_Factors:  [100.03225502  -1.54107802  -0.94427735]
mat_Sqrt:  [[ 8.33228156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0053648   0.02918613  0.60368033]
Stock Position:  -0.005364797942358227
Bond Position:  [4.50532837]


portfolio before change:  [3.97241654]
curr_Stock_Price:  99.4399115402302
curr_Factors:  [99.43991154 -1.52511121 -0.947886  ]
mat_Sqrt:  [[ 8.38593878  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227554  0.02343836 -0.00034649]
Stock Position:  0.002275538641640299
Bond Position:  [3.74613718]


portfolio before change:  [3.97349446]
curr_Stock_Price:  99.70781562307813
curr_Factors:  [99.70781562 -1.43714431 -0.97553326]
mat_Sqrt:  [[ 8.93134047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.57555582e-02 -5.59810102e-05 -4.40957052e-01]
Stock Position:  -0.01575555815615338
Bond Position:  [5.54444675]


portfolio before change:  [3.96029591]
curr_Stock_Price:  100.58951422794763
curr_Factors:  [100.58951423  -1.56993456  -1.00843999]
mat_Sqrt:  [[ 7.63446961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00716269  0.0013186   0.14594039]
Stock Position:  -0.007162691598549549
Bond Position:  [4.68078758]


portfolio before change:  [3.96297501]
curr_Stock_Price:  100.29717099049027
curr_Factors:  [100.29717099  -1.50581719  -0.96139541]
mat_Sqrt:  [[ 8.5073023   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02239607 -0.05263398 -0.20760993]
Stock Position:  0.022396074358329018
Bond Position:  [1.71671211]


portfolio before change:  [3.96861051]
curr_Stock_Price:  100.53921790775055
curr_Factors:  [100.53921791  -1.47492293  -0.95365897]
mat_Sqrt:  [[ 8.86371508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0031679  0.00984445 0.20600244]
Stock Position:  0.0031678991572900244
Bond Position:  [3.65011241]


portfolio before change:  [3.97034207]
curr_Stock_Price:  100.94177740174224
curr_Factors:  [100.9417774   -1.67906134  -0.97069147]
mat_Sqrt:  [[ 7.13342213  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00694248 -0.01415925 -0.13352281]
Stock Position:  -0.006942479910695798
Bond Position:  [4.67112833]


portfolio before change:  [3.97284416]
curr_Stock_Price:  100.66548372405444
curr_Factors:  [100.66548372  -1.65531398  -0.94687983]
mat_Sqrt:  [[ 7.460401    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01339461 -0.00697607  0.00704287]
Stock Position:  -0.013394609214023736
Bond Position:  [5.32121898]


portfolio before change:  [3.97135779]
curr_Stock_Price:  100.82611330342533
curr_Factors:  [100.8261133   -1.77119592  -0.92119056]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.97135779]
Stock Price:  101.31604968378944
PL:  [2.6553081]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.09473786e-01 -7.02104630e-03  2.76827912e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 3.29002697e-01  2.45992978e-01  2.94912915e-01]
 [ 8.26241145e-03  4.89219040e-02  1.39513487e-01]
 [-3.85667994e-01 -1.22393921e-01  4.32288553e-02]
 [-7.51244771e-03 -8.99585399e-02 -1.04685205e-01]
 [ 3.23341393e-02 -1.29932957e-01 -1.75162308e-02]
 [ 9.91960377e-02  2.29584576e-01 -2.01981984e-02]
 [-2.32341255e-01  6.47647368e-03 -8.39430737e-02]
 [ 7.75073343e-02 -4.02436381e-02 -5.87459658e-02]
 [ 1.55424143e-01 -2.99445712e-01 -7.14309640e-03]
 [-1.02735896e-01 -8.73906555e-02 -1.90432365e-01]
 [ 2.35550109e-01 -2.52614158e-01  4.33649337e-02]
 [ 7.89417112e-02  1.06696357e-01  6.74058943e-02]
 [ 4.28401068e-02 -1.05951258e-01 -5.63060494e-02]
 [-4.50308305e-02  6.50821616e-02  4.74749496e-02]
 [-4.76734652e-01 -2.12015593e-01  1.25236261e-01]
 [-1.27415936e-01  1.83628519e-02 -2.02681764e-02]
 [ 6.55126519e-02  6.39750317e-01  7.75433270e-02]
 [-2.07928895e-02  3.68649525e-02  2.48241133e-02]
 [ 6.00464840e-02 -2.36399707e-01  1.33705668e-01]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 2.34333008e-01  7.42491823e-04  2.19348505e-01]
 [ 6.62975223e-02 -1.58749351e-01 -5.32543780e-02]
 [-1.19796968e-01  2.35095529e-01  2.31299983e-01]
 [ 7.84489639e-03  6.15086063e-02  5.75801291e-02]
 [-1.59457157e-01 -1.13844659e-01  3.61777704e-01]
 [ 1.45977147e-01  8.91196073e-02 -1.04354010e-01]
 [-8.87766272e-01 -1.30297787e-01 -1.20850759e+00]
 [ 1.09792321e-01 -3.36753630e-01  3.30603066e-01]
 [-1.31635166e-01 -2.50636546e-01  1.43291973e-01]
 [ 8.10377657e-02  2.60879071e-01 -6.23829403e-02]
 [-1.07676992e-01 -4.02199984e-03 -1.62414379e-02]
 [-5.18886305e-02  1.73423346e-01  6.89292894e-02]
 [ 6.43814856e-02 -1.37278678e-01 -1.25875672e-01]
 [-3.37638454e-02  2.80849457e-01  8.43757935e-02]
 [ 1.97992535e-01  1.42152812e-01 -2.91147926e-05]
 [ 2.65991282e-02  3.85753838e-02 -1.30125280e-02]
 [-1.21294177e-01 -2.43121218e-01  4.95967747e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.21535149]
curr_Stock_Price:  100.1153085504694
curr_Factors:  [100.11530855  -0.98375193  -0.98726245]
mat_Sqrt:  [[13.94761081  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00745679 -0.00222025  0.0789713 ]
Stock Position:  -0.007456785528412859
Bond Position:  [3.96188988]


portfolio before change:  [3.21294684]
curr_Stock_Price:  100.50420587169137
curr_Factors:  [100.50420587  -0.8808932   -1.0028926 ]
mat_Sqrt:  [[15.27799847  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297035  0.01411938  0.0859571 ]
Stock Position:  -0.0029703526234313845
Bond Position:  [3.51147977]


portfolio before change:  [3.21358814]
curr_Stock_Price:  100.4360844046282
curr_Factors:  [100.4360844   -0.60008579  -1.02080482]
mat_Sqrt:  [[19.85847652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0199186  0.07778981 0.84130446]
Stock Position:  0.019918600237488947
Bond Position:  [1.21304193]


portfolio before change:  [3.20168183]
curr_Stock_Price:  99.83072284546758
curr_Factors:  [99.83072285 -0.42516218 -1.01932452]
mat_Sqrt:  [[23.54678483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00161396 0.01547046 0.39799315]
Stock Position:  0.0016139630605978691
Bond Position:  [3.04055873]


portfolio before change:  [3.20263393]
curr_Stock_Price:  100.18513391717134
curr_Factors:  [100.18513392  -0.51947034  -1.03395674]
mat_Sqrt:  [[21.19134279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01793205 -0.03870436  0.12331989]
Stock Position:  -0.017932046207444954
Bond Position:  [4.99915838]


portfolio before change:  [3.2081052]
curr_Stock_Price:  99.91487282171397
curr_Factors:  [99.91487282 -0.74560995 -0.99932664]
mat_Sqrt:  [[17.45073836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178812 -0.02844739 -0.29863775]
Stock Position:  -0.0017881160434216866
Bond Position:  [3.38676458]


portfolio before change:  [3.21056457]
curr_Stock_Price:  98.7762450019404
curr_Factors:  [98.776245   -0.67766418 -0.96446926]
mat_Sqrt:  [[19.11978579  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00132867 -0.04108841 -0.04996893]
Stock Position:  0.0013286654700225228
Bond Position:  [3.07932398]


portfolio before change:  [3.20982492]
curr_Stock_Price:  97.92984179716996
curr_Factors:  [97.9298418  -0.5448514  -0.95230989]
mat_Sqrt:  [[21.91321842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00460913  0.07260102 -0.05761984]
Stock Position:  0.00460913335909825
Bond Position:  [2.75845322]


portfolio before change:  [3.21338839]
curr_Stock_Price:  98.62815992022257
curr_Factors:  [98.62815992 -0.65223103 -0.94631792]
mat_Sqrt:  [[19.94159738  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01250195  0.00204804 -0.23946622]
Stock Position:  -0.012501949391730785
Bond Position:  [4.44643265]


portfolio before change:  [3.2095226]
curr_Stock_Price:  98.981834778859
curr_Factors:  [98.98183478 -0.70048378 -0.92895274]
mat_Sqrt:  [[19.40439976  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00332279 -0.01272616 -0.16758589]
Stock Position:  0.003322791672896104
Bond Position:  [2.88062659]


portfolio before change:  [3.2046482]
curr_Stock_Price:  97.40650158790967
curr_Factors:  [97.40650159 -0.49765144 -0.88839442]
mat_Sqrt:  [[24.3576777   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00600363 -0.09469305 -0.02037727]
Stock Position:  0.00600362689884293
Bond Position:  [2.61985591]


portfolio before change:  [3.20375275]
curr_Stock_Price:  97.2027997086849
curr_Factors:  [97.20279971 -0.58908568 -0.89995443]
mat_Sqrt:  [[21.92789133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00656078 -0.02763535 -0.54325053]
Stock Position:  -0.006560783924548214
Bond Position:  [3.84147932]


portfolio before change:  [3.19949024]
curr_Stock_Price:  97.92569034798373
curr_Factors:  [97.92569035 -0.66467194 -0.90867087]
mat_Sqrt:  [[20.30497872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01171533 -0.07988361  0.12370809]
Stock Position:  0.011715327202269244
Bond Position:  [2.05225874]


portfolio before change:  [3.2249104]
curr_Stock_Price:  100.07361260065238
curr_Factors:  [100.0736126   -0.95798828  -0.92479495]
mat_Sqrt:  [[15.22780157  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00626852 0.03374035 0.19229025]
Stock Position:  0.006268519416196497
Bond Position:  [2.59759702]


portfolio before change:  [3.22710659]
curr_Stock_Price:  100.37216323310822
curr_Factors:  [100.37216323  -0.87128636  -0.91687039]
mat_Sqrt:  [[16.78907134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00170415 -0.03350473 -0.16062549]
Stock Position:  0.0017041462482663733
Bond Position:  [3.05605774]


portfolio before change:  [3.23021454]
curr_Stock_Price:  101.97174483003674
curr_Factors:  [101.97174483  -0.71366348  -0.94792525]
mat_Sqrt:  [[19.35802451  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173879  0.02058079  0.13543282]
Stock Position:  -0.0017387948252401433
Bond Position:  [3.40752248]


portfolio before change:  [3.2263437]
curr_Stock_Price:  104.44288950261162
curr_Factors:  [104.4428895   -0.60353426  -0.95502195]
mat_Sqrt:  [[21.97892855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0207765  -0.06704522  0.35726419]
Stock Position:  -0.020776496245357393
Bond Position:  [5.396301]


portfolio before change:  [3.22769628]
curr_Stock_Price:  104.4102560319036
curr_Factors:  [104.41025603  -0.54835069  -0.96091844]
mat_Sqrt:  [[23.08213131  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00567881  0.00580684 -0.05781947]
Stock Position:  -0.005678809800208686
Bond Position:  [3.82062227]


portfolio before change:  [3.22553908]
curr_Stock_Price:  104.8742290906277
curr_Factors:  [104.87422909  -0.52824977  -0.99203006]
mat_Sqrt:  [[22.93082294  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00426759 0.20230681 0.22120953]
Stock Position:  0.004267592125466268
Bond Position:  [2.77797864]


portfolio before change:  [3.22795584]
curr_Stock_Price:  105.35916035544284
curr_Factors:  [105.35916036  -0.21315183  -1.00865012]
mat_Sqrt:  [[31.04920281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047582  0.01165772  0.07081629]
Stock Position:  -0.0004758202545979662
Bond Position:  [3.27808786]


portfolio before change:  [3.22815679]
curr_Stock_Price:  105.79804832794788
curr_Factors:  [105.79804833  -0.2675754   -0.99275556]
mat_Sqrt:  [[30.00011203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00270783 -0.07475615  0.38142505]
Stock Position:  0.0027078307218223745
Bond Position:  [2.94167358]


portfolio before change:  [3.22732353]
curr_Stock_Price:  105.35452306637349
curr_Factors:  [105.35452307  -0.1690351   -1.02139709]
mat_Sqrt:  [[32.03723696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121324  0.01916992 -0.08961985]
Stock Position:  -0.0012132401970821988
Bond Position:  [3.35514387]


portfolio before change:  [3.22774222]
curr_Stock_Price:  105.35512205450559
curr_Factors:  [105.35512205  -0.36653538  -0.98882604]
mat_Sqrt:  [[27.16624858  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.02747534e-02 2.34796531e-04 6.25740230e-01]
Stock Position:  0.010274753417382392
Bond Position:  [2.14524432]


portfolio before change:  [3.24947458]
curr_Stock_Price:  107.44414374668563
curr_Factors:  [107.44414375  -0.37057912  -0.98762276]
mat_Sqrt:  [[27.62632831  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185794 -0.05020095 -0.15191992]
Stock Position:  0.001857942418907838
Bond Position:  [3.04984955]


portfolio before change:  [3.25138862]
curr_Stock_Price:  108.26913525118474
curr_Factors:  [108.26913525  -0.48841428  -0.98359361]
mat_Sqrt:  [[24.84389957  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267723  0.07434373  0.65983447]
Stock Position:  -0.0026772333516674337
Bond Position:  [3.54125036]


portfolio before change:  [3.25200263]
curr_Stock_Price:  108.20514150427351
curr_Factors:  [108.2051415   -0.57563531  -1.00279299]
mat_Sqrt:  [[22.32262171  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00094911 0.01945073 0.16426008]
Stock Position:  0.000949106099175194
Bond Position:  [3.14930447]


portfolio before change:  [3.2531605]
curr_Stock_Price:  109.01030391645837
curr_Factors:  [109.01030392  -0.74691886  -1.00568616]
mat_Sqrt:  [[18.89386747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468666 -0.03600084  1.03205109]
Stock Position:  -0.00468665555460146
Bond Position:  [3.76405425]


portfolio before change:  [3.25102104]
curr_Stock_Price:  109.56720483042878
curr_Factors:  [109.56720483  -0.84122486  -0.99583399]
mat_Sqrt:  [[17.45243623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0072756   0.02818209 -0.29769294]
Stock Position:  0.007275604993341863
Bond Position:  [2.45385333]


portfolio before change:  [3.25180588]
curr_Stock_Price:  109.63291710944239
curr_Factors:  [109.63291711  -0.71555069  -1.00022646]
mat_Sqrt:  [[19.71462043  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05771433 -0.04120378 -3.44753578]
Stock Position:  -0.05771433086597738
Bond Position:  [9.57919634]


portfolio before change:  [3.2421208]
curr_Stock_Price:  109.82147611672498
curr_Factors:  [109.82147612  -0.62802063  -0.99088402]
mat_Sqrt:  [[21.75734629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00774825 -0.10649085  0.94311852]
Stock Position:  0.007748254119257274
Bond Position:  [2.3911961]


portfolio before change:  [3.24191507]
curr_Stock_Price:  109.75634605694341
curr_Factors:  [109.75634606  -0.46693743  -0.99640626]
mat_Sqrt:  [[25.40431863  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428499 -0.07925823  0.40877211]
Stock Position:  -0.004284988870725737
Bond Position:  [3.7122198]


portfolio before change:  [3.248024]
curr_Stock_Price:  108.43898672813597
curr_Factors:  [108.43898673  -0.42856371  -0.95616797]
mat_Sqrt:  [[27.1521437   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00276368  0.08249721 -0.17796116]
Stock Position:  0.002763677552273715
Bond Position:  [2.94833361]


portfolio before change:  [3.24219127]
curr_Stock_Price:  106.19513149616829
curr_Factors:  [106.1951315   -0.49487197  -0.94673523]
mat_Sqrt:  [[25.12016877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00442259 -0.00127187 -0.0463323 ]
Stock Position:  -0.004422586087739216
Bond Position:  [3.71184838]


portfolio before change:  [3.23419632]
curr_Stock_Price:  108.10780460884295
curr_Factors:  [108.10780461  -0.45156198  -0.94402516]
mat_Sqrt:  [[26.77695926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124513  0.05484128  0.19663608]
Stock Position:  -0.0012451274357832183
Bond Position:  [3.36880432]


portfolio before change:  [3.2339613]
curr_Stock_Price:  108.6347789043103
curr_Factors:  [108.6347789   -0.4599781   -0.95996925]
mat_Sqrt:  [[26.2599314   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133826 -0.04341133 -0.35908826]
Stock Position:  0.0013382632601281097
Bond Position:  [3.08857937]


portfolio before change:  [3.2319644]
curr_Stock_Price:  106.854114235116
curr_Factors:  [106.85411424  -0.31183776  -0.94621867]
mat_Sqrt:  [[30.36856577  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030588  0.0888124   0.24070065]
Stock Position:  -0.0003058823030157336
Bond Position:  [3.26464918]


portfolio before change:  [3.23203854]
curr_Stock_Price:  107.94590585540041
curr_Factors:  [107.94590586  -0.22251098  -0.97240384]
mat_Sqrt:  [[32.67843611  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.17094896e-03  4.49526661e-02 -8.30563992e-05]
Stock Position:  0.006170948962231941
Bond Position:  [2.56590987]


portfolio before change:  [3.23148483]
curr_Stock_Price:  107.80419799397977
curr_Factors:  [107.80419799  -0.13351492  -1.01202505]
mat_Sqrt:  [[34.28735506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00072735  0.01219861 -0.03712112]
Stock Position:  0.0007273517912936363
Bond Position:  [3.15307325]


portfolio before change:  [3.23067069]
curr_Stock_Price:  106.14295937028533
curr_Factors:  [ 1.06142959e+02 -9.15480146e-02 -1.00471956e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.23067069]
Stock Price:  107.2046582428331
PL:  [-3.97398756]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.00568108e-01  2.54040010e-02  4.52740611e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.86389867e-01  1.56187012e-01  1.76083221e-01]
 [-9.33729139e-03  1.26740107e-02  1.06990419e-01]
 [-1.07227729e+00 -3.06753234e-01 -2.93876496e-02]
 [-7.36954909e-02  3.69906872e-02  8.78348790e-02]
 [ 3.67506493e-03  1.62894499e-01  8.51070177e-02]
 [ 2.77669028e-01 -7.57104937e-02 -5.68692043e-02]
 [-5.33060359e-01 -2.84415107e-02 -7.07068846e-02]
 [ 1.43607837e-02  3.88344496e-02 -1.51047882e-02]
 [-1.42997597e-02 -2.20535328e-01  1.34951487e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.45008870e-01 -5.68774781e-02  3.00831483e-01]
 [ 6.82993674e-02  1.57077188e-01  1.15949921e-01]
 [ 6.30701105e-02 -1.08827931e-01 -5.96721370e-02]
 [-4.12919431e-02  5.57759700e-02  4.60296758e-02]
 [-4.90921992e-01 -2.50234639e-01  1.34699984e-01]
 [-1.29732057e-01  1.82123837e-02 -1.83398490e-02]
 [ 2.69887418e-01  1.12664101e+00  4.06297788e-01]
 [ 1.09496520e-02  1.01200941e-02  3.07487565e-02]
 [-9.08799134e-02  2.29587732e-01 -3.10313570e-02]
 [-2.43346610e-02  4.08851103e-02 -1.32508418e-02]
 [ 4.30226705e-03 -2.83011728e-02 -4.94594158e-03]
 [ 4.81055545e-02  1.95466597e-01  1.02698437e-01]
 [-8.10098539e-02 -6.24615342e-02 -3.40045142e-02]
 [ 1.17866313e-01 -1.72360171e-02 -4.28646257e-03]
 [ 3.89672954e-02 -6.23451198e-02  1.14416150e-01]
 [-2.69598502e-02  4.28289666e-02  3.22006435e-02]
 [-6.25383675e-01  2.04007439e-02 -8.70816111e-01]
 [ 9.46749300e-02 -1.04195824e-01 -1.09545309e-01]
 [ 1.28675862e-01  6.24078436e-03 -3.70068871e-02]
 [ 2.45698886e-02  1.28070387e-01 -2.61539077e-02]
 [-1.12223327e-01 -5.24497801e-03 -1.57580948e-01]
 [-6.32185116e-02  5.24197835e-02  8.17588370e-02]
 [-2.04898840e-02  5.17335632e-03  6.35798321e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-8.03591058e-03 -8.97507837e-03 -4.72221569e-02]
 [-6.87598401e-02  7.61472264e-02 -4.87104279e-03]
 [-2.82082060e-02 -2.74969960e-01  1.04865076e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.45521738]
curr_Stock_Price:  100.56671895403831
curr_Factors:  [100.56671895  -0.89976603  -0.99001818]
mat_Sqrt:  [[15.1960749   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00596672  0.00803345  0.12915429]
Stock Position:  -0.005966715182683248
Bond Position:  [7.05527035]


portfolio before change:  [6.45913235]
curr_Stock_Price:  100.05839893904907
curr_Factors:  [100.05839894  -0.8531827   -1.02583598]
mat_Sqrt:  [[15.28291174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029694   0.01411938  0.0859571 ]
Stock Position:  -0.0029693976920414154
Bond Position:  [6.75624553]


portfolio before change:  [6.45863714]
curr_Stock_Price:  100.50959757356993
curr_Factors:  [100.50959757  -0.81197573  -1.04160118]
mat_Sqrt:  [[15.74741636  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02072501 0.04939067 0.50231642]
Stock Position:  0.0207250146701229
Bond Position:  [4.37557426]


portfolio before change:  [6.46204508]
curr_Stock_Price:  100.64764114888396
curr_Factors:  [100.64764115  -0.5281793   -1.02436744]
mat_Sqrt:  [[21.30792284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00060209 0.00400787 0.30521389]
Stock Position:  0.0006020895671180588
Bond Position:  [6.40144618]


portfolio before change:  [6.46369348]
curr_Stock_Price:  102.05634507414025
curr_Factors:  [102.05634507  -1.07300593  -1.01374099]
mat_Sqrt:  [[12.66418763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08576913 -0.09700389 -0.08383478]
Stock Position:  -0.08576912975708766
Bond Position:  [15.21697738]


portfolio before change:  [6.48366761]
curr_Stock_Price:  101.84564109565774
curr_Factors:  [101.8456411   -0.91741844  -1.00345673]
mat_Sqrt:  [[14.9182184   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367411  0.01169748  0.25056846]
Stock Position:  -0.0036741100324255197
Bond Position:  [6.85785971]


portfolio before change:  [6.48226943]
curr_Stock_Price:  102.45952239087356
curr_Factors:  [102.45952239  -0.99561882  -1.00288371]
mat_Sqrt:  [[13.88716859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00181847 0.05151176 0.24278663]
Stock Position:  0.0018184686013048646
Bond Position:  [6.29595001]


portfolio before change:  [6.47938748]
curr_Stock_Price:  100.44189169630718
curr_Factors:  [100.4418917   -0.84645993  -1.01665372]
mat_Sqrt:  [[15.58744389  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0169435  -0.02394176 -0.16223201]
Stock Position:  0.016943497338597725
Bond Position:  [4.77755055]


portfolio before change:  [6.50791793]
curr_Stock_Price:  102.09050152954514
curr_Factors:  [102.09050153  -1.01348811  -1.03423226]
mat_Sqrt:  [[13.17260535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04161877 -0.008994   -0.20170706]
Stock Position:  -0.04161877496683939
Bond Position:  [10.75679953]


portfolio before change:  [6.4823346]
curr_Stock_Price:  102.73751736177749
curr_Factors:  [102.73751736  -0.9180642   -1.01759564]
mat_Sqrt:  [[14.82800357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082818  0.01228053 -0.04308976]
Stock Position:  0.0008281784435132185
Bond Position:  [6.39724961]


portfolio before change:  [6.48285586]
curr_Stock_Price:  102.40130397144115
curr_Factors:  [102.40130397  -1.14749218  -0.99547348]
mat_Sqrt:  [[12.01233194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00062876 -0.06973939  0.38497903]
Stock Position:  0.0006287621307556568
Bond Position:  [6.4184698]


portfolio before change:  [6.48313885]
curr_Stock_Price:  101.57527742660977
curr_Factors:  [101.57527743  -1.07901236  -0.95502698]
mat_Sqrt:  [[13.28666406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00542842  0.00225658  0.15019092]
Stock Position:  -0.005428421931078339
Bond Position:  [7.03453231]


portfolio before change:  [6.48620671]
curr_Stock_Price:  101.17212277840864
curr_Factors:  [101.17212278  -1.06615628  -0.97247097]
mat_Sqrt:  [[13.17335197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01555772 -0.01798624  0.85818849]
Stock Position:  0.015557716060558613
Bond Position:  [4.91219955]


portfolio before change:  [6.48052134]
curr_Stock_Price:  100.76721537609698
curr_Factors:  [100.76721538  -0.99393604  -0.96190349]
mat_Sqrt:  [[14.25308714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00673701 0.04967217 0.33077285]
Stock Position:  0.006737014970236394
Bond Position:  [5.8016511]


portfolio before change:  [6.47899514]
curr_Stock_Price:  100.43302304561519
curr_Factors:  [100.43302305  -0.98782186  -0.95768338]
mat_Sqrt:  [[14.35338526  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00334971 -0.03441441 -0.170228  ]
Stock Position:  0.003349708836474129
Bond Position:  [6.14257375]


portfolio before change:  [6.48390359]
curr_Stock_Price:  101.66912557654163
curr_Factors:  [101.66912558  -0.89120538  -0.98908273]
mat_Sqrt:  [[15.50923355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196374  0.01763791  0.13130985]
Stock Position:  -0.001963736335721657
Bond Position:  [6.68355495]


portfolio before change:  [6.48458268]
curr_Stock_Price:  101.74877198055256
curr_Factors:  [101.74877198  -1.0642905   -0.97133679]
mat_Sqrt:  [[13.28824037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03536115 -0.07913114  0.38426156]
Stock Position:  -0.035361153187108196
Bond Position:  [10.08253659]


portfolio before change:  [6.49231471]
curr_Stock_Price:  101.56575675688417
curr_Factors:  [101.56575676  -1.11522594  -0.98606356]
mat_Sqrt:  [[12.42135206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01070781  0.00575926 -0.05231848]
Stock Position:  -0.010707805426812506
Bond Position:  [7.57986107]


portfolio before change:  [6.49504039]
curr_Stock_Price:  101.39969668191607
curr_Factors:  [101.39969668  -1.04169694  -0.98001629]
mat_Sqrt:  [[13.42819867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02844107 0.35627517 1.1590545 ]
Stock Position:  0.02844107103562324
Bond Position:  [3.61112441]


portfolio before change:  [6.49891258]
curr_Stock_Price:  101.51997253789882
curr_Factors:  [101.51997254  -1.04078145  -0.99116135]
mat_Sqrt:  [[13.30729996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00131413 0.00320025 0.08771764]
Stock Position:  0.0013141294915201803
Bond Position:  [6.36550219]


portfolio before change:  [6.49764018]
curr_Stock_Price:  99.94620125436704
curr_Factors:  [99.94620125 -0.78201066 -0.96930695]
mat_Sqrt:  [[17.34517638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00526292  0.07260202 -0.08852382]
Stock Position:  -0.005262917534842178
Bond Position:  [7.02364879]


portfolio before change:  [6.49915917]
curr_Stock_Price:  99.82440933415629
curr_Factors:  [99.82440933 -0.74034755 -0.96127538]
mat_Sqrt:  [[18.20670266  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142716  0.01292901 -0.03780096]
Stock Position:  -0.0014271573097690375
Bond Position:  [6.64162431]


portfolio before change:  [6.50123703]
curr_Stock_Price:  98.9502220209757
curr_Factors:  [98.95022202 -0.79284104 -0.93234839]
mat_Sqrt:  [[17.62692363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00014534 -0.00894962 -0.01410939]
Stock Position:  0.00014534287844976895
Bond Position:  [6.48685532]


portfolio before change:  [6.50215509]
curr_Stock_Price:  99.68745771715021
curr_Factors:  [99.68745772 -0.75568353 -0.9225741 ]
mat_Sqrt:  [[18.61154778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00398224 0.06181197 0.29297006]
Stock Position:  0.00398224328345945
Bond Position:  [6.10517538]


portfolio before change:  [6.50003838]
curr_Stock_Price:  98.96427168675403
curr_Factors:  [98.96427169 -0.84086702 -0.93043994]
mat_Sqrt:  [[16.8348633   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00532014 -0.01975207 -0.09700541]
Stock Position:  -0.005320135039096088
Bond Position:  [7.02654167]


portfolio before change:  [6.50172225]
curr_Stock_Price:  98.81286528740995
curr_Factors:  [98.81286529 -0.69762911 -0.93517493]
mat_Sqrt:  [[19.30615141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00603674 -0.00545051 -0.01222808]
Stock Position:  0.00603674487438586
Bond Position:  [5.9052142]


portfolio before change:  [6.49043678]
curr_Stock_Price:  96.82111737130664
curr_Factors:  [96.82111737 -0.58826538 -0.93691339]
mat_Sqrt:  [[21.06654755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00288195 -0.01971526  0.32639743]
Stock Position:  0.00288194589378442
Bond Position:  [6.21140356]


portfolio before change:  [6.49412705]
curr_Stock_Price:  97.83216916739349
curr_Factors:  [97.83216917 -0.69800618 -0.92767188]
mat_Sqrt:  [[19.25123841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00100155  0.01354371  0.09185947]
Stock Position:  -0.001001550226929108
Bond Position:  [6.59211088]


portfolio before change:  [6.49439182]
curr_Stock_Price:  98.39060066493111
curr_Factors:  [98.39060066 -0.69853322 -0.92992701]
mat_Sqrt:  [[19.30733448  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04157029  0.00645128 -2.48419598]
Stock Position:  -0.04157029159762304
Bond Position:  [10.58451778]


portfolio before change:  [6.55232365]
curr_Stock_Price:  97.02884248496481
curr_Factors:  [97.02884248 -0.63106611 -0.92587738]
mat_Sqrt:  [[20.45167501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00340431 -0.03294961 -0.31250228]
Stock Position:  0.0034043061371843986
Bond Position:  [6.22200777]


portfolio before change:  [6.55341303]
curr_Stock_Price:  97.12036849635162
curr_Factors:  [97.1203685  -0.57339205 -0.94885554]
mat_Sqrt:  [[21.19369062  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0057226   0.00197351 -0.10557035]
Stock Position:  0.00572259928452098
Bond Position:  [5.99763208]


portfolio before change:  [6.55912945]
curr_Stock_Price:  97.98827311997405
curr_Factors:  [97.98827312 -0.85188433 -0.96316183]
mat_Sqrt:  [[15.95546893  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141256  0.04049941 -0.07460982]
Stock Position:  0.0014125569017826214
Bond Position:  [6.42071544]


portfolio before change:  [6.55985281]
curr_Stock_Price:  97.93214810767715
curr_Factors:  [97.93214811 -0.68460953 -0.96083925]
mat_Sqrt:  [[18.89365402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00764938 -0.00165861 -0.44953458]
Stock Position:  -0.007649384687243101
Bond Position:  [7.30897349]


portfolio before change:  [6.55435026]
curr_Stock_Price:  98.7709392495383
curr_Factors:  [98.77093925 -0.61020164 -0.95264294]
mat_Sqrt:  [[20.69638082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0021828   0.01657659  0.2332352 ]
Stock Position:  -0.0021828012455215175
Bond Position:  [6.76994758]


portfolio before change:  [6.55549726]
curr_Stock_Price:  98.63317751757121
curr_Factors:  [98.63317752 -0.60728791 -0.94777123]
mat_Sqrt:  [[20.82904806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035422  0.00163596  0.18137556]
Stock Position:  -0.00035422308379620926
Bond Position:  [6.59043541]


portfolio before change:  [6.55558511]
curr_Stock_Price:  100.71097453475298
curr_Factors:  [100.71097453  -0.74309939  -0.96672569]
mat_Sqrt:  [[18.21835667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00134545 0.00777784 0.21633947]
Stock Position:  0.001345449762280439
Bond Position:  [6.42008355]


portfolio before change:  [6.55689823]
curr_Stock_Price:  101.09044868329119
curr_Factors:  [101.09044868  -0.68907854  -0.95601548]
mat_Sqrt:  [[19.50989218  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091783 -0.00283817 -0.13471167]
Stock Position:  -0.0009178332898770273
Bond Position:  [6.64968241]


portfolio before change:  [6.55804219]
curr_Stock_Price:  100.74975844932351
curr_Factors:  [100.74975845  -0.44098452  -0.96612301]
mat_Sqrt:  [[24.66862702  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00274794  0.02407987 -0.01389573]
Stock Position:  -0.002747944771746919
Bond Position:  [6.83489697]


portfolio before change:  [6.56042951]
curr_Stock_Price:  100.19192294191053
curr_Factors:  [100.19192294  -0.1854479   -0.95118867]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.56042951]
Stock Price:  100.07284449466411
PL:  [6.48758502]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-7.55505820e-02  9.56559124e-02  7.63301425e-02]
 [-5.89795575e-02  4.45236065e-02  5.03028254e-02]
 [ 3.37778904e-01 -6.97259196e-01 -1.20078782e+00]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.15436491e+00 -3.40136313e-01  2.44438774e-02]
 [-6.94915222e-02  2.89268305e-02  7.56059398e-02]
 [ 1.36168664e-02  1.28543586e-01  4.72161539e-02]
 [ 3.12792555e-01 -5.60921401e-02 -7.20613628e-02]
 [-5.04584610e-01 -2.77404214e-02 -6.09901939e-02]
 [ 2.19951862e-02  2.58644206e-02 -2.11824665e-02]
 [-1.28574726e-02 -2.22293813e-01  1.33274149e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.08207886e-01 -2.27270751e-02  2.73119155e-01]
 [ 4.42226427e-02  2.35118353e-01  1.87179349e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-2.93008336e-02  2.59297754e-02  4.13944908e-02]
 [-5.03624466e-01 -2.55046297e-01  1.40027603e-01]
 [-1.25902328e-01  1.84611844e-02 -2.15283579e-02]
 [ 2.67221089e-01  1.19347932e+00  3.59392657e-01]
 [-4.50111380e-03  2.55730229e-02  2.84471427e-02]
 [-4.35712153e-02 -6.25101463e-02 -1.45091413e-04]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 7.60120414e-02 -3.66364416e-02  9.72819728e-02]
 [ 7.88190994e-02  3.59399905e-02 -1.13019781e-02]
 [-6.17069616e-02 -1.57016492e-01  8.73540713e-02]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [-1.42816443e-02 -7.76605121e-02  3.59859619e-02]
 [ 2.71583383e-02  5.59840144e-02 -7.14976651e-02]
 [-5.42269570e-01 -2.22892795e-02 -7.96023202e-01]
 [-2.51841731e-01  1.27930887e-01 -2.48273635e-02]
 [ 3.09831300e-03 -5.25640260e-03  1.11357930e-01]
 [ 7.52695073e-03  3.51831475e-02  2.99273825e-02]
 [-1.43108911e-01 -1.45613937e-02 -1.32981870e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 1.92510883e-01 -1.67211673e-01 -8.74896537e-02]
 [-1.28086429e-02  1.76739694e-01  8.09371883e-02]
 [ 3.04680008e-02  3.03051976e-02 -4.21429919e-02]
 [-5.99926859e-02  9.71435809e-02 -6.34735366e-03]
 [-7.68288276e-02 -2.65589240e-01  1.00901789e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.41719259]
curr_Stock_Price:  100.97941085763553
curr_Factors:  [100.97941086  -0.83582264  -1.01818195]
mat_Sqrt:  [[15.81425985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00363595  0.03024906  0.21774865]
Stock Position:  -0.003635954664129585
Bond Position:  [9.78434915]


portfolio before change:  [9.41370416]
curr_Stock_Price:  102.27523195718814
curr_Factors:  [102.27523196  -1.11741183  -1.00852284]
mat_Sqrt:  [[12.20362288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389736  0.0140796   0.14349996]
Stock Position:  -0.003897362459169357
Bond Position:  [9.81230781]


portfolio before change:  [9.41159359]
curr_Stock_Price:  103.13150001979714
curr_Factors:  [103.13150002  -1.24967251  -1.0099077 ]
mat_Sqrt:  [[10.76634064  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00693513 -0.22049272 -3.42551342]
Stock Position:  0.006935128982424469
Bond Position:  [8.69636333]


portfolio before change:  [9.40892164]
curr_Stock_Price:  102.58946757956929
curr_Factors:  [102.58946758  -1.19995822  -1.0015069 ]
mat_Sqrt:  [[11.35059484  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00173586 -0.00659539  0.21422481]
Stock Position:  0.0017358609111612839
Bond Position:  [9.23084059]


portfolio before change:  [9.40808176]
curr_Stock_Price:  101.44087385416142
curr_Factors:  [101.44087385  -1.2721937   -0.98320632]
mat_Sqrt:  [[10.63420912  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10890867 -0.10756055  0.06973158]
Stock Position:  -0.10890867313669071
Bond Position:  [20.45587274]


portfolio before change:  [9.42811017]
curr_Stock_Price:  101.28045265160921
curr_Factors:  [101.28045265  -1.38568506  -0.96990687]
mat_Sqrt:  [[ 9.60516997  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00555031  0.00914747  0.2156827 ]
Stock Position:  -0.00555030644948779
Bond Position:  [9.99024772]


portfolio before change:  [9.42748052]
curr_Stock_Price:  101.61890398734927
curr_Factors:  [101.61890399  -1.32147155  -0.98288009]
mat_Sqrt:  [[10.1439548   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00261967 0.04064905 0.13469454]
Stock Position:  0.002619669058762888
Bond Position:  [9.16127262]


portfolio before change:  [9.4274358]
curr_Stock_Price:  101.1646666937907
curr_Factors:  [101.16466669  -1.02029242  -0.97782345]
mat_Sqrt:  [[13.71696905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02162539 -0.01773789 -0.20557101]
Stock Position:  0.021625389494248123
Bond Position:  [7.23971048]


portfolio before change:  [9.43898164]
curr_Stock_Price:  101.65671876736786
curr_Factors:  [101.65671877  -0.87240325  -0.98605359]
mat_Sqrt:  [[15.84960854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03266645 -0.00877229 -0.17398805]
Stock Position:  -0.032666449417981774
Bond Position:  [12.7597457]


portfolio before change:  [9.41723921]
curr_Stock_Price:  102.37113663835085
curr_Factors:  [102.37113664  -0.86933452  -1.02079818]
mat_Sqrt:  [[15.4633406   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118598  0.00817905 -0.06042768]
Stock Position:  0.0011859759333375072
Bond Position:  [9.2958295]


portfolio before change:  [9.41838759]
curr_Stock_Price:  102.35960935983584
curr_Factors:  [102.35960936  -1.09437158  -1.03904635]
mat_Sqrt:  [[12.12263382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071003 -0.07029548  0.38019405]
Stock Position:  0.0007100270235750491
Bond Position:  [9.3457095]


portfolio before change:  [9.41917141]
curr_Stock_Price:  101.81812456660144
curr_Factors:  [101.81812457  -1.09276753  -1.08323724]
mat_Sqrt:  [[11.55575239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00624153  0.00225658  0.15019092]
Stock Position:  -0.006241533754829085
Bond Position:  [10.05467267]


portfolio before change:  [9.41952456]
curr_Stock_Price:  101.96292276304804
curr_Factors:  [101.96292276  -1.03811854  -1.10727806]
mat_Sqrt:  [[11.93186607  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01369202 -0.00718693  0.77913293]
Stock Position:  0.013692015005726425
Bond Position:  [8.02344669]


portfolio before change:  [9.42974691]
curr_Stock_Price:  102.63626157368552
curr_Factors:  [102.63626157  -1.1867654   -1.13271398]
mat_Sqrt:  [[10.09168599  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00876971 0.07435095 0.53397058]
Stock Position:  0.008769713716593495
Bond Position:  [8.52965628]


portfolio before change:  [9.43022552]
curr_Stock_Price:  102.56925087759767
curr_Factors:  [102.56925088  -1.08654118  -1.12696361]
mat_Sqrt:  [[11.21254675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0038284  -0.03587186 -0.12433753]
Stock Position:  0.0038284017511478496
Bond Position:  [9.03754922]


portfolio before change:  [9.42836884]
curr_Stock_Price:  101.78917500986489
curr_Factors:  [101.78917501  -0.83192363  -1.14636905]
mat_Sqrt:  [[14.07796879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143357  0.00819971  0.11808696]
Stock Position:  -0.0014335672200421748
Bond Position:  [9.57429047]


portfolio before change:  [9.42933328]
curr_Stock_Price:  101.9513066118972
curr_Factors:  [101.95130661  -1.14487934  -1.14283927]
mat_Sqrt:  [[10.3478287   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04654375 -0.08065272  0.39945977]
Stock Position:  -0.04654374673125258
Bond Position:  [14.17452907]


portfolio before change:  [9.44785198]
curr_Stock_Price:  101.59149947740705
curr_Factors:  [101.59149948  -1.22526434  -1.17657838]
mat_Sqrt:  [[ 9.19920574  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0141121   0.00583794 -0.06141441]
Stock Position:  -0.01411210090045275
Bond Position:  [10.88152147]


portfolio before change:  [9.4595298]
curr_Stock_Price:  100.86038602035272
curr_Factors:  [100.86038602  -0.67703787  -1.21777764]
mat_Sqrt:  [[15.16396257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0244921  0.3774113  1.02524722]
Stock Position:  0.02449210153441208
Bond Position:  [6.98924698]


portfolio before change:  [9.48924308]
curr_Stock_Price:  102.03789093549165
curr_Factors:  [102.03789094  -0.94269771  -1.21164583]
mat_Sqrt:  [[11.8342832   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00016612 0.0080869  0.08115178]
Stock Position:  0.0001661213826052354
Bond Position:  [9.4722924]


portfolio before change:  [9.49041118]
curr_Stock_Price:  101.94152422302177
curr_Factors:  [101.94152422  -0.69267366  -1.22275677]
mat_Sqrt:  [[15.01378725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00301155 -0.01976744 -0.00041391]
Stock Position:  -0.0030115543992472607
Bond Position:  [9.79741363]


portfolio before change:  [9.49163394]
curr_Stock_Price:  101.94218644707178
curr_Factors:  [101.94218645  -1.03693777  -1.24643506]
mat_Sqrt:  [[10.39196622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374028  0.01916992 -0.08961985]
Stock Position:  -0.003740280026394427
Bond Position:  [9.87292627]


portfolio before change:  [9.4941853]
curr_Stock_Price:  101.59003050816285
curr_Factors:  [101.59003051  -1.09723975  -1.20758756]
mat_Sqrt:  [[10.13624984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00936477 -0.01158546  0.27751839]
Stock Position:  0.00936477430355456
Bond Position:  [8.54281759]


portfolio before change:  [9.49865926]
curr_Stock_Price:  101.95373905080027
curr_Factors:  [101.95373905  -1.16088305  -1.21207159]
mat_Sqrt:  [[ 9.50259131  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00814936  0.01136522 -0.0322414 ]
Stock Position:  0.008149362304105108
Bond Position:  [8.66780131]


portfolio before change:  [9.49701451]
curr_Stock_Price:  101.6189520094719
curr_Factors:  [101.61895201  -1.01737518  -1.2207705 ]
mat_Sqrt:  [[10.83828063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00442229 -0.04965297  0.24919685]
Stock Position:  -0.004422291364375872
Bond Position:  [9.94640312]


portfolio before change:  [9.49735418]
curr_Stock_Price:  101.82330382394123
curr_Factors:  [101.82330382  -1.01179579  -1.23173942]
mat_Sqrt:  [[10.80170272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00119945  0.02004328 -0.05140267]
Stock Position:  0.0011994482010681002
Bond Position:  [9.3752224]


portfolio before change:  [9.49942548]
curr_Stock_Price:  102.57308604813952
curr_Factors:  [102.57308605  -1.18009901  -1.2276184 ]
mat_Sqrt:  [[ 9.23368466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096833 -0.02455841  0.10265793]
Stock Position:  -0.0009683270292012411
Bond Position:  [9.59874977]


portfolio before change:  [9.5003314]
curr_Stock_Price:  102.87670088206383
curr_Factors:  [102.87670088  -1.36506659  -1.24391661]
mat_Sqrt:  [[ 7.57268727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185     0.0177037  -0.20396294]
Stock Position:  0.0018499957866586092
Bond Position:  [9.31000994]


portfolio before change:  [9.5008825]
curr_Stock_Price:  102.54549541486085
curr_Factors:  [102.54549541  -1.22609358  -1.23670448]
mat_Sqrt:  [[ 8.73648992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0807341  -0.00704849 -2.27083262]
Stock Position:  -0.08073409795721963
Bond Position:  [17.77980057]


portfolio before change:  [9.47596558]
curr_Stock_Price:  102.8816548258943
curr_Factors:  [102.88165483  -1.22206155  -1.22998664]
mat_Sqrt:  [[ 8.85986172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0286242   0.0404553  -0.07082556]
Stock Position:  -0.02862419778540441
Bond Position:  [12.42087042]


portfolio before change:  [9.46781667]
curr_Stock_Price:  103.22058545220152
curr_Factors:  [103.22058545  -0.82695007  -1.25831026]
mat_Sqrt:  [[12.82771391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00200296 -0.00166222  0.31767318]
Stock Position:  0.0020029629397594647
Bond Position:  [9.26106967]


portfolio before change:  [9.46825175]
curr_Stock_Price:  102.85980450260433
curr_Factors:  [102.8598045   -1.20040172  -1.25108174]
mat_Sqrt:  [[ 8.86298378  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00164101 0.01112589 0.08537449]
Stock Position:  0.0016410136159361835
Bond Position:  [9.29945741]


portfolio before change:  [9.46926934]
curr_Stock_Price:  102.77149720660988
curr_Factors:  [102.77149721  -1.09756256  -1.26244216]
mat_Sqrt:  [[ 9.70366191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01758405 -0.00460472 -0.37936026]
Stock Position:  -0.01758405195261915
Bond Position:  [11.27640869]


portfolio before change:  [9.47194631]
curr_Stock_Price:  102.69942440797057
curr_Factors:  [102.69942441  -0.88666911  -1.24327212]
mat_Sqrt:  [[12.20523894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429436  0.0049611   0.16678008]
Stock Position:  -0.004294361118082211
Bond Position:  [9.91297473]


portfolio before change:  [9.46930527]
curr_Stock_Price:  103.60299012831642
curr_Factors:  [103.60299013  -0.7429433   -1.25493979]
mat_Sqrt:  [[14.05085288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01212273 -0.05287697 -0.24958363]
Stock Position:  0.012122733557565943
Bond Position:  [8.21335383]


portfolio before change:  [9.47739057]
curr_Stock_Price:  104.1852484870227
curr_Factors:  [104.18524849  -0.97020526  -1.24317913]
mat_Sqrt:  [[11.39057391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00072656 0.05589    0.23089127]
Stock Position:  0.0007265648606902908
Bond Position:  [9.40169323]


portfolio before change:  [9.47848745]
curr_Stock_Price:  104.07734321443523
curr_Factors:  [104.07734321  -0.93110315  -1.26387574]
mat_Sqrt:  [[11.59014782  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00195408  0.00958334 -0.12022223]
Stock Position:  0.00195407994349886
Bond Position:  [9.275112]


portfolio before change:  [9.47938967]
curr_Stock_Price:  103.94569706031946
curr_Factors:  [103.94569706  -0.93143502  -1.27701157]
mat_Sqrt:  [[11.4206375   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00514683  0.0307195  -0.01810723]
Stock Position:  -0.005146831561405133
Bond Position:  [10.01438066]


portfolio before change:  [9.48130574]
curr_Stock_Price:  103.8166470228529
curr_Factors:  [103.81664702  -1.06901816  -1.25246617]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.48130574]
Stock Price:  102.7730813733093
PL:  [6.70822437]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.53702748e-01  1.80399260e-01  2.13478989e-01]
 [-8.74022774e-02  5.01778334e-02  8.12922013e-02]
 [ 1.59696167e-01 -1.33514384e-02 -1.98560121e-02]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-9.94904772e-01 -2.94967364e-01  2.83406735e-02]
 [-3.59745301e-02 -3.53639007e-02 -2.18917548e-02]
 [ 7.22189802e-03  1.49176772e-01  6.52241134e-02]
 [ 3.83553436e-01  2.62913392e-02 -1.06956726e-01]
 [-5.24770530e-01 -3.10489201e-02 -5.60401589e-02]
 [ 1.66043647e-02  3.50228467e-02 -1.68908826e-02]
 [-4.08639530e-02 -1.49540493e-01  8.95202068e-02]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.30768372e-01 -4.30417555e-02  2.90103305e-01]
 [ 1.06905510e-02  3.73987090e-01  3.18791866e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-9.10368921e-03 -2.43414610e-02  3.35872482e-02]
 [-6.56930560e-01 -3.02744115e-01  2.03216924e-01]
 [-1.24454126e-01  1.85552677e-02 -2.27340839e-02]
 [ 3.12378744e-01  1.12191473e+00  5.98490181e-01]
 [-2.01740483e-02  4.12481515e-02  2.61124336e-02]
 [-2.07450998e-02 -1.33280963e-01  7.77087934e-03]
 [-3.05623653e-02  5.49040122e-02 -2.60154784e-02]
 [ 5.84665771e-02 -3.43782015e-02  7.82588351e-02]
 [ 6.35020080e-02  1.54581732e-01  5.89680498e-02]
 [-5.70497375e-02 -1.89316802e-01  5.05804484e-03]
 [ 7.49254945e-02  2.43509180e-02 -1.33109976e-02]
 [-6.35796418e-03 -2.05550471e-02 -3.76780404e-02]
 [ 7.47799465e-03  4.14210997e-02 -4.37933507e-02]
 [-5.74749953e-01  3.16156777e-02 -7.88603705e-01]
 [-1.43068060e-01 -4.73903098e-02  8.03746108e-03]
 [-9.02798921e-02  9.22946337e-02  2.11615573e-01]
 [ 7.56203945e-03  9.57037397e-03  3.08355423e-02]
 [-1.25075857e-01 -9.40315249e-03 -1.44121140e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 1.14748590e-01 -9.54157728e-02 -1.64826972e-02]
 [-1.11660299e-02 -1.18159470e-02  6.56637047e-02]
 [ 3.02026098e-02  1.65809759e-02 -1.69506772e-02]
 [-1.11583343e-01  5.42034045e-02  3.45700857e-03]
 [ 2.36031836e-03 -2.58702351e-01  8.98250854e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.03265931]
curr_Stock_Price:  99.38410338490009
curr_Factors:  [99.38410338 -1.02891784 -0.99572004]
mat_Sqrt:  [[13.12284087  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00803703  0.05704726  0.60899614]
Stock Position:  -0.00803702826367144
Bond Position:  [-1.23390646]


portfolio before change:  [-2.02952002]
curr_Stock_Price:  98.97430842260671
curr_Factors:  [98.97430842 -1.19639406 -1.00156877]
mat_Sqrt:  [[10.98902977  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00632567  0.01586762  0.23190402]
Stock Position:  -0.006325671299875751
Bond Position:  [-1.40344108]


portfolio before change:  [-2.03560867]
curr_Stock_Price:  99.90910434573132
curr_Factors:  [99.90910435 -1.48114156 -1.00822897]
mat_Sqrt:  [[ 8.28867639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01873621 -0.0042221  -0.05664368]
Stock Position:  0.0187362053045495
Bond Position:  [-3.90752617]


portfolio before change:  [-2.02838617]
curr_Stock_Price:  100.32065921090938
curr_Factors:  [100.32065921  -1.48505678  -1.01431928]
mat_Sqrt:  [[ 8.23996079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239116 -0.00659539  0.21422481]
Stock Position:  0.0023911586979719233
Bond Position:  [-2.26826879]


portfolio before change:  [-2.02788462]
curr_Stock_Price:  100.64899304305665
curr_Factors:  [100.64899304  -1.23507621  -0.9872782 ]
mat_Sqrt:  [[10.90569073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09139593 -0.09327687  0.08084805]
Stock Position:  -0.09139593310075195
Bond Position:  [7.17102401]


portfolio before change:  [-2.0011394]
curr_Stock_Price:  100.36617100345234
curr_Factors:  [100.366171    -1.21968728  -0.98815008]
mat_Sqrt:  [[11.03407099  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374805 -0.01118305 -0.06245108]
Stock Position:  -0.0037480507325492714
Bond Position:  [-1.6249619]


portfolio before change:  [-2.00731064]
curr_Stock_Price:  101.95849264181297
curr_Factors:  [101.95849264  -1.45274318  -1.00343622]
mat_Sqrt:  [[ 8.74416303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.002789   0.04717384 0.18606624]
Stock Position:  0.0027889967304834313
Bond Position:  [-2.29167254]


portfolio before change:  [-2.00879164]
curr_Stock_Price:  101.5301950725578
curr_Factors:  [101.53019507  -1.49698031  -1.00659656]
mat_Sqrt:  [[ 8.30434917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04363976  0.00831405 -0.30511777]
Stock Position:  0.04363976242363547
Bond Position:  [-6.43954523]


portfolio before change:  [-2.01479698]
curr_Stock_Price:  101.41102966765469
curr_Factors:  [101.41102967  -1.55435805  -1.00310184]
mat_Sqrt:  [[ 7.85949193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06832647 -0.00981853 -0.15986697]
Stock Position:  -0.06832647254714941
Bond Position:  [4.91426095]


portfolio before change:  [-2.00467253]
curr_Stock_Price:  101.27184309179205
curr_Factors:  [101.27184309  -1.68698872  -1.01391145]
mat_Sqrt:  [[ 6.79990233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0020678   0.0110752  -0.04818499]
Stock Position:  0.0020677964288020687
Bond Position:  [-2.21408209]


portfolio before change:  [-2.00422082]
curr_Stock_Price:  101.6241465606766
curr_Factors:  [101.62414656  -1.729194    -1.01205666]
mat_Sqrt:  [[ 6.55370478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403617 -0.04728886  0.25537623]
Stock Position:  -0.004036165367964563
Bond Position:  [-1.59404896]


portfolio before change:  [-2.00635356]
curr_Stock_Price:  102.10318314892014
curr_Factors:  [102.10318315  -2.02592876  -1.01746099]
mat_Sqrt:  [[ 4.86756666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01481759  0.00225658  0.15019092]
Stock Position:  -0.01481759238153952
Bond Position:  [-0.49343021]


portfolio before change:  [-2.01309121]
curr_Stock_Price:  102.55372654382809
curr_Factors:  [102.55372654  -2.0779766   -1.03522574]
mat_Sqrt:  [[ 4.55937014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04142549 -0.013611    0.82758398]
Stock Position:  0.0414254867697435
Bond Position:  [-6.26142925]


portfolio before change:  [-2.00956522]
curr_Stock_Price:  102.65773778687094
curr_Factors:  [102.65773779  -2.12347471  -1.0377598 ]
mat_Sqrt:  [[ 4.34995723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01963697 0.1182651  0.90942446]
Stock Position:  0.019636968565373045
Bond Position:  [-4.02545199]


portfolio before change:  [-2.00636862]
curr_Stock_Price:  102.84614814415045
curr_Factors:  [102.84614814  -2.08645375  -1.03703516]
mat_Sqrt:  [[ 4.52557779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00948523 -0.03587186 -0.12433753]
Stock Position:  0.009485227224976736
Bond Position:  [-2.98188771]


portfolio before change:  [-2.00220924]
curr_Stock_Price:  103.32395891289336
curr_Factors:  [103.32395891  -2.11125306  -1.04082234]
mat_Sqrt:  [[ 4.41847177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00065095 -0.00769745  0.09581507]
Stock Position:  -0.0006509523795094713
Bond Position:  [-1.93495026]


portfolio before change:  [-2.00236326]
curr_Stock_Price:  103.18897495561421
curr_Factors:  [103.18897496  -2.07913896  -1.01627384]
mat_Sqrt:  [[ 4.66995399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.13346296 -0.0957361   0.57972132]
Stock Position:  -0.13346296339964486
Bond Position:  [11.76954313]


portfolio before change:  [-2.02264745]
curr_Stock_Price:  103.35198259550263
curr_Factors:  [103.3519826   -2.06661158  -1.02475736]
mat_Sqrt:  [[ 4.69628385  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02738668  0.00586769 -0.06485401]
Stock Position:  -0.027386676498692166
Bond Position:  [0.80781986]


portfolio before change:  [-2.02901567]
curr_Stock_Price:  103.58819983712227
curr_Factors:  [103.58819984  -1.9289635   -1.01109805]
mat_Sqrt:  [[ 5.47592863  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08464551 0.35478059 1.7073259 ]
Stock Position:  0.08464550687921396
Bond Position:  [-10.79729136]


portfolio before change:  [-2.05891241]
curr_Stock_Price:  103.25094638635926
curr_Factors:  [103.25094639  -1.51281736  -1.02231213]
mat_Sqrt:  [[ 8.18278789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168388  0.01304381  0.0744915 ]
Stock Position:  -0.0016838817729077173
Bond Position:  [-1.88505002]


portfolio before change:  [-2.0574346]
curr_Stock_Price:  102.23338496617595
curr_Factors:  [102.23338497  -1.35865978  -1.04859414]
mat_Sqrt:  [[ 9.20737108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245457 -0.04214714  0.02216816]
Stock Position:  -0.0024545741821587583
Bond Position:  [-1.80649517]


portfolio before change:  [-2.05524399]
curr_Stock_Price:  101.24892012220894
curr_Factors:  [101.24892012  -1.13134962  -1.03761744]
mat_Sqrt:  [[11.57230783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297738  0.01736217 -0.07421492]
Stock Position:  -0.002977378202151266
Bond Position:  [-1.75378766]


portfolio before change:  [-2.05523565]
curr_Stock_Price:  101.17248530930539
curr_Factors:  [101.17248531  -1.17704323  -1.02378975]
mat_Sqrt:  [[11.20089692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00656675 -0.01087134  0.22325067]
Stock Position:  0.0065667467674567805
Bond Position:  [-2.71960974]


portfolio before change:  [-2.05854062]
curr_Stock_Price:  100.72096791098517
curr_Factors:  [100.72096791  -1.08003725  -1.01388862]
mat_Sqrt:  [[12.40907583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00640903 0.04888304 0.16821943]
Stock Position:  0.006409026340694217
Bond Position:  [-2.70406396]


portfolio before change:  [-2.05943184]
curr_Stock_Price:  100.63465443409868
curr_Factors:  [100.63465443  -0.83524329  -1.00490703]
mat_Sqrt:  [[15.98013441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00381132 -0.05986723  0.01442919]
Stock Position:  -0.0038113200827982027
Bond Position:  [-1.67588096]


portfolio before change:  [-2.05771765]
curr_Stock_Price:  100.12992423164366
curr_Factors:  [100.12992423  -0.96940197  -1.00385686]
mat_Sqrt:  [[13.91837279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00523316  0.00770044 -0.03797257]
Stock Position:  0.005233164646802641
Bond Position:  [-2.58171402]


portfolio before change:  [-2.05585324]
curr_Stock_Price:  100.54786315578026
curr_Factors:  [100.54786316  -1.09453326  -1.01348874]
mat_Sqrt:  [[12.21435462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00119365 -0.00650008 -0.10748496]
Stock Position:  -0.0011936521781600227
Bond Position:  [-1.93583406]


portfolio before change:  [-2.05526108]
curr_Stock_Price:  99.84904180188626
curr_Factors:  [99.8490418  -1.10591436 -1.03219731]
mat_Sqrt:  [[11.76992796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.32880061e-05  1.30985018e-02 -1.24930240e-01]
Stock Position:  -3.3288006119324086e-05
Bond Position:  [-2.05193731]


portfolio before change:  [-2.05551971]
curr_Stock_Price:  99.91280198998287
curr_Factors:  [99.91280199 -1.09202868 -1.05938768]
mat_Sqrt:  [[11.6217863   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06323526  0.00999776 -2.24966687]
Stock Position:  -0.0632352615661226
Bond Position:  [4.26249246]


portfolio before change:  [-2.09540962]
curr_Stock_Price:  100.55204577776189
curr_Factors:  [100.55204578  -1.12540676  -1.0689567 ]
mat_Sqrt:  [[11.20446093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01273163 -0.01498613  0.02292864]
Stock Position:  -0.0127316283841105
Bond Position:  [-0.81521834]


portfolio before change:  [-2.09275983]
curr_Stock_Price:  100.33591518735548
curr_Factors:  [100.33591519  -1.24201915  -1.08069492]
mat_Sqrt:  [[ 9.83364471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454572  0.02918613  0.60368033]
Stock Position:  -0.004545721172697372
Bond Position:  [-1.63666074]


portfolio before change:  [-2.09647528]
curr_Stock_Price:  101.10825791790845
curr_Factors:  [101.10825792  -1.32159526  -1.09837623]
mat_Sqrt:  [[ 8.99096617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00156862 0.00302642 0.08796522]
Stock Position:  0.0015686216464686873
Bond Position:  [-2.25507588]


portfolio before change:  [-2.09724313]
curr_Stock_Price:  100.79846298480574
curr_Factors:  [100.79846298  -1.13775229  -1.09802823]
mat_Sqrt:  [[10.77622791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01435913 -0.00297354 -0.4111375 ]
Stock Position:  -0.014359129296507536
Bond Position:  [-0.64986497]


portfolio before change:  [-2.08812027]
curr_Stock_Price:  100.15747015975015
curr_Factors:  [100.15747016  -0.81978838  -1.10260686]
mat_Sqrt:  [[14.64865332  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357806  0.0049611   0.16678008]
Stock Position:  -0.0035780561123140674
Bond Position:  [-1.72975122]


portfolio before change:  [-2.08752349]
curr_Stock_Price:  99.93024824623457
curr_Factors:  [99.93024825 -0.94203358 -1.12308204]
mat_Sqrt:  [[12.67151812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00859569 -0.03017312 -0.04702055]
Stock Position:  0.008595690612485324
Bond Position:  [-2.94649299]


portfolio before change:  [-2.09282059]
curr_Stock_Price:  99.35684893706481
curr_Factors:  [99.35684894 -0.6599262  -1.11224284]
mat_Sqrt:  [[16.88708055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.14432527e-04 -3.73653053e-03  1.87320272e-01]
Stock Position:  0.00011443252658056858
Bond Position:  [-2.10419024]


portfolio before change:  [-2.09314974]
curr_Stock_Price:  98.77908902756346
curr_Factors:  [98.77908903 -0.69751534 -1.09425744]
mat_Sqrt:  [[16.4629623   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165041  0.00524336 -0.04835556]
Stock Position:  0.001650412954781135
Bond Position:  [-2.25617603]


portfolio before change:  [-2.09371059]
curr_Stock_Price:  98.61015638519758
curr_Factors:  [98.61015639 -0.63437274 -1.08343973]
mat_Sqrt:  [[17.69640984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00618646  0.01714062  0.00986188]
Stock Position:  -0.006186461515553624
Bond Position:  [-1.48366265]


portfolio before change:  [-2.09412087]
curr_Stock_Price:  98.64649509867975
curr_Factors:  [98.6464951  -0.48875521 -1.06943963]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.09412087]
Stock Price:  99.84643689502485
PL:  [-2.09412087]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.22585529e-02 -2.70947589e-03  1.41441882e-02]
 [ 2.44482747e-03 -4.26601190e-02 -1.25477126e-01]
 [ 3.48644410e-01  2.64673863e-01  3.13505346e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-8.24061032e-01 -2.41671109e-01  5.49326369e-03]
 [-5.59503300e-02  2.95274705e-03  3.62159188e-02]
 [ 1.25440792e-02  1.35182092e-01  5.73052025e-02]
 [ 3.22616686e-01 -5.39783046e-02 -7.59730757e-02]
 [-5.09875787e-01 -2.77043501e-02 -6.34960822e-02]
 [ 2.66941044e-02  1.78814639e-02 -2.49232325e-02]
 [-4.32400139e-03 -2.44964132e-01  1.35717171e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.47342434e-01 -5.97148149e-02  3.00150070e-01]
 [ 8.22819732e-02  7.78662417e-02  3.81901565e-02]
 [ 6.90467793e-03 -7.25251679e-02 -3.19960636e-02]
 [-5.08351140e-02  7.95291795e-02  4.97186058e-02]
 [-4.55969352e-01 -2.43276908e-01  1.20712285e-01]
 [-1.45462503e-01 -2.06259520e-03 -1.34649958e-02]
 [ 2.98214220e-01  1.26725372e+00  4.34175423e-01]
 [-1.13384218e-01 -1.64570206e-02  1.02550621e-01]
 [-9.51532152e-02  2.85292322e-01 -3.01624649e-02]
 [-2.82594874e-02  4.85800477e-02 -2.03646960e-02]
 [-1.02855300e-02 -2.60870164e-02 -2.39107158e-02]
 [ 5.65746656e-02  1.95874973e-01  8.65006081e-02]
 [-5.90372412e-02 -1.82748245e-01 -4.21537867e-02]
 [ 1.74290496e-02  6.26628459e-02 -1.66002731e-02]
 [ 3.32668617e-02 -6.66631900e-02  9.76395307e-02]
 [ 2.10194591e-02  4.24697479e-02 -7.17047424e-02]
 [-6.50556381e-01 -2.42548757e-02 -9.50165689e-01]
 [-4.52808804e-02 -1.13411456e-01 -2.20495116e-02]
 [-9.02798921e-02  9.22946337e-02  2.11615573e-01]
 [ 2.04191974e-02  9.97038022e-02 -1.25302813e-02]
 [-1.01027752e-01  6.63367073e-03 -1.72054478e-01]
 [-6.01616543e-02  1.25612155e-01  1.28178021e-01]
 [-1.68709741e-02 -2.78036966e-03  5.22831816e-02]
 [-1.47589550e-02 -1.24630713e-02  5.91190212e-02]
 [ 7.38628673e-03  9.15234290e-04 -3.34388999e-02]
 [-9.66227645e-02 -1.23483070e-02  1.60194799e-03]
 [-1.06477809e-02 -2.91153706e-01  1.12685552e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.41978837]
curr_Stock_Price:  100.2831226992023
curr_Factors:  [100.2831227   -0.9825995   -1.00246114]
mat_Sqrt:  [[13.77612164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00649249 -0.00085681  0.04034943]
Stock Position:  -0.006492490651318368
Bond Position:  [5.07087561]


portfolio before change:  [4.41296288]
curr_Stock_Price:  101.43204804764436
curr_Factors:  [101.43204805  -0.77441214  -1.01228676]
mat_Sqrt:  [[16.99110888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142837 -0.01349031 -0.35795131]
Stock Position:  -0.0014283684107475598
Bond Position:  [4.55784522]


portfolio before change:  [4.41481986]
curr_Stock_Price:  100.53087498099912
curr_Factors:  [100.53087498  -0.56870877  -0.98725933]
mat_Sqrt:  [[21.21050961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01977662 0.08369722 0.89434349]
Stock Position:  0.019776623886550906
Bond Position:  [2.42665855]


portfolio before change:  [4.43381564]
curr_Stock_Price:  101.4760529301023
curr_Factors:  [101.47605293  -0.65365301  -0.96981033]
mat_Sqrt:  [[20.01254859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098453 -0.00659539  0.21422481]
Stock Position:  0.0009845349690513136
Bond Position:  [4.33390891]


portfolio before change:  [4.43463538]
curr_Stock_Price:  101.75839265349066
curr_Factors:  [101.75839265  -0.76881108  -0.97638555]
mat_Sqrt:  [[17.76809915  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04666676 -0.07642311  0.01567075]
Stock Position:  -0.04666676151129791
Bond Position:  [9.18337002]


portfolio before change:  [4.45279516]
curr_Stock_Price:  101.39385514746913
curr_Factors:  [101.39385515  -0.83216718  -0.95832436]
mat_Sqrt:  [[16.92041614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286527  0.00093374  0.10331394]
Stock Position:  -0.002865269183262475
Bond Position:  [4.74331585]


portfolio before change:  [4.45193614]
curr_Stock_Price:  101.9006028006402
curr_Factors:  [101.9006028   -1.00487642  -0.9494779 ]
mat_Sqrt:  [[14.4348228   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00192118 0.04274833 0.16347579]
Stock Position:  0.001921176427592355
Bond Position:  [4.25616711]


portfolio before change:  [4.45210625]
curr_Stock_Price:  101.71220195147062
curr_Factors:  [101.71220195  -1.04336303  -0.94151697]
mat_Sqrt:  [[13.97496167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02187591 -0.01706944 -0.21673004]
Stock Position:  0.02187591207147251
Bond Position:  [2.22705906]


portfolio before change:  [4.46236786]
curr_Stock_Price:  102.1685583931595
curr_Factors:  [102.16855839  -0.83660497  -0.91437637]
mat_Sqrt:  [[17.73681896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02951782 -0.00876088 -0.18113665]
Stock Position:  -0.029517818007924575
Bond Position:  [7.47816077]


portfolio before change:  [4.46228694]
curr_Stock_Price:  102.20296956608556
curr_Factors:  [102.20296957  -0.97876824  -0.90073547]
mat_Sqrt:  [[15.60290367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141438  0.00565462 -0.07109904]
Stock Position:  0.001414375729088414
Bond Position:  [4.31773354]


portfolio before change:  [4.46250783]
curr_Stock_Price:  101.97752525762321
curr_Factors:  [101.97752526  -1.09493179  -0.92346173]
mat_Sqrt:  [[13.5496258   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125865 -0.07746446  0.38716331]
Stock Position:  0.0012586475623566815
Bond Position:  [4.33415407]


portfolio before change:  [4.46264405]
curr_Stock_Price:  101.65529056843997
curr_Factors:  [101.65529057  -1.03745387  -0.94429683]
mat_Sqrt:  [[14.010918    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00514782  0.00225658  0.15019092]
Stock Position:  -0.005147815338190235
Bond Position:  [4.98594672]


portfolio before change:  [4.46606698]
curr_Stock_Price:  101.11143932050362
curr_Factors:  [101.11143932  -1.05300304  -0.96504855]
mat_Sqrt:  [[13.43914442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01540786 -0.01888348  0.85624461]
Stock Position:  0.015407861872005463
Bond Position:  [2.90815589]


portfolio before change:  [4.44887375]
curr_Stock_Price:  99.97197086051081
curr_Factors:  [99.97197086 -0.98466181 -0.9454389 ]
mat_Sqrt:  [[14.50929019  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00634683 0.02462347 0.10894589]
Stock Position:  0.006346830396231205
Bond Position:  [3.81436861]


portfolio before change:  [4.44610961]
curr_Stock_Price:  99.46132704185544
curr_Factors:  [99.46132704 -0.85315435 -0.97294195]
mat_Sqrt:  [[16.01735143  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.35911903e-05 -2.29344718e-02 -9.12758635e-02]
Stock Position:  -9.359119034090194e-05
Bond Position:  [4.45541831]


portfolio before change:  [4.44652195]
curr_Stock_Price:  101.00654968392396
curr_Factors:  [101.00654968  -0.93201552  -0.98632192]
mat_Sqrt:  [[14.83290349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260454  0.02514933  0.14183334]
Stock Position:  -0.0026045414169931624
Bond Position:  [4.70959769]


portfolio before change:  [4.44689194]
curr_Stock_Price:  101.09053692422506
curr_Factors:  [101.09053692  -0.89652822  -0.94990961]
mat_Sqrt:  [[15.95191187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0274331  -0.07693091  0.34435855]
Stock Position:  -0.02743310312001143
Bond Position:  [7.22011906]


portfolio before change:  [4.4570628]
curr_Stock_Price:  100.75268621939432
curr_Factors:  [100.75268622  -0.87049575  -0.96208783]
mat_Sqrt:  [[16.12039565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00919731 -0.00065225 -0.03841189]
Stock Position:  -0.009197310842453447
Bond Position:  [5.38371658]


portfolio before change:  [4.46399946]
curr_Stock_Price:  100.07165554917336
curr_Factors:  [100.07165555  -0.88364691  -0.99976677]
mat_Sqrt:  [[15.21790666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02757017 0.40074081 1.23858163]
Stock Position:  0.02757016893491313
Bond Position:  [1.70500701]


portfolio before change:  [4.45490734]
curr_Stock_Price:  99.7341437624134
curr_Factors:  [99.73414376 -0.80946904 -1.02989189]
mat_Sqrt:  [[15.84964579  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00585982 -0.00520417  0.29254838]
Stock Position:  -0.005859820450093265
Bond Position:  [5.03933152]


portfolio before change:  [4.45532176]
curr_Stock_Price:  99.77092583990877
curr_Factors:  [99.77092584 -0.72014385 -1.02948979]
mat_Sqrt:  [[17.34394004  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00541653  0.09021735 -0.08604512]
Stock Position:  -0.0054165250949134575
Bond Position:  [4.99573349]


portfolio before change:  [4.45249465]
curr_Stock_Price:  100.40816482682399
curr_Factors:  [100.40816483  -0.78732713  -1.05294391]
mat_Sqrt:  [[15.94224472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195469  0.01536236 -0.05809481]
Stock Position:  -0.001954685972297751
Bond Position:  [4.64876108]


portfolio before change:  [4.45651257]
curr_Stock_Price:  98.6499335208384
curr_Factors:  [98.64993352 -0.82089223 -1.03141235]
mat_Sqrt:  [[15.47572982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102353 -0.00824944 -0.06821062]
Stock Position:  -0.0010235283546008022
Bond Position:  [4.55748357]


portfolio before change:  [4.455379]
curr_Stock_Price:  100.31407186020041
curr_Factors:  [100.31407186  -0.8831516   -1.02835982]
mat_Sqrt:  [[14.83211203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00534577 0.06194111 0.24676216]
Stock Position:  0.005345765875989388
Bond Position:  [3.91912346]


portfolio before change:  [4.45493046]
curr_Stock_Price:  100.13852038590196
curr_Factors:  [100.13852039  -0.9055457   -1.00448426]
mat_Sqrt:  [[14.82810643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00487995 -0.05779007 -0.12025302]
Stock Position:  -0.004879947860301194
Bond Position:  [4.94360122]


portfolio before change:  [4.44863086]
curr_Stock_Price:  101.55607386110418
curr_Factors:  [101.55607386  -0.81855263  -1.03543268]
mat_Sqrt:  [[15.90487688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098451  0.01981573 -0.04735596]
Stock Position:  0.0009845081418354555
Bond Position:  [4.34864808]


portfolio before change:  [4.44815389]
curr_Stock_Price:  100.51942561125934
curr_Factors:  [100.51942561  -0.46408032  -0.99195119]
mat_Sqrt:  [[23.43708236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00219636 -0.02108075  0.2785384 ]
Stock Position:  0.00219635748718557
Bond Position:  [4.2273773]


portfolio before change:  [4.44803888]
curr_Stock_Price:  100.22645517306114
curr_Factors:  [100.22645517  -0.65534279  -0.98919418]
mat_Sqrt:  [[19.35392437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00038645  0.01343011 -0.20455367]
Stock Position:  0.00038645154597890776
Bond Position:  [4.40930621]


portfolio before change:  [4.4483095]
curr_Stock_Price:  99.50043829934174
curr_Factors:  [99.5004383  -0.45069529 -1.0081854 ]
mat_Sqrt:  [[23.13349039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03653294 -0.00767007 -2.71055824]
Stock Position:  -0.03653293921211944
Bond Position:  [8.08335297]


portfolio before change:  [4.4640726]
curr_Stock_Price:  99.09662150663267
curr_Factors:  [99.09662151 -0.62652665 -0.97728383]
mat_Sqrt:  [[19.93117055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026446  -0.03586385 -0.06290112]
Stock Position:  -0.0026446007857158166
Bond Position:  [4.7261436]


portfolio before change:  [4.46258142]
curr_Stock_Price:  99.88387987010773
curr_Factors:  [99.88387987 -0.78405697 -0.97613399]
mat_Sqrt:  [[17.18122726  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260174  0.02918613  0.60368033]
Stock Position:  -0.0026017353870982835
Bond Position:  [4.72245285]


portfolio before change:  [4.46594072]
curr_Stock_Price:  98.81960832930501
curr_Factors:  [98.81960833 -1.0271827  -0.97209588]
mat_Sqrt:  [[13.3834314   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152695  0.03152911 -0.0357454 ]
Stock Position:  0.0015269481337469458
Bond Position:  [4.3150483]


portfolio before change:  [4.46379599]
curr_Stock_Price:  97.06176232279728
curr_Factors:  [97.06176232 -0.91007283 -0.97322479]
mat_Sqrt:  [[14.76190506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00921134  0.00209775 -0.49082354]
Stock Position:  -0.009211341233422828
Bond Position:  [5.35786501]


portfolio before change:  [4.45831385]
curr_Stock_Price:  97.72962576284719
curr_Factors:  [97.72962576 -0.84271754 -0.95285277]
mat_Sqrt:  [[16.22631709  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189532  0.03972205  0.36565622]
Stock Position:  -0.001895324322721322
Bond Position:  [4.64354319]


portfolio before change:  [4.45759656]
curr_Stock_Price:  98.41434572938066
curr_Factors:  [98.41434573 -0.86597001 -0.94762379]
mat_Sqrt:  [[16.04813737  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039073 -0.00087923  0.14914936]
Stock Position:  -0.0003907309006489211
Bond Position:  [4.49605009]


portfolio before change:  [4.4578541]
curr_Stock_Price:  99.19367444308885
curr_Factors:  [99.19367444 -0.80375613 -0.96210929]
mat_Sqrt:  [[16.96595739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0001776  -0.00394117  0.16865011]
Stock Position:  -0.00017759860797735154
Bond Position:  [4.47547076]


portfolio before change:  [4.45828615]
curr_Stock_Price:  99.9110974373549
curr_Factors:  [99.91109744 -0.70699086 -0.98747433]
mat_Sqrt:  [[18.35341337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.18322862e-05  2.89422495e-04 -9.53918739e-02]
Stock Position:  3.183228615736014e-05
Bond Position:  [4.45510575]


portfolio before change:  [4.4588431]
curr_Stock_Price:  99.91199329312084
curr_Factors:  [99.91199329 -0.96467013 -0.9758564 ]
mat_Sqrt:  [[14.35019026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00673264 -0.00390488  0.00456991]
Stock Position:  -0.0067326354843046015
Bond Position:  [5.13151414]


portfolio before change:  [4.4608397]
curr_Stock_Price:  99.7107179919169
curr_Factors:  [99.71071799 -0.96290359 -1.00230853]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.4608397]
Stock Price:  100.28605743792258
PL:  [4.17478226]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-5.68128551e-02 -3.94321736e-02 -5.64022061e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 3.01601726e-01  2.30665101e-01  2.86727284e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-8.68326331e-01 -2.59112540e-01  3.14339254e-02]
 [-6.58192776e-02  2.18829020e-02  6.49237346e-02]
 [ 1.41198629e-02  1.27847634e-01  4.77083521e-02]
 [ 3.09249991e-01 -6.31615167e-02 -7.00196775e-02]
 [-4.84721359e-01 -2.89989993e-02 -4.68538602e-02]
 [ 2.53433569e-02  2.01762386e-02 -2.38479147e-02]
 [-3.23162628e-02 -1.77610258e-01  1.18088954e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.56158320e-01 -7.01289929e-02  2.98880401e-01]
 [ 3.80261982e-02  3.15414686e-01  2.70172927e-01]
 [ 6.31438739e-02 -1.13280195e-01 -4.73716030e-02]
 [-3.23166791e-02  3.34362962e-02  4.25602714e-02]
 [-5.23669304e-01 -2.63206441e-01  1.48495400e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 2.95655399e-01  1.19680181e+00  4.65312323e-01]
 [ 1.19685964e-02  9.10100698e-03  3.09005430e-02]
 [-3.61827745e-02 -1.18963733e-01 -1.35478002e-02]
 [-2.39118473e-02  5.51037266e-02 -2.47684606e-02]
 [ 8.99456013e-02 -3.48825981e-02  1.12473293e-01]
 [ 7.89100572e-02  7.45833658e-02  1.76975874e-03]
 [-5.82890495e-02 -1.45843228e-01  5.90817395e-02]
 [ 1.84657305e-02  6.23560385e-02 -1.59954494e-02]
 [-1.71168811e-02  2.80314959e-03 -4.90968537e-02]
 [ 1.31485173e-03  4.41976088e-02 -6.41182842e-02]
 [-7.04678800e-01 -1.11724184e-01 -1.08674524e+00]
 [-2.16727021e-01  8.99121477e-03  2.21746641e-02]
 [-5.54516949e-02  8.68854282e-02  1.95298131e-01]
 [ 2.77647125e-02  1.54955739e-01 -3.92387843e-02]
 [-1.19749322e-01 -1.52938025e-02 -1.28064603e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 1.80484649e-01 -1.35299005e-01 -3.98471572e-02]
 [ 1.89242440e-03  7.12632006e-02  7.74008152e-02]
 [ 1.17442507e-03  1.99563564e-04 -4.57820482e-02]
 [-6.81717843e-02  7.81430803e-02 -4.98251472e-03]
 [-8.48874395e-02 -1.85498900e-01  4.96622420e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.9777703]
curr_Stock_Price:  100.63952623416428
curr_Factors:  [100.63952623  -1.376593    -0.98980382]
mat_Sqrt:  [[ 9.44181529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00734435 -0.01246955 -0.16089979]
Stock Position:  -0.007344354813324599
Bond Position:  [7.71690269]


portfolio before change:  [6.98378951]
curr_Stock_Price:  99.95130601257627
curr_Factors:  [99.95130601 -0.96866031 -0.95762302]
mat_Sqrt:  [[14.56177285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311645  0.01411938  0.0859571 ]
Stock Position:  -0.003116450400632235
Bond Position:  [7.2952828]


portfolio before change:  [6.98378233]
curr_Stock_Price:  100.2462383511206
curr_Factors:  [100.24623835  -0.89369427  -0.92455853]
mat_Sqrt:  [[16.27087563  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02249943 0.07294271 0.81795313]
Stock Position:  0.02249943050519517
Bond Position:  [4.72829906]


portfolio before change:  [7.00259667]
curr_Stock_Price:  101.05618158785788
curr_Factors:  [101.05618159  -0.81137714  -0.94993685]
mat_Sqrt:  [[17.36336659  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113475 -0.00659539  0.21422481]
Stock Position:  0.0011347484832030011
Bond Position:  [6.88792332]


portfolio before change:  [7.00366138]
curr_Stock_Price:  101.23566760143329
curr_Factors:  [101.2356676   -0.92508221  -0.97206234]
mat_Sqrt:  [[15.18497719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05720128 -0.08193858  0.08967224]
Stock Position:  -0.05720128217959355
Bond Position:  [12.79447137]


portfolio before change:  [6.99050314]
curr_Stock_Price:  101.49366281641392
curr_Factors:  [101.49366282  -1.05782159  -0.95032982]
mat_Sqrt:  [[13.62416356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00381688  0.00691998  0.18520934]
Stock Position:  -0.0038168773748649583
Bond Position:  [7.377892]


portfolio before change:  [6.99081636]
curr_Stock_Price:  101.65323631201497
curr_Factors:  [101.65323631  -1.22149885  -0.96955568]
mat_Sqrt:  [[11.36470891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00238979 0.04042897 0.13609865]
Stock Position:  0.0023897929499210623
Bond Position:  [6.74788617]


portfolio before change:  [6.99084194]
curr_Stock_Price:  101.31096430856944
curr_Factors:  [101.31096431  -0.99021176  -0.97614665]
mat_Sqrt:  [[14.18005253  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02068585 -0.01997343 -0.19974665]
Stock Position:  0.02068585147438709
Bond Position:  [4.89513838]


portfolio before change:  [6.98275682]
curr_Stock_Price:  100.89052976628079
curr_Factors:  [100.89052977  -1.14401067  -0.96634603]
mat_Sqrt:  [[12.22740038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04048564 -0.00917029 -0.13366102]
Stock Position:  -0.04048563874983002
Bond Position:  [11.06737436]


portfolio before change:  [6.96352975]
curr_Stock_Price:  101.39961357156277
curr_Factors:  [101.39961357  -1.35481581  -0.97522042]
mat_Sqrt:  [[ 9.8653937   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00212829  0.00638029 -0.06803146]
Stock Position:  0.002128285051520994
Bond Position:  [6.74772246]


portfolio before change:  [6.96649367]
curr_Stock_Price:  102.39590930242731
curr_Factors:  [102.3959093   -1.50054684  -0.96814511]
mat_Sqrt:  [[ 8.67248021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00147563 -0.0561653   0.33687492]
Stock Position:  -0.0014756255262187376
Bond Position:  [7.11759168]


portfolio before change:  [6.96823429]
curr_Stock_Price:  101.81929494635321
curr_Factors:  [101.81929495  -1.33579716  -0.95484342]
mat_Sqrt:  [[10.30427689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00699958  0.00225658  0.15019092]
Stock Position:  -0.00699958079283249
Bond Position:  [7.68092667]


portfolio before change:  [6.9721298]
curr_Stock_Price:  101.39993592141798
curr_Factors:  [101.39993592  -1.42522304  -0.91450005]
mat_Sqrt:  [[ 9.77032148  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02204189 -0.02217673  0.85262259]
Stock Position:  0.022041885128825628
Bond Position:  [4.73708406]


portfolio before change:  [6.97487878]
curr_Stock_Price:  101.4977862740995
curr_Factors:  [101.49778627  -1.41484349  -0.90652964]
mat_Sqrt:  [[ 9.96086445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01017171 0.09974288 0.77072816]
Stock Position:  0.010171706338557544
Bond Position:  [5.9424731]


portfolio before change:  [6.97643749]
curr_Stock_Price:  101.57799493723057
curr_Factors:  [101.57799494  -1.34457004  -0.91969691]
mat_Sqrt:  [[10.55458095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00478932 -0.03582234 -0.135138  ]
Stock Position:  0.004789323618937952
Bond Position:  [6.4899476]


portfolio before change:  [6.97730768]
curr_Stock_Price:  101.59029071709007
curr_Factors:  [101.59029072  -1.37643102  -0.92701522]
mat_Sqrt:  [[10.15028436  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224287  0.01057349  0.12141261]
Stock Position:  -0.0022428710197458747
Bond Position:  [7.2051616]


portfolio before change:  [6.97775498]
curr_Stock_Price:  101.79243946815528
curr_Factors:  [101.79243947  -1.29428207  -0.95774749]
mat_Sqrt:  [[10.70709149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04671238 -0.08323318  0.42361604]
Stock Position:  -0.04671238398421408
Bond Position:  [11.7327225]


portfolio before change:  [6.98403842]
curr_Stock_Price:  101.68932433176906
curr_Factors:  [101.68932433  -1.25150615  -0.95891762]
mat_Sqrt:  [[11.15065851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01177608  0.00580111 -0.05715682]
Stock Position:  -0.011776083323353174
Bond Position:  [8.18154038]


portfolio before change:  [6.99271185]
curr_Stock_Price:  101.03964500526145
curr_Factors:  [101.03964501  -1.16748626  -0.94283528]
mat_Sqrt:  [[12.24590289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03442279 0.37846196 1.32740654]
Stock Position:  0.03442279208873055
Bond Position:  [3.51464516]


portfolio before change:  [7.0063586]
curr_Stock_Price:  101.4233266113847
curr_Factors:  [101.42332661  -1.20883054  -0.9240039 ]
mat_Sqrt:  [[12.01875898  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00154019 0.00287799 0.08815065]
Stock Position:  0.0015401864999757186
Bond Position:  [6.85014777]


portfolio before change:  [7.00753462]
curr_Stock_Price:  101.63089345895945
curr_Factors:  [101.63089346  -1.4329267   -0.89315295]
mat_Sqrt:  [[ 9.9270953   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423284 -0.03761964 -0.0386481 ]
Stock Position:  -0.004232843219191442
Bond Position:  [7.43772226]


portfolio before change:  [7.00787897]
curr_Stock_Price:  101.76919788160649
curr_Factors:  [101.76919788  -1.36686107  -0.90822344]
mat_Sqrt:  [[10.46067494  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263319  0.01742533 -0.07065752]
Stock Position:  -0.0026331872691526758
Bond Position:  [7.27585633]


portfolio before change:  [7.00792599]
curr_Stock_Price:  102.09675412486216
curr_Factors:  [102.09675412  -1.00905112  -0.90283751]
mat_Sqrt:  [[15.09000058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00742236 -0.01103085  0.320855  ]
Stock Position:  0.00742236228890838
Bond Position:  [6.2501269]


portfolio before change:  [7.00596094]
curr_Stock_Price:  101.7267419522975
curr_Factors:  [101.72674195  -1.12915384  -0.90669711]
mat_Sqrt:  [[13.28239221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00611313 0.02358533 0.00504863]
Stock Position:  0.006113133886334737
Bond Position:  [6.38409175]


portfolio before change:  [7.00429537]
curr_Stock_Price:  101.32373537396239
curr_Factors:  [101.32373537  -1.08289078  -0.92402567]
mat_Sqrt:  [[13.61816062  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367118 -0.04611968  0.16854376]
Stock Position:  -0.0036711783108322174
Bond Position:  [7.37627287]


portfolio before change:  [7.00416868]
curr_Stock_Price:  101.60941622485977
curr_Factors:  [101.60941622  -1.03841177  -0.90888855]
mat_Sqrt:  [[14.49546566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115972  0.01971871 -0.04563056]
Stock Position:  0.0011597212160439831
Bond Position:  [6.88633008]


portfolio before change:  [7.00484464]
curr_Stock_Price:  101.44999880611067
curr_Factors:  [101.44999881  -1.08262799  -0.89882253]
mat_Sqrt:  [[13.98682112  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193513  0.00088643 -0.14005966]
Stock Position:  -0.0019351328744562385
Bond Position:  [7.20116387]


portfolio before change:  [7.00565133]
curr_Stock_Price:  101.49832190892597
curr_Factors:  [101.49832191  -1.30840394  -0.8999006 ]
mat_Sqrt:  [[11.15332577  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095326  0.01397651 -0.18291162]
Stock Position:  -0.0009532637257993692
Bond Position:  [7.102406]


portfolio before change:  [7.0054788]
curr_Stock_Price:  102.6106967812764
curr_Factors:  [102.61069678  -1.01892586  -0.90575321]
mat_Sqrt:  [[14.97321752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06207046 -0.03533029 -3.10018166]
Stock Position:  -0.06207045658552713
Bond Position:  [13.3745716]


portfolio before change:  [7.07804802]
curr_Stock_Price:  101.46849002874346
curr_Factors:  [101.46849003  -0.7817004   -0.89970727]
mat_Sqrt:  [[18.88448411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01122448  0.00284327  0.06325814]
Stock Position:  -0.011224478441322175
Bond Position:  [8.2169789]


portfolio before change:  [7.096963]
curr_Stock_Price:  99.8748485652021
curr_Factors:  [99.87484857 -0.45477086 -0.91942139]
mat_Sqrt:  [[25.27272214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.27970774e-04  2.74755849e-02  5.57131208e-01]
Stock Position:  -0.0005279707741516975
Bond Position:  [7.14969401]


portfolio before change:  [7.09902235]
curr_Stock_Price:  97.66719457029971
curr_Factors:  [97.66719457 -0.39150882 -0.94133686]
mat_Sqrt:  [[25.75735053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009223   0.04900131 -0.11193733]
Stock Position:  0.0009223025137912052
Bond Position:  [7.00894365]


portfolio before change:  [7.10064563]
curr_Stock_Price:  98.47724295208644
curr_Factors:  [98.47724295 -0.20598498 -0.94109383]
mat_Sqrt:  [[31.27273613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00467773 -0.00483632 -0.36533267]
Stock Position:  -0.004677725778894197
Bond Position:  [7.56129517]


portfolio before change:  [7.08990605]
curr_Stock_Price:  100.9752088928607
curr_Factors:  [100.97520889  -0.28953885  -0.92566445]
mat_Sqrt:  [[29.95426545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174979  0.0049611   0.16678008]
Stock Position:  -0.0017497909820944864
Bond Position:  [7.26659156]


portfolio before change:  [7.09055289]
curr_Stock_Price:  101.12467970936125
curr_Factors:  [101.12467971  -0.30850238  -0.91503592]
mat_Sqrt:  [[29.74960642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00567596 -0.0427853  -0.11367285]
Stock Position:  0.005675956674020618
Bond Position:  [6.51657359]


portfolio before change:  [7.093117]
curr_Stock_Price:  101.43290824483924
curr_Factors:  [101.43290824  -0.28329087  -0.92699245]
mat_Sqrt:  [[30.23844887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00064593 0.0225354  0.22080298]
Stock Position:  0.0006459262395873685
Bond Position:  [7.02759883]


portfolio before change:  [7.09349944]
curr_Stock_Price:  100.66491570576916
curr_Factors:  [100.66491571  -0.4086241   -0.93570965]
mat_Sqrt:  [[26.24468749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.11135108e-04  6.31075399e-05 -1.30603440e-01]
Stock Position:  -0.00031113510778524995
Bond Position:  [7.12481983]


portfolio before change:  [7.09440954]
curr_Stock_Price:  100.60243971250638
curr_Factors:  [100.60243971  -0.43429618  -0.89051242]
mat_Sqrt:  [[26.74554469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00251149  0.02471101 -0.01421373]
Stock Position:  -0.0025114908284052206
Bond Position:  [7.34707164]


portfolio before change:  [7.08604887]
curr_Stock_Price:  104.29710295967786
curr_Factors:  [104.29710296  -0.43606306  -0.90302775]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.08604887]
Stock Price:  104.42977500321585
PL:  [2.65627386]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.04149544e-01  3.91435350e-02  5.99049665e-02]
 [-2.84545321e-02  6.27589543e-03 -3.82601631e-02]
 [ 2.54605221e-01  1.00367313e-01  1.06447459e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.25945314e+00 -3.60139721e-01 -3.19404120e-02]
 [-8.12173262e-02  3.92190165e-02  8.37238962e-02]
 [ 1.88006295e-03  1.68255632e-01  8.90768649e-02]
 [ 3.43150581e-01 -4.09956350e-02 -8.50061460e-02]
 [-5.74875930e-01 -2.95469104e-02 -8.46559995e-02]
 [-1.77257453e-02  9.33460128e-02  1.04390053e-02]
 [-4.06884114e-02 -1.64272743e-01  1.17809985e-01]
 [-1.39222569e-01  1.86193704e-02  1.07800506e-01]
 [ 1.07533429e-01 -2.25109917e-02  2.72614319e-01]
 [ 2.96077897e-03  4.64225677e-01  4.11661395e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-1.12242508e-02 -1.90633261e-02  3.44069551e-02]
 [-6.27201739e-01 -2.93110914e-01  1.90922326e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 3.54569993e-01  1.25068769e+00  6.66396912e-01]
 [-2.50050522e-02  4.60798318e-02  2.53927860e-02]
 [ 1.72320828e-02 -6.84755793e-02  3.53535821e-02]
 [-1.06743306e-02  5.41606378e-02 -2.11919380e-02]
 [ 9.08101579e-02 -3.20483996e-02  1.12531285e-01]
 [ 7.88838352e-02 -7.88290449e-02 -5.05135091e-02]
 [-9.09185484e-02  4.35551468e-02  1.42028774e-01]
 [ 1.43987623e-02  6.28115973e-02 -4.26996280e-03]
 [-1.18046319e-01 -3.87915595e-02  1.35084502e-01]
 [ 6.97223074e-02  6.37043261e-02 -8.37930761e-02]
 [-7.30328232e-01 -1.44951034e-01 -1.09943304e+00]
 [-1.21110740e-01  7.49578633e-02 -8.48328015e-03]
 [-9.28701776e-02 -1.30424924e-02  1.19686001e-01]
 [ 1.39385432e-02  3.93652966e-02  1.69970063e-02]
 [-1.40258550e-01 -1.04608385e-03 -1.36659360e-01]
 [-6.61708365e-02 -1.82697031e-02  3.69270026e-02]
 [ 1.81625316e-01 -1.65350692e-01 -9.12054156e-02]
 [-7.98356561e-03  1.42120967e-01  7.97765056e-02]
 [ 1.52286572e-02  1.53343251e-02 -4.47387356e-02]
 [-6.71355656e-02  8.16599931e-02 -5.17894046e-03]
 [-6.41251964e-02 -2.03767095e-01  7.76137526e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.78740468]
curr_Stock_Price:  100.75233256391931
curr_Factors:  [100.75233256  -0.86913048  -1.00780586]
mat_Sqrt:  [[15.42098141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00589527  0.01237827  0.17089219]
Stock Position:  -0.005895267576521089
Bond Position:  [8.38136664]


portfolio before change:  [7.78632266]
curr_Stock_Price:  101.11359679811136
curr_Factors:  [101.1135968   -1.18887051  -1.01036533]
mat_Sqrt:  [[11.21227053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00321989  0.00198461 -0.1091456 ]
Stock Position:  -0.003219893075349989
Bond Position:  [8.11189763]


portfolio before change:  [7.78988199]
curr_Stock_Price:  100.32311324278339
curr_Factors:  [100.32311324  -1.07309473  -0.98091935]
mat_Sqrt:  [[12.86334797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02168372 0.03173893 0.30366497]
Stock Position:  0.0216837164719532
Bond Position:  [5.61450404]


portfolio before change:  [7.81708606]
curr_Stock_Price:  101.54533090790844
curr_Factors:  [101.54533091  -1.17425809  -0.96664987]
mat_Sqrt:  [[11.93645724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165066 -0.00659539  0.21422481]
Stock Position:  0.0016506617931465904
Bond Position:  [7.64946907]


portfolio before change:  [7.81884571]
curr_Stock_Price:  102.03204923603488
curr_Factors:  [102.03204924  -1.32480807  -0.98225269]
mat_Sqrt:  [[10.15764083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12554802 -0.11388618 -0.09111711]
Stock Position:  -0.12554802244061808
Bond Position:  [20.62876772]


portfolio before change:  [7.82294972]
curr_Stock_Price:  102.01990048106556
curr_Factors:  [102.01990048  -1.17652379  -0.98892046]
mat_Sqrt:  [[11.70157732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00539369  0.01240214  0.23884097]
Stock Position:  -0.005393685405906535
Bond Position:  [8.37321297]


portfolio before change:  [7.82134601]
curr_Stock_Price:  102.51129509606065
curr_Factors:  [102.5112951   -1.08542317  -1.0285572 ]
mat_Sqrt:  [[12.37889018  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00197167 0.0532071  0.2541115 ]
Stock Position:  0.0019716746198391246
Bond Position:  [7.61922709]


portfolio before change:  [7.82221164]
curr_Stock_Price:  102.46725461663772
curr_Factors:  [102.46725462  -1.19561992  -1.01142372]
mat_Sqrt:  [[11.27400502  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02880434 -0.01296396 -0.24249887]
Stock Position:  0.028804339838332537
Bond Position:  [4.87071002]


portfolio before change:  [7.84020658]
curr_Stock_Price:  103.07084618010809
curr_Factors:  [103.07084618  -1.21157252  -1.03111903]
mat_Sqrt:  [[10.94327407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05418115 -0.00934355 -0.2415    ]
Stock Position:  -0.05418114882821999
Bond Position:  [13.42470343]


portfolio before change:  [7.81354451]
curr_Stock_Price:  103.59391108221337
curr_Factors:  [103.59391108  -1.56624639  -1.02651646]
mat_Sqrt:  [[ 7.75017719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170121  0.0295186   0.02977958]
Stock Position:  -0.0017012138253537708
Bond Position:  [7.98977991]


portfolio before change:  [7.81528928]
curr_Stock_Price:  103.15541095814932
curr_Factors:  [103.15541096  -1.57655437  -1.00746391]
mat_Sqrt:  [[ 7.78515267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268229 -0.0519476   0.33607909]
Stock Position:  -0.0026822920382416687
Bond Position:  [8.09198222]


portfolio before change:  [7.81613982]
curr_Stock_Price:  103.21544056988684
curr_Factors:  [103.21544057  -1.56477331  -0.99114104]
mat_Sqrt:  [[ 8.0117091   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01457082  0.00588796  0.30752484]
Stock Position:  -0.014570815158043373
Bond Position:  [9.32007293]


portfolio before change:  [7.81528372]
curr_Stock_Price:  103.35415537415768
curr_Factors:  [103.35415537  -1.98601254  -0.99181286]
mat_Sqrt:  [[ 5.26107878  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03090609 -0.0071186   0.77769277]
Stock Position:  0.03090608781923821
Bond Position:  [4.62101111]


portfolio before change:  [7.81215759]
curr_Stock_Price:  103.23431508492847
curr_Factors:  [103.23431508  -1.81296956  -0.99311522]
mat_Sqrt:  [[ 6.23960281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01586272 0.14680105 1.17435538]
Stock Position:  0.015862718811340538
Bond Position:  [6.17458067]


portfolio before change:  [7.80746466]
curr_Stock_Price:  102.88980958723066
curr_Factors:  [102.88980959  -2.02149602  -0.98267801]
mat_Sqrt:  [[ 5.10124473  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00841484 -0.03587186 -0.12433753]
Stock Position:  0.008414835176149648
Bond Position:  [6.94166387]


portfolio before change:  [7.80643161]
curr_Stock_Price:  102.66392165482677
curr_Factors:  [102.66392165  -1.99481352  -0.98785104]
mat_Sqrt:  [[ 5.2007154   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090241 -0.00602835  0.09815347]
Stock Position:  -0.0009024092105267753
Bond Position:  [7.89907648]


portfolio before change:  [7.80716393]
curr_Stock_Price:  102.94664815089588
curr_Factors:  [102.94664815  -1.89498516  -1.00432578]
mat_Sqrt:  [[ 5.66836055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.1051094  -0.09268981  0.54464825]
Stock Position:  -0.10510939961681622
Bond Position:  [18.62782431]


portfolio before change:  [7.86282506]
curr_Stock_Price:  102.43924812991536
curr_Factors:  [102.43924813  -1.84214974  -1.02648627]
mat_Sqrt:  [[ 5.8161231   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02257708  0.00580111 -0.05715682]
Stock Position:  -0.02257708126494888
Bond Position:  [10.17560429]


portfolio before change:  [7.85921639]
curr_Stock_Price:  102.65542741002311
curr_Factors:  [102.65542741  -1.94245072  -1.03510186]
mat_Sqrt:  [[ 5.22693691  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10003762 0.39550217 1.9010449 ]
Stock Position:  0.1000376165008234
Bond Position:  [-2.41018789]


portfolio before change:  [7.85802297]
curr_Stock_Price:  102.64650948861409
curr_Factors:  [102.64650949  -2.07605003  -1.00836877]
mat_Sqrt:  [[ 4.69675734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00396699  0.01457172  0.07243855]
Stock Position:  -0.003966991254983619
Bond Position:  [8.26522078]


portfolio before change:  [7.85856037]
curr_Stock_Price:  102.77149681359815
curr_Factors:  [102.77149681  -1.90742325  -0.99130441]
mat_Sqrt:  [[ 5.66201812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00400574 -0.02165388  0.10085393]
Stock Position:  0.004005739682172228
Bond Position:  [7.4468845]


portfolio before change:  [7.85888698]
curr_Stock_Price:  102.62063623254605
curr_Factors:  [102.62063623  -1.66394567  -0.96348399]
mat_Sqrt:  [[ 7.41577423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183416  0.0171271  -0.0604547 ]
Stock Position:  -0.0018341571242752644
Bond Position:  [8.04710935]


portfolio before change:  [7.85979244]
curr_Stock_Price:  102.67542634063633
curr_Factors:  [102.67542634  -1.72351378  -0.91591902]
mat_Sqrt:  [[ 7.33120586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01540715 -0.01013459  0.32102043]
Stock Position:  0.015407154892370663
Bond Position:  [6.27785624]


portfolio before change:  [7.86566096]
curr_Stock_Price:  103.00538646018795
curr_Factors:  [103.00538646  -1.42428055  -0.93286984]
mat_Sqrt:  [[ 9.75354583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00682187 -0.02492793 -0.14410098]
Stock Position:  0.0068218730191561055
Bond Position:  [7.1629713]


portfolio before change:  [7.8698371]
curr_Stock_Price:  103.48629661660098
curr_Factors:  [103.48629662  -1.56017752  -0.91372901]
mat_Sqrt:  [[ 8.71924528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00697336  0.01377335  0.40516856]
Stock Position:  -0.006973362399741217
Bond Position:  [8.59148455]


portfolio before change:  [7.86809033]
curr_Stock_Price:  103.89080326000004
curr_Factors:  [103.89080326  -1.49346355  -0.88335597]
mat_Sqrt:  [[ 9.64578327  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00157053  0.01986277 -0.01218102]
Stock Position:  0.0015705254639342791
Bond Position:  [7.70492718]


portfolio before change:  [7.86863606]
curr_Stock_Price:  103.62500592453786
curr_Factors:  [103.62500592  -1.4102428   -0.86506109]
mat_Sqrt:  [[10.64909359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00858983 -0.01226697  0.38535848]
Stock Position:  -0.008589830092482953
Bond Position:  [8.75875726]


portfolio before change:  [7.86432144]
curr_Stock_Price:  104.2547662663716
curr_Factors:  [104.25476627  -1.30150346  -0.89026164]
mat_Sqrt:  [[11.64727763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00465885  0.02014508 -0.23903832]
Stock Position:  0.0046588531394302305
Bond Position:  [7.3786138]


portfolio before change:  [7.87041826]
curr_Stock_Price:  105.36543336436165
curr_Factors:  [105.36543336  -1.37335177  -0.91933241]
mat_Sqrt:  [[10.64138286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0900721  -0.04583754 -3.13637643]
Stock Position:  -0.09007209803317541
Bond Position:  [17.36090391]


portfolio before change:  [7.93770331]
curr_Stock_Price:  104.64251476308026
curr_Factors:  [104.64251476  -1.38527649  -0.90733682]
mat_Sqrt:  [[10.56912069  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01143964  0.02370376 -0.02420044]
Stock Position:  -0.011439644048234167
Bond Position:  [9.13477643]


portfolio before change:  [7.94365984]
curr_Stock_Price:  104.22164371982004
curr_Factors:  [104.22164372  -1.40393368  -0.90046558]
mat_Sqrt:  [[10.40327397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00661101 -0.0041244   0.34143085]
Stock Position:  -0.00661100830651064
Bond Position:  [8.63266999]


portfolio before change:  [7.94783407]
curr_Stock_Price:  103.75347387484014
curr_Factors:  [103.75347387  -1.55506592  -0.89951026]
mat_Sqrt:  [[ 8.91238127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00206729 0.0124484  0.04848773]
Stock Position:  0.0020672870282618123
Bond Position:  [7.73334586]


portfolio before change:  [7.94902186]
curr_Stock_Price:  103.86040962351754
curr_Factors:  [103.86040962  -1.45244441  -0.89004877]
mat_Sqrt:  [[ 9.97971569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.68522872e-02 -3.30800758e-04 -3.89851115e-01]
Stock Position:  -0.016852287222185253
Bond Position:  [9.69930732]


portfolio before change:  [7.95427921]
curr_Stock_Price:  103.62039094935452
curr_Factors:  [103.62039095  -1.53671824  -0.90071374]
mat_Sqrt:  [[ 9.05486475  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00652742 -0.00577739  0.10534246]
Stock Position:  -0.006527415597475983
Bond Position:  [8.63065257]


portfolio before change:  [7.95219894]
curr_Stock_Price:  104.10437702510913
curr_Factors:  [104.10437703  -1.43182683  -0.87646722]
mat_Sqrt:  [[10.35117429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01533534 -0.05228848 -0.26018366]
Stock Position:  0.01533533752905741
Bond Position:  [6.35572318]


portfolio before change:  [7.95257673]
curr_Stock_Price:  104.07720295872542
curr_Factors:  [104.07720296  -1.50279153  -0.86938867]
mat_Sqrt:  [[ 9.70802401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00123303 0.0449426  0.22758017]
Stock Position:  0.0012330308402772562
Bond Position:  [7.82424633]


portfolio before change:  [7.95412461]
curr_Stock_Price:  104.53931339120629
curr_Factors:  [104.53931339  -1.60143186  -0.88008396]
mat_Sqrt:  [[ 8.74119916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074273  0.00484914 -0.12762716]
Stock Position:  0.0007427277968058728
Bond Position:  [7.87648036]


portfolio before change:  [7.95482213]
curr_Stock_Price:  104.15276215692447
curr_Factors:  [104.15276216  -1.44304758  -0.88201245]
mat_Sqrt:  [[10.1838045   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00648915  0.02582316 -0.01477408]
Stock Position:  -0.006489152505007474
Bond Position:  [8.63068529]


portfolio before change:  [7.9571534]
curr_Stock_Price:  103.95976958300739
curr_Factors:  [103.95976958  -1.52768101  -0.87289463]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.9571534]
Stock Price:  103.68811014676504
PL:  [4.26904325]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.66744797e-02  1.04667929e-02  2.93677808e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.67774080e-01  3.74901720e-01  5.38060375e-01]
 [-4.04953537e-02 -7.55481930e-02  7.59989178e-02]
 [ 4.64435021e-02 -1.88146728e-02  7.57159525e-02]
 [ 5.39960357e-02 -2.01333921e-01 -2.70421054e-01]
 [ 2.93510898e-02 -1.67831325e-01 -2.48905107e-02]
 [ 2.47285249e-01  1.48364483e-01 -6.78476127e-02]
 [-2.43434893e-01  1.16202942e-02 -1.10536890e-01]
 [ 6.71109768e-02 -3.99243275e-02 -8.64561446e-02]
 [ 6.34538156e-02 -2.80637194e-01  2.55183090e-02]
 [-4.07907069e-03 -3.30404993e-02 -6.90462725e-02]
 [ 2.58092275e-01 -2.69025258e-01  3.05646719e-02]
 [ 8.26446162e-02 -6.48288442e-02 -5.63579289e-02]
 [ 8.05807576e-02 -1.08780576e-01 -6.66692707e-02]
 [-4.69070838e-02  1.79038667e-02  3.12680409e-02]
 [-3.83232712e-01 -2.73577093e-01  9.63937135e-02]
 [-2.35020261e-01 -6.78087142e-02 -3.98681569e-02]
 [ 3.26193168e-01  1.31453083e+00  4.90584461e-01]
 [-2.01485268e-01 -2.63866232e-02  1.65816585e-01]
 [-9.13056651e-02  1.38645615e-01 -3.74978798e-02]
 [ 2.72129221e-02  1.03372105e-02  2.26159138e-02]
 [-6.48199241e-02 -1.50441633e-02 -8.09637888e-02]
 [ 2.65678483e-02  1.28800366e-01  1.21449663e-01]
 [-1.07976398e-01  8.80092161e-02  1.26892861e-02]
 [ 1.16183961e-01 -3.93291997e-02 -1.86407715e-02]
 [ 3.13030332e-02 -6.71402079e-02  8.44799858e-02]
 [ 3.36060728e-03  4.18201724e-02 -1.64887331e-02]
 [-5.64672761e-01  5.00966940e-02 -7.56243248e-01]
 [-1.22068847e-01 -8.60263789e-02  1.13191332e-02]
 [-9.02798921e-02  9.22946337e-02  2.11615573e-01]
 [ 1.52380997e-02  6.73376365e-02  2.91024275e-03]
 [-1.27181352e-01 -1.06026531e-02 -1.42730406e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 2.26922368e-01 -1.74003144e-01 -7.45113182e-02]
 [ 4.26584996e-03  5.42344638e-02  7.68298826e-02]
 [ 2.41857163e-02  2.36795978e-02 -4.27514013e-02]
 [-4.69240566e-02  8.75410174e-02 -7.68139137e-03]
 [-7.48760321e-02 -2.40998345e-01  8.89740335e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.83492313]
curr_Stock_Price:  100.34096341162024
curr_Factors:  [100.34096341  -0.92930393  -0.97926972]
mat_Sqrt:  [[14.87973712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00607602  0.00330989  0.0837781 ]
Stock Position:  -0.006076018304695447
Bond Position:  [5.44459666]


portfolio before change:  [4.83594727]
curr_Stock_Price:  100.28442583507635
curr_Factors:  [100.28442584  -0.87408203  -0.98557705]
mat_Sqrt:  [[15.61686362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029059   0.01411938  0.0859571 ]
Stock Position:  -0.002905899926243626
Bond Position:  [5.12736378]


portfolio before change:  [4.841017]
curr_Stock_Price:  98.76036522683084
curr_Factors:  [98.76036523 -0.74353086 -0.97331562]
mat_Sqrt:  [[17.74049493  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02183057 0.11855433 1.53493648]
Stock Position:  0.021830569941130744
Bond Position:  [2.68502194]


portfolio before change:  [4.80963775]
curr_Stock_Price:  97.3075905108795
curr_Factors:  [97.30759051 -0.75147435 -0.98898573]
mat_Sqrt:  [[17.07161109  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00157764 -0.02389044  0.21680376]
Stock Position:  -0.0015776358429866627
Bond Position:  [4.96315369]


portfolio before change:  [4.81087448]
curr_Stock_Price:  96.91694520535493
curr_Factors:  [96.91694521 -0.76453563 -0.96309921]
mat_Sqrt:  [[17.2225494   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00356586 -0.00594972  0.21599654]
Stock Position:  0.0035658578741179186
Bond Position:  [4.46528243]


portfolio before change:  [4.81488242]
curr_Stock_Price:  97.88438224709098
curr_Factors:  [97.88438225 -0.8672674  -0.98652601]
mat_Sqrt:  [[15.33278892  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.17526801e-04 -6.36673761e-02 -7.71435997e-01]
Stock Position:  -0.00041752680100384863
Bond Position:  [4.85575177]


portfolio before change:  [4.81529874]
curr_Stock_Price:  98.34108696829337
curr_Factors:  [98.34108697 -1.07851766 -0.98459176]
mat_Sqrt:  [[12.49504901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00159559 -0.05307292 -0.0710057 ]
Stock Position:  0.0015955879333163234
Bond Position:  [4.65838689]


portfolio before change:  [4.81648297]
curr_Stock_Price:  98.71831558847262
curr_Factors:  [98.71831559 -1.08175428 -0.99950003]
mat_Sqrt:  [[12.31744055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01926266  0.04691697 -0.19355035]
Stock Position:  0.019262659866137948
Bond Position:  [2.91490564]


portfolio before change:  [4.81918889]
curr_Stock_Price:  98.83987362648908
curr_Factors:  [98.83987363 -0.90999474 -1.01202183]
mat_Sqrt:  [[14.46142169  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01837289  0.00367466 -0.31533098]
Stock Position:  -0.018372889761849944
Bond Position:  [6.63516299]


portfolio before change:  [4.82116815]
curr_Stock_Price:  98.77729182618071
curr_Factors:  [98.77729183 -0.93383952 -1.00161916]
mat_Sqrt:  [[14.25929624  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00339655 -0.01262518 -0.24663532]
Stock Position:  0.003396545500219518
Bond Position:  [4.48566658]


portfolio before change:  [4.8222988]
curr_Stock_Price:  98.94508204113322
curr_Factors:  [98.94508204 -0.84511782 -1.01928785]
mat_Sqrt:  [[15.33532966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00400492 -0.08874527  0.07279663]
Stock Position:  0.004004915368088202
Bond Position:  [4.42603212]


portfolio before change:  [4.82183949]
curr_Stock_Price:  98.69224421529177
curr_Factors:  [98.69224422 -0.95366366 -1.02174316]
mat_Sqrt:  [[13.68909524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138988 -0.01044832 -0.1969698 ]
Stock Position:  -0.001389878858188802
Bond Position:  [4.95900976]


portfolio before change:  [4.82333031]
curr_Stock_Price:  98.06564216104475
curr_Factors:  [98.06564216 -1.16069178 -0.99132558]
mat_Sqrt:  [[11.40007254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02257749 -0.08507326  0.0871925 ]
Stock Position:  0.022577493207382674
Bond Position:  [2.60925394]


portfolio before change:  [4.83247867]
curr_Stock_Price:  98.45639337287035
curr_Factors:  [98.45639337 -1.1408962  -1.02082641]
mat_Sqrt:  [[11.33495297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00612854 -0.02050068 -0.16077348]
Stock Position:  0.006128541405288248
Bond Position:  [4.22908459]


portfolio before change:  [4.83985092]
curr_Stock_Price:  99.57306674085179
curr_Factors:  [99.57306674 -1.28400369 -1.0586196 ]
mat_Sqrt:  [[ 9.56650971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00670707 -0.03439944 -0.19018887]
Stock Position:  0.006707069689303139
Bond Position:  [4.17200742]


portfolio before change:  [4.83877494]
curr_Stock_Price:  99.33488378149592
curr_Factors:  [99.33488378 -1.18589611 -1.04647766]
mat_Sqrt:  [[10.65599914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0037596   0.0056617   0.08919902]
Stock Position:  -0.0037595954454453036
Bond Position:  [5.21223392]


portfolio before change:  [4.84248716]
curr_Stock_Price:  98.52079321466442
curr_Factors:  [98.52079321 -1.1159384  -0.99675367]
mat_Sqrt:  [[11.91234861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03111227 -0.08651267  0.27498443]
Stock Position:  -0.031112265888241845
Bond Position:  [7.90769228]


portfolio before change:  [4.87805362]
curr_Stock_Price:  97.40940087593474
curr_Factors:  [97.40940088 -0.80624668 -1.00652096]
mat_Sqrt:  [[15.89739222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01540562 -0.021443   -0.11373275]
Stock Position:  -0.0154056165029259
Bond Position:  [6.37870549]


portfolio before change:  [4.86665073]
curr_Stock_Price:  98.20133788169996
curr_Factors:  [98.20133788 -1.02216891 -0.99424684]
mat_Sqrt:  [[13.07371973  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03520607 0.41569115 1.39950091]
Stock Position:  0.035206073835252906
Bond Position:  [1.40936718]


portfolio before change:  [4.87613732]
curr_Stock_Price:  98.46579252227093
curr_Factors:  [98.46579252 -0.9452602  -0.98625127]
mat_Sqrt:  [[14.27054659  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01179488 -0.00834418  0.47302856]
Stock Position:  -0.011794880988942984
Bond Position:  [6.03752962]


portfolio before change:  [4.89291836]
curr_Stock_Price:  97.10704207462189
curr_Factors:  [97.10704207 -0.94936339 -0.99210688]
mat_Sqrt:  [[13.93416343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00684505  0.04384359 -0.10697101]
Stock Position:  -0.0068450520145483165
Bond Position:  [5.55762111]


portfolio before change:  [4.88363251]
curr_Stock_Price:  98.56511659026998
curr_Factors:  [98.56511659 -1.02232503 -0.99814063]
mat_Sqrt:  [[13.06911428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00245589 0.00326891 0.06451691]
Stock Position:  0.002455888066330415
Bond Position:  [4.64156761]


portfolio before change:  [4.88168211]
curr_Stock_Price:  97.5346817593627
curr_Factors:  [97.53468176 -0.72543665 -1.03388092]
mat_Sqrt:  [[16.79179628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00486756 -0.00475738 -0.23096715]
Stock Position:  -0.004867557081482805
Bond Position:  [5.35643774]


portfolio before change:  [4.87754252]
curr_Stock_Price:  98.52268994980463
curr_Factors:  [98.52268995 -0.76658206 -1.00994696]
mat_Sqrt:  [[16.67245328  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00327992 0.04073025 0.34646208]
Stock Position:  0.0032799173027924767
Bond Position:  [4.55439624]


portfolio before change:  [4.87525702]
curr_Stock_Price:  97.65229216994369
curr_Factors:  [97.65229217 -0.55817741 -1.03926392]
mat_Sqrt:  [[19.76616823  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00521668  0.02783096  0.036199  ]
Stock Position:  -0.005216682315593798
Bond Position:  [5.38467801]


portfolio before change:  [4.87298627]
curr_Stock_Price:  98.21661229001319
curr_Factors:  [98.21661229 -0.76870138 -1.04699799]
mat_Sqrt:  [[15.98220623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00696797 -0.01243698 -0.05317693]
Stock Position:  0.0069679650201123
Bond Position:  [4.18861635]


portfolio before change:  [4.87870054]
curr_Stock_Price:  98.96154472044739
curr_Factors:  [98.96154472 -0.78937824 -1.06436227]
mat_Sqrt:  [[15.50233771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0030198  -0.0212316   0.24099788]
Stock Position:  0.0030197952257880367
Bond Position:  [4.57985694]


portfolio before change:  [4.87994028]
curr_Stock_Price:  99.18249281624844
curr_Factors:  [99.18249282 -1.09068423 -1.05159797]
mat_Sqrt:  [[11.64269926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.23025589e-05  1.32246997e-02 -4.70377661e-02]
Stock Position:  9.23025589048638e-05
Bond Position:  [4.87078548]


portfolio before change:  [4.88047845]
curr_Stock_Price:  98.41639391017982
curr_Factors:  [98.41639391 -0.87168171 -1.03449816]
mat_Sqrt:  [[14.62931699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04906222  0.01584197 -2.15735149]
Stock Position:  -0.04906222051426874
Bond Position:  [9.70900527]


portfolio before change:  [4.79373574]
curr_Stock_Price:  100.20914631812325
curr_Factors:  [100.20914632  -0.98780668  -1.01790582]
mat_Sqrt:  [[13.48458202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00904585 -0.02720393  0.03229034]
Stock Position:  -0.009045851765457308
Bond Position:  [5.70021282]


portfolio before change:  [4.79571499]
curr_Stock_Price:  100.06911726267799
curr_Factors:  [100.06911726  -0.94061699  -1.01065337]
mat_Sqrt:  [[14.21916581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314372  0.02918613  0.60368033]
Stock Position:  -0.0031437151473028644
Bond Position:  [5.11030379]


portfolio before change:  [4.79577482]
curr_Stock_Price:  100.25329486241803
curr_Factors:  [100.25329486  -0.79196113  -1.01334685]
mat_Sqrt:  [[16.48402868  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00106593 0.02129403 0.00830211]
Stock Position:  0.0010659287962794988
Bond Position:  [4.68891194]


portfolio before change:  [4.79663381]
curr_Stock_Price:  100.50925865829497
curr_Factors:  [100.50925866  -1.00459894  -1.03550585]
mat_Sqrt:  [[13.06771989  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01198295 -0.00335285 -0.40717012]
Stock Position:  -0.011982949971646848
Bond Position:  [6.00103123]


portfolio before change:  [4.7860276]
curr_Stock_Price:  101.45697082562695
curr_Factors:  [101.45697083  -0.89713817  -1.04298707]
mat_Sqrt:  [[14.57794159  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359541  0.0049611   0.16678008]
Stock Position:  -0.003595411823230112
Bond Position:  [5.15080719]


portfolio before change:  [4.78259582]
curr_Stock_Price:  102.59054442804552
curr_Factors:  [102.59054443  -0.80773526  -1.06150403]
mat_Sqrt:  [[15.82366305  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01309558 -0.05502463 -0.21256005]
Stock Position:  0.013095581372114634
Bond Position:  [3.439113]


portfolio before change:  [4.77883846]
curr_Stock_Price:  102.27079686008308
curr_Factors:  [102.27079686  -0.66645879  -1.0663861 ]
mat_Sqrt:  [[18.0795104   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00118084 0.01715044 0.21917427]
Stock Position:  0.0011808401573408069
Bond Position:  [4.65807299]


portfolio before change:  [4.77990518]
curr_Stock_Price:  102.68103131881928
curr_Factors:  [102.68103132  -0.57418728  -1.06547608]
mat_Sqrt:  [[19.92477716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00080656  0.00748815 -0.12195785]
Stock Position:  0.0008065599666793418
Bond Position:  [4.69708677]


portfolio before change:  [4.78077284]
curr_Stock_Price:  103.02879792307407
curr_Factors:  [103.02879792  -0.45806477  -1.08047267]
mat_Sqrt:  [[22.11975499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209006  0.0276829  -0.02191287]
Stock Position:  -0.0020900645004526207
Bond Position:  [4.99610968]


portfolio before change:  [4.78138315]
curr_Stock_Price:  103.03561188842731
curr_Factors:  [103.03561189  -0.32771686  -1.07745668]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.78138315]
Stock Price:  104.99175650632401
PL:  [-0.21037335]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.22963578e-01 -8.35326560e-03  4.02064468e-02]
 [-9.92016573e-02  3.91206511e-02  8.51395002e-02]
 [ 2.57199989e-01  3.34949546e-01  4.79914363e-01]
 [-4.07536300e-02  3.80113148e-03  1.02751944e-01]
 [-2.71434615e-01 -9.00359804e-02  4.60204256e-02]
 [ 7.03267167e-02 -2.33164610e-01 -3.15584925e-01]
 [ 2.00989046e-02 -2.83868762e-01 -4.30879108e-02]
 [ 1.12452263e-01  2.56494364e-01 -2.78838133e-02]
 [-1.60412017e-01  1.48591848e-02 -8.72381062e-02]
 [ 1.00770540e-01 -2.05518533e-02  4.40984757e-02]
 [ 1.04281762e-01 -2.20988640e-01 -1.12680352e-02]
 [-4.28591923e-02 -5.44543976e-02 -1.16893357e-01]
 [ 2.86866485e-01 -3.07607788e-01 -1.11548341e-02]
 [ 8.25308800e-02 -6.48430910e-02 -5.64592863e-02]
 [-8.37689647e-02  9.21131491e-02  7.79420427e-02]
 [-1.04835757e-02 -1.33141645e-01 -1.88432860e-02]
 [-1.62638575e-01 -2.90632268e-01  1.46355981e-02]
 [-2.25650385e-01 -1.32337177e-02 -4.11998412e-02]
 [ 2.90298198e-01  1.20422837e+00  3.68615151e-01]
 [-2.14810359e-01 -2.58341722e-02  1.85601596e-01]
 [-9.14835373e-02  1.44415373e-01 -3.72273369e-02]
 [ 1.13408187e-01 -2.66391836e-02  6.71469318e-02]
 [-1.08181674e-01  1.92284945e-02 -1.14337938e-01]
 [-8.00822695e-03 -1.10803859e-01  1.07113677e-01]
 [-1.05271861e-01  8.34165654e-02 -1.25794664e-02]
 [ 8.99947224e-02 -1.38584865e-01 -1.62132389e-01]
 [ 7.50747695e-02 -1.89845193e-02  1.03772002e-01]
 [-1.43003133e-01  4.10452453e-02  1.37990982e-01]
 [-3.64164377e-01 -5.88416655e-02 -5.81222406e-01]
 [ 2.84025091e-01 -2.05512869e-01 -1.80242497e-01]
 [ 1.34209845e-01  1.16909656e-02 -3.37565514e-02]
 [ 4.55712013e-02  2.58668480e-01 -8.84344123e-02]
 [-3.61189783e-02  5.00306920e-02 -5.23561876e-02]
 [-4.49890579e-02  1.49425716e-01  9.50099248e-02]
 [-2.09180963e-01  8.89666760e-02  4.89525124e-02]
 [-1.29697026e-01 -8.26366914e-02 -6.17576455e-03]
 [ 1.57618659e-01  1.34381249e-01  5.43622987e-02]
 [-1.30287614e-01  2.19229231e-01  1.11092581e-02]
 [ 1.28758174e-03 -1.92920209e-01  5.87451638e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.92405046]
curr_Stock_Price:  100.07472158697752
curr_Factors:  [100.07472159  -0.98019816  -0.98692267]
mat_Sqrt:  [[13.99634591  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00821444 -0.00264153  0.1146978 ]
Stock Position:  -0.008214440563978591
Bond Position:  [3.74610831]


portfolio before change:  [2.93667675]
curr_Stock_Price:  98.59464471606817
curr_Factors:  [98.59464472 -0.70193058 -1.00411773]
mat_Sqrt:  [[17.90300601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00451391  0.01237104  0.2428793 ]
Stock Position:  -0.00451390893157358
Bond Position:  [3.381724]


portfolio before change:  [2.93551171]
curr_Stock_Price:  98.94639784925167
curr_Factors:  [98.94639785 -0.77258025 -1.00621708]
mat_Sqrt:  [[16.70621723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02177695 0.10592035 1.3690621 ]
Stock Position:  0.02177695006519637
Bond Position:  [0.78076095]


portfolio before change:  [2.92665449]
curr_Stock_Price:  98.53519135713701
curr_Factors:  [98.53519136 -0.90233439 -1.00128646]
mat_Sqrt:  [[14.68450569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134028  0.00120202  0.29312269]
Stock Position:  -0.0013402788591747009
Bond Position:  [3.05871913]


portfolio before change:  [2.92677264]
curr_Stock_Price:  98.73232711427644
curr_Factors:  [98.73232711 -0.73555354 -1.02003094]
mat_Sqrt:  [[17.06155943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0154948  -0.02847188  0.13128346]
Stock Position:  -0.015494800168135401
Bond Position:  [4.45661032]


portfolio before change:  [2.9460785]
curr_Stock_Price:  97.52232469871134
curr_Factors:  [97.5223247  -0.62200317 -1.01097298]
mat_Sqrt:  [[19.05072517  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.88275347e-06 -7.37331236e-02 -9.00275949e-01]
Stock Position:  -5.882753466466969e-06
Bond Position:  [2.9466522]


portfolio before change:  [2.94644667]
curr_Stock_Price:  97.55224663786552
curr_Factors:  [97.55224664 -0.69829117 -1.03340521]
mat_Sqrt:  [[17.26517932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00023018 -0.08976718 -0.12291782]
Stock Position:  0.0002301836373636509
Bond Position:  [2.92399174]


portfolio before change:  [2.94676035]
curr_Stock_Price:  97.3270250786824
curr_Factors:  [97.32702508 -0.69842147 -1.03849367]
mat_Sqrt:  [[17.13565795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0066168   0.08111064 -0.07954476]
Stock Position:  0.006616796354637008
Bond Position:  [2.30276725]


portfolio before change:  [2.95095433]
curr_Stock_Price:  97.917358691142
curr_Factors:  [97.91735869 -0.7762797  -1.0323627 ]
mat_Sqrt:  [[16.0463505   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01108263  0.00469889 -0.24886603]
Stock Position:  -0.011082629554398355
Bond Position:  [4.03613615]


portfolio before change:  [2.95040458]
curr_Stock_Price:  98.01249023444159
curr_Factors:  [98.01249023 -0.88241986 -1.07189702]
mat_Sqrt:  [[13.88456849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00786783 -0.00649907  0.12580068]
Stock Position:  0.007867832313887359
Bond Position:  [2.17925874]


portfolio before change:  [2.94969791]
curr_Stock_Price:  97.88804792951382
curr_Factors:  [97.88804793 -1.05278411 -1.06133374]
mat_Sqrt:  [[11.81897873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00814586 -0.06988274 -0.03214457]
Stock Position:  0.008145863036146074
Bond Position:  [2.15231528]


portfolio before change:  [2.95105706]
curr_Stock_Price:  98.02186960155048
curr_Factors:  [98.0218696  -1.3287789  -1.06709542]
mat_Sqrt:  [[ 8.92910621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00762965 -0.01721999 -0.33346421]
Stock Position:  -0.007629650021589234
Bond Position:  [3.69892962]


portfolio before change:  [2.95341137]
curr_Stock_Price:  97.77390020509996
curr_Factors:  [97.77390021 -1.48981345 -1.02358912]
mat_Sqrt:  [[ 7.91892215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03493495 -0.09727412 -0.03182164]
Stock Position:  0.034934945589655965
Bond Position:  [-0.46231451]


portfolio before change:  [2.96669512]
curr_Stock_Price:  98.15579683812403
curr_Factors:  [98.15579684 -1.77123912 -1.04548353]
mat_Sqrt:  [[ 5.86987491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01181148 -0.02050519 -0.16106263]
Stock Position:  0.011811484240388527
Bond Position:  [1.80732947]


portfolio before change:  [2.95834185]
curr_Stock_Price:  97.42945264923695
curr_Factors:  [97.42945265 -1.47424799 -1.05928184]
mat_Sqrt:  [[ 7.73378752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00846684  0.02912874  0.22234695]
Stock Position:  -0.008466842459106347
Bond Position:  [3.78326167]


portfolio before change:  [2.95862056]
curr_Stock_Price:  97.45239222772227
curr_Factors:  [97.45239223 -1.33748957 -1.04045778]
mat_Sqrt:  [[ 9.03780765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196592 -0.04210309 -0.05375465]
Stock Position:  -0.001965924539990787
Bond Position:  [3.15020461]


portfolio before change:  [2.95949238]
curr_Stock_Price:  97.20923552520634
curr_Factors:  [97.20923553 -1.15891348 -1.03486082]
mat_Sqrt:  [[10.83835703  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01542256 -0.09190599  0.04175129]
Stock Position:  -0.015422557928277604
Bond Position:  [4.45870745]


portfolio before change:  [2.96421267]
curr_Stock_Price:  96.93931222745535
curr_Factors:  [96.93931223 -1.2048971  -1.01685756]
mat_Sqrt:  [[10.51003462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02230268 -0.00418487 -0.11753168]
Stock Position:  -0.02230268204317687
Bond Position:  [5.12621932]


portfolio before change:  [2.97448986]
curr_Stock_Price:  96.50723976410943
curr_Factors:  [96.50723976 -0.90926822 -1.00904991]
mat_Sqrt:  [[14.17244946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0279863  0.38081045 1.05155642]
Stock Position:  0.027986304978560268
Bond Position:  [0.27360881]


portfolio before change:  [3.00500778]
curr_Stock_Price:  97.59647664276126
curr_Factors:  [97.59647664 -0.99890772 -1.0151434 ]
mat_Sqrt:  [[13.02395392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01363577 -0.00816948  0.52946969]
Stock Position:  -0.013635768984112244
Bond Position:  [4.33581079]


portfolio before change:  [3.01173638]
curr_Stock_Price:  97.14277318641595
curr_Factors:  [97.14277319 -0.95668337 -1.0356451 ]
mat_Sqrt:  [[13.24808899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00719755  0.04566815 -0.10619923]
Stock Position:  -0.007197547270943433
Bond Position:  [3.71092608]


portfolio before change:  [3.01605711]
curr_Stock_Price:  96.60691889990393
curr_Factors:  [96.6069189  -1.20553161 -1.03772846]
mat_Sqrt:  [[10.25115404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01233292 -0.00842405  0.19155151]
Stock Position:  0.012332921277465693
Bond Position:  [1.82461159]


portfolio before change:  [3.01538503]
curr_Stock_Price:  96.53392972896519
curr_Factors:  [96.53392973 -1.51245247 -1.05687307]
mat_Sqrt:  [[ 7.39326176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01772213  0.00608058 -0.32617431]
Stock Position:  -0.017722127810017516
Bond Position:  [4.72617168]


portfolio before change:  [3.02378756]
curr_Stock_Price:  96.09314081195734
curr_Factors:  [96.09314081 -1.22993834 -1.0746326 ]
mat_Sqrt:  [[ 9.59025043  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114651 -0.03503926  0.30556551]
Stock Position:  0.0011465099455108343
Bond Position:  [2.91361582]


portfolio before change:  [3.02334647]
curr_Stock_Price:  95.39073600267757
curr_Factors:  [95.390736  -1.1645938 -1.0486782]
mat_Sqrt:  [[10.43024192  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01013263  0.02637863 -0.03588572]
Stock Position:  -0.010132634306790386
Bond Position:  [3.98990592]


portfolio before change:  [3.0236704]
curr_Stock_Price:  95.40799130203828
curr_Factors:  [95.4079913  -0.99969304 -1.05070885]
mat_Sqrt:  [[12.27740339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00434305 -0.04382438 -0.46251858]
Stock Position:  0.004343047102908709
Bond Position:  [2.609309]


portfolio before change:  [3.0207637]
curr_Stock_Price:  94.66361039233442
curr_Factors:  [94.66361039 -0.73447245 -1.08459992]
mat_Sqrt:  [[15.35217709  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00623801 -0.00600343  0.29603264]
Stock Position:  0.006238005330114475
Bond Position:  [2.4302516]


portfolio before change:  [3.02066426]
curr_Stock_Price:  94.59896749775953
curr_Factors:  [94.5989675  -0.80867802 -1.07743667]
mat_Sqrt:  [[14.3468711   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00793037  0.01297965  0.39364986]
Stock Position:  -0.007930374321842244
Bond Position:  [3.77086948]


portfolio before change:  [3.02613711]
curr_Stock_Price:  93.96829620511366
curr_Factors:  [93.96829621 -0.56383978 -1.06992647]
mat_Sqrt:  [[18.34195761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02640532 -0.01860737 -1.65806574]
Stock Position:  -0.026405316112456105
Bond Position:  [5.50739967]


portfolio before change:  [3.0450042]
curr_Stock_Price:  93.27985038366525
curr_Factors:  [93.27985038 -0.66183134 -1.05391391]
mat_Sqrt:  [[16.77448311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01442232 -0.06498888 -0.51418167]
Stock Position:  0.014422317802270867
Bond Position:  [1.69969256]


portfolio before change:  [3.04215107]
curr_Stock_Price:  93.06729020007826
curr_Factors:  [93.0672902  -0.76008626 -1.08979173]
mat_Sqrt:  [[14.63542264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00872002  0.00369701 -0.09629805]
Stock Position:  0.00872001991632796
Bond Position:  [2.23060244]


portfolio before change:  [3.03703661]
curr_Stock_Price:  92.44879328388336
curr_Factors:  [92.44879328 -0.44849952 -1.06511277]
mat_Sqrt:  [[20.34922071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168058  0.08179816 -0.25227876]
Stock Position:  0.0016805751153730574
Bond Position:  [2.88166946]


portfolio before change:  [3.0388674]
curr_Stock_Price:  93.32382634530333
curr_Factors:  [93.32382635 -0.37106689 -1.06477577]
mat_Sqrt:  [[22.20311926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204991  0.01582109 -0.14935763]
Stock Position:  -0.0020499080728075
Bond Position:  [3.23017266]


portfolio before change:  [3.03594932]
curr_Stock_Price:  94.9443233442089
curr_Factors:  [94.94432334 -0.30914668 -1.05103039]
mat_Sqrt:  [[24.36416919  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00089217  0.04725256  0.27103687]
Stock Position:  -0.0008921741837108814
Bond Position:  [3.1206562]


portfolio before change:  [3.03624177]
curr_Stock_Price:  95.05378399624838
curr_Factors:  [95.053784   -0.21889944 -1.0257241 ]
mat_Sqrt:  [[27.38017858  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00719102  0.02813373  0.13964789]
Stock Position:  -0.007191021902827332
Bond Position:  [3.71977561]


portfolio before change:  [3.03652425]
curr_Stock_Price:  95.07916633640124
curr_Factors:  [95.07916634 -0.51781601 -1.02857636]
mat_Sqrt:  [[20.25329512  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00657134 -0.02613202 -0.01761774]
Stock Position:  -0.0065713415265873125
Bond Position:  [3.66132192]


portfolio before change:  [3.0396297]
curr_Stock_Price:  94.67624077744021
curr_Factors:  [94.67624078 -0.6059907  -1.02582682]
mat_Sqrt:  [[18.51619151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00929916 0.04249508 0.15508051]
Stock Position:  0.009299159890796025
Bond Position:  [2.1592202]


portfolio before change:  [3.02787146]
curr_Stock_Price:  93.38277282819682
curr_Factors:  [93.38277283 -0.68391535 -1.02172971]
mat_Sqrt:  [[16.96346342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00721312  0.06932637  0.03169162]
Stock Position:  -0.007213118510641341
Bond Position:  [3.70145246]


portfolio before change:  [3.03222763]
curr_Stock_Price:  92.8429982964752
curr_Factors:  [92.8429983  -0.94675718 -1.01785635]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.03222763]
Stock Price:  92.99580916227956
PL:  [3.03222763]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.12936304e-01  2.81423345e-02  1.60010052e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 3.64246260e-01  2.10076114e-02 -8.11459172e-02]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.20455071e+00 -3.02854177e-01 -2.60621232e-01]
 [ 4.17959497e-02  1.04594013e-01  1.17201557e-01]
 [-8.27705160e-02 -5.82968034e-02  1.71733385e-01]
 [ 3.10890885e-01 -3.86599518e-01 -3.37561317e-02]
 [-4.97841804e-01  1.09121909e-01 -1.27983647e-01]
 [-5.12809828e-02  6.96728034e-02  3.31952756e-02]
 [ 1.22389298e-02 -3.00460660e-01  2.15048533e-01]
 [-1.71017206e-01  2.51199602e-02  1.39021304e-01]
 [ 3.51301962e-02  3.96903724e-02  1.94501450e-01]
 [ 5.95410925e-02  2.70843286e-01  2.31403618e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-3.41916881e-02  3.81032440e-02  4.32850595e-02]
 [-4.11538641e-01 -2.08056109e-01  1.00110152e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 1.10621409e-01  7.26253759e-01  1.21330425e-01]
 [-2.70314821e-02  4.81212192e-02  2.51202212e-02]
 [ 6.95519107e-02 -1.71144229e-01  1.25954785e-01]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 2.27882292e-01 -2.14888713e-03  2.14685472e-01]
 [ 7.01796844e-02 -1.74724184e-01 -6.63144073e-02]
 [-1.20793056e-01  2.30313313e-01  2.07117083e-01]
 [ 1.21552333e-02  6.06731079e-02  4.72370249e-02]
 [-1.07514388e-01 -1.15926673e-01  2.08203667e-01]
 [ 8.68515739e-02  7.07556388e-02 -8.47980542e-02]
 [-7.35147800e-01 -1.33352007e-01 -1.08386640e+00]
 [ 1.05837980e-02 -1.29166895e-01  1.45630876e-01]
 [-1.80426434e-02 -1.49265903e-01  1.20720887e-01]
 [ 5.64475864e-02  1.65652700e-01 -3.60470473e-02]
 [-1.19167799e-01 -9.19241833e-03 -6.30392695e-02]
 [-6.01616543e-02  1.25612155e-01  1.28178021e-01]
 [ 1.36523345e-01 -1.56976723e-01 -1.09384554e-01]
 [-3.11143761e-02  2.70058973e-01  8.40232476e-02]
 [ 1.12670917e-01  8.82922667e-02 -2.25441133e-02]
 [-2.47252727e-02  7.12298017e-02 -9.94742970e-03]
 [-1.17895331e-01 -2.34669852e-01  4.77216175e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.02895447]
curr_Stock_Price:  99.81067792828773
curr_Factors:  [99.81067793 -0.77341259 -1.00193856]
mat_Sqrt:  [[16.9103189   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01061764  0.00889939  0.45646414]
Stock Position:  -0.010617644661777557
Bond Position:  [2.08870878]


portfolio before change:  [1.02230927]
curr_Stock_Price:  100.46113393400019
curr_Factors:  [100.46113393  -0.75122156  -1.01370657]
mat_Sqrt:  [[17.19885465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263861  0.01411938  0.0859571 ]
Stock Position:  -0.0026386084284948166
Bond Position:  [1.28738686]


portfolio before change:  [1.01987449]
curr_Stock_Price:  101.4448753154468
curr_Factors:  [101.44487532  -0.64476045  -1.01310787]
mat_Sqrt:  [[19.32978613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01801493  0.00664319 -0.23148672]
Stock Position:  0.018014934598105332
Bond Position:  [-0.8076483]


portfolio before change:  [1.05832457]
curr_Stock_Price:  103.58482444766113
curr_Factors:  [103.58482445  -0.84544357  -0.99889461]
mat_Sqrt:  [[16.37986198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120288 -0.00659539  0.21422481]
Stock Position:  0.0012028827795073226
Bond Position:  [0.93372417]


portfolio before change:  [1.05940857]
curr_Stock_Price:  104.38895421598453
curr_Factors:  [104.38895422  -0.90550595  -1.00262698]
mat_Sqrt:  [[15.48684479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.081719   -0.0957709  -0.74347983]
Stock Position:  -0.08171899951179876
Bond Position:  [9.58996947]


portfolio before change:  [0.96373167]
curr_Stock_Price:  105.57442785932459
curr_Factors:  [105.57442786  -0.93989398  -1.0302495 ]
mat_Sqrt:  [[14.72096542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00464781 0.03307553 0.33434342]
Stock Position:  0.0046478081607036715
Bond Position:  [0.47304198]


portfolio before change:  [0.96454181]
curr_Stock_Price:  105.73600957495587
curr_Factors:  [105.73600957  -0.75018025  -1.01985697]
mat_Sqrt:  [[18.00966027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273302 -0.01843507  0.48990755]
Stock Position:  -0.002733022270510742
Bond Position:  [1.25352068]


portfolio before change:  [0.96607813]
curr_Stock_Price:  105.23121057315008
curr_Factors:  [105.23121057  -0.52899611  -1.0018706 ]
mat_Sqrt:  [[22.76656974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01291448 -0.1222535  -0.09629685]
Stock Position:  0.01291448340001728
Bond Position:  [-0.39292859]


portfolio before change:  [0.96450368]
curr_Stock_Price:  105.11309991529473
curr_Factors:  [105.11309992  -0.48308299  -1.00147251]
mat_Sqrt:  [[23.81894827  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02187959  0.03450738 -0.36510172]
Stock Position:  -0.02187959079754693
Bond Position:  [3.26433529]


portfolio before change:  [0.97008608]
curr_Stock_Price:  104.87660823175025
curr_Factors:  [104.87660823  -0.36086732  -1.02497835]
mat_Sqrt:  [[26.23091891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162808  0.02203247  0.09469688]
Stock Position:  -0.0016280817913219344
Bond Position:  [1.14083378]


portfolio before change:  [0.97043987]
curr_Stock_Price:  104.74689903213795
curr_Factors:  [104.74689903  -0.29188209  -1.04762937]
mat_Sqrt:  [[27.44092452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00176298 -0.095014    0.61347361]
Stock Position:  0.0017629751098761318
Bond Position:  [0.7857737]


portfolio before change:  [0.96845334]
curr_Stock_Price:  103.56437216552524
curr_Factors:  [103.56437217  -0.36945097  -1.01507945]
mat_Sqrt:  [[25.93680379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0054745   0.00794363  0.39658908]
Stock Position:  -0.005474499015677023
Bond Position:  [1.53541639]


portfolio before change:  [0.96529745]
curr_Stock_Price:  104.17590317909955
curr_Factors:  [104.17590318  -0.36615533  -1.02676726]
mat_Sqrt:  [[25.87192132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00293204 0.0125512  0.5548585 ]
Stock Position:  0.0029320373418045198
Bond Position:  [0.65984981]


portfolio before change:  [0.96192874]
curr_Stock_Price:  102.99883782605659
curr_Factors:  [102.99883783  -0.34691732  -1.02640043]
mat_Sqrt:  [[26.08603096  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00436131 0.08564817 0.66013011]
Stock Position:  0.004361311305518064
Bond Position:  [0.51271874]


portfolio before change:  [0.96001371]
curr_Stock_Price:  102.54504721058082
curr_Factors:  [102.54504721  -0.43859556  -1.04325564]
mat_Sqrt:  [[23.2999447   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00184233 -0.03587186 -0.12433753]
Stock Position:  0.00184232770432433
Bond Position:  [0.77109213]


portfolio before change:  [0.96066418]
curr_Stock_Price:  102.8457938696227
curr_Factors:  [102.84579387  -0.37532775  -1.04416715]
mat_Sqrt:  [[24.8718295   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00097992  0.0120493   0.12348023]
Stock Position:  -0.000979917491954213
Bond Position:  [1.06144457]


portfolio before change:  [0.9610345]
curr_Stock_Price:  102.60329111510389
curr_Factors:  [102.60329112  -0.38538438  -1.06793632]
mat_Sqrt:  [[23.98789452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01652816 -0.06579312  0.2855864 ]
Stock Position:  -0.016528158699317855
Bond Position:  [2.65687798]


portfolio before change:  [0.94847078]
curr_Stock_Price:  103.38352632580296
curr_Factors:  [103.38352633  -0.51036127  -1.0732354 ]
mat_Sqrt:  [[21.21798034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00618867  0.00580111 -0.05715682]
Stock Position:  -0.006188670254709972
Bond Position:  [1.58827733]


portfolio before change:  [0.94291583]
curr_Stock_Price:  104.31320739967195
curr_Factors:  [104.3132074   -0.66206421  -1.09527675]
mat_Sqrt:  [[17.99433566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00856601 0.2296616  0.34612193]
Stock Position:  0.008566010596525375
Bond Position:  [0.04936779]


portfolio before change:  [0.94882544]
curr_Stock_Price:  105.00237768895111
curr_Factors:  [105.00237769  -0.7658757   -1.09849321]
mat_Sqrt:  [[16.27473791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126954  0.01521727  0.071661  ]
Stock Position:  -0.0012695352762550618
Bond Position:  [1.08212967]


portfolio before change:  [0.94842905]
curr_Stock_Price:  105.42116434601324
curr_Factors:  [105.42116435  -0.92986521  -1.09583177]
mat_Sqrt:  [[13.90524961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00653303 -0.05412056  0.35931394]
Stock Position:  0.006533028971315366
Bond Position:  [0.25970953]


portfolio before change:  [0.95003]
curr_Stock_Price:  105.66124831147883
curr_Factors:  [105.66124831  -0.88416588  -1.08230759]
mat_Sqrt:  [[14.78724139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262854  0.01916992 -0.08961985]
Stock Position:  -0.002628540554820057
Bond Position:  [1.22776487]


portfolio before change:  [0.9505074]
curr_Stock_Price:  105.53801535017419
curr_Factors:  [105.53801535  -0.92531354  -1.07515013]
mat_Sqrt:  [[14.27639609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01902786 -0.00067954  0.6124379 ]
Stock Position:  0.019027862156498113
Bond Position:  [-1.05765541]


portfolio before change:  [0.96170887]
curr_Stock_Price:  106.13365165743238
curr_Factors:  [106.13365166  -0.87324527  -1.08599117]
mat_Sqrt:  [[14.9612379   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00348447 -0.05525264 -0.18917655]
Stock Position:  0.0034844679292835045
Bond Position:  [0.59188956]


portfolio before change:  [0.96299682]
curr_Stock_Price:  106.48204398661558
curr_Factors:  [106.48204399  -0.89507662  -1.08734076]
mat_Sqrt:  [[14.66639748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00494796  0.07283146  0.59084739]
Stock Position:  -0.0049479631385981136
Bond Position:  [1.48986605]


portfolio before change:  [0.96187251]
curr_Stock_Price:  106.74691248652763
curr_Factors:  [106.74691249  -0.92509483  -1.10267743]
mat_Sqrt:  [[14.05092833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00166281 0.01918652 0.13475408]
Stock Position:  0.0016628099599884092
Bond Position:  [0.78437268]


portfolio before change:  [0.95961824]
curr_Stock_Price:  105.33224645375057
curr_Factors:  [105.33224645  -1.00590107  -1.08938396]
mat_Sqrt:  [[12.95957078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524772 -0.03665923  0.59394711]
Stock Position:  -0.005247720575528309
Bond Position:  [1.51237244]


portfolio before change:  [0.95936436]
curr_Stock_Price:  105.41665303991932
curr_Factors:  [105.41665304  -0.91614158  -1.07592303]
mat_Sqrt:  [[14.38025393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.004963    0.0223749  -0.24190525]
Stock Position:  0.004962996247916208
Bond Position:  [0.4361819]


portfolio before change:  [0.96089719]
curr_Stock_Price:  105.71451828693688
curr_Factors:  [105.71451829  -0.79533174  -1.08286128]
mat_Sqrt:  [[16.16016422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05939508 -0.04216961 -3.09196914]
Stock Position:  -0.059395079331452924
Bond Position:  [7.23981939]


portfolio before change:  [0.91753763]
curr_Stock_Price:  106.459775150148
curr_Factors:  [106.45977515  -0.64373368  -1.09071951]
mat_Sqrt:  [[18.78979727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00196785 -0.04084616  0.41544435]
Stock Position:  0.0019678499303111227
Bond Position:  [0.70804077]


portfolio before change:  [0.91748907]
curr_Stock_Price:  106.39012265558527
curr_Factors:  [106.39012266  -0.29694139  -1.0640279 ]
mat_Sqrt:  [[27.27971662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.00637975e-04 -4.72020230e-02  3.44383088e-01]
Stock Position:  0.00010063797544448291
Bond Position:  [0.90678219]


portfolio before change:  [0.91762839]
curr_Stock_Price:  106.64810776646046
curr_Factors:  [106.64810777  -0.35803734  -1.04356354]
mat_Sqrt:  [[26.25703156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00203247  0.05238398 -0.10283219]
Stock Position:  0.0020324707252439775
Bond Position:  [0.70086924]


portfolio before change:  [0.91228687]
curr_Stock_Price:  103.97690948295624
curr_Factors:  [103.97690948  -0.35387578  -1.00828267]
mat_Sqrt:  [[26.62925456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00496721 -0.0029069  -0.17983349]
Stock Position:  -0.004967205628671344
Bond Position:  [1.42876156]


portfolio before change:  [0.90853927]
curr_Stock_Price:  104.7673361885308
curr_Factors:  [104.76733619  -0.4673384   -1.02399481]
mat_Sqrt:  [[23.58023431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00130423  0.03972205  0.36565622]
Stock Position:  -0.0013042335813858103
Bond Position:  [1.04518035]


portfolio before change:  [0.90752355]
curr_Stock_Price:  105.64629666340473
curr_Factors:  [105.64629666  -0.87862166  -1.02981149]
mat_Sqrt:  [[15.66867566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00702945 -0.0496404  -0.31204368]
Stock Position:  0.007029451475404203
Bond Position:  [0.16488804]


portfolio before change:  [0.90930729]
curr_Stock_Price:  105.89711659774731
curr_Factors:  [105.8971166   -0.93901615  -1.02426039]
mat_Sqrt:  [[14.86770611  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047017  0.08540015  0.23969494]
Stock Position:  -0.00047016733588336047
Bond Position:  [0.95909666]


portfolio before change:  [0.90904084]
curr_Stock_Price:  106.7188350969376
curr_Factors:  [106.7188351   -0.95715478  -1.01751022]
mat_Sqrt:  [[14.81340736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00744925  0.02792047 -0.06431208]
Stock Position:  0.0074492527571771265
Bond Position:  [0.11406527]


portfolio before change:  [0.91013961]
curr_Stock_Price:  106.86442133860415
curr_Factors:  [106.86442134  -1.04085034  -1.00855089]
mat_Sqrt:  [[13.76542093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181009  0.02252484 -0.02837725]
Stock Position:  -0.001810089049987012
Bond Position:  [1.10357373]


portfolio before change:  [0.91020353]
curr_Stock_Price:  106.90532335209627
curr_Factors:  [106.90532335  -0.91698006  -1.01167452]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.91020353]
Stock Price:  107.23937695687593
PL:  [-6.32917343]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.72222297e-02  1.03868275e-01  3.29333033e-02]
 [ 5.61172139e-02 -1.27662291e-01 -2.76973553e-01]
 [ 3.81672688e-01  1.29244976e-02 -1.03871500e-01]
 [ 1.74418255e-04 -9.70690174e-03  8.57007860e-02]
 [-7.28082348e-01 -2.00347631e-01 -7.00762699e-02]
 [-1.38422229e-02  7.05085584e-02  9.23043511e-02]
 [ 1.45077044e-02  1.27753087e-01  5.76481258e-02]
 [ 3.06489457e-01 -8.19482376e-02 -6.71000331e-02]
 [-5.63564940e-01 -2.82448294e-02 -8.51063000e-02]
 [ 3.90064981e-02 -3.03596939e-03 -3.47250170e-02]
 [ 1.02953018e-02 -2.68638923e-01  1.12115750e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.09162595e-01 -2.30329465e-02  2.73833763e-01]
 [ 5.77078514e-02  2.12063478e-01  1.69466359e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-1.63675654e-02 -6.26147746e-03  3.63951126e-02]
 [-4.72874326e-01 -2.40587826e-01  1.26829885e-01]
 [-1.74791408e-01 -5.23074444e-02 -2.30022127e-02]
 [ 2.08957841e-01  9.83919942e-01  2.51192792e-01]
 [-1.59161981e-02 -2.66513813e-03  4.30867906e-02]
 [-5.36128417e-02 -6.19178516e-02 -1.68919917e-02]
 [-2.47867636e-03  3.19319531e-02 -1.30805690e-03]
 [ 4.53010869e-02 -3.43946957e-02  6.25677794e-02]
 [ 8.12080956e-02 -5.66205339e-02 -4.74573765e-02]
 [-8.38692785e-02 -1.25706525e-03  1.38421629e-01]
 [ 1.48580768e-02  6.32494072e-02 -1.48149165e-02]
 [ 2.34700593e-02 -6.90428531e-02  3.19915067e-02]
 [ 3.51778073e-02  4.78815992e-02 -6.77603466e-02]
 [-6.95765938e-01 -7.20154553e-02 -1.06073601e+00]
 [-6.81169964e-02 -1.15119007e-01 -7.65860510e-03]
 [-4.63147297e-02  7.64410512e-02  1.62914543e-01]
 [ 2.52627206e-02  1.41899842e-01 -3.31066115e-02]
 [-1.35408871e-01 -1.65002721e-02 -1.29183182e-01]
 [-6.29679486e-02  5.84191796e-02  8.55637017e-02]
 [ 2.41211820e-01 -1.76380326e-01 -6.81550032e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-8.64143478e-04 -1.21766091e-03 -4.67246060e-02]
 [-8.08204885e-02  3.52135423e-02 -2.58482481e-03]
 [-4.43960664e-02 -2.30163543e-01  1.09174704e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.18082282]
curr_Stock_Price:  101.22513739790296
curr_Factors:  [101.2251374   -1.03047858  -1.00005741]
mat_Sqrt:  [[13.28733234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134097  0.03284603  0.09394955]
Stock Position:  -0.0013409674373573717
Bond Position:  [11.31656243]


portfolio before change:  [11.18120504]
curr_Stock_Price:  101.9950596929404
curr_Factors:  [101.99505969  -0.78727145  -1.01632784]
mat_Sqrt:  [[16.79909613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.21202491e-04 -4.03703611e-02 -7.90128451e-01]
Stock Position:  -0.00022120249117800255
Bond Position:  [11.2037666]


portfolio before change:  [11.1826796]
curr_Stock_Price:  101.66052721781293
curr_Factors:  [101.66052722  -0.59289297  -1.0135536 ]
mat_Sqrt:  [[20.39301676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01769251  0.00408708 -0.29631648]
Stock Position:  0.01769251309157937
Bond Position:  [9.38404939]


portfolio before change:  [11.17443996]
curr_Stock_Price:  101.12851018969367
curr_Factors:  [101.12851019  -0.39486729  -0.98167788]
mat_Sqrt:  [[25.52981314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068224 -0.00306959  0.24448049]
Stock Position:  0.0006822371443513177
Bond Position:  [11.10544633]


portfolio before change:  [11.17680406]
curr_Stock_Price:  102.55885751549853
curr_Factors:  [102.55885752  -0.52540819  -1.00269699]
mat_Sqrt:  [[22.24977004  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03359853 -0.06335548 -0.19990809]
Stock Position:  -0.03359852972523297
Bond Position:  [14.62263088]


portfolio before change:  [11.1747431]
curr_Stock_Price:  102.67460363331456
curr_Factors:  [102.67460363  -0.66128438  -0.99815999]
mat_Sqrt:  [[19.53329472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00034914 0.02229676 0.26331862]
Stock Position:  0.000349139615047771
Bond Position:  [11.13889533]


portfolio before change:  [11.17588895]
curr_Stock_Price:  101.96827317517429
curr_Factors:  [101.96827318  -0.58667593  -0.99983955]
mat_Sqrt:  [[20.86652577  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00141728 0.04039907 0.16445406]
Stock Position:  0.00141727711191364
Bond Position:  [11.03137165]


portfolio before change:  [11.17756095]
curr_Stock_Price:  102.17500349107851
curr_Factors:  [102.17500349  -0.94636229  -0.98663132]
mat_Sqrt:  [[14.78618732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01965867 -0.02591431 -0.19141772]
Stock Position:  0.019658673308379195
Bond Position:  [9.16893593]


portfolio before change:  [11.19809331]
curr_Stock_Price:  103.16114172085997
curr_Factors:  [103.16114172  -0.93942544  -1.0056715 ]
mat_Sqrt:  [[14.7492954   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0394369  -0.0089318  -0.24278458]
Stock Position:  -0.039436898717503444
Bond Position:  [15.2664488]


portfolio before change:  [11.26348831]
curr_Stock_Price:  101.55131487237473
curr_Factors:  [101.55131487  -0.72151104  -1.00680261]
mat_Sqrt:  [[18.03385076  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00176556 -0.00096006 -0.09906081]
Stock Position:  0.0017655627595960458
Bond Position:  [11.08419309]


portfolio before change:  [11.26355115]
curr_Stock_Price:  100.8021086857453
curr_Factors:  [100.80210869  -0.95175898  -1.02169737]
mat_Sqrt:  [[14.00904129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0018734  -0.08495109  0.31983503]
Stock Position:  0.0018734048726711963
Bond Position:  [11.07470799]


portfolio before change:  [11.26518705]
curr_Stock_Price:  100.93634511450817
curr_Factors:  [100.93634511  -0.717753    -1.06207581]
mat_Sqrt:  [[17.02463256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423654  0.00225658  0.15019092]
Stock Position:  -0.004236544802079783
Bond Position:  [11.6928084]


portfolio before change:  [11.26292113]
curr_Stock_Price:  101.81621564021924
curr_Factors:  [101.81621564  -0.80092646  -1.06280031]
mat_Sqrt:  [[15.79103879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01041502 -0.00728366  0.7811715 ]
Stock Position:  0.010415019061951603
Bond Position:  [10.20250331]


portfolio before change:  [11.26260885]
curr_Stock_Price:  101.66377405216218
curr_Factors:  [101.66377405  -0.93400835  -1.01464455]
mat_Sqrt:  [[14.48361679  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00675076 0.06706036 0.48344035]
Stock Position:  0.0067507642622441615
Bond Position:  [10.57630067]


portfolio before change:  [11.27257868]
curr_Stock_Price:  102.94477129009299
curr_Factors:  [102.94477129  -0.94929098  -0.99703915]
mat_Sqrt:  [[14.70022077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0029201  -0.03587186 -0.12433753]
Stock Position:  0.002920101289384841
Bond Position:  [10.97196952]


portfolio before change:  [11.27338614]
curr_Stock_Price:  102.75158800536126
curr_Factors:  [102.75158801  -1.16313751  -0.99173636]
mat_Sqrt:  [[11.91073906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076403 -0.00198005  0.10382513]
Stock Position:  -0.0007640260408577733
Bond Position:  [11.35189103]


portfolio before change:  [11.2754391]
curr_Stock_Price:  101.92192539416592
curr_Factors:  [101.92192539  -0.91026262  -0.9658526 ]
mat_Sqrt:  [[15.61281211  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02902727 -0.07608055  0.36181036]
Stock Position:  -0.029027265048338982
Bond Position:  [14.23395384]


portfolio before change:  [11.3234131]
curr_Stock_Price:  100.33050289434055
curr_Factors:  [100.33050289  -0.70451536  -0.94636422]
mat_Sqrt:  [[19.25152322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0093934  -0.01654107 -0.06561891]
Stock Position:  -0.00939340153446315
Bond Position:  [12.2658578]


portfolio before change:  [11.31424577]
curr_Stock_Price:  101.46967050667388
curr_Factors:  [101.46967051  -0.64105316  -0.9493904 ]
mat_Sqrt:  [[20.68308841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01381017 0.31114281 0.71658312]
Stock Position:  0.013810174425655748
Bond Position:  [9.91293192]


portfolio before change:  [11.30749929]
curr_Stock_Price:  100.89142452454416
curr_Factors:  [100.89142452  -0.86941815  -0.95491589]
mat_Sqrt:  [[16.27631347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044174 -0.00084279  0.12291462]
Stock Position:  -0.0004417436037594181
Bond Position:  [11.35206743]


portfolio before change:  [11.30865701]
curr_Stock_Price:  101.48311906489609
curr_Factors:  [101.48311906  -0.86018724  -0.94569436]
mat_Sqrt:  [[16.67667225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00351747 -0.01958014 -0.04818815]
Stock Position:  -0.0035174653705250898
Bond Position:  [11.66562036]


portfolio before change:  [11.31594689]
curr_Stock_Price:  99.82522263456596
curr_Factors:  [99.82522263 -1.04984322 -0.91819776]
mat_Sqrt:  [[13.94861054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00013773  0.01009777 -0.00373152]
Stock Position:  -0.00013773435495301675
Bond Position:  [11.32969625]


portfolio before change:  [11.31726549]
curr_Stock_Price:  100.53459808046705
curr_Factors:  [100.53459808  -0.93829987  -0.920034  ]
mat_Sqrt:  [[15.67658286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00364777 -0.01087656  0.17848846]
Stock Position:  0.0036477729027451235
Bond Position:  [10.9505381]


portfolio before change:  [11.32770841]
curr_Stock_Price:  103.02214891789728
curr_Factors:  [103.02214892  -1.02412594  -0.94173421]
mat_Sqrt:  [[14.42674614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00485619 -0.01790498 -0.13538269]
Stock Position:  0.004856186046083562
Bond Position:  [10.82741369]


portfolio before change:  [11.33085756]
curr_Stock_Price:  103.39191252061867
curr_Factors:  [103.39191252  -0.80330034  -0.92677108]
mat_Sqrt:  [[18.32846504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303607 -0.00039752  0.39487838]
Stock Position:  -0.0030360719750635525
Bond Position:  [11.64476285]


portfolio before change:  [11.33310478]
curr_Stock_Price:  103.13120502793637
curr_Factors:  [103.13120503  -0.76573403  -0.93558851]
mat_Sqrt:  [[18.81547138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071575  0.02000122 -0.04226283]
Stock Position:  0.0007157454124890539
Bond Position:  [11.25928909]


portfolio before change:  [11.3339035]
curr_Stock_Price:  102.28065411183981
curr_Factors:  [102.28065411  -0.66315448  -0.93704532]
mat_Sqrt:  [[20.64598242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00136674 -0.02183327  0.09126286]
Stock Position:  0.0013667365833561745
Bond Position:  [11.19411279]


portfolio before change:  [11.33504834]
curr_Stock_Price:  102.0944404633419
curr_Factors:  [102.09444046  -0.53075529  -0.90771521]
mat_Sqrt:  [[24.22603224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00093216  0.01514149 -0.19330141]
Stock Position:  0.0009321618081794189
Bond Position:  [11.23987981]


portfolio before change:  [11.33499417]
curr_Stock_Price:  100.52899938698218
curr_Factors:  [100.52899939  -0.584649    -0.91825256]
mat_Sqrt:  [[22.36606108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04087207 -0.02277329 -3.02598458]
Stock Position:  -0.04087206937623963
Bond Position:  [15.44382241]


portfolio before change:  [11.38310504]
curr_Stock_Price:  99.39912582172603
curr_Factors:  [99.39912582 -0.65824868 -0.90554465]
mat_Sqrt:  [[20.80825929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00349153 -0.03640383 -0.02184787]
Stock Position:  -0.003491530051614966
Bond Position:  [11.73016008]


portfolio before change:  [11.38495384]
curr_Stock_Price:  99.28959372840797
curr_Factors:  [99.28959373 -0.64863683 -0.9225295 ]
mat_Sqrt:  [[20.63264299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00053732  0.02417278  0.46474984]
Stock Position:  -0.0005373154807061454
Bond Position:  [11.43830367]


portfolio before change:  [11.38677428]
curr_Stock_Price:  98.56271192394328
curr_Factors:  [98.56271192 -0.33073608 -0.90544433]
mat_Sqrt:  [[28.63164604  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00077427  0.04487267 -0.09444395]
Stock Position:  0.0007742726331304721
Bond Position:  [11.31045987]


portfolio before change:  [11.38991076]
curr_Stock_Price:  100.7874953935217
curr_Factors:  [100.78749539  -0.50313569  -0.85945122]
mat_Sqrt:  [[25.80136465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00628666 -0.00521784 -0.36852366]
Stock Position:  -0.006286656339978942
Bond Position:  [12.02352711]


portfolio before change:  [11.37769152]
curr_Stock_Price:  102.9702584395984
curr_Factors:  [102.97025844  -0.62630398  -0.83723675]
mat_Sqrt:  [[23.82890805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184624  0.01847377  0.24408942]
Stock Position:  -0.0018462429875168056
Bond Position:  [11.56779964]


portfolio before change:  [11.38130626]
curr_Stock_Price:  101.79561560488897
curr_Factors:  [101.7956156   -0.83681801  -0.8209185 ]
mat_Sqrt:  [[19.39917459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01148222 -0.05577636 -0.19442725]
Stock Position:  0.011482221394176383
Bond Position:  [10.21246646]


portfolio before change:  [11.37688677]
curr_Stock_Price:  101.29953352740995
curr_Factors:  [101.29953353  -0.87567165  -0.81949623]
mat_Sqrt:  [[18.59539418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00131817 0.00777784 0.21633947]
Stock Position:  0.0013181696182531458
Bond Position:  [11.24335681]


portfolio before change:  [11.37971603]
curr_Stock_Price:  102.37963062828408
curr_Factors:  [102.37963063  -1.09333057  -0.79484878]
mat_Sqrt:  [[15.49486109  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067333 -0.00038506 -0.1332923 ]
Stock Position:  -0.0006733331493707362
Bond Position:  [11.44865163]


portfolio before change:  [11.38167329]
curr_Stock_Price:  101.59831213725533
curr_Factors:  [101.59831214  -1.10309623  -0.8094369 ]
mat_Sqrt:  [[15.00665539  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00536022  0.0111355  -0.00737379]
Stock Position:  -0.005360215307966119
Bond Position:  [11.92626212]


portfolio before change:  [11.38180289]
curr_Stock_Price:  101.85227169922567
curr_Factors:  [101.8522717   -1.05980592  -0.80525363]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.38180289]
Stock Price:  102.23863150758768
PL:  [9.14317138]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.98254875e-01  2.97224960e-02  1.50982134e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 1.97390295e-01  2.19403127e-01  3.28262604e-01]
 [ 2.04774462e-03  4.36575714e-02  1.35007098e-01]
 [-4.85147978e-01 -1.50572790e-01  4.07978200e-02]
 [-6.07783173e-03 -9.27103534e-02 -1.08858364e-01]
 [ 3.69991625e-02  1.36836880e-02 -1.68697687e-02]
 [ 9.48787843e-02  1.39094281e-01 -9.51714906e-03]
 [-2.53698108e-01  1.83237254e-03 -7.38903533e-02]
 [ 5.46735322e-02 -2.96525759e-02 -4.71974002e-02]
 [ 1.07997384e-01 -3.32692645e-01  2.25386129e-02]
 [-8.89215077e-02 -7.97918026e-02 -1.73465893e-01]
 [ 2.28998428e-01 -2.69953444e-01 -1.38870861e-02]
 [ 9.64070336e-02 -6.79851788e-02 -4.11499990e-02]
 [-1.57574702e-01  2.22155746e-01  1.66734614e-01]
 [ 4.19138629e-02 -3.34996935e-01 -8.63275877e-02]
 [-1.57965313e-01 -2.66648776e-01  1.02994671e-02]
 [-2.69462206e-01 -1.44798665e-01 -4.29651317e-02]
 [ 2.34563790e-01  1.10901337e+00  1.98936640e-01]
 [-3.17848062e-01 -4.82551901e-02  2.45777423e-01]
 [-9.90556768e-02  3.90037874e-01 -2.57101431e-02]
 [ 6.15764990e-02 -2.91656173e-02  4.84025554e-02]
 [-8.95994278e-02  4.93095466e-02 -1.08708221e-01]
 [-8.28293952e-02 -8.44557299e-02  2.87132641e-02]
 [-1.22506008e-01  1.28416058e-01  1.18973483e-01]
 [ 7.70096888e-02 -1.49786235e-01 -1.88814606e-01]
 [ 1.25037943e-01  4.14091469e-02  8.61654312e-02]
 [-2.29074596e-01  3.43036051e-02  2.29482674e-01]
 [-2.42239051e-01 -3.15459557e-01 -5.52792501e-01]
 [ 5.31433673e-01 -4.42742998e-01 -2.39628648e-01]
 [ 2.16109294e-01 -5.32632675e-02 -4.22904564e-02]
 [ 6.02209346e-02  3.62357993e-01 -1.38355431e-01]
 [ 1.57538612e-01  1.10781067e-01  1.76712260e-01]
 [-5.78884792e-02  1.38749215e-01  1.11898273e-01]
 [-3.75646515e-01  1.20659505e-01 -8.68870260e-02]
 [-8.16272694e-02 -2.72241574e-02  4.95156787e-02]
 [ 6.25399395e-02  5.40535207e-02 -4.03052467e-03]
 [-6.96438333e-02  1.72397299e-01  1.97975057e-02]
 [ 1.18059834e-03 -1.86359794e-01  5.56455814e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.16812075]
curr_Stock_Price:  99.69073799521959
curr_Factors:  [99.690738   -1.00682127 -0.9925595 ]
mat_Sqrt:  [[13.50003134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01234577  0.00939908  0.43071   ]
Stock Position:  -0.012345774601148078
Bond Position:  [1.39888013]


portfolio before change:  [0.17260057]
curr_Stock_Price:  99.34203963972277
curr_Factors:  [99.34203964 -1.18384471 -0.99833087]
mat_Sqrt:  [[11.20537152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00404994  0.01411938  0.0859571 ]
Stock Position:  -0.004049936474594275
Bond Position:  [0.57492952]


portfolio before change:  [0.17248539]
curr_Stock_Price:  99.38822717144816
curr_Factors:  [99.38822717 -1.20323391 -0.9862638 ]
mat_Sqrt:  [[11.12879574  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02426692 0.06938136 0.93644184]
Stock Position:  0.02426691881827806
Bond Position:  [-2.23936065]


portfolio before change:  [0.1830687]
curr_Stock_Price:  99.83588380546772
curr_Factors:  [99.83588381 -0.62367386 -0.98501889]
mat_Sqrt:  [[19.98206127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00153804 0.01380574 0.38513767]
Stock Position:  0.001538038857316867
Bond Position:  [0.02951723]


portfolio before change:  [0.1826582]
curr_Stock_Price:  99.56658971921001
curr_Factors:  [99.56658972 -0.78832044 -0.96791903]
mat_Sqrt:  [[17.19445909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02795714 -0.0476153   0.11638482]
Stock Position:  -0.02795714177624241
Bond Position:  [2.96625547]


portfolio before change:  [0.17081866]
curr_Stock_Price:  100.00334212005163
curr_Factors:  [100.00334212  -0.64011661  -0.94913243]
mat_Sqrt:  [[20.40856295  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150389 -0.02931759 -0.31054261]
Stock Position:  -0.0015038894921264442
Bond Position:  [0.32121263]


portfolio before change:  [0.17054409]
curr_Stock_Price:  100.21261227695315
curr_Factors:  [100.21261228  -0.39334368  -0.96624444]
mat_Sqrt:  [[25.73124293  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00131781  0.00432716 -0.04812475]
Stock Position:  0.0013178122338765401
Bond Position:  [0.03848269]


portfolio before change:  [0.16853563]
curr_Stock_Price:  98.68487370468577
curr_Factors:  [98.6848737  -0.38806734 -0.99118439]
mat_Sqrt:  [[24.84558189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0038851   0.04398547 -0.02714978]
Stock Position:  0.003885097306766711
Bond Position:  [-0.21486471]


portfolio before change:  [0.16852781]
curr_Stock_Price:  98.68977290577247
curr_Factors:  [98.68977291 -0.37149976 -0.9936092 ]
mat_Sqrt:  [[25.20071488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01066373  0.00057945 -0.21078861]
Stock Position:  -0.010663729303879967
Bond Position:  [1.22092883]


portfolio before change:  [0.15167019]
curr_Stock_Price:  100.28492238722123
curr_Factors:  [100.28492239  -0.32916787  -1.01300272]
mat_Sqrt:  [[26.20223645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168969 -0.00937697 -0.13464105]
Stock Position:  0.0016896945849182155
Bond Position:  [-0.0177807]


portfolio before change:  [0.1484102]
curr_Stock_Price:  98.35690093093588
curr_Factors:  [98.35690093 -0.36611502 -1.02130975]
mat_Sqrt:  [[24.5614452   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0042346  -0.10520665  0.06429639]
Stock Position:  0.0042346031059648185
Bond Position:  [-0.26809224]


portfolio before change:  [0.14576601]
curr_Stock_Price:  97.7403919365232
curr_Factors:  [97.74039194 -0.37385293 -1.01684439]
mat_Sqrt:  [[24.32774783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00519531 -0.02523238 -0.49484991]
Stock Position:  -0.005195314466579603
Bond Position:  [0.65355809]


portfolio before change:  [0.1481162]
curr_Stock_Price:  97.30375065038919
curr_Factors:  [97.30375065 -0.38719088 -1.00664373]
mat_Sqrt:  [[24.14320381  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00907889 -0.08536677 -0.03961599]
Stock Position:  0.009078893285262617
Bond Position:  [-0.73529417]


portfolio before change:  [0.14714349]
curr_Stock_Price:  97.20673545262096
curr_Factors:  [97.20673545 -0.67458285 -1.02642013]
mat_Sqrt:  [[17.74026695  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00486193 -0.0214988  -0.11738949]
Stock Position:  0.004861931089406622
Bond Position:  [-0.32546895]


portfolio before change:  [0.14549912]
curr_Stock_Price:  96.876889996177
curr_Factors:  [96.87689    -0.67466397 -1.04960105]
mat_Sqrt:  [[17.27354218  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00681992  0.07025182  0.47564744]
Stock Position:  -0.006819915903705391
Bond Position:  [0.80619137]


portfolio before change:  [0.14390745]
curr_Stock_Price:  97.1250532915132
curr_Factors:  [97.12505329 -0.30908158 -1.02958378]
mat_Sqrt:  [[25.46573944  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00061427 -0.10593533 -0.24626858]
Stock Position:  0.0006142658525790697
Bond Position:  [0.08424685]


portfolio before change:  [0.14401972]
curr_Stock_Price:  97.29067847934337
curr_Factors:  [97.29067848 -0.22533569 -1.02526472]
mat_Sqrt:  [[27.85751513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00584215 -0.08432175  0.02938151]
Stock Position:  -0.005842150112748667
Bond Position:  [0.71240647]


portfolio before change:  [0.14655062]
curr_Stock_Price:  96.87270921672506
curr_Factors:  [96.87270922 -0.28606039 -1.02383801]
mat_Sqrt:  [[26.14085568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01078661 -0.04578936 -0.12256756]
Stock Position:  -0.010786606064892314
Bond Position:  [1.19147837]


portfolio before change:  [0.14860726]
curr_Stock_Price:  96.69585117268313
curr_Factors:  [96.69585117 -0.3901959  -1.04230509]
mat_Sqrt:  [[23.08237886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01316182 0.35070082 0.56751086]
Stock Position:  0.013161822075221433
Bond Position:  [-1.12408633]


portfolio before change:  [0.15658535]
curr_Stock_Price:  97.31268123394842
curr_Factors:  [97.31268123 -0.23314303 -1.05680735]
mat_Sqrt:  [[26.78866709  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01003876 -0.01525963  0.70113458]
Stock Position:  -0.010038756253323672
Bond Position:  [1.13348363]


portfolio before change:  [0.147192]
curr_Stock_Price:  98.26250406043998
curr_Factors:  [98.26250406 -0.15657177 -1.06395223]
mat_Sqrt:  [[28.99485832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324999  0.12334081 -0.07334388]
Stock Position:  -0.003249990124400594
Bond Position:  [0.46654417]


portfolio before change:  [0.15752524]
curr_Stock_Price:  95.10098185465885
curr_Factors:  [ 9.51009819e+01  1.86798967e-02 -1.03374267e+00]
mat_Sqrt:  [[34.46266349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0020516  -0.00922298  0.13807902]
Stock Position:  0.0020515992999748565
Bond Position:  [-0.03758387]


portfolio before change:  [0.15689138]
curr_Stock_Price:  94.79431298059916
curr_Factors:  [94.79431298  0.13601906 -1.00423389]
mat_Sqrt:  [[39.78518435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277782  0.01559305 -0.3101143 ]
Stock Position:  -0.0027778238368227817
Bond Position:  [0.42021328]


portfolio before change:  [0.15959757]
curr_Stock_Price:  93.83901024580378
curr_Factors:  [ 9.38390102e+01  5.65801563e-02 -1.01349217e+00]
mat_Sqrt:  [[36.04141322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219606 -0.02670725  0.08191095]
Stock Position:  -0.0021960560133124224
Bond Position:  [0.36567329]


portfolio before change:  [0.15764428]
curr_Stock_Price:  94.74927808721952
curr_Factors:  [94.74927809  0.09809324 -1.0453081 ]
mat_Sqrt:  [[36.74563206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258275  0.04060872  0.33939823]
Stock Position:  -0.002582754854502726
Bond Position:  [0.40235844]


portfolio before change:  [0.15826291]
curr_Stock_Price:  94.52923129361815
curr_Factors:  [ 9.45292313e+01 -5.27381689e-02 -1.05564647e+00]
mat_Sqrt:  [[31.20331908  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00110888 -0.04736657 -0.53863551]
Stock Position:  0.0011088757802176997
Bond Position:  [0.05344173]


portfolio before change:  [0.15625365]
curr_Stock_Price:  92.71122544823814
curr_Factors:  [ 9.27112254e+01  4.06681740e-02 -1.05809213e+00]
mat_Sqrt:  [[33.51743012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00428719 0.01309472 0.24580599]
Stock Position:  0.004287189299546434
Bond Position:  [-0.24121693]


portfolio before change:  [0.1520534]
curr_Stock_Price:  91.7385378371431
curr_Factors:  [91.73853784 -0.09321139 -1.06869767]
mat_Sqrt:  [[28.70391397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00631781  0.01084775  0.65465019]
Stock Position:  -0.006317811780843038
Bond Position:  [0.73164021]


portfolio before change:  [0.16556348]
curr_Stock_Price:  89.61460257512722
curr_Factors:  [89.61460258  0.17545091 -1.05916913]
mat_Sqrt:  [[37.03265421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00980817 -0.09975707 -1.57696314]
Stock Position:  -0.00980816757267262
Bond Position:  [1.04451852]


portfolio before change:  [0.20027896]
curr_Stock_Price:  86.08846913487527
curr_Factors:  [86.08846913  0.17223264 -1.07166088]
mat_Sqrt:  [[35.02097758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0134516  -0.14000763 -0.68359383]
Stock Position:  0.013451597799958814
Bond Position:  [-0.9577485]


portfolio before change:  [0.19694013]
curr_Stock_Price:  85.84915905778108
curr_Factors:  [85.84915906  0.5312033  -1.07508654]
mat_Sqrt:  [[49.8345518   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00413572 -0.01684332 -0.1206429 ]
Stock Position:  0.004135715716342836
Bond Position:  [-0.15810758]


portfolio before change:  [0.21171956]
curr_Stock_Price:  89.42754587167539
curr_Factors:  [89.42754587  0.6113192  -1.08879638]
mat_Sqrt:  [[55.47605998  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0007451   0.11458766 -0.39468954]
Stock Position:  0.0007451014655670388
Bond Position:  [0.14508696]


portfolio before change:  [0.21248787]
curr_Stock_Price:  90.43435402878832
curr_Factors:  [90.43435403  0.73842228 -1.03456862]
mat_Sqrt:  [[67.25409272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00292131 0.03503205 0.50411089]
Stock Position:  0.00292131226611821
Bond Position:  [-0.05169912]


portfolio before change:  [0.22738893]
curr_Stock_Price:  95.53737861289427
curr_Factors:  [95.53737861  0.6578864  -1.07785716]
mat_Sqrt:  [[62.7743664   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050124  0.04387635  0.31921463]
Stock Position:  -0.0005012372455087403
Bond Position:  [0.27527583]


portfolio before change:  [0.22887027]
curr_Stock_Price:  92.65067946185067
curr_Factors:  [92.65067946  0.70376306 -1.07207838]
mat_Sqrt:  [[64.10491044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00608794  0.03815589 -0.2478645 ]
Stock Position:  -0.006087939866748799
Bond Position:  [0.79292203]


portfolio before change:  [0.19942867]
curr_Stock_Price:  97.50301321556641
curr_Factors:  [97.50301322  0.6668304  -1.10627962]
mat_Sqrt:  [[62.83008786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00114949 -0.00860903  0.14125445]
Stock Position:  -0.0011494946285287666
Bond Position:  [0.31150786]


portfolio before change:  [0.19873426]
curr_Stock_Price:  98.14098914163203
curr_Factors:  [98.14098914  0.38974077 -1.09250466]
mat_Sqrt:  [[48.60085961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012986   0.01709322 -0.01149797]
Stock Position:  0.0012985957149318275
Bond Position:  [0.0712888]


portfolio before change:  [0.19653438]
curr_Stock_Price:  96.44007899960194
curr_Factors:  [96.440079    0.24970991 -1.06035781]
mat_Sqrt:  [[42.87436003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142629  0.05451681  0.05647677]
Stock Position:  -0.0014262931320496717
Bond Position:  [0.3340862]


portfolio before change:  [0.19753745]
curr_Stock_Price:  95.76609207327388
curr_Factors:  [95.76609207  0.3983672  -1.06014858]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.19753745]
Stock Price:  99.67690375931488
PL:  [0.19753745]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-7.44419268e-02 -2.11679804e-02 -2.13156506e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.10951434e-01  3.38075502e-02  2.54611629e-02]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.08929527e+00 -3.21704578e-01  2.60340121e-02]
 [-5.81151945e-02  7.10528918e-03  4.25133007e-02]
 [ 3.27421816e-02  3.31171021e-02 -1.93152480e-02]
 [ 3.00689846e-01  5.15511776e-02 -7.82743788e-02]
 [-4.48806520e-01 -2.44220977e-02 -5.01468855e-02]
 [ 5.06994136e-02 -2.29009757e-02 -4.40336406e-02]
 [ 6.16857464e-03 -2.66319219e-01  1.31364935e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.25528984e-01 -3.79512939e-02  2.86156176e-01]
 [ 4.79622679e-02  2.49160787e-01  2.04213606e-01]
 [ 7.97396781e-02 -1.13557733e-01 -5.77088921e-02]
 [-4.95522628e-02  7.63361283e-02  4.92227174e-02]
 [-4.54744247e-01 -2.55398319e-01  1.21544689e-01]
 [-1.59887361e-01  6.96389818e-03 -2.50219772e-02]
 [ 3.10382503e-01  1.27543922e+00  4.77313834e-01]
 [-1.81017621e-03  1.49896954e-03  3.76589217e-02]
 [-5.96775543e-02  3.81936635e-02 -2.51063140e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 8.19215925e-02 -3.98213415e-02  1.01681815e-01]
 [ 7.89961522e-02  1.27930563e-01  1.96862250e-02]
 [-5.97211313e-02 -1.94190859e-01  7.43517849e-02]
 [ 1.97121465e-02  6.19871596e-02 -1.52682614e-02]
 [ 3.08823043e-02 -6.72424039e-02  8.16606960e-02]
 [ 5.72267874e-02  5.84967521e-02 -7.34573683e-02]
 [-7.04374117e-01 -1.54282524e-01 -1.10256663e+00]
 [-6.29085097e-02  6.06923830e-03  3.23358870e-02]
 [-5.49218030e-02 -3.46647486e-02  1.15872732e-01]
 [ 1.35354846e-02  3.41203425e-02  1.96011166e-02]
 [-1.26925681e-01 -1.04569975e-02 -1.42899283e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 2.33482657e-01 -1.74134786e-01 -6.99537935e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [ 2.37648275e-02  1.28705874e-02 -2.20886364e-02]
 [-8.83468407e-02  1.24532791e-02 -6.11806740e-04]
 [ 2.58036222e-03 -2.72195836e-01  9.62003183e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.53130547]
curr_Stock_Price:  100.57732030439138
curr_Factors:  [100.5773203   -1.19731091  -1.01255041]
mat_Sqrt:  [[11.03492754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00718985 -0.0066939  -0.06080762]
Stock Position:  -0.007189854250963041
Bond Position:  [7.25444174]


portfolio before change:  [6.53572111]
curr_Stock_Price:  100.08930282446008
curr_Factors:  [100.08930282  -1.22766381  -1.00129948]
mat_Sqrt:  [[10.77360898  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421224  0.01411938  0.0859571 ]
Stock Position:  -0.004212241501188642
Bond Position:  [6.95732142]


portfolio before change:  [6.53606456]
curr_Stock_Price:  100.21424002062818
curr_Factors:  [100.21424002  -1.22574754  -1.02064255]
mat_Sqrt:  [[10.60070181  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02047238 0.01069089 0.07263361]
Stock Position:  0.020472378429060425
Bond Position:  [4.48444071]


portfolio before change:  [6.54281917]
curr_Stock_Price:  100.51679502183688
curr_Factors:  [100.51679502  -1.14212329  -1.02879123]
mat_Sqrt:  [[11.46627719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171835 -0.00659539  0.21422481]
Stock Position:  0.0017183479494033646
Bond Position:  [6.37009634]


portfolio before change:  [6.54439936]
curr_Stock_Price:  100.97297740003783
curr_Factors:  [100.9729774   -1.29566455  -1.00783894]
mat_Sqrt:  [[10.08802872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10827561 -0.10173192  0.07426779]
Stock Position:  -0.10827561149568506
Bond Position:  [17.47731023]


portfolio before change:  [6.552511]
curr_Stock_Price:  100.9182389482417
curr_Factors:  [100.91823895  -1.36452549  -1.00417528]
mat_Sqrt:  [[ 9.44617504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00521415  0.00224689  0.12127861]
Stock Position:  -0.005214147031953964
Bond Position:  [7.07871354]


portfolio before change:  [6.55735935]
curr_Stock_Price:  100.15810405385453
curr_Factors:  [100.15810405  -1.22020159  -1.01061676]
mat_Sqrt:  [[10.76103387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00275573  0.01047255 -0.05510103]
Stock Position:  0.002755734564717061
Bond Position:  [6.2813502]


portfolio before change:  [6.55647908]
curr_Stock_Price:  99.55373312135765
curr_Factors:  [99.55373312 -1.15381117 -1.00087417]
mat_Sqrt:  [[11.54222664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02478232  0.01630191 -0.22329502]
Stock Position:  0.024782324049311754
Bond Position:  [4.08930621]


portfolio before change:  [6.57562217]
curr_Stock_Price:  100.3055551033664
curr_Factors:  [100.3055551   -0.91702748  -0.99577072]
mat_Sqrt:  [[14.81178102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0310343  -0.00772295 -0.14305511]
Stock Position:  -0.03103430207321978
Bond Position:  [9.68853507]


portfolio before change:  [6.56206941]
curr_Stock_Price:  100.78128379867603
curr_Factors:  [100.7812838   -0.67669086  -0.98735567]
mat_Sqrt:  [[19.08506571  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215455 -0.00724192 -0.12561572]
Stock Position:  0.002154552902933024
Bond Position:  [6.3449308]


portfolio before change:  [6.56448543]
curr_Stock_Price:  101.53450532537137
curr_Factors:  [101.53450533  -0.94191576  -0.97113703]
mat_Sqrt:  [[14.98943936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00174169 -0.08421753  0.3747476 ]
Stock Position:  0.0017416926981664686
Bond Position:  [6.38764352]


portfolio before change:  [6.56546918]
curr_Stock_Price:  101.64086464598049
curr_Factors:  [101.64086465  -0.95791793  -0.97614752]
mat_Sqrt:  [[14.69313252  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0049088   0.00225658  0.15019092]
Stock Position:  -0.004908797935391559
Bond Position:  [7.06440365]


portfolio before change:  [6.56549866]
curr_Stock_Price:  101.81476147578617
curr_Factors:  [101.81476148  -1.13934985  -1.00400915]
mat_Sqrt:  [[11.93882981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01532482 -0.01200125  0.81632392]
Stock Position:  0.015324824431272695
Bond Position:  [5.00520532]


portfolio before change:  [6.56807195]
curr_Stock_Price:  101.94184926098906
curr_Factors:  [101.94184926  -1.13638894  -1.02222151]
mat_Sqrt:  [[11.77280368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00816122 0.07879156 0.58256458]
Stock Position:  0.008161224979818086
Bond Position:  [5.73610158]


portfolio before change:  [6.56029281]
curr_Stock_Price:  100.90080544019692
curr_Factors:  [100.90080544  -0.86113146  -1.00980159]
mat_Sqrt:  [[15.53669839  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00418544 -0.03591011 -0.16462741]
Stock Position:  0.004185435682929685
Bond Position:  [6.13797898]


portfolio before change:  [6.56150407]
curr_Stock_Price:  101.00687817523291
curr_Factors:  [101.00687818  -0.94995395  -0.99591612]
mat_Sqrt:  [[14.4301323   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260107  0.0241396   0.14041871]
Stock Position:  -0.0026010660569639535
Bond Position:  [6.82422963]


portfolio before change:  [6.56481468]
curr_Stock_Price:  100.06206134535296
curr_Factors:  [100.06206135  -1.02674788  -0.98262938]
mat_Sqrt:  [[13.41553476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03253902 -0.08076404  0.34673317]
Stock Position:  -0.032539023251323344
Bond Position:  [9.82073642]


portfolio before change:  [6.58048284]
curr_Stock_Price:  99.61827151692327
curr_Factors:  [99.61827152 -1.13056622 -0.9983003 ]
mat_Sqrt:  [[11.851792    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01390635  0.00220218 -0.07138074]
Stock Position:  -0.013906347960022611
Bond Position:  [7.96580919]


portfolio before change:  [6.57025859]
curr_Stock_Price:  100.42509971355544
curr_Factors:  [100.42509971  -1.05771672  -1.00851203]
mat_Sqrt:  [[12.72010008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03464953 0.4033293  1.36164351]
Stock Position:  0.03464952933398576
Bond Position:  [3.09057616]


portfolio before change:  [6.58063068]
curr_Stock_Price:  100.7132923234268
curr_Factors:  [100.71329232  -0.96938225  -1.0273061 ]
mat_Sqrt:  [[13.67527476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00043258 0.00047402 0.10743042]
Stock Position:  0.0004325779431035741
Bond Position:  [6.53706433]


portfolio before change:  [6.58159157]
curr_Stock_Price:  101.04550143764126
curr_Factors:  [101.04550144  -0.7485458   -1.01585475]
mat_Sqrt:  [[17.30802692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00368709  0.0120779  -0.07162133]
Stock Position:  -0.003687087114169994
Bond Position:  [6.95415514]


portfolio before change:  [6.58287918]
curr_Stock_Price:  100.93205422155954
curr_Factors:  [100.93205422  -0.40178492  -1.01992046]
mat_Sqrt:  [[24.35512194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00159592  0.01916992 -0.08961985]
Stock Position:  -0.0015959215386909431
Bond Position:  [6.74395882]


portfolio before change:  [6.58345174]
curr_Stock_Price:  101.10154355227226
curr_Factors:  [101.10154355  -0.31393084  -1.03775314]
mat_Sqrt:  [[26.16549131  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00388485 -0.01259261  0.29006991]
Stock Position:  0.0038848543747094923
Bond Position:  [6.19068697]


portfolio before change:  [6.58572317]
curr_Stock_Price:  101.48702737124266
curr_Factors:  [101.48702737  -0.44305442  -1.05799238]
mat_Sqrt:  [[22.62112466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0038158  0.0404552  0.05615932]
Stock Position:  0.0038158022752780097
Bond Position:  [6.19846874]


portfolio before change:  [6.5853965]
curr_Stock_Price:  101.19835069497394
curr_Factors:  [101.19835069  -0.59074978  -1.07141889]
mat_Sqrt:  [[19.20006742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258114 -0.06140854  0.21210495]
Stock Position:  -0.002581143184229708
Bond Position:  [6.84660393]


portfolio before change:  [6.58588602]
curr_Stock_Price:  101.34028417632581
curr_Factors:  [101.34028418  -0.50385447  -1.06524186]
mat_Sqrt:  [[21.10241871  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00086227  0.01960206 -0.0435561 ]
Stock Position:  0.0008622721171548828
Bond Position:  [6.49850312]


portfolio before change:  [6.58665894]
curr_Stock_Price:  101.29454056187475
curr_Factors:  [101.29454056  -0.6466914   -1.03078888]
mat_Sqrt:  [[18.92629523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00242071 -0.02126392  0.23295524]
Stock Position:  0.002420707912479524
Bond Position:  [6.34145445]


portfolio before change:  [6.59258214]
curr_Stock_Price:  103.41394541336129
curr_Factors:  [103.41394541  -0.66316037  -1.05698855]
mat_Sqrt:  [[18.5151792   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00236253  0.0184983  -0.20955343]
Stock Position:  0.002362534221609361
Bond Position:  [6.34826315]


portfolio before change:  [6.59330965]
curr_Stock_Price:  103.3859813469726
curr_Factors:  [103.38598135  -0.65374112  -1.04184226]
mat_Sqrt:  [[18.97051623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04920362 -0.04878842 -3.14531571]
Stock Position:  -0.04920362393695347
Bond Position:  [11.6802746]


portfolio before change:  [6.53187348]
curr_Stock_Price:  104.66426716802525
curr_Factors:  [104.66426717  -0.83877556  -1.04936759]
mat_Sqrt:  [[15.84120761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00354463  0.00191926  0.09224528]
Stock Position:  -0.003544633004930504
Bond Position:  [6.9028699]


portfolio before change:  [6.53406221]
curr_Stock_Price:  104.29023394139043
curr_Factors:  [104.29023394  -1.07184169  -1.05253352]
mat_Sqrt:  [[12.46347678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258069 -0.01096196  0.33055265]
Stock Position:  -0.002580694074465903
Bond Position:  [6.80320339]


portfolio before change:  [6.53740797]
curr_Stock_Price:  103.3233187523723
curr_Factors:  [103.32331875  -1.1263089   -1.07095175]
mat_Sqrt:  [[11.47995461  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00160432 0.0107898  0.05591653]
Stock Position:  0.0016043207334249824
Bond Position:  [6.37164423]


portfolio before change:  [6.53552561]
curr_Stock_Price:  101.65353529162964
curr_Factors:  [101.65353529  -1.13294393  -1.06590475]
mat_Sqrt:  [[11.27650812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01386643 -0.00330679 -0.40765188]
Stock Position:  -0.013866426764167257
Bond Position:  [7.94509691]


portfolio before change:  [6.53749255]
curr_Stock_Price:  101.58331259274048
curr_Factors:  [101.58331259  -0.94366445  -1.07766619]
mat_Sqrt:  [[13.45766241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389471  0.0049611   0.16678008]
Stock Position:  -0.003894710833177446
Bond Position:  [6.93313017]


portfolio before change:  [6.53821239]
curr_Stock_Price:  101.6210176631892
curr_Factors:  [101.62101766  -0.85732282  -1.079286  ]
mat_Sqrt:  [[14.65294816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01465284 -0.05506625 -0.1995587 ]
Stock Position:  0.014652836760910563
Bond Position:  [5.04917621]


portfolio before change:  [6.52054292]
curr_Stock_Price:  100.37206813811177
curr_Factors:  [100.37206814  -0.65619203  -1.08375301]
mat_Sqrt:  [[17.61831383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00139127 0.00777784 0.21633947]
Stock Position:  0.001391272961309091
Bond Position:  [6.38089798]


portfolio before change:  [6.51962793]
curr_Stock_Price:  99.14106857355932
curr_Factors:  [99.14106857 -0.63955095 -1.07804495]
mat_Sqrt:  [[17.79554025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00110074  0.00407004 -0.06301273]
Stock Position:  0.0011007432405314365
Bond Position:  [6.41049907]


portfolio before change:  [6.52102876]
curr_Stock_Price:  99.68567177168565
curr_Factors:  [99.68567177 -0.5867582  -1.07736885]
mat_Sqrt:  [[18.87606845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00466994  0.00393807 -0.00174531]
Stock Position:  -0.004669944020163373
Bond Position:  [6.98655527]


portfolio before change:  [6.52462936]
curr_Stock_Price:  99.1016766228932
curr_Factors:  [99.10167662 -0.68840856 -1.07863119]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.52462936]
Stock Price:  98.39423783870629
PL:  [6.52462936]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.90187170e-01  1.61150124e-02  1.30483142e-01]
 [-8.23912166e-02  5.52624991e-02  6.60751774e-02]
 [ 2.20662239e-01  2.46721578e-01  3.58710695e-01]
 [ 3.71712931e-03  4.50716772e-02  1.36217605e-01]
 [-1.46053706e-01 -5.45203715e-02  4.90844129e-02]
 [ 6.46408108e-02 -2.16079025e-01 -2.92330872e-01]
 [ 2.27524272e-02 -2.50626799e-01 -3.79852475e-02]
 [ 1.78737615e-01  1.77569627e-01 -4.49520607e-02]
 [-1.32310501e-01  1.80732541e-02 -8.82689464e-02]
 [ 1.23165103e-01  1.21051100e-02  1.76490849e-01]
 [ 1.87450897e-01 -2.68335652e-01 -3.15421277e-02]
 [-1.46009005e-01 -1.11193807e-01 -2.43579270e-01]
 [ 2.76008148e-01 -3.88131448e-01 -1.43045204e-01]
 [-5.24273627e-02 -1.86598234e-01 -1.13491315e-01]
 [-1.57184435e-01  2.21671150e-01  1.66125150e-01]
 [ 6.11682441e-02 -4.22561559e-01 -1.14166900e-01]
 [ 1.16537549e-01 -2.15345279e-01 -9.91966365e-02]
 [-2.74030443e-01 -1.23720249e-01 -4.53988322e-02]
 [ 2.78614840e-01  1.19984074e+00  3.62669265e-01]
 [-3.01348116e-01 -4.63390814e-02  2.38639939e-01]
 [-8.89641865e-02  6.26935212e-02 -4.10592595e-02]
 [ 1.44342421e-01 -4.01345352e-02  8.16819310e-02]
 [-1.08592895e-01  1.45090834e-02 -1.12701033e-01]
 [-7.82295589e-03 -1.10416824e-01  1.06889884e-01]
 [-1.03255043e-01  7.81505207e-02 -2.79743892e-02]
 [ 9.94182400e-02 -1.34684448e-01 -1.47870884e-01]
 [ 4.85575085e-02 -5.08284627e-02  1.11589044e-01]
 [-1.42098955e-01  4.03766242e-02  1.36303061e-01]
 [-4.41123169e-01 -1.43290133e-02 -6.46014996e-01]
 [ 2.28340961e-01 -1.52119599e-01 -1.66876485e-01]
 [ 1.34674225e-01  2.32036450e-03 -4.01123881e-02]
 [ 3.86313534e-02  2.17528484e-01 -6.88910120e-02]
 [-1.74720496e-01  2.71224156e-02 -1.56516927e-01]
 [-7.81011190e-03  1.39364040e-01  9.45976009e-02]
 [-2.67836867e-01  8.08216315e-02 -2.65258936e-02]
 [-1.79704361e-01 -6.49439686e-02 -2.71315564e-02]
 [ 2.76198109e-01  2.14115780e-01  7.82503056e-02]
 [-5.44225256e-02  2.93221302e-01  4.35959028e-02]
 [ 6.02350918e-04 -1.50900620e-01  3.88922756e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.69548901]
curr_Stock_Price:  99.76421619618073
curr_Factors:  [99.7642162  -0.988694   -0.98430056]
mat_Sqrt:  [[13.87120344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01176079  0.00509601  0.37223208]
Stock Position:  -0.011760790831971207
Bond Position:  [1.86879509]


portfolio before change:  [0.70539568]
curr_Stock_Price:  98.94173228556001
curr_Factors:  [98.94173229 -0.95084484 -0.96286957]
mat_Sqrt:  [[14.59700985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00462265  0.01747554  0.18849409]
Stock Position:  -0.004622645774109453
Bond Position:  [1.16276826]


portfolio before change:  [0.70329743]
curr_Stock_Price:  99.42708342183201
curr_Factors:  [99.42708342 -1.12600775 -0.96237831]
mat_Sqrt:  [[12.31771523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02437579 0.07802021 1.02330177]
Stock Position:  0.02437579303233284
Bond Position:  [-1.72031658]


portfolio before change:  [0.70713804]
curr_Stock_Price:  99.5934642022204
curr_Factors:  [99.5934642  -0.84287409 -0.94643947]
mat_Sqrt:  [[16.63955982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00196437 0.01425292 0.38859091]
Stock Position:  0.001964365492848936
Bond Position:  [0.51150008]


portfolio before change:  [0.70486086]
curr_Stock_Price:  98.40166990397199
curr_Factors:  [98.4016699  -0.6421141  -0.97673463]
mat_Sqrt:  [[19.49599472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00704976 -0.01724086  0.14002417]
Stock Position:  -0.00704976095685008
Bond Position:  [1.39856911]


portfolio before change:  [0.71050233]
curr_Stock_Price:  97.62623424846892
curr_Factors:  [97.62623425 -0.85266359 -0.99228308]
mat_Sqrt:  [[15.4282397   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.95453465e-05 -6.83301875e-02 -8.33938609e-01]
Stock Position:  -3.954534654784019e-05
Bond Position:  [0.71436299]


portfolio before change:  [0.710586]
curr_Stock_Price:  97.76874873530706
curr_Factors:  [97.76874874 -0.83826177 -0.97755648]
mat_Sqrt:  [[15.90743697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00053607 -0.07925515 -0.10836134]
Stock Position:  0.0005360740945147364
Bond Position:  [0.6581747]


portfolio before change:  [0.71104365]
curr_Stock_Price:  98.46897712206517
curr_Factors:  [98.46897712 -0.81509182 -0.97200817]
mat_Sqrt:  [[16.48814367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01056193  0.05615245 -0.12823572]
Stock Position:  0.010561931400798918
Bond Position:  [-0.32897893]


portfolio before change:  [0.7035238]
curr_Stock_Price:  97.76089413768871
curr_Factors:  [97.76089414 -0.98242306 -0.95996638]
mat_Sqrt:  [[14.01509832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01069287  0.00571526 -0.25180673]
Stock Position:  -0.010692873586090163
Bond Position:  [1.74886868]


portfolio before change:  [0.70977464]
curr_Stock_Price:  97.19675973127248
curr_Factors:  [97.19675973 -0.77293839 -0.94022662]
mat_Sqrt:  [[17.52401739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00910201 0.00382797 0.50347927]
Stock Position:  0.009102005281191584
Bond Position:  [-0.17491078]


portfolio before change:  [0.70450215]
curr_Stock_Price:  96.6198955572736
curr_Factors:  [96.61989556 -0.53180836 -0.96922321]
mat_Sqrt:  [[21.53658474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00808318 -0.08485518 -0.08998091]
Stock Position:  0.008083175317389982
Bond Position:  [-0.0764934]


portfolio before change:  [0.70553669]
curr_Stock_Price:  96.74906502716438
curr_Factors:  [96.74906503 -0.50909007 -0.97121096]
mat_Sqrt:  [[22.01710469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00902028 -0.03516257 -0.69486386]
Stock Position:  -0.009020279012219832
Bond Position:  [1.57824025]


portfolio before change:  [0.71883905]
curr_Stock_Price:  95.29621956377692
curr_Factors:  [95.29621956 -0.4009456  -0.98744988]
mat_Sqrt:  [[23.7740504   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00995992 -0.12273794 -0.40806815]
Stock Position:  0.009959920716802536
Bond Position:  [-0.23030374]


portfolio before change:  [0.70688632]
curr_Stock_Price:  94.09902684687002
curr_Factors:  [94.09902685 -0.33555987 -0.99867269]
mat_Sqrt:  [[24.78193969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324477 -0.05900754 -0.32375913]
Stock Position:  -0.0032447672431395076
Bond Position:  [1.01221576]


portfolio before change:  [0.69765784]
curr_Stock_Price:  96.98213574959405
curr_Factors:  [96.98213575 -0.53003988 -0.98704093]
mat_Sqrt:  [[21.27315583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00552578  0.07009857  0.47390881]
Stock Position:  -0.005525778921961365
Bond Position:  [1.23355968]


portfolio before change:  [0.70279722]
curr_Stock_Price:  96.07996745894091
curr_Factors:  [96.07996746 -0.48823244 -0.98643126]
mat_Sqrt:  [[21.98844596  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012258  -0.1336257  -0.32568639]
Stock Position:  0.0012258042590808068
Bond Position:  [0.58502199]


portfolio before change:  [0.70242844]
curr_Stock_Price:  95.71945587622673
curr_Factors:  [95.71945588 -0.48926409 -0.97042488]
mat_Sqrt:  [[22.23644499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00408019 -0.06809816 -0.28298039]
Stock Position:  0.004080190404568127
Bond Position:  [0.31187483]


portfolio before change:  [0.70478161]
curr_Stock_Price:  96.28663023733993
curr_Factors:  [96.28663024 -0.76421907 -0.95736291]
mat_Sqrt:  [[17.21442147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01664255 -0.03912378 -0.12951023]
Stock Position:  -0.016642550777701805
Bond Position:  [2.30723674]


portfolio before change:  [0.7096802]
curr_Stock_Price:  96.00961926883453
curr_Factors:  [96.00961927 -0.9954257  -0.95873242]
mat_Sqrt:  [[13.6029988   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02820144 0.37942296 1.03459447]
Stock Position:  0.028201439552527657
Bond Position:  [-1.99792928]


portfolio before change:  [0.70096271]
curr_Stock_Price:  95.70936029303725
curr_Factors:  [95.70936029 -0.98282101 -0.95561668]
mat_Sqrt:  [[13.77531756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01842661 -0.0146537   0.68077332]
Stock Position:  -0.01842661062782424
Bond Position:  [2.46456182]


portfolio before change:  [0.69356529]
curr_Stock_Price:  96.12753281799242
curr_Factors:  [96.12753282 -0.93827198 -0.9342136 ]
mat_Sqrt:  [[14.77874792  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00647732  0.01982543 -0.11713064]
Stock Position:  -0.006477316853131477
Bond Position:  [1.31621378]


portfolio before change:  [0.69660935]
curr_Stock_Price:  95.6829776723913
curr_Factors:  [95.68297767 -1.13095803 -0.91334161]
mat_Sqrt:  [[12.38815491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0129139  -0.01269165  0.23301581]
Stock Position:  0.012913901002832203
Bond Position:  [-0.53903115]


portfolio before change:  [0.70675516]
curr_Stock_Price:  96.47384524714788
curr_Factors:  [96.47384525 -1.16236507 -0.90905309]
mat_Sqrt:  [[12.15637567  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01079461  0.00458818 -0.32150468]
Stock Position:  -0.01079460507015575
Bond Position:  [1.74815222]


portfolio before change:  [0.71472989]
curr_Stock_Price:  95.75531928495965
curr_Factors:  [95.75531928 -1.02190387 -0.90098469]
mat_Sqrt:  [[13.99790422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079618 -0.03491687  0.30492709]
Stock Position:  0.0007961834912931766
Bond Position:  [0.63849109]


portfolio before change:  [0.71494767]
curr_Stock_Price:  95.9285933550092
curr_Factors:  [95.92859336 -1.02434851 -0.8922147 ]
mat_Sqrt:  [[14.1122171   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00757836  0.02471336 -0.07980315]
Stock Position:  -0.007578359397811014
Bond Position:  [1.44192902]


portfolio before change:  [0.71685595]
curr_Stock_Price:  95.70057150401752
curr_Factors:  [95.7005715  -1.1752111  -0.90412744]
mat_Sqrt:  [[11.96380365  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0054963  -0.04259096 -0.42183447]
Stock Position:  0.005496302570341653
Bond Position:  [0.19085665]


portfolio before change:  [0.71474213]
curr_Stock_Price:  95.31164185972223
curr_Factors:  [95.31164186 -1.12256409 -0.90092189]
mat_Sqrt:  [[12.59961155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00555756 -0.01607337  0.31833248]
Stock Position:  0.00555756352473721
Bond Position:  [0.18504163]


portfolio before change:  [0.71214698]
curr_Stock_Price:  94.84052127335364
curr_Factors:  [94.84052127 -1.21192631 -0.88570829]
mat_Sqrt:  [[11.64133541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00972686  0.01276821  0.38883469]
Stock Position:  -0.009726864297783425
Bond Position:  [1.63464786]


portfolio before change:  [0.71112715]
curr_Stock_Price:  94.96637633301131
curr_Factors:  [94.96637633 -1.11805903 -0.86429336]
mat_Sqrt:  [[13.08112698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04383112 -0.00453123 -1.84290097]
Stock Position:  -0.04383111655403863
Bond Position:  [4.87360946]


portfolio before change:  [0.72274441]
curr_Stock_Price:  94.71523010945411
curr_Factors:  [94.71523011 -1.20302352 -0.84985777]
mat_Sqrt:  [[12.15807448  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01565624 -0.04810444 -0.47605216]
Stock Position:  0.015656239869987987
Bond Position:  [-0.76013995]


portfolio before change:  [0.73495582]
curr_Stock_Price:  95.50127014112428
curr_Factors:  [95.50127014 -1.18228485 -0.85629392]
mat_Sqrt:  [[12.4355684   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01017615  0.00073376 -0.11442948]
Stock Position:  0.010176151656018234
Bond Position:  [-0.23687959]


portfolio before change:  [0.73213321]
curr_Stock_Price:  95.2268047230117
curr_Factors:  [95.22680472 -1.00606598 -0.85274731]
mat_Sqrt:  [[14.84180954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00203382  0.06878855 -0.19652688]
Stock Position:  0.00203382179888896
Bond Position:  [0.53845885]


portfolio before change:  [0.73028522]
curr_Stock_Price:  94.28508191175388
curr_Factors:  [94.28508191 -1.08983187 -0.84278802]
mat_Sqrt:  [[13.64950275  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01508986  0.00857686 -0.44649923]
Stock Position:  -0.015089859781595421
Bond Position:  [2.15303389]


portfolio before change:  [0.74040989]
curr_Stock_Price:  93.63195974107035
curr_Factors:  [93.63195974 -0.90386489 -0.83681647]
mat_Sqrt:  [[16.42312521  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00091931 0.04407078 0.26986062]
Stock Position:  0.0009193077675067311
Bond Position:  [0.6543333]


portfolio before change:  [0.73948771]
curr_Stock_Price:  92.53986328451107
curr_Factors:  [92.53986328 -0.73529635 -0.80942379]
mat_Sqrt:  [[19.74537663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01373307  0.02555804 -0.07567099]
Stock Position:  -0.013733069888683506
Bond Position:  [2.01034412]


portfolio before change:  [0.73301837]
curr_Stock_Price:  93.02924051397014
curr_Factors:  [93.02924051 -0.5873451  -0.81533584]
mat_Sqrt:  [[22.87930793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0081698  -0.02053709 -0.07739878]
Stock Position:  -0.008169801869374015
Bond Position:  [1.49304883]


portfolio before change:  [0.74216009]
curr_Stock_Price:  91.93312078599395
curr_Factors:  [91.93312079 -0.28905334 -0.80705123]
mat_Sqrt:  [[30.72131774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00969032 0.06770935 0.22322634]
Stock Position:  0.009690317764448486
Bond Position:  [-0.14870106]


portfolio before change:  [0.73216768]
curr_Stock_Price:  90.90386404384053
curr_Factors:  [90.90386404 -0.2386237  -0.80471922]
mat_Sqrt:  [[32.02316638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118516  0.09272472  0.12436698]
Stock Position:  -0.0011851609944182207
Bond Position:  [0.83990339]


portfolio before change:  [0.73128875]
curr_Stock_Price:  91.73406482739428
curr_Factors:  [91.73406483 -0.21236571 -0.78207164]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.73128875]
Stock Price:  90.57581910263833
PL:  [0.73128875]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-7.59763197e-02 -1.95783081e-02 -1.82617994e-02]
 [-2.75746417e-02  4.88239324e-03 -4.07437538e-02]
 [ 2.53267607e-01  8.64118707e-02  8.52892308e-02]
 [-1.02724293e-02  3.68236187e-02  1.27293127e-01]
 [-5.94809209e-01 -1.81635616e-01  3.81179812e-02]
 [ 2.82141870e-03 -1.09780481e-01 -1.34745425e-01]
 [ 3.62968608e-02 -3.05461674e-02 -2.36301249e-02]
 [ 2.38360255e-01  2.16852917e-02 -5.18098183e-02]
 [-2.65374495e-01  4.32712496e-03 -8.95893866e-02]
 [ 1.27926891e-01  2.08267197e-02  2.08125856e-01]
 [ 1.58928202e-01 -2.34675906e-01 -2.94442814e-02]
 [-8.72814093e-02 -7.88896370e-02 -1.71451567e-01]
 [ 2.35084726e-01 -2.35204539e-01  7.20471121e-02]
 [ 9.37436246e-02 -5.08736721e-02 -6.11328140e-02]
 [ 1.59320796e-02 -7.71008100e-02 -3.56943142e-02]
 [-2.48720937e-02 -7.81661524e-02 -2.94241865e-04]
 [-3.96354923e-01 -2.44775193e-01  9.82848227e-02]
 [-1.82017759e-01 -5.92576267e-02 -2.57748028e-02]
 [ 2.05012686e-01  9.73281778e-01  2.42536076e-01]
 [ 8.96050779e-03  1.21095167e-02  3.04524449e-02]
 [-5.86049537e-02  4.38587753e-02 -2.30089437e-02]
 [-2.87961183e-02  4.97014327e-02 -2.13939079e-02]
 [ 5.92280513e-02 -3.64069349e-02  7.74857245e-02]
 [ 6.08522868e-02  2.14280937e-01  8.44265731e-02]
 [-5.89342163e-02 -1.79163053e-01  9.86004392e-02]
 [ 1.43995225e-02  6.28123218e-02 -4.28741500e-03]
 [-8.72743818e-02 -1.02741590e-01  1.63922482e-01]
 [ 8.66598708e-02  7.06960972e-02 -8.47346479e-02]
 [-7.17219052e-01 -1.25959039e-01 -1.05608109e+00]
 [-4.04375851e-02 -4.88069477e-02  8.42886505e-02]
 [-2.05243281e-03 -5.32378270e-02  1.10959429e-01]
 [ 2.37930460e-02  9.24068460e-02 -7.98832955e-03]
 [-1.21487072e-01 -1.02360015e-02 -7.24848160e-02]
 [-6.04315729e-02  1.19149315e-01  1.24079236e-01]
 [ 1.59732782e-01 -1.61234738e-01 -1.00285988e-01]
 [-3.03318913e-02  2.66872151e-01  8.39191279e-02]
 [ 7.93359855e-02  6.74430364e-02 -3.12742231e-02]
 [-3.65269871e-02  7.99014618e-02 -8.74271789e-03]
 [-8.67595730e-02 -2.21359188e-01  6.78946355e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.6097189]
curr_Stock_Price:  100.30958571309031
curr_Factors:  [100.30958571  -1.14373599  -0.97530927]
mat_Sqrt:  [[12.05182385  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00665538 -0.0061912  -0.05209583]
Stock Position:  -0.006655383011088576
Bond Position:  [5.27731761]


portfolio before change:  [4.60495419]
curr_Stock_Price:  101.12462760397953
curr_Factors:  [101.1246276   -1.05729791  -1.00404583]
mat_Sqrt:  [[12.87142782  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277866  0.00154395 -0.11623059]
Stock Position:  -0.0027786631991832725
Bond Position:  [4.88594547]


portfolio before change:  [4.60777854]
curr_Stock_Price:  100.32799749977265
curr_Factors:  [100.3279975   -1.11596991  -0.96323259]
mat_Sqrt:  [[12.54399788  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02175609 0.02732583 0.24330644]
Stock Position:  0.021756089714416692
Bond Position:  [2.42503362]


portfolio before change:  [4.59246085]
curr_Stock_Price:  99.60999925522171
curr_Factors:  [99.60999926 -1.07375097 -0.94951052]
mat_Sqrt:  [[13.17078429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00126507 0.01164465 0.36313186]
Stock Position:  0.0012650691724019674
Bond Position:  [4.46644731]


portfolio before change:  [4.59313899]
curr_Stock_Price:  99.70469461579555
curr_Factors:  [99.70469462 -0.90796541 -0.99163921]
mat_Sqrt:  [[14.91859087  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03966314 -0.05743823  0.10873999]
Stock Position:  -0.03966314412720323
Bond Position:  [8.54774066]


portfolio before change:  [4.59455411]
curr_Stock_Price:  99.69595637293935
curr_Factors:  [99.69595637 -0.63946236 -0.98956037]
mat_Sqrt:  [[19.55248503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140739 -0.03471564 -0.38439119]
Stock Position:  -0.0014073861082951036
Bond Position:  [4.73486481]


portfolio before change:  [4.59507295]
curr_Stock_Price:  99.74786411672719
curr_Factors:  [99.74786412 -0.56749809 -0.96259102]
mat_Sqrt:  [[21.59704564  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00142078 -0.00965955 -0.06741017]
Stock Position:  0.0014207815102795173
Bond Position:  [4.45335303]


portfolio before change:  [4.59580341]
curr_Stock_Price:  99.87016336322661
curr_Factors:  [99.87016336 -0.79661234 -0.93817631]
mat_Sqrt:  [[17.62084063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01295878  0.00685749 -0.14779899]
Stock Position:  0.012958776331001207
Bond Position:  [3.3016083]


portfolio before change:  [4.5846417]
curr_Stock_Price:  98.97698950227411
curr_Factors:  [98.9769895  -0.6946479  -0.92598247]
mat_Sqrt:  [[19.575074    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01448526  0.00136836 -0.25557358]
Stock Position:  -0.014485264571777666
Bond Position:  [6.01834958]


portfolio before change:  [4.61490477]
curr_Stock_Price:  96.93969608722568
curr_Factors:  [96.93969609 -0.80396742 -0.93250733]
mat_Sqrt:  [[17.07498189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01001162 0.00658599 0.59372514]
Stock Position:  0.010011615121935798
Bond Position:  [3.64438185]


portfolio before change:  [4.61610178]
curr_Stock_Price:  97.01375261867071
curr_Factors:  [97.01375262 -0.85999213 -0.93751458]
mat_Sqrt:  [[16.0762984   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0091351  -0.07421104 -0.08399634]
Stock Position:  0.009135100835078586
Bond Position:  [3.72987136]


portfolio before change:  [4.62035891]
curr_Stock_Price:  97.42873119613265
curr_Factors:  [97.4287312  -0.7938902  -0.95429795]
mat_Sqrt:  [[16.96127833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00732938 -0.02494709 -0.4891036 ]
Stock Position:  -0.007329384793531143
Bond Position:  [5.33445157]


portfolio before change:  [4.61407528]
curr_Stock_Price:  98.37703363404403
curr_Factors:  [98.37703363 -0.91602176 -0.94963698]
mat_Sqrt:  [[15.22819501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01600441 -0.07437821  0.20553036]
Stock Position:  0.0160044132553057
Bond Position:  [3.03960858]


portfolio before change:  [4.621048]
curr_Stock_Price:  98.78896652719564
curr_Factors:  [98.78896653 -0.91612137 -0.9707748 ]
mat_Sqrt:  [[14.97062218  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00534055 -0.01608767 -0.1743949 ]
Stock Position:  0.0053405521603272
Bond Position:  [4.09346037]


portfolio before change:  [4.62458788]
curr_Stock_Price:  99.35597954613164
curr_Factors:  [99.35597955 -1.00730265 -0.97169326]
mat_Sqrt:  [[13.7317853   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00048466 -0.02438142 -0.10182594]
Stock Position:  0.0004846619495909362
Bond Position:  [4.57643382]


portfolio before change:  [4.62519197]
curr_Stock_Price:  99.42201130225878
curr_Factors:  [99.4220113  -0.8100513  -0.96959922]
mat_Sqrt:  [[16.77220426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00160685 -0.02471831 -0.00083939]
Stock Position:  -0.001606848836190663
Bond Position:  [4.78494812]


portfolio before change:  [4.62662389]
curr_Stock_Price:  98.9031299731054
curr_Factors:  [98.90312997 -0.75055567 -0.95716349]
mat_Sqrt:  [[17.92903953  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02134039 -0.07740471  0.28037924]
Stock Position:  -0.021340389438477738
Bond Position:  [6.7372552]


portfolio before change:  [4.60151019]
curr_Stock_Price:  100.11941109271775
curr_Factors:  [100.11941109  -0.6467625   -0.96067973]
mat_Sqrt:  [[20.06388339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00941039 -0.01873891 -0.07352834]
Stock Position:  -0.009410393793945523
Bond Position:  [5.54367327]


portfolio before change:  [4.58810581]
curr_Stock_Price:  101.61747641389898
curr_Factors:  [101.61747641  -0.62024757  -0.98522914]
mat_Sqrt:  [[20.40416042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01370555 0.30777872 0.69188791]
Stock Position:  0.013705547151735688
Bond Position:  [3.19538269]


portfolio before change:  [4.59976974]
curr_Stock_Price:  102.4393684298406
curr_Factors:  [102.43936843  -0.57845877  -1.02620605]
mat_Sqrt:  [[20.58589788  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00075242 0.00382937 0.08687235]
Stock Position:  0.0007524205911988725
Bond Position:  [4.52269225]


portfolio before change:  [4.59931905]
curr_Stock_Price:  101.08898972432407
curr_Factors:  [101.08898972  -0.70408076  -1.0309342 ]
mat_Sqrt:  [[17.83185125  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00348641  0.01386936 -0.06563811]
Stock Position:  -0.0034864134473099047
Bond Position:  [4.95175707]


portfolio before change:  [4.60225534]
curr_Stock_Price:  100.42433156129515
curr_Factors:  [100.42433156  -0.72856497  -1.05729122]
mat_Sqrt:  [[16.83648627  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018935   0.01571697 -0.06103086]
Stock Position:  -0.0018934975777142838
Bond Position:  [4.79240856]


portfolio before change:  [4.60212093]
curr_Stock_Price:  100.81170491602496
curr_Factors:  [100.81170492  -0.81170372  -1.04938414]
mat_Sqrt:  [[15.67656013  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0047271  -0.01151288  0.2210452 ]
Stock Position:  0.004727104348200732
Bond Position:  [4.12557349]


portfolio before change:  [4.60007551]
curr_Stock_Price:  100.26990361860148
curr_Factors:  [100.26990362  -0.73335784  -1.04135972]
mat_Sqrt:  [[16.9988896   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00491906 0.06776158 0.24084551]
Stock Position:  0.004919056527067628
Bond Position:  [4.10684219]


portfolio before change:  [4.60733094]
curr_Stock_Price:  101.64049929217965
curr_Factors:  [101.64049929  -0.66670862  -1.05117453]
mat_Sqrt:  [[18.23894093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238136 -0.05665633  0.28127961]
Stock Position:  -0.0023813584489531183
Bond Position:  [4.8493734]


portfolio before change:  [4.60293813]
curr_Stock_Price:  103.73972900486496
curr_Factors:  [103.739729    -0.70950632  -1.04899225]
mat_Sqrt:  [[17.87470504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084735  0.019863   -0.0122308 ]
Stock Position:  0.0008473518682542463
Bond Position:  [4.51503407]


portfolio before change:  [4.60491415]
curr_Stock_Price:  105.40563258332526
curr_Factors:  [105.40563258  -0.84752643  -1.0343272 ]
mat_Sqrt:  [[16.05407079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00351728 -0.03248974  0.46762521]
Stock Position:  -0.0035172774831521013
Bond Position:  [4.97565501]


portfolio before change:  [4.60588206]
curr_Stock_Price:  105.30728422806547
curr_Factors:  [105.30728423  -1.05388335  -1.04846574]
mat_Sqrt:  [[12.86529675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0055334   0.02235607 -0.24172436]
Stock Position:  0.005533401208557879
Bond Position:  [4.02317461]


portfolio before change:  [4.60902042]
curr_Stock_Price:  105.78356033833265
curr_Factors:  [105.78356034  -1.1076771   -1.04768211]
mat_Sqrt:  [[12.25624877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07637271 -0.03983175 -3.0127054 ]
Stock Position:  -0.07637271144205211
Bond Position:  [12.68799775]


portfolio before change:  [4.61707231]
curr_Stock_Price:  105.69889928895343
curr_Factors:  [105.69889929  -0.92236215  -1.06389046]
mat_Sqrt:  [[14.50280185  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168881 -0.01543411  0.24045206]
Stock Position:  -0.001688806524820376
Bond Position:  [4.7955773]


portfolio before change:  [4.62029065]
curr_Stock_Price:  104.14818705026231
curr_Factors:  [104.14818705  -0.67279063  -1.05362763]
mat_Sqrt:  [[18.53010109  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103736 -0.01683528  0.31653637]
Stock Position:  0.0010373646087588617
Bond Position:  [4.51225101]


portfolio before change:  [4.62102278]
curr_Stock_Price:  104.3101988982399
curr_Factors:  [104.3101989   -0.55418049  -1.06478034]
mat_Sqrt:  [[20.66431519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118796  0.02922161 -0.02278848]
Stock Position:  0.0011879595000432184
Bond Position:  [4.49710649]


portfolio before change:  [4.62152196]
curr_Stock_Price:  104.2571684054569
curr_Factors:  [104.25716841  -0.81513946  -1.07844663]
mat_Sqrt:  [[15.69393804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00870064 -0.00323691 -0.206779  ]
Stock Position:  -0.008700637484853183
Bond Position:  [5.52862578]


portfolio before change:  [4.62138063]
curr_Stock_Price:  104.3528444899136
curr_Factors:  [104.35284449  -0.7720223   -1.08472744]
mat_Sqrt:  [[16.29776778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196515  0.03767832  0.35396352]
Stock Position:  -0.001965151494316745
Bond Position:  [4.82644978]


portfolio before change:  [4.62108777]
curr_Stock_Price:  104.80889730793943
curr_Factors:  [104.80889731  -0.86124593  -1.09937114]
mat_Sqrt:  [[14.75410864  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0091567  -0.0509869  -0.28608801]
Stock Position:  0.009156698720846962
Bond Position:  [3.66138427]


portfolio before change:  [4.62952111]
curr_Stock_Price:  105.6799145284354
curr_Factors:  [105.67991453  -0.90281637  -1.10048049]
mat_Sqrt:  [[14.25514637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044274  0.08439238  0.23939791]
Stock Position:  -0.0004427426849229204
Bond Position:  [4.67631012]


portfolio before change:  [4.63029276]
curr_Stock_Price:  105.25737986008653
curr_Factors:  [105.25737986  -0.82338878  -1.08360855]
mat_Sqrt:  [[15.633425    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00477781  0.02132736 -0.08921665]
Stock Position:  0.004777809924345271
Bond Position:  [4.127393]


portfolio before change:  [4.62892168]
curr_Stock_Price:  104.86242111098223
curr_Factors:  [104.86242111  -0.7247338   -1.07200937]
mat_Sqrt:  [[17.39018642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208443  0.02526706 -0.02494054]
Stock Position:  -0.0020844250386120957
Bond Position:  [4.84749953]


portfolio before change:  [4.63031965]
curr_Stock_Price:  104.48246009904037
curr_Factors:  [104.4824601   -0.73888788  -1.10735771]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.63031965]
Stock Price:  103.04120827439704
PL:  [1.58911138]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.87669065e-02 -2.18931235e-02  2.83657387e-03]
 [-4.93548125e-02  3.93761421e-02  2.07332598e-02]
 [ 2.72729317e-01  2.31676517e-01  3.04523541e-01]
 [-5.90347354e-03  4.59428794e-03  9.93046587e-02]
 [-6.87786485e-01 -2.07972517e-01  3.58458554e-02]
 [-9.54492916e-03 -8.60599288e-02 -9.87729127e-02]
 [ 1.17759218e-02  1.28448231e-01  6.65705529e-02]
 [ 2.64324377e-01 -4.32364285e-01 -1.13043589e-02]
 [-5.40046694e-01 -2.37454196e-02 -9.35882008e-02]
 [ 4.06245158e-02 -5.78480749e-03 -3.60131062e-02]
 [ 1.71858391e-02 -3.18654798e-01  2.45621425e-01]
 [-4.54716950e-01  8.31239439e-02  4.17600748e-01]
 [ 3.51289032e-02  1.28836398e-02  2.09513615e-01]
 [ 7.40963635e-02 -5.84729224e-02 -8.07290674e-02]
 [ 8.46480247e-02 -1.19979196e-01 -5.10399706e-02]
 [-1.68876127e-02 -4.96706567e-03  3.65961379e-02]
 [-6.22491575e-01 -7.15451973e-02  2.19710754e-01]
 [-1.13716934e-01  1.92528158e-02 -3.16735239e-02]
 [-6.47159197e-02  4.35749789e-01 -1.46065034e-02]
 [-1.57219882e-02  4.35505334e-02  2.24466570e-02]
 [ 1.53432305e-01 -2.77154707e-01  2.55835769e-01]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 3.14581756e-01  3.67120722e-02  2.77357965e-01]
 [ 7.67520522e-02 -2.01769030e-01 -8.84245904e-02]
 [-1.22066548e-01  2.36247628e-01  2.11941510e-01]
 [ 2.76895615e-03  6.06337268e-02  5.87905630e-02]
 [ 1.15888341e-01  4.98620341e-02  6.61079915e-01]
 [ 3.26718147e-02  5.39278036e-02 -6.68779410e-02]
 [-6.17569425e-01 -1.84304666e-01 -1.01603413e+00]
 [ 2.95502523e-01 -2.16518116e-01 -1.82997456e-01]
 [ 1.48221722e-01  8.27918342e-03 -2.98208930e-02]
 [ 5.48940997e-02  3.27647605e-01 -1.21742968e-01]
 [ 1.16562919e-01  8.93430360e-02  9.61585536e-02]
 [ 1.39231633e-02  1.33482401e-01  9.43565734e-02]
 [-3.54444861e-01  1.11866733e-01 -7.63867836e-02]
 [-2.72448972e-01 -9.50949243e-02 -4.43016147e-02]
 [ 3.99639124e-01  2.86321938e-01  1.05127026e-01]
 [ 2.31395501e-02  3.00336426e-01  6.32345578e-02]
 [ 6.36126507e-04 -1.52971800e-01  3.98708407e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.45614875]
curr_Stock_Price:  100.14885882413276
curr_Factors:  [100.14885882  -1.12368049  -1.01234551]
mat_Sqrt:  [[11.82991716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00834775 -0.00692321  0.00809196]
Stock Position:  -0.008347748337574477
Bond Position:  [4.29216622]


portfolio before change:  [3.45064596]
curr_Stock_Price:  100.87232888540811
curr_Factors:  [100.87232889  -1.05778197  -1.04427721]
mat_Sqrt:  [[12.32705527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357798  0.01245183  0.05914622]
Stock Position:  -0.003577980706824981
Bond Position:  [3.81156521]


portfolio before change:  [3.45436188]
curr_Stock_Price:  99.96694570330529
curr_Factors:  [99.9669457  -0.80698528 -1.03285477]
mat_Sqrt:  [[15.87903264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02146679 0.07326255 0.8687209 ]
Stock Position:  0.02146678545128485
Bond Position:  [1.3083929]


portfolio before change:  [3.47006968]
curr_Stock_Price:  100.69105220059316
curr_Factors:  [100.6910522   -0.55578698  -1.07734099]
mat_Sqrt:  [[19.66674167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00073655 0.00145284 0.28328855]
Stock Position:  0.0007365545998530879
Bond Position:  [3.39590522]


portfolio before change:  [3.47092547]
curr_Stock_Price:  101.2765930468017
curr_Factors:  [101.27659305  -0.69780254  -1.08687543]
mat_Sqrt:  [[16.99938817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04034494 -0.06576668  0.10225825]
Stock Position:  -0.04034494072056132
Bond Position:  [7.55692362]


portfolio before change:  [3.51510424]
curr_Stock_Price:  100.20498183330399
curr_Factors:  [100.20498183  -0.44721997  -1.09865525]
mat_Sqrt:  [[21.3562125   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149506 -0.02721454 -0.28177163]
Stock Position:  -0.0014950648834650831
Bond Position:  [3.66491719]


portfolio before change:  [3.51259664]
curr_Stock_Price:  102.18867079802855
curr_Factors:  [102.1886708   -0.36328058  -1.08652139]
mat_Sqrt:  [[23.97517351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00119628 0.0406189  0.18990726]
Stock Position:  0.001196283233361107
Bond Position:  [3.39035005]


portfolio before change:  [3.51462493]
curr_Stock_Price:  103.52988016748631
curr_Factors:  [103.52988017  -0.31141035  -1.09281354]
mat_Sqrt:  [[25.42254509  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00986736 -0.13672559 -0.03224819]
Stock Position:  0.009867355345226593
Bond Position:  [2.49305881]


portfolio before change:  [3.51127228]
curr_Stock_Price:  103.158524999418
curr_Factors:  [ 1.03158525e+02 -4.02153955e-02 -1.07489964e+00]
mat_Sqrt:  [[33.82336522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01654961 -0.00750896 -0.26698109]
Stock Position:  -0.016549607217146503
Bond Position:  [5.21850535]


portfolio before change:  [3.51856363]
curr_Stock_Price:  102.75736785156943
curr_Factors:  [ 1.02757368e+02  1.01265281e-01 -1.07402138e+00]
mat_Sqrt:  [[38.84636327  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085269 -0.00182932 -0.10273537]
Stock Position:  0.0008526926442539955
Bond Position:  [3.43094318]


portfolio before change:  [3.52163737]
curr_Stock_Price:  105.85912619922023
curr_Factors:  [ 1.05859126e+02 -2.04499500e-03 -1.09360146e+00]
mat_Sqrt:  [[35.39118427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166978 -0.10076749  0.70068956]
Stock Position:  0.0016697794155735332
Bond Position:  [3.34487598]


portfolio before change:  [3.5255079]
curr_Stock_Price:  107.92669820927898
curr_Factors:  [107.92669821   0.12607521  -1.09307813]
mat_Sqrt:  [[41.03598482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00895137  0.0262861   1.1912987 ]
Stock Position:  -0.008951370481579249
Bond Position:  [4.49159976]


portfolio before change:  [3.56978262]
curr_Stock_Price:  103.04328575291892
curr_Factors:  [103.04328575   0.13097553  -1.07235006]
mat_Sqrt:  [[40.19628644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00194616 0.00407416 0.59768403]
Stock Position:  0.001946158508342894
Bond Position:  [3.36924405]


portfolio before change:  [3.5678482]
curr_Stock_Price:  101.83290117783676
curr_Factors:  [101.83290118   0.24549388  -1.07650044]
mat_Sqrt:  [[44.35949084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00126484 -0.01849076 -0.23029756]
Stock Position:  0.0012648442581256357
Bond Position:  [3.43904544]


portfolio before change:  [3.57121434]
curr_Stock_Price:  104.15431901173208
curr_Factors:  [ 1.04154319e+02  3.36273915e-02 -1.07926228e+00]
mat_Sqrt:  [[36.60697321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194312 -0.03794075 -0.14560283]
Stock Position:  0.0019431184437915514
Bond Position:  [3.36883016]


portfolio before change:  [3.57461937]
curr_Stock_Price:  105.68994650706395
curr_Factors:  [ 1.05689947e+02 -2.15199918e-02 -1.08475733e+00]
mat_Sqrt:  [[34.96097544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027304 -0.00157072  0.10439859]
Stock Position:  -0.0002730389050529287
Bond Position:  [3.60347684]


portfolio before change:  [3.57445215]
curr_Stock_Price:  107.95219840229937
curr_Factors:  [ 1.07952198e+02 -6.84636690e-02 -1.07256920e+00]
mat_Sqrt:  [[34.48952482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01680193 -0.02262458  0.62677363]
Stock Position:  -0.016801930362090173
Bond Position:  [5.38825747]


portfolio before change:  [3.56519444]
curr_Stock_Price:  108.54327852931192
curr_Factors:  [ 1.08543279e+02  6.94487587e-02 -1.06583964e+00]
mat_Sqrt:  [[40.0752161   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298651  0.00608827 -0.09035575]
Stock Position:  -0.0029865131402228703
Bond Position:  [3.88936037]


portfolio before change:  [3.56837399]
curr_Stock_Price:  107.64144163812817
curr_Factors:  [ 1.07641442e+02 -9.31139584e-02 -1.07204406e+00]
mat_Sqrt:  [[33.57049972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168143  0.13779618 -0.04166829]
Stock Position:  -0.001681430096637998
Bond Position:  [3.74936555]


portfolio before change:  [3.56665374]
curr_Stock_Price:  108.9432821425471
curr_Factors:  [108.94328214  -0.15270199  -1.10262832]
mat_Sqrt:  [[31.04684173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003226   0.01377189  0.06403406]
Stock Position:  -0.00032259685835957935
Bond Position:  [3.6017985]


portfolio before change:  [3.56705337]
curr_Stock_Price:  109.10018400861445
curr_Factors:  [109.10018401   0.15428875  -1.11522139]
mat_Sqrt:  [[41.73474262  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00475619 -0.08764401  0.72982824]
Stock Position:  0.004756192226725737
Bond Position:  [3.04815193]


portfolio before change:  [3.56321743]
curr_Stock_Price:  108.21355341303419
curr_Factors:  [108.21355341   0.27795479  -1.13063626]
mat_Sqrt:  [[46.12823151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084263  0.01916992 -0.08961985]
Stock Position:  -0.0008426263574067306
Bond Position:  [3.65440102]


portfolio before change:  [3.56427658]
curr_Stock_Price:  107.49873857130918
curr_Factors:  [107.49873857   0.39008648  -1.11712575]
mat_Sqrt:  [[51.95821501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00716239 0.01160938 0.79122507]
Stock Position:  0.007162392219537988
Bond Position:  [2.79432845]


portfolio before change:  [3.54974262]
curr_Stock_Price:  105.42076273707755
curr_Factors:  [105.42076274   0.38964906  -1.11300392]
mat_Sqrt:  [[51.14193171  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104597 -0.06380497 -0.25225074]
Stock Position:  0.001045967613605453
Bond Position:  [3.43947591]


portfolio before change:  [3.55282589]
curr_Stock_Price:  107.95747018176824
curr_Factors:  [107.95747018   0.59609236  -1.12211009]
mat_Sqrt:  [[63.79785883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011396   0.07470806  0.60461014]
Stock Position:  -0.001139603779375217
Bond Position:  [3.67585463]


portfolio before change:  [3.55114415]
curr_Stock_Price:  109.83641348365465
curr_Factors:  [109.83641348   0.46607675  -1.13168893]
mat_Sqrt:  [[56.45139074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00028937 0.01917407 0.16771311]
Stock Position:  0.00028936551328277656
Bond Position:  [3.51936128]


portfolio before change:  [3.5514871]
curr_Stock_Price:  109.50121658580817
curr_Factors:  [109.50121659   0.51552764  -1.10371612]
mat_Sqrt:  [[60.80957041  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00414603 0.01576776 1.88587699]
Stock Position:  0.004146027416313515
Bond Position:  [3.09749206]


portfolio before change:  [3.52615935]
curr_Stock_Price:  103.29890222982053
curr_Factors:  [103.29890223   0.49158488  -1.07490023]
mat_Sqrt:  [[57.64545445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035411  0.01705347 -0.19078415]
Stock Position:  0.00035410983023012485
Bond Position:  [3.48958019]


portfolio before change:  [3.52399718]
curr_Stock_Price:  95.9610769047895
curr_Factors:  [95.9610769   0.77532698 -1.04733548]
mat_Sqrt:  [[ 7.31077334e+01  0.00000000e+00  0.00000000e+00]
 [-8.16496581e-02  3.16227766e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [-0.01134935 -0.05828225 -2.89846256]
Stock Position:  -0.011349349931726324
Bond Position:  [4.61309302]


portfolio before change:  [3.55456019]
curr_Stock_Price:  93.31895745436576
curr_Factors:  [93.31895745  0.51517178 -1.04523223]
mat_Sqrt:  [[54.92468174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00459826 -0.06846904 -0.52204081]
Stock Position:  0.004598257866479056
Bond Position:  [3.12545556]


portfolio before change:  [3.54908412]
curr_Stock_Price:  92.04308749770496
curr_Factors:  [92.0430875   0.46285873 -1.06065984]
mat_Sqrt:  [[50.62551495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00281179  0.00261811 -0.08507071]
Stock Position:  0.002811790163082639
Bond Position:  [3.29027827]


portfolio before change:  [3.54610689]
curr_Stock_Price:  90.837971720384
curr_Factors:  [90.83797172  0.33566197 -1.04543207]
mat_Sqrt:  [[44.67023026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00086194  0.10361127 -0.3472988 ]
Stock Position:  0.0008619441839508576
Bond Position:  [3.46780963]


portfolio before change:  [3.54762905]
curr_Stock_Price:  92.10099258983868
curr_Factors:  [92.10099259  0.23364561 -1.04897883]
mat_Sqrt:  [[40.75393876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0033984  0.02825275 0.27431359]
Stock Position:  0.0033983961435530073
Bond Position:  [3.23463339]


portfolio before change:  [3.54652523]
curr_Stock_Price:  91.65720336071227
curr_Factors:  [91.65720336  0.27144178 -1.06410545]
mat_Sqrt:  [[41.48748829  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00088292 0.04221084 0.26917304]
Stock Position:  0.0008829196569122311
Bond Position:  [3.46559929]


portfolio before change:  [3.54738651]
curr_Stock_Price:  92.14201835507055
curr_Factors:  [92.14201836  0.20767008 -1.0931761 ]
mat_Sqrt:  [[38.00907855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0096595   0.03537537 -0.21791023]
Stock Position:  -0.009659504404977532
Bond Position:  [4.43743275]


portfolio before change:  [3.5750306]
curr_Stock_Price:  89.33759126766662
curr_Factors:  [89.33759127  0.45859417 -1.09592426]
mat_Sqrt:  [[47.23297461  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00601163 -0.03007166 -0.12638018]
Stock Position:  -0.00601163369163869
Bond Position:  [4.11209548]


portfolio before change:  [3.58105743]
curr_Stock_Price:  88.42057252512431
curr_Factors:  [88.42057253  0.57101113 -1.10841193]
mat_Sqrt:  [[51.66103708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00829428 0.09054295 0.29989814]
Stock Position:  0.00829427579394033
Bond Position:  [2.84767281]


portfolio before change:  [3.57955715]
curr_Stock_Price:  88.19677241119057
curr_Factors:  [88.19677241  0.55213016 -1.10882848]
mat_Sqrt:  [[50.54540547  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00086659 0.09497472 0.18039059]
Stock Position:  0.0008665852595108543
Bond Position:  [3.50312713]


portfolio before change:  [3.57742627]
curr_Stock_Price:  85.23249307305625
curr_Factors:  [85.23249307  0.26034237 -1.15231858]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.57742627]
Stock Price:  84.10400419302478
PL:  [3.57742627]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.17965398e-01 -4.06119518e-03  3.91206863e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 1.76647054e-01  1.99125933e-01  3.07764076e-01]
 [-1.68488804e-02  3.54012466e-02  1.23928980e-01]
 [-4.01118522e-01 -1.26770464e-01  4.28512840e-02]
 [ 2.32482137e-02 -1.48962206e-01 -1.94165000e-01]
 [ 2.49809051e-02 -2.22301927e-01 -3.24359660e-02]
 [ 2.28585126e-01  8.54856995e-02 -5.45123244e-02]
 [-3.54302168e-01 -4.05715958e-04 -1.09224816e-01]
 [ 3.24265156e-02  8.14271349e-03 -2.94867529e-02]
 [-1.06261641e-02 -1.82046430e-01  2.44109302e-02]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.63624208e-01 -9.66910137e-02  2.21886217e-01]
 [ 8.88921877e-02 -3.18854096e-02 -7.56591889e-02]
 [ 7.90449962e-02 -1.12983494e-01 -5.45453881e-02]
 [-3.51920493e-02  4.05931701e-02  4.36717509e-02]
 [-4.46659142e-01 -2.41861994e-01  1.17033324e-01]
 [-1.23604350e-01  1.86104739e-02 -2.34415798e-02]
 [ 3.18350894e-01  1.36179769e+00  4.60021410e-01]
 [-3.88086967e-02  4.23679814e-04  6.63290694e-02]
 [-6.87048495e-02  3.95669743e-02 -3.04490012e-02]
 [ 7.79957856e-03  3.25714333e-02  3.49119761e-04]
 [ 3.26405508e-02 -3.16793854e-02  4.97400608e-02]
 [ 4.61650290e-02  8.34773607e-02  6.84754806e-02]
 [-6.19144874e-02 -1.28407206e-01  1.70132573e-02]
 [ 1.98063282e-02  5.96902979e-02 -1.84369296e-02]
 [-1.93238793e-01  2.69731664e-02  1.71763167e-01]
 [ 4.43087348e-04  4.37830016e-02 -6.33085705e-02]
 [-3.80461963e-01  7.77964559e-02 -4.70045196e-01]
 [-1.90495635e-01  1.12597179e-01 -4.33332498e-02]
 [-9.37998336e-02  6.72253087e-02  1.53285338e-01]
 [ 5.00030124e-03 -4.23914262e-02  4.23735495e-02]
 [-1.36867656e-01 -2.50154433e-03 -1.31306460e-01]
 [-5.78465989e-02 -2.98761268e-01 -1.51735467e-01]
 [ 1.65827922e-01 -1.56515831e-01 -8.72318421e-02]
 [ 1.59722911e-02  1.52963810e-02  7.39587076e-02]
 [-4.93317980e-02 -5.36432101e-02 -5.00871141e-02]
 [-9.98635088e-02 -2.20602861e-02  2.46882558e-03]
 [-4.06054957e-02 -3.46053656e-01  1.59460277e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.40220351]
curr_Stock_Price:  100.00201267028959
curr_Factors:  [100.00201267  -1.1422058   -0.99681518]
mat_Sqrt:  [[11.77724563  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00934724 -0.00128426  0.11160043]
Stock Position:  -0.009347243318774122
Bond Position:  [3.33694666]


portfolio before change:  [2.40793321]
curr_Stock_Price:  99.43365822358258
curr_Factors:  [99.43365822 -1.18038894 -1.01070877]
mat_Sqrt:  [[11.11608277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00408247  0.01411938  0.0859571 ]
Stock Position:  -0.004082467158907184
Bond Position:  [2.81386785]


portfolio before change:  [2.40889875]
curr_Stock_Price:  99.28330998340333
curr_Factors:  [99.28330998 -1.22584499 -1.0271853 ]
mat_Sqrt:  [[10.43272176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02344647 0.06296915 0.87796525]
Stock Position:  0.023446474312390216
Bond Position:  [0.08105518]


portfolio before change:  [2.41608969]
curr_Stock_Price:  99.58957379483059
curr_Factors:  [99.58957379 -1.0314548  -1.0512316 ]
mat_Sqrt:  [[12.40836794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0007545  0.01119486 0.35353488]
Stock Position:  0.0007544967157436519
Bond Position:  [2.34094969]


portfolio before change:  [2.41606884]
curr_Stock_Price:  99.17407723454079
curr_Factors:  [99.17407723 -0.80700063 -1.07350119]
mat_Sqrt:  [[15.12539074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02615765 -0.04008834  0.12224279]
Stock Position:  -0.026157654143706997
Bond Position:  [5.01023005]


portfolio before change:  [2.42150036]
curr_Stock_Price:  98.99037573537407
curr_Factors:  [98.99037574 -0.65142623 -1.06189222]
mat_Sqrt:  [[17.84465767  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113377 -0.04710599 -0.5538987 ]
Stock Position:  -0.0011337700574577077
Bond Position:  [2.53373268]


portfolio before change:  [2.42284241]
curr_Stock_Price:  98.0860310151405
curr_Factors:  [98.08603102 -0.55319628 -1.08874491]
mat_Sqrt:  [[18.98983384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00066457 -0.07029804 -0.09253078]
Stock Position:  0.0006645729675879044
Bond Position:  [2.35765709]


portfolio before change:  [2.42371136]
curr_Stock_Price:  98.9500770459881
curr_Factors:  [98.95007705 -0.94478748 -1.10265494]
mat_Sqrt:  [[12.77094964  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01720037  0.02703295 -0.15550849]
Stock Position:  0.017200371315195355
Bond Position:  [0.72173329]


portfolio before change:  [2.43475615]
curr_Stock_Price:  99.58695665599663
curr_Factors:  [99.58695666 -1.268307   -1.12746838]
mat_Sqrt:  [[ 9.07257221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.15106165e-02 -1.28298651e-04 -3.11587997e-01]
Stock Position:  -0.04151061647766977
Bond Position:  [6.56867211]


portfolio before change:  [2.42198084]
curr_Stock_Price:  99.91449795408168
curr_Factors:  [99.91449795 -1.54557905 -1.14290828]
mat_Sqrt:  [[ 6.79255716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00391867  0.00257495 -0.0841175 ]
Stock Position:  0.003918671673414271
Bond Position:  [2.03044873]


portfolio before change:  [2.42194807]
curr_Stock_Price:  99.84136273995884
curr_Factors:  [99.84136274 -1.57454793 -1.1598198 ]
mat_Sqrt:  [[ 6.48320397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00159546 -0.05756814  0.06963759]
Stock Position:  -0.0015954646065370315
Bond Position:  [2.58124143]


portfolio before change:  [2.42089121]
curr_Stock_Price:  100.70602663837991
curr_Factors:  [100.70602664  -1.50584632  -1.17109222]
mat_Sqrt:  [[ 6.92589376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01041391  0.00225658  0.15019092]
Stock Position:  -0.010413907736907424
Bond Position:  [3.46963448]


portfolio before change:  [2.42412595]
curr_Stock_Price:  100.4370577094628
curr_Factors:  [100.43705771  -1.14776231  -1.1603192 ]
mat_Sqrt:  [[ 9.98865284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02066545 -0.03057638  0.63297962]
Stock Position:  0.020665448479580878
Bond Position:  [0.34854911]


portfolio before change:  [2.43416089]
curr_Stock_Price:  100.92053948592971
curr_Factors:  [100.92053949  -1.07999041  -1.20030343]
mat_Sqrt:  [[10.31954457  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00703762 -0.01008305 -0.21583461]
Stock Position:  0.0070376209179931455
Bond Position:  [1.72392039]


portfolio before change:  [2.43566522]
curr_Stock_Price:  101.10367211635935
curr_Factors:  [101.10367212  -1.24804814  -1.17321358]
mat_Sqrt:  [[ 8.978966    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00723844 -0.03572852 -0.15560281]
Stock Position:  0.0072384441805699255
Bond Position:  [1.70383193]


portfolio before change:  [2.43450606]
curr_Stock_Price:  100.91410760617678
curr_Factors:  [100.91410761  -1.04034005  -1.16861253]
mat_Sqrt:  [[11.08194442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227663  0.01283669  0.12458335]
Stock Position:  -0.002276629295257855
Bond Position:  [2.66425007]


portfolio before change:  [2.43435767]
curr_Stock_Price:  101.12557565956217
curr_Factors:  [101.12557566  -0.84756961  -1.20557877]
mat_Sqrt:  [[12.9774688   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03305842 -0.07648348  0.3338635 ]
Stock Position:  -0.033058423908764005
Bond Position:  [5.77740982]


portfolio before change:  [2.47347104]
curr_Stock_Price:  99.9642635673845
curr_Factors:  [99.96426357 -0.80418687 -1.19905686]
mat_Sqrt:  [[13.48487955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00948535  0.00588515 -0.0668723 ]
Stock Position:  -0.009485351495294267
Bond Position:  [3.42166722]


portfolio before change:  [2.47523137]
curr_Stock_Price:  99.82377400906394
curr_Factors:  [99.82377401 -0.78960332 -1.20533839]
mat_Sqrt:  [[13.57818781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03295092 0.43063824 1.31231304]
Stock Position:  0.032950924156522135
Bond Position:  [-0.81405424]


portfolio before change:  [2.48400036]
curr_Stock_Price:  100.09298493812105
curr_Factors:  [100.09298494  -0.84860018  -1.22691794]
mat_Sqrt:  [[12.56080793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.01088918e-03  1.33979321e-04  1.89218373e-01]
Stock Position:  -0.002010889175929519
Bond Position:  [2.68527626]


portfolio before change:  [2.48300486]
curr_Stock_Price:  100.75496742305347
curr_Factors:  [100.75496742  -1.04927832  -1.23563947]
mat_Sqrt:  [[10.2550853   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00720605  0.01251218 -0.08686253]
Stock Position:  -0.007206045462525154
Bond Position:  [3.20904974]


portfolio before change:  [2.48679829]
curr_Stock_Price:  100.28421336136496
curr_Factors:  [100.28421336  -1.31135309  -1.23274718]
mat_Sqrt:  [[ 7.87669196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00110603 0.01029999 0.00099594]
Stock Position:  0.001106026891473646
Bond Position:  [2.37588126]


portfolio before change:  [2.48755817]
curr_Stock_Price:  100.70271682562294
curr_Factors:  [100.70271683  -1.63779104  -1.21204797]
mat_Sqrt:  [[ 5.82601811  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00720488 -0.0100179   0.14189455]
Stock Position:  0.007204876337104408
Bond Position:  [1.76200755]


portfolio before change:  [2.48814569]
curr_Stock_Price:  100.75368960559452
curr_Factors:  [100.75368961  -1.69097854  -1.24188513]
mat_Sqrt:  [[ 5.36456425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01161285 0.02639786 0.19534149]
Stock Position:  0.011612854515603984
Bond Position:  [1.31810775]


portfolio before change:  [2.49081523]
curr_Stock_Price:  100.96937857108519
curr_Factors:  [100.96937857  -1.66968389  -1.24175773]
mat_Sqrt:  [[ 5.49245685  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01124399 -0.04060592  0.04853409]
Stock Position:  -0.011243990143949443
Bond Position:  [3.62611393]


portfolio before change:  [2.48524373]
curr_Stock_Price:  101.50520163782866
curr_Factors:  [101.50520164  -1.82510067  -1.246062  ]
mat_Sqrt:  [[ 4.70651338  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00373612  0.01887573 -0.05259543]
Stock Position:  0.0037361208028110146
Bond Position:  [2.10600804]


portfolio before change:  [2.48541508]
curr_Stock_Price:  101.48059772391363
curr_Factors:  [101.48059772  -2.10503415  -1.22114082]
mat_Sqrt:  [[ 3.64622597  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04319023  0.00852966  0.48999251]
Stock Position:  -0.04319023019391189
Bond Position:  [6.86838545]


portfolio before change:  [2.48610475]
curr_Stock_Price:  101.48450890352163
curr_Factors:  [101.4845089   -2.30986616  -1.23085962]
mat_Sqrt:  [[ 2.94226703  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00385731  0.0138454  -0.18060173]
Stock Position:  -0.0038573141541921817
Bond Position:  [2.87756239]


portfolio before change:  [2.48693421]
curr_Stock_Price:  101.36273029389639
curr_Factors:  [101.36273029  -2.44515424  -1.25397335]
mat_Sqrt:  [[ 2.50823139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.18913759  0.0246014  -1.34090811]
Stock Position:  -0.18913759030389204
Bond Position:  [21.65843676]


portfolio before change:  [2.4347029]
curr_Stock_Price:  101.65320021128922
curr_Factors:  [101.65320021  -2.59220902  -1.26571968]
mat_Sqrt:  [[ 2.14607012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09153184  0.03560635 -0.1236177 ]
Stock Position:  -0.0915318416552472
Bond Position:  [11.73920753]


portfolio before change:  [2.44211455]
curr_Stock_Price:  101.58825938678133
curr_Factors:  [101.58825939  -2.85122125  -1.25122122]
mat_Sqrt:  [[ 1.67948214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03618666  0.02125851  0.4372804 ]
Stock Position:  -0.036186657418962445
Bond Position:  [6.11825409]


portfolio before change:  [2.44543887]
curr_Stock_Price:  101.51752902561437
curr_Factors:  [101.51752903  -2.77590547  -1.22974376]
mat_Sqrt:  [[ 1.84888408  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0067907  -0.01340535  0.12087994]
Stock Position:  0.0067907036633238224
Bond Position:  [1.75606342]


portfolio before change:  [2.4448396]
curr_Stock_Price:  101.39695269532668
curr_Factors:  [101.3969527   -2.49920078  -1.23894688]
mat_Sqrt:  [[ 2.41305936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06785372 -0.00079106 -0.37458078]
Stock Position:  -0.06785372460202159
Bond Position:  [9.3250005]


portfolio before change:  [2.44930974]
curr_Stock_Price:  101.34825318943508
curr_Factors:  [101.34825319  -2.49693364  -1.26058762]
mat_Sqrt:  [[ 2.3656229   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04080678 -0.09447661 -0.43285905]
Stock Position:  -0.04080678031729349
Bond Position:  [6.58500564]


portfolio before change:  [2.44870728]
curr_Stock_Price:  101.38318950274538
curr_Factors:  [101.3831895   -2.50462629  -1.29000351]
mat_Sqrt:  [[ 2.2802327   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06314293 -0.04949465 -0.24884816]
Stock Position:  0.06314293093773915
Bond Position:  [-3.95292446]


portfolio before change:  [2.45101865]
curr_Stock_Price:  101.42762081257557
curr_Factors:  [101.42762081  -2.2208262   -1.30128336]
mat_Sqrt:  [[ 2.99587363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01050245 0.00483714 0.21098361]
Stock Position:  0.010502445630157503
Bond Position:  [1.38578058]


portfolio before change:  [2.45114571]
curr_Stock_Price:  101.42322410784786
curr_Factors:  [101.42322411  -2.06403029  -1.29862252]
mat_Sqrt:  [[ 3.51362861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01734414 -0.01696347 -0.14288459]
Stock Position:  -0.0173441350197813
Bond Position:  [4.2102438]


portfolio before change:  [2.44926582]
curr_Stock_Price:  101.56195703769069
curr_Factors:  [101.56195704  -1.82644248  -1.27621072]
mat_Sqrt:  [[ 4.56316211  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0218991  -0.00697607  0.00704287]
Stock Position:  -0.02189910275225653
Bond Position:  [4.67338156]


portfolio before change:  [2.4527544]
curr_Stock_Price:  101.42933221788262
curr_Factors:  [101.42933222  -1.89077837  -1.27826613]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.4527544]
Stock Price:  101.40797604043024
PL:  [1.04477836]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.07089271e-01  5.04212718e-02  7.19143621e-02]
 [-4.91241660e-03 -3.10082852e-02 -1.04710466e-01]
 [ 3.42129703e-01 -3.42501369e-01 -6.43245791e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-5.52013308e-01 -1.69513177e-01  3.91638031e-02]
 [-2.06383192e-02 -6.47811053e-02 -6.65033120e-02]
 [ 3.55317999e-02 -6.17482451e-02 -2.27579883e-02]
 [ 1.29478813e-01  4.72689707e-02 -1.33604334e-02]
 [-4.94085691e-01 -2.61476248e-02 -6.30258528e-02]
 [ 5.28563454e-02 -2.65653708e-02 -4.57507543e-02]
 [ 2.38278434e-02 -3.17599700e-01  1.86413936e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 3.51322042e-02  8.13212008e-02  1.71187574e-01]
 [ 3.29088507e-02  4.55824277e-01  4.14670386e-01]
 [ 9.48962837e-02 -1.22221909e-01 -5.35953051e-02]
 [-1.65454600e-02 -5.81869312e-03  3.64638781e-02]
 [-5.13604244e-01 -8.54700748e-02  1.70402010e-01]
 [-1.13716934e-01  1.92528158e-02 -3.16735239e-02]
 [-1.77103940e-02  4.96572618e-01  1.75049434e-02]
 [-3.05468557e-02  5.34517933e-02  2.44976260e-02]
 [ 1.27181629e-01 -2.04116343e-01  2.04154554e-01]
 [-3.68169379e-02  6.03373544e-02 -3.25650422e-02]
 [ 3.36692159e-01  4.66225313e-02  2.93340926e-01]
 [ 5.79716552e-02 -1.24488975e-01 -2.52452264e-02]
 [-1.19561299e-01  2.31185663e-01  2.22066193e-01]
 [ 5.69728019e-03  6.17247673e-02  5.82195409e-02]
 [ 1.72848761e-02 -1.12424196e-04  6.12444746e-01]
 [ 9.65693355e-02  7.37739041e-02 -8.80122322e-02]
 [-7.72084259e-01 -1.41286636e-01 -1.12873835e+00]
 [ 2.29854821e-02 -1.50349355e-01  1.62652326e-01]
 [-7.96897292e-02 -1.53387904e-01  1.28404592e-01]
 [ 6.47200264e-02  1.96643542e-01 -4.04585291e-02]
 [-1.03647051e-01 -2.20868261e-03  1.71027475e-04]
 [-5.49883729e-02  1.55509415e-01  9.11286465e-02]
 [ 1.16572142e-01 -1.53471178e-01 -1.17974396e-01]
 [-2.12161650e-02  2.29746567e-01  8.27061635e-02]
 [ 6.47286298e-02  5.86406475e-02 -3.49854228e-02]
 [-4.84046452e-02  8.86289238e-02 -7.53025379e-03]
 [-5.16932193e-02 -2.78151455e-01  1.27427231e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.15313351]
curr_Stock_Price:  100.52462961781174
curr_Factors:  [100.52462962  -0.78758238  -1.0219848 ]
mat_Sqrt:  [[16.45839349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00553565  0.01594461  0.20515166]
Stock Position:  -0.005535652161637366
Bond Position:  [6.70960289]


portfolio before change:  [6.14943844]
curr_Stock_Price:  101.34365211042272
curr_Factors:  [101.34365211  -0.68512205  -1.02923544]
mat_Sqrt:  [[18.24990258  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148423 -0.00980568 -0.29870982]
Stock Position:  -0.0014842260894590991
Bond Position:  [6.29985533]


portfolio before change:  [6.14883961]
curr_Stock_Price:  102.27771511649857
curr_Factors:  [102.27771512  -0.93060569  -1.04515375]
mat_Sqrt:  [[14.18141595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01424289 -0.10830844 -1.8350012 ]
Stock Position:  0.014242890747868539
Bond Position:  [4.69210928]


portfolio before change:  [6.14449425]
curr_Stock_Price:  101.93144345915655
curr_Factors:  [101.93144346  -0.7971704   -1.033792  ]
mat_Sqrt:  [[16.33545765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120615 -0.00659539  0.21422481]
Stock Position:  0.0012061525499322435
Bond Position:  [6.02154938]


portfolio before change:  [6.14429469]
curr_Stock_Price:  101.14191161646622
curr_Factors:  [101.14191162  -0.53597025  -1.05948542]
mat_Sqrt:  [[20.51320721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02673379 -0.05360477  0.11172343]
Stock Position:  -0.026733793321285743
Bond Position:  [8.84820165]


portfolio before change:  [6.16287083]
curr_Stock_Price:  100.48843005411639
curr_Factors:  [100.48843005  -0.55333818  -1.04483535]
mat_Sqrt:  [[20.32535396  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176557 -0.02048558 -0.18971544]
Stock Position:  -0.0017655727874751933
Bond Position:  [6.34029047]


portfolio before change:  [6.16548729]
curr_Stock_Price:  99.45540626028851
curr_Factors:  [99.45540626 -0.62394025 -1.05110038]
mat_Sqrt:  [[18.62805427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00157247 -0.01952651 -0.06492221]
Stock Position:  0.00157246761766632
Bond Position:  [6.00909689]


portfolio before change:  [6.16591714]
curr_Stock_Price:  99.25105599863959
curr_Factors:  [99.251056   -0.41834233 -1.05369537]
mat_Sqrt:  [[22.77389352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00561925  0.01494776 -0.0381136 ]
Stock Position:  0.005619245792516807
Bond Position:  [5.60820106]


portfolio before change:  [6.17852487]
curr_Stock_Price:  101.36996264913665
curr_Factors:  [101.36996265  -0.57115302  -1.05617508]
mat_Sqrt:  [[19.91451215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02549025 -0.0082686  -0.17979522]
Stock Position:  -0.025490251271593028
Bond Position:  [8.76247069]


portfolio before change:  [6.18172151]
curr_Stock_Price:  101.2875284390363
curr_Factors:  [101.28752844  -0.22466741  -1.07484081]
mat_Sqrt:  [[27.61765012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155088 -0.00840071 -0.13051417]
Stock Position:  0.001550877668953883
Bond Position:  [6.02463695]


portfolio before change:  [6.18563951]
curr_Stock_Price:  103.3282256895829
curr_Factors:  [103.32822569  -0.25969642  -1.10446047]
mat_Sqrt:  [[26.41028951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0020325  -0.10043384  0.53178707]
Stock Position:  0.002032504787573679
Bond Position:  [5.9756244]


portfolio before change:  [6.18378489]
curr_Stock_Price:  102.04821901436
curr_Factors:  [102.04821901  -0.12876359  -1.10540552]
mat_Sqrt:  [[29.70383963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242816  0.00225658  0.15019092]
Stock Position:  -0.0024281580931822967
Bond Position:  [6.4315741]


portfolio before change:  [6.17912756]
curr_Stock_Price:  104.29738505779015
curr_Factors:  [104.29738506  -0.10865812  -1.12961083]
mat_Sqrt:  [[30.23430912  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0023872  0.02571602 0.4883505 ]
Stock Position:  0.0023872027444966793
Bond Position:  [5.93014856]


portfolio before change:  [6.1837575]
curr_Stock_Price:  105.92633084542464
curr_Factors:  [ 1.05926331e+02 -7.74473814e-02 -1.13176664e+00]
mat_Sqrt:  [[31.61177997  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00409096 0.14414429 1.18293919]
Stock Position:  0.004090956634841203
Bond Position:  [5.75041747]


portfolio before change:  [6.17999846]
curr_Stock_Price:  104.83174902931576
curr_Factors:  [104.83174903  -0.18649624  -1.12352115]
mat_Sqrt:  [[28.28521659  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00285663 -0.03864996 -0.15289249]
Stock Position:  0.002856631182777695
Bond Position:  [5.88053281]


portfolio before change:  [6.18131263]
curr_Stock_Price:  105.03445700127165
curr_Factors:  [105.034457    -0.34394163  -1.10662056]
mat_Sqrt:  [[24.62411543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037575 -0.00184003  0.10402129]
Stock Position:  -0.00037575116368525086
Bond Position:  [6.22077945]


portfolio before change:  [6.18187577]
curr_Stock_Price:  105.60533157626317
curr_Factors:  [105.60533158  -0.41853046  -1.08475796]
mat_Sqrt:  [[23.48637439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02048115 -0.02702801  0.4861095 ]
Stock Position:  -0.020481147869036345
Bond Position:  [8.34479418]


portfolio before change:  [6.1546131]
curr_Stock_Price:  106.98737521725549
curr_Factors:  [106.98737522  -0.71229519  -1.08109093]
mat_Sqrt:  [[17.80224759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00672304  0.00608827 -0.09035575]
Stock Position:  -0.006723036453122012
Bond Position:  [6.87389312]


portfolio before change:  [6.15302997]
curr_Stock_Price:  107.35066646694554
curr_Factors:  [107.35066647  -0.69918632  -1.08391306]
mat_Sqrt:  [[18.04739493  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.29059535e-05  1.57030050e-01  4.99367310e-02]
Stock Position:  -7.290595345283369e-05
Bond Position:  [6.16085647]


portfolio before change:  [6.15384999]
curr_Stock_Price:  106.66666674337563
curr_Factors:  [106.66666674  -0.63262189  -1.06842067]
mat_Sqrt:  [[19.46593753  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124146  0.01690294  0.06988491]
Stock Position:  -0.001241459824737495
Bond Position:  [6.28627237]


portfolio before change:  [6.15353879]
curr_Stock_Price:  107.55032863804546
curr_Factors:  [107.55032864  -0.55247985  -1.08600259]
mat_Sqrt:  [[20.89430168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00782913 -0.06454726  0.58239612]
Stock Position:  0.007829131799520134
Bond Position:  [5.31151309]


portfolio before change:  [6.16692597]
curr_Stock_Price:  109.17543807125962
curr_Factors:  [109.17543807  -0.88828336  -1.08559031]
mat_Sqrt:  [[15.1663998   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027631   0.01908035 -0.092899  ]
Stock Position:  -0.0027631043689766654
Bond Position:  [6.4685891]


portfolio before change:  [6.16802652]
curr_Stock_Price:  109.06978690093817
curr_Factors:  [109.0697869   -0.63665693  -1.07989599]
mat_Sqrt:  [[19.59814677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02029651 0.01474334 0.83682001]
Stock Position:  0.0202965065067755
Bond Position:  [3.95429088]


portfolio before change:  [6.1845542]
curr_Stock_Price:  109.85974357214728
curr_Factors:  [109.85974357  -0.36536249  -1.07704802]
mat_Sqrt:  [[25.96615562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00191034 -0.03936687 -0.0720176 ]
Stock Position:  0.0019103406813348012
Bond Position:  [5.97468466]


portfolio before change:  [6.18152838]
curr_Stock_Price:  107.88486366156114
curr_Factors:  [107.88486366  -0.33084156  -1.09504482]
mat_Sqrt:  [[25.92423383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263317  0.07310733  0.63349304]
Stock Position:  -0.002633174770778857
Bond Position:  [6.46560809]


portfolio before change:  [6.17999739]
curr_Stock_Price:  108.77323913036854
curr_Factors:  [ 1.08773239e+02 -9.87553224e-02 -1.09576444e+00]
mat_Sqrt:  [[32.94190579  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00058209 0.01951909 0.16608415]
Stock Position:  0.0005820859603041426
Bond Position:  [6.11668201]


portfolio before change:  [6.18148468]
curr_Stock_Price:  110.01474362689162
curr_Factors:  [110.01474363   0.11743993  -1.09976448]
mat_Sqrt:  [[41.19388587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.45431684e-03 -3.55516522e-05  1.74713439e+00]
Stock Position:  0.0034543168355275753
Bond Position:  [5.8014589]


portfolio before change:  [6.17117127]
curr_Stock_Price:  106.81913679068133
curr_Factors:  [106.81913679  -0.19214731  -1.07921388]
mat_Sqrt:  [[29.95738592  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00268744  0.02332936 -0.2510744 ]
Stock Position:  0.0026874423577468508
Bond Position:  [5.884101]


portfolio before change:  [6.17001995]
curr_Stock_Price:  106.11702523292178
curr_Factors:  [106.11702523  -0.52210962  -1.09376647]
mat_Sqrt:  [[21.08720398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04771306 -0.04467876 -3.21997633]
Stock Position:  -0.047713059327858603
Bond Position:  [11.23318787]


portfolio before change:  [6.14335354]
curr_Stock_Price:  106.70534730843119
curr_Factors:  [106.70534731  -0.59284943  -1.09177735]
mat_Sqrt:  [[19.79529905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00264228 -0.04754464  0.46400181]
Stock Position:  0.0026422811503402617
Bond Position:  [5.86140801]


portfolio before change:  [6.14516107]
curr_Stock_Price:  107.11212231858721
curr_Factors:  [107.11212232  -0.63554231  -1.08801288]
mat_Sqrt:  [[19.11208717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300541 -0.04850551  0.36630256]
Stock Position:  -0.00300541274387403
Bond Position:  [6.46707721]


portfolio before change:  [6.14512297]
curr_Stock_Price:  107.3937926733873
curr_Factors:  [107.39379267  -0.69763203  -1.09052506]
mat_Sqrt:  [[17.96356055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00342576  0.06218415 -0.11541692]
Stock Position:  0.0034257561599496307
Bond Position:  [5.77721803]


portfolio before change:  [6.14553828]
curr_Stock_Price:  107.30420900679492
curr_Factors:  [107.30420901  -0.54614535  -1.08427338]
mat_Sqrt:  [[21.0152663   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00493304 -0.00069845  0.00048789]
Stock Position:  -0.004933040908002427
Bond Position:  [6.67487433]


portfolio before change:  [6.14610944]
curr_Stock_Price:  107.35757276910496
curr_Factors:  [107.35757277  -0.48530938  -1.08236356]
mat_Sqrt:  [[22.38726183  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144598  0.04917639  0.25996466]
Stock Position:  -0.0014459821077902712
Bond Position:  [6.30134657]


portfolio before change:  [6.14827794]
curr_Stock_Price:  106.40266845036604
curr_Factors:  [106.40266845  -0.35628256  -1.10026946]
mat_Sqrt:  [[24.79590784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00357027 -0.04853185 -0.33654811]
Stock Position:  0.0035702709934030564
Bond Position:  [5.76839157]


portfolio before change:  [6.14350615]
curr_Stock_Price:  104.86416302044142
curr_Factors:  [104.86416302  -0.3923017   -1.08454394]
mat_Sqrt:  [[23.94645237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [6.67401882e-05 7.26522436e-02 2.35937663e-01]
Stock Position:  6.674018822450791e-05
Bond Position:  [6.13650749]


portfolio before change:  [6.14417256]
curr_Stock_Price:  103.35529079089315
curr_Factors:  [103.35529079  -0.28977326  -1.05331783]
mat_Sqrt:  [[26.97960993  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00219059  0.0185438  -0.09980367]
Stock Position:  0.002190593394900252
Bond Position:  [5.91776314]


portfolio before change:  [6.14212796]
curr_Stock_Price:  102.08423475871317
curr_Factors:  [102.08423476  -0.24284074  -1.05069737]
mat_Sqrt:  [[28.00155916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170181  0.02802693 -0.02148172]
Stock Position:  -0.0017018110512909712
Bond Position:  [6.31585604]


portfolio before change:  [6.14449568]
curr_Stock_Price:  101.15687479610558
curr_Factors:  [101.1568748   -0.30684715  -1.04570701]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.14449568]
Stock Price:  98.5217140413289
PL:  [6.14449568]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.64260308e-02  9.51366325e-03  2.83528155e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.48772085e-01  2.00348524e-01  2.67884216e-01]
 [-1.00356616e-02  3.34219353e-02  1.26245158e-01]
 [-7.58964912e-01 -2.28134639e-01  3.41064375e-02]
 [-1.63704198e-02 -7.29675909e-02 -7.89182193e-02]
 [ 3.26860961e-02  4.29837232e-02 -1.77455373e-02]
 [ 2.91142358e-01  2.33718907e-03 -6.97537458e-02]
 [-2.66813580e-01  1.09484214e-02 -1.18108950e-01]
 [ 4.95194919e-02 -2.08964155e-02 -4.30943156e-02]
 [ 5.07703975e-02 -2.26325404e-01  1.38691859e-02]
 [ 6.00942541e-03 -2.05308178e-02 -3.81658794e-02]
 [ 2.36554001e-01 -2.34784391e-01  6.67503833e-02]
 [ 8.51628769e-02 -6.12253037e-02 -5.79516610e-02]
 [-1.76886479e-02 -2.63602289e-02 -9.54650663e-04]
 [-2.39621993e-02 -7.80144754e-02 -6.70089927e-04]
 [-4.05713021e-01 -2.44966815e-01  1.01851075e-01]
 [-1.80976288e-01 -2.88393263e-02 -2.76653877e-02]
 [ 2.84205399e-01  1.25606470e+00  3.66195612e-01]
 [-2.13013001e-01 -3.20654282e-02  1.63212423e-01]
 [-9.52850525e-02  2.67727638e-01 -3.14452475e-02]
 [-2.12136056e-02  4.85670080e-02 -1.88601723e-02]
 [ 5.12129668e-02 -3.31503042e-02  7.06380199e-02]
 [ 4.65471280e-02  1.14898132e-01  7.84762621e-02]
 [-6.14814095e-02 -1.34822779e-01 -7.33669820e-02]
 [ 9.86617188e-02  2.90471920e-03 -1.11242370e-02]
 [ 2.73381530e-02 -6.81032853e-02  5.79114649e-02]
 [-1.70544080e-02  4.22031199e-02  2.41391483e-02]
 [-4.11602042e-01  8.05269621e-02 -5.11127079e-01]
 [ 1.43841424e-01 -1.16516652e-01 -1.31543445e-01]
 [ 1.07589928e-01  1.36887131e-02 -5.55182711e-03]
 [ 2.61927735e-02  1.25215645e-01 -2.43062256e-02]
 [-1.48205996e-01  1.45910761e-02 -1.53141105e-01]
 [-3.84059290e-02  1.47644135e-01  9.49369163e-02]
 [-1.42142997e-01  9.56496452e-02  1.31462119e-01]
 [-1.19714668e-01 -5.87448161e-02 -2.49908362e-02]
 [ 1.73248866e-01  1.30820960e-01  2.42065023e-02]
 [-1.36196550e-01  1.47239490e-01 -5.61914131e-03]
 [ 1.97452182e-03 -2.35044612e-01  7.86475738e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.57247105]
curr_Stock_Price:  100.72238586892269
curr_Factors:  [100.72238587  -0.98934145  -1.00295287]
mat_Sqrt:  [[13.73673676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00658038  0.00300848  0.08088269]
Stock Position:  -0.006580376142138668
Bond Position:  [8.23526223]


portfolio before change:  [7.57589133]
curr_Stock_Price:  100.35906135861786
curr_Factors:  [100.35906136  -0.93607001  -1.02687492]
mat_Sqrt:  [[14.09484939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00321969  0.01411938  0.0859571 ]
Stock Position:  -0.0032196898029390377
Bond Position:  [7.89901638]


portfolio before change:  [7.57799115]
curr_Stock_Price:  100.01356797326778
curr_Factors:  [100.01356797  -0.95960043  -1.02414466]
mat_Sqrt:  [[13.75717852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02243387 0.06335577 0.7641991 ]
Stock Position:  0.022433865949182424
Bond Position:  [5.33430018]


portfolio before change:  [7.57772415]
curr_Stock_Price:  99.9719421375692
curr_Factors:  [99.97194214 -0.83852439 -0.98105171]
mat_Sqrt:  [[16.20489673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00102419 0.01056894 0.3601423 ]
Stock Position:  0.001024194993442146
Bond Position:  [7.47533339]


portfolio before change:  [7.57887114]
curr_Stock_Price:  100.17943354693462
curr_Factors:  [100.17943355  -1.01943071  -0.9880405 ]
mat_Sqrt:  [[13.45689617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05632007 -0.07214251  0.09729617]
Stock Position:  -0.056320073122952195
Bond Position:  [13.22098416]


portfolio before change:  [7.60608281]
curr_Stock_Price:  99.72561774313898
curr_Factors:  [99.72561774 -1.23161896 -0.99927333]
mat_Sqrt:  [[10.71377509  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320742 -0.02307438 -0.22513171]
Stock Position:  -0.003207417430662189
Bond Position:  [7.92594449]


portfolio before change:  [7.60542013]
curr_Stock_Price:  100.24113493739068
curr_Factors:  [100.24113494  -1.23950182  -0.99735167]
mat_Sqrt:  [[10.70515225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00281861  0.01359265 -0.05062308]
Stock Position:  0.0028186089932736454
Bond Position:  [7.32287957]


portfolio before change:  [7.60518747]
curr_Stock_Price:  99.83381465428607
curr_Factors:  [99.83381465 -1.04436701 -1.03095663]
mat_Sqrt:  [[12.53072101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02210282  0.00073908 -0.19898802]
Stock Position:  0.022102820753245496
Bond Position:  [5.39857856]


portfolio before change:  [7.58914844]
curr_Stock_Price:  99.07762610402834
curr_Factors:  [99.0776261  -1.02448735 -1.02864316]
mat_Sqrt:  [[12.71488216  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02285824  0.00346219 -0.33693196]
Stock Position:  -0.022858236329430664
Bond Position:  [9.85388823]


portfolio before change:  [7.56703649]
curr_Stock_Price:  100.09886662860427
curr_Factors:  [100.09886663  -0.91870914  -1.03631424]
mat_Sqrt:  [[14.17011233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00283578 -0.00660803 -0.12293609]
Stock Position:  0.0028357826297832705
Bond Position:  [7.28317787]


portfolio before change:  [7.56461496]
curr_Stock_Price:  98.92388880161067
curr_Factors:  [98.9238888  -1.22127374 -1.03053156]
mat_Sqrt:  [[10.40769513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00458869 -0.07157038  0.03956493]
Stock Position:  0.004588694785530712
Bond Position:  [7.11068343]


portfolio before change:  [7.56431841]
curr_Stock_Price:  98.66554836921719
curr_Factors:  [98.66554837 -1.27238212 -1.03987239]
mat_Sqrt:  [[ 9.77161072  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023653 -0.00649241 -0.10887663]
Stock Position:  -0.00023652759007619938
Bond Position:  [7.58765553]


portfolio before change:  [7.56532316]
curr_Stock_Price:  98.42781667848557
curr_Factors:  [98.42781668 -1.03020886 -1.00967059]
mat_Sqrt:  [[12.79998505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01907168 -0.07424534  0.19042026]
Stock Position:  0.019071683149302302
Bond Position:  [5.68813902]


portfolio before change:  [7.56952405]
curr_Stock_Price:  98.61080150481692
curr_Factors:  [98.6108015  -1.12059894 -1.01824275]
mat_Sqrt:  [[11.61548495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00617733 -0.01936114 -0.16531996]
Stock Position:  0.006177332537761596
Bond Position:  [6.96037233]


portfolio before change:  [7.57244044]
curr_Stock_Price:  98.94205891642106
curr_Factors:  [98.94205892 -0.96839047 -1.01159525]
mat_Sqrt:  [[13.66104968  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135891 -0.00833584 -0.00272335]
Stock Position:  -0.0013589097321707612
Bond Position:  [7.70689376]


portfolio before change:  [7.57315812]
curr_Stock_Price:  99.1228963060113
curr_Factors:  [99.12289631 -0.87682507 -1.00082277]
mat_Sqrt:  [[15.16079198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172242 -0.02467034 -0.00191158]
Stock Position:  -0.0017224236033395127
Bond Position:  [7.74388973]


portfolio before change:  [7.57389585]
curr_Stock_Price:  99.25661304149313
curr_Factors:  [99.25661304 -0.781682   -1.01774161]
mat_Sqrt:  [[16.41646743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02383264 -0.07746531  0.29055277]
Stock Position:  -0.023832640891136948
Bond Position:  [9.93944306]


portfolio before change:  [7.56706589]
curr_Stock_Price:  99.59532766006315
curr_Factors:  [99.59532766 -0.69875919 -1.0208732 ]
mat_Sqrt:  [[17.84070896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01050228 -0.0091198  -0.07892165]
Stock Position:  -0.010502278265232373
Bond Position:  [8.61304373]


portfolio before change:  [7.57630545]
curr_Stock_Price:  98.81808104755507
curr_Factors:  [98.81808105 -0.57383524 -1.0218201 ]
mat_Sqrt:  [[20.03789531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0195323  0.39720253 1.04465415]
Stock Position:  0.01953230168100717
Bond Position:  [5.64616088]


portfolio before change:  [7.57741649]
curr_Stock_Price:  98.83882749082825
curr_Factors:  [98.83882749 -0.62223463 -1.04130715]
mat_Sqrt:  [[18.72667062  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00964001 -0.01013998  0.46559961]
Stock Position:  -0.009640012026042987
Bond Position:  [8.53022397]


portfolio before change:  [7.57712621]
curr_Stock_Price:  98.97955599246403
curr_Factors:  [98.97955599 -0.78976756 -1.05393879]
mat_Sqrt:  [[15.66152352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00605248  0.08466291 -0.08970454]
Stock Position:  -0.006052481980839401
Bond Position:  [8.17619819]


portfolio before change:  [7.56644698]
curr_Stock_Price:  100.9128639705483
curr_Factors:  [100.91286397  -1.14396898  -1.05840196]
mat_Sqrt:  [[11.15498479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213442  0.01535824 -0.05380282]
Stock Position:  -0.0021344204239982104
Bond Position:  [7.78183746]


portfolio before change:  [7.56699985]
curr_Stock_Price:  101.1096040833361
curr_Factors:  [101.10960408  -1.36757966  -1.03116996]
mat_Sqrt:  [[ 9.18393253  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00705318 -0.01048305  0.20151061]
Stock Position:  0.007053182809332768
Bond Position:  [6.85385533]


portfolio before change:  [7.56452759]
curr_Stock_Price:  100.63761275895173
curr_Factors:  [100.63761276  -1.47527552  -1.05747444]
mat_Sqrt:  [[ 7.99467833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00819704 0.03633398 0.22387093]
Stock Position:  0.008197038356385848
Bond Position:  [6.73959722]


portfolio before change:  [7.55999645]
curr_Stock_Price:  99.98205378837105
curr_Factors:  [99.98205379 -1.58464973 -1.09691022]
mat_Sqrt:  [[ 6.84439975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0116794  -0.04263471 -0.20929558]
Stock Position:  -0.011679401270552017
Bond Position:  [8.72772698]


portfolio before change:  [7.56553319]
curr_Stock_Price:  99.60140930766508
curr_Factors:  [99.60140931 -1.26237469 -1.08626816]
mat_Sqrt:  [[ 9.51180317  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01014171  0.00091855 -0.03173435]
Stock Position:  0.010141714581689497
Bond Position:  [6.55540412]


portfolio before change:  [7.55739383]
curr_Stock_Price:  98.71804494006459
curr_Factors:  [98.71804494 -1.01189143 -1.08001559]
mat_Sqrt:  [[12.18688942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00306894 -0.02153615  0.16520529]
Stock Position:  0.0030689424308314095
Bond Position:  [7.25443384]


portfolio before change:  [7.55615824]
curr_Stock_Price:  98.01993506617252
curr_Factors:  [98.01993507 -1.26026732 -1.09520096]
mat_Sqrt:  [[ 9.29710065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118718  0.0133458   0.06886227]
Stock Position:  -0.0011871814105310153
Bond Position:  [7.67252568]


portfolio before change:  [7.55822524]
curr_Stock_Price:  97.0867388380925
curr_Factors:  [97.08673884 -1.44064331 -1.09985728]
mat_Sqrt:  [[ 7.65304958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06714398  0.02546486 -1.45810329]
Stock Position:  -0.06714398199089563
Bond Position:  [14.07701548]


portfolio before change:  [7.61163845]
curr_Stock_Price:  96.3174446044439
curr_Factors:  [96.3174446  -1.34780297 -1.10093054]
mat_Sqrt:  [[ 8.32211092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01369626 -0.0368458  -0.37525683]
Stock Position:  0.013696258692441496
Bond Position:  [6.29244981]


portfolio before change:  [7.61295201]
curr_Stock_Price:  96.35591871338028
curr_Factors:  [96.35591871 -1.35803794 -1.08682026]
mat_Sqrt:  [[ 8.35776145  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01277975  0.00432875 -0.01583782]
Stock Position:  0.012779750636227856
Bond Position:  [6.38154739]


portfolio before change:  [7.61374244]
curr_Stock_Price:  96.35534648286333
curr_Factors:  [96.35534648 -1.3928939  -1.09099456]
mat_Sqrt:  [[ 8.03779198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00304366  0.03959666 -0.0693389 ]
Stock Position:  0.003043664244754089
Bond Position:  [7.32046911]


portfolio before change:  [7.61407917]
curr_Stock_Price:  96.16531766846093
curr_Factors:  [96.16531767 -1.41401096 -1.07047276]
mat_Sqrt:  [[ 8.01716641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0223382   0.0046141  -0.43686895]
Stock Position:  -0.022338198354092176
Bond Position:  [9.76223911]


portfolio before change:  [7.6359612]
curr_Stock_Price:  95.24036940016961
curr_Factors:  [95.2403694  -1.33537373 -1.09258523]
mat_Sqrt:  [[ 8.40179138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181091  0.04668917  0.2708286 ]
Stock Position:  -0.001810906304723412
Bond Position:  [7.80843259]


portfolio before change:  [7.63708397]
curr_Stock_Price:  95.15938553975289
curr_Factors:  [95.15938554 -1.4677283  -1.08529376]
mat_Sqrt:  [[ 7.40778276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01523246  0.03024707  0.37502483]
Stock Position:  -0.015232458183683325
Bond Position:  [9.08659533]


portfolio before change:  [7.64019252]
curr_Stock_Price:  95.02988250403345
curr_Factors:  [95.0298825  -1.36565409 -1.10012182]
mat_Sqrt:  [[ 8.0721146   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01565051 -0.01857674 -0.0712919 ]
Stock Position:  -0.015650506899635423
Bond Position:  [9.12745835]


portfolio before change:  [7.64575271]
curr_Stock_Price:  94.74751527175566
curr_Factors:  [94.74751527 -1.50112307 -1.09095905]
mat_Sqrt:  [[ 7.09317811  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02559752 0.04136922 0.06905441]
Stock Position:  0.025597521696784867
Bond Position:  [5.22045113]


portfolio before change:  [7.65206657]
curr_Stock_Price:  94.96867968124086
curr_Factors:  [94.96867968 -1.49353005 -1.09724823]
mat_Sqrt:  [[ 7.11901145  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01875848  0.04656121 -0.01602985]
Stock Position:  -0.01875848161526419
Bond Position:  [9.4335348]


portfolio before change:  [7.64823155]
curr_Stock_Price:  95.23598746562482
curr_Factors:  [95.23598747 -1.46539922 -1.10329777]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.64823155]
Stock Price:  95.10954758407698
PL:  [7.64823155]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.48260335e-01 -1.48630733e-02  5.99375943e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 3.10194477e-01  9.94455923e-02  7.30025078e-02]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.07285920e+00 -3.00185585e-01 -6.65090184e-02]
 [-1.14528641e-02  7.19723445e-02  9.33735516e-02]
 [-5.59442673e-02  6.85635562e-02  1.60879493e-01]
 [ 3.59896996e-01 -6.63126587e-02 -8.87801974e-02]
 [-6.11757113e-01 -2.89161698e-02 -1.03719951e-01]
 [-1.01396903e-01  1.04393705e-01  6.96298095e-02]
 [-2.15527418e-02 -2.39309103e-01  2.06972869e-01]
 [-3.52124811e-01  6.21484129e-02  3.16860224e-01]
 [ 3.51373078e-02  1.87134004e-01  1.11930847e-01]
 [-8.27338188e-02  1.10064795e+00  1.05034798e+00]
 [ 1.52688866e-01 -1.34869148e-01 -6.80054969e-02]
 [-1.97280098e-03 -4.20904339e-02  3.08307904e-02]
 [-6.74770372e-01 -1.00509882e-01  2.34898352e-01]
 [-1.13716934e-01  1.92528158e-02 -3.16735239e-02]
 [-1.33267309e-01  3.56755621e-01 -1.02140036e-01]
 [-3.15333253e-02  5.41106384e-02  2.46341007e-02]
 [ 2.45148816e-01 -1.22633940e-01  3.23030630e-01]
 [-4.65599440e-02  5.93502024e-02 -3.65712234e-02]
 [ 3.93340715e-01  7.20138904e-02  3.34290501e-01]
 [ 1.23921052e-02 -8.12003834e-02 -1.68598240e-02]
 [-1.20012295e-01  2.57232545e-01  2.94809812e-01]
 [-1.93117900e-03  5.88825415e-02  5.97070874e-02]
 [-3.05574790e-01 -1.86324703e-01  6.87948378e-01]
 [ 1.68627574e-01  9.61546636e-02 -1.11845705e-01]
 [-8.96877348e-01 -1.27375856e-01 -1.21130346e+00]
 [ 7.41585607e-02 -3.10193262e-01  3.25597959e-01]
 [-2.72826998e-01 -2.44341504e-01  1.60587340e-01]
 [ 9.81474605e-02  3.78798720e-01 -7.70162270e-02]
 [-8.39963012e-02  6.63339429e-03  8.02013049e-02]
 [ 3.35795241e-02  4.72945202e-01 -1.46049161e-01]
 [ 3.33563949e-02 -1.32058388e-01 -1.38237554e-01]
 [-6.21446069e-02  3.96435677e-01  8.81522184e-02]
 [ 1.64021145e-01  1.20259813e-01 -9.14710995e-03]
 [-1.39246645e-02  6.32937341e-02 -1.10499492e-02]
 [-1.66056521e-01 -3.55396887e-01  7.39067016e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.41177664]
curr_Stock_Price:  100.00334649310732
curr_Factors:  [100.00334649  -1.01674289  -1.00559727]
mat_Sqrt:  [[13.23498218  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01030673 -0.00470012  0.17098527]
Stock Position:  -0.010306729955290321
Bond Position:  [3.44248412]


portfolio before change:  [2.41786926]
curr_Stock_Price:  99.45396944783762
curr_Factors:  [99.45396945 -0.92654485 -0.98229672]
mat_Sqrt:  [[14.74425247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307788  0.01411938  0.0859571 ]
Stock Position:  -0.003077880206341289
Bond Position:  [2.72397666]


portfolio before change:  [2.41401116]
curr_Stock_Price:  100.81809562795675
curr_Factors:  [100.81809563  -0.81880125  -1.00070442]
mat_Sqrt:  [[16.34320471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02004893 0.03144746 0.20825583]
Stock Position:  0.02004892744657912
Bond Position:  [0.39271647]


portfolio before change:  [2.42217419]
curr_Stock_Price:  101.22280241972898
curr_Factors:  [101.22280242  -0.71025919  -0.97302417]
mat_Sqrt:  [[18.80345624  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104784 -0.00659539  0.21422481]
Stock Position:  0.001047842144269446
Bond Position:  [2.31610867]


portfolio before change:  [2.4237311]
curr_Stock_Price:  102.43231803054464
curr_Factors:  [102.43231803  -1.00844935  -0.97398019]
mat_Sqrt:  [[14.10843342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07755546 -0.09492702 -0.18973172]
Stock Position:  -0.07755546046329415
Bond Position:  [10.36791669]


portfolio before change:  [2.4032443]
curr_Stock_Price:  102.71318636726147
curr_Factors:  [102.71318637  -1.03366856  -0.96730694]
mat_Sqrt:  [[13.8871647   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00068158 0.02275965 0.26636875]
Stock Position:  0.0006815826281546922
Bond Position:  [2.33323677]


portfolio before change:  [2.40498318]
curr_Stock_Price:  104.83648871034931
curr_Factors:  [104.83648871  -1.20304191  -0.96892631]
mat_Sqrt:  [[11.94644407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178585  0.0216817   0.45894441]
Stock Position:  -0.0017858514855675532
Bond Position:  [2.59220557]


portfolio before change:  [2.40493075]
curr_Stock_Price:  105.04729836841413
curr_Factors:  [105.04729837  -1.18467038  -0.96648435]
mat_Sqrt:  [[12.22222466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0278233  -0.0209699  -0.25326519]
Stock Position:  0.0278233003937561
Bond Position:  [-0.51783179]


portfolio before change:  [2.39259989]
curr_Stock_Price:  104.60644041490303
curr_Factors:  [104.60644041  -1.02935388  -0.96541413]
mat_Sqrt:  [[14.23120532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04452718 -0.0091441  -0.29588415]
Stock Position:  -0.04452718214949976
Bond Position:  [7.05042992]


portfolio before change:  [2.35245435]
curr_Stock_Price:  105.52783039620236
curr_Factors:  [105.5278304   -0.76605399  -0.96071758]
mat_Sqrt:  [[18.76893568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045015   0.03301219  0.19863447]
Stock Position:  -0.004501498929291333
Bond Position:  [2.82748777]


portfolio before change:  [2.3490503]
curr_Stock_Price:  106.3625545506938
curr_Factors:  [106.36255455  -0.88405788  -0.9507754 ]
mat_Sqrt:  [[16.97973041  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085493 -0.07567618  0.59043599]
Stock Position:  0.0008549301689438413
Bond Position:  [2.25811774]


portfolio before change:  [2.34941409]
curr_Stock_Price:  106.45788980712247
curr_Factors:  [106.45788981  -0.9449394   -0.93584108]
mat_Sqrt:  [[16.2317472   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01761002  0.01965305  0.90391402]
Stock Position:  -0.017610015736923217
Bond Position:  [4.2241392]


portfolio before change:  [2.32636536]
curr_Stock_Price:  107.79671750403044
curr_Factors:  [107.7967175   -1.01363921  -0.89450114]
mat_Sqrt:  [[15.99229195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00392795 0.05917697 0.31930755]
Stock Position:  0.003927947024594101
Bond Position:  [1.90294556]


portfolio before change:  [2.3287394]
curr_Stock_Price:  108.34055278800066
curr_Factors:  [108.34055279  -0.91351304  -0.89561647]
mat_Sqrt:  [[17.74582046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00902106 0.34805544 2.99635042]
Stock Position:  0.009021063456053543
Bond Position:  [1.3513924]


portfolio before change:  [2.33268955]
curr_Stock_Price:  108.759706733924
curr_Factors:  [108.75970673  -0.99254845  -0.90207216]
mat_Sqrt:  [[16.35478174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00827434 -0.04264937 -0.19400075]
Stock Position:  0.00827433824800308
Bond Position:  [1.43277495]


portfolio before change:  [2.33304368]
curr_Stock_Price:  108.78085895503884
curr_Factors:  [108.78085896  -0.95963969  -0.92081427]
mat_Sqrt:  [[16.59134924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00019491 -0.01331016  0.08795166]
Stock Position:  0.00019490503105198847
Bond Position:  [2.31184174]


portfolio before change:  [2.33344785]
curr_Stock_Price:  109.37178871433696
curr_Factors:  [109.37178871  -1.04042184  -0.9210522 ]
mat_Sqrt:  [[15.38324518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04091576 -0.03178402  0.67009961]
Stock Position:  -0.04091575561908103
Bond Position:  [6.80847723]


portfolio before change:  [2.34507866]
curr_Stock_Price:  109.10832788416438
curr_Factors:  [109.10832788  -0.93725475  -0.92337997]
mat_Sqrt:  [[16.97440293  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00705092  0.00608827 -0.09035575]
Stock Position:  -0.007050920139571169
Bond Position:  [3.11439277]


portfolio before change:  [2.33890534]
curr_Stock_Price:  110.03907788912161
curr_Factors:  [110.03907789  -0.92589668  -0.95083537]
mat_Sqrt:  [[16.845836    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00860184  0.11281603 -0.29137709]
Stock Position:  -0.008601838835782825
Bond Position:  [3.28544375]


portfolio before change:  [2.33667831]
curr_Stock_Price:  110.34572612658035
curr_Factors:  [110.34572613  -1.07026343  -0.98258714]
mat_Sqrt:  [[14.16491085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177253  0.01711129  0.07027423]
Stock Position:  -0.0017725335654088124
Bond Position:  [2.53226981]


portfolio before change:  [2.3368628]
curr_Stock_Price:  110.42023206797752
curr_Factors:  [110.42023207  -1.15056131  -0.97377632]
mat_Sqrt:  [[13.19655414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02333342 -0.03878026  0.92151647]
Stock Position:  0.02333342241974622
Bond Position:  [-0.23961912]


portfolio before change:  [2.34707121]
curr_Stock_Price:  110.85901769225222
curr_Factors:  [110.85901769  -1.1280293   -0.9839102 ]
mat_Sqrt:  [[13.41427963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391319  0.01876818 -0.10432752]
Stock Position:  -0.003913188000889493
Bond Position:  [2.78088339]


portfolio before change:  [2.34459332]
curr_Stock_Price:  111.58106885011915
curr_Factors:  [111.58106885  -1.30566012  -0.96418542]
mat_Sqrt:  [[11.52946421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04019587 0.02277279 0.95363775]
Stock Position:  0.04019587201965429
Bond Position:  [-2.14050504]


portfolio before change:  [2.35475521]
curr_Stock_Price:  111.84053484455701
curr_Factors:  [111.84053484  -1.14434468  -0.95964539]
mat_Sqrt:  [[13.64105487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050246 -0.02567782 -0.04809639]
Stock Position:  0.0005024555061488511
Bond Position:  [2.29856031]


portfolio before change:  [2.35481944]
curr_Stock_Price:  111.3964998112305
curr_Factors:  [111.39649981  -1.05739552  -0.96488863]
mat_Sqrt:  [[14.74363932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360785  0.08134407  0.84101033]
Stock Position:  -0.0036078459064727247
Bond Position:  [2.75672084]


portfolio before change:  [2.35255777]
curr_Stock_Price:  112.11889083019572
curr_Factors:  [112.11889083  -1.37179694  -0.91905047]
mat_Sqrt:  [[11.34426602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00103813 0.01862029 0.1703277 ]
Stock Position:  0.0010381297335280255
Bond Position:  [2.23616382]


portfolio before change:  [2.35219235]
curr_Stock_Price:  111.49762195980325
curr_Factors:  [111.49762196  -1.38431036  -0.93467325]
mat_Sqrt:  [[10.9684136   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01549529 -0.05892104  1.96252523]
Stock Position:  -0.015495294505116958
Bond Position:  [4.07988084]


portfolio before change:  [2.36178617]
curr_Stock_Price:  110.91139225152199
curr_Factors:  [110.91139225  -1.12216997  -0.91967263]
mat_Sqrt:  [[14.39511649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01030071  0.03040677 -0.31906466]
Stock Position:  0.010300706357996977
Bond Position:  [1.21932049]


portfolio before change:  [2.35497977]
curr_Stock_Price:  110.235824150195
curr_Factors:  [110.23582415  -1.15074852  -0.9038476 ]
mat_Sqrt:  [[14.12612339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08122699 -0.04027978 -3.45551161]
Stock Position:  -0.08122698847493082
Bond Position:  [11.30910379]


portfolio before change:  [2.34536491]
curr_Stock_Price:  110.37159897369364
curr_Factors:  [110.37159897  -1.12672253  -0.89482996]
mat_Sqrt:  [[14.61868281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00907139 -0.09809172  0.92884035]
Stock Position:  0.009071392532609539
Bond Position:  [1.34414081]


portfolio before change:  [2.35194556]
curr_Stock_Price:  111.07850504143991
curr_Factors:  [111.07850504  -1.3245638   -0.89666044]
mat_Sqrt:  [[12.04937709  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02044555 -0.07726757  0.45811098]
Stock Position:  -0.020445547748275436
Bond Position:  [4.62300644]


portfolio before change:  [2.36156278]
curr_Stock_Price:  110.63638926082591
curr_Factors:  [110.63638926  -1.3734675   -0.91113312]
mat_Sqrt:  [[11.26441265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0081857   0.11978667 -0.21970586]
Stock Position:  0.008185702421231395
Bond Position:  [1.45592622]


portfolio before change:  [2.36657197]
curr_Stock_Price:  111.2260993056031
curr_Factors:  [111.22609931  -0.98557544  -0.92191393]
mat_Sqrt:  [[16.51180696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0040852   0.00209766  0.228792  ]
Stock Position:  -0.004085198248196006
Bond Position:  [2.82095263]


portfolio before change:  [2.36831601]
curr_Stock_Price:  110.88550358528931
curr_Factors:  [110.88550359  -1.10520519  -0.90763112]
mat_Sqrt:  [[14.8153213   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107853  0.1495584  -0.4166376 ]
Stock Position:  0.0010785291955264288
Bond Position:  [2.24872276]


portfolio before change:  [2.36779241]
curr_Stock_Price:  110.13938586512594
curr_Factors:  [110.13938587  -1.25516387  -0.89487338]
mat_Sqrt:  [[12.82901562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.34775691e-04 -4.17605289e-02 -3.94353264e-01]
Stock Position:  0.00013477569051164806
Bond Position:  [2.3529483]


portfolio before change:  [2.36805833]
curr_Stock_Price:  109.93002732056276
curr_Factors:  [109.93002732  -1.460479    -0.87924714]
mat_Sqrt:  [[10.59220033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320185  0.12536397  0.25147374]
Stock Position:  -0.003201854613767379
Bond Position:  [2.72003829]


portfolio before change:  [2.36880764]
curr_Stock_Price:  109.80220112163444
curr_Factors:  [109.80220112  -1.53141412  -0.85301165]
mat_Sqrt:  [[10.11738065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01633418  0.03802949 -0.02609416]
Stock Position:  0.01633417773884457
Bond Position:  [0.57527897]


portfolio before change:  [2.36498959]
curr_Stock_Price:  109.56405276411097
curr_Factors:  [109.56405276  -1.63399156  -0.87321612]
mat_Sqrt:  [[ 8.92897543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162908  0.02001524 -0.03152243]
Stock Position:  -0.0016290770289511573
Bond Position:  [2.54347787]


portfolio before change:  [2.3638002]
curr_Stock_Price:  110.48933263085101
curr_Factors:  [110.48933263  -1.61859741  -0.9148891 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.3638002]
Stock Price:  109.8960474666072
PL:  [-7.53224727]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.89640487e-02  1.92503139e-02  3.87211449e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 3.70766929e-01 -1.38101605e-01 -3.35878627e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-5.67399544e-01 -1.73871508e-01  3.87878030e-02]
 [-6.28473154e-02  2.85824416e-02  7.21530503e-02]
 [ 5.15178255e-03  1.50681655e-01  8.33117303e-02]
 [ 2.93556633e-01 -1.07705394e-01 -5.96515640e-02]
 [-5.48100898e-01 -2.64909318e-02 -8.56113340e-02]
 [ 3.46688523e-02  4.33322448e-03 -3.12718567e-02]
 [ 1.65475735e-02 -2.88367987e-01  1.30961718e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 9.13751784e-02 -1.73341864e-02  2.60519748e-01]
 [ 4.32456695e-02  3.14527846e-01  2.71947670e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-2.03447344e-02  3.63780336e-03  3.79324945e-02]
 [-4.67130975e-01 -2.24219910e-01  1.22902917e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 1.10627480e-01  7.23233241e-01  1.15009700e-01]
 [-1.74411016e-02  3.85148222e-02  2.65195453e-02]
 [ 2.83342352e-02 -2.08111212e-01  8.69841742e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 2.52339335e-01  8.81339671e-03  2.32364749e-01]
 [ 8.16681728e-02 -1.69902450e-01 -8.71314413e-02]
 [-6.49859943e-02 -1.54538398e-01  1.82278084e-01]
 [ 1.44078844e-02  6.28202923e-02 -4.47938801e-03]
 [ 3.10319344e-02 -5.98039399e-02  1.27374433e-01]
 [ 7.34226285e-02  6.65847070e-02 -8.03563914e-02]
 [-7.20526939e-01 -1.47811637e-01 -1.09594608e+00]
 [ 2.37304966e-02 -1.15824340e-01  1.17859740e-01]
 [ 1.17044466e-02 -1.25189758e-01  1.14532662e-01]
 [ 6.36675272e-02  1.19875487e-01 -4.02383837e-02]
 [-1.07013549e-01 -3.72347612e-03 -1.35394781e-02]
 [-6.01616543e-02  1.25612155e-01  1.28178021e-01]
 [ 1.42589129e-01 -1.58373989e-01 -1.08227441e-01]
 [-1.76035057e-02  2.11141639e-01  8.20906027e-02]
 [ 1.36982526e-01  1.03701440e-01 -1.61073951e-02]
 [-6.85869804e-03  5.85231916e-02 -1.15901052e-02]
 [-1.42367704e-01 -2.95612280e-01  6.11870729e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.11297155]
curr_Stock_Price:  100.37970388803492
curr_Factors:  [100.37970389  -0.89766377  -0.99846853]
mat_Sqrt:  [[15.07183435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00600876  0.00608748  0.11046065]
Stock Position:  -0.006008763433131093
Bond Position:  [5.71612944]


portfolio before change:  [5.11458873]
curr_Stock_Price:  100.22948736794426
curr_Factors:  [100.22948737  -0.90839531  -1.01023192]
mat_Sqrt:  [[14.71452652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0030841   0.01411938  0.0859571 ]
Stock Position:  -0.00308409806939701
Bond Position:  [5.4237063]


portfolio before change:  [5.11016055]
curr_Stock_Price:  101.88513648857787
curr_Factors:  [101.88513649  -0.75991768  -0.99457473]
mat_Sqrt:  [[17.62562221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01694353 -0.04367156 -0.95816823]
Stock Position:  0.01694352797628468
Bond Position:  [3.38386689]


portfolio before change:  [5.09494672]
curr_Stock_Price:  100.96225689211924
curr_Factors:  [100.96225689  -0.75892463  -0.99208945]
mat_Sqrt:  [[17.52682687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112417 -0.00659539  0.21422481]
Stock Position:  0.0011241654894203778
Bond Position:  [4.98144844]


portfolio before change:  [5.09533355]
curr_Stock_Price:  100.75241955058212
curr_Factors:  [100.75241955  -0.62737458  -0.98737826]
mat_Sqrt:  [[20.04366965  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02813713 -0.054983    0.11065081]
Stock Position:  -0.028137131082753848
Bond Position:  [7.93021759]


portfolio before change:  [5.06390406]
curr_Stock_Price:  101.9046630752078
curr_Factors:  [101.90466308  -0.63519835  -0.99072596]
mat_Sqrt:  [[20.04767908  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236342  0.00903856  0.20583257]
Stock Position:  -0.002363422721276315
Bond Position:  [5.30474786]


portfolio before change:  [5.06308943]
curr_Stock_Price:  102.52992799494584
curr_Factors:  [102.52992799  -0.6376689   -1.00452788]
mat_Sqrt:  [[19.84511639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00131258 0.04764972 0.23766518]
Stock Position:  0.0013125799495432584
Bond Position:  [4.9285107]


portfolio before change:  [5.06394934]
curr_Stock_Price:  102.71567009945998
curr_Factors:  [102.7156701   -0.84572971  -0.99583346]
mat_Sqrt:  [[16.28755819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01710504 -0.03405944 -0.17016931]
Stock Position:  0.017105042037387174
Bond Position:  [3.30699348]


portfolio before change:  [5.07033801]
curr_Stock_Price:  103.06499862978525
curr_Factors:  [103.06499863  -0.5876329   -1.01464922]
mat_Sqrt:  [[20.76103114  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02727515 -0.00837717 -0.24422531]
Stock Position:  -0.027275149641616325
Bond Position:  [7.88145128]


portfolio before change:  [5.10827586]
curr_Stock_Price:  101.7101903411343
curr_Factors:  [101.71019034  -0.7793429   -1.02687485]
mat_Sqrt:  [[16.70836929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169959  0.00137029 -0.0892099 ]
Stock Position:  0.0016995910370821794
Bond Position:  [4.93541013]


portfolio before change:  [5.1081235]
curr_Stock_Price:  101.25753921414615
curr_Factors:  [101.25753921  -0.76248605  -1.02306285]
mat_Sqrt:  [[16.9813938   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00211022 -0.09118996  0.37359733]
Stock Position:  0.002110215048765432
Bond Position:  [4.89444832]


portfolio before change:  [5.10948952]
curr_Stock_Price:  101.61493395727508
curr_Factors:  [101.61493396  -0.91919603  -1.03385964]
mat_Sqrt:  [[14.41306159  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00500418  0.00225658  0.15019092]
Stock Position:  -0.005004184445259516
Bond Position:  [5.6179894]


portfolio before change:  [5.10661647]
curr_Stock_Price:  102.32940548302746
curr_Factors:  [102.32940548  -0.81622034  -1.06137883]
mat_Sqrt:  [[15.65198743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00920688 -0.00548155  0.74319033]
Stock Position:  0.009206880800471814
Bond Position:  [4.16448183]


portfolio before change:  [5.11088953]
curr_Stock_Price:  102.73697712371843
curr_Factors:  [102.73697712  -0.74188182  -1.02912201]
mat_Sqrt:  [[17.48193874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00611361 0.09946244 0.77579101]
Stock Position:  0.00611361421355327
Bond Position:  [4.48279528]


portfolio before change:  [5.11656244]
curr_Stock_Price:  103.57322983343586
curr_Factors:  [103.57322983  -0.63117768  -1.04318574]
mat_Sqrt:  [[19.41246684  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00221127 -0.03587186 -0.12433753]
Stock Position:  0.002211266294970559
Bond Position:  [4.88753444]


portfolio before change:  [5.11510212]
curr_Stock_Price:  102.63652849602992
curr_Factors:  [102.6365285   -0.90255284  -1.05698692]
mat_Sqrt:  [[14.46387464  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086477  0.00115037  0.10821085]
Stock Position:  -0.0008647661182776358
Bond Position:  [5.20385871]


portfolio before change:  [5.11527666]
curr_Stock_Price:  103.18694862324412
curr_Factors:  [103.18694862  -0.71012173  -1.06420499]
mat_Sqrt:  [[17.50025862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02559007 -0.07090456  0.35060781]
Stock Position:  -0.025590070697447037
Bond Position:  [7.75583797]


portfolio before change:  [5.10907644]
curr_Stock_Price:  103.46712582598252
curr_Factors:  [103.46712583  -0.6082016   -1.06139393]
mat_Sqrt:  [[19.48526242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00673899  0.00580111 -0.05715682]
Stock Position:  -0.006738994886081706
Bond Position:  [5.80634088]


portfolio before change:  [5.10464739]
curr_Stock_Price:  104.23206090311467
curr_Factors:  [104.2320609   -0.62877683  -1.09611873]
mat_Sqrt:  [[18.57328399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00822566 0.22870643 0.32809066]
Stock Position:  0.008225661041869725
Bond Position:  [4.24726979]


portfolio before change:  [5.10484505]
curr_Stock_Price:  104.19154386495562
curr_Factors:  [104.19154386  -0.70752507  -1.10415826]
mat_Sqrt:  [[17.0226982   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064816  0.01217946  0.07565288]
Stock Position:  -0.0006481565656703376
Bond Position:  [5.17237748]


portfolio before change:  [5.10528681]
curr_Stock_Price:  104.50756731849455
curr_Factors:  [104.50756732  -0.62823261  -1.11129648]
mat_Sqrt:  [[18.35185012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00221865 -0.06581054  0.24814164]
Stock Position:  0.002218653530388324
Bond Position:  [4.87342072]


portfolio before change:  [5.1075105]
curr_Stock_Price:  105.23525136531978
curr_Factors:  [105.23525137  -0.39461938  -1.1151479 ]
mat_Sqrt:  [[23.25292791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00167157  0.01916992 -0.08961985]
Stock Position:  -0.0016715685802701373
Bond Position:  [5.28341844]


portfolio before change:  [5.10717063]
curr_Stock_Price:  105.83369227338491
curr_Factors:  [105.83369227  -0.23578173  -1.12029691]
mat_Sqrt:  [[27.27008406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.011001   0.00278704 0.66287195]
Stock Position:  0.011000998411454686
Bond Position:  [3.94289435]


portfolio before change:  [5.09060909]
curr_Stock_Price:  104.28342971179798
curr_Factors:  [104.28342971  -0.43831159  -1.10884793]
mat_Sqrt:  [[22.19690695  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00268036 -0.05372787 -0.24856175]
Stock Position:  0.002680359006996936
Bond Position:  [4.81109206]


portfolio before change:  [5.08695535]
curr_Stock_Price:  102.69589307640642
curr_Factors:  [102.69589308  -0.38760949  -1.09600787]
mat_Sqrt:  [[23.29304382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136388 -0.04886933  0.51998864]
Stock Position:  -0.0013638750138095874
Bond Position:  [5.22701971]


portfolio before change:  [5.08623264]
curr_Stock_Price:  103.70487135132205
curr_Factors:  [103.70487135  -0.56256124  -1.10609641]
mat_Sqrt:  [[19.54836085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00077324  0.01986552 -0.01277845]
Stock Position:  0.0007732385446681081
Bond Position:  [5.00604404]


portfolio before change:  [5.08658883]
curr_Stock_Price:  103.35619283660228
curr_Factors:  [103.35619284  -0.55987505  -1.11839403]
mat_Sqrt:  [[19.29627617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00287558 -0.01891167  0.3633638 ]
Stock Position:  0.0028755807672360906
Bond Position:  [4.78937975]


portfolio before change:  [5.09088616]
curr_Stock_Price:  104.64240946309197
curr_Factors:  [104.64240946  -0.72638756  -1.12205204]
mat_Sqrt:  [[16.47937031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00356441  0.02105593 -0.22923442]
Stock Position:  0.003564405523217419
Bond Position:  [4.71789817]


portfolio before change:  [5.09089758]
curr_Stock_Price:  104.48015334684153
curr_Factors:  [104.48015335  -0.44774446  -1.12774682]
mat_Sqrt:  [[21.61755802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04385567 -0.04674214 -3.12642911]
Stock Position:  -0.04385566929385269
Bond Position:  [9.67294464]


portfolio before change:  [5.05089129]
curr_Stock_Price:  105.41995164995923
curr_Factors:  [105.41995165  -0.21737963  -1.14728182]
mat_Sqrt:  [[26.93133474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166341 -0.03662687  0.33622103]
Stock Position:  0.0016634134224007674
Bond Position:  [4.87553433]


portfolio before change:  [5.05172982]
curr_Stock_Price:  105.55764690812782
curr_Factors:  [105.55764691  -0.2377876   -1.15684459]
mat_Sqrt:  [[26.17029595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00121706 -0.03958848  0.3267298 ]
Stock Position:  0.0012170646726101697
Bond Position:  [4.92325934]


portfolio before change:  [5.05342]
curr_Stock_Price:  106.44070339085555
curr_Factors:  [106.44070339  -0.17737459  -1.16427056]
mat_Sqrt:  [[27.82522276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210417  0.03790796 -0.11478891]
Stock Position:  0.0021041726709015176
Bond Position:  [4.82945038]


portfolio before change:  [5.05390625]
curr_Stock_Price:  106.38487653424035
curr_Factors:  [106.38487653  -0.14455062  -1.18859102]
mat_Sqrt:  [[28.04812507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391732 -0.00117747 -0.03862436]
Stock Position:  -0.003917317910481308
Bond Position:  [5.47064963]


portfolio before change:  [5.05926358]
curr_Stock_Price:  105.19185206955912
curr_Factors:  [105.19185207   0.11997465  -1.19404179]
mat_Sqrt:  [[35.93524961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085582  0.03972205  0.36565622]
Stock Position:  -0.000855820782687309
Bond Position:  [5.14928895]


portfolio before change:  [5.05963793]
curr_Stock_Price:  105.50657783538192
curr_Factors:  [ 1.05506578e+02 -6.68748796e-02 -1.21537589e+00]
mat_Sqrt:  [[29.26881249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00397721 -0.05008225 -0.30874276]
Stock Position:  0.003977205993860237
Bond Position:  [4.64001654]


portfolio before change:  [5.05488144]
curr_Stock_Price:  104.16479810738971
curr_Factors:  [104.16479811  -0.1766607   -1.18522387]
mat_Sqrt:  [[26.68468139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.72564252e-04 6.67688489e-02 2.34181640e-01]
Stock Position:  0.0001725642518028389
Bond Position:  [5.03690632]


portfolio before change:  [5.05586245]
curr_Stock_Price:  106.20093408657658
curr_Factors:  [106.20093409  -0.29135756  -1.20444689]
mat_Sqrt:  [[23.79626062  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00573082  0.03279327 -0.04594991]
Stock Position:  0.005730823839767347
Bond Position:  [4.44724361]


portfolio before change:  [5.05609624]
curr_Stock_Price:  106.14471932885816
curr_Factors:  [106.14471933  -0.25888119  -1.18759544]
mat_Sqrt:  [[24.98627837  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030871  0.01850666 -0.03306334]
Stock Position:  -0.0003087076803875472
Bond Position:  [5.08886393]


portfolio before change:  [5.05623609]
curr_Stock_Price:  107.75238682706681
curr_Factors:  [107.75238683  -0.51546027  -1.20140445]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.05623609]
Stock Price:  107.29751483611618
PL:  [-2.24127875]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.25893797e-01 -8.37057227e-03  4.31814010e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.28275536e-01 -1.16858517e-01 -2.22824974e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.12253646e+00 -3.31120534e-01  2.52216828e-02]
 [-5.54009833e-02  1.89901580e-03  3.46179222e-02]
 [ 2.62887475e-02  8.35576087e-02  4.76215222e-03]
 [ 3.38115611e-01 -1.32287512e-02 -8.58882755e-02]
 [-5.13431999e-01 -2.94779355e-02 -5.76104399e-02]
 [ 1.50048679e-02  3.77402199e-02 -1.56175378e-02]
 [-1.60237346e-03 -2.44349894e-01  1.22350972e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.26696370e-01 -3.90854974e-02  2.87035634e-01]
 [ 3.76144137e-02  2.34205169e-01  1.82745925e-01]
 [ 6.79284799e-02 -1.13190919e-01 -4.95301762e-02]
 [-1.65346371e-02 -5.84563165e-03  3.64596945e-02]
 [-5.83932971e-01 -2.94207023e-01  1.74645167e-01]
 [-1.21907111e-01  1.87207360e-02 -2.48546466e-02]
 [ 4.00685466e-01  1.41363075e+00  7.51506302e-01]
 [-2.00590902e-02  4.11331774e-02  2.61295582e-02]
 [-1.17682244e-02 -9.10173682e-02  6.10608941e-03]
 [ 8.49849683e-03  4.53282963e-02 -9.91666720e-03]
 [ 7.75318868e-02 -3.27283464e-02  1.02327852e-01]
 [ 7.94607247e-02 -5.35292604e-02 -4.29820502e-02]
 [-6.92882152e-02 -8.39855528e-02  1.28798206e-01]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [-1.20625418e-01 -7.55502586e-02  1.81030212e-01]
 [ 4.18901207e-02  5.80393192e-02 -8.46274553e-02]
 [-5.74166651e-01 -2.22217729e-02 -8.33300198e-01]
 [-1.83790274e-01  1.28829835e-01 -4.51000213e-02]
 [-6.47876191e-02  3.05949128e-02  1.12293169e-01]
 [ 7.62838217e-03  9.38589744e-04  3.52916406e-02]
 [-1.24469285e-01 -3.54129014e-03 -1.45354360e-01]
 [-6.79732951e-02 -6.14271707e-02  9.55619354e-03]
 [ 2.30034329e-01 -1.74003646e-01 -7.17653301e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-3.02566641e-02 -3.30103905e-02 -4.87637513e-02]
 [-9.98635088e-02 -2.20602861e-02  2.46882558e-03]
 [-4.65163396e-02 -2.79031244e-01  1.34390793e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.47158826]
curr_Stock_Price:  100.01168004407388
curr_Factors:  [100.01168004  -1.10392349  -1.0013751 ]
mat_Sqrt:  [[12.18235251  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00962832 -0.00264701  0.12318452]
Stock Position:  -0.009628317483003438
Bond Position:  [3.43453246]


portfolio before change:  [2.46901805]
curr_Stock_Price:  100.32321464441004
curr_Factors:  [100.32321464  -0.95852216  -0.99178745]
mat_Sqrt:  [[14.26897367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031804   0.01411938  0.0859571 ]
Stock Position:  -0.0031803999293338807
Bond Position:  [2.78808599]


portfolio before change:  [2.46799617]
curr_Stock_Price:  100.75410559430695
curr_Factors:  [100.75410559  -1.31129127  -0.98387025]
mat_Sqrt:  [[10.15048444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01771091 -0.03695391 -0.63565763]
Stock Position:  0.017710908803719002
Bond Position:  [0.6835494]


portfolio before change:  [2.47168005]
curr_Stock_Price:  100.95728114823535
curr_Factors:  [100.95728115  -1.17927761  -0.98598616]
mat_Sqrt:  [[11.58178603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00170121 -0.00659539  0.21422481]
Stock Position:  0.001701210319342838
Bond Position:  [2.29993048]


portfolio before change:  [2.47275119]
curr_Stock_Price:  101.4179120153371
curr_Factors:  [101.41791202  -1.23158434  -0.97392121]
mat_Sqrt:  [[11.17572667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10074849 -0.10470951  0.07195044]
Stock Position:  -0.10074849163950984
Bond Position:  [12.69045285]


portfolio before change:  [2.53320861]
curr_Stock_Price:  100.8335754947672
curr_Factors:  [100.83357549  -1.37275549  -0.98936948]
mat_Sqrt:  [[ 9.50051897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508242  0.00060052  0.0987553 ]
Stock Position:  -0.005082416790324985
Bond Position:  [3.04568687]


portfolio before change:  [2.53413996]
curr_Stock_Price:  100.72523950809489
curr_Factors:  [100.72523951  -1.35829897  -1.00435557]
mat_Sqrt:  [[ 9.48528701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00310146 0.02642324 0.01358509]
Stock Position:  0.0031014629229985085
Bond Position:  [2.22174436]


portfolio before change:  [2.53397781]
curr_Stock_Price:  100.58340713833427
curr_Factors:  [100.58340714  -1.25359959  -1.04738698]
mat_Sqrt:  [[10.07443203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03178762 -0.0041833  -0.24501534]
Stock Position:  0.031787615842293004
Bond Position:  [-0.6633289]


portfolio before change:  [2.55465843]
curr_Stock_Price:  101.23660322519859
curr_Factors:  [101.23660323  -1.24850254  -1.04419875]
mat_Sqrt:  [[10.22421662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05144187 -0.00932174 -0.16434655]
Stock Position:  -0.05144186763852107
Bond Position:  [7.76245837]


portfolio before change:  [2.51429801]
curr_Stock_Price:  102.04004970427236
curr_Factors:  [102.0400497   -1.25662089  -1.0663799 ]
mat_Sqrt:  [[ 9.99779523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00127942  0.01193451 -0.04455249]
Stock Position:  0.001279422048157208
Bond Position:  [2.38374572]


portfolio before change:  [2.51401016]
curr_Stock_Price:  101.58216081145149
curr_Factors:  [101.58216081  -1.00255227  -1.05626123]
mat_Sqrt:  [[12.96242039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00131637 -0.07727022  0.34903327]
Stock Position:  0.0013163688864278164
Bond Position:  [2.38029057]


portfolio before change:  [2.514434]
curr_Stock_Price:  101.67808897927173
curr_Factors:  [101.67808898  -1.36333057  -1.0723961 ]
mat_Sqrt:  [[ 8.90030164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00810373  0.00225658  0.15019092]
Stock Position:  -0.008103727435582644
Bond Position:  [3.33840552]


portfolio before change:  [2.51220203]
curr_Stock_Price:  102.00501157041974
curr_Factors:  [102.00501157  -1.61090749  -1.09550521]
mat_Sqrt:  [[ 6.81147873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02705405 -0.01235992  0.81883277]
Stock Position:  0.02705405057272604
Bond Position:  [-0.24744671]


portfolio before change:  [2.50725283]
curr_Stock_Price:  101.82321746718516
curr_Factors:  [101.82321747  -1.80350255  -1.06485171]
mat_Sqrt:  [[ 5.78277624  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01400096 0.07406218 0.52132326]
Stock Position:  0.01400096036060591
Bond Position:  [1.08163]


portfolio before change:  [2.50123262]
curr_Stock_Price:  101.38357478863904
curr_Factors:  [101.38357479  -1.79473636  -1.06300619]
mat_Sqrt:  [[ 5.81923346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00943348 -0.03579411 -0.14129581]
Stock Position:  0.00943347581449655
Bond Position:  [1.54483312]


portfolio before change:  [2.50165328]
curr_Stock_Price:  101.40769502783287
curr_Factors:  [101.40769503  -1.70408974  -1.05642243]
mat_Sqrt:  [[ 6.41498596  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144089 -0.00184855  0.10400936]
Stock Position:  -0.0014408864950493214
Bond Position:  [2.64777026]


portfolio before change:  [2.5019954]
curr_Stock_Price:  101.39997107979772
curr_Factors:  [101.39997108  -1.79204335  -1.06501732]
mat_Sqrt:  [[ 5.82414455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09544407 -0.09303643  0.49821405]
Stock Position:  -0.09544407138224227
Bond Position:  [12.18002148]


portfolio before change:  [2.50249489]
curr_Stock_Price:  101.41069054308718
curr_Factors:  [101.41069054  -1.86144449  -1.06551284]
mat_Sqrt:  [[ 5.43153173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02328941  0.00592002 -0.07090339]
Stock Position:  -0.02328941142101461
Bond Position:  [4.86429018]


portfolio before change:  [2.4955139]
curr_Stock_Price:  101.73654947655155
curr_Factors:  [101.73654948  -1.98999063  -1.09177789]
mat_Sqrt:  [[ 4.66747437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.12653221 0.4470293  2.1438383 ]
Stock Position:  0.1265322077747682
Bond Position:  [-10.37743632]


portfolio before change:  [2.51797057]
curr_Stock_Price:  101.92427979537858
curr_Factors:  [101.9242798   -1.94580502  -1.11788125]
mat_Sqrt:  [[ 4.76141033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028696   0.01300745  0.07454036]
Stock Position:  -0.0028696040515161793
Bond Position:  [2.8104529]


portfolio before change:  [2.51788405]
curr_Stock_Price:  102.07686300961645
curr_Factors:  [102.07686301  -1.78572187  -1.1173663 ]
mat_Sqrt:  [[ 5.59927945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00229885 -0.02878222  0.01741897]
Stock Position:  -0.0022988462284130977
Bond Position:  [2.75254306]


portfolio before change:  [2.51774589]
curr_Stock_Price:  102.28663913782013
curr_Factors:  [102.28663914  -1.85986644  -1.12386975]
mat_Sqrt:  [[ 5.17605339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147692  0.01433407 -0.02828949]
Stock Position:  0.0014769239455874514
Bond Position:  [2.36667631]


portfolio before change:  [2.51821649]
curr_Stock_Price:  102.4049568702553
curr_Factors:  [102.40495687  -1.79441967  -1.11110766]
mat_Sqrt:  [[ 5.6035918   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01741284 -0.01034961  0.29191288]
Stock Position:  0.01741283683699937
Bond Position:  [0.73505569]


portfolio before change:  [2.52151061]
curr_Stock_Price:  102.5888576950719
curr_Factors:  [102.5888577   -1.69355742  -1.12184808]
mat_Sqrt:  [[ 6.14306512  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01128182 -0.01692744 -0.12261583]
Stock Position:  0.011281816073836713
Bond Position:  [1.36412199]


portfolio before change:  [2.52057227]
curr_Stock_Price:  102.49056911591012
curr_Factors:  [102.49056912  -1.58432252  -1.12346162]
mat_Sqrt:  [[ 6.83452277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00660849 -0.02655856  0.36742543]
Stock Position:  -0.006608492011831224
Bond Position:  [3.19788037]


portfolio before change:  [2.51743318]
curr_Stock_Price:  103.02606871352287
curr_Factors:  [103.02606871  -1.61758311  -1.10104545]
mat_Sqrt:  [[ 6.79613107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00190639  0.02004328 -0.05140267]
Stock Position:  0.0019063909701852125
Bond Position:  [2.32102521]


portfolio before change:  [2.51829546]
curr_Stock_Price:  103.32618301277165
curr_Factors:  [103.32618301  -1.53631569  -1.10768697]
mat_Sqrt:  [[ 7.34403303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01165892 -0.02389109  0.51642881]
Stock Position:  -0.011658918175780974
Bond Position:  [3.72296698]


portfolio before change:  [2.51825522]
curr_Stock_Price:  103.36955301132214
curr_Factors:  [103.36955301  -1.42125829  -1.10374571]
mat_Sqrt:  [[ 8.27555887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00315558  0.01835364 -0.24141857]
Stock Position:  0.003155579331864574
Bond Position:  [2.19206439]


portfolio before change:  [2.51868105]
curr_Stock_Price:  103.41766159815103
curr_Factors:  [103.4176616   -1.69139086  -1.09265417]
mat_Sqrt:  [[ 6.38997738  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11656334 -0.00702714 -2.37717352]
Stock Position:  -0.11656333997244794
Bond Position:  [14.5733891]


portfolio before change:  [2.51099429]
curr_Stock_Price:  103.49923573373538
curr_Factors:  [103.49923573  -1.3613477   -1.07401185]
mat_Sqrt:  [[ 9.06304071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02092784  0.04073957 -0.12865781]
Stock Position:  -0.020927844386416955
Bond Position:  [4.67701018]


portfolio before change:  [2.52297815]
curr_Stock_Price:  102.95454525398499
curr_Factors:  [102.95454525  -1.51646051  -1.07502687]
mat_Sqrt:  [[ 7.71217468  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00532611  0.00967496  0.32034116]
Stock Position:  -0.005326113097519362
Bond Position:  [3.0713257]


portfolio before change:  [2.52471436]
curr_Stock_Price:  102.70065038958685
curr_Factors:  [102.70065039  -1.59446878  -1.03564797]
mat_Sqrt:  [[ 7.40164071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00200719 0.00029681 0.10067723]
Stock Position:  0.0020071890810698413
Bond Position:  [2.31857473]


portfolio before change:  [2.52543115]
curr_Stock_Price:  102.91336155616747
curr_Factors:  [102.91336156  -1.51690461  -1.05577113]
mat_Sqrt:  [[ 7.85548288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01963356 -0.00111985 -0.41465553]
Stock Position:  -0.01963355503898185
Bond Position:  [4.5459863]


portfolio before change:  [2.53097598]
curr_Stock_Price:  102.65988994999157
curr_Factors:  [102.65988995  -1.40362123  -1.06715424]
mat_Sqrt:  [[ 8.67674119  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00779194 -0.01942498  0.02726116]
Stock Position:  -0.007791944756353909
Bond Position:  [3.33089617]


portfolio before change:  [2.53449197]
curr_Stock_Price:  102.26209481441369
curr_Factors:  [102.26209481  -1.55783383  -1.08101554]
mat_Sqrt:  [[ 7.3059545   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02886584 -0.05502478 -0.20472651]
Stock Position:  0.02886584331370357
Bond Position:  [-0.41738964]


portfolio before change:  [2.53206586]
curr_Stock_Price:  102.17985465279634
curr_Factors:  [102.17985465  -1.56328582  -1.07998345]
mat_Sqrt:  [[ 7.26788455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00337263 0.00777784 0.21633947]
Stock Position:  0.0033726297509105285
Bond Position:  [2.18745104]


portfolio before change:  [2.53070828]
curr_Stock_Price:  101.69624820209837
curr_Factors:  [101.6962482   -1.41250428  -1.06218662]
mat_Sqrt:  [[ 8.56170638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00479611 -0.0104388  -0.13910941]
Stock Position:  -0.0047961055797105835
Bond Position:  [3.01845423]


portfolio before change:  [2.52935397]
curr_Stock_Price:  102.05730051019594
curr_Factors:  [102.05730051  -1.63021478  -1.09629686]
mat_Sqrt:  [[ 6.67936413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01496088 -0.00697607  0.00704287]
Stock Position:  -0.014960878609249856
Bond Position:  [4.05622085]


portfolio before change:  [2.5294893]
curr_Stock_Price:  102.0821471504268
curr_Factors:  [102.08214715  -1.47865091  -1.08035635]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.5294893]
Stock Price:  102.57674535293252
PL:  [-0.04725605]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.50632128e-01 -9.06075687e-03  6.77087554e-02]
 [-8.02354857e-03 -2.60811151e-02 -9.59289420e-02]
 [ 3.55776215e-01 -2.01106952e-01 -4.27121210e-01]
 [-1.14326908e-02  3.22385370e-02  1.25232142e-01]
 [-1.42710394e-01 -5.35733393e-02  4.91661149e-02]
 [ 1.09041034e-01 -2.83465087e-01 -3.91097251e-01]
 [ 4.50206436e-03 -4.80156523e-01 -7.58664623e-02]
 [ 1.20115174e-02  1.64227232e-01  1.91792802e-02]
 [ 8.63549503e-02  2.32218413e-02 -1.26645944e-02]
 [ 1.79739158e-01  1.16997641e-01  5.51526960e-01]
 [ 3.25377666e-01 -1.55937747e-01 -1.27027462e-01]
 [-4.18884031e-01 -2.61293623e-01 -5.78717268e-01]
 [ 2.64499411e-01 -5.34828719e-01 -2.22693668e-01]
 [-6.18136342e-02 -2.12792850e-01 -1.06766513e-01]
 [-3.84124600e-01  7.82629286e-01  5.39386507e-01]
 [ 1.29544809e-01 -6.78903196e-01 -2.00394179e-01]
 [ 1.50693238e-01 -2.06134324e-01 -1.13123395e-01]
 [-3.37596893e-01 -2.61181318e-01 -1.08169088e-01]
 [ 6.53856090e-02  9.53486452e-01 -1.58467217e-01]
 [-5.92970435e-01 -1.12875863e-01  4.13548811e-01]
 [-1.03708413e-01 -5.65529314e-02 -1.21286449e-02]
 [ 1.81556527e-01 -6.10413484e-02  9.90957879e-02]
 [-3.16791234e-02  1.15153267e-01 -9.94570448e-02]
 [-6.63399053e-02 -8.80869099e-02  4.39812429e-02]
 [-1.11456882e-01  9.95660622e-02  3.46324872e-02]
 [ 9.94249807e-02 -1.23613154e-01 -1.34312729e-01]
 [ 6.04033099e-02 -3.66031236e-02  1.08097012e-01]
 [-6.52643654e-02  4.37310747e-02  6.69567854e-02]
 [-6.30586323e-01 -6.62941143e-03 -9.04742247e-01]
 [-8.88247367e-02 -1.18398310e-01  6.36329050e-03]
 [-6.34578562e-02  8.41151490e-02  1.81489473e-01]
 [ 1.85014733e-02  8.97433006e-02 -7.85405693e-03]
 [-1.36453876e-01 -1.69704838e-02 -1.33439103e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 1.81981624e-01 -1.37322520e-01 -4.24312449e-02]
 [ 7.97224528e-03  2.76420013e-02  7.59383013e-02]
 [-9.36682013e-03 -1.08808144e-02 -4.53448263e-02]
 [-6.93339472e-02  7.41987144e-02 -4.76221498e-03]
 [-2.20792048e-02 -2.93964931e-01  1.20396414e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.46836821]
curr_Stock_Price:  100.01123139529655
curr_Factors:  [100.0112314   -0.96031942  -1.0152244 ]
mat_Sqrt:  [[13.87014486  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00988058 -0.00286526  0.19315423]
Stock Position:  -0.009880580580492475
Bond Position:  [3.45653724]


portfolio before change:  [2.45579868]
curr_Stock_Price:  101.32710841625287
curr_Factors:  [101.32710842  -1.18124365  -1.0130062 ]
mat_Sqrt:  [[11.29210861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250426 -0.00824757 -0.27365857]
Stock Position:  -0.002504259772359187
Bond Position:  [2.70954808]


portfolio before change:  [2.45458291]
curr_Stock_Price:  101.94784279405746
curr_Factors:  [101.94784279  -0.85349613  -0.99918246]
mat_Sqrt:  [[15.98710956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01647564 -0.0635956  -1.21845792]
Stock Position:  0.016475642632685458
Bond Position:  [0.77492669]


portfolio before change:  [2.42407337]
curr_Stock_Price:  100.0901660546082
curr_Factors:  [100.09016605  -0.73377147  -1.01898706]
mat_Sqrt:  [[17.34514967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00086264 0.01019472 0.35725244]
Stock Position:  0.0008626393491797925
Bond Position:  [2.33773165]


portfolio before change:  [2.42288158]
curr_Stock_Price:  98.36983655710539
curr_Factors:  [98.36983656 -0.65131301 -0.99661371]
mat_Sqrt:  [[18.93112687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00708134 -0.01694138  0.14025724]
Stock Position:  -0.00708133550907546
Bond Position:  [3.11947139]


portfolio before change:  [2.43629977]
curr_Stock_Price:  96.53003721598036
curr_Factors:  [96.53003722 -0.7167367  -0.98846213]
mat_Sqrt:  [[17.54300676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124777 -0.08963953 -1.1156916 ]
Stock Position:  0.0012477681463913602
Bond Position:  [2.31585267]


portfolio before change:  [2.43579445]
curr_Stock_Price:  95.89304632868561
curr_Factors:  [95.89304633 -0.57456541 -0.96850711]
mat_Sqrt:  [[20.49458997  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00114087 -0.15183882 -0.2164259 ]
Stock Position:  -0.001140871836685984
Bond Position:  [2.54519613]


portfolio before change:  [2.43873629]
curr_Stock_Price:  93.59333933504197
curr_Factors:  [93.59333934 -0.37348743 -0.96369812]
mat_Sqrt:  [[24.57608146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00082059 0.05193321 0.05471315]
Stock Position:  0.0008205864914930525
Bond Position:  [2.36193486]


portfolio before change:  [2.43989308]
curr_Stock_Price:  94.64322579906303
curr_Factors:  [94.6432258  -0.47351784 -0.98181393]
mat_Sqrt:  [[22.08243585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00382066  0.00734339 -0.03612856]
Stock Position:  0.003820655780952573
Bond Position:  [2.07829389]


portfolio before change:  [2.43900571]
curr_Stock_Price:  94.34297055407909
curr_Factors:  [94.34297055 -0.64390103 -1.01651277]
mat_Sqrt:  [[17.93085487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01647105 0.0369979  1.5733529 ]
Stock Position:  0.016471049211878558
Bond Position:  [0.885078]


portfolio before change:  [2.42543434]
curr_Stock_Price:  93.51230055241471
curr_Factors:  [93.51230055 -0.73127513 -1.02356876]
mat_Sqrt:  [[16.17147846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01826809 -0.04931185 -0.36237399]
Stock Position:  0.01826808842940625
Bond Position:  [0.71714337]


portfolio before change:  [2.41104211]
curr_Stock_Price:  92.71955876575203
curr_Factors:  [92.71955877 -0.79113423 -1.02377703]
mat_Sqrt:  [[15.09959899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0360116  -0.0826283  -1.65091928]
Stock Position:  -0.036011603469150034
Bond Position:  [5.7500221]


portfolio before change:  [2.46137782]
curr_Stock_Price:  91.3417554238565
curr_Factors:  [91.34175542 -0.67658687 -1.0040402 ]
mat_Sqrt:  [[17.01305442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01206327 -0.16912769 -0.63528305]
Stock Position:  0.012063268203489238
Bond Position:  [1.35949773]


portfolio before change:  [2.46549324]
curr_Stock_Price:  91.66882036713075
curr_Factors:  [91.66882037 -0.54281595 -1.00356568]
mat_Sqrt:  [[19.52704985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00456298 -0.06729101 -0.30457514]
Stock Position:  -0.004562980366983833
Bond Position:  [2.88377627]


portfolio before change:  [2.46643852]
curr_Stock_Price:  91.54066243434757
curr_Factors:  [91.54066243 -0.44943951 -1.023437  ]
mat_Sqrt:  [[20.9870749   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01209389  0.24748911  1.53871957]
Stock Position:  -0.012093890638460003
Bond Position:  [3.57352128]


portfolio before change:  [2.45408514]
curr_Stock_Price:  92.59905629107611
curr_Factors:  [92.59905629 -0.66834071 -1.02084671]
mat_Sqrt:  [[17.10022339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00415844 -0.21468804 -0.57166881]
Stock Position:  0.004158443544696444
Bond Position:  [2.06901719]


portfolio before change:  [2.44820913]
curr_Stock_Price:  91.12383040075407
curr_Factors:  [91.1238304  -0.6141844  -0.97472097]
mat_Sqrt:  [[18.60283493  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00657317 -0.0651854  -0.32270956]
Stock Position:  0.006573173214954724
Bond Position:  [1.84923641]


portfolio before change:  [2.44221501]
curr_Stock_Price:  90.1767537550112
curr_Factors:  [90.17675376 -0.2843088  -0.99093547]
mat_Sqrt:  [[25.19202309  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0145451  -0.08259278 -0.3085763 ]
Stock Position:  -0.01454509970994711
Bond Position:  [3.75384488]


portfolio before change:  [2.42531884]
curr_Stock_Price:  91.37065577418176
curr_Factors:  [91.37065577 -0.21469683 -0.99730337]
mat_Sqrt:  [[27.19203704  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00212038  0.30151889 -0.45206286]
Stock Position:  0.002120383189547361
Bond Position:  [2.23157804]


portfolio before change:  [2.42609955]
curr_Stock_Price:  91.60728429197427
curr_Factors:  [ 9.16072843e+01 -2.24711197e-02 -9.95759162e-01]
mat_Sqrt:  [[33.09163427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01545616 -0.03569448  1.17973965]
Stock Position:  -0.015456159580900436
Bond Position:  [3.84199635]


portfolio before change:  [2.42771635]
curr_Stock_Price:  91.53375217594686
curr_Factors:  [91.53375218 -0.20747874 -0.96089626]
mat_Sqrt:  [[28.45525295  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378293 -0.01788361 -0.03459965]
Stock Position:  -0.0037829343238274726
Bond Position:  [2.77398253]


portfolio before change:  [2.4228674]
curr_Stock_Price:  92.907216052878
curr_Factors:  [92.90721605 -0.17738455 -1.01018255]
mat_Sqrt:  [[28.33319879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00706621 -0.01930297  0.2826927 ]
Stock Position:  0.007066208452456181
Bond Position:  [1.76636564]


portfolio before change:  [2.42153553]
curr_Stock_Price:  92.68748386750501
curr_Factors:  [92.68748387 -0.19241601 -1.01222062]
mat_Sqrt:  [[27.78779292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176363  0.03641466 -0.28372327]
Stock Position:  -0.0017636328038046257
Bond Position:  [2.58500222]


portfolio before change:  [2.41973287]
curr_Stock_Price:  93.89284264504965
curr_Factors:  [93.89284265 -0.26103911 -0.98777541]
mat_Sqrt:  [[26.93265919  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221429 -0.02785553  0.12546624]
Stock Position:  -0.0022142880675168285
Bond Position:  [2.62763867]


portfolio before change:  [2.41617631]
curr_Stock_Price:  95.6473730204731
curr_Factors:  [95.64737302 -0.54346601 -0.97937644]
mat_Sqrt:  [[20.85983992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00488099  0.03148555  0.09879685]
Stock Position:  -0.004880994810979163
Bond Position:  [2.88303064]


portfolio before change:  [2.41684089]
curr_Stock_Price:  95.58505330614067
curr_Factors:  [95.58505331 -0.37596148 -0.99869881]
mat_Sqrt:  [[24.1758976   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00284651 -0.03908991 -0.38315683]
Stock Position:  0.0028465057643535445
Bond Position:  [2.14475749]


portfolio before change:  [2.4181799]
curr_Stock_Price:  95.96126707769274
curr_Factors:  [95.96126708 -0.34620333 -0.98711002]
mat_Sqrt:  [[25.29562094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00322283 -0.01157492  0.30837069]
Stock Position:  0.0032228278445192685
Bond Position:  [2.10891326]


portfolio before change:  [2.42056157]
curr_Stock_Price:  96.61846742118553
curr_Factors:  [96.61846742 -0.31337033 -1.01278801]
mat_Sqrt:  [[25.65174386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196742  0.01382898  0.19100907]
Stock Position:  -0.0019674193553578818
Bond Position:  [2.61065062]


portfolio before change:  [2.41506791]
curr_Stock_Price:  99.57666286263826
curr_Factors:  [99.57666286 -0.64259494 -1.01449894]
mat_Sqrt:  [[18.98850784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.29437236e-02 -2.09640397e-03 -2.58097780e+00]
Stock Position:  -0.04294372357546836
Bond Position:  [6.6912606]


portfolio before change:  [2.40836123]
curr_Stock_Price:  99.75231476560371
curr_Factors:  [99.75231477 -0.71575922 -1.04387326]
mat_Sqrt:  [[17.16818181  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00527621 -0.03744083  0.0181527 ]
Stock Position:  -0.005276206160639995
Bond Position:  [2.934675]


portfolio before change:  [2.40930464]
curr_Stock_Price:  99.64304017985536
curr_Factors:  [99.64304018 -0.53913352 -1.06525746]
mat_Sqrt:  [[20.02944078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012102   0.02659955  0.51773895]
Stock Position:  -0.0012101999767593085
Bond Position:  [2.52989264]


portfolio before change:  [2.41054449]
curr_Stock_Price:  98.87986722517621
curr_Factors:  [98.87986723 -0.55261564 -1.0769012 ]
mat_Sqrt:  [[19.38285322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099136  0.02837932 -0.02240544]
Stock Position:  0.00099136243987657
Bond Position:  [2.3125187]


portfolio before change:  [2.41294404]
curr_Stock_Price:  101.008722401225
curr_Factors:  [101.0087224   -0.46462746  -1.10929007]
mat_Sqrt:  [[20.93221464  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00784103 -0.00536654 -0.38066462]
Stock Position:  -0.007841033422341211
Bond Position:  [3.20495681]


portfolio before change:  [2.41070071]
curr_Stock_Price:  101.34591914791613
curr_Factors:  [101.34591915  -0.45841534  -1.09629154]
mat_Sqrt:  [[21.40945668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244816  0.0049611   0.16678008]
Stock Position:  -0.0024481566410065663
Bond Position:  [2.6588114]


portfolio before change:  [2.41139673]
curr_Stock_Price:  101.19737993064996
curr_Factors:  [101.19737993  -0.42653235  -1.09956989]
mat_Sqrt:  [[21.99841996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00771759 -0.04342519 -0.12104453]
Stock Position:  0.007717587489995429
Bond Position:  [1.6303971]


portfolio before change:  [2.41192898]
curr_Stock_Price:  101.23993626545152
curr_Factors:  [101.23993627  -0.52222929  -1.13076343]
mat_Sqrt:  [[19.38501957  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00124771 0.00874117 0.21663084]
Stock Position:  0.0012477057065197691
Bond Position:  [2.28561133]


portfolio before change:  [2.41154031]
curr_Stock_Price:  100.69943756867649
curr_Factors:  [100.69943757  -0.62339757  -1.13012627]
mat_Sqrt:  [[17.43738328  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108409 -0.00344082 -0.12935617]
Stock Position:  -0.0010840924445531944
Bond Position:  [2.52070781]


portfolio before change:  [2.41112644]
curr_Stock_Price:  101.37186789523294
curr_Factors:  [101.3718679   -0.54472636  -1.10127832]
mat_Sqrt:  [[19.54639627  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00349887  0.02346369 -0.01358527]
Stock Position:  -0.0034988663257232554
Bond Position:  [2.76581306]


portfolio before change:  [2.41615366]
curr_Stock_Price:  100.03387064143931
curr_Factors:  [100.03387064  -0.67994765  -1.07325992]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.41615366]
Stock Price:  99.29407999073703
PL:  [2.41615366]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-7.74935261e-02 -1.22806818e-02 -9.88421412e-03]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.45051917e-01  5.59588841e-03 -3.85955680e-02]
 [ 2.62335577e-03 -1.54692156e-02  8.02194389e-02]
 [-9.18923413e-01 -2.73444756e-01  3.01974627e-02]
 [-7.04352085e-02  3.07369655e-02  7.83510321e-02]
 [ 1.92687983e-02  1.07636135e-01  3.17527666e-02]
 [ 3.39179757e-01 -2.25094185e-02 -8.53604012e-02]
 [-5.12592132e-01 -3.02799986e-02 -5.38596591e-02]
 [ 2.40765885e-02  2.23283419e-02 -2.28394519e-02]
 [-1.96371921e-02 -1.88972761e-01  7.66192550e-02]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.26268248e-01 -3.86695446e-02  2.86713105e-01]
 [ 5.62229562e-02  1.89760565e-01  1.44739155e-01]
 [ 6.07191447e-02 -1.13325438e-01 -4.62776874e-02]
 [-3.17210762e-02  3.19538246e-02  4.23300400e-02]
 [-4.75083208e-01 -2.63169401e-01  1.30082311e-01]
 [-1.57902912e-01  6.90246104e-03 -2.73255712e-02]
 [ 3.47493813e-01  1.35803578e+00  5.49631676e-01]
 [-1.67850892e-01 -1.51741502e-02  1.57517327e-01]
 [-9.05451836e-02  1.13977371e-01 -3.86545692e-02]
 [ 6.14776455e-02 -6.53563471e-03  4.18525560e-02]
 [-4.47691213e-02 -1.89380286e-02 -6.26762021e-02]
 [ 9.29554332e-03  3.72689083e-02  1.23727526e-01]
 [-9.03795248e-02 -1.69114148e-03 -3.86336918e-02]
 [ 1.12907894e-01 -2.50005790e-02 -1.32542540e-02]
 [ 9.59027303e-03 -5.51795418e-02 -2.07516205e-02]
 [ 1.05382176e-03  4.20265251e-02  3.86698242e-04]
 [-5.32741236e-01  8.56811840e-02 -6.76324765e-01]
 [-4.83133003e-03 -1.18861979e-01 -4.27795855e-02]
 [-7.42279433e-02  8.47031685e-02  1.94335762e-01]
 [ 2.21696038e-02  1.08131219e-01 -1.64568949e-02]
 [-1.00349014e-01  1.56461908e-03 -1.63716555e-01]
 [-6.16378285e-02  9.02671322e-02  1.05761926e-01]
 [-4.06833767e-02  1.68195626e-02  6.99024041e-02]
 [-5.03580217e-02 -3.85777497e-02  3.23820273e-02]
 [ 4.62213273e-02  3.10307782e-02 -7.73634434e-03]
 [-8.88190146e-02  1.10382516e-02 -4.85503368e-04]
 [ 2.17294362e-03 -2.47212194e-01  8.43963603e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.46756444]
curr_Stock_Price:  100.15044937139434
curr_Factors:  [100.15044937  -1.2264059   -1.03115656]
mat_Sqrt:  [[10.47625311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00761992 -0.00388349 -0.02819691]
Stock Position:  -0.007619920776471354
Bond Position:  [4.23070293]


portfolio before change:  [3.46661395]
curr_Stock_Price:  100.34459309228643
curr_Factors:  [100.34459309  -1.319133    -0.97973303]
mat_Sqrt:  [[10.07184757  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00450573  0.01411938  0.0859571 ]
Stock Position:  -0.0045057316988165565
Bond Position:  [3.91873976]


portfolio before change:  [3.46611473]
curr_Stock_Price:  100.56411084879662
curr_Factors:  [100.56411085  -1.12780836  -1.00776966]
mat_Sqrt:  [[11.88429075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01996906  0.00176958 -0.11010241]
Stock Position:  0.019969060018753503
Bond Position:  [1.45794397]


portfolio before change:  [3.46552585]
curr_Stock_Price:  100.5254941875078
curr_Factors:  [100.52549419  -1.0387956   -1.01576599]
mat_Sqrt:  [[12.88224206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144374 -0.0048918   0.22884373]
Stock Position:  0.0014437445484499682
Bond Position:  [3.32039272]


portfolio before change:  [3.46603157]
curr_Stock_Price:  100.58827501907415
curr_Factors:  [100.58827502  -1.15224358  -1.01612093]
mat_Sqrt:  [[11.50372842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0799584  -0.08647082  0.08614496]
Stock Position:  -0.07995839792348411
Bond Position:  [11.50890889]


portfolio before change:  [3.39823329]
curr_Stock_Price:  101.45418749834825
curr_Factors:  [101.4541875   -1.20389353  -1.02045446]
mat_Sqrt:  [[10.97104302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00488999  0.00971988  0.22351369]
Stock Position:  -0.0048899859276508
Bond Position:  [3.89434284]


portfolio before change:  [3.39938496]
curr_Stock_Price:  101.3182268548155
curr_Factors:  [101.31822685  -1.10923766  -1.03553841]
mat_Sqrt:  [[11.86378232  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00240475 0.03403753 0.0905818 ]
Stock Position:  0.002404752291557012
Bond Position:  [3.15573972]


portfolio before change:  [3.39946489]
curr_Stock_Price:  101.1874167740738
curr_Factors:  [101.18741677  -1.24872485  -1.06412645]
mat_Sqrt:  [[10.01539193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03206809 -0.0071181  -0.24350946]
Stock Position:  0.032068085796651054
Bond Position:  [0.15457813]


portfolio before change:  [3.39396103]
curr_Stock_Price:  101.01518383778456
curr_Factors:  [101.01518384  -1.41787245  -1.04734867]
mat_Sqrt:  [[ 8.58528529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06107753 -0.00957538 -0.15364662]
Stock Position:  -0.06107752948744448
Bond Position:  [9.5637189]


portfolio before change:  [3.38974855]
curr_Stock_Price:  101.10372742197643
curr_Factors:  [101.10372742  -1.47964258  -1.0180258 ]
mat_Sqrt:  [[ 8.31847225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00240321  0.00706084 -0.0651546 ]
Stock Position:  0.0024032081393180155
Bond Position:  [3.14677525]


portfolio before change:  [3.38933314]
curr_Stock_Price:  100.76718379505738
curr_Factors:  [100.7671838   -1.55016536  -0.99908708]
mat_Sqrt:  [[ 7.87395361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112734 -0.05975843  0.21857341]
Stock Position:  -0.001127338094884595
Bond Position:  [3.50293182]


portfolio before change:  [3.38918211]
curr_Stock_Price:  101.28958373459754
curr_Factors:  [101.28958373  -1.45933711  -1.02993186]
mat_Sqrt:  [[ 8.4040574   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00858224  0.00225658  0.15019092]
Stock Position:  -0.00858223774025109
Bond Position:  [4.2584734]


portfolio before change:  [3.38606946]
curr_Stock_Price:  101.71429670715327
curr_Factors:  [101.71429671  -1.22368457  -1.05868038]
mat_Sqrt:  [[10.3791908   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01770802 -0.01222838  0.81791268]
Stock Position:  0.01770801555187366
Bond Position:  [1.58491111]


portfolio before change:  [3.38726854]
curr_Stock_Price:  101.77082195803447
curr_Factors:  [101.77082196  -1.10670384  -1.0645565 ]
mat_Sqrt:  [[11.60531408  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00781257 0.06000756 0.41290052]
Stock Position:  0.007812568332257267
Bond Position:  [2.59217704]


portfolio before change:  [3.38766696]
curr_Stock_Price:  101.78034231945763
curr_Factors:  [101.78034232  -1.03791394  -1.06771221]
mat_Sqrt:  [[12.39373175  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0039009  -0.03583665 -0.13201736]
Stock Position:  0.0039008994267583966
Bond Position:  [2.99063208]


portfolio before change:  [3.38806317]
curr_Stock_Price:  101.78607339689977
curr_Factors:  [101.7860734   -1.00192581  -1.04586785]
mat_Sqrt:  [[13.1323628   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016947   0.01010469  0.12075582]
Stock Position:  -0.0016947025558793382
Bond Position:  [3.56056029]


portfolio before change:  [3.39128497]
curr_Stock_Price:  100.14761097461421
curr_Factors:  [100.14761097  -1.16514787  -1.01065576]
mat_Sqrt:  [[11.36844549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04005167 -0.08322147  0.37108862]
Stock Position:  -0.04005167394021986
Bond Position:  [7.40236443]


portfolio before change:  [3.42033563]
curr_Stock_Price:  99.4453854571627
curr_Factors:  [99.44538546 -1.11550253 -1.03639127]
mat_Sqrt:  [[11.56189532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0141242   0.00218275 -0.07795225]
Stock Position:  -0.014124198140984088
Bond Position:  [4.82492196]


portfolio before change:  [3.44133875]
curr_Stock_Price:  98.0010584229023
curr_Factors:  [98.00105842 -1.20520821 -1.01631129]
mat_Sqrt:  [[10.62764665  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04655323 0.42944862 1.56794618]
Stock Position:  0.046553226497265135
Bond Position:  [-1.12092672]


portfolio before change:  [3.44563045]
curr_Stock_Price:  98.09625747587707
curr_Factors:  [98.09625748 -1.19547433 -1.04436634]
mat_Sqrt:  [[10.44484488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01302936 -0.00479849  0.44935309]
Stock Position:  -0.013029355494078364
Bond Position:  [4.72376146]


portfolio before change:  [3.45464506]
curr_Stock_Price:  97.44970892880058
curr_Factors:  [97.44970893 -1.37390244 -1.03778939]
mat_Sqrt:  [[ 8.73767911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01092883  0.03604281 -0.11027073]
Stock Position:  -0.010928832503172574
Bond Position:  [4.51965661]


portfolio before change:  [3.45475253]
curr_Stock_Price:  97.49157346275918
curr_Factors:  [97.49157346 -0.98269788 -1.09625442]
mat_Sqrt:  [[12.19241037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00572914 -0.00206675  0.11939369]
Stock Position:  0.00572913896673653
Bond Position:  [2.89620975]


portfolio before change:  [3.45859945]
curr_Stock_Price:  98.09984558781022
curr_Factors:  [98.09984559 -1.0605454  -1.08261851]
mat_Sqrt:  [[11.50546205  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00504559 -0.00598873 -0.17879776]
Stock Position:  -0.005045588347320333
Bond Position:  [3.95357089]


portfolio before change:  [3.45884713]
curr_Stock_Price:  98.1487092355799
curr_Factors:  [98.14870924 -1.17882782 -1.06656943]
mat_Sqrt:  [[10.39252217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00341723 0.01178546 0.35296019]
Stock Position:  0.003417226096559161
Bond Position:  [3.1234508]


portfolio before change:  [3.46063365]
curr_Stock_Price:  98.55724682495654
curr_Factors:  [98.55724682 -1.09446597 -1.04872996]
mat_Sqrt:  [[11.55873739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00850519 -0.00053479 -0.11021117]
Stock Position:  -0.008505190128283397
Bond Position:  [4.29888178]


portfolio before change:  [3.45949759]
curr_Stock_Price:  98.75400437511749
curr_Factors:  [98.75400438 -1.14023861 -1.07667683]
mat_Sqrt:  [[10.75871917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01018308 -0.00790588 -0.0378107 ]
Stock Position:  0.010183077275294865
Bond Position:  [2.45387793]


portfolio before change:  [3.45897715]
curr_Stock_Price:  98.67277274299221
curr_Factors:  [98.67277274 -1.19732313 -1.06844092]
mat_Sqrt:  [[10.23737256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00038385 -0.0174493  -0.0591986 ]
Stock Position:  0.0003838520641750116
Bond Position:  [3.42110141]


portfolio before change:  [3.45943735]
curr_Stock_Price:  98.7575200361651
curr_Factors:  [98.75752004 -1.2118875  -1.06032643]
mat_Sqrt:  [[10.18029121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00021786 0.01328995 0.00110314]
Stock Position:  0.00021785982093238524
Bond Position:  [3.43792205]


portfolio before change:  [3.45984255]
curr_Stock_Price:  98.64476864997651
curr_Factors:  [98.64476865 -1.19506467 -1.05543929]
mat_Sqrt:  [[10.39184369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0643373   0.02709477 -1.9293663 ]
Stock Position:  -0.06433730067246021
Bond Position:  [9.80638069]


portfolio before change:  [3.47101979]
curr_Stock_Price:  98.49009368444445
curr_Factors:  [98.49009368 -1.01181589 -1.02371227]
mat_Sqrt:  [[12.86393697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129297 -0.03758746 -0.12203825]
Stock Position:  -0.0012929696013093794
Bond Position:  [3.59836449]


portfolio before change:  [3.47083373]
curr_Stock_Price:  98.98189635586655
curr_Factors:  [98.98189636 -1.1283592  -1.01814977]
mat_Sqrt:  [[11.57014423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279792  0.02678549  0.55438584]
Stock Position:  -0.002797916331430415
Bond Position:  [3.7477768]


portfolio before change:  [3.47384727]
curr_Stock_Price:  98.07227636932542
curr_Factors:  [98.07227637 -1.06372241 -1.01534792]
mat_Sqrt:  [[12.26358607  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017615   0.03419409 -0.04694694]
Stock Position:  0.0017614986473529482
Bond Position:  [3.30109309]


portfolio before change:  [3.47441662]
curr_Stock_Price:  98.16122722472632
curr_Factors:  [98.16122722 -1.19166064 -0.98401174]
mat_Sqrt:  [[11.14442002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01199947  0.00049478 -0.46703776]
Stock Position:  -0.011999468521204926
Bond Position:  [4.65229918]


portfolio before change:  [3.47045154]
curr_Stock_Price:  98.54013171776305
curr_Factors:  [98.54013172 -1.10189558 -0.96725893]
mat_Sqrt:  [[12.44488105  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303085  0.02854497  0.30170934]
Stock Position:  -0.00303085085200212
Bond Position:  [3.76911199]


portfolio before change:  [3.47240943]
curr_Stock_Price:  98.04960433954558
curr_Factors:  [98.04960434 -0.9430977  -0.95756607]
mat_Sqrt:  [[14.65541282  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177275  0.00531881  0.1994121 ]
Stock Position:  -0.0017727463120151697
Bond Position:  [3.6462265]


portfolio before change:  [3.47334766]
curr_Stock_Price:  97.77747033478882
curr_Factors:  [97.77747033 -0.8432135  -0.98423494]
mat_Sqrt:  [[15.72490485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284543 -0.01219936  0.09237691]
Stock Position:  -0.0028454316036226374
Bond Position:  [3.75156676]


portfolio before change:  [3.4723799]
curr_Stock_Price:  98.28239728615803
curr_Factors:  [98.28239729 -0.67069649 -1.00365617]
mat_Sqrt:  [[18.42101761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00246693  0.00981279 -0.02206964]
Stock Position:  0.002466930157007984
Bond Position:  [3.22992409]


portfolio before change:  [3.47585998]
curr_Stock_Price:  99.52941737071524
curr_Factors:  [99.52941737 -0.60481943 -1.00423179]
mat_Sqrt:  [[19.9135825   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445089  0.0034906  -0.00138501]
Stock Position:  -0.0044508872831705276
Bond Position:  [3.9188542]


portfolio before change:  [3.48266268]
curr_Stock_Price:  98.11108989681007
curr_Factors:  [98.1110899  -0.49817914 -0.98244896]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.48266268]
Stock Price:  98.78357372611171
PL:  [3.48266268]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.02057735e-01  3.11186859e-02  5.13594941e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.30014312e-01  1.23222820e-01  1.56814238e-01]
 [-4.49459358e-02  4.57399968e-02  1.15114126e-01]
 [-5.90635801e-01 -1.80453450e-01  3.82199686e-02]
 [ 1.23613149e-02 -1.28079464e-01 -1.62496062e-01]
 [ 3.35338493e-02 -4.84721076e-02 -2.89949849e-02]
 [ 2.21276959e-01  1.49477086e-01 -5.81631050e-02]
 [-2.09263252e-01  6.94125883e-03 -7.56328318e-02]
 [ 1.23192957e-01  1.23321167e-02  1.76563264e-01]
 [ 2.35207838e-01 -2.64748013e-01 -5.29007734e-02]
 [-1.25661720e-01 -1.00001417e-01 -2.18589264e-01]
 [ 2.19854795e-01 -2.65126971e-01 -1.01253601e-02]
 [ 8.29356053e-02 -6.25649009e-02 -5.90029525e-02]
 [ 3.18160020e-02 -1.05762013e-01 -5.29880334e-02]
 [-2.38571130e-02 -8.51932092e-02 -2.26513681e-03]
 [-4.68129449e-01 -2.44303253e-01  1.25429494e-01]
 [-1.75578855e-01 -3.81891060e-02 -2.44624565e-02]
 [ 3.16868072e-01  1.29962800e+00  4.87428254e-01]
 [-1.54371616e-01 -2.26235653e-02  1.27018834e-01]
 [-9.28132460e-02  1.87548014e-01 -3.52048553e-02]
 [-8.69136023e-03  3.31074025e-02 -3.58484942e-03]
 [ 4.07675363e-02 -3.49194095e-02  5.12398454e-02]
 [ 4.89384529e-02  2.01353809e-01  1.03082462e-01]
 [-5.87876339e-02 -1.74918440e-01 -4.47436364e-02]
 [ 7.55684758e-02  2.44089052e-02 -1.25831310e-02]
 [ 1.27753823e-02 -5.29232170e-02  4.05555079e-03]
 [ 1.68190386e-02  4.27884512e-02 -8.20562547e-02]
 [-6.67569998e-01 -8.08810866e-02 -1.02983290e+00]
 [-2.75901888e-01  1.19144271e-01 -1.04454832e-02]
 [-7.02212899e-02  1.05379448e-02  1.14130523e-01]
 [ 1.06338897e-02  1.89483297e-02  2.67285831e-02]
 [-1.33794254e-01 -5.32089211e-03 -1.39728181e-01]
 [-6.72406457e-02 -4.38848579e-02  2.06816678e-02]
 [ 2.25516556e-01 -1.73416747e-01 -7.40108337e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-1.75024072e-02 -1.92146143e-02 -4.78789077e-02]
 [-8.06266986e-02  3.58712628e-02 -2.62155965e-03]
 [-1.94621322e-02 -2.98793901e-01  1.21266352e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.08967333]
curr_Stock_Price:  100.37645774758053
curr_Factors:  [100.37645775  -0.84690192  -1.01457104]
mat_Sqrt:  [[15.60286797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00581755  0.00984059  0.14651434]
Stock Position:  -0.005817554895638421
Bond Position:  [5.67361888]


portfolio before change:  [5.0966063]
curr_Stock_Price:  99.30664015679406
curr_Factors:  [99.30664016 -0.71005724 -0.98880107]
mat_Sqrt:  [[18.16241091  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249862  0.01411938  0.0859571 ]
Stock Position:  -0.002498624387283007
Bond Position:  [5.34473629]


portfolio before change:  [5.09544668]
curr_Stock_Price:  100.03814484257256
curr_Factors:  [100.03814484  -1.17048933  -0.9727171 ]
mat_Sqrt:  [[11.73229305  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02260474 0.03896648 0.44734737]
Stock Position:  0.022604744230256442
Bond Position:  [2.83411]


portfolio before change:  [5.07364601]
curr_Stock_Price:  99.05804285040031
curr_Factors:  [99.05804285 -1.02331468 -0.9298309 ]
mat_Sqrt:  [[14.04912885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144261  0.01446426  0.32838856]
Stock Position:  -0.0014426062822922845
Bond Position:  [5.21654776]


portfolio before change:  [5.07398867]
curr_Stock_Price:  99.2725453057071
curr_Factors:  [99.27254531 -1.00426487 -0.92612343]
mat_Sqrt:  [[14.40363716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04078786 -0.05706439  0.10903093]
Stock Position:  -0.04078785542172416
Bond Position:  [9.1231029]


portfolio before change:  [5.08327091]
curr_Stock_Price:  99.07293249752897
curr_Factors:  [99.0729325  -1.00258353 -0.94074971]
mat_Sqrt:  [[14.18979485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00169946 -0.04050228 -0.46355603]
Stock Position:  -0.0016994644886431487
Bond Position:  [5.25164184]


portfolio before change:  [5.08333898]
curr_Stock_Price:  99.4191749454447
curr_Factors:  [99.41917495 -1.1328398  -0.93954503]
mat_Sqrt:  [[12.51540365  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0021065  -0.01532823 -0.08271462]
Stock Position:  0.002106502445955604
Bond Position:  [4.87391225]


portfolio before change:  [5.08262145]
curr_Stock_Price:  98.78930949515299
curr_Factors:  [98.7893095  -0.95461684 -0.97413777]
mat_Sqrt:  [[14.35695914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0148544   0.04726881 -0.16592315]
Stock Position:  0.014854395345439874
Bond Position:  [3.61516599]


portfolio before change:  [5.07617644]
curr_Stock_Price:  98.32500715895638
curr_Factors:  [98.32500716 -0.54410084 -0.98092339]
mat_Sqrt:  [[21.39707356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01049314  0.00219502 -0.21575942]
Stock Position:  -0.010493141315361323
Bond Position:  [6.10791463]


portfolio before change:  [5.08651381]
curr_Stock_Price:  97.41261732481308
curr_Factors:  [97.41261732 -0.41244422 -0.94881398]
mat_Sqrt:  [[24.97056028  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00638961 0.00389976 0.50368585]
Stock Position:  0.006389612183052831
Bond Position:  [4.46408496]


portfolio before change:  [5.07642358]
curr_Stock_Price:  95.7461187339807
curr_Factors:  [95.74611873 -0.42101504 -0.92318497]
mat_Sqrt:  [[24.96562991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00871493 -0.08372067 -0.15091118]
Stock Position:  0.00871493127826417
Bond Position:  [4.24200273]


portfolio before change:  [5.08977348]
curr_Stock_Price:  97.217114145957
curr_Factors:  [97.21711415 -0.10807059 -0.95340706]
mat_Sqrt:  [[33.63170134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00513989 -0.03162322 -0.62357433]
Stock Position:  -0.005139885431300387
Bond Position:  [5.58945831]


portfolio before change:  [5.09057142]
curr_Stock_Price:  97.1978119745367
curr_Factors:  [97.19781197 -0.14420322 -0.95668529]
mat_Sqrt:  [[32.32560667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00652555 -0.08384051 -0.02888483]
Stock Position:  0.006525551645024532
Bond Position:  [4.45630208]


portfolio before change:  [5.10436513]
curr_Stock_Price:  99.22624327271218
curr_Factors:  [99.22624327 -0.24470286 -0.95796684]
mat_Sqrt:  [[29.80668892  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00232418 -0.01978476 -0.168319  ]
Stock Position:  0.0023241849980680427
Bond Position:  [4.87374498]


portfolio before change:  [5.10831669]
curr_Stock_Price:  100.6642985706385
curr_Factors:  [100.66429857  -0.49753762  -0.94126239]
mat_Sqrt:  [[23.87880381  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00076508 -0.03344489 -0.15116011]
Stock Position:  0.0007650760765864893
Bond Position:  [5.03130084]


portfolio before change:  [5.10836096]
curr_Stock_Price:  99.90008272405605
curr_Factors:  [99.90008272 -0.6163869  -0.93372406]
mat_Sqrt:  [[21.20123743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125083 -0.02694046 -0.0064618 ]
Stock Position:  -0.0012508308263381098
Bond Position:  [5.23331906]


portfolio before change:  [5.10713299]
curr_Stock_Price:  101.40482535651897
curr_Factors:  [101.40482536  -0.9405853   -0.92389369]
mat_Sqrt:  [[15.7154089   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02856013 -0.07725547  0.35781543]
Stock Position:  -0.0285601314453749
Bond Position:  [8.00326813]


portfolio before change:  [5.14649629]
curr_Stock_Price:  100.06159519519755
curr_Factors:  [100.0615952   -0.90243173  -0.93044798]
mat_Sqrt:  [[16.00508111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01134379 -0.01207646 -0.06978458]
Stock Position:  -0.011343789558373164
Bond Position:  [6.28157397]


portfolio before change:  [5.1475462]
curr_Stock_Price:  100.03826359373514
curr_Factors:  [100.03826359  -1.06115723  -0.94149307]
mat_Sqrt:  [[13.50287267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03332033 0.41097846 1.39049713]
Stock Position:  0.03332033180469861
Bond Position:  [1.81423807]


portfolio before change:  [5.12204679]
curr_Stock_Price:  99.26617621650794
curr_Factors:  [99.26617622 -1.05140887 -0.94100116]
mat_Sqrt:  [[13.53656936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00953182 -0.0071542   0.36234938]
Stock Position:  -0.009531819997705979
Bond Position:  [6.06823411]


portfolio before change:  [5.11780615]
curr_Stock_Price:  99.79065260802888
curr_Factors:  [99.79065261 -0.95930722 -0.93952362]
mat_Sqrt:  [[14.94301061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00636799  0.05930789 -0.10042965]
Stock Position:  -0.0063679897316566555
Bond Position:  [5.753272]


portfolio before change:  [5.11947519]
curr_Stock_Price:  99.64149402810705
curr_Factors:  [99.64149403 -0.89660064 -0.95132698]
mat_Sqrt:  [[15.69984857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054576  0.01046948 -0.01022658]
Stock Position:  -0.000545755907002938
Bond Position:  [5.17385513]


portfolio before change:  [5.11991644]
curr_Stock_Price:  100.01808108134121
curr_Factors:  [100.01808108  -0.73487983  -0.94263688]
mat_Sqrt:  [[18.6871154   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00269304 -0.01104249  0.14617302]
Stock Position:  0.00269304328491376
Bond Position:  [4.85056342]


portfolio before change:  [5.11965115]
curr_Stock_Price:  99.69441449780956
curr_Factors:  [99.6944145  -0.73553544 -0.97181666]
mat_Sqrt:  [[18.07911771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00415833 0.06367367 0.29406557]
Stock Position:  0.004158333742874912
Bond Position:  [4.7050885]


portfolio before change:  [5.12204136]
curr_Stock_Price:  100.12776870023724
curr_Factors:  [100.1277687   -0.95806859  -0.94777259]
mat_Sqrt:  [[14.88874977  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00486523 -0.05531407 -0.12764114]
Stock Position:  -0.00486523491135014
Bond Position:  [5.60918647]


portfolio before change:  [5.12289504]
curr_Stock_Price:  100.09642591644254
curr_Factors:  [100.09642592  -0.87933616  -0.9506336 ]
mat_Sqrt:  [[16.05731034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00458546  0.00771877 -0.03589617]
Stock Position:  0.00458546223218059
Bond Position:  [4.66390666]


portfolio before change:  [5.12659535]
curr_Stock_Price:  100.77624589211847
curr_Factors:  [100.77624589  -0.75532369  -0.96865373]
mat_Sqrt:  [[17.97398167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0006808  -0.01673579  0.01156936]
Stock Position:  0.000680803327536497
Bond Position:  [5.05798655]


portfolio before change:  [5.12714845]
curr_Stock_Price:  100.65993405040044
curr_Factors:  [100.65993405  -0.76165561  -0.97497437]
mat_Sqrt:  [[17.72751358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.62342645e-05  1.35308963e-02 -2.34083654e-01]
Stock Position:  6.62342644872327e-05
Bond Position:  [5.12048132]


portfolio before change:  [5.1278489]
curr_Stock_Price:  101.57096744647373
curr_Factors:  [101.57096745  -0.8558106   -0.97428822]
mat_Sqrt:  [[16.29175123  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05400721 -0.02557685 -2.93782663]
Stock Position:  -0.05400721431496791
Bond Position:  [10.6134139]


portfolio before change:  [5.07222514]
curr_Stock_Price:  102.6254657028318
curr_Factors:  [102.6254657   -1.22910207  -0.98631655]
mat_Sqrt:  [[11.19724193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02455585  0.03767673 -0.02979806]
Stock Position:  -0.024555848058252453
Bond Position:  [7.59228049]


portfolio before change:  [5.05242539]
curr_Stock_Price:  103.47043124369223
curr_Factors:  [103.47043124  -1.38230265  -1.03572598]
mat_Sqrt:  [[ 9.21891405  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00506051  0.00333239  0.32558261]
Stock Position:  -0.005060509900729439
Bond Position:  [5.57603853]


portfolio before change:  [5.05624568]
curr_Stock_Price:  102.85325272965297
curr_Factors:  [102.85325273  -1.33024956  -1.03444779]
mat_Sqrt:  [[ 9.66591615  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00171521 0.00599199 0.07624921]
Stock Position:  0.0017152106792789196
Bond Position:  [4.87983068]


portfolio before change:  [5.05724838]
curr_Stock_Price:  103.08219282392743
curr_Factors:  [103.08219282  -1.36895542  -1.02267094]
mat_Sqrt:  [[ 9.4300396   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01722724 -0.00168261 -0.39860561]
Stock Position:  -0.017227237828228784
Bond Position:  [6.83306983]


portfolio before change:  [5.06732937]
curr_Stock_Price:  102.54659895849092
curr_Factors:  [102.54659896  -1.35691825  -1.0084749 ]
mat_Sqrt:  [[ 9.63039434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00666142 -0.01387761  0.05899904]
Stock Position:  -0.006661421938508598
Bond Position:  [5.75043553]


portfolio before change:  [5.06817511]
curr_Stock_Price:  102.52754957047286
curr_Factors:  [102.52754957  -1.4044236   -0.99834909]
mat_Sqrt:  [[ 9.27533611  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02220206 -0.05483919 -0.21113231]
Stock Position:  0.022202058654602362
Bond Position:  [2.79185244]


portfolio before change:  [5.04855626]
curr_Stock_Price:  101.62818019067474
curr_Factors:  [101.62818019  -1.12321946  -0.96529082]
mat_Sqrt:  [[12.58883842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00194711 0.00777784 0.21633947]
Stock Position:  0.0019471124203318427
Bond Position:  [4.85067477]


portfolio before change:  [5.04907129]
curr_Stock_Price:  101.58126797973686
curr_Factors:  [101.58126798  -1.11721789  -0.97934098]
mat_Sqrt:  [[12.48215812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00222492 -0.00607619 -0.1365852 ]
Stock Position:  -0.0022249171417670845
Bond Position:  [5.2750812]


portfolio before change:  [5.05083997]
curr_Stock_Price:  101.08270883351203
curr_Factors:  [101.08270883  -0.82851556  -0.9869163 ]
mat_Sqrt:  [[16.45298994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00487666  0.01134349 -0.00747858]
Stock Position:  -0.004876659530790633
Bond Position:  [5.54378593]


portfolio before change:  [5.0566198]
curr_Stock_Price:  100.03961522241069
curr_Factors:  [100.03961522  -0.96145713  -0.99724524]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.0566198]
Stock Price:  100.60051393857745
PL:  [4.45610586]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.39546940e-01  5.49099101e-02  2.11991057e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.06842105e-01  2.64335509e-01  3.95100870e-01]
 [-3.95917772e-02 -6.05047886e-02  8.14883911e-02]
 [-4.39218066e-02 -2.55903164e-02  5.15802542e-02]
 [ 9.70026386e-02 -2.76256158e-01 -3.78192409e-01]
 [ 7.06070380e-03 -4.47979579e-01 -7.05629344e-02]
 [ 1.23637305e-01  2.57093878e-01 -3.21565725e-02]
 [-1.09117835e-01  1.58205721e-02 -6.84656501e-02]
 [ 9.04207490e-02 -3.27035916e-02 -8.23806533e-03]
 [ 1.37887243e-01 -2.29855501e-01 -2.24456159e-02]
 [-1.47978823e-02 -3.90187694e-02 -8.24291870e-02]
 [ 2.04387101e-01 -1.60903211e-01  1.65667761e-01]
 [ 8.83074696e-02 -5.61449895e-02 -6.06193645e-02]
 [ 7.38884029e-02 -1.07639809e-01 -6.49793814e-02]
 [-3.18365531e-02 -5.00063345e-02  8.92272313e-03]
 [-4.71737405e-01 -2.74191822e-01  1.29993633e-01]
 [-2.12386117e-01 -6.35215674e-02 -3.48390567e-02]
 [ 2.94647835e-01  1.26441549e+00  4.00879427e-01]
 [-2.19143828e-01 -3.63460405e-02  1.59855550e-01]
 [-9.78026921e-02  3.49393978e-01 -2.76159279e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 6.68405201e-02 -3.65971602e-02  8.63930991e-02]
 [ 7.85342695e-02  1.29690046e-01  2.12312220e-02]
 [-9.29064657e-02  4.14788796e-02  1.51306818e-01]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [ 3.43178932e-02 -6.64078924e-02  1.04682455e-01]
 [ 3.96125827e-02  4.63082329e-02 -6.46867059e-02]
 [-7.59715617e-01 -1.74726065e-01 -1.21328121e+00]
 [-1.38846233e-01 -1.04863597e-01  2.61669345e-02]
 [-2.53695073e-02  7.09186261e-02  1.39148778e-01]
 [ 2.89000116e-02  1.61624684e-01 -4.24044301e-02]
 [-1.36453876e-01 -1.69704838e-02 -1.33439103e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 1.22016031e-01 -9.02341134e-02 -2.82238289e-03]
 [-1.29424240e-02  1.77699540e-01  8.09693696e-02]
 [ 7.44939826e-02  6.50969842e-02 -3.23085349e-02]
 [-3.02669677e-02  7.53017267e-02 -9.38173685e-03]
 [-3.66396835e-02 -2.59842420e-01  1.00581662e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.80175769]
curr_Stock_Price:  99.55560486462079
curr_Factors:  [99.55560486 -0.88347839 -0.98105894]
mat_Sqrt:  [[15.42792233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01263013  0.01736404  0.60475148]
Stock Position:  -0.012630130917935604
Bond Position:  [0.45564263]


portfolio before change:  [-0.79726697]
curr_Stock_Price:  99.20455787543874
curr_Factors:  [99.20455788 -0.8984429  -0.95793705]
mat_Sqrt:  [[15.49944177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00292791  0.01411938  0.0859571 ]
Stock Position:  -0.0029279146640066238
Bond Position:  [-0.50680449]


portfolio before change:  [-0.79714452]
curr_Stock_Price:  99.14110017618745
curr_Factors:  [99.14110018 -1.16445773 -0.95667855]
mat_Sqrt:  [[11.88655352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02476049 0.08359023 1.12711281]
Stock Position:  0.02476048628545271
Bond Position:  [-3.25192637]


portfolio before change:  [-0.83435581]
curr_Stock_Price:  97.65466861375351
curr_Factors:  [97.65466861 -0.82861114 -0.97270356]
mat_Sqrt:  [[16.12099987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152101 -0.01913329  0.2324637 ]
Stock Position:  -0.0015210133445618386
Bond Position:  [-0.68582175]


portfolio before change:  [-0.83462403]
curr_Stock_Price:  97.77464676974598
curr_Factors:  [97.77464677 -0.66432117 -0.98378929]
mat_Sqrt:  [[18.81312657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181011 -0.00809237  0.14714411]
Stock Position:  -0.001810106912980938
Bond Position:  [-0.65764146]


portfolio before change:  [-0.83291448]
curr_Stock_Price:  96.784781044237
curr_Factors:  [96.78478104 -0.60200828 -0.96252172]
mat_Sqrt:  [[20.2460511   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.25876773e-04 -8.73598676e-02 -1.07887767e+00]
Stock Position:  0.0006258767733718732
Bond Position:  [-0.89348982]


portfolio before change:  [-0.83337201]
curr_Stock_Price:  96.23221703030283
curr_Factors:  [96.23221703 -0.77305757 -0.99451036]
mat_Sqrt:  [[16.43143513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00115082 -0.14166358 -0.20129641]
Stock Position:  -0.0011508232679468251
Bond Position:  [-0.72262573]


portfolio before change:  [-0.83491008]
curr_Stock_Price:  97.49022323126422
curr_Factors:  [97.49022323 -0.72284447 -0.9893554 ]
mat_Sqrt:  [[17.59389956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0070315   0.08130022 -0.09173375]
Stock Position:  0.007031500177322672
Bond Position:  [-1.5204126]


portfolio before change:  [-0.83576354]
curr_Stock_Price:  97.39587758118958
curr_Factors:  [97.39587758 -0.73416431 -0.97620857]
mat_Sqrt:  [[17.60901541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00696716  0.0050029  -0.19531344]
Stock Position:  -0.0069671607784222815
Bond Position:  [-0.1571908]


portfolio before change:  [-0.84324525]
curr_Stock_Price:  98.46691171170806
curr_Factors:  [98.46691171 -0.83824203 -0.98540221]
mat_Sqrt:  [[15.89614029  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00552931 -0.01034178 -0.02350091]
Stock Position:  0.005529314426267141
Bond Position:  [-1.38769977]


portfolio before change:  [-0.84963081]
curr_Stock_Price:  97.34342977425715
curr_Factors:  [97.34342977 -0.92205097 -0.9998475 ]
mat_Sqrt:  [[14.2441568   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00894196 -0.07268669 -0.06403109]
Stock Position:  0.00894196188465164
Bond Position:  [-1.72007205]


portfolio before change:  [-0.83922665]
curr_Stock_Price:  98.53099697623388
curr_Factors:  [98.53099698 -1.03486736 -1.04057302]
mat_Sqrt:  [[12.36575313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263883 -0.01233882 -0.23514753]
Stock Position:  -0.002638830775400352
Bond Position:  [-0.57922003]


portfolio before change:  [-0.84204568]
curr_Stock_Price:  99.57184484702462
curr_Factors:  [99.57184485 -1.12421423 -1.04247413]
mat_Sqrt:  [[11.40658803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02051879 -0.05088206  0.47260401]
Stock Position:  0.020518790334854542
Bond Position:  [-2.88513949]


portfolio before change:  [-0.85575982]
curr_Stock_Price:  98.92105240278467
curr_Factors:  [98.9210524  -1.22507244 -1.03942757]
mat_Sqrt:  [[10.2761129   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00724826 -0.0177546  -0.17293017]
Stock Position:  0.0072482598221164105
Bond Position:  [-1.57276531]


portfolio before change:  [-0.85120853]
curr_Stock_Price:  99.57609282111908
curr_Factors:  [99.57609282 -1.30403716 -1.0265559 ]
mat_Sqrt:  [[ 9.68258627  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00597416 -0.0340387  -0.18536809]
Stock Position:  0.0059741573966491475
Bond Position:  [-1.44609178]


portfolio before change:  [-0.85668202]
curr_Stock_Price:  98.69015642936267
curr_Factors:  [98.69015643 -1.26747951 -1.00783971]
mat_Sqrt:  [[10.14180498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308686 -0.01581339  0.02545405]
Stock Position:  -0.0030868635254805397
Bond Position:  [-0.55203898]


portfolio before change:  [-0.85801599]
curr_Stock_Price:  99.09994347264076
curr_Factors:  [99.09994347 -1.27900703 -1.00398041]
mat_Sqrt:  [[10.10612252  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04475328 -0.08670707  0.37083565]
Stock Position:  -0.04475328370636655
Bond Position:  [3.5770319]


portfolio before change:  [-0.83581461]
curr_Stock_Price:  98.61385137015303
curr_Factors:  [98.61385137 -0.81195851 -0.96959927]
mat_Sqrt:  [[16.60417129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0133182  -0.02008728 -0.09938613]
Stock Position:  -0.013318203342076628
Bond Position:  [0.47754471]


portfolio before change:  [-0.83720262]
curr_Stock_Price:  98.722552145098
curr_Factors:  [98.72255215 -0.69952779 -0.98989779]
mat_Sqrt:  [[18.22670507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02244641 0.39984329 1.14359742]
Stock Position:  0.022446408790352652
Bond Position:  [-3.05316938]


portfolio before change:  [-0.83049676]
curr_Stock_Price:  99.0383053977878
curr_Factors:  [99.0383054  -0.53121094 -0.97092492]
mat_Sqrt:  [[22.05128416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00850072 -0.01149363  0.45602339]
Stock Position:  -0.008500724953184227
Bond Position:  [0.01140064]


portfolio before change:  [-0.83168795]
curr_Stock_Price:  99.17860122029437
curr_Factors:  [99.17860122 -0.44167765 -0.96335022]
mat_Sqrt:  [[24.33448337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00388003  0.11048808 -0.07878056]
Stock Position:  -0.0038800271440937472
Bond Position:  [-0.44687229]


portfolio before change:  [-0.84124875]
curr_Stock_Price:  101.6283114981707
curr_Factors:  [101.6283115   -0.83955015  -0.96083853]
mat_Sqrt:  [[16.79251862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231465  0.01916992 -0.08961985]
Stock Position:  -0.0023146536000959567
Bond Position:  [-0.60601442]


portfolio before change:  [-0.83997911]
curr_Stock_Price:  101.04705802503989
curr_Factors:  [101.04705803  -0.72662073  -0.95513503]
mat_Sqrt:  [[18.79950558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00444323 -0.01157304  0.24645546]
Stock Position:  0.004443228716227215
Bond Position:  [-1.2889543]


portfolio before change:  [-0.83856675]
curr_Stock_Price:  101.40118992024432
curr_Factors:  [101.40118992  -0.67585739  -0.9394184 ]
mat_Sqrt:  [[20.16218929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00427616 0.04101159 0.06056677]
Stock Position:  0.004276155525333692
Bond Position:  [-1.27217401]


portfolio before change:  [-0.82780937]
curr_Stock_Price:  103.95404703727628
curr_Factors:  [103.95404704  -0.51659568  -0.94378033]
mat_Sqrt:  [[24.13282491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252561  0.01311677  0.43163624]
Stock Position:  -0.002525610279353798
Bond Position:  [-0.56526196]


portfolio before change:  [-0.82459662]
curr_Stock_Price:  102.65400025243979
curr_Factors:  [102.65400025  -0.36713007  -0.92714476]
mat_Sqrt:  [[28.1371081   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00046046  0.02004328 -0.05140267]
Stock Position:  0.00046046249160498716
Bond Position:  [-0.87186494]


portfolio before change:  [-0.82555814]
curr_Stock_Price:  100.80254062592347
curr_Factors:  [100.80254063  -0.36856596  -0.91897233]
mat_Sqrt:  [[27.81638584  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194028 -0.02100002  0.29862991]
Stock Position:  0.0019402759819130636
Bond Position:  [-1.02114289]


portfolio before change:  [-0.82538849]
curr_Stock_Price:  100.95576373833593
curr_Factors:  [ 1.00955764e+02 -5.72504951e-02 -9.27221428e-01]
mat_Sqrt:  [[37.72075656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0007318   0.01464395 -0.18453317]
Stock Position:  0.0007318023318203388
Bond Position:  [-0.89926816]


portfolio before change:  [-0.82468306]
curr_Stock_Price:  102.07334655946998
curr_Factors:  [102.07334656  -0.29119306  -0.9259901 ]
mat_Sqrt:  [[30.22013649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03348387 -0.05525323 -3.46115357]
Stock Position:  -0.03348386645086106
Bond Position:  [2.59312725]


portfolio before change:  [-0.76662932]
curr_Stock_Price:  100.34924529165649
curr_Factors:  [100.34924529  -0.22564503  -0.92709423]
mat_Sqrt:  [[31.68734187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429864 -0.03316078  0.07464698]
Stock Position:  -0.004298640660432101
Bond Position:  [-0.33526397]


portfolio before change:  [-0.76240352]
curr_Stock_Price:  99.35643930989134
curr_Factors:  [99.35643931 -0.45805803 -0.94712593]
mat_Sqrt:  [[24.37431278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.99604768e-04 2.24264387e-02 3.96952732e-01]
Stock Position:  0.00019960476808816852
Bond Position:  [-0.78223553]


portfolio before change:  [-0.76287631]
curr_Stock_Price:  97.47767429503426
curr_Factors:  [97.4776743  -0.4858334  -0.91966213]
mat_Sqrt:  [[23.90596097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00102139  0.05111021 -0.12096804]
Stock Position:  0.0010213927397909692
Bond Position:  [-0.8624393]


portfolio before change:  [-0.7605261]
curr_Stock_Price:  99.88421157379392
curr_Factors:  [99.88421157 -0.35228236 -0.94682024]
mat_Sqrt:  [[27.24606302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.006024   -0.00536654 -0.38066462]
Stock Position:  -0.006023996732425158
Bond Position:  [-0.15882394]


portfolio before change:  [-0.76763471]
curr_Stock_Price:  101.0609640645592
curr_Factors:  [ 1.01060964e+02 -4.34342384e-02 -9.23922076e-01]
mat_Sqrt:  [[38.4119122   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136452  0.0049611   0.16678008]
Stock Position:  -0.0013645169053771106
Bond Position:  [-0.62973532]


portfolio before change:  [-0.76756659]
curr_Stock_Price:  100.95334989607379
curr_Factors:  [100.9533499    0.10808141  -0.9197596 ]
mat_Sqrt:  [[44.83460781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00265665 -0.02853453 -0.00805147]
Stock Position:  0.002656654873700746
Bond Position:  [-1.0357648]


portfolio before change:  [-0.76105374]
curr_Stock_Price:  103.45361250588505
curr_Factors:  [103.45361251   0.18764348  -0.9151282 ]
mat_Sqrt:  [[49.98078319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.63534086e-04 5.61935286e-02 2.30983074e-01]
Stock Position:  0.0001635340864759585
Bond Position:  [-0.77797193]


portfolio before change:  [-0.76128184]
curr_Stock_Price:  102.65346425365513
curr_Factors:  [ 1.02653464e+02  5.78628591e-02 -9.09413312e-01]
mat_Sqrt:  [[43.80764905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0015883   0.02058547 -0.09216726]
Stock Position:  0.0015883031599964526
Bond Position:  [-0.92432666]


portfolio before change:  [-0.7619238]
curr_Stock_Price:  102.32203621038343
curr_Factors:  [ 1.02322036e+02  4.87547345e-02 -8.85289398e-01]
mat_Sqrt:  [[44.3268414   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068215  0.0238125  -0.02676348]
Stock Position:  -0.000682153827581049
Bond Position:  [-0.69212443]


portfolio before change:  [-0.76075654]
curr_Stock_Price:  100.48406454125956
curr_Factors:  [ 1.00484065e+02  9.64870629e-02 -8.91661261e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.76075654]
Stock Price:  99.31438550780092
PL:  [-0.76075654]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.52358293e-01 -1.21996445e-02  6.66130954e-02]
 [-1.11946072e-02 -2.10590379e-02 -8.69782678e-02]
 [ 2.95098929e-01 -1.11512649e-02 -9.34699066e-02]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-8.74992860e-01 -2.57631285e-01  1.26987670e-02]
 [-8.12522897e-02  3.72985611e-02  7.96066207e-02]
 [-3.59087535e-04  1.74573388e-01  9.57092911e-02]
 [ 3.71888794e-01 -3.21335992e-02 -9.67169804e-02]
 [-5.93750403e-01 -2.99461949e-02 -9.13719140e-02]
 [ 6.13981791e-03  5.28009867e-02 -8.56015221e-03]
 [ 3.13450053e-04 -2.51570873e-01  1.28083569e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.39836499e-01 -5.18521273e-02  2.96934841e-01]
 [ 4.05315583e-02  2.95476815e-01  2.50070444e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-1.48782564e-02 -9.96840767e-03  3.58194176e-02]
 [-5.64649992e-01 -2.67351976e-01  1.64466296e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 2.46407657e-01  9.93790104e-01  3.93935204e-01]
 [-1.06392603e-02  3.17120287e-02  2.75327774e-02]
 [ 7.63987736e-03 -1.48764773e-01  4.61187514e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.56910017e-01 -2.83605632e-02  1.62836835e-01]
 [ 7.96085452e-02 -1.67692438e-01 -8.23470911e-02]
 [-1.21268386e-01  2.25056919e-01  1.86753542e-01]
 [ 1.33530013e-02  6.18147977e-02  1.97386402e-02]
 [-9.37918750e-02 -1.07440856e-01  1.78822499e-01]
 [ 6.74250157e-02  6.47218925e-02 -7.83726635e-02]
 [-7.23480227e-01 -1.46332005e-01 -1.09594946e+00]
 [-5.26296553e-02 -4.11852775e-02  8.44523311e-02]
 [-9.41379860e-02 -9.18278305e-02  1.25649949e-01]
 [ 3.23889437e-02  1.42774641e-01 -1.65150072e-02]
 [-1.13399626e-01 -6.59696356e-03 -3.95476207e-02]
 [-6.01127101e-02  1.25895012e-01  1.27827498e-01]
 [ 1.98633965e-01 -1.68916655e-01 -8.58820037e-02]
 [-1.09941487e-02  1.63721150e-01  8.05007078e-02]
 [ 3.70634583e-02  3.62367905e-02 -4.04626475e-02]
 [-3.58384096e-02  7.93955090e-02 -8.81300747e-03]
 [-8.84441839e-02 -2.07183004e-01  5.86031913e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.26552719]
curr_Stock_Price:  99.9829695633174
curr_Factors:  [99.98296956 -0.98020218 -0.982337  ]
mat_Sqrt:  [[14.04772816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00990024 -0.00385787  0.19002862]
Stock Position:  -0.00990024460516157
Bond Position:  [3.25538305]


portfolio before change:  [2.25225141]
curr_Stock_Price:  101.36502981243432
curr_Factors:  [101.36502981  -1.2139742   -0.97814479]
mat_Sqrt:  [[11.32043116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260526 -0.00665945 -0.24812479]
Stock Position:  -0.002605264175160689
Bond Position:  [2.51633409]


portfolio before change:  [2.25351301]
curr_Stock_Price:  101.00151858723467
curr_Factors:  [101.00151859  -0.9671842   -0.99015322]
mat_Sqrt:  [[14.26484519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01932944 -0.00352634 -0.26664363]
Stock Position:  0.019329444919493788
Bond Position:  [0.30120972]


portfolio before change:  [2.26057461]
curr_Stock_Price:  101.36489922856259
curr_Factors:  [101.36489923  -0.834361    -1.01657403]
mat_Sqrt:  [[15.92343366  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00123736 -0.00659539  0.21422481]
Stock Position:  0.0012373621367653856
Bond Position:  [2.13514952]


portfolio before change:  [2.2612266]
curr_Stock_Price:  101.67610932500534
curr_Factors:  [101.67610933  -0.86142745  -1.02093251]
mat_Sqrt:  [[15.47819729  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05679297 -0.08147017  0.03622605]
Stock Position:  -0.05679296687927657
Bond Position:  [8.03571451]


portfolio before change:  [2.23913818]
curr_Stock_Price:  102.08272567614378
curr_Factors:  [102.08272568  -1.15468076  -1.00708952]
mat_Sqrt:  [[11.75188008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00544931  0.01179484  0.22709553]
Stock Position:  -0.005449307784857815
Bond Position:  [2.79541837]


portfolio before change:  [2.23628138]
curr_Stock_Price:  102.67110264058508
curr_Factors:  [102.67110264  -1.09030145  -1.00046482]
mat_Sqrt:  [[12.68936737  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00186652 0.05520495 0.27303197]
Stock Position:  0.0018665197799590597
Bond Position:  [2.04464374]


portfolio before change:  [2.23896892]
curr_Stock_Price:  103.97402918108122
curr_Factors:  [103.97402918  -1.32150263  -0.99446418]
mat_Sqrt:  [[10.25919464  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0342441  -0.01016154 -0.27590662]
Stock Position:  0.03424409512123835
Bond Position:  [-1.32152763]


portfolio before change:  [2.22834978]
curr_Stock_Price:  103.66875212937524
curr_Factors:  [103.66875213  -1.27095451  -1.00250034]
mat_Sqrt:  [[10.67330637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05744938 -0.00946982 -0.26065864]
Stock Position:  -0.05744937916808577
Bond Position:  [8.18405523]


portfolio before change:  [2.2637624]
curr_Stock_Price:  103.07014605495455
curr_Factors:  [103.07014605  -1.04748989  -0.99932028]
mat_Sqrt:  [[13.31111785  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00043241  0.01669714 -0.02441973]
Stock Position:  0.0004324054401125001
Bond Position:  [2.21919431]


portfolio before change:  [2.26342492]
curr_Stock_Price:  101.64811889091573
curr_Factors:  [101.64811889  -1.00442996  -0.99908052]
mat_Sqrt:  [[13.70836936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00145625 -0.0795537   0.36538677]
Stock Position:  0.0014562539510222655
Bond Position:  [2.11539945]


portfolio before change:  [2.26389811]
curr_Stock_Price:  101.79146519972936
curr_Factors:  [101.7914652   -1.05609231  -0.98777681]
mat_Sqrt:  [[13.18470092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0054704   0.00225658  0.15019092]
Stock Position:  -0.005470402326701398
Bond Position:  [2.82073838]


portfolio before change:  [2.26605578]
curr_Stock_Price:  101.46149776376804
curr_Factors:  [101.46149776  -1.17937935  -0.97503158]
mat_Sqrt:  [[11.76664064  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0169215  -0.01639708  0.84707245]
Stock Position:  0.016921503694867543
Bond Position:  [0.54917467]


portfolio before change:  [2.27288817]
curr_Stock_Price:  101.86121056321693
curr_Factors:  [101.86121056  -1.28125699  -0.96855604]
mat_Sqrt:  [[10.73810011  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00923871 0.09343797 0.71338137]
Stock Position:  0.009238706235512314
Bond Position:  [1.33182237]


portfolio before change:  [2.28004267]
curr_Stock_Price:  102.61759466002427
curr_Factors:  [102.61759466  -1.45298832  -0.96710933]
mat_Sqrt:  [[ 9.12403153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00470473 -0.03587186 -0.12433753]
Stock Position:  0.004704733153651653
Bond Position:  [1.79725427]


portfolio before change:  [2.28100952]
curr_Stock_Price:  102.77534605305236
curr_Factors:  [102.77534605  -1.39201621  -0.99975783]
mat_Sqrt:  [[ 9.40058073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083229 -0.00315229  0.10218283]
Stock Position:  -0.0008322923693202521
Bond Position:  [2.36654866]


portfolio before change:  [2.28116626]
curr_Stock_Price:  102.94247447290078
curr_Factors:  [102.94247447  -1.44489201  -1.02706527]
mat_Sqrt:  [[ 8.69034862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06190562 -0.08454412  0.46917656]
Stock Position:  -0.06190562328674971
Bond Position:  [8.6538843]


portfolio before change:  [2.30419048]
curr_Stock_Price:  102.58802491907647
curr_Factors:  [102.58802492  -1.26695409  -1.03241578]
mat_Sqrt:  [[10.29183994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01275876  0.00580111 -0.05715682]
Stock Position:  -0.01275875689533811
Bond Position:  [3.61308615]


portfolio before change:  [2.29929266]
curr_Stock_Price:  103.0073048053223
curr_Factors:  [103.00730481  -1.24576248  -1.03339536]
mat_Sqrt:  [[10.54489715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03342649 0.31426402 1.12378749]
Stock Position:  0.03342648954836736
Bond Position:  [-1.14387994]


portfolio before change:  [2.30125468]
curr_Stock_Price:  103.07027939838102
curr_Factors:  [103.0702794   -1.14820676  -1.02993713]
mat_Sqrt:  [[11.67286822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035984  0.01002822  0.07854335]
Stock Position:  -0.00035983911625773736
Bond Position:  [2.3383434]


portfolio before change:  [2.30147321]
curr_Stock_Price:  103.27532849890281
curr_Factors:  [103.2753285   -1.17701178  -1.03782468]
mat_Sqrt:  [[11.27470876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117189 -0.04704355  0.13156396]
Stock Position:  0.0011718917487025067
Bond Position:  [2.1804457]


portfolio before change:  [2.30237911]
curr_Stock_Price:  103.81576504726345
curr_Factors:  [103.81576505  -1.15261926  -1.04318328]
mat_Sqrt:  [[11.55149999  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00336483  0.01916992 -0.08961985]
Stock Position:  -0.003364832595766711
Bond Position:  [2.65170178]


portfolio before change:  [2.30409141]
curr_Stock_Price:  103.40540047535265
curr_Factors:  [103.40540048  -1.04164377  -1.02946389]
mat_Sqrt:  [[13.03384622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01453268 -0.0089684   0.46452816]
Stock Position:  0.014532677198029375
Bond Position:  [0.8013341]


portfolio before change:  [2.31371018]
curr_Stock_Price:  104.06037961410225
curr_Factors:  [104.06037961  -0.85217796  -1.04376033]
mat_Sqrt:  [[15.62751303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00374146 -0.05302901 -0.23491333]
Stock Position:  0.003741460037471894
Bond Position:  [1.92437243]


portfolio before change:  [2.3182214]
curr_Stock_Price:  105.20182026446132
curr_Factors:  [105.20182026  -1.00338677  -1.07174024]
mat_Sqrt:  [[13.20708725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00585568  0.07116925  0.53275587]
Stock Position:  -0.005855684334636566
Bond Position:  [2.93425005]


portfolio before change:  [2.31845869]
curr_Stock_Price:  105.22393771609862
curr_Factors:  [105.22393772  -1.1763475   -1.06890444]
mat_Sqrt:  [[11.1433051   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0017031  0.01954756 0.05630885]
Stock Position:  0.0017031020378826774
Bond Position:  [2.13925158]


portfolio before change:  [2.3181657]
curr_Stock_Price:  104.89488785200581
curr_Factors:  [104.89488785  -1.03972503  -1.04524467]
mat_Sqrt:  [[13.03957656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460628 -0.03397578  0.51013081]
Stock Position:  -0.004606284257980426
Bond Position:  [2.80134138]


portfolio before change:  [2.32126391]
curr_Stock_Price:  104.29830791873738
curr_Factors:  [104.29830792  -0.80091537  -1.04656091]
mat_Sqrt:  [[16.44101058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00322963  0.02046686 -0.22357539]
Stock Position:  0.003229629624567226
Bond Position:  [1.98441901]


portfolio before change:  [2.32345033]
curr_Stock_Price:  104.8984839607636
curr_Factors:  [104.89848396  -0.95099188  -1.01591461]
mat_Sqrt:  [[14.67413718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06480574 -0.04627424 -3.12643876]
Stock Position:  -0.06480573532870827
Bond Position:  [9.12147371]


portfolio before change:  [2.2571137]
curr_Stock_Price:  105.93970176556097
curr_Factors:  [105.93970177  -1.10853807  -1.0314444 ]
mat_Sqrt:  [[12.46453751  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00292464 -0.01302393  0.24091899]
Stock Position:  -0.002924640781054119
Bond Position:  [2.56694927]


portfolio before change:  [2.25745252]
curr_Stock_Price:  105.933567359483
curr_Factors:  [105.93356736  -1.02321437  -1.00334195]
mat_Sqrt:  [[13.96083426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00507568 -0.02903851  0.35844433]
Stock Position:  -0.0050756839169924335
Bond Position:  [2.79513783]


portfolio before change:  [2.25744124]
curr_Stock_Price:  106.00463133075887
curr_Factors:  [106.00463133  -0.97941156  -0.97353879]
mat_Sqrt:  [[15.03727985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00217488  0.04514931 -0.04711272]
Stock Position:  0.002174878548656548
Bond Position:  [2.02689404]


portfolio before change:  [2.25720433]
curr_Stock_Price:  105.7791983857033
curr_Factors:  [105.77919839  -1.00692957  -0.96050309]
mat_Sqrt:  [[14.78955556  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0082249  -0.00208614 -0.11281835]
Stock Position:  -0.008224897774735238
Bond Position:  [3.12722742]


portfolio before change:  [2.26597731]
curr_Stock_Price:  104.76009111186742
curr_Factors:  [104.76009111  -0.57089894  -0.96281543]
mat_Sqrt:  [[22.60019478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136147  0.0398115   0.36465627]
Stock Position:  -0.001361467737907458
Bond Position:  [2.40860479]


portfolio before change:  [2.26778968]
curr_Stock_Price:  103.65005598036811
curr_Factors:  [103.65005598  -0.68825041  -0.97662695]
mat_Sqrt:  [[19.6120274   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00901192 -0.05341614 -0.24499745]
Stock Position:  0.009011917109832254
Bond Position:  [1.33370397]


portfolio before change:  [2.26840937]
curr_Stock_Price:  103.70031912026349
curr_Factors:  [103.70031912  -0.68571732  -0.98554441]
mat_Sqrt:  [[19.49666576  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00049574 0.05177317 0.22964611]
Stock Position:  0.0004957386838341026
Bond Position:  [2.21700111]


portfolio before change:  [2.26839939]
curr_Stock_Price:  103.12114001424328
curr_Factors:  [103.12114001  -0.55062872  -0.99570946]
mat_Sqrt:  [[21.96754715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013538   0.01145908 -0.11542867]
Stock Position:  0.0013538008904616051
Bond Position:  [2.1287939]


portfolio before change:  [2.270058]
curr_Stock_Price:  104.14972262301104
curr_Factors:  [104.14972262  -0.52916827  -1.02905071]
mat_Sqrt:  [[21.92462705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162317  0.02510706 -0.02514106]
Stock Position:  -0.0016231689533907486
Bond Position:  [2.4391106]


portfolio before change:  [2.2699456]
curr_Stock_Price:  104.40682229968192
curr_Factors:  [104.4068223   -0.47011089  -1.03914147]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.2699456]
Stock Price:  102.61353693114054
PL:  [-0.34359133]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-8.94735500e-02 -5.59481395e-03  8.60128942e-03]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.49859800e-01  3.05652516e-01  4.36952150e-01]
 [-7.54578998e-03 -5.03588561e-02  9.89698605e-02]
 [ 1.07544429e-01 -7.78814815e-02  1.11209634e-01]
 [ 1.85058692e-01 -3.95171678e-01 -5.55598276e-01]
 [-4.87534333e-03 -5.98554614e-01 -9.67601497e-02]
 [-6.75480488e-03  1.21751993e-01  3.04978046e-02]
 [ 1.13456194e-01  5.46693989e-02 -1.54134923e-02]
 [ 2.10739566e-01  1.74525486e-01  7.56999845e-01]
 [ 3.77056771e-01 -1.63305473e-01 -1.47378244e-01]
 [-5.29256061e-01 -3.10027177e-01 -6.79186095e-01]
 [ 2.40126504e-01 -5.44253823e-01 -2.37654216e-01]
 [-1.19065840e-01 -2.62829963e-01 -1.31934208e-01]
 [-5.09965399e-01  1.09426063e+00  7.46402776e-01]
 [ 2.63255892e-01 -1.00862040e+00 -3.25836975e-01]
 [ 1.50693238e-01 -2.06134324e-01 -1.13123395e-01]
 [-2.66449045e-01 -2.24495564e-01 -1.20123291e-01]
 [ 4.24368032e-02  1.16553537e+00 -9.34806814e-02]
 [-5.61979849e-01 -1.06908571e-01  3.96608296e-01]
 [-1.12730294e-01 -3.81391952e-02  4.57899373e-03]
 [ 3.38279292e-01 -1.03805913e-01  1.66414299e-01]
 [ 6.58342392e-02  2.09873378e-01 -8.31266321e-02]
 [-3.40583618e-01 -3.87048239e-02 -1.99773589e-01]
 [-1.26614761e-01  1.39144280e-01  1.50336711e-01]
 [-1.83057671e-02 -2.90871056e-01 -4.70338358e-01]
 [ 1.68694689e-01  9.61474975e-02  5.64120056e-02]
 [-2.21605056e-01  3.49320428e-02  2.21907957e-01]
 [-2.03395540e-01 -2.56610457e-01 -4.66349129e-01]
 [ 3.99930782e-01 -3.16650169e-01 -2.08063653e-01]
 [ 1.43078427e-01  1.01612274e-02 -3.08243497e-02]
 [ 4.38944748e-02  2.46173853e-01 -8.23982212e-02]
 [-4.23539864e-02  5.42454308e-02 -2.70609409e-02]
 [ 1.88649490e-02  1.32145013e-01  9.43017677e-02]
 [-3.42361179e-01  1.05416680e-01 -7.24593987e-02]
 [-2.18186454e-01 -5.74931725e-02 -4.83192607e-02]
 [ 2.98296767e-01  2.18039978e-01  6.58174932e-02]
 [-1.03544776e-01  2.31985484e-01  2.00013502e-02]
 [ 9.43935826e-04 -1.71847222e-01  4.87888634e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.14369784]
curr_Stock_Price:  100.66264491210227
curr_Factors:  [100.66264491  -1.06581146  -0.99823484]
mat_Sqrt:  [[12.77804527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00687603 -0.00176924  0.02453708]
Stock Position:  -0.006876034226339841
Bond Position:  [7.83585763]


portfolio before change:  [7.14940844]
curr_Stock_Price:  99.97459422069775
curr_Factors:  [99.97459422 -1.03120939 -1.00900495]
mat_Sqrt:  [[12.99678159  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00349171  0.01411938  0.0859571 ]
Stock Position:  -0.00349171389272356
Bond Position:  [7.49849112]


portfolio before change:  [7.15331152]
curr_Stock_Price:  99.1252373643868
curr_Factors:  [99.12523736 -0.83714749 -1.00856826]
mat_Sqrt:  [[15.65308982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02216458 0.09665581 1.24650286]
Stock Position:  0.022164582355991395
Bond Position:  [4.95624203]


portfolio before change:  [7.12345672]
curr_Stock_Price:  97.75032439898654
curr_Factors:  [97.7503244  -0.62512631 -1.02315245]
mat_Sqrt:  [[18.80528149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060388 -0.01592487  0.28233346]
Stock Position:  0.000603877593196357
Bond Position:  [7.06442749]


portfolio before change:  [7.12388776]
curr_Stock_Price:  97.0017229541542
curr_Factors:  [97.00172295 -0.42321776 -1.01241657]
mat_Sqrt:  [[23.08295379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00555536 -0.02462829  0.31725013]
Stock Position:  0.005555359611286166
Bond Position:  [6.58500831]


portfolio before change:  [7.11173208]
curr_Stock_Price:  94.66544555773913
curr_Factors:  [94.66544556 -0.53092143 -0.99884733]
mat_Sqrt:  [[20.50318614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00299682 -0.12496426 -1.58496723]
Stock Position:  0.0029968210386212752
Bond Position:  [6.82803668]


portfolio before change:  [7.11213785]
curr_Stock_Price:  94.51602346835641
curr_Factors:  [94.51602347 -0.48948629 -1.01628862]
mat_Sqrt:  [[20.96793734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191154 -0.18927959 -0.27602977]
Stock Position:  -0.00191153947224199
Bond Position:  [7.29280896]


portfolio before change:  [7.11639401]
curr_Stock_Price:  92.76638572409952
curr_Factors:  [92.76638572 -0.31416563 -1.01235878]
mat_Sqrt:  [[24.62001999  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00010618 0.03850136 0.08700175]
Stock Position:  0.0001061801068215445
Bond Position:  [7.10654406]


portfolio before change:  [7.11719015]
curr_Stock_Price:  91.89772396316307
curr_Factors:  [91.89772396 -0.3622864  -1.02260499]
mat_Sqrt:  [[23.00668598  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00485604  0.01728798 -0.0439704 ]
Stock Position:  0.004856044301199998
Bond Position:  [6.67093073]


portfolio before change:  [7.12295298]
curr_Stock_Price:  92.91273009911984
curr_Factors:  [92.9127301  -0.36016333 -1.0553517 ]
mat_Sqrt:  [[22.55926022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01639095 0.0551898  2.15950985]
Stock Position:  0.01639095152907163
Bond Position:  [5.60002492]


portfolio before change:  [7.11802511]
curr_Stock_Price:  92.5693748864508
curr_Factors:  [92.56937489 -0.49006113 -1.05343223]
mat_Sqrt:  [[19.77591925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01733203 -0.05164172 -0.42042911]
Stock Position:  0.01733202789974311
Bond Position:  [5.51361012]


portfolio before change:  [7.10101694]
curr_Stock_Price:  91.54829360447945
curr_Factors:  [91.5482936  -0.48231532 -1.05037416]
mat_Sqrt:  [[19.77022765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03418773 -0.0980392  -1.93752888]
Stock Position:  -0.03418773024401
Bond Position:  [10.23084531]


portfolio before change:  [7.13876926]
curr_Stock_Price:  90.48143780468492
curr_Factors:  [90.4814378 -0.3141729 -1.0323364]
mat_Sqrt:  [[23.5384539   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00754353 -0.17210817 -0.67796133]
Stock Position:  0.0075435271924668605
Bond Position:  [6.45622007]


portfolio before change:  [7.13475931]
curr_Stock_Price:  89.84287361103388
curr_Factors:  [89.84287361 -0.50611089 -0.99822939]
mat_Sqrt:  [[19.95983515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00765452 -0.08311413 -0.37637157]
Stock Position:  -0.007654524056534248
Bond Position:  [7.82246375]


portfolio before change:  [7.1460186]
curr_Stock_Price:  88.49969137060378
curr_Factors:  [88.49969137 -0.41295611 -1.00873062]
mat_Sqrt:  [[21.35556436  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01542235  0.3460356   2.12927936]
Stock Position:  -0.015422345042314815
Bond Position:  [8.51089137]


portfolio before change:  [7.14971241]
curr_Stock_Price:  88.32916716174512
curr_Factors:  [88.32916716 -0.28168586 -0.99546195]
mat_Sqrt:  [[24.62894953  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00693096 -0.31895377 -0.92952219]
Stock Position:  0.00693095867445331
Bond Position:  [6.5375066]


portfolio before change:  [7.16065947]
curr_Stock_Price:  89.79070011020958
curr_Factors:  [89.79070011 -0.49339144 -1.03544204]
mat_Sqrt:  [[19.46558285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00628184 -0.0651854  -0.32270956]
Stock Position:  0.006281838938237251
Bond Position:  [6.59660876]


portfolio before change:  [7.15398944]
curr_Stock_Price:  88.59763285523344
curr_Factors:  [88.59763286 -0.47555546 -1.05621215]
mat_Sqrt:  [[19.15066677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01549636 -0.07099173 -0.34267831]
Stock Position:  -0.015496356495922887
Bond Position:  [8.52692995]


portfolio before change:  [7.14064175]
curr_Stock_Price:  89.52776296538143
curr_Factors:  [89.52776297 -0.67518907 -1.06473575]
mat_Sqrt:  [[15.71513035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00340113  0.36857465 -0.26667436]
Stock Position:  0.0034011256543482428
Bond Position:  [6.83614658]


portfolio before change:  [7.14494429]
curr_Stock_Price:  90.5415360749922
curr_Factors:  [90.54153607 -0.62131647 -1.07904025]
mat_Sqrt:  [[16.53454763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02925891 -0.03380746  1.13141307]
Stock Position:  -0.02925891278889219
Bond Position:  [9.7940912]


portfolio before change:  [7.15698219]
curr_Stock_Price:  90.17195416848476
curr_Factors:  [90.17195417 -0.52667928 -1.07670527]
mat_Sqrt:  [[18.14389077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00621589 -0.01206067  0.01306259]
Stock Position:  -0.006215886197282048
Bond Position:  [7.7174808]


portfolio before change:  [7.15905266]
curr_Stock_Price:  89.99406728380268
curr_Factors:  [89.99406728 -0.43110871 -1.09928651]
mat_Sqrt:  [[19.47922549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01897243 -0.03282631  0.47473368]
Stock Position:  0.018972428454183777
Bond Position:  [5.45164666]


portfolio before change:  [7.15323868]
curr_Stock_Price:  89.65170327296454
curr_Factors:  [89.65170327 -0.519635   -1.08319336]
mat_Sqrt:  [[18.04924456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0030076   0.06636779 -0.23713714]
Stock Position:  0.0030076047540841776
Bond Position:  [6.8836018]


portfolio before change:  [7.14971005]
curr_Stock_Price:  88.19235573143001
curr_Factors:  [88.19235573 -0.44536589 -1.10182484]
mat_Sqrt:  [[18.77130863  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02036947 -0.01223954 -0.56989844]
Stock Position:  -0.02036946881064572
Bond Position:  [8.94614149]


portfolio before change:  [7.12660665]
curr_Stock_Price:  89.38147520731141
curr_Factors:  [89.38147521 -0.46536929 -1.10284644]
mat_Sqrt:  [[18.62859406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00495661  0.04400128  0.42886879]
Stock Position:  -0.0049566123003043265
Bond Position:  [7.56963597]


portfolio before change:  [7.12369856]
curr_Stock_Price:  90.1590955091996
curr_Factors:  [90.15909551 -0.45714918 -1.12052682]
mat_Sqrt:  [[18.61373677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00654481 -0.0919815  -1.34174442]
Stock Position:  -0.006544813773055388
Bond Position:  [7.71377305]


portfolio before change:  [7.1254371]
curr_Stock_Price:  90.0407930415214
curr_Factors:  [90.04079304 -0.29745354 -1.12358387]
mat_Sqrt:  [[21.74155513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00840291 0.03040451 0.16092775]
Stock Position:  0.00840290668031144
Bond Position:  [6.36883272]


portfolio before change:  [7.14212276]
curr_Stock_Price:  91.93174631204064
curr_Factors:  [ 9.19317463e+01 -6.12223841e-02 -1.13625398e+00]
mat_Sqrt:  [[27.75927577  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00631884  0.01104648  0.63304163]
Stock Position:  -0.00631883711571252
Bond Position:  [7.72302449]


portfolio before change:  [7.1560816]
curr_Stock_Price:  89.8754502566394
curr_Factors:  [ 8.98754503e+01 -6.03147735e-02 -1.11795703e+00]
mat_Sqrt:  [[27.66458345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01103267 -0.08114735 -1.33036426]
Stock Position:  -0.011032673274023257
Bond Position:  [8.14764808]


portfolio before change:  [7.15535048]
curr_Stock_Price:  90.03403726975668
curr_Factors:  [ 9.00340373e+01  3.86460697e-02 -1.12520030e+00]
mat_Sqrt:  [[30.37541492  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01149891 -0.10013358 -0.59354769]
Stock Position:  0.011498907747931891
Bond Position:  [6.12005739]


portfolio before change:  [7.17204365]
curr_Stock_Price:  91.41922183013301
curr_Factors:  [91.41922183 -0.17723589 -1.11981644]
mat_Sqrt:  [[24.98819306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00548454  0.00321326 -0.08793329]
Stock Position:  0.005484542020176713
Bond Position:  [6.67065108]


portfolio before change:  [7.17820765]
curr_Stock_Price:  92.39106595228797
curr_Factors:  [92.39106595 -0.36431204 -1.1408895 ]
mat_Sqrt:  [[20.50828066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00163013  0.07784701 -0.23505919]
Stock Position:  0.0016301312826273306
Bond Position:  [7.02759808]


portfolio before change:  [7.1795481]
curr_Stock_Price:  92.67444418653936
curr_Factors:  [92.67444419 -0.42734392 -1.15848574]
mat_Sqrt:  [[18.97767138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244904  0.01715391 -0.07719733]
Stock Position:  -0.0024490447702004625
Bond Position:  [7.40651196]


portfolio before change:  [7.18275925]
curr_Stock_Price:  91.7413115644785
curr_Factors:  [91.74131156 -0.34653249 -1.15564756]
mat_Sqrt:  [[20.42567603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00203304 0.04178792 0.26901669]
Stock Position:  0.0020330385262213304
Bond Position:  [6.99624563]


portfolio before change:  [7.18239112]
curr_Stock_Price:  91.13004824297577
curr_Factors:  [91.13004824 -0.35437863 -1.16954786]
mat_Sqrt:  [[19.85311857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01785261  0.03333568 -0.2067065 ]
Stock Position:  -0.017852613116851976
Bond Position:  [8.80930061]


portfolio before change:  [7.18043649]
curr_Stock_Price:  91.30121962312523
curr_Factors:  [91.30121962 -0.63931147 -1.17622292]
mat_Sqrt:  [[14.85935686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01544711 -0.01818094 -0.1378414 ]
Stock Position:  -0.01544710522822192
Bond Position:  [8.59077604]


portfolio before change:  [7.1800069]
curr_Stock_Price:  91.39855225162647
curr_Factors:  [91.39855225 -0.38183479 -1.18808516]
mat_Sqrt:  [[19.01655079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0166887  0.0689503  0.18775899]
Stock Position:  0.016688698067624436
Bond Position:  [5.65468406]


portfolio before change:  [7.18017153]
curr_Stock_Price:  91.36606045480107
curr_Factors:  [91.36606045 -0.48120424 -1.21413314]
mat_Sqrt:  [[16.76907979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00557408  0.07336025  0.05705828]
Stock Position:  -0.005574079144427811
Bond Position:  [7.68945318]


portfolio before change:  [7.18747458]
curr_Stock_Price:  90.22832902482779
curr_Factors:  [90.22832902 -0.29334557 -1.21862055]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.18747458]
Stock Price:  90.9924009630784
PL:  [7.18747458]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.88856749e-01  9.36868490e-03  1.20804085e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.83736777e-01  3.98983302e-01  5.68588290e-01]
 [ 9.50034016e-03  2.11414141e-02  1.30650124e-01]
 [-1.80207727e-01 -6.41948974e-02  4.82497764e-02]
 [ 3.01579200e-02 -1.61784912e-01 -2.13167418e-01]
 [ 3.45582536e-02 -1.02386154e-01 -1.42183492e-02]
 [ 1.91923352e-01  1.65009624e-02 -3.38009081e-02]
 [-2.49979605e-01  5.85018494e-03 -8.91532318e-02]
 [ 5.94457914e-02 -3.48046506e-02 -6.19994795e-02]
 [ 3.94456761e-02 -3.07676581e-01  7.05701604e-02]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.94579760e-01 -1.33280705e-01  2.17333858e-01]
 [ 6.84148255e-02  1.19713377e-01  7.58848135e-02]
 [ 8.82080804e-02 -1.12812519e-01 -5.86793100e-02]
 [-3.57532161e-02  4.19899295e-02  4.38886710e-02]
 [-5.18387561e-01 -2.69165390e-01  1.47131575e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 3.21182583e-01  1.24232196e+00  5.39644990e-01]
 [ 7.20377009e-04  2.03508011e-02  2.92249588e-02]
 [-3.04591241e-02 -1.44902449e-01 -1.85504213e-04]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.15333445e-01 -3.08200756e-02  1.31224950e-01]
 [ 7.95217077e-02 -7.54411923e-02 -5.06013627e-02]
 [-6.54616849e-02 -1.04487385e-01  1.28518130e-01]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [-6.71222455e-02 -7.76055085e-03  2.85362414e-02]
 [ 2.78322369e-02  4.82294791e-02 -8.41575279e-02]
 [-6.72826489e-01 -7.35739445e-02 -1.03002693e+00]
 [-1.92722021e-01 -3.44457159e-03  1.60468946e-02]
 [-2.82214776e-02  6.77945174e-02  1.86180740e-01]
 [ 2.06107605e-02  1.00626720e-01 -1.29603300e-02]
 [-1.36453876e-01 -1.69704838e-02 -1.33439103e-01]
 [-6.31223208e-02  5.47229433e-02  8.32195193e-02]
 [ 7.25001474e-02 -6.23691295e-02  1.12937874e-02]
 [-2.69293412e-02 -4.14633646e-02  5.77052259e-02]
 [ 1.20705182e-02  1.02831031e-02 -4.32950118e-02]
 [-8.80558718e-02  1.28005779e-01 -1.41665991e-03]
 [-1.52606809e-02 -2.69217902e-01  8.61955223e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.47869447]
curr_Stock_Price:  99.87334018728656
curr_Factors:  [99.87334019 -0.86247843 -0.98336442]
mat_Sqrt:  [[15.76922001  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01039721  0.00296264  0.34462043]
Stock Position:  -0.010397205422062863
Bond Position:  [2.51709811]


portfolio before change:  [1.48093685]
curr_Stock_Price:  99.68793270547317
curr_Factors:  [99.68793271 -0.74410576 -0.98672365]
mat_Sqrt:  [[17.65846416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00256993  0.01411938  0.0859571 ]
Stock Position:  -0.002569931474906249
Bond Position:  [1.73712801]


portfolio before change:  [1.48479766]
curr_Stock_Price:  98.27013123956367
curr_Factors:  [98.27013124 -0.58300159 -0.95728302]
mat_Sqrt:  [[21.06126386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01947182 0.1261696  1.62202413]
Stock Position:  0.01947181720570861
Bond Position:  [-0.42870037]


portfolio before change:  [1.48255534]
curr_Stock_Price:  98.15772640101488
curr_Factors:  [98.1577264  -0.50084887 -0.95463269]
mat_Sqrt:  [[22.89901933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00160335 0.0066855  0.37270844]
Stock Position:  0.0016033461258207985
Bond Position:  [1.32517453]


portfolio before change:  [1.48444947]
curr_Stock_Price:  99.23576544514796
curr_Factors:  [99.23576545 -0.45488714 -0.95643712]
mat_Sqrt:  [[24.19568292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00710938 -0.02030021  0.13764318]
Stock Position:  -0.007109379327234433
Bond Position:  [2.18995417]


portfolio before change:  [1.48638476]
curr_Stock_Price:  99.0020556147191
curr_Factors:  [99.00205561 -0.47068721 -0.96985756]
mat_Sqrt:  [[23.44356038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00074784 -0.05116088 -0.60810731]
Stock Position:  -0.0007478371557475215
Bond Position:  [1.56042218]


portfolio before change:  [1.4864878]
curr_Stock_Price:  99.12511685393078
curr_Factors:  [99.12511685 -0.42226298 -0.9727648 ]
mat_Sqrt:  [[24.56579625  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118101 -0.03237734 -0.04056099]
Stock Position:  0.0011810057286879365
Bond Position:  [1.36942047]


portfolio before change:  [1.48737101]
curr_Stock_Price:  99.72801692117235
curr_Factors:  [99.72801692 -0.60803834 -0.98705922]
mat_Sqrt:  [[20.23369102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0091654   0.00521806 -0.09642458]
Stock Position:  0.009165397632661575
Bond Position:  [0.57332408]


portfolio before change:  [1.47890877]
curr_Stock_Price:  98.7969157569823
curr_Factors:  [98.79691576 -0.64628687 -0.96705952]
mat_Sqrt:  [[19.6823048   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01361766  0.00184999 -0.25432935]
Stock Position:  -0.013617657262541955
Bond Position:  [2.82429131]


portfolio before change:  [1.4696547]
curr_Stock_Price:  99.50240630357197
curr_Factors:  [99.5024063  -0.72650865 -0.97462356]
mat_Sqrt:  [[18.15688114  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0025275  -0.0110062  -0.17686726]
Stock Position:  0.002527501725263103
Bond Position:  [1.2181622]


portfolio before change:  [1.47050091]
curr_Stock_Price:  99.77695955205469
curr_Factors:  [99.77695955 -0.82341444 -0.96969883]
mat_Sqrt:  [[16.60699546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00276429 -0.09729588  0.20131702]
Stock Position:  0.002764291393039461
Bond Position:  [1.19468832]


portfolio before change:  [1.47360118]
curr_Stock_Price:  100.84447341389539
curr_Factors:  [100.84447341  -1.19616314  -0.97896149]
mat_Sqrt:  [[11.4553267   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00629625  0.00225658  0.15019092]
Stock Position:  -0.006296251558914699
Bond Position:  [2.10854335]


portfolio before change:  [1.47777094]
curr_Stock_Price:  100.22407664336028
curr_Factors:  [100.22407664  -1.28419331  -0.97135722]
mat_Sqrt:  [[10.50506915  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0224179  -0.04214706  0.619993  ]
Stock Position:  0.022417896699982946
Bond Position:  [-0.76904206]


portfolio before change:  [1.48504516]
curr_Stock_Price:  100.55284787799029
curr_Factors:  [100.55284788  -1.2758626   -0.99313677]
mat_Sqrt:  [[10.39873396  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00836599 0.03785669 0.21647825]
Stock Position:  0.008365992883391418
Bond Position:  [0.64382075]


portfolio before change:  [1.48623203]
curr_Stock_Price:  100.68509639945303
curr_Factors:  [100.6850964   -1.27399964  -0.99925599]
mat_Sqrt:  [[10.36818679  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00707138 -0.03567445 -0.16739574]
Stock Position:  0.0070713820215728826
Bond Position:  [0.77424925]


portfolio before change:  [1.48749027]
curr_Stock_Price:  100.84934267405356
curr_Factors:  [100.84934267  -1.44484845  -1.01032323]
mat_Sqrt:  [[ 8.65776029  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296963  0.01327838  0.12520216]
Stock Position:  -0.00296962522669194
Bond Position:  [1.78697502]


portfolio before change:  [1.48681678]
curr_Stock_Price:  101.15135912204319
curr_Factors:  [101.15135912  -1.34504157  -1.00350879]
mat_Sqrt:  [[ 9.66071478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05126994 -0.08511757  0.41972543]
Stock Position:  -0.051269940777537416
Bond Position:  [6.67284097]


portfolio before change:  [1.45394337]
curr_Stock_Price:  101.80881191520152
curr_Factors:  [101.80881192  -1.48159783  -1.02245002]
mat_Sqrt:  [[ 8.32321683  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01577648  0.00580111 -0.05715682]
Stock Position:  -0.01577648239813682
Bond Position:  [3.0601283]


portfolio before change:  [1.46012675]
curr_Stock_Price:  101.441122654036
curr_Factors:  [101.44112265  -1.39947499  -1.01258336]
mat_Sqrt:  [[ 9.09223012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05096811 0.3928567  1.53945695]
Stock Position:  0.05096810837387328
Bond Position:  [-3.71013538]


portfolio before change:  [1.46686563]
curr_Stock_Price:  101.58243985124619
curr_Factors:  [101.58243985  -1.485102    -0.98848881]
mat_Sqrt:  [[ 8.56153815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0008423  0.00643549 0.08337067]
Stock Position:  0.000842296331637781
Bond Position:  [1.38130311]


portfolio before change:  [1.46743677]
curr_Stock_Price:  102.05551483175844
curr_Factors:  [102.05551483  -1.23224336  -0.99686915]
mat_Sqrt:  [[10.98361286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311722 -0.04582218 -0.00052919]
Stock Position:  -0.00311722158634263
Bond Position:  [1.78556642]


portfolio before change:  [1.46699075]
curr_Stock_Price:  102.27020279735582
curr_Factors:  [102.2702028   -1.09501469  -1.00459732]
mat_Sqrt:  [[12.52850377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310243  0.01916992 -0.08961985]
Stock Position:  -0.003102434607469939
Bond Position:  [1.78427737]


portfolio before change:  [1.46597893]
curr_Stock_Price:  102.6682362722578
curr_Factors:  [102.66823627  -1.12045841  -0.97714347]
mat_Sqrt:  [[12.60257178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01121389 -0.00974616  0.37434826]
Stock Position:  0.01121389012831276
Bond Position:  [0.31466861]


portfolio before change:  [1.4698132]
curr_Stock_Price:  103.00665002965033
curr_Factors:  [103.00665003  -1.34653962  -0.97221793]
mat_Sqrt:  [[10.13541769  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00663464 -0.0238566  -0.1443516 ]
Stock Position:  0.0066346416713119714
Bond Position:  [0.78640098]


portfolio before change:  [1.46558341]
curr_Stock_Price:  102.35430175763989
curr_Factors:  [102.35430176  -1.28372361  -0.96771772]
mat_Sqrt:  [[10.77252608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389193 -0.03304181  0.36662645]
Stock Position:  -0.003891926918186309
Bond Position:  [1.86393887]


portfolio before change:  [1.46324592]
curr_Stock_Price:  103.01476888825393
curr_Factors:  [103.01476889  -1.35256033  -0.96495831]
mat_Sqrt:  [[10.14878233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00127661  0.02004328 -0.05140267]
Stock Position:  0.0012766145221298926
Bond Position:  [1.33173577]


portfolio before change:  [1.46293081]
curr_Stock_Price:  102.63752742088933
curr_Factors:  [102.63752742  -1.31527081  -0.95754045]
mat_Sqrt:  [[10.57393881  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00581597 -0.0024541   0.08140595]
Stock Position:  -0.005815967662076977
Bond Position:  [2.05986735]


portfolio before change:  [1.46649343]
curr_Stock_Price:  102.06924395642368
curr_Factors:  [102.06924396  -1.07614545  -0.93041204]
mat_Sqrt:  [[13.72328407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00086706  0.0152515  -0.240078  ]
Stock Position:  0.0008670616466207115
Bond Position:  [1.3779931]


portfolio before change:  [1.46623536]
curr_Stock_Price:  101.5729373903095
curr_Factors:  [101.57293739  -1.02882284  -0.92029281]
mat_Sqrt:  [[14.46398097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06118506 -0.02326612 -2.93838013]
Stock Position:  -0.06118505888783662
Bond Position:  [7.68098151]


portfolio before change:  [1.4948201]
curr_Stock_Price:  101.12144547472354
curr_Factors:  [101.12144547  -1.02654801  -0.92096438]
mat_Sqrt:  [[14.42279341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01314138 -0.00108927  0.04577732]
Stock Position:  -0.013141379455208907
Bond Position:  [2.82369539]


portfolio before change:  [1.4900743]
curr_Stock_Price:  101.50944039784264
curr_Factors:  [101.5094404   -0.72693136  -0.96123859]
mat_Sqrt:  [[18.76478283  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00061461 0.02143851 0.53112183]
Stock Position:  0.0006146062956138594
Bond Position:  [1.42768595]


portfolio before change:  [1.48972969]
curr_Stock_Price:  100.6583638003015
curr_Factors:  [100.6583638   -0.48571591  -0.95446045]
mat_Sqrt:  [[23.84455478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00086239  0.03182096 -0.03697221]
Stock Position:  0.0008623945845569316
Bond Position:  [1.40292246]


portfolio before change:  [1.48913065]
curr_Stock_Price:  99.76038098207583
curr_Factors:  [99.76038098 -0.54189322 -0.94948775]
mat_Sqrt:  [[22.4522348   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00731019 -0.00536654 -0.38066462]
Stock Position:  -0.007310194109541077
Bond Position:  [2.2183984]


portfolio before change:  [1.49695751]
curr_Stock_Price:  98.72763908889507
curr_Factors:  [98.72763909 -0.5417566  -0.90561746]
mat_Sqrt:  [[23.2194638   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192607  0.01730491  0.23740212]
Stock Position:  -0.001926068043315175
Bond Position:  [1.68711366]


portfolio before change:  [1.49536332]
curr_Stock_Price:  99.66483180489702
curr_Factors:  [99.6648318  -0.56847835 -0.90686423]
mat_Sqrt:  [[22.79338339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00321124 -0.01972285  0.03221803]
Stock Position:  0.003211244106779027
Bond Position:  [1.17531521]


portfolio before change:  [1.49300365]
curr_Stock_Price:  98.88426491049572
curr_Factors:  [98.88426491 -0.47717083 -0.88151036]
mat_Sqrt:  [[25.4132052   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063829 -0.01311187  0.16461695]
Stock Position:  -0.0006382859079446278
Bond Position:  [1.55612008]


portfolio before change:  [1.49224896]
curr_Stock_Price:  100.37139796886312
curr_Factors:  [100.37139797  -0.23184477  -0.88934552]
mat_Sqrt:  [[32.71020151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.06953467e-04  3.25180272e-03 -1.23508618e-01]
Stock Position:  0.0001069534667259417
Bond Position:  [1.48151389]


portfolio before change:  [1.4922458]
curr_Stock_Price:  98.61023274658017
curr_Factors:  [ 9.86102327e+01 -7.48841165e-02 -9.12016051e-01]
mat_Sqrt:  [[36.75502199  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023137   0.04047898 -0.00404134]
Stock Position:  -0.0023136961070777565
Bond Position:  [1.72039991]


portfolio before change:  [1.49010801]
curr_Stock_Price:  99.62715707909192
curr_Factors:  [ 9.96271571e+01  1.62673328e-02 -9.38885559e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.49010801]
Stock Price:  100.49336935573697
PL:  [0.99673865]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.06749321e-01  4.91171156e-02  7.05255970e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.51547747e-01  3.53357174e-01  5.13627279e-01]
 [-1.50420654e-02  2.60972596e-02  1.19759159e-01]
 [-5.96700105e-01 -1.82171235e-01  3.80717726e-02]
 [-4.64925106e-02 -1.51888010e-02  8.70403525e-03]
 [ 2.20738388e-02  9.79525829e-02  2.57359133e-02]
 [ 2.80554408e-01 -9.51620973e-02 -5.60095217e-02]
 [-5.18532641e-01 -2.71062505e-02 -6.98657875e-02]
 [ 2.97249935e-02  1.27323091e-02 -2.73360957e-02]
 [ 9.06967111e-03 -2.73126722e-01  1.44100317e-01]
 [-2.12035901e-01  3.35064595e-02  1.79299681e-01]
 [ 3.51313048e-02  6.26752233e-02  1.81629595e-01]
 [ 7.51271545e-03  5.20803366e-01  4.74799185e-01]
 [ 1.02070235e-01 -1.23791846e-01 -5.53840817e-02]
 [-1.20068668e-02 -1.71153738e-02  3.47094767e-02]
 [-5.75900176e-01 -6.54168359e-02  2.01489400e-01]
 [-1.13716934e-01  1.92528158e-02 -3.16735239e-02]
 [ 8.92037996e-03  5.43595166e-01  3.68250922e-02]
 [-3.11559400e-02  5.38585896e-02  2.45818907e-02]
 [ 1.25798453e-01 -1.65762850e-01  1.91371990e-01]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 2.69664601e-01  1.65790328e-02  2.44888675e-01]
 [ 6.61416138e-02 -1.58107798e-01 -5.27298844e-02]
 [-1.21257912e-01  2.28258358e-01  1.96355906e-01]
 [ 1.21821829e-02  6.06987957e-02  4.66183166e-02]
 [-1.31154197e-01 -1.29471417e-01  2.59985897e-01]
 [ 8.06520287e-02  6.88301056e-02 -8.27475366e-02]
 [-7.41991167e-01 -1.49276495e-01 -1.11668756e+00]
 [-1.92798575e-02 -8.21188868e-02  1.09710893e-01]
 [-8.85125362e-02 -1.04302561e-01  1.25843958e-01]
 [ 2.20794827e-02  8.13253411e-02 -2.68772052e-03]
 [-1.20899880e-01 -9.97178765e-03 -7.00933975e-02]
 [-5.71585859e-02  1.42967391e-01  1.06671013e-01]
 [ 1.27730507e-01 -1.55635151e-01 -1.13557629e-01]
 [-2.10979521e-02  2.29265121e-01  8.26904337e-02]
 [ 6.78314277e-02  6.03603025e-02 -3.42485322e-02]
 [-1.81269140e-02  6.63814617e-02 -1.06209861e-02]
 [-1.25015621e-01 -2.52374737e-01  5.16499104e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.84576769]
curr_Stock_Price:  100.7604642807758
curr_Factors:  [100.76046428  -0.82774824  -1.03500379]
mat_Sqrt:  [[15.64253847  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00582291  0.0155322   0.2011899 ]
Stock Position:  -0.0058229133062414305
Bond Position:  [8.43248714]


portfolio before change:  [7.85156548]
curr_Stock_Price:  99.94580950376954
curr_Factors:  [99.9458095  -0.76796099 -1.01483939]
mat_Sqrt:  [[16.8075426   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270004  0.01411938  0.0859571 ]
Stock Position:  -0.002700040328576248
Bond Position:  [8.1214232]


portfolio before change:  [7.85680854]
curr_Stock_Price:  98.37997501589172
curr_Factors:  [98.37997502 -0.68999035 -1.00870761]
mat_Sqrt:  [[17.99581654  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02031112 0.11174135 1.46523566]
Stock Position:  0.020311116104635096
Bond Position:  [5.85860144]


portfolio before change:  [7.89450654]
curr_Stock_Price:  100.19994544923449
curr_Factors:  [100.19994545  -0.78573888  -1.02167505]
mat_Sqrt:  [[16.44059722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00061296 0.00825268 0.34163955]
Stock Position:  0.0006129642879981596
Bond Position:  [7.83308755]


portfolio before change:  [7.89561982]
curr_Stock_Price:  100.41868627472189
curr_Factors:  [100.41868627  -0.74443948  -0.99237656]
mat_Sqrt:  [[17.6817364   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03357319 -0.0576076   0.10860817]
Stock Position:  -0.03357319464566141
Bond Position:  [11.26699592]


portfolio before change:  [7.87258187]
curr_Stock_Price:  101.14683885312807
curr_Factors:  [101.14683885  -0.74077405  -1.0140437 ]
mat_Sqrt:  [[17.49220856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257875 -0.00480312  0.02483019]
Stock Position:  -0.0025787469818524316
Bond Position:  [8.13341398]


portfolio before change:  [7.87340625]
curr_Stock_Price:  101.22143290830326
curr_Factors:  [101.22143291  -0.9231383   -1.05436281]
mat_Sqrt:  [[14.01053319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00213099 0.03097533 0.0734174 ]
Stock Position:  0.0021309884872678653
Bond Position:  [7.65770455]


portfolio before change:  [7.87420854]
curr_Stock_Price:  101.14870245448706
curr_Factors:  [101.14870245  -0.86213452  -1.06969259]
mat_Sqrt:  [[14.65475157  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01819645 -0.0300929  -0.15977958]
Stock Position:  0.01819644885492121
Bond Position:  [6.03366135]


portfolio before change:  [7.88580061]
curr_Stock_Price:  101.7443029873
curr_Factors:  [101.74430299  -0.76112269  -1.08059214]
mat_Sqrt:  [[16.1310825   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03307241 -0.00857175 -0.19930764]
Stock Position:  -0.03307241256035933
Bond Position:  [11.25073017]


portfolio before change:  [7.87411651]
curr_Stock_Price:  102.14011710393196
curr_Factors:  [102.1401171   -0.64436512  -1.08935785]
mat_Sqrt:  [[18.04056083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013566   0.00402631 -0.07798227]
Stock Position:  0.001356597690361724
Bond Position:  [7.73555346]


portfolio before change:  [7.87510282]
curr_Stock_Price:  102.15434809009294
curr_Factors:  [102.15434809  -0.69547622  -1.10126256]
mat_Sqrt:  [[16.94115899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185536 -0.08637025  0.41107809]
Stock Position:  0.0018553585049212072
Bond Position:  [7.68556988]


portfolio before change:  [7.8799576]
curr_Stock_Price:  104.253146817879
curr_Factors:  [104.25314682  -0.76567135  -1.10685043]
mat_Sqrt:  [[16.0274082   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01089205  0.01059567  0.51149208]
Stock Position:  -0.01089205263661067
Bond Position:  [9.01548836]


portfolio before change:  [7.8735496]
curr_Stock_Price:  104.94493624937449
curr_Factors:  [104.94493625  -0.88395713  -1.08655488]
mat_Sqrt:  [[14.62779939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00504687 0.01981965 0.51813868]
Stock Position:  0.005046867002411707
Bond Position:  [7.34390646]


portfolio before change:  [7.87487803]
curr_Stock_Price:  105.02625040363664
curr_Factors:  [105.0262504   -0.65909961  -1.09414806]
mat_Sqrt:  [[18.19164922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00647977 0.16469249 1.35446992]
Stock Position:  0.006479774148701216
Bond Position:  [7.19433165]


portfolio before change:  [7.88099312]
curr_Stock_Price:  105.83117804291334
curr_Factors:  [105.83117804  -0.69875719  -1.08222636]
mat_Sqrt:  [[17.82962879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00491142 -0.03914642 -0.15799537]
Stock Position:  0.004911415512841561
Bond Position:  [7.36121223]


portfolio before change:  [7.88136362]
curr_Stock_Price:  105.71925311741215
curr_Factors:  [105.71925312  -0.76518063  -1.07814797]
mat_Sqrt:  [[16.73426518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032052 -0.00541236  0.09901648]
Stock Position:  -0.00032052447685324714
Bond Position:  [7.91524923]


portfolio before change:  [7.88189615]
curr_Stock_Price:  107.14487062400129
curr_Factors:  [107.14487062  -0.60071671  -1.10449403]
mat_Sqrt:  [[19.47187476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02755053 -0.02068662  0.57479317]
Stock Position:  -0.027550525392786043
Bond Position:  [10.83379363]


portfolio before change:  [7.84625429]
curr_Stock_Price:  108.48771834736809
curr_Factors:  [108.48771835  -0.58915991  -1.13728798]
mat_Sqrt:  [[19.30162106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00620078  0.00608827 -0.09035575]
Stock Position:  -0.006200782777407195
Bond Position:  [8.51896307]


portfolio before change:  [7.85751132]
curr_Stock_Price:  106.84404072251446
curr_Factors:  [106.84404072  -0.72644739  -1.12006267]
mat_Sqrt:  [[16.85858708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00180756 0.17189989 0.10505174]
Stock Position:  0.0018075558238885645
Bond Position:  [7.66438475]


portfolio before change:  [7.8569056]
curr_Stock_Price:  105.97888037842066
curr_Factors:  [105.97888038  -0.71675801  -1.12155951]
mat_Sqrt:  [[16.85963503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146786  0.01703158  0.07012529]
Stock Position:  -0.0014678585715671405
Bond Position:  [8.01246761]


portfolio before change:  [7.85624149]
curr_Stock_Price:  107.11368221018161
curr_Factors:  [107.11368221  -0.94206309  -1.13297059]
mat_Sqrt:  [[13.44835831  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01194065 -0.05241882  0.54593102]
Stock Position:  0.011940648450627651
Bond Position:  [6.57723467]


portfolio before change:  [7.8569894]
curr_Stock_Price:  107.10745995529383
curr_Factors:  [107.10745996  -0.8460947   -1.13018457]
mat_Sqrt:  [[14.84337085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026186   0.01916992 -0.08961985]
Stock Position:  -0.002618600861932494
Bond Position:  [8.13746109]


portfolio before change:  [7.85846951]
curr_Stock_Price:  106.93070272888887
curr_Factors:  [106.93070273  -0.88477307  -1.13349842]
mat_Sqrt:  [[14.20948204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02252583 0.00524275 0.69859923]
Stock Position:  0.02252582891484938
Bond Position:  [5.44976679]


portfolio before change:  [7.86695415]
curr_Stock_Price:  107.27712187723375
curr_Factors:  [107.27712188  -0.89854473  -1.1260512 ]
mat_Sqrt:  [[14.16564238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00362115 -0.04999808 -0.15042368]
Stock Position:  0.0036211450238379404
Bond Position:  [7.47848813]


portfolio before change:  [7.86215065]
curr_Stock_Price:  105.69243908728157
curr_Factors:  [105.69243909  -1.07065609  -1.08301172]
mat_Sqrt:  [[12.26642121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00613735  0.07218163  0.56014874]
Stock Position:  -0.0061373503973637614
Bond Position:  [8.51082218]


portfolio before change:  [7.85666972]
curr_Stock_Price:  106.75883581265416
curr_Factors:  [106.75883581  -1.16440123  -1.06148226]
mat_Sqrt:  [[11.52696344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00201834 0.01919464 0.13298908]
Stock Position:  0.0020183410147482884
Bond Position:  [7.64119398]


portfolio before change:  [7.85690238]
curr_Stock_Price:  106.40084486246765
curr_Factors:  [106.40084486  -0.90986602  -1.03461523]
mat_Sqrt:  [[15.22185574  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0053494  -0.04094246  0.7416674 ]
Stock Position:  -0.005349396102724066
Bond Position:  [8.42608265]


portfolio before change:  [7.86381589]
curr_Stock_Price:  105.30536025371812
curr_Factors:  [105.30536025  -0.74317904  -1.00856918]
mat_Sqrt:  [[18.26736436  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00358773  0.02176599 -0.23605569]
Stock Position:  0.0035877339993527512
Bond Position:  [7.48600827]


portfolio before change:  [7.86431906]
curr_Stock_Price:  105.18477102589662
curr_Factors:  [105.18477103  -0.88019377  -1.0095475 ]
mat_Sqrt:  [[15.89456543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06126549 -0.04720537 -3.18559879]
Stock Position:  -0.06126549150894685
Bond Position:  [14.30851575]


portfolio before change:  [7.81410988]
curr_Stock_Price:  106.03350091801971
curr_Factors:  [106.03350092  -0.79803531  -0.99601137]
mat_Sqrt:  [[17.6318761   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.64026322e-05 -2.59682721e-02  3.12974641e-01]
Stock Position:  5.640263215541003e-05
Bond Position:  [7.80812931]


portfolio before change:  [7.8150922]
curr_Stock_Price:  106.14431069534595
curr_Factors:  [106.1443107   -0.92872839  -1.02614119]
mat_Sqrt:  [[15.02822373  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435965 -0.03298337  0.35899778]
Stock Position:  -0.004359652052797363
Bond Position:  [8.27784447]


portfolio before change:  [7.8228866]
curr_Stock_Price:  104.59382018165482
curr_Factors:  [104.59382018  -0.8988645   -1.01102801]
mat_Sqrt:  [[15.48995836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152555  0.02571733 -0.00766732]
Stock Position:  0.0015255473735930195
Bond Position:  [7.66332377]


portfolio before change:  [7.82272317]
curr_Stock_Price:  103.85873664037706
curr_Factors:  [103.85873664  -0.56037952  -0.98520298]
mat_Sqrt:  [[22.14140037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00611818 -0.00315336 -0.19995695]
Stock Position:  -0.006118181450752428
Bond Position:  [8.45814977]


portfolio before change:  [7.81260902]
curr_Stock_Price:  105.68468533751123
curr_Factors:  [105.68468534  -0.33105482  -1.00326518]
mat_Sqrt:  [[27.83070715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113878  0.04521026  0.30430271]
Stock Position:  -0.0011387800648045856
Bond Position:  [7.93296063]


portfolio before change:  [7.81316592]
curr_Stock_Price:  106.06648344341312
curr_Factors:  [106.06648344  -0.52737462  -0.99845551]
mat_Sqrt:  [[23.06314689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.004359   -0.04921616 -0.32394831]
Stock Position:  0.004358996239480194
Bond Position:  [7.35082251]


portfolio before change:  [7.80843753]
curr_Stock_Price:  104.77093448872061
curr_Factors:  [104.77093449  -0.70178592  -1.00253366]
mat_Sqrt:  [[19.05742537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [8.92440589e-05 7.24999972e-02 2.35892791e-01]
Stock Position:  8.924405885576404e-05
Bond Position:  [7.79908735]


portfolio before change:  [7.80939013]
curr_Stock_Price:  104.52050248099953
curr_Factors:  [104.52050248  -0.72945747  -1.02184058]
mat_Sqrt:  [[18.13937889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00343997  0.0190876  -0.09770153]
Stock Position:  0.0034399728930409336
Bond Position:  [7.44984244]


portfolio before change:  [7.81483541]
curr_Stock_Price:  105.83272018847488
curr_Factors:  [105.83272019  -0.54974713  -1.0381418 ]
mat_Sqrt:  [[21.62761155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085913  0.02099166 -0.03029872]
Stock Position:  -0.0008591310093863458
Bond Position:  [7.90575958]


portfolio before change:  [7.81478963]
curr_Stock_Price:  107.03633408679978
curr_Factors:  [107.03633409  -0.70357313  -1.07533225]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.81478963]
Stock Price:  108.09469641547338
PL:  [-0.27990678]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.09366955e-01  1.80748891e-02  1.48342961e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.84672174e-01  2.97382414e-01  4.03300925e-01]
 [-2.21818215e-02 -1.91269048e-04  1.09540495e-01]
 [ 7.43410116e-02 -1.77889984e-02  8.17394243e-02]
 [ 1.23626845e-01 -3.22516882e-01 -4.44758210e-01]
 [ 2.70241106e-02 -1.96559187e-01 -2.80526404e-02]
 [ 1.13309719e-01  1.73014796e-01 -1.98533165e-02]
 [-7.34108596e-02  1.57022427e-02 -5.20816301e-02]
 [ 1.36618125e-01  3.66462460e-02  2.65929669e-01]
 [ 1.46742652e-01 -2.70969954e-01 -1.25402944e-02]
 [-1.41868593e-01 -1.08916299e-01 -2.38494123e-01]
 [ 2.93109100e-01 -3.53173332e-01 -7.59344302e-02]
 [ 9.21937592e-02 -6.36327026e-02 -4.78480977e-02]
 [-8.02527268e-02  4.02783930e-02  4.38262864e-02]
 [-7.59446301e-03 -1.53418253e-01 -2.45488025e-02]
 [-2.18869968e-01 -3.05796503e-01  3.75635798e-02]
 [-2.91558541e-01 -1.33614933e-01 -4.88683566e-02]
 [ 2.92065348e-01  1.23313779e+00  4.01553544e-01]
 [-2.53618973e-01 -3.50033382e-02  2.09347645e-01]
 [-8.89256779e-02  6.14443916e-02 -4.11178310e-02]
 [ 1.12388213e-01 -3.28688748e-02  6.90545734e-02]
 [-9.81879002e-02  5.20839949e-02 -1.12144403e-01]
 [-6.36734497e-03 -1.07376022e-01  1.05131622e-01]
 [-1.04678533e-01  8.18673489e-02 -1.71084951e-02]
 [ 8.74408934e-02 -1.46625012e-01 -1.74500683e-01]
 [ 6.78614628e-02 -2.76468065e-02  1.05898418e-01]
 [-1.02281760e-01  4.16683094e-02  1.03504177e-01]
 [-4.45537766e-01  3.47958758e-02 -6.03852779e-01]
 [ 6.28818056e-02 -1.15422042e-01 -8.45393875e-02]
 [ 2.66993726e-02  4.55547926e-02  8.33023649e-02]
 [ 2.16722026e-02  1.04907587e-01 -1.49146854e-02]
 [-1.04859936e-01 -3.50885590e-04 -1.62314682e-01]
 [-6.01616543e-02  1.25612155e-01  1.28178021e-01]
 [-5.81132283e-02  3.62028241e-02  9.16139809e-02]
 [-5.56426496e-02 -5.76778767e-02  3.58719360e-02]
 [ 7.63191274e-03  5.56622622e-04 -3.29006155e-02]
 [-8.17044390e-02  3.23594677e-02 -2.38860515e-03]
 [-5.50175400e-02 -2.74237570e-01  1.24432247e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.03091928]
curr_Stock_Price:  99.81095168420609
curr_Factors:  [99.81095168 -0.81622054 -0.98433437]
mat_Sqrt:  [[16.48948668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01083235  0.00571578  0.42318118]
Stock Position:  -0.010832349525218908
Bond Position:  [2.11210639]


portfolio before change:  [1.02958703]
curr_Stock_Price:  99.95831375059136
curr_Factors:  [99.95831375 -0.76786622 -0.99767824]
mat_Sqrt:  [[17.1022285   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00265352  0.01411938  0.0859571 ]
Stock Position:  -0.002653516343863077
Bond Position:  [1.29482805]


portfolio before change:  [1.0306727]
curr_Stock_Price:  99.61016891852037
curr_Factors:  [99.61016892 -0.78522057 -0.97604287]
mat_Sqrt:  [[17.11577951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02189056 0.09404058 1.15050528]
Stock Position:  0.021890560786066847
Bond Position:  [-1.14984976]


portfolio before change:  [1.00080249]
curr_Stock_Price:  98.25221070474973
curr_Factors:  [98.2522107  -0.74308928 -0.97884831]
mat_Sqrt:  [[17.55958854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.85785262e-06 -6.04845838e-05  3.12488542e-01]
Stock Position:  9.857852621742932e-06
Bond Position:  [0.99983394]


portfolio before change:  [1.00092489]
curr_Stock_Price:  97.98988179292222
curr_Factors:  [97.98988179 -0.43847391 -0.92875786]
mat_Sqrt:  [[24.96893522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00362717 -0.00562538  0.23317983]
Stock Position:  0.0036271747645041283
Bond Position:  [0.64549847]


portfolio before change:  [0.99419172]
curr_Stock_Price:  96.1113222771986
curr_Factors:  [96.11132228 -0.45158009 -0.91878878]
mat_Sqrt:  [[24.41354885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.00409842e-03 -1.01988793e-01 -1.26877138e+00]
Stock Position:  0.0010040984167157551
Bond Position:  [0.8976865]


portfolio before change:  [0.99652074]
curr_Stock_Price:  98.31907069653762
curr_Factors:  [98.3190707  -0.47661736 -0.92620152]
mat_Sqrt:  [[24.17693623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.000671   -0.06215747 -0.08002637]
Stock Position:  0.0006710011907210467
Bond Position:  [0.93054852]


portfolio before change:  [0.99684095]
curr_Stock_Price:  98.62292867480011
curr_Factors:  [98.62292867 -0.4927886  -0.92547867]
mat_Sqrt:  [[23.8798859   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00476235  0.05471208 -0.05663599]
Stock Position:  0.004762351081005701
Bond Position:  [0.52716394]


portfolio before change:  [0.98927939]
curr_Stock_Price:  97.02131077758807
curr_Factors:  [97.02131078 -0.67219774 -0.9266471 ]
mat_Sqrt:  [[19.61090545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0042648   0.00496549 -0.14857439]
Stock Position:  -0.0042647978632862574
Bond Position:  [1.40305566]


portfolio before change:  [0.99144645]
curr_Stock_Price:  96.55430900131613
curr_Factors:  [96.554309   -0.74640139 -0.89766751]
mat_Sqrt:  [[18.6535548   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01028474 0.01158856 0.75862333]
Stock Position:  0.01028474170880518
Bond Position:  [-0.00158968]


portfolio before change:  [1.00037263]
curr_Stock_Price:  97.42223398049534
curr_Factors:  [97.42223398 -0.6905611  -0.91187912]
mat_Sqrt:  [[19.62127105  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00699172 -0.08568822 -0.03577397]
Stock Position:  0.006991721403048465
Bond Position:  [0.31922351]


portfolio before change:  [0.99378385]
curr_Stock_Price:  96.47415685612073
curr_Factors:  [96.47415686 -0.89213089 -0.8989765 ]
mat_Sqrt:  [[16.08951434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01201796 -0.03444236 -0.68035735]
Stock Position:  -0.012017964286477804
Bond Position:  [2.15320682]


portfolio before change:  [0.99110936]
curr_Stock_Price:  96.71909425384908
curr_Factors:  [96.71909425 -0.93861514 -0.8922061 ]
mat_Sqrt:  [[15.50231856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01731935 -0.11168321 -0.21661979]
Stock Position:  0.017319354633985665
Bond Position:  [-0.68400293]


portfolio before change:  [1.0020711]
curr_Stock_Price:  97.35694921886383
curr_Factors:  [97.35694922 -0.94013505 -0.91410748]
mat_Sqrt:  [[15.24332324  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00529962 -0.02012243 -0.1364973 ]
Stock Position:  0.005299619810350702
Bond Position:  [0.48611628]


portfolio before change:  [1.00688058]
curr_Stock_Price:  98.25299740247229
curr_Factors:  [98.2529974  -1.11929338 -0.93876921]
mat_Sqrt:  [[12.54701977  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00560027  0.01273715  0.1250242 ]
Stock Position:  -0.0056002733111574846
Bond Position:  [1.55712422]


portfolio before change:  [1.0069766]
curr_Stock_Price:  98.27060866216875
curr_Factors:  [98.27060866 -1.02472294 -0.95740725]
mat_Sqrt:  [[13.53927603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012236  -0.04851511 -0.0700309 ]
Stock Position:  -0.001223603726416347
Bond Position:  [1.12722089]


portfolio before change:  [1.00828167]
curr_Stock_Price:  97.31919433718045
curr_Factors:  [97.31919434 -1.01480222 -0.95877451]
mat_Sqrt:  [[13.52337295  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01620143 -0.09670134  0.10715844]
Stock Position:  -0.01620142893183129
Bond Position:  [2.58499168]


portfolio before change:  [1.03817191]
curr_Stock_Price:  95.49422591228345
curr_Factors:  [95.49422591 -0.81449981 -0.95479449]
mat_Sqrt:  [[16.27729974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01873675 -0.04225275 -0.13940782]
Stock Position:  -0.018736748721486483
Bond Position:  [2.82742322]


portfolio before change:  [1.02550602]
curr_Stock_Price:  96.18908178143202
curr_Factors:  [96.18908178 -1.07315368 -0.97116396]
mat_Sqrt:  [[12.45345655  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03259108 0.38995241 1.14552049]
Stock Position:  0.0325910803413778
Bond Position:  [-2.10940007]


portfolio before change:  [1.04697258]
curr_Stock_Price:  96.85583633791126
curr_Factors:  [96.85583634 -0.96577194 -0.96118955]
mat_Sqrt:  [[14.10123191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01501924 -0.01106903  0.59721056]
Stock Position:  -0.015019244239884098
Bond Position:  [2.50167404]


portfolio before change:  [1.0570369]
curr_Stock_Price:  96.20656331040044
curr_Factors:  [96.20656331 -1.0269778  -0.97962065]
mat_Sqrt:  [[12.93451256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00740131  0.01943042 -0.11729773]
Stock Position:  -0.007401309644521871
Bond Position:  [1.76909146]


portfolio before change:  [1.05761879]
curr_Stock_Price:  96.15782260815291
curr_Factors:  [96.15782261 -1.04102764 -1.0119223 ]
mat_Sqrt:  [[12.34240487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01017915 -0.01039405  0.19699348]
Stock Position:  0.010179154660274985
Bond Position:  [0.07881345]


portfolio before change:  [1.04768006]
curr_Stock_Price:  95.18047349622616
curr_Factors:  [95.1804735  -1.1397892  -1.01691901]
mat_Sqrt:  [[11.0128922   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01087221  0.01647041 -0.31991677]
Stock Position:  -0.010872210090500123
Bond Position:  [2.08250216]


portfolio before change:  [1.04290231]
curr_Stock_Price:  95.64386365174671
curr_Factors:  [95.64386365 -1.06481655 -1.02594174]
mat_Sqrt:  [[11.82094844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104223 -0.03395528  0.29991125]
Stock Position:  0.0010422277477021803
Bond Position:  [0.94321962]


portfolio before change:  [1.04350337]
curr_Stock_Price:  96.1074343177392
curr_Factors:  [96.10743432 -1.08680825 -1.0366393 ]
mat_Sqrt:  [[11.4962297   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00922537  0.02588873 -0.04880577]
Stock Position:  -0.009225371036924791
Bond Position:  [1.93013011]


portfolio before change:  [1.05270756]
curr_Stock_Price:  95.13588363653824
curr_Factors:  [95.13588364 -0.91509359 -0.9976622 ]
mat_Sqrt:  [[14.04898896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00341912 -0.0463669  -0.49780188]
Stock Position:  0.0034191249910901
Bond Position:  [0.72742609]


portfolio before change:  [1.05080273]
curr_Stock_Price:  94.55217523522407
curr_Factors:  [94.55217524 -0.95007049 -0.98317005]
mat_Sqrt:  [[13.67967646  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00648875 -0.00874269  0.30209871]
Stock Position:  0.006488753562034982
Bond Position:  [0.43727696]


portfolio before change:  [1.05766587]
curr_Stock_Price:  95.6014498727199
curr_Factors:  [95.60144987 -0.93326209 -0.99902376]
mat_Sqrt:  [[13.84469511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00578403  0.01317668  0.29526861]
Stock Position:  -0.005784033984421911
Bond Position:  [1.61062791]


portfolio before change:  [1.05369063]
curr_Stock_Price:  96.32353853871298
curr_Factors:  [96.32353854 -1.1579969  -1.00412567]
mat_Sqrt:  [[11.08497008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05123156  0.01100342 -1.7226239 ]
Stock Position:  -0.05123155665645988
Bond Position:  [5.98849545]


portfolio before change:  [0.99453421]
curr_Stock_Price:  97.49283792117491
curr_Factors:  [97.49283792 -1.05939818 -1.0166449 ]
mat_Sqrt:  [[12.22809093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00348747 -0.03649965 -0.24116734]
Stock Position:  0.0034874692505559956
Bond Position:  [0.65453094]


portfolio before change:  [0.99542372]
curr_Stock_Price:  97.72443557655089
curr_Factors:  [97.72443558 -1.09181027 -1.00176038]
mat_Sqrt:  [[12.04417312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00372625 0.01440569 0.23763846]
Stock Position:  0.003726251348047584
Bond Position:  [0.63127791]


portfolio before change:  [0.99730714]
curr_Stock_Price:  98.20870433706881
curr_Factors:  [98.20870434 -1.09078206 -1.01048415]
mat_Sqrt:  [[12.01106898  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017764   0.03317469 -0.04254745]
Stock Position:  0.00177639954444315
Bond Position:  [0.82284925]


portfolio before change:  [0.99701076]
curr_Stock_Price:  97.98395433452116
curr_Factors:  [97.98395433 -0.99718675 -1.01976718]
mat_Sqrt:  [[13.0377606   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.05847427e-02 -1.10959766e-04 -4.63038607e-01]
Stock Position:  -0.01058474272626312
Bond Position:  [2.03414571]


portfolio before change:  [0.99906661]
curr_Stock_Price:  97.81375070042836
curr_Factors:  [97.8137507  -0.82349305 -1.02306845]
mat_Sqrt:  [[15.43293198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199276  0.03972205  0.36565622]
Stock Position:  -0.0019927602542073957
Bond Position:  [1.19398596]


portfolio before change:  [0.9988985]
curr_Stock_Price:  97.97300955870034
curr_Factors:  [97.97300956 -0.85309551 -1.02581226]
mat_Sqrt:  [[14.96604927  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257101  0.01144834  0.26134919]
Stock Position:  -0.0025710091662622743
Bond Position:  [1.25078801]


portfolio before change:  [0.99980789]
curr_Stock_Price:  97.68011632001577
curr_Factors:  [97.68011632 -0.5291184  -1.0391366 ]
mat_Sqrt:  [[20.35737028  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244676 -0.01823935  0.10233265]
Stock Position:  -0.00244675795374246
Bond Position:  [1.23880749]


portfolio before change:  [0.99463745]
curr_Stock_Price:  99.85658717340542
curr_Factors:  [99.85658717 -0.70295849 -1.07436523]
mat_Sqrt:  [[16.88475775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.51073739e-05  1.76019528e-04 -9.38562982e-02]
Stock Position:  5.510737392371178e-05
Bond Position:  [0.98913462]


portfolio before change:  [0.994835]
curr_Stock_Price:  101.19755348518656
curr_Factors:  [101.19755349  -0.82488622  -1.08449041]
mat_Sqrt:  [[14.99471722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00542568  0.01023296 -0.00681403]
Stock Position:  -0.005425677054939696
Bond Position:  [1.54390024]


portfolio before change:  [0.9906645]
curr_Stock_Price:  102.00178418976462
curr_Factors:  [102.00178419  -0.85883032  -1.09611181]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.9906645]
Stock Price:  102.27616490673789
PL:  [-1.2855004]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-6.48240815e-02  2.33181461e-02  7.66013636e-03]
 [-3.50837482e-03 -3.32318979e-02 -1.08673534e-01]
 [ 3.01201598e-01 -2.29600849e-01 -4.42061673e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-7.66262672e-01 -2.30201815e-01  3.39280990e-02]
 [-1.35057561e-03 -9.21175134e-02 -1.12080158e-01]
 [ 2.91688512e-02 -5.12167103e-02 -3.34293397e-02]
 [ 3.19029068e-01  1.35062428e-01 -9.35383413e-02]
 [-2.71243028e-01  1.03283715e-02 -1.17468828e-01]
 [ 4.47895144e-02 -1.28606923e-02 -3.93288236e-02]
 [ 1.93343760e-02 -2.69421397e-01  7.09045552e-02]
 [-3.05791817e-02  3.43901433e-04  2.41086620e-02]
 [ 2.20385543e-01 -1.79706677e-01  1.67356074e-01]
 [ 4.48646524e-02  2.84503089e-01  2.40549638e-01]
 [ 7.57138352e-02 -1.13045651e-01 -5.30425362e-02]
 [-3.32360260e-02  3.57245754e-02  4.29156466e-02]
 [-5.14174938e-01 -2.55804212e-01  1.44106217e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 2.74428940e-01  1.04518599e+00  4.72448664e-01]
 [-2.02564066e-02  4.13305214e-02  2.61001651e-02]
 [ 3.82437780e-02 -1.13770597e-01  7.31169696e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.74417447e-01 -2.61132246e-02  1.76037307e-01]
 [ 7.20332422e-02 -1.82351448e-01 -7.25499839e-02]
 [-1.21954044e-01  2.31993131e-01  2.00449335e-01]
 [ 1.32803928e-02  6.17455886e-02  2.14055883e-02]
 [-1.94320467e-01 -1.72779848e-01  3.98548817e-01]
 [ 9.30519288e-02  7.66237698e-02 -9.13187389e-02]
 [-6.09106210e-01 -6.26053218e-02 -8.56701917e-01]
 [-1.25210731e-01  2.49416574e-02  5.88648257e-02]
 [-2.20645854e-01 -6.44475804e-02  1.38302621e-01]
 [ 3.69140058e-02  8.23105799e-02 -2.43291680e-02]
 [-1.60385240e-01  2.24643894e-03 -1.25592665e-01]
 [ 1.71776570e-03  1.61369578e-01 -1.03777176e-01]
 [ 8.10087916e-02 -1.45757553e-01 -1.28789183e-01]
 [-4.63476875e-02  3.32099623e-01  8.60502353e-02]
 [ 8.19832584e-02  6.86619632e-02 -3.07305662e-02]
 [-3.84733460e-02  8.13316068e-02 -8.54403476e-03]
 [-1.25794189e-01 -2.54310677e-01  5.20794493e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.25213203]
curr_Stock_Price:  100.95641297634795
curr_Factors:  [100.95641298  -1.10547411  -1.00973601]
mat_Sqrt:  [[12.17614547  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.005146    0.00737385  0.02185224]
Stock Position:  -0.005145995575667378
Bond Position:  [9.77165329]


portfolio before change:  [9.25117809]
curr_Stock_Price:  101.37916374310055
curr_Factors:  [101.37916374  -0.95102379  -0.99945663]
mat_Sqrt:  [[14.41669864  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184157 -0.01050885 -0.31001534]
Stock Position:  -0.0018415666235243955
Bond Position:  [9.43787458]


portfolio before change:  [9.25185583]
curr_Stock_Price:  101.6517951060997
curr_Factors:  [101.65179511  -1.05250572  -1.01729036]
mat_Sqrt:  [[12.82962713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01598159 -0.07260616 -1.26107891]
Stock Position:  0.01598159214630964
Bond Position:  [7.6272983]


portfolio before change:  [9.24721824]
curr_Stock_Price:  101.30195140144318
curr_Factors:  [101.3019514   -1.12167317  -1.05290585]
mat_Sqrt:  [[11.51357368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171129 -0.00659539  0.21422481]
Stock Position:  0.0017112891662312262
Bond Position:  [9.07386131]


portfolio before change:  [9.24542539]
curr_Stock_Price:  99.59145360268138
curr_Factors:  [99.5914536  -1.18710305 -1.03501212]
mat_Sqrt:  [[10.79368445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0709008  -0.07279621  0.09678742]
Stock Position:  -0.07090080469032284
Bond Position:  [16.30653959]


portfolio before change:  [9.26613533]
curr_Stock_Price:  99.32810681082822
curr_Factors:  [99.32810681 -1.34771024 -1.02899916]
mat_Sqrt:  [[ 9.2231735   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288483 -0.02913012 -0.31973349]
Stock Position:  -0.002884831991431176
Bond Position:  [9.55268023]


portfolio before change:  [9.26712866]
curr_Stock_Price:  99.39772440071742
curr_Factors:  [99.3977244  -1.54788278 -1.01268608]
mat_Sqrt:  [[ 7.67954553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00273749 -0.01619615 -0.0953646 ]
Stock Position:  0.0027374935147409223
Bond Position:  [8.99502803]


portfolio before change:  [9.26667192]
curr_Stock_Price:  98.82012138395717
curr_Factors:  [98.82012138 -1.38587245 -1.01694365]
mat_Sqrt:  [[ 8.93954906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03394164  0.04271049 -0.26683885]
Stock Position:  0.03394163726167418
Bond Position:  [5.91255521]


portfolio before change:  [9.27855083]
curr_Stock_Price:  99.14832566723422
curr_Factors:  [99.14832567 -1.21880562 -0.99266132]
mat_Sqrt:  [[10.86069196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02715799  0.00326612 -0.33510587]
Stock Position:  -0.02715799102334598
Bond Position:  [11.97122017]


portfolio before change:  [9.25848999]
curr_Stock_Price:  99.94210053708623
curr_Factors:  [99.94210054 -1.27738908 -0.97971537]
mat_Sqrt:  [[10.45924817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00348299 -0.00406691 -0.11219419]
Stock Position:  0.003482993200111951
Bond Position:  [8.91039234]


portfolio before change:  [9.25981296]
curr_Stock_Price:  100.00213456506532
curr_Factors:  [100.00213457  -1.13526871  -0.96077263]
mat_Sqrt:  [[12.29447771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00218401 -0.08519853  0.20227096]
Stock Position:  0.002184011208628447
Bond Position:  [9.04140718]


portfolio before change:  [9.26060071]
curr_Stock_Price:  99.84531339737183
curr_Factors:  [99.8453134  -1.03886717 -0.94532383]
mat_Sqrt:  [[13.72791186  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186839  0.00010875  0.0687753 ]
Stock Position:  -0.0018683935670595726
Bond Position:  [9.44715105]


portfolio before change:  [9.26247515]
curr_Stock_Price:  99.4741515867742
curr_Factors:  [99.47415159 -1.17369973 -0.91684851]
mat_Sqrt:  [[12.2969294   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02032271 -0.05682824  0.4774203 ]
Stock Position:  0.020322711807759124
Bond Position:  [7.24089064]


portfolio before change:  [9.30667252]
curr_Stock_Price:  101.60438911255672
curr_Factors:  [101.60438911  -1.20263238  -0.94212579]
mat_Sqrt:  [[11.8975032   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00851544 0.08996778 0.68622116]
Stock Position:  0.00851544042962108
Bond Position:  [8.4414664]


portfolio before change:  [9.30380018]
curr_Stock_Price:  101.14315699582112
curr_Factors:  [101.143157    -1.18346453  -0.94055038]
mat_Sqrt:  [[12.09173303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0051248  -0.03574817 -0.15131559]
Stock Position:  0.005124802755416838
Bond Position:  [8.78546145]


portfolio before change:  [9.30839144]
curr_Stock_Price:  101.82474646202536
curr_Factors:  [101.82474646  -1.16421856  -0.95164432]
mat_Sqrt:  [[12.2728595   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191915  0.0112971   0.12242639]
Stock Position:  -0.0019191535409624338
Bond Position:  [9.50380876]


portfolio before change:  [9.30908297]
curr_Stock_Price:  102.08346838648418
curr_Factors:  [102.08346839  -1.18724058  -0.95988677]
mat_Sqrt:  [[11.92531495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04120346 -0.08089239  0.41109493]
Stock Position:  -0.04120345820637377
Bond Position:  [13.51527489]


portfolio before change:  [9.2824168]
curr_Stock_Price:  102.77165538529275
curr_Factors:  [102.77165539  -1.39283565  -0.96500839]
mat_Sqrt:  [[ 9.72466598  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01350289  0.00580111 -0.05715682]
Stock Position:  -0.013502888838075877
Bond Position:  [10.67013103]


portfolio before change:  [9.28141898]
curr_Stock_Price:  102.94433466009991
curr_Factors:  [102.94433466  -1.49919752  -0.95735875]
mat_Sqrt:  [[ 8.82538411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04508061 0.33051683 1.34776453]
Stock Position:  0.04508061077107229
Bond Position:  [4.64062549]


portfolio before change:  [9.30933562]
curr_Stock_Price:  103.55072679444358
curr_Factors:  [103.55072679  -1.44951568  -0.98776789]
mat_Sqrt:  [[ 9.05012025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153165  0.01306986  0.07445651]
Stock Position:  -0.0015316462980779627
Bond Position:  [9.46793871]


portfolio before change:  [9.31001297]
curr_Stock_Price:  103.88122989288622
curr_Factors:  [103.88122989  -1.46030864  -1.00148042]
mat_Sqrt:  [[ 8.85922389  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00566993 -0.03597742  0.20858236]
Stock Position:  0.0056699292625189785
Bond Position:  [8.72101375]


portfolio before change:  [9.31017831]
curr_Stock_Price:  103.71811383748285
curr_Factors:  [103.71811384  -1.29859081  -0.98407255]
mat_Sqrt:  [[10.58050774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367363  0.01916992 -0.08961985]
Stock Position:  -0.0036736293433807903
Bond Position:  [9.69120022]


portfolio before change:  [9.31053436]
curr_Stock_Price:  103.95096953596041
curr_Factors:  [103.95096954  -1.21562862  -0.96828597]
mat_Sqrt:  [[11.70486717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01791363 -0.00825773  0.50218544]
Stock Position:  0.017913630958032375
Bond Position:  [7.44839505]


portfolio before change:  [9.33088305]
curr_Stock_Price:  105.03492503655407
curr_Factors:  [105.03492504  -1.43491597  -1.0025367 ]
mat_Sqrt:  [[ 9.17828385  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00572174 -0.05766459 -0.20696491]
Stock Position:  0.005721738996325343
Bond Position:  [8.72990062]


portfolio before change:  [9.33499173]
curr_Stock_Price:  105.56227895072152
curr_Factors:  [105.56227895  -1.45542425  -1.00694351]
mat_Sqrt:  [[ 8.99737922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00834104  0.07336267  0.57182616]
Stock Position:  -0.00834103528394464
Bond Position:  [10.21549043]


portfolio before change:  [9.33761367]
curr_Stock_Price:  105.40103770685081
curr_Factors:  [105.40103771  -1.57522585  -1.01710026]
mat_Sqrt:  [[ 7.88881846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00243941 0.01952567 0.06106419]
Stock Position:  0.0024394089673412294
Bond Position:  [9.08049743]


portfolio before change:  [9.33896082]
curr_Stock_Price:  105.48795204339802
curr_Factors:  [105.48795204  -1.63786964  -1.04190069]
mat_Sqrt:  [[ 7.23424805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01623226 -0.05463779  1.13694884]
Stock Position:  -0.016232258803813696
Bond Position:  [11.05126856]


portfolio before change:  [9.33284692]
curr_Stock_Price:  105.94971157318261
curr_Factors:  [105.94971157  -1.79424089  -1.07660638]
mat_Sqrt:  [[ 6.00214736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01272711  0.02423056 -0.26050694]
Stock Position:  0.012727109478688678
Bond Position:  [7.98441334]


portfolio before change:  [9.34193348]
curr_Stock_Price:  106.58524083458651
curr_Factors:  [106.58524083  -2.08404916  -1.0993984 ]
mat_Sqrt:  [[ 4.41716235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.17785088 -0.01979754 -2.44393211]
Stock Position:  -0.17785088171675112
Bond Position:  [28.29821254]


portfolio before change:  [9.34809118]
curr_Stock_Price:  106.57050823091889
curr_Factors:  [106.57050823  -2.02267617  -1.06863065]
mat_Sqrt:  [[ 4.84283356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02324073  0.00788724  0.16792496]
Stock Position:  -0.023240734298814805
Bond Position:  [11.82486805]


portfolio before change:  [9.34799945]
curr_Stock_Price:  106.63805923033355
curr_Factors:  [106.63805923  -1.89208318  -1.07966287]
mat_Sqrt:  [[ 5.46134137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03553687 -0.02038011  0.39453888]
Stock Position:  -0.03553687013955267
Bond Position:  [13.13758231]


portfolio before change:  [9.35359268]
curr_Stock_Price:  106.52688094661035
curr_Factors:  [106.52688095  -1.95816421  -1.07506249]
mat_Sqrt:  [[ 5.13033348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0066415   0.02602889 -0.06940434]
Stock Position:  0.00664149520645467
Bond Position:  [8.64609491]


portfolio before change:  [9.35405135]
curr_Stock_Price:  106.43320270000149
curr_Factors:  [106.4332027   -1.79115469  -1.08000787]
mat_Sqrt:  [[ 6.02763675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03085185  0.00071039 -0.35828091]
Stock Position:  -0.030851847947824126
Bond Position:  [12.63771233]


portfolio before change:  [9.34883163]
curr_Stock_Price:  106.65359564697981
curr_Factors:  [106.65359565  -1.92830472  -1.03815324]
mat_Sqrt:  [[ 5.49109778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00278617  0.05102954 -0.2960474 ]
Stock Position:  -0.002786167312788719
Bond Position:  [9.64598639]


portfolio before change:  [9.34842662]
curr_Stock_Price:  107.23174895520113
curr_Factors:  [107.23174896  -1.90022983  -1.0353825 ]
mat_Sqrt:  [[ 5.69381237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00894943 -0.04609259 -0.36739969]
Stock Position:  0.008949428370487494
Bond Position:  [8.38876376]


portfolio before change:  [9.34927773]
curr_Stock_Price:  107.20967457227826
curr_Factors:  [107.20967457  -1.83795635  -1.06022387]
mat_Sqrt:  [[ 5.90976618  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00341942  0.10501912  0.24547737]
Stock Position:  -0.0034194214709196828
Bond Position:  [9.71587279]


portfolio before change:  [9.34992214]
curr_Stock_Price:  107.37641276860191
curr_Factors:  [107.37641277  -1.66026158  -1.03874955]
mat_Sqrt:  [[ 7.22342638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01072666  0.02171282 -0.08766575]
Stock Position:  0.010726661836379143
Bond Position:  [8.19813167]


portfolio before change:  [9.35483511]
curr_Stock_Price:  107.73888749014532
curr_Factors:  [107.73888749  -1.63111726  -1.04026909]
mat_Sqrt:  [[ 7.45082104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00511587  0.02571931 -0.02437375]
Stock Position:  -0.005115867971678452
Bond Position:  [9.90601304]


portfolio before change:  [9.35424021]
curr_Stock_Price:  108.09723077953058
curr_Factors:  [108.09723078  -1.5678475   -1.03945522]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.35424021]
Stock Price:  107.71397764987537
PL:  [1.64026256]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.25439208e-01 -1.70249088e-02  3.46189725e-02]
 [ 2.66333549e-02 -8.09680368e-02 -1.93752001e-01]
 [ 3.46694053e-01 -4.08165229e-01 -7.49603723e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-5.74550410e-01 -1.69280932e-01  2.14712089e-03]
 [-7.15677652e-02  3.15176049e-02  7.86611788e-02]
 [ 7.41230256e-03  1.43151941e-01  7.74217187e-02]
 [ 2.96881068e-01 -2.10063033e-01 -4.92863905e-02]
 [-6.61564923e-01 -3.00517389e-02 -1.21097729e-01]
 [-8.00778340e-02  1.41169458e-01  5.14916772e-02]
 [-4.32117239e-02 -1.70727972e-01  1.41504513e-01]
 [-2.10777534e-01  3.32491794e-02  1.78064026e-01]
 [ 3.51287878e-02  1.04918358e-02  2.10853060e-01]
 [-1.39609082e-02  5.42950495e-01  4.87363455e-01]
 [ 7.17420248e-02 -1.17154867e-01 -4.78219463e-02]
 [-7.52523872e-03 -2.82702668e-02  3.29770953e-02]
 [-5.86710595e-01 -2.44752406e-01  1.70407581e-01]
 [-1.18184260e-01  1.89625933e-02 -2.79541724e-02]
 [ 1.27976646e-01  8.15262833e-01  2.58614302e-01]
 [-3.15333253e-02  5.41106384e-02  2.46341007e-02]
 [ 5.23885805e-02 -1.55959080e-01  1.01875028e-01]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.71490092e-01 -2.74253414e-02  1.73921208e-01]
 [ 7.55313706e-02 -1.96746009e-01 -8.43180806e-02]
 [-1.20928427e-01  2.25391468e-01  1.77245397e-01]
 [ 1.41816453e-02  6.26046454e-02  7.14614764e-04]
 [-1.59622617e-01 -1.50353668e-01  3.22887247e-01]
 [ 1.02430840e-01  7.55944443e-02 -8.99509419e-02]
 [-7.18311929e-01 -1.24139603e-01 -1.05392584e+00]
 [-1.19056949e-01  4.54633267e-02  2.75942777e-02]
 [-1.41727260e-01 -4.56518396e-02  1.27786916e-01]
 [ 1.51119219e-02  9.61347853e-02  8.47194217e-03]
 [-1.43970170e-01  1.84500425e-03 -1.33930721e-01]
 [-2.60897142e-02  2.22747819e-02 -6.04284594e-02]
 [ 1.56624159e-01 -1.60208811e-01 -9.98668377e-02]
 [-9.23296379e-03  1.51085087e-01  8.00770510e-02]
 [ 6.93093854e-03  7.21397170e-03 -4.61838118e-02]
 [-7.04049834e-02  7.05636316e-02 -4.55918923e-03]
 [-6.70342115e-02 -2.10496792e-01  7.88371623e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.12823957]
curr_Stock_Price:  100.1031712486741
curr_Factors:  [100.10317125  -1.05594561  -1.05514741]
mat_Sqrt:  [[12.12304699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00980052 -0.00538375  0.09875829]
Stock Position:  -0.009800524627525556
Bond Position:  [4.10930316]


portfolio before change:  [3.11343531]
curr_Stock_Price:  101.6661434543687
curr_Factors:  [101.66614345  -0.93047945  -1.0521825 ]
mat_Sqrt:  [[13.99965089  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00107193 -0.02560434 -0.55272053]
Stock Position:  -0.0010719333298878698
Bond Position:  [3.22241464]


portfolio before change:  [3.11294152]
curr_Stock_Price:  102.50259773490527
curr_Factors:  [102.50259773  -0.93358213  -1.06102077]
mat_Sqrt:  [[13.94729025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01313108 -0.12907318 -2.13841077]
Stock Position:  0.013131084930469923
Bond Position:  [1.7669712]


portfolio before change:  [3.11445973]
curr_Stock_Price:  102.60139595316426
curr_Factors:  [102.60139595  -0.48768023  -1.07194853]
mat_Sqrt:  [[21.56825982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091352 -0.00659539  0.21422481]
Stock Position:  0.0009135207973545566
Bond Position:  [3.02073122]


portfolio before change:  [3.11416548]
curr_Stock_Price:  101.86593118524915
curr_Factors:  [101.86593119  -0.43703326  -1.08024746]
mat_Sqrt:  [[22.33995618  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02589454 -0.05353133  0.00612514]
Stock Position:  -0.025894542537451264
Bond Position:  [5.75193717]


portfolio before change:  [3.10722155]
curr_Stock_Price:  102.16186123603529
curr_Factors:  [102.16186124  -0.4458029   -1.10396313]
mat_Sqrt:  [[21.68872206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252193  0.00996674  0.22439845]
Stock Position:  -0.0025219253616589293
Bond Position:  [3.36486614]


portfolio before change:  [3.10716364]
curr_Stock_Price:  102.35161357342166
curr_Factors:  [102.35161357  -0.55304343  -1.12556368]
mat_Sqrt:  [[19.10226604  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00140884 0.04526862 0.22086261]
Stock Position:  0.001408843949678481
Bond Position:  [2.96296619]


portfolio before change:  [3.11043473]
curr_Stock_Price:  104.41053336405383
curr_Factors:  [104.41053336  -0.79091045  -1.14219375]
mat_Sqrt:  [[15.10802964  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01862564 -0.06642776 -0.14060035]
Stock Position:  0.01862564004938611
Bond Position:  [1.16572172]


portfolio before change:  [3.11954625]
curr_Stock_Price:  104.89190181536584
curr_Factors:  [104.89190182  -1.29134467  -1.15085436]
mat_Sqrt:  [[ 9.12238506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07531581 -0.00950319 -0.34545811]
Stock Position:  -0.07531581059443442
Bond Position:  [11.01956486]


portfolio before change:  [3.11005059]
curr_Stock_Price:  105.03626988762687
curr_Factors:  [105.03626989  -1.25726738  -1.15321383]
mat_Sqrt:  [[ 9.42932499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00699119  0.0446417   0.14689142]
Stock Position:  -0.006991185454640844
Bond Position:  [3.84437863]


portfolio before change:  [3.11126231]
curr_Stock_Price:  104.93168911722879
curr_Factors:  [104.93168912  -1.35963427  -1.12643522]
mat_Sqrt:  [[ 8.7341451   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214508 -0.05398893  0.40367299]
Stock Position:  -0.002145076951567151
Bond Position:  [3.33634885]


portfolio before change:  [3.11299812]
curr_Stock_Price:  104.31691341302331
curr_Factors:  [104.31691341  -1.44373772  -1.11530582]
mat_Sqrt:  [[ 8.07190871  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0215032   0.01051431  0.5079671 ]
Stock Position:  -0.02150320121392443
Bond Position:  [5.3561457]


portfolio before change:  [3.10475836]
curr_Stock_Price:  104.73123847920375
curr_Factors:  [104.73123848  -1.59655237  -1.11592331]
mat_Sqrt:  [[ 6.95125173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01128428 0.00331781 0.60150509]
Stock Position:  0.011284282258700413
Bond Position:  [1.92294151]


portfolio before change:  [3.10776964]
curr_Stock_Price:  104.97679200201377
curr_Factors:  [104.976792    -1.66904275  -1.1255292 ]
mat_Sqrt:  [[ 6.41839023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01550866 0.17169602 1.39031228]
Stock Position:  0.015508664709788983
Bond Position:  [1.47971977]


portfolio before change:  [3.11766518]
curr_Stock_Price:  105.60293008265946
curr_Factors:  [105.60293008  -1.69316968  -1.09625839]
mat_Sqrt:  [[ 6.48997094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00908409 -0.03704762 -0.1364227 ]
Stock Position:  0.009084090779822706
Bond Position:  [2.15835858]


portfolio before change:  [3.11640769]
curr_Stock_Price:  105.43480016912098
curr_Factors:  [105.43480017  -1.57246191  -1.07799412]
mat_Sqrt:  [[ 7.44570028  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00020465 -0.00893984  0.09407447]
Stock Position:  -0.00020464864678657076
Bond Position:  [3.13798478]


portfolio before change:  [3.11675457]
curr_Stock_Price:  105.65660150623255
curr_Factors:  [105.65660151  -1.24984841  -1.07760245]
mat_Sqrt:  [[10.30617644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05416614 -0.07739751  0.4861254 ]
Stock Position:  -0.05416613779347945
Bond Position:  [8.8397646]


portfolio before change:  [3.12455544]
curr_Stock_Price:  105.5329848511001
curr_Factors:  [105.53298485  -1.21852655  -1.05101275]
mat_Sqrt:  [[10.90786686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01131301  0.0059965  -0.07974547]
Stock Position:  -0.011313006567768907
Bond Position:  [4.31845079]


portfolio before change:  [3.12678974]
curr_Stock_Price:  105.3832055867804
curr_Factors:  [105.38320559  -1.28939962  -1.05201477]
mat_Sqrt:  [[10.13696748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01990892 0.25780874 0.73775462]
Stock Position:  0.019908919108496258
Bond Position:  [1.02872402]


portfolio before change:  [3.12032147]
curr_Stock_Price:  105.05185307838707
curr_Factors:  [105.05185308  -1.35648743  -1.03973153]
mat_Sqrt:  [[ 9.56619095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262464  0.01711129  0.07027423]
Stock Position:  -0.0026246371271781595
Bond Position:  [3.39604446]


portfolio before change:  [3.1215457]
curr_Stock_Price:  104.74716208638064
curr_Factors:  [104.74716209  -1.0448503   -1.0018351 ]
mat_Sqrt:  [[13.52938602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00511161 -0.04931859  0.2906211 ]
Stock Position:  0.005111605748195513
Bond Position:  [2.58611951]


portfolio before change:  [3.11999077]
curr_Stock_Price:  104.37972036593473
curr_Factors:  [104.37972037  -1.42366163  -0.99878278]
mat_Sqrt:  [[ 9.25895318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00419798  0.01916992 -0.08961985]
Stock Position:  -0.004197976047850197
Bond Position:  [3.55817434]


portfolio before change:  [3.12280123]
curr_Stock_Price:  103.81619510466422
curr_Factors:  [103.8161951   -1.17622248  -0.97821079]
mat_Sqrt:  [[12.03944939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01713396 -0.00867265  0.4961488 ]
Stock Position:  0.017133963837368524
Bond Position:  [1.3440183]


portfolio before change:  [3.12900014]
curr_Stock_Price:  104.16817979356345
curr_Factors:  [104.16817979  -1.29916097  -0.98689511]
mat_Sqrt:  [[10.59042856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00502719 -0.06221655 -0.24053601]
Stock Position:  0.005027186015498612
Bond Position:  [2.60532732]


portfolio before change:  [3.13160338]
curr_Stock_Price:  104.6212269897935
curr_Factors:  [104.62122699  -1.46122505  -0.99610602]
mat_Sqrt:  [[ 8.96219693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00880686  0.07127504  0.50563178]
Stock Position:  -0.008806856120286663
Bond Position:  [4.05298747]


portfolio before change:  [3.13640276]
curr_Stock_Price:  104.1337974286484
curr_Factors:  [104.13379743  -1.24906521  -0.96202577]
mat_Sqrt:  [[11.41108905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00139723 0.01979733 0.0020386 ]
Stock Position:  0.0013972338927399775
Bond Position:  [2.99090348]


portfolio before change:  [3.13850547]
curr_Stock_Price:  105.37111865317561
curr_Factors:  [105.37111865  -1.43086326  -0.96313183]
mat_Sqrt:  [[ 9.61662613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01014864 -0.047546    0.92110744]
Stock Position:  -0.010148637086091974
Bond Position:  [4.20787871]


portfolio before change:  [3.13136954]
curr_Stock_Price:  106.12609209667264
curr_Factors:  [106.1260921  -1.3680661  -0.9910581]
mat_Sqrt:  [[10.02922908  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00857708  0.02390506 -0.256605  ]
Stock Position:  0.008577082076415195
Bond Position:  [2.22111733]


portfolio before change:  [3.13072501]
curr_Stock_Price:  106.01857449541687
curr_Factors:  [106.0185745   -1.33145487  -1.00169469]
mat_Sqrt:  [[10.28271939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09108961 -0.03925639 -3.00655707]
Stock Position:  -0.0910896111249897
Bond Position:  [12.78791573]


portfolio before change:  [3.17051116]
curr_Stock_Price:  105.59934379482794
curr_Factors:  [105.59934379  -1.65946969  -0.97926796]
mat_Sqrt:  [[ 7.54522198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01487702  0.01437677  0.07871879]
Stock Position:  -0.014877021824158544
Bond Position:  [4.7415149]


portfolio before change:  [3.17369496]
curr_Stock_Price:  105.42517734632227
curr_Factors:  [105.42517735  -1.52691898  -0.98162588]
mat_Sqrt:  [[ 8.58019487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01361526 -0.01443638  0.3645405 ]
Stock Position:  -0.013615260770070695
Bond Position:  [4.60908624]


portfolio before change:  [3.17910194]
curr_Stock_Price:  105.07036937312382
curr_Factors:  [105.07036937  -1.71876597  -0.9832128 ]
mat_Sqrt:  [[ 7.04734915  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00274194 0.03040049 0.02416809]
Stock Position:  0.0027419443653867374
Bond Position:  [2.89100483]


portfolio before change:  [3.17859834]
curr_Stock_Price:  104.75490314981663
curr_Factors:  [104.75490315  -1.79952972  -0.93996271]
mat_Sqrt:  [[ 6.76749455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02530642  0.00058344 -0.38206707]
Stock Position:  -0.02530641510066433
Bond Position:  [5.82956941]


portfolio before change:  [3.16466822]
curr_Stock_Price:  105.33415812038433
curr_Factors:  [105.33415812  -1.87946523  -0.95898709]
mat_Sqrt:  [[ 6.16375042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00614066  0.0070439  -0.17238557]
Stock Position:  -0.006140658994234314
Bond Position:  [3.81148936]


portfolio before change:  [3.16858138]
curr_Stock_Price:  104.77449614677519
curr_Factors:  [104.77449615  -1.85809557  -0.94109014]
mat_Sqrt:  [[ 6.37653389  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02071695 -0.05066247 -0.28489229]
Stock Position:  0.020716952963583016
Bond Position:  [0.99797307]


portfolio before change:  [3.16337484]
curr_Stock_Price:  104.51715670980232
curr_Factors:  [104.51715671  -1.86709576  -0.91666561]
mat_Sqrt:  [[ 6.45974514  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00170497 0.0477773  0.22843754]
Stock Position:  0.0017049737658728372
Bond Position:  [2.98517583]


portfolio before change:  [3.1635541]
curr_Stock_Price:  104.40342386646223
curr_Factors:  [104.40342387  -1.69842391  -0.89512964]
mat_Sqrt:  [[ 7.80456584  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00029598  0.00228126 -0.13174956]
Stock Position:  -0.0002959842572688583
Bond Position:  [3.19445587]


portfolio before change:  [3.1638918]
curr_Stock_Price:  104.61165075812698
curr_Factors:  [104.61165076  -1.65050332  -0.89630354]
mat_Sqrt:  [[ 8.19437602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0084831   0.02231418 -0.0130061 ]
Stock Position:  -0.008483096049466123
Bond Position:  [4.05132248]


portfolio before change:  [3.16949443]
curr_Stock_Price:  104.01090542815793
curr_Factors:  [104.01090543  -1.44381559  -0.92539245]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.16949443]
Stock Price:  104.4702207415662
PL:  [-1.30072631]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [ 9.67299950e-02  1.11545521e-02  2.50791959e-01]
 [-9.13517055e-02  4.80191611e-02  7.75766502e-02]
 [ 2.21769451e-01  2.79433743e-01  4.10928569e-01]
 [-1.84380149e-02  3.51586225e-02  1.23150290e-01]
 [-6.46979836e-01 -1.96413557e-01  3.68430651e-02]
 [ 4.61696145e-03 -1.13224607e-01 -1.39968485e-01]
 [ 3.45008467e-02 -9.70421609e-02 -1.99027672e-02]
 [ 1.62608632e-01  2.40329360e-01 -4.51572961e-02]
 [ 2.15615135e-02  2.19817029e-02 -3.62690792e-02]
 [ 1.58729779e-01  7.78845002e-02  4.12355818e-01]
 [ 2.48006920e-01 -1.86836586e-01 -8.33702978e-02]
 [-2.09225670e-01 -1.45967271e-01 -3.21220331e-01]
 [ 3.05040859e-01 -3.81566389e-01 -1.27603263e-01]
 [ 7.45829055e-02 -8.89207693e-02 -4.96208438e-02]
 [-2.67873507e-01  4.97155723e-01  3.48308723e-01]
 [ 8.99994092e-02 -5.47747890e-01 -1.54549777e-01]
 [ 1.50693238e-01 -2.06134324e-01 -1.13123395e-01]
 [-2.98530074e-01 -1.28004576e-01 -5.05516021e-02]
 [ 2.01173862e-01  1.23387987e+00  2.58643764e-01]
 [-3.90012019e-01 -6.78314527e-02  2.93703241e-01]
 [-9.02687690e-02 -8.39833630e-02 -3.70175503e-02]
 [ 2.09500586e-01 -6.02953767e-02  1.09270762e-01]
 [-8.31313576e-02  7.34079777e-02 -1.09714102e-01]
 [-3.66000407e-03 -1.01720330e-01  1.01861368e-01]
 [-1.06268919e-01  8.60199489e-02 -4.96865208e-03]
 [ 8.44478018e-02 -1.62706525e-01 -1.97115165e-01]
 [ 7.82932845e-02 -1.51194819e-02  1.02823213e-01]
 [-2.16012366e-01  3.49797677e-02  2.12676827e-01]
 [-3.77623577e-01 -8.46791322e-02 -6.05925408e-01]
 [ 2.91280924e-01 -2.12470195e-01 -1.81984134e-01]
 [ 1.34402245e-01  7.80856691e-03 -3.63898821e-02]
 [ 4.25054707e-02  2.41189777e-01 -8.01586121e-02]
 [-1.78233740e-01  3.36782796e-02 -1.65471476e-01]
 [-4.35470258e-02  1.49035461e-01  9.49939323e-02]
 [-1.56655554e-01  9.32918789e-02  1.12297593e-01]
 [-1.33656364e-01 -8.04197787e-02 -5.98085884e-03]
 [ 7.52279537e-02  5.74771896e-02  8.75681091e-03]
 [-9.42846666e-02  6.30318422e-02 -6.11693516e-05]
 [-4.06020938e-02 -2.70725117e-01  1.22793981e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.2472975]
curr_Stock_Price:  99.0755379216922
curr_Factors:  [99.07553792 -1.14842774 -1.01533505]
mat_Sqrt:  [[11.38298591  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01302037 0.00352738 0.71543965]
Stock Position:  0.013020370908033879
Bond Position:  [-5.53729775]


portfolio before change:  [-4.25120153]
curr_Stock_Price:  98.82886065625335
curr_Factors:  [98.82886066 -1.00071154 -1.01188265]
mat_Sqrt:  [[13.20764037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00562376  0.01518499  0.22130459]
Stock Position:  -0.005623759170003765
Bond Position:  [-3.69541182]


portfolio before change:  [-4.25314959]
curr_Stock_Price:  99.0931153448019
curr_Factors:  [99.09311534 -1.00781011 -0.99508195]
mat_Sqrt:  [[13.37206607  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0233969  0.08836471 1.17226483]
Stock Position:  0.0233968961898615
Bond Position:  [-6.57162093]


portfolio before change:  [-4.24247395]
curr_Stock_Price:  99.58451159622129
curr_Factors:  [99.5845116  -1.10617546 -0.95844955]
mat_Sqrt:  [[12.63387422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00060217 0.01111813 0.3513135 ]
Stock Position:  0.0006021687723974758
Bond Position:  [-4.30244063]


portfolio before change:  [-4.24318733]
curr_Stock_Price:  99.29299378907777
curr_Factors:  [99.29299379 -1.09062748 -0.98146543]
mat_Sqrt:  [[12.50316862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05154939 -0.06211142  0.10510301]
Stock Position:  -0.051549385066191236
Bond Position:  [0.87530544]


portfolio before change:  [-4.2430865]
curr_Stock_Price:  99.29316044233566
curr_Factors:  [99.29316044 -1.01790792 -0.95747985]
mat_Sqrt:  [[13.77270747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019515  -0.03580476 -0.39929113]
Stock Position:  -0.0019514995764335346
Bond Position:  [-4.04931594]


portfolio before change:  [-4.24314953]
curr_Stock_Price:  99.06606918883594
curr_Factors:  [99.06606919 -0.82541284 -0.94959421]
mat_Sqrt:  [[16.7899408   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166365 -0.03068743 -0.05677705]
Stock Position:  0.0016636505087114554
Bond Position:  [-4.40796085]


portfolio before change:  [-4.24582936]
curr_Stock_Price:  97.78647452624347
curr_Factors:  [97.78647453 -0.85031408 -0.96051002]
mat_Sqrt:  [[15.98997827  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00998102  0.07599882 -0.1288212 ]
Stock Position:  0.009981015144477214
Bond Position:  [-5.22183764]


portfolio before change:  [-4.26415295]
curr_Stock_Price:  96.01603089152911
curr_Factors:  [96.01603089 -0.64202882 -0.9735921 ]
mat_Sqrt:  [[19.08483888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00077159  0.00695122 -0.10346559]
Stock Position:  0.0007715906806934675
Bond Position:  [-4.33823803]


portfolio before change:  [-4.26523513]
curr_Stock_Price:  95.31636024978079
curr_Factors:  [95.31636025 -0.84860932 -0.97174545]
mat_Sqrt:  [[15.43822684  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01586403 0.02462924 1.17633637]
Stock Position:  0.01586403213346818
Bond Position:  [-5.77733693]


portfolio before change:  [-4.26908567]
curr_Stock_Price:  95.11916384262969
curr_Factors:  [95.11916384 -0.8324815  -0.97468428]
mat_Sqrt:  [[15.61082653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0144877  -0.05908292 -0.23783225]
Stock Position:  0.01448769733061861
Bond Position:  [-5.64714332]


portfolio before change:  [-4.26289444]
curr_Stock_Price:  95.59523444914224
curr_Factors:  [95.59523445 -0.9068518  -0.95735175]
mat_Sqrt:  [[14.8191374   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01879754 -0.0461589  -0.91635219]
Stock Position:  -0.01879754180385252
Bond Position:  [-2.46593902]


portfolio before change:  [-4.27508367]
curr_Stock_Price:  96.22728351661885
curr_Factors:  [96.22728352 -0.95820167 -0.98692969]
mat_Sqrt:  [[13.75746474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01956334 -0.12066189 -0.36401659]
Stock Position:  0.019563339296851546
Bond Position:  [-6.15761067]


portfolio before change:  [-4.28783329]
curr_Stock_Price:  95.61492011247418
curr_Factors:  [95.61492011 -0.88727682 -0.97689816]
mat_Sqrt:  [[14.82261256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00419347 -0.02811922 -0.14155446]
Stock Position:  0.004193469170950345
Bond Position:  [-4.68879151]


portfolio before change:  [-4.29514923]
curr_Stock_Price:  94.01009107012906
curr_Factors:  [94.01009107 -0.83316055 -0.95985725]
mat_Sqrt:  [[15.64864499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01175429  0.15721444  0.99362784]
Stock Position:  -0.011754294487561488
Bond Position:  [-3.19012693]


portfolio before change:  [-4.29813551]
curr_Stock_Price:  94.23022260141205
curr_Factors:  [94.2302226  -0.81089885 -0.96551456]
mat_Sqrt:  [[15.94790637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00277838 -0.17321309 -0.4408875 ]
Stock Position:  0.0027783758742261997
Bond Position:  [-4.55994249]


portfolio before change:  [-4.30028594]
curr_Stock_Price:  93.66140019166444
curr_Factors:  [93.66140019 -0.97691014 -0.90333712]
mat_Sqrt:  [[14.28826968  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00855805 -0.0651854  -0.32270956]
Stock Position:  0.008558045096457965
Bond Position:  [-5.10184443]


portfolio before change:  [-4.28909463]
curr_Stock_Price:  95.0436173143965
curr_Factors:  [95.04361731 -1.02533634 -0.92478677]
mat_Sqrt:  [[13.5205778   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02308732 -0.0404786  -0.14420965]
Stock Position:  -0.023087322509919236
Bond Position:  [-2.09479199]


portfolio before change:  [-4.25898414]
curr_Stock_Price:  93.72807446653387
curr_Factors:  [93.72807447 -1.08437769 -0.92917158]
mat_Sqrt:  [[12.51400605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02284064 0.39018707 0.73783867]
Stock Position:  0.022840642679566307
Bond Position:  [-6.3997936]


portfolio before change:  [-4.27260959]
curr_Stock_Price:  93.1665566983514
curr_Factors:  [93.1665567  -1.17424959 -0.91535722]
mat_Sqrt:  [[11.52803632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.028783   -0.02145019  0.83785359]
Stock Position:  -0.028783002325446744
Bond Position:  [-1.59099637]


portfolio before change:  [-4.2679316]
curr_Stock_Price:  92.99712065960838
curr_Factors:  [92.99712066 -1.09468331 -0.89227373]
mat_Sqrt:  [[12.75102283  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00784199 -0.02655787 -0.10560077]
Stock Position:  -0.007841989404939994
Bond Position:  [-3.53864916]


portfolio before change:  [-4.27531076]
curr_Stock_Price:  93.8816929297184
curr_Factors:  [93.88169293 -0.93374839 -0.88292723]
mat_Sqrt:  [[15.26190398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01508649 -0.01906707  0.31171907]
Stock Position:  0.01508649031440629
Bond Position:  [-5.69165601]


portfolio before change:  [-4.26988798]
curr_Stock_Price:  94.28830098037388
curr_Factors:  [94.28830098 -0.99581589 -0.90104987]
mat_Sqrt:  [[14.14684125  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0073254   0.02321364 -0.31298379]
Stock Position:  -0.007325399869298227
Bond Position:  [-3.57918847]


portfolio before change:  [-4.27287938]
curr_Stock_Price:  94.6355830635999
curr_Factors:  [94.63558306 -0.96265882 -0.91095655]
mat_Sqrt:  [[14.53294552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099814 -0.03216679  0.29058213]
Stock Position:  0.0009981426697676734
Bond Position:  [-4.3673392]


portfolio before change:  [-4.27257581]
curr_Stock_Price:  95.48669114284375
curr_Factors:  [95.48669114 -0.87013931 -0.90389055]
mat_Sqrt:  [[16.19912159  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00648567  0.0272019  -0.01417418]
Stock Position:  -0.006485667404159815
Bond Position:  [-3.65328089]


portfolio before change:  [-4.26781946]
curr_Stock_Price:  94.6829135151501
curr_Factors:  [94.68291352 -0.88890775 -0.86984701]
mat_Sqrt:  [[16.31000632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00245314 -0.05145232 -0.5623147 ]
Stock Position:  0.0024531426970441977
Bond Position:  [-4.50009016]


portfolio before change:  [-4.27064933]
curr_Stock_Price:  93.75866236690976
curr_Factors:  [93.75866237 -0.86571905 -0.86660685]
mat_Sqrt:  [[16.58333309  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00596331 -0.0047812   0.29332601]
Stock Position:  0.005963312752371064
Bond Position:  [-4.82976155]


portfolio before change:  [-4.27870234]
curr_Stock_Price:  92.50948177351897
curr_Factors:  [92.50948177 -0.72667865 -0.86769062]
mat_Sqrt:  [[18.78280594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00914116  0.01106157  0.60670779]
Stock Position:  -0.009141164405411698
Bond Position:  [-3.43305796]


portfolio before change:  [-4.28723535]
curr_Stock_Price:  93.39600412541908
curr_Factors:  [93.39600413 -0.88321603 -0.89223319]
mat_Sqrt:  [[15.82196781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03182246 -0.02677789 -1.72853653]
Stock Position:  -0.031822463201910095
Bond Position:  [-1.31514444]


portfolio before change:  [-4.2718744]
curr_Stock_Price:  92.90813031081719
curr_Factors:  [92.90813031 -0.97145403 -0.90242445]
mat_Sqrt:  [[14.26391154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01743194 -0.06718898 -0.51915008]
Stock Position:  0.01743193728886782
Bond Position:  [-5.8914431]


portfolio before change:  [-4.26091934]
curr_Stock_Price:  93.57882700930612
curr_Factors:  [93.57882701 -1.05862238 -0.9029247 ]
mat_Sqrt:  [[13.16098895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00966309  0.00246929 -0.1038102 ]
Stock Position:  0.009663089050016017
Bond Position:  [-5.16517987]


portfolio before change:  [-4.25637029]
curr_Stock_Price:  94.11641219401427
curr_Factors:  [94.11641219 -0.91790594 -0.8857497 ]
mat_Sqrt:  [[15.5005702   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00208835  0.0762709  -0.22867021]
Stock Position:  0.002088352578842496
Bond Position:  [-4.45291854]


portfolio before change:  [-4.2583186]
curr_Stock_Price:  93.45002057814689
curr_Factors:  [93.45002058 -0.76294032 -0.87762112]
mat_Sqrt:  [[18.11726434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01165413  0.01065001 -0.47204406]
Stock Position:  -0.011654126729871688
Bond Position:  [-3.16924022]


portfolio before change:  [-4.28147081]
curr_Stock_Price:  95.40263642404186
curr_Factors:  [95.40263642 -0.9856784  -0.90443194]
mat_Sqrt:  [[14.41105859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140922  0.04712915  0.27099125]
Stock Position:  -0.0014092227384493985
Bond Position:  [-4.14702725]


portfolio before change:  [-4.2817342]
curr_Stock_Price:  95.22167088231296
curr_Factors:  [95.22167088 -0.87910793 -0.87589251]
mat_Sqrt:  [[16.46450914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00797619  0.02950148  0.32035377]
Stock Position:  -0.007976193941257155
Bond Position:  [-3.52222769]


portfolio before change:  [-4.2801143]
curr_Stock_Price:  94.96337631756764
curr_Factors:  [94.96337632 -0.50482566 -0.86659457]
mat_Sqrt:  [[24.09660776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00568352 -0.02543097 -0.01706173]
Stock Position:  -0.005683523286392882
Bond Position:  [-3.74038774]


portfolio before change:  [-4.29429917]
curr_Stock_Price:  97.37689507024524
curr_Factors:  [97.37689507 -0.52584684 -0.91662394]
mat_Sqrt:  [[23.01435598  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00341089 0.01817588 0.02498074]
Stock Position:  0.0034108920965174763
Bond Position:  [-4.62644125]


portfolio before change:  [-4.2893596]
curr_Stock_Price:  98.99462872405026
curr_Factors:  [98.99462872 -0.46341759 -0.90318548]
mat_Sqrt:  [[25.24082006  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367142  0.01993242 -0.0001745 ]
Stock Position:  -0.003671421029322674
Bond Position:  [-3.92590863]


portfolio before change:  [-4.29668684]
curr_Stock_Price:  100.85670867169082
curr_Factors:  [100.85670867  -0.45104826  -0.90961838]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.29668684]
Stock Price:  101.37070054185861
PL:  [-5.66738739]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.06672752e-01  4.88233713e-02  7.02127956e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.67112479e-01  1.92996792e-01  2.45821183e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-6.61591284e-01 -2.00552420e-01  3.64859989e-02]
 [-4.04907507e-02 -2.67010970e-02 -8.75450501e-03]
 [ 3.48162830e-02 -5.27916843e-03 -2.29477041e-02]
 [ 3.13471068e-01 -3.34669132e-02 -7.45809319e-02]
 [-4.61252485e-01 -2.58796866e-02 -4.95467535e-02]
 [ 5.92827565e-02 -3.28088895e-02 -6.82685255e-02]
 [ 1.24865718e-01 -2.84496373e-01  3.03988134e-04]
 [-1.05976259e-01 -8.91730754e-02 -1.94412094e-01]
 [ 2.60877993e-01 -4.03623329e-01 -1.57251877e-01]
 [-1.01159929e-02 -1.56924575e-01 -9.04853872e-02]
 [-2.09703097e-01  3.51824994e-01  2.52528302e-01]
 [ 9.01770109e-02 -5.37960511e-01 -1.52412107e-01]
 [-7.67256794e-03 -2.48841717e-01 -4.85507754e-02]
 [-2.74709885e-01 -1.49109113e-01 -4.39167044e-02]
 [ 2.46591455e-01  1.14483723e+00  2.42790679e-01]
 [-2.39423594e-01 -3.58536912e-02  1.84375638e-01]
 [-9.51028795e-02  2.61818372e-01 -3.17223319e-02]
 [ 8.37342002e-03  1.52019848e-02  1.40777473e-02]
 [-9.34357956e-03 -2.64491068e-02 -2.30311673e-02]
 [ 4.18237851e-02  1.73789607e-01  1.07419071e-01]
 [-8.56740635e-02 -2.51600155e-02 -4.75785735e-02]
 [ 1.14136330e-01 -2.79366935e-02 -1.36158648e-02]
 [ 3.25773624e-02 -6.68306708e-02  9.30192201e-02]
 [-4.19289833e-02  4.30866095e-02  4.64241349e-02]
 [-5.58373766e-01  2.60975359e-02 -7.71018496e-01]
 [-3.85498650e-03 -1.15507054e-01 -4.52383271e-02]
 [-5.86266414e-02  7.94395461e-02  1.76953254e-01]
 [ 1.80865575e-02  8.62626396e-02 -6.16035281e-03]
 [-1.16624509e-01 -7.38368935e-03 -1.53641753e-01]
 [-6.21352641e-02  7.83567010e-02  9.82082364e-02]
 [ 9.96390569e-03 -1.90492629e-02  4.25869648e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-8.46653021e-03 -9.44086264e-03 -4.72520317e-02]
 [-8.25532722e-02  2.98156538e-02 -2.16154790e-03]
 [-4.61948670e-02 -2.87745819e-01  1.39488821e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.98536775]
curr_Stock_Price:  100.50125482051287
curr_Factors:  [100.50125482  -0.79124607  -1.00504105]
mat_Sqrt:  [[16.67454139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00546222  0.01543931  0.20029756]
Stock Position:  -0.005462219845018605
Bond Position:  [6.5343277]


portfolio before change:  [5.99018932]
curr_Stock_Price:  99.76808658177781
curr_Factors:  [99.76808658 -0.73402615 -1.0071111 ]
mat_Sqrt:  [[17.49143105  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259447  0.01411938  0.0859571 ]
Stock Position:  -0.002594472843495919
Bond Position:  [6.24903491]


portfolio before change:  [5.98987709]
curr_Stock_Price:  100.18952103908288
curr_Factors:  [100.18952104  -0.92191634  -1.00708678]
mat_Sqrt:  [[14.55683267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.022139   0.06103094 0.70125941]
Stock Position:  0.02213899690872428
Bond Position:  [3.7717816]


portfolio before change:  [6.00660302]
curr_Stock_Price:  100.9237198199818
curr_Factors:  [100.92371982  -1.10615629  -1.02118012]
mat_Sqrt:  [[12.02549011  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00163844 -0.00659539  0.21422481]
Stock Position:  0.0016384408226619155
Bond Position:  [5.84124548]


portfolio before change:  [6.00679389]
curr_Stock_Price:  100.59454335307217
curr_Factors:  [100.59454335  -0.80285755  -1.0309675 ]
mat_Sqrt:  [[16.07512374  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04101504 -0.06342024  0.1040844 ]
Stock Position:  -0.041015040527000175
Bond Position:  [10.13268316]


portfolio before change:  [5.99207062]
curr_Stock_Price:  100.98439873253307
curr_Factors:  [100.98439873  -0.68488548  -1.05514329]
mat_Sqrt:  [[17.72431223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242419 -0.00844363 -0.02497417]
Stock Position:  -0.0024241942584147264
Bond Position:  [6.23687642]


portfolio before change:  [5.99538971]
curr_Stock_Price:  99.9368622182534
curr_Factors:  [99.93686222 -0.78352876 -1.03858045]
mat_Sqrt:  [[16.15822813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185638 -0.00166942 -0.06546341]
Stock Position:  0.001856378974267471
Bond Position:  [5.80986902]


portfolio before change:  [5.99672094]
curr_Stock_Price:  100.26274277500377
curr_Factors:  [100.26274278  -1.10091638  -1.04517217]
mat_Sqrt:  [[11.7247926   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02536362 -0.01058317 -0.21275864]
Stock Position:  0.025363620274153138
Bond Position:  [3.45369481]


portfolio before change:  [5.9987803]
curr_Stock_Price:  100.3269140312911
curr_Factors:  [100.32691403  -0.85850336  -1.04544859]
mat_Sqrt:  [[14.94657294  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03158145 -0.00818388 -0.1413431 ]
Stock Position:  -0.03158144590430851
Bond Position:  [9.16724931]


portfolio before change:  [6.03631119]
curr_Stock_Price:  99.17481634001986
curr_Factors:  [99.17481634 -0.84203974 -1.03031821]
mat_Sqrt:  [[15.24918655  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00291821 -0.01037508 -0.1947511 ]
Stock Position:  0.002918213378484584
Bond Position:  [5.74689791]


portfolio before change:  [6.03311798]
curr_Stock_Price:  97.8344027084941
curr_Factors:  [97.83440271 -0.62264447 -1.00228807]
mat_Sqrt:  [[19.26603573  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00610308 -0.08996565  0.00086719]
Stock Position:  0.00610307725947277
Bond Position:  [5.43602706]


portfolio before change:  [6.03162212]
curr_Stock_Price:  97.47795781629569
curr_Factors:  [97.47795782 -0.44909128 -1.02991068]
mat_Sqrt:  [[22.21181427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00666145 -0.028199   -0.55460359]
Stock Position:  -0.006661450470710262
Bond Position:  [6.6809667]


portfolio before change:  [6.05207232]
curr_Stock_Price:  94.53340000004566
curr_Factors:  [94.5334     -0.26394386 -1.0224428 ]
mat_Sqrt:  [[26.11648038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00836091 -0.1276369  -0.44859584]
Stock Position:  0.00836091139557598
Bond Position:  [5.26168693]


portfolio before change:  [6.05365883]
curr_Stock_Price:  94.64448374157243
curr_Factors:  [94.64448374 -0.43679362 -1.01748111]
mat_Sqrt:  [[22.10608422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00147643 -0.04962391 -0.25812962]
Stock Position:  -0.0014764270324488708
Bond Position:  [6.1933945]


portfolio before change:  [6.05293086]
curr_Stock_Price:  95.66193704058092
curr_Factors:  [95.66193704 -0.57793798 -0.98857305]
mat_Sqrt:  [[19.9715639   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00746421  0.11125683  0.72039296]
Stock Position:  -0.007464207181372194
Bond Position:  [6.76697137]


portfolio before change:  [6.0604785]
curr_Stock_Price:  94.76408991229661
curr_Factors:  [94.76408991 -0.45339974 -1.00324622]
mat_Sqrt:  [[22.08159766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00204586 -0.17011805 -0.43478932]
Stock Position:  0.0020458637061507943
Bond Position:  [5.86660409]


portfolio before change:  [6.06451538]
curr_Stock_Price:  96.37881734079289
curr_Factors:  [96.37881734 -0.34070808 -1.00077549]
mat_Sqrt:  [[25.19896371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095274 -0.07869066 -0.13850185]
Stock Position:  -0.0009527383452885118
Bond Position:  [6.15633918]


portfolio before change:  [6.06500235]
curr_Stock_Price:  96.67546094141838
curr_Factors:  [96.67546094 -0.37151417 -1.0007699 ]
mat_Sqrt:  [[24.50986126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01173097 -0.04715244 -0.12528213]
Stock Position:  -0.011730965033417647
Bond Position:  [7.1990988]


portfolio before change:  [6.0575257]
curr_Stock_Price:  97.38951917546794
curr_Factors:  [97.38951918 -0.42594618 -1.02268732]
mat_Sqrt:  [[22.8759262   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01423813 0.36202932 0.69261423]
Stock Position:  0.014238132363794223
Bond Position:  [4.67088083]


portfolio before change:  [6.07456607]
curr_Stock_Price:  98.54532221411148
curr_Factors:  [98.54532221 -0.51706947 -1.03644251]
mat_Sqrt:  [[20.84271703  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00972588 -0.01133793  0.52597237]
Stock Position:  -0.009725882292868235
Bond Position:  [7.03300628]


portfolio before change:  [6.07251515]
curr_Stock_Price:  98.84659113793322
curr_Factors:  [98.84659114 -0.76202324 -1.0262037 ]
mat_Sqrt:  [[16.53273113  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00573517  0.08279424 -0.09049498]
Stock Position:  -0.005735171726121353
Bond Position:  [6.63941732]


portfolio before change:  [6.07574648]
curr_Stock_Price:  98.42788384519096
curr_Factors:  [98.42788385 -0.7354653  -1.00551308]
mat_Sqrt:  [[17.25920732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0006744  0.00480729 0.04015989]
Stock Position:  0.0006743960776783943
Bond Position:  [6.00936711]


portfolio before change:  [6.07663019]
curr_Stock_Price:  98.62433247485919
curr_Factors:  [98.62433247 -0.75107965 -1.04081295]
mat_Sqrt:  [[16.43520057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00089611 -0.00836394 -0.06570151]
Stock Position:  -0.0008961077069662748
Bond Position:  [6.16500821]


portfolio before change:  [6.07672606]
curr_Stock_Price:  99.3773631685431
curr_Factors:  [99.37736317 -0.85040673 -1.04111351]
mat_Sqrt:  [[14.99031169  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00455213 0.0549571  0.30643671]
Stock Position:  0.004552129457887698
Bond Position:  [5.62434744]


portfolio before change:  [6.07452743]
curr_Stock_Price:  98.73992049766571
curr_Factors:  [98.7399205  -1.10562743 -1.03917575]
mat_Sqrt:  [[11.56156407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00830646 -0.0079563  -0.13572843]
Stock Position:  -0.008306456409607648
Bond Position:  [6.89470628]


portfolio before change:  [6.07590955]
curr_Stock_Price:  98.6772915522097
curr_Factors:  [98.67729155 -1.09926537 -1.01557862]
mat_Sqrt:  [[11.90562351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00929272 -0.00883436 -0.03884227]
Stock Position:  0.00929272460381233
Bond Position:  [5.15892865]


portfolio before change:  [6.07166137]
curr_Stock_Price:  98.15074202048295
curr_Factors:  [98.15074202 -0.89844988 -1.02147027]
mat_Sqrt:  [[14.39073111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00346329 -0.02113371  0.26535794]
Stock Position:  0.0034632896902372988
Bond Position:  [5.73173692]


portfolio before change:  [6.06938071]
curr_Stock_Price:  97.28533020315112
curr_Factors:  [97.2853302  -0.78573884 -1.0139915 ]
mat_Sqrt:  [[16.08549401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194835  0.01362518  0.13243513]
Stock Position:  -0.0019483520317151453
Bond Position:  [6.25892678]


portfolio before change:  [6.06915034]
curr_Stock_Price:  97.80514815153765
curr_Factors:  [97.80514815 -0.76605969 -1.00538709]
mat_Sqrt:  [[16.63535809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04298575  0.00825277 -2.19950116]
Stock Position:  -0.04298575467619747
Bond Position:  [10.27337844]


portfolio before change:  [6.04125619]
curr_Stock_Price:  98.4839404214411
curr_Factors:  [98.48394042 -0.85305811 -1.00947813]
mat_Sqrt:  [[15.29241946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105095 -0.03652654 -0.12905236]
Stock Position:  -0.0010509521204059454
Bond Position:  [6.1447581]


portfolio before change:  [6.04131885]
curr_Stock_Price:  99.15522080259571
curr_Factors:  [99.1552208  -0.80912443 -1.02333267]
mat_Sqrt:  [[15.86680846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00128917  0.02512099  0.50479838]
Stock Position:  -0.001289174788834561
Bond Position:  [6.16914726]


portfolio before change:  [6.0420325]
curr_Stock_Price:  99.19986147962233
curr_Factors:  [99.19986148 -0.7992389  -1.02125292]
mat_Sqrt:  [[16.06502896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011862   0.02727864 -0.01757377]
Stock Position:  0.0011862021912293532
Bond Position:  [5.9243614]


portfolio before change:  [6.04141487]
curr_Stock_Price:  98.05484601870063
curr_Factors:  [98.05484602 -0.69209042 -1.0180563 ]
mat_Sqrt:  [[17.73216564  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0083564  -0.00233493 -0.43829716]
Stock Position:  -0.008356404349011982
Bond Position:  [6.86080081]


portfolio before change:  [6.03882858]
curr_Stock_Price:  98.46697735282353
curr_Factors:  [98.46697735 -0.82030027 -1.05756245]
mat_Sqrt:  [[15.05723368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266088  0.02477856  0.28016076]
Stock Position:  -0.0026608759145291634
Bond Position:  [6.30083699]


portfolio before change:  [6.03802013]
curr_Stock_Price:  99.06681963933136
curr_Factors:  [99.06681964 -0.62639477 -1.04727134]
mat_Sqrt:  [[18.58079394  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00097763 -0.00602391  0.12148876]
Stock Position:  0.0009776268801751603
Bond Position:  [5.94116975]


portfolio before change:  [6.04052047]
curr_Stock_Price:  100.86468911065631
curr_Factors:  [100.86468911  -0.81145097  -1.06119519]
mat_Sqrt:  [[15.50455339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00158095 0.00777784 0.21633947]
Stock Position:  0.0015809474179730458
Bond Position:  [5.8810587]


portfolio before change:  [6.04265171]
curr_Stock_Price:  101.74774361104696
curr_Factors:  [101.74774361  -0.94244278  -1.0889911 ]
mat_Sqrt:  [[13.34394558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137557 -0.00298546 -0.13479689]
Stock Position:  -0.0013755731175032558
Bond Position:  [6.18261317]


portfolio before change:  [6.04326138]
curr_Stock_Price:  101.8663879951006
curr_Factors:  [101.866388    -1.04049758  -1.08943361]
mat_Sqrt:  [[12.10635885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00679186  0.00942854 -0.00616629]
Stock Position:  -0.006791857111586653
Bond Position:  [6.73512333]


portfolio before change:  [6.04544861]
curr_Stock_Price:  101.66831500747683
curr_Factors:  [101.66831501  -1.19638258  -1.10392268]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.04544861]
Stock Price:  102.25004574433578
PL:  [3.79540286]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-8.42085537e-02 -1.10494919e-02 -1.87745774e-03]
 [-4.33920652e-02  2.99328045e-02  3.90272628e-03]
 [ 2.08205240e-01 -3.52538794e-01 -5.84680462e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.21994547e+00 -3.58712773e-01  2.28412570e-02]
 [-5.90822709e-02  8.96029004e-03  4.53264326e-02]
 [ 1.96757643e-02  1.08053192e-01  2.76511471e-02]
 [ 3.58303509e-01  4.98839089e-03 -9.53148200e-02]
 [-4.90104173e-01 -2.83922580e-02 -5.18033537e-02]
 [ 5.02618809e-02 -2.21576546e-02 -4.36853247e-02]
 [ 3.61340847e-02 -3.09832796e-01  8.59112439e-02]
 [ 1.15719869e-02 -2.01748734e-02 -3.85167927e-02]
 [ 2.16605906e-01 -1.99207141e-01  1.15519597e-01]
 [ 9.43329306e-02 -4.90320971e-02 -6.26709955e-02]
 [ 2.36520899e-02 -7.28373073e-02 -3.45541150e-02]
 [-2.30206681e-02 -8.29233586e-02 -2.19484500e-03]
 [-4.40547707e-01 -2.57024055e-01  1.16339562e-01]
 [-1.81373058e-01 -3.28451281e-02 -2.75354648e-02]
 [ 2.79794662e-01  1.22085296e+00  3.89794915e-01]
 [-1.85271519e-01 -2.76704127e-02  1.44881783e-01]
 [-9.61644276e-02  2.96252508e-01 -3.01077216e-02]
 [-1.11316431e-02  3.08780701e-02 -2.28234261e-03]
 [ 1.80999261e-02 -3.08334086e-02  6.18939452e-03]
 [ 6.05913232e-02  2.70488503e-01  1.04020155e-01]
 [-9.38231198e-02 -2.14010831e-02  3.37783797e-02]
 [ 1.14823440e-01 -8.97200062e-03 -6.94089367e-03]
 [ 3.18899044e-02 -6.69976557e-02  8.84125888e-02]
 [ 2.05963148e-02  4.20923395e-02 -6.09130059e-02]
 [-6.60303353e-01 -6.51993434e-02 -1.00417904e+00]
 [-2.22040331e-01  1.00767046e-02  2.54772987e-02]
 [ 3.17594732e-03  3.09116245e-02  1.26087891e-01]
 [ 1.97736083e-02  8.62702319e-02 -5.77020470e-03]
 [-1.27527327e-01 -1.29538822e-02 -9.70845507e-02]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 2.03647560e-01 -1.69759353e-01 -8.38279830e-02]
 [-1.17525752e-02  1.69162671e-01  8.06831489e-02]
 [ 9.12266952e-02  7.49838892e-02 -2.81245811e-02]
 [-2.00150407e-02  6.77688188e-02 -1.04282473e-02]
 [-1.23444398e-01 -2.48467828e-01  5.07830602e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.1136504]
curr_Stock_Price:  100.65845840317162
curr_Factors:  [100.6584584   -1.11533736  -1.01737813]
mat_Sqrt:  [[11.92954024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00711487 -0.00349416 -0.00535586]
Stock Position:  -0.007114866384170994
Bond Position:  [7.82982188]


portfolio before change:  [7.10815679]
curr_Stock_Price:  101.56815884974185
curr_Factors:  [101.56815885  -1.29690831  -1.01590893]
mat_Sqrt:  [[10.05341969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416003  0.00946558  0.01113339]
Stock Position:  -0.004160033517215991
Bond Position:  [7.53068373]


portfolio before change:  [7.11023743]
curr_Stock_Price:  101.29430255085302
curr_Factors:  [101.29430255  -1.50353777  -1.01027689]
mat_Sqrt:  [[ 8.20066711  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00972547 -0.11148256 -1.66793061]
Stock Position:  0.009725468275957591
Bond Position:  [6.12510291]


portfolio before change:  [7.11433374]
curr_Stock_Price:  101.63676604167571
curr_Factors:  [101.63676604  -1.3228565   -0.97798309]
mat_Sqrt:  [[10.18143288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193519 -0.00659539  0.21422481]
Stock Position:  0.0019351945982848397
Bond Position:  [6.91764682]


portfolio before change:  [7.11424943]
curr_Stock_Price:  101.14634210502385
curr_Factors:  [101.14634211  -1.42923929  -0.98540589]
mat_Sqrt:  [[ 9.04238734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.13542275 -0.11343494  0.06515975]
Stock Position:  -0.13542274768245272
Bond Position:  [20.811765]


portfolio before change:  [7.15293375]
curr_Stock_Price:  100.87989732853542
curr_Factors:  [100.87989733  -1.45785034  -0.97067643]
mat_Sqrt:  [[ 8.8942402   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0055765   0.00283349  0.1293037 ]
Stock Position:  -0.005576496335252219
Bond Position:  [7.71549013]


portfolio before change:  [7.15200992]
curr_Stock_Price:  101.21851960312863
curr_Factors:  [101.2185196   -1.32179617  -0.97177792]
mat_Sqrt:  [[10.21347217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00275224 0.03416942 0.07888103]
Stock Position:  0.0027522425292235155
Bond Position:  [6.873432]


portfolio before change:  [7.15210794]
curr_Stock_Price:  100.9419399718563
curr_Factors:  [100.94193997  -1.33875168  -0.98817647]
mat_Sqrt:  [[ 9.85143717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03440881  0.00157747 -0.27190665]
Stock Position:  0.03440881230011118
Bond Position:  [3.67881567]


portfolio before change:  [7.1566163]
curr_Stock_Price:  101.0595982191745
curr_Factors:  [101.05959822  -1.02170334  -0.99191271]
mat_Sqrt:  [[13.4919656   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03716372 -0.00897842 -0.14778055]
Stock Position:  -0.037163715644631536
Bond Position:  [10.91236647]


portfolio before change:  [7.18917873]
curr_Stock_Price:  100.22011537735807
curr_Factors:  [100.22011538  -0.910367    -1.01755235]
mat_Sqrt:  [[14.57706743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00279703 -0.00700687 -0.12462207]
Stock Position:  0.0027970333071866225
Bond Position:  [6.90885973]


portfolio before change:  [7.1894413]
curr_Stock_Price:  100.00521116585399
curr_Factors:  [100.00521117  -0.74997235  -1.0296036 ]
mat_Sqrt:  [[16.87184648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00270692 -0.09797773  0.24508087]
Stock Position:  0.0027069233681389572
Bond Position:  [6.91873486]


portfolio before change:  [7.1872456]
curr_Stock_Price:  98.87455529901358
curr_Factors:  [98.8745553  -0.95071858 -1.01153859]
mat_Sqrt:  [[13.89591275  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00022948 -0.00637986 -0.10987769]
Stock Position:  0.00022948233329671462
Bond Position:  [7.16455563]


portfolio before change:  [7.18813869]
curr_Stock_Price:  98.86351253846928
curr_Factors:  [98.86351254 -0.89356934 -0.97161324]
mat_Sqrt:  [[15.3107877   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01535145 -0.06299483  0.32954526]
Stock Position:  0.015351446528088052
Bond Position:  [5.67044076]


portfolio before change:  [7.19050501]
curr_Stock_Price:  98.97148106080704
curr_Factors:  [98.97148106 -1.07108277 -0.99214349]
mat_Sqrt:  [[12.57367677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00638431 -0.01550531 -0.17878291]
Stock Position:  0.006384311080033294
Bond Position:  [6.55864029]


portfolio before change:  [7.19304312]
curr_Stock_Price:  99.24061468813706
curr_Factors:  [99.24061469 -1.09276336 -1.00547898]
mat_Sqrt:  [[12.17403023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120898 -0.02303318 -0.09857327]
Stock Position:  0.0012089759334106213
Bond Position:  [7.07306361]


portfolio before change:  [7.19326915]
curr_Stock_Price:  98.69622111745514
curr_Factors:  [98.69622112 -1.05575726 -1.00948614]
mat_Sqrt:  [[12.51343985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204658 -0.02622267 -0.00626128]
Stock Position:  -0.0020465804146022988
Bond Position:  [7.39525891]


portfolio before change:  [7.19265951]
curr_Stock_Price:  99.44581877195813
curr_Factors:  [99.44581877 -1.00712363 -0.99980271]
mat_Sqrt:  [[13.36563183  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03168098 -0.08127814  0.33188439]
Stock Position:  -0.03168098080357386
Bond Position:  [10.34320058]


portfolio before change:  [7.18724196]
curr_Stock_Price:  99.6576344141045
curr_Factors:  [99.65763441 -0.71966452 -1.00607042]
mat_Sqrt:  [[17.74325974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01058665 -0.01038654 -0.07855102]
Stock Position:  -0.01058665494482203
Bond Position:  [8.24228295]


portfolio before change:  [7.18176834]
curr_Stock_Price:  100.27198949196526
curr_Factors:  [100.27198949  -0.77623913  -1.02930664]
mat_Sqrt:  [[16.48318245  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02371408 0.38606761 1.11197639]
Stock Position:  0.02371407977030111
Bond Position:  [4.80391039]


portfolio before change:  [7.15393335]
curr_Stock_Price:  99.07289072973187
curr_Factors:  [99.07289073 -0.77330067 -1.0187663 ]
mat_Sqrt:  [[16.50707168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00947546 -0.00875015  0.4133074 ]
Stock Position:  -0.009475459930167011
Bond Position:  [8.09269455]


portfolio before change:  [7.15804002]
curr_Stock_Price:  98.74625506352292
curr_Factors:  [98.74625506 -0.60169861 -1.03274507]
mat_Sqrt:  [[19.26152925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00491451  0.09368327 -0.08588895]
Stock Position:  -0.004914507692043102
Bond Position:  [7.64332925]


portfolio before change:  [7.15686332]
curr_Stock_Price:  99.18010836042787
curr_Factors:  [99.18010836 -0.69090216 -1.06664453]
mat_Sqrt:  [[17.10534143  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006314   0.0097645  -0.00651089]
Stock Position:  -0.0006313966931790036
Bond Position:  [7.21948531]


portfolio before change:  [7.15788399]
curr_Stock_Price:  98.99294560424848
curr_Factors:  [98.9929456  -0.53602478 -1.06748157]
mat_Sqrt:  [[19.91637463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00093226 -0.00975038  0.01765662]
Stock Position:  0.0009322588160019331
Bond Position:  [7.06559694]


portfolio before change:  [7.15954535]
curr_Stock_Price:  99.82759328937414
curr_Factors:  [99.82759329 -0.37141419 -1.09037955]
mat_Sqrt:  [[23.14204034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00383753 0.08553598 0.29674055]
Stock Position:  0.0038375324815597737
Bond Position:  [6.77645372]


portfolio before change:  [7.15557606]
curr_Stock_Price:  98.57251519503149
curr_Factors:  [98.5725152  -0.55985421 -1.05772724]
mat_Sqrt:  [[19.55460912  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00447366 -0.00676762  0.09636032]
Stock Position:  -0.004473661937249395
Bond Position:  [7.59655617]


portfolio before change:  [7.15501298]
curr_Stock_Price:  98.91065094462547
curr_Factors:  [98.91065094 -0.53139787 -1.0642776 ]
mat_Sqrt:  [[20.05626252  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00564287 -0.0028372  -0.01980044]
Stock Position:  0.00564287485938412
Bond Position:  [6.59687255]


portfolio before change:  [7.16518174]
curr_Stock_Price:  100.56656298879982
curr_Factors:  [100.56656299  -0.69495056  -1.10670307]
mat_Sqrt:  [[16.5960746   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00290473 -0.02118652  0.25221651]
Stock Position:  0.0029047336600782725
Bond Position:  [6.87306266]


portfolio before change:  [7.16421732]
curr_Stock_Price:  99.93875752870903
curr_Factors:  [99.93875753 -0.55828023 -1.08509846]
mat_Sqrt:  [[19.3207351   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047873  0.01331077 -0.17376785]
Stock Position:  0.00047872500824437854
Bond Position:  [7.11637414]


portfolio before change:  [7.16518377]
curr_Stock_Price:  100.09927823567203
curr_Factors:  [100.09927824  -0.25771507  -1.06140695]
mat_Sqrt:  [[26.76353844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03239347 -0.02061784 -2.86464329]
Stock Position:  -0.03239347378066572
Bond Position:  [10.40774712]


portfolio before change:  [7.1146381]
curr_Stock_Price:  101.69980820248696
curr_Factors:  [101.6998082   -0.38221242  -1.04647452]
mat_Sqrt:  [[24.36964945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00888727  0.00318653  0.07267964]
Stock Position:  -0.00888726858814386
Bond Position:  [8.01847161]


portfolio before change:  [7.10840892]
curr_Stock_Price:  102.51350568292666
curr_Factors:  [102.51350568  -0.53539447  -1.04904462]
mat_Sqrt:  [[21.02170471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00141338 0.00977511 0.35969366]
Stock Position:  0.001413380381740615
Bond Position:  [6.96351834]


portfolio before change:  [7.10783926]
curr_Stock_Price:  101.49456609674387
curr_Factors:  [101.4945661   -0.37706653  -1.04141739]
mat_Sqrt:  [[24.56988097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084751  0.02728104 -0.01646079]
Stock Position:  0.0008475115523942484
Bond Position:  [7.02182145]


portfolio before change:  [7.10990782]
curr_Stock_Price:  102.89959192721608
curr_Factors:  [102.89959193  -0.73368624  -1.02252881]
mat_Sqrt:  [[17.77047947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00831036 -0.00409638 -0.2769552 ]
Stock Position:  -0.008310360757862036
Bond Position:  [7.96504055]


portfolio before change:  [7.1108144]
curr_Stock_Price:  102.9103154249832
curr_Factors:  [102.91031542  -0.60601952  -1.03709832]
mat_Sqrt:  [[19.90040413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026338   0.0049611   0.16678008]
Stock Position:  -0.0026338009634815284
Bond Position:  [7.38185969]


portfolio before change:  [7.11036156]
curr_Stock_Price:  103.43261447879352
curr_Factors:  [103.43261448  -0.67564926  -1.03716073]
mat_Sqrt:  [[18.65492798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00976434 -0.05368262 -0.2391379 ]
Stock Position:  0.00976434093507446
Bond Position:  [6.10041025]


portfolio before change:  [7.11377307]
curr_Stock_Price:  103.70389892942572
curr_Factors:  [103.70389893  -0.59559825  -1.01611796]
mat_Sqrt:  [[20.6935799   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.000439   0.05349393 0.23016657]
Stock Position:  0.0004390040319837462
Bond Position:  [7.06824664]


portfolio before change:  [7.11540224]
curr_Stock_Price:  105.40224196976975
curr_Factors:  [105.40224197  -0.73269072  -1.03621673]
mat_Sqrt:  [[17.97310469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00486404  0.02371199 -0.0802316 ]
Stock Position:  0.0048640380344122615
Bond Position:  [6.60272172]


portfolio before change:  [7.11900911]
curr_Stock_Price:  105.97408918587402
curr_Factors:  [105.97408919  -0.65231605  -1.01983185]
mat_Sqrt:  [[19.906508    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102448  0.02143038 -0.02974889]
Stock Position:  -0.0010244847738405923
Bond Position:  [7.22757795]


portfolio before change:  [7.11935504]
curr_Stock_Price:  106.51833577369945
curr_Factors:  [106.51833577  -0.31555665  -1.02102457]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.11935504]
Stock Price:  104.98304264224925
PL:  [2.1363124]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-3.18918924e-02  1.75939708e-01  8.69090793e-02]
 [-6.65909664e-02  1.01063643e-01  2.11989659e-01]
 [ 2.63795252e-01 -5.85097586e-01 -9.82170923e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.47560616e+00 -4.21084046e-01 -3.87854394e-02]
 [-8.12439008e-02  4.08279062e-02  8.72221257e-02]
 [ 1.20001613e-02  1.36638977e-01  5.63959166e-02]
 [ 3.31277453e-01 -4.97123741e-02 -7.96619672e-02]
 [-5.53654002e-01 -2.85713708e-02 -7.93220715e-02]
 [-1.32840773e-02  7.36879750e-02  5.11344937e-03]
 [-2.41957618e-03 -2.64015514e-01  1.88975411e-01]
 [-2.01233837e-01  3.12979176e-02  1.68692576e-01]
 [ 3.51314410e-02  6.54978257e-02  1.80048897e-01]
 [-4.31722354e-02  8.60612176e-01  8.13241363e-01]
 [ 1.44698767e-01 -1.33120607e-01 -6.60132193e-02]
 [-3.95568060e-03 -3.71549931e-02  3.15972761e-02]
 [-6.30205945e-01 -1.11560622e-01  2.13443760e-01]
 [-1.13716934e-01  1.92528158e-02 -3.16735239e-02]
 [-4.60071985e-02  4.34934720e-01 -4.07155211e-03]
 [-3.15333253e-02  5.41106384e-02  2.46341007e-02]
 [ 2.18484497e-01 -1.53383207e-01  3.00010925e-01]
 [-3.57267459e-02  6.04478116e-02 -3.21167713e-02]
 [ 3.33000908e-01  4.49680163e-02  2.90672629e-01]
 [ 5.75681587e-02 -1.22828614e-01 -2.38878190e-02]
 [-1.20350603e-01  2.45309844e-01  2.56045360e-01]
 [ 5.33360639e-03  6.15892690e-02  5.82904572e-02]
 [-2.13728013e-01 -1.30348825e-01  4.84048528e-01]
 [ 1.58672206e-01  9.30625993e-02 -1.08552937e-01]
 [-9.55215284e-01 -1.52342666e-01 -1.30325803e+00]
 [ 1.49930401e-01 -4.20486698e-01  4.05115876e-01]
 [-1.64439461e-01 -3.10262137e-01  1.52695970e-01]
 [ 1.54146693e-01  5.06359674e-01 -1.30148569e-01]
 [-8.05654796e-02  8.17713120e-03  9.41737793e-02]
 [ 7.45834391e-02  6.71216147e-01 -2.64782280e-01]
 [ 5.97162779e-02 -1.70166683e-01 -1.86392173e-01]
 [-7.37839183e-02  4.43839057e-01  8.97009782e-02]
 [ 2.45695838e-01  1.71859124e-01  1.24195498e-02]
 [ 5.50058040e-02  2.16391098e-02 -1.42202068e-02]
 [-2.18174766e-01 -4.77193351e-01  1.04191618e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.15273648]
curr_Stock_Price:  101.49988406112047
curr_Factors:  [101.49988406  -0.77553936  -1.01684813]
mat_Sqrt:  [[16.90602672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056837  0.05563702  0.24792741]
Stock Position:  -0.0005683717003845979
Bond Position:  [13.21042614]


portfolio before change:  [13.15379027]
curr_Stock_Price:  102.5513397774194
curr_Factors:  [102.55133978  -1.20654676  -0.99355955]
mat_Sqrt:  [[11.36180447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182271  0.03195913  0.60474749]
Stock Position:  -0.0018227128062608302
Bond Position:  [13.34071191]


portfolio before change:  [13.15606288]
curr_Stock_Price:  102.21946401293066
curr_Factors:  [102.21946401  -1.55987907  -0.94321601]
mat_Sqrt:  [[ 8.36475484  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00576267 -0.1850241  -2.80186026]
Stock Position:  0.005762667089599954
Bond Position:  [12.56700614]


portfolio before change:  [13.15773931]
curr_Stock_Price:  102.2377632918061
curr_Factors:  [102.23776329  -1.59044069  -0.92977315]
mat_Sqrt:  [[ 8.22425141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239573 -0.00659539  0.21422481]
Stock Position:  0.002395726117459178
Bond Position:  [12.91280563]


portfolio before change:  [13.15888952]
curr_Stock_Price:  102.04409219518745
curr_Factors:  [102.0440922   -1.6101603   -0.94798841]
mat_Sqrt:  [[ 7.90310949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.18908957 -0.13315847 -0.11064406]
Stock Position:  -0.18908956613556088
Bond Position:  [32.45436264]


portfolio before change:  [13.205609]
curr_Stock_Price:  101.81847201089607
curr_Factors:  [101.81847201  -1.52690938  -0.98012756]
mat_Sqrt:  [[ 8.29916242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00751709  0.01291092  0.24882045]
Stock Position:  -0.007517094356181444
Bond Position:  [13.97098806]


portfolio before change:  [13.20707319]
curr_Stock_Price:  101.85602509090918
curr_Factors:  [101.85602509  -1.15370441  -0.94360878]
mat_Sqrt:  [[12.50648254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00216207 0.04320904 0.16088185]
Stock Position:  0.0021620733632021247
Bond Position:  [12.98685299]


portfolio before change:  [13.20912328]
curr_Stock_Price:  102.05335176680312
curr_Factors:  [102.05335177  -1.06177245  -0.89788627]
mat_Sqrt:  [[14.37998073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02181734 -0.01572043 -0.22725342]
Stock Position:  0.02181734176136622
Bond Position:  [10.98259043]


portfolio before change:  [13.2385466]
curr_Stock_Price:  103.33904496014317
curr_Factors:  [103.33904496  -0.97788359  -0.89505587]
mat_Sqrt:  [[15.88024403  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03593038 -0.00903506 -0.22628379]
Stock Position:  -0.03593038369634638
Bond Position:  [16.95155814]


portfolio before change:  [13.20958341]
curr_Stock_Price:  104.20411422893473
curr_Factors:  [104.20411423  -0.89717081  -0.90843705]
mat_Sqrt:  [[17.12850009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060354  0.02330218  0.01458725]
Stock Position:  -0.000603536998302536
Bond Position:  [13.27247444]


portfolio before change:  [13.21138565]
curr_Stock_Price:  103.96704473223582
curr_Factors:  [103.96704473  -0.78064134  -0.89972269]
mat_Sqrt:  [[19.36969909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00151463 -0.08348904  0.53909425]
Stock Position:  0.0015146346175859953
Bond Position:  [13.05391356]


portfolio before change:  [13.21321802]
curr_Stock_Price:  104.09943824447173
curr_Factors:  [104.09943824  -0.89527943  -0.92670914]
mat_Sqrt:  [[16.83328217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00986091  0.00989727  0.48123296]
Stock Position:  -0.009860911168313077
Bond Position:  [14.23973333]


portfolio before change:  [13.20052602]
curr_Stock_Price:  105.56705874363698
curr_Factors:  [105.56705874  -0.96571999  -0.92685724]
mat_Sqrt:  [[15.90715714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00462527 0.02071223 0.51362939]
Stock Position:  0.004625271128581701
Bond Position:  [12.71224975]


portfolio before change:  [13.20687919]
curr_Stock_Price:  106.59706091720717
curr_Factors:  [106.59706092  -0.81448289  -0.92919878]
mat_Sqrt:  [[18.64120157  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0077812  0.27214947 2.31995125]
Stock Position:  0.0077811976287879125
Bond Position:  [12.37742639]


portfolio before change:  [13.22173433]
curr_Stock_Price:  108.30731981668903
curr_Factors:  [108.30731982  -0.98573049  -0.95857964]
mat_Sqrt:  [[15.49725029  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00824577 -0.04209643 -0.18831734]
Stock Position:  0.008245767039105274
Bond Position:  [12.3286574]


portfolio before change:  [13.22649704]
curr_Stock_Price:  108.69800923219238
curr_Factors:  [108.69800923  -0.77946084  -0.95742787]
mat_Sqrt:  [[19.13816997  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.01930690e-05 -1.17494405e-02  9.01382339e-02]
Stock Position:  8.019306898858051e-05
Bond Position:  [13.21778021]


portfolio before change:  [13.22812009]
curr_Stock_Price:  108.33289679524346
curr_Factors:  [108.3328968   -0.91775389  -0.96495856]
mat_Sqrt:  [[16.48575077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03575921 -0.03527857  0.60889564]
Stock Position:  -0.035759208719978626
Bond Position:  [17.10201875]


portfolio before change:  [13.24987164]
curr_Stock_Price:  107.78440403142206
curr_Factors:  [107.78440403  -0.81659568  -0.92897572]
mat_Sqrt:  [[18.81325321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00636175  0.00608827 -0.09035575]
Stock Position:  -0.006361747123543598
Bond Position:  [13.93556876]


portfolio before change:  [13.25112689]
curr_Stock_Price:  107.86092418913118
curr_Factors:  [107.86092419  -0.84206739  -0.95010604]
mat_Sqrt:  [[17.96938056  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198161  0.13753843 -0.011615  ]
Stock Position:  -0.001981611683141684
Bond Position:  [13.46486536]


portfolio before change:  [13.24740322]
curr_Stock_Price:  110.58945175634854
curr_Factors:  [110.58945176  -1.05368375  -0.9500184 ]
mat_Sqrt:  [[14.91134844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016838   0.01711129  0.07027423]
Stock Position:  -0.0016838034486364101
Bond Position:  [13.43361412]


portfolio before change:  [13.25023762]
curr_Stock_Price:  109.90345103146345
curr_Factors:  [109.90345103  -0.87225988  -0.94739594]
mat_Sqrt:  [[17.81331922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01548076 -0.04850403  0.85584766]
Stock Position:  0.015480755146053633
Bond Position:  [11.54884921]


portfolio before change:  [13.24310857]
curr_Stock_Price:  109.34968318389451
curr_Factors:  [109.34968318  -0.73418395  -0.92497423]
mat_Sqrt:  [[20.80914735  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195692  0.01911528 -0.09162021]
Stock Position:  -0.0019569181735818197
Bond Position:  [13.45709695]


portfolio before change:  [13.24540831]
curr_Stock_Price:  109.03414004967846
curr_Factors:  [109.03414005  -0.69943509  -0.94422919]
mat_Sqrt:  [[21.0730877   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01867288 0.01422014 0.8292081 ]
Stock Position:  0.018672881955923717
Bond Position:  [11.20942668]


portfolio before change:  [13.25058069]
curr_Stock_Price:  109.23609715472412
curr_Factors:  [109.23609715  -0.98433385  -0.93594223]
mat_Sqrt:  [[16.01035162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00309304 -0.03884182 -0.0681453 ]
Stock Position:  0.0030930399316849507
Bond Position:  [12.91270908]


portfolio before change:  [13.25228388]
curr_Stock_Price:  109.26487027718312
curr_Factors:  [109.26487028  -0.94406468  -0.90801522]
mat_Sqrt:  [[17.14480205  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360177  0.07757378  0.73042614]
Stock Position:  -0.003601773294491323
Bond Position:  [13.64583117]


portfolio before change:  [13.25469684]
curr_Stock_Price:  109.06854378710024
curr_Factors:  [109.06854379  -0.87857812  -0.9240345 ]
mat_Sqrt:  [[17.98186769  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00104674 0.01947624 0.16628645]
Stock Position:  0.0010467391124449174
Bond Position:  [13.14053053]


portfolio before change:  [13.25813667]
curr_Stock_Price:  110.78545985739883
curr_Factors:  [110.78545986  -0.85353394  -0.92180893]
mat_Sqrt:  [[18.76986516  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.006302   -0.04121992  1.38085572]
Stock Position:  -0.006301995906822467
Bond Position:  [13.95630619]


portfolio before change:  [13.26084826]
curr_Stock_Price:  110.63202490924193
curr_Factors:  [110.63202491  -0.73335502  -0.93495388]
mat_Sqrt:  [[20.86140286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00665903  0.02942898 -0.30967132]
Stock Position:  0.0066590342403696655
Bond Position:  [12.52414582]


portfolio before change:  [13.25948035]
curr_Stock_Price:  110.19149162331229
curr_Factors:  [110.19149162  -0.5426471   -0.92281739]
mat_Sqrt:  [[25.45100411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04813858 -0.04817498 -3.71783241]
Stock Position:  -0.048138579574382806
Bond Position:  [18.56394224]


portfolio before change:  [13.2143734]
curr_Stock_Price:  111.17672200165367
curr_Factors:  [111.176722    -0.61710238  -0.93327984]
mat_Sqrt:  [[23.5880163   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0094017  -0.13296957  1.15568283]
Stock Position:  0.009401698307958062
Bond Position:  [12.1691234]


portfolio before change:  [13.21788928]
curr_Stock_Price:  111.38888007631365
curr_Factors:  [111.38888008  -0.36999138  -0.91521829]
mat_Sqrt:  [[30.80933829  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00458567 -0.0981135   0.4355991 ]
Stock Position:  -0.004585670057874486
Bond Position:  [13.72868194]


portfolio before change:  [13.2108946]
curr_Stock_Price:  113.28846683556314
curr_Factors:  [113.28846684  -0.60638764  -0.89274532]
mat_Sqrt:  [[25.30000031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00555946  0.16012499 -0.37127764]
Stock Position:  0.005559461523186744
Bond Position:  [12.58107173]


portfolio before change:  [13.20107001]
curr_Stock_Price:  111.23839088152577
curr_Factors:  [111.23839088  -0.54151102  -0.8813842 ]
mat_Sqrt:  [[26.81014462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00228015  0.00258584  0.26865158]
Stock Position:  -0.002280151997150469
Bond Position:  [13.45471045]


portfolio before change:  [13.19653747]
curr_Stock_Price:  113.9638600650445
curr_Factors:  [113.96386007  -0.85119417  -0.91567174]
mat_Sqrt:  [[19.47273856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194455  0.21225718 -0.75535014]
Stock Position:  0.0019445497522767277
Bond Position:  [12.97492908]


portfolio before change:  [13.19614115]
curr_Stock_Price:  112.92594093830829
curr_Factors:  [112.92594094  -0.58206409  -0.91611536]
mat_Sqrt:  [[25.24309795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068436 -0.05381143 -0.53172499]
Stock Position:  0.0006843633140962775
Bond Position:  [13.11885878]


portfolio before change:  [13.19724212]
curr_Stock_Price:  112.1383572522472
curr_Factors:  [112.13835725  -0.52713115  -0.89758075]
mat_Sqrt:  [[26.97799523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00163147  0.14035423  0.25589192]
Stock Position:  -0.0016314743659234102
Bond Position:  [13.38019298]


portfolio before change:  [13.20149273]
curr_Stock_Price:  110.55820423979749
curr_Factors:  [110.55820424  -0.61642373  -0.89046924]
mat_Sqrt:  [[24.49941264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01031324 0.05434663 0.03542952]
Stock Position:  0.010313241187528714
Bond Position:  [12.0612793]


portfolio before change:  [13.2079272]
curr_Stock_Price:  111.03591177028599
curr_Factors:  [111.03591177  -0.51900103  -0.91720792]
mat_Sqrt:  [[26.40741209  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00199421  0.00684289 -0.04056629]
Stock Position:  0.001994206612936471
Bond Position:  [12.98649865]


portfolio before change:  [13.21217393]
curr_Stock_Price:  112.3513834412586
curr_Factors:  [112.35138344  -0.59690439  -0.93976927]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.21217393]
Stock Price:  113.27553230693188
PL:  [-0.06335838]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.17927735e-01  8.09408600e-02  2.07449573e-01]
 [-1.24516578e-01 -2.00203878e-02  1.28156191e-01]
 [ 2.65950870e-01  3.58114450e-01  5.14281351e-01]
 [-1.59807866e-02  2.83859268e-02  1.21934219e-01]
 [-4.97376449e-01 -1.54036648e-01  4.04989876e-02]
 [-2.54352644e-03 -9.94896930e-02 -1.19139317e-01]
 [ 3.48542352e-02  3.64511909e-02 -1.59408086e-02]
 [ 2.81148570e-01 -8.14232444e-02 -5.76080984e-02]
 [-2.92324222e-01  4.73516020e-03 -1.03297189e-01]
 [ 6.52504979e-02 -4.05062094e-02 -8.21078236e-02]
 [ 1.12454081e-01 -2.44880738e-01 -6.28743480e-03]
 [-2.40656612e-02 -4.41166779e-02 -9.38116316e-02]
 [ 2.58044952e-01 -2.74099244e-01  2.79813418e-02]
 [ 9.64618754e-02 -6.30980712e-02 -4.40445156e-02]
 [-1.19088196e-01  1.28858430e-01  1.03557627e-01]
 [-1.09940081e-02 -1.37290740e-01 -1.93928539e-02]
 [-3.25315300e-01 -2.11798025e-01  6.78406481e-02]
 [-2.58061002e-01 -2.03771478e-01 -3.64796261e-02]
 [ 2.04643755e-01  1.02874112e+00  1.32884428e-01]
 [-5.18947810e-01 -9.51684541e-02  3.67930275e-01]
 [-1.00087089e-01  4.23494461e-01 -2.41413699e-02]
 [-5.55082279e-02  3.93751894e-02 -2.71330534e-02]
 [ 1.20299383e-01 -4.08033382e-02  1.37213949e-01]
 [ 8.58664534e-02 -7.60894451e-02 -6.32313291e-02]
 [-1.09664527e-01  1.28427266e-01  1.81623118e-01]
 [ 1.26116683e-02  6.11081731e-02  3.67581807e-02]
 [ 7.56081226e-02 -1.72884525e-02  4.20917879e-01]
 [ 9.55462704e-02  7.34561476e-02 -8.76738504e-02]
 [-9.83569353e-01 -1.97433901e-01 -1.40382898e+00]
 [ 5.51025974e-02 -1.52047392e-01  1.38698388e-01]
 [ 1.30164621e-02 -1.80929084e-01  1.20791599e-01]
 [ 3.22473200e-02  1.70660047e-01 -4.62708031e-02]
 [-1.35953267e-01 -1.67452292e-02 -1.31400307e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 7.01472246e-02 -5.78597837e-02  1.73599157e-02]
 [-5.77453313e-02 -7.31945884e-02  3.98040478e-02]
 [ 1.43937647e-02  1.09438757e-02 -3.19449314e-02]
 [-8.49919697e-02  2.25072776e-02 -1.50921251e-03]
 [-1.12517960e-02 -2.74076051e-01  1.01707936e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.92555203]
curr_Stock_Price:  99.79627086904908
curr_Factors:  [99.79627087 -0.54938211 -1.00840567]
mat_Sqrt:  [[21.01723952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00825477  0.02559575  0.59179589]
Stock Position:  -0.008254765500988763
Bond Position:  [1.74934684]


portfolio before change:  [0.93978733]
curr_Stock_Price:  98.09826789986563
curr_Factors:  [98.0982679  -0.52195335 -1.01825177]
mat_Sqrt:  [[21.02610142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00470243 -0.006331    0.36559394]
Stock Position:  -0.004702428048454415
Bond Position:  [1.40108737]


portfolio before change:  [0.94102111]
curr_Stock_Price:  97.87314140557578
curr_Factors:  [97.87314141 -0.47526736 -1.023228  ]
mat_Sqrt:  [[21.87133343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01738232 0.11324573 1.46710154]
Stock Position:  0.017382323178620634
Bond Position:  [-0.76024146]


portfolio before change:  [0.98391731]
curr_Stock_Price:  100.34641428126824
curr_Factors:  [100.34641428  -0.59621967  -1.04047988]
mat_Sqrt:  [[19.52955167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00049371 0.00897642 0.34784439]
Stock Position:  0.0004937058091820769
Bond Position:  [0.9343757]


portfolio before change:  [0.98399999]
curr_Stock_Price:  100.27729654480386
curr_Factors:  [100.27729654  -0.64408847  -1.00550796]
mat_Sqrt:  [[19.26601917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0255936  -0.04871066  0.11553234]
Stock Position:  -0.025593602519986977
Bond Position:  [3.55045726]


portfolio before change:  [0.99901983]
curr_Stock_Price:  99.70777871082254
curr_Factors:  [99.70777871 -0.81852689 -0.96611438]
mat_Sqrt:  [[16.73667506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175851 -0.0314614  -0.33987131]
Stock Position:  -0.0017585064229552621
Bond Position:  [1.1743566]


portfolio before change:  [0.99812234]
curr_Stock_Price:  100.30163371917317
curr_Factors:  [100.30163372  -0.81454289  -0.97618974]
mat_Sqrt:  [[16.73411348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194462  0.01152688 -0.04547469]
Stock Position:  0.001944620312586326
Bond Position:  [0.80307375]


portfolio before change:  [0.99874174]
curr_Stock_Price:  100.56852949006723
curr_Factors:  [100.56852949  -0.84181959  -0.99382015]
mat_Sqrt:  [[16.04182927  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01666188 -0.02574829 -0.16433987]
Stock Position:  0.016661879560448237
Bond Position:  [-0.67691898]


portfolio before change:  [0.97646767]
curr_Stock_Price:  99.23677977727631
curr_Factors:  [99.23677978 -0.98842299 -0.97271476]
mat_Sqrt:  [[13.96244137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02243787  0.00149739 -0.29467813]
Stock Position:  -0.02243786763032749
Bond Position:  [3.2031294]


portfolio before change:  [0.98175835]
curr_Stock_Price:  99.01883295282057
curr_Factors:  [99.01883295 -0.91773378 -0.94655935]
mat_Sqrt:  [[15.34848747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00309115 -0.01280919 -0.23423077]
Stock Position:  0.003091147763522246
Bond Position:  [0.6756765]


portfolio before change:  [0.97842133]
curr_Stock_Price:  97.91196973080852
curr_Factors:  [97.91196973 -0.94346393 -0.95459006]
mat_Sqrt:  [[14.67308421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00714559 -0.07743809 -0.0179363 ]
Stock Position:  0.007145591777551868
Bond Position:  [0.27878237]


portfolio before change:  [0.98046412]
curr_Stock_Price:  98.19297286639554
curr_Factors:  [98.19297287 -1.13403707 -0.96189478]
mat_Sqrt:  [[12.07337735  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036737  -0.01395092 -0.26761847]
Stock Position:  -0.003673700136522809
Bond Position:  [1.34119566]


portfolio before change:  [0.98160629]
curr_Stock_Price:  97.9277050869855
curr_Factors:  [97.92770509 -1.03125822 -0.93515192]
mat_Sqrt:  [[13.70580361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01872779 -0.08667779  0.07982298]
Stock Position:  0.018727789687557325
Bond Position:  [-0.85236317]


portfolio before change:  [0.97667872]
curr_Stock_Price:  97.6702793315181
curr_Factors:  [97.67027933 -0.73244259 -0.90865505]
mat_Sqrt:  [[18.92530037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00453584 -0.01995336 -0.12564674]
Stock Position:  0.004535840351362418
Bond Position:  [0.53366193]


portfolio before change:  [0.97709501]
curr_Stock_Price:  97.74734946107357
curr_Factors:  [97.74734946 -0.68423544 -0.92522184]
mat_Sqrt:  [[19.54909131  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00484025  0.04074861  0.29542108]
Stock Position:  -0.004840249181252326
Bond Position:  [1.45021654]


portfolio before change:  [0.96680713]
curr_Stock_Price:  99.91029031406157
curr_Factors:  [99.91029031 -0.3542907  -0.91351192]
mat_Sqrt:  [[28.11969047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00065781 -0.04341514 -0.05532241]
Stock Position:  -0.0006578091412769869
Bond Position:  [1.03252903]


portfolio before change:  [0.96742622]
curr_Stock_Price:  99.16536699901717
curr_Factors:  [99.165367   -0.19765765 -0.92984386]
mat_Sqrt:  [[32.11384729  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00986914 -0.06697642  0.19353049]
Stock Position:  -0.009869137905607337
Bond Position:  [1.9461029]


portfolio before change:  [0.97268668]
curr_Stock_Price:  98.656996092426
curr_Factors:  [98.65699609 -0.12584361 -0.89607823]
mat_Sqrt:  [[35.50690925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0076258  -0.0644382  -0.10406622]
Stock Position:  -0.0076258040228396546
Bond Position:  [1.7250256]


portfolio before change:  [0.98212076]
curr_Stock_Price:  97.44814831485157
curr_Factors:  [ 9.74481483e+01 -5.01660660e-02 -9.23300137e-01]
mat_Sqrt:  [[36.81311699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00701735 0.3253165  0.37908228]
Stock Position:  0.0070173535451682496
Bond Position:  [0.29829265]


portfolio before change:  [0.95611192]
curr_Stock_Price:  93.73647417690734
curr_Factors:  [93.73647418  0.0970068  -0.92990256]
mat_Sqrt:  [[40.75553314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0109507  -0.03009491  1.04960266]
Stock Position:  -0.010950699489956608
Bond Position:  [1.98259188]


portfolio before change:  [0.91124078]
curr_Stock_Price:  97.85666586501978
curr_Factors:  [97.85666587  0.10472258 -0.94232946]
mat_Sqrt:  [[42.34697264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00222165  0.13392071 -0.06886861]
Stock Position:  -0.002221654566022722
Bond Position:  [1.12864449]


portfolio before change:  [0.90751385]
curr_Stock_Price:  99.59771606267678
curr_Factors:  [99.59771606  0.35617303 -0.93519435]
mat_Sqrt:  [[55.81920108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00107544  0.01245153 -0.07740305]
Stock Position:  -0.0010754377529296993
Bond Position:  [1.014625]


portfolio before change:  [0.90548899]
curr_Stock_Price:  101.59848284882817
curr_Factors:  [101.59848285   0.36532679  -0.88496567]
mat_Sqrt:  [[60.42420218  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00243701 -0.01290315  0.3914332 ]
Stock Position:  0.0024370123283912162
Bond Position:  [0.65789224]


portfolio before change:  [0.91121493]
curr_Stock_Price:  103.91430965840341
curr_Factors:  [103.91430966   0.28992789  -0.87025091]
mat_Sqrt:  [[58.16266151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122062 -0.0240616  -0.18038138]
Stock Position:  0.001220624874408445
Bond Position:  [0.78437454]


portfolio before change:  [0.91261585]
curr_Stock_Price:  104.98168930064057
curr_Factors:  [104.9816893    0.18006813  -0.88459756]
mat_Sqrt:  [[51.89676794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00133486  0.04061227  0.5181202 ]
Stock Position:  -0.0013348593415000729
Bond Position:  [1.05275164]


portfolio before change:  [0.91158208]
curr_Stock_Price:  105.85472109854355
curr_Factors:  [105.8547211    0.22270737  -0.90156431]
mat_Sqrt:  [[53.68913544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00040404 0.0193241  0.10486086]
Stock Position:  0.00040404276559005356
Bond Position:  [0.86881225]


portfolio before change:  [0.91170196]
curr_Stock_Price:  105.88262372742037
curr_Factors:  [105.88262373   0.449541    -0.91798953]
mat_Sqrt:  [[66.279631    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00243033 -0.00546709  1.20076155]
Stock Position:  0.00243032793600512
Bond Position:  [0.65437246]


portfolio before change:  [0.91526962]
curr_Stock_Price:  107.3169403516486
curr_Factors:  [ 1.07316940e+02  6.43228668e-02 -9.11416392e-01]
mat_Sqrt:  [[46.00237339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00172918  0.02322887 -0.25010909]
Stock Position:  0.0017291836120633384
Bond Position:  [0.72969893]


portfolio before change:  [0.91743242]
curr_Stock_Price:  108.51495111314573
curr_Factors:  [ 1.08514951e+02 -4.88661208e-02 -8.75417295e-01]
mat_Sqrt:  [[43.06043292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02961472 -0.06243408 -4.00473332]
Stock Position:  -0.029614715367696453
Bond Position:  [4.13107181]


portfolio before change:  [1.00760448]
curr_Stock_Price:  105.48754922123132
curr_Factors:  [105.48754922   0.12609828  -0.86528083]
mat_Sqrt:  [[50.37073637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00157807 -0.04808161  0.39566789]
Stock Position:  0.0015780678668295327
Bond Position:  [0.84113797]


portfolio before change:  [1.00972908]
curr_Stock_Price:  106.7672414849585
curr_Factors:  [ 1.06767241e+02  3.20598869e-02 -8.68596817e-01]
mat_Sqrt:  [[46.25244011  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071351 -0.0572148   0.34458481]
Stock Position:  0.000713505601456937
Bond Position:  [0.93355005]


portfolio before change:  [1.00621185]
curr_Stock_Price:  101.67418829903583
curr_Factors:  [101.6741883   0.252331   -0.8571713]
mat_Sqrt:  [[55.53054152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00048998  0.05396745 -0.13199772]
Stock Position:  0.0004899782106896155
Bond Position:  [0.95639372]


portfolio before change:  [1.00549246]
curr_Stock_Price:  99.96196868702678
curr_Factors:  [ 9.99619687e+01  3.48186441e-02 -8.33264441e-01]
mat_Sqrt:  [[44.9856704   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362799 -0.00529531 -0.3748485 ]
Stock Position:  -0.00362799088846427
Bond Position:  [1.36815357]


portfolio before change:  [1.00378436]
curr_Stock_Price:  100.47992217976069
curr_Factors:  [100.47992218  -0.11000665  -0.85034161]
mat_Sqrt:  [[38.45965132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136282  0.0049611   0.16678008]
Stock Position:  -0.0013628231603569408
Bond Position:  [1.14072072]


portfolio before change:  [1.00471889]
curr_Stock_Price:  99.89882274249491
curr_Factors:  [99.89882274 -0.27504772 -0.8455668 ]
mat_Sqrt:  [[32.57494341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00221633 -0.01829687  0.04952301]
Stock Position:  0.0022163313819652517
Bond Position:  [0.78331]


portfolio before change:  [1.00013614]
curr_Stock_Price:  97.78692014773877
curr_Factors:  [97.78692015 -0.31265084 -0.87287138]
mat_Sqrt:  [[29.88236783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172377 -0.02314616  0.11354987]
Stock Position:  -0.0017237670230499536
Bond Position:  [1.16869801]


portfolio before change:  [0.99663192]
curr_Stock_Price:  99.90456057962083
curr_Factors:  [99.90456058 -0.38742185 -0.86939108]
mat_Sqrt:  [[28.4287913   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028688  0.00346076 -0.09113   ]
Stock Position:  0.00028687827286818753
Bond Position:  [0.96797147]


portfolio before change:  [0.99665348]
curr_Stock_Price:  99.5579462059247
curr_Factors:  [99.55794621 -0.58038123 -0.8860727 ]
mat_Sqrt:  [[22.97222594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00368788  0.00711743 -0.00430536]
Stock Position:  -0.0036878838471873774
Bond Position:  [1.36381163]


portfolio before change:  [0.99616117]
curr_Stock_Price:  99.73767071475554
curr_Factors:  [99.73767071 -0.5539016  -0.86599009]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.99616117]
Stock Price:  101.50333353263622
PL:  [-0.50717236]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.64622227e-01 -8.21814352e-03  8.28577732e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 1.93522308e-01  9.75219932e-02  1.36454980e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.04482236e+00 -3.09107106e-01  2.71208157e-02]
 [-3.77482036e-02 -3.19617229e-02 -1.67323098e-02]
 [ 1.59720058e-02  1.18250678e-01  3.76970852e-02]
 [ 3.23371279e-01 -4.66012988e-02 -7.69954740e-02]
 [-4.94807388e-01 -2.93686832e-02 -4.97844909e-02]
 [ 1.42271124e-02  3.90615428e-02 -1.49983737e-02]
 [-1.62955944e-02 -2.13444477e-01  1.25613989e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.15045984e-01 -2.77662652e-02  2.78258735e-01]
 [ 5.15331155e-02  2.28579673e-01  1.83977045e-01]
 [ 5.64531386e-02 -1.13405038e-01 -4.43530804e-02]
 [-1.94296499e-02  1.36013322e-03  3.75787669e-02]
 [-5.02179803e-01 -2.50184942e-01  1.38960219e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 2.41389890e-01  1.00759211e+00  3.66699677e-01]
 [-2.67513220e-04  2.13388296e-02  2.90777984e-02]
 [-5.13213479e-02 -1.24136328e-01 -1.58422921e-02]
 [-3.28515908e-02  5.89983469e-02 -2.98432241e-02]
 [ 7.04066355e-02 -3.50637968e-02  9.19092954e-02]
 [ 7.94139752e-02  1.10192407e-02 -2.09086646e-02]
 [-6.17388515e-02 -1.32159245e-01  1.09833388e-01]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [-2.69445894e-02 -6.24787168e-02  3.64206476e-02]
 [ 1.96397958e-02  5.16094877e-02 -7.11600984e-02]
 [-5.79692647e-01 -3.90794268e-02 -8.59315279e-01]
 [-2.66042862e-01  1.09988998e-01 -5.13987337e-03]
 [-1.47440271e-03  3.30318624e-02  1.21092632e-01]
 [ 1.19387435e-02  3.53004333e-02  1.86210617e-02]
 [-1.31393063e-01 -1.30020649e-02 -1.39948463e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [-1.51822815e-02 -1.02465426e-03  5.64535134e-02]
 [-2.33380146e-03  3.01026949e-03  7.15050665e-02]
 [-8.01369986e-05 -3.89417372e-03 -3.90514625e-02]
 [-1.06055958e-01  3.02755437e-02  2.89318572e-03]
 [ 2.45984843e-03 -2.64805714e-01  9.27087258e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.92428713]
curr_Stock_Price:  99.93542459666348
curr_Factors:  [99.9354246  -0.99462303 -1.00568585]
mat_Sqrt:  [[13.52061215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01094042 -0.00259881  0.23637016]
Stock Position:  -0.010940417852016538
Bond Position:  [3.01762243]


portfolio before change:  [1.92862107]
curr_Stock_Price:  99.5737643532719
curr_Factors:  [99.57376435 -0.9888081  -1.01719152]
mat_Sqrt:  [[13.39523568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338785  0.01411938  0.0859571 ]
Stock Position:  -0.003387849525309691
Bond Position:  [2.265962]


portfolio before change:  [1.92789238]
curr_Stock_Price:  99.8724641455241
curr_Factors:  [99.87246415 -1.26292299 -1.01593104]
mat_Sqrt:  [[10.22708905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02189226 0.03083916 0.38926808]
Stock Position:  0.021892257878384093
Bond Position:  [-0.25854136]


portfolio before change:  [1.93895757]
curr_Stock_Price:  100.37937895945568
curr_Factors:  [100.37937896  -1.33048113  -1.05466287]
mat_Sqrt:  [[ 9.24250364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213179 -0.00659539  0.21422481]
Stock Position:  0.002131787519629309
Bond Position:  [1.72497007]


portfolio before change:  [1.93906109]
curr_Stock_Price:  100.32678361899627
curr_Factors:  [100.32678362  -1.3884648   -1.03527072]
mat_Sqrt:  [[ 8.88795667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11782995 -0.09774825  0.07736814]
Stock Position:  -0.11782994686756701
Bond Position:  [13.76056067]


portfolio before change:  [1.94892329]
curr_Stock_Price:  100.25768379684376
curr_Factors:  [100.2576838   -1.35999743  -1.03375325]
mat_Sqrt:  [[ 9.15218843  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00458786 -0.01010718 -0.04773262]
Stock Position:  -0.004587855737528022
Bond Position:  [2.40889108]


portfolio before change:  [1.94400751]
curr_Stock_Price:  101.39479661727874
curr_Factors:  [101.39479662  -1.3752317   -1.02590695]
mat_Sqrt:  [[ 9.18786067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0029082  0.03739415 0.10753929]
Stock Position:  0.0029081971721490597
Bond Position:  [1.64913145]


portfolio before change:  [1.94420058]
curr_Stock_Price:  101.3902959079664
curr_Factors:  [101.39029591  -1.09816797  -1.00312503]
mat_Sqrt:  [[12.39985009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02471412 -0.01473662 -0.21964666]
Stock Position:  0.02471412159398172
Bond Position:  [-0.56157152]


portfolio before change:  [1.93347065]
curr_Stock_Price:  100.95897449186981
curr_Factors:  [100.95897449  -1.22334674  -0.9952352 ]
mat_Sqrt:  [[10.98062435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04605639 -0.00928719 -0.1420213 ]
Stock Position:  -0.04605638848497356
Bond Position:  [6.5832764]


portfolio before change:  [1.8781185]
curr_Stock_Price:  102.17867724251089
curr_Factors:  [102.17867724  -1.3028304   -0.99208773]
mat_Sqrt:  [[10.29650883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118236  0.01235234 -0.04278619]
Stock Position:  0.0011823567689141575
Bond Position:  [1.75730685]


portfolio before change:  [1.87825504]
curr_Stock_Price:  102.10835640213861
curr_Factors:  [102.1083564   -1.22293127  -0.99976535]
mat_Sqrt:  [[11.06003262  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.46666336e-04 -6.74970702e-02  3.58341746e-01]
Stock Position:  0.0003466663358375885
Bond Position:  [1.84285751]


portfolio before change:  [1.8783078]
curr_Stock_Price:  101.59601769191998
curr_Factors:  [101.59601769  -1.23096574  -1.01440238]
mat_Sqrt:  [[10.7578554   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00670446  0.00225658  0.15019092]
Stock Position:  -0.006704460685958409
Bond Position:  [2.5594543]


portfolio before change:  [1.87368273]
curr_Stock_Price:  102.33358955204628
curr_Factors:  [102.33358955  -1.27330783  -0.99760738]
mat_Sqrt:  [[10.56263476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0162013  -0.00878046  0.79379472]
Stock Position:  0.01620129749516704
Bond Position:  [0.2157458]


portfolio before change:  [1.85931438]
curr_Stock_Price:  101.44506086141573
curr_Factors:  [101.44506086  -1.23211012  -0.98577557]
mat_Sqrt:  [[11.04117742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00860317 0.07228324 0.5248353 ]
Stock Position:  0.008603174354573155
Bond Position:  [0.98656483]


portfolio before change:  [1.86317541]
curr_Stock_Price:  101.87951661691068
curr_Factors:  [101.87951662  -1.21461359  -0.99210243]
mat_Sqrt:  [[11.21301193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00396606 -0.03586182 -0.12652699]
Stock Position:  0.003966061814744062
Bond Position:  [1.45911495]


portfolio before change:  [1.86488323]
curr_Stock_Price:  102.26413511122335
curr_Factors:  [102.26413511  -1.2363377   -1.01199406]
mat_Sqrt:  [[10.79655682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108588  0.00043011  0.10720176]
Stock Position:  -0.001085883016698784
Bond Position:  [1.97593012]


portfolio before change:  [1.86519929]
curr_Stock_Price:  102.2005386141722
curr_Factors:  [102.20053861  -1.0911333   -1.02862432]
mat_Sqrt:  [[12.27027079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03914131 -0.07911543  0.39641483]
Stock Position:  -0.03914130527234729
Bond Position:  [5.86546177]


portfolio before change:  [1.85457556]
curr_Stock_Price:  102.49069161999786
curr_Factors:  [102.49069162  -1.01220091  -1.04673193]
mat_Sqrt:  [[13.07679318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01004154  0.00580111 -0.05715682]
Stock Position:  -0.010041535566470841
Bond Position:  [2.88373948]


portfolio before change:  [1.85253011]
curr_Stock_Price:  102.73029017935654
curr_Factors:  [102.73029018  -1.09243746  -1.08477824]
mat_Sqrt:  [[11.64516778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02939057 0.3186286  1.04609211]
Stock Position:  0.029390565297980842
Bond Position:  [-1.16677119]


portfolio before change:  [1.83379474]
curr_Stock_Price:  102.09779096451507
curr_Factors:  [102.09779096  -1.03404388  -1.08354598]
mat_Sqrt:  [[12.28453598  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00050624 0.00674793 0.08295087]
Stock Position:  0.0005062408332458647
Bond Position:  [1.78210867]


portfolio before change:  [1.8337948]
curr_Stock_Price:  101.65785076572169
curr_Factors:  [101.65785077  -1.06878166  -1.08548241]
mat_Sqrt:  [[11.79114353  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00489862 -0.03925535 -0.04519365]
Stock Position:  -0.004898619741386369
Bond Position:  [2.33177796]


portfolio before change:  [1.8335725]
curr_Stock_Price:  101.76273656685427
curr_Factors:  [101.76273657  -1.19353472  -1.09713039]
mat_Sqrt:  [[10.29830055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00363361  0.01865692 -0.08513441]
Stock Position:  -0.0036336075521842433
Bond Position:  [2.20333835]


portfolio before change:  [1.83439902]
curr_Stock_Price:  101.61107219302473
curr_Factors:  [101.61107219  -1.25744667  -1.12023526]
mat_Sqrt:  [[ 9.42598815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00936371 -0.01108815  0.26219164]
Stock Position:  0.009363707768505132
Bond Position:  [0.88294264]


portfolio before change:  [1.83952516]
curr_Stock_Price:  102.14673216529114
curr_Factors:  [102.14673217  -1.34315111  -1.12502477]
mat_Sqrt:  [[ 8.65584186  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00871441  0.00348459 -0.0596466 ]
Stock Position:  0.008714406831152365
Bond Position:  [0.94937698]


portfolio before change:  [1.83766534]
curr_Stock_Price:  101.91969414657552
curr_Factors:  [101.91969415  -1.16008819  -1.12465073]
mat_Sqrt:  [[10.37548978  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00411851 -0.04179242  0.31332408]
Stock Position:  -0.0041185084336733515
Bond Position:  [2.25742246]


portfolio before change:  [1.83758994]
curr_Stock_Price:  102.00651943635621
curr_Factors:  [102.00651944  -1.28829319  -1.116314  ]
mat_Sqrt:  [[ 9.21128659  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140654  0.02004328 -0.05140267]
Stock Position:  0.0014065443267753776
Bond Position:  [1.69411325]


portfolio before change:  [1.83824197]
curr_Stock_Price:  102.3195180609149
curr_Factors:  [102.31951806  -1.30255243  -1.14822491]
mat_Sqrt:  [[ 8.8226573   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00239423 -0.01975751  0.10389797]
Stock Position:  -0.002394227569193927
Bond Position:  [2.08321818]


portfolio before change:  [1.83846368]
curr_Stock_Price:  102.33568259743606
curr_Factors:  [102.3356826   -1.25813347  -1.14291235]
mat_Sqrt:  [[ 9.2739797   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00069515  0.01632035 -0.20299995]
Stock Position:  0.0006951549389421888
Bond Position:  [1.76732453]


portfolio before change:  [1.8391089]
curr_Stock_Price:  102.94603393006567
curr_Factors:  [102.94603393  -1.31636352  -1.14570345]
mat_Sqrt:  [[ 8.77702872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08614631 -0.012358   -2.4513873 ]
Stock Position:  -0.0861463137793757
Bond Position:  [10.70753024]


portfolio before change:  [1.85819758]
curr_Stock_Price:  102.739987381936
curr_Factors:  [102.73998738  -1.02771333  -1.10538939]
mat_Sqrt:  [[12.17151859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0217107   0.03478158 -0.01466263]
Stock Position:  -0.021710695271545604
Bond Position:  [4.08875414]


portfolio before change:  [1.86267956]
curr_Stock_Price:  102.55708862538653
curr_Factors:  [102.55708863  -0.96549254  -1.11753671]
mat_Sqrt:  [[12.77372541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0018864  0.01044559 0.34544357]
Stock Position:  0.00188640397207858
Bond Position:  [1.66921546]


portfolio before change:  [1.86068866]
curr_Stock_Price:  101.3910768352386
curr_Factors:  [101.39107684  -0.93570541  -1.0984762 ]
mat_Sqrt:  [[13.26068284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00125568 0.01116298 0.05312071]
Stock Position:  0.0012556823243681508
Bond Position:  [1.73337368]


portfolio before change:  [1.85945792]
curr_Stock_Price:  100.23837830818847
curr_Factors:  [100.23837831  -0.9036472   -1.09669445]
mat_Sqrt:  [[13.56115545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0118202  -0.00411161 -0.39923401]
Stock Position:  -0.011820204859095537
Bond Position:  [3.04429609]


portfolio before change:  [1.86917022]
curr_Stock_Price:  99.44890486004725
curr_Factors:  [99.44890486 -0.95374941 -1.1124437 ]
mat_Sqrt:  [[12.59690162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416084  0.0049611   0.16678008]
Stock Position:  -0.00416084090581752
Bond Position:  [2.28296129]


portfolio before change:  [1.87284484]
curr_Stock_Price:  98.63435075568756
curr_Factors:  [98.63435076 -0.8434673  -1.14573858]
mat_Sqrt:  [[13.49357579  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027311 -0.00032402  0.16104616]
Stock Position:  -0.0002731086902878874
Bond Position:  [1.89978274]


portfolio before change:  [1.87279079]
curr_Stock_Price:  99.70181560085379
curr_Factors:  [99.7018156  -0.67144562 -1.17580032]
mat_Sqrt:  [[15.72006536  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00078497 0.00095193 0.20398405]
Stock Position:  0.000784973450075332
Bond Position:  [1.79452751]


portfolio before change:  [1.87346503]
curr_Stock_Price:  100.27496109704087
curr_Factors:  [100.2749611   -0.56584448  -1.188602  ]
mat_Sqrt:  [[17.3478667   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046992 -0.00123145 -0.11140295]
Stock Position:  -0.0004699154466570947
Bond Position:  [1.92058578]


portfolio before change:  [1.87435084]
curr_Stock_Price:  98.90082281865799
curr_Factors:  [98.90082282 -0.59890359 -1.16624257]
mat_Sqrt:  [[16.92803976  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00618404  0.00957397  0.00825345]
Stock Position:  -0.0061840401777199655
Bond Position:  [2.4859575]


portfolio before change:  [1.87424743]
curr_Stock_Price:  98.96779792193014
curr_Factors:  [98.96779792 -0.38883285 -1.17477942]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.87424743]
Stock Price:  100.3164156214399
PL:  [1.55783181]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.10772759e-01  6.45523154e-02  8.69621768e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.10891924e-01  2.06228025e-01  2.99401336e-01]
 [-6.30063995e-03  5.52881466e-03  1.00193618e-01]
 [-7.09037356e-01 -2.13992075e-01  3.53265387e-02]
 [ 4.95181571e-03 -1.13686292e-01 -1.40745683e-01]
 [ 3.38667310e-02 -6.35858598e-02 -2.73195932e-02]
 [ 2.53070800e-01  6.47256193e-02 -6.16573083e-02]
 [-3.54827218e-01 -5.58545056e-03 -8.76488560e-02]
 [ 5.38430410e-02 -2.82416606e-02 -4.65362537e-02]
 [ 2.51553621e-02 -3.05375476e-01  1.26320283e-01]
 [-6.34082839e-02  4.59289556e-03  4.19626165e-02]
 [ 1.31482064e-01 -4.74526875e-02  2.87380883e-01]
 [ 8.48464580e-02  9.18731736e-02  5.41005704e-02]
 [ 5.64705144e-02 -1.12130704e-01 -5.40742893e-02]
 [-3.00028602e-02  2.76771387e-02  4.16658605e-02]
 [-4.20100513e-01 -2.14919631e-01  1.04088391e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 9.69090641e-02  6.92076776e-01  1.03569513e-01]
 [-2.14147439e-02  4.24890208e-02  2.59276141e-02]
 [ 1.09671871e-01 -1.40190407e-01  1.66040124e-01]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 2.23677914e-01 -4.03339925e-03  2.11646250e-01]
 [ 7.78426343e-02 -1.90787291e-01 -8.67985366e-02]
 [-1.18778760e-01  2.13588719e-01  1.64957473e-01]
 [ 1.36188509e-02  6.20682005e-02  1.36352593e-02]
 [-4.73308862e-02 -7.72573736e-02  7.72921053e-02]
 [ 8.02697768e-02  6.87113809e-02 -8.26211057e-02]
 [-7.47433838e-01 -1.42433743e-01 -1.10971524e+00]
 [-6.77306458e-02  2.08739030e-02  1.73110641e-02]
 [-1.32616001e-02 -4.17196396e-02  1.11440173e-01]
 [ 2.13481975e-02  7.63880297e-02 -3.18542021e-04]
 [-1.53137243e-01 -1.01169981e-02 -1.17528701e-01]
 [-6.25116080e-02  6.93456459e-02  9.24933535e-02]
 [ 1.42772975e-01 -1.58008059e-01 -1.06560766e-01]
 [-3.07303153e-02  2.68494811e-01  8.39721434e-02]
 [ 7.21592749e-02  6.27264453e-02 -3.32318245e-02]
 [-4.14372139e-02  8.35093968e-02 -8.24148493e-03]
 [-1.08717558e-01 -2.11848953e-01  4.26582028e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.73779973]
curr_Stock_Price:  100.7454211082778
curr_Factors:  [100.74542111  -0.76007302  -1.05804025]
mat_Sqrt:  [[16.3541793   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00558603  0.02041323  0.24807888]
Stock Position:  -0.005586030587237232
Bond Position:  [8.30056673]


portfolio before change:  [7.73983374]
curr_Stock_Price:  100.56705200954666
curr_Factors:  [100.56705201  -1.01297639  -1.05009815]
mat_Sqrt:  [[12.77832218  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355141  0.01411938  0.0859571 ]
Stock Position:  -0.003551408564245878
Bond Position:  [8.09698843]


portfolio before change:  [7.74447297]
curr_Stock_Price:  99.54575386617954
curr_Factors:  [99.54575387 -1.05857105 -1.04106806]
mat_Sqrt:  [[12.19441758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02274252 0.06521503 0.85410867]
Stock Position:  0.022742517131829638
Bond Position:  [5.48055196]


portfolio before change:  [7.75732695]
curr_Stock_Price:  100.0808251332663
curr_Factors:  [100.08082513  -1.16956129  -1.03993325]
mat_Sqrt:  [[10.98448223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00130129 0.00174836 0.28582451]
Stock Position:  0.001301294850775356
Bond Position:  [7.62709229]


portfolio before change:  [7.7572783]
curr_Stock_Price:  99.31074749734064
curr_Factors:  [99.3107475  -1.18019569 -1.01551219]
mat_Sqrt:  [[11.05127618  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06400633 -0.06767024  0.10077678]
Stock Position:  -0.06400632802369992
Bond Position:  [14.11379458]


portfolio before change:  [7.77131986]
curr_Stock_Price:  99.11893486284023
curr_Factors:  [99.11893486 -1.15063008 -1.01900621]
mat_Sqrt:  [[11.32128066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00235955 -0.03595076 -0.40150826]
Stock Position:  -0.0023595514238151727
Bond Position:  [8.00519608]


portfolio before change:  [7.77182555]
curr_Stock_Price:  99.32872687849905
curr_Factors:  [99.32872688 -0.99151007 -1.04112524]
mat_Sqrt:  [[13.01105674  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00204813 -0.02010761 -0.07793519]
Stock Position:  0.0020481320660174092
Bond Position:  [7.5683872]


portfolio before change:  [7.77265003]
curr_Stock_Price:  99.26933917480565
curr_Factors:  [99.26933917 -0.99146102 -1.05090465]
mat_Sqrt:  [[12.87736455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0188048   0.02046804 -0.17589114]
Stock Position:  0.01880479984749663
Bond Position:  [5.90590997]


portfolio before change:  [7.77783753]
curr_Stock_Price:  99.50593935342856
curr_Factors:  [99.50593935 -0.90218733 -1.0488401 ]
mat_Sqrt:  [[14.14257712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02636455 -0.00176627 -0.25003779]
Stock Position:  -0.026364550021687045
Bond Position:  [10.40126685]


portfolio before change:  [7.76759951]
curr_Stock_Price:  99.94358234881167
curr_Factors:  [99.94358235 -0.63157108 -1.07106596]
mat_Sqrt:  [[18.20996196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0023951  -0.0089308  -0.13275498]
Stock Position:  0.002395099536163741
Bond Position:  [7.52822468]


portfolio before change:  [7.77075392]
curr_Stock_Price:  100.86768647870645
curr_Factors:  [100.86768648  -0.63351185  -1.07159188]
mat_Sqrt:  [[18.33305821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234852 -0.0965682   0.36035661]
Stock Position:  0.0023485236680964687
Bond Position:  [7.53386377]


portfolio before change:  [7.77088025]
curr_Stock_Price:  100.52046512473999
curr_Factors:  [100.52046512  -0.67981526  -1.03889085]
mat_Sqrt:  [[18.02311722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303633  0.0014524   0.11970766]
Stock Position:  -0.0030363289496030312
Bond Position:  [8.07609345]


portfolio before change:  [7.77093001]
curr_Stock_Price:  100.83657500411866
curr_Factors:  [100.836575    -0.58182756  -1.02724925]
mat_Sqrt:  [[20.17459872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00936416 -0.01500586  0.81981767]
Stock Position:  0.009364162345991899
Bond Position:  [6.82667996]


portfolio before change:  [7.77215241]
curr_Stock_Price:  100.87598157325303
curr_Factors:  [100.87598157  -0.51309035  -1.0078658 ]
mat_Sqrt:  [[22.0416911   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.004458   0.02905285 0.15433387]
Stock Position:  0.004457999405633647
Bond Position:  [7.32244735]


portfolio before change:  [7.77451019]
curr_Stock_Price:  101.19953792731947
curr_Factors:  [101.19953793  -0.41688621  -0.99448938]
mat_Sqrt:  [[24.67322387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00172403 -0.03545884 -0.1542589 ]
Stock Position:  0.0017240326694534633
Bond Position:  [7.60003888]


portfolio before change:  [7.77849421]
curr_Stock_Price:  102.95933885280243
curr_Factors:  [102.95933885  -0.51373317  -1.01925102]
mat_Sqrt:  [[22.22793755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.000935    0.00875228  0.1188611 ]
Stock Position:  -0.0009350049412530921
Bond Position:  [7.8747617]


portfolio before change:  [7.78012104]
curr_Stock_Price:  102.27225806007716
curr_Factors:  [102.27225806  -0.4859555   -1.01017042]
mat_Sqrt:  [[22.90860355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01765288 -0.06796355  0.29693521]
Stock Position:  -0.017652876957643306
Bond Position:  [9.58552063]


portfolio before change:  [7.76815895]
curr_Stock_Price:  103.01776555684468
curr_Factors:  [103.01776556  -0.63447836  -1.02699576]
mat_Sqrt:  [[19.55883951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00671364  0.00580111 -0.05715682]
Stock Position:  -0.00671364391159285
Bond Position:  [8.45978355]


portfolio before change:  [7.76023266]
curr_Stock_Price:  104.35591049553572
curr_Factors:  [104.3559105   -0.6669177   -1.00286033]
mat_Sqrt:  [[19.6490551   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00691735 0.21885389 0.29545499]
Stock Position:  0.006917352878856255
Bond Position:  [7.038366]


portfolio before change:  [7.76554467]
curr_Stock_Price:  104.99664058742904
curr_Factors:  [104.99664059  -0.73219394  -1.00228432]
mat_Sqrt:  [[18.53109425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00081081  0.01343621  0.07396427]
Stock Position:  -0.0008108118058014236
Bond Position:  [7.85067718]


portfolio before change:  [7.76540787]
curr_Stock_Price:  106.3757416818844
curr_Factors:  [106.37574168  -1.1258128   -0.98103779]
mat_Sqrt:  [[12.93745987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01081704 -0.0443321   0.47366626]
Stock Position:  0.010817035958797348
Bond Position:  [6.61473765]


portfolio before change:  [7.76016291]
curr_Stock_Price:  105.81441840195285
curr_Factors:  [105.8144184   -1.11353201  -0.99006578]
mat_Sqrt:  [[12.91112067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00301049  0.01916992 -0.08961985]
Stock Position:  -0.0030104949579044006
Bond Position:  [8.07871669]


portfolio before change:  [7.7619]
curr_Stock_Price:  105.57287015505031
curr_Factors:  [105.57287016  -1.12870723  -1.00477087]
mat_Sqrt:  [[12.50243375  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02133792 -0.00127547  0.60376784]
Stock Position:  0.021337916062139615
Bond Position:  [5.50919495]


portfolio before change:  [7.73339451]
curr_Stock_Price:  104.20468694606845
curr_Factors:  [104.20468695  -0.99055723  -1.00160959]
mat_Sqrt:  [[14.21347261  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00388356 -0.06033224 -0.24761206]
Stock Position:  0.00388355837377688
Bond Position:  [7.32870953]


portfolio before change:  [7.73572595]
curr_Stock_Price:  104.5691182432913
curr_Factors:  [104.56911824  -0.94535424  -1.04027874]
mat_Sqrt:  [[14.3566793   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00554391  0.06754268  0.47057776]
Stock Position:  -0.0055439087182476005
Bond Position:  [8.31544759]


portfolio before change:  [7.73533317]
curr_Stock_Price:  104.82746865565812
curr_Factors:  [104.82746866  -0.97642468  -1.05741123]
mat_Sqrt:  [[13.71486031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00131279 0.01962769 0.0388976 ]
Stock Position:  0.0013127899386642093
Bond Position:  [7.59771672]


portfolio before change:  [7.73598794]
curr_Stock_Price:  104.60275029646054
curr_Factors:  [104.6027503   -0.76818118  -1.047617  ]
mat_Sqrt:  [[17.01970281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197116 -0.02443093  0.22049286]
Stock Position:  -0.0019711553392890786
Bond Position:  [7.94217621]


portfolio before change:  [7.73583735]
curr_Stock_Price:  105.1828266329376
curr_Factors:  [105.18282663  -0.76892062  -1.04829147]
mat_Sqrt:  [[17.08990528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00381389  0.02172845 -0.23569502]
Stock Position:  0.0038138850591369652
Bond Position:  [7.33468214]


portfolio before change:  [7.73831896]
curr_Stock_Price:  105.59309620411824
curr_Factors:  [105.5930962   -0.79054027  -1.04707546]
mat_Sqrt:  [[16.81005574  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05815752 -0.0450415  -3.1657087 ]
Stock Position:  -0.05815751903003197
Bond Position:  [13.87935147]


portfolio before change:  [7.81333839]
curr_Stock_Price:  104.33299426230877
curr_Factors:  [104.33299426  -0.78899939  -1.04791081]
mat_Sqrt:  [[16.62117442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00382994  0.00660091  0.04938365]
Stock Position:  -0.0038299386200053476
Bond Position:  [8.21292736]


portfolio before change:  [7.81558364]
curr_Stock_Price:  104.01482611889723
curr_Factors:  [104.01482612  -0.79472804  -1.04380529]
mat_Sqrt:  [[16.54361332  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050828 -0.01319291  0.31790779]
Stock Position:  0.0005082827551925489
Bond Position:  [7.7627147]


portfolio before change:  [7.81687156]
curr_Stock_Price:  104.63952388161798
curr_Factors:  [104.63952388  -0.94742463  -1.02918096]
mat_Sqrt:  [[14.49662341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016042   0.02415602 -0.00090871]
Stock Position:  0.0016042015563001578
Bond Position:  [7.64900867]


portfolio before change:  [7.81668186]
curr_Stock_Price:  103.92521840041805
curr_Factors:  [103.9252184   -1.06892219  -1.03604267]
mat_Sqrt:  [[12.66328326  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01400813 -0.00319928 -0.33527667]
Stock Position:  -0.0140081292002023
Bond Position:  [9.27247974]


portfolio before change:  [7.80442173]
curr_Stock_Price:  104.88318086162215
curr_Factors:  [104.88318086  -1.22390223  -1.01588116]
mat_Sqrt:  [[11.16812543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374646  0.02192902  0.26385779]
Stock Position:  -0.0037464644078547635
Bond Position:  [8.19736283]


portfolio before change:  [7.80358055]
curr_Stock_Price:  105.38122792440743
curr_Factors:  [105.38122792  -1.08751385  -1.02601545]
mat_Sqrt:  [[12.73119425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00918544 -0.04996654 -0.3039882 ]
Stock Position:  0.009185438335391588
Bond Position:  [6.83560778]


portfolio before change:  [7.80707396]
curr_Stock_Price:  105.66852028050891
curr_Factors:  [105.66852028  -1.2065601   -1.0138055 ]
mat_Sqrt:  [[11.47236874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058027  0.08490551  0.23954915]
Stock Position:  -0.0005802696286336461
Bond Position:  [7.86839019]


portfolio before change:  [7.80776913]
curr_Stock_Price:  106.1655960405955
curr_Factors:  [106.16559604  -1.32908506  -1.01798762]
mat_Sqrt:  [[10.15460626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00659754  0.01983584 -0.09480115]
Stock Position:  0.006597542558026842
Bond Position:  [7.10733709]


portfolio before change:  [7.81458152]
curr_Stock_Price:  107.06349352162461
curr_Factors:  [107.06349352  -1.51631798  -1.0345509 ]
mat_Sqrt:  [[ 8.35243546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00490435  0.02640799 -0.02351066]
Stock Position:  -0.004904353558672821
Bond Position:  [8.33965874]


portfolio before change:  [7.81589199]
curr_Stock_Price:  107.00885921919685
curr_Factors:  [107.00885922  -1.44931858  -0.99635346]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.81589199]
Stock Price:  107.35610579173289
PL:  [0.4597862]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.63762022e-01 -6.22491571e-03  8.38448654e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.28605908e-01  2.27909936e-01  3.23752345e-01]
 [-1.37859788e-02  3.02451090e-02  1.23525722e-01]
 [-6.06752629e-01 -1.85018730e-01  3.78261147e-02]
 [ 2.94560216e-02 -1.60537643e-01 -2.11377803e-01]
 [ 3.55193181e-02 -5.50951340e-02 -2.29753052e-02]
 [ 1.41619252e-01  1.15221572e-01 -2.47327784e-02]
 [-3.82684014e-01 -1.59150809e-02 -5.65486889e-02]
 [ 6.40846938e-02 -3.98127549e-02 -7.63879275e-02]
 [ 8.07726956e-02 -3.66319174e-01  4.86625760e-02]
 [-7.01360751e-02  5.46365789e-03  4.56214945e-02]
 [ 5.36308684e-02 -5.24160624e-03  2.32267850e-01]
 [ 7.89765447e-02  1.54491809e-01  1.17433134e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-4.80274172e-02  6.99608086e-02  4.51414250e-02]
 [-3.00855549e-01 -1.92007928e-01  5.64560309e-02]
 [-2.72096279e-01 -1.71454204e-01 -4.18593488e-02]
 [ 2.26256737e-01  1.12157004e+00  2.41121966e-01]
 [-9.70689946e-02 -1.87669282e-02  8.58270099e-02]
 [-9.88968320e-02  3.84885321e-01 -2.59517454e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 2.03691164e-01 -1.29919813e-02  1.97198417e-01]
 [ 8.37133926e-02 -6.05602792e-02 -5.37053547e-02]
 [-1.06970270e-01  1.39383670e-01  1.55067070e-01]
 [ 1.47432133e-02  6.31399215e-02 -1.21778778e-02]
 [-4.16019033e-02 -7.93685951e-02  7.30170027e-02]
 [ 4.24998810e-02  5.34755194e-02 -8.34870312e-02]
 [-6.61466545e-01 -8.74070053e-02 -1.01229506e+00]
 [-2.22049918e-01  6.27273186e-02  4.42001775e-03]
 [-3.63342520e-02  5.05701051e-02  1.43742198e-01]
 [ 1.11505003e-02  2.65729079e-02  2.29268034e-02]
 [-1.19309504e-01 -4.05874461e-03 -1.48240772e-01]
 [-6.66211601e-02 -2.90521010e-02  3.00887202e-02]
 [ 1.96118612e-01 -1.67942489e-01 -8.55588667e-02]
 [ 1.99108401e-03  7.05553424e-02  7.73770824e-02]
 [ 2.92557803e-02  2.89703292e-02 -4.22030342e-02]
 [-7.13933112e-02  6.72092600e-02 -4.37184170e-03]
 [-5.76957487e-02 -2.51327759e-01  1.09454586e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.76662707]
curr_Stock_Price:  99.91345782617358
curr_Factors:  [99.91345783 -1.00463417 -0.98623281]
mat_Sqrt:  [[13.64587688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01075841 -0.00196849  0.23918606]
Stock Position:  -0.010758413592634393
Bond Position:  [2.84153737]


portfolio before change:  [1.75720868]
curr_Stock_Price:  100.82191933364135
curr_Factors:  [100.82191933  -1.02204279  -0.95656928]
mat_Sqrt:  [[13.93973946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325552  0.01411938  0.0859571 ]
Stock Position:  -0.003255515856719824
Bond Position:  [2.08543604]


portfolio before change:  [1.76116355]
curr_Stock_Price:  99.68717787235354
curr_Factors:  [99.68717787 -1.14107455 -0.95348753]
mat_Sqrt:  [[12.27389913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02448905 0.07207145 0.92357532]
Stock Position:  0.02448905471458381
Bond Position:  [-0.68008121]


portfolio before change:  [1.76519051]
curr_Stock_Price:  99.85508868618233
curr_Factors:  [99.85508869 -1.06742491 -0.9715399 ]
mat_Sqrt:  [[12.99747643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00093938 0.00956434 0.3523845 ]
Stock Position:  0.0009393768835471379
Bond Position:  [1.67138895]


portfolio before change:  [1.76515779]
curr_Stock_Price:  99.59784407804706
curr_Factors:  [99.59784408 -0.94809774 -0.96912689]
mat_Sqrt:  [[14.64231896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04123722 -0.05850806  0.10790738]
Stock Position:  -0.041237222749323066
Bond Position:  [5.87229628]


portfolio before change:  [1.80214781]
curr_Stock_Price:  98.71864009939696
curr_Factors:  [98.7186401  -0.78618212 -0.97135988]
mat_Sqrt:  [[17.02583316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104761 -0.05076646 -0.60300204]
Stock Position:  -0.0010476054676239735
Bond Position:  [1.90556599]


portfolio before change:  [1.80160047]
curr_Stock_Price:  99.46849438742917
curr_Factors:  [99.46849439 -0.72419437 -0.96129436]
mat_Sqrt:  [[18.43686561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00159501 -0.01742261 -0.06554215]
Stock Position:  0.0015950082790195145
Bond Position:  [1.64294739]


portfolio before change:  [1.80108629]
curr_Stock_Price:  99.01736183388243
curr_Factors:  [99.01736183 -0.53467847 -0.95311669]
mat_Sqrt:  [[22.36506288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00623945  0.03643626 -0.07055573]
Stock Position:  0.0062394505159808185
Bond Position:  [1.18327236]


portfolio before change:  [1.8046659]
curr_Stock_Price:  99.56736183530916
curr_Factors:  [99.56736184 -0.50269753 -0.97855617]
mat_Sqrt:  [[22.63688646  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0174334  -0.00503279 -0.16131767]
Stock Position:  -0.017433399836079045
Bond Position:  [3.54046353]


portfolio before change:  [1.8028865]
curr_Stock_Price:  99.69481795581154
curr_Factors:  [99.69481796 -0.36675956 -0.98869133]
mat_Sqrt:  [[25.70441594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00184654 -0.0125899  -0.21791349]
Stock Position:  0.0018465353437882236
Bond Position:  [1.61879649]


portfolio before change:  [1.80198438]
curr_Stock_Price:  99.09668124059542
curr_Factors:  [99.09668124 -0.24792567 -0.99883267]
mat_Sqrt:  [[28.48385999  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00285241 -0.11584029  0.13882078]
Stock Position:  0.0028524077128053355
Bond Position:  [1.51932024]


portfolio before change:  [1.8079101]
curr_Stock_Price:  101.1075437043443
curr_Factors:  [ 1.01107544e+02  2.43860555e-02 -1.01435961e+00]
mat_Sqrt:  [[37.57020016  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161518  0.00172776  0.13014543]
Stock Position:  -0.0016151778600917827
Bond Position:  [1.97121677]


portfolio before change:  [1.80528936]
curr_Stock_Price:  102.8826779906716
curr_Factors:  [102.88267799  -0.28398997  -1.03444934]
mat_Sqrt:  [[27.5265221   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00366581 -0.00165754  0.66259553]
Stock Position:  0.003665810257674475
Bond Position:  [1.42814099]


portfolio before change:  [1.80143209]
curr_Stock_Price:  101.78174649311902
curr_Factors:  [101.78174649  -0.40671661  -1.01546147]
mat_Sqrt:  [[24.54854772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00435612 0.0488546  0.33500404]
Stock Position:  0.004356120997599977
Bond Position:  [1.35805848]


portfolio before change:  [1.80464742]
curr_Stock_Price:  102.48089321319398
curr_Factors:  [102.48089321  -0.24647914  -0.98743272]
mat_Sqrt:  [[29.83745573  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00143867 -0.03587186 -0.12433753]
Stock Position:  0.0014386660180810695
Bond Position:  [1.65721164]


portfolio before change:  [1.80439668]
curr_Stock_Price:  102.16260446595457
curr_Factors:  [ 1.02162604e+02 -6.14345952e-02 -1.00185387e+00]
mat_Sqrt:  [[35.27862443  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104898  0.02212355  0.12877592]
Stock Position:  -0.0010489803024896901
Bond Position:  [1.91156324]


portfolio before change:  [1.80686967]
curr_Stock_Price:  100.03288142977395
curr_Factors:  [ 1.00032881e+02  8.00136080e-02 -1.01691168e+00]
mat_Sqrt:  [[39.1970259   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00750795 -0.06071824  0.16105334]
Stock Position:  -0.007507945473555884
Bond Position:  [2.55791109]


portfolio before change:  [1.82852073]
curr_Stock_Price:  97.19171771640923
curr_Factors:  [ 9.71917177e+01  2.02004305e-02 -1.04481928e+00]
mat_Sqrt:  [[34.88533876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00817156 -0.05421858 -0.11941307]
Stock Position:  -0.00817156208143508
Bond Position:  [2.62272889]


portfolio before change:  [1.80802629]
curr_Stock_Price:  99.73986093311254
curr_Factors:  [ 9.97398609e+01 -6.55563927e-03 -1.06042455e+00]
mat_Sqrt:  [[34.31509049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00887173 0.35467159 0.68785385]
Stock Position:  0.008871734325157041
Bond Position:  [0.92316074]


portfolio before change:  [1.81354093]
curr_Stock_Price:  100.34845024776644
curr_Factors:  [100.34845025  -0.26387995  -1.05138901]
mat_Sqrt:  [[26.93373736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297152 -0.00593462  0.24484057]
Stock Position:  -0.0029715218672513814
Bond Position:  [2.11172855]


portfolio before change:  [1.81856826]
curr_Stock_Price:  98.74545234638452
curr_Factors:  [98.74545235 -0.26205582 -1.05653081]
mat_Sqrt:  [[26.41570497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035682   0.12171143 -0.07403311]
Stock Position:  -0.0035681998158918465
Bond Position:  [2.17091176]


portfolio before change:  [1.80558862]
curr_Stock_Price:  102.45909562784281
curr_Factors:  [102.45909563  -0.53641648  -1.05558356]
mat_Sqrt:  [[20.85228657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186401  0.01916992 -0.08961985]
Stock Position:  -0.0018640096640832836
Bond Position:  [1.99657336]


portfolio before change:  [1.80207091]
curr_Stock_Price:  104.48016365869616
curr_Factors:  [104.48016366  -0.62307578  -1.03845104]
mat_Sqrt:  [[19.83544339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01228148 -0.00410843  0.56255219]
Stock Position:  0.012281483524028823
Bond Position:  [0.5188995]


portfolio before change:  [1.78755787]
curr_Stock_Price:  103.29318065663043
curr_Factors:  [103.29318066  -0.53382873  -1.03667968]
mat_Sqrt:  [[21.47872586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00331431 -0.01915084 -0.15320643]
Stock Position:  0.0033143108075824454
Bond Position:  [1.44521216]


portfolio before change:  [1.79076626]
curr_Stock_Price:  104.20671177083022
curr_Factors:  [104.20671177  -0.91053025  -1.03090599]
mat_Sqrt:  [[14.95342385  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00479612  0.04407699  0.44236319]
Stock Position:  -0.004796123387975906
Bond Position:  [2.2905545]


portfolio before change:  [1.795041]
curr_Stock_Price:  103.3751222837421
curr_Factors:  [103.37512228  -1.10413538  -1.03629822]
mat_Sqrt:  [[12.1573112   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114233  0.0199666  -0.0347401 ]
Stock Position:  0.0011423315542712074
Bond Position:  [1.67695234]


portfolio before change:  [1.79537882]
curr_Stock_Price:  103.48733768569132
curr_Factors:  [103.48733769  -1.07702218  -1.04354198]
mat_Sqrt:  [[12.4147478   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231552 -0.02509855  0.20829718]
Stock Position:  -0.0023155249584919076
Bond Position:  [2.03500633]


portfolio before change:  [1.79747599]
curr_Stock_Price:  102.69150269352087
curr_Factors:  [102.69150269  -1.04335575  -1.03486014]
mat_Sqrt:  [[12.85218041  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00208828  0.01691044 -0.23816526]
Stock Position:  0.00208827554631313
Bond Position:  [1.58302783]


portfolio before change:  [1.79724658]
curr_Stock_Price:  102.4868835900887
curr_Factors:  [102.48688359  -1.0264462   -0.99860773]
mat_Sqrt:  [[13.52690805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06434266 -0.02764052 -2.88779605]
Stock Position:  -0.06434266025902961
Bond Position:  [8.39152531]


portfolio before change:  [1.83769978]
curr_Stock_Price:  101.87447193036323
curr_Factors:  [101.87447193  -1.319949    -1.01182568]
mat_Sqrt:  [[ 9.89437794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02218715  0.01983612  0.01260908]
Stock Position:  -0.022187152639225643
Bond Position:  [4.09800424]


portfolio before change:  [1.83444823]
curr_Stock_Price:  102.04411212245198
curr_Factors:  [102.04411212  -1.22587457  -0.99672938]
mat_Sqrt:  [[11.05409825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0005145   0.01599167  0.41005648]
Stock Position:  -0.0005144955403799024
Bond Position:  [1.88694947]


portfolio before change:  [1.83450342]
curr_Stock_Price:  102.39532035522555
curr_Factors:  [102.39532036  -1.3374753   -1.00374058]
mat_Sqrt:  [[ 9.8515138   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00167655 0.00840309 0.06540379]
Stock Position:  0.0016765468081563662
Bond Position:  [1.66283287]


portfolio before change:  [1.83463757]
curr_Stock_Price:  102.35135613441132
curr_Factors:  [102.35135613  -1.45910663  -1.01798228]
mat_Sqrt:  [[ 8.59622064  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01741158 -0.00128349 -0.42288966]
Stock Position:  -0.017411584435885218
Bond Position:  [3.61673685]


portfolio before change:  [1.82577595]
curr_Stock_Price:  102.88627266263849
curr_Factors:  [102.88627266  -1.29044964  -0.98394125]
mat_Sqrt:  [[10.58283494  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00578573 -0.00918708  0.08583474]
Stock Position:  -0.0057857321053119
Bond Position:  [2.42104836]


portfolio before change:  [1.82228111]
curr_Stock_Price:  103.54262635039338
curr_Factors:  [103.54262635  -1.30779236  -1.00164795]
mat_Sqrt:  [[10.28352471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01695117 -0.05310808 -0.24407563]
Stock Position:  0.01695116507802909
Bond Position:  [0.06711296]


portfolio before change:  [1.80684133]
curr_Stock_Price:  102.63129249012002
curr_Factors:  [102.63129249  -0.85615489  -1.01520955]
mat_Sqrt:  [[15.79634277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00124126 0.02231156 0.22073528]
Stock Position:  0.001241258575961269
Bond Position:  [1.67944936]


portfolio before change:  [1.80896864]
curr_Stock_Price:  104.17598619501132
curr_Factors:  [104.1759862   -1.11234169  -1.03228747]
mat_Sqrt:  [[12.2002017   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175318  0.00916122 -0.12039351]
Stock Position:  0.001753178609439325
Bond Position:  [1.62632953]


portfolio before change:  [1.80762864]
curr_Stock_Price:  103.29569671100514
curr_Factors:  [103.29569671  -1.19038989  -1.04984808]
mat_Sqrt:  [[10.99408877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00641712  0.02125343 -0.01247165]
Stock Position:  -0.00641711882337708
Bond Position:  [2.4704894]


portfolio before change:  [1.80988036]
curr_Stock_Price:  102.99293014206988
curr_Factors:  [102.99293014  -1.40478155  -1.039092  ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.80988036]
Stock Price:  103.95542213945212
PL:  [-2.14554178]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [ 1.94526181e-01 -1.07390172e-01  3.66324177e-01]
 [-1.12251631e-01  1.98867114e-02  1.34737889e-01]
 [ 2.35577736e-01  3.27423678e-01  4.81319040e-01]
 [-5.24050399e-02 -6.64485764e-02  7.38596858e-02]
 [-3.31165117e-02 -2.25295902e-02  5.18443078e-02]
 [ 1.09614652e-01 -2.66939482e-01 -3.70554218e-01]
 [ 1.99804298e-02 -2.83449254e-01 -4.43743067e-02]
 [ 2.08857040e-01  3.01919791e-01 -6.87395337e-02]
 [-2.01391178e-02  2.80648577e-02 -8.04348536e-02]
 [ 1.29925357e-01  2.48716278e-02  2.21156571e-01]
 [ 1.84913399e-01 -2.21513131e-01 -4.54009123e-02]
 [-1.26327644e-01 -1.00367720e-01 -2.19407134e-01]
 [ 2.65619157e-01 -3.10351581e-01 -4.37566771e-02]
 [ 8.08936258e-02 -8.28134636e-02 -4.72036704e-02]
 [-2.33264705e-01  4.11396258e-01  2.91371322e-01]
 [ 1.15247229e-01 -6.48784412e-01 -1.87907429e-01]
 [ 1.50693238e-01 -2.06134324e-01 -1.13123395e-01]
 [-3.67602286e-01 -1.94852279e-01 -4.78779603e-02]
 [ 7.72976317e-02  8.80823548e-01 -1.80238397e-01]
 [-5.89400283e-01 -1.12353333e-01  4.11843362e-01]
 [-9.94532087e-02 -6.52378414e-02 -2.00088674e-02]
 [-8.33853738e-03 -5.72094050e-03  1.73901038e-02]
 [-7.98690912e-02 -7.37357511e-03 -8.87647954e-02]
 [-6.21197215e-02 -8.99069684e-02  4.87118755e-02]
 [-1.17898899e-01  1.16386592e-01  8.38061608e-02]
 [ 1.13881953e-01 -1.05069261e-01 -9.70916009e-02]
 [ 8.88985338e-02 -2.38389200e-03  9.96968843e-02]
 [-7.07571636e-02  4.38754921e-02  7.19026275e-02]
 [-6.11966279e-01 -1.17821675e-01 -9.61340805e-01]
 [ 1.68834402e-01 -1.17990185e-01 -1.45416149e-01]
 [ 1.34358621e-01  8.68884520e-03 -3.57928121e-02]
 [ 4.06653696e-02  2.35314352e-01 -7.75658156e-02]
 [-3.70192441e-03  5.12776393e-02 -6.03056534e-02]
 [ 3.01126517e-02  1.29101066e-01  9.41770279e-02]
 [-3.74473503e-01  1.14496362e-01 -9.44229133e-02]
 [-2.22795644e-01 -7.26874389e-02 -3.82376643e-02]
 [ 2.96348084e-01  2.23484627e-01  7.80061829e-02]
 [-8.22932711e-02  2.78288015e-01  3.36763172e-02]
 [ 4.52855143e-04 -1.41733270e-01  3.45610009e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.45272951]
curr_Stock_Price:  98.62892518953711
curr_Factors:  [98.62892519 -1.0475085  -0.96281445]
mat_Sqrt:  [[13.21089176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02017494 -0.03395975  1.04502091]
Stock Position:  0.02017494299526169
Bond Position:  [-9.44256245]


portfolio before change:  [-7.4551227]
curr_Stock_Price:  98.56881078056699
curr_Factors:  [98.56881078 -0.87120533 -0.9672781 ]
mat_Sqrt:  [[15.67820377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00537274  0.00628873  0.38436969]
Stock Position:  -0.00537273930728262
Bond Position:  [-6.92553818]


portfolio before change:  [-7.45475026]
curr_Stock_Price:  98.33835285313938
curr_Factors:  [98.33835285 -0.8657034  -0.9486561 ]
mat_Sqrt:  [[16.02347143  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0213612  0.10354046 1.37306925]
Stock Position:  0.021361202387882708
Bond Position:  [-9.55537572]


portfolio before change:  [-7.47236262]
curr_Stock_Price:  97.56976952978924
curr_Factors:  [97.56976953 -0.90483919 -0.94682323]
mat_Sqrt:  [[15.31611107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254922 -0.02101288  0.21070113]
Stock Position:  -0.00254922345081115
Bond Position:  [-7.22363548]


portfolio before change:  [-7.47215026]
curr_Stock_Price:  97.13223585959963
curr_Factors:  [97.13223586 -0.80146397 -0.94389053]
mat_Sqrt:  [[16.9576457   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136313 -0.00712448  0.14789738]
Stock Position:  -0.0013631342796726785
Bond Position:  [-7.33974598]


portfolio before change:  [-7.47233691]
curr_Stock_Price:  96.59606459251636
curr_Factors:  [96.59606459 -0.97721826 -0.97343759]
mat_Sqrt:  [[13.73410494  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197197 -0.08441368 -1.05708804]
Stock Position:  0.0019719698662517414
Bond Position:  [-7.66282144]


portfolio before change:  [-7.47172546]
curr_Stock_Price:  97.39190167702944
curr_Factors:  [97.39190168 -1.19906834 -0.97625401]
mat_Sqrt:  [[11.06094814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00032583 -0.08963452 -0.12658755]
Stock Position:  0.0003258250621593875
Bond Position:  [-7.50345818]


portfolio before change:  [-7.47279803]
curr_Stock_Price:  96.97885848751935
curr_Factors:  [96.97885849 -1.18341826 -0.99167354]
mat_Sqrt:  [[11.01657774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01839239  0.09547542 -0.19609476]
Stock Position:  0.018392388425646018
Bond Position:  [-9.25647086]


portfolio before change:  [-7.47992128]
curr_Stock_Price:  96.65447856469025
curr_Factors:  [96.65447856 -1.11013282 -1.01248398]
mat_Sqrt:  [[11.57127515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309674  0.00887489 -0.22945825]
Stock Position:  -0.0030967358024876035
Bond Position:  [-7.1806079]


portfolio before change:  [-7.48084271]
curr_Stock_Price:  96.66216139783545
curr_Factors:  [96.6621614  -1.02081193 -0.99776236]
mat_Sqrt:  [[12.84105856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01368352 0.0078651  0.63089814]
Stock Position:  0.013683524200356888
Bond Position:  [-8.80352173]


portfolio before change:  [-7.48506064]
curr_Stock_Price:  96.43433785616214
curr_Factors:  [96.43433786 -0.81550484 -0.99770119]
mat_Sqrt:  [[15.73136215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01080177 -0.0700486  -0.12951617]
Stock Position:  0.010801768468464345
Bond Position:  [-8.52672203]


portfolio before change:  [-7.48085904]
curr_Stock_Price:  96.92199080578077
curr_Factors:  [96.92199081 -0.90205369 -1.01596884]
mat_Sqrt:  [[14.23756512  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0122005  -0.03173906 -0.62590748]
Stock Position:  -0.012200500535800072
Bond Position:  [-6.29836224]


portfolio before change:  [-7.4845692]
curr_Stock_Price:  97.16155652684951
curr_Factors:  [97.16155653 -0.86520255 -1.00540243]
mat_Sqrt:  [[14.96583815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01661612 -0.09814179 -0.12482562]
Stock Position:  0.016616117081145167
Bond Position:  [-9.099017]


portfolio before change:  [-7.50198902]
curr_Stock_Price:  96.18164242714296
curr_Factors:  [96.18164243 -0.78056636 -0.97918427]
mat_Sqrt:  [[16.55168452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00417601 -0.02618792 -0.13465893]
Stock Position:  0.0041760089358926136
Bond Position:  [-7.90364442]


portfolio before change:  [-7.50825159]
curr_Stock_Price:  94.91858048107422
curr_Factors:  [94.91858048 -0.75073554 -0.94706885]
mat_Sqrt:  [[17.37817461  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00938917  0.13009492  0.83120128]
Stock Position:  -0.009389166634589495
Bond Position:  [-6.61704522]


portfolio before change:  [-7.50114277]
curr_Stock_Price:  94.07335086419985
curr_Factors:  [94.07335086 -0.35894169 -0.93932511]
mat_Sqrt:  [[25.68245317  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234165 -0.20516365 -0.53604759]
Stock Position:  0.002341647190034077
Bond Position:  [-7.72142937]


portfolio before change:  [-7.50112376]
curr_Stock_Price:  94.49367507389785
curr_Factors:  [94.49367507 -0.36238953 -0.94103309]
mat_Sqrt:  [[25.66454037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00476454 -0.0651854  -0.32270956]
Stock Position:  0.004764537160848755
Bond Position:  [-7.95134239]


portfolio before change:  [-7.50650724]
curr_Stock_Price:  93.57238924534846
curr_Factors:  [93.57238925 -0.2754248  -0.96678568]
mat_Sqrt:  [[27.01858259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01415346 -0.0616177  -0.13658249]
Stock Position:  -0.014153458886543088
Bond Position:  [-6.18213428]


portfolio before change:  [-7.4862396]
curr_Stock_Price:  92.0857943002105
curr_Factors:  [ 9.20857943e+01 -3.28476277e-02 -9.95984850e-01]
mat_Sqrt:  [[32.91367456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00192168  0.27854086 -0.51416998]
Stock Position:  0.0019216751072263821
Bond Position:  [-7.66319858]


portfolio before change:  [-7.48828168]
curr_Stock_Price:  91.52163960355946
curr_Factors:  [91.5216396  -0.11307477 -0.92399025]
mat_Sqrt:  [[32.44383451  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01566504 -0.03552924  1.17487448]
Stock Position:  -0.015665042882974562
Bond Position:  [-6.05459127]


portfolio before change:  [-7.49936473]
curr_Stock_Price:  92.18082584647192
curr_Factors:  [ 9.21808258e+01 -3.79766344e-02 -9.32858287e-01]
mat_Sqrt:  [[34.91502404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00301366 -0.02063002 -0.05707973]
Stock Position:  -0.003013657826036829
Bond Position:  [-7.22156326]


portfolio before change:  [-7.51531814]
curr_Stock_Price:  97.17497369249377
curr_Factors:  [97.17497369 -0.2361173  -0.91607636]
mat_Sqrt:  [[30.70174665  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00016079 -0.00180912  0.04960913]
Stock Position:  -0.00016078926758736933
Bond Position:  [-7.49969344]


portfolio before change:  [-7.51618102]
curr_Stock_Price:  96.71077571436561
curr_Factors:  [ 9.67107757e+01 -4.78031677e-03 -9.05025802e-01]
mat_Sqrt:  [[38.93597819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252154 -0.00233173 -0.25322125]
Stock Position:  -0.0025215371138147965
Bond Position:  [-7.27232121]


portfolio before change:  [-7.51015873]
curr_Stock_Price:  93.96190117478294
curr_Factors:  [93.96190117 -0.23042351 -0.91820601]
mat_Sqrt:  [[29.79259507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182924 -0.02843108  0.13896142]
Stock Position:  -0.0018292411023072494
Bond Position:  [-7.33827975]


portfolio before change:  [-7.51127232]
curr_Stock_Price:  94.06918783769919
curr_Factors:  [94.06918784 -0.13389418 -0.87861627]
mat_Sqrt:  [[34.17587922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286129  0.03680467  0.23907565]
Stock Position:  -0.002861285546505861
Bond Position:  [-7.24211351]


portfolio before change:  [-7.51812211]
curr_Stock_Price:  96.14673969627226
curr_Factors:  [96.1467397  -0.21189429 -0.85489597]
mat_Sqrt:  [[33.08517529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00276107 -0.03322582 -0.27697531]
Stock Position:  0.0027610655080233374
Bond Position:  [-7.78358956]


portfolio before change:  [-7.52353886]
curr_Stock_Price:  94.53731223396582
curr_Factors:  [ 9.45373122e+01  7.42116815e-02 -8.65117818e-01]
mat_Sqrt:  [[42.86640668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00254716 -0.00075385  0.28440746]
Stock Position:  0.0025471582935296068
Bond Position:  [-7.76434035]


portfolio before change:  [-7.51946139]
curr_Stock_Price:  96.5191544590824
curr_Factors:  [96.51915446 -0.11327257 -0.87376247]
mat_Sqrt:  [[35.97076212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152755  0.01387465  0.20511818]
Stock Position:  -0.0015275528690815922
Bond Position:  [-7.37202328]


portfolio before change:  [-7.5198282]
curr_Stock_Price:  96.1559928533227
curr_Factors:  [ 9.61559929e+01  2.29701176e-02 -8.87908897e-01]
mat_Sqrt:  [[40.48910877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02003604 -0.03725849 -2.74243773]
Stock Position:  -0.020036037257664153
Bond Position:  [-5.59324315]


portfolio before change:  [-7.52292897]
curr_Stock_Price:  96.27585498949395
curr_Factors:  [96.27585499 -0.26922687 -0.89235232]
mat_Sqrt:  [[30.13352578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00451673 -0.03731177 -0.4148318 ]
Stock Position:  0.004516728728529336
Bond Position:  [-7.95778089]


portfolio before change:  [-7.52588111]
curr_Stock_Price:  95.8424974191449
curr_Factors:  [95.84249742 -0.35820931 -0.90072579]
mat_Sqrt:  [[27.21507628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0046767   0.00274765 -0.10210693]
Stock Position:  0.004676701540311492
Bond Position:  [-7.97410786]


portfolio before change:  [-7.53187594]
curr_Stock_Price:  94.77379469582219
curr_Factors:  [94.7737947  -0.47339008 -0.89810503]
mat_Sqrt:  [[24.04670152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128534  0.07441293 -0.22127368]
Stock Position:  0.0012853365445136657
Bond Position:  [-7.65369216]


portfolio before change:  [-7.53393751]
curr_Stock_Price:  93.9142499709292
curr_Factors:  [93.91424997 -0.2157987  -0.91225163]
mat_Sqrt:  [[30.39663148  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004832   0.01621541 -0.17203524]
Stock Position:  -0.0004832042466113376
Bond Position:  [-7.48855775]


portfolio before change:  [-7.53361887]
curr_Stock_Price:  91.31748021333017
curr_Factors:  [91.31748021 -0.28995608 -0.91251832]
mat_Sqrt:  [[27.43632402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00191971 0.04082534 0.26866085]
Stock Position:  0.001919711698659862
Bond Position:  [-7.70892211]


portfolio before change:  [-7.53739885]
curr_Stock_Price:  89.85043403010327
curr_Factors:  [ 8.98504340e+01 -7.27958868e-02 -9.37052608e-01]
mat_Sqrt:  [[32.73019182  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01193978  0.03620693 -0.26936229]
Stock Position:  -0.011939777762088469
Bond Position:  [-6.46460464]


portfolio before change:  [-7.55529095]
curr_Stock_Price:  91.28127919792166
curr_Factors:  [91.2812792  -0.23360189 -0.94034565]
mat_Sqrt:  [[28.21907519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00823832 -0.02298579 -0.10908141]
Stock Position:  -0.008238315898726322
Bond Position:  [-6.80328694]


portfolio before change:  [-7.55701671]
curr_Stock_Price:  91.38752598391962
curr_Factors:  [91.38752598 -0.22349098 -0.9331461 ]
mat_Sqrt:  [[28.74523208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01106414 0.07067204 0.22252993]
Stock Position:  0.011064143679988835
Bond Position:  [-8.56814143]


portfolio before change:  [-7.53432874]
curr_Stock_Price:  93.53491800970042
curr_Factors:  [ 9.35349180e+01 -1.85363375e-02 -9.48415376e-01]
mat_Sqrt:  [[35.56575042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191852  0.0880024   0.09606916]
Stock Position:  -0.0019185242863879741
Bond Position:  [-7.35487973]


portfolio before change:  [-7.5317862]
curr_Stock_Price:  91.73042653751656
curr_Factors:  [ 9.17304265e+01  6.64669594e-02 -9.43414655e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.5317862]
Stock Price:  90.83825711933818
PL:  [-7.5317862]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.08067776e-01  3.89014955e-02  1.63782768e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.94547957e-01  3.93937357e-01  5.55905843e-01]
 [ 5.18542368e-02  4.56391650e-02  1.57508970e-01]
 [-2.03024870e-01 -7.06581199e-02  4.76921840e-02]
 [-5.85232808e-02  1.32226365e-02  5.05295813e-02]
 [ 3.07766110e-03  1.60590346e-01  8.78668789e-02]
 [ 2.94331710e-01 -8.69413789e-02 -6.20212596e-02]
 [-5.23935859e-01 -2.86157673e-02 -6.59137403e-02]
 [ 3.74208065e-02 -3.42049799e-04 -3.34626624e-02]
 [-4.83238676e-03 -2.37843699e-01  1.16993976e-01]
 [-1.27464454e-01  1.62153588e-02  9.62546051e-02]
 [ 6.90655156e-02 -1.01865823e-02  2.43820799e-01]
 [-4.31251580e-04  5.52947725e-01  5.05168729e-01]
 [ 5.84305738e-02 -1.14241810e-01 -4.45028255e-02]
 [-1.08141438e-02 -2.00840934e-02  3.42484275e-02]
 [-5.95798371e-01 -2.62656301e-01  1.75766040e-01]
 [-1.19475081e-01  1.88787343e-02 -2.68794763e-02]
 [ 1.73133620e-01  9.08197626e-01  3.70656273e-01]
 [-3.15333253e-02  5.41106384e-02  2.46341007e-02]
 [ 1.09105157e-01 -9.85087453e-02  1.53039191e-01]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 2.28978077e-01 -1.65772797e-03  2.15477583e-01]
 [ 6.89337367e-02 -1.69597194e-01 -6.21228993e-02]
 [-1.21661329e-01  2.35437654e-01  2.13605228e-01]
 [ 1.27166655e-02  6.12082544e-02  3.43476517e-02]
 [-1.78033055e-01 -1.61861013e-01  3.62478945e-01]
 [ 9.61045635e-02  7.36295494e-02 -8.78585075e-02]
 [-6.78651843e-01 -1.19727055e-01 -1.01270885e+00]
 [-9.10015570e-02  2.52176575e-02  3.06825513e-02]
 [-1.21604985e-01 -3.63057165e-02  1.24502144e-01]
 [ 1.57486938e-02  4.78542799e-02  1.30526747e-02]
 [-1.51662749e-01 -1.08282154e-02 -1.19550929e-01]
 [-6.35373708e-02  4.47851232e-02  7.69168748e-02]
 [ 2.10268202e-01 -1.70826933e-01 -8.05310344e-02]
 [ 6.86298293e-03  3.56006821e-02  7.62051368e-02]
 [-2.77759968e-02 -3.03271506e-02 -4.85916517e-02]
 [-9.70511528e-02 -1.36321164e-02  1.71653900e-03]
 [-3.84370931e-02 -2.74297156e-01  1.38715021e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.00708504]
curr_Stock_Price:  99.80763086151241
curr_Factors:  [99.80763086 -0.72856246 -0.97498875]
mat_Sqrt:  [[18.16857451  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00955668  0.01230173  0.46722665]
Stock Position:  -0.009556684056130221
Bond Position:  [1.96091504]


portfolio before change:  [1.00679793]
curr_Stock_Price:  99.8633240426249
curr_Factors:  [99.86332404 -0.42147898 -0.9838388 ]
mat_Sqrt:  [[24.4953846   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185264  0.01411938  0.0859571 ]
Stock Position:  -0.0018526364695521818
Bond Position:  [1.19180837]


portfolio before change:  [1.01106982]
curr_Stock_Price:  97.63789866616082
curr_Factors:  [97.63789867 -0.37339776 -0.96312989]
mat_Sqrt:  [[25.65498959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01630066 0.12457393 1.58584464]
Stock Position:  0.01630065681121239
Bond Position:  [-0.58049206]


portfolio before change:  [1.02044303]
curr_Stock_Price:  98.21737096820894
curr_Factors:  [98.21737097 -0.20981707 -0.9760549 ]
mat_Sqrt:  [[30.0034126   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00283914 0.01443237 0.44932925]
Stock Position:  0.0028391443291720083
Bond Position:  [0.74158974]


portfolio before change:  [1.02372216]
curr_Stock_Price:  99.33968899856445
curr_Factors:  [99.339689   -0.45565176 -0.94778921]
mat_Sqrt:  [[24.4127176   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00799231 -0.02234406  0.13605253]
Stock Position:  -0.007992314957965789
Bond Position:  [1.81767624]


portfolio before change:  [1.00583978]
curr_Stock_Price:  101.6055669278853
curr_Factors:  [101.60556693  -0.76606612  -0.93685878]
mat_Sqrt:  [[18.50745146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258639  0.00418136  0.14414683]
Stock Position:  -0.002586394258826404
Bond Position:  [1.26863183]


portfolio before change:  [1.00338815]
curr_Stock_Price:  102.61477773807209
curr_Factors:  [102.61477774  -0.84000557  -0.9282182 ]
mat_Sqrt:  [[17.50975543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0014369  0.05078313 0.25065975]
Stock Position:  0.0014369039971337282
Bond Position:  [0.85594056]


portfolio before change:  [1.00198262]
curr_Stock_Price:  101.56214853940943
curr_Factors:  [101.56214854  -0.84722121  -0.9206794 ]
mat_Sqrt:  [[17.33574068  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01611854 -0.02749328 -0.17692939]
Stock Position:  0.016118541581173082
Bond Position:  [-0.63505109]


portfolio before change:  [1.01386087]
curr_Stock_Price:  102.3040043168841
curr_Factors:  [102.30400432  -1.02101696  -0.92807167]
mat_Sqrt:  [[14.56847845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03693792 -0.0090491  -0.18803355]
Stock Position:  -0.03693792063973727
Bond Position:  [4.79275806]


portfolio before change:  [1.05348361]
curr_Stock_Price:  101.24753954687233
curr_Factors:  [101.24753955  -1.00871053  -0.95094677]
mat_Sqrt:  [[14.26645686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00214359 -0.00010817 -0.09545966]
Stock Position:  0.0021435902239711705
Bond Position:  [0.83645037]


portfolio before change:  [1.05375883]
curr_Stock_Price:  101.32715210477025
curr_Factors:  [101.3271521   -1.16942832  -0.96452568]
mat_Sqrt:  [[11.99392677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0010762  -0.07521278  0.33375125]
Stock Position:  0.0010761955552014849
Bond Position:  [0.944711]


portfolio before change:  [1.05568095]
curr_Stock_Price:  103.0034504617261
curr_Factors:  [103.00345046  -1.33243891  -0.97102609]
mat_Sqrt:  [[10.29128567  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01043581  0.00512775  0.2745876 ]
Stock Position:  -0.010435808467372923
Bond Position:  [2.13060523]


portfolio before change:  [1.04844354]
curr_Stock_Price:  103.72248903090251
curr_Factors:  [103.72248903  -1.38949534  -1.00949573]
mat_Sqrt:  [[ 9.41899019  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01258863 -0.00322128  0.69555287]
Stock Position:  0.01258863305830318
Bond Position:  [-0.25728081]


portfolio before change:  [1.05538994]
curr_Stock_Price:  104.27684280994067
curr_Factors:  [104.27684281  -1.13211816  -0.98860339]
mat_Sqrt:  [[12.50749122  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00935143 0.17485742 1.44110577]
Stock Position:  0.009351430298786616
Bond Position:  [0.08025231]


portfolio before change:  [1.05905739]
curr_Stock_Price:  104.66795074343214
curr_Factors:  [104.66795074  -1.31973245  -1.00154363]
mat_Sqrt:  [[10.27297729  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00451639 -0.03612643 -0.12695417]
Stock Position:  0.004516389012566561
Bond Position:  [0.58633621]


portfolio before change:  [1.05817661]
curr_Stock_Price:  104.45670223247778
curr_Factors:  [104.45670223  -1.36023773  -0.97740748]
mat_Sqrt:  [[10.08578943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043049 -0.00635115  0.09770123]
Stock Position:  -0.000430485083607518
Bond Position:  [1.10314366]


portfolio before change:  [1.05833672]
curr_Stock_Price:  104.4050974717612
curr_Factors:  [104.40509747  -1.47483241  -1.00617651]
mat_Sqrt:  [[ 8.73440289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0648816  -0.08305922  0.50141159]
Stock Position:  -0.06488159999505115
Bond Position:  [7.83230649]


portfolio before change:  [1.02187857]
curr_Stock_Price:  104.98210618858994
curr_Factors:  [104.98210619  -1.49312466  -1.03170066]
mat_Sqrt:  [[ 8.40615855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01480752  0.00596998 -0.07667966]
Stock Position:  -0.01480752281340261
Bond Position:  [2.57640351]


portfolio before change:  [1.0171045]
curr_Stock_Price:  105.32626524679726
curr_Factors:  [105.32626525  -1.59754893  -1.04983564]
mat_Sqrt:  [[ 7.46091642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03648923 0.28719731 1.05737918]
Stock Position:  0.036489227567118324
Bond Position:  [-2.82616956]


portfolio before change:  [1.02619325]
curr_Stock_Price:  105.58502762674452
curr_Factors:  [105.58502763  -1.63985058  -1.05349586]
mat_Sqrt:  [[ 7.14326631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00351489  0.01711129  0.07027423]
Stock Position:  -0.0035148878429802654
Bond Position:  [1.39731278]


portfolio before change:  [1.02516991]
curr_Stock_Price:  105.9258679074963
curr_Factors:  [105.92586791  -1.56362756  -1.0628693 ]
mat_Sqrt:  [[ 7.66176694  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01798549 -0.0311512   0.43657821]
Stock Position:  0.017985494421026343
Bond Position:  [-0.8799592]


portfolio before change:  [1.02543157]
curr_Stock_Price:  105.94653286067452
curr_Factors:  [105.94653286  -1.45992144  -1.07190714]
mat_Sqrt:  [[ 8.42417858  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00461396  0.01916992 -0.08961985]
Stock Position:  -0.004613964832603245
Bond Position:  [1.51426515]


portfolio before change:  [1.02593594]
curr_Stock_Price:  105.87824712610164
curr_Factors:  [105.87824713  -1.31420146  -1.07203943]
mat_Sqrt:  [[ 9.73812827  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.80258633e-02 -5.24219612e-04  6.14697566e-01]
Stock Position:  0.028025863342033653
Bond Position:  [-1.94139335]


portfolio before change:  [1.02773276]
curr_Stock_Price:  105.95101955064061
curr_Factors:  [105.95101955  -1.45652135  -1.05827462]
mat_Sqrt:  [[ 8.56925618  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0060535  -0.05363134 -0.17721934]
Stock Position:  0.006053497660957066
Bond Position:  [0.38635851]


portfolio before change:  [1.03038047]
curr_Stock_Price:  106.38042716944888
curr_Factors:  [106.38042717  -1.39476919  -1.02126947]
mat_Sqrt:  [[ 9.49706633  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00757922  0.07445192  0.60935626]
Stock Position:  -0.007579221638839041
Bond Position:  [1.83666131]


portfolio before change:  [1.03251524]
curr_Stock_Price:  106.12905980793369
curr_Factors:  [106.12905981  -1.51214867  -1.0254624 ]
mat_Sqrt:  [[ 8.39003614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00253971 0.01935575 0.09798429]
Stock Position:  0.002539707881669645
Bond Position:  [0.76297843]


portfolio before change:  [1.03174499]
curr_Stock_Price:  105.78822383513814
curr_Factors:  [105.78822384  -1.43041882  -1.03380906]
mat_Sqrt:  [[ 8.99988076  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01202478 -0.05118495  1.03405153]
Stock Position:  -0.012024779715959888
Bond Position:  [2.30382508]


portfolio before change:  [1.03368646]
curr_Stock_Price:  105.65071851800602
curr_Factors:  [105.65071852  -1.35238075  -1.03152679]
mat_Sqrt:  [[ 9.73990151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00822099  0.02328371 -0.25063587]
Stock Position:  0.00822098945024629
Bond Position:  [0.16513302]


portfolio before change:  [1.03045118]
curr_Stock_Price:  105.25466868824797
curr_Factors:  [105.25466869  -1.37051288  -1.03506192]
mat_Sqrt:  [[ 9.49540534  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09356752 -0.03786102 -2.88897645]
Stock Position:  -0.0935675180336592
Bond Position:  [10.87886929]


portfolio before change:  [1.04126716]
curr_Stock_Price:  105.15360766480413
curr_Factors:  [105.15360766  -1.25476218  -1.0090384 ]
mat_Sqrt:  [[10.93120595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00769242  0.00797452  0.08752878]
Stock Position:  -0.007692416620846063
Bond Position:  [1.85015251]


portfolio before change:  [1.04256255]
curr_Stock_Price:  105.015275244896
curr_Factors:  [105.01527524  -1.45480664  -0.99255911]
mat_Sqrt:  [[ 9.08604812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01068985 -0.01148088  0.35516996]
Stock Position:  -0.010689850963977263
Bond Position:  [2.16516019]


portfolio before change:  [1.05447703]
curr_Stock_Price:  103.92603481807625
curr_Factors:  [103.92603482  -1.28602268  -0.98655815]
mat_Sqrt:  [[10.70915108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00183475 0.01513285 0.03723565]
Stock Position:  0.0018347534604147443
Bond Position:  [0.86379838]


portfolio before change:  [1.0535926]
curr_Stock_Price:  103.38513625456368
curr_Factors:  [103.38513625  -0.95558698  -0.95907507]
mat_Sqrt:  [[15.23810428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01157267 -0.00342418 -0.34104552]
Stock Position:  -0.011572670743187538
Bond Position:  [2.25003474]


portfolio before change:  [1.04873315]
curr_Stock_Price:  103.82934847742699
curr_Factors:  [103.82934848  -1.19027679  -0.94341052]
mat_Sqrt:  [[12.29338553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0037972   0.0141623   0.21942243]
Stock Position:  -0.0037971991102755493
Bond Position:  [1.44299386]


portfolio before change:  [1.05146575]
curr_Stock_Price:  103.1572169810258
curr_Factors:  [103.15721698  -1.15413828  -0.94406541]
mat_Sqrt:  [[12.65497612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01496796 -0.05402022 -0.22973263]
Stock Position:  0.014967957207257264
Bond Position:  [-0.49258706]


portfolio before change:  [1.03993251]
curr_Stock_Price:  102.3908026941866
curr_Factors:  [102.39080269  -1.14712487  -0.94905567]
mat_Sqrt:  [[12.58639353  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00185418 0.01125792 0.21739204]
Stock Position:  0.0018541845955657675
Bond Position:  [0.85008107]


portfolio before change:  [1.03866113]
curr_Stock_Price:  101.64780497198038
curr_Factors:  [101.64780497  -1.36619883  -0.97925599]
mat_Sqrt:  [[ 9.73822764  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00395121 -0.00959029 -0.13861846]
Stock Position:  -0.00395120870348725
Bond Position:  [1.44029282]


portfolio before change:  [1.03965895]
curr_Stock_Price:  101.44083629295895
curr_Factors:  [101.44083629  -1.41335054  -0.98666525]
mat_Sqrt:  [[ 9.2023597   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01054651 -0.00431085  0.00489681]
Stock Position:  -0.01054650640203817
Bond Position:  [2.10950538]


portfolio before change:  [1.03923535]
curr_Stock_Price:  101.5060053878612
curr_Factors:  [101.50600539  -1.42906291  -0.98596236]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.03923535]
Stock Price:  101.08520517283276
PL:  [-0.04596982]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-7.36472984e-02 -1.78486952e-02 -1.90207461e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 1.64903938e-01  9.60752136e-02  1.51303226e-01]
 [-6.26988659e-05 -9.14896866e-03  8.62315146e-02]
 [-7.84287084e-01 -2.35307441e-01  3.34876287e-02]
 [ 3.38387337e-02 -1.68325694e-01 -2.22552309e-01]
 [ 3.68205731e-02 -5.99085649e-02 -1.83480372e-02]
 [ 2.04894821e-01 -1.37437189e-01 -2.32825734e-02]
 [-4.63164019e-01 -2.56834144e-02 -5.12235964e-02]
 [ 4.72921439e-02 -1.71123908e-02 -4.13211442e-02]
 [ 1.98725224e-02 -3.06911093e-01  1.69096278e-01]
 [-9.80274416e-02  1.01967986e-02  6.73488810e-02]
 [ 1.00011327e-01 -2.01010489e-02  2.66983970e-01]
 [ 9.44711852e-02  1.03712151e-01  7.08405001e-02]
 [ 2.81910526e-02 -1.04724918e-01 -5.21674123e-02]
 [-3.61561649e-02 -3.13435429e-02  1.50018415e-02]
 [-3.82949825e-01 -2.32385121e-01  9.18803405e-02]
 [-2.22457823e-01 -8.40884641e-02 -3.58705626e-02]
 [ 2.96546530e-01  1.24760597e+00  4.04602443e-01]
 [-2.37130048e-01 -3.07831082e-02  1.98774243e-01]
 [-9.15341535e-02  1.46057242e-01 -3.71503500e-02]
 [ 2.80394359e-02 -1.72601834e-03  2.84712394e-02]
 [-7.82419577e-02 -7.72947874e-03 -9.05977969e-02]
 [-1.01464858e-02 -1.15270727e-01  1.09696524e-01]
 [-1.09544001e-01  9.45714050e-02  2.00309471e-02]
 [ 9.52751356e-02 -1.34236597e-01 -1.51469564e-01]
 [ 6.42003494e-02 -3.20433499e-02  1.06977680e-01]
 [-7.54366908e-02  4.37276193e-02  7.79200571e-02]
 [-4.99508992e-01 -1.08430419e-02 -7.24649496e-01]
 [ 2.57385714e-01 -1.79969443e-01 -1.73848175e-01]
 [ 1.34046673e-01  1.49835604e-02 -3.15232694e-02]
 [ 5.41165749e-02  3.15871848e-01 -1.15866567e-01]
 [-1.50179377e-01  4.86484204e-02 -7.10872298e-02]
 [ 6.04195433e-02  1.20899163e-01  9.38409167e-02]
 [-3.55977249e-01  1.05187428e-01 -8.76048533e-02]
 [-3.04830039e-01 -3.75212413e-02 -8.11788938e-02]
 [ 5.20232207e-01  3.27451101e-01  7.50452340e-02]
 [-7.20011776e-03  2.47023277e-01  4.56150073e-02]
 [ 1.23070690e-03 -1.89432541e-01  5.70973542e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.49063322]
curr_Stock_Price:  100.15366354333824
curr_Factors:  [100.15366354  -1.21772482  -0.98155681]
mat_Sqrt:  [[11.10531713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00702283 -0.00564425 -0.05426089]
Stock Position:  -0.007022829003652648
Bond Position:  [4.19399527]


portfolio before change:  [3.49306966]
curr_Stock_Price:  99.88138520958776
curr_Factors:  [99.88138521 -1.4855633  -0.95808118]
mat_Sqrt:  [[ 8.67407639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0052318   0.01411938  0.0859571 ]
Stock Position:  -0.005231801153156982
Bond Position:  [4.01562921]


portfolio before change:  [3.49538174]
curr_Stock_Price:  99.53540675381227
curr_Factors:  [99.53540675 -1.49404544 -0.94470512]
mat_Sqrt:  [[ 8.68643718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02282515 0.03038165 0.43162599]
Stock Position:  0.022825149995580347
Bond Position:  [1.22347115]


portfolio before change:  [3.50923609]
curr_Stock_Price:  100.1356834406735
curr_Factors:  [100.13568344  -1.38473522  -0.94965227]
mat_Sqrt:  [[ 9.70012342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00178379 -0.00289316  0.24599451]
Stock Position:  0.0017837927663589797
Bond Position:  [3.33061478]


portfolio before change:  [3.50876369]
curr_Stock_Price:  99.63744744200645
curr_Factors:  [99.63744744 -1.17405865 -0.93576203]
mat_Sqrt:  [[12.08200787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06485073 -0.07441075  0.09553088]
Stock Position:  -0.06485073264984358
Bond Position:  [9.97032516]


portfolio before change:  [3.56980014]
curr_Stock_Price:  98.71548274753219
curr_Factors:  [98.71548275 -0.67843513 -0.91596961]
mat_Sqrt:  [[20.04214006  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079511 -0.05322926 -0.63487979]
Stock Position:  -0.0007951105422670097
Bond Position:  [3.64828987]


portfolio before change:  [3.56964575]
curr_Stock_Price:  99.48324981697444
curr_Factors:  [99.48324982 -0.48389661 -0.92153325]
mat_Sqrt:  [[24.3994215   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129218 -0.01894475 -0.05234184]
Stock Position:  0.00129218076594239
Bond Position:  [3.44109541]


portfolio before change:  [3.57206681]
curr_Stock_Price:  101.0239752024906
curr_Factors:  [101.0239752   -0.38213694  -0.93927092]
mat_Sqrt:  [[26.94910274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.007295   -0.04346146 -0.0664187 ]
Stock Position:  0.007294998805828391
Bond Position:  [2.83509703]


portfolio before change:  [3.57229885]
curr_Stock_Price:  101.00720150977402
curr_Factors:  [101.00720151  -0.46790396  -0.96789127]
mat_Sqrt:  [[24.03224778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01973528 -0.00812181 -0.14612666]
Stock Position:  -0.019735279835311342
Bond Position:  [5.56570424]


portfolio before change:  [3.56293802]
curr_Stock_Price:  101.5167756287986
curr_Factors:  [101.51677563  -0.45119574  -0.9899281 ]
mat_Sqrt:  [[24.02512668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00159898 -0.00541141 -0.11787772]
Stock Position:  0.0015989784856161068
Bond Position:  [3.40061488]


portfolio before change:  [3.56506838]
curr_Stock_Price:  102.58324265524085
curr_Factors:  [102.58324266  -0.53401145  -0.98612571]
mat_Sqrt:  [[22.43309728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00207126 -0.09705381  0.48238461]
Stock Position:  0.0020712585837569957
Bond Position:  [3.35259196]


portfolio before change:  [3.56516356]
curr_Stock_Price:  102.42685464256377
curr_Factors:  [102.42685464  -0.37366254  -0.98963621]
mat_Sqrt:  [[26.20237823  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320645  0.00322451  0.19212761]
Stock Position:  -0.0032064504941337942
Bond Position:  [3.8935902]


portfolio before change:  [3.56695248]
curr_Stock_Price:  102.02073928569861
curr_Factors:  [102.02073929  -0.49266426  -0.9696484 ]
mat_Sqrt:  [[23.63818604  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00651447 -0.00635651  0.76163095]
Stock Position:  0.006514467485647707
Bond Position:  [2.90234169]


portfolio before change:  [3.56258861]
curr_Stock_Price:  101.29517157924931
curr_Factors:  [101.29517158  -0.3775075   -0.98300275]
mat_Sqrt:  [[25.98523505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0042951  0.03279666 0.20208823]
Stock Position:  0.004295103651465323
Bond Position:  [3.12751535]


portfolio before change:  [3.55827502]
curr_Stock_Price:  100.19984114935454
curr_Factors:  [100.19984115  -0.56140315  -0.97625077]
mat_Sqrt:  [[21.53140752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068915 -0.03311693 -0.14881911]
Stock Position:  0.000689153201901163
Bond Position:  [3.48922197]


portfolio before change:  [3.55840145]
curr_Stock_Price:  99.75038054589731
curr_Factors:  [99.75038055 -0.88063802 -0.98074389]
mat_Sqrt:  [[15.50696011  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218632 -0.0099117   0.04279608]
Stock Position:  -0.0021863223561531123
Bond Position:  [3.77648794]


portfolio before change:  [3.55948133]
curr_Stock_Price:  99.4723846967523
curr_Factors:  [99.4723847  -0.58419175 -0.97129759]
mat_Sqrt:  [[20.99723411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01763065 -0.07348663  0.26210904]
Stock Position:  -0.01763065484006998
Bond Position:  [5.31324461]


portfolio before change:  [3.57860603]
curr_Stock_Price:  98.4253158333641
curr_Factors:  [98.42531583 -0.69623517 -0.96975307]
mat_Sqrt:  [[18.60275716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01246864 -0.02659111 -0.10232873]
Stock Position:  -0.012468636985535863
Bond Position:  [4.80583557]


portfolio before change:  [3.58284267]
curr_Stock_Price:  98.133714822591
curr_Factors:  [98.13371482 -0.80094859 -0.97217593]
mat_Sqrt:  [[16.66326296  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02468596 0.39452765 1.15421815]
Stock Position:  0.02468596373371997
Bond Position:  [1.16031734]


portfolio before change:  [3.56702824]
curr_Stock_Price:  97.48721492336325
curr_Factors:  [97.48721492 -0.85890206 -1.00344534]
mat_Sqrt:  [[15.14050855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01303458 -0.00973447  0.56704759]
Stock Position:  -0.013034584760396414
Bond Position:  [4.83773361]


portfolio before change:  [3.57285911]
curr_Stock_Price:  97.08627280451205
curr_Factors:  [97.0862728  -0.8815189  -0.99519197]
mat_Sqrt:  [[14.86321127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00641492  0.04618736 -0.10597961]
Stock Position:  -0.0064149162273241765
Bond Position:  [4.19565942]


portfolio before change:  [3.56942026]
curr_Stock_Price:  97.70410547897617
curr_Factors:  [97.70410548 -0.7603324  -0.99100872]
mat_Sqrt:  [[16.95567285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00199382 -0.00054581  0.08122052]
Stock Position:  0.0019938187091469045
Bond Position:  [3.37461599]


portfolio before change:  [3.56886719]
curr_Stock_Price:  97.21513552051863
curr_Factors:  [97.21513552 -0.79002539 -0.99083064]
mat_Sqrt:  [[16.3801524   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00591782 -0.00244428 -0.2584503 ]
Stock Position:  -0.005917816117009032
Bond Position:  [4.14416849]


portfolio before change:  [3.57045119]
curr_Stock_Price:  97.03501187785629
curr_Factors:  [97.03501188 -0.69420076 -1.00033154]
mat_Sqrt:  [[17.82388774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00052003 -0.0364518   0.31293365]
Stock Position:  0.0005200294249953145
Bond Position:  [3.51999013]


portfolio before change:  [3.57001632]
curr_Stock_Price:  95.35262517987735
curr_Factors:  [95.35262518 -0.74105029 -0.98152535]
mat_Sqrt:  [[17.03050628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00604876  0.0299061   0.05714272]
Stock Position:  -0.00604875606217666
Bond Position:  [4.14678109]


portfolio before change:  [3.5702774]
curr_Stock_Price:  95.39516287843422
curr_Factors:  [95.39516288 -0.63119025 -0.97586051]
mat_Sqrt:  [[19.12463158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00318388 -0.04244934 -0.43210051]
Stock Position:  0.003183881791511275
Bond Position:  [3.26655048]


portfolio before change:  [3.57084713]
curr_Stock_Price:  95.4458517189948
curr_Factors:  [95.44585172 -0.49076498 -0.96369146]
mat_Sqrt:  [[22.28920891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00382291 -0.010133    0.30517754]
Stock Position:  0.003822913658416936
Bond Position:  [3.20596588]


portfolio before change:  [3.57413649]
curr_Stock_Price:  96.2014497883145
curr_Factors:  [96.20144979 -0.6665018  -0.96558294]
mat_Sqrt:  [[18.80945546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310494  0.01382789  0.22228423]
Stock Position:  -0.0031049428109030126
Bond Position:  [3.87283649]


portfolio before change:  [3.57462996]
curr_Stock_Price:  96.19844432021466
curr_Factors:  [96.19844432 -0.71796378 -0.97198446]
mat_Sqrt:  [[17.75140991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03648766 -0.00342887 -2.06722331]
Stock Position:  -0.03648766043223468
Bond Position:  [7.08468613]


portfolio before change:  [3.65212722]
curr_Stock_Price:  94.09878587247165
curr_Factors:  [94.09878587 -0.53711337 -0.97306582]
mat_Sqrt:  [[20.78363609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01045305 -0.05691133 -0.49594045]
Stock Position:  0.010453046435560871
Bond Position:  [2.66850824]


portfolio before change:  [3.64005634]
curr_Stock_Price:  92.91210151400921
curr_Factors:  [92.91210151 -0.40987784 -0.97499938]
mat_Sqrt:  [[23.26096601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00550273  0.00473822 -0.08992711]
Stock Position:  0.0055027330474823185
Bond Position:  [3.12878585]


portfolio before change:  [3.63050772]
curr_Stock_Price:  91.10577285820423
curr_Factors:  [91.10577286 -0.46474658 -0.95675936]
mat_Sqrt:  [[21.98840431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175643  0.09988745 -0.33053507]
Stock Position:  0.0017564342713446972
Bond Position:  [3.47048642]


portfolio before change:  [3.6307616]
curr_Stock_Price:  91.0033198401633
curr_Factors:  [91.00331984 -0.58195381 -0.96316887]
mat_Sqrt:  [[19.40970712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00842021  0.01538398 -0.20279208]
Stock Position:  -0.008420214648825303
Bond Position:  [4.39702909]


portfolio before change:  [3.64041672]
curr_Stock_Price:  89.92194019488693
curr_Factors:  [89.92194019 -0.49858819 -0.95665267]
mat_Sqrt:  [[20.98275901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00394116 0.03823167 0.26770202]
Stock Position:  0.003941156794794663
Bond Position:  [3.28602025]


portfolio before change:  [3.63561526]
curr_Stock_Price:  88.59942575789573
curr_Factors:  [88.59942576 -0.75521278 -0.95312835]
mat_Sqrt:  [[16.05121016  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02312247  0.03326319 -0.24991226]
Stock Position:  -0.023122467627270073
Bond Position:  [5.68425261]


portfolio before change:  [3.65566687]
curr_Stock_Price:  87.76296487845967
curr_Factors:  [87.76296488 -0.56410793 -0.93628452]
mat_Sqrt:  [[19.57488073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01646852 -0.01186526 -0.23158079]
Stock Position:  -0.016468524624939196
Bond Position:  [5.10099342]


portfolio before change:  [3.69109642]
curr_Stock_Price:  85.65033614988114
curr_Factors:  [85.65033615 -0.62240669 -0.90210421]
mat_Sqrt:  [[18.64843521  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02917164 0.10354913 0.21408316]
Stock Position:  0.029171643395316794
Bond Position:  [1.19253535]


portfolio before change:  [3.68322326]
curr_Stock_Price:  85.37533495724928
curr_Factors:  [85.37533496 -0.72609353 -0.90989377]
mat_Sqrt:  [[16.62769943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00051054 0.07811562 0.13012692]
Stock Position:  0.0005105408745555312
Bond Position:  [3.63963566]


portfolio before change:  [3.68280209]
curr_Stock_Price:  83.65922025716631
curr_Factors:  [83.65922026 -0.52463404 -0.92812784]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.68280209]
Stock Price:  83.96664271234746
PL:  [3.68280209]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.68316232e-01  3.93008376e-01  4.74961814e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 3.25201031e-01  3.31683074e-01  4.35164932e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-6.53021312e-01 -1.98124876e-01  3.66954270e-02]
 [-4.35375139e-02 -2.08569380e-02  1.08234863e-04]
 [ 3.24738296e-02  6.57004844e-02 -3.00435540e-03]
 [ 2.11384661e-01 -1.31259446e-01 -2.63451076e-02]
 [-5.01329547e-01 -2.63871472e-02 -6.52400721e-02]
 [ 4.85611294e-02 -1.92682607e-02 -4.23313720e-02]
 [ 1.11419309e-02 -2.88393559e-01  1.75329728e-01]
 [-1.71395124e-01  2.51972275e-02  1.39392401e-01]
 [ 4.03786681e-02 -2.49910436e-03  2.22018299e-01]
 [ 3.89025007e-02  3.59103554e-01  3.17548773e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-3.21044936e-02  3.29081607e-02  4.24782507e-02]
 [-4.90837620e-01 -2.87652223e-02  1.74283802e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 6.16052838e-02  6.39308082e-01  7.52881064e-02]
 [-2.32445337e-02  3.88890057e-02  2.43565757e-02]
 [ 4.20876664e-02 -2.29664767e-01  1.10309980e-01]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 7.82086407e-02 -3.85299315e-02  9.83297887e-02]
 [ 4.93646320e-02  2.15451333e-01  1.06994525e-01]
 [-5.73314225e-02 -1.82265898e-01 -1.05778865e-02]
 [ 6.76957111e-02  2.88618085e-02 -1.41601562e-02]
 [-7.76809938e-04 -3.26720380e-02 -3.17545669e-02]
 [ 3.52182758e-03  4.52699934e-02 -6.46224613e-02]
 [-6.04424779e-01 -3.01797460e-02 -8.91156929e-01]
 [-2.16358045e-01  7.12999851e-02 -3.90584797e-03]
 [-6.40309969e-02  5.85262325e-02  1.48180937e-01]
 [ 8.35924690e-03  1.33674576e-02  2.90683492e-02]
 [-1.14994902e-01 -3.66003252e-03 -1.50779869e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 2.11928135e-01 -1.67195389e-01 -7.26027821e-02]
 [ 2.15697775e-02  2.50295932e-02  6.02393782e-02]
 [-2.13702726e-02 -2.86678045e-02 -4.27887142e-02]
 [-9.98635088e-02 -2.20602861e-02  2.46882558e-03]
 [-1.01895332e-02 -2.94598371e-01  1.14089446e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.0488134]
curr_Stock_Price:  98.68520280713486
curr_Factors:  [98.68520281 -0.56559068 -1.02439493]
mat_Sqrt:  [[20.12472995  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00801092  0.12428016  1.35493385]
Stock Position:  -0.008010921145109253
Bond Position:  [-6.25825402]


portfolio before change:  [-7.05335835]
curr_Stock_Price:  99.15488953793299
curr_Factors:  [99.15488954 -0.71359357 -0.99976088]
mat_Sqrt:  [[17.87367077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253899  0.01411938  0.0859571 ]
Stock Position:  -0.0025389884053017052
Bond Position:  [-6.80160524]


portfolio before change:  [-7.05555604]
curr_Stock_Price:  99.68558562027711
curr_Factors:  [99.68558562 -0.54170812 -0.9966279 ]
mat_Sqrt:  [[21.40629565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01974152 0.1048874  1.24140442]
Stock Position:  0.019741515683933467
Bond Position:  [-9.02350059]


portfolio before change:  [-7.0210589]
curr_Stock_Price:  101.49016576869191
curr_Factors:  [101.49016577  -0.61535866  -1.00531015]
mat_Sqrt:  [[20.07134321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098165 -0.00659539  0.21422481]
Stock Position:  0.0009816509885795322
Bond Position:  [-7.12068682]


portfolio before change:  [-7.02200186]
curr_Stock_Price:  101.43635628475937
curr_Factors:  [101.43635628  -0.59325344  -1.00393361]
mat_Sqrt:  [[20.53733661  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03168115 -0.06265259  0.10468184]
Stock Position:  -0.0316811504919897
Bond Position:  [-3.80838139]


portfolio before change:  [-7.01295964]
curr_Stock_Price:  101.13591580076914
curr_Factors:  [101.1359158   -0.66117118  -1.00492798]
mat_Sqrt:  [[19.11295085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230493 -0.00659554  0.00030876]
Stock Position:  -0.002304926365466679
Bond Position:  [-6.7798488]


portfolio before change:  [-7.012784]
curr_Stock_Price:  100.69200857269563
curr_Factors:  [100.69200857  -0.71094545  -0.99115823]
mat_Sqrt:  [[18.356115    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00182811  0.02077632 -0.00857059]
Stock Position:  0.0018281072726623537
Bond Position:  [-7.19685979]


portfolio before change:  [-7.0135358]
curr_Stock_Price:  100.77289076553512
curr_Factors:  [100.77289077  -0.46266341  -1.02048489]
mat_Sqrt:  [[22.86760034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00886048 -0.04150788 -0.07515526]
Stock Position:  0.008860478637059747
Bond Position:  [-7.90643185]


portfolio before change:  [-7.00594301]
curr_Stock_Price:  101.74136587920542
curr_Factors:  [101.74136588  -0.60080312  -1.01211124]
mat_Sqrt:  [[20.27765632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02541358 -0.00834435 -0.18611177]
Stock Position:  -0.02541358457476524
Bond Position:  [-4.42033021]


portfolio before change:  [-6.99267733]
curr_Stock_Price:  101.19763067769955
curr_Factors:  [101.19763068  -0.5578941   -0.98816109]
mat_Sqrt:  [[21.56389006  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00182818 -0.00609316 -0.12075962]
Stock Position:  0.001828184517442511
Bond Position:  [-7.17768527]


portfolio before change:  [-6.989997]
curr_Stock_Price:  103.15454096756692
curr_Factors:  [103.15454097  -0.58337559  -1.00656711]
mat_Sqrt:  [[21.03705827  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187691 -0.09119805  0.50016691]
Stock Position:  0.00187691033906257
Bond Position:  [-7.18360883]


portfolio before change:  [-6.99004018]
curr_Stock_Price:  103.60998418594649
curr_Factors:  [103.60998419  -0.69286325  -1.01179346]
mat_Sqrt:  [[18.83990049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00755265  0.00796806  0.39764772]
Stock Position:  -0.007552650264831372
Bond Position:  [-6.20751021]


portfolio before change:  [-6.99090386]
curr_Stock_Price:  103.62159452936727
curr_Factors:  [103.62159453  -0.5898068   -1.01243374]
mat_Sqrt:  [[20.87401758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00410239 -0.00079029  0.63335641]
Stock Position:  0.004102393644893007
Bond Position:  [-7.41600043]


portfolio before change:  [-6.99370698]
curr_Stock_Price:  103.16428588396768
curr_Factors:  [103.16428588  -0.5693525   -1.0246713 ]
mat_Sqrt:  [[20.95335821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00539264 0.11355851 0.90587826]
Stock Position:  0.0053926385070767755
Bond Position:  [-7.55003468]


portfolio before change:  [-6.9948904]
curr_Stock_Price:  103.11985256365072
curr_Factors:  [103.11985256  -0.53940792  -1.04416782]
mat_Sqrt:  [[21.16430829  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202823 -0.03587186 -0.12433753]
Stock Position:  0.002028232296943947
Bond Position:  [-7.20404142]


portfolio before change:  [-6.99542813]
curr_Stock_Price:  103.29874664619622
curr_Factors:  [103.29874665  -0.20757121  -1.04428943]
mat_Sqrt:  [[29.54057087  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076451  0.01040647  0.12117863]
Stock Position:  -0.0007645069558146017
Bond Position:  [-6.91645552]


portfolio before change:  [-6.99759442]
curr_Stock_Price:  105.00138673514306
curr_Factors:  [105.00138674  -0.19997529  -1.0276345 ]
mat_Sqrt:  [[30.76457191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0148224  -0.00909636  0.49718317]
Stock Position:  -0.014822400389336928
Bond Position:  [-5.44122182]


portfolio before change:  [-6.98783629]
curr_Stock_Price:  104.29716062887333
curr_Factors:  [104.29716063  -0.32906245  -1.0316344 ]
mat_Sqrt:  [[26.75034284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00490876  0.00580111 -0.05715682]
Stock Position:  -0.0049087626496969634
Bond Position:  [-6.47586629]


portfolio before change:  [-6.99160653]
curr_Stock_Price:  104.90030783538937
curr_Factors:  [104.90030784  -0.40671404  -1.02693866]
mat_Sqrt:  [[25.01205107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00373741 0.20216697 0.21477601]
Stock Position:  0.0037374091212420183
Bond Position:  [-7.3836619]


portfolio before change:  [-6.98997731]
curr_Stock_Price:  105.58319809048183
curr_Factors:  [105.58319809  -0.20023779  -1.00327483]
mat_Sqrt:  [[31.68953912  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054493  0.01229778  0.06948253]
Stock Position:  -0.0005449324645467084
Bond Position:  [-6.93244159]


portfolio before change:  [-6.99061865]
curr_Stock_Price:  105.16980561945894
curr_Factors:  [105.16980562  -0.35299344  -0.99877472]
mat_Sqrt:  [[27.21608291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215588 -0.07262638  0.31468367]
Stock Position:  0.0021558825387758946
Bond Position:  [-7.21735239]


portfolio before change:  [-6.99540662]
curr_Stock_Price:  103.36741084747914
curr_Factors:  [103.36741085  -0.38433595  -0.98955627]
mat_Sqrt:  [[26.1643427   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148557  0.01916992 -0.08961985]
Stock Position:  -0.0014855662201693493
Bond Position:  [-6.84184749]


portfolio before change:  [-6.99300107]
curr_Stock_Price:  101.17240032686773
curr_Factors:  [101.17240033  -0.48243976  -0.9907138 ]
mat_Sqrt:  [[23.18887013  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00419534 -0.01218423  0.28050752]
Stock Position:  0.0041953439602559804
Bond Position:  [-7.41745409]


portfolio before change:  [-7.00101316]
curr_Stock_Price:  99.48365892995261
curr_Factors:  [99.48365893 -0.60757327 -1.01461239]
mat_Sqrt:  [[19.64470317  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00390781 0.06813169 0.3052256 ]
Stock Position:  0.003907807958509481
Bond Position:  [-7.3897762]


portfolio before change:  [-6.99797334]
curr_Stock_Price:  100.49793699374845
curr_Factors:  [100.49793699  -0.96577128  -1.01883344]
mat_Sqrt:  [[13.81192676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00464792 -0.05763754 -0.03017577]
Stock Position:  -0.004647918488368272
Bond Position:  [-6.53086712]


portfolio before change:  [-6.99811026]
curr_Stock_Price:  100.35174418299415
curr_Factors:  [100.35174418  -1.1614956   -1.01410906]
mat_Sqrt:  [[11.39388486  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00575313  0.00912691 -0.04039498]
Stock Position:  0.005753129054034461
Bond Position:  [-7.57544679]


portfolio before change:  [-6.9924399]
curr_Stock_Price:  101.50196210185742
curr_Factors:  [101.5019621   -1.06966536  -1.0407435 ]
mat_Sqrt:  [[12.30086108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00065868 -0.01033181 -0.09058694]
Stock Position:  -0.0006586752019185951
Bond Position:  [-6.92558307]


portfolio before change:  [-6.99331861]
curr_Stock_Price:  101.521636126785
curr_Factors:  [101.52163613  -1.19344186  -1.01510422]
mat_Sqrt:  [[11.15319344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076214  0.01431563 -0.18434989]
Stock Position:  -0.0007621414386531351
Bond Position:  [-6.91594476]


portfolio before change:  [-6.99421144]
curr_Stock_Price:  101.5587462830742
curr_Factors:  [101.55874628  -1.29709672  -1.02160681]
mat_Sqrt:  [[ 9.99349002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07876234 -0.00954367 -2.54222267]
Stock Position:  -0.07876234050906915
Bond Position:  [1.00479312]


portfolio before change:  [-7.01375415]
curr_Stock_Price:  101.80846365951177
curr_Factors:  [101.80846366  -1.58011089  -1.0219195 ]
mat_Sqrt:  [[ 7.54634128  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02853229  0.02254704 -0.0111423 ]
Stock Position:  -0.028532285723890296
Bond Position:  [-4.10892598]


portfolio before change:  [-7.01448009]
curr_Stock_Price:  101.81590377357894
curr_Factors:  [101.81590377  -1.53052584  -1.02911743]
mat_Sqrt:  [[ 7.8736603   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0040988   0.01850762  0.42271897]
Stock Position:  -0.0040987987436517555
Bond Position:  [-6.59715719]


portfolio before change:  [-7.01499039]
curr_Stock_Price:  101.73920012472614
curr_Factors:  [101.73920012  -1.53886832  -1.00848152]
mat_Sqrt:  [[ 7.96504691  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00183777 0.00422716 0.08292391]
Stock Position:  0.0018377726178817593
Bond Position:  [-7.20196391]


portfolio before change:  [-7.01790381]
curr_Stock_Price:  100.64379010555533
curr_Factors:  [100.64379011  -1.36971445  -1.03091924]
mat_Sqrt:  [[ 9.12441476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01598647 -0.0011574  -0.430133  ]
Stock Position:  -0.015986473606625088
Bond Position:  [-5.40896451]


portfolio before change:  [-7.01127301]
curr_Stock_Price:  100.18671907380586
curr_Factors:  [100.18671907  -1.36420975  -1.01251751]
mat_Sqrt:  [[ 9.30273434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00563423  0.0049611   0.16678008]
Stock Position:  -0.005634225554543212
Bond Position:  [-6.44679844]


portfolio before change:  [-7.01363089]
curr_Stock_Price:  100.46217450527993
curr_Factors:  [100.46217451  -1.45047351  -1.02089216]
mat_Sqrt:  [[ 8.48598192  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02271878 -0.05287182 -0.20711553]
Stock Position:  0.02271878373555108
Bond Position:  [-9.29600931]


portfolio before change:  [-7.02694542]
curr_Stock_Price:  99.92726664590059
curr_Factors:  [99.92726665 -1.77479834 -0.99919606]
mat_Sqrt:  [[ 6.23668122  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00553377 0.00791505 0.17184618]
Stock Position:  0.005533768553713348
Bond Position:  [-7.57991979]


portfolio before change:  [-7.02592869]
curr_Stock_Price:  100.28223004192328
curr_Factors:  [100.28223004  -1.64753857  -0.98744058]
mat_Sqrt:  [[ 7.19228815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428858 -0.00906556 -0.12206429]
Stock Position:  -0.004288577036224432
Bond Position:  [-6.59586062]


portfolio before change:  [-7.02422986]
curr_Stock_Price:  99.69383999143979
curr_Factors:  [99.69383999 -1.34983244 -0.98977038]
mat_Sqrt:  [[ 9.6070871   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01040161 -0.00697607  0.00704287]
Stock Position:  -0.010401608200983434
Bond Position:  [-5.9872536]


portfolio before change:  [-7.02514725]
curr_Stock_Price:  99.71008075678688
curr_Factors:  [99.71008076 -1.07711625 -1.00698727]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.02514725]
Stock Price:  99.92096801139037
PL:  [-7.02514725]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.92717533e-01  2.62092852e-01  3.08856681e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.79828930e-01  3.86260721e-01  5.50933824e-01]
 [ 1.80121013e-02  5.71806909e-02  1.46583198e-01]
 [-1.03287970e-01 -4.24064765e-02  5.01294976e-02]
 [ 4.85039897e-03 -1.13672376e-01 -1.40647533e-01]
 [ 3.66632422e-02 -1.12868244e-02 -2.14824714e-02]
 [ 1.10683642e-01  1.11502917e-01 -1.27089859e-02]
 [-7.00476240e-02  1.44476090e-02 -4.53026471e-02]
 [ 1.36632076e-01  3.77435041e-02  2.65336444e-01]
 [ 1.58568991e-01 -2.59063725e-01 -2.26356080e-02]
 [-6.53461658e-02 -6.68237618e-02 -1.44511272e-01]
 [ 2.55025884e-01 -2.98358370e-01 -4.04313406e-02]
 [ 1.01276419e-01 -6.33109636e-02 -3.92618468e-02]
 [-1.00271727e-01  8.05450419e-02  7.24873689e-02]
 [ 2.19560661e-02 -2.50831704e-01 -5.89920348e-02]
 [-1.30153409e-01 -2.79229536e-01  1.10734790e-03]
 [-2.48453386e-01 -1.27346417e-01 -3.91682027e-02]
 [ 2.43893885e-01  1.20275869e+00  2.47368299e-01]
 [-1.49027629e-01 -2.58873944e-02  1.14116266e-01]
 [-4.66487662e-02  1.34808584e-01  2.05788119e-03]
 [-2.88206561e-02  6.20426914e-02 -3.16899668e-02]
 [ 1.36970069e-01 -3.60903685e-02  1.49086561e-01]
 [ 8.55173397e-02 -9.29258283e-02 -6.83113703e-02]
 [-9.50920954e-02  9.57383724e-03  2.01797607e-01]
 [ 1.28465514e-02  6.13320592e-02  3.13657293e-02]
 [ 7.05254249e-02 -4.83452822e-02  3.39768699e-01]
 [ 3.95218944e-02  4.65148309e-02 -6.43316019e-02]
 [-6.61555292e-01 -9.23943932e-02 -1.03271444e+00]
 [ 1.77686693e-02 -9.13395670e-02 -7.15319240e-02]
 [ 2.84151621e-02  7.42084499e-03  1.20805321e-01]
 [ 2.20054795e-02  9.29375493e-02 -8.67888065e-03]
 [-1.33614611e-01 -1.56929245e-02 -1.21875821e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [-1.15149297e-01  9.19881945e-02  1.49347478e-01]
 [-7.08687028e-02 -8.93594257e-02  3.66137521e-02]
 [ 7.10527933e-02  5.36705418e-02  6.38281648e-03]
 [-8.64575723e-02  7.80712505e-02 -1.97681259e-03]
 [ 2.21871305e-03 -2.50018858e-01  8.57224176e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.69300566]
curr_Stock_Price:  99.15276738481911
curr_Factors:  [99.15276738 -0.84766348 -1.02930996]
mat_Sqrt:  [[15.17559172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00809887  0.08288104  0.88108214]
Stock Position:  -0.00809887488541414
Bond Position:  [-2.8899798]


portfolio before change:  [-3.69677797]
curr_Stock_Price:  99.57394284218675
curr_Factors:  [99.57394284 -0.41405612 -1.01821457]
mat_Sqrt:  [[23.77488627  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190878  0.01411938  0.0859571 ]
Stock Position:  -0.0019087806489565874
Bond Position:  [-3.50671316]


portfolio before change:  [-3.69435213]
curr_Stock_Price:  98.07339595913125
curr_Factors:  [98.07339596 -0.45349421 -1.01981685]
mat_Sqrt:  [[22.47503372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01789813 0.12214637 1.57166085]
Stock Position:  0.017898128195599855
Bond Position:  [-5.44968234]


portfolio before change:  [-3.67050114]
curr_Stock_Price:  99.44405559332235
curr_Factors:  [99.44405559 -0.518349   -1.02894276]
mat_Sqrt:  [[21.16403902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0023346  0.01808212 0.41816106]
Stock Position:  0.002334604958971739
Bond Position:  [-3.90266372]


portfolio before change:  [-3.67197377]
curr_Stock_Price:  99.02223943391975
curr_Factors:  [99.02223943 -0.41954955 -1.00458194]
mat_Sqrt:  [[23.83637963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00394986 -0.01341011  0.1430055 ]
Stock Position:  -0.003949855687618149
Bond Position:  [-3.28085022]


portfolio before change:  [-3.67588525]
curr_Stock_Price:  99.90868776485705
curr_Factors:  [99.90868776 -0.33368819 -1.01913623]
mat_Sqrt:  [[25.82730391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103744 -0.03594636 -0.40122826]
Stock Position:  -0.00103743567798706
Bond Position:  [-3.57223641]


portfolio before change:  [-3.67640705]
curr_Stock_Price:  99.981219277336
curr_Factors:  [99.98121928 -0.42772542 -1.01507273]
mat_Sqrt:  [[23.62213534  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013541  -0.00356921 -0.06128351]
Stock Position:  0.0013540997049117658
Bond Position:  [-3.81179159]


portfolio before change:  [-3.67846923]
curr_Stock_Price:  98.8102007308953
curr_Factors:  [98.81020073 -0.43100603 -1.02949752]
mat_Sqrt:  [[22.93576053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00483823  0.03526032 -0.0362552 ]
Stock Position:  0.004838227342367465
Bond Position:  [-4.15653545]


portfolio before change:  [-3.68867929]
curr_Stock_Price:  96.80730655318008
curr_Factors:  [96.80730655 -0.40429101 -1.04368971]
mat_Sqrt:  [[22.75401835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00346848  0.00456874 -0.12923584]
Stock Position:  -0.0034684841700456316
Bond Position:  [-3.35290468]


portfolio before change:  [-3.68844435]
curr_Stock_Price:  96.61873006515971
curr_Factors:  [96.61873007 -0.48668709 -1.04711099]
mat_Sqrt:  [[20.84209082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00920101 0.01193554 0.75693102]
Stock Position:  0.009201005107321598
Bond Position:  [-4.57743378]


portfolio before change:  [-3.68487625]
curr_Stock_Price:  97.06871512997355
curr_Factors:  [97.06871513 -0.64241799 -1.04100573]
mat_Sqrt:  [[18.02924943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00816781 -0.08192314 -0.06457309]
Stock Position:  0.008167812013969553
Bond Position:  [-4.47771527]


portfolio before change:  [-3.67809526]
curr_Stock_Price:  97.9674559211425
curr_Factors:  [97.96745592 -0.73533884 -1.05183518]
mat_Sqrt:  [[16.40295198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00588734 -0.02113153 -0.41225043]
Stock Position:  -0.005887341978695147
Bond Position:  [-3.10132734]


portfolio before change:  [-3.67403861]
curr_Stock_Price:  97.212559124935
curr_Factors:  [97.21255912 -0.78117528 -1.049266  ]
mat_Sqrt:  [[15.58733363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01533741 -0.0943492  -0.11533936]
Stock Position:  0.015337407729748396
Bond Position:  [-5.16502727]


portfolio before change:  [-3.66591728]
curr_Stock_Price:  97.78416851772614
curr_Factors:  [97.78416852 -0.55087073 -1.04120114]
mat_Sqrt:  [[19.89942458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00460453 -0.02002068 -0.11200312]
Stock Position:  0.004604527424688296
Bond Position:  [-4.11616716]


portfolio before change:  [-3.6643022]
curr_Stock_Price:  98.24667519759979
curr_Factors:  [98.2466752  -0.69922885 -1.03924815]
mat_Sqrt:  [[17.27057887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00482877  0.02547058  0.20678629]
Stock Position:  -0.004828769306775994
Bond Position:  [-3.18989167]


portfolio before change:  [-3.66062229]
curr_Stock_Price:  97.4020134143806
curr_Factors:  [97.40201341 -0.54992704 -1.06831721]
mat_Sqrt:  [[19.30960491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00017804 -0.07931995 -0.16828786]
Stock Position:  0.00017804200117821445
Bond Position:  [-3.67796394]


portfolio before change:  [-3.66113131]
curr_Stock_Price:  97.1253891273593
curr_Factors:  [97.12538913 -0.32442227 -1.06822058]
mat_Sqrt:  [[24.12768574  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0056838  -0.08830013  0.00315896]
Stock Position:  -0.0056838044760340305
Bond Position:  [-3.10908959]


portfolio before change:  [-3.6647428]
curr_Stock_Price:  97.6924082505571
curr_Factors:  [97.69240825 -0.12284908 -1.06858799]
mat_Sqrt:  [[29.67742868  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00875199 -0.04027047 -0.11173598]
Stock Position:  -0.008751992468206056
Bond Position:  [-2.80973958]


portfolio before change:  [-3.67604665]
curr_Stock_Price:  98.94385012563048
curr_Factors:  [98.94385013 -0.14349807 -1.08295444]
mat_Sqrt:  [[29.02333072  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01121315 0.38034569 0.7056729 ]
Stock Position:  0.011213145259964646
Bond Position:  [-4.78551841]


portfolio before change:  [-3.66532494]
curr_Stock_Price:  99.95337340521398
curr_Factors:  [99.95337341 -0.12247103 -1.08419553]
mat_Sqrt:  [[29.90534551  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00422674 -0.00818631  0.32554194]
Stock Position:  -0.00422674111976498
Bond Position:  [-3.24284791]


portfolio before change:  [-3.67248203]
curr_Stock_Price:  101.55075233338157
curr_Factors:  [ 1.01550752e+02 -6.57867570e-02 -1.10173126e+00]
mat_Sqrt:  [[31.59632058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135294  0.04263022  0.00587056]
Stock Position:  -0.0013529410854436219
Bond Position:  [-3.53508985]


portfolio before change:  [-3.67559455]
curr_Stock_Price:  103.52467386670479
curr_Factors:  [ 1.03524674e+02 -3.04638684e-02 -1.08198824e+00]
mat_Sqrt:  [[34.03392684  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098982  0.01961962 -0.09040265]
Stock Position:  -0.0009898184313531949
Bond Position:  [-3.57312392]


portfolio before change:  [-3.67481025]
curr_Stock_Price:  102.28105061233691
curr_Factors:  [102.28105061  -0.15756565  -1.09154535]
mat_Sqrt:  [[29.33007441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00567576 -0.01141278  0.42530246]
Stock Position:  0.005675757369915018
Bond Position:  [-4.25533268]


portfolio before change:  [-3.66657939]
curr_Stock_Price:  103.8249527044616
curr_Factors:  [ 1.03824953e+02 -2.52714866e-02 -1.12503914e+00]
mat_Sqrt:  [[32.86458731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210482 -0.02938573 -0.19487333]
Stock Position:  0.002104818916727954
Bond Position:  [-3.88511211]


portfolio before change:  [-3.66576578]
curr_Stock_Price:  104.44224130919841
curr_Factors:  [ 1.04442241e+02  4.38084041e-02 -1.11969674e+00]
mat_Sqrt:  [[35.61425111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150651  0.00302751  0.5756724 ]
Stock Position:  -0.0015065074847583119
Bond Position:  [-3.50842276]


portfolio before change:  [-3.66801906]
curr_Stock_Price:  105.64681456952488
curr_Factors:  [ 1.05646815e+02 -5.76688998e-02 -1.13042302e+00]
mat_Sqrt:  [[32.20139167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00064695 0.0193949  0.0894777 ]
Stock Position:  0.0006469484689039676
Bond Position:  [-3.7363671]


portfolio before change:  [-3.66952706]
curr_Stock_Price:  104.037836779451
curr_Factors:  [ 1.04037837e+02 -6.70093294e-02 -1.15087403e+00]
mat_Sqrt:  [[30.78018963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00450394 -0.01528812  0.96926553]
Stock Position:  0.004503940751799833
Bond Position:  [-4.13810731]


portfolio before change:  [-3.68464531]
curr_Stock_Price:  100.79601994732212
curr_Factors:  [100.79601995   0.12006488  -1.16259504]
mat_Sqrt:  [[35.53679773  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00077641  0.01470928 -0.18352015]
Stock Position:  0.0007764140473738387
Bond Position:  [-3.76290475]


portfolio before change:  [-3.68599091]
curr_Stock_Price:  99.66876693416268
curr_Factors:  [99.66876693  0.36595919 -1.18655648]
mat_Sqrt:  [[43.87106818  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01993895 -0.02921767 -2.94604684]
Stock Position:  -0.0199389459377161
Bond Position:  [-1.69870076]


portfolio before change:  [-3.65987685]
curr_Stock_Price:  98.34841554553437
curr_Factors:  [98.34841555  0.32717832 -1.20432451]
mat_Sqrt:  [[40.90982439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.97727304e-05 -2.88841072e-02 -2.04060669e-01]
Stock Position:  1.977273040388387e-05
Bond Position:  [-3.66182147]


portfolio before change:  [-3.66025113]
curr_Stock_Price:  102.57019290230302
curr_Factors:  [102.5701929    0.21320473  -1.24155831]
mat_Sqrt:  [[36.67861161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00145224 0.00234668 0.34462396]
Stock Position:  0.0014522373692777276
Bond Position:  [-3.8092074]


portfolio before change:  [-3.66196985]
curr_Stock_Price:  101.71459153232401
curr_Factors:  [101.71459153   0.27246022  -1.20653484]
mat_Sqrt:  [[39.96868007  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056628  0.02938943 -0.02475843]
Stock Position:  0.0005662820880865437
Bond Position:  [-3.719569]


portfolio before change:  [-3.66292578]
curr_Stock_Price:  100.84760826530734
curr_Factors:  [100.84760827   0.28973087  -1.20137634]
mat_Sqrt:  [[40.52686469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0039208  -0.00496254 -0.34767779]
Stock Position:  -0.0039207967181657
Bond Position:  [-3.26752281]


portfolio before change:  [-3.66113751]
curr_Stock_Price:  100.28733047949447
curr_Factors:  [100.28733048   0.1816495   -1.2040004 ]
mat_Sqrt:  [[36.07818771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00145278  0.0049611   0.16678008]
Stock Position:  -0.0014527809430417275
Bond Position:  [-3.51544199]


portfolio before change:  [-3.65791707]
curr_Stock_Price:  97.76809559928935
curr_Factors:  [ 9.77680956e+01  2.08513462e-03 -1.18473803e+00]
mat_Sqrt:  [[29.96246429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00274639  0.02908922  0.42604678]
Stock Position:  -0.002746394440389847
Bond Position:  [-3.38940732]


portfolio before change:  [-3.65692994]
curr_Stock_Price:  97.25439370988482
curr_Factors:  [ 9.72543937e+01 -5.00728080e-02 -1.18675664e+00]
mat_Sqrt:  [[28.23325987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00232712 -0.02825793  0.10444884]
Stock Position:  -0.0023271206632683025
Bond Position:  [-3.43060724]


portfolio before change:  [-3.65754236]
curr_Stock_Price:  97.33327257804373
curr_Factors:  [ 9.73332726e+01 -6.29893403e-02 -1.20571908e+00]
mat_Sqrt:  [[27.36958803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00269428 0.01697212 0.0182084 ]
Stock Position:  0.0026942841660043074
Bond Position:  [-3.91978585]


portfolio before change:  [-3.65352985]
curr_Stock_Price:  99.00440732916762
curr_Factors:  [ 9.90044073e+01 -4.50959617e-02 -1.22338727e+00]
mat_Sqrt:  [[27.84577188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304697  0.0246883  -0.0056393 ]
Stock Position:  -0.0030469723309409016
Bond Position:  [-3.35186616]


portfolio before change:  [-3.65290432]
curr_Stock_Price:  98.66159425545469
curr_Factors:  [ 9.86615943e+01 -9.62171530e-03 -1.21020323e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.65290432]
Stock Price:  98.0332956934249
PL:  [-3.65290432]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.03529619e-01  1.37855724e-02  3.89007997e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 3.90447905e-01 -2.73976208e-01 -5.62310549e-01]
 [ 3.57528354e-03 -1.77090876e-02  7.80887817e-02]
 [-5.12920390e-01 -1.58123121e-01  3.83745297e-02]
 [-4.35640818e-02  1.39131374e-02  4.46321066e-02]
 [-1.40037702e-03  1.40929094e-01  9.88548550e-02]
 [ 2.38289201e-01 -3.13419584e-01 -1.57623160e-02]
 [-5.02875112e-01 -2.57025499e-02 -6.88102176e-02]
 [ 3.21272771e-02  8.65108759e-03 -2.92485318e-02]
 [ 6.48223253e-03 -2.81214497e-01  1.89237128e-01]
 [-2.91103453e-01  4.96722583e-02  2.56940197e-01]
 [ 3.51375296e-02  1.91732550e-01  1.09355594e-01]
 [-7.13941925e-02  1.02149209e+00  9.71266436e-01]
 [ 1.73000797e-01 -1.39314179e-01 -7.30701401e-02]
 [-6.95761480e-03 -2.96830980e-02  3.27576792e-02]
 [-5.38642652e-01 -2.50893157e-02  1.95351669e-01]
 [-1.19133855e-01  1.89009022e-02 -2.71635698e-02]
 [ 2.68988565e-02  5.88134011e-01  5.10163647e-02]
 [-1.92626482e-02  3.60292249e-02  2.52181917e-02]
 [-7.44844428e-03 -2.43575100e-01  5.47159818e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 8.34177663e-02 -4.24134066e-02  1.01317120e-01]
 [ 6.80002694e-02  3.10405268e-01  1.09673282e-01]
 [-1.00111689e-01 -2.32984536e-02  1.14274357e-01]
 [ 1.25245255e-01 -4.77114784e-02 -1.56622881e-02]
 [ 8.29459104e-02 -9.53225483e-03  1.01451662e-01]
 [-1.72632126e-02  4.49593421e-02 -2.30651921e-02]
 [-7.17829491e-01 -8.84082943e-02 -1.10451592e+00]
 [ 2.04076117e-01 -1.28853016e-01 -1.61052129e-01]
 [ 1.34034071e-01  1.52378452e-02 -3.13507946e-02]
 [ 2.69550138e-02  1.49906373e-01 -3.68302749e-02]
 [-1.36453876e-01 -1.69704838e-02 -1.33439103e-01]
 [-6.20771822e-02  7.97473940e-02  9.90902249e-02]
 [ 1.40814808e-01 -1.03430486e-01 -1.26946117e-02]
 [-1.06568812e-02  1.61301340e-01  8.04195774e-02]
 [ 1.07100030e-01  8.52118732e-02 -2.38647089e-02]
 [-1.45595035e-02  6.37602009e-02 -1.09851452e-02]
 [-1.20157735e-01 -2.40295409e-01  4.89697948e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.50672366]
curr_Stock_Price:  100.1559054249442
curr_Factors:  [100.15590542  -0.88677313  -1.01942456]
mat_Sqrt:  [[14.88762505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00639679  0.00435938  0.11097315]
Stock Position:  -0.006396794936917795
Bond Position:  [4.14740045]


portfolio before change:  [3.50642585]
curr_Stock_Price:  100.28351165683648
curr_Factors:  [100.28351166  -0.56732752  -1.03931512]
mat_Sqrt:  [[20.11284458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225632  0.01411938  0.0859571 ]
Stock Position:  -0.0022563214599482934
Bond Position:  [3.73269769]


portfolio before change:  [3.50175363]
curr_Stock_Price:  102.56104173936873
curr_Factors:  [102.56104174  -0.70160652  -1.05272126]
mat_Sqrt:  [[17.74547168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01513585 -0.08663888 -1.60411548]
Stock Position:  0.015135845031528166
Bond Position:  [1.94940559]


portfolio before change:  [3.48052656]
curr_Stock_Price:  101.14250453253446
curr_Factors:  [101.14250453  -0.46038128  -1.02129783]
mat_Sqrt:  [[22.9852188   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082913 -0.00560011  0.22276556]
Stock Position:  0.0008291347080848987
Bond Position:  [3.3966658]


portfolio before change:  [3.48125181]
curr_Stock_Price:  101.50509881744513
curr_Factors:  [101.50509882  -0.39248398  -1.02349053]
mat_Sqrt:  [[24.63417031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02066925 -0.05000292  0.10947185]
Stock Position:  -0.020669254805732094
Bond Position:  [5.57928656]


portfolio before change:  [3.47353164]
curr_Stock_Price:  101.91235201927972
curr_Factors:  [101.91235202  -0.20923008  -1.01011356]
mat_Sqrt:  [[30.10735544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113243  0.00439972  0.12732298]
Stock Position:  -0.0011324261158660869
Bond Position:  [3.58893985]


portfolio before change:  [3.47275574]
curr_Stock_Price:  102.9937012402977
curr_Factors:  [102.99370124  -0.27064997  -1.01211006]
mat_Sqrt:  [[28.55716315  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00078499 0.04456569 0.28200539]
Stock Position:  0.0007849890129671138
Bond Position:  [3.39190682]


portfolio before change:  [3.47278556]
curr_Stock_Price:  102.49154054040716
curr_Factors:  [102.49154054  -0.31523576  -1.02745804]
mat_Sqrt:  [[26.76476995  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00848052 -0.09911197 -0.0449655 ]
Stock Position:  0.008480523976103058
Bond Position:  [2.6036036]


portfolio before change:  [3.4675013]
curr_Stock_Price:  101.83005576283286
curr_Factors:  [101.83005576  -0.46421502  -1.03490616]
mat_Sqrt:  [[22.74133345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02275964 -0.00812786 -0.1962964 ]
Stock Position:  -0.02275964060038185
Bond Position:  [5.78511677]


portfolio before change:  [3.45368253]
curr_Stock_Price:  102.46899182476143
curr_Factors:  [102.46899182  -0.44696697  -1.02453746]
mat_Sqrt:  [[23.5248146   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112138  0.00273571 -0.08343792]
Stock Position:  0.0011213825100375241
Bond Position:  [3.33877559]


portfolio before change:  [3.45568569]
curr_Stock_Price:  103.88312865000508
curr_Factors:  [103.88312865  -0.54210015  -1.02223164]
mat_Sqrt:  [[21.73523585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00174137 -0.08892783  0.53984085]
Stock Position:  0.0017413738965136648
Bond Position:  [3.27478632]


portfolio before change:  [3.4587983]
curr_Stock_Price:  105.43548597843744
curr_Factors:  [105.43548598  -0.36138948  -1.02129206]
mat_Sqrt:  [[26.45427358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00897296  0.01570775  0.73297886]
Stock Position:  -0.008972963162652574
Bond Position:  [4.40486703]


portfolio before change:  [3.44615978]
curr_Stock_Price:  106.9053633228931
curr_Factors:  [106.90536332  -0.48850828  -1.04536995]
mat_Sqrt:  [[23.05922142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00270652 0.06063116 0.31196107]
Stock Position:  0.0027065163580905164
Bond Position:  [3.15681867]


portfolio before change:  [3.45213759]
curr_Stock_Price:  108.9682299820381
curr_Factors:  [108.96822998  -0.57685617  -1.04640177]
mat_Sqrt:  [[21.49452892  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00712924 0.32302416 2.77075279]
Stock Position:  0.007129235133255968
Bond Position:  [2.67527746]


portfolio before change:  [3.45269934]
curr_Stock_Price:  109.00011573342724
curr_Factors:  [109.00011573  -0.56557091  -1.04142095]
mat_Sqrt:  [[21.85341243  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0070693  -0.04405501 -0.20844877]
Stock Position:  0.0070693005320594075
Bond Position:  [2.68214477]


portfolio before change:  [3.45024589]
curr_Stock_Price:  108.60562965765628
curr_Factors:  [108.60562966  -0.4220593   -1.05495003]
mat_Sqrt:  [[24.79678254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.18359044e-05 -9.38661978e-03  9.34485409e-02]
Stock Position:  -4.183590441521344e-05
Bond Position:  [3.45478951]


portfolio before change:  [3.45078191]
curr_Stock_Price:  106.11640256547525
curr_Factors:  [106.11640257  -0.23641014  -1.03135422]
mat_Sqrt:  [[29.8675401   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01672098 -0.00793394  0.55728394]
Stock Position:  -0.016720977390024205
Bond Position:  [5.22515188]


portfolio before change:  [3.44458016]
curr_Stock_Price:  106.52636234173173
curr_Factors:  [106.52636234  -0.12058059  -1.04061836]
mat_Sqrt:  [[33.35452803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372335  0.00597699 -0.0774901 ]
Stock Position:  -0.0037233498419612108
Bond Position:  [3.84121508]


portfolio before change:  [3.44869021]
curr_Stock_Price:  105.55147143504209
curr_Factors:  [105.55147144  -0.21061785  -1.05585425]
mat_Sqrt:  [[29.74695026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00176482 0.1859843  0.14553549]
Stock Position:  0.0017648223688196767
Bond Position:  [3.26241061]


portfolio before change:  [3.44799223]
curr_Stock_Price:  104.92489268769135
curr_Factors:  [104.92489269  -0.29878676  -1.05126349]
mat_Sqrt:  [[27.1993897   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048474  0.01139344  0.07194048]
Stock Position:  -0.0004847438095316959
Bond Position:  [3.49885393]


portfolio before change:  [3.448994]
curr_Stock_Price:  103.76060885893378
curr_Factors:  [103.76060886  -0.29277492  -1.04158189]
mat_Sqrt:  [[27.32302084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.40113215e-05 -7.70252097e-02  1.56089466e-01]
Stock Position:  -9.401132154979148e-05
Bond Position:  [3.45874867]


portfolio before change:  [3.44971749]
curr_Stock_Price:  100.66389439491898
curr_Factors:  [ 1.00663894e+02  1.25938872e-03 -1.02831900e+00]
mat_Sqrt:  [[36.04353739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00107839  0.01916992 -0.08961985]
Stock Position:  -0.0010783864877886684
Bond Position:  [3.55827208]


portfolio before change:  [3.45018542]
curr_Stock_Price:  100.64245899505816
curr_Factors:  [100.642459     0.18947338  -1.0359354 ]
mat_Sqrt:  [[43.16854947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00238609 -0.0134123   0.28902954]
Stock Position:  0.0023860872958607745
Bond Position:  [3.21004373]


portfolio before change:  [3.44724781]
curr_Stock_Price:  99.24314409136967
curr_Factors:  [99.24314409  0.11590831 -1.04323776]
mat_Sqrt:  [[39.26146042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00250632 0.09815876 0.31286735]
Stock Position:  0.002506322046671439
Bond Position:  [3.19851253]


portfolio before change:  [3.44544412]
curr_Stock_Price:  98.36395604298909
curr_Factors:  [98.36395604  0.14380664 -1.06258124]
mat_Sqrt:  [[39.24797446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197175 -0.00736762  0.32599293]
Stock Position:  -0.001971747546502089
Bond Position:  [3.63939301]


portfolio before change:  [3.44765584]
curr_Stock_Price:  97.47299085540497
curr_Factors:  [97.47299086  0.36947686 -1.09099261]
mat_Sqrt:  [[47.37333731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0025503  -0.01508769 -0.04468015]
Stock Position:  0.0025503016155882623
Bond Position:  [3.19907031]


portfolio before change:  [3.44428849]
curr_Stock_Price:  95.99581071100283
curr_Factors:  [95.99581071  0.47524485 -1.06814595]
mat_Sqrt:  [[53.05894439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194894 -0.00301436  0.28941335]
Stock Position:  0.0019489366729149948
Bond Position:  [3.25719873]


portfolio before change:  [3.44750482]
curr_Stock_Price:  97.43718730027358
curr_Factors:  [97.4371873   0.47998136 -1.06648598]
mat_Sqrt:  [[54.20121485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038395  0.01421739 -0.06579857]
Stock Position:  -0.0003839495115421735
Bond Position:  [3.48491578]


portfolio before change:  [3.44756482]
curr_Stock_Price:  98.41555136959154
curr_Factors:  [98.41555137  0.70313085 -1.06838184]
mat_Sqrt:  [[68.30260046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01384384 -0.02795716 -3.15087648]
Stock Position:  -0.01384384408385743
Bond Position:  [4.81001436]


portfolio before change:  [3.47930955]
curr_Stock_Price:  96.16592748076633
curr_Factors:  [96.16592748  0.73988755 -1.07936277]
mat_Sqrt:  [[68.48398278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024513  -0.0407469  -0.45943689]
Stock Position:  0.002451296077864136
Bond Position:  [3.24357839]


portfolio before change:  [3.48201468]
curr_Stock_Price:  97.1040687263871
curr_Factors:  [97.10406873  0.71833946 -1.08154997]
mat_Sqrt:  [[67.53005534  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00189587  0.00481863 -0.08943509]
Stock Position:  0.0018958677872609778
Bond Position:  [3.29791821]


portfolio before change:  [3.48538459]
curr_Stock_Price:  98.66411552598227
curr_Factors:  [98.66411553  0.62524149 -1.09631881]
mat_Sqrt:  [[61.59889834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00037838  0.04740456 -0.10506652]
Stock Position:  0.0003783774047609989
Bond Position:  [3.44805232]


portfolio before change:  [3.48597976]
curr_Stock_Price:  99.09791681185024
curr_Factors:  [99.09791681  0.81778599 -1.09611615]
mat_Sqrt:  [[ 7.50217636e+01  0.00000000e+00  0.00000000e+00]
 [-8.16496581e-02  3.16227766e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [-0.00218777 -0.00536654 -0.38066462]
Stock Position:  -0.0021877677458767334
Bond Position:  [3.70278299]


portfolio before change:  [3.48963485]
curr_Stock_Price:  97.63880097760628
curr_Factors:  [97.63880098  0.41844671 -1.09251899]
mat_Sqrt:  [[49.75956385  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079967  0.02521834  0.28267683]
Stock Position:  -0.0007996735256978029
Bond Position:  [3.56771401]


portfolio before change:  [3.48717498]
curr_Stock_Price:  101.27261239871996
curr_Factors:  [ 1.01272612e+02  8.83913605e-02 -1.05653545e+00]
mat_Sqrt:  [[38.46204546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00352433 -0.03270759 -0.03621419]
Stock Position:  0.0035243306989325308
Bond Position:  [3.1302568]


portfolio before change:  [3.49357363]
curr_Stock_Price:  102.97714881458734
curr_Factors:  [ 1.02977149e+02 -1.70805273e-02 -1.08025846e+00]
mat_Sqrt:  [[34.36945104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00028873 0.05100796 0.22941467]
Stock Position:  0.00028872963327642885
Bond Position:  [3.46384108]


portfolio before change:  [3.49446917]
curr_Stock_Price:  104.57910884345985
curr_Factors:  [104.57910884  -0.14554742  -1.07963801]
mat_Sqrt:  [[30.71522239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0033999   0.02694636 -0.06807937]
Stock Position:  0.0033999046461966726
Bond Position:  [3.13891018]


portfolio before change:  [3.49800433]
curr_Stock_Price:  105.50347727661287
curr_Factors:  [105.50347728  -0.32205148  -1.09621104]
mat_Sqrt:  [[25.54601647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00059326  0.02016275 -0.03133756]
Stock Position:  -0.0005932649244779107
Bond Position:  [3.56059584]


portfolio before change:  [3.49768982]
curr_Stock_Price:  106.78385699238028
curr_Factors:  [106.78385699  -0.72729335  -1.08738616]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.49768982]
Stock Price:  104.69780342759702
PL:  [-1.2001136]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-3.48126564e-02  9.00418874e-02  3.10494614e-02]
 [ 1.00489392e-02 -5.47029227e-02 -1.46940598e-01]
 [ 3.04332198e-01 -3.67725509e-01 -6.62003130e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-8.82715759e-01 -2.52729597e-01 -2.65637211e-02]
 [-3.72689981e-02 -3.28809127e-02 -1.81262725e-02]
 [ 2.61111640e-02  8.36670554e-02  6.39030063e-03]
 [ 3.43878832e-01 -1.55815523e-02 -8.78235177e-02]
 [-5.08647680e-01 -2.99635426e-02 -5.34372541e-02]
 [ 3.55088432e-02  2.90617024e-03 -3.19405658e-02]
 [ 1.63755874e-02 -2.51027697e-01  4.87886325e-02]
 [-8.43585462e-03 -2.16084960e-03  1.26268650e-02]
 [ 2.31874324e-01 -2.04030394e-01  1.21858674e-01]
 [ 8.32348477e-02 -6.47549108e-02 -5.58319372e-02]
 [ 5.60672407e-05 -2.38389325e-02 -1.45048188e-03]
 [-4.68628073e-02  1.12088663e-02  2.97739809e-02]
 [-3.54916252e-01 -2.90691641e-01  8.74953860e-02]
 [-1.92618194e-01 -6.29087325e-03 -3.86531611e-02]
 [ 3.21077900e-01  1.31738801e+00  4.63219857e-01]
 [-2.65749649e-01 -3.77632398e-02  2.16611661e-01]
 [-8.85766408e-02  5.01224463e-02 -4.16487149e-02]
 [ 1.16230114e-01 -3.56560192e-02  7.08910860e-02]
 [-1.01728442e-01  3.11138864e-02 -1.12614422e-01]
 [-5.25673238e-03 -1.05055929e-01  1.03790090e-01]
 [-1.08338283e-01  9.14231963e-02  1.08273735e-02]
 [ 1.04880588e-01 -1.06318005e-01 -1.07759746e-01]
 [ 3.50430934e-02 -6.62317398e-02  1.09541996e-01]
 [-4.78545872e-02  4.32920688e-02  5.13304508e-02]
 [-5.09197261e-01  2.01747241e-02 -7.07727813e-01]
 [ 5.49843210e-02 -1.08295477e-01 -8.38972579e-02]
 [ 6.86373526e-02  3.56969160e-02  3.53834786e-02]
 [ 1.59674063e-02  7.36952823e-02 -1.90085778e-04]
 [-1.36453876e-01 -1.69704838e-02 -1.33439103e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 1.77566029e-01 -1.35904107e-01 -4.29575461e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-3.25670699e-03 -3.80560245e-03 -4.68905933e-02]
 [-6.91291846e-02  7.48936761e-02 -4.80102980e-03]
 [-6.30973475e-02 -2.57081824e-01  1.07995971e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.52502452]
curr_Stock_Price:  101.1337650425145
curr_Factors:  [101.13376504  -1.03917507  -1.01607504]
mat_Sqrt:  [[12.95127108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00201909  0.02847374  0.08857547]
Stock Position:  -0.0020190944944962234
Bond Position:  [10.72922314]


portfolio before change:  [10.52496854]
curr_Stock_Price:  101.82576593191246
curr_Factors:  [101.82576593  -1.04635738  -1.04032324]
mat_Sqrt:  [[12.63641286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00169016 -0.01729858 -0.41918063]
Stock Position:  -0.0016901638445587072
Bond Position:  [10.69707076]


portfolio before change:  [10.52593147]
curr_Stock_Price:  102.04721520317959
curr_Factors:  [102.0472152   -1.12245901  -1.02613261]
mat_Sqrt:  [[11.90363686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01341663 -0.11628502 -1.88851066]
Stock Position:  0.013416634326286918
Bond Position:  [9.1568013]


portfolio before change:  [10.53541088]
curr_Stock_Price:  102.66843925288491
curr_Factors:  [102.66843925  -1.00936401  -1.03182609]
mat_Sqrt:  [[13.33396658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147766 -0.00659539  0.21422481]
Stock Position:  0.0014776588631652864
Bond Position:  [10.38370195]


portfolio before change:  [10.53583711]
curr_Stock_Price:  102.0784464232981
curr_Factors:  [102.07844642  -0.81821359  -1.04500485]
mat_Sqrt:  [[15.83975885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05648214 -0.07992012 -0.0757789 ]
Stock Position:  -0.05648214184808247
Bond Position:  [16.3014464]


portfolio before change:  [10.6243888]
curr_Stock_Price:  100.54674313582959
curr_Factors:  [100.54674314  -1.04749883  -1.03082704]
mat_Sqrt:  [[12.58237289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332354 -0.01039786 -0.05170921]
Stock Position:  -0.0033235376042418992
Bond Position:  [10.95855968]


portfolio before change:  [10.62503167]
curr_Stock_Price:  100.76549859042362
curr_Factors:  [100.76549859  -1.28273172  -1.02375258]
mat_Sqrt:  [[10.03733584  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00294658 0.02645785 0.01822975]
Stock Position:  0.0029465839590921126
Bond Position:  [10.32811766]


portfolio before change:  [10.62736949]
curr_Stock_Price:  101.12073339305799
curr_Factors:  [101.12073339  -1.27428697  -1.0506764 ]
mat_Sqrt:  [[ 9.88829585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03292272 -0.00492732 -0.25053605]
Stock Position:  0.03292272225902074
Bond Position:  [7.29819967]


portfolio before change:  [10.62265105]
curr_Stock_Price:  100.94970354858914
curr_Factors:  [100.94970355  -1.35628936  -1.05195578]
mat_Sqrt:  [[ 9.08275237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05728761 -0.0094753  -0.15244161]
Stock Position:  -0.05728760928943768
Bond Position:  [16.40581823]


portfolio before change:  [10.65842152]
curr_Stock_Price:  100.36110148004309
curr_Factors:  [100.36110148  -1.40257307  -1.01810787]
mat_Sqrt:  [[ 8.91819663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00325896  0.00091901 -0.09111754]
Stock Position:  0.003258959263332248
Bond Position:  [10.33134877]


portfolio before change:  [10.65778633]
curr_Stock_Price:  99.76990631672317
curr_Factors:  [99.76990632 -1.24415644 -0.99272011]
mat_Sqrt:  [[10.65458222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186333 -0.07938193  0.13918039]
Stock Position:  0.0018633314450812065
Bond Position:  [10.47188193]


portfolio before change:  [10.65868759]
curr_Stock_Price:  99.55104553865786
curr_Factors:  [99.55104554 -1.05353782 -1.00276134]
mat_Sqrt:  [[12.73521987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004644  -0.00068332  0.03602093]
Stock Position:  -0.0004643971246154316
Bond Position:  [10.70491881]


portfolio before change:  [10.66022391]
curr_Stock_Price:  99.12442044122002
curr_Factors:  [99.12442044 -1.28741162 -1.0100709 ]
mat_Sqrt:  [[ 9.96315029  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02524107 -0.06452008  0.34762888]
Stock Position:  0.0252410705547736
Bond Position:  [8.15821742]


portfolio before change:  [10.63754567]
curr_Stock_Price:  98.18555054657317
curr_Factors:  [98.18555055 -1.1529819  -1.01956895]
mat_Sqrt:  [[11.18203214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00627491 -0.0204773  -0.15927298]
Stock Position:  0.006274909232379055
Bond Position:  [10.02144025]


portfolio before change:  [10.64090864]
curr_Stock_Price:  98.52184452009195
curr_Factors:  [98.52184452 -1.39095001 -1.03026648]
mat_Sqrt:  [[ 8.75007085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.77740340e-05 -7.53853236e-03 -4.13782108e-03]
Stock Position:  -9.77740339598316e-05
Bond Position:  [10.65054152]


portfolio before change:  [10.64223657]
curr_Stock_Price:  98.5573639381318
curr_Factors:  [98.55736394 -1.57779543 -1.04538282]
mat_Sqrt:  [[ 7.15248966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00566178  0.00354455  0.08493688]
Stock Position:  -0.005661777806025616
Bond Position:  [11.20024647]


portfolio before change:  [10.64441993]
curr_Stock_Price:  98.41902647945618
curr_Factors:  [98.41902648 -1.37438884 -1.04897666]
mat_Sqrt:  [[ 8.72217503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03950413 -0.09192477  0.24959998]
Stock Position:  -0.03950413233196062
Bond Position:  [14.53237817]


portfolio before change:  [10.65190154]
curr_Stock_Price:  98.27562491271088
curr_Factors:  [98.27562491 -1.07885572 -1.05742461]
mat_Sqrt:  [[11.60569239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01729071 -0.00198935 -0.11026671]
Stock Position:  -0.017290710454310822
Bond Position:  [12.35115692]


portfolio before change:  [10.66011612]
curr_Stock_Price:  97.88983449700315
curr_Factors:  [97.8898345  -0.95467541 -1.06431224]
mat_Sqrt:  [[12.99877429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0345915  0.41659467 1.32143732]
Stock Position:  0.034591497592911954
Bond Position:  [7.27396015]


portfolio before change:  [10.61370472]
curr_Stock_Price:  96.52184788244321
curr_Factors:  [96.52184788 -0.95730831 -1.0250816 ]
mat_Sqrt:  [[13.29488629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01673644 -0.01194178  0.61793278]
Stock Position:  -0.016736436579764917
Bond Position:  [12.22913651]


portfolio before change:  [10.62207608]
curr_Stock_Price:  96.11300185230819
curr_Factors:  [96.11300185 -1.10561575 -1.03912241]
mat_Sqrt:  [[11.25470702  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00851057  0.01585011 -0.11881219]
Stock Position:  -0.008510571883084005
Bond Position:  [11.44005269]


portfolio before change:  [10.62666927]
curr_Stock_Price:  95.74133630187036
curr_Factors:  [95.7413363  -0.87840113 -1.02107102]
mat_Sqrt:  [[14.32746023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00905813 -0.01127542  0.20223254]
Stock Position:  0.009058134532706964
Bond Position:  [9.75943136]


portfolio before change:  [10.62878668]
curr_Stock_Price:  95.84040893704982
curr_Factors:  [95.84040894 -0.9001748  -1.02618144]
mat_Sqrt:  [[13.9618438   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00887507  0.00983907 -0.3212576 ]
Stock Position:  -0.008875074744344487
Bond Position:  [11.47937748]


portfolio before change:  [10.63367531]
curr_Stock_Price:  95.4512720598792
curr_Factors:  [95.45127206 -0.96183808 -1.0355284 ]
mat_Sqrt:  [[12.95198942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00102045 -0.0332216   0.29608424]
Stock Position:  0.0010204454387740345
Bond Position:  [10.5362725]


portfolio before change:  [10.63511465]
curr_Stock_Price:  95.5710450615379
curr_Factors:  [95.57104506 -0.89089616 -1.0446264 ]
mat_Sqrt:  [[13.79556732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00752181  0.02891055  0.03088748]
Stock Position:  -0.007521808691383252
Bond Position:  [11.35398177]


portfolio before change:  [10.63082566]
curr_Stock_Price:  96.32994830293916
curr_Factors:  [96.3299483  -0.85060371 -1.05327545]
mat_Sqrt:  [[14.35215498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00558377 -0.03362071 -0.30740856]
Stock Position:  0.005583767916838188
Bond Position:  [10.09294159]


portfolio before change:  [10.63707639]
curr_Stock_Price:  97.223436862453
curr_Factors:  [97.22343686 -0.85485603 -1.04698287]
mat_Sqrt:  [[14.51485926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00383698 -0.02094432  0.31249282]
Stock Position:  0.0038369757856522085
Bond Position:  [10.26403242]


portfolio before change:  [10.63797387]
curr_Stock_Price:  97.12293898183077
curr_Factors:  [97.12293898 -0.6033073  -1.04680621]
mat_Sqrt:  [[18.65033447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194415  0.01369015  0.14643149]
Stock Position:  -0.0019441477841238117
Bond Position:  [10.82679522]


portfolio before change:  [10.63913622]
curr_Stock_Price:  97.22122402997373
curr_Factors:  [97.22122403 -0.72511241 -1.06582731]
mat_Sqrt:  [[16.21682566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0402755   0.00637981 -2.01895046]
Stock Position:  -0.04027549536609566
Bond Position:  [14.55476918]


portfolio before change:  [10.62329349]
curr_Stock_Price:  97.65975839943472
curr_Factors:  [97.6597584  -0.66974149 -1.06037771]
mat_Sqrt:  [[17.31148902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0020254  -0.03424604 -0.23933552]
Stock Position:  0.002025399877723332
Bond Position:  [10.42549343]


portfolio before change:  [10.62533626]
curr_Stock_Price:  98.02487037925633
curr_Factors:  [98.02487038 -0.60427427 -1.08984363]
mat_Sqrt:  [[18.01317296  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00426253 0.01128836 0.10093922]
Stock Position:  0.004262528624553832
Bond Position:  [10.20750244]


portfolio before change:  [10.63245346]
curr_Stock_Price:  99.39522755868202
curr_Factors:  [99.39522756 -0.52891759 -1.09383098]
mat_Sqrt:  [[19.6161956   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090901  0.02330449 -0.00054226]
Stock Position:  0.0009090146518476024
Bond Position:  [10.54210175]


portfolio before change:  [10.63447693]
curr_Stock_Price:  100.17147829960042
curr_Factors:  [100.1714783   -0.42615231  -1.07893317]
mat_Sqrt:  [[22.23789949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00738065 -0.00536654 -0.38066462]
Stock Position:  -0.0073806518749293774
Bond Position:  [11.37380774]


portfolio before change:  [10.63318793]
curr_Stock_Price:  100.5387653874122
curr_Factors:  [100.53876539  -0.53386125  -1.07889625]
mat_Sqrt:  [[20.04111441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261531  0.0049611   0.16678008]
Stock Position:  -0.0026153088344544728
Bond Position:  [10.89612785]


portfolio before change:  [10.63343749]
curr_Stock_Price:  100.96415897434632
curr_Factors:  [100.96415897  -0.59345796  -1.09675797]
mat_Sqrt:  [[18.62583629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00887414 -0.04297665 -0.12254592]
Stock Position:  0.008874142615064456
Bond Position:  [9.73746715]


portfolio before change:  [10.64185726]
curr_Stock_Price:  101.77578697784726
curr_Factors:  [101.77578698  -0.90027208  -1.10347418]
mat_Sqrt:  [[13.72235108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00178627 0.00777784 0.21633947]
Stock Position:  0.001786274342320098
Bond Position:  [10.46005778]


portfolio before change:  [10.64377575]
curr_Stock_Price:  102.1177887847047
curr_Factors:  [102.11778878  -0.92849079  -1.10681896]
mat_Sqrt:  [[13.34066908  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096895 -0.00120344 -0.13376581]
Stock Position:  -0.0009689521130666377
Bond Position:  [10.742723]


portfolio before change:  [10.64474524]
curr_Stock_Price:  102.5031922932767
curr_Factors:  [102.50319229  -0.86158573  -1.11011054]
mat_Sqrt:  [[14.2705457   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00477735  0.02368346 -0.013696  ]
Stock Position:  -0.004777353700655075
Bond Position:  [11.13443925]


portfolio before change:  [10.64481143]
curr_Stock_Price:  102.78069062960714
curr_Factors:  [102.78069063  -0.93164868  -1.08692133]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.64481143]
Stock Price:  103.02336485937768
PL:  [7.62144657]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.00732430e-01  3.32368519e-01  3.98431191e-01]
 [-1.10937459e-01 -1.21051388e-01  9.66890878e-02]
 [ 2.13423395e-01  2.83453821e-01  4.24278765e-01]
 [-3.78738233e-02 -1.44136227e-02  9.78470234e-02]
 [-2.23242672e-01 -7.63850488e-02  4.71981129e-02]
 [ 4.70018715e-02 -1.91716507e-01 -2.56114075e-01]
 [ 2.48763592e-02 -2.23771326e-01 -3.31321782e-02]
 [ 1.37191320e-01  1.05216858e-01 -2.20638986e-02]
 [-2.47812978e-01  8.18618610e-03 -9.80251727e-02]
 [ 6.02593194e-02 -3.36871885e-02 -7.19527025e-02]
 [ 8.42545346e-02 -2.94005940e-01  2.08036819e-02]
 [ 2.24084987e-02 -4.63901231e-03 -1.79739941e-03]
 [ 1.63720178e-01 -1.26548293e-01  1.79712065e-01]
 [ 9.19688158e-02  3.27594830e-02 -5.18922302e-03]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-2.87618901e-02  2.45883306e-02  4.11861612e-02]
 [-4.85512670e-01 -2.53027090e-01  1.32949109e-01]
 [-1.25112467e-01  1.85124982e-02 -2.21859708e-02]
 [ 2.98892864e-01  1.23884483e+00  4.54365358e-01]
 [ 8.32554458e-03  4.49104150e-03  3.37587886e-02]
 [-5.82738827e-02 -1.12754138e-01 -3.25025745e-02]
 [ 4.59521805e-03  3.30227876e-02 -6.98733573e-04]
 [ 2.92878832e-02 -3.16290390e-02  2.99575256e-02]
 [ 4.46592115e-02  1.78019108e-01  1.03426377e-01]
 [-7.13070891e-02 -1.29050892e-01 -2.33642010e-02]
 [ 1.14116246e-01 -1.40734059e-02 -5.93355233e-03]
 [ 3.09215149e-02 -6.72328795e-02  8.19234450e-02]
 [-4.92167163e-03  4.24232638e-02  1.13395547e-02]
 [-6.03359955e-01  3.15368416e-02 -8.28895350e-01]
 [-1.68837349e-01 -2.31180123e-02  1.17092354e-02]
 [-9.02798921e-02  9.22946337e-02  2.11615573e-01]
 [ 1.29048083e-02  4.46912805e-02  1.40156104e-02]
 [-1.14095372e-01 -3.14756999e-03 -1.51374032e-01]
 [-6.54439944e-02 -8.66437377e-04  4.79642921e-02]
 [ 2.34276583e-01 -1.74291626e-01 -6.95109719e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-1.08149871e-02 -1.19810958e-02 -4.74149591e-02]
 [-8.09323358e-02  3.48339342e-02 -2.56362303e-03]
 [-4.25493363e-02 -2.86552131e-01  1.41961452e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.5164007]
curr_Stock_Price:  98.75938385047114
curr_Factors:  [98.75938385 -0.82327532 -1.05426395]
mat_Sqrt:  [[15.10683298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.16317265e-04  1.05104154e-01  1.13661329e+00]
Stock Position:  -0.0007163172650265417
Bond Position:  [-6.44565765]


portfolio before change:  [-6.51653973]
curr_Stock_Price:  97.82861753642727
curr_Factors:  [97.82861754 -0.70554084 -1.04203003]
mat_Sqrt:  [[17.04141025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00553513 -0.03827981  0.27582705]
Stock Position:  -0.005535129619849221
Bond Position:  [-5.97504565]


portfolio before change:  [-6.51849309]
curr_Stock_Price:  98.04657649472827
curr_Factors:  [98.04657649 -0.7788238  -1.02993162]
mat_Sqrt:  [[16.06571039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01913066 0.08963597 1.21034922]
Stock Position:  0.01913066239295166
Bond Position:  [-8.39418904]


portfolio before change:  [-6.51315097]
curr_Stock_Price:  98.38067161489882
curr_Factors:  [98.38067161 -0.87949774 -1.01955093]
mat_Sqrt:  [[14.72866645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124064 -0.00455799  0.27913032]
Stock Position:  -0.0012406446657616823
Bond Position:  [-6.39109551]


portfolio before change:  [-6.51391723]
curr_Stock_Price:  98.35433203466451
curr_Factors:  [98.35433203 -0.76916578 -1.00561018]
mat_Sqrt:  [[16.67316654  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0129298  -0.02415507  0.13464308]
Stock Position:  -0.01292979652498211
Bond Position:  [-5.24221573]


portfolio before change:  [-6.51439139]
curr_Stock_Price:  98.34032108104864
curr_Factors:  [98.34032108 -0.54763172 -1.03144739]
mat_Sqrt:  [[20.27431904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.04445749e-04 -6.06260827e-02 -7.30622167e-01]
Stock Position:  -0.0005044457487312688
Bond Position:  [-6.46478403]


portfolio before change:  [-6.51503934]
curr_Stock_Price:  98.02275516915316
curr_Factors:  [98.02275517 -0.70918074 -1.04578215]
mat_Sqrt:  [[16.94947322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00072778 -0.07076271 -0.09451688]
Stock Position:  0.0007277825498628488
Bond Position:  [-6.58637859]


portfolio before change:  [-6.51531927]
curr_Stock_Price:  98.76942635440308
curr_Factors:  [98.76942635 -0.56056055 -1.07484921]
mat_Sqrt:  [[19.24744547  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00703492  0.03327249 -0.06294216]
Stock Position:  0.007034919693439175
Bond Position:  [-7.21015426]


portfolio before change:  [-6.51667229]
curr_Stock_Price:  98.70521886226402
curr_Factors:  [98.70521886 -0.60410344 -1.08422637]
mat_Sqrt:  [[18.24348466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01466885  0.0025887  -0.27963853]
Stock Position:  -0.014668848673404246
Bond Position:  [-5.06878037]


portfolio before change:  [-6.52327669]
curr_Stock_Price:  99.11225564024966
curr_Factors:  [99.11225564 -0.83140394 -1.04527225]
mat_Sqrt:  [[15.17390111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00294599 -0.01065282 -0.20526103]
Stock Position:  0.0029459949497047614
Bond Position:  [-6.8152609]


portfolio before change:  [-6.52555806]
curr_Stock_Price:  98.62705364952355
curr_Factors:  [98.62705365 -0.69709065 -1.00904315]
mat_Sqrt:  [[17.90735996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00451825 -0.09297284  0.05934711]
Stock Position:  0.0045182465663967525
Bond Position:  [-6.9711794]


portfolio before change:  [-6.52202168]
curr_Stock_Price:  99.60261492907061
curr_Factors:  [99.60261493 -0.43854043 -1.01983264]
mat_Sqrt:  [[23.16900392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094617 -0.00146698 -0.00512748]
Stock Position:  0.0009461704676909741
Bond Position:  [-6.61626273]


portfolio before change:  [-6.52299255]
curr_Stock_Price:  99.45065340551801
curr_Factors:  [99.45065341 -0.44628334 -1.02957967]
mat_Sqrt:  [[22.73256697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00867198 -0.04001808  0.5126685 ]
Stock Position:  0.00867197650982551
Bond Position:  [-7.38542628]


portfolio before change:  [-6.51510334]
curr_Stock_Price:  100.46685066494778
curr_Factors:  [100.46685066  -0.579314    -1.03618507]
mat_Sqrt:  [[19.97194935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00459421  0.01035946 -0.01480341]
Stock Position:  0.0045942143525492364
Bond Position:  [-6.97666959]


portfolio before change:  [-6.50463393]
curr_Stock_Price:  102.9355111735032
curr_Factors:  [102.93551117  -0.7427338   -1.04228025]
mat_Sqrt:  [[17.27203356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024853  -0.03587186 -0.12433753]
Stock Position:  0.002485297024825613
Bond Position:  [-6.76045925]


portfolio before change:  [-6.50760903]
curr_Stock_Price:  102.07847492595656
curr_Factors:  [102.07847493  -0.9878186   -1.02894128]
mat_Sqrt:  [[13.585214    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00145157  0.00777551  0.11749265]
Stock Position:  -0.0014515731720817673
Bond Position:  [-6.35943465]


portfolio before change:  [-6.50738352]
curr_Stock_Price:  101.37545768152506
curr_Factors:  [101.37545768  -1.0793186   -1.02413836]
mat_Sqrt:  [[12.3712356   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03757973 -0.08001419  0.3792668 ]
Stock Position:  -0.037579728734682266
Bond Position:  [-2.69772132]


portfolio before change:  [-6.50889482]
curr_Stock_Price:  101.40669955921312
curr_Factors:  [101.40669956  -1.15187735  -1.03343224]
mat_Sqrt:  [[11.4024651   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01132765  0.00585417 -0.0632904 ]
Stock Position:  -0.011327653036021805
Bond Position:  [-5.36019491]


portfolio before change:  [-6.50180532]
curr_Stock_Price:  100.72168817214414
curr_Factors:  [100.72168817  -1.02576169  -1.03853958]
mat_Sqrt:  [[12.7822806   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03314171 0.39175713 1.2961779 ]
Stock Position:  0.03314171029684029
Bond Position:  [-9.83989433]


portfolio before change:  [-6.50077762]
curr_Stock_Price:  100.78981266648672
curr_Factors:  [100.78981267  -1.05978281  -1.02968043]
mat_Sqrt:  [[12.47309656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00122924 0.00142019 0.09630443]
Stock Position:  0.001229244604069219
Bond Position:  [-6.62467295]


portfolio before change:  [-6.50114563]
curr_Stock_Price:  101.16412317005206
curr_Factors:  [101.16412317  -1.2979882   -0.97039613]
mat_Sqrt:  [[10.46838597  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00647853 -0.03565599 -0.0927208 ]
Stock Position:  -0.006478529018494565
Bond Position:  [-5.84575093]


portfolio before change:  [-6.49630667]
curr_Stock_Price:  100.30440167520386
curr_Factors:  [100.30440168  -1.30666888  -0.9620786 ]
mat_Sqrt:  [[10.37565397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00051132  0.01044272 -0.00199329]
Stock Position:  0.0005113156609190473
Bond Position:  [-6.54759388]


portfolio before change:  [-6.4973979]
curr_Stock_Price:  99.77101275186435
curr_Factors:  [99.77101275 -1.02777391 -0.9878343 ]
mat_Sqrt:  [[13.29342401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00260176 -0.01000198  0.08546048]
Stock Position:  0.002601758524470658
Bond Position:  [-6.75697798]


portfolio before change:  [-6.49861634]
curr_Stock_Price:  99.62735501658109
curr_Factors:  [99.62735502 -0.86926774 -0.9853492 ]
mat_Sqrt:  [[15.59296468  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00451277 0.05629458 0.29504667]
Stock Position:  0.004512770176663967
Bond Position:  [-6.94821169]


portfolio before change:  [-6.50010604]
curr_Stock_Price:  99.48971940307156
curr_Factors:  [99.4897194  -0.80812955 -1.00870874]
mat_Sqrt:  [[16.17094369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00491056 -0.04080948 -0.06665156]
Stock Position:  -0.004910558585578785
Bond Position:  [-6.01155594]


portfolio before change:  [-6.49853745]
curr_Stock_Price:  99.0172523496886
curr_Factors:  [99.01725235 -1.03713907 -1.02644621]
mat_Sqrt:  [[12.57497609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00894965 -0.0044504  -0.01692677]
Stock Position:  0.00894965443810048
Bond Position:  [-7.38470764]


portfolio before change:  [-6.50084495]
curr_Stock_Price:  98.86257030628025
curr_Factors:  [98.86257031 -0.899105   -1.02394044]
mat_Sqrt:  [[14.44986787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00317706 -0.0212609   0.23370479]
Stock Position:  0.003177061755385903
Bond Position:  [-6.81493744]


portfolio before change:  [-6.50278937]
curr_Stock_Price:  98.51869866282559
curr_Factors:  [98.51869866 -0.80181222 -1.03757417]
mat_Sqrt:  [[15.65608987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.65522539e-05  1.34154139e-02  3.23485932e-02]
Stock Position:  -9.655225388864978e-05
Bond Position:  [-6.49327717]


portfolio before change:  [-6.50366408]
curr_Stock_Price:  99.17117274849507
curr_Factors:  [99.17117275 -0.81662492 -1.01824618]
mat_Sqrt:  [[15.83109858  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04874856  0.00997282 -2.36460771]
Stock Position:  -0.048748558313615985
Bond Position:  [-1.66921238]


portfolio before change:  [-6.58549999]
curr_Stock_Price:  100.84562743337051
curr_Factors:  [100.84562743  -1.07203941  -1.02368857]
mat_Sqrt:  [[12.40206422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01346906 -0.00731056  0.03340319]
Stock Position:  -0.013469057494864515
Bond Position:  [-5.22720444]


portfolio before change:  [-6.57332277]
curr_Stock_Price:  99.89302443880304
curr_Factors:  [99.89302444 -1.15661554 -1.02584177]
mat_Sqrt:  [[11.26434632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00396836  0.02918613  0.60368033]
Stock Position:  -0.003968362273281475
Bond Position:  [-6.17691106]


portfolio before change:  [-6.57450198]
curr_Stock_Price:  99.9955985310667
curr_Factors:  [99.99559853 -1.51386696 -1.01977038]
mat_Sqrt:  [[ 7.93663065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00213184 0.01413262 0.03998264]
Stock Position:  0.0021318437870206887
Bond Position:  [-6.78767698]


portfolio before change:  [-6.57403097]
curr_Stock_Price:  100.61455839396
curr_Factors:  [100.61455839  -1.39608093  -1.03429958]
mat_Sqrt:  [[ 8.8544172   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01638456 -0.00099535 -0.43182798]
Stock Position:  -0.016384560750189098
Bond Position:  [-4.92550563]


portfolio before change:  [-6.59408733]
curr_Stock_Price:  101.80107956895375
curr_Factors:  [101.80107957  -1.31842236  -1.0640918 ]
mat_Sqrt:  [[ 9.39809065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00592415 -0.00027399  0.13682877]
Stock Position:  -0.005924149667450349
Bond Position:  [-5.99100249]


portfolio before change:  [-6.59390418]
curr_Stock_Price:  101.64374621832057
curr_Factors:  [101.64374622  -1.06615543  -1.0688948 ]
mat_Sqrt:  [[12.01821935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01793839 -0.05511585 -0.19829545]
Stock Position:  0.01793839158959781
Bond Position:  [-8.4172295]


portfolio before change:  [-6.58635771]
curr_Stock_Price:  102.12309190033908
curr_Factors:  [102.1230919   -1.04638534  -1.08683986]
mat_Sqrt:  [[12.09695375  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00202629 0.00777784 0.21633947]
Stock Position:  0.0020262856373601218
Bond Position:  [-6.79328826]


portfolio before change:  [-6.58827591]
curr_Stock_Price:  101.59553502062654
curr_Factors:  [101.59553502  -0.93218526  -1.08976909]
mat_Sqrt:  [[13.45088956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154658 -0.00378876 -0.13526168]
Stock Position:  -0.0015465799193707275
Bond Position:  [-6.43115029]


portfolio before change:  [-6.58863218]
curr_Stock_Price:  101.30607961880578
curr_Factors:  [101.30607962  -0.83381391  -1.08645298]
mat_Sqrt:  [[14.8482133   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00542531  0.01101546 -0.0073133 ]
Stock Position:  -0.005425314358660361
Bond Position:  [-6.03901486]


portfolio before change:  [-6.59040425]
curr_Stock_Price:  101.49356005803526
curr_Factors:  [101.49356006  -1.25549424  -1.0703001 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.59040425]
Stock Price:  100.76078212426347
PL:  [-7.35118637]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.49459884e-01  1.13691718e-01  2.65006346e-01]
 [-7.31701587e-02  5.33961871e-02  5.61610783e-02]
 [ 2.24627986e-01  2.75888412e-01  4.03329859e-01]
 [-5.74506763e-02  1.21780877e-02  9.82696596e-02]
 [-3.14481850e-01 -1.02229613e-01  4.49684618e-02]
 [ 4.48549227e-02 -1.70235865e-01 -2.28483202e-01]
 [ 3.32105623e-02  1.02264082e-02 -2.24746390e-02]
 [ 3.10496251e-01  1.45386743e-01 -9.13576260e-02]
 [-2.81827202e-01  7.98228199e-03 -1.12299318e-01]
 [ 4.17712809e-02 -7.73303802e-03 -3.69260354e-02]
 [ 1.41704871e-02 -2.32067717e-01  3.76545623e-02]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 2.34508742e-01 -1.92807996e-01  1.58698886e-01]
 [ 6.20279889e-02  1.21181503e-01  7.41243820e-02]
 [ 9.66284894e-02 -1.12655402e-01 -6.24781742e-02]
 [-3.57221509e-02  4.19126072e-02  4.38766626e-02]
 [-5.89011707e-01 -3.02878927e-01  1.77497094e-01]
 [-1.24903456e-01  1.85260767e-02 -2.23599867e-02]
 [ 4.13469432e-01  1.42091005e+00  7.95416836e-01]
 [-4.42395409e-03  2.54958524e-02  2.84586367e-02]
 [-4.31567056e-02 -6.22703379e-02  1.50763843e-02]
 [ 6.31120371e-02  1.64112505e-02  2.52688016e-02]
 [ 1.80416602e-02 -2.53699130e-02  3.75802657e-02]
 [ 2.55725691e-02 -3.15524289e-02  6.95344160e-02]
 [-4.83659079e-02 -2.03427490e-01  1.09021490e-01]
 [ 5.69013893e-02  3.14120742e-02 -2.01920314e-02]
 [-2.82111525e-01  3.61850061e-02  2.85324961e-01]
 [ 2.22075259e-04  4.25101460e-02 -6.33619849e-02]
 [-5.20331754e-01  7.42064410e-02 -6.70179875e-01]
 [-1.57245806e-01  3.10019204e-02 -1.05281131e-02]
 [-9.02798921e-02  9.22946337e-02  2.11615573e-01]
 [ 7.47164368e-03  5.77614955e-03  3.27663584e-02]
 [-1.09644323e-01 -2.17546916e-04 -1.54168573e-01]
 [-6.56129273e-02 -4.91130924e-03  4.53990022e-02]
 [ 2.29748421e-01 -1.72711023e-01 -6.96382664e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-2.13976102e-02 -2.34279016e-02 -4.81491426e-02]
 [-9.70379875e-02 -1.35926623e-02  1.71301738e-03]
 [-4.92984184e-02 -2.69406083e-01  1.26674212e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.11795237]
curr_Stock_Price:  99.37221950532464
curr_Factors:  [99.37221951 -0.82735965 -0.95733663]
mat_Sqrt:  [[16.67943149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01153697  0.03595248  0.75598934]
Stock Position:  -0.011536974928326517
Bond Position:  [-0.97149757]


portfolio before change:  [-2.1155589]
curr_Stock_Price:  99.15423227900035
curr_Factors:  [99.15423228 -1.11262523 -0.94142786]
mat_Sqrt:  [[12.71297908  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00474536  0.01688536  0.16021192]
Stock Position:  -0.004745358474730766
Bond Position:  [-1.64503653]


portfolio before change:  [-2.11624946]
curr_Stock_Price:  99.25641856670653
curr_Factors:  [99.25641857 -1.1229238  -0.93639999]
mat_Sqrt:  [[12.6591819   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02481051 0.08724358 1.15058782]
Stock Position:  0.024810509871994416
Bond Position:  [-4.57885181]


portfolio before change:  [-2.13419485]
curr_Stock_Price:  98.5561908669545
curr_Factors:  [98.55619087 -1.00460465 -0.95463213]
mat_Sqrt:  [[13.89306885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266874  0.00385105  0.28033599]
Stock Position:  -0.0026687429228949614
Bond Position:  [-1.87117372]


portfolio before change:  [-2.13208442]
curr_Stock_Price:  97.67774517745951
curr_Factors:  [97.67774518 -1.05974504 -0.93770628]
mat_Sqrt:  [[13.2529799   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0232357  -0.03232784  0.1282825 ]
Stock Position:  -0.023235699493400576
Bond Position:  [0.13752631]


portfolio before change:  [-2.14428788]
curr_Stock_Price:  98.2036880460553
curr_Factors:  [98.20368805 -1.18022619 -0.91154366]
mat_Sqrt:  [[12.1250543   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.09646104e-04 -5.38333072e-02 -6.51798977e-01]
Stock Position:  -0.0005096461044021842
Bond Position:  [-2.09423875]


portfolio before change:  [-2.14542542]
curr_Stock_Price:  99.92202639138907
curr_Factors:  [99.92202639 -1.23260938 -0.92281391]
mat_Sqrt:  [[11.5763805   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00249534  0.00323387 -0.06411389]
Stock Position:  0.0024953387206663614
Bond Position:  [-2.39476472]


portfolio before change:  [-2.14790514]
curr_Stock_Price:  99.0482545979559
curr_Factors:  [99.0482546  -1.31225382 -0.91565778]
mat_Sqrt:  [[10.67276902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02769683  0.04597532 -0.26061788]
Stock Position:  0.027696825671957644
Bond Position:  [-4.89122738]


portfolio before change:  [-2.14278032]
curr_Stock_Price:  99.25536356108336
curr_Factors:  [99.25536356 -1.31407487 -0.94520996]
mat_Sqrt:  [[10.36475516  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02938266  0.00252422 -0.3203587 ]
Stock Position:  -0.02938266247252109
Bond Position:  [0.77360653]


portfolio before change:  [-2.14723328]
curr_Stock_Price:  99.41020554426062
curr_Factors:  [99.41020554 -1.51894424 -0.94409133]
mat_Sqrt:  [[ 8.4673637   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00401945 -0.0024454  -0.1053397 ]
Stock Position:  0.004019446960463322
Bond Position:  [-2.54680733]


portfolio before change:  [-2.14652275]
curr_Stock_Price:  99.66618684910493
curr_Factors:  [99.66618685 -1.42471742 -0.92643819]
mat_Sqrt:  [[ 9.49410293  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00167101 -0.07338626  0.10741799]
Stock Position:  0.0016710088263152676
Bond Position:  [-2.31306583]


portfolio before change:  [-2.14535859]
curr_Stock_Price:  100.53590930424456
curr_Factors:  [100.5359093   -1.66428407  -0.94390374]
mat_Sqrt:  [[ 7.40627164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00973845  0.00225658  0.15019092]
Stock Position:  -0.009738451694007322
Bond Position:  [-1.16629449]


portfolio before change:  [-2.14084859]
curr_Stock_Price:  100.0578255783316
curr_Factors:  [100.05782558  -1.9534239   -0.93736306]
mat_Sqrt:  [[ 5.55646059  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04713877 -0.06097124  0.45272375]
Stock Position:  0.047138773240640336
Bond Position:  [-6.85745174]


portfolio before change:  [-2.14958962]
curr_Stock_Price:  99.89057895299396
curr_Factors:  [99.89057895 -1.81783629 -0.93783641]
mat_Sqrt:  [[ 6.34966895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01264435 0.03832096 0.21145623]
Stock Position:  0.012644353359594218
Bond Position:  [-3.4126414]


portfolio before change:  [-2.14519957]
curr_Stock_Price:  100.27151304093044
curr_Factors:  [100.27151304  -1.75055573  -0.95107196]
mat_Sqrt:  [[ 6.72783868  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01203454 -0.03562477 -0.17823284]
Stock Position:  0.012034538776961182
Bond Position:  [-3.35192098]


portfolio before change:  [-2.14181823]
curr_Stock_Price:  100.58730010050229
curr_Factors:  [100.5873001   -1.75154281  -0.94134376]
mat_Sqrt:  [[ 6.80827944  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377242  0.01325393  0.12516791]
Stock Position:  -0.0037724194476387134
Bond Position:  [-1.76236074]


portfolio before change:  [-2.14258923]
curr_Stock_Price:  100.7332793543998
curr_Factors:  [100.73327935  -1.90589685  -0.94139744]
mat_Sqrt:  [[ 5.84263524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09594995 -0.09577873  0.5063498 ]
Stock Position:  -0.09594995090018026
Bond Position:  [7.52276397]


portfolio before change:  [-2.22845477]
curr_Stock_Price:  101.63797953015813
curr_Factors:  [101.63797953  -1.99450313  -0.94724994]
mat_Sqrt:  [[ 5.36375459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02404833  0.00585846 -0.06378682]
Stock Position:  -0.024048327596971956
Bond Position:  [0.21576866]


portfolio before change:  [-2.22894426]
curr_Stock_Price:  101.65945567092652
curr_Factors:  [101.65945567  -2.18430991  -0.95049106]
mat_Sqrt:  [[ 4.42304154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.13848411 0.44933121 2.26910283]
Stock Position:  0.1384841060786378
Bond Position:  [-16.3071631]


portfolio before change:  [-2.29247415]
curr_Stock_Price:  101.21542375696221
curr_Factors:  [101.21542376  -2.03428378  -0.93717809]
mat_Sqrt:  [[ 5.18510084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0003941  0.0080625  0.08118457]
Stock Position:  0.00039409858006160444
Bond Position:  [-2.332363]


portfolio before change:  [-2.29265372]
curr_Stock_Price:  101.49959118943282
curr_Factors:  [101.49959119  -2.28024056  -0.98101943]
mat_Sqrt:  [[ 3.89150037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01071234 -0.01969161  0.04300873]
Stock Position:  -0.010712337363624959
Bond Position:  [-1.20535586]


portfolio before change:  [-2.28955088]
curr_Stock_Price:  101.19587459508476
curr_Factors:  [101.1958746   -2.42774849  -0.94138735]
mat_Sqrt:  [[ 3.48309808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01972202 0.00518969 0.07208486]
Stock Position:  0.01972202464587731
Bond Position:  [-4.28533842]


portfolio before change:  [-2.29034763]
curr_Stock_Price:  101.18263842346443
curr_Factors:  [101.18263842  -2.51807068  -0.93871251]
mat_Sqrt:  [[ 3.19039263  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0078541  -0.00802267  0.10720604]
Stock Position:  0.007854096467045161
Bond Position:  [-3.08504583]


portfolio before change:  [-2.29038493]
curr_Stock_Price:  101.22699132394065
curr_Factors:  [101.22699132  -2.55824087  -0.97781655]
mat_Sqrt:  [[ 2.94853374  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01321048 -0.00997775  0.19836233]
Stock Position:  0.013210478667249687
Bond Position:  [-3.62764194]


portfolio before change:  [-2.29023081]
curr_Stock_Price:  101.27298546603177
curr_Factors:  [101.27298547  -2.78111509  -0.9955103 ]
mat_Sqrt:  [[ 2.31913508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01352421 -0.06432942  0.31100797]
Stock Position:  -0.01352420773526744
Bond Position:  [-0.92059392]


portfolio before change:  [-2.29011268]
curr_Stock_Price:  101.25574126879536
curr_Factors:  [101.25574127  -2.80855073  -0.9970629 ]
mat_Sqrt:  [[ 2.25248889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0237918   0.00993337 -0.05760225]
Stock Position:  0.02379179965416018
Bond Position:  [-4.69916899]


portfolio before change:  [-2.28554874]
curr_Stock_Price:  101.47226018168556
curr_Factors:  [101.47226018  -2.44219821  -1.00560529]
mat_Sqrt:  [[ 3.22838485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06905481  0.0114427   0.8139527 ]
Stock Position:  -0.06905481476282341
Bond Position:  [4.72159939]


portfolio before change:  [-2.26890137]
curr_Stock_Price:  101.23973289485505
curr_Factors:  [101.23973289  -2.38791483  -0.99731442]
mat_Sqrt:  [[ 3.42897728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338702  0.01344289 -0.18075411]
Stock Position:  -0.0033870240404589302
Bond Position:  [-1.92599996]


portfolio before change:  [-2.26869049]
curr_Stock_Price:  101.1063870120497
curr_Factors:  [101.10638701  -2.09585953  -1.01104683]
mat_Sqrt:  [[ 4.52341363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.14484982  0.02346614 -1.91183664]
Stock Position:  -0.14484981898858104
Bond Position:  [12.37655137]


portfolio before change:  [-2.24477618]
curr_Stock_Price:  100.95197088812316
curr_Factors:  [100.95197089  -2.0148651   -1.02510287]
mat_Sqrt:  [[ 4.82918104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03284084  0.00980367 -0.03003378]
Stock Position:  -0.032840844140752716
Bond Position:  [1.07057176]


portfolio before change:  [-2.23118379]
curr_Stock_Price:  100.54215935286746
curr_Factors:  [100.54215935  -2.05491421  -1.03244939]
mat_Sqrt:  [[ 4.58694185  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00974527  0.02918613  0.60368033]
Stock Position:  -0.009745274390615608
Bond Position:  [-1.25137286]


portfolio before change:  [-2.23435487]
curr_Stock_Price:  100.8515039035223
curr_Factors:  [100.8515039   -1.77738992  -1.06194862]
mat_Sqrt:  [[ 5.89621507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00242684 0.00182658 0.0934733 ]
Stock Position:  0.002426842974269168
Bond Position:  [-2.47910563]


portfolio before change:  [-2.23399574]
curr_Stock_Price:  101.12718522780065
curr_Factors:  [101.12718523  -1.62556042  -1.04800494]
mat_Sqrt:  [[ 6.97835786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.02224464e-02 -6.87943751e-05 -4.39800026e-01]
Stock Position:  -0.020222446393574907
Bond Position:  [-0.18895666]


portfolio before change:  [-2.23514365]
curr_Stock_Price:  101.18278128529762
curr_Factors:  [101.18278129  -1.47434102  -1.05379187]
mat_Sqrt:  [[ 8.07518442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00699336 -0.00155309  0.12951072]
Stock Position:  -0.0069933640271393925
Bond Position:  [-1.52753563]


portfolio before change:  [-2.23679546]
curr_Stock_Price:  101.39167275014165
curr_Factors:  [101.39167275  -1.50916717  -1.06199214]
mat_Sqrt:  [[ 7.75107587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0272316  -0.05461602 -0.19865859]
Stock Position:  0.027231599005939498
Bond Position:  [-4.99785283]


portfolio before change:  [-2.22004412]
curr_Stock_Price:  102.02975892542437
curr_Factors:  [102.02975893  -1.60681656  -1.05619181]
mat_Sqrt:  [[ 7.11536232  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00344492 0.00777784 0.21633947]
Stock Position:  0.003444924171004273
Bond Position:  [-2.57152891]


portfolio before change:  [-2.21846174]
curr_Stock_Price:  102.5824110238591
curr_Factors:  [102.58241102  -1.61955578  -1.04332552]
mat_Sqrt:  [[ 7.15481236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00444888 -0.00740855 -0.1373561 ]
Stock Position:  -0.004448882371964191
Bond Position:  [-1.76208466]


portfolio before change:  [-2.21727201]
curr_Stock_Price:  102.26547640948895
curr_Factors:  [102.26547641  -1.60436698  -1.05724993]
mat_Sqrt:  [[ 7.14173135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01358764 -0.00429838  0.00488676]
Stock Position:  -0.013587640807607737
Bond Position:  [-0.82772545]


portfolio before change:  [-2.21912328]
curr_Stock_Price:  102.39410815400768
curr_Factors:  [102.39410815  -1.51586303  -1.06004509]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.21912328]
Stock Price:  102.27440537002002
PL:  [-4.49352865]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.86729388e-01  2.81428422e-03  1.13404988e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.46236991e-01  3.22777557e-01  4.66716838e-01]
 [-5.49620631e-03  3.63599416e-03  9.83930907e-02]
 [-8.78031759e-01 -2.61861716e-01  3.11967496e-02]
 [-1.45729612e-02 -7.64153922e-02 -8.41468529e-02]
 [ 3.31231546e-02  1.10499625e-02 -2.24866669e-02]
 [ 3.18707200e-01 -4.19730033e-02 -7.57019156e-02]
 [-4.62233584e-01 -2.42339074e-02 -5.69128796e-02]
 [ 5.38784552e-02 -2.83018255e-02 -4.65644466e-02]
 [ 6.35568687e-02 -3.26296197e-01  3.97940105e-02]
 [ 2.50349653e-02 -6.45952761e-03 -6.70096960e-03]
 [ 1.52577228e-01 -8.85294350e-02  2.43330140e-01]
 [ 8.78754336e-02 -6.41736233e-02 -5.16964244e-02]
 [-5.36429532e-02  4.78349900e-04  1.90040758e-02]
 [-4.01132706e-02 -6.12500624e-03  2.24809720e-02]
 [-4.87491662e-01 -2.62934979e-01  1.34758762e-01]
 [-2.07763669e-01 -5.92172458e-02 -3.40336647e-02]
 [ 2.84487207e-01  1.21650009e+00  3.68982804e-01]
 [-2.19769564e-01 -2.89988983e-02  1.80880888e-01]
 [-9.44931434e-02  2.42039958e-01 -3.26497381e-02]
 [ 9.15067105e-02 -2.96787064e-02  6.00118043e-02]
 [-8.94438020e-02  1.58093178e-04 -9.92918601e-02]
 [-5.42285151e-03 -6.57094377e-02  1.17295388e-01]
 [-1.00604041e-01  6.65918963e-02 -3.95262491e-02]
 [ 1.10514580e-01 -7.92001605e-02 -6.89954372e-02]
 [ 3.84024447e-02 -6.30234355e-02  1.14582663e-01]
 [-4.19723490e-03  4.23659080e-02  1.10023409e-02]
 [-6.41770832e-01  1.75627268e-02 -8.96644040e-01]
 [-4.45527700e-02 -1.10313296e-01 -2.42180211e-02]
 [-1.85673625e-02  5.10222344e-02  1.53440877e-01]
 [ 1.41719693e-02  5.34407729e-02  9.81043135e-03]
 [-1.27229531e-01 -1.06301006e-02 -1.42698583e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 2.32319611e-01 -1.75004896e-01 -7.20166523e-02]
 [ 2.47701837e-03  6.70688845e-02  7.72601899e-02]
 [-8.53938432e-03 -9.51966605e-03 -4.72570861e-02]
 [-8.14237137e-02  3.32007554e-02 -2.46369731e-03]
 [-4.01452332e-02 -2.69110092e-01  1.30956291e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.60379907]
curr_Stock_Price:  99.89077100687489
curr_Factors:  [99.89077101 -0.89221638 -0.99988338]
mat_Sqrt:  [[15.0590259   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01085781  0.00088995  0.32351287]
Stock Position:  -0.01085780901894247
Bond Position:  [2.68839399]


portfolio before change:  [1.601693]
curr_Stock_Price:  100.11569175187212
curr_Factors:  [100.11569175  -0.85298692  -1.01667565]
mat_Sqrt:  [[15.43540455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294006  0.01411938  0.0859571 ]
Stock Position:  -0.002940061772082844
Bond Position:  [1.89603932]


portfolio before change:  [1.60546926]
curr_Stock_Price:  98.91189253448142
curr_Factors:  [98.91189253 -0.79615578 -1.02320627]
mat_Sqrt:  [[16.03650094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02181519 0.10207123 1.33141323]
Stock Position:  0.02181518580384851
Bond Position:  [-0.55231205]


portfolio before change:  [1.63077043]
curr_Stock_Price:  100.07485355624884
curr_Factors:  [100.07485356  -1.20704375  -1.0323165 ]
mat_Sqrt:  [[10.6606372   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00137722 0.0011498  0.2806881 ]
Stock Position:  0.0013772235114913106
Bond Position:  [1.49294499]


portfolio before change:  [1.63055183]
curr_Stock_Price:  99.78061571505286
curr_Factors:  [99.78061572 -1.28862185 -1.03126176]
mat_Sqrt:  [[ 9.80694021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08957177 -0.08280795  0.08899564]
Stock Position:  -0.08957176968455288
Bond Position:  [10.56807816]


portfolio before change:  [1.64348887]
curr_Stock_Price:  99.65093252366644
curr_Factors:  [99.65093252 -1.22035407 -1.04421908]
mat_Sqrt:  [[10.35117725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325783 -0.02416467 -0.24004755]
Stock Position:  -0.003257832586849317
Bond Position:  [1.96813493]


portfolio before change:  [1.64263128]
curr_Stock_Price:  99.98969326572752
curr_Factors:  [99.98969327 -1.12077245 -1.04304149]
mat_Sqrt:  [[11.48742747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00250869  0.0034943  -0.0641482 ]
Stock Position:  0.002508689766122245
Bond Position:  [1.39178816]


portfolio before change:  [1.64488323]
curr_Stock_Price:  100.81799992320569
curr_Factors:  [100.81799992  -1.10143509  -1.02475205]
mat_Sqrt:  [[12.02670709  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02512499 -0.01327303 -0.21595649]
Stock Position:  0.025124988145771358
Bond Position:  [-0.88816782]


portfolio before change:  [1.6353129]
curr_Stock_Price:  100.441510201199
curr_Factors:  [100.4415102   -1.17752654  -1.01775362]
mat_Sqrt:  [[11.18188887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0424326  -0.00766343 -0.1623566 ]
Stock Position:  -0.04243259787225404
Bond Position:  [5.89730711]


portfolio before change:  [1.6467278]
curr_Stock_Price:  100.18987142756222
curr_Factors:  [100.18987143  -0.70961452  -1.02354419]
mat_Sqrt:  [[17.70608534  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00246485 -0.00894982 -0.13283541]
Stock Position:  0.00246484620940132
Bond Position:  [1.39977517]


portfolio before change:  [1.64434707]
curr_Stock_Price:  99.15300778813722
curr_Factors:  [99.15300779 -0.55892536 -1.01912282]
mat_Sqrt:  [[20.46295153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00309119 -0.10318392  0.11352124]
Stock Position:  0.003091189237210378
Bond Position:  [1.33784636]


portfolio before change:  [1.64521182]
curr_Stock_Price:  99.3786528856585
curr_Factors:  [99.37865289 -0.61737245 -0.98820684]
mat_Sqrt:  [[19.95257165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117781 -0.00204268 -0.019116  ]
Stock Position:  0.0011778106464635564
Bond Position:  [1.52816259]


portfolio before change:  [1.64634088]
curr_Stock_Price:  100.17506653240336
curr_Factors:  [100.17506653  -0.59556668  -1.00843313]
mat_Sqrt:  [[20.14426258  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00992645 -0.02799547  0.69415316]
Stock Position:  0.009926447485731215
Bond Position:  [0.65195834]


portfolio before change:  [1.63485314]
curr_Stock_Price:  99.00956992311096
curr_Factors:  [99.00956992 -0.45334702 -1.02667049]
mat_Sqrt:  [[22.53791498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00335728 -0.02029348 -0.14747551]
Stock Position:  0.0033572754818970963
Bond Position:  [1.30245074]


portfolio before change:  [1.63552841]
curr_Stock_Price:  99.16221085659285
curr_Factors:  [99.16221086 -0.48549862 -1.02608375]
mat_Sqrt:  [[21.87128587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227474  0.00015127  0.05421334]
Stock Position:  -0.002274736463477788
Bond Position:  [1.86109631]


portfolio before change:  [1.63349479]
curr_Stock_Price:  100.15849044477162
curr_Factors:  [100.15849044  -0.66800985  -1.02363238]
mat_Sqrt:  [[18.4508715   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193392 -0.0019369   0.06413196]
Stock Position:  -0.0019339199448728146
Bond Position:  [1.82719329]


portfolio before change:  [1.63291066]
curr_Stock_Price:  100.57864381665802
curr_Factors:  [100.57864382  -1.19577134  -0.98710091]
mat_Sqrt:  [[11.33695455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04117271 -0.08314734  0.38442924]
Stock Position:  -0.041172706007512515
Bond Position:  [5.77400559]


portfolio before change:  [1.70750584]
curr_Stock_Price:  98.7844118694439
curr_Factors:  [98.78441187 -0.77281437 -0.98147697]
mat_Sqrt:  [[17.09264886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01265104 -0.01872614 -0.09708857]
Stock Position:  -0.012651037631592288
Bond Position:  [2.95723115]


portfolio before change:  [1.71804209]
curr_Stock_Price:  97.98079644942146
curr_Factors:  [97.98079645 -0.72771985 -0.96107624]
mat_Sqrt:  [[18.10114893  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02161274 0.38469111 1.05260523]
Stock Position:  0.021612738801607346
Bond Position:  [-0.39959127]


portfolio before change:  [1.72367868]
curr_Stock_Price:  98.24390711121912
curr_Factors:  [98.24390711 -0.82536471 -0.98204945]
mat_Sqrt:  [[16.11965073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01138959 -0.00917026  0.51600283]
Stock Position:  -0.0113895864436162
Bond Position:  [2.84263615]


portfolio before change:  [1.72420824]
curr_Stock_Price:  98.22861113424196
curr_Factors:  [98.22861113 -0.77165295 -0.97465328]
mat_Sqrt:  [[17.13274074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00553959  0.07653976 -0.09314061]
Stock Position:  -0.005539586449906695
Bond Position:  [2.26835413]


portfolio before change:  [1.73691023]
curr_Stock_Price:  95.98685029733582
curr_Factors:  [95.9868503  -0.72635513 -0.96984471]
mat_Sqrt:  [[17.60197937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00585106 -0.00938523  0.17119697]
Stock Position:  0.0058510617313574445
Bond Position:  [1.17528525]


portfolio before change:  [1.74334891]
curr_Stock_Price:  97.06216927836329
curr_Factors:  [97.06216928 -1.10960294 -0.97392076]
mat_Sqrt:  [[12.08334417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.07924036e-03  4.99934526e-05 -2.83252039e-01]
Stock Position:  -0.009079240364161743
Bond Position:  [2.62459968]


portfolio before change:  [1.73841711]
curr_Stock_Price:  97.6415011660277
curr_Factors:  [97.64150117 -1.13626048 -0.97088013]
mat_Sqrt:  [[11.87175455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141709 -0.02077915  0.33461109]
Stock Position:  0.0014170912020367522
Bond Position:  [1.6000502]


portfolio before change:  [1.73908386]
curr_Stock_Price:  97.97085850089842
curr_Factors:  [97.9708585  -0.99598068 -0.9979015 ]
mat_Sqrt:  [[13.34027818  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00801729  0.02105821 -0.11275739]
Stock Position:  -0.008017292153152465
Bond Position:  [2.52454486]


portfolio before change:  [1.74603914]
curr_Stock_Price:  97.14268713576203
curr_Factors:  [97.14268714 -0.86307415 -0.97696993]
mat_Sqrt:  [[15.42727144  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00611813 -0.02504529 -0.19682478]
Stock Position:  0.006118127013280319
Bond Position:  [1.15170784]


portfolio before change:  [1.74413199]
curr_Stock_Price:  96.80743279369042
curr_Factors:  [96.80743279 -0.64647725 -0.95457924]
mat_Sqrt:  [[19.52444517  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00308148 -0.01992976  0.32687244]
Stock Position:  0.003081484479127668
Bond Position:  [1.44582138]


portfolio before change:  [1.74970859]
curr_Stock_Price:  98.55849179278127
curr_Factors:  [98.55849179 -0.82941112 -0.95088172]
mat_Sqrt:  [[16.61585498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.16078420e-05  1.33972765e-02  3.13866162e-02]
Stock Position:  -5.160784195451656e-05
Bond Position:  [1.75479498]


portfolio before change:  [1.74990206]
curr_Stock_Price:  99.06018792624911
curr_Factors:  [99.06018793 -0.75075777 -0.93492462]
mat_Sqrt:  [[18.35762894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04490471  0.00555382 -2.55787587]
Stock Position:  -0.04490471321507044
Bond Position:  [6.19817139]


portfolio before change:  [1.74990004]
curr_Stock_Price:  99.07748770333049
curr_Factors:  [99.0774877  -0.48992179 -0.92635685]
mat_Sqrt:  [[24.03770444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0021776  -0.03488413 -0.06908727]
Stock Position:  -0.002177601027875691
Bond Position:  [1.96565127]


portfolio before change:  [1.74374337]
curr_Stock_Price:  102.01759974635733
curr_Factors:  [102.01759975  -0.9244013   -0.95230618]
mat_Sqrt:  [[15.61821498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00090094 0.01613465 0.43772411]
Stock Position:  0.000900936105882063
Bond Position:  [1.65183203]


portfolio before change:  [1.74338502]
curr_Stock_Price:  101.39065288011072
curr_Factors:  [101.39065288  -1.03756646  -0.98734814]
mat_Sqrt:  [[13.38408498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00131158 0.01689946 0.02798643]
Stock Position:  0.0013115838720618885
Bond Position:  [1.61040267]


portfolio before change:  [1.74277458]
curr_Stock_Price:  100.77174492784512
curr_Factors:  [100.77174493  -0.9799825   -0.97424184]
mat_Sqrt:  [[14.2767689   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01097113 -0.00336153 -0.40707934]
Stock Position:  -0.010971125637336616
Bond Position:  [2.84835406]


portfolio before change:  [1.73134768]
curr_Stock_Price:  101.8457428460646
curr_Factors:  [101.84574285  -1.13052812  -0.96472071]
mat_Sqrt:  [[12.53106196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0041827   0.0049611   0.16678008]
Stock Position:  -0.0041827024502109865
Bond Position:  [2.15733812]


portfolio before change:  [1.72919144]
curr_Stock_Price:  102.4257324570851
curr_Factors:  [102.42573246  -1.17341741  -0.9237837 ]
mat_Sqrt:  [[12.57784417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01694254 -0.05534141 -0.20544346]
Stock Position:  0.016942543087492483
Bond Position:  [-0.00616094]


portfolio before change:  [1.73640435]
curr_Stock_Price:  102.85150569435083
curr_Factors:  [102.85150569  -1.20751169  -0.91274706]
mat_Sqrt:  [[12.34223983  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00161878 0.02120904 0.22040182]
Stock Position:  0.0016187823291546374
Bond Position:  [1.56991015]


portfolio before change:  [1.73545063]
curr_Stock_Price:  102.14111268112359
curr_Factors:  [102.14111268  -1.18941045  -0.91923506]
mat_Sqrt:  [[12.40016531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148639 -0.00301038 -0.13481131]
Stock Position:  -0.0014863909378218419
Bond Position:  [1.88727226]


portfolio before change:  [1.73555716]
curr_Stock_Price:  102.22816930793192
curr_Factors:  [102.22816931  -1.23551082  -0.90711672]
mat_Sqrt:  [[11.99607761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00675799  0.010499   -0.00702824]
Stock Position:  -0.0067579901215
Bond Position:  [2.42641412]


portfolio before change:  [1.74365775]
curr_Stock_Price:  101.07438339536046
curr_Factors:  [101.0743834   -0.84355132  -0.92584095]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.74365775]
Stock Price:  101.09879868585514
PL:  [0.64485907]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.89997702e-02  1.93873531e-02  3.88670747e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 3.29569369e-01 -1.79089440e-03 -9.77440219e-02]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-8.19156438e-01 -2.44276418e-01  2.76299585e-02]
 [-4.45757198e-02 -1.88654999e-02  3.12827560e-03]
 [ 3.51785541e-02  5.69079758e-02 -1.12014960e-02]
 [ 1.41277182e-01  6.95209711e-02 -2.00308718e-02]
 [-1.84824643e-01  5.01670435e-03 -5.66568224e-02]
 [ 1.22786932e-01  1.17309355e-02  1.73774636e-01]
 [ 1.72394203e-01 -3.08267952e-01 -1.24110512e-02]
 [-2.24964939e-01 -1.54624939e-01 -3.40550891e-01]
 [ 2.82041352e-01 -4.11061727e-01 -1.52233022e-01]
 [ 3.24605670e-03 -1.44660824e-01 -8.49647230e-02]
 [-2.42889893e-01  4.34913514e-01  3.07183864e-01]
 [ 7.60009641e-02 -4.85443595e-01 -1.34565532e-01]
 [-1.21895194e-01 -2.79644772e-01 -1.97724842e-03]
 [-2.68468262e-01 -1.32975350e-01 -4.34965033e-02]
 [ 2.92282544e-01  1.21536891e+00  3.73662427e-01]
 [-2.57843520e-01 -3.57456066e-02  2.11550701e-01]
 [-8.99649615e-02  9.51563217e-02 -3.95370848e-02]
 [ 1.01641946e-01 -3.07576512e-02  6.50032823e-02]
 [-9.18621728e-02  6.03713823e-02 -1.09862879e-01]
 [-2.01479495e-02 -9.57749474e-02  8.44560704e-02]
 [-1.17241941e-01  1.14671231e-01  7.87914190e-02]
 [ 3.03976003e-02 -2.28304529e-01 -3.31608897e-01]
 [ 1.13616209e-01  2.72989720e-02  9.24103428e-02]
 [-2.35988098e-01  3.33236961e-02  2.33140560e-01]
 [-2.75350033e-01 -2.47470691e-01 -5.56117497e-01]
 [ 3.47044450e-01 -2.65939595e-01 -1.95369204e-01]
 [ 1.34145244e-01  1.29945140e-02 -3.28723882e-02]
 [ 3.57745755e-02  2.02994780e-01 -6.20814536e-02]
 [-5.98699324e-02  2.93346949e-02 -1.38349003e-01]
 [-5.79415381e-02  1.38442579e-01  1.12278264e-01]
 [-1.25969082e-01  9.82773222e-02  1.52820549e-01]
 [-8.49389891e-02 -8.03537448e-02  2.10009520e-02]
 [ 1.18362056e-01  9.76183617e-02  3.27165185e-02]
 [-1.33459059e-01  1.80454773e-01  1.25986931e-03]
 [ 1.56323307e-03 -2.09823645e-01  6.67314873e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.90159345]
curr_Stock_Price:  100.48958255097335
curr_Factors:  [100.48958255  -0.91343806  -0.99680308]
mat_Sqrt:  [[14.87694834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00608764  0.00613082  0.11087695]
Stock Position:  -0.006087638436540384
Bond Position:  [6.5133377]


portfolio before change:  [5.90259607]
curr_Stock_Price:  100.458635176073
curr_Factors:  [100.45863518  -0.78081796  -0.99214935]
mat_Sqrt:  [[17.06071999  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00265997  0.01411938  0.0859571 ]
Stock Position:  -0.0026599723154505936
Bond Position:  [6.16981326]


portfolio before change:  [5.9013369]
curr_Stock_Price:  101.22196834918245
curr_Factors:  [101.22196835  -0.83381868  -0.98730722]
mat_Sqrt:  [[16.38211051  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01889691 -0.00056633 -0.27883649]
Stock Position:  0.01889690669741632
Bond Position:  [3.98855481]


portfolio before change:  [5.89917213]
curr_Stock_Price:  101.08102622362574
curr_Factors:  [101.08102622  -0.95954233  -0.98592134]
mat_Sqrt:  [[14.44659526  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00136385 -0.00659539  0.21422481]
Stock Position:  0.0013638544961263406
Bond Position:  [5.76131232]


portfolio before change:  [5.90050807]
curr_Stock_Price:  101.53249150818459
curr_Factors:  [101.53249151  -0.79427198  -0.97100707]
mat_Sqrt:  [[17.37617147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04718092 -0.07724699  0.07882058]
Stock Position:  -0.04718091597784821
Bond Position:  [10.69090402]


portfolio before change:  [5.92940683]
curr_Stock_Price:  100.94830807709423
curr_Factors:  [100.94830808  -0.91220723  -0.96970874]
mat_Sqrt:  [[15.37422815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288953 -0.00596579  0.0089241 ]
Stock Position:  -0.002889528362927784
Bond Position:  [6.22109983]


portfolio before change:  [5.93139023]
curr_Stock_Price:  100.53103843594269
curr_Factors:  [100.53103844  -0.68841183  -0.98026662]
mat_Sqrt:  [[18.9496995   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0018133   0.01799588 -0.03195475]
Stock Position:  0.0018132960865241705
Bond Position:  [5.74909769]


portfolio before change:  [5.92990543]
curr_Stock_Price:  99.31585883154958
curr_Factors:  [99.31585883 -0.46505048 -0.9700992 ]
mat_Sqrt:  [[23.64509239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0058779   0.02198446 -0.0571425 ]
Stock Position:  0.005877897159247498
Bond Position:  [5.34613702]


portfolio before change:  [5.92295241]
curr_Stock_Price:  98.01925145891478
curr_Factors:  [98.01925146 -0.39594324 -0.94174484]
mat_Sqrt:  [[25.72532264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00762906  0.00158642 -0.16162614]
Stock Position:  -0.007629064178446413
Bond Position:  [6.67074757]


portfolio before change:  [5.92718951]
curr_Stock_Price:  97.57316692958672
curr_Factors:  [97.57316693 -0.17526228 -0.95933748]
mat_Sqrt:  [[31.37472931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00505379 0.00370965 0.49573067]
Stock Position:  0.005053794114868572
Bond Position:  [5.43407482]


portfolio before change:  [5.92541831]
curr_Stock_Price:  97.08828326132725
curr_Factors:  [97.08828326 -0.3389507  -0.95991081]
mat_Sqrt:  [[26.48978508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00611184 -0.09748289 -0.03540527]
Stock Position:  0.006111841339781284
Bond Position:  [5.33203013]


portfolio before change:  [5.91723156]
curr_Stock_Price:  95.6397342751321
curr_Factors:  [95.63973428 -0.35162614 -0.95238849]
mat_Sqrt:  [[25.96043735  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01149719 -0.0488967  -0.9714969 ]
Stock Position:  -0.011497186792058006
Bond Position:  [7.01681945]


portfolio before change:  [5.92714702]
curr_Stock_Price:  94.85360208429668
curr_Factors:  [94.85360208 -0.44507276 -0.94375706]
mat_Sqrt:  [[23.65335222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01016149 -0.12998913 -0.43427844]
Stock Position:  0.010161491965022827
Bond Position:  [4.96329291]


portfolio before change:  [5.92648342]
curr_Stock_Price:  94.72723729074272
curr_Factors:  [94.72723729 -0.52258964 -0.93417657]
mat_Sqrt:  [[22.07035624  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080798 -0.04574577 -0.24238071]
Stock Position:  -0.0008079806683090843
Bond Position:  [6.0030212]


portfolio before change:  [5.92717831]
curr_Stock_Price:  94.79597035449275
curr_Factors:  [94.79597035 -0.61635813 -0.93739521]
mat_Sqrt:  [[20.04487596  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00842893  0.13753173  0.87631006]
Stock Position:  -0.008428928699167226
Bond Position:  [6.72620678]


portfolio before change:  [5.92015829]
curr_Stock_Price:  95.72857411494066
curr_Factors:  [95.72857411 -0.37620109 -0.96133693]
mat_Sqrt:  [[25.12790084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00143262 -0.15351074 -0.38387801]
Stock Position:  0.0014326222638491619
Bond Position:  [5.7830154]


portfolio before change:  [5.9225729]
curr_Stock_Price:  96.90940601546478
curr_Factors:  [96.90940602 -0.4594783  -0.99045008]
mat_Sqrt:  [[22.73369555  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00569723 -0.08843144 -0.00564054]
Stock Position:  -0.005697234526258531
Bond Position:  [6.47468851]


portfolio before change:  [5.92439539]
curr_Stock_Price:  96.73158194773252
curr_Factors:  [96.73158195 -0.47626589 -1.00027371]
mat_Sqrt:  [[22.09608281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01270725 -0.0420505  -0.12408342]
Stock Position:  -0.01270724587736309
Bond Position:  [7.15358738]


portfolio before change:  [5.92653098]
curr_Stock_Price:  96.63389411740025
curr_Factors:  [96.63389412 -0.89932184 -1.02219117]
mat_Sqrt:  [[14.14578279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02827251 0.3843334  1.0659549 ]
Stock Position:  0.028272508080498932
Bond Position:  [3.19444843]


portfolio before change:  [5.93260681]
curr_Stock_Price:  96.83467185633366
curr_Factors:  [96.83467186 -0.90507453 -1.03927274]
mat_Sqrt:  [[13.85516165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01555982 -0.01130375  0.60349527]
Stock Position:  -0.015559822929661116
Bond Position:  [7.43933715]


portfolio before change:  [5.94141065]
curr_Stock_Price:  96.32863326099192
curr_Factors:  [96.32863326 -0.88205413 -1.04658441]
mat_Sqrt:  [[14.00097639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00682656  0.03009107 -0.1127883 ]
Stock Position:  -0.0068265602891926635
Bond Position:  [6.59900387]


portfolio before change:  [5.94256565]
curr_Stock_Price:  96.28028203442204
curr_Factors:  [96.28028203 -0.99597008 -1.06520453]
mat_Sqrt:  [[12.25689863  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00931039 -0.00972642  0.18543627]
Stock Position:  0.009310391663580988
Bond Position:  [5.04615852]


portfolio before change:  [5.92914008]
curr_Stock_Price:  94.77053059619186
curr_Factors:  [94.7705306  -0.8297594  -1.04941684]
mat_Sqrt:  [[14.47296259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00778894  0.01909111 -0.31340821]
Stock Position:  -0.007788941345796895
Bond Position:  [6.66730219]


portfolio before change:  [5.9306616]
curr_Stock_Price:  94.68219387935075
curr_Factors:  [94.68219388 -0.47349676 -1.02424459]
mat_Sqrt:  [[21.1742241   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025415 -0.0302867   0.24092966]
Stock Position:  -0.0002541450761940198
Bond Position:  [5.95472461]


portfolio before change:  [5.93181715]
curr_Stock_Price:  93.06434170703312
curr_Factors:  [93.06434171 -0.53500946 -1.02116428]
mat_Sqrt:  [[19.6311455   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00500215  0.03626223  0.22476999]
Stock Position:  -0.005002148819482388
Bond Position:  [6.39733884]


portfolio before change:  [5.93634755]
curr_Stock_Price:  92.31852619932803
curr_Factors:  [92.3185262  -0.61501929 -1.02744897]
mat_Sqrt:  [[17.86380474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241755 -0.07219623 -0.94598788]
Stock Position:  -0.0024175465674265905
Bond Position:  [6.15953189]


portfolio before change:  [5.93750906]
curr_Stock_Price:  92.15657685521562
curr_Factors:  [92.15657686 -0.66939002 -1.00470254]
mat_Sqrt:  [[17.27735165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0077086  0.00863269 0.26362099]
Stock Position:  0.007708603176580178
Bond Position:  [5.22711058]


portfolio before change:  [5.93600184]
curr_Stock_Price:  91.87628651317856
curr_Factors:  [91.87628651 -0.57090958 -0.99912607]
mat_Sqrt:  [[19.11373745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00981169  0.01053788  0.66508512]
Stock Position:  -0.009811689989161215
Bond Position:  [6.83746348]


portfolio before change:  [5.9502943]
curr_Stock_Price:  90.50672460545532
curr_Factors:  [90.50672461 -0.2906969  -0.96119165]
mat_Sqrt:  [[25.88168558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01527168 -0.0782571  -1.58644843]
Stock Position:  -0.015271675658764958
Bond Position:  [7.33248364]


portfolio before change:  [5.93752758]
curr_Stock_Price:  91.40271900782267
curr_Factors:  [91.40271901 -0.48256046 -0.95487824]
mat_Sqrt:  [[21.71137956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01383138 -0.08409748 -0.55733396]
Stock Position:  0.013831380284132387
Bond Position:  [4.67330181]


portfolio before change:  [5.97427215]
curr_Stock_Price:  94.01709069719732
curr_Factors:  [94.0170907  -0.34573306 -0.94563024]
mat_Sqrt:  [[25.84489988  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00494375  0.00410923 -0.09377577]
Stock Position:  0.004943749592037036
Bond Position:  [5.50947519]


portfolio before change:  [5.98288229]
curr_Stock_Price:  95.61939955383414
curr_Factors:  [95.61939955 -0.47113438 -0.94825294]
mat_Sqrt:  [[23.12671409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122558  0.06419259 -0.17710111]
Stock Position:  0.0012255763783041414
Bond Position:  [5.86569341]


portfolio before change:  [5.98317856]
curr_Stock_Price:  95.2628433703914
curr_Factors:  [95.26284337 -0.39051417 -0.95096647]
mat_Sqrt:  [[24.90725716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00350713  0.00927645 -0.3946712 ]
Stock Position:  -0.0035071258684368544
Bond Position:  [6.31727734]


portfolio before change:  [5.97981805]
curr_Stock_Price:  96.4462121164463
curr_Factors:  [96.44621212 -0.61295418 -0.95013794]
mat_Sqrt:  [[20.20425729  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155652  0.04377939  0.32029864]
Stock Position:  -0.0015565165787127422
Bond Position:  [6.12993817]


portfolio before change:  [5.9797764]
curr_Stock_Price:  96.96527617912363
curr_Factors:  [96.96527618 -0.60086927 -0.97011386]
mat_Sqrt:  [[20.15333549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00457677  0.03107802  0.43595449]
Stock Position:  -0.004576771357940703
Bond Position:  [6.4235643]


portfolio before change:  [5.98140821]
curr_Stock_Price:  96.78418565757819
curr_Factors:  [96.78418566 -0.3943488  -0.98476824]
mat_Sqrt:  [[24.37033374  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339457 -0.02541009  0.05990987]
Stock Position:  -0.003394574459291518
Bond Position:  [6.30994933]


portfolio before change:  [5.98488811]
curr_Stock_Price:  95.99141842348294
curr_Factors:  [95.99141842 -0.56910498 -1.00206842]
mat_Sqrt:  [[19.94713261  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00639494 0.03086964 0.09333112]
Stock Position:  0.006394943336954233
Bond Position:  [5.37102843]


portfolio before change:  [5.98163034]
curr_Stock_Price:  95.37699743900298
curr_Factors:  [95.37699744 -0.8214953  -1.02570458]
mat_Sqrt:  [[15.03886048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00854736  0.05706481  0.00359406]
Stock Position:  -0.00854736084977801
Bond Position:  [6.79685196]


portfolio before change:  [5.98818368]
curr_Stock_Price:  94.70969526169829
curr_Factors:  [94.70969526 -1.03269649 -0.99722157]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.98818368]
Stock Price:  94.5080542032364
PL:  [5.98818368]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [ 1.27866808e-01 -1.49477284e-01  9.11748110e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 1.74486052e-01  2.43374690e-01  3.83687468e-01]
 [-1.00853415e-01  1.05249590e-02  6.64976639e-02]
 [-7.64228558e-01 -2.29625629e-01  3.39778075e-02]
 [ 1.14806103e-02 -9.13316527e-02 -1.18808473e-01]
 [ 2.81056355e-02 -9.93261145e-02 -3.17121990e-02]
 [ 3.24999891e-01  1.24306453e-01 -9.47109045e-02]
 [-2.78511900e-01  6.70957178e-03 -1.05465548e-01]
 [ 5.42506209e-02 -2.44059589e-02 -6.37184744e-02]
 [ 1.01108523e-01 -2.27070451e-01 -6.31636543e-03]
 [-6.28450430e-02 -6.54479743e-02 -1.41439458e-01]
 [ 2.71476729e-01 -2.93450962e-01  1.35912865e-02]
 [ 8.91599593e-02 -6.40127214e-02 -5.05517042e-02]
 [-1.42692064e-01  1.90282947e-01  1.42588290e-01]
 [ 5.80753349e-02 -4.36366107e-01 -1.15932780e-01]
 [ 1.50693238e-01 -2.06134324e-01 -1.13123395e-01]
 [-3.09745895e-01 -1.75472451e-01 -5.04260074e-02]
 [ 2.58782556e-01  1.22449106e+00  3.85183453e-01]
 [-2.67496185e-01 -3.91884940e-02  2.19191584e-01]
 [-8.49897371e-02 -6.62283250e-02 -4.71043811e-02]
 [ 1.80482684e-01 -4.82235623e-02  9.60430444e-02]
 [-1.13453489e-01  2.01300301e-02 -1.16914300e-01]
 [-1.13279015e-02 -1.17738729e-01  1.11123581e-01]
 [-1.03946433e-01  7.99557874e-02 -2.26968149e-02]
 [ 9.71676580e-02 -1.43060936e-01 -1.60294856e-01]
 [ 1.07225587e-01  1.96246270e-02  9.42942390e-02]
 [-1.96159325e-01  3.69331518e-02  1.94927548e-01]
 [-4.83819910e-01 -1.80553888e-01 -8.10698087e-01]
 [ 2.51819545e-01 -1.74632267e-01 -1.72512113e-01]
 [ 1.34223598e-01  1.14134374e-02 -3.39447916e-02]
 [ 3.88694513e-02  2.26280708e-01 -7.33379599e-02]
 [-6.24572095e-02  2.75263322e-02 -1.46958376e-01]
 [-1.04288534e-02  1.40072746e-01  9.46266434e-02]
 [-3.03959226e-01  9.27279410e-02 -4.88116455e-02]
 [-2.29314056e-01 -5.98663088e-02 -4.56510005e-02]
 [ 3.55034942e-01  2.46583525e-01  6.92730543e-02]
 [-8.19920244e-02  2.90692225e-01  3.66153279e-02]
 [ 8.76268518e-04 -1.67697741e-01  4.68283685e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.03560107]
curr_Stock_Price:  99.52302347462314
curr_Factors:  [99.52302347 -1.3960419  -0.98113798]
mat_Sqrt:  [[ 9.23692584  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01544002 -0.04726887  0.26009636]
Stock Position:  0.01544001806737476
Bond Position:  [-2.57223835]


portfolio before change:  [-1.03523997]
curr_Stock_Price:  99.56723694238332
curr_Factors:  [99.56723694 -1.46905038 -0.93193018]
mat_Sqrt:  [[ 9.02368341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0050291   0.01411938  0.0859571 ]
Stock Position:  -0.005029104057512953
Bond Position:  [-0.53450597]


portfolio before change:  [-1.03031866]
curr_Stock_Price:  98.57538636031008
curr_Factors:  [98.57538636 -1.30919322 -0.91283939]
mat_Sqrt:  [[10.68444546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02424925 0.07696183 1.09455355]
Stock Position:  0.024249254359735566
Bond Position:  [-3.42069828]


portfolio before change:  [-1.01954265]
curr_Stock_Price:  99.03740571467229
curr_Factors:  [99.03740571 -1.46855808 -0.93063164]
mat_Sqrt:  [[ 8.99175368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00967641  0.00332828  0.18969933]
Stock Position:  -0.009676408620833347
Bond Position:  [-0.06121625]


portfolio before change:  [-1.01429967]
curr_Stock_Price:  98.49478370702693
curr_Factors:  [98.49478371 -1.45484425 -0.91398149]
mat_Sqrt:  [[ 9.21818204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08279526 -0.072614    0.09692923]
Stock Position:  -0.08279525968803247
Bond Position:  [7.14060152]


portfolio before change:  [-1.06739447]
curr_Stock_Price:  99.14684313070569
curr_Factors:  [99.14684313 -1.68860125 -0.93746223]
mat_Sqrt:  [[ 7.17453915  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210874 -0.0288816  -0.3389275 ]
Stock Position:  -0.002108740443480284
Bond Position:  [-0.85831951]


portfolio before change:  [-1.06726889]
curr_Stock_Price:  99.03640944540642
curr_Factors:  [99.03640945 -1.49144187 -0.9387065 ]
mat_Sqrt:  [[ 8.71755833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00218729 -0.03140968 -0.09046608]
Stock Position:  0.002187289152050676
Bond Position:  [-1.28389016]


portfolio before change:  [-1.06701767]
curr_Stock_Price:  99.22463993360462
curr_Factors:  [99.22463993 -1.34625097 -0.92836371]
mat_Sqrt:  [[10.20391725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0302704   0.03930915 -0.27018385]
Stock Position:  0.030270403016416158
Bond Position:  [-4.07058751]


portfolio before change:  [-1.06662117]
curr_Stock_Price:  99.25454912489221
curr_Factors:  [99.25454912 -1.31497308 -0.87891322]
mat_Sqrt:  [[11.06516024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02710008  0.00212175 -0.30086385]
Stock Position:  -0.027100079731782543
Bond Position:  [1.62318503]


portfolio before change:  [-1.05100873]
curr_Stock_Price:  98.68593344706765
curr_Factors:  [98.68593345 -1.4402343  -0.87584796]
mat_Sqrt:  [[ 9.73629014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0041714  -0.00771784 -0.18177107]
Stock Position:  0.004171402255490747
Bond Position:  [-1.46266745]


portfolio before change:  [-1.05371151]
curr_Stock_Price:  98.08183401889724
curr_Factors:  [98.08183402 -1.13643461 -0.88755892]
mat_Sqrt:  [[12.95923467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00725014 -0.07180598 -0.01801883]
Stock Position:  0.007250140047940815
Bond Position:  [-1.76481854]


portfolio before change:  [-1.0577181]
curr_Stock_Price:  97.55964147886296
curr_Factors:  [97.55964148 -0.97148913 -0.88423824]
mat_Sqrt:  [[15.25239475  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00612403 -0.02069647 -0.4034874 ]
Stock Position:  -0.006124029207801112
Bond Position:  [-0.46026]


portfolio before change:  [-1.05896404]
curr_Stock_Price:  97.75369821658775
curr_Factors:  [97.75369822 -1.10211913 -0.89318557]
mat_Sqrt:  [[13.29178709  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02006308 -0.09279734  0.03877216]
Stock Position:  0.020063078497403394
Bond Position:  [-3.02020416]


portfolio before change:  [-1.07728275]
curr_Stock_Price:  96.8594606047067
curr_Factors:  [96.8594606  -1.25957288 -0.87611015]
mat_Sqrt:  [[11.44528713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00674412 -0.0202426  -0.14420994]
Stock Position:  0.006744115166295017
Bond Position:  [-1.73051411]


portfolio before change:  [-1.078542]
curr_Stock_Price:  96.7048183305038
curr_Factors:  [96.70481833 -1.17864122 -0.84258544]
mat_Sqrt:  [[12.81269611  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00848169  0.06017275  0.4067647 ]
Stock Position:  -0.008481686104925508
Bond Position:  [-0.25832209]


portfolio before change:  [-1.0707275]
curr_Stock_Price:  95.77967289833178
curr_Factors:  [95.7796729  -0.98724093 -0.85657894]
mat_Sqrt:  [[15.15348604  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152729 -0.13799108 -0.33072395]
Stock Position:  0.001527287571398017
Bond Position:  [-1.21701061]


portfolio before change:  [-1.07292534]
curr_Stock_Price:  94.44024154750298
curr_Factors:  [94.44024155 -1.00386625 -0.83945522]
mat_Sqrt:  [[14.94902074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00817978 -0.0651854  -0.32270956]
Stock Position:  0.008179777018792309
Bond Position:  [-1.84542545]


portfolio before change:  [-1.06596442]
curr_Stock_Price:  95.31943526452623
curr_Factors:  [95.31943526 -0.98767097 -0.84053589]
mat_Sqrt:  [[15.31797344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02118882 -0.05548926 -0.14385136]
Stock Position:  -0.02118881723900776
Bond Position:  [0.95374167]


portfolio before change:  [-1.07000149]
curr_Stock_Price:  95.51559031731915
curr_Factors:  [95.51559032 -1.21948818 -0.8164248 ]
mat_Sqrt:  [[12.4706328   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02959144 0.38721807 1.09882118]
Stock Position:  0.029591443225445175
Bond Position:  [-3.89644566]


portfolio before change:  [-1.06132245]
curr_Stock_Price:  95.82534630158621
curr_Factors:  [95.8253463  -1.26785502 -0.84487226]
mat_Sqrt:  [[11.58602864  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01931341 -0.01239249  0.62529258]
Stock Position:  -0.019313410971224586
Bond Position:  [0.78939185]


portfolio before change:  [-1.04585236]
curr_Stock_Price:  95.02945320764071
curr_Factors:  [95.02945321 -1.2372169  -0.82571012]
mat_Sqrt:  [[12.07648118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00797541 -0.02094324 -0.13437569]
Stock Position:  -0.007975409824327807
Bond Position:  [-0.28795352]


portfolio before change:  [-1.0471543]
curr_Stock_Price:  95.18818473079502
curr_Factors:  [95.18818473 -1.25533484 -0.81231421]
mat_Sqrt:  [[12.03966685  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01651559 -0.01524963  0.27398407]
Stock Position:  0.01651559496698232
Bond Position:  [-2.61924381]


portfolio before change:  [-1.03131322]
curr_Stock_Price:  96.16716893780911
curr_Factors:  [96.16716894 -0.9903361  -0.81907941]
mat_Sqrt:  [[15.74735652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00868709  0.00636567 -0.33352396]
Stock Position:  -0.008687093929494448
Bond Position:  [-0.19589999]


portfolio before change:  [-1.03481563]
curr_Stock_Price:  96.56752320285713
curr_Factors:  [96.5675232  -1.03126849 -0.83215446]
mat_Sqrt:  [[14.98155133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00055502 -0.03723226  0.31700465]
Stock Position:  0.0005550228660086019
Bond Position:  [-1.08841281]


portfolio before change:  [-1.03447324]
curr_Stock_Price:  97.4295570209263
curr_Factors:  [97.42955702 -0.66796894 -0.83721408]
mat_Sqrt:  [[21.6270881   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00492507  0.02528424 -0.0647477 ]
Stock Position:  -0.004925071338010812
Bond Position:  [-0.55462572]


portfolio before change:  [-1.02310507]
curr_Stock_Price:  95.10725505920857
curr_Factors:  [95.10725506 -0.45952922 -0.83230673]
mat_Sqrt:  [[26.1322271   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00232486 -0.04523984 -0.45727661]
Stock Position:  0.002324860784216235
Bond Position:  [-1.24421619]


portfolio before change:  [-1.0293657]
curr_Stock_Price:  92.48125101267698
curr_Factors:  [92.48125101 -0.45254332 -0.8253277 ]
mat_Sqrt:  [[25.76803857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00492781 0.00620585 0.26899522]
Stock Position:  0.0049278109908894065
Bond Position:  [-1.48509582]


portfolio before change:  [-1.02767585]
curr_Stock_Price:  92.86184619718958
curr_Factors:  [92.8618462  -0.46387283 -0.84701018]
mat_Sqrt:  [[25.03387351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00620824  0.01167929  0.55607404]
Stock Position:  -0.006208240060685085
Bond Position:  [-0.45116721]


portfolio before change:  [-1.03268111]
curr_Stock_Price:  93.65899115905063
curr_Factors:  [93.65899116 -0.24178438 -0.83962865]
mat_Sqrt:  [[31.76126274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02059001 -0.05709615 -2.31269599]
Stock Position:  -0.02059001403080404
Bond Position:  [0.89575883]


portfolio before change:  [-1.0452712]
curr_Stock_Price:  94.2758952857836
curr_Factors:  [94.27589529 -0.38996642 -0.85386757]
mat_Sqrt:  [[27.17755782  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00780411 -0.05522357 -0.49212904]
Stock Position:  0.007804110759533678
Bond Position:  [-1.78101073]


portfolio before change:  [-1.04014884]
curr_Stock_Price:  94.96079061586241
curr_Factors:  [94.96079062 -0.27580662 -0.90281286]
mat_Sqrt:  [[29.21974277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00436655  0.00360925 -0.09683504]
Stock Position:  0.004366545637477464
Bond Position:  [-1.45479947]


portfolio before change:  [-1.03893999]
curr_Stock_Price:  95.27928328632589
curr_Factors:  [95.27928329 -0.30083649 -0.90474204]
mat_Sqrt:  [[28.53792429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104219  0.07155624 -0.20921279]
Stock Position:  0.001042190223702419
Bond Position:  [-1.13823913]


portfolio before change:  [-1.03893969]
curr_Stock_Price:  95.41610346549717
curr_Factors:  [95.41610347 -0.36575731 -0.89842932]
mat_Sqrt:  [[26.95208706  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00340398  0.00870459 -0.41923134]
Stock Position:  -0.0034039751880224926
Bond Position:  [-0.71414564]


portfolio before change:  [-1.03198544]
curr_Stock_Price:  93.34689932698554
curr_Factors:  [93.34689933 -0.2891719  -0.87326952]
mat_Sqrt:  [[29.19160696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00042832 0.04429489 0.26994347]
Stock Position:  0.0004283214717522379
Bond Position:  [-1.07196792]


portfolio before change:  [-1.03275191]
curr_Stock_Price:  91.87027349137364
curr_Factors:  [91.87027349 -0.45584385 -0.87662335]
mat_Sqrt:  [[24.23772524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01285305  0.02932315 -0.13924604]
Stock Position:  -0.01285304760823234
Bond Position:  [0.14806108]


portfolio before change:  [-1.02118659]
curr_Stock_Price:  90.97190147449453
curr_Factors:  [90.97190147 -0.45559033 -0.86724831]
mat_Sqrt:  [[24.23292     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00991124 -0.01893139 -0.1302296 ]
Stock Position:  -0.009911239300064063
Bond Position:  [-0.1195423]


portfolio before change:  [-1.0113926]
curr_Stock_Price:  89.98222425355074
curr_Factors:  [89.98222425 -0.63333016 -0.83121423]
mat_Sqrt:  [[20.80238722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01805283 0.07797656 0.19761674]
Stock Position:  0.018052832116764967
Bond Position:  [-2.63582659]


portfolio before change:  [-0.98720607]
curr_Stock_Price:  91.34024003540286
curr_Factors:  [91.34024004 -0.48606216 -0.819157  ]
mat_Sqrt:  [[24.76353668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270609  0.09192495  0.10445334]
Stock Position:  -0.0027060880590964913
Bond Position:  [-0.74003134]


portfolio before change:  [-0.98450901]
curr_Stock_Price:  90.30938893774986
curr_Factors:  [90.30938894 -0.46243609 -0.81133832]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.98450901]
Stock Price:  90.01912006082922
PL:  [-0.98450901]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.88886700e-01  2.19885464e-01  2.76135169e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.43753234e-01  8.23427210e-02  8.34174780e-02]
 [ 4.00275276e-03  4.53136237e-02  1.36424716e-01]
 [-4.07376519e-01 -1.28543115e-01  4.26983547e-02]
 [ 1.55231572e-02 -1.34144363e-01 -1.71693556e-01]
 [ 2.00708000e-02  1.04674319e-01  3.67587457e-02]
 [ 3.04892879e-01 -6.93121972e-02 -6.77631288e-02]
 [-5.69309363e-01 -2.96406892e-02 -8.17846117e-02]
 [-1.35404580e-02  8.62356596e-02  7.10713620e-03]
 [-4.50908728e-02 -1.52025046e-01  1.11251790e-01]
 [-1.42140564e-01  1.92159707e-02  1.10665836e-01]
 [ 7.14247697e-02 -1.09424437e-02  2.45586718e-01]
 [ 2.71622780e-02  3.18670050e-01  2.67992592e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-1.43262682e-02 -1.13423211e-02  3.56060455e-02]
 [-5.23820329e-01 -2.37372638e-01  1.45789254e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 1.45234773e-01  8.05778784e-01  1.84531543e-01]
 [-2.67038249e-02  4.77866623e-02  2.51553445e-02]
 [-8.06841056e-03 -2.05307386e-01  4.25953935e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.22673112e-01 -3.25150317e-02  1.37264044e-01]
 [ 7.94008985e-02  6.52777276e-02 -2.43918767e-03]
 [-6.07295738e-02 -1.60380378e-01  9.84367065e-02]
 [ 1.92183265e-02  6.21333064e-02 -1.55563674e-02]
 [ 1.61843398e-02 -5.61456870e-02  1.74358045e-02]
 [ 1.40461999e-02  4.22930281e-02 -3.84765229e-02]
 [-5.89571650e-01  2.80956676e-02 -8.12902710e-01]
 [-1.18424368e-02 -1.14937850e-01 -4.08599851e-02]
 [-9.02798921e-02  9.22946337e-02  2.11615573e-01]
 [ 1.30686574e-02  5.17684587e-02  1.04130429e-02]
 [-1.36453876e-01 -1.69704838e-02 -1.33439103e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [-1.06218302e-01  8.67969488e-02  1.46480695e-01]
 [-1.07998213e-01 -9.68136545e-02  9.17842224e-03]
 [ 5.91074022e-02  4.27794881e-02 -4.09327706e-04]
 [-1.00340007e-01  7.35423883e-02  8.85447140e-04]
 [-3.22048203e-02 -3.00565582e-01  1.24397694e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.0773257]
curr_Stock_Price:  99.23855005180111
curr_Factors:  [99.23855005 -0.90125522 -1.00447149]
mat_Sqrt:  [[14.75821447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00859477  0.06953389  0.78773678]
Stock Position:  -0.00859476782222643
Bond Position:  [-2.22439341]


portfolio before change:  [-3.08356597]
curr_Stock_Price:  99.93225093567519
curr_Factors:  [99.93225094 -0.91004513 -1.02950968]
mat_Sqrt:  [[14.36705389  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00315869  0.01411938  0.0859571 ]
Stock Position:  -0.0031586881489185955
Bond Position:  [-2.76791115]


portfolio before change:  [-3.08530305]
curr_Stock_Price:  100.37264597839024
curr_Factors:  [100.37264598  -1.03071419  -1.04090336]
mat_Sqrt:  [[12.64513008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02079115 0.02603905 0.23796685]
Stock Position:  0.020791153129939597
Bond Position:  [-5.1721661]


portfolio before change:  [-3.10412911]
curr_Stock_Price:  99.49825945974223
curr_Factors:  [99.49825946 -0.85505425 -1.04264307]
mat_Sqrt:  [[14.91612494  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00221373 0.01432943 0.38918174]
Stock Position:  0.002213733410241347
Bond Position:  [-3.32439173]


portfolio before change:  [-3.10432899]
curr_Stock_Price:  99.59569806954624
curr_Factors:  [99.59569807 -0.69260099 -1.04540557]
mat_Sqrt:  [[17.51595916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02294934 -0.0406489   0.12180652]
Stock Position:  -0.022949341174743065
Bond Position:  [-0.81867333]


portfolio before change:  [-3.09956892]
curr_Stock_Price:  99.38382242062745
curr_Factors:  [99.38382242 -0.48776672 -1.07763169]
mat_Sqrt:  [[20.77168862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110666 -0.04242017 -0.48979393]
Stock Position:  -0.0011066618684147567
Bond Position:  [-2.98958463]


portfolio before change:  [-3.10227094]
curr_Stock_Price:  101.4877166866207
curr_Factors:  [101.48771669  -0.65037693  -1.08773547]
mat_Sqrt:  [[17.84682057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00169648 0.03310093 0.10486247]
Stock Position:  0.001696482953639802
Bond Position:  [-3.27444312]


portfolio before change:  [-3.10278254]
curr_Stock_Price:  101.42743276238271
curr_Factors:  [101.42743276  -1.03436692  -1.10221483]
mat_Sqrt:  [[11.97428992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02415769 -0.02191844 -0.19330934]
Stock Position:  0.02415768759934061
Bond Position:  [-5.55303478]


portfolio before change:  [-3.07700763]
curr_Stock_Price:  102.52311222608456
curr_Factors:  [102.52311223  -1.26067026  -1.10583266]
mat_Sqrt:  [[ 9.61750944  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06101048 -0.00937321 -0.23330873]
Stock Position:  -0.06101048302331602
Bond Position:  [3.17797697]


portfolio before change:  [-3.09800165]
curr_Stock_Price:  102.8737287647041
curr_Factors:  [102.87372876  -1.68396351  -1.13198209]
mat_Sqrt:  [[ 6.15679713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00160199  0.02727011  0.02027468]
Stock Position:  -0.001601989558651025
Bond Position:  [-2.93319901]


portfolio before change:  [-3.09935928]
curr_Stock_Price:  103.49231072144319
curr_Factors:  [103.49231072  -1.51888157  -1.15789032]
mat_Sqrt:  [[ 7.11870212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00369547 -0.04807454  0.31737039]
Stock Position:  -0.0036954722325523892
Bond Position:  [-2.71690632]


portfolio before change:  [-3.09876]
curr_Stock_Price:  103.23823846132527
curr_Factors:  [103.23823846  -1.37040375  -1.16471909]
mat_Sqrt:  [[ 8.18183515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01455112  0.00607662  0.31569883]
Stock Position:  -0.014551116960506339
Bond Position:  [-1.59652831]


portfolio before change:  [-3.09786364]
curr_Stock_Price:  103.16292231686421
curr_Factors:  [103.16292232  -1.36510082  -1.16334395]
mat_Sqrt:  [[ 8.23064787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01473425 -0.0034603   0.70059055]
Stock Position:  0.014734249094363256
Bond Position:  [-4.61789184]


portfolio before change:  [-3.09466386]
curr_Stock_Price:  103.41926750176921
curr_Factors:  [103.4192675   -1.33567441  -1.15136846]
mat_Sqrt:  [[ 8.59988143  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0104762  0.10077232 0.76450827]
Stock Position:  0.010476198167372643
Bond Position:  [-4.1781046]


portfolio before change:  [-3.09751298]
curr_Stock_Price:  103.19716191149169
curr_Factors:  [103.19716191  -0.86453441  -1.16554398]
mat_Sqrt:  [[13.55239069  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316742 -0.03587186 -0.12433753]
Stock Position:  0.0031674214972491443
Bond Position:  [-3.42438189]


portfolio before change:  [-3.0943964]
curr_Stock_Price:  104.31625937089423
curr_Factors:  [104.31625937  -1.00765486  -1.16104636]
mat_Sqrt:  [[11.92606108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061639 -0.00358676  0.10157414]
Stock Position:  -0.0006163872598218641
Bond Position:  [-3.03009719]


portfolio before change:  [-3.09465984]
curr_Stock_Price:  104.12913268221723
curr_Factors:  [104.12913268  -1.00179517  -1.13202757]
mat_Sqrt:  [[12.32721037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0405761  -0.07506382  0.41589616]
Stock Position:  -0.04057610298137926
Bond Position:  [1.13049457]


portfolio before change:  [-3.07738602]
curr_Stock_Price:  103.7069013732457
curr_Factors:  [103.70690137  -0.93955924  -1.13927257]
mat_Sqrt:  [[12.97126931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01012323  0.00580111 -0.05715682]
Stock Position:  -0.010123225467304575
Bond Position:  [-2.02753768]


portfolio before change:  [-3.08082167]
curr_Stock_Price:  104.021247278705
curr_Factors:  [104.02124728  -0.78089942  -1.14340276]
mat_Sqrt:  [[15.18477084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01341523 0.25480962 0.52641713]
Stock Position:  0.013415232785467024
Bond Position:  [-4.47629092]


portfolio before change:  [-3.0737538]
curr_Stock_Price:  104.58981307079699
curr_Factors:  [104.58981307  -0.89370392  -1.1224797 ]
mat_Sqrt:  [[13.92746153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146008  0.01511147  0.0717612 ]
Stock Position:  -0.001460076940887351
Bond Position:  [-2.92104463]


portfolio before change:  [-3.07229878]
curr_Stock_Price:  103.34318363432611
curr_Factors:  [103.34318363  -0.69924363  -1.12554003]
mat_Sqrt:  [[16.66434941  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00028052 -0.0649239   0.1215128 ]
Stock Position:  -0.00028051957268901623
Bond Position:  [-3.043309]


portfolio before change:  [-3.07279223]
curr_Stock_Price:  103.74606538746549
curr_Factors:  [103.74606539  -0.78578824  -1.12961685]
mat_Sqrt:  [[15.27994438  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254378  0.01916992 -0.08961985]
Stock Position:  -0.002543783060523049
Bond Position:  [-2.80888475]


portfolio before change:  [-3.07025489]
curr_Stock_Price:  102.61056038493501
curr_Factors:  [102.61056038  -0.93185131  -1.12196495]
mat_Sqrt:  [[13.15924555  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01138762 -0.01028216  0.39157611]
Stock Position:  0.011387619641014627
Bond Position:  [-4.23874492]


portfolio before change:  [-3.07921076]
curr_Stock_Price:  101.87063439638176
curr_Factors:  [101.8706344   -0.82812339  -1.14015058]
mat_Sqrt:  [[14.23110061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00566284  0.02064263 -0.00695832]
Stock Position:  0.005662841356954456
Bond Position:  [-3.656088]


portfolio before change:  [-3.0805665]
curr_Stock_Price:  101.71193277524357
curr_Factors:  [101.71193278  -0.9079155   -1.14073604]
mat_Sqrt:  [[13.11154432  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034151  -0.05071673  0.28081252]
Stock Position:  -0.003415102579641121
Bond Position:  [-2.73320982]


portfolio before change:  [-3.07961048]
curr_Stock_Price:  101.33194476908659
curr_Factors:  [101.33194477  -0.90842829  -1.12207838]
mat_Sqrt:  [[13.30174257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00132668  0.01964828 -0.04437799]
Stock Position:  0.0013266811707334425
Bond Position:  [-3.21404566]


portfolio before change:  [-3.08156321]
curr_Stock_Price:  100.1628981600595
curr_Factors:  [100.16289816  -0.85049371  -1.11651834]
mat_Sqrt:  [[14.01020215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00130574 -0.01775483  0.0497395 ]
Stock Position:  0.0013057436943376122
Bond Position:  [-3.21235028]


portfolio before change:  [-3.08284608]
curr_Stock_Price:  99.48795525657847
curr_Factors:  [99.48795526 -0.47339235 -1.10967756]
mat_Sqrt:  [[20.42922905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035656  0.01337423 -0.10976281]
Stock Position:  0.0003565584290555703
Bond Position:  [-3.11831935]


portfolio before change:  [-3.08343033]
curr_Stock_Price:  98.94263764165002
curr_Factors:  [98.94263764 -0.56818778 -1.09997968]
mat_Sqrt:  [[18.6598247   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04044943  0.00888463 -2.31898516]
Stock Position:  -0.040449431122520765
Bond Position:  [0.91874307]


portfolio before change:  [-3.07120477]
curr_Stock_Price:  98.64323375681734
curr_Factors:  [98.64323376 -0.77459344 -1.09856726]
mat_Sqrt:  [[15.15527934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152756 -0.03634654 -0.11656216]
Stock Position:  -0.0015275620060804956
Bond Position:  [-2.92052111]


portfolio before change:  [-3.07320167]
curr_Stock_Price:  99.7114804771765
curr_Factors:  [99.71148048 -0.90337621 -1.08329076]
mat_Sqrt:  [[13.67560857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00326867  0.02918613  0.60368033]
Stock Position:  -0.003268666744904167
Bond Position:  [-2.74727807]


portfolio before change:  [-3.0746581]
curr_Stock_Price:  100.05198817207331
curr_Factors:  [100.05198817  -0.72779852  -1.10395701]
mat_Sqrt:  [[16.02154548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00103179 0.01637062 0.02970551]
Stock Position:  0.0010317897677607232
Bond Position:  [-3.17789072]


portfolio before change:  [-3.07630043]
curr_Stock_Price:  98.84528947117813
curr_Factors:  [98.84528947 -0.50211604 -1.12876089]
mat_Sqrt:  [[19.34973963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00848229 -0.00536654 -0.38066462]
Stock Position:  -0.008482294734885956
Bond Position:  [-2.23786555]


portfolio before change:  [-3.08429653]
curr_Stock_Price:  99.75499062787551
curr_Factors:  [99.75499063 -0.50331754 -1.12682951]
mat_Sqrt:  [[19.54207913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268209  0.0049611   0.16678008]
Stock Position:  -0.0026820945314273785
Bond Position:  [-2.81674421]


portfolio before change:  [-3.07927541]
curr_Stock_Price:  97.75161638536677
curr_Factors:  [97.75161639 -0.37219221 -1.09173578]
mat_Sqrt:  [[22.61247502  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00327593  0.02744761  0.41786865]
Stock Position:  -0.0032759336566804452
Bond Position:  [-2.75904759]


portfolio before change:  [-3.07388861]
curr_Stock_Price:  96.00197805850927
curr_Factors:  [96.00197806 -0.27601495 -1.07747014]
mat_Sqrt:  [[24.80099317  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00437984 -0.03061517  0.02618348]
Stock Position:  -0.004379840466015147
Bond Position:  [-2.65341526]


portfolio before change:  [-3.08225987]
curr_Stock_Price:  97.83756118747665
curr_Factors:  [97.83756119 -0.47140392 -1.10082897]
mat_Sqrt:  [[20.30923435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296064  0.01352806 -0.0011677 ]
Stock Position:  0.0029606438700378658
Bond Position:  [-3.37192204]


portfolio before change:  [-3.08001818]
curr_Stock_Price:  98.73709651073052
curr_Factors:  [98.73709651 -0.3454495  -1.10184845]
mat_Sqrt:  [[23.22345562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423108  0.02325615  0.00252593]
Stock Position:  -0.004231084759145257
Bond Position:  [-2.66225316]


portfolio before change:  [-3.0870364]
curr_Stock_Price:  100.31716739880261
curr_Factors:  [100.3171674   -0.5137552   -1.11278643]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.0870364]
Stock Price:  101.31343783844677
PL:  [-4.40047424]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.67233658e-01 -8.03304949e-03  8.51610031e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 1.85794572e-01  2.60491175e-01  4.01240838e-01]
 [-1.25868909e-02  4.37487572e-02  1.28623389e-01]
 [-6.54990058e-01 -1.98682546e-01  3.66473159e-02]
 [ 4.11287831e-02 -1.78841955e-01 -2.38081608e-01]
 [ 3.16108797e-02 -1.31483032e-01 -2.06340475e-02]
 [ 2.53713533e-01  1.45177163e-01 -6.99498393e-02]
 [-2.82563999e-01  7.80579636e-03 -1.11884012e-01]
 [ 8.09069074e-02 -2.99340094e-02 -2.76538118e-02]
 [ 7.94364128e-02 -2.21096981e-01  1.25737103e-04]
 [-6.13520015e-02 -6.46266999e-02 -1.39605743e-01]
 [ 2.63235640e-01 -2.87359105e-01  2.84232377e-03]
 [ 8.87494932e-02 -6.40641371e-02 -5.09174959e-02]
 [-1.23926189e-01  1.42473532e-01  1.11626842e-01]
 [ 2.96122443e-02 -3.09481929e-01 -7.54239459e-02]
 [ 1.36800081e-01 -2.09880969e-01 -1.07458551e-01]
 [-2.45938282e-01 -1.47063128e-02 -4.58608590e-02]
 [ 2.98213641e-01  1.40968651e+00  5.30738079e-01]
 [-1.89437551e-01 -2.17620551e-02  1.72945998e-01]
 [-8.63253570e-02 -2.29039382e-02 -4.50729086e-02]
 [ 1.95099439e-01 -3.79156411e-02  9.76023407e-02]
 [-1.13853056e-01  1.52150373e-02 -1.17253300e-01]
 [-1.40016906e-02 -1.23324330e-01  1.14353306e-01]
 [-9.91930552e-02  6.75444048e-02 -5.89806462e-02]
 [ 1.02690941e-01 -9.16891399e-02 -9.21615072e-02]
 [-6.05619613e-03 -2.12102020e-02 -3.73577634e-02]
 [-9.25051100e-03  4.12020792e-02  1.84335309e-02]
 [-5.81779427e-01  4.55112357e-02 -7.84803009e-01]
 [ 8.85969088e-02 -1.11316612e-01 -1.01970558e-01]
 [ 7.52321146e-02  2.88127193e-02  2.93308909e-02]
 [ 2.07520497e-02  1.08165049e-01 -1.68054046e-02]
 [-1.10367020e-01 -5.00757238e-03 -1.56197970e-01]
 [-6.18226282e-02  8.58423501e-02  1.02955695e-01]
 [-8.08992076e-02  5.61741689e-02  1.10645936e-01]
 [-5.54440882e-02 -5.31427114e-02  3.35148698e-02]
 [ 7.08895366e-02  5.35216947e-02  6.28998883e-03]
 [-1.17672195e-01  1.87181467e-01  7.66671163e-03]
 [-5.12030078e-03 -2.68912915e-01  9.68026463e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.95513925]
curr_Stock_Price:  99.9397232215469
curr_Factors:  [99.93972322 -0.94585089 -0.98248325]
mat_Sqrt:  [[14.53025603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01032725 -0.00254027  0.24294064]
Stock Position:  -0.010327254604881705
Bond Position:  [2.98724222]


portfolio before change:  [1.94923247]
curr_Stock_Price:  100.54784322710297
curr_Factors:  [100.54784323  -1.15707751  -1.01015779]
mat_Sqrt:  [[11.51209669  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00394203  0.01411938  0.0859571 ]
Stock Position:  -0.003942031072141069
Bond Position:  [2.34559519]


portfolio before change:  [1.95601451]
curr_Stock_Price:  98.90178226365524
curr_Factors:  [98.90178226 -1.18036889 -0.99000488]
mat_Sqrt:  [[11.28814983  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02431075 0.08237454 1.14462843]
Stock Position:  0.024310748235699012
Bond Position:  [-0.44836182]


portfolio before change:  [1.96797166]
curr_Stock_Price:  99.39593415837466
curr_Factors:  [99.39593416 -0.94689954 -0.9919311 ]
mat_Sqrt:  [[14.30030075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00103479 0.01383457 0.36692673]
Stock Position:  0.0010347919742402915
Bond Position:  [1.86511755]


portfolio before change:  [1.96835975]
curr_Stock_Price:  99.5456566217244
curr_Factors:  [99.54565662 -1.032313   -0.98169983]
mat_Sqrt:  [[13.28457481  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04912761 -0.06282894  0.10454459]
Stock Position:  -0.049127610545380625
Bond Position:  [6.8588]


portfolio before change:  [2.03460636]
curr_Stock_Price:  98.2146493786081
curr_Factors:  [98.21464938 -0.94942104 -0.98967773]
mat_Sqrt:  [[14.12655862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085563 -0.05655479 -0.67918056]
Stock Position:  -0.0008556295648383083
Bond Position:  [2.11864172]


portfolio before change:  [2.03445357]
curr_Stock_Price:  98.70275596130618
curr_Factors:  [98.70275596 -1.07080601 -0.99675626]
mat_Sqrt:  [[12.48528319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00192259 -0.04157859 -0.05886319]
Stock Position:  0.0019225911563599196
Bond Position:  [1.84468852]


portfolio before change:  [2.03488415]
curr_Stock_Price:  98.80677232281687
curr_Factors:  [98.80677232 -1.09659182 -0.98461789]
mat_Sqrt:  [[12.32902746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01972447  0.04590905 -0.19954742]
Stock Position:  0.01972447067366434
Bond Position:  [0.08597286]


portfolio before change:  [2.04297485]
curr_Stock_Price:  99.21641371691263
curr_Factors:  [99.21641372 -1.10108717 -0.98517272]
mat_Sqrt:  [[12.31777778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02477725  0.00246841 -0.31917394]
Stock Position:  -0.024777251894309748
Bond Position:  [4.50128493]


portfolio before change:  [2.06483571]
curr_Stock_Price:  98.35682840483693
curr_Factors:  [98.3568284  -1.04409839 -0.98780002]
mat_Sqrt:  [[12.89324541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00577738 -0.00946596 -0.07888863]
Stock Position:  0.005777381999829619
Bond Position:  [1.49659074]


portfolio before change:  [2.06520248]
curr_Stock_Price:  98.38792941691383
curr_Factors:  [98.38792942 -1.17677323 -0.99859619]
mat_Sqrt:  [[11.17354256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00660072 -0.069917    0.00035869]
Stock Position:  0.006600715838702552
Bond Position:  [1.41577172]


portfolio before change:  [2.06064655]
curr_Stock_Price:  97.67089876097134
curr_Factors:  [97.67089876 -1.2120168  -0.99430598]
mat_Sqrt:  [[10.75403329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00851007 -0.02043676 -0.39825633]
Stock Position:  -0.008510068389858521
Bond Position:  [2.89183258]


portfolio before change:  [2.06067939]
curr_Stock_Price:  97.70951917661611
curr_Factors:  [97.70951918 -1.05467772 -0.97749018]
mat_Sqrt:  [[12.80494067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02002323 -0.09087093  0.00810836]
Stock Position:  0.020023228032158183
Bond Position:  [0.1042194]


portfolio before change:  [2.04876635]
curr_Stock_Price:  97.11390782894938
curr_Factors:  [97.11390783 -1.12526836 -0.9601082 ]
mat_Sqrt:  [[12.06740528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00635612 -0.02025886 -0.14525344]
Stock Position:  0.006356119833857077
Bond Position:  [1.43149872]


portfolio before change:  [2.04909892]
curr_Stock_Price:  97.13807610078382
curr_Factors:  [97.1380761  -1.26363333 -0.94777857]
mat_Sqrt:  [[10.64107517  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00915902  0.04505409  0.31844031]
Stock Position:  -0.009159018470163911
Bond Position:  [2.93878835]


portfolio before change:  [2.0586046]
curr_Stock_Price:  96.14033648754581
curr_Factors:  [96.14033649 -1.26578215 -0.95111073]
mat_Sqrt:  [[10.47421035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00059437 -0.09786678 -0.21516352]
Stock Position:  0.0005943748046695702
Bond Position:  [2.00146121]


portfolio before change:  [2.05851258]
curr_Stock_Price:  95.5645646401303
curr_Factors:  [95.56456464 -1.39388946 -0.9361868 ]
mat_Sqrt:  [[ 9.29731669  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01177179 -0.06637019 -0.30654933]
Stock Position:  0.011771793529358844
Bond Position:  [0.93354626]


portfolio before change:  [2.06258541]
curr_Stock_Price:  95.90063359746593
curr_Factors:  [95.9006336  -1.66308815 -0.93133678]
mat_Sqrt:  [[ 7.16270467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03569592 -0.00465054 -0.13082827]
Stock Position:  -0.03569591616980321
Bond Position:  [5.48584639]


portfolio before change:  [2.07786011]
curr_Stock_Price:  95.49193364278973
curr_Factors:  [95.49193364 -1.59551196 -0.91970613]
mat_Sqrt:  [[ 7.72007199  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05737615 0.44578202 1.51404801]
Stock Position:  0.057376154941903824
Bond Position:  [-3.40109987]


portfolio before change:  [2.117435]
curr_Stock_Price:  96.18908835177723
curr_Factors:  [96.18908835 -1.74028846 -0.94126303]
mat_Sqrt:  [[ 6.58480313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02349303 -0.00688177  0.49336679]
Stock Position:  -0.023493032038004614
Bond Position:  [4.37720833]


portfolio before change:  [2.11643626]
curr_Stock_Price:  96.25489183579745
curr_Factors:  [96.25489184 -1.67005077 -0.91636048]
mat_Sqrt:  [[ 7.24700691  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01326302 -0.00724286 -0.12858046]
Stock Position:  -0.013263020750144718
Bond Position:  [3.39306689]


portfolio before change:  [2.11309528]
curr_Stock_Price:  96.5387744438854
curr_Factors:  [96.53877444 -1.94998973 -0.87032345]
mat_Sqrt:  [[ 5.75248284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03720888 -0.01198998  0.27843231]
Stock Position:  0.037208882082820346
Bond Position:  [-1.47900459]


portfolio before change:  [2.11914226]
curr_Stock_Price:  96.70625769728036
curr_Factors:  [96.7062577  -1.65810298 -0.89000244]
mat_Sqrt:  [[ 7.56530522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01816112  0.00481142 -0.33449103]
Stock Position:  -0.018161122536332473
Bond Position:  [3.87543645]


portfolio before change:  [2.11539934]
curr_Stock_Price:  96.93902850371387
curr_Factors:  [96.9390285  -1.61035379 -0.89283704]
mat_Sqrt:  [[ 7.93189032  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00077615 -0.03899858  0.32621815]
Stock Position:  0.0007761529140277852
Bond Position:  [2.04015983]


portfolio before change:  [2.11596052]
curr_Stock_Price:  97.33346861221297
curr_Factors:  [97.33346861 -1.78660362 -0.90508497]
mat_Sqrt:  [[ 6.59594002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01659937  0.02135942 -0.16825537]
Stock Position:  -0.016599368685548836
Bond Position:  [3.73163465]


portfolio before change:  [2.11980093]
curr_Stock_Price:  97.13021228869293
curr_Factors:  [97.13021229 -1.6060112  -0.91102156]
mat_Sqrt:  [[ 7.83828229  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01039911 -0.02899465 -0.26291113]
Stock Position:  0.010399108580340375
Bond Position:  [1.10973331]


portfolio before change:  [2.12970445]
curr_Stock_Price:  98.06921551245945
curr_Factors:  [98.06921551 -1.61179654 -0.88691993]
mat_Sqrt:  [[ 8.06035046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176537 -0.00670725 -0.1065713 ]
Stock Position:  -0.0017653652639868856
Bond Position:  [2.30283244]


portfolio before change:  [2.12950296]
curr_Stock_Price:  98.34641584759073
curr_Factors:  [98.34641585 -1.61567017 -0.8718425 ]
mat_Sqrt:  [[ 8.17420476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054121  0.01302924  0.05258573]
Stock Position:  -0.0005412085066245216
Bond Position:  [2.18272888]


portfolio before change:  [2.13003325]
curr_Stock_Price:  97.87076666852674
curr_Factors:  [97.87076667 -1.21068595 -0.84391891]
mat_Sqrt:  [[12.54149863  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05906803  0.01439192 -2.23882454]
Stock Position:  -0.05906802665831018
Bond Position:  [7.9110663]


portfolio before change:  [2.17946219]
curr_Stock_Price:  97.05069526027432
curr_Factors:  [97.05069526 -0.98877152 -0.83617028]
mat_Sqrt:  [[15.64719507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00414822 -0.0352014  -0.29089362]
Stock Position:  0.004148224200199249
Bond Position:  [1.77687415]


portfolio before change:  [2.18102739]
curr_Stock_Price:  97.37446708303692
curr_Factors:  [97.37446708 -0.97982381 -0.84331214]
mat_Sqrt:  [[15.72777225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00521137 0.00911138 0.08367287]
Stock Position:  0.0052113673525188
Bond Position:  [1.67357328]


portfolio before change:  [2.19331894]
curr_Stock_Price:  99.69292420893646
curr_Factors:  [99.69292421 -0.98579295 -0.83736593]
mat_Sqrt:  [[16.10187672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012492   0.03420479 -0.04794114]
Stock Position:  0.0012492003712863636
Bond Position:  [2.0687825]


portfolio before change:  [2.19189446]
curr_Stock_Price:  98.34559213409771
curr_Factors:  [98.34559213 -0.77920551 -0.8220019 ]
mat_Sqrt:  [[19.83167323  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00717943 -0.00158353 -0.44558933]
Stock Position:  -0.007179429130919252
Bond Position:  [2.89795967]


portfolio before change:  [2.1907204]
curr_Stock_Price:  98.55958228046293
curr_Factors:  [98.55958228 -0.88473706 -0.82983425]
mat_Sqrt:  [[17.74475449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217475  0.02714573  0.29370394]
Stock Position:  -0.0021747522689890826
Bond Position:  [2.40506308]


portfolio before change:  [2.19302604]
curr_Stock_Price:  97.63764478986268
curr_Factors:  [97.63764479 -0.7144703  -0.81202674]
mat_Sqrt:  [[21.21622211  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268018  0.01776383  0.31564206]
Stock Position:  -0.0026801797887013212
Bond Position:  [2.45471248]


portfolio before change:  [2.19297741]
curr_Stock_Price:  97.77028185370172
curr_Factors:  [97.77028185 -0.67114553 -0.81588191]
mat_Sqrt:  [[22.10034509  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226128 -0.0168052   0.09560859]
Stock Position:  -0.00226127839990773
Bond Position:  [2.41406323]


portfolio before change:  [2.19373634]
curr_Stock_Price:  97.56811356237495
curr_Factors:  [97.56811356 -0.70746962 -0.82104102]
mat_Sqrt:  [[21.1584656   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00347641 0.01692505 0.01794359]
Stock Position:  0.003476405181694668
Bond Position:  [1.85455005]


portfolio before change:  [2.19283801]
curr_Stock_Price:  97.2430188884491
curr_Factors:  [97.24301889 -0.57987574 -0.77007037]
mat_Sqrt:  [[25.21066423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00441378  0.05919198  0.02187099]
Stock Position:  -0.00441377619931528
Bond Position:  [2.62204694]


portfolio before change:  [2.18290646]
curr_Stock_Price:  99.5674065644721
curr_Factors:  [99.56740656 -0.60291328 -0.80875171]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.18290646]
Stock Price:  98.12359669757932
PL:  [2.18290646]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.25453225e-01  1.16738384e-02  6.14884369e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 1.62469862e-01 -1.32539437e-01 -2.10133444e-01]
 [-4.39598390e-02 -4.32249915e-02  2.73054459e-02]
 [-1.12535776e+00 -3.31919699e-01  2.51527376e-02]
 [ 1.81001693e-02 -1.02461404e-01 -1.34892079e-01]
 [ 2.49559307e-02 -1.10794190e-01 -3.61247646e-02]
 [ 4.10246034e-01  1.38413982e-01 -1.28229952e-01]
 [-2.40168072e-01  1.59943110e-02 -1.27500537e-01]
 [ 3.97565366e-02 -4.31020414e-03 -3.53221158e-02]
 [-1.82429123e-02 -1.72768671e-01  3.49407312e-02]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 2.19341459e-01 -1.70103497e-01  1.81368292e-01]
 [ 4.93554671e-02  1.86687781e-01  1.37851051e-01]
 [ 7.59107103e-02 -1.13041977e-01 -5.31313563e-02]
 [-1.31799952e-02 -1.41954255e-02  3.51629516e-02]
 [-6.61309552e-01 -3.26380154e-01  2.07404391e-01]
 [-1.16392368e-01  1.90790046e-02 -2.94460437e-02]
 [ 4.05251859e-01  1.43332957e+00  7.55091026e-01]
 [ 1.94614832e-03  1.91248582e-02  2.94075551e-02]
 [-5.58673440e-02 -9.45142219e-02 -1.82093281e-02]
 [ 6.69187666e-03  4.17966751e-02 -7.41669623e-03]
 [ 3.44996778e-02 -2.97722444e-02  5.35330866e-02]
 [ 4.13099104e-02  1.08491722e-01  8.65127905e-02]
 [-5.46570146e-02 -1.68008869e-01  2.84486830e-02]
 [ 1.06324496e-01 -2.80744357e-03 -9.41721220e-03]
 [-1.09015712e-02 -1.06906278e-02 -4.25003288e-02]
 [ 5.56387291e-03  4.18798528e-02 -5.83585620e-02]
 [-6.07094081e-01  2.82921623e-02 -8.37338655e-01]
 [-1.10347770e-01 -6.83697914e-02  9.35783822e-04]
 [-9.02798921e-02  9.22946337e-02  2.11615573e-01]
 [ 1.58117737e-02  7.03097145e-02  1.51526007e-03]
 [-1.21477920e-01 -7.35340789e-03 -1.46497669e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 1.68660314e-01 -1.33377667e-01 -4.44372294e-02]
 [ 9.07568368e-03  2.76578520e-02  7.47966388e-02]
 [-1.27733371e-02 -1.78875983e-02 -4.36985650e-02]
 [-8.96601771e-02  8.51742564e-03 -2.60497988e-04]
 [-3.44519233e-02 -2.83377449e-01  1.41563909e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.78536791]
curr_Stock_Price:  99.91606898608428
curr_Factors:  [99.91606899 -1.17817928 -1.01409275]
mat_Sqrt:  [[11.15690387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01009245  0.00369159  0.1754094 ]
Stock Position:  -0.010092453517110732
Bond Position:  [2.79376619]


portfolio before change:  [1.78224366]
curr_Stock_Price:  100.26023551821494
curr_Factors:  [100.26023552  -1.4689914   -1.00279896]
mat_Sqrt:  [[ 8.46532831  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00536081  0.01411938  0.0859571 ]
Stock Position:  -0.005360813093826123
Bond Position:  [2.31972005]


portfolio before change:  [1.78253788]
curr_Stock_Price:  100.2594453183341
curr_Factors:  [100.25944532  -1.57635218  -0.98917163]
mat_Sqrt:  [[ 7.70783594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01506965 -0.04191265 -0.59945223]
Stock Position:  0.01506965121298678
Bond Position:  [0.27166301]


portfolio before change:  [1.77505754]
curr_Stock_Price:  99.76080683438057
curr_Factors:  [99.76080683 -1.76192914 -0.98273039]
mat_Sqrt:  [[ 6.41164492  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00616101 -0.01366894  0.07789484]
Stock Position:  -0.006161009105246316
Bond Position:  [2.38968477]


portfolio before change:  [1.77848671]
curr_Stock_Price:  99.2527013626325
curr_Factors:  [99.25270136 -1.75933914 -0.96778747]
mat_Sqrt:  [[ 6.49181745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.17387944 -0.10496222  0.07175376]
Stock Position:  -0.17387944397889646
Bond Position:  [19.03649123]


portfolio before change:  [1.82966888]
curr_Stock_Price:  98.97203296263211
curr_Factors:  [98.97203296 -1.64063539 -0.96519059]
mat_Sqrt:  [[ 7.30830474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165293 -0.03240114 -0.38480955]
Stock Position:  -0.0016529282004583683
Bond Position:  [1.99326255]


portfolio before change:  [1.82995864]
curr_Stock_Price:  98.94748277642657
curr_Factors:  [98.94748278 -1.77264682 -0.94556331]
mat_Sqrt:  [[ 6.52981819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00225447 -0.0350362  -0.1030539 ]
Stock Position:  0.002254473234954394
Bond Position:  [1.60688418]


portfolio before change:  [1.83033633]
curr_Stock_Price:  99.02591503160974
curr_Factors:  [99.02591503 -1.76079531 -0.94915147]
mat_Sqrt:  [[ 6.58921881  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0588302   0.04377034 -0.36580436]
Stock Position:  0.05883019670730248
Bond Position:  [-3.99537773]


portfolio before change:  [1.82771646]
curr_Stock_Price:  98.98987197826699
curr_Factors:  [98.98987198 -1.64150386 -0.95116623]
mat_Sqrt:  [[ 7.40642192  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03588521  0.00505785 -0.36372354]
Stock Position:  -0.03588521441257583
Bond Position:  [5.37998924]


portfolio before change:  [1.82674447]
curr_Stock_Price:  99.0356994429998
curr_Factors:  [99.03569944 -1.5919833  -0.96846106]
mat_Sqrt:  [[ 7.65252787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00423849 -0.00136301 -0.10076416]
Stock Position:  0.004238488443424969
Bond Position:  [1.4069828]


portfolio before change:  [1.83143962]
curr_Stock_Price:  100.1019437023441
curr_Factors:  [100.1019437   -1.78488366  -0.98392871]
mat_Sqrt:  [[ 6.28004244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247953 -0.05463425  0.09967618]
Stock Position:  -0.002479526772792471
Bond Position:  [2.07964507]


portfolio before change:  [1.83132787]
curr_Stock_Price:  100.25186178417313
curr_Factors:  [100.25186178  -1.61383836  -0.96227333]
mat_Sqrt:  [[ 7.62607992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00945776  0.00225658  0.15019092]
Stock Position:  -0.009457758034453511
Bond Position:  [2.77948572]


portfolio before change:  [1.83415941]
curr_Stock_Price:  99.98921081679919
curr_Factors:  [99.98921082 -1.57040072 -0.94743486]
mat_Sqrt:  [[ 8.06252438  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03125213 -0.05379145  0.51739325]
Stock Position:  0.031252129120672635
Bond Position:  [-1.29071632]


portfolio before change:  [1.85583112]
curr_Stock_Price:  100.68782120441702
curr_Factors:  [100.6878212   -1.83786205  -0.97063021]
mat_Sqrt:  [[ 6.07105622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01355851 0.05903586 0.39325068]
Stock Position:  0.01355850609310324
Bond Position:  [0.49065469]


portfolio before change:  [1.86021018]
curr_Stock_Price:  101.00627231054546
curr_Factors:  [101.00627231  -2.07220669  -0.98313   ]
mat_Sqrt:  [[ 4.75808811  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01306125 -0.03574701 -0.15156897]
Stock Position:  0.013061251687162084
Bond Position:  [0.54094184]


portfolio before change:  [1.86446018]
curr_Stock_Price:  101.32648500780938
curr_Factors:  [101.32648501  -2.17315172  -0.9456511 ]
mat_Sqrt:  [[ 4.47965043  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142174 -0.00448899  0.10031011]
Stock Position:  -0.0014217431002393492
Bond Position:  [2.00852041]


portfolio before change:  [1.86477365]
curr_Stock_Price:  101.28260503702685
curr_Factors:  [101.28260504  -2.35581448  -0.93473461]
mat_Sqrt:  [[ 3.77109568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.16637085 -0.10321047  0.591667  ]
Stock Position:  -0.16637085364310322
Bond Position:  [18.71524711]


portfolio before change:  [1.91528282]
curr_Stock_Price:  100.99307341135264
curr_Factors:  [100.99307341  -2.27667433  -0.91054406]
mat_Sqrt:  [[ 4.169656    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02923752  0.00603331 -0.08400137]
Stock Position:  -0.029237519583937274
Bond Position:  [4.86806979]


portfolio before change:  [1.91569735]
curr_Stock_Price:  100.99970937558795
curr_Factors:  [100.99970938  -1.9847593   -0.91148431]
mat_Sqrt:  [[ 5.57824394  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.10691404 0.45325861 2.15406452]
Stock Position:  0.1069140370189874
Bond Position:  [-8.88258932]


portfolio before change:  [1.9001681]
curr_Stock_Price:  100.86484533069014
curr_Factors:  [100.86484533  -2.01806887  -0.89745732]
mat_Sqrt:  [[ 5.46440512  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00154504 0.00604781 0.08389157]
Stock Position:  0.001545043219403681
Bond Position:  [1.74432755]


portfolio before change:  [1.90073823]
curr_Stock_Price:  101.09271848162375
curr_Factors:  [101.09271848  -1.81532094  -0.90470053]
mat_Sqrt:  [[ 6.65931497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00931397 -0.02988802 -0.05194614]
Stock Position:  -0.009313969162752896
Bond Position:  [2.84231269]


portfolio before change:  [1.89689313]
curr_Stock_Price:  101.5436978285262
curr_Factors:  [101.54369783  -1.76444264  -0.92100435]
mat_Sqrt:  [[ 6.92433653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090364  0.01321727 -0.02115777]
Stock Position:  0.0009036440323741959
Bond Position:  [1.80513377]


portfolio before change:  [1.89661438]
curr_Stock_Price:  100.98550391630835
curr_Factors:  [100.98550392  -1.73827712  -0.89928637]
mat_Sqrt:  [[ 7.22403377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00618191 -0.00941481  0.152715  ]
Stock Position:  0.006181914249617161
Bond Position:  [1.27233065]


portfolio before change:  [1.8941511]
curr_Stock_Price:  100.56131033106104
curr_Factors:  [100.56131033  -1.5133035   -0.9028978 ]
mat_Sqrt:  [[ 8.97610721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00688166 0.03430809 0.24679691]
Stock Position:  0.006881658449368732
Bond Position:  [1.20212251]


portfolio before change:  [1.89621671]
curr_Stock_Price:  100.83963548881351
curr_Factors:  [100.83963549  -1.50623816  -0.89613992]
mat_Sqrt:  [[ 9.12623663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00582802 -0.05312907  0.08115617]
Stock Position:  -0.0058280235305787475
Bond Position:  [2.48391248]


portfolio before change:  [1.90415891]
curr_Stock_Price:  99.53015434466917
curr_Factors:  [99.53015434 -1.39145318 -0.89852025]
mat_Sqrt:  [[10.07933443  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01035085 -0.00088779 -0.02686469]
Stock Position:  0.01035085487448449
Bond Position:  [0.87393673]


portfolio before change:  [1.90645278]
curr_Stock_Price:  99.74121154359489
curr_Factors:  [99.74121154 -1.34932188 -0.93165757]
mat_Sqrt:  [[10.1919633   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019479  -0.00338067 -0.12124161]
Stock Position:  -0.0019479019638203288
Bond Position:  [2.10073888]


portfolio before change:  [1.90567332]
curr_Stock_Price:  100.27618414082706
curr_Factors:  [100.27618414  -1.54350571  -0.92131274]
mat_Sqrt:  [[ 8.52591009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061779  0.01324357 -0.16648073]
Stock Position:  -0.0006177857233799259
Bond Position:  [1.96762251]


portfolio before change:  [1.90602291]
curr_Stock_Price:  100.10844948764908
curr_Factors:  [100.10844949  -1.32018301  -0.93568127]
mat_Sqrt:  [[10.48965797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07410009  0.00894677 -2.38869411]
Stock Position:  -0.07410009169899867
Bond Position:  [9.3240682]


portfolio before change:  [1.90569693]
curr_Stock_Price:  100.12857850831959
curr_Factors:  [100.12857851  -1.50273202  -0.94431633]
mat_Sqrt:  [[ 8.6659954   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01291508 -0.02162043  0.00266953]
Stock Position:  -0.012915083565361082
Bond Position:  [3.19886589]


portfolio before change:  [1.9071626]
curr_Stock_Price:  100.04605557629208
curr_Factors:  [100.04605558  -1.23328133  -0.94295239]
mat_Sqrt:  [[11.35203376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393771  0.02918613  0.60368033]
Stock Position:  -0.0039377091272559065
Bond Position:  [2.30111487]


portfolio before change:  [1.9076668]
curr_Stock_Price:  99.99106429020914
curr_Factors:  [99.99106429 -1.16556288 -0.95128926]
mat_Sqrt:  [[12.03993077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00148975 0.02223388 0.00432262]
Stock Position:  0.0014897480922836416
Bond Position:  [1.7587053]


portfolio before change:  [1.90680443]
curr_Stock_Price:  99.26462221944368
curr_Factors:  [99.26462222 -1.00677484 -0.95762341]
mat_Sqrt:  [[13.92089556  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01088806 -0.00232535 -0.41791707]
Stock Position:  -0.01088805639327225
Bond Position:  [2.98760324]


portfolio before change:  [1.90240964]
curr_Stock_Price:  99.70255820759975
curr_Factors:  [99.70255821 -1.01503398 -0.94514881]
mat_Sqrt:  [[14.04137811  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0037328   0.0049611   0.16678008]
Stock Position:  -0.0037328033709646945
Bond Position:  [2.27457968]


portfolio before change:  [1.90036136]
curr_Stock_Price:  100.32745551406357
curr_Factors:  [100.32745551  -0.94751776  -0.94470186]
mat_Sqrt:  [[15.12304545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01032502 -0.04217772 -0.12676705]
Stock Position:  0.010325023884208313
Bond Position:  [0.86447798]


portfolio before change:  [1.90233504]
curr_Stock_Price:  100.50814445938103
curr_Factors:  [100.50814446  -1.19176684  -0.96311514]
mat_Sqrt:  [[11.65058963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00215076 0.00874618 0.21337399]
Stock Position:  0.002150758640258921
Bond Position:  [1.68616628]


portfolio before change:  [1.9027598]
curr_Stock_Price:  100.60763160519407
curr_Factors:  [100.60763161  -1.05897652  -0.96244041]
mat_Sqrt:  [[13.32725502  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166239 -0.00565656 -0.12465984]
Stock Position:  -0.0016623922284258943
Bond Position:  [2.07000914]


portfolio before change:  [1.90375833]
curr_Stock_Price:  100.16263091747527
curr_Factors:  [100.16263092  -0.86259649  -0.93124357]
mat_Sqrt:  [[16.65907497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00537205  0.00269345 -0.00074313]
Stock Position:  -0.005372052899499316
Bond Position:  [2.44183728]


portfolio before change:  [1.90035833]
curr_Stock_Price:  100.85235779403084
curr_Factors:  [100.85235779  -1.20725854  -0.95129335]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.90035833]
Stock Price:  100.63149452244464
PL:  [1.26886381]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-7.11801431e-02  7.86791696e-02  5.84939423e-02]
 [-4.33449140e-02  2.98581299e-02  3.76963646e-03]
 [ 3.31200613e-01  7.46487245e-03 -8.39710724e-02]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-8.45234421e-01 -2.52571487e-01  3.19982324e-02]
 [-9.16968753e-03 -8.67796998e-02 -9.98644544e-02]
 [ 3.30757343e-02  4.08963044e-02 -1.75727834e-02]
 [ 3.11818395e-01  4.31265425e-04 -7.73505131e-02]
 [-3.62867866e-01 -9.05092280e-03 -7.66345274e-02]
 [ 5.09855947e-02 -2.33871666e-02 -4.42614667e-02]
 [ 9.53906481e-02 -2.17385658e-01 -7.12807815e-03]
 [-2.26475278e-02 -4.33366081e-02 -9.20699171e-02]
 [ 2.46914998e-01 -2.42497123e-01  7.58626630e-02]
 [ 9.45984752e-02 -7.03857694e-03 -2.73094293e-02]
 [ 1.87484525e-02 -8.82197000e-02 -4.42015357e-02]
 [-4.48100798e-02 -9.81298331e-03  2.41038093e-02]
 [-4.84785593e-01 -2.58608342e-01  1.33270632e-01]
 [-1.36935871e-01  1.77443836e-02 -1.23421854e-02]
 [ 2.18509295e-01  9.52686901e-01  3.07269793e-01]
 [-3.39016813e-03  2.44619217e-02  2.86126340e-02]
 [-4.21836895e-02 -1.58354722e-01 -6.30723530e-03]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 7.33488866e-02 -3.34791094e-02  9.67250955e-02]
 [ 7.87562879e-02  3.84279183e-02 -1.02392150e-02]
 [-5.72423155e-02 -1.54228556e-01 -1.13967343e-02]
 [ 7.19323972e-02  2.59220231e-02 -1.40836251e-02]
 [-1.91191598e-02  7.15020619e-03 -5.12219419e-02]
 [ 6.43565717e-03  4.16670345e-02 -5.13119615e-02]
 [-6.57699989e-01 -1.08182976e-02 -9.46977322e-01]
 [-1.07780232e-01 -9.94518926e-02  9.95591126e-03]
 [-6.52529440e-02  8.04586126e-02  1.84674239e-01]
 [ 1.87928498e-02  9.25541202e-02 -9.23201835e-03]
 [-1.10392246e-01 -1.03789927e-03 -1.53820042e-01]
 [-6.41111837e-02  3.10459391e-02  6.82033750e-02]
 [-5.24170283e-02  2.84489186e-02  8.20460598e-02]
 [-7.03447341e-02 -5.52279268e-02  2.22766553e-02]
 [ 6.10923959e-02  4.47564222e-02  6.03084423e-04]
 [-1.20548554e-01  1.95735940e-01  5.91011243e-03]
 [ 1.96516901e-03 -2.34471081e-01  7.83765989e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.44895369]
curr_Stock_Price:  100.98383613098629
curr_Factors:  [100.98383613  -0.9091963   -0.99679789]
mat_Sqrt:  [[15.01374738  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00381042  0.02488054  0.16686694]
Stock Position:  -0.0038104164299563414
Bond Position:  [9.83374416]


portfolio before change:  [9.4502883]
curr_Stock_Price:  100.95619728340904
curr_Factors:  [100.95619728  -1.00099944  -1.00683052]
mat_Sqrt:  [[13.55637295  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308375  0.00944197  0.01075372]
Stock Position:  -0.0030837530561410335
Bond Position:  [9.76161228]


portfolio before change:  [9.45075514]
curr_Stock_Price:  101.20052136275184
curr_Factors:  [101.20052136  -0.8324797   -0.98019839]
mat_Sqrt:  [[16.51758906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01902535  0.0023606  -0.2395461 ]
Stock Position:  0.019025345112004943
Bond Position:  [7.5253803]


portfolio before change:  [9.46285413]
curr_Stock_Price:  101.7870158913583
curr_Factors:  [101.78701589  -0.82790661  -0.98572485]
mat_Sqrt:  [[16.59748366  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118711 -0.00659539  0.21422481]
Stock Position:  0.001187110908498294
Bond Position:  [9.34202166]


portfolio before change:  [9.46283694]
curr_Stock_Price:  100.78877575331813
curr_Factors:  [100.78877575  -0.99966381  -0.99074853]
mat_Sqrt:  [[13.77168481  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06137406 -0.07987012  0.09128205]
Stock Position:  -0.06137405759156954
Bond Position:  [15.64865306]


portfolio before change:  [9.53591626]
curr_Stock_Price:  99.62992911576352
curr_Factors:  [99.62992912 -1.10673512 -0.98053975]
mat_Sqrt:  [[12.35656805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257313 -0.02744215 -0.28488549]
Stock Position:  -0.002573131634709955
Bond Position:  [9.79227718]


portfolio before change:  [9.53556367]
curr_Stock_Price:  100.2426844131763
curr_Factors:  [100.24268441  -1.16503794  -0.99235397]
mat_Sqrt:  [[11.59068984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00263527  0.01293255 -0.05013026]
Stock Position:  0.0026352739416924025
Bond Position:  [9.27139674]


portfolio before change:  [9.53613104]
curr_Stock_Price:  100.01818149370204
curr_Factors:  [100.01818149  -1.10374793  -0.97495839]
mat_Sqrt:  [[12.51146806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.36615257e-02  1.36378102e-04 -2.20659484e-01]
Stock Position:  0.023661525665098975
Bond Position:  [7.16954827]


portfolio before change:  [9.527919]
curr_Stock_Price:  99.6332405440362
curr_Factors:  [99.63324054 -1.0566403  -0.93002023]
mat_Sqrt:  [[13.66496574  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02771646 -0.00286215 -0.21861698]
Stock Position:  -0.027716462957425397
Bond Position:  [12.28940002]


portfolio before change:  [9.52686666]
curr_Stock_Price:  99.72663668459163
curr_Factors:  [99.72663668 -1.04917483 -0.93003535]
mat_Sqrt:  [[13.7800601   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00300049 -0.00739567 -0.12626564]
Stock Position:  0.0030004881187368393
Bond Position:  [9.22763807]


portfolio before change:  [9.5232216]
curr_Stock_Price:  98.12736631675916
curr_Factors:  [98.12736632 -1.19995533 -0.913572  ]
mat_Sqrt:  [[11.85487242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00745033 -0.06874338 -0.02033442]
Stock Position:  0.007450334221962402
Bond Position:  [8.79213992]


portfolio before change:  [9.52455691]
curr_Stock_Price:  98.15907313327544
curr_Factors:  [98.15907313 -1.18233364 -0.94640057]
mat_Sqrt:  [[11.67973338  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364393 -0.01370424 -0.26264985]
Stock Position:  -0.003643933118948036
Bond Position:  [9.88224201]


portfolio before change:  [9.52461124]
curr_Stock_Price:  98.4831820653216
curr_Factors:  [98.48318207 -1.12569192 -0.93517371]
mat_Sqrt:  [[12.54121171  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0204238  -0.07668432  0.21641506]
Stock Position:  0.02042379609173947
Bond Position:  [7.51321081]


portfolio before change:  [9.53599205]
curr_Stock_Price:  98.99442899521621
curr_Factors:  [98.994429   -1.19237925 -0.91695989]
mat_Sqrt:  [[12.00981746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00739747 -0.00222579 -0.0779062 ]
Stock Position:  0.0073974668102269785
Bond Position:  [8.80368405]


portfolio before change:  [9.54014827]
curr_Stock_Price:  99.4075012330564
curr_Factors:  [99.40750123 -1.07721374 -0.92777603]
mat_Sqrt:  [[13.38638034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00055639 -0.02789752 -0.12609468]
Stock Position:  0.0005563885640261524
Bond Position:  [9.48483907]


portfolio before change:  [9.54163326]
curr_Stock_Price:  99.94545304834926
curr_Factors:  [99.94545305 -1.09390168 -0.91722994]
mat_Sqrt:  [[13.37641332  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300105 -0.00310314  0.06876146]
Stock Position:  -0.0030010496481735136
Bond Position:  [9.84157452]


portfolio before change:  [9.54027608]
curr_Stock_Price:  100.80763309698257
curr_Factors:  [100.8076331   -1.14212743  -0.94552928]
mat_Sqrt:  [[12.49785916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03714709 -0.08177914  0.38018402]
Stock Position:  -0.03714708825704114
Bond Position:  [13.28498613]


portfolio before change:  [9.53466507]
curr_Stock_Price:  101.0033885945457
curr_Factors:  [101.00338859  -1.0787707   -0.93959466]
mat_Sqrt:  [[13.42057127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01035701  0.00561127 -0.03520882]
Stock Position:  -0.010357014488415927
Bond Position:  [10.58075862]


portfolio before change:  [9.52195886]
curr_Stock_Price:  102.35791814369277
curr_Factors:  [102.35791814  -0.95281505  -0.93873775]
mat_Sqrt:  [[15.43940289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01980833 0.30126605 0.87655519]
Stock Position:  0.01980832748031076
Bond Position:  [7.4944197]


portfolio before change:  [9.53913211]
curr_Stock_Price:  103.17759291815749
curr_Factors:  [103.17759292  -0.97340639  -0.94384911]
mat_Sqrt:  [[15.16812519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00020319 0.00773554 0.08162388]
Stock Position:  0.0002031869723233418
Bond Position:  [9.51816777]


portfolio before change:  [9.54007177]
curr_Stock_Price:  101.9463110975093
curr_Factors:  [101.9463111   -0.99387018  -0.94753125]
mat_Sqrt:  [[14.62957091  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325094 -0.05007616 -0.01799279]
Stock Position:  -0.0032509394947942537
Bond Position:  [9.87149306]


portfolio before change:  [9.5425281]
curr_Stock_Price:  101.57032378792861
curr_Factors:  [101.57032379  -0.97059662  -0.9381633 ]
mat_Sqrt:  [[15.05923589  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258106  0.01916992 -0.08961985]
Stock Position:  -0.002581064801655489
Bond Position:  [9.80468769]


portfolio before change:  [9.54275755]
curr_Stock_Price:  101.95629291584167
curr_Factors:  [101.95629292  -1.39519718  -0.95087295]
mat_Sqrt:  [[ 9.76177343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00944791 -0.01058702  0.27592977]
Stock Position:  0.009447913106055875
Bond Position:  [8.57948335]


portfolio before change:  [9.54326953]
curr_Stock_Price:  101.8969657757258
curr_Factors:  [101.89696578  -1.45005353  -0.95146316]
mat_Sqrt:  [[ 9.22987475  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00841381  0.01215197 -0.02920963]
Stock Position:  0.008413810979766992
Bond Position:  [8.68592773]


portfolio before change:  [9.53317138]
curr_Stock_Price:  100.56772727490387
curr_Factors:  [100.56772727  -1.22023555  -0.92315692]
mat_Sqrt:  [[11.79220747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00538922 -0.04877135 -0.03251171]
Stock Position:  -0.005389222372943068
Bond Position:  [10.07515323]


portfolio before change:  [9.53563076]
curr_Stock_Price:  100.34507800180029
curr_Factors:  [100.345078    -1.27839469  -0.93351277]
mat_Sqrt:  [[10.98694291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00634634  0.00819726 -0.04017666]
Stock Position:  0.006346341613500867
Bond Position:  [8.89880662]


portfolio before change:  [9.53506779]
curr_Stock_Price:  100.0810847266637
curr_Factors:  [100.08108473  -1.44092895  -0.90894106]
mat_Sqrt:  [[ 9.54589     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307883  0.00226109 -0.14612194]
Stock Position:  -0.0030788305098132748
Bond Position:  [9.84320049]


portfolio before change:  [9.53622793]
curr_Stock_Price:  100.10393088167052
curr_Factors:  [100.10393088  -1.23887927  -0.908623  ]
mat_Sqrt:  [[11.68968334  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025343  0.01317627 -0.14637874]
Stock Position:  -0.00025342986816089317
Bond Position:  [9.56159725]


portfolio before change:  [9.5373844]
curr_Stock_Price:  100.25705601556878
curr_Factors:  [100.25705602  -1.10628139  -0.8715225 ]
mat_Sqrt:  [[13.87284811  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06136305 -0.00342105 -2.70146271]
Stock Position:  -0.06136304862176767
Bond Position:  [15.689463]


portfolio before change:  [9.55753256]
curr_Stock_Price:  99.96067478819555
curr_Factors:  [99.96067479 -1.1939465  -0.85632268]
mat_Sqrt:  [[12.8649644   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00841944 -0.03144945  0.02840144]
Stock Position:  -0.008419442445815077
Bond Position:  [10.3991457]


portfolio before change:  [9.56875143]
curr_Stock_Price:  98.78258056318926
curr_Factors:  [98.78258056 -1.21699118 -0.8281631 ]
mat_Sqrt:  [[12.77853744  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199389  0.02544325  0.5268242 ]
Stock Position:  -0.001993893325172113
Bond Position:  [9.76571336]


portfolio before change:  [9.56760508]
curr_Stock_Price:  99.96977502498285
curr_Factors:  [99.96977502 -1.22830677 -0.84296742]
mat_Sqrt:  [[12.59870086  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00153175  0.02926818 -0.02633638]
Stock Position:  0.0015317538905810408
Bond Position:  [9.41447599]


portfolio before change:  [9.56770561]
curr_Stock_Price:  99.26708272027663
curr_Factors:  [99.26708272 -1.2307981  -0.8223789 ]
mat_Sqrt:  [[12.73860339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.11328868e-02 -3.28212568e-04 -4.38805764e-01]
Stock Position:  -0.01113288675139878
Bond Position:  [10.6728348]


portfolio before change:  [9.56818911]
curr_Stock_Price:  99.3434948260356
curr_Factors:  [99.34349483 -0.89385404 -0.81864963]
mat_Sqrt:  [[17.9229107   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275556  0.00981759  0.19456524]
Stock Position:  -0.0027555583015235795
Bond Position:  [9.8419359]


portfolio before change:  [9.57328578]
curr_Stock_Price:  97.94038517401103
curr_Factors:  [97.94038517 -0.77344317 -0.80729844]
mat_Sqrt:  [[20.1583253   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173303  0.00899634  0.23405457]
Stock Position:  -0.001733025834068627
Bond Position:  [9.743019]


portfolio before change:  [9.5757156]
curr_Stock_Price:  97.24110480511467
curr_Factors:  [97.24110481 -0.76685074 -0.81326983]
mat_Sqrt:  [[20.02683139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00335667 -0.0174646   0.0635491 ]
Stock Position:  -0.00335667228074821
Bond Position:  [9.90212213]


portfolio before change:  [9.57483331]
curr_Stock_Price:  97.87272246234299
curr_Factors:  [97.87272246 -0.84531155 -0.81385703]
mat_Sqrt:  [[18.62489835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0033488  0.01415322 0.00172043]
Stock Position:  0.0033488024844187106
Bond Position:  [9.2470769]


portfolio before change:  [9.57355021]
curr_Stock_Price:  97.1443843130853
curr_Factors:  [97.14438431 -0.88664009 -0.81935755]
mat_Sqrt:  [[17.64055876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00647872  0.06189714  0.01685991]
Stock Position:  -0.006478722075259284
Bond Position:  [10.20292168]


portfolio before change:  [9.57747485]
curr_Stock_Price:  96.73547788466522
curr_Factors:  [96.73547788 -0.97496043 -0.84654799]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.57747485]
Stock Price:  96.41728494603193
PL:  [9.57747485]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.13818961e-02 -2.34392545e-02 -6.14880617e-03]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.00863346e-01  2.43707103e-01  3.65498731e-01]
 [-5.03903717e-02 -5.40345246e-02  7.89459167e-02]
 [-2.96052774e-01 -9.70093617e-02  4.54188210e-02]
 [ 5.50310108e-02 -2.03512559e-01 -2.73485715e-01]
 [ 2.75829259e-02 -1.89694353e-01 -2.73988559e-02]
 [ 1.09583064e-01  1.74449792e-01 -1.85932920e-02]
 [-2.36381483e-01  3.92979920e-03 -7.50176337e-02]
 [ 9.51990625e-02 -3.07536773e-02  6.90947065e-03]
 [ 5.26147545e-02 -3.69757687e-01  1.36668882e-01]
 [-1.36238400e-01 -1.05819310e-01 -2.31579267e-01]
 [ 2.69664780e-01 -3.99362536e-01 -1.51418068e-01]
 [-7.59973964e-03 -1.56121845e-01 -8.85370455e-02]
 [-1.94026916e-01  3.11603458e-01  2.26645318e-01]
 [ 9.44565685e-03 -2.05262919e-01 -4.34245707e-02]
 [-1.27313561e-01 -2.81105974e-01  2.32054964e-04]
 [-2.74316873e-01 -1.30115114e-01 -4.50525478e-02]
 [ 2.42648132e-01  1.12369631e+00  2.14631984e-01]
 [-3.11406358e-01 -4.71352970e-02  2.42435960e-01]
 [-9.76618456e-02  3.44825248e-01 -2.78301548e-02]
 [-2.52715140e-02  3.96482714e-02 -1.27854105e-02]
 [-1.09702413e-02 -2.68948821e-02 -2.64973591e-02]
 [ 1.81880985e-02  7.94606263e-02  1.20901393e-01]
 [-1.12120389e-01  1.01298523e-01  3.96972179e-02]
 [ 1.12886940e-01 -5.89578799e-02 -4.19223533e-02]
 [ 3.68000459e-02 -6.49477178e-02  1.15055035e-01]
 [-2.39853596e-02  4.28810486e-02  2.85586185e-02]
 [-5.53664697e-01  5.05314738e-02 -7.40342314e-01]
 [-2.57308468e-02 -1.12625610e-01 -3.39898815e-02]
 [ 5.84144600e-02  4.21629777e-02  4.59348970e-02]
 [ 1.76277184e-02  8.70131418e-02 -6.65362061e-03]
 [-1.36453876e-01 -1.69704838e-02 -1.33439103e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [-8.21115047e-02  7.12557156e-02  1.36079324e-01]
 [-3.20518732e-02 -4.92166226e-02  5.36626129e-02]
 [ 8.32101381e-02  6.56116074e-02  1.26995605e-02]
 [-1.15708912e-01  1.58231643e-01  7.28530358e-03]
 [ 2.38961180e-03 -2.60498677e-01  9.06737913e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.64887477]
curr_Stock_Price:  100.17571133428123
curr_Factors:  [100.17571133  -1.14569924  -1.02303892]
mat_Sqrt:  [[11.45226584  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00814181 -0.00741214 -0.01754083]
Stock Position:  -0.008141813696951288
Bond Position:  [4.46448675]


portfolio before change:  [3.65305513]
curr_Stock_Price:  99.73081571439833
curr_Factors:  [99.73081571 -0.892699   -1.01419229]
mat_Sqrt:  [[14.81415911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306336  0.01411938  0.0859571 ]
Stock Position:  -0.003063355975599284
Bond Position:  [3.95856612]


portfolio before change:  [3.65524535]
curr_Stock_Price:  99.17738078539237
curr_Factors:  [99.17738079 -1.11748795 -1.00472124]
mat_Sqrt:  [[11.87815235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02372111 0.07706695 1.04266614]
Stock Position:  0.02372110944797515
Bond Position:  [1.30264784]


portfolio before change:  [3.62840098]
curr_Stock_Price:  98.03885005866735
curr_Factors:  [98.03885006 -0.95043633 -1.02536248]
mat_Sqrt:  [[13.59313689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262417 -0.01708722  0.22521073]
Stock Position:  -0.0026241749528348704
Bond Position:  [3.88567207]


portfolio before change:  [3.62913833]
curr_Stock_Price:  97.94296660540209
curr_Factors:  [97.94296661 -0.98413701 -1.01063885]
mat_Sqrt:  [[13.32456703  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02171076 -0.03067705  0.12956725]
Stock Position:  -0.021710759217051255
Bond Position:  [5.7555545]


portfolio before change:  [3.63190936]
curr_Stock_Price:  97.84847242298292
curr_Factors:  [97.84847242 -0.84148351 -1.01933432]
mat_Sqrt:  [[15.21987668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.97421011e-04 -6.43563220e-02 -7.80178622e-01]
Stock Position:  -0.0003974210109285786
Bond Position:  [3.6707964]


portfolio before change:  [3.63218775]
curr_Stock_Price:  98.30263374841263
curr_Factors:  [98.30263375 -0.67817985 -1.03103017]
mat_Sqrt:  [[17.79363486  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00096058 -0.05998662 -0.07816131]
Stock Position:  0.0009605834285500393
Bond Position:  [3.53775986]


portfolio before change:  [3.63259419]
curr_Stock_Price:  98.26536534738189
curr_Factors:  [98.26536535 -0.53827993 -1.0392045 ]
mat_Sqrt:  [[20.291198    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00543546  0.05516587 -0.05304149]
Stock Position:  0.0054354601732519055
Bond Position:  [3.09847671]


portfolio before change:  [3.6342228]
curr_Stock_Price:  98.4937307769582
curr_Factors:  [98.49373078 -0.37043608 -1.03784791]
mat_Sqrt:  [[24.08788235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01044479  0.00124271 -0.21400443]
Stock Position:  -0.010444792238364576
Bond Position:  [4.66296935]


portfolio before change:  [3.63150866]
curr_Stock_Price:  98.8093948469949
curr_Factors:  [98.80939485 -0.18564256 -1.03889455]
mat_Sqrt:  [[29.03945979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00329949 -0.00972517  0.0197108 ]
Stock Position:  0.0032994896068888153
Bond Position:  [3.30548809]


portfolio before change:  [3.6373414]
curr_Stock_Price:  100.45193009184108
curr_Factors:  [100.45193009  -0.28323446  -1.02242479]
mat_Sqrt:  [[27.22185273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00260692 -0.11692765  0.38987828]
Stock Position:  0.00260691553490427
Bond Position:  [3.3754717]


portfolio before change:  [3.62915487]
curr_Stock_Price:  97.14975458558632
curr_Factors:  [97.14975459 -0.20028694 -1.02299432]
mat_Sqrt:  [[28.58758073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00651477 -0.033463   -0.66063119]
Stock Position:  -0.0065147717432179324
Bond Position:  [4.26206334]


portfolio before change:  [3.64451022]
curr_Stock_Price:  94.87453074896817
curr_Factors:  [94.87453075 -0.43835652 -1.02608135]
mat_Sqrt:  [[21.93574315  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01041429 -0.12628952 -0.4319536 ]
Stock Position:  0.01041429043220999
Bond Position:  [2.65645931]


portfolio before change:  [3.64212759]
curr_Stock_Price:  94.61385859978789
curr_Factors:  [94.6138586  -0.44384394 -1.02930493]
mat_Sqrt:  [[21.68574402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136972 -0.04937006 -0.25257155]
Stock Position:  -0.0013697172230120928
Bond Position:  [3.77172182]


portfolio before change:  [3.64045911]
curr_Stock_Price:  96.17620095656233
curr_Factors:  [96.17620096 -0.46043258 -1.05316624]
mat_Sqrt:  [[21.16995822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0065998   0.09853767  0.64655601]
Stock Position:  -0.0065998036648643515
Bond Position:  [4.27520316]


portfolio before change:  [3.62822419]
curr_Stock_Price:  98.11100963956413
curr_Factors:  [98.11100964 -0.55250899 -1.03241449]
mat_Sqrt:  [[20.10917353  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023463 -0.06490983 -0.12387821]
Stock Position:  -0.00023462984640641504
Bond Position:  [3.65124396]


portfolio before change:  [3.62893342]
curr_Stock_Price:  97.03359531800137
curr_Factors:  [97.03359532 -0.39170865 -1.03798802]
mat_Sqrt:  [[23.22804984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00579146 -0.08889351  0.00066199]
Stock Position:  -0.0057914598277753315
Bond Position:  [4.19089959]


portfolio before change:  [3.63357224]
curr_Stock_Price:  96.32307886790377
curr_Factors:  [96.32307887 -0.37537047 -1.0464715 ]
mat_Sqrt:  [[23.23979184  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01234403 -0.04114601 -0.12852238]
Stock Position:  -0.012344032403450044
Bond Position:  [4.82258745]


portfolio before change:  [3.63529893]
curr_Stock_Price:  96.23203631201
curr_Factors:  [96.23203631 -0.48166752 -1.07803985]
mat_Sqrt:  [[20.22774036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01559608 0.35534397 0.61228531]
Stock Position:  0.015596077991387158
Bond Position:  [2.13445659]


portfolio before change:  [3.64719474]
curr_Stock_Price:  96.97767158027558
curr_Factors:  [96.97767158 -0.4017008  -1.06545781]
mat_Sqrt:  [[22.3610845   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0117676  -0.01490549  0.69160231]
Stock Position:  -0.011767602484860622
Bond Position:  [4.78838943]


portfolio before change:  [3.63212796]
curr_Stock_Price:  98.30890010252298
curr_Factors:  [98.3089001  -0.34761049 -1.0726059 ]
mat_Sqrt:  [[23.75749771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00397514  0.10904332 -0.07939169]
Stock Position:  -0.003975136763074123
Bond Position:  [4.02291928]


portfolio before change:  [3.62860882]
curr_Stock_Price:  99.3206993792686
curr_Factors:  [99.32069938 -0.33755816 -1.07452982]
mat_Sqrt:  [[24.19790419  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110991  0.01253788 -0.03647322]
Stock Position:  -0.0011099147592686705
Bond Position:  [3.73884633]


portfolio before change:  [3.6300513]
curr_Stock_Price:  98.44216655029517
curr_Factors:  [98.44216655 -0.53521945 -1.11021229]
mat_Sqrt:  [[18.99237338  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00089896 -0.00850491 -0.07558959]
Stock Position:  -0.0008989616286822328
Bond Position:  [3.71854703]


portfolio before change:  [3.63093376]
curr_Stock_Price:  97.97761162407953
curr_Factors:  [97.97761162 -0.4280625  -1.12850063]
mat_Sqrt:  [[20.65951266  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00217424 0.02512766 0.34489802]
Stock Position:  0.0021742360218173075
Bond Position:  [3.41790731]


portfolio before change:  [3.629665]
curr_Stock_Price:  97.19755648567848
curr_Factors:  [97.19755649 -0.45998627 -1.12401698]
mat_Sqrt:  [[19.94029018  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508527  0.03203341  0.11324511]
Stock Position:  -0.005085267608443442
Bond Position:  [4.12394059]


portfolio before change:  [3.62808769]
curr_Stock_Price:  97.60910547118108
curr_Factors:  [97.60910547 -0.70920034 -1.13748976]
mat_Sqrt:  [[15.39866296  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00667638 -0.01864412 -0.11959281]
Stock Position:  0.006676377640582831
Bond Position:  [2.97641244]


portfolio before change:  [3.62640334]
curr_Stock_Price:  97.30109033592373
curr_Factors:  [97.30109034 -0.64971502 -1.1279814 ]
mat_Sqrt:  [[16.44651778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00356359 -0.02053827  0.32821999]
Stock Position:  0.0035635880228880343
Bond Position:  [3.27966234]


portfolio before change:  [3.62895622]
curr_Stock_Price:  97.9024201948326
curr_Factors:  [97.90242019 -0.62042954 -1.11786497]
mat_Sqrt:  [[17.21320396  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00099044  0.01356018  0.08146979]
Stock Position:  -0.0009904415313608409
Bond Position:  [3.72592284]


portfolio before change:  [3.62876921]
curr_Stock_Price:  98.56149468002702
curr_Factors:  [98.56149468 -0.73049658 -1.11363299]
mat_Sqrt:  [[15.58877479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04512745  0.01597946 -2.11199055]
Stock Position:  -0.04512745434513881
Bond Position:  [8.07659856]


portfolio before change:  [3.61582785]
curr_Stock_Price:  98.8706412193524
curr_Factors:  [98.87064122 -0.60915513 -1.12328527]
mat_Sqrt:  [[17.48549958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203466 -0.03561535 -0.09696367]
Stock Position:  -0.0020346563665080038
Bond Position:  [3.81699563]


portfolio before change:  [3.61693343]
curr_Stock_Price:  98.56178040052897
curr_Factors:  [98.5617804  -0.34415928 -1.10677361]
mat_Sqrt:  [[23.09810717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00298204 0.0133331  0.13103948]
Stock Position:  0.0029820419712368587
Bond Position:  [3.32301807]


portfolio before change:  [3.6191308]
curr_Stock_Price:  99.15934607563467
curr_Factors:  [99.15934608 -0.31307313 -1.09026445]
mat_Sqrt:  [[24.3709179   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00075977  0.02751597 -0.01898093]
Stock Position:  0.0007597671736119361
Bond Position:  [3.54379279]


portfolio before change:  [3.62085087]
curr_Stock_Price:  100.84021332303867
curr_Factors:  [100.84021332  -0.53820891  -1.08560577]
mat_Sqrt:  [[19.88016568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00825598 -0.00536654 -0.38066462]
Stock Position:  -0.008255977199959305
Bond Position:  [4.45338537]


portfolio before change:  [3.63360106]
curr_Stock_Price:  99.36328554284891
curr_Factors:  [99.36328554 -0.56646134 -1.08371643]
mat_Sqrt:  [[19.07931796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00274715  0.0049611   0.16678008]
Stock Position:  -0.0027471476534294773
Bond Position:  [3.90656668]


portfolio before change:  [3.63713638]
curr_Stock_Price:  98.2541483367776
curr_Factors:  [98.25414834 -0.30425641 -1.07874167]
mat_Sqrt:  [[24.64463911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213006  0.02253304  0.38819643]
Stock Position:  -0.002130062203559209
Bond Position:  [3.84642382]


portfolio before change:  [3.6369887]
curr_Stock_Price:  98.54921584279124
curr_Factors:  [98.54921584 -0.42099892 -1.0472765 ]
mat_Sqrt:  [[22.69808706  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098549 -0.01556366  0.1530845 ]
Stock Position:  -0.0009854929996790686
Bond Position:  [3.73410826]


portfolio before change:  [3.63891324]
curr_Stock_Price:  97.07000885600017
curr_Factors:  [97.07000886 -0.73674433 -1.04227444]
mat_Sqrt:  [[16.38577679  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00533978 0.02074821 0.03622831]
Stock Position:  0.005339784046392603
Bond Position:  [3.12058035]


portfolio before change:  [3.6412592]
curr_Stock_Price:  97.43629045600754
curr_Factors:  [97.43629046 -0.72409411 -1.03336753]
mat_Sqrt:  [[16.80601896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00655338  0.05003724  0.02078294]
Stock Position:  -0.006553383199703031
Bond Position:  [4.27979655]


portfolio before change:  [3.63481078]
curr_Stock_Price:  98.50191199914025
curr_Factors:  [98.501912   -0.65904923 -1.04354532]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.63481078]
Stock Price:  97.14524791715817
PL:  [3.63481078]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.31215320e-01  2.91130907e-02  1.80810865e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.88395365e-01  2.72258155e-01  3.60668911e-01]
 [ 4.86172823e-03  5.61251932e-03  1.23359149e-01]
 [-2.74081251e-01 -9.07856709e-02  4.59557486e-02]
 [ 3.84434241e-03 -1.11742605e-01 -1.37721011e-01]
 [ 3.49403860e-02  3.20567237e-02 -1.65615318e-02]
 [ 2.03592151e-01  2.23258942e-02 -3.87787563e-02]
 [-4.63776813e-01 -2.69912873e-02 -4.59893550e-02]
 [ 5.01213712e-02 -2.19189437e-02 -4.35734662e-02]
 [ 3.24073642e-02 -3.23544934e-01  1.29555434e-01]
 [-9.97935148e-03 -2.13237630e-03  1.32003615e-02]
 [ 1.95246865e-01 -1.88921499e-01  9.45165614e-02]
 [ 8.26504356e-02 -6.94240645e-02 -5.35808149e-02]
 [-7.10010977e-02  2.26859719e-02  3.50313574e-02]
 [-4.62684984e-02  5.30236950e-02  3.97573553e-02]
 [-3.18586150e-01 -1.93081375e-01  6.32889261e-02]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 1.49410467e-01  8.09461885e-01  1.41738750e-01]
 [-2.85441589e-01 -4.38456037e-02  1.77961358e-01]
 [-9.70262769e-02  3.24208885e-01 -2.87968523e-02]
 [-5.04621798e-02  2.61080645e-02 -1.55827352e-02]
 [-3.20864611e-02 -2.48667487e-02 -4.66701549e-02]
 [-5.35569721e-03 -1.05262669e-01  1.03909631e-01]
 [-1.19324096e-01  1.20107876e-01  9.46850803e-02]
 [ 8.15761047e-02 -1.43165141e-01 -1.76167482e-01]
 [ 6.88192199e-02 -2.64966590e-02  1.05616080e-01]
 [-8.87758143e-02  4.38259466e-02  8.96363269e-02]
 [-4.60353004e-01 -3.22862957e-02 -6.90724689e-01]
 [ 1.71657730e-01 -1.18535363e-01 -1.46770548e-01]
 [ 1.34472461e-01  6.39171333e-03 -3.73508973e-02]
 [ 3.22376175e-02  1.76235370e-01 -4.91412819e-02]
 [-9.96521606e-02  2.86704802e-02 -1.34262916e-01]
 [-5.61285919e-02  1.48919899e-01  9.92945270e-02]
 [-1.84237171e-01  8.88108624e-02  7.58747464e-02]
 [-1.27230342e-01 -9.65679484e-02  5.81216870e-04]
 [ 1.64353314e-01  1.40360014e-01  5.81196648e-02]
 [-1.11612625e-01  2.87642052e-01  2.90384061e-02]
 [ 7.87976932e-04 -1.62283542e-01  4.42703356e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.19319657]
curr_Stock_Price:  99.694231808401
curr_Factors:  [99.69423181 -0.85177173 -1.00348732]
mat_Sqrt:  [[15.5934158   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01241266  0.00920637  0.51580307]
Stock Position:  -0.012412659450089835
Bond Position:  [1.43066712]


portfolio before change:  [0.19390402]
curr_Stock_Price:  99.6516456615242
curr_Factors:  [99.65164566 -0.74066287 -0.98467391]
mat_Sqrt:  [[17.74925932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255679  0.01411938  0.0859571 ]
Stock Position:  -0.0025567851601698962
Bond Position:  [0.44869187]


portfolio before change:  [0.19343897]
curr_Stock_Price:  99.85547468189941
curr_Factors:  [99.85547468 -0.79096371 -0.98389951]
mat_Sqrt:  [[16.92616526  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0218033  0.08609559 1.02888801]
Stock Position:  0.02180330087621937
Bond Position:  [-1.98373999]


portfolio before change:  [0.15713026]
curr_Stock_Price:  98.20156337371114
curr_Factors:  [98.20156337 -0.55418079 -0.99847387]
mat_Sqrt:  [[20.78782504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00145216 0.00177483 0.35190932]
Stock Position:  0.0014521588345917217
Bond Position:  [0.01452599]


portfolio before change:  [0.15840364]
curr_Stock_Price:  99.07720121414161
curr_Factors:  [99.07720121 -0.63436212 -0.98058543]
mat_Sqrt:  [[19.70656464  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01355105 -0.02870895  0.13109896]
Stock Position:  -0.013551050303676353
Bond Position:  [1.50100378]


portfolio before change:  [0.1504493]
curr_Stock_Price:  99.67803874067485
curr_Factors:  [99.67803874 -0.6294161  -0.98198679]
mat_Sqrt:  [[19.89647325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136472 -0.03533611 -0.39287971]
Stock Position:  -0.0013647153751097513
Bond Position:  [0.28648145]


portfolio before change:  [0.14967121]
curr_Stock_Price:  100.27442476345897
curr_Factors:  [100.27442476  -0.78129844  -0.99313643]
mat_Sqrt:  [[17.00446239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00190465  0.01013723 -0.04724544]
Stock Position:  0.001904645841426301
Bond Position:  [-0.04131605]


portfolio before change:  [0.14845321]
curr_Stock_Price:  99.63764530199815
curr_Factors:  [99.6376453  -0.68105161 -1.01004309]
mat_Sqrt:  [[18.36497587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01068626  0.00706007 -0.110625  ]
Stock Position:  0.010686260830257154
Bond Position:  [-0.91630066]


portfolio before change:  [0.15680891]
curr_Stock_Price:  100.43027487417584
curr_Factors:  [100.43027487  -0.76150068  -1.0290576 ]
mat_Sqrt:  [[16.7584972   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02827588 -0.00853539 -0.13119483]
Stock Position:  -0.028275880427108553
Bond Position:  [2.99656335]


portfolio before change:  [0.15608978]
curr_Stock_Price:  100.4689551705669
curr_Factors:  [100.46895517  -0.80007448  -1.01895417]
mat_Sqrt:  [[16.29437776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024954  -0.00693138 -0.12430297]
Stock Position:  0.0024954024350342043
Bond Position:  [-0.09462069]


portfolio before change:  [0.15663207]
curr_Stock_Price:  100.6910115169351
curr_Factors:  [100.69101152  -0.57050398  -1.0277141 ]
mat_Sqrt:  [[20.36542182  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00247964 -0.10231389  0.36958559]
Stock Position:  0.002479637428610406
Bond Position:  [-0.09304513]


portfolio before change:  [0.15489813]
curr_Stock_Price:  99.99643021780584
curr_Factors:  [99.99643022 -0.52309588 -1.03418493]
mat_Sqrt:  [[21.07007277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034836 -0.00067432  0.03765696]
Stock Position:  -0.0003483564952474899
Bond Position:  [0.18973254]


portfolio before change:  [0.15540903]
curr_Stock_Price:  98.59792209271073
curr_Factors:  [98.59792209 -0.55010331 -1.05887463]
mat_Sqrt:  [[19.72865701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01062728 -0.05974222  0.26962944]
Stock Position:  0.010627284196421387
Bond Position:  [-0.89241911]


portfolio before change:  [0.15477778]
curr_Stock_Price:  98.54902070431902
curr_Factors:  [98.5490207  -0.36973391 -1.05381911]
mat_Sqrt:  [[23.73619449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00294574 -0.02195382 -0.15285115]
Stock Position:  0.0029457449874167583
Bond Position:  [-0.1355225]


portfolio before change:  [0.15666148]
curr_Stock_Price:  99.19423668371675
curr_Factors:  [99.19423668 -0.23195738 -1.07242358]
mat_Sqrt:  [[26.91540925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023505   0.00717393  0.09993471]
Stock Position:  -0.0023504975125465764
Bond Position:  [0.38981729]


portfolio before change:  [0.1515093]
curr_Stock_Price:  101.40692377317043
curr_Factors:  [101.40692377  -0.22781867  -1.05181083]
mat_Sqrt:  [[28.20535561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00130415  0.01676756  0.11341667]
Stock Position:  -0.0013041493543746105
Bond Position:  [0.28375907]


portfolio before change:  [0.15259607]
curr_Stock_Price:  100.60080494141593
curr_Factors:  [ 1.00600805e+02  2.32137763e-02 -1.05743085e+00]
mat_Sqrt:  [[35.76404966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00868617 -0.06105769  0.18054569]
Stock Position:  -0.008686172126993297
Bond Position:  [1.02643198]


portfolio before change:  [0.13225132]
curr_Stock_Price:  102.95777670952
curr_Factors:  [ 1.02957777e+02  6.42784638e-02 -1.05750989e+00]
mat_Sqrt:  [[38.13328588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344348  0.00580111 -0.05715682]
Stock Position:  -0.003443476761346088
Bond Position:  [0.48678403]


portfolio before change:  [0.13550204]
curr_Stock_Price:  102.0314258413235
curr_Factors:  [102.03142584   0.23019554  -1.04983416]
mat_Sqrt:  [[44.95411226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00443214 0.25597432 0.4043412 ]
Stock Position:  0.004432141447169464
Bond Position:  [-0.31671567]


portfolio before change:  [0.12287096]
curr_Stock_Price:  99.1904762822494
curr_Factors:  [99.19047628  0.1851971  -1.07071676]
mat_Sqrt:  [[40.91604749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00611612 -0.0138652   0.50767422]
Stock Position:  -0.006116120274187694
Bond Position:  [0.72953184]


portfolio before change:  [0.14151668]
curr_Stock_Price:  96.15676804332577
curr_Factors:  [96.15676804  0.31669337 -1.06211225]
mat_Sqrt:  [[45.62979865  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207175  0.10252385 -0.0821494 ]
Stock Position:  -0.0020717464267378314
Bond Position:  [0.34072912]


portfolio before change:  [0.13590573]
curr_Stock_Price:  98.88564393541307
curr_Factors:  [98.88564394  0.15261101 -1.0853818 ]
mat_Sqrt:  [[38.90774312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013614   0.00825609 -0.04445321]
Stock Position:  -0.0013613970064094644
Bond Position:  [0.27052835]


portfolio before change:  [0.13740371]
curr_Stock_Price:  97.81016210027762
curr_Factors:  [ 9.78101621e+01 -7.61131822e-02 -1.07523560e+00]
mat_Sqrt:  [[30.92854958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136621 -0.00786356 -0.13313696]
Stock Position:  -0.0013662141884216359
Bond Position:  [0.27103334]


portfolio before change:  [0.13946741]
curr_Stock_Price:  96.32443861747957
curr_Factors:  [96.32443862 -0.17829639 -1.05902755]
mat_Sqrt:  [[27.94946679  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047002 -0.03328698  0.29642526]
Stock Position:  0.0004700231724545733
Bond Position:  [0.09419269]


portfolio before change:  [0.13889119]
curr_Stock_Price:  95.07345025379186
curr_Factors:  [95.07345025 -0.14399388 -1.07454452]
mat_Sqrt:  [[28.10960549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344706  0.03798145  0.27011018]
Stock Position:  -0.0034470570310185943
Bond Position:  [0.46661479]


portfolio before change:  [0.13945095]
curr_Stock_Price:  94.9279832342869
curr_Factors:  [94.92798323 -0.43013337 -1.08726101]
mat_Sqrt:  [[20.81604652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00201381 -0.04527279 -0.50255679]
Stock Position:  0.0020138098704442484
Bond Position:  [-0.05171596]


portfolio before change:  [0.13986286]
curr_Stock_Price:  95.13573694472309
curr_Factors:  [95.13573694 -0.70137991 -1.09665846]
mat_Sqrt:  [[15.75671003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00569242 -0.00837898  0.30129328]
Stock Position:  0.005692423794824034
Bond Position:  [-0.40169007]


portfolio before change:  [0.14356351]
curr_Stock_Price:  95.7946578427325
curr_Factors:  [95.79465784 -0.52523665 -1.09459359]
mat_Sqrt:  [[18.96085676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365739  0.01385898  0.25570749]
Stock Position:  -0.0036573924604690936
Bond Position:  [0.49392216]


portfolio before change:  [0.14369752]
curr_Stock_Price:  95.77489839776644
curr_Factors:  [95.7748984  -0.35930202 -1.10776899]
mat_Sqrt:  [[22.08568412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02726564 -0.01020982 -1.97044528]
Stock Position:  -0.027265635801390443
Bond Position:  [2.75506102]


portfolio before change:  [0.13135136]
curr_Stock_Price:  96.2403400556621
curr_Factors:  [96.24034006 -0.50847224 -1.12123182]
mat_Sqrt:  [[18.86191016  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00735014 -0.03748417 -0.41869552]
Stock Position:  0.007350143558761423
Bond Position:  [-0.57602896]


portfolio before change:  [0.12811387]
curr_Stock_Price:  95.80967070420319
curr_Factors:  [95.8096707  -0.6519599  -1.12258426]
mat_Sqrt:  [[16.24555712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00781834  0.00202124 -0.10655171]
Stock Position:  0.007818339076232235
Bond Position:  [-0.62095862]


portfolio before change:  [0.12589597]
curr_Stock_Price:  95.53592047672572
curr_Factors:  [95.53592048 -0.36253236 -1.09587697]
mat_Sqrt:  [[22.22222636  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120407  0.05573052 -0.1401864 ]
Stock Position:  0.001204068064087517
Bond Position:  [0.01086422]


portfolio before change:  [0.12457397]
curr_Stock_Price:  94.43684721811826
curr_Factors:  [94.43684722 -0.55255821 -1.08129145]
mat_Sqrt:  [[18.43187795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00685325  0.0090664  -0.38301473]
Stock Position:  -0.006853246062971562
Bond Position:  [0.77177292]


portfolio before change:  [0.11590863]
curr_Stock_Price:  95.71533856891232
curr_Factors:  [95.71533857 -0.47001193 -1.09015498]
mat_Sqrt:  [[20.10988831  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00159201  0.04709261  0.28325965]
Stock Position:  -0.0015920071590936596
Bond Position:  [0.26828814]


portfolio before change:  [0.11642616]
curr_Stock_Price:  95.41132549227369
curr_Factors:  [95.41132549 -0.44040595 -1.09055819]
mat_Sqrt:  [[20.64004562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00806472  0.02808446  0.21644953]
Stock Position:  -0.00806472136095325
Bond Position:  [0.88589192]


portfolio before change:  [0.11799431]
curr_Stock_Price:  95.23061172976365
curr_Factors:  [95.23061173 -0.25139012 -1.10116662]
mat_Sqrt:  [[24.62456947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00526324 -0.03053747  0.00165805]
Stock Position:  -0.0052632422799629075
Bond Position:  [0.61921609]


portfolio before change:  [0.12214221]
curr_Stock_Price:  94.45723166181602
curr_Factors:  [94.45723166 -0.47403344 -1.11927695]
mat_Sqrt:  [[19.19858868  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00936741 0.04438573 0.16579923]
Stock Position:  0.009367408375252111
Bond Position:  [-0.76267726]


portfolio before change:  [0.10926653]
curr_Stock_Price:  93.09289146181524
curr_Factors:  [93.09289146 -0.20358319 -1.11528915]
mat_Sqrt:  [[24.89645649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00394668  0.0909604   0.08283849]
Stock Position:  -0.003946678071864926
Bond Position:  [0.47667421]


portfolio before change:  [0.11770985]
curr_Stock_Price:  90.96864072959424
curr_Factors:  [90.96864073 -0.19146331 -1.13007319]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.11770985]
Stock Price:  92.26058804406578
PL:  [0.11770985]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-4.04890949e-02  1.01157083e-01  4.45343174e-02]
 [-1.17835368e-03 -3.69220050e-02 -1.15250285e-01]
 [ 2.62582620e-01  1.88679153e-01  2.41604522e-01]
 [-4.51469563e-03  3.80986463e-02  1.30248530e-01]
 [-7.90381386e-01 -2.37033723e-01  3.33386996e-02]
 [-2.08426551e-02 -6.43891578e-02 -6.59089186e-02]
 [ 3.32799236e-02 -2.45185253e-02 -2.82043963e-02]
 [ 2.80821672e-01 -9.00470179e-02 -5.66220296e-02]
 [-4.50264721e-01 -2.39324857e-02 -5.28571665e-02]
 [ 4.41862170e-02 -1.18357549e-02 -3.88485441e-02]
 [ 3.52751703e-06 -2.23470679e-01  6.40568003e-02]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.47298013e-01 -6.78324134e-02  2.65197464e-01]
 [ 6.38234680e-02  9.60269667e-02  4.80487554e-02]
 [ 7.27531557e-02 -1.13100894e-01 -5.17068268e-02]
 [-2.09899501e-02  5.24376255e-03  3.81819038e-02]
 [-5.67359673e-01 -2.88424275e-01  1.67747030e-01]
 [-1.22052512e-01  1.87112900e-02 -2.47335904e-02]
 [ 3.52638857e-01  1.35048890e+00  5.99626601e-01]
 [ 7.03850255e-03  1.40317910e-02  3.01661345e-02]
 [-7.66044530e-02  4.17799791e-03 -3.82667902e-02]
 [ 3.13766068e-02  2.66346521e-02  1.01944063e-02]
 [ 3.27400759e-02 -3.15525937e-02  4.99635633e-02]
 [ 4.93936745e-02  6.80969379e-02  5.69954390e-02]
 [-5.91341149e-02 -1.44243931e-01 -1.40888209e-03]
 [ 6.65232931e-02  2.84270771e-02 -1.59547703e-02]
 [-1.37367460e-02 -4.53530837e-03 -4.55093986e-02]
 [ 5.47715814e-03  4.18455706e-02 -5.31583202e-02]
 [-5.86916377e-01  1.20199735e-02 -8.24998271e-01]
 [-1.59383010e-01 -3.12800101e-02  1.00859277e-02]
 [-4.07317438e-02  5.50604710e-02  1.51734429e-01]
 [ 1.00672008e-02  1.92704051e-02  2.64305274e-02]
 [-1.34261769e-01 -6.69284623e-03 -1.39252508e-01]
 [-6.76324952e-02 -5.32671706e-02  1.47313305e-02]
 [ 1.83535919e-01 -1.65159969e-01 -8.95714274e-02]
 [-4.55536891e-03  1.17524510e-01  7.89518456e-02]
 [ 5.35059508e-03  5.50457654e-03 -4.62934503e-02]
 [-7.62820653e-02  5.06168918e-02 -3.44512887e-03]
 [-6.39129643e-02 -2.57234260e-01  1.07379344e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.65777927]
curr_Stock_Price:  101.15226175768883
curr_Factors:  [101.15226176  -0.97772699  -1.0158693 ]
mat_Sqrt:  [[13.77741477  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208941  0.03198868  0.12704401]
Stock Position:  -0.002089412367326673
Bond Position:  [10.86912805]


portfolio before change:  [10.65865147]
curr_Stock_Price:  101.38511152821927
curr_Factors:  [101.38511153  -0.99422502  -1.03306484]
mat_Sqrt:  [[13.35160227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192165 -0.01167576 -0.32877698]
Stock Position:  -0.001921645136752843
Bond Position:  [10.85347768]


portfolio before change:  [10.66236317]
curr_Stock_Price:  100.15963603028982
curr_Factors:  [100.15963603  -0.94836813  -1.00365537]
mat_Sqrt:  [[14.22131331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02227443 0.05966559 0.68923045]
Stock Position:  0.022274427390327145
Bond Position:  [8.43136463]


portfolio before change:  [10.65431186]
curr_Stock_Price:  99.75085775588796
curr_Factors:  [99.75085776 -0.8747337  -1.01107394]
mat_Sqrt:  [[15.13285202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00152356 0.01204785 0.3715628 ]
Stock Position:  0.0015235645616651647
Bond Position:  [10.50233499]


portfolio before change:  [10.65623513]
curr_Stock_Price:  100.1514945445952
curr_Factors:  [100.15149454  -1.08626441  -1.05816165]
mat_Sqrt:  [[11.73126996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0673155  -0.07495664  0.09510603]
Stock Position:  -0.06731550294779236
Bond Position:  [17.39798335]


portfolio before change:  [10.66735963]
curr_Stock_Price:  100.0185442219212
curr_Factors:  [100.01854422  -1.03727817  -1.05752391]
mat_Sqrt:  [[12.31174318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00292069 -0.02036164 -0.1880198 ]
Stock Position:  -0.002920689387380807
Bond Position:  [10.95948273]


portfolio before change:  [10.66970455]
curr_Stock_Price:  99.68475466489606
curr_Factors:  [99.68475466 -1.06624702 -1.08568214]
mat_Sqrt:  [[11.58931549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00232021 -0.00775344 -0.08045929]
Stock Position:  0.0023202112061470855
Bond Position:  [10.43841486]


portfolio before change:  [10.67382637]
curr_Stock_Price:  100.89884108497914
curr_Factors:  [100.89884108  -0.890685    -1.09822653]
mat_Sqrt:  [[13.80743085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01933298 -0.02847537 -0.16152689]
Stock Position:  0.019332977140595686
Bond Position:  [8.72315138]


portfolio before change:  [10.65887629]
curr_Stock_Price:  100.06914267176381
curr_Factors:  [100.06914267  -0.67018084  -1.09846226]
mat_Sqrt:  [[17.06822019  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02704864 -0.00756812 -0.15078678]
Stock Position:  -0.027048636211505196
Bond Position:  [13.36561012]


portfolio before change:  [10.66665345]
curr_Stock_Price:  99.84338796257774
curr_Factors:  [99.84338796 -1.12071418 -1.0835773 ]
mat_Sqrt:  [[11.01558802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00326362 -0.00374279 -0.11082408]
Stock Position:  0.00326361999504327
Bond Position:  [10.34080257]


portfolio before change:  [10.66931614]
curr_Stock_Price:  100.26316986659131
curr_Factors:  [100.26316987  -1.26611637  -1.10656013]
mat_Sqrt:  [[ 9.34762151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078192 -0.07066763  0.18273622]
Stock Position:  0.0007819185856177274
Bond Position:  [10.5909185]


portfolio before change:  [10.6708302]
curr_Stock_Price:  100.5063028536129
curr_Factors:  [100.50630285  -1.38257618  -1.1132758 ]
mat_Sqrt:  [[ 8.28435223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00870625  0.00225658  0.15019092]
Stock Position:  -0.008706247217967727
Bond Position:  [11.54586292]


portfolio before change:  [10.66651066]
curr_Stock_Price:  101.16822581486883
curr_Factors:  [101.16822581  -1.36491972  -1.1041413 ]
mat_Sqrt:  [[ 8.565339    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02331254 -0.02145049  0.75653455]
Stock Position:  0.023312538222536414
Bond Position:  [8.30802252]


portfolio before change:  [10.66298516]
curr_Stock_Price:  100.97244839463713
curr_Factors:  [100.97244839  -1.51687128  -1.09007159]
mat_Sqrt:  [[ 7.44769674  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01021937 0.03036639 0.13706972]
Stock Position:  0.01021937216661724
Bond Position:  [9.63111013]


portfolio before change:  [10.66676222]
curr_Stock_Price:  101.22423499645471
curr_Factors:  [101.224235    -1.77311132  -1.10554322]
mat_Sqrt:  [[ 5.68984873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01041825 -0.03576564 -0.14750518]
Stock Position:  0.010418254358187736
Bond Position:  [9.61218239]


portfolio before change:  [10.66532749]
curr_Stock_Price:  100.9711860856224
curr_Factors:  [100.97118609  -1.65363378  -1.0948312 ]
mat_Sqrt:  [[ 6.46478795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202028  0.00165822  0.10892234]
Stock Position:  -0.0020202840922958674
Bond Position:  [10.86931797]


portfolio before change:  [10.6659981]
curr_Stock_Price:  101.31180029265438
curr_Factors:  [101.31180029  -1.68434647  -1.07140154]
mat_Sqrt:  [[ 6.43952566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08394493 -0.09120776  0.47853558]
Stock Position:  -0.08394493095393689
Bond Position:  [19.17061018]


portfolio before change:  [10.66871971]
curr_Stock_Price:  101.30792710128397
curr_Factors:  [101.3079271   -1.50553296  -1.08633145]
mat_Sqrt:  [[ 7.58596815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01669109  0.00591703 -0.07055805]
Stock Position:  -0.016691094535146105
Bond Position:  [12.3596599]


portfolio before change:  [10.67709135]
curr_Stock_Price:  100.89893132970101
curr_Factors:  [100.89893133  -1.44535071  -1.06142347]
mat_Sqrt:  [[ 8.22637255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06198438 0.42706209 1.71056779]
Stock Position:  0.06198437950961763
Bond Position:  [4.4229337]


portfolio before change:  [10.65664377]
curr_Stock_Price:  100.56012849521693
curr_Factors:  [100.5601285   -1.53497963  -1.06127239]
mat_Sqrt:  [[ 7.49700662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00180851 0.00443724 0.08605559]
Stock Position:  0.0018085135775803085
Bond Position:  [10.47477941]


portfolio before change:  [10.65790503]
curr_Stock_Price:  100.53349178749006
curr_Factors:  [100.53349179  -1.2838566   -1.07548906]
mat_Sqrt:  [[ 9.49860807  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0088758  0.0013212 -0.1091645]
Stock Position:  -0.008875800825731804
Bond Position:  [11.55022028]


portfolio before change:  [10.65690783]
curr_Stock_Price:  100.80851634919813
curr_Factors:  [100.80851635  -1.83751283  -1.076481  ]
mat_Sqrt:  [[ 5.46972868  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00624258 0.00842262 0.0290818 ]
Stock Position:  0.006242582951240605
Bond Position:  [10.02760231]


portfolio before change:  [10.65726618]
curr_Stock_Price:  100.66511691440358
curr_Factors:  [100.66511691  -1.59727618  -1.09006711]
mat_Sqrt:  [[ 6.85142078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00614824 -0.00997781  0.14253214]
Stock Position:  0.0061482373435323475
Bond Position:  [10.03835315]


portfolio before change:  [10.66040315]
curr_Stock_Price:  100.97123719899055
curr_Factors:  [100.9712372   -1.7476838   -1.11458814]
mat_Sqrt:  [[ 5.76937498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01088265 0.02153414 0.16259212]
Stock Position:  0.010882647669123115
Bond Position:  [9.56156875]


portfolio before change:  [10.65859384]
curr_Stock_Price:  100.69514819872046
curr_Factors:  [100.6951482   -1.58149622  -1.10313023]
mat_Sqrt:  [[ 6.87210983  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00918874 -0.04561394 -0.00401915]
Stock Position:  -0.009188744885877531
Bond Position:  [11.58385587]


portfolio before change:  [10.6619248]
curr_Stock_Price:  100.49023585724161
curr_Factors:  [100.49023586  -1.48565157  -1.08468256]
mat_Sqrt:  [[ 7.6885056   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00832418  0.00898943 -0.04551452]
Stock Position:  0.00832418242416176
Bond Position:  [9.82542575]


portfolio before change:  [10.65994393]
curr_Stock_Price:  100.1047169231613
curr_Factors:  [100.10471692  -1.36946023  -1.06100651]
mat_Sqrt:  [[ 8.80878983  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262731 -0.00143419 -0.12982565]
Stock Position:  -0.0026273091655759223
Bond Position:  [10.92294997]


portfolio before change:  [10.66128634]
curr_Stock_Price:  100.11348892756524
curr_Factors:  [100.11348893  -1.16649502  -1.06341518]
mat_Sqrt:  [[10.76601309  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039878  0.01323273 -0.15164589]
Stock Position:  -0.00039878184438592274
Bond Position:  [10.70120978]


portfolio before change:  [10.66261108]
curr_Stock_Price:  100.1460548354724
curr_Factors:  [100.14605484  -1.00764219  -1.06195783]
mat_Sqrt:  [[12.64206377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0597219   0.00380105 -2.35349043]
Stock Position:  -0.0597219017003077
Bond Position:  [16.64352393]


portfolio before change:  [10.62888339]
curr_Stock_Price:  100.74563821235483
curr_Factors:  [100.74563821  -1.09129308  -1.05167386]
mat_Sqrt:  [[11.81809664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01338049 -0.00989161  0.02877234]
Stock Position:  -0.013380485825801711
Bond Position:  [11.97690898]


portfolio before change:  [10.61489721]
curr_Stock_Price:  101.9028002584085
curr_Factors:  [101.90280026  -1.20570729  -1.0460091 ]
mat_Sqrt:  [[10.72205704  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007776   0.01741165  0.43285609]
Stock Position:  -0.0007775959252319779
Bond Position:  [10.69413641]


portfolio before change:  [10.6160451]
curr_Stock_Price:  102.14581317478964
curr_Factors:  [102.14581317  -1.25031086  -1.06532058]
mat_Sqrt:  [[10.08218386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00158298 0.00609384 0.07539894]
Stock Position:  0.0015829774105255523
Bond Position:  [10.45435058]


portfolio before change:  [10.61882997]
curr_Stock_Price:  103.07949425921632
curr_Factors:  [103.07949426  -1.36226336  -1.0891583 ]
mat_Sqrt:  [[ 8.88246239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01833494 -0.00211646 -0.39724865]
Stock Position:  -0.018334935707276883
Bond Position:  [12.50878587]


portfolio before change:  [10.61114476]
curr_Stock_Price:  103.58393593569494
curr_Factors:  [103.58393594  -1.41510298  -1.11357055]
mat_Sqrt:  [[ 8.2623473   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00798814 -0.01684456  0.04202439]
Stock Position:  -0.007988144887233364
Bond Position:  [11.43858825]


portfolio before change:  [10.61088669]
curr_Stock_Price:  103.79524719413294
curr_Factors:  [103.79524719  -1.6154332   -1.10300045]
mat_Sqrt:  [[ 6.84820468  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02350803 -0.05222817 -0.25552235]
Stock Position:  0.023508032103670373
Bond Position:  [8.17086468]


portfolio before change:  [10.61444259]
curr_Stock_Price:  103.903060531854
curr_Factors:  [103.90306053  -1.59230525  -1.12587143]
mat_Sqrt:  [[ 6.8570798   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00212847 0.03716451 0.22522764]
Stock Position:  0.002128468579656877
Bond Position:  [10.39328819]


portfolio before change:  [10.61655417]
curr_Stock_Price:  104.28471640199884
curr_Factors:  [104.2847164   -1.59811978  -1.13960344]
mat_Sqrt:  [[ 6.74904897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058629  0.0017407  -0.13206233]
Stock Position:  -0.0005862882825755255
Bond Position:  [10.67769508]


portfolio before change:  [10.61809745]
curr_Stock_Price:  103.92912331660715
curr_Factors:  [103.92912332  -1.45259153  -1.11956626]
mat_Sqrt:  [[ 7.93712698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00953473  0.01600647 -0.00982799]
Stock Position:  -0.009534731770795227
Bond Position:  [11.60903376]


portfolio before change:  [10.6245511]
curr_Stock_Price:  103.40446936138298
curr_Factors:  [103.40446936  -1.43100638  -1.1219212 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.6245511]
Stock Price:  103.65203807546823
PL:  [6.97251303]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.15628126e-01  9.78416285e-03  4.78008240e-02]
 [-4.36797212e-03 -3.18705342e-02 -1.06247223e-01]
 [ 3.73355284e-01 -4.02901142e-02 -1.83408092e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-9.12879188e-01 -2.27997522e-01 -2.10708071e-01]
 [ 4.17959497e-02  1.04594013e-01  1.17201557e-01]
 [-6.00656287e-02  9.29697515e-03  1.53979955e-01]
 [ 2.95098530e-01 -2.93272807e-01 -3.89195347e-02]
 [-5.47048080e-01 -2.53468123e-02 -8.99603191e-02]
 [ 7.97341235e-03  4.96859069e-02 -1.00198600e-02]
 [-4.49155104e-03 -2.57888295e-01  1.96425102e-01]
 [-2.45702569e-01  4.03897961e-02  2.12358722e-01]
 [ 3.73383717e-02 -2.19506060e-03  2.19595452e-01]
 [ 4.72100868e-02  3.00774627e-01  2.59249302e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-4.11929930e-02  5.55296807e-02  4.59914265e-02]
 [-4.57657141e-01 -2.26407385e-01  1.19547298e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 1.83554275e-01  9.17446140e-01  1.91711976e-01]
 [-8.04627127e-02 -1.65702899e-02  7.54712274e-02]
 [-4.54605810e-02  8.69774229e-02  3.22485275e-03]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.09584583e-01 -4.11584583e-02  1.29007147e-01]
 [ 8.54919956e-02  2.27471472e-02 -2.87664018e-02]
 [-6.75127371e-02 -2.31185461e-01  1.01670085e-01]
 [ 1.37899518e-02  6.22312906e-02  9.70712121e-03]
 [ 4.33435617e-02 -6.42155393e-02  1.65163138e-01]
 [ 3.59083746e-02  4.53474937e-02 -6.86761614e-02]
 [-7.24839274e-01 -1.08258016e-01 -1.12978487e+00]
 [-2.10637312e-01 -1.01078303e-03  6.33894778e-02]
 [ 4.17960309e-02 -2.56703960e-02  1.00116229e-01]
 [ 2.77066677e-02  1.32097236e-01 -2.74928359e-02]
 [-1.22303718e-01 -1.06034607e-02 -7.58107162e-02]
 [-6.37435767e-02  3.98477996e-02  7.37855849e-02]
 [ 2.30903662e-01 -1.68337806e-01 -6.21161503e-02]
 [-7.83387307e-03  1.41046960e-01  7.97404968e-02]
 [ 4.81262827e-03  4.45787147e-03 -4.58581092e-02]
 [-4.74259577e-02  8.79098041e-02 -7.63015761e-03]
 [-6.84199315e-02 -2.40916650e-01  9.44774261e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.21853452]
curr_Stock_Price:  100.11575204142756
curr_Factors:  [100.11575204  -0.89749447  -1.01383885]
mat_Sqrt:  [[14.80542573  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00713375  0.00309402  0.13636245]
Stock Position:  -0.007133749443831512
Bond Position:  [3.93273521]


portfolio before change:  [3.21019744]
curr_Stock_Price:  101.35334843115793
curr_Factors:  [101.35334843  -0.80134776  -1.02514442]
mat_Sqrt:  [[16.31558409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164741 -0.01007835 -0.30309375]
Stock Position:  -0.0016474120208332926
Bond Position:  [3.37716817]


portfolio before change:  [3.20996545]
curr_Stock_Price:  101.75043212137206
curr_Factors:  [101.75043212  -0.6258504   -1.0345811 ]
mat_Sqrt:  [[19.33837693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01731671 -0.01274085 -0.52321223]
Stock Position:  0.017316705455865496
Bond Position:  [1.44798319]


portfolio before change:  [3.24274942]
curr_Stock_Price:  103.63317835290478
curr_Factors:  [103.63317835  -0.64447423  -1.02121683]
mat_Sqrt:  [[19.59288469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00100562 -0.00659539  0.21422481]
Stock Position:  0.0010056229196632478
Bond Position:  [3.13853352]


portfolio before change:  [3.24346211]
curr_Stock_Price:  103.95173430817633
curr_Factors:  [103.95173431  -0.5715339   -1.00230616]
mat_Sqrt:  [[21.54376905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04464292 -0.07209915 -0.60109148]
Stock Position:  -0.04464291561896967
Bond Position:  [7.88417062]


portfolio before change:  [3.23621906]
curr_Stock_Price:  104.13605542167139
curr_Factors:  [104.13605542  -0.58272202  -1.00172679]
mat_Sqrt:  [[21.3542217   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00320406 0.03307553 0.33434342]
Stock Position:  0.0032040607335445223
Bond Position:  [2.90256082]


portfolio before change:  [3.23924758]
curr_Stock_Price:  104.96802357878113
curr_Factors:  [104.96802358  -0.73540783  -1.01554985]
mat_Sqrt:  [[18.22324704  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155815  0.00293996  0.43926195]
Stock Position:  -0.0015581501542907585
Bond Position:  [3.40280352]


portfolio before change:  [3.24035298]
curr_Stock_Price:  104.53159538056133
curr_Factors:  [104.53159538  -0.597336    -1.02332703]
mat_Sqrt:  [[20.67295539  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01352404 -0.092741   -0.1110266 ]
Stock Position:  0.013524038352647974
Bond Position:  [1.82666368]


portfolio before change:  [3.22346812]
curr_Stock_Price:  103.26620337888808
curr_Factors:  [103.26620338  -0.35115743  -1.02023888]
mat_Sqrt:  [[26.2040463   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02160222 -0.00801537 -0.25663175]
Stock Position:  -0.02160222121164743
Bond Position:  [5.45424749]


portfolio before change:  [3.21210516]
curr_Stock_Price:  103.82377482565927
curr_Factors:  [103.82377483  -0.50588766  -1.0323613 ]
mat_Sqrt:  [[22.29686371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00032341  0.01571206 -0.02858387]
Stock Position:  0.00032340878414918614
Bond Position:  [3.17852764]


portfolio before change:  [3.21276539]
curr_Stock_Price:  104.63663555473684
curr_Factors:  [104.63663555  -0.591829    -1.06438129]
mat_Sqrt:  [[19.97104424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144934 -0.08155144  0.56034614]
Stock Position:  0.0014493437339287945
Bond Position:  [3.06111093]


portfolio before change:  [3.21334317]
curr_Stock_Price:  104.77125987216439
curr_Factors:  [104.77125987  -0.7135994   -1.05914588]
mat_Sqrt:  [[17.79707679  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01131153  0.01277237  0.60580033]
Stock Position:  -0.011311529879296206
Bond Position:  [4.3984664]


portfolio before change:  [3.22592531]
curr_Stock_Price:  103.70753952775839
curr_Factors:  [103.70753953  -0.63093201  -1.02283847]
mat_Sqrt:  [[19.84206812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.004138   -0.00069414  0.6264447 ]
Stock Position:  0.004137997550962749
Bond Position:  [2.79678377]


portfolio before change:  [3.22180091]
curr_Stock_Price:  102.62633555012667
curr_Factors:  [102.62633555  -0.65094544  -1.02432834]
mat_Sqrt:  [[19.21748996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00561442 0.09511329 0.7395661 ]
Stock Position:  0.005614421899705484
Bond Position:  [2.64561337]


portfolio before change:  [3.22027094]
curr_Stock_Price:  102.29492146498282
curr_Factors:  [102.29492146  -0.8070662   -1.00940023]
mat_Sqrt:  [[16.63308188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00258077 -0.03587186 -0.12433753]
Stock Position:  0.0025807684915116805
Bond Position:  [2.95627143]


portfolio before change:  [3.21959311]
curr_Stock_Price:  101.88907895759056
curr_Factors:  [101.88907896  -0.69270628  -1.02466107]
mat_Sqrt:  [[18.29298045  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166027  0.01756003  0.13120074]
Stock Position:  -0.0016602686633443772
Bond Position:  [3.38875635]


portfolio before change:  [3.21878553]
curr_Stock_Price:  102.63064553770357
curr_Factors:  [102.63064554  -0.71121056  -1.02004169]
mat_Sqrt:  [[18.17204326  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02416352 -0.0715963   0.34103517]
Stock Position:  -0.024163516366145894
Bond Position:  [5.69870281]


portfolio before change:  [3.21411667]
curr_Stock_Price:  102.85334682011558
curr_Factors:  [102.85334682  -0.6449759   -1.03382672]
mat_Sqrt:  [[19.19215371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00684191  0.00580111 -0.05715682]
Stock Position:  -0.0068419149702915495
Bond Position:  [3.91783052]


portfolio before change:  [3.22151979]
curr_Stock_Price:  101.84290380203551
curr_Factors:  [101.8429038   -0.50381157  -1.00706912]
mat_Sqrt:  [[22.47830849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0109606  0.29012194 0.54690091]
Stock Position:  0.010960596762997094
Bond Position:  [2.10526079]


portfolio before change:  [3.20706954]
curr_Stock_Price:  100.50051082540116
curr_Factors:  [100.50051083  -0.35835772  -1.0102876 ]
mat_Sqrt:  [[25.5724982   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00256076 -0.00523999  0.2152984 ]
Stock Position:  -0.0025607609952670667
Bond Position:  [3.46442733]


portfolio before change:  [3.20447261]
curr_Stock_Price:  101.68375515273782
curr_Factors:  [101.68375515  -0.14101294  -1.00737711]
mat_Sqrt:  [[32.24869265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131964  0.02750468  0.00919961]
Stock Position:  -0.0013196368520543382
Bond Position:  [3.33865824]


portfolio before change:  [3.20446654]
curr_Stock_Price:  102.0046256851566
curr_Factors:  [102.00462569  -0.10410799  -1.00039288]
mat_Sqrt:  [[33.80190939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011499   0.01916992 -0.08961985]
Stock Position:  -0.001149901422392436
Bond Position:  [3.3217618]


portfolio before change:  [3.20536963]
curr_Stock_Price:  101.58037602015847
curr_Factors:  [ 1.01580376e+02  7.63393753e-02 -9.89650050e-01]
mat_Sqrt:  [[40.75341715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00330906 -0.01301545  0.36802148]
Stock Position:  0.003309056256624941
Bond Position:  [2.86923445]


portfolio before change:  [3.2099775]
curr_Stock_Price:  102.86448702812943
curr_Factors:  [102.86448703   0.10635634  -0.98437391]
mat_Sqrt:  [[42.75109864  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187615  0.00719328 -0.08206254]
Stock Position:  0.001876148445312696
Bond Position:  [3.01698845]


portfolio before change:  [3.20569816]
curr_Stock_Price:  100.38254546443844
curr_Factors:  [100.38254546   0.10727528  -0.98289402]
mat_Sqrt:  [[41.81978695  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126085 -0.07310726  0.29003645]
Stock Position:  -0.0012608529299404383
Bond Position:  [3.33226578]


portfolio before change:  [3.20108034]
curr_Stock_Price:  104.37537848098701
curr_Factors:  [ 1.04375378e+02 -2.48982444e-02 -9.83009169e-01]
mat_Sqrt:  [[38.09512786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00045618 0.01967926 0.02769171]
Stock Position:  0.00045617945480681317
Bond Position:  [3.15346644]


portfolio before change:  [3.20071558]
curr_Stock_Price:  102.71163670340178
curr_Factors:  [102.7116367   -0.42673816  -0.98294861]
mat_Sqrt:  [[25.08421221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00300585 -0.02030674  0.47116446]
Stock Position:  0.0030058471533933933
Bond Position:  [2.8919801]


portfolio before change:  [3.19486696]
curr_Stock_Price:  100.64561447672881
curr_Factors:  [ 1.00645614e+02 -9.56061374e-02 -9.88021922e-01]
mat_Sqrt:  [[34.0550223   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00067716  0.01434014 -0.19591397]
Stock Position:  0.0006771623564685327
Bond Position:  [3.12671354]


portfolio before change:  [3.19474162]
curr_Stock_Price:  99.88331841593784
curr_Factors:  [ 9.98833184e+01  8.25222119e-02 -9.78537619e-01]
mat_Sqrt:  [[40.77166202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02350286 -0.03423419 -3.22296176]
Stock Position:  -0.02350286467147758
Bond Position:  [5.54228574]


portfolio before change:  [3.1342453]
curr_Stock_Price:  102.48679475815842
curr_Factors:  [102.48679476  -0.15048605  -0.96659624]
mat_Sqrt:  [[33.53707922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00589569 -0.00031964  0.18083254]
Stock Position:  -0.00589568596338655
Bond Position:  [3.73847526]


portfolio before change:  [3.13057905]
curr_Stock_Price:  103.18791487611392
curr_Factors:  [ 1.03187915e+02 -9.46901082e-02 -9.53179911e-01]
mat_Sqrt:  [[36.18634087  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00170145 -0.00811769  0.28560373]
Stock Position:  0.0017014531513921626
Bond Position:  [2.95500965]


portfolio before change:  [3.12977221]
curr_Stock_Price:  102.4965994103037
curr_Factors:  [ 1.02496599e+02  8.40645230e-02 -9.67301441e-01]
mat_Sqrt:  [[42.37644661  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060188  0.04177281 -0.07842941]
Stock Position:  0.0006018780257410731
Bond Position:  [3.06808176]


portfolio before change:  [3.13042999]
curr_Stock_Price:  102.95224867945359
curr_Factors:  [ 1.02952249e+02  1.20128845e-02 -1.01909149e+00]
mat_Sqrt:  [[37.60686705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367093 -0.00335311 -0.21626687]
Stock Position:  -0.0036709331856069043
Bond Position:  [3.50836082]


portfolio before change:  [3.1293957]
curr_Stock_Price:  103.35347123101666
curr_Factors:  [ 1.03353471e+02  1.97590322e-02 -1.03857649e+00]
mat_Sqrt:  [[37.31283654  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00127713  0.01260098  0.21048974]
Stock Position:  -0.0012771286202653584
Bond Position:  [3.26139138]


portfolio before change:  [3.13153523]
curr_Stock_Price:  101.99744281234764
curr_Factors:  [ 1.01997443e+02 -9.56481116e-02 -1.00934095e+00]
mat_Sqrt:  [[33.78303267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00633092 -0.05323309 -0.17720009]
Stock Position:  0.00633092341302774
Bond Position:  [2.48579723]


portfolio before change:  [3.13825365]
curr_Stock_Price:  103.00956729702192
curr_Factors:  [103.0095673   -0.21472452  -1.00728365]
mat_Sqrt:  [[30.35052174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00039818 0.04460297 0.22747744]
Stock Position:  0.00039817781819111837
Bond Position:  [3.09723753]


portfolio before change:  [3.13796617]
curr_Stock_Price:  101.31518677568098
curr_Factors:  [101.31518678  -0.41143609  -0.99032466]
mat_Sqrt:  [[24.9400657   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00017775  0.0014097  -0.13082042]
Stock Position:  -0.00017774681794013468
Bond Position:  [3.15597462]


portfolio before change:  [3.13818508]
curr_Stock_Price:  102.30313951314966
curr_Factors:  [102.30313951  -0.32314926  -0.98814625]
mat_Sqrt:  [[27.56770148  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00169451  0.02779952 -0.02176672]
Stock Position:  -0.0016945060060752505
Bond Position:  [3.31153837]


portfolio before change:  [3.13837274]
curr_Stock_Price:  102.43669752025845
curr_Factors:  [102.43669752  -0.19263028  -1.01453763]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.13837274]
Stock Price:  102.3954947160716
PL:  [0.74287802]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.79465738e-01  8.63962052e-02  2.76024577e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.48818092e-01  9.89413447e-02  1.07403485e-01]
 [-1.39488913e-02  3.01071088e-02  1.23407591e-01]
 [-7.10866922e-01 -2.14510321e-01  3.52818288e-02]
 [-3.72766732e-03  7.67050098e-02  9.68304555e-02]
 [ 1.93584353e-02  1.12587560e-01  3.81674105e-02]
 [ 2.88018787e-01 -4.98829758e-02 -6.33518207e-02]
 [-4.55541041e-01 -2.58819197e-02 -4.69963688e-02]
 [ 3.57239976e-02  2.54064608e-03 -3.21118483e-02]
 [-3.77623494e-03 -2.41994312e-01  1.21655350e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.37051654e-01 -4.91464397e-02  2.94836859e-01]
 [ 5.86504916e-02  2.16550133e-01  1.74777152e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-1.56379009e-02 -8.07763216e-03  3.61130595e-02]
 [-5.39551744e-01 -2.61827647e-01  1.54365723e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 2.26367996e-01  9.64722384e-01  3.31308505e-01]
 [ 4.06610294e-03  1.70046068e-02  2.97233529e-02]
 [-3.20223457e-02 -1.63308237e-01  3.38278245e-03]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 7.70654610e-02 -3.63554287e-02  9.87690690e-02]
 [ 7.08111341e-02  1.56594201e-01  4.54418347e-02]
 [-5.90161649e-02 -1.40603766e-01  1.04465626e-01]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [-1.16149642e-02 -2.25145120e-02 -3.19765985e-02]
 [ 4.77930489e-02  5.42428696e-02 -7.68238008e-02]
 [-7.13713127e-01 -1.27645141e-01 -1.10929007e+00]
 [-1.38974632e-01  6.82009732e-02 -5.19117011e-03]
 [-3.55630383e-02 -2.23216876e-02  1.13625108e-01]
 [ 2.06810189e-02  7.51694722e-02  1.52505538e-04]
 [-1.51545692e-01 -5.03546639e-03 -1.29572313e-01]
 [-6.24627413e-02  7.05156951e-02  9.32354081e-02]
 [ 1.58781297e-01 -1.61344714e-01 -1.00772528e-01]
 [-3.28492022e-02  2.77124393e-01  8.42540885e-02]
 [ 7.82009971e-02  6.67571189e-02 -3.15632586e-02]
 [-3.86591252e-02  8.14681136e-02 -8.52507053e-03]
 [-1.05615699e-01 -2.04136057e-01  4.09468947e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.7209028]
curr_Stock_Price:  99.42754040905496
curr_Factors:  [99.42754041 -0.74399735 -0.98107097]
mat_Sqrt:  [[17.71409809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01246983  0.02732088  0.78742129]
Stock Position:  -0.012469825764543118
Bond Position:  [-0.48105869]


portfolio before change:  [-1.73318777]
curr_Stock_Price:  100.4078937939984
curr_Factors:  [100.40789379  -1.00283315  -0.98705411]
mat_Sqrt:  [[13.72684726  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330601  0.01411938  0.0859571 ]
Stock Position:  -0.0033060062503124927
Bond Position:  [-1.40123864]


portfolio before change:  [-1.73297619]
curr_Stock_Price:  100.29091234341348
curr_Factors:  [100.29091234  -1.08387199  -0.98913193]
mat_Sqrt:  [[12.6173288   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0216604  0.031288   0.30639225]
Stock Position:  0.021660400154170104
Bond Position:  [-3.90531749]


portfolio before change:  [-1.73716668]
curr_Stock_Price:  100.11998800204125
curr_Factors:  [100.119988    -0.8373512   -0.93867397]
mat_Sqrt:  [[16.95129417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00070903 0.0095207  0.35204751]
Stock Position:  0.0007090278631728797
Bond Position:  [-1.80815454]


portfolio before change:  [-1.73713186]
curr_Stock_Price:  100.4878914318815
curr_Factors:  [100.48789143  -0.87216013  -0.94208162]
mat_Sqrt:  [[16.37565026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04330843 -0.06783412  0.10064924]
Stock Position:  -0.043308428711049604
Bond Position:  [2.61484083]


portfolio before change:  [-1.8236931]
curr_Stock_Price:  102.4941548516524
curr_Factors:  [102.49415485  -0.90928781  -0.93071183]
mat_Sqrt:  [[16.27786384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00110692 0.02425625 0.27623034]
Stock Position:  0.0011069192895674076
Bond Position:  [-1.93714585]


portfolio before change:  [-1.82499465]
curr_Stock_Price:  101.53709328360122
curr_Factors:  [101.53709328  -0.84617798  -0.94337459]
mat_Sqrt:  [[16.9602371   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00177216 0.03560331 0.108881  ]
Stock Position:  0.0017721641225938803
Bond Position:  [-2.00493504]


portfolio before change:  [-1.82712114]
curr_Stock_Price:  100.4785786258405
curr_Factors:  [100.47857863  -0.89270717  -0.9329025 ]
mat_Sqrt:  [[16.18904684  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01691262 -0.01577438 -0.18072511]
Stock Position:  0.016912618801294507
Bond Position:  [-3.52647704]


portfolio before change:  [-1.82627319]
curr_Stock_Price:  100.55478105957812
curr_Factors:  [100.55478106  -1.1226601   -0.92618869]
mat_Sqrt:  [[12.95982093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03594204 -0.00818458 -0.13406756]
Stock Position:  -0.03594204007476749
Bond Position:  [1.78787078]


portfolio before change:  [-1.8422306]
curr_Stock_Price:  101.0049755047915
curr_Factors:  [101.0049755   -1.19870462  -0.9437204 ]
mat_Sqrt:  [[11.85494124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00246604  0.00080342 -0.09160616]
Stock Position:  0.0024660428620204003
Bond Position:  [-2.0913132]


portfolio before change:  [-1.84142312]
curr_Stock_Price:  101.43843052089898
curr_Factors:  [101.43843052  -1.15162008  -0.94257609]
mat_Sqrt:  [[12.49409139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118522 -0.07652532  0.34704885]
Stock Position:  0.0011852236961809894
Bond Position:  [-1.96165035]


portfolio before change:  [-1.84192785]
curr_Stock_Price:  101.21947653718541
curr_Factors:  [101.21947654  -1.199152    -0.93765944]
mat_Sqrt:  [[11.94699465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00603713  0.00225658  0.15019092]
Stock Position:  -0.006037134921200168
Bond Position:  [-1.23085221]


portfolio before change:  [-1.84169229]
curr_Stock_Price:  101.15497169390711
curr_Factors:  [101.15497169  -0.769722    -0.96169664]
mat_Sqrt:  [[17.90777686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01094307 -0.01554147  0.84108749]
Stock Position:  0.010943067998991526
Bond Position:  [-2.94863802]


portfolio before change:  [-1.84095953]
curr_Stock_Price:  101.25561614867254
curr_Factors:  [101.25561615  -0.99201364  -0.95937919]
mat_Sqrt:  [[14.38599748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00694551 0.06847916 0.49859057]
Stock Position:  0.0069455057931788865
Bond Position:  [-2.544231]


portfolio before change:  [-1.83490884]
curr_Stock_Price:  102.17257456917055
curr_Factors:  [102.17257457  -1.04044117  -0.94776142]
mat_Sqrt:  [[13.99164974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00306798 -0.03587186 -0.12433753]
Stock Position:  0.0030679822912154896
Bond Position:  [-2.14837249]


portfolio before change:  [-1.83375221]
curr_Stock_Price:  102.63711234282414
curr_Factors:  [102.63711234  -1.30208749  -0.96717019]
mat_Sqrt:  [[10.61153814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079865 -0.00255437  0.10302051]
Stock Position:  -0.0007986511399359586
Bond Position:  [-1.75178096]


portfolio before change:  [-1.83381916]
curr_Stock_Price:  102.4467405388943
curr_Factors:  [102.44674054  -1.32105558  -0.94041665]
mat_Sqrt:  [[10.67463997  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04822667 -0.08279717  0.44036244]
Stock Position:  -0.04822666951588031
Bond Position:  [3.10684594]


portfolio before change:  [-1.84281754]
curr_Stock_Price:  102.64137908896983
curr_Factors:  [102.64137909  -0.94137147  -0.94671589]
mat_Sqrt:  [[15.53590487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0084521   0.00580111 -0.05715682]
Stock Position:  -0.008452104007812508
Bond Position:  [-0.97528193]


portfolio before change:  [-1.84183763]
curr_Stock_Price:  102.51101742141795
curr_Factors:  [102.51101742  -1.03346271  -0.95846578]
mat_Sqrt:  [[13.98578967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02280208 0.305072   0.94513095]
Stock Position:  0.022802079395470826
Bond Position:  [-4.17930199]


portfolio before change:  [-1.84984285]
curr_Stock_Price:  102.182855575642
curr_Factors:  [102.18285558  -1.05517896  -0.97685891]
mat_Sqrt:  [[13.39291775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0007894  0.00537733 0.08479245]
Stock Position:  0.0007894033393467877
Bond Position:  [-1.93050634]


portfolio before change:  [-1.85007257]
curr_Stock_Price:  102.19756002583208
curr_Factors:  [102.19756003  -1.041164    -0.96152666]
mat_Sqrt:  [[13.79377149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257714 -0.0516426   0.00965014]
Stock Position:  -0.0025771369831474
Bond Position:  [-1.58669546]


portfolio before change:  [-1.85094574]
curr_Stock_Price:  102.45940749175513
curr_Factors:  [102.45940749  -0.88503358  -0.98056397]
mat_Sqrt:  [[15.86109337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245058  0.01916992 -0.08961985]
Stock Position:  -0.0024505790856534726
Bond Position:  [-1.59986086]


portfolio before change:  [-1.84891417]
curr_Stock_Price:  101.54878089996001
curr_Factors:  [101.5487809   -0.87889134  -0.96970491]
mat_Sqrt:  [[15.98967234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00602188 -0.0114966   0.28176066]
Stock Position:  0.006021881972646952
Bond Position:  [-2.46042894]


portfolio before change:  [-1.85324367]
curr_Stock_Price:  100.88089600712027
curr_Factors:  [100.88089601  -0.99830838  -0.93661361]
mat_Sqrt:  [[14.57078616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00577389 0.04951943 0.12963291]
Stock Position:  0.005773892620426334
Bond Position:  [-2.43571913]


portfolio before change:  [-1.84817863]
curr_Stock_Price:  101.81086193238387
curr_Factors:  [101.81086193  -0.99349108  -0.92907595]
mat_Sqrt:  [[14.88791445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277558 -0.04446281  0.29801135]
Stock Position:  -0.00277557894907668
Bond Position:  [-1.56559454]


portfolio before change:  [-1.84985047]
curr_Stock_Price:  102.34269205244341
curr_Factors:  [102.34269205  -1.17043071  -0.93181694]
mat_Sqrt:  [[12.50438333  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103612  0.02004328 -0.05140267]
Stock Position:  0.001036123298142171
Bond Position:  [-1.95589012]


portfolio before change:  [-1.85012452]
curr_Stock_Price:  102.3141800112675
curr_Factors:  [102.31418001  -1.1217521   -0.94579705]
mat_Sqrt:  [[12.94227558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144669 -0.00711971 -0.09122033]
Stock Position:  -0.0014466916635550362
Bond Position:  [-1.70210745]


portfolio before change:  [-1.85121984]
curr_Stock_Price:  102.92422199897113
curr_Factors:  [102.924222    -0.90649513  -0.930741  ]
mat_Sqrt:  [[16.3914013   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00204449  0.0171531  -0.21915692]
Stock Position:  0.002044486649385143
Bond Position:  [-2.06164704]


portfolio before change:  [-1.85204335]
curr_Stock_Price:  102.64748214274412
curr_Factors:  [102.64748214  -0.86001025  -0.92607365]
mat_Sqrt:  [[17.20528686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05483441 -0.04036494 -3.16449579]
Stock Position:  -0.05483441252105645
Bond Position:  [3.77657103]


portfolio before change:  [-1.91159757]
curr_Stock_Price:  103.74216560336815
curr_Factors:  [103.7421656   -0.93275624  -0.89883791]
mat_Sqrt:  [[16.61514277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00832213  0.02156704 -0.01480896]
Stock Position:  -0.008322127300135096
Bond Position:  [-1.04824207]


portfolio before change:  [-1.91249491]
curr_Stock_Price:  103.83424567395076
curr_Factors:  [103.83424567  -1.02520009  -0.87729315]
mat_Sqrt:  [[15.49167208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083566 -0.00705874  0.32414081]
Stock Position:  -0.0008356589009230898
Bond Position:  [-1.8257249]


portfolio before change:  [-1.91300383]
curr_Stock_Price:  104.17012859798095
curr_Factors:  [104.1701286   -1.17657516  -0.84910954]
mat_Sqrt:  [[13.7404043   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00164864 0.02377067 0.00043506]
Stock Position:  0.0016486426371181574
Bond Position:  [-2.08474314]


portfolio before change:  [-1.91405733]
curr_Stock_Price:  103.6891936336483
curr_Factors:  [103.68919363  -1.16347545  -0.84019539]
mat_Sqrt:  [[13.98138869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01274012 -0.00159235 -0.36963374]
Stock Position:  -0.012740118230212932
Bond Position:  [-0.59304474]


portfolio before change:  [-1.91889536]
curr_Stock_Price:  104.0631227507878
curr_Factors:  [104.06312275  -1.26870705  -0.82499023]
mat_Sqrt:  [[12.82376875  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324479  0.02229902  0.26597467]
Stock Position:  -0.003244789944930151
Bond Position:  [-1.58123239]


portfolio before change:  [-1.92210515]
curr_Stock_Price:  104.99141625273138
curr_Factors:  [104.99141625  -1.09510097  -0.84853381]
mat_Sqrt:  [[15.03294037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00891677 -0.05102168 -0.28747597]
Stock Position:  0.008916771106682772
Bond Position:  [-2.85828957]


portfolio before change:  [-1.9105144]
curr_Stock_Price:  106.33136898144943
curr_Factors:  [106.33136898  -1.08767029  -0.85369517]
mat_Sqrt:  [[15.25938741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055674  0.08763443  0.24035346]
Stock Position:  -0.0005567449804099881
Bond Position:  [-1.85131495]


portfolio before change:  [-1.91044899]
curr_Stock_Price:  105.79819313854337
curr_Factors:  [105.79819314  -1.18095874  -0.85466506]
mat_Sqrt:  [[13.81713701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00531817  0.02111045 -0.09004119]
Stock Position:  0.00531816650518749
Bond Position:  [-2.4731014]


portfolio before change:  [-1.90959889]
curr_Stock_Price:  106.01617366094916
curr_Factors:  [106.01617366  -1.27278099  -0.83860026]
mat_Sqrt:  [[12.83544402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029836   0.02576248 -0.02431965]
Stock Position:  -0.002983597623015667
Bond Position:  [-1.59328929]


portfolio before change:  [-1.91063712]
curr_Stock_Price:  106.29739650820527
curr_Factors:  [106.29739651  -0.92284378  -0.80410217]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.91063712]
Stock Price:  107.06036277958219
PL:  [-8.9709999]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-7.92125600e-02 -1.62254760e-02 -1.18208180e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.60791704e-01  1.77473882e-01  2.25352837e-01]
 [-1.50466757e-02  2.91771953e-02  1.22611563e-01]
 [-8.48029172e-01 -2.53363133e-01  3.19299358e-02]
 [-3.13104896e-02 -4.43102457e-02 -3.54589984e-02]
 [ 1.32033222e-02  1.28691864e-01  4.23065284e-02]
 [ 4.40488296e-01  9.06326878e-02 -1.34839215e-01]
 [-5.44340987e-01 -3.20155689e-02 -6.06767939e-02]
 [ 1.95710138e-02  2.99828288e-02 -1.92526050e-02]
 [-3.63080230e-02 -1.63360551e-01  1.01384582e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.15942177e-01 -2.86369853e-02  2.78933888e-01]
 [-9.25799387e-04  5.32469976e-01  4.82919040e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-1.31819888e-02 -1.41904634e-02  3.51637223e-02]
 [-5.29814463e-01 -2.53361073e-01  1.49770651e-01]
 [-1.36429636e-01  1.77772715e-02 -1.27636604e-02]
 [ 2.05362854e-01  9.14952956e-01  2.77790743e-01]
 [ 7.85717013e-03  1.32130089e-02  3.02880869e-02]
 [-3.84500142e-03 -1.71858790e-01  3.93932124e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.41082390e-01 -2.92436165e-02  1.50791159e-01]
 [ 8.17271775e-02 -5.67070756e-02 -4.85021389e-02]
 [-1.06730321e-01  1.39424746e-01  1.54992957e-01]
 [ 1.37615704e-02  6.22042380e-02  1.03587028e-02]
 [-8.04636304e-02 -9.90655674e-02  1.50097118e-01]
 [ 8.07936371e-02  6.84490085e-02 -8.71350626e-02]
 [-7.06089600e-01 -1.26382418e-01 -1.04733205e+00]
 [-9.52653677e-02  8.10037370e-03  5.60585430e-02]
 [-8.49379158e-02 -7.17794481e-02  1.23274578e-01]
 [ 1.99044453e-02  6.78177386e-02  3.75319993e-03]
 [-1.24093944e-01 -5.08111871e-03 -1.45337606e-01]
 [-6.59160790e-02 -1.21698724e-02  4.07955638e-02]
 [ 2.31616507e-01 -1.74723334e-01 -7.18387844e-02]
 [ 5.39053274e-03  4.61651452e-02  7.65593378e-02]
 [-2.27243701e-04 -5.28751558e-04 -4.66804203e-02]
 [-7.67784233e-02  4.89322593e-02 -3.35103919e-03]
 [-4.74704979e-02 -2.63237876e-01  1.23781451e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.03853494]
curr_Stock_Price:  100.50866260346216
curr_Factors:  [100.5086626   -1.1422192   -0.97335837]
mat_Sqrt:  [[12.11768974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00677063 -0.00513095 -0.0337215 ]
Stock Position:  -0.006770631702739326
Bond Position:  [6.71904208]


portfolio before change:  [6.04166746]
curr_Stock_Price:  100.17005531271569
curr_Factors:  [100.17005531  -0.93014607  -0.95900545]
mat_Sqrt:  [[15.1457168   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029963   0.01411938  0.0859571 ]
Stock Position:  -0.002996295482888776
Bond Position:  [6.34180654]


portfolio before change:  [6.04262534]
curr_Stock_Price:  100.11495262184457
curr_Factors:  [100.11495262  -1.03364398  -0.95987068]
mat_Sqrt:  [[13.63724141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02283262 0.05612217 0.64286892]
Stock Position:  0.022832624691329344
Bond Position:  [3.7567382]


portfolio before change:  [6.04118374]
curr_Stock_Price:  100.03124690211155
curr_Factors:  [100.0312469   -0.95496228  -0.93964609]
mat_Sqrt:  [[15.04242046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00071363 0.00922664 0.34977666]
Stock Position:  0.0007136256288053318
Bond Position:  [5.96979888]


portfolio before change:  [6.04254978]
curr_Stock_Price:  100.89973026479728
curr_Factors:  [100.89973026  -0.96793571  -0.94938175]
mat_Sqrt:  [[14.83233797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05717597 -0.08012046  0.09108722]
Stock Position:  -0.057175969931549296
Bond Position:  [11.81158973]


portfolio before change:  [6.08944809]
curr_Stock_Price:  100.10530973408686
curr_Factors:  [100.10530973  -1.36414441  -0.94582744]
mat_Sqrt:  [[ 9.93685803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00399448 -0.01401213 -0.10115465]
Stock Position:  -0.00399448325352591
Bond Position:  [6.48931707]


portfolio before change:  [6.08486498]
curr_Stock_Price:  101.45575339425352
curr_Factors:  [101.45575339  -1.66100567  -0.97656433]
mat_Sqrt:  [[ 7.25762603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00346696 0.04069594 0.12068875]
Stock Position:  0.0034669622998801546
Bond Position:  [5.73312171]


portfolio before change:  [6.08710449]
curr_Stock_Price:  101.8949918462983
curr_Factors:  [101.89499185  -1.839817    -0.96779927]
mat_Sqrt:  [[ 6.14922787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06753766  0.02866057 -0.38465875]
Stock Position:  0.06753766351651343
Bond Position:  [-0.79464519]


portfolio before change:  [6.08784615]
curr_Stock_Price:  101.90744424020862
curr_Factors:  [101.90744424  -1.731343    -0.9730981 ]
mat_Sqrt:  [[ 6.81839351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08177193 -0.01012421 -0.173094  ]
Stock Position:  -0.08177193398108693
Bond Position:  [14.42101496]


portfolio before change:  [6.12852735]
curr_Stock_Price:  101.43199435258485
curr_Factors:  [101.43199435  -1.56285951  -0.97104092]
mat_Sqrt:  [[ 8.04851931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00203954  0.0094814  -0.05492232]
Stock Position:  0.0020395360935601217
Bond Position:  [5.92165314]


portfolio before change:  [6.12995]
curr_Stock_Price:  101.76658047039096
curr_Factors:  [101.76658047  -1.66415754  -0.95110518]
mat_Sqrt:  [[ 7.44407973  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266399 -0.05165914  0.28922199]
Stock Position:  -0.0026639872204015807
Bond Position:  [6.40105487]


portfolio before change:  [6.12982856]
curr_Stock_Price:  102.11253770985978
curr_Factors:  [102.11253771  -1.69437297  -0.94768497]
mat_Sqrt:  [[ 7.27189976  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0099184   0.00225658  0.15019092]
Stock Position:  -0.009918401096316804
Bond Position:  [7.14262167]


portfolio before change:  [6.12042717]
curr_Stock_Price:  103.1504344745736
curr_Factors:  [103.15043447  -1.87142926  -0.9309596 ]
mat_Sqrt:  [[ 6.25761794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02750886 -0.00905581  0.79572074]
Stock Position:  0.0275088566964486
Bond Position:  [3.28287665]


portfolio before change:  [6.12980838]
curr_Stock_Price:  103.47654129653908
curr_Factors:  [103.4765413   -1.53907009  -0.93136066]
mat_Sqrt:  [[ 8.74877937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01273297 0.16838179 1.3776336 ]
Stock Position:  0.012732970829296898
Bond Position:  [4.8122446]


portfolio before change:  [6.12971581]
curr_Stock_Price:  103.42202604614772
curr_Factors:  [103.42202605  -1.51663638  -0.95498905]
mat_Sqrt:  [[ 8.73372987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00491498 -0.03587186 -0.12433753]
Stock Position:  0.004914982972950577
Bond Position:  [5.62139831]


portfolio before change:  [6.13038115]
curr_Stock_Price:  103.41442165586994
curr_Factors:  [103.41442166  -1.36211791  -0.93702273]
mat_Sqrt:  [[10.37712422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061391 -0.00448742  0.10031231]
Stock Position:  -0.0006139099936797025
Bond Position:  [6.1938683]


portfolio before change:  [6.13153736]
curr_Stock_Price:  102.79230096603638
curr_Factors:  [102.79230097  -1.20253469  -0.91480017]
mat_Sqrt:  [[12.37125454  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04088384 -0.08011981  0.42725398]
Stock Position:  -0.04088384164894753
Bond Position:  [10.33408151]


portfolio before change:  [6.18093623]
curr_Stock_Price:  101.61562505065025
curr_Factors:  [101.61562505  -1.03374923  -0.91858251]
mat_Sqrt:  [[14.42359741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00960759  0.00562167 -0.03641117]
Stock Position:  -0.009607589297384726
Bond Position:  [7.15721742]


portfolio before change:  [6.17369313]
curr_Stock_Price:  102.46264360253618
curr_Factors:  [102.4626436   -0.89890211  -0.92158613]
mat_Sqrt:  [[16.59348327  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01721704 0.28933353 0.79245967]
Stock Position:  0.017217038236632214
Bond Position:  [4.40958988]


portfolio before change:  [6.17255016]
curr_Stock_Price:  102.36424065421897
curr_Factors:  [102.36424065  -0.83335697  -0.9588939 ]
mat_Sqrt:  [[17.05232523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00084334 0.00417832 0.08640348]
Stock Position:  0.0008433370933791238
Bond Position:  [6.0862226]


portfolio before change:  [6.17398238]
curr_Stock_Price:  103.16036083345935
curr_Factors:  [103.16036083  -0.93511681  -0.96969172]
mat_Sqrt:  [[15.35553742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.57122787e-05 -5.43465212e-02  1.12377870e-01]
Stock Position:  -1.5712278739778862e-05
Bond Position:  [6.17560326]


portfolio before change:  [6.1747551]
curr_Stock_Price:  103.11453099269812
curr_Factors:  [103.11453099  -1.08457969  -0.96142656]
mat_Sqrt:  [[13.32756006  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291643  0.01916992 -0.08961985]
Stock Position:  -0.002916427575817916
Bond Position:  [6.47548116]


portfolio before change:  [6.17578392]
curr_Stock_Price:  103.03932286160163
curr_Factors:  [103.03932286  -0.94242053  -0.96403367]
mat_Sqrt:  [[15.3123011   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01117451 -0.00924764  0.4301652 ]
Stock Position:  0.011174508534464566
Bond Position:  [5.02437013]


portfolio before change:  [6.17662021]
curr_Stock_Price:  103.05795504318856
curr_Factors:  [103.05795504  -0.94268466  -0.97325513]
mat_Sqrt:  [[15.17048426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00463812 -0.01793235 -0.1383631 ]
Stock Position:  0.004638121512745614
Bond Position:  [5.6986249]


portfolio before change:  [6.18235019]
curr_Stock_Price:  104.13977211511745
curr_Factors:  [104.13977212  -1.11343547  -0.96814038]
mat_Sqrt:  [[12.98971788  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00550378  0.04408998  0.44215176]
Stock Position:  -0.00550378268996114
Bond Position:  [6.75551286]


portfolio before change:  [6.18046569]
curr_Stock_Price:  104.63561031597449
curr_Factors:  [104.63561032  -1.01905248  -0.97234689]
mat_Sqrt:  [[14.28320775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00122396 0.01967071 0.0295505 ]
Stock Position:  0.0012239644322515181
Bond Position:  [6.05239543]


portfolio before change:  [6.18132231]
curr_Stock_Price:  104.71732507350151
curr_Factors:  [104.71732507  -1.01253975  -0.96795875]
mat_Sqrt:  [[14.45103562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362486 -0.03132728  0.4281853 ]
Stock Position:  -0.0036248645358105958
Bond Position:  [6.56090842]


portfolio before change:  [6.18161647]
curr_Stock_Price:  104.8624329764788
curr_Factors:  [104.86243298  -1.45065779  -0.93021249]
mat_Sqrt:  [[ 9.69663631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00668011  0.02164548 -0.24857208]
Stock Position:  0.006680111605764044
Bond Position:  [5.48112372]


portfolio before change:  [6.18800318]
curr_Stock_Price:  105.71594071211354
curr_Factors:  [105.71594071  -1.52989662  -0.95854476]
mat_Sqrt:  [[ 8.77857696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10515811 -0.03996563 -2.98774682]
Stock Position:  -0.10515810753068651
Bond Position:  [17.30489144]


portfolio before change:  [6.16422777]
curr_Stock_Price:  105.96260418874547
curr_Factors:  [105.96260419  -1.52288931  -0.94160671]
mat_Sqrt:  [[ 9.0122992   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00927769  0.00256156  0.15991942]
Stock Position:  -0.009277689633258954
Bond Position:  [7.14731592]


portfolio before change:  [6.1702607]
curr_Stock_Price:  105.40864469387311
curr_Factors:  [105.40864469  -1.0695114   -0.9424233 ]
mat_Sqrt:  [[14.09626603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00437193 -0.02269865  0.35166806]
Stock Position:  -0.004371933335619236
Bond Position:  [6.63110027]


portfolio before change:  [6.17508645]
curr_Stock_Price:  104.49444764017191
curr_Factors:  [104.49444764  -1.21180321  -0.92575465]
mat_Sqrt:  [[12.32433887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0018193  0.02144585 0.01070683]
Stock Position:  0.0018192951989125768
Bond Position:  [5.9849802]


portfolio before change:  [6.17145797]
curr_Stock_Price:  102.08876470229102
curr_Factors:  [102.0887647   -1.27582996  -0.9028968 ]
mat_Sqrt:  [[11.55497312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01331825 -0.00160679 -0.41460774]
Stock Position:  -0.013318252732315072
Bond Position:  [7.53110194]


portfolio before change:  [6.17755379]
curr_Stock_Price:  101.70174913076525
curr_Factors:  [101.70174913  -1.41613072  -0.88251781]
mat_Sqrt:  [[10.2102893   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00567104 -0.00384845  0.11637839]
Stock Position:  -0.0056710385427336
Bond Position:  [6.75430833]


portfolio before change:  [6.1744604]
curr_Stock_Price:  102.3961068346668
curr_Factors:  [102.39610683  -1.41778269  -0.90739914]
mat_Sqrt:  [[10.01082361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02122114 -0.05525237 -0.20493606]
Stock Position:  0.0212211449591043
Bond Position:  [4.00149777]


portfolio before change:  [6.17892405]
curr_Stock_Price:  102.5828750829268
curr_Factors:  [102.58287508  -1.21148873  -0.94044201]
mat_Sqrt:  [[11.92623104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00186229 0.0145987  0.21840248]
Stock Position:  0.0018622916975080284
Bond Position:  [5.98788482]


portfolio before change:  [6.17932125]
curr_Stock_Price:  102.39421414638002
curr_Factors:  [102.39421415  -1.01763041  -0.94529739]
mat_Sqrt:  [[14.38092108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067934 -0.00016721 -0.13316625]
Stock Position:  -0.000679337354959363
Bond Position:  [6.24888146]


portfolio before change:  [6.18093858]
curr_Stock_Price:  101.16333996264244
curr_Factors:  [101.16333996  -0.76723407  -0.96584567]
mat_Sqrt:  [[17.87953393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0042618   0.01547374 -0.00955958]
Stock Position:  -0.004261801571294401
Bond Position:  [6.61207666]


portfolio before change:  [6.18109851]
curr_Stock_Price:  101.31976077120257
curr_Factors:  [101.31976077  -0.61933974  -0.96038233]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.18109851]
Stock Price:  100.83845221658653
PL:  [5.34264629]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-6.02290591e-02  1.98196829e-01  2.85279051e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.58722132e-01  1.16664016e-02 -3.67484668e-02]
 [-3.71111842e-03 -5.64291303e-04  9.43976085e-02]
 [-6.99257199e-01 -2.11221731e-01  3.55655407e-02]
 [-2.24771257e-02 -6.12539925e-02 -6.11544015e-02]
 [ 2.76165138e-02  8.01130583e-02  1.12510026e-02]
 [ 2.66843402e-01 -9.62983329e-02 -5.07316686e-02]
 [-5.04075345e-01 -2.77661347e-02 -6.06553580e-02]
 [ 3.23570429e-02  8.26074014e-03 -2.94314463e-02]
 [-7.61047184e-03 -2.32063461e-01  1.28106751e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.13542585e-01 -2.63055993e-02  2.77126139e-01]
 [ 4.59743743e-02  2.39100862e-01  1.92371477e-01]
 [ 5.92259490e-02 -1.13353300e-01 -4.56040327e-02]
 [-2.68160475e-02  1.97450759e-02  4.04339923e-02]
 [-4.95558304e-01 -2.48167629e-01  1.36235567e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 2.53350516e-01  1.07180986e+00  3.75251504e-01]
 [ 2.06753030e-03  1.90034592e-02  2.94256367e-02]
 [-4.79690788e-02 -1.39141025e-01 -1.32644011e-02]
 [-3.30309054e-02  5.85507685e-02 -2.95158653e-02]
 [ 4.51386519e-02 -3.35867867e-02  6.30433327e-02]
 [ 5.81907543e-02  1.61162905e-01  7.15345590e-02]
 [-6.02437132e-02 -1.44024769e-01  6.02928945e-02]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [-8.25052515e-02  3.41130261e-02  5.26377972e-03]
 [ 4.68756034e-03  4.58364309e-02 -6.48887695e-02]
 [-5.44081920e-01  1.32044834e-02 -7.63624207e-01]
 [-2.39161383e-01  1.03988593e-01 -1.61917528e-02]
 [-6.86790671e-02  5.22858782e-02  1.31818892e-01]
 [ 3.33026482e-03 -2.40957759e-02  4.71665790e-02]
 [-1.11319935e-01 -3.58128347e-04 -1.52761396e-01]
 [-6.86252842e-02 -7.70381809e-02 -3.44433223e-04]
 [ 2.30512569e-01 -1.74030991e-01 -7.14099302e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-3.94223345e-02 -4.29245346e-02 -4.93996319e-02]
 [-9.98635088e-02 -2.20602861e-02  2.46882558e-03]
 [-3.98748627e-02 -2.95021064e-01  1.46936542e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.31316083]
curr_Stock_Price:  99.0663611861158
curr_Factors:  [99.06636119 -1.01333021 -1.01084625]
mat_Sqrt:  [[13.08692292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.38459686e-04 6.26753404e-02 8.13821727e-01]
Stock Position:  0.00023845968615597357
Bond Position:  [-4.33678416]


portfolio before change:  [-4.31349882]
curr_Stock_Price:  99.92244543756105
curr_Factors:  [99.92244544 -0.89675988 -1.01268808]
mat_Sqrt:  [[14.80472488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306531  0.01411938  0.0859571 ]
Stock Position:  -0.0030653080839251664
Bond Position:  [-4.00720574]


portfolio before change:  [-4.31624593]
curr_Stock_Price:  100.65521936668266
curr_Factors:  [100.65521937  -1.07465716  -1.00439208]
mat_Sqrt:  [[12.58683935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01998294  0.00368924 -0.10483315]
Stock Position:  0.019982944118951497
Bond Position:  [-6.32763355]


portfolio before change:  [-4.32502137]
curr_Stock_Price:  100.2556564689142
curr_Factors:  [100.25565647  -1.10528767  -1.00844837]
mat_Sqrt:  [[12.10946586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.28355313e-03 -1.78444578e-04  2.69290102e-01]
Stock Position:  0.0012835531294942413
Bond Position:  [-4.45370484]


portfolio before change:  [-4.32606455]
curr_Stock_Price:  99.87668398587877
curr_Factors:  [99.87668399 -1.02128334 -1.04681862]
mat_Sqrt:  [[12.62696118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05523507 -0.06679418  0.10145859]
Stock Position:  -0.055235073984813726
Bond Position:  [1.19063148]


portfolio before change:  [-4.34125973]
curr_Stock_Price:  100.15447879731153
curr_Factors:  [100.1544788   -0.94781613  -1.06144315]
mat_Sqrt:  [[13.42950971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272101 -0.01937021 -0.17445649]
Stock Position:  -0.0027210067727627798
Bond Position:  [-4.06873872]


portfolio before change:  [-4.34396132]
curr_Stock_Price:  100.96041649297368
curr_Factors:  [100.96041649  -0.7436049   -1.0424277 ]
mat_Sqrt:  [[16.92337713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00188979 0.02533397 0.03209598]
Stock Position:  0.0018897897915201242
Bond Position:  [-4.53475528]


portfolio before change:  [-4.34533865]
curr_Stock_Price:  100.53155966108804
curr_Factors:  [100.53155966  -0.77683621  -1.04037597]
mat_Sqrt:  [[16.33417478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01555031 -0.03045221 -0.14472333]
Stock Position:  0.015550306958290119
Bond Position:  [-5.90863526]


portfolio before change:  [-4.33467159]
curr_Stock_Price:  101.26502931672616
curr_Factors:  [101.26502932  -0.9038509   -1.06207266]
mat_Sqrt:  [[14.17978803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03647258 -0.00878042 -0.17303285]
Stock Position:  -0.03647258233063541
Bond Position:  [-0.64127448]


portfolio before change:  [-4.35047808]
curr_Stock_Price:  101.69621126107313
curr_Factors:  [101.69621126  -0.80369947  -1.07350595]
mat_Sqrt:  [[15.56126206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00170697  0.00261228 -0.08395972]
Stock Position:  0.0017069737260665592
Bond Position:  [-4.52407084]


portfolio before change:  [-4.35047669]
curr_Stock_Price:  102.02833811574705
curr_Factors:  [102.02833812  -1.03069998  -1.06757445]
mat_Sqrt:  [[12.51560377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00100254 -0.07338491  0.3654529 ]
Stock Position:  0.0010025370503714832
Bond Position:  [-4.45276388]


portfolio before change:  [-4.35094871]
curr_Stock_Price:  102.1127378581599
curr_Factors:  [102.11273786  -1.12883277  -1.06702219]
mat_Sqrt:  [[11.36140982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0063483   0.00225658  0.15019092]
Stock Position:  -0.006348298297285587
Bond Position:  [-3.70270659]


portfolio before change:  [-4.35202756]
curr_Stock_Price:  102.20976873004655
curr_Factors:  [102.20976873  -1.33439496  -1.07669095]
mat_Sqrt:  [[ 9.17003726  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01847664 -0.00831856  0.79056374]
Stock Position:  0.018476643910820822
Bond Position:  [-6.24052106]


portfolio before change:  [-4.35125577]
curr_Stock_Price:  102.29376118498524
curr_Factors:  [102.29376118  -1.18393206  -1.08289216]
mat_Sqrt:  [[10.60180711  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00862264 0.07561033 0.54878228]
Stock Position:  0.008622642766302757
Bond Position:  [-5.23329833]


portfolio before change:  [-4.35577335]
curr_Stock_Price:  101.84571141716816
curr_Factors:  [101.84571142  -1.01588032  -1.08200198]
mat_Sqrt:  [[12.49810127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00375979 -0.03584546 -0.13009561]
Stock Position:  0.003759794718733312
Bond Position:  [-4.73869231]


portfolio before change:  [-4.35705252]
curr_Stock_Price:  101.66304126344714
curr_Factors:  [101.66304126  -1.1169462   -1.08992723]
mat_Sqrt:  [[11.18742523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161366  0.00624394  0.11534693]
Stock Position:  -0.001613657955702646
Bond Position:  [-4.19300315]


portfolio before change:  [-4.35841632]
curr_Stock_Price:  102.18337700238499
curr_Factors:  [102.183377    -1.04978173  -1.07627514]
mat_Sqrt:  [[12.19117262  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03889347 -0.07847749  0.38864215]
Stock Position:  -0.03889346915432241
Bond Position:  [-0.3841503]


portfolio before change:  [-4.34679465]
curr_Stock_Price:  101.8833344270654
curr_Factors:  [101.88333443  -1.06686734  -1.0734729 ]
mat_Sqrt:  [[11.98299     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01095812  0.00580111 -0.05715682]
Stock Position:  -0.01095812345253947
Bond Position:  [-3.23034449]


portfolio before change:  [-4.34862591]
curr_Stock_Price:  102.01359743275792
curr_Factors:  [102.01359743  -1.00404041  -1.07070155]
mat_Sqrt:  [[12.81176834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02791359 0.33893604 1.07048809]
Stock Position:  0.027913587783830338
Bond Position:  [-7.19619141]


portfolio before change:  [-4.35430883]
curr_Stock_Price:  101.84223473347926
curr_Factors:  [101.84223473  -1.09512467  -1.06798385]
mat_Sqrt:  [[11.70851532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00073149 0.00600942 0.08394315]
Stock Position:  0.000731491586772177
Bond Position:  [-4.42880557]


portfolio before change:  [-4.3549352]
curr_Stock_Price:  101.7428124891726
curr_Factors:  [101.74281249  -1.07514074  -1.05451525]
mat_Sqrt:  [[12.09500064  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448692 -0.04400026 -0.03783964]
Stock Position:  -0.0044869174240002325
Bond Position:  [-3.8984236]


portfolio before change:  [-4.3531398]
curr_Stock_Price:  101.2340606562739
curr_Factors:  [101.23406066  -0.88869176  -1.04714217]
mat_Sqrt:  [[14.60846765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257002  0.01851538 -0.08420055]
Stock Position:  -0.0025700184806377864
Bond Position:  [-4.09296639]


portfolio before change:  [-4.35243828]
curr_Stock_Price:  100.76201019130065
curr_Factors:  [100.76201019  -1.23786573  -1.03833134]
mat_Sqrt:  [[10.34563123  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00552312 -0.01062107  0.17984508]
Stock Position:  0.005523115013247947
Bond Position:  [-4.90895845]


portfolio before change:  [-4.35419762]
curr_Stock_Price:  100.55457606923372
curr_Factors:  [100.55457607  -1.08889257  -1.06509678]
mat_Sqrt:  [[11.66638089  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00659621 0.05096419 0.20406819]
Stock Position:  0.0065962095714252045
Bond Position:  [-5.01747667]


portfolio before change:  [-4.34949168]
curr_Stock_Price:  101.36309560550852
curr_Factors:  [101.36309561  -1.17121868  -1.07952775]
mat_Sqrt:  [[10.67562005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483861 -0.04554463  0.17199885]
Stock Position:  -0.004838611799665185
Bond Position:  [-3.85903501]


portfolio before change:  [-4.35625079]
curr_Stock_Price:  102.66030776810268
curr_Factors:  [102.66030777  -1.27903914  -1.07655691]
mat_Sqrt:  [[ 9.73599173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133074  0.02004328 -0.05140267]
Stock Position:  0.001330740952430327
Bond Position:  [-4.49286507]


portfolio before change:  [-4.35796316]
curr_Stock_Price:  101.79558339747479
curr_Factors:  [101.7955834   -1.51448007  -1.06257644]
mat_Sqrt:  [[ 7.73619686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01041209  0.01078749  0.0150161 ]
Stock Position:  -0.010412091878446574
Bond Position:  [-3.29805819]


portfolio before change:  [-4.35740395]
curr_Stock_Price:  101.70227885430887
curr_Factors:  [101.70227885  -1.70048702  -1.07287681]
mat_Sqrt:  [[ 6.35146746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00116104  0.01449475 -0.1851096 ]
Stock Position:  -0.001161040775107714
Bond Position:  [-4.23932345]


portfolio before change:  [-4.3581183]
curr_Stock_Price:  101.86110292452459
curr_Factors:  [101.86110292  -1.77619042  -1.06859707]
mat_Sqrt:  [[ 5.92287906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11812078  0.00417562 -2.17840731]
Stock Position:  -0.11812078428944693
Bond Position:  [7.67379507]


portfolio before change:  [-4.38549592]
curr_Stock_Price:  102.10100067145387
curr_Factors:  [102.10100067  -1.7727282   -1.04799402]
mat_Sqrt:  [[ 6.08143267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03942846  0.03288408 -0.04619056]
Stock Position:  -0.03942846191436643
Bond Position:  [-0.35981051]


portfolio before change:  [-4.38209994]
curr_Stock_Price:  102.01372968970337
curr_Factors:  [102.01372969  -1.72679359  -1.062259  ]
mat_Sqrt:  [[ 6.27174625  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00644504  0.01653425  0.37604261]
Stock Position:  -0.006445036382731844
Bond Position:  [-3.72461774]


portfolio before change:  [-4.37906003]
curr_Stock_Price:  101.46982000789409
curr_Factors:  [101.46982001  -1.97762923  -1.09911506]
mat_Sqrt:  [[ 4.67868518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00263663 -0.00761975  0.13455312]
Stock Position:  0.002636627966143266
Bond Position:  [-4.64659819]


portfolio before change:  [-4.37828891]
curr_Stock_Price:  101.98258703526226
curr_Factors:  [101.98258704  -1.75981004  -1.07116819]
mat_Sqrt:  [[ 6.01239906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.37029296e-02 -1.13250127e-04 -4.35785741e-01]
Stock Position:  -0.023702929573976378
Bond Position:  [-1.96100284]


portfolio before change:  [-4.38141588]
curr_Stock_Price:  102.10416784492763
curr_Factors:  [102.10416784  -1.59557019  -1.07654595]
mat_Sqrt:  [[ 7.0559935   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01001768 -0.02436161 -0.00098257]
Stock Position:  -0.010017683356982813
Bond Position:  [-3.35856865]


portfolio before change:  [-4.38301962]
curr_Stock_Price:  102.2223488076076
curr_Factors:  [102.22234881  -1.64310625  -1.08114495]
mat_Sqrt:  [[ 6.70530583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03153363 -0.05503343 -0.20371265]
Stock Position:  0.03153362754887199
Bond Position:  [-7.6064611]


portfolio before change:  [-4.37778001]
curr_Stock_Price:  102.41866233788538
curr_Factors:  [102.41866234  -1.75621746  -1.08987058]
mat_Sqrt:  [[ 5.94755911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00412134 0.00777784 0.21633947]
Stock Position:  0.004121335023784953
Bond Position:  [-4.79988163]


portfolio before change:  [-4.37937645]
curr_Stock_Price:  102.17689321576209
curr_Factors:  [102.17689322  -1.84037028  -1.09197207]
mat_Sqrt:  [[ 5.44317866  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00929867 -0.01357393 -0.1409234 ]
Stock Position:  -0.009298665723387107
Bond Position:  [-3.42926767]


portfolio before change:  [-4.38167232]
curr_Stock_Price:  102.37769536358343
curr_Factors:  [102.37769536  -2.07135597  -1.08972782]
mat_Sqrt:  [[ 4.33874475  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02303181 -0.00697607  0.00704287]
Stock Position:  -0.023031812596138165
Bond Position:  [-2.02372843]


portfolio before change:  [-4.3674559]
curr_Stock_Price:  101.74945956475592
curr_Factors:  [101.74945956  -1.72177376  -1.10198678]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.3674559]
Stock Price:  101.35726550308377
PL:  [-5.7247214]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.95690284e-01  3.29367422e-01  3.57834391e-01]
 [-1.00229870e-01 -1.24442093e-01  9.99002303e-02]
 [ 1.50051333e-01  1.69047930e-01  2.92075411e-01]
 [-9.54568629e-02 -5.62537414e-02  5.84412043e-02]
 [-9.27414928e-01 -2.75850076e-01  2.99899519e-02]
 [ 5.43273646e-03 -9.02842502e-02 -1.15554024e-01]
 [ 3.03387346e-02 -2.05273066e-02 -2.88858081e-02]
 [ 3.21187158e-01  1.33430090e-01 -9.41878294e-02]
 [-2.60790752e-01  1.15661784e-02 -1.18030535e-01]
 [ 4.55983616e-02 -1.42348368e-02 -3.99727395e-02]
 [ 3.83844949e-02 -2.30741907e-01  2.13758850e-02]
 [ 1.78168867e-02 -1.48870494e-02 -2.59252950e-02]
 [ 2.47572969e-01 -2.17962632e-01  1.25986124e-01]
 [ 9.05250786e-02 -1.17014866e-02 -4.04097754e-02]
 [-4.16574249e-02 -1.03120830e-03  1.55468116e-02]
 [-3.05796664e-02 -6.52741366e-02  5.00360010e-03]
 [-4.56991664e-01 -2.64489607e-01  1.23368697e-01]
 [-1.81271800e-01 -2.75818108e-02 -2.78987979e-02]
 [ 2.82001623e-01  1.21586007e+00  4.00786849e-01]
 [-8.46492318e-02 -1.54592498e-02  8.05222915e-02]
 [-5.62813007e-02  6.06027206e-02 -1.77516698e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.64809423e-01 -2.79198403e-02  1.68848708e-01]
 [ 8.43822490e-02 -1.55190391e-02 -3.96023565e-02]
 [-1.16735018e-01  1.99096428e-01  1.63118961e-01]
 [ 1.34964696e-02  6.19515489e-02  1.64448926e-02]
 [-1.42813829e-01 -1.38793827e-01  2.85250765e-01]
 [ 7.70138358e-02  6.77001096e-02 -8.15441937e-02]
 [-7.57800789e-01 -1.52667221e-01 -1.13588447e+00]
 [-6.78572454e-02  6.49964481e-04  4.32974729e-02]
 [ 7.22851533e-04 -1.26948412e-02  1.12395139e-01]
 [ 1.66173900e-02  5.61423225e-02  8.99181584e-03]
 [-1.22915567e-01 -1.08787689e-02 -7.83025503e-02]
 [-6.13304431e-02  9.76270663e-02  1.10429655e-01]
 [ 1.70904522e-01 -1.63319860e-01 -9.57939508e-02]
 [-2.21833970e-02  2.32368972e-01  8.27892364e-02]
 [ 6.11068985e-02  5.61046740e-02 -3.60075667e-02]
 [-3.35239088e-02  7.76948608e-02 -9.04927030e-03]
 [-1.04224612e-01 -2.00677063e-01  4.01794262e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.25976419]
curr_Stock_Price:  98.93447097242364
curr_Factors:  [98.93447097 -0.82096453 -1.00382203]
mat_Sqrt:  [[15.95338699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00715481  0.10415512  1.02080192]
Stock Position:  -0.007154807595064293
Bond Position:  [-4.55190708]


portfolio before change:  [-5.25406859]
curr_Stock_Price:  98.05888960003533
curr_Factors:  [98.0588896  -0.92485707 -0.98067592]
mat_Sqrt:  [[14.58560693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00569403 -0.03935204  0.28498755]
Stock Position:  -0.005694031278029192
Bond Position:  [-4.69571821]


portfolio before change:  [-5.2504491]
curr_Stock_Price:  97.32013388023952
curr_Factors:  [97.32013388 -1.0780705  -0.97785973]
mat_Sqrt:  [[12.45442094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01718553 0.05345765 0.83320985]
Stock Position:  0.017185526015412598
Bond Position:  [-6.92294679]


portfolio before change:  [-5.23601511]
curr_Stock_Price:  98.2103836668814
curr_Factors:  [98.21038367 -1.3011507  -0.99004674]
mat_Sqrt:  [[ 9.93351619  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00855488 -0.01778899  0.16671649]
Stock Position:  -0.00855488285801338
Bond Position:  [-4.39583678]


portfolio before change:  [-5.24326297]
curr_Stock_Price:  98.99336931304738
curr_Factors:  [98.99336931 -1.55318247 -0.95259722]
mat_Sqrt:  [[ 8.07904108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11491657 -0.08723145  0.08555299]
Stock Position:  -0.11491656791883278
Bond Position:  [6.13271527]


portfolio before change:  [-5.27274599]
curr_Stock_Price:  99.25660074794034
curr_Factors:  [99.25660075 -1.5808437  -0.95387663]
mat_Sqrt:  [[ 7.86944936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026032  -0.02855039 -0.32964347]
Stock Position:  -0.0026032011089298455
Bond Position:  [-5.0143611]


portfolio before change:  [-5.2743061]
curr_Stock_Price:  99.6151118986042
curr_Factors:  [99.6151119  -1.55349282 -0.96195298]
mat_Sqrt:  [[ 8.05157785  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296991 -0.0064913  -0.08240317]
Stock Position:  0.0029699061993448267
Bond Position:  [-5.57015364]


portfolio before change:  [-5.27664018]
curr_Stock_Price:  99.06365865552428
curr_Factors:  [99.06365866 -1.35744357 -0.95152462]
mat_Sqrt:  [[ 9.84333395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03102671  0.0421943  -0.26869166]
Stock Position:  0.031026713048583274
Bond Position:  [-8.35025989]


portfolio before change:  [-5.27679865]
curr_Stock_Price:  99.09219440822604
curr_Factors:  [99.09219441 -1.30219024 -0.96496584]
mat_Sqrt:  [[10.26658653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02771953  0.00365755 -0.33670826]
Stock Position:  -0.02771953417558762
Bond Position:  [-2.53000919]


portfolio before change:  [-5.28526292]
curr_Stock_Price:  99.3861383977332
curr_Factors:  [99.3861384  -1.30758881 -0.94970995]
mat_Sqrt:  [[10.39904409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00356489 -0.00450145 -0.1140311 ]
Stock Position:  0.0035648871296971095
Bond Position:  [-5.63956328]


portfolio before change:  [-5.28655125]
curr_Stock_Price:  99.22250228143537
curr_Factors:  [99.22250228 -1.28621606 -0.95155224]
mat_Sqrt:  [[10.58667918  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00347513 -0.072967    0.06097945]
Stock Position:  0.0034751311657098315
Bond Position:  [-5.63136246]


portfolio before change:  [-5.28946655]
curr_Stock_Price:  98.58617031497805
curr_Factors:  [98.58617031 -1.41267635 -0.94365706]
mat_Sqrt:  [[ 9.34272146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129946 -0.0047077  -0.07395765]
Stock Position:  0.0012994635599270555
Bond Position:  [-5.41757569]


portfolio before change:  [-5.28941077]
curr_Stock_Price:  99.1502685332749
curr_Factors:  [99.15026853 -1.44816835 -0.9351496 ]
mat_Sqrt:  [[ 9.14601817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02926541 -0.06892584  0.35940334]
Stock Position:  0.02926541392094077
Bond Position:  [-8.19108441]


portfolio before change:  [-5.28974102]
curr_Stock_Price:  99.17397200744665
curr_Factors:  [99.17397201 -1.36238531 -0.9588827 ]
mat_Sqrt:  [[ 9.73383136  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00842159 -0.00370033 -0.11527784]
Stock Position:  0.008421589983299553
Bond Position:  [-6.12494355]


portfolio before change:  [-5.29573304]
curr_Stock_Price:  98.55338289732282
curr_Factors:  [98.5533829  -1.16999022 -0.95752312]
mat_Sqrt:  [[11.7409769   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328001 -0.0003261   0.04435073]
Stock Position:  -0.0032800141983774294
Bond Position:  [-4.97247654]


portfolio before change:  [-5.29791998]
curr_Stock_Price:  99.03062172496139
curr_Factors:  [99.03062172 -1.21325188 -0.93654905]
mat_Sqrt:  [[11.5377951   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270794 -0.02064149  0.01427388]
Stock Position:  -0.002707942160283325
Bond Position:  [-5.02975079]


portfolio before change:  [-5.29947256]
curr_Stock_Price:  99.3717727985279
curr_Factors:  [99.3717728  -1.1337765  -0.97590095]
mat_Sqrt:  [[12.05151827  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03639693 -0.08363896  0.35193655]
Stock Position:  -0.03639692660191977
Bond Position:  [-1.68264544]


portfolio before change:  [-5.30725694]
curr_Stock_Price:  99.57986839727856
curr_Factors:  [99.5798684  -0.81605389 -0.99317075]
mat_Sqrt:  [[16.30929812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01150747 -0.00872213 -0.0795875 ]
Stock Position:  -0.011507471175892693
Bond Position:  [-4.16134448]


portfolio before change:  [-5.31607509]
curr_Stock_Price:  100.30096037119641
curr_Factors:  [100.30096037  -0.83951522  -0.98316194]
mat_Sqrt:  [[16.20788904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02438351 0.38448871 1.14333332]
Stock Position:  0.024383512683313173
Bond Position:  [-7.76176483]


portfolio before change:  [-5.31771838]
curr_Stock_Price:  100.27335932197322
curr_Factors:  [100.27335932  -0.62568999  -0.97921208]
mat_Sqrt:  [[20.14584319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00340576 -0.00488864  0.22970768]
Stock Position:  -0.0034057568751205045
Bond Position:  [-4.9762117]


portfolio before change:  [-5.32145491]
curr_Stock_Price:  101.1878289975159
curr_Factors:  [101.187829    -0.55299234  -0.98553389]
mat_Sqrt:  [[21.72475186  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268542  0.01916426 -0.05064057]
Stock Position:  -0.0026854202968085417
Bond Position:  [-5.04972306]


portfolio before change:  [-5.33235373]
curr_Stock_Price:  105.0112784764311
curr_Factors:  [105.01127848  -0.63993049  -1.00310613]
mat_Sqrt:  [[20.30832977  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191394  0.01916992 -0.08961985]
Stock Position:  -0.0019139369963788488
Bond Position:  [-5.13136876]


portfolio before change:  [-5.32975352]
curr_Stock_Price:  103.31755757664074
curr_Factors:  [103.31755758  -0.71409655  -0.99389821]
mat_Sqrt:  [[18.72412061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01060422 -0.00882903  0.48167837]
Stock Position:  0.010604216792521924
Bond Position:  [-6.4253553]


portfolio before change:  [-5.33485071]
curr_Stock_Price:  102.91262694532013
curr_Factors:  [102.91262695  -0.53223646  -0.9746067 ]
mat_Sqrt:  [[22.80630849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00332793 -0.00490755 -0.1129745 ]
Stock Position:  0.0033279279736526807
Bond Position:  [-5.67733652]


portfolio before change:  [-5.32990666]
curr_Stock_Price:  104.61150922651515
curr_Factors:  [104.61150923  -0.6803282   -0.98325569]
mat_Sqrt:  [[19.8195672   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00395053  0.06295982  0.46533299]
Stock Position:  -0.003950532878838408
Bond Position:  [-4.91663546]


portfolio before change:  [-5.3320024]
curr_Stock_Price:  104.98642658981403
curr_Factors:  [104.98642659  -1.02221961  -0.98260059]
mat_Sqrt:  [[14.1400454   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00130501 0.0195908  0.0469127 ]
Stock Position:  0.0013050065138282868
Bond Position:  [-5.46901038]


portfolio before change:  [-5.33138362]
curr_Stock_Price:  105.98447083813784
curr_Factors:  [105.98447084  -1.12773263  -0.96251724]
mat_Sqrt:  [[13.10564054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00672771 -0.04389046  0.81374103]
Stock Position:  -0.006727706400145416
Bond Position:  [-4.61835122]


portfolio before change:  [-5.32441321]
curr_Stock_Price:  104.86258130994366
curr_Factors:  [104.86258131  -0.99656863  -0.9712038 ]
mat_Sqrt:  [[14.6564178   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00423819  0.02140865 -0.23262289]
Stock Position:  0.004238191563133902
Bond Position:  [-5.76884091]


portfolio before change:  [-5.32253748]
curr_Stock_Price:  105.47531450481279
curr_Factors:  [105.4753145   -0.97919933  -0.96520011]
mat_Sqrt:  [[15.09068247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06584222 -0.04827761 -3.24036224]
Stock Position:  -0.06584222344716525
Bond Position:  [1.62219175]


portfolio before change:  [-5.29645531]
curr_Stock_Price:  105.08226308566783
curr_Factors:  [105.08226309  -0.99799401  -0.97818465]
mat_Sqrt:  [[14.56417634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0040512   0.00020554  0.12351564]
Stock Position:  -0.004051200864131296
Bond Position:  [-4.87074595]


portfolio before change:  [-5.2901468]
curr_Stock_Price:  103.37477059305141
curr_Factors:  [103.37477059  -0.82630026  -0.9671645 ]
mat_Sqrt:  [[17.19977281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135686 -0.00401446  0.32063205]
Stock Position:  0.0013568571019582825
Bond Position:  [-5.43041159]


portfolio before change:  [-5.29088343]
curr_Stock_Price:  103.33218090560682
curr_Factors:  [103.33218091  -1.02616766  -0.97751954]
mat_Sqrt:  [[13.93302138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00142844 0.01775376 0.02565115]
Stock Position:  0.0014284357037198333
Bond Position:  [-5.4384868]


portfolio before change:  [-5.2907659]
curr_Stock_Price:  103.89040223476078
curr_Factors:  [103.89040223  -0.85251025  -1.00904905]
mat_Sqrt:  [[16.14769347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00861918 -0.00344017 -0.22337538]
Stock Position:  -0.008619181245446018
Bond Position:  [-4.39531569]


portfolio before change:  [-5.29453624]
curr_Stock_Price:  104.26409119783942
curr_Factors:  [104.2640912   -0.91701877  -1.03593598]
mat_Sqrt:  [[14.79031046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245217  0.03087239  0.31502507]
Stock Position:  -0.0024521705751496823
Bond Position:  [-5.0388629]


portfolio before change:  [-5.29557844]
curr_Stock_Price:  104.4322278078181
curr_Factors:  [104.43222781  -1.00101778  -1.05436185]
mat_Sqrt:  [[13.37194283  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01100317 -0.05164627 -0.27327348]
Stock Position:  0.011003170186489122
Bond Position:  [-6.44466401]


portfolio before change:  [-5.29225027]
curr_Stock_Price:  104.807919706061
curr_Factors:  [104.80791971  -0.96327746  -1.00977372]
mat_Sqrt:  [[14.57165436  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.91108414e-05 7.34815209e-02 2.36174647e-01]
Stock Position:  4.9110841395884e-05
Bond Position:  [-5.29739747]


portfolio before change:  [-5.29293236]
curr_Stock_Price:  104.4032676157886
curr_Factors:  [104.40326762  -0.78536027  -1.01232832]
mat_Sqrt:  [[17.29767987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0031915   0.01774186 -0.10271957]
Stock Position:  0.003191497451004231
Bond Position:  [-5.62613512]


portfolio before change:  [-5.28872123]
curr_Stock_Price:  105.94312188799495
curr_Factors:  [105.94312189  -0.97856574  -1.04445411]
mat_Sqrt:  [[14.01155745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238125  0.02456927 -0.02581505]
Stock Position:  -0.002381249248907345
Bond Position:  [-5.03644425]


portfolio before change:  [-5.28992531]
curr_Stock_Price:  106.18437617830915
curr_Factors:  [106.18437618  -0.96887234  -1.02820763]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.28992531]
Stock Price:  106.15555486384099
PL:  [-11.44548017]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-8.04768486e-02 -1.49156390e-02 -9.30454644e-03]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.75595082e-01  1.51496787e-01  1.75087167e-01]
 [ 4.58230167e-03  4.58045492e-02  1.36844960e-01]
 [-5.16552606e-01 -1.59468518e-01  4.00303716e-02]
 [ 8.57636297e-03 -1.20819346e-01 -1.51486002e-01]
 [ 3.54294195e-02  3.23490945e-02 -1.58669208e-02]
 [ 1.91390832e-01  8.32993588e-02 -4.02845748e-02]
 [-3.59039427e-01 -9.12826658e-03 -7.46056211e-02]
 [ 5.74581048e-02 -3.21345563e-02 -5.77858680e-02]
 [ 6.60714273e-02 -2.77217145e-01  2.30914728e-02]
 [ 1.96047996e-02 -9.73860045e-03 -1.28014263e-02]
 [ 1.84302732e-01 -1.46963188e-01  1.57773673e-01]
 [ 8.93317155e-02 -5.48040696e-02 -6.11219820e-02]
 [ 6.35448275e-02 -1.09498871e-01 -6.16522680e-02]
 [-4.51891874e-02  1.68868355e-02  3.00997339e-02]
 [-4.00757841e-01 -2.35286749e-01  9.89381234e-02]
 [-1.85081942e-01 -3.33933737e-03 -3.37024253e-02]
 [ 3.23990547e-01  1.36484808e+00  4.78838712e-01]
 [-1.80444664e-01 -2.77833906e-02  1.40770220e-01]
 [-5.39649497e-02  7.79482992e-02 -1.34938377e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.11627903e-01 -3.78631148e-02  1.29877092e-01]
 [ 7.60758262e-02  2.11809832e-01  5.39358679e-02]
 [-6.78516965e-02 -1.31215902e-01  1.74726002e-01]
 [ 1.46376471e-02  6.30392978e-02 -9.75428626e-03]
 [ 4.49111323e-02 -5.87164563e-02  2.06583579e-01]
 [ 6.11238596e-02  6.27647997e-02 -7.62885377e-02]
 [-7.00725119e-01 -1.50564625e-01 -1.10000053e+00]
 [-2.30891514e-01  3.60122785e-02  4.86554587e-02]
 [-2.56663507e-02  6.64671691e-02  1.80400129e-01]
 [ 1.85490418e-02  7.70618993e-02 -1.31902729e-03]
 [-1.22657862e-01 -1.07628115e-02 -7.72530117e-02]
 [-6.05612744e-02  1.16043785e-01  1.22109685e-01]
 [ 1.77172522e-01 -1.64635913e-01 -9.37102332e-02]
 [-2.01920788e-02  2.21193671e-01  8.24180514e-02]
 [ 2.72787634e-02  2.69614108e-02 -4.24719246e-02]
 [-5.01860553e-02  8.99378678e-02 -7.34840854e-03]
 [-8.34707543e-02 -2.08020447e-01  6.33408815e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.0913195]
curr_Stock_Price:  100.23735714222231
curr_Factors:  [100.23735714  -1.08873476  -1.01639734]
mat_Sqrt:  [[12.21187503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00677711 -0.00471674 -0.02654328]
Stock Position:  -0.006777112532993231
Bond Position:  [4.77063935]


portfolio before change:  [4.09308915]
curr_Stock_Price:  100.06423226145091
curr_Factors:  [100.06423226  -1.14684911  -1.02015724]
mat_Sqrt:  [[11.45934962  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00396018  0.01411938  0.0859571 ]
Stock Position:  -0.003960176130043654
Bond Position:  [4.48936113]


portfolio before change:  [4.09232679]
curr_Stock_Price:  100.39844989144238
curr_Factors:  [100.39844989  -0.89766094  -1.01727309]
mat_Sqrt:  [[14.79386752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02130925 0.04790749 0.49947495]
Stock Position:  0.02130925061810059
Bond Position:  [1.95291106]


portfolio before change:  [4.07893382]
curr_Stock_Price:  99.75848812186707
curr_Factors:  [99.75848812 -0.59198344 -1.0313481 ]
mat_Sqrt:  [[19.67641301  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00171263 0.01448467 0.39038058]
Stock Position:  0.0017126256954550095
Bond Position:  [3.90808487]


portfolio before change:  [4.07924537]
curr_Stock_Price:  99.65514188331815
curr_Factors:  [99.65514188 -0.82078615 -1.02046963]
mat_Sqrt:  [[15.80711047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03242205 -0.05042837  0.11419551]
Stock Position:  -0.03242204836474452
Bond Position:  [7.3102692]


portfolio before change:  [4.08338086]
curr_Stock_Price:  99.5557757512197
curr_Factors:  [99.55577575 -0.57302811 -1.02401245]
mat_Sqrt:  [[20.15953704  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126318 -0.03820643 -0.4321474 ]
Stock Position:  -0.001263180291277594
Bond Position:  [4.20913775]


portfolio before change:  [4.08294545]
curr_Stock_Price:  100.31701584795186
curr_Factors:  [100.31701585  -0.66008209  -1.01079973]
mat_Sqrt:  [[18.86773852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175039  0.01022968 -0.04526391]
Stock Position:  0.0017503871915829224
Bond Position:  [3.90735183]


portfolio before change:  [4.08146691]
curr_Stock_Price:  99.19326976771086
curr_Factors:  [99.19326977 -0.72428888 -0.99947024]
mat_Sqrt:  [[17.69551204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01047263  0.02634157 -0.11492068]
Stock Position:  0.010472630452555589
Bond Position:  [3.04265245]


portfolio before change:  [4.08500909]
curr_Stock_Price:  99.49518322034987
curr_Factors:  [99.49518322 -0.73623237 -0.99646191]
mat_Sqrt:  [[17.59148445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02128893 -0.00288661 -0.21282907]
Stock Position:  -0.02128893255455867
Bond Position:  [6.20315534]


portfolio before change:  [4.08630519]
curr_Stock_Price:  99.47072668024852
curr_Factors:  [99.47072668 -0.74940008 -1.01570914]
mat_Sqrt:  [[17.02621437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00263317 -0.01016184 -0.164847  ]
Stock Position:  0.0026331691949429805
Bond Position:  [3.82438194]


portfolio before change:  [4.08519269]
curr_Stock_Price:  98.86667209968648
curr_Factors:  [98.8666721  -0.84294479 -1.04227881]
mat_Sqrt:  [[15.00747776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0042397  -0.08766376  0.06587354]
Stock Position:  0.004239702338038787
Bond Position:  [3.66602743]


portfolio before change:  [4.08687921]
curr_Stock_Price:  99.15637158107833
curr_Factors:  [99.15637158 -0.83771096 -1.07674757]
mat_Sqrt:  [[14.61779449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011452  -0.00307962 -0.03651891]
Stock Position:  0.0011451980537316793
Bond Position:  [3.97332553]


portfolio before change:  [4.08769419]
curr_Stock_Price:  99.43429447209353
curr_Factors:  [99.43429447 -0.82626333 -1.10035545]
mat_Sqrt:  [[14.48159158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01468855 -0.04647384  0.45008437]
Stock Position:  0.014688549532882452
Bond Position:  [2.62714863]


portfolio before change:  [4.08443038]
curr_Stock_Price:  99.1897354948084
curr_Factors:  [99.18973549 -1.02240415 -1.08393101]
mat_Sqrt:  [[12.06971438  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00625037 -0.01733057 -0.174364  ]
Stock Position:  0.006250372276920672
Bond Position:  [3.46445761]


portfolio before change:  [4.08915504]
curr_Stock_Price:  99.87634573198513
curr_Factors:  [99.87634573 -0.86202175 -1.07111942]
mat_Sqrt:  [[14.45140597  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00333067 -0.03462658 -0.17587676]
Stock Position:  0.003330669863429109
Bond Position:  [3.7564999]


portfolio before change:  [4.08923173]
curr_Stock_Price:  99.75838296215328
curr_Factors:  [99.75838296 -0.8952468  -1.06347584]
mat_Sqrt:  [[14.06976889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00274412  0.00534009  0.08586616]
Stock Position:  -0.0027441167636604777
Bond Position:  [4.36298038]


portfolio before change:  [4.08923194]
curr_Stock_Price:  99.95706169953968
curr_Factors:  [99.9570617  -0.65899737 -1.08307251]
mat_Sqrt:  [[17.50822598  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02208318 -0.0744042   0.28224293]
Stock Position:  -0.022083177329312895
Bond Position:  [6.29660146]


portfolio before change:  [4.11642694]
curr_Stock_Price:  98.76122521031398
curr_Factors:  [98.76122521 -0.80461034 -1.09186819]
mat_Sqrt:  [[14.82368951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01295545 -0.00105599 -0.09614364]
Stock Position:  -0.012955454967735515
Bond Position:  [5.39592354]


portfolio before change:  [4.10554607]
curr_Stock_Price:  99.65315813477146
curr_Factors:  [99.65315813 -0.87764645 -1.09853036]
mat_Sqrt:  [[13.81173956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03308586 0.43160286 1.36599356]
Stock Position:  0.03308586246191499
Bond Position:  [0.80843539]


portfolio before change:  [4.09266167]
curr_Stock_Price:  99.26068061050029
curr_Factors:  [99.26068061 -0.4698684  -1.09434784]
mat_Sqrt:  [[20.77049123  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00733865 -0.00878588  0.40157825]
Stock Position:  -0.007338652994896128
Bond Position:  [4.82110137]


portfolio before change:  [4.07854389]
curr_Stock_Price:  101.26656036266264
curr_Factors:  [101.26656036  -0.47261174  -1.0823504 ]
mat_Sqrt:  [[21.38723201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255792  0.02464942 -0.03849416]
Stock Position:  -0.002557916393033165
Bond Position:  [4.33757529]


portfolio before change:  [4.07499562]
curr_Stock_Price:  102.86571654950102
curr_Factors:  [102.86571655  -0.49076633  -1.03728981]
mat_Sqrt:  [[22.31743629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174164  0.01916992 -0.08961985]
Stock Position:  -0.00174163659267688
Bond Position:  [4.25415031]


portfolio before change:  [4.07710101]
curr_Stock_Price:  101.96220356159877
curr_Factors:  [101.96220356  -0.36835919  -1.04227192]
mat_Sqrt:  [[24.87768167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00551343 -0.01197337  0.37050319]
Stock Position:  0.005513428998438898
Bond Position:  [3.51493964]


portfolio before change:  [4.07042656]
curr_Stock_Price:  100.67192720905936
curr_Factors:  [100.67192721  -0.42980926  -1.0228586 ]
mat_Sqrt:  [[23.55172647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00392983 0.06698015 0.15386402]
Stock Position:  0.003929832726882211
Bond Position:  [3.67480272]


portfolio before change:  [4.07942965]
curr_Stock_Price:  102.84599256115608
curr_Factors:  [102.84599256  -0.35859394  -1.03190326]
mat_Sqrt:  [[25.60366343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138941 -0.04149411  0.49844465]
Stock Position:  -0.0013894058890571788
Bond Position:  [4.22232448]


portfolio before change:  [4.07926509]
curr_Stock_Price:  103.34432733669108
curr_Factors:  [103.34432734  -0.35389853  -1.03635253]
mat_Sqrt:  [[25.73405799  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00055468  0.01993478 -0.02782626]
Stock Position:  0.0005546824151059686
Bond Position:  [4.0219418]


portfolio before change:  [4.07985097]
curr_Stock_Price:  103.49415895571408
curr_Factors:  [103.49415896  -0.35002181  -1.01907988]
mat_Sqrt:  [[26.32222094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00325063 -0.01856777  0.58932545]
Stock Position:  0.0032506290637275602
Bond Position:  [3.74342985]


portfolio before change:  [4.08266932]
curr_Stock_Price:  104.21721794841447
curr_Factors:  [104.21721795  -0.51675424  -1.02465948]
mat_Sqrt:  [[22.31063869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00211433  0.01984797 -0.21762996]
Stock Position:  0.002114332443068874
Bond Position:  [3.86231948]


portfolio before change:  [4.08070409]
curr_Stock_Price:  103.0593781855305
curr_Factors:  [103.05937819  -0.56910008  -1.0526876 ]
mat_Sqrt:  [[20.35888905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04563851 -0.04761272 -3.13799533]
Stock Position:  -0.04563850936543055
Bond Position:  [8.78418048]


portfolio before change:  [4.09272565]
curr_Stock_Price:  102.82003055089156
curr_Factors:  [102.82003055  -0.47427113  -1.02602056]
mat_Sqrt:  [[22.93555867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0095934   0.01138808  0.13880048]
Stock Position:  -0.009593397327923768
Bond Position:  [5.07911905]


portfolio before change:  [4.10451653]
curr_Stock_Price:  101.657151761931
curr_Factors:  [101.65715176  -0.42042451  -1.00650389]
mat_Sqrt:  [[24.40230246  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00052757 0.02101876 0.51463136]
Stock Position:  0.0005275668767644366
Bond Position:  [4.05088559]


portfolio before change:  [4.10509881]
curr_Stock_Price:  101.80098088666676
curr_Factors:  [101.80098089  -0.56670356  -1.02111109]
mat_Sqrt:  [[20.8052444   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00097425  0.02436911 -0.00376282]
Stock Position:  0.000974250805785637
Bond Position:  [4.00591912]


portfolio before change:  [4.10744319]
curr_Stock_Price:  103.69332340286161
curr_Factors:  [103.6933234   -0.62164852  -1.02897197]
mat_Sqrt:  [[19.90194032  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00696942 -0.0034035  -0.22038134]
Stock Position:  -0.006969419018629737
Bond Position:  [4.83012541]


portfolio before change:  [4.10217594]
curr_Stock_Price:  104.53572621365495
curr_Factors:  [104.53572621  -0.87565187  -1.04640165]
mat_Sqrt:  [[15.29422607  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213411  0.03669627  0.34834494]
Stock Position:  -0.0021341061366517053
Bond Position:  [4.32526627]


portfolio before change:  [4.10327635]
curr_Stock_Price:  104.27345410299895
curr_Factors:  [104.2734541   -0.84386143  -1.04356824]
mat_Sqrt:  [[15.79332121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00973786 -0.05206245 -0.26732921]
Stock Position:  0.0097378580188398
Bond Position:  [3.08787626]


portfolio before change:  [4.1078208]
curr_Stock_Price:  104.70049345059999
curr_Factors:  [104.70049345  -0.98976906  -1.03556827]
mat_Sqrt:  [[13.81515958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.69569632e-04 6.99475804e-02 2.35115760e-01]
Stock Position:  0.00016956963206263888
Bond Position:  [4.09006678]


portfolio before change:  [4.10818476]
curr_Stock_Price:  103.83160812150781
curr_Factors:  [103.83160812  -1.00670798  -1.03359004]
mat_Sqrt:  [[13.49706721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00143034  0.00852595 -0.12116058]
Stock Position:  0.0014303373014915924
Bond Position:  [3.95967054]


portfolio before change:  [4.11051823]
curr_Stock_Price:  105.11695829145438
curr_Factors:  [105.11695829  -1.17112166  -1.04722293]
mat_Sqrt:  [[11.43557406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00431669  0.02844085 -0.02096296]
Stock Position:  -0.004316692530684594
Bond Position:  [4.56427582]


portfolio before change:  [4.11253922]
curr_Stock_Price:  104.78095694279149
curr_Factors:  [104.78095694  -1.10605032  -1.03544641]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.11253922]
Stock Price:  104.45897131365945
PL:  [-0.3464321]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.57859342e-02  7.05804722e-03  2.57378880e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.90887999e-01  1.91102409e-01  2.29388376e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.02810329e+00 -3.04371233e-01  2.75293869e-02]
 [-4.86339764e-02 -1.10811412e-02  1.49333525e-02]
 [ 1.64874898e-02  1.17382650e-01  3.36710042e-02]
 [ 3.44073550e-01 -1.43277097e-02 -8.80223235e-02]
 [-5.02523227e-01 -2.84658876e-02 -5.70184840e-02]
 [ 2.15944483e-02  2.65452312e-02 -2.08634427e-02]
 [-1.21994285e-02 -2.18329785e-01  1.13260279e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.07788437e-01 -2.25926914e-02  2.72805194e-01]
 [ 3.82944789e-02  2.77108662e-01  2.29175815e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-1.60408938e-02 -7.07457187e-03  3.62688371e-02]
 [-5.57353845e-01 -2.75343712e-01  1.62556661e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 3.32995809e-01  1.28711717e+00  5.59790511e-01]
 [ 6.24962332e-04  2.04462291e-02  2.92107455e-02]
 [-5.30785270e-02 -1.25998891e-01 -2.29495231e-02]
 [-5.02235029e-03  4.38608748e-02 -1.15854594e-02]
 [ 4.23638572e-02 -3.26775056e-02  6.04920416e-02]
 [ 3.58182861e-02  8.38230052e-02  8.87229463e-02]
 [-5.89160387e-02 -1.49937190e-01 -4.18609954e-02]
 [ 5.80972819e-02  3.51931474e-02 -1.48008126e-02]
 [-1.13756233e-02 -9.66143482e-03 -4.30034568e-02]
 [ 2.42801879e-03  4.24761129e-02 -6.56928193e-02]
 [-5.62926017e-01  1.75489227e-02 -7.85833896e-01]
 [-1.22930532e-01 -5.93498342e-02  3.06147252e-03]
 [-6.77210924e-02  8.30126133e-02  1.86945720e-01]
 [ 1.32434603e-02  5.00774161e-02  1.13238257e-02]
 [-1.27770192e-01 -1.09381148e-02 -1.42341463e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 1.73115357e-01 -1.41482913e-01 -5.51920378e-02]
 [ 1.57039837e-02  3.17320574e-02  6.85988101e-02]
 [-1.92057154e-02 -2.61990082e-02 -4.27681800e-02]
 [-9.98635088e-02 -2.20602861e-02  2.46882558e-03]
 [-2.85249381e-02 -3.18810116e-01  1.42684254e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.76407575]
curr_Stock_Price:  100.1917622824315
curr_Factors:  [100.19176228  -0.92193795  -0.96088026]
mat_Sqrt:  [[15.24524678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00592644  0.00223195  0.07342303]
Stock Position:  -0.005926435503524426
Bond Position:  [4.35785577]


portfolio before change:  [3.76645074]
curr_Stock_Price:  99.88293846909163
curr_Factors:  [99.88293847 -0.78630094 -0.97626768]
mat_Sqrt:  [[17.140263    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264763  0.01411938  0.0859571 ]
Stock Position:  -0.002647628151892662
Bond Position:  [4.03090362]


portfolio before change:  [3.76565653]
curr_Stock_Price:  100.37322853539949
curr_Factors:  [100.37322854  -0.85064059  -0.99301989]
mat_Sqrt:  [[15.88277275  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02157343 0.06043189 0.65438119]
Stock Position:  0.021573433904985086
Bond Position:  [1.60026132]


portfolio before change:  [3.78445261]
curr_Stock_Price:  101.23521640955863
curr_Factors:  [101.23521641  -1.17029557  -1.00594952]
mat_Sqrt:  [[11.48683495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171527 -0.00659539  0.21422481]
Stock Position:  0.0017152726576556293
Bond Position:  [3.61080662]


portfolio before change:  [3.78331548]
curr_Stock_Price:  100.3091175185022
curr_Factors:  [100.30911752  -1.36069425  -0.99959204]
mat_Sqrt:  [[ 9.46849812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10881797 -0.09625064  0.07853368]
Stock Position:  -0.10881796632891938
Bond Position:  [14.69874965]


portfolio before change:  [3.73703028]
curr_Stock_Price:  100.75134836875719
curr_Factors:  [100.75134837  -1.24164881  -0.98058148]
mat_Sqrt:  [[10.91813636  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00420143 -0.00350416  0.0426007 ]
Stock Position:  -0.004201434285277093
Bond Position:  [4.16033045]


portfolio before change:  [3.73526329]
curr_Stock_Price:  101.29570189646778
curr_Factors:  [101.2957019   -1.53861705  -0.98797172]
mat_Sqrt:  [[ 8.09668899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00325953 0.03711965 0.096054  ]
Stock Position:  0.0032595251990891355
Bond Position:  [3.40508739]


portfolio before change:  [3.73484263]
curr_Stock_Price:  101.03605700255838
curr_Factors:  [101.036057    -1.25055163  -1.00489696]
mat_Sqrt:  [[10.59125713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03075519 -0.00453082 -0.25110319]
Stock Position:  0.030755190285406204
Bond Position:  [0.62745947]


portfolio before change:  [3.74309768]
curr_Stock_Price:  101.30191833660182
curr_Factors:  [101.30191834  -1.03466934  -1.01280849]
mat_Sqrt:  [[13.07402609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03938321 -0.0090017  -0.16265786]
Stock Position:  -0.03938320596630446
Bond Position:  [7.732692]


portfolio before change:  [3.71726365]
curr_Stock_Price:  101.98242874526866
curr_Factors:  [101.98242875  -1.11992872  -1.02463817]
mat_Sqrt:  [[11.94405476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150879  0.00839434 -0.05951759]
Stock Position:  0.0015087933864345133
Bond Position:  [3.56339323]


portfolio before change:  [3.71707055]
curr_Stock_Price:  101.559207356266
curr_Factors:  [101.55920736  -1.19978318  -1.04390221]
mat_Sqrt:  [[10.77206877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00049039 -0.06904194  0.32310005]
Stock Position:  0.000490386618735135
Bond Position:  [3.66726727]


portfolio before change:  [3.71784504]
curr_Stock_Price:  102.2037044645305
curr_Factors:  [102.20370446  -1.24697426  -1.03532262]
mat_Sqrt:  [[10.42984115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00691531  0.00225658  0.15019092]
Stock Position:  -0.006915313242308042
Bond Position:  [4.42461567]


portfolio before change:  [3.7167715]
curr_Stock_Price:  102.4389281503219
curr_Factors:  [102.43892815  -1.27260237  -1.03766722]
mat_Sqrt:  [[10.1654754   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01602397 -0.00714444  0.77823729]
Stock Position:  0.016023965096685133
Bond Position:  [2.07529369]


portfolio before change:  [3.70961195]
curr_Stock_Price:  101.9759353438001
curr_Factors:  [101.97593534  -1.46783221  -1.01592261]
mat_Sqrt:  [[ 8.5077885   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01084062 0.08762945 0.65377481]
Stock Position:  0.010840621050894754
Bond Position:  [2.60412948]


portfolio before change:  [3.71302807]
curr_Stock_Price:  102.26102866058993
curr_Factors:  [102.26102866  -1.39030264  -1.01901005]
mat_Sqrt:  [[ 9.1909193   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00467049 -0.03587186 -0.12433753]
Stock Position:  0.004670494022003219
Bond Position:  [3.23541855]


portfolio before change:  [3.71308199]
curr_Stock_Price:  102.18597530283301
curr_Factors:  [102.1859753   -1.44875815  -1.01389327]
mat_Sqrt:  [[ 8.70713687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101299 -0.00223718  0.1034649 ]
Stock Position:  -0.0010129866140615202
Bond Position:  [3.81659502]


portfolio before change:  [3.71370726]
curr_Stock_Price:  102.0397075793546
curr_Factors:  [102.03970758  -1.51372704  -1.0508256 ]
mat_Sqrt:  [[ 7.85232278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06765915 -0.08707133  0.46372891]
Stock Position:  -0.06765914545019547
Bond Position:  [10.61762668]


portfolio before change:  [3.73191194]
curr_Stock_Price:  101.79026034463546
curr_Factors:  [101.79026034  -1.37432888  -1.05232188]
mat_Sqrt:  [[ 8.99135595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01460415  0.00580111 -0.05715682]
Stock Position:  -0.014604146973506206
Bond Position:  [5.21847186]


portfolio before change:  [3.74136859]
curr_Stock_Price:  101.18739677887136
curr_Factors:  [101.18739678  -1.39709533  -1.0384765 ]
mat_Sqrt:  [[ 8.8587209   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05423986 0.40702219 1.59692651]
Stock Position:  0.054239861109212736
Bond Position:  [-1.74702175]


portfolio before change:  [3.75837093]
curr_Stock_Price:  101.50488888632698
curr_Factors:  [101.50488889  -1.41439326  -1.03488949]
mat_Sqrt:  [[ 8.76550569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00081176 0.00646567 0.08333013]
Stock Position:  0.0008117615110077162
Bond Position:  [3.67597317]


portfolio before change:  [3.75878815]
curr_Stock_Price:  101.45277501640618
curr_Factors:  [101.45277502  -1.19514769  -1.03098748]
mat_Sqrt:  [[10.95130085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00557161 -0.03984435 -0.0654686 ]
Stock Position:  -0.005571608066445605
Bond Position:  [4.32404325]


portfolio before change:  [3.76101129]
curr_Stock_Price:  101.15077937971759
curr_Factors:  [101.15077938  -1.45252383  -1.04160068]
mat_Sqrt:  [[ 8.35188911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007489   0.01387003 -0.03305009]
Stock Position:  -0.000748901150850411
Bond Position:  [3.83676323]


portfolio before change:  [3.76172749]
curr_Stock_Price:  100.8348866348299
curr_Factors:  [100.83488663  -1.41415111  -1.05480254]
mat_Sqrt:  [[ 8.53803373  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00630918 -0.01033353  0.17256696]
Stock Position:  0.006309182601583304
Bond Position:  [3.12554178]


portfolio before change:  [3.75953749]
curr_Stock_Price:  100.4258445811402
curr_Factors:  [100.42584458  -1.68217985  -1.0600552 ]
mat_Sqrt:  [[ 6.4700546   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00866965 0.02650716 0.25310187]
Stock Position:  0.008669645904079934
Bond Position:  [2.88888097]


portfolio before change:  [3.75869829]
curr_Stock_Price:  100.28739284175643
curr_Factors:  [100.28739284  -1.43112918  -1.07330122]
mat_Sqrt:  [[ 8.19569967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00870362 -0.0474143  -0.11941777]
Stock Position:  -0.008703618123645215
Bond Position:  [4.63156146]


portfolio before change:  [3.75712948]
curr_Stock_Price:  100.5341632338872
curr_Factors:  [100.53416323  -1.19984547  -1.08508457]
mat_Sqrt:  [[10.23248605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00547128  0.01112905 -0.0422226 ]
Stock Position:  0.005471276636364972
Bond Position:  [3.20707926]


portfolio before change:  [3.75591852]
curr_Stock_Price:  100.23955738649256
curr_Factors:  [100.23955739  -1.29293485  -1.07609493]
mat_Sqrt:  [[ 9.37956246  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217527 -0.00305521 -0.12267689]
Stock Position:  -0.002175274638381519
Bond Position:  [3.97396708]


portfolio before change:  [3.7556212]
curr_Stock_Price:  100.60461221201294
curr_Factors:  [100.60461221  -1.38894384  -1.0657961 ]
mat_Sqrt:  [[ 8.64048029  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001144    0.01343213 -0.18740333]
Stock Position:  -0.0011440039157256184
Bond Position:  [3.87071327]


portfolio before change:  [3.75579649]
curr_Stock_Price:  100.87434786722766
curr_Factors:  [100.87434787  -1.37642405  -1.06869491]
mat_Sqrt:  [[ 8.74740163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08263946  0.00554946 -2.24176537]
Stock Position:  -0.08263946349995033
Bond Position:  [12.09199848]


portfolio before change:  [3.80205366]
curr_Stock_Price:  100.33289258851333
curr_Factors:  [100.33289259  -1.29241043  -1.07552693]
mat_Sqrt:  [[ 9.39855754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01317628 -0.01876807  0.00873353]
Stock Position:  -0.013176279166421438
Bond Position:  [5.12406786]


portfolio before change:  [3.81655656]
curr_Stock_Price:  99.28082395257937
curr_Factors:  [99.28082395 -0.79183745 -1.06815489]
mat_Sqrt:  [[15.45542552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177398  0.02625089  0.5333041 ]
Stock Position:  -0.001773977734624389
Bond Position:  [3.99267853]


portfolio before change:  [3.81473613]
curr_Stock_Price:  100.58836222284899
curr_Factors:  [100.58836222  -0.82498546  -1.07584811]
mat_Sqrt:  [[15.03232671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00112078 0.01583587 0.03230372]
Stock Position:  0.0011207792474461097
Bond Position:  [3.70199878]


portfolio before change:  [3.814108]
curr_Stock_Price:  99.61501199751163
curr_Factors:  [99.615012   -0.94978702 -1.08796883]
mat_Sqrt:  [[12.98191233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01210206 -0.00345894 -0.40606057]
Stock Position:  -0.012102064612022406
Bond Position:  [5.01965531]


portfolio before change:  [3.81360828]
curr_Stock_Price:  99.70815433013452
curr_Factors:  [99.70815433 -1.12877768 -1.07564407]
mat_Sqrt:  [[10.99923482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00476521  0.0049611   0.16678008]
Stock Position:  -0.004765213618941021
Bond Position:  [4.28873893]


portfolio before change:  [3.81310363]
curr_Stock_Price:  99.92656445200046
curr_Factors:  [99.92656445 -1.45911707 -1.05481688]
mat_Sqrt:  [[ 8.08897162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01955703 -0.04474083 -0.15744752]
Stock Position:  0.019557029469414986
Bond Position:  [1.85883687]


portfolio before change:  [3.81582063]
curr_Stock_Price:  100.05360978049231
curr_Factors:  [100.05360978  -1.30709432  -1.07099379]
mat_Sqrt:  [[ 9.27774049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00329024 0.01003456 0.19569331]
Stock Position:  0.003290238111598805
Bond Position:  [3.48662043]


portfolio before change:  [3.81762965]
curr_Stock_Price:  100.4709541229754
curr_Factors:  [100.47095412  -1.28168033  -1.05793623]
mat_Sqrt:  [[ 9.6818414   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295524 -0.00828485 -0.12200571]
Stock Position:  -0.002955242492908642
Bond Position:  [4.11454568]


portfolio before change:  [3.81739327]
curr_Stock_Price:  100.72498817417532
curr_Factors:  [100.72498817  -1.3681083   -1.05178869]
mat_Sqrt:  [[ 8.95755147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01115586 -0.00697607  0.00704287]
Stock Position:  -0.011155856183010885
Bond Position:  [4.94106675]


portfolio before change:  [3.82049357]
curr_Stock_Price:  100.50244733372396
curr_Factors:  [100.50244733  -1.42178637  -1.04403827]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.82049357]
Stock Price:  100.47268970657025
PL:  [3.34780387]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-5.91144073e-02  2.43248770e-02  2.72743696e-03]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.62695605e-01  1.30411789e-01  1.48861412e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-8.31967687e-01 -2.48813529e-01  3.23224373e-02]
 [-4.52092083e-02 -1.76503717e-02  4.97103265e-03]
 [ 2.58301556e-02  8.57885070e-02  1.10629113e-02]
 [ 3.41116211e-01 -7.82853460e-03 -8.75588078e-02]
 [-4.20119520e-01 -1.54678761e-02 -7.50864681e-02]
 [ 4.06020890e-02 -5.74670670e-03 -3.59952524e-02]
 [-7.03051532e-03 -1.92661732e-01  2.94583400e-02]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.88873239e-01 -1.27846278e-01  2.12564602e-01]
 [ 5.54684475e-02  1.54308432e-01  1.06272472e-01]
 [ 6.76857148e-02 -1.13195448e-01 -4.94206528e-02]
 [-2.05355793e-02  4.11282128e-03  3.80062659e-02]
 [-5.61792014e-01 -2.87278632e-01  1.65514914e-01]
 [-1.22755635e-01  1.86656111e-02 -2.41481925e-02]
 [ 3.09766168e-01  1.19572920e+00  5.22236231e-01]
 [ 3.76819894e-03  1.73025525e-02  2.96789758e-02]
 [-2.11037189e-02 -1.38646549e-01  9.29706081e-03]
 [-2.99621526e-02  5.97500531e-02 -2.98442508e-02]
 [ 7.82134596e-02 -3.40133944e-02  1.02075395e-01]
 [ 8.01407372e-02  1.68088774e-03 -2.54590781e-02]
 [-5.95186617e-02 -1.38802715e-01  7.47561425e-02]
 [ 4.58858927e-02  4.40983105e-02 -1.44078889e-02]
 [-1.79226931e-02  4.55261159e-03 -4.99520901e-02]
 [ 3.19671526e-03  4.23321853e-02 -6.41327571e-02]
 [-6.39025777e-01 -3.05956539e-02 -9.40201349e-01]
 [-2.09178739e-01  1.49302429e-03  2.11690835e-02]
 [-2.87731528e-03  3.57943694e-02  1.24712547e-01]
 [ 2.30899345e-02  9.41170440e-02 -9.03236681e-03]
 [-1.07401910e-01 -3.89822376e-03 -1.51211316e-02]
 [-6.01616543e-02  1.25612155e-01  1.28178021e-01]
 [ 1.53111171e-01 -1.60116867e-01 -1.02869281e-01]
 [-2.83948860e-02  2.58983317e-01  8.36613845e-02]
 [ 8.48261885e-02  7.08585871e-02 -2.98426521e-02]
 [-3.44385224e-02  7.83669004e-02 -8.95590709e-03]
 [-8.54331960e-02 -1.99043994e-01  5.66876526e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.45908453]
curr_Stock_Price:  100.98524766079287
curr_Factors:  [100.98524766  -1.12958356  -0.99434161]
mat_Sqrt:  [[12.07393831  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0047979   0.0076922   0.00778062]
Stock Position:  -0.004797904746814147
Bond Position:  [9.94360213]


portfolio before change:  [9.46150857]
curr_Stock_Price:  100.73909598301364
curr_Factors:  [100.73909598  -1.04087439  -1.02076241]
mat_Sqrt:  [[12.81859898  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00354025  0.01411938  0.0859571 ]
Stock Position:  -0.003540249828578019
Bond Position:  [9.81815014]


portfolio before change:  [9.46401826]
curr_Stock_Price:  100.37687734638041
curr_Factors:  [100.37687735  -0.93648154  -1.03344098]
mat_Sqrt:  [[13.99932829  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02117595 0.04123983 0.42466017]
Stock Position:  0.021175946808769754
Bond Position:  [7.33844284]


portfolio before change:  [9.47589514]
curr_Stock_Price:  100.89442310619572
curr_Factors:  [100.89442311  -0.85169777  -1.01886989]
mat_Sqrt:  [[15.54139322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00126778 -0.00659539  0.21422481]
Stock Position:  0.0012677791250433363
Bond Position:  [9.3479833]


portfolio before change:  [9.47668071]
curr_Stock_Price:  100.5923199511442
curr_Factors:  [100.59231995  -1.03665725  -1.03277308]
mat_Sqrt:  [[12.70055355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06549275 -0.07868175  0.09220692]
Stock Position:  -0.06549275443317144
Bond Position:  [16.06474882]


portfolio before change:  [9.46880942]
curr_Stock_Price:  100.7431688586208
curr_Factors:  [100.74316886  -1.09706908  -1.04264167]
mat_Sqrt:  [[11.8563507   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00376593 -0.00558154  0.01418097]
Stock Position:  -0.0037659337423928767
Bond Position:  [9.84820152]


portfolio before change:  [9.46944586]
curr_Stock_Price:  100.90107623967842
curr_Factors:  [100.90107624  -1.08881549  -1.01790914]
mat_Sqrt:  [[12.27317471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00246908 0.02712871 0.03155941]
Stock Position:  0.0024690769423485605
Bond Position:  [9.22031334]


portfolio before change:  [9.46954128]
curr_Stock_Price:  100.47290678169136
curr_Factors:  [100.47290678  -1.25913689  -1.01719121]
mat_Sqrt:  [[10.31459628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03131884 -0.0024756  -0.24978091]
Stock Position:  0.03131884213701281
Bond Position:  [6.32284618]


portfolio before change:  [9.45752134]
curr_Stock_Price:  100.06387655509718
curr_Factors:  [100.06387656  -1.37204753  -0.99390888]
mat_Sqrt:  [[ 9.39194434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04640635 -0.00489137 -0.21420079]
Stock Position:  -0.0464063504599303
Bond Position:  [14.10112066]


portfolio before change:  [9.48840551]
curr_Stock_Price:  99.43634559755331
curr_Factors:  [99.4363456  -1.43824543 -1.02080793]
mat_Sqrt:  [[ 8.50338511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0038933  -0.00181727 -0.10268444]
Stock Position:  0.003893297679671282
Bond Position:  [9.10127022]


portfolio before change:  [9.4911047]
curr_Stock_Price:  99.83740949633209
curr_Factors:  [99.8374095  -1.6378895  -1.02442625]
mat_Sqrt:  [[ 6.96729605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086    -0.06092499  0.08403644]
Stock Position:  -0.0008599980996843065
Bond Position:  [9.57696468]


portfolio before change:  [9.49176974]
curr_Stock_Price:  100.45619979661546
curr_Factors:  [100.4561998   -1.62832514  -1.01633137]
mat_Sqrt:  [[ 7.13537854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01010817  0.00225658  0.15019092]
Stock Position:  -0.010108169897418506
Bond Position:  [10.50719807]


portfolio before change:  [9.49041843]
curr_Stock_Price:  100.71982667969924
curr_Factors:  [100.71982668  -1.73656556  -1.03278409]
mat_Sqrt:  [[ 6.31541217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03625446 -0.04042854  0.60638764]
Stock Position:  0.03625445563399168
Bond Position:  [5.83887595]


portfolio before change:  [9.50057845]
curr_Stock_Price:  100.97993585899961
curr_Factors:  [100.97993586  -1.61148735  -1.03146143]
mat_Sqrt:  [[ 7.18483862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01129398 0.04879661 0.30316578]
Stock Position:  0.011293983909754312
Bond Position:  [8.36011268]


portfolio before change:  [9.50632641]
curr_Stock_Price:  101.39634123978779
curr_Factors:  [101.39634124  -1.69460991  -1.03172003]
mat_Sqrt:  [[ 6.63731203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00823753 -0.03579554 -0.14098337]
Stock Position:  0.008237532321152917
Bond Position:  [8.67107077]


portfolio before change:  [9.50723904]
curr_Stock_Price:  101.37554366189767
curr_Factors:  [101.37554366  -1.66262273  -1.01173348]
mat_Sqrt:  [[ 6.98996579  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018128   0.00130059  0.1084213 ]
Stock Position:  -0.0018127971570924778
Bond Position:  [9.69101234]


portfolio before change:  [9.50885745]
curr_Stock_Price:  101.15105481112919
curr_Factors:  [101.15105481  -1.65939164  -1.00556205]
mat_Sqrt:  [[ 7.04037407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07605049 -0.09084548  0.47216798]
Stock Position:  -0.0760504940098179
Bond Position:  [17.20144513]


portfolio before change:  [9.49514425]
curr_Stock_Price:  101.3596466855348
curr_Factors:  [101.35964669  -1.63596762  -0.99987337]
mat_Sqrt:  [[ 7.26329845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01751311  0.00590258 -0.06888807]
Stock Position:  -0.017513106674329502
Bond Position:  [11.27026655]


portfolio before change:  [9.48947307]
curr_Stock_Price:  101.76391812517377
curr_Factors:  [101.76391813  -1.41686031  -0.9936887 ]
mat_Sqrt:  [[ 9.13493975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04895936 0.37812277 1.48979461]
Stock Position:  0.04895935828715997
Bond Position:  [4.50717694]


portfolio before change:  [9.48869871]
curr_Stock_Price:  101.7365937102823
curr_Factors:  [101.73659371  -1.26208349  -0.9904405 ]
mat_Sqrt:  [[10.69592756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00096047 0.00547155 0.08466586]
Stock Position:  0.0009604725190497117
Bond Position:  [9.39098351]


portfolio before change:  [9.49039952]
curr_Stock_Price:  102.28513417892215
curr_Factors:  [102.28513418  -1.27790704  -0.98835389]
mat_Sqrt:  [[10.60688609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214821 -0.04384389  0.02652193]
Stock Position:  -0.002148208501389032
Bond Position:  [9.71012931]


portfolio before change:  [9.49159064]
curr_Stock_Price:  102.29571234652828
curr_Factors:  [102.29571235  -1.32886236  -0.991044  ]
mat_Sqrt:  [[10.05390794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343263  0.01889463 -0.08513734]
Stock Position:  -0.003432629907775293
Bond Position:  [9.84273396]


portfolio before change:  [9.49355056]
curr_Stock_Price:  102.08319271801643
curr_Factors:  [102.08319272  -1.37671734  -0.98959336]
mat_Sqrt:  [[ 9.57808234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01024958 -0.01075598  0.29119269]
Stock Position:  0.010249576781272028
Bond Position:  [8.44724104]


portfolio before change:  [9.49653675]
curr_Stock_Price:  102.27151474236751
curr_Factors:  [102.27151474  -1.39944112  -0.99361786]
mat_Sqrt:  [[ 9.34248435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00802649  0.00053154 -0.07262766]
Stock Position:  0.00802648654528415
Bond Position:  [8.67565581]


portfolio before change:  [9.49151245]
curr_Stock_Price:  101.51043167451898
curr_Factors:  [101.51043167  -1.20790894  -1.00941205]
mat_Sqrt:  [[11.05453316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432791 -0.04389327  0.21325847]
Stock Position:  -0.004327907655410852
Bond Position:  [9.93084023]


portfolio before change:  [9.49560831]
curr_Stock_Price:  100.85089175273795
curr_Factors:  [100.85089175  -1.28902417  -0.97421409]
mat_Sqrt:  [[10.4898157   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00420251  0.01394511 -0.0411017 ]
Stock Position:  0.004202505505938953
Bond Position:  [9.07178188]


portfolio before change:  [9.49666446]
curr_Stock_Price:  100.83235691496722
curr_Factors:  [100.83235691  -1.26597094  -0.97642806]
mat_Sqrt:  [[10.70874078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261483  0.00143966 -0.14249941]
Stock Position:  -0.0026148333821463562
Bond Position:  [9.76032428]


portfolio before change:  [9.49878343]
curr_Stock_Price:  100.48860678466043
curr_Factors:  [100.48860678  -1.11408263  -0.95659805]
mat_Sqrt:  [[12.67160519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069457  0.01338661 -0.18295291]
Stock Position:  -0.0006945699865316792
Bond Position:  [9.5685798]


portfolio before change:  [9.49978545]
curr_Stock_Price:  100.76810393055497
curr_Factors:  [100.76810393  -1.01964361  -0.96387518]
mat_Sqrt:  [[13.86410448  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05999187 -0.0096752  -2.68213275]
Stock Position:  -0.05999186973094059
Bond Position:  [15.54505241]


portfolio before change:  [9.46531216]
curr_Stock_Price:  101.37512847621923
curr_Factors:  [101.37512848  -0.75624189  -0.96074241]
mat_Sqrt:  [[18.20767996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01124905  0.00047214  0.0603895 ]
Stock Position:  -0.011249048126707746
Bond Position:  [10.60568586]


portfolio before change:  [9.453547]
curr_Stock_Price:  102.53886771462581
curr_Factors:  [102.53886771  -0.81918836  -0.94563093]
mat_Sqrt:  [[17.55647168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00133875 0.01131917 0.35577018]
Stock Position:  0.0013387503942836037
Bond Position:  [9.31627305]


portfolio before change:  [9.45686676]
curr_Stock_Price:  104.14869209363133
curr_Factors:  [104.14869209  -0.73438238  -0.96687669]
mat_Sqrt:  [[19.00230978  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124597  0.02976242 -0.02576683]
Stock Position:  0.0012459696857183105
Bond Position:  [9.32710064]


portfolio before change:  [9.46112844]
curr_Stock_Price:  106.63328118450063
curr_Factors:  [106.63328118  -0.74272773  -0.98455052]
mat_Sqrt:  [[18.95594153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00583401 -0.00123273 -0.04313638]
Stock Position:  -0.005834009863450917
Bond Position:  [10.08322805]


portfolio before change:  [9.46778731]
curr_Stock_Price:  105.70795114624937
curr_Factors:  [105.70795115  -0.94351298  -0.96549201]
mat_Sqrt:  [[15.66885716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196276  0.03972205  0.36565622]
Stock Position:  -0.0019627553644357976
Bond Position:  [9.67526615]


portfolio before change:  [9.47018714]
curr_Stock_Price:  105.10147988178566
curr_Factors:  [105.10147988  -0.99372094  -0.97584505]
mat_Sqrt:  [[14.66348471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00872773 -0.0506334  -0.29345742]
Stock Position:  0.008727725358557115
Bond Position:  [8.55289029]


portfolio before change:  [9.47467667]
curr_Stock_Price:  105.49337437336752
curr_Factors:  [105.49337437  -1.06354896  -0.99608685]
mat_Sqrt:  [[13.45044697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034428  0.08189772  0.23866264]
Stock Position:  -0.0003442753214681722
Bond Position:  [9.51099544]


portfolio before change:  [9.47575567]
curr_Stock_Price:  105.81274659504776
curr_Factors:  [105.8127466   -1.01428058  -0.9941529 ]
mat_Sqrt:  [[14.19993672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00567356  0.02240745 -0.08513278]
Stock Position:  0.00567355651532528
Bond Position:  [8.87542107]


portfolio before change:  [9.47542807]
curr_Stock_Price:  105.55945055195048
curr_Factors:  [105.55945055  -0.90807714  -1.01938998]
mat_Sqrt:  [[15.36062152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00222929  0.02478179 -0.02554871]
Stock Position:  -0.0022292857497350693
Bond Position:  [9.71075025]


portfolio before change:  [9.47852782]
curr_Stock_Price:  104.71351785635895
curr_Factors:  [104.71351786  -0.86439587  -0.9959945 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.47852782]
Stock Price:  104.84516256265117
PL:  [4.63336526]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.14449914e-02  1.05769650e-01  2.83739117e-02]
 [-6.45943924e-02  1.05962843e-01  1.93525434e-01]
 [ 3.34695513e-01 -3.02238530e-01 -5.74943721e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-7.11178426e-01 -2.14598558e-01  3.52742165e-02]
 [ 9.26900261e-05 -1.04546360e-01 -1.26807817e-01]
 [ 3.21727801e-02 -1.32029394e-01 -1.80591046e-02]
 [ 2.24171385e-01  1.29591632e-01 -5.72634160e-02]
 [-2.45094705e-01  9.46079112e-03 -1.02182625e-01]
 [ 1.05318082e-01 -2.06970245e-02  5.79967830e-02]
 [ 1.28088204e-01 -2.92637957e-01  2.08312969e-03]
 [-2.54300871e-01 -1.70761695e-01 -3.76580518e-01]
 [ 1.97184520e-01 -1.84459946e-01  1.25838082e-01]
 [ 7.96341725e-02 -6.62800428e-02 -5.83929024e-02]
 [-2.38678235e-01  4.23715304e-01  3.00203501e-01]
 [ 6.37895852e-02 -4.43455491e-01 -1.19911971e-01]
 [ 1.50693238e-01 -2.06134324e-01 -1.13123395e-01]
 [-4.04794370e-01 -2.32268369e-01 -5.19882082e-02]
 [ 1.66046955e-01  1.01738954e+00  8.53565060e-02]
 [-4.18322278e-01 -7.34684537e-02  3.09455910e-01]
 [-8.69964927e-02 -1.13386492e-03 -4.40521139e-02]
 [ 1.46096049e-01 -4.58541333e-02  8.27760093e-02]
 [-9.62871144e-02  4.85396964e-02 -1.11129679e-01]
 [-1.32933535e-01 -7.78190575e-02 -1.36163522e-02]
 [-1.21274636e-01  1.25200864e-01  1.09574082e-01]
 [-3.42638412e-03 -2.87689418e-01 -4.69485693e-01]
 [ 1.38546925e-01  5.58278522e-02  9.53564233e-02]
 [-2.92837625e-01  2.82788496e-02  2.88585560e-01]
 [-2.35918831e-01 -2.16911666e-01 -4.75869273e-01]
 [ 3.59698481e-01 -2.78073036e-01 -1.98406585e-01]
 [ 1.34129802e-01  1.33061234e-02 -3.26610316e-02]
 [ 5.77285874e-02  3.34477340e-01 -1.24594443e-01]
 [-2.33547064e-01  4.73778789e-02 -1.50891107e-01]
 [ 2.20637402e-02  1.31279330e-01  9.42662923e-02]
 [-2.66427927e-01  8.00987910e-02 -2.60261757e-02]
 [-1.67387705e-01 -5.73384110e-02 -2.81387993e-02]
 [ 2.90735865e-01  2.15909569e-01  6.85622781e-02]
 [-8.44214153e-02  2.90469366e-01  3.60002081e-02]
 [ 6.14294143e-04 -1.51633001e-01  3.92383013e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.48685953]
curr_Stock_Price:  101.267777482568
curr_Factors:  [101.26777748  -1.05289775  -0.9688251 ]
mat_Sqrt:  [[13.41059979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096358  0.0334473   0.08094287]
Stock Position:  -0.0009635833214438385
Bond Position:  [11.58443947]


portfolio before change:  [11.48744406]
curr_Stock_Price:  102.16403376922665
curr_Factors:  [102.16403377  -1.31305225  -0.99011966]
mat_Sqrt:  [[10.21041003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218945  0.03350839  0.5520742 ]
Stock Position:  -0.002189454643086179
Bond Position:  [11.71112758]


portfolio before change:  [11.48920912]
curr_Stock_Price:  102.02652321865803
curr_Factors:  [102.02652322  -1.04712282  -0.97213932]
mat_Sqrt:  [[13.54436611  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01547004 -0.09557622 -1.6401544 ]
Stock Position:  0.015470037554890854
Bond Position:  [9.91085497]


portfolio before change:  [11.48088639]
curr_Stock_Price:  101.4084471310321
curr_Factors:  [101.40844713  -1.07045435  -0.9918928 ]
mat_Sqrt:  [[12.89460801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152801 -0.00659539  0.21422481]
Stock Position:  0.0015280072014378933
Bond Position:  [11.32593355]


portfolio before change:  [11.48085176]
curr_Stock_Price:  100.45919941030166
curr_Factors:  [100.45919941  -0.89235528  -0.99502641]
mat_Sqrt:  [[15.21634189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04662875 -0.06786202  0.10062752]
Stock Position:  -0.04662875102583613
Bond Position:  [16.16513876]


portfolio before change:  [11.52202528]
curr_Stock_Price:  99.61952967523864
curr_Factors:  [99.61952968 -0.81993829 -0.97122791]
mat_Sqrt:  [[16.61310812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00171498 -0.03306046 -0.3617474 ]
Stock Position:  -0.0017149844794871103
Bond Position:  [11.69287123]


portfolio before change:  [11.52500509]
curr_Stock_Price:  98.7343295668763
curr_Factors:  [98.73432957 -0.75182997 -0.97699032]
mat_Sqrt:  [[17.52471925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00143098 -0.04175136 -0.0515176 ]
Stock Position:  0.001430978501885455
Bond Position:  [11.38371838]


portfolio before change:  [11.52679376]
curr_Stock_Price:  98.98982936701924
curr_Factors:  [98.98982937 -0.92583654 -0.95867541]
mat_Sqrt:  [[15.03686961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01435329  0.04098047 -0.16335659]
Stock Position:  0.014353292038476548
Bond Position:  [10.10596383]


portfolio before change:  [11.52646862]
curr_Stock_Price:  98.87916070207451
curr_Factors:  [98.8791607  -0.89347992 -0.93933919]
mat_Sqrt:  [[15.81690639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01679901  0.00299176 -0.29149859]
Stock Position:  -0.016799010039558908
Bond Position:  [13.18754063]


portfolio before change:  [11.54080297]
curr_Stock_Price:  98.12400907659212
curr_Factors:  [98.12400908 -0.72931732 -0.95553711]
mat_Sqrt:  [[18.19920035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0064081  -0.00654497  0.16544868]
Stock Position:  0.0064080964484529036
Bond Position:  [10.91201485]


portfolio before change:  [11.54042285]
curr_Stock_Price:  97.85182223124451
curr_Factors:  [97.85182223 -0.60192379 -0.93768151]
mat_Sqrt:  [[20.9858631   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00576376 -0.09254025  0.00594259]
Stock Position:  0.005763763001819884
Bond Position:  [10.97642814]


portfolio before change:  [11.52588854]
curr_Stock_Price:  95.09208907949404
curr_Factors:  [95.09208908 -0.45080532 -0.91700383]
mat_Sqrt:  [[24.2165583   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01385742 -0.05399959 -1.0742794 ]
Stock Position:  -0.013857423127110285
Bond Position:  [12.84361986]


portfolio before change:  [11.47667161]
curr_Stock_Price:  98.7596169632829
curr_Factors:  [98.75961696 -0.49017817 -0.91455171]
mat_Sqrt:  [[24.23890321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00899828 -0.05833136  0.35898102]
Stock Position:  0.008998277431562087
Bond Position:  [10.58800518]


portfolio before change:  [11.47817628]
curr_Stock_Price:  98.77974117752737
curr_Factors:  [98.77974118 -0.32901942 -0.93395316]
mat_Sqrt:  [[27.93610537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00236266 -0.02095959 -0.1665787 ]
Stock Position:  0.002362656746845253
Bond Position:  [11.24479366]


portfolio before change:  [11.47111993]
curr_Stock_Price:  95.19816658100069
curr_Factors:  [95.19816658 -0.25412949 -0.90716496]
mat_Sqrt:  [[29.80470399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.005585    0.13399054  0.85639703]
Stock Position:  -0.005584996580652333
Bond Position:  [12.00280137]


portfolio before change:  [11.46462918]
curr_Stock_Price:  96.6289989535756
curr_Factors:  [96.62899895 -0.31739215 -0.90457011]
mat_Sqrt:  [[28.47187158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009786  -0.14023294 -0.34207548]
Stock Position:  0.000978603916599747
Bond Position:  [11.37006767]


portfolio before change:  [11.46469823]
curr_Stock_Price:  95.24713432069252
curr_Factors:  [95.24713432 -0.28679378 -0.88914269]
mat_Sqrt:  [[29.38659015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00416107 -0.0651854  -0.32270956]
Stock Position:  0.0041610699198512836
Bond Position:  [11.06836825]


portfolio before change:  [11.45498594]
curr_Stock_Price:  92.58052919567362
curr_Factors:  [92.5805292  -0.42163272 -0.86933755]
mat_Sqrt:  [[25.45999972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01655159 -0.07344971 -0.14830789]
Stock Position:  -0.0165515933325348
Bond Position:  [12.9873412]


portfolio before change:  [11.43373309]
curr_Stock_Price:  93.96265377314566
curr_Factors:  [93.96265377 -0.56163951 -0.88264366]
mat_Sqrt:  [[22.16721144  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00946168 0.32172682 0.24349835]
Stock Position:  0.009461684629009485
Bond Position:  [10.54468809]


portfolio before change:  [11.4335053]
curr_Stock_Price:  93.79926255936806
curr_Factors:  [93.79926256 -0.72855529 -0.88580613]
mat_Sqrt:  [[18.66771517  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0191267  -0.02323276  0.88279158]
Stock Position:  -0.019126700791594314
Bond Position:  [13.22757573]


portfolio before change:  [11.42320412]
curr_Stock_Price:  94.42429110562617
curr_Factors:  [94.42429111 -0.42593683 -0.89113798]
mat_Sqrt:  [[25.29795478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00379548 -0.00035856 -0.12566842]
Stock Position:  -0.0037954795112274905
Bond Position:  [11.78158958]


portfolio before change:  [11.42412149]
curr_Stock_Price:  94.57062804624996
curr_Factors:  [94.57062805 -0.60076618 -0.90936584]
mat_Sqrt:  [[20.88883735  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00774618 -0.01450035  0.23613691]
Stock Position:  0.007746179436839574
Bond Position:  [10.69156044]


portfolio before change:  [11.42867042]
curr_Stock_Price:  94.9853351433853
curr_Factors:  [94.98533514 -0.45591619 -0.93870859]
mat_Sqrt:  [[23.54933873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00499878  0.0153496  -0.31702204]
Stock Position:  -0.004998784764828946
Bond Position:  [11.90348166]


portfolio before change:  [11.44425741]
curr_Stock_Price:  92.16485689184523
curr_Factors:  [92.16485689 -0.65180398 -0.93177455]
mat_Sqrt:  [[18.91585337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00728078 -0.02460855 -0.03884366]
Stock Position:  -0.0072807839068349915
Bond Position:  [12.11528981]


portfolio before change:  [11.46227406]
curr_Stock_Price:  89.89832185949145
curr_Factors:  [89.89832186 -0.57620659 -0.93688349]
mat_Sqrt:  [[19.79816372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483253  0.03959199  0.31258436]
Stock Position:  -0.0048325314015632325
Bond Position:  [11.89671053]


portfolio before change:  [11.46023509]
curr_Stock_Price:  90.6279917222027
curr_Factors:  [90.62799172 -0.89368723 -0.92248856]
mat_Sqrt:  [[14.74033094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00723782 -0.09097538 -1.339312  ]
Stock Position:  -0.007237819768922839
Bond Position:  [12.11618416]


portfolio before change:  [11.46513648]
curr_Stock_Price:  90.16006532441352
curr_Factors:  [90.16006532 -0.90443376 -0.8865185 ]
mat_Sqrt:  [[15.03881216  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01060276 0.01765432 0.27202533]
Stock Position:  0.010602761754022562
Bond Position:  [10.50919079]


portfolio before change:  [11.47001125]
curr_Stock_Price:  90.49592465001157
curr_Factors:  [90.49592465 -0.84889107 -0.85977561]
mat_Sqrt:  [[16.38945495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01422867  0.00894256  0.82325428]
Stock Position:  -0.014228672523112464
Bond Position:  [12.75764812]


portfolio before change:  [11.47872341]
curr_Stock_Price:  89.99571203129997
curr_Factors:  [89.99571203 -0.86732617 -0.84721294]
mat_Sqrt:  [[16.20342949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02090026 -0.06859349 -1.35752258]
Stock Position:  -0.02090025909596901
Bond Position:  [13.35965711]


portfolio before change:  [11.46384487]
curr_Stock_Price:  90.78750147872529
curr_Factors:  [90.78750148 -1.07192122 -0.8392699 ]
mat_Sqrt:  [[13.4278446   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02323672 -0.08793442 -0.56599876]
Stock Position:  0.023236721965222633
Bond Position:  [9.35424094]


portfolio before change:  [11.46599735]
curr_Stock_Price:  90.82981051867245
curr_Factors:  [90.82981052 -1.1414004  -0.82185335]
mat_Sqrt:  [[12.7525824   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01002201  0.00420777 -0.09317283]
Stock Position:  0.010022006164898364
Bond Position:  [10.55570043]


portfolio before change:  [11.46473792]
curr_Stock_Price:  90.57247956703368
curr_Factors:  [90.57247957 -1.09158147 -0.84614813]
mat_Sqrt:  [[13.04520727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00313771  0.10577102 -0.35543327]
Stock Position:  0.0031377056851727174
Bond Position:  [11.18054814]


portfolio before change:  [11.46744308]
curr_Stock_Price:  90.98918799791241
curr_Factors:  [90.989188   -0.92446843 -0.86490599]
mat_Sqrt:  [[15.20107674  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01730958  0.0149822  -0.43045033]
Stock Position:  -0.017309582451591036
Bond Position:  [13.04242794]


portfolio before change:  [11.44820581]
curr_Stock_Price:  92.19474431526592
curr_Factors:  [92.19474432 -1.0277105  -0.89454125]
mat_Sqrt:  [[13.48599005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00331421 0.04151417 0.26891549]
Stock Position:  0.0033142086053820855
Bond Position:  [11.1426532]


portfolio before change:  [11.450359]
curr_Stock_Price:  92.42414237839685
curr_Factors:  [92.42414238 -0.85201055 -0.87985893]
mat_Sqrt:  [[16.35475601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01648893  0.02532946 -0.07424543]
Stock Position:  -0.01648892564136381
Bond Position:  [12.97433382]


portfolio before change:  [11.43478122]
curr_Stock_Price:  93.46724700641795
curr_Factors:  [93.46724701 -0.8257714  -0.87007324]
mat_Sqrt:  [[17.1460261   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01018382 -0.018132   -0.08027216]
Stock Position:  -0.010183816582960178
Bond Position:  [12.38663452]


portfolio before change:  [11.45496072]
curr_Stock_Price:  91.63776880131185
curr_Factors:  [91.6377688  -0.53867619 -0.87284106]
mat_Sqrt:  [[22.33882641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01389087 0.0682766  0.1955891 ]
Stock Position:  0.01389087489726187
Bond Position:  [10.18203194]


portfolio before change:  [11.45975589]
curr_Stock_Price:  91.8913407983067
curr_Factors:  [91.8913408  -0.36114648 -0.86544112]
mat_Sqrt:  [[26.95096762  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258147  0.09185448  0.10269857]
Stock Position:  -0.002581466380478857
Bond Position:  [11.6969703]


portfolio before change:  [11.46568835]
curr_Stock_Price:  90.15967108649906
curr_Factors:  [90.15967109 -0.13107642 -0.82457614]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.46568835]
Stock Price:  90.34256507700958
PL:  [11.46568835]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.76575926e-01  1.29251818e-02  1.14845122e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 3.16190387e-01  8.19207142e-02  4.20009818e-02]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.26967764e+00 -3.71852667e-01  1.64045962e-02]
 [-6.57236942e-02  2.16995586e-02  6.46456920e-02]
 [ 2.03843582e-02  1.08682435e-01  2.76517310e-02]
 [ 3.58674785e-01 -1.72712696e-02 -9.32272272e-02]
 [-5.09064315e-01 -2.91543484e-02 -5.70297679e-02]
 [ 4.04699999e-02 -5.52230157e-03 -3.58900975e-02]
 [ 1.29326270e-02 -2.87855661e-01  1.47147018e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.33653178e-01 -4.58445631e-02  2.92276593e-01]
 [ 5.08787822e-02  3.36677363e-01  2.98342032e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-4.51639489e-02  6.54134968e-02  4.75264067e-02]
 [-4.35193439e-01 -2.35657099e-01  1.12025284e-01]
 [-1.78985149e-01 -8.14555429e-02 -2.26560074e-02]
 [ 2.94943911e-01  1.21210218e+00  4.51974458e-01]
 [-1.43405580e-01 -2.73549365e-02  1.11118769e-01]
 [-9.56882080e-02  2.80805058e-01 -3.08320497e-02]
 [-2.31205321e-02  3.78412928e-02 -1.05086220e-02]
 [ 6.82804342e-02 -3.70075700e-02  8.77679061e-02]
 [ 7.66787207e-02  2.15539903e-01  5.40898156e-02]
 [-5.65202719e-02 -2.08143975e-01  6.97849595e-02]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [ 3.22996266e-02 -5.96085824e-02  1.35189250e-01]
 [ 6.70595506e-02  6.46083817e-02 -7.82517848e-02]
 [-9.10799146e-01 -2.10900551e-01 -1.36476231e+00]
 [-3.38203550e-03 -7.40220015e-02  8.64153493e-02]
 [ 1.78626476e-02 -1.08256631e-01  1.14395472e-01]
 [ 2.55849812e-02  1.26788963e-01 -2.52575809e-02]
 [-1.36453876e-01 -1.69704838e-02 -1.33439103e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [-9.78716290e-03 -3.71762708e-03  5.55371285e-02]
 [ 4.98545379e-03  3.00449852e-02  7.53225854e-02]
 [ 1.09648185e-02  9.32159385e-03 -4.36101666e-02]
 [-7.36715645e-02  5.94768978e-02 -3.93997572e-03]
 [-3.81591778e-02 -2.41457322e-01  1.06927605e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.79718804]
curr_Stock_Price:  99.77838591886226
curr_Factors:  [99.77838592 -1.03843256 -0.97351663]
mat_Sqrt:  [[13.34313997  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01145154  0.0040873   0.32762117]
Stock Position:  -0.01145154265403618
Bond Position:  [1.93980448]


portfolio before change:  [0.7905083]
curr_Stock_Price:  100.38286570957493
curr_Factors:  [100.38286571  -0.86035151  -0.97690911]
mat_Sqrt:  [[15.98628086  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283875  0.01411938  0.0859571 ]
Stock Position:  -0.0028387492521849246
Bond Position:  [1.07547009]


portfolio before change:  [0.78919123]
curr_Stock_Price:  100.89418657094782
curr_Factors:  [100.89418657  -0.83521006  -0.98260686]
mat_Sqrt:  [[16.38318311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0199521  0.0259056  0.11981711]
Stock Position:  0.019952104756178663
Bond Position:  [-1.22386015]


portfolio before change:  [0.81220441]
curr_Stock_Price:  102.05527546527618
curr_Factors:  [102.05527547  -1.16257241  -0.95341914]
mat_Sqrt:  [[12.29906242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.001602   -0.00659539  0.21422481]
Stock Position:  0.0016019964152368623
Bond Position:  [0.64871222]


portfolio before change:  [0.81143924]
curr_Stock_Price:  101.5270201789604
curr_Factors:  [101.52702018  -1.39495034  -0.90535167]
mat_Sqrt:  [[10.17590795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12538736 -0.11759014  0.04679775]
Stock Position:  -0.12538736229457492
Bond Position:  [13.5416445]


portfolio before change:  [0.84752989]
curr_Stock_Price:  101.25268759138605
curr_Factors:  [101.25268759  -1.33709584  -0.89948808]
mat_Sqrt:  [[10.81609533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00480466  0.006862    0.18441617]
Stock Position:  -0.0048046606338839415
Bond Position:  [1.33401469]


portfolio before change:  [0.84768636]
curr_Stock_Price:  101.25482987403541
curr_Factors:  [101.25482987  -1.26396641  -0.90771643]
mat_Sqrt:  [[11.54159617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00249835 0.0343684  0.07888269]
Stock Position:  0.0024983470383027713
Bond Position:  [0.59471666]


portfolio before change:  [0.85003899]
curr_Stock_Price:  102.16674579864709
curr_Factors:  [102.1667458   -1.24965752  -0.91273775]
mat_Sqrt:  [[11.75420402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02885767 -0.00546165 -0.26595133]
Stock Position:  0.02885766776435833
Bond Position:  [-2.09825502]


portfolio before change:  [0.84314892]
curr_Stock_Price:  101.93707496237971
curr_Factors:  [101.93707496  -1.1319961   -0.88969724]
mat_Sqrt:  [[13.49963126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03862759 -0.00921941 -0.16269005]
Stock Position:  -0.03862759058076802
Bond Position:  [4.78073252]


portfolio before change:  [0.86788575]
curr_Stock_Price:  101.31215375552227
curr_Factors:  [101.31215376  -0.95436346  -0.88961278]
mat_Sqrt:  [[16.02628428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0020592  -0.00174631 -0.10238446]
Stock Position:  0.0020592034091726223
Bond Position:  [0.65926342]


portfolio before change:  [0.86894003]
curr_Stock_Price:  101.78411394534524
curr_Factors:  [101.78411395  -0.85508912  -0.88456733]
mat_Sqrt:  [[17.87132697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00198846 -0.09102795  0.41976948]
Stock Position:  0.001988463705292686
Bond Position:  [0.66654601]


portfolio before change:  [0.86841011]
curr_Stock_Price:  101.47571443257874
curr_Factors:  [101.47571443  -0.81201153  -0.87546416]
mat_Sqrt:  [[18.77157618  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00384228  0.00225658  0.15019092]
Stock Position:  -0.003842278234938198
Bond Position:  [1.25830804]


portfolio before change:  [0.86835179]
curr_Stock_Price:  101.53183280733168
curr_Factors:  [101.53183281  -0.74562136  -0.86710216]
mat_Sqrt:  [[20.23975734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00949271 -0.01449732  0.83378377]
Stock Position:  0.009492711934515974
Bond Position:  [-0.09546065]


portfolio before change:  [0.87247947]
curr_Stock_Price:  101.96791663637147
curr_Factors:  [101.96791664  -0.58152422  -0.8584621 ]
mat_Sqrt:  [[24.15936036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0049865  0.10646673 0.85108677]
Stock Position:  0.004986496526419206
Bond Position:  [0.36401681]


portfolio before change:  [0.87636022]
curr_Stock_Price:  102.73704256002736
curr_Factors:  [102.73704256  -0.48114018  -0.85411259]
mat_Sqrt:  [[27.02925956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158814 -0.03587186 -0.12433753]
Stock Position:  0.0015881357580036723
Bond Position:  [0.71319985]


portfolio before change:  [0.87608257]
curr_Stock_Price:  102.50607501755808
curr_Factors:  [102.50607502  -0.6261229   -0.86886313]
mat_Sqrt:  [[22.98716547  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146924  0.02068556  0.13557961]
Stock Position:  -0.001469241284660035
Bond Position:  [1.02668872]


portfolio before change:  [0.87854264]
curr_Stock_Price:  100.91904312061186
curr_Factors:  [100.91904312  -0.76081087  -0.86055537]
mat_Sqrt:  [[19.9444797   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02097879 -0.07452132  0.31957695]
Stock Position:  -0.020978788116314553
Bond Position:  [2.99570187]


portfolio before change:  [0.88333442]
curr_Stock_Price:  100.70848345349192
curr_Factors:  [100.70848345  -0.7766154   -0.86310498]
mat_Sqrt:  [[19.54089901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00950381 -0.0257585  -0.06463128]
Stock Position:  -0.009503808379560509
Bond Position:  [1.84044855]


portfolio before change:  [0.88611945]
curr_Stock_Price:  100.43964807428925
curr_Factors:  [100.43964807  -1.08757872  -0.84651229]
mat_Sqrt:  [[14.51911448  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02882401 0.38330036 1.28935732]
Stock Position:  0.028824013668408022
Bond Position:  [-2.00895434]


portfolio before change:  [0.87011099]
curr_Stock_Price:  99.89297450495715
curr_Factors:  [99.8929745  -0.62990434 -0.86166803]
mat_Sqrt:  [[22.47777389  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00540222 -0.00865039  0.31699092]
Stock Position:  -0.005402219025193585
Bond Position:  [1.40975471]


portfolio before change:  [0.87237828]
curr_Stock_Price:  99.50590023644955
curr_Factors:  [99.50590024 -0.70407507 -0.86445763]
mat_Sqrt:  [[20.73212116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00456931  0.08879836 -0.08795526]
Stock Position:  -0.004569306613790259
Bond Position:  [1.32705124]


portfolio before change:  [0.87250365]
curr_Stock_Price:  99.51476840578782
curr_Factors:  [99.51476841 -0.64461638 -0.86037829]
mat_Sqrt:  [[22.09411736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109932  0.01196647 -0.02997817]
Stock Position:  -0.0010993214708381017
Bond Position:  [0.98190237]


portfolio before change:  [0.87103757]
curr_Stock_Price:  100.9600451162973
curr_Factors:  [100.96004512  -0.52601731  -0.84463193]
mat_Sqrt:  [[25.63799946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00332477 -0.01170282  0.25037741]
Stock Position:  0.0033247700083667577
Bond Position:  [0.53536864]


portfolio before change:  [0.8702628]
curr_Stock_Price:  100.7068867183942
curr_Factors:  [100.70688672  -0.4538794   -0.84061577]
mat_Sqrt:  [[27.59732946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00338022 0.0681597  0.15430319]
Stock Position:  0.0033802174435103327
Bond Position:  [0.52985163]


portfolio before change:  [0.87167461]
curr_Stock_Price:  101.1049613077272
curr_Factors:  [101.10496131  -0.36332506  -0.87303278]
mat_Sqrt:  [[29.36493736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162267 -0.0658209   0.19907707]
Stock Position:  -0.0016226743618105374
Bond Position:  [1.03573504]


portfolio before change:  [0.86988567]
curr_Stock_Price:  102.2872194417942
curr_Factors:  [102.28721944  -0.40947299  -0.85035339]
mat_Sqrt:  [[29.01921954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00044647  0.02004328 -0.05140267]
Stock Position:  0.0004464655874764455
Bond Position:  [0.82421795]


portfolio before change:  [0.8704653]
curr_Stock_Price:  103.35470013898765
curr_Factors:  [103.35470014  -0.38987861  -0.84541512]
mat_Sqrt:  [[30.0503115   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194194 -0.01884989  0.3856573 ]
Stock Position:  0.0019419409274766901
Bond Position:  [0.66975657]


portfolio before change:  [0.87359958]
curr_Stock_Price:  104.9255802128073
curr_Factors:  [104.92558021  -0.51320938  -0.84877259]
mat_Sqrt:  [[26.87695899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00196282  0.02043096 -0.22323056]
Stock Position:  0.001962820762198448
Bond Position:  [0.66764947]


portfolio before change:  [0.8761099]
curr_Stock_Price:  106.16199505574282
curr_Factors:  [106.16199506  -0.23154222  -0.84494279]
mat_Sqrt:  [[36.17908447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03302531 -0.06669261 -3.893287  ]
Stock Position:  -0.03302531097147719
Bond Position:  [4.3821428]


portfolio before change:  [0.9109198]
curr_Stock_Price:  105.12454533095396
curr_Factors:  [105.12454533  -0.3409938   -0.8230243 ]
mat_Sqrt:  [[32.82294113  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00037614 -0.02340781  0.24651894]
Stock Position:  0.00037614496251238384
Bond Position:  [0.87137773]


portfolio before change:  [0.91103688]
curr_Stock_Price:  105.14621494908373
curr_Factors:  [105.14621495  -0.29527306  -0.84372435]
mat_Sqrt:  [[33.6614912   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114131 -0.03423375  0.32633844]
Stock Position:  0.0011413145975931222
Bond Position:  [0.79103197]


portfolio before change:  [0.90762595]
curr_Stock_Price:  102.07097630405812
curr_Factors:  [102.0709763   -0.47994598  -0.82446066]
mat_Sqrt:  [[27.69527385  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085585  0.04009419 -0.07205285]
Stock Position:  0.0008558491310851496
Bond Position:  [0.8202686]


portfolio before change:  [0.90532825]
curr_Stock_Price:  99.26645671741868
curr_Factors:  [99.26645672 -0.28685298 -0.79597213]
mat_Sqrt:  [[33.61534343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0048826  -0.00536654 -0.38066462]
Stock Position:  -0.0048825975827595045
Bond Position:  [1.39000641]


portfolio before change:  [0.90507879]
curr_Stock_Price:  99.3531353230188
curr_Factors:  [99.35313532 -0.35060353 -0.7978659 ]
mat_Sqrt:  [[31.50704255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166356  0.0049611   0.16678008]
Stock Position:  -0.0016635551709776532
Bond Position:  [1.07035821]


portfolio before change:  [0.90616264]
curr_Stock_Price:  98.78204170549182
curr_Factors:  [98.78204171 -0.44520535 -0.77935902]
mat_Sqrt:  [[29.03062933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.00615141e-05 -1.17561691e-03  1.58431969e-01]
Stock Position:  5.006151406455973e-05
Bond Position:  [0.90121746]


portfolio before change:  [0.90635356]
curr_Stock_Price:  100.34523917424119
curr_Factors:  [100.34523917  -0.31164039  -0.75594603]
mat_Sqrt:  [[34.50244554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0006126  0.00950106 0.21487437]
Stock Position:  0.0006126049910127998
Bond Position:  [0.84488156]


portfolio before change:  [0.90656072]
curr_Stock_Price:  100.51099779967221
curr_Factors:  [100.5109978   -0.32523078  -0.72690517]
mat_Sqrt:  [[35.09754558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.56345917e-05  2.94774680e-03 -1.24407667e-01]
Stock Position:  6.563459171810855e-05
Bond Position:  [0.89996372]


portfolio before change:  [0.9066405]
curr_Stock_Price:  100.01252217921356
curr_Factors:  [100.01252218  -0.50636572  -0.74006459]
mat_Sqrt:  [[28.75653613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253647  0.01880825 -0.01123965]
Stock Position:  -0.0025364710629257044
Bond Position:  [1.16031937]


portfolio before change:  [0.90354183]
curr_Stock_Price:  101.29135639901111
curr_Factors:  [101.2913564   -0.75672195  -0.71721431]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.90354183]
Stock Price:  101.27122816866695
PL:  [-0.36768634]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.69324068e-02  1.14562838e-02  3.04214662e-02]
 [-5.90960368e-02  4.85024674e-02  3.97749239e-02]
 [ 2.24360251e-01  3.11421788e-01  4.62010256e-01]
 [-5.46402947e-02 -6.29452466e-03  9.32470032e-02]
 [-5.84060502e-01 -1.78590919e-01  3.83806520e-02]
 [ 1.09455531e-02 -1.20481537e-01 -1.53056338e-01]
 [ 2.68290440e-02 -1.99588841e-01 -3.02445921e-02]
 [ 2.60082407e-01  2.11432990e-01 -7.89785752e-02]
 [-5.90032434e-02  2.67233686e-02 -9.20768240e-02]
 [ 1.31810191e-01  2.83049564e-02  2.33690588e-01]
 [ 1.17488734e-01 -1.64138969e-01 -3.40976422e-02]
 [-8.00494376e-02 -7.49115609e-02 -1.62569447e-01]
 [ 2.68503279e-01 -2.81414552e-01  2.25724930e-02]
 [ 8.57049760e-02 -6.44454984e-02 -5.36306533e-02]
 [-6.46770535e-02  4.39442651e-02  4.49859177e-02]
 [-3.06954850e-02 -6.69954307e-02  4.61869941e-03]
 [-3.63661972e-01 -3.03521971e-01  9.21815373e-02]
 [-2.23562247e-01 -3.83636581e-02 -3.90856313e-02]
 [ 3.67370111e-01  1.37218670e+00  6.26018209e-01]
 [-1.75138336e-01 -1.75179724e-02  1.62904705e-01]
 [-9.08575768e-02  1.24110677e-01 -3.81794204e-02]
 [ 9.10461616e-02 -1.44813322e-02  5.38597646e-02]
 [-7.94648882e-02 -1.11799748e-02 -9.24758118e-02]
 [-1.30088696e-02 -1.21250306e-01  1.13154057e-01]
 [-1.01156034e-01  7.26698704e-02 -4.39966969e-02]
 [ 1.11388926e-01 -7.12939110e-02 -5.84743026e-02]
 [ 5.84936094e-03 -4.70578171e-02 -2.47219809e-02]
 [-5.04828372e-02  4.04831304e-02  5.68033494e-02]
 [-5.06651358e-01  5.34670980e-02 -6.71370329e-01]
 [ 7.31699307e-02 -1.23031456e-01 -8.63164278e-02]
 [-2.41099600e-02  6.10008175e-02  1.40384104e-01]
 [ 2.79616470e-02  1.42383142e-01 -3.27248404e-02]
 [-1.24063417e-01  5.35720770e-03 -1.53849495e-01]
 [-5.79492006e-02  1.38398296e-01  1.12333140e-01]
 [-9.30363374e-02  5.13616839e-02  9.38692014e-02]
 [-5.48619656e-02 -2.81727874e-02  1.67644461e-02]
 [ 7.51936276e-02  5.99517002e-02  6.99439794e-03]
 [-1.20166040e-01  1.84242604e-01  3.66264567e-03]
 [ 2.29644129e-03 -2.54785294e-01  8.79744034e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.2240232]
curr_Stock_Price:  100.25584674459205
curr_Factors:  [100.25584674  -0.9122143   -0.99132911]
mat_Sqrt:  [[14.94208873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00605182  0.0036228   0.08678398]
Stock Position:  -0.0060518213076574045
Bond Position:  [4.83075367]


portfolio before change:  [4.23159577]
curr_Stock_Price:  99.1043444265105
curr_Factors:  [99.10434443 -0.9814975  -0.98483101]
mat_Sqrt:  [[13.87161651  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00358464  0.01533783  0.11346679]
Stock Position:  -0.0035846352927657297
Bond Position:  [4.5868487]


portfolio before change:  [4.23478882]
curr_Stock_Price:  98.37354121234337
curr_Factors:  [98.37354121 -0.82727269 -1.01103595]
mat_Sqrt:  [[15.64987983  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02087611 0.09848022 1.31798666]
Stock Position:  0.020876107641122875
Bond Position:  [2.18113219]


portfolio before change:  [4.24135953]
curr_Stock_Price:  98.67522815121362
curr_Factors:  [98.67522815 -1.02442603 -1.03670096]
mat_Sqrt:  [[12.56238381  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028473  -0.0019905   0.26600775]
Stock Position:  -0.002847298279663083
Bond Position:  [4.52231734]


portfolio before change:  [4.2418767]
curr_Stock_Price:  98.69214202551446
curr_Factors:  [98.69214203 -1.17705401 -1.0137643 ]
mat_Sqrt:  [[11.03626885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05262986 -0.05647541  0.10948932]
Stock Position:  -0.05262985978749069
Bond Position:  [9.43603029]


portfolio before change:  [4.22737841]
curr_Stock_Price:  98.99003116452589
curr_Factors:  [98.99003116 -1.18191697 -1.03598677]
mat_Sqrt:  [[10.77378007  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217266 -0.03809961 -0.43662713]
Stock Position:  -0.0021726599955561917
Bond Position:  [4.44245009]


portfolio before change:  [4.22991841]
curr_Stock_Price:  98.0765633388023
curr_Factors:  [98.07656334 -1.11668044 -1.0216619 ]
mat_Sqrt:  [[11.55832652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013412  -0.06311553 -0.0862794 ]
Stock Position:  0.001341200277858628
Bond Position:  [4.09837809]


portfolio before change:  [4.23034905]
curr_Stock_Price:  98.01566088900606
curr_Factors:  [98.01566089 -1.24920529 -0.9939088 ]
mat_Sqrt:  [[10.40215693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02397773  0.06686098 -0.22530389]
Stock Position:  0.023977733772373066
Bond Position:  [1.88015563]


portfolio before change:  [4.20844297]
curr_Stock_Price:  97.09225777862696
curr_Factors:  [97.09225778 -1.18439564 -1.00237714]
mat_Sqrt:  [[10.90137429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00707327  0.00845067 -0.26266955]
Stock Position:  -0.0070732689227245476
Bond Position:  [4.89520262]


portfolio before change:  [4.21326787]
curr_Stock_Price:  96.4966414178311
curr_Factors:  [96.49664142 -1.13403481 -0.99689222]
mat_Sqrt:  [[11.45677401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01573243 0.00895081 0.6666542 ]
Stock Position:  0.015732431577153042
Bond Position:  [2.69514106]


portfolio before change:  [4.22825535]
curr_Stock_Price:  97.42787528549869
curr_Factors:  [97.42787529 -1.41140745 -0.98680959]
mat_Sqrt:  [[ 8.85423012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01200449 -0.0519053  -0.09727108]
Stock Position:  0.012004491700808691
Bond Position:  [3.05868323]


portfolio before change:  [4.22715852]
curr_Stock_Price:  97.30465541094749
curr_Factors:  [97.30465541 -1.25267318 -0.95686769]
mat_Sqrt:  [[10.6792858   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01078424 -0.02368912 -0.46376538]
Stock Position:  -0.010784241323224801
Bond Position:  [5.27651541]


portfolio before change:  [4.22031322]
curr_Stock_Price:  98.00056930309576
curr_Factors:  [98.0005693  -1.26568022 -0.97400495]
mat_Sqrt:  [[10.43627915  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02547314 -0.08899109  0.06439304]
Stock Position:  0.025473137873963252
Bond Position:  [1.72393121]


portfolio before change:  [4.21371879]
curr_Stock_Price:  97.73323140733527
curr_Factors:  [97.73323141 -1.25724481 -0.94947528]
mat_Sqrt:  [[10.75662176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00679523 -0.02037946 -0.15299333]
Stock Position:  0.00679522722591938
Bond Position:  [3.54959928]


portfolio before change:  [4.21494672]
curr_Stock_Price:  97.84863663530408
curr_Factors:  [97.84863664 -1.50609775 -0.96020723]
mat_Sqrt:  [[ 8.30715158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00654372  0.0138964   0.1283323 ]
Stock Position:  -0.006543723793823532
Bond Position:  [4.85524118]


portfolio before change:  [4.21311697]
curr_Stock_Price:  98.22100813234395
curr_Factors:  [98.22100813 -1.59218271 -0.95530088]
mat_Sqrt:  [[ 7.68858331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00409471 -0.02118582  0.01317586]
Stock Position:  -0.0040947090293080995
Bond Position:  [4.61530342]


portfolio before change:  [4.21390562]
curr_Stock_Price:  98.16930779389668
curr_Factors:  [98.16930779 -1.50478055 -0.91511549]
mat_Sqrt:  [[ 8.73028117  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0403976  -0.09598207  0.26296827]
Stock Position:  -0.04039759904123324
Bond Position:  [8.17970995]


portfolio before change:  [4.23846031]
curr_Stock_Price:  97.58679391617105
curr_Factors:  [97.58679392 -1.37311668 -0.90448593]
mat_Sqrt:  [[10.00554629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02324022 -0.01213165 -0.11150043]
Stock Position:  -0.023240221613940848
Bond Position:  [6.50639903]


portfolio before change:  [4.22323928]
curr_Stock_Price:  98.276734652471
curr_Factors:  [98.27673465 -1.43361584 -0.90886028]
mat_Sqrt:  [[ 9.44335394  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0561861  0.43392353 1.7858557 ]
Stock Position:  0.056186102357306075
Bond Position:  [-1.29854739]


portfolio before change:  [4.18895557]
curr_Stock_Price:  97.66944233917094
curr_Factors:  [97.66944234 -1.35686355 -0.8818167 ]
mat_Sqrt:  [[10.41147428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01367125 -0.00553967  0.46472178]
Stock Position:  -0.013671249708254035
Bond Position:  [5.5242189]


portfolio before change:  [4.1897817]
curr_Stock_Price:  97.65952622566222
curr_Factors:  [97.65952623 -1.29197848 -0.86997497]
mat_Sqrt:  [[11.24061726  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00849121  0.03924724 -0.10891526]
Stock Position:  -0.008491205797896226
Bond Position:  [5.01902884]


portfolio before change:  [4.1944646]
curr_Stock_Price:  97.18191732921689
curr_Factors:  [97.18191733 -1.15336968 -0.87526128]
mat_Sqrt:  [[12.7809234   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00795454 -0.0045794   0.15364692]
Stock Position:  0.007954537430253733
Bond Position:  [3.4214274]


portfolio before change:  [4.19789079]
curr_Stock_Price:  97.5588704506095
curr_Factors:  [97.55887045 -1.17269    -0.89251547]
mat_Sqrt:  [[12.36970728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00797352 -0.00353542 -0.26380775]
Stock Position:  -0.007973519314414812
Bond Position:  [4.97577833]


portfolio before change:  [4.20204228]
curr_Stock_Price:  97.11622046582833
curr_Factors:  [97.11622047 -1.18060569 -0.90636905]
mat_Sqrt:  [[12.04842164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0005775  -0.03834271  0.32279703]
Stock Position:  0.0005774977306775291
Bond Position:  [4.14595788]


portfolio before change:  [4.2025122]
curr_Stock_Price:  97.03248146325667
curr_Factors:  [97.03248146 -1.01880166 -0.88883917]
mat_Sqrt:  [[14.40254542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00751676  0.02298023 -0.12551033]
Stock Position:  -0.007516761141211676
Bond Position:  [4.93188218]


portfolio before change:  [4.19946131]
curr_Stock_Price:  97.52037881933961
curr_Factors:  [97.52037882 -1.11626768 -0.85694633]
mat_Sqrt:  [[13.55624549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00720053 -0.02254511 -0.16681091]
Stock Position:  0.007200526713626916
Bond Position:  [3.49726322]


portfolio before change:  [4.19790221]
curr_Stock_Price:  97.24313671331613
curr_Factors:  [97.24313671 -1.53791458 -0.86694749]
mat_Sqrt:  [[ 8.77891075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.69329167e-05 -1.48809884e-02 -7.05249301e-02]
Stock Position:  -4.6932916713480717e-05
Bond Position:  [4.20246611]


portfolio before change:  [4.19842884]
curr_Stock_Price:  97.21554368553478
curr_Factors:  [97.21554369 -1.52765421 -0.87350429]
mat_Sqrt:  [[ 8.80898403  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429591  0.01280189  0.16204414]
Stock Position:  -0.004295913350391955
Bond Position:  [4.6160584]


portfolio before change:  [4.20004581]
curr_Stock_Price:  96.97347073455614
curr_Factors:  [96.97347073 -1.45770404 -0.85698798]
mat_Sqrt:  [[ 9.5806498   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06704282  0.01690778 -1.91523268]
Stock Position:  -0.0670428155835956
Bond Position:  [10.70142033]


portfolio before change:  [4.18332277]
curr_Stock_Price:  97.24286287681124
curr_Factors:  [97.24286288 -1.51038622 -0.86606774]
mat_Sqrt:  [[ 9.03185373  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00579881 -0.03890596 -0.24623674]
Stock Position:  0.0057988101503268765
Bond Position:  [3.61942987]


portfolio before change:  [4.18574905]
curr_Stock_Price:  97.58324843214217
curr_Factors:  [97.58324843 -1.65852707 -0.88586748]
mat_Sqrt:  [[ 7.66229304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00079883 0.01929015 0.40047677]
Stock Position:  0.0007988287000862099
Bond Position:  [4.10779675]


portfolio before change:  [4.18593649]
curr_Stock_Price:  97.17505737076684
curr_Factors:  [97.17505737 -1.56755406 -0.89245855]
mat_Sqrt:  [[ 8.30204149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00300625  0.0450255  -0.09335486]
Stock Position:  0.003006252601239853
Bond Position:  [3.89380372]


portfolio before change:  [4.1862591]
curr_Stock_Price:  97.12045785263501
curr_Factors:  [97.12045785 -1.42979056 -0.87369616]
mat_Sqrt:  [[ 9.70329307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01600792  0.0016941  -0.43888979]
Stock Position:  -0.016007915063292293
Bond Position:  [5.74095514]


portfolio before change:  [4.18821365]
curr_Stock_Price:  97.0431905581096
curr_Factors:  [97.04319056 -1.47313452 -0.87775629]
mat_Sqrt:  [[ 9.24668707  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00340077  0.04376538  0.32045518]
Stock Position:  -0.0034007710536484896
Bond Position:  [4.51823533]


portfolio before change:  [4.18980504]
curr_Stock_Price:  96.74132706916012
curr_Factors:  [96.74132707 -1.50832839 -0.86687869]
mat_Sqrt:  [[ 8.99648201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00806418  0.01624199  0.2677827 ]
Stock Position:  -0.008064175957909241
Bond Position:  [4.96994412]


portfolio before change:  [4.18544602]
curr_Stock_Price:  97.35890998702013
curr_Factors:  [97.35890999 -1.33126746 -0.90569692]
mat_Sqrt:  [[10.39619499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00501793 -0.00890902  0.0478243 ]
Stock Position:  -0.005017927776976101
Bond Position:  [4.673986]


portfolio before change:  [4.1868743]
curr_Stock_Price:  97.19071536953668
curr_Factors:  [97.19071537 -1.31894871 -0.92752906]
mat_Sqrt:  [[10.27997076  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00760404 0.01895839 0.01995307]
Stock Position:  0.0076040390708363905
Bond Position:  [3.4478323]


portfolio before change:  [4.18742449]
curr_Stock_Price:  97.20638985224782
curr_Factors:  [97.20638985 -1.18838418 -0.91803638]
mat_Sqrt:  [[11.82736469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00969458  0.05826263  0.01044851]
Stock Position:  -0.009694575637381709
Bond Position:  [5.12979919]


portfolio before change:  [4.18459392]
curr_Stock_Price:  97.5645111928289
curr_Factors:  [97.56451119 -1.13581607 -0.91003879]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.18459392]
Stock Price:  97.95783899881619
PL:  [4.18459392]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.90736705e-01  1.22353622e-02  1.24991131e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 3.20348141e-01  2.45908889e-01  2.99645210e-01]
 [-1.58123391e-02  2.79097024e-02  1.21483228e-01]
 [-5.08757337e-01 -1.57260417e-01  4.02208679e-02]
 [ 5.21210792e-03 -1.14366189e-01 -1.41699709e-01]
 [ 2.44123254e-02 -2.29543407e-01 -3.38970866e-02]
 [ 5.08030464e-02  2.24862256e-01 -1.49877252e-03]
 [-3.37222114e-03  1.52855315e-02 -1.91673368e-02]
 [ 1.65706740e-01  9.10571987e-02  4.58455304e-01]
 [ 2.50153041e-01 -2.99192181e-01 -4.90677032e-02]
 [-2.53591611e-01 -1.70371554e-01 -3.75709423e-01]
 [ 2.06345312e-01 -2.22406712e-01  5.37977336e-02]
 [ 2.22544386e-02 -1.19950305e-01 -8.14926392e-02]
 [-2.26232571e-01  3.92794995e-01  2.79722826e-01]
 [ 8.13139776e-02 -5.05551118e-01 -1.41371134e-01]
 [ 1.50693238e-01 -2.06134324e-01 -1.13123395e-01]
 [-3.06095888e-01 -1.25963057e-01 -4.30863184e-02]
 [ 1.71407550e-01  1.04502767e+00  7.52162453e-02]
 [-4.53089309e-01 -8.07787076e-02  3.29379808e-01]
 [-9.78972194e-02 -6.84136292e-02 -2.28904072e-02]
 [ 2.32113828e-01 -7.17219442e-02  1.20003038e-01]
 [-2.76704015e-03  1.46865480e-01 -9.44847348e-02]
 [-4.08116221e-02 -9.22855280e-02  6.63035073e-02]
 [-1.17843875e-01  1.16242920e-01  8.33861432e-02]
 [ 2.27196556e-02 -2.38805351e-01 -3.52154399e-01]
 [ 1.20344864e-01  3.53792522e-02  9.04267978e-02]
 [-2.35008435e-01  3.33557462e-02  2.31723009e-01]
 [-2.51786938e-01 -8.86116809e-02 -4.37263683e-01]
 [ 3.03764900e-01 -2.24440577e-01 -1.84980697e-01]
 [ 1.34299785e-01  9.87608591e-03 -3.49875374e-02]
 [ 3.49176058e-02  1.90121951e-01 -5.56592223e-02]
 [-1.01292924e-01  2.80348883e-02 -1.35409518e-01]
 [-4.75099729e-02  1.50107947e-01  9.50378824e-02]
 [-1.35165787e-01  9.67831898e-02  1.40675859e-01]
 [-8.96965490e-02 -6.79507667e-02  1.26180151e-02]
 [ 1.09248791e-01  8.91897014e-02  2.76180188e-02]
 [-1.13241131e-01  1.43986587e-01  8.22365465e-03]
 [ 1.70653004e-03 -2.18610873e-01  7.08831668e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.56560774]
curr_Stock_Price:  99.88544981009021
curr_Factors:  [99.88544981 -0.85150819 -1.01160253]
mat_Sqrt:  [[15.50113583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01063839  0.00386916  0.35656491]
Stock Position:  -0.010638386954745997
Bond Position:  [2.62822781]


portfolio before change:  [1.56986655]
curr_Stock_Price:  99.5160088869157
curr_Factors:  [99.51600889 -0.81226853 -0.98027032]
mat_Sqrt:  [[16.57307975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273824  0.01411938  0.0859571 ]
Stock Position:  -0.002738238367473373
Bond Position:  [1.8423651]


portfolio before change:  [1.56762613]
curr_Stock_Price:  100.4183158687709
curr_Factors:  [100.41831587  -0.71455168  -0.98103407]
mat_Sqrt:  [[18.42592914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02104981 0.07776322 0.85480438]
Stock Position:  0.02104980980628137
Bond Position:  [-0.54616032]


portfolio before change:  [1.56302419]
curr_Stock_Price:  100.20293783859299
curr_Factors:  [100.20293784  -0.79029965  -0.97916754]
mat_Sqrt:  [[17.07696221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00056836 0.00882582 0.34655784]
Stock Position:  0.0005683649309015595
Bond Position:  [1.50607235]


portfolio before change:  [1.56279]
curr_Stock_Price:  99.45964666309557
curr_Factors:  [99.45964666 -0.85232044 -0.97567515]
mat_Sqrt:  [[15.98668857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03156424 -0.04973011  0.11473894]
Stock Position:  -0.031564243634318194
Bond Position:  [4.70215851]


portfolio before change:  [1.5640186]
curr_Stock_Price:  99.43934535245465
curr_Factors:  [99.43934535 -0.82940593 -0.98477605]
mat_Sqrt:  [[16.20574632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164541 -0.03616576 -0.40422983]
Stock Position:  -0.0016454130442929385
Bond Position:  [1.72763739]


portfolio before change:  [1.56659206]
curr_Stock_Price:  98.00657940988187
curr_Factors:  [98.00657941 -0.62607588 -0.99124214]
mat_Sqrt:  [[19.44746257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00059475 -0.072588   -0.09669895]
Stock Position:  0.0005947473242037775
Bond Position:  [1.50830291]


portfolio before change:  [1.56671365]
curr_Stock_Price:  97.8940042555599
curr_Factors:  [97.89400426 -0.3344609  -0.97674744]
mat_Sqrt:  [[26.38186826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213416  0.07110769 -0.00427558]
Stock Position:  0.0021341562578627324
Bond Position:  [1.35779255]


portfolio before change:  [1.56306244]
curr_Stock_Price:  96.103627365511
curr_Factors:  [96.10362737 -0.30652318 -0.9822661 ]
mat_Sqrt:  [[26.48656904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026013  0.00483371 -0.05467908]
Stock Position:  -0.0002601343589017207
Bond Position:  [1.5880623]


portfolio before change:  [1.56347382]
curr_Stock_Price:  95.28538774418082
curr_Factors:  [95.28538774 -0.30352076 -0.99058739]
mat_Sqrt:  [[26.1217504   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01001616 0.02879481 1.30784537]
Stock Position:  0.010016159690960537
Bond Position:  [0.60908016]


portfolio before change:  [1.56665379]
curr_Stock_Price:  95.59527049753953
curr_Factors:  [95.5952705  -0.12131913 -0.97501037]
mat_Sqrt:  [[31.93791452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00727699 -0.09461288 -0.1399765 ]
Stock Position:  0.007276994526719545
Bond Position:  [0.87100753]


portfolio before change:  [1.56608974]
curr_Stock_Price:  95.50279671534854
curr_Factors:  [ 9.55027967e+01  4.00832562e-02 -9.94301658e-01]
mat_Sqrt:  [[36.77937146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00909972 -0.05387622 -1.07179441]
Stock Position:  -0.00909971912649174
Bond Position:  [2.43513837]


portfolio before change:  [1.54377467]
curr_Stock_Price:  97.98853158902631
curr_Factors:  [97.98853159 -0.33804525 -0.97829505]
mat_Sqrt:  [[26.2721685   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00805355 -0.07033118  0.15346996]
Stock Position:  0.00805354959601999
Bond Position:  [0.75461917]


portfolio before change:  [1.53138958]
curr_Stock_Price:  96.4389771404946
curr_Factors:  [96.43897714 -0.40892276 -0.96328136]
mat_Sqrt:  [[24.45186102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.03170868e-04 -3.79316171e-02 -2.32475816e-01]
Stock Position:  0.00010317086778232038
Bond Position:  [1.52143989]


portfolio before change:  [1.531464]
curr_Stock_Price:  95.31682911176776
curr_Factors:  [95.31682911 -0.50045904 -0.96833691]
mat_Sqrt:  [[21.94217167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00724598  0.12421268  0.79797136]
Stock Position:  -0.0072459767362916426
Bond Position:  [2.22212753]


portfolio before change:  [1.53393113]
curr_Stock_Price:  95.01468256414402
curr_Factors:  [95.01468256 -0.56290803 -0.98806016]
mat_Sqrt:  [[20.14715795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00195578 -0.1598693  -0.4032925 ]
Stock Position:  0.001955781654119272
Bond Position:  [1.34810316]


portfolio before change:  [1.53251572]
curr_Stock_Price:  94.20480842952408
curr_Factors:  [94.20480843 -0.63521396 -0.97635312]
mat_Sqrt:  [[18.80088887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00650393 -0.0651854  -0.32270956]
Stock Position:  0.006503929529169023
Bond Position:  [0.91981429]


portfolio before change:  [1.53785457]
curr_Stock_Price:  95.00799453920023
curr_Factors:  [95.00799454 -0.62663216 -1.00541355]
mat_Sqrt:  [[18.57683417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0171258  -0.03983302 -0.12291327]
Stock Position:  -0.017125802774853836
Bond Position:  [3.16494275]


portfolio before change:  [1.5587852]
curr_Stock_Price:  93.80892733101015
curr_Factors:  [93.80892733 -0.49318086 -1.00283215]
mat_Sqrt:  [[21.01522164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01017089 0.33046676 0.21457101]
Stock Position:  0.010170889620752275
Bond Position:  [0.60466496]


portfolio before change:  [1.5581205]
curr_Stock_Price:  93.73614178582808
curr_Factors:  [93.73614179 -0.41861662 -0.99317965]
mat_Sqrt:  [[22.84397875  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01698218 -0.02554447  0.93962891]
Stock Position:  -0.016982183313911298
Bond Position:  [3.14996484]


portfolio before change:  [1.58436696]
curr_Stock_Price:  92.21379949623042
curr_Factors:  [92.2137995  -0.46175699 -0.97910289]
mat_Sqrt:  [[21.8292301   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00477965 -0.02163429 -0.06529996]
Stock Position:  -0.0047796526035688135
Bond Position:  [2.02511689]


portfolio before change:  [1.58325127]
curr_Stock_Price:  92.50019056639597
curr_Factors:  [92.50019057 -0.5097694  -0.97049933]
mat_Sqrt:  [[21.05087169  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01210199 -0.02268047  0.34233527]
Stock Position:  0.012101992578774867
Bond Position:  [0.46381465]


portfolio before change:  [1.5734102]
curr_Stock_Price:  91.68222243571675
curr_Factors:  [91.68222244 -0.56416584 -0.99699355]
mat_Sqrt:  [[19.24341843  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094898  0.04644294 -0.26953865]
Stock Position:  -0.0009489792867193665
Bond Position:  [1.66041473]


portfolio before change:  [1.57142967]
curr_Stock_Price:  93.98795910375571
curr_Factors:  [93.9879591  -0.80661887 -1.04011216]
mat_Sqrt:  [[14.82678944  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200045 -0.02918325  0.18914545]
Stock Position:  -0.0020004517877964313
Bond Position:  [1.75944805]


portfolio before change:  [1.57484388]
curr_Stock_Price:  92.39118881081082
curr_Factors:  [92.39118881 -0.59891407 -1.02841893]
mat_Sqrt:  [[18.15050902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00538946  0.03675924  0.23787746]
Stock Position:  -0.0053894560147982875
Bond Position:  [2.07278213]


portfolio before change:  [1.57747747]
curr_Stock_Price:  91.95060986908696
curr_Factors:  [91.95060987 -0.57204997 -1.03658436]
mat_Sqrt:  [[18.4049059   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300624 -0.07551688 -1.00459848]
Stock Position:  -0.0030062358406409803
Bond Position:  [1.85390269]


portfolio before change:  [1.57677612]
curr_Stock_Price:  92.26099874206872
curr_Factors:  [92.26099874 -0.37719452 -1.03832407]
mat_Sqrt:  [[22.4009399   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00623709 0.0111879  0.25796248]
Stock Position:  0.006237088518811904
Bond Position:  [1.00133611]


portfolio before change:  [1.57485541]
curr_Stock_Price:  91.93297884637221
curr_Factors:  [91.93297885 -0.60424407 -1.03501966]
mat_Sqrt:  [[17.84629789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01046979  0.01054801  0.66104125]
Stock Position:  -0.01046978668107716
Bond Position:  [2.53737409]


portfolio before change:  [1.57260915]
curr_Stock_Price:  92.17782137342793
curr_Factors:  [92.17782137 -0.77690149 -1.07707673]
mat_Sqrt:  [[14.43623456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02378258 -0.02802147 -1.24739158]
Stock Position:  -0.023782583750242996
Bond Position:  [3.76483591]


portfolio before change:  [1.56091552]
curr_Stock_Price:  92.689299389902
curr_Factors:  [92.68929939 -0.65499451 -1.06417707]
mat_Sqrt:  [[16.61127116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01566472 -0.07097434 -0.52769844]
Stock Position:  0.015664715871942313
Bond Position:  [0.10896398]


portfolio before change:  [1.58180947]
curr_Stock_Price:  94.0222523554006
curr_Factors:  [94.02225236 -0.71654103 -1.07355884]
mat_Sqrt:  [[15.69640361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00811734  0.00312309 -0.09980971]
Stock Position:  0.00811733607567229
Bond Position:  [0.81859925]


portfolio before change:  [1.5886375]
curr_Stock_Price:  94.8508125698812
curr_Factors:  [94.85081257 -0.62332227 -1.07559272]
mat_Sqrt:  [[17.34649158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00164097  0.06012184 -0.15878027]
Stock Position:  0.00164097403299422
Bond Position:  [1.43298978]


portfolio before change:  [1.58820178]
curr_Stock_Price:  94.47612232540105
curr_Factors:  [94.47612233 -0.56552133 -1.09615365]
mat_Sqrt:  [[17.93353022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00714915  0.00886541 -0.38628567]
Stock Position:  -0.007149145613902334
Bond Position:  [2.26362533]


portfolio before change:  [1.58305293]
curr_Stock_Price:  95.23590885059318
curr_Factors:  [95.23590885 -0.61747416 -1.09195571]
mat_Sqrt:  [[17.23474132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140615  0.0474683   0.27111663]
Stock Position:  -0.0014061525737182681
Bond Position:  [1.71696914]


portfolio before change:  [1.58202559]
curr_Stock_Price:  96.11914762925755
curr_Factors:  [96.11914763 -0.75349119 -1.07667918]
mat_Sqrt:  [[15.41618863  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00674301  0.03060553  0.40130907]
Stock Position:  -0.006743010137826814
Bond Position:  [2.23015798]


portfolio before change:  [1.57994915]
curr_Stock_Price:  96.46843240722113
curr_Factors:  [96.46843241 -0.62729202 -1.10842963]
mat_Sqrt:  [[17.00477493  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0052265  -0.02148792  0.03599569]
Stock Position:  -0.005226496028698984
Bond Position:  [2.08414103]


portfolio before change:  [1.58129203]
curr_Stock_Price:  96.2613427374888
curr_Factors:  [96.26134274 -0.50073375 -1.10986836]
mat_Sqrt:  [[19.22986816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00609412 0.02820426 0.07878652]
Stock Position:  0.006094122077334201
Bond Position:  [0.99466366]


portfolio before change:  [1.58853699]
curr_Stock_Price:  97.42978313904395
curr_Factors:  [97.42978314 -0.46215081 -1.11042898]
mat_Sqrt:  [[20.21757249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00533421  0.04553256  0.0234598 ]
Stock Position:  -0.005334209459916212
Bond Position:  [2.10824786]


portfolio before change:  [1.59444968]
curr_Stock_Price:  96.37074397988161
curr_Factors:  [96.37074398 -0.3062218  -1.10553063]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.59444968]
Stock Price:  97.85166568389855
PL:  [1.59444968]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.68281351e-01  1.91165546e-02  1.08033736e-01]
 [-1.06867834e-01  3.21407883e-02  1.04021876e-01]
 [ 3.04557297e-01  3.11480594e-01  4.14670870e-01]
 [ 1.07457579e-02  5.10255021e-02  1.41314216e-01]
 [-5.11660389e-01 -1.58082741e-01  4.01499248e-02]
 [ 3.15616487e-02 -1.64279329e-01 -2.16746475e-01]
 [ 3.58124669e-02  2.37672799e-02 -1.67982502e-02]
 [ 2.52690858e-01 -1.37523491e-01 -4.12759818e-02]
 [-4.94944450e-01 -2.71870575e-02 -5.90313213e-02]
 [ 4.44349971e-02 -1.22584054e-02 -3.90465956e-02]
 [ 3.12152618e-02 -3.03180914e-01  9.16388354e-02]
 [-6.15891783e-02  4.35745297e-03  4.09733044e-02]
 [ 1.34691178e-01 -7.27744442e-02  2.44180113e-01]
 [ 8.99720276e-02 -5.55290192e-02 -5.96115721e-02]
 [-1.14866255e-01  1.14937489e-01  9.63781382e-02]
 [ 6.13748720e-03 -1.81929128e-01 -3.68181373e-02]
 [-3.49107858e-01 -2.32704134e-01  7.90918444e-02]
 [-2.16570289e-01 -5.43786035e-02 -3.64110803e-02]
 [ 2.64088353e-01  1.20265744e+00  2.77570385e-01]
 [-2.65735011e-01 -3.63289254e-02  2.14467231e-01]
 [-9.21085527e-02  1.64689409e-01 -3.62766911e-02]
 [ 8.05087913e-02 -3.43542290e-02  5.71775379e-02]
 [-7.38469684e-02  5.30590128e-03 -8.94346605e-02]
 [-6.22276704e-03 -1.07073996e-01  1.04956983e-01]
 [-1.12367608e-01  1.01944029e-01  4.15843110e-02]
 [ 9.63455487e-02 -1.16168493e-01 -1.28369849e-01]
 [ 4.64802585e-02 -5.33229825e-02  1.12201399e-01]
 [-1.22957743e-01  4.22277857e-02  1.19990841e-01]
 [-3.52986206e-01 -6.15735370e-02 -5.68646258e-01]
 [ 2.65812383e-01 -1.88049437e-01 -1.75870852e-01]
 [ 1.34274527e-01  1.03857667e-02 -3.46418341e-02]
 [ 3.64923222e-02  2.00854217e-01 -6.08125975e-02]
 [-8.53848383e-02  2.68726205e-02 -1.37026728e-01]
 [-3.83451860e-02  1.47627696e-01  9.49362426e-02]
 [-2.54928336e-01  8.13866621e-02 -1.16703005e-02]
 [-1.71215583e-01 -5.99953138e-02 -3.16469482e-02]
 [ 2.21793025e-01  1.71888591e-01  5.01767572e-02]
 [-1.41015062e-01  1.60522146e-01 -3.61628146e-03]
 [ 1.39540736e-03 -1.99532270e-01  6.18691477e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.96962942]
curr_Stock_Price:  99.9417421358309
curr_Factors:  [99.94174214 -0.83189757 -0.99333502]
mat_Sqrt:  [[16.10862495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00904705  0.00604519  0.30819018]
Stock Position:  -0.009047045928927635
Bond Position:  [2.87380695]


portfolio before change:  [1.98231353]
curr_Stock_Price:  98.57943419752132
curr_Factors:  [98.5794342  -0.81177634 -1.00915463]
mat_Sqrt:  [[15.95754401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00531439  0.01016381  0.29674546]
Stock Position:  -0.005314388372642635
Bond Position:  [2.50620293]


portfolio before change:  [1.97716241]
curr_Stock_Price:  99.60766448376637
curr_Factors:  [99.60766448 -0.59509282 -1.02236444]
mat_Sqrt:  [[19.76241408  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02010099 0.09849881 1.18294057]
Stock Position:  0.020100986987260292
Bond Position:  [-0.02504996]


portfolio before change:  [1.97708916]
curr_Stock_Price:  99.6041765247919
curr_Factors:  [99.60417652 -0.55022469 -1.05367291]
mat_Sqrt:  [[20.03150931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00204223 0.01613568 0.40313012]
Stock Position:  0.002042226252471456
Bond Position:  [1.7736749]


portfolio before change:  [1.97960875]
curr_Stock_Price:  100.72935050161982
curr_Factors:  [100.7293505   -0.57498144  -1.06144985]
mat_Sqrt:  [[19.60933896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0258829  -0.04999015  0.11453656]
Stock Position:  -0.0258828969345415
Bond Position:  [4.58677614]


portfolio before change:  [2.02954555]
curr_Stock_Price:  98.82216732231215
curr_Factors:  [98.82216732 -0.56199809 -1.04200373]
mat_Sqrt:  [[19.87216721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008516  -0.05194969 -0.61831736]
Stock Position:  -0.0008516038560242764
Bond Position:  [2.11370289]


portfolio before change:  [2.02856221]
curr_Stock_Price:  100.2871397245134
curr_Factors:  [100.28713972  -0.5305489   -1.06228643]
mat_Sqrt:  [[20.39321273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00161805  0.00751587 -0.04792073]
Stock Position:  0.001618048485737526
Bond Position:  [1.86629275]


portfolio before change:  [2.03086472]
curr_Stock_Price:  101.56597188748549
curr_Factors:  [101.56597189  -0.65992952  -1.06843957]
mat_Sqrt:  [[18.0354537   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01334674 -0.04348875 -0.11774889]
Stock Position:  0.013346744465098556
Bond Position:  [0.67528965]


portfolio before change:  [2.02385306]
curr_Stock_Price:  101.03430103203978
curr_Factors:  [101.03430103  -0.79644989  -1.08183249]
mat_Sqrt:  [[15.44333774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03287477 -0.0085973  -0.16839993]
Stock Position:  -0.03287476729738921
Bond Position:  [5.3453322]


portfolio before change:  [2.03493076]
curr_Stock_Price:  100.71766046666586
curr_Factors:  [100.71766047  -0.82479337  -1.06670736]
mat_Sqrt:  [[15.19278182  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0023793  -0.00387645 -0.11138907]
Stock Position:  0.002379296555420675
Bond Position:  [1.79529357]


portfolio before change:  [2.03377075]
curr_Stock_Price:  100.13579242499655
curr_Factors:  [100.13579242  -0.78082245  -1.04704196]
mat_Sqrt:  [[16.09748073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00261487 -0.09587422  0.26142009]
Stock Position:  0.00261487272079732
Bond Position:  [1.77192839]


portfolio before change:  [2.03539467]
curr_Stock_Price:  100.67211700327125
curr_Factors:  [100.672117    -0.4596504   -1.07448679]
mat_Sqrt:  [[21.70910322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244658  0.00137795  0.11688543]
Stock Position:  -0.002446578658337938
Bond Position:  [2.28169692]


portfolio before change:  [2.03697983]
curr_Stock_Price:  100.14079066523561
curr_Factors:  [100.14079067  -0.36170729  -1.05132338]
mat_Sqrt:  [[24.37471751  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00749363 -0.0230133   0.6965779 ]
Stock Position:  0.007493633790073331
Bond Position:  [1.28656142]


portfolio before change:  [2.03252801]
curr_Stock_Price:  99.52524722940463
curr_Factors:  [99.52524723 -0.40948095 -1.04107989]
mat_Sqrt:  [[23.33257629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00327311 -0.01755982 -0.17005522]
Stock Position:  0.003273111051144725
Bond Position:  [1.70677082]


portfolio before change:  [2.02842266]
curr_Stock_Price:  98.20579880187965
curr_Factors:  [98.2057988  -0.35550833 -1.07479168]
mat_Sqrt:  [[23.49447434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00392541  0.03634643  0.27494   ]
Stock Position:  -0.003925411351247303
Bond Position:  [2.41392082]


portfolio before change:  [2.02982753]
curr_Stock_Price:  97.9247818049219
curr_Factors:  [97.9247818  -0.58376274 -1.09967228]
mat_Sqrt:  [[18.18804725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033403 -0.05753104 -0.1050319 ]
Stock Position:  -0.00033403110261158973
Bond Position:  [2.06253745]


portfolio before change:  [2.02982328]
curr_Stock_Price:  98.7094042443425
curr_Factors:  [98.70940424 -0.41838318 -1.12611839]
mat_Sqrt:  [[21.06638503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01609064 -0.07358751  0.22562702]
Stock Position:  -0.016090643826093917
Bond Position:  [3.61812114]


portfolio before change:  [2.03995679]
curr_Stock_Price:  98.10773676394165
curr_Factors:  [98.10773676 -0.35140249 -1.12481452]
mat_Sqrt:  [[22.41766395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01005487 -0.01719602 -0.10387068]
Stock Position:  -0.010054870989328031
Bond Position:  [3.02641742]


portfolio before change:  [2.05100481]
curr_Stock_Price:  97.0465897464759
curr_Factors:  [97.04658975 -0.51926883 -1.12980491]
mat_Sqrt:  [[18.65506012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01885814 0.38031368 0.79183105]
Stock Position:  0.018858135519768057
Bond Position:  [0.22088707]


portfolio before change:  [2.06626317]
curr_Stock_Price:  97.85423822963612
curr_Factors:  [97.85423823 -0.43691707 -1.13366298]
mat_Sqrt:  [[20.34629741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01095507 -0.01148821  0.61181531]
Stock Position:  -0.010955068391128954
Bond Position:  [3.13826304]


portfolio before change:  [2.08603794]
curr_Stock_Price:  96.084969200684
curr_Factors:  [96.0849692  -0.26172532 -1.13579472]
mat_Sqrt:  [[23.75309545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00401048  0.05207936 -0.1034873 ]
Stock Position:  -0.004010476832245332
Bond Position:  [2.47138448]


portfolio before change:  [2.09126096]
curr_Stock_Price:  94.85965814269359
curr_Factors:  [ 9.48596581e+01 -7.97296171e-02 -1.11996868e+00]
mat_Sqrt:  [[28.57980138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00319432 -0.01086376  0.1631116 ]
Stock Position:  0.0031943218825152132
Bond Position:  [1.78824868]


portfolio before change:  [2.0964601]
curr_Stock_Price:  96.4172950222577
curr_Factors:  [ 9.64172950e+01 -7.29939329e-02 -1.13727592e+00]
mat_Sqrt:  [[28.74361761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319952  0.00167787 -0.25513219]
Stock Position:  -0.0031995187749636984
Bond Position:  [2.40494904]


portfolio before change:  [2.09639631]
curr_Stock_Price:  96.53119372662253
curr_Factors:  [96.53119373 -0.38268231 -1.11507163]
mat_Sqrt:  [[21.58745303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00057611 -0.03385977  0.29941306]
Stock Position:  0.0005761146854791945
Bond Position:  [2.04078328]


portfolio before change:  [2.09670724]
curr_Stock_Price:  96.62806419239823
curr_Factors:  [96.62806419 -0.54032917 -1.134238  ]
mat_Sqrt:  [[18.10706237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00559158  0.03223753  0.11862846]
Stock Position:  -0.00559157862823715
Bond Position:  [2.63701066]


portfolio before change:  [2.10144229]
curr_Stock_Price:  95.84019976659654
curr_Factors:  [95.84019977 -0.57797836 -1.14978226]
mat_Sqrt:  [[17.0290652   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00394283 -0.0367357  -0.36620345]
Stock Position:  0.003942829782283719
Bond Position:  [1.7235607]


portfolio before change:  [2.10561463]
curr_Stock_Price:  96.84376344995081
curr_Factors:  [96.84376345 -0.57371403 -1.14294617]
mat_Sqrt:  [[17.39945344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00390854 -0.01686221  0.32007936]
Stock Position:  0.00390854113656192
Bond Position:  [1.7270968]


portfolio before change:  [2.09873506]
curr_Stock_Price:  95.02838781535026
curr_Factors:  [95.02838782 -0.68032851 -1.16495732]
mat_Sqrt:  [[15.01259984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00648618  0.0133536   0.34230047]
Stock Position:  -0.0064861782571660085
Bond Position:  [2.71510612]


portfolio before change:  [2.10578237]
curr_Stock_Price:  93.99420362555881
curr_Factors:  [93.99420363 -0.40540701 -1.14087967]
mat_Sqrt:  [[20.02429798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02350397 -0.01947126 -1.62218949]
Stock Position:  -0.023503967982998752
Bond Position:  [4.31501912]


portfolio before change:  [2.10799563]
curr_Stock_Price:  93.92298801241996
curr_Factors:  [93.92298801 -0.45536419 -1.12876691]
mat_Sqrt:  [[19.26604212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01168156 -0.05946645 -0.50171059]
Stock Position:  0.01168156278484123
Bond Position:  [1.01082835]


portfolio before change:  [2.11408721]
curr_Stock_Price:  94.43364061508848
curr_Factors:  [94.43364062 -0.55150543 -1.10543577]
mat_Sqrt:  [[18.01052257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00707761  0.00328427 -0.09882351]
Stock Position:  0.007077609811414726
Bond Position:  [1.44572275]


portfolio before change:  [2.11344175]
curr_Stock_Price:  94.31690768903026
curr_Factors:  [94.31690769 -0.41237177 -1.11790466]
mat_Sqrt:  [[20.41732988  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00143334  0.06351568 -0.17348141]
Stock Position:  0.0014333429723419992
Bond Position:  [1.97825327]


portfolio before change:  [2.11464266]
curr_Stock_Price:  94.98221662315557
curr_Factors:  [94.98221662 -0.54831302 -1.12065462]
mat_Sqrt:  [[17.8985917   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00629443  0.00849787 -0.39089911]
Stock Position:  -0.006294431194681939
Bond Position:  [2.71250169]


portfolio before change:  [2.11592778]
curr_Stock_Price:  94.83192046239267
curr_Factors:  [94.83192046 -0.71918461 -1.11463571]
mat_Sqrt:  [[15.15432167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00100002  0.04668398  0.27082668]
Stock Position:  -0.0010000233760578201
Bond Position:  [2.21076191]


portfolio before change:  [2.11751649]
curr_Stock_Price:  93.51960401704768
curr_Factors:  [93.51960402 -0.76738443 -1.10248383]
mat_Sqrt:  [[14.41548287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01770382  0.02573672 -0.03329212]
Stock Position:  -0.017703821243246577
Bond Position:  [3.77317084]


portfolio before change:  [2.122875]
curr_Stock_Price:  93.24357108943906
curr_Factors:  [93.24357109 -0.80814551 -1.10663963]
mat_Sqrt:  [[13.7416308   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01304245 -0.01897218 -0.09027993]
Stock Position:  -0.013042452084622937
Bond Position:  [3.33899981]


portfolio before change:  [2.12060712]
curr_Stock_Price:  93.44945908735657
curr_Factors:  [93.44945909 -0.78857801 -1.12174503]
mat_Sqrt:  [[13.83356247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01709418 0.05435594 0.14314032]
Stock Position:  0.017094183599659803
Bond Position:  [0.52316491]


portfolio before change:  [2.13572765]
curr_Stock_Price:  94.33017587128029
curr_Factors:  [94.33017587 -1.02807729 -1.12651751]
mat_Sqrt:  [[10.93759931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01258124  0.05076156 -0.01031624]
Stock Position:  -0.012581240551063584
Bond Position:  [3.32251828]


portfolio before change:  [2.14140836]
curr_Stock_Price:  93.9116666421329
curr_Factors:  [93.91166664 -0.96575261 -1.11166551]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.14140836]
Stock Price:  93.93123526876812
PL:  [2.14140836]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.23967540e-01  2.31706836e-02  1.68457865e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.59701235e-01  3.73574039e-01  5.40685322e-01]
 [-2.79255908e-02  3.81638492e-02  1.20009256e-01]
 [-3.16108483e-01 -1.02690376e-01  4.49287110e-02]
 [ 6.80725473e-02 -2.29158965e-01 -3.09837519e-01]
 [ 1.42124887e-02 -3.57799285e-01 -5.49919430e-02]
 [ 7.57333640e-02  3.08453716e-01 -1.92532513e-02]
 [ 8.06979153e-02  2.90036168e-02 -3.95258467e-02]
 [ 1.43936596e-01  5.13358001e-02  3.13727497e-01]
 [ 1.93430252e-01 -1.74407559e-01 -6.45364921e-02]
 [-1.98029644e-01 -1.39808695e-01 -3.07469663e-01]
 [ 3.19585818e-01 -3.94245183e-01 -1.28014955e-01]
 [ 9.32505443e-02 -6.35003279e-02 -4.69063312e-02]
 [-1.59949800e-01  2.30460867e-01  1.70805515e-01]
 [ 2.73848145e-02 -2.87883086e-01 -6.96831305e-02]
 [ 1.20818777e-01 -2.14190737e-01 -1.00942279e-01]
 [-2.75218888e-01 -6.69938750e-02 -4.93448604e-02]
 [ 2.71893550e-01  1.33992161e+00  4.06133520e-01]
 [-2.83802471e-01 -4.25847749e-02  2.28487936e-01]
 [-8.70236558e-02 -2.52757048e-04 -4.40107989e-02]
 [ 1.90178722e-01 -5.32912703e-02  1.02552529e-01]
 [-9.24346968e-02  6.68876307e-02 -1.10440161e-01]
 [-4.42093472e-03 -1.03309930e-01  1.02780512e-01]
 [-1.05203819e-01  8.32389037e-02 -1.30988482e-02]
 [ 7.85539521e-02 -1.56834280e-01 -1.95943478e-01]
 [ 5.59558264e-02 -4.19439999e-02  1.09408089e-01]
 [-1.51148426e-01  4.02222456e-02  1.45091573e-01]
 [-3.43967882e-01 -2.84836783e-02 -5.23390576e-01]
 [ 2.29546626e-01 -1.53275662e-01 -1.67165884e-01]
 [ 1.34490968e-01  6.01826789e-03 -3.76041957e-02]
 [ 3.56654216e-02  1.96221020e-01 -5.86222036e-02]
 [-1.09775520e-01  2.50847071e-02 -1.51627640e-01]
 [-3.57767774e-02  1.46932612e-01  9.49077583e-02]
 [-1.64434240e-01  9.20281234e-02  1.02025466e-01]
 [-7.62956335e-02 -8.07820924e-02  2.83229430e-02]
 [ 4.81458761e-02  3.53887042e-02 -8.42334460e-03]
 [-1.15466893e-01  1.71414333e-01  8.62756726e-03]
 [ 1.97495788e-03 -2.35071352e-01  7.86602074e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.34722973]
curr_Stock_Price:  99.71569324264993
curr_Factors:  [99.71569324 -0.86196763 -0.98401202]
mat_Sqrt:  [[15.74217516  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01200488  0.00732721  0.4805634 ]
Stock Position:  -0.012004882173502419
Bond Position:  [1.54430487]


portfolio before change:  [0.35227606]
curr_Stock_Price:  99.31141751250341
curr_Factors:  [99.31141751 -0.8277132  -0.99295354]
mat_Sqrt:  [[16.08028201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282215  0.01411938  0.0859571 ]
Stock Position:  -0.002822154662872691
Bond Position:  [0.63254824]


portfolio before change:  [0.35421589]
curr_Stock_Price:  98.65207869867241
curr_Factors:  [98.6520787  -0.73158661 -0.99476443]
mat_Sqrt:  [[17.55341053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02163191 0.11813448 1.54242472]
Stock Position:  0.021631910422482175
Bond Position:  [-1.77981704]


portfolio before change:  [0.37054766]
curr_Stock_Price:  99.41734913328116
curr_Factors:  [99.41734913 -1.07166365 -0.97012052]
mat_Sqrt:  [[12.90406625  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.89352525e-04  1.20684688e-02  3.42353005e-01]
Stock Position:  -0.00018935252510832217
Bond Position:  [0.38937259]


portfolio before change:  [0.37074847]
curr_Stock_Price:  98.61386927272011
curr_Factors:  [98.61386927 -0.82296326 -0.99302184]
mat_Sqrt:  [[16.0422652   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01929833 -0.03247355  0.12816911]
Stock Position:  -0.01929832844751297
Bond Position:  [2.27383131]


portfolio before change:  [0.39238614]
curr_Stock_Price:  97.50737866203609
curr_Factors:  [97.50737866 -0.72335322 -0.99559191]
mat_Sqrt:  [[17.47869871  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.23404717e-05 -7.24664275e-02 -8.83880198e-01]
Stock Position:  -6.234047166725021e-05
Bond Position:  [0.3984648]


portfolio before change:  [0.3924666]
curr_Stock_Price:  97.01568666238208
curr_Factors:  [97.01568666 -0.55969665 -1.02056266]
mat_Sqrt:  [[19.97763443  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003129  -0.11314607 -0.15687671]
Stock Position:  -0.00031290153585865083
Bond Position:  [0.42282296]


portfolio before change:  [0.39283121]
curr_Stock_Price:  96.01937314518986
curr_Factors:  [96.01937315 -0.67471755 -1.03801166]
mat_Sqrt:  [[17.31928755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00460571  0.09754163 -0.05492417]
Stock Position:  0.004605706270656695
Bond Position:  [-0.04940582]


portfolio before change:  [0.38895457]
curr_Stock_Price:  95.17901027243657
curr_Factors:  [95.17901027 -0.793447   -1.09092135]
mat_Sqrt:  [[14.46007042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00507457  0.00917175 -0.11275624]
Stock Position:  0.005074567667038888
Bond Position:  [-0.09403776]


portfolio before change:  [0.39240353]
curr_Stock_Price:  95.86098223669221
curr_Factors:  [95.86098224 -1.0617467  -1.09402172]
mat_Sqrt:  [[11.10205938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01885249 0.01623381 0.89497722]
Stock Position:  0.018852487645930675
Bond Position:  [-1.41481446]


portfolio before change:  [0.39516277]
curr_Stock_Price:  96.01672362468757
curr_Factors:  [96.01672362 -1.03662416 -1.06800633]
mat_Sqrt:  [[11.70354624  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01501712 -0.05515251 -0.18410465]
Stock Position:  0.015017124557642094
Bond Position:  [-1.04673232]


portfolio before change:  [0.39087879]
curr_Stock_Price:  95.74016357115885
curr_Factors:  [95.74016357 -1.28543683 -1.04801344]
mat_Sqrt:  [[ 9.28302646  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02848225 -0.04421139 -0.87712537]
Stock Position:  -0.028482249006288287
Bond Position:  [3.11777397]


portfolio before change:  [0.37500241]
curr_Stock_Price:  96.31126060872923
curr_Factors:  [96.31126061 -1.36538074 -1.01025109]
mat_Sqrt:  [[ 8.95268436  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0316414  -0.12467127 -0.36519103]
Stock Position:  0.031641404547701535
Bond Position:  [-2.67242115]


portfolio before change:  [0.37442554]
curr_Stock_Price:  96.30358726435699
curr_Factors:  [96.30358726 -1.34829212 -1.03575751]
mat_Sqrt:  [[ 8.87693144  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00924151 -0.02008057 -0.13381071]
Stock Position:  0.009241510837241193
Bond Position:  [-0.51556511]


portfolio before change:  [0.37390857]
curr_Stock_Price:  96.25462147704926
curr_Factors:  [96.25462148 -1.31856982 -1.03601257]
mat_Sqrt:  [[ 9.1377538   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01303754  0.07287812  0.48726059]
Stock Position:  -0.013037536258131812
Bond Position:  [1.62883169]


portfolio before change:  [0.38113779]
curr_Stock_Price:  95.71574636983443
curr_Factors:  [95.71574637 -1.34796323 -1.04039884]
mat_Sqrt:  [[ 8.78478067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.000652   -0.09103663 -0.19878658]
Stock Position:  0.0006520021285576584
Bond Position:  [0.31873092]


portfolio before change:  [0.38127274]
curr_Stock_Price:  95.86161019520877
curr_Factors:  [95.8616102  -1.31061725 -1.04232262]
mat_Sqrt:  [[ 9.11540386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01038721 -0.06773306 -0.28796022]
Stock Position:  0.01038721277419389
Bond Position:  [-0.6144622]


portfolio before change:  [0.37377403]
curr_Stock_Price:  95.14708818697011
curr_Factors:  [95.14708819 -1.02538455 -1.03155501]
mat_Sqrt:  [[12.16404446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02359586 -0.02118532 -0.14076715]
Stock Position:  -0.023595864093611085
Bond Position:  [2.61885179]


portfolio before change:  [0.3784138]
curr_Stock_Price:  94.96432776045275
curr_Factors:  [94.96432776 -1.24746662 -1.0504048 ]
mat_Sqrt:  [[ 9.54130158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04081119 0.42372042 1.15858589]
Stock Position:  0.04081118619616562
Bond Position:  [-3.49719306]


portfolio before change:  [0.39675298]
curr_Stock_Price:  95.42440653398798
curr_Factors:  [95.42440653 -1.19149874 -1.0426568 ]
mat_Sqrt:  [[10.21828581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02331723 -0.01346649  0.65181248]
Stock Position:  -0.023317228097111415
Bond Position:  [2.62178564]


portfolio before change:  [0.38858628]
curr_Stock_Price:  95.78870585039033
curr_Factors:  [95.78870585 -1.32872347 -1.05922347]
mat_Sqrt:  [[ 8.79512718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.09167095e-02 -7.99287965e-05 -1.25550559e-01]
Stock Position:  -0.010916709529306375
Bond Position:  [1.43428376]


portfolio before change:  [0.39844554]
curr_Stock_Price:  94.90199491993845
curr_Factors:  [94.90199492 -1.26362383 -1.07294293]
mat_Sqrt:  [[ 9.17312459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0228642  -0.01685218  0.29255382]
Stock Position:  0.02286420434586916
Bond Position:  [-1.77141306]


portfolio before change:  [0.39369042]
curr_Stock_Price:  94.70370750546546
curr_Factors:  [94.70370751 -1.20775574 -1.07147042]
mat_Sqrt:  [[ 9.69419251  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01168237  0.02115173 -0.31505504]
Stock Position:  -0.011682372604961798
Bond Position:  [1.50005441]


portfolio before change:  [0.38954819]
curr_Stock_Price:  95.07432960975716
curr_Factors:  [95.07432961 -1.29205146 -1.10391406]
mat_Sqrt:  [[ 8.65981607  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00160414 -0.03266947  0.29320419]
Stock Position:  0.0016041447600082942
Bond Position:  [0.2370352]


portfolio before change:  [0.38915122]
curr_Stock_Price:  94.80839110462352
curr_Factors:  [94.8083911  -1.3078259  -1.08487494]
mat_Sqrt:  [[ 8.66383168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01220342  0.02632245 -0.03736737]
Stock Position:  -0.012203421614996064
Bond Position:  [1.54613799]


portfolio before change:  [0.38773041]
curr_Stock_Price:  94.94065575855811
curr_Factors:  [94.94065576 -1.23942571 -1.06444787]
mat_Sqrt:  [[ 9.48184048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00363935 -0.04959535 -0.5589722 ]
Stock Position:  0.003639347604549546
Bond Position:  [0.04220837]


portfolio before change:  [0.38803535]
curr_Stock_Price:  95.02299374940617
curr_Factors:  [95.02299375 -1.24713632 -1.06161982]
mat_Sqrt:  [[ 9.44384088  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00817524 -0.01326386  0.31211082]
Stock Position:  0.008175240416134934
Bond Position:  [-0.38880047]


portfolio before change:  [0.38350393]
curr_Stock_Price:  94.47465301549305
curr_Factors:  [94.47465302 -0.94761976 -1.07554545]
mat_Sqrt:  [[12.49297341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00964488  0.01271939  0.41390587]
Stock Position:  -0.009644877566430905
Bond Position:  [1.29470039]


portfolio before change:  [0.38673463]
curr_Stock_Price:  94.15646840298177
curr_Factors:  [94.1564684  -0.77460381 -1.09098668]
mat_Sqrt:  [[14.57587062  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03097859 -0.00900733 -1.49308763]
Stock Position:  -0.03097859421120522
Bond Position:  [3.30356965]


portfolio before change:  [0.36559017]
curr_Stock_Price:  94.8523499289676
curr_Factors:  [94.85234993 -0.89122599 -1.06230623]
mat_Sqrt:  [[13.44744664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01423813 -0.04847002 -0.47687774]
Stock Position:  0.01423812843164823
Bond Position:  [-0.98492977]


portfolio before change:  [0.37044708]
curr_Stock_Price:  95.20211734804221
curr_Factors:  [95.20211735 -0.85038189 -1.05943075]
mat_Sqrt:  [[14.10020781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00900486  0.00190314 -0.1072743 ]
Stock Position:  0.009004862629008925
Bond Position:  [-0.48683491]


portfolio before change:  [0.36826829]
curr_Stock_Price:  94.96691908665676
curr_Factors:  [94.96691909 -0.6655449  -1.02820926]
mat_Sqrt:  [[17.45758891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00164774  0.06205053 -0.16723283]
Stock Position:  0.0016477429692213035
Bond Position:  [0.21178722]


portfolio before change:  [0.36789637]
curr_Stock_Price:  94.7251371501131
curr_Factors:  [94.72513715 -0.54634756 -1.02478149]
mat_Sqrt:  [[19.68487056  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00711606  0.00793248 -0.43255145]
Stock Position:  -0.007116058873172349
Bond Position:  [1.04196602]


portfolio before change:  [0.36793105]
curr_Stock_Price:  94.73856760301807
curr_Factors:  [94.7385676  -0.6632403  -1.01463196]
mat_Sqrt:  [[17.69441254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071266  0.04646417  0.27074542]
Stock Position:  -0.0007126559663730273
Bond Position:  [0.43544706]


portfolio before change:  [0.36722251]
curr_Stock_Price:  95.80918090072296
curr_Factors:  [95.8091809  -0.38817428 -1.01849385]
mat_Sqrt:  [[23.46923428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00601776  0.02910185  0.29105026]
Stock Position:  -0.006017760151146523
Bond Position:  [0.94377918]


portfolio before change:  [0.35970595]
curr_Stock_Price:  97.07784874914877
curr_Factors:  [97.07784875 -0.29605155 -1.0337667 ]
mat_Sqrt:  [[25.67955045  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282715 -0.02554554  0.08079747]
Stock Position:  -0.0028271531363395427
Bond Position:  [0.63415989]


portfolio before change:  [0.35630651]
curr_Stock_Price:  98.30831373406974
curr_Factors:  [98.30831373 -0.27456678 -1.03322978]
mat_Sqrt:  [[26.58406675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00178077  0.01119089 -0.02402946]
Stock Position:  0.001780773456947109
Bond Position:  [0.18124167]


portfolio before change:  [0.35432887]
curr_Stock_Price:  97.18504048056043
curr_Factors:  [97.18504048 -0.30395349 -1.03313539]
mat_Sqrt:  [[25.52167061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428185  0.05420597  0.02461205]
Stock Position:  -0.004281847408828436
Bond Position:  [0.77046039]


portfolio before change:  [0.35269233]
curr_Stock_Price:  97.58973840630276
curr_Factors:  [97.58973841 -0.28305873 -1.04878808]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.35269233]
Stock Price:  98.29392030993583
PL:  [0.35269233]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.18845868e-01  2.75188834e-02  1.67822980e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.47364436e-01  2.20834729e-01  3.01843582e-01]
 [-6.38685396e-03  5.73167495e-03  1.00386587e-01]
 [-8.00199503e-01 -2.25256258e-01 -4.71430835e-02]
 [-6.81382045e-02  2.63309596e-02  7.16692693e-02]
 [ 1.62058039e-03  1.56600289e-01  9.36202722e-02]
 [ 2.51723581e-01 -2.70522914e-01 -2.57051646e-02]
 [-4.58196188e-01 -2.54354516e-02 -5.00575033e-02]
 [ 1.13287199e-01 -5.34603389e-03  1.10456575e-01]
 [ 1.89654438e-01 -3.32406380e-01 -1.28029374e-02]
 [-7.64565794e-02 -7.29352447e-02 -1.58156793e-01]
 [ 2.46603094e-01 -3.62164671e-01 -1.42042224e-01]
 [-4.45108524e-02 -1.64413782e-01 -1.19218324e-01]
 [-8.04400744e-02  3.05617357e-02  3.98040863e-02]
 [ 3.43489473e-02 -3.04125286e-01 -7.61639969e-02]
 [-2.95912258e-01 -1.99685334e-01  5.54042629e-02]
 [-2.72646982e-01 -1.72022186e-01 -4.19517331e-02]
 [ 2.29879500e-01  1.12774974e+00  2.03766227e-01]
 [-3.41200349e-01 -5.36453802e-02  2.59876330e-01]
 [-9.97732840e-02  4.13315375e-01 -2.46186654e-02]
 [-4.53915814e-02  1.27157678e-02 -3.93452715e-03]
 [ 6.84534798e-02 -4.07847618e-02  8.48463063e-02]
 [ 6.92394557e-02  3.15265999e-01  1.09466579e-01]
 [-1.13889943e-01  1.05590290e-01  5.38202415e-02]
 [ 1.03292406e-01 -1.23514623e-01 -1.30262913e-01]
 [ 6.96383739e-02 -2.55129565e-02  1.05374601e-01]
 [-1.44096109e-01  4.15315766e-02  1.43968055e-01]
 [-5.85698511e-01 -8.16590675e-02 -9.06310649e-01]
 [ 2.45157022e-01 -1.68243842e-01 -1.70912889e-01]
 [ 1.34256280e-01  1.07539546e-02 -3.43921018e-02]
 [ 3.60768719e-02  2.09044634e-01 -6.51231786e-02]
 [-7.48348504e-02 -1.09447298e-03 -1.16672333e-01]
 [-5.86735766e-02  1.34212006e-01  1.17520888e-01]
 [-3.76721962e-01  1.15891588e-01 -9.48748200e-02]
 [-3.34510049e-01 -4.91892355e-02 -8.44520707e-02]
 [ 4.67365703e-01  3.07439834e-01  8.44384832e-02]
 [ 1.69292317e-02  2.99766725e-01  6.16621102e-02]
 [ 1.00807284e-03 -1.75780220e-01  5.06470767e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.35004981]
curr_Stock_Price:  99.71608616458626
curr_Factors:  [99.71608616 -0.90143312 -1.01698716]
mat_Sqrt:  [[14.64218477  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01255814  0.00870224  0.47875225]
Stock Position:  -0.012558140324104173
Bond Position:  [1.60229841]


portfolio before change:  [0.34423207]
curr_Stock_Price:  100.19530060818076
curr_Factors:  [100.19530061  -0.9646579   -1.03174218]
mat_Sqrt:  [[13.60886224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00333467  0.01411938  0.0859571 ]
Stock Position:  -0.0033346683987997322
Bond Position:  [0.67835017]


portfolio before change:  [0.34575093]
curr_Stock_Price:  99.76525293770611
curr_Factors:  [99.76525294 -0.87265868 -1.05473479]
mat_Sqrt:  [[14.51854053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02167435 0.06983407 0.86107572]
Stock Position:  0.021674349911332737
Bond Position:  [-1.81659607]


portfolio before change:  [0.36118644]
curr_Stock_Price:  100.48788586269018
curr_Factors:  [100.48788586  -0.75281345  -1.05966207]
mat_Sqrt:  [[16.40459805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00086881 0.00181251 0.28637499]
Stock Position:  0.0008688090717423067
Bond Position:  [0.27388165]


portfolio before change:  [0.36280614]
curr_Stock_Price:  102.31274793397888
curr_Factors:  [102.31274793  -0.67754206  -1.07315736]
mat_Sqrt:  [[17.76685886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04590787 -0.07123228 -0.1344861 ]
Stock Position:  -0.04590786940194827
Bond Position:  [5.05976641]


portfolio before change:  [0.37961159]
curr_Stock_Price:  101.96045656610514
curr_Factors:  [101.96045657  -0.56643689  -1.0798126 ]
mat_Sqrt:  [[19.65507491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026878   0.00832658  0.20445248]
Stock Position:  -0.0026878001726389844
Bond Position:  [0.65366093]


portfolio before change:  [0.37755324]
curr_Stock_Price:  102.75666995192469
curr_Factors:  [102.75666995  -0.54948107  -1.06196815]
mat_Sqrt:  [[20.51004036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0012079  0.04952136 0.26707258]
Stock Position:  0.0012079030595894091
Bond Position:  [0.25343315]


portfolio before change:  [0.37777522]
curr_Stock_Price:  102.91421510785601
curr_Factors:  [102.91421511  -0.44577535  -1.04621299]
mat_Sqrt:  [[23.14797813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01034612 -0.08554686 -0.07332968]
Stock Position:  0.0103461158958375
Bond Position:  [-0.68698717]


portfolio before change:  [0.35341514]
curr_Stock_Price:  100.5680010075038
curr_Factors:  [100.56800101  -0.44415527  -1.03978988]
mat_Sqrt:  [[22.80292849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02057064 -0.0080434  -0.14280012]
Stock Position:  -0.0205706418065074
Bond Position:  [2.42216347]


portfolio before change:  [0.4065533]
curr_Stock_Price:  97.99951653648652
curr_Factors:  [97.99951654 -0.19844072 -1.02789578]
mat_Sqrt:  [[28.74966283  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00471992 -0.00169056  0.31510186]
Stock Position:  0.004719916893669269
Bond Position:  [-0.05599627]


portfolio before change:  [0.40111008]
curr_Stock_Price:  96.84775419022847
curr_Factors:  [ 9.68477542e+01 -9.65239222e-02 -1.01077700e+00]
mat_Sqrt:  [[32.00330805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00557625 -0.10511613 -0.03652322]
Stock Position:  0.005576247085976538
Bond Position:  [-0.13893693]


portfolio before change:  [0.40899733]
curr_Stock_Price:  98.26530582491078
curr_Factors:  [98.26530582  0.19163814 -1.04456621]
mat_Sqrt:  [[41.87725984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264161 -0.02306415 -0.45117731]
Stock Position:  -0.0026416097867727143
Bond Position:  [0.66857593]


portfolio before change:  [0.41718967]
curr_Stock_Price:  95.19567851729437
curr_Factors:  [95.19567852  0.12385944 -1.02960073]
mat_Sqrt:  [[38.4821024   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00541181 -0.11452652 -0.40520693]
Stock Position:  0.005411809173389949
Bond Position:  [-0.09799118]


portfolio before change:  [0.42375557]
curr_Stock_Price:  96.41119663706549
curr_Factors:  [96.41119664 -0.10835349 -1.04595115]
mat_Sqrt:  [[30.39620302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240462 -0.0519922  -0.34009669]
Stock Position:  -0.002404620618089101
Bond Position:  [0.65558792]


portfolio before change:  [0.41751327]
curr_Stock_Price:  99.04123687094035
curr_Factors:  [99.04123687 -0.32610208 -1.01409259]
mat_Sqrt:  [[25.92847098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275859  0.00966447  0.11354998]
Stock Position:  -0.002758589147475774
Bond Position:  [0.69072736]


portfolio before change:  [0.42120978]
curr_Stock_Price:  97.73254042919513
curr_Factors:  [97.73254043 -0.19447393 -1.0194826 ]
mat_Sqrt:  [[29.02849784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0003772  -0.09617286 -0.21727468]
Stock Position:  0.0003772002084384675
Bond Position:  [0.38434504]


portfolio before change:  [0.42182577]
curr_Stock_Price:  99.23822113175414
curr_Factors:  [ 9.92382211e+01  1.16724608e-02 -1.03210167e+00]
mat_Sqrt:  [[35.76944451  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00810073 -0.06314605  0.15805294]
Stock Position:  -0.008100734214234797
Bond Position:  [1.22572822]


portfolio before change:  [0.43852655]
curr_Stock_Price:  97.19549786114503
curr_Factors:  [97.19549786 -0.10591858 -1.01061642]
mat_Sqrt:  [[31.82300304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00897627 -0.05439819 -0.11967662]
Stock Position:  -0.00897627221138401
Bond Position:  [1.3109798]


portfolio before change:  [0.42913834]
curr_Stock_Price:  98.25964641562005
curr_Factors:  [98.25964642 -0.20935739 -0.99779452]
mat_Sqrt:  [[29.38432939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01022965 0.35662578 0.58128833]
Stock Position:  0.010229652544827156
Bond Position:  [-0.5760237]


portfolio before change:  [0.41767646]
curr_Stock_Price:  97.1462281593557
curr_Factors:  [97.14622816 -0.13459536 -0.97591445]
mat_Sqrt:  [[31.99909221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00904833 -0.01696416  0.74135483]
Stock Position:  -0.009048332729371788
Bond Position:  [1.29668785]


portfolio before change:  [0.40232348]
curr_Stock_Price:  98.86091615913982
curr_Factors:  [98.86091616 -0.13199655 -0.97018233]
mat_Sqrt:  [[32.83631595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286655  0.1307018  -0.0702302 ]
Stock Position:  -0.0028665454162300963
Bond Position:  [0.68571279]


portfolio before change:  [0.40401907]
curr_Stock_Price:  98.29931181228595
curr_Factors:  [98.29931181 -0.1324923  -0.95752864]
mat_Sqrt:  [[33.04915768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138782  0.00402108 -0.01122411]
Stock Position:  -0.0013878233791900995
Bond Position:  [0.54044115]


portfolio before change:  [0.40135824]
curr_Stock_Price:  100.26526227827593
curr_Factors:  [100.26526228   0.10371977  -0.94360461]
mat_Sqrt:  [[43.29055403  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.001957   -0.01289727  0.2420429 ]
Stock Position:  0.0019569997064769426
Bond Position:  [0.20513915]


portfolio before change:  [0.39941228]
curr_Stock_Price:  99.25780384063856
curr_Factors:  [99.25780384  0.21416709 -0.93678467]
mat_Sqrt:  [[48.18765979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0020695  0.09969586 0.31227768]
Stock Position:  0.002069499971640513
Bond Position:  [0.19399826]


portfolio before change:  [0.39547028]
curr_Stock_Price:  97.34127500881092
curr_Factors:  [ 9.73412750e+01 -3.33033052e-02 -9.36962708e-01]
mat_Sqrt:  [[36.89061157  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00271553  0.03339058  0.15353417]
Stock Position:  -0.0027155311015839363
Bond Position:  [0.65980354]


portfolio before change:  [0.40056725]
curr_Stock_Price:  95.49467956933333
curr_Factors:  [95.49467957 -0.10097602 -0.90980836]
mat_Sqrt:  [[34.75370389  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00211527 -0.03905875 -0.37160383]
Stock Position:  0.0021152699631184772
Bond Position:  [0.19857022]


portfolio before change:  [0.40091557]
curr_Stock_Price:  95.64761724010381
curr_Factors:  [ 9.56476172e+01 -8.21137237e-02 -9.26112231e-01]
mat_Sqrt:  [[34.89853424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00259292 -0.00806791  0.30060441]
Stock Position:  0.0025929207212517873
Bond Position:  [0.15290888]


portfolio before change:  [0.39707208]
curr_Stock_Price:  94.15794439440343
curr_Factors:  [94.15794439 -0.26611876 -0.92694985]
mat_Sqrt:  [[28.55708376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00397927  0.01313344  0.41070079]
Stock Position:  -0.003979272286647737
Bond Position:  [0.77175218]


portfolio before change:  [0.3883975]
curr_Stock_Price:  96.36213217825316
curr_Factors:  [ 9.63621322e+01 -5.17385895e-02 -9.52857320e-01]
mat_Sqrt:  [[35.28709778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02190055 -0.02582286 -2.58545201]
Stock Position:  -0.0219005493195865
Bond Position:  [2.49878112]


portfolio before change:  [0.42685518]
curr_Stock_Price:  94.62038072049423
curr_Factors:  [ 9.46203807e+01 -6.41991501e-02 -9.61272458e-01]
mat_Sqrt:  [[33.9334511   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00606851 -0.05320337 -0.4875669 ]
Stock Position:  0.0060685114655100745
Bond Position:  [-0.14734969]


portfolio before change:  [0.43183912]
curr_Stock_Price:  95.44469502917316
curr_Factors:  [95.44469503 -0.22910671 -0.95888019]
mat_Sqrt:  [[29.09481749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00438269  0.0034007  -0.09811109]
Stock Position:  0.004382694199624109
Bond Position:  [0.01353421]


portfolio before change:  [0.4330994]
curr_Stock_Price:  95.73186770022936
curr_Factors:  [95.7318677  -0.14871234 -0.95232509]
mat_Sqrt:  [[31.83332857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00088527  0.06610572 -0.1857783 ]
Stock Position:  0.0008852724242954531
Bond Position:  [0.34835062]


portfolio before change:  [0.43486534]
curr_Stock_Price:  97.677477616118
curr_Factors:  [ 9.76774776e+01 -8.49743701e-02 -9.48657531e-01]
mat_Sqrt:  [[34.74511912  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284008 -0.0003461  -0.33283369]
Stock Position:  -0.0028400751634482264
Bond Position:  [0.71227672]


portfolio before change:  [0.43921084]
curr_Stock_Price:  96.17876570953598
curr_Factors:  [96.17876571  0.11516336 -0.98768389]
mat_Sqrt:  [[40.19280787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00077674  0.04244156  0.33525438]
Stock Position:  -0.0007767406262339105
Bond Position:  [0.51391679]


portfolio before change:  [0.44397616]
curr_Stock_Price:  90.12644937842646
curr_Factors:  [ 9.01264494e+01  2.29875563e-02 -9.65692969e-01]
mat_Sqrt:  [[35.11078207  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01119587  0.03664814 -0.27065145]
Stock Position:  -0.01119587410222043
Bond Position:  [1.45302054]


portfolio before change:  [0.48342273]
curr_Stock_Price:  86.6193599204662
curr_Factors:  [86.61935992 -0.16761329 -0.95033346]
mat_Sqrt:  [[28.32023579  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01246525 -0.015555   -0.24091825]
Stock Position:  -0.012465249912660327
Bond Position:  [1.5631547]


portfolio before change:  [0.48003682]
curr_Stock_Price:  86.90666406257391
curr_Factors:  [86.90666406 -0.22700165 -0.97056857]
mat_Sqrt:  [[26.23946297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01877095 0.09722101 0.24087949]
Stock Position:  0.018770951927611426
Bond Position:  [-1.15128399]


portfolio before change:  [0.44264007]
curr_Stock_Price:  84.92206393707046
curr_Factors:  [84.92206394 -0.27844653 -0.99047064]
mat_Sqrt:  [[23.874639    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00156048 0.09479456 0.17590484]
Stock Position:  0.0015604801748398472
Bond Position:  [0.31012087]


portfolio before change:  [0.44445962]
curr_Stock_Price:  86.06324362712675
curr_Factors:  [86.06324363 -0.31564689 -1.00492997]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.44445962]
Stock Price:  87.66490640108844
PL:  [0.44445962]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.53576027e-01  1.72354533e-01  2.07854187e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.52944888e-01  3.20528586e-01  4.59037797e-01]
 [-3.06899544e-02  3.02706519e-02  1.16125101e-01]
 [-2.80658212e-01 -9.26486722e-02  4.57950246e-02]
 [-7.04833188e-03 -9.08487852e-02 -1.06035273e-01]
 [ 3.42273238e-02  2.59498330e-02 -1.85302199e-02]
 [ 2.07997130e-01  9.53643917e-02 -4.77465186e-02]
 [-3.61444299e-01 -1.04778825e-02 -6.99929018e-02]
 [ 8.78749493e-02 -3.47457675e-02 -2.05381366e-02]
 [ 5.87716984e-02 -3.72976033e-01  1.19740498e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 7.88172544e-02 -1.33108594e-02  2.51120048e-01]
 [ 5.73706771e-02  3.06817534e-01  2.68528333e-01]
 [ 5.74116136e-02 -1.13387154e-01 -4.47854960e-02]
 [-3.60064635e-02  4.26202689e-02  4.39865642e-02]
 [-4.58437595e-01 -2.37301349e-01  1.21008306e-01]
 [-1.33850802e-01  1.79448070e-02 -1.49107147e-02]
 [ 2.37704625e-01  1.06513009e+00  3.17165828e-01]
 [ 1.11688175e-02  5.33037769e-03  3.26647230e-02]
 [-4.20543578e-02 -1.01847924e-01  2.53705710e-03]
 [-2.52545234e-02  4.67669003e-02 -1.82474292e-02]
 [ 5.03742926e-02 -3.47991818e-02  6.82739964e-02]
 [ 5.81432463e-02  1.61887990e-01  7.18849735e-02]
 [-5.79280613e-02 -1.59440490e-01 -1.42094979e-02]
 [ 7.84936045e-02  2.13929314e-02 -1.39315024e-02]
 [ 1.84885115e-02 -5.96466300e-02  2.33892887e-02]
 [-1.10147080e-03  4.22960227e-02  8.17379188e-03]
 [-6.00788265e-01  1.12142812e-02 -8.45289770e-01]
 [ 5.29208857e-02 -1.10323075e-01 -8.15446748e-02]
 [ 1.34680350e-01  2.19678277e-03 -4.01962104e-02]
 [ 3.25052598e-02  1.75512434e-01 -4.87068544e-02]
 [-1.07650482e-01  6.11791917e-03 -1.66562033e-01]
 [-5.87364917e-02  1.33848409e-01  1.17971466e-01]
 [-1.25969082e-01  9.82773222e-02  1.52820549e-01]
 [-1.12263826e-01 -8.90081292e-02  3.86334931e-03]
 [ 9.96855758e-02  7.97761059e-02  2.26634042e-02]
 [-1.10841953e-01  1.13218946e-01  7.31762605e-03]
 [ 1.58099793e-03 -2.10913018e-01  6.72461807e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.64536031]
curr_Stock_Price:  99.4380657410241
curr_Factors:  [99.43806574 -1.01512688 -1.0200668 ]
mat_Sqrt:  [[12.99209785  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00821251  0.05450329  0.59295014]
Stock Position:  -0.008212514614019926
Bond Position:  [-0.82872374]


portfolio before change:  [-1.64584133]
curr_Stock_Price:  99.4840230610324
curr_Factors:  [99.48402306 -0.97291629 -0.98053113]
mat_Sqrt:  [[14.10528621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00321731  0.01411938  0.0859571 ]
Stock Position:  -0.0032173074814931505
Bond Position:  [-1.32577064]


portfolio before change:  [-1.64468896]
curr_Stock_Price:  99.07433018783192
curr_Factors:  [99.07433019 -0.86127057 -0.98089607]
mat_Sqrt:  [[15.70067549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0226055  0.10136004 1.30950706]
Stock Position:  0.022605498620055328
Bond Position:  [-3.88431359]


portfolio before change:  [-1.65200491]
curr_Stock_Price:  98.7721742343475
curr_Factors:  [98.77217423 -0.84525595 -1.00235069]
mat_Sqrt:  [[15.56787178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039854  0.00957242  0.33127259]
Stock Position:  -0.0003985408229703479
Bond Position:  [-1.61264017]


portfolio before change:  [-1.65211322]
curr_Stock_Price:  98.53812288521985
curr_Factors:  [98.53812289 -0.7919051  -0.98171287]
mat_Sqrt:  [[16.7236775   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01636617 -0.02929808  0.13064046]
Stock Position:  -0.01636616830089086
Bond Position:  [-0.03942172]


portfolio before change:  [-1.67349701]
curr_Stock_Price:  99.84440667820633
curr_Factors:  [99.84440668 -0.7845519  -1.02774355]
mat_Sqrt:  [[16.3024856   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190391 -0.02872891 -0.30248912]
Stock Position:  -0.0019039058029858146
Bond Position:  [-1.48340267]


portfolio before change:  [-1.67432295]
curr_Stock_Price:  100.18082224765507
curr_Factors:  [100.18082225  -0.91734531  -1.00873769]
mat_Sqrt:  [[14.59813487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213143  0.00820606 -0.05286156]
Stock Position:  0.002131428473465384
Bond Position:  [-1.88785121]


portfolio before change:  [-1.67689637]
curr_Stock_Price:  99.08417730077647
curr_Factors:  [99.0841773  -0.82517244 -1.0138519 ]
mat_Sqrt:  [[15.75165484  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01274236  0.03015687 -0.13620753]
Stock Position:  0.012742357116377497
Bond Position:  [-2.93946234]


portfolio before change:  [-1.67209973]
curr_Stock_Price:  99.4894469750906
curr_Factors:  [99.48944698 -0.66328384 -0.98495249]
mat_Sqrt:  [[19.14066744  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01964415 -0.0033134  -0.19967027]
Stock Position:  -0.019644146626934294
Bond Position:  [0.28228555]


portfolio before change:  [-1.66013308]
curr_Stock_Price:  98.88207182430966
curr_Factors:  [98.88207182 -0.49287704 -0.98832467]
mat_Sqrt:  [[22.48225278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00368226 -0.01098758 -0.05858959]
Stock Position:  0.0036822594576554897
Bond Position:  [-2.02424252]


portfolio before change:  [-1.65568734]
curr_Stock_Price:  100.15813325196285
curr_Factors:  [100.15813325  -0.28790981  -1.00476516]
mat_Sqrt:  [[27.49695576  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00267606 -0.11794538  0.34158631]
Stock Position:  0.002676057164528247
Bond Position:  [-1.92371623]


portfolio before change:  [-1.65349701]
curr_Stock_Price:  101.06648631772168
curr_Factors:  [101.06648632  -0.33630756  -0.99305799]
mat_Sqrt:  [[26.74675176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269661  0.00225658  0.15019092]
Stock Position:  -0.0026966122560519194
Bond Position:  [-1.38095989]


portfolio before change:  [-1.65722744]
curr_Stock_Price:  102.38584380956004
curr_Factors:  [102.38584381  -0.34515561  -0.99024365]
mat_Sqrt:  [[26.93291662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0048169  -0.00420926  0.7163756 ]
Stock Position:  0.004816902547260178
Bond Position:  [-2.15041007]


portfolio before change:  [-1.65198352]
curr_Stock_Price:  103.53029983325433
curr_Factors:  [103.53029983  -0.27986949  -1.02918312]
mat_Sqrt:  [[27.96102887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00429547 0.09702422 0.76603659]
Stock Position:  0.004295470983608948
Bond Position:  [-2.09669492]


portfolio before change:  [-1.6588178]
curr_Stock_Price:  102.00027639602108
curr_Factors:  [102.0002764   -0.36525105  -1.03113872]
mat_Sqrt:  [[25.24393073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00179616 -0.03585617 -0.12776055]
Stock Position:  0.001796161193248229
Bond Position:  [-1.84202674]


portfolio before change:  [-1.65811559]
curr_Stock_Price:  102.51942669809878
curr_Factors:  [102.5194267   -0.55300039  -1.01686278]
mat_Sqrt:  [[21.33159133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121544  0.01347771  0.12548142]
Stock Position:  -0.0012154411104510587
Bond Position:  [-1.53350926]


portfolio before change:  [-1.65737275]
curr_Stock_Price:  101.75053684480505
curr_Factors:  [101.75053684  -0.83395328  -1.02667443]
mat_Sqrt:  [[15.8298341   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02778702 -0.07504128  0.34520301]
Stock Position:  -0.0277870235269237
Bond Position:  [1.16997181]


portfolio before change:  [-1.66131436]
curr_Stock_Price:  101.89765115237465
curr_Factors:  [101.89765115  -0.56888489  -1.00609427]
mat_Sqrt:  [[21.09402312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00646776  0.00567465 -0.04253612]
Stock Position:  -0.0064677612669912276
Bond Position:  [-1.00226468]


portfolio before change:  [-1.65836072]
curr_Stock_Price:  101.42160775347904
curr_Factors:  [101.42160775  -0.76318958  -1.03727027]
mat_Sqrt:  [[16.75717135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01968992 0.33682371 0.90478583]
Stock Position:  0.019689920328176173
Bond Position:  [-3.65534409]


portfolio before change:  [-1.65694677]
curr_Stock_Price:  101.51662548061319
curr_Factors:  [101.51662548  -0.67781899  -1.05018002]
mat_Sqrt:  [[18.03336351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00099671 0.00168561 0.09318336]
Stock Position:  0.000996714003506345
Bond Position:  [-1.75812981]


portfolio before change:  [-1.6565941]
curr_Stock_Price:  102.09096802731345
curr_Factors:  [102.09096803  -0.68633563  -1.04411411]
mat_Sqrt:  [[18.09099885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244133 -0.03220714  0.00723752]
Stock Position:  -0.002441334812090831
Bond Position:  [-1.40735586]


portfolio before change:  [-1.65285769]
curr_Stock_Price:  100.4884287616978
curr_Factors:  [100.48842876  -0.94537902  -1.03633953]
mat_Sqrt:  [[13.85053733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0020051   0.01478899 -0.05205484]
Stock Position:  -0.0020051025770257565
Bond Position:  [-1.45136809]


portfolio before change:  [-1.65355428]
curr_Stock_Price:  100.74535078100658
curr_Factors:  [100.74535078  -1.04305623  -1.03920781]
mat_Sqrt:  [[12.55767479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00504967 -0.01100447  0.19476671]
Stock Position:  0.005049673117764147
Bond Position:  [-2.16228537]


portfolio before change:  [-1.65473565]
curr_Stock_Price:  100.56493006902909
curr_Factors:  [100.56493007  -1.08147247  -1.02879883]
mat_Sqrt:  [[12.1889803   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00631691 0.05119348 0.20506782]
Stock Position:  0.006316905363094117
Bond Position:  [-2.28999479]


portfolio before change:  [-1.65522866]
curr_Stock_Price:  100.53220152001253
curr_Factors:  [100.53220152  -1.206931    -0.99825247]
mat_Sqrt:  [[11.08169468  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00586059 -0.05041951 -0.04053574]
Stock Position:  -0.005860592668877898
Bond Position:  [-1.06605038]


portfolio before change:  [-1.65311651]
curr_Stock_Price:  100.14906470032466
curr_Factors:  [100.1490647   -1.1608909   -0.98115712]
mat_Sqrt:  [[11.75891531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00648038  0.00676504 -0.0397427 ]
Stock Position:  0.006480377615238019
Bond Position:  [-2.30212027]


portfolio before change:  [-1.65931636]
curr_Stock_Price:  99.23676318140993
curr_Factors:  [99.23676318 -0.97380738 -0.95784556]
mat_Sqrt:  [[14.38024797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0015106  -0.01886192  0.06672313]
Stock Position:  0.0015105970869558442
Bond Position:  [-1.80922312]


portfolio before change:  [-1.66041416]
curr_Stock_Price:  98.659745407176
curr_Factors:  [98.65974541 -0.85147014 -0.94038816]
mat_Sqrt:  [[16.44166589  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00010091 0.01337518 0.02331755]
Stock Position:  0.00010090681239260985
Bond Position:  [-1.6703696]


portfolio before change:  [-1.66070389]
curr_Stock_Price:  97.85785827904496
curr_Factors:  [97.85785828 -0.70877523 -0.92437115]
mat_Sqrt:  [[19.11301706  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04044588  0.00354627 -2.41137643]
Stock Position:  -0.04044587847287006
Bond Position:  [2.29724315]


portfolio before change:  [-1.65143414]
curr_Stock_Price:  97.63576942241828
curr_Factors:  [97.63576942 -0.79368396 -0.9519759 ]
mat_Sqrt:  [[17.04034996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00196165 -0.03488722 -0.23262426]
Stock Position:  0.001961645104859499
Bond Position:  [-1.84296087]


portfolio before change:  [-1.65433035]
curr_Stock_Price:  96.27679398439119
curr_Factors:  [96.27679398 -1.00158788 -0.97254665]
mat_Sqrt:  [[13.37106146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00946313  0.00069468 -0.1146686 ]
Stock Position:  0.009463127044332493
Bond Position:  [-2.56540988]


portfolio before change:  [-1.65705292]
curr_Stock_Price:  96.02297955118252
curr_Factors:  [96.02297955 -0.98972355 -0.95510072]
mat_Sqrt:  [[13.7324722   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197304  0.05550191 -0.1389471 ]
Stock Position:  0.0019730406860327355
Bond Position:  [-1.84651017]


portfolio before change:  [-1.65522939]
curr_Stock_Price:  97.06419630505069
curr_Factors:  [97.06419631 -1.07450643 -0.95269415]
mat_Sqrt:  [[12.78371373  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01106813  0.00193466 -0.47515512]
Stock Position:  -0.011068133548480647
Bond Position:  [-0.5809099]


portfolio before change:  [-1.65235588]
curr_Stock_Price:  96.79801571487015
curr_Factors:  [96.79801571 -0.77608671 -0.93557222]
mat_Sqrt:  [[17.47843035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178504  0.04232658  0.33653975]
Stock Position:  -0.0017850410745056423
Bond Position:  [-1.47956745]


portfolio before change:  [-1.65310041]
curr_Stock_Price:  97.1114915210852
curr_Factors:  [97.11149152 -0.65553304 -0.94625691]
mat_Sqrt:  [[19.57140869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00471285  0.03107802  0.43595449]
Stock Position:  -0.0047128548639055615
Bond Position:  [-1.19542804]


portfolio before change:  [-1.64732326]
curr_Stock_Price:  95.85395462197582
curr_Factors:  [95.85395462 -0.44771339 -0.93503572]
mat_Sqrt:  [[24.04859586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00473098 -0.02814684  0.01102106]
Stock Position:  -0.00473097904240734
Bond Position:  [-1.19384021]


portfolio before change:  [-1.65121756]
curr_Stock_Price:  96.64555826886905
curr_Factors:  [96.64555827 -0.45797187 -0.93671421]
mat_Sqrt:  [[23.95948237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00443964 0.02522742 0.06465238]
Stock Position:  0.0044396424075103785
Bond Position:  [-2.08028928]


portfolio before change:  [-1.64626161]
curr_Stock_Price:  97.82042711954252
curr_Factors:  [97.82042712 -0.46016855 -0.95789467]
mat_Sqrt:  [[23.69040713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00449232  0.03580297  0.02087515]
Stock Position:  -0.004492322460903645
Bond Position:  [-1.20682071]


portfolio before change:  [-1.63881399]
curr_Stock_Price:  96.12898933716343
curr_Factors:  [96.12898934 -0.38209503 -0.94372236]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.63881399]
Stock Price:  93.49386148850566
PL:  [-1.63881399]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.14480529e-01 -7.75036282e-03  3.21111770e-02]
 [-8.54463747e-03 -2.52558548e-02 -9.44581092e-02]
 [ 3.48818075e-01 -1.28040568e-01 -3.07828744e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-5.21324438e-01 -1.60820196e-01  3.99137602e-02]
 [ 6.78004707e-03 -1.17373737e-01 -1.46260693e-01]
 [ 2.74170095e-02 -1.91766545e-01 -2.76983025e-02]
 [ 1.56914615e-01  2.74551767e-01 -4.64371773e-02]
 [-1.13483381e-01  1.77846056e-02 -7.86775203e-02]
 [ 6.87461210e-02 -3.79231941e-02 -7.64814385e-02]
 [ 6.16388847e-02 -2.43151767e-01  1.51795579e-02]
 [-8.94861622e-03 -2.12744260e-03  1.28545624e-02]
 [ 2.07945189e-01 -1.86098738e-01  1.28514299e-01]
 [ 9.45203306e-02 -5.06109521e-02 -6.06337335e-02]
 [ 1.50188245e-02 -6.66322030e-02 -3.13030195e-02]
 [-2.69619113e-02 -7.59070927e-02  1.04439986e-03]
 [-3.04305634e-01 -3.00287118e-01  6.93455752e-02]
 [-2.22649307e-01 -3.34886440e-02 -3.91867791e-02]
 [ 3.36806449e-01  1.32296814e+00  5.25038851e-01]
 [-2.02349188e-01 -2.36849291e-02  1.75646557e-01]
 [-9.13341345e-02  1.39569094e-01 -3.74545781e-02]
 [ 9.19456295e-02 -2.73302412e-02  5.96100676e-02]
 [-9.66473465e-02  5.98859633e-03 -1.02925461e-01]
 [-8.48895248e-03 -9.39096783e-02  1.13693625e-01]
 [-1.03380552e-01  7.84782336e-02 -2.70163429e-02]
 [ 1.17828791e-01 -3.38640087e-02 -1.27306331e-02]
 [ 3.03397285e-02 -6.73741966e-02  7.80249154e-02]
 [-1.88038006e-02  4.25986991e-02  2.50706371e-02]
 [-6.34803161e-01  3.99122213e-02 -8.64845481e-01]
 [ 9.35496352e-02 -1.09612154e-01 -1.05841058e-01]
 [ 1.34638795e-01  3.03530741e-03 -3.96274608e-02]
 [ 3.44220019e-02  1.91022759e-01 -5.62384024e-02]
 [-1.28759262e-01  1.70505726e-02 -1.70911238e-01]
 [-5.29362181e-02  1.51576443e-01  9.50980609e-02]
 [-2.04064758e-01  8.55895956e-02  4.96914681e-02]
 [-1.39919952e-01 -8.33021519e-02 -7.21984587e-03]
 [ 1.33102956e-01  1.10880565e-01  4.12217292e-02]
 [-1.24734363e-01  2.03995937e-01  6.97724441e-03]
 [ 2.03097471e-03 -2.38506405e-01  8.02831581e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.14406117]
curr_Stock_Price:  100.10537567224502
curr_Factors:  [100.10537567  -0.98501589  -0.99551383]
mat_Sqrt:  [[13.81415322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00782719 -0.00245088  0.09160425]
Stock Position:  -0.007827188108209445
Bond Position:  [3.92760478]


portfolio before change:  [3.13503626]
curr_Stock_Price:  101.32112439863499
curr_Factors:  [101.3211244   -0.92663015  -1.00763291]
mat_Sqrt:  [[14.6440171   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194468 -0.0079866  -0.26946269]
Stock Position:  -0.0019446796220115737
Bond Position:  [3.33207338]


portfolio before change:  [3.13471846]
curr_Stock_Price:  101.69873629551327
curr_Factors:  [101.6987363   -0.83884729  -0.99315613]
mat_Sqrt:  [[16.28120638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01736215 -0.04048998 -0.87814972]
Stock Position:  0.017362153409943234
Bond Position:  [1.3690094]


portfolio before change:  [3.13483815]
curr_Stock_Price:  101.6957733243474
curr_Factors:  [101.69577332  -0.77021994  -0.97915396]
mat_Sqrt:  [[17.68314354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00111423 -0.00659539  0.21422481]
Stock Position:  0.0011142280139773333
Bond Position:  [3.02152587]


portfolio before change:  [3.13338698]
curr_Stock_Price:  100.05438012721609
curr_Factors:  [100.05438013  -0.72032768  -0.97715034]
mat_Sqrt:  [[18.32444248  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02823166 -0.05085581  0.11386285]
Stock Position:  -0.028231660312701436
Bond Position:  [5.95808825]


portfolio before change:  [3.14736075]
curr_Stock_Price:  99.58579412882285
curr_Factors:  [99.58579413 -0.64359696 -0.95899137]
mat_Sqrt:  [[20.0540513   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00130178 -0.03711683 -0.41724105]
Stock Position:  -0.0013017753013312848
Bond Position:  [3.27699908]


portfolio before change:  [3.1494438]
curr_Stock_Price:  98.30031515135241
curr_Factors:  [98.30031515 -0.64269771 -0.94586076]
mat_Sqrt:  [[20.0748696   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00083745 -0.06064191 -0.07901555]
Stock Position:  0.0008374513325236307
Bond Position:  [3.06712207]


portfolio before change:  [3.14916226]
curr_Stock_Price:  97.50628792709658
curr_Factors:  [97.50628793 -0.86899008 -0.92755734]
mat_Sqrt:  [[16.17342476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00955423  0.08682089 -0.13247234]
Stock Position:  0.009554226389730778
Bond Position:  [2.21756511]


portfolio before change:  [3.15003777]
curr_Stock_Price:  97.56890913156828
curr_Factors:  [97.56890913 -0.95195459 -0.92321899]
mat_Sqrt:  [[14.96007981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00862857  0.00562399 -0.22444507]
Stock Position:  -0.008628574660691737
Bond Position:  [3.99191839]


portfolio before change:  [3.14116663]
curr_Stock_Price:  98.65485502364069
curr_Factors:  [98.65485502 -1.08223622 -0.93830209]
mat_Sqrt:  [[13.08006261  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00398738 -0.01199237 -0.21818026]
Stock Position:  0.0039873845853134
Bond Position:  [2.74779178]


portfolio before change:  [3.14227613]
curr_Stock_Price:  98.84696423909439
curr_Factors:  [98.84696424 -1.12795613 -0.95365353]
mat_Sqrt:  [[12.32911059  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00474156 -0.07689134  0.04330305]
Stock Position:  0.004741562411571385
Bond Position:  [2.67358708]


portfolio before change:  [3.14518279]
curr_Stock_Price:  99.38949254088722
curr_Factors:  [99.38949254 -1.26817812 -0.96924286]
mat_Sqrt:  [[10.60818025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060139 -0.00067276  0.03667049]
Stock Position:  -0.000601386840118287
Bond Position:  [3.20495432]


portfolio before change:  [3.14582265]
curr_Stock_Price:  98.99171352084404
curr_Factors:  [98.99171352 -0.83487041 -0.98069136]
mat_Sqrt:  [[16.11055065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01423744 -0.05884959  0.36661552]
Stock Position:  0.014237440818612487
Bond Position:  [1.73643399]


portfolio before change:  [3.14188773]
curr_Stock_Price:  98.70008889885938
curr_Factors:  [98.7000889  -0.87706528 -0.9510024 ]
mat_Sqrt:  [[15.86345703  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00509578 -0.01600459 -0.17297116]
Stock Position:  0.005095784117974592
Bond Position:  [2.63893338]


portfolio before change:  [3.14380492]
curr_Stock_Price:  99.01158194148134
curr_Factors:  [99.01158194 -1.30196301 -0.94989664]
mat_Sqrt:  [[10.41635522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00066325 -0.02107095 -0.0892988 ]
Stock Position:  0.0006632537160381969
Bond Position:  [3.07813512]


portfolio before change:  [3.14381234]
curr_Stock_Price:  98.4426097295598
curr_Factors:  [98.44260973 -1.34893417 -0.97557358]
mat_Sqrt:  [[ 9.63079699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298092 -0.02400393  0.00297938]
Stock Position:  -0.0029809201502171145
Bond Position:  [3.43726189]


portfolio before change:  [3.14582411]
curr_Stock_Price:  97.91187095596223
curr_Factors:  [97.91187096 -1.26689662 -0.9602492 ]
mat_Sqrt:  [[10.55840234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02821487 -0.09495912  0.19782362]
Stock Position:  -0.028214866053386443
Bond Position:  [5.90839443]


portfolio before change:  [3.15769633]
curr_Stock_Price:  97.51726950483005
curr_Factors:  [97.5172695  -1.24057588 -0.95045688]
mat_Sqrt:  [[10.90255017  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02123475 -0.01059004 -0.11178897]
Stock Position:  -0.02123475186120999
Bond Position:  [5.22845135]


portfolio before change:  [3.14714886]
curr_Stock_Price:  98.04475710916859
curr_Factors:  [98.04475711 -1.15458871 -0.96601539]
mat_Sqrt:  [[11.76136465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04065331 0.41835926 1.4977897 ]
Stock Position:  0.040653313681394264
Bond Position:  [-0.8386954]


portfolio before change:  [3.14859856]
curr_Stock_Price:  98.08299602731158
curr_Factors:  [98.08299603 -0.97794121 -0.96351791]
mat_Sqrt:  [[14.07436276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01187315 -0.00748983  0.50107074]
Stock Position:  -0.01187315044457942
Bond Position:  [4.31315272]


portfolio before change:  [3.16035314]
curr_Stock_Price:  97.13839327271714
curr_Factors:  [97.13839327 -0.9123792  -0.92705734]
mat_Sqrt:  [[15.43596464  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00617881  0.04413562 -0.10684749]
Stock Position:  -0.006178807865761515
Bond Position:  [3.76055261]


portfolio before change:  [3.16532405]
curr_Stock_Price:  96.4099663511033
curr_Factors:  [96.40996635 -0.93114611 -0.92185615]
mat_Sqrt:  [[15.11378628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00684195 -0.00864258  0.17005093]
Stock Position:  0.006841953287404127
Bond Position:  [2.50569157]


portfolio before change:  [3.16662924]
curr_Stock_Price:  96.55494844264973
curr_Factors:  [96.55494844 -0.68099552 -0.91219569]
mat_Sqrt:  [[19.62729219  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00598668  0.00189376 -0.29361769]
Stock Position:  -0.0059866787663495225
Bond Position:  [3.7446727]


portfolio before change:  [3.16232764]
curr_Stock_Price:  97.35167114942347
curr_Factors:  [97.35167115 -0.80340652 -0.92219983]
mat_Sqrt:  [[17.33493021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0007092  -0.02969685  0.32433627]
Stock Position:  0.0007091995140801907
Bond Position:  [3.09328588]


portfolio before change:  [3.1629416]
curr_Stock_Price:  97.67213803515821
curr_Factors:  [97.67213804 -0.80222294 -0.92782259]
mat_Sqrt:  [[17.31495888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00617206  0.024817   -0.07707011]
Stock Position:  -0.006172058573130372
Bond Position:  [3.76577975]


portfolio before change:  [3.15871141]
curr_Stock_Price:  98.4337855681224
curr_Factors:  [98.43378557 -0.83595362 -0.92527278]
mat_Sqrt:  [[16.91427083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00676091 -0.01070874 -0.03631695]
Stock Position:  0.0067609060932495805
Bond Position:  [2.49320983]


portfolio before change:  [3.16303263]
curr_Stock_Price:  99.02683356218112
curr_Factors:  [99.02683356 -0.8082485  -0.92619467]
mat_Sqrt:  [[17.47808289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00254759 -0.02130559  0.22258337]
Stock Position:  0.0025475850924520094
Bond Position:  [2.91075334]


portfolio before change:  [3.16096879]
curr_Stock_Price:  98.07389211634745
curr_Factors:  [98.07389212 -0.85453659 -0.90270596]
mat_Sqrt:  [[16.91970035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00074389  0.01347089  0.07151955]
Stock Position:  -0.0007438893267327653
Bond Position:  [3.23392492]


portfolio before change:  [3.16085904]
curr_Stock_Price:  98.76488530414521
curr_Factors:  [98.7648853  -0.88178071 -0.90428747]
mat_Sqrt:  [[16.55476469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04894715  0.01262135 -2.46716343]
Stock Position:  -0.04894714552032631
Bond Position:  [7.99511825]


portfolio before change:  [3.24792946]
curr_Stock_Price:  97.00643819663816
curr_Factors:  [97.0064382  -0.90566865 -0.88850287]
mat_Sqrt:  [[16.12878934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00428518 -0.03466241 -0.30193508]
Stock Position:  0.004285178798603708
Bond Position:  [2.83223952]


portfolio before change:  [3.24420288]
curr_Stock_Price:  96.05417170590769
curr_Factors:  [96.05417171 -0.95754213 -0.90534371]
mat_Sqrt:  [[14.90991585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00849289  0.00095985 -0.11304612]
Stock Position:  0.008492887939002304
Bond Position:  [2.42842556]


portfolio before change:  [3.24379478]
curr_Stock_Price:  95.97037650264828
curr_Factors:  [95.9703765  -0.87445806 -0.90612304]
mat_Sqrt:  [[16.17486463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00172333  0.0604067  -0.16043251]
Stock Position:  0.001723326480550317
Bond Position:  [3.07840649]


portfolio before change:  [3.24352975]
curr_Stock_Price:  95.59328146929442
curr_Factors:  [95.59328147 -0.80428999 -0.906614  ]
mat_Sqrt:  [[17.27393219  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00944812  0.00539186 -0.48756219]
Stock Position:  -0.00944811677366551
Bond Position:  [4.14670624]


portfolio before change:  [3.24234129]
curr_Stock_Price:  95.7739348426261
curr_Factors:  [95.77393484 -0.86135062 -0.92446074]
mat_Sqrt:  [[16.05755108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184404  0.04793268  0.2712883 ]
Stock Position:  -0.001844037156432216
Bond Position:  [3.41895198]


portfolio before change:  [3.24496239]
curr_Stock_Price:  94.58431396861769
curr_Factors:  [94.58431397 -0.58425059 -0.92912113]
mat_Sqrt:  [[20.82428654  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00920616  0.02706581  0.14175593]
Stock Position:  -0.009206155298920347
Bond Position:  [4.11572027]


portfolio before change:  [3.24434548]
curr_Stock_Price:  94.70721017437054
curr_Factors:  [94.70721017 -0.42425746 -0.91831256]
mat_Sqrt:  [[24.73502156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00580329 -0.02634245 -0.02059621]
Stock Position:  -0.005803291866236437
Bond Position:  [3.79395907]


portfolio before change:  [3.23985137]
curr_Stock_Price:  95.56334299424897
curr_Factors:  [95.56334299 -0.48754629 -0.94389747]
mat_Sqrt:  [[22.83616698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00632244 0.03506351 0.11759412]
Stock Position:  0.0063224371323989965
Bond Position:  [2.63565814]


portfolio before change:  [3.24670304]
curr_Stock_Price:  96.59493684648058
curr_Factors:  [96.59493685 -0.58381978 -0.95726455]
mat_Sqrt:  [[20.68568681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00570651  0.06450918  0.01990414]
Stock Position:  -0.005706505542515994
Bond Position:  [3.79792258]


portfolio before change:  [3.24456783]
curr_Stock_Price:  97.05230601251283
curr_Factors:  [97.05230601 -0.79266694 -0.96385427]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.24456783]
Stock Price:  96.87746624600128
PL:  [3.24456783]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.34955375e-01 -3.31101069e-03  5.66305319e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.84442374e-01  2.41142480e-01  3.12834788e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-6.94765453e-01 -2.09949392e-01  3.56753074e-02]
 [-5.35022766e-02 -1.74299485e-03  2.90947677e-02]
 [ 2.81808891e-02  8.02215256e-02  4.36683557e-03]
 [ 3.14987740e-01 -6.01257669e-02 -7.24845357e-02]
 [-4.94547807e-01 -2.81921160e-02 -5.46230051e-02]
 [ 4.02592464e-02 -5.16425393e-03 -3.57223185e-02]
 [-1.03592895e-02 -2.28752571e-01  1.28534159e-01]
 [-8.70938311e-02  7.96136140e-03  5.66126036e-02]
 [ 1.13919048e-01 -2.66713620e-02  2.77409750e-01]
 [ 4.38042000e-02  3.17954426e-01  2.75919341e-01]
 [ 7.15324156e-02 -1.12351033e-01 -5.19003018e-02]
 [-3.99131278e-02  5.23440616e-02  4.54966923e-02]
 [-5.07457522e-01 -2.43242179e-01  1.40217283e-01]
 [-1.24941305e-01  1.85236178e-02 -2.23284745e-02]
 [ 1.73266693e-01  8.29763931e-01  2.17012831e-01]
 [-9.53335026e-03  3.06059639e-02  2.76975186e-02]
 [-1.85069842e-02 -1.94234478e-01  2.82876249e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.43096630e-01 -2.99202706e-02  1.52494030e-01]
 [ 8.18362721e-02 -5.78520284e-02 -4.91073859e-02]
 [-6.58362023e-02 -1.04640916e-01  1.34243813e-01]
 [ 1.45303285e-02  6.29370037e-02 -7.29046422e-03]
 [ 1.24581686e-02 -5.60476299e-02  5.28530382e-02]
 [ 2.83365053e-02  4.58212106e-02 -7.20349846e-02]
 [-6.66412634e-01 -3.62780655e-02 -9.84290914e-01]
 [ 4.09077150e-02 -1.02381275e-01 -7.89396979e-02]
 [ 6.20843766e-02  5.51560952e-02  8.79793826e-02]
 [ 2.36772689e-02  1.23771216e-01 -2.41507026e-02]
 [-1.29712100e-01 -1.39369456e-02 -1.05982329e-01]
 [-6.01616543e-02  1.25612155e-01  1.28178021e-01]
 [ 1.70925529e-01 -1.63958268e-01 -9.72961814e-02]
 [-1.69022573e-02  2.06110357e-01  8.19219159e-02]
 [ 7.84625595e-02  6.72227687e-02 -3.13912795e-02]
 [-3.71641978e-02  8.03696713e-02 -8.67767181e-03]
 [-7.40087482e-02 -2.21030213e-01  7.86711109e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.7148144]
curr_Stock_Price:  100.04556873356891
curr_Factors:  [100.04556873  -0.94211128  -0.99478722]
mat_Sqrt:  [[14.42160263  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00856224 -0.00104703  0.16155114]
Stock Position:  -0.008562238832839898
Bond Position:  [3.57142845]


portfolio before change:  [2.71524867]
curr_Stock_Price:  100.04699189255707
curr_Factors:  [100.04699189  -0.95935313  -1.00526776]
mat_Sqrt:  [[14.02749188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323515  0.01411938  0.0859571 ]
Stock Position:  -0.0032351501765395924
Bond Position:  [3.03891571]


portfolio before change:  [2.71554267]
curr_Stock_Price:  100.07353886024606
curr_Factors:  [100.07353886  -0.83211984  -0.99270949]
mat_Sqrt:  [[16.13637391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0219706  0.07625595 0.89243057]
Stock Position:  0.021970597737272383
Bond Position:  [0.5168672]


portfolio before change:  [2.73122936]
curr_Stock_Price:  100.78458331423813
curr_Factors:  [100.78458331  -0.88486752  -0.99414762]
mat_Sqrt:  [[15.39388358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00127993 -0.00659539  0.21422481]
Stock Position:  0.0012799274335472625
Bond Position:  [2.6022324]


portfolio before change:  [2.73083259]
curr_Stock_Price:  100.22043670024298
curr_Factors:  [100.2204367   -0.92386856  -0.99397018]
mat_Sqrt:  [[14.72480349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04705694 -0.06639183  0.10177172]
Stock Position:  -0.04705693571110835
Bond Position:  [7.44689923]


portfolio before change:  [2.68672344]
curr_Stock_Price:  101.17757665419381
curr_Factors:  [101.17757665  -0.95926396  -0.98291007]
mat_Sqrt:  [[14.50804222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328151 -0.00055118  0.08299927]
Stock Position:  -0.003281513465832337
Bond Position:  [3.01873902]


portfolio before change:  [2.6883908]
curr_Stock_Price:  100.78446565274993
curr_Factors:  [100.78446565  -1.09743716  -0.95851671]
mat_Sqrt:  [[12.89745951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00241471 0.02536827 0.01245737]
Stock Position:  0.0024147062898902043
Bond Position:  [2.44502592]


portfolio before change:  [2.69045632]
curr_Stock_Price:  101.51328194738173
curr_Factors:  [101.51328195  -0.99131858  -0.92779172]
mat_Sqrt:  [[14.89580074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02004857 -0.01901344 -0.2067782 ]
Stock Position:  0.020048566782844505
Bond Position:  [0.65526051]


portfolio before change:  [2.69066597]
curr_Stock_Price:  101.51965315283212
curr_Factors:  [101.51965315  -0.95670567  -0.93340922]
mat_Sqrt:  [[15.33499563  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03302418 -0.00891513 -0.15582423]
Stock Position:  -0.03302417628799256
Bond Position:  [6.04326889]


portfolio before change:  [2.69426185]
curr_Stock_Price:  101.43364272025399
curr_Factors:  [101.43364272  -0.83969723  -0.93321833]
mat_Sqrt:  [[17.22719545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00190595 -0.00163308 -0.10190583]
Stock Position:  0.0019059468075079272
Bond Position:  [2.50093472]


portfolio before change:  [2.69554926]
curr_Stock_Price:  101.9450787619674
curr_Factors:  [101.94507876  -1.18201496  -0.95214025]
mat_Sqrt:  [[12.06464187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082649 -0.07233791  0.36667218]
Stock Position:  0.0008264870211902591
Bond Position:  [2.61129297]


portfolio before change:  [2.69620562]
curr_Stock_Price:  102.34427613514853
curr_Factors:  [102.34427614  -1.09137224  -0.94191516]
mat_Sqrt:  [[13.39732406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00562293  0.0025176   0.1615    ]
Stock Position:  -0.005622934102768275
Bond Position:  [3.27168074]


portfolio before change:  [2.69685838]
curr_Stock_Price:  102.30092210069135
curr_Factors:  [102.3009221   -1.02103737  -0.93153261]
mat_Sqrt:  [[14.51741116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01170019 -0.00843423  0.7913728 ]
Stock Position:  0.011700186942292294
Bond Position:  [1.49991847]


portfolio before change:  [2.69253593]
curr_Stock_Price:  101.91546172977611
curr_Factors:  [101.91546173  -0.961315    -0.93056696]
mat_Sqrt:  [[15.36760466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00704961 0.10054602 0.78712108]
Stock Position:  0.0070496053230122094
Bond Position:  [1.97407214]


portfolio before change:  [2.68782409]
curr_Stock_Price:  101.21207294992288
curr_Factors:  [101.21207295  -0.97809974  -0.90715359]
mat_Sqrt:  [[15.36304148  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00377773 -0.03552852 -0.14805711]
Stock Position:  0.00377772980205965
Bond Position:  [2.30547222]


portfolio before change:  [2.69233599]
curr_Stock_Price:  102.33012543482306
curr_Factors:  [102.33012543  -0.7804349   -0.9126928 ]
mat_Sqrt:  [[18.8229414   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155526  0.01655265  0.1297894 ]
Stock Position:  -0.0015552636468462214
Bond Position:  [2.85148631]


portfolio before change:  [2.69186514]
curr_Stock_Price:  102.86206691798603
curr_Factors:  [102.86206692  -1.03173158  -0.91737337]
mat_Sqrt:  [[14.64770975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03311892 -0.07691993  0.40000088]
Stock Position:  -0.03311891642652406
Bond Position:  [6.09854534]


portfolio before change:  [2.6389064]
curr_Stock_Price:  104.48413401304477
curr_Factors:  [104.48413401  -0.95460102  -0.94464672]
mat_Sqrt:  [[15.63930813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00824978  0.00585768 -0.06369692]
Stock Position:  -0.008249777223738727
Bond Position:  [3.50087723]


portfolio before change:  [2.6511843]
curr_Stock_Price:  103.0489117984348
curr_Factors:  [103.0489118   -0.81552439  -0.94748291]
mat_Sqrt:  [[17.67579951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01352067 0.26239439 0.6190772 ]
Stock Position:  0.013520670666575776
Bond Position:  [1.2578939]


portfolio before change:  [2.66497221]
curr_Stock_Price:  104.05704673873102
curr_Factors:  [104.05704674  -0.79845737  -0.94791747]
mat_Sqrt:  [[18.14807386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00017023  0.00967846  0.07901331]
Stock Position:  -0.00017023158358712927
Bond Position:  [2.682686]


portfolio before change:  [2.66549915]
curr_Stock_Price:  102.93162232882328
curr_Factors:  [102.93162233  -0.72906458  -0.9531211 ]
mat_Sqrt:  [[19.14189184  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00092718 -0.06142233  0.08069672]
Stock Position:  -0.0009271763594735819
Bond Position:  [2.76093491]


portfolio before change:  [2.66538645]
curr_Stock_Price:  103.4254219519267
curr_Factors:  [103.42542195  -0.53986368  -0.93433732]
mat_Sqrt:  [[23.68044948  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164139  0.01916992 -0.08961985]
Stock Position:  -0.0016413904523146577
Bond Position:  [2.83514795]


portfolio before change:  [2.66669066]
curr_Stock_Price:  102.84676824295659
curr_Factors:  [102.84676824  -0.63242987  -0.92725579]
mat_Sqrt:  [[21.61861026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00802326 -0.00946162  0.43502302]
Stock Position:  0.008023263457230602
Bond Position:  [1.84152394]


portfolio before change:  [2.66920833]
curr_Stock_Price:  103.13187255235964
curr_Factors:  [103.13187255  -0.84707827  -0.92570753]
mat_Sqrt:  [[17.51789072  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0040141  -0.01829442 -0.1400897 ]
Stock Position:  0.004014098338729714
Bond Position:  [2.25522685]


portfolio before change:  [2.66674374]
curr_Stock_Price:  102.4476557274083
curr_Factors:  [102.44765573  -0.82107943  -0.91893137]
mat_Sqrt:  [[17.98145942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00228767 -0.03309036  0.38296023]
Stock Position:  -0.002287668348860737
Bond Position:  [2.90111]


portfolio before change:  [2.66448177]
curr_Stock_Price:  103.59494991410254
curr_Factors:  [103.59494991  -0.91340194  -0.93321404]
mat_Sqrt:  [[16.34419195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00089739  0.01990243 -0.02079767]
Stock Position:  0.0008973949440263933
Bond Position:  [2.57151619]


portfolio before change:  [2.66485029]
curr_Stock_Price:  103.64739150792556
curr_Factors:  [103.64739151  -0.59805818  -0.94933789]
mat_Sqrt:  [[22.0563073   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098836 -0.01772382  0.15077501]
Stock Position:  0.0009883615572400838
Bond Position:  [2.56240919]


portfolio before change:  [2.66321433]
curr_Stock_Price:  101.66807694343296
curr_Factors:  [101.66807694  -0.58801923  -0.93814036]
mat_Sqrt:  [[22.09947312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0006704   0.01448994 -0.20549576]
Stock Position:  0.000670401693367923
Bond Position:  [2.59505588]


portfolio before change:  [2.66233851]
curr_Stock_Price:  99.87777320890423
curr_Factors:  [99.87777321 -0.57422757 -0.95906175]
mat_Sqrt:  [[21.55607882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04027944 -0.01147213 -2.807908  ]
Stock Position:  -0.04027944407622219
Bond Position:  [6.68535969]


portfolio before change:  [2.74456303]
curr_Stock_Price:  97.85716944928798
curr_Factors:  [97.85716945 -0.35743921 -0.97129964]
mat_Sqrt:  [[25.91365658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085479 -0.0323758  -0.22519299]
Stock Position:  0.0008547903460671997
Bond Position:  [2.66091567]


portfolio before change:  [2.74631436]
curr_Stock_Price:  99.51686755999322
curr_Factors:  [ 9.95168676e+01  4.62399461e-02 -9.59272422e-01]
mat_Sqrt:  [[39.93665911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00203991 0.01744189 0.25098069]
Stock Position:  0.0020399106726011126
Bond Position:  [2.54330884]


portfolio before change:  [2.74770548]
curr_Stock_Price:  100.04296430384242
curr_Factors:  [100.0429643   -0.11087962  -0.97284757]
mat_Sqrt:  [[33.84775036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00064829  0.0391399  -0.06889523]
Stock Position:  0.0006482937907684858
Bond Position:  [2.68284825]


portfolio before change:  [2.74905231]
curr_Stock_Price:  101.60313072726446
curr_Factors:  [ 1.01603131e+02 -8.34307384e-02 -9.85911761e-01]
mat_Sqrt:  [[34.87366117  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435015 -0.00440725 -0.30233809]
Stock Position:  -0.004350145570746543
Bond Position:  [3.19104072]


portfolio before change:  [2.73679589]
curr_Stock_Price:  104.51230276527072
curr_Factors:  [104.51230277  -0.28814764  -0.99301767]
mat_Sqrt:  [[29.02447617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105959  0.03972205  0.36565622]
Stock Position:  -0.0010595930575069447
Bond Position:  [2.8475364]


portfolio before change:  [2.73697034]
curr_Stock_Price:  104.68360616524535
curr_Factors:  [104.68360617  -0.33979399  -0.97290688]
mat_Sqrt:  [[28.16955142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00521242 -0.05184816 -0.27755892]
Stock Position:  0.005212423973434216
Bond Position:  [2.191315]


portfolio before change:  [2.73469456]
curr_Stock_Price:  104.19444444664715
curr_Factors:  [104.19444445  -0.32877028  -0.99803417]
mat_Sqrt:  [[27.64526208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.85989565e-04 6.51778177e-02 2.33700423e-01]
Stock Position:  0.0001859895650176512
Bond Position:  [2.71531548]


portfolio before change:  [2.73501332]
curr_Stock_Price:  104.08330971569187
curr_Factors:  [104.08330972  -0.41213042  -0.99523665]
mat_Sqrt:  [[25.4782351   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00289622  0.02125771 -0.08955058]
Stock Position:  0.0028962181080000775
Bond Position:  [2.43356536]


portfolio before change:  [2.7327582]
curr_Stock_Price:  103.19962808699763
curr_Factors:  [103.19962809  -0.31258001  -0.9929603 ]
mat_Sqrt:  [[27.9697882   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131786  0.02541512 -0.02475498]
Stock Position:  -0.0013178642552900402
Bond Position:  [2.8687613]


portfolio before change:  [2.73302804]
curr_Stock_Price:  103.26699536938916
curr_Factors:  [103.26699537  -0.4422752   -0.98065908]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.73302804]
Stock Price:  103.2227605651403
PL:  [-0.48973253]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.05480317e-01  1.47952776e-01  2.43816349e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 3.14099712e-01  1.37628805e-01  1.31490129e-01]
 [ 1.26548641e-03 -1.22741690e-02  8.32586971e-02]
 [-4.93346267e-01 -1.52895051e-01  4.05974749e-02]
 [ 2.76372493e-02 -1.57305696e-01 -2.06740519e-01]
 [ 2.09998293e-02 -2.72410564e-01 -4.08225220e-02]
 [ 7.67193916e-02  3.10685467e-01 -1.98479537e-02]
 [ 1.20028336e-02  2.23330127e-02 -4.20008790e-02]
 [ 1.20691386e-01  7.34626116e-03  1.60202626e-01]
 [ 1.55906547e-01 -2.60938837e-01 -1.99897979e-02]
 [-5.21967344e-02 -5.95906806e-02 -1.28361483e-01]
 [ 2.38494836e-01 -2.15566101e-01  1.10268127e-01]
 [ 8.96561917e-02 -5.52230237e-02 -6.02963721e-02]
 [ 3.53200522e-03 -3.01070765e-02 -8.08878199e-03]
 [-3.33725349e-02 -5.06574547e-02  9.42415312e-03]
 [-3.92210477e-01 -3.02669328e-01  1.02907276e-01]
 [-1.40743634e-01  9.21179888e-03 -3.75239920e-02]
 [ 4.34008477e-01  1.56280010e+00  8.11007386e-01]
 [-5.73582188e-02  1.51765753e-03  8.18343855e-02]
 [-8.73601246e-02  6.09494917e-02 -4.00838075e-02]
 [ 3.58244059e-02  2.10694038e-02  1.56805858e-02]
 [ 2.40599008e-02 -2.98551923e-02  3.34682913e-02]
 [ 3.97859849e-02  1.25314627e-01  9.50594063e-02]
 [-6.60018737e-02 -1.36881231e-01 -6.02724366e-02]
 [ 9.64892202e-02  6.02211439e-03 -1.17424747e-02]
 [ 1.75434296e-02 -5.87170236e-02  1.97644474e-02]
 [-9.59189389e-04  4.22494463e-02  8.26413273e-03]
 [-4.72907358e-01  8.59024958e-02 -5.92004775e-01]
 [ 4.93224291e-02 -1.18586287e-01 -7.47866515e-02]
 [ 1.15278848e-01  1.54911535e-02 -1.87674078e-02]
 [ 2.74103841e-02  1.44783555e-01 -3.40884896e-02]
 [-1.23694934e-02  3.87172316e-02 -1.00442709e-01]
 [-5.56276775e-02  1.51814767e-01  9.57071394e-02]
 [-2.71312839e-01  9.68386107e-02 -7.40661781e-03]
 [-1.55217519e-01 -1.00409828e-01 -5.61051292e-03]
 [ 1.12712900e-01  9.17140603e-02  3.00286806e-02]
 [-1.26457037e-01  2.08297858e-01  7.57391239e-03]
 [ 2.12967198e-03 -2.44558699e-01  8.31426704e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.93117768]
curr_Stock_Price:  99.39824281710459
curr_Factors:  [99.39824282 -0.9003421  -0.99783557]
mat_Sqrt:  [[14.89397497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01019818  0.04678678  0.69554018]
Stock Position:  -0.01019817674444852
Bond Position:  [-0.91749683]


portfolio before change:  [-1.93315545]
curr_Stock_Price:  99.58092993466892
curr_Factors:  [99.58092993 -0.75003541 -0.9985525 ]
mat_Sqrt:  [[17.32902383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261879  0.01411938  0.0859571 ]
Stock Position:  -0.0026187881836226687
Bond Position:  [-1.67237408]


portfolio before change:  [-1.93632329]
curr_Stock_Price:  100.71075970731803
curr_Factors:  [100.71075971  -0.80858392  -0.98245497]
mat_Sqrt:  [[16.79722605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02050896 0.04352205 0.37510474]
Stock Position:  0.020508956764416775
Bond Position:  [-4.00179591]


portfolio before change:  [-1.92963734]
curr_Stock_Price:  101.06115327294783
curr_Factors:  [101.06115327  -0.51007487  -0.963064  ]
mat_Sqrt:  [[23.16371265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00077465 -0.00388143  0.23751389]
Stock Position:  0.0007746460754250663
Bond Position:  [-2.00792397]


portfolio before change:  [-1.93019555]
curr_Stock_Price:  100.6645852677048
curr_Factors:  [100.66458527  -0.52920118  -0.91983095]
mat_Sqrt:  [[23.6357861   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02068927 -0.04834966  0.1158133 ]
Stock Position:  -0.02068926640338187
Bond Position:  [0.15248088]


portfolio before change:  [-1.89705141]
curr_Stock_Price:  99.06351009611765
curr_Factors:  [99.0635101  -0.52825975 -0.91456179]
mat_Sqrt:  [[23.40476464  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079578 -0.04974443 -0.58977316]
Stock Position:  -0.0007957823251494151
Bond Position:  [-1.81821842]


portfolio before change:  [-1.89619325]
curr_Stock_Price:  97.69949785565427
curr_Factors:  [97.69949786 -0.53869371 -0.91490774]
mat_Sqrt:  [[22.83501186  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0002467  -0.08614378 -0.11645529]
Stock Position:  0.0002466982033369172
Bond Position:  [-1.92029554]


portfolio before change:  [-1.89682902]
curr_Stock_Price:  96.09543530697168
curr_Factors:  [96.09543531 -0.63708712 -0.91201845]
mat_Sqrt:  [[20.41431247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00395261  0.09824737 -0.05662069]
Stock Position:  0.003952609691442009
Bond Position:  [-2.27665677]


portfolio before change:  [-1.89663917]
curr_Stock_Price:  96.2154704858559
curr_Factors:  [96.21547049 -0.79580605 -0.90972201]
mat_Sqrt:  [[17.48008281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00022918  0.00706232 -0.11981682]
Stock Position:  0.0002291794595704635
Bond Position:  [-1.91868978]


portfolio before change:  [-1.8966266]
curr_Stock_Price:  97.31688915329781
curr_Factors:  [97.31688915 -0.81140043 -0.91239904]
mat_Sqrt:  [[17.36007595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00884687 0.00232309 0.4570135 ]
Stock Position:  0.008846867401481742
Bond Position:  [-2.75757621]


portfolio before change:  [-1.898141]
curr_Stock_Price:  97.18467465514772
curr_Factors:  [97.18467466 -0.69984299 -0.94685797]
mat_Sqrt:  [[18.72598385  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00774799 -0.08251611 -0.05702533]
Stock Position:  0.007747989943410982
Bond Position:  [-2.65112688]


portfolio before change:  [-1.89267924]
curr_Stock_Price:  97.9323751286371
curr_Factors:  [97.93237513 -0.88454478 -0.97368765]
mat_Sqrt:  [[15.27236152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0052341  -0.01884423 -0.36617958]
Stock Position:  -0.005234098013195183
Bond Position:  [-1.38009158]


portfolio before change:  [-1.89836574]
curr_Stock_Price:  98.98584915644585
curr_Factors:  [98.98584916 -1.30170513 -0.99299571]
mat_Sqrt:  [[ 9.97693627  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02560278 -0.06816799  0.31456427]
Stock Position:  0.025602782593053215
Bond Position:  [-4.43267892]


portfolio before change:  [-1.90430154]
curr_Stock_Price:  98.77565018552082
curr_Factors:  [98.77565019 -1.47296503 -1.00239783]
mat_Sqrt:  [[ 8.31023813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00913601 -0.01746305 -0.17200877]
Stock Position:  0.009136007029862322
Bond Position:  [-2.80671658]


portfolio before change:  [-1.90799054]
curr_Stock_Price:  98.41026819251927
curr_Factors:  [98.41026819 -1.60113757 -0.98031396]
mat_Sqrt:  [[ 7.44612389  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0001482  -0.00952069 -0.02307504]
Stock Position:  0.00014820168874356686
Bond Position:  [-1.9225751]


portfolio before change:  [-1.908254]
curr_Stock_Price:  98.25418524325329
curr_Factors:  [98.25418524 -1.5665555  -0.98878025]
mat_Sqrt:  [[ 7.63102442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429258 -0.01601929  0.02688449]
Stock Position:  -0.004292583237846738
Bond Position:  [-1.48648974]


portfolio before change:  [-1.90949551]
curr_Stock_Price:  98.50011767817107
curr_Factors:  [98.50011768 -1.65076667 -1.0067035 ]
mat_Sqrt:  [[ 6.9073604   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05487183 -0.09571245  0.29356581]
Stock Position:  -0.05487182996161596
Bond Position:  [3.4953862]


portfolio before change:  [-1.92853066]
curr_Stock_Price:  98.85498283756387
curr_Factors:  [98.85498284 -1.76340795 -1.04428217]
mat_Sqrt:  [[ 5.96532677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02483776  0.00291303 -0.1070455 ]
Stock Position:  -0.024837757443339797
Bond Position:  [0.52680542]


portfolio before change:  [-1.93107291]
curr_Stock_Price:  98.95998844922056
curr_Factors:  [98.95998845 -1.7903598  -1.04656012]
mat_Sqrt:  [[ 5.79963909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11033548 0.49420078 2.31357833]
Stock Position:  0.11033548488226383
Bond Position:  [-12.84987122]


portfolio before change:  [-1.88372617]
curr_Stock_Price:  99.40366327034617
curr_Factors:  [99.40366327 -1.68089454 -1.06635728]
mat_Sqrt:  [[ 6.37215141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00637377  0.00047993  0.23345072]
Stock Position:  -0.006373774946757227
Bond Position:  [-1.25014959]


portfolio before change:  [-1.8855312]
curr_Stock_Price:  99.66234069482188
curr_Factors:  [99.66234069 -1.56904012 -1.08688901]
mat_Sqrt:  [[ 6.9996402   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01342476  0.01927392 -0.11434795]
Stock Position:  -0.013424759819881345
Bond Position:  [-0.54758821]


portfolio before change:  [-1.89432299]
curr_Stock_Price:  100.31213569991172
curr_Factors:  [100.3121357   -1.72511538  -1.1141228 ]
mat_Sqrt:  [[ 5.86526991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00674636 0.00666273 0.04473235]
Stock Position:  0.006746356499527907
Bond Position:  [-2.57106442]


portfolio before change:  [-1.89462077]
curr_Stock_Price:  100.31563849521436
curr_Factors:  [100.3156385   -1.63318047  -1.10271802]
mat_Sqrt:  [[ 6.50403731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00463108 -0.00944104  0.09547572]
Stock Position:  0.004631081897358842
Bond Position:  [-2.3591907]


portfolio before change:  [-1.89586441]
curr_Stock_Price:  100.11077869448701
curr_Factors:  [100.11077869  -1.35416428  -1.09561298]
mat_Sqrt:  [[ 8.64084264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00722447 0.03962796 0.27117803]
Stock Position:  0.007224470730402122
Bond Position:  [-2.6191118]


portfolio before change:  [-1.89908248]
curr_Stock_Price:  99.71065688873446
curr_Factors:  [99.71065689 -1.194567   -1.10631197]
mat_Sqrt:  [[ 9.98809212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00819368 -0.04328565 -0.17194049]
Stock Position:  -0.008193676071420524
Bond Position:  [-1.08208566]


portfolio before change:  [-1.89817089]
curr_Stock_Price:  99.58289240451278
curr_Factors:  [99.5828924  -1.03149489 -1.12682178]
mat_Sqrt:  [[11.50375747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00819278  0.00190436 -0.03349801]
Stock Position:  0.00819278294008829
Bond Position:  [-2.71403191]


portfolio before change:  [-1.89708128]
curr_Stock_Price:  99.75730096296914
curr_Factors:  [99.75730096 -0.92118101 -1.12896832]
mat_Sqrt:  [[12.84032887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0015624  -0.01856795  0.05638247]
Stock Position:  0.0015624026201096434
Bond Position:  [-2.05294234]


portfolio before change:  [-1.89921002]
curr_Stock_Price:  98.55907284845107
curr_Factors:  [98.55907285 -1.08362433 -1.12720288]
mat_Sqrt:  [[10.80305416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00016834 0.01336045 0.02357527]
Stock Position:  0.0001683408809367323
Bond Position:  [-1.91580155]


portfolio before change:  [-1.89953583]
curr_Stock_Price:  98.04631060248303
curr_Factors:  [98.0463106  -1.26607851 -1.11000919]
mat_Sqrt:  [[ 9.10981343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06493347  0.02716475 -1.68882484]
Stock Position:  -0.06493347404149583
Bond Position:  [4.46695173]


portfolio before change:  [-1.87796519]
curr_Stock_Price:  97.72271421807166
curr_Factors:  [97.72271422 -1.14536251 -1.114256  ]
mat_Sqrt:  [[10.20130354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00303832 -0.03750028 -0.2133455 ]
Stock Position:  0.003038315927892095
Bond Position:  [-2.17487767]


portfolio before change:  [-1.87938189]
curr_Stock_Price:  97.34591910723302
curr_Factors:  [97.34591911 -0.61553584 -1.12501556]
mat_Sqrt:  [[17.07677605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00654971  0.00489873 -0.05353819]
Stock Position:  0.006549710959911516
Bond Position:  [-2.51696952]


portfolio before change:  [-1.88466613]
curr_Stock_Price:  96.58716909697019
curr_Factors:  [96.5871691  -0.45872057 -1.10438513]
mat_Sqrt:  [[20.23351136  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00119556  0.04578458 -0.09724497]
Stock Position:  0.0011955609281438797
Bond Position:  [-2.00014197]


portfolio before change:  [-1.88652506]
curr_Stock_Price:  95.24144294715111
curr_Factors:  [95.24144295 -0.36452946 -1.08521427]
mat_Sqrt:  [[22.34653883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142629  0.01224346 -0.28653509]
Stock Position:  -0.001426288033836299
Bond Position:  [-1.75068333]


portfolio before change:  [-1.88681024]
curr_Stock_Price:  95.28795441193078
curr_Factors:  [ 9.52879544e+01 -5.22128346e-02 -1.10833552e+00]
mat_Sqrt:  [[29.85508117  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010776   0.04800804  0.27302583]
Stock Position:  -0.001077595428958032
Bond Position:  [-1.78412838]


portfolio before change:  [-1.88573134]
curr_Stock_Price:  94.07977068114997
curr_Factors:  [ 9.40797707e+01 -6.79519370e-02 -1.09565879e+00]
mat_Sqrt:  [[29.38640985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00919896  0.03062306 -0.02112902]
Stock Position:  -0.009198957880321658
Bond Position:  [-1.02029549]


portfolio before change:  [-1.88627843]
curr_Stock_Price:  94.12537894556647
curr_Factors:  [ 9.41253789e+01 -2.12003003e-02 -1.07826272e+00]
mat_Sqrt:  [[31.34844598  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0050706  -0.03175238 -0.01600523]
Stock Position:  -0.005070596824802687
Bond Position:  [-1.40900659]


portfolio before change:  [-1.89708866]
curr_Stock_Price:  96.22258445642784
curr_Factors:  [96.22258446 -0.34264868 -1.06731649]
mat_Sqrt:  [[23.49291582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00515945 0.02900253 0.08566347]
Stock Position:  0.005159450027530577
Bond Position:  [-2.39354427]


portfolio before change:  [-1.89657416]
curr_Stock_Price:  96.38029584789722
curr_Factors:  [96.38029585 -0.45436135 -1.07278775]
mat_Sqrt:  [[20.9293541   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00571125  0.06586957  0.02160626]
Stock Position:  -0.005711250817730888
Bond Position:  [-1.34612212]


portfolio before change:  [-1.90338907]
curr_Stock_Price:  97.54407412211607
curr_Factors:  [97.54407412 -0.57347993 -1.09026903]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.90338907]
Stock Price:  98.63546001115874
PL:  [-1.90338907]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [ 1.52225051e-02  1.17903608e-01  3.27868160e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.08041202e-01 -1.09540408e-02 -4.35166563e-02]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.18326766e+00 -3.48323357e-01  2.37375683e-02]
 [-4.95584427e-02 -9.30787308e-03  1.76225357e-02]
 [ 1.95781135e-02  1.08216383e-01  2.45133308e-02]
 [ 3.45352958e-01 -1.48815026e-02 -8.84487880e-02]
 [-4.78365187e-01 -2.86203509e-02 -4.56203624e-02]
 [ 4.08790419e-02 -6.21721998e-03 -3.62157321e-02]
 [ 3.25921779e-02 -2.95362330e-01  7.08171877e-02]
 [ 4.86969216e-03 -2.82002664e-02 -5.82739845e-02]
 [ 1.94753798e-01 -1.53981697e-01  1.82616858e-01]
 [ 8.62003913e-02  8.13263582e-02  4.39533567e-02]
 [ 5.05964340e-02 -1.06403682e-01 -5.85519742e-02]
 [-2.30163022e-02 -9.52217395e-02 -4.89633835e-03]
 [-3.82463000e-01 -2.40414796e-01  9.25547953e-02]
 [-2.87806532e-01 -1.76827483e-01 -4.51950170e-02]
 [ 2.19124992e-01  1.02090550e+00  1.72405476e-01]
 [-3.02284057e-01 -4.58996089e-02  2.38226703e-01]
 [-8.83698838e-02  4.34157312e-02 -4.19631915e-02]
 [ 1.35044118e-01 -3.91665653e-02  7.72085377e-02]
 [-1.05032497e-01  9.53441358e-03 -1.08863175e-01]
 [-9.64207817e-03 -1.14217008e-01  1.09087240e-01]
 [-1.00102273e-01  6.99184330e-02 -5.20403366e-02]
 [ 1.12684281e-01 -8.39632681e-02 -7.25938860e-02]
 [ 4.45252539e-02 -5.56707006e-02  1.12777716e-01]
 [-5.09008161e-02  4.32625177e-02  5.48981907e-02]
 [-5.55979767e-01 -2.25531049e-02 -8.15553917e-01]
 [ 7.96303140e-02 -1.09931669e-01 -9.74745056e-02]
 [ 7.90540487e-02  2.91800627e-02  2.46120734e-02]
 [ 3.06210165e-02  1.67347926e-01 -4.49467542e-02]
 [-1.06351874e-01  5.07486023e-03 -1.65650646e-01]
 [-6.01616543e-02  1.25612155e-01  1.28178021e-01]
 [ 1.37023522e-01 -1.12111633e-01 -2.95321440e-02]
 [-2.59392541e-02 -2.92950836e-02  5.02260157e-02]
 [ 2.58078931e-02  1.42267946e-02 -2.05803509e-02]
 [-9.75977504e-02 -1.52701797e-02  1.86275023e-03]
 [-2.38969017e-02 -2.73739490e-01  1.29632616e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.64405321]
curr_Stock_Price:  98.88092799534573
curr_Factors:  [98.880928   -0.99918321 -0.98803825]
mat_Sqrt:  [[13.5541791   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00628534 0.03728439 0.9353166 ]
Stock Position:  0.00628533609705787
Bond Position:  [-6.26555308]


portfolio before change:  [-5.63909909]
curr_Stock_Price:  99.79374673478273
curr_Factors:  [99.79374673 -1.22704888 -1.0156882 ]
mat_Sqrt:  [[10.59485439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428331  0.01411938  0.0859571 ]
Stock Position:  -0.004283309723759637
Bond Position:  [-5.21165156]


portfolio before change:  [-5.64184936]
curr_Stock_Price:  100.28373562301016
curr_Factors:  [100.28373562  -1.31010707  -0.99328237]
mat_Sqrt:  [[10.0203105   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01984725 -0.00346397 -0.12414091]
Stock Position:  0.01984724617017296
Bond Position:  [-7.63220534]


portfolio before change:  [-5.63890232]
curr_Stock_Price:  100.48029273166924
curr_Factors:  [100.48029273  -1.31157512  -0.97777905]
mat_Sqrt:  [[10.18185733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193511 -0.00659539  0.21422481]
Stock Position:  0.0019351139247331683
Bond Position:  [-5.83334314]


portfolio before change:  [-5.63943757]
curr_Stock_Price:  100.58052944103675
curr_Factors:  [100.58052944  -1.50549021  -0.97707789]
mat_Sqrt:  [[ 8.40133474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.14133658 -0.11014952  0.06771667]
Stock Position:  -0.14133658039541444
Bond Position:  [8.57627052]


portfolio before change:  [-5.63677794]
curr_Stock_Price:  100.5692971936173
curr_Factors:  [100.56929719  -1.481663    -0.94772402]
mat_Sqrt:  [[ 8.85923127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00521508 -0.00294341  0.05027219]
Stock Position:  -0.005215078430725262
Bond Position:  [-5.11230117]


portfolio before change:  [-5.64030134]
curr_Stock_Price:  101.12237018847883
curr_Factors:  [101.12237019  -1.52314179  -0.95469957]
mat_Sqrt:  [[ 8.48661319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00322579 0.03422103 0.06992971]
Stock Position:  0.0032257875506573083
Bond Position:  [-5.96650062]


portfolio before change:  [-5.64103725]
curr_Stock_Price:  101.1254518964782
curr_Factors:  [101.1254519   -1.22461399  -0.95419966]
mat_Sqrt:  [[11.4449455   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02856407 -0.00470594 -0.25231977]
Stock Position:  0.028564066647484485
Bond Position:  [-8.5295914]


portfolio before change:  [-5.64977098]
curr_Stock_Price:  100.85702179502115
curr_Factors:  [100.8570218   -1.06517841  -0.95292659]
mat_Sqrt:  [[13.40461295  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03643644 -0.00905055 -0.1301422 ]
Stock Position:  -0.03643644022420058
Bond Position:  [-1.97490013]


portfolio before change:  [-5.64318622]
curr_Stock_Price:  100.66952730115554
curr_Factors:  [100.6695273   -1.15483086  -0.95008191]
mat_Sqrt:  [[12.26721653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00271667 -0.00196606 -0.1033134 ]
Stock Position:  0.002716672405554826
Bond Position:  [-5.91667235]


portfolio before change:  [-5.64615764]
curr_Stock_Price:  99.84801258680386
curr_Factors:  [99.84801259 -0.9472711  -0.95043655]
mat_Sqrt:  [[14.96840295  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00263364 -0.09340177  0.20202172]
Stock Position:  0.0026336445726772386
Bond Position:  [-5.90912181]


portfolio before change:  [-5.6498939]
curr_Stock_Price:  98.7098279218102
curr_Factors:  [98.70982792 -0.8519609  -0.93589682]
mat_Sqrt:  [[16.51595358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046946 -0.00891771 -0.16623946]
Stock Position:  -0.00046945898848516846
Bond Position:  [-5.60355368]


portfolio before change:  [-5.65096826]
curr_Stock_Price:  99.50621382344548
curr_Factors:  [99.50621382 -0.81194119 -0.92160687]
mat_Sqrt:  [[17.57842024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01297355 -0.04869329  0.52095506]
Stock Position:  0.012973550211758804
Bond Position:  [-6.94191712]


portfolio before change:  [-5.6477693]
curr_Stock_Price:  99.8196782704279
curr_Factors:  [99.81967827 -0.80937834 -0.91056895]
mat_Sqrt:  [[17.87526758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00544172 0.02571765 0.12538669]
Stock Position:  0.005441718269620937
Bond Position:  [-6.19095987]


portfolio before change:  [-5.64580612]
curr_Stock_Price:  100.32266332665237
curr_Factors:  [100.32266333  -0.98529036  -0.92076413]
mat_Sqrt:  [[14.91454843  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00240686 -0.0336478  -0.16703248]
Stock Position:  0.002406860064737115
Bond Position:  [-5.88726873]


portfolio before change:  [-5.64893928]
curr_Stock_Price:  99.32667473797254
curr_Factors:  [99.32667474 -0.92537815 -0.91745846]
mat_Sqrt:  [[15.73012326  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168304 -0.03011176 -0.01396789]
Stock Position:  -0.001683036895186681
Bond Position:  [-5.48176882]


portfolio before change:  [-5.64879454]
curr_Stock_Price:  98.83351481525624
curr_Factors:  [98.83351482 -0.62737128 -0.91693454]
mat_Sqrt:  [[21.09700217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01752751 -0.07602583  0.26403307]
Stock Position:  -0.017527505176981286
Bond Position:  [-3.91648959]


portfolio before change:  [-5.60849659]
curr_Stock_Price:  96.50645599644828
curr_Factors:  [96.506456   -0.52134636 -0.91780121]
mat_Sqrt:  [[22.88455751  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01317909 -0.05591776 -0.1289288 ]
Stock Position:  -0.013179087766550406
Bond Position:  [-4.33662954]


portfolio before change:  [-5.60670707]
curr_Stock_Price:  96.32953628763154
curr_Factors:  [96.32953629 -0.44520116 -0.88188405]
mat_Sqrt:  [[25.55134035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01098482 0.32283867 0.49182484]
Stock Position:  0.010984816286194587
Bond Position:  [-6.66486932]


portfolio before change:  [-5.60358078]
curr_Stock_Price:  96.68998354031828
curr_Factors:  [96.68998354 -0.66460328 -0.86595737]
mat_Sqrt:  [[20.92509513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01217874 -0.01451473  0.67959447]
Stock Position:  -0.01217874310782829
Bond Position:  [-4.42601831]


portfolio before change:  [-5.59340716]
curr_Stock_Price:  95.80919402689877
curr_Factors:  [95.80919403 -0.85149737 -0.85993986]
mat_Sqrt:  [[17.30371854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00553723  0.01372926 -0.11970931]
Stock Position:  -0.00553722570119685
Bond Position:  [-5.06289003]


portfolio before change:  [-5.59192954]
curr_Stock_Price:  95.42804332539961
curr_Factors:  [95.42804333 -0.89279484 -0.83813246]
mat_Sqrt:  [[16.90222365  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00886232 -0.01238556  0.22025447]
Stock Position:  0.008862323151044176
Bond Position:  [-6.4376437]


portfolio before change:  [-5.58334981]
curr_Stock_Price:  96.48696246867028
curr_Factors:  [96.48696247 -0.87032535 -0.84679119]
mat_Sqrt:  [[17.32743968  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00732987  0.00301505 -0.31055634]
Stock Position:  -0.007329872394378839
Bond Position:  [-4.87611269]


portfolio before change:  [-5.58173152]
curr_Stock_Price:  96.18302239431787
curr_Factors:  [96.18302239 -0.89145755 -0.81989124]
mat_Sqrt:  [[17.3727706   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00055697 -0.03611859  0.31119553]
Stock Position:  0.0005569745424078069
Bond Position:  [-5.63530302]


portfolio before change:  [-5.58201696]
curr_Stock_Price:  96.93533391626588
curr_Factors:  [96.93533392 -1.03140919 -0.82796917]
mat_Sqrt:  [[15.09956192  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00721343  0.02211015 -0.1484566 ]
Stock Position:  -0.007213432873387296
Bond Position:  [-4.88278044]


portfolio before change:  [-5.58315561]
curr_Stock_Price:  97.0085665321984
curr_Factors:  [97.00856653 -0.77067347 -0.83627408]
mat_Sqrt:  [[19.45009084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00492019 -0.02655152 -0.20709015]
Stock Position:  0.004920192629503998
Bond Position:  [-6.06045644]


portfolio before change:  [-5.58677158]
curr_Stock_Price:  96.42762065909369
curr_Factors:  [96.42762066 -0.50154451 -0.859498  ]
mat_Sqrt:  [[24.72340014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00267392 -0.01760462  0.32172343]
Stock Position:  0.0026739241787783574
Bond Position:  [-5.84461172]


portfolio before change:  [-5.58579054]
curr_Stock_Price:  97.06774928185015
curr_Factors:  [97.06774928 -0.62550177 -0.84194795]
mat_Sqrt:  [[22.37534022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172412  0.01368081  0.15660926]
Stock Position:  -0.0017241184305824176
Bond Position:  [-5.41843425]


portfolio before change:  [-5.58524894]
curr_Stock_Price:  96.3607518240766
curr_Factors:  [96.36075182 -0.74522783 -0.84799712]
mat_Sqrt:  [[19.58715572  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0369138  -0.00713192 -2.32654832]
Stock Position:  -0.03691379913766006
Bond Position:  [-2.0282075]


portfolio before change:  [-5.61643116]
curr_Stock_Price:  97.1986138851264
curr_Factors:  [97.19861389 -0.88626462 -0.85581506]
mat_Sqrt:  [[17.02489645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00334187 -0.03476345 -0.27806763]
Stock Position:  0.0033418699819891193
Bond Position:  [-5.94125629]


portfolio before change:  [-5.61587283]
curr_Stock_Price:  97.58792420603963
curr_Factors:  [97.58792421 -0.81909075 -0.87141415]
mat_Sqrt:  [[17.99778804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00471343 0.00922755 0.07021139]
Stock Position:  0.004713434390638586
Bond Position:  [-6.07584711]


portfolio before change:  [-5.61904637]
curr_Stock_Price:  97.0757705013068
curr_Factors:  [97.0757705  -1.02100882 -0.86562912]
mat_Sqrt:  [[14.7148012   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175111  0.05292006 -0.12822058]
Stock Position:  0.0017511078302335776
Bond Position:  [-5.78903651]


portfolio before change:  [-5.61950073]
curr_Stock_Price:  97.22956756163138
curr_Factors:  [97.22956756 -1.06322992 -0.8397738 ]
mat_Sqrt:  [[14.49887602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00965828  0.00160481 -0.47255518]
Stock Position:  -0.009658275423101093
Bond Position:  [-4.68043078]


portfolio before change:  [-5.62712401]
curr_Stock_Price:  97.95828904810469
curr_Factors:  [97.95828905 -0.99194814 -0.84224658]
mat_Sqrt:  [[15.64806167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196536  0.03972205  0.36565622]
Stock Position:  -0.0019653637682536494
Bond Position:  [-5.43460034]


portfolio before change:  [-5.63143463]
curr_Stock_Price:  99.80591530156657
curr_Factors:  [99.8059153  -1.02348925 -0.84883412]
mat_Sqrt:  [[15.34675543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00834708 -0.03545281 -0.08424699]
Stock Position:  0.008347079543863864
Bond Position:  [-6.46452255]


portfolio before change:  [-5.64106322]
curr_Stock_Price:  98.74920180921757
curr_Factors:  [98.74920181 -0.77816029 -0.84876048]
mat_Sqrt:  [[19.40755749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084726 -0.00926392  0.14328084]
Stock Position:  -0.0008472631025856048
Bond Position:  [-5.55739667]


portfolio before change:  [-5.64202314]
curr_Stock_Price:  99.06220569264609
curr_Factors:  [99.06220569 -0.75847765 -0.85951549]
mat_Sqrt:  [[19.64366406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00111864  0.00449891 -0.05871001]
Stock Position:  0.0011186447056141685
Bond Position:  [-5.75283855]


portfolio before change:  [-5.64162942]
curr_Stock_Price:  100.05704013015308
curr_Factors:  [100.05704013  -1.11729605  -0.85485154]
mat_Sqrt:  [[13.92370566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00701048 -0.00482885  0.00531391]
Stock Position:  -0.007010475141182575
Bond Position:  [-4.94018203]


portfolio before change:  [-5.64490141]
curr_Stock_Price:  100.43567750356596
curr_Factors:  [100.4356775   -0.98721685  -0.85305766]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.64490141]
Stock Price:  99.22252573632363
PL:  [-5.64490141]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.09755642e-01  4.97895018e-03  3.80570884e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 1.95092105e-01  2.44777285e-01  3.70471110e-01]
 [-3.31771492e-02  3.12790833e-02  1.15376363e-01]
 [-5.91202495e-01 -1.80613972e-01  3.82061200e-02]
 [ 2.93733186e-02 -1.60390680e-01 -2.11166937e-01]
 [ 2.80833519e-02 -1.83656684e-01 -2.71540624e-02]
 [ 3.04249311e-01 -6.15082522e-02 -6.83016414e-02]
 [-5.13431526e-01 -2.79337704e-02 -6.41120197e-02]
 [ 4.84293384e-02 -1.90443620e-02 -4.22264544e-02]
 [-1.04137852e-02 -2.30890387e-01  1.38841724e-01]
 [-1.20183149e-01  1.47266557e-02  8.91047156e-02]
 [ 1.08874721e-01 -2.29407170e-02  2.73618287e-01]
 [ 4.40571248e-02  2.98359495e-01  2.55008267e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-1.60043294e-02 -7.16558163e-03  3.62547031e-02]
 [-4.86457315e-01 -2.34283912e-01  1.31302127e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 2.04036229e-01  9.53853423e-01  2.50811824e-01]
 [ 1.22177845e-02  8.85178399e-03  3.09376631e-02]
 [-5.62367524e-02 -4.50103106e-02 -2.18054715e-02]
 [-3.01575675e-02  5.25464214e-02 -2.40050504e-02]
 [ 6.52485917e-02 -3.77902919e-02  8.35094796e-02]
 [ 7.48739284e-02  2.46734744e-01  6.81561435e-02]
 [-7.87577722e-02 -1.38732454e-01  6.55685825e-02]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [ 2.58717356e-02 -6.84594811e-02  4.80850543e-02]
 [ 2.90168384e-02  4.35361394e-02 -7.61454852e-02]
 [-6.48446907e-01 -3.84552919e-02 -9.61182063e-01]
 [-9.46976359e-02 -1.07530640e-01  3.71320386e-03]
 [ 1.13195846e-01  1.72506022e-02 -1.96260497e-02]
 [ 2.22559912e-02  1.20916115e-01 -2.30138784e-02]
 [-8.44382399e-02 -3.89146531e-03 -1.19511237e-01]
 [-6.24356105e-02  7.11653060e-02  9.36473965e-02]
 [ 1.73612363e-01 -1.28782705e-01 -3.35669259e-02]
 [-7.79007145e-03 -6.06670752e-03  6.94359483e-02]
 [-2.58786752e-04 -5.62870431e-04 -4.66826086e-02]
 [-6.14960183e-02  9.82481990e-02 -6.19389440e-03]
 [-7.03930716e-02 -2.38564130e-01  9.14800013e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.2139496]
curr_Stock_Price:  100.11511322483399
curr_Factors:  [100.11511322  -0.91841918  -0.9843317 ]
mat_Sqrt:  [[14.93294398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00682107  0.00157448  0.10856628]
Stock Position:  -0.0068210739846585045
Bond Position:  [3.8968422]


portfolio before change:  [3.21722038]
curr_Stock_Price:  99.70701875837102
curr_Factors:  [99.70701876 -1.12455649 -0.97163729]
mat_Sqrt:  [[12.2563271   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00370266  0.01411938  0.0859571 ]
Stock Position:  -0.0037026625081377678
Bond Position:  [3.58640182]


portfolio before change:  [3.21971214]
curr_Stock_Price:  99.15513598267451
curr_Factors:  [99.15513598 -1.19164202 -0.9784763 ]
mat_Sqrt:  [[11.31995759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02447309 0.07740537 1.05685096]
Stock Position:  0.02447308865825031
Bond Position:  [0.79307971]


portfolio before change:  [3.22978715]
curr_Stock_Price:  99.56276174502405
curr_Factors:  [99.56276175 -1.17474045 -0.97807474]
mat_Sqrt:  [[11.56488126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076252  0.00989131  0.32913665]
Stock Position:  -0.0007625175814301193
Bond Position:  [3.3057055]


portfolio before change:  [3.23008171]
curr_Stock_Price:  99.71839539079932
curr_Factors:  [99.71839539 -0.89607555 -0.97932885]
mat_Sqrt:  [[15.28612836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03847064 -0.05711515  0.10899143]
Stock Position:  -0.03847063966672366
Bond Position:  [7.06631217]


portfolio before change:  [3.27272982]
curr_Stock_Price:  98.63276850771469
curr_Factors:  [98.63276851 -0.8810008  -0.96633624]
mat_Sqrt:  [[15.55009126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00114933 -0.05071999 -0.60240049]
Stock Position:  -0.0011493322574632418
Bond Position:  [3.38609164]


portfolio before change:  [3.27357945]
curr_Stock_Price:  98.26181619068379
curr_Factors:  [98.26181619 -0.943804   -0.97823774]
mat_Sqrt:  [[14.37648334  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00123803 -0.05807734 -0.07746298]
Stock Position:  0.0012380327318257903
Bond Position:  [3.15192811]


portfolio before change:  [3.27720906]
curr_Stock_Price:  100.8753087257005
curr_Factors:  [100.87530873  -0.97998693  -0.98768557]
mat_Sqrt:  [[14.10053432  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02047576 -0.01945062 -0.19484557]
Stock Position:  0.02047576025597952
Bond Position:  [1.21171042]


portfolio before change:  [3.29869117]
curr_Stock_Price:  101.91705952069711
curr_Factors:  [101.91705952  -0.90281311  -0.97643127]
mat_Sqrt:  [[15.56329039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03387713 -0.00883343 -0.18289375]
Stock Position:  -0.0338771282544338
Bond Position:  [6.75134847]


portfolio before change:  [3.3342377]
curr_Stock_Price:  100.89269403000706
curr_Factors:  [100.89269403  -0.75009043  -0.95978671]
mat_Sqrt:  [[18.25027931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215439 -0.00602236 -0.12046032]
Stock Position:  0.0021543876422960265
Bond Position:  [3.11687573]


portfolio before change:  [3.33784348]
curr_Stock_Price:  102.3855296798611
curr_Factors:  [102.38552968  -1.10064273  -0.97232421]
mat_Sqrt:  [[12.88132324  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00092891 -0.07301395  0.39607679]
Stock Position:  0.0009289106984004
Bond Position:  [3.24273647]


portfolio before change:  [3.33869773]
curr_Stock_Price:  102.86876217993117
curr_Factors:  [102.86876218  -1.16003733  -0.97220938]
mat_Sqrt:  [[12.19721084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00833096  0.00465698  0.25419095]
Stock Position:  -0.00833096074469664
Bond Position:  [4.19569335]


portfolio before change:  [3.34306248]
curr_Stock_Price:  102.407800365594
curr_Factors:  [102.40780037  -1.19259357  -1.00967355]
mat_Sqrt:  [[11.32141163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01449771 -0.00725449  0.78055681]
Stock Position:  0.01449770567262841
Bond Position:  [1.85838433]


portfolio before change:  [3.33972832]
curr_Stock_Price:  102.161797863942
curr_Factors:  [102.16179786  -0.98180025  -0.98634408]
mat_Sqrt:  [[14.27362572  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00727314 0.09434956 0.7274676 ]
Stock Position:  0.00727314000252122
Bond Position:  [2.59669126]


portfolio before change:  [3.34645242]
curr_Stock_Price:  103.041678177896
curr_Factors:  [103.04167818  -1.05572508  -1.00104288]
mat_Sqrt:  [[13.17558615  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00325801 -0.03587186 -0.12433753]
Stock Position:  0.003258005612409106
Bond Position:  [3.01074205]


portfolio before change:  [3.34843411]
curr_Stock_Price:  103.53441009773957
curr_Factors:  [103.5344101   -0.93867067  -1.01853914]
mat_Sqrt:  [[14.62444161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060097 -0.00226596  0.10342458]
Stock Position:  -0.0006009722554519429
Bond Position:  [3.41065542]


portfolio before change:  [3.3491954]
curr_Stock_Price:  102.97709765524755
curr_Factors:  [102.97709766  -0.87383562  -1.02062082]
mat_Sqrt:  [[15.48776211  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0300692  -0.07408708  0.37456842]
Stock Position:  -0.030069196658340847
Bond Position:  [6.445634]


portfolio before change:  [3.34413426]
curr_Stock_Price:  103.17221071849471
curr_Factors:  [103.17221072  -0.71413656  -1.03574513]
mat_Sqrt:  [[17.93076326  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00732323  0.00580111 -0.05715682]
Stock Position:  -0.00732322890451063
Bond Position:  [4.09968797]


portfolio before change:  [3.35296758]
curr_Stock_Price:  102.03598655382801
curr_Factors:  [102.03598655  -0.69196753  -1.021216  ]
mat_Sqrt:  [[18.39616147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01521303 0.30163494 0.71549632]
Stock Position:  0.015213030615301855
Bond Position:  [1.80069099]


portfolio before change:  [3.34704232]
curr_Stock_Price:  101.63170428041929
curr_Factors:  [101.63170428  -0.83667636  -1.02728553]
mat_Sqrt:  [[15.75871662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00119054 0.00279918 0.08825654]
Stock Position:  0.0011905449594381183
Bond Position:  [3.22604521]


portfolio before change:  [3.34707475]
curr_Stock_Price:  101.3202089904494
curr_Factors:  [101.32020899  -0.92985821  -1.03410148]
mat_Sqrt:  [[14.21540447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435091 -0.01423351 -0.06220494]
Stock Position:  -0.004350909395193411
Bond Position:  [3.7879098]


portfolio before change:  [3.35062899]
curr_Stock_Price:  100.61214697260552
curr_Factors:  [100.61214697  -0.71019487  -1.03524668]
mat_Sqrt:  [[17.56365026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191878  0.01661664 -0.06847973]
Stock Position:  -0.0019187830936153935
Bond Position:  [3.54368187]


portfolio before change:  [3.35072932]
curr_Stock_Price:  100.79072525545418
curr_Factors:  [100.79072526  -0.58195045  -1.04376966]
mat_Sqrt:  [[19.83258396  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00410028 -0.01195034  0.2382293 ]
Stock Position:  0.004100280221364958
Bond Position:  [2.9374591]


portfolio before change:  [3.34924546]
curr_Stock_Price:  100.33927653556655
curr_Factors:  [100.33927654  -0.38035675  -1.04378467]
mat_Sqrt:  [[24.15317383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00393973 0.07802438 0.19443051]
Stock Position:  0.0039397268176953795
Bond Position:  [2.95393612]


portfolio before change:  [3.34640022]
curr_Stock_Price:  99.52335482284444
curr_Factors:  [99.52335482 -0.32807217 -1.04168792]
mat_Sqrt:  [[25.29564504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272599 -0.04387105  0.18704891]
Stock Position:  -0.002725990887663741
Bond Position:  [3.61769998]


portfolio before change:  [3.33895087]
curr_Stock_Price:  102.42196575526711
curr_Factors:  [102.42196576  -0.64554327  -1.02437383]
mat_Sqrt:  [[19.28223285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00067192  0.02004328 -0.05140267]
Stock Position:  0.0006719181849737038
Bond Position:  [3.27013169]


portfolio before change:  [3.33921791]
curr_Stock_Price:  102.21099903509496
curr_Factors:  [102.21099904  -0.69622363  -1.04572839]
mat_Sqrt:  [[17.90513027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0018944  -0.02164879  0.13717328]
Stock Position:  0.001894397836615416
Bond Position:  [3.14558962]


portfolio before change:  [3.33612444]
curr_Stock_Price:  100.37047087593814
curr_Factors:  [100.37047088  -0.39456741  -1.06062288]
mat_Sqrt:  [[23.42204705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00062325  0.01376734 -0.21722187]
Stock Position:  0.0006232505869316948
Bond Position:  [3.27356849]


portfolio before change:  [3.335984]
curr_Stock_Price:  99.48854082662656
curr_Factors:  [99.48854083 -0.23150624 -1.06547686]
mat_Sqrt:  [[27.19571373  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03109462 -0.01216063 -2.74198488]
Stock Position:  -0.031094616392193856
Bond Position:  [6.42954201]


portfolio before change:  [3.32430044]
curr_Stock_Price:  99.89013137234555
curr_Factors:  [99.89013137 -0.15751127 -1.05218824]
mat_Sqrt:  [[29.79591739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324595 -0.03400417  0.01059274]
Stock Position:  -0.0032459517606988125
Bond Position:  [3.64853899]


portfolio before change:  [3.3312096]
curr_Stock_Price:  97.90209515775688
curr_Factors:  [97.90209516 -0.23311017 -1.02174022]
mat_Sqrt:  [[27.91369881  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00392765  0.00545512 -0.05598766]
Stock Position:  0.003927645161931658
Bond Position:  [2.94668491]


portfolio before change:  [3.3345486]
curr_Stock_Price:  98.65843514627355
curr_Factors:  [98.65843515 -0.16214412 -1.01406399]
mat_Sqrt:  [[30.43081129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00067959  0.03823703 -0.06565219]
Stock Position:  0.0006795856797357897
Bond Position:  [3.26750174]


portfolio before change:  [3.33433974]
curr_Stock_Price:  97.75004983210366
curr_Factors:  [ 9.77500498e+01  6.24976242e-02 -1.00594181e+00]
mat_Sqrt:  [[38.05260412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286272 -0.00123059 -0.34093229]
Stock Position:  -0.002862717248994279
Bond Position:  [3.61417049]


portfolio before change:  [3.33363939]
curr_Stock_Price:  98.1525156171411
curr_Factors:  [98.15251562 -0.11046201 -1.00828769]
mat_Sqrt:  [[32.06524884  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129369  0.02250445  0.26714996]
Stock Position:  -0.001293688242896709
Bond Position:  [3.46061814]


portfolio before change:  [3.3299446]
curr_Stock_Price:  101.34292647907473
curr_Factors:  [101.34292648  -0.15043515  -1.03385017]
mat_Sqrt:  [[31.00736487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00527086 -0.04072467 -0.0957571 ]
Stock Position:  0.005270857037364496
Bond Position:  [2.79578052]


portfolio before change:  [3.32133671]
curr_Stock_Price:  99.64350986016473
curr_Factors:  [99.64350986 -0.24990175 -1.02856515]
mat_Sqrt:  [[27.74711905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00022441 -0.00191846  0.19808143]
Stock Position:  0.00022441394435261327
Bond Position:  [3.29897532]


portfolio before change:  [3.32208171]
curr_Stock_Price:  101.12558559303146
curr_Factors:  [101.12558559  -0.40779176  -1.05558093]
mat_Sqrt:  [[23.40595509  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004188  -0.000178   -0.13317249]
Stock Position:  -0.0004187980172348768
Bond Position:  [3.3644329]


portfolio before change:  [3.3219653]
curr_Stock_Price:  102.4077896804486
curr_Factors:  [102.40778968  -0.67059542  -1.06118195]
mat_Sqrt:  [[18.12306454  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332304  0.03106881 -0.01766946]
Stock Position:  -0.0033230353509758545
Bond Position:  [3.66227001]


portfolio before change:  [3.31953115]
curr_Stock_Price:  103.2780674630567
curr_Factors:  [103.27806746  -0.7951658   -1.05306583]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.31953115]
Stock Price:  103.33389485546662
PL:  [-0.01436371]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-3.47689189e-02  5.27582157e-02  1.07471381e-03]
 [-1.51377434e-02 -1.48142039e-02 -7.58483165e-02]
 [ 3.26247687e-01  7.32511959e-02  2.27837095e-02]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-8.83095510e-01 -2.61704578e-01  2.23011712e-02]
 [-1.25643373e-02 -8.02682409e-02 -8.99897459e-02]
 [ 3.56667099e-02  4.95210432e-02 -1.26910236e-02]
 [ 2.66507976e-01 -1.31950755e-01 -4.70377437e-02]
 [-4.85663061e-01 -2.63081089e-02 -5.86029556e-02]
 [ 7.44539874e-02 -4.23771881e-02 -7.21670353e-02]
 [ 1.21679929e-01 -3.15080239e-01  1.18817079e-02]
 [-1.40386029e-01 -1.08100788e-01 -2.36673276e-01]
 [ 2.48125150e-01 -2.88260377e-01 -1.01845817e-02]
 [ 6.47208027e-02 -9.23823761e-02 -5.70668597e-02]
 [-1.70888807e-01  2.58827208e-01  1.88887158e-01]
 [ 3.04348852e-02 -3.20819678e-01 -7.82534398e-02]
 [-2.64804461e-02 -2.53913743e-01 -4.08819864e-02]
 [-2.64694285e-01 -1.02751771e-01 -4.45657282e-02]
 [ 2.90165550e-01  1.30432154e+00  4.74451809e-01]
 [-1.88241246e-01 -2.17835173e-02  1.72667874e-01]
 [-8.60175214e-02 -3.28894058e-02 -4.55411253e-02]
 [ 1.43723547e-01 -2.26478336e-02  7.42457800e-02]
 [-8.63153651e-02 -7.87223249e-03 -9.87773069e-02]
 [-9.22017911e-03 -7.93105100e-02  1.19982309e-01]
 [-9.91930552e-02  6.75444048e-02 -5.89806462e-02]
 [ 1.07077690e-01 -8.50943817e-02 -7.96691201e-02]
 [-6.07936509e-03 -2.11599009e-02 -3.73823534e-02]
 [-1.63502631e-02  4.16944094e-02  2.49048111e-02]
 [-5.41794321e-01  9.19428234e-02 -6.82884640e-01]
 [-4.28926124e-02 -1.22125868e-01 -1.32257538e-02]
 [-9.02798921e-02  9.22946337e-02  2.11615573e-01]
 [ 2.06011947e-02  9.65563741e-02 -1.08685837e-02]
 [-1.17158430e-01 -8.47969402e-04 -1.47858237e-01]
 [-6.41357271e-02  3.04582801e-02  6.78306770e-02]
 [ 2.08353211e-01 -1.65922338e-01 -7.26152316e-02]
 [ 1.65270377e-02  3.18428139e-02  6.63914390e-02]
 [-1.61632565e-02 -2.42590496e-02 -4.11833240e-02]
 [-9.98635088e-02 -2.20602861e-02  2.46882558e-03]
 [-2.98348379e-02 -2.81933967e-01  1.38779955e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.36514428]
curr_Stock_Price:  101.11148893442592
curr_Factors:  [101.11148893  -1.1549977   -0.98406268]
mat_Sqrt:  [[11.90743961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00278711  0.01668361  0.00306586]
Stock Position:  -0.0027871090430809974
Bond Position:  [10.64695302]


portfolio before change:  [10.36599971]
curr_Stock_Price:  101.2821040534025
curr_Factors:  [101.28210405  -1.16659157  -0.96027746]
mat_Sqrt:  [[12.07383475  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00256776 -0.00468466 -0.21637413]
Stock Position:  -0.0025677606066982364
Bond Position:  [10.6260679]


portfolio before change:  [10.36811842]
curr_Stock_Price:  100.97429971286904
curr_Factors:  [100.97429971  -0.82865146  -0.96574442]
mat_Sqrt:  [[16.78474005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01982692 0.02316406 0.06499558]
Stock Position:  0.019826921903649104
Bond Position:  [8.36610886]


portfolio before change:  [10.36920071]
curr_Stock_Price:  100.9761388137418
curr_Factors:  [100.97613881  -0.81243221  -0.96306646]
mat_Sqrt:  [[17.10525229  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115187 -0.00659539  0.21422481]
Stock Position:  0.0011518715755571105
Bond Position:  [10.25288916]


portfolio before change:  [10.37116959]
curr_Stock_Price:  101.57272382869671
curr_Factors:  [101.57272383  -0.88030006  -0.98993831]
mat_Sqrt:  [[15.65102898  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.056565   -0.08275825  0.06361903]
Stock Position:  -0.05656500198342259
Bond Position:  [16.11663091]


portfolio before change:  [10.45797942]
curr_Stock_Price:  100.0736497888046
curr_Factors:  [100.07364979  -0.75584837  -0.98608633]
mat_Sqrt:  [[17.5310169   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188272 -0.02538305 -0.2567157 ]
Stock Position:  -0.0018827164742955523
Bond Position:  [10.64638973]


portfolio before change:  [10.45853461]
curr_Stock_Price:  100.4856558104371
curr_Factors:  [100.48565581  -0.617016    -0.99403517]
mat_Sqrt:  [[20.06473558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017122   0.01565993 -0.03620396]
Stock Position:  0.0017121976651147967
Bond Position:  [10.28648331]


portfolio before change:  [10.46270251]
curr_Stock_Price:  102.16887782545322
curr_Factors:  [102.16887783  -0.6768133   -0.98204935]
mat_Sqrt:  [[19.44839314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01303447 -0.04172649 -0.13418559]
Stock Position:  0.01303446928201085
Bond Position:  [9.13098541]


portfolio before change:  [10.45653584]
curr_Stock_Price:  101.6082019409293
curr_Factors:  [101.60820194  -0.5751826   -0.94976535]
mat_Sqrt:  [[22.11323522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02253422 -0.00831935 -0.16717792]
Stock Position:  -0.02253422471933216
Bond Position:  [12.7461979]


portfolio before change:  [10.51358409]
curr_Stock_Price:  99.14728442110336
curr_Factors:  [99.14728442 -0.58830468 -0.95034063]
mat_Sqrt:  [[21.28411793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00275458 -0.01340084 -0.20587246]
Stock Position:  0.002754578739778777
Bond Position:  [10.24047508]


portfolio before change:  [10.51190466]
curr_Stock_Price:  98.07286853281953
curr_Factors:  [98.07286853 -0.48228519 -0.93911565]
mat_Sqrt:  [[23.67240258  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00489895 -0.09963712  0.03389521]
Stock Position:  0.004898950806618775
Bond Position:  [10.0314505]


portfolio before change:  [10.5063554]
curr_Stock_Price:  96.68414878280844
curr_Factors:  [96.68414878 -0.52806807 -0.90005965]
mat_Sqrt:  [[23.18073974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00826065 -0.03418447 -0.67516298]
Stock Position:  -0.008260647040367892
Bond Position:  [11.30502903]


portfolio before change:  [10.50268516]
curr_Stock_Price:  97.2995317611962
curr_Factors:  [97.29953176 -0.55505338 -0.90549093]
mat_Sqrt:  [[22.58418454  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01056507 -0.09115593 -0.02905378]
Stock Position:  0.010565065104726717
Bond Position:  [9.47470927]


portfolio before change:  [10.49305375]
curr_Stock_Price:  96.27579775944851
curr_Factors:  [96.27579776 -0.62820875 -0.89123076]
mat_Sqrt:  [[21.06846671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00240581 -0.02921387 -0.16279587]
Stock Position:  0.002405812286841638
Bond Position:  [10.26143226]


portfolio before change:  [10.4942255]
curr_Stock_Price:  96.22965328165719
curr_Factors:  [96.22965328 -0.95089697 -0.87300692]
mat_Sqrt:  [[15.53093242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00809027  0.08184835  0.53884249]
Stock Position:  -0.008090273264152395
Bond Position:  [11.27274969]


portfolio before change:  [10.49005591]
curr_Stock_Price:  96.91921792259821
curr_Factors:  [96.91921792 -1.00483371 -0.87589467]
mat_Sqrt:  [[14.7781456   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00041805 -0.10145209 -0.22323528]
Stock Position:  0.0004180456972273538
Bond Position:  [10.44953925]


portfolio before change:  [10.4910588]
curr_Stock_Price:  96.19348801617677
curr_Factors:  [96.19348802 -1.18354097 -0.86215718]
mat_Sqrt:  [[12.43684592  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332733 -0.08029458 -0.11662493]
Stock Position:  -0.0033273284540016796
Bond Position:  [10.81112613]


portfolio before change:  [10.49142562]
curr_Stock_Price:  96.48941652463287
curr_Factors:  [96.48941652 -1.21803021 -0.86882805]
mat_Sqrt:  [[11.97205366  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0230908  -0.03249296 -0.12713362]
Stock Position:  -0.02309079736773987
Bond Position:  [12.71944319]


portfolio before change:  [10.50636928]
curr_Stock_Price:  95.91110687863491
curr_Factors:  [95.91110688 -1.39551655 -0.85460601]
mat_Sqrt:  [[10.10771748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04162068 0.41246269 1.35347895]
Stock Position:  0.04162067827033557
Bond Position:  [6.51448396]


portfolio before change:  [10.51914739]
curr_Stock_Price:  96.19855410095548
curr_Factors:  [96.1985541  -1.79763801 -0.82243827]
mat_Sqrt:  [[ 7.00299594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02192747 -0.00688855  0.49257338]
Stock Position:  -0.021927474042664673
Bond Position:  [12.62853869]


portfolio before change:  [10.510654]
curr_Stock_Price:  96.65788914767401
curr_Factors:  [96.65788915 -1.9263844  -0.84259459]
mat_Sqrt:  [[ 6.06296435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01586068 -0.01040054 -0.12991615]
Stock Position:  -0.01586068462938694
Bond Position:  [12.0437143]


portfolio before change:  [10.50147614]
curr_Stock_Price:  97.33146808675073
curr_Factors:  [97.33146809 -1.74509685 -0.85653175]
mat_Sqrt:  [[ 7.21739255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02193232 -0.00716187  0.21180254]
Stock Position:  0.021932316656623835
Bond Position:  [8.36677156]


portfolio before change:  [10.51024552]
curr_Stock_Price:  97.68361854250323
curr_Factors:  [97.68361854 -1.63628127 -0.84798575]
mat_Sqrt:  [[ 8.14550996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01309696 -0.00248942 -0.28178416]
Stock Position:  -0.013096964970448396
Bond Position:  [11.78960445]


portfolio before change:  [10.51090659]
curr_Stock_Price:  97.74567307265893
curr_Factors:  [97.74567307 -1.42918229 -0.84737908]
mat_Sqrt:  [[10.03227666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00131808 -0.02508019  0.34227613]
Stock Position:  0.0013180775490468693
Bond Position:  [10.38207021]


portfolio before change:  [10.51244287]
curr_Stock_Price:  97.92656921052198
curr_Factors:  [97.92656921 -1.15262372 -0.8780625 ]
mat_Sqrt:  [[12.85241434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0085189   0.02135942 -0.16825537]
Stock Position:  -0.008518900595394521
Bond Position:  [11.34666957]


portfolio before change:  [10.51978132]
curr_Stock_Price:  97.23164000953123
curr_Factors:  [97.23164001 -1.35643422 -0.84424058]
mat_Sqrt:  [[10.76630529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00823107 -0.02690921 -0.22727382]
Stock Position:  0.008231066150308292
Bond Position:  [9.71946126]


portfolio before change:  [10.5286467]
curr_Stock_Price:  98.1610909794311
curr_Factors:  [98.16109098 -1.57937379 -0.85011942]
mat_Sqrt:  [[ 8.64617221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164886 -0.00669135 -0.10664145]
Stock Position:  -0.0016488628691083502
Bond Position:  [10.69050088]


portfolio before change:  [10.53008779]
curr_Stock_Price:  98.09759938479718
curr_Factors:  [98.09759938 -1.48912969 -0.84365943]
mat_Sqrt:  [[ 9.51789565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00107062  0.01318493  0.07104649]
Stock Position:  -0.001070619514607359
Bond Position:  [10.63511299]


portfolio before change:  [10.53131752]
curr_Stock_Price:  98.19076091554881
curr_Factors:  [98.19076092 -1.68210945 -0.85593128]
mat_Sqrt:  [[ 7.75913918  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08748569  0.02907487 -1.9480798 ]
Stock Position:  -0.08748568570847855
Bond Position:  [19.12160357]


portfolio before change:  [10.44703398]
curr_Stock_Price:  99.18148171852707
curr_Factors:  [99.18148172 -1.71441744 -0.89335068]
mat_Sqrt:  [[ 7.30956092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00666874 -0.03861959 -0.03772939]
Stock Position:  -0.006668743163417809
Bond Position:  [11.10844981]


portfolio before change:  [10.45108629]
curr_Stock_Price:  98.7820566559951
curr_Factors:  [98.78205666 -1.75921178 -0.87623011]
mat_Sqrt:  [[ 7.08141742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00631244  0.02918613  0.60368033]
Stock Position:  -0.0063124377972849375
Bond Position:  [11.07464187]


portfolio before change:  [10.45055215]
curr_Stock_Price:  99.08598855994843
curr_Factors:  [99.08598856 -1.69423058 -0.86258269]
mat_Sqrt:  [[ 7.68426537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00271669  0.03053381 -0.03100504]
Stock Position:  0.002716685097758616
Bond Position:  [10.18136672]


portfolio before change:  [10.45287601]
curr_Stock_Price:  99.4728975148274
curr_Factors:  [99.47289751 -1.55907979 -0.88725121]
mat_Sqrt:  [[ 8.61542521  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.71044095e-02 -2.68151470e-04 -4.21798395e-01]
Stock Position:  -0.017104409486171368
Bond Position:  [12.15430118]


portfolio before change:  [10.44902239]
curr_Stock_Price:  99.78702740705926
curr_Factors:  [99.78702741 -1.67448448 -0.90437234]
mat_Sqrt:  [[ 7.56991145  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0065395   0.00963175  0.19350204]
Stock Position:  -0.00653949772284181
Bond Position:  [11.10157943]


portfolio before change:  [10.44793603]
curr_Stock_Price:  100.16536564667146
curr_Factors:  [100.16536565  -1.67786477  -0.8921918 ]
mat_Sqrt:  [[ 7.66577728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0246872  -0.05246925 -0.20715104]
Stock Position:  0.024687202041419495
Bond Position:  [7.97513341]


portfolio before change:  [10.44879042]
curr_Stock_Price:  100.15959092488957
curr_Factors:  [100.15959092  -1.55469018  -0.87511905]
mat_Sqrt:  [[ 8.81941546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00350378 0.01006958 0.1893963 ]
Stock Position:  0.0035037822527388225
Bond Position:  [10.09785303]


portfolio before change:  [10.45003943]
curr_Stock_Price:  100.15579520649283
curr_Factors:  [100.15579521  -1.59498528  -0.8931976 ]
mat_Sqrt:  [[ 8.31901657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302874 -0.00767139 -0.11748456]
Stock Position:  -0.003028739406641684
Bond Position:  [10.75338524]


portfolio before change:  [10.45132708]
curr_Stock_Price:  100.17448619048305
curr_Factors:  [100.17448619  -1.58527971  -0.88343062]
mat_Sqrt:  [[ 8.48417955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01177829 -0.00697607  0.00704287]
Stock Position:  -0.011778293397493415
Bond Position:  [11.63121157]


portfolio before change:  [10.44394993]
curr_Stock_Price:  100.92426696577745
curr_Factors:  [100.92426697  -1.6062475   -0.8924369 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.44394993]
Stock Price:  101.27913580494052
PL:  [9.16481413]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.73042882e-01  1.38549163e-01  2.04498249e-01]
 [-9.70554034e-02  4.08820175e-02  8.24106199e-02]
 [ 2.79788977e-01  2.58411296e-01  3.43368487e-01]
 [-1.97288767e-02  3.15918687e-02  1.21376848e-01]
 [-3.06771913e-01 -1.00045683e-01  4.51568728e-02]
 [ 5.05121548e-02 -1.97954258e-01 -2.65064168e-01]
 [ 2.08458599e-02 -2.74481507e-01 -4.15591808e-02]
 [ 1.03941262e-01  1.94569371e-01 -1.84816288e-02]
 [-3.13139457e-02  1.44329926e-02 -2.80087570e-02]
 [ 1.54690901e-01  7.08951248e-02  3.85262243e-01]
 [ 3.37961218e-01 -2.49588361e-01 -1.03159387e-01]
 [-3.39883215e-01 -2.17837803e-01 -4.81690523e-01]
 [ 2.51111962e-01 -3.76264389e-01 -1.47358955e-01]
 [-2.02800762e-01 -2.93898020e-01 -1.94143708e-01]
 [-4.50960010e-01  9.44985273e-01  6.49121971e-01]
 [ 2.08389829e-01 -8.85421980e-01 -2.78148320e-01]
 [ 1.50693238e-01 -2.06134324e-01 -1.13123395e-01]
 [-1.13757229e-01 -3.97078058e-01 -1.75275816e-01]
 [-9.60526067e-02  8.02391522e-01 -5.60031854e-01]
 [-8.06886488e-01 -1.62316247e-01  5.42796023e-01]
 [-1.51149484e-01  4.02747073e-02  7.57275716e-02]
 [ 3.30821979e-01 -1.06077994e-01  1.63537999e-01]
 [-1.20909452e-02  1.38102222e-01 -9.44871627e-02]
 [-2.16921722e-01 -5.90552045e-02 -9.16311079e-02]
 [-1.28408546e-01  1.43827971e-01  1.64029162e-01]
 [ 6.57188736e-02 -1.56427365e-01 -2.08312138e-01]
 [ 1.06881432e-01  1.92113395e-02  9.43956927e-02]
 [-1.52647672e-01  4.07624188e-02  1.52221717e-01]
 [-2.86618305e-01 -1.92777699e-01 -5.52007559e-01]
 [ 3.76043809e-01 -2.93745913e-01 -2.02329999e-01]
 [ 1.62557066e-01 -6.60227246e-03 -3.37754027e-02]
 [ 6.10648864e-02  3.57642228e-01 -1.35732290e-01]
 [ 1.95903609e-01  1.05615676e-01  2.18118351e-01]
 [ 6.54440078e-02  1.19539401e-01  9.37851942e-02]
 [-3.70631294e-01  1.13182101e-01 -9.21208436e-02]
 [-2.82744028e-01 -4.75428098e-02 -7.26074042e-02]
 [ 3.70559167e-01  2.49946927e-01  6.17011509e-02]
 [-7.98370050e-02  2.13845711e-01  2.20089293e-02]
 [ 1.19121709e-03 -1.87010955e-01  5.59532338e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.13615639]
curr_Stock_Price:  99.50901310571764
curr_Factors:  [99.50901311 -0.97447099 -1.02671755]
mat_Sqrt:  [[13.45108372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00949533  0.04381309  0.58337658]
Stock Position:  -0.009495333653333146
Bond Position:  [-0.19128511]


portfolio before change:  [-1.12783734]
curr_Stock_Price:  98.63037487488957
curr_Factors:  [98.63037487 -0.74193572 -1.0068593 ]
mat_Sqrt:  [[17.16005418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00461408  0.01292803  0.23509456]
Stock Position:  -0.004614078490802284
Bond Position:  [-0.67274905]


portfolio before change:  [-1.13366944]
curr_Stock_Price:  99.8761274394151
curr_Factors:  [99.87612744 -0.82730346 -0.99155133]
mat_Sqrt:  [[16.20104753  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02200789 0.08171683 0.97953472]
Stock Position:  0.022007893394008174
Bond Position:  [-3.3317326]


portfolio before change:  [-1.16362154]
curr_Stock_Price:  98.53408132318094
curr_Factors:  [98.53408132 -0.73644146 -0.96278891]
mat_Sqrt:  [[18.0144123   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.25448706e-04 9.99022607e-03 3.46254362e-01]
Stock Position:  0.0003254487063374828
Bond Position:  [-1.19568933]


portfolio before change:  [-1.16361323]
curr_Stock_Price:  99.01888914036581
curr_Factors:  [99.01888914 -0.69223823 -0.96752878]
mat_Sqrt:  [[18.83173769  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01593785 -0.03163722  0.12881999]
Stock Position:  -0.015937853320541064
Bond Position:  [0.4145353]


portfolio before change:  [-1.1489874]
curr_Stock_Price:  98.10446154263443
curr_Factors:  [98.10446154 -0.72883125 -0.94691593]
mat_Sqrt:  [[18.3620432   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.74075722e-04 -6.25986328e-02 -7.56154291e-01]
Stock Position:  -0.0004740757216650048
Bond Position:  [-1.10247845]


portfolio before change:  [-1.14890002]
curr_Stock_Price:  97.62944620084679
curr_Factors:  [97.6294462  -0.69399054 -0.96569881]
mat_Sqrt:  [[18.56893084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028411 -0.08679867 -0.11855678]
Stock Position:  0.0002841060486966905
Bond Position:  [-1.17663714]


portfolio before change:  [-1.14886918]
curr_Stock_Price:  98.2557209882875
curr_Factors:  [98.25572099 -0.51479644 -0.97456471]
mat_Sqrt:  [[22.15830399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00474732  0.06152824 -0.05272294]
Stock Position:  0.004747316177347397
Bond Position:  [-1.61532016]


portfolio before change:  [-1.1578291]
curr_Stock_Price:  96.41089017461775
curr_Factors:  [96.41089017 -0.35258595 -0.98434812]
mat_Sqrt:  [[25.32229126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144768  0.00456411 -0.07990119]
Stock Position:  -0.001447679067433908
Bond Position:  [-1.01825708]


portfolio before change:  [-1.15718815]
curr_Stock_Price:  95.88021716018653
curr_Factors:  [95.88021716 -0.22938351 -1.01050219]
mat_Sqrt:  [[27.74939314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00847452 0.02241901 1.09904594]
Stock Position:  0.008474517979814798
Bond Position:  [-1.96972677]


portfolio before change:  [-1.17586205]
curr_Stock_Price:  93.70573701129607
curr_Factors:  [93.70573701 -0.09840276 -1.02907238]
mat_Sqrt:  [[30.34659372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01023046 -0.07892677 -0.29428502]
Stock Position:  0.010230458005389081
Bond Position:  [-2.13451466]


portfolio before change:  [-1.17082388]
curr_Stock_Price:  94.22428716056685
curr_Factors:  [ 9.42242872e+01 -7.40413776e-02 -1.01532824e+00]
mat_Sqrt:  [[31.69973622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01400114 -0.06888636 -1.37412899]
Stock Position:  -0.014001139510902018
Bond Position:  [0.14842351]


portfolio before change:  [-1.1813278]
curr_Stock_Price:  94.97583155964898
curr_Factors:  [ 9.49758316e+01 -7.25947922e-02 -1.04848162e+00]
mat_Sqrt:  [[30.95535602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00682652 -0.11898525 -0.42037408]
Stock Position:  0.006826519352240662
Bond Position:  [-1.82968215]


portfolio before change:  [-1.19892191]
curr_Stock_Price:  92.43201999068994
curr_Factors:  [92.43201999  0.1022269  -1.03246631]
mat_Sqrt:  [[36.46066632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00685721 -0.09293871 -0.55383796]
Stock Position:  -0.006857214075797856
Bond Position:  [-0.56509576]


portfolio before change:  [-1.18627559]
curr_Stock_Price:  90.57748236557336
curr_Factors:  [90.57748237  0.29966409 -1.05698886]
mat_Sqrt:  [[42.47352225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00692335  0.29883058  1.8517643 ]
Stock Position:  -0.00692335157422926
Bond Position:  [-0.55917583]


portfolio before change:  [-1.18683036]
curr_Stock_Price:  90.64751629203384
curr_Factors:  [90.64751629  0.17238166 -1.11242003]
mat_Sqrt:  [[35.40808436  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00363622 -0.27999501 -0.79347974]
Stock Position:  0.0036362188475635815
Bond Position:  [-1.51644456]


portfolio before change:  [-1.19327633]
curr_Stock_Price:  88.92693507621682
curr_Factors:  [88.92693508  0.19988226 -1.09981754]
mat_Sqrt:  [[36.15733362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00338188 -0.0651854  -0.32270956]
Stock Position:  0.003381877038037235
Bond Position:  [-1.49401629]


portfolio before change:  [-1.19698304]
curr_Stock_Price:  87.88611099814449
curr_Factors:  [87.886111    0.28293238 -1.08924753]
mat_Sqrt:  [[39.24117739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00407194 -0.12556711 -0.50001312]
Stock Position:  -0.004071941188118508
Bond Position:  [-0.83911596]


portfolio before change:  [-1.19571701]
curr_Stock_Price:  87.54943524264374
curr_Factors:  [87.54943524  0.39587557 -1.12044036]
mat_Sqrt:  [[42.42080044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00447071  0.25373848 -1.597615  ]
Stock Position:  -0.004470707015565475
Bond Position:  [-0.80430913]


portfolio before change:  [-1.19619524]
curr_Stock_Price:  87.63391558884571
curr_Factors:  [87.63391559  0.37627998 -1.11255521]
mat_Sqrt:  [[41.96738847  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01668628 -0.0513289   1.54844597]
Stock Position:  -0.016686282531814863
Bond Position:  [0.26608903]


portfolio before change:  [-1.1577689]
curr_Stock_Price:  85.33303886515908
curr_Factors:  [85.33303887  0.34766616 -1.09339388]
mat_Sqrt:  [[40.48105091  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332629  0.01273598  0.21602968]
Stock Position:  -0.003326291347878022
Bond Position:  [-0.87392635]


portfolio before change:  [-1.17091972]
curr_Stock_Price:  89.25379467678793
curr_Factors:  [ 8.92537947e+01  1.38748645e-02 -1.09647132e+00]
mat_Sqrt:  [[30.23159236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01195654 -0.03354481  0.46652839]
Stock Position:  0.011956535633869485
Bond Position:  [-2.2380859]


portfolio before change:  [-1.13860328]
curr_Stock_Price:  91.98002112528874
curr_Factors:  [91.98002113 -0.37256494 -1.13422756]
mat_Sqrt:  [[20.38458324  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136438  0.04367176 -0.26954558]
Stock Position:  -0.0013643777803541627
Bond Position:  [-1.01310778]


portfolio before change:  [-1.13750129]
curr_Stock_Price:  91.07951576008782
curr_Factors:  [ 9.10795158e+01 -5.93388901e-02 -1.14905420e+00]
mat_Sqrt:  [[27.20334195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0087177  -0.0186749  -0.26139805]
Stock Position:  -0.00871770251580607
Bond Position:  [-0.34349717]


portfolio before change:  [-1.14414134]
curr_Stock_Price:  91.8362636694279
curr_Factors:  [ 9.18362637e+01 -6.71687523e-02 -1.18285308e+00]
mat_Sqrt:  [[26.31095558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00346672  0.0454824   0.46792954]
Stock Position:  -0.0034667160259864755
Bond Position:  [-0.82577109]


portfolio before change:  [-1.15262248]
curr_Stock_Price:  94.25293656574216
curr_Factors:  [ 9.42529366e+01 -7.39068820e-02 -1.17278244e+00]
mat_Sqrt:  [[27.09346775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00070712 -0.04946668 -0.59425655]
Stock Position:  0.0007071224498326017
Bond Position:  [-1.21927085]


portfolio before change:  [-1.15309267]
curr_Stock_Price:  93.803547249503
curr_Factors:  [93.80354725 -0.11679455 -1.16659579]
mat_Sqrt:  [[25.99261183  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00487238 0.00607516 0.26928464]
Stock Position:  0.004872380951350446
Bond Position:  [-1.61013929]


portfolio before change:  [-1.15290524]
curr_Stock_Price:  93.88332623536155
curr_Factors:  [93.88332624 -0.15390846 -1.14733699]
mat_Sqrt:  [[25.55434471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00471634  0.01289021  0.43424619]
Stock Position:  -0.004716343333552066
Bond Position:  [-0.71011924]


portfolio before change:  [-1.14314414]
curr_Stock_Price:  91.79487085970827
curr_Factors:  [ 9.17948709e+01  6.14433944e-02 -1.16958620e+00]
mat_Sqrt:  [[30.30805784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01333882 -0.06096166 -1.57472392]
Stock Position:  -0.01333882485202892
Bond Position:  [0.08129157]


portfolio before change:  [-1.1289351]
curr_Stock_Price:  90.73039370859782
curr_Factors:  [ 9.07303937e+01 -6.76321859e-02 -1.15521662e+00]
mat_Sqrt:  [[26.71014876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01224849 -0.09289061 -0.57719117]
Stock Position:  0.012248486036818556
Bond Position:  [-2.24024506]


portfolio before change:  [-1.1383972]
curr_Stock_Price:  89.98074562422543
curr_Factors:  [ 8.99807456e+01  4.09594984e-02 -1.13092173e+00]
mat_Sqrt:  [[30.2541534   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00513953 -0.00208782 -0.09635182]
Stock Position:  0.005139533050291847
Bond Position:  [-1.60085622]


portfolio before change:  [-1.14571793]
curr_Stock_Price:  88.59528693313449
curr_Factors:  [ 8.85952869e+01 -2.74011478e-02 -1.11833531e+00]
mat_Sqrt:  [[28.17238401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00151187  0.1130964  -0.38720644]
Stock Position:  0.0015118681940867766
Bond Position:  [-1.27966233]


portfolio before change:  [-1.14552302]
curr_Stock_Price:  88.83001626057013
curr_Factors:  [88.83001626  0.09498624 -1.12723573]
mat_Sqrt:  [[31.64167644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00768461 0.03339861 0.62223094]
Stock Position:  0.00768460598076479
Bond Position:  [-1.8281467]


portfolio before change:  [-1.14281392]
curr_Stock_Price:  89.21229179939782
curr_Factors:  [ 8.92122918e+01  1.38490352e-02 -1.15516207e+00]
mat_Sqrt:  [[28.49434926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0030769  0.03780168 0.26754305]
Stock Position:  0.0030769021499723313
Bond Position:  [-1.41731141]


portfolio before change:  [-1.14101631]
curr_Stock_Price:  89.85409955405298
curr_Factors:  [89.85409955 -0.31156892 -1.15283056]
mat_Sqrt:  [[20.77577747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01860402  0.03579132 -0.26279513]
Stock Position:  -0.018604022565009908
Bond Position:  [0.53063138]


portfolio before change:  [-1.11835838]
curr_Stock_Price:  88.6397599302531
curr_Factors:  [88.63975993 -0.51502059 -1.14638721]
mat_Sqrt:  [[16.83016327  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01775339 -0.01503436 -0.20712871]
Stock Position:  -0.017753392972275246
Bond Position:  [0.45529811]


portfolio before change:  [-1.13508622]
curr_Stock_Price:  89.58519945926676
curr_Factors:  [89.58519946 -0.62928215 -1.1440926 ]
mat_Sqrt:  [[15.20790523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02561875 0.07904016 0.17601621]
Stock Position:  0.02561874616128713
Bond Position:  [-3.43014671]


portfolio before change:  [-1.13556053]
curr_Stock_Price:  89.58342286022638
curr_Factors:  [89.58342286 -0.65136273 -1.14898274]
mat_Sqrt:  [[14.80292546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00471684  0.06762395  0.06278535]
Stock Position:  -0.004716836464523546
Bond Position:  [-0.71301018]


portfolio before change:  [-1.13673949]
curr_Stock_Price:  89.81447268800481
curr_Factors:  [89.81447269 -0.59675016 -1.18095058]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.13673949]
Stock Price:  90.31071841434095
PL:  [-1.13673949]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.19688303e-01  8.93173933e-02  2.18163318e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 3.38525087e-01 -3.50167481e-02 -1.55699177e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-9.05397065e-01 -2.58295010e-01 -3.18543393e-02]
 [ 1.47822275e-02  8.80446739e-02  1.05113342e-01]
 [-8.61698940e-02 -5.32153745e-02  1.77652201e-01]
 [ 3.44236856e-01 -1.72994719e-01 -7.09932497e-02]
 [-6.03132593e-01  5.66970058e-02 -1.37476112e-01]
 [-1.85316070e-01  1.46236689e-01  1.30980867e-01]
 [-3.06467420e-02 -2.14153452e-01  1.87222329e-01]
 [-4.46181139e-01  8.13787500e-02  4.09218994e-01]
 [ 3.51375296e-02  1.91732550e-01  1.09355594e-01]
 [-6.13738435e-02  9.45875447e-01  8.95296395e-01]
 [ 1.50861908e-01 -1.34469339e-01 -6.75499571e-02]
 [-6.45727378e-03 -3.09284603e-02  3.25642715e-02]
 [-6.48884028e-01 -8.61677423e-02  2.27378068e-01]
 [-1.13716934e-01  1.92528158e-02 -3.16735239e-02]
 [-7.26310319e-02  3.94378074e-01 -2.70736068e-02]
 [-3.15333253e-02  5.41106384e-02  2.46341007e-02]
 [ 1.42521039e-01 -1.36217531e-01  2.04706762e-01]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 3.07428407e-01  3.35057548e-02  2.72187020e-01]
 [ 6.06077867e-02 -1.35336476e-01 -3.41134687e-02]
 [-1.20891573e-01  2.34554815e-01  2.18711086e-01]
 [ 1.01950173e-02  6.07833884e-02  5.67743420e-02]
 [-2.18444595e-01 -1.70533946e-01  4.63772105e-01]
 [ 1.33335603e-01  8.51932368e-02 -1.00172782e-01]
 [-7.93267481e-01 -1.22378853e-01 -1.11469884e+00]
 [-1.85738454e-02 -1.36426391e-01  1.78641512e-01]
 [-1.73248251e-01 -1.38427731e-01  1.39828900e-01]
 [ 6.27847029e-02  2.39411632e-01 -4.61769227e-02]
 [-9.91339124e-02 -1.77944822e-04  1.85513821e-02]
 [-2.02256986e-02  3.06147992e-01  6.19978221e-03]
 [ 6.71150467e-02 -1.37280962e-01 -1.23989246e-01]
 [-3.84495965e-02  2.99933098e-01  8.49992929e-02]
 [ 1.41400930e-01  1.06485568e-01 -1.49431818e-02]
 [-2.16817771e-02  6.89935029e-02 -1.02581079e-02]
 [-1.27972933e-01 -2.59728212e-01  5.32814715e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.80146971]
curr_Stock_Price:  99.55564498995476
curr_Factors:  [99.55564499 -0.88132424 -1.01375005]
mat_Sqrt:  [[14.96392716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01155109  0.02824464  0.62235922]
Stock Position:  -0.011551094535348529
Bond Position:  [0.34850696]


portfolio before change:  [-0.81492677]
curr_Stock_Price:  100.7244202200957
curr_Factors:  [100.72442022  -0.75115672  -1.02067259]
mat_Sqrt:  [[17.12533521  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264994  0.01411938  0.0859571 ]
Stock Position:  -0.002649936032176055
Bond Position:  [-0.5480135]


portfolio before change:  [-0.81692884]
curr_Stock_Price:  101.4540829341064
curr_Factors:  [101.45408293  -0.72126103  -1.05111391]
mat_Sqrt:  [[17.23998454  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0177401  -0.01107327 -0.44416641]
Stock Position:  0.017740096956807214
Bond Position:  [-2.61673411]


portfolio before change:  [-0.80339673]
curr_Stock_Price:  102.23532009118888
curr_Factors:  [102.23532009  -0.77973678  -1.00754272]
mat_Sqrt:  [[17.11572653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115117 -0.00659539  0.21422481]
Stock Position:  0.0011511666694169718
Bond Position:  [-0.92108662]


portfolio before change:  [-0.80363966]
curr_Stock_Price:  102.12430849927613
curr_Factors:  [102.1243085   -0.83607518  -1.01885227]
mat_Sqrt:  [[15.97880795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05748667 -0.08168005 -0.09087156]
Stock Position:  -0.05748666960339055
Bond Position:  [5.06714672]


portfolio before change:  [-0.87254655]
curr_Stock_Price:  103.33398574134935
curr_Factors:  [103.33398574  -0.74834764  -1.03871505]
mat_Sqrt:  [[17.30341065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00222567 0.02784217 0.29985911]
Stock Position:  0.0022256711754872404
Bond Position:  [-1.10253402]


portfolio before change:  [-0.86712077]
curr_Stock_Price:  105.83372914352825
curr_Factors:  [105.83372914  -0.90002607  -1.04510892]
mat_Sqrt:  [[15.13082853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338916 -0.01682818  0.50679228]
Stock Position:  -0.003389160434965443
Bond Position:  [-0.50843328]


portfolio before change:  [-0.86828456]
curr_Stock_Price:  106.15836432422213
curr_Factors:  [106.15836432  -0.99083608  -1.03786566]
mat_Sqrt:  [[13.96047674  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02329997 -0.05470573 -0.20252398]
Stock Position:  0.023299971842967598
Bond Position:  [-3.34177146]


portfolio before change:  [-0.87452336]
curr_Stock_Price:  105.90853372396109
curr_Factors:  [105.90853372  -1.16171676  -1.05670596]
mat_Sqrt:  [[11.52078861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0546604   0.01792917 -0.39218108]
Stock Position:  -0.054660396793942106
Bond Position:  [4.91447912]


portfolio before change:  [-0.91544177]
curr_Stock_Price:  106.6683664789377
curr_Factors:  [106.66836648  -0.86570991  -1.05736424]
mat_Sqrt:  [[15.59032437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00992949  0.0462441   0.37365195]
Stock Position:  -0.009929485386085991
Bond Position:  [0.14372022]


portfolio before change:  [-0.911084]
curr_Stock_Price:  106.23130445323804
curr_Factors:  [106.23130445  -1.02125226  -1.04418458]
mat_Sqrt:  [[13.46618857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.51523014e-04 -6.77212677e-02  5.34093191e-01]
Stock Position:  0.0001515230138184725
Bond Position:  [-0.92718049]


portfolio before change:  [-0.91094351]
curr_Stock_Price:  107.92343463937463
curr_Factors:  [107.92343464  -0.93322213  -1.03928568]
mat_Sqrt:  [[15.01296606  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02401581  0.02573422  1.16738788]
Stock Position:  -0.024015805379418925
Bond Position:  [1.68092469]


portfolio before change:  [-0.94312264]
curr_Stock_Price:  109.2720989868185
curr_Factors:  [109.27209899  -0.85553177  -1.0522968 ]
mat_Sqrt:  [[16.21622891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00384862 0.06063116 0.31196107]
Stock Position:  0.0038486235193824123
Bond Position:  [-1.36366981]


portfolio before change:  [-0.94755732]
curr_Stock_Price:  108.16411743154187
curr_Factors:  [108.16411743  -0.75671983  -1.03648777]
mat_Sqrt:  [[18.00126586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00809944 0.29911208 2.55403141]
Stock Position:  0.008099439677348356
Bond Position:  [-1.82362606]


portfolio before change:  [-0.94703544]
curr_Stock_Price:  108.25669706205494
curr_Factors:  [108.25669706  -0.77718981  -1.0226029 ]
mat_Sqrt:  [[17.89842141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00746442 -0.04252294 -0.19270123]
Stock Position:  0.007464420701257168
Bond Position:  [-1.75510897]


portfolio before change:  [-0.95024741]
curr_Stock_Price:  107.85578622621838
curr_Factors:  [107.85578623  -0.76812472  -1.02792449]
mat_Sqrt:  [[17.89901727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.40068451e-05 -9.78043791e-03  9.28968025e-02]
Stock Position:  -3.400684513260632e-05
Bond Position:  [-0.94657957]


portfolio before change:  [-0.95039774]
curr_Stock_Price:  108.79669139285811
curr_Factors:  [108.79669139  -0.89284474  -0.98552482]
mat_Sqrt:  [[16.6283882   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03636525 -0.02724863  0.64864634]
Stock Position:  -0.03636525128982851
Bond Position:  [3.00602129]


portfolio before change:  [-0.95665951]
curr_Stock_Price:  108.97921583537186
curr_Factors:  [108.97921584  -0.80375431  -1.00374707]
mat_Sqrt:  [[17.87951772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00669398  0.00608827 -0.09035575]
Stock Position:  -0.006693981421502073
Bond Position:  [-0.22715466]


portfolio before change:  [-0.95523063]
curr_Stock_Price:  108.76151668403799
curr_Factors:  [108.76151668  -1.01698428  -0.97236019]
mat_Sqrt:  [[14.87695093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00456912  0.1247133  -0.07723346]
Stock Position:  -0.004569122459596427
Bond Position:  [-0.45828594]


portfolio before change:  [-0.95394304]
curr_Stock_Price:  108.46717499551339
curr_Factors:  [108.467175    -1.12965408  -0.96329646]
mat_Sqrt:  [[13.37646809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187701  0.01711129  0.07027423]
Stock Position:  -0.0018770111630848532
Bond Position:  [-0.75034894]


portfolio before change:  [-0.95197664]
curr_Stock_Price:  107.36958247371304
curr_Factors:  [107.36958247  -1.09396184  -0.90892501]
mat_Sqrt:  [[14.48900476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0124777  -0.04307577  0.58397141]
Stock Position:  0.012477703873673035
Bond Position:  [-2.2917025]


portfolio before change:  [-0.94676737]
curr_Stock_Price:  107.8100283488286
curr_Factors:  [107.81002835  -1.14263823  -0.91411487]
mat_Sqrt:  [[13.78550359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281955  0.01916992 -0.08961985]
Stock Position:  -0.0028195461581284305
Bond Position:  [-0.64279202]


portfolio before change:  [-0.94887557]
curr_Stock_Price:  108.52924027640982
curr_Factors:  [108.52924028  -1.1885903   -0.94752272]
mat_Sqrt:  [[12.81872011  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02838454 0.01059545 0.7764738 ]
Stock Position:  0.028384539280408762
Bond Position:  [-4.02942806]


portfolio before change:  [-0.95475671]
curr_Stock_Price:  108.33979101595888
curr_Factors:  [108.33979102  -1.09138406  -0.94784138]
mat_Sqrt:  [[14.09819913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00355719 -0.04279715 -0.09731623]
Stock Position:  0.0035571941316542024
Bond Position:  [-1.34014238]


portfolio before change:  [-0.95946968]
curr_Stock_Price:  107.06197643584157
curr_Factors:  [107.06197644  -0.99072819  -0.96470356]
mat_Sqrt:  [[15.14963042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00463319  0.07417275  0.62392185]
Stock Position:  -0.004633194203169329
Bond Position:  [-0.46343075]


portfolio before change:  [-0.96263413]
curr_Stock_Price:  107.73246766745905
curr_Factors:  [107.73246767  -1.28041351  -0.94665284]
mat_Sqrt:  [[11.61833728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00201005 0.0192214  0.16196139]
Stock Position:  0.002010051107634682
Bond Position:  [-1.17918189]


portfolio before change:  [-0.9616783]
curr_Stock_Price:  108.28132526122987
curr_Factors:  [108.28132526  -1.23265596  -0.91672883]
mat_Sqrt:  [[12.62082103  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01015629 -0.05392757  1.32301273]
Stock Position:  -0.010156286761862277
Bond Position:  [0.13805789]


portfolio before change:  [-0.96272065]
curr_Stock_Price:  108.38565526361624
curr_Factors:  [108.38565526  -1.28580011  -0.92384012]
mat_Sqrt:  [[11.89425507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0096759   0.02694047 -0.28576507]
Stock Position:  0.0096758980711946
Bond Position:  [-2.0114492]


portfolio before change:  [-0.96633663]
curr_Stock_Price:  108.03793220134627
curr_Factors:  [108.0379322   -1.44357244  -0.92756123]
mat_Sqrt:  [[10.08802134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10150298 -0.03869959 -3.17992551]
Stock Position:  -0.10150298084564817
Bond Position:  [9.99983554]


portfolio before change:  [-0.95935071]
curr_Stock_Price:  107.981422961319
curr_Factors:  [107.98142296  -1.34521184  -0.89229721]
mat_Sqrt:  [[11.52421126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124683 -0.04314181  0.50961451]
Stock Position:  0.0012468260013396822
Bond Position:  [-1.09398476]


portfolio before change:  [-0.95976037]
curr_Stock_Price:  107.76254738425918
curr_Factors:  [107.76254738  -1.26105879  -0.88905342]
mat_Sqrt:  [[12.5512212   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01181399 -0.04377469  0.39889293]
Stock Position:  -0.011813988635619365
Bond Position:  [0.31334514]


portfolio before change:  [-0.96137845]
curr_Stock_Price:  107.90282593851205
curr_Factors:  [107.90282594  -0.9076393   -0.92821559]
mat_Sqrt:  [[17.20803063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00346004  0.07570861 -0.13172991]
Stock Position:  0.0034600391556039406
Bond Position:  [-1.33472645]


portfolio before change:  [-0.9607044]
curr_Stock_Price:  108.14585908314751
curr_Factors:  [108.14585908  -0.7702884   -0.94429649]
mat_Sqrt:  [[19.47041197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.89726268e-03 -5.62710936e-05  5.29219293e-02]
Stock Position:  -0.004897262679557911
Bond Position:  [-0.43108572]


portfolio before change:  [-0.96518145]
curr_Stock_Price:  109.04905023437604
curr_Factors:  [109.04905023  -0.85204793  -0.93515255]
mat_Sqrt:  [[18.25788983  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060552  0.0968125   0.01768625]
Stock Position:  -0.0006055171905437083
Bond Position:  [-0.89915037]


portfolio before change:  [-0.96491709]
curr_Stock_Price:  108.4268368562154
curr_Factors:  [108.42683686  -0.79055109  -0.9456394 ]
mat_Sqrt:  [[19.10375933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00200281 -0.04341205 -0.35370681]
Stock Position:  0.0020028135806456834
Bond Position:  [-1.18207583]


portfolio before change:  [-0.96745649]
curr_Stock_Price:  107.23269868485818
curr_Factors:  [107.23269868  -0.69101607  -0.92978862]
mat_Sqrt:  [[21.20414196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00062983  0.09484717  0.24247932]
Stock Position:  -0.0006298273809197125
Bond Position:  [-0.8999184]


portfolio before change:  [-0.96753087]
curr_Stock_Price:  107.1721760082835
curr_Factors:  [107.17217601  -0.77740073  -0.90695468]
mat_Sqrt:  [[19.88729835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00709499  0.03367369 -0.04262874]
Stock Position:  0.007094986395023727
Bond Position:  [-1.727916]


portfolio before change:  [-0.96875816]
curr_Stock_Price:  107.02964051702463
curr_Factors:  [107.02964052  -1.08085843  -0.90305257]
mat_Sqrt:  [[14.71981885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014942   0.02181766 -0.02926353]
Stock Position:  -0.0014941963784664276
Bond Position:  [-0.80883486]


portfolio before change:  [-0.96964297]
curr_Stock_Price:  107.55413702178411
curr_Factors:  [107.55413702  -0.94020048  -0.88171608]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.96964297]
Stock Price:  107.21544595044804
PL:  [-8.18508892]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.13792946e-01  1.57058583e-01  1.57061441e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.70483191e-01  2.82796372e-01  3.88157059e-01]
 [ 1.87475468e-02  5.78036736e-02  1.47116486e-01]
 [-1.79153079e-01 -6.38961561e-02  4.82755493e-02]
 [ 2.73232150e-02 -1.56747659e-01 -2.05939833e-01]
 [ 3.29900143e-02 -1.21332667e-01 -1.50648948e-02]
 [ 1.35834677e-01 -9.55674813e-02 -1.46127828e-03]
 [-4.51906154e-01 -2.37939460e-02 -5.41707581e-02]
 [ 5.25578775e-02 -2.60583060e-02 -4.55131467e-02]
 [ 5.53052980e-02 -3.85244966e-01  1.68618667e-01]
 [-3.67556888e-02  1.14331233e-03  2.74677266e-02]
 [ 3.51283731e-02  1.89230777e-03  2.15668922e-01]
 [ 9.29053839e-02  2.09507626e-01  1.67160295e-01]
 [ 6.74431134e-02 -1.16214100e-01 -4.67500417e-02]
 [-1.40935403e-02 -1.19215873e-02  3.55160841e-02]
 [-5.28933354e-01 -6.69383107e-02  1.81288448e-01]
 [-1.20918786e-01  1.87849432e-02 -2.56774945e-02]
 [-2.58680053e-02  4.87691480e-01  1.20824101e-02]
 [-2.64435476e-02  5.07112683e-02  2.39299476e-02]
 [ 1.88243501e-01 -1.98383417e-01  2.75898997e-01]
 [-3.52987380e-02  6.04911770e-02 -3.19407807e-02]
 [ 3.30699066e-01  4.39362708e-02  2.89008695e-01]
 [ 6.12932349e-02 -1.38157049e-01 -3.64193934e-02]
 [-1.19242457e-01  2.45355012e-01  2.67300098e-01]
 [ 2.62447301e-03  6.05798950e-02  5.88187371e-02]
 [-1.67633580e-01 -9.35445197e-02  5.23189888e-01]
 [ 1.65213255e-01  9.50942012e-02 -1.10716409e-01]
 [-8.90681576e-01 -1.39134441e-01 -1.22597001e+00]
 [ 4.03763758e-02 -1.78391327e-01  1.84394157e-01]
 [-7.42980443e-02 -1.84881254e-01  1.30804689e-01]
 [ 5.42664001e-02  1.60754559e-01 -3.65162130e-02]
 [-1.01666264e-01 -1.31740495e-03  8.23804602e-03]
 [-5.66352707e-02  1.45991717e-01  1.02923198e-01]
 [ 1.55967095e-01 -1.61078214e-01 -1.02939632e-01]
 [-1.98126165e-02  2.24030340e-01  8.25194033e-02]
 [ 7.53898491e-02  6.51604383e-02 -3.22441309e-02]
 [-4.73951027e-02  8.78871325e-02 -7.63330727e-03]
 [-9.06644112e-02 -2.01949021e-01  5.37991079e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.05997972]
curr_Stock_Price:  99.51962679865949
curr_Factors:  [99.5196268  -1.14547845 -1.00685561]
mat_Sqrt:  [[11.56543391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00671637  0.04966628  0.44805257]
Stock Position:  -0.006716365278012127
Bond Position:  [-0.39156955]


portfolio before change:  [-1.06026059]
curr_Stock_Price:  99.55415797552547
curr_Factors:  [99.55415798 -0.97635462 -1.00400293]
mat_Sqrt:  [[13.74045291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330273  0.01411938  0.0859571 ]
Stock Position:  -0.0033027326789784534
Bond Position:  [-0.73145982]


portfolio before change:  [-1.06027288]
curr_Stock_Price:  99.53019230210036
curr_Factors:  [99.5301923  -0.78468569 -1.01230569]
mat_Sqrt:  [[16.50180322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02163504 0.08942806 1.10730405]
Stock Position:  0.021635041009974678
Bond Position:  [-3.21361267]


portfolio before change:  [-1.06451864]
curr_Stock_Price:  99.3525160812918
curr_Factors:  [99.35251608 -0.6134773  -0.99412965]
mat_Sqrt:  [[19.90691859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00252526 0.01827913 0.41968239]
Stock Position:  0.0025252556254454234
Bond Position:  [-1.31540914]


portfolio before change:  [-1.06588155]
curr_Stock_Price:  98.87791905136113
curr_Factors:  [98.87791905 -0.5614268  -0.99424621]
mat_Sqrt:  [[20.86791767  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00819194 -0.02020574  0.1377167 ]
Stock Position:  -0.008191936952568812
Bond Position:  [-0.25587987]


portfolio before change:  [-1.06900197]
curr_Stock_Price:  99.25492698784164
curr_Factors:  [99.25492699 -0.29227092 -0.98878491]
mat_Sqrt:  [[27.56745009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068056 -0.04956796 -0.58748902]
Stock Position:  -0.0006805592967382612
Bond Position:  [-1.0014531]


portfolio before change:  [-1.06892482]
curr_Stock_Price:  98.95762306344498
curr_Factors:  [98.95762306 -0.30860838 -1.01286266]
mat_Sqrt:  [[26.39621605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00101462 -0.03836876 -0.04297595]
Stock Position:  0.001014619273421173
Bond Position:  [-1.16932913]


portfolio before change:  [-1.06764959]
curr_Stock_Price:  100.35855205411148
curr_Factors:  [100.35855205  -0.20098823  -1.04322134]
mat_Sqrt:  [[28.92018285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00460125 -0.03022109 -0.00416862]
Stock Position:  0.004601245226778971
Bond Position:  [-1.5294239]


portfolio before change:  [-1.06619604]
curr_Stock_Price:  100.71600717122855
curr_Factors:  [100.71600717  -0.10864714  -1.04816611]
mat_Sqrt:  [[31.67385226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01463599 -0.00752431 -0.15453409]
Stock Position:  -0.01463598640761528
Bond Position:  [0.40788207]


portfolio before change:  [-1.08192745]
curr_Stock_Price:  101.79433552570093
curr_Factors:  [ 1.01794336e+02 -3.07817693e-02 -1.05062273e+00]
mat_Sqrt:  [[34.52038302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012339  -0.00824036 -0.12983634]
Stock Position:  0.0012339006416656586
Bond Position:  [-1.20753155]


portfolio before change:  [-1.08246926]
curr_Stock_Price:  101.47756536868587
curr_Factors:  [ 1.01477565e+02 -3.82271945e-02 -1.04593418e+00]
mat_Sqrt:  [[34.31821872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00232464 -0.12182515  0.48102212]
Stock Position:  0.002324638632116148
Bond Position:  [-1.31836793]


portfolio before change:  [-1.08424584]
curr_Stock_Price:  100.78422379318873
curr_Factors:  [ 1.00784224e+02  5.86131436e-02 -1.02365624e+00]
mat_Sqrt:  [[38.3954415   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008105   0.00036155  0.07835778]
Stock Position:  -0.000810495755176069
Bond Position:  [-1.00256065]


portfolio before change:  [-1.08622906]
curr_Stock_Price:  103.07651443857526
curr_Factors:  [ 1.03076514e+02  1.58213548e-02 -1.04043795e+00]
mat_Sqrt:  [[36.99767139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.14068788e-03 5.98400260e-04 6.15243405e-01]
Stock Position:  0.0021406878777284408
Bond Position:  [-1.3068837]


portfolio before change:  [-1.08527746]
curr_Stock_Price:  103.59736236421047
curr_Factors:  [ 1.03597362e+02  4.37680708e-02 -1.01081836e+00]
mat_Sqrt:  [[39.38801505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00336235 0.06625213 0.47686179]
Stock Position:  0.003362350188376007
Bond Position:  [-1.43360807]


portfolio before change:  [-1.08451162]
curr_Stock_Price:  103.87843117790126
curr_Factors:  [103.87843118  -0.33874883  -1.02495965]
mat_Sqrt:  [[26.56282804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00206679 -0.03675013 -0.13336486]
Stock Position:  0.002066785427518178
Bond Position:  [-1.29920604]


portfolio before change:  [-1.08087456]
curr_Stock_Price:  105.7167782671783
curr_Factors:  [105.71677827  -0.40159995  -1.02626602]
mat_Sqrt:  [[25.35301457  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00028208 -0.00376994  0.1013175 ]
Stock Position:  -0.0002820833790789411
Bond Position:  [-1.05105361]


portfolio before change:  [-1.08105889]
curr_Stock_Price:  105.90446493572426
curr_Factors:  [105.90446494  -0.43371278  -1.0040008 ]
mat_Sqrt:  [[25.1491435   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01962915 -0.02116775  0.51716548]
Stock Position:  -0.01962915137178785
Bond Position:  [0.99775588]


portfolio before change:  [-1.08147864]
curr_Stock_Price:  105.93220300556978
curr_Factors:  [105.93220301  -0.34270037  -1.01904707]
mat_Sqrt:  [[27.14117258  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00463042  0.00594032 -0.07325074]
Stock Position:  -0.004630424742814179
Bond Position:  [-0.59096754]


portfolio before change:  [-1.08647003]
curr_Stock_Price:  106.99420358941879
curr_Factors:  [106.99420359  -0.42450163  -1.01464306]
mat_Sqrt:  [[25.37158809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042605  0.15422159  0.03446775]
Stock Position:  -0.0004260495539788885
Bond Position:  [-1.0408852]


portfolio before change:  [-1.08733351]
curr_Stock_Price:  108.71550272504159
curr_Factors:  [108.71550273  -0.52656844  -1.03447458]
mat_Sqrt:  [[22.82123325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088731  0.01603631  0.06826548]
Stock Position:  -0.0008873099885015869
Bond Position:  [-0.99086915]


portfolio before change:  [-1.08806705]
curr_Stock_Price:  109.40261133875485
curr_Factors:  [109.40261134  -0.51773802  -1.03236129]
mat_Sqrt:  [[23.2181768   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01031256 -0.06273434  0.78706304]
Stock Position:  0.01031256296946044
Bond Position:  [-2.21628837]


portfolio before change:  [-1.08861478]
curr_Stock_Price:  109.37636405256042
curr_Factors:  [109.37636405  -0.60780584  -1.02587934]
mat_Sqrt:  [[21.35123614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188545  0.01912899 -0.09111816]
Stock Position:  -0.0018854527580201507
Bond Position:  [-0.88239081]


portfolio before change:  [-1.08767305]
curr_Stock_Price:  108.81838613552836
curr_Factors:  [108.81838614  -0.55438938  -1.01924238]
mat_Sqrt:  [[22.55707016  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01732615 0.01389387 0.82446136]
Stock Position:  0.017326148559736642
Bond Position:  [-2.97307657]


portfolio before change:  [-1.08893768]
curr_Stock_Price:  108.76684665799657
curr_Factors:  [108.76684666  -0.50205942  -1.02954333]
mat_Sqrt:  [[23.51418417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213879 -0.04368909 -0.10389439]
Stock Position:  0.002138792368132499
Bond Position:  [-1.32156739]


portfolio before change:  [-1.08566649]
curr_Stock_Price:  110.3735485740675
curr_Factors:  [110.37354857  -0.46297546  -1.03911255]
mat_Sqrt:  [[24.57629838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237404  0.07758807  0.76253278]
Stock Position:  -0.0023740358512049043
Bond Position:  [-0.82363573]


portfolio before change:  [-1.08504412]
curr_Stock_Price:  110.06802406260871
curr_Factors:  [110.06802406  -0.36966389  -1.03554273]
mat_Sqrt:  [[27.00148745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00059978 0.01915704 0.16779348]
Stock Position:  0.0005997804244657531
Bond Position:  [-1.15106077]


portfolio before change:  [-1.08450949]
curr_Stock_Price:  111.19930607190389
curr_Factors:  [111.19930607  -0.59195799  -1.02394104]
mat_Sqrt:  [[22.09663005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286257 -0.02958137  1.49251512]
Stock Position:  -0.00286257228843839
Bond Position:  [-0.76619344]


portfolio before change:  [-1.08439653]
curr_Stock_Price:  111.126385399666
curr_Factors:  [111.1263854   -0.5491346   -1.01121644]
mat_Sqrt:  [[23.3434662   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00621453  0.03007143 -0.3158431 ]
Stock Position:  0.006214530575334524
Bond Position:  [-1.77499485]


portfolio before change:  [-1.09671886]
curr_Stock_Price:  109.17926542812022
curr_Factors:  [109.17926543  -0.51079927  -1.01736185]
mat_Sqrt:  [[23.68471827  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04832331 -0.04399817 -3.4973512 ]
Stock Position:  -0.04832331460097317
Bond Position:  [4.17918513]


portfolio before change:  [-0.99134148]
curr_Stock_Price:  107.00940296199407
curr_Factors:  [107.00940296  -0.4953007   -1.01460422]
mat_Sqrt:  [[23.64169238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00310509 -0.05641229  0.5260252 ]
Stock Position:  0.00310509205666792
Bond Position:  [-1.32361553]


portfolio before change:  [-0.98923066]
curr_Stock_Price:  107.74248395466752
curr_Factors:  [107.74248395  -0.45289045  -1.01439797]
mat_Sqrt:  [[24.84000746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210834 -0.05846459  0.37314937]
Stock Position:  -0.0021083432652541987
Bond Position:  [-0.76207252]


portfolio before change:  [-0.98671509]
curr_Stock_Price:  106.50415109240858
curr_Factors:  [106.50415109  -0.2697133   -1.00430493]
mat_Sqrt:  [[29.78979038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171076  0.05083506 -0.10417059]
Stock Position:  0.0017107614247737417
Bond Position:  [-1.16891829]


portfolio before change:  [-0.98593834]
curr_Stock_Price:  107.04360404102434
curr_Factors:  [107.04360404  -0.14502972  -1.01838048]
mat_Sqrt:  [[33.44245035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299077 -0.0004166   0.02350085]
Stock Position:  -0.002990770530815213
Bond Position:  [-0.66579549]


portfolio before change:  [-0.98242864]
curr_Stock_Price:  105.8422644772136
curr_Factors:  [105.84226448  -0.29433224  -1.00816765]
mat_Sqrt:  [[28.77336203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110716  0.04616663  0.29361123]
Stock Position:  -0.0011071584544377862
Bond Position:  [-0.86524448]


portfolio before change:  [-0.98178471]
curr_Stock_Price:  105.16296479188198
curr_Factors:  [105.16296479  -0.39605108  -0.98400804]
mat_Sqrt:  [[26.45518231  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00494404 -0.0509374  -0.29365812]
Stock Position:  0.004944044874239496
Bond Position:  [-1.50171513]


portfolio before change:  [-0.98443227]
curr_Stock_Price:  104.66543041453704
curr_Factors:  [104.66543041  -0.6230417   -0.99778873]
mat_Sqrt:  [[20.69595884  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.36066404e-04 7.08446139e-02 2.35404889e-01]
Stock Position:  0.0001360664043450956
Bond Position:  [-0.99867372]


portfolio before change:  [-0.9845637]
curr_Stock_Price:  104.61702656966423
curr_Factors:  [104.61702657  -0.67961292  -0.98055763]
mat_Sqrt:  [[19.88838248  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0035443   0.02060554 -0.09198353]
Stock Position:  0.0035443042597113664
Bond Position:  [-1.35535827]


portfolio before change:  [-0.98793614]
curr_Stock_Price:  103.71331882075826
curr_Factors:  [103.71331882  -0.71941265  -1.00573955]
mat_Sqrt:  [[18.47610626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252672  0.02779235 -0.0217757 ]
Stock Position:  -0.0025267233449575567
Bond Position:  [-0.72588128]


portfolio before change:  [-0.99109818]
curr_Stock_Price:  104.92884380140956
curr_Factors:  [104.9288438   -0.75688149  -1.04871176]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.99109818]
Stock Price:  104.91158785863266
PL:  [-5.90268604]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.21524063e-01  1.79158584e-02  1.60390267e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 3.26412847e-01  2.63064844e-01  3.23969499e-01]
 [ 7.36996653e-03  4.81659299e-02  1.38866356e-01]
 [-9.84753418e-01 -2.64901018e-01 -1.21278031e-01]
 [-1.58648070e-03  7.80167588e-02  9.77886028e-02]
 [-1.80899960e-02  1.53425225e-01  1.25260229e-01]
 [ 3.38562909e-01 -1.07485967e-01 -7.66129922e-02]
 [-5.34971772e-01  1.50135240e-01 -1.53495904e-01]
 [-8.37441343e-02  1.21418442e-01  5.52676588e-02]
 [-3.47208845e-02 -2.03507759e-01  1.79565104e-01]
 [-3.28676823e-01  5.73543419e-02  2.93835432e-01]
 [ 3.51355067e-02  1.49792242e-01  1.32842784e-01]
 [-6.00706129e-02  8.67298862e-01  8.11593012e-01]
 [ 1.11642000e-01 -1.25886516e-01 -5.77707369e-02]
 [ 1.02778898e-02 -7.25827332e-02  2.60952638e-02]
 [-7.06790085e-01 -2.70971697e-01  2.18709943e-01]
 [-1.13716934e-01  1.92528158e-02 -3.16735239e-02]
 [ 4.39754509e-02  7.89394699e-01  2.01979793e-01]
 [-3.15333253e-02  5.41106384e-02  2.46341007e-02]
 [ 2.03801900e-01 -5.23948026e-02  2.52657456e-01]
 [-4.08281815e-02  5.99309391e-02 -3.42144068e-02]
 [ 2.95176728e-01  2.80142328e-02  2.63330641e-01]
 [ 5.89945315e-02 -1.28698041e-01 -2.86862973e-02]
 [-1.21300800e-01  2.48182532e-01  2.55031711e-01]
 [ 8.87398253e-03  6.11910432e-02  5.72272858e-02]
 [-1.97885456e-01 -1.59881812e-01  4.16583506e-01]
 [ 1.31237087e-01  8.45414530e-02 -9.94786920e-02]
 [-7.17046617e-01 -8.29775220e-02 -9.83058928e-01]
 [-5.75139435e-03 -1.81122194e-01  2.25414004e-01]
 [-2.51160077e-01 -1.66946724e-01  1.50165912e-01]
 [ 8.88099706e-02  2.03745295e-01 -7.06636798e-02]
 [-1.01012945e-01 -1.02343686e-03  1.08987725e-02]
 [-1.85803855e-02  2.86130857e-01  2.19937828e-02]
 [ 7.48385137e-02 -1.40568845e-01 -1.24375480e-01]
 [-4.68941955e-02  3.34325384e-01  8.61229552e-02]
 [ 1.18978713e-01  9.20035965e-02 -2.09722762e-02]
 [-2.86407994e-02  7.41068513e-02 -9.54773512e-03]
 [-1.06329304e-01 -2.05910465e-01  4.13405937e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.83095524]
curr_Stock_Price:  99.78309070232993
curr_Factors:  [99.7830907  -0.81214576 -0.99867617]
mat_Sqrt:  [[16.31649899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01154181  0.00566549  0.45754879]
Stock Position:  -0.011541811218440922
Bond Position:  [1.98263284]


portfolio before change:  [0.83757739]
curr_Stock_Price:  99.23081131665542
curr_Factors:  [99.23081132 -0.64326167 -1.02647206]
mat_Sqrt:  [[18.6848836   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242876  0.01411938  0.0859571 ]
Stock Position:  -0.0024287570542559614
Bond Position:  [1.07858493]


portfolio before change:  [0.83525061]
curr_Stock_Price:  100.24433925448862
curr_Factors:  [100.24433925  -0.56772345  -1.02940307]
mat_Sqrt:  [[20.29722311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01967437 0.08318841 0.92419481]
Stock Position:  0.019674373531818168
Bond Position:  [-1.13699396]


portfolio before change:  [0.82621705]
curr_Stock_Price:  99.79241004748182
curr_Factors:  [99.79241005 -0.47787807 -1.03294839]
mat_Sqrt:  [[22.02692739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00167793 0.0152314  0.39614706]
Stock Position:  0.0016779272509446683
Bond Position:  [0.65877265]


portfolio before change:  [0.83172118]
curr_Stock_Price:  103.0236433157255
curr_Factors:  [103.02364332  -0.82113424  -1.05939389]
mat_Sqrt:  [[15.71208847  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06468579 -0.08376906 -0.34597247]
Stock Position:  -0.06468579332738777
Bond Position:  [7.49588728]


portfolio before change:  [0.81434567]
curr_Stock_Price:  103.3067433396566
curr_Factors:  [103.30674334  -0.80824863  -1.05920818]
mat_Sqrt:  [[15.96255781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0012773  0.02467107 0.27896366]
Stock Position:  0.001277296442756845
Bond Position:  [0.68239234]


portfolio before change:  [0.81469472]
curr_Stock_Price:  103.51322446796628
curr_Factors:  [103.51322447  -0.89121747  -1.06493173]
mat_Sqrt:  [[14.6369649   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00078159 0.04851732 0.35733257]
Stock Position:  0.0007815871286943828
Bond Position:  [0.73379011]


portfolio before change:  [0.81662]
curr_Stock_Price:  105.85916129042444
curr_Factors:  [105.85916129  -1.07015399  -1.06208527]
mat_Sqrt:  [[12.55187787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02550607 -0.03399005 -0.21855554]
Stock Position:  0.025506069726072757
Bond Position:  [-1.88343115]


portfolio before change:  [0.82680182]
curr_Stock_Price:  106.2675841101616
curr_Factors:  [106.26758411  -1.03002114  -1.08271964]
mat_Sqrt:  [[12.84840288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04377412  0.04747693 -0.43788109]
Stock Position:  -0.043774119029705946
Bond Position:  [5.47857169]


portfolio before change:  [0.8752717]
curr_Stock_Price:  105.17595696630902
curr_Factors:  [105.17595697  -0.97846767  -1.09180069]
mat_Sqrt:  [[13.26814923  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00522512  0.03839588  0.15766325]
Stock Position:  -0.005225119101016642
Bond Position:  [1.4248286]


portfolio before change:  [0.86991422]
curr_Stock_Price:  106.23537706936014
curr_Factors:  [106.23537707  -1.07739893  -1.08485321]
mat_Sqrt:  [[12.22404643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.71747894e-04 -6.43548038e-02  5.12249261e-01]
Stock Position:  -0.0002717478944050718
Bond Position:  [0.89878346]


portfolio before change:  [0.87005383]
curr_Stock_Price:  106.13507048137589
curr_Factors:  [106.13507048  -1.28352854  -1.09729354]
mat_Sqrt:  [[ 9.81479023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02722595  0.01813704  0.8382307 ]
Stock Position:  -0.027225954659569146
Bond Position:  [3.75968245]


portfolio before change:  [0.84094495]
curr_Stock_Price:  107.2214921735687
curr_Factors:  [107.22149217  -1.69441236  -1.11487107]
mat_Sqrt:  [[ 6.45989647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01023539 0.04736847 0.37896349]
Stock Position:  0.010235387787439867
Bond Position:  [-0.2565086]


portfolio before change:  [0.84647654]
curr_Stock_Price:  107.76506230997043
curr_Factors:  [107.76506231  -1.78673938  -1.10900812]
mat_Sqrt:  [[ 5.95484994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02149318 0.27426398 2.31524896]
Stock Position:  0.0214931826166442
Bond Position:  [-1.46973763]


portfolio before change:  [0.84141678]
curr_Stock_Price:  107.53819837904715
curr_Factors:  [107.53819838  -1.80361465  -1.1251518 ]
mat_Sqrt:  [[ 5.74930899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01680188 -0.03980881 -0.16480383]
Stock Position:  0.016801883913853174
Bond Position:  [-0.96542755]


portfolio before change:  [0.84185393]
curr_Stock_Price:  107.57139909086337
curr_Factors:  [107.57139909  -2.01751598  -1.11002655]
mat_Sqrt:  [[ 4.71435582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00291248 -0.02295268  0.07444252]
Stock Position:  0.002912483826425659
Bond Position:  [0.52855397]


portfolio before change:  [0.8422676]
curr_Stock_Price:  107.69074603063339
curr_Factors:  [107.69074603  -1.8531248   -1.11634311]
mat_Sqrt:  [[ 5.52783228  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12104972 -0.08568877  0.62391859]
Stock Position:  -0.12104972251916397
Bond Position:  [13.87820252]


portfolio before change:  [0.75336099]
curr_Stock_Price:  108.43954159378117
curr_Factors:  [108.43954159  -1.8831244   -1.11707435]
mat_Sqrt:  [[ 5.39781397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02217289  0.00608827 -0.09035575]
Stock Position:  -0.02217289446346552
Bond Position:  [3.1577795]


portfolio before change:  [0.75313449]
curr_Stock_Price:  108.46755983134277
curr_Factors:  [108.46755983  -2.04472794  -1.11139485]
mat_Sqrt:  [[ 4.61969344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02285573 0.24962852 0.57619213]
Stock Position:  0.022855734562223985
Bond Position:  [-1.72597127]


portfolio before change:  [0.75504519]
curr_Stock_Price:  108.56059820487822
curr_Factors:  [108.5605982   -1.9070694   -1.11199501]
mat_Sqrt:  [[ 5.30284847  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00473477  0.01711129  0.07027423]
Stock Position:  -0.0047347722806304945
Bond Position:  [1.2690549]


portfolio before change:  [0.75596513]
curr_Stock_Price:  108.39980987340859
curr_Factors:  [108.39980987  -1.94336163  -1.13911524]
mat_Sqrt:  [[ 4.96965025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05111478 -0.01656869  0.7207614 ]
Stock Position:  0.05111477601711703
Bond Position:  [-4.78486688]


portfolio before change:  [0.76454457]
curr_Stock_Price:  108.57935853763725
curr_Factors:  [108.57935854  -1.74352567  -1.1271018 ]
mat_Sqrt:  [[ 6.15247134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0075197   0.01895183 -0.09760418]
Stock Position:  -0.007519703114878408
Bond Position:  [1.58102911]


portfolio before change:  [0.76568544]
curr_Stock_Price:  108.45392426828775
curr_Factors:  [108.45392427  -1.72194105  -1.15396946]
mat_Sqrt:  [[ 6.11298325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05719829 0.00885888 0.75120902]
Stock Position:  0.057198290823579453
Bond Position:  [-5.43769366]


portfolio before change:  [0.78105621]
curr_Stock_Price:  108.73453628151503
curr_Factors:  [108.73453628  -1.53606629  -1.14639756]
mat_Sqrt:  [[ 7.4368369   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00669855 -0.04069789 -0.08183402]
Stock Position:  0.0066985463278993905
Bond Position:  [0.05269289]


portfolio before change:  [0.78039699]
curr_Stock_Price:  108.63514059341422
curr_Factors:  [108.63514059  -1.53958073  -1.14994231]
mat_Sqrt:  [[ 7.37777349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00851675  0.07848221  0.72753449]
Stock Position:  -0.00851674621843983
Bond Position:  [1.70561492]


portfolio before change:  [0.78472752]
curr_Stock_Price:  108.15170338142924
curr_Factors:  [108.15170338  -1.4472387   -1.13902089]
mat_Sqrt:  [[ 8.14394992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00271802 0.01935031 0.16325352]
Stock Position:  0.002718017607545972
Bond Position:  [0.49076929]


portfolio before change:  [0.78262469]
curr_Stock_Price:  107.35546649690302
curr_Factors:  [107.3554665   -1.24532061  -1.13699797]
mat_Sqrt:  [[ 9.91280016  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01180079 -0.05055907  1.18839679]
Stock Position:  -0.011800786085029998
Bond Position:  [2.04950358]


portfolio before change:  [0.77692908]
curr_Stock_Price:  107.85982384220388
curr_Factors:  [107.85982384  -1.31485262  -1.12565096]
mat_Sqrt:  [[ 9.39642101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01203798  0.02673435 -0.28378502]
Stock Position:  0.012037980713447834
Bond Position:  [-0.5214854]


portfolio before change:  [0.7782093]
curr_Stock_Price:  107.97158770387973
curr_Factors:  [107.9715877   -1.4282771   -1.10755466]
mat_Sqrt:  [[ 8.55089842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10757409 -0.0262398  -2.80439349]
Stock Position:  -0.10757409400227062
Bond Position:  [12.39315502]


portfolio before change:  [0.66956]
curr_Stock_Price:  108.99598430680196
curr_Factors:  [108.99598431  -1.55957422  -1.1303389 ]
mat_Sqrt:  [[ 7.39939257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00480911 -0.05727587  0.64304341]
Stock Position:  0.004809109840815464
Bond Position:  [0.14538634]


portfolio before change:  [0.67040373]
curr_Stock_Price:  109.16764938818334
curr_Factors:  [109.16764939  -1.56830233  -1.12072858]
mat_Sqrt:  [[ 7.41758737  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03030879 -0.05279319  0.42838155]
Stock Position:  -0.03030879489323427
Bond Position:  [3.97914363]


portfolio before change:  [0.67233344]
curr_Stock_Price:  109.12039288679931
curr_Factors:  [109.12039289  -1.34928232  -1.12171342]
mat_Sqrt:  [[ 9.22074701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00863775  0.06442992 -0.20158381]
Stock Position:  0.008637747915196156
Bond Position:  [-0.270221]


portfolio before change:  [0.66824766]
curr_Stock_Price:  108.65128910133303
curr_Factors:  [108.6512891   -1.16100356  -1.12560808]
mat_Sqrt:  [[11.04007608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00895054 -0.00032364  0.03109116]
Stock Position:  -0.008950542264545275
Bond Position:  [1.64073562]


portfolio before change:  [0.67156508]
curr_Stock_Price:  108.3035661052308
curr_Factors:  [108.30356611  -1.15273771  -1.09803958]
mat_Sqrt:  [[11.40624249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058767  0.09048252  0.06274214]
Stock Position:  -0.0005876656061037328
Bond Position:  [0.73521136]


portfolio before change:  [0.67195006]
curr_Stock_Price:  107.80486080274673
curr_Factors:  [107.8048608   -1.15222679  -1.09962315]
mat_Sqrt:  [[11.3415481   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0040401  -0.04445177 -0.35480862]
Stock Position:  0.0040401013053305915
Bond Position:  [0.2364075]


portfolio before change:  [0.67147316]
curr_Stock_Price:  107.67950485406132
curr_Factors:  [107.67950485  -1.2371658   -1.08437993]
mat_Sqrt:  [[10.56570673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195748  0.10572297  0.24568482]
Stock Position:  -0.0019574816073090486
Bond Position:  [0.88225381]


portfolio before change:  [0.67131443]
curr_Stock_Price:  107.81693713249295
curr_Factors:  [107.81693713  -1.27893202  -1.06736469]
mat_Sqrt:  [[10.3205603   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01134369  0.02909409 -0.05982807]
Stock Position:  0.011343694983703743
Bond Position:  [-0.55172802]


portfolio before change:  [0.66135489]
curr_Stock_Price:  106.94503711365822
curr_Factors:  [106.94503711  -1.13510067  -1.05455628]
mat_Sqrt:  [[11.97304751  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00239507  0.02343464 -0.02723703]
Stock Position:  -0.0023950704290218055
Bond Position:  [0.91749579]


portfolio before change:  [0.66271663]
curr_Stock_Price:  106.42436595228531
curr_Factors:  [106.42436595  -1.0624181   -0.99702798]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.66271663]
Stock Price:  105.01899477562564
PL:  [-4.35627815]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-8.19023208e-02 -1.34388114e-02 -6.46747649e-03]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 1.89895163e-01  2.10754622e-01  3.18718660e-01]
 [-8.13088998e-02  2.20084022e-02  9.11406036e-02]
 [-9.80281163e-01 -2.90825056e-01  2.86980369e-02]
 [ 2.96131738e-03 -9.88137438e-02 -1.22906768e-01]
 [ 2.47730530e-02 -1.58540954e-01 -2.99950048e-02]
 [ 2.73482268e-01  2.76031155e-01 -9.04896080e-02]
 [-9.38510533e-02  2.04124231e-02 -8.10077998e-02]
 [ 9.19828534e-02 -1.79878712e-02  2.80996094e-02]
 [ 1.43792440e-01 -2.06962781e-01 -3.16667416e-02]
 [-1.96511347e-01 -1.38973528e-01 -3.05604930e-01]
 [ 3.12292435e-01 -4.00158641e-01 -1.34070072e-01]
 [ 7.82823315e-02 -8.51628644e-02 -4.83110546e-02]
 [-1.98047175e-01  3.25492746e-01  2.33524626e-01]
 [ 5.05323326e-02 -3.94866124e-01 -1.03440242e-01]
 [-3.79531277e-02 -2.57007645e-01 -3.62040757e-02]
 [-2.45044564e-01 -9.21144821e-02 -4.06468282e-02]
 [ 2.75663096e-01  1.14034616e+00  3.48110743e-01]
 [-3.46672179e-01 -5.66443358e-02  2.65770740e-01]
 [-8.68638679e-02 -5.43590425e-03 -4.42538357e-02]
 [ 7.14691164e-02 -2.49765395e-02  5.13708341e-02]
 [-9.50113279e-02  6.05025242e-02 -1.11472056e-01]
 [-3.94939594e-03 -1.00426245e-01  1.00456505e-01]
 [-1.14566864e-01  1.07686430e-01  5.83718275e-02]
 [ 8.27468418e-02 -1.56551935e-01 -1.91322725e-01]
 [ 6.47990269e-02 -3.13244124e-02  1.06801195e-01]
 [-9.51648138e-02  4.42052719e-02  9.57454610e-02]
 [-4.20662081e-01 -1.21824543e-01 -6.92926593e-01]
 [ 2.65490227e-01 -1.87740534e-01 -1.75793523e-01]
 [ 1.34349787e-01  8.86711951e-03 -3.56718933e-02]
 [ 3.55480395e-02  1.94345060e-01 -5.76845378e-02]
 [-1.62853166e-01  2.43992997e-02 -1.60020640e-01]
 [-3.38229023e-02  1.46403838e-01  9.48860893e-02]
 [-1.89193283e-01  8.80056733e-02  6.93299640e-02]
 [-1.45087609e-01 -7.04347787e-02 -1.58396523e-02]
 [ 1.70311565e-01  1.41201584e-01  5.17912973e-02]
 [-1.31475908e-01  2.05810002e-01  7.79084151e-03]
 [ 9.10814213e-04 -1.69816145e-01  4.78292456e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.28433025]
curr_Stock_Price:  100.40357928916465
curr_Factors:  [100.40357929  -1.09967135  -1.01765689]
mat_Sqrt:  [[12.08384716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0069158  -0.00424973 -0.01844991]
Stock Position:  -0.0069158006057112
Bond Position:  [5.97870138]


portfolio before change:  [5.28883939]
curr_Stock_Price:  99.85964232058565
curr_Factors:  [99.85964232 -0.96002626 -1.016702  ]
mat_Sqrt:  [[13.83272774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0032807   0.01411938  0.0859571 ]
Stock Position:  -0.0032807009371304805
Bond Position:  [5.61644901]


portfolio before change:  [5.29116462]
curr_Stock_Price:  99.36489205498702
curr_Factors:  [99.36489205 -1.21674382 -0.99937289]
mat_Sqrt:  [[10.83392212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02403516 0.06664646 0.90921562]
Stock Position:  0.024035155006354322
Bond Position:  [2.90291403]


portfolio before change:  [5.28444485]
curr_Stock_Price:  99.07021299703713
curr_Factors:  [99.070213   -1.24077667 -0.99791248]
mat_Sqrt:  [[10.56070112  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00588376  0.00695967  0.25999877]
Stock Position:  -0.005883761583396342
Bond Position:  [5.86735036]


portfolio before change:  [5.28373536]
curr_Stock_Price:  99.31545573243328
curr_Factors:  [99.31545573 -1.54492707 -0.98086024]
mat_Sqrt:  [[ 7.94477037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.1235948  -0.09196696  0.08186751]
Stock Position:  -0.12359479585724635
Bond Position:  [17.55860884]


portfolio before change:  [5.29584842]
curr_Stock_Price:  99.23520887800206
curr_Factors:  [99.23520888 -1.35753211 -0.99888807]
mat_Sqrt:  [[ 9.40341298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026244  -0.03124765 -0.3506188 ]
Stock Position:  -0.0026243962091094474
Bond Position:  [5.55628093]


portfolio before change:  [5.29837515]
curr_Stock_Price:  98.53708699269727
curr_Factors:  [98.53708699 -1.63347263 -1.01281025]
mat_Sqrt:  [[ 6.98769065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00208321 -0.05013505 -0.0855674 ]
Stock Position:  0.0020832116346952
Bond Position:  [5.09310154]


portfolio before change:  [5.29666219]
curr_Stock_Price:  97.40919839240826
curr_Factors:  [97.40919839 -1.40433329 -0.95520215]
mat_Sqrt:  [[ 9.20167195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02848811  0.08728872 -0.25814166]
Stock Position:  0.028488110584808466
Bond Position:  [2.52165818]


portfolio before change:  [5.2962383]
curr_Stock_Price:  97.38325367480373
curr_Factors:  [97.38325367 -1.00431517 -0.94832369]
mat_Sqrt:  [[13.81859846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00795013  0.00645497 -0.2310927 ]
Stock Position:  -0.007950130039314657
Bond Position:  [6.07044783]


portfolio before change:  [5.2931472]
curr_Stock_Price:  97.86751715321122
curr_Factors:  [97.86751715 -1.23694622 -0.97433325]
mat_Sqrt:  [[10.72240227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00907019 -0.00568826  0.08016036]
Stock Position:  0.009070189202691127
Bond Position:  [4.4054703]


portfolio before change:  [5.28729627]
curr_Stock_Price:  97.16172753751084
curr_Factors:  [97.16172754 -1.07948575 -0.9463084 ]
mat_Sqrt:  [[12.81456902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01029958 -0.06544738 -0.0903364 ]
Stock Position:  0.010299584590210034
Bond Position:  [4.28657084]


portfolio before change:  [5.27316591]
curr_Stock_Price:  95.73776594131404
curr_Factors:  [95.73776594 -0.87613779 -0.92682285]
mat_Sqrt:  [[15.77856232  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01663529 -0.04394729 -0.8718058 ]
Stock Position:  -0.016635290818884076
Bond Position:  [6.86579149]


portfolio before change:  [5.27120715]
curr_Stock_Price:  95.90710716333795
curr_Factors:  [95.90710716 -0.92459811 -0.91676964]
mat_Sqrt:  [[15.21090098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01805241 -0.12654127 -0.3824646 ]
Stock Position:  0.018052411537025154
Bond Position:  [3.53985258]


portfolio before change:  [5.26036438]
curr_Stock_Price:  95.28196756383592
curr_Factors:  [95.28196756 -1.02170201 -0.91742637]
mat_Sqrt:  [[13.70433474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00483219 -0.02693086 -0.13781799]
Stock Position:  0.004832192461441275
Bond Position:  [4.79994358]


portfolio before change:  [5.26271282]
curr_Stock_Price:  95.64379181651688
curr_Factors:  [95.64379182 -0.87404034 -0.89234956]
mat_Sqrt:  [[16.35021256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00868337  0.10292984  0.66618076]
Stock Position:  -0.008683371716845245
Bond Position:  [6.09322342]


portfolio before change:  [5.26101895]
curr_Stock_Price:  95.92658128382067
curr_Factors:  [95.92658128 -0.94704042 -0.92334872]
mat_Sqrt:  [[14.77880386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00130067 -0.12486763 -0.29508622]
Stock Position:  0.0013006656183295398
Bond Position:  [5.13625055]


portfolio before change:  [5.26216165]
curr_Stock_Price:  96.3114816238802
curr_Factors:  [96.31148162 -0.99246713 -0.89366307]
mat_Sqrt:  [[14.60636421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355867 -0.08127295 -0.10328015]
Stock Position:  -0.003558665375099338
Bond Position:  [5.60490199]


portfolio before change:  [5.2590841]
curr_Stock_Price:  97.37317396164892
curr_Factors:  [97.37317396 -1.09010638 -0.88980439]
mat_Sqrt:  [[13.44543956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01901908 -0.02912916 -0.11595409]
Stock Position:  -0.01901908429442969
Bond Position:  [7.1110327]


portfolio before change:  [5.27935979]
curr_Stock_Price:  96.35384225619762
curr_Factors:  [96.35384226 -0.94141244 -0.87292838]
mat_Sqrt:  [[15.70040422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02395891 0.36060912 0.99306305]
Stock Position:  0.023958906384099428
Bond Position:  [2.9708271]


portfolio before change:  [5.25446487]
curr_Stock_Price:  95.29927420178832
curr_Factors:  [95.2992742  -0.78146118 -0.8945166 ]
mat_Sqrt:  [[17.8328883   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01647992 -0.01791251  0.75816995]
Stock Position:  -0.016479916181912992
Bond Position:  [6.82498892]


portfolio before change:  [5.26247449]
curr_Stock_Price:  94.86502160324882
curr_Factors:  [94.8650216  -0.7281624  -0.91090595]
mat_Sqrt:  [[18.41907298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00521402 -0.00171898 -0.12624388]
Stock Position:  -0.005214024548206188
Bond Position:  [5.75710304]


portfolio before change:  [5.25630369]
curr_Stock_Price:  96.18655110837928
curr_Factors:  [96.18655111 -0.60691196 -0.94786085]
mat_Sqrt:  [[20.31819401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00400184 -0.00789828  0.14654669]
Stock Position:  0.004001844478783613
Bond Position:  [4.87138007]


portfolio before change:  [5.25097627]
curr_Stock_Price:  94.7031408001369
curr_Factors:  [94.7031408  -0.82065415 -0.93455642]
mat_Sqrt:  [[16.37141127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00709794  0.01913258 -0.31799875]
Stock Position:  -0.007097940164448875
Bond Position:  [5.9231735]


portfolio before change:  [5.25188804]
curr_Stock_Price:  94.67900363292314
curr_Factors:  [94.67900363 -0.80326457 -0.93276229]
mat_Sqrt:  [[16.68425398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00083691 -0.03175757  0.28657445]
Stock Position:  0.0008369093229542093
Bond Position:  [5.1726503]


portfolio before change:  [5.25131897]
curr_Stock_Price:  93.22641175858402
curr_Factors:  [93.22641176 -0.62959121 -0.95562544]
mat_Sqrt:  [[19.10240844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00522821  0.03405344  0.16651858]
Stock Position:  -0.0052282052874793985
Bond Position:  [5.73872579]


portfolio before change:  [5.244045]
curr_Stock_Price:  94.75492154468076
curr_Factors:  [94.75492154 -0.75085626 -0.95214844]
mat_Sqrt:  [[17.25822934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00229752 -0.04950607 -0.54579048]
Stock Position:  0.0022975184664236373
Bond Position:  [5.02634381]


portfolio before change:  [5.24599518]
curr_Stock_Price:  95.33026204289271
curr_Factors:  [95.33026204 -0.53289014 -0.95802904]
mat_Sqrt:  [[21.46509497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00399676 -0.00990565  0.30467408]
Stock Position:  0.003996764837024487
Bond Position:  [4.86498254]


portfolio before change:  [5.24767791]
curr_Stock_Price:  95.59912005572703
curr_Factors:  [95.59912006 -0.41399507 -0.97320968]
mat_Sqrt:  [[23.87803187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311916  0.01397893  0.27313515]
Stock Position:  -0.0031191631949745277
Bond Position:  [5.54586716]


portfolio before change:  [5.25406483]
curr_Stock_Price:  93.77374240731649
curr_Factors:  [93.77374241 -0.37712901 -0.96471825]
mat_Sqrt:  [[24.50893214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02306305 -0.0385243  -1.9767267 ]
Stock Position:  -0.023063045845291525
Bond Position:  [7.41677295]


portfolio before change:  [5.25227957]
curr_Stock_Price:  93.89135116448148
curr_Factors:  [93.89135116 -0.42954506 -0.97858334]
mat_Sqrt:  [[22.96588545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00978665 -0.05936877 -0.50148999]
Stock Position:  0.009786650068395537
Bond Position:  [4.33339777]


portfolio before change:  [5.26742137]
curr_Stock_Price:  95.3831880231768
curr_Factors:  [95.38318802 -0.46506254 -0.97217738]
mat_Sqrt:  [[22.66138596  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00561736  0.00280403 -0.10176198]
Stock Position:  0.0056173633899899355
Bond Position:  [4.73161934]


portfolio before change:  [5.26731343]
curr_Stock_Price:  95.25867584375511
curr_Factors:  [95.25867584 -0.96668364 -0.96089043]
mat_Sqrt:  [[13.86020838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00207726  0.0614573  -0.16455793]
Stock Position:  0.0020772559582069015
Bond Position:  [5.06943677]


portfolio before change:  [5.26690041]
curr_Stock_Price:  94.75477380174264
curr_Factors:  [94.7547738  -1.05938713 -0.9599097 ]
mat_Sqrt:  [[12.57858024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01549358  0.00771574 -0.45649435]
Stock Position:  -0.015493581259331198
Bond Position:  [6.7349912]


portfolio before change:  [5.26609768]
curr_Stock_Price:  94.86092439831624
curr_Factors:  [94.8609244  -0.98988088 -0.9972067 ]
mat_Sqrt:  [[13.00487491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00082079  0.04629696  0.2706836 ]
Stock Position:  -0.0008207867900442044
Bond Position:  [5.34395828]


portfolio before change:  [5.26696586]
curr_Stock_Price:  94.61708632892211
curr_Factors:  [94.61708633 -0.92192506 -0.99423364]
mat_Sqrt:  [[13.9249107   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01240719  0.02782984  0.19777909]
Stock Position:  -0.012407193836164144
Bond Position:  [6.44089839]


portfolio before change:  [5.27025918]
curr_Stock_Price:  94.41654445906345
curr_Factors:  [94.41654446 -0.67928985 -0.94698958]
mat_Sqrt:  [[18.56794831  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00808595 -0.02227343 -0.04518612]
Stock Position:  -0.008085948965944592
Bond Position:  [6.03370654]


portfolio before change:  [5.2706104]
curr_Stock_Price:  94.46638970804612
curr_Factors:  [94.46638971 -0.80525712 -0.94361409]
mat_Sqrt:  [[16.43433742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01122827 0.04465186 0.14774616]
Stock Position:  0.011228273060468863
Bond Position:  [4.20991598]


portfolio before change:  [5.26522651]
curr_Stock_Price:  93.94002522171634
curr_Factors:  [93.94002522 -0.74090907 -0.96540331]
mat_Sqrt:  [[17.05330747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00730484  0.06508284  0.0222251 ]
Stock Position:  -0.007304836199341323
Bond Position:  [5.951443]


portfolio before change:  [5.27610855]
curr_Stock_Price:  92.55216779866085
curr_Factors:  [92.5521678  -0.49474113 -0.99095373]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.27610855]
Stock Price:  93.85125459659068
PL:  [5.27610855]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.62590348e-01  2.48530655e-01  2.69040087e-01]
 [-9.81876598e-02  3.97278248e-02  8.36287583e-02]
 [ 1.87847401e-01  2.49958096e-01  3.87917309e-01]
 [-5.59819109e-02  1.07319937e-02  9.84238207e-02]
 [-3.71652823e-01 -1.18423960e-01  4.35713500e-02]
 [ 7.54313868e-02 -2.13071519e-01 -2.92021411e-01]
 [ 3.17441552e-02 -1.37700078e-01 -1.98169154e-02]
 [ 1.95678260e-01  1.89435680e-01 -5.25200229e-02]
 [-2.19528984e-01  1.73760333e-02 -1.24136164e-01]
 [ 4.37430410e-02 -1.04360298e-02 -4.09037625e-02]
 [ 5.47860297e-02 -1.91235980e-01  1.91236694e-03]
 [ 2.11604648e-02 -9.50197749e-03 -1.26677699e-02]
 [ 2.85469828e-01 -2.86597865e-01  3.76851204e-02]
 [ 9.24068178e-02 -5.02783806e-02 -6.20244318e-02]
 [ 4.04350974e-02 -7.48687618e-02 -4.23136714e-02]
 [-2.61142361e-02 -7.82433766e-02  1.64627966e-04]
 [-4.22960915e-01 -2.99230429e-01  1.14190675e-01]
 [-1.57584057e-01  3.51980812e-03 -3.92373779e-02]
 [ 4.40147020e-01  1.56099821e+00  8.33364335e-01]
 [-9.97352305e-02 -4.42304069e-03  1.05187792e-01]
 [-9.09927117e-02  1.28494138e-01 -3.79738807e-02]
 [ 7.26496787e-02 -3.58280160e-03  4.36129868e-02]
 [-1.85211785e-02 -2.15221251e-02 -3.46425223e-02]
 [ 3.20937993e-03 -1.02663798e-02  1.19407626e-01]
 [-9.91930552e-02  6.75444048e-02 -5.89806462e-02]
 [ 1.06217465e-01 -7.98608598e-02 -7.41669146e-02]
 [ 3.38921708e-02 -6.65113012e-02  1.01829704e-01]
 [-6.16955945e-02  4.20965334e-02  6.61886068e-02]
 [-4.82997330e-01  3.23374128e-02 -6.58926238e-01]
 [ 1.31787129e-01 -1.15172556e-01 -1.25208323e-01]
 [ 1.19344449e-01  8.05675899e-03 -1.81852294e-02]
 [ 3.10253178e-02  1.63518907e-01 -4.28824894e-02]
 [-1.40733032e-01  1.10387163e-02 -1.52154073e-01]
 [-5.61060661e-02  1.49050079e-01  9.91332045e-02]
 [-1.05188672e-01  6.96624211e-02  1.17344730e-01]
 [-7.33292847e-02 -3.46106045e-02  8.66892529e-03]
 [ 1.10352926e-01  9.22123595e-02  2.68436308e-02]
 [-1.25216408e-01  1.66863047e-01 -3.41547128e-04]
 [ 2.13405355e-03 -2.44827385e-01  8.32696157e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.46598021]
curr_Stock_Price:  99.1843988325144
curr_Factors:  [99.18439883 -0.96803218 -0.99253499]
mat_Sqrt:  [[13.96303613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0072517   0.07859229  0.76749648]
Stock Position:  -0.007251699063986483
Bond Position:  [-2.7467248]


portfolio before change:  [-3.46207902]
curr_Stock_Price:  98.59907984097327
curr_Factors:  [98.59907984 -0.687207   -0.99995192]
mat_Sqrt:  [[18.24521792  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00438971  0.01256304  0.23856957]
Stock Position:  -0.004389711504695464
Bond Position:  [-3.0292575]


portfolio before change:  [-3.46054504]
curr_Stock_Price:  98.16336646659171
curr_Factors:  [98.16336647 -0.98896878 -1.00641167]
mat_Sqrt:  [[13.34647965  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02049114 0.07904369 1.10662011]
Stock Position:  0.02049113980592287
Bond Position:  [-5.47202431]


portfolio before change:  [-3.44987434]
curr_Stock_Price:  98.7174960481206
curr_Factors:  [98.71749605 -1.02137621 -0.99835522]
mat_Sqrt:  [[13.09893283  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00271886  0.00339375  0.28077576]
Stock Position:  -0.00271885765222409
Bond Position:  [-3.18147552]


portfolio before change:  [-3.44892867]
curr_Stock_Price:  98.22339997273605
curr_Factors:  [98.22339997 -1.01215432 -1.0130468 ]
mat_Sqrt:  [[12.96227682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02822163 -0.03744894  0.12429693]
Stock Position:  -0.028221627799441276
Bond Position:  [-0.67690444]


portfolio before change:  [-3.42700298]
curr_Stock_Price:  97.44349064629209
curr_Factors:  [97.44349065 -1.10170771 -0.99904506]
mat_Sqrt:  [[11.92360261  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00086562 -0.06737913 -0.8330558 ]
Stock Position:  0.0008656178296179293
Bond Position:  [-3.5113518]


portfolio before change:  [-3.42645306]
curr_Stock_Price:  98.58586823081254
curr_Factors:  [98.58586823 -1.05678756 -1.0035399 ]
mat_Sqrt:  [[12.56104631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0019221  -0.04354459 -0.05653214]
Stock Position:  0.001922104492335568
Bond Position:  [-3.6159454]


portfolio before change:  [-3.42753599]
curr_Stock_Price:  98.25763282931266
curr_Factors:  [98.25763283 -0.92381082 -0.99455073]
mat_Sqrt:  [[14.42887467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01315757  0.05990482 -0.14982501]
Stock Position:  0.013157565481864747
Bond Position:  [-4.72036723]


portfolio before change:  [-3.42115248]
curr_Stock_Price:  98.78763868679107
curr_Factors:  [98.78763869 -1.27549629 -0.95864509]
mat_Sqrt:  [[10.57857903  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02310514  0.00549478 -0.35412592]
Stock Position:  -0.023105137678024613
Bond Position:  [-1.13865049]


portfolio before change:  [-3.42227245]
curr_Stock_Price:  98.82995084851309
curr_Factors:  [98.82995085 -1.46244459 -0.96381035]
mat_Sqrt:  [[ 8.73332141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00402185 -0.00330016 -0.11668705]
Stock Position:  0.0040218533856750975
Bond Position:  [-3.81975202]


portfolio before change:  [-3.42311748]
curr_Stock_Price:  98.73856896638227
curr_Factors:  [98.73856897 -1.479532   -0.9487888 ]
mat_Sqrt:  [[ 8.7072398   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00576976 -0.06047413  0.00545545]
Stock Position:  0.005769761640158626
Bond Position:  [-3.99281548]


portfolio before change:  [-3.4239436]
curr_Stock_Price:  98.68189639177042
curr_Factors:  [98.68189639 -1.43032556 -0.96375861]
mat_Sqrt:  [[ 9.00533646  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00203539 -0.00300479 -0.03613762]
Stock Position:  0.002035385042449828
Bond Position:  [-3.62479925]


portfolio before change:  [-3.42518843]
curr_Stock_Price:  98.2929267594637
curr_Factors:  [98.29292676 -1.63992298 -0.96015307]
mat_Sqrt:  [[ 7.3000122   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03914546 -0.0906302   0.10750516]
Stock Position:  0.03914546142606347
Bond Position:  [-7.2729104]


portfolio before change:  [-3.40737159]
curr_Stock_Price:  98.77129661657752
curr_Factors:  [98.77129662 -1.5849312  -0.96843611]
mat_Sqrt:  [[ 7.68630163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0102062  -0.01589942 -0.17693844]
Stock Position:  0.010206202582402077
Bond Position:  [-4.41545145]


portfolio before change:  [-3.40685859]
curr_Stock_Price:  98.8756412249722
curr_Factors:  [98.87564122 -1.55445819 -0.98134172]
mat_Sqrt:  [[ 7.83078692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00381376 -0.02367558 -0.12070913]
Stock Position:  0.0038137613272378095
Bond Position:  [-3.78394669]


portfolio before change:  [-3.40870341]
curr_Stock_Price:  98.51594397058312
curr_Factors:  [98.51594397 -1.28737042 -0.97756731]
mat_Sqrt:  [[10.22955082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00274703 -0.02474273  0.00046964]
Stock Position:  -0.002747028426704074
Bond Position:  [-3.13807732]


portfolio before change:  [-3.40940899]
curr_Stock_Price:  98.62999177384589
curr_Factors:  [98.62999177 -1.62337789 -0.98841845]
mat_Sqrt:  [[ 7.23969483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05627004 -0.09462497  0.32575421]
Stock Position:  -0.05627004266109722
Bond Position:  [2.14050485]


portfolio before change:  [-3.40995504]
curr_Stock_Price:  98.64445113143366
curr_Factors:  [98.64445113 -1.77709451 -0.99734251]
mat_Sqrt:  [[ 6.15389347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02689394  0.00111306 -0.11193332]
Stock Position:  -0.0268939449442919
Bond Position:  [-0.7570166]


portfolio before change:  [-3.41517589]
curr_Stock_Price:  98.83505976827804
curr_Factors:  [98.83505977 -1.88799666 -1.01092686]
mat_Sqrt:  [[ 5.44408057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.11949889 0.49363098 2.37735648]
Stock Position:  0.11949889329760269
Bond Position:  [-15.22585615]


portfolio before change:  [-3.42162505]
curr_Stock_Price:  98.7970191743098
curr_Factors:  [98.79701917 -1.67157539 -0.99925677]
mat_Sqrt:  [[ 6.83622222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01146511 -0.00139869  0.30007149]
Stock Position:  -0.011465113645760316
Bond Position:  [-2.288906]


portfolio before change:  [-3.42394395]
curr_Stock_Price:  98.97431938945516
curr_Factors:  [98.97431939 -1.53927477 -1.023111  ]
mat_Sqrt:  [[ 7.63295191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0125019   0.04063341 -0.10832891]
Stock Position:  -0.012501898935153017
Bond Position:  [-2.18657701]


portfolio before change:  [-3.42233774]
curr_Stock_Price:  98.82397811192035
curr_Factors:  [98.82397811 -1.69352719 -1.03174017]
mat_Sqrt:  [[ 6.4758049   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01257907 -0.00113298  0.12441571]
Stock Position:  0.012579074875091007
Bond Position:  [-4.66545196]


portfolio before change:  [-3.42031483]
curr_Stock_Price:  99.03115721399716
curr_Factors:  [99.03115721 -1.78450283 -1.01760581]
mat_Sqrt:  [[ 6.00940582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435122 -0.00680589 -0.09882547]
Stock Position:  -0.004351220967386905
Bond Position:  [-2.98940839]


portfolio before change:  [-3.41755662]
curr_Stock_Price:  98.31137938844286
curr_Factors:  [98.31137939 -1.63848821 -0.98165128]
mat_Sqrt:  [[ 7.1563516   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00381735 -0.00324651  0.34063672]
Stock Position:  0.003817347743180409
Bond Position:  [-3.79284534]


portfolio before change:  [-3.4205833]
curr_Stock_Price:  97.64270886974457
curr_Factors:  [97.64270887 -1.67242155 -0.9851992 ]
mat_Sqrt:  [[ 6.84620329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01599258  0.02135942 -0.16825537]
Stock Position:  -0.015992577998513648
Bond Position:  [-1.85902467]


portfolio before change:  [-3.41595541]
curr_Stock_Price:  97.33880011372612
curr_Factors:  [97.33880011 -1.3437433  -0.96652183]
mat_Sqrt:  [[ 9.6594098   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00921549 -0.02525422 -0.21157756]
Stock Position:  0.009215491455152007
Bond Position:  [-4.31298029]


portfolio before change:  [-3.41915637]
curr_Stock_Price:  97.04996005417483
curr_Factors:  [97.04996005 -1.12976221 -0.94186629]
mat_Sqrt:  [[12.2263982   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00433167 -0.02103272  0.2904918 ]
Stock Position:  0.004331672901682224
Bond Position:  [-3.83954505]


portfolio before change:  [-3.42096637]
curr_Stock_Price:  96.74291423259947
curr_Factors:  [96.74291423 -1.11032794 -0.92771622]
mat_Sqrt:  [[12.60398381  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00373675  0.01331209  0.18881767]
Stock Position:  -0.0037367529632087665
Bond Position:  [-3.059462]


portfolio before change:  [-3.42029881]
curr_Stock_Price:  96.46191697571747
curr_Factors:  [96.46191698 -1.24548618 -0.90816287]
mat_Sqrt:  [[11.19535809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05508222  0.01022599 -1.87973315]
Stock Position:  -0.055082216361198345
Bond Position:  [1.89303738]


portfolio before change:  [-3.41785632]
curr_Stock_Price:  96.42187057373377
curr_Factors:  [96.42187057 -1.2962757  -0.91012116]
mat_Sqrt:  [[10.61572284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00972664 -0.03642076 -0.35718449]
Stock Position:  0.009726642835770898
Bond Position:  [-4.35571741]


portfolio before change:  [-3.42144812]
curr_Stock_Price:  96.10857645970658
curr_Factors:  [96.10857646 -1.44547666 -0.88271133]
mat_Sqrt:  [[ 9.36791517  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01236566  0.00254777 -0.0518774 ]
Stock Position:  0.01236565734835006
Bond Position:  [-4.60989384]


portfolio before change:  [-3.41581939]
curr_Stock_Price:  96.61036921026536
curr_Factors:  [96.61036921 -1.45001254 -0.877608  ]
mat_Sqrt:  [[ 9.42217107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00281188  0.05170922 -0.12233181]
Stock Position:  0.0028118791483246405
Bond Position:  [-3.68747607]


portfolio before change:  [-3.41692643]
curr_Stock_Price:  96.38060195921997
curr_Factors:  [96.38060196 -1.40872503 -0.85777699]
mat_Sqrt:  [[ 9.99218154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01716405  0.00349075 -0.43405322]
Stock Position:  -0.017164053053609678
Bond Position:  [-1.76264467]


portfolio before change:  [-3.41778532]
curr_Stock_Price:  96.41780424573405
curr_Factors:  [96.41780425 -1.35630947 -0.87566071]
mat_Sqrt:  [[10.34724902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309475  0.04713377  0.28279944]
Stock Position:  -0.0030947480690089887
Bond Position:  [-3.11939651]


portfolio before change:  [-3.41969941]
curr_Stock_Price:  96.91029728302732
curr_Factors:  [96.91029728 -1.17589784 -0.86121352]
mat_Sqrt:  [[12.63757377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00628579  0.02202919  0.33475185]
Stock Position:  -0.006285787517233111
Bond Position:  [-2.81054187]


portfolio before change:  [-3.41989747]
curr_Stock_Price:  96.88591263830162
curr_Factors:  [96.88591264 -1.25395086 -0.8530289 ]
mat_Sqrt:  [[11.78178113  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00614961 -0.01094483  0.02473003]
Stock Position:  -0.006149612606166592
Bond Position:  [-2.82408664]


portfolio before change:  [-3.41544513]
curr_Stock_Price:  96.10450197759594
curr_Factors:  [96.10450198 -1.27321972 -0.81758895]
mat_Sqrt:  [[11.87728188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00995289 0.02916011 0.07657741]
Stock Position:  0.009952889309534354
Bond Position:  [-4.3719626]


portfolio before change:  [-3.41230381]
curr_Stock_Price:  96.47503274741305
curr_Factors:  [96.47503275 -1.37729347 -0.83020548]
mat_Sqrt:  [[10.60987632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01140237  0.05276673 -0.00097434]
Stock Position:  -0.011402370493752695
Bond Position:  [-2.31225974]


portfolio before change:  [-3.41823308]
curr_Stock_Price:  96.96968621333545
curr_Factors:  [96.96968621 -1.23381083 -0.8187743 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.41823308]
Stock Price:  96.17736980879727
PL:  [-3.41823308]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-5.54514090e-02 -7.97518913e-03 -2.83557572e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.57626763e-01  2.27847666e-01  3.06969525e-01]
 [-3.96380264e-02  2.32222585e-02  1.09816569e-01]
 [-3.47805076e-01 -1.11668807e-01  4.41541277e-02]
 [ 1.46638082e-02 -1.32496000e-01 -1.69193793e-01]
 [ 3.22701729e-02  6.67998046e-02 -2.56443961e-04]
 [ 2.43252639e-01 -1.38208739e-01 -3.76525726e-02]
 [-4.88401321e-01 -2.49805122e-02 -6.54111058e-02]
 [ 6.63205523e-02 -4.22265613e-02 -8.33228724e-02]
 [ 1.69037763e-01 -3.35620079e-01 -2.92461926e-03]
 [-2.57175020e-01 -1.72342673e-01 -3.80110473e-01]
 [ 2.49243754e-01 -3.87192271e-01 -1.53713219e-01]
 [-1.16510087e-01 -2.31023961e-01 -1.48646504e-01]
 [-3.12713278e-01  6.04577055e-01  4.21828537e-01]
 [ 1.13042059e-01 -6.23375199e-01 -1.81322544e-01]
 [ 1.50693238e-01 -2.06134324e-01 -1.13123395e-01]
 [-3.69434189e-01 -2.35905829e-01 -7.27642307e-02]
 [ 9.65911376e-02  8.91273078e-01 -1.39482348e-01]
 [-6.15520886e-01 -1.18038390e-01  4.27100060e-01]
 [-1.01340342e-01 -6.13861849e-02 -1.65140804e-02]
 [ 1.99017846e-01 -6.88120944e-02  1.06124462e-01]
 [ 9.86209051e-02  2.27442940e-01 -8.13673841e-02]
 [-1.96046726e-01 -6.52554240e-02 -7.08209667e-02]
 [-1.30158930e-01  1.48398339e-01  1.77390321e-01]
 [ 6.71734733e-02 -1.71267953e-01 -2.24905643e-01]
 [ 1.31565217e-01  4.98056789e-02  8.01657495e-02]
 [-5.96466653e-02  4.41158195e-02  5.29907030e-02]
 [-6.47302549e-01 -6.44129166e-02 -9.84699925e-01]
 [ 2.07264839e-01 -1.31910554e-01 -1.61817526e-01]
 [ 1.33835726e-01  1.92402053e-02 -2.86360971e-02]
 [ 4.19288615e-02  2.55990803e-01 -8.79076491e-02]
 [ 7.09063688e-02  6.67181842e-02 -2.06238021e-02]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 5.36080672e-02 -3.38578844e-02  4.68309117e-02]
 [-3.12476750e-02  2.70601860e-01  8.40409847e-02]
 [ 1.31485630e-01  1.01024838e-01 -1.72861363e-02]
 [ 9.37871617e-02 -1.48262759e-03 -1.58689537e-02]
 [-2.95529583e-01 -6.20152339e-01  1.58073955e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.61790323]
curr_Stock_Price:  100.17139606969774
curr_Factors:  [100.17139607  -1.30464043  -1.02957031]
mat_Sqrt:  [[ 9.70529821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00633112 -0.00252198 -0.08089108]
Stock Position:  -0.006331121496289604
Bond Position:  [4.25210051]


portfolio before change:  [3.62226059]
curr_Stock_Price:  99.56710885316954
curr_Factors:  [99.56710885 -1.41873687 -1.0179896 ]
mat_Sqrt:  [[ 8.70680936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00521213  0.01411938  0.0859571 ]
Stock Position:  -0.005212132365453717
Bond Position:  [4.14121754]


portfolio before change:  [3.62098204]
curr_Stock_Price:  99.91173410199819
curr_Factors:  [99.9117341  -0.94557495 -0.99572291]
mat_Sqrt:  [[14.33908849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02274689 0.07205176 0.87569861]
Stock Position:  0.022746889168117432
Bond Position:  [1.3483009]


portfolio before change:  [3.58865222]
curr_Stock_Price:  98.48303906345613
curr_Factors:  [98.48303906 -0.86635512 -0.93894145]
mat_Sqrt:  [[16.19314116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010265   0.00734352  0.3132761 ]
Stock Position:  -0.001026497387918278
Bond Position:  [3.6897448]


portfolio before change:  [3.58829651]
curr_Stock_Price:  99.27890715596644
curr_Factors:  [99.27890716 -0.67624492 -0.96268377]
mat_Sqrt:  [[19.27876913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01772289 -0.03531278  0.12595944]
Stock Position:  -0.017722886052847175
Bond Position:  [5.34780527]


portfolio before change:  [3.58811956]
curr_Stock_Price:  99.3266120191384
curr_Factors:  [99.32661202 -0.64846402 -0.96585352]
mat_Sqrt:  [[19.76862314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00117832 -0.04189891 -0.4826628 ]
Stock Position:  -0.0011783199049686247
Bond Position:  [3.70515809]


portfolio before change:  [3.58688293]
curr_Stock_Price:  100.76918086432863
curr_Factors:  [100.76918086  -0.59707641  -0.9941001 ]
mat_Sqrt:  [[20.52525441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016537   0.02112395 -0.00073156]
Stock Position:  0.0016536988707901493
Bond Position:  [3.42024105]


portfolio before change:  [3.58768009]
curr_Stock_Price:  100.9926836937503
curr_Factors:  [100.99268369  -0.56593706  -0.97743049]
mat_Sqrt:  [[21.57813491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01075155 -0.04370544 -0.10741231]
Stock Position:  0.010751545784580709
Bond Position:  [2.50185263]


portfolio before change:  [3.59669357]
curr_Stock_Price:  101.80193700917033
curr_Factors:  [101.80193701  -0.3084776   -0.98797329]
mat_Sqrt:  [[27.84290699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01804403 -0.00789953 -0.18659968]
Stock Position:  -0.018044031867382793
Bond Position:  [5.43361096]


portfolio before change:  [3.63934171]
curr_Stock_Price:  99.47602102120608
curr_Factors:  [99.47602102 -0.45278507 -1.00588871]
mat_Sqrt:  [[23.13259899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00208459 -0.01335321 -0.23769696]
Stock Position:  0.002084593135876239
Bond Position:  [3.43197468]


portfolio before change:  [3.63511225]
curr_Stock_Price:  97.24130132859428
curr_Factors:  [97.24130133 -0.14293555 -1.01653915]
mat_Sqrt:  [[30.49982174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00523856 -0.10613239 -0.00834312]
Stock Position:  0.005238558641522683
Bond Position:  [3.125708]


portfolio before change:  [3.6262697]
curr_Stock_Price:  95.47873770475113
curr_Factors:  [ 9.54787377e+01  3.48073083e-02 -1.01035612e+00]
mat_Sqrt:  [[35.9940905   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00942418 -0.05449954 -1.08434938]
Stock Position:  -0.009424175165251885
Bond Position:  [4.52607805]


portfolio before change:  [3.63474423]
curr_Stock_Price:  94.63954118284796
curr_Factors:  [ 9.46395412e+01  7.30282283e-04 -1.02773758e+00]
mat_Sqrt:  [[33.8882409   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00613398 -0.12244095 -0.43850103]
Stock Position:  0.006133983574450895
Bond Position:  [3.05422684]


portfolio before change:  [3.62955717]
curr_Stock_Price:  93.73167145976748
curr_Factors:  [93.73167146 -0.09503577 -1.05128151]
mat_Sqrt:  [[29.78839408  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0051301  -0.07305619 -0.4240471 ]
Stock Position:  -0.005130100016068451
Bond Position:  [4.11041002]


portfolio before change:  [3.63117378]
curr_Stock_Price:  93.51670994105073
curr_Factors:  [93.51670994 -0.18980275 -1.0475266 ]
mat_Sqrt:  [[27.13463024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00777596  0.19118405  1.2033594 ]
Stock Position:  -0.007775959143456425
Bond Position:  [4.3583559]


portfolio before change:  [3.62790304]
curr_Stock_Price:  94.00739845060355
curr_Factors:  [94.00739845 -0.23213849 -1.039251  ]
mat_Sqrt:  [[26.36359264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227337 -0.19712855 -0.51726275]
Stock Position:  0.0022733726624623606
Bond Position:  [3.41418919]


portfolio before change:  [3.62883571]
curr_Stock_Price:  94.22992109296506
curr_Factors:  [94.22992109 -0.1835597  -1.01689133]
mat_Sqrt:  [[28.36870878  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00431037 -0.0651854  -0.32270956]
Stock Position:  0.004310370882531834
Bond Position:  [3.22266981]


portfolio before change:  [3.62516149]
curr_Stock_Price:  93.2840442633766
curr_Factors:  [ 9.32840443e+01 -5.06807254e-02 -9.99835444e-01]
mat_Sqrt:  [[32.6267632   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01196497 -0.07459997 -0.2075761 ]
Stock Position:  -0.011964968310729285
Bond Position:  [4.74130213]


portfolio before change:  [3.63429137]
curr_Stock_Price:  92.57052977716913
curr_Factors:  [ 9.25705298e+01 -7.49039910e-02 -9.90667029e-01]
mat_Sqrt:  [[31.89342315  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00285739  0.28184529 -0.39790432]
Stock Position:  0.0028573914419222552
Bond Position:  [3.36978113]


portfolio before change:  [3.63115367]
curr_Stock_Price:  91.32500588071262
curr_Factors:  [ 9.13250059e+01  5.57487409e-02 -9.79081495e-01]
mat_Sqrt:  [[36.27366092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0146494  -0.03732702  1.21839759]
Stock Position:  -0.014649395076943047
Bond Position:  [4.96900976]


portfolio before change:  [3.62305217]
curr_Stock_Price:  91.92043420780502
curr_Factors:  [ 9.19204342e+01 -4.18740735e-02 -9.67007491e-01]
mat_Sqrt:  [[33.51663198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317145 -0.01941202 -0.04711007]
Stock Position:  -0.003171447821219933
Bond Position:  [3.91457303]


portfolio before change:  [3.62378564]
curr_Stock_Price:  91.84346040411025
curr_Factors:  [91.8434604   0.17294872 -0.93874139]
mat_Sqrt:  [[42.70401474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00512607 -0.02176029  0.30274355]
Stock Position:  0.005126068153249382
Bond Position:  [3.1529898]


portfolio before change:  [3.60966312]
curr_Stock_Price:  89.01152918823549
curr_Factors:  [ 8.90115292e+01  7.20828603e-02 -9.44372670e-01]
mat_Sqrt:  [[37.20622526  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00236209  0.07192377 -0.2321185 ]
Stock Position:  0.0023620888224891285
Bond Position:  [3.39940998]


portfolio before change:  [3.61590697]
curr_Stock_Price:  91.4749832892725
curr_Factors:  [ 9.14749833e+01  2.43202823e-02 -9.83824035e-01]
mat_Sqrt:  [[35.04250579  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00605516 -0.02063558 -0.20203251]
Stock Position:  -0.006055157242400148
Bond Position:  [4.16980237]


portfolio before change:  [3.62333881]
curr_Stock_Price:  90.33370987007757
curr_Factors:  [90.33370987  0.15790024 -0.95802526]
mat_Sqrt:  [[40.58447809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0022205   0.04692768  0.50604521]
Stock Position:  -0.002220495569973663
Bond Position:  [3.82392442]


portfolio before change:  [3.61615697]
curr_Stock_Price:  93.78332733099948
curr_Factors:  [93.78332733  0.14749355 -0.96635105]
mat_Sqrt:  [[41.35236407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.07296705e-04 -5.41596822e-02 -6.41593198e-01]
Stock Position:  0.0004072967049160356
Bond Position:  [3.57795933]


portfolio before change:  [3.61595039]
curr_Stock_Price:  92.17797304357671
curr_Factors:  [ 9.21779730e+01  8.20183189e-02 -9.42367420e-01]
mat_Sqrt:  [[38.99260828  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00382675 0.01574994 0.22869057]
Stock Position:  0.0038267498934965527
Bond Position:  [3.26320834]


portfolio before change:  [3.63387887]
curr_Stock_Price:  96.75641517237057
curr_Factors:  [96.75641517  0.11978294 -0.95763925]
mat_Sqrt:  [[41.86040237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113928  0.01395065  0.15116773]
Stock Position:  -0.0011392847424018147
Bond Position:  [3.74411198]


portfolio before change:  [3.63366651]
curr_Stock_Price:  97.35363267023253
curr_Factors:  [ 9.73536327e+01  6.10742160e-02 -9.49022729e-01]
mat_Sqrt:  [[40.06092953  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02121685 -0.02036915 -2.8090748 ]
Stock Position:  -0.021216849524520014
Bond Position:  [5.69920389]


portfolio before change:  [3.66620217]
curr_Stock_Price:  95.85373012427894
curr_Factors:  [95.85373012  0.21666102 -0.94958732]
mat_Sqrt:  [[46.05779775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00370899 -0.04171378 -0.46162036]
Stock Position:  0.0037089932080405772
Bond Position:  [3.31068133]


portfolio before change:  [3.66161275]
curr_Stock_Price:  94.50477238368431
curr_Factors:  [94.50477238  0.50697449 -0.94157302]
mat_Sqrt:  [[61.19416247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00209966  0.00608429 -0.08169081]
Stock Position:  0.0020996641096851206
Bond Position:  [3.46318447]


portfolio before change:  [3.66274355]
curr_Stock_Price:  94.83714727901175
curr_Factors:  [94.83714728  0.65544134 -0.95314563]
mat_Sqrt:  [[70.41856219  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00043447  0.0809514  -0.25077605]
Stock Position:  0.0004344655852060809
Bond Position:  [3.62154008]


portfolio before change:  [3.66274193]
curr_Stock_Price:  93.79138505412547
curr_Factors:  [93.79138505  0.74909242 -0.94425501]
mat_Sqrt:  [[ 7.71622555e+01  0.00000000e+00  0.00000000e+00]
 [-8.16496581e-02  3.16227766e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [ 0.00088669  0.02109814 -0.05883397]
Stock Position:  0.0008866927030262499
Bond Position:  [3.57957779]


portfolio before change:  [3.66780075]
curr_Stock_Price:  98.99199966668932
curr_Factors:  [98.99199967  0.79444315 -0.99159522]
mat_Sqrt:  [[ 8.12789420e+01  0.00000000e+00  0.00000000e+00]
 [-8.16496581e-02  3.16227766e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [-0.00064486  0.0049611   0.16678008]
Stock Position:  -0.0006448620304638011
Bond Position:  [3.73163693]


portfolio before change:  [3.66700961]
curr_Stock_Price:  100.94221332753246
curr_Factors:  [100.94221333   0.73368042  -0.98267464]
mat_Sqrt:  [[ 7.86929829e+01  0.00000000e+00  0.00000000e+00]
 [-8.16496581e-02  3.16227766e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [ 0.0007916  -0.0107068   0.13359556]
Stock Position:  0.0007915976478751342
Bond Position:  [3.58710399]


portfolio before change:  [3.67234971]
curr_Stock_Price:  107.12172384030683
curr_Factors:  [107.12172384   0.58754223  -0.97673511]
mat_Sqrt:  [[ 7.25860613e+01  0.00000000e+00  0.00000000e+00]
 [-8.16496581e-02  3.16227766e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [-9.78971824e-05  8.55718215e-02  2.39745537e-01]
Stock Position:  -9.789718239187422e-05
Bond Position:  [3.68283663]


portfolio before change:  [3.67317903]
curr_Stock_Price:  103.35316549110097
curr_Factors:  [103.35316549   0.65634057  -0.98962585]
mat_Sqrt:  [[ 7.40593380e+01  0.00000000e+00  0.00000000e+00]
 [-8.16496581e-02  3.16227766e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [ 0.00176299  0.03194686 -0.04931254]
Stock Position:  0.0017629858147472888
Bond Position:  [3.49096886]


portfolio before change:  [3.68579946]
curr_Stock_Price:  110.26418686477678
curr_Factors:  [110.26418686   0.57797352  -0.96499875]
mat_Sqrt:  [[ 7.48775380e+01  0.00000000e+00  0.00000000e+00]
 [-8.16496581e-02  3.16227766e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [ 0.00120877 -0.00046885 -0.04526971]
Stock Position:  0.0012087689618870971
Bond Position:  [3.55251553]


portfolio before change:  [3.69323161]
curr_Stock_Price:  116.04532619747674
curr_Factors:  [116.0453262    0.44328175  -0.9825963 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.69323161]
Stock Price:  117.4100649234946
PL:  [-13.71683331]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.57927099e-01  3.52323963e-01  4.32021530e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.61882354e-01  2.00406045e-01  2.60551916e-01]
 [-5.35601683e-03  3.73859782e-02  1.29638470e-01]
 [-6.61584898e-01 -2.00550611e-01  3.64861549e-02]
 [-2.51557642e-03 -9.95433054e-02 -1.19220621e-01]
 [ 3.42030085e-02 -2.24191759e-02 -2.66164567e-02]
 [ 2.51813630e-01 -6.86724276e-02 -4.78352186e-02]
 [-4.52402556e-01 -2.56997954e-02 -4.63669221e-02]
 [ 5.46735322e-02 -2.96525759e-02 -4.71974002e-02]
 [ 1.96176980e-02 -2.96406461e-01  1.34135339e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 3.51302841e-02  4.15137294e-02  1.93480343e-01]
 [ 5.48032304e-02  2.64723211e-01  2.24466323e-01]
 [ 5.65770792e-02 -1.11006564e-01 -5.79284373e-02]
 [-4.56704174e-02  2.11832858e-02  3.13261594e-02]
 [-3.97049306e-01 -2.07999995e-01  9.46141839e-02]
 [-1.94148390e-01 -1.03222890e-01 -2.79145412e-02]
 [ 2.32115478e-01  1.13579945e+00  2.11542513e-01]
 [-3.81822667e-01 -6.27713820e-02  2.84028181e-01]
 [-5.72651680e-02  2.36196339e-01 -7.65886888e-03]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.15978893e-01 -3.84041282e-02  1.33357220e-01]
 [ 7.85614548e-02  1.96962661e-01  4.40207316e-02]
 [-6.29025551e-02 -2.11353680e-01  1.72927947e-01]
 [ 1.47171142e-02  6.31150443e-02 -1.15786940e-02]
 [-4.47403093e-02 -4.85902620e-02  4.66505642e-01]
 [ 1.07627740e-01  7.72085633e-02 -9.16698317e-02]
 [-8.67633098e-01 -1.87958892e-01 -1.28914684e+00]
 [ 7.27757246e-02 -1.79285047e-01  1.59181224e-01]
 [ 6.26983057e-02 -1.14749062e-01  9.85948815e-02]
 [ 4.15970526e-02  1.64748346e-01 -4.35384079e-02]
 [-1.08784037e-01 -4.52012724e-03 -2.07500250e-02]
 [-3.39802374e-02  1.85922834e-01  4.82284795e-02]
 [ 3.97563316e-02 -1.41310731e-01 -1.49929052e-01]
 [-6.52815454e-02  4.09211475e-01  8.85696283e-02]
 [ 4.28228884e-01  2.86302164e-01  6.03186062e-02]
 [ 2.26400002e-01 -8.05474015e-02 -2.15068435e-02]
 [-3.61897145e-01 -7.42805844e-01  2.04302999e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.19855702]
curr_Stock_Price:  98.6643390328487
curr_Factors:  [98.66433903 -0.75131233 -1.00653872]
mat_Sqrt:  [[17.0112096   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00356495  0.11141462  1.23243717]
Stock Position:  -0.003564949795914641
Bond Position:  [-6.84682361]


portfolio before change:  [-7.20301214]
curr_Stock_Price:  99.67394806527511
curr_Factors:  [99.67394807 -0.79918041 -1.02236001]
mat_Sqrt:  [[16.12488809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281435  0.01411938  0.0859571 ]
Stock Position:  -0.0028143477695493644
Bond Position:  [-6.92249498]


portfolio before change:  [-7.20514402]
curr_Stock_Price:  100.12396934632172
curr_Factors:  [100.12396935  -0.93804733  -1.00717421]
mat_Sqrt:  [[14.31327707  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02237375 0.06337396 0.74328209]
Stock Position:  0.02237375487159815
Bond Position:  [-9.44529316]


portfolio before change:  [-7.21438588]
curr_Stock_Price:  99.7636752536728
curr_Factors:  [99.76367525 -0.87950162 -1.01991054]
mat_Sqrt:  [[14.93028917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00147831 0.01182248 0.36982247]
Stock Position:  0.0014783120800942792
Bond Position:  [-7.36186773]


portfolio before change:  [-7.21446606]
curr_Stock_Price:  100.33197029010151
curr_Factors:  [100.33197029  -0.8683398   -1.05444098]
mat_Sqrt:  [[14.66851862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04494765 -0.06341967  0.10408484]
Stock Position:  -0.04494764633172993
Bond Position:  [-2.70478014]


portfolio before change:  [-7.19655143]
curr_Stock_Price:  99.92588131278372
curr_Factors:  [99.92588131 -0.54287669 -1.04126321]
mat_Sqrt:  [[20.497211    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143539 -0.03147836 -0.34010325]
Stock Position:  -0.0014353943537583078
Bond Position:  [-7.05311839]


portfolio before change:  [-7.19716765]
curr_Stock_Price:  99.74092810111375
curr_Factors:  [99.7409281  -0.913635   -1.04731711]
mat_Sqrt:  [[14.0359795   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00200849 -0.00708957 -0.07592934]
Stock Position:  0.002008487286444682
Bond Position:  [-7.39749603]


portfolio before change:  [-7.19695898]
curr_Stock_Price:  100.30523846399372
curr_Factors:  [100.30523846  -0.75480952  -1.03734984]
mat_Sqrt:  [[16.71085585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01437845 -0.02171613 -0.13646056]
Stock Position:  0.014378449251871397
Bond Position:  [-8.63919276]


portfolio before change:  [-7.19826095]
curr_Stock_Price:  100.28979854865341
curr_Factors:  [100.28979855  -0.78507505  -1.01274486]
mat_Sqrt:  [[16.61397271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02783986 -0.00812699 -0.13227192]
Stock Position:  -0.027839863357570938
Bond Position:  [-4.40620666]


portfolio before change:  [-7.18449076]
curr_Stock_Price:  99.77539231248471
curr_Factors:  [99.77539231 -0.64096702 -1.02617795]
mat_Sqrt:  [[18.83612582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235047 -0.00937697 -0.13464105]
Stock Position:  0.0023504715069258652
Bond Position:  [-7.41900998]


portfolio before change:  [-7.18192695]
curr_Stock_Price:  101.26073246869333
curr_Factors:  [101.26073247  -0.71755798  -1.01181719]
mat_Sqrt:  [[17.96316952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0021903  -0.09373195  0.38265079]
Stock Position:  0.0021903026331106575
Bond Position:  [-7.40371859]


portfolio before change:  [-7.18098776]
curr_Stock_Price:  102.11207777056686
curr_Factors:  [102.11207777  -0.61066161  -0.99721898]
mat_Sqrt:  [[20.45424461  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00352619  0.00225658  0.15019092]
Stock Position:  -0.0035261932162133935
Bond Position:  [-6.82092085]


portfolio before change:  [-7.18911099]
curr_Stock_Price:  104.17394807102897
curr_Factors:  [104.17394807  -0.3962482   -1.04831825]
mat_Sqrt:  [[24.56924929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00308093 0.01312779 0.55194557]
Stock Position:  0.003080931485238324
Bond Position:  [-7.51006378]


portfolio before change:  [-7.19507091]
curr_Stock_Price:  102.54421222299662
curr_Factors:  [102.54421222  -0.49384408  -1.04338068]
mat_Sqrt:  [[22.04463552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00487454 0.08371283 0.64033994]
Stock Position:  0.0048745351489323935
Bond Position:  [-7.69492627]


portfolio before change:  [-7.20435615]
curr_Stock_Price:  100.83670189306865
curr_Factors:  [100.83670189  -0.47437728  -1.02096229]
mat_Sqrt:  [[22.60481237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185298 -0.03510336 -0.16525371]
Stock Position:  0.0018529819487402089
Bond Position:  [-7.39120474]


portfolio before change:  [-7.20534335]
curr_Stock_Price:  100.80257516360969
curr_Factors:  [100.80257516  -0.45467171  -1.02864023]
mat_Sqrt:  [[22.87059351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016934   0.00669874  0.08936481]
Stock Position:  -0.001693399069591177
Bond Position:  [-7.03464436]


portfolio before change:  [-7.20833232]
curr_Stock_Price:  102.04834671782803
curr_Factors:  [102.04834672  -0.34889585  -1.01158118]
mat_Sqrt:  [[26.1793166   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01463395 -0.06577537  0.26990793]
Stock Position:  -0.014633949734764376
Bond Position:  [-5.71496194]


portfolio before change:  [-7.18367932]
curr_Stock_Price:  100.31488314567831
curr_Factors:  [100.31488315  -0.19043119  -1.00007474]
mat_Sqrt:  [[30.50248428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00663918 -0.03264194 -0.07963242]
Stock Position:  -0.006639184652999287
Bond Position:  [-6.51767028]


portfolio before change:  [-7.17140158]
curr_Stock_Price:  98.34287981164397
curr_Factors:  [98.34287981 -0.22061657 -1.00015951]
mat_Sqrt:  [[29.01126104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01050015 0.35917132 0.60347191]
Stock Position:  0.01050015124068837
Bond Position:  [-8.20401669]


portfolio before change:  [-7.18946883]
curr_Stock_Price:  96.71988636963407
curr_Factors:  [ 9.67198864e+01  5.34875751e-02 -9.87805745e-01]
mat_Sqrt:  [[37.9967588   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00856564 -0.01985005  0.81025334]
Stock Position:  -0.008565636064125802
Bond Position:  [-6.36100148]


portfolio before change:  [-7.22697161]
curr_Stock_Price:  101.00533740837311
curr_Factors:  [ 1.01005337e+02  9.65178326e-03 -1.02847107e+00]
mat_Sqrt:  [[36.46504286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144604  0.07469184 -0.02184862]
Stock Position:  -0.0014460414879786565
Bond Position:  [-7.08091371]


portfolio before change:  [-7.229407]
curr_Stock_Price:  102.07737639833944
curr_Factors:  [102.0773764   -0.17750635  -1.05142162]
mat_Sqrt:  [[29.86846232  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00130133  0.01916992 -0.08961985]
Stock Position:  -0.0013013346073948281
Bond Position:  [-7.09657017]


portfolio before change:  [-7.23008956]
curr_Stock_Price:  101.92017968227387
curr_Factors:  [101.92017968  -0.20586123  -1.03558854]
mat_Sqrt:  [[29.45136275  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0048286  -0.01214445  0.38043103]
Stock Position:  0.00482859595486379
Bond Position:  [-7.72222092]


portfolio before change:  [-7.23514021]
curr_Stock_Price:  101.07411332240433
curr_Factors:  [ 1.01074113e+02  5.24527481e-02 -1.02760615e+00]
mat_Sqrt:  [[38.11853468  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00243012 0.06228506 0.12557889]
Stock Position:  0.002430122348493433
Bond Position:  [-7.48076267]


portfolio before change:  [-7.23435185]
curr_Stock_Price:  101.78334080660825
curr_Factors:  [ 1.01783341e+02 -5.79594482e-02 -1.01840227e+00]
mat_Sqrt:  [[34.69115406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095301 -0.0668359   0.4933153 ]
Stock Position:  -0.0009530070462929412
Bond Position:  [-7.13735161]


portfolio before change:  [-7.23653853]
curr_Stock_Price:  103.14162693158805
curr_Factors:  [ 1.03141627e+02  7.99725135e-02 -1.03510787e+00]
mat_Sqrt:  [[39.68477867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035236  0.01995873 -0.03303079]
Stock Position:  0.00035235793468325243
Bond Position:  [-7.2728813]


portfolio before change:  [-7.23540045]
curr_Stock_Price:  108.95176429626291
curr_Factors:  [108.9517643   -0.24434637  -1.04567977]
mat_Sqrt:  [[29.99045353  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00164153 -0.01536559  1.33081075]
Stock Position:  0.0016415277257821827
Bond Position:  [-7.41424779]


portfolio before change:  [-7.23807634]
curr_Stock_Price:  107.88626281889995
curr_Factors:  [ 1.07886263e+02  8.19224692e-02 -1.05457391e+00]
mat_Sqrt:  [[40.78955757  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00222874  0.02441549 -0.26150851]
Stock Position:  0.0022287378384009703
Bond Position:  [-7.47852654]


portfolio before change:  [-7.24352577]
curr_Stock_Price:  105.86065078583131
curr_Factors:  [105.86065079   0.31372305  -1.07064992]
mat_Sqrt:  [[49.65984938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02286822 -0.05943782 -3.67757712]
Stock Position:  -0.022868216231073588
Bond Position:  [-4.82268152]


portfolio before change:  [-7.24031738]
curr_Stock_Price:  105.69398847580875
curr_Factors:  [105.69398848   0.21312427  -1.01884863]
mat_Sqrt:  [[47.22028922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213127 -0.05669491  0.45409973]
Stock Position:  0.0021312731799119555
Bond Position:  [-7.46558014]


portfolio before change:  [-7.24349115]
curr_Stock_Price:  104.64273118148871
curr_Factors:  [104.64273118   0.19344684  -1.02638785]
mat_Sqrt:  [[45.49538867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175537 -0.03628684  0.28126375]
Stock Position:  0.0017553667728138018
Bond Position:  [-7.42717752]


portfolio before change:  [-7.24384012]
curr_Stock_Price:  104.97285190696418
curr_Factors:  [104.97285191   0.37443665  -1.02570108]
mat_Sqrt:  [[54.73138616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00067536  0.052098   -0.12420296]
Stock Position:  0.0006753637889281913
Bond Position:  [-7.31473498]


portfolio before change:  [-7.2448002]
curr_Stock_Price:  104.90521956067079
curr_Factors:  [104.90521956   0.51255401  -1.029591  ]
mat_Sqrt:  [[62.55338075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180864 -0.00142939 -0.05919405]
Stock Position:  -0.0018086364896916316
Bond Position:  [-7.05506479]


portfolio before change:  [-7.25337752]
curr_Stock_Price:  109.16002091360407
curr_Factors:  [ 1.09160021e+02  1.01607450e-01 -1.01192898e+00]
mat_Sqrt:  [[43.92542727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044018  0.05879396  0.13758243]
Stock Position:  -0.00044018088123455736
Bond Position:  [-7.20532737]


portfolio before change:  [-7.25503812]
curr_Stock_Price:  110.88629760019914
curr_Factors:  [ 1.10886298e+02  9.22081354e-02 -1.01484833e+00]
mat_Sqrt:  [[44.07378406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.24871617e-04 -4.46863766e-02 -4.27705852e-01]
Stock Position:  0.0001248716170679664
Bond Position:  [-7.26888467]


portfolio before change:  [-7.25590148]
curr_Stock_Price:  111.24912766564877
curr_Factors:  [111.24912767   0.16142598  -1.03845594]
mat_Sqrt:  [[46.28149114  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007916   0.12940403  0.2526645 ]
Stock Position:  -0.0007916026472975221
Bond Position:  [-7.16783638]


portfolio before change:  [-7.26034586]
curr_Stock_Price:  115.73160755028711
curr_Factors:  [ 1.15731608e+02  8.09011923e-02 -1.07117087e+00]
mat_Sqrt:  [[42.99157243  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0104191  0.09053669 0.17207219]
Stock Position:  0.010419103851794358
Bond Position:  [-8.4661655]


portfolio before change:  [-7.19114106]
curr_Stock_Price:  122.47529058733384
curr_Factors:  [ 1.22475291e+02 -2.34957112e-02 -1.06059242e+00]
mat_Sqrt:  [[41.42237412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00530945 -0.02547132 -0.06135304]
Stock Position:  0.0053094545167618815
Bond Position:  [-7.84141805]


portfolio before change:  [-7.19976353]
curr_Stock_Price:  121.0359283306874
curr_Factors:  [121.03592833  -0.24699644  -1.05765672]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.19976353]
Stock Price:  119.72233403762128
PL:  [-26.92209757]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.55950545e-01  1.66225473e-01  3.07480231e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.93145747e-01  6.58045021e-03 -6.44680941e-02]
 [-1.42762086e-02  2.98298442e-02  1.23170246e-01]
 [-9.38781212e-01 -2.79069709e-01  2.97121891e-02]
 [-3.21840540e-02 -4.26346152e-02 -3.29178838e-02]
 [ 3.36034589e-02  4.90457409e-02 -1.55227320e-02]
 [ 3.23146676e-01 -3.73451307e-02 -7.78371050e-02]
 [-4.79300549e-01 -2.80347460e-02 -4.85022195e-02]
 [ 4.77268945e-02 -1.78509853e-02 -4.16672452e-02]
 [ 4.34921439e-02 -2.46127396e-01  2.30897444e-02]
 [-4.92527903e-02  2.76078304e-03  3.42642172e-02]
 [ 1.92751790e-01 -1.39309077e-01  1.88186318e-01]
 [ 7.82366403e-02  4.21821760e-02 -2.24503068e-03]
 [ 8.85942981e-02 -1.12805313e-01 -5.88535519e-02]
 [-3.56050246e-02  4.16210767e-02  4.38313872e-02]
 [-4.42673933e-01 -2.60839517e-01  1.17553312e-01]
 [-1.78128116e-01 -1.37599987e-03 -3.43193304e-02]
 [ 3.50291700e-01  1.39947873e+00  5.57224347e-01]
 [-1.56755001e-01 -1.46883052e-02  1.44301799e-01]
 [-9.40584981e-02  2.27941081e-01 -3.33108319e-02]
 [ 5.70422081e-02  4.53219060e-04  3.70090903e-02]
 [-2.78245874e-02 -2.18080514e-02 -4.44367778e-02]
 [ 2.27934345e-02  8.25950748e-02  1.13164442e-01]
 [-7.10447433e-02 -8.60584345e-02 -8.38691061e-02]
 [ 1.08995176e-01 -8.91690916e-03 -8.37656468e-03]
 [-1.92674170e-02  7.47208070e-03 -5.13792925e-02]
 [ 8.22053177e-03  4.12104705e-02 -3.55735156e-02]
 [-5.37448735e-01  8.37269166e-02 -6.84865725e-01]
 [-1.07158152e-01 -6.77439293e-02 -9.04044170e-04]
 [-9.11182019e-02  8.63241195e-02  1.97723636e-01]
 [ 1.03882108e-02  2.98213604e-02  2.10775920e-02]
 [-1.11001030e-01 -1.38472347e-03 -1.53417925e-01]
 [-6.34763668e-02  4.62457828e-02  7.78432367e-02]
 [ 2.07774638e-01 -1.65877203e-01 -7.31797118e-02]
 [ 1.76810736e-02  2.04807904e-02  6.00727194e-02]
 [-5.21536763e-03 -1.42913536e-02 -3.80784284e-02]
 [-1.07882094e-01  2.96634172e-02  3.25788219e-03]
 [ 2.76278851e-03 -2.83382545e-01  1.01485674e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.97998286]
curr_Stock_Price:  99.25211282743295
curr_Factors:  [99.25211283 -0.76209745 -0.98007606]
mat_Sqrt:  [[17.38294746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01086665  0.05256511  0.87715551]
Stock Position:  -0.010866654419227965
Bond Position:  [-1.90144444]


portfolio before change:  [-2.98901304]
curr_Stock_Price:  100.0612387097895
curr_Factors:  [100.06123871  -0.88135243  -1.00167707]
mat_Sqrt:  [[15.22216958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298125  0.01411938  0.0859571 ]
Stock Position:  -0.002981246701790263
Bond Position:  [-2.6907058]


portfolio before change:  [-2.99201686]
curr_Stock_Price:  100.95598432627463
curr_Factors:  [100.95598433  -0.94164073  -1.00332652]
mat_Sqrt:  [[14.43588861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01940692  0.00208092 -0.18390953]
Stock Position:  0.01940692165559242
Bond Position:  [-4.95126174]


portfolio before change:  [-3.01110269]
curr_Stock_Price:  100.00442232560101
curr_Factors:  [100.00442233  -0.9049348   -1.011237  ]
mat_Sqrt:  [[14.71757863  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00079062 0.00943302 0.35137043]
Stock Position:  0.0007906202546037309
Bond Position:  [-3.09016822]


portfolio before change:  [-3.0112204]
curr_Stock_Price:  100.34414806832615
curr_Factors:  [100.34414807  -1.23434274  -1.0142618 ]
mat_Sqrt:  [[10.59096428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08874752 -0.08824959  0.08476061]
Stock Position:  -0.08874751729780499
Bond Position:  [5.89407362]


portfolio before change:  [-3.00483365]
curr_Stock_Price:  100.28048501104881
curr_Factors:  [100.28048501  -1.18047509  -0.99346711]
mat_Sqrt:  [[11.4047383   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00350768 -0.01348225 -0.09390556]
Stock Position:  -0.003507683291463111
Bond Position:  [-2.65308147]


portfolio before change:  [-3.00547057]
curr_Stock_Price:  100.36751285103657
curr_Factors:  [100.36751285  -1.02004278  -1.01965837]
mat_Sqrt:  [[13.05455905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00242837  0.01550963 -0.04428203]
Stock Position:  0.002428366211823143
Bond Position:  [-3.24919965]


portfolio before change:  [-3.00466093]
curr_Stock_Price:  100.86818632159198
curr_Factors:  [100.86818632  -1.12733951  -1.02168407]
mat_Sqrt:  [[11.76102387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02604314 -0.01180957 -0.22204759]
Stock Position:  0.026043140424397825
Bond Position:  [-5.63158527]


portfolio before change:  [-3.01175204]
curr_Stock_Price:  100.62293476366011
curr_Factors:  [100.62293476  -0.96931188  -1.03362184]
mat_Sqrt:  [[13.57794102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03608241 -0.00886537 -0.13836333]
Stock Position:  -0.03608241312790466
Bond Position:  [0.61896626]


portfolio before change:  [-2.98000794]
curr_Stock_Price:  99.74531255481992
curr_Factors:  [99.74531255 -1.01740863 -1.04006689]
mat_Sqrt:  [[12.74507019  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00304123 -0.00564498 -0.11886505]
Stock Position:  0.0030412302700214286
Bond Position:  [-3.2833564]


portfolio before change:  [-2.98225677]
curr_Stock_Price:  99.14082688029131
curr_Factors:  [99.14082688 -1.11272177 -1.04514252]
mat_Sqrt:  [[11.45787242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00365254 -0.07783232  0.06586861]
Stock Position:  0.0036525399055510497
Bond Position:  [-3.34437259]


portfolio before change:  [-2.9799181]
curr_Stock_Price:  99.89557353707293
curr_Factors:  [99.89557354 -1.25392395 -1.05052648]
mat_Sqrt:  [[ 9.97094089  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423103  0.00087304  0.09774627]
Stock Position:  -0.004231030310019925
Bond Position:  [-2.5572569]


portfolio before change:  [-2.9800472]
curr_Stock_Price:  99.85053137810607
curr_Factors:  [99.85053138 -1.11975255 -1.07614896]
mat_Sqrt:  [[11.10919198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02048468 -0.0440534   0.53684318]
Stock Position:  0.02048467759402157
Bond Position:  [-5.02545314]


portfolio before change:  [-2.96635407]
curr_Stock_Price:  100.54965644293482
curr_Factors:  [100.54965644  -1.21538527  -1.07606312]
mat_Sqrt:  [[10.16757063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00775677  0.01333918 -0.00640445]
Stock Position:  0.00775677074429571
Bond Position:  [-3.7462947]


portfolio before change:  [-2.96550905]
curr_Stock_Price:  100.71897127982562
curr_Factors:  [100.71897128  -1.20156474  -1.08751796]
mat_Sqrt:  [[10.20881407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00721614 -0.03567217 -0.1678928 ]
Stock Position:  0.007216141460152796
Bond Position:  [-3.69231139]


portfolio before change:  [-2.96474652]
curr_Stock_Price:  100.88860428714507
curr_Factors:  [100.88860429  -1.16125155  -1.11935439]
mat_Sqrt:  [[10.31305994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248067  0.01316174  0.12503875]
Stock Position:  -0.0024806729261493098
Bond Position:  [-2.71447489]


portfolio before change:  [-2.96110921]
curr_Stock_Price:  99.2855554549473
curr_Factors:  [99.28555545 -1.05187324 -1.09015028]
mat_Sqrt:  [[11.65781275  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03649169 -0.0824847   0.33534688]
Stock Position:  -0.03649169185365319
Bond Position:  [0.66198868]


portfolio before change:  [-2.94292571]
curr_Stock_Price:  98.78953157478247
curr_Factors:  [98.78953157 -1.03399579 -1.06336774]
mat_Sqrt:  [[12.12934972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0152662  -0.00043513 -0.0979035 ]
Stock Position:  -0.01526619746268866
Bond Position:  [-1.43478521]


portfolio before change:  [-2.9435107]
curr_Stock_Price:  98.8161025125311
curr_Factors:  [98.81610251 -1.08848325 -1.06570245]
mat_Sqrt:  [[11.46243169  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04363551 0.44255403 1.58960596]
Stock Position:  0.04363550792229199
Bond Position:  [-7.25540153]


portfolio before change:  [-2.95887447]
curr_Stock_Price:  98.48479459762954
curr_Factors:  [98.4847946  -1.21319168 -1.06836658]
mat_Sqrt:  [[10.0577543   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01269456 -0.00464485  0.41165287]
Stock Position:  -0.01269456043531786
Bond Position:  [-1.7086533]


portfolio before change:  [-2.95667092]
curr_Stock_Price:  98.29438627681313
curr_Factors:  [98.29438628 -0.98053561 -1.05681148]
mat_Sqrt:  [[12.81504443  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00741103  0.0720813  -0.09502653]
Stock Position:  -0.007411026180829601
Bond Position:  [-2.22820865]


portfolio before change:  [-2.95765466]
curr_Stock_Price:  98.38954147297095
curr_Factors:  [98.38954147 -1.30327896 -1.0466115 ]
mat_Sqrt:  [[ 9.38435601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00688469 0.00014332 0.10557663]
Stock Position:  0.006884687555233
Bond Position:  [-3.63503591]


portfolio before change:  [-2.9565625]
curr_Stock_Price:  98.61418047402783
curr_Factors:  [98.61418047 -1.35221828 -1.04267893]
mat_Sqrt:  [[ 8.99184323  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416581 -0.00689631 -0.12676576]
Stock Position:  -0.004165807522963931
Bond Position:  [-2.5457548]


portfolio before change:  [-2.95769795]
curr_Stock_Price:  98.81035228753153
curr_Factors:  [98.81035229 -1.28570871 -1.05729856]
mat_Sqrt:  [[ 9.48958717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00506088 0.02611886 0.32282665]
Stock Position:  0.0050608761315149575
Bond Position:  [-3.45776491]


portfolio before change:  [-2.9552182]
curr_Stock_Price:  99.38574677005955
curr_Factors:  [99.38574677 -1.45188342 -1.02737696]
mat_Sqrt:  [[ 8.32904105  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01085197 -0.02721407 -0.23925522]
Stock Position:  -0.010851966222913099
Bond Position:  [-1.87668743]


portfolio before change:  [-2.95605903]
curr_Stock_Price:  99.44161009615665
curr_Factors:  [99.4416101  -1.68324353 -1.01217043]
mat_Sqrt:  [[ 6.71374341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01594566 -0.00281977 -0.02389601]
Stock Position:  0.015945661943545335
Bond Position:  [-4.54172132]


portfolio before change:  [-2.95484863]
curr_Stock_Price:  99.5531228117973
curr_Factors:  [99.55312281 -1.59777335 -1.01131348]
mat_Sqrt:  [[ 7.32728146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403454  0.00236288 -0.14657082]
Stock Position:  -0.004034544467781392
Bond Position:  [-2.55319713]


portfolio before change:  [-2.95527106]
curr_Stock_Price:  99.57871628697976
curr_Factors:  [99.57871629 -1.63614581 -1.02489043]
mat_Sqrt:  [[ 6.95814008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00029076  0.0130319  -0.10148134]
Stock Position:  0.00029076276743524005
Bond Position:  [-2.98422484]


portfolio before change:  [-2.9555237]
curr_Stock_Price:  99.9928445538524
curr_Factors:  [99.99284455 -1.68776593 -1.01088576]
mat_Sqrt:  [[ 6.72913727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.1003226   0.02647678 -1.95373128]
Stock Position:  -0.100322599966894
Bond Position:  [7.07601844]


portfolio before change:  [-2.96885004]
curr_Stock_Price:  100.13449652269524
curr_Factors:  [100.13449652  -1.498432    -1.01537132]
mat_Sqrt:  [[ 8.10686258  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01345673 -0.02142251 -0.00257899]
Stock Position:  -0.013456726224081858
Bond Position:  [-1.62136753]


portfolio before change:  [-2.980296]
curr_Stock_Price:  100.9700101496667
curr_Factors:  [100.97001015  -1.55792546  -1.02628765]
mat_Sqrt:  [[ 7.61873565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00636971  0.02729808  0.5640505 ]
Stock Position:  -0.006369712352856343
Bond Position:  [-2.33714608]


portfolio before change:  [-2.97877314]
curr_Stock_Price:  100.68506555151356
curr_Factors:  [100.68506555  -1.49606528  -1.01020299]
mat_Sqrt:  [[ 8.21308989  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00188244 0.00943034 0.0601285 ]
Stock Position:  0.0018824389710286036
Bond Position:  [-3.16830663]


portfolio before change:  [-2.9791235]
curr_Stock_Price:  100.7093478559407
curr_Factors:  [100.70934786  -1.46970201  -1.00059049]
mat_Sqrt:  [[ 8.51599468  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01671597 -0.00043789 -0.43765864]
Stock Position:  -0.01671596699492827
Bond Position:  [-1.29566936]


portfolio before change:  [-2.95409099]
curr_Stock_Price:  99.20213772707288
curr_Factors:  [99.20213773 -1.19180738 -0.98736768]
mat_Sqrt:  [[11.22321619  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00413363  0.0146242   0.22206509]
Stock Position:  -0.004133629871732129
Bond Position:  [-2.54402607]


portfolio before change:  [-2.95866373]
curr_Stock_Price:  100.23143103191215
curr_Factors:  [100.23143103  -1.49831017  -0.99744823]
mat_Sqrt:  [[ 8.26246875  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02282054 -0.05245498 -0.20876135]
Stock Position:  0.022820535476066574
Bond Position:  [-5.24599866]


portfolio before change:  [-2.96879186]
curr_Stock_Price:  99.8163513895406
curr_Factors:  [99.81635139 -1.58349492 -0.99315917]
mat_Sqrt:  [[ 7.58883377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0040154  0.00647659 0.17137075]
Stock Position:  0.004015396669446322
Bond Position:  [-3.36959411]


portfolio before change:  [-2.969438]
curr_Stock_Price:  99.76033968372866
curr_Factors:  [99.76033968 -1.44375618 -0.99160353]
mat_Sqrt:  [[ 8.73563815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152903 -0.00451932 -0.10862716]
Stock Position:  -0.0015290348814368004
Bond Position:  [-2.81690096]


portfolio before change:  [-2.96843315]
curr_Stock_Price:  98.87286211253787
curr_Factors:  [98.87286211 -1.43836723 -0.97790412]
mat_Sqrt:  [[ 8.82477802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01206276  0.0093804   0.00929383]
Stock Position:  -0.012062759515319299
Bond Position:  [-1.77575359]


portfolio before change:  [-2.96616205]
curr_Stock_Price:  98.66618604017847
curr_Factors:  [98.66618604 -1.43242049 -0.97164194]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.96616205]
Stock Price:  98.41394256522392
PL:  [-2.96616205]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.82286050e-01  5.94130990e-03  1.13349532e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.41351322e-01  3.14871468e-01  4.56766851e-01]
 [-5.95910386e-02 -3.07868736e-02  8.27843550e-02]
 [-3.64944807e-01 -1.16523836e-01  4.37352767e-02]
 [ 1.86509882e-02 -1.40144022e-01 -1.80792114e-01]
 [ 3.01753102e-02 -1.48801431e-01 -2.19272947e-02]
 [ 2.69112465e-01  1.70634157e-01 -7.82971146e-02]
 [-2.19607595e-01  1.96816129e-02 -1.33878905e-01]
 [ 4.41112562e-02 -9.03229501e-03 -4.87517280e-02]
 [ 5.12996060e-02 -1.85709285e-01  7.60815951e-04]
 [-4.66488071e-03 -2.18836350e-03  1.12910146e-02]
 [ 2.50082499e-01 -2.43205568e-01  6.22126043e-02]
 [ 8.45819474e-02 -6.13085303e-02 -5.84571560e-02]
 [ 1.46511114e-02 -2.99363376e-02 -8.54004423e-03]
 [-3.35022715e-02 -4.45983297e-02  1.08274520e-02]
 [-3.04016348e-01 -2.93905733e-01  6.85533671e-02]
 [-1.43194392e-01  1.15526766e-02 -2.69282419e-02]
 [ 3.26635796e-01  1.34827290e+00  4.98457086e-01]
 [-8.35605784e-02 -8.31768625e-03  9.01005370e-02]
 [-9.42271043e-02  2.33410270e-01 -3.30543826e-02]
 [-1.69303310e-02  4.68462277e-02 -1.65472792e-02]
 [ 6.04404281e-02 -3.51861014e-02  7.99403140e-02]
 [ 7.02691238e-02  1.50744045e-01  4.44706626e-02]
 [-6.80583953e-02 -1.40300602e-01 -3.75488424e-02]
 [ 1.09285093e-01 -4.77670117e-03 -8.77899202e-03]
 [ 1.97259125e-02 -6.17530001e-02  2.60578382e-02]
 [ 6.44063362e-03  4.14976336e-02 -3.45845706e-02]
 [-5.60904901e-01  5.10228698e-02 -7.50035277e-01]
 [-7.01347988e-02 -1.16885672e-01 -1.83927374e-03]
 [-7.90021180e-02  8.69610241e-02  1.99475128e-01]
 [ 1.74444716e-02  7.71618920e-02 -1.62846898e-03]
 [-1.12545136e-01 -2.26440069e-03 -1.52398003e-01]
 [-6.31903133e-02  5.30949534e-02  8.21870352e-02]
 [ 8.20173392e-02 -7.37123557e-02 -1.60166985e-03]
 [-6.23852070e-03  7.10723493e-03  5.14779809e-02]
 [ 3.88697911e-03 -5.82125210e-03 -3.30218844e-02]
 [-9.98635088e-02 -2.20602861e-02  2.46882558e-03]
 [-2.59410673e-02 -3.07493814e-01  1.31584869e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.26575788]
curr_Stock_Price:  99.84367173860704
curr_Factors:  [99.84367174 -0.98177641 -1.01128039]
mat_Sqrt:  [[13.60651716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01168523  0.00187881  0.32335466]
Stock Position:  -0.011685229024846743
Bond Position:  [2.43245405]


portfolio before change:  [1.26814861]
curr_Stock_Price:  99.66509988300676
curr_Factors:  [99.66509988 -0.97704293 -0.99446193]
mat_Sqrt:  [[13.87808119  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00326998  0.01411938  0.0859571 ]
Stock Position:  -0.0032699796346527194
Bond Position:  [1.59405145]


portfolio before change:  [1.27068818]
curr_Stock_Price:  98.94940644011956
curr_Factors:  [98.94940644 -0.84663815 -1.01307729]
mat_Sqrt:  [[15.40809824  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02224275 0.0995711  1.30302869]
Stock Position:  0.02224274574561438
Bond Position:  [-0.93021831]


portfolio before change:  [1.25793992]
curr_Stock_Price:  98.38149221889762
curr_Factors:  [98.38149222 -1.03761618 -1.02607616]
mat_Sqrt:  [[12.49289841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00348099 -0.00973566  0.23616072]
Stock Position:  -0.0034809909697833684
Bond Position:  [1.60040501]


portfolio before change:  [1.25816252]
curr_Stock_Price:  98.37501982680536
curr_Factors:  [98.37501983 -0.9627455  -1.01906371]
mat_Sqrt:  [[13.55801242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02648073 -0.03684807  0.12476457]
Stock Position:  -0.026480726151558512
Bond Position:  [3.86320448]


portfolio before change:  [1.24663233]
curr_Stock_Price:  98.82867476149814
curr_Factors:  [98.82867476 -1.00419589 -1.00866439]
mat_Sqrt:  [[13.20410158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165642 -0.04431743 -0.51574958]
Stock Position:  -0.001656420971984758
Bond Position:  [1.41033422]


portfolio before change:  [1.24742101]
curr_Stock_Price:  98.45897596694337
curr_Factors:  [98.45897597 -1.21815244 -1.00846811]
mat_Sqrt:  [[10.62297833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00205756 -0.04705514 -0.06255247]
Stock Position:  0.002057557003804928
Bond Position:  [1.04483606]


portfolio before change:  [1.2473516]
curr_Stock_Price:  98.36176236248524
curr_Factors:  [98.36176236 -1.23505833 -1.02975944]
mat_Sqrt:  [[10.21476642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02521212  0.05395926 -0.22335987]
Stock Position:  0.02521211719388537
Bond Position:  [-1.23255668]


portfolio before change:  [1.25717549]
curr_Stock_Price:  98.75752315707139
curr_Factors:  [98.75752316 -1.2755632  -1.04549107]
mat_Sqrt:  [[ 9.6950293   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02541791  0.00622387 -0.38191925]
Stock Position:  -0.025417905159906752
Bond Position:  [3.76738485]


portfolio before change:  [1.26296905]
curr_Stock_Price:  98.54811923573787
curr_Factors:  [98.54811924 -1.49572324 -1.03735543]
mat_Sqrt:  [[ 7.82611544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00433505 -0.00285626 -0.13907511]
Stock Position:  0.004335054696954883
Bond Position:  [0.83575757]


portfolio before change:  [1.26381175]
curr_Stock_Price:  98.71841025830015
curr_Factors:  [98.71841026 -1.4644086  -1.04530016]
mat_Sqrt:  [[ 8.02500824  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00581431 -0.05872643  0.0021704 ]
Stock Position:  0.005814313501558878
Bond Position:  [0.68983197]


portfolio before change:  [1.26533269]
curr_Stock_Price:  98.96516492291227
curr_Factors:  [98.96516492 -1.70927315 -1.03897801]
mat_Sqrt:  [[ 6.33770526  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038131 -0.00069202  0.03221012]
Stock Position:  -0.00038130761973326785
Bond Position:  [1.30306887]


portfolio before change:  [1.26565406]
curr_Stock_Price:  98.54957668855967
curr_Factors:  [98.54957669 -1.34324679 -1.05721623]
mat_Sqrt:  [[ 8.93607731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0287041  -0.07690835  0.17747524]
Stock Position:  0.028704099589055027
Bond Position:  [-1.56312281]


portfolio before change:  [1.26947265]
curr_Stock_Price:  98.68941728261203
curr_Factors:  [98.68941728 -1.28093452 -1.0343773 ]
mat_Sqrt:  [[ 9.74413823  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00729325 -0.01938746 -0.16676199]
Stock Position:  0.007293251521072944
Bond Position:  [0.54970591]


portfolio before change:  [1.26794737]
curr_Stock_Price:  98.47085941330951
curr_Factors:  [98.47085941 -1.51938899 -1.04632966]
mat_Sqrt:  [[ 7.56885664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00160327 -0.0094667  -0.02436237]
Stock Position:  0.001603271123554405
Bond Position:  [1.11007189]


portfolio before change:  [1.26805275]
curr_Stock_Price:  98.45003325344797
curr_Factors:  [98.45003325 -1.42057155 -1.01209624]
mat_Sqrt:  [[ 8.64413758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00375325 -0.01410323  0.03088771]
Stock Position:  -0.00375325481975718
Bond Position:  [1.63756081]


portfolio before change:  [1.26959461]
curr_Stock_Price:  98.09376946289858
curr_Factors:  [98.09376946 -1.25299128 -1.02980979]
mat_Sqrt:  [[10.00537833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02974516 -0.09294115  0.19556367]
Stock Position:  -0.029745158490204926
Bond Position:  [4.18740933]


portfolio before change:  [1.22636526]
curr_Stock_Price:  99.56469135726964
curr_Factors:  [99.56469136 -1.21458953 -1.06023613]
mat_Sqrt:  [[10.23672697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01449612  0.00365328 -0.07681878]
Stock Position:  -0.01449611857529862
Bond Position:  [2.66966683]


portfolio before change:  [1.22181415]
curr_Stock_Price:  99.90166668023602
curr_Factors:  [99.90166668 -1.00226608 -1.05169277]
mat_Sqrt:  [[12.81001793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03615882 0.42636133 1.42195932]
Stock Position:  0.0361588236651803
Bond Position:  [-2.39051259]


portfolio before change:  [1.21452632]
curr_Stock_Price:  99.7083804804644
curr_Factors:  [99.70838048 -1.10823455 -1.06022543]
mat_Sqrt:  [[11.40201109  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0057344  -0.00263028  0.25703175]
Stock Position:  -0.005734395847072257
Bond Position:  [1.78629364]


portfolio before change:  [1.21461991]
curr_Stock_Price:  99.73100064332107
curr_Factors:  [99.73100064 -0.91460924 -1.07857392]
mat_Sqrt:  [[13.5894452   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00698687  0.07381081 -0.09429495]
Stock Position:  -0.006986869087131029
Bond Position:  [1.91142735]


portfolio before change:  [1.20663755]
curr_Stock_Price:  100.90767986685267
curr_Factors:  [100.90767987  -1.20028665  -1.07055855]
mat_Sqrt:  [[10.41618495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183354  0.01481408 -0.04720478]
Stock Position:  -0.0018335375079663375
Bond Position:  [1.39165556]


portfolio before change:  [1.20640945]
curr_Stock_Price:  101.12696564871932
curr_Factors:  [101.12696565  -1.09616181  -1.07633563]
mat_Sqrt:  [[11.51763546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00658552 -0.01112682  0.22804746]
Stock Position:  0.006585524901603803
Bond Position:  [0.5404353]


portfolio before change:  [1.20469511]
curr_Stock_Price:  100.85638750076998
curr_Factors:  [100.8563875   -1.05017167  -1.05538301]
mat_Sqrt:  [[12.28209996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00677725 0.04766945 0.12686242]
Stock Position:  0.0067772493720539
Bond Position:  [0.52116622]


portfolio before change:  [1.19644763]
curr_Stock_Price:  99.62983892591886
curr_Factors:  [99.62983893 -0.90303649 -1.03391875]
mat_Sqrt:  [[14.36086027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00552513 -0.04436695 -0.1071164 ]
Stock Position:  -0.005525126286734613
Bond Position:  [1.74691507]


portfolio before change:  [1.19868973]
curr_Stock_Price:  99.26356247934848
curr_Factors:  [99.26356248 -1.03931954 -1.04451722]
mat_Sqrt:  [[12.35352932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00869142 -0.00151053 -0.02504402]
Stock Position:  0.008691423452614252
Bond Position:  [0.33594808]


portfolio before change:  [1.19804557]
curr_Stock_Price:  99.18461549349571
curr_Factors:  [99.18461549 -0.99700277 -1.058364  ]
mat_Sqrt:  [[12.70017982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00184647 -0.01952801  0.07433576]
Stock Position:  0.001846469197436847
Bond Position:  [1.01490423]


portfolio before change:  [1.19892965]
curr_Stock_Price:  99.5947042970218
curr_Factors:  [99.5947043  -1.17927753 -1.08344348]
mat_Sqrt:  [[10.36451533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.36635952e-05  1.31227040e-02 -9.86601534e-02]
Stock Position:  4.366359524121315e-05
Bond Position:  [1.19458099]


portfolio before change:  [1.19907318]
curr_Stock_Price:  99.46166318157289
curr_Factors:  [99.46166318 -1.0418371  -1.08220137]
mat_Sqrt:  [[11.89042913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05993794  0.01613485 -2.13964188]
Stock Position:  -0.05993793816777785
Bond Position:  [7.16060019]


portfolio before change:  [1.1901691]
curr_Stock_Price:  99.62515240767935
curr_Factors:  [99.62515241 -1.11941569 -1.07385807]
mat_Sqrt:  [[11.1132813   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00661625 -0.03696249 -0.00524694]
Stock Position:  -0.006616246994331872
Bond Position:  [1.84931372]


portfolio before change:  [1.19468607]
curr_Stock_Price:  98.9773849029946
curr_Factors:  [98.9773849  -1.20697785 -1.04414077]
mat_Sqrt:  [[10.42047649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345849  0.02749949  0.56904702]
Stock Position:  -0.003458489066691445
Bond Position:  [1.53699827]


portfolio before change:  [1.19471771]
curr_Stock_Price:  99.02379017967031
curr_Factors:  [99.02379018 -1.12508598 -1.03810623]
mat_Sqrt:  [[11.3835339   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00167825  0.02440073 -0.00464557]
Stock Position:  0.0016782462674961645
Bond Position:  [1.02853141]


portfolio before change:  [1.19450326]
curr_Stock_Price:  98.81939056345216
curr_Factors:  [98.81939056 -1.28929878 -1.03672674]
mat_Sqrt:  [[ 9.65299599  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01488778 -0.00071607 -0.43474908]
Stock Position:  -0.01488778351973698
Bond Position:  [2.66570495]


portfolio before change:  [1.19132887]
curr_Stock_Price:  99.05499446488365
curr_Factors:  [99.05499446 -1.1740219  -1.04476508]
mat_Sqrt:  [[10.77133256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418175  0.0167901   0.23445673]
Stock Position:  -0.004181752713861202
Bond Position:  [1.60555236]


portfolio before change:  [1.19011002]
curr_Stock_Price:  99.39445867942473
curr_Factors:  [99.39445868 -1.05502318 -1.06506793]
mat_Sqrt:  [[11.92939183  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00668828 -0.02330989 -0.00456912]
Stock Position:  0.006688283529147059
Bond Position:  [0.5253317]


portfolio before change:  [1.18820579]
curr_Stock_Price:  99.09992805066864
curr_Factors:  [99.09992805 -1.25271763 -1.07656843]
mat_Sqrt:  [[ 9.64888781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00046149 0.00224751 0.14685235]
Stock Position:  0.0004614921694135569
Bond Position:  [1.14247195]


portfolio before change:  [1.18850831]
curr_Stock_Price:  99.4460006961347
curr_Factors:  [99.4460007  -1.38740981 -1.06124652]
mat_Sqrt:  [[ 8.59309065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034957 -0.00184084 -0.09420224]
Stock Position:  -0.00034957025505592587
Bond Position:  [1.22327168]


portfolio before change:  [1.18853801]
curr_Stock_Price:  99.7985084239268
curr_Factors:  [99.79850842 -1.12136719 -1.04611628]
mat_Sqrt:  [[11.42346722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00874771 -0.00697607  0.00704287]
Stock Position:  -0.008747708035222006
Bond Position:  [2.06154622]


portfolio before change:  [1.1844091]
curr_Stock_Price:  100.29996769568231
curr_Factors:  [100.2999677   -1.12925517  -1.03295287]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.1844091]
Stock Price:  99.89258597310106
PL:  [1.1844091]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.72908432e-02  1.28313608e-02  3.18857533e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 1.31803412e-01  3.74698546e-02  7.62936237e-02]
 [-6.29515894e-02 -1.67172906e-02  4.90119760e-02]
 [-1.20274918e+00 -3.53841722e-01  2.32614902e-02]
 [ 7.03959099e-03 -8.15041389e-02 -1.05057278e-01]
 [ 2.76298452e-02 -1.46925917e-02 -2.93088227e-02]
 [ 3.83970492e-01  6.50636217e-02 -1.10993588e-01]
 [-2.93973971e-01  9.78652441e-03 -1.25300192e-01]
 [ 3.44622492e-02  4.68422099e-03 -3.11073818e-02]
 [ 1.69117431e-02 -1.58266278e-01  6.35340843e-03]
 [-2.00386230e-02 -8.43908025e-04  1.86501232e-02]
 [ 2.35232964e-01 -2.04495239e-01  1.12246626e-01]
 [ 8.65635517e-02 -5.40235529e-02 -6.25293771e-02]
 [ 6.44284500e-02 -6.79789756e-02 -4.11374373e-02]
 [-4.84612268e-02  4.39943740e-02  3.88407801e-02]
 [-3.46780469e-01 -3.01481929e-01  8.55669688e-02]
 [-1.83033771e-01 -6.88069849e-03 -4.79815534e-02]
 [ 3.55368843e-01  1.40553862e+00  5.62005398e-01]
 [-1.53970970e-01 -1.47860665e-02  1.40234330e-01]
 [-9.07712897e-02  1.21311724e-01 -3.83106628e-02]
 [ 3.29340369e-02  2.35505479e-02  1.30423012e-02]
 [ 2.31335554e-02 -2.96647527e-02  2.83585077e-02]
 [ 3.70762462e-02  1.08601892e-01  9.46280891e-02]
 [-5.96051703e-02 -1.67599785e-01 -4.73145555e-02]
 [ 5.99174399e-02  3.41422504e-02 -1.44666130e-02]
 [-5.44052094e-03 -2.25468665e-02 -3.67043259e-02]
 [ 4.21548831e-03  4.16890997e-02 -1.75886367e-02]
 [-5.04047260e-01  8.86329865e-02 -6.33086424e-01]
 [-4.39335751e-02 -1.24260053e-01 -1.51791650e-02]
 [-9.02798921e-02  9.22946337e-02  2.11615573e-01]
 [ 1.33566425e-02  4.20192874e-02  1.54957488e-02]
 [-1.11726595e-01 -1.79807820e-03 -1.52938670e-01]
 [-6.45374334e-02  2.08399573e-02  6.17306602e-02]
 [ 1.49907365e-01 -1.26197966e-01 -4.49405556e-02]
 [ 1.01454025e-02  2.79055523e-02  6.53971443e-02]
 [-7.79816760e-03 -1.61364356e-02 -3.96617692e-02]
 [-9.98635088e-02 -2.20602861e-02  2.46882558e-03]
 [-2.39928934e-02 -3.22922797e-01  1.35404901e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.85924124]
curr_Stock_Price:  100.34435165305192
curr_Factors:  [100.34435165  -0.91920914  -1.00604934]
mat_Sqrt:  [[14.63402517  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00618086  0.00405763  0.09096118]
Stock Position:  -0.006180861769244133
Bond Position:  [5.47945581]


portfolio before change:  [4.86402265]
curr_Stock_Price:  99.68159109153896
curr_Factors:  [99.68159109 -1.12229411 -1.03012978]
mat_Sqrt:  [[11.58321571  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391783  0.01411938  0.0859571 ]
Stock Position:  -0.003917827653473531
Bond Position:  [5.25455794]


portfolio before change:  [4.86512046]
curr_Stock_Price:  99.56904138164398
curr_Factors:  [99.56904138 -1.5114171  -1.03866144]
mat_Sqrt:  [[ 7.773906    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01908233 0.01184901 0.21764447]
Stock Position:  0.019082331302397473
Bond Position:  [2.96511103]


portfolio before change:  [4.86418825]
curr_Stock_Price:  99.5007648444131
curr_Factors:  [99.50076484 -1.56947128 -1.02010331]
mat_Sqrt:  [[ 7.46772758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00714792 -0.00528647  0.13981753]
Stock Position:  -0.007147917460423044
Bond Position:  [5.5754115]


portfolio before change:  [4.86405288]
curr_Stock_Price:  99.61720973291499
curr_Factors:  [99.61720973 -1.78323804 -1.03494526]
mat_Sqrt:  [[ 5.94857465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.2029288  -0.11189458  0.06635856]
Stock Position:  -0.20292879714234216
Bond Position:  [25.07925342]


portfolio before change:  [4.94094714]
curr_Stock_Price:  99.25373665181435
curr_Factors:  [99.25373665 -1.71850051 -1.00795534]
mat_Sqrt:  [[ 6.49624109  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0025414  -0.02577387 -0.29969917]
Stock Position:  -0.002541402590246412
Bond Position:  [5.19319084]


portfolio before change:  [4.94057388]
curr_Stock_Price:  99.65605246111637
curr_Factors:  [99.65605246 -1.83188051 -1.01505237]
mat_Sqrt:  [[ 5.78224432  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00367813 -0.00464621 -0.08360991]
Stock Position:  0.003678129899380698
Bond Position:  [4.57402597]


portfolio before change:  [4.94158596]
curr_Stock_Price:  99.77575717688998
curr_Factors:  [99.77575718 -1.60451973 -1.06882519]
mat_Sqrt:  [[ 6.88661945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05271004  0.02057492 -0.31663381]
Stock Position:  0.05271003554711748
Bond Position:  [-0.31759775]


portfolio before change:  [4.91802359]
curr_Stock_Price:  99.3294917242023
curr_Factors:  [99.32949172 -1.47812504 -1.04879064]
mat_Sqrt:  [[ 7.93693228  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04022941  0.00309477 -0.35744657]
Stock Position:  -0.040229406961328804
Bond Position:  [8.91399013]


portfolio before change:  [4.91170456]
curr_Stock_Price:  99.51426567551458
curr_Factors:  [99.51426568 -1.6326014  -1.08958188]
mat_Sqrt:  [[ 6.54118094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00431626  0.00148128 -0.0887407 ]
Stock Position:  0.004316258452003362
Bond Position:  [4.48217527]


portfolio before change:  [4.91084763]
curr_Stock_Price:  99.18591733762179
curr_Factors:  [99.18591734 -1.70762102 -1.11700231]
mat_Sqrt:  [[ 5.88479971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239978 -0.05004819  0.01812451]
Stock Position:  0.0023997774194228507
Bond Position:  [4.67282351]


portfolio before change:  [4.91136933]
curr_Stock_Price:  99.15989805665572
curr_Factors:  [99.15989806 -1.72814189 -1.12681332]
mat_Sqrt:  [[ 5.70748496  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284775 -0.00026687  0.05320361]
Stock Position:  -0.0028477468198958083
Bond Position:  [5.19375161]


portfolio before change:  [4.91116585]
curr_Stock_Price:  99.4593433399336
curr_Factors:  [99.45934334 -1.7318508  -1.11052405]
mat_Sqrt:  [[ 5.79719456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04361854 -0.06466707  0.32020838]
Stock Position:  0.04361854047365992
Bond Position:  [0.57289445]


portfolio before change:  [4.90505345]
curr_Stock_Price:  99.31756839881835
curr_Factors:  [99.3175684  -1.44867805 -1.11731177]
mat_Sqrt:  [[ 7.6318681   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00948718 -0.01708375 -0.17837891]
Stock Position:  0.009487180982706208
Bond Position:  [3.9628097]


portfolio before change:  [4.90013427]
curr_Stock_Price:  98.74684508142855
curr_Factors:  [98.74684508 -1.61628484 -1.10199219]
mat_Sqrt:  [[ 6.51614158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00832948 -0.02149684 -0.11735366]
Stock Position:  0.00832948386660337
Bond Position:  [4.07762402]


portfolio before change:  [4.89702039]
curr_Stock_Price:  98.31180991991879
curr_Factors:  [98.31180992 -1.73291761 -1.09760763]
mat_Sqrt:  [[ 5.798614    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0067942   0.01391224  0.11080193]
Stock Position:  -0.006794202196786853
Bond Position:  [5.5649707]


portfolio before change:  [4.89676193]
curr_Stock_Price:  98.45224144278922
curr_Factors:  [98.45224144 -1.587346   -1.10539654]
mat_Sqrt:  [[ 6.6647273   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05057948 -0.09533696  0.24409874]
Stock Position:  -0.050579476000251075
Bond Position:  [9.87642472]


portfolio before change:  [4.93275032]
curr_Stock_Price:  97.76512956307722
curr_Factors:  [97.76512956 -1.36612989 -1.11354338]
mat_Sqrt:  [[ 8.18984273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02356646 -0.00217587 -0.13687802]
Stock Position:  -0.023566462687236254
Bond Position:  [7.2367286]


portfolio before change:  [4.92365717]
curr_Stock_Price:  98.18936807562446
curr_Factors:  [98.18936808 -1.16958759 -1.1065474 ]
mat_Sqrt:  [[10.08211383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05022544 0.44447034 1.60324497]
Stock Position:  0.05022543624877766
Bond Position:  [-0.00794668]


portfolio before change:  [4.9443293]
curr_Stock_Price:  98.60097470782749
curr_Factors:  [98.60097471 -1.21524256 -1.08406803]
mat_Sqrt:  [[ 9.89243729  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01270946 -0.00467576  0.40004951]
Stock Position:  -0.012709459534160472
Bond Position:  [6.1974944]


portfolio before change:  [4.93588147]
curr_Stock_Price:  99.3266203474213
curr_Factors:  [99.32662035 -1.43465786 -1.10649265]
mat_Sqrt:  [[ 7.82452557  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01219999  0.03836214 -0.10928966]
Stock Position:  -0.012199994098839564
Bond Position:  [6.14766565]


portfolio before change:  [4.92252353]
curr_Stock_Price:  100.48452636871252
curr_Factors:  [100.48452637  -1.74522038  -1.10281287]
mat_Sqrt:  [[ 5.8239021   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00621651 0.00744734 0.03720606]
Stock Position:  0.00621651212372518
Bond Position:  [4.29786025]


portfolio before change:  [4.92084885]
curr_Stock_Price:  100.12870866119292
curr_Factors:  [100.12870866  -1.53601253  -1.08699077]
mat_Sqrt:  [[ 7.26779647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00387411 -0.00938082  0.08089893]
Stock Position:  0.0038741138398758726
Bond Position:  [4.53293883]


portfolio before change:  [4.92133378]
curr_Stock_Price:  100.10761458094679
curr_Factors:  [100.10761458  -1.46128358  -1.10575261]
mat_Sqrt:  [[ 7.68453262  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00770329 0.03434293 0.2699476 ]
Stock Position:  0.007703293835642359
Bond Position:  [4.15017541]


portfolio before change:  [4.92228833]
curr_Stock_Price:  100.1641800901365
curr_Factors:  [100.16418009  -1.21102259  -1.10710795]
mat_Sqrt:  [[ 9.86191239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0074621  -0.05299971 -0.13497526]
Stock Position:  -0.007462104549253972
Bond Position:  [5.66972391]


portfolio before change:  [4.92097174]
curr_Stock_Price:  100.43559804345503
curr_Factors:  [100.43559804  -1.07398506  -1.11089156]
mat_Sqrt:  [[11.29816235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00511995  0.01079673 -0.04126922]
Stock Position:  0.005119948021732766
Bond Position:  [4.4067467]


portfolio before change:  [4.91858775]
curr_Stock_Price:  99.86237707506262
curr_Factors:  [99.86237708 -1.26523279 -1.11843143]
mat_Sqrt:  [[ 9.20851678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146765 -0.00712995 -0.10470723]
Stock Position:  -0.0014676541303114746
Bond Position:  [5.06515118]


portfolio before change:  [4.92025848]
curr_Stock_Price:  99.15543952066942
curr_Factors:  [99.15543952 -1.34376071 -1.10819867]
mat_Sqrt:  [[ 8.53972951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00019926  0.01318325 -0.05017548]
Stock Position:  0.00019926050420972357
Bond Position:  [4.90050071]


portfolio before change:  [4.92089042]
curr_Stock_Price:  99.25252166578203
curr_Factors:  [99.25252167 -1.40722511 -1.11468535]
mat_Sqrt:  [[ 7.97057681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07916453  0.02802821 -1.80601935]
Stock Position:  -0.07916453299104582
Bond Position:  [12.77816995]


portfolio before change:  [4.93156408]
curr_Stock_Price:  99.13787077484382
curr_Factors:  [99.13787077 -1.31766905 -1.09758725]
mat_Sqrt:  [[ 8.8574173   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00567213 -0.03929448 -0.04330193]
Stock Position:  -0.005672126341465011
Bond Position:  [5.49388661]


portfolio before change:  [4.93102099]
curr_Stock_Price:  99.35469719922376
curr_Factors:  [99.3546972  -1.35772167 -1.11686992]
mat_Sqrt:  [[ 8.36540429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00534356  0.02918613  0.60368033]
Stock Position:  -0.005343556077640512
Bond Position:  [5.46192839]


portfolio before change:  [4.93281125]
curr_Stock_Price:  99.14744320968394
curr_Factors:  [99.14744321 -1.59961956 -1.11882854]
mat_Sqrt:  [[ 6.54145728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00269124 0.01328767 0.04420506]
Stock Position:  0.0026912401309075224
Bond Position:  [4.66598167]


portfolio before change:  [4.93480634]
curr_Stock_Price:  99.67203797901422
curr_Factors:  [99.67203798 -1.46822777 -1.14633063]
mat_Sqrt:  [[ 7.29600387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0195986  -0.0005686  -0.43629146]
Stock Position:  -0.019598604860402383
Bond Position:  [6.88823923]


portfolio before change:  [4.93669563]
curr_Stock_Price:  99.61957502695886
curr_Factors:  [99.61957503 -1.44624232 -1.13368398]
mat_Sqrt:  [[ 7.54913038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00680855  0.00659017  0.17610039]
Stock Position:  -0.006808549755050547
Bond Position:  [5.61496046]


portfolio before change:  [4.9371876]
curr_Stock_Price:  99.65040915580748
curr_Factors:  [99.65040916 -1.56389813 -1.14361176]
mat_Sqrt:  [[ 6.6469511   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02068249 -0.0399073  -0.1282029 ]
Stock Position:  0.02068248938119536
Bond Position:  [2.87616908]


portfolio before change:  [4.94113708]
curr_Stock_Price:  99.82398262195144
curr_Factors:  [99.82398262 -1.26452258 -1.13346691]
mat_Sqrt:  [[ 9.07405256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0026686  0.00882451 0.18655985]
Stock Position:  0.0026686044422260715
Bond Position:  [4.67474636]


portfolio before change:  [4.94239471]
curr_Stock_Price:  100.07626909155195
curr_Factors:  [100.07626909  -1.09806288  -1.11242133]
mat_Sqrt:  [[10.9731171   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148643 -0.00510279 -0.11314399]
Stock Position:  -0.001486426615805221
Bond Position:  [5.09115074]


portfolio before change:  [4.9437712]
curr_Stock_Price:  99.57839679536204
curr_Factors:  [99.5783968  -1.12466577 -1.11603876]
mat_Sqrt:  [[10.59350109  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00943306 -0.00697607  0.00704287]
Stock Position:  -0.009433062326444693
Bond Position:  [5.88310042]


portfolio before change:  [4.93842575]
curr_Stock_Price:  100.22303121753036
curr_Factors:  [100.22303122  -1.35329722  -1.11168161]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.93842575]
Stock Price:  100.46166369495117
PL:  [4.47676206]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-7.48269340e-02 -2.25139082e-02 -2.21821038e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 1.94236208e-01  3.03679282e-02  2.97527095e-02]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-9.43585803e-01 -2.80430666e-01  2.95947772e-02]
 [-5.46662063e-02  4.89600820e-04  3.24805269e-02]
 [ 2.55565662e-02  9.00849435e-02  1.66388086e-02]
 [ 3.06921640e-01 -6.13722972e-02 -6.93217603e-02]
 [-4.94131875e-01 -2.84476099e-02 -5.33621886e-02]
 [ 4.06673004e-02 -5.85749383e-03 -3.60471666e-02]
 [ 4.38481598e-02 -3.50532041e-01  1.33860870e-01]
 [-2.22562011e-01  3.56585810e-02  1.89635813e-01]
 [ 3.51304109e-02  4.41424116e-02  1.92008243e-01]
 [ 2.10977490e-03  5.98076253e-01  5.54960447e-01]
 [ 8.43094294e-02 -1.19905099e-01 -5.09555441e-02]
 [-1.17827126e-02 -1.76732997e-02  3.46228295e-02]
 [-5.67640023e-01 -1.94359930e-01  1.67305829e-01]
 [-1.15368414e-01  1.91455264e-02 -3.02985551e-02]
 [ 6.74708832e-02  6.55067109e-01  1.28884599e-01]
 [-1.00075914e-02  3.10802714e-02  2.76268736e-02]
 [ 7.31032420e-02 -1.50187826e-01  1.26021442e-01]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 2.00721190e-01 -1.43232014e-02  1.95051509e-01]
 [ 7.18240123e-02 -1.81490482e-01 -7.18461110e-02]
 [-1.02309943e-01  1.08950927e-01  1.51085968e-01]
 [ 1.33704087e-02  6.18313901e-02  1.93390015e-02]
 [-3.11214558e-02 -7.01905597e-02  2.80308724e-01]
 [ 1.06421492e-01  7.68339116e-02 -9.12708618e-02]
 [-9.68408692e-01 -2.09539697e-01 -1.41145855e+00]
 [-3.90440030e-02 -3.87500924e-02  5.92070026e-02]
 [-2.44094812e-02 -1.35380408e-01  1.21880046e-01]
 [ 4.05149768e-02  1.70134047e-01 -3.38585643e-02]
 [-1.10984899e-01 -5.51043015e-03 -2.97133282e-02]
 [-5.73240783e-02  1.42010982e-01  1.07856216e-01]
 [ 1.85309732e-01 -1.66755431e-01 -9.16466775e-02]
 [-2.28990341e-02  2.36600381e-01  8.29300908e-02]
 [ 1.33693473e-01  1.01990946e-01 -1.68500181e-02]
 [ 3.69274242e-02  3.24175759e-02 -1.34516242e-02]
 [-1.61811502e-01 -3.44683529e-01  7.16273532e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.98717745]
curr_Stock_Price:  100.22284703491245
curr_Factors:  [100.22284703  -1.15586781  -1.02027737]
mat_Sqrt:  [[11.37310088  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00702853 -0.00711952 -0.06327937]
Stock Position:  -0.007028526731524214
Bond Position:  [4.69159641]


portfolio before change:  [3.98983152]
curr_Stock_Price:  99.92867702450488
curr_Factors:  [99.92867702 -1.30550088 -1.01664111]
mat_Sqrt:  [[ 9.79933687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00463103  0.01411938  0.0859571 ]
Stock Position:  -0.0046310320226285685
Bond Position:  [4.45260442]


portfolio before change:  [3.98977956]
curr_Stock_Price:  100.06008928371854
curr_Factors:  [100.06008928  -1.32299279  -1.00332943]
mat_Sqrt:  [[ 9.77129178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02058004 0.00960318 0.0848762 ]
Stock Position:  0.020580037504965523
Bond Position:  [1.93053917]


portfolio before change:  [4.00814532]
curr_Stock_Price:  100.9407693114037
curr_Factors:  [100.94076931  -1.34162598  -0.99800275]
mat_Sqrt:  [[ 9.72699652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202561 -0.00659539  0.21422481]
Stock Position:  0.002025605115426165
Bond Position:  [3.80367918]


portfolio before change:  [4.0074435]
curr_Stock_Price:  100.35955845130916
curr_Factors:  [100.35955845  -1.2315175   -0.99072515]
mat_Sqrt:  [[10.87554485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08687247 -0.08867996  0.08442566]
Stock Position:  -0.08687247361641764
Bond Position:  [12.7259266]


portfolio before change:  [3.96773954]
curr_Stock_Price:  100.83490819798386
curr_Factors:  [100.8349082   -1.34658223  -0.9904462 ]
mat_Sqrt:  [[ 9.74209489  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00492948  0.00015483  0.0926579 ]
Stock Position:  -0.004929484425848991
Bond Position:  [4.46480364]


portfolio before change:  [3.96711462]
curr_Stock_Price:  101.07490226720938
curr_Factors:  [101.07490227  -0.89672011  -0.96182313]
mat_Sqrt:  [[15.75753405  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00198501 0.02848736 0.04746589]
Stock Position:  0.0019850144006883634
Bond Position:  [3.76647949]


portfolio before change:  [3.96748657]
curr_Stock_Price:  101.0250837924148
curr_Factors:  [101.02508379  -0.96252059  -0.93926051]
mat_Sqrt:  [[15.08329349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01930525 -0.01940762 -0.19775569]
Stock Position:  0.019305251180330992
Bond Position:  [2.01717195]


portfolio before change:  [3.97309273]
curr_Stock_Price:  101.30241727361411
curr_Factors:  [101.30241727  -1.02062679  -0.96358381]
mat_Sqrt:  [[13.92797871  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03631244 -0.00899592 -0.15222747]
Stock Position:  -0.036312440642808225
Bond Position:  [7.65163074]


portfolio before change:  [3.97786203]
curr_Stock_Price:  101.19741784035986
curr_Factors:  [101.19741784  -0.88415532  -0.96859125]
mat_Sqrt:  [[15.86835165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00208957 -0.0018523  -0.10283253]
Stock Position:  0.002089565708949827
Bond Position:  [3.76640337]


portfolio before change:  [3.97697298]
curr_Stock_Price:  100.546621757844
curr_Factors:  [100.54662176  -0.46436396  -0.96803845]
mat_Sqrt:  [[24.00396694  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00258798 -0.11084796  0.3818678 ]
Stock Position:  0.0025879762828300585
Bond Position:  [3.7167607]


portfolio before change:  [3.98742861]
curr_Stock_Price:  104.40717079320528
curr_Factors:  [104.40717079  -0.69200042  -0.95889321]
mat_Sqrt:  [[20.03347717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00913132  0.01127623  0.54097819]
Stock Position:  -0.009131318592210568
Bond Position:  [4.94080375]


portfolio before change:  [3.98340615]
curr_Stock_Price:  104.91532307151132
curr_Factors:  [104.91532307  -0.68832542  -0.92282506]
mat_Sqrt:  [[20.94716052  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00360257 0.01395906 0.54774607]
Stock Position:  0.0036025733136750234
Bond Position:  [3.605441]


portfolio before change:  [3.98138307]
curr_Stock_Price:  104.22865106781572
curr_Factors:  [104.22865107  -0.75185284  -0.90790471]
mat_Sqrt:  [[19.82273484  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00660014 0.18912832 1.58314769]
Stock Position:  0.006600141978792908
Bond Position:  [3.29345917]


portfolio before change:  [3.99001132]
curr_Stock_Price:  105.47355430907949
curr_Factors:  [105.47355431  -0.89410762  -0.91119404]
mat_Sqrt:  [[17.34247323  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00408317 -0.03791732 -0.14536198]
Stock Position:  0.004083168256875565
Bond Position:  [3.55934505]


portfolio before change:  [3.99043238]
curr_Stock_Price:  105.46770451626749
curr_Factors:  [105.46770452  -0.74503079  -0.87915446]
mat_Sqrt:  [[20.78474988  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024882 -0.00558879  0.0987693 ]
Stock Position:  -0.00024882087874728226
Bond Position:  [4.01667494]


portfolio before change:  [3.99062227]
curr_Stock_Price:  106.72252672505026
curr_Factors:  [106.72252673  -0.88735706  -0.88337281]
mat_Sqrt:  [[18.1651039   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02964515 -0.06146201  0.47727696]
Stock Position:  -0.02964514921566659
Bond Position:  [7.1544275]


portfolio before change:  [4.00127552]
curr_Stock_Price:  106.39333656240149
curr_Factors:  [106.39333656  -1.02071079  -0.87731427]
mat_Sqrt:  [[15.94456293  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00759248  0.00605435 -0.08643334]
Stock Position:  -0.007592478114192583
Bond Position:  [4.8090646]


portfolio before change:  [4.00879448]
curr_Stock_Price:  105.48219838429614
curr_Factors:  [105.48219838  -0.9921439   -0.88916865]
mat_Sqrt:  [[16.07442741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00688629 0.20715041 0.36767189]
Stock Position:  0.006886285840087389
Bond Position:  [3.28241391]


portfolio before change:  [4.00067583]
curr_Stock_Price:  104.24365308026623
curr_Factors:  [104.24365308  -0.93319062  -0.86370796]
mat_Sqrt:  [[17.28488449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0002063   0.00982844  0.07881178]
Stock Position:  -0.0002062952921020947
Bond Position:  [4.02218081]


portfolio before change:  [4.00094949]
curr_Stock_Price:  105.35442506352663
curr_Factors:  [105.35442506  -1.00986801  -0.86438876]
mat_Sqrt:  [[16.16863689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00587244 -0.04749356  0.3595041 ]
Stock Position:  0.0058724448332335465
Bond Position:  [3.38226144]


portfolio before change:  [3.99624624]
curr_Stock_Price:  104.48152452795745
curr_Factors:  [104.48152453  -0.91166354  -0.85766321]
mat_Sqrt:  [[17.80863596  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218259  0.01916992 -0.08961985]
Stock Position:  -0.002182585110955105
Bond Position:  [4.22428606]


portfolio before change:  [3.99622963]
curr_Stock_Price:  104.7310806558924
curr_Factors:  [104.73108066  -1.00777044  -0.86455582]
mat_Sqrt:  [[16.10403184  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01491341 -0.00452939  0.55642766]
Stock Position:  0.01491341368363398
Bond Position:  [2.4343317]


portfolio before change:  [4.0036025]
curr_Stock_Price:  105.20505353502502
curr_Factors:  [105.20505354  -1.0113547   -0.85733892]
mat_Sqrt:  [[16.23578434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0032319  -0.05739233 -0.20495696]
Stock Position:  0.0032318994328005223
Bond Position:  [3.66359034]


portfolio before change:  [4.00077554]
curr_Stock_Price:  104.18864462938292
curr_Factors:  [104.18864463  -0.66416967  -0.83683819]
mat_Sqrt:  [[23.22421045  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295625  0.03445331  0.43100621]
Stock Position:  -0.0029562489751623266
Bond Position:  [4.30878312]


portfolio before change:  [3.99888798]
curr_Stock_Price:  105.00934486770598
curr_Factors:  [105.00934487  -0.49362391  -0.84014189]
mat_Sqrt:  [[27.66819457  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00068362 0.0195528  0.05516879]
Stock Position:  0.0006836169029423206
Bond Position:  [3.92710182]


portfolio before change:  [4.0007522]
curr_Stock_Price:  107.01822957572053
curr_Factors:  [107.01822958  -0.29449222  -0.80056176]
mat_Sqrt:  [[35.79990388  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.78326133e-04 -2.21962039e-02  7.99642766e-01]
Stock Position:  0.0006783261331839719
Bond Position:  [3.92815894]


portfolio before change:  [4.00178098]
curr_Stock_Price:  107.81094583679777
curr_Factors:  [107.81094584  -0.29030121  -0.82948298]
mat_Sqrt:  [[35.18412556  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00255157  0.02429702 -0.26037036]
Stock Position:  0.0025515696978799874
Bond Position:  [3.72669383]


portfolio before change:  [4.00173234]
curr_Stock_Price:  107.60930614168423
curr_Factors:  [107.60930614  -0.1254016   -0.83165323]
mat_Sqrt:  [[41.32436614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03053723 -0.06626227 -4.02649837]
Stock Position:  -0.030537231960581817
Bond Position:  [7.28782269]


portfolio before change:  [4.10405875]
curr_Stock_Price:  104.28826616869037
curr_Factors:  [104.28826617  -0.24657831  -0.82067644]
mat_Sqrt:  [[35.87010085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00077945 -0.01225386  0.1689011 ]
Stock Position:  -0.0007794499198506387
Bond Position:  [4.18534623]


portfolio before change:  [4.10311592]
curr_Stock_Price:  106.16911845767649
curr_Factors:  [106.16911846  -0.41003802  -0.82557157]
mat_Sqrt:  [[30.8588532   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.80700122e-05 -4.28110439e-02  3.47689846e-01]
Stock Position:  -9.80700122410908e-05
Bond Position:  [4.11352792]


portfolio before change:  [4.10360915]
curr_Stock_Price:  106.38310944847106
curr_Factors:  [106.38310945  -0.53958772  -0.81215775]
mat_Sqrt:  [[27.53068906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138015  0.05380111 -0.09658906]
Stock Position:  0.0013801495659249384
Bond Position:  [3.95678455]


portfolio before change:  [4.10272151]
curr_Stock_Price:  105.38156839359613
curr_Factors:  [105.38156839  -0.56627619  -0.81242967]
mat_Sqrt:  [[26.54607474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00441468 -0.00174255 -0.08476385]
Stock Position:  -0.0044146785048394055
Bond Position:  [4.56794725]


portfolio before change:  [4.10327245]
curr_Stock_Price:  105.38611844491089
curr_Factors:  [105.38611844  -0.57060892  -0.83343968]
mat_Sqrt:  [[25.882895    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00122248  0.04490782  0.30768376]
Stock Position:  -0.0012224796590766633
Bond Position:  [4.23210484]


portfolio before change:  [4.10518839]
curr_Stock_Price:  104.25162572845574
curr_Factors:  [104.25162573  -0.52795739  -0.85045451]
mat_Sqrt:  [[26.26915811  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00617823 -0.0527327  -0.26144246]
Stock Position:  0.006178227137105045
Bond Position:  [3.46109817]


portfolio before change:  [4.11320946]
curr_Stock_Price:  105.4798762658756
curr_Factors:  [105.47987627  -0.42362596  -0.85790541]
mat_Sqrt:  [[29.28246346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.71256119e-06 7.48196100e-02 2.36576466e-01]
Stock Position:  4.712561193443876e-06
Bond Position:  [4.11271238]


portfolio before change:  [4.11372438]
curr_Stock_Price:  105.6478942752049
curr_Factors:  [105.64789428  -0.30926291  -0.84903498]
mat_Sqrt:  [[33.17557541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00400558  0.03225237 -0.04806841]
Stock Position:  0.004005578513505927
Bond Position:  [3.69054344]


portfolio before change:  [4.12530276]
curr_Stock_Price:  108.4232816045396
curr_Factors:  [108.4232816   -0.20375111  -0.84258964]
mat_Sqrt:  [[38.08049056  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009196   0.01025134 -0.03837374]
Stock Position:  0.0009195953261195089
Bond Position:  [4.02559721]


portfolio before change:  [4.1260143]
curr_Stock_Price:  108.64981066473479
curr_Factors:  [108.64981066  -0.22206637  -0.85909988]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.1260143]
Stock Price:  107.68731048293179
PL:  [-3.56129618]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.24808729e-01  2.04376734e-02  6.55585839e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.55427239e-01  2.78117480e-01  3.89197853e-01]
 [ 5.46187642e-04 -1.05816696e-02  8.48686712e-02]
 [-8.50432926e-01 -2.54044024e-01  3.18711942e-02]
 [-6.69464684e-02  2.40450270e-02  6.82026241e-02]
 [ 1.31715460e-02  1.33132241e-01  5.68301732e-02]
 [ 3.10301513e-01 -4.36840333e-02 -7.23647565e-02]
 [-2.80971986e-01  3.67914926e-03 -9.38002667e-02]
 [ 1.05048286e-01 -2.12997084e-02  5.62738466e-02]
 [ 6.93098870e-02 -3.05271596e-01  3.17841900e-02]
 [ 1.09274506e-02 -3.89329002e-03  3.29734354e-03]
 [ 2.25959113e-01 -2.27455166e-01  8.17453952e-02]
 [ 9.50788664e-02  2.86542167e-02  7.29783831e-04]
 [ 1.73927993e-02 -9.42159241e-02 -4.67277250e-02]
 [-4.36012262e-02 -1.39273039e-02  2.25712603e-02]
 [-4.51252934e-01 -2.50333715e-01  1.19680095e-01]
 [-2.02475682e-01 -7.76967877e-02 -3.15992482e-02]
 [ 2.56198835e-01  1.14954747e+00  3.37314337e-01]
 [-2.27984039e-01 -4.23706235e-02  1.58251498e-01]
 [-8.00859674e-02  2.77209874e-01 -2.04362161e-02]
 [-2.94127178e-02  2.55241439e-02 -5.06219715e-03]
 [ 2.24739907e-02 -3.32807747e-02  1.80181711e-02]
 [-7.25725782e-03 -1.09235069e-01  1.06206566e-01]
 [-1.18845634e-01  1.18858579e-01  9.10328439e-02]
 [ 8.10591147e-02 -1.59531608e-01 -1.96597692e-01]
 [ 6.51343128e-02 -3.09217756e-02  1.06702356e-01]
 [-1.05911324e-01  4.46238205e-02  1.04232169e-01]
 [-5.31610749e-01 -2.39427658e-01 -9.13852129e-01]
 [ 3.42736056e-01 -2.61808450e-01 -1.94335049e-01]
 [ 1.62589537e-01 -7.03821554e-03 -3.40661855e-02]
 [ 6.72203865e-02  4.06787590e-01 -1.59577238e-01]
 [-4.35308194e-02  5.45922529e-02  2.74866389e-02]
 [ 8.45353333e-02  1.14372748e-01  9.35734665e-02]
 [-3.85649297e-01  1.15006084e-01 -1.05856116e-01]
 [-3.08171371e-01 -4.59577733e-02 -7.58483178e-02]
 [ 3.60589356e-01  2.55443047e-01  8.12295972e-02]
 [-2.37069582e-02  2.96038981e-01  5.13730597e-02]
 [ 5.81078437e-04 -1.49596154e-01  3.82759574e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.90809164]
curr_Stock_Price:  100.07249804504632
curr_Factors:  [100.07249805  -0.84672743  -0.99091554]
mat_Sqrt:  [[15.93076169  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00696131  0.00646296  0.18702039]
Stock Position:  -0.0069613081163323225
Bond Position:  [3.60472713]


portfolio before change:  [2.91057196]
curr_Stock_Price:  99.78092922574707
curr_Factors:  [99.78092923 -0.65836452 -0.97474791]
mat_Sqrt:  [[19.48928146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00232851  0.01411938  0.0859571 ]
Stock Position:  -0.0023285128770772767
Bond Position:  [3.14291313]


portfolio before change:  [2.9116504]
curr_Stock_Price:  99.48651300966065
curr_Factors:  [99.48651301 -0.92851027 -0.97313539]
mat_Sqrt:  [[14.85559302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02302519 0.08794847 1.11027314]
Stock Position:  0.02302519190981468
Bond Position:  [0.62095434]


portfolio before change:  [2.93445588]
curr_Stock_Price:  100.47359979074726
curr_Factors:  [100.47359979  -1.04813178  -0.98252322]
mat_Sqrt:  [[13.18711211  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133439 -0.00334622  0.2421067 ]
Stock Position:  0.0013343873122535369
Bond Position:  [2.80038519]


portfolio before change:  [2.93596689]
curr_Stock_Price:  101.34361107757341
curr_Factors:  [101.34361108  -0.87870562  -0.9823856 ]
mat_Sqrt:  [[15.75922034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05396756 -0.08033577  0.09091965]
Stock Position:  -0.05396755778362637
Bond Position:  [8.40523407]


portfolio before change:  [2.91576378]
curr_Stock_Price:  101.73743700776619
curr_Factors:  [101.73743701  -0.8295295   -0.97063329]
mat_Sqrt:  [[16.81434794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311661  0.00760371  0.1945631 ]
Stock Position:  -0.0031166136421032775
Bond Position:  [3.23284007]


portfolio before change:  [2.91564502]
curr_Stock_Price:  101.90521237543614
curr_Factors:  [101.90521238  -0.9143889   -0.95615339]
mat_Sqrt:  [[15.69748962  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00179707 0.04210011 0.16212067]
Stock Position:  0.0017970654495428708
Bond Position:  [2.73251468]


portfolio before change:  [2.91341628]
curr_Stock_Price:  100.4749196612823
curr_Factors:  [100.47491966  -1.00250363  -0.93287039]
mat_Sqrt:  [[14.50559045  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02029578 -0.0138141  -0.20643651]
Stock Position:  0.020295775158501197
Bond Position:  [0.8741999]


portfolio before change:  [2.88655648]
curr_Stock_Price:  99.1461170196317
curr_Factors:  [99.14611702 -0.809186   -0.90868995]
mat_Sqrt:  [[17.79146306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01686336  0.00116345 -0.26758605]
Stock Position:  -0.016863362452125847
Bond Position:  [4.55849339]


portfolio before change:  [2.90164243]
curr_Stock_Price:  98.28530990025068
curr_Factors:  [98.2853099  -0.51791166 -0.9290321 ]
mat_Sqrt:  [[23.1253822   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00501549 -0.00673556  0.16053362]
Stock Position:  0.005015492473527108
Bond Position:  [2.4086932]


portfolio before change:  [2.9056211]
curr_Stock_Price:  99.01855045008048
curr_Factors:  [99.01855045 -0.74233677 -0.90737588]
mat_Sqrt:  [[19.02196876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00357038 -0.09653535  0.09067145]
Stock Position:  0.0035703837895550822
Bond Position:  [2.55208687]


portfolio before change:  [2.90760723]
curr_Stock_Price:  99.48547564733387
curr_Factors:  [99.48547565 -0.80470149 -0.90468495]
mat_Sqrt:  [[18.00456301  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063873 -0.00123117  0.0094064 ]
Stock Position:  0.0006387266228368027
Bond Position:  [2.84406321]


portfolio before change:  [2.90723688]
curr_Stock_Price:  98.34902252173694
curr_Factors:  [98.34902252 -0.70941623 -0.89931503]
mat_Sqrt:  [[19.68370925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01202885 -0.07192764  0.23319686]
Stock Position:  0.012028853488188091
Bond Position:  [1.72421089]


portfolio before change:  [2.91853168]
curr_Stock_Price:  99.270079808188
curr_Factors:  [99.27007981 -0.84869913 -0.89615252]
mat_Sqrt:  [[17.33959409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0055346  0.00906126 0.00208187]
Stock Position:  0.005534597931456908
Bond Position:  [2.3691117]


portfolio before change:  [2.92091688]
curr_Stock_Price:  99.64753086651973
curr_Factors:  [99.64753087 -0.92004639 -0.91972733]
mat_Sqrt:  [[15.82934593  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00034252 -0.02979369 -0.13330119]
Stock Position:  0.00034252190115893625
Bond Position:  [2.88678542]


portfolio before change:  [2.92154295]
curr_Stock_Price:  100.42179217834456
curr_Factors:  [100.42179218  -0.86128292  -0.9004136 ]
mat_Sqrt:  [[17.24776753  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00228166 -0.0044042   0.06438952]
Stock Position:  -0.002281656939900769
Bond Position:  [3.15067103]


portfolio before change:  [2.92225582]
curr_Stock_Price:  100.28197506710234
curr_Factors:  [100.28197507  -0.96447066  -0.89502497]
mat_Sqrt:  [[15.61903459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02774095 -0.07916247  0.341414  ]
Stock Position:  -0.027740954382416052
Bond Position:  [5.70417352]


portfolio before change:  [2.94542843]
curr_Stock_Price:  99.4723581980207
curr_Factors:  [99.4723582  -0.887336   -0.89366576]
mat_Sqrt:  [[16.75803829  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01258691 -0.02456988 -0.09014386]
Stock Position:  -0.012586913237841004
Bond Position:  [4.19747838]


portfolio before change:  [2.9373335]
curr_Stock_Price:  100.15716844429011
curr_Factors:  [100.15716844  -0.70018882  -0.88176423]
mat_Sqrt:  [[20.58963068  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01722877 0.36351883 0.96226391]
Stock Position:  0.017228770578901795
Bond Position:  [1.21174863]


portfolio before change:  [2.92281822]
curr_Stock_Price:  99.30587372244432
curr_Factors:  [99.30587372 -0.32268597 -0.87528219]
mat_Sqrt:  [[29.9711894   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00656547 -0.01339877  0.45144748]
Stock Position:  -0.006565474918678243
Bond Position:  [3.57480844]


portfolio before change:  [2.91701015]
curr_Stock_Price:  100.25857659709328
curr_Factors:  [100.2585766   -0.32452419  -0.88632714]
mat_Sqrt:  [[29.87139366  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258106  0.08766146 -0.05829884]
Stock Position:  -0.002581063516177423
Bond Position:  [3.17578391]


portfolio before change:  [2.9211683]
curr_Stock_Price:  98.80136686813808
curr_Factors:  [98.80136687 -0.42470934 -0.87862599]
mat_Sqrt:  [[26.83685468  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110993  0.00807144 -0.01444104]
Stock Position:  -0.0011099290235754157
Bond Position:  [3.03083081]


portfolio before change:  [2.92139504]
curr_Stock_Price:  98.93843766990871
curr_Factors:  [98.93843767 -0.11229825 -0.87751759]
mat_Sqrt:  [[36.76998827  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068786 -0.01052431  0.05140083]
Stock Position:  0.0006878606658774771
Bond Position:  [2.85333918]


portfolio before change:  [2.9199921]
curr_Stock_Price:  96.3803200587415
curr_Factors:  [96.38032006 -0.11351325 -0.86097222]
mat_Sqrt:  [[36.37262944  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00031897 -0.03454316  0.30297777]
Stock Position:  0.00031896592288154977
Bond Position:  [2.88925006]


portfolio before change:  [2.91993749]
curr_Stock_Price:  95.0767780770525
curr_Factors:  [ 9.50767781e+01  8.54001946e-02 -8.83235737e-01]
mat_Sqrt:  [[42.8133176   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0022702   0.03758638  0.25969137]
Stock Position:  -0.0022701982079219836
Bond Position:  [3.13578063]


portfolio before change:  [2.92204578]
curr_Stock_Price:  94.32076895013047
curr_Factors:  [ 9.43207690e+01 -4.71356207e-02 -8.81814185e-01]
mat_Sqrt:  [[37.25371246  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098808 -0.05044832 -0.56083849]
Stock Position:  0.000988081131222524
Bond Position:  [2.82884921]


portfolio before change:  [2.92407608]
curr_Stock_Price:  96.01766159692785
curr_Factors:  [ 9.60176616e+01  5.21199613e-02 -8.73732917e-01]
mat_Sqrt:  [[42.22106191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00203966 -0.00977832  0.30439212]
Stock Position:  0.0020396560236394298
Bond Position:  [2.72823308]


portfolio before change:  [2.92320728]
curr_Stock_Price:  95.42449780557673
curr_Factors:  [95.42449781  0.23972076 -0.85610923]
mat_Sqrt:  [[51.51880392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162043  0.01411129  0.29734537]
Stock Position:  -0.0016204343482663787
Bond Position:  [3.07783641]


portfolio before change:  [2.92636719]
curr_Stock_Price:  93.71189696918542
curr_Factors:  [93.71189697  0.21883352 -0.85304754]
mat_Sqrt:  [[49.70030782  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01457399 -0.07571367 -2.60696576]
Stock Position:  -0.014573994836294344
Bond Position:  [4.29212389]


portfolio before change:  [2.95627716]
curr_Stock_Price:  91.69642889350023
curr_Factors:  [91.69642889  0.13689603 -0.83155791]
mat_Sqrt:  [[45.77882116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00647259 -0.0827911  -0.5543838 ]
Stock Position:  0.006472593833613441
Bond Position:  [2.36276342]


portfolio before change:  [2.9454293]
curr_Stock_Price:  89.97482736321162
curr_Factors:  [ 8.99748274e+01  1.68935874e-02 -8.21075934e-01]
mat_Sqrt:  [[40.25956392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0038613  -0.00222568 -0.09718134]
Stock Position:  0.003861295685324632
Bond Position:  [2.59800988]


portfolio before change:  [2.94243689]
curr_Stock_Price:  89.1157421844129
curr_Factors:  [89.11574218 -0.19417236 -0.80902362]
mat_Sqrt:  [[32.67924012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138161  0.12863753 -0.45522944]
Stock Position:  0.001381611977734083
Bond Position:  [2.81931351]


portfolio before change:  [2.94126027]
curr_Stock_Price:  88.00902531194109
curr_Factors:  [88.00902531 -0.33339529 -0.80833284]
mat_Sqrt:  [[28.09836067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129938  0.01726359  0.07841173]
Stock Position:  -0.0012993842313237076
Bond Position:  [3.05561781]


portfolio before change:  [2.94070078]
curr_Stock_Price:  88.73357035365456
curr_Factors:  [88.73357035 -0.35078036 -0.8165464 ]
mat_Sqrt:  [[27.61368641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00386001 0.03616784 0.26693905]
Stock Position:  0.0038600072168358834
Bond Position:  [2.59818856]


portfolio before change:  [2.93860305]
curr_Stock_Price:  88.1059742438045
curr_Factors:  [88.10597424 -0.34720394 -0.81761758]
mat_Sqrt:  [[27.48715562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01470824  0.03636812 -0.30197803]
Stock Position:  -0.01470823853108751
Bond Position:  [4.23448674]


portfolio before change:  [2.94481622]
curr_Stock_Price:  87.71953610148083
curr_Factors:  [87.7195361  -0.33531323 -0.80717132]
mat_Sqrt:  [[27.98476025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01160776 -0.01453312 -0.21637414]
Stock Position:  -0.011607763161279852
Bond Position:  [3.96304382]


portfolio before change:  [2.92194361]
curr_Stock_Price:  89.73267325564461
curr_Factors:  [89.73267326 -0.32705269 -0.78641062]
mat_Sqrt:  [[29.46996591  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01302227 0.08077818 0.23172543]
Stock Position:  0.013022267824926196
Bond Position:  [1.75342071]


portfolio before change:  [2.91391812]
curr_Stock_Price:  89.09955132956922
curr_Factors:  [89.09955133 -0.20345968 -0.79817887]
mat_Sqrt:  [[32.72422877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00017042  0.09361575  0.14655304]
Stock Position:  -0.00017041754489376405
Bond Position:  [2.92910225]


portfolio before change:  [2.91427719]
curr_Stock_Price:  89.14113288764878
curr_Factors:  [ 8.91411329e+01 -4.80699482e-02 -8.20659686e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.91427719]
Stock Price:  93.35604618529301
PL:  [2.91427719]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.07630065e-01  5.24959305e-02  7.41236172e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.84037488e-01  1.65518605e-01  1.92246717e-01]
 [-6.38362654e-03  2.54272227e-02  1.25139037e-01]
 [-2.55034490e-01 -8.53904532e-02  4.64212025e-02]
 [ 8.50714770e-02 -2.39628086e-01 -3.28423258e-01]
 [ 1.87740317e-02 -3.00687634e-01 -4.63225442e-02]
 [ 9.06052892e-02  2.78275285e-01 -2.18348287e-02]
 [-7.88571187e-02  1.70316408e-02 -6.01021356e-02]
 [ 1.11406472e-01 -8.89643216e-03  9.80295786e-02]
 [ 1.72789899e-01 -2.37381625e-01 -3.58865624e-02]
 [-1.89769914e-01 -1.35265282e-01 -2.97325278e-01]
 [ 2.48106001e-01 -2.93858606e-01 -4.26734436e-02]
 [ 6.62633555e-02 -9.14593476e-02 -5.61323590e-02]
 [-2.45217820e-01  4.37718308e-01  3.10813495e-01]
 [ 7.91986471e-02 -4.83306277e-01 -1.35496480e-01]
 [ 1.50693238e-01 -2.06134324e-01 -1.13123395e-01]
 [-3.09474120e-01 -7.19308828e-02 -4.05210550e-02]
 [ 2.56330979e-01  1.28570805e+00  3.56620898e-01]
 [-3.05559026e-01 -4.76077187e-02  2.41625036e-01]
 [-8.62746273e-02 -2.45494921e-02 -4.51500683e-02]
 [ 1.83594662e-01 -5.38173047e-02  9.91830006e-02]
 [-8.29927381e-02  7.66692032e-02 -1.09257090e-01]
 [-6.77398219e-03 -1.08225496e-01  1.05622807e-01]
 [-1.01765270e-01  7.42606259e-02 -3.93462315e-02]
 [ 8.42556927e-02 -1.55219555e-01 -1.88209350e-01]
 [ 7.00002708e-02 -2.50783633e-02  1.05267917e-01]
 [-1.57483886e-01  3.97181336e-02  1.51759654e-01]
 [-3.92705056e-01 -5.80626800e-03 -5.69567509e-01]
 [ 2.17769142e-01 -1.41982707e-01 -1.64338902e-01]
 [ 1.34672177e-01  2.36168987e-03 -4.00843581e-02]
 [ 3.51184439e-02  1.86440493e-01 -5.37183940e-02]
 [-1.68226376e-01  2.21658546e-02 -1.52410365e-01]
 [-2.44026321e-02  1.43854446e-01  9.47816162e-02]
 [-1.79780585e-01  8.95348966e-02  8.17598816e-02]
 [-1.48135108e-01 -4.77825608e-02 -3.45940620e-02]
 [ 2.22325614e-01  1.61599429e-01  2.62866328e-02]
 [-1.43629749e-01  1.41414699e-01 -7.63251860e-03]
 [ 1.62355479e-03 -2.13522682e-01  6.84791618e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.85390147]
curr_Stock_Price:  100.34360766244895
curr_Factors:  [100.34360766  -0.75271159  -0.99281034]
mat_Sqrt:  [[17.51536406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00520367  0.01660067  0.21145405]
Stock Position:  -0.0052036717752513405
Bond Position:  [5.37605667]


portfolio before change:  [4.85303532]
curr_Stock_Price:  100.63920544648795
curr_Factors:  [100.63920545  -0.49081255  -1.02617445]
mat_Sqrt:  [[22.07740966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00205554  0.01411938  0.0859571 ]
Stock Position:  -0.0020555420015701486
Bond Position:  [5.05990344]


portfolio before change:  [4.85403957]
curr_Stock_Price:  100.45836864233668
curr_Factors:  [100.45836864  -0.81981812  -1.03893772]
mat_Sqrt:  [[15.65808762  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02091912 0.05234158 0.54842637]
Stock Position:  0.020919116334058616
Bond Position:  [2.75253927]


portfolio before change:  [4.81626906]
curr_Stock_Price:  98.63637033667352
curr_Factors:  [98.63637034 -0.67238616 -1.02617379]
mat_Sqrt:  [[18.04520693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00109818 0.00804079 0.35698684]
Stock Position:  0.0010981752946328334
Bond Position:  [4.70794904]


portfolio before change:  [4.81660941]
curr_Stock_Price:  98.41037369238809
curr_Factors:  [98.41037369 -0.79682295 -1.00217336]
mat_Sqrt:  [[16.28346066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01521566 -0.02700283  0.13242677]
Stock Position:  -0.015215658334000116
Bond Position:  [6.31398803]


portfolio before change:  [4.8365105]
curr_Stock_Price:  97.15431276579183
curr_Factors:  [97.15431277 -0.89918548 -0.99220052]
mat_Sqrt:  [[14.65694909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.08162022e-04 -7.57770545e-02 -9.36900139e-01]
Stock Position:  0.000808162021660743
Bond Position:  [4.75799408]


portfolio before change:  [4.83727696]
curr_Stock_Price:  97.36674090517322
curr_Factors:  [97.36674091 -0.85573149 -1.01324736]
mat_Sqrt:  [[15.02185032  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.03499940e-04 -9.50857787e-02 -1.32145325e-01]
Stock Position:  0.00010349993963539923
Bond Position:  [4.82719951]


portfolio before change:  [4.83785026]
curr_Stock_Price:  97.07550726711814
curr_Factors:  [97.07550727 -0.64042456 -1.03817279]
mat_Sqrt:  [[18.11774329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00515149  0.08799837 -0.06228869]
Stock Position:  0.005151486524606222
Bond Position:  [4.33776709]


portfolio before change:  [4.83795435]
curr_Stock_Price:  96.99045106786765
curr_Factors:  [96.99045107 -0.59535258 -1.04400956]
mat_Sqrt:  [[18.8262164   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00481699  0.00538588 -0.17145466]
Stock Position:  -0.004816988118412146
Bond Position:  [5.3051562]


portfolio before change:  [4.83509435]
curr_Stock_Price:  97.72185983614605
curr_Factors:  [97.72185984 -0.78541968 -1.04490555]
mat_Sqrt:  [[15.6708148   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00837142 -0.0028133   0.2796511 ]
Stock Position:  0.00837141988920627
Bond Position:  [4.01702363]


portfolio before change:  [4.82692931]
curr_Stock_Price:  96.68652785135464
curr_Factors:  [96.68652785 -0.71021351 -1.07164432]
mat_Sqrt:  [[16.27477292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00979033 -0.07506666 -0.10237437]
Stock Position:  0.00979033126159491
Bond Position:  [3.88033617]


portfolio before change:  [4.82325772]
curr_Stock_Price:  96.26196038710793
curr_Factors:  [96.26196039 -0.62806571 -1.0815982 ]
mat_Sqrt:  [[17.41634823  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01458134 -0.04277464 -0.84818626]
Stock Position:  -0.014581341265253215
Bond Position:  [6.22688622]


portfolio before change:  [4.81098795]
curr_Stock_Price:  97.15681547585672
curr_Factors:  [97.15681548 -0.6655213  -1.06124515]
mat_Sqrt:  [[17.28017469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01341467 -0.09292625 -0.12173546]
Stock Position:  0.013414674819378948
Bond Position:  [3.50766086]


portfolio before change:  [4.81099559]
curr_Stock_Price:  97.12469798153514
curr_Factors:  [97.12469798 -0.46089213 -1.06524843]
mat_Sqrt:  [[21.1122858   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00248405 -0.02892199 -0.16013   ]
Stock Position:  0.002484047252658468
Bond Position:  [4.56973325]


portfolio before change:  [4.80644219]
curr_Stock_Price:  95.06167469636817
curr_Factors:  [95.0616747  -0.31087672 -1.05939528]
mat_Sqrt:  [[24.14926362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00705907  0.13841868  0.88666439]
Stock Position:  -0.00705907418343126
Bond Position:  [5.4774896]


portfolio before change:  [4.80620644]
curr_Stock_Price:  95.1920708689391
curr_Factors:  [95.19207087 -0.3689789  -1.06043426]
mat_Sqrt:  [[22.79368416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017137  -0.15283486 -0.38653374]
Stock Position:  0.0017137040789288259
Bond Position:  [4.6430754]


portfolio before change:  [4.80552272]
curr_Stock_Price:  94.45440254160064
curr_Factors:  [94.45440254 -0.78192012 -1.04226994]
mat_Sqrt:  [[15.24005474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00802357 -0.0651854  -0.32270956]
Stock Position:  0.008023570676002645
Bond Position:  [4.04766114]


portfolio before change:  [4.80393576]
curr_Stock_Price:  94.19355264872637
curr_Factors:  [94.19355265 -1.00931463 -1.01024267]
mat_Sqrt:  [[12.50082239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02556653 -0.02274654 -0.11559529]
Stock Position:  -0.02556653342474968
Bond Position:  [7.21213837]


portfolio before change:  [4.78779558]
curr_Stock_Price:  94.86011742110597
curr_Factors:  [94.86011742 -1.13553667 -1.02022201]
mat_Sqrt:  [[10.9862521   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03297965 0.40657658 1.01734016]
Stock Position:  0.03297965047466408
Bond Position:  [1.65934207]


portfolio before change:  [4.80023805]
curr_Stock_Price:  95.23110492729865
curr_Factors:  [95.23110493 -1.10756657 -0.98064883]
mat_Sqrt:  [[11.799902    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0218194  -0.01505488  0.68928897]
Stock Position:  -0.021819397132645184
Bond Position:  [6.87812335]


portfolio before change:  [4.80352009]
curr_Stock_Price:  95.12009256574811
curr_Factors:  [95.12009257 -1.06082582 -0.95954609]
mat_Sqrt:  [[12.6135082   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00762078 -0.00776323 -0.12880058]
Stock Position:  -0.007620775283503321
Bond Position:  [5.52840894]


portfolio before change:  [4.80953535]
curr_Stock_Price:  94.42145501919131
curr_Factors:  [94.42145502 -0.94110989 -0.98549821]
mat_Sqrt:  [[13.75166946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0147219  -0.01701853  0.28294149]
Stock Position:  0.014721903454182238
Bond Position:  [3.4194718]


portfolio before change:  [4.80867031]
curr_Stock_Price:  94.3336604239962
curr_Factors:  [94.33366042 -1.2612422  -1.00263233]
mat_Sqrt:  [[ 9.80569701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01053624  0.02424493 -0.31168007]
Stock Position:  -0.010536238058436826
Bond Position:  [5.80259221]


portfolio before change:  [4.79750155]
curr_Stock_Price:  95.4625385104178
curr_Factors:  [95.46253851 -1.31260673 -1.00713696]
mat_Sqrt:  [[ 9.38385084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00127792 -0.03422391  0.30131247]
Stock Position:  0.0012779202240275147
Bond Position:  [4.67550804]


portfolio before change:  [4.79789799]
curr_Stock_Price:  95.31539630515181
curr_Factors:  [95.31539631 -1.3911796  -1.0053958 ]
mat_Sqrt:  [[ 8.67648035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01243354  0.02348327 -0.11224385]
Stock Position:  -0.01243354218914449
Bond Position:  [5.98300599]


portfolio before change:  [4.8026021]
curr_Stock_Price:  94.99720934017988
curr_Factors:  [94.99720934 -1.14875007 -0.97887387]
mat_Sqrt:  [[11.31606701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0036965  -0.04908473 -0.53690889]
Stock Position:  0.0036965023588851243
Bond Position:  [4.45144469]


portfolio before change:  [4.79983776]
curr_Stock_Price:  94.09884481363923
curr_Factors:  [94.09884481 -1.12234945 -0.95997924]
mat_Sqrt:  [[11.72844489  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00774531 -0.00793047  0.30030007]
Stock Position:  0.007745312751948177
Bond Position:  [4.07101278]


portfolio before change:  [4.80192713]
curr_Stock_Price:  94.30289852397584
curr_Factors:  [94.30289852 -0.97549795 -0.9702247 ]
mat_Sqrt:  [[13.47436873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00931254  0.01255998  0.43292805]
Stock Position:  -0.009312537074614591
Bond Position:  [5.68012637]


portfolio before change:  [4.79868246]
curr_Stock_Price:  94.72756494549252
curr_Factors:  [94.72756495 -1.0825896  -0.96398829]
mat_Sqrt:  [[12.23654711  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0416063  -0.0018361  -1.62481757]
Stock Position:  -0.04160630038161555
Bond Position:  [8.73994599]


portfolio before change:  [4.78479216]
curr_Stock_Price:  95.08767543368519
curr_Factors:  [95.08767543 -1.16536527 -0.97237198]
mat_Sqrt:  [[11.21286873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01610271 -0.04489887 -0.46881315]
Stock Position:  0.016102714725480194
Bond Position:  [3.25362245]


portfolio before change:  [4.77991432]
curr_Stock_Price:  94.75949636362391
curr_Factors:  [94.75949636 -1.3832989  -0.97034858]
mat_Sqrt:  [[ 9.00423099  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01405461  0.00074683 -0.11434952]
Stock Position:  0.01405461174003114
Bond Position:  [3.44810639]


portfolio before change:  [4.781778]
curr_Stock_Price:  94.86143031123945
curr_Factors:  [94.86143031 -1.19029986 -1.01224983]
mat_Sqrt:  [[10.48418054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00276293  0.05895766 -0.15324363]
Stock Position:  0.0027629336780426606
Bond Position:  [4.51968216]


portfolio before change:  [4.78311928]
curr_Stock_Price:  95.14239589657646
curr_Factors:  [95.1423959  -1.33142932 -1.0225702 ]
mat_Sqrt:  [[ 9.03743276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02199349  0.00700946 -0.43478435]
Stock Position:  -0.0219934904935646
Bond Position:  [6.87563266]


portfolio before change:  [4.79474624]
curr_Stock_Price:  94.65282129885875
curr_Factors:  [94.6528213  -1.44335668 -1.04058193]
mat_Sqrt:  [[ 7.89537446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.69860195e-04  4.54907701e-02  2.70385569e-01]
Stock Position:  -0.00016986019515351756
Bond Position:  [4.81082399]


portfolio before change:  [4.79538634]
curr_Stock_Price:  94.42495028019405
curr_Factors:  [94.42495028 -1.30228894 -1.0194521 ]
mat_Sqrt:  [[ 9.26333652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01735656  0.02831342  0.23323818]
Stock Position:  -0.01735655807678302
Bond Position:  [6.43427847]


portfolio before change:  [4.8041378]
curr_Stock_Price:  93.96707576475477
curr_Factors:  [93.96707576 -1.32413654 -1.02703411]
mat_Sqrt:  [[ 8.95107659  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01747615 -0.01511017 -0.09868723]
Stock Position:  -0.017476147136169948
Bond Position:  [6.44632024]


portfolio before change:  [4.80840257]
curr_Stock_Price:  93.76915302411336
curr_Factors:  [93.76915302 -1.52902539 -1.06931346]
mat_Sqrt:  [[ 6.97614929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03323665 0.05110223 0.07498845]
Stock Position:  0.033236649638137765
Bond Position:  [1.69183008]


portfolio before change:  [4.81266655]
curr_Stock_Price:  93.89108119860364
curr_Factors:  [93.8910812  -1.34010878 -1.06788441]
mat_Sqrt:  [[ 8.44979522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01675028  0.04471925 -0.02177345]
Stock Position:  -0.01675027800032578
Bond Position:  [6.38536826]


portfolio before change:  [4.80630563]
curr_Stock_Price:  94.3184850624137
curr_Factors:  [94.31848506 -1.24911806 -1.08843856]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.80630563]
Stock Price:  93.94496096336964
PL:  [4.80630563]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.97473957e-01  3.03498255e-03  1.24755797e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 3.23534402e-01  4.67182317e-01  6.54562270e-01]
 [ 1.16757194e-02  5.18132558e-02  1.41988551e-01]
 [-3.49318131e-01 -1.12097397e-01  4.41171525e-02]
 [-6.16890303e-03 -9.25356646e-02 -1.08593447e-01]
 [ 3.07257768e-02  7.08051069e-02  6.79881749e-03]
 [ 2.21182620e-01 -1.67645730e-01 -2.63944170e-02]
 [-4.40681062e-01 -2.39197562e-02 -4.86470609e-02]
 [ 1.40478411e-01  4.49605709e-02  2.90779415e-01]
 [ 1.66388373e-01 -3.27000202e-01 -5.04238296e-03]
 [-3.06592775e-02 -4.77436151e-02 -1.01909739e-01]
 [ 1.85708524e-01 -1.66486059e-01  1.27723246e-01]
 [ 9.94032633e-02 -3.37628084e-02 -7.09972752e-02]
 [ 9.53254546e-03 -6.21432040e-02 -2.36591752e-02]
 [-2.48977702e-02 -6.28938734e-02  3.14577785e-03]
 [-3.98915824e-01 -2.16288828e-01  9.62080350e-02]
 [-1.75113634e-01 -5.57024704e-02 -2.28856579e-02]
 [ 1.47045373e-01  7.80536360e-01  1.37779444e-01]
 [-2.73051796e-02  4.66280433e-02  2.46822482e-02]
 [ 6.92986970e-02 -1.99944508e-01  1.33968970e-01]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 2.52468011e-01  8.87107277e-03  2.32457765e-01]
 [ 7.07032205e-02 -1.76878500e-01 -6.80756417e-02]
 [-1.20590554e-01  2.29625288e-01  2.07108218e-01]
 [ 1.25318065e-02  6.10320503e-02  3.85916491e-02]
 [-6.87630337e-02 -9.25533363e-02  1.68489518e-01]
 [ 9.58249956e-02  7.35427176e-02 -8.77660396e-02]
 [-7.74316006e-01 -1.38700688e-01 -1.12625221e+00]
 [ 1.78361128e-02 -1.43076706e-01  1.57533487e-01]
 [-9.38743235e-02 -1.37733543e-01  1.29047273e-01]
 [ 5.09368475e-02  1.78475804e-01 -2.99948626e-02]
 [-1.08983609e-01 -4.60992695e-03 -2.15628086e-02]
 [-5.94817241e-02  1.29541586e-01  1.23308580e-01]
 [ 1.04533590e-01 -1.49384921e-01 -1.19197162e-01]
 [-3.83339879e-02  2.99462259e-01  8.49839097e-02]
 [ 2.01088389e-01  1.43995097e-01  7.49455806e-04]
 [-1.24264916e-02  6.21929070e-02 -1.12028818e-02]
 [-1.27276196e-01 -2.57995746e-01  5.28970786e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.99496429]
curr_Stock_Price:  99.80594207787716
curr_Factors:  [99.80594208 -0.90402907 -0.94152279]
mat_Sqrt:  [[15.76316449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01090707  0.00095975  0.35589356]
Stock Position:  -0.010907069091678172
Bond Position:  [2.0835546]


portfolio before change:  [0.99345772]
curr_Stock_Price:  99.96795002144626
curr_Factors:  [99.96795002 -0.70553695 -0.97897463]
mat_Sqrt:  [[18.54755646  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244674  0.01411938  0.0859571 ]
Stock Position:  -0.002446739705616833
Bond Position:  [1.23805328]


portfolio before change:  [0.99725656]
curr_Stock_Price:  98.47859171770362
curr_Factors:  [98.47859172 -0.39039542 -0.97560853]
mat_Sqrt:  [[25.12429303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01867551 0.14773602 1.86728396]
Stock Position:  0.018675509033481346
Bond Position:  [-0.84188127]


portfolio before change:  [1.02019261]
curr_Stock_Price:  99.71236188426927
curr_Factors:  [99.71236188 -0.47196849 -0.9820196 ]
mat_Sqrt:  [[23.29646372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00180271 0.01638479 0.40505381]
Stock Position:  0.0018027123749546881
Bond Position:  [0.8404399]


portfolio before change:  [1.02079312]
curr_Stock_Price:  99.98719753495469
curr_Factors:  [99.98719753 -0.50816519 -1.00772568]
mat_Sqrt:  [[21.95843343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01562985 -0.03544831  0.12585396]
Stock Position:  -0.015629853486243742
Bond Position:  [2.58357837]


portfolio before change:  [1.01799154]
curr_Stock_Price:  100.18710611616106
curr_Factors:  [100.18710612  -0.39286783  -1.04100997]
mat_Sqrt:  [[23.88287562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00128647 -0.02926235 -0.30978688]
Stock Position:  -0.0012864744021805798
Bond Position:  [1.14687969]


portfolio before change:  [1.01718454]
curr_Stock_Price:  100.92584937816335
curr_Factors:  [100.92584938  -0.4422289   -1.04080896]
mat_Sqrt:  [[22.90483952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00148186 0.02239054 0.01939513]
Stock Position:  0.0014818597439117578
Bond Position:  [0.86762658]


portfolio before change:  [1.01744978]
curr_Stock_Price:  101.03165124613048
curr_Factors:  [101.03165125  -0.45686245  -1.04829207]
mat_Sqrt:  [[22.42730806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00942896 -0.05301423 -0.07529592]
Stock Position:  0.009428964351200398
Bond Position:  [0.06482594]


portfolio before change:  [1.01145222]
curr_Stock_Price:  100.39471370637848
curr_Factors:  [100.39471371  -0.14120268  -1.04130679]
mat_Sqrt:  [[30.77184313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01466369 -0.00756409 -0.13877652]
Stock Position:  -0.01466368800210512
Bond Position:  [2.48360898]


portfolio before change:  [1.06584829]
curr_Stock_Price:  96.70631039009055
curr_Factors:  [ 9.67063104e+01 -3.18246274e-02 -1.04296513e+00]
mat_Sqrt:  [[33.01258665  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00608842 0.01421778 0.82951273]
Stock Position:  0.006088416797830585
Bond Position:  [0.47705996]


portfolio before change:  [1.06900423]
curr_Stock_Price:  97.21486722994732
curr_Factors:  [97.21486723 -0.16865015 -1.07495743]
mat_Sqrt:  [[28.03114137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00559792 -0.10340654 -0.01438452]
Stock Position:  0.005597916621296955
Bond Position:  [0.52480351]


portfolio before change:  [1.07709396]
curr_Stock_Price:  98.64827938044974
curr_Factors:  [98.64827938 -0.44890471 -1.06609003]
mat_Sqrt:  [[21.68381342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243012 -0.01509786 -0.29072012]
Stock Position:  -0.0024301191738653333
Bond Position:  [1.31682103]


portfolio before change:  [1.07652456]
curr_Stock_Price:  98.95032688503552
curr_Factors:  [98.95032689 -0.56058703 -1.04794151]
mat_Sqrt:  [[19.80807005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01047458 -0.05264751  0.36435887]
Stock Position:  0.010474582848598167
Bond Position:  [0.04006116]


portfolio before change:  [1.09004362]
curr_Stock_Price:  100.24050252235917
curr_Factors:  [100.24050252  -0.6966353   -1.09367224]
mat_Sqrt:  [[16.73102508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00502296 -0.01067674 -0.20253546]
Stock Position:  0.005022959014481062
Bond Position:  [0.58653968]


portfolio before change:  [1.087183]
curr_Stock_Price:  99.65639580834468
curr_Factors:  [99.65639581 -0.5091025  -1.0865757 ]
mat_Sqrt:  [[20.20742335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00015334 -0.01965141 -0.06749304]
Stock Position:  0.00015333998092285298
Bond Position:  [1.07190169]


portfolio before change:  [1.08734663]
curr_Stock_Price:  99.84970453595923
curr_Factors:  [99.84970454 -0.44834629 -1.03752243]
mat_Sqrt:  [[22.59655325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00114529 -0.01988879  0.00897403]
Stock Position:  -0.001145287669811428
Bond Position:  [1.20170327]


portfolio before change:  [1.08567645]
curr_Stock_Price:  101.43918174854029
curr_Factors:  [101.43918175  -0.44501814  -1.03355086]
mat_Sqrt:  [[23.12444821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01664308 -0.06839653  0.27445474]
Stock Position:  -0.016643077974922548
Bond Position:  [2.77393666]


portfolio before change:  [1.10464569]
curr_Stock_Price:  100.3202493322187
curr_Factors:  [100.32024933  -0.38594997  -1.02418654]
mat_Sqrt:  [[24.48917181  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00740014 -0.01761467 -0.06528641]
Stock Position:  -0.007400143300966995
Bond Position:  [1.84702991]


portfolio before change:  [1.0855498]
curr_Stock_Price:  102.93192680375795
curr_Factors:  [102.9319268   -0.45535099  -1.02411427]
mat_Sqrt:  [[23.4437187   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00833156 0.24682727 0.3930464 ]
Stock Position:  0.008331564179248819
Bond Position:  [0.22796584]


portfolio before change:  [1.10737294]
curr_Stock_Price:  105.54783947106849
curr_Factors:  [105.54783947  -0.49733134  -1.06460413]
mat_Sqrt:  [[22.13652228  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0009515   0.01474508  0.07041158]
Stock Position:  -0.0009515047381382022
Bond Position:  [1.20780221]


portfolio before change:  [1.10737153]
curr_Stock_Price:  105.70799608935073
curr_Factors:  [105.70799609  -0.6414      -1.06608276]
mat_Sqrt:  [[19.16714817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00477288 -0.06322801  0.38217618]
Stock Position:  0.004772877669024921
Bond Position:  [0.6028402]


portfolio before change:  [1.10153589]
curr_Stock_Price:  104.46953906815264
curr_Factors:  [104.46953907  -0.48716685  -1.09357726]
mat_Sqrt:  [[21.5021177   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180768  0.01916992 -0.08961985]
Stock Position:  -0.0018076760732463693
Bond Position:  [1.29038298]


portfolio before change:  [1.09894992]
curr_Stock_Price:  105.98932294407746
curr_Factors:  [105.98932294  -0.4200952   -1.09408786]
mat_Sqrt:  [[23.31636106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01287282 0.00280528 0.6631373 ]
Stock Position:  0.012872819348974916
Bond Position:  [-0.26543149]


portfolio before change:  [1.10003562]
curr_Stock_Price:  106.07624124442181
curr_Factors:  [106.07624124  -0.73856898  -1.07041302]
mat_Sqrt:  [[17.37749692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00300621 -0.05593389 -0.19420086]
Stock Position:  0.0030062071296504873
Bond Position:  [0.78114847]


portfolio before change:  [1.10170454]
curr_Stock_Price:  106.5989138705911
curr_Factors:  [106.59891387  -0.77252431  -1.05332925]
mat_Sqrt:  [[17.17096309  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0042156   0.07261389  0.5908221 ]
Stock Position:  -0.004215597337203504
Bond Position:  [1.55108263]


portfolio before change:  [1.10343144]
curr_Stock_Price:  106.23526190194704
curr_Factors:  [106.2352619   -0.88201054  -1.05999686]
mat_Sqrt:  [[15.23581163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00144299 0.01930003 0.11009123]
Stock Position:  0.0014429907119759245
Bond Position:  [0.95013495]


portfolio before change:  [1.10253255]
curr_Stock_Price:  105.53001187243144
curr_Factors:  [105.53001187  -0.70338176  -1.05517521]
mat_Sqrt:  [[18.18211491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202177 -0.02926793  0.4806537 ]
Stock Position:  -0.002021765453491113
Bond Position:  [1.31588948]


portfolio before change:  [1.10147599]
curr_Stock_Price:  106.13396811058485
curr_Factors:  [106.13396811  -0.75693452  -1.10249387]
mat_Sqrt:  [[16.53160098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00482764  0.02325625 -0.25037208]
Stock Position:  0.004827644502473688
Bond Position:  [0.58909892]


portfolio before change:  [1.1025921]
curr_Stock_Price:  106.34990699166693
curr_Factors:  [106.34990699  -0.62400674  -1.0769938 ]
mat_Sqrt:  [[19.40894667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05192412 -0.04386101 -3.21288408]
Stock Position:  -0.05192412191360616
Bond Position:  [6.62471764]


portfolio before change:  [1.08701111]
curr_Stock_Price:  106.66592841149563
curr_Factors:  [106.66592841  -0.62660295  -1.05964183]
mat_Sqrt:  [[19.75599537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234351 -0.04524483  0.44939919]
Stock Position:  0.0023435051302728516
Bond Position:  [0.83703896]


portfolio before change:  [1.08771385]
curr_Stock_Price:  106.92114441956085
curr_Factors:  [106.92114442  -0.79577265  -1.05636383]
mat_Sqrt:  [[16.77609764  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423751 -0.04355517  0.36813595]
Stock Position:  -0.004237512536421823
Bond Position:  [1.54079354]


portfolio before change:  [1.08825841]
curr_Stock_Price:  106.83808910545282
curr_Factors:  [106.83808911  -0.82709927  -1.03756341]
mat_Sqrt:  [[16.55439829  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00298545  0.056439   -0.08556699]
Stock Position:  0.0029854541608363206
Bond Position:  [0.76929819]


portfolio before change:  [1.08785151]
curr_Stock_Price:  106.66958252928193
curr_Factors:  [106.66958253  -0.92144798  -1.03918147]
mat_Sqrt:  [[15.01585424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00755895 -0.00145779 -0.06151269]
Stock Position:  -0.00755895233567675
Bond Position:  [1.8941618]


portfolio before change:  [1.09183085]
curr_Stock_Price:  106.17446628092247
curr_Factors:  [106.17446628  -0.85359959  -1.02984686]
mat_Sqrt:  [[16.14543273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191799  0.04096465  0.35176506]
Stock Position:  -0.0019179861452516807
Bond Position:  [1.29547201]


portfolio before change:  [1.09059748]
curr_Stock_Price:  106.90195488144978
curr_Factors:  [106.90195488  -0.45934529  -1.05988895]
mat_Sqrt:  [[23.39863902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00326282 -0.04723966 -0.34003633]
Stock Position:  0.0032628166440668393
Bond Position:  [0.74179601]


portfolio before change:  [1.09136022]
curr_Stock_Price:  107.10730045638408
curr_Factors:  [107.10730046  -0.45376117  -1.08542342]
mat_Sqrt:  [[22.98051192  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057678  0.09469828  0.24243544]
Stock Position:  -0.0005767773049470795
Bond Position:  [1.15313728]


portfolio before change:  [1.09090088]
curr_Stock_Price:  108.15361134439382
curr_Factors:  [108.15361134  -0.20387024  -1.07738278]
mat_Sqrt:  [[30.0330824   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00682445 0.04553525 0.00213799]
Stock Position:  0.006824451319456826
Bond Position:  [0.35281183]


portfolio before change:  [1.07549782]
curr_Stock_Price:  105.89010903066969
curr_Factors:  [105.89010903  -0.39005725  -1.07930102]
mat_Sqrt:  [[24.36246371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00053802  0.01966712 -0.0319587 ]
Stock Position:  -0.0005380185042529715
Bond Position:  [1.13246866]


portfolio before change:  [1.07512002]
curr_Stock_Price:  106.85545380810758
curr_Factors:  [106.85545381  -0.43236078  -1.06078661]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.07512002]
Stock Price:  108.64805535131187
PL:  [-7.57293533]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.06057669e-01  1.85818718e-01  2.70272496e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.40877814e-01  2.15304239e-01  2.96464501e-01]
 [-7.23987923e-03  3.57901923e-02  1.28272440e-01]
 [-8.10388690e-01 -2.42701026e-01  3.28497725e-02]
 [-4.71861262e-02  2.34184072e-02  5.84425055e-02]
 [ 1.10206999e-02  1.33295522e-01  6.80455995e-02]
 [ 2.25430885e-01 -1.69888109e-01 -2.77701107e-02]
 [-5.57266901e-01 -2.59287016e-02 -9.20565267e-02]
 [-6.70765156e-02  8.70313937e-02  4.43723114e-02]
 [-1.46354747e-02 -2.38155377e-01  1.86508433e-01]
 [-1.99571764e-01  3.09580977e-02  1.67060501e-01]
 [ 3.51326205e-02  8.99530059e-02  1.66353636e-01]
 [-1.43718703e-02  6.75543288e-01  6.29541678e-01]
 [ 7.90388223e-02 -1.18751687e-01 -4.96413537e-02]
 [-1.35321218e-02 -1.33189730e-02  3.52990668e-02]
 [-5.47121904e-01 -6.37051379e-02  1.89740931e-01]
 [-1.22401615e-01  1.86886103e-02 -2.44429383e-02]
 [-5.36959683e-02  4.35643541e-01 -8.36757531e-03]
 [-3.00543784e-02  5.31228766e-02  2.44294935e-02]
 [ 1.72535158e-01 -2.13811670e-01  2.61686708e-01]
 [-3.72327513e-02  6.02952246e-02 -3.27360186e-02]
 [ 4.72255549e-01  1.07385576e-01  3.91335714e-01]
 [ 1.39911710e-02 -8.35816557e-02 -1.80206616e-02]
 [-1.19355203e-01  2.63128705e-01  3.18895324e-01]
 [-6.32863815e-03  5.72441278e-02  6.05645902e-02]
 [-1.90694690e-01 -9.52347287e-02  5.79482485e-01]
 [ 1.79968899e-01  9.96771957e-02 -1.15596881e-01]
 [-9.27410677e-01 -1.04808222e-01 -1.19901199e+00]
 [ 1.72335274e-01 -4.87626059e-01  4.72817284e-01]
 [-3.14936571e-01 -3.60728274e-01  1.74376973e-01]
 [ 1.67850964e-01  5.46131049e-01 -1.38960824e-01]
 [-6.84088759e-02  1.36471324e-02  1.43683155e-01]
 [ 9.53910818e-02  7.21974590e-01 -3.10464586e-01]
 [ 5.89382850e-02 -1.89603307e-01 -2.25212064e-01]
 [-8.76642703e-02  5.00369514e-01  9.15479374e-02]
 [ 3.06063459e-01  2.09433951e-01  2.81669498e-02]
 [ 3.78034829e-02  3.18952632e-02 -1.34888689e-02]
 [-1.90285157e-01 -4.16543864e-01  8.69161847e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.82514098]
curr_Stock_Price:  99.27368694012966
curr_Factors:  [99.27368694 -0.89029318 -0.98100702]
mat_Sqrt:  [[15.28054349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00956057  0.05876104  0.7710122 ]
Stock Position:  -0.009560570164638071
Bond Position:  [-1.87602793]


portfolio before change:  [-2.83259891]
curr_Stock_Price:  100.0292287812947
curr_Factors:  [100.02922878  -0.93353171  -0.99659231]
mat_Sqrt:  [[14.51726172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00312601  0.01411938  0.0859571 ]
Stock Position:  -0.003126005697768623
Bond Position:  [-2.51990697]


portfolio before change:  [-2.83235754]
curr_Stock_Price:  99.85124474227234
curr_Factors:  [99.85124474 -1.02632272 -0.99574533]
mat_Sqrt:  [[13.21844864  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02322152 0.06808518 0.8457307 ]
Stock Position:  0.023221522903509897
Bond Position:  [-5.15105551]


portfolio before change:  [-2.8305047]
curr_Stock_Price:  99.95876410637494
curr_Factors:  [99.95876411 -0.75885472 -0.99781231]
mat_Sqrt:  [[17.25480604  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00115143 0.01131785 0.36592557]
Stock Position:  0.0011514311882987293
Bond Position:  [-2.94560034]


portfolio before change:  [-2.82922353]
curr_Stock_Price:  101.39123727252911
curr_Factors:  [101.39123727  -0.81664008  -0.99625929]
mat_Sqrt:  [[16.54505554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04895419 -0.0767488   0.09371126]
Stock Position:  -0.04895418877537823
Bond Position:  [2.13430224]


portfolio before change:  [-2.85419984]
curr_Stock_Price:  101.90688499856778
curr_Factors:  [101.906885    -0.37011398  -0.99414217]
mat_Sqrt:  [[26.04441502  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00133049  0.00740555  0.1667202 ]
Stock Position:  -0.0013304940440767585
Bond Position:  [-2.71861334]


portfolio before change:  [-2.85499599]
curr_Stock_Price:  102.24983890028798
curr_Factors:  [102.2498389   -0.48158004  -0.97692875]
mat_Sqrt:  [[23.7815584   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00119219 0.04215175 0.19411516]
Stock Position:  0.0011921895474802477
Bond Position:  [-2.97689718]


portfolio before change:  [-2.85636709]
curr_Stock_Price:  101.41190765255764
curr_Factors:  [101.41190765  -0.42847453  -0.97882318]
mat_Sqrt:  [[24.82603267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0086754  -0.05372334 -0.0792204 ]
Stock Position:  0.008675403163160513
Bond Position:  [-3.73615628]


portfolio before change:  [-2.83861658]
curr_Stock_Price:  103.51181691756733
curr_Factors:  [103.51181692  -0.4594298   -1.00377767]
mat_Sqrt:  [[23.96221717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0240682  -0.00819938 -0.26261165]
Stock Position:  -0.02406819590879263
Bond Position:  [-0.3472739]


portfolio before change:  [-2.87582631]
curr_Stock_Price:  105.05602553571019
curr_Factors:  [105.05602554  -0.58795018  -1.01357153]
mat_Sqrt:  [[21.17819419  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263346  0.02752174  0.12658185]
Stock Position:  -0.0026334593976982635
Bond Position:  [-2.59916553]


portfolio before change:  [-2.87557793]
curr_Stock_Price:  104.83832956626397
curr_Factors:  [104.83832957  -0.82409633  -1.02629038]
mat_Sqrt:  [[16.47810834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104904 -0.07531134  0.53205664]
Stock Position:  0.0010490436117133184
Bond Position:  [-2.98555791]


portfolio before change:  [-2.8767726]
curr_Stock_Price:  104.05528873748116
curr_Factors:  [104.05528874  -0.74115028  -1.02870551]
mat_Sqrt:  [[17.72660442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0092895   0.00978981  0.47657711]
Stock Position:  -0.009289503155322615
Bond Position:  [-1.91015066]


portfolio before change:  [-2.88969754]
curr_Stock_Price:  105.42093323962627
curr_Factors:  [105.42093324  -0.75864718  -1.03900059]
mat_Sqrt:  [[17.46700118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00408839 0.02844564 0.47456062]
Stock Position:  0.004088394459792561
Bond Position:  [-3.3206999]


portfolio before change:  [-2.89026901]
curr_Stock_Price:  105.38268984543556
curr_Factors:  [105.38268985  -0.78465794  -0.97511172]
mat_Sqrt:  [[18.13472724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00725543 0.21362554 1.79590718]
Stock Position:  0.007255429734004574
Bond Position:  [-3.65486571]


portfolio before change:  [-2.89511411]
curr_Stock_Price:  104.77787191257453
curr_Factors:  [104.77787191  -0.5712427   -0.96058941]
mat_Sqrt:  [[22.64661733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00290726 -0.03755258 -0.14161296]
Stock Position:  0.002907262797206042
Bond Position:  [-3.19973092]


portfolio before change:  [-2.89303755]
curr_Stock_Price:  105.62972241155579
curr_Factors:  [105.62972241  -0.47120306  -0.95901732]
mat_Sqrt:  [[25.27256483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026395 -0.00421183  0.10069841]
Stock Position:  -0.0002639472651309693
Bond Position:  [-2.86515687]


portfolio before change:  [-2.89357693]
curr_Stock_Price:  106.31630732710846
curr_Factors:  [106.31630733  -0.49458317  -0.97019137]
mat_Sqrt:  [[24.57289825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02075604 -0.02014533  0.54127806]
Stock Position:  -0.020756039954855247
Bond Position:  [-0.68687141]


portfolio before change:  [-2.88080062]
curr_Stock_Price:  105.69662377978365
curr_Factors:  [105.69662378  -0.30642832  -0.95314068]
mat_Sqrt:  [[29.99419758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0042311   0.00590986 -0.0697289 ]
Stock Position:  -0.004231100730778829
Bond Position:  [-2.43358756]


portfolio before change:  [-2.88878267]
curr_Stock_Price:  107.51124043806931
curr_Factors:  [107.51124044  -0.436984    -0.95201974]
mat_Sqrt:  [[26.80508634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164729  0.13776258 -0.02387036]
Stock Position:  -0.0016472890254545741
Bond Position:  [-2.71168058]


portfolio before change:  [-2.88961599]
curr_Stock_Price:  107.8113327838728
curr_Factors:  [107.81133278  -0.46743037  -0.95539614]
mat_Sqrt:  [[25.98595682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091188  0.01679893  0.06969055]
Stock Position:  -0.0009118810710003337
Bond Position:  [-2.79130487]


portfolio before change:  [-2.89111554]
curr_Stock_Price:  109.07314294030878
curr_Factors:  [109.07314294  -0.37230507  -1.0027538 ]
mat_Sqrt:  [[27.57638597  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00799347 -0.06761319  0.74651934]
Stock Position:  0.007993474577848261
Bond Position:  [-3.76298894]


portfolio before change:  [-2.88296914]
curr_Stock_Price:  110.1511233170077
curr_Factors:  [110.15112332  -0.38547541  -1.00316242]
mat_Sqrt:  [[27.47332261  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154179  0.01906702 -0.09338675]
Stock Position:  -0.0015417919289025764
Bond Position:  [-2.71313902]


portfolio before change:  [-2.88876565]
curr_Stock_Price:  113.69073860918157
curr_Factors:  [113.69073861  -0.53859937  -1.02896894]
mat_Sqrt:  [[23.71039687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02340363 0.0339583  1.11637187]
Stock Position:  0.023403627683051285
Bond Position:  [-5.54954137]


portfolio before change:  [-2.92569889]
curr_Stock_Price:  112.1422818879985
curr_Factors:  [112.14228189  -0.70800331  -1.02216028]
mat_Sqrt:  [[19.87782626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00041024 -0.02643084 -0.05140793]
Stock Position:  0.0004102385059808415
Bond Position:  [-2.97170397]


portfolio before change:  [-2.92569552]
curr_Stock_Price:  113.0560221180355
curr_Factors:  [113.05602212  -0.72573117  -1.03431495]
mat_Sqrt:  [[19.4498108   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244049  0.0832086   0.9097196 ]
Stock Position:  -0.0024404871491579177
Bond Position:  [-2.64978376]


portfolio before change:  [-2.92770824]
curr_Stock_Price:  113.74501340187282
curr_Factors:  [113.7450134   -0.60147545  -1.04607155]
mat_Sqrt:  [[21.89837023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00034304 0.01810218 0.17277392]
Stock Position:  0.00034304352311356675
Bond Position:  [-2.96672773]


portfolio before change:  [-2.92862462]
curr_Stock_Price:  112.1547956600695
curr_Factors:  [112.15479566  -0.6157529   -1.04548786]
mat_Sqrt:  [[21.29855565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00351513 -0.03011587  1.65310223]
Stock Position:  -0.0035151338267022177
Bond Position:  [-2.5343855]


portfolio before change:  [-2.92776547]
curr_Stock_Price:  111.82025012249208
curr_Factors:  [111.82025012  -0.76922081  -1.04260208]
mat_Sqrt:  [[18.26651832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00870152  0.0315207  -0.32976573]
Stock Position:  0.00870151802738254
Bond Position:  [-3.90077139]


portfolio before change:  [-2.92741668]
curr_Stock_Price:  111.91637234878758
curr_Factors:  [111.91637235  -0.88990004  -1.01062432]
mat_Sqrt:  [[16.7304023   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0702233  -0.03314327 -3.42044747]
Stock Position:  -0.07022330309348086
Bond Position:  [4.93172065]


portfolio before change:  [-2.97755734]
curr_Stock_Price:  112.63916881943011
curr_Factors:  [112.63916882  -0.83874882  -1.01110409]
mat_Sqrt:  [[17.71366899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0144667 -0.1542009  1.3488161]
Stock Position:  0.014466695003911777
Bond Position:  [-4.60707384]


portfolio before change:  [-2.95812551]
curr_Stock_Price:  114.02218996045447
curr_Factors:  [114.02218996  -0.9972697   -1.03534699]
mat_Sqrt:  [[14.93602963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01932615 -0.1140723   0.49744897]
Stock Position:  -0.019326152353603066
Bond Position:  [-0.7545153]


portfolio before change:  [-2.96848389]
curr_Stock_Price:  114.55328686834565
curr_Factors:  [114.55328687  -0.95709811  -1.02197639]
mat_Sqrt:  [[15.83092969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00970169  0.1727018  -0.39641655]
Stock Position:  0.009701688433515956
Bond Position:  [-4.07984419]


portfolio before change:  [-2.96849815]
curr_Stock_Price:  114.60438616999761
curr_Factors:  [114.60438617  -1.17152154  -1.02028521]
mat_Sqrt:  [[12.80299748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302486  0.0043156   0.40988805]
Stock Position:  -0.0030248625162028336
Bond Position:  [-2.62183564]


portfolio before change:  [-2.96774108]
curr_Stock_Price:  114.24574962008343
curr_Factors:  [114.24574962  -1.11788781  -1.02357385]
mat_Sqrt:  [[13.42193302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00377435  0.22830841 -0.88566905]
Stock Position:  0.0037743495750968145
Bond Position:  [-3.39894447]


portfolio before change:  [-2.96835553]
curr_Stock_Price:  114.19552576814225
curr_Factors:  [114.19552577  -0.85570123  -1.04213332]
mat_Sqrt:  [[17.11709328  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.71547853e-04 -5.99578303e-02 -6.42467332e-01]
Stock Position:  0.00047154785325483013
Bond Position:  [-3.02220419]


portfolio before change:  [-2.96907732]
curr_Stock_Price:  113.46603740715332
curr_Factors:  [113.46603741  -0.94261084  -1.02046284]
mat_Sqrt:  [[15.93359672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035182   0.15823073  0.26116078]
Stock Position:  -0.0035182038043015573
Bond Position:  [-2.56988068]


portfolio before change:  [-2.96861573]
curr_Stock_Price:  113.24352438862832
curr_Factors:  [113.24352439  -0.74004826  -1.01930455]
mat_Sqrt:  [[19.49558006  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01627141 0.06622883 0.08035247]
Stock Position:  0.01627140992513199
Bond Position:  [-4.81124754]


portfolio before change:  [-3.00492906]
curr_Stock_Price:  111.04876160251976
curr_Factors:  [111.0487616   -0.82048561  -1.02838331]
mat_Sqrt:  [[17.48075343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00205218  0.01008617 -0.03847999]
Stock Position:  0.0020521776339408274
Bond Position:  [-3.23282085]


portfolio before change:  [-3.0058475]
curr_Stock_Price:  110.79814469049472
curr_Factors:  [110.79814469  -0.74241945  -1.04369263]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.0058475]
Stock Price:  110.16890395170316
PL:  [-13.17475145]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-7.44907399e-02 -1.75575937e-02 -1.78873651e-02]
 [-3.70926374e-02  1.99562582e-02 -1.38781265e-02]
 [ 2.63064312e-01 -2.32683800e-01 -4.25492410e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-7.32660433e-01 -2.20683588e-01  3.47492514e-02]
 [-4.71600335e-02 -1.39083897e-02  1.06457949e-02]
 [ 3.71461787e-02 -9.92927120e-03 -2.06059148e-02]
 [ 6.10051908e-02  2.13114943e-01 -4.16583461e-03]
 [-1.81380787e-01  5.89261062e-03 -5.88127250e-02]
 [ 5.75051914e-02 -3.27096018e-02 -5.59803357e-02]
 [ 3.98206018e-02 -3.52071851e-01  1.72936518e-01]
 [-9.16884882e-02  8.90076448e-03  6.11243349e-02]
 [ 5.15787716e-02 -4.58415230e-03  2.30731840e-01]
 [ 1.03586645e-01  1.39294242e-02 -2.37538276e-02]
 [-8.93380594e-02  5.17604580e-02  5.43853610e-02]
 [-1.32014269e-03 -1.50030782e-01 -2.64293642e-02]
 [-2.34484639e-01 -2.46924037e-01  3.71825116e-02]
 [-2.25204200e-01 -1.10229475e-01 -3.48243726e-02]
 [ 2.38192074e-01  1.14998235e+00  2.67714938e-01]
 [-1.12606688e-01 -2.42094115e-02  9.05514079e-02]
 [-3.30215699e-02 -8.28764632e-02  2.04606337e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.75197731e-01 -2.57634808e-02  1.76601352e-01]
 [ 8.17745584e-02 -1.01403070e-01 -6.38934161e-02]
 [-6.84700542e-02 -1.28806026e-01  1.76911704e-01]
 [ 1.45375357e-02  6.29438735e-02 -7.45592713e-03]
 [-4.76949791e-03 -5.73001806e-02  1.61110237e-01]
 [ 8.15311171e-02  6.91031440e-02 -8.30382977e-02]
 [-9.64611815e-01 -1.60226687e-01 -1.32461829e+00]
 [ 1.99870276e-01 -4.96833341e-01  4.62201515e-01]
 [-1.35485261e-01 -3.24163351e-01  1.50051889e-01]
 [ 1.15547145e-01  3.50947479e-01 -9.36762689e-02]
 [-7.01197470e-02  1.28773066e-02  1.36715407e-01]
 [ 9.25096659e-02  7.00542918e-01 -9.83243959e-02]
 [ 6.91233105e-02 -1.89683873e-01 -2.15158378e-01]
 [-8.00487398e-02  4.69353771e-01  9.05345932e-02]
 [ 5.40478221e-01  3.56426869e-01  8.96878169e-02]
 [ 2.29340580e-01 -8.23005957e-02 -2.16318589e-02]
 [-3.98338120e-01 -8.10152198e-01  2.29686356e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.44626835]
curr_Stock_Price:  100.8441320177536
curr_Factors:  [100.84413202  -1.21839143  -0.99050848]
mat_Sqrt:  [[11.07484326  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00709674 -0.0055522  -0.05102767]
Stock Position:  -0.007096743160432814
Bond Position:  [9.16193326]


portfolio before change:  [8.44601231]
curr_Stock_Price:  101.04159736777629
curr_Factors:  [101.04159737  -1.16352429  -0.9765491 ]
mat_Sqrt:  [[11.8871609   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331536  0.00631072 -0.03959043]
Stock Position:  -0.0033153610062279055
Bond Position:  [8.78100168]


portfolio before change:  [8.44613873]
curr_Stock_Price:  101.33455769628478
curr_Factors:  [101.3345577   -1.26343269  -0.97742444]
mat_Sqrt:  [[10.77868276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01579072 -0.07358108 -1.21381141]
Stock Position:  0.01579072054964398
Bond Position:  [6.84599305]


portfolio before change:  [8.44973345]
curr_Stock_Price:  101.50800876359693
curr_Factors:  [101.50800876  -1.17350761  -0.97885568]
mat_Sqrt:  [[11.7961642   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00167029 -0.00659539  0.21422481]
Stock Position:  0.0016702932895182147
Bond Position:  [8.28018531]


portfolio before change:  [8.45007837]
curr_Stock_Price:  101.09480651078161
curr_Factors:  [101.09480651  -0.78337751  -1.01887733]
mat_Sqrt:  [[16.6732213   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04385867 -0.06978628  0.09912994]
Stock Position:  -0.043858669206963984
Bond Position:  [12.88396205]


portfolio before change:  [8.44530844]
curr_Stock_Price:  101.24028570529406
curr_Factors:  [101.24028571  -0.67909381  -0.994244  ]
mat_Sqrt:  [[18.99468013  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023873  -0.00439822  0.03036949]
Stock Position:  -0.0023873043665651435
Bond Position:  [8.68699982]


portfolio before change:  [8.44933689]
curr_Stock_Price:  100.00772175354311
curr_Factors:  [100.00772175  -0.35832124  -0.98514716]
mat_Sqrt:  [[26.09592055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125244 -0.00313991 -0.05878294]
Stock Position:  0.0012524425503483896
Bond Position:  [8.32408296]


portfolio before change:  [8.44789409]
curr_Stock_Price:  98.02489807746888
curr_Factors:  [98.02489808 -0.35943045 -0.97824889]
mat_Sqrt:  [[25.72702959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00255208  0.06739286 -0.01188397]
Stock Position:  0.0025520803827382378
Bond Position:  [8.19772667]


portfolio before change:  [8.44869785]
curr_Stock_Price:  97.93829277363929
curr_Factors:  [97.93829277 -0.35086587 -0.99859424]
mat_Sqrt:  [[25.40325968  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00760665  0.00186341 -0.16777633]
Stock Position:  -0.007606651266947937
Bond Position:  [9.19368029]


portfolio before change:  [8.43433748]
curr_Stock_Price:  99.97725203416529
curr_Factors:  [99.97725203 -0.34559837 -1.00929593]
mat_Sqrt:  [[25.79158776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175382 -0.01034368 -0.15969632]
Stock Position:  0.0017538158333059806
Bond Position:  [8.25899579]


portfolio before change:  [8.43913601]
curr_Stock_Price:  102.12462347845212
curr_Factors:  [102.12462348  -0.22905692  -1.0212333 ]
mat_Sqrt:  [[29.25070412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0022574  -0.11133489  0.49333975]
Stock Position:  0.002257404281005339
Bond Position:  [8.20859945]


portfolio before change:  [8.44056195]
curr_Stock_Price:  102.3017305792756
curr_Factors:  [102.30173058  -0.15740331  -1.02907937]
mat_Sqrt:  [[31.23202168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252887  0.00281467  0.17437071]
Stock Position:  -0.002528869876548554
Bond Position:  [8.69926972]


portfolio before change:  [8.44013189]
curr_Stock_Price:  102.90181593463815
curr_Factors:  [102.90181593  -0.32892884  -1.06275133]
mat_Sqrt:  [[25.58727405  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00385185 -0.00144964  0.65821372]
Stock Position:  0.003851850289883473
Bond Position:  [8.0437695]


portfolio before change:  [8.43676567]
curr_Stock_Price:  101.76683967329804
curr_Factors:  [ 1.01766840e+02 -6.93775983e-02 -1.05918360e+00]
mat_Sqrt:  [[32.92140689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00301013  0.00440487 -0.06776306]
Stock Position:  0.0030101256516971014
Bond Position:  [8.13043469]


portfolio before change:  [8.42910757]
curr_Stock_Price:  98.8850775343052
curr_Factors:  [98.88507753 -0.27949165 -1.05683736]
mat_Sqrt:  [[25.98785552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295908  0.01636809  0.1551463 ]
Stock Position:  -0.0029590838963728613
Bond Position:  [8.72171681]


portfolio before change:  [8.4292512]
curr_Stock_Price:  99.20499157891268
curr_Factors:  [99.20499158 -0.15825428 -1.07198318]
mat_Sqrt:  [[28.98999789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036526 -0.0474439  -0.07539562]
Stock Position:  -0.0003652567426163511
Bond Position:  [8.46548649]


portfolio before change:  [8.43080759]
curr_Stock_Price:  97.84117815281598
curr_Factors:  [97.84117815 -0.22363044 -1.01620085]
mat_Sqrt:  [[28.31846998  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00823739 -0.07808424  0.10607136]
Stock Position:  -0.008237392125168544
Bond Position:  [9.23676374]


portfolio before change:  [8.42470544]
curr_Stock_Price:  98.72213965602626
curr_Factors:  [98.72213966 -0.36029826 -1.00022848]
mat_Sqrt:  [[25.32475799  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00928573 -0.03485762 -0.09934424]
Stock Position:  -0.00928572775997077
Bond Position:  [9.34141235]


portfolio before change:  [8.41602733]
curr_Stock_Price:  99.7824611428306
curr_Factors:  [99.78246114 -0.3802752  -0.98688614]
mat_Sqrt:  [[25.42749546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01268436 0.36365635 0.7637162 ]
Stock Position:  0.012684362660639116
Bond Position:  [7.1503504]


portfolio before change:  [8.42503005]
curr_Stock_Price:  100.42174200851771
curr_Factors:  [100.42174201  -0.15932678  -0.9753441 ]
mat_Sqrt:  [[32.28839453  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293443 -0.00765569  0.25831796]
Stock Position:  -0.0029344303122326508
Bond Position:  [8.71971065]


portfolio before change:  [8.41996662]
curr_Stock_Price:  102.51872886073697
curr_Factors:  [102.51872886  -0.31502743  -0.98859942]
mat_Sqrt:  [[27.83846374  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111303 -0.02620784  0.05836849]
Stock Position:  -0.0011130255566904029
Bond Position:  [8.53407258]


portfolio before change:  [8.41944664]
curr_Stock_Price:  103.94439757454901
curr_Factors:  [103.94439757  -0.64615577  -0.98570945]
mat_Sqrt:  [[20.32783035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019121   0.01916992 -0.08961985]
Stock Position:  -0.0019121009478411143
Bond Position:  [8.61819882]


portfolio before change:  [8.42165464]
curr_Stock_Price:  103.35307959881526
curr_Factors:  [103.3530796   -0.40416994  -0.95543244]
mat_Sqrt:  [[26.53723124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00793531 -0.00814713  0.5037945 ]
Stock Position:  0.007935308661314932
Bond Position:  [7.60151605]


portfolio before change:  [8.42462516]
curr_Stock_Price:  103.60767212024749
curr_Factors:  [103.60767212  -0.64972851  -0.96840717]
mat_Sqrt:  [[20.54208479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00321847 -0.03206647 -0.18227013]
Stock Position:  0.0032184733996591833
Bond Position:  [8.09116662]


portfolio before change:  [8.42344541]
curr_Stock_Price:  102.92684945337523
curr_Factors:  [102.92684945  -0.20553977  -0.94708133]
mat_Sqrt:  [[32.50511417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109779 -0.04073204  0.50467985]
Stock Position:  -0.0010977922115312322
Bond Position:  [8.5364377]


portfolio before change:  [8.42394541]
curr_Stock_Price:  103.44344841900039
curr_Factors:  [103.44344842  -0.27763221  -0.94331228]
mat_Sqrt:  [[30.51079587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047986  0.0199046  -0.02126968]
Stock Position:  0.00047985653601489395
Bond Position:  [8.3743074]


portfolio before change:  [8.42586433]
curr_Stock_Price:  105.26078684619922
curr_Factors:  [105.26078685  -0.44214349  -0.93637317]
mat_Sqrt:  [[26.52066662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00100441 -0.01811991  0.45960266]
Stock Position:  0.0010044056461219679
Bond Position:  [8.3201398]


portfolio before change:  [8.42770026]
curr_Stock_Price:  106.05314188590094
curr_Factors:  [106.05314189  -0.20669515  -0.93794514]
mat_Sqrt:  [[33.76078853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00196575  0.02185233 -0.23688515]
Stock Position:  0.001965748846747541
Bond Position:  [8.21922642]


portfolio before change:  [8.43626712]
curr_Stock_Price:  109.88852429885716
curr_Factors:  [109.8885243   -0.23506759  -0.96155919]
mat_Sqrt:  [[33.20962196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03731254 -0.05066813 -3.77876727]
Stock Position:  -0.03731254233543431
Bond Position:  [12.53648734]


portfolio before change:  [8.36515608]
curr_Stock_Price:  111.83634670611956
curr_Factors:  [111.83634671  -0.32089442  -0.96809138]
mat_Sqrt:  [[30.81651674  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0091311  -0.1571125   1.31853227]
Stock Position:  0.009131096344043873
Bond Position:  [7.34396762]


portfolio before change:  [8.36199317]
curr_Stock_Price:  111.38941637959222
curr_Factors:  [111.38941638  -0.13185089  -0.95639698]
mat_Sqrt:  [[37.51663559  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00301802 -0.10250945  0.42805627]
Stock Position:  -0.0030180187465829486
Bond Position:  [8.69816851]


portfolio before change:  [8.36638426]
curr_Stock_Price:  110.29473950349934
curr_Factors:  [110.2947395   -0.18416684  -0.95825092]
mat_Sqrt:  [[35.18917396  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00299771  0.11097934 -0.26723232]
Stock Position:  0.0029977112211893317
Bond Position:  [8.03575248]


portfolio before change:  [8.37453649]
curr_Stock_Price:  112.67912543963351
curr_Factors:  [ 1.12679125e+02  3.41495744e-02 -9.70115230e-01]
mat_Sqrt:  [[44.19353566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094766  0.00407216  0.390011  ]
Stock Position:  -0.0009476576202516207
Bond Position:  [8.48131772]


portfolio before change:  [8.37244376]
curr_Stock_Price:  116.00623485457479
curr_Factors:  [ 1.16006235e+02  3.36052434e-02 -9.58193538e-01]
mat_Sqrt:  [[46.01905931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00196717  0.22153112 -0.28049213]
Stock Position:  0.001967168047592915
Bond Position:  [8.14424]


portfolio before change:  [8.37016893]
curr_Stock_Price:  114.33229135069388
curr_Factors:  [ 1.14332291e+02  4.45731185e-02 -9.82604193e-01]
mat_Sqrt:  [[44.74939705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.53786539e-04 -5.99833073e-02 -6.13786963e-01]
Stock Position:  0.0004537865390877271
Bond Position:  [8.31828647]


portfolio before change:  [8.3707436]
curr_Stock_Price:  113.30717799100758
curr_Factors:  [113.30717799   0.14829265  -0.98788063]
mat_Sqrt:  [[48.93605933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010105   0.14842269  0.25826999]
Stock Position:  -0.0010104978160240918
Bond Position:  [8.48524025]


portfolio before change:  [8.36451377]
curr_Stock_Price:  120.52198335930323
curr_Factors:  [120.52198336  -0.23036615  -1.00901298]
mat_Sqrt:  [[34.89882086  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01627529 0.11271207 0.25585438]
Stock Position:  0.016275294063741175
Bond Position:  [6.40298305]


portfolio before change:  [8.41464975]
curr_Stock_Price:  123.55329918961435
curr_Factors:  [123.55329919  -0.32882355  -0.97715354]
mat_Sqrt:  [[33.47154071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0066564  -0.02602573 -0.06170967]
Stock Position:  0.006656401166674709
Bond Position:  [7.59222943]


portfolio before change:  [8.41735793]
curr_Stock_Price:  123.81757004304896
curr_Factors:  [123.81757004  -0.62178923  -0.98038332]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.41735793]
Stock Price:  121.34666412870072
PL:  [-12.9293062]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-7.30494216e-02 -2.26106534e-02 -2.40871075e-02]
 [-3.73005311e-02  2.02855041e-02 -1.32913228e-02]
 [ 2.97666638e-01 -4.84114293e-02 -1.54080097e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-5.01803891e-01 -1.55290772e-01  4.03907923e-02]
 [-4.00042318e-02 -2.76343149e-02 -1.01697416e-02]
 [ 2.73866090e-02  8.05881126e-02  1.13238462e-02]
 [ 3.02293656e-01 -8.75060677e-02 -6.49635648e-02]
 [-5.26700687e-01 -2.78525030e-02 -7.03575587e-02]
 [ 1.00709629e-02  4.61223940e-02 -1.16897009e-02]
 [-2.34041609e-02 -2.00437187e-01  1.38428354e-01]
 [-1.47998084e-01  2.04135731e-02  1.16417638e-01]
 [ 6.51125613e-02 -8.92012870e-03  2.40861983e-01]
 [ 3.39417696e-02  3.24048688e-01  2.77311002e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-1.89065335e-02  5.80825681e-05  3.73765554e-02]
 [-4.71187520e-01 -2.41004125e-01  1.26235290e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 1.99163275e-01  9.10669917e-01  2.59026655e-01]
 [ 1.82977030e-03  1.92412525e-02  2.93902189e-02]
 [-3.64637385e-02 -1.71604192e-01  4.65023209e-03]
 [-3.09436182e-02  5.41890132e-02 -2.55126280e-02]
 [ 4.25189920e-02 -3.54818149e-02  5.80189461e-02]
 [ 4.09623993e-02  1.83713219e-01  1.12388943e-01]
 [-5.89342297e-02 -1.87528395e-01  2.08933043e-02]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [ 1.67015126e-02 -7.06552979e-02 -1.31731147e-02]
 [ 9.74231704e-03  4.81361642e-02 -6.63427939e-02]
 [-5.77384255e-01 -3.60047412e-02 -8.58884122e-01]
 [-2.01610097e-01  1.91604125e-02  1.15375979e-02]
 [-5.38686440e-02  8.37729434e-02  2.10156022e-01]
 [ 1.31698294e-02  3.26974013e-02  2.02477374e-02]
 [-1.30676984e-01 -1.43711062e-02 -1.09911948e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 2.09293755e-01 -1.70816501e-01 -8.18802067e-02]
 [-8.39240812e-04  9.08622175e-02  7.80579231e-02]
 [ 7.23486538e-03  6.90781557e-03 -4.55170943e-02]
 [-4.64846723e-02  8.72181667e-02 -7.72624345e-03]
 [-6.63405807e-02 -2.63325711e-01  1.08663345e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.4326836]
curr_Stock_Price:  100.28491939048585
curr_Factors:  [100.28491939  -1.16729774  -1.01254747]
mat_Sqrt:  [[11.33811563  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00692796 -0.00715012 -0.06871381]
Stock Position:  -0.006927957776106156
Bond Position:  [5.12745328]


portfolio before change:  [4.42827418]
curr_Stock_Price:  101.0139062411186
curr_Factors:  [101.01390624  -0.95273281  -1.01604032]
mat_Sqrt:  [[14.10437543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279983  0.00641484 -0.03791644]
Stock Position:  -0.002799829156137732
Bond Position:  [4.71109586]


portfolio before change:  [4.42842467]
curr_Stock_Price:  101.17049837283221
curr_Factors:  [101.17049837  -0.91661117  -1.03206315]
mat_Sqrt:  [[14.41303318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01838372 -0.01530904 -0.43954763]
Stock Position:  0.01838372176900641
Bond Position:  [2.56853438]


portfolio before change:  [4.43675349]
curr_Stock_Price:  101.60608639774517
curr_Factors:  [101.6060864   -0.78430819  -1.05905247]
mat_Sqrt:  [[16.0826778   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122511 -0.00659539  0.21422481]
Stock Position:  0.0012251102802924487
Bond Position:  [4.31227482]


portfolio before change:  [4.4367675]
curr_Stock_Price:  101.17751232220994
curr_Factors:  [101.17751232  -0.45071959  -1.02533524]
mat_Sqrt:  [[23.12285904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02151848 -0.04910725  0.11522369]
Stock Position:  -0.021518478531005133
Bond Position:  [6.61395363]


portfolio before change:  [4.44496276]
curr_Stock_Price:  100.8350875147713
curr_Factors:  [100.83508751  -0.83944386  -1.03045547]
mat_Sqrt:  [[15.54263758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275331 -0.00873874 -0.02901144]
Stock Position:  -0.0027533059515481646
Bond Position:  [4.72259261]


portfolio before change:  [4.44522486]
curr_Stock_Price:  100.95431300540653
curr_Factors:  [100.95431301  -0.77563061  -1.04637754]
mat_Sqrt:  [[16.32438364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00194671 0.0254842  0.03230378]
Stock Position:  0.0019467108970739736
Bond Position:  [4.248696]


portfolio before change:  [4.44826613]
curr_Stock_Price:  102.2437478663016
curr_Factors:  [102.24374787  -0.96751069  -1.0706829 ]
mat_Sqrt:  [[13.31865992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02153172 -0.02767185 -0.18532297]
Stock Position:  0.021531717785770715
Bond Position:  [2.24678261]


portfolio before change:  [4.43947232]
curr_Stock_Price:  101.82229164676659
curr_Factors:  [101.82229165  -0.91022011  -1.07863419]
mat_Sqrt:  [[13.93459712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03888031 -0.00880773 -0.20071053]
Stock Position:  -0.03888031402820575
Bond Position:  [8.398355]


portfolio before change:  [4.41278857]
curr_Stock_Price:  102.53559886711926
curr_Factors:  [102.53559887  -1.15517033  -1.04267368]
mat_Sqrt:  [[11.38578933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00077954  0.01458518 -0.03334746]
Stock Position:  0.0007795408397909376
Bond Position:  [4.33285789]


portfolio before change:  [4.41363073]
curr_Stock_Price:  102.92110341750289
curr_Factors:  [102.92110342  -1.20402287  -1.02974411]
mat_Sqrt:  [[11.02533406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.92832295e-05 -6.33838040e-02  3.94897563e-01]
Stock Position:  -2.928322951621432e-05
Bond Position:  [4.41664459]


portfolio before change:  [4.41417204]
curr_Stock_Price:  103.2900381782442
curr_Factors:  [103.29003818  -1.05628404  -1.03186251]
mat_Sqrt:  [[12.79934994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00966513  0.00645534  0.33210712]
Stock Position:  -0.009665128098494208
Bond Position:  [5.41248349]


portfolio before change:  [4.41589763]
curr_Stock_Price:  103.18150489853171
curr_Factors:  [103.1815049   -0.9357968   -1.06260772]
mat_Sqrt:  [[13.98639554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00815421 -0.00282079  0.68711219]
Stock Position:  0.00815420889634327
Bond Position:  [3.57453409]


portfolio before change:  [4.41726012]
curr_Stock_Price:  103.29379506635084
curr_Factors:  [103.29379507  -0.99082124  -1.10733837]
mat_Sqrt:  [[12.6722897   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00780558 0.10247319 0.7910911 ]
Stock Position:  0.007805577711474869
Bond Position:  [3.61099237]


portfolio before change:  [4.4116174]
curr_Stock_Price:  102.51305627176151
curr_Factors:  [102.51305627  -1.08981215  -1.11350077]
mat_Sqrt:  [[11.32120192  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00379166 -0.03587186 -0.12433753]
Stock Position:  0.0037916586895505185
Bond Position:  [4.02292288]


portfolio before change:  [4.41115713]
curr_Stock_Price:  102.25903448085052
curr_Factors:  [102.25903448  -1.04816664  -1.11050301]
mat_Sqrt:  [[11.80873486  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.54850503e-04  1.83673207e-05  1.06624909e-01]
Stock Position:  -0.0009548505029646207
Bond Position:  [4.50879922]


portfolio before change:  [4.41198466]
curr_Stock_Price:  101.98266812327319
curr_Factors:  [101.98266812  -0.904762    -1.12936704]
mat_Sqrt:  [[13.33875678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03385942 -0.0762122   0.36011414]
Stock Position:  -0.03385941857739568
Bond Position:  [7.8650585]


portfolio before change:  [4.37221153]
curr_Stock_Price:  103.18636036295909
curr_Factors:  [103.18636036  -0.98016348  -1.12905783]
mat_Sqrt:  [[12.51984979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01048823  0.00580111 -0.05715682]
Stock Position:  -0.01048823156858767
Bond Position:  [5.45445397]


portfolio before change:  [4.37526856]
curr_Stock_Price:  102.95989916566913
curr_Factors:  [102.95989917  -0.80311715  -1.13253824]
mat_Sqrt:  [[14.86016583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01854288 0.28797911 0.73893095]
Stock Position:  0.018542879565227634
Bond Position:  [2.46609555]


portfolio before change:  [4.36471413]
curr_Stock_Price:  102.37408325536471
curr_Factors:  [102.37408326  -0.7065283   -1.12037715]
mat_Sqrt:  [[16.47309002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00050542 0.00608462 0.08384211]
Stock Position:  0.000505420088584268
Bond Position:  [4.31297221]


portfolio before change:  [4.36520752]
curr_Stock_Price:  102.28355086608376
curr_Factors:  [102.28355087  -0.90440547  -1.12010595]
mat_Sqrt:  [[13.50739675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295729 -0.05426601  0.01326582]
Stock Position:  -0.0029572918987211035
Bond Position:  [4.66768984]


portfolio before change:  [4.37039165]
curr_Stock_Price:  100.72786118141103
curr_Factors:  [100.72786118  -0.71789766  -1.09941163]
mat_Sqrt:  [[16.36448031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00212364  0.01713607 -0.07278043]
Stock Position:  -0.0021236364773260775
Bond Position:  [4.58430101]


portfolio before change:  [4.37189641]
curr_Stock_Price:  100.28913866865442
curr_Factors:  [100.28913867  -0.83132277  -1.11159504]
mat_Sqrt:  [[14.36995524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00371928 -0.01122034  0.1655119 ]
Stock Position:  0.0037192825158444136
Bond Position:  [3.99889277]


portfolio before change:  [4.36797594]
curr_Stock_Price:  99.1006384336575
curr_Factors:  [99.10063843 -0.74183193 -1.11561346]
mat_Sqrt:  [[15.46671806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00443838 0.05809522 0.32061437]
Stock Position:  0.004438378638796944
Bond Position:  [3.92812978]


portfolio before change:  [4.37599438]
curr_Stock_Price:  100.79661813780841
curr_Factors:  [100.79661814  -0.86107977  -1.12484221]
mat_Sqrt:  [[13.83474013  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430159 -0.05930169  0.05960278]
Stock Position:  -0.00430158887038991
Bond Position:  [4.80957999]


portfolio before change:  [4.37265766]
curr_Stock_Price:  101.712083127011
curr_Factors:  [101.71208313  -1.0387985   -1.1357931 ]
mat_Sqrt:  [[11.56004215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112076  0.02004328 -0.05140267]
Stock Position:  0.0011207643302866064
Bond Position:  [4.25866239]


portfolio before change:  [4.37335882]
curr_Stock_Price:  101.86268219046373
curr_Factors:  [101.86268219  -1.07605889  -1.15181802]
mat_Sqrt:  [[10.97641355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011104  -0.02234317 -0.03757923]
Stock Position:  0.0011104036724235145
Bond Position:  [4.26025012]


portfolio before change:  [4.37383091]
curr_Stock_Price:  101.80822775380234
curr_Factors:  [101.80822775  -1.16079736  -1.14274902]
mat_Sqrt:  [[10.17104079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0002514   0.01522199 -0.18925752]
Stock Position:  -0.00025139793519102693
Bond Position:  [4.39942529]


portfolio before change:  [4.37444725]
curr_Stock_Price:  101.5441917801616
curr_Factors:  [101.54419178  -1.04412505  -1.14739178]
mat_Sqrt:  [[11.34727085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06641534 -0.0113857  -2.45015733]
Stock Position:  -0.06641534261095197
Bond Position:  [11.11853954]


portfolio before change:  [4.37979391]
curr_Stock_Price:  101.48461597874793
curr_Factors:  [101.48461598  -0.96906897  -1.11633041]
mat_Sqrt:  [[12.61022301  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01576184  0.00605905  0.03291356]
Stock Position:  -0.01576183663593732
Bond Position:  [5.97937784]


portfolio before change:  [4.38810716]
curr_Stock_Price:  101.00460915284268
curr_Factors:  [101.00460915  -0.85353949  -1.12745019]
mat_Sqrt:  [[13.9318344   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006322   0.02649133  0.59951664]
Stock Position:  -0.0006322008445863524
Bond Position:  [4.45196236]


portfolio before change:  [4.38761523]
curr_Stock_Price:  102.66303712653426
curr_Factors:  [102.66303713  -0.80301195  -1.14335678]
mat_Sqrt:  [[14.65942408  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00123792 0.01033983 0.05776116]
Stock Position:  0.0012379152610980004
Bond Position:  [4.26052709]


portfolio before change:  [4.38806751]
curr_Stock_Price:  102.59814997231832
curr_Factors:  [102.59814997  -0.78209011  -1.1353923 ]
mat_Sqrt:  [[15.07951926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01017829 -0.00454454 -0.31354819]
Stock Position:  -0.010178290447937596
Bond Position:  [5.43234128]


portfolio before change:  [4.38708219]
curr_Stock_Price:  102.76167483230797
curr_Factors:  [102.76167483  -0.63638149  -1.15407258]
mat_Sqrt:  [[17.14931791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305631  0.0049611   0.16678008]
Stock Position:  -0.0030563141836345378
Bond Position:  [4.70115416]


portfolio before change:  [4.38625697]
curr_Stock_Price:  103.2239653980275
curr_Factors:  [103.2239654   -0.44728941  -1.13196458]
mat_Sqrt:  [[21.27743371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00884362 -0.05401692 -0.23358144]
Stock Position:  0.008843621218139176
Bond Position:  [3.47338332]


portfolio before change:  [4.37918742]
curr_Stock_Price:  102.3754726249689
curr_Factors:  [102.37547262  -0.3238648   -1.11760231]
mat_Sqrt:  [[24.22003174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00072008 0.02873316 0.22267753]
Stock Position:  0.0007200782629323248
Bond Position:  [4.30546907]


portfolio before change:  [4.37901524]
curr_Stock_Price:  101.38892472141335
curr_Factors:  [101.38892472  -0.34557611  -1.09048067]
mat_Sqrt:  [[24.11676102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.78675693e-05  2.18444309e-03 -1.29847601e-01]
Stock Position:  -7.786756927964907e-05
Bond Position:  [4.38691015]


portfolio before change:  [4.37950046]
curr_Stock_Price:  102.20037335545724
curr_Factors:  [102.20037336  -0.19123399  -1.10284033]
mat_Sqrt:  [[28.01838833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00163499  0.02758081 -0.02204082]
Stock Position:  -0.0016349913210777283
Bond Position:  [4.54659718]


portfolio before change:  [4.37994323]
curr_Stock_Price:  102.27718726797225
curr_Factors:  [102.27718727  -0.33707256  -1.11202229]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.37994323]
Stock Price:  102.42320340357527
PL:  [1.95673982]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-8.71696664e-02 -7.98169945e-03  4.01594640e-03]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.75173957e-01  2.17452182e-01  2.80186632e-01]
 [-6.74736775e-03  6.57995857e-03  1.01193509e-01]
 [-6.57731959e-01 -1.99459221e-01  3.65803108e-02]
 [ 2.56184072e-03 -1.09282570e-01 -1.33990338e-01]
 [ 3.58665209e-02 -9.04057886e-02 -1.70177094e-02]
 [ 1.86149240e-01 -5.35666732e-02 -2.46147531e-02]
 [-4.31442537e-01 -2.57172622e-02 -3.69684089e-02]
 [ 9.15224867e-02 -3.21231345e-02 -4.19378776e-03]
 [ 5.75806142e-02 -3.86220503e-01  1.46738926e-01]
 [ 1.86040730e-02 -4.62829615e-03 -4.76155015e-04]
 [ 1.65881973e-01 -1.36687665e-01  1.81034902e-01]
 [ 4.26328134e-02 -9.14266894e-02 -7.89959404e-02]
 [ 1.03291346e-02 -9.96146375e-02 -4.81238064e-02]
 [-4.92759857e-02  7.56484671e-02  4.91159219e-02]
 [-4.85450597e-01 -7.04224187e-02  1.62091965e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [-9.21981124e-03  5.13633753e-01  2.38504067e-02]
 [-9.68502282e-04  2.20399168e-02  2.89733760e-02]
 [ 2.31497729e-03 -2.12284807e-01  5.81800879e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 2.70704574e-01  1.70451754e-02  2.45640440e-01]
 [ 6.67429656e-02 -1.60582320e-01 -5.47528993e-02]
 [-1.19910550e-01  2.32896803e-01  2.23637494e-01]
 [ 4.83428468e-03  6.14032308e-02  5.83878247e-02]
 [-3.89868031e-02 -3.41630580e-02  5.47254684e-01]
 [ 1.43577168e-01  8.83741914e-02 -1.03560210e-01]
 [-9.78386026e-01 -1.66210284e-01 -1.34648008e+00]
 [ 1.84693453e-01 -5.02982856e-01  4.82418204e-01]
 [-2.10560543e-01 -3.06973622e-01  1.58121150e-01]
 [ 1.48999394e-01  4.84779872e-01 -1.25281993e-01]
 [-7.86857384e-02  9.02294200e-03  1.01829274e-01]
 [-2.97462929e-02  3.09387913e-01  1.06376205e-02]
 [ 5.40287154e-02 -1.61944214e-01 -1.76002051e-01]
 [-6.54454743e-02  4.09879107e-01  8.85914412e-02]
 [ 2.68854764e-01  1.86317332e-01  1.84755896e-02]
 [ 5.92379217e-02  1.91158894e-02 -1.44001306e-02]
 [-2.25646523e-01 -4.91001861e-01  1.09396151e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.50438014]
curr_Stock_Price:  100.43423883333517
curr_Factors:  [100.43423883  -1.05445647  -0.98209375]
mat_Sqrt:  [[13.10446427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00660508 -0.00252403  0.01145638]
Stock Position:  -0.006605077440574601
Bond Position:  [6.16775606]


portfolio before change:  [5.50326487]
curr_Stock_Price:  100.71982049376864
curr_Factors:  [100.71982049  -0.83384998  -1.02049225]
mat_Sqrt:  [[15.76828087  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.002878    0.01411938  0.0859571 ]
Stock Position:  -0.0028779955926601986
Bond Position:  [5.79313607]


portfolio before change:  [5.50573957]
curr_Stock_Price:  100.11157839742557
curr_Factors:  [100.1115784   -0.81168997  -1.03598271]
mat_Sqrt:  [[15.77793855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02142114 0.06876442 0.79929447]
Stock Position:  0.02142113839161099
Bond Position:  [3.3612356]


portfolio before change:  [5.5101839]
curr_Stock_Price:  100.29943710518559
curr_Factors:  [100.29943711  -0.96021857  -1.01449002]
mat_Sqrt:  [[13.92173788  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00101126 0.00208077 0.28867692]
Stock Position:  0.0010112648837118249
Bond Position:  [5.4087546]


portfolio before change:  [5.51122079]
curr_Stock_Price:  100.65616963027054
curr_Factors:  [100.65616963  -0.77364217  -0.99122653]
mat_Sqrt:  [[17.2332688   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03803196 -0.06307454  0.10435344]
Stock Position:  -0.03803196348812857
Bond Position:  [9.33937256]


portfolio before change:  [5.5534019]
curr_Stock_Price:  99.57777091183854
curr_Factors:  [99.57777091 -0.76108439 -1.00329466]
mat_Sqrt:  [[17.05698679  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161872 -0.03455818 -0.38223714]
Stock Position:  -0.0016187200345694722
Bond Position:  [5.71459044]


portfolio before change:  [5.55474681]
curr_Stock_Price:  99.1882417070671
curr_Factors:  [99.18824171 -0.55994606 -0.96515308]
mat_Sqrt:  [[21.58331006  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139267 -0.02858882 -0.04854679]
Stock Position:  0.0013926746173446188
Bond Position:  [5.41660987]


portfolio before change:  [5.55703841]
curr_Stock_Price:  100.34750624967623
curr_Factors:  [100.34750625  -0.44527564  -0.94883124]
mat_Sqrt:  [[24.89164847  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00722096 -0.01693927 -0.07021904]
Stock Position:  0.0072209636428623375
Bond Position:  [4.83243271]


portfolio before change:  [5.55659325]
curr_Stock_Price:  100.20219974804544
curr_Factors:  [100.20219975  -0.49057472  -0.94233896]
mat_Sqrt:  [[23.90951424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01838819 -0.00813251 -0.10546058]
Stock Position:  -0.018388190331935946
Bond Position:  [7.39913037]


portfolio before change:  [5.58094146]
curr_Stock_Price:  98.92837896409173
curr_Factors:  [98.92837896 -0.2610785  -0.93512266]
mat_Sqrt:  [[29.91006306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00300357 -0.01015823 -0.01196371]
Stock Position:  0.0030035716536109965
Bond Position:  [5.28380298]


portfolio before change:  [5.58631258]
curr_Stock_Price:  100.49671343664117
curr_Factors:  [100.49671344  -0.26949012  -0.91954306]
mat_Sqrt:  [[30.60281008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00253445 -0.12213365  0.41860531]
Stock Position:  0.0025344535764847756
Bond Position:  [5.33160832]


portfolio before change:  [5.58514833]
curr_Stock_Price:  99.77437218422325
curr_Factors:  [99.77437218 -0.31015235 -0.89826391]
mat_Sqrt:  [[29.79960406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00061703 -0.0014636  -0.00135834]
Stock Position:  0.0006170342449516715
Bond Position:  [5.52358413]


portfolio before change:  [5.58550371]
curr_Stock_Price:  99.23126740194279
curr_Factors:  [99.2312674  -0.21967481 -0.89279979]
mat_Sqrt:  [[32.6217277   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00610962 -0.04322443  0.51644219]
Stock Position:  0.0061096183910735865
Bond Position:  [4.97923853]


portfolio before change:  [5.58120378]
curr_Stock_Price:  98.42559224122097
curr_Factors:  [98.42559224 -0.23482741 -0.9168502 ]
mat_Sqrt:  [[31.11292225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00077612 -0.02891166 -0.22535343]
Stock Position:  0.0007761150646007479
Bond Position:  [5.5048142]


portfolio before change:  [5.5835782]
curr_Stock_Price:  100.59829986741516
curr_Factors:  [100.59829987  -0.32455675  -0.92090154]
mat_Sqrt:  [[28.95309373  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.13614612e-05 -3.15009143e-02 -1.37283825e-01]
Stock Position:  -7.136146119648811e-05
Bond Position:  [5.59075704]


portfolio before change:  [5.58413008]
curr_Stock_Price:  102.65833902757397
curr_Factors:  [102.65833903  -0.24012093  -0.93934755]
mat_Sqrt:  [[31.56149597  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118172  0.02392215  0.14011405]
Stock Position:  -0.0011817248806900828
Bond Position:  [5.70544399]


portfolio before change:  [5.58231211]
curr_Stock_Price:  104.80028629184356
curr_Factors:  [104.80028629  -0.28243786  -0.95792339]
mat_Sqrt:  [[30.31659491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0149813  -0.02226952  0.46240326]
Stock Position:  -0.014981300306570574
Bond Position:  [7.15235667]


portfolio before change:  [5.60720698]
curr_Stock_Price:  103.19823820464546
curr_Factors:  [103.1982382   -0.35525361  -0.96083107]
mat_Sqrt:  [[27.67604125  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00474458  0.00580111 -0.05715682]
Stock Position:  -0.004744576096525639
Bond Position:  [6.09683887]


portfolio before change:  [5.59245293]
curr_Stock_Price:  106.4685412782738
curr_Factors:  [106.46854128  -0.42166374  -0.96952217]
mat_Sqrt:  [[26.48725414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00033641 0.16242525 0.06803857]
Stock Position:  0.00033641082813019076
Bond Position:  [5.55663576]


portfolio before change:  [5.59220695]
curr_Stock_Price:  103.67256775556663
curr_Factors:  [103.67256776  -0.59394536  -0.95066796]
mat_Sqrt:  [[22.12314243  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00024927 0.00696963 0.08265298]
Stock Position:  0.0002492743309282474
Bond Position:  [5.56636404]


portfolio before change:  [5.59292485]
curr_Stock_Price:  103.7610593132722
curr_Factors:  [103.76105931  -0.54021422  -0.96129934]
mat_Sqrt:  [[23.1172061   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00037677 -0.06713035  0.1659716 ]
Stock Position:  0.0003767655922159927
Bond Position:  [5.55383125]


portfolio before change:  [5.59436618]
curr_Stock_Price:  105.74386570438872
curr_Factors:  [105.7438657   -0.37769699  -0.95862827]
mat_Sqrt:  [[27.79050872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139864  0.01916992 -0.08961985]
Stock Position:  -0.001398638077536776
Bond Position:  [5.74226357]


portfolio before change:  [5.59395177]
curr_Stock_Price:  106.55339501831266
curr_Factors:  [106.55339502  -0.27523099  -0.94733826]
mat_Sqrt:  [[31.37705739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01023951 0.00539016 0.7007438 ]
Stock Position:  0.010239514144285991
Bond Position:  [4.50289677]


portfolio before change:  [5.6038769]
curr_Stock_Price:  107.4677193024201
curr_Factors:  [107.4677193   -0.14086426  -0.96081102]
mat_Sqrt:  [[35.71301694  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00143982 -0.05078059 -0.15619478]
Stock Position:  0.0014398212055687742
Bond Position:  [5.4491426]


portfolio before change:  [5.60507379]
curr_Stock_Price:  107.82589556294877
curr_Factors:  [107.82589556  -0.48900416  -0.96476254]
mat_Sqrt:  [[25.19766048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270848  0.07364844  0.63797552]
Stock Position:  -0.002708480342055457
Bond Position:  [5.89711811]


portfolio before change:  [5.60225729]
curr_Stock_Price:  109.13795769481284
curr_Factors:  [109.13795769  -0.24111352  -0.99388991]
mat_Sqrt:  [[31.74100291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00057774 0.01941741 0.16656421]
Stock Position:  0.0005777408528344028
Bond Position:  [5.53920383]


portfolio before change:  [5.60352591]
curr_Stock_Price:  110.13525809144805
curr_Factors:  [ 1.10135258e+02 -9.64924585e-02 -9.83748815e-01]
mat_Sqrt:  [[37.39241797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00192122 -0.01080331  1.56116529]
Stock Position:  0.0019212185013597976
Bond Position:  [5.39193202]


portfolio before change:  [5.60422441]
curr_Stock_Price:  110.14799341080564
curr_Factors:  [110.14799341  -0.21686622  -0.9487706 ]
mat_Sqrt:  [[34.33578262  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00363236  0.02794637 -0.29542845]
Stock Position:  0.0036323575795534466
Bond Position:  [5.20412751]


portfolio before change:  [5.60438219]
curr_Stock_Price:  110.01233031580647
curr_Factors:  [110.01233032  -0.34482562  -0.90824414]
mat_Sqrt:  [[31.42245296  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04002    -0.05256031 -3.84113288]
Stock Position:  -0.040020002729755214
Bond Position:  [10.00707595]


portfolio before change:  [5.49782167]
curr_Stock_Price:  112.70627023018642
curr_Factors:  [112.70627023  -0.71433156  -0.89441398]
mat_Sqrt:  [[22.55686623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01197771 -0.15905714  1.37620486]
Stock Position:  0.011977714096612056
Bond Position:  [4.14785819]


portfolio before change:  [5.487401]
curr_Stock_Price:  111.79297527851871
curr_Factors:  [111.79297528  -0.65549288  -0.90192028]
mat_Sqrt:  [[23.5525848   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00790615 -0.09707358  0.45107563]
Stock Position:  -0.00790614807240607
Bond Position:  [6.37125282]


portfolio before change:  [5.47964633]
curr_Stock_Price:  112.87455460245447
curr_Factors:  [112.8745546   -0.53825888  -0.90222668]
mat_Sqrt:  [[26.73013274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00508577  0.15330086 -0.35739465]
Stock Position:  0.005085768844615015
Bond Position:  [4.90559244]


portfolio before change:  [5.47337747]
curr_Stock_Price:  111.52134783005855
curr_Factors:  [111.52134783  -0.44368072  -0.90535077]
mat_Sqrt:  [[28.93883716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199272  0.0028533   0.29049057]
Stock Position:  -0.0019927184081281334
Bond Position:  [5.69560811]


portfolio before change:  [5.47693438]
curr_Stock_Price:  110.09369514229044
curr_Factors:  [110.09369514  -0.35209616  -0.91905   ]
mat_Sqrt:  [[30.88237463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063423  0.09783705  0.03034617]
Stock Position:  -0.0006342302491333802
Bond Position:  [5.54675913]


portfolio before change:  [5.47620188]
curr_Stock_Price:  112.34191505072039
curr_Factors:  [112.34191505  -0.38048157  -0.92829116]
mat_Sqrt:  [[30.34932582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.58694396e-04 -5.12112572e-02 -5.02084861e-01]
Stock Position:  0.0004586943963297334
Bond Position:  [5.42467127]


portfolio before change:  [5.47626114]
curr_Stock_Price:  110.99274278891026
curr_Factors:  [110.99274279  -0.4380394   -0.94994451]
mat_Sqrt:  [[27.70134341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132769  0.12961515  0.25272672]
Stock Position:  -0.0013276897270135526
Bond Position:  [5.62362507]


portfolio before change:  [5.47642782]
curr_Stock_Price:  111.3966938752505
curr_Factors:  [111.39669388  -0.58595399  -0.94150698]
mat_Sqrt:  [[24.18267991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01147254 0.05891871 0.05270571]
Stock Position:  0.011472540354364092
Bond Position:  [4.19842475]


portfolio before change:  [5.48924224]
curr_Stock_Price:  112.4679109744115
curr_Factors:  [112.46791097  -0.83467353  -0.9288361 ]
mat_Sqrt:  [[19.28173576  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00294538  0.00604498 -0.04107956]
Stock Position:  0.0029453820002849533
Bond Position:  [5.15798128]


portfolio before change:  [5.49085156]
curr_Stock_Price:  112.79538497188553
curr_Factors:  [112.79538497  -0.56933734  -0.93721723]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.49085156]
Stock Price:  112.30183761608961
PL:  [-6.81098606]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.01433131e-01  2.87225049e-02  4.88078575e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.39456213e-01  1.68433462e-01  2.22832070e-01]
 [-4.26939287e-03  7.49320259e-04  9.56471692e-02]
 [-5.45705187e-01 -1.67726328e-01  3.93179574e-02]
 [-5.07506371e-02 -7.02106134e-03  2.10905142e-02]
 [ 1.54289246e-02  1.22937193e-01  4.80548652e-02]
 [ 2.91754524e-01 -3.67009139e-02 -6.60779338e-02]
 [-4.36857121e-01 -2.38983138e-02 -4.70361002e-02]
 [ 3.90665902e-02 -3.13805934e-03 -3.47728558e-02]
 [-4.39976591e-03 -2.37391695e-01  1.08692857e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.76266818e-01 -1.00314220e-01  2.68466170e-01]
 [ 7.86901165e-02  1.20631320e-01  8.22393572e-02]
 [ 4.25417572e-02 -1.05203281e-01 -5.64223066e-02]
 [-2.37123256e-02 -1.03726927e-01 -6.50404808e-03]
 [-4.74551191e-01 -2.68305023e-01  1.30430074e-01]
 [-2.22001358e-01 -1.00956323e-01 -3.46730275e-02]
 [ 2.97827122e-01  1.21177822e+00  4.30488667e-01]
 [-2.24226302e-01 -3.33903453e-02  1.75478540e-01]
 [-9.36369111e-02  2.14265784e-01 -3.39520640e-02]
 [-1.81174388e-02  2.72450063e-02 -1.95393603e-03]
 [ 3.08524071e-03 -2.88045900e-02 -2.47252852e-03]
 [ 4.32989697e-02  1.90358990e-01  1.10158025e-01]
 [-7.29484095e-02 -1.30649306e-01 -4.60158483e-03]
 [ 8.84047259e-02  1.75479213e-02 -9.44453968e-03]
 [ 3.04098711e-02 -6.73571588e-02  7.84949382e-02]
 [ 4.38355904e-02  4.52221133e-02 -6.44305910e-02]
 [-8.34347345e-01 -2.29823276e-01 -1.33181484e+00]
 [ 3.91041968e-02 -1.35801107e-01  1.30920370e-01]
 [ 1.09939953e-02 -1.82980645e-01  1.21094785e-01]
 [ 3.36902699e-02  1.63999389e-01 -4.25072043e-02]
 [-1.33166318e-01 -1.54912099e-02 -1.20050087e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 3.24524487e-02 -2.45437298e-02  4.84257337e-02]
 [-4.63483091e-03  1.18094630e-01  7.89709604e-02]
 [ 3.03536203e-02  2.63992690e-02 -3.61596198e-02]
 [-7.72419773e-02  1.26376176e-01 -8.48272705e-04]
 [-3.81019269e-02 -2.70129802e-01  1.09591094e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.56693296]
curr_Stock_Price:  100.1642943833969
curr_Factors:  [100.16429438  -0.82560459  -1.00958594]
mat_Sqrt:  [[15.98452798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00567603  0.00908285  0.13923523]
Stock Position:  -0.005676029776911369
Bond Position:  [4.13546847]


portfolio before change:  [3.57092322]
curr_Stock_Price:  99.552370992815
curr_Factors:  [99.55237099 -0.85777381 -1.01539658]
mat_Sqrt:  [[15.29480847  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296709  0.01411938  0.0859571 ]
Stock Position:  -0.0029670880104032435
Bond Position:  [3.86630386]


portfolio before change:  [3.57003714]
curr_Stock_Price:  100.01389836800739
curr_Factors:  [100.01389837  -1.06856304  -0.99459245]
mat_Sqrt:  [[12.70700816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02276622 0.05326334 0.63567787]
Stock Position:  0.022766220682209196
Bond Position:  [1.29309866]


portfolio before change:  [3.57807511]
curr_Stock_Price:  100.35986341508712
curr_Factors:  [100.35986342  -0.98808277  -1.0046499 ]
mat_Sqrt:  [[13.68129665  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.11640377e-03 2.36955872e-04 2.72854751e-01]
Stock Position:  0.0011164037694555012
Bond Position:  [3.46603298]


portfolio before change:  [3.57860527]
curr_Stock_Price:  100.44664652707046
curr_Factors:  [100.44664653  -0.67277007  -1.00983237]
mat_Sqrt:  [[18.67198486  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02902799 -0.05303972  0.11216319]
Stock Position:  -0.029027986149457445
Bond Position:  [6.49436914]


portfolio before change:  [3.55393863]
curr_Stock_Price:  101.32436821705092
curr_Factors:  [101.32436822  -0.69128158  -1.02262431]
mat_Sqrt:  [[18.25467189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255424 -0.00222025  0.06016537]
Stock Position:  -0.0025542413057655336
Bond Position:  [3.81274551]


portfolio before change:  [3.55345843]
curr_Stock_Price:  101.69896888166555
curr_Factors:  [101.69896888  -0.93661023  -1.00795086]
mat_Sqrt:  [[14.54803715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.001953   0.03887615 0.13708715]
Stock Position:  0.00195299938165244
Bond Position:  [3.35484041]


portfolio before change:  [3.5511082]
curr_Stock_Price:  100.28083804570555
curr_Factors:  [100.28083805  -0.95150118  -0.97234339]
mat_Sqrt:  [[14.64545528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01893549 -0.01160585 -0.18850195]
Stock Position:  0.018935485677740175
Bond Position:  [1.65224183]


portfolio before change:  [3.55111594]
curr_Stock_Price:  100.27033925972151
curr_Factors:  [100.27033926  -0.86551178  -0.94777442]
mat_Sqrt:  [[16.35581878  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02733433 -0.00755731 -0.1341809 ]
Stock Position:  -0.027334331735047485
Bond Position:  [6.29193866]


portfolio before change:  [3.53119022]
curr_Stock_Price:  101.02807758523407
curr_Factors:  [101.02807759  -1.09119916  -0.92401678]
mat_Sqrt:  [[13.4661959   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00236797 -0.00099234 -0.09919728]
Stock Position:  0.002367972857945181
Bond Position:  [3.29195847]


portfolio before change:  [3.53147163]
curr_Stock_Price:  100.97313552059947
curr_Factors:  [100.97313552  -1.28022415  -0.89917194]
mat_Sqrt:  [[11.42105302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00102072 -0.07506985  0.31007047]
Stock Position:  0.0010207152928249088
Bond Position:  [3.42840681]


portfolio before change:  [3.53280989]
curr_Stock_Price:  101.86434870904372
curr_Factors:  [101.86434871  -1.20594644  -0.90933693]
mat_Sqrt:  [[12.28474992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00587115  0.00225658  0.15019092]
Stock Position:  -0.005871150740092648
Bond Position:  [4.13087083]


portfolio before change:  [3.54097702]
curr_Stock_Price:  100.56124105450638
curr_Factors:  [100.56124105  -1.04752607  -0.89358997]
mat_Sqrt:  [[14.43492869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01582808 -0.03172214  0.76585926]
Stock Position:  0.01582807563834234
Bond Position:  [1.94928609]


portfolio before change:  [3.53061467]
curr_Stock_Price:  99.89116396070187
curr_Factors:  [99.89116396 -0.94954692 -0.88455153]
mat_Sqrt:  [[15.95835926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00617807 0.03814697 0.234606  ]
Stock Position:  0.006178068855216011
Bond Position:  [2.91348018]


portfolio before change:  [3.53332247]
curr_Stock_Price:  100.2705056763915
curr_Factors:  [100.27050568  -0.97756591  -0.89958734]
mat_Sqrt:  [[15.34390521  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00184492 -0.0332682  -0.16095714]
Stock Position:  0.0018449191832636427
Bond Position:  [3.34833149]


portfolio before change:  [3.53164877]
curr_Stock_Price:  99.13643589092496
curr_Factors:  [99.13643589 -1.15377447 -0.86295416]
mat_Sqrt:  [[13.19408227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0021008  -0.03280133 -0.01855424]
Stock Position:  -0.0021008036837136855
Bond Position:  [3.73991496]


portfolio before change:  [3.531216]
curr_Stock_Price:  99.5649798409661
curr_Factors:  [99.56497984 -1.22570073 -0.86965   ]
mat_Sqrt:  [[12.24918949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03713347 -0.0848455   0.3720807 ]
Stock Position:  -0.03713346666502459
Bond Position:  [7.22840886]


portfolio before change:  [3.55910015]
curr_Stock_Price:  98.83839712863951
curr_Factors:  [98.83839713 -0.979453   -0.85047077]
mat_Sqrt:  [[15.85622862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01461165 -0.03192519 -0.0989125 ]
Stock Position:  -0.014611648605085056
Bond Position:  [5.00329207]


portfolio before change:  [3.5668232]
curr_Stock_Price:  98.35264721681618
curr_Factors:  [98.35264722 -0.91464646 -0.82545347]
mat_Sqrt:  [[17.2611711   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02415759 0.38319792 1.22806434]
Stock Position:  0.024157586423199134
Bond Position:  [1.19086063]


portfolio before change:  [3.56778566]
curr_Stock_Price:  98.38632550339109
curr_Factors:  [98.3863255  -0.91061337 -0.81708972]
mat_Sqrt:  [[17.4824714   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01082622 -0.01055895  0.50059143]
Stock Position:  -0.010826217043729856
Bond Position:  [4.63293737]


portfolio before change:  [3.57369989]
curr_Stock_Price:  97.8935330485448
curr_Factors:  [97.89353305 -0.66673948 -0.79812145]
mat_Sqrt:  [[22.62418728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00420059  0.06775679 -0.09685579]
Stock Position:  -0.004200594135539879
Bond Position:  [3.98491089]


portfolio before change:  [3.56997145]
curr_Stock_Price:  98.8997202779678
curr_Factors:  [98.89972028 -0.57301055 -0.83090137]
mat_Sqrt:  [[24.29315167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073324  0.00861563 -0.00557404]
Stock Position:  -0.0007332445594461312
Bond Position:  [3.64248913]


portfolio before change:  [3.57041842]
curr_Stock_Price:  98.91113830161628
curr_Factors:  [98.9111383  -0.66095385 -0.82438174]
mat_Sqrt:  [[22.39608727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.20146217e-05 -9.10881115e-03 -7.05343564e-03]
Stock Position:  8.201462169994382e-05
Bond Position:  [3.56230626]


portfolio before change:  [3.57088739]
curr_Stock_Price:  99.19960153268075
curr_Factors:  [99.19960153 -0.59303429 -0.80316656]
mat_Sqrt:  [[24.55543323  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0028792  0.0601968  0.31425018]
Stock Position:  0.0028791970313272993
Bond Position:  [3.28527219]


portfolio before change:  [3.57187688]
curr_Stock_Price:  99.40063061701854
curr_Factors:  [99.40063062 -0.43194867 -0.80760368]
mat_Sqrt:  [[28.77785337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268474 -0.04131494 -0.01312704]
Stock Position:  -0.0026847400198096423
Bond Position:  [3.83874173]


portfolio before change:  [3.57162401]
curr_Stock_Price:  99.67355910421732
curr_Factors:  [99.6735591  -0.36441595 -0.79653756]
mat_Sqrt:  [[31.21650411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00278474  0.00554914 -0.02694264]
Stock Position:  0.002784743364787709
Bond Position:  [3.29405873]


portfolio before change:  [3.57185377]
curr_Stock_Price:  99.6081951392239
curr_Factors:  [99.60819514 -0.24881028 -0.81673127]
mat_Sqrt:  [[34.31912867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00130229 -0.0213002   0.22392421]
Stock Position:  0.0013022891503123202
Bond Position:  [3.4421351]


portfolio before change:  [3.57316193]
curr_Stock_Price:  100.2822921446351
curr_Factors:  [ 1.00282292e+02 -7.04101188e-03 -8.67247004e-01]
mat_Sqrt:  [[41.83365315  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00076138  0.01430049 -0.18380254]
Stock Position:  0.0007613817734305025
Bond Position:  [3.49680882]


portfolio before change:  [3.57583032]
curr_Stock_Price:  103.2128331716343
curr_Factors:  [ 1.03212833e+02  3.96830121e-02 -9.03360080e-01]
mat_Sqrt:  [[43.51545359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02555729 -0.0726765  -3.79929704]
Stock Position:  -0.02555728668439901
Bond Position:  [6.21367029]


portfolio before change:  [3.51660678]
curr_Stock_Price:  105.56051189831842
curr_Factors:  [ 1.05560512e+02 -6.04178814e-02 -8.97964151e-01]
mat_Sqrt:  [[40.48381759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00153943 -0.04294408  0.37347938]
Stock Position:  0.001539425867047613
Bond Position:  [3.3541042]


portfolio before change:  [3.51898255]
curr_Stock_Price:  106.83142385064836
curr_Factors:  [ 1.06831424e+02  3.08757496e-02 -8.85995233e-01]
mat_Sqrt:  [[45.42818061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068213 -0.05786356  0.34544972]
Stock Position:  0.0006821277984554935
Bond Position:  [3.44610986]


portfolio before change:  [3.51731591]
curr_Stock_Price:  103.75660223704305
curr_Factors:  [103.75660224   0.18014869  -0.87773946]
mat_Sqrt:  [[51.64828674  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056629  0.05186116 -0.12126122]
Stock Position:  0.0005662911790392566
Bond Position:  [3.45855947]


portfolio before change:  [3.51583816]
curr_Stock_Price:  100.38360073169446
curr_Factors:  [100.38360073   0.21067281  -0.8883478 ]
mat_Sqrt:  [[50.97441664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003101   -0.00489875 -0.34246948]
Stock Position:  -0.003100995182439296
Bond Position:  [3.82712722]


portfolio before change:  [3.5175624]
curr_Stock_Price:  99.98185363407127
curr_Factors:  [99.98185363  0.14036483 -0.89806921]
mat_Sqrt:  [[46.86561837  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111838  0.0049611   0.16678008]
Stock Position:  -0.0011183828441193964
Bond Position:  [3.62938039]


portfolio before change:  [3.51777135]
curr_Stock_Price:  100.20069680467283
curr_Factors:  [100.2006968    0.31015082  -0.92306725]
mat_Sqrt:  [[54.28558415  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00076823 -0.00776141  0.13814514]
Stock Position:  0.0007682259386834788
Bond Position:  [3.44079457]


portfolio before change:  [3.51844473]
curr_Stock_Price:  100.51733997535767
curr_Factors:  [ 1.00517340e+02  8.10200351e-02 -9.43265614e-01]
mat_Sqrt:  [[42.43971805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00034247 0.0373448  0.22528217]
Stock Position:  0.0003424678528380943
Bond Position:  [3.48402077]


portfolio before change:  [3.51852268]
curr_Stock_Price:  99.47322156938797
curr_Factors:  [ 9.94732216e+01  3.97066213e-02 -9.47301013e-01]
mat_Sqrt:  [[40.13681874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00058934  0.00834818 -0.10315333]
Stock Position:  0.0005893390601151546
Bond Position:  [3.45989923]


portfolio before change:  [3.51842822]
curr_Stock_Price:  98.57904854319673
curr_Factors:  [98.57904854  0.12130464 -0.94761457]
mat_Sqrt:  [[43.14423561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017187   0.03996366 -0.00241989]
Stock Position:  -0.001718702634495298
Bond Position:  [3.68785629]


portfolio before change:  [3.51550723]
curr_Stock_Price:  100.5468134991052
curr_Factors:  [ 1.00546813e+02 -7.13695738e-02 -9.52617945e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.51550723]
Stock Price:  100.70855268995439
PL:  [2.80695454]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.10876532e-01  2.99582726e-01  3.52884671e-01]
 [-1.02526455e-01  3.72568984e-02  9.52762435e-02]
 [ 2.53490008e-01  3.58002533e-01  5.19282696e-01]
 [-1.63802873e-02  4.21771676e-02  1.26428574e-01]
 [ 1.16663064e-01 -5.40657323e-02  9.82552295e-02]
 [ 1.27272220e-01 -2.92660501e-01 -4.08480882e-01]
 [ 1.41945095e-02 -3.58144002e-01 -5.53969898e-02]
 [ 1.26411168e-01  2.63660734e-01 -3.38584465e-02]
 [-1.63746074e-01  1.55471749e-02 -9.16182247e-02]
 [ 4.97203029e-02 -2.12375718e-02 -4.32541794e-02]
 [ 8.09583871e-02 -2.41416946e-01  5.54127026e-03]
 [-8.52049896e-03 -3.51952983e-02 -7.37352859e-02]
 [ 2.17338778e-01 -1.99316773e-01  1.07558062e-01]
 [ 9.51916448e-02 -3.28187006e-02 -7.29857083e-02]
 [ 6.04475929e-02 -1.08733648e-01 -6.09175780e-02]
 [-4.93945145e-02  6.92197165e-02  4.58070898e-02]
 [-4.58852335e-01 -2.59824172e-01  1.23574652e-01]
 [-1.32282797e-01  1.80466734e-02 -1.62161846e-02]
 [ 2.83786189e-01  1.20379738e+00  4.16178530e-01]
 [ 7.17732376e-03  1.38929504e-02  3.01868140e-02]
 [-7.96423099e-02  4.67022801e-02 -3.57881961e-02]
 [-7.26481385e-03  3.97892352e-02 -8.73705656e-03]
 [ 4.53951360e-02 -3.35399572e-02  6.33875292e-02]
 [ 5.18172425e-02  1.43734541e-01  7.80114359e-02]
 [-5.81023928e-02 -1.77445814e-01 -1.95933325e-02]
 [ 2.02759931e-02  6.18202882e-02 -1.49393001e-02]
 [-1.76258802e-02  3.90821455e-03 -4.96370722e-02]
 [ 1.57255897e-02  4.60073618e-02 -7.73460913e-02]
 [-6.46663363e-01 -7.52417933e-02 -9.81412761e-01]
 [-2.48211286e-01  9.08489926e-02  6.40882112e-03]
 [-7.53454776e-03  4.15836771e-02  1.35987952e-01]
 [ 2.06211411e-02  8.10003004e-02 -2.86113711e-03]
 [-1.27837098e-01 -1.30932672e-02 -9.83461343e-02]
 [-6.27703615e-02  6.31501387e-02  8.85641136e-02]
 [ 1.81100333e-01 -1.65506987e-01 -9.23906170e-02]
 [-1.36375829e-02  1.82687132e-01  8.11365915e-02]
 [ 2.81335624e-02  2.72911465e-02 -4.18077012e-02]
 [-4.44470059e-02  8.57209309e-02 -7.93424719e-03]
 [-9.36786029e-02 -1.82110760e-01  3.91533152e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.958077]
curr_Stock_Price:  98.97650503765063
curr_Factors:  [98.97650504 -0.8041884  -0.99204578]
mat_Sqrt:  [[16.42243386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00798353  0.09473638  1.00668174]
Stock Position:  -0.007983533873287657
Bond Position:  [-4.16789472]


portfolio before change:  [-4.95593081]
curr_Stock_Price:  98.64241610509895
curr_Factors:  [98.64241611 -0.80458761 -0.99446886]
mat_Sqrt:  [[16.32087379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00503137  0.01178167  0.2717966 ]
Stock Position:  -0.005031366919141502
Bond Position:  [-4.45962462]


portfolio before change:  [-4.95668486]
curr_Stock_Price:  98.68148363537647
curr_Factors:  [98.68148364 -0.72519569 -1.02000575]
mat_Sqrt:  [[17.23075526  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02139963 0.11321034 1.48136899]
Stock Position:  0.021399626679749262
Bond Position:  [-7.06843177]


portfolio before change:  [-4.95116585]
curr_Stock_Price:  98.9806766831644
curr_Factors:  [98.98067668 -0.77191866 -1.04336393]
mat_Sqrt:  [[16.11325224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00065262 0.01333759 0.36066553]
Stock Position:  0.0006526210200821771
Bond Position:  [-5.01576272]


portfolio before change:  [-4.95348825]
curr_Stock_Price:  96.38286467689957
curr_Factors:  [96.38286468 -0.75556848 -1.0309445 ]
mat_Sqrt:  [[16.14831076  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00838003 -0.01709709  0.28029482]
Stock Position:  0.008380031789645337
Bond Position:  [-5.76117972]


portfolio before change:  [-4.95615472]
curr_Stock_Price:  96.15061276879139
curr_Factors:  [96.15061277 -0.9136406  -1.03300361]
mat_Sqrt:  [[13.72572267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00264722 -0.09254738 -1.16528226]
Stock Position:  0.0026472156217970154
Bond Position:  [-5.21068612]


portfolio before change:  [-4.95464101]
curr_Stock_Price:  96.96848524895462
curr_Factors:  [96.96848525 -0.69030609 -1.03487293]
mat_Sqrt:  [[17.27407822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036822 -0.11325508 -0.15803219]
Stock Position:  -0.00036821600203490473
Bond Position:  [-4.91893566]


portfolio before change:  [-4.95536424]
curr_Stock_Price:  97.26268628156136
curr_Factors:  [97.26268628 -0.77082734 -1.0338032 ]
mat_Sqrt:  [[16.0031389   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00789267  0.08337684 -0.09658872]
Stock Position:  0.007892672405328512
Bond Position:  [-5.72302677]


portfolio before change:  [-4.95048866]
curr_Stock_Price:  97.97106558366255
curr_Factors:  [97.97106558 -0.82167591 -1.03840802]
mat_Sqrt:  [[15.2501336   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01193735  0.00491645 -0.26136129]
Stock Position:  -0.011937347202153132
Bond Position:  [-3.78097404]


portfolio before change:  [-4.97202096]
curr_Stock_Price:  99.73524739789069
curr_Factors:  [99.7352474  -0.93161262 -1.0297818 ]
mat_Sqrt:  [[14.02897357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00287567 -0.00671591 -0.12339213]
Stock Position:  0.0028756721597358705
Bond Position:  [-5.25882684]


portfolio before change:  [-4.97642043]
curr_Stock_Price:  98.433963347636
curr_Factors:  [98.43396335 -1.0245506  -1.0295849 ]
mat_Sqrt:  [[12.6195904   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00601098 -0.07634274  0.0158077 ]
Stock Position:  0.0060109823665431324
Bond Position:  [-5.56810524]


portfolio before change:  [-4.97583152]
curr_Stock_Price:  98.64773167868222
curr_Factors:  [98.64773168 -0.99419063 -1.04402508]
mat_Sqrt:  [[12.84994499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019051  -0.01112973 -0.21034625]
Stock Position:  -0.0019050968611777513
Bond Position:  [-4.78789804]


portfolio before change:  [-4.97687586]
curr_Stock_Price:  98.88174214425642
curr_Factors:  [98.88174214 -0.98634476 -1.03588029]
mat_Sqrt:  [[13.0880496   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01789019 -0.0630295   0.30683321]
Stock Position:  0.017890185794215654
Bond Position:  [-6.7458886]


portfolio before change:  [-4.96398844]
curr_Stock_Price:  99.64924182230091
curr_Factors:  [99.64924182 -1.13617458 -1.03889381]
mat_Sqrt:  [[11.32019215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00701809 -0.01037818 -0.20820791]
Stock Position:  0.007018089736207868
Bond Position:  [-5.66333576]


portfolio before change:  [-4.96323298]
curr_Stock_Price:  99.85776245961077
curr_Factors:  [99.85776246 -0.90242996 -1.05015952]
mat_Sqrt:  [[14.17042886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00319012 -0.0343846  -0.17378089]
Stock Position:  0.0031901189507559245
Bond Position:  [-5.28179112]


portfolio before change:  [-4.96298239]
curr_Stock_Price:  100.14328613975901
curr_Factors:  [100.14328614  -1.03240644  -1.04450796]
mat_Sqrt:  [[12.54958523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304846  0.0218892   0.13067488]
Stock Position:  -0.003048462191639907
Bond Position:  [-4.65769937]


portfolio before change:  [-4.962754]
curr_Stock_Price:  99.87736827678505
curr_Factors:  [99.87736828 -1.08502042 -1.02802977]
mat_Sqrt:  [[12.07205079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03647569 -0.08216362  0.35252409]
Stock Position:  -0.036475691160340384
Bond Position:  [-1.31965796]


portfolio before change:  [-5.00087694]
curr_Stock_Price:  100.91800577585114
curr_Factors:  [100.91800578  -0.91821403  -1.03583823]
mat_Sqrt:  [[14.29995096  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00944947  0.00570686 -0.04626026]
Stock Position:  -0.009449469401316309
Bond Position:  [-4.04725533]


portfolio before change:  [-5.00059083]
curr_Stock_Price:  100.83418652440312
curr_Factors:  [100.83418652  -0.92371841  -1.06320308]
mat_Sqrt:  [[13.82607031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02891785 0.38067416 1.1872415 ]
Stock Position:  0.028917847307924075
Bond Position:  [-7.91649844]


portfolio before change:  [-4.98744154]
curr_Stock_Price:  101.32312056441795
curr_Factors:  [101.32312056  -1.08726667  -1.08302279]
mat_Sqrt:  [[11.56548416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00118438 0.00439334 0.08611458]
Stock Position:  0.001184377204327781
Bond Position:  [-5.10744633]


portfolio before change:  [-4.98914498]
curr_Stock_Price:  100.42393683271762
curr_Factors:  [100.42393683  -1.18553737  -1.06139777]
mat_Sqrt:  [[10.61709508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00807582  0.01476856 -0.10209376]
Stock Position:  -0.008075815142554487
Bond Position:  [-4.17813983]


portfolio before change:  [-4.99033076]
curr_Stock_Price:  100.50609371855657
curr_Factors:  [100.50609372  -1.19741886  -1.07077234]
mat_Sqrt:  [[10.40230235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00077107  0.01258246 -0.02492439]
Stock Position:  -0.0007710701102760965
Bond Position:  [-4.91283352]


portfolio before change:  [-4.99117633]
curr_Stock_Price:  100.80622795897918
curr_Factors:  [100.80622796  -1.29587067  -1.0774445 ]
mat_Sqrt:  [[ 9.39225086  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00611867 -0.01060627  0.18082698]
Stock Position:  0.006118667833161125
Bond Position:  [-5.60797616]


portfolio before change:  [-4.99352954]
curr_Stock_Price:  100.53620724824036
curr_Factors:  [100.53620725  -1.25380037  -1.08915547]
mat_Sqrt:  [[ 9.6558321   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00739993 0.04545285 0.22254491]
Stock Position:  0.00739992880581291
Bond Position:  [-5.73749032]


portfolio before change:  [-4.99504786]
curr_Stock_Price:  100.42795122067098
curr_Factors:  [100.42795122  -1.07245252  -1.07522524]
mat_Sqrt:  [[11.72546311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00568707 -0.05611329 -0.05589432]
Stock Position:  -0.005687067163072993
Bond Position:  [-4.42390735]


portfolio before change:  [-5.00070294]
curr_Stock_Price:  101.3250853908103
curr_Factors:  [101.32508539  -1.12112265  -1.05326969]
mat_Sqrt:  [[11.51835307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00163415  0.01954929 -0.04261767]
Stock Position:  0.0016341497881237324
Bond Position:  [-5.16628331]


portfolio before change:  [-5.00150538]
curr_Stock_Price:  101.22924939806488
curr_Factors:  [101.2292494   -1.18950684  -1.03900767]
mat_Sqrt:  [[10.90120386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253707  0.00123589 -0.14160075]
Stock Position:  -0.0025370680018604206
Bond Position:  [-4.74467989]


portfolio before change:  [-5.00322118]
curr_Stock_Price:  101.6717589773596
curr_Factors:  [101.67175898  -1.05652317  -1.01094829]
mat_Sqrt:  [[12.8620113   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.74894210e-05  1.45488052e-02 -2.20646870e-01]
Stock Position:  8.748942098314791e-05
Bond Position:  [-5.01211638]


portfolio before change:  [-5.00376377]
curr_Stock_Price:  102.63142438309528
curr_Factors:  [102.63142438  -1.15110794  -1.01083044]
mat_Sqrt:  [[11.81306107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0718642  -0.02379354 -2.79969743]
Stock Position:  -0.07186419625928128
Bond Position:  [2.37176105]


portfolio before change:  [-5.02022871]
curr_Stock_Price:  102.86466191747995
curr_Factors:  [102.86466192  -0.89345008  -0.98399395]
mat_Sqrt:  [[15.73629979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01554097  0.02872897  0.01828258]
Stock Position:  -0.015540971100781798
Bond Position:  [-3.42161197]


portfolio before change:  [-5.01259475]
curr_Stock_Price:  102.34592437882087
curr_Factors:  [102.34592438  -0.81487939  -0.96706059]
mat_Sqrt:  [[17.22597665  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00123636 0.01314991 0.38793578]
Stock Position:  0.00123636314851449
Bond Position:  [-5.13913148]


portfolio before change:  [-5.01180071]
curr_Stock_Price:  103.50778065995794
curr_Factors:  [103.50778066  -0.73326003  -0.97219774]
mat_Sqrt:  [[18.80624528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117666  0.02561454 -0.00816203]
Stock Position:  0.001176658731493662
Bond Position:  [-5.13359404]


portfolio before change:  [-5.01358569]
curr_Stock_Price:  102.53618095352985
curr_Factors:  [102.53618095  -0.58366518  -0.96521241]
mat_Sqrt:  [[21.78753751  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00680435 -0.00414045 -0.28055415]
Stock Position:  -0.006804347889974297
Bond Position:  [-4.31589384]


portfolio before change:  [-5.01976516]
curr_Stock_Price:  103.36505613297757
curr_Factors:  [103.36505613  -0.47889268  -0.97814476]
mat_Sqrt:  [[24.07633779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178855  0.01996983  0.25264876]
Stock Position:  -0.0017885509972762625
Bond Position:  [-4.83489149]


portfolio before change:  [-5.02186314]
curr_Stock_Price:  104.20012975863284
curr_Factors:  [104.20012976  -0.81379073  -0.98424524]
mat_Sqrt:  [[17.25802757  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00915329 -0.0523379  -0.26356471]
Stock Position:  0.00915329429604359
Bond Position:  [-5.97563759]


portfolio before change:  [-5.02632018]
curr_Stock_Price:  103.7948067777903
curr_Factors:  [103.79480678  -0.5043759   -0.98392193]
mat_Sqrt:  [[23.43236323  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0003261  0.05777074 0.23146011]
Stock Position:  0.00032610095168000846
Bond Position:  [-5.06016776]


portfolio before change:  [-5.02746838]
curr_Stock_Price:  102.2135637065778
curr_Factors:  [102.21356371  -0.36847948  -0.94653773]
mat_Sqrt:  [[27.44124512  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073992  0.00863022 -0.11926573]
Stock Position:  0.0007399174290617701
Bond Position:  [-5.10309798]


portfolio before change:  [-5.02731069]
curr_Stock_Price:  103.28884421454639
curr_Factors:  [103.28884421  -0.54921288  -0.96184262]
mat_Sqrt:  [[22.79346505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192394  0.02710734 -0.0226342 ]
Stock Position:  -0.0019239405839654076
Bond Position:  [-4.82858909]


portfolio before change:  [-5.03125461]
curr_Stock_Price:  105.0250257856183
curr_Factors:  [105.02502579  -0.50771281  -0.96161107]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.03125461]
Stock Price:  103.3282040295836
PL:  [-8.35945864]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-7.61180419e-02  1.19844478e-01  9.34316336e-02]
 [ 1.15743712e-03 -4.06212497e-02 -1.21843320e-01]
 [ 3.73861927e-01  3.37410865e-01  4.14299945e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.01640707e+00 -2.45858888e-01 -2.76424354e-01]
 [ 4.17959497e-02  1.04594013e-01  1.17201557e-01]
 [-3.29913230e-02  2.90069472e-02  1.19723372e-01]
 [ 1.11566942e-01 -4.71654622e-01  7.41128810e-02]
 [-5.07556251e-01  1.23428220e-02 -9.74657845e-02]
 [ 1.98472136e-02  2.66667642e-02 -1.92981844e-02]
 [ 5.92130943e-04 -2.94810677e-01  2.50760580e-01]
 [-3.83453498e-01  6.85537364e-02  3.47623481e-01]
 [ 3.51367524e-02  1.75619092e-01  1.18379367e-01]
 [-3.74558502e-02  8.31152940e-01  7.84591510e-01]
 [ 1.36154569e-01 -1.31250808e-01 -6.38827811e-02]
 [-1.46366039e-02 -1.05698872e-02  3.57260064e-02]
 [-5.02695626e-01 -5.17312956e-03  1.84908640e-01]
 [-1.22138669e-01  1.87056928e-02 -2.46618592e-02]
 [-1.28232842e-01  3.42322287e-01 -1.00516027e-01]
 [-2.18117550e-02  4.76177780e-02  2.32891551e-02]
 [ 2.30070201e-01 -1.71288814e-01  3.18245556e-01]
 [-4.00690186e-02  6.00078567e-02 -3.39022501e-02]
 [ 4.36109930e-01  9.11841676e-02  3.65207109e-01]
 [ 2.43864830e-03 -7.80987716e-02 -2.14102024e-02]
 [-1.19697736e-01  2.66451474e-01  3.25315034e-01]
 [-3.71449161e-03  5.82181115e-02  6.00548326e-02]
 [-2.12920479e-01 -1.00026229e-01  6.12331216e-01]
 [ 1.94891347e-01  1.04311998e-01 -1.20532524e-01]
 [-9.59891938e-01 -8.76671008e-02 -1.19757816e+00]
 [ 1.56085150e-01 -4.22548171e-01  4.02747368e-01]
 [-2.16805881e-01 -3.00418717e-01  1.56879550e-01]
 [ 1.40893622e-01  3.27448469e-01 -1.16732242e-01]
 [-7.63907522e-02  1.00555970e-02  1.11175909e-01]
 [-1.61853551e-02  3.78015839e-01 -1.55413896e-02]
 [ 6.35845170e-02 -1.75758969e-01 -1.93458728e-01]
 [-8.33894125e-02  4.82959316e-01  9.09791126e-02]
 [ 3.11387631e-01  2.12980862e-01  2.96356149e-02]
 [ 6.37925407e-02  1.64003912e-02 -1.45937653e-02]
 [-2.19004504e-01 -4.78726785e-01  1.04769581e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.13961855]
curr_Stock_Price:  101.08006644240692
curr_Factors:  [101.08006644  -0.75574752  -1.0109085 ]
mat_Sqrt:  [[17.27494035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00312314  0.03789815  0.26653444]
Stock Position:  -0.0031231377581597986
Bond Position:  [10.45530552]


portfolio before change:  [10.1398896]
curr_Stock_Price:  101.41176761566047
curr_Factors:  [101.41176762  -0.53917364  -1.0182949 ]
mat_Sqrt:  [[21.36428501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00115906 -0.01284557 -0.34758508]
Stock Position:  -0.0011590634844055219
Bond Position:  [10.25743227]


portfolio before change:  [10.14222958]
curr_Stock_Price:  100.49919830587551
curr_Factors:  [100.49919831  -0.40265336  -0.9932572 ]
mat_Sqrt:  [[24.8843525   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01877254 0.10669868 1.18188242]
Stock Position:  0.01877253829581781
Bond Position:  [8.25560453]


portfolio before change:  [10.18790873]
curr_Stock_Price:  102.87752022180759
curr_Factors:  [102.87752022  -0.57343623  -0.98578667]
mat_Sqrt:  [[21.63508399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009107  -0.00659539  0.21422481]
Stock Position:  0.000910699210295988
Bond Position:  [10.09421826]


portfolio before change:  [10.19073666]
curr_Stock_Price:  104.59715494550835
curr_Factors:  [104.59715495  -0.61460308  -0.99071543]
mat_Sqrt:  [[21.00578417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05137537 -0.07774741 -0.78856174]
Stock Position:  -0.05137537326958777
Bond Position:  [15.56445454]


portfolio before change:  [10.23061123]
curr_Stock_Price:  103.85888514761734
curr_Factors:  [103.85888515  -0.27891586  -0.9952188 ]
mat_Sqrt:  [[29.04651307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00235554 0.03307553 0.33434342]
Stock Position:  0.0023555399944329225
Bond Position:  [9.98596747]


portfolio before change:  [10.23238961]
curr_Stock_Price:  104.08391296592795
curr_Factors:  [104.08391297  -0.11792368  -0.98646399]
mat_Sqrt:  [[34.49484009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.26234873e-04  9.17280210e-03  3.41537457e-01]
Stock Position:  -0.00022623487276819708
Bond Position:  [10.25593702]


portfolio before change:  [10.23373204]
curr_Stock_Price:  103.81713021854786
curr_Factors:  [103.81713022   0.25203643  -1.00124368]
mat_Sqrt:  [[49.07863161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00233334 -0.14915029  0.21142342]
Stock Position:  0.002333339317066206
Bond Position:  [9.99149145]


portfolio before change:  [10.23479799]
curr_Stock_Price:  103.7386764377682
curr_Factors:  [ 1.03738676e+02  7.14188699e-02 -9.62568196e-01]
mat_Sqrt:  [[42.5519501   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01238798  0.00390314 -0.27804275]
Stock Position:  -0.012387979381829036
Bond Position:  [11.51991058]


portfolio before change:  [10.23478142]
curr_Stock_Price:  103.85626273374565
curr_Factors:  [103.85626273  -0.1446301   -0.94190244]
mat_Sqrt:  [[35.0394761   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047365  0.00843277 -0.05505235]
Stock Position:  0.0004736520910559985
Bond Position:  [10.18558968]


portfolio before change:  [10.23752942]
curr_Stock_Price:  106.96979147078187
curr_Factors:  [106.96979147  -0.33357896  -0.95786744]
mat_Sqrt:  [[29.4030988   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0015021  -0.09322732  0.71535014]
Stock Position:  0.0015021015789006588
Bond Position:  [10.07684993]


portfolio before change:  [10.23863522]
curr_Stock_Price:  106.86734317763124
curr_Factors:  [106.86734318  -0.29999483  -0.98178998]
mat_Sqrt:  [[29.66012253  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01047619  0.02167859  0.99167303]
Stock Position:  -0.010476190777175577
Bond Position:  [11.3581979]


portfolio before change:  [10.24146734]
curr_Stock_Price:  106.73253688569032
curr_Factors:  [106.73253689  -0.42577442  -0.97139514]
mat_Sqrt:  [[26.39452191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00241851 0.05553563 0.33770338]
Stock Position:  0.002418505829676336
Bond Position:  [9.98333408]


portfolio before change:  [10.24321042]
curr_Stock_Price:  106.93724356181677
curr_Factors:  [106.93724356  -0.57610253  -0.9923424 ]
mat_Sqrt:  [[22.28240217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00646961 0.26283364 2.23822119]
Stock Position:  0.0064696120649928475
Bond Position:  [9.55136794]


portfolio before change:  [10.24412556]
curr_Stock_Price:  106.89414173098042
curr_Factors:  [106.89414173  -0.16833798  -0.98883118]
mat_Sqrt:  [[33.6048315   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00356275 -0.04150515 -0.18223979]
Stock Position:  0.0035627516791445248
Bond Position:  [9.86328828]


portfolio before change:  [10.24340403]
curr_Stock_Price:  106.34554188942286
curr_Factors:  [ 1.06345542e+02 -5.70752656e-02 -1.00294673e+00]
mat_Sqrt:  [[36.84322066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00020674 -0.00334249  0.10191635]
Stock Position:  -0.0002067402524888353
Bond Position:  [10.26538993]


portfolio before change:  [10.24492484]
curr_Stock_Price:  105.1964719112187
curr_Factors:  [ 1.05196472e+02  5.61577193e-02 -1.03224358e+00]
mat_Sqrt:  [[39.63624186  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01173383 -0.00163589  0.52749288]
Stock Position:  -0.011733828831586399
Bond Position:  [11.47928224]


portfolio before change:  [10.2354661]
curr_Stock_Price:  106.12487670489098
curr_Factors:  [ 1.06124877e+02  6.44711699e-02 -1.01227700e+00]
mat_Sqrt:  [[41.13299731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308     0.00591526 -0.07035342]
Stock Position:  -0.003080003377246586
Bond Position:  [10.56233108]


portfolio before change:  [10.2282642]
curr_Stock_Price:  108.89184457256812
curr_Factors:  [108.89184457  -0.16712191  -1.03374411]
mat_Sqrt:  [[32.76920212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00426961  0.10825181 -0.28674425]
Stock Position:  -0.004269614689361931
Bond Position:  [10.69319042]


portfolio before change:  [10.23407493]
curr_Stock_Price:  107.84397544886963
curr_Factors:  [107.84397545  -0.2170229   -1.03123936]
mat_Sqrt:  [[30.95155532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051139  0.01505806  0.06643748]
Stock Position:  -0.0005113924067446175
Bond Position:  [10.28922552]


portfolio before change:  [10.23403757]
curr_Stock_Price:  110.43220062735783
curr_Factors:  [110.43220063  -0.73344049  -1.03404644]
mat_Sqrt:  [[18.85757753  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01541074 -0.05416628  0.90786599]
Stock Position:  0.015410735781086217
Bond Position:  [8.5321961]


portfolio before change:  [10.23443751]
curr_Stock_Price:  110.38894222825436
curr_Factors:  [110.38894223  -0.55791055  -1.06797891]
mat_Sqrt:  [[21.71754595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209231  0.01897615 -0.09671368]
Stock Position:  -0.0020923123805430426
Bond Position:  [10.46540566]


portfolio before change:  [10.23131389]
curr_Stock_Price:  112.5071170229596
curr_Factors:  [112.50711702  -0.63451995  -1.06016886]
mat_Sqrt:  [[20.66264889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02482798 0.02883497 1.04183423]
Stock Position:  0.024827982458958897
Bond Position:  [7.43798916]


portfolio before change:  [10.23959305]
curr_Stock_Price:  112.80312790558766
curr_Factors:  [112.80312791  -0.42557639  -1.07419089]
mat_Sqrt:  [[25.17563826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00015683 -0.024697   -0.06107735]
Stock Position:  -0.00015682591784477355
Bond Position:  [10.2572835]


portfolio before change:  [10.24075395]
curr_Stock_Price:  113.5768396653555
curr_Factors:  [113.57683967  -0.39580875  -1.06340655]
mat_Sqrt:  [[26.39736784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175826  0.08425935  0.92803324]
Stock Position:  -0.0017582561856257025
Bond Position:  [10.44045113]


portfolio before change:  [10.24370352]
curr_Stock_Price:  112.64157671801523
curr_Factors:  [112.64157672  -0.36388641  -1.09541842]
mat_Sqrt:  [[26.17765169  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00038381 0.01841018 0.17131972]
Stock Position:  0.00038381345547103127
Bond Position:  [10.20047017]


portfolio before change:  [10.2450284]
curr_Stock_Price:  112.77117324416308
curr_Factors:  [112.77117324  -0.66778043  -1.07322869]
mat_Sqrt:  [[19.77367736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00457738 -0.03163107  1.74681052]
Stock Position:  -0.004577376150540303
Bond Position:  [10.76122448]


portfolio before change:  [10.24529389]
curr_Stock_Price:  113.00705991439074
curr_Factors:  [113.00705991  -0.51946619  -1.08126475]
mat_Sqrt:  [[22.79906101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0075872   0.03298635 -0.34384574]
Stock Position:  0.007587201621201451
Bond Position:  [9.38788655]


portfolio before change:  [10.24982183]
curr_Stock_Price:  113.44916996470019
curr_Factors:  [113.44916996  -0.73552243  -1.07508698]
mat_Sqrt:  [[18.5551148   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06502844 -0.02772277 -3.41635715]
Stock Position:  -0.06502843683887348
Bond Position:  [17.62724401]


portfolio before change:  [10.41406071]
curr_Stock_Price:  110.95740874639957
curr_Factors:  [110.95740875  -0.51912796  -1.0855815 ]
mat_Sqrt:  [[22.29666164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01019818 -0.13362146  1.14892614]
Stock Position:  0.01019818431120217
Bond Position:  [9.28249661]


portfolio before change:  [10.4228142]
curr_Stock_Price:  111.70196296933825
curr_Factors:  [111.70196297  -0.71606176  -1.13077677]
mat_Sqrt:  [[17.61931512  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01092777 -0.09500074  0.44753369]
Stock Position:  -0.010927766124095573
Bond Position:  [11.64346712]


portfolio before change:  [10.42572255]
curr_Stock_Price:  111.56901457935626
curr_Factors:  [111.56901458  -0.61955406  -1.14626125]
mat_Sqrt:  [[19.08357561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00657741  0.1035483  -0.33300459]
Stock Position:  0.00657740661719434
Bond Position:  [9.69188778]


portfolio before change:  [10.433874]
curr_Stock_Price:  112.62412530599697
curr_Factors:  [112.62412531  -0.60350142  -1.13311153]
mat_Sqrt:  [[19.83489969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269411  0.00317986  0.31715392]
Stock Position:  -0.0026941114554266737
Bond Position:  [10.73729595]


portfolio before change:  [10.43869476]
curr_Stock_Price:  111.33297385953152
curr_Factors:  [111.33297386  -0.25536491  -1.14329702]
mat_Sqrt:  [[27.49113387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034911  0.1195391  -0.04433526]
Stock Position:  -0.0003491089539227143
Bond Position:  [10.47756209]


portfolio before change:  [10.43928907]
curr_Stock_Price:  113.38237944970375
curr_Factors:  [113.38237945  -0.21183002  -1.10162719]
mat_Sqrt:  [[30.48725679  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00064148 -0.05557987 -0.5518839 ]
Stock Position:  0.0006414759632935143
Bond Position:  [10.366557]


portfolio before change:  [10.44058061]
curr_Stock_Price:  113.3755890757345
curr_Factors:  [ 1.13375589e+02 -1.03509272e-01 -1.09403667e+00]
mat_Sqrt:  [[34.23197543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152923  0.15272515  0.25953808]
Stock Position:  -0.0015292258877376988
Bond Position:  [10.6139575]


portfolio before change:  [10.44347343]
curr_Stock_Price:  112.35154604051516
curr_Factors:  [112.35154604  -0.27506211  -1.07195976]
mat_Sqrt:  [[29.21291451  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01105457 0.06735046 0.08454216]
Stock Position:  0.011054566902428719
Bond Position:  [9.20147575]


portfolio before change:  [10.44402911]
curr_Stock_Price:  112.29776047564715
curr_Factors:  [112.29776048  -0.59022072  -1.07126637]
mat_Sqrt:  [[21.32045256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00287222  0.00518626 -0.04163195]
Stock Position:  0.0028722212617639095
Bond Position:  [10.1214851]


portfolio before change:  [10.44551806]
curr_Stock_Price:  112.3756401019482
curr_Factors:  [112.3756401   -0.61709835  -1.07260539]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.44551806]
Stock Price:  112.13504746893038
PL:  [-1.6895294]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-7.13489251e-02 -2.43724136e-02 -2.74715492e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.53357917e-01  4.05575550e-02  1.22034971e-02]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.11180402e+00 -3.26125841e-01  1.47108423e-02]
 [-6.39448119e-02  1.82873895e-02  5.94710951e-02]
 [ 5.76281069e-03  1.53322969e-01  6.75937769e-02]
 [ 3.83408194e-01  1.29622371e-02 -1.05568234e-01]
 [-5.85626114e-01 -3.09383059e-02 -8.35801370e-02]
 [-9.71093955e-03  7.97297195e-02  4.05849145e-03]
 [-2.84086384e-02 -1.97609974e-01  1.48615255e-01]
 [-1.60625151e-01  2.29952469e-02  1.28816808e-01]
 [ 5.07796798e-02 -4.32813805e-03  2.30133714e-01]
 [ 2.61985389e-02  3.98198217e-01  3.52895272e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-1.68769558e-02 -4.99359108e-03  3.65920184e-02]
 [-5.47186073e-01 -2.53928972e-01  1.56413449e-01]
 [-1.24473665e-01  1.85539983e-02 -2.27178168e-02]
 [ 1.35734169e-01  8.21685771e-01  2.56914737e-01]
 [-3.19188962e-02  5.31115507e-02  2.45963139e-02]
 [ 4.14916105e-02 -1.64774712e-01  9.17223422e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 2.08616039e-01 -1.07845241e-02  2.00758464e-01]
 [ 7.34399111e-02 -1.88139795e-01 -7.72821761e-02]
 [-1.20636244e-01  2.22817802e-01  1.86454899e-01]
 [ 1.42557444e-02  6.26752753e-02 -9.86555894e-04]
 [-6.26075543e-02 -8.82097339e-02  1.12128672e-01]
 [ 7.42562450e-02  6.48823863e-02 -8.09516452e-02]
 [-6.89444025e-01 -1.34725643e-01 -1.05583101e+00]
 [-1.86163697e-01  1.15001221e-01 -3.23845781e-02]
 [-7.11598087e-02  1.50428123e-02  1.13956970e-01]
 [ 1.07706721e-02  3.59269500e-02  2.46276383e-02]
 [-1.37353526e-01 -8.70666392e-04 -1.38354894e-01]
 [-6.58090442e-02 -9.60706758e-03  4.24209149e-02]
 [ 2.04084517e-01 -1.69513002e-01 -8.25405962e-02]
 [-7.07967400e-03  1.35635770e-01  7.95590726e-02]
 [ 1.81158931e-02  1.81213865e-02 -4.41968042e-02]
 [-6.01667406e-02  9.72714727e-02 -6.32958626e-03]
 [-7.09319281e-02 -1.90069097e-01  6.41847603e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.15870452]
curr_Stock_Price:  100.52540582666106
curr_Factors:  [100.52540583  -1.22027803  -0.97452375]
mat_Sqrt:  [[11.19658365  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00692942 -0.00770723 -0.07836868]
Stock Position:  -0.006929419452781727
Bond Position:  [6.85528722]


portfolio before change:  [6.15987127]
curr_Stock_Price:  100.48069986364503
curr_Factors:  [100.48069986  -1.29108788  -0.97673018]
mat_Sqrt:  [[10.40355533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00436207  0.01411938  0.0859571 ]
Stock Position:  -0.004362070602174317
Bond Position:  [6.59817518]


portfolio before change:  [6.1605599]
curr_Stock_Price:  100.51192266579275
curr_Factors:  [100.51192267  -1.09203119  -0.99566238]
mat_Sqrt:  [[12.46073861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02061645 0.01282543 0.03481318]
Stock Position:  0.020616445414345704
Bond Position:  [4.08836133]


portfolio before change:  [6.1826126]
curr_Stock_Price:  101.55679873175563
curr_Factors:  [101.55679873  -0.97731188  -1.00758533]
mat_Sqrt:  [[13.95336951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141206 -0.00659539  0.21422481]
Stock Position:  0.001412064224695716
Bond Position:  [6.03920788]


portfolio before change:  [6.18341922]
curr_Stock_Price:  101.593388343943
curr_Factors:  [101.59338834  -1.19186174  -0.99822879]
mat_Sqrt:  [[11.36897238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09826937 -0.10313005  0.04196594]
Stock Position:  -0.09826936690850316
Bond Position:  [16.16693717]


portfolio before change:  [6.23560563]
curr_Stock_Price:  101.08289944451688
curr_Factors:  [101.08289944  -1.39092675  -0.99589055]
mat_Sqrt:  [[ 9.29171983  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00552461  0.00578298  0.16965448]
Stock Position:  -0.0055246120249477036
Bond Position:  [6.79404944]


portfolio before change:  [6.23148874]
curr_Stock_Price:  101.98182336066729
curr_Factors:  [101.98182336  -1.57171922  -1.01158732]
mat_Sqrt:  [[ 7.70206177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00305361 0.04848498 0.19282623]
Stock Position:  0.0030536128309465406
Bond Position:  [5.92007573]


portfolio before change:  [6.2331276]
curr_Stock_Price:  102.27616673898399
curr_Factors:  [102.27616674  -1.47899468  -1.02366095]
mat_Sqrt:  [[ 8.37307367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04325698  0.00409902 -0.30115679]
Stock Position:  0.04325697667544798
Bond Position:  [1.80896984]


portfolio before change:  [6.26665326]
curr_Stock_Price:  103.04597357824778
curr_Factors:  [103.04597358  -1.49576177  -1.03568029]
mat_Sqrt:  [[ 8.19671264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07362533 -0.00978355 -0.23843087]
Stock Position:  -0.07362532855726932
Bond Position:  [13.85344692]


portfolio before change:  [6.23606213]
curr_Stock_Price:  103.48499258807915
curr_Factors:  [103.48499259  -1.30167971  -1.05552559]
mat_Sqrt:  [[ 9.7984215   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069643  0.02521275  0.01157775]
Stock Position:  -0.0006964275772551001
Bond Position:  [6.30813193]


portfolio before change:  [6.2365179]
curr_Stock_Price:  103.96284042989409
curr_Factors:  [103.96284043  -1.18438409  -1.06142672]
mat_Sqrt:  [[11.00360258  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.88536791e-04 -6.24897606e-02  4.23957955e-01]
Stock Position:  -0.000288536790805862
Bond Position:  [6.26651501]


portfolio before change:  [6.23743133]
curr_Stock_Price:  103.51207074762938
curr_Factors:  [103.51207075  -1.25955234  -1.06185502]
mat_Sqrt:  [[10.15819606  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01316541  0.00727174  0.3674785 ]
Stock Position:  -0.013165407966812571
Bond Position:  [7.60020997]


portfolio before change:  [6.23762384]
curr_Stock_Price:  103.56961410058089
curr_Factors:  [103.5696141   -0.83972637  -1.03142072]
mat_Sqrt:  [[15.94422817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00612408 -0.00136868  0.65650743]
Stock Position:  0.006124082924932285
Bond Position:  [5.60335493]


portfolio before change:  [6.23730524]
curr_Stock_Price:  103.40321279905251
curr_Factors:  [103.4032128   -0.92758856  -1.03453036]
mat_Sqrt:  [[14.53438354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00746605 0.12592133 1.00671198]
Stock Position:  0.0074660489150920875
Bond Position:  [5.4652918]


portfolio before change:  [6.23137961]
curr_Stock_Price:  102.51802785032574
curr_Factors:  [102.51802785  -0.89903078  -1.04521295]
mat_Sqrt:  [[14.66985828  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00292615 -0.03587186 -0.12433753]
Stock Position:  0.0029261450793198686
Bond Position:  [5.93139699]


portfolio before change:  [6.23145351]
curr_Stock_Price:  102.28988792741552
curr_Factors:  [102.28988793  -1.28758547  -1.02572424]
mat_Sqrt:  [[10.11987297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094236 -0.00157911  0.10438684]
Stock Position:  -0.0009423611649918127
Bond Position:  [6.32784753]


portfolio before change:  [6.23115465]
curr_Stock_Price:  103.44644151131406
curr_Factors:  [103.44644151  -1.25070057  -1.01493042]
mat_Sqrt:  [[10.73407231  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04861293 -0.08029939  0.44620403]
Stock Position:  -0.04861293219765121
Bond Position:  [11.2599895]


portfolio before change:  [6.18573243]
curr_Stock_Price:  104.40976148916486
curr_Factors:  [104.40976149  -1.08836224  -1.0056244 ]
mat_Sqrt:  [[12.86276273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01000033  0.00586729 -0.06480761]
Stock Position:  -0.010000328859572988
Bond Position:  [7.22986438]


portfolio before change:  [6.18135895]
curr_Stock_Price:  104.9374708454585
curr_Factors:  [104.93747085  -1.24798437  -0.99219478]
mat_Sqrt:  [[11.16948501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01874684 0.25983986 0.73290623]
Stock Position:  0.018746836188138476
Bond Position:  [4.21411338]


portfolio before change:  [6.18849604]
curr_Stock_Price:  105.29007932464552
curr_Factors:  [105.29007932  -1.22831945  -0.98850932]
mat_Sqrt:  [[11.4717837   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00222519  0.01679535  0.07016644]
Stock Position:  -0.002225186681323249
Bond Position:  [6.42278613]


portfolio before change:  [6.19104752]
curr_Stock_Price:  104.50426873976943
curr_Factors:  [104.50426874  -0.9459266   -0.94931369]
mat_Sqrt:  [[15.70513354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00356316 -0.05210634  0.26165831]
Stock Position:  0.0035631591603988997
Bond Position:  [5.81868218]


portfolio before change:  [6.19489173]
curr_Stock_Price:  105.37900632299556
curr_Factors:  [105.37900632  -0.91483195  -0.94508893]
mat_Sqrt:  [[16.40592513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023692   0.01916992 -0.08961985]
Stock Position:  -0.00236919670063994
Bond Position:  [6.44455532]


portfolio before change:  [6.19645734]
curr_Stock_Price:  105.05822663989257
curr_Factors:  [105.05822664  -1.09991374  -0.91757896]
mat_Sqrt:  [[13.97153487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01784466 -0.00341037  0.57270802]
Stock Position:  0.017844656003955274
Bond Position:  [4.32172942]


portfolio before change:  [6.19580697]
curr_Stock_Price:  104.99150546216168
curr_Factors:  [104.99150546  -0.88466333  -0.93372052]
mat_Sqrt:  [[17.03884253  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00309921 -0.05949503 -0.22046454]
Stock Position:  0.0030992131220972103
Bond Position:  [5.87041592]


portfolio before change:  [6.19829528]
curr_Stock_Price:  105.55760510614932
curr_Factors:  [105.55760511  -0.61403682  -0.95139202]
mat_Sqrt:  [[22.06136715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00348225  0.07046118  0.53190393]
Stock Position:  -0.0034822486605994153
Bond Position:  [6.56587311]


portfolio before change:  [6.20488396]
curr_Stock_Price:  103.90123467063567
curr_Factors:  [103.90123467  -0.67062452  -0.93482879]
mat_Sqrt:  [[20.86321313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00075121  0.01981966 -0.00281437]
Stock Position:  0.0007512089872711211
Bond Position:  [6.12683242]


portfolio before change:  [6.2055737]
curr_Stock_Price:  103.79984404489934
curr_Factors:  [103.79984404  -1.14095034  -0.95967824]
mat_Sqrt:  [[12.7029708   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330607 -0.02789437  0.31987189]
Stock Position:  -0.003306073140039904
Bond Position:  [6.54874357]


portfolio before change:  [6.20459471]
curr_Stock_Price:  104.34358059782824
curr_Factors:  [104.3435806   -1.16128406  -0.97477329]
mat_Sqrt:  [[12.32502518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00482006  0.02051761 -0.23093251]
Stock Position:  0.004820056331594514
Bond Position:  [5.70165277]


portfolio before change:  [6.20480485]
curr_Stock_Price:  104.2393065770335
curr_Factors:  [104.23930658  -1.13406725  -1.00674831]
mat_Sqrt:  [[12.25426116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07413284 -0.04260399 -3.01199199]
Stock Position:  -0.07413284378654071
Bond Position:  [13.93236108]


portfolio before change:  [6.26453825]
curr_Stock_Price:  103.4570386807943
curr_Factors:  [103.45703868  -1.23248892  -0.99937228]
mat_Sqrt:  [[11.10388717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01709355  0.03636658 -0.09238419]
Stock Position:  -0.017093550179224874
Bond Position:  [8.03298633]


portfolio before change:  [6.26680197]
curr_Stock_Price:  103.38335391698683
curr_Factors:  [103.38335392  -1.41020707  -1.02288626]
mat_Sqrt:  [[ 9.07343242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00523617  0.00475695  0.32508752]
Stock Position:  -0.005236170130069902
Bond Position:  [6.8081348]


portfolio before change:  [6.26397812]
curr_Stock_Price:  104.08518765323491
curr_Factors:  [104.08518765  -1.72033809  -1.02148967]
mat_Sqrt:  [[ 6.70854387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00249315 0.0113611  0.0702558 ]
Stock Position:  0.002493148724360965
Bond Position:  [6.00447827]


portfolio before change:  [6.26468175]
curr_Stock_Price:  104.06634423162843
curr_Factors:  [104.06634423  -1.57951604  -0.99861477]
mat_Sqrt:  [[ 7.90027695  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.09635159e-02 -2.75328888e-04 -3.94688001e-01]
Stock Position:  -0.020963515877104193
Bond Position:  [8.44627821]


portfolio before change:  [6.27343027]
curr_Stock_Price:  103.69938885368751
curr_Factors:  [103.69938885  -1.38381768  -0.98389501]
mat_Sqrt:  [[ 9.7160925   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00590752 -0.00303802  0.12101506]
Stock Position:  -0.005907515250475695
Bond Position:  [6.88603599]


portfolio before change:  [6.27660188]
curr_Stock_Price:  103.30822689262928
curr_Factors:  [103.30822689  -1.33390653  -0.95332619]
mat_Sqrt:  [[10.49064904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01743068 -0.05360472 -0.23546535]
Stock Position:  0.01743068333367359
Bond Position:  [4.47586889]


portfolio before change:  [6.28806507]
curr_Stock_Price:  103.93377190469664
curr_Factors:  [103.9337719   -1.40794815  -0.94744433]
mat_Sqrt:  [[ 9.85876993  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00128437 0.0428918  0.22695989]
Stock Position:  0.0012843746534865175
Bond Position:  [6.15457517]


portfolio before change:  [6.28945325]
curr_Stock_Price:  104.41556901114323
curr_Factors:  [104.41556901  -1.48483559  -0.9030785 ]
mat_Sqrt:  [[ 9.58754352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099735  0.00573049 -0.12608118]
Stock Position:  0.0009973514483622317
Bond Position:  [6.18531423]


portfolio before change:  [6.29093856]
curr_Stock_Price:  105.12955407443707
curr_Factors:  [105.12955407  -1.5548706   -0.86967777]
mat_Sqrt:  [[ 9.30586707  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00633441  0.03075994 -0.01805655]
Stock Position:  -0.006334414935195504
Bond Position:  [6.95687277]


portfolio before change:  [6.29464437]
curr_Stock_Price:  104.68181824136897
curr_Factors:  [104.68181824  -1.65219953  -0.87222138]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.29464437]
Stock Price:  104.82553054712517
PL:  [1.46911382]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.10550544e-01  6.36998268e-02  8.60543818e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.67167547e-01  4.03264975e-02  3.79801724e-03]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.05441520e+00 -3.11824390e-01  2.68863914e-02]
 [-5.20374168e-02 -4.55282049e-03  2.48336321e-02]
 [ 3.31059741e-02  5.78153727e-02 -1.41621415e-02]
 [ 3.23983616e-01  4.85623018e-02 -8.67487308e-02]
 [-3.53533095e-01 -5.78749923e-03 -8.62223726e-02]
 [ 4.47893499e-02 -1.28604128e-02 -3.93286927e-02]
 [ 6.42645574e-02 -2.36294834e-01  1.18170453e-02]
 [ 8.33010182e-04 -3.04207159e-02 -6.32317321e-02]
 [ 2.46810189e-01 -2.41259924e-01  7.25215867e-02]
 [ 9.56675993e-02  2.04134351e-03 -3.60689285e-02]
 [-1.82986921e-02 -4.99639667e-02 -1.63206185e-02]
 [ 5.49719877e-03 -2.03630985e-01 -4.13731197e-02]
 [-3.97726551e-01 -2.47076669e-01  9.90507108e-02]
 [-2.21047629e-01 -8.32782602e-02 -3.55923421e-02]
 [ 2.61046057e-01  1.15697060e+00  3.52965280e-01]
 [-1.38687063e-01 -2.24413782e-02  1.14463750e-01]
 [-8.09625634e-02  1.16186923e-01 -3.19696149e-02]
 [-3.31092452e-02  5.87144733e-02 -2.96661142e-02]
 [ 6.03981919e-02 -3.57450932e-02  7.94271525e-02]
 [ 8.02827954e-02  2.50253192e-02 -1.78092836e-02]
 [-5.89363850e-02 -1.64191281e-01  7.74224192e-02]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [ 1.18392848e-02 -6.64146377e-02 -1.30059647e-02]
 [ 4.71063970e-02  5.51305213e-02 -8.31211469e-02]
 [-6.50615507e-01 -7.95519608e-02 -9.89144156e-01]
 [-2.71810324e-01  1.02689487e-01 -8.64254460e-04]
 [-3.23124634e-02  3.64721212e-03  1.12520314e-01]
 [ 1.55889618e-02  4.75913697e-02  1.31506188e-02]
 [-1.48434915e-01 -8.04909108e-03 -1.30904745e-01]
 [-6.26500806e-02  6.60301056e-02  9.03906116e-02]
 [ 1.58451878e-01 -1.60901323e-01 -1.00539811e-01]
 [-1.93354722e-02  2.16271763e-01  8.22544067e-02]
 [ 8.23627970e-02  6.93492053e-02 -3.04770554e-02]
 [-6.58630419e-03  5.83607884e-02 -1.16016857e-02]
 [-1.16880852e-01 -2.32147308e-01  4.71619251e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.98919034]
curr_Stock_Price:  100.36245745553242
curr_Factors:  [100.36245746  -0.70819849  -1.00175488]
mat_Sqrt:  [[18.15298196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00503168  0.02014365  0.2454892 ]
Stock Position:  -0.005031682666348088
Bond Position:  [5.49418237]


portfolio before change:  [4.99098053]
curr_Stock_Price:  100.14317089738748
curr_Factors:  [100.1431709   -0.69006553  -1.01222088]
mat_Sqrt:  [[18.25272643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248626  0.01411938  0.0859571 ]
Stock Position:  -0.0024862610535924326
Bond Position:  [5.2399626]


portfolio before change:  [4.99038268]
curr_Stock_Price:  100.64709708223992
curr_Factors:  [100.64709708  -1.01512453  -1.00904714]
mat_Sqrt:  [[13.29580588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02023074 0.01275236 0.01083469]
Stock Position:  0.020230743582841985
Bond Position:  [2.95421706]


portfolio before change:  [4.99413602]
curr_Stock_Price:  100.81436922549555
curr_Factors:  [100.81436923  -1.31302183  -0.98874886]
mat_Sqrt:  [[10.08965061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0019528  -0.00659539  0.21422481]
Stock Position:  0.0019527984326121524
Bond Position:  [4.79726587]


portfolio before change:  [4.99424786]
curr_Stock_Price:  100.56454808954352
curr_Factors:  [100.56454809  -1.33948487  -1.00288454]
mat_Sqrt:  [[ 9.66421979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10937027 -0.09860753  0.07669939]
Stock Position:  -0.10937026857715337
Bond Position:  [15.99301949]


portfolio before change:  [4.97085175]
curr_Stock_Price:  100.79674433297207
curr_Factors:  [100.79674433  -1.30475724  -0.98295498]
mat_Sqrt:  [[10.23070856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0046024  -0.00143973  0.07084344]
Stock Position:  -0.004602401284310886
Bond Position:  [5.43475881]


portfolio before change:  [4.97335889]
curr_Stock_Price:  100.39961385741192
curr_Factors:  [100.39961386  -1.1494993   -0.96762283]
mat_Sqrt:  [[12.08586067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00262356  0.01828283 -0.04040065]
Stock Position:  0.002623555446699138
Bond Position:  [4.70995494]


portfolio before change:  [4.97223245]
curr_Stock_Price:  99.74583863813672
curr_Factors:  [99.74583864 -1.22358632 -0.94617949]
mat_Sqrt:  [[11.39140954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02699666  0.01535675 -0.24746998]
Stock Position:  0.02699665725242012
Bond Position:  [2.27942824]


portfolio before change:  [4.96910492]
curr_Stock_Price:  99.61943467564465
curr_Factors:  [99.61943468 -1.18865592 -0.94677134]
mat_Sqrt:  [[11.77442747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03153296 -0.00183017 -0.24596843]
Stock Position:  -0.031532963824383066
Bond Position:  [8.11040095]


portfolio before change:  [4.96825559]
curr_Stock_Price:  99.67852180537308
curr_Factors:  [99.67852181 -1.35021874 -0.94473294]
mat_Sqrt:  [[10.04423206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00362689 -0.00406682 -0.11219381]
Stock Position:  0.0036268934730211543
Bond Position:  [4.60673221]


portfolio before change:  [4.96550714]
curr_Stock_Price:  98.76194494405432
curr_Factors:  [98.76194494 -1.15694973 -0.96149629]
mat_Sqrt:  [[11.87299312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00510196 -0.07472299  0.03371074]
Stock Position:  0.005101964992046159
Bond Position:  [4.46162715]


portfolio before change:  [4.96479546]
curr_Stock_Price:  98.51313536992421
curr_Factors:  [98.51313537 -1.19790728 -0.95623132]
mat_Sqrt:  [[11.4278264   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112529 -0.00961988 -0.18038253]
Stock Position:  -0.0011252859593065526
Bond Position:  [5.07565091]


portfolio before change:  [4.96542789]
curr_Stock_Price:  98.51497247930432
curr_Factors:  [98.51497248 -1.18651915 -0.97680902]
mat_Sqrt:  [[11.32350186  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02255347 -0.07629309  0.2068839 ]
Stock Position:  0.022553472817330014
Bond Position:  [2.74357313]


portfolio before change:  [4.98935844]
curr_Stock_Price:  99.56082385895269
curr_Factors:  [99.56082386 -0.86160749 -0.96868195]
mat_Sqrt:  [[15.96628509  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00553402  0.00064553 -0.10289461]
Stock Position:  0.005534021647223199
Bond Position:  [4.43838668]


portfolio before change:  [4.98882394]
curr_Stock_Price:  99.36398072259985
curr_Factors:  [99.36398072 -0.75786724 -0.95462135]
mat_Sqrt:  [[17.92687702  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00127854 -0.01579999 -0.04655818]
Stock Position:  -0.0012785377188063436
Bond Position:  [5.11586453]


portfolio before change:  [4.99121823]
curr_Stock_Price:  97.99150046646888
curr_Factors:  [97.99150047 -0.85075974 -0.9634053 ]
mat_Sqrt:  [[15.97005965  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051382 -0.06439377 -0.11802599]
Stock Position:  -0.0005138229614265024
Bond Position:  [5.04156851]


portfolio before change:  [4.9914205]
curr_Stock_Price:  98.82439682692957
curr_Factors:  [98.82439683 -0.76226463 -0.98923289]
mat_Sqrt:  [[17.14740725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02238749 -0.0781325   0.28256411]
Stock Position:  -0.022387489576348188
Bond Position:  [7.20385065]


portfolio before change:  [5.00008686]
curr_Stock_Price:  98.47751450561923
curr_Factors:  [98.47751451 -0.63268345 -0.98599165]
mat_Sqrt:  [[19.51440953  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01180989 -0.0263349  -0.10153505]
Stock Position:  -0.01180989466231471
Bond Position:  [6.16309594]


portfolio before change:  [4.97781788]
curr_Stock_Price:  100.4283715773366
curr_Factors:  [100.42837158  -0.74793888  -0.95031415]
mat_Sqrt:  [[18.37868766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01974938 0.36586623 1.0069117 ]
Stock Position:  0.019749377748538327
Bond Position:  [2.99442003]


portfolio before change:  [4.96261841]
curr_Stock_Price:  99.63979993778946
curr_Factors:  [99.63979994 -0.75716734 -0.96740098]
mat_Sqrt:  [[17.7607927   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0065257  -0.00709659  0.32653322]
Stock Position:  -0.00652570430486286
Bond Position:  [5.61283828]


portfolio before change:  [4.95876723]
curr_Stock_Price:  100.33747592627783
curr_Factors:  [100.33747593  -0.93959036  -0.97730916]
mat_Sqrt:  [[14.75585191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00572576  0.03674153 -0.09120041]
Stock Position:  -0.0057257555039822525
Bond Position:  [5.53327508]


portfolio before change:  [4.95337414]
curr_Stock_Price:  101.40018190464299
curr_Factors:  [101.4001819   -1.0256999   -1.00937345]
mat_Sqrt:  [[13.2500528   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284141  0.01856715 -0.08462917]
Stock Position:  -0.002841408616509666
Bond Position:  [5.24149349]


portfolio before change:  [4.95522073]
curr_Stock_Price:  100.98089493414047
curr_Factors:  [100.98089493  -0.92301293  -1.02426911]
mat_Sqrt:  [[14.4060651   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00525392 -0.01130359  0.22658356]
Stock Position:  0.005253916088906305
Bond Position:  [4.42467558]


portfolio before change:  [4.96204742]
curr_Stock_Price:  102.17497077197842
curr_Factors:  [102.17497077  -1.11752501  -1.02107885]
mat_Sqrt:  [[12.03817537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00642071  0.0079137  -0.05080493]
Stock Position:  0.006420710712529011
Bond Position:  [4.30601149]


portfolio before change:  [4.9580371]
curr_Stock_Price:  101.46654279869198
curr_Factors:  [101.4665428   -0.87655772  -1.02093743]
mat_Sqrt:  [[15.21427241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311366 -0.05192184  0.22086461]
Stock Position:  -0.0031136553357210884
Bond Position:  [5.27396894]


portfolio before change:  [4.9564025]
curr_Stock_Price:  102.20326073573077
curr_Factors:  [102.20326074  -1.00187956  -1.02328779]
mat_Sqrt:  [[13.48794385  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00096057  0.02004328 -0.05140267]
Stock Position:  0.0009605676780727185
Bond Position:  [4.85822935]


portfolio before change:  [4.95708241]
curr_Stock_Price:  102.27883552763276
curr_Factors:  [102.27883553  -0.977662    -1.02470189]
mat_Sqrt:  [[13.80925303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00054092 -0.02100215 -0.0371024 ]
Stock Position:  0.0005409151959542242
Bond Position:  [4.90175823]


portfolio before change:  [4.95804032]
curr_Stock_Price:  102.91693224220093
curr_Factors:  [102.91693224  -1.05013348  -1.0404433 ]
mat_Sqrt:  [[12.72216061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00248093  0.0174338  -0.2371215 ]
Stock Position:  0.0024809329863342048
Bond Position:  [4.70271031]


portfolio before change:  [4.95802176]
curr_Stock_Price:  102.67249164338985
curr_Factors:  [102.67249164  -1.12975223  -1.00918624]
mat_Sqrt:  [[12.0927459   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07066863 -0.02515654 -2.82175295]
Stock Position:  -0.07066862575515309
Bond Position:  [12.21374565]


portfolio before change:  [4.96777514]
curr_Stock_Price:  102.55608117878359
curr_Factors:  [102.55608118  -0.93027179  -1.0367897 ]
mat_Sqrt:  [[14.34423749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01877655  0.03247327 -0.00246548]
Stock Position:  -0.018776551112552418
Bond Position:  [6.89342464]


portfolio before change:  [4.95466534]
curr_Stock_Price:  103.30017573436422
curr_Factors:  [103.30017573  -1.10931696  -1.05569951]
mat_Sqrt:  [[11.85349312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078038  0.00115335  0.32098914]
Stock Position:  -0.0007803758602869288
Bond Position:  [5.03527831]


portfolio before change:  [4.95532079]
curr_Stock_Price:  103.26685525070185
curr_Factors:  [103.26685525  -0.93416481  -1.06447434]
mat_Sqrt:  [[13.99468076  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00139354 0.01504971 0.03751505]
Stock Position:  0.0013935383630468714
Bond Position:  [4.81141447]


portfolio before change:  [4.95660297]
curr_Stock_Price:  103.75533200432398
curr_Factors:  [103.755332    -1.26232991  -1.08878372]
mat_Sqrt:  [[ 9.88404584  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01774208 -0.00254535 -0.3734348 ]
Stock Position:  -0.017742082901079738
Bond Position:  [6.79743867]


portfolio before change:  [4.95283794]
curr_Stock_Price:  104.01543446245492
curr_Factors:  [104.01543446  -0.95081373  -1.09044892]
mat_Sqrt:  [[13.50792638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314588  0.02088055  0.25785925]
Stock Position:  -0.0031458776906498906
Bond Position:  [5.28005778]


portfolio before change:  [4.95097674]
curr_Stock_Price:  104.8168812970282
curr_Factors:  [104.8168813   -0.9779521   -1.10290857]
mat_Sqrt:  [[13.08352981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01022467 -0.05088147 -0.2868121 ]
Stock Position:  0.010224673511686728
Bond Position:  [3.87925835]


portfolio before change:  [4.94907061]
curr_Stock_Price:  104.58302855873326
curr_Factors:  [104.58302856  -0.88985659  -1.13508385]
mat_Sqrt:  [[13.80513813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.20117404e-04 6.83911365e-02 2.34648927e-01]
Stock Position:  0.00022011740412977143
Bond Position:  [4.92605006]


portfolio before change:  [4.94980614]
curr_Stock_Price:  105.1270014757471
curr_Factors:  [105.12700148  -0.69263292  -1.14649104]
mat_Sqrt:  [[16.71063261  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00466363  0.02193014 -0.08694256]
Stock Position:  0.0046636345079933824
Bond Position:  [4.45953223]


portfolio before change:  [4.95700578]
curr_Stock_Price:  106.55124714377374
curr_Factors:  [106.55124714  -0.38662826  -1.16430724]
mat_Sqrt:  [[22.5941397   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032963  0.0184553  -0.03309638]
Stock Position:  -0.00032962615021048534
Bond Position:  [4.99212786]


portfolio before change:  [4.95784798]
curr_Stock_Price:  105.88944680852343
curr_Factors:  [105.88944681  -0.14507418  -1.1723522 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.95784798]
Stock Price:  104.79726689761577
PL:  [0.16058108]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.13894303e-01  1.55598747e-01  2.57572466e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.77022551e-01  2.91372056e-01  3.97970130e-01]
 [ 1.35703394e-02  5.72420121e-02  1.44657069e-01]
 [-2.88889568e-01 -9.49803001e-02  4.55938714e-02]
 [ 6.95657500e-03 -1.17712345e-01 -1.46774195e-01]
 [ 3.32812965e-02 -1.17919998e-01 -1.52376455e-02]
 [ 1.78252652e-01  1.03760279e-01 -3.73836095e-02]
 [-1.65149399e-01  9.23844820e-03 -6.56793210e-02]
 [ 9.99666250e-02 -2.68841270e-02  3.01342960e-02]
 [ 1.22817213e-01 -2.50074599e-01 -8.94193657e-03]
 [-8.97227298e-02 -8.02325292e-02 -1.74449933e-01]
 [ 2.96545577e-01 -3.71998027e-01 -1.16346231e-01]
 [ 5.59456043e-02 -9.88681607e-02 -6.16381994e-02]
 [-2.47318110e-01  4.45004462e-01  3.14409455e-01]
 [ 1.06154379e-01 -6.12602429e-01 -1.75906997e-01]
 [ 1.50693238e-01 -2.06134324e-01 -1.13123395e-01]
 [-2.94833549e-01 -1.24931393e-01 -5.01975369e-02]
 [ 2.08055584e-01  1.18173570e+00  2.46545536e-01]
 [-3.57624428e-01 -5.93721987e-02  2.72681420e-01]
 [-8.56738523e-02 -4.40372255e-02 -4.60638446e-02]
 [ 1.75601092e-01 -4.88938234e-02  9.44157058e-02]
 [-1.01220532e-01  5.40917566e-02 -1.13496203e-01]
 [-2.25383517e-02 -9.85827883e-02  8.53237396e-02]
 [-1.03736306e-01  7.94071308e-02 -2.43007752e-02]
 [ 9.07790833e-02 -1.51180053e-01 -1.76684825e-01]
 [ 6.48005080e-02 -3.13226337e-02  1.06800759e-01]
 [-1.68808907e-01  3.85531254e-02  1.61457623e-01]
 [-3.97134876e-01 -1.17736067e-02 -5.81669351e-01]
 [ 1.73916571e-01 -1.18971540e-01 -1.47854153e-01]
 [ 1.29028301e-01  5.34074919e-03 -2.99327707e-02]
 [ 3.13728044e-02  1.65451079e-01 -4.37953263e-02]
 [-1.30475396e-01  5.91190077e-03 -1.50363524e-01]
 [-5.72541136e-02  1.42415320e-01  1.07355151e-01]
 [-5.33341631e-02  1.32900945e-02  5.52619530e-02]
 [-7.43023983e-02 -4.90492885e-02 -6.73585513e-03]
 [ 1.05650881e-01  8.88838630e-02  2.35033511e-02]
 [-1.24302325e-01  1.64708134e-01 -6.80626598e-04]
 [ 2.26261417e-03 -2.52710954e-01  8.69943453e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.27577042]
curr_Stock_Price:  99.35023072128887
curr_Factors:  [99.35023072 -0.88126934 -0.98631632]
mat_Sqrt:  [[15.34923484  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01024807  0.04920464  0.73478255]
Stock Position:  -0.010248067908678413
Bond Position:  [-1.25762251]


portfolio before change:  [-2.27940051]
curr_Stock_Price:  99.68911191603028
curr_Factors:  [99.68911192 -0.95573818 -0.99504244]
mat_Sqrt:  [[14.17210848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320214  0.01411938  0.0859571 ]
Stock Position:  -0.0032021377000832165
Bond Position:  [-1.96018225]


portfolio before change:  [-2.27942809]
curr_Stock_Price:  99.6212003140386
curr_Factors:  [99.62120031 -0.86495147 -0.95542869]
mat_Sqrt:  [[16.13506467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02266995 0.09213993 1.13529801]
Stock Position:  0.022669946786116228
Bond Position:  [-4.5378354]


portfolio before change:  [-2.28840115]
curr_Stock_Price:  99.25041025278406
curr_Factors:  [99.25041025 -0.72498383 -0.9638019 ]
mat_Sqrt:  [[18.33588957  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0024311  0.01810151 0.41266635]
Stock Position:  0.0024310967950628756
Bond Position:  [-2.5296885]


portfolio before change:  [-2.2885985]
curr_Stock_Price:  99.29931039233857
curr_Factors:  [99.29931039 -0.59176999 -0.97270194]
mat_Sqrt:  [[20.77326252  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01357683 -0.03003541  0.13006662]
Stock Position:  -0.013576834113520507
Bond Position:  [-0.94042823]


portfolio before change:  [-2.29012463]
curr_Stock_Price:  99.40305898829826
curr_Factors:  [99.40305899 -0.82961383 -0.95447143]
mat_Sqrt:  [[16.69480557  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155994 -0.03722391 -0.41870593]
Stock Position:  -0.0015599404106049306
Bond Position:  [-2.13506179]


portfolio before change:  [-2.28961573]
curr_Stock_Price:  98.90572952441299
curr_Factors:  [98.90572952 -0.57478454 -0.96969442]
mat_Sqrt:  [[21.10876184  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128507 -0.03728958 -0.04346876]
Stock Position:  0.001285070347384945
Bond Position:  [-2.41671655]


portfolio before change:  [-2.28955007]
curr_Stock_Price:  99.19191657550947
curr_Factors:  [99.19191658 -0.66795079 -0.93537348]
mat_Sqrt:  [[19.96003959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00868239  0.03281188 -0.10664503]
Stock Position:  0.008682389272443022
Bond Position:  [-3.1507729]


portfolio before change:  [-2.3009091]
curr_Stock_Price:  97.92899701376037
curr_Factors:  [97.92899701 -0.60937539 -0.92555862]
mat_Sqrt:  [[21.10075217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00845077  0.00292145 -0.18736482]
Stock Position:  -0.008450769747971341
Bond Position:  [-1.47333369]


portfolio before change:  [-2.30607912]
curr_Stock_Price:  98.51898344134086
curr_Factors:  [98.51898344 -0.45622171 -0.94624223]
mat_Sqrt:  [[24.23469562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00435011 -0.00850151  0.08596476]
Stock Position:  0.004350111052058075
Bond Position:  [-2.73464763]


portfolio before change:  [-2.30973711]
curr_Stock_Price:  97.75667090911743
curr_Factors:  [97.75667091 -0.88914593 -0.93343574]
mat_Sqrt:  [[15.79825947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00724985 -0.07908053 -0.02550886]
Stock Position:  0.007249852435817402
Bond Position:  [-3.01845855]


portfolio before change:  [-2.31333499]
curr_Stock_Price:  97.31244829439693
curr_Factors:  [97.31244829 -0.81931722 -0.9192776 ]
mat_Sqrt:  [[17.10433776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00744862 -0.02537175 -0.4976571 ]
Stock Position:  -0.007448623266059493
Bond Position:  [-1.58849123]


portfolio before change:  [-2.30555358]
curr_Stock_Price:  96.24111147239599
curr_Factors:  [96.24111147 -0.70541387 -0.92575304]
mat_Sqrt:  [[18.83448901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01397392 -0.1176361  -0.33190341]
Stock Position:  0.013973915305786263
Bond Position:  [-3.65041872]


portfolio before change:  [-2.30383079]
curr_Stock_Price:  96.39705335924877
curr_Factors:  [96.39705336 -0.55533987 -0.94336686]
mat_Sqrt:  [[21.53692491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00189493 -0.03126486 -0.17583663]
Stock Position:  0.001894931366802599
Bond Position:  [-2.48649659]


portfolio before change:  [-2.30692781]
curr_Stock_Price:  94.92671634664781
curr_Factors:  [94.92671635 -0.33801798 -0.9319498 ]
mat_Sqrt:  [[26.65928272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00643864  0.14072277  0.89692266]
Stock Position:  -0.006438642193932436
Bond Position:  [-1.69572865]


portfolio before change:  [-2.30533734]
curr_Stock_Price:  94.64677362417038
curr_Factors:  [94.64677362 -0.29994451 -0.92800243]
mat_Sqrt:  [[27.72140471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00196347 -0.1937219  -0.5018137 ]
Stock Position:  0.001963471469974511
Bond Position:  [-2.49117358]


portfolio before change:  [-2.30669762]
curr_Stock_Price:  94.1125836477886
curr_Factors:  [94.11258365 -0.60366903 -0.94411595]
mat_Sqrt:  [[20.01949979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00610803 -0.0651854  -0.32270956]
Stock Position:  0.006108027551896016
Bond Position:  [-2.88153988]


portfolio before change:  [-2.30058705]
curr_Stock_Price:  95.17197452995136
curr_Factors:  [95.17197453 -1.00341537 -0.93241644]
mat_Sqrt:  [[13.73371435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02244883 -0.03950678 -0.1431996 ]
Stock Position:  -0.022448828108373346
Bond Position:  [-0.16408775]


portfolio before change:  [-2.27930843]
curr_Stock_Price:  94.2231886975868
curr_Factors:  [94.2231887  -0.97875997 -0.90663387]
mat_Sqrt:  [[14.30018498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0202021  0.37369764 0.70332579]
Stock Position:  0.020202099898583896
Bond Position:  [-4.1828147]


portfolio before change:  [-2.26694056]
curr_Stock_Price:  94.86127872473014
curr_Factors:  [94.86127872 -0.84291296 -0.90419993]
mat_Sqrt:  [[16.53207946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01835804 -0.01877514  0.77788419]
Stock Position:  -0.018358038390530282
Bond Position:  [-0.52547356]


portfolio before change:  [-2.26930778]
curr_Stock_Price:  94.98664820099617
curr_Factors:  [94.9866482  -1.07582155 -0.87654614]
mat_Sqrt:  [[13.48217768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00713636 -0.01392579 -0.13140733]
Stock Position:  -0.007136356886307474
Bond Position:  [-1.59144916]


portfolio before change:  [-2.26908379]
curr_Stock_Price:  94.92738348093688
curr_Factors:  [94.92738348 -1.08085597 -0.84757072]
mat_Sqrt:  [[13.80023369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01402956 -0.01546158  0.26934173]
Stock Position:  0.014029558393299139
Bond Position:  [-3.60087306]


portfolio before change:  [-2.26936103]
curr_Stock_Price:  94.93970747936771
curr_Factors:  [94.93970748 -0.90945711 -0.8725151 ]
mat_Sqrt:  [[15.97891155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0076971   0.01710532 -0.32377308]
Stock Position:  -0.00769709524235364
Bond Position:  [-1.53860106]


portfolio before change:  [-2.26235479]
curr_Stock_Price:  94.00447424331608
curr_Factors:  [94.00447424 -1.10292611 -0.86646339]
mat_Sqrt:  [[13.11757433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058449 -0.03117461  0.24340488]
Stock Position:  -0.0005844916698357457
Bond Position:  [-2.20740996]


portfolio before change:  [-2.26295923]
curr_Stock_Price:  94.56648940611804
curr_Factors:  [94.56648941 -1.19688082 -0.8963615 ]
mat_Sqrt:  [[11.65879526  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00914729  0.02511074 -0.06932335]
Stock Position:  -0.009147291388890982
Bond Position:  [-1.39793199]


portfolio before change:  [-2.26791396]
curr_Stock_Price:  95.08904643845341
curr_Factors:  [95.08904644 -0.98587763 -0.89929095]
mat_Sqrt:  [[14.43484687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00351995 -0.04780733 -0.50403263]
Stock Position:  0.0035199536784301486
Bond Position:  [-2.602623]


portfolio before change:  [-2.27056326]
curr_Stock_Price:  94.42882335094126
curr_Factors:  [94.42882335 -1.0347446  -0.90239847]
mat_Sqrt:  [[13.60861816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00630427 -0.00990509  0.30467284]
Stock Position:  0.006304267908470579
Bond Position:  [-2.86586786]


portfolio before change:  [-2.27260025]
curr_Stock_Price:  94.1625375378217
curr_Factors:  [94.16253754 -1.22726851 -0.91579299]
mat_Sqrt:  [[11.04481303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0122099   0.01219157  0.46059366]
Stock Position:  -0.012209900663530168
Bond Position:  [-1.12288503]


portfolio before change:  [-2.2764789]
curr_Stock_Price:  94.46870505905869
curr_Factors:  [94.46870506 -1.22151706 -0.88505805]
mat_Sqrt:  [[11.49248685  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04491383 -0.00372314 -1.65934075]
Stock Position:  -0.044913832381723376
Bond Position:  [1.96647269]


portfolio before change:  [-2.33812295]
curr_Stock_Price:  95.8466741063655
curr_Factors:  [95.84667411 -1.40570467 -0.90645622]
mat_Sqrt:  [[ 9.49332466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01481716 -0.0376221  -0.42178674]
Stock Position:  0.01481716273760144
Bond Position:  [-3.75829871]


portfolio before change:  [-2.33332577]
curr_Stock_Price:  96.20213993692711
curr_Factors:  [96.20213994 -1.30048543 -0.90021802]
mat_Sqrt:  [[10.65200511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0115524   0.00168889 -0.08538986]
Stock Position:  0.011552397513069542
Bond Position:  [-3.44469113]


portfolio before change:  [-2.33084497]
curr_Stock_Price:  96.45415766267881
curr_Factors:  [96.45415766 -1.42421182 -0.89052495]
mat_Sqrt:  [[ 9.52891705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00280253  0.05232023 -0.12493588]
Stock Position:  0.002802527210897925
Bond Position:  [-2.60116037]


portfolio before change:  [-2.32933297]
curr_Stock_Price:  97.10969551623943
curr_Factors:  [97.10969552 -1.54053602 -0.91452205]
mat_Sqrt:  [[ 8.33766461  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01931183  0.00186951 -0.42894528]
Stock Position:  -0.019311831896232146
Bond Position:  [-0.45396686]


portfolio before change:  [-2.32632619]
curr_Stock_Price:  96.95106019778854
curr_Factors:  [96.9510602  -1.68971843 -0.90792763]
mat_Sqrt:  [[ 7.2178726   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00438678  0.04503568  0.30625436]
Stock Position:  -0.004386775601263284
Bond Position:  [-1.90102364]


portfolio before change:  [-2.32653085]
curr_Stock_Price:  96.94354274605672
curr_Factors:  [96.94354275 -1.80536498 -0.89920596]
mat_Sqrt:  [[ 6.48542816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00643145  0.0042027   0.15764697]
Stock Position:  -0.006431451313601304
Bond Position:  [-1.70304318]


portfolio before change:  [-2.32264891]
curr_Stock_Price:  96.30685338470619
curr_Factors:  [96.30685338 -1.63052634 -0.90117168]
mat_Sqrt:  [[ 7.65869394  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01004659 -0.01551075 -0.01921552]
Stock Position:  -0.01004659499243744
Bond Position:  [-1.35509296]


portfolio before change:  [-2.32113228]
curr_Stock_Price:  96.1390329600378
curr_Factors:  [96.13903296 -1.48351149 -0.91498425]
mat_Sqrt:  [[ 8.73466564  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01290759 0.02810755 0.06704852]
Stock Position:  0.012907586698595142
Bond Position:  [-3.56205518]


portfolio before change:  [-2.31543882]
curr_Stock_Price:  96.6146251780456
curr_Factors:  [96.61462518 -1.48042507 -0.9086731 ]
mat_Sqrt:  [[ 8.86075481  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01356414  0.05208529 -0.00194164]
Stock Position:  -0.013564139226781537
Bond Position:  [-1.00494459]


portfolio before change:  [-2.31669303]
curr_Stock_Price:  96.69782885945953
curr_Factors:  [96.69782886 -1.53813976 -0.90154013]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.31669303]
Stock Price:  96.31006665389803
PL:  [-2.31669303]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.46440779e-01  3.52517325e-02  2.00733511e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.37841531e-01  3.18990209e-01  4.65402663e-01]
 [-9.07542239e-02 -1.96539383e-02  7.28944672e-02]
 [-4.55508152e-01 -1.42176963e-01  4.15221412e-02]
 [ 2.55177837e-02 -1.38453900e-01 -1.82415674e-01]
 [ 2.86762754e-02 -1.59187007e-01 -2.38264850e-02]
 [ 2.82789422e-01  1.71662809e-01 -8.35513781e-02]
 [-3.35848921e-01 -1.71467455e-03 -9.55036524e-02]
 [ 5.17143890e-02 -2.46253097e-02 -4.48416532e-02]
 [ 4.00190784e-02 -3.14262380e-01  7.94387201e-02]
 [-3.46844557e-02 -4.99577368e-02 -1.06853358e-01]
 [ 2.29566976e-01 -2.40525209e-01  4.56661473e-02]
 [ 8.81397775e-02 -7.58445200e-02 -4.44018804e-02]
 [-1.29588887e-01  1.55113165e-01  1.20848892e-01]
 [ 2.90464495e-02 -2.98636609e-01 -7.27142672e-02]
 [-3.28847944e-01 -2.72847455e-01  7.57094402e-02]
 [-2.25384459e-01 -5.74980984e-02 -3.82757649e-02]
 [ 2.70331317e-01  1.14570721e+00  3.25320401e-01]
 [-2.70024623e-01 -3.83102257e-02  2.18536343e-01]
 [-9.27722975e-02  1.86219740e-01 -3.52671378e-02]
 [-9.79487153e-03  3.62024546e-02 -6.34544096e-03]
 [ 1.84577195e-02 -2.99733731e-02  8.00489396e-03]
 [ 4.68046988e-02  1.89216156e-01  1.03085587e-01]
 [-6.51761453e-02 -1.68020202e-01 -2.18947070e-02]
 [ 2.38200965e-02  6.07714048e-02 -1.28715879e-02]
 [ 1.80794690e-02 -7.03522384e-02 -4.13064681e-03]
 [ 5.06367956e-02  5.46756637e-02 -7.33570099e-02]
 [-7.10259139e-01 -1.51844502e-01 -1.10998075e+00]
 [-1.10272466e-01  2.15046460e-02  2.71927302e-02]
 [-1.27656751e-03 -3.48402244e-02  1.09859369e-01]
 [ 2.03953709e-02  7.84334191e-02 -1.59334512e-03]
 [-1.21814656e-01 -1.03834014e-02 -7.38189431e-02]
 [-6.01616543e-02  1.25612155e-01  1.28178021e-01]
 [ 1.75986315e-01 -1.64500586e-01 -9.42327924e-02]
 [-3.48306819e-03  1.09831020e-01  7.86939014e-02]
 [ 1.13746279e-02  1.12396861e-02 -4.50814789e-02]
 [-7.69747611e-02  4.82658912e-02 -3.31382136e-03]
 [-5.76592380e-02 -2.39236576e-01  1.02795956e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.01112005]
curr_Stock_Price:  99.6657643811399
curr_Factors:  [99.66576438 -0.80594206 -1.0174906 ]
mat_Sqrt:  [[16.09308347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0127108   0.01114758  0.57263683]
Stock Position:  -0.012710803835435753
Bond Position:  [1.25571193]


portfolio before change:  [-0.01458099]
curr_Stock_Price:  99.9503974544624
curr_Factors:  [99.95039745 -0.87178921 -1.01519367]
mat_Sqrt:  [[15.14531361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299638  0.01411938  0.0859571 ]
Stock Position:  -0.0029963752498101686
Bond Position:  [0.28490791]


portfolio before change:  [-0.01138486]
curr_Stock_Price:  98.89561901455193
curr_Factors:  [98.89561901 -0.87535462 -1.00266803]
mat_Sqrt:  [[15.12036165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02255751 0.10087356 1.32766426]
Stock Position:  0.022557512300413446
Bond Position:  [-2.242224]


portfolio before change:  [-0.01868971]
curr_Stock_Price:  98.58421248461379
curr_Factors:  [98.58421248 -1.25837311 -0.98890542]
mat_Sqrt:  [[10.41901596  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00733103 -0.00621512  0.20794762]
Stock Position:  -0.007331034515407726
Bond Position:  [0.70403455]


portfolio before change:  [-0.02018626]
curr_Stock_Price:  98.80035649145564
curr_Factors:  [98.80035649 -0.96943262 -1.01291252]
mat_Sqrt:  [[13.60933657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03311723 -0.0449603   0.11845111]
Stock Position:  -0.03311722592242438
Bond Position:  [3.25180747]


portfolio before change:  [-0.01515817]
curr_Stock_Price:  98.66080406951295
curr_Factors:  [98.66080407 -1.21999819 -1.04616752]
mat_Sqrt:  [[10.23202025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149458 -0.04378297 -0.52038114]
Stock Position:  -0.0014945752449160177
Bond Position:  [0.13229782]


portfolio before change:  [-0.01467346]
curr_Stock_Price:  98.34755329465978
curr_Factors:  [98.34755329 -1.34821058 -1.03076149]
mat_Sqrt:  [[ 9.11148398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00216238 -0.05033935 -0.06797033]
Stock Position:  0.0021623836107181214
Bond Position:  [-0.22733859]


portfolio before change:  [-0.0145297]
curr_Stock_Price:  98.42717362720276
curr_Factors:  [98.42717363 -1.2858807  -1.00776894]
mat_Sqrt:  [[ 9.93106065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02720423  0.05428455 -0.23834883]
Stock Position:  0.027204232493340273
Bond Position:  [-2.69216542]


portfolio before change:  [0.01431118]
curr_Stock_Price:  99.49970622111303
curr_Factors:  [99.49970622 -1.13977759 -0.98980543]
mat_Sqrt:  [[11.82920731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03004325 -0.00054223 -0.27244534]
Stock Position:  -0.03004324680997135
Bond Position:  [3.00360541]


portfolio before change:  [-0.00310472]
curr_Stock_Price:  100.09189820946884
curr_Factors:  [100.09189821  -0.90677624  -0.98017523]
mat_Sqrt:  [[15.16723144  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0027642  -0.00778721 -0.12792076]
Stock Position:  0.0027642026994905435
Bond Position:  [-0.27977901]


portfolio before change:  [-0.0037365]
curr_Stock_Price:  99.87599267191852
curr_Factors:  [99.87599267 -0.76755208 -0.98059816]
mat_Sqrt:  [[17.38797902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00276744 -0.09937849  0.22661656]
Stock Position:  0.0027674417752739625
Bond Position:  [-0.28013749]


portfolio before change:  [-0.00833376]
curr_Stock_Price:  98.22745172384793
curr_Factors:  [98.22745172 -0.83811255 -0.98170064]
mat_Sqrt:  [[15.91835007  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00363013 -0.01579802 -0.30482289]
Stock Position:  -0.0036301318376465498
Bond Position:  [0.34824484]


portfolio before change:  [-0.00782166]
curr_Stock_Price:  98.0983760288547
curr_Factors:  [98.09837603 -0.77029373 -1.00852815]
mat_Sqrt:  [[16.56262961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01404839 -0.07606075  0.13027281]
Stock Position:  0.014048385482173223
Bond Position:  [-1.38594546]


portfolio before change:  [-0.0238204]
curr_Stock_Price:  96.97187776867568
curr_Factors:  [96.97187777 -0.6177888  -0.99625444]
mat_Sqrt:  [[19.30526354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00399466 -0.02398414 -0.12666621]
Stock Position:  0.003994661062715654
Bond Position:  [-0.41119018]


portfolio before change:  [-0.02249433]
curr_Stock_Price:  97.31670521368329
curr_Factors:  [97.31670521 -0.90318911 -0.95672963]
mat_Sqrt:  [[15.15077857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00666076  0.04905109  0.34474825]
Stock Position:  -0.0066607603483575
Bond Position:  [0.62570892]


portfolio before change:  [-0.01994038]
curr_Stock_Price:  96.94501628322047
curr_Factors:  [96.94501628 -0.82849418 -0.96888314]
mat_Sqrt:  [[16.06698676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040412 -0.09443719 -0.20743356]
Stock Position:  0.000404117329841995
Bond Position:  [-0.05911754]


portfolio before change:  [-0.01946811]
curr_Stock_Price:  98.13196506447878
curr_Factors:  [98.13196506 -0.89410225 -0.94504852]
mat_Sqrt:  [[15.59830699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02054317 -0.08628194  0.21597796]
Stock Position:  -0.02054317241890465
Bond Position:  [1.99647377]


portfolio before change:  [-0.01252348]
curr_Stock_Price:  97.80606331527254
curr_Factors:  [97.80606332 -1.08130308 -0.9387535 ]
mat_Sqrt:  [[12.97377478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01808896 -0.0181825  -0.1091901 ]
Stock Position:  -0.018088957589502443
Bond Position:  [1.75668626]


portfolio before change:  [0.0042455]
curr_Stock_Price:  96.89117521923768
curr_Factors:  [96.89117522 -0.78123362 -0.91231673]
mat_Sqrt:  [[17.81495194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02056245 0.36230443 0.92804855]
Stock Position:  0.0205624522430403
Bond Position:  [-1.98807467]


portfolio before change:  [0.01001378]
curr_Stock_Price:  97.18378671108606
curr_Factors:  [97.18378671 -0.72238453 -0.94144416]
mat_Sqrt:  [[18.40781335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01229941 -0.01211476  0.62342336]
Stock Position:  -0.012299410075091532
Bond Position:  [1.20531703]


portfolio before change:  [0.00380956]
curr_Stock_Price:  97.7004694077459
curr_Factors:  [97.70046941 -0.89122746 -0.9555732 ]
mat_Sqrt:  [[15.41137234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00617486  0.05888785 -0.10060733]
Stock Position:  -0.0061748556048508985
Bond Position:  [0.60709585]


portfolio before change:  [-0.01010853]
curr_Stock_Price:  99.96675413970259
curr_Factors:  [99.96675414 -0.98956963 -0.9748159 ]
mat_Sqrt:  [[14.01954095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072437  0.01144822 -0.01810178]
Stock Position:  -0.0007243736386646325
Bond Position:  [0.06230475]


portfolio before change:  [-0.00953506]
curr_Stock_Price:  99.18583568475134
curr_Factors:  [99.18583568 -0.81771252 -1.00201736]
mat_Sqrt:  [[16.07500116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120173 -0.00947841  0.02283573]
Stock Position:  0.0012017294635183085
Bond Position:  [-0.1287296]


portfolio before change:  [-0.00895798]
curr_Stock_Price:  99.67943476392763
curr_Factors:  [99.67943476 -0.81640375 -0.99961234]
mat_Sqrt:  [[16.2151064   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00448548 0.0598354  0.29407449]
Stock Position:  0.004485477586894465
Bond Position:  [-0.45606785]


portfolio before change:  [-0.00810347]
curr_Stock_Price:  99.88265143315215
curr_Factors:  [99.88265143 -0.74422171 -1.01570418]
mat_Sqrt:  [[17.18557063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430499 -0.05313265 -0.0624595 ]
Stock Position:  -0.004304986330616734
Bond Position:  [0.42188998]


portfolio before change:  [-0.01319458]
curr_Stock_Price:  101.07750950198191
curr_Factors:  [101.0775095   -0.70872878  -1.01511925]
mat_Sqrt:  [[18.03004639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00126244  0.01921761 -0.03671906]
Stock Position:  0.0012624374359556448
Bond Position:  [-0.14079861]


portfolio before change:  [-0.0129247]
curr_Stock_Price:  101.30522711537438
curr_Factors:  [101.30522712  -0.77718123  -0.97529974]
mat_Sqrt:  [[17.56058746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00087809 -0.02224733 -0.01178359]
Stock Position:  0.0008780923360138624
Bond Position:  [-0.10188004]


portfolio before change:  [-0.01151451]
curr_Stock_Price:  102.925697785631
curr_Factors:  [102.92569779  -0.74515027  -1.00118239]
mat_Sqrt:  [[17.95151827  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00206526  0.01728996 -0.20926713]
Stock Position:  0.002065261427819169
Bond Position:  [-0.22408299]


portfolio before change:  [-0.01070157]
curr_Stock_Price:  103.33288864281724
curr_Factors:  [103.33288864  -0.71386516  -1.0099737 ]
mat_Sqrt:  [[18.43252637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05103769 -0.04801745 -3.16646613]
Stock Position:  -0.051037692879064595
Bond Position:  [5.26317067]


portfolio before change:  [-0.03481855]
curr_Stock_Price:  103.81831259702706
curr_Factors:  [103.8183126   -0.61561108  -1.00636774]
mat_Sqrt:  [[20.50489335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508008  0.00680037  0.07757329]
Stock Position:  -0.0050800813140863595
Bond Position:  [0.49258692]


portfolio before change:  [-0.03440142]
curr_Stock_Price:  103.74832218569799
curr_Factors:  [103.74832219  -0.75973283  -0.98810753]
mat_Sqrt:  [[18.06773276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112072 -0.01101745  0.3133982 ]
Stock Position:  0.001120716796446093
Bond Position:  [-0.1506739]


portfolio before change:  [-0.0344862]
curr_Stock_Price:  103.68947251689104
curr_Factors:  [103.68947252  -0.78879551  -0.98581856]
mat_Sqrt:  [[17.58043286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125681  0.02480282 -0.00454537]
Stock Position:  0.0012568105130891642
Bond Position:  [-0.16480422]


portfolio before change:  [-0.0343724]
curr_Stock_Price:  103.79641470785104
curr_Factors:  [103.79641471  -0.65769471  -0.98012139]
mat_Sqrt:  [[20.17845261  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0067969  -0.00328352 -0.2105849 ]
Stock Position:  -0.006796902871163139
Bond Position:  [0.67112175]


portfolio before change:  [-0.03960547]
curr_Stock_Price:  104.57867732234232
curr_Factors:  [104.57867732  -0.65408967  -0.98056963]
mat_Sqrt:  [[20.3948084   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150794  0.03972205  0.36565622]
Stock Position:  -0.001507939316769417
Bond Position:  [0.11809283]


portfolio before change:  [-0.03925729]
curr_Stock_Price:  104.35757325157742
curr_Factors:  [104.35757325  -0.8889718   -0.97755439]
mat_Sqrt:  [[16.13994108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00944884 -0.05201965 -0.26881993]
Stock Position:  0.009448841177402603
Bond Position:  [-1.02531543]


portfolio before change:  [-0.05047106]
curr_Stock_Price:  103.18435054806197
curr_Factors:  [103.18435055  -0.91849387  -0.96229213]
mat_Sqrt:  [[15.73254022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00097989 0.03473162 0.2244918 ]
Stock Position:  0.0009798851099686965
Bond Position:  [-0.15157987]


portfolio before change:  [-0.05080658]
curr_Stock_Price:  102.86127707375175
curr_Factors:  [102.86127707  -0.92378768  -0.99446896]
mat_Sqrt:  [[15.10649249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00016302  0.0035543  -0.12860491]
Stock Position:  0.0001630171257776901
Bond Position:  [-0.06757473]


portfolio before change:  [-0.05088865]
curr_Stock_Price:  102.40970731110865
curr_Factors:  [102.40970731  -1.14855309  -0.94395369]
mat_Sqrt:  [[12.63505038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00604707  0.01526301 -0.00945341]
Stock Position:  -0.006047065096353214
Bond Position:  [0.56838952]


portfolio before change:  [-0.05364937]
curr_Stock_Price:  102.87799759134516
curr_Factors:  [102.87799759  -1.22058147  -0.97078792]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.05364937]
Stock Price:  103.36137681125207
PL:  [-3.41502619]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.64207972e-01  2.24251980e-01  2.54092830e-01]
 [-1.19939411e-01 -6.40404856e-03  1.35064085e-01]
 [ 2.52797909e-01  3.61824430e-01  5.25997522e-01]
 [-2.48090032e-02  4.23077987e-02  1.22778370e-01]
 [-6.89286995e-01 -2.08397554e-01  3.58091868e-02]
 [-4.47614676e-02 -1.85092071e-02  3.66859800e-03]
 [ 3.38119945e-02  1.24798813e-02 -2.13112304e-02]
 [ 3.53708399e-01 -5.19646214e-03 -9.25649480e-02]
 [-5.19584654e-01 -3.01613865e-02 -5.74700065e-02]
 [ 2.36496400e-02  2.30536815e-02 -2.24995621e-02]
 [-2.61928893e-02 -1.95814914e-01  1.33870624e-01]
 [-9.61697462e-02  9.81698250e-03  6.55247138e-02]
 [ 1.33524412e-01 -4.57194575e-02  2.92179587e-01]
 [ 1.23549696e-02  4.44250696e-01  3.95118417e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-1.41991674e-02 -1.16586785e-02  3.55569145e-02]
 [-5.57692780e-01 -2.73762529e-01  1.62515948e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 2.55410498e-01  1.03038813e+00  4.06662894e-01]
 [ 1.04660415e-02  1.06037722e-02  3.06767158e-02]
 [-2.58577744e-02 -1.10585362e-01 -4.08436254e-03]
 [-2.71826055e-02  5.63076151e-02 -2.64447175e-02]
 [ 7.32479657e-02 -3.39009837e-02  9.62555911e-02]
 [ 7.84296916e-02  5.09718953e-02 -5.33778225e-03]
 [-5.78336339e-02 -1.47354287e-01  1.24249616e-01]
 [ 1.74698534e-02  6.26507700e-02 -1.65764672e-02]
 [-9.63369311e-02  3.72682659e-02  2.06258500e-02]
 [ 9.47319421e-03  4.81618030e-02 -6.59820333e-02]
 [-6.09681070e-01 -2.38730587e-02 -8.92335702e-01]
 [-2.55889414e-01  1.12114536e-01 -1.44099065e-02]
 [-9.18978938e-02  3.29532223e-02  1.10071161e-01]
 [ 8.45432677e-03  1.01469409e-02  3.31251409e-02]
 [-1.29467580e-01 -4.10794668e-04 -1.42955109e-01]
 [-6.54942320e-02 -2.06930943e-03  4.72014211e-02]
 [ 2.10272985e-01 -1.70749697e-01 -8.04583011e-02]
 [ 4.74847163e-03  5.07717736e-02  7.67137870e-02]
 [-4.19295635e-03 -4.81830643e-03 -4.69555469e-02]
 [-7.30380255e-02  6.16271209e-02 -4.06006946e-03]
 [-5.43723148e-02 -2.65453433e-01  1.20126544e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.86055476]
curr_Stock_Price:  99.26875274041998
curr_Factors:  [99.26875274 -0.96461364 -1.00891072]
mat_Sqrt:  [[13.79500386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00772391  0.0709147   0.72485612]
Stock Position:  -0.00772390718172017
Bond Position:  [-2.09381212]


portfolio before change:  [-2.85322651]
curr_Stock_Price:  98.28609113815156
curr_Factors:  [98.28609114 -0.64309377 -0.97985425]
mat_Sqrt:  [[19.39343308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00477146 -0.00202514  0.38530024]
Stock Position:  -0.004771456462152164
Bond Position:  [-2.38425871]


portfolio before change:  [-2.85488626]
curr_Stock_Price:  98.57147435673878
curr_Factors:  [98.57147436 -0.80069849 -0.96487883]
mat_Sqrt:  [[16.86439508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0219106  0.11441893 1.50052452]
Stock Position:  0.021910597381461335
Bond Position:  [-5.01464614]


portfolio before change:  [-2.85257646]
curr_Stock_Price:  98.70550392457892
curr_Factors:  [98.70550392 -0.78412149 -0.96477792]
mat_Sqrt:  [[17.17133283  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [7.83520543e-05 1.33789007e-02 3.50252514e-01]
Stock Position:  7.83520543094941e-05
Bond Position:  [-2.86031024]


portfolio before change:  [-2.85282122]
curr_Stock_Price:  100.14509696038208
curr_Factors:  [100.14509696  -0.92477164  -0.95916083]
mat_Sqrt:  [[15.22117641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04515803 -0.06590109  0.10215364]
Stock Position:  -0.04515802579385991
Bond Position:  [1.66953365]


portfolio before change:  [-2.88718252]
curr_Stock_Price:  100.91063093015535
curr_Factors:  [100.91063093  -0.97039397  -0.94966569]
mat_Sqrt:  [[14.7933185   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300747 -0.00585313  0.01046549]
Stock Position:  -0.0030074742054890823
Bond Position:  [-2.5836964]


portfolio before change:  [-2.88477873]
curr_Stock_Price:  100.00396485571258
curr_Factors:  [100.00396486  -1.05927873  -0.96586152]
mat_Sqrt:  [[13.19805652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0022567   0.00394648 -0.06079501]
Stock Position:  0.002256702490819468
Bond Position:  [-3.11045793]


portfolio before change:  [-2.8825764]
curr_Stock_Price:  101.15217299182079
curr_Factors:  [101.15217299  -1.26268361  -0.92699347]
mat_Sqrt:  [[11.32427846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02955416 -0.00164327 -0.26406203]
Stock Position:  0.029554155439425207
Bond Position:  [-5.87204344]


portfolio before change:  [-2.8636243]
curr_Stock_Price:  101.81827725321489
curr_Factors:  [101.81827725  -1.34807763  -0.92996369]
mat_Sqrt:  [[10.43482027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0509922  -0.00953787 -0.16394593]
Stock Position:  -0.05099219919920277
Bond Position:  [2.32831358]


portfolio before change:  [-2.86406609]
curr_Stock_Price:  101.83264893511526
curr_Factors:  [101.83264894  -1.31651883  -0.90057111]
mat_Sqrt:  [[11.09218529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177171  0.00729021 -0.06418499]
Stock Position:  0.0017717139691608152
Bond Position:  [-3.04448441]


portfolio before change:  [-2.86305091]
curr_Stock_Price:  102.62044887752297
curr_Factors:  [102.62044888  -1.39474933  -0.90507412]
mat_Sqrt:  [[10.29042424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.81187574e-04 -6.19221127e-02  3.81895629e-01]
Stock Position:  -0.000381187574008988
Bond Position:  [-2.82393327]


portfolio before change:  [-2.86337509]
curr_Stock_Price:  102.54479427003079
curr_Factors:  [102.54479427  -1.57250419  -0.92825418]
mat_Sqrt:  [[ 8.41100819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00981346  0.0031044   0.18692377]
Stock Position:  -0.009813460499459921
Bond Position:  [-1.8570558]


portfolio before change:  [-2.8609209]
curr_Stock_Price:  102.27105400978779
curr_Factors:  [102.27105401  -1.63777312  -0.94153863]
mat_Sqrt:  [[ 7.75482268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02475683 -0.01445776  0.83350703]
Stock Position:  0.024756832906016588
Bond Position:  [-5.39282829]


portfolio before change:  [-2.85567073]
curr_Stock_Price:  102.51035396531248
curr_Factors:  [102.51035397  -1.6749199   -0.91149404]
mat_Sqrt:  [[ 7.71795835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01353709 0.14048441 1.12716286]
Stock Position:  0.013537088142060203
Bond Position:  [-4.24336243]


portfolio before change:  [-2.85580286]
curr_Stock_Price:  102.53977892017635
curr_Factors:  [102.53977892  -1.67448854  -0.92080482]
mat_Sqrt:  [[ 7.65192655  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00560985 -0.03587186 -0.12433753]
Stock Position:  0.005609846530334701
Bond Position:  [-3.43103528]


portfolio before change:  [-2.8571183]
curr_Stock_Price:  102.38174687628612
curr_Factors:  [102.38174688  -1.61140595  -0.95006433]
mat_Sqrt:  [[ 7.90296626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091639 -0.0036868   0.10143398]
Stock Position:  -0.0009163861005313583
Bond Position:  [-2.76329709]


portfolio before change:  [-2.85721585]
curr_Stock_Price:  102.11124212749183
curr_Factors:  [102.11124213  -1.49975559  -0.97370303]
mat_Sqrt:  [[ 8.60724427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06176052 -0.08657131  0.46361276]
Stock Position:  -0.06176051855467432
Bond Position:  [3.44922742]


portfolio before change:  [-2.89404956]
curr_Stock_Price:  102.71461939392795
curr_Factors:  [102.71461939  -1.49434081  -0.98527534]
mat_Sqrt:  [[ 8.60495595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01525994  0.00580111 -0.05715682]
Stock Position:  -0.015259936769855693
Bond Position:  [-1.32663096]


portfolio before change:  [-2.89127736]
curr_Stock_Price:  102.52208681703003
curr_Factors:  [102.52208682  -1.2353536   -0.97390748]
mat_Sqrt:  [[11.25505284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03243208 0.32583734 1.16009604]
Stock Position:  0.03243207528638192
Bond Position:  [-6.2162814]


portfolio before change:  [-2.93098506]
curr_Stock_Price:  101.32171313241034
curr_Factors:  [101.32171313  -1.27666086  -0.94538549]
mat_Sqrt:  [[10.981965    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00154815 0.00335321 0.08751213]
Stock Position:  0.0015481462684186684
Bond Position:  [-3.08784589]


portfolio before change:  [-2.93054107]
curr_Stock_Price:  101.85783064870955
curr_Factors:  [101.85783065  -1.53696134  -0.96305451]
mat_Sqrt:  [[ 8.3608674   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353394 -0.03497016 -0.01165155]
Stock Position:  -0.003533938741056413
Bond Position:  [-2.57058174]


portfolio before change:  [-2.93035349]
curr_Stock_Price:  101.71381882281011
curr_Factors:  [101.71381882  -1.29220211  -0.99472943]
mat_Sqrt:  [[10.33185284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0030127   0.01780603 -0.07543942]
Stock Position:  -0.0030126982012269815
Bond Position:  [-2.62392045]


portfolio before change:  [-2.93118887]
curr_Stock_Price:  101.8822300018823
curr_Factors:  [101.88223     -1.34109316  -0.97642917]
mat_Sqrt:  [[10.03717004  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.009168   -0.01072043  0.27459041]
Stock Position:  0.009167996148356138
Bond Position:  [-3.86524476]


portfolio before change:  [-2.9325047]
curr_Stock_Price:  101.79140937986416
curr_Factors:  [101.79140938  -1.40514423  -0.9600246 ]
mat_Sqrt:  [[ 9.56161733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00822625  0.01611873 -0.01522721]
Stock Position:  0.008226245340851418
Bond Position:  [-3.76986581]


portfolio before change:  [-2.93190544]
curr_Stock_Price:  101.92154405445972
curr_Factors:  [101.92154405  -1.51544923  -0.98637418]
mat_Sqrt:  [[ 8.3509886   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00434391 -0.04659752  0.35444957]
Stock Position:  -0.004343911865907439
Bond Position:  [-2.48916724]


portfolio before change:  [-2.9309512]
curr_Stock_Price:  101.6302384878375
curr_Factors:  [101.63023849  -1.43591117  -0.97524579]
mat_Sqrt:  [[ 9.11739532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017224   0.01981191 -0.04728805]
Stock Position:  0.001722403341370161
Bond Position:  [-3.10599946]


portfolio before change:  [-2.93113655]
curr_Stock_Price:  101.74805231840612
curr_Factors:  [101.74805232  -1.55938707  -0.9626169 ]
mat_Sqrt:  [[ 8.17021898  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01115814  0.01178526  0.05883981]
Stock Position:  -0.011158138459668471
Bond Position:  [-1.7958177]


portfolio before change:  [-2.93519747]
curr_Stock_Price:  102.09187531437489
curr_Factors:  [102.09187531  -1.66492613  -0.97021861]
mat_Sqrt:  [[ 7.32086439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037588  0.0152301  -0.18822838]
Stock Position:  -0.0003758845102449059
Bond Position:  [-2.89682271]


portfolio before change:  [-2.93558678]
curr_Stock_Price:  102.16420247277867
curr_Factors:  [102.16420247  -1.60698599  -0.96379403]
mat_Sqrt:  [[ 7.81309622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10142519 -0.00754932 -2.54558538]
Stock Position:  -0.10142518536312939
Bond Position:  [7.42643639]


portfolio before change:  [-2.94416546]
curr_Stock_Price:  102.25793704280778
curr_Factors:  [102.25793704  -1.69767838  -0.98193121]
mat_Sqrt:  [[ 7.01386446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03649002  0.03545373 -0.04110745]
Stock Position:  -0.036490017792344884
Bond Position:  [0.78722848]


portfolio before change:  [-2.97003838]
curr_Stock_Price:  102.96967480456908
curr_Factors:  [102.9696748   -1.81803715  -0.97865323]
mat_Sqrt:  [[ 6.2823502   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01091612  0.01042072  0.31400238]
Stock Position:  -0.010916116019539922
Bond Position:  [-1.84600946]


portfolio before change:  [-2.97601013]
curr_Stock_Price:  103.49559290661324
curr_Factors:  [103.49559291  -1.74099293  -1.01797328]
mat_Sqrt:  [[ 6.55719435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00236045 0.00320874 0.09449681]
Stock Position:  0.002360454778153829
Bond Position:  [-3.22030679]


portfolio before change:  [-2.97618714]
curr_Stock_Price:  103.59114646714754
curr_Factors:  [103.59114647  -1.60548874  -0.98566108]
mat_Sqrt:  [[ 7.76248137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.04391828e-02 -1.29904680e-04 -4.07811135e-01]
Stock Position:  -0.020439182793265436
Bond Position:  [-0.85886876]


portfolio before change:  [-2.97957133]
curr_Stock_Price:  103.75146702666177
curr_Factors:  [103.75146703  -1.36288754  -0.97899425]
mat_Sqrt:  [[ 9.97534466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00560509 -0.00065437  0.13465252]
Stock Position:  -0.005605090704655734
Bond Position:  [-2.39803494]


portfolio before change:  [-2.97632514]
curr_Stock_Price:  103.11883488966055
curr_Factors:  [103.11883489  -1.1274152   -0.99727502]
mat_Sqrt:  [[12.31960436  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01537718 -0.0539958  -0.22952514]
Stock Position:  0.015377179292047202
Bond Position:  [-4.56200195]


portfolio before change:  [-2.98434048]
curr_Stock_Price:  102.63467205300847
curr_Factors:  [102.63467205  -1.17101359  -1.01143159]
mat_Sqrt:  [[11.57364616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00187655 0.01605544 0.21884308]
Stock Position:  0.0018765503178211024
Bond Position:  [-3.17693961]


portfolio before change:  [-2.98604419]
curr_Stock_Price:  101.93841570875757
curr_Factors:  [101.93841571  -0.91010177  -1.03119033]
mat_Sqrt:  [[14.63003724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095025 -0.00152368 -0.13395111]
Stock Position:  -0.0009502453838352146
Bond Position:  [-2.88917768]


portfolio before change:  [-2.98615864]
curr_Stock_Price:  101.678778890777
curr_Factors:  [101.67877889  -0.77242737  -1.03700881]
mat_Sqrt:  [[16.64953749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.004341    0.01948821 -0.01158225]
Stock Position:  -0.004340996155753296
Bond Position:  [-2.54477145]


portfolio before change:  [-2.98753866]
curr_Stock_Price:  101.92340112825123
curr_Factors:  [101.92340113  -0.76700838  -1.04350149]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.98753866]
Stock Price:  100.63416930791229
PL:  [-3.62170797]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.03328365e-01  2.31874852e-02  1.49363028e-01]
 [-1.04654254e-01  2.94612611e-02  1.17343684e-01]
 [ 2.57726504e-01  3.56261173e-01  5.13911231e-01]
 [-6.08759707e-03  5.02752790e-03  9.97167742e-02]
 [-6.71482661e-01 -2.03354268e-01  3.62442790e-02]
 [-1.21589217e-02 -8.10458901e-02 -9.11690606e-02]
 [ 3.23734878e-02 -5.27579883e-02 -3.11489898e-02]
 [ 2.45326063e-01  1.24593569e-01 -6.47310427e-02]
 [-2.04470747e-01  1.65021487e-02 -1.13757320e-01]
 [ 1.14070546e-01 -4.37061618e-03  1.15954739e-01]
 [ 1.23777714e-01 -2.20409018e-01 -1.95185976e-02]
 [-9.96292361e-02 -8.56817812e-02 -1.86616846e-01]
 [ 2.45629978e-01 -2.63040364e-01  1.95744641e-02]
 [ 9.56264087e-02 -6.32027231e-02 -4.47890517e-02]
 [-9.87101496e-02  7.68281947e-02  6.99286209e-02]
 [ 6.25432898e-04 -1.71496188e-01 -3.21011583e-02]
 [-3.57636767e-01 -2.18354151e-01  8.07884453e-02]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 1.61263667e-01  8.33359740e-01  1.55246621e-01]
 [ 3.66750048e-04  2.07044776e-02  2.91722810e-02]
 [ 7.77325825e-03 -2.12254861e-01  6.41581974e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 2.52612154e-01  8.93568140e-03  2.32561962e-01]
 [ 6.25468034e-02 -1.43315398e-01 -4.06365387e-02]
 [-1.20890890e-01  2.45416740e-01  2.50940459e-01]
 [ 1.11820263e-02  6.04788098e-02  5.64359257e-02]
 [-2.00825278e-01 -1.66499883e-01  4.19132531e-01]
 [ 1.36438634e-01  8.61570152e-02 -1.01199119e-01]
 [-8.33101628e-01 -1.39505317e-01 -1.17762043e+00]
 [ 1.88059960e-02 -1.63886035e-01  1.83377119e-01]
 [-3.53751279e-02 -1.22841227e-01  1.20749957e-01]
 [ 6.56622065e-02  2.08543725e-01 -4.52241769e-02]
 [-1.03371219e-01 -2.08456893e-03  1.29438939e-03]
 [-3.24334841e-02  2.84509083e-01  4.48354101e-02]
 [ 3.49145817e-02 -1.34311047e-01 -1.41084072e-01]
 [-7.18976051e-02  4.36156676e-01  8.94499800e-02]
 [ 2.89862914e-01  1.99320788e-01  2.39308294e-02]
 [ 6.76779740e-02  1.40838666e-02 -1.47589502e-02]
 [-2.26900525e-01 -4.93319375e-01  1.10269640e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.48780484]
curr_Stock_Price:  99.73527956832888
curr_Factors:  [99.73527957 -0.95594122 -1.00429769]
mat_Sqrt:  [[14.04519801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01226334  0.00733253  0.42609115]
Stock Position:  -0.01226334198192534
Bond Position:  [1.71089268]


portfolio before change:  [0.50079863]
curr_Stock_Price:  98.69315643183442
curr_Factors:  [98.69315643 -0.99415287 -0.98850432]
mat_Sqrt:  [[13.59032882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00588219  0.00931647  0.33474887]
Stock Position:  -0.005882189424480794
Bond Position:  [1.08133047]


portfolio before change:  [0.50037116]
curr_Stock_Price:  98.78880892979315
curr_Factors:  [98.78880893 -0.7690195  -0.99219524]
mat_Sqrt:  [[16.9754739   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02190377 0.11265967 1.4660457 ]
Stock Position:  0.021903766640116406
Bond Position:  [-1.66347586]


portfolio before change:  [0.53056469]
curr_Stock_Price:  100.17676561770065
curr_Factors:  [100.17676562  -1.11587058  -0.99576585]
mat_Sqrt:  [[12.12536884  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00118733 0.00158984 0.2844642 ]
Stock Position:  0.0011873300205511852
Bond Position:  [0.41162181]


portfolio before change:  [0.53022649]
curr_Stock_Price:  99.8485885667503
curr_Factors:  [99.84858857 -0.97754963 -0.99826968]
mat_Sqrt:  [[13.84377416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04834916 -0.06430627  0.10339484]
Stock Position:  -0.048349164396262904
Bond Position:  [5.35782231]


portfolio before change:  [0.54037827]
curr_Stock_Price:  99.65247327184552
curr_Factors:  [99.65247327 -1.17016345 -0.99770779]
mat_Sqrt:  [[11.40232891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288198 -0.02562896 -0.26007995]
Stock Position:  -0.0028819835361012383
Bond Position:  [0.82757506]


portfolio before change:  [0.5412356]
curr_Stock_Price:  99.39089077137184
curr_Factors:  [99.39089077 -1.22434657 -0.98181011]
mat_Sqrt:  [[10.94523044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0022524  -0.01668354 -0.0888594 ]
Stock Position:  0.002252398580477922
Bond Position:  [0.3173677]


portfolio before change:  [0.54029438]
curr_Stock_Price:  98.95540359213432
curr_Factors:  [98.95540359 -1.0296015  -0.99553707]
mat_Sqrt:  [[13.05969416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01801956  0.03939995 -0.18465965]
Stock Position:  0.018019555678668468
Bond Position:  [-1.24283802]


portfolio before change:  [0.53259838]
curr_Stock_Price:  98.53693388669384
curr_Factors:  [98.53693389 -1.09246593 -0.99674881]
mat_Sqrt:  [[12.19732546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01863239  0.00521844 -0.32451797]
Stock Position:  -0.018632386251868888
Bond Position:  [2.36857659]


portfolio before change:  [0.55238656]
curr_Stock_Price:  97.49079340016422
curr_Factors:  [97.4907934  -0.98967632 -0.99632562]
mat_Sqrt:  [[13.37993244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01028607 -0.00138211  0.33078659]
Stock Position:  0.010286065309047297
Bond Position:  [-0.4504101]


portfolio before change:  [0.55291515]
curr_Stock_Price:  97.54765593512177
curr_Factors:  [97.54765594 -1.01470941 -1.02264942]
mat_Sqrt:  [[12.71754076  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00897206 -0.06969945 -0.05568113]
Stock Position:  0.008972061727259692
Bond Position:  [-0.32228844]


portfolio before change:  [0.55114658]
curr_Stock_Price:  97.35502687935839
curr_Factors:  [97.35502688 -0.85411678 -1.02552567]
mat_Sqrt:  [[14.8607263   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0094164  -0.02709496 -0.53236592]
Stock Position:  -0.009416399406308158
Bond Position:  [1.4678804]


portfolio before change:  [0.54610549]
curr_Stock_Price:  97.90986573635905
curr_Factors:  [97.90986574 -0.94905596 -1.03272395]
mat_Sqrt:  [[13.49430048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0179953  -0.08318067  0.0558405 ]
Stock Position:  0.017995295578933524
Bond Position:  [-1.21581148]


portfolio before change:  [0.53629558]
curr_Stock_Price:  97.37317406919763
curr_Factors:  [97.37317407 -0.88666029 -1.02243729]
mat_Sqrt:  [[14.43207515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0058794  -0.01998646 -0.1277707 ]
Stock Position:  0.0058794035933067215
Bond Position:  [-0.03620061]


portfolio before change:  [0.54158133]
curr_Stock_Price:  98.27297069814978
curr_Factors:  [98.2729707  -0.70872637 -1.03181323]
mat_Sqrt:  [[17.2396061   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00478273  0.02429521  0.19948689]
Stock Position:  -0.004782727265146201
Bond Position:  [1.01159414]


portfolio before change:  [0.5413994]
curr_Stock_Price:  98.33744866143986
curr_Factors:  [98.33744866 -0.65379689 -1.02656715]
mat_Sqrt:  [[18.32087058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056521 -0.05423186 -0.09157567]
Stock Position:  -0.0005652133776437879
Bond Position:  [0.59698104]


portfolio before change:  [0.54063621]
curr_Stock_Price:  99.81974874643318
curr_Factors:  [99.81974875 -0.36028752 -1.02972227]
mat_Sqrt:  [[24.86239098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01394813 -0.06904965  0.23046695]
Stock Position:  -0.013948126503935636
Bond Position:  [1.9329347]


portfolio before change:  [0.48766558]
curr_Stock_Price:  103.63476074168216
curr_Factors:  [103.63476074  -0.41933634  -1.02272674]
mat_Sqrt:  [[24.50334711  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0053589   0.00580111 -0.05715682]
Stock Position:  -0.005358903956693179
Bond Position:  [1.0430343]


portfolio before change:  [0.49423373]
curr_Stock_Price:  102.43343837826896
curr_Factors:  [102.43343838  -0.40716458  -1.02915231]
mat_Sqrt:  [[24.35887638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00880461 0.26353149 0.4428754 ]
Stock Position:  0.008804614102815626
Bond Position:  [-0.40765316]


portfolio before change:  [0.50270429]
curr_Stock_Price:  103.4012854707563
curr_Factors:  [103.40128547  -0.49505374  -1.0217734 ]
mat_Sqrt:  [[22.68695879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0003022  0.00654733 0.0832204 ]
Stock Position:  0.00030220464320738577
Bond Position:  [0.47145595]


portfolio before change:  [0.50292005]
curr_Stock_Price:  103.92021196686052
curr_Factors:  [103.92021197  -0.57101028  -1.03353947]
mat_Sqrt:  [[20.88588689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073682 -0.06712088  0.18302548]
Stock Position:  0.0007368180528208133
Bond Position:  [0.42634976]


portfolio before change:  [0.50352816]
curr_Stock_Price:  104.6731955276271
curr_Factors:  [104.67319553  -0.86105113  -1.02896631]
mat_Sqrt:  [[15.81289319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245805  0.01916992 -0.08961985]
Stock Position:  -0.002458048835596139
Bond Position:  [0.76081999]


portfolio before change:  [0.49929951]
curr_Stock_Price:  106.43221444994013
curr_Factors:  [106.43221445  -0.95678825  -1.02506964]
mat_Sqrt:  [[14.66773826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02047448 0.00282571 0.66343454]
Stock Position:  0.02047448479920041
Bond Position:  [-1.67984524]


portfolio before change:  [0.53064056]
curr_Stock_Price:  107.97320751737493
curr_Factors:  [107.97320752  -1.03091591  -1.01748581]
mat_Sqrt:  [[13.92215419  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00363101 -0.04532031 -0.11592473]
Stock Position:  0.0036310125810723967
Bond Position:  [0.13858849]


portfolio before change:  [0.53326326]
curr_Stock_Price:  108.6907423112376
curr_Factors:  [108.69074231  -1.23530447  -1.00228924]
mat_Sqrt:  [[11.59893071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00546009  0.07760759  0.71586328]
Stock Position:  -0.0054600938582126625
Bond Position:  [1.12672492]


portfolio before change:  [0.53997548]
curr_Stock_Price:  107.48721585194913
curr_Factors:  [107.48721585  -1.31243164  -1.00205663]
mat_Sqrt:  [[10.62153611  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00228437 0.01912508 0.16099599]
Stock Position:  0.0022843699172796325
Bond Position:  [0.29443492]


portfolio before change:  [0.53994132]
curr_Stock_Price:  107.45615199825927
curr_Factors:  [107.456152    -1.23539747  -0.99441857]
mat_Sqrt:  [[11.55671705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0103463  -0.05265189  1.19566845]
Stock Position:  -0.010346296113058602
Bond Position:  [1.65171449]


portfolio before change:  [0.52842537]
curr_Stock_Price:  108.58915934595561
curr_Factors:  [108.58915935  -1.11500632  -1.02742963]
mat_Sqrt:  [[12.74495663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00925904  0.02724524 -0.28869292]
Stock Position:  0.009259036188413254
Bond Position:  [-0.47700558]


portfolio before change:  [0.5215183]
curr_Stock_Price:  107.84961743642243
curr_Factors:  [107.84961744  -0.7458867   -1.00440525]
mat_Sqrt:  [[18.73598268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05748748 -0.04411545 -3.35942331]
Stock Position:  -0.05748747865837523
Bond Position:  [6.72152088]


portfolio before change:  [0.54945289]
curr_Stock_Price:  107.37830872560991
curr_Factors:  [107.37830873  -0.82295944  -1.03995351]
mat_Sqrt:  [[16.66724205  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00312026 -0.05182531  0.52312388]
Stock Position:  0.003120262737956521
Bond Position:  [0.21440435]


portfolio before change:  [0.54517099]
curr_Stock_Price:  105.99742979386227
curr_Factors:  [105.99742979  -0.52750235  -1.04995691]
mat_Sqrt:  [[21.88837307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063499 -0.03884581  0.34446602]
Stock Position:  -0.0006349897719548213
Bond Position:  [0.61247827]


portfolio before change:  [0.54432212]
curr_Stock_Price:  107.45482846472962
curr_Factors:  [107.45482846  -0.51773598  -1.01579354]
mat_Sqrt:  [[23.18582367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00266609  0.06594732 -0.12901199]
Stock Position:  0.0026660875500932432
Bond Position:  [0.25783814]


portfolio before change:  [0.54377528]
curr_Stock_Price:  107.23763092718073
curr_Factors:  [107.23763093  -0.59155747  -0.99954212]
mat_Sqrt:  [[21.84446633  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00472252 -0.0006592   0.00369253]
Stock Position:  -0.004722515302361918
Bond Position:  [1.05020664]


portfolio before change:  [0.53544979]
curr_Stock_Price:  109.02836712270825
curr_Factors:  [109.02836712  -0.70872563  -1.01634867]
mat_Sqrt:  [[19.42447361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00082038  0.08996967  0.12790295]
Stock Position:  -0.0008203826618367481
Bond Position:  [0.62489477]


portfolio before change:  [0.5344472]
curr_Stock_Price:  110.34568610671552
curr_Factors:  [110.34568611  -0.80337489  -1.02109426]
mat_Sqrt:  [[17.79911769  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.48772524e-04 -4.24728824e-02 -4.02473588e-01]
Stock Position:  0.00014877252442043324
Bond Position:  [0.51803079]


portfolio before change:  [0.53466841]
curr_Stock_Price:  111.39732921369831
curr_Factors:  [111.39732921  -0.85179599  -1.03484614]
mat_Sqrt:  [[16.8856006   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250966  0.13792485  0.25517589]
Stock Position:  -0.00250966420914438
Bond Position:  [0.8142383]


portfolio before change:  [0.53201485]
curr_Stock_Price:  112.49522264032058
curr_Factors:  [112.49522264  -0.6679731   -1.03619801]
mat_Sqrt:  [[20.46548162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01465366 0.06303077 0.068268  ]
Stock Position:  0.01465366026956008
Bond Position:  [-1.11645192]


portfolio before change:  [0.53501587]
curr_Stock_Price:  112.70954346705513
curr_Factors:  [112.70954347  -0.6493659   -1.03584289]
mat_Sqrt:  [[20.89699389  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00311188  0.00445371 -0.04210318]
Stock Position:  0.003111881074597255
Bond Position:  [0.18427718]


portfolio before change:  [0.53641822]
curr_Stock_Price:  113.15278271038649
curr_Factors:  [113.15278271  -0.84425792  -1.04285799]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.53641822]
Stock Price:  113.42068739743445
PL:  [-12.88426918]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [ 5.44726213e-02 -6.82009631e-03  1.89381539e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 1.32429601e-01  1.83323261e-01  3.17412207e-01]
 [-8.56965305e-02 -3.76982891e-02  5.50206982e-02]
 [-6.15513741e-01 -1.87500417e-01  3.76120156e-02]
 [ 4.03433497e-02 -1.49822195e-01 -2.01431766e-01]
 [ 2.24770143e-02 -2.37782950e-01 -3.69876227e-02]
 [ 2.46959590e-01  2.50456122e-01 -7.79408393e-02]
 [-1.67997319e-02  3.00440488e-02 -8.72826745e-02]
 [ 1.19259283e-01  5.85975101e-03  1.49961043e-01]
 [ 1.29644302e-01 -1.54436569e-01 -4.35960708e-02]
 [-1.20275260e-01 -9.70384979e-02 -2.11973754e-01]
 [ 3.04804448e-01 -3.58403501e-01 -1.02027848e-01]
 [ 8.91468553e-02 -6.40143629e-02 -5.05633820e-02]
 [-1.01145071e-01  1.16299167e-01  9.50936831e-02]
 [-1.41894454e-02 -1.01313487e-01 -1.01489485e-02]
 [-8.46044173e-02 -2.69588360e-01 -1.71823182e-02]
 [-2.20174564e-01 -9.47743276e-03 -4.16576733e-02]
 [ 3.34384250e-01  1.32607988e+00  4.91997438e-01]
 [-2.33258442e-01 -3.01240281e-02  1.96786845e-01]
 [-9.10293709e-02  1.29683274e-01 -3.79181223e-02]
 [ 6.88747055e-02 -7.28323383e-03  4.44328177e-02]
 [-7.85948581e-02 -3.12115582e-03 -9.20265709e-02]
 [-2.75991692e-03 -6.00361833e-02  1.14115754e-01]
 [-1.05385178e-01  8.37124436e-02 -1.17144864e-02]
 [ 1.13496194e-01 -4.46689686e-02 -2.58548640e-02]
 [ 2.72613267e-02 -6.81219466e-02  5.73966543e-02]
 [ 7.37012333e-03  4.14113240e-02 -4.10727277e-02]
 [-5.41652774e-01  4.24237765e-02 -7.31441107e-01]
 [-8.83831638e-02 -1.13087348e-01  6.72992342e-03]
 [-9.02798921e-02  9.22946337e-02  2.11615573e-01]
 [ 1.29908617e-02  5.00408355e-02  1.12836437e-02]
 [-1.20014708e-01 -6.51981572e-03 -1.47464159e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 2.09295465e-01 -1.61188380e-01 -6.44151535e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-2.03249786e-03 -8.16354457e-03 -3.84582220e-02]
 [-8.11871557e-02  3.39690787e-02 -2.51531934e-03]
 [-4.83567855e-02 -2.84587036e-01  1.35883050e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.81794839]
curr_Stock_Price:  99.27468908441232
curr_Factors:  [99.27468908 -1.21763018 -0.97982546]
mat_Sqrt:  [[11.02797248  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00842892 -0.0021567   0.54025282]
Stock Position:  0.008428917657811348
Bond Position:  [-3.65472657]


portfolio before change:  [-2.81582123]
curr_Stock_Price:  99.58125588042452
curr_Factors:  [99.58125588 -1.19118814 -1.0072229 ]
mat_Sqrt:  [[11.0514641   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00410634  0.01411938  0.0859571 ]
Stock Position:  -0.004106337626374823
Bond Position:  [-2.40690697]


portfolio before change:  [-2.81210574]
curr_Stock_Price:  98.60316599163046
curr_Factors:  [98.60316599 -1.32522099 -1.04954731]
mat_Sqrt:  [[ 9.1736484   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02201463 0.05797191 0.90548868]
Stock Position:  0.022014630816715616
Bond Position:  [-4.98281804]


portfolio before change:  [-2.80408127]
curr_Stock_Price:  98.99596674078026
curr_Factors:  [98.99596674 -1.39915895 -1.08595134]
mat_Sqrt:  [[ 8.2479841   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00914634 -0.01192125  0.15695874]
Stock Position:  -0.00914633711464537
Bond Position:  [-1.89863079]


portfolio before change:  [-2.80130233]
curr_Stock_Price:  98.66618602658119
curr_Factors:  [98.66618603 -1.24434067 -1.07917999]
mat_Sqrt:  [[ 9.66220254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06340971 -0.05929284  0.10729661]
Stock Position:  -0.06340970994598484
Bond Position:  [3.45509191]


portfolio before change:  [-2.78006996]
curr_Stock_Price:  98.33815337996846
curr_Factors:  [98.33815338 -1.32829194 -1.06932355]
mat_Sqrt:  [[ 8.94233364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.19118372e-04 -4.73779379e-02 -5.74628759e-01]
Stock Position:  -0.0005191183722512595
Bond Position:  [-2.72902082]


portfolio before change:  [-2.78008523]
curr_Stock_Price:  97.71039378600325
curr_Factors:  [97.71039379 -1.39222031 -1.06201937]
mat_Sqrt:  [[ 8.3961079   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104661 -0.07519357 -0.10551539]
Stock Position:  0.0010466061375339457
Bond Position:  [-2.88234953]


portfolio before change:  [-2.78092275]
curr_Stock_Price:  97.25444122320165
curr_Factors:  [97.25444122 -1.30991992 -1.08478551]
mat_Sqrt:  [[ 8.86956031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02677886  0.07920118 -0.22234352]
Stock Position:  0.02677886205926666
Bond Position:  [-5.38528601]


portfolio before change:  [-2.79960967]
curr_Stock_Price:  96.58175711158485
curr_Factors:  [96.58175711 -1.09910443 -1.09192781]
mat_Sqrt:  [[10.7979644   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313397  0.00950076 -0.24899318]
Stock Position:  -0.003133970250369182
Bond Position:  [-2.49692531]


portfolio before change:  [-2.80158016]
curr_Stock_Price:  97.11091344372639
curr_Factors:  [97.11091344 -1.06884021 -1.10035776]
mat_Sqrt:  [[11.09678907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01351934 0.00185302 0.42779711]
Stock Position:  0.013519338787876237
Bond Position:  [-4.1144555]


portfolio before change:  [-2.80249258]
curr_Stock_Price:  97.08146787329805
curr_Factors:  [97.08146787 -1.35154844 -1.11091206]
mat_Sqrt:  [[ 8.27376771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0141118  -0.04883713 -0.12436746]
Stock Position:  0.014111800091740238
Bond Position:  [-4.17248685]


portfolio before change:  [-2.8040758]
curr_Stock_Price:  97.00623869841365
curr_Factors:  [97.0062387  -1.28544164 -1.11539725]
mat_Sqrt:  [[ 8.79282813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01888468 -0.03068627 -0.60470212]
Stock Position:  -0.01888467990902158
Bond Position:  [-0.97214403]


portfolio before change:  [-2.80193311]
curr_Stock_Price:  96.88634197785657
curr_Factors:  [96.88634198 -1.45816325 -1.1260805 ]
mat_Sqrt:  [[ 7.31037675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03758003 -0.11333714 -0.29105705]
Stock Position:  0.03758002790716516
Bond Position:  [-6.44292455]


portfolio before change:  [-2.80205498]
curr_Stock_Price:  96.90453105392518
curr_Factors:  [96.90453105 -1.38342995 -1.0959225 ]
mat_Sqrt:  [[ 8.12035463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00950362 -0.02024312 -0.14424325]
Stock Position:  0.00950362490460643
Bond Position:  [-3.7229993]


portfolio before change:  [-2.79794251]
curr_Stock_Price:  97.38622854364898
curr_Factors:  [97.38622854 -1.2837555  -1.10204242]
mat_Sqrt:  [[ 8.96104534  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00878595  0.03677703  0.27127581]
Stock Position:  -0.008785952986690401
Bond Position:  [-1.94231169]


portfolio before change:  [-2.800601]
curr_Stock_Price:  97.66117685789405
curr_Factors:  [97.66117686 -1.12520104 -1.13151172]
mat_Sqrt:  [[10.22454649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184624 -0.03203814 -0.02895213]
Stock Position:  -0.0018462426514206057
Bond Position:  [-2.62029477]


portfolio before change:  [-2.79970096]
curr_Stock_Price:  96.99625785585133
curr_Factors:  [96.99625786 -0.82562447 -1.11548931]
mat_Sqrt:  [[13.92322934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00682834 -0.08525132 -0.04901637]
Stock Position:  -0.006828335764361709
Bond Position:  [-2.13737794]


portfolio before change:  [-2.8001513]
curr_Stock_Price:  97.02308073114227
curr_Factors:  [97.02308073 -1.0312291  -1.07965505]
mat_Sqrt:  [[11.75248549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01947865 -0.00299703 -0.11883775]
Stock Position:  -0.019478654765509668
Bond Position:  [-0.91027221]


portfolio before change:  [-2.79804922]
curr_Stock_Price:  96.9093216590236
curr_Factors:  [96.90932166 -1.15988094 -1.09028241]
mat_Sqrt:  [[10.21249902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04592921 0.41934328 1.40353175]
Stock Position:  0.045929212881204655
Bond Position:  [-7.24901808]


portfolio before change:  [-2.79177466]
curr_Stock_Price:  97.0656654373415
curr_Factors:  [97.06566544 -1.00698411 -1.08239453]
mat_Sqrt:  [[12.01323631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01613781 -0.00952605  0.56137809]
Stock Position:  -0.016137807432875552
Bond Position:  [-1.22534764]


portfolio before change:  [-2.79142171]
curr_Stock_Price:  97.03430266422694
curr_Factors:  [97.03430266 -1.0369102  -1.07259471]
mat_Sqrt:  [[11.77006732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00810709  0.04100945 -0.10816985]
Stock Position:  -0.008107087648772696
Bond Position:  [-2.00475611]


portfolio before change:  [-2.79518721]
curr_Stock_Price:  97.4678601272447
curr_Factors:  [97.46786013 -1.03725229 -1.06698821]
mat_Sqrt:  [[11.88506044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00654237 -0.00230316  0.12675446]
Stock Position:  0.006542370109372746
Bond Position:  [-3.43285802]


portfolio before change:  [-2.79777932]
curr_Stock_Price:  97.13724824907861
curr_Factors:  [97.13724825 -0.91265237 -1.08698256]
mat_Sqrt:  [[13.15089718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00741092 -0.000987   -0.26252619]
Stock Position:  -0.007410923362016409
Bond Position:  [-2.07790262]


portfolio before change:  [-2.80089038]
curr_Stock_Price:  97.52199141688828
curr_Factors:  [97.52199142 -0.90351046 -1.11750862]
mat_Sqrt:  [[12.9236482   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146891 -0.01898511  0.32554048]
Stock Position:  0.0014689146582967866
Bond Position:  [-2.94414186]


portfolio before change:  [-2.80199781]
curr_Stock_Price:  97.01863531990031
curr_Factors:  [97.01863532 -0.98069728 -1.09857324]
mat_Sqrt:  [[12.12940359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00870735  0.0264722  -0.03341817]
Stock Position:  -0.00870734826555886
Bond Position:  [-1.95722276]


portfolio before change:  [-2.81178489]
curr_Stock_Price:  98.11453887035623
curr_Factors:  [98.11453887 -0.91353306 -1.10702385]
mat_Sqrt:  [[13.00818345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00823061 -0.01412557 -0.07375673]
Stock Position:  0.008230606886414346
Bond Position:  [-3.61932709]


portfolio before change:  [-2.80805436]
curr_Stock_Price:  98.62276116658302
curr_Factors:  [98.62276117 -1.03619968 -1.11512584]
mat_Sqrt:  [[11.47277172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00324407 -0.02154205  0.16373668]
Stock Position:  0.0032440694803926927
Bond Position:  [-3.12799345]


portfolio before change:  [-2.80485412]
curr_Stock_Price:  99.72978417540583
curr_Factors:  [99.72978418 -1.19023796 -1.13862266]
mat_Sqrt:  [[ 9.71434589  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.70534308e-06  1.30954105e-02 -1.17169060e-01]
Stock Position:  5.705343082545567e-06
Bond Position:  [-2.80542311]


portfolio before change:  [-2.80520356]
curr_Stock_Price:  99.9499687028271
curr_Factors:  [99.9499687  -1.09817079 -1.14038798]
mat_Sqrt:  [[10.65587064  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06474011  0.01341558 -2.08659788]
Stock Position:  -0.06474010533498545
Bond Position:  [3.66556794]


portfolio before change:  [-2.80323975]
curr_Stock_Price:  99.92671275543026
curr_Factors:  [99.92671276 -0.8604727  -1.10775585]
mat_Sqrt:  [[13.96017299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00644185 -0.03576136  0.0191986 ]
Stock Position:  -0.006441849024285172
Bond Position:  [-2.15952695]


portfolio before change:  [-2.80366812]
curr_Stock_Price:  99.95130417178001
curr_Factors:  [99.95130417 -0.82645968 -1.0926474 ]
mat_Sqrt:  [[14.66664724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0030478   0.02918613  0.60368033]
Stock Position:  -0.003047799965096159
Bond Position:  [-2.49903654]


portfolio before change:  [-2.80396069]
curr_Stock_Price:  99.9447992796987
curr_Factors:  [99.94479928 -0.97777073 -1.0758354 ]
mat_Sqrt:  [[12.82006975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00129377 0.0158243  0.03218909]
Stock Position:  0.0012937663295891483
Bond Position:  [-2.93326591]


portfolio before change:  [-2.80398443]
curr_Stock_Price:  100.20987052780943
curr_Factors:  [100.20987053  -1.20747277  -1.06044661]
mat_Sqrt:  [[10.37446312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01448596 -0.00206175 -0.4206742 ]
Stock Position:  -0.014485958674422511
Bond Position:  [-1.35234839]


portfolio before change:  [-2.80060325]
curr_Stock_Price:  99.96478928565443
curr_Factors:  [99.96478929 -1.09189463 -1.05446976]
mat_Sqrt:  [[11.68672544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448489  0.0049611   0.16678008]
Stock Position:  -0.004484892182176198
Bond Position:  [-2.35227195]


portfolio before change:  [-2.80529411]
curr_Stock_Price:  100.9451488014219
curr_Factors:  [100.9451488   -0.89987072  -1.07027607]
mat_Sqrt:  [[14.07542685  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01363972 -0.05097224 -0.1837585 ]
Stock Position:  0.013639722138836763
Bond Position:  [-4.18215789]


portfolio before change:  [-2.80826649]
curr_Stock_Price:  100.76555741877368
curr_Factors:  [100.76555742  -0.80426521  -1.08255658]
mat_Sqrt:  [[15.27129333  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0016051  0.00777784 0.21633947]
Stock Position:  0.001605095464161294
Bond Position:  [-2.97000483]


portfolio before change:  [-2.80954269]
curr_Stock_Price:  100.20177572794621
curr_Factors:  [100.20177573  -0.84263686  -1.07147835]
mat_Sqrt:  [[14.7769821   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068306 -0.00258154 -0.1097106 ]
Stock Position:  -0.000683057697029522
Bond Position:  [-2.74109909]


portfolio before change:  [-2.81066068]
curr_Stock_Price:  101.33687240679676
curr_Factors:  [101.33687241  -0.86871745  -1.05774259]
mat_Sqrt:  [[14.76102554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00547547  0.01074197 -0.00717551]
Stock Position:  -0.005475467476500858
Bond Position:  [-2.25579393]


portfolio before change:  [-2.81159575]
curr_Stock_Price:  101.456145634972
curr_Factors:  [101.45614563  -0.85668686  -1.08868241]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.81159575]
Stock Price:  101.55366349708885
PL:  [-4.36525925]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-7.40530701e-02 -2.15708465e-02 -2.20895792e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.25562900e-01  2.08237154e-01  2.93939300e-01]
 [-4.48157443e-04 -8.24199031e-03  8.70942693e-02]
 [-8.16598331e-01 -2.44459979e-01  3.26980248e-02]
 [ 2.88252784e-02 -1.40593308e-01 -1.86160380e-01]
 [ 2.77856410e-02 -1.81737330e-01 -2.73934999e-02]
 [ 3.28194930e-01  1.40878325e-01 -9.75725716e-02]
 [-2.73028044e-01  1.00643034e-02 -1.17151096e-01]
 [ 4.20562555e-02 -8.21717927e-03 -3.71529011e-02]
 [ 5.91974968e-02 -2.39043640e-01  1.44251496e-02]
 [-1.18135165e-02 -1.80399601e-03  1.43391165e-02]
 [ 2.19512600e-01 -1.75265203e-01  1.60122231e-01]
 [ 8.26129151e-02  5.38942830e-03 -3.92284334e-02]
 [ 7.73105820e-02 -1.07333002e-01 -6.60071748e-02]
 [-5.13001355e-02  8.06866307e-02  4.98983607e-02]
 [-4.87471996e-01 -2.73646160e-01  1.35897055e-01]
 [-1.21500984e-01  1.87471203e-02 -2.51927745e-02]
 [ 3.81529489e-01  1.45462493e+00  6.56134634e-01]
 [-1.37476096e-01 -1.18648326e-02  1.29107524e-01]
 [-9.11753088e-02  1.34417161e-01 -3.76961513e-02]
 [ 6.13258766e-02  2.25989891e-03  3.64424504e-02]
 [ 1.13221456e-02 -2.63881617e-02  7.30844476e-04]
 [ 3.05121082e-02  8.27920972e-02  9.85022668e-02]
 [-6.91160700e-02 -1.06499942e-01 -7.36347168e-02]
 [ 1.05237358e-01 -2.22277367e-03 -9.63915781e-03]
 [-1.17214380e-02 -8.91065217e-03 -4.33704820e-02]
 [ 5.76454520e-03  4.15141804e-02 -2.55106448e-02]
 [-5.23612247e-01  9.03485351e-02 -6.58897744e-01]
 [-4.31690616e-02 -1.23558838e-01 -1.48335782e-02]
 [-8.33197252e-02  8.90029546e-02  2.04123002e-01]
 [ 1.89338410e-02  8.64378989e-02 -6.05260980e-03]
 [-1.02772503e-01  6.95327476e-04 -1.60524004e-01]
 [-6.20449432e-02  8.05193146e-02  9.95797831e-02]
 [-4.08694888e-03 -1.24168148e-02  4.44397847e-02]
 [-2.88366522e-02 -1.84231480e-02  4.21085545e-02]
 [ 4.18548802e-02  2.82751879e-02 -1.10714641e-02]
 [-1.11533648e-01  1.08043552e-01  6.68606303e-03]
 [ 2.27340721e-03 -2.53372803e-01  8.73070474e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.31901571]
curr_Stock_Price:  100.40841201328385
curr_Factors:  [100.40841201  -1.17647849  -0.99223668]
mat_Sqrt:  [[11.47913236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00689242 -0.0068213  -0.06301542]
Stock Position:  -0.006892423656960379
Bond Position:  [6.01107302]


portfolio before change:  [5.32734875]
curr_Stock_Price:  99.30841939491472
curr_Factors:  [99.30841939 -1.1804656  -0.98190626]
mat_Sqrt:  [[11.42562332  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00397187  0.01411938  0.0859571 ]
Stock Position:  -0.0039718658289049046
Bond Position:  [5.72178847]


portfolio before change:  [5.3262514]
curr_Stock_Price:  99.76478420326987
curr_Factors:  [99.7647842  -1.10277752 -0.99143706]
mat_Sqrt:  [[12.2877235   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02367726 0.06585037 0.83852701]
Stock Position:  0.023677263657648974
Bond Position:  [2.9640943]


portfolio before change:  [5.34163617]
curr_Stock_Price:  100.39890449231645
curr_Factors:  [100.39890449  -1.07163257  -1.00593905]
mat_Sqrt:  [[12.57335225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00136138 -0.00260635  0.24845571]
Stock Position:  0.0013613774761377915
Bond Position:  [5.20495536]


portfolio before change:  [5.34145364]
curr_Stock_Price:  99.78688763760844
curr_Factors:  [99.78688764 -1.19725686 -1.01267975]
mat_Sqrt:  [[10.94738028  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07455992 -0.07730503  0.09327836]
Stock Position:  -0.07455992053627568
Bond Position:  [12.78155606]


portfolio before change:  [5.43153699]
curr_Stock_Price:  98.60011661469355
curr_Factors:  [98.60011661 -1.26699155 -1.01043531]
mat_Sqrt:  [[10.1112189   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126638 -0.04445951 -0.53106375]
Stock Position:  -0.0012663808171575236
Bond Position:  [5.55640229]


portfolio before change:  [5.43273534]
curr_Stock_Price:  98.20232382412486
curr_Factors:  [98.20232382 -1.19402856 -0.9958677 ]
mat_Sqrt:  [[10.99162503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00159226 -0.05747039 -0.07814603]
Stock Position:  0.001592260333424979
Bond Position:  [5.27637168]


portfolio before change:  [5.43438857]
curr_Stock_Price:  98.82637014018799
curr_Factors:  [98.82637014 -1.42585098 -0.99602413]
mat_Sqrt:  [[ 8.77133804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03556076  0.04454964 -0.27834739]
Stock Position:  0.035560763173759426
Bond Position:  [1.92004743]


portfolio before change:  [5.44667511]
curr_Stock_Price:  99.16512862069199
curr_Factors:  [99.16512862 -1.23736282 -0.98911292]
mat_Sqrt:  [[10.7007163   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02772539  0.00318261 -0.33419947]
Stock Position:  -0.027725391819909764
Bond Position:  [8.19606715]


portfolio before change:  [5.45501883]
curr_Stock_Price:  98.9011413148043
curr_Factors:  [98.90114131 -1.43857384 -0.98820012]
mat_Sqrt:  [[ 8.73507756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00392215 -0.0025985  -0.10598689]
Stock Position:  0.0039221500244546
Bond Position:  [5.06711372]


portfolio before change:  [5.45541192]
curr_Stock_Price:  98.83986464637941
curr_Factors:  [98.83986465 -1.12726444 -1.00806517]
mat_Sqrt:  [[11.68342768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00479054 -0.07559224  0.04115094]
Stock Position:  0.004790540878173348
Bond Position:  [4.98191551]


portfolio before change:  [5.4582279]
curr_Stock_Price:  99.29768263132348
curr_Factors:  [99.29768263 -1.42882392 -0.99985189]
mat_Sqrt:  [[ 8.75343697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102053 -0.00057047  0.04090551]
Stock Position:  -0.001020528918960877
Bond Position:  [5.55956405]


portfolio before change:  [5.45849373]
curr_Stock_Price:  99.71820584212622
curr_Factors:  [99.71820584 -1.47007847 -1.02772031]
mat_Sqrt:  [[ 8.20340638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03019137 -0.05542372  0.45678415]
Stock Position:  0.030191370984812158
Bond Position:  [2.44786438]


portfolio before change:  [5.45970007]
curr_Stock_Price:  99.74802688474907
curr_Factors:  [99.74802688 -1.51804064 -1.03063691]
mat_Sqrt:  [[ 7.79879876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00958412  0.00170429 -0.1119078 ]
Stock Position:  0.009584116910736533
Bond Position:  [4.50370332]


portfolio before change:  [5.45797985]
curr_Stock_Price:  99.50979757722632
curr_Factors:  [99.50979758 -1.40693021 -1.01959545]
mat_Sqrt:  [[ 8.79101733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00694636 -0.03394168 -0.1883001 ]
Stock Position:  0.006946363020137984
Bond Position:  [4.76674867]


portfolio before change:  [5.46055739]
curr_Stock_Price:  99.79507766661882
curr_Factors:  [99.79507767 -1.38800384 -1.01371211]
mat_Sqrt:  [[ 9.03768366  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00431873  0.02551535  0.14234613]
Stock Position:  -0.004318734417852608
Bond Position:  [5.89154583]


portfolio before change:  [5.46170359]
curr_Stock_Price:  99.70020997464573
curr_Factors:  [99.70020997 -1.31386649 -1.00886537]
mat_Sqrt:  [[ 9.7711671   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04777297 -0.08653451  0.38767647]
Stock Position:  -0.04777296656413005
Bond Position:  [10.22467838]


portfolio before change:  [5.4316518]
curr_Stock_Price:  100.35601921567077
curr_Factors:  [100.35601922  -1.44369063  -1.0391887 ]
mat_Sqrt:  [[ 8.37997327  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01505487  0.00592836 -0.07186797]
Stock Position:  -0.015054867747609418
Bond Position:  [6.9424984]


portfolio before change:  [5.44206092]
curr_Stock_Price:  99.72225398895128
curr_Factors:  [99.72225399 -1.42459112 -1.02675295]
mat_Sqrt:  [[ 8.59383244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06435088 0.45999279 1.87176948]
Stock Position:  0.06435087811089757
Bond Position:  [-0.97515369]


portfolio before change:  [5.37383515]
curr_Stock_Price:  98.66393332990647
curr_Factors:  [98.66393333 -1.36589633 -1.04253729]
mat_Sqrt:  [[ 8.87542165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01255473 -0.00375199  0.36830783]
Stock Position:  -0.012554725390390617
Bond Position:  [6.61253374]


portfolio before change:  [5.37018985]
curr_Stock_Price:  99.02012758005748
curr_Factors:  [99.02012758 -1.49319243 -1.04796909]
mat_Sqrt:  [[ 7.8002955   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01223022  0.04250644 -0.10753663]
Stock Position:  -0.012230224787334855
Bond Position:  [6.58122827]


portfolio before change:  [5.36828671]
curr_Stock_Price:  99.24300526823072
curr_Factors:  [99.24300527 -1.71806501 -1.08355915]
mat_Sqrt:  [[ 6.02517957  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01142257 0.00071464 0.10396017]
Stock Position:  0.011422565942129502
Bond Position:  [4.23467694]


portfolio before change:  [5.37271933]
curr_Stock_Price:  99.58471961185002
curr_Factors:  [99.58471961 -1.63132859 -1.08060655]
mat_Sqrt:  [[ 6.61323934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00163157 -0.00834467  0.0020849 ]
Stock Position:  0.0016315739788460664
Bond Position:  [5.21023949]


portfolio before change:  [5.37371454]
curr_Stock_Price:  99.79548832287233
curr_Factors:  [99.79548832 -1.54402682 -1.10183936]
mat_Sqrt:  [[ 7.07987887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00745161 0.02618116 0.28099955]
Stock Position:  0.007451607987406313
Bond Position:  [4.63007768]


portfolio before change:  [5.37212388]
curr_Stock_Price:  99.50434887486968
curr_Factors:  [99.50434887 -1.37299062 -1.08269141]
mat_Sqrt:  [[ 8.53793624  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01017769 -0.03367824 -0.21005935]
Stock Position:  -0.010177694924573677
Bond Position:  [6.38484878]


portfolio before change:  [5.37389094]
curr_Stock_Price:  99.40914992541398
curr_Factors:  [99.40914993 -1.18417928 -1.05674119]
mat_Sqrt:  [[10.57321261  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00976169 -0.0007029  -0.02749783]
Stock Position:  0.009761686027347274
Bond Position:  [4.40349003]


portfolio before change:  [5.37545584]
curr_Stock_Price:  99.51307008926305
curr_Factors:  [99.51307009 -1.46137502 -1.06205482]
mat_Sqrt:  [[ 7.97936756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260728 -0.0028178  -0.12372391]
Stock Position:  -0.0026072834096380103
Bond Position:  [5.63491462]


portfolio before change:  [5.37656206]
curr_Stock_Price:  99.35896039408125
curr_Factors:  [99.35896039 -1.39227467 -1.05325701]
mat_Sqrt:  [[ 8.61243832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00018916  0.01312794 -0.07277477]
Stock Position:  0.00018915643761549568
Bond Position:  [5.35776767]


portfolio before change:  [5.37714752]
curr_Stock_Price:  98.91327330731285
curr_Factors:  [98.91327331 -1.3887491  -1.05160152]
mat_Sqrt:  [[ 8.61834285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07609078  0.02857072 -1.87965186]
Stock Position:  -0.07609077615734049
Bond Position:  [12.90353526]


portfolio before change:  [5.3608694]
curr_Stock_Price:  99.1484024291237
curr_Factors:  [99.14840243 -1.44098413 -1.04045061]
mat_Sqrt:  [[ 8.29110295  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00595665 -0.03907274 -0.04231607]
Stock Position:  -0.005956653637663974
Bond Position:  [5.9514621]


portfolio before change:  [5.36279185]
curr_Stock_Price:  98.9505619977902
curr_Factors:  [98.950562   -1.30599099 -1.04431   ]
mat_Sqrt:  [[ 9.43399224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00417164  0.02814521  0.58230611]
Stock Position:  -0.004171642762650888
Bond Position:  [5.77557825]


portfolio before change:  [5.3648478]
curr_Stock_Price:  98.63079531023328
curr_Factors:  [98.63079531 -1.0948528  -1.04551454]
mat_Sqrt:  [[11.60012876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017181   0.02733406 -0.01726641]
Stock Position:  0.0017180993870397985
Bond Position:  [5.19539029]


portfolio before change:  [5.36505576]
curr_Stock_Price:  98.37382435890737
curr_Factors:  [98.37382436 -1.31082583 -1.04514042]
mat_Sqrt:  [[ 9.32602149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.45315314e-02  2.19881855e-04 -4.57930301e-01]
Stock Position:  -0.014531531433020184
Bond Position:  [6.79457808]


portfolio before change:  [5.36129867]
curr_Stock_Price:  98.69082218063248
curr_Factors:  [98.69082218 -1.21583194 -1.05211805]
mat_Sqrt:  [[10.21688724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00387978  0.02546244  0.2840734 ]
Stock Position:  -0.0038797829862641403
Bond Position:  [5.74419764]


portfolio before change:  [5.36245695]
curr_Stock_Price:  98.57735826265485
curr_Factors:  [98.57735826 -0.94796153 -1.06147795]
mat_Sqrt:  [[13.21565515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035289 -0.00392654  0.12677434]
Stock Position:  0.0003528908223822319
Bond Position:  [5.32766991]


portfolio before change:  [5.36305437]
curr_Stock_Price:  98.3830203154098
curr_Factors:  [98.38302032 -0.98904005 -1.08402439]
mat_Sqrt:  [[12.37655286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00167389 -0.00582591  0.12012399]
Stock Position:  -0.0016738879847951718
Bond Position:  [5.52773653]


portfolio before change:  [5.36386601]
curr_Stock_Price:  98.31095862251878
curr_Factors:  [98.31095862 -1.0270787  -1.08162683]
mat_Sqrt:  [[11.93445952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00337887  0.0089414  -0.03158381]
Stock Position:  0.0033788701702021895
Bond Position:  [5.03168604]


portfolio before change:  [5.36307118]
curr_Stock_Price:  97.88956605264612
curr_Factors:  [97.88956605 -0.78893418 -1.09224465]
mat_Sqrt:  [[14.9193815   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00719729  0.03416637  0.01907348]
Stock Position:  -0.0071972948824293404
Bond Position:  [6.06761125]


portfolio before change:  [5.36397118]
curr_Stock_Price:  97.86990562363438
curr_Factors:  [97.86990562 -0.69340074 -1.09260225]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.36397118]
Stock Price:  96.77585890293764
PL:  [5.36397118]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-4.15177457e-02  2.15272131e-01  3.24063658e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.38698435e-01  2.42462422e-01  3.41633183e-01]
 [-1.53597250e-02  2.89120169e-02  1.22384564e-01]
 [-7.08366684e-01 -2.13802099e-01  3.53429282e-02]
 [ 1.76971524e-02 -1.38088152e-01 -1.77770880e-01]
 [ 3.25005882e-02 -1.15011382e-01 -2.20688946e-02]
 [ 1.84017439e-01  1.83517114e-01 -4.75358099e-02]
 [-1.97765727e-01  1.24867056e-02 -9.38670641e-02]
 [ 6.40310139e-02 -3.97548028e-02 -7.62214290e-02]
 [ 9.41114493e-02 -3.44766170e-01  3.27092961e-02]
 [-3.08215973e-03 -3.25743255e-02 -6.80402418e-02]
 [ 2.00963315e-01 -1.91118451e-01  1.03569131e-01]
 [ 8.10812431e-02 -8.27877899e-02 -4.70377832e-02]
 [-1.09704886e-01  1.03936245e-01  8.80076198e-02]
 [-1.51570088e-03 -1.65000301e-01 -2.97212254e-02]
 [-3.24813674e-01 -2.38940975e-01  7.05539875e-02]
 [-2.52481528e-01 -1.17626787e-01 -4.07409293e-02]
 [ 2.40461430e-01  1.07865277e+00  2.15697313e-01]
 [-3.68499451e-01 -6.18500933e-02  2.79199014e-01]
 [-8.51521067e-02 -6.09614346e-02 -4.68574176e-02]
 [ 1.45955263e-01 -4.24496184e-02  8.29403795e-02]
 [-1.09371552e-01  2.39844158e-02 -1.15505800e-01]
 [-8.43118754e-03 -1.11687432e-01  1.07624580e-01]
 [-1.06189131e-01  8.58116192e-02 -5.57768976e-03]
 [ 7.65791460e-02 -1.69492056e-01 -2.13335588e-01]
 [ 7.33058500e-02 -2.11087723e-02  1.04293463e-01]
 [-1.30285274e-01  4.24016634e-02  1.27505483e-01]
 [-5.12052140e-01 -7.36317460e-02 -7.93265500e-01]
 [ 2.75054749e-01 -1.96911569e-01 -1.78089322e-01]
 [ 1.34048169e-01  1.49533679e-02 -3.15437482e-02]
 [ 4.46933789e-02  2.56377846e-01 -8.74610387e-02]
 [-1.70265495e-01  2.93917834e-02 -1.63552392e-01]
 [-4.71372397e-02  1.50007075e-01  9.50337487e-02]
 [-1.25969082e-01  9.82773222e-02  1.52820549e-01]
 [-9.31781535e-02 -6.77356776e-02  9.24761412e-03]
 [ 8.97105520e-02  7.18184238e-02  1.62008374e-02]
 [-1.13073016e-01  1.28932896e-01  6.84748831e-03]
 [ 2.16634144e-03 -2.46807336e-01  8.42050783e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.18948523]
curr_Stock_Price:  98.94426293750399
curr_Factors:  [98.94426294 -0.96603547 -1.02870582]
mat_Sqrt:  [[13.46125287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00224272 0.06807503 0.92446341]
Stock Position:  0.0022427165058854564
Bond Position:  [-5.41138916]


portfolio before change:  [-5.18896203]
curr_Stock_Price:  99.4791792282735
curr_Factors:  [99.47917923 -1.1947638  -1.0078883 ]
mat_Sqrt:  [[10.99341293  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00412802  0.01411938  0.0859571 ]
Stock Position:  -0.004128021309012449
Bond Position:  [-4.77830986]


portfolio before change:  [-5.18978423]
curr_Stock_Price:  99.53365592947405
curr_Factors:  [99.53365593 -0.92959809 -1.02786536]
mat_Sqrt:  [[14.05576165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02238899 0.07667335 0.97458438]
Stock Position:  0.0223889944543844
Bond Position:  [-7.41824271]


portfolio before change:  [-5.18493244]
curr_Stock_Price:  99.79177954738644
curr_Factors:  [99.79177955 -1.11650127 -1.0479166 ]
mat_Sqrt:  [[11.45776808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00090493 0.00914278 0.3491291 ]
Stock Position:  0.0009049253429954345
Bond Position:  [-5.27523655]


portfolio before change:  [-5.18579164]
curr_Stock_Price:  99.57104662254504
curr_Factors:  [99.57104662 -1.10579148 -1.00792925]
mat_Sqrt:  [[12.02695868  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05875739 -0.06761016  0.10082354]
Stock Position:  -0.05875738868326092
Bond Position:  [0.66474305]


portfolio before change:  [-5.14025214]
curr_Stock_Price:  98.7974179955375
curr_Factors:  [98.797418   -1.0645192  -1.02135809]
mat_Sqrt:  [[12.27045313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180561 -0.04366731 -0.50713084]
Stock Position:  -0.0018056054716759336
Bond Position:  [-4.96186298]


portfolio before change:  [-5.14113034]
curr_Stock_Price:  98.9402671594397
curr_Factors:  [98.94026716 -0.93770017 -1.02674681]
mat_Sqrt:  [[13.87473176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00180373 -0.03636979 -0.06295641]
Stock Position:  0.0018037258856077529
Bond Position:  [-5.31959146]


portfolio before change:  [-5.14302228]
curr_Stock_Price:  98.2600358729076
curr_Factors:  [98.26003587 -0.87134649 -1.01320062]
mat_Sqrt:  [[14.925487    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01199643  0.05803321 -0.13560643]
Stock Position:  0.011996434308829167
Bond Position:  [-6.32179235]


portfolio before change:  [-5.14297012]
curr_Stock_Price:  98.33025995743863
curr_Factors:  [98.33025996 -0.81328069 -1.00133562]
mat_Sqrt:  [[16.01803871  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0135225   0.00394864 -0.26777661]
Stock Position:  -0.013522495494366349
Bond Position:  [-3.81329962]


portfolio before change:  [-5.15790419]
curr_Stock_Price:  99.39939548240083
curr_Factors:  [99.39939548 -0.61452749 -0.99879601]
mat_Sqrt:  [[19.80278404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239592 -0.01257157 -0.21743852]
Stock Position:  0.002395921463498119
Bond Position:  [-5.39605734]


portfolio before change:  [-5.16026944]
curr_Stock_Price:  98.69373619440783
curr_Factors:  [98.69373619 -0.36253453 -0.98255564]
mat_Sqrt:  [[25.71131862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00357377 -0.10902464  0.09331052]
Stock Position:  0.0035737716743284723
Bond Position:  [-5.51297832]


portfolio before change:  [-5.15975705]
curr_Stock_Price:  99.02995302339826
curr_Factors:  [99.02995302 -0.2446049  -1.00095757]
mat_Sqrt:  [[28.49874042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00062501 -0.01030091 -0.19409987]
Stock Position:  -0.0006250059173578494
Bond Position:  [-5.09786274]


portfolio before change:  [-5.16017751]
curr_Stock_Price:  98.68306542430642
curr_Factors:  [98.68306542 -0.62923774 -1.01852831]
mat_Sqrt:  [[18.99445905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01143331 -0.06043696  0.2954539 ]
Stock Position:  0.011433314186312776
Bond Position:  [-6.28845201]


portfolio before change:  [-5.18243442]
curr_Stock_Price:  96.80514948599914
curr_Factors:  [96.80514949 -0.59670711 -1.03307002]
mat_Sqrt:  [[18.97121936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00365512 -0.0261798  -0.1341857 ]
Stock Position:  0.0036551221625309347
Bond Position:  [-5.53626907]


portfolio before change:  [-5.17856939]
curr_Stock_Price:  98.05192356818674
curr_Factors:  [98.05192357 -0.65172944 -1.02632943]
mat_Sqrt:  [[18.30983406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00486388  0.03286753  0.25106124]
Stock Position:  -0.004863877162996921
Bond Position:  [-4.70165688]


portfolio before change:  [-5.18158706]
curr_Stock_Price:  98.55151018355268
curr_Factors:  [98.55151018 -0.62921673 -1.00967827]
mat_Sqrt:  [[19.13816217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061881 -0.05217768 -0.08478638]
Stock Position:  -0.000618806024893421
Bond Position:  [-5.12060279]


portfolio before change:  [-5.18212366]
curr_Stock_Price:  98.38423290380719
curr_Factors:  [98.3842329  -0.37264353 -1.03465813]
mat_Sqrt:  [[24.08475071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01314447 -0.07555977  0.20127089]
Stock Position:  -0.013144471972416654
Bond Position:  [-3.88891487]


portfolio before change:  [-5.16883378]
curr_Stock_Price:  97.33618537066118
curr_Factors:  [97.33618537 -0.46680241 -1.00866032]
mat_Sqrt:  [[22.2581467   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01185341 -0.03719686 -0.11622253]
Stock Position:  -0.011853405847346581
Bond Position:  [-4.01506847]


portfolio before change:  [-5.14938399]
curr_Stock_Price:  95.65298148031562
curr_Factors:  [95.65298148 -0.60747201 -0.99226721]
mat_Sqrt:  [[19.3170408   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0161692  0.34109996 0.6153244 ]
Stock Position:  0.016169203040075058
Bond Position:  [-6.69601647]


portfolio before change:  [-5.16903473]
curr_Stock_Price:  94.48943089581996
curr_Factors:  [94.4894309  -0.85054652 -0.98612161]
mat_Sqrt:  [[15.05665147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02079514 -0.01955872  0.79647707]
Stock Position:  -0.02079513852618548
Bond Position:  [-3.20411393]


portfolio before change:  [-5.17044002]
curr_Stock_Price:  94.53774755600618
curr_Factors:  [94.53774756 -1.00844063 -0.95615646]
mat_Sqrt:  [[13.25536146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00726429 -0.0192777  -0.13367117]
Stock Position:  -0.007264294889869674
Bond Position:  [-4.48368995]


portfolio before change:  [-5.1768752]
curr_Stock_Price:  95.34645326016299
curr_Factors:  [95.34645326 -0.99134969 -0.96470482]
mat_Sqrt:  [[13.48344479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01199911 -0.01342375  0.23660582]
Stock Position:  0.011999111119339894
Bond Position:  [-6.32094788]


portfolio before change:  [-5.16740348]
curr_Stock_Price:  96.20167373399887
curr_Factors:  [96.20167373 -1.23767543 -0.95741923]
mat_Sqrt:  [[10.71186594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01235357  0.00758454 -0.3295059 ]
Stock Position:  -0.012353571306577084
Bond Position:  [-3.97896924]


portfolio before change:  [-5.16558646]
curr_Stock_Price:  96.01432540530625
curr_Factors:  [96.01432541 -1.06337307 -0.94482082]
mat_Sqrt:  [[12.8880885   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082664 -0.03531867  0.30702297]
Stock Position:  0.0008266416500669334
Bond Position:  [-5.2449559]


portfolio before change:  [-5.16718664]
curr_Stock_Price:  94.87172305026455
curr_Factors:  [94.87172305 -1.02430177 -0.94375393]
mat_Sqrt:  [[13.25626132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00792924  0.02713602 -0.0159116 ]
Stock Position:  -0.007929236112397252
Bond Position:  [-4.41492635]


portfolio before change:  [-5.16446099]
curr_Stock_Price:  94.45837274822588
curr_Factors:  [94.45837275 -0.95093562 -0.93242571]
mat_Sqrt:  [[14.36504629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00199484 -0.05359809 -0.60858705]
Stock Position:  0.0019948376602315645
Bond Position:  [-5.35289011]


portfolio before change:  [-5.16576054]
curr_Stock_Price:  94.14236106769938
curr_Factors:  [94.14236107 -0.90412002 -0.92292404]
mat_Sqrt:  [[15.14641782  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00620937 -0.00667518  0.29752022]
Stock Position:  0.006209365075751217
Bond Position:  [-5.75032482]


portfolio before change:  [-5.16244279]
curr_Stock_Price:  94.79244012614751
curr_Factors:  [94.79244013 -0.6350798  -0.90125847]
mat_Sqrt:  [[20.39625677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00505796  0.01340858  0.36373765]
Stock Position:  -0.005057963390919309
Bond Position:  [-4.6829861]


portfolio before change:  [-5.16575584]
curr_Stock_Price:  95.33171540955966
curr_Factors:  [95.33171541 -0.46397123 -0.90311835]
mat_Sqrt:  [[24.29505852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02781956 -0.0232844  -2.26296567]
Stock Position:  -0.0278195644075854
Bond Position:  [-2.51366904]


portfolio before change:  [-5.11703327]
curr_Stock_Price:  93.56904251929168
curr_Factors:  [93.56904252 -0.43947911 -0.8878492 ]
mat_Sqrt:  [[24.81308849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00941512 -0.06226891 -0.50803926]
Stock Position:  0.009415119121866723
Bond Position:  [-5.99799695]


portfolio before change:  [-5.12963642]
curr_Stock_Price:  92.31007260573622
curr_Factors:  [92.31007261 -0.56747028 -0.91641915]
mat_Sqrt:  [[20.93168063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00611491  0.00472867 -0.08998553]
Stock Position:  0.006114913804314
Bond Position:  [-5.69410456]


portfolio before change:  [-5.12275675]
curr_Stock_Price:  93.55154254443234
curr_Factors:  [93.55154254 -0.71472258 -0.9101411 ]
mat_Sqrt:  [[18.42390236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00181613  0.08107379 -0.249502  ]
Stock Position:  0.0018161253774247302
Bond Position:  [-5.29265808]


portfolio before change:  [-5.1224921]
curr_Stock_Price:  94.06156634320261
curr_Factors:  [94.06156634 -0.88567615 -0.9253426 ]
mat_Sqrt:  [[15.37789032  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01319372  0.0092945  -0.46656945]
Stock Position:  -0.013193720985241636
Bond Position:  [-3.88147004]


portfolio before change:  [-5.14186854]
curr_Stock_Price:  95.49340056962504
curr_Factors:  [95.49340057 -0.88889836 -0.94113252]
mat_Sqrt:  [[15.31796393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001558    0.0474364   0.27110483]
Stock Position:  -0.001558000209101261
Bond Position:  [-4.9930898]


portfolio before change:  [-5.14343594]
curr_Stock_Price:  96.0988083271266
curr_Factors:  [96.09880833 -0.95424101 -0.95104324]
mat_Sqrt:  [[14.29761393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00645123  0.03107802  0.43595449]
Stock Position:  -0.006451230890186504
Bond Position:  [-4.52348034]


portfolio before change:  [-5.14602978]
curr_Stock_Price:  96.41322483317322
curr_Factors:  [96.41322483 -0.70247589 -0.96257622]
mat_Sqrt:  [[18.23953095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00510098 -0.0214199   0.02638087]
Stock Position:  -0.005100976560272408
Bond Position:  [-4.65422818]


portfolio before change:  [-5.14885783]
curr_Stock_Price:  96.85357757360444
curr_Factors:  [96.85357757 -0.81880363 -0.99070999]
mat_Sqrt:  [[15.85819987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00598251 0.02271098 0.04621648]
Stock Position:  0.005982512429404454
Bond Position:  [-5.72828556]


portfolio before change:  [-5.14430201]
curr_Stock_Price:  97.73479547362219
curr_Factors:  [97.73479547 -0.90063037 -1.00626284]
mat_Sqrt:  [[14.51763959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00746308  0.04077216  0.01953398]
Stock Position:  -0.007463075850422167
Bond Position:  [-4.41489982]


portfolio before change:  [-5.14138205]
curr_Stock_Price:  97.26959112591507
curr_Factors:  [97.26959113 -0.90393347 -1.00481247]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.14138205]
Stock Price:  96.93384565512591
PL:  [-5.14138205]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-3.83260154e-02  1.01559826e-01  4.26159942e-02]
 [-1.39386936e-02 -1.67131661e-02 -7.92327710e-02]
 [ 2.31539166e-01  5.27780020e-02  4.41264939e-02]
 [ 1.41606133e-03 -1.26284696e-02  8.29216720e-02]
 [-8.23185838e-01 -2.46325968e-01  3.25370431e-02]
 [-1.19637602e-02 -7.33369538e-02 -8.29264398e-02]
 [ 2.92681245e-02 -5.40994888e-02 -3.38520764e-02]
 [ 4.16182724e-01  9.66797423e-02 -1.26289794e-01]
 [-3.28732645e-01  5.38917359e-03 -1.22248805e-01]
 [ 3.15552606e-02  9.62288202e-03 -2.87931547e-02]
 [ 6.94877494e-03 -1.24093685e-01  1.27611861e-03]
 [-6.78570086e-02  5.16868363e-03  4.43820348e-02]
 [ 2.66191044e-01 -2.47310431e-01  8.10683285e-02]
 [ 8.52919891e-02 -4.01068566e-02 -7.16895920e-02]
 [ 9.05517653e-02 -1.00501503e-01 -6.75867263e-02]
 [-4.94694466e-02  3.34190962e-02  3.67937058e-02]
 [-4.57610597e-01 -2.82715548e-01  1.25552787e-01]
 [-1.35667830e-01  1.14938551e-02 -3.50691520e-02]
 [ 4.14496331e-01  1.54007978e+00  7.45560525e-01]
 [-6.21673059e-02  1.77394046e-03  8.54712592e-02]
 [-9.13491298e-02  1.40055506e-01 -3.74317703e-02]
 [ 5.26551283e-02  2.71967460e-03  3.42287303e-02]
 [-2.52505969e-02 -2.03329559e-02 -4.54954726e-02]
 [ 1.53812919e-02  2.00030496e-02  1.06327899e-01]
 [-8.13727277e-02 -2.04602325e-02 -8.60048837e-02]
 [ 1.07637291e-01 -3.40101187e-02 -2.64062310e-02]
 [ 9.40973833e-03 -5.47875911e-02 -2.09432283e-02]
 [ 2.52748497e-03  4.19277022e-02 -1.34704458e-02]
 [-5.15268444e-01  8.56329471e-02 -6.51812620e-01]
 [-7.10902191e-02 -1.15482958e-01 -2.63000249e-03]
 [-9.02798921e-02  9.22946337e-02  2.11615573e-01]
 [ 1.31940303e-02  4.67722935e-02  1.30125931e-02]
 [-1.36453876e-01 -1.69704838e-02 -1.33439103e-01]
 [-6.26685069e-02  6.55889122e-02  9.01108032e-02]
 [-9.13957904e-03 -3.75876486e-03  5.58696014e-02]
 [-1.62933496e-02 -1.72396863e-02  5.98081743e-02]
 [ 2.86777521e-02  1.57639395e-02 -1.82181674e-02]
 [-9.98635088e-02 -2.20602861e-02  2.46882558e-03]
 [-4.72109588e-03 -2.98683776e-01  1.13015651e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.73313681]
curr_Stock_Price:  101.16276132165092
curr_Factors:  [101.16276132  -0.98618126  -1.01704508]
mat_Sqrt:  [[13.64679065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197884  0.03211604  0.12157157]
Stock Position:  -0.001978838783051363
Bond Position:  [10.93332161]


portfolio before change:  [10.7343003]
curr_Stock_Price:  101.2654816131439
curr_Factors:  [101.26548161  -1.15231557  -1.01114752]
mat_Sqrt:  [[11.63808037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262445 -0.00528517 -0.22602904]
Stock Position:  -0.002624448913910378
Bond Position:  [11.00006638]


portfolio before change:  [10.73825584]
curr_Stock_Price:  100.28224571413197
curr_Factors:  [100.28224571  -1.18446043  -0.98782076]
mat_Sqrt:  [[11.42389798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02117571 0.01668987 0.1258806 ]
Stock Position:  0.021175711802169626
Bond Position:  [8.61470791]


portfolio before change:  [10.73553864]
curr_Stock_Price:  100.10307290712075
curr_Factors:  [100.10307291  -1.43774743  -0.98454977]
mat_Sqrt:  [[ 8.88090253  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202866 -0.00399347  0.23655245]
Stock Position:  0.0020286576721905733
Bond Position:  [10.53246377]


portfolio before change:  [10.73586132]
curr_Stock_Price:  99.61311653462617
curr_Factors:  [99.61311653 -1.25800155 -1.02789122]
mat_Sqrt:  [[10.12898468  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08124253 -0.07789511  0.09281913]
Stock Position:  -0.08124253096423609
Bond Position:  [18.82868303]


portfolio before change:  [10.74021357]
curr_Stock_Price:  99.5885171118819
curr_Factors:  [99.58851711 -1.39583034 -1.02176943]
mat_Sqrt:  [[ 8.876853    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00346796 -0.02319118 -0.23656605]
Stock Position:  -0.003467963340960297
Bond Position:  [11.0855829]


portfolio before change:  [10.74232705]
curr_Stock_Price:  99.37868474387797
curr_Factors:  [99.37868474 -1.52408282 -1.02417412]
mat_Sqrt:  [[ 7.7731906   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00269661 -0.01710776 -0.09657055]
Stock Position:  0.0026966089756895856
Bond Position:  [10.4743416]


portfolio before change:  [10.74498855]
curr_Stock_Price:  99.88010215804128
curr_Factors:  [99.88010216 -1.77769264 -1.00983153]
mat_Sqrt:  [[ 6.14996456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06388658  0.03057282 -0.36026963]
Stock Position:  0.06388657750724062
Bond Position:  [4.36399066]


portfolio before change:  [10.73068555]
curr_Stock_Price:  99.64768186037149
curr_Factors:  [99.64768186 -1.84382434 -1.00677403]
mat_Sqrt:  [[ 5.76060448  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06137332  0.00170421 -0.34874181]
Stock Position:  -0.06137332130794603
Bond Position:  [16.84639474]


portfolio before change:  [10.76261803]
curr_Stock_Price:  99.16169620772364
curr_Factors:  [99.16169621 -1.97464734 -0.99324184]
mat_Sqrt:  [[ 5.09807306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00508552  0.00304302 -0.08213886]
Stock Position:  0.005085518390916173
Bond Position:  [10.2583294]


portfolio before change:  [10.76459678]
curr_Stock_Price:  99.29863029853264
curr_Factors:  [99.2986303  -2.04360641 -0.97908365]
mat_Sqrt:  [[ 4.83287593  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082874 -0.03924187  0.00364041]
Stock Position:  0.0008287356099602694
Bond Position:  [10.68230447]


portfolio before change:  [10.76610577]
curr_Stock_Price:  99.50811906133721
curr_Factors:  [99.50811906 -2.02572242 -1.00619746]
mat_Sqrt:  [[ 4.79857669  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01222531  0.00163448  0.12660959]
Stock Position:  -0.012225314432882743
Bond Position:  [11.98262381]


portfolio before change:  [10.77026896]
curr_Stock_Price:  99.29010660426249
curr_Factors:  [99.2901066  -2.10671545 -1.02728307]
mat_Sqrt:  [[ 4.32342282  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06392008 -0.07820642  0.23126538]
Stock Position:  0.06392007686097231
Bond Position:  [4.42363771]


portfolio before change:  [10.76493889]
curr_Stock_Price:  99.1980689677001
curr_Factors:  [99.19806897 -1.80844038 -1.02700294]
mat_Sqrt:  [[ 5.82218271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01195821 -0.0126829  -0.20451045]
Stock Position:  0.011958205592804977
Bond Position:  [9.57870799]


portfolio before change:  [10.76471866]
curr_Stock_Price:  99.07951875280028
curr_Factors:  [99.07951875 -1.77292979 -1.03396755]
mat_Sqrt:  [[ 5.98361807  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01239396 -0.03178137 -0.19280612]
Stock Position:  0.012393963649671814
Bond Position:  [9.53673071]


portfolio before change:  [10.76226657]
curr_Stock_Price:  98.78548366526311
curr_Factors:  [98.78548367 -1.64044568 -1.02453954]
mat_Sqrt:  [[ 6.87550741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00597717  0.01056805  0.1049622 ]
Stock Position:  -0.0059771712873616795
Bond Position:  [11.35272432]


portfolio before change:  [10.76257192]
curr_Stock_Price:  98.97182995914388
curr_Factors:  [98.97182996 -1.39440673 -1.05616062]
mat_Sqrt:  [[ 8.53579002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05146353 -0.08940251  0.35816715]
Stock Position:  -0.05146353473307545
Bond Position:  [15.85601213]


portfolio before change:  [10.76109705]
curr_Stock_Price:  99.03900365013614
curr_Factors:  [99.03900365 -1.59874808 -1.07919221]
mat_Sqrt:  [[ 6.8044272   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02094659  0.00363468 -0.10004253]
Stock Position:  -0.02094658612915464
Bond Position:  [12.83562607]


portfolio before change:  [10.76417732]
curr_Stock_Price:  98.9685525126399
curr_Factors:  [98.96855251 -1.58001425 -1.09853311]
mat_Sqrt:  [[ 6.79546027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0892431  0.48701599 2.12687665]
Stock Position:  0.08924309773607825
Bond Position:  [1.93191711]


portfolio before change:  [10.79266696]
curr_Stock_Price:  99.28508275235015
curr_Factors:  [99.28508275 -1.67447204 -1.0980751 ]
mat_Sqrt:  [[ 6.20557572  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00719913  0.00056097  0.24382571]
Stock Position:  -0.0071991314341125715
Bond Position:  [11.50743332]


portfolio before change:  [10.7946815]
curr_Stock_Price:  99.2050696333646
curr_Factors:  [99.20506963 -1.38346013 -1.09074369]
mat_Sqrt:  [[ 8.35604556  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01141373  0.04428944 -0.10678242]
Stock Position:  -0.011413729091671545
Bond Position:  [11.92698129]


portfolio before change:  [10.80026225]
curr_Stock_Price:  98.8467481393945
curr_Factors:  [98.84674814 -1.45898408 -1.10853747]
mat_Sqrt:  [[ 7.58406328  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00787339 0.00086004 0.09764504]
Stock Position:  0.007873386348958601
Bond Position:  [10.02200362]


portfolio before change:  [10.80168576]
curr_Stock_Price:  98.86842644801408
curr_Factors:  [98.86842645 -1.81294629 -1.12764429]
mat_Sqrt:  [[ 5.22366551  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00671221 -0.00642985 -0.12978592]
Stock Position:  -0.006712205430210894
Bond Position:  [11.46531095]


portfolio before change:  [10.80122588]
curr_Stock_Price:  99.15047081823016
curr_Factors:  [99.15047082 -1.78060661 -1.11441173]
mat_Sqrt:  [[ 5.4828238   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00685812 0.00632552 0.3033239 ]
Stock Position:  0.006858119314296225
Bond Position:  [10.12124012]


portfolio before change:  [10.80111078]
curr_Stock_Price:  98.94920178485503
curr_Factors:  [98.94920178 -1.70885243 -1.14293681]
mat_Sqrt:  [[ 5.71341757  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01740756 -0.00647009 -0.24534799]
Stock Position:  -0.01740756401465716
Bond Position:  [12.52357535]


portfolio before change:  [10.80860982]
curr_Stock_Price:  98.60834469322377
curr_Factors:  [98.60834469 -1.45080576 -1.18368175]
mat_Sqrt:  [[ 7.07571412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01432633 -0.01075494 -0.07532963]
Stock Position:  0.014326328351357026
Bond Position:  [9.3959143]


portfolio before change:  [10.8130702]
curr_Stock_Price:  98.83769965608258
curr_Factors:  [98.83769966 -1.20996338 -1.21083832]
mat_Sqrt:  [[ 8.78176497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00042362 -0.01732536 -0.0597452 ]
Stock Position:  0.0004236176046077371
Bond Position:  [10.77120081]


portfolio before change:  [10.81451282]
curr_Stock_Price:  99.0646520293861
curr_Factors:  [99.06465203 -1.08111444 -1.18319261]
mat_Sqrt:  [[10.29301634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.35916635e-05  1.32587036e-02 -3.84274323e-02]
Stock Position:  8.359166352250238e-05
Bond Position:  [10.80623184]


portfolio before change:  [10.81585066]
curr_Stock_Price:  98.90881954727459
curr_Factors:  [98.90881955 -0.98823784 -1.17806152]
mat_Sqrt:  [[11.33504266  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05700094  0.02707952 -1.85943998]
Stock Position:  -0.057000941608690875
Bond Position:  [16.45374651]


portfolio before change:  [10.77371837]
curr_Stock_Price:  99.68405476162982
curr_Factors:  [99.68405476 -0.94182327 -1.21315553]
mat_Sqrt:  [[11.55394497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00645743 -0.03651892 -0.00750267]
Stock Position:  -0.006457432800237085
Bond Position:  [11.41742146]


portfolio before change:  [10.77357941]
curr_Stock_Price:  99.92660185659165
curr_Factors:  [99.92660186 -1.02363984 -1.23111156]
mat_Sqrt:  [[10.48226244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00426444  0.02918613  0.60368033]
Stock Position:  -0.004264442643717213
Bond Position:  [11.19971067]


portfolio before change:  [10.77925855]
curr_Stock_Price:  98.92316735884626
curr_Factors:  [98.92316736 -0.80510261 -1.23383361]
mat_Sqrt:  [[12.87654247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00132472 0.0147907  0.03712131]
Stock Position:  0.001324724412677182
Bond Position:  [10.64821261]


portfolio before change:  [10.78072836]
curr_Stock_Price:  99.0278712130754
curr_Factors:  [99.02787121 -0.65806029 -1.23826442]
mat_Sqrt:  [[14.86599854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01104064 -0.00536654 -0.38066462]
Stock Position:  -0.011040643798420794
Bond Position:  [11.87405981]


portfolio before change:  [10.78852908]
curr_Stock_Price:  98.45576984347808
curr_Factors:  [98.45576984 -0.6968067  -1.22071284]
mat_Sqrt:  [[14.47014949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294269  0.02074104  0.25706104]
Stock Position:  -0.002942693702450572
Bond Position:  [11.07825425]


portfolio before change:  [10.7887858]
curr_Stock_Price:  98.83914290266993
curr_Factors:  [98.8391429  -0.80843506 -1.25530973]
mat_Sqrt:  [[12.55035455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00017272 -0.00118863  0.15938042]
Stock Position:  0.00017272059509273696
Bond Position:  [10.77171424]


portfolio before change:  [10.79015608]
curr_Stock_Price:  98.97655396857954
curr_Factors:  [98.97655397 -0.66685991 -1.27993536]
mat_Sqrt:  [[14.12699803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032068 -0.00545167  0.17061607]
Stock Position:  -0.0003206756276323126
Bond Position:  [10.82189545]


portfolio before change:  [10.79158924]
curr_Stock_Price:  98.72602928470536
curr_Factors:  [98.72602928 -0.82077513 -1.26189864]
mat_Sqrt:  [[12.3009299   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00206212  0.004985   -0.05197136]
Stock Position:  0.0020621211288891507
Bond Position:  [10.58800421]


portfolio before change:  [10.79580258]
curr_Stock_Price:  100.12738216295824
curr_Factors:  [100.12738216  -1.07294679  -1.28554197]
mat_Sqrt:  [[ 9.4683479   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01055402 -0.00697607  0.00704287]
Stock Position:  -0.010554022417219196
Bond Position:  [11.85254922]


portfolio before change:  [10.80576041]
curr_Stock_Price:  99.3242600923818
curr_Factors:  [99.32426009 -1.12892938 -1.2780349 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.80576041]
Stock Price:  98.37467122234084
PL:  [10.80576041]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-6.97703652e-02 -1.82739512e-02 -2.33762326e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 3.01578262e-01 -4.07527838e-04 -7.99372394e-02]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.08618880e+00 -3.16994928e-01  5.00189377e-03]
 [-2.81512177e-02 -5.03702137e-02 -4.46490154e-02]
 [ 3.31956936e-02  6.49448432e-02 -8.72524215e-03]
 [ 3.47302160e-01 -1.27324466e-02 -8.93979884e-02]
 [-4.99813105e-01 -3.04620550e-02 -4.74077993e-02]
 [ 1.96078943e-02  2.99201729e-02 -1.92819652e-02]
 [-3.45156570e-02 -1.76688146e-01  1.20027863e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.27260189e-01 -3.96332903e-02  2.87460391e-01]
 [ 3.44374165e-02  3.39308310e-01  2.93957460e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-1.38835042e-02 -1.24443728e-02  3.54348943e-02]
 [-5.57615789e-01 -2.63083593e-01  1.61344481e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 2.55439079e-01  1.00431886e+00  4.52240846e-01]
 [-1.96214167e-02  4.06954426e-02  2.61947560e-02]
 [ 3.46284390e-02 -1.28697839e-01  7.36710279e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.48260123e-01 -2.88431572e-02  1.56253800e-01]
 [ 7.96455363e-02 -7.63251103e-02 -5.11460766e-02]
 [-8.13044203e-02 -1.71293146e-02  1.34276665e-01]
 [ 1.49245514e-02  6.33127695e-02 -1.63410417e-02]
 [-1.59132258e-01 -4.63250357e-02  2.02777782e-01]
 [ 3.58182487e-02  6.09630446e-02 -7.20004825e-02]
 [-6.48456867e-01 -7.63996289e-02 -9.57528271e-01]
 [-1.64674201e-01  1.26518272e-01 -3.90336754e-02]
 [-1.13904769e-01  6.32033243e-03  1.20360255e-01]
 [ 1.67568653e-02  6.78956504e-02  9.72779846e-03]
 [-1.47388032e-01  5.83331619e-04 -1.32809097e-01]
 [-5.86380054e-02  1.17396399e-01  1.21363945e-01]
 [ 2.09067060e-01 -1.70670284e-01 -8.10163433e-02]
 [-2.23089145e-03  1.00846964e-01  7.83926876e-02]
 [ 1.32368110e-02  1.32300132e-02 -4.49279603e-02]
 [-5.86774892e-02  9.61772011e-02 -6.48160813e-03]
 [-8.18089761e-02 -1.84325446e-01  5.16587109e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.57355635]
curr_Stock_Price:  100.86186705021136
curr_Factors:  [100.86186705  -1.24478213  -0.98318895]
mat_Sqrt:  [[10.86754524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00690256 -0.00577873 -0.06668588]
Stock Position:  -0.006902556968472647
Bond Position:  [9.26976114]


portfolio before change:  [8.57606695]
curr_Stock_Price:  100.66602557717775
curr_Factors:  [100.66602558  -1.11398385  -0.97805318]
mat_Sqrt:  [[12.42575485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365218  0.01411938  0.0859571 ]
Stock Position:  -0.003652175936739103
Bond Position:  [8.94371699]


portfolio before change:  [8.57597683]
curr_Stock_Price:  100.99682900684763
curr_Factors:  [100.99682901  -0.96436014  -0.97171163]
mat_Sqrt:  [[14.57076832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.95769100e-02 -1.28871618e-04 -2.28038694e-01]
Stock Position:  0.019576909956299897
Bond Position:  [6.59877101]


portfolio before change:  [8.58519346]
curr_Stock_Price:  101.42548328690825
curr_Factors:  [101.42548329  -1.18102686  -0.94763658]
mat_Sqrt:  [[12.06925045  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016325  -0.00659539  0.21422481]
Stock Position:  0.0016325002103118416
Bond Position:  [8.41961634]


portfolio before change:  [8.58668381]
curr_Stock_Price:  101.69368306991782
curr_Factors:  [101.69368307  -1.12817604  -0.9412973 ]
mat_Sqrt:  [[12.83905696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08515832 -0.1002426   0.01426901]
Stock Position:  -0.0851583234398511
Bond Position:  [17.24674737]


portfolio before change:  [8.70446849]
curr_Stock_Price:  100.335874580814
curr_Factors:  [100.33587458  -1.0333924   -0.92894844]
mat_Sqrt:  [[14.10010807  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273514 -0.01592846 -0.12737121]
Stock Position:  -0.0027351359973339807
Bond Position:  [8.97890075]


portfolio before change:  [8.70499655]
curr_Stock_Price:  100.55318463466834
curr_Factors:  [100.55318463  -0.95660903  -0.92581123]
mat_Sqrt:  [[15.306331    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00216195  0.02053736 -0.02489069]
Stock Position:  0.0021619504798192158
Bond Position:  [8.48760554]


portfolio before change:  [8.70726063]
curr_Stock_Price:  101.10965957372638
curr_Factors:  [101.10965957  -1.20612568  -0.90203549]
mat_Sqrt:  [[12.28089127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0267672  -0.00402635 -0.25502758]
Stock Position:  0.026767203989561627
Bond Position:  [6.00083775]


portfolio before change:  [8.71693654]
curr_Stock_Price:  101.44311822982614
curr_Factors:  [101.44311823  -1.407506    -0.87513334]
mat_Sqrt:  [[10.34867904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04930839 -0.00963295 -0.13524126]
Stock Position:  -0.049308390574237936
Bond Position:  [13.71893344]


portfolio before change:  [8.70124288]
curr_Stock_Price:  101.79617453513639
curr_Factors:  [101.79617454  -1.52999412  -0.86616762]
mat_Sqrt:  [[ 9.27025407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017739   0.00946159 -0.05500608]
Stock Position:  0.0017739012393926462
Bond Position:  [8.52066652]


portfolio before change:  [8.70351542]
curr_Stock_Price:  102.47681599150204
curr_Factors:  [102.47681599  -1.61440169  -0.87594058]
mat_Sqrt:  [[ 8.49344181  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00171628 -0.0558737   0.34240608]
Stock Position:  -0.0017162818884784794
Bond Position:  [8.87939452]


portfolio before change:  [8.70513153]
curr_Stock_Price:  102.18192444145157
curr_Factors:  [102.18192444  -1.62627277  -0.9074821 ]
mat_Sqrt:  [[ 8.10920578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00889429  0.00225658  0.15019092]
Stock Position:  -0.008894288855380843
Bond Position:  [9.61396708]


portfolio before change:  [8.70538824]
curr_Stock_Price:  102.28818524471222
curr_Factors:  [102.28818524  -1.34489241  -0.90190352]
mat_Sqrt:  [[10.81569416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01709687 -0.01253315  0.82004448]
Stock Position:  0.01709686549105184
Bond Position:  [6.95658089]


portfolio before change:  [8.69757548]
curr_Stock_Price:  101.78035042595975
curr_Factors:  [101.78035043  -1.37079221  -0.91421282]
mat_Sqrt:  [[10.35854758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00996299 0.10729871 0.83857881]
Stock Position:  0.00996299276754733
Bond Position:  [7.68353858]


portfolio before change:  [8.70352272]
curr_Stock_Price:  102.28087705454122
curr_Factors:  [102.28087705  -1.13694935  -0.91841548]
mat_Sqrt:  [[13.09666859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00327764 -0.03587186 -0.12433753]
Stock Position:  0.0032776376158881963
Bond Position:  [8.36828307]


portfolio before change:  [8.70693874]
curr_Stock_Price:  103.00393324387436
curr_Factors:  [103.00393324  -1.39723002  -0.91901883]
mat_Sqrt:  [[10.16060845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068615 -0.00393526  0.10108589]
Stock Position:  -0.0006861497542737338
Bond Position:  [8.77761486]


portfolio before change:  [8.70805255]
curr_Stock_Price:  102.97982855518568
curr_Factors:  [102.97982856  -1.38190523  -0.9479565 ]
mat_Sqrt:  [[10.02088489  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05303666 -0.08319434  0.46027089]
Stock Position:  -0.05303666089645035
Bond Position:  [14.1697588]


portfolio before change:  [8.74093404]
curr_Stock_Price:  102.39325024953739
curr_Factors:  [102.39325025  -1.39330924  -0.94247335]
mat_Sqrt:  [[ 9.90498539  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01325707  0.00580111 -0.05715682]
Stock Position:  -0.013257069915208036
Bond Position:  [10.09836851]


portfolio before change:  [8.72875876]
curr_Stock_Price:  103.40687195796734
curr_Factors:  [103.40687196  -1.53258193  -0.94649996]
mat_Sqrt:  [[ 8.66757914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04311282 0.31759351 1.29011725]
Stock Position:  0.04311281739148809
Bond Position:  [4.27059717]


portfolio before change:  [8.74226623]
curr_Stock_Price:  103.70779442196145
curr_Factors:  [103.70779442  -1.50884286  -0.91956975]
mat_Sqrt:  [[ 9.14461031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144606  0.01286903  0.07472635]
Stock Position:  -0.0014460630067971594
Bond Position:  [8.89223424]


portfolio before change:  [8.7430529]
curr_Stock_Price:  103.93249502850608
curr_Factors:  [103.93249503  -1.27637763  -0.91004177]
mat_Sqrt:  [[11.67351035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00396997 -0.04069783  0.21016294]
Stock Position:  0.003969972126890379
Bond Position:  [8.33044379]


portfolio before change:  [8.74291151]
curr_Stock_Price:  103.63456822479931
curr_Factors:  [103.63456822  -1.27074609  -0.90905626]
mat_Sqrt:  [[11.71732598  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331721  0.01916992 -0.08961985]
Stock Position:  -0.003317212797602607
Bond Position:  [9.08668942]


portfolio before change:  [8.74480943]
curr_Stock_Price:  103.40485356995481
curr_Factors:  [103.40485357  -1.21669769  -0.92512089]
mat_Sqrt:  [[12.1439769   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01477363 -0.00912101  0.4457486 ]
Stock Position:  0.014773625655121778
Bond Position:  [7.21714483]


portfolio before change:  [8.74040256]
curr_Stock_Price:  103.0454923051313
curr_Factors:  [103.04549231  -1.29484261  -0.95933199]
mat_Sqrt:  [[10.81566945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00621641 -0.02413612 -0.14590552]
Stock Position:  0.00621641420926379
Bond Position:  [8.0998291]


portfolio before change:  [8.74240512]
curr_Stock_Price:  103.20475197741656
curr_Factors:  [103.20475198  -1.41485971  -0.94888346]
mat_Sqrt:  [[ 9.70820808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00559708 -0.00541676  0.38305395]
Stock Position:  -0.005597076969912146
Bond Position:  [9.32005006]


portfolio before change:  [8.74349026]
curr_Stock_Price:  103.21903501474308
curr_Factors:  [103.21903501  -1.52501741  -0.95761621]
mat_Sqrt:  [[ 8.62116019  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00153386  0.02002126 -0.04661644]
Stock Position:  0.0015338630334635133
Bond Position:  [8.5851664]


portfolio before change:  [8.74528524]
curr_Stock_Price:  103.68958849489569
curr_Factors:  [103.68958849  -1.61955743  -0.97623455]
mat_Sqrt:  [[ 7.73387265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01537865 -0.01464926  0.57846857]
Stock Position:  -0.015378650376200308
Bond Position:  [10.33989117]


portfolio before change:  [8.74321963]
curr_Stock_Price:  103.90795458557446
curr_Factors:  [103.90795459  -1.82096712  -0.9549157 ]
mat_Sqrt:  [[ 6.47288968  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0035062   0.01927821 -0.20539734]
Stock Position:  0.00350620385850841
Bond Position:  [8.37889716]


portfolio before change:  [8.74603753]
curr_Stock_Price:  104.4129089992609
curr_Factors:  [104.412909    -1.76678776  -0.95608307]
mat_Sqrt:  [[ 6.85845699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12333447 -0.02415968 -2.73156163]
Stock Position:  -0.1233344669735417
Bond Position:  [21.62374801]


portfolio before change:  [8.72747939]
curr_Stock_Price:  104.58529616783116
curr_Factors:  [104.58529617  -1.81253252  -0.96703857]
mat_Sqrt:  [[ 6.49109915  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02609346  0.04000859 -0.11135221]
Stock Position:  -0.02609345896770893
Bond Position:  [11.45647152]


portfolio before change:  [8.74375791]
curr_Stock_Price:  104.01632684628768
curr_Factors:  [104.01632685  -1.61954922  -0.94658752]
mat_Sqrt:  [[ 7.99176095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01115813  0.00199866  0.34335431]
Stock Position:  -0.0111581346708487
Bond Position:  [9.9043861]


portfolio before change:  [8.73794412]
curr_Stock_Price:  104.64832528164858
curr_Factors:  [104.64832528  -1.50673228  -0.94575626]
mat_Sqrt:  [[ 9.00803449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00227526 0.02147049 0.0277507 ]
Stock Position:  0.0022752579410904774
Bond Position:  [8.49984218]


portfolio before change:  [8.73902683]
curr_Stock_Price:  104.65718736941575
curr_Factors:  [104.65718737  -1.53557519  -0.89734507]
mat_Sqrt:  [[ 9.18682011  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.89926996e-02  1.84465655e-04 -3.78867388e-01]
Stock Position:  -0.01899269956215314
Bond Position:  [10.72674934]


portfolio before change:  [8.72253406]
curr_Stock_Price:  105.59616358308656
curr_Factors:  [105.59616358  -1.22104876  -0.89430632]
mat_Sqrt:  [[12.73389021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242138  0.037124    0.34621755]
Stock Position:  -0.002421375662385979
Bond Position:  [8.97822204]


portfolio before change:  [8.72937507]
curr_Stock_Price:  103.23442110479714
curr_Factors:  [103.2344211   -1.21756353  -0.88081689]
mat_Sqrt:  [[12.66220938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01485704 -0.05397068 -0.23111708]
Stock Position:  0.014857042265527521
Bond Position:  [7.19561692]


portfolio before change:  [8.73143177]
curr_Stock_Price:  103.31230900720412
curr_Factors:  [103.31230901  -1.22945679  -0.89877091]
mat_Sqrt:  [[12.2991337   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00133138 0.03189061 0.22363252]
Stock Position:  0.0013313788370339652
Bond Position:  [8.59388394]


portfolio before change:  [8.73316206]
curr_Stock_Price:  103.80502449739181
curr_Factors:  [103.8050245   -1.32096506  -0.90979663]
mat_Sqrt:  [[11.15349254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00039517  0.0041837  -0.12816697]
Stock Position:  0.0003951701188086184
Bond Position:  [8.69214142]


portfolio before change:  [8.73451098]
curr_Stock_Price:  104.46887005583017
curr_Factors:  [104.46887006  -1.30512353  -0.89827655]
mat_Sqrt:  [[11.53619004  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00498581  0.0304139  -0.01849022]
Stock Position:  -0.004985810488050354
Bond Position:  [9.25537296]


portfolio before change:  [8.73302424]
curr_Stock_Price:  104.9991209490283
curr_Factors:  [104.99912095  -1.23081305  -0.91456806]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.73302424]
Stock Price:  104.90803167061671
PL:  [3.82499257]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.58632550e-01  2.97557999e-01  3.17130977e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.77774732e-01  2.11232940e-01  2.68571518e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-5.70504322e-01 -1.74750973e-01  3.87119302e-02]
 [ 2.06371585e-02 -1.43953802e-01 -1.86569692e-01]
 [ 3.34704170e-02  6.69659154e-03 -2.27498735e-02]
 [ 3.22039844e-01 -1.05138185e-02 -8.01051219e-02]
 [-4.42884936e-01 -2.03854484e-02 -6.45089420e-02]
 [ 4.65566278e-02 -1.58628280e-02 -4.07356065e-02]
 [ 9.22507209e-02 -2.34989138e-01 -1.73764484e-03]
 [-8.75109088e-02 -7.90158773e-02 -1.71733432e-01]
 [ 2.58409750e-01 -2.92514093e-01 -3.02358008e-02]
 [ 8.56944466e-02 -6.44468174e-02 -5.36400366e-02]
 [-1.57648285e-01  2.22102058e-01  1.66839726e-01]
 [ 1.59521724e-02 -2.22780595e-01 -5.02126954e-02]
 [ 4.18436734e-02 -2.35488395e-01 -6.87406983e-02]
 [-2.54267788e-01 -4.84212657e-02 -4.56338956e-02]
 [ 2.88377105e-01  1.29124312e+00  3.86045013e-01]
 [-3.00149423e-01 -4.58655909e-02  2.37622505e-01]
 [-8.71699324e-02  4.49211496e-03 -4.37883127e-02]
 [ 1.05278524e-01 -3.19723644e-02  6.69277387e-02]
 [-1.00448936e-01  2.89758445e-02 -1.11985311e-01]
 [-7.27475441e-03 -1.09271619e-01  1.06227700e-01]
 [-1.07537873e-01  8.93332718e-02  4.71762180e-03]
 [ 1.04681671e-01 -9.63680552e-02 -9.58392403e-02]
 [ 3.54644077e-02 -6.61294017e-02  1.12365208e-01]
 [-1.05030604e-01  4.14095085e-02  1.06018533e-01]
 [-4.26699310e-01 -2.95205527e-02 -6.40698193e-01]
 [ 2.17928244e-01 -1.42135263e-01 -1.64377092e-01]
 [ 1.34440181e-01  7.04307281e-03 -3.69090970e-02]
 [ 3.23131142e-02  1.74051895e-01 -4.80003639e-02]
 [-1.29028030e-01  2.37319216e-02 -1.67938463e-01]
 [-2.28223100e-02  1.43426766e-01  9.47640900e-02]
 [-1.89932963e-01  8.78855020e-02  6.83531810e-02]
 [-9.39829085e-02 -7.20433707e-02  1.05773295e-02]
 [ 1.27688847e-01  1.05788378e-01  3.82517348e-02]
 [-1.08392059e-01  1.26955486e-01  8.71493711e-03]
 [-1.54709571e-03 -2.62414670e-01  9.37856625e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.66099291]
curr_Stock_Price:  99.01789775413724
curr_Factors:  [99.01789775 -0.9145765  -1.00043363]
mat_Sqrt:  [[14.58933072  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00590949  0.0940961   0.90468641]
Stock Position:  -0.005909492879203593
Bond Position:  [-4.07584735]


portfolio before change:  [-4.66350021]
curr_Stock_Price:  99.35596244564687
curr_Factors:  [99.35596245 -0.94411431 -1.00066621]
mat_Sqrt:  [[14.20975163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319365  0.01411938  0.0859571 ]
Stock Position:  -0.0031936548938586167
Bond Position:  [-4.34619156]


portfolio before change:  [-4.66683377]
curr_Stock_Price:  100.22964938356587
curr_Factors:  [100.22964938  -0.85399737  -1.01500027]
mat_Sqrt:  [[15.46325249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02186155 0.06679772 0.76615979]
Stock Position:  0.021861550451102024
Bond Position:  [-6.85800931]


portfolio before change:  [-4.6567502]
curr_Stock_Price:  100.73011149733489
curr_Factors:  [100.7301115   -0.97311754  -1.02763294]
mat_Sqrt:  [[13.6221112   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0014464  -0.00659539  0.21422481]
Stock Position:  0.0014464023687691652
Bond Position:  [-4.80244647]


portfolio before change:  [-4.6592971]
curr_Stock_Price:  99.3843184137072
curr_Factors:  [99.38431841 -0.96926977 -1.01845246]
mat_Sqrt:  [[13.61636133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04164948 -0.05526111  0.11043436]
Stock Position:  -0.041649477361654426
Bond Position:  [-0.51999218]


portfolio before change:  [-4.63843285]
curr_Stock_Price:  98.88180900442198
curr_Factors:  [98.881809   -0.86099244 -1.04396326]
mat_Sqrt:  [[14.71650406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143805 -0.04552219 -0.5322314 ]
Stock Position:  -0.0014380515621068809
Bond Position:  [-4.49623571]


portfolio before change:  [-4.64056355]
curr_Stock_Price:  99.97261395325395
curr_Factors:  [99.97261395 -1.0457477  -1.04819435]
mat_Sqrt:  [[12.31667748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235449  0.00211765 -0.06489906]
Stock Position:  0.0023544924212009605
Bond Position:  [-4.87594831]


portfolio before change:  [-4.64115768]
curr_Stock_Price:  99.97915398651162
curr_Factors:  [99.97915399 -1.18060429 -1.0614636 ]
mat_Sqrt:  [[10.62164404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02875421 -0.00332476 -0.22851762]
Stock Position:  0.028754210520545876
Bond Position:  [-7.51597933]


portfolio before change:  [-4.63938936]
curr_Stock_Price:  100.07332744681335
curr_Factors:  [100.07332745  -0.99861026  -1.08083359]
mat_Sqrt:  [[12.50913704  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03649965 -0.00644644 -0.18402606]
Stock Position:  -0.03649964955625252
Bond Position:  [-0.98674797]


portfolio before change:  [-4.60879956]
curr_Stock_Price:  99.23186334731862
curr_Factors:  [99.23186335 -1.03748829 -1.0713829 ]
mat_Sqrt:  [[12.04425734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00314108 -0.00501627 -0.11620735]
Stock Position:  0.0031410762365881844
Bond Position:  [-4.92049441]


portfolio before change:  [-4.61274674]
curr_Stock_Price:  98.17105565500856
curr_Factors:  [98.17105566 -1.00149932 -1.06850795]
mat_Sqrt:  [[12.38770134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00692854 -0.07431009 -0.00495702]
Stock Position:  0.0069285358006196075
Bond Position:  [-5.29292841]


portfolio before change:  [-4.61755197]
curr_Stock_Price:  97.57301141457219
curr_Factors:  [97.57301141 -0.99659221 -1.08448408]
mat_Sqrt:  [[12.17670435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01023315 -0.02498701 -0.48990768]
Stock Position:  -0.010233149004182382
Bond Position:  [-3.6190728]


portfolio before change:  [-4.61679804]
curr_Stock_Price:  97.45512571091025
curr_Factors:  [97.45512571 -0.99750604 -1.09500556]
mat_Sqrt:  [[12.02370868  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02035023 -0.09250108 -0.08625432]
Stock Position:  0.020350227906912863
Bond Position:  [-6.60003206]


portfolio before change:  [-4.60909042]
curr_Stock_Price:  97.87441717781799
curr_Factors:  [97.87441718 -1.05612802 -1.09996142]
mat_Sqrt:  [[11.33160542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00644933 -0.02037987 -0.15302009]
Stock Position:  0.006449325372299806
Bond Position:  [-5.24031438]


portfolio before change:  [-4.61719636]
curr_Stock_Price:  96.71912430347494
curr_Factors:  [96.7191243  -0.8885285  -1.11166657]
mat_Sqrt:  [[13.08695699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00900573  0.07023484  0.4759473 ]
Stock Position:  -0.009005731266790003
Bond Position:  [-3.74616992]


portfolio before change:  [-4.61709022]
curr_Stock_Price:  96.65533794601934
curr_Factors:  [96.65533795 -0.95047313 -1.12661019]
mat_Sqrt:  [[12.11044267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.09740405e-06 -7.04494098e-02 -1.43242844e-01]
Stock Position:  -4.097404045468557e-06
Bond Position:  [-4.61669418]


portfolio before change:  [-4.61766612]
curr_Stock_Price:  96.35715842851909
curr_Factors:  [96.35715843 -0.68779284 -1.10216833]
mat_Sqrt:  [[16.08843214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135077 -0.07446797 -0.19609808]
Stock Position:  0.0013507688477167369
Bond Position:  [-4.74782236]


portfolio before change:  [-4.61886096]
curr_Stock_Price:  95.91198331888813
curr_Factors:  [95.91198332 -0.70713568 -1.12090391]
mat_Sqrt:  [[15.41577511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01717935 -0.01531215 -0.1301808 ]
Stock Position:  -0.01717935024290948
Bond Position:  [-2.97115541]


portfolio before change:  [-4.61370759]
curr_Stock_Price:  95.59038863221897
curr_Factors:  [95.59038863 -1.04881967 -1.11745041]
mat_Sqrt:  [[10.95506815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03656006 0.40832693 1.10127897]
Stock Position:  0.03656006167194589
Bond Position:  [-8.10849809]


portfolio before change:  [-4.61822878]
curr_Stock_Price:  95.49444897561324
curr_Factors:  [95.49444898 -0.99812697 -1.12156189]
mat_Sqrt:  [[11.46592115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02205049 -0.01450397  0.67787087]
Stock Position:  -0.022050489730878857
Bond Position:  [-2.51252941]


portfolio before change:  [-4.61623682]
curr_Stock_Price:  95.3898688823086
curr_Factors:  [95.38986888 -1.09504105 -1.10460592]
mat_Sqrt:  [[10.57323071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0090788   0.00142053 -0.12491587]
Stock Position:  -0.009078795412762046
Bond Position:  [-3.75021172]


portfolio before change:  [-4.62432744]
curr_Stock_Price:  96.22938671543862
curr_Factors:  [96.22938672 -1.01724502 -1.10801153]
mat_Sqrt:  [[11.49001323  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01027976 -0.01011055  0.19092621]
Stock Position:  0.010279759140195152
Bond Position:  [-5.61354235]


portfolio before change:  [-4.62724918]
curr_Stock_Price:  96.01342714715919
curr_Factors:  [96.01342715 -1.03562969 -1.10516491]
mat_Sqrt:  [[11.28747216  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01085803  0.00916297 -0.31946292]
Stock Position:  -0.010858028028243632
Bond Position:  [-3.5847327]


portfolio before change:  [-4.62883498]
curr_Stock_Price:  96.11820432851381
curr_Factors:  [96.11820433 -1.05624913 -1.09770676]
mat_Sqrt:  [[11.15204451  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103905 -0.03455472  0.30303806]
Stock Position:  0.0010390474178280744
Bond Position:  [-4.72870635]


portfolio before change:  [-4.62937958]
curr_Stock_Price:  96.16297530574431
curr_Factors:  [96.16297531 -0.92698339 -1.08919915]
mat_Sqrt:  [[12.80533487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00814257  0.02824966  0.01345806]
Stock Position:  -0.008142568559147228
Bond Position:  [-3.84636596]


portfolio before change:  [-4.63432638]
curr_Stock_Price:  96.71144766149932
curr_Factors:  [96.71144766 -1.06248857 -1.05107832]
mat_Sqrt:  [[11.68335156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00707249 -0.03047425 -0.27340268]
Stock Position:  0.007072487273484731
Bond Position:  [-5.31831687]


portfolio before change:  [-4.63525488]
curr_Stock_Price:  96.6741675484375
curr_Factors:  [96.67416755 -1.09223227 -1.04551118]
mat_Sqrt:  [[11.39987941  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00497316 -0.02091195  0.32054666]
Stock Position:  0.00497315837918473
Bond Position:  [-5.11603082]


portfolio before change:  [-4.64151641]
curr_Stock_Price:  95.5437017423206
curr_Factors:  [95.54370174 -0.95633523 -1.02787711]
mat_Sqrt:  [[13.13619513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00626669  0.01309484  0.30244137]
Stock Position:  -0.006266690726532033
Bond Position:  [-4.04277358]


portfolio before change:  [-4.63906431]
curr_Stock_Price:  95.07176670782188
curr_Factors:  [95.07176671 -0.66138314 -1.02880525]
mat_Sqrt:  [[17.53929256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03182817 -0.00933522 -1.82773361]
Stock Position:  -0.03182816505625346
Bond Position:  [-1.61310443]


portfolio before change:  [-4.64540595]
curr_Stock_Price:  95.26467724798864
curr_Factors:  [95.26467725 -0.6958845  -1.0529885 ]
mat_Sqrt:  [[16.57318605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01090346 -0.04494712 -0.46892209]
Stock Position:  0.01090345532066776
Bond Position:  [-5.68412011]


portfolio before change:  [-4.64492554]
curr_Stock_Price:  95.37390626086398
curr_Factors:  [95.37390626 -0.68799594 -1.07958039]
mat_Sqrt:  [[16.28474345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00780411  0.00222722 -0.10529138]
Stock Position:  0.007804114019718651
Bond Position:  [-5.38923438]


portfolio before change:  [-4.64437338]
curr_Stock_Price:  95.53098380273413
curr_Factors:  [95.5309838  -0.65524035 -1.06568638]
mat_Sqrt:  [[17.09051958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158035  0.05504004 -0.13693168]
Stock Position:  0.0015803546211180968
Bond Position:  [-4.79534622]


portfolio before change:  [-4.64594232]
curr_Stock_Price:  94.91752582288645
curr_Factors:  [94.91752582 -0.63133029 -1.06724498]
mat_Sqrt:  [[17.36459034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00936939  0.00750469 -0.47908169]
Stock Position:  -0.00936938715138341
Bond Position:  [-3.75662327]


portfolio before change:  [-4.63775792]
curr_Stock_Price:  93.99387902956555
curr_Factors:  [93.99387903 -0.55461138 -1.06670494]
mat_Sqrt:  [[18.57679717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.20899235e-05 4.53555259e-02 2.70335572e-01]
Stock Position:  1.2089923489974854e-05
Bond Position:  [-4.6388943]


portfolio before change:  [-4.6383232]
curr_Stock_Price:  95.20353340614952
curr_Factors:  [95.20353341 -0.47972901 -1.06401076]
mat_Sqrt:  [[20.33365288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00854304  0.02779184  0.1949926 ]
Stock Position:  -0.008543041191844661
Bond Position:  [-3.82499549]


portfolio before change:  [-4.64876176]
curr_Stock_Price:  96.3694421950624
curr_Factors:  [96.3694422  -0.6084279  -1.04653362]
mat_Sqrt:  [[18.41614363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508706 -0.02278211  0.03017418]
Stock Position:  -0.005087056981964419
Bond Position:  [-4.15852492]


portfolio before change:  [-4.64597805]
curr_Stock_Price:  95.72003735931592
curr_Factors:  [95.72003736 -0.38354711 -1.05940789]
mat_Sqrt:  [[22.61181713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0061131  0.03345322 0.10912155]
Stock Position:  0.006113104158421091
Bond Position:  [-5.23112461]


portfolio before change:  [-4.63549867]
curr_Stock_Price:  97.54125684017407
curr_Factors:  [97.54125684 -0.273602   -1.06480563]
mat_Sqrt:  [[25.58145841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403946  0.04014685  0.02486129]
Stock Position:  -0.0040394551190510485
Bond Position:  [-4.24148515]


portfolio before change:  [-4.64269543]
curr_Stock_Price:  99.19161299903462
curr_Factors:  [99.191613   -0.2581798  -1.08943288]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.64269543]
Stock Price:  98.50088133072562
PL:  [-4.64269543]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.12775221e-01  8.37086033e-03  4.38076422e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.40431663e-01  1.20869193e-02 -2.59279786e-02]
 [-9.74065621e-03  1.36231221e-02  1.07893253e-01]
 [-8.57038339e-01 -2.55915085e-01  3.17097749e-02]
 [-1.03788863e-02 -8.44602711e-02 -9.63470120e-02]
 [ 3.22440321e-02  2.13560099e-02 -2.19387409e-02]
 [ 3.33454732e-01 -1.46392621e-02 -8.39916441e-02]
 [-4.60063116e-01 -2.41956707e-02 -5.61082509e-02]
 [ 4.50047814e-02 -1.32264078e-02 -3.95001957e-02]
 [ 2.72867851e-02 -3.15437688e-01  1.41127010e-01]
 [-7.66351840e-02  6.30482239e-03  4.91560047e-02]
 [ 9.97871434e-02 -2.00292247e-02  2.66816167e-01]
 [ 5.78224671e-02  1.96437479e-01  1.52745302e-01]
 [ 6.83095990e-02 -1.13183807e-01 -4.97021179e-02]
 [-5.02065265e-02  7.79646084e-02  4.94756242e-02]
 [-4.50057842e-01 -2.53024253e-01  1.19515077e-01]
 [-1.30138173e-01  1.81860002e-02 -1.80017300e-02]
 [ 2.89017018e-01  1.17267381e+00  4.55631403e-01]
 [ 5.23585008e-03  1.58346959e-02  2.98976035e-02]
 [-6.85150992e-02  3.25007998e-02 -3.10648888e-02]
 [ 2.19286560e-02  2.01825605e-02  1.34583553e-02]
 [ 2.14843585e-02 -2.94276191e-02  1.50769692e-02]
 [ 4.26659860e-02  1.37810414e-01  9.37523872e-02]
 [-5.86133211e-02 -1.47552165e-01 -2.37598318e-02]
 [ 9.19328103e-02  9.45409038e-03 -1.27606751e-02]
 [-4.01791812e-03 -2.56354150e-02 -3.51944679e-02]
 [ 4.51320132e-03  4.20731620e-02 -6.01275322e-02]
 [-5.82095907e-01  3.70161333e-02 -7.93611951e-01]
 [-7.26644246e-02 -1.20949364e-01 -4.81427031e-04]
 [-8.11545759e-02  8.79789883e-02  2.01792234e-01]
 [ 2.10299207e-02  1.04673905e-01 -1.49444897e-02]
 [-1.04186168e-01 -5.68383303e-04 -1.62755670e-01]
 [-6.11840730e-02  1.01131703e-01  1.12652324e-01]
 [-5.69437917e-02  3.16701857e-02  8.45269425e-02]
 [-5.69360577e-02 -3.79991679e-02  2.69499429e-02]
 [ 9.38891324e-02  7.63807346e-02  1.80533495e-02]
 [-1.20190744e-01  1.85296172e-01  3.83813964e-03]
 [ 1.90185390e-03 -2.30588484e-01  7.65421982e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.26935743]
curr_Stock_Price:  100.12283319547086
curr_Factors:  [100.1228332   -0.90460305  -1.01118088]
mat_Sqrt:  [[14.74072141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0070293   0.0026471   0.12497101]
Stock Position:  -0.0070292956374883725
Bond Position:  [3.97315042]


portfolio before change:  [3.26683222]
curr_Stock_Price:  100.55273108386757
curr_Factors:  [100.55273108  -1.07107181  -1.01888289]
mat_Sqrt:  [[12.4376428   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364869  0.01411938  0.0859571 ]
Stock Position:  -0.0036486851706758012
Bond Position:  [3.63371748]


portfolio before change:  [3.26733235]
curr_Stock_Price:  100.54015581453538
curr_Factors:  [100.54015581  -1.10405824  -1.03129967]
mat_Sqrt:  [[11.88407541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01981233  0.00382222 -0.07396531]
Stock Position:  0.019812329612458858
Bond Position:  [1.27539764]


portfolio before change:  [3.25881928]
curr_Stock_Price:  100.10242321024613
curr_Factors:  [100.10242321  -1.02546466  -1.05625174]
mat_Sqrt:  [[12.48437039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00101204 0.00430801 0.30778942]
Stock Position:  0.0010120421675070344
Bond Position:  [3.15751141]


portfolio before change:  [3.25922151]
curr_Stock_Price:  100.1098473791352
curr_Factors:  [100.10984738  -1.18542577  -1.05260937]
mat_Sqrt:  [[10.67850574  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0802709  -0.08092746  0.09045916]
Stock Position:  -0.08027090387894761
Bond Position:  [11.29512945]


portfolio before change:  [3.2990497]
curr_Stock_Price:  99.63126539797685
curr_Factors:  [99.6312654  -1.1093464  -1.03482738]
mat_Sqrt:  [[11.67327744  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027607  -0.02670868 -0.27485121]
Stock Position:  -0.002760697905573953
Bond Position:  [3.57410152]


portfolio before change:  [3.29840896]
curr_Stock_Price:  100.02519676977596
curr_Factors:  [100.02519677  -1.31306484  -1.02825427]
mat_Sqrt:  [[ 9.62248952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00294282  0.00675336 -0.06258512]
Stock Position:  0.0029428159046241734
Bond Position:  [3.00405322]


portfolio before change:  [3.29973675]
curr_Stock_Price:  100.3487827773735
curr_Factors:  [100.34878278  -1.19346509  -0.98572589]
mat_Sqrt:  [[11.35276097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02782865 -0.00462934 -0.23960478]
Stock Position:  0.027828651249076696
Bond Position:  [0.50716547]


portfolio before change:  [3.30484593]
curr_Stock_Price:  100.53009902946307
curr_Factors:  [100.53009903  -1.28443827  -0.97192853]
mat_Sqrt:  [[10.52854747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04484388 -0.00765134 -0.16006122]
Stock Position:  -0.04484387764285971
Bond Position:  [7.81300539]


portfolio before change:  [3.30539613]
curr_Stock_Price:  100.53960956511062
curr_Factors:  [100.53960957  -1.02427832  -0.97504082]
mat_Sqrt:  [[13.61582393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00268807 -0.00418256 -0.11268306]
Stock Position:  0.002688073341749408
Bond Position:  [3.03513829]


portfolio before change:  [3.30778537]
curr_Stock_Price:  101.28729225306365
curr_Factors:  [101.28729225  -0.57629347  -1.01699349]
mat_Sqrt:  [[20.5872922   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00232909 -0.09975016  0.40259608]
Stock Position:  0.0023290896593559764
Bond Position:  [3.07187819]


portfolio before change:  [3.30674538]
curr_Stock_Price:  100.67589466205654
curr_Factors:  [100.67589466  -0.68406796  -1.02738672]
mat_Sqrt:  [[18.18235674  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365401  0.00199376  0.1402284 ]
Stock Position:  -0.0036540074358769967
Bond Position:  [3.67461585]


portfolio before change:  [3.3023197]
curr_Stock_Price:  102.01279304881497
curr_Factors:  [102.01279305  -0.69300275  -1.04526635]
mat_Sqrt:  [[17.93634546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00857107 -0.0063338   0.76115226]
Stock Position:  0.008571066681561282
Bond Position:  [2.42796125]


portfolio before change:  [3.29959572]
curr_Stock_Price:  101.65957057677707
curr_Factors:  [101.65957058  -1.02050508  -1.03702349]
mat_Sqrt:  [[12.98897756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00724256 0.06211899 0.43573983]
Stock Position:  0.007242561222394819
Bond Position:  [2.56332006]


portfolio before change:  [3.29885685]
curr_Stock_Price:  101.5133086849948
curr_Factors:  [101.51330868  -0.88813595  -1.04838617]
mat_Sqrt:  [[14.63868663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00377369 -0.03579186 -0.14178631]
Stock Position:  0.003773685762877412
Bond Position:  [2.91577752]


portfolio before change:  [3.29706742]
curr_Stock_Price:  100.9425353118773
curr_Factors:  [100.94253531  -0.85388756  -1.03994298]
mat_Sqrt:  [[15.19126902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250765  0.02465457  0.14114018]
Stock Position:  -0.0025076456380053033
Bond Position:  [3.55019553]


portfolio before change:  [3.29947044]
curr_Stock_Price:  100.16123599430057
curr_Factors:  [100.16123599  -0.9857942   -1.05015235]
mat_Sqrt:  [[13.07673495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03305068 -0.08001329  0.34094325]
Stock Position:  -0.03305068037164735
Bond Position:  [6.60986744]


portfolio before change:  [3.28420384]
curr_Stock_Price:  100.64815157196855
curr_Factors:  [100.64815157  -0.90537256  -1.07354967]
mat_Sqrt:  [[13.91139872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00958518  0.00575092 -0.05135392]
Stock Position:  -0.00958517562600252
Bond Position:  [4.24893405]


portfolio before change:  [3.27513812]
curr_Stock_Price:  101.6493719503865
curr_Factors:  [101.64937195  -1.15850388  -1.08317625]
mat_Sqrt:  [[10.80327396  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03816442 0.37083202 1.29978957]
Stock Position:  0.03816442102548503
Bond Position:  [-0.60425131]


portfolio before change:  [3.26825126]
curr_Stock_Price:  101.47089883860649
curr_Factors:  [101.47089884  -1.07339604  -1.094325  ]
mat_Sqrt:  [[11.61213895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00101166 0.00500737 0.08528954]
Stock Position:  0.001011658832715402
Bond Position:  [3.16559733]


portfolio before change:  [3.26793574]
curr_Stock_Price:  100.76785081847157
curr_Factors:  [100.76785082  -1.00640261  -1.09436487]
mat_Sqrt:  [[12.33020421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0060029   0.01027766 -0.08861948]
Stock Position:  -0.006002903496193568
Bond Position:  [3.87283542]


portfolio before change:  [3.27591069]
curr_Stock_Price:  99.51998501904477
curr_Factors:  [99.51998502 -1.26893735 -1.04970194]
mat_Sqrt:  [[ 9.79350287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00257282 0.00638229 0.03839294]
Stock Position:  0.0025728223137860664
Bond Position:  [3.01986345]


portfolio before change:  [3.27647844]
curr_Stock_Price:  99.59392788063586
curr_Factors:  [99.59392788 -1.21504609 -1.04555088]
mat_Sqrt:  [[10.38647237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00229165 -0.00930583  0.0430104 ]
Stock Position:  0.0022916456331943066
Bond Position:  [3.04824445]


portfolio before change:  [3.27825671]
curr_Stock_Price:  100.20362881938742
curr_Factors:  [100.20362882  -1.28372107  -1.04564532]
mat_Sqrt:  [[ 9.75556617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0066999  0.04357948 0.26744947]
Stock Position:  0.006699904478845379
Bond Position:  [2.60690197]


portfolio before change:  [3.28035151]
curr_Stock_Price:  100.46764984558226
curr_Factors:  [100.46764985  -1.45489342  -1.04677088]
mat_Sqrt:  [[ 8.23317303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00817098 -0.04666009 -0.06778019]
Stock Position:  -0.008170975731240987
Bond Position:  [4.10127024]


portfolio before change:  [3.28594042]
curr_Stock_Price:  99.84639972192976
curr_Factors:  [99.84639972 -1.30400906 -1.02789987]
mat_Sqrt:  [[ 9.69610318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00923795  0.00298965 -0.03640265]
Stock Position:  0.009237953679403423
Bond Position:  [2.363564]


portfolio before change:  [3.28831606]
curr_Stock_Price:  100.0715769301003
curr_Factors:  [100.07157693  -1.15666776  -1.02524827]
mat_Sqrt:  [[11.29059044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105077 -0.00810663 -0.10040002]
Stock Position:  -0.0010507743092927392
Bond Position:  [3.3934687]


portfolio before change:  [3.28847514]
curr_Stock_Price:  100.32390024338021
curr_Factors:  [100.32390024  -1.34740222  -1.00279285]
mat_Sqrt:  [[ 9.56594014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069768  0.0133047  -0.17152711]
Stock Position:  -0.0006976789864784486
Bond Position:  [3.35846901]


portfolio before change:  [3.28906306]
curr_Stock_Price:  100.0829661329312
curr_Factors:  [100.08296613  -1.30246558  -0.99951419]
mat_Sqrt:  [[10.01435674  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07420701  0.01170553 -2.263954  ]
Stock Position:  -0.07420701450417555
Bond Position:  [10.71592118]


portfolio before change:  [3.3318471]
curr_Stock_Price:  99.52446830415278
curr_Factors:  [99.5244683  -1.0509797  -0.99534131]
mat_Sqrt:  [[12.85949585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00590113 -0.03824755 -0.00137338]
Stock Position:  -0.005901132943617901
Bond Position:  [3.91915421]


portfolio before change:  [3.33373082]
curr_Stock_Price:  99.28827626101034
curr_Factors:  [99.28827626 -0.95913336 -0.98651969]
mat_Sqrt:  [[14.18768664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00265669  0.0278214   0.57565708]
Stock Position:  -0.002656691108022126
Bond Position:  [3.5975091]


portfolio before change:  [3.33569255]
curr_Stock_Price:  98.71914422003555
curr_Factors:  [98.71914422 -0.93089825 -0.97440479]
mat_Sqrt:  [[14.68719234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140817  0.0331008  -0.04263247]
Stock Position:  0.00140816962187636
Bond Position:  [3.19667925]


portfolio before change:  [3.33504667]
curr_Stock_Price:  97.97670058837609
curr_Factors:  [97.97670059 -0.94969455 -0.97706475]
mat_Sqrt:  [[14.26730284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.63203818e-03 -1.79738582e-04 -4.64296623e-01]
Stock Position:  -0.009632038177449391
Bond Position:  [4.27876199]


portfolio before change:  [3.33262807]
curr_Stock_Price:  98.28333079537303
curr_Factors:  [98.2833308  -0.99438247 -1.01940134]
mat_Sqrt:  [[13.11911901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027119   0.03198065  0.32136572]
Stock Position:  -0.00271190498700333
Bond Position:  [3.59916313]


portfolio before change:  [3.33431047]
curr_Stock_Price:  97.8288645424974
curr_Factors:  [97.82886454 -1.02121943 -1.03473648]
mat_Sqrt:  [[12.51920371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003105    0.01001499  0.24113184]
Stock Position:  -0.003104996291512464
Bond Position:  [3.63806873]


portfolio before change:  [3.335741]
curr_Stock_Price:  97.51461433756474
curr_Factors:  [97.51461434 -0.90186096 -1.02205947]
mat_Sqrt:  [[14.2403834   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036808  -0.01201639  0.07688069]
Stock Position:  -0.003680803844344636
Bond Position:  [3.69467317]


portfolio before change:  [3.33938144]
curr_Stock_Price:  96.65105880967747
curr_Factors:  [96.65105881 -0.99325058 -1.00156021]
mat_Sqrt:  [[13.14835125  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00757102 0.02415371 0.05150118]
Stock Position:  0.007571017622268446
Bond Position:  [2.60763457]


portfolio before change:  [3.34400911]
curr_Stock_Price:  97.21923823238049
curr_Factors:  [97.21923823 -1.18603797 -1.00232298]
mat_Sqrt:  [[10.89830931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0105175   0.05859579  0.01094914]
Stock Position:  -0.010517499258358706
Bond Position:  [4.36651238]


portfolio before change:  [3.35223934]
curr_Stock_Price:  96.4886103300259
curr_Factors:  [96.48861033 -0.80183952 -0.98321776]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.35223934]
Stock Price:  95.91410587465816
PL:  [3.35223934]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.75043927e-01  1.02790632e-01  1.82096562e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.26652030e-01 -1.56889752e-01 -2.85548656e-01]
 [ 4.46143677e-03 -1.97941930e-02  7.61053446e-02]
 [-8.42647329e-01 -2.51838663e-01  3.20614542e-02]
 [-4.33542127e-02 -2.12085377e-02 -4.24970518e-04]
 [ 3.34796358e-02  5.69521239e-02 -1.37202595e-02]
 [ 3.02544758e-01 -6.64959599e-02 -6.71605344e-02]
 [-3.93293489e-01 -1.45087638e-02 -6.71901452e-02]
 [ 5.38590221e-02 -2.82688108e-02 -4.65489761e-02]
 [ 5.47249122e-02 -3.27973068e-01  6.04286372e-02]
 [-4.00085097e-03 -3.30796682e-02 -6.91685545e-02]
 [ 2.22207077e-01 -2.19599986e-01  8.47451086e-02]
 [ 9.99974456e-02 -6.26655509e-03 -3.83439909e-02]
 [-5.34434377e-02 -1.11868921e-02  1.02079161e-02]
 [ 1.17151424e-02 -2.30591252e-01 -5.00246015e-02]
 [ 1.08942906e-01 -2.17393369e-01 -9.60999705e-02]
 [-2.99786056e-01 -1.98837899e-01 -4.65804601e-02]
 [ 2.05558681e-01  1.01152048e+00  1.31620162e-01]
 [-3.52109369e-01 -5.67504341e-02  2.67338739e-01]
 [-9.32112314e-02  2.00457728e-01 -3.45995212e-02]
 [-1.78173304e-02  2.99647534e-02 -3.41129723e-03]
 [ 2.00421850e-02 -3.18189823e-02  1.44159383e-02]
 [ 1.97003777e-02  9.36918850e-02  1.22785865e-01]
 [-9.83922210e-02  6.16729649e-02 -5.80133781e-02]
 [ 1.20889291e-01 -3.37556354e-02 -8.57997248e-03]
 [ 3.16946988e-02 -6.70450716e-02  8.71045225e-02]
 [-3.51135882e-04  4.22187651e-02  4.33502930e-03]
 [-7.20935413e-01 -4.15233975e-02 -1.06609221e+00]
 [-8.33034023e-02 -1.12451605e-01 -2.24541261e-04]
 [ 8.68731614e-02  2.96082814e-02  1.50479388e-02]
 [ 2.54254565e-02  1.45779337e-01 -3.50643981e-02]
 [-9.96088683e-02  1.29185280e-03 -1.70815090e-01]
 [-6.36399418e-02  4.23291980e-02  7.53593075e-02]
 [ 2.18667957e-02 -2.88207536e-02  3.42778668e-02]
 [-5.34404774e-02 -3.72932148e-02  2.88001207e-02]
 [ 1.43535500e-02  4.11166646e-03 -2.73178728e-02]
 [-6.91628155e-02  7.47795332e-02 -4.79465472e-03]
 [-4.23406805e-02 -2.37179288e-01  1.14822959e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.82026001]
curr_Stock_Price:  99.55302693813505
curr_Factors:  [99.55302694 -1.01733244 -0.98980621]
mat_Sqrt:  [[13.37720024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01010821  0.03250525  0.51947081]
Stock Position:  -0.010108212239934158
Bond Position:  [0.18604312]


portfolio before change:  [-0.82680271]
curr_Stock_Price:  100.20259419174351
curr_Factors:  [100.20259419  -1.09830493  -0.98963964]
mat_Sqrt:  [[12.41927268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365408  0.01411938  0.0859571 ]
Stock Position:  -0.0036540821676883804
Bond Position:  [-0.4606542]


portfolio before change:  [-0.82935898]
curr_Stock_Price:  100.88639878206517
curr_Factors:  [100.88639878  -1.31305636  -1.00241378]
mat_Sqrt:  [[ 9.9594811   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01649823 -0.0496129  -0.81459084]
Stock Position:  0.01649822689940223
Bond Position:  [-2.49380567]


portfolio before change:  [-0.83907036]
curr_Stock_Price:  100.31666274194282
curr_Factors:  [100.31666274  -1.31384597  -1.00089503]
mat_Sqrt:  [[ 9.91046047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00196613 -0.00625947  0.21710736]
Stock Position:  0.001966133803101619
Bond Position:  [-1.03630634]


portfolio before change:  [-0.83995254]
curr_Stock_Price:  99.93386104300923
curr_Factors:  [99.93386104 -1.19916731 -1.02645974]
mat_Sqrt:  [[10.79282464  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07807087 -0.07963838  0.0914624 ]
Stock Position:  -0.07807087448358864
Bond Position:  [6.96197138]


portfolio before change:  [-0.89298513]
curr_Stock_Price:  100.62429637737702
curr_Factors:  [100.62429638  -1.16642856  -1.03147568]
mat_Sqrt:  [[11.17288101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393708 -0.00670673 -0.00121232]
Stock Position:  -0.0039370831475531
Bond Position:  [-0.49681891]


portfolio before change:  [-0.89224732]
curr_Stock_Price:  100.42112099626232
curr_Factors:  [100.421121    -1.05756963  -0.97742135]
mat_Sqrt:  [[13.12319886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00244982  0.01800984 -0.03914008]
Stock Position:  0.0024498216769109336
Bond Position:  [-1.13826116]


portfolio before change:  [-0.89089993]
curr_Stock_Price:  101.02919781061202
curr_Factors:  [101.02919781  -0.95720019  -0.97837002]
mat_Sqrt:  [[14.5827504   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01968893 -0.02102787 -0.19159031]
Stock Position:  0.019688930060201004
Bond Position:  [-2.88005674]


portfolio before change:  [-0.91699004]
curr_Stock_Price:  99.72236788374654
curr_Factors:  [99.72236788 -0.89657237 -0.9863201 ]
mat_Sqrt:  [[15.17269644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02684976 -0.00458807 -0.19167478]
Stock Position:  -0.02684975847898273
Bond Position:  [1.76053145]


portfolio before change:  [-0.92143676]
curr_Stock_Price:  99.89617947806529
curr_Factors:  [99.89617948 -0.76009298 -1.00174312]
mat_Sqrt:  [[17.15509722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00254311 -0.00893938 -0.13279127]
Stock Position:  0.002543113223548499
Bond Position:  [-1.17548406]


portfolio before change:  [-0.92257696]
curr_Stock_Price:  99.50561381465258
curr_Factors:  [99.50561381 -0.62944338 -0.96657867]
mat_Sqrt:  [[20.16991256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0029049  -0.10371419  0.17238608]
Stock Position:  0.002904902428311416
Bond Position:  [-1.21163106]


portfolio before change:  [-0.92511718]
curr_Stock_Price:  98.6832942275916
curr_Factors:  [98.68329423 -0.68317756 -0.9445586 ]
mat_Sqrt:  [[19.37879658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00097911 -0.01046071 -0.19731863]
Stock Position:  -0.0009791080841894868
Bond Position:  [-0.82849557]


portfolio before change:  [-0.92500632]
curr_Stock_Price:  98.46428948117544
curr_Factors:  [98.46428948 -0.770499   -0.95455133]
mat_Sqrt:  [[17.54279995  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01332943 -0.06944361  0.24175421]
Stock Position:  0.01332943164027855
Bond Position:  [-2.23747934]


portfolio before change:  [-0.91006217]
curr_Stock_Price:  99.60641300389791
curr_Factors:  [99.606413   -0.59723397 -0.96940845]
mat_Sqrt:  [[20.79232918  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00442513 -0.00198166 -0.10938473]
Stock Position:  0.004425127586644074
Bond Position:  [-1.35083325]


portfolio before change:  [-0.91258216]
curr_Stock_Price:  99.07509985444084
curr_Factors:  [99.07509985 -0.71598919 -0.94127157]
mat_Sqrt:  [[18.88971106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273422 -0.00353761  0.02912034]
Stock Position:  -0.00273421862642364
Bond Position:  [-0.64168918]


portfolio before change:  [-0.91073761]
curr_Stock_Price:  98.37114452080634
curr_Factors:  [98.37114452 -0.58227483 -0.92956517]
mat_Sqrt:  [[21.69121872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00020515 -0.07291936 -0.14270626]
Stock Position:  -0.000205148782867533
Bond Position:  [-0.89055689]


portfolio before change:  [-0.91029192]
curr_Stock_Price:  95.65596937072675
curr_Factors:  [95.65596937 -0.71548226 -0.92074729]
mat_Sqrt:  [[18.62544295  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00449458 -0.06874582 -0.27414647]
Stock Position:  0.0044945781587950005
Bond Position:  [-1.34022515]


portfolio before change:  [-0.90781595]
curr_Stock_Price:  96.24412315699901
curr_Factors:  [96.24412316 -0.43856873 -0.90937276]
mat_Sqrt:  [[25.00176523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01257624 -0.06287806 -0.13288109]
Stock Position:  -0.012576240997857617
Bond Position:  [0.30257333]


portfolio before change:  [-0.91388744]
curr_Stock_Price:  96.72990534833447
curr_Factors:  [96.72990535 -0.26324263 -0.90536321]
mat_Sqrt:  [[30.06364943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00859985 0.31987086 0.37547569]
Stock Position:  0.008599850178010147
Bond Position:  [-1.74575014]


portfolio before change:  [-0.91588382]
curr_Stock_Price:  96.52314052797009
curr_Factors:  [96.52314053 -0.30182236 -0.89315838]
mat_Sqrt:  [[29.21849902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01023339 -0.01794606  0.76264301]
Stock Position:  -0.010233392460691014
Bond Position:  [0.07187536]


portfolio before change:  [-0.92097426]
curr_Stock_Price:  97.0214527698668
curr_Factors:  [97.02145277 -0.33622853 -0.88474267]
mat_Sqrt:  [[28.61585458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332326  0.0633903  -0.0987028 ]
Stock Position:  -0.0033232637697470533
Bond Position:  [-0.59854638]


portfolio before change:  [-0.92754124]
curr_Stock_Price:  98.97500154556326
curr_Factors:  [98.97500155 -0.56788454 -0.888213  ]
mat_Sqrt:  [[23.07546124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076878  0.00947569 -0.00973148]
Stock Position:  -0.000768780814681112
Bond Position:  [-0.85145116]


portfolio before change:  [-0.92771242]
curr_Stock_Price:  99.05921528525722
curr_Factors:  [99.05921529 -0.42271528 -0.88500222]
mat_Sqrt:  [[26.78923995  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082732 -0.01006205  0.04112466]
Stock Position:  0.0008273196078007939
Bond Position:  [-1.00966605]


portfolio before change:  [-0.92839605]
curr_Stock_Price:  98.3854651375266
curr_Factors:  [98.38546514 -0.79348218 -0.82999548]
mat_Sqrt:  [[19.40276187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00243177 0.02962798 0.3502739 ]
Stock Position:  0.0024317698562769494
Bond Position:  [-1.16764686]


portfolio before change:  [-0.92945574]
curr_Stock_Price:  98.00972080052524
curr_Factors:  [98.0097208  -0.95789807 -0.82928673]
mat_Sqrt:  [[16.40985174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00662052  0.0195027  -0.16549602]
Stock Position:  -0.00662052069740565
Bond Position:  [-0.28058035]


portfolio before change:  [-0.93222601]
curr_Stock_Price:  98.42286018872177
curr_Factors:  [98.42286019 -0.71477841 -0.81018715]
mat_Sqrt:  [[21.41962445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0055214  -0.01067447 -0.02447627]
Stock Position:  0.005521401389612962
Bond Position:  [-1.47565812]


portfolio before change:  [-0.93434575]
curr_Stock_Price:  98.07235581580792
curr_Factors:  [98.07235582 -0.83281365 -0.7789137 ]
mat_Sqrt:  [[19.56961648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00243969 -0.02120151  0.24848496]
Stock Position:  0.002439686985861761
Bond Position:  [-1.1736116]


portfolio before change:  [-0.93268139]
curr_Stock_Price:  98.81469330485626
curr_Factors:  [98.8146933  -0.770391   -0.79528652]
mat_Sqrt:  [[20.64697431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [7.86474605e-05 1.33507458e-02 1.23666320e-02]
Stock Position:  7.864746049463413e-05
Bond Position:  [-0.94045292]


portfolio before change:  [-0.93272948]
curr_Stock_Price:  99.69804530169856
curr_Factors:  [99.6980453  -0.67542692 -0.79279445]
mat_Sqrt:  [[22.9639294   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04091733 -0.01313085 -3.04126432]
Stock Position:  -0.04091733110288458
Bond Position:  [3.14664845]


portfolio before change:  [-0.92794506]
curr_Stock_Price:  99.59072963807813
curr_Factors:  [99.59072964 -0.50842147 -0.79674103]
mat_Sqrt:  [[27.00188245  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319432 -0.03556032 -0.00064055]
Stock Position:  -0.0031943226446411385
Bond Position:  [-0.60982013]


portfolio before change:  [-0.92306308]
curr_Stock_Price:  98.03853520638374
curr_Factors:  [98.03853521 -0.49304339 -0.79896077]
mat_Sqrt:  [[26.93311204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00336795 0.00936296 0.04292758]
Stock Position:  0.0033679469132078524
Bond Position:  [-1.25325166]


portfolio before change:  [-0.91917782]
curr_Stock_Price:  99.23865132949042
curr_Factors:  [99.23865133 -0.50624312 -0.78449492]
mat_Sqrt:  [[27.29734745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00080711  0.04609947 -0.10002897]
Stock Position:  0.0008071103804836524
Bond Position:  [-0.99927436]


portfolio before change:  [-0.92083448]
curr_Stock_Price:  97.34084120070756
curr_Factors:  [97.3408412  -0.5249423  -0.76326333]
mat_Sqrt:  [[26.84321321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.00845394e-03  4.08519726e-04 -4.87287905e-01]
Stock Position:  -0.005008453942632897
Bond Position:  [-0.43330736]


portfolio before change:  [-0.92954317]
curr_Stock_Price:  99.06882453900631
curr_Factors:  [99.06882454 -0.68121702 -0.7916253 ]
mat_Sqrt:  [[22.71379566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207646  0.01338567  0.21497913]
Stock Position:  -0.0020764628279861096
Bond Position:  [-0.72383044]


portfolio before change:  [-0.92913147]
curr_Stock_Price:  98.82697798820156
curr_Factors:  [98.82697799 -0.7450542  -0.81010104]
mat_Sqrt:  [[20.86796884  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013475  -0.00911392  0.09778521]
Stock Position:  0.0013474999679667689
Bond Position:  [-1.06230082]


portfolio before change:  [-0.93071939]
curr_Stock_Price:  97.74710637951006
curr_Factors:  [97.74710638 -0.94365012 -0.80420765]
mat_Sqrt:  [[17.02232688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00285064 -0.01179315  0.08215873]
Stock Position:  -0.002850643412888328
Bond Position:  [-0.65207725]


portfolio before change:  [-0.93577668]
curr_Stock_Price:  99.49259832210178
curr_Factors:  [99.49259832 -0.94217092 -0.78792374]
mat_Sqrt:  [[17.63681695  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050369  0.00130022 -0.07793029]
Stock Position:  0.0005036892628226134
Bond Position:  [-0.98589003]


portfolio before change:  [-0.93475879]
curr_Stock_Price:  101.7581477498817
curr_Factors:  [101.75814775  -0.85544603  -0.80107531]
mat_Sqrt:  [[19.41561341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00351319  0.02364736 -0.01367782]
Stock Position:  -0.003513189083968715
Bond Position:  [-0.57726318]


portfolio before change:  [-0.93465551]
curr_Stock_Price:  101.70820823760506
curr_Factors:  [101.70820824  -1.10751609  -0.82391494]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.93465551]
Stock Price:  102.01714376769792
PL:  [-2.95179927]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.43718403e-01  2.74984073e-01  2.92409172e-01]
 [-1.02911215e-01 -7.42241683e-02  1.17234445e-01]
 [ 1.66484290e-01  2.30964853e-01  3.69752298e-01]
 [-4.69012108e-02 -7.10506812e-02  7.47139089e-02]
 [-1.06986433e-01 -4.34541095e-02  5.00391167e-02]
 [ 6.29239709e-02 -2.20009977e-01 -2.96710305e-01]
 [ 2.53238023e-02 -2.18202197e-01 -3.23840247e-02]
 [ 1.54921598e-01  2.08973491e-01 -3.91243772e-02]
 [-1.61357777e-01  1.38738300e-02 -8.35099790e-02]
 [ 5.53592278e-02 -3.03915669e-02 -4.93289745e-02]
 [ 6.53497231e-02 -3.35487020e-01  4.41974931e-02]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.50242451e-01 -1.11233321e-01  1.90438720e-01]
 [ 1.01823880e-01 -6.71397272e-03 -3.91342375e-02]
 [ 7.24954081e-02 -1.13200832e-01 -5.20522668e-02]
 [-4.76441958e-02  7.15868982e-02  4.84851506e-02]
 [-3.99796165e-01 -2.11364841e-01  9.60148888e-02]
 [-1.46163106e-01 -1.59558324e-02 -1.27046304e-02]
 [ 2.00490475e-01  9.93168592e-01  2.14798900e-01]
 [ 1.35203420e-02  7.54904419e-03  3.11316978e-02]
 [-5.60198643e-02  9.98401897e-02 -1.70379117e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 8.94506294e-02 -3.95697421e-02  1.10855687e-01]
 [ 7.78196438e-02  1.37762334e-01  2.52938394e-02]
 [-6.22122937e-02 -1.95445754e-01  7.40504542e-02]
 [ 2.05217529e-02  6.17475552e-02 -1.47959182e-02]
 [ 4.80196466e-02 -6.30797088e-02  1.96497416e-01]
 [ 3.72672050e-02  4.93493741e-02 -7.15409482e-02]
 [-6.26316743e-01 -9.70576764e-02 -9.82605127e-01]
 [-4.80335830e-02 -1.05966511e-01 -2.46122803e-02]
 [ 7.95810060e-03  7.57407949e-02  1.57114198e-01]
 [ 1.60690203e-02  6.97859079e-02  1.84481774e-03]
 [-1.36453876e-01 -1.69704838e-02 -1.33439103e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 5.49922088e-02 -4.39912466e-02  3.02275804e-02]
 [-4.60160231e-03  1.17856223e-01  7.89629672e-02]
 [ 3.87038513e-02  3.78808099e-02 -4.02163114e-02]
 [-5.41553400e-02  9.28544176e-02 -6.94322637e-03]
 [-7.91592207e-02 -2.82843286e-01  1.08445571e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.16253809]
curr_Stock_Price:  99.0873474466942
curr_Factors:  [99.08734745 -0.9575627  -1.00292293]
mat_Sqrt:  [[13.95051085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00551453  0.0869576   0.83416198]
Stock Position:  -0.005514534449564025
Bond Position:  [-3.6161175]


portfolio before change:  [-4.15875742]
curr_Stock_Price:  98.31979123231382
curr_Factors:  [98.31979123 -1.12988519 -1.00523056]
mat_Sqrt:  [[11.62443791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00695924 -0.02347174  0.33443724]
Stock Position:  -0.006959243497928999
Bond Position:  [-3.47452605]


portfolio before change:  [-4.1607855]
curr_Stock_Price:  98.5488008377859
curr_Factors:  [98.54880084 -1.21807204 -0.99072641]
mat_Sqrt:  [[10.82386497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02290523 0.0730375  1.05480039]
Stock Position:  0.022905232926872427
Bond Position:  [-6.41806873]


portfolio before change:  [-4.18271327]
curr_Stock_Price:  97.62650207140193
curr_Factors:  [97.62650207 -0.882854   -0.98186557]
mat_Sqrt:  [[15.12621637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221369 -0.0224682   0.21313799]
Stock Position:  -0.0022136942802292647
Bond Position:  [-3.96659804]


portfolio before change:  [-4.18368557]
curr_Stock_Price:  97.84172712472729
curr_Factors:  [97.84172712 -0.73690757 -0.98540232]
mat_Sqrt:  [[17.47971828  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00560045 -0.0137414   0.14274767]
Stock Position:  -0.005600446198712523
Bond Position:  [-3.63572824]


portfolio before change:  [-4.18336126]
curr_Stock_Price:  97.70266656501606
curr_Factors:  [97.70266657 -0.6826449  -1.01392548]
mat_Sqrt:  [[17.90998658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.85505427e-04 -6.95732635e-02 -8.46431913e-01]
Stock Position:  -0.00018550542702572444
Bond Position:  [-4.16523689]


portfolio before change:  [-4.18394652]
curr_Stock_Price:  98.05073915319741
curr_Factors:  [98.05073915 -0.76066076 -0.98725729]
mat_Sqrt:  [[17.07417426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00076604 -0.06900159 -0.09238261]
Stock Position:  0.0007660390635032398
Bond Position:  [-4.25905722]


portfolio before change:  [-4.18450127]
curr_Stock_Price:  98.02158684786237
curr_Factors:  [98.02158685 -0.77899512 -0.99652093]
mat_Sqrt:  [[16.60446578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0091741   0.06608322 -0.11161096]
Stock Position:  0.00917410063110526
Bond Position:  [-5.08376117]


portfolio before change:  [-4.18595927]
curr_Stock_Price:  97.9319331066215
curr_Factors:  [97.93193311 -0.7620678  -1.00403365]
mat_Sqrt:  [[16.74619754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01063202  0.00438729 -0.23823073]
Stock Position:  -0.010632023105511052
Bond Position:  [-3.1447447]


portfolio before change:  [-4.20480597]
curr_Stock_Price:  99.66759313394164
curr_Factors:  [99.66759313 -0.67289617 -1.02969459]
mat_Sqrt:  [[18.16051672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00245066 -0.00961066 -0.14072183]
Stock Position:  0.002450661887564378
Bond Position:  [-4.44905754]


portfolio before change:  [-4.20649789]
curr_Stock_Price:  99.20414200841131
curr_Factors:  [99.20414201 -0.484865   -1.02055524]
mat_Sqrt:  [[22.01578146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00298464 -0.10609031  0.12608315]
Stock Position:  0.0029846435883507955
Bond Position:  [-4.5025869]


portfolio before change:  [-4.19980746]
curr_Stock_Price:  101.63434625248885
curr_Factors:  [101.63434625  -0.37175669  -1.04919452]
mat_Sqrt:  [[24.54308936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293873  0.00225658  0.15019092]
Stock Position:  -0.0029387343028636583
Bond Position:  [-3.90113112]


portfolio before change:  [-4.19406745]
curr_Stock_Price:  99.5151745810105
curr_Factors:  [99.51517458 -0.28580049 -1.03856639]
mat_Sqrt:  [[26.46818002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00703651 -0.03517506  0.54326866]
Stock Position:  0.007036507975305163
Bond Position:  [-4.89430677]


portfolio before change:  [-4.18367465]
curr_Stock_Price:  101.07910707384073
curr_Factors:  [101.07910707  -0.26510626  -1.06920889]
mat_Sqrt:  [[26.61801652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00351876 -0.00212314 -0.11163909]
Stock Position:  0.00351875516051312
Bond Position:  [-4.53934728]


portfolio before change:  [-4.1831754]
curr_Stock_Price:  101.38225523007158
curr_Factors:  [101.38225523  -0.62009981  -1.07089043]
mat_Sqrt:  [[18.68849013  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00315421 -0.03579725 -0.14849063]
Stock Position:  0.003154211514998753
Bond Position:  [-4.50295648]


portfolio before change:  [-4.1833849]
curr_Stock_Price:  101.4942980475781
curr_Factors:  [101.49429805  -0.56116964  -1.0763017 ]
mat_Sqrt:  [[19.73771523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181879  0.02263776  0.13831464]
Stock Position:  -0.0018187941062797646
Bond Position:  [-3.99878767]


portfolio before change:  [-4.18473789]
curr_Stock_Price:  101.96335057718046
curr_Factors:  [101.96335058  -0.38967998  -1.11862359]
mat_Sqrt:  [[22.56296547  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01709237 -0.06683943  0.27390375]
Stock Position:  -0.017092373141615914
Bond Position:  [-2.44194225]


portfolio before change:  [-4.166173]
curr_Stock_Price:  100.85934069299645
curr_Factors:  [100.85934069  -0.20093641  -1.10870846]
mat_Sqrt:  [[27.22353899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00547939 -0.00504568 -0.03624277]
Stock Position:  -0.005479390665096144
Bond Position:  [-3.61352527]


portfolio before change:  [-4.1701626]
curr_Stock_Price:  101.50501102273448
curr_Factors:  [101.50501102  -0.44451791  -1.11729265]
mat_Sqrt:  [[21.29128014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01268029 0.31406748 0.61276147]
Stock Position:  0.012680290608822961
Bond Position:  [-5.45727564]


portfolio before change:  [-4.17042723]
curr_Stock_Price:  101.5379418554832
curr_Factors:  [101.53794186  -0.59385389  -1.12077609]
mat_Sqrt:  [[18.27990847  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00109793 0.00238722 0.08881007]
Stock Position:  0.001097926101964844
Bond Position:  [-4.28190839]


portfolio before change:  [-4.17141297]
curr_Stock_Price:  101.1276560297108
curr_Factors:  [101.12765603  -0.49870669  -1.15254029]
mat_Sqrt:  [[19.39735394  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293441  0.03157224 -0.04860442]
Stock Position:  -0.0029344131676651325
Bond Position:  [-3.87466264]


portfolio before change:  [-4.17203496]
curr_Stock_Price:  101.17455805546402
curr_Factors:  [101.17455806  -0.58329697  -1.17292375]
mat_Sqrt:  [[17.47247195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00222458  0.01916992 -0.08961985]
Stock Position:  -0.002224577254784288
Bond Position:  [-3.94696434]


portfolio before change:  [-4.17338921]
curr_Stock_Price:  101.56153161649188
curr_Factors:  [101.56153162  -0.58974061  -1.17379015]
mat_Sqrt:  [[17.41155523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00637837 -0.01251305  0.31624042]
Stock Position:  0.006378365627774386
Bond Position:  [-4.8211858]


portfolio before change:  [-4.17567748]
curr_Stock_Price:  101.29726634277002
curr_Factors:  [101.29726634  -0.52224574  -1.1639664 ]
mat_Sqrt:  [[18.76225771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00461244 0.04356428 0.07215628]
Stock Position:  0.0046124371950051375
Bond Position:  [-4.64290476]


portfolio before change:  [-4.17737402]
curr_Stock_Price:  101.0552817013831
curr_Factors:  [101.0552817   -0.61965811  -1.16697309]
mat_Sqrt:  [[16.92914198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308008 -0.06180537  0.21124533]
Stock Position:  -0.003080084966508542
Bond Position:  [-3.86611516]


portfolio before change:  [-4.1782098]
curr_Stock_Price:  101.1697211546167
curr_Factors:  [101.16972115  -0.54337077  -1.17280146]
mat_Sqrt:  [[18.18554945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00105006  0.01952629 -0.04220864]
Stock Position:  0.0010500570118079106
Bond Position:  [-4.28444377]


portfolio before change:  [-4.17827247]
curr_Stock_Price:  101.62008752553082
curr_Factors:  [101.62008753  -0.41019538  -1.16241535]
mat_Sqrt:  [[21.08644664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0041022  -0.01994756  0.56055243]
Stock Position:  0.004102199115119157
Bond Position:  [-4.59513831]


portfolio before change:  [-4.17732212]
curr_Stock_Price:  101.99178543366834
curr_Factors:  [101.99178543  -0.46373836  -1.20228768]
mat_Sqrt:  [[19.27610484  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124186  0.01560564 -0.20408641]
Stock Position:  0.0012418569860767272
Bond Position:  [-4.30398134]


portfolio before change:  [-4.17830445]
curr_Stock_Price:  101.63401630788181
curr_Factors:  [101.63401631  -0.33318933  -1.20468393]
mat_Sqrt:  [[21.83479988  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03798506 -0.03069233 -2.80309892]
Stock Position:  -0.037985060450375994
Bond Position:  [-0.3177302]


portfolio before change:  [-4.08851176]
curr_Stock_Price:  99.26907575740734
curr_Factors:  [99.26907576 -0.18431603 -1.21144857]
mat_Sqrt:  [[24.58335297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226957 -0.03350955 -0.07021198]
Stock Position:  -0.0022695678392750575
Bond Position:  [-3.86321386]


portfolio before change:  [-4.09043195]
curr_Stock_Price:  99.90234804481585
curr_Factors:  [99.90234804 -0.11141329 -1.2506998 ]
mat_Sqrt:  [[25.58688965  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00164086 0.02395134 0.44820307]
Stock Position:  0.0016408606656177758
Bond Position:  [-4.25435778]


portfolio before change:  [-4.09148688]
curr_Stock_Price:  99.58354729487193
curr_Factors:  [ 9.95835473e+01 -8.51787694e-02 -1.22460811e+00]
mat_Sqrt:  [[26.87536544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00067897 0.02206824 0.00526275]
Stock Position:  0.0006789658940827838
Bond Position:  [-4.15910072]


portfolio before change:  [-4.09178813]
curr_Stock_Price:  99.90561383480124
curr_Factors:  [ 9.99056138e+01 -3.65154275e-02 -1.24288556e+00]
mat_Sqrt:  [[27.79413132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00590521 -0.00536654 -0.38066462]
Stock Position:  -0.005905210444856699
Bond Position:  [-3.50182446]


portfolio before change:  [-4.09552522]
curr_Stock_Price:  100.46432940826203
curr_Factors:  [100.46432941  -0.11846571  -1.25988013]
mat_Sqrt:  [[25.31651371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207034  0.0049611   0.16678008]
Stock Position:  -0.0020703365467761776
Bond Position:  [-3.88753025]


portfolio before change:  [-4.09599101]
curr_Stock_Price:  100.4545832266421
curr_Factors:  [ 1.00454583e+02  7.27520291e-03 -1.25364785e+00]
mat_Sqrt:  [[28.88530734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0020781  -0.01391125  0.08623087]
Stock Position:  0.0020780993616682057
Bond Position:  [-4.30474562]


portfolio before change:  [-4.09707231]
curr_Stock_Price:  100.19320579160699
curr_Factors:  [ 1.00193206e+02  8.87271160e-02 -1.23753539e+00]
mat_Sqrt:  [[31.76268289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00045839 0.03726941 0.22525937]
Stock Position:  0.0004583895044621849
Bond Position:  [-4.14299982]


portfolio before change:  [-4.09652301]
curr_Stock_Price:  102.52136433366972
curr_Factors:  [102.52136433  -0.13774938  -1.26103837]
mat_Sqrt:  [[25.31212333  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124339  0.01197896 -0.11472594]
Stock Position:  0.001243388753273298
Bond Position:  [-4.22399692]


portfolio before change:  [-4.09765643]
curr_Stock_Price:  102.03448307573343
curr_Factors:  [102.03448308  -0.22747299  -1.27351049]
mat_Sqrt:  [[22.74459065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233792  0.02936315 -0.01980709]
Stock Position:  -0.00233792422374079
Bond Position:  [-3.85910754]


portfolio before change:  [-4.09999718]
curr_Stock_Price:  102.82934592780187
curr_Factors:  [102.82934593  -0.18282022  -1.30656775]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.09999718]
Stock Price:  101.37402605314296
PL:  [-5.47402323]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.11031356e-01  6.55443730e-02  8.80185956e-02]
 [-4.99400980e-02  4.03030721e-02  2.23852950e-02]
 [ 3.47782411e-01 -4.24398473e-01 -7.75092541e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-9.60234194e-01 -2.85146518e-01  2.91879333e-02]
 [-2.34131206e-02 -5.94586108e-02 -5.84316827e-02]
 [ 3.41433034e-02  6.09855755e-02 -8.59644374e-03]
 [ 2.73151920e-01 -1.06407061e-01 -5.20961895e-02]
 [-5.75293745e-01 -2.87483452e-02 -8.82042843e-02]
 [ 5.77315616e-03  5.34239056e-02 -8.26825613e-03]
 [-1.25833577e-02 -2.23045124e-01  1.32007033e-01]
 [-9.10362891e-02  8.76741876e-03  6.04839069e-02]
 [ 1.02404641e-01 -2.08678227e-02  2.68775383e-01]
 [ 5.08618021e-02  2.28615610e-01  1.83664883e-01]
 [ 5.48378453e-02 -1.06921692e-01 -5.97050568e-02]
 [-4.47135724e-02  6.42924975e-02  4.73523128e-02]
 [-4.93403986e-01 -2.70381274e-01  1.37795433e-01]
 [-1.32814644e-01  1.76347197e-02 -1.70648574e-02]
 [ 3.02657814e-01  1.23266566e+00  4.72041614e-01]
 [ 1.91022800e-03  2.59723550e-03  3.62273440e-02]
 [-8.75386942e-02  1.65302157e-01 -3.31186488e-02]
 [-3.85844657e-03  3.16548147e-02 -1.37435799e-03]
 [ 3.61799434e-02 -3.36958208e-02  3.98429836e-02]
 [ 7.63241253e-02  1.34181079e-01  2.70631329e-02]
 [-5.93132750e-02 -1.54617504e-01  9.44892873e-02]
 [ 2.33551202e-02  6.09090153e-02 -1.31428659e-02]
 [ 1.73500201e-02 -7.05294230e-02 -9.01865793e-03]
 [ 2.18581904e-02  4.60788503e-02 -8.36127542e-02]
 [-6.37060196e-01 -7.74466750e-02 -9.76220345e-01]
 [-2.27329842e-01  5.75920037e-02  1.00944706e-02]
 [-1.39453037e-02  4.37837867e-02  1.39352667e-01]
 [ 1.31090741e-02  4.05919373e-02  1.61722199e-02]
 [-1.26025076e-01 -9.94392271e-03 -1.43494156e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [-2.65333457e-02  1.31458284e-02  7.32883414e-02]
 [-3.82781772e-02 -5.21550980e-02  4.76863883e-02]
 [ 8.40567418e-02  6.55267214e-02  1.37768560e-02]
 [-8.38074776e-02  6.87995448e-02 -2.43889016e-03]
 [-2.56698684e-02 -2.81295026e-01  9.94908920e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.77037081]
curr_Stock_Price:  100.7499592361199
curr_Factors:  [100.74995924  -0.75802761  -0.99911212]
mat_Sqrt:  [[17.38316238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00525637  0.02072695  0.25109255]
Stock Position:  -0.0052563673125053355
Bond Position:  [8.2999496]


portfolio before change:  [7.77063036]
curr_Stock_Price:  100.89797133413339
curr_Factors:  [100.89797133  -0.73651815  -0.98069972]
mat_Sqrt:  [[18.11774684  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244678  0.01274495  0.06385902]
Stock Position:  -0.002446777646742401
Bond Position:  [8.01750526]


portfolio before change:  [7.76786458]
curr_Stock_Price:  102.43796918997589
curr_Factors:  [102.43796919  -1.08563079  -0.96992079]
mat_Sqrt:  [[13.11433435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0136194  -0.13420658 -2.21112328]
Stock Position:  0.013619401691623973
Bond Position:  [6.37272073]


portfolio before change:  [7.75249609]
curr_Stock_Price:  101.25104956473484
curr_Factors:  [101.25104956  -0.99255187  -0.98143946]
mat_Sqrt:  [[14.06390718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140097 -0.00659539  0.21422481]
Stock Position:  0.0014009658665529803
Bond Position:  [7.61064682]


portfolio before change:  [7.75297925]
curr_Stock_Price:  100.91683043106627
curr_Factors:  [100.91683043  -1.12178187  -0.96689619]
mat_Sqrt:  [[12.49862525  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07693956 -0.09017125  0.08326505]
Stock Position:  -0.07693955650874133
Bond Position:  [15.51747543]


portfolio before change:  [7.79394199]
curr_Stock_Price:  100.40964092731446
curr_Factors:  [100.40964093  -0.79144538  -0.94476065]
mat_Sqrt:  [[17.69093201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208444 -0.01880246 -0.16668933]
Stock Position:  -0.002084438091638184
Bond Position:  [8.00323967]


portfolio before change:  [7.79458612]
curr_Stock_Price:  100.58059367352531
curr_Factors:  [100.58059367  -0.74715778  -0.96314608]
mat_Sqrt:  [[18.18606188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186754  0.01928533 -0.02452326]
Stock Position:  0.0018675402442647822
Bond Position:  [7.60674781]


portfolio before change:  [7.79668456]
curr_Stock_Price:  101.19505799962057
curr_Factors:  [101.195058    -0.74684152  -0.96538737]
mat_Sqrt:  [[18.26197504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01422466 -0.03364887 -0.14861593]
Stock Position:  0.01422466138811718
Bond Position:  [6.35721912]


portfolio before change:  [7.82949522]
curr_Stock_Price:  103.44579449420988
curr_Factors:  [103.44579449  -1.03172555  -0.99384034]
mat_Sqrt:  [[13.64648332  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04353068 -0.00909102 -0.25162227]
Stock Position:  -0.04353067634844875
Bond Position:  [12.33256062]


portfolio before change:  [7.84815283]
curr_Stock_Price:  103.052601908897
curr_Factors:  [103.05260191  -1.09082558  -0.98454633]
mat_Sqrt:  [[12.93410533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00042251  0.01689412 -0.02358703]
Stock Position:  0.000422511230564437
Bond Position:  [7.80461195]


portfolio before change:  [7.84879698]
curr_Stock_Price:  102.26803739930699
curr_Factors:  [102.2680374   -1.11886566  -1.01945528]
mat_Sqrt:  [[12.0525499   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071383 -0.07053306  0.37657932]
Stock Position:  0.0007138294276024435
Bond Position:  [7.77579504]


portfolio before change:  [7.84987283]
curr_Stock_Price:  102.41347718508958
curr_Factors:  [102.41347719  -1.15070811  -1.00723285]
mat_Sqrt:  [[11.83519075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00662969  0.0027725   0.17254375]
Stock Position:  -0.006629693698423163
Bond Position:  [8.52884282]


portfolio before change:  [7.85107944]
curr_Stock_Price:  102.39229466786573
curr_Factors:  [102.39229467  -1.0705503   -1.03042092]
mat_Sqrt:  [[12.52642276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0125119  -0.00659898  0.76674136]
Stock Position:  0.012511902620541424
Bond Position:  [6.56995702]


portfolio before change:  [7.84030044]
curr_Stock_Price:  101.46515366687427
curr_Factors:  [101.46515367  -1.26043532  -0.99014611]
mat_Sqrt:  [[10.68813231  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00881867 0.0722946  0.52394479]
Stock Position:  0.008818665986629178
Bond Position:  [6.94551314]


portfolio before change:  [7.82719225]
curr_Stock_Price:  99.88028527846755
curr_Factors:  [99.88028528 -1.03329477 -0.98729114]
mat_Sqrt:  [[13.2419048   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0030124  -0.03381161 -0.17032191]
Stock Position:  0.0030123985933082405
Bond Position:  [7.52631302]


portfolio before change:  [7.83075689]
curr_Stock_Price:  100.75128302372023
curr_Factors:  [100.75128302  -1.24169131  -0.99522217]
mat_Sqrt:  [[10.75898755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310325  0.02033107  0.13508297]
Stock Position:  -0.0031032470915896286
Bond Position:  [8.14341302]


portfolio before change:  [7.83348756]
curr_Stock_Price:  100.19938524671578
curr_Factors:  [100.19938525  -1.292445    -1.02795299]
mat_Sqrt:  [[ 9.84303458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04797889 -0.08550207  0.39309201]
Stock Position:  -0.04797888515958778
Bond Position:  [12.64094236]


portfolio before change:  [7.82675511]
curr_Stock_Price:  100.37264204860924
curr_Factors:  [100.37264205  -1.1650247   -0.99848085]
mat_Sqrt:  [[11.53497964  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01177658  0.00557659 -0.04868129]
Stock Position:  -0.011776584873115057
Bond Position:  [9.00880205]


portfolio before change:  [7.82286676]
curr_Stock_Price:  100.7984460783228
curr_Factors:  [100.79844608  -1.12209605  -0.98172386]
mat_Sqrt:  [[12.29635678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03503804 0.38980311 1.34660333]
Stock Position:  0.03503803631808105
Bond Position:  [4.29108715]


portfolio before change:  [7.82713913]
curr_Stock_Price:  100.90507167173024
curr_Factors:  [100.90507167  -1.05845722  -0.97181812]
mat_Sqrt:  [[13.24877183  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0007074  0.00082132 0.10334653]
Stock Position:  0.0007073986997572206
Bond Position:  [7.75575902]


portfolio before change:  [7.82753628]
curr_Stock_Price:  100.09592708005798
curr_Factors:  [100.09592708  -0.92226628  -0.96712676]
mat_Sqrt:  [[15.13085387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00595016  0.05227313 -0.09447829]
Stock Position:  -0.00595015506208701
Bond Position:  [8.42312256]


portfolio before change:  [7.83093203]
curr_Stock_Price:  99.70218993377186
curr_Factors:  [99.70218993 -0.98406699 -0.95539414]
mat_Sqrt:  [[14.33532134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023171  0.01001013 -0.00392066]
Stock Position:  -0.00023171175181703414
Bond Position:  [7.8540342]


portfolio before change:  [7.83189379]
curr_Stock_Price:  99.78873254455635
curr_Factors:  [99.78873254 -0.75198039 -0.97490063]
mat_Sqrt:  [[17.74625063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.002448   -0.01065555  0.11366094]
Stock Position:  0.002448000814813249
Bond Position:  [7.58761089]


portfolio before change:  [7.83606647]
curr_Stock_Price:  101.10579537770278
curr_Factors:  [101.10579538  -1.09633553  -0.99531466]
mat_Sqrt:  [[12.48486684  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00683331 0.04243178 0.07720359]
Stock Position:  0.006833305137344896
Bond Position:  [7.14517972]


portfolio before change:  [7.84083112]
curr_Stock_Price:  101.67235086643679
curr_Factors:  [101.67235087  -0.91613425  -1.00730341]
mat_Sqrt:  [[14.85472114  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296323 -0.04889435  0.26955164]
Stock Position:  -0.00296322875046288
Bond Position:  [8.14210956]


portfolio before change:  [7.84348814]
curr_Stock_Price:  101.11917323674125
curr_Factors:  [101.11917324  -0.71729149  -1.00984188]
mat_Sqrt:  [[17.97831638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00123732  0.01926112 -0.03749294]
Stock Position:  0.0012373243134196543
Bond Position:  [7.71837093]


portfolio before change:  [7.84551067]
curr_Stock_Price:  101.97398258599748
curr_Factors:  [101.97398259  -0.80765299  -1.04147262]
mat_Sqrt:  [[16.04812615  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085294 -0.02230336 -0.02572772]
Stock Position:  0.0008529364890869308
Bond Position:  [7.75853334]


portfolio before change:  [7.84620203]
curr_Stock_Price:  101.64744281789525
curr_Factors:  [101.64744282  -0.94396011  -1.06246453]
mat_Sqrt:  [[13.66838838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00043755  0.01457141 -0.23852391]
Stock Position:  0.0004375467745602513
Bond Position:  [7.80172652]


portfolio before change:  [7.84741392]
curr_Stock_Price:  102.18820171976279
curr_Factors:  [102.18820172  -0.89496697  -1.07162404]
mat_Sqrt:  [[14.29950927  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05862649 -0.02449079 -2.78488492]
Stock Position:  -0.05862648765633581
Bond Position:  [13.83834927]


portfolio before change:  [7.86173795]
curr_Stock_Price:  101.9733819304548
curr_Factors:  [101.97338193  -1.07542447  -1.05790642]
mat_Sqrt:  [[12.07794334  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01852818  0.01821219  0.02879671]
Stock Position:  -0.018528179126083944
Bond Position:  [9.75111904]


portfolio before change:  [7.85814108]
curr_Stock_Price:  102.23330171520453
curr_Factors:  [102.23330172  -0.97692563  -1.05090506]
mat_Sqrt:  [[13.45602261  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00116159 0.01384565 0.39753437]
Stock Position:  0.0011615938326271107
Bond Position:  [7.7393875]


portfolio before change:  [7.85875513]
curr_Stock_Price:  101.92903929536193
curr_Factors:  [101.9290393   -0.99396229  -1.05128371]
mat_Sqrt:  [[13.18435482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00132417 0.0128363  0.04613484]
Stock Position:  0.001324167485618291
Bond Position:  [7.72378401]


portfolio before change:  [7.85843023]
curr_Stock_Price:  100.9545173058432
curr_Factors:  [100.95451731  -1.07166461  -1.02879891]
mat_Sqrt:  [[12.35680069  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01259003 -0.00314454 -0.40934889]
Stock Position:  -0.012590026592683108
Bond Position:  [9.12945029]


portfolio before change:  [7.87898651]
curr_Stock_Price:  99.41242198626587
curr_Factors:  [99.41242199 -0.64608261 -1.01630404]
mat_Sqrt:  [[18.85711733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277952  0.0049611   0.16678008]
Stock Position:  -0.002779518345995038
Bond Position:  [8.15530516]


portfolio before change:  [7.88209269]
curr_Stock_Price:  98.66167635296114
curr_Factors:  [98.66167635 -0.57620981 -1.03674565]
mat_Sqrt:  [[19.66304778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057133  0.00415708  0.20907124]
Stock Position:  -0.000571325562941764
Bond Position:  [7.93846063]


portfolio before change:  [7.88330019]
curr_Stock_Price:  98.28514698165189
curr_Factors:  [98.28514698 -0.47817508 -1.02567307]
mat_Sqrt:  [[21.84615146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136824 -0.01649289  0.13603599]
Stock Position:  -0.0013682443275146975
Bond Position:  [8.01777828]


portfolio before change:  [7.88595289]
curr_Stock_Price:  97.07891397818072
curr_Factors:  [97.07891398 -0.39277297 -1.03582673]
mat_Sqrt:  [[23.26440446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00380671 0.02072137 0.03930154]
Stock Position:  0.003806709242000125
Bond Position:  [7.51640169]


portfolio before change:  [7.89476942]
curr_Stock_Price:  99.14813408836173
curr_Factors:  [99.14813409 -0.16906337 -1.06695574]
mat_Sqrt:  [[28.80635237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286496  0.02175633 -0.00695747]
Stock Position:  -0.002864955489220244
Bond Position:  [8.17882441]


portfolio before change:  [7.89363961]
curr_Stock_Price:  99.8993603104606
curr_Factors:  [ 9.98993603e+01  4.53306424e-02 -1.10653627e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.89363961]
Stock Price:  103.16305909155223
PL:  [4.73058052]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-8.84433659e-02  1.08454248e-01  9.81481999e-02]
 [ 3.76081744e-02 -9.83491067e-02 -2.24729680e-01]
 [ 3.81643229e-01 -2.05078094e-01 -4.47897308e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-6.42419140e-01 -1.94952618e-01  3.60226689e-02]
 [-4.01128818e-02 -2.74259076e-02 -9.85368933e-03]
 [ 3.17144543e-02  6.80939539e-02  4.70266578e-03]
 [ 2.59246274e-01 -1.39689076e-01 -4.35283327e-02]
 [-5.15979693e-01 -2.56252051e-02 -7.49660198e-02]
 [ 2.32023212e-02  2.38136281e-02 -2.21434557e-02]
 [ 2.11041197e-02 -3.13204302e-01  1.86811290e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 8.36675292e-02 -1.94807201e-02  2.47890113e-01]
 [ 7.01153964e-02  2.52041134e-01  2.16627103e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-4.73493974e-02  7.08531370e-02  4.83711958e-02]
 [-4.00716658e-01 -2.03966460e-01  9.55722771e-02]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 1.60394362e-01  8.30987320e-01  1.54038110e-01]
 [ 1.12418540e-02  9.82785111e-03  3.07922842e-02]
 [-3.84034999e-02 -7.44882118e-02  9.86692847e-03]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.19159142e-01 -3.55030076e-02  1.35190990e-01]
 [ 8.22634061e-02  5.20311544e-02 -1.25246105e-02]
 [-8.54126855e-02 -2.49559887e-02  1.73176300e-01]
 [ 1.38163245e-02  6.22564286e-02  9.10165666e-03]
 [ 1.02899991e-02 -5.13922714e-02  1.34300659e-01]
 [ 8.29617422e-02  6.95474856e-02 -8.35114811e-02]
 [-7.97945701e-01 -1.39525774e-01 -1.14775094e+00]
 [ 5.63740106e-02 -2.17524538e-01  2.21464416e-01]
 [-1.14924070e-01 -2.18004123e-01  1.37894636e-01]
 [ 1.14622797e-01  2.69897121e-01 -9.10479187e-02]
 [-9.25698100e-02  2.77564716e-03  4.52845567e-02]
 [-3.47641443e-02  2.68847530e-01  5.89518455e-02]
 [ 4.43678073e-02 -1.29705915e-01 -1.26524607e-01]
 [-6.02277695e-02  3.88628981e-01  8.78971585e-02]
 [ 2.04854081e-01  1.45905254e-01  1.58317918e-03]
 [ 9.32740243e-03  4.88729167e-02 -1.22782395e-02]
 [-1.24567835e-01 -2.51261298e-01  5.14028648e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.42886938]
curr_Stock_Price:  100.9810377846386
curr_Factors:  [100.98103778  -0.7366141   -1.00831507]
mat_Sqrt:  [[17.63708143  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371993  0.03429624  0.2799895 ]
Stock Position:  -0.0037199279339223098
Bond Position:  [9.80451156]


portfolio before change:  [9.42707099]
curr_Stock_Price:  101.79396432924428
curr_Factors:  [101.79396433  -0.53282847  -1.02095603]
mat_Sqrt:  [[21.52395094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.01949775e-04 -3.11007183e-02 -6.41091223e-01]
Stock Position:  -0.0005019497753468868
Bond Position:  [9.47816645]


portfolio before change:  [9.42806539]
curr_Stock_Price:  102.173370702724
curr_Factors:  [102.1733707   -0.72159586  -1.02185184]
mat_Sqrt:  [[17.87178817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01594253 -0.06485139 -1.27772635]
Stock Position:  0.015942527818217526
Bond Position:  [7.79916359]


portfolio before change:  [9.42940925]
curr_Stock_Price:  102.19650992089879
curr_Factors:  [102.19650992  -0.92931251  -1.02840246]
mat_Sqrt:  [[14.42817025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013656  -0.00659539  0.21422481]
Stock Position:  0.00136559616085135
Bond Position:  [9.28985008]


portfolio before change:  [9.42962081]
curr_Stock_Price:  101.50103245524974
curr_Factors:  [101.50103246  -0.58152189  -1.07059492]
mat_Sqrt:  [[19.45204427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03290655 -0.06164943  0.10276265]
Stock Position:  -0.032906551570599615
Bond Position:  [12.76966977]


portfolio before change:  [9.44336769]
curr_Stock_Price:  101.13178774708244
curr_Factors:  [101.13178775  -0.52569629  -1.0467548 ]
mat_Sqrt:  [[20.98847357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204076 -0.00867283 -0.02810983]
Stock Position:  -0.0020407578195385714
Bond Position:  [9.64975317]


portfolio before change:  [9.44505496]
curr_Stock_Price:  100.89610083214247
curr_Factors:  [100.89610083  -0.39337422  -1.02972807]
mat_Sqrt:  [[24.31246035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00141625 0.0215332  0.0134154 ]
Stock Position:  0.001416251575845919
Bond Position:  [9.3021607]


portfolio before change:  [9.44796453]
curr_Stock_Price:  102.12944740191239
curr_Factors:  [102.1294474   -0.66608572  -1.0410728 ]
mat_Sqrt:  [[18.52428509  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01332059 -0.04417356 -0.12417422]
Stock Position:  0.013320586059471073
Bond Position:  [8.08754044]


portfolio before change:  [9.4478898]
curr_Stock_Price:  102.04793882517593
curr_Factors:  [102.04793883  -0.45053466  -1.07189483]
mat_Sqrt:  [[22.26493907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02389154 -0.0081034  -0.21385719]
Stock Position:  -0.023891541150960732
Bond Position:  [11.88597233]


portfolio before change:  [9.4357604]
curr_Stock_Price:  102.61781554157093
curr_Factors:  [102.61781554  -0.57271374  -1.09190558]
mat_Sqrt:  [[19.42172407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099359  0.00753053 -0.06316912]
Stock Position:  0.0009935869938579305
Bond Position:  [9.33380068]


portfolio before change:  [9.43762629]
curr_Stock_Price:  103.3214205838537
curr_Factors:  [103.32142058  -0.36186257  -1.03618363]
mat_Sqrt:  [[25.52857776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00200363 -0.0990439   0.53292061]
Stock Position:  0.0020036335250728375
Bond Position:  [9.23060803]


portfolio before change:  [9.43468235]
curr_Stock_Price:  101.2762145238034
curr_Factors:  [101.27621452  -0.2407518   -1.06544111]
mat_Sqrt:  [[27.43058625  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262939  0.00225658  0.15019092]
Stock Position:  -0.0026293866973585074
Bond Position:  [9.70097668]


portfolio before change:  [9.4352597]
curr_Stock_Price:  101.5178488705222
curr_Factors:  [ 1.01517849e+02 -8.24424611e-02 -1.07582448e+00]
mat_Sqrt:  [[31.87964407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00419593 -0.00616034  0.70716149]
Stock Position:  0.00419593444173845
Bond Position:  [9.00929746]


portfolio before change:  [9.44469248]
curr_Stock_Price:  103.49751656533387
curr_Factors:  [103.49751657  -0.20455745  -1.06615928]
mat_Sqrt:  [[29.04455077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00416057 0.0797024  0.61797683]
Stock Position:  0.004160570213913993
Bond Position:  [9.0140838]


portfolio before change:  [9.44087014]
curr_Stock_Price:  102.30797382925607
curr_Factors:  [102.30797383  -0.21620222  -1.08083795]
mat_Sqrt:  [[27.9648243   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.001535   -0.03587186 -0.12433753]
Stock Position:  0.001535004588871965
Bond Position:  [9.28382693]


portfolio before change:  [9.44155683]
curr_Stock_Price:  101.9992708549081
curr_Factors:  [101.99927085  -0.32764975  -1.06848607]
mat_Sqrt:  [[25.25009297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141173  0.02240573  0.13798956]
Stock Position:  -0.0014117274067899682
Bond Position:  [9.585552]


portfolio before change:  [9.4419566]
curr_Stock_Price:  102.56489204038368
curr_Factors:  [102.56489204  -0.3118426   -1.06456364]
mat_Sqrt:  [[25.89602416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01492408 -0.06449986  0.2726411 ]
Stock Position:  -0.014924084023116443
Bond Position:  [10.97264366]


portfolio before change:  [9.42080415]
curr_Stock_Price:  104.07413799568315
curr_Factors:  [104.074138    -0.41305348  -1.07788658]
mat_Sqrt:  [[23.43342565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00560358  0.00580111 -0.05715682]
Stock Position:  -0.005603580361103832
Bond Position:  [10.00399194]


portfolio before change:  [9.43059446]
curr_Stock_Price:  102.55015891648866
curr_Factors:  [102.55015892  -0.37895439  -1.07138918]
mat_Sqrt:  [[24.04695719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00886986 0.26278126 0.43942785]
Stock Position:  0.008869864824534118
Bond Position:  [8.52098842]


portfolio before change:  [9.42409752]
curr_Stock_Price:  101.69759424447349
curr_Factors:  [101.69759424  -0.65953157  -1.10366248]
mat_Sqrt:  [[17.44075301  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00101951 0.00310784 0.08784182]
Stock Position:  0.0010195119865733006
Bond Position:  [9.32041561]


portfolio before change:  [9.42580205]
curr_Stock_Price:  102.2266728985305
curr_Factors:  [102.2266729   -0.51508616  -1.10943228]
mat_Sqrt:  [[20.1393214   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190238 -0.02355524  0.0281476 ]
Stock Position:  -0.0019023828114829488
Bond Position:  [9.62027631]


portfolio before change:  [9.42611811]
curr_Stock_Price:  102.69269526759437
curr_Factors:  [102.69269527  -0.59671951  -1.08090817]
mat_Sqrt:  [[19.18470421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202603  0.01916992 -0.08961985]
Stock Position:  -0.0020260340350286713
Bond Position:  [9.634177]


portfolio before change:  [9.42818747]
curr_Stock_Price:  102.26574662068082
curr_Factors:  [102.26574662  -0.57753525  -1.08799912]
mat_Sqrt:  [[19.33738777  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00754177 -0.01122704  0.38566227]
Stock Position:  0.00754177378194291
Bond Position:  [8.65692234]


portfolio before change:  [9.42956754]
curr_Stock_Price:  102.30524545705617
curr_Factors:  [102.30524546  -0.31103365  -1.08072465]
mat_Sqrt:  [[25.43694517  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00318632  0.0164537  -0.03572923]
Stock Position:  0.003186320873432031
Bond Position:  [9.1035902]


portfolio before change:  [9.43517009]
curr_Stock_Price:  103.70640097236253
curr_Factors:  [103.70640097  -0.3959983   -1.07934997]
mat_Sqrt:  [[23.71755665  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213798 -0.00789178  0.49402378]
Stock Position:  -0.0021379766405411177
Bond Position:  [9.65689195]


portfolio before change:  [9.43477484]
curr_Stock_Price:  104.45591046474324
curr_Factors:  [104.45591046  -0.45718131  -1.08998633]
mat_Sqrt:  [[22.23343924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00077728 0.01968721 0.02596449]
Stock Position:  0.0007772817457697489
Bond Position:  [9.35358317]


portfolio before change:  [9.43599274]
curr_Stock_Price:  104.51847143439079
curr_Factors:  [104.51847143  -0.52047979  -1.07923869]
mat_Sqrt:  [[21.10785687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00172339 -0.01625166  0.3831224 ]
Stock Position:  0.001723389716977502
Bond Position:  [9.25586668]


portfolio before change:  [9.43875661]
curr_Stock_Price:  105.45082689058646
curr_Factors:  [105.45082689  -0.6230142   -1.08492493]
mat_Sqrt:  [[19.11179375  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00354288  0.02199285 -0.23823501]
Stock Position:  0.003542877333217057
Bond Position:  [9.06515727]


portfolio before change:  [9.44484321]
curr_Stock_Price:  106.84895290243986
curr_Factors:  [106.8489529   -0.52615676  -1.07960943]
mat_Sqrt:  [[21.44839874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04829414 -0.04412192 -3.27421396]
Stock Position:  -0.04829413763603746
Bond Position:  [14.60502125]


portfolio before change:  [9.40414945]
curr_Stock_Price:  107.72938078228623
curr_Factors:  [107.72938078  -0.5639107   -1.10169862]
mat_Sqrt:  [[20.36897758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00471127 -0.0687873   0.63177634]
Stock Position:  0.0047112716125610994
Bond Position:  [8.89660708]


portfolio before change:  [9.41064467]
curr_Stock_Price:  108.8719757988736
curr_Factors:  [108.8719758   -0.52508434  -1.10367703]
mat_Sqrt:  [[21.35767771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432656 -0.06893896  0.39337501]
Stock Position:  -0.004326560627974735
Bond Position:  [9.88168588]


portfolio before change:  [9.40732157]
curr_Stock_Price:  109.92555779915473
curr_Factors:  [109.9255578   -0.56845256  -1.11443519]
mat_Sqrt:  [[20.42818654  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00504237  0.08534896 -0.25973437]
Stock Position:  0.005042367899196242
Bond Position:  [8.85303647]


portfolio before change:  [9.40704803]
curr_Stock_Price:  109.65182938630207
curr_Factors:  [109.65182939  -0.63578871  -1.15401327]
mat_Sqrt:  [[18.31111353  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454666  0.00087774  0.12918424]
Stock Position:  -0.004546663509157138
Bond Position:  [9.905598]


portfolio before change:  [9.41186149]
curr_Stock_Price:  108.86549893371537
curr_Factors:  [108.86549893  -0.74723086  -1.15968092]
mat_Sqrt:  [[16.17070694  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0009764   0.08501705  0.16817321]
Stock Position:  -0.000976397380220764
Bond Position:  [9.51815748]


portfolio before change:  [9.4127782]
curr_Stock_Price:  109.14523222744349
curr_Factors:  [109.14523223  -0.97422174  -1.15878403]
mat_Sqrt:  [[12.93159613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011748  -0.04101661 -0.36093949]
Stock Position:  0.0011748037515261528
Bond Position:  [9.28455397]


portfolio before change:  [9.41435756]
curr_Stock_Price:  109.50164896544734
curr_Factors:  [109.50164897  -0.96037835  -1.17455606]
mat_Sqrt:  [[12.94882686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249069  0.12289527  0.25074613]
Stock Position:  -0.0024906874091862718
Bond Position:  [9.68709194]


portfolio before change:  [9.4146539]
curr_Stock_Price:  109.86886751582395
curr_Factors:  [109.86886752  -0.77540589  -1.19307202]
mat_Sqrt:  [[15.34530605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01361618 0.04613929 0.00451637]
Stock Position:  0.013616183514184883
Bond Position:  [7.91865924]


portfolio before change:  [9.41089212]
curr_Stock_Price:  109.51989472388499
curr_Factors:  [109.51989472  -0.87947608  -1.19840128]
mat_Sqrt:  [[13.71141724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00058951  0.01545497 -0.0350264 ]
Stock Position:  0.0005895094889984908
Bond Position:  [9.3463291]


portfolio before change:  [9.41075201]
curr_Stock_Price:  107.30030425336038
curr_Factors:  [107.30030425  -0.98408945  -1.16773657]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.41075201]
Stock Price:  106.47175953986005
PL:  [2.93899247]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [ 6.14284933e-02  2.60380986e-01  4.99687260e-02]
 [-5.03972867e-02  9.91541584e-02  2.44388388e-01]
 [ 2.75965494e-01 -4.17700748e-01 -7.24999399e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.39998455e+00 -3.84010127e-01 -1.23212655e-01]
 [-2.77534825e-02  6.19861431e-02  8.60792815e-02]
 [-1.48508006e-02  2.09409082e-01  1.32462695e-01]
 [ 3.97265000e-01  1.52980792e-02 -1.11021042e-01]
 [-5.53952062e-01 -3.01643911e-02 -7.27471788e-02]
 [ 8.87552228e-04  6.17240214e-02 -4.37887133e-03]
 [-2.98072364e-02 -1.89788586e-01  1.33577466e-01]
 [-1.13609448e-01  1.33826261e-02  8.26496587e-02]
 [ 9.80468708e-02 -1.94716735e-02  2.65513560e-01]
 [ 1.63746282e-02  4.35413365e-01  3.87728142e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-1.87471456e-02 -3.38638205e-04  3.73149437e-02]
 [-5.36901606e-01 -2.61724112e-01  1.53350519e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 2.75506432e-01  1.15471612e+00  4.12075145e-01]
 [ 1.42423095e-02  6.82697561e-03  3.12392452e-02]
 [-6.57488229e-02 -5.03553133e-02 -3.77717989e-02]
 [-6.17916457e-03  3.64405408e-02 -5.77319308e-03]
 [ 5.42945034e-02 -3.51513636e-02  7.26505430e-02]
 [ 7.10937027e-02  1.96084865e-01  5.82926300e-02]
 [-5.69942364e-02 -1.93515411e-01 -1.84948713e-02]
 [ 2.03437673e-02  6.18002303e-02 -1.48997591e-02]
 [-2.11070071e-02  1.14659313e-02 -5.33317135e-02]
 [ 1.63090698e-03  4.26056146e-02 -6.52091251e-02]
 [-5.96021561e-01  1.16050884e-02 -8.38204942e-01]
 [-1.33489145e-01 -4.84508925e-02  4.50863476e-03]
 [-8.76452032e-02  8.93193608e-02  2.06183706e-01]
 [ 1.56640540e-02  6.99843836e-02  1.64812213e-03]
 [-1.24863235e-01 -9.28202172e-03 -1.44261582e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [-2.95951613e-02  7.06583437e-03  6.05797010e-02]
 [-1.56721026e-02 -8.41630938e-03  5.41953185e-02]
 [ 1.70601289e-03 -5.75671978e-03 -3.56470732e-02]
 [-8.33733995e-02  2.73578670e-02 -1.94216930e-03]
 [-3.18203780e-02 -2.83009024e-01  1.28725430e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.49547702]
curr_Stock_Price:  102.24428791682243
curr_Factors:  [102.24428792  -0.92668221  -1.02999932]
mat_Sqrt:  [[14.4498409   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0054223  0.0823397  0.14254687]
Stock Position:  0.005422296716979093
Bond Position:  [17.94107815]


portfolio before change:  [18.50050859]
curr_Stock_Price:  102.75860810591404
curr_Factors:  [102.75860811  -1.23242047  -1.01668294]
mat_Sqrt:  [[10.8403926   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.88963030e-04 3.13552980e-02 6.97172046e-01]
Stock Position:  0.00018896303041078655
Bond Position:  [18.48109101]


portfolio before change:  [18.50266396]
curr_Stock_Price:  101.9388291249861
curr_Factors:  [101.93882912  -1.30904475  -0.99863415]
mat_Sqrt:  [[10.1420893   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01155488 -0.13208857 -2.06822148]
Stock Position:  0.011554879931087973
Bond Position:  [17.32477303]


portfolio before change:  [18.51436977]
curr_Stock_Price:  102.76446098676645
curr_Factors:  [102.76446099  -1.30383631  -1.02656113]
mat_Sqrt:  [[ 9.99457196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197138 -0.00659539  0.21422481]
Stock Position:  0.0019713754613296225
Bond Position:  [18.31178243]


portfolio before change:  [18.5169953]
curr_Stock_Price:  102.93511079958222
curr_Factors:  [102.9351108   -1.39361826  -1.02562051]
mat_Sqrt:  [[ 9.16012684  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.15666271 -0.12143466 -0.35149141]
Stock Position:  -0.15666271365351955
Bond Position:  [34.64308909]


portfolio before change:  [18.52194059]
curr_Stock_Price:  102.93118752778872
curr_Factors:  [102.93118753  -1.30080188  -1.00697271]
mat_Sqrt:  [[10.23984101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083811  0.01960174  0.24556023]
Stock Position:  -0.0008381133465009441
Bond Position:  [18.60820859]


portfolio before change:  [18.52385283]
curr_Stock_Price:  103.42507430025177
curr_Factors:  [103.4250743   -1.36776856  -0.98383972]
mat_Sqrt:  [[ 9.8477121   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0017867  0.06622097 0.3778792 ]
Stock Position:  0.0017867046511655955
Bond Position:  [18.33906276]


portfolio before change:  [18.52556438]
curr_Stock_Price:  103.09990934602789
curr_Factors:  [103.09990935  -1.52495992  -0.99736142]
mat_Sqrt:  [[ 8.27614408  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0453107   0.00483768 -0.31671213]
Stock Position:  0.04531070455544291
Bond Position:  [13.85403485]


portfolio before change:  [18.50632309]
curr_Stock_Price:  102.63703530120107
curr_Factors:  [102.6370353   -1.33488327  -0.96674453]
mat_Sqrt:  [[10.27353366  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05544152 -0.00953882 -0.20752745]
Stock Position:  -0.055441523556673616
Bond Position:  [24.1966767]


portfolio before change:  [18.50932642]
curr_Stock_Price:  102.63742205150109
curr_Factors:  [102.63742205  -1.53863915  -0.95861134]
mat_Sqrt:  [[ 8.44818908  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0001879   0.01951885 -0.0124917 ]
Stock Position:  0.00018790136257853778
Bond Position:  [18.49004071]


portfolio before change:  [18.51169945]
curr_Stock_Price:  102.96540063600197
curr_Factors:  [102.96540064  -1.41635342  -0.93392856]
mat_Sqrt:  [[ 9.81695544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075799 -0.06001642  0.38105933]
Stock Position:  -0.0007579916719737574
Bond Position:  [18.58974637]


portfolio before change:  [18.51414762]
curr_Stock_Price:  102.80140655247065
curr_Factors:  [102.80140655  -1.44687697  -0.95403365]
mat_Sqrt:  [[ 9.31744463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01034545  0.00423196  0.23577647]
Stock Position:  -0.010345445889442037
Bond Position:  [19.57767401]


portfolio before change:  [18.51490857]
curr_Stock_Price:  102.9644165920859
curr_Factors:  [102.96441659  -1.32451383  -0.97195229]
mat_Sqrt:  [[10.35963853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01464741 -0.00615748  0.75743628]
Stock Position:  0.014647407079678678
Bond Position:  [17.00674685]


portfolio before change:  [18.51535416]
curr_Stock_Price:  102.84969412725911
curr_Factors:  [102.84969413  -1.40529416  -0.94941516]
mat_Sqrt:  [[ 9.76260552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01093577 0.1376898  1.10608047]
Stock Position:  0.010935772043928576
Bond Position:  [17.39061335]


portfolio before change:  [18.51388949]
curr_Stock_Price:  102.5169662108453
curr_Factors:  [102.51696621  -1.30305143  -0.94757488]
mat_Sqrt:  [[10.79844345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00397521 -0.03587186 -0.12433753]
Stock Position:  0.003975214930296614
Bond Position:  [18.10636251]


portfolio before change:  [18.51585078]
curr_Stock_Price:  102.44095875602002
curr_Factors:  [102.44095876  -1.28270472  -0.96478921]
mat_Sqrt:  [[10.82429015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102908 -0.00010709  0.10644915]
Stock Position:  -0.0010290751717839572
Bond Position:  [18.62127022]


portfolio before change:  [18.51821144]
curr_Stock_Price:  102.40903241277026
curr_Factors:  [102.40903241  -1.31127654  -0.98930413]
mat_Sqrt:  [[10.26145094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04993024 -0.08276443  0.43746635]
Stock Position:  -0.0499302441121184
Bond Position:  [23.63151942]


portfolio before change:  [18.53186918]
curr_Stock_Price:  102.19466099696439
curr_Factors:  [102.194661    -1.06377849  -1.00359954]
mat_Sqrt:  [[12.92936926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01015603  0.00580111 -0.05715682]
Stock Position:  -0.010156031680722313
Bond Position:  [19.56976139]


portfolio before change:  [18.54432071]
curr_Stock_Price:  101.20951611195986
curr_Factors:  [101.20951611  -1.00863617  -1.00832938]
mat_Sqrt:  [[13.46679785  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0289182  0.3651533  1.17553569]
Stock Position:  0.028918200555902267
Bond Position:  [15.61752363]


portfolio before change:  [18.53657692]
curr_Stock_Price:  100.8742218225034
curr_Factors:  [100.87422182  -1.1704567   -1.01033681]
mat_Sqrt:  [[11.3939317   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00182512 0.00215888 0.08911687]
Stock Position:  0.0018251176147730602
Bond Position:  [18.3524696]


portfolio before change:  [18.53889468]
curr_Stock_Price:  100.88713158032789
curr_Factors:  [100.88713158  -1.22220997  -1.01929469]
mat_Sqrt:  [[10.72414477  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0069711  -0.01592375 -0.10775243]
Stock Position:  -0.006971103922736525
Bond Position:  [19.24218936]


portfolio before change:  [18.54641259]
curr_Stock_Price:  100.15374963762746
curr_Factors:  [100.15374964  -1.09650763  -1.03444904]
mat_Sqrt:  [[11.89061983  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00053965  0.01152351 -0.01646931]
Stock Position:  -0.0005396457075829028
Bond Position:  [18.60046013]


portfolio before change:  [18.54836523]
curr_Stock_Price:  100.84412311066006
curr_Factors:  [100.84412311  -1.00568055  -1.03845185]
mat_Sqrt:  [[13.05855638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0052239  -0.01111584  0.20725178]
Stock Position:  0.005223902791508531
Bond Position:  [18.02156534]


portfolio before change:  [18.54926103]
curr_Stock_Price:  100.58434829118872
curr_Factors:  [100.58434829  -0.75931396  -1.03857672]
mat_Sqrt:  [[16.66158844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00528494 0.06200748 0.16629265]
Stock Position:  0.0052849418133501394
Bond Position:  [18.0176786]


portfolio before change:  [18.55044052]
curr_Stock_Price:  100.38134428710617
curr_Factors:  [100.38134429  -0.87999904  -1.03350729]
mat_Sqrt:  [[14.81247965  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00443991 -0.06119495 -0.05276072]
Stock Position:  -0.004439907035418257
Bond Position:  [18.99612435]


portfolio before change:  [18.54855568]
curr_Stock_Price:  101.34071051272821
curr_Factors:  [101.34071051  -1.22954021  -1.03547471]
mat_Sqrt:  [[10.52205252  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00179604  0.01954295 -0.04250487]
Stock Position:  0.001796041385113435
Bond Position:  [18.36654357]


portfolio before change:  [18.55047472]
curr_Stock_Price:  101.13084641116282
curr_Factors:  [101.13084641  -1.27806898  -1.01252359]
mat_Sqrt:  [[10.2350962   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309692  0.00362585 -0.15214053]
Stock Position:  -0.0030969174921493046
Bond Position:  [18.86366861]


portfolio before change:  [18.55396667]
curr_Stock_Price:  100.76472544010879
curr_Factors:  [100.76472544  -1.27157682  -1.0010034 ]
mat_Sqrt:  [[10.38339752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101891  0.01347308 -0.18602348]
Stock Position:  -0.0010189129024959032
Bond Position:  [18.65663715]


portfolio before change:  [18.55630029]
curr_Stock_Price:  100.76336093716914
curr_Factors:  [100.76336094  -1.39757707  -0.9773684 ]
mat_Sqrt:  [[ 9.37296367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08181188  0.00366985 -2.39116539]
Stock Position:  -0.08181188073360067
Bond Position:  [26.79994036]


portfolio before change:  [18.58726928]
curr_Stock_Price:  100.4257720036241
curr_Factors:  [100.425772    -1.34672153  -0.99037419]
mat_Sqrt:  [[ 9.70191359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01379314 -0.01532152  0.01286188]
Stock Position:  -0.013793136656043252
Bond Position:  [19.97245567]


portfolio before change:  [18.58362529]
curr_Stock_Price:  100.87097163320921
curr_Factors:  [100.87097163  -1.32728089  -0.99380278]
mat_Sqrt:  [[ 9.90221545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0043679   0.02824526  0.58818472]
Stock Position:  -0.004367902787181427
Bond Position:  [19.02421989]


portfolio before change:  [18.59010033]
curr_Stock_Price:  99.93302392289783
curr_Factors:  [99.93302392 -1.03934778 -0.97712491]
mat_Sqrt:  [[13.30350469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00133855 0.02213101 0.00470163]
Stock Position:  0.0013385543872759533
Bond Position:  [18.45633454]


portfolio before change:  [18.59197057]
curr_Stock_Price:  99.60659353966278
curr_Factors:  [99.60659354 -0.94258442 -0.96518481]
mat_Sqrt:  [[14.78272304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01045478 -0.00293523 -0.41153814]
Stock Position:  -0.010454783431808931
Bond Position:  [19.63333594]


portfolio before change:  [18.59455805]
curr_Stock_Price:  99.59385744850366
curr_Factors:  [99.59385745 -1.01768856 -0.95857938]
mat_Sqrt:  [[13.80226273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00379747  0.0049611   0.16678008]
Stock Position:  -0.0037974718060635533
Bond Position:  [18.97276291]


portfolio before change:  [18.60216277]
curr_Stock_Price:  98.21584111612471
curr_Factors:  [98.21584112 -0.90586386 -0.94235578]
mat_Sqrt:  [[15.47069946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110189  0.00223441  0.17281702]
Stock Position:  -0.0011018857037314062
Bond Position:  [18.7103854]


portfolio before change:  [18.60358318]
curr_Stock_Price:  99.04943719943456
curr_Factors:  [99.0494372  -0.94698982 -0.963034  ]
mat_Sqrt:  [[14.66692959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003291  -0.00266147  0.15460416]
Stock Position:  -0.0003290966718959981
Bond Position:  [18.63618002]


portfolio before change:  [18.6055934]
curr_Stock_Price:  100.02011709403493
curr_Factors:  [100.02011709  -0.91620833  -0.96527733]
mat_Sqrt:  [[15.23942276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037528 -0.00182043 -0.10169118]
Stock Position:  -0.0003752801798416736
Bond Position:  [18.64312897]


portfolio before change:  [18.60758964]
curr_Stock_Price:  100.91093236596504
curr_Factors:  [100.91093237  -0.88086009  -0.95149785]
mat_Sqrt:  [[16.14935842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00514345  0.00865132 -0.00554047]
Stock Position:  -0.005143453001185785
Bond Position:  [19.12662027]


portfolio before change:  [18.61192881]
curr_Stock_Price:  100.53215933248916
curr_Factors:  [100.53215933  -0.71394824  -0.96617203]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.61192881]
Stock Price:  100.10385931047543
PL:  [18.5080695]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.06169212e-01  4.68916328e-02  6.81557329e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.55498466e-01  3.67203306e-01  5.32979730e-01]
 [-3.30015723e-03 -4.41513243e-02  1.02932543e-01]
 [-1.17996895e-01 -4.65729515e-02  4.97700493e-02]
 [ 5.16286549e-02 -1.99938272e-01 -2.67910884e-01]
 [ 7.28312642e-03 -4.45043147e-01 -6.96700119e-02]
 [ 3.99039578e-02  2.27358306e-01  2.35652397e-03]
 [-6.32686417e-02  1.16406107e-02 -3.04677074e-02]
 [ 1.66621372e-01  9.28626886e-02  4.64448306e-01]
 [ 2.25184510e-01 -2.69698016e-01 -4.78464257e-02]
 [-2.48677195e-01 -1.67668292e-01 -3.69673666e-01]
 [ 2.37605510e-01 -3.05239592e-01 -7.63654686e-02]
 [-7.86903425e-02 -1.93072933e-01 -1.34974957e-01]
 [-2.35479858e-01  4.14451614e-01  2.94851223e-01]
 [ 6.99042422e-02 -4.55630297e-01 -1.25310658e-01]
 [ 1.50693238e-01 -2.06134324e-01 -1.13123395e-01]
 [-2.89719111e-01 -1.14307132e-01 -4.66874658e-02]
 [ 1.93504587e-01  1.09685212e+00  1.16348567e-01]
 [-4.84963758e-01 -8.84888770e-02  3.49150623e-01]
 [-9.66608400e-02 -7.09370903e-02 -2.51800608e-02]
 [ 2.07131799e-01 -6.63495855e-02  1.10417563e-01]
 [-4.23734897e-02  1.11361386e-01 -9.96681316e-02]
 [-1.98638922e-01 -6.39637983e-02 -7.38871861e-02]
 [-1.26549268e-01  1.38973275e-01  1.49836789e-01]
 [-2.02280110e-03 -2.69337291e-01 -4.14320718e-01]
 [ 1.62831510e-01  8.80026578e-02  6.62017386e-02]
 [-3.65273900e-01  2.49258045e-02  3.71898170e-01]
 [-8.17340493e-02 -3.03799121e-01 -3.15416005e-01]
 [ 4.65363381e-01 -3.79390855e-01 -2.23769617e-01]
 [ 1.78903747e-01 -2.34436972e-02 -3.81950786e-02]
 [ 6.41779494e-02  3.69696256e-01 -1.41206322e-01]
 [-1.09981238e-01  4.92610487e-02 -3.26074847e-02]
 [ 1.16167321e-01  1.05812236e-01  9.32226598e-02]
 [-4.00912674e-01  1.18693128e-01 -1.17194504e-01]
 [-3.18745028e-01 -4.34942626e-02 -8.45793409e-02]
 [ 4.31340119e-01  2.80588967e-01  6.55268157e-02]
 [-5.02554616e-02  2.41784182e-01  3.44598405e-02]
 [ 1.42838869e-03 -2.01554745e-01  6.28247012e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.79785049]
curr_Stock_Price:  100.47512804719463
curr_Factors:  [100.47512805  -0.79555746  -1.0021915 ]
mat_Sqrt:  [[16.64585527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0054696   0.01482844  0.19442933]
Stock Position:  -0.005469604505982792
Bond Position:  [6.3474097]


portfolio before change:  [5.80336063]
curr_Stock_Price:  99.61278621231992
curr_Factors:  [99.61278621 -0.70210888 -1.00647167]
mat_Sqrt:  [[18.04213721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00251528  0.01411938  0.0859571 ]
Stock Position:  -0.0025152808847024445
Bond Position:  [6.05391477]


portfolio before change:  [5.80664613]
curr_Stock_Price:  98.60744905074378
curr_Factors:  [98.60744905 -0.71627845 -1.01133525]
mat_Sqrt:  [[17.52332944  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02133006 0.11611988 1.52044282]
Stock Position:  0.021330058760782845
Bond Position:  [3.70334344]


portfolio before change:  [5.78840414]
curr_Stock_Price:  97.730520698608
curr_Factors:  [97.7305207  -0.58798847 -1.00925103]
mat_Sqrt:  [[19.78599562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00083751 -0.01396187  0.29363789]
Stock Position:  0.0008375053787120608
Bond Position:  [5.7065543]


portfolio before change:  [5.78995656]
curr_Stock_Price:  98.73236795712734
curr_Factors:  [98.73236796 -0.51978986 -1.00552692]
mat_Sqrt:  [[21.47943695  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00507649 -0.01472766  0.1419801 ]
Stock Position:  -0.00507648941476869
Bond Position:  [6.29117038]


portfolio before change:  [5.79259164]
curr_Stock_Price:  98.36821152685202
curr_Factors:  [98.36821153 -0.37978539 -1.00621921]
mat_Sqrt:  [[24.59917959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.34190382e-04 -6.32260331e-02 -7.64275180e-01]
Stock Position:  -0.0003341903824919964
Bond Position:  [5.82546535]


portfolio before change:  [5.79403178]
curr_Stock_Price:  96.23793792155718
curr_Factors:  [96.23793792 -0.48754953 -0.97878131]
mat_Sqrt:  [[22.20889323  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00082981 -0.140735   -0.19874915]
Stock Position:  -0.0008298103674823163
Bond Position:  [5.87389102]


portfolio before change:  [5.79469786]
curr_Stock_Price:  96.32013625156267
curr_Factors:  [96.32013625 -0.3953851  -0.99090031]
mat_Sqrt:  [[24.0802497   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00192088 0.07189701 0.00672251]
Stock Position:  0.0019208832141820865
Bond Position:  [5.60967812]


portfolio before change:  [5.79614346]
curr_Stock_Price:  96.70763971466802
curr_Factors:  [96.70763971 -0.29321494 -0.98667069]
mat_Sqrt:  [[26.89140637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257284  0.00368108 -0.08691589]
Stock Position:  -0.002572839674160604
Bond Position:  [6.04495671]


portfolio before change:  [5.80080748]
curr_Stock_Price:  95.18855610288195
curr_Factors:  [95.1885561  -0.36311785 -1.01153594]
mat_Sqrt:  [[24.07576981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01095808 0.02936576 1.32494174]
Stock Position:  0.010958079108886529
Bond Position:  [4.75772376]


portfolio before change:  [5.80921027]
curr_Stock_Price:  95.90109260130927
curr_Factors:  [95.9010926  -0.36853721 -1.01030641]
mat_Sqrt:  [[24.1545738   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00863001 -0.085286   -0.13649253]
Stock Position:  0.008630014692893909
Bond Position:  [4.98158243]


portfolio before change:  [5.80626046]
curr_Stock_Price:  95.48712481845452
curr_Factors:  [95.48712482 -0.21715027 -1.01715518]
mat_Sqrt:  [[27.79027015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01181945 -0.05302137 -1.05457607]
Stock Position:  -0.011819449445649563
Bond Position:  [6.9348657]


portfolio before change:  [5.79468753]
curr_Stock_Price:  96.53961396687062
curr_Factors:  [96.53961397 -0.10185893 -1.01891373]
mat_Sqrt:  [[31.47459673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00680346 -0.09652523 -0.21784943]
Stock Position:  0.006803461962501386
Bond Position:  [5.13788394]


portfolio before change:  [5.78733407]
curr_Stock_Price:  95.36436931183273
curr_Factors:  [ 9.53643693e+01 -9.25354317e-02 -1.02185682e+00]
mat_Sqrt:  [[31.29044465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355467 -0.06105502 -0.38504598]
Stock Position:  -0.0035546670269603654
Bond Position:  [6.12632265]


portfolio before change:  [5.78837945]
curr_Stock_Price:  95.28572961369508
curr_Factors:  [95.28572961 -0.29483887 -1.00215454]
mat_Sqrt:  [[26.04658444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00631916  0.13106111  0.84112847]
Stock Position:  -0.006319159041127228
Bond Position:  [6.39050513]


portfolio before change:  [5.78678832]
curr_Stock_Price:  95.66394244165318
curr_Factors:  [95.66394244 -0.46668681 -1.00158086]
mat_Sqrt:  [[22.03371495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147778 -0.14408295 -0.35747643]
Stock Position:  0.0014777801974820994
Bond Position:  [5.64541804]


portfolio before change:  [5.78537098]
curr_Stock_Price:  94.22728485997979
curr_Factors:  [94.22728486 -0.5574466  -1.01859931]
mat_Sqrt:  [[19.48536913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00627546 -0.0651854  -0.32270956]
Stock Position:  0.006275460089041036
Bond Position:  [5.19405141]


portfolio before change:  [5.79297452]
curr_Stock_Price:  95.33544982561814
curr_Factors:  [95.33544983 -0.57589522 -1.04845193]
mat_Sqrt:  [[18.78492296  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0160874  -0.03614709 -0.13318634]
Stock Position:  -0.01608739881138823
Bond Position:  [7.32667392]


portfolio before change:  [5.81494551]
curr_Stock_Price:  94.02665572808529
curr_Factors:  [94.02665573 -0.52882327 -1.09452467]
mat_Sqrt:  [[18.5455593   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0132417  0.3468551  0.33191008]
Stock Position:  0.01324170032473315
Bond Position:  [4.56987271]


portfolio before change:  [5.79663635]
curr_Stock_Price:  92.60082509137771
curr_Factors:  [92.60082509 -0.52906624 -1.06529109]
mat_Sqrt:  [[18.80157643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02212466 -0.02798264  0.99602954]
Stock Position:  -0.022124658528344023
Bond Position:  [7.84539799]


portfolio before change:  [5.80116314]
curr_Stock_Price:  92.4405490432844
curr_Factors:  [92.44054904 -0.28649446 -1.08433571]
mat_Sqrt:  [[23.47029453  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00441547 -0.02243228 -0.0718317 ]
Stock Position:  -0.004415465941175141
Bond Position:  [6.20933124]


portfolio before change:  [5.80010542]
curr_Stock_Price:  92.85589205566093
curr_Factors:  [92.85589206 -0.43726601 -1.07866172]
mat_Sqrt:  [[20.39155838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01117902 -0.02098158  0.31499057]
Stock Position:  0.011179015689744061
Bond Position:  [4.76206795]


portfolio before change:  [5.80055802]
curr_Stock_Price:  92.84312705477925
curr_Factors:  [92.84312705 -0.49769475 -1.06592828]
mat_Sqrt:  [[19.43913371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307847  0.03521556 -0.28432544]
Stock Position:  -0.0030784717142110125
Bond Position:  [6.08637296]


portfolio before change:  [5.80632662]
curr_Stock_Price:  91.21642651059231
curr_Factors:  [91.21642651 -0.27260632 -1.05623232]
mat_Sqrt:  [[24.15270438  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00891712 -0.02022713 -0.21077958]
Stock Position:  -0.00891712230646059
Bond Position:  [6.61971465]


portfolio before change:  [5.8151496]
curr_Stock_Price:  90.31978404393017
curr_Factors:  [90.31978404 -0.28687716 -1.07218364]
mat_Sqrt:  [[23.20332814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00398114  0.04394721  0.42744265]
Stock Position:  -0.003981139551872394
Bond Position:  [6.17472527]


portfolio before change:  [5.81410016]
curr_Stock_Price:  90.7772732939178
curr_Factors:  [90.77727329 -0.28519911 -1.08812588]
mat_Sqrt:  [[22.99056612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00406906 -0.08517193 -1.18194168]
Stock Position:  -0.004069056933762741
Bond Position:  [6.18347806]


portfolio before change:  [5.81785361]
curr_Stock_Price:  90.04480282575786
curr_Factors:  [90.04480283 -0.3866443  -1.06844021]
mat_Sqrt:  [[21.01471362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00849962 0.02782888 0.18885513]
Stock Position:  0.008499621051866475
Bond Position:  [5.05250691]


portfolio before change:  [5.7995393]
curr_Stock_Price:  87.81577297647334
curr_Factors:  [87.81577298 -0.22817259 -1.05591055]
mat_Sqrt:  [[24.31656944  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01187326  0.00788223  1.06092196]
Stock Position:  -0.011873258822330727
Bond Position:  [6.84219871]


portfolio before change:  [5.80303131]
curr_Stock_Price:  87.59370443480915
curr_Factors:  [87.59370443 -0.40936754 -1.05681737]
mat_Sqrt:  [[20.21700777  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00761548 -0.09606972 -0.89979407]
Stock Position:  -0.0076154756910850035
Bond Position:  [6.47009904]


portfolio before change:  [5.80173744]
curr_Stock_Price:  87.86981052210028
curr_Factors:  [87.86981052 -0.45535143 -1.05058035]
mat_Sqrt:  [[19.49044823  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02103034 -0.11997392 -0.63835243]
Stock Position:  0.02103034083314405
Bond Position:  [3.95380538]


portfolio before change:  [5.79948683]
curr_Stock_Price:  87.73929096435289
curr_Factors:  [87.73929096 -0.38465223 -1.08652077]
mat_Sqrt:  [[20.14984935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0084617  -0.00741355 -0.10895993]
Stock Position:  0.008461695785026743
Bond Position:  [5.05706364]


portfolio before change:  [5.79955771]
curr_Stock_Price:  87.67295752320405
curr_Factors:  [87.67295752 -0.6813258  -1.07930177]
mat_Sqrt:  [[15.07421895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00297859  0.11690822 -0.40282233]
Stock Position:  0.0029785852217199126
Bond Position:  [5.53841633]


portfolio before change:  [5.8015643]
curr_Stock_Price:  88.11418935567889
curr_Factors:  [88.11418936 -0.7511493  -1.08207983]
mat_Sqrt:  [[14.0891423   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00818824  0.01557771 -0.09302008]
Stock Position:  -0.008188241386578213
Bond Position:  [6.52306455]


portfolio before change:  [5.81056388]
curr_Stock_Price:  87.11469013580884
curr_Factors:  [87.11469014 -0.56355726 -1.0934255 ]
mat_Sqrt:  [[16.61395108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00830196 0.03346077 0.2659383 ]
Stock Position:  0.008301961169601748
Bond Position:  [5.0873411]


portfolio before change:  [5.81118547]
curr_Stock_Price:  87.11296060685697
curr_Factors:  [87.11296061 -0.65323323 -1.08650114]
mat_Sqrt:  [[15.29416384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0275772   0.03753406 -0.3343233 ]
Stock Position:  -0.027577202816463305
Bond Position:  [8.21351726]


portfolio before change:  [5.810311]
curr_Stock_Price:  87.18190267701156
curr_Factors:  [87.18190268 -0.40104207 -1.07846184]
mat_Sqrt:  [[19.85573445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01697911 -0.01375409 -0.24128132]
Stock Position:  -0.016979111583057087
Bond Position:  [7.29058225]


portfolio before change:  [5.79739793]
curr_Stock_Price:  87.99610600054035
curr_Factors:  [87.996106   -0.64967964 -1.07554294]
mat_Sqrt:  [[15.67504535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02883312 0.08873002 0.18692977]
Stock Position:  0.028833122341553
Bond Position:  [3.26019544]


portfolio before change:  [5.79953481]
curr_Stock_Price:  88.056083347604
curr_Factors:  [88.05608335 -0.59664024 -1.05973324]
mat_Sqrt:  [[16.80372243  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220062  0.07645887  0.09830433]
Stock Position:  -0.002200615698976139
Bond Position:  [5.99331241]


portfolio before change:  [5.79904551]
curr_Stock_Price:  88.61888773097512
curr_Factors:  [88.61888773 -0.90387269 -1.05985134]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.79904551]
Stock Price:  88.92642450572568
PL:  [5.79904551]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.09313387e-02 -1.46175970e-02  1.64622664e-03]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 1.96346221e-01 -3.28338046e-01 -5.39916957e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.18694003e+00 -3.49363596e-01  2.36478252e-02]
 [-6.45573633e-02  1.94623570e-02  6.12529480e-02]
 [ 9.80519858e-03  1.38616385e-01  5.43988728e-02]
 [ 3.71057570e-01  1.50805476e-02 -1.01128428e-01]
 [-4.94614131e-01 -2.92756407e-02 -5.00902725e-02]
 [ 1.30788861e-02  4.10122559e-02 -1.40842812e-02]
 [-3.19108720e-02 -1.74534846e-01  1.11169622e-01]
 [-9.77694668e-02  1.01440542e-02  6.70955622e-02]
 [ 1.28889844e-01 -4.12166238e-02  2.88688103e-01]
 [ 3.83588721e-02  2.71797633e-01  2.23505884e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-1.44854500e-02 -1.09461134e-02  3.56675775e-02]
 [-5.76347975e-01 -2.82962315e-01  1.70568420e-01]
 [-1.26755179e-01  1.84057784e-02 -2.08183017e-02]
 [ 3.20882986e-01  1.25078700e+00  5.33179742e-01]
 [ 1.24542248e-02  8.61531060e-03  3.09728843e-02]
 [-6.33107555e-02 -5.33832073e-02 -3.50695817e-02]
 [-1.68704290e-02  4.53719347e-02 -1.53310504e-02]
 [ 5.64635490e-02 -3.44601552e-02  7.58057787e-02]
 [ 4.81776217e-02  1.44855119e-01  8.55112599e-02]
 [-5.87169091e-02 -1.47074157e-01  2.67551232e-02]
 [ 4.47858359e-02  4.54858409e-02 -1.35409214e-02]
 [ 1.85775969e-02 -5.72695132e-02  2.94892543e-02]
 [ 1.21294598e-02  4.25092608e-02 -6.95010674e-02]
 [-6.13680968e-01  2.22140322e-03 -8.72265866e-01]
 [-6.77599397e-02 -1.18830203e-01 -2.44983747e-03]
 [-9.02798921e-02  9.22946337e-02  2.11615573e-01]
 [ 1.91969099e-02  9.25551958e-02 -9.13819310e-03]
 [-1.25107611e-01 -9.42124286e-03 -1.44100165e-01]
 [-6.14004600e-02  9.59506047e-02  1.09366430e-01]
 [ 3.39311631e-02 -4.11136047e-02  2.14266289e-02]
 [-4.65446508e-02 -1.98224412e-02  2.49071204e-02]
 [ 6.26696498e-02  4.80168662e-02  2.32351317e-04]
 [-1.21254848e-01  1.91793880e-01  4.98377315e-03]
 [ 1.86243008e-03 -2.28170944e-01  7.53999893e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.66836052]
curr_Stock_Price:  100.1784262828429
curr_Factors:  [100.17842628  -1.07050143  -1.01266287]
mat_Sqrt:  [[12.47577248  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00729195 -0.00462249  0.00469623]
Stock Position:  -0.0072919515800206405
Bond Position:  [4.39885676]


portfolio before change:  [3.66954232]
curr_Stock_Price:  100.0917676762206
curr_Factors:  [100.09176768  -1.36131573  -1.02271848]
mat_Sqrt:  [[ 9.22625506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00491869  0.01411938  0.0859571 ]
Stock Position:  -0.00491868505120788
Bond Position:  [4.16186221]


portfolio before change:  [3.66486481]
curr_Stock_Price:  101.1485100348152
curr_Factors:  [101.14851003  -1.52803571  -1.01272421]
mat_Sqrt:  [[ 7.97115907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00974243 -0.10382961 -1.54023279]
Stock Position:  0.009742432871485261
Bond Position:  [2.67943224]


portfolio before change:  [3.66779566]
curr_Stock_Price:  101.41496331812318
curr_Factors:  [101.41496332  -1.43053222  -1.01218166]
mat_Sqrt:  [[ 8.81545797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00223506 -0.00659539  0.21422481]
Stock Position:  0.0022350573244838095
Bond Position:  [3.4411274]


portfolio before change:  [3.66752345]
curr_Stock_Price:  101.10071046391029
curr_Factors:  [101.10071046  -1.40244594  -1.01717221]
mat_Sqrt:  [[ 8.99347215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.13244423 -0.11047847  0.06746066]
Stock Position:  -0.13244422653166113
Bond Position:  [17.05772885]


portfolio before change:  [3.68123357]
curr_Stock_Price:  101.01329433045099
curr_Factors:  [101.01329433  -1.46338779  -1.02566072]
mat_Sqrt:  [[ 8.38298134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00614956  0.00615454  0.17473761]
Stock Position:  -0.006149559412404158
Bond Position:  [4.30242082]


portfolio before change:  [3.6775168]
curr_Stock_Price:  101.70514916004485
curr_Factors:  [101.70514916  -1.5535045   -1.02966504]
mat_Sqrt:  [[ 7.68221865  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00318767 0.04383435 0.15518484]
Stock Position:  0.0031876704890197705
Bond Position:  [3.3533143]


portfolio before change:  [3.67657565]
curr_Stock_Price:  101.27839715195135
curr_Factors:  [101.27839715  -1.41916395  -1.00063339]
mat_Sqrt:  [[ 9.00766418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03894508  0.00476889 -0.28849126]
Stock Position:  0.03894507912308883
Bond Position:  [-0.26771955]


portfolio before change:  [3.66244437]
curr_Stock_Price:  100.91640520989252
curr_Factors:  [100.91640521  -1.43730129  -0.97636043]
mat_Sqrt:  [[ 9.0307081   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05598616 -0.00925777 -0.14289361]
Stock Position:  -0.055986158856938015
Bond Position:  [9.31236627]


portfolio before change:  [3.63039227]
curr_Stock_Price:  101.50969863237201
curr_Factors:  [101.50969863  -1.73486111  -0.99483356]
mat_Sqrt:  [[ 6.62241215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00170072  0.01296921 -0.04017853]
Stock Position:  0.0017007211085703197
Bond Position:  [3.45775259]


portfolio before change:  [3.63174902]
curr_Stock_Price:  102.05329229710678
curr_Factors:  [102.0532923   -1.50729922  -0.99355484]
mat_Sqrt:  [[ 8.36989294  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016398  -0.05519276  0.31713599]
Stock Position:  -0.0016397985560572088
Bond Position:  [3.79909586]


portfolio before change:  [3.63137223]
curr_Stock_Price:  102.5726902670271
curr_Factors:  [102.57269027  -1.59242822  -1.00226756]
mat_Sqrt:  [[ 7.65895794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01094297  0.00320783  0.19140496]
Stock Position:  -0.010942967020531229
Bond Position:  [4.7538218]


portfolio before change:  [3.63492401]
curr_Stock_Price:  102.30242409907017
curr_Factors:  [102.3024241   -1.73746703  -1.01813929]
mat_Sqrt:  [[ 6.50341255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02871628 -0.01303384  0.8235468 ]
Stock Position:  0.028716284934720015
Bond Position:  [0.69717845]


portfolio before change:  [3.63007332]
curr_Stock_Price:  102.1304716190853
curr_Factors:  [102.13047162  -1.44490316  -1.04084544]
mat_Sqrt:  [[ 8.50370992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01070117 0.08594996 0.63760008]
Stock Position:  0.01070116517149902
Bond Position:  [2.53715828]


portfolio before change:  [3.63114462]
curr_Stock_Price:  102.20094361580459
curr_Factors:  [102.20094362  -1.55801618  -1.02547658]
mat_Sqrt:  [[ 7.71717339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00556242 -0.03587186 -0.12433753]
Stock Position:  0.005562416632346374
Bond Position:  [3.06266039]


portfolio before change:  [3.63206466]
curr_Stock_Price:  102.29751737927758
curr_Factors:  [102.29751738  -1.66462784  -1.03566911]
mat_Sqrt:  [[ 6.87291584  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108942 -0.00346146  0.10174967]
Stock Position:  -0.0010894158803108557
Bond Position:  [3.7435092]


portfolio before change:  [3.63279751]
curr_Stock_Price:  102.05437234507933
curr_Factors:  [102.05437235  -1.64827877  -1.04006438]
mat_Sqrt:  [[ 6.93903407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07909413 -0.08948054  0.48658423]
Stock Position:  -0.07909413493010033
Bond Position:  [11.70469981]


portfolio before change:  [3.66967291]
curr_Stock_Price:  101.6066499853568
curr_Factors:  [101.60664999  -1.39855997  -0.98848563]
mat_Sqrt:  [[ 9.33773188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01397871  0.00582042 -0.05938882]
Stock Position:  -0.013978711671298414
Bond Position:  [5.09000297]


portfolio before change:  [3.67558102]
curr_Stock_Price:  101.22951779138425
curr_Factors:  [101.22951779  -1.35558935  -0.99651802]
mat_Sqrt:  [[ 9.63385086  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04795725 0.39553358 1.5210134 ]
Stock Position:  0.04795725343029471
Bond Position:  [-1.17910862]


portfolio before change:  [3.6552961]
curr_Stock_Price:  100.80961211318586
curr_Factors:  [100.80961211  -1.31734789  -0.99736782]
mat_Sqrt:  [[ 9.95941163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00190764 0.0027244  0.08835702]
Stock Position:  0.0019076412749055441
Bond Position:  [3.46298752]


portfolio before change:  [3.65606736]
curr_Stock_Price:  100.98698279132704
curr_Factors:  [100.98698279  -1.16009801  -1.00137337]
mat_Sqrt:  [[11.62921244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0061782  -0.01688125 -0.10004376]
Stock Position:  -0.006178204481376329
Bond Position:  [4.27998559]


portfolio before change:  [3.65803419]
curr_Stock_Price:  100.75523195754184
curr_Factors:  [100.75523196  -1.15721888  -1.00319674]
mat_Sqrt:  [[11.61478095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162107  0.01434787 -0.04373522]
Stock Position:  -0.0016210695936303735
Bond Position:  [3.82136544]


portfolio before change:  [3.65800486]
curr_Stock_Price:  101.06801064219002
curr_Factors:  [101.06801064  -1.14191283  -1.02224624]
mat_Sqrt:  [[11.60730436  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00612094 -0.01089726  0.21625279]
Stock Position:  0.00612093722636577
Bond Position:  [3.03937391]


portfolio before change:  [3.65492551]
curr_Stock_Price:  100.50285239963121
curr_Factors:  [100.5028524   -1.26883245  -0.99109812]
mat_Sqrt:  [[10.48824955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00661432 0.04580721 0.24393982]
Stock Position:  0.006614323702464599
Bond Position:  [2.99016711]


portfolio before change:  [3.65855305]
curr_Stock_Price:  100.99477669367698
curr_Factors:  [100.99477669  -1.20240727  -0.9900014 ]
mat_Sqrt:  [[11.27581463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00505977 -0.04650893  0.07632492]
Stock Position:  -0.005059765767910445
Bond Position:  [4.16956296]


portfolio before change:  [3.66014732]
curr_Stock_Price:  100.78270297460178
curr_Factors:  [100.78270297  -1.07786543  -0.97250519]
mat_Sqrt:  [[12.96944395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00333062  0.01438389 -0.03862848]
Stock Position:  0.003330616675855593
Bond Position:  [3.32447877]


portfolio before change:  [3.65814316]
curr_Stock_Price:  100.05618718026255
curr_Factors:  [100.05618718  -0.81766052  -0.98753899]
mat_Sqrt:  [[16.45340412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140508 -0.01811021  0.08412463]
Stock Position:  0.0014050814701672737
Bond Position:  [3.51755606]


portfolio before change:  [3.65905737]
curr_Stock_Price:  100.39388321242461
curr_Factors:  [100.39388321  -0.78308672  -0.99127918]
mat_Sqrt:  [[17.02589427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.63730605e-05  1.34426086e-02 -1.98267200e-01]
Stock Position:  -5.6373060543245355e-05
Bond Position:  [3.66471688]


portfolio before change:  [3.65953832]
curr_Stock_Price:  99.98882125446752
curr_Factors:  [99.98882125 -0.91563749 -1.01092887]
mat_Sqrt:  [[14.56311589  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.43615901e-02  7.02469377e-04 -2.48833172e+00]
Stock Position:  -0.05436159005285092
Bond Position:  [9.09508963]


portfolio before change:  [3.68514338]
curr_Stock_Price:  99.53872225852739
curr_Factors:  [99.53872226 -1.20796471 -0.99948921]
mat_Sqrt:  [[10.94729966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0065156  -0.03757741 -0.0069887 ]
Stock Position:  -0.006515597051826475
Bond Position:  [4.33369758]


portfolio before change:  [3.68715873]
curr_Stock_Price:  99.31255692641244
curr_Factors:  [99.31255693 -1.29564737 -1.00991656]
mat_Sqrt:  [[ 9.90171609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00451447  0.02918613  0.60368033]
Stock Position:  -0.004514470678280461
Bond Position:  [4.13550235]


portfolio before change:  [3.68862114]
curr_Stock_Price:  99.10313228438133
curr_Factors:  [99.10313228 -0.97597319 -0.97901963]
mat_Sqrt:  [[14.02958375  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0014057   0.02926852 -0.02606872]
Stock Position:  0.0014056973682285076
Bond Position:  [3.54931212]


portfolio before change:  [3.68921655]
curr_Stock_Price:  99.21106421321136
curr_Factors:  [99.21106421 -0.93170005 -1.00565828]
mat_Sqrt:  [[14.29473394  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01082673 -0.00297926 -0.41107766]
Stock Position:  -0.010826727545086736
Bond Position:  [4.76334771]


portfolio before change:  [3.69893026]
curr_Stock_Price:  98.36886504524969
curr_Factors:  [98.36886505 -0.98367435 -0.99116675]
mat_Sqrt:  [[13.65196194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268084  0.03034225  0.31199198]
Stock Position:  -0.0026808379029540563
Bond Position:  [3.96264125]


portfolio before change:  [3.69850413]
curr_Stock_Price:  98.71259793929192
curr_Factors:  [98.71259794 -1.15290847 -1.01039472]
mat_Sqrt:  [[11.34650077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00328236 -0.01300126  0.06112421]
Stock Position:  0.0032823605624830057
Bond Position:  [3.3744938]


portfolio before change:  [3.69557522]
curr_Stock_Price:  97.69176056532262
curr_Factors:  [97.69176057 -1.24310359 -1.00298222]
mat_Sqrt:  [[10.33701773  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00406039 -0.00626841  0.07105308]
Stock Position:  -0.004060389613071636
Bond Position:  [4.09224183]


portfolio before change:  [3.69642939]
curr_Stock_Price:  97.60738046684203
curr_Factors:  [97.60738047 -1.17376351 -1.01855362]
mat_Sqrt:  [[10.89861785  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00586835 0.01518427 0.00066283]
Stock Position:  0.0058683467352675985
Bond Position:  [3.12363544]


portfolio before change:  [3.69371348]
curr_Stock_Price:  97.07803300248182
curr_Factors:  [97.078033   -1.00163277 -1.00984868]
mat_Sqrt:  [[12.98810144  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00887624  0.06065055  0.01421732]
Stock Position:  -0.008876235179972842
Bond Position:  [4.55540093]


portfolio before change:  [3.70136727]
curr_Stock_Price:  96.279909641876
curr_Factors:  [96.27990964 -0.75898054 -1.04029363]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.70136727]
Stock Price:  96.47631869600984
PL:  [3.70136727]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-7.01454561e-02 -1.91737904e-03 -7.68750755e-03]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.49280812e-01 -8.75680746e-02 -1.88766961e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.23526534e+00 -3.49887056e-01 -5.00955153e-02]
 [-8.11752381e-02  4.43687677e-02  9.48097227e-02]
 [ 1.13888297e-02  1.35413883e-01  5.62119396e-02]
 [ 2.96899434e-01 -9.55937430e-02 -6.21225688e-02]
 [-5.24825106e-01 -2.80552947e-02 -6.86692604e-02]
 [ 1.12975031e-02  4.40386340e-02 -1.26661384e-02]
 [-1.89554653e-02 -2.14736846e-01  1.48547214e-01]
 [-1.46374304e-01  2.00815823e-02  1.14823164e-01]
 [ 4.18838282e-02 -2.64962736e-03  2.23217779e-01]
 [ 3.37372518e-03  5.29951573e-01  4.82460963e-01]
 [ 8.08184149e-02 -1.19141130e-01 -5.00850831e-02]
 [-9.54815415e-03 -2.32351758e-02  3.37590569e-02]
 [-5.59324385e-01 -2.30639181e-01  1.58521376e-01]
 [-1.16997852e-01  1.90396690e-02 -2.89419374e-02]
 [ 4.10899118e-02  6.16387847e-01  1.08658893e-01]
 [-3.15333253e-02  5.41106384e-02  2.46341007e-02]
 [ 8.99854362e-02 -1.40603635e-01  1.41958600e-01]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 2.48918838e-01  7.28024070e-03  2.29892172e-01]
 [ 6.79414855e-02 -1.65514148e-01 -5.87848549e-02]
 [-1.20709575e-01  2.21918209e-01  1.83050295e-01]
 [ 1.29663587e-02  6.14462572e-02  2.86151913e-02]
 [-1.19543627e-01 -1.24105110e-01  2.35004881e-01]
 [ 8.40784913e-02  6.98943397e-02 -8.38808491e-02]
 [-7.60708492e-01 -1.35763789e-01 -1.10969792e+00]
 [-3.25095034e-02 -5.62513654e-02  8.73668540e-02]
 [-7.01193880e-02 -7.19644430e-02  1.20849753e-01]
 [ 2.50307097e-02  1.03253362e-01 -5.50362758e-03]
 [-1.18356099e-01 -8.82718465e-03 -5.97335130e-02]
 [-6.18403724e-02  8.54174880e-02  1.02686244e-01]
 [ 1.54009644e-01 -1.60276746e-01 -1.02571023e-01]
 [-2.43710864e-02  2.42595603e-01  8.31259663e-02]
 [ 3.48156910e-02  3.43410608e-02 -4.11632328e-02]
 [-6.23791044e-02  9.78033606e-02 -6.08057582e-03]
 [-5.52979389e-02 -2.34944162e-01  1.02450360e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.95768835]
curr_Stock_Price:  100.91538814832812
curr_Factors:  [100.91538815  -1.16584358  -0.97764875]
mat_Sqrt:  [[11.83179132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00606537 -0.00060633 -0.02193032]
Stock Position:  -0.006065368009888904
Bond Position:  [9.56977732]


portfolio before change:  [8.96453838]
curr_Stock_Price:  99.98325444139266
curr_Factors:  [99.98325444 -1.18095801 -0.97830756]
mat_Sqrt:  [[11.53905249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393282  0.01411938  0.0859571 ]
Stock Position:  -0.003932822290461953
Bond Position:  [9.35775475]


portfolio before change:  [8.96214478]
curr_Stock_Price:  100.88931980233872
curr_Factors:  [100.8893198   -1.15550886  -1.01658984]
mat_Sqrt:  [[11.49515195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01813703 -0.02769146 -0.5384996 ]
Stock Position:  0.01813703035268622
Bond Position:  [7.13231212]


portfolio before change:  [8.98475051]
curr_Stock_Price:  102.08654663496941
curr_Factors:  [102.08654663  -1.30945366  -1.01556711]
mat_Sqrt:  [[ 9.98216679  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197383 -0.00659539  0.21422481]
Stock Position:  0.0019738253543616574
Bond Position:  [8.7832495]


portfolio before change:  [8.98612654]
curr_Stock_Price:  102.22741683130482
curr_Factors:  [102.22741683  -1.27121026  -1.01691113]
mat_Sqrt:  [[10.37167492  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12095685 -0.110644   -0.14290856]
Stock Position:  -0.12095684621792138
Bond Position:  [21.35123248]


portfolio before change:  [9.04182572]
curr_Stock_Price:  101.78899513392244
curr_Factors:  [101.78899513  -1.41655273  -1.01921996]
mat_Sqrt:  [[ 8.90959961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00681026  0.01403064  0.27046575]
Stock Position:  -0.006810259782178729
Bond Position:  [9.73503522]


portfolio before change:  [9.04286045]
curr_Stock_Price:  101.81575199028094
curr_Factors:  [101.81575199  -1.19683391  -1.0151008 ]
mat_Sqrt:  [[11.14766562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00236457 0.04282163 0.16035702]
Stock Position:  0.0023645681646626083
Bond Position:  [8.80211017]


portfolio before change:  [9.04503174]
curr_Stock_Price:  102.2686706034617
curr_Factors:  [102.2686706   -0.88092961  -0.98997144]
mat_Sqrt:  [[15.74782601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01789139 -0.0302294  -0.1772184 ]
Stock Position:  0.01789139005242946
Bond Position:  [7.21530307]


portfolio before change:  [9.04594896]
curr_Stock_Price:  102.26952284510443
curr_Factors:  [102.26952285  -0.91613671  -0.96643352]
mat_Sqrt:  [[15.56525941  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0346648  -0.00887186 -0.19589429]
Stock Position:  -0.03466479615127787
Bond Position:  [12.59110112]


portfolio before change:  [9.02353165]
curr_Stock_Price:  102.9616167027758
curr_Factors:  [102.9616167   -0.99507929  -0.94775476]
mat_Sqrt:  [[14.75411784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00066755  0.01392624 -0.03613297]
Stock Position:  0.0006675499814016555
Bond Position:  [8.95479963]


portfolio before change:  [9.02468789]
curr_Stock_Price:  103.0167680653947
curr_Factors:  [103.01676807  -1.17094037  -0.95059989]
mat_Sqrt:  [[12.34623931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047157 -0.06790575  0.42376385]
Stock Position:  0.00047157082294727905
Bond Position:  [8.97610819]


portfolio before change:  [9.02593928]
curr_Stock_Price:  103.29097071866823
curr_Factors:  [103.29097072  -1.27409424  -0.95627497]
mat_Sqrt:  [[11.10261593  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01102602  0.00635035  0.32755853]
Stock Position:  -0.01102601584840852
Bond Position:  [10.16482716]


portfolio before change:  [9.0170686]
curr_Stock_Price:  104.21073761953335
curr_Factors:  [104.21073762  -1.09517261  -0.98583797]
mat_Sqrt:  [[13.00591939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00671844 -0.00083789  0.63677819]
Stock Position:  0.006718444948599749
Bond Position:  [8.31693449]


portfolio before change:  [9.01745257]
curr_Stock_Price:  104.11313899777129
curr_Factors:  [104.113139    -1.12076564  -0.99214364]
mat_Sqrt:  [[12.58579631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00918011 0.1675854  1.37632684]
Stock Position:  0.009180106266482121
Bond Position:  [8.06168289]


portfolio before change:  [9.03180117]
curr_Stock_Price:  105.56637184399919
curr_Factors:  [105.56637184  -1.1807579   -0.977995  ]
mat_Sqrt:  [[12.18964685  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00553901 -0.03767573 -0.1428788 ]
Stock Position:  0.005539014395253949
Bond Position:  [8.44706752]


portfolio before change:  [9.03339805]
curr_Stock_Price:  105.66402930179422
curr_Factors:  [105.6640293   -1.11431782  -1.00613306]
mat_Sqrt:  [[12.67730832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025692 -0.00734761  0.09630519]
Stock Position:  -0.0002569192995531375
Bond Position:  [9.06054518]


portfolio before change:  [9.03449013]
curr_Stock_Price:  105.8219045949459
curr_Factors:  [105.82190459  -1.02392585  -1.01280622]
mat_Sqrt:  [[13.80492578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03860372 -0.07293451  0.45221736]
Stock Position:  -0.03860371519679783
Bond Position:  [13.11960879]


portfolio before change:  [9.04072744]
curr_Stock_Price:  105.70281617331477
curr_Factors:  [105.70281617  -1.29958084  -1.01486225]
mat_Sqrt:  [[10.44567951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0117191   0.00602087 -0.08256329]
Stock Position:  -0.011719103385700997
Bond Position:  [10.27946967]


portfolio before change:  [9.03262534]
curr_Stock_Price:  106.50382518198302
curr_Factors:  [106.50382518  -1.00991374  -1.02840963]
mat_Sqrt:  [[13.87179355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00570834 0.19491895 0.30997358]
Stock Position:  0.005708337647912259
Bond Position:  [8.42466555]


portfolio before change:  [9.02975681]
curr_Stock_Price:  105.81681651308743
curr_Factors:  [105.81681651  -0.97534412  -1.05739753]
mat_Sqrt:  [[13.85945681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018116   0.01711129  0.07027423]
Stock Position:  -0.001811599132372706
Bond Position:  [9.22145447]


portfolio before change:  [9.0310247]
curr_Stock_Price:  105.75326603632433
curr_Factors:  [105.75326604  -1.18758896  -1.07224355]
mat_Sqrt:  [[11.03725299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01044936 -0.04446277  0.40496837]
Stock Position:  0.010449361259512433
Bond Position:  [7.92597061]


portfolio before change:  [9.03583955]
curr_Stock_Price:  106.11922627439164
curr_Factors:  [106.11922627  -1.16998002  -1.07195406]
mat_Sqrt:  [[11.27546528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344721  0.01916992 -0.08961985]
Stock Position:  -0.003447207074994071
Bond Position:  [9.4016545]


portfolio before change:  [9.03578371]
curr_Stock_Price:  106.47636427628785
curr_Factors:  [106.47636428  -1.2027455   -1.08466858]
mat_Sqrt:  [[10.81040349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02738412 0.00230221 0.65581838]
Stock Position:  0.027384117166651258
Bond Position:  [6.12002247]


portfolio before change:  [9.04540037]
curr_Stock_Price:  106.79960323080444
curr_Factors:  [106.79960323  -0.81635426  -1.09210108]
mat_Sqrt:  [[15.83937406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00326203 -0.05234017 -0.16769683]
Stock Position:  0.003262030437040972
Bond Position:  [8.69701681]


portfolio before change:  [9.0416342]
curr_Stock_Price:  105.31176622369674
curr_Factors:  [105.31176622  -0.66436584  -1.05316611]
mat_Sqrt:  [[18.90437155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00410565  0.0701767   0.52219154]
Stock Position:  -0.004105647526360003
Bond Position:  [9.47400719]


portfolio before change:  [9.04143504]
curr_Stock_Price:  105.64873527946969
curr_Factors:  [105.64873528  -0.8240273   -1.04600517]
mat_Sqrt:  [[16.28244128  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00125251 0.01943101 0.08163118]
Stock Position:  0.0012525115446847077
Bond Position:  [8.90910878]


portfolio before change:  [9.04193809]
curr_Stock_Price:  105.16118210889304
curr_Factors:  [105.16118211  -1.16378753  -1.03298128]
mat_Sqrt:  [[11.68990249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00639679 -0.03924548  0.67040351]
Stock Position:  -0.006396788747950152
Bond Position:  [9.71463195]


portfolio before change:  [9.0421781]
curr_Stock_Price:  105.3135072321872
curr_Factors:  [105.31350723  -0.91915353  -1.02805886]
mat_Sqrt:  [[15.02520764  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00457638  0.02210253 -0.23928871]
Stock Position:  0.004576379270475705
Bond Position:  [8.56022355]


portfolio before change:  [9.04767334]
curr_Stock_Price:  106.28046115744802
curr_Factors:  [106.28046116  -0.86775793  -1.04052872]
mat_Sqrt:  [[15.76503968  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06284349 -0.04293228 -3.16565927]
Stock Position:  -0.06284348516092142
Bond Position:  [15.72670793]


portfolio before change:  [9.08968579]
curr_Stock_Price:  105.64321950310197
curr_Factors:  [105.6432195   -0.82251195  -1.03848918]
mat_Sqrt:  [[16.42930168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098167 -0.01778824  0.24923332]
Stock Position:  -0.0009816742850991642
Bond Position:  [9.19339302]


portfolio before change:  [9.09121678]
curr_Stock_Price:  105.25435500590253
curr_Factors:  [105.25435501  -0.97876053  -1.04213503]
mat_Sqrt:  [[13.95006671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339132 -0.02275716  0.34475071]
Stock Position:  -0.003391320655054902
Bond Position:  [9.44816804]


portfolio before change:  [9.09214023]
curr_Stock_Price:  105.3303256626591
curr_Factors:  [105.33032566  -0.9510777   -1.05793757]
mat_Sqrt:  [[14.12697506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00188103  0.03265158 -0.01570032]
Stock Position:  0.0018810309094811392
Bond Position:  [8.89401063]


portfolio before change:  [9.09274321]
curr_Stock_Price:  105.05981547086203
curr_Factors:  [105.05981547  -1.0526018   -1.03789625]
mat_Sqrt:  [[12.98807739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01006901 -0.0027914  -0.17040309]
Stock Position:  -0.01006900898394665
Bond Position:  [10.15059144]


portfolio before change:  [9.09771404]
curr_Stock_Price:  104.69215997393646
curr_Factors:  [104.69215997  -1.10675487  -1.01047027]
mat_Sqrt:  [[12.60128871  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306906  0.02701138  0.29293527]
Stock Position:  -0.003069063930748316
Bond Position:  [9.41902097]


portfolio before change:  [9.09775337]
curr_Stock_Price:  105.0629961429888
curr_Factors:  [105.06299614  -0.93643488  -1.00383634]
mat_Sqrt:  [[15.09387318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00854215 -0.05068396 -0.29260658]
Stock Position:  0.008542147654891322
Bond Position:  [8.20028975]


portfolio before change:  [9.09945287]
curr_Stock_Price:  105.14194503371243
curr_Factors:  [105.14194503  -0.83974093  -0.98369088]
mat_Sqrt:  [[16.97733955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.71058059e-05  7.67154656e-02  2.37135244e-01]
Stock Position:  -6.71058059444378e-05
Bond Position:  [9.1065085]


portfolio before change:  [9.10064369]
curr_Stock_Price:  104.36046691144661
curr_Factors:  [104.36046691  -1.13136425  -0.94037801]
mat_Sqrt:  [[13.14588351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00207669  0.0108596  -0.11742725]
Stock Position:  0.002076692954130814
Bond Position:  [8.88391905]


portfolio before change:  [9.09848849]
curr_Stock_Price:  102.78789064791815
curr_Factors:  [102.78789065  -0.89778491  -0.92217107]
mat_Sqrt:  [[16.65501827  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366827  0.03092814 -0.01734619]
Stock Position:  -0.0036682652554013637
Bond Position:  [9.47554174]


portfolio before change:  [9.1011459]
curr_Stock_Price:  102.3863678719841
curr_Factors:  [102.38636787  -0.90169015  -0.91262192]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.1011459]
Stock Price:  102.36987081019055
PL:  [6.73127509]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [ 3.69041370e-02  8.06857435e-02 -4.85562705e-02]
 [-7.17107315e-02  8.50570598e-02  1.41202107e-01]
 [ 2.97937179e-01 -2.35987722e-01 -4.50088668e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.37822196e+00 -3.79084578e-01 -1.15852114e-01]
 [-5.02465099e-02  4.82063039e-02  7.60140059e-02]
 [-1.82691764e-02  2.02991597e-01  1.36184604e-01]
 [ 3.78811788e-01  4.76213222e-03 -1.03016480e-01]
 [-5.46373900e-01 -3.03659773e-02 -6.85269173e-02]
 [ 1.81859013e-03  6.01422881e-02 -5.12006213e-03]
 [-2.39710157e-02 -1.96274548e-01  1.23975353e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.25993100e-01 -3.84022172e-02  2.86505820e-01]
 [ 6.45549136e-02  1.52969244e-01  1.09581905e-01]
 [ 7.50036201e-02 -1.08016002e-01 -6.41482533e-02]
 [-3.69301012e-02 -4.52195552e-02  1.24025701e-02]
 [-4.82139754e-01 -2.77808877e-01  1.34321958e-01]
 [-1.62034796e-01  6.50350924e-03 -2.43321433e-02]
 [ 3.30285809e-01  1.33195161e+00  5.21450243e-01]
 [-2.42579924e-02 -2.91057201e-03  4.95464542e-02]
 [-5.35387115e-02 -7.98854413e-02 -1.77480264e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 7.54882853e-02 -3.51644433e-02  9.78771585e-02]
 [ 8.01282683e-02  3.56007015e-02 -1.39138895e-02]
 [-5.97514504e-02 -1.45366343e-01  4.36731595e-02]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [ 1.55634372e-02 -6.96627095e-02 -1.31339908e-02]
 [ 2.66833328e-02  4.95510165e-02 -8.32568316e-02]
 [-6.01385090e-01 -5.08371674e-02 -9.03422044e-01]
 [-2.30474661e-01  7.50078778e-02 -2.57719677e-04]
 [-3.28003497e-02  3.94664475e-02  1.20394175e-01]
 [ 4.33594406e-03  6.14514136e-03  4.11716485e-02]
 [-1.09538258e-01 -2.08648220e-04 -1.54257646e-01]
 [-7.24013301e-02 -1.67450567e-01 -5.76846875e-02]
 [ 2.14933932e-01 -1.70814593e-01 -7.69797033e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-1.67281932e-02 -1.83771775e-02 -4.78251956e-02]
 [-9.29607404e-02 -1.37382135e-03  6.22380816e-04]
 [-4.61353928e-02 -2.88997168e-01  1.40232302e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.56151418]
curr_Stock_Price:  101.41750907767756
curr_Factors:  [101.41750908  -1.39989126  -1.01950409]
mat_Sqrt:  [[ 9.02366346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00322219  0.02551507 -0.13851752]
Stock Position:  0.0032221865166527637
Bond Position:  [12.23472805]


portfolio before change:  [12.56572248]
curr_Stock_Price:  102.24889158841256
curr_Factors:  [102.24889159  -1.23843427  -1.01043924]
mat_Sqrt:  [[10.78910081  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377157  0.0268974   0.40281031]
Stock Position:  -0.0037715662211130515
Bond Position:  [12.95136095]


portfolio before change:  [12.56976524]
curr_Stock_Price:  101.60625725384773
curr_Factors:  [101.60625725  -1.11819114  -0.98661008]
mat_Sqrt:  [[12.38274417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01614909 -0.07462587 -1.28397769]
Stock Position:  0.01614908896777461
Bond Position:  [10.92891676]


portfolio before change:  [12.57811373]
curr_Stock_Price:  102.03862117276444
curr_Factors:  [102.03862117  -0.96288916  -1.01898512]
mat_Sqrt:  [[14.06201371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140115 -0.00659539  0.21422481]
Stock Position:  0.0014011545082602051
Bond Position:  [12.43514185]


portfolio before change:  [12.58082833]
curr_Stock_Price:  102.8665887766427
curr_Factors:  [102.86658878  -1.3773036   -1.03913619]
mat_Sqrt:  [[ 9.17968695  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.15378064 -0.11987707 -0.33049384]
Stock Position:  -0.15378063610818965
Bond Position:  [28.39971778]


portfolio before change:  [12.60417918]
curr_Stock_Price:  102.73782962286839
curr_Factors:  [102.73782962  -1.25222559  -1.02278932]
mat_Sqrt:  [[10.56097378  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317069  0.01524417  0.2168468 ]
Stock Position:  -0.003170686263734629
Bond Position:  [12.9299286]


portfolio before change:  [12.60332001]
curr_Stock_Price:  103.51857763780234
curr_Factors:  [103.51857764  -1.39063666  -1.03420581]
mat_Sqrt:  [[ 9.16057192  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00161241 0.06419158 0.38849677]
Stock Position:  0.0016124113303658866
Bond Position:  [12.43640549]


portfolio before change:  [12.60310862]
curr_Stock_Price:  102.42329656355095
curr_Factors:  [102.42329656  -1.45323478  -1.04049852]
mat_Sqrt:  [[ 8.46026835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0423044   0.00150592 -0.29387734]
Stock Position:  0.04230440218253208
Bond Position:  [8.27015229]


portfolio before change:  [12.59267698]
curr_Stock_Price:  102.15227340028586
curr_Factors:  [102.1522734   -1.39795794  -1.01157661]
mat_Sqrt:  [[ 9.17910802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06113295 -0.00960257 -0.19548822]
Stock Position:  -0.06113294922975189
Bond Position:  [18.83754672]


portfolio before change:  [12.56182317]
curr_Stock_Price:  102.69549348844005
curr_Factors:  [102.69549349  -1.40999983  -1.00408907]
mat_Sqrt:  [[ 9.18598854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00025325  0.01901866 -0.01460611]
Stock Position:  0.00025324754266580727
Bond Position:  [12.53581579]


portfolio before change:  [12.56328027]
curr_Stock_Price:  102.26121416001584
curr_Factors:  [102.26121416  -1.35201454  -0.97587462]
mat_Sqrt:  [[ 9.97060542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037434 -0.06206746  0.35366717]
Stock Position:  -0.00037434434564262317
Bond Position:  [12.60156118]


portfolio before change:  [12.56498625]
curr_Stock_Price:  101.91210963104207
curr_Factors:  [101.91210963  -1.46447109  -0.9696948 ]
mat_Sqrt:  [[ 8.93472067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00807251  0.00225658  0.15019092]
Stock Position:  -0.008072509623406526
Bond Position:  [13.38767273]


portfolio before change:  [12.56671633]
curr_Stock_Price:  101.90510836788522
curr_Factors:  [101.90510837  -1.1790895   -0.98321686]
mat_Sqrt:  [[11.72514536  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01564879 -0.01214385  0.81732136]
Stock Position:  0.015648788031006583
Bond Position:  [10.97202489]


portfolio before change:  [12.54667352]
curr_Stock_Price:  100.53667005444443
curr_Factors:  [100.53667005  -1.28908107  -0.95446162]
mat_Sqrt:  [[10.6651333   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00852056 0.04837312 0.31260667]
Stock Position:  0.008520556909808682
Bond Position:  [11.6900451]


portfolio before change:  [12.54313505]
curr_Stock_Price:  99.94987533971089
curr_Factors:  [99.94987534 -1.38117902 -0.95768283]
mat_Sqrt:  [[ 9.63889965  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00613353 -0.03415766 -0.18299711]
Stock Position:  0.006133527026223283
Bond Position:  [11.93008978]


portfolio before change:  [12.53918197]
curr_Stock_Price:  99.06222508539074
curr_Factors:  [99.06222509 -1.38117736 -0.91565742]
mat_Sqrt:  [[ 9.96335056  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00356968 -0.01429968  0.03538108]
Stock Position:  -0.0035696827915262415
Bond Position:  [12.89280269]


portfolio before change:  [12.54067806]
curr_Stock_Price:  99.09461393318412
curr_Factors:  [99.09461393 -1.3487471  -0.93469586]
mat_Sqrt:  [[10.10097677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0457277  -0.08785088  0.38318316]
Stock Position:  -0.04572769579528143
Bond Position:  [17.07204642]


portfolio before change:  [12.5156532]
curr_Stock_Price:  99.68854262563663
curr_Factors:  [99.68854263 -1.27151048 -0.9444022 ]
mat_Sqrt:  [[10.87142808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01534607  0.00205659 -0.06941283]
Stock Position:  -0.01534606610084645
Bond Position:  [14.04548017]


portfolio before change:  [12.51120829]
curr_Stock_Price:  100.09260122685545
curr_Factors:  [100.09260123  -1.14427776  -0.97552504]
mat_Sqrt:  [[12.01664746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03920538 0.42120008 1.4875524 ]
Stock Position:  0.03920538055328183
Bond Position:  [8.58703977]


portfolio before change:  [12.529213]
curr_Stock_Price:  100.52446201052437
curr_Factors:  [100.52446201  -1.0308878   -0.97014244]
mat_Sqrt:  [[13.59049783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104628 -0.0009204   0.14134224]
Stock Position:  -0.0010462836318200228
Bond Position:  [12.6343901]


portfolio before change:  [12.5297681]
curr_Stock_Price:  101.50344802928574
curr_Factors:  [101.50344803  -0.94314852  -0.99496845]
mat_Sqrt:  [[14.61393895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00405258 -0.02526199 -0.05063018]
Stock Position:  -0.0040525792269632994
Bond Position:  [12.94111887]


portfolio before change:  [12.52887596]
curr_Stock_Price:  102.1227779766872
curr_Factors:  [102.12277798  -0.95404763  -1.01668342]
mat_Sqrt:  [[14.23131395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273122  0.01916992 -0.08961985]
Stock Position:  -0.002731221012340002
Bond Position:  [12.80779584]


portfolio before change:  [12.5315061]
curr_Stock_Price:  101.7459981678016
curr_Factors:  [101.74599817  -1.15171775  -1.01180421]
mat_Sqrt:  [[11.69261603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00808711 -0.01111997  0.27921629]
Stock Position:  0.008087106795402846
Bond Position:  [11.70867535]


portfolio before change:  [12.53584847]
curr_Stock_Price:  102.10195920052985
curr_Factors:  [102.1019592   -1.04866613  -1.02931199]
mat_Sqrt:  [[12.78143578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00611882  0.01125793 -0.03969245]
Stock Position:  0.006118820690557955
Bond Position:  [11.91110489]


portfolio before change:  [12.53172042]
curr_Stock_Price:  101.18396626337238
curr_Factors:  [101.18396626  -1.19890922  -1.05667963]
mat_Sqrt:  [[10.60527428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00514744 -0.04596887  0.12458737]
Stock Position:  -0.0051474431941514395
Bond Position:  [13.05255914]


portfolio before change:  [12.52882635]
curr_Stock_Price:  102.06318829037903
curr_Factors:  [102.06318829  -1.17552009  -1.08853089]
mat_Sqrt:  [[10.60728606  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122143  0.02004328 -0.05140267]
Stock Position:  0.001221432402928794
Bond Position:  [12.40416306]


portfolio before change:  [12.53015285]
curr_Stock_Price:  101.8796999014136
curr_Factors:  [101.8796999   -1.07255471  -1.08771965]
mat_Sqrt:  [[11.74606562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094362 -0.02202928 -0.03746762]
Stock Position:  0.000943617165370082
Bond Position:  [12.43401741]


portfolio before change:  [12.53194585]
curr_Stock_Price:  102.13261364030616
curr_Factors:  [102.13261364  -1.08657723  -1.09258333]
mat_Sqrt:  [[11.55492254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094921  0.01566941 -0.23750857]
Stock Position:  0.0009492062740126946
Bond Position:  [12.43500093]


portfolio before change:  [12.53389363]
curr_Stock_Price:  102.54696350342913
curr_Factors:  [102.5469635   -1.15875631  -1.11078678]
mat_Sqrt:  [[10.59919222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07426113 -0.01607612 -2.57721163]
Stock Position:  -0.07426112632445031
Bond Position:  [20.14914664]


portfolio before change:  [12.57300089]
curr_Stock_Price:  102.05426337737785
curr_Factors:  [102.05426338  -1.28857088  -1.1191777 ]
mat_Sqrt:  [[ 9.18669356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02488279  0.02371957 -0.0007352 ]
Stock Position:  -0.024882790718028368
Bond Position:  [15.11239577]


portfolio before change:  [12.56680243]
curr_Stock_Price:  102.37929259068692
curr_Factors:  [102.37929259  -1.36776119  -1.13397767]
mat_Sqrt:  [[ 8.38920372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085896  0.01248039  0.34345107]
Stock Position:  -0.0008589578330526782
Bond Position:  [12.65474192]


portfolio before change:  [12.56824813]
curr_Stock_Price:  102.53790002387765
curr_Factors:  [102.53790002  -1.48106016  -1.18272159]
mat_Sqrt:  [[ 7.14527099  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00180521 0.00194326 0.11745125]
Stock Position:  0.0018052133378616464
Bond Position:  [12.38314535]


portfolio before change:  [12.57037423]
curr_Stock_Price:  102.85814665704682
curr_Factors:  [102.85814666  -1.85595661  -1.16143282]
mat_Sqrt:  [[ 5.03272404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.80228667e-02 -6.59803604e-05 -4.40054127e-01]
Stock Position:  -0.028022866706438873
Bond Position:  [15.45275437]


portfolio before change:  [12.57654658]
curr_Stock_Price:  102.70681918450921
curr_Factors:  [102.70681918  -1.89107264  -1.17594633]
mat_Sqrt:  [[ 4.78200323  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01850683 -0.05295252 -0.16455836]
Stock Position:  -0.018506830378991906
Bond Position:  [14.47732426]


portfolio before change:  [12.57991905]
curr_Stock_Price:  102.62238044067583
curr_Factors:  [102.62238044  -1.73166438  -1.19884905]
mat_Sqrt:  [[ 5.47691843  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03556929 -0.05401632 -0.21960167]
Stock Position:  0.03556929032989824
Bond Position:  [8.92971381]


portfolio before change:  [12.58272536]
curr_Stock_Price:  102.66989398396737
curr_Factors:  [102.66989398  -1.61682759  -1.19648564]
mat_Sqrt:  [[ 6.16079421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00397869 0.00777784 0.21633947]
Stock Position:  0.003978688921184006
Bond Position:  [12.17423379]


portfolio before change:  [12.58367309]
curr_Stock_Price:  102.52558880164368
curr_Factors:  [102.5255888   -1.43239136  -1.1606944 ]
mat_Sqrt:  [[ 7.66777633  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00351666 -0.00581137 -0.13643197]
Stock Position:  -0.0035166606256575492
Bond Position:  [12.94422079]


portfolio before change:  [12.58691781]
curr_Stock_Price:  102.0630497843569
curr_Factors:  [102.06304978  -1.37677615  -1.12948941]
mat_Sqrt:  [[ 8.32551758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01115476 -0.00043444  0.00177548]
Stock Position:  -0.01115476227222866
Bond Position:  [13.72540687]


portfolio before change:  [12.59220849]
curr_Stock_Price:  101.7425684077553
curr_Factors:  [101.74256841  -1.27403607  -1.11365495]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.59220849]
Stock Price:  102.29187422179761
PL:  [10.30033426]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-3.95314553e-02  1.21307197e-01  3.06430200e-01]
 [-8.55173245e-02  5.23842584e-02  7.75451071e-02]
 [ 2.48965096e-01  1.09350203e-01  1.24329700e-01]
 [-1.21129799e-03 -6.44633186e-03  8.88023725e-02]
 [-9.21848106e-01 -2.74273209e-01  3.01259907e-02]
 [-1.51389385e-02 -7.53297610e-02 -8.25004797e-02]
 [ 3.04453068e-02 -1.30552984e-01 -2.22795236e-02]
 [ 2.32761074e-01  1.53833499e-01 -6.29244448e-02]
 [-2.27371043e-01  1.29930880e-02 -1.09170416e-01]
 [ 1.08352724e-01 -1.57319005e-02  7.85370440e-02]
 [ 1.75498311e-01 -2.33682678e-01 -3.63141755e-02]
 [-6.01697575e-02 -6.39763853e-02 -1.38153742e-01]
 [ 2.81497727e-01 -3.30859308e-01 -4.45610619e-02]
 [ 9.00948755e-02 -6.20565325e-02 -5.18651394e-02]
 [-6.84866860e-02  4.76951361e-03  2.03973020e-02]
 [-2.76049435e-02 -8.37315699e-02 -3.76012222e-04]
 [-4.77196392e-01 -2.59412591e-01  1.30481135e-01]
 [-1.63332838e-01 -1.11321388e-02 -2.09534450e-02]
 [ 3.55065629e-01  1.34910394e+00  5.94761407e-01]
 [-2.16258031e-01 -3.01540325e-02  1.74414022e-01]
 [-9.36330380e-02  2.14140148e-01 -3.39579551e-02]
 [ 1.56850947e-03  2.31776559e-02  6.69654089e-03]
 [ 1.91397146e-02 -3.06076517e-02  1.22545540e-02]
 [ 5.81666437e-02  2.45922864e-01  1.00412739e-01]
 [-5.65718866e-02 -1.93354909e-01  6.95849091e-02]
 [ 7.79684084e-02  2.42738893e-02 -1.03656831e-02]
 [ 3.52987920e-02 -6.61696301e-02  1.11255423e-01]
 [ 3.34292203e-02  4.40922782e-02 -7.25507953e-02]
 [-7.71310580e-01 -1.92973088e-01 -1.22922817e+00]
 [-2.03241997e-01  3.45705385e-02  4.24795030e-02]
 [ 2.61861831e-03 -3.44760935e-03  1.13830030e-01]
 [ 1.67860204e-02  6.53745882e-02  4.28168517e-03]
 [-1.33153020e-01 -1.07073827e-02 -1.39283626e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 2.30187257e-01 -1.74683268e-01 -7.30518873e-02]
 [ 1.16420630e-03  7.64879839e-02  7.75759896e-02]
 [-3.89687569e-03 -4.49804767e-03 -4.69350059e-02]
 [-5.26903554e-02  9.17779766e-02 -7.09277111e-03]
 [-8.72299786e-02 -1.91150774e-01  5.07761451e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.08143652]
curr_Stock_Price:  98.9593173601149
curr_Factors:  [98.95931736 -1.00507691 -0.9490862 ]
mat_Sqrt:  [[14.02085301  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00186511 0.0383607  0.87416007]
Stock Position:  0.0018651137457700937
Bond Position:  [-5.2660069]


portfolio before change:  [-5.08202958]
curr_Stock_Price:  98.994293489866
curr_Factors:  [98.99429349 -0.99493517 -0.9247518 ]
mat_Sqrt:  [[14.5177964   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00470705  0.01656536  0.22121461]
Stock Position:  -0.004707046316903198
Bond Position:  [-4.61605885]


portfolio before change:  [-5.08825534]
curr_Stock_Price:  100.19434890912265
curr_Factors:  [100.19434891  -1.15190279  -0.9427581 ]
mat_Sqrt:  [[12.33512514  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02246975 0.03457957 0.35467803]
Stock Position:  0.022469751797922072
Bond Position:  [-7.33959749]


portfolio before change:  [-5.08780294]
curr_Stock_Price:  100.25531570166393
curr_Factors:  [100.2553157   -1.24899155  -0.92535368]
mat_Sqrt:  [[11.39728153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146956 -0.00203851  0.25332845]
Stock Position:  0.0014695580500175913
Bond Position:  [-5.23513394]


portfolio before change:  [-5.08852686]
curr_Stock_Price:  100.20802540149
curr_Factors:  [100.2080254   -1.21617123  -0.9106703 ]
mat_Sqrt:  [[11.94612246  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07724518 -0.0867328   0.08594107]
Stock Position:  -0.07724517903895073
Bond Position:  [2.65206]


portfolio before change:  [-5.05408831]
curr_Stock_Price:  99.76648288548836
curr_Factors:  [99.76648289 -1.19919673 -0.92285977]
mat_Sqrt:  [[11.95053182  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283873 -0.02382136 -0.2353509 ]
Stock Position:  -0.0028387259194942744
Bond Position:  [-4.7708786]


portfolio before change:  [-5.05183813]
curr_Stock_Price:  98.76371735159321
curr_Factors:  [98.76371735 -1.15918723 -0.93189063]
mat_Sqrt:  [[12.20264149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00184605 -0.04128448 -0.06355728]
Stock Position:  0.0018460473946871462
Bond Position:  [-5.23416063]


portfolio before change:  [-5.0521592]
curr_Stock_Price:  98.94423276081672
curr_Factors:  [98.94423276 -0.97969173 -0.91020855]
mat_Sqrt:  [[14.94917496  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01497666  0.04864642 -0.17950593]
Stock Position:  0.014976655218068395
Bond Position:  [-6.53401286]


portfolio before change:  [-5.05473328]
curr_Stock_Price:  98.82689797262061
curr_Factors:  [98.82689797 -1.11782246 -0.89272376]
mat_Sqrt:  [[13.23445416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0188387   0.00410878 -0.31143281]
Stock Position:  -0.0188386976840595
Bond Position:  [-3.19296323]


portfolio before change:  [-5.03736137]
curr_Stock_Price:  97.88357080636892
curr_Factors:  [97.88357081 -0.95526111 -0.87102627]
mat_Sqrt:  [[15.76025621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00786649 -0.00497486  0.22404433]
Stock Position:  0.007866485990359754
Bond Position:  [-5.80736111]


portfolio before change:  [-5.04707279]
curr_Stock_Price:  96.74132586936986
curr_Factors:  [96.74132587 -0.85065149 -0.87348582]
mat_Sqrt:  [[17.25157369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00939346 -0.07389695 -0.10359423]
Stock Position:  0.009393464825628937
Bond Position:  [-5.95580903]


portfolio before change:  [-5.03981749]
curr_Stock_Price:  97.59296280098758
curr_Factors:  [97.5929628  -0.93770932 -0.87230106]
mat_Sqrt:  [[15.97132629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00563648 -0.02023111 -0.39411417]
Stock Position:  -0.005636484632688555
Bond Position:  [-4.48973626]


portfolio before change:  [-5.0371229]
curr_Stock_Price:  97.01532609260262
curr_Factors:  [97.01532609 -0.88101263 -0.87176651]
mat_Sqrt:  [[16.81194806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01569473 -0.1046269  -0.12712031]
Stock Position:  0.015694730130969052
Bond Position:  [-6.55975227]


portfolio before change:  [-5.02303676]
curr_Stock_Price:  97.96508191248432
curr_Factors:  [97.96508191 -0.8810329  -0.8798962 ]
mat_Sqrt:  [[16.83873698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00462657 -0.019624   -0.14795681]
Stock Position:  0.004626573567124094
Bond Position:  [-5.47627942]


portfolio before change:  [-5.01994628]
curr_Stock_Price:  98.7810341480226
curr_Factors:  [98.78103415 -0.89849244 -0.89696874]
mat_Sqrt:  [[16.40267512  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391399  0.00150825  0.05818783]
Stock Position:  -0.003913993017645061
Bond Position:  [-4.633318]


portfolio before change:  [-5.02207133]
curr_Stock_Price:  99.17598921333799
curr_Factors:  [99.17598921 -1.16531105 -0.89090723]
mat_Sqrt:  [[12.68826644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00235207 -0.02647825 -0.00107266]
Stock Position:  -0.0023520657151026225
Bond Position:  [-4.78880289]


portfolio before change:  [-5.02556468]
curr_Stock_Price:  100.40670127427046
curr_Factors:  [100.40670127  -1.13376205  -0.87333883]
mat_Sqrt:  [[13.49242037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03389014 -0.08203346  0.37222636]
Stock Position:  -0.03389014227964416
Bond Position:  [-1.62276729]


portfolio before change:  [-5.01797507]
curr_Stock_Price:  100.1767680166154
curr_Factors:  [100.17676802  -1.26294336  -0.87401893]
mat_Sqrt:  [[11.82213961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01420194 -0.00352029 -0.05977435]
Stock Position:  -0.01420194471202335
Bond Position:  [-3.59527015]


portfolio before change:  [-4.99585221]
curr_Stock_Price:  98.58738686678264
curr_Factors:  [98.58738687 -1.31351416 -0.88612193]
mat_Sqrt:  [[10.92776986  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04678947 0.42662412 1.69668875]
Stock Position:  0.04678946510729688
Bond Position:  [-9.6087033]


portfolio before change:  [-5.00904707]
curr_Stock_Price:  98.3310534174032
curr_Factors:  [98.33105342 -0.92229359 -0.88310527]
mat_Sqrt:  [[16.16649708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01122287 -0.00953554  0.49755466]
Stock Position:  -0.011222869754082439
Bond Position:  [-3.90549047]


portfolio before change:  [-5.01114399]
curr_Stock_Price:  98.47439439995556
curr_Factors:  [98.4743944  -1.09734251 -0.86808918]
mat_Sqrt:  [[13.79580915  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00688873  0.06771706 -0.09687259]
Stock Position:  -0.00688872980378084
Bond Position:  [-4.33278049]


portfolio before change:  [-5.01488858]
curr_Stock_Price:  98.93935163290583
curr_Factors:  [98.93935163 -0.807991   -0.87992444]
mat_Sqrt:  [[18.29433791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00019317 0.00732942 0.01910337]
Stock Position:  0.0001931679449570734
Bond Position:  [-5.03400049]


portfolio before change:  [-5.01546852]
curr_Stock_Price:  99.19486982095297
curr_Factors:  [99.19486982 -0.71649745 -0.90015486]
mat_Sqrt:  [[19.6963628   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00105862 -0.00967899  0.03495883]
Stock Position:  0.0010586156940917096
Bond Position:  [-5.12047776]


portfolio before change:  [-5.01531843]
curr_Stock_Price:  99.94130546425772
curr_Factors:  [99.94130546 -0.49914913 -0.91118716]
mat_Sqrt:  [[24.39179424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00348531 0.07776764 0.28644959]
Stock Position:  0.003485311840232395
Bond Position:  [-5.36364504]


portfolio before change:  [-5.01133163]
curr_Stock_Price:  101.2775679144697
curr_Factors:  [101.27756791  -0.54823473  -0.92396794]
mat_Sqrt:  [[23.23505842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203831 -0.06114419  0.19850638]
Stock Position:  -0.0020383133101326096
Bond Position:  [-4.80489622]


portfolio before change:  [-5.00903712]
curr_Stock_Price:  99.85719578678605
curr_Factors:  [99.85719579 -0.40024626 -0.91013035]
mat_Sqrt:  [[26.93332898  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00283958  0.00767608 -0.02957041]
Stock Position:  0.00283957736366198
Bond Position:  [-5.29258935]


portfolio before change:  [-5.00791645]
curr_Stock_Price:  100.48485455553019
curr_Factors:  [100.48485456  -0.21192327  -0.90243634]
mat_Sqrt:  [[32.97162708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00170754 -0.02092467  0.31738075]
Stock Position:  0.001707535316016542
Bond Position:  [-5.17949789]


portfolio before change:  [-5.00864273]
curr_Stock_Price:  100.43870614770812
curr_Factors:  [100.43870615  -0.32083339  -0.92068211]
mat_Sqrt:  [[29.02136117  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068082  0.0139432  -0.20696722]
Stock Position:  0.0006808195107063827
Bond Position:  [-5.07702336]


portfolio before change:  [-5.00761657]
curr_Stock_Price:  102.87815028147568
curr_Factors:  [102.87815028  -0.38340231  -0.92205006]
mat_Sqrt:  [[27.88511139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03683716 -0.06102345 -3.50664581]
Stock Position:  -0.03683715865072198
Bond Position:  [-1.21787783]


portfolio before change:  [-5.01564262]
curr_Stock_Price:  103.09189643723136
curr_Factors:  [103.09189644  -0.51403626  -0.92627251]
mat_Sqrt:  [[24.41779131  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00793185  0.01093216  0.1211822 ]
Stock Position:  -0.007931851622487331
Bond Position:  [-4.19793299]


portfolio before change:  [-5.01714916]
curr_Stock_Price:  103.21567198676803
curr_Factors:  [103.21567199  -0.84856527  -0.90572028]
mat_Sqrt:  [[17.85949236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144265 -0.00109023  0.32472539]
Stock Position:  0.0014426534864641113
Bond Position:  [-5.16605361]


portfolio before change:  [-5.01892023]
curr_Stock_Price:  102.43566880875186
curr_Factors:  [102.43566881  -1.08025649  -0.90974295]
mat_Sqrt:  [[14.0024952   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00138175 0.02067326 0.01221446]
Stock Position:  0.0013817523262350797
Bond Position:  [-5.16046096]


portfolio before change:  [-5.02071821]
curr_Stock_Price:  101.60130725808791
curr_Factors:  [101.60130726  -0.94380584  -0.89353895]
mat_Sqrt:  [[16.17895975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01000439 -0.00338597 -0.39733742]
Stock Position:  -0.010004390670332739
Bond Position:  [-4.00425904]


portfolio before change:  [-5.02141048]
curr_Stock_Price:  101.6204689688584
curr_Factors:  [101.62046897  -0.85550408  -0.90321118]
mat_Sqrt:  [[17.50575572  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299408  0.0049611   0.16678008]
Stock Position:  -0.00299408402565177
Bond Position:  [-4.71715025]


portfolio before change:  [-5.02471802]
curr_Stock_Price:  102.52821383332133
curr_Factors:  [102.52821383  -1.07086118  -0.92109173]
mat_Sqrt:  [[13.98779427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0150678 -0.0552397 -0.2083967]
Stock Position:  0.01506780095712522
Bond Position:  [-6.56959274]


portfolio before change:  [-5.02355311]
curr_Stock_Price:  102.66002912554004
curr_Factors:  [102.66002913  -0.83172503  -0.91495684]
mat_Sqrt:  [[17.89893067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00106008 0.02418762 0.22130271]
Stock Position:  0.0010600773014448322
Bond Position:  [-5.13238067]


portfolio before change:  [-5.02500482]
curr_Stock_Price:  101.895814182149
curr_Factors:  [101.89581418  -0.91480098  -0.94891651]
mat_Sqrt:  [[15.80353062  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086016 -0.00142241 -0.13389251]
Stock Position:  -0.0008601611287303221
Bond Position:  [-4.937358]


portfolio before change:  [-5.02615746]
curr_Stock_Price:  102.51828887759318
curr_Factors:  [102.51828888  -0.54703889  -0.95213368]
mat_Sqrt:  [[22.8938574   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226124  0.02902274 -0.0202337 ]
Stock Position:  -0.00226123816218603
Bond Position:  [-4.79433919]


portfolio before change:  [-5.03135071]
curr_Stock_Price:  104.54988443812917
curr_Factors:  [104.54988444  -0.5559775   -0.95666628]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.03135071]
Stock Price:  103.64791238451683
PL:  [-8.67926309]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.18198693e-01  1.68806493e-01  2.70961125e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.18718965e-01  2.53565285e-01  3.71114916e-01]
 [-1.39238658e-02  2.34661526e-02  1.17256343e-01]
 [-6.95587700e-01 -2.10182303e-01  3.56552138e-02]
 [-4.60085979e-03 -9.55434121e-02 -1.13154733e-01]
 [ 3.38022754e-02 -1.13331085e-01 -1.86423967e-02]
 [ 2.66892339e-01  2.79545887e-02 -6.31835712e-02]
 [-4.87066638e-01 -2.86113863e-02 -4.95293239e-02]
 [ 5.02279941e-02 -2.21000846e-02 -4.36583478e-02]
 [ 3.22932873e-02 -2.77324589e-01  4.54627573e-02]
 [-6.75597175e-03 -2.37819050e-03  1.17133965e-02]
 [ 2.18358724e-01 -1.73333260e-01  1.69648136e-01]
 [ 9.42111149e-02 -4.72836724e-02 -6.33598220e-02]
 [ 4.07001717e-02 -9.39782623e-02 -5.24905117e-02]
 [-2.65251303e-02 -7.89637677e-02  2.03259055e-04]
 [-3.52043960e-01 -2.84015267e-01  8.56929308e-02]
 [-2.21733771e-01 -2.64585367e-02 -3.94266472e-02]
 [ 3.36916942e-01  1.29356533e+00  5.23628387e-01]
 [-1.52255537e-01 -1.35334903e-02  1.44072600e-01]
 [-9.07708461e-02  1.21297336e-01 -3.83113374e-02]
 [ 9.12574203e-02 -8.51900385e-03  5.15878622e-02]
 [-9.94352145e-02  6.09634115e-03 -1.06735917e-01]
 [-1.18609256e-02 -1.18852227e-01  1.11767432e-01]
 [-1.01762845e-01  7.42542956e-02 -3.93647376e-02]
 [ 1.02638804e-01 -1.13546272e-01 -1.18844373e-01]
 [ 4.11100706e-02 -5.97719124e-02  1.13784480e-01]
 [-6.78683296e-02  4.35244065e-02  7.12451800e-02]
 [-4.82241032e-01  7.45590563e-03 -6.82361006e-01]
 [ 2.04809784e-01 -1.29556500e-01 -1.61228233e-01]
 [ 1.34424519e-01  7.35911590e-03 -3.66947332e-02]
 [ 4.76440297e-02  2.76558981e-01 -9.71539785e-02]
 [-1.54838483e-01  3.66529614e-02 -1.41486676e-01]
 [-5.29500612e-02  1.51580189e-01  9.50982144e-02]
 [-1.84239981e-01  8.88104059e-02  7.58710359e-02]
 [-1.37658456e-01 -5.84302295e-02 -1.76152850e-02]
 [ 1.46477973e-01  1.24392365e-01  4.79105174e-02]
 [-1.30452201e-01  1.75468356e-01  7.13689774e-04]
 [ 1.59078534e-03 -2.11513199e-01  6.75297469e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.20535435]
curr_Stock_Price:  99.36004178995755
curr_Factors:  [99.36004179 -0.83191265 -1.02520585]
mat_Sqrt:  [[15.51227338  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01021968  0.0533813   0.77297667]
Stock Position:  -0.01021967675739464
Bond Position:  [-1.18992684]


portfolio before change:  [-2.20396546]
curr_Stock_Price:  99.20958291622799
curr_Factors:  [99.20958292 -0.91395933 -1.04172901]
mat_Sqrt:  [[14.03488857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323345  0.01411938  0.0859571 ]
Stock Position:  -0.0032334451825985753
Bond Position:  [-1.88317672]


portfolio before change:  [-2.20428407]
curr_Stock_Price:  99.23531106250724
curr_Factors:  [99.23531106 -0.9924489  -1.02606337]
mat_Sqrt:  [[13.1837055   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02283269 0.08018438 1.05868756]
Stock Position:  0.022832693542353618
Bond Position:  [-4.47009351]


portfolio before change:  [-2.18355967]
curr_Stock_Price:  100.16744770255805
curr_Factors:  [100.1674477   -0.84376524  -1.03454377]
mat_Sqrt:  [[15.31042942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00069344 0.00742065 0.33449971]
Stock Position:  0.0006934409336979638
Bond Position:  [-2.25301988]


portfolio before change:  [-2.18354305]
curr_Stock_Price:  100.59757928572142
curr_Factors:  [100.59757929  -0.84542178  -1.0181568 ]
mat_Sqrt:  [[15.60434825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0444579  -0.06646548  0.1017144 ]
Stock Position:  -0.04445789614958199
Bond Position:  [2.28881369]


portfolio before change:  [-2.15075633]
curr_Stock_Price:  99.86653708363674
curr_Factors:  [99.86653708 -0.69461833 -1.00768274]
mat_Sqrt:  [[18.20203863  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165725 -0.03021348 -0.32279896]
Stock Position:  -0.0016572535591264852
Bond Position:  [-1.98525215]


portfolio before change:  [-2.14950395]
curr_Stock_Price:  98.96109046586822
curr_Factors:  [98.96109047 -0.76558346 -0.99547993]
mat_Sqrt:  [[17.00765201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00159168 -0.03583844 -0.05318157]
Stock Position:  0.0015916786199616222
Bond Position:  [-2.3070182]


portfolio before change:  [-2.14865311]
curr_Stock_Price:  99.67683493755918
curr_Factors:  [99.67683494 -0.96805173 -1.00671925]
mat_Sqrt:  [[13.8344564   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01841177  0.00884002 -0.18024514]
Stock Position:  0.018411770115843714
Bond Position:  [-3.98388008]


portfolio before change:  [-2.12549265]
curr_Stock_Price:  100.96179960887304
curr_Factors:  [100.96179961  -1.06705341  -0.98369392]
mat_Sqrt:  [[12.98759793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03833777 -0.00904771 -0.14129337]
Stock Position:  -0.0383377676229916
Bond Position:  [1.74515736]


portfolio before change:  [-2.08424843]
curr_Stock_Price:  99.89167827237233
curr_Factors:  [99.89167827 -0.99252836 -0.97958093]
mat_Sqrt:  [[13.90122676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00293108 -0.00698866 -0.12454511]
Stock Position:  0.002931083001181598
Bond Position:  [-2.37703923]


portfolio before change:  [-2.08550152]
curr_Stock_Price:  99.565538687133
curr_Factors:  [99.56553869 -1.03569195 -0.96719376]
mat_Sqrt:  [[13.43590215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00256126 -0.08769774  0.12969259]
Stock Position:  0.0025612603647694452
Bond Position:  [-2.34051479]


portfolio before change:  [-2.08573738]
curr_Stock_Price:  99.58768273547807
curr_Factors:  [99.58768274 -0.98319171 -0.96743329]
mat_Sqrt:  [[14.15989244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003126  -0.00075205  0.03341506]
Stock Position:  -0.0003126004907677862
Bond Position:  [-2.05460622]


portfolio before change:  [-2.08599618]
curr_Stock_Price:  99.59393346951678
curr_Factors:  [99.59393347 -1.26377647 -0.97309446]
mat_Sqrt:  [[10.63584949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02336556 -0.05481279  0.48395891]
Stock Position:  0.02336555807385533
Bond Position:  [-4.41306402]


portfolio before change:  [-2.10357654]
curr_Stock_Price:  98.8651388725048
curr_Factors:  [98.86513887 -1.47594442 -0.96484026]
mat_Sqrt:  [[ 8.61041061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0092977  -0.01495241 -0.18074794]
Stock Position:  0.009297696691460952
Bond Position:  [-3.02279461]


portfolio before change:  [-2.09969651]
curr_Stock_Price:  99.32309159939659
curr_Factors:  [99.3230916  -1.26503016 -0.96201602]
mat_Sqrt:  [[10.71164969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00257281 -0.02971854 -0.14974082]
Stock Position:  0.002572814029667969
Bond Position:  [-2.35523635]


portfolio before change:  [-2.1011459]
curr_Stock_Price:  98.87417659346674
curr_Factors:  [98.87417659 -1.16804129 -0.95138499]
mat_Sqrt:  [[11.87483932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240193 -0.02497054  0.00057984]
Stock Position:  -0.002401925211384084
Bond Position:  [-1.86365753]


portfolio before change:  [-2.09987749]
curr_Stock_Price:  98.2491010713976
curr_Factors:  [98.24910107 -1.16971397 -0.95860826]
mat_Sqrt:  [[11.69526283  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02923279 -0.08981351  0.24445808]
Stock Position:  -0.029232793822938384
Bond Position:  [0.77221822]


portfolio before change:  [-2.07608968]
curr_Stock_Price:  97.43866614267888
curr_Factors:  [97.43866614 -1.2842104  -0.95445693]
mat_Sqrt:  [[10.38700791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0221878  -0.00836692 -0.11247325]
Stock Position:  -0.022187800375807698
Bond Position:  [0.08585999]


portfolio before change:  [-2.07191603]
curr_Stock_Price:  97.2510442818758
curr_Factors:  [97.25104428 -1.27634843 -0.93576757]
mat_Sqrt:  [[10.64595201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04482472 0.40906127 1.49376604]
Stock Position:  0.04482472320110848
Bond Position:  [-6.43116717]


portfolio before change:  [-2.02601266]
curr_Stock_Price:  98.29304321160633
curr_Factors:  [98.29304321 -1.34884676 -0.94905608]
mat_Sqrt:  [[ 9.87543559  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01247502 -0.00427967  0.41099903]
Stock Position:  -0.012475021798425814
Bond Position:  [-0.79980481]


portfolio before change:  [-2.01882744]
curr_Stock_Price:  97.70905953964979
curr_Factors:  [97.70905954 -1.39371128 -0.93953808]
mat_Sqrt:  [[ 9.47583548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01007396  0.03835759 -0.10929158]
Stock Position:  -0.010073964619704492
Bond Position:  [-1.03450983]


portfolio before change:  [-2.01685208]
curr_Stock_Price:  97.50013701813367
curr_Factors:  [97.50013702 -1.23920483 -0.93655036]
mat_Sqrt:  [[11.06844868  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00917633 -0.00269395  0.14716581]
Stock Position:  0.009176334624191602
Bond Position:  [-2.91154596]


portfolio before change:  [-2.02234376]
curr_Stock_Price:  96.94133913018301
curr_Factors:  [96.94133913 -1.36189986 -0.93451856]
mat_Sqrt:  [[ 9.75409915  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01241172  0.00192783 -0.30448786]
Stock Position:  -0.012411723888321511
Bond Position:  [-0.81913463]


portfolio before change:  [-2.0208668]
curr_Stock_Price:  96.81409148108419
curr_Factors:  [96.81409148 -1.25217753 -0.94236093]
mat_Sqrt:  [[10.786055    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073101 -0.03758437  0.31884137]
Stock Position:  0.0007310137520783666
Bond Position:  [-2.09163923]


portfolio before change:  [-2.02149632]
curr_Stock_Price:  96.31061828730948
curr_Factors:  [96.31061829 -1.16370791 -0.94926605]
mat_Sqrt:  [[11.64182963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00926666  0.02348127 -0.11229664]
Stock Position:  -0.00926666207258712
Bond Position:  [-1.12901836]


portfolio before change:  [-2.02141575]
curr_Stock_Price:  96.28669403194438
curr_Factors:  [96.28669403 -1.14793171 -0.94362387]
mat_Sqrt:  [[11.89091382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00634502 -0.03590648 -0.33902992]
Stock Position:  0.00634501660433877
Bond Position:  [-2.63235643]


portfolio before change:  [-2.02262486]
curr_Stock_Price:  96.14799550423206
curr_Factors:  [96.1479955  -0.91953188 -0.92486549]
mat_Sqrt:  [[15.20297688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0041303  -0.01890154  0.32459545]
Stock Position:  0.0041303046536092635
Bond Position:  [-2.41974538]


portfolio before change:  [-2.0216976]
curr_Stock_Price:  96.44573394547437
curr_Factors:  [96.44573395 -0.76519656 -0.90950056]
mat_Sqrt:  [[18.07054716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288877  0.01376363  0.20324267]
Stock Position:  -0.002888771010758087
Bond Position:  [-1.74308796]


portfolio before change:  [-2.02059173]
curr_Stock_Price:  95.9874878816175
curr_Factors:  [95.98748788 -1.07439015 -0.89830197]
mat_Sqrt:  [[13.35012483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0465415   0.00235776 -1.94658602]
Stock Position:  -0.04654150329047751
Bond Position:  [2.44681025]


portfolio before change:  [-1.99738072]
curr_Stock_Price:  95.4953434831764
curr_Factors:  [95.49534348 -1.02964475 -0.88637241]
mat_Sqrt:  [[14.05615421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01199148 -0.04096936 -0.45993927]
Stock Position:  0.011991478752082101
Bond Position:  [-3.1425111]


portfolio before change:  [-2.00984778]
curr_Stock_Price:  94.48844354396242
curr_Factors:  [94.48844354 -0.86661986 -0.86009028]
mat_Sqrt:  [[16.8065282   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00756398  0.00232716 -0.10467986]
Stock Position:  0.007563980377757333
Bond Position:  [-2.72455651]


portfolio before change:  [-2.01946204]
curr_Stock_Price:  93.26241311015379
curr_Factors:  [93.26241311 -0.79233217 -0.84039782]
mat_Sqrt:  [[18.2230483   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00191808  0.08745563 -0.27715326]
Stock Position:  0.001918080801243048
Bond Position:  [-2.19834688]


portfolio before change:  [-2.02027935]
curr_Stock_Price:  92.97957709941069
curr_Factors:  [92.9795771  -0.54763134 -0.85885317]
mat_Sqrt:  [[22.78028268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0080233   0.01159068 -0.40362211]
Stock Position:  -0.008023296170896189
Bond Position:  [-1.27427667]


portfolio before change:  [-2.04194276]
curr_Stock_Price:  95.65978592770499
curr_Factors:  [95.65978593 -0.59923988 -0.85026487]
mat_Sqrt:  [[22.45005933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131957  0.04793386  0.27128874]
Stock Position:  -0.001319570489729922
Bond Position:  [-1.91571293]


portfolio before change:  [-2.04083057]
curr_Stock_Price:  94.63546057319171
curr_Factors:  [94.63546057 -0.81316515 -0.83870669]
mat_Sqrt:  [[18.14074311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00917602  0.02808432  0.21643895]
Stock Position:  -0.009176018579699016
Bond Position:  [-1.17245382]


portfolio before change:  [-2.04155938]
curr_Stock_Price:  94.69891434769553
curr_Factors:  [94.69891435 -0.93958895 -0.81177397]
mat_Sqrt:  [[16.43379058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00868715 -0.01847726 -0.0502515 ]
Stock Position:  -0.008687151178105649
Bond Position:  [-1.2188956]


portfolio before change:  [-2.04478369]
curr_Stock_Price:  95.05253295048891
curr_Factors:  [95.05253295 -0.8713998  -0.82121561]
mat_Sqrt:  [[17.49323627  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00911606 0.03933632 0.13667537]
Stock Position:  0.00911606411590617
Bond Position:  [-2.91128868]


portfolio before change:  [-2.03875204]
curr_Stock_Price:  95.7541059507472
curr_Factors:  [95.75410595 -0.99071499 -0.82649047]
mat_Sqrt:  [[15.55804781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0080843   0.05548797  0.00203596]
Stock Position:  -0.008084301329038758
Bond Position:  [-1.264647]


portfolio before change:  [-2.03840263]
curr_Stock_Price:  95.69133000959086
curr_Factors:  [95.69133001 -0.77185597 -0.83636381]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.03840263]
Stock Price:  95.27026075877556
PL:  [-2.03840263]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-6.10776621e-02  3.86043219e-02  1.61647482e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 1.64828907e-01  2.25962945e-01  3.63590978e-01]
 [-3.90859429e-02  1.23443848e-02  1.06375506e-01]
 [-6.56830993e-01 -1.99204012e-01  3.66023281e-02]
 [ 1.21071483e-02 -1.27591934e-01 -1.61756716e-01]
 [ 3.31064717e-02 -1.20968824e-01 -1.82363748e-02]
 [ 1.60135083e-01  1.74488733e-01 -3.76372542e-02]
 [-2.48298179e-01  4.55691321e-03 -8.29597867e-02]
 [ 4.83099489e-02 -1.88415321e-02 -4.21314095e-02]
 [ 1.66158277e-02 -2.79284683e-01  1.03715073e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.36298098e-01 -4.84143037e-02  2.94269163e-01]
 [ 2.69915976e-02  4.06779508e-01  3.62525188e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-2.66245446e-02  1.92684200e-02  4.03599665e-02]
 [-5.69730435e-01 -2.77477799e-01  1.67474391e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 2.91823096e-01  1.16706707e+00  4.66941301e-01]
 [-1.55289484e-03  1.57491918e-03  3.75599222e-02]
 [-5.54628415e-02 -1.16305558e-01 -2.19554073e-02]
 [-2.77997563e-02  5.92863086e-02 -2.90072017e-02]
 [ 6.65952224e-02 -3.37282176e-02  8.84765958e-02]
 [ 4.89616899e-02  1.63926977e-01  9.04932398e-02]
 [-5.74300400e-02 -1.57725375e-01  3.51430730e-02]
 [ 1.61043650e-02  6.30548886e-02 -1.73731249e-02]
 [-3.82341984e-02  3.57056222e-02 -6.05898408e-02]
 [ 3.07495447e-02  4.92408853e-02 -8.43485526e-02]
 [-7.09793333e-01 -1.23689757e-01 -1.09882065e+00]
 [-2.22450243e-01  9.04859007e-02 -6.51938809e-04]
 [-2.20850458e-02  5.07698201e-02  1.51152776e-01]
 [ 1.87411267e-02  7.88082553e-02 -2.17256992e-03]
 [-1.31890879e-01 -9.25146799e-03 -1.40228517e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 2.24343912e-01 -1.71064682e-01 -7.06297389e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-1.66069255e-02 -2.04161661e-02 -4.56099457e-02]
 [-8.52658211e-02  2.16865896e-02 -1.43595906e-03]
 [-3.21748897e-02 -2.65182953e-01  1.35932875e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.46362092]
curr_Stock_Price:  100.98587971600203
curr_Factors:  [100.98587972  -1.07632714  -1.0068353 ]
mat_Sqrt:  [[12.57635254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00451492  0.01220776  0.04611353]
Stock Position:  -0.00451492491261117
Bond Position:  [9.91956458]


portfolio before change:  [9.47207887]
curr_Stock_Price:  99.38719831221732
curr_Factors:  [99.38719831 -1.25996556 -0.98509945]
mat_Sqrt:  [[10.52715707  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00431085  0.01411938  0.0859571 ]
Stock Position:  -0.004310854538159698
Bond Position:  [9.90052263]


portfolio before change:  [9.4772924]
curr_Stock_Price:  98.46490062415793
curr_Factors:  [98.46490062 -1.24022698 -0.9728624 ]
mat_Sqrt:  [[10.76834452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02274082 0.07145576 1.03722386]
Stock Position:  0.022740816113647446
Bond Position:  [7.23812021]


portfolio before change:  [9.47983416]
curr_Stock_Price:  98.53688265015636
curr_Factors:  [98.53688265 -0.88266988 -0.9815978 ]
mat_Sqrt:  [[15.27417102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111649  0.00390364  0.30345971]
Stock Position:  -0.001116486327935661
Bond Position:  [9.58984924]


portfolio before change:  [9.48017735]
curr_Stock_Price:  99.30322655071821
curr_Factors:  [99.30322655 -1.09833058 -0.969315  ]
mat_Sqrt:  [[12.5601924   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05210931 -0.06299384  0.10441625]
Stock Position:  -0.05210931317399219
Bond Position:  [14.65480028]


portfolio before change:  [9.49458716]
curr_Stock_Price:  99.06185236231617
curr_Factors:  [99.06185236 -1.00774831 -0.96300958]
mat_Sqrt:  [[13.80438838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175348 -0.04034811 -0.46144689]
Stock Position:  -0.0017534795449815474
Bond Position:  [9.66829009]


portfolio before change:  [9.49620705]
curr_Stock_Price:  98.82729959949867
curr_Factors:  [98.8272996  -0.87868316 -0.96641612]
mat_Sqrt:  [[15.61566527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168168 -0.0382537  -0.0520233 ]
Stock Position:  0.001681682155478058
Bond Position:  [9.33001095]


portfolio before change:  [9.49692009]
curr_Stock_Price:  98.55775740150472
curr_Factors:  [98.5577574  -0.71818413 -0.95575226]
mat_Sqrt:  [[18.48031938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00849323  0.05517818 -0.10736861]
Stock Position:  0.008493234707797455
Bond Position:  [8.65984593]


portfolio before change:  [9.49993048]
curr_Stock_Price:  98.78474221721568
curr_Factors:  [98.78474222 -0.62193351 -0.92662602]
mat_Sqrt:  [[20.99708526  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01262626  0.00144102 -0.23666118]
Stock Position:  -0.012626257973896486
Bond Position:  [10.74721212]


portfolio before change:  [9.48064818]
curr_Stock_Price:  100.41830475882865
curr_Factors:  [100.41830476  -1.04467851  -0.91644445]
mat_Sqrt:  [[14.12888866  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00277612 -0.00595822 -0.12018918]
Stock Position:  0.002776115351615724
Bond Position:  [9.20187538]


portfolio before change:  [9.48214529]
curr_Stock_Price:  100.54322794176618
curr_Factors:  [100.54322794  -1.0162577   -0.92827635]
mat_Sqrt:  [[14.38309726  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00212579 -0.08831757  0.29587024]
Stock Position:  0.002125792404195397
Bond Position:  [9.26841126]


portfolio before change:  [9.48423683]
curr_Stock_Price:  100.9820867981667
curr_Factors:  [100.9820868   -1.29911554  -0.91285978]
mat_Sqrt:  [[11.05593983  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0065237   0.00225658  0.15019092]
Stock Position:  -0.0065236985464384315
Bond Position:  [10.14301353]


portfolio before change:  [9.48030875]
curr_Stock_Price:  101.7785728644041
curr_Factors:  [101.77857286  -1.15485118  -0.90149841]
mat_Sqrt:  [[13.01952314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01498638 -0.01530995  0.83946801]
Stock Position:  0.014986377440259643
Bond Position:  [7.95501665]


portfolio before change:  [9.48961452]
curr_Stock_Price:  102.33316504904563
curr_Factors:  [102.33316505  -1.18596592  -0.8998269 ]
mat_Sqrt:  [[12.71065989  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00877175 0.12863498 1.03418345]
Stock Position:  0.008771750984548807
Bond Position:  [8.59197348]


portfolio before change:  [9.49003307]
curr_Stock_Price:  102.25843421593027
curr_Factors:  [102.25843422  -1.17423953  -0.87577559]
mat_Sqrt:  [[13.16403058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00326087 -0.03587186 -0.12433753]
Stock Position:  0.0032608655349225164
Bond Position:  [9.15658206]


portfolio before change:  [9.49118647]
curr_Stock_Price:  102.26111988514062
curr_Factors:  [102.26111989  -1.37587648  -0.8607398 ]
mat_Sqrt:  [[10.92346532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00163763  0.00609321  0.11513575]
Stock Position:  -0.0016376298124698935
Bond Position:  [9.65865233]


portfolio before change:  [9.4926577]
curr_Stock_Price:  102.10002014346269
curr_Factors:  [102.10002014  -1.57688293  -0.84645575]
mat_Sqrt:  [[ 9.04863792  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05997691 -0.08774618  0.47775782]
Stock Position:  -0.059976906842131375
Bond Position:  [15.61630109]


portfolio before change:  [9.48402719]
curr_Stock_Price:  102.27646586392159
curr_Factors:  [102.27646586  -1.50875431  -0.86407027]
mat_Sqrt:  [[ 9.53391091  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01377306  0.00580111 -0.05715682]
Stock Position:  -0.013773055465496658
Bond Position:  [10.89268662]


portfolio before change:  [9.50027063]
curr_Stock_Price:  101.1959667051559
curr_Factors:  [101.19596671  -1.24090503  -0.87231798]
mat_Sqrt:  [[12.22931443  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03412053 0.36905901 1.33205356]
Stock Position:  0.03412052530993236
Bond Position:  [6.04741109]


portfolio before change:  [9.48883]
curr_Stock_Price:  100.83851020450939
curr_Factors:  [100.8385102   -1.23448838  -0.89546991]
mat_Sqrt:  [[11.98387557  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00051358 0.00049803 0.107148  ]
Stock Position:  0.0005135781303940632
Bond Position:  [9.43704155]


portfolio before change:  [9.4903334]
curr_Stock_Price:  101.46879047529309
curr_Factors:  [101.46879048  -1.07495726  -0.89760774]
mat_Sqrt:  [[14.11426904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445985 -0.03677905 -0.06263267]
Stock Position:  -0.004459846037508538
Bond Position:  [9.94286859]


portfolio before change:  [9.48750212]
curr_Stock_Price:  102.382324269348
curr_Factors:  [102.38232427  -1.39154111  -0.91067585]
mat_Sqrt:  [[10.24200217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314295  0.01874798 -0.08274947]
Stock Position:  -0.003142946092804336
Bond Position:  [9.80928425]


portfolio before change:  [9.49121672]
curr_Stock_Price:  101.59059650190487
curr_Factors:  [101.5905965   -1.24486501  -0.91433665]
mat_Sqrt:  [[11.7253048   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00714562 -0.0106658   0.2523991 ]
Stock Position:  0.007145620055821341
Bond Position:  [8.76528891]


portfolio before change:  [9.48392258]
curr_Stock_Price:  100.41646956109624
curr_Factors:  [100.41646956  -1.12897975  -0.90125135]
mat_Sqrt:  [[13.18520193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00543535 0.05183826 0.25815202]
Stock Position:  0.0054353450102675935
Bond Position:  [8.93812442]


portfolio before change:  [9.48840786]
curr_Stock_Price:  101.03610802024038
curr_Factors:  [101.03610802  -1.02495875  -0.90983459]
mat_Sqrt:  [[14.59508204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372241 -0.04987714  0.10025341]
Stock Position:  -0.003722414287924147
Bond Position:  [9.86450612]


portfolio before change:  [9.48675918]
curr_Stock_Price:  101.8102884076165
curr_Factors:  [101.81028841  -1.02617097  -0.89121424]
mat_Sqrt:  [[14.96517674  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094794  0.01993971 -0.04956069]
Stock Position:  0.0009479447627716808
Bond Position:  [9.39024866]


portfolio before change:  [9.48818328]
curr_Stock_Price:  102.0742671325692
curr_Factors:  [102.07426713  -1.18829159  -0.87779676]
mat_Sqrt:  [[12.93080313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003842    0.01129111 -0.17284595]
Stock Position:  -0.0038419989947648748
Bond Position:  [9.88035251]


portfolio before change:  [9.48873419]
curr_Stock_Price:  102.25235366660634
curr_Factors:  [102.25235367  -1.12370012  -0.88278307]
mat_Sqrt:  [[13.74892479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107669  0.01557134 -0.24062294]
Stock Position:  0.0010766923935476758
Bond Position:  [9.37863986]


portfolio before change:  [9.49050096]
curr_Stock_Price:  102.8043803662455
curr_Factors:  [102.80438037  -0.94521906  -0.92316185]
mat_Sqrt:  [[15.87026218  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05905906 -0.03911414 -3.13462947]
Stock Position:  -0.05905906308260025
Bond Position:  [15.56203134]


portfolio before change:  [9.47490712]
curr_Stock_Price:  103.10135789286718
curr_Factors:  [103.10135789  -0.93821309  -0.90532533]
mat_Sqrt:  [[16.31645552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01349846  0.02861415 -0.0018598 ]
Stock Position:  -0.013498457635023808
Bond Position:  [10.86661643]


portfolio before change:  [9.49066764]
curr_Stock_Price:  102.03441290097736
curr_Factors:  [102.0344129   -0.99690038  -0.88089914]
mat_Sqrt:  [[15.60373984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00064598 0.01605483 0.4311968 ]
Stock Position:  0.0006459833765883386
Bond Position:  [9.42475511]


portfolio before change:  [9.49212714]
curr_Stock_Price:  102.46991976109594
curr_Factors:  [102.46991976  -1.00134008  -0.87389331]
mat_Sqrt:  [[15.71060393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129419  0.02492136 -0.00619774]
Stock Position:  0.0012941878752080328
Bond Position:  [9.35951181]


portfolio before change:  [9.49238804]
curr_Stock_Price:  101.76746001324508
curr_Factors:  [101.76746001  -1.018184    -0.88670523]
mat_Sqrt:  [[15.14698008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01061293 -0.00292557 -0.40003293]
Stock Position:  -0.010612925892028419
Bond Position:  [10.57243855]


portfolio before change:  [9.50664902]
curr_Stock_Price:  100.54825349692244
curr_Factors:  [100.5482535   -1.11358481  -0.8768199 ]
mat_Sqrt:  [[13.73892486  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00381498  0.0049611   0.16678008]
Stock Position:  -0.0038149785442368705
Bond Position:  [9.89023845]


portfolio before change:  [9.50623397]
curr_Stock_Price:  100.98112973105627
curr_Factors:  [100.98112973  -1.16777219  -0.87938324]
mat_Sqrt:  [[13.03682742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01576379 -0.0540954  -0.20148699]
Stock Position:  0.0157637896778488
Bond Position:  [7.91438867]


portfolio before change:  [9.50157886]
curr_Stock_Price:  100.62306419546279
curr_Factors:  [100.6230642   -1.04418869  -0.88064425]
mat_Sqrt:  [[14.68091806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00166964 0.00777784 0.21633947]
Stock Position:  0.0016696424266059286
Bond Position:  [9.33357432]


portfolio before change:  [9.50308334]
curr_Stock_Price:  100.82533287071932
curr_Factors:  [100.82533287  -1.09590229  -0.86922877]
mat_Sqrt:  [[14.1294119   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187157 -0.00645616 -0.13011248]
Stock Position:  -0.001871568330663971
Bond Position:  [9.69178484]


portfolio before change:  [9.50255991]
curr_Stock_Price:  101.75234999937327
curr_Factors:  [101.75235     -1.22509838  -0.88569971]
mat_Sqrt:  [[12.32640643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00689568  0.0068579  -0.00409639]
Stock Position:  -0.006895682875301971
Bond Position:  [10.20421185]


portfolio before change:  [9.508487]
curr_Stock_Price:  101.07780069371195
curr_Factors:  [101.07780069  -1.39864564  -0.86923595]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.508487]
Stock Price:  100.72852149810625
PL:  [8.7799655]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.48964276e-01 -9.02490107e-03  6.60672511e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.98511035e-01  2.91334071e-01  3.85598737e-01]
 [ 8.90488764e-03  4.94661340e-02  1.39979361e-01]
 [-7.95871651e-01 -2.38588905e-01  3.32045316e-02]
 [-7.56296906e-02  4.07007788e-02  9.34612792e-02]
 [ 3.17735338e-03  1.59464953e-01  8.76753140e-02]
 [ 2.75456892e-01 -1.25580102e-01 -5.10457749e-02]
 [-5.88884375e-01 -2.69210052e-02 -1.01944775e-01]
 [ 1.35557322e-02  4.02021456e-02 -1.44638940e-02]
 [-4.88636985e-03 -2.55168896e-01  1.85129636e-01]
 [-1.29346084e-01  1.66000685e-02  9.81022752e-02]
 [ 8.14452756e-02 -1.41528289e-02  2.53087142e-01]
 [ 2.03471769e-02  4.69798872e-01  4.26730763e-01]
 [ 7.67716191e-02 -1.18255536e-01 -4.90760418e-02]
 [-1.12841878e-02 -1.89141413e-02  3.44301238e-02]
 [-5.54419766e-01 -2.39131261e-01  1.57571404e-01]
 [-1.25283326e-01  1.85013982e-02 -2.20437192e-02]
 [ 1.60449360e-01  8.27794791e-01  2.30157576e-01]
 [-2.38957177e-02  4.49703421e-02  2.55580373e-02]
 [ 5.70570525e-02 -1.53712503e-01  1.06944677e-01]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.91861927e-01 -1.82941540e-02  1.88647409e-01]
 [ 8.37621963e-02 -6.47073149e-02 -5.52202516e-02]
 [-8.72181321e-02 -6.23009179e-03  1.66182739e-01]
 [ 1.41127564e-02  6.25389819e-02  2.29616664e-03]
 [ 5.38548193e-02 -5.17897426e-02  2.95232184e-01]
 [ 3.48526710e-02  4.79140922e-02 -6.42244544e-02]
 [-6.80937705e-01 -4.96776101e-02 -1.01790017e+00]
 [ 1.65959506e-01 -1.17435050e-01 -1.44037011e-01]
 [-7.46201524e-03  9.40676537e-02  1.92927284e-01]
 [ 3.61612405e-02  2.17677680e-01 -6.95447234e-02]
 [-6.14472573e-02  5.24850804e-03 -1.14471569e-01]
 [-4.45891320e-02  1.49317485e-01  9.50054896e-02]
 [-9.93481947e-02  8.28036179e-02  1.44275441e-01]
 [-7.41437400e-02 -9.68087051e-02  3.62108168e-02]
 [ 1.25529617e-01  1.03339072e-01  3.73583148e-02]
 [-9.18988845e-02  2.69264391e-01  2.93608116e-02]
 [ 1.29181536e-03 -1.93179822e-01  5.88678227e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.39973582]
curr_Stock_Price:  100.00166884699382
curr_Factors:  [100.00166885  -0.95934925  -0.99227828]
mat_Sqrt:  [[14.20450751  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00955411 -0.00285392  0.18847148]
Stock Position:  -0.009554106422478793
Bond Position:  [3.35516241]


portfolio before change:  [2.39516131]
curr_Stock_Price:  100.5243688825936
curr_Factors:  [100.52436888  -0.64187355  -0.98974961]
mat_Sqrt:  [[19.66375337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230785  0.01411938  0.0859571 ]
Stock Position:  -0.0023078525242343335
Bond Position:  [2.62715673]


portfolio before change:  [2.39723119]
curr_Stock_Price:  99.7697862727181
curr_Factors:  [99.76978627 -0.70111539 -0.99586321]
mat_Sqrt:  [[18.2814484   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02104556 0.09212792 1.10000587]
Stock Position:  0.021045556790450157
Bond Position:  [0.29752049]


portfolio before change:  [2.39312512]
curr_Stock_Price:  99.57291483618921
curr_Factors:  [99.57291484 -0.67934033 -0.99319368]
mat_Sqrt:  [[18.69687101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00207282 0.01564257 0.39932215]
Stock Position:  0.0020728209035883994
Bond Position:  [2.1867283]


portfolio before change:  [2.39607187]
curr_Stock_Price:  100.86265179683087
curr_Factors:  [100.8626518   -0.91767602  -0.99971943]
mat_Sqrt:  [[14.82573105  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05364013 -0.07544844  0.09472329]
Stock Position:  -0.05364013014689268
Bond Position:  [7.80635764]


portfolio before change:  [2.34633426]
curr_Stock_Price:  101.8080907173089
curr_Factors:  [101.80809072  -1.02469755  -0.99574517]
mat_Sqrt:  [[13.49942184  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00411137  0.01287072  0.26661901]
Stock Position:  -0.004111368469348238
Bond Position:  [2.76490483]


portfolio before change:  [2.34355142]
curr_Stock_Price:  102.56902296432817
curr_Factors:  [102.56902296  -0.80973927  -1.01426318]
mat_Sqrt:  [[16.55243984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00152191 0.05042725 0.25011327]
Stock Position:  0.0015219127525822039
Bond Position:  [2.18745032]


portfolio before change:  [2.34367093]
curr_Stock_Price:  102.46787432554582
curr_Factors:  [102.46787433  -0.75407398  -1.02844256]
mat_Sqrt:  [[17.23656147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01518834 -0.03971192 -0.14561939]
Stock Position:  0.015188339770266067
Bond Position:  [0.78735404]


portfolio before change:  [2.36838307]
curr_Stock_Price:  104.088441046311
curr_Factors:  [104.08844105  -0.65086031  -1.02789122]
mat_Sqrt:  [[19.42361117  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0314251  -0.00851317 -0.29082007]
Stock Position:  -0.03142509686781983
Bond Position:  [5.63937242]


portfolio before change:  [2.39227538]
curr_Stock_Price:  103.35058033626525
curr_Factors:  [103.35058034  -0.60320214  -1.01266821]
mat_Sqrt:  [[20.53758354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056683  0.01271303 -0.04126146]
Stock Position:  0.0005668299346316801
Bond Position:  [2.33369318]


portfolio before change:  [2.39296642]
curr_Stock_Price:  104.05503048007408
curr_Factors:  [104.05503048  -0.73605048  -0.99377095]
mat_Sqrt:  [[18.45062915  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00142622 -0.08069149  0.52812332]
Stock Position:  0.0014262183694740663
Bond Position:  [2.24456122]


portfolio before change:  [2.39167174]
curr_Stock_Price:  102.95052587287233
curr_Factors:  [102.95052587  -0.66276758  -0.9762544 ]
mat_Sqrt:  [[19.98988833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00544738  0.0052494   0.27985848]
Stock Position:  -0.005447375564337166
Bond Position:  [2.95248192]


portfolio before change:  [2.3912612]
curr_Stock_Price:  103.09364528163302
curr_Factors:  [103.09364528  -0.94166173  -0.94493372]
mat_Sqrt:  [[15.62765807  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00849398 -0.00447552  0.72198717]
Stock Position:  0.008493982079230016
Bond Position:  [1.51558562]


portfolio before change:  [2.39398643]
curr_Stock_Price:  103.3921831063167
curr_Factors:  [103.39218311  -0.81967184  -0.94592266]
mat_Sqrt:  [[17.68885657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00676038 0.14856345 1.21734409]
Stock Position:  0.0067603795238747166
Bond Position:  [1.69501603]


portfolio before change:  [2.40439353]
curr_Stock_Price:  104.90026569399728
curr_Factors:  [104.90026569  -0.75893947  -0.95881801]
mat_Sqrt:  [[18.82625739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00338361 -0.03739568 -0.14000029]
Stock Position:  0.003383607687045551
Bond Position:  [2.04945219]


portfolio before change:  [2.40535017]
curr_Stock_Price:  105.10727499374647
curr_Factors:  [105.10727499  -1.0502145   -0.99538537]
mat_Sqrt:  [[13.59064411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003491  -0.00598118  0.09821956]
Stock Position:  -0.00034910260121680215
Bond Position:  [2.44204339]


portfolio before change:  [2.40573426]
curr_Stock_Price:  104.88149456787467
curr_Factors:  [104.88149457  -1.10749126  -0.95274185]
mat_Sqrt:  [[13.36444698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03953998 -0.07561994  0.44950736]
Stock Position:  -0.03953998106915671
Bond Position:  [6.55274657]


portfolio before change:  [2.4207094]
curr_Stock_Price:  104.52347733927523
curr_Factors:  [104.52347734  -0.85023422  -0.95256319]
mat_Sqrt:  [[17.22934955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00750494  0.00585066 -0.0628846 ]
Stock Position:  -0.007504942450767113
Bond Position:  [3.20515208]


portfolio before change:  [2.42711933]
curr_Stock_Price:  103.72277097773889
curr_Factors:  [103.72277098  -0.95770594  -0.97764954]
mat_Sqrt:  [[14.97476115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01527929 0.2617717  0.6565755 ]
Stock Position:  0.015279285288742424
Bond Position:  [0.84230952]


portfolio before change:  [2.44247738]
curr_Stock_Price:  104.72103456585428
curr_Factors:  [104.72103457  -1.01997046  -0.98855379]
mat_Sqrt:  [[14.05215474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124661  0.01422087  0.07290997]
Stock Position:  -0.0012466113782086054
Bond Position:  [2.57302381]


portfolio before change:  [2.44261035]
curr_Stock_Price:  104.87238202359046
curr_Factors:  [104.87238202  -1.05313154  -0.98521037]
mat_Sqrt:  [[13.65904974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00548488 -0.04860816  0.30508339]
Stock Position:  0.005484876682064145
Bond Position:  [1.86739827]


portfolio before change:  [2.44031434]
curr_Stock_Price:  104.41121312692076
curr_Factors:  [104.41121313  -0.7571982   -0.99989674]
mat_Sqrt:  [[18.01567364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0021575   0.01916992 -0.08961985]
Stock Position:  -0.002157502653384144
Bond Position:  [2.66558181]


portfolio before change:  [2.44196226]
curr_Stock_Price:  103.80185127172594
curr_Factors:  [103.80185127  -0.25205012  -0.9828242 ]
mat_Sqrt:  [[30.19298121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00761426 -0.00578512  0.53815855]
Stock Position:  0.007614255213709418
Bond Position:  [1.65158847]


portfolio before change:  [2.43932155]
curr_Stock_Price:  103.4279248948942
curr_Factors:  [103.42792489  -0.39028977  -0.95606766]
mat_Sqrt:  [[26.9105273   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00263167 -0.02046225 -0.15752801]
Stock Position:  0.0026316717289734596
Bond Position:  [2.1671332]


portfolio before change:  [2.44056871]
curr_Stock_Price:  103.79888856325563
curr_Factors:  [103.79888856  -0.27284062  -0.91856335]
mat_Sqrt:  [[31.53352597  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00169525 -0.00197013  0.4740731 ]
Stock Position:  -0.0016952459713028417
Bond Position:  [2.61653336]


portfolio before change:  [2.44059398]
curr_Stock_Price:  103.97692301818347
curr_Factors:  [103.97692302  -0.17314387  -0.9359707 ]
mat_Sqrt:  [[34.29688063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00047224 0.01977656 0.00655032]
Stock Position:  0.0004722356295213344
Bond Position:  [2.39149238]


portfolio before change:  [2.44099731]
curr_Stock_Price:  104.1979353584317
curr_Factors:  [ 1.04197935e+02 -6.26766072e-02 -9.30503324e-01]
mat_Sqrt:  [[38.59460053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00292221 -0.01637735  0.84221524]
Stock Position:  0.002922212681755
Bond Position:  [2.13650878]


portfolio before change:  [2.43369631]
curr_Stock_Price:  101.60809111063547
curr_Factors:  [ 1.01608091e+02 -4.47776825e-02 -9.32857441e-01]
mat_Sqrt:  [[38.22493478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060118  0.01515177 -0.18321449]
Stock Position:  0.0006011794600352484
Bond Position:  [2.37261162]


portfolio before change:  [2.43183541]
curr_Stock_Price:  98.01931410761456
curr_Factors:  [ 9.80193141e+01  2.67739584e-02 -9.37858419e-01]
mat_Sqrt:  [[39.412384    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02258169 -0.01570944 -2.90378585]
Stock Position:  -0.02258169353842663
Bond Position:  [4.64527752]


portfolio before change:  [2.4678051]
curr_Stock_Price:  96.45215989725413
curr_Factors:  [96.4521599   0.13316374 -0.92331809]
mat_Sqrt:  [[43.7675548   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0030508  -0.03713622 -0.4108975 ]
Stock Position:  0.0030507967537282145
Bond Position:  [2.17354917]


portfolio before change:  [2.48119149]
curr_Stock_Price:  100.75093160289053
curr_Factors:  [100.7509316    0.20123155  -0.91693187]
mat_Sqrt:  [[49.25205651  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00069739 0.0297468  0.55036784]
Stock Position:  0.0006973905359128321
Bond Position:  [2.41092875]


portfolio before change:  [2.47834173]
curr_Stock_Price:  96.23244610360894
curr_Factors:  [96.2324461   0.36782673 -0.92640597]
mat_Sqrt:  [[55.04699813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050113  0.06883573 -0.19839174]
Stock Position:  0.0005011335354279252
Bond Position:  [2.43011642]


portfolio before change:  [2.47918091]
curr_Stock_Price:  97.30081651896111
curr_Factors:  [97.30081652  0.3988446  -0.94088485]
mat_Sqrt:  [[56.58631242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149644  0.00165972 -0.32655552]
Stock Position:  -0.0014964423187489567
Bond Position:  [2.62478597]


portfolio before change:  [2.48351825]
curr_Stock_Price:  94.62164461380894
curr_Factors:  [94.62164461  0.28442791 -0.94517517]
mat_Sqrt:  [[48.86879169  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004367   0.04721833  0.27102422]
Stock Position:  -0.0004366970423032319
Bond Position:  [2.52483924]


portfolio before change:  [2.48230609]
curr_Stock_Price:  98.12015195724783
curr_Factors:  [98.12015196  0.20347021 -0.97630094]
mat_Sqrt:  [[45.30249197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149573  0.0261848   0.41157767]
Stock Position:  -0.001495725961477337
Bond Position:  [2.62906695]


portfolio before change:  [2.48386948]
curr_Stock_Price:  97.29464254585537
curr_Factors:  [ 9.72946425e+01 -5.72742480e-03 -9.64256365e-01]
mat_Sqrt:  [[36.88334656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187759 -0.0306136   0.10329938]
Stock Position:  -0.001877590687801308
Bond Position:  [2.66654899]


portfolio before change:  [2.48714707]
curr_Stock_Price:  95.72653938602419
curr_Factors:  [ 9.57265394e+01 -2.93910671e-02 -9.85894849e-01]
mat_Sqrt:  [[34.68161303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0039163  0.03267868 0.10657287]
Stock Position:  0.003916298648805697
Bond Position:  [2.11225336]


portfolio before change:  [2.48049196]
curr_Stock_Price:  93.95977790288396
curr_Factors:  [ 9.39597779e+01 -7.56936097e-02 -9.85261264e-01]
mat_Sqrt:  [[32.52184192  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0024277   0.08514888  0.08375822]
Stock Position:  -0.0024276994327804995
Bond Position:  [2.70859806]


portfolio before change:  [2.4781446]
curr_Stock_Price:  95.0661540450857
curr_Factors:  [95.06615405 -0.28582924 -0.99539021]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.4781446]
Stock Price:  95.42797074922984
PL:  [2.4781446]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-7.43288364e-02 -2.12851452e-02 -2.15407307e-02]
 [-4.17504355e-02  2.73329184e-02 -7.30960633e-04]
 [ 3.09764788e-01 -2.17777706e-01 -4.28085542e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.14926722e+00 -3.26228741e-01 -4.41266335e-02]
 [-8.13975849e-02  3.01244977e-02  6.42389646e-02]
 [ 1.62398742e-04  1.74384576e-01  8.92843803e-02]
 [ 3.88472285e-01  2.46663784e-02 -1.08646773e-01]
 [-5.41030155e-01 -3.01842050e-02 -6.69148836e-02]
 [ 1.55191876e-02  3.68664460e-02 -1.60269830e-02]
 [-1.94490005e-02 -2.04458648e-01  1.13891183e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.56813656e-01 -7.22939332e-02  2.92834936e-01]
 [ 3.39067010e-02  3.36933222e-01  2.91129530e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-2.67861018e-02  1.96705402e-02  4.04224167e-02]
 [-4.89247434e-01 -2.52893566e-01  1.34349917e-01]
 [-1.41182167e-01  1.64672485e-03 -1.20593519e-02]
 [ 2.88425849e-01  1.18719233e+00  4.42169512e-01]
 [ 1.43798045e-02  6.68946136e-03  3.12597271e-02]
 [-3.62768784e-02 -1.73206866e-01  1.28060655e-03]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 7.93050506e-02 -3.59850927e-02  1.01742613e-01]
 [ 6.74570918e-02  1.80313462e-01  6.00410270e-02]
 [-5.96807097e-02 -1.89226262e-01 -3.59895315e-02]
 [ 4.21151019e-02  4.88749438e-02 -1.14070508e-02]
 [ 2.66223189e-02 -6.37957358e-02  6.35844628e-02]
 [ 3.49519345e-02  4.26904853e-02 -7.44460160e-02]
 [-6.47168195e-01 -2.68776147e-02 -9.47985573e-01]
 [-7.39097529e-02 -1.08884683e-01 -7.75326115e-03]
 [-5.17946187e-02  9.19467826e-02  2.29627010e-01]
 [ 2.13967558e-02  9.83848782e-02 -1.16234299e-02]
 [-1.34639375e-01 -1.61540289e-02 -1.26049310e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 2.30061752e-01 -1.74978621e-01 -7.40184950e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-9.04977341e-03 -1.01479419e-02 -4.60082665e-02]
 [-7.76378266e-02  4.60154556e-02 -3.18813060e-03]
 [-4.16959953e-02 -2.71513785e-01  1.32583812e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.54847077]
curr_Stock_Price:  100.57971194512933
curr_Factors:  [100.57971195  -1.19898359  -1.0031905 ]
mat_Sqrt:  [[11.12034676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00712886 -0.00673095 -0.06144971]
Stock Position:  -0.007128860406969183
Bond Position:  [7.2654895]


portfolio before change:  [6.54649661]
curr_Stock_Price:  100.9840407174358
curr_Factors:  [100.98404072  -1.04275825  -0.98849539]
mat_Sqrt:  [[13.24617524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310987  0.00864343 -0.00208523]
Stock Position:  -0.0031098719862911925
Bond Position:  [6.86054405]


portfolio before change:  [6.54520289]
curr_Stock_Price:  101.67581885726351
curr_Factors:  [101.67581886  -1.02017539  -1.01193254]
mat_Sqrt:  [[13.32552776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01626646 -0.06886736 -1.2212089 ]
Stock Position:  0.01626646239620974
Bond Position:  [4.89129701]


portfolio before change:  [6.54108489]
curr_Stock_Price:  101.3850702551972
curr_Factors:  [101.38507026  -1.09839955  -1.00984728]
mat_Sqrt:  [[12.31328805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00160015 -0.00659539  0.21422481]
Stock Position:  0.0016001456172485544
Bond Position:  [6.37885401]


portfolio before change:  [6.54316459]
curr_Stock_Price:  102.18643045447776
curr_Factors:  [102.18643045  -1.1556848   -1.0002156 ]
mat_Sqrt:  [[11.83307392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09859633 -0.10316259 -0.125881  ]
Stock Position:  -0.09859633482187719
Bond Position:  [16.6183721]


portfolio before change:  [6.5433968]
curr_Stock_Price:  102.20514524294846
curr_Factors:  [102.20514524  -1.28267735  -1.00553933]
mat_Sqrt:  [[10.36842721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00651083  0.0095262   0.18325589]
Stock Position:  -0.006510828362916927
Bond Position:  [7.20883696]


portfolio before change:  [6.54257897]
curr_Stock_Price:  102.4691658837268
curr_Factors:  [102.46916588  -1.41164489  -0.99030087]
mat_Sqrt:  [[ 9.27772324  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00246721 0.05514525 0.25470349]
Stock Position:  0.0024672095039681707
Bond Position:  [6.28976607]


portfolio before change:  [6.54210607]
curr_Stock_Price:  101.95880204231982
curr_Factors:  [101.95880204  -1.50718513  -0.99549077]
mat_Sqrt:  [[ 8.34692267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04396012  0.00780019 -0.309939  ]
Stock Position:  0.043960121914578175
Bond Position:  [2.0599847]


portfolio before change:  [6.55023438]
curr_Stock_Price:  102.13784603745255
curr_Factors:  [102.13784604  -1.35713799  -0.99114339]
mat_Sqrt:  [[ 9.75755593  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05692701 -0.00954508 -0.19088954]
Stock Position:  -0.056927006651044144
Bond Position:  [12.36463622]


portfolio before change:  [6.56058336]
curr_Stock_Price:  101.9832040888157
curr_Factors:  [101.98320409  -1.40253576  -0.97551536]
mat_Sqrt:  [[ 9.45701711  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139574  0.01165819 -0.04572052]
Stock Position:  0.001395744639606094
Bond Position:  [6.41824085]


portfolio before change:  [6.5609442]
curr_Stock_Price:  101.66689513344659
curr_Factors:  [101.66689513  -1.38518894  -0.94784558]
mat_Sqrt:  [[ 9.86178525  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.50090448e-04 -6.46555016e-02  3.24899844e-01]
Stock Position:  -0.00015009044777676583
Bond Position:  [6.57620343]


portfolio before change:  [6.56171576]
curr_Stock_Price:  102.00349810619785
curr_Factors:  [102.00349811  -1.37268907  -0.94698446]
mat_Sqrt:  [[10.02752274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00719277  0.00225658  0.15019092]
Stock Position:  -0.0071927654008712245
Bond Position:  [7.29540299]


portfolio before change:  [6.56858724]
curr_Stock_Price:  101.174956851075
curr_Factors:  [101.17495685  -1.26141491  -0.93190105]
mat_Sqrt:  [[11.28568719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01902602 -0.02286135  0.83537656]
Stock Position:  0.019026020466994586
Bond Position:  [4.64363044]


portfolio before change:  [6.58159145]
curr_Stock_Price:  101.82794250823542
curr_Factors:  [101.82794251  -1.3968322   -0.92477689]
mat_Sqrt:  [[ 9.99090783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01021257 0.10654764 0.83051151]
Stock Position:  0.010212570017693306
Bond Position:  [5.54166646]


portfolio before change:  [6.58392068]
curr_Stock_Price:  101.98818398732212
curr_Factors:  [101.98818399  -1.21385222  -0.95014521]
mat_Sqrt:  [[11.71487643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00366424 -0.03587186 -0.12433753]
Stock Position:  0.003664241265638659
Bond Position:  [6.21021137]


portfolio before change:  [6.58494682]
curr_Stock_Price:  102.05636185581612
curr_Factors:  [102.05636186  -1.2858485   -0.93849684]
mat_Sqrt:  [[11.03619023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00163345  0.00622037  0.1153139 ]
Stock Position:  -0.0016334458683106134
Bond Position:  [6.75165037]


portfolio before change:  [6.58683776]
curr_Stock_Price:  101.41543100478658
curr_Factors:  [101.415431    -1.09135145  -0.91653054]
mat_Sqrt:  [[13.61733032  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0343939  -0.07997197  0.38326292]
Stock Position:  -0.03439389697371367
Bond Position:  [10.07490965]


portfolio before change:  [6.59751383]
curr_Stock_Price:  101.14164323342818
curr_Factors:  [101.14164323  -1.06179423  -0.90353498]
mat_Sqrt:  [[14.17093075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01013351  0.00052074 -0.03440197]
Stock Position:  -0.010133508925638062
Bond Position:  [7.62243358]


portfolio before change:  [6.60152852]
curr_Stock_Price:  100.83949487936475
curr_Factors:  [100.83949488  -1.08689555  -0.91401618]
mat_Sqrt:  [[13.63470479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03002166 0.37542318 1.26138654]
Stock Position:  0.030021661868159553
Bond Position:  [3.5741593]


portfolio before change:  [6.62224168]
curr_Stock_Price:  101.51455284869162
curr_Factors:  [101.51455285  -1.01917456  -0.93723355]
mat_Sqrt:  [[14.35063313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00145871 0.00211539 0.0891753 ]
Stock Position:  0.0014587085117446297
Bond Position:  [6.47416154]


portfolio before change:  [6.62400527]
curr_Stock_Price:  102.16874506106922
curr_Factors:  [102.16874506  -0.93799814  -0.93472362]
mat_Sqrt:  [[15.70382078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0025782  -0.05477282  0.00365321]
Stock Position:  -0.0025782042690509145
Bond Position:  [6.88741717]


portfolio before change:  [6.62579756]
curr_Stock_Price:  101.8075240164888
curr_Factors:  [101.80752402  -0.90489114  -0.93527889]
mat_Sqrt:  [[16.16606     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240435  0.01916992 -0.08961985]
Stock Position:  -0.0024043498351091395
Bond Position:  [6.87057846]


portfolio before change:  [6.62692135]
curr_Stock_Price:  101.69734279161872
curr_Factors:  [101.69734279  -0.92521398  -0.93090298]
mat_Sqrt:  [[15.89308671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00623819 -0.01137949  0.29024336]
Stock Position:  0.006238186785425214
Bond Position:  [5.99251433]


portfolio before change:  [6.62120759]
curr_Stock_Price:  100.6613249661947
curr_Factors:  [100.66132497  -0.87943053  -0.93977917]
mat_Sqrt:  [[16.3226215   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00516881 0.05702012 0.17128034]
Stock Position:  0.0051688136430042214
Bond Position:  [6.10090796]


portfolio before change:  [6.61907569]
curr_Stock_Price:  100.1013207084574
curr_Factors:  [100.10132071  -0.72927133  -0.95102927]
mat_Sqrt:  [[18.65067394  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00385578 -0.0598386  -0.10266812]
Stock Position:  -0.003855777187217099
Bond Position:  [7.00504408]


portfolio before change:  [6.61789842]
curr_Stock_Price:  100.63375555743411
curr_Factors:  [100.63375556  -0.58939681  -0.94972718]
mat_Sqrt:  [[21.59288258  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00190102  0.01545561 -0.03254114]
Stock Position:  0.0019010242309188093
Bond Position:  [6.42659122]


portfolio before change:  [6.61783439]
curr_Stock_Price:  100.17746962782512
curr_Factors:  [100.17746963  -0.57924094  -0.92742191]
mat_Sqrt:  [[22.20417788  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00170933 -0.02017398  0.18138877]
Stock Position:  0.0017093289540990632
Bond Position:  [6.44659814]


portfolio before change:  [6.61841278]
curr_Stock_Price:  100.04438630197417
curr_Factors:  [100.0443863   -0.50904903  -0.89428422]
mat_Sqrt:  [[24.58854538  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084828  0.01349992 -0.21237376]
Stock Position:  0.0008482798950583103
Bond Position:  [6.53354714]


portfolio before change:  [6.6173221]
curr_Stock_Price:  97.79580958834514
curr_Factors:  [97.79580959 -0.32397547 -0.90372602]
mat_Sqrt:  [[28.65076776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02936637 -0.00849945 -2.70433897]
Stock Position:  -0.02936636544533631
Bond Position:  [9.48922958]


portfolio before change:  [6.56803864]
curr_Stock_Price:  99.51443180012143
curr_Factors:  [99.5144318  -0.33020191 -0.9106165 ]
mat_Sqrt:  [[28.77434722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027213  -0.03443236 -0.0221179 ]
Stock Position:  -0.00272130486843437
Bond Position:  [6.83884775]


portfolio before change:  [6.56565249]
curr_Stock_Price:  100.70542640000544
curr_Factors:  [100.7054264  -0.6442215  -0.9159867]
mat_Sqrt:  [[21.15743729  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.20437360e-04  2.90761257e-02  6.55061942e-01]
Stock Position:  -0.00012043736048608541
Bond Position:  [6.57778119]


portfolio before change:  [6.56633875]
curr_Stock_Price:  101.8347915657191
curr_Factors:  [101.83479157  -0.57775751  -0.92307528]
mat_Sqrt:  [[22.70349806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094983  0.03111203 -0.03315841]
Stock Position:  0.0009498280697140166
Bond Position:  [6.4696132]


portfolio before change:  [6.5666018]
curr_Stock_Price:  101.26026305661418
curr_Factors:  [101.26026306  -0.63973902  -0.9357391 ]
mat_Sqrt:  [[20.95161944  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00767416 -0.00510835 -0.3595836 ]
Stock Position:  -0.00767416470052869
Bond Position:  [7.34368973]


portfolio before change:  [6.55619238]
curr_Stock_Price:  102.73631066828378
curr_Factors:  [102.73631067  -0.53360187  -0.93594007]
mat_Sqrt:  [[23.63251881  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221786  0.0049611   0.16678008]
Stock Position:  -0.0022178636134889502
Bond Position:  [6.78404751]


portfolio before change:  [6.55723341]
curr_Stock_Price:  102.64930504121995
curr_Factors:  [102.64930504  -0.58930904  -0.93965451]
mat_Sqrt:  [[22.25028514  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00945763 -0.0553331  -0.21115416]
Stock Position:  0.009457625374375625
Bond Position:  [5.58641474]


portfolio before change:  [6.54090278]
curr_Stock_Price:  100.84875033262743
curr_Factors:  [100.84875033  -0.59274187  -0.93942204]
mat_Sqrt:  [[21.79014843  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00112491 0.00777784 0.21633947]
Stock Position:  0.0011249066855584821
Bond Position:  [6.42745735]


portfolio before change:  [6.54166187]
curr_Stock_Price:  100.80928627910161
curr_Factors:  [100.80928628  -0.69175612  -0.95117356]
mat_Sqrt:  [[19.49778365  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095925 -0.00320906 -0.13124878]
Stock Position:  -0.0009592469863588628
Bond Position:  [6.63836287]


portfolio before change:  [6.54286631]
curr_Stock_Price:  100.41877646458423
curr_Factors:  [100.41877646  -0.58451078  -0.94941114]
mat_Sqrt:  [[21.6591344   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355972  0.01455136 -0.00909485]
Stock Position:  -0.0035597215305939365
Bond Position:  [6.90032919]


portfolio before change:  [6.541341]
curr_Stock_Price:  101.08959060322512
curr_Factors:  [101.0895906   -0.81148316  -0.95735399]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.541341]
Stock Price:  101.76343831712859
PL:  [4.77790268]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.31140804e-01  1.88481952e-01  1.96122145e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 1.77046916e-01  2.44979900e-01  3.81160815e-01]
 [-7.17758801e-02  3.21840933e-02  9.87643739e-02]
 [-5.97292630e-01 -1.82339074e-01  3.80572928e-02]
 [ 3.87810794e-02 -1.62879620e-01 -2.17307605e-01]
 [ 3.38563165e-02 -2.68290086e-03 -2.37527383e-02]
 [ 3.22921837e-01  3.75766597e-02 -8.52495315e-02]
 [-4.49584368e-01 -2.47418780e-02 -4.91464924e-02]
 [ 2.46659431e-02  2.13270918e-02 -2.33086318e-02]
 [-7.42382872e-03 -2.34100225e-01  1.21268731e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.64016847e-01 -8.08889341e-02  2.91429993e-01]
 [ 8.34931208e-02  1.23672867e-01  8.73362971e-02]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-4.81222497e-02  7.27767871e-02  4.86699432e-02]
 [-4.53210341e-01 -2.34599580e-01  1.18738714e-01]
 [-1.41710806e-01 -2.08719202e-03 -1.23797473e-02]
 [ 1.65284991e-01  8.46620272e-01  1.60744720e-01]
 [-4.14900741e-02 -1.02145645e-02  5.29273854e-02]
 [-3.40042904e-02 -1.08449175e-01  1.84811099e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 2.05069206e-01 -1.23743070e-02  1.98194563e-01]
 [ 6.66785162e-02 -1.60317115e-01 -5.45360845e-02]
 [-1.19949027e-01  2.29040224e-01  2.11810597e-01]
 [ 7.30714596e-03  6.16745493e-02  5.77645078e-02]
 [-1.07316870e-01 -9.97595240e-02  3.03969621e-01]
 [ 1.29605355e-01  8.40346490e-02 -9.89389919e-02]
 [-9.44043303e-01 -1.45221340e-01 -1.28168071e+00]
 [ 1.37900336e-01 -4.24411162e-01  4.19924979e-01]
 [-2.18956990e-01 -2.80193545e-01  1.56529528e-01]
 [ 1.14120379e-01  3.61751668e-01 -8.97868401e-02]
 [-8.80348293e-02  4.81621296e-03  6.37538653e-02]
 [-3.99920920e-03  4.31360343e-01 -4.35968225e-02]
 [ 3.74982266e-02 -1.38046204e-01 -1.45803913e-01]
 [-5.52722533e-02  3.68446669e-01  8.72377634e-02]
 [ 2.76509817e-01  1.91105463e-01  2.04804802e-02]
 [ 5.03154243e-02  2.44355495e-02 -1.40208004e-02]
 [-1.56946568e-01 -3.32405662e-01  6.90151440e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.05031914]
curr_Stock_Price:  99.38164284039638
curr_Factors:  [99.38164284 -1.09561596 -0.98533801]
mat_Sqrt:  [[12.40393111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00695271  0.05960323  0.55948189]
Stock Position:  -0.006952711578183373
Bond Position:  [-1.35934725]


portfolio before change:  [-2.05280939]
curr_Stock_Price:  99.71537119443
curr_Factors:  [99.71537119 -1.05683014 -0.9755329 ]
mat_Sqrt:  [[13.06525992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347341  0.01411938  0.0859571 ]
Stock Position:  -0.0034734129385874182
Bond Position:  [-1.70645673]


portfolio before change:  [-2.05059769]
curr_Stock_Price:  99.01720433873169
curr_Factors:  [99.01720434 -1.31530989 -0.95116333]
mat_Sqrt:  [[10.26582471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02544135 0.07746945 1.08734571]
Stock Position:  0.025441345761720646
Bond Position:  [-4.56972862]


portfolio before change:  [-2.05587839]
curr_Stock_Price:  98.83209437193226
curr_Factors:  [98.83209437 -1.11817017 -0.93974209]
mat_Sqrt:  [[12.62286857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00402323  0.0101775   0.28174727]
Stock Position:  -0.004023229478869995
Bond Position:  [-1.65825419]


portfolio before change:  [-2.05472106]
curr_Stock_Price:  98.4929072944492
curr_Factors:  [98.49290729 -1.22478587 -0.91450662]
mat_Sqrt:  [[11.59636917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05124295 -0.05766068  0.10856686]
Stock Position:  -0.051242952257394524
Bond Position:  [2.99234629]


portfolio before change:  [-2.04688134]
curr_Stock_Price:  98.34721597379486
curr_Factors:  [98.34721597 -1.17458703 -0.90443981]
mat_Sqrt:  [[12.29850107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007954  -0.05150706 -0.61991811]
Stock Position:  -0.0007953963988900287
Bond Position:  [-1.96865631]


portfolio before change:  [-2.04829954]
curr_Stock_Price:  99.82082771764348
curr_Factors:  [99.82082772 -1.14344607 -0.88868288]
mat_Sqrt:  [[13.08213944  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00221206 -0.00084841 -0.06775995]
Stock Position:  0.002212064547077539
Bond Position:  [-2.26910965]


portfolio before change:  [-2.04830551]
curr_Stock_Price:  99.94635862958694
curr_Factors:  [99.94635863 -1.17710861 -0.90053618]
mat_Sqrt:  [[12.51576241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02448837  0.01188278 -0.24319318]
Stock Position:  0.024488366260237333
Bond Position:  [-4.49582855]


portfolio before change:  [-2.03254767]
curr_Stock_Price:  100.61279171019105
curr_Factors:  [100.61279171  -1.28320835  -0.8790609 ]
mat_Sqrt:  [[11.57688177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0397564  -0.00782407 -0.14020126]
Stock Position:  -0.03975640380192916
Bond Position:  [1.96745511]


portfolio before change:  [-2.06500893]
curr_Stock_Price:  101.43548197663291
curr_Factors:  [101.43548198  -1.45981272  -0.9102388 ]
mat_Sqrt:  [[ 9.48177393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215769  0.00674422 -0.06649304]
Stock Position:  0.002157692419327076
Bond Position:  [-2.2838755]


portfolio before change:  [-2.06512216]
curr_Stock_Price:  101.51532114159312
curr_Factors:  [101.51532114  -1.21761233  -0.9245162 ]
mat_Sqrt:  [[11.91837348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094691 -0.07402899  0.34594593]
Stock Position:  0.0009469081893887055
Bond Position:  [-2.16124785]


portfolio before change:  [-2.06540744]
curr_Stock_Price:  101.49936922007527
curr_Factors:  [101.49936922  -1.0499042   -0.93690563]
mat_Sqrt:  [[13.91883222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00518187  0.00225658  0.15019092]
Stock Position:  -0.005181872834924958
Bond Position:  [-1.53945062]


portfolio before change:  [-2.06227665]
curr_Stock_Price:  100.85805016672496
curr_Factors:  [100.85805017  -1.0403029   -0.88671551]
mat_Sqrt:  [[14.68307797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01507969 -0.02557933  0.83136865]
Stock Position:  0.015079685755323178
Bond Position:  [-3.58318435]


portfolio before change:  [-2.07131186]
curr_Stock_Price:  100.28858950512115
curr_Factors:  [100.28858951  -0.60798667  -0.89540852]
mat_Sqrt:  [[22.30156241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00468639 0.03910879 0.24914615]
Stock Position:  0.004686388587093558
Bond Position:  [-2.54130316]


portfolio before change:  [-2.0635436]
curr_Stock_Price:  102.0140007749486
curr_Factors:  [102.01400077  -0.62273667  -0.91746899]
mat_Sqrt:  [[21.86537652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0019632  -0.03587186 -0.12433753]
Stock Position:  0.001963201208838369
Bond Position:  [-2.26381761]


portfolio before change:  [-2.06387466]
curr_Stock_Price:  101.98951581454706
curr_Factors:  [101.98951581  -0.67211699  -0.92019841]
mat_Sqrt:  [[20.75017377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174979  0.02301404  0.1388418 ]
Stock Position:  -0.001749790191149269
Bond Position:  [-1.88541441]


portfolio before change:  [-2.06357378]
curr_Stock_Price:  101.6828668268784
curr_Factors:  [101.68286683  -0.79443661  -0.90866273]
mat_Sqrt:  [[18.51830097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02349191 -0.0741869   0.3387285 ]
Stock Position:  -0.023491908814346624
Bond Position:  [0.32515085]


portfolio before change:  [-2.07186589]
curr_Stock_Price:  102.0375741250408
curr_Factors:  [102.03757413  -0.60812556  -0.89303902]
mat_Sqrt:  [[22.74116104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00634496 -0.00066003 -0.03531597]
Stock Position:  -0.006344957586035433
Bond Position:  [-1.42444181]


portfolio before change:  [-2.07171713]
curr_Stock_Price:  101.98606565420721
curr_Factors:  [101.98606565  -0.47467133  -0.89326945]
mat_Sqrt:  [[25.96878931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00847003 0.26772484 0.45855994]
Stock Position:  0.008470033349419901
Bond Position:  [-2.93554251]


portfolio before change:  [-2.07382073]
curr_Stock_Price:  101.78103305778853
curr_Factors:  [101.78103306  -0.29440483  -0.86657811]
mat_Sqrt:  [[31.87560022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00097096 -0.00323013  0.1509871 ]
Stock Position:  -0.0009709638553770924
Bond Position:  [-1.97499503]


portfolio before change:  [-2.07478314]
curr_Stock_Price:  102.51795244324357
curr_Factors:  [102.51795244  -0.37547856  -0.8796248 ]
mat_Sqrt:  [[29.22237153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113037 -0.03429464  0.05272146]
Stock Position:  -0.001130366686461795
Bond Position:  [-1.95890027]


portfolio before change:  [-2.0764614]
curr_Stock_Price:  103.78601301982354
curr_Factors:  [103.78601302  -0.47981765  -0.89492183]
mat_Sqrt:  [[26.24805082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148083  0.01916992 -0.08961985]
Stock Position:  -0.0014808285747589856
Bond Position:  [-1.9227721]


portfolio before change:  [-2.07756264]
curr_Stock_Price:  104.36736554659394
curr_Factors:  [104.36736555  -0.36852183  -0.92239366]
mat_Sqrt:  [[28.70299705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00854287 -0.0039131   0.56539392]
Stock Position:  0.008542870922285404
Bond Position:  [-2.96915957]


portfolio before change:  [-2.05376331]
curr_Stock_Price:  107.19668368762017
curr_Factors:  [107.19668369  -0.45766348  -0.942591  ]
mat_Sqrt:  [[26.42765046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0019452  -0.05069672 -0.15557627]
Stock Position:  0.0019451980623869036
Bond Position:  [-2.26228209]


portfolio before change:  [-2.05401341]
curr_Stock_Price:  107.2134931328918
curr_Factors:  [107.21349313  -0.41481791  -0.93521671]
mat_Sqrt:  [[27.79309154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254738  0.07242888  0.60423668]
Stock Position:  -0.0025473804096116594
Bond Position:  [-1.78089986]


portfolio before change:  [-2.05707157]
curr_Stock_Price:  108.32660979223755
curr_Factors:  [108.32660979  -0.52060244  -0.95025185]
mat_Sqrt:  [[24.88577961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00083143 0.0195032  0.16478606]
Stock Position:  0.0008314269068388986
Bond Position:  [-2.14713723]


portfolio before change:  [-2.05780684]
curr_Stock_Price:  107.76509104809753
curr_Factors:  [107.76509105  -0.61172266  -0.95991874]
mat_Sqrt:  [[22.38323782  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213754 -0.03154673  0.86714072]
Stock Position:  -0.0021375419934263964
Bond Position:  [-1.82745444]


portfolio before change:  [-2.06011601]
curr_Stock_Price:  108.73850872527642
curr_Factors:  [108.73850873  -0.59556212  -0.995266  ]
mat_Sqrt:  [[22.15621128  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00503603  0.02657409 -0.2822454 ]
Stock Position:  0.0050360272196153825
Bond Position:  [-2.6077261]


portfolio before change:  [-2.05304447]
curr_Stock_Price:  110.20743048341883
curr_Factors:  [110.20743048  -0.47175898  -0.96893694]
mat_Sqrt:  [[26.09303463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0463501  -0.04592302 -3.65627832]
Stock Position:  -0.04635010449829901
Bond Position:  [3.05508145]


portfolio before change:  [-2.12690083]
curr_Stock_Price:  111.80911560350202
curr_Factors:  [111.8091156   -0.92913421  -0.96809314]
mat_Sqrt:  [[16.76956682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01268124 -0.13421059  1.19792908]
Stock Position:  0.012681240763898637
Bond Position:  [-3.54477914]


portfolio before change:  [-2.13385046]
curr_Stock_Price:  111.29603473567381
curr_Factors:  [111.29603474  -0.83296297  -0.96676553]
mat_Sqrt:  [[18.40210644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01055532 -0.08860498  0.44653518]
Stock Position:  -0.01055531881123983
Bond Position:  [-0.95908533]


portfolio before change:  [-2.12568648]
curr_Stock_Price:  110.5112297411713
curr_Factors:  [110.51122974  -0.51932049  -0.98709263]
mat_Sqrt:  [[24.50075716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00429101  0.11439592 -0.25613686]
Stock Position:  0.0042910145413119685
Bond Position:  [-2.59989178]


portfolio before change:  [-2.12834143]
curr_Stock_Price:  109.9682490734902
curr_Factors:  [109.96824907  -0.49713518  -0.97607327]
mat_Sqrt:  [[25.20350902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297168  0.00152302  0.18187203]
Stock Position:  -0.002971680327182599
Bond Position:  [-1.80155095]


portfolio before change:  [-2.13286032]
curr_Stock_Price:  111.41311621988666
curr_Factors:  [111.41311622  -0.44532382  -0.95922049]
mat_Sqrt:  [[27.34956858  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.43775115e-05  1.36408118e-01 -1.24369600e-01]
Stock Position:  -6.437751151754873e-05
Bond Position:  [-2.12568782]


portfolio before change:  [-2.13307553]
curr_Stock_Price:  110.62847073568125
curr_Factors:  [110.62847074  -0.22996406  -0.97047883]
mat_Sqrt:  [[33.30590097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.25256780e-04 -4.36540428e-02 -4.15937979e-01]
Stock Position:  0.00012525678023042304
Bond Position:  [-2.1469325]


portfolio before change:  [-2.1334724]
curr_Stock_Price:  109.60271989375616
curr_Factors:  [109.60271989  -0.37187083  -0.99252827]
mat_Sqrt:  [[28.00724125  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00099802  0.11651307  0.24886506]
Stock Position:  -0.00099801573090109
Bond Position:  [-2.02408716]


portfolio before change:  [-2.13564361]
curr_Stock_Price:  111.52472107438167
curr_Factors:  [111.52472107  -0.49615471  -0.99505669]
mat_Sqrt:  [[25.10419296  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01137757 0.06043285 0.05842511]
Stock Position:  0.011377569473892176
Bond Position:  [-3.40452388]


portfolio before change:  [-2.14176522]
curr_Stock_Price:  111.02408587610502
curr_Factors:  [111.02408588  -0.55238275  -1.01311453]
mat_Sqrt:  [[23.20226456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0020724   0.0077272  -0.03999744]
Stock Position:  0.002072399589587121
Bond Position:  [-2.37185149]


portfolio before change:  [-2.14662844]
curr_Stock_Price:  108.82049378798217
curr_Factors:  [108.82049379  -0.65077219  -0.98824585]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.14662844]
Stock Price:  108.23574947529593
PL:  [-10.38237792]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.42461419e-01 -5.52429225e-03  6.27569605e-02]
 [-9.77277022e-02 -3.28308699e-03  1.45456093e-01]
 [ 1.78241573e-01  2.25787992e-01  3.49449236e-01]
 [-9.04914872e-03  1.19960152e-02  1.06345482e-01]
 [-7.12236300e-01 -2.14898213e-01  3.52483648e-02]
 [ 8.27581032e-03 -1.20242840e-01 -1.50611724e-01]
 [ 3.53581382e-02 -3.77636172e-02 -2.52713057e-02]
 [ 2.51319558e-01  3.31652871e-02 -5.78396047e-02]
 [-2.99256668e-01  1.68870392e-03 -9.35541189e-02]
 [ 3.83861043e-02 -1.98198701e-03 -3.42311272e-02]
 [ 1.23796042e-02 -2.55109736e-01  7.05783117e-02]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.77930936e-01 -1.02886387e-01  2.65631988e-01]
 [ 5.28120927e-02  2.43689041e-01  2.00871427e-01]
 [ 6.82763375e-02 -1.13184428e-01 -4.96871120e-02]
 [-1.58185575e-02 -7.62797294e-03  3.61828926e-02]
 [-5.78411198e-01 -2.73632354e-01  1.70352170e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 2.67355492e-01  1.06157829e+00  4.33496449e-01]
 [ 6.90318230e-03  4.07115915e-03  3.43061007e-02]
 [-4.10487110e-02 -1.41322801e-01 -1.27837080e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 6.34073689e-02 -3.44629749e-02  8.40721087e-02]
 [ 4.26411807e-02  1.67673637e-01  1.03809399e-01]
 [-5.49160684e-02 -2.00006254e-01 -1.04527878e-02]
 [ 1.09737460e-01 -2.04574829e-03 -8.95324904e-03]
 [ 4.86453979e-03 -4.49197166e-02 -2.57672059e-02]
 [ 3.91179697e-03  4.17072805e-02 -1.45757430e-02]
 [-6.28910841e-01  5.35211113e-02 -8.43164245e-01]
 [-2.29569563e-02 -1.12426776e-01 -3.57331169e-02]
 [ 1.20504288e-02  5.71800964e-02  9.77661507e-02]
 [ 2.15540778e-02  1.17088496e-01 -2.12087183e-02]
 [-1.28889956e-01 -1.15760448e-02 -1.41601829e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 2.12257872e-01 -1.71676643e-01 -8.08323296e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [ 1.44046649e-02  6.73354821e-03 -2.90509710e-02]
 [-7.21209801e-02  6.47395611e-02 -4.23390469e-03]
 [-2.70454986e-02 -2.68006866e-01  1.10695188e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.03039999]
curr_Stock_Price:  99.9502092983533
curr_Factors:  [99.9502093  -1.06763782 -0.9822863 ]
mat_Sqrt:  [[12.86805694  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01008651 -0.00174693  0.17902814]
Stock Position:  -0.010086514609703733
Bond Position:  [3.03854924]


portfolio before change:  [2.04167629]
curr_Stock_Price:  98.86991013725817
curr_Factors:  [98.86991014 -1.42106129 -0.93219128]
mat_Sqrt:  [[ 9.39852131  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00724809 -0.0010382   0.41494575]
Stock Position:  -0.007248094496324869
Bond Position:  [2.75829474]


portfolio before change:  [2.03936169]
curr_Stock_Price:  99.23682090825403
curr_Factors:  [99.23682091 -1.38537885 -0.92813733]
mat_Sqrt:  [[ 9.81579617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02601953 0.07140043 0.9968814 ]
Stock Position:  0.026019531792367163
Bond Position:  [-0.54273392]


portfolio before change:  [2.05791799]
curr_Stock_Price:  99.95259626257612
curr_Factors:  [99.95259626 -1.28473747 -0.93736861]
mat_Sqrt:  [[10.83292329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00119712 0.00379347 0.30337406]
Stock Position:  0.0011971161814810232
Bond Position:  [1.93826312]


portfolio before change:  [2.05729874]
curr_Stock_Price:  99.23290904648059
curr_Factors:  [99.23290905 -1.184698   -0.93194717]
mat_Sqrt:  [[11.95111444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05945805 -0.06795678  0.10055377]
Stock Position:  -0.05945804545888007
Bond Position:  [7.95749355]


portfolio before change:  [2.06369293]
curr_Stock_Price:  99.14209806079123
curr_Factors:  [99.14209806 -1.07806085 -0.9209344 ]
mat_Sqrt:  [[13.43091189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190399 -0.03802412 -0.42965333]
Stock Position:  -0.001903991033602698
Bond Position:  [2.25245859]


portfolio before change:  [2.06309749]
curr_Stock_Price:  99.60271603552783
curr_Factors:  [99.60271604 -0.80249212 -0.92770593]
mat_Sqrt:  [[17.65451189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165536 -0.0119419  -0.072092  ]
Stock Position:  0.0016553616601465203
Bond Position:  [1.89821897]


portfolio before change:  [2.06370418]
curr_Stock_Price:  99.82586622502542
curr_Factors:  [99.82586623 -0.86778377 -0.92782984]
mat_Sqrt:  [[16.57364392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01450311  0.01048778 -0.16500029]
Stock Position:  0.014503112514018314
Bond Position:  [0.61591841]


portfolio before change:  [2.05586481]
curr_Stock_Price:  99.28002763017467
curr_Factors:  [99.28002763 -0.95359029 -0.91832463]
mat_Sqrt:  [[15.27212857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02084252  0.00053402 -0.26688386]
Stock Position:  -0.02084252493067135
Bond Position:  [4.12511126]


portfolio before change:  [2.02804952]
curr_Stock_Price:  100.63931406588173
curr_Factors:  [100.63931407  -1.31149253  -0.9174667 ]
mat_Sqrt:  [[10.8328561   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00289375 -0.00062676 -0.09765188]
Stock Position:  0.0028937456371183868
Bond Position:  [1.73682495]


portfolio before change:  [2.02672117]
curr_Stock_Price:  100.10524189880651
curr_Factors:  [100.1052419   -1.27302216  -0.91289114]
mat_Sqrt:  [[11.24933202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00179561 -0.08067278  0.20134028]
Stock Position:  0.0017956121028373496
Bond Position:  [1.84697099]


portfolio before change:  [2.02723467]
curr_Stock_Price:  100.26263414468275
curr_Factors:  [100.26263414  -1.35065913  -0.88210593]
mat_Sqrt:  [[10.7513144   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00670854  0.00225658  0.15019092]
Stock Position:  -0.006708539615671923
Bond Position:  [2.69985053]


portfolio before change:  [2.02372577]
curr_Stock_Price:  100.83599398360295
curr_Factors:  [100.83599398  -1.34740656  -0.89643825]
mat_Sqrt:  [[10.69365488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02146098 -0.03253553  0.75777412]
Stock Position:  0.02146098089274886
Bond Position:  [-0.14031357]


portfolio before change:  [2.02471546]
curr_Stock_Price:  100.88292733162477
curr_Factors:  [100.88292733  -1.26093327  -0.89645393]
mat_Sqrt:  [[11.66477373  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00858198 0.07706124 0.57303027]
Stock Position:  0.008581977438224673
Bond Position:  [1.15894046]


portfolio before change:  [2.02918814]
curr_Stock_Price:  101.38721684647426
curr_Factors:  [101.38721685  -1.28465887  -0.89843564]
mat_Sqrt:  [[11.42555497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00483229 -0.03579206 -0.1417435 ]
Stock Position:  0.004832289460867985
Bond Position:  [1.53925576]


portfolio before change:  [2.03590813]
curr_Stock_Price:  102.73804076923304
curr_Factors:  [102.73804077  -1.34872075  -0.9138745 ]
mat_Sqrt:  [[10.6929774   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080704 -0.00241218  0.10321972]
Stock Position:  -0.0008070445266339554
Bond Position:  [2.11882231]


portfolio before change:  [2.03614062]
curr_Stock_Price:  102.77816088210942
curr_Factors:  [102.77816088  -1.55492922  -0.90172699]
mat_Sqrt:  [[ 8.8102576   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06250707 -0.08653015  0.48596732]
Stock Position:  -0.06250706722000614
Bond Position:  [8.46050203]


portfolio before change:  [2.02632539]
curr_Stock_Price:  102.95210691055121
curr_Factors:  [102.95210691  -1.59763674  -0.86472942]
mat_Sqrt:  [[ 8.77492069  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01496436  0.00580111 -0.05715682]
Stock Position:  -0.014964361322242563
Bond Position:  [3.56693792]


portfolio before change:  [2.03958651]
curr_Stock_Price:  102.09572448966875
curr_Factors:  [102.09572449  -1.30303782  -0.86639548]
mat_Sqrt:  [[11.66365444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03285869 0.33570053 1.23664471]
Stock Position:  0.03285869106586469
Bond Position:  [-1.31514536]


portfolio before change:  [2.01585689]
curr_Stock_Price:  101.37855618450587
curr_Factors:  [101.37855618  -1.1937128   -0.84648166]
mat_Sqrt:  [[13.1795599   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00106309 0.00128741 0.09786576]
Stock Position:  0.0010630857746807977
Bond Position:  [1.90808279]


portfolio before change:  [2.01644832]
curr_Stock_Price:  101.71051388765183
curr_Factors:  [101.71051389  -1.20556686  -0.85367351]
mat_Sqrt:  [[12.97325992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364651 -0.04469019 -0.03646836]
Stock Position:  -0.0036465093441352524
Bond Position:  [2.38733665]


portfolio before change:  [2.01522722]
curr_Stock_Price:  102.1272230532103
curr_Factors:  [102.12722305  -1.14689464  -0.88117414]
mat_Sqrt:  [[13.43886044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00289227  0.01916992 -0.08961985]
Stock Position:  -0.0028922737797693115
Bond Position:  [2.31060711]


portfolio before change:  [2.01797806]
curr_Stock_Price:  101.2759899725294
curr_Factors:  [101.27598997  -1.01712087  -0.86817239]
mat_Sqrt:  [[15.37212956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00518332 -0.01089815  0.23983432]
Stock Position:  0.00518332126391779
Bond Position:  [1.49303207]


portfolio before change:  [2.00908154]
curr_Stock_Price:  99.5236074577831
curr_Factors:  [99.52360746 -0.86522671 -0.84446314]
mat_Sqrt:  [[18.0059997   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00378543 0.05302306 0.29613932]
Stock Position:  0.003785432710775308
Bond Position:  [1.63234162]


portfolio before change:  [2.01265574]
curr_Stock_Price:  100.41390124901848
curr_Factors:  [100.41390125  -0.67207391  -0.8456952 ]
mat_Sqrt:  [[22.0107627   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282652 -0.06324753 -0.02981889]
Stock Position:  -0.0028265205922251156
Bond Position:  [2.2964777]


portfolio before change:  [2.01603539]
curr_Stock_Price:  99.3197748360044
curr_Factors:  [99.31977484 -0.87165509 -0.87516649]
mat_Sqrt:  [[17.31413323  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00622942 -0.00064692 -0.02554113]
Stock Position:  0.006229423296815591
Bond Position:  [1.39733047]


portfolio before change:  [2.01322114]
curr_Stock_Price:  98.83996720432353
curr_Factors:  [98.8399672  -1.19365885 -0.86250275]
mat_Sqrt:  [[12.64599349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00012296 -0.01420486 -0.07350667]
Stock Position:  -0.00012296314896960406
Bond Position:  [2.02537482]


portfolio before change:  [2.01343248]
curr_Stock_Price:  99.18032472380007
curr_Factors:  [99.18032472 -1.22302352 -0.8780371 ]
mat_Sqrt:  [[12.13239357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00016595  0.013189   -0.04158054]
Stock Position:  0.00016595350579792117
Bond Position:  [1.99697316]


portfolio before change:  [2.0136413]
curr_Stock_Price:  98.93439619428169
curr_Factors:  [98.93439619 -1.12488798 -0.86977203]
mat_Sqrt:  [[13.46100448  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05940412  0.01692486 -2.4053129 ]
Stock Position:  -0.05940411900324556
Bond Position:  [7.89075195]


portfolio before change:  [2.02708672]
curr_Stock_Price:  98.72466305972398
curr_Factors:  [98.72466306 -0.67759582 -0.8747413 ]
mat_Sqrt:  [[20.90519461  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158591 -0.03555247 -0.10193664]
Stock Position:  -0.001585911814221638
Bond Position:  [2.18365533]


portfolio before change:  [2.02701701]
curr_Stock_Price:  98.94074133429636
curr_Factors:  [98.94074133 -0.45842516 -0.86023819]
mat_Sqrt:  [[26.46591671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00126515 0.01808193 0.27889961]
Stock Position:  0.0012651458414002952
Bond Position:  [1.90184255]


portfolio before change:  [2.02807583]
curr_Stock_Price:  99.58973574926553
curr_Factors:  [99.58973575 -0.62218582 -0.85910018]
mat_Sqrt:  [[22.64124192  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0008943   0.03702663 -0.06050257]
Stock Position:  0.0008943006911223139
Bond Position:  [1.93901266]


portfolio before change:  [2.0287374]
curr_Stock_Price:  100.05845115577411
curr_Factors:  [100.05845116  -0.78722036  -0.8631298 ]
mat_Sqrt:  [[19.20948895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00822995 -0.00366067 -0.4039506 ]
Stock Position:  -0.008229953497655158
Bond Position:  [2.8522138]


portfolio before change:  [2.02371021]
curr_Stock_Price:  100.71261507619356
curr_Factors:  [100.71261508  -0.61298503  -0.85612752]
mat_Sqrt:  [[23.1769561   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226146  0.0049611   0.16678008]
Stock Position:  -0.002261457602063026
Bond Position:  [2.25146752]


portfolio before change:  [2.01817991]
curr_Stock_Price:  103.28252957433429
curr_Factors:  [103.28252957  -0.71565647  -0.86059731]
mat_Sqrt:  [[21.35347444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00895992 -0.05428892 -0.23059214]
Stock Position:  0.00895991754658369
Bond Position:  [1.09277696]


portfolio before change:  [2.00040537]
curr_Stock_Price:  101.28350019920411
curr_Factors:  [101.2835002   -0.6549875   -0.86865862]
mat_Sqrt:  [[22.07128408  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00111058 0.00777784 0.21633947]
Stock Position:  0.0011105780506772758
Bond Position:  [1.88792214]


portfolio before change:  [1.99882261]
curr_Stock_Price:  99.64582664212975
curr_Factors:  [99.64582664 -0.72392964 -0.83345574]
mat_Sqrt:  [[20.99400215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00041195  0.00212933 -0.08287433]
Stock Position:  0.00041195193082686586
Bond Position:  [1.95777332]


portfolio before change:  [1.99929153]
curr_Stock_Price:  100.19001163033826
curr_Factors:  [100.19001163  -0.44613331  -0.84626821]
mat_Sqrt:  [[27.5132298   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259198  0.02047245 -0.01207815]
Stock Position:  -0.0025919768227679746
Bond Position:  [2.25898172]


portfolio before change:  [1.99926716]
curr_Stock_Price:  100.3083603823718
curr_Factors:  [100.30836038  -0.40487891  -0.87690699]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.99926716]
Stock Price:  98.60902447314326
PL:  [1.99926716]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.79350745e-02  1.53028388e-02  3.45175719e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.14099400e-01 -1.57613594e-01 -2.79523192e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-6.08787891e-01 -1.85595242e-01  3.77763781e-02]
 [ 7.69280933e-03 -1.19124555e-01 -1.48915830e-01]
 [ 3.37375835e-02  3.71395494e-03 -2.28638294e-02]
 [ 3.48110990e-01  1.53517346e-02 -9.25128953e-02]
 [-3.04730041e-01  1.10433733e-03 -9.35286780e-02]
 [ 5.01155715e-02 -2.19090907e-02 -4.35688492e-02]
 [ 7.73589906e-02 -2.73436372e-01  1.83020284e-02]
 [ 2.96236783e-02 -6.62045436e-03 -8.27927645e-03]
 [ 1.75073407e-01 -1.00374416e-01  2.62348182e-01]
 [ 6.60289009e-02  1.68104049e-01  1.26605495e-01]
 [ 4.99464405e-02 -1.05797469e-01 -5.85213974e-02]
 [-1.46828545e-02 -1.28907398e-01 -1.60046574e-02]
 [-4.17630708e-01 -2.48807392e-01  1.06777467e-01]
 [-1.49047255e-01 -3.30305361e-02 -1.26978553e-02]
 [ 2.06881313e-01  9.86035566e-01  2.41801594e-01]
 [ 1.15154283e-03  1.99195749e-02  2.92891872e-02]
 [-9.06742936e-03 -2.00055659e-01  4.11627763e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 2.14146122e-01 -8.30579687e-03  2.04755998e-01]
 [ 6.64686484e-02 -1.59453523e-01 -5.38300655e-02]
 [-1.20625967e-01  2.35565331e-01  2.24374306e-01]
 [ 8.56444457e-03  6.12865627e-02  5.73334173e-02]
 [-1.48877936e-01 -1.25457846e-01  3.11541692e-01]
 [ 1.27121575e-01  8.32632052e-02 -9.81174745e-02]
 [-8.11050518e-01 -1.14857540e-01 -1.11707292e+00]
 [ 1.44520052e-02 -1.87545974e-01  2.17200028e-01]
 [-1.77822669e-01 -1.46754179e-01  1.40497478e-01]
 [ 6.47521169e-02  2.52691218e-01 -4.32934161e-02]
 [-9.83440450e-02  1.77464931e-04  2.17682214e-02]
 [-1.46040553e-02  3.09427507e-01 -7.07487108e-04]
 [ 3.31963600e-02 -1.31827026e-01 -1.37945200e-01]
 [-5.97119718e-02  3.86528293e-01  8.78285250e-02]
 [ 1.80021080e-01  1.30324321e-01 -4.93721191e-03]
 [ 1.59934791e-02  4.48985516e-02 -1.25616405e-02]
 [-1.68276541e-01 -3.60999660e-01  7.50987339e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.93859776]
curr_Stock_Price:  100.49473836000224
curr_Factors:  [100.49473836  -0.93097821  -1.0127521 ]
mat_Sqrt:  [[14.38771992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00628968  0.00483918  0.09846902]
Stock Position:  -0.006289675329698402
Bond Position:  [6.57067704]


portfolio before change:  [5.93812833]
curr_Stock_Price:  100.69996630535057
curr_Factors:  [100.69996631  -1.17475063  -1.0088713 ]
mat_Sqrt:  [[11.34212348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00400111  0.01411938  0.0859571 ]
Stock Position:  -0.004001106401349992
Bond Position:  [6.34103961]


portfolio before change:  [5.93858532]
curr_Stock_Price:  100.78386581680772
curr_Factors:  [100.78386582  -1.36379035  -1.00243378]
mat_Sqrt:  [[ 9.45698999  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01617559 -0.04984179 -0.79740186]
Stock Position:  0.016175590977271635
Bond Position:  [4.30834673]


portfolio before change:  [5.94464551]
curr_Stock_Price:  101.12522027249341
curr_Factors:  [101.12522027  -1.16871299  -0.99247615]
mat_Sqrt:  [[11.6484184   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169148 -0.00659539  0.21422481]
Stock Position:  0.0016914788969934137
Bond Position:  [5.77359433]


portfolio before change:  [5.94349113]
curr_Stock_Price:  100.01605975917117
curr_Factors:  [100.01605976  -0.84952129  -0.98099495]
mat_Sqrt:  [[16.03565264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03778261 -0.05869037  0.10776549]
Stock Position:  -0.037782613689557897
Bond Position:  [9.72235928]


portfolio before change:  [5.97213019]
curr_Stock_Price:  99.29023154600976
curr_Factors:  [99.29023155 -0.913063   -0.96818925]
mat_Sqrt:  [[15.13174645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170372 -0.03767049 -0.42481541]
Stock Position:  -0.001703722042713298
Bond Position:  [6.14129314]


portfolio before change:  [5.97184562]
curr_Stock_Price:  99.90786632958438
curr_Factors:  [99.90786633 -1.09712195 -0.9506514 ]
mat_Sqrt:  [[12.89029982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00226266  0.00117446 -0.06522414]
Stock Position:  0.002262664028960277
Bond Position:  [5.74578768]


portfolio before change:  [5.97295524]
curr_Stock_Price:  100.0808284676401
curr_Factors:  [100.08082847  -1.28881271  -0.96227066]
mat_Sqrt:  [[10.53702005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0312824   0.00485464 -0.26391354]
Stock Position:  0.031282397962077484
Bond Position:  [2.84218694]


portfolio before change:  [5.94858377]
curr_Stock_Price:  99.29039140441981
curr_Factors:  [99.2903914  -0.92290394 -0.94372878]
mat_Sqrt:  [[15.35461509  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02108767  0.00034922 -0.26681129]
Stock Position:  -0.021087665633853673
Bond Position:  [8.04238635]


portfolio before change:  [5.93586549]
curr_Stock_Price:  99.94118155207777
curr_Factors:  [99.94118155 -1.07961941 -0.93473549]
mat_Sqrt:  [[13.33279694  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00304935 -0.00692826 -0.1242898 ]
Stock Position:  0.00304935470704876
Bond Position:  [5.63110938]


portfolio before change:  [5.9328522]
curr_Stock_Price:  98.72216377387758
curr_Factors:  [98.72216377 -0.91338217 -0.90880792]
mat_Sqrt:  [[15.96053935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00463861 -0.08646817  0.05221059]
Stock Position:  0.00463861390481633
Bond Position:  [5.4749182]


portfolio before change:  [5.93593755]
curr_Stock_Price:  99.23976221172451
curr_Factors:  [99.23976221 -0.73335003 -0.89670626]
mat_Sqrt:  [[19.44290984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00142791 -0.00209357 -0.02361847]
Stock Position:  0.0014279106811502297
Bond Position:  [5.79423203]


portfolio before change:  [5.93844598]
curr_Stock_Price:  100.48921710404099
curr_Factors:  [100.4892171   -1.01208748  -0.92499299]
mat_Sqrt:  [[14.48291913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01560689 -0.03174118  0.74840634]
Stock Position:  0.015606891597465745
Bond Position:  [4.37012167]


portfolio before change:  [5.93970366]
curr_Stock_Price:  100.53479824663667
curr_Factors:  [100.53479825  -1.12436282  -0.92697038]
mat_Sqrt:  [[12.92509438  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00744386 0.05315917 0.36117024]
Stock Position:  0.007443858011512462
Bond Position:  [5.1913369]


portfolio before change:  [5.93840619]
curr_Stock_Price:  100.27331606417786
curr_Factors:  [100.27331606  -1.06023056  -0.90364719]
mat_Sqrt:  [[14.06967637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00250675 -0.0334561  -0.16694526]
Stock Position:  0.0025067478760994006
Bond Position:  [5.68704626]


portfolio before change:  [5.93570132]
curr_Stock_Price:  98.91067605075652
curr_Factors:  [98.91067605 -0.93807207 -0.92076559]
mat_Sqrt:  [[15.41559281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013803  -0.0407641  -0.04565683]
Stock Position:  -0.0013803015244959987
Bond Position:  [6.07222787]


portfolio before change:  [5.93593624]
curr_Stock_Price:  99.29041298675726
curr_Factors:  [99.29041299 -0.85767856 -0.95365903]
mat_Sqrt:  [[16.22756649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02478862 -0.07867981  0.30460639]
Stock Position:  -0.024788623034038657
Bond Position:  [8.39720886]


portfolio before change:  [5.89112438]
curr_Stock_Price:  101.1405189717733
curr_Factors:  [101.14051897  -0.66264006  -0.94813715]
mat_Sqrt:  [[20.20103056  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00754873 -0.01044517 -0.03622345]
Stock Position:  -0.007548725698872318
Bond Position:  [6.65460641]


portfolio before change:  [5.89028807]
curr_Stock_Price:  101.36150800968957
curr_Factors:  [101.36150801  -0.5949105   -0.95244251]
mat_Sqrt:  [[21.57079694  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01305924 0.31181182 0.68979264]
Stock Position:  0.013059238653699422
Bond Position:  [4.56658395]


portfolio before change:  [5.91475519]
curr_Stock_Price:  103.19134352652688
curr_Factors:  [103.19134353  -0.70155733  -0.96671635]
mat_Sqrt:  [[19.45903114  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00039285 0.00629912 0.0835539 ]
Stock Position:  0.00039285071725068515
Bond Position:  [5.87421639]


portfolio before change:  [5.91552575]
curr_Stock_Price:  103.28358482199245
curr_Factors:  [103.28358482  -0.6667527   -0.95851757]
mat_Sqrt:  [[20.33224775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00028676 -0.06326315  0.11742594]
Stock Position:  -0.00028676257548228685
Bond Position:  [5.94514361]


portfolio before change:  [5.91553556]
curr_Stock_Price:  105.84103006397451
curr_Factors:  [105.84103006  -0.8262518   -0.96828488]
mat_Sqrt:  [[17.59124914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220956  0.01916992 -0.08961985]
Stock Position:  -0.0022095567727765794
Bond Position:  [6.14939732]


portfolio before change:  [5.91809298]
curr_Stock_Price:  105.03150172510607
curr_Factors:  [105.03150173  -0.82703167  -0.93698343]
mat_Sqrt:  [[17.99772243  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01420887 -0.00262652  0.58411187]
Stock Position:  0.014208870657080177
Bond Position:  [4.42571395]


portfolio before change:  [5.94611512]
curr_Stock_Price:  106.96472281960516
curr_Factors:  [106.96472282  -0.84791833  -0.96142336]
mat_Sqrt:  [[17.51674702  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00293225 -0.05042363 -0.15356219]
Stock Position:  0.0029322544833436143
Bond Position:  [5.63246733]


portfolio before change:  [5.94830195]
curr_Stock_Price:  107.4703856962908
curr_Factors:  [107.4703857   -0.90523985  -1.02094456]
mat_Sqrt:  [[15.6587664   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0043901   0.0744923   0.64007744]
Stock Position:  -0.004390095715516738
Bond Position:  [6.42010723]


portfolio before change:  [5.94626442]
curr_Stock_Price:  108.1173186111027
curr_Factors:  [108.11731861  -1.01860396  -1.01956637]
mat_Sqrt:  [[14.08410129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00155139 0.01938051 0.16355628]
Stock Position:  0.0015513940979775711
Bond Position:  [5.77853185]


portfolio before change:  [5.94621949]
curr_Stock_Price:  107.62273929297903
curr_Factors:  [107.62273929  -0.85910239  -1.01292331]
mat_Sqrt:  [[16.55364404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00534771 -0.03967325  0.88874173]
Stock Position:  -0.005347708423310997
Bond Position:  [6.52175452]


portfolio before change:  [5.94440679]
curr_Stock_Price:  108.11415854483516
curr_Factors:  [108.11415854  -0.99635128  -1.0164005 ]
mat_Sqrt:  [[14.44626521  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00756204  0.02633014 -0.27990184]
Stock Position:  0.0075620428242453835
Bond Position:  [5.1268429]


portfolio before change:  [5.94940156]
curr_Stock_Price:  108.68991244648142
curr_Factors:  [108.68991245  -1.17648463  -0.9985605 ]
mat_Sqrt:  [[12.34750304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08439258 -0.03632114 -3.18669812]
Stock Position:  -0.08439258363975738
Bond Position:  [15.12202409]


portfolio before change:  [5.97345973]
curr_Stock_Price:  108.42723772794864
curr_Factors:  [108.42723773  -1.16179084  -0.96822518]
mat_Sqrt:  [[12.88499307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00418668 -0.05930724  0.61961122]
Stock Position:  0.004186681254825001
Bond Position:  [5.51950945]


portfolio before change:  [5.97229634]
curr_Stock_Price:  107.98455316644898
curr_Factors:  [107.98455317  -1.24402686  -0.97842056]
mat_Sqrt:  [[11.69943764  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01307182 -0.04640775  0.4008002 ]
Stock Position:  -0.013071817839375808
Bond Position:  [7.38385075]


portfolio before change:  [5.97006337]
curr_Stock_Price:  108.22598918006516
curr_Factors:  [108.22598918  -1.22675181  -0.99506244]
mat_Sqrt:  [[11.73302222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00532168  0.07990798 -0.12350407]
Stock Position:  0.00532167615445177
Bond Position:  [5.3941197]


portfolio before change:  [5.97482013]
curr_Stock_Price:  108.99312595611973
curr_Factors:  [108.99312596  -1.20992849  -1.01769358]
mat_Sqrt:  [[11.74776195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.99267500e-03  5.61193386e-05  6.20986767e-02]
Stock Position:  -0.007992675001847666
Bond Position:  [6.84596676]


portfolio before change:  [5.97709964]
curr_Stock_Price:  108.81499871230398
curr_Factors:  [108.81499871  -1.02627702  -1.00153619]
mat_Sqrt:  [[14.32256088  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047192  0.09784957 -0.00201826]
Stock Position:  -0.0004719188616401413
Bond Position:  [6.02845149]


portfolio before change:  [5.97722574]
curr_Stock_Price:  110.14468785678913
curr_Factors:  [110.14468786  -1.22813135  -0.99905246]
mat_Sqrt:  [[11.87708648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.37630956e-04 -4.16873660e-02 -3.93519259e-01]
Stock Position:  0.0001376309556110955
Bond Position:  [5.96206642]


portfolio before change:  [5.97790439]
curr_Stock_Price:  109.66041537357975
curr_Factors:  [109.66041537  -1.08752715  -0.99862092]
mat_Sqrt:  [[13.61592946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233579  0.12223098  0.25055034]
Stock Position:  -0.002335788509211222
Bond Position:  [6.23404793]


portfolio before change:  [5.9785346]
curr_Stock_Price:  109.72424643595502
curr_Factors:  [109.72424644  -1.18676106  -0.99848169]
mat_Sqrt:  [[12.33853892  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01478119  0.04121217 -0.01408449]
Stock Position:  0.014781185694215071
Bond Position:  [4.35668014]


portfolio before change:  [5.98417501]
curr_Stock_Price:  110.06899503368803
curr_Factors:  [110.06899503  -1.03612175  -0.98860697]
mat_Sqrt:  [[14.53237138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00100387  0.01419817 -0.03583486]
Stock Position:  0.0010038706131739446
Bond Position:  [5.87367998]


portfolio before change:  [5.98457044]
curr_Stock_Price:  109.73147060458129
curr_Factors:  [109.7314706   -0.88768003  -1.00670429]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.98457044]
Stock Price:  109.31386280603459
PL:  [-3.32929237]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.34163072e-01  1.47434613e-01  1.71142629e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 1.57159532e-01  2.76611192e-02  4.68172847e-02]
 [-3.49320853e-02  2.76081722e-02  1.12455409e-01]
 [-8.21451930e-01 -2.45834818e-01  3.25794153e-02]
 [-7.25342242e-03 -9.04553901e-02 -1.05438685e-01]
 [ 3.42761963e-02 -1.75302817e-02 -2.57020326e-02]
 [ 2.50510334e-01  7.67678874e-02 -6.18979462e-02]
 [-2.62075536e-01  9.48238883e-03 -1.09828218e-01]
 [ 6.70087988e-02 -4.29695841e-02 -8.54576012e-02]
 [ 9.14377395e-02 -3.18111491e-01  2.47002022e-02]
 [ 2.12142748e-02 -7.99248088e-03 -9.21518655e-03]
 [ 1.21563672e-01 -4.38671198e-02  2.74602451e-01]
 [ 9.88209201e-02 -4.76328796e-02 -5.96484794e-02]
 [-8.72707208e-03 -6.02645141e-02 -2.25456980e-02]
 [ 7.20569268e-02 -4.62733120e-01 -1.27821749e-01]
 [-6.46937690e-02 -2.64218944e-01 -2.53007545e-02]
 [-3.22437248e-01 -1.67195589e-01 -3.86887934e-02]
 [ 2.34642039e-01  1.09764896e+00  2.15898186e-01]
 [-3.15361433e-01 -4.85295749e-02  2.45542240e-01]
 [-9.17934740e-02  1.54468993e-01 -3.67559245e-02]
 [ 8.86964386e-02 -2.79674142e-02  5.88310976e-02]
 [-1.01145832e-01  8.90861009e-03 -1.07927553e-01]
 [-1.07211791e-02 -1.16471273e-01  1.10390708e-01]
 [-9.67577555e-02  1.87801068e-02 -1.25045036e-03]
 [ 1.12365302e-01 -7.77259683e-03 -7.81846201e-03]
 [ 3.09306399e-02 -6.72306630e-02  8.19845914e-02]
 [ 6.68485076e-03  4.14907966e-02 -3.78079790e-02]
 [-6.25546069e-01 -4.62446990e-04 -8.91585835e-01]
 [-1.87902850e-01 -1.69437543e-03  1.32170961e-02]
 [-3.07436436e-02  6.29956807e-02  1.74531935e-01]
 [ 1.51469572e-02  6.01622379e-02  6.58032201e-03]
 [-1.18992013e-01 -5.93718645e-03 -1.48139675e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 2.24891091e-01 -1.71240483e-01 -7.05612287e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-4.32583957e-03 -4.96204097e-03 -4.69647658e-02]
 [-7.52512765e-02  5.41153756e-02 -3.64052532e-03]
 [-1.11181735e-02 -2.83209617e-01  1.09121777e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.22057054]
curr_Stock_Price:  99.49725168535564
curr_Factors:  [99.49725169 -1.10444139 -0.99293818]
mat_Sqrt:  [[12.21604751  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0078112   0.04662292  0.48822228]
Stock Position:  -0.00781119945372821
Bond Position:  [-0.44337766]


portfolio before change:  [-1.22427426]
curr_Stock_Price:  99.96431145155334
curr_Factors:  [99.96431145 -1.3433455  -1.00146263]
mat_Sqrt:  [[ 9.58313814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00473551  0.01411938  0.0859571 ]
Stock Position:  -0.00473550961857762
Bond Position:  [-0.7508923]


portfolio before change:  [-1.22329151]
curr_Stock_Price:  99.73696210198524
curr_Factors:  [99.7369621  -1.49793238 -0.98814148]
mat_Sqrt:  [[ 8.30171801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02016815 0.00874721 0.13355668]
Stock Position:  0.02016814801882827
Bond Position:  [-3.23480133]


portfolio before change:  [-1.22602449]
curr_Stock_Price:  99.62150254644708
curr_Factors:  [99.62150255 -1.21653323 -0.98689644]
mat_Sqrt:  [[11.00058392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102398  0.00873047  0.32080398]
Stock Position:  -0.00102398029898109
Bond Position:  [-1.12401404]


portfolio before change:  [-1.22662841]
curr_Stock_Price:  100.0740582693337
curr_Factors:  [100.07405827  -1.13620756  -1.01781956]
mat_Sqrt:  [[11.61019247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07072657 -0.0777398   0.09294   ]
Stock Position:  -0.07072657189082038
Bond Position:  [5.85126666]


portfolio before change:  [-1.19329094]
curr_Stock_Price:  99.61304314384981
curr_Factors:  [99.61304314 -1.03977762 -1.01340786]
mat_Sqrt:  [[12.78289096  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243384 -0.02860451 -0.30078722]
Stock Position:  -0.0024338431760242253
Bond Position:  [-0.95084841]


portfolio before change:  [-1.19382541]
curr_Stock_Price:  99.78380313449202
curr_Factors:  [99.78380313 -0.91108688 -1.03243718]
mat_Sqrt:  [[14.28888288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00199996 -0.00554356 -0.07332075]
Stock Position:  0.0019999576690685754
Bond Position:  [-1.39338879]


portfolio before change:  [-1.19503393]
curr_Stock_Price:  99.26662487038803
curr_Factors:  [99.26662487 -0.98265794 -1.01619131]
mat_Sqrt:  [[13.44974524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01783362  0.02427614 -0.17657761]
Stock Position:  0.017833617131704897
Bond Position:  [-2.96531691]


portfolio before change:  [-1.20009396]
curr_Stock_Price:  99.00367491442346
curr_Factors:  [99.00367491 -0.85184684 -1.00819464]
mat_Sqrt:  [[15.41152327  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01844395  0.00299859 -0.31330934]
Stock Position:  -0.018443945337009916
Bond Position:  [0.62592441]


portfolio before change:  [-1.2040728]
curr_Stock_Price:  99.22364331213468
curr_Factors:  [99.22364331 -0.59502557 -1.05021352]
mat_Sqrt:  [[19.14683131  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00253073 -0.01358818 -0.24378675]
Stock Position:  0.0025307252304969693
Bond Position:  [-1.45518058]


portfolio before change:  [-1.20591106]
curr_Stock_Price:  98.5691457685243
curr_Factors:  [98.56914577 -0.48493466 -1.06657556]
mat_Sqrt:  [[20.88952984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00422537 -0.10059569  0.0704628 ]
Stock Position:  0.004225372447257787
Bond Position:  [-1.62240242]


portfolio before change:  [-1.20229032]
curr_Stock_Price:  99.4740505390331
curr_Factors:  [99.47405054 -0.48264977 -1.08500979]
mat_Sqrt:  [[20.74358917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00092206 -0.00252744 -0.02628836]
Stock Position:  0.0009220616378762787
Bond Position:  [-1.29401152]


portfolio before change:  [-1.20133884]
curr_Stock_Price:  100.68138356322463
curr_Factors:  [100.68138356  -0.41311678  -1.07265979]
mat_Sqrt:  [[22.78686645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00774499 -0.013872    0.78336436]
Stock Position:  0.007744988473281167
Bond Position:  [-1.981115]


portfolio before change:  [-1.21087449]
curr_Stock_Price:  99.4821571789587
curr_Factors:  [99.48215718 -0.53333997 -1.02254742]
mat_Sqrt:  [[20.99094002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00406915 -0.01506284 -0.17016051]
Stock Position:  0.004069153144559769
Bond Position:  [-1.61568263]


portfolio before change:  [-1.21042852]
curr_Stock_Price:  99.6413898579804
curr_Factors:  [99.64138986 -0.54077865 -0.99962042]
mat_Sqrt:  [[21.35270789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069711 -0.01905731 -0.0643166 ]
Stock Position:  -0.0006971114184489668
Bond Position:  [-1.14096737]


portfolio before change:  [-1.20774837]
curr_Stock_Price:  95.59213895191812
curr_Factors:  [95.59213895 -0.43587303 -1.00994799]
mat_Sqrt:  [[22.51697721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00151076 -0.14632906 -0.36463987]
Stock Position:  0.0015107580167885582
Bond Position:  [-1.35216496]


portfolio before change:  [-1.20627821]
curr_Stock_Price:  96.67715215746496
curr_Factors:  [96.67715216 -0.48952991 -1.01099333]
mat_Sqrt:  [[21.56030437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355655 -0.08355337 -0.07217601]
Stock Position:  -0.0035565531153916026
Bond Position:  [-0.86244079]


portfolio before change:  [-1.20092157]
curr_Stock_Price:  95.14070563391786
curr_Factors:  [95.14070563 -0.33293828 -0.98651447]
mat_Sqrt:  [[25.42935349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01316005 -0.05287189 -0.11036836]
Stock Position:  -0.01316004894428507
Bond Position:  [0.05113477]


portfolio before change:  [-1.20280668]
curr_Stock_Price:  95.284436266982
curr_Factors:  [95.28443627 -0.66403978 -0.99779041]
mat_Sqrt:  [[18.08415794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01697913 0.34710708 0.61589743]
Stock Position:  0.016979128730330945
Bond Position:  [-2.82065339]


portfolio before change:  [-1.18260887]
curr_Stock_Price:  96.49477011372879
curr_Factors:  [96.49477011 -0.56140397 -1.01760611]
mat_Sqrt:  [[19.89520468  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01339485 -0.0153464   0.70046367]
Stock Position:  -0.013394853961937847
Bond Position:  [0.10992448]


portfolio before change:  [-1.19452366]
curr_Stock_Price:  97.38530106139605
curr_Factors:  [97.38530106 -0.99239305 -1.00140331]
mat_Sqrt:  [[13.26168335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00718671  0.04884738 -0.10485442]
Stock Position:  -0.0071867100774021765
Bond Position:  [-0.49464374]


portfolio before change:  [-1.18642242]
curr_Stock_Price:  96.24944457411132
curr_Factors:  [96.24944457 -0.82745349 -0.97948033]
mat_Sqrt:  [[15.79999124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00632805 -0.00884407  0.16782875]
Stock Position:  0.0063280522790313334
Bond Position:  [-1.79549394]


portfolio before change:  [-1.18308164]
curr_Stock_Price:  96.8128457549421
curr_Factors:  [96.81284575 -1.32764812 -0.96782226]
mat_Sqrt:  [[ 9.75040972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01260936  0.00281715 -0.30788727]
Stock Position:  -0.01260936057029827
Bond Position:  [0.03766644]


portfolio before change:  [-1.18324854]
curr_Stock_Price:  96.82645548402051
curr_Factors:  [96.82645548 -0.97761515 -0.96716943]
mat_Sqrt:  [[13.84792888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063583 -0.03683145  0.31491396]
Stock Position:  0.0006358318714694282
Bond Position:  [-1.24481389]


portfolio before change:  [-1.18248349]
curr_Stock_Price:  98.27442559248432
curr_Factors:  [98.27442559 -0.71201662 -0.9906935 ]
mat_Sqrt:  [[17.90452907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00539127  0.00593879 -0.00356719]
Stock Position:  -0.005391267314708896
Bond Position:  [-0.65265979]


portfolio before change:  [-1.18751076]
curr_Stock_Price:  99.19177607338946
curr_Factors:  [99.19177607 -1.03954148 -0.98621087]
mat_Sqrt:  [[13.08285717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00845142 -0.00245791 -0.0223039 ]
Stock Position:  0.008451416699890496
Bond Position:  [-2.02582179]


portfolio before change:  [-1.19149889]
curr_Stock_Price:  98.74985144771065
curr_Factors:  [98.74985145 -0.90612184 -0.9812274 ]
mat_Sqrt:  [[14.957916    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0030706  -0.0212602   0.23387922]
Stock Position:  0.0030706006293849367
Bond Position:  [-1.49472025]


portfolio before change:  [-1.18867793]
curr_Stock_Price:  99.72940270895991
curr_Factors:  [99.72940271 -1.01943027 -0.98154918]
mat_Sqrt:  [[13.48369396  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.86398672e-06  1.31205419e-02 -1.07855640e-01]
Stock Position:  2.8639867179158197e-06
Bond Position:  [-1.18896356]


portfolio before change:  [-1.18882597]
curr_Stock_Price:  99.93559458162413
curr_Factors:  [99.93559458 -0.90775947 -0.98122476]
mat_Sqrt:  [[15.1127944   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.34350025e-02 -1.46238579e-04 -2.54344622e+00]
Stock Position:  -0.053435002483800655
Bond Position:  [4.15123277]


portfolio before change:  [-1.25091219]
curr_Stock_Price:  101.1072077147029
curr_Factors:  [101.10720771  -1.08342551  -0.97328428]
mat_Sqrt:  [[12.92898418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01432817 -0.00053581  0.0377047 ]
Stock Position:  -0.014328168970898274
Bond Position:  [0.19776897]


portfolio before change:  [-1.25868408]
curr_Stock_Price:  101.65135397925827
curr_Factors:  [101.65135398  -0.89335139  -0.95719478]
mat_Sqrt:  [[15.97464355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.07463233e-04 1.99209834e-02 4.97891029e-01]
Stock Position:  0.0004074632328315549
Bond Position:  [-1.30010327]


portfolio before change:  [-1.25892169]
curr_Stock_Price:  101.46708460010873
curr_Factors:  [101.4670846   -1.03644018  -0.95709684]
mat_Sqrt:  [[13.82111426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00130551 0.01902497 0.01877183]
Stock Position:  0.0013055056007198471
Bond Position:  [-1.39138754]


portfolio before change:  [-1.25886995]
curr_Stock_Price:  101.63994804195158
curr_Factors:  [101.63994804  -1.28500966  -0.95981048]
mat_Sqrt:  [[10.76840638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01387245 -0.0018775  -0.42260126]
Stock Position:  -0.013872451466055423
Bond Position:  [0.1511253]


portfolio before change:  [-1.25530664]
curr_Stock_Price:  101.38444765640477
curr_Factors:  [101.38444766  -1.19001769  -0.95516943]
mat_Sqrt:  [[11.86665765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00441689  0.0049611   0.16678008]
Stock Position:  -0.004416888489418797
Bond Position:  [-0.80750284]


portfolio before change:  [-1.25395789]
curr_Stock_Price:  101.05623047875628
curr_Factors:  [101.05623048  -1.24298141  -0.94006902]
mat_Sqrt:  [[11.3887573   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01809385 -0.054151   -0.20129154]
Stock Position:  0.018093846846208936
Bond Position:  [-3.08245384]


portfolio before change:  [-1.23670248]
curr_Stock_Price:  102.0311885086323
curr_Factors:  [102.03118851  -1.13588866  -0.97726875]
mat_Sqrt:  [[12.33105812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00198782 0.00777784 0.21633947]
Stock Position:  0.0019878167310971467
Bond Position:  [-1.43952178]


portfolio before change:  [-1.23705132]
curr_Stock_Price:  101.94622517070462
curr_Factors:  [101.94622517  -0.93838464  -0.98100349]
mat_Sqrt:  [[14.95517425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093885 -0.00156914 -0.1339774 ]
Stock Position:  -0.000938845736881868
Bond Position:  [-1.14133954]


portfolio before change:  [-1.23605875]
curr_Stock_Price:  100.73703309328371
curr_Factors:  [100.73703309  -0.58051712  -1.0010662 ]
mat_Sqrt:  [[20.71649361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360086  0.01711278 -0.01038541]
Stock Position:  -0.0036008575605806794
Bond Position:  [-0.87331904]


portfolio before change:  [-1.23237654]
curr_Stock_Price:  99.68412240437493
curr_Factors:  [99.6841224  -0.70665842 -1.00225481]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.23237654]
Stock Price:  100.16204689840417
PL:  [-1.39442344]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-8.84455134e-02 -6.65988755e-03  6.55522235e-03]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.74504509e-01 -1.64157432e-01 -3.23857586e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-6.53109067e-01 -1.98149733e-01  3.66932824e-02]
 [-2.63583765e-02 -5.38091583e-02 -4.98642176e-02]
 [ 9.53289209e-03  1.42333704e-01  7.06890315e-02]
 [ 2.62325462e-01 -2.47511260e-01 -3.22949191e-02]
 [-5.59148113e-01 -2.55718067e-02 -9.43961897e-02]
 [-2.31029039e-03  6.13445387e-02 -2.69187028e-03]
 [-1.33839459e-02 -2.41685119e-01  1.90414026e-01]
 [-3.07118650e-01  5.29466541e-02  2.72666348e-01]
 [ 3.51335848e-02  1.09946070e-01  1.55157226e-01]
 [-1.08031354e-02  6.05124552e-01  5.55782810e-01]
 [ 7.66132733e-02 -1.18220884e-01 -4.90365594e-02]
 [-1.10693973e-02 -1.94487607e-02  3.43470962e-02]
 [-5.55586413e-01 -1.52337113e-01  1.72217784e-01]
 [-1.13716934e-01  1.92528158e-02 -3.16735239e-02]
 [-6.96106439e-02  4.14958992e-01 -1.92477918e-02]
 [-1.77170375e-02  4.48829906e-02  2.27226651e-02]
 [ 7.65703436e-02 -2.69562559e-01  1.61604241e-01]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 3.54553360e-01  5.46283869e-02  3.06252262e-01]
 [ 5.69126819e-02 -1.20131372e-01 -2.16827213e-02]
 [-1.19092579e-01  2.48244016e-01  2.77374583e-01]
 [-5.91407896e-03  5.73985850e-02  6.04837513e-02]
 [-2.44950703e-01 -1.05129881e-01  6.71863674e-01]
 [ 2.39702673e-01  1.18230067e-01 -1.35354001e-01]
 [-1.05136779e+00 -7.89390738e-02 -1.25709943e+00]
 [ 2.91036169e-01 -7.36813724e-01  6.95175065e-01]
 [-4.03520532e-01 -4.69840027e-01  1.94309903e-01]
 [ 2.01448490e-01  6.51172959e-01 -1.72909886e-01]
 [-5.83706276e-02  1.86800128e-02  2.02672267e-01]
 [ 1.96833611e-01  1.02107693e+00 -5.91301267e-01]
 [ 3.83236761e-02 -2.29707451e-01 -3.24368769e-01]
 [-1.12784276e-01  6.02675665e-01  9.48904767e-02]
 [ 3.31763476e-01  2.25214120e-01  3.47968870e-02]
 [ 6.98975858e-02  1.27605174e-02 -1.48533146e-02]
 [-2.47529049e-01 -5.31442830e-01  1.24638662e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.48110166]
curr_Stock_Price:  100.70965537490122
curr_Factors:  [100.70965537  -1.08213512  -1.02008106]
mat_Sqrt:  [[12.30524382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00709286 -0.00210604  0.01870022]
Stock Position:  -0.007092861634981862
Bond Position:  [8.19542131]


portfolio before change:  [7.48707828]
curr_Stock_Price:  100.01146984543918
curr_Factors:  [100.01146985  -1.13250799  -1.01745283]
mat_Sqrt:  [[11.65020826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0038953   0.01411938  0.0859571 ]
Stock Position:  -0.003895298849485829
Bond Position:  [7.87665285]


portfolio before change:  [7.48313495]
curr_Stock_Price:  101.27657746682365
curr_Factors:  [101.27657747  -1.12310806  -1.00829881]
mat_Sqrt:  [[12.018514    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01698703 -0.05191114 -0.92387555]
Stock Position:  0.016987027607875602
Bond Position:  [5.76274694]


portfolio before change:  [7.48272374]
curr_Stock_Price:  101.20996201269739
curr_Factors:  [101.20996201  -0.85521828  -1.01418269]
mat_Sqrt:  [[15.60819705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00126235 -0.00659539  0.21422481]
Stock Position:  0.0012623529698783636
Bond Position:  [7.35496105]


portfolio before change:  [7.4832706]
curr_Stock_Price:  100.9148205029473
curr_Factors:  [100.9148205   -0.70939023  -0.99438022]
mat_Sqrt:  [[18.36609583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03543133 -0.06266045  0.10467572]
Stock Position:  -0.03543133459191378
Bond Position:  [11.05881737]


portfolio before change:  [7.49251516]
curr_Stock_Price:  100.69292301954913
curr_Factors:  [100.69292302  -0.56732451  -0.98730502]
mat_Sqrt:  [[21.27315583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178282 -0.01701595 -0.14224873]
Stock Position:  -0.0017828202849382152
Bond Position:  [7.67203255]


portfolio before change:  [7.49073232]
curr_Stock_Price:  102.23088106859318
curr_Factors:  [102.23088107  -0.71015631  -0.98915772]
mat_Sqrt:  [[18.68871316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00147882 0.04500987 0.20165613]
Stock Position:  0.001478821491347721
Bond Position:  [7.3395511]


portfolio before change:  [7.49321194]
curr_Stock_Price:  103.28720924275251
curr_Factors:  [103.28720924  -0.51189302  -1.02464623]
mat_Sqrt:  [[22.21958925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01122175 -0.07826993 -0.09212842]
Stock Position:  0.011221745522680517
Bond Position:  [6.33414917]


portfolio before change:  [7.49504896]
curr_Stock_Price:  103.38034922068735
curr_Factors:  [103.38034922  -0.40186588  -1.05847138]
mat_Sqrt:  [[24.00057137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02412763 -0.00808652 -0.26928605]
Stock Position:  -0.0241276303992768
Bond Position:  [9.98937181]


portfolio before change:  [7.48008325]
curr_Stock_Price:  104.05237786989812
curr_Factors:  [104.05237787  -0.58982117  -1.03183351]
mat_Sqrt:  [[20.55778542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.20619831e-05  1.93988464e-02 -7.67915664e-03]
Stock Position:  -6.20619831227441e-05
Bond Position:  [7.48654094]


portfolio before change:  [7.48096027]
curr_Stock_Price:  105.0006965174617
curr_Factors:  [105.00069652  -0.76257032  -1.0487591 ]
mat_Sqrt:  [[17.16096902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112137 -0.07642755  0.54319821]
Stock Position:  0.0011213744035495873
Bond Position:  [7.36321517]


portfolio before change:  [7.48272578]
curr_Stock_Price:  105.75428100719031
curr_Factors:  [105.75428101  -0.92170671  -1.06105347]
mat_Sqrt:  [[14.56116602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0171754   0.0167432   0.77784119]
Stock Position:  -0.017175395713632358
Bond Position:  [9.2990974]


portfolio before change:  [7.48330295]
curr_Stock_Price:  105.78835826426634
curr_Factors:  [105.78835826  -0.86185762  -1.06714287]
mat_Sqrt:  [[15.37034473  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00453104 0.034768   0.44262038]
Stock Position:  0.004531044519506818
Bond Position:  [7.00397119]


portfolio before change:  [7.48328293]
curr_Stock_Price:  105.59070614221508
curr_Factors:  [105.59070614  -0.94063632  -1.09135938]
mat_Sqrt:  [[13.84016208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00854541 0.19135719 1.58549366]
Stock Position:  0.008545406014869226
Bond Position:  [6.58096747]


portfolio before change:  [7.47637736]
curr_Stock_Price:  104.68633221825658
curr_Factors:  [104.68633222  -0.74216955  -1.09856602]
mat_Sqrt:  [[16.61378882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00382521 -0.03738473 -0.13988765]
Stock Position:  0.0038252127863420997
Bond Position:  [7.07592986]


portfolio before change:  [7.48343817]
curr_Stock_Price:  106.30095322157591
curr_Factors:  [106.30095322  -0.73143062  -1.13617822]
mat_Sqrt:  [[16.42271456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027769 -0.00615024  0.09798271]
Stock Position:  -0.0002776940720415562
Bond Position:  [7.51295732]


portfolio before change:  [7.4842761]
curr_Stock_Price:  106.66555752368029
curr_Factors:  [106.66555752  -0.73315856  -1.12988797]
mat_Sqrt:  [[16.55439752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03167533 -0.04817322  0.4912894 ]
Stock Position:  -0.03167532567192802
Bond Position:  [10.86294238]


portfolio before change:  [7.41242811]
curr_Stock_Price:  108.97669224674685
curr_Factors:  [108.97669225  -0.50643006  -1.11696282]
mat_Sqrt:  [[21.49329761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00556849  0.00608827 -0.09035575]
Stock Position:  -0.0055684875169344054
Bond Position:  [8.01926346]


portfolio before change:  [7.41636251]
curr_Stock_Price:  108.45016996099996
curr_Factors:  [108.45016996  -0.52947206  -1.11273896]
mat_Sqrt:  [[20.99070641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299301  0.13122155 -0.05490859]
Stock Position:  -0.00299300969905666
Bond Position:  [7.74095492]


portfolio before change:  [7.41742731]
curr_Stock_Price:  108.41772379774437
curr_Factors:  [108.4177238   -0.29856208  -1.14579115]
mat_Sqrt:  [[25.57558928  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046607  0.01419325  0.06482144]
Stock Position:  -0.00046606625331800525
Bond Position:  [7.46795715]


portfolio before change:  [7.41919682]
curr_Stock_Price:  106.62406432223254
curr_Factors:  [ 1.06624064e+02 -1.40607213e-02 -1.15032881e+00]
mat_Sqrt:  [[33.27877141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00308297 -0.08524317  0.46101192]
Stock Position:  0.0030829742642646306
Bond Position:  [7.09047758]


portfolio before change:  [7.42497963]
curr_Stock_Price:  108.21228308641595
curr_Factors:  [ 1.08212283e+02  6.47306182e-02 -1.16947437e+00]
mat_Sqrt:  [[35.85027118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010842   0.01916992 -0.08961985]
Stock Position:  -0.0010841999908318633
Bond Position:  [7.54230338]


portfolio before change:  [7.42465251]
curr_Stock_Price:  109.38362235985149
curr_Factors:  [109.38362236  -0.28101791  -1.16554658]
mat_Sqrt:  [[25.74644838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01625379 0.01727501 0.87365246]
Stock Position:  0.01625378901246357
Bond Position:  [5.64675419]


portfolio before change:  [7.43987939]
curr_Stock_Price:  110.27701375772175
curr_Factors:  [110.27701376  -0.34683071  -1.14774244]
mat_Sqrt:  [[24.74002458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00199616 -0.03798888 -0.06185477]
Stock Position:  0.0019961555041162655
Bond Position:  [7.21974932]


portfolio before change:  [7.44210302]
curr_Stock_Price:  110.93883856761445
curr_Factors:  [110.93883857  -0.47995059  -1.11681438]
mat_Sqrt:  [[22.47074142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249498  0.07850165  0.79127248]
Stock Position:  -0.0024949820550306478
Bond Position:  [7.71889343]


portfolio before change:  [7.4363953]
curr_Stock_Price:  113.61326390189627
curr_Factors:  [113.6132639   -0.71063255  -1.11535078]
mat_Sqrt:  [[18.2984606   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0004325  0.01815103 0.17254331]
Stock Position:  0.0004325030581905709
Bond Position:  [7.38725721]


portfolio before change:  [7.43742146]
curr_Stock_Price:  113.8507198927552
curr_Factors:  [113.85071989  -0.72301257  -1.10300282]
mat_Sqrt:  [[18.33611718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00602753 -0.03324499  1.91664005]
Stock Position:  -0.006027532760756575
Bond Position:  [8.12366041]


portfolio before change:  [7.42756057]
curr_Stock_Price:  115.65517516687466
curr_Factors:  [115.65517517  -0.86952023  -1.05984884]
mat_Sqrt:  [[16.7977352   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01280687  0.03738763 -0.38612729]
Stock Position:  0.012806865784105241
Bond Position:  [5.94638027]


portfolio before change:  [7.43790976]
curr_Stock_Price:  116.4052296844284
curr_Factors:  [116.40522968  -0.80267208  -1.03330238]
mat_Sqrt:  [[18.5617499   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0705758  -0.02496273 -3.58615477]
Stock Position:  -0.07057579920086461
Bond Position:  [15.65330188]


portfolio before change:  [7.42182682]
curr_Stock_Price:  116.6608375039684
curr_Factors:  [116.6608375   -0.84178676  -1.01235309]
mat_Sqrt:  [[18.26763745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02265831 -0.23300096  1.98314096]
Stock Position:  0.02265830694998167
Bond Position:  [4.77848976]


portfolio before change:  [7.43682782]
curr_Stock_Price:  117.29652706808531
curr_Factors:  [117.29652707  -0.98237737  -1.00395151]
mat_Sqrt:  [[16.09286931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02336366 -0.14857646  0.55431207]
Stock Position:  -0.02336366493564269
Bond Position:  [10.17730458]


portfolio before change:  [7.45083461]
curr_Stock_Price:  116.75146947614859
curr_Factors:  [116.75146948  -0.88168165  -0.98313019]
mat_Sqrt:  [[18.0877631   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01011549  0.20591897 -0.49326378]
Stock Position:  0.010115491907120354
Bond Position:  [6.26983606]


portfolio before change:  [7.45726314]
curr_Stock_Price:  117.30950013130554
curr_Factors:  [117.30950013  -1.31236104  -0.9844432 ]
mat_Sqrt:  [[11.79896141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139995  0.00590714  0.57816756]
Stock Position:  -0.0013999544506107164
Bond Position:  [7.6214911]


portfolio before change:  [7.45825486]
curr_Stock_Price:  117.28166196999263
curr_Factors:  [117.28166197  -1.7313238   -1.01438555]
mat_Sqrt:  [[ 7.52980432  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01361242  0.32289288 -1.68681793]
Stock Position:  0.013612417206684092
Bond Position:  [5.86176794]


portfolio before change:  [7.44913572]
curr_Stock_Price:  116.55791837658154
curr_Factors:  [116.55791838  -1.44848324  -1.0271175 ]
mat_Sqrt:  [[ 9.80397157  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034495  -0.07263987 -0.92533381]
Stock Position:  -0.0034495043535185885
Bond Position:  [7.85120277]


portfolio before change:  [7.44985747]
curr_Stock_Price:  116.63320805399242
curr_Factors:  [116.63320805  -1.22354568  -1.01333094]
mat_Sqrt:  [[12.45543918  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00625059  0.19058278  0.27069612]
Stock Position:  -0.006250588086868811
Bond Position:  [8.17888361]


portfolio before change:  [7.45807468]
curr_Stock_Price:  115.48215152958181
curr_Factors:  [115.48215153  -1.26201117  -1.02014912]
mat_Sqrt:  [[11.78651056  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02924372 0.07121896 0.09926583]
Stock Position:  0.029243715712207144
Bond Position:  [4.08094747]


portfolio before change:  [7.45906162]
curr_Stock_Price:  115.49845573037818
curr_Factors:  [115.49845573  -1.39148066  -1.06330671]
mat_Sqrt:  [[ 9.91917542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00677427  0.00403523 -0.04237237]
Stock Position:  0.006774266811457309
Bond Position:  [6.67664427]


portfolio before change:  [7.45916652]
curr_Stock_Price:  115.39073461572531
curr_Factors:  [115.39073462  -1.65107883  -1.06721899]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.45916652]
Stock Price:  115.89678297975524
PL:  [-8.43761645]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.60986281e-01 -1.18380783e-02  7.57588305e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.20170933e-01  2.11165352e-01  3.01896102e-01]
 [-6.21035434e-02 -3.56754292e-03  9.08990544e-02]
 [-7.99263147e-01 -2.39549586e-01  3.31216522e-02]
 [ 2.26363390e-02 -1.39267231e-01 -1.82511137e-01]
 [ 2.45508071e-02 -2.27462303e-01 -3.49627579e-02]
 [ 2.34640525e-01  2.75613933e-01 -7.58183862e-02]
 [-3.91105913e-02  2.53535565e-02 -7.74590523e-02]
 [ 1.29627460e-01  2.41880093e-02  2.19265809e-01]
 [ 1.27929789e-01 -1.89904037e-01 -3.07728539e-02]
 [-1.18129347e-01 -9.58580998e-02 -2.09338200e-01]
 [ 3.03945917e-01 -3.68608196e-01 -1.09056575e-01]
 [ 8.89497790e-02 -6.40390490e-02 -5.07390088e-02]
 [-1.17712593e-01  1.28888959e-01  1.02507259e-01]
 [-7.87302639e-03 -1.48180906e-01 -2.33109255e-02]
 [-3.16994255e-01 -2.89585197e-01  7.30085018e-02]
 [-2.01587700e-01 -7.90344055e-03 -4.15188113e-02]
 [ 3.78098298e-01  1.41810850e+00  6.41593086e-01]
 [-1.52941804e-01 -1.25548048e-02  1.49742748e-01]
 [-8.94988907e-02  8.00380749e-02 -4.02459766e-02]
 [ 1.27711705e-01 -2.02920819e-02  6.89278235e-02]
 [-7.78257377e-02 -5.10494726e-03 -9.51158650e-02]
 [-8.48017794e-03 -7.95839288e-02  1.18478647e-01]
 [-9.01308627e-02  4.11544738e-02 -9.49511527e-02]
 [ 1.06106482e-01 -3.89296198e-02 -3.17931397e-02]
 [-1.98417881e-02  5.97776862e-03 -4.87961242e-02]
 [ 1.90952088e-03  3.97956467e-02 -6.73172162e-03]
 [-4.83457077e-01  8.68275440e-02 -6.05922605e-01]
 [-3.63606266e-02 -1.25655862e-01 -1.80175756e-02]
 [-8.77565707e-02  9.11012766e-02  2.08899235e-01]
 [ 1.87877899e-02  8.37546013e-02 -4.70630727e-03]
 [-1.09716745e-01 -2.23623080e-04 -1.54107752e-01]
 [-6.13928482e-02  9.61328586e-02  1.09482017e-01]
 [ 8.87610067e-02 -8.26221976e-02 -1.20839976e-02]
 [-2.89871301e-02 -9.97227300e-03  3.62431734e-02]
 [ 2.07190990e-02  9.21709659e-03 -2.32368405e-02]
 [-1.06343277e-01  1.94607728e-02  3.17509422e-03]
 [ 2.77393275e-03 -2.84065930e-01  1.01808552e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.10868351]
curr_Stock_Price:  99.9611165384542
curr_Factors:  [99.96111654 -0.99172589 -1.00471667]
mat_Sqrt:  [[13.57647771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01074121 -0.00374353  0.21611886]
Stock Position:  -0.01074120516367854
Bond Position:  [3.18238637]


portfolio before change:  [2.10437021]
curr_Stock_Price:  100.39971951996723
curr_Factors:  [100.39971952  -1.05571855  -1.00682439]
mat_Sqrt:  [[12.76384377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355544  0.01411938  0.0859571 ]
Stock Position:  -0.0035554370349460103
Bond Position:  [2.46133509]


portfolio before change:  [2.10739889]
curr_Stock_Price:  99.63441515652077
curr_Factors:  [99.63441516 -1.06064229 -1.0197109 ]
mat_Sqrt:  [[12.44295312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02308515 0.06677635 0.86122555]
Stock Position:  0.02308515352578519
Bond Position:  [-0.19267688]


portfolio before change:  [2.0855258]
curr_Stock_Price:  98.6879626474129
curr_Factors:  [98.68796265 -1.07173996 -1.01935713]
mat_Sqrt:  [[12.19304713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357917 -0.00112816  0.2593097 ]
Stock Position:  -0.003579168089666698
Bond Position:  [2.43874661]


portfolio before change:  [2.0825987]
curr_Stock_Price:  99.59095521503443
curr_Factors:  [99.59095522 -1.224244   -1.00127968]
mat_Sqrt:  [[10.75690282  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07424882 -0.07575223  0.09448685]
Stock Position:  -0.07424882192930032
Bond Position:  [9.4771098]


portfolio before change:  [2.1484991]
curr_Stock_Price:  98.71934963367612
curr_Factors:  [98.71934963 -1.1707792  -1.0024038 ]
mat_Sqrt:  [[11.23571982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162112 -0.04404017 -0.52065347]
Stock Position:  -0.001621120463458128
Bond Position:  [2.30853506]


portfolio before change:  [2.15020325]
curr_Stock_Price:  97.84615075082763
curr_Factors:  [97.84615075 -1.15255251 -1.00790836]
mat_Sqrt:  [[11.2789199   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00102324 -0.0719299  -0.09973902]
Stock Position:  0.0010232373911363848
Bond Position:  [2.05008341]


portfolio before change:  [2.14987541]
curr_Stock_Price:  97.27530587452269
curr_Factors:  [97.27530587 -1.25192082 -0.99417231]
mat_Sqrt:  [[10.29287624  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02198418  0.08715678 -0.21628875]
Stock Position:  0.02198418371998434
Bond Position:  [0.01135722]


portfolio before change:  [2.13976895]
curr_Stock_Price:  96.81552591611678
curr_Factors:  [96.81552592 -1.03163272 -0.99958019]
mat_Sqrt:  [[12.69990445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427304  0.0080175  -0.22096912]
Stock Position:  -0.004273042237885359
Bond Position:  [2.55346578]


portfolio before change:  [2.14100507]
curr_Stock_Price:  96.60094446688173
curr_Factors:  [96.60094447 -1.15835961 -0.98430514]
mat_Sqrt:  [[11.33532296  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0154393  0.00764892 0.62550432]
Stock Position:  0.015439298756076913
Bond Position:  [0.64955422]


portfolio before change:  [2.15245913]
curr_Stock_Price:  97.33756237696687
curr_Factors:  [97.33756238 -1.19889987 -1.01123074]
mat_Sqrt:  [[10.67659909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01093466 -0.06005293 -0.08778639]
Stock Position:  0.010934662308377913
Bond Position:  [1.08810575]


portfolio before change:  [2.14806929]
curr_Stock_Price:  96.92366163114619
curr_Factors:  [96.92366163 -1.12882383 -1.0148814 ]
mat_Sqrt:  [[11.36136371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01437639 -0.03031299 -0.59718362]
Stock Position:  -0.014376388043509679
Bond Position:  [3.54148146]


portfolio before change:  [2.15331188]
curr_Stock_Price:  96.5897892378908
curr_Factors:  [96.58978924 -1.18394208 -1.01875674]
mat_Sqrt:  [[10.67360856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0254991  -0.11656415 -0.31110805]
Stock Position:  0.02549910017003149
Bond Position:  [-0.30964083]


portfolio before change:  [2.15968439]
curr_Stock_Price:  96.8412185662062
curr_Factors:  [96.84121857 -1.53128084 -1.01307622]
mat_Sqrt:  [[ 7.60431345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01011784 -0.02025093 -0.14474427]
Stock Position:  0.010117841869257406
Bond Position:  [1.17986026]


portfolio before change:  [2.16155464]
curr_Stock_Price:  97.01148793368831
curr_Factors:  [97.01148793 -1.5991578  -1.01457056]
mat_Sqrt:  [[ 7.10714805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01315021  0.04075827  0.29242468]
Stock Position:  -0.013150209754232707
Bond Position:  [3.43727606]


portfolio before change:  [2.15548318]
curr_Stock_Price:  97.50586408258202
curr_Factors:  [97.50586408 -1.31405041 -1.00963965]
mat_Sqrt:  [[ 9.54695699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172383 -0.04685892 -0.06649958]
Stock Position:  -0.0017238334357893023
Bond Position:  [2.32356705]


portfolio before change:  [2.1546777]
curr_Stock_Price:  98.14162264864747
curr_Factors:  [98.14162265 -1.20562545 -1.00874896]
mat_Sqrt:  [[10.71920672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0288798  -0.09157488  0.20827293]
Stock Position:  -0.028879797076139246
Bond Position:  [4.98898785]


portfolio before change:  [2.16588083]
curr_Stock_Price:  97.77529499569559
curr_Factors:  [97.775295   -1.33269258 -1.01376491]
mat_Sqrt:  [[ 9.35783953  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02246958 -0.00249929 -0.11844161]
Stock Position:  -0.022469583646263277
Bond Position:  [4.362851]


portfolio before change:  [2.17218548]
curr_Stock_Price:  97.51898149285695
curr_Factors:  [97.51898149 -1.5286411  -1.02450827]
mat_Sqrt:  [[ 7.59050151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07188963 0.44844528 1.83028649]
Stock Position:  0.07188962955002469
Bond Position:  [-4.83841797]


portfolio before change:  [2.16293238]
curr_Stock_Price:  97.39868232475108
curr_Factors:  [97.39868232 -1.56511112 -1.04758322]
mat_Sqrt:  [[ 7.14289629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01717789 -0.00397018  0.42717438]
Stock Position:  -0.017177885826842033
Bond Position:  [3.83603582]


portfolio before change:  [2.16195784]
curr_Stock_Price:  97.48333019198525
curr_Factors:  [97.48333019 -1.67676633 -1.0612441 ]
mat_Sqrt:  [[ 6.30706833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01516513  0.02531026 -0.11481057]
Stock Position:  -0.015165126963460519
Bond Position:  [3.64030492]


portfolio before change:  [2.15812537]
curr_Stock_Price:  97.76605384769557
curr_Factors:  [97.76605385 -1.81454274 -1.06606463]
mat_Sqrt:  [[ 5.48474198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02575465 -0.00641692  0.19663189]
Stock Position:  0.02575464799622787
Bond Position:  [-0.35980494]


portfolio before change:  [2.15735839]
curr_Stock_Price:  97.73802030411575
curr_Factors:  [97.7380203  -1.75532369 -1.05448257]
mat_Sqrt:  [[ 5.88545692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01654468 -0.00161433 -0.27133909]
Stock Position:  -0.016544678309856568
Bond Position:  [3.7744025]


portfolio before change:  [2.15045742]
curr_Stock_Price:  98.18364990828637
curr_Factors:  [98.18364991 -2.10302009 -1.05209749]
mat_Sqrt:  [[ 4.18590163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00326079 -0.02516665  0.3379866 ]
Stock Position:  0.0032607852722159473
Bond Position:  [1.83030163]


portfolio before change:  [2.15169136]
curr_Stock_Price:  98.49189746450065
curr_Factors:  [98.49189746 -1.83234086 -1.06751071]
mat_Sqrt:  [[ 5.42014583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0200087   0.01301419 -0.27086921]
Stock Position:  -0.020008701794727256
Bond Position:  [4.12238636]


portfolio before change:  [2.14875876]
curr_Stock_Price:  98.66421899872321
curr_Factors:  [98.664219  -1.7924666 -1.0573479]
mat_Sqrt:  [[ 5.7082235   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01727535 -0.01231063 -0.09069698]
Stock Position:  0.01727535308103653
Bond Position:  [0.44429954]


portfolio before change:  [2.14827094]
curr_Stock_Price:  98.63276651225618
curr_Factors:  [98.63276651 -1.81185698 -1.04743291]
mat_Sqrt:  [[ 5.65258883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524501  0.00189034 -0.13920176]
Stock Position:  -0.005245014418613833
Bond Position:  [2.66560123]


portfolio before change:  [2.14632349]
curr_Stock_Price:  99.06759327189833
curr_Factors:  [99.06759327 -1.92916791 -1.03681203]
mat_Sqrt:  [[ 5.10296854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00030628  0.01258449 -0.01920373]
Stock Position:  0.00030627920329345424
Bond Position:  [2.11598115]


portfolio before change:  [2.14655383]
curr_Stock_Price:  98.9559959214279
curr_Factors:  [98.95599592 -1.84761486 -1.01756357]
mat_Sqrt:  [[ 5.63781647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10729307  0.02745728 -1.72852854]
Stock Position:  -0.10729306935524925
Bond Position:  [12.76384636]


portfolio before change:  [2.14183539]
curr_Stock_Price:  99.01484423133485
curr_Factors:  [99.01484423 -1.53103972 -1.0166418 ]
mat_Sqrt:  [[ 7.74918959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00558547 -0.03973587 -0.05139913]
Stock Position:  -0.005585470423200805
Bond Position:  [2.69487988]


portfolio before change:  [2.14180125]
curr_Stock_Price:  99.08127068264318
curr_Factors:  [99.08127068 -1.25874845 -1.03152342]
mat_Sqrt:  [[10.03088218  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00426313  0.02880875  0.59593137]
Stock Position:  -0.0042631313194511945
Bond Position:  [2.56419772]


portfolio before change:  [2.14355007]
curr_Stock_Price:  98.74624160638258
curr_Factors:  [98.74624161 -1.33967352 -1.01027368]
mat_Sqrt:  [[ 9.41784359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00212253  0.02648553 -0.01342578]
Stock Position:  0.002122529773405209
Bond Position:  [1.93395823]


portfolio before change:  [2.14449445]
curr_Stock_Price:  99.07727090050464
curr_Factors:  [99.0772709  -1.42489686 -1.01225017]
mat_Sqrt:  [[ 8.6603318   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.63018734e-02 -7.07158271e-05 -4.39626521e-01]
Stock Position:  -0.016301873390837742
Bond Position:  [3.75963957]


portfolio before change:  [2.15288318]
curr_Stock_Price:  98.59151405568812
curr_Factors:  [98.59151406 -1.38483015 -1.03299732]
mat_Sqrt:  [[ 8.78598401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416149  0.03039988  0.31232172]
Stock Position:  -0.004161490088099291
Bond Position:  [2.56317079]


portfolio before change:  [2.15150024]
curr_Stock_Price:  99.00082668557495
curr_Factors:  [99.00082669 -1.47390963 -1.05698456]
mat_Sqrt:  [[ 7.87926014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01068134 -0.02612743 -0.03447228]
Stock Position:  0.010681342351435722
Bond Position:  [1.09403852]


portfolio before change:  [2.14377201]
curr_Stock_Price:  98.26449654302868
curr_Factors:  [98.26449654 -1.2219504  -1.06283411]
mat_Sqrt:  [[10.00293227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218401 -0.00315351  0.10339169]
Stock Position:  -0.0021840102195820883
Bond Position:  [2.35838268]


portfolio before change:  [2.14256107]
curr_Stock_Price:  98.95394288353809
curr_Factors:  [98.95394288 -1.22008447 -1.05296995]
mat_Sqrt:  [[10.1919695   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00159085  0.0029147  -0.06628824]
Stock Position:  0.0015908488736950813
Bond Position:  [1.9851403]


portfolio before change:  [2.14284083]
curr_Stock_Price:  98.97380692318562
curr_Factors:  [98.97380692 -1.3200725  -1.04835254]
mat_Sqrt:  [[ 9.26672664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01135166  0.00615404  0.00905766]
Stock Position:  -0.011351655545686765
Bond Position:  [3.26635739]


portfolio before change:  [2.14378495]
curr_Stock_Price:  98.92660701640844
curr_Factors:  [98.92660702 -1.25528541 -1.01996445]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.14378495]
Stock Price:  99.3946230075778
PL:  [2.14378495]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.60517186e-01  1.13415978e-01  1.74625052e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.36752442e-01  1.41434480e-02 -2.00452371e-02]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.08767143e+00 -3.21244604e-01  2.60736947e-02]
 [-2.77314921e-02 -5.11753118e-02 -4.58699567e-02]
 [ 2.31210443e-02  9.47256449e-02  1.28733491e-02]
 [ 3.35288601e-01 -8.19009236e-04 -8.60652931e-02]
 [-4.86797506e-01 -2.83193623e-02 -5.06391720e-02]
 [ 4.46820264e-02 -1.26780817e-02 -3.92432534e-02]
 [ 2.20892128e-02 -2.84831027e-01  9.12860663e-02]
 [-1.06483249e-02 -2.21772604e-03  1.32972658e-02]
 [ 1.70459189e-01 -9.54741134e-02  2.64068535e-01]
 [ 7.93965421e-02  9.95629319e-02  5.99828713e-02]
 [ 7.46075752e-02 -1.09116859e-01 -5.93100520e-02]
 [-4.29660307e-02  5.99428192e-02  4.66767974e-02]
 [-5.07266333e-01 -2.64621082e-01  1.42431683e-01]
 [-1.39954081e-01  6.68773925e-03 -1.20619334e-02]
 [ 2.55839069e-01  1.09760916e+00  3.67036326e-01]
 [-3.30213120e-02 -7.71457989e-03  4.96686828e-02]
 [-9.39245693e-02  2.23596744e-01 -3.35145370e-02]
 [-5.86528789e-03  3.15382213e-02 -1.70467148e-03]
 [ 3.57055365e-02 -3.33483516e-02  4.49605982e-02]
 [ 4.45782591e-02  1.43311321e-01  9.19473431e-02]
 [-7.19974332e-02 -9.25761156e-02 -6.89749358e-02]
 [ 1.15100302e-01 -2.98046469e-02 -1.36028874e-02]
 [ 3.33799528e-02 -6.66357200e-02  9.83973499e-02]
 [-4.95579597e-02  4.30964487e-02  5.46006332e-02]
 [-6.25979843e-01  4.83086415e-02 -8.44176544e-01]
 [-4.06257529e-02 -1.23605139e-01 -1.90617361e-02]
 [-2.34020919e-02  6.35522522e-02  1.38819826e-01]
 [ 2.76031387e-02  1.51569104e-01 -3.75342773e-02]
 [-1.06139885e-01 -1.31723921e-03 -1.58230206e-01]
 [-6.01616543e-02  1.25612155e-01  1.28178021e-01]
 [ 2.75470184e-02 -3.71978205e-02  2.39735761e-02]
 [-2.66711532e-02 -1.09931304e-02  3.90762108e-02]
 [ 7.77062422e-02  6.07992928e-02  9.42691168e-03]
 [-1.18337308e-01  1.80820645e-01  6.60400842e-03]
 [ 2.10524720e-03 -2.43060927e-01  8.24350219e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.47348045]
curr_Stock_Price:  99.6013437224287
curr_Factors:  [99.60134372 -1.0198774  -1.03179294]
mat_Sqrt:  [[12.80076989  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00952627  0.03586528  0.49815667]
Stock Position:  -0.009526271436398547
Bond Position:  [0.47534899]


portfolio before change:  [-0.47932155]
curr_Stock_Price:  100.22073939106079
curr_Factors:  [100.22073939  -1.12800304  -1.00047861]
mat_Sqrt:  [[11.92805874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380456  0.01411938  0.0859571 ]
Stock Position:  -0.0038045623200241257
Bond Position:  [-0.09802551]


portfolio before change:  [-0.48015088]
curr_Stock_Price:  100.43550071628879
curr_Factors:  [100.43550072  -1.19386424  -0.98421352]
mat_Sqrt:  [[11.37522762  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02048538  0.00447255 -0.05718348]
Stock Position:  0.020485384100441026
Bond Position:  [-2.53761069]


portfolio before change:  [-0.47269226]
curr_Stock_Price:  100.81508078912269
curr_Factors:  [100.81508079  -1.2293187   -0.97630682]
mat_Sqrt:  [[11.10796523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177378 -0.00659539  0.21422481]
Stock Position:  0.001773777058854379
Bond Position:  [-0.65151574]


portfolio before change:  [-0.47413505]
curr_Stock_Price:  100.04759843115018
curr_Factors:  [100.04759843  -1.49198843  -0.96169149]
mat_Sqrt:  [[ 8.60175406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12679317 -0.10158646  0.07438099]
Stock Position:  -0.12679316893182202
Bond Position:  [12.211217]


portfolio before change:  [-0.4737058]
curr_Stock_Price:  100.05625226620693
curr_Factors:  [100.05625227  -1.2952347   -0.94928552]
mat_Sqrt:  [[10.60379897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362285 -0.01618305 -0.13085422]
Stock Position:  -0.0036228524136186413
Bond Position:  [-0.11121676]


portfolio before change:  [-0.47668423]
curr_Stock_Price:  100.87453888162403
curr_Factors:  [100.87453888  -1.49607659  -0.98537892]
mat_Sqrt:  [[ 8.43527267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00334247 0.02995488 0.03672408]
Stock Position:  0.0033424659077870016
Bond Position:  [-0.81385394]


portfolio before change:  [-0.47929454]
curr_Stock_Price:  100.12402439651547
curr_Factors:  [100.1240244   -1.20897421  -0.97400709]
mat_Sqrt:  [[11.28448039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02815366 -0.00025899 -0.24552033]
Stock Position:  0.02815366228908528
Bond Position:  [-3.29815251]


portfolio before change:  [-0.46166171]
curr_Stock_Price:  100.76497539423681
curr_Factors:  [100.76497539  -1.30087359  -0.99879182]
mat_Sqrt:  [[10.10596067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04926453 -0.00895537 -0.14445946]
Stock Position:  -0.04926452842811215
Bond Position:  [4.50247728]


portfolio before change:  [-0.43152393]
curr_Stock_Price:  100.16464613558392
curr_Factors:  [100.16464614  -1.22862738  -0.96574265]
mat_Sqrt:  [[11.16121993  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00325629 -0.00400916 -0.11195008]
Stock Position:  0.00325629137117703
Bond Position:  [-0.7576892]


portfolio before change:  [-0.4312929]
curr_Stock_Price:  100.26468193758765
curr_Factors:  [100.26468194  -0.99421265  -0.95195109]
mat_Sqrt:  [[14.31989403  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00233023 -0.09007148  0.26041374]
Stock Position:  0.0023302265707586503
Bond Position:  [-0.66493233]


portfolio before change:  [-0.43251073]
curr_Stock_Price:  99.77773065453479
curr_Factors:  [99.77773065 -0.82267088 -0.92263054]
mat_Sqrt:  [[17.42042899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045873 -0.00070131  0.0379334 ]
Stock Position:  -0.00045873114177908016
Bond Position:  [-0.38673958]


portfolio before change:  [-0.43286364]
curr_Stock_Price:  100.44165500884782
curr_Factors:  [100.44165501  -0.90542463  -0.93675458]
mat_Sqrt:  [[15.91716054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01394073 -0.03019157  0.75331403]
Stock Position:  0.01394072899043281
Bond Position:  [-1.83309353]


portfolio before change:  [-0.43808013]
curr_Stock_Price:  100.08390180391196
curr_Factors:  [100.0839018   -0.97243489  -0.93506455]
mat_Sqrt:  [[14.85756871  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00634096 0.03148456 0.17111444]
Stock Position:  0.006340956593565767
Bond Position:  [-1.07270781]


portfolio before change:  [-0.43636867]
curr_Stock_Price:  100.374956024021
curr_Factors:  [100.37495602  -1.34948085  -0.91610792]
mat_Sqrt:  [[10.4158009   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0057301  -0.03450578 -0.16919507]
Stock Position:  0.005730099580363122
Bond Position:  [-1.01152716]


portfolio before change:  [-0.4323341]
curr_Stock_Price:  101.10112348569228
curr_Factors:  [101.10112349  -1.23198544  -0.94834758]
mat_Sqrt:  [[11.42482041  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279133  0.01895558  0.13315591]
Stock Position:  -0.002791330735852605
Bond Position:  [-0.15012743]


portfolio before change:  [-0.43224364]
curr_Stock_Price:  101.06199315191711
curr_Factors:  [101.06199315  -1.26857918  -0.91696482]
mat_Sqrt:  [[11.3610418   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04269195 -0.08368053  0.40631795]
Stock Position:  -0.0426919540537011
Bond Position:  [3.88229032]


portfolio before change:  [-0.43979039]
curr_Stock_Price:  101.25013313628875
curr_Factors:  [101.25013314  -1.07317581  -0.90598702]
mat_Sqrt:  [[13.99123681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01016662  0.00211485 -0.03440934]
Stock Position:  -0.010166616291040622
Bond Position:  [0.58958086]


portfolio before change:  [-0.438115]
curr_Stock_Price:  101.09258916088633
curr_Factors:  [101.09258916  -0.93424001  -0.89170279]
mat_Sqrt:  [[16.28255069  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0220543  0.34709449 1.04705248]
Stock Position:  0.022054295952573022
Bond Position:  [-2.66764088]


portfolio before change:  [-0.44706884]
curr_Stock_Price:  100.70171917173079
curr_Factors:  [100.70171917  -0.90322169  -0.88785217]
mat_Sqrt:  [[16.79513086  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137432 -0.00243956  0.14169093]
Stock Position:  -0.00137432237836
Bond Position:  [-0.30867221]


portfolio before change:  [-0.44471915]
curr_Stock_Price:  98.96393836610233
curr_Factors:  [98.96393837 -0.93495609 -0.90281658]
mat_Sqrt:  [[15.75224426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00603041  0.0707075  -0.09560765]
Stock Position:  -0.006030407534509009
Bond Position:  [0.15207373]


portfolio before change:  [-0.44855668]
curr_Stock_Price:  99.60345402757422
curr_Factors:  [99.60345403 -0.92724226 -0.91571099]
mat_Sqrt:  [[15.77211637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034231  0.00997326 -0.00486295]
Stock Position:  -0.0003423091103849336
Bond Position:  [-0.41446151]


portfolio before change:  [-0.4487579]
curr_Stock_Price:  100.03990775216026
curr_Factors:  [100.03990775  -0.96891074  -0.92250989]
mat_Sqrt:  [[15.09175478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00291696 -0.01054567  0.12826007]
Stock Position:  0.0029169589653552284
Bond Position:  [-0.7405702]


portfolio before change:  [-0.44809183]
curr_Stock_Price:  100.29998825070912
curr_Factors:  [100.29998825  -1.24703691  -0.95970248]
mat_Sqrt:  [[11.03890868  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00607372 0.04531902 0.26230018]
Stock Position:  0.006073717632942198
Bond Position:  [-1.05728564]


portfolio before change:  [-0.45418809]
curr_Stock_Price:  99.31803721065195
curr_Factors:  [99.31803721 -1.15176473 -0.94850503]
mat_Sqrt:  [[12.15885172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00727595 -0.02927514 -0.19676629]
Stock Position:  -0.00727594925345325
Bond Position:  [0.26844491]


portfolio before change:  [-0.44959456]
curr_Stock_Price:  98.69131885139106
curr_Factors:  [98.69131885 -1.16740723 -0.90955523]
mat_Sqrt:  [[12.36703589  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00902028 -0.00942506 -0.03880525]
Stock Position:  0.009020275582376591
Bond Position:  [-1.33981746]


portfolio before change:  [-0.46121593]
curr_Stock_Price:  97.42152589716348
curr_Factors:  [97.4215259  -0.98528779 -0.91139142]
mat_Sqrt:  [[14.61967141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00353939 -0.02107206  0.28070025]
Stock Position:  0.0035393887732733235
Bond Position:  [-0.80602859]


portfolio before change:  [-0.46273727]
curr_Stock_Price:  97.02016351286673
curr_Factors:  [97.02016351 -0.95483587 -0.88560874]
mat_Sqrt:  [[15.40164333  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242181  0.01362829  0.15576041]
Stock Position:  -0.002421813427897038
Bond Position:  [-0.22777254]


portfolio before change:  [-0.46666973]
curr_Stock_Price:  98.6321715944013
curr_Factors:  [98.63217159 -1.06150981 -0.86434914]
mat_Sqrt:  [[14.3756895   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05544425  0.01527653 -2.40820071]
Stock Position:  -0.055444250801062314
Bond Position:  [5.00191713]


portfolio before change:  [-0.48317469]
curr_Stock_Price:  98.94113495761707
curr_Factors:  [98.94113496 -1.17306191 -0.87775288]
mat_Sqrt:  [[12.72680353  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374864 -0.03908738 -0.05437783]
Stock Position:  -0.003748638404496198
Bond Position:  [-0.11228015]


portfolio before change:  [-0.4809515]
curr_Stock_Price:  98.34432368693334
curr_Factors:  [98.34432369 -1.07448805 -0.86460199]
mat_Sqrt:  [[14.14533353  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00046484 0.02009699 0.39601432]
Stock Position:  0.00046483870623675985
Bond Position:  [-0.52666574]


portfolio before change:  [-0.48116089]
curr_Stock_Price:  98.03549443149615
curr_Factors:  [98.03549443 -0.86965063 -0.84737553]
mat_Sqrt:  [[17.60712119  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135485  0.04793036 -0.10707485]
Stock Position:  0.0013548486207298385
Bond Position:  [-0.61398414]


portfolio before change:  [-0.4805619]
curr_Stock_Price:  98.53425323318875
curr_Factors:  [98.53425323 -1.04974899 -0.83605661]
mat_Sqrt:  [[14.94831569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.26341831e-03 -4.16547612e-04 -4.51386734e-01]
Stock Position:  -0.009263418307844802
Bond Position:  [0.43220211]


portfolio before change:  [-0.4769067]
curr_Stock_Price:  98.14550151290365
curr_Factors:  [98.14550151 -1.13962046 -0.83518752]
mat_Sqrt:  [[13.62141383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225778  0.03972205  0.36565622]
Stock Position:  -0.0022577783653672493
Bond Position:  [-0.25531591]


portfolio before change:  [-0.47754093]
curr_Stock_Price:  98.41227540348731
curr_Factors:  [98.4122754  -1.1867577  -0.81731477]
mat_Sqrt:  [[13.26452358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00237326 -0.01176298  0.06838994]
Stock Position:  0.0023732597938936127
Bond Position:  [-0.71109883]


portfolio before change:  [-0.47735926]
curr_Stock_Price:  98.52628293867635
curr_Factors:  [98.52628294 -1.21076097 -0.80508666]
mat_Sqrt:  [[13.12443445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144605 -0.00347633  0.11147355]
Stock Position:  -0.001446050616567211
Bond Position:  [-0.33488527]


portfolio before change:  [-0.47559508]
curr_Stock_Price:  97.2773331695015
curr_Factors:  [97.27733317 -1.01548545 -0.79518631]
mat_Sqrt:  [[15.9091473   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.005104   0.01922642 0.02689236]
Stock Position:  0.005104002868365594
Bond Position:  [-0.97209886]


portfolio before change:  [-0.47507819]
curr_Stock_Price:  97.40241210451673
curr_Factors:  [97.4024121  -0.90541607 -0.78739335]
mat_Sqrt:  [[17.92222487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00626711  0.05718051  0.0188394 ]
Stock Position:  -0.0062671070056185395
Bond Position:  [0.13535315]


portfolio before change:  [-0.47397841]
curr_Stock_Price:  97.22962731223602
curr_Factors:  [97.22962731 -1.06735983 -0.79421317]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.47397841]
Stock Price:  95.75358215439867
PL:  [-0.47397841]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-2.10777524e-01  1.83508272e-02  1.51671806e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.41841933e-01  2.62182996e-01  3.71413975e-01]
 [-3.99828438e-02  8.65056650e-03  1.04731721e-01]
 [-2.75872196e-01 -9.12929772e-02  4.59119825e-02]
 [ 3.34469336e-03 -1.10784202e-01 -1.36267580e-01]
 [ 3.40399037e-02  9.51510014e-03 -2.15142550e-02]
 [ 2.79838547e-01 -2.97184505e-02 -6.22885699e-02]
 [-4.80433881e-01 -2.67864500e-02 -5.42624482e-02]
 [ 3.76746029e-02 -7.73222618e-04 -3.36647074e-02]
 [ 1.38940223e-02 -2.88903529e-01  1.59575212e-01]
 [-1.45717921e-01  1.99473812e-02  1.14178628e-01]
 [ 7.12658066e-02 -1.08915149e-02  2.45467733e-01]
 [ 3.42067383e-02  3.56954596e-01  3.12787484e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-1.70923570e-02 -4.45745166e-03  3.66752821e-02]
 [-5.06637405e-01 -2.39542897e-01  1.39510842e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 9.38453408e-02  7.07274699e-01  1.43285402e-01]
 [-2.81424482e-02  4.92555796e-02  2.50011310e-02]
 [ 3.61614610e-02 -1.42155530e-01  7.85724326e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.37698876e-01 -2.94323891e-02  1.48216123e-01]
 [ 8.25963051e-02 -4.83808521e-02 -4.73519324e-02]
 [-7.49813560e-02 -5.51930962e-02  1.38891856e-01]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [-7.39373602e-03 -6.82897920e-02  1.40140586e-02]
 [ 3.32165907e-02  5.05971763e-02 -8.47535123e-02]
 [-5.98840457e-01 -1.69111812e-02 -8.70243691e-01]
 [-2.43039044e-01  8.02651489e-02  1.65671879e-03]
 [-3.11972413e-02  3.72857983e-02  1.16252868e-01]
 [ 1.36651809e-02  3.94023391e-02  1.69140991e-02]
 [-1.51337733e-01 -1.15618644e-02 -1.23365294e-01]
 [-6.49588967e-02  1.07485813e-02  5.53306293e-02]
 [ 2.38696662e-01 -1.76092745e-01 -6.94302930e-02]
 [ 7.97999780e-04  7.91154244e-02  7.76640814e-02]
 [ 1.13103198e-02  1.11904932e-02 -4.51066513e-02]
 [-6.46514033e-02  9.00912076e-02 -5.64983857e-03]
 [-6.17524497e-02 -2.33886939e-01  9.63181744e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.51493377]
curr_Stock_Price:  99.73905944095979
curr_Factors:  [99.73905944 -0.9035863  -0.974006  ]
mat_Sqrt:  [[15.25588092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01175572  0.00580304  0.43267745]
Stock Position:  -0.011755717735749868
Bond Position:  [1.687438]


portfolio before change:  [0.51688705]
curr_Stock_Price:  99.59084737140957
curr_Factors:  [99.59084737 -1.05087926 -0.97023076]
mat_Sqrt:  [[13.19661365  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343884  0.01411938  0.0859571 ]
Stock Position:  -0.0034388399981615065
Bond Position:  [0.85936404]


portfolio before change:  [0.51738386]
curr_Stock_Price:  99.4776150786322
curr_Factors:  [99.47761508 -0.98988117 -0.97915563]
mat_Sqrt:  [[13.88620428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02336319 0.08290954 1.05954069]
Stock Position:  0.023363189984197622
Bond Position:  [-1.80673056]


portfolio before change:  [0.49495261]
curr_Stock_Price:  98.5271710960546
curr_Factors:  [98.5271711  -0.89093311 -0.98772955]
mat_Sqrt:  [[15.05439089  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00122099  0.00273555  0.29877045]
Stock Position:  -0.0012209869045152358
Bond Position:  [0.61525299]


portfolio before change:  [0.49548517]
curr_Stock_Price:  98.15398489626543
curr_Factors:  [98.1539849  -0.89350816 -0.9920518 ]
mat_Sqrt:  [[14.89428461  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01805106 -0.02886937  0.13097411]
Stock Position:  -0.018051060095111166
Bond Position:  [2.26726865]


portfolio before change:  [0.47513505]
curr_Stock_Price:  99.29705071797396
curr_Factors:  [99.29705072 -1.02948383 -0.9972459 ]
mat_Sqrt:  [[13.08394808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208891 -0.03503304 -0.38873348]
Stock Position:  -0.002088914265862192
Bond Position:  [0.68255808]


portfolio before change:  [0.47371758]
curr_Stock_Price:  100.01646614077094
curr_Factors:  [100.01646614  -0.96102232  -1.01481589]
mat_Sqrt:  [[13.86678798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0021558   0.00300894 -0.06137418]
Stock Position:  0.002155798707932263
Bond Position:  [0.25810221]


portfolio before change:  [0.47388169]
curr_Stock_Price:  100.07762547773608
curr_Factors:  [100.07762548  -0.93749268  -1.02481543]
mat_Sqrt:  [[14.06427692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01893852 -0.0093978  -0.17769195]
Stock Position:  0.01893852203421454
Bond Position:  [-1.42144063]


portfolio before change:  [0.49102051]
curr_Stock_Price:  100.99197938195623
curr_Factors:  [100.99197938  -0.70380358  -1.02267808]
mat_Sqrt:  [[17.96740788  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02739415 -0.00847062 -0.15479566]
Stock Position:  -0.027394145182920347
Bond Position:  [3.25760946]


portfolio before change:  [0.47210149]
curr_Stock_Price:  101.69746747993698
curr_Factors:  [101.69746748  -0.6360576   -1.05124729]
mat_Sqrt:  [[18.81581074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00163601 -0.00024451 -0.09603604]
Stock Position:  0.001636010225431431
Bond Position:  [0.3057234]


portfolio before change:  [0.47352979]
curr_Stock_Price:  102.54714295327528
curr_Factors:  [102.54714295  -0.57795322  -1.06896052]
mat_Sqrt:  [[19.75504469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197457 -0.09135932  0.45522366]
Stock Position:  0.0019745700238533925
Bond Position:  [0.27104327]


portfolio before change:  [0.474847]
curr_Stock_Price:  103.19706896421874
curr_Factors:  [103.19706896  -0.58725026  -1.06313398]
mat_Sqrt:  [[19.81137402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00615284  0.00630792  0.32571984]
Stock Position:  -0.006152842647891422
Bond Position:  [1.10980232]


portfolio before change:  [0.47734263]
curr_Stock_Price:  102.81401037534322
curr_Factors:  [102.81401038  -0.69124796  -1.04079951]
mat_Sqrt:  [[18.19003948  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00665697 -0.0034442   0.70025112]
Stock Position:  0.00665696631811196
Bond Position:  [-0.20708678]


portfolio before change:  [0.48036571]
curr_Stock_Price:  103.27202138982382
curr_Factors:  [103.27202139  -0.79220928  -1.05514922]
mat_Sqrt:  [[16.28114983  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00658865 0.11287895 0.89229563]
Stock Position:  0.0065886467030765354
Bond Position:  [-0.20005716]


portfolio before change:  [0.47915395]
curr_Stock_Price:  103.09190113710505
curr_Factors:  [103.09190114  -0.81441308  -1.06138227]
mat_Sqrt:  [[15.79708593  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00271735 -0.03587186 -0.12433753]
Stock Position:  0.002717345073734622
Bond Position:  [0.19901768]


portfolio before change:  [0.47896275]
curr_Stock_Price:  103.01238474158644
curr_Factors:  [103.01238474  -0.99049572  -1.04498932]
mat_Sqrt:  [[13.45518035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072248 -0.00140957  0.10462437]
Stock Position:  -0.0007224828682979423
Bond Position:  [0.55338744]


portfolio before change:  [0.47884823]
curr_Stock_Price:  103.26664238624168
curr_Factors:  [103.26664239  -0.98397539  -1.04744435]
mat_Sqrt:  [[13.54333656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03576259 -0.07575012  0.3979856 ]
Stock Position:  -0.03576259387263405
Bond Position:  [4.17193123]


portfolio before change:  [0.45755369]
curr_Stock_Price:  103.87666714387967
curr_Factors:  [103.87666714  -0.80640569  -1.02738993]
mat_Sqrt:  [[16.60009939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00791026  0.00580111 -0.05715682]
Stock Position:  -0.007910258891723197
Bond Position:  [1.27924502]


portfolio before change:  [0.44886252]
curr_Stock_Price:  104.99560431694655
curr_Factors:  [104.99560432  -0.89177318  -1.0060835 ]
mat_Sqrt:  [[15.73774252  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00898192 0.2236599  0.40875337]
Stock Position:  0.008981917509857919
Bond Position:  [-0.49419933]


portfolio before change:  [0.44612862]
curr_Stock_Price:  104.69810354985185
curr_Factors:  [104.69810355  -1.20002455  -1.01626711]
mat_Sqrt:  [[11.41341416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190717  0.01557598  0.07132127]
Stock Position:  -0.0019071716677142548
Bond Position:  [0.64580587]


portfolio before change:  [0.44734656]
curr_Stock_Price:  104.10182104534238
curr_Factors:  [104.10182105  -1.19496143  -1.00635164]
mat_Sqrt:  [[11.51967448  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00421275 -0.04495353  0.22414528]
Stock Position:  0.004212753729707489
Bond Position:  [0.00879123]


portfolio before change:  [0.44316721]
curr_Stock_Price:  103.10948838970843
curr_Factors:  [103.10948839  -1.02549214  -1.00337885]
mat_Sqrt:  [[13.55723605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286702  0.01916992 -0.08961985]
Stock Position:  -0.002867019764068733
Bond Position:  [0.73878415]


portfolio before change:  [0.44363592]
curr_Stock_Price:  102.97821792347388
curr_Factors:  [102.97821792  -0.97175535  -1.01929045]
mat_Sqrt:  [[14.06193763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01188979 -0.00930734  0.42281934]
Stock Position:  0.011889785674504617
Bond Position:  [-0.78075302]


portfolio before change:  [0.44383485]
curr_Stock_Price:  103.0031581194762
curr_Factors:  [103.00315812  -0.87557346  -1.03894971]
mat_Sqrt:  [[15.18391257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00472088 -0.01529937 -0.13508188]
Stock Position:  0.0047208809833725034
Bond Position:  [-0.0424308]


portfolio before change:  [0.44337481]
curr_Stock_Price:  102.9068334534386
curr_Factors:  [102.90683345  -0.88782143  -1.03700309]
mat_Sqrt:  [[15.01424664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320064 -0.01745359  0.39621981]
Stock Position:  -0.0032006437197621886
Bond Position:  [0.77274292]


portfolio before change:  [0.44382045]
curr_Stock_Price:  102.79778030925794
curr_Factors:  [102.79778031  -0.93586754  -1.0587918 ]
mat_Sqrt:  [[13.98666567  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00092632  0.02004328 -0.05140267]
Stock Position:  0.0009263167651509363
Bond Position:  [0.34859714]


portfolio before change:  [0.44373232]
curr_Stock_Price:  102.65559524197612
curr_Factors:  [102.65559524  -1.12176214  -1.05508391]
mat_Sqrt:  [[11.641003    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054088 -0.02159513  0.03997821]
Stock Position:  -0.000540878060593981
Bond Position:  [0.49925647]


portfolio before change:  [0.44399102]
curr_Stock_Price:  102.29267821418985
curr_Factors:  [102.29267821  -1.06378078  -1.04307222]
mat_Sqrt:  [[12.44084612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138437  0.01600023 -0.24177818]
Stock Position:  0.0013843725562265458
Bond Position:  [0.30237984]


portfolio before change:  [0.44248134]
curr_Stock_Price:  101.17485483321282
curr_Factors:  [101.17485483  -1.23981648  -1.02943858]
mat_Sqrt:  [[10.46038427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07427211 -0.00534779 -2.48256302]
Stock Position:  -0.07427211383181792
Bond Position:  [7.95695167]


portfolio before change:  [0.37116139]
curr_Stock_Price:  102.14849924070373
curr_Factors:  [102.14849924  -1.25116693  -1.03701864]
mat_Sqrt:  [[10.36300292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02321995  0.02538207  0.00472616]
Stock Position:  -0.0232199520448932
Bond Position:  [2.74304464]


portfolio before change:  [0.3643526]
curr_Stock_Price:  102.45649675797368
curr_Factors:  [102.45649676  -1.39858878  -1.00910074]
mat_Sqrt:  [[ 9.22344642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070521  0.0117908   0.33163707]
Stock Position:  -0.0007052145807812865
Bond Position:  [0.43660642]


portfolio before change:  [0.36411162]
curr_Stock_Price:  102.87560160052074
curr_Factors:  [102.8756016   -1.16002142  -0.99539625]
mat_Sqrt:  [[11.91863129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00152158 0.01246011 0.04825122]
Stock Position:  0.0015215774792830818
Bond Position:  [0.20757843]


portfolio before change:  [0.36459555]
curr_Stock_Price:  103.17658805230823
curr_Factors:  [103.17658805  -0.95447728  -0.98975712]
mat_Sqrt:  [[14.76423298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01197611 -0.00365618 -0.35192685]
Stock Position:  -0.01197611107026428
Bond Position:  [1.60024983]


portfolio before change:  [0.37312037]
curr_Stock_Price:  102.4814726663251
curr_Factors:  [102.48147267  -1.12321463  -1.00980782]
mat_Sqrt:  [[12.14186721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00439694  0.003399    0.15784288]
Stock Position:  -0.004396939217960077
Bond Position:  [0.82372518]


portfolio before change:  [0.37465337]
curr_Stock_Price:  102.15624011608276
curr_Factors:  [102.15624012  -1.1518049   -0.99430994]
mat_Sqrt:  [[11.94590525  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01841447 -0.05568542 -0.1980653 ]
Stock Position:  0.018414474497825996
Bond Position:  [-1.50650011]


portfolio before change:  [0.38742761]
curr_Stock_Price:  102.86017331269575
curr_Factors:  [102.86017331  -0.99416216  -1.01360339]
mat_Sqrt:  [[13.81292819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00135336 0.02501849 0.22155401]
Stock Position:  0.0013533600711219133
Bond Position:  [0.24822075]


portfolio before change:  [0.38753173]
curr_Stock_Price:  102.91418482670319
curr_Factors:  [102.91418483  -0.94733451  -0.99339129]
mat_Sqrt:  [[14.7784447   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00016185  0.00353874 -0.12867672]
Stock Position:  0.0001618506209969628
Bond Position:  [0.37087501]


portfolio before change:  [0.38756543]
curr_Stock_Price:  102.83591661377774
curr_Factors:  [102.83591661  -0.94904143  -0.95333239]
mat_Sqrt:  [[15.34455752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00413688  0.02848934 -0.01611742]
Stock Position:  -0.004136875680587979
Bond Position:  [0.81298483]


portfolio before change:  [0.38840045]
curr_Stock_Price:  102.65863564845034
curr_Factors:  [102.65863565  -0.74199997  -0.95395404]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.38840045]
Stock Price:  101.70841908565554
PL:  [-1.32001864]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.40559661e-01  1.42667465e-03  6.60513918e-02]
 [-7.92130980e-02  5.39303297e-02  6.10942361e-02]
 [ 1.66775437e-01  2.27722507e-01  3.65285114e-01]
 [-1.10522218e-01 -3.16264638e-02  4.46571274e-02]
 [-9.80892792e-01 -2.90998307e-01  2.86830902e-02]
 [ 3.28331734e-03 -8.95089166e-02 -1.13028498e-01]
 [ 2.79515252e-02 -6.82750804e-02 -3.51141514e-02]
 [ 4.08353769e-01  1.14043605e-01 -1.25078601e-01]
 [-3.73550469e-01 -5.44524731e-03 -9.65690349e-02]
 [ 3.06754532e-02  1.11175802e-02 -2.80927480e-02]
 [-1.25114532e-02 -1.87922595e-01  4.08963008e-02]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.94673369e-01 -1.33617104e-01  2.16354119e-01]
 [ 6.16510624e-02  1.45935627e-01  1.00511184e-01]
 [ 8.77570019e-02 -1.09095642e-01 -6.56225902e-02]
 [-4.93727649e-02  1.12711068e-02  3.11283208e-02]
 [-4.81901860e-01 -2.67214631e-01  1.33098585e-01]
 [-1.70940496e-01  1.98243509e-03 -2.54629880e-02]
 [ 3.48776845e-01  1.35762245e+00  5.71079505e-01]
 [-1.68504772e-01 -2.42344241e-02  1.36211480e-01]
 [-9.35028694e-02  2.09917783e-01 -3.41559410e-02]
 [ 1.05847193e-02  2.84757570e-02  4.28310529e-03]
 [ 2.37085068e-02 -2.99590498e-02  1.91529810e-02]
 [ 3.71874226e-02  1.26329086e-01  1.00357826e-01]
 [-5.83531684e-02 -1.56682403e-01 -4.94570157e-02]
 [ 7.11967280e-02  2.82814956e-02 -1.14699869e-02]
 [ 3.65846664e-02 -6.58572886e-02  1.19872021e-01]
 [ 4.33266673e-02  5.16671317e-02 -6.75926978e-02]
 [-7.65577283e-01 -1.76726370e-01 -1.20438118e+00]
 [-1.06567428e-01  4.33365902e-02  7.15051643e-03]
 [-2.22282736e-02 -7.30843447e-02  1.16118169e-01]
 [ 2.24431988e-02  8.67445722e-02 -5.39067674e-03]
 [-1.19463402e-01 -9.32542843e-03 -6.42431535e-02]
 [-6.08901044e-02  1.08170389e-01  1.17116314e-01]
 [ 1.61922092e-01 -1.62089353e-01 -9.99562957e-02]
 [-3.02200248e-02  2.66416552e-01  8.39042427e-02]
 [ 8.78922900e-02  7.28950124e-02 -2.89989901e-02]
 [-2.07600875e-02  6.83162642e-02 -1.03521934e-02]
 [-1.28485660e-01 -2.61003128e-01  5.35643451e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.57180137]
curr_Stock_Price:  100.02564273318025
curr_Factors:  [100.02564273  -0.91924841  -0.99077342]
mat_Sqrt:  [[14.81151259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00857712  0.00045115  0.18842624]
Stock Position:  -0.008577121320056098
Bond Position:  [3.42973344]


portfolio before change:  [2.58172151]
curr_Stock_Price:  98.91904807826047
curr_Factors:  [98.91904808 -0.9572783  -0.99204849]
mat_Sqrt:  [[14.08309344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0046403   0.01705427  0.17428485]
Stock Position:  -0.004640302534202582
Bond Position:  [3.04073582]


portfolio before change:  [2.58436783]
curr_Stock_Price:  98.43067381754382
curr_Factors:  [98.43067382 -1.19325856 -0.98986582]
mat_Sqrt:  [[11.09204406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02228793 0.07201218 1.04205675]
Stock Position:  0.022287931545419786
Bond Position:  [0.39055171]


portfolio before change:  [2.59240964]
curr_Stock_Price:  98.78929816318549
curr_Factors:  [98.78929816 -1.53159729 -0.97266504]
mat_Sqrt:  [[ 8.07462915  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0126598  -0.01000117  0.12739435]
Stock Position:  -0.01265980274692007
Bond Position:  [3.84306267]


portfolio before change:  [2.58216497]
curr_Stock_Price:  99.6364746052742
curr_Factors:  [99.63647461 -1.45738543 -0.98025365]
mat_Sqrt:  [[ 8.70492733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11287302 -0.09202174  0.08182487]
Stock Position:  -0.11287301861132419
Bond Position:  [13.82843462]


portfolio before change:  [2.62240618]
curr_Stock_Price:  99.2952721612231
curr_Factors:  [99.29527216 -1.54477658 -0.94294772]
mat_Sqrt:  [[ 8.25132386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267831 -0.0283052  -0.32243884]
Stock Position:  -0.0026783142680766527
Bond Position:  [2.88835013]


portfolio before change:  [2.62286165]
curr_Stock_Price:  99.26002422137906
curr_Factors:  [99.26002422 -1.64167189 -0.91398391]
mat_Sqrt:  [[ 7.70667712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00246812 -0.02159048 -0.1001709 ]
Stock Position:  0.0024681226105087656
Bond Position:  [2.37787574]


portfolio before change:  [2.62377883]
curr_Stock_Price:  99.51119564243228
curr_Factors:  [99.51119564 -1.67447158 -0.88486342]
mat_Sqrt:  [[ 7.69780444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05011387  0.03606375 -0.35681443]
Stock Position:  0.0501138737162747
Bond Position:  [-2.36311266]


portfolio before change:  [2.64485032]
curr_Stock_Price:  99.93756249573036
curr_Factors:  [99.9375625  -1.85322384 -0.89922609]
mat_Sqrt:  [[ 6.37316171  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0617281  -0.00172194 -0.27548458]
Stock Position:  -0.06172809578892113
Bond Position:  [8.81380575]


portfolio before change:  [2.64129323]
curr_Stock_Price:  100.01303671957423
curr_Factors:  [100.01303672  -1.88357332  -0.92826564]
mat_Sqrt:  [[ 6.01022138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00419753  0.00351569 -0.08014079]
Stock Position:  0.004197532523061282
Bond Position:  [2.22148526]


portfolio before change:  [2.64189485]
curr_Stock_Price:  100.09020593506642
curr_Factors:  [100.09020594  -1.69935163  -0.96456849]
mat_Sqrt:  [[ 6.97374038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012928  -0.05942634  0.11666576]
Stock Position:  -0.0012928028316963036
Bond Position:  [2.77129175]


portfolio before change:  [2.64115074]
curr_Stock_Price:  100.93375400986349
curr_Factors:  [100.93375401  -1.71407193  -0.98804704]
mat_Sqrt:  [[ 6.76894627  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01065537  0.00225658  0.15019092]
Stock Position:  -0.010655368756140364
Bond Position:  [3.71663711]


portfolio before change:  [2.64609175]
curr_Stock_Price:  100.51364663644887
curr_Factors:  [100.51364664  -1.56899609  -0.97740965]
mat_Sqrt:  [[ 7.87653248  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02988453 -0.04225344  0.61719808]
Stock Position:  0.029884532305148977
Bond Position:  [-0.35771157]


portfolio before change:  [2.64329027]
curr_Stock_Price:  100.42139937955068
curr_Factors:  [100.42139938  -1.51963577  -0.96149449]
mat_Sqrt:  [[ 8.40011224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01023032 0.0461489  0.28673043]
Stock Position:  0.010230323258091652
Bond Position:  [1.61594689]


portfolio before change:  [2.63763052]
curr_Stock_Price:  99.84842055848266
curr_Factors:  [99.84842056 -1.59875446 -0.96421106]
mat_Sqrt:  [[ 7.69590005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00929651 -0.03449907 -0.18720298]
Stock Position:  0.009296509697860639
Bond Position:  [1.70938871]


portfolio before change:  [2.63511466]
curr_Stock_Price:  99.5548107088991
curr_Factors:  [99.55481071 -1.33224099 -0.94815392]
mat_Sqrt:  [[10.1788643   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00419769  0.00356424  0.08880043]
Stock Position:  -0.004197688766165668
Bond Position:  [3.05301477]


portfolio before change:  [2.63369655]
curr_Stock_Price:  99.98356158804522
curr_Factors:  [99.98356159 -1.23019319 -0.94394281]
mat_Sqrt:  [[11.36876626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04060535 -0.08450069  0.37969321]
Stock Position:  -0.040605345106601805
Bond Position:  [6.69356357]


portfolio before change:  [2.65093781]
curr_Stock_Price:  99.5795625075304
curr_Factors:  [99.57956251 -1.28610824 -0.91791326]
mat_Sqrt:  [[10.98944698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01602327  0.0006269  -0.07263882]
Stock Position:  -0.01602327407756733
Bond Position:  [4.24652844]


portfolio before change:  [2.66341204]
curr_Stock_Price:  98.83418560450289
curr_Factors:  [98.8341856  -1.18884299 -0.93461555]
mat_Sqrt:  [[11.82226966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04232704 0.42931791 1.62913087]
Stock Position:  0.042327035010215695
Bond Position:  [-1.51994599]


portfolio before change:  [2.6735893]
curr_Stock_Price:  99.07911799896127
curr_Factors:  [99.079118   -1.11298998 -0.93616021]
mat_Sqrt:  [[12.7657845   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01107072 -0.0076636   0.38857344]
Stock Position:  -0.011070721929529717
Bond Position:  [3.77046666]


portfolio before change:  [2.67408738]
curr_Stock_Price:  99.0767022655122
curr_Factors:  [99.07670227 -0.96148325 -0.91830362]
mat_Sqrt:  [[15.12134702  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00628614  0.06638183 -0.09743739]
Stock Position:  -0.006286137582609207
Bond Position:  [3.29689716]


portfolio before change:  [2.66840638]
curr_Stock_Price:  100.04599991054965
curr_Factors:  [100.04599991  -1.30488973  -0.93544375]
mat_Sqrt:  [[10.64719624  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0011453  0.00900483 0.01221851]
Stock Position:  0.0011453010821193923
Bond Position:  [2.55382359]


portfolio before change:  [2.66820734]
curr_Stock_Price:  99.59346895469686
curr_Factors:  [99.59346895 -1.14474118 -0.91616762]
mat_Sqrt:  [[12.68205232  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00211674 -0.00947388  0.05463812]
Stock Position:  0.0021167357381209873
Bond Position:  [2.45739429]


portfolio before change:  [2.66870379]
curr_Stock_Price:  99.68287459218023
curr_Factors:  [99.68287459 -1.17944924 -0.89413972]
mat_Sqrt:  [[12.53349848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00486175 0.03994876 0.28629294]
Stock Position:  0.004861745591029437
Bond Position:  [2.18407101]


portfolio before change:  [2.67116743]
curr_Stock_Price:  100.1334577145674
curr_Factors:  [100.13345771  -1.15059826  -0.8802854 ]
mat_Sqrt:  [[13.13946392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00551728 -0.04954733 -0.1410871 ]
Stock Position:  -0.0055172769676483215
Bond Position:  [3.22363145]


portfolio before change:  [2.67157374]
curr_Stock_Price:  100.13285468490345
curr_Factors:  [100.13285468  -0.71253457  -0.88639487]
mat_Sqrt:  [[20.23812928  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00343834  0.00894339 -0.03272068]
Stock Position:  0.003438344071167307
Bond Position:  [2.32728253]


portfolio before change:  [2.67777575]
curr_Stock_Price:  101.85202130198635
curr_Factors:  [101.8520213   -0.47801771  -0.8853613 ]
mat_Sqrt:  [[26.05323588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227814 -0.0208259   0.34196151]
Stock Position:  0.002278143595504975
Bond Position:  [2.44574222]


portfolio before change:  [2.67988896]
curr_Stock_Price:  102.64541877752191
curr_Factors:  [102.64541878  -0.533913    -0.89071114]
mat_Sqrt:  [[24.69637245  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124971  0.01633858 -0.19282315]
Stock Position:  0.0012497141161439162
Bond Position:  [2.55161154]


portfolio before change:  [2.68100171]
curr_Stock_Price:  103.2805849042788
curr_Factors:  [103.2805849   -0.72377331  -0.87412173]
mat_Sqrt:  [[20.89592932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04862113 -0.05588579 -3.43576427]
Stock Position:  -0.04862112622524996
Bond Position:  [7.70262007]


portfolio before change:  [2.64961676]
curr_Stock_Price:  103.94588917990058
curr_Factors:  [103.94588918  -0.79354023  -0.88371922]
mat_Sqrt:  [[19.42597368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00535309  0.01370423  0.02039843]
Stock Position:  -0.005353085032813264
Bond Position:  [3.20604794]


portfolio before change:  [2.64547171]
curr_Stock_Price:  104.79508652230929
curr_Factors:  [104.79508652  -0.69935515  -0.88542789]
mat_Sqrt:  [[21.48218187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.92150583e-05 -2.31112991e-02  3.31252814e-01]
Stock Position:  -1.9215058304814025e-05
Bond Position:  [2.64748535]


portfolio before change:  [2.64581456]
curr_Stock_Price:  104.17602665954088
curr_Factors:  [104.17602666  -0.99504527  -0.86230579]
mat_Sqrt:  [[16.26037178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00145031  0.02743104 -0.0153781 ]
Stock Position:  0.001450309195362489
Bond Position:  [2.49472711]


portfolio before change:  [2.64612994]
curr_Stock_Price:  104.1784501502124
curr_Factors:  [104.17845015  -0.80215717  -0.86323232]
mat_Sqrt:  [[19.70191425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00674136 -0.00294896 -0.18326784]
Stock Position:  -0.006741363353521812
Bond Position:  [3.34843472]


portfolio before change:  [2.65106919]
curr_Stock_Price:  103.50786339301659
curr_Factors:  [103.50786339  -0.7693311   -0.85596101]
mat_Sqrt:  [[20.37595383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001678    0.03420648  0.33410025]
Stock Position:  -0.0016780019119747296
Bond Position:  [2.82475558]


portfolio before change:  [2.64901223]
curr_Stock_Price:  104.94414049329446
curr_Factors:  [104.94414049  -0.90399598  -0.8416002 ]
mat_Sqrt:  [[18.31704475  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00749758 -0.05125715 -0.28514749]
Stock Position:  0.007497577868876404
Bond Position:  [1.86218536]


portfolio before change:  [2.65714751]
curr_Stock_Price:  105.99814684337528
curr_Factors:  [105.99814684  -1.04832244  -0.85938843]
mat_Sqrt:  [[15.73221839  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.000395    0.08424831  0.23935545]
Stock Position:  -0.0003950045077912432
Bond Position:  [2.69901726]


portfolio before change:  [2.65758641]
curr_Stock_Price:  105.74118127868729
curr_Factors:  [105.74118128  -0.9988836   -0.88605903]
mat_Sqrt:  [[16.05550519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00522282  0.02305143 -0.08272605]
Stock Position:  0.00522282146128617
Bond Position:  [2.1053191]


portfolio before change:  [2.66158523]
curr_Stock_Price:  106.45643491916428
curr_Factors:  [106.45643492  -0.91405667  -0.86839912]
mat_Sqrt:  [[17.9085821   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00117873  0.0216035  -0.02953193]
Stock Position:  -0.0011787254676333726
Bond Position:  [2.78706815]


portfolio before change:  [2.66082935]
curr_Stock_Price:  107.39328624901611
curr_Factors:  [107.39328625  -0.77266063  -0.87025879]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.66082935]
Stock Price:  106.60580331247576
PL:  [-3.94497396]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.17968467e-01 -1.46047678e-02  2.92575605e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.06651792e-01  1.92691161e-01  2.79938763e-01]
 [-9.86681065e-02 -4.71312055e-02  6.01223916e-02]
 [-7.03655702e-01 -2.12467659e-01  3.54580526e-02]
 [ 5.41911370e-02 -1.80196843e-01 -2.43972653e-01]
 [ 1.66185739e-02 -3.27784708e-01 -5.07607922e-02]
 [ 6.30249884e-02  2.79689887e-01 -1.15884538e-02]
 [-1.76988862e-01  1.05222143e-02 -7.63519831e-02]
 [ 1.03240835e-01 -2.42625905e-02  4.40435405e-02]
 [ 1.60645771e-01 -2.76707119e-01 -1.74790800e-02]
 [-1.40263085e-01 -1.08033161e-01 -2.36522280e-01]
 [ 2.78459376e-01 -3.45282631e-01 -9.31552434e-02]
 [ 5.80916290e-02 -1.04793059e-01 -5.59901658e-02]
 [-2.25963105e-01  3.93052480e-01  2.79342008e-01]
 [ 6.90388717e-02 -4.64236519e-01 -1.26872343e-01]
 [ 1.50693238e-01 -2.06134324e-01 -1.13123395e-01]
 [-2.88539153e-01 -1.53741847e-01 -4.68592781e-02]
 [ 2.82085464e-01  1.19054216e+00  3.52394485e-01]
 [-2.35067690e-01 -3.04642786e-02  1.97763718e-01]
 [-9.27461513e-02  1.85371619e-01 -3.53069061e-02]
 [ 8.70728435e-02 -7.78947609e-03  5.01050970e-02]
 [-7.82755376e-02 -7.34088598e-03 -9.24278701e-02]
 [-1.02043444e-02 -1.15391594e-01  1.09766413e-01]
 [-1.02321213e-01  7.57122297e-02 -3.51025666e-02]
 [ 9.94450519e-02 -1.16799940e-01 -1.26053843e-01]
 [ 3.53135662e-02 -6.29237619e-02  8.76771712e-02]
 [-1.10362983e-01  3.89138566e-02  1.11947101e-01]
 [-3.52895827e-01  5.03686816e-02 -4.58303240e-01]
 [ 2.01417574e-01 -1.26303846e-01 -1.60413991e-01]
 [ 1.34672848e-01  2.34814964e-03 -4.00935421e-02]
 [ 2.58305139e-02  1.25138511e-01 -2.43511594e-02]
 [-1.17512176e-01  1.15447356e-02 -1.69148706e-01]
 [-5.69322775e-02  1.44275265e-01  1.05050264e-01]
 [-1.25969082e-01  9.82773222e-02  1.52820549e-01]
 [-1.12322866e-01 -6.06062475e-02 -8.61064020e-03]
 [ 1.03987360e-01  8.59130188e-02  2.35688975e-02]
 [-1.30966687e-01  1.71210803e-01 -2.70366999e-04]
 [ 2.16220806e-03 -2.46553870e-01  8.40853237e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.01714514]
curr_Stock_Price:  100.08769246554652
curr_Factors:  [100.08769247  -1.03927971  -0.99344223]
mat_Sqrt:  [[13.10933774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00857201 -0.00461843  0.08346368]
Stock Position:  -0.008572010902853068
Bond Position:  [3.87509793]


portfolio before change:  [3.02570252]
curr_Stock_Price:  99.14591026789103
curr_Factors:  [99.14591027 -0.90519924 -1.0068427 ]
mat_Sqrt:  [[14.65161648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309734  0.01411938  0.0859571 ]
Stock Position:  -0.003097340344354477
Bond Position:  [3.33279115]


portfolio before change:  [3.02450445]
curr_Stock_Price:  99.66722839437506
curr_Factors:  [99.66722839 -1.14731515 -1.01508   ]
mat_Sqrt:  [[11.46663791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02343924 0.0609343  0.79858737]
Stock Position:  0.023439243430611954
Bond Position:  [0.68838002]


portfolio before change:  [2.99578984]
curr_Stock_Price:  98.43849147885606
curr_Factors:  [98.43849148 -1.31661211 -1.01537737]
mat_Sqrt:  [[ 9.55861093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00916583 -0.0149042   0.17151245]
Stock Position:  -0.00916582940952136
Bond Position:  [3.89806026]


portfolio before change:  [2.99432071]
curr_Stock_Price:  98.65193781131234
curr_Factors:  [98.65193781 -1.3528908  -1.01182039]
mat_Sqrt:  [[ 9.27095769  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07570995 -0.06718817  0.10115195]
Stock Position:  -0.07570995053511376
Bond Position:  [10.46325404]


portfolio before change:  [3.04716228]
curr_Stock_Price:  97.97126667335574
curr_Factors:  [97.97126667 -1.17712688 -0.99846945]
mat_Sqrt:  [[11.12369938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.35744260e-05 -5.69832451e-02 -6.95986071e-01]
Stock Position:  -2.3574426044754348e-05
Bond Position:  [3.0494719]


portfolio before change:  [3.04756257]
curr_Stock_Price:  97.1619390598306
curr_Factors:  [97.16193906 -0.82985509 -0.99692385]
mat_Sqrt:  [[15.63637798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.41100083e-04 -1.03654626e-01 -1.44806411e-01]
Stock Position:  -0.00014110008307081364
Bond Position:  [3.06127212]


portfolio before change:  [3.04797352]
curr_Stock_Price:  96.96155186301137
curr_Factors:  [96.96155186 -0.51004179 -0.98533665]
mat_Sqrt:  [[21.73526568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00312308  0.08844571 -0.03305863]
Stock Position:  0.003123084298765098
Bond Position:  [2.74515442]


portfolio before change:  [3.0516874]
curr_Stock_Price:  98.04084100705829
curr_Factors:  [98.04084101 -0.64136328 -0.98490518]
mat_Sqrt:  [[19.28091372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00997372  0.00332742 -0.21781096]
Stock Position:  -0.009973721439542994
Bond Position:  [4.02951944]


portfolio before change:  [3.04968055]
curr_Stock_Price:  98.2925595162026
curr_Factors:  [98.29255952 -0.59338928 -0.98902476]
mat_Sqrt:  [[20.19700439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00552581 -0.0076725   0.12564396]
Stock Position:  0.005525805959679641
Bond Position:  [2.50653494]


portfolio before change:  [3.04365117]
curr_Stock_Price:  97.14472413852101
curr_Factors:  [97.14472414 -0.55955709 -0.9866373 ]
mat_Sqrt:  [[20.69738735  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00724407 -0.08750247 -0.04986295]
Stock Position:  0.007244069950585407
Bond Position:  [2.339928]


portfolio before change:  [3.04087801]
curr_Stock_Price:  96.7215268558511
curr_Factors:  [96.72152686 -0.72136544 -0.96971184]
mat_Sqrt:  [[17.82779419  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01073225 -0.03416309 -0.67473223]
Stock Position:  -0.010732252987056152
Bond Position:  [4.07891791]


portfolio before change:  [3.04337551]
curr_Stock_Price:  96.53632781228444
curr_Factors:  [96.53632781 -0.69708583 -0.97758408]
mat_Sqrt:  [[18.08801356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01385055 -0.10918796 -0.26574598]
Stock Position:  0.013850552545400527
Bond Position:  [1.70629403]


portfolio before change:  [3.02809056]
curr_Stock_Price:  95.41736524637615
curr_Factors:  [95.41736525 -0.71418694 -0.97397804]
mat_Sqrt:  [[17.63870445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00249207 -0.03313848 -0.15972436]
Stock Position:  0.00249207299960125
Bond Position:  [2.79030352]


portfolio before change:  [3.02782181]
curr_Stock_Price:  95.1695537294198
curr_Factors:  [95.16955373 -0.6655221  -0.94549406]
mat_Sqrt:  [[19.00389415  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00835587  0.12429411  0.796885  ]
Stock Position:  -0.008355870828531951
Bond Position:  [3.8230463]


portfolio before change:  [3.02631161]
curr_Stock_Price:  95.4074831647474
curr_Factors:  [95.40748316 -0.73636145 -0.94548655]
mat_Sqrt:  [[17.74864224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175532 -0.14680448 -0.36193148]
Stock Position:  0.0017553245681872212
Bond Position:  [2.85884051]


portfolio before change:  [3.02519761]
curr_Stock_Price:  94.56924465551388
curr_Factors:  [94.56924466 -0.6117759  -0.98516243]
mat_Sqrt:  [[19.15174787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00638478 -0.0651854  -0.32270956]
Stock Position:  0.00638477788660879
Bond Position:  [2.42139398]


portfolio before change:  [3.0347427]
curr_Stock_Price:  96.01681256997884
curr_Factors:  [96.01681257 -0.56576074 -0.96513415]
mat_Sqrt:  [[20.7724672   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01454203 -0.04861744 -0.13367648]
Stock Position:  -0.014542030914795171
Bond Position:  [4.43102216]


portfolio before change:  [3.02109334]
curr_Stock_Price:  96.99351761376032
curr_Factors:  [96.99351761 -0.81209321 -0.97554433]
mat_Sqrt:  [[16.23235717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02370311 0.37648249 1.00528338]
Stock Position:  0.023703110374770738
Bond Position:  [0.72204528]


portfolio before change:  [3.03195647]
curr_Stock_Price:  97.44800965504146
curr_Factors:  [97.44800966 -0.90617939 -0.96527618]
mat_Sqrt:  [[14.99719878  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01303483 -0.00963365  0.56416484]
Stock Position:  -0.013034829218179882
Bond Position:  [4.30217464]


portfolio before change:  [3.0229143]
curr_Stock_Price:  98.18296227780925
curr_Factors:  [98.18296228 -1.21212285 -0.99053644]
mat_Sqrt:  [[10.85009039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00877107  0.05861965 -0.10072078]
Stock Position:  -0.008771066905570581
Bond Position:  [3.88408363]


portfolio before change:  [3.02628937]
curr_Stock_Price:  97.85352324846407
curr_Factors:  [97.85352325 -1.37548481 -0.99306684]
mat_Sqrt:  [[ 9.16067663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01059959 -0.00246325  0.1429359 ]
Stock Position:  0.01059958604328223
Bond Position:  [1.98908253]


portfolio before change:  [3.02221989]
curr_Stock_Price:  97.44613684866724
curr_Factors:  [97.44613685 -1.17888655 -0.99816898]
mat_Sqrt:  [[11.04794297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00880995 -0.00232139 -0.26367099]
Stock Position:  -0.008809951203709296
Bond Position:  [3.8807156]


portfolio before change:  [3.02920301]
curr_Stock_Price:  96.7085617945598
curr_Factors:  [96.70856179 -0.99889465 -0.98594489]
mat_Sqrt:  [[13.28801364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00069403 -0.03649003  0.31313302]
Stock Position:  0.0006940264294777574
Bond Position:  [2.96208471]


portfolio before change:  [3.02969088]
curr_Stock_Price:  96.8779912851254
curr_Factors:  [96.87799129 -1.11656806 -1.00809811]
mat_Sqrt:  [[11.57428924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00929056  0.02394231 -0.10013785]
Stock Position:  -0.009290558630903901
Bond Position:  [3.92974154]


portfolio before change:  [3.03597764]
curr_Stock_Price:  96.25418493619009
curr_Factors:  [96.25418494 -1.33288329 -1.00751996]
mat_Sqrt:  [[ 9.26820022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00762809 -0.03693538 -0.35959653]
Stock Position:  0.007628089144462995
Bond Position:  [2.30174214]


portfolio before change:  [3.03268281]
curr_Stock_Price:  95.78453054705577
curr_Factors:  [95.78453055 -1.42985163 -1.02045959]
mat_Sqrt:  [[ 8.26301872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00624299 -0.01989824  0.25011856]
Stock Position:  0.006242985883288514
Bond Position:  [2.43470134]


portfolio before change:  [3.03191393]
curr_Stock_Price:  95.61261985607885
curr_Factors:  [95.61261986 -1.42393545 -1.04677661]
mat_Sqrt:  [[ 8.08162329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01070418  0.01230564  0.31935392]
Stock Position:  -0.010704176837484515
Bond Position:  [4.05536832]


portfolio before change:  [3.03487276]
curr_Stock_Price:  95.38356211992196
curr_Factors:  [95.38356212 -1.46760476 -1.03832355]
mat_Sqrt:  [[ 7.78328083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0571926   0.01592798 -1.30741158]
Stock Position:  -0.0571926004927771
Bond Position:  [8.49010672]


portfolio before change:  [3.02656251]
curr_Stock_Price:  95.54742208561345
curr_Factors:  [95.54742209 -1.3485377  -1.05169203]
mat_Sqrt:  [[ 8.66587549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01908775 -0.03994078 -0.45761647]
Stock Position:  0.019087748678209195
Bond Position:  [1.20277733]


portfolio before change:  [3.0257018]
curr_Stock_Price:  95.49445247360887
curr_Factors:  [95.49445247 -1.19951963 -1.07424848]
mat_Sqrt:  [[ 9.82863478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01287558  0.00074255 -0.11437572]
Stock Position:  0.012875584467910092
Bond Position:  [1.79615491]


portfolio before change:  [3.03972871]
curr_Stock_Price:  96.56643354354419
curr_Factors:  [96.56643354 -1.24497194 -1.08738261]
mat_Sqrt:  [[ 9.37340714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00257013  0.03957227 -0.06946708]
Stock Position:  0.002570134472051369
Bond Position:  [2.79153999]


portfolio before change:  [3.03992334]
curr_Stock_Price:  96.50638362048376
curr_Factors:  [96.50638362 -0.98145773 -1.08158528]
mat_Sqrt:  [[12.26274921  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01237418  0.00365077 -0.48253418]
Stock Position:  -0.01237417686838417
Bond Position:  [4.2341104]


portfolio before change:  [3.04176162]
curr_Stock_Price:  96.40060026200608
curr_Factors:  [96.40060026 -1.14585418 -1.06669709]
mat_Sqrt:  [[10.54826251  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00301128  0.04562384  0.29967916]
Stock Position:  -0.003011283677781024
Bond Position:  [3.33205118]


portfolio before change:  [3.04265279]
curr_Stock_Price:  96.24297981855626
curr_Factors:  [96.24297982 -1.00364722 -1.08618458]
mat_Sqrt:  [[11.90602096  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00774711  0.03107802  0.43595449]
Stock Position:  -0.0077471061844600975
Bond Position:  [3.78825738]


portfolio before change:  [3.04814624]
curr_Stock_Price:  95.5950111995393
curr_Factors:  [95.5950112  -0.9618737  -1.10867251]
mat_Sqrt:  [[12.05614429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00959223 -0.01916538 -0.02456376]
Stock Position:  -0.009592233582071322
Bond Position:  [3.96511591]


portfolio before change:  [3.04195543]
curr_Stock_Price:  96.29208308142478
curr_Factors:  [96.29208308 -0.97606571 -1.06810656]
mat_Sqrt:  [[12.46860443  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00890369 0.02716808 0.0672355 ]
Stock Position:  0.00890369138916659
Bond Position:  [2.18460044]


portfolio before change:  [3.03717394]
curr_Stock_Price:  95.72438744510966
curr_Factors:  [95.72438745 -1.13478936 -1.07293407]
mat_Sqrt:  [[10.52496102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01202867  0.05414161 -0.00077128]
Stock Position:  -0.012028665130071257
Bond Position:  [4.18861054]


portfolio before change:  [3.02882216]
curr_Stock_Price:  96.46224034985386
curr_Factors:  [96.46224035 -1.24926356 -1.0643634 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.02882216]
Stock Price:  96.23863470791231
PL:  [3.02882216]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.46175202e-02  2.57563655e-03  2.09646746e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.78543842e-01  1.78889253e-02 -3.85843008e-02]
 [ 4.87444742e-03 -2.07660010e-02  7.51809214e-02]
 [-8.65487925e-01 -2.58308529e-01  3.15032887e-02]
 [-3.05165808e-02 -4.58330845e-02 -3.77684024e-02]
 [ 3.38893133e-02 -1.10078209e-02 -2.51378705e-02]
 [ 3.06647999e-01 -5.63138215e-02 -6.97248755e-02]
 [-5.02733637e-01 -2.95490905e-02 -5.25512104e-02]
 [ 3.73669875e-02 -2.50617104e-04 -3.34198175e-02]
 [-9.73333555e-03 -2.12601630e-01  8.24659849e-02]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.43647264e-01 -5.55545744e-02  2.99805707e-01]
 [ 6.00020241e-02  1.60316966e-01  1.15093862e-01]
 [ 5.69602486e-02 -1.13395576e-01 -4.45818629e-02]
 [-3.11892577e-02  3.06301140e-02  4.21244646e-02]
 [-4.34045368e-01 -2.40719699e-01  1.12131815e-01]
 [-1.34505025e-01  1.79023050e-02 -1.43660298e-02]
 [ 2.07146231e-01  1.00914038e+00  2.31262858e-01]
 [ 1.40065113e-02  7.06280676e-03  3.12041197e-02]
 [-3.13470338e-02 -1.08157636e-01  2.18612038e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.87285556e-01 -2.03454026e-02  1.85339285e-01]
 [ 7.36327829e-02 -1.88933450e-01 -7.79310184e-02]
 [-1.20368579e-01  2.16187018e-01  1.71319171e-01]
 [ 1.36769804e-02  6.21236084e-02  1.23007223e-02]
 [-3.46886432e-03 -5.86377668e-02  2.12934048e-01]
 [ 9.39858809e-02  7.29715021e-02 -8.71577471e-02]
 [-7.91038700e-01 -1.62450027e-01 -1.18074398e+00]
 [ 3.36271433e-02 -1.29152051e-01  1.26866201e-01]
 [ 1.31302777e-02 -1.32370652e-01  1.15487717e-01]
 [ 2.85558904e-02  1.23333669e-01 -2.27860808e-02]
 [-1.11323435e-01 -5.66275797e-03 -3.10920583e-02]
 [-5.88633090e-02  1.33115510e-01  1.18879690e-01]
 [ 1.91035955e-01 -1.67828687e-01 -8.99036251e-02]
 [-9.68001021e-03  1.54292534e-01  8.01845890e-02]
 [ 4.48635962e-02  4.30815834e-02 -3.86479810e-02]
 [-4.34972267e-02  8.50230523e-02 -8.03120008e-03]
 [-5.33193409e-02 -2.65461696e-01  1.15067990e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.74090875]
curr_Stock_Price:  100.32786439063031
curr_Factors:  [100.32786439  -0.95936854  -1.02631712]
mat_Sqrt:  [[13.77365638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00655393  0.00081449  0.05980638]
Stock Position:  -0.0065539330118180444
Bond Position:  [5.39845085]


portfolio before change:  [4.74086987]
curr_Stock_Price:  100.4367654003599
curr_Factors:  [100.4367654   -1.04328443  -1.03387042]
mat_Sqrt:  [[12.58333696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360644  0.01411938  0.0859571 ]
Stock Position:  -0.0036064394501187343
Bond Position:  [5.10308898]


portfolio before change:  [4.74001595]
curr_Stock_Price:  100.8504251613987
curr_Factors:  [100.85042516  -0.93683858  -1.03796062]
mat_Sqrt:  [[13.99694757  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01937063  0.00565697 -0.11007027]
Stock Position:  0.01937063369522373
Bond Position:  [2.78647931]


portfolio before change:  [4.73568888]
curr_Stock_Price:  100.60905946751522
curr_Factors:  [100.60905947  -0.99816064  -1.05671133]
mat_Sqrt:  [[12.88894982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152724 -0.00656679  0.21447024]
Stock Position:  0.001527239470683775
Bond Position:  [4.58203475]


portfolio before change:  [4.7364267]
curr_Stock_Price:  100.71712026340525
curr_Factors:  [100.71712026  -1.06039387  -1.05778126]
mat_Sqrt:  [[12.11132149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07148079 -0.08168433  0.08987011]
Stock Position:  -0.07148079103777402
Bond Position:  [11.93576613]


portfolio before change:  [4.76562123]
curr_Stock_Price:  100.32956915716365
curr_Factors:  [100.32956916  -1.03293722  -1.05764999]
mat_Sqrt:  [[12.40219223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317762 -0.01449369 -0.10774274]
Stock Position:  -0.003177617966612734
Bond Position:  [5.08443027]


portfolio before change:  [4.76783454]
curr_Stock_Price:  99.8330601220288
curr_Factors:  [99.83306012 -0.96506111 -1.05313284]
mat_Sqrt:  [[13.26734084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00214616 -0.00348098 -0.07171135]
Stock Position:  0.0021461607528731586
Bond Position:  [4.55357674]


portfolio before change:  [4.77049309]
curr_Stock_Price:  100.80657484394959
curr_Factors:  [100.80657484  -1.05233983  -1.07515578]
mat_Sqrt:  [[12.0096197   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02422737 -0.01780799 -0.19890566]
Stock Position:  0.0242273659357736
Bond Position:  [2.32821531]


portfolio before change:  [4.77190372]
curr_Stock_Price:  100.85278629129279
curr_Factors:  [100.85278629  -1.27547464  -1.05582082]
mat_Sqrt:  [[ 9.79984374  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05247263 -0.00934424 -0.14991398]
Stock Position:  -0.05247262875085556
Bond Position:  [10.06391453]


portfolio before change:  [4.79029802]
curr_Stock_Price:  100.5262115806362
curr_Factors:  [100.52621158  -1.22697848  -1.03635437]
mat_Sqrt:  [[10.45505566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.92095288e-03 -7.92520870e-05 -9.53374372e-02]
Stock Position:  0.0029209528767258014
Bond Position:  [4.49666569]


portfolio before change:  [4.79133373]
curr_Stock_Price:  100.68834843304045
curr_Factors:  [100.68834843  -1.38625384  -1.0059792 ]
mat_Sqrt:  [[ 9.2054624   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.74962708e-04 -6.72305387e-02  2.35252501e-01]
Stock Position:  0.0001749627081659575
Bond Position:  [4.77371702]


portfolio before change:  [4.79205894]
curr_Stock_Price:  101.42253837554745
curr_Factors:  [101.42253838  -1.3225091   -1.01307373]
mat_Sqrt:  [[ 9.81304392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00734997  0.00225658  0.15019092]
Stock Position:  -0.007349974091195853
Bond Position:  [5.53751197]


portfolio before change:  [4.7930452]
curr_Stock_Price:  101.38253486916332
curr_Factors:  [101.38253487  -1.27764895  -0.99337326]
mat_Sqrt:  [[10.46334945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01944028 -0.0175679   0.85526223]
Stock Position:  0.01944027921541315
Bond Position:  [2.82214041]


portfolio before change:  [4.78793995]
curr_Stock_Price:  101.10177599477484
curr_Factors:  [101.10177599  -1.29953926  -1.02138658]
mat_Sqrt:  [[ 9.9264395   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00882842 0.05069668 0.32833075]
Stock Position:  0.008828424995085654
Bond Position:  [3.89537051]


portfolio before change:  [4.79528983]
curr_Stock_Price:  101.87914307170104
curr_Factors:  [101.87914307  -1.2157017   -1.03770126]
mat_Sqrt:  [[10.70150393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00419868 -0.03585883 -0.12717965]
Stock Position:  0.004198676471558999
Bond Position:  [4.36753227]


portfolio before change:  [4.7950349]
curr_Stock_Price:  101.68838967811803
curr_Factors:  [101.68838968  -1.07348575  -1.04443071]
mat_Sqrt:  [[12.23128084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017823   0.00968609  0.12016937]
Stock Position:  -0.0017822966810813955
Bond Position:  [4.97627378]


portfolio before change:  [4.79755755]
curr_Stock_Price:  100.62202397222426
curr_Factors:  [100.62202397  -0.80781286  -1.03791043]
mat_Sqrt:  [[15.88933079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02626743 -0.07612225  0.31988086]
Stock Position:  -0.026267431822260538
Bond Position:  [7.4406397]


portfolio before change:  [4.77870953]
curr_Stock_Price:  101.37497742102954
curr_Factors:  [101.37497742  -0.57054519  -1.08385853]
mat_Sqrt:  [[19.38350744  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00706659  0.00566121 -0.04098228]
Stock Position:  -0.007066587051410343
Bond Position:  [5.49508464]


portfolio before change:  [4.77896082]
curr_Stock_Price:  101.43662593125593
curr_Factors:  [101.43662593  -0.48712498  -1.10341445]
mat_Sqrt:  [[20.67437047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0135631  0.31911821 0.65972856]
Stock Position:  0.013563095267569632
Bond Position:  [3.4031662]


portfolio before change:  [4.78225462]
curr_Stock_Price:  101.6481098230504
curr_Factors:  [101.64810982  -0.52176347  -1.11826418]
mat_Sqrt:  [[19.71715945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00104266 0.00223346 0.08901667]
Stock Position:  0.0010426647171318155
Bond Position:  [4.67626972]


portfolio before change:  [4.78385106]
curr_Stock_Price:  102.61857393515054
curr_Factors:  [102.61857394  -0.40647846  -1.10365897]
mat_Sqrt:  [[22.66635169  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00130931 -0.03420245  0.06236393]
Stock Position:  -0.0013093087432476903
Bond Position:  [4.91821045]


portfolio before change:  [4.78467587]
curr_Stock_Price:  102.4581837901155
curr_Factors:  [102.45818379  -0.45669598  -1.09205191]
mat_Sqrt:  [[21.77378801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178512  0.01916992 -0.08961985]
Stock Position:  -0.0017851218020787326
Bond Position:  [4.96757621]


portfolio before change:  [4.78271661]
curr_Stock_Price:  103.9036005876267
curr_Factors:  [103.90360059  -0.62459643  -1.07393665]
mat_Sqrt:  [[19.00934048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01181485 -0.00643378  0.52872139]
Stock Position:  0.01181484772323842
Bond Position:  [3.55511139]


portfolio before change:  [4.80098049]
curr_Stock_Price:  105.41182685352412
curr_Factors:  [105.41182685  -0.58410563  -1.07477585]
mat_Sqrt:  [[20.06532815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00263374 -0.059746   -0.2223155 ]
Stock Position:  0.0026337441027737976
Bond Position:  [4.52335271]


portfolio before change:  [4.79988116]
curr_Stock_Price:  104.77972893258737
curr_Factors:  [104.77972893  -0.55833053  -1.05121733]
mat_Sqrt:  [[20.95364197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380918  0.06836434  0.48872591]
Stock Position:  -0.0038091838608358673
Bond Position:  [5.19900641]


portfolio before change:  [4.80099793]
curr_Stock_Price:  104.65716851821601
curr_Factors:  [104.65716852  -0.56532899  -1.05133079]
mat_Sqrt:  [[20.7808142   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00085617 0.01964521 0.03509054]
Stock Position:  0.0008561685458691148
Bond Position:  [4.71139376]


portfolio before change:  [4.80219586]
curr_Stock_Price:  105.36843373412242
curr_Factors:  [105.36843373  -0.41611936  -1.04283058]
mat_Sqrt:  [[24.49608149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00157095 -0.01854289  0.60744157]
Stock Position:  0.0015709490373721359
Bond Position:  [4.63666742]


portfolio before change:  [4.80432121]
curr_Stock_Price:  106.35238373592529
curr_Factors:  [106.35238374  -0.5315514   -1.04384966]
mat_Sqrt:  [[22.00691882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00354793  0.02307562 -0.24863679]
Stock Position:  0.0035479294959383915
Bond Position:  [4.42699045]


portfolio before change:  [4.80178349]
curr_Stock_Price:  105.48113561459652
curr_Factors:  [105.48113561  -0.30811656  -1.06341077]
mat_Sqrt:  [[26.76258401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03872016 -0.05137121 -3.36833392]
Stock Position:  -0.038720158592192994
Bond Position:  [8.88602979]


portfolio before change:  [4.80182368]
curr_Stock_Price:  105.50878614322635
curr_Factors:  [105.50878614  -0.12947731  -1.06155448]
mat_Sqrt:  [[32.06491505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175235 -0.04084146  0.36191396]
Stock Position:  0.0017523485257074792
Bond Position:  [4.61693552]


portfolio before change:  [4.80274172]
curr_Stock_Price:  105.70331430917642
curr_Factors:  [105.70331431  -0.19731177  -1.07253757]
mat_Sqrt:  [[29.68930591  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112115 -0.04185928  0.32945431]
Stock Position:  0.001121154996869499
Bond Position:  [4.68423192]


portfolio before change:  [4.80142573]
curr_Stock_Price:  104.00724705607779
curr_Factors:  [ 1.04007247e+02 -5.12923939e-02 -1.05197816e+00]
mat_Sqrt:  [[34.50796025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078501  0.03900153 -0.06500235]
Stock Position:  0.0007850119957950756
Bond Position:  [4.71977879]


portfolio before change:  [4.80297987]
curr_Stock_Price:  105.23542006814942
curr_Factors:  [105.23542007  -0.11491766  -1.0440836 ]
mat_Sqrt:  [[33.02281478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00356772 -0.00179072 -0.08869699]
Stock Position:  -0.0035677239172999934
Bond Position:  [5.17843079]


portfolio before change:  [4.80305712]
curr_Stock_Price:  105.39521125924506
curr_Factors:  [ 1.05395211e+02 -6.69697470e-02 -1.05340983e+00]
mat_Sqrt:  [[34.37527717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090647  0.04209482  0.33913067]
Stock Position:  -0.0009064673435151379
Bond Position:  [4.89859444]


portfolio before change:  [4.80491049]
curr_Stock_Price:  104.02615479631986
curr_Factors:  [ 1.04026155e+02 -7.94362188e-02 -1.03258835e+00]
mat_Sqrt:  [[34.21341392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00492062 -0.05307209 -0.25647002]
Stock Position:  0.004920617873882753
Bond Position:  [4.29303753]


portfolio before change:  [4.79860098]
curr_Stock_Price:  102.63483160594079
curr_Factors:  [ 1.02634832e+02 -2.37601809e-03 -1.01544154e+00]
mat_Sqrt:  [[37.09046041  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00028771 0.04879158 0.22874431]
Stock Position:  0.00028771324121702247
Bond Position:  [4.76907158]


portfolio before change:  [4.79895965]
curr_Stock_Price:  101.80932304353814
curr_Factors:  [101.80932304   0.12326688  -1.00398068]
mat_Sqrt:  [[42.19863516  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090256  0.01362359 -0.11025193]
Stock Position:  0.0009025640680744034
Bond Position:  [4.70707021]


portfolio before change:  [4.79957404]
curr_Stock_Price:  101.83810510627053
curr_Factors:  [ 1.01838105e+02 -8.91159937e-02 -9.83459580e-01]
mat_Sqrt:  [[34.84148497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00123248  0.02688665 -0.02291078]
Stock Position:  -0.0012324762503288754
Bond Position:  [4.92508709]


portfolio before change:  [4.80083822]
curr_Stock_Price:  101.31192480731134
curr_Factors:  [101.31192481  -0.17832704  -0.97121956]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.80083822]
Stock Price:  100.14930652816581
PL:  [4.65153169]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.89381650e-01  1.07019226e-01  1.99524870e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 3.07557598e-01 -2.01239372e-02 -1.14340309e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-8.02637774e-01 -2.40505488e-01  3.30391850e-02]
 [-2.77732282e-02 -5.10952556e-02 -4.57485503e-02]
 [ 2.52133093e-02  8.81126556e-02  1.56961449e-02]
 [ 2.90889590e-01 -7.74672346e-02 -6.16728471e-02]
 [-4.32385140e-01 -1.99986479e-02 -6.14662997e-02]
 [ 4.96279816e-02 -2.10807279e-02 -4.31806833e-02]
 [ 2.26564063e-02 -2.54609476e-01  3.80213992e-02]
 [-2.53948860e-02 -3.27089873e-04  2.12892068e-02]
 [ 1.74940049e-01 -1.06715713e-01  2.34559477e-01]
 [ 7.78870783e-02  6.64511071e-02  2.36350142e-02]
 [ 8.18892534e-02 -1.13249488e-01 -6.04531065e-02]
 [-4.52947884e-02  8.63349325e-03  2.83540651e-02]
 [-4.18135619e-01 -2.35819403e-01  1.05579488e-01]
 [-1.54740653e-01  2.81643175e-03 -1.80993895e-02]
 [ 2.56010333e-01  1.10913378e+00  3.62226486e-01]
 [-1.43281591e-02 -2.19634789e-03  4.24757277e-02]
 [-6.17137410e-02 -3.71798440e-02 -3.15206011e-02]
 [-2.80696769e-02  4.81834052e-02 -2.00006559e-02]
 [ 3.13133869e-02 -3.23045367e-02  2.95558549e-02]
 [ 5.33177542e-02  2.45950106e-01  1.09674170e-01]
 [-1.09754957e-01  8.77447803e-02  3.54582976e-02]
 [ 1.15236011e-01 -7.78147259e-02 -6.25098019e-02]
 [ 5.27979659e-02 -4.57361990e-02  1.10338997e-01]
 [-9.89910426e-02  4.42727704e-02  9.90432509e-02]
 [-4.26380333e-01 -5.30320052e-02 -6.63398728e-01]
 [ 2.09961393e-01 -1.34496170e-01 -1.62464787e-01]
 [ 1.34542098e-01  4.98652773e-03 -3.83039984e-02]
 [ 3.32608958e-02  1.76467254e-01 -4.90215612e-02]
 [-1.23438261e-01  1.82810930e-02 -1.76742404e-01]
 [-4.82865460e-02  1.50318110e-01  9.50464948e-02]
 [-1.53040888e-01  9.38791315e-02  1.17070932e-01]
 [-8.74364406e-02 -6.40362545e-02  1.24589223e-02]
 [ 1.24983552e-01  1.02841204e-01  3.70478227e-02]
 [-1.31955340e-01  1.91833514e-01  3.79439833e-03]
 [ 1.55438102e-03 -2.09280821e-01  6.64750208e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.09519724]
curr_Stock_Price:  99.51471994306395
curr_Factors:  [99.51471994 -0.9782379  -0.98523546]
mat_Sqrt:  [[13.96888294  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01044397  0.03384245  0.56918892]
Stock Position:  -0.01044396912368185
Bond Position:  [-0.05586858]


portfolio before change:  [-1.10275113]
curr_Stock_Price:  100.23732913027403
curr_Factors:  [100.23732913  -0.97914542  -0.96720316]
mat_Sqrt:  [[14.31334173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317054  0.01411938  0.0859571 ]
Stock Position:  -0.0031705414213434677
Bond Position:  [-0.78494453]


portfolio before change:  [-1.10553624]
curr_Stock_Price:  101.08481349495253
curr_Factors:  [101.08481349  -0.96378344  -0.96635699]
mat_Sqrt:  [[14.67021836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01933839 -0.00636375 -0.32618108]
Stock Position:  0.019338388505552095
Bond Position:  [-3.06035363]


portfolio before change:  [-1.09314294]
curr_Stock_Price:  101.7454614085776
curr_Factors:  [101.74546141  -1.04755955  -0.98377006]
mat_Sqrt:  [[13.34503771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147643 -0.00659539  0.21422481]
Stock Position:  0.001476432988321446
Bond Position:  [-1.2433633]


portfolio before change:  [-1.09415995]
curr_Stock_Price:  101.16190872598871
curr_Factors:  [101.16190873  -0.85627235  -0.98890418]
mat_Sqrt:  [[15.9833213   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05018378 -0.07605451  0.0942516 ]
Stock Position:  -0.050183781520772415
Bond Position:  [3.98252718]


portfolio before change:  [-1.06320788]
curr_Stock_Price:  100.55505494819265
curr_Factors:  [100.55505495  -0.75903954  -0.98295068]
mat_Sqrt:  [[17.61437222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218179 -0.01615774 -0.13050788]
Stock Position:  -0.0021817913980171455
Bond Position:  [-0.84381773]


portfolio before change:  [-1.06432973]
curr_Stock_Price:  101.02089298549208
curr_Factors:  [101.02089299  -0.93762628  -1.02943256]
mat_Sqrt:  [[14.12955242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00217221 0.02786367 0.04477673]
Stock Position:  0.0021722082596594976
Bond Position:  [-1.28376815]


portfolio before change:  [-1.06485069]
curr_Stock_Price:  100.8549406466731
curr_Factors:  [100.85494065  -0.9141725   -1.02448894]
mat_Sqrt:  [[14.51266647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01903857 -0.02449729 -0.17593547]
Stock Position:  0.019038574218804855
Bond Position:  [-2.98498496]


portfolio before change:  [-1.07985241]
curr_Stock_Price:  100.0865758028682
curr_Factors:  [100.0865758   -1.00267496  -1.02107456]
mat_Sqrt:  [[13.22734201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03367632 -0.00632413 -0.17534624]
Stock Position:  -0.03367632427208178
Bond Position:  [2.29069557]


portfolio before change:  [-1.0582886]
curr_Stock_Price:  99.4547535657609
curr_Factors:  [99.45475357 -0.89100821 -1.05921673]
mat_Sqrt:  [[14.14665022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00284657 -0.00666631 -0.12318247]
Stock Position:  0.0028465720761081505
Bond Position:  [-1.34139373]


portfolio before change:  [-1.05807262]
curr_Stock_Price:  99.58953460720342
curr_Factors:  [99.58953461 -1.1545511  -1.02754777]
mat_Sqrt:  [[11.23414958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00212241 -0.08051459  0.10846447]
Stock Position:  0.0021224128603931926
Bond Position:  [-1.26944273]


portfolio before change:  [-1.05790358]
curr_Stock_Price:  99.74395053677074
curr_Factors:  [99.74395054 -1.0852972  -1.03043281]
mat_Sqrt:  [[12.02366033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175135 -0.00010343  0.06073218]
Stock Position:  -0.0017513543877338313
Bond Position:  [-0.88321658]


portfolio before change:  [-1.05899687]
curr_Stock_Price:  100.30516031483364
curr_Factors:  [100.30516031  -1.04013235  -1.03401241]
mat_Sqrt:  [[12.60473307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01745883 -0.03374647  0.6691329 ]
Stock Position:  0.017458831766419027
Bond Position:  [-2.81020779]


portfolio before change:  [-1.05964489]
curr_Stock_Price:  100.28816482954704
curr_Factors:  [100.28816483  -1.17765472  -1.0119638 ]
mat_Sqrt:  [[11.2282078   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00751922 0.02101369 0.06742412]
Stock Position:  0.0075192156291720965
Bond Position:  [-1.81373322]


portfolio before change:  [-1.05699128]
curr_Stock_Price:  100.6712287717204
curr_Factors:  [100.67122877  -0.90330891  -1.03060613]
mat_Sqrt:  [[14.55515176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00457743 -0.03581263 -0.17245589]
Stock Position:  0.004577432555930376
Bond Position:  [-1.51780704]


portfolio before change:  [-1.06028073]
curr_Stock_Price:  99.9940560300306
curr_Factors:  [99.99405603 -0.89446016 -1.00686864]
mat_Sqrt:  [[14.93611265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263014  0.00273015  0.08088626]
Stock Position:  -0.0026301437469176256
Bond Position:  [-0.79728199]


portfolio before change:  [-1.06161478]
curr_Stock_Price:  100.46338019018981
curr_Factors:  [100.46338019  -0.71237178  -1.02350949]
mat_Sqrt:  [[17.70614947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02274199 -0.07457264  0.30118889]
Stock Position:  -0.022741992974952562
Bond Position:  [1.2231227]


portfolio before change:  [-1.05612232]
curr_Stock_Price:  100.2285912919488
curr_Factors:  [100.22859129  -0.85438307  -0.99958629]
mat_Sqrt:  [[15.69722784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01008856  0.00089063 -0.05163252]
Stock Position:  -0.010088561919573542
Bond Position:  [-0.04495997]


portfolio before change:  [-1.0658717]
curr_Stock_Price:  101.19441447601014
curr_Factors:  [101.19441448  -0.8804504   -0.98705176]
mat_Sqrt:  [[15.63545987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02293423 0.3507389  1.03333134]
Stock Position:  0.02293422891714411
Bond Position:  [-3.38668757]


portfolio before change:  [-1.07267159]
curr_Stock_Price:  100.91637928481873
curr_Factors:  [100.91637928  -0.74219634  -1.00991836]
mat_Sqrt:  [[17.49959174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032655 -0.00069455  0.12117143]
Stock Position:  -0.0003265531584564891
Bond Position:  [-1.03971703]


portfolio before change:  [-1.07284338]
curr_Stock_Price:  101.04445221275408
curr_Factors:  [101.04445221  -1.05730088  -1.00304827]
mat_Sqrt:  [[12.87402086  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00536801 -0.0117573  -0.0899195 ]
Stock Position:  -0.005368007165352961
Bond Position:  [-0.53043604]


portfolio before change:  [-1.06999978]
curr_Stock_Price:  100.50236871320591
curr_Factors:  [100.50236871  -0.88850777  -0.97196861]
mat_Sqrt:  [[15.63801664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197648  0.01523693 -0.0570563 ]
Stock Position:  -0.0019764784916993716
Bond Position:  [-0.87135901]


portfolio before change:  [-1.06834744]
curr_Stock_Price:  99.61125122274142
curr_Factors:  [99.61125122 -0.8283992  -0.95942744]
mat_Sqrt:  [[16.667296    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00219066 -0.01021559  0.08431463]
Stock Position:  0.002190658339137767
Bond Position:  [-1.28656165]


portfolio before change:  [-1.06907676]
curr_Stock_Price:  99.35174403709587
curr_Factors:  [99.35174404 -0.36788901 -0.96392269]
mat_Sqrt:  [[26.22871545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00312845 0.07777625 0.31286988]
Stock Position:  0.0031284530471858557
Bond Position:  [-1.37989402]


portfolio before change:  [-1.07484749]
curr_Stock_Price:  97.56228576055759
curr_Factors:  [97.56228576 -0.29922242 -1.00265526]
mat_Sqrt:  [[26.53894625  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377752  0.02774734  0.10115265]
Stock Position:  -0.0037775238189152473
Bond Position:  [-0.70630363]


portfolio before change:  [-1.07243386]
curr_Stock_Price:  96.89996769664911
curr_Factors:  [96.8999677  -0.26484436 -1.03743288]
mat_Sqrt:  [[26.34825227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00381305 -0.02460718 -0.17832307]
Stock Position:  0.003813045471298166
Bond Position:  [-1.44191785]


portfolio before change:  [-1.07444603]
curr_Stock_Price:  96.41953314017795
curr_Factors:  [96.41953314 -0.43579012 -1.03855792]
mat_Sqrt:  [[22.07312413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00335883 -0.01446306  0.31476645]
Stock Position:  0.0033588320055221196
Bond Position:  [-1.39830305]


portfolio before change:  [-1.07784377]
curr_Stock_Price:  95.45999036833742
curr_Factors:  [95.45999037 -0.39436628 -1.05802824]
mat_Sqrt:  [[22.33852328  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034752   0.01400028  0.28254283]
Stock Position:  -0.0034751986359359186
Bond Position:  [-0.74610135]


portfolio before change:  [-1.07541019]
curr_Stock_Price:  94.7328791661222
curr_Factors:  [94.73287917 -0.52629297 -1.02064159]
mat_Sqrt:  [[20.16859254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02792289 -0.01677019 -1.89249192]
Stock Position:  -0.02792288607279008
Bond Position:  [1.56980521]


portfolio before change:  [-1.09608115]
curr_Stock_Price:  95.48019450783025
curr_Factors:  [95.48019451 -0.7137442  -0.99514936]
mat_Sqrt:  [[17.28821876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01002566 -0.04253142 -0.46346682]
Stock Position:  0.010025655795148842
Bond Position:  [-2.05333272]


portfolio before change:  [-1.08970586]
curr_Stock_Price:  96.14169456515312
curr_Factors:  [96.14169457 -0.71655039 -1.00069761]
mat_Sqrt:  [[17.26316583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00734814  0.00157688 -0.10927065]
Stock Position:  0.007348135311520529
Bond Position:  [-1.79616804]


portfolio before change:  [-1.09600899]
curr_Stock_Price:  95.31446498733065
curr_Factors:  [95.31446499 -1.03207693 -1.02730801]
mat_Sqrt:  [[12.15568117  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00228788  0.05580385 -0.13984487]
Stock Position:  0.002287883012023473
Bond Position:  [-1.31407734]


portfolio before change:  [-1.0956509]
curr_Stock_Price:  95.54278044710424
curr_Factors:  [95.54278045 -0.65842285 -1.019868  ]
mat_Sqrt:  [[17.83714804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00891643  0.00578099 -0.50419688]
Stock Position:  -0.008916427508822336
Bond Position:  [-0.24375063]


portfolio before change:  [-1.09324296]
curr_Stock_Price:  95.26930621607328
curr_Factors:  [95.26930622 -0.51635643 -1.00629498]
mat_Sqrt:  [[20.78135681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012032   0.04753476  0.27114119]
Stock Position:  -0.0012031969226744348
Bond Position:  [-0.97861522]


portfolio before change:  [-1.09384209]
curr_Stock_Price:  95.66557790738783
curr_Factors:  [95.66557791 -0.69057468 -0.98277235]
mat_Sqrt:  [[17.94858919  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00706016  0.02968719  0.33397078]
Stock Position:  -0.007060161356216665
Bond Position:  [-0.41842767]


portfolio before change:  [-1.10044561]
curr_Stock_Price:  96.59349101727591
curr_Factors:  [96.59349102 -0.71532735 -0.97348317]
mat_Sqrt:  [[17.8445982   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00485002 -0.02025004  0.03554184]
Stock Position:  -0.00485002137739592
Bond Position:  [-0.63196511]


portfolio before change:  [-1.0969888]
curr_Stock_Price:  95.86446039138391
curr_Factors:  [95.86446039 -0.32734922 -0.96343833]
mat_Sqrt:  [[26.36791095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00512749 0.03252124 0.10568713]
Stock Position:  0.00512749212481769
Bond Position:  [-1.58853306]


portfolio before change:  [-1.09926746]
curr_Stock_Price:  95.45878725443774
curr_Factors:  [95.45878725 -0.63375039 -0.96780356]
mat_Sqrt:  [[19.24287087  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00655971  0.06066308  0.01082436]
Stock Position:  -0.006559712034671372
Bond Position:  [-0.47308531]


portfolio before change:  [-1.09926177]
curr_Stock_Price:  95.44890374323863
curr_Factors:  [95.44890374 -0.65558852 -0.97009293]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.09926177]
Stock Price:  94.08890650631916
PL:  [-1.09926177]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [ 1.56772566e-01 -6.60098363e-03  3.78741769e-01]
 [-1.02178137e-01 -1.68357324e-01  8.29546337e-02]
 [ 1.62781497e-01  1.69596299e-01  2.88397386e-01]
 [-9.99079389e-02 -2.13236932e-02 -1.76094134e-03]
 [ 2.21391432e-01 -6.13020523e-02  1.32805674e-02]
 [ 1.85085615e-01 -3.90833543e-01 -5.50165846e-01]
 [-5.94243481e-03 -6.12027591e-01 -9.91377232e-02]
 [ 4.68516763e-02  2.43083604e-01 -1.83385070e-03]
 [ 8.34589730e-02  2.61816764e-02 -2.64155397e-02]
 [ 1.49970084e-01  6.23782858e-02  3.53816404e-01]
 [ 2.11645830e-01 -2.09297331e-01 -6.12927016e-02]
 [-2.42015160e-01 -1.64003719e-01 -3.61491528e-01]
 [ 2.84195702e-01 -3.75332429e-01 -1.33104177e-01]
 [ 1.58411768e-03 -1.48085637e-01 -8.45057488e-02]
 [-2.09011326e-01  3.49903430e-01  2.51376211e-01]
 [ 9.98931654e-02 -5.77853777e-01 -1.65466627e-01]
 [ 1.50693238e-01 -2.06134324e-01 -1.13123395e-01]
 [-3.46584031e-01 -7.17133299e-02 -2.52247385e-02]
 [ 2.02460227e-01  1.12719956e+00  1.63991995e-01]
 [-3.56196284e-01 -5.82960748e-02  2.70705102e-01]
 [-8.71298702e-02  3.19259089e-03 -4.38492472e-02]
 [ 9.05480811e-02 -3.29182590e-02  6.10801941e-02]
 [-8.35719703e-02  7.02725043e-02 -1.06827178e-01]
 [-5.41493862e-03 -1.05386425e-01  1.03981190e-01]
 [-1.11059070e-01  9.85273480e-02  3.15958770e-02]
 [ 1.07830204e-01 -8.79526122e-02 -8.23868114e-02]
 [ 3.73679309e-02 -6.42657583e-02  1.14887628e-01]
 [-8.58217076e-02  4.27331985e-02  8.74190568e-02]
 [-4.81428712e-01  1.10989699e-02 -6.77632329e-01]
 [ 1.29493927e-01 -1.10393633e-01 -1.26543845e-01]
 [ 7.77659751e-02  3.08104474e-02  2.57148143e-02]
 [ 2.53327505e-02  1.31087273e-01 -2.75277518e-02]
 [-1.02853697e-01  2.17785289e-03 -1.55816519e-01]
 [-6.16647594e-02  8.96223071e-02  1.05352973e-01]
 [-1.27523105e-01  9.80248496e-02  1.50768387e-01]
 [-9.82737419e-02 -8.70315189e-02  1.31922657e-02]
 [ 1.44184375e-01  1.21447321e-01  4.72002930e-02]
 [-1.19228212e-01  2.66818937e-01  2.28009193e-02]
 [ 8.38222970e-04 -1.65364720e-01  4.57260918e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.38054408]
curr_Stock_Price:  98.63898278221784
curr_Factors:  [98.63898278 -1.00237318 -1.00600599]
mat_Sqrt:  [[13.23794571  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01766985 -0.00208741  1.08044485]
Stock Position:  0.017669846573847563
Bond Position:  [-9.12347977]


portfolio before change:  [-7.39754278]
curr_Stock_Price:  97.74151075704219
curr_Factors:  [97.74151076 -0.72927359 -1.00627011]
mat_Sqrt:  [[17.23225025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00519909 -0.05323926  0.23664648]
Stock Position:  -0.005199092366155672
Bond Position:  [-6.88937564]


portfolio before change:  [-7.39321359]
curr_Stock_Price:  96.7431785491591
curr_Factors:  [96.74317855 -0.82464972 -1.01362976]
mat_Sqrt:  [[15.39096029  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01468585 0.05363106 0.82271747]
Stock Position:  0.014685849365160892
Bond Position:  [-8.81396933]


portfolio before change:  [-7.39414834]
curr_Stock_Price:  96.7545544055825
curr_Factors:  [96.75455441 -0.6742844  -1.02506312]
mat_Sqrt:  [[17.68699972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00570012 -0.00674314 -0.00502348]
Stock Position:  -0.00570011683879329
Bond Position:  [-6.84263607]


portfolio before change:  [-7.38400184]
curr_Stock_Price:  94.82443969386605
curr_Factors:  [94.82443969 -0.52845808 -1.0329544 ]
mat_Sqrt:  [[19.89790987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01118306 -0.01938541  0.03788576]
Stock Position:  0.011183059206235893
Bond Position:  [-8.44442916]


portfolio before change:  [-7.38676143]
curr_Stock_Price:  94.67206921546095
curr_Factors:  [94.67206922 -0.57388676 -1.05033838]
mat_Sqrt:  [[18.65648643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00336034 -0.12359242 -1.56947002]
Stock Position:  0.0033603435436813807
Bond Position:  [-7.7048921]


portfolio before change:  [-7.38884983]
curr_Stock_Price:  94.33721360606418
curr_Factors:  [94.33721361 -0.46098234 -1.0787547 ]
mat_Sqrt:  [[20.22943459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207526 -0.19354012 -0.28281233]
Stock Position:  -0.0020752593002008836
Bond Position:  [-7.19307565]


portfolio before change:  [-7.39106769]
curr_Stock_Price:  94.97263727401896
curr_Factors:  [94.97263727 -0.55290086 -1.06233926]
mat_Sqrt:  [[18.88463636  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00279347  0.07686979 -0.00523147]
Stock Position:  0.0027934736877274144
Bond Position:  [-7.65637125]


portfolio before change:  [-7.39145599]
curr_Stock_Price:  95.17625645724189
curr_Factors:  [95.17625646 -0.62976933 -1.05192525]
mat_Sqrt:  [[17.70834363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00444666  0.00827937 -0.07535618]
Stock Position:  0.004446657073976632
Bond Position:  [-7.81467216]


portfolio before change:  [-7.38958553]
curr_Stock_Price:  95.8165919862847
curr_Factors:  [95.81659199 -0.66939351 -1.06137654]
mat_Sqrt:  [[16.97371231  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01318528 0.01972575 1.00933972]
Stock Position:  0.013185280359173723
Bond Position:  [-8.65295416]


portfolio before change:  [-7.39021]
curr_Stock_Price:  95.85126872998276
curr_Factors:  [95.85126873 -0.76861001 -1.04838227]
mat_Sqrt:  [[15.577155    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01243683 -0.06618563 -0.17485102]
Stock Position:  0.012436833018882043
Bond Position:  [-8.58229622]


portfolio before change:  [-7.39712926]
curr_Stock_Price:  95.38118067934084
curr_Factors:  [95.38118068 -0.6021061  -1.01386708]
mat_Sqrt:  [[18.95197449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01688684 -0.05186253 -1.03123471]
Stock Position:  -0.016886835041392587
Bond Position:  [-5.78644299]


portfolio before change:  [-7.40545636]
curr_Stock_Price:  95.83145753072756
curr_Factors:  [95.83145753 -0.52169107 -0.98645138]
mat_Sqrt:  [[21.20948614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01166152 -0.11869054 -0.37970917]
Stock Position:  0.011661521751796198
Bond Position:  [-8.52299699]


portfolio before change:  [-7.42084504]
curr_Stock_Price:  94.60320994309733
curr_Factors:  [94.60320994 -0.51175202 -0.96788163]
mat_Sqrt:  [[21.54314695  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090465 -0.04682879 -0.24107138]
Stock Position:  -0.0009046543123076276
Bond Position:  [-7.33526183]


portfolio before change:  [-7.42281628]
curr_Stock_Price:  95.76860211791897
curr_Factors:  [95.76860212 -0.46846154 -0.97788447]
mat_Sqrt:  [[22.54670352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00659364  0.11064918  0.71710636]
Stock Position:  -0.0065936425491548226
Bond Position:  [-6.79135235]


portfolio before change:  [-7.41745772]
curr_Stock_Price:  94.82716087961427
curr_Factors:  [94.82716088 -0.23772652 -0.98287641]
mat_Sqrt:  [[27.97896395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00182985 -0.18273341 -0.47203023]
Stock Position:  0.0018298501450572957
Bond Position:  [-7.59097722]


portfolio before change:  [-7.42076326]
curr_Stock_Price:  93.53929539630033
curr_Factors:  [93.5392954  -0.61427141 -1.01135264]
mat_Sqrt:  [[18.40748869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00664293 -0.0651854  -0.32270956]
Stock Position:  0.006642929860670438
Bond Position:  [-8.04213823]


portfolio before change:  [-7.42308899]
curr_Stock_Price:  93.34052681113319
curr_Factors:  [93.34052681 -0.76828283 -1.03056929]
mat_Sqrt:  [[15.44680612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02289047 -0.02267775 -0.07195916]
Stock Position:  -0.02289046916341388
Bond Position:  [-5.28648054]


portfolio before change:  [-7.44290267]
curr_Stock_Price:  94.17724308765344
curr_Factors:  [94.17724309 -0.66992929 -1.04540682]
mat_Sqrt:  [[16.9427914   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01564318 0.3564518  0.46782351]
Stock Position:  0.015643179115588313
Bond Position:  [-8.91613415]


portfolio before change:  [-7.42772818]
curr_Stock_Price:  95.2185324288
curr_Factors:  [95.21853243 -0.64744195 -1.09141354]
mat_Sqrt:  [[16.7319338   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01807586 -0.01843484  0.77224631]
Stock Position:  -0.018075856529552604
Bond Position:  [-5.70657165]


portfolio before change:  [-7.41779071]
curr_Stock_Price:  94.62930232002232
curr_Factors:  [94.62930232 -0.66986024 -1.10850112]
mat_Sqrt:  [[15.98428115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00600578  0.00100959 -0.1250897 ]
Stock Position:  -0.0060057832508635875
Bond Position:  [-6.84946763]


portfolio before change:  [-7.42392681]
curr_Stock_Price:  95.50843278568799
curr_Factors:  [95.50843279 -0.50554339 -1.11338637]
mat_Sqrt:  [[18.92123393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00539955 -0.01040967  0.17424479]
Stock Position:  0.0053995462527172714
Bond Position:  [-7.93962901]


portfolio before change:  [-7.43159592]
curr_Stock_Price:  94.271923800763
curr_Factors:  [94.2719238  -0.42446396 -1.09928707]
mat_Sqrt:  [[20.54119497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00504175  0.02222212 -0.3047482 ]
Stock Position:  -0.005041748967725652
Bond Position:  [-6.95630054]


portfolio before change:  [-7.44069257]
curr_Stock_Price:  95.9037107499393
curr_Factors:  [95.90371075 -0.71060017 -1.09112046]
mat_Sqrt:  [[15.82552342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082709 -0.03332611  0.29662939]
Stock Position:  0.0008270858926983203
Bond Position:  [-7.52001317]


portfolio before change:  [-7.44271048]
curr_Stock_Price:  94.60051962497175
curr_Factors:  [94.60051962 -0.88528556 -1.08944786]
mat_Sqrt:  [[13.13039202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00777324  0.03115708  0.09013424]
Stock Position:  -0.007773235014053721
Bond Position:  [-6.70735841]


portfolio before change:  [-7.46093432]
curr_Stock_Price:  96.83708755871464
curr_Factors:  [96.83708756 -0.81857167 -1.08258058]
mat_Sqrt:  [[14.46711014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00613406 -0.02781306 -0.23502664]
Stock Position:  0.006134061277726128
Bond Position:  [-8.05493895]


portfolio before change:  [-7.46043008]
curr_Stock_Price:  97.0834444586258
curr_Factors:  [97.08344446 -0.71194139 -1.09050207]
mat_Sqrt:  [[16.00862119  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0036955  -0.02032262  0.32774242]
Stock Position:  0.003695504711540086
Bond Position:  [-7.81920241]


portfolio before change:  [-7.4654896]
curr_Stock_Price:  95.97884263388767
curr_Factors:  [95.97884263 -0.76694615 -1.08828483]
mat_Sqrt:  [[15.01270434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445449  0.01351342  0.24938224]
Stock Position:  -0.004454493963839535
Bond Position:  [-7.03795243]


portfolio before change:  [-7.47008866]
curr_Stock_Price:  96.81378735109423
curr_Factors:  [96.81378735 -0.6448311  -1.10544657]
mat_Sqrt:  [[16.81904274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03683107  0.0035098  -1.93309642]
Stock Position:  -0.036831065062270546
Bond Position:  [-3.90433376]


portfolio before change:  [-7.46515039]
curr_Stock_Price:  96.66645664881162
curr_Factors:  [96.66645665 -0.64314611 -1.07446599]
mat_Sqrt:  [[17.35107322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00581018 -0.03490953 -0.36099437]
Stock Position:  0.005810183636581951
Bond Position:  [-8.02680025]


portfolio before change:  [-7.46022512]
curr_Stock_Price:  97.68685080648129
curr_Factors:  [97.68685081 -0.75020298 -1.06655391]
mat_Sqrt:  [[15.8792      0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00527801 0.00974312 0.07335721]
Stock Position:  0.005278005939205497
Bond Position:  [-7.9758169]


portfolio before change:  [-7.46409481]
curr_Stock_Price:  97.14258237936326
curr_Factors:  [97.14258238 -0.58674899 -1.0847217 ]
mat_Sqrt:  [[18.25993158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00126497  0.04145344 -0.07852901]
Stock Position:  0.0012649735524995584
Bond Position:  [-7.58697761]


portfolio before change:  [-7.46512682]
curr_Stock_Price:  97.07651173164757
curr_Factors:  [97.07651173 -0.5366178  -1.10183728]
mat_Sqrt:  [[18.86002053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00713697  0.0006887  -0.44450116]
Stock Position:  -0.007136968847145539
Bond Position:  [-6.77229478]


portfolio before change:  [-7.47289613]
curr_Stock_Price:  98.04649211481174
curr_Factors:  [98.04649211 -0.45678101 -1.10377868]
mat_Sqrt:  [[20.5915766   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183792  0.02834106  0.30054271]
Stock Position:  -0.0018379183156453742
Bond Position:  [-7.29269469]


portfolio before change:  [-7.47132246]
curr_Stock_Price:  96.69424641073375
curr_Factors:  [96.69424641 -0.38448673 -1.06496876]
mat_Sqrt:  [[22.69395079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00415162  0.03099818  0.43010024]
Stock Position:  -0.004151619385237987
Bond Position:  [-7.06988475]


portfolio before change:  [-7.47052349]
curr_Stock_Price:  96.28892037462431
curr_Factors:  [96.28892037 -0.36385418 -1.08737328]
mat_Sqrt:  [[22.5588128   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00433658 -0.02752178  0.03763386]
Stock Position:  -0.004336576883423684
Bond Position:  [-7.05295918]


portfolio before change:  [-7.46645067]
curr_Stock_Price:  95.14643169939865
curr_Factors:  [95.1464317  -0.45238044 -1.07486184]
mat_Sqrt:  [[20.6594908   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00759723 0.03840501 0.1346493 ]
Stock Position:  0.007597227453047473
Bond Position:  [-8.18929976]


portfolio before change:  [-7.47903204]
curr_Stock_Price:  93.6251350449473
curr_Factors:  [93.62513504 -0.35552549 -1.06250962]
mat_Sqrt:  [[22.67501759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00474905  0.08437556  0.06504468]
Stock Position:  -0.004749048505584264
Bond Position:  [-7.03440173]


portfolio before change:  [-7.47679206]
curr_Stock_Price:  92.96830278373392
curr_Factors:  [92.96830278 -0.40614466 -1.02278902]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.47679206]
Stock Price:  93.85220612999326
PL:  [-7.47679206]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-3.58136956e-02  6.42267848e-02  1.13319969e-02]
 [ 3.67310063e-02 -9.69599157e-02 -2.22253773e-01]
 [ 3.85004486e-01 -4.71850153e-01 -8.70890228e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.13756649e+00 -2.89598135e-01 -2.27468501e-01]
 [-2.37596822e-02  6.44328536e-02  8.78664442e-02]
 [ 1.69711225e-02  1.18174560e-01  4.62114200e-02]
 [ 2.60508716e-01 -1.02086515e-03 -5.78797712e-02]
 [-3.90152713e-01 -1.64440520e-02 -5.76442002e-02]
 [ 7.89501582e-02 -3.99318960e-02 -5.53400826e-02]
 [ 1.33517982e-01 -3.08774720e-01  4.70223133e-03]
 [-2.03336443e-01 -1.42727796e-01 -3.13987336e-01]
 [ 2.43659107e-01 -2.96606944e-01 -4.35418868e-02]
 [ 2.98948895e-03 -1.27470890e-01 -9.55804144e-02]
 [-2.07318164e-01  3.46386641e-01  2.48636526e-01]
 [ 4.25507439e-02 -3.48712216e-01 -8.96398711e-02]
 [-2.95054213e-01 -2.52233604e-01  6.07000916e-02]
 [-2.39849795e-01 -1.26975452e-01 -3.71751907e-02]
 [ 2.12879026e-01  1.05485780e+00  1.50651953e-01]
 [-3.64723536e-01 -5.90957360e-02  2.74109339e-01]
 [-8.42300641e-02  3.15735078e-01 -2.06459211e-02]
 [-3.82790284e-02  3.41196070e-02 -1.52360273e-02]
 [ 7.83059881e-02 -4.10622986e-02  9.63488112e-02]
 [ 7.93074416e-02  1.61908276e-01  3.06553663e-02]
 [-8.29782230e-02 -4.72479861e-02  1.82328081e-01]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [ 6.11370263e-02 -5.23767948e-02  3.29799543e-01]
 [ 1.29146892e-01  8.38922539e-02 -9.87873541e-02]
 [-9.55175776e-01 -1.70071451e-01 -1.33328372e+00]
 [ 1.59537230e-01 -3.81126918e-01  3.46926506e-01]
 [-7.76406763e-02 -2.42340566e-01  1.35945388e-01]
 [ 1.19541050e-01  3.65913932e-01 -9.51843791e-02]
 [-8.59860816e-02  5.73807011e-03  7.20976610e-02]
 [ 3.17403819e-02  5.22195496e-01 -5.43723782e-02]
 [ 6.03086255e-02 -1.71023036e-01 -1.87474282e-01]
 [-7.88184135e-02  4.64343026e-01  9.03708825e-02]
 [ 3.53719832e-01  2.39424243e-01  4.07106649e-02]
 [ 9.41476923e-02 -1.69757861e-03 -1.58842813e-02]
 [-2.48851126e-01 -5.33886153e-01  1.25559569e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.3298663]
curr_Stock_Price:  101.10657365498477
curr_Factors:  [101.10657365  -1.11295608  -1.01738667]
mat_Sqrt:  [[12.01111414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00265106  0.02031029  0.03232703]
Stock Position:  -0.002651064055134387
Bond Position:  [10.5979063]


portfolio before change:  [10.32876953]
curr_Stock_Price:  102.02001361466024
curr_Factors:  [102.02001361  -0.86329864  -1.00919813]
mat_Sqrt:  [[15.68448859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071025 -0.03066142 -0.63402815]
Stock Position:  -0.0007102462560672109
Bond Position:  [10.40122887]


portfolio before change:  [10.32946621]
curr_Stock_Price:  102.86979440607831
curr_Factors:  [102.86979441  -0.92733846  -1.00096036]
mat_Sqrt:  [[14.956788    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01304101 -0.14921212 -2.48440741]
Stock Position:  0.013041011464468394
Bond Position:  [8.98794005]


portfolio before change:  [10.32995214]
curr_Stock_Price:  102.82089987623512
curr_Factors:  [102.82089988  -0.85756688  -0.98123161]
mat_Sqrt:  [[16.34938281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120513 -0.00659539  0.21422481]
Stock Position:  0.0012051252413765722
Bond Position:  [10.20604008]


portfolio before change:  [10.33272933]
curr_Stock_Price:  104.06670516256793
curr_Factors:  [104.06670516  -0.86217531  -1.00461516]
mat_Sqrt:  [[16.09070246  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07404746 -0.09157897 -0.64890432]
Stock Position:  -0.07404746288309988
Bond Position:  [18.03860482]


portfolio before change:  [10.4193412]
curr_Stock_Price:  102.92747766424749
curr_Factors:  [102.92747766  -1.06218896  -1.01986608]
mat_Sqrt:  [[12.8323534   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032421  0.02037546  0.25065851]
Stock Position:  -0.0003242094521747236
Bond Position:  [10.45271126]


portfolio before change:  [10.42104849]
curr_Stock_Price:  101.69181518015081
curr_Factors:  [101.69181518  -0.76161308  -1.01313405]
mat_Sqrt:  [[17.23943832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0017086  0.03737008 0.13182832]
Stock Position:  0.0017085964494395814
Bond Position:  [10.24729821]


portfolio before change:  [10.41931148]
curr_Stock_Price:  99.92545518280264
curr_Factors:  [99.92545518 -0.883697   -0.99204611]
mat_Sqrt:  [[15.31268161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01623933 -0.00032283 -0.16511488]
Stock Position:  0.016239330544146606
Bond Position:  [8.79658898]


portfolio before change:  [10.41659975]
curr_Stock_Price:  99.6907550614102
curr_Factors:  [99.69075506 -0.64471019 -0.96798599]
mat_Sqrt:  [[19.873293    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02024546 -0.00520007 -0.16444286]
Stock Position:  -0.020245455518806077
Bond Position:  [12.4348845]


portfolio before change:  [10.42886362]
curr_Stock_Price:  99.16177630933426
curr_Factors:  [99.16177631 -0.48391356 -0.9562977 ]
mat_Sqrt:  [[23.48921454  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00283632 -0.01262757 -0.15786985]
Stock Position:  0.0028363176579991314
Bond Position:  [10.14760933]


portfolio before change:  [10.42632489]
curr_Stock_Price:  97.81944828205513
curr_Factors:  [97.81944828 -0.47635484 -0.94710739]
mat_Sqrt:  [[23.56261115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0053689  -0.09764314  0.01341416]
Stock Position:  0.0053688995286056765
Bond Position:  [9.9011421]


portfolio before change:  [10.41765108]
curr_Stock_Price:  95.97334887889764
curr_Factors:  [95.97334888 -0.36435895 -0.96489075]
mat_Sqrt:  [[25.40182014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01067302 -0.04513449 -0.89571847]
Stock Position:  -0.010673016908551408
Bond Position:  [11.44197626]


portfolio before change:  [10.40846525]
curr_Stock_Price:  96.96802263479258
curr_Factors:  [96.96802263 -0.42007815 -0.98178003]
mat_Sqrt:  [[23.86762849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00951552 -0.09379535 -0.12421288]
Stock Position:  0.00951551589807646
Bond Position:  [9.48576449]


portfolio before change:  [10.40864216]
curr_Stock_Price:  96.8619977864383
curr_Factors:  [96.86199779 -0.29958866 -0.94501038]
mat_Sqrt:  [[27.90171679  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071007 -0.04030983 -0.27266432]
Stock Position:  -0.0007100661883780219
Bond Position:  [10.47742059]


portfolio before change:  [10.4107279]
curr_Stock_Price:  95.76917413745007
curr_Factors:  [95.76917414 -0.49504589 -0.94058854]
mat_Sqrt:  [[22.78964885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00647758  0.10953707  0.7092908 ]
Stock Position:  -0.006477580319149672
Bond Position:  [11.03108042]


portfolio before change:  [10.40165354]
curr_Stock_Price:  97.38294464546044
curr_Factors:  [97.38294465 -0.31425192 -0.95706617]
mat_Sqrt:  [[27.31218652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00055834 -0.11027248 -0.2557176 ]
Stock Position:  0.0005583357858435085
Bond Position:  [10.34728116]


portfolio before change:  [10.40333653]
curr_Stock_Price:  98.08054210440226
curr_Factors:  [98.0805421  -0.46596827 -0.98037024]
mat_Sqrt:  [[23.09117465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01252325 -0.07976327  0.17316047]
Stock Position:  -0.012523247814713149
Bond Position:  [11.63162346]


portfolio before change:  [10.40292812]
curr_Stock_Price:  98.22926129249691
curr_Factors:  [98.22926129 -0.41080665 -0.97457814]
mat_Sqrt:  [[24.57966214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01020017 -0.04015316 -0.10605047]
Stock Position:  -0.010200166294610645
Bond Position:  [11.40488292]


portfolio before change:  [10.41412285]
curr_Stock_Price:  97.27152954734096
curr_Factors:  [97.27152955 -0.21679757 -0.95488755]
mat_Sqrt:  [[30.13903626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00898725 0.33357533 0.42976809]
Stock Position:  0.008987249504288678
Bond Position:  [9.53991934]


portfolio before change:  [10.41008048]
curr_Stock_Price:  96.6890450467361
curr_Factors:  [96.68904505 -0.09723223 -0.99044075]
mat_Sqrt:  [[32.58418754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00952293 -0.01868771  0.78195765]
Stock Position:  -0.009522933379668735
Bond Position:  [11.33084381]


portfolio before change:  [10.3790458]
curr_Stock_Price:  100.09672676277685
curr_Factors:  [100.09672676  -0.35291604  -1.02076332]
mat_Sqrt:  [[25.34186135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00316836  0.0998442  -0.05889707]
Stock Position:  -0.003168360417970427
Bond Position:  [10.6961883]


portfolio before change:  [10.38325716]
curr_Stock_Price:  99.18955284494294
curr_Factors:  [ 9.91895528e+01 -8.71265686e-02 -1.02324228e+00]
mat_Sqrt:  [[32.67675113  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00123966  0.01078957 -0.04346414]
Stock Position:  -0.0012396613381767685
Bond Position:  [10.50621861]


portfolio before change:  [10.38271454]
curr_Stock_Price:  100.68671979514528
curr_Factors:  [ 1.00686720e+02 -2.25391385e-02 -1.02551460e+00]
mat_Sqrt:  [[35.3027255   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0027452  -0.01298504  0.27485634]
Stock Position:  0.002745195491814315
Bond Position:  [10.10630981]


portfolio before change:  [10.38578536]
curr_Stock_Price:  101.34512787905678
curr_Factors:  [101.34512788  -0.13167686  -0.98834503]
mat_Sqrt:  [[33.06614378  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00271412 0.05119989 0.08745123]
Stock Position:  0.0027141173880702247
Bond Position:  [10.11072279]


portfolio before change:  [10.39342338]
curr_Stock_Price:  103.69362661544253
curr_Factors:  [103.69362662  -0.13462428  -0.98607428]
mat_Sqrt:  [[33.80950907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138957 -0.01494113  0.52013126]
Stock Position:  -0.00138956756261013
Bond Position:  [10.53751268]


portfolio before change:  [10.39636662]
curr_Stock_Price:  102.52350565173097
curr_Factors:  [ 1.02523506e+02 -9.85174344e-02 -9.78750231e-01]
mat_Sqrt:  [[34.91178427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00037111  0.02004328 -0.05140267]
Stock Position:  0.0003711091590909448
Bond Position:  [10.35831921]


portfolio before change:  [10.39828163]
curr_Stock_Price:  104.19454679020517
curr_Factors:  [ 1.04194547e+02  3.98660707e-02 -1.00235624e+00]
mat_Sqrt:  [[39.79612819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0031939 -0.016563   0.9408263]
Stock Position:  0.003193896462541881
Bond Position:  [10.06549503]


portfolio before change:  [10.4157082]
curr_Stock_Price:  109.25679897902353
curr_Factors:  [ 1.09256799e+02 -5.96985776e-02 -1.00401947e+00]
mat_Sqrt:  [[37.71217625  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00294727  0.02652906 -0.28181282]
Stock Position:  0.0029472734741077
Bond Position:  [10.09369854]


portfolio before change:  [10.41633797]
curr_Stock_Price:  109.04235590082324
curr_Factors:  [ 1.09042356e+02  3.58629589e-02 -9.99527770e-01]
mat_Sqrt:  [[41.59881088  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02960956 -0.05378131 -3.80348733]
Stock Position:  -0.029609557954094017
Bond Position:  [13.64503393]


portfolio before change:  [10.4090092]
curr_Stock_Price:  109.34747712004189
curr_Factors:  [ 1.09347477e+02  5.15954256e-03 -9.96130218e-01]
mat_Sqrt:  [[40.59155335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00543248 -0.12052291  0.98968476]
Stock Position:  0.0054324763135709525
Bond Position:  [9.81498162]


portfolio before change:  [10.40845957]
curr_Stock_Price:  109.02044715074614
curr_Factors:  [109.02044715  -0.1919961   -1.01169461]
mat_Sqrt:  [[32.71536152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00171626 -0.07663482  0.38781435]
Stock Position:  -0.001716262458995264
Bond Position:  [10.59556727]


portfolio before change:  [10.40703427]
curr_Stock_Price:  110.62266702565707
curr_Factors:  [110.62266703  -0.31864228  -0.98800916]
mat_Sqrt:  [[29.94833034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00365828  0.11571215 -0.27153454]
Stock Position:  0.003658283301037493
Bond Position:  [10.00234521]


portfolio before change:  [10.40703538]
curr_Stock_Price:  110.28117864934218
curr_Factors:  [110.28117865  -0.38115307  -1.010014  ]
mat_Sqrt:  [[27.43627939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259223  0.00181454  0.20567456]
Stock Position:  -0.0025922265491197948
Bond Position:  [10.69290918]


portfolio before change:  [10.40069858]
curr_Stock_Price:  113.24137253999669
curr_Factors:  [113.24137254  -0.20966753  -1.00236388]
mat_Sqrt:  [[33.6997416   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00101261  0.16513272 -0.15510926]
Stock Position:  0.0010126100326808966
Bond Position:  [10.28602923]


portfolio before change:  [10.40175652]
curr_Stock_Price:  113.01631465976865
curr_Factors:  [113.01631466  -0.26372733  -0.99440821]
mat_Sqrt:  [[32.11735857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00054876 -0.05408223 -0.53481194]
Stock Position:  0.0005487625070621721
Bond Position:  [10.3397374]


portfolio before change:  [10.40291714]
curr_Stock_Price:  112.77591303050686
curr_Factors:  [112.77591303  -0.27409731  -1.0189923 ]
mat_Sqrt:  [[30.94814815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156333  0.14683816  0.25780297]
Stock Position:  -0.0015633326008873984
Bond Position:  [10.57922341]


portfolio before change:  [10.40185891]
curr_Stock_Price:  114.29876079831143
curr_Factors:  [114.2987608   -0.47231524  -1.00526049]
mat_Sqrt:  [[26.08185878  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01411754 0.07571259 0.1161362 ]
Stock Position:  0.014117543233879272
Bond Position:  [8.78824122]


portfolio before change:  [10.39540042]
curr_Stock_Price:  113.76346261990545
curr_Factors:  [113.76346262  -0.41294062  -0.9888    ]
mat_Sqrt:  [[28.00493596  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00324448 -0.00053682 -0.04531343]
Stock Position:  0.0032444814646216636
Bond Position:  [10.02629697]


portfolio before change:  [10.39806982]
curr_Stock_Price:  114.19990773052359
curr_Factors:  [114.19990773  -0.53164023  -1.00599642]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.39806982]
Stock Price:  113.58996963250561
PL:  [-3.19189981]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-6.94623077e-02 -2.63270000e-02 -3.12264211e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 1.91070006e-01 -1.03656240e-01 -1.81046574e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.68646832e+00 -4.90860829e-01  1.14406368e-02]
 [-7.13813324e-02  5.14088975e-02  1.01438837e-01]
 [ 1.08842791e-02  1.30186100e-01  3.88066663e-02]
 [ 4.30086676e-01  9.24684766e-02 -1.31105217e-01]
 [-5.20152783e-01 -2.92496609e-02 -6.15616331e-02]
 [ 1.14422946e-02  4.37926490e-02 -1.27814056e-02]
 [-3.39298925e-02 -1.61436741e-01  8.69210634e-02]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.38245485e-01 -5.28836654e-02  2.84708087e-01]
 [ 7.14292063e-02  9.80570697e-02  5.42028417e-02]
 [ 7.54453012e-02 -1.13050661e-01 -5.29213871e-02]
 [-1.91623441e-02  6.94801976e-04  3.74754394e-02]
 [-5.15699805e-01 -2.64262585e-01  1.45588753e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 3.02268220e-01  1.20944357e+00  4.85967181e-01]
 [-3.45464728e-03  2.45264099e-02  2.86030289e-02]
 [-3.17955969e-02 -1.36060036e-01 -4.82410922e-03]
 [-2.99616493e-02  5.97361583e-02 -2.98328011e-02]
 [ 1.23237030e-01 -3.02392429e-02  1.37209880e-01]
 [ 7.94250078e-02 -1.21655982e-01 -6.62307247e-02]
 [-7.96416325e-02 -2.63602151e-02  1.33556801e-01]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [-8.01258402e-02 -3.19576767e-02  7.38801541e-02]
 [ 3.74566192e-02  5.57479922e-02 -8.38768917e-02]
 [-7.07579819e-01 -1.37259643e-01 -1.06704207e+00]
 [-1.08736107e-01  5.61156268e-02  5.56506340e-03]
 [-1.15831258e-01 -2.70094158e-02  1.23083329e-01]
 [ 1.77009453e-02  7.25209619e-02  6.77682208e-03]
 [-1.46362010e-01 -6.73886127e-04 -1.33208841e-01]
 [-6.31101915e-02  4.31124811e-02  7.61910669e-02]
 [ 1.55204453e-01 -1.60449836e-01 -1.01873917e-01]
 [-1.45188325e-02  1.89009878e-01  8.13485780e-02]
 [ 4.66568842e-02  4.50015983e-02 -3.90399342e-02]
 [-3.55961609e-02  7.92175097e-02 -8.83773606e-03]
 [-9.17552684e-02 -1.72847082e-01  3.52875226e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.86088574]
curr_Stock_Price:  100.483910746635
curr_Factors:  [100.48391075  -1.23216178  -0.97839925]
mat_Sqrt:  [[11.0169676   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0069453  -0.00832533 -0.08908029]
Stock Position:  -0.006945299034423311
Bond Position:  [6.55877655]


portfolio before change:  [5.86144791]
curr_Stock_Price:  100.52101923397177
curr_Factors:  [100.52101923  -1.46883461  -0.98726261]
mat_Sqrt:  [[ 8.62159095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00526365  0.01411938  0.0859571 ]
Stock Position:  -0.005263650653129902
Bond Position:  [6.39055544]


portfolio before change:  [5.86258177]
curr_Stock_Price:  100.45737626558027
curr_Factors:  [100.45737627  -1.39247384  -1.02060555]
mat_Sqrt:  [[ 8.99486751  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01683601 -0.03277898 -0.51647548]
Stock Position:  0.016836005247876498
Bond Position:  [4.17128086]


portfolio before change:  [5.86987566]
curr_Stock_Price:  100.85963564754458
curr_Factors:  [100.85963565  -1.7521885   -1.03373544]
mat_Sqrt:  [[ 6.22022369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316758 -0.00659539  0.21422481]
Stock Position:  0.003167579637448002
Bond Position:  [5.55039473]


portfolio before change:  [5.87204274]
curr_Stock_Price:  101.32473641181019
curr_Factors:  [101.32473641  -2.04494952  -1.05987759]
mat_Sqrt:  [[ 4.54261787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.37353065 -0.15522382  0.03263695]
Stock Position:  -0.3735306452918094
Bond Position:  [43.71993692]


portfolio before change:  [5.8692953]
curr_Stock_Price:  101.34672331176202
curr_Factors:  [101.34672331  -2.01983936  -1.06785983]
mat_Sqrt:  [[ 4.62209631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01067651  0.01625692  0.28937677]
Stock Position:  -0.010676507182090882
Bond Position:  [6.95132432]


portfolio before change:  [5.87117226]
curr_Stock_Price:  101.25231062741645
curr_Factors:  [101.25231063  -2.1507678   -1.07397253]
mat_Sqrt:  [[ 4.02641015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00550541 0.04116846 0.11070462]
Stock Position:  0.005505412143970569
Bond Position:  [5.31373656]


portfolio before change:  [5.87120012]
curr_Stock_Price:  101.13671541444641
curr_Factors:  [101.13671541  -1.87128929  -1.08641347]
mat_Sqrt:  [[ 5.2528483   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07723666  0.0292411  -0.37400669]
Stock Position:  0.07723666070891025
Bond Position:  [-1.94026205]


portfolio before change:  [5.86514002]
curr_Stock_Price:  101.06139423646134
curr_Factors:  [101.06139424  -1.75315273  -1.05981744]
mat_Sqrt:  [[ 6.0663556   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08793982 -0.00924955 -0.1756182 ]
Stock Position:  -0.08793982038146081
Bond Position:  [14.75246088]


portfolio before change:  [5.84035971]
curr_Stock_Price:  101.36415218560124
curr_Factors:  [101.36415219  -1.75901506  -1.06662039]
mat_Sqrt:  [[ 6.00795279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165847  0.01384845 -0.03646179]
Stock Position:  0.0016584721559946885
Bond Position:  [5.67225009]


portfolio before change:  [5.84098317]
curr_Stock_Price:  101.31252995296528
curr_Factors:  [101.31252995  -1.5855717   -1.08037784]
mat_Sqrt:  [[ 7.04459433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288952 -0.05105078  0.2479616 ]
Stock Position:  -0.0028895181937205546
Bond Position:  [6.13372757]


portfolio before change:  [5.84127745]
curr_Stock_Price:  101.47604944806668
curr_Factors:  [101.47604945  -1.46195639  -1.06848317]
mat_Sqrt:  [[ 8.07993027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00892651  0.00225658  0.15019092]
Stock Position:  -0.008926514978832258
Bond Position:  [6.74710492]


portfolio before change:  [5.84253865]
curr_Stock_Price:  101.42924901591836
curr_Factors:  [101.42924902  -1.38064506  -1.08941429]
mat_Sqrt:  [[ 8.57886954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02272978 -0.01672328  0.81219292]
Stock Position:  0.022729781444169202
Bond Position:  [3.53707399]


portfolio before change:  [5.83231655]
curr_Stock_Price:  100.96007330917665
curr_Factors:  [100.96007331  -1.11135616  -1.0609484 ]
mat_Sqrt:  [[11.5008456   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00739295 0.03100837 0.15462562]
Stock Position:  0.007392946633460612
Bond Position:  [5.08592412]


portfolio before change:  [5.83476546]
curr_Stock_Price:  101.20532389188834
curr_Factors:  [101.20532389  -1.30254679  -1.11503666]
mat_Sqrt:  [[ 9.02111473  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00684215 -0.03574976 -0.15096999]
Stock Position:  0.006842149181258028
Bond Position:  [5.14230353]


portfolio before change:  [5.83931502]
curr_Stock_Price:  101.776304363084
curr_Factors:  [101.77630436  -1.20939401  -1.13033838]
mat_Sqrt:  [[ 9.80649497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00117216  0.00021972  0.106907  ]
Stock Position:  -0.0011721580831750504
Bond Position:  [5.95861294]


portfolio before change:  [5.84031535]
curr_Stock_Price:  101.55836315097942
curr_Factors:  [101.55836315  -1.28027698  -1.09842544]
mat_Sqrt:  [[ 9.41148944  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05236205 -0.08356717  0.41532419]
Stock Position:  -0.0523620473041337
Bond Position:  [11.15811917]


portfolio before change:  [5.82916107]
curr_Stock_Price:  101.79802413109111
curr_Factors:  [101.79802413  -1.13315107  -1.11531942]
mat_Sqrt:  [[10.74585615  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01221969  0.00580111 -0.05715682]
Stock Position:  -0.012219694921128062
Bond Position:  [7.07310186]


portfolio before change:  [5.8332271]
curr_Stock_Price:  101.53763803966713
curr_Factors:  [101.53763804  -1.21902988  -1.09136299]
mat_Sqrt:  [[10.07479422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04294813 0.38245964 1.3863291 ]
Stock Position:  0.04294812823110567
Bond Position:  [1.4723756]


portfolio before change:  [5.84258083]
curr_Stock_Price:  101.7511437452394
curr_Factors:  [101.75114375  -1.34360961  -1.08874812]
mat_Sqrt:  [[ 8.93675304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00033762 0.00775593 0.08159648]
Stock Position:  0.0003376159897045069
Bond Position:  [5.80822801]


portfolio before change:  [5.84336179]
curr_Stock_Price:  101.91373772068482
curr_Factors:  [101.91373772  -1.35518687  -1.07191215]
mat_Sqrt:  [[ 8.99822857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403339 -0.04302596 -0.01376184]
Stock Position:  -0.004033390439268779
Bond Position:  [6.25441969]


portfolio before change:  [5.84311593]
curr_Stock_Price:  102.1685405184183
curr_Factors:  [102.16854052  -1.30221879  -1.04952596]
mat_Sqrt:  [[ 9.72674265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00354783  0.01889023 -0.08510468]
Stock Position:  -0.003547833497932796
Bond Position:  [6.2055929]


portfolio before change:  [5.84149689]
curr_Stock_Price:  102.84353914482648
curr_Factors:  [102.84353914  -1.17539363  -1.04844358]
mat_Sqrt:  [[11.12696662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01352247 -0.00956249  0.39142159]
Stock Position:  0.013522472989968818
Bond Position:  [4.45079791]


portfolio before change:  [5.85058667]
curr_Stock_Price:  103.47459190568648
curr_Factors:  [103.47459191  -1.18923106  -1.05140679]
mat_Sqrt:  [[11.00872616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00570135 -0.038471   -0.18893782]
Stock Position:  0.005701347542175189
Bond Position:  [5.26064206]


portfolio before change:  [5.84907094]
curr_Stock_Price:  103.09339264694144
curr_Factors:  [103.09339265  -1.44341936  -1.0115685 ]
mat_Sqrt:  [[ 8.85203562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00599411 -0.00833583  0.38100038]
Stock Position:  -0.00599411081233338
Bond Position:  [6.46702416]


portfolio before change:  [5.85265289]
curr_Stock_Price:  102.63068454639543
curr_Factors:  [102.63068455  -1.26232342  -1.00068808]
mat_Sqrt:  [[10.67735832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00121342  0.02004328 -0.05140267]
Stock Position:  0.0012134165129207921
Bond Position:  [5.72811913]


portfolio before change:  [5.85375732]
curr_Stock_Price:  102.95074656573547
curr_Factors:  [102.95074657  -1.34570109  -0.97310931]
mat_Sqrt:  [[10.12938169  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00650289 -0.0101059   0.21075952]
Stock Position:  -0.006502890561725478
Bond Position:  [6.52323476]


portfolio before change:  [5.85325181]
curr_Stock_Price:  103.15388261457245
curr_Factors:  [103.15388261  -1.42205193  -0.98065406]
mat_Sqrt:  [[ 9.3326209   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00233318  0.01762906 -0.23927743]
Stock Position:  0.0023331846021522364
Bond Position:  [5.61257475]


portfolio before change:  [5.85851681]
curr_Stock_Price:  105.1097467902848
curr_Factors:  [105.10974679  -1.28649555  -0.97919186]
mat_Sqrt:  [[10.90604916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08517593 -0.04340531 -3.04397402]
Stock Position:  -0.08517593167914277
Bond Position:  [14.81133742]


portfolio before change:  [5.8874399]
curr_Stock_Price:  104.79191580183347
curr_Factors:  [104.7919158   -1.31610355  -0.96182448]
mat_Sqrt:  [[10.74078955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.009883    0.01774532  0.01587558]
Stock Position:  -0.009883001971763365
Bond Position:  [6.92309861]


portfolio before change:  [5.88866886]
curr_Stock_Price:  104.75513292871561
curr_Factors:  [104.75513293  -1.46676174  -0.98526655]
mat_Sqrt:  [[ 9.02137953  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01013197 -0.00854113  0.35112248]
Stock Position:  -0.010131971337330088
Bond Position:  [6.95004487]


portfolio before change:  [5.89042987]
curr_Stock_Price:  104.6670757724998
curr_Factors:  [104.66707577  -1.35296277  -0.98644249]
mat_Sqrt:  [[10.08833043  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00207733 0.02293314 0.01933239]
Stock Position:  0.0020773250439782482
Bond Position:  [5.67300233]


portfolio before change:  [5.89117137]
curr_Stock_Price:  104.68263905401429
curr_Factors:  [104.68263905  -1.57015776  -0.99509023]
mat_Sqrt:  [[ 8.05010628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.15612744e-02 -2.13101504e-04 -3.80007745e-01]
Stock Position:  -0.021561274366018082
Bond Position:  [8.14826247]


portfolio before change:  [5.88952573]
curr_Stock_Price:  104.80620473715939
curr_Factors:  [104.80620474  -1.39808732  -0.97260629]
mat_Sqrt:  [[ 9.79056697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00474381  0.01363336  0.21735191]
Stock Position:  -0.004743810625360957
Bond Position:  [6.38670652]


portfolio before change:  [5.8893622]
curr_Stock_Price:  105.00897845311127
curr_Factors:  [105.00897845  -1.09534382  -0.96872674]
mat_Sqrt:  [[13.32944232  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00977286 -0.05073869 -0.29061793]
Stock Position:  0.00977285672799198
Bond Position:  [4.86312449]


portfolio before change:  [5.88536973]
curr_Stock_Price:  104.53824614531551
curr_Factors:  [104.53824615  -1.29619888  -0.94459504]
mat_Sqrt:  [[11.12015328  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00062648 0.05977017 0.23206485]
Stock Position:  0.0006264833181448781
Bond Position:  [5.81987826]


portfolio before change:  [5.88636118]
curr_Stock_Price:  104.95951953870642
curr_Factors:  [104.95951954  -1.20819112  -0.92218906]
mat_Sqrt:  [[12.4683642   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00319608  0.01423075 -0.11137007]
Stock Position:  0.0031960750096918667
Bond Position:  [5.55090268]


portfolio before change:  [5.88984183]
curr_Stock_Price:  105.83144892070113
curr_Factors:  [105.83144892  -1.08305324  -0.92192279]
mat_Sqrt:  [[14.25163582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248075  0.02505078 -0.0252116 ]
Stock Position:  -0.0024807516395127663
Bond Position:  [6.15238337]


portfolio before change:  [5.89056815]
curr_Stock_Price:  105.84869362689089
curr_Factors:  [105.84869363  -1.2781774   -0.94140778]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.89056815]
Stock Price:  106.95167473178297
PL:  [-1.06110658]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-8.68246026e-02 -1.38023745e-02 -1.78305045e-03]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.17303472e-01 -4.37631155e-02 -1.01530461e-01]
 [-2.38633432e-04 -8.73499722e-03  8.66253011e-02]
 [-9.32295290e-01 -2.77232496e-01  2.98706884e-02]
 [-4.57172956e-02 -1.66757824e-02  6.44900948e-03]
 [ 3.07488631e-02 -1.26348068e-03 -2.70640045e-02]
 [ 3.66439950e-01  4.98696430e-02 -1.02870433e-01]
 [-3.42594855e-01  7.59003239e-04 -1.08920426e-01]
 [ 3.20495212e-02  8.78318644e-03 -2.91866311e-02]
 [ 1.06316839e-02 -2.50613164e-01  7.27747688e-02]
 [-5.57641203e-02  3.60352930e-03  3.78053737e-02]
 [ 2.09102268e-01 -1.60300911e-01  1.73031676e-01]
 [ 8.17154298e-02  2.81399435e-02 -1.54812408e-02]
 [ 2.73549056e-02 -6.83200122e-02 -3.37371929e-02]
 [-4.10255242e-02 -1.36628802e-02  2.13568372e-02]
 [-4.29136654e-01 -2.57692208e-01  1.12087419e-01]
 [-1.80633895e-01 -1.79804754e-03 -3.31202816e-02]
 [ 3.72431648e-01  1.42262404e+00  6.37533959e-01]
 [-1.21203821e-01 -1.39028696e-02  1.12687070e-01]
 [-9.18928860e-02  1.57693687e-01 -3.66047192e-02]
 [ 7.66629573e-02 -4.28116224e-03  4.50339900e-02]
 [-3.01551045e-02 -2.12898776e-02 -4.49778786e-02]
 [ 3.62854938e-02  1.27467736e-01  1.02460478e-01]
 [-7.79623816e-02 -6.34540047e-02 -5.96852397e-02]
 [ 1.10589253e-01 -5.81464865e-03 -8.48257058e-03]
 [-1.94384094e-03 -3.01383499e-02 -3.29931776e-02]
 [ 5.42684738e-03  4.18695592e-02 -5.48108379e-02]
 [-5.70567895e-01  2.94806891e-02 -7.84827498e-01]
 [-1.32082371e-01 -5.63250705e-02  6.17426482e-03]
 [-8.08935985e-02  9.18878329e-02  2.15281390e-01]
 [ 1.16355329e-02  3.95217390e-02  1.63785977e-02]
 [-1.22703551e-01 -8.05164981e-03 -1.45688109e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 2.31304714e-01 -1.73321354e-01 -6.98290499e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-1.16720619e-02 -1.55400500e-02 -4.47980482e-02]
 [-9.37797836e-02 -3.82835961e-03  8.41469452e-04]
 [-2.70849091e-02 -2.90588395e-01  1.21249168e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.72262317]
curr_Stock_Price:  100.18598669543752
curr_Factors:  [100.1859867   -1.06753438  -1.00466525]
mat_Sqrt:  [[12.61426973  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00694015 -0.00436469 -0.00508655]
Stock Position:  -0.0069401514262881
Bond Position:  [4.41792909]


portfolio before change:  [3.72065485]
curr_Stock_Price:  100.5491762841478
curr_Factors:  [100.54917628  -1.21782065  -1.0361609 ]
mat_Sqrt:  [[10.55569338  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0042992   0.01411938  0.0859571 ]
Stock Position:  -0.004299200556501865
Bond Position:  [4.15293593]


portfolio before change:  [3.72115936]
curr_Stock_Price:  100.55258321773496
curr_Factors:  [100.55258322  -1.18799739  -1.05848962]
mat_Sqrt:  [[10.63546106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01837708 -0.01383911 -0.28963815]
Stock Position:  0.018377077764023312
Bond Position:  [1.87329671]


portfolio before change:  [3.71786936]
curr_Stock_Price:  100.36081346541303
curr_Factors:  [100.36081347  -1.07399106  -1.06092367]
mat_Sqrt:  [[11.86813531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00145079 -0.00276225  0.24711787]
Stock Position:  0.0014507877606718769
Bond Position:  [3.57226712]


portfolio before change:  [3.7177973]
curr_Stock_Price:  100.00333155080256
curr_Factors:  [100.00333155  -1.3165115   -1.0688002 ]
mat_Sqrt:  [[ 9.2063347   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10138194 -0.08766861  0.08521276]
Stock Position:  -0.10138194016997133
Bond Position:  [13.85632907]


portfolio before change:  [3.67433079]
curr_Stock_Price:  100.4491571016393
curr_Factors:  [100.4491571   -1.38974911  -1.08498235]
mat_Sqrt:  [[ 8.45637197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0053015  -0.00527335  0.01839723]
Stock Position:  -0.005301500931961865
Bond Position:  [4.20686209]


portfolio before change:  [3.67848264]
curr_Stock_Price:  99.76520679164202
curr_Factors:  [99.76520679 -1.5524365  -1.05034344]
mat_Sqrt:  [[ 7.38934836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00340921 -0.00039955 -0.07720607]
Stock Position:  0.0034092077148781914
Bond Position:  [3.33836233]


portfolio before change:  [3.67881274]
curr_Stock_Price:  99.73962419377594
curr_Factors:  [99.73962419 -1.46466475 -1.02652824]
mat_Sqrt:  [[ 8.25954947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0419792   0.01577017 -0.29346071]
Stock Position:  0.041979195217282196
Bond Position:  [-0.50817641]


portfolio before change:  [3.67343826]
curr_Stock_Price:  99.61311004632171
curr_Factors:  [99.61311005 -1.45205473 -1.03466694]
mat_Sqrt:  [[ 8.28603945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.40268899e-02  2.40017899e-04 -3.10719657e-01]
Stock Position:  -0.04402688994690939
Bond Position:  [8.05909369]


portfolio before change:  [3.62519366]
curr_Stock_Price:  100.73179105421573
curr_Factors:  [100.73179105  -1.3121902   -1.0478644 ]
mat_Sqrt:  [[ 9.51059896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00276729  0.00277749 -0.08326133]
Stock Position:  0.0027672921656240823
Bond Position:  [3.34643936]


portfolio before change:  [3.62415004]
curr_Stock_Price:  100.20349269685978
curr_Factors:  [100.2034927   -1.13086582  -1.06075064]
mat_Sqrt:  [[11.196336    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169841 -0.07925084  0.20760616]
Stock Position:  0.0016984098471549863
Bond Position:  [3.45396344]


portfolio before change:  [3.62424953]
curr_Stock_Price:  100.00784952244054
curr_Factors:  [100.00784952  -1.21025283  -1.06238314]
mat_Sqrt:  [[10.30482992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465355  0.00113954  0.10784821]
Stock Position:  -0.004653554536418913
Bond Position:  [4.08964151]


portfolio before change:  [3.62572845]
curr_Stock_Price:  99.7999042129825
curr_Factors:  [99.79990421 -1.34979643 -1.04635934]
mat_Sqrt:  [[ 9.08851426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02643812 -0.0506916   0.49361121]
Stock Position:  0.026438123158652415
Bond Position:  [0.98720629]


portfolio before change:  [3.63244493]
curr_Stock_Price:  100.04928186532456
curr_Factors:  [100.04928187  -1.28491303  -1.03018511]
mat_Sqrt:  [[ 9.88051612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00802407  0.00889863 -0.04416367]
Stock Position:  0.008024065138916793
Bond Position:  [2.82964298]


portfolio before change:  [3.62469764]
curr_Stock_Price:  99.03969080274857
curr_Factors:  [99.0396908  -1.28170744 -1.00209007]
mat_Sqrt:  [[10.09179962  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185342 -0.02160468 -0.09624282]
Stock Position:  0.0018534171797018727
Bond Position:  [3.44113577]


portfolio before change:  [3.62513592]
curr_Stock_Price:  99.04406923493404
curr_Factors:  [99.04406923 -1.28707544 -1.0072679 ]
mat_Sqrt:  [[ 9.98637393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00370694 -0.00432058  0.06092511]
Stock Position:  -0.0037069363028715665
Bond Position:  [3.99228598]


portfolio before change:  [3.62584102]
curr_Stock_Price:  98.9884879103882
curr_Factors:  [98.98848791 -0.98483594 -0.99715147]
mat_Sqrt:  [[13.64012955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03027174 -0.08148943  0.31975421]
Stock Position:  -0.030271742489662183
Bond Position:  [6.62239504]


portfolio before change:  [3.62904524]
curr_Stock_Price:  98.90998677633308
curr_Factors:  [98.90998678 -1.23943333 -0.98490833]
mat_Sqrt:  [[10.69598624  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01752442 -0.00056859 -0.09448294]
Stock Position:  -0.017524421393426744
Bond Position:  [5.36238553]


portfolio before change:  [3.61934914]
curr_Stock_Price:  99.50152930203926
curr_Factors:  [99.5015293  -1.35929338 -0.97327974]
mat_Sqrt:  [[ 9.65619708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05585012 0.44987322 1.81870693]
Stock Position:  0.05585011504854561
Bond Position:  [-1.93782272]


portfolio before change:  [3.60640765]
curr_Stock_Price:  99.27414840948501
curr_Factors:  [99.27414841 -1.32898584 -0.9818605 ]
mat_Sqrt:  [[ 9.84573983  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01001049 -0.00439647  0.32146485]
Stock Position:  -0.010010485934968151
Bond Position:  [4.60019011]


portfolio before change:  [3.61096649]
curr_Stock_Price:  98.87618721317872
curr_Factors:  [98.87618721 -1.3960427  -0.97005154]
mat_Sqrt:  [[ 9.27918937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01026956  0.04986712 -0.10442308]
Stock Position:  -0.010269556505615667
Bond Position:  [4.62638108]


portfolio before change:  [3.61558358]
curr_Stock_Price:  98.48291239579453
curr_Factors:  [98.4829124  -1.56173085 -0.9773235 ]
mat_Sqrt:  [[ 7.77434105  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01102922 -0.00135382  0.12846944]
Stock Position:  0.01102922322631141
Bond Position:  [2.52939356]


portfolio before change:  [3.61779983]
curr_Stock_Price:  98.65518709331941
curr_Factors:  [98.65518709 -1.44215169 -0.97469528]
mat_Sqrt:  [[ 8.80028268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00453234 -0.00673245 -0.12830937]
Stock Position:  -0.004532340518595742
Bond Position:  [4.06493874]


portfolio before change:  [3.61406005]
curr_Stock_Price:  99.59243673539733
curr_Factors:  [99.59243674 -1.18464882 -1.00849767]
mat_Sqrt:  [[11.11104585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00544425 0.04030884 0.29229123]
Stock Position:  0.00544425384867167
Bond Position:  [3.07185354]


portfolio before change:  [3.61154263]
curr_Stock_Price:  99.05950262808571
curr_Factors:  [99.05950263 -1.11608743 -0.98413334]
mat_Sqrt:  [[12.12779509  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00756807 -0.02006592 -0.17026538]
Stock Position:  -0.007568066147892676
Bond Position:  [4.36123149]


portfolio before change:  [3.61037933]
curr_Stock_Price:  99.28525222254692
curr_Factors:  [99.28525222 -1.12099956 -0.98270908]
mat_Sqrt:  [[12.11311072  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00897438 -0.00183875 -0.02419841]
Stock Position:  0.00897437699229316
Bond Position:  [2.71935604]


portfolio before change:  [3.61654697]
curr_Stock_Price:  99.93462376807234
curr_Factors:  [99.93462377 -1.12736052 -0.97615021]
mat_Sqrt:  [[12.19474944  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00077547 -0.00953058 -0.09412035]
Stock Position:  -0.000775474232082309
Bond Position:  [3.6940437]


portfolio before change:  [3.6168252]
curr_Stock_Price:  100.17133203234397
curr_Factors:  [100.17133203  -1.24817439  -1.01359792]
mat_Sqrt:  [[10.43441771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044854  0.01324032 -0.15636006]
Stock Position:  -0.0004485445016624119
Bond Position:  [3.6617565]


portfolio before change:  [3.6170787]
curr_Stock_Price:  100.626679761191
curr_Factors:  [100.62667976  -1.44458591  -1.0210663 ]
mat_Sqrt:  [[ 8.54858034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08539534  0.00932261 -2.2388944 ]
Stock Position:  -0.08539534286262532
Bond Position:  [12.21012852]


portfolio before change:  [3.63684929]
curr_Stock_Price:  100.41303546739964
curr_Factors:  [100.41303547  -1.20609716  -1.0478006 ]
mat_Sqrt:  [[10.54228461  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01254722 -0.01781155  0.01761346]
Stock Position:  -0.012547219785146634
Bond Position:  [4.89675371]


portfolio before change:  [3.63283187]
curr_Stock_Price:  100.78200560084609
curr_Factors:  [100.7820056   -1.16054254  -1.02033701]
mat_Sqrt:  [[11.38253626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303772  0.02905748  0.61413788]
Stock Position:  -0.0030377179898061608
Bond Position:  [3.93897918]


portfolio before change:  [3.63428726]
curr_Stock_Price:  100.46499646384478
curr_Factors:  [100.46499646  -1.33758433  -1.01340016]
mat_Sqrt:  [[ 9.57183459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00167149 0.01249787 0.04672358]
Stock Position:  0.0016714922194725592
Bond Position:  [3.4663608]


portfolio before change:  [3.63426781]
curr_Stock_Price:  100.1941162977299
curr_Factors:  [100.1941163   -1.09659645  -1.01923725]
mat_Sqrt:  [[12.0766734   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01264006 -0.00254616 -0.41560762]
Stock Position:  -0.012640062322637442
Bond Position:  [4.90072768]


portfolio before change:  [3.63169389]
curr_Stock_Price:  100.44621567241876
curr_Factors:  [100.44621567  -1.28196136  -1.03338279]
mat_Sqrt:  [[ 9.91727577  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00528509  0.0049611   0.16678008]
Stock Position:  -0.0052850908648668015
Bond Position:  [4.16256126]


portfolio before change:  [3.62673994]
curr_Stock_Price:  101.48201567159934
curr_Factors:  [101.48201567  -1.18095497  -1.06013119]
mat_Sqrt:  [[10.7918955   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01969772 -0.05480902 -0.19920284]
Stock Position:  0.019697724152092505
Bond Position:  [1.62777519]


portfolio before change:  [3.61793404]
curr_Stock_Price:  101.02463350696537
curr_Factors:  [101.02463351  -1.0862964   -1.06991049]
mat_Sqrt:  [[11.69495431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00209594 0.00777784 0.21633947]
Stock Position:  0.0020959366755624598
Bond Position:  [3.4061928]


portfolio before change:  [3.6175357]
curr_Stock_Price:  100.6314266145498
curr_Factors:  [100.63142661  -0.89084269  -1.05290187]
mat_Sqrt:  [[14.4070842   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00147272 -0.0049142  -0.12779636]
Stock Position:  -0.0014727246156686757
Bond Position:  [3.76573808]


portfolio before change:  [3.61952366]
curr_Stock_Price:  99.60122115984251
curr_Factors:  [99.60122116 -0.77080384 -1.00550191]
mat_Sqrt:  [[16.85873078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00555836 -0.00121063  0.00240048]
Stock Position:  -0.005558358364604395
Bond Position:  [4.17314294]


portfolio before change:  [3.61648642]
curr_Stock_Price:  100.24150270670242
curr_Factors:  [100.24150271  -0.60387555  -1.01930018]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.61648642]
Stock Price:  99.56933723974163
PL:  [3.61648642]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-5.63850392e-02  3.42459049e-02  7.94760003e-03]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.71892453e-01  2.82341701e-01  3.86537717e-01]
 [-8.10179841e-03  9.76691392e-03  1.04225071e-01]
 [-8.74165125e-01 -2.60766447e-01  3.12912403e-02]
 [-6.67898827e-02  2.37446716e-02  6.77471313e-02]
 [ 3.17522506e-02  6.79929929e-02 -2.01838949e-03]
 [ 2.70659285e-01 -1.10634765e-01 -5.07343074e-02]
 [-5.29046000e-01 -2.68196192e-02 -7.57499852e-02]
 [ 4.90878687e-02 -2.01631342e-02 -4.27507043e-02]
 [ 2.90556652e-02 -3.21654492e-01  1.41499212e-01]
 [ 1.53032274e-02 -4.20673665e-03  1.31020587e-03]
 [ 2.21683435e-01 -2.23594106e-01  7.81050277e-02]
 [ 9.65907830e-02 -6.30819240e-02 -4.39296381e-02]
 [-1.73506904e-01  2.63235581e-01  1.93053921e-01]
 [ 6.52886090e-02 -4.44300890e-01 -1.20752842e-01]
 [-2.04215121e-01 -2.81537757e-01  2.94160129e-02]
 [-2.03879195e-01 -1.02918721e-01 -3.02976612e-02]
 [ 2.31362189e-01  1.10246571e+00  2.11796424e-01]
 [-2.70940416e-01 -4.41150079e-02  1.99982783e-01]
 [-9.12612487e-02  3.43978808e-01 -2.35227332e-02]
 [-3.79348156e-02  2.37049445e-02 -7.90778912e-03]
 [ 1.78910697e-02 -3.26210651e-02  1.29572926e-02]
 [ 3.65510672e-02  1.81808498e-01  1.20167895e-01]
 [-7.99069859e-02 -1.17940285e-01  4.37895436e-02]
 [ 1.21754374e-01 -2.05976214e-02 -2.55965385e-03]
 [ 3.44552437e-02 -6.63745297e-02  1.05602836e-01]
 [-3.50056863e-02  4.31130665e-02  3.88623474e-02]
 [-6.36761052e-01 -4.66000191e-02 -9.52775634e-01]
 [ 2.33085728e-01 -1.56669164e-01 -1.68015384e-01]
 [ 1.33969334e-01  1.65441582e-02 -3.04647562e-02]
 [ 4.50689240e-02  2.69602684e-01 -9.41768087e-02]
 [-6.02177143e-02  4.88235736e-03 -1.13587451e-01]
 [-7.80802550e-03  1.39363476e-01  9.45975778e-02]
 [-2.73509806e-01  9.85011607e-02 -7.42025258e-03]
 [-1.74277652e-01 -1.02807859e-01 -7.25873744e-03]
 [ 3.32730753e-01  2.49035234e-01  9.41047755e-02]
 [-1.16582278e-02  2.97144267e-01  5.44237885e-02]
 [ 4.92687215e-04 -1.44175845e-01  3.57150378e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.56009767]
curr_Stock_Price:  100.99932181824039
curr_Factors:  [100.99932182  -1.11062443  -1.01170223]
mat_Sqrt:  [[12.09493946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445463  0.01082951  0.02267229]
Stock Position:  -0.004454633015303523
Bond Position:  [10.01001258]


portfolio before change:  [9.56454738]
curr_Stock_Price:  100.28133236007591
curr_Factors:  [100.28133236  -1.00825307  -1.0009805 ]
mat_Sqrt:  [[13.44686504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337484  0.01411938  0.0859571 ]
Stock Position:  -0.003374841847157615
Bond Position:  [9.90298102]


portfolio before change:  [9.56815201]
curr_Stock_Price:  99.58006194886056
curr_Factors:  [99.58006195 -0.81699485 -0.99435322]
mat_Sqrt:  [[16.27473468  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02200246 0.08928429 1.10268451]
Stock Position:  0.022002457927527624
Bond Position:  [7.37714588]


portfolio before change:  [9.58636554]
curr_Stock_Price:  100.36594383427895
curr_Factors:  [100.36594383  -0.87192077  -0.98757427]
mat_Sqrt:  [[15.63212212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00085882 0.00308857 0.29732512]
Stock Position:  0.0008588236193479547
Bond Position:  [9.5001689]


portfolio before change:  [9.58799497]
curr_Stock_Price:  100.88040406407227
curr_Factors:  [100.88040406  -1.01656428  -0.98342236]
mat_Sqrt:  [[13.65286038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0640533  -0.08246159  0.0892652 ]
Stock Position:  -0.06405330193936257
Bond Position:  [16.04971795]


portfolio before change:  [9.54309212]
curr_Stock_Price:  101.61275011235423
curr_Factors:  [101.61275011  -0.92541924  -1.01300691]
mat_Sqrt:  [[14.62515321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357931  0.00750872  0.19326371]
Stock Position:  -0.00357931106179177
Bond Position:  [9.90679576]


portfolio before change:  [9.54759998]
curr_Stock_Price:  100.69932519545652
curr_Factors:  [100.6993252   -0.78713524  -0.98786972]
mat_Sqrt:  [[17.06678438  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193919  0.02150127 -0.0057579 ]
Stock Position:  0.001939194831755816
Bond Position:  [9.35232437]


portfolio before change:  [9.54984035]
curr_Stock_Price:  101.25174788506038
curr_Factors:  [101.25174789  -0.72289448  -0.95691225]
mat_Sqrt:  [[18.87433838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01364003 -0.03498578 -0.14473086]
Stock Position:  0.013640033646443601
Bond Position:  [8.1687631]


portfolio before change:  [9.57045972]
curr_Stock_Price:  102.68856319113677
curr_Factors:  [102.68856319  -0.65346205  -0.96304814]
mat_Sqrt:  [[20.3929766   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02673474 -0.00848111 -0.21609362]
Stock Position:  -0.026734737728928606
Bond Position:  [12.31581152]


portfolio before change:  [9.60560147]
curr_Stock_Price:  101.43168986605478
curr_Factors:  [101.43168987  -0.45835922  -0.96687023]
mat_Sqrt:  [[24.38958298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00163352 -0.00637614 -0.12195586]
Stock Position:  0.0016335173867954866
Bond Position:  [9.43991104]


portfolio before change:  [9.60623194]
curr_Stock_Price:  101.09523986775496
curr_Factors:  [101.09523987  -0.64440031  -0.92838895]
mat_Sqrt:  [[20.97379471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00236648 -0.10171608  0.40365787]
Stock Position:  0.0023664762805531456
Bond Position:  [9.36699245]


portfolio before change:  [9.60388176]
curr_Stock_Price:  99.6073213516913
curr_Factors:  [99.60732135 -0.56936778 -0.94756191]
mat_Sqrt:  [[21.85229567  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00070757 -0.00133029  0.00373765]
Stock Position:  0.0007075711774432416
Bond Position:  [9.53340249]


portfolio before change:  [9.60417999]
curr_Stock_Price:  98.3445155495216
curr_Factors:  [98.34451555 -0.68898596 -0.93915451]
mat_Sqrt:  [[19.30446287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01201035 -0.07070666  0.2228119 ]
Stock Position:  0.012010351380494126
Bond Position:  [8.4230278]


portfolio before change:  [9.60132815]
curr_Stock_Price:  98.01939806557432
curr_Factors:  [98.01939807 -0.63595749 -0.94308189]
mat_Sqrt:  [[20.20895895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00425529 -0.01994826 -0.12531903]
Stock Position:  0.004255286733679711
Bond Position:  [9.18422751]


portfolio before change:  [9.5959925]
curr_Stock_Price:  96.49570390752983
curr_Factors:  [96.49570391 -0.6005972  -0.9285653 ]
mat_Sqrt:  [[20.91226836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00608749  0.0832424   0.5507291 ]
Stock Position:  -0.006087489976614714
Bond Position:  [10.18340913]


portfolio before change:  [9.59730734]
curr_Stock_Price:  96.48883235944132
curr_Factors:  [96.48883236 -0.28725162 -0.93655691]
mat_Sqrt:  [[28.37812904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00102784 -0.14050028 -0.34447425]
Stock Position:  0.0010278422010890275
Bond Position:  [9.49813204]


portfolio before change:  [9.59932364]
curr_Stock_Price:  97.29533904005929
curr_Factors:  [97.29533904 -0.52705783 -0.9254723 ]
mat_Sqrt:  [[22.76492442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00902616 -0.08903006  0.0839157 ]
Stock Position:  -0.00902616112320832
Bond Position:  [10.47752704]


portfolio before change:  [9.57806132]
curr_Stock_Price:  99.7960803703137
curr_Factors:  [99.79608037 -0.38588581 -0.96819874]
mat_Sqrt:  [[25.76570534  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00825598 -0.03254576 -0.08643079]
Stock Position:  -0.008255975391666235
Bond Position:  [10.4019753]


portfolio before change:  [9.59550954]
curr_Stock_Price:  97.84017590935963
curr_Factors:  [97.84017591 -0.31488495 -0.94283728]
mat_Sqrt:  [[27.81604624  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01089517 0.34863027 0.60419625]
Stock Position:  0.010895167934953442
Bond Position:  [8.5295244]


portfolio before change:  [9.60324218]
curr_Stock_Price:  98.45204115966781
curr_Factors:  [98.45204116 -0.46690159 -0.90797785]
mat_Sqrt:  [[24.89557563  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00928913 -0.01395039  0.57049521]
Stock Position:  -0.009289126291016104
Bond Position:  [10.51777562]


portfolio before change:  [9.59226684]
curr_Stock_Price:  99.77510864699966
curr_Factors:  [99.77510865 -0.33447216 -0.88956534]
mat_Sqrt:  [[29.33793053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297162  0.10877565 -0.06710381]
Stock Position:  -0.0029716244561070132
Bond Position:  [9.88876099]


portfolio before change:  [9.5964752]
curr_Stock_Price:  98.7749175412007
curr_Factors:  [98.77491754 -0.2301345  -0.89269595]
mat_Sqrt:  [[32.13716831  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121159  0.00749616 -0.02255872]
Stock Position:  -0.0012115855049136014
Bond Position:  [9.71614946]


portfolio before change:  [9.5975863]
curr_Stock_Price:  98.86034400859117
curr_Factors:  [98.86034401 -0.12469246 -0.88045312]
mat_Sqrt:  [[36.18203074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00054429 -0.01031569  0.03696355]
Stock Position:  0.0005442948683525152
Bond Position:  [9.54377712]


portfolio before change:  [9.5987008]
curr_Stock_Price:  98.71603371086259
curr_Factors:  [98.71603371 -0.43740287 -0.90889074]
mat_Sqrt:  [[25.68619725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00256069 0.0574929  0.34280556]
Stock Position:  0.002560694780042007
Bond Position:  [9.34591916]


portfolio before change:  [9.60136007]
curr_Stock_Price:  99.2982822528859
curr_Factors:  [99.29828225 -0.3109115  -0.91219467]
mat_Sqrt:  [[29.22492966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253255 -0.03729599  0.12491938]
Stock Position:  -0.0025325531548900542
Bond Position:  [9.85283825]


portfolio before change:  [9.60457549]
curr_Stock_Price:  98.51498702316243
curr_Factors:  [98.51498702 -0.21345711 -0.92208548]
mat_Sqrt:  [[31.64771976  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00381386 -0.00651354 -0.00730198]
Stock Position:  0.0038138627342421626
Bond Position:  [9.22885285]


portfolio before change:  [9.60345714]
curr_Stock_Price:  97.91925756313042
curr_Factors:  [97.91925756 -0.3509489  -0.90224293]
mat_Sqrt:  [[27.96493494  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194163 -0.02098947  0.3012555 ]
Stock Position:  0.0019416297367100628
Bond Position:  [9.41333419]


portfolio before change:  [9.60411085]
curr_Stock_Price:  97.64988356374512
curr_Factors:  [97.64988356 -0.37930854 -0.89189672]
mat_Sqrt:  [[27.39014311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094778  0.01363355  0.11086346]
Stock Position:  -0.0009477777524537779
Bond Position:  [9.69666124]


portfolio before change:  [9.60574672]
curr_Stock_Price:  97.2028278392154
curr_Factors:  [97.20282784 -0.28017452 -0.87005641]
mat_Sqrt:  [[30.77088269  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02705313 -0.01473622 -2.71800368]
Stock Position:  -0.027053132652604398
Bond Position:  [12.23538772]


portfolio before change:  [9.67060681]
curr_Stock_Price:  94.86185777545349
curr_Factors:  [94.86185778 -0.34319511 -0.86797005]
mat_Sqrt:  [[28.25460749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00689249 -0.04954314 -0.47930112]
Stock Position:  0.006892488262737351
Bond Position:  [9.01677257]


portfolio before change:  [9.65973898]
curr_Stock_Price:  93.12155801655264
curr_Factors:  [93.12155802 -0.16466157 -0.8688101 ]
mat_Sqrt:  [[33.12982879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00386896  0.00523172 -0.08690747]
Stock Position:  0.003868957816864653
Bond Position:  [9.2994556]


portfolio before change:  [9.66456736]
curr_Stock_Price:  94.06906662807228
curr_Factors:  [ 9.40690666e+01  4.18340838e-02 -8.94623562e-01]
mat_Sqrt:  [[40.09452476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00081822  0.08525585 -0.26866022]
Stock Position:  0.0008182233101106586
Bond Position:  [9.58759786]


portfolio before change:  [9.6684937]
curr_Stock_Price:  97.40289647917295
curr_Factors:  [97.40289648 -0.10078571 -0.91775301]
mat_Sqrt:  [[35.17435351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236757  0.00154394 -0.32403338]
Stock Position:  -0.002367565722763083
Bond Position:  [9.89910146]


portfolio before change:  [9.68007517]
curr_Stock_Price:  93.03385100793328
curr_Factors:  [ 9.30338510e+01 -3.13614701e-02 -9.02703348e-01]
mat_Sqrt:  [[36.55794729  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00041304 0.0440706  0.26986056]
Stock Position:  0.0004130421642587187
Bond Position:  [9.64164827]


portfolio before change:  [9.68168588]
curr_Stock_Price:  94.01541137476073
curr_Factors:  [94.01541137  0.1510084  -0.89298826]
mat_Sqrt:  [[44.76734029  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00608661  0.0311488  -0.02116792]
Stock Position:  -0.0060866061668766475
Bond Position:  [10.25392066]


portfolio before change:  [9.68652078]
curr_Stock_Price:  93.43165745903079
curr_Factors:  [93.43165746  0.17324508 -0.8915152 ]
mat_Sqrt:  [[45.55680969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391629 -0.0325107  -0.02070716]
Stock Position:  -0.003916293185595964
Bond Position:  [10.05242654]


portfolio before change:  [9.70003551]
curr_Stock_Price:  90.30163094339257
curr_Factors:  [90.30163094  0.16758055 -0.89317109]
mat_Sqrt:  [[43.70947832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00819891 0.07875186 0.26845473]
Stock Position:  0.008198905269953103
Bond Position:  [8.95966099]


portfolio before change:  [9.69589479]
curr_Stock_Price:  89.6599910647556
curr_Factors:  [89.65999106  0.1540426  -0.88932566]
mat_Sqrt:  [[42.9802874   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00016573 0.09396527 0.15525592]
Stock Position:  0.0001657321045291516
Bond Position:  [9.68103525]


portfolio before change:  [9.69726951]
curr_Stock_Price:  90.652639016504
curr_Factors:  [ 9.06526390e+01  3.52494835e-02 -8.92467188e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.69726951]
Stock Price:  90.99851214864526
PL:  [9.69726951]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [ 2.22670937e-01 -1.36172922e-01  3.13174791e-01]
 [-1.02003386e-01  2.81181887e-02  1.27023574e-01]
 [ 2.06183956e-01  2.90830911e-01  4.38883699e-01]
 [-8.47236120e-02 -3.56500670e-02  7.01217787e-02]
 [-5.37394978e-01 -1.65372364e-01  3.95210375e-02]
 [ 7.05852561e-03 -1.17907901e-01 -1.47070760e-01]
 [ 3.39294022e-02 -3.50155378e-02 -2.90646556e-02]
 [ 3.29340752e-01 -1.62103299e-02 -8.22849320e-02]
 [-4.24313487e-01 -1.64749519e-02 -7.27119879e-02]
 [ 4.73622682e-02 -1.72315244e-02 -4.13769695e-02]
 [ 2.08054686e-02 -2.19859622e-01  2.52162637e-02]
 [ 6.01227400e-03 -3.23920981e-03  5.99825951e-03]
 [ 2.49391506e-01 -2.40949725e-01  7.37039031e-02]
 [ 9.27289570e-02 -4.98791614e-02 -6.29659278e-02]
 [-1.37490100e-02 -2.45831743e-02 -1.83776967e-04]
 [-3.79504497e-02 -2.23740437e-02  1.78789000e-02]
 [-4.51575509e-01 -2.67430520e-01  1.21631114e-01]
 [-1.70286069e-01  1.93047833e-03 -3.12769687e-02]
 [ 3.63883107e-01  1.41880464e+00  6.05857657e-01]
 [-2.29124642e-02  9.68662634e-04  5.41327293e-02]
 [-8.82719261e-02  7.06362862e-02 -4.00477510e-02]
 [ 4.09974764e-02  9.77200747e-03  2.59999359e-02]
 [ 1.70016059e-02 -2.80410955e-02  1.02829715e-02]
 [ 2.97591867e-02  1.15777954e-01  1.10995275e-01]
 [-7.39731748e-02 -9.26906745e-02 -5.41785131e-02]
 [ 6.68369864e-02  2.98257341e-02 -1.36527452e-02]
 [-8.78147852e-03 -1.52934649e-02 -4.02502006e-02]
 [ 3.41548764e-02  5.05673700e-02 -8.46451340e-02]
 [-6.39587118e-01 -6.36601105e-02 -9.73544944e-01]
 [-2.42541221e-01  7.27979334e-02  6.52333501e-03]
 [-4.75085236e-02  6.23102583e-02  1.64795839e-01]
 [ 1.24008303e-02  4.48091094e-02  1.38372766e-02]
 [-1.22895444e-01 -8.16097134e-03 -1.45561358e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 2.06867083e-01 -1.61744051e-01 -6.68869116e-02]
 [ 1.29223309e-02  2.64991971e-02  6.55074630e-02]
 [-2.65877493e-02 -3.11352974e-02 -4.63804074e-02]
 [-9.35530837e-02 -3.14897717e-03  7.80828730e-04]
 [-4.18859485e-02 -2.72207013e-01  1.34594487e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.31869723]
curr_Stock_Price:  98.78692986750201
curr_Factors:  [98.78692987 -1.13268598 -0.99478156]
mat_Sqrt:  [[11.76933899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02405246 -0.04306166  0.89340051]
Stock Position:  0.02405245560745503
Bond Position:  [-8.69476548]


portfolio before change:  [-6.31894324]
curr_Stock_Price:  98.82189120759573
curr_Factors:  [98.82189121 -1.28853369 -1.00925043]
mat_Sqrt:  [[ 9.92974728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00758819  0.00889175  0.3623629 ]
Stock Position:  -0.007588188994815545
Bond Position:  [-5.56906405]


portfolio before change:  [-6.31785526]
curr_Stock_Price:  98.58676877844009
curr_Factors:  [98.58676878 -0.94170916 -1.02832636]
mat_Sqrt:  [[13.74811245  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02205975 0.09196881 1.25201303]
Stock Position:  0.022059751031665326
Bond Position:  [-8.49265484]


portfolio before change:  [-6.32217624]
curr_Stock_Price:  98.43901886612217
curr_Factors:  [98.43901887 -1.21421169 -1.00882822]
mat_Sqrt:  [[10.65892263  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0066921  -0.01127354  0.20003792]
Stock Position:  -0.0066920970399414964
Bond Position:  [-5.66341277]


portfolio before change:  [-6.32487663]
curr_Stock_Price:  98.73674588535256
curr_Factors:  [98.73674589 -1.10016437 -1.01322416]
mat_Sqrt:  [[11.93014804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04472683 -0.05229533  0.11274252]
Stock Position:  -0.044726827743098316
Bond Position:  [-1.9086952]


portfolio before change:  [-6.34112395]
curr_Stock_Price:  99.09466801208949
curr_Factors:  [99.09466801 -1.10535755 -1.01477496]
mat_Sqrt:  [[11.89291832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218672 -0.03728575 -0.41955194]
Stock Position:  -0.002186724551623754
Bond Position:  [-6.12443121]


portfolio before change:  [-6.34295793]
curr_Stock_Price:  99.58324539134755
curr_Factors:  [99.58324539 -1.02121427 -1.00834443]
mat_Sqrt:  [[13.08459036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00207057 -0.01107289 -0.08291337]
Stock Position:  0.0020705659270833796
Bond Position:  [-6.54915161]


portfolio before change:  [-6.34233983]
curr_Stock_Price:  100.27716022614358
curr_Factors:  [100.27716023  -1.18452321  -1.01061072]
mat_Sqrt:  [[11.16522485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02795518 -0.00512616 -0.23473601]
Stock Position:  0.027955179236243882
Bond Position:  [-9.14560582]


portfolio before change:  [-6.3488753]
curr_Stock_Price:  100.0842732164296
curr_Factors:  [100.08427322  -1.31696333  -1.00201959]
mat_Sqrt:  [[ 9.84564914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04464725 -0.00520984 -0.20742706]
Stock Position:  -0.04464724818345177
Bond Position:  [-1.88038791]


portfolio before change:  [-6.33320384]
curr_Stock_Price:  99.72800212163565
curr_Factors:  [99.72800212 -1.15034905 -0.97871263]
mat_Sqrt:  [[11.86253154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00324309 -0.00544909 -0.11803698]
Stock Position:  0.003243094739287942
Bond Position:  [-6.65663119]


portfolio before change:  [-6.33485451]
curr_Stock_Price:  99.4756050139785
curr_Factors:  [99.47560501 -1.3904878  -0.98875828]
mat_Sqrt:  [[ 9.21346828  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00220069 -0.06952572  0.07193498]
Stock Position:  0.0022006876500590645
Bond Position:  [-6.55376925]


portfolio before change:  [-6.33641441]
curr_Stock_Price:  99.13906125434521
curr_Factors:  [99.13906125 -1.31263986 -0.97389846]
mat_Sqrt:  [[10.07427563  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071003 -0.00102433  0.01711136]
Stock Position:  0.0007100289709778847
Bond Position:  [-6.40680602]


portfolio before change:  [-6.33760549]
curr_Stock_Price:  98.58954666994185
curr_Factors:  [98.58954667 -1.28534364 -0.99905753]
mat_Sqrt:  [[10.03986899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02571896 -0.07619499  0.21025672]
Stock Position:  0.025718956860469502
Bond Position:  [-8.87322578]


portfolio before change:  [-6.32819149]
curr_Stock_Price:  98.998708486378
curr_Factors:  [98.99870849 -1.37634454 -1.00617206]
mat_Sqrt:  [[ 9.13935858  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00859888 -0.01577318 -0.17962427]
Stock Position:  0.008598876574713313
Bond Position:  [-7.17946917]


portfolio before change:  [-6.33074508]
curr_Stock_Price:  98.80611401292983
curr_Factors:  [98.80611401 -1.09481986 -1.01525093]
mat_Sqrt:  [[11.97820446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120396 -0.00777388 -0.00052426]
Stock Position:  -0.0012039582584399047
Bond Position:  [-6.21178664]


portfolio before change:  [-6.33201249]
curr_Stock_Price:  99.2138432521802
curr_Factors:  [99.21384325 -1.12126029 -1.01466885]
mat_Sqrt:  [[11.72060515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297584 -0.00707529  0.05100353]
Stock Position:  -0.002975838650829806
Bond Position:  [-6.0367681]


portfolio before change:  [-6.33194687]
curr_Stock_Price:  98.93820080425816
curr_Factors:  [98.9382008  -1.15219391 -0.97839412]
mat_Sqrt:  [[11.75063632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03690461 -0.08456896  0.34697971]
Stock Position:  -0.03690461320243828
Bond Position:  [-2.68067083]


portfolio before change:  [-6.33872093]
curr_Stock_Price:  99.11267646562189
curr_Factors:  [99.11267647 -1.29307607 -0.9879381 ]
mat_Sqrt:  [[10.12738544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0174399   0.00061047 -0.08922449]
Stock Position:  -0.017439901926127266
Bond Position:  [-4.61020557]


portfolio before change:  [-6.34654204]
curr_Stock_Price:  99.52809175110679
curr_Factors:  [99.52809175 -1.25193321 -1.01696349]
mat_Sqrt:  [[10.29381501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05092249 0.44866542 1.72834326]
Stock Position:  0.05092248706818984
Bond Position:  [-11.41476001]


portfolio before change:  [-6.31126511]
curr_Stock_Price:  100.2488708896219
curr_Factors:  [100.24887089  -1.23514108  -1.03018899]
mat_Sqrt:  [[10.40540863  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113764  0.00030632  0.15442561]
Stock Position:  -0.0011376445408743487
Bond Position:  [-6.19721753]


portfolio before change:  [-6.31170683]
curr_Stock_Price:  99.95617405817742
curr_Factors:  [99.95617406 -1.34504772 -1.04586695]
mat_Sqrt:  [[ 9.15057906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01034064  0.02233715 -0.11424509]
Stock Position:  -0.010340637172429513
Bond Position:  [-5.2780963]


portfolio before change:  [-6.3041849]
curr_Stock_Price:  99.16495292356191
curr_Factors:  [99.16495292 -1.41058539 -1.06777621]
mat_Sqrt:  [[ 8.31801012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00559713 0.00309018 0.07417058]
Stock Position:  0.005597132309014386
Bond Position:  [-6.85922426]


portfolio before change:  [-6.30226968]
curr_Stock_Price:  99.66032713922039
curr_Factors:  [99.66032714 -1.45200663 -1.0565157 ]
mat_Sqrt:  [[ 8.11119613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00226558 -0.00886737  0.02933446]
Stock Position:  0.002265583326072476
Bond Position:  [-6.52805845]


portfolio before change:  [-6.3045248]
curr_Stock_Price:  99.02514361821738
curr_Factors:  [99.02514362 -1.13194037 -1.05962629]
mat_Sqrt:  [[11.06522314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00500716 0.0366122  0.31663862]
Stock Position:  0.00500716302457165
Bond Position:  [-6.80035984]


portfolio before change:  [-6.30407453]
curr_Stock_Price:  99.28484430157748
curr_Factors:  [99.2848443  -1.13018445 -1.0722463 ]
mat_Sqrt:  [[10.97436594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00796634 -0.02931136 -0.15455622]
Stock Position:  -0.00796634455646647
Bond Position:  [-5.51313725]


portfolio before change:  [-6.31245625]
curr_Stock_Price:  100.25047305974962
curr_Factors:  [100.25047306  -0.93335263  -1.07523129]
mat_Sqrt:  [[13.45146291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00481882  0.00943173 -0.03894748]
Stock Position:  0.004818823720373917
Bond Position:  [-6.79554561]


portfolio before change:  [-6.30980891]
curr_Stock_Price:  100.97613413077912
curr_Factors:  [100.97613413  -1.06574623  -1.06504538]
mat_Sqrt:  [[11.99023515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00145055 -0.00483622 -0.11482262]
Stock Position:  -0.0014505463541034727
Bond Position:  [-6.16333835]


portfolio before change:  [-6.31247248]
curr_Stock_Price:  102.28123089472649
curr_Factors:  [102.28123089  -1.039652    -1.0375055 ]
mat_Sqrt:  [[12.81438909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141891  0.01599081 -0.24146901]
Stock Position:  0.0014189053032008436
Bond Position:  [-6.45759986]


portfolio before change:  [-6.31453839]
curr_Stock_Price:  101.39416912275888
curr_Factors:  [101.39416912  -0.90726816  -1.02144633]
mat_Sqrt:  [[14.73611225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05699976 -0.02013109 -2.77725274]
Stock Position:  -0.05699975882808624
Bond Position:  [-0.5350952]


portfolio before change:  [-6.35635536]
curr_Stock_Price:  102.12662971202472
curr_Factors:  [102.12662971  -1.14132266  -1.01252162]
mat_Sqrt:  [[11.85049022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02019579  0.02302073  0.01860926]
Stock Position:  -0.02019579038677767
Bond Position:  [-4.29382735]


portfolio before change:  [-6.34791653]
curr_Stock_Price:  101.68220118880119
curr_Factors:  [101.68220119  -1.17944017  -1.02791459]
mat_Sqrt:  [[11.18414906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109627  0.01970423  0.47011666]
Stock Position:  -0.0010962720457800537
Bond Position:  [-6.23644518]


portfolio before change:  [-6.34779407]
curr_Stock_Price:  100.85935252517558
curr_Factors:  [100.85935253  -1.07511008  -1.02016496]
mat_Sqrt:  [[12.40937163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00132016 0.01416988 0.0394739 ]
Stock Position:  0.0013201569938621714
Bond Position:  [-6.48094425]


portfolio before change:  [-6.34864794]
curr_Stock_Price:  100.82625275164017
curr_Factors:  [100.82625275  -1.14661899  -1.02113061]
mat_Sqrt:  [[11.53803728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01324478 -0.00258073 -0.41524604]
Stock Position:  -0.013244778451821206
Bond Position:  [-5.01322656]


portfolio before change:  [-6.34548299]
curr_Stock_Price:  100.53997850355188
curr_Factors:  [100.5399785   -1.19749912  -1.00311062]
mat_Sqrt:  [[11.13335658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00470781  0.0049611   0.16678008]
Stock Position:  -0.004707807853163872
Bond Position:  [-5.87216009]


portfolio before change:  [-6.3465927]
curr_Stock_Price:  100.61976943730295
curr_Factors:  [100.61976944  -1.1191135   -1.01142587]
mat_Sqrt:  [[11.95093333  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01581781 -0.05114796 -0.19080974]
Stock Position:  0.015817813647682945
Bond Position:  [-7.93817746]


portfolio before change:  [-6.35848919]
curr_Stock_Price:  99.93040981723172
curr_Factors:  [99.93040982 -1.32533624 -1.00856657]
mat_Sqrt:  [[ 9.68493159  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00278558 0.00837978 0.18687456]
Stock Position:  0.002785584165089443
Bond Position:  [-6.63685376]


portfolio before change:  [-6.3563758]
curr_Stock_Price:  100.98694112250264
curr_Factors:  [100.98694112  -1.30678457  -1.00206137]
mat_Sqrt:  [[10.03566531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036728  -0.00984585 -0.13231039]
Stock Position:  -0.003672802862269518
Bond Position:  [-5.98547067]


portfolio before change:  [-6.35651508]
curr_Stock_Price:  100.82114256409896
curr_Factors:  [100.82114256  -1.12545427  -0.99436971]
mat_Sqrt:  [[12.10385628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00772275 -0.00099579  0.00222749]
Stock Position:  -0.007722745694931467
Bond Position:  [-5.57789904]


portfolio before change:  [-6.36294586]
curr_Stock_Price:  101.56355920293726
curr_Factors:  [101.5635592   -1.25574354  -0.99592995]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.36294586]
Stock Price:  100.94050766598266
PL:  [-7.30345352]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.28198886e-01  1.70301715e-01  1.80717816e-01]
 [-7.78971621e-02  5.06973815e-02  5.58384349e-02]
 [ 1.79309863e-01  2.18455356e-01  3.48457318e-01]
 [-2.01903784e-02 -5.33429849e-02  9.24171742e-02]
 [-3.17025110e-01 -1.02950021e-01  4.49063110e-02]
 [ 6.00400826e-02 -2.04016171e-01 -2.75724769e-01]
 [ 1.72379185e-02 -3.19881322e-01 -4.91215915e-02]
 [ 9.70937874e-02  2.92846397e-01 -2.57367466e-02]
 [-1.44263147e-01  6.14880223e-03 -4.33780507e-02]
 [ 1.51173128e-01  6.46233196e-02  3.61782248e-01]
 [ 6.64475963e-02 -3.67251323e-01  8.69707562e-02]
 [-9.68890395e-03 -3.62084840e-02 -7.61544729e-02]
 [ 1.99357061e-01 -2.44103390e-01 -1.34564193e-03]
 [-8.64349477e-02 -1.93978802e-01 -1.41915394e-01]
 [-2.22782572e-01  3.82326167e-01  2.73917296e-01]
 [ 9.23981629e-02 -5.47014531e-01 -1.55373574e-01]
 [ 1.50693238e-01 -2.06134324e-01 -1.13123395e-01]
 [-2.61895776e-01 -1.28663283e-01 -4.22344522e-02]
 [ 2.39425145e-01  1.11101055e+00  2.16754111e-01]
 [-2.26747912e-01 -3.29226364e-02  1.77088766e-01]
 [-9.45320054e-02  2.43300549e-01 -3.25906293e-02]
 [ 2.24433105e-03  8.50814234e-03  1.57610984e-02]
 [-7.97336228e-02 -5.77671873e-03 -9.05816377e-02]
 [ 1.05321771e-02  3.11694482e-02  1.19323429e-01]
 [-1.10581301e-01  9.72798617e-02  2.79489358e-02]
 [ 1.11921716e-01 -7.57615815e-02 -6.33761457e-02]
 [ 3.63069088e-02 -6.55399143e-02  1.15200408e-01]
 [-1.19887974e-01  4.28657169e-02  1.17280508e-01]
 [-4.39478723e-01 -1.45395933e-02 -6.43910906e-01]
 [ 1.86576824e-01 -1.21416204e-01 -1.53927494e-01]
 [ 1.34489777e-01  6.04230089e-03 -3.75878948e-02]
 [ 3.23248290e-02  1.72277881e-01 -4.70849900e-02]
 [-1.18825010e-01  1.53854513e-02 -1.74911972e-01]
 [-3.99479770e-02  1.48061457e-01  9.49540180e-02]
 [-1.64954066e-01  9.19436704e-02  1.01339010e-01]
 [-1.52708921e-01 -8.82741461e-02 -9.96593754e-03]
 [ 2.34579166e-01  1.88278258e-01  6.96462938e-02]
 [-8.73490224e-02  2.90200803e-01  3.52589404e-02]
 [ 5.56455526e-04 -1.48086232e-01  3.75625688e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.41693751]
curr_Stock_Price:  99.46989188166026
curr_Factors:  [99.46989188 -1.09368043 -1.01197054]
mat_Sqrt:  [[12.11208889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00717571  0.05385413  0.51553763]
Stock Position:  -0.007175710601182703
Bond Position:  [-0.70317035]


portfolio before change:  [-1.41219081]
curr_Stock_Price:  98.79614569453321
curr_Factors:  [98.79614569 -0.86726745 -1.03423523]
mat_Sqrt:  [[14.75461501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00441829  0.01603192  0.15929151]
Stock Position:  -0.004418291399516084
Bond Position:  [-0.97568065]


portfolio before change:  [-1.40679109]
curr_Stock_Price:  97.54641207158363
curr_Factors:  [97.54641207 -0.87684637 -1.02570802]
mat_Sqrt:  [[14.55266135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01759671 0.06908165 0.99405174]
Stock Position:  0.01759670636941878
Bond Position:  [-3.12328666]


portfolio before change:  [-1.40145882]
curr_Stock_Price:  97.87162616752326
curr_Factors:  [97.87162617 -0.72870654 -1.03726825]
mat_Sqrt:  [[16.73800518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.61495447e-04 -1.68685330e-02  2.63640474e-01]
Stock Position:  -0.00016149544694574666
Bond Position:  [-1.385653]


portfolio before change:  [-1.4018129]
curr_Stock_Price:  98.99150646126914
curr_Factors:  [98.99150646 -0.73247685 -1.04023199]
mat_Sqrt:  [[16.81590571  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01846566 -0.03255566  0.12810521]
Stock Position:  -0.018465660506544374
Bond Position:  [0.42613065]


portfolio before change:  [-1.37889774]
curr_Stock_Price:  97.7534307520103
curr_Factors:  [97.75343075 -0.92586631 -1.03033755]
mat_Sqrt:  [[13.82176379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.09224487e-04 -6.45155779e-02 -7.86566018e-01]
Stock Position:  -0.00010922448747229662
Bond Position:  [-1.36822067]


portfolio before change:  [-1.37901475]
curr_Stock_Price:  97.25879598981844
curr_Factors:  [97.25879599 -0.72359793 -1.05704739]
mat_Sqrt:  [[16.39096232  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.39550365e-05 -1.01155356e-01 -1.40130228e-01]
Stock Position:  -6.395503650895208e-05
Bond Position:  [-1.37279456]


portfolio before change:  [-1.3791618]
curr_Stock_Price:  96.87472662731338
curr_Factors:  [96.87472663 -0.70087743 -1.04821134]
mat_Sqrt:  [[16.84965012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00589932  0.09260616 -0.07341977]
Stock Position:  0.005899324717344199
Bond Position:  [-1.95065727]


portfolio before change:  [-1.3759432]
curr_Stock_Price:  97.46164868929004
curr_Factors:  [97.46164869 -0.18038203 -1.03209234]
mat_Sqrt:  [[28.99097525  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00527609  0.00194442 -0.1237455 ]
Stock Position:  -0.005276086484692816
Bond Position:  [-0.86172712]


portfolio before change:  [-1.36944035]
curr_Stock_Price:  96.20871667848276
curr_Factors:  [ 9.62087167e+01  3.23051839e-02 -1.03022421e+00]
mat_Sqrt:  [[35.46693788  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00639159 0.02043569 1.03206405]
Stock Position:  0.0063915917505655015
Bond Position:  [-1.98436719]


portfolio before change:  [-1.34739352]
curr_Stock_Price:  99.69687662340124
curr_Factors:  [99.69687662 -0.27729496 -1.03287919]
mat_Sqrt:  [[26.8955325   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00277808 -0.11613507  0.24810336]
Stock Position:  0.0027780836542714966
Bond Position:  [-1.62435978]


portfolio before change:  [-1.34934925]
curr_Stock_Price:  99.06598382401802
curr_Factors:  [ 9.90659838e+01  2.97614872e-02 -9.96917208e-01]
mat_Sqrt:  [[37.66120091  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069485 -0.01145013 -0.21724751]
Stock Position:  -0.0006948469259872664
Bond Position:  [-1.28051355]


portfolio before change:  [-1.34823823]
curr_Stock_Price:  97.2366748542799
curr_Factors:  [97.23667485  0.10267764 -0.99224602]
mat_Sqrt:  [[39.94803872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00482576 -0.07719227 -0.00383874]
Stock Position:  0.004825760341268494
Bond Position:  [-1.81747912]


portfolio before change:  [-1.35659702]
curr_Stock_Price:  95.55163622508624
curr_Factors:  [ 9.55516362e+01 -7.11130582e-02 -9.66093801e-01]
mat_Sqrt:  [[33.86763828  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355537 -0.06134148 -0.40484512]
Stock Position:  -0.0035553650451669795
Bond Position:  [-1.01687608]


portfolio before change:  [-1.35740183]
curr_Stock_Price:  95.74224640768068
curr_Factors:  [95.74224641 -0.12928851 -1.01005598]
mat_Sqrt:  [[30.64027007  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0051239   0.12090215  0.7814098 ]
Stock Position:  -0.005123904546101243
Bond Position:  [-0.8668277]


portfolio before change:  [-1.35323667]
curr_Stock_Price:  94.90821146376783
curr_Factors:  [94.90821146 -0.3470844  -0.99403277]
mat_Sqrt:  [[24.82355652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187559 -0.17298118 -0.44323756]
Stock Position:  0.0018755898388903062
Bond Position:  [-1.53124555]


portfolio before change:  [-1.3550854]
curr_Stock_Price:  94.02459104867361
curr_Factors:  [94.02459105 -0.22428346 -1.00356263]
mat_Sqrt:  [[27.54194912  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00443976 -0.0651854  -0.32270956]
Stock Position:  0.004439760446704447
Bond Position:  [-1.77253206]


portfolio before change:  [-1.34202343]
curr_Stock_Price:  97.01654332037268
curr_Factors:  [97.01654332 -0.45600084 -1.00312258]
mat_Sqrt:  [[22.55051919  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01214335 -0.0406869  -0.12048314]
Stock Position:  -0.012143353182557527
Bond Position:  [-0.16391728]


portfolio before change:  [-1.33800695]
curr_Stock_Price:  96.68410048773728
curr_Factors:  [96.68410049 -0.45374621 -1.01797636]
mat_Sqrt:  [[22.19187866  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01407524 0.35133239 0.61833915]
Stock Position:  0.014075241966360582
Bond Position:  [-2.69885906]


portfolio before change:  [-1.3119633]
curr_Stock_Price:  98.55838620061223
curr_Factors:  [98.5583862  -0.72063638 -1.01471613]
mat_Sqrt:  [[17.37959136  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01101579 -0.01041105  0.50518496]
Stock Position:  -0.011015787099924347
Bond Position:  [-0.22626511]


portfolio before change:  [-1.30924247]
curr_Stock_Price:  98.30882483387782
curr_Factors:  [98.30882483 -0.72835422 -1.00833088]
mat_Sqrt:  [[17.31249857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00548174  0.07693839 -0.09297199]
Stock Position:  -0.005481735994224482
Bond Position:  [-0.77033945]


portfolio before change:  [-1.30850348]
curr_Stock_Price:  98.15644802589422
curr_Factors:  [98.15644803 -0.65254472 -1.01199712]
mat_Sqrt:  [[18.578793    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00030579 0.00269051 0.04496203]
Stock Position:  0.00030579118226047643
Bond Position:  [-1.33851886]


portfolio before change:  [-1.30902963]
curr_Stock_Price:  96.98303317728859
curr_Factors:  [96.98303318 -0.54266323 -1.00917412]
mat_Sqrt:  [[20.5466663   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00478777 -0.00182676 -0.2584042 ]
Stock Position:  -0.0047877682442252385
Bond Position:  [-0.84469734]


portfolio before change:  [-1.313017]
curr_Stock_Price:  97.79380265843449
curr_Factors:  [97.79380266 -0.4877805  -1.0183574 ]
mat_Sqrt:  [[21.68722338  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00164584 0.00985664 0.34039653]
Stock Position:  0.0016458428580640426
Bond Position:  [-1.47397023]


portfolio before change:  [-1.31635183]
curr_Stock_Price:  95.87954042737918
curr_Factors:  [95.87954043 -0.60249336 -0.99738773]
mat_Sqrt:  [[19.36004725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00528741  0.03076259  0.07973053]
Stock Position:  -0.00528740923889201
Bond Position:  [-0.80939746]


portfolio before change:  [-1.32339595]
curr_Stock_Price:  97.1926472562496
curr_Factors:  [97.19264726 -0.75724495 -0.98557351]
mat_Sqrt:  [[17.01127909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0057038  -0.02395792 -0.1807945 ]
Stock Position:  0.0057038014962433785
Bond Position:  [-1.87776351]


portfolio before change:  [-1.32568703]
curr_Stock_Price:  96.83212518591849
curr_Factors:  [96.83212519 -0.74844173 -0.97641076]
mat_Sqrt:  [[17.25542038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00336879 -0.02072554  0.3286347 ]
Stock Position:  0.0033687884128475146
Bond Position:  [-1.65189397]


portfolio before change:  [-1.33172743]
curr_Stock_Price:  95.10037520320745
curr_Factors:  [95.1003752  -0.68904512 -0.95860509]
mat_Sqrt:  [[18.30698545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00518061  0.01355533  0.33456865]
Stock Position:  -0.005180612784919581
Bond Position:  [-0.83904921]


portfolio before change:  [-1.33252264]
curr_Stock_Price:  95.23362636849123
curr_Factors:  [95.23362637 -0.88770861 -0.96036101]
mat_Sqrt:  [[15.00319939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.038078   -0.00459782 -1.83689859]
Stock Position:  -0.038078004683093164
Bond Position:  [2.29378383]


portfolio before change:  [-1.35725202]
curr_Stock_Price:  95.89059672692919
curr_Factors:  [95.89059673 -0.88026658 -0.95577611]
mat_Sqrt:  [[15.28948352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00994288 -0.03839518 -0.4391123 ]
Stock Position:  0.009942883475558032
Bond Position:  [-2.31068105]


portfolio before change:  [-1.36440173]
curr_Stock_Price:  95.20056976225052
curr_Factors:  [95.20056976 -0.83905069 -0.95477014]
mat_Sqrt:  [[15.83408822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00801898  0.00191074 -0.1072278 ]
Stock Position:  0.008018977127302145
Bond Position:  [-2.12781292]


portfolio before change:  [-1.35982947]
curr_Stock_Price:  95.80391993468568
curr_Factors:  [95.80391993 -1.03922619 -0.98854788]
mat_Sqrt:  [[12.61049662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215391  0.05447905 -0.13432037]
Stock Position:  0.002153907357416353
Bond Position:  [-1.56618224]


portfolio before change:  [-1.35988447]
curr_Stock_Price:  95.86928246597873
curr_Factors:  [95.86928247 -0.72970144 -0.97474763]
mat_Sqrt:  [[17.43599151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00883985  0.00486531 -0.49897517]
Stock Position:  -0.008839848084127187
Bond Position:  [-0.51241458]


portfolio before change:  [-1.35158334]
curr_Stock_Price:  94.92297818590845
curr_Factors:  [94.92297819 -0.60944632 -0.99663376]
mat_Sqrt:  [[19.04844992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087895  0.04682114  0.27087738]
Stock Position:  -0.000878950200524653
Bond Position:  [-1.26815077]


portfolio before change:  [-1.35219718]
curr_Stock_Price:  95.44100225216859
curr_Factors:  [95.44100225 -0.68593289 -1.0070113 ]
mat_Sqrt:  [[17.55895524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00808102  0.02907514  0.28909199]
Stock Position:  -0.008081024744982016
Bond Position:  [-0.58093608]


portfolio before change:  [-1.34211825]
curr_Stock_Price:  94.18478075226085
curr_Factors:  [94.18478075 -0.27524112 -1.00782641]
mat_Sqrt:  [[26.10667632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00601465 -0.02791474 -0.02843005]
Stock Position:  -0.00601464684237966
Bond Position:  [-0.77563006]


portfolio before change:  [-1.33490754]
curr_Stock_Price:  92.96980202033723
curr_Factors:  [92.96980202 -0.34345155 -0.98674539]
mat_Sqrt:  [[24.58355676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01031816 0.05953881 0.19868149]
Stock Position:  0.01031815623647675
Bond Position:  [-2.29418448]


portfolio before change:  [-1.3440727]
curr_Stock_Price:  92.10934122932193
curr_Factors:  [92.10934123 -0.20145799 -1.0074139 ]
mat_Sqrt:  [[27.49775781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264236  0.09176955  0.10058394]
Stock Position:  -0.0026423561262623714
Bond Position:  [-1.10068702]


portfolio before change:  [-1.34686008]
curr_Stock_Price:  93.11215155025012
curr_Factors:  [93.11215155  0.22416557 -1.02211861]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.34686008]
Stock Price:  93.99334690930905
PL:  [-1.34686008]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [ 1.66122728e-02  1.79332873e-01  3.48620195e-01]
 [-9.77724708e-02  3.87280353e-02  8.17811990e-02]
 [ 1.99914561e-01  2.72049738e-01  4.13479690e-01]
 [-1.22472049e-02  2.64076377e-02  1.22900892e-01]
 [-1.52175684e-01 -5.62544932e-02  4.89348075e-02]
 [ 4.49346586e-02 -1.81611294e-01 -2.42776329e-01]
 [ 3.23006312e-02 -1.30407688e-01 -1.77510714e-02]
 [ 2.80899357e-01 -3.73490280e-02 -6.19245566e-02]
 [-4.75758013e-01 -2.66275600e-02 -5.28512020e-02]
 [ 7.57741648e-02 -4.24623083e-02 -7.10016323e-02]
 [ 9.91979173e-02 -3.38263038e-01  2.67325462e-02]
 [ 1.79090472e-02 -7.78422532e-03 -7.86626697e-03]
 [ 1.62244384e-01 -1.24553239e-01  1.64860228e-01]
 [ 9.57253336e-02 -4.52913507e-02 -6.49767756e-02]
 [ 5.78161590e-02 -1.13379605e-01 -4.49680066e-02]
 [-2.74401266e-02  2.12984256e-02  4.06752312e-02]
 [-4.97125898e-01 -2.64687019e-01  1.38596555e-01]
 [-1.29054809e-01  1.65560056e-02 -2.47223973e-02]
 [ 3.35066408e-01  1.38734921e+00  5.08650730e-01]
 [-9.37272796e-02 -1.15278703e-02  9.37062844e-02]
 [-9.60313741e-02  2.91936564e-01 -3.03100955e-02]
 [-2.47037786e-02  4.39534709e-02 -1.58339366e-02]
 [ 8.05475663e-02 -3.84571337e-02  1.01175249e-01]
 [ 8.27129858e-02 -1.10115637e-02 -3.48423352e-02]
 [-8.35674928e-02 -3.62393213e-03  1.38322946e-01]
 [ 1.47342536e-02  6.31313813e-02 -1.19721803e-02]
 [-2.81579994e-02 -7.94859228e-02  5.61483710e-02]
 [ 2.14613904e-02  5.39869493e-02 -6.87207010e-02]
 [-5.85583976e-01 -2.66286163e-02 -8.59274503e-01]
 [-2.49013434e-01  1.40629850e-01 -3.68321534e-02]
 [-6.16941931e-02  2.91543007e-02  1.13926448e-01]
 [ 1.28341785e-02  3.66454902e-02  1.81382520e-02]
 [-1.29107876e-01 -8.64986981e-03 -1.41918267e-01]
 [-6.71106359e-02 -4.07719466e-02  2.26559009e-02]
 [ 2.32425239e-01 -1.73604148e-01 -6.94188256e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-3.53039250e-02 -3.88000046e-02 -4.87781401e-02]
 [-9.98635088e-02 -2.20602861e-02  2.46882558e-03]
 [-3.88042113e-02 -2.94551792e-01  1.46288859e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.93494579]
curr_Stock_Price:  98.84039794210175
curr_Factors:  [98.84039794 -0.96230947 -1.03887634]
mat_Sqrt:  [[13.36074062  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00691612 0.05671003 0.99451638]
Stock Position:  0.006916115624563411
Bond Position:  [-6.61853742]


portfolio before change:  [-5.93751775]
curr_Stock_Price:  98.58814908355228
curr_Factors:  [98.58814908 -0.8682879  -1.07568659]
mat_Sqrt:  [[14.11130958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00567481  0.01224688  0.233299  ]
Stock Position:  -0.0056748099402819585
Bond Position:  [-5.37804874]


portfolio before change:  [-5.93662213]
curr_Stock_Price:  98.31185534592785
curr_Factors:  [98.31185535 -0.8486765  -1.06691265]
mat_Sqrt:  [[14.47691727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02012445 0.08602968 1.17954247]
Stock Position:  0.02012445316640861
Bond Position:  [-7.91509446]


portfolio before change:  [-5.92513827]
curr_Stock_Price:  98.93166365037419
curr_Factors:  [98.93166365 -0.754533   -1.0816155 ]
mat_Sqrt:  [[15.77270397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00085728 0.00835083 0.35060204]
Stock Position:  0.0008572833766154125
Bond Position:  [-6.00995075]


portfolio before change:  [-5.92647082]
curr_Stock_Price:  98.25364067853054
curr_Factors:  [98.25364068 -0.71346525 -1.06379686]
mat_Sqrt:  [[16.61473905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0086453  -0.01778923  0.13959739]
Stock Position:  -0.008645299342301604
Bond Position:  [-5.07703869]


portfolio before change:  [-5.92593086]
curr_Stock_Price:  98.11777059077819
curr_Factors:  [98.11777059 -0.95322665 -1.05864498]
mat_Sqrt:  [[13.12208732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070957 -0.05743053 -0.69257329]
Stock Position:  -0.0007095696871640335
Bond Position:  [-5.85630946]


portfolio before change:  [-5.92710719]
curr_Stock_Price:  98.74385178450049
curr_Factors:  [98.74385178 -0.75578283 -1.05775604]
mat_Sqrt:  [[16.10275338  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00157179 -0.04123853 -0.05063887]
Stock Position:  0.001571786902238324
Bond Position:  [-6.08231148]


portfolio before change:  [-5.92588902]
curr_Stock_Price:  100.0026115318955
curr_Factors:  [100.00261153  -0.95548316  -1.07593962]
mat_Sqrt:  [[13.11522182  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02038049 -0.0118108  -0.17665352]
Stock Position:  0.02038049491656098
Bond Position:  [-7.96399174]


portfolio before change:  [-5.9151378]
curr_Stock_Price:  100.57898540024162
curr_Factors:  [100.5789854   -0.69582911  -1.08681407]
mat_Sqrt:  [[16.91668084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02880197 -0.00842037 -0.15076977]
Stock Position:  -0.028801970384843084
Bond Position:  [-3.01826484]


portfolio before change:  [-5.86803492]
curr_Stock_Price:  98.93048070201391
curr_Factors:  [98.9304807  -0.55672127 -1.11253069]
mat_Sqrt:  [[18.63730891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00322926 -0.01342776 -0.20254789]
Stock Position:  0.003229256190665311
Bond Position:  [-6.18750679]


portfolio before change:  [-5.8703329]
curr_Stock_Price:  98.45839459974579
curr_Factors:  [98.4583946  -0.2707149  -1.16305336]
mat_Sqrt:  [[23.47335174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00408637 -0.10696816  0.07626051]
Stock Position:  0.004086368336935416
Bond Position:  [-6.27267016]


portfolio before change:  [-5.86663941]
curr_Stock_Price:  99.55414093572857
curr_Factors:  [99.55414094 -0.42795715 -1.14594276]
mat_Sqrt:  [[20.63114265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078049 -0.00246159 -0.02244027]
Stock Position:  0.0007804882445109024
Bond Position:  [-5.94434024]


portfolio before change:  [-5.86744739]
curr_Stock_Price:  99.4709975453161
curr_Factors:  [99.47099755 -0.5743486  -1.15279354]
mat_Sqrt:  [[17.68512662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01089505 -0.03938719  0.47030034]
Stock Position:  0.010895052690478186
Bond Position:  [-6.95118915]


portfolio before change:  [-5.86119162]
curr_Stock_Price:  100.12493830641615
curr_Factors:  [100.12493831  -0.59206572  -1.13978516]
mat_Sqrt:  [[17.71776675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0045882  -0.01432238 -0.18536065]
Stock Position:  0.004588196034539174
Bond Position:  [-6.32058447]


portfolio before change:  [-5.85382121]
curr_Stock_Price:  101.90353023996784
curr_Factors:  [101.90353024  -1.08051956  -1.12036457]
mat_Sqrt:  [[11.28125447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00405182 -0.03585378 -0.12828121]
Stock Position:  0.004051823706859296
Bond Position:  [-6.26671635]


portfolio before change:  [-5.85702561]
curr_Stock_Price:  101.3060189787435
curr_Factors:  [101.30601898  -1.19224826  -1.12648835]
mat_Sqrt:  [[ 9.96829162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186465  0.00673515  0.11603511]
Stock Position:  -0.0018646531923793748
Bond Position:  [-5.66812502]


portfolio before change:  [-5.85694365]
curr_Stock_Price:  100.88206704548735
curr_Factors:  [100.88206705  -1.23617556  -1.10732136]
mat_Sqrt:  [[ 9.68380847  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04912005 -0.08370138  0.39537739]
Stock Position:  -0.049120052859145766
Bond Position:  [-0.90161118]


portfolio before change:  [-5.80345101]
curr_Stock_Price:  99.79075416630484
curr_Factors:  [99.79075417 -1.14786796 -1.10563129]
mat_Sqrt:  [[10.48112783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01275376  0.00523547 -0.07052612]
Stock Position:  -0.01275375847084527
Bond Position:  [-4.53074384]


portfolio before change:  [-5.80145164]
curr_Stock_Price:  99.58957792470244
curr_Factors:  [99.58957792 -0.94564053 -1.10006666]
mat_Sqrt:  [[12.87580964  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03686879 0.43871834 1.45103895]
Stock Position:  0.036868788742081486
Bond Position:  [-9.47319875]


portfolio before change:  [-5.79449983]
curr_Stock_Price:  99.81025327519102
curr_Factors:  [99.81025328 -0.78088272 -1.11225061]
mat_Sqrt:  [[15.03134343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00498274 -0.00364543  0.26731795]
Stock Position:  -0.004982735779489935
Bond Position:  [-5.29717171]


portfolio before change:  [-5.7903475]
curr_Stock_Price:  98.84401338422543
curr_Factors:  [98.84401338 -0.66257036 -1.09029493]
mat_Sqrt:  [[17.1273688   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00552803  0.09231845 -0.08646627]
Stock Position:  -0.005528031061577142
Bond Position:  [-5.24393472]


portfolio before change:  [-5.79820847]
curr_Stock_Price:  100.14745092312637
curr_Factors:  [100.14745092  -0.83330446  -1.06246333]
mat_Sqrt:  [[15.04244433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178169  0.01389931 -0.04516981]
Stock Position:  -0.0017816913941837373
Bond Position:  [-5.61977662]


portfolio before change:  [-5.80103559]
curr_Stock_Price:  101.33991099763317
curr_Factors:  [101.339911   -0.6176661  -1.0755093]
mat_Sqrt:  [[18.63990902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00537593 -0.01216121  0.28862482]
Stock Position:  0.005375933887393673
Bond Position:  [-6.34583225]


portfolio before change:  [-5.79459229]
curr_Stock_Price:  102.68601616202727
curr_Factors:  [102.68601616  -0.77714132  -1.08511905]
mat_Sqrt:  [[15.94931015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00472224 -0.00348216 -0.09939548]
Stock Position:  0.004722242267443173
Bond Position:  [-6.27950054]


portfolio before change:  [-5.79238233]
curr_Stock_Price:  103.32023882790742
curr_Factors:  [103.32023883  -0.93668654  -1.08422219]
mat_Sqrt:  [[13.69354492  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0040476  -0.00114599  0.39459686]
Stock Position:  -0.004047601230011869
Bond Position:  [-5.3741832]


portfolio before change:  [-5.7934845]
curr_Stock_Price:  103.42656314156416
curr_Factors:  [103.42656314  -1.22997925  -1.10491691]
mat_Sqrt:  [[10.01381534  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139013  0.0199639  -0.0341533 ]
Stock Position:  0.001390128269736902
Bond Position:  [-5.93726069]


portfolio before change:  [-5.79513496]
curr_Stock_Price:  102.77319825953077
curr_Factors:  [102.77319826  -1.21793033  -1.10009908]
mat_Sqrt:  [[10.119813    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185271 -0.02513566  0.16017567]
Stock Position:  -0.0018527100129209165
Bond Position:  [-5.60472603]


portfolio before change:  [-5.79584124]
curr_Stock_Price:  102.77624460077725
curr_Factors:  [102.7762446   -1.55394992  -1.07648143]
mat_Sqrt:  [[ 7.4047589   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00119218  0.01707217 -0.19604103]
Stock Position:  0.0011921756279314754
Bond Position:  [-5.91836858]


portfolio before change:  [-5.79637458]
curr_Stock_Price:  102.9494626654302
curr_Factors:  [102.94946267  -1.54508489  -1.07516877]
mat_Sqrt:  [[ 7.49311464  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10164935 -0.00842071 -2.45127098]
Stock Position:  -0.1016493452495263
Bond Position:  [4.6683709]


portfolio before change:  [-5.79172727]
curr_Stock_Price:  102.90948473135447
curr_Factors:  [102.90948473  -1.46115599  -1.04142838]
mat_Sqrt:  [[ 8.42552212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03001603  0.04447106 -0.10507188]
Stock Position:  -0.03001602924888036
Bond Position:  [-2.70279316]


portfolio before change:  [-5.79577097]
curr_Stock_Price:  103.0329465140678
curr_Factors:  [103.03294651  -1.42859247  -1.02973093]
mat_Sqrt:  [[ 8.81738562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427409  0.0092194   0.32500044]
Stock Position:  -0.004274089299566725
Bond Position:  [-5.35539895]


portfolio before change:  [-5.79369657]
curr_Stock_Price:  102.39097062491457
curr_Factors:  [102.39097062  -1.13293118  -1.02131591]
mat_Sqrt:  [[11.8763786   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00147207 0.01158832 0.05174338]
Stock Position:  0.0014720662591609917
Bond Position:  [-5.94442287]


portfolio before change:  [-5.79472665]
curr_Stock_Price:  102.19602349163152
curr_Factors:  [102.19602349  -1.20985171  -1.0355576 ]
mat_Sqrt:  [[10.82094335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01462905 -0.00273533 -0.40485331]
Stock Position:  -0.014629053508445204
Bond Position:  [-4.29969555]


portfolio before change:  [-5.79342056]
curr_Stock_Price:  102.07000125306959
curr_Factors:  [102.07000125  -1.44071871  -1.06056825]
mat_Sqrt:  [[ 8.36764016  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00759339 -0.01289322  0.06463098]
Stock Position:  -0.00759338899347508
Bond Position:  [-5.01836333]


portfolio before change:  [-5.78999118]
curr_Stock_Price:  101.53575826388779
curr_Factors:  [101.53575826  -1.35028103  -1.06524609]
mat_Sqrt:  [[ 9.0691987   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02357129 -0.05489845 -0.19803259]
Stock Position:  0.023571293149904735
Bond Position:  [-8.1833203]


portfolio before change:  [-5.78058666]
curr_Stock_Price:  101.97813923934514
curr_Factors:  [101.97813924  -1.28943156  -1.04819788]
mat_Sqrt:  [[ 9.84662764  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00248937 0.00777784 0.21633947]
Stock Position:  0.00248936839541672
Bond Position:  [-6.03444782]


portfolio before change:  [-5.78311674]
curr_Stock_Price:  101.26481627274234
curr_Factors:  [101.26481627  -1.40914793  -1.02768431]
mat_Sqrt:  [[ 8.85433157  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00522485 -0.01226964 -0.13915046]
Stock Position:  -0.005224847592211264
Bond Position:  [-5.25402351]


portfolio before change:  [-5.78171797]
curr_Stock_Price:  100.87139632228119
curr_Factors:  [100.87139632  -1.40052729  -1.0428447 ]
mat_Sqrt:  [[ 8.76244004  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01140426 -0.00697607  0.00704287]
Stock Position:  -0.011404261321277856
Bond Position:  [-4.63135421]


portfolio before change:  [-5.78752508]
curr_Stock_Price:  101.3298346102171
curr_Factors:  [101.32983461  -1.42763799  -1.06700207]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.78752508]
Stock Price:  100.29589807840914
PL:  [-6.08342316]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.10209125e-02 -3.99170476e-03  1.16809535e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.99720959e-01  8.34361330e-02  5.42852917e-02]
 [-4.58063308e-02  2.79345902e-02  1.07890619e-01]
 [-8.46854866e-01 -2.53030497e-01  3.19586328e-02]
 [-4.28145865e-02 -2.22436235e-02 -1.99469092e-03]
 [ 2.91934036e-02  7.52134061e-02  7.18586927e-04]
 [ 3.05989091e-01 -6.36252791e-02 -6.87450754e-02]
 [-5.31157045e-01 -2.87461250e-02 -6.85775184e-02]
 [ 3.34853856e-02  6.34380725e-03 -3.03297096e-02]
 [ 7.06805462e-03 -2.69233122e-01  1.36001634e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.41179438e-01 -5.94124582e-02  2.87854878e-01]
 [ 8.85678017e-02 -6.13583902e-02 -5.42641582e-02]
 [ 6.73809482e-02 -1.13201135e-01 -4.92831574e-02]
 [-3.10422134e-02  3.02641168e-02  4.20676243e-02]
 [-4.60354927e-01 -2.35451646e-01  1.21536920e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 2.28519489e-01  9.90088543e-01  3.25875547e-01]
 [-5.49515855e-03  2.65672068e-02  2.82990654e-02]
 [-4.07762244e-02 -1.32313407e-01  3.78417190e-03]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.36227430e-01 -2.98694232e-02  1.47172713e-01]
 [ 8.09939511e-02 -9.24032464e-02 -5.92863499e-02]
 [-6.25574400e-02 -1.29745688e-01  1.38709655e-01]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [ 1.67298955e-02 -7.06800525e-02 -1.31740904e-02]
 [ 6.65324417e-03  4.67915701e-02 -6.53378241e-02]
 [-5.88669022e-01 -3.13577653e-02 -8.70170598e-01]
 [-1.85813957e-01  5.77687134e-04  1.12396298e-02]
 [-7.31221691e-02  8.39280874e-02  2.01102574e-01]
 [ 1.56129888e-02  6.33620625e-02  5.04303293e-03]
 [-1.34651631e-01 -1.61595433e-02 -1.26099221e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 2.20385271e-01 -1.73267313e-01 -7.81820755e-02]
 [-1.04421933e-02  1.59761008e-01  8.03679338e-02]
 [ 3.74115068e-02  3.64891260e-02 -4.03122684e-02]
 [-6.49838158e-02  8.89630041e-02 -5.58682643e-03]
 [-5.90467055e-02 -2.39147755e-01  9.94282338e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.53065193]
curr_Stock_Price:  100.5772292469358
curr_Factors:  [100.57722925  -1.03883266  -0.97483553]
mat_Sqrt:  [[13.42686689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00660911 -0.00126229  0.03332251]
Stock Position:  -0.006609107985171415
Bond Position:  [7.1953777]


portfolio before change:  [6.53097227]
curr_Stock_Price:  100.66485744843084
curr_Factors:  [100.66485745  -1.00061046  -0.95502323]
mat_Sqrt:  [[14.24154025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00318653  0.01411938  0.0859571 ]
Stock Position:  -0.0031865263202350246
Bond Position:  [6.85174348]


portfolio before change:  [6.53174583]
curr_Stock_Price:  100.69088983260136
curr_Factors:  [100.69088983  -0.96936386  -0.93999438]
mat_Sqrt:  [[14.91991779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02097573 0.02638482 0.15486083]
Stock Position:  0.020975732805926423
Bond Position:  [4.41968063]


portfolio before change:  [6.50776535]
curr_Stock_Price:  99.52130111934942
curr_Factors:  [99.52130112 -1.28057595 -0.92170169]
mat_Sqrt:  [[11.0021869   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209613  0.00883369  0.30778191]
Stock Position:  -0.0020961271136715463
Bond Position:  [6.71637465]


portfolio before change:  [6.50777998]
curr_Stock_Price:  99.91486682594076
curr_Factors:  [99.91486683 -1.19239422 -0.95921381]
mat_Sqrt:  [[11.61979909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07288117 -0.08001527  0.09116908]
Stock Position:  -0.07288117034663422
Bond Position:  [13.78969241]


portfolio before change:  [6.45836712]
curr_Stock_Price:  100.61651143880361
curr_Factors:  [100.61651144  -1.19246297  -0.97714173]
mat_Sqrt:  [[11.49269568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00381078 -0.00703405 -0.0056903 ]
Stock Position:  -0.00381077514217815
Bond Position:  [6.84179402]


portfolio before change:  [6.45891119]
curr_Stock_Price:  100.69817732008183
curr_Factors:  [100.69817732  -1.0789751   -0.99462274]
mat_Sqrt:  [[12.66104378  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00247074 0.02378457 0.00204993]
Stock Position:  0.002470735185683473
Bond Position:  [6.21011266]


portfolio before change:  [6.46076222]
curr_Stock_Price:  101.1331550566577
curr_Factors:  [101.13315506  -0.99963925  -1.01621051]
mat_Sqrt:  [[13.47166053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02154996 -0.02012008 -0.19611057]
Stock Position:  0.021549961317740046
Bond Position:  [4.28134664]


portfolio before change:  [6.47987356]
curr_Stock_Price:  101.99515854511317
curr_Factors:  [101.99515855  -1.07661406  -1.02829867]
mat_Sqrt:  [[12.42875345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04392215 -0.00909032 -0.19563257]
Stock Position:  -0.043922151687110056
Bond Position:  [10.95972039]


portfolio before change:  [6.51203792]
curr_Stock_Price:  101.2940473263905
curr_Factors:  [101.29404733  -1.06456468  -0.99813624]
mat_Sqrt:  [[12.87550578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213259  0.00200609 -0.08652222]
Stock Position:  0.002132588529326521
Bond Position:  [6.2960194]


portfolio before change:  [6.51371372]
curr_Stock_Price:  101.7107894917104
curr_Factors:  [101.71078949  -0.88825043  -0.98568082]
mat_Sqrt:  [[15.61453386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00178537 -0.08513899  0.38797481]
Stock Position:  0.001785368864065683
Bond Position:  [6.33212244]


portfolio before change:  [6.51295521]
curr_Stock_Price:  100.84258391177119
curr_Factors:  [100.84258391  -0.68021133  -0.99041751]
mat_Sqrt:  [[18.97138688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380181  0.00225658  0.15019092]
Stock Position:  -0.003801810539611402
Bond Position:  [6.89633961]


portfolio before change:  [6.51452177]
curr_Stock_Price:  100.65728853756174
curr_Factors:  [100.65728854  -0.63493453  -0.99378336]
mat_Sqrt:  [[19.74704136  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01004725 -0.01878787  0.82116984]
Stock Position:  0.01004725428028127
Bond Position:  [5.50319239]


portfolio before change:  [6.4995342]
curr_Stock_Price:  99.0971098226111
curr_Factors:  [99.09710982 -0.4712634  -1.00374209]
mat_Sqrt:  [[22.67118629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00334817 -0.01940323 -0.15480054]
Stock Position:  0.003348166656504857
Bond Position:  [6.16774056]


portfolio before change:  [6.5086033]
curr_Stock_Price:  101.57550606956285
curr_Factors:  [101.57550607  -0.65735201  -1.02235311]
mat_Sqrt:  [[18.93661409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00287265 -0.03579734 -0.14059113]
Stock Position:  0.0028726479185815987
Bond Position:  [6.21681263]


portfolio before change:  [6.51087888]
curr_Stock_Price:  102.0971273136271
curr_Factors:  [102.09712731  -0.92173026  -1.02173573]
mat_Sqrt:  [[14.62099634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148237  0.00957035  0.12000722]
Stock Position:  -0.0014823736309207448
Bond Position:  [6.66222497]


portfolio before change:  [6.5119363]
curr_Stock_Price:  101.9456233778857
curr_Factors:  [101.94562338  -0.81942631  -0.99806567]
mat_Sqrt:  [[16.55929527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02666935 -0.07445635  0.346711  ]
Stock Position:  -0.02666935006156405
Bond Position:  [9.23075981]


portfolio before change:  [6.4960692]
curr_Stock_Price:  102.58384733007105
curr_Factors:  [102.58384733  -0.86619344  -1.0317891 ]
mat_Sqrt:  [[15.37431029  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00854094  0.00580111 -0.05715682]
Stock Position:  -0.008540941436531599
Bond Position:  [7.37223183]


portfolio before change:  [6.49846805]
curr_Stock_Price:  102.41088395449876
curr_Factors:  [102.41088395  -0.95046491  -1.04301159]
mat_Sqrt:  [[13.95051596  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02298141 0.31309349 0.92963223]
Stock Position:  0.022981410389896293
Bond Position:  [4.1449215]


portfolio before change:  [6.51243125]
curr_Stock_Price:  102.99592414066976
curr_Factors:  [102.99592414  -0.85176292  -1.06971042]
mat_Sqrt:  [[15.07768857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [6.41561410e-05 8.40128846e-03 8.07293566e-02]
Stock Position:  6.415614102955046e-05
Bond Position:  [6.50582343]


portfolio before change:  [6.51319299]
curr_Stock_Price:  102.19253641006478
curr_Factors:  [102.19253641  -0.75184058  -1.05017135]
mat_Sqrt:  [[16.85836067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257558 -0.04184117  0.01079519]
Stock Position:  -0.0025755826377929078
Bond Position:  [6.77639831]


portfolio before change:  [6.51193101]
curr_Stock_Price:  103.01140870361951
curr_Factors:  [103.0114087   -0.98304292  -1.05518539]
mat_Sqrt:  [[13.41819259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00289673  0.01916992 -0.08961985]
Stock Position:  -0.00289672870935883
Bond Position:  [6.81032712]


portfolio before change:  [6.51306805]
curr_Stock_Price:  102.91278217188594
curr_Factors:  [102.91278217  -0.94940097  -1.07507628]
mat_Sqrt:  [[13.59095653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01217705 -0.00944554  0.41984278]
Stock Position:  0.01217704646032236
Bond Position:  [5.25989432]


portfolio before change:  [6.51801368]
curr_Stock_Price:  103.26492862413185
curr_Factors:  [103.26492862  -1.07336218  -1.107653  ]
mat_Sqrt:  [[11.66138118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00570313 -0.02922047 -0.16912745]
Stock Position:  0.005703126669769319
Bond Position:  [5.92908072]


portfolio before change:  [6.51304345]
curr_Stock_Price:  102.26347591030957
curr_Factors:  [102.26347591  -0.97132293  -1.0685028 ]
mat_Sqrt:  [[13.29950543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282668 -0.04102919  0.39570004]
Stock Position:  -0.0028266817562919433
Bond Position:  [6.80210976]


portfolio before change:  [6.51384954]
curr_Stock_Price:  102.27912506819496
curr_Factors:  [102.27912507  -1.31471986  -1.07903215]
mat_Sqrt:  [[ 9.33670667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138765  0.02004328 -0.05140267]
Stock Position:  0.0013876502022661973
Bond Position:  [6.37192189]


portfolio before change:  [6.51325461]
curr_Stock_Price:  101.27637387812429
curr_Factors:  [101.27637388  -0.94154207  -1.08167507]
mat_Sqrt:  [[13.39171199  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091219 -0.022351   -0.03758201]
Stock Position:  0.0009121906524876387
Bond Position:  [6.42087125]


portfolio before change:  [6.51443455]
curr_Stock_Price:  101.68997046459073
curr_Factors:  [101.68997046  -1.20921387  -1.07281856]
mat_Sqrt:  [[10.38015947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052751  0.01479679 -0.18639063]
Stock Position:  -0.0005275092534050042
Bond Position:  [6.56807695]


portfolio before change:  [6.51515406]
curr_Stock_Price:  101.88246765679293
curr_Factors:  [101.88246766  -1.26979253  -1.08207107]
mat_Sqrt:  [[ 9.69835488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07909604 -0.0099162  -2.48235451]
Stock Position:  -0.0790960442029908
Bond Position:  [14.57365423]


portfolio before change:  [6.57514001]
curr_Stock_Price:  101.1471069154321
curr_Factors:  [101.14710692  -1.07050512  -1.05300213]
mat_Sqrt:  [[12.09834546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01516776  0.00018268  0.03206354]
Stock Position:  -0.015167756791895847
Bond Position:  [8.10931473]


portfolio before change:  [6.57803555]
curr_Stock_Price:  101.02304037592437
curr_Factors:  [101.02304038  -1.18252888  -1.05106264]
mat_Sqrt:  [[10.82390472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00276289  0.02654039  0.57368967]
Stock Position:  -0.0027628905637857174
Bond Position:  [6.85715115]


portfolio before change:  [6.57897093]
curr_Stock_Price:  100.99474092868361
curr_Factors:  [100.99474093  -0.7218964   -1.04376403]
mat_Sqrt:  [[17.27755077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00105793 0.02003684 0.01438637]
Stock Position:  0.0010579274354507746
Bond Position:  [6.47212583]


portfolio before change:  [6.58014675]
curr_Stock_Price:  101.34141290197731
curr_Factors:  [101.3414129   -0.55530681  -1.02689984]
mat_Sqrt:  [[20.82779708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00772087 -0.0051101  -0.35972598]
Stock Position:  -0.00772087242034572
Bond Position:  [7.36259087]


portfolio before change:  [6.57320612]
curr_Stock_Price:  102.35956359208359
curr_Factors:  [102.35956359  -0.3297783   -1.01114704]
mat_Sqrt:  [[26.7776184   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195737  0.0049611   0.16678008]
Stock Position:  -0.0019573698741900195
Bond Position:  [6.77356165]


portfolio before change:  [6.57277922]
curr_Stock_Price:  103.01025727828328
curr_Factors:  [103.01025728  -0.3251248   -0.98419617]
mat_Sqrt:  [[27.8131129   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00718915 -0.05479194 -0.2230317 ]
Stock Position:  0.007189151391353131
Bond Position:  [5.83222289]


portfolio before change:  [6.5766994]
curr_Stock_Price:  103.45413430517844
curr_Factors:  [103.45413431  -0.45912664  -0.97830982]
mat_Sqrt:  [[24.57407224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00041051 0.05052087 0.22926734]
Stock Position:  0.0004105080295259979
Bond Position:  [6.53423064]


portfolio before change:  [6.57730447]
curr_Stock_Price:  102.93828724787397
curr_Factors:  [102.93828725  -0.49226748  -0.9496354 ]
mat_Sqrt:  [[24.34257272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00123754  0.01153887 -0.11499968]
Stock Position:  0.0012375415280352498
Bond Position:  [6.44991406]


portfolio before change:  [6.57644191]
curr_Stock_Price:  101.58977282129962
curr_Factors:  [101.58977282  -0.61967043  -0.91862332]
mat_Sqrt:  [[21.81611935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00292569  0.02813257 -0.01593766]
Stock Position:  -0.0029256902213567492
Bond Position:  [6.87366212]


portfolio before change:  [6.57653051]
curr_Stock_Price:  101.85318746422391
curr_Factors:  [101.85318746  -0.19478138  -0.91503104]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.57653051]
Stock Price:  104.31585429692238
PL:  [2.26067621]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.82838682e-02  1.45270676e-01  1.33280657e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 1.99535869e-01  1.88734392e-01  2.77674586e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-9.90918723e-01 -2.93838269e-01  2.84380823e-02]
 [-5.68385286e-02  4.65644827e-03  3.87996029e-02]
 [ 3.50256205e-02  5.34082193e-02 -1.28956942e-02]
 [ 2.81024650e-01 -6.10260923e-02 -5.96024826e-02]
 [-4.56205852e-01 -2.64858722e-02 -4.47491638e-02]
 [ 4.11262636e-02 -6.63722295e-03 -3.64125430e-02]
 [ 3.92791843e-02 -3.47700007e-01  1.58466971e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.41905532e-01 -5.38623503e-02  2.98493562e-01]
 [ 9.25756334e-02  6.81989030e-02  3.25009311e-02]
 [ 2.33145598e-02 -1.03329757e-01 -5.10634651e-02]
 [-4.85159204e-02  7.37566441e-02  4.88221173e-02]
 [-4.17690644e-01 -2.03049815e-01  1.01905619e-01]
 [-1.27694933e-01  1.83447267e-02 -2.00358924e-02]
 [ 9.43734880e-02  6.96077607e-01  9.89630247e-02]
 [-3.10519438e-02  5.14777033e-02  2.38478846e-02]
 [ 7.60258177e-02 -2.24825383e-01  1.49568655e-01]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 2.29971609e-01 -1.21240102e-03  2.16195778e-01]
 [ 7.06471990e-02 -1.76647975e-01 -6.78871790e-02]
 [-1.21062579e-01  2.21776218e-01  1.79086520e-01]
 [ 1.40079961e-02  6.24391264e-02  4.70125484e-03]
 [ 5.03326511e-02 -5.96801570e-02  2.29137468e-01]
 [ 5.47137825e-02  5.86321487e-02 -7.30881509e-02]
 [-7.61534077e-01 -1.62641033e-01 -1.15597074e+00]
 [-1.53894787e-01  4.34768388e-02  2.05791514e-02]
 [-2.45720375e-02  6.48101611e-02  1.77685671e-01]
 [ 1.89010097e-02  7.86838964e-02 -2.07124900e-03]
 [-1.29991942e-01 -1.23745762e-02 -9.72634654e-02]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [ 2.42257497e-01 -1.76780992e-01 -6.82502732e-02]
 [ 8.39683316e-03  2.45956891e-02  7.58361658e-02]
 [-2.53112453e-03 -3.02076853e-03 -4.68402551e-02]
 [-8.45426733e-02  2.38537451e-02 -1.62939631e-03]
 [-2.29991109e-02 -2.81941791e-01  1.05287003e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.73825369]
curr_Stock_Price:  99.56445287527458
curr_Factors:  [99.56445288 -1.20106982 -0.99976075]
mat_Sqrt:  [[11.02289675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00610794  0.04593862  0.38021262]
Stock Position:  -0.006107940302313792
Bond Position:  [-0.13011996]


portfolio before change:  [-0.74251656]
curr_Stock_Price:  100.25971306067628
curr_Factors:  [100.25971306  -1.47029398  -1.04178907]
mat_Sqrt:  [[ 8.13097547  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00558125  0.01411938  0.0859571 ]
Stock Position:  -0.005581254430180725
Bond Position:  [-0.1829416]


portfolio before change:  [-0.73905614]
curr_Stock_Price:  99.63560757933686
curr_Factors:  [99.63560758 -1.18688436 -1.01157998]
mat_Sqrt:  [[11.05690666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02361321 0.05968306 0.7921283 ]
Stock Position:  0.023613209853309794
Bond Position:  [-3.09177265]


portfolio before change:  [-0.71542512]
curr_Stock_Price:  100.65272975323528
curr_Factors:  [100.65272975  -1.30079426  -1.03528305]
mat_Sqrt:  [[ 9.73374739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0020242  -0.00659539  0.21422481]
Stock Position:  0.002024200249991537
Bond Position:  [-0.9191664]


portfolio before change:  [-0.71505973]
curr_Stock_Price:  100.89000548010657
curr_Factors:  [100.89000548  -1.17819912  -1.00041721]
mat_Sqrt:  [[11.420552    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0869223  -0.09291982  0.08112593]
Stock Position:  -0.08692230419464622
Bond Position:  [8.05453202]


portfolio before change:  [-0.74885795]
curr_Stock_Price:  101.29042169932737
curr_Factors:  [101.2904217   -0.93780567  -1.00456666]
mat_Sqrt:  [[14.52134341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00336046  0.0014725   0.11068447]
Stock Position:  -0.0033604579477952844
Bond Position:  [-0.40847575]


portfolio before change:  [-0.74618166]
curr_Stock_Price:  100.47882073329727
curr_Factors:  [100.47882073  -0.75626623  -0.98644093]
mat_Sqrt:  [[17.58840381  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00192015  0.01688916 -0.03678783]
Stock Position:  0.001920145375930688
Bond Position:  [-0.9391156]


portfolio before change:  [-0.7464429]
curr_Stock_Price:  100.40390667082147
curr_Factors:  [100.40390667  -0.87254495  -0.99044986]
mat_Sqrt:  [[15.5834009   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01715175 -0.01929814 -0.17002929]
Stock Position:  0.017151753928295623
Bond Position:  [-2.468546]


portfolio before change:  [-0.74531508]
curr_Stock_Price:  100.4876537227838
curr_Factors:  [100.48765372  -0.65034888  -0.99566543]
mat_Sqrt:  [[19.37571657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02405197 -0.00837557 -0.12765691]
Stock Position:  -0.024051967170897307
Bond Position:  [1.67161067]


portfolio before change:  [-0.7803559]
curr_Stock_Price:  101.95322129401362
curr_Factors:  [101.95322129  -0.4828838   -0.98503305]
mat_Sqrt:  [[23.49052717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00142705 -0.00209887 -0.10387485]
Stock Position:  0.0014270523491610205
Bond Position:  [-0.92584848]


portfolio before change:  [-0.78108208]
curr_Stock_Price:  101.52545731173664
curr_Factors:  [101.52545731  -0.35187167  -0.99196163]
mat_Sqrt:  [[26.48229199  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00236568 -0.1099524   0.45206216]
Stock Position:  0.002365676796729745
Bond Position:  [-1.0212585]


portfolio before change:  [-0.78175925]
curr_Stock_Price:  101.29317374528351
curr_Factors:  [101.29317375  -0.67496924  -0.97052059]
mat_Sqrt:  [[19.54128087  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00369094  0.00225658  0.15019092]
Stock Position:  -0.0036909360784772973
Bond Position:  [-0.40789262]


portfolio before change:  [-0.78047375]
curr_Stock_Price:  100.93107238376778
curr_Factors:  [100.93107238  -0.79499305  -0.99021505]
mat_Sqrt:  [[16.93241343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01189698 -0.01703277  0.85151905]
Stock Position:  0.011896978335364293
Bond Position:  [-1.98124853]


portfolio before change:  [-0.7800596]
curr_Stock_Price:  100.9867019363237
curr_Factors:  [100.98670194  -0.44073796  -1.02267122]
mat_Sqrt:  [[23.372957    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00431998 0.02156639 0.09271611]
Stock Position:  0.004319981689832313
Bond Position:  [-1.2163203]


portfolio before change:  [-0.78260316]
curr_Stock_Price:  100.43310926184294
curr_Factors:  [100.43310926  -0.22073792  -1.02444009]
mat_Sqrt:  [[28.9136533   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035358 -0.03267574 -0.14566985]
Stock Position:  0.00035358073492152976
Bond Position:  [-0.81811437]


portfolio before change:  [-0.78208413]
curr_Stock_Price:  102.19027164300492
curr_Factors:  [102.19027164  -0.34169717  -1.00698642]
mat_Sqrt:  [[26.52672985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138147  0.0233239   0.13927591]
Stock Position:  -0.0013814653836106896
Bond Position:  [-0.64091181]


portfolio before change:  [-0.78353695]
curr_Stock_Price:  103.18392756989563
curr_Factors:  [103.18392757  -0.34787835  -1.01058347]
mat_Sqrt:  [[26.52403453  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01516104 -0.06420999  0.29070836]
Stock Position:  -0.015161040828371719
Bond Position:  [0.78083879]


portfolio before change:  [-0.77540351]
curr_Stock_Price:  102.65389577457158
curr_Factors:  [102.65389577  -0.26492246  -1.02175181]
mat_Sqrt:  [[28.35175196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0046315   0.00580111 -0.05715682]
Stock Position:  -0.004631498044498968
Bond Position:  [-0.29996219]


portfolio before change:  [-0.78162806]
curr_Stock_Price:  103.98976022824284
curr_Factors:  [103.98976023  -0.35600679  -1.0065013 ]
mat_Sqrt:  [[26.62323527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00497862 0.22011907 0.28231396]
Stock Position:  0.0049786164607739155
Bond Position:  [-1.29935319]


portfolio before change:  [-0.76681646]
curr_Stock_Price:  106.9974280166422
curr_Factors:  [106.99742802  -0.36791766  -0.98700914]
mat_Sqrt:  [[27.60171738  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090048  0.01627868  0.06803138]
Stock Position:  -0.0009004825965227801
Bond Position:  [-0.67046714]


portfolio before change:  [-0.76616386]
curr_Stock_Price:  106.17962884647727
curr_Factors:  [106.17962885  -0.35966315  -0.989497  ]
mat_Sqrt:  [[27.54916224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00365715 -0.07109603  0.42667774]
Stock Position:  0.0036571502306947342
Bond Position:  [-1.15447872]


portfolio before change:  [-0.76977208]
curr_Stock_Price:  105.23247196311154
curr_Factors:  [105.23247196  -0.49277956  -1.00953498]
mat_Sqrt:  [[23.42625454  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016592   0.01916992 -0.08961985]
Stock Position:  -0.0016592009461191674
Bond Position:  [-0.59517026]


portfolio before change:  [-0.76964474]
curr_Stock_Price:  105.11088579072003
curr_Factors:  [105.11088579  -0.25656228  -1.01527048]
mat_Sqrt:  [[29.46440975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.30176730e-03 -3.83394867e-04  6.16746376e-01]
Stock Position:  0.009301767303071404
Bond Position:  [-1.74736174]


portfolio before change:  [-0.75625559]
curr_Stock_Price:  106.57378903682206
curr_Factors:  [ 1.06573789e+02 -7.08756385e-02 -1.03050415e+00]
mat_Sqrt:  [[35.42641798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147429 -0.05586099 -0.19366323]
Stock Position:  0.001474288355970678
Bond Position:  [-0.91337608]


portfolio before change:  [-0.75823927]
curr_Stock_Price:  105.30571936871702
curr_Factors:  [105.30571937  -0.38360252  -1.04891259]
mat_Sqrt:  [[25.13729561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313401  0.0701318   0.51088399]
Stock Position:  -0.0031340069244263132
Bond Position:  [-0.42821041]


portfolio before change:  [-0.75476092]
curr_Stock_Price:  104.17876502153945
curr_Factors:  [104.17876502  -0.38980517  -1.02883229]
mat_Sqrt:  [[25.21580197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00065752 0.01974499 0.01341137]
Stock Position:  0.0006575165484582567
Bond Position:  [-0.82326018]


portfolio before change:  [-0.75536324]
curr_Stock_Price:  103.41921750983936
curr_Factors:  [103.41921751  -0.31949658  -1.03743547]
mat_Sqrt:  [[26.62521637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00358924 -0.01887252  0.65366542]
Stock Position:  0.003589236779913644
Bond Position:  [-1.1265593]


portfolio before change:  [-0.75521539]
curr_Stock_Price:  103.49964760718385
curr_Factors:  [103.49964761  -0.60845261  -1.00287521]
mat_Sqrt:  [[20.66084546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00199937  0.01854111 -0.20850015]
Stock Position:  0.0019993664744658297
Bond Position:  [-0.96214912]


portfolio before change:  [-0.75248994]
curr_Stock_Price:  104.92295980682835
curr_Factors:  [104.92295981  -0.65402901  -1.00557971]
mat_Sqrt:  [[19.95775216  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05019077 -0.05143161 -3.29766276]
Stock Position:  -0.05019077208274893
Bond Position:  [4.51367442]


portfolio before change:  [-0.68076645]
curr_Stock_Price:  103.50518418825425
curr_Factors:  [103.50518419  -0.70866837  -1.04505928]
mat_Sqrt:  [[17.91958145  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00829101  0.01374858  0.05870659]
Stock Position:  -0.008291014990787425
Bond Position:  [0.17739659]


portfolio before change:  [-0.66572641]
curr_Stock_Price:  101.69384230743931
curr_Factors:  [101.69384231  -0.46812049  -1.01634472]
mat_Sqrt:  [[23.04621511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00058019 0.02049477 0.50688776]
Stock Position:  0.0005801945910351515
Bond Position:  [-0.72472862]


portfolio before change:  [-0.66572544]
curr_Stock_Price:  101.85165914643476
curr_Factors:  [101.85165915  -0.51825091  -1.02806544]
mat_Sqrt:  [[21.69758762  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094526  0.02488203 -0.0059087 ]
Stock Position:  0.0009452584115148862
Bond Position:  [-0.76200158]


portfolio before change:  [-0.66446248]
curr_Stock_Price:  103.28853352901679
curr_Factors:  [103.28853353  -0.91380286  -1.01943682]
mat_Sqrt:  [[14.94365338  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01004877 -0.00391318 -0.27746559]
Stock Position:  -0.01004876588171505
Bond Position:  [0.37345981]


portfolio before change:  [-0.65882037]
curr_Stock_Price:  102.73170683218021
curr_Factors:  [102.73170683  -1.01876037  -1.04172195]
mat_Sqrt:  [[13.08725014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00400494  0.0049611   0.16678008]
Stock Position:  -0.004004943971585668
Bond Position:  [-0.24738564]


portfolio before change:  [-0.65604055]
curr_Stock_Price:  102.02988662898991
curr_Factors:  [102.02988663  -0.98122014  -1.04569254]
mat_Sqrt:  [[13.44158279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01664696 -0.05590306 -0.19469903]
Stock Position:  0.016646960899841308
Bond Position:  [-2.35452808]


portfolio before change:  [-0.66447038]
curr_Stock_Price:  101.54117883176183
curr_Factors:  [101.54117883  -0.80837529  -1.02494574]
mat_Sqrt:  [[16.23457757  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00150986 0.00777784 0.21633947]
Stock Position:  0.0015098565724294645
Bond Position:  [-0.817783]


portfolio before change:  [-0.66398935]
curr_Stock_Price:  101.92748248176564
curr_Factors:  [101.92748248  -0.85655727  -1.01611162]
mat_Sqrt:  [[15.66756603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00077679 -0.00095525 -0.13362221]
Stock Position:  -0.0007767860967636739
Bond Position:  [-0.5848135]


portfolio before change:  [-0.66301353]
curr_Stock_Price:  100.57714293038215
curr_Factors:  [100.57714293  -0.79433049  -0.98718651]
mat_Sqrt:  [[16.93543244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00497533  0.00754322 -0.00464821]
Stock Position:  -0.00497533037009826
Bond Position:  [-0.16260901]


portfolio before change:  [-0.66017887]
curr_Stock_Price:  100.0033138166076
curr_Factors:  [100.00331382  -0.30790357  -0.97601918]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.66017887]
Stock Price:  99.5962531244987
PL:  [-0.66017887]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [ 1.55685069e-01 -8.78010779e-02  2.82881501e-01]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.52705698e-01  1.66551278e-02 -2.51386207e-02]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-6.45347363e-01 -1.95951140e-01  3.68829586e-02]
 [-6.21820296e-02  1.49061026e-02  5.43433314e-02]
 [ 6.40734722e-03  1.52831933e-01  7.44602646e-02]
 [ 3.32488520e-01 -3.84561799e-02 -8.12444674e-02]
 [-5.24322739e-01 -2.86267410e-02 -6.60396556e-02]
 [ 3.11563664e-02  1.03005605e-02 -2.84755986e-02]
 [-4.07259860e-03 -2.41083896e-01  1.29911291e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.11645979e-01 -2.44629032e-02  2.75697317e-01]
 [ 9.90454911e-02 -8.16898784e-03 -3.96150630e-02]
 [ 6.29006973e-02 -1.13284732e-01 -4.72618940e-02]
 [-4.57779800e-02  2.14159943e-02  3.14521821e-02]
 [-4.78196453e-01 -2.48213457e-01  1.29662115e-01]
 [-1.25873996e-01  1.84630250e-02 -2.15519462e-02]
 [ 2.94710433e-01  1.21466668e+00  4.52315285e-01]
 [ 8.52892900e-03  1.25411559e-02  3.03881550e-02]
 [-2.80880880e-02 -1.50706396e-01  3.83161309e-03]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.53329245e-01 -2.85603412e-02  1.60111675e-01]
 [ 8.04121911e-02  5.17970964e-02 -8.96482861e-03]
 [-6.01588984e-02 -1.56502812e-01  1.50127024e-01]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [ 4.00822148e-02 -6.50077270e-02  1.43308968e-01]
 [-4.56590583e-02  4.34641117e-02  4.77957682e-02]
 [-6.22061727e-01 -3.19543854e-02 -9.17694576e-01]
 [ 1.28579498e-01 -1.10217059e-01 -1.26105177e-01]
 [ 1.22827894e-01  1.08473441e-02 -3.55864721e-02]
 [ 2.42746724e-02  1.32018443e-01 -2.82539316e-02]
 [-1.32220487e-01 -1.50656226e-02 -1.16198066e-01]
 [-6.47525871e-02  1.56883901e-02  5.84634954e-02]
 [-1.23702686e-01  9.69599529e-02  1.52093053e-01]
 [-2.58543189e-03  1.03390703e-01  7.84779731e-02]
 [ 3.66029951e-02  3.52894156e-02 -4.00376889e-02]
 [-1.79875015e-02  6.62790243e-02 -1.06352173e-02]
 [-6.59232496e-02 -2.46516353e-01  9.19571740e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.38340912]
curr_Stock_Price:  98.91724352864941
curr_Factors:  [98.91724353 -1.14167963 -0.97665008]
mat_Sqrt:  [[11.8930461   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.017755   -0.02776514  0.80698218]
Stock Position:  0.017754997183207995
Bond Position:  [-7.1396845]


portfolio before change:  [-5.37062614]
curr_Stock_Price:  99.68747707637215
curr_Factors:  [99.68747708 -1.06800938 -0.98686435]
mat_Sqrt:  [[12.77086408  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355348  0.01411938  0.0859571 ]
Stock Position:  -0.0035534825653367463
Bond Position:  [-5.01638843]


portfolio before change:  [-5.37433826]
curr_Stock_Price:  100.5556493684829
curr_Factors:  [100.55564937  -1.13448489  -0.98042291]
mat_Sqrt:  [[12.13147718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02044304  0.00526681 -0.07171349]
Stock Position:  0.020443044812339963
Bond Position:  [-7.43000191]


portfolio before change:  [-5.35580086]
curr_Stock_Price:  101.50786594406256
curr_Factors:  [101.50786594  -0.97348212  -0.99340027]
mat_Sqrt:  [[14.20016949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138752 -0.00659539  0.21422481]
Stock Position:  0.0013875224460897539
Bond Position:  [-5.49664531]


portfolio before change:  [-5.35797752]
curr_Stock_Price:  100.43434872901743
curr_Factors:  [100.43434873  -0.80948616  -1.00084223]
mat_Sqrt:  [[16.43110002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03912569 -0.06196519  0.10521681]
Stock Position:  -0.03912568828705437
Bond Position:  [-1.42841449]


portfolio before change:  [-5.40130246]
curr_Stock_Price:  101.537112112364
curr_Factors:  [101.53711211  -0.84347841  -1.0267727 ]
mat_Sqrt:  [[15.64534242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324086  0.00471372  0.1550264 ]
Stock Position:  -0.0032408603315534903
Bond Position:  [-5.07223486]


portfolio before change:  [-5.40412249]
curr_Stock_Price:  102.2116133041422
curr_Factors:  [102.2116133   -1.08257908  -1.02315485]
mat_Sqrt:  [[12.44490588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00205326 0.0483297  0.21241441]
Stock Position:  0.0020532568805417834
Bond Position:  [-5.61398919]


portfolio before change:  [-5.40610798]
curr_Stock_Price:  101.586414128798
curr_Factors:  [101.58641413  -1.16495214  -1.0244899 ]
mat_Sqrt:  [[11.37556653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02768316 -0.01216091 -0.23176785]
Stock Position:  0.027683159980435794
Bond Position:  [-8.21834093]


portfolio before change:  [-5.4022715]
curr_Stock_Price:  101.76211052832298
curr_Factors:  [101.76211053  -1.06112953  -1.04088317]
mat_Sqrt:  [[12.43636861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04330381 -0.00905257 -0.18839276]
Stock Position:  -0.04330381190148094
Bond Position:  [-0.99558421]


portfolio before change:  [-5.39797929]
curr_Stock_Price:  101.66011799259483
curr_Factors:  [101.66011799  -0.917018    -1.03921336]
mat_Sqrt:  [[14.37375117  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017817   0.00325732 -0.08123296]
Stock Position:  0.001781703897635483
Bond Position:  [-5.57910752]


portfolio before change:  [-5.39817475]
curr_Stock_Price:  101.94185356922848
curr_Factors:  [101.94185357  -1.00074922  -1.04417985]
mat_Sqrt:  [[13.19019189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122975 -0.07623742  0.37060075]
Stock Position:  0.0012297526345123756
Bond Position:  [-5.52353802]


portfolio before change:  [-5.39928958]
curr_Stock_Price:  101.59678758282223
curr_Factors:  [101.59678758  -0.73799064  -1.05050363]
mat_Sqrt:  [[16.98817723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00424564  0.00225658  0.15019092]
Stock Position:  -0.0042456361049383285
Bond Position:  [-4.9679466]


portfolio before change:  [-5.40039712]
curr_Stock_Price:  101.71137537809156
curr_Factors:  [101.71137538  -0.68987754  -1.03334993]
mat_Sqrt:  [[18.15437687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0092149  -0.00773585  0.78648771]
Stock Position:  0.00921490336992755
Bond Position:  [-6.33765761]


portfolio before change:  [-5.41640704]
curr_Stock_Price:  100.05995669291568
curr_Factors:  [100.05995669  -0.51695554  -1.01724848]
mat_Sqrt:  [[21.5756539   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00420605 -0.00258326 -0.11301075]
Stock Position:  0.004206045308241471
Bond Position:  [-5.83726375]


portfolio before change:  [-5.41001019]
curr_Stock_Price:  101.75431558775139
curr_Factors:  [101.75431559  -0.59942094  -1.02642559]
mat_Sqrt:  [[20.01965825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00251395 -0.03582378 -0.13482503]
Stock Position:  0.0025139492279825136
Bond Position:  [-5.66581537]


portfolio before change:  [-5.41425217]
curr_Stock_Price:  100.34867312747693
curr_Factors:  [100.34867313  -0.65377931  -1.04514517]
mat_Sqrt:  [[18.35177639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0021145   0.00677233  0.08972432]
Stock Position:  -0.002114502205536399
Bond Position:  [-5.20206468]


portfolio before change:  [-5.41731408]
curr_Stock_Price:  101.48917982915478
curr_Factors:  [101.48917983  -1.00804495  -0.98785745]
mat_Sqrt:  [[13.79146313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03321896 -0.07849199  0.36988992]
Stock Position:  -0.03321896479131066
Bond Position:  [-2.04594858]


portfolio before change:  [-5.41084598]
curr_Stock_Price:  101.28676974563365
curr_Factors:  [101.28676975  -1.16093355  -1.02758224]
mat_Sqrt:  [[11.35252299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01143328  0.00583852 -0.0614817 ]
Stock Position:  -0.01143327833203436
Bond Position:  [-4.25280615]


portfolio before change:  [-5.407916]
curr_Stock_Price:  100.9840030405212
curr_Factors:  [100.98400304  -1.06486515  -1.03748225]
mat_Sqrt:  [[12.33714608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03391396 0.38411133 1.29032961]
Stock Position:  0.03391395873273218
Bond Position:  [-8.83268331]


portfolio before change:  [-5.39043825]
curr_Stock_Price:  101.5319162965741
curr_Factors:  [101.5319163   -1.02386763  -1.04058196]
mat_Sqrt:  [[12.8831931   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00116863 0.00396586 0.08668895]
Stock Position:  0.0011686308131261113
Bond Position:  [-5.50909157]


portfolio before change:  [-5.39037067]
curr_Stock_Price:  102.17904393778527
curr_Factors:  [102.17904394  -1.20480683  -1.05726865]
mat_Sqrt:  [[10.64032604  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293198 -0.04765755  0.01093053]
Stock Position:  -0.0029319764787145573
Bond Position:  [-5.09078412]


portfolio before change:  [-5.3885864]
curr_Stock_Price:  101.35343761828088
curr_Factors:  [101.35343762  -0.84675602  -1.04175532]
mat_Sqrt:  [[15.33445787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253474  0.01916992 -0.08961985]
Stock Position:  -0.002534739997346087
Bond Position:  [-5.13168179]


portfolio before change:  [-5.39426241]
curr_Stock_Price:  103.33964186188764
curr_Factors:  [103.33964186  -1.05601434  -1.05073987]
mat_Sqrt:  [[12.56941955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0147401  -0.00903157  0.45675404]
Stock Position:  0.014740098211898832
Bond Position:  [-6.91749888]


portfolio before change:  [-5.41402475]
curr_Stock_Price:  102.05758855591648
curr_Factors:  [102.05758856  -0.82127023  -1.03607927]
mat_Sqrt:  [[15.92973909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00501701  0.01637968 -0.02557416]
Stock Position:  0.005017009248313918
Bond Position:  [-5.92604861]


portfolio before change:  [-5.41382491]
curr_Stock_Price:  102.2450785378681
curr_Factors:  [102.24507854  -0.73392834  -1.03734097]
mat_Sqrt:  [[17.39361803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192917 -0.04949053  0.42827061]
Stock Position:  -0.0019291692540052503
Bond Position:  [-5.21657685]


portfolio before change:  [-5.41496129]
curr_Stock_Price:  102.49610052076403
curr_Factors:  [102.49610052  -0.60477481  -1.01813866]
mat_Sqrt:  [[20.22483462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0006406   0.02004328 -0.05140267]
Stock Position:  0.0006406026621539198
Bond Position:  [-5.48062056]


portfolio before change:  [-5.4169498]
curr_Stock_Price:  100.46146720389893
curr_Factors:  [100.4614672   -0.14981422  -0.99110368]
mat_Sqrt:  [[32.10000997  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210768 -0.02055725  0.4088206 ]
Stock Position:  0.0021076798186432395
Bond Position:  [-5.62869041]


portfolio before change:  [-5.42424796]
curr_Stock_Price:  97.33265856291293
curr_Factors:  [97.33265856 -0.11640299 -0.98656163]
mat_Sqrt:  [[32.30331851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00107669  0.01374456  0.13634802]
Stock Position:  -0.0010766865760732157
Bond Position:  [-5.31945119]


portfolio before change:  [-5.42517767]
curr_Stock_Price:  97.57854651455173
curr_Factors:  [97.57854651 -0.21806672 -0.96558002]
mat_Sqrt:  [[29.87466876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02712031 -0.01010486 -2.61792719]
Stock Position:  -0.027120314302744097
Bond Position:  [-2.77881682]


portfolio before change:  [-5.40382233]
curr_Stock_Price:  96.77830790816037
curr_Factors:  [96.77830791 -0.21020983 -0.94909498]
mat_Sqrt:  [[30.3597607   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00329359 -0.03485369 -0.35974297]
Stock Position:  0.003293589661183284
Bond Position:  [-5.72257036]


portfolio before change:  [-5.40029288]
curr_Stock_Price:  98.06711663859072
curr_Factors:  [ 9.80671166e+01  6.43378229e-02 -9.45439224e-01]
mat_Sqrt:  [[40.63178763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00285107  0.00343023 -0.1015183 ]
Stock Position:  0.0028510661190207795
Bond Position:  [-5.67988872]


portfolio before change:  [-5.39685438]
curr_Stock_Price:  99.52219777051461
curr_Factors:  [ 9.95221978e+01 -8.05495432e-02 -9.51497393e-01]
mat_Sqrt:  [[35.45746384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00061809  0.0417479  -0.0806006 ]
Stock Position:  0.0006180945253097323
Bond Position:  [-5.45836851]


portfolio before change:  [-5.39666112]
curr_Stock_Price:  100.9388180653347
curr_Factors:  [ 1.00938818e+02  2.34712608e-02 -9.57987818e-01]
mat_Sqrt:  [[39.64631535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00394307 -0.00476417 -0.33148074]
Stock Position:  -0.00394307286699683
Bond Position:  [-4.998652]


portfolio before change:  [-5.40045888]
curr_Stock_Price:  101.74349331753608
curr_Factors:  [101.74349332   0.35160937  -0.94030299]
mat_Sqrt:  [[56.47292098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00092812  0.0049611   0.16678008]
Stock Position:  -0.000928120994102246
Bond Position:  [-5.30602861]


portfolio before change:  [-5.39721976]
curr_Stock_Price:  97.5388580696147
curr_Factors:  [ 9.75388581e+01  8.57949009e-02 -9.54578777e-01]
mat_Sqrt:  [[40.91378171  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0022035   0.03066143  0.43387914]
Stock Position:  -0.0022034953234618183
Bond Position:  [-5.18229335]


portfolio before change:  [-5.40568544]
curr_Stock_Price:  101.08679047895463
curr_Factors:  [ 1.01086790e+02 -7.31492442e-02 -9.68122542e-01]
mat_Sqrt:  [[35.68418786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00045127 0.03269501 0.22387581]
Stock Position:  0.0004512742121148005
Bond Position:  [-5.45130331]


portfolio before change:  [-5.4062463]
curr_Stock_Price:  101.35403274570223
curr_Factors:  [101.35403275   0.1492107   -0.95725232]
mat_Sqrt:  [[45.17654505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00064949  0.01115949 -0.11421638]
Stock Position:  0.0006494853662877125
Bond Position:  [-5.47207426]


portfolio before change:  [-5.40543213]
curr_Stock_Price:  103.66081839195644
curr_Factors:  [ 1.03660818e+02  2.41916732e-02 -9.50086655e-01]
mat_Sqrt:  [[41.06799985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044918  0.02095927 -0.03033931]
Stock Position:  -0.0004491840168067164
Bond Position:  [-5.35886935]


portfolio before change:  [-5.40525548]
curr_Stock_Price:  101.77617395593225
curr_Factors:  [101.77617396   0.3468689   -0.95002666]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.40525548]
Stock Price:  98.52800974200287
PL:  [-5.40525548]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.02823763e-01  3.40574170e-02  5.44888794e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 1.42174933e-01  2.01543861e-01  3.38567312e-01]
 [-9.82926555e-02 -1.40654223e-02  7.14824278e-02]
 [-6.01020657e-01 -1.83395082e-01  3.79661894e-02]
 [-2.54678599e-02 -5.55173055e-02 -5.24546441e-02]
 [ 3.24576658e-02  1.76639104e-02 -2.22697456e-02]
 [ 3.38525028e-01  1.46090956e-02 -8.88280965e-02]
 [-2.72289397e-01  1.16037830e-02 -1.23304539e-01]
 [ 4.06522439e-02 -5.83191458e-03 -3.60351803e-02]
 [ 5.09256533e-03 -1.88748097e-01  2.21640978e-02]
 [-3.94543995e-02  1.49260016e-03  2.89354079e-02]
 [ 2.32719229e-01 -1.91343845e-01  1.56176200e-01]
 [ 5.89812605e-02  1.45501036e-01  9.86495222e-02]
 [ 8.82027593e-02 -1.10576610e-01 -6.15705782e-02]
 [-3.73117593e-02  4.58691854e-02  4.44911286e-02]
 [-5.45757954e-01 -2.85593809e-01  1.59259436e-01]
 [-1.25548077e-01  1.84841985e-02 -2.18232957e-02]
 [ 3.22425430e-01  1.29585519e+00  5.12636392e-01]
 [ 1.32964143e-02  7.77300325e-03  3.10983405e-02]
 [-7.40950843e-02  1.43254881e-02 -3.59091158e-02]
 [-1.16563112e-02  4.14596742e-02 -1.10317994e-02]
 [ 6.05468927e-02 -3.63758594e-02  7.90819257e-02]
 [ 7.50575399e-02  1.41231160e-01  3.19178493e-02]
 [-5.92186325e-02 -1.55080558e-01  2.84489075e-02]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [-2.28101842e-02  8.34637345e-03 -4.93884921e-02]
 [ 4.17733082e-02  5.22320266e-02 -7.81378717e-02]
 [-6.79292862e-01 -1.42517825e-01 -1.05505511e+00]
 [-2.28206242e-01  3.77269802e-02  1.88633827e-02]
 [ 1.75726724e-02 -2.64704338e-03  1.09844001e-01]
 [ 2.09340687e-02  7.40240363e-02  8.00878750e-04]
 [-1.20989814e-01 -1.00122547e-02 -7.04596681e-02]
 [-6.01616543e-02  1.25612155e-01  1.28178021e-01]
 [ 1.47332034e-01 -1.59081260e-01 -1.05372661e-01]
 [-2.65571349e-02  2.51498715e-01  8.34168481e-02]
 [ 1.17258912e-01  9.13916753e-02 -2.12638142e-02]
 [-2.33714575e-02  7.02350458e-02 -1.00856263e-02]
 [-1.02538645e-01 -1.96484841e-01  3.92492718e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.36075783]
curr_Stock_Price:  100.41422794200328
curr_Factors:  [100.41422794  -0.84048808  -1.00109964]
mat_Sqrt:  [[15.9222291   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0057041   0.0107699   0.15544161]
Stock Position:  -0.005704095079278586
Bond Position:  [5.93353013]


portfolio before change:  [5.36166857]
curr_Stock_Price:  100.38459961828075
curr_Factors:  [100.38459962  -1.0556363   -1.02047368]
mat_Sqrt:  [[12.58994938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360455  0.01411938  0.0859571 ]
Stock Position:  -0.0036045452982085466
Bond Position:  [5.72350941]


portfolio before change:  [5.36832813]
curr_Stock_Price:  98.73554958014665
curr_Factors:  [98.73554958 -1.35961114 -1.01241861]
mat_Sqrt:  [[ 9.21115556  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02350286 0.06373376 0.9658383 ]
Stock Position:  0.023502863955701697
Bond Position:  [3.04775994]


portfolio before change:  [5.36974058]
curr_Stock_Price:  98.77943576171265
curr_Factors:  [98.77943576 -1.33108682 -1.0059174 ]
mat_Sqrt:  [[ 9.5437379   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00880834 -0.00444788  0.20391947]
Stock Position:  -0.008808344757757939
Bond Position:  [6.2398239]


portfolio before change:  [5.36771245]
curr_Stock_Price:  99.09824187233825
curr_Factors:  [99.09824187 -1.08528122 -0.99966773]
mat_Sqrt:  [[12.31924599  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04854243 -0.05799462  0.10830697]
Stock Position:  -0.048542425586820585
Bond Position:  [10.17818148]


portfolio before change:  [5.32566612]
curr_Stock_Price:  99.99062988679314
curr_Factors:  [99.99062989 -1.24271149 -1.01952443]
mat_Sqrt:  [[10.41076695  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361247 -0.01755611 -0.1496385 ]
Stock Position:  -0.0036124687234428523
Bond Position:  [5.68687914]


portfolio before change:  [5.32632148]
curr_Stock_Price:  100.00600480018734
curr_Factors:  [100.0060048   -1.26572392  -1.03316326]
mat_Sqrt:  [[10.03765033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00282615  0.00558582 -0.06352939]
Stock Position:  0.0028261547599952347
Bond Position:  [5.04368904]


portfolio before change:  [5.32653566]
curr_Stock_Price:  99.8586937059802
curr_Factors:  [99.85869371 -1.26884882 -1.01744719]
mat_Sqrt:  [[10.1498621   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03160341  0.0046198  -0.25340183]
Stock Position:  0.031603411974228876
Bond Position:  [2.17066022]


portfolio before change:  [5.30525229]
curr_Stock_Price:  99.17665596202089
curr_Factors:  [99.17665596 -1.41801245 -1.00799471]
mat_Sqrt:  [[ 8.76613062  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03389856  0.00366944 -0.35175353]
Stock Position:  -0.03389856200155546
Bond Position:  [8.66719831]


portfolio before change:  [5.30553133]
curr_Stock_Price:  99.20038641845679
curr_Factors:  [99.20038642 -1.43070656 -1.02748597]
mat_Sqrt:  [[ 8.49051263  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00390389 -0.00184421 -0.10279834]
Stock Position:  0.0039038884505354725
Bond Position:  [4.91826409]


portfolio before change:  [5.3077748]
curr_Stock_Price:  99.6175716523582
curr_Factors:  [99.61757165 -1.63213491 -0.99931331]
mat_Sqrt:  [[ 7.16989023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00066156 -0.05968739  0.063228  ]
Stock Position:  0.000661563536744424
Bond Position:  [5.24187144]


portfolio before change:  [5.30837552]
curr_Stock_Price:  99.53511437251365
curr_Factors:  [99.53511437 -1.56336601 -0.97586374]
mat_Sqrt:  [[ 7.85602487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00426545  0.000472    0.08254466]
Stock Position:  -0.004265445419398697
Bond Position:  [5.73293712]


portfolio before change:  [5.30817776]
curr_Stock_Price:  99.74949347861782
curr_Factors:  [99.74949348 -1.65978012 -0.95620886]
mat_Sqrt:  [[ 7.29123547  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03561236 -0.06050824  0.44552723]
Stock Position:  0.03561235772709289
Bond Position:  [1.75586311]


portfolio before change:  [5.3253699]
curr_Stock_Price:  100.22608767535911
curr_Factors:  [100.22608768  -1.72564422  -0.94903093]
mat_Sqrt:  [[ 6.90850568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01199606 0.04601147 0.28141963]
Stock Position:  0.011996057370004025
Bond Position:  [4.123052]


portfolio before change:  [5.32624698]
curr_Stock_Price:  100.25623648558349
curr_Factors:  [100.25623649  -1.50976501  -0.94324291]
mat_Sqrt:  [[ 8.62548639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00843774 -0.03496739 -0.17564372]
Stock Position:  0.008437743511651276
Bond Position:  [4.48031057]


portfolio before change:  [5.32998317]
curr_Stock_Price:  100.63265400292411
curr_Factors:  [100.632654    -1.62253167  -0.96322517]
mat_Sqrt:  [[ 7.58156738  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035673   0.01450511  0.12692081]
Stock Position:  -0.0035672977711509973
Bond Position:  [5.68896981]


portfolio before change:  [5.33044437]
curr_Stock_Price:  100.70272354791216
curr_Factors:  [100.70272355  -1.59990111  -0.97459066]
mat_Sqrt:  [[ 7.67279588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06785314 -0.09031269  0.45432284]
Stock Position:  -0.06785313542401433
Bond Position:  [12.16343991]


portfolio before change:  [5.3287942]
curr_Stock_Price:  100.74945233402087
curr_Factors:  [100.74945233  -1.40636144  -0.98878603]
mat_Sqrt:  [[ 9.18424302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01410301  0.00584522 -0.06225579]
Stock Position:  -0.01410301080542461
Bond Position:  [6.74966482]


portfolio before change:  [5.33241866]
curr_Stock_Price:  100.55228177972059
curr_Factors:  [100.55228178  -1.17298255  -1.01559891]
mat_Sqrt:  [[11.26945933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04086494 0.40978539 1.46240894]
Stock Position:  0.04086493584527289
Bond Position:  [1.22335612]


portfolio before change:  [5.33944425]
curr_Stock_Price:  100.7204616529603
curr_Factors:  [100.72046165  -1.34644783  -0.98826749]
mat_Sqrt:  [[ 9.75357276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00203464 0.00245804 0.08871491]
Stock Position:  0.0020346425881622872
Bond Position:  [5.13451411]


portfolio before change:  [5.33985747]
curr_Stock_Price:  100.60809071560347
curr_Factors:  [100.60809072  -1.15574709  -1.00143144]
mat_Sqrt:  [[11.63542304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00696624  0.00453012 -0.10243871]
Stock Position:  -0.006966237414754789
Bond Position:  [6.04071732]


portfolio before change:  [5.34127735]
curr_Stock_Price:  100.51266744324771
curr_Factors:  [100.51266744  -1.14353649  -1.03017535]
mat_Sqrt:  [[11.43377767  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112279  0.0131107  -0.03147065]
Stock Position:  -0.001122785838806857
Bond Position:  [5.45413155]


portfolio before change:  [5.34155188]
curr_Stock_Price:  100.87540399390457
curr_Factors:  [100.87540399  -0.82936649  -1.04961863]
mat_Sqrt:  [[15.40821798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00491622 -0.01150306  0.22559872]
Stock Position:  0.004916220850506972
Bond Position:  [4.84562612]


portfolio before change:  [5.34287596]
curr_Stock_Price:  101.02151977856572
curr_Factors:  [101.02151978  -1.06617026  -1.0277976 ]
mat_Sqrt:  [[12.44558197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00684735 0.04466121 0.09105274]
Stock Position:  0.006847354884633247
Bond Position:  [4.65114577]


portfolio before change:  [5.34327497]
curr_Stock_Price:  100.9948791575143
curr_Factors:  [100.99487916  -1.14514252  -1.05620845]
mat_Sqrt:  [[11.17544369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00513767 -0.04904078  0.08115681]
Stock Position:  -0.005137665037766791
Bond Position:  [5.86215283]


portfolio before change:  [5.3394455]
curr_Stock_Price:  101.8828880140108
curr_Factors:  [101.88288801  -1.0998078   -1.06742889]
mat_Sqrt:  [[11.66493475  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00111069  0.02004328 -0.05140267]
Stock Position:  0.0011106862727865805
Bond Position:  [5.22628557]


portfolio before change:  [5.33997352]
curr_Stock_Price:  101.77007255682803
curr_Factors:  [101.77007256  -1.26416872  -1.0511708 ]
mat_Sqrt:  [[10.04802966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325199  0.00263936 -0.14089162]
Stock Position:  -0.003251987361502735
Bond Position:  [5.67092851]


portfolio before change:  [5.33832922]
curr_Stock_Price:  102.49369395403502
curr_Factors:  [102.49369395  -0.81531794  -1.07810175]
mat_Sqrt:  [[15.431048    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00176087  0.01651722 -0.2229056 ]
Stock Position:  0.0017608724358892998
Bond Position:  [5.1578509]


portfolio before change:  [5.34109437]
curr_Stock_Price:  103.69785517564046
curr_Factors:  [103.69785518  -0.75671908  -1.09330663]
mat_Sqrt:  [[16.30473756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05509656 -0.04506809 -3.00977856]
Stock Position:  -0.055096555537146666
Bond Position:  [11.05448901]


portfolio before change:  [5.43914588]
curr_Stock_Price:  101.94330610428251
curr_Factors:  [101.9433061   -0.6195585   -1.07184183]
mat_Sqrt:  [[18.78420787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01189199  0.01193032  0.05381198]
Stock Position:  -0.011891992762414734
Bond Position:  [6.65145494]


portfolio before change:  [5.42670762]
curr_Stock_Price:  103.05916123606576
curr_Factors:  [103.05916124  -0.6291522   -1.06885506]
mat_Sqrt:  [[18.86476584  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00211644 -0.00083707  0.31335436]
Stock Position:  0.002116439678908485
Bond Position:  [5.20858912]


portfolio before change:  [5.43060299]
curr_Stock_Price:  104.59204504886107
curr_Factors:  [104.59204505  -0.92549145  -1.05301842]
mat_Sqrt:  [[14.46247883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00159093 0.02340846 0.00228468]
Stock Position:  0.001590933341189116
Bond Position:  [5.26420402]


portfolio before change:  [5.4309312]
curr_Stock_Price:  104.38471088272719
curr_Factors:  [104.38471088  -0.88515339  -1.05261436]
mat_Sqrt:  [[15.03401752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0090216  -0.00316615 -0.20100182]
Stock Position:  -0.009021597121748931
Bond Position:  [6.37264801]


portfolio before change:  [5.42736215]
curr_Stock_Price:  104.86862591712315
curr_Factors:  [104.86862592  -0.77642726  -1.04220595]
mat_Sqrt:  [[17.01465743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180751  0.03972205  0.36565622]
Stock Position:  -0.0018075082366672565
Bond Position:  [5.61691305]


portfolio before change:  [5.42726902]
curr_Stock_Price:  105.30861425114178
curr_Factors:  [105.30861425  -0.80402553  -1.0225668 ]
mat_Sqrt:  [[16.95059425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0071806  -0.05030591 -0.30059887]
Stock Position:  0.007180601887404554
Bond Position:  [4.67108979]


portfolio before change:  [5.42942541]
curr_Stock_Price:  105.52760262787012
curr_Factors:  [105.52760263  -0.66820357  -1.00157001]
mat_Sqrt:  [[19.86975981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.52798687e-04  7.95308767e-02  2.37965049e-01]
Stock Position:  -0.0001527986872241839
Bond Position:  [5.44554989]


portfolio before change:  [5.43003936]
curr_Stock_Price:  105.96468552017464
curr_Factors:  [105.96468552  -0.59820162  -0.99635806]
mat_Sqrt:  [[21.51060787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00535913  0.02890059 -0.06065974]
Stock Position:  0.005359131526849187
Bond Position:  [4.86216068]


portfolio before change:  [5.42521956]
curr_Stock_Price:  104.95190731901161
curr_Factors:  [104.95190732  -0.46296395  -0.99076684]
mat_Sqrt:  [[24.5269235   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096289  0.02221027 -0.02877148]
Stock Position:  -0.0009628894652599805
Bond Position:  [5.52627665]


portfolio before change:  [5.42506724]
curr_Stock_Price:  105.8275551256291
curr_Factors:  [105.82755513  -0.73023867  -0.98832549]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.42506724]
Stock Price:  105.89859210176033
PL:  [-0.47352487]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.08024607e-01  5.40095208e-02  7.57354038e-02]
 [ 3.10800365e-02 -8.80103470e-02 -2.06303266e-01]
 [ 4.24158061e-01 -5.37311035e-01 -9.96720540e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.08779105e+00 -2.60490548e-01 -3.08971745e-01]
 [ 4.17959497e-02  1.04594013e-01  1.17201557e-01]
 [-5.16179385e-02  2.63380263e-02  1.45643968e-01]
 [ 3.13904361e-01 -4.89161989e-01 -2.28326382e-02]
 [-1.25767137e-01  5.99411596e-01 -2.00782610e-01]
 [-3.56620527e-01  1.40971578e-01  2.48901849e-01]
 [ 1.20590598e-02 -3.26484804e-01  2.80044509e-01]
 [-4.29802115e-01  7.80299679e-02  3.93135584e-01]
 [ 3.51375296e-02  1.91732550e-01  1.09355594e-01]
 [ 2.78611557e-02  6.79249293e-01  6.49436312e-01]
 [ 1.80582476e-01 -1.40973341e-01 -7.49605809e-02]
 [-3.03474490e-03 -3.94472269e-02  3.12412868e-02]
 [-6.53460716e-01 -8.87034227e-02  2.28707649e-01]
 [-1.13716934e-01  1.92528158e-02 -3.16735239e-02]
 [ 3.52787996e-02  5.98190476e-01  5.66704453e-02]
 [ 1.42837696e-03  1.45854106e-02  2.81210994e-02]
 [-5.47826835e-02  1.52974149e-01 -1.12326071e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.43187363e-01 -3.25780420e-02  1.53136547e-01]
 [ 8.45320793e-02 -2.32147273e-02 -4.25237214e-02]
 [-6.33804923e-02 -1.35812692e-01  1.51729945e-01]
 [ 1.49976316e-02  6.33824282e-02 -1.80188188e-02]
 [ 2.10397313e-02 -6.09410607e-02  3.60130241e-02]
 [ 2.73140587e-02  4.41282868e-02 -7.59453401e-02]
 [-7.58631330e-01 -1.82916263e-01 -1.20590972e+00]
 [-2.31891381e-01  2.80164161e-02  2.33608478e-02]
 [-1.70763033e-02 -2.89844876e-02  1.11728635e-01]
 [ 3.39400793e-02  1.62044723e-01 -2.06549015e-02]
 [-1.16758271e-01 -5.24187161e-03 -3.64884181e-02]
 [-6.01616543e-02  1.25612155e-01  1.28178021e-01]
 [ 1.39556133e-01 -1.57776888e-01 -1.08470987e-01]
 [-2.93302417e-02  2.62792736e-01  8.37858456e-02]
 [ 5.98984674e-02  5.50071356e-02 -3.60216345e-02]
 [-2.64864556e-02  7.25238832e-02 -9.76764922e-03]
 [-1.06623544e-01 -2.06642105e-01  4.15029271e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.92582142]
curr_Stock_Price:  100.77161816385201
curr_Factors:  [100.77161816  -0.80926299  -1.01784926]
mat_Sqrt:  [[16.21188321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00562369  0.01707931  0.21605203]
Stock Position:  -0.0056236935154739725
Bond Position:  [8.49253011]


portfolio before change:  [7.91959002]
curr_Stock_Price:  102.06845802639334
curr_Factors:  [102.06845803  -0.88577202  -1.02973251]
mat_Sqrt:  [[15.03136807  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088507 -0.02783132 -0.5885258 ]
Stock Position:  -0.0008850730514163707
Bond Position:  [8.00992806]


portfolio before change:  [7.91934302]
curr_Stock_Price:  103.47885506118661
curr_Factors:  [103.47885506  -0.79512309  -1.02945101]
mat_Sqrt:  [[16.68972391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01239266 -0.16991267 -2.84336627]
Stock Position:  0.012392656843707245
Bond Position:  [6.63696508]


portfolio before change:  [7.91858577]
curr_Stock_Price:  103.35080124605926
curr_Factors:  [103.35080125  -0.5564714   -1.01740515]
mat_Sqrt:  [[21.41844554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091991 -0.00659539  0.21422481]
Stock Position:  0.0009199105449517539
Bond Position:  [7.82351227]


portfolio before change:  [7.92100149]
curr_Stock_Price:  104.91369491737382
curr_Factors:  [104.91369492  -0.66875914  -1.00507162]
mat_Sqrt:  [[19.67418355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05883779 -0.08237434 -0.88141039]
Stock Position:  -0.05883779015966464
Bond Position:  [14.09389145]


portfolio before change:  [7.91432886]
curr_Stock_Price:  105.05704623289297
curr_Factors:  [105.05704623  -0.60773106  -0.98644216]
mat_Sqrt:  [[21.3346023   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00320701 0.03307553 0.33434342]
Stock Position:  0.003207007201923418
Bond Position:  [7.57741016]


portfolio before change:  [7.91414514]
curr_Stock_Price:  104.70439443463864
curr_Factors:  [104.70439443  -0.65409342  -0.97513416]
mat_Sqrt:  [[20.5305394   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103302  0.00832882  0.4154817 ]
Stock Position:  -0.0010330192844952059
Bond Position:  [8.0223068]


portfolio before change:  [7.91434758]
curr_Stock_Price:  105.4792227422186
curr_Factors:  [105.47922274  -0.38939143  -0.97901662]
mat_Sqrt:  [[26.84570751  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01104883 -0.1546866  -0.06513516]
Stock Position:  0.011048826331779431
Bond Position:  [6.74892596]


portfolio before change:  [7.93233562]
curr_Stock_Price:  107.03091473633445
curr_Factors:  [ 1.07030915e+02 -2.35919107e-02 -9.91720396e-01]
mat_Sqrt:  [[38.77615163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00390124  0.18955059 -0.5727769 ]
Stock Position:  -0.0039012374465387527
Bond Position:  [8.34988863]


portfolio before change:  [7.92403307]
curr_Stock_Price:  109.4266557075384
curr_Factors:  [ 1.09426656e+02  9.41416445e-02 -1.00671496e+00]
mat_Sqrt:  [[43.93367872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00687795  0.04457913  0.7100477 ]
Stock Position:  -0.006877953050032624
Bond Position:  [8.67666447]


portfolio before change:  [7.93691777]
curr_Stock_Price:  107.71102089400904
curr_Factors:  [ 1.07711021e+02  1.66031661e-02 -9.89820494e-01]
mat_Sqrt:  [[40.70026406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149368 -0.10324356  0.79888903]
Stock Position:  0.001493678378484852
Bond Position:  [7.77603215]


portfolio before change:  [7.93763186]
curr_Stock_Price:  107.53830810036015
curr_Factors:  [107.5383081    0.12119039  -1.00797851]
mat_Sqrt:  [[44.30329352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00784454  0.02467524  1.12150639]
Stock Position:  -0.00784453925136305
Bond Position:  [8.78122034]


portfolio before change:  [7.92880384]
curr_Stock_Price:  108.803614131633
curr_Factors:  [108.80361413   0.14883127  -0.96921472]
mat_Sqrt:  [[47.90218442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00130287 0.06063116 0.31196107]
Stock Position:  0.0013028666798395889
Bond Position:  [7.78704724]


portfolio before change:  [7.92865247]
curr_Stock_Price:  107.94027825113854
curr_Factors:  [107.94027825   0.20661783  -0.97179681]
mat_Sqrt:  [[50.21928505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00354376 0.21479749 1.85266103]
Stock Position:  0.0035437567268980126
Bond Position:  [7.54613838]


portfolio before change:  [7.93098974]
curr_Stock_Price:  108.33362954448063
curr_Factors:  [108.33362954   0.36202352  -0.97107096]
mat_Sqrt:  [[58.91926907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00274344 -0.04457968 -0.21384167]
Stock Position:  0.0027434368804747375
Bond Position:  [7.63378326]


portfolio before change:  [7.94214442]
curr_Stock_Price:  112.0517411659033
curr_Factors:  [112.05174117   0.36356464  -0.96425109]
mat_Sqrt:  [[61.45310026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.78147406e-05 -1.24743084e-02  8.91226953e-02]
Stock Position:  3.781474058182011e-05
Bond Position:  [7.93790722]


portfolio before change:  [7.94299804]
curr_Stock_Price:  108.38430422521581
curr_Factors:  [108.38430423   0.27722607  -0.95376227]
mat_Sqrt:  [[55.09985469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01105386 -0.02805049  0.65243926]
Stock Position:  -0.011053863539253262
Bond Position:  [9.14106335]


portfolio before change:  [7.93803174]
curr_Stock_Price:  108.93696231054561
curr_Factors:  [ 1.08936962e+02 -4.69313311e-02 -9.44607491e-01]
mat_Sqrt:  [[40.41619477  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296132  0.00608827 -0.09035575]
Stock Position:  -0.002961316871777129
Bond Position:  [8.2606286]


portfolio before change:  [7.95094892]
curr_Stock_Price:  104.92370219674305
curr_Factors:  [104.9237022   -0.12790701  -0.93854435]
mat_Sqrt:  [[36.11766513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00172469 0.18916444 0.16166501]
Stock Position:  0.0017246911517147293
Bond Position:  [7.76998794]


portfolio before change:  [7.95054611]
curr_Stock_Price:  104.12697165626228
curr_Factors:  [ 1.04126972e+02  2.50245607e-02 -9.44297268e-01]
mat_Sqrt:  [[41.52677203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00018169 0.00461231 0.08022167]
Stock Position:  0.0001816940168984595
Bond Position:  [7.93162686]


portfolio before change:  [7.95099669]
curr_Stock_Price:  101.14976485713711
curr_Factors:  [101.14976486  -0.16821015  -0.92816981]
mat_Sqrt:  [[33.79193906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00157214  0.04837467 -0.0320435 ]
Stock Position:  -0.001572142816993537
Bond Position:  [8.11001856]


portfolio before change:  [7.9508026]
curr_Stock_Price:  101.91808194171652
curr_Factors:  [101.91808194  -0.23961766  -0.93190397]
mat_Sqrt:  [[31.58390761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00123065  0.01916992 -0.08961985]
Stock Position:  -0.0012306540458886597
Bond Position:  [8.0762285]


portfolio before change:  [7.95100354]
curr_Stock_Price:  102.57517027187758
curr_Factors:  [102.57517027  -0.29707235  -0.9330307 ]
mat_Sqrt:  [[29.97887142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00579091 -0.01030208  0.43685594]
Stock Position:  0.005790914068490862
Bond Position:  [7.35699954]


portfolio before change:  [7.95474122]
curr_Stock_Price:  103.0617943740343
curr_Factors:  [103.06179437  -0.41387426  -0.91798194]
mat_Sqrt:  [[27.20695277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00276593 -0.00734114 -0.12130834]
Stock Position:  0.0027659311948143536
Bond Position:  [7.66967939]


portfolio before change:  [7.95403856]
curr_Stock_Price:  102.46111606769706
curr_Factors:  [102.46111607  -0.59290157  -0.94022715]
mat_Sqrt:  [[22.11717933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162387 -0.04294774  0.4328433 ]
Stock Position:  -0.0016238696213777448
Bond Position:  [8.12042205]


portfolio before change:  [7.95528554]
curr_Stock_Price:  102.31832707758085
curr_Factors:  [102.31832708  -0.68826952  -0.94386019]
mat_Sqrt:  [[20.00453701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00064766  0.02004328 -0.05140267]
Stock Position:  0.0006476572237519909
Bond Position:  [7.88901834]


portfolio before change:  [7.95533089]
curr_Stock_Price:  100.86564196598192
curr_Factors:  [100.86564197  -0.6669181   -0.90870761]
mat_Sqrt:  [[20.86688906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128516 -0.01927126  0.10273513]
Stock Position:  0.0012851636681659975
Bond Position:  [7.82570203]


portfolio before change:  [7.95614808]
curr_Stock_Price:  100.74030218754753
curr_Factors:  [100.74030219  -0.4494762   -0.92853088]
mat_Sqrt:  [[25.39465877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00051     0.01395459 -0.21665092]
Stock Position:  0.0005099957683949753
Bond Position:  [7.90477096]


portfolio before change:  [7.95819284]
curr_Stock_Price:  102.81209083334149
curr_Factors:  [102.81209083  -0.41870574  -0.93935873]
mat_Sqrt:  [[26.43895517  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03818265 -0.0578432  -3.44012476]
Stock Position:  -0.03818265477163834
Bond Position:  [11.88383142]


portfolio before change:  [7.99838558]
curr_Stock_Price:  101.79835408222358
curr_Factors:  [101.79835408  -0.66469571  -0.91020518]
mat_Sqrt:  [[21.07511674  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0107425   0.00885957  0.066642  ]
Stock Position:  -0.010742502167811495
Bond Position:  [9.09195462]


portfolio before change:  [7.97816494]
curr_Stock_Price:  103.78645751419967
curr_Factors:  [103.78645751  -0.88381074  -0.90774883]
mat_Sqrt:  [[17.30120101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.87947203e-04 -9.16569976e-03  3.18730695e-01]
Stock Position:  0.0002879472026189633
Bond Position:  [7.94827992]


portfolio before change:  [7.97988383]
curr_Stock_Price:  106.30532434139676
curr_Factors:  [106.30532434  -1.05299328  -0.9182027 ]
mat_Sqrt:  [[14.80728648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00228995  0.05124304 -0.05892268]
Stock Position:  0.002289946371969589
Bond Position:  [7.73645034]


portfolio before change:  [7.98053629]
curr_Stock_Price:  106.1679151645315
curr_Factors:  [106.16791516  -1.07389674  -0.89199003]
mat_Sqrt:  [[14.866869    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00836368 -0.00165763 -0.1040913 ]
Stock Position:  -0.0083636832288993
Bond Position:  [8.8684911]


portfolio before change:  [7.98985737]
curr_Stock_Price:  105.18599779105867
curr_Factors:  [105.18599779  -1.08410896  -0.90354864]
mat_Sqrt:  [[14.41216421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0021339   0.03972205  0.36565622]
Stock Position:  -0.002133901126993577
Bond Position:  [8.21431389]


portfolio before change:  [7.98988825]
curr_Stock_Price:  105.65273388491204
curr_Factors:  [105.65273388  -0.90879514  -0.89323109]
mat_Sqrt:  [[17.42892855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00650303 -0.04989343 -0.30943753]
Stock Position:  0.006503027615942404
Bond Position:  [7.30282561]


portfolio before change:  [7.99295548]
curr_Stock_Price:  105.98401231533747
curr_Factors:  [105.98401232  -0.80196326  -0.90096182]
mat_Sqrt:  [[19.30498161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00028191  0.08310236  0.2390177 ]
Stock Position:  -0.0002819090134096453
Bond Position:  [8.02283332]


portfolio before change:  [7.99454433]
curr_Stock_Price:  103.90555470791865
curr_Factors:  [103.90555471  -0.65650089  -0.88071071]
mat_Sqrt:  [[22.33758672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00241592  0.01739478 -0.1027597 ]
Stock Position:  0.0024159216866153155
Bond Position:  [7.74351665]


portfolio before change:  [7.99793046]
curr_Stock_Price:  104.90647077771256
curr_Factors:  [104.90647078  -0.59558605  -0.89519255]
mat_Sqrt:  [[23.62464844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112627  0.02293407 -0.02786438]
Stock Position:  -0.001126269037710508
Bond Position:  [8.11608337]


portfolio before change:  [7.99765322]
curr_Stock_Price:  106.05345634878552
curr_Factors:  [106.05345635  -0.69534009  -0.89901322]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.99765322]
Stock Price:  106.38279271974307
PL:  [1.6148605]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.52144318e-02  4.86558094e-03  2.34031824e-02]
 [ 3.52230622e-02 -9.45717505e-02 -2.17997429e-01]
 [ 3.59975967e-01 -3.25245218e-01 -6.26001075e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-7.10394694e-01 -2.07134480e-01 -4.62250415e-03]
 [-5.77540798e-02  6.41261579e-03  4.14628528e-02]
 [ 2.15184357e-02  1.02058107e-01  3.37944783e-02]
 [ 2.36842018e-01 -1.63856063e-01 -3.26716364e-02]
 [-4.55920839e-01 -2.57238226e-02 -4.78310143e-02]
 [ 5.61647280e-02 -3.12624533e-02 -5.18226306e-02]
 [ 1.69303827e-02 -2.95671045e-01  1.46383626e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.40187109e-01 -6.14550261e-02  2.89076435e-01]
 [ 5.99394034e-02 -7.96648863e-02 -6.93593125e-02]
 [-2.00444443e-01  3.29731535e-01  2.37353598e-01]
 [ 2.99428168e-02 -3.11539909e-01 -7.59028615e-02]
 [-3.81755883e-01 -2.40123007e-01  9.22556591e-02]
 [-1.96292311e-01 -9.92656263e-02 -2.87551952e-02]
 [ 2.97168063e-01  1.26953085e+00  4.26876644e-01]
 [-3.12652860e-02 -5.89773389e-03  5.08962925e-02]
 [-5.95645799e-02 -8.55499238e-02 -2.88373483e-02]
 [-2.38834302e-02  4.74900601e-02 -1.85470741e-02]
 [ 4.27806482e-02 -3.54814702e-02  5.58429095e-02]
 [ 5.83924918e-02  2.31651985e-01  9.51549300e-02]
 [-7.43071880e-02 -1.38820614e-01  2.18046212e-02]
 [ 2.46587001e-02  6.05232187e-02 -1.23823271e-02]
 [ 3.29806946e-02 -6.67327006e-02  9.57219348e-02]
 [ 4.21876831e-02  5.19534240e-02 -7.57523698e-02]
 [-6.92031456e-01 -1.23003524e-01 -1.08058499e+00]
 [-1.09797407e-01  3.31216778e-02  1.69504938e-02]
 [ 1.86171870e-02  1.61191191e-03  1.09396429e-01]
 [ 1.68359381e-02  5.96614395e-02  7.23246139e-03]
 [-1.39733522e-01 -1.26710498e-02 -1.13072593e-01]
 [-6.30929902e-02  5.54252256e-02  8.36649123e-02]
 [ 2.17984154e-01 -1.72435674e-01 -7.79534440e-02]
 [-9.66390607e-03  1.54176991e-01  8.01807151e-02]
 [ 4.40223114e-02  4.27923012e-02 -3.93306865e-02]
 [-4.12517944e-02  8.33731543e-02 -8.26041244e-03]
 [-8.57033354e-02 -2.03582130e-01  5.89664196e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.36318045]
curr_Stock_Price:  100.69322541658188
curr_Factors:  [100.69322542  -1.00437187  -1.01016426]
mat_Sqrt:  [[13.43069014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00672427  0.00153863  0.06676277]
Stock Position:  -0.006724274590511347
Bond Position:  [8.04026934]


portfolio before change:  [7.35694138]
curr_Stock_Price:  101.77054008085769
curr_Factors:  [101.77054008  -0.85827978  -1.02597844]
mat_Sqrt:  [[15.4631915   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075775 -0.02990621 -0.62188598]
Stock Position:  -0.0007577548695903846
Bond Position:  [7.43405851]


portfolio before change:  [7.35740812]
curr_Stock_Price:  102.38099679037792
curr_Factors:  [102.38099679  -0.82565714  -1.06082952]
mat_Sqrt:  [[15.52131834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01441864 -0.10285157 -1.78580682]
Stock Position:  0.014418635872803901
Bond Position:  [5.88121381]


portfolio before change:  [7.36580496]
curr_Stock_Price:  102.91236721138563
curr_Factors:  [102.91236721  -0.70428883  -1.05974175]
mat_Sqrt:  [[17.63432411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00111731 -0.00659539  0.21422481]
Stock Position:  0.0011173126783361087
Bond Position:  [7.25081966]


portfolio before change:  [7.36557712]
curr_Stock_Price:  101.89721006417378
curr_Factors:  [101.89721006  -0.60900756  -1.04286178]
mat_Sqrt:  [[19.53280229  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03669143 -0.06550167 -0.01318672]
Stock Position:  -0.03669143002196618
Bond Position:  [11.10433147]


portfolio before change:  [7.37965002]
curr_Stock_Price:  101.55149507817987
curr_Factors:  [101.55149508  -0.68023154  -1.03167221]
mat_Sqrt:  [[18.33225844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026797   0.00202785  0.11828198]
Stock Position:  -0.0026796991511478948
Bond Position:  [7.65177748]


portfolio before change:  [7.38086707]
curr_Stock_Price:  101.45427634960444
curr_Factors:  [101.45427635  -0.60768996  -1.03770998]
mat_Sqrt:  [[19.57411986  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00158637 0.03227361 0.09640624]
Stock Position:  0.0015863718986684422
Bond Position:  [7.21992286]


portfolio before change:  [7.38246674]
curr_Stock_Price:  101.89371945949381
curr_Factors:  [101.89371946  -0.50684557  -1.01125494]
mat_Sqrt:  [[22.32773879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01011935 -0.05181584 -0.09320308]
Stock Position:  0.01011934997942433
Bond Position:  [6.35136853]


portfolio before change:  [7.37074234]
curr_Stock_Price:  100.65664735990889
curr_Factors:  [100.65664736  -0.49094093  -0.99470087]
mat_Sqrt:  [[22.78433853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02046794 -0.00813459 -0.13644857]
Stock Position:  -0.020467940697340852
Bond Position:  [9.43097663]


portfolio before change:  [7.38996024]
curr_Stock_Price:  99.77532024882998
curr_Factors:  [99.77532025 -0.64088185 -0.95056337]
mat_Sqrt:  [[20.31735895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00220399 -0.00988606 -0.14783554]
Stock Position:  0.002203991417639746
Bond Position:  [7.17005629]


portfolio before change:  [7.39507479]
curr_Stock_Price:  101.68922860223081
curr_Factors:  [101.6892286   -0.76728606  -0.92601502]
mat_Sqrt:  [[18.70180987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0020948  -0.09349939  0.41759174]
Stock Position:  0.002094803756761927
Bond Position:  [7.18205581]


portfolio before change:  [7.3963736]
curr_Stock_Price:  101.88065283999943
curr_Factors:  [101.88065284  -0.49339266  -0.91350797]
mat_Sqrt:  [[24.95068895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00289073  0.00225658  0.15019092]
Stock Position:  -0.0028907265343561268
Bond Position:  [7.69088271]


portfolio before change:  [7.40082889]
curr_Stock_Price:  100.67200518206306
curr_Factors:  [100.67200518  -0.49399402  -0.90175373]
mat_Sqrt:  [[24.9311994   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00792613 -0.01943379  0.8246546 ]
Stock Position:  0.007926125956886451
Bond Position:  [6.6028899]


portfolio before change:  [7.38401401]
curr_Stock_Price:  98.44641631931918
curr_Factors:  [98.44641632 -0.30509968 -0.90268126]
mat_Sqrt:  [[29.42166975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148613 -0.02519225 -0.19786281]
Stock Position:  0.0014861343642427703
Bond Position:  [7.2377094]


portfolio before change:  [7.38142553]
curr_Stock_Price:  96.09585634578029
curr_Factors:  [96.09585635 -0.27194037 -0.86847772]
mat_Sqrt:  [[30.72043644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00467055  0.10427027  0.67710375]
Stock Position:  -0.0046705459989947
Bond Position:  [7.83024565]


portfolio before change:  [7.37322859]
curr_Stock_Price:  98.06046119502305
curr_Factors:  [98.0604612  -0.43488227 -0.87375756]
mat_Sqrt:  [[26.49469202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00024176 -0.09851757 -0.21652974]
Stock Position:  0.0002417572626191281
Bond Position:  [7.34952176]


portfolio before change:  [7.37433135]
curr_Stock_Price:  98.82159929515188
curr_Factors:  [98.8215993  -0.61447306 -0.88359873]
mat_Sqrt:  [[22.09263746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01670802 -0.07593356  0.26317972]
Stock Position:  -0.016708019835394196
Bond Position:  [9.02544459]


portfolio before change:  [7.35270444]
curr_Stock_Price:  100.18352973261615
curr_Factors:  [100.18352973  -0.53311611  -0.92230538]
mat_Sqrt:  [[23.37301882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00875903 -0.03139055 -0.08203057]
Stock Position:  -0.00875902981064055
Bond Position:  [8.23021497]


portfolio before change:  [7.35918081]
curr_Stock_Price:  99.56159758385827
curr_Factors:  [99.56159758 -0.81226673 -0.93079292]
mat_Sqrt:  [[17.42170553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02394043 0.4014609  1.21776024]
Stock Position:  0.023940425215366375
Bond Position:  [4.97563382]


portfolio before change:  [7.38480471]
curr_Stock_Price:  100.60593616974475
curr_Factors:  [100.60593617  -0.93156849  -0.93496314]
mat_Sqrt:  [[15.55962834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135147 -0.00186503  0.14519296]
Stock Position:  -0.0013514720390036782
Bond Position:  [7.52077082]


portfolio before change:  [7.3849141]
curr_Stock_Price:  101.22064757002707
curr_Factors:  [101.22064757  -1.12308023  -0.94495867]
mat_Sqrt:  [[12.79767948  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00528689 -0.02705326 -0.08226493]
Stock Position:  -0.005286885691609584
Bond Position:  [7.92005609]


portfolio before change:  [7.38868848]
curr_Stock_Price:  100.69400240077422
curr_Factors:  [100.6940024   -1.04612661  -0.94269333]
mat_Sqrt:  [[13.78066186  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191886  0.01501768 -0.05290964]
Stock Position:  -0.001918859054133069
Bond Position:  [7.58190608]


portfolio before change:  [7.39078437]
curr_Stock_Price:  100.09568346486783
curr_Factors:  [100.09568346  -0.69442292  -0.92724054]
mat_Sqrt:  [[19.77588179  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00269335 -0.01122023  0.15930428]
Stock Position:  0.0026933517988558635
Bond Position:  [7.12119148]


portfolio before change:  [7.39182451]
curr_Stock_Price:  100.15135499355173
curr_Factors:  [100.15135499  -0.63755938  -0.94752837]
mat_Sqrt:  [[20.52399801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00408289 0.07325479 0.27145053]
Stock Position:  0.004082885756501089
Bond Position:  [6.98291797]


portfolio before change:  [7.39016571]
curr_Stock_Price:  99.53127327502959
curr_Factors:  [99.53127328 -0.50123457 -0.98306531]
mat_Sqrt:  [[22.55985548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325537 -0.04389893  0.06220252]
Stock Position:  -0.0032553697549865816
Bond Position:  [7.71417681]


portfolio before change:  [7.38620163]
curr_Stock_Price:  101.04520605176259
curr_Factors:  [101.04520605  -0.51993467  -0.97769821]
mat_Sqrt:  [[22.59966586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104842  0.01913912 -0.03532333]
Stock Position:  0.0010484168684979631
Bond Position:  [7.28026413]


portfolio before change:  [7.3880823]
curr_Stock_Price:  101.97096588106264
curr_Factors:  [101.97096588  -0.58263255  -0.994108  ]
mat_Sqrt:  [[21.07205106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00241063 -0.02110273  0.27306804]
Stock Position:  0.0024106254126823865
Bond Position:  [7.1422685]


portfolio before change:  [7.3903275]
curr_Stock_Price:  102.53196535596706
curr_Factors:  [102.53196536  -0.78176697  -1.00896153]
mat_Sqrt:  [[17.10628774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016407   0.01642912 -0.21610043]
Stock Position:  0.0016406965322788042
Bond Position:  [7.22210366]


portfolio before change:  [7.39092332]
curr_Stock_Price:  102.34484587171346
curr_Factors:  [102.34484587  -0.66767762  -1.00756516]
mat_Sqrt:  [[19.16537314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0477831  -0.03889713 -3.08260819]
Stock Position:  -0.04778309682707262
Bond Position:  [12.281277]


portfolio before change:  [7.32034103]
curr_Stock_Price:  103.8541148771474
curr_Factors:  [103.85411488  -0.71508583  -1.0173365 ]
mat_Sqrt:  [[18.36717027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00574298  0.01047399  0.04835504]
Stock Position:  -0.005742975251401281
Bond Position:  [7.91677264]


portfolio before change:  [7.32640903]
curr_Stock_Price:  102.9698436892299
curr_Factors:  [102.96984369  -0.59150167  -0.98419183]
mat_Sqrt:  [[21.30075814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00192431 0.00050973 0.31207756]
Stock Position:  0.0019243098607599014
Bond Position:  [7.12826315]


portfolio before change:  [7.32721731]
curr_Stock_Price:  102.92681176144893
curr_Factors:  [102.92681176  -0.91118045  -0.98073424]
mat_Sqrt:  [[15.51959594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0012792 0.0188666 0.0206322]
Stock Position:  0.0012792027543960128
Bond Position:  [7.19555305]


portfolio before change:  [7.32803337]
curr_Stock_Price:  102.86157851257971
curr_Factors:  [102.86157851  -0.87597785  -0.9797616 ]
mat_Sqrt:  [[16.08110106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01014492 -0.00400694 -0.32256463]
Stock Position:  -0.010144923068899232
Bond Position:  [8.37155617]


portfolio before change:  [7.32653516]
curr_Stock_Price:  103.11241525049697
curr_Factors:  [103.11241525  -0.8824936   -0.93720944]
mat_Sqrt:  [[16.71182858  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026678   0.017527    0.23867271]
Stock Position:  -0.00266780430837342
Bond Position:  [7.6016189]


portfolio before change:  [7.32790173]
curr_Stock_Price:  102.95636345463625
curr_Factors:  [102.95636345  -0.95890912  -0.93765258]
mat_Sqrt:  [[15.45207867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0127892  -0.05452895 -0.22237948]
Stock Position:  0.012789198687286603
Bond Position:  [6.01117235]


portfolio before change:  [7.34037295]
curr_Stock_Price:  103.87274399185404
curr_Factors:  [103.87274399  -1.04592434  -0.95753255]
mat_Sqrt:  [[14.00913531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00076263 0.04875505 0.22873326]
Stock Position:  0.0007626271300726517
Bond Position:  [7.26115678]


portfolio before change:  [7.34130817]
curr_Stock_Price:  103.90882484930118
curr_Factors:  [103.90882485  -0.78182974  -0.95539699]
mat_Sqrt:  [[18.28876796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202851  0.01353211 -0.1121995 ]
Stock Position:  0.00202850521269545
Bond Position:  [7.13052858]


portfolio before change:  [7.34327272]
curr_Stock_Price:  104.43787602825783
curr_Factors:  [104.43787603  -0.78112608  -0.98858121]
mat_Sqrt:  [[17.7944234   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00229202  0.02636491 -0.02356466]
Stock Position:  -0.0022920247265933737
Bond Position:  [7.58264692]


portfolio before change:  [7.3442385]
curr_Stock_Price:  104.4300704599587
curr_Factors:  [104.43007046  -0.63121961  -1.00729149]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.3442385]
Stock Price:  106.12364352398009
PL:  [1.22059498]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-8.96636370e-02 -5.39787873e-03  8.97961318e-03]
 [-3.09598636e-02  1.02436456e-02 -3.11885795e-02]
 [ 2.00723566e-01 -2.54335535e-01 -4.25010043e-01]
 [ 4.91288518e-03 -2.08564445e-02  7.50948879e-02]
 [-1.19470380e+00 -3.51562777e-01  2.34580984e-02]
 [-8.10624962e-02  5.14520164e-02  1.10009739e-01]
 [ 1.11072009e-02  1.36638451e-01  5.31518884e-02]
 [ 3.66106318e-01  8.09227923e-04 -9.78355022e-02]
 [-5.49561089e-01 -3.10421234e-02 -6.70979260e-02]
 [ 3.02241944e-02  1.18842205e-02 -2.77335050e-02]
 [-1.51864533e-02 -2.15896995e-01  1.21956500e-01]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 9.62892390e-02 -1.89085607e-02  2.64197959e-01]
 [ 1.52178919e-02  4.46160661e-01  3.98665404e-01]
 [ 5.47519280e-02 -1.13436781e-01 -4.35855799e-02]
 [-1.16516959e-02 -1.79994036e-02  3.45721848e-02]
 [-5.86242064e-01 -2.58942221e-01  1.71747900e-01]
 [-1.23836484e-01  1.85953931e-02 -2.32483126e-02]
 [ 2.08309667e-01  9.35039372e-01  3.78241726e-01]
 [-1.58046866e-02  3.68781782e-02  2.67633128e-02]
 [ 1.30171919e-02 -1.42827901e-01  5.11696687e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.77834847e-01 -2.45814566e-02  1.78507645e-01]
 [ 7.63728689e-02 -1.89313082e-01 -8.34195998e-02]
 [-1.03617052e-01  1.21384619e-01  1.52503099e-01]
 [ 1.41616616e-02  6.25855974e-02  1.17339957e-03]
 [-6.41534754e-02 -8.90343224e-02  1.15252930e-01]
 [ 7.00798087e-02  6.43218812e-02 -7.86331007e-02]
 [-6.97467927e-01 -1.26974938e-01 -1.07179260e+00]
 [-1.98911679e-01  7.49329731e-02  6.12312944e-03]
 [ 1.62061003e-02 -3.57336304e-03  1.10771434e-01]
 [ 1.84994860e-02  7.31097549e-02  7.02569586e-04]
 [-1.22343816e-01 -1.06215033e-02 -7.59740205e-02]
 [-6.47162275e-02  1.65589722e-02  5.90156254e-02]
 [ 1.61284186e-01 -1.62039392e-01 -1.00914067e-01]
 [-3.04853149e-02  2.67496999e-01  8.39395429e-02]
 [ 1.16374386e-01  9.07951669e-02 -2.15102916e-02]
 [-1.56802791e-02  6.45837241e-02 -1.08707371e-02]
 [-9.25274207e-02 -2.04625945e-01  5.36791060e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.82676373]
curr_Stock_Price:  100.61848649380761
curr_Factors:  [100.61848649  -1.05773188  -0.98595186]
mat_Sqrt:  [[13.03518523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00674866 -0.00170696  0.02561634]
Stock Position:  -0.006748661576529807
Bond Position:  [7.50580384]


portfolio before change:  [6.82267507]
curr_Stock_Price:  101.3633669652009
curr_Factors:  [101.36336697  -1.28502087  -0.97834564]
mat_Sqrt:  [[10.54176772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035157   0.00323933 -0.08897234]
Stock Position:  -0.0035157021917178477
Bond Position:  [7.17903848]


portfolio before change:  [6.82506642]
curr_Stock_Price:  100.93844027348725
curr_Factors:  [100.93844027  -1.5029738   -0.987406  ]
mat_Sqrt:  [[ 8.36562483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01283847 -0.08042796 -1.21243535]
Stock Position:  0.012838471837019175
Bond Position:  [5.5291711]


portfolio before change:  [6.82837636]
curr_Stock_Price:  101.1424171119545
curr_Factors:  [101.14241711  -1.3119071   -1.0084514 ]
mat_Sqrt:  [[ 9.93606532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00198298 -0.00659539  0.21422481]
Stock Position:  0.0019829835326394714
Bond Position:  [6.62781261]


portfolio before change:  [6.82957742]
curr_Stock_Price:  101.33028367780605
curr_Factors:  [101.33028368  -1.35472467  -0.99236945]
mat_Sqrt:  [[ 9.69190688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12371072 -0.11117391  0.06691943]
Stock Position:  -0.1237107172765804
Bond Position:  [19.3652195]


portfolio before change:  [6.80879961]
curr_Stock_Price:  101.51780680544155
curr_Factors:  [101.51780681  -1.57030757  -0.98354228]
mat_Sqrt:  [[ 7.89622161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0072539   0.01627056  0.31382717]
Stock Position:  -0.007253895561740198
Bond Position:  [7.54519918]


portfolio before change:  [6.80828463]
curr_Stock_Price:  101.7188282619418
curr_Factors:  [101.71882826  -1.44031265  -0.9839635 ]
mat_Sqrt:  [[ 9.00640759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00282963 0.04320887 0.15162754]
Stock Position:  0.00282962702917025
Bond Position:  [6.52045828]


portfolio before change:  [6.8090538]
curr_Stock_Price:  101.7025959297111
curr_Factors:  [101.70259593  -1.34313166  -0.956204  ]
mat_Sqrt:  [[10.20336098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.39257451e-02  2.55900338e-04 -2.79097456e-01]
Stock Position:  0.03392574509937684
Bond Position:  [3.35871746]


portfolio before change:  [6.82976046]
curr_Stock_Price:  102.300572252875
curr_Factors:  [102.30057225  -1.52241563  -0.96880585]
mat_Sqrt:  [[ 8.47138306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06658404 -0.00981638 -0.19141171]
Stock Position:  -0.06658403890682761
Bond Position:  [13.64134575]


portfolio before change:  [6.89065982]
curr_Stock_Price:  101.41155919570954
curr_Factors:  [101.4115592   -1.19236377  -0.95710727]
mat_Sqrt:  [[11.81909027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210422  0.00375812 -0.07911597]
Stock Position:  0.0021042199590849135
Bond Position:  [6.67726759]


portfolio before change:  [6.89244526]
curr_Stock_Price:  101.86338005877921
curr_Factors:  [101.86338006  -1.27098519  -0.96123691]
mat_Sqrt:  [[10.92889728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00037821 -0.06827262  0.34790795]
Stock Position:  0.0003782061920095327
Bond Position:  [6.8539199]


portfolio before change:  [6.8934256]
curr_Stock_Price:  102.19004136305136
curr_Factors:  [102.19004136  -0.99983494  -0.96679835]
mat_Sqrt:  [[14.29916206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00504405  0.00225658  0.15019092]
Stock Position:  -0.005044045120009026
Bond Position:  [7.40887678]


portfolio before change:  [6.89210884]
curr_Stock_Price:  102.63470888494747
curr_Factors:  [102.63470888  -0.94204768  -0.96086026]
mat_Sqrt:  [[15.30635694  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00978222 -0.00597941  0.75368324]
Stock Position:  0.009782223506409251
Bond Position:  [5.88811318]


portfolio before change:  [6.89979295]
curr_Stock_Price:  103.3449818240695
curr_Factors:  [103.34498182  -1.24116486  -0.99245874]
mat_Sqrt:  [[11.0723292   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00976443 0.14108839 1.13728143]
Stock Position:  0.009764426576884163
Bond Position:  [5.89068846]


portfolio before change:  [6.9029247]
curr_Stock_Price:  103.59029721459989
curr_Factors:  [103.59029721  -1.04897746  -0.97600149]
mat_Sqrt:  [[13.67356934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00313935 -0.03587186 -0.12433753]
Stock Position:  0.0031393510035607666
Bond Position:  [6.57771839]


portfolio before change:  [6.90516425]
curr_Stock_Price:  104.04175440628043
curr_Factors:  [104.04175441  -1.39016549  -0.97810776]
mat_Sqrt:  [[ 9.74270743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0005193  -0.00569191  0.09862482]
Stock Position:  -0.0005193033764885084
Bond Position:  [6.95919348]


portfolio before change:  [6.90587342]
curr_Stock_Price:  104.35136193407236
curr_Factors:  [104.35136193  -1.40980301  -0.9731161 ]
mat_Sqrt:  [[ 9.62962785  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05793267 -0.08188472  0.48994895]
Stock Position:  -0.05793266770343546
Bond Position:  [12.95122619]


portfolio before change:  [6.91673154]
curr_Stock_Price:  104.19188169957602
curr_Factors:  [104.1918817   -1.42307052  -0.97539781]
mat_Sqrt:  [[ 9.4665628   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01353204  0.00588038 -0.06632096]
Stock Position:  -0.013532038813170198
Bond Position:  [8.32666013]


portfolio before change:  [6.91912188]
curr_Stock_Price:  104.09215995786565
curr_Factors:  [104.09215996  -1.43192878  -0.98319554]
mat_Sqrt:  [[ 9.30128298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03329224 0.29568541 1.07901836]
Stock Position:  0.03329224033695258
Bond Position:  [3.45366067]


portfolio before change:  [6.90349745]
curr_Stock_Price:  103.60988070951014
curr_Factors:  [103.60988071  -1.20886507  -0.99031546]
mat_Sqrt:  [[11.48971361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00081721  0.0116619   0.07634828]
Stock Position:  -0.0008172055567102087
Bond Position:  [6.98816802]


portfolio before change:  [6.90455168]
curr_Stock_Price:  103.38882156633716
curr_Factors:  [103.38882157  -1.20807686  -0.9980193 ]
mat_Sqrt:  [[11.38618389  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017367  -0.04516615  0.14597282]
Stock Position:  0.001736697424502696
Bond Position:  [6.72499658]


portfolio before change:  [6.90639293]
curr_Stock_Price:  103.96495725072269
curr_Factors:  [103.96495725  -1.42019522  -1.00277582]
mat_Sqrt:  [[ 9.21730644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421694  0.01916992 -0.08961985]
Stock Position:  -0.004216943848009327
Bond Position:  [7.34480732]


portfolio before change:  [6.90648687]
curr_Stock_Price:  104.16041105770009
curr_Factors:  [104.16041106  -1.34775596  -1.00274608]
mat_Sqrt:  [[ 9.92870527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02151719 -0.00777334  0.50923263]
Stock Position:  0.02151719398566927
Bond Position:  [4.6652471]


portfolio before change:  [6.90263915]
curr_Stock_Price:  103.95448664299035
curr_Factors:  [103.95448664  -1.4264751   -1.00109947]
mat_Sqrt:  [[ 9.17404784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00593597 -0.05986605 -0.2379729 ]
Stock Position:  0.005935969875505638
Bond Position:  [6.28556845]


portfolio before change:  [6.9033995]
curr_Stock_Price:  103.95020849861594
curr_Factors:  [103.9502085   -1.3404037   -1.00778659]
mat_Sqrt:  [[ 9.93160135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0069831   0.03838519  0.43504889]
Stock Position:  -0.006983098457447214
Bond Position:  [7.62929404]


portfolio before change:  [6.90275382]
curr_Stock_Price:  104.17924713072527
curr_Factors:  [104.17924713  -1.30536042  -1.0015324 ]
mat_Sqrt:  [[10.37314362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0015441  0.0197913  0.00334738]
Stock Position:  0.0015440964238353427
Bond Position:  [6.74189102]


portfolio before change:  [6.90314723]
curr_Stock_Price:  103.88821873833619
curr_Factors:  [103.88821874  -1.1144082   -1.00231768]
mat_Sqrt:  [[12.51076691  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343116 -0.02815512  0.32878453]
Stock Position:  -0.0034311586299904115
Bond Position:  [7.25960419]


portfolio before change:  [6.90274229]
curr_Stock_Price:  104.27072906161318
curr_Factors:  [104.27072906  -0.95902728  -0.99221158]
mat_Sqrt:  [[14.81665391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00375859  0.02034036 -0.22431835]
Stock Position:  0.0037585866797980095
Bond Position:  [6.51083171]


portfolio before change:  [6.90100276]
curr_Stock_Price:  103.59136886823906
curr_Factors:  [103.59136887  -1.08156117  -0.96360615]
mat_Sqrt:  [[13.40042861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06861909 -0.040153   -3.05752596]
Stock Position:  -0.06861908534233582
Bond Position:  [14.00934774]


portfolio before change:  [6.92746086]
curr_Stock_Price:  103.23131118344082
curr_Factors:  [103.23131118  -0.86865167  -0.99429172]
mat_Sqrt:  [[16.02305813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01221534  0.02369589  0.01746758]
Stock Position:  -0.012215336007626748
Bond Position:  [8.18846602]


portfolio before change:  [6.93014768]
curr_Stock_Price:  103.0951546866073
curr_Factors:  [103.09515469  -0.66341236  -1.03082269]
mat_Sqrt:  [[18.9426754   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00204432 -0.00113     0.31600007]
Stock Position:  0.002044323728547556
Bond Position:  [6.71938781]


portfolio before change:  [6.92913148]
curr_Stock_Price:  102.18718904578347
curr_Factors:  [102.18718905  -0.52732342  -1.0461501 ]
mat_Sqrt:  [[21.18583508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00096907 0.02311933 0.00200424]
Stock Position:  0.0009690712253116847
Bond Position:  [6.83010482]


portfolio before change:  [6.93134598]
curr_Stock_Price:  103.59129983187964
curr_Factors:  [103.59129983  -0.44365988  -1.05794418]
mat_Sqrt:  [[23.07729632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00598537 -0.00335881 -0.21673273]
Stock Position:  -0.005985371620191447
Bond Position:  [7.55137841]


portfolio before change:  [6.93506267]
curr_Stock_Price:  103.12805267041301
curr_Factors:  [ 1.03128053e+02 -7.51119845e-02 -1.05573385e+00]
mat_Sqrt:  [[33.28562452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156951  0.00523641  0.16835515]
Stock Position:  -0.0015695112621489967
Bond Position:  [7.09692331]


portfolio before change:  [6.93307512]
curr_Stock_Price:  104.95965433178141
curr_Factors:  [104.95965433  -0.31971482  -1.03661333]
mat_Sqrt:  [[27.03812426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00504848 -0.05124135 -0.28787974]
Stock Position:  0.005048477040455517
Bond Position:  [6.40318872]


portfolio before change:  [6.93961394]
curr_Stock_Price:  106.09630769459699
curr_Factors:  [106.09630769  -0.51518134  -1.03940216]
mat_Sqrt:  [[22.41574786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0002875   0.08458998  0.23945615]
Stock Position:  -0.00028749808954557605
Bond Position:  [6.97011643]


portfolio before change:  [6.94049797]
curr_Stock_Price:  106.05210795293195
curr_Factors:  [106.05210795  -0.63448263  -1.01826897]
mat_Sqrt:  [[20.31133203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00562878  0.02871195 -0.06136287]
Stock Position:  0.005628775940843172
Bond Position:  [6.34355441]


portfolio before change:  [6.94088051]
curr_Stock_Price:  105.97918879327099
curr_Factors:  [105.97918879  -0.53455572  -1.02918051]
mat_Sqrt:  [[22.18699953  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073159  0.02042317 -0.03101119]
Stock Position:  -0.0007315867307023936
Bond Position:  [7.01841348]


portfolio before change:  [6.94258359]
curr_Stock_Price:  104.85052370031937
curr_Factors:  [104.8505237   -0.59409892  -1.06854656]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.94258359]
Stock Price:  105.55828757429455
PL:  [1.38429601]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-9.67307592e-02  1.19278322e-02  3.24064031e-02]
 [-5.26844749e-02  4.46494039e-02  3.01316116e-02]
 [ 2.11218833e-01  2.46321392e-01  3.63556134e-01]
 [-1.11670705e-02  3.24635392e-02  1.25424749e-01]
 [-6.57803899e-01 -1.99479599e-01  3.65785528e-02]
 [ 4.22231350e-03 -1.12467612e-01 -1.38820493e-01]
 [ 3.19152937e-02  6.68730611e-02 -8.87489503e-03]
 [ 2.66252928e-01  2.43165399e-02 -6.25786972e-02]
 [-4.15640508e-01 -1.76135562e-02 -6.40592850e-02]
 [ 4.18471999e-02 -7.86201636e-03 -3.69864739e-02]
 [ 2.79549059e-02 -2.74218648e-01  5.22120456e-02]
 [-8.30566553e-02  7.13593845e-03  5.26482920e-02]
 [ 1.51731974e-01 -6.90012336e-02  2.81969782e-01]
 [ 4.88660509e-02  2.51968751e-01  2.07701331e-01]
 [ 6.78942249e-02 -1.13191558e-01 -4.95147220e-02]
 [-3.87479126e-02  4.94438097e-02  4.50462763e-02]
 [-4.55993424e-01 -2.43758522e-01  1.20772922e-01]
 [-1.75275476e-01 -4.82642934e-02 -2.35389562e-02]
 [ 2.83450785e-01  1.24524547e+00  3.88032767e-01]
 [-2.50231883e-01 -4.07108327e-02  1.84507566e-01]
 [-9.18715507e-02  1.57001620e-01 -3.66371701e-02]
 [ 6.35975281e-02 -2.22335400e-02  4.78438112e-02]
 [-1.01421532e-01  3.07856468e-02 -1.12445325e-01]
 [-5.27248829e-03 -1.05088843e-01  1.03809122e-01]
 [-1.09222363e-01  9.37315852e-02  1.75757912e-02]
 [ 1.07594882e-01 -1.12308333e-01 -1.12300005e-01]
 [ 6.37139635e-02 -3.26274391e-02  1.07121062e-01]
 [-8.99613592e-02  4.41392292e-02  9.06385468e-02]
 [-4.82964397e-01 -8.40750568e-02 -7.60171451e-01]
 [ 3.34797586e-02 -1.04657521e-01 -7.32921388e-02]
 [-4.47846506e-02  7.68544852e-02  1.60951362e-01]
 [ 2.66546739e-02  1.45640297e-01 -3.47057539e-02]
 [-1.14284008e-01 -6.32909494e-03 -1.56154015e-01]
 [-5.97710944e-02  1.27869266e-01  1.25380957e-01]
 [-1.45937167e-01  9.50332297e-02  1.26451736e-01]
 [-1.00696601e-01 -9.63324995e-02  1.46301807e-02]
 [ 1.30023016e-01  1.07622491e-01  3.97834561e-02]
 [-1.21488490e-01  2.28739659e-01  1.31231133e-02]
 [ 1.48281519e-03 -2.04892276e-01  6.44015759e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.03209713]
curr_Stock_Price:  99.95044576029912
curr_Factors:  [99.95044576 -1.26102974 -0.98116408]
mat_Sqrt:  [[10.61725706  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00845867  0.00377191  0.09244645]
Stock Position:  -0.008458668188743116
Bond Position:  [2.87754479]


portfolio before change:  [2.03324054]
curr_Stock_Price:  99.85779541291436
curr_Factors:  [99.85779541 -1.1780756  -0.96724925]
mat_Sqrt:  [[11.68635911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00388325  0.01411938  0.0859571 ]
Stock Position:  -0.0038832490434274097
Bond Position:  [2.42101323]


portfolio before change:  [2.03559838]
curr_Stock_Price:  99.32855080458253
curr_Factors:  [99.3285508  -1.15530624 -0.96564502]
mat_Sqrt:  [[11.9112316   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.024497   0.07789366 1.03712446]
Stock Position:  0.024496997363723363
Bond Position:  [-0.39765287]


portfolio before change:  [2.04568287]
curr_Stock_Price:  99.7422423791563
curr_Factors:  [99.74224238 -1.09033376 -0.98852693]
mat_Sqrt:  [[12.47502434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00122431 0.01026587 0.3578019 ]
Stock Position:  0.0012243145812633844
Bond Position:  [1.92356699]


portfolio before change:  [2.04596037]
curr_Stock_Price:  99.77249394949385
curr_Factors:  [99.77249395 -0.97040979 -0.96818988]
mat_Sqrt:  [[14.35779298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0456538  -0.06308099  0.10434843]
Stock Position:  -0.04565380451072888
Bond Position:  [6.6009543]


portfolio before change:  [2.06343272]
curr_Stock_Price:  99.40785440048992
curr_Factors:  [99.4078544  -0.90441926 -0.96951544]
mat_Sqrt:  [[15.26093699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177042 -0.03556538 -0.39601623]
Stock Position:  -0.0017704156809677791
Bond Position:  [2.23942595]


portfolio before change:  [2.0617807]
curr_Stock_Price:  100.49910711808509
curr_Factors:  [100.49910712  -1.14944141  -0.96261389]
mat_Sqrt:  [[12.15929069  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00261778  0.02114712 -0.02531761]
Stock Position:  0.0026177816728636715
Bond Position:  [1.79869598]


portfolio before change:  [2.0602354]
curr_Stock_Price:  99.8229075463448
curr_Factors:  [99.82290755 -0.93573525 -0.96097875]
mat_Sqrt:  [[14.97951639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01696363  0.00768957 -0.1785196 ]
Stock Position:  0.016963628782236555
Bond Position:  [0.36687666]


portfolio before change:  [2.06379802]
curr_Stock_Price:  100.03021919894272
curr_Factors:  [100.0302192   -1.08893303  -0.96781502]
mat_Sqrt:  [[12.79077597  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03355319 -0.0055699  -0.18274331]
Stock Position:  -0.033553189896648294
Bond Position:  [5.42013097]


portfolio before change:  [2.05449619]
curr_Stock_Price:  100.32763916601849
curr_Factors:  [100.32763917  -1.24364396  -0.97524941]
mat_Sqrt:  [[10.90856051  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00312547 -0.00248619 -0.10551211]
Stock Position:  0.0031254693176736973
Bond Position:  [1.74092524]


portfolio before change:  [2.05271538]
curr_Stock_Price:  99.68823171919327
curr_Factors:  [99.68823172 -1.06408063 -0.97961551]
mat_Sqrt:  [[12.91451013  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00244162 -0.08671555  0.14894643]
Stock Position:  0.0024416218406513126
Bond Position:  [1.80931441]


portfolio before change:  [2.05543755]
curr_Stock_Price:  100.71049965201443
curr_Factors:  [100.71049965  -1.10318383  -1.0077256 ]
mat_Sqrt:  [[12.19883717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0059125   0.00225658  0.15019092]
Stock Position:  -0.005912499493372195
Bond Position:  [2.65088832]


portfolio before change:  [2.05420496]
curr_Stock_Price:  100.97501876750822
curr_Factors:  [100.97501877  -1.10035607  -1.00658387]
mat_Sqrt:  [[12.27952456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01689864 -0.02182011  0.8043813 ]
Stock Position:  0.016898635552955038
Bond Position:  [0.34786492]


portfolio before change:  [2.07049771]
curr_Stock_Price:  101.93659140123074
curr_Factors:  [101.9365914   -1.07447364  -1.01452411]
mat_Sqrt:  [[12.62088795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00774658 0.07967952 0.59251408]
Stock Position:  0.0077465795637173835
Bond Position:  [1.28083779]


portfolio before change:  [2.06725535]
curr_Stock_Price:  101.49736899217304
curr_Factors:  [101.49736899  -0.94311655  -0.99402866]
mat_Sqrt:  [[14.62727104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00375084 -0.03579431 -0.14125172]
Stock Position:  0.0037508350657183263
Bond Position:  [1.68655546]


portfolio before change:  [2.06822034]
curr_Stock_Price:  101.69843175368324
curr_Factors:  [101.69843175  -0.94169009  -0.99598794]
mat_Sqrt:  [[14.6484401   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193032  0.01563551  0.12850449]
Stock Position:  -0.001930324738688818
Bond Position:  [2.26453134]


portfolio before change:  [2.06970208]
curr_Stock_Price:  101.07746821898714
curr_Factors:  [101.07746822  -0.9009583   -0.97791741]
mat_Sqrt:  [[15.44077169  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02834279 -0.07708321  0.34453153]
Stock Position:  -0.02834279150536143
Bond Position:  [4.93451969]


portfolio before change:  [2.09442692]
curr_Stock_Price:  100.22688210512914
curr_Factors:  [100.22688211  -0.68363616  -0.96323753]
mat_Sqrt:  [[19.30883474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00939086 -0.01526251 -0.06715009]
Stock Position:  -0.009390857934287272
Bond Position:  [3.03564333]


portfolio before change:  [2.1004064]
curr_Stock_Price:  99.63055795123522
curr_Factors:  [99.63055795 -0.7199537  -0.93292541]
mat_Sqrt:  [[19.07902972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02069339 0.39378119 1.10694948]
Stock Position:  0.020693386807435044
Bond Position:  [0.03871272]


portfolio before change:  [2.08053027]
curr_Stock_Price:  98.6698178893533
curr_Factors:  [98.66981789 -0.48101877 -0.94658299]
mat_Sqrt:  [[23.66926432  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00902523 -0.0128739   0.52634873]
Stock Position:  -0.009025231219240051
Bond Position:  [2.97104819]


portfolio before change:  [2.09787892]
curr_Stock_Price:  96.78873112753016
curr_Factors:  [96.78873113 -0.57083596 -0.9225541 ]
mat_Sqrt:  [[21.73970947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00438351  0.04964827 -0.10451565]
Stock Position:  -0.004383513840257776
Bond Position:  [2.52215366]


portfolio before change:  [2.09973949]
curr_Stock_Price:  96.43621037416372
curr_Factors:  [96.43621037 -0.64298447 -0.9313368 ]
mat_Sqrt:  [[19.97657799  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00364374 -0.00703086  0.13648508]
Stock Position:  0.0036437440724731377
Bond Position:  [1.74835062]


portfolio before change:  [2.09717856]
curr_Stock_Price:  95.67339963928059
curr_Factors:  [95.67339964 -0.55119004 -0.95832544]
mat_Sqrt:  [[21.14545144  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00584426  0.00973528 -0.32077521]
Stock Position:  -0.005844257141117892
Bond Position:  [2.65631851]


portfolio before change:  [2.09801832]
curr_Stock_Price:  95.58652811307293
curr_Factors:  [95.58652811 -0.59934814 -0.9543939 ]
mat_Sqrt:  [[20.21227     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065327 -0.03323201  0.29613853]
Stock Position:  0.000653270396894251
Bond Position:  [2.03557447]


portfolio before change:  [2.09852656]
curr_Stock_Price:  95.97499695531394
curr_Factors:  [95.97499696 -0.62380166 -0.94631379]
mat_Sqrt:  [[19.96483059  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00516982  0.02964053  0.05013884]
Stock Position:  -0.005169819978360092
Bond Position:  [2.59470001]


portfolio before change:  [2.09829263]
curr_Stock_Price:  96.08298527421915
curr_Factors:  [96.08298527 -0.61011517 -0.95112382]
mat_Sqrt:  [[20.16550058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00405504 -0.03551501 -0.32036066]
Stock Position:  0.0040550419733315
Bond Position:  [1.70867209]


portfolio before change:  [2.09734515]
curr_Stock_Price:  95.79665403970071
curr_Factors:  [95.79665404 -0.26053575 -0.94855503]
mat_Sqrt:  [[28.59228652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296365 -0.0103177   0.30558657]
Stock Position:  0.002963649717976268
Bond Position:  [1.81343742]


portfolio before change:  [2.09759188]
curr_Stock_Price:  95.8034163681173
curr_Factors:  [95.80341637 -0.33089044 -0.93856473]
mat_Sqrt:  [[26.91929114  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261226  0.01395805  0.25856655]
Stock Position:  -0.002612259474698583
Bond Position:  [2.34785526]


portfolio before change:  [2.1000596]
curr_Stock_Price:  94.97110308699109
curr_Factors:  [94.97110309 -0.37462259 -0.9537502 ]
mat_Sqrt:  [[25.15860232  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02545072 -0.02658687 -2.16855756]
Stock Position:  -0.02545072040840978
Bond Position:  [4.51714259]


portfolio before change:  [2.02488819]
curr_Stock_Price:  97.94689658374587
curr_Factors:  [97.94689658 -0.45365467 -0.94498814]
mat_Sqrt:  [[24.18621028  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065396 -0.03309561 -0.20908207]
Stock Position:  0.0006539601568951734
Bond Position:  [1.96083482]


portfolio before change:  [2.02609234]
curr_Stock_Price:  99.41340181526459
curr_Factors:  [99.41340182 -0.56016674 -0.93964555]
mat_Sqrt:  [[22.18629254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.48304604e-04  2.43035222e-02  4.59149436e-01]
Stock Position:  -0.00044830460401245595
Bond Position:  [2.07065983]


portfolio before change:  [2.02705247]
curr_Stock_Price:  97.84910383421442
curr_Factors:  [97.84910383 -0.59622536 -0.93437432]
mat_Sqrt:  [[21.17511882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011018   0.04605551 -0.09900586]
Stock Position:  0.0011018029230774426
Bond Position:  [1.91924205]


portfolio before change:  [2.02738739]
curr_Stock_Price:  97.93532051342885
curr_Factors:  [97.93532051 -0.63915787 -0.96818219]
mat_Sqrt:  [[19.62819811  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00745469 -0.00200144 -0.44546394]
Stock Position:  -0.007454694967186081
Bond Position:  [2.75746533]


portfolio before change:  [2.03500218]
curr_Stock_Price:  96.96008507306806
curr_Factors:  [96.96008507 -0.570351   -0.96161899]
mat_Sqrt:  [[20.95399682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00147353  0.04043581  0.35767697]
Stock Position:  -0.0014735252560734375
Bond Position:  [2.17787531]


portfolio before change:  [2.03655297]
curr_Stock_Price:  96.09241052323428
curr_Factors:  [96.09241052 -0.47244569 -0.99725515]
mat_Sqrt:  [[22.10070494  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00532434  0.03005215  0.36073161]
Stock Position:  -0.005324335452784599
Bond Position:  [2.5481812]


portfolio before change:  [2.0357284]
curr_Stock_Price:  96.3071053982673
curr_Factors:  [96.3071054  -0.24258862 -0.99447919]
mat_Sqrt:  [[27.95159571  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00358468 -0.03046301  0.04173583]
Stock Position:  -0.0035846798618079604
Bond Position:  [2.38095854]


portfolio before change:  [2.03824663]
curr_Stock_Price:  95.68763797309332
curr_Factors:  [95.68763797 -0.33473413 -1.00338415]
mat_Sqrt:  [[25.102585    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00561387 0.03403322 0.11349113]
Stock Position:  0.005613867269143134
Bond Position:  [1.50106893]


portfolio before change:  [2.03951271]
curr_Stock_Price:  95.8797392592836
curr_Factors:  [95.87973926 -0.3379219  -0.99572695]
mat_Sqrt:  [[25.26565172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00446866  0.07233383  0.03743659]
Stock Position:  -0.0044686641867949265
Bond Position:  [2.46796707]


portfolio before change:  [2.0405537]
curr_Stock_Price:  95.71582561870517
curr_Factors:  [95.71582562 -0.29276064 -1.02763428]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.0405537]
Stock Price:  95.09574819129134
PL:  [2.0405537]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 9.92707474e+01 -9.26861553e+00 -9.30070813e+00]
 [-1.81210871e-01  1.95077224e-01  2.51402019e-01]
 [-7.05733705e-02  5.10296101e-02  5.11739494e-02]
 [ 3.24606289e-01  1.85924576e-01  2.02356812e-01]
 [-1.24988599e-02  2.01131347e-02  1.14066816e-01]
 [-5.85682718e-01 -1.79050431e-01  3.83410092e-02]
 [ 2.66608500e-03 -1.09482527e-01 -1.34293574e-01]
 [ 3.53390369e-02 -1.37356847e-02 -2.36378408e-02]
 [ 2.18605712e-01  1.19149350e-01 -5.41222286e-02]
 [-3.69772412e-01 -7.27401355e-03 -8.71880849e-02]
 [ 4.86454872e-02 -1.94115755e-02 -4.23985284e-02]
 [ 1.98296712e-02 -2.73296263e-01  7.83557079e-02]
 [-4.66950550e-02  2.42974132e-03  3.28732047e-02]
 [ 1.83374340e-01 -1.17822796e-01  2.28451051e-01]
 [ 8.34708944e-02  5.51332471e-02  1.43981299e-02]
 [-7.74414814e-04 -5.75891938e-02 -2.23189140e-02]
 [-1.80687447e-02 -1.11832032e-01 -1.07257475e-02]
 [-3.95917444e-01 -2.48755169e-01  9.85447899e-02]
 [-1.90079564e-01 -8.29458761e-02 -2.76273860e-02]
 [ 2.85387843e-01  1.24807891e+00  3.87189902e-01]
 [-1.53949790e-01 -2.82821426e-02  1.18379557e-01]
 [-8.91217456e-02  3.17734042e-01 -2.38460616e-02]
 [-3.40214063e-02  6.06205950e-02 -3.14155606e-02]
 [ 1.66379744e-01 -2.78322291e-02  1.70043807e-01]
 [ 7.08994184e-02 -1.77685841e-01 -6.87356732e-02]
 [-1.21144495e-01  2.30108341e-01  2.02982170e-01]
 [ 1.21761381e-02  6.06930339e-02  4.67570929e-02]
 [-1.50733505e-01 -1.43755659e-01  3.02298561e-01]
 [ 1.04155237e-01  7.61300293e-02 -9.05212911e-02]
 [-8.27688330e-01 -1.57411910e-01 -1.20337656e+00]
 [ 3.13255276e-02 -2.04676202e-01  2.25397442e-01]
 [-1.49806983e-01 -1.82813605e-01  1.40509574e-01]
 [ 6.69598445e-02  2.67388485e-01 -5.21208923e-02]
 [-1.02567136e-01 -1.72276256e-03  4.56912499e-03]
 [-3.07848001e-02  2.79479833e-01  3.02338615e-02]
 [ 9.17884597e-02 -1.45931495e-01 -1.21995308e-01]
 [-2.09859630e-02  2.28809024e-01  8.26755321e-02]
 [ 7.74349879e-02  6.65998076e-02 -3.16536318e-02]
 [-2.35494649e-02  7.03658420e-02 -1.00674554e-02]
 [-1.01171326e-01 -1.93084947e-01  3.84949162e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.27074737 -9.26861553 -9.30070813]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17720696  -2.93099358 -26.53233149]
init_Out:  [2.47716919]
Stock Position:  7.177206957759415
Bond position:  [-715.24352658]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.7411704]
curr_Stock_Price:  99.28538655853146
curr_Factors:  [99.28538656 -0.95463714 -0.98118275]
mat_Sqrt:  [[14.32746754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0087145   0.06168883  0.71717998]
Stock Position:  -0.008714504221078348
Bond Position:  [-1.87594748]


portfolio before change:  [-2.73801652]
curr_Stock_Price:  98.8965643129364
curr_Factors:  [98.89656431 -0.67308891 -0.93734621]
mat_Sqrt:  [[19.75959847  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297627  0.01613698  0.14598503]
Stock Position:  -0.0029762726709799308
Bond Position:  [-2.44367337]


portfolio before change:  [-2.74342848]
curr_Stock_Price:  100.61229520011238
curr_Factors:  [100.6122952   -0.78363955  -0.95302688]
mat_Sqrt:  [[17.71847771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02092238 0.05879451 0.57726766]
Stock Position:  0.020922381637563305
Bond Position:  [-4.84847731]


portfolio before change:  [-2.74494523]
curr_Stock_Price:  100.56876982232997
curr_Factors:  [100.56876982  -0.57220339  -0.93432138]
mat_Sqrt:  [[22.293987    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00050705 0.00636033 0.32540088]
Stock Position:  0.0005070537801953435
Bond Position:  [-2.795939]


portfolio before change:  [-2.74578747]
curr_Stock_Price:  99.59702226948376
curr_Factors:  [99.59702227 -0.90872774 -0.92804774]
mat_Sqrt:  [[15.86882963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03670589 -0.05662072  0.10937623]
Stock Position:  -0.036705886172587264
Bond Position:  [0.91000949]


portfolio before change:  [-2.74656803]
curr_Stock_Price:  99.62138655781578
curr_Factors:  [99.62138656 -0.75189329 -0.94345197]
mat_Sqrt:  [[18.2840959   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150805 -0.03462141 -0.38310219]
Stock Position:  -0.0015080484632684346
Bond Position:  [-2.59633415]


portfolio before change:  [-2.74723434]
curr_Stock_Price:  99.84800595036067
curr_Factors:  [99.84800595 -0.76134157 -0.96328612]
mat_Sqrt:  [[17.79684872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169464 -0.0043436  -0.06743218]
Stock Position:  0.0016946443437211634
Bond Position:  [-2.9164412]


portfolio before change:  [-2.74904459]
curr_Stock_Price:  98.99492441431669
curr_Factors:  [98.99492441 -0.89683497 -0.98429997]
mat_Sqrt:  [[15.08851162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01395992  0.03767833 -0.15439565]
Stock Position:  0.013959924404800603
Bond Position:  [-4.13100625]


portfolio before change:  [-2.74009063]
curr_Stock_Price:  99.67332115359753
curr_Factors:  [99.67332115 -1.16306317 -1.01173001]
mat_Sqrt:  [[11.3260442   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03423591 -0.00230025 -0.24872334]
Stock Position:  -0.03423590912226277
Bond Position:  [0.67231614]


portfolio before change:  [-2.73347495]
curr_Stock_Price:  99.48253813740465
curr_Factors:  [99.48253814 -1.04892268 -1.00121213]
mat_Sqrt:  [[12.80514864  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00308389 -0.00613848 -0.1209512 ]
Stock Position:  0.0030838938465567083
Bond Position:  [-3.04026854]


portfolio before change:  [-2.73188979]
curr_Stock_Price:  100.11979148651814
curr_Factors:  [100.11979149  -1.03372027  -1.01255986]
mat_Sqrt:  [[12.93694612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00222367 -0.08642387  0.22352702]
Stock Position:  0.002223668841695538
Bond Position:  [-2.95452305]


portfolio before change:  [-2.73250641]
curr_Stock_Price:  100.00858794629005
curr_Factors:  [100.00858795  -1.07352579  -1.02634652]
mat_Sqrt:  [[12.24825831  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325941  0.00076835  0.0937781 ]
Stock Position:  -0.003259410728047113
Bond Position:  [-2.40653734]


portfolio before change:  [-2.73440908]
curr_Stock_Price:  100.5000379550518
curr_Factors:  [100.50003796  -1.35486892  -1.00422469]
mat_Sqrt:  [[ 9.49784096  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02389644 -0.03725884  0.65170726]
Stock Position:  0.023896435483879614
Bond Position:  [-5.13600176]


portfolio before change:  [-2.74502788]
curr_Stock_Price:  100.08253810278434
curr_Factors:  [100.0825381   -1.0188935   -0.98769013]
mat_Sqrt:  [[13.45581817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00652754 0.01743466 0.04107386]
Stock Position:  0.006527543220196975
Bond Position:  [-3.39832097]


portfolio before change:  [-2.75119361]
curr_Stock_Price:  99.20304770429009
curr_Factors:  [99.2030477  -0.99235023 -0.96879521]
mat_Sqrt:  [[13.95758795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048842 -0.0182113  -0.06366965]
Stock Position:  -0.0004884218304791338
Bond Position:  [-2.70274068]


portfolio before change:  [-2.75155394]
curr_Stock_Price:  99.24905542581759
curr_Factors:  [99.24905543 -0.81998348 -0.9317878 ]
mat_Sqrt:  [[17.2163778   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013444  -0.03536439 -0.03059757]
Stock Position:  -0.001344395419052105
Bond Position:  [-2.61812397]


portfolio before change:  [-2.75111691]
curr_Stock_Price:  98.68053126050611
curr_Factors:  [98.68053126 -0.72728602 -0.93403211]
mat_Sqrt:  [[18.73829973  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02039806 -0.07866329  0.28112086]
Stock Position:  -0.020398056865603784
Bond Position:  [-0.73822582]


portfolio before change:  [-2.78187612]
curr_Stock_Price:  100.18395543539367
curr_Factors:  [100.18395544  -0.55695149  -0.94339028]
mat_Sqrt:  [[22.34642334  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00885424 -0.02622979 -0.07881324]
Stock Position:  -0.008854241742272707
Bond Position:  [-1.89482316]


portfolio before change:  [-2.77259708]
curr_Stock_Price:  99.10922571293115
curr_Factors:  [99.10922571 -0.64203102 -0.94683659]
mat_Sqrt:  [[20.23380894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01960323 0.39467721 1.10454502]
Stock Position:  0.01960322504425739
Bond Position:  [-4.71545753]


portfolio before change:  [-2.75965561]
curr_Stock_Price:  99.79946613465584
curr_Factors:  [99.79946613 -0.46004522 -0.94224852]
mat_Sqrt:  [[24.55386064  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00531549 -0.0089436   0.33770392]
Stock Position:  -0.005315494302388781
Bond Position:  [-2.22917211]


portfolio before change:  [-2.76070084]
curr_Stock_Price:  99.94368057391877
curr_Factors:  [99.94368057 -0.41283514 -0.91477059]
mat_Sqrt:  [[26.4961939   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323765  0.10047633 -0.06802618]
Stock Position:  -0.0032376516106182624
Bond Position:  [-2.43711802]


portfolio before change:  [-2.77114954]
curr_Stock_Price:  103.07682779448831
curr_Factors:  [103.07682779  -0.61091068  -0.95853875]
mat_Sqrt:  [[21.45644735  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181152  0.01916992 -0.08961985]
Stock Position:  -0.0018115237367757274
Bond Position:  [-2.58442342]


portfolio before change:  [-2.77216991]
curr_Stock_Price:  103.46175034746139
curr_Factors:  [103.46175035  -0.83875069  -0.94099823]
mat_Sqrt:  [[17.45197916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01148129 -0.00880132  0.48508765]
Stock Position:  0.011481286083084187
Bond Position:  [-3.96004386]


portfolio before change:  [-2.74925366]
curr_Stock_Price:  105.50083259448756
curr_Factors:  [105.50083259  -1.06536264  -0.91216347]
mat_Sqrt:  [[14.60249988  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00358028 -0.0561892  -0.19608374]
Stock Position:  0.0035802759503946392
Bond Position:  [-3.12697575]


portfolio before change:  [-2.74731507]
curr_Stock_Price:  106.15147592109702
curr_Factors:  [106.15147592  -0.99292151  -0.89716832]
mat_Sqrt:  [[16.03505497  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460052  0.07276665  0.57905163]
Stock Position:  -0.004600518158723447
Bond Position:  [-2.25896328]


portfolio before change:  [-2.75014016]
curr_Stock_Price:  106.70417510849292
curr_Factors:  [106.70417511  -1.00321796  -0.90145016]
mat_Sqrt:  [[15.88526835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00146598 0.01919282 0.13338497]
Stock Position:  0.0014659794600173177
Bond Position:  [-2.90656629]


portfolio before change:  [-2.75091532]
curr_Stock_Price:  106.4232609780898
curr_Factors:  [106.42326098  -1.08273659  -0.89760624]
mat_Sqrt:  [[14.68874195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0063136  -0.04545953  0.86237365]
Stock Position:  -0.006313598897368669
Bond Position:  [-2.07900154]


portfolio before change:  [-2.75275487]
curr_Stock_Price:  106.67346077955973
curr_Factors:  [106.67346078  -1.13296954  -0.88598947]
mat_Sqrt:  [[14.16555608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00618707  0.02407443 -0.25823205]
Stock Position:  0.006187072632416589
Bond Position:  [-3.41275132]


portfolio before change:  [-2.75085658]
curr_Stock_Price:  107.04923110662638
curr_Factors:  [107.04923111  -1.06692278  -0.8802031 ]
mat_Sqrt:  [[15.27416673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0705368  -0.04977802 -3.43289838]
Stock Position:  -0.07053680368152096
Bond Position:  [4.80005402]


portfolio before change:  [-2.8428582]
curr_Stock_Price:  108.36204456353914
curr_Factors:  [108.36204456  -0.95972801  -0.88544165]
mat_Sqrt:  [[17.12104192  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00420826 -0.0647243   0.64299616]
Stock Position:  0.004208264390108581
Bond Position:  [-3.29887433]


portfolio before change:  [-2.84277051]
curr_Stock_Price:  108.48087625867872
curr_Factors:  [108.48087626  -0.90707749  -0.90650635]
mat_Sqrt:  [[17.68983281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00711402 -0.05781074  0.4008347 ]
Stock Position:  -0.007114019379270786
Bond Position:  [-2.07103545]


portfolio before change:  [-2.84235547]
curr_Stock_Price:  108.38614359569034
curr_Factors:  [108.3861436   -1.01564002  -0.88056498]
mat_Sqrt:  [[16.27280409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0038853   0.08455566 -0.1486864 ]
Stock Position:  0.0038852955277959384
Bond Position:  [-3.26346767]


portfolio before change:  [-2.847131]
curr_Stock_Price:  107.2620161765892
curr_Factors:  [107.26201618  -0.64096315  -0.90814944]
mat_Sqrt:  [[22.78635761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00446227 -0.00054479  0.01303444]
Stock Position:  -0.004462273021745378
Bond Position:  [-2.3684986]


portfolio before change:  [-2.85469802]
curr_Stock_Price:  108.89144055870217
curr_Factors:  [108.89144056  -0.72542859  -0.89275483]
mat_Sqrt:  [[21.5886563   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080585  0.08837928  0.08624879]
Stock Position:  -0.000805849165546175
Bond Position:  [-2.76694794]


portfolio before change:  [-2.85396376]
curr_Stock_Price:  107.55106491695331
curr_Factors:  [107.55106492  -0.48312157  -0.87334891]
mat_Sqrt:  [[27.70174143  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0022785  -0.04614759 -0.34801866]
Stock Position:  0.0022784970728969936
Bond Position:  [-3.09901855]


portfolio before change:  [-2.86008665]
curr_Stock_Price:  105.03384074422176
curr_Factors:  [105.03384074  -0.56641479  -0.90468213]
mat_Sqrt:  [[24.12348077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [7.45304094e-05 7.23557665e-02 2.35850281e-01]
Stock Position:  7.453040944922492e-05
Bond Position:  [-2.86791487]


portfolio before change:  [-2.86050709]
curr_Stock_Price:  104.20301191195226
curr_Factors:  [104.20301191  -0.51915137  -0.9140278 ]
mat_Sqrt:  [[24.85755834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00292439  0.02106071 -0.090299  ]
Stock Position:  0.0029243949049896183
Bond Position:  [-3.16523785]


portfolio before change:  [-2.85656185]
curr_Stock_Price:  105.687392865899
curr_Factors:  [105.68739287  -0.73980011  -0.90370416]
mat_Sqrt:  [[20.42952894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00116438  0.02225163 -0.02871965]
Stock Position:  -0.0011643752277450841
Bond Position:  [-2.73350207]


portfolio before change:  [-2.85720518]
curr_Stock_Price:  105.94642964249263
curr_Factors:  [105.94642964  -0.86842242  -0.89613572]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.85720518]
Stock Price:  106.14585335830817
PL:  [-9.00305853]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  0.026440601024792797
FINAL STD P&L:  5.896197329430099
